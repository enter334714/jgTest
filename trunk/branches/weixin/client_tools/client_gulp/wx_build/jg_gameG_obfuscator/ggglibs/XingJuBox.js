var m=wx.$g;var gtd4o3=function(t){"use strict";class haxik1{constructor(t){this.onClickEvent=()=>{},t&&t.gameGsConf&&t.gameGsConf.icon?(this.opt=t.gameGsConf.icon,Laya.loader.load(this.opt.url,Laya.Handler.create(this,this.addIcon))):console.log("[VIP] Icon init data null",t)}["addIcon"](){var t=Laya.loader.getRes(this.opt.url);this.icon=new Laya.Sprite,Laya.stage.addChild(this.icon),this.icon.pivot(t.width/2,t.height/2);var s=this.opt.x||this.opt.posX||0,i=this.opt.y||this.opt.posY||0;this.icon.pos(-1===s?Laya.stage.width-t.width-15:s,-1===i?Laya.stage.height/2:i),this.icon.size(t.width,t.height),this.icon.graphics.clear(),this.icon.graphics.drawTexture(t,0,0),this.bindDrag()}["bindDrag"](){let t=this.icon.width,s=this.icon.height,i=new Laya.Rectangle(t/2,s/2,Laya.stage.width-t,Laya.stage.height-s);this.icon.on(Laya.Event.MOUSE_DOWN,this,()=>{this.icon.startDrag(i,!0,100,300,null,!0)}),this.icon.on(Laya.Event.CLICK,this,t=>{this.onClickEvent()})}["onClick"](t){t&&"function"==typeof t&&(this.onClickEvent=t)}["close"](){this.icon.visible=!1,this.icon.destroy()}}const o={auto:"AUTO",click:"CLICK"},e={iconShow:"ICON-SHOW",iconClick:"ICON-CLICK",copyClick:"WECHAT-COPY",btnClick:"BUTTON-CLICK",pageClose:"CONF-CLOSE",pageShow:"CONF-SHOW",copySecretNum:"SECRET-COPY"};class jru26${["init"](t){this.opt=Object.assign(this.opt||{},t)}["_jsonToQuery"](t){let s={};for(var i in t)void 0!==t[i]&&(s[i]=t[i]);return JSON.stringify(s)}["post"](s,i){if(this.opt&&this.opt.host){var o=this.opt.host+"/customer/api/v1/gs/log",s=this._jsonToQuery({gameId:this.opt.gameId,userId:this.opt.userId,gs:this.opt.gs,alias:s,gsWay:i||this.opt.openType});console.log("[VIP] post log",s);let t=new Laya.HttpRequest;t.send(o,s,"post",null,["Content-Type","application/json"])}}}const a={bg:11,avatar:13,closer:13,code:14,cross:15,account:16,codeNum:17,codeBtn:18};class o6z3d{constructor(t,s,i){console.log("[VIP] Page init",t),this.config=t,this._log=s,this._openType=i,this.stageW=Laya.stage.width,this.stageH=Laya.stage.height,this.renderMask(),this.renderBg(()=>{this.renderAvatar(),this.renderClose(),this.renderCode(),this.config.useCopy&&this.renderWXAccount(),this.config.gameGsConf.secretary&&this.config.gameGsConf.secretary.number&&this.renderSecretaryNum(),this._log&&this._log.post(e.pageShow,this._openType)})}["setRate"](t){this.rate=this.stageW/t.width}["newNode"](t){t=t||Laya.stage;var s=new Laya.Sprite;return t.addChild(s),s}["setPos"](t,s){let i=this.rate||1,o=s.x||0,e=s.y||0,a=t.width/2,n=t.height/2;-1==o?o=this.stageW/2:(a=0,o*=i),-1==e?e=this.stageH/2:(e*=i,n=0),t.pivot(a,n),t.pos(o,e),t.zOrder=s.z||0}["drawSprite"](t,s){var i,o;(s=Laya.loader.getRes(s))&&(i=(o=this.rate||1)?s.width*o:this.stageW,o=o?s.height*o:this.stageH,t.size(i,o),t.graphics.clear(),t.graphics.drawTexture(s,0,0,i,o))}["renderMask"](){var t=this.config.gameGsConf.background;this.mask=this.newNode(),this.mask.graphics.drawRect(0,0,this.stageW,this.stageH,"#"+(t.color||"aaaaaa"))}["renderBg"](t){let s=this.config.gameGsConf.background;this.bg=this.newNode(),Laya.loader.load(s.url,Laya.Handler.create(this,()=>{this.setRate(Laya.loader.getRes(s.url)),this.drawSprite(this.bg,s.url),this.setPos(this.bg,{x:0,y:0,z:a.bg}),t&&t()}))}["renderAvatar"](){let t=this.config.gameGsConf.gsAvatar;this.avatar=this.newNode(this.bg),Laya.loader.load(t.url,Laya.Handler.create(this,()=>{this.drawSprite(this.avatar,t.url),this.setPos(this.avatar,{x:t.posX,y:t.posY,z:a.avatar})}))}["renderClose"](){let t=this.config.gameGsConf.closeBtn;this.closer=this.newNode(this.bg),Laya.loader.load(t.url,Laya.Handler.create(this,()=>{this.drawSprite(this.closer,t.url),this.setPos(this.closer,{x:t.posX,y:t.posY,z:a.closer}),this.closer.on(Laya.Event.CLICK,this,this.close)}))}["renderCode"](){let t=this.config.gameGsConf.qrCodeBtn;this.code=this.newNode(this.bg),Laya.loader.load(t.url,Laya.Handler.create(this,()=>{this.drawSprite(this.code,t.url),this.setPos(this.code,{x:t.posX,y:t.posY,z:a.code}),this.code.on(Laya.Event.CLICK,this,this.onBtnClick)}))}["renderWXAccount"](){var t=this.config.wxAccount||"",s=this.config.gameGsConf.copyAccount;var i=new Laya.Text;i.text=(s.title||"")+t,i.fontSize=s.size||32,i.align=s.textAlign||"center",i.color=s.color||"#ffffff",this.setPos(i,{x:s.posX,y:s.posY,z:a.account}),this.bg.addChild(i)}["close"](){this.clear(),this._log&&this._log.post(e.pageClose,this._openType)}["clear"](){this.mask.destroy(),this.bg.destroy()}["onBtnClick"](){var t;if(this._log&&this._log.post(e.btnClick,this._openType),!this.config.gs)return t=this.config.gameGsConf.gsMsg||"\u6ca1\u6709\u8fbe\u5230\u5f00\u901a\u6761\u4ef6",void(wx&&wx.showModal&&wx.showModal({content:t,showCancel:!1}));this.config.useCopy?this.onCopy(this.config):console.warn("\u6b64VIP\u6a21\u5757\u4ec5\u652f\u6301\u590d\u5236\u529f\u80fd\uff01")}["renderSecretaryNum"](){var t=this.config.gameGsConf.secretary||{};var s=this.config.gameGsConf.exclusiveNumInfo;var i;(t=t.number)&&((i=new Laya.Text).text=s.title+t,i.fontSize=32,i.horizontalAlign="center".toUpperCase(),i.color=s.color||"#FFFFFF",this.setPos(i,{x:s.posX,y:s.posY,z:a.codeNum}),this.bg.addChild(i),this.renderSecretBtn())}["renderSecretBtn"](){let t=this.config.gameGsConf.exclusiveNumBtn;this.exclusiveBtn=this.newNode(this.bg),Laya.loader.load(t.url,Laya.Handler.create(this,()=>{this.drawSprite(this.exclusiveBtn,t.url),this.setPos(this.exclusiveBtn,{x:t.posX,y:t.posY,z:a.codeBtn}),this.exclusiveBtn.on(Laya.Event.CLICK,this,this.clickSercretBtn)}))}["clickSercretBtn"](){var t=(this.config.gameGsConf.secretary||{}).number;t&&wx&&wx.setClipboardData&&(wx.setClipboardData({data:t}),this._log&&this._log.post(e.number,this._openType))}["onCopy"](t){wx&&wx.setClipboardData&&t&&t.wxAccount&&(wx.setClipboardData({data:t.wxAccount}),this._log&&this._log.post(e.copySecretNum,this._openType))}}const n={HOST:{Prod:"https://platform.hortorgames.com",Test:"https://platform-test.hortorgames.com"},URLS:{Info:"/customer/api/v1/gs/info"}};class dz6r{["init"](t){console.log("[VIP] hortorVip init",t),this._showIcon=!1!==t.defShowIcon,this._log=new jru26$,this._init(t),this._loadVipData()}["showIcon"](){this._showIcon=!0,this.visible=!0,this._initEntryIcon(),this._log.post(e.iconShow)}["hideIcon"](){this._showIcon=!1,this._removeIcon()}["refreshData"](t){this._init(t),this._removeIcon(),this._loadVipData()}["_init"](t){t&&(this._conf=Object.assign(this._conf||{},t),this._host=n.HOST[this._conf.env],this._log.init({gameId:this._conf.vipGameId,userId:this._conf.userId||this._conf.openId,host:this._host}))}["_loadVipData"](){console.log("[VIP] _loadVipData");let s=(t,s)=>{console.log("[VIP] _loadVipData loaded",t,s),"function"==typeof this._conf.onLoad&&this._conf.onLoad(t,s)},t=""+this._host+n.URLS.Info+"?gameId="+this._conf.vipGameId+"&userId="+this._conf.userId,i=new Laya.HttpRequest;i.once(Laya.Event.COMPLETE,this,t=>{this._vipData=JSON.parse(t),this._vipData.meta&&this._vipData.meta.errCode?s(this._vipData.meta):(this._log.init({gs:this._vipData.gs,openType:this._vipData.disabledAutoOpenQrcode?o.click:o.auto}),s(null,this._vipData),this._showIcon&&this.showIcon())}),i.once(Laya.Event.ERROR,this,t=>{s(t)}),i.send(t,null,"get","text")}["_initEntryIcon"](){return this._icon?console.log("[VIP] \u4e0d\u80fd\u91cd\u590d\u5b9e\u4f8b\u5316 icon"):this._vipData&&this._vipData.gameGsConf?this._vipData.disabled?console.log("[VIP] Disabled"):(this._vipData.gameGsConf.useCross=this._crossSDK&&!this._vipData.gameGsConf.gsAddType,this._vipData.useQRCode=this._vipData.gs&&!this._vipData.gameGsConf.gsAddType,this._vipData.useCopy=this._vipData.gs&&1==this._vipData.gameGsConf.gsAddType,Object.assign(this._vipData.gameGsConf.icon,this._conf.icon||{}),this._icon=new haxik1(this._vipData),this._icon.onClick(this._onEntryIconClick.bind(this)),void this._tryAutoOpen()):console.log("[VIP] \u65e0\u914d\u7f6e\u4fe1\u606f")}["_removeIcon"](){this.visible=!1,this._icon&&this._icon.close&&(this._icon.close(),this._icon=null),this._removePage()}["_removePage"](){this._page&&(this._page.clear(),this._page=null)}["_tryAutoOpen"](){if(0===this._vipData.isAuth&&!this._vipData.disabledAutoOpenQrcode){if(!this._vipData.gs)return console.log("[VIP] \u6ca1\u6709\u7ed1\u5b9a\u5ba2\u670d");this._vipData.useCopy&&this._initPage(o.auto)}}["_onEntryIconClick"](){this._initPage(o.click),this._log.post(e.iconClick)}["_initPage"](t){console.log("[VIP] _initPage"),this._removePage(),this._page=new o6z3d(this._vipData,this._log,t,this._conf)}}class sc8g9{constructor(){let t=new dz6r;t.init({gameVersion:window.config.game_ver,vipGameId:window.config.partner_game_id,env:"Prod",userId:G$3J.openid,icon:{posX:100,posY:550},defShowIcon:!!sdkInitRes.is_vipds,onLoad:(t,s)=>{console.log("vip data loaded---",t,s)}})}}return window.XingJuBoxMain=sc8g9,t.XingJuBoxMain=sc8g9,t}({});