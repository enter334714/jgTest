var Laya=window.Laya=function($Y,$J){var $x={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function($J,$h){return 1==arguments.length?$x.__presubstr.call(this,$J):$x.__presubstr.call(this,$J,0<$h?$h:this.length+$h);},__init:function($J){$J.forEach(function($J){$J.__init$&&$J.__init$();});},__isClass:function($J){return $J&&($J.__isclass||$J==Object||$J==String||$J==Array);},__newvec:function($J,$h){var $f=[];$f.length=$J;for(var $n=0;$n<$J;$n++)$f[$n]=$h;return $f;},__extend:function($J,$h){for(var $f in $h)if($h.hasOwnProperty($f)){var $n=Object.getOwnPropertyDescriptor($h,$f),$L=$n.get,$T=$n.set;$L||$T?$L&&$T?Object.defineProperty($J,$f,$n):($L&&Object.defineProperty($J,$f,$L),$T&&Object.defineProperty($J,$f,$T)):$J[$f]=$h[$f];}function $k(){$x.un(this,"constructor",$J);}$k.prototype=$h.prototype,$J.prototype=new $k(),$x.un($J.prototype,"__imps",$x.__copy({},$h.prototype.__imps));},__copy:function($J,$h){if(!$h)return null;for(var $f in $J=$J||{},$h)$J[$f]=$h[$f];return $J;},__package:function($J,$h){if(!$x.__packages[$J]){$x.__packages[$J]=!0;var $f=$Y,$n=$J.split(".");if(1<$n.length)for(var $L=0,$T=$n.length-1;$L<$T;$L++){var $k=$f[$n[$L]];$f=$k||($f[$n[$L]]={});}$f[$n[$n.length-1]]||($f[$n[$n.length-1]]=$h||{});}},__hasOwnProperty:function($J,$h){return $h=$h||this,Object.hasOwnProperty.call($h,$J)||function $J($h,$f){if(Object.hasOwnProperty.call($f.prototype,$h))return!0;var $n=$f.prototype.__super;return null==$n?null:$J($h,$n);}($J,$h.__class);},__typeof:function($J,$h){if(!$J||!$h)return!1;if($h===String)return"string"==typeof $J;if($h===Number)return"number"==typeof $J;if($h.__interface__)$h=$h.__interface__;else if("string"!=typeof $h)return $J instanceof $h;return $J.__imps&&$J.__imps[$h]||$J.__class==$h;},__as:function($J,$h){return this.__typeof($J,$h)?$J:null;},__int:function($J){return $J?parseInt($J):0;},interface:function($J,$h){$x.__package($J,{});var $f=$x.__internals,$n=$f[$J]=$f[$J]||{self:$J};if($h){var $L=$h.split(",");$n.extend=[];for(var $T=0;$T<$L.length;$T++){var $k=$L[$T];$f[$k]=$f[$k]||{self:$k},$n.extend.push($f[$k]);}}var $u=$Y,$S=$J.split(".");for($T=0;$T<$S.length-1;$T++)$u=$u[$S[$T]];$u[$S[$S.length-1]]={__interface__:$J};},class:function($J,$h,$f,$n){if($f&&$x.__extend($J,$f),$h)if($x.__package($h,$J),$x.__classmap[$h]=$J,0<$h.indexOf(".")){if(0==$h.indexOf("laya.")){var $L=$h.split(".");$n=$n||$L[$L.length-1],$x[$n]&&console.log("Warning!,this class["+$n+"] already exist:",$x[$n]),$x[$n]=$J;}}else"Main"==$h?$Y.Main=$J:"MainWX"==$h?$Y.MainWX=$J:($x[$h]&&console.log("Error!,this class["+$h+"] already exist:",$x[$h]),$x[$h]=$J);var $T=$x.un,$k=$J.prototype;$T($k,"hasOwnProperty",$x.__hasOwnProperty),$T($k,"__class",$J),$T($k,"__super",$f),$T($k,"__className",$h),$T($J,"__super",$f),$T($J,"__className",$h),$T($J,"__isclass",!0),$T($J,"super",function($J){this.__super.call($J);});},imps:function($J,$h){if(!$h)return null;var $L=$J.__imps||$x.un($J,"__imps",{});function $T($J){var $h,$f;if(($h=$x.__internals[$J])&&($L[$J]=!0,$f=$h.extend))for(var $n=0;$n<$f.length;$n++)$T($f[$n].self);}for(var $f in $h)$T($f);},superSet:function($J,$h,$f,$n){var $L=$J.prototype["_$set_"+$f];$L&&$L.call($h,$n);},superGet:function($J,$h,$f){var $n=$J.prototype["_$get_"+$f];return $n?$n.call($h):null;},getset:function($J,$h,$f,$n,$L){$J?($n&&($h["_$GET_"+$f]=$n),$L&&($h["_$SET_"+$f]=$L)):($n&&$x.un($h,"_$get_"+$f,$n),$L&&$x.un($h,"_$set_"+$f,$L)),$n&&$L?Object.defineProperty($h,$f,{get:$n,set:$L,enumerable:!1,configurable:!0}):($n&&Object.defineProperty($h,$f,{get:$n,enumerable:!1,configurable:!0}),$L&&Object.defineProperty($h,$f,{set:$L,enumerable:!1,configurable:!0}));},static:function($f,$n){for(var $L=0,$J=$n.length;$L<$J;$L+=2)if("length"==$n[$L])$f.length=$n[$L+1].call($f);else{function $h(){var $h=$n[$L],$J=$n[$L+1];Object.defineProperty($f,$h,{get:function(){return delete this[$h],this[$h]=$J.call(this);},set:function($J){delete this[$h],this[$h]=$J;},enumerable:!0,configurable:!0});}$h();}},un:function($J,$h,$f){return $f||($f=$J[$h]),$x.__propun.value=$f,Object.defineProperty($J,$h,$x.__propun),$f;},uns:function($h,$J){$J.forEach(function($J){$x.un($h,$J);});}};return $Y.console=$Y.console||{log:function(){}},$Y.trace=$Y.console.log,Error.prototype.throwError=function(){throw arguments;},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),$x;}(window,document);!function($J,$h,$f){$f.un,$f.uns,$f.static,$f.class,$f.getset,$f.__newvec;}(window,document,Laya),function($k,$h,$Q){$Q.un,$Q.uns;var $S=$Q.static,$q=$Q.class,$x=$Q.getset;$Q.__newvec;$Q.interface("laya.runtime.IMarket"),$Q.interface("laya.filters.IFilter"),$Q.interface("laya.display.ILayout"),$Q.interface("laya.resource.IDispose"),$Q.interface("laya.runtime.IPlatform"),$Q.interface("laya.resource.IDestroy"),$Q.interface("laya.runtime.IConchNode"),$Q.interface("laya.filters.IFilterAction"),$Q.interface("laya.runtime.ICPlatformClass"),$Q.interface("laya.resource.ICreateResource"),$Q.interface("laya.runtime.IConchRenderObject"),$Q.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var $y=function(){function $T(){}return $q($T,"laya.utils.RunDriver"),$T.FILTER_ACTIONS=[],$T.pixelRatio=-1,$T._charSizeTestDiv=null,$T.now=function(){return Date.now();},$T.getWindow=function(){return $k;},$T.getPixelRatio=function(){if($T.pixelRatio<0){var $J=$a.context,$h=$J.backingStorePixelRatio||$J.webkitBackingStorePixelRatio||$J.mozBackingStorePixelRatio||$J.msBackingStorePixelRatio||$J.oBackingStorePixelRatio||$J.backingStorePixelRatio||1;($T.pixelRatio=($a.window.devicePixelRatio||1)/$h)<1&&($T.pixelRatio=1);}return $T.pixelRatio;},$T.getIncludeStr=function($J){return null;},$T.createShaderCondition=function($J){var $h="(function() {return "+$J+";})";return $Q._runScript($h);},$T.fontMap=[],$T.measureText=function($J,$h){var $f=$T.hanzi.test($J);if($f&&$T.fontMap[$h])return $T.fontMap[$h];var $n=$a.context;$n.font=$h;var $L=$n.measureText($J);return $L||($L={width:16,height:16}),$f&&($T.fontMap[$h]=$L),$L;},$T.getWebGLContext=function($J){},$T.beginFlush=function(){},$T.endFinish=function(){},$T.addToAtlas=null,$T.flashFlushImage=function($J){},$T.drawToCanvas=function($J,$h,$f,$n,$L,$T){var $k=$sJ.create("2D"),$u=new $m($f,$n,$k);return $Z.renders[$h]._fun($J,$u,$L,$T),$k;},$T.createParticleTemplate2D=null,$T.createGLTextur=null,$T.createWebGLContext2D=null,$T.changeWebGLSize=function($J,$h){},$T.createRenderSprite=function($J,$h){return new $Z($J,$h);},$T.createFilterAction=function($J){return new $s();},$T.createGraphics=function(){return new $R();},$T.clear=function($J){$I._context.ctx.clear();},$T.cancelLoadByUrl=function($J){},$T.clearAtlas=function($J){},$T.isAtlas=function($J){return!1;},$T.addTextureToAtlas=function($J){},$T.getTexturePixels=function($J,$h,$f,$n,$L){return null;},$T.skinAniSprite=function(){return null;},$T.update3DLoop=function(){},$S($T,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$");}]),$T;}(),$n=($x(1,$Q,"alertGlobalError",null,function($J){var $T=0;$a.window.onerror=$J?function($J,$h,$f,$n,$L){$T++<5&&$L&&alert($L.stack||$L);}:null;}),$Q.init=function($J,$h,$f){for(var $n=[],$L=2,$T=arguments.length;$L<$T;$L++)$n.push(arguments[$L]);if(!$Q._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=$Q._arrayBufferSlice),$Q._isinit=!0,$a.__init__(),$t.__init__(),$R.__init__(),$Q.timer=new $X(),$Q.scaleTimer=new $X(),$Q.loader=new $SJ(),$z.__init__(),$L=0;for(var $k=$n.length;$L<$k;$L++)$n[$L].enable&&$n[$L].enable();return $l.__init__(),$u.__init__(),$c.__init__(),$V.beginCheck(),$Q._currentStage=$Q.stage=new $rJ(),$Q.stage.conchModel&&$Q.stage.conchModel.setRootNode(),$Q._getUrlPath(),$Q.render=new $I(0,0),$Q.stage.size($J,$h),$Z.__init__(),$j.__init__(),$i.instance.__init__($Q.stage,$I.canvas),$pJ.__init__(),$G.autoStopMusic=!0,$F.__init__(),$I.canvas;}},$Q._getUrlPath=function(){var $J=$a.window.location,$h=$J.pathname;$h=$h&&":"==$h.charAt(2)?$h.substring(1):$h,$W.rootPath=$W.basePath=$W.getPath("file:"==$J.protocol?$h:$J.protocol+"//"+$J.host+$J.pathname);},$Q._arrayBufferSlice=function($J,$h){var $f=new Uint8Array(this,$J,$h-$J),$n=new Uint8Array($f.length);return $n.set($f),$n.buffer;},$Q._runScript=function($J){return $a.window[$Q._evcode]($J);},$Q.stage=null,$Q.timer=null,$Q.scaleTimer=null,$Q.loader=null,$Q.version="1.8.6",$Q.render=null,$Q._currentStage=null,$Q._isinit=!1,$Q.isDebug=!1,$Q.MiniAdpter={init:function(){$k.navigator&&$k.navigator.userAgent&&-1<$k.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0");}},$S($Q,["conchMarket",function(){return this.conchMarket=$k.conch?conchMarket:null;},"PlatformClass",function(){return this.PlatformClass=$k.PlatformClass;},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al";}]),function(){function $J(){}return $q($J,"Config"),$J.WebGLTextCacheCount=500,$J.atlasEnable=!1,$J.showCanvasMark=!1,$J.animationInterval=50,$J.isAntialias=!1,$J.isAlpha=!1,$J.premultipliedAlpha=!0,$J.isStencil=!0,$J.preserveDrawingBuffer=!1,$J;}()),$Y=function(){function $Y(){this._events=null;}$q($Y,"laya.events.EventDispatcher");var $J=$Y.prototype;return $J.hasListener=function($J){return!!(this._events&&this._events[$J]);},$J.getListener=function($J){return this._events?this._events[$J]:null;},$J.event=function($J,$h){if(!this._events||!this._events[$J])return!1;var $f=this._events[$J];if($f.lock)$f.queue||($f.queue=[]),$f.queue.push($h);else{var $n;for($f.lock=!0,$f.cursor=$f.head;$f.cursor;)($n=$f.cursor).recover?($f.head=$f.tail=$f.cursor=null,console.error("node is recover："+$n.id)):($f.cursor=$n.next,$n.once&&$Y.delNode($f,$n),$n.method&&(null!=$h?$n.args?$n.method.apply($n.caller,$n.args.concat($h)):$h instanceof Array?$n.method.apply($n.caller,$h):$n.caller?$n.method.call($n.caller,$h):$Q.recordError("事件派发错误","node.caller:"+$n.caller+"node.method:"+$n.method+"data:"+$h+"node.prev"+$n.prev):$n.method.apply($n.caller,$n.args)),$n.once&&$Y.recoverHandler($n));$f.lock=!1,!$f.head&&this._events&&this._events[$J]==$f&&delete this._events[$J],$f.queue&&$f.queue.length&&this.event($J,$f.queue.shift());}return!0;},$J.on=function($J,$h,$f,$n){return this._createListener($J,$h,$f,$n,!1);},$J.once=function($J,$h,$f,$n){return this._createListener($J,$h,$f,$n,!0);},$J._createListener=function($J,$h,$f,$n,$L,$T){void 0===$T&&($T=!0),$T&&this.off($J,$h,$f,$L);var $k=$Y.createHandler($h||this,$f,$n,$L);this._events||(this._events={});var $u=this._events,$S=$u[$J];return $S?$S.tail?($k.prev=$S.tail,$S.tail.next=$k,$S.tail=$k):$S.head=$S.tail=$k:$u[$J]={head:$k,tail:$k,cursor:null,lock:!1},this;},$J.off=function($J,$h,$f,$n){if(void 0===$n&&($n=!1),!this._events||!this._events[$J])return this;for(var $L=this._events[$J],$T=$L.head;$T;){if((!$h||$T.caller===$h)&&$T.method===$f&&(!$n||$T.once)){$Y.delNode($L,$T),$L.cursor==$T&&($L.cursor=$T.next),$Y.recoverHandler($T);break;}$T=$T.next;}return this;},$J.offAll=function($J){var $h=this._events;if(!$h)return this;if($J)this._recoverHandlers($h[$J]),delete $h[$J];else{for(var $f in $h)this._recoverHandlers($h[$f]);this._events=null;}return this;},$J._recoverHandlers=function($J){if($J){for(var $h=$J.head;$h;){$Y.delNode($J,$h);var $f=$h.next;$Y.recoverHandler($h),$h=$f;}$J.cursor=null;}},$J.isMouseEvent=function($J){return $Y.MOUSE_EVENTS[$J];},$Y.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},$Y.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0});},$Y.delNode=function($J,$h){$h.prev?$h.prev.next=$h.next:$J.head=$h.next,$h.next?$h.next.prev=$h.prev:$J.tail=$h.prev;},$Y.createHandler=function($J,$h,$f,$n){var $L=500<$Y._freeHandler.length?$Y._freeHandler.shift():null;if($L){if($L.recover)$L.recover=!1,$L.caller=$J,$L.method=$h,$L.args=$f,$L.once=$n;else{var $T="";try{arguments.propertyIsEnumerable.caller;}catch($J){$T=$J.stack;}var $k=$L.caller?($L.caller.__proto__&&$L.caller.__proto__.constructor&&$L.caller.__proto__.constructor.name)+"|"+$L.caller.__className+"|"+$L.caller.name:"",$u=$L.method?$L.method.name:"";$Q.recordError("EventDispatcher重复创建","caller="+$k+"  method="+$u+"  stack="+$T),$L={id:++$Y._nodeCount,caller:$J,method:$h,args:$f,once:$n,recover:!1};}}else $L={id:++$Y._nodeCount,caller:$J,method:$h,args:$f,once:$n,recover:!1};return $L.prev=$L.next=null,$L;},$Y.recoverHandler=function($J){if($J.recover){if($Y._errorCount<5){$Y._errorCount++;var $h="";try{arguments.propertyIsEnumerable.caller;}catch($J){$h=$J.stack;}var $f=$J.caller?($J.caller.__proto__&&$J.caller.__proto__.constructor&&$J.caller.__proto__.constructor.name)+"|"+$J.caller.__className+"|"+$J.caller.name:"",$n=$J.method?$J.method.name:"";$Q.recordError("EventDispatcher重复回收","id="+$J.id+"  caller="+$f+"  method="+$n+"  stack="+$h);}$J.caller=$J.method=$J.args=$J.prev=null;}else $J.recover=!0,$J.caller=$J.method=$J.args=$J.prev=$J.next=null,$Y._freeHandler&&$Y._freeHandler.length<3e3&&$Y._freeHandler.push($J);},$Y._freeHandler=[],$Y._nodeCount=0,$Y._errorCount=0,$Y;}(),$_=function(){function $L($J,$h,$f,$n){this.once=!1,void(this._id=0)===$n&&($n=!1),this.setTo($J,$h,$f,$n);}$q($L,"laya.utils.Handler");var $J=$L.prototype;return $J.setTo=function($J,$h,$f,$n){return this._id=$L._gid++,this.caller=$J,this.method=$h,this.args=$f,this.once=$n,this;},$J.run=function(){if(null==this.method)return null;var $J=this._id,$h=this.method.apply(this.caller,this.args);return this._id===$J&&this.once&&this.recover(),$h;},$J.runWith=function($J){if(null==this.method)return null;var $h=this._id;if(null==$J)var $f=this.method.apply(this.caller,this.args);else $f=this.args||$J.unshift?this.args?this.method.apply(this.caller,this.args.concat($J)):this.method.apply(this.caller,$J):this.method.call(this.caller,$J);return this._id===$h&&this.once&&this.recover(),$f;},$J.clear=function(){return this.caller=null,this.method=null,this.args=null,this;},$J.recover=function(){0<this._id&&(this._id=0,this.clear());},$L.create=function($J,$h,$f,$n){return void 0===$n&&($n=!0),new $L($J,$h,$f,$n);},$L._gid=1,$L;}(),$A=function(){function $J(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0;}$q($J,"laya.display.BitmapFont");var $h=$J.prototype;return $h.loadFont=function($J,$h){this._path=$J,this._complete=$h,$Q.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],$_.create(this,this.onLoaded));},$h.onLoaded=function(){this.parseFont($uJ.getRes(this._path),$uJ.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null);},$h.parseFont=function($J,$h){if(null!=$J&&null!=$h){this._texture=$h;var $f=$J.getElementsByTagName("info");if(!$f[0].getAttributeNode)return this.parseFont2($J,$h);this.fontSize=parseInt($f[0].getAttributeNode("size").nodeValue);var $n,$L=$f[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt($L[0]),parseInt($L[1]),parseInt($L[2]),parseInt($L[3])],$n=$J.getElementsByTagName("char");var $T=0;for($T=0;$T<$n.length;$T++){var $k=$n[$T],$u=parseInt($k.getAttributeNode("id").nodeValue),$S=parseInt($k.getAttributeNode("xoffset").nodeValue)/1,$Y=parseInt($k.getAttributeNode("yoffset").nodeValue)/1,$x=parseInt($k.getAttributeNode("xadvance").nodeValue)/1,$j=new $g();$j.x=parseInt($k.getAttributeNode("x").nodeValue),$j.y=parseInt($k.getAttributeNode("y").nodeValue),$j.width=parseInt($k.getAttributeNode("width").nodeValue),$j.height=parseInt($k.getAttributeNode("height").nodeValue);var $R=$xJ.create($h,$j.x,$j.y,$j.width,$j.height,$S,$Y);this._maxWidth=Math.max(this._maxWidth,$x+this.letterSpacing),this._fontCharDic[$u]=$R,this._fontWidthMap[$u]=$x;}}},$h.parseFont2=function($J,$h){if(null!=$J&&null!=$h){this._texture=$h;var $f=$J.getElementsByTagName("info");this.fontSize=parseInt($f[0].attributes.size.nodeValue);var $n=$f[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt($n[0]),parseInt($n[1]),parseInt($n[2]),parseInt($n[3])];var $L=$J.getElementsByTagName("char"),$T=0;for($T=0;$T<$L.length;$T++){var $k=$L[$T].attributes,$u=parseInt($k.id.nodeValue),$S=parseInt($k.xoffset.nodeValue)/1,$Y=parseInt($k.yoffset.nodeValue)/1,$x=parseInt($k.xadvance.nodeValue)/1,$j=new $g();$j.x=parseInt($k.x.nodeValue),$j.y=parseInt($k.y.nodeValue),$j.width=parseInt($k.width.nodeValue),$j.height=parseInt($k.height.nodeValue);var $R=$xJ.create($h,$j.x,$j.y,$j.width,$j.height,$S,$Y);this._maxWidth=Math.max(this._maxWidth,$x+this.letterSpacing),this._fontCharDic[$u]=$R,this._fontWidthMap[$u]=$x;}}},$h.getCharTexture=function($J){return this._fontCharDic[$J.charCodeAt(0)];},$h.destroy=function(){if(this._texture){for(var $J in this._fontCharDic){var $h=this._fontCharDic[$J];$h&&$h.destroy();}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null;}},$h.setSpaceWidth=function($J){this._spaceWidth=$J;},$h.getCharWidth=function($J){var $h=$J.charCodeAt(0);return this._fontWidthMap[$h]?this._fontWidthMap[$h]+this.letterSpacing:" "==$J?this._spaceWidth+this.letterSpacing:0;},$h.getTextWidth=function($J){for(var $h=0,$f=0,$n=$J.length;$f<$n;$f++)$h+=this.getCharWidth($J.charAt($f));return $h;},$h.getMaxWidth=function(){return this._maxWidth;},$h.getMaxHeight=function(){return this.fontSize;},$h.drawText=function($J,$h,$f,$n,$L,$T){var $k,$u=this.getTextWidth($J),$S=0;"center"===$L&&($S=($T-$u)/2),"right"===$L&&($S=$T-$u);for(var $Y=0,$x=0,$j=$J.length;$x<$j;$x++)($k=this.getCharTexture($J.charAt($x)))&&($h.graphics.drawTexture($k,$f+$Y+$S,$n),$Y+=this.getCharWidth($J.charAt($x)));},$J;}(),$u=function(){function $f(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=$f._TF_EMPTY;}$q($f,"laya.display.css.Style");var $J=$f.prototype;return $J.getTransform=function(){return this._tf;},$J.setTransform=function($J){this._tf="none"!==$J&&$J?$J:$f._TF_EMPTY;},$J.setTranslateX=function($J){this._tf===$f._TF_EMPTY&&(this._tf=new $L()),this._tf.translateX=$J;},$J.setTranslateY=function($J){this._tf===$f._TF_EMPTY&&(this._tf=new $L()),this._tf.translateY=$J;},$J.setScaleX=function($J){this._tf===$f._TF_EMPTY&&(this._tf=new $L()),this._tf.scaleX=$J;},$J.setScale=function($J,$h){this._tf===$f._TF_EMPTY&&(this._tf=new $L()),this._tf.scaleX=$J,this._tf.scaleY=$h;},$J.setScaleY=function($J){this._tf===$f._TF_EMPTY&&(this._tf=new $L()),this._tf.scaleY=$J;},$J.setRotate=function($J){this._tf===$f._TF_EMPTY&&(this._tf=new $L()),this._tf.rotate=$J;},$J.setSkewX=function($J){this._tf===$f._TF_EMPTY&&(this._tf=new $L()),this._tf.skewX=$J;},$J.setSkewY=function($J){this._tf===$f._TF_EMPTY&&(this._tf=new $L()),this._tf.skewY=$J;},$J.destroy=function(){this.scrollRect=null;},$J.render=function($J,$h,$f,$n){},$J.getCSSStyle=function(){return $hJ.EMPTY;},$J._enableLayout=function(){return!1;},$x(0,$J,"scaleX",function(){return this._tf.scaleX;},function($J){this.setScaleX($J);}),$x(0,$J,"transform",function(){return this.getTransform();},function($J){this.setTransform($J);}),$x(0,$J,"translateX",function(){return this._tf.translateX;},function($J){this.setTranslateX($J);}),$x(0,$J,"translateY",function(){return this._tf.translateY;},function($J){this.setTranslateY($J);}),$x(0,$J,"scaleY",function(){return this._tf.scaleY;},function($J){this.setScaleY($J);}),$x(0,$J,"block",function(){return 0!=(1&this._type);}),$x(0,$J,"skewY",function(){return this._tf.skewY;},function($J){this.setSkewY($J);}),$x(0,$J,"rotate",function(){return this._tf.rotate;},function($J){this.setRotate($J);}),$x(0,$J,"skewX",function(){return this._tf.skewX;},function($J){this.setSkewX($J);}),$x(0,$J,"paddingLeft",function(){return 0;}),$x(0,$J,"paddingTop",function(){return 0;}),$x(0,$J,"absolute",function(){return!0;}),$f.__init__=function(){$f._TF_EMPTY=new $L(),$f.EMPTY=new $f();},$f.EMPTY=null,$f._TF_EMPTY=null,$f;}(),$l=function(){function $h($J){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=$e.create($h.defaultColor),this.family=$h.defaultFamily,this.stroke=$h._STROKE,this.size=$h.defaultSize,$J&&$J!==$h.EMPTY&&$J.copyTo(this);}$q($h,"laya.display.css.Font");var $J=$h.prototype;return $J.set=function($J){this._text=null;for(var $h=$J.split(" "),$f=0,$n=$h.length;$f<$n;$f++){var $L=$h[$f];switch($L){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue;}0<$L.indexOf("px")&&(this.size=parseInt($L),this.family=$h[$f+1],$f++);}},$J.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family;},$J.copyTo=function($J){$J._type=this._type,$J._text=this._text,$J._weight=this._weight,$J._color=this._color,$J.family=this.family,$J.stroke=this.stroke!=$h._STROKE?this.stroke.slice():$h._STROKE,$J.indent=this.indent,$J.size=this.size;},$x(0,$J,"password",function(){return 0!=(1024&this._type);},function($J){$J?this._type|=1024:this._type&=-1025;}),$x(0,$J,"color",function(){return this._color.strColor;},function($J){this._color=$e.create($J);}),$x(0,$J,"italic",function(){return 0!=(512&this._type);},function($J){$J?this._type|=512:this._type&=-513;}),$x(0,$J,"bold",function(){return 0!=(2048&this._type);},function($J){$J?this._type|=2048:this._type&=-2049;}),$x(0,$J,"weight",function(){return""+this._weight;},function($J){var $h=0;switch($J){case"normal":break;case"bold":this.bold=!0,$h=700;break;case"bolder":$h=800;break;case"lighter":$h=100;break;default:$h=parseInt($J);}this._weight=$h,this._text=null;}),$x(0,$J,"decoration",function(){return this._decoration?this._decoration.value:null;},function($J){var $h=$J.split(" ");switch(this._decoration||(this._decoration={}),$h[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=$h[0];}$h[1]&&(this._decoration.color=$e.create($h)),this._decoration.value=$J;}),$h.__init__=function(){$h.EMPTY=new $h(null);},$h.EMPTY=null,$h.defaultColor="#000000",$h.defaultSize=12,$h.defaultFamily="Arial",$h.defaultFont="12px Arial",$h._STROKE=[0,"#000000"],$h._ITALIC=512,$h._PASSWORD=1024,$h._BOLD=2048,$h;}(),$L=function(){function $J(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0;}return $q($J,"laya.display.css.TransformInfo"),$J;}(),$R=function(){function $j(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,$I.isConchNode){this._nativeObj=new $k._conchGraphics(),this.id=this._nativeObj.conchID;}}$q($j,"laya.display.Graphics");var $J=$j.prototype;return $J.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null;},$J.clear=function($J){void 0===$J&&($J=!1);var $h=0,$f=0;if($J){var $n=this._one;if(this._cmds){for($f=this._cmds.length,$h=0;$h<$f;$h++)!($n=this._cmds[$h])||$n.callee!==$I._context._drawTexture&&$n.callee!==$I._context._drawTextureWithTransform||($n[0]=null,$j._cache.push($n));this._cmds.length=0;}else $n&&(!$n||$n.callee!==$I._context._drawTexture&&$n.callee!==$I._context._drawTextureWithTransform||($n[0]=null,$j._cache.push($n)));}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for($h=0,$f=this._vectorgraphArray.length;$h<$f;$h++)$N.getInstance().deleteShape(this._vectorgraphArray[$h]);this._vectorgraphArray.length=0;}},$J._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset();},$J._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new $f(),this._graphicBounds._graphics=this);},$J._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint();},$J._isOnlyOne=function(){return!this._cmds||0===this._cmds.length;},$J.getBounds=function($J){return void 0===$J&&($J=!1),this._initGraphicBounds(),this._graphicBounds.getBounds($J);},$J.getBoundPoints=function($J){return void 0===$J&&($J=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints($J);},$J._addCmd=function($J){this._cmds=this._cmds||[],$J.callee=$J.shift(),this._cmds.push($J);},$J.setFilters=function($J){this._saveToCmd($I._context._setFilters,$J);},$J.drawTexture=function($J,$h,$f,$n,$L,$T,$k){if(void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=0),void 0===$L&&($L=0),void 0===$k&&($k=1),!$J||$k<.01)return null;$n||($n=$J.sourceWidth),$L||($L=$J.sourceHeight),$k=$k<0?0:1<$k?1:$k;var $u,$S=!$I.isWebGL&&($a.onFirefox||$a.onEdge||$a.onIE||$a.onSafari)?.5:0,$Y=$n/$J.sourceWidth,$x=$L/$J.sourceHeight;return $n=$J.width*$Y,$L=$J.height*$x,$J.loaded&&($n<=0||$L<=0)?null:($h+=$J.offsetX*$Y,$f+=$J.offsetY*$x,this._sp&&(this._sp._renderType|=512),$h-=$S,$f-=$S,$n+=2*$S,$L+=2*$S,$j._cache.length?(($u=$j._cache.pop())[0]=$J,$u[1]=$h,$u[2]=$f,$u[3]=$n,$u[4]=$L,$u[5]=$T,$u[6]=$k):$u=[$J,$h,$f,$n,$L,$T,$k],$u.callee=$T||1!=$k?$I._context._drawTextureWithTransform:$I._context._drawTexture,null!=this._one||$T||1!=$k?this._saveToCmd($u.callee,$u):(this._one=$u,this._render=this._renderOneImg),$J.loaded||$J.once("loaded",this,this._textureLoaded,[$J,$u]),this._repaint(),$u);},$J.cleanByTexture=function($J,$h,$f,$n,$L){if(void 0===$n&&($n=0),void 0===$L&&($L=0),!$J)return this.clear();if(this._one&&this._render===this._renderOneImg){$n||($n=$J.sourceWidth),$L||($L=$J.sourceHeight);var $T=$n/$J.sourceWidth,$k=$L/$J.sourceHeight;$n=$J.width*$T,$L=$J.height*$k,$h+=$J.offsetX*$T,$f+=$J.offsetY*$k,this._one[0]=$J,this._one[1]=$h,this._one[2]=$f,this._one[3]=$n,this._one[4]=$L,this._repaint();}else this.clear(),$J&&this.drawTexture($J,$h,$f,$n,$L);},$J.drawTextures=function($J,$h){$J&&this._saveToCmd($I._context._drawTextures,[$J,$h]);},$J.fillTexture=function($J,$h,$f,$n,$L,$T,$k){if(void 0===$n&&($n=0),void 0===$L&&($L=0),void 0===$T&&($T="repeat"),$J){var $u=[$J,$h,$f,$n,$L,$T,$k||$D.EMPTY,{}];$J.loaded||$J.once("loaded",this,this._textureLoaded,[$J,$u]),this._saveToCmd($I._context._fillTexture,$u);}},$J._textureLoaded=function($J,$h){$h[3]=$h[3]||$J.width,$h[4]=$h[4]||$J.height,this._repaint();},$J.fillCircle=function($J,$h,$f,$n,$L,$T,$k){$f.bitmap.enableMerageInAtlas=!1;var $u=new Float32Array(2*($k+1)),$S=new Float32Array(2*($k+1)),$Y=new Uint16Array(3*$k),$x=2*Math.PI/$k,$j=0;$u[0]=$n,$u[1]=$L,$S[0]=$n/$f.width,$S[1]=$L/$f.height;for(var $R=2,$l=0;$l<$k;$l++){var $i=$T*Math.cos($j)+$n,$q=$T*Math.sin($j)+$L;$u[$R]=$i,$u[$R+1]=$q,$S[$R]=$i/$f.width,$S[$R+1]=$q/$f.height,$j+=$x,$R+=2;}for($l=$R=0;$l<$k;$l++)$Y[$R++]=0,$Y[$R++]=$l+1,$Y[$R++]=$k+1<=$l+2?1:$l+2;this.drawTriangles($f,$J,$h,$u,$S,$Y);},$J.drawTriangles=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){void 0===$u&&($u=1),this._saveToCmd($I._context.drawTriangles,[$J,$h,$f,$n,$L,$T,$k,$u,$S,$Y]);},$J._saveToCmd=function($J,$h){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=$h,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push($h)),$h.callee=$J,this._repaint(),$h;},$J.clipRect=function($J,$h,$f,$n){this._saveToCmd($I._context._clipRect,[$J,$h,$f,$n]);},$J.fillText=function($J,$h,$f,$n,$L,$T,$k){void 0===$k&&($k=0),this._saveToCmd($I._context._fillText,[$J,$h,$f,$n||$l.defaultFont,$L,$T]);},$J.fillBorderText=function($J,$h,$f,$n,$L,$T,$k,$u){this._saveToCmd($I._context._fillBorderText,[$J,$h,$f,$n||$l.defaultFont,$L,$T,$k,$u]);},$J.strokeText=function($J,$h,$f,$n,$L,$T,$k){this._saveToCmd($I._context._strokeText,[$J,$h,$f,$n||$l.defaultFont,$L,$T,$k]);},$J.alpha=function($J){$J=$J<0?0:1<$J?1:$J,this._saveToCmd($I._context._alpha,[$J]);},$J.setAlpha=function($J){$J=$J<0?0:1<$J?1:$J,this._saveToCmd($I._context._setAlpha,[$J]);},$J.transform=function($J,$h,$f){void 0===$h&&($h=0),void 0===$f&&($f=0),this._saveToCmd($I._context._transform,[$J,$h,$f]);},$J.rotate=function($J,$h,$f){void 0===$h&&($h=0),void 0===$f&&($f=0),this._saveToCmd($I._context._rotate,[$J,$h,$f]);},$J.scale=function($J,$h,$f,$n){void 0===$f&&($f=0),void 0===$n&&($n=0),this._saveToCmd($I._context._scale,[$J,$h,$f,$n]);},$J.translate=function($J,$h){this._saveToCmd($I._context._translate,[$J,$h]);},$J.save=function(){this._saveToCmd($I._context._save,[]);},$J.restore=function(){this._saveToCmd($I._context._restore,[]);},$J.replaceText=function($J){this._repaint();var $h=this._cmds;if($h){for(var $f=$h.length-1;-1<$f;$f--)if(this._isTextCmd($h[$f].callee))return $h[$f][0].toUpperCase?$h[$f][0]=$J:$h[$f][0].setText($J),!0;}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=$J:this._one[0].setText($J),!0;return!1;},$J._isTextCmd=function($J){return $J===$I._context._fillText||$J===$I._context._fillBorderText||$J===$I._context._strokeText;},$J.replaceTextColor=function($J){this._repaint();var $h=this._cmds;if($h)for(var $f=$h.length-1;-1<$f;$f--)this._isTextCmd($h[$f].callee)&&($h[$f][4]=$J,$h[$f][0].toUpperCase||($h[$f][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=$J,this._one[0].toUpperCase||(this._one[0].changed=!0));},$J.loadImage=function($J,$h,$f,$n,$L,$T){var $k=this;void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=0),void 0===$L&&($L=0);var $u=$uJ.getRes($J);function $S($J){$J&&($k.drawTexture($J,$h,$f,$n,$L),null!=$T&&$T.call($k._sp,$J));}$u?$S($u):$Q.loader.load($J,$_.create(null,$S),null,"image");},$J._renderEmpty=function($J,$h,$f,$n){},$J._renderAll=function($J,$h,$f,$n){for(var $L,$T=this._cmds,$k=0,$u=$T.length;$k<$u;$k++)($L=$T[$k]).callee.call($h,$f,$n,$L);},$J._renderOne=function($J,$h,$f,$n){this._one.callee.call($h,$f,$n,this._one);},$J._renderOneImg=function($J,$h,$f,$n){this._one.callee.call($h,$f,$n,this._one),2305!==$J._renderType&&($J._renderType|=1);},$J.drawLine=function($J,$h,$f,$n,$L,$T){void 0===$T&&($T=1);var $k=0;$I.isWebGL&&($k=$N.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($k));var $u=$T%2==0?0:.5,$S=[$J+$u,$h+$u,$f+$u,$n+$u,$L,$T,$k];this._saveToCmd($I._context._drawLine,$S);},$J.drawLines=function($J,$h,$f,$n,$L){void 0===$L&&($L=1);var $T=0;if($f&&!($f.length<4)){$I.isWebGL&&($T=$N.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($T));var $k=$L%2==0?0:.5,$u=[$J+$k,$h+$k,$f,$n,$L,$T];this._saveToCmd($I._context._drawLines,$u);}},$J.drawCurves=function($J,$h,$f,$n,$L){void 0===$L&&($L=1);var $T=[$J,$h,$f,$n,$L];this._saveToCmd($I._context._drawCurves,$T);},$J.drawRect=function($J,$h,$f,$n,$L,$T,$k){void 0===$k&&($k=1);var $u=$T?$k/2:0,$S=$T?$k:0,$Y=[$J+$u,$h+$u,$f-$S,$n-$S,$L,$T,$k];this._saveToCmd($I._context._drawRect,$Y);},$J.drawCircle=function($J,$h,$f,$n,$L,$T){void 0===$T&&($T=1);var $k=$L?$T/2:0,$u=0;$I.isWebGL&&($u=$N.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($u));var $S=[$J,$h,$f-$k,$n,$L,$T,$u];this._saveToCmd($I._context._drawCircle,$S);},$J.drawPie=function($J,$h,$f,$n,$L,$T,$k,$u){void 0===$u&&($u=1);var $S=$k?$u/2:0,$Y=$k?$u:0,$x=0;$I.isWebGL&&($x=$N.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($x));var $j=[$J+$S,$h+$S,$f-$Y,$n,$L,$T,$k,$u,$x];$j[3]=$E.toRadian($n),$j[4]=$E.toRadian($L),this._saveToCmd($I._context._drawPie,$j);},$J.drawPoly=function($J,$h,$f,$n,$L,$T){void 0===$T&&($T=1);var $k=0,$u=!1;$I.isWebGL&&($k=$N.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($k),$u=!(6<$f.length));var $S=$L?$T%2==0?0:.5:0,$Y=[$J+$S,$h+$S,$f,$n,$L,$T,$k,$u];this._saveToCmd($I._context._drawPoly,$Y);},$J.drawPath=function($J,$h,$f,$n,$L){var $T=[$J,$h,$f,$n,$L];this._saveToCmd($I._context._drawPath,$T);},$x(0,$J,"cmds",function(){return this._cmds;},function($J){this._sp&&(this._sp._renderType|=512),this._cmds=$J,this._render=this._renderAll,this._repaint();}),$j.__init__=function(){if($I.isConchNode){for(var $J=laya.display.Graphics.prototype,$h=$a.window.ConchGraphics.prototype,$f=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],$n=0,$L=$f.length;$n<=$L;$n++){var $T=$f[$n];$J[$T]=$h[$T];}$J._saveToCmd=null,$h.drawImageS&&($J.drawTextures=function($J,$h){if($J&&$J.loaded&&$J.bitmap&&$J.source){var $f=$J.uv,$n=$J.bitmap.width,$L=$J.bitmap.height;this.drawImageS($J.bitmap.source,$f[0]*$n,$f[1]*$L,($f[2]-$f[0])*$n,($f[5]-$f[3])*$L,$J.offsetX,$J.offsetY,$J.width,$J.height,$h);}}),$J.drawTexture=function($J,$h,$f,$n,$L,$T,$k){if(void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=0),void 0===$L&&($L=0),void 0===$k&&($k=1),$J)if($J.loaded){if($J.loaded&&$J.bitmap&&$J.source&&($n||($n=$J.sourceWidth),$L||($L=$J.sourceHeight),$k=$k<0?0:1<$k?1:$k,$n=$n-$J.sourceWidth+$J.width,$L=$L-$J.sourceHeight+$J.height,!($n<=0||$L<=0))){$h+=$J.offsetX,$f+=$J.offsetY;var $u=$J.uv,$S=$J.bitmap.width,$Y=$J.bitmap.height;$u[4]<$u[0]&&$u[5]<$u[1]?this.drawImageM($J.bitmap.source,$u[4]*$S,$u[5]*$Y,($u[0]-$u[4])*$S,($u[1]-$u[5])*$Y,$h,$f,$n,$L,$T,$k):this.drawImageM($J.bitmap.source,$u[0]*$S,$u[1]*$Y,($u[2]-$u[0])*$S,($u[5]-$u[3])*$Y,$h,$f,$n,$L,$T,$k),this._repaint();}}else $J.once("loaded",this,function(){this.drawTexture($J,$h,$f,$n,$L,$T);});},$J.fillTexture=function($J,$h,$f,$n,$L,$T,$k){if(void 0===$n&&($n=0),void 0===$L&&($L=0),void 0===$T&&($T="repeat"),$J&&$J.loaded){var $u,$S=$I._context.ctx,$Y=$J.bitmap.width,$x=$J.bitmap.height,$j=$J.uv;$u=$J.uv!=$xJ.DEF_UV?$S.createPattern($J.bitmap.source,$T,$j[0]*$Y,$j[1]*$x,($j[2]-$j[0])*$Y,($j[5]-$j[3])*$x):$S.createPattern($J.bitmap.source,$T);var $R=0,$l=0;$k&&($h+=$k.x%$J.width,$f+=$k.y%$J.height,$R-=$k.x%$J.width,$l-=$k.y%$J.height),this._fillImage($u,$h,$f,$R,$l,$n,$L);}};}},$j._cache=[],$j;}(),$f=function(){function $s(){this._cacheBoundsType=!1;}$q($s,"laya.display.GraphicsBounds");var $J=$s.prototype;return $J.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null;},$J.reset=function(){this._temp&&(this._temp.length=0);},$J.getBounds=function($J){return void 0===$J&&($J=!1),(!this._bounds||!this._temp||this._temp.length<1||$J!=this._cacheBoundsType)&&(this._bounds=$g._getWrapRec(this.getBoundPoints($J),this._bounds)),this._cacheBoundsType=$J,this._bounds;},$J.getBoundPoints=function($J){return void 0===$J&&($J=!1),(!this._temp||this._temp.length<1||$J!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints($J)),this._cacheBoundsType=$J,this._rstBoundPoints=$E.copyArray(this._rstBoundPoints,this._temp);},$J._getCmdPoints=function($J){void 0===$J&&($J=!1);var $h,$f,$n=$I._context,$L=this._graphics.cmds;if(($h=this._temp||(this._temp=[])).length=0,$L||null==this._graphics._one||($s._tempCmds.length=0,$s._tempCmds.push(this._graphics._one),$L=$s._tempCmds),!$L)return $h;($f=$s._tempMatrixArrays).length=0;var $T=$s._initMatrix;$T.identity();for(var $k,$u,$S=$s._tempMatrix,$Y=NaN,$x=NaN,$j=NaN,$R=NaN,$l=NaN,$i=NaN,$q=0,$o=$L.length;$q<$o;$q++)if(($k=$L[$q]).callee)switch($k.callee){case $n._save:case 7:$f.push($T),$T=$T.clone();break;case $n._restore:case 8:$T=$f.pop();break;case $n._scale:case 5:$S.identity(),$S.translate(-$k[2],-$k[3]),$S.scale($k[0],$k[1]),$S.translate($k[2],$k[3]),this._switchMatrix($T,$S);break;case $n._rotate:case 3:$S.identity(),$S.translate(-$k[1],-$k[2]),$S.rotate($k[0]),$S.translate($k[1],$k[2]),this._switchMatrix($T,$S);break;case $n._translate:case 6:$S.identity(),$S.translate($k[0],$k[1]),this._switchMatrix($T,$S);break;case $n._transform:case 4:$S.identity(),$S.translate(-$k[1],-$k[2]),$S.concat($k[0]),$S.translate($k[1],$k[2]),this._switchMatrix($T,$S);break;case 16:case 24:$s._addPointArrToRst($h,$g._getBoundPointS($k[0],$k[1],$k[2],$k[3]),$T);break;case 17:$T.copyTo($S),$S.concat($k[4]),$s._addPointArrToRst($h,$g._getBoundPointS($k[0],$k[1],$k[2],$k[3]),$S);break;case $n._drawTexture:$u=$k[0],$J?$k[3]&&$k[4]?$s._addPointArrToRst($h,$g._getBoundPointS($k[1],$k[2],$k[3],$k[4]),$T):($u=$k[0],$s._addPointArrToRst($h,$g._getBoundPointS($k[1],$k[2],$u.width,$u.height),$T)):($Y=($k[3]||$u.sourceWidth)/$u.width,$x=($k[4]||$u.sourceHeight)/$u.height,$j=$Y*$u.sourceWidth,$R=$x*$u.sourceHeight,$l=0<$u.offsetX?$u.offsetX:0,$i=0<$u.offsetY?$u.offsetY:0,$l*=$Y,$i*=$x,$s._addPointArrToRst($h,$g._getBoundPointS($k[1]-$l,$k[2]-$i,$j,$R),$T));break;case $n._fillTexture:$k[3]&&$k[4]?$s._addPointArrToRst($h,$g._getBoundPointS($k[1],$k[2],$k[3],$k[4]),$T):($u=$k[0],$s._addPointArrToRst($h,$g._getBoundPointS($k[1],$k[2],$u.width,$u.height),$T));break;case $n._drawTextureWithTransform:var $r;$r=$k[5]?($T.copyTo($S),$S.concat($k[5]),$S):$T,$J?$k[3]&&$k[4]?$s._addPointArrToRst($h,$g._getBoundPointS($k[1],$k[2],$k[3],$k[4]),$r):($u=$k[0],$s._addPointArrToRst($h,$g._getBoundPointS($k[1],$k[2],$u.width,$u.height),$r)):($u=$k[0],$Y=($k[3]||$u.sourceWidth)/$u.width,$x=($k[4]||$u.sourceHeight)/$u.height,$j=$Y*$u.sourceWidth,$R=$x*$u.sourceHeight,$l=0<$u.offsetX?$u.offsetX:0,$i=0<$u.offsetY?$u.offsetY:0,$l*=$Y,$i*=$x,$s._addPointArrToRst($h,$g._getBoundPointS($k[1]-$l,$k[2]-$i,$j,$R),$r));break;case $n._drawRect:case 13:$s._addPointArrToRst($h,$g._getBoundPointS($k[0],$k[1],$k[2],$k[3]),$T);break;case $n._drawCircle:case $n._fillCircle:case 14:$s._addPointArrToRst($h,$g._getBoundPointS($k[0]-$k[2],$k[1]-$k[2],$k[2]+$k[2],$k[2]+$k[2]),$T);break;case $n._drawLine:case 20:$s._tempPoints.length=0;var $_;$_=.5*$k[5],$k[0]==$k[2]?$s._tempPoints.push($k[0]+$_,$k[1],$k[2]+$_,$k[3],$k[0]-$_,$k[1],$k[2]-$_,$k[3]):$k[1]==$k[3]?$s._tempPoints.push($k[0],$k[1]+$_,$k[2],$k[3]+$_,$k[0],$k[1]-$_,$k[2],$k[3]-$_):$s._tempPoints.push($k[0],$k[1],$k[2],$k[3]),$s._addPointArrToRst($h,$s._tempPoints,$T);break;case $n._drawCurves:case 22:$s._addPointArrToRst($h,$d.I.getBezierPoints($k[2]),$T,$k[0],$k[1]);break;case $n._drawPoly:case $n._drawLines:case 18:$s._addPointArrToRst($h,$k[2],$T,$k[0],$k[1]);break;case $n._drawPath:case 19:$s._addPointArrToRst($h,this._getPathPoints($k[2]),$T,$k[0],$k[1]);break;case $n._drawPie:case 15:$s._addPointArrToRst($h,this._getPiePoints($k[0],$k[1],$k[2],$k[3],$k[4]),$T);}return 200<$h.length?$h=$E.copyArray($h,$g._getWrapRec($h)._getBoundPoints()):8<$h.length&&($h=$p.scanPList($h)),$h;},$J._switchMatrix=function($J,$h){$h.concat($J),$h.copyTo($J);},$J._getPiePoints=function($J,$h,$f,$n,$L){var $T=$s._tempPoints;$s._tempPoints.length=0,$T.push($J,$h);var $k=($L-$n)%(2*Math.PI)/10,$u=NaN,$S=$n;for($u=0;$u<=10;$u++)$T.push($J+$f*Math.cos($S),$h+$f*Math.sin($S)),$S+=$k;return $T;},$J._getPathPoints=function($J){var $h,$f,$n=0,$L=$s._tempPoints;for($L.length=0,$h=$J.length,$n=0;$n<$h;$n++)1<($f=$J[$n]).length&&($L.push($f[1],$f[2]),3<$f.length&&$L.push($f[3],$f[4]));return $L;},$s._addPointArrToRst=function($J,$h,$f,$n,$L){void 0===$n&&($n=0),void 0===$L&&($L=0);var $T,$k=0;for($T=$h.length,$k=0;$k<$T;$k+=2)$s._addPointToRst($J,$h[$k]+$n,$h[$k+1]+$L,$f);},$s._addPointToRst=function($J,$h,$f,$n){var $L=$D.TEMP;$L.setTo($h||0,$f||0),$n.transformPoint($L),$J.push($L.x,$L.y);},$s._tempPoints=[],$s._tempMatrixArrays=[],$s._tempCmds=[],$S($s,["_tempMatrix",function(){return this._tempMatrix=new $O();},"_initMatrix",function(){return this._initMatrix=new $O();}]),$s;}(),$T=function(){function $J(){}$q($J,"laya.events.Event");var $h=$J.prototype;return $h.setTo=function($J,$h,$f){return this.type=$J,this.currentTarget=$h,this.target=$f,this;},$h.stopPropagation=function(){this._stoped=!0;},$x(0,$h,"stageY",function(){return $Q.stage.mouseY;}),$x(0,$h,"charCode",function(){return this.nativeEvent.charCode;}),$x(0,$h,"touches",function(){var $J=this.nativeEvent.touches;if($J)for(var $h=$Q.stage,$f=0,$n=$J.length;$f<$n;$f++){var $L=$J[$f],$T=$D.TEMP;$T.setTo($L.clientX,$L.clientY),$h._canvasTransform.invertTransformPoint($T),$h.transform.invertTransformPoint($T),$L.stageX=$T.x,$L.stageY=$T.y;}return $J;}),$x(0,$h,"keyLocation",function(){return this.nativeEvent.keyLocation;}),$x(0,$h,"ctrlKey",function(){return this.nativeEvent.ctrlKey;}),$x(0,$h,"altKey",function(){return this.nativeEvent.altKey;}),$x(0,$h,"shiftKey",function(){return this.nativeEvent.shiftKey;}),$x(0,$h,"stageX",function(){return $Q.stage.mouseX;}),$J.EMPTY=new $J(),$J.MOUSE_DOWN="mousedown",$J.MOUSE_UP="mouseup",$J.CLICK="click",$J.RIGHT_MOUSE_DOWN="rightmousedown",$J.RIGHT_MOUSE_UP="rightmouseup",$J.RIGHT_CLICK="rightclick",$J.MOUSE_MOVE="mousemove",$J.MOUSE_OVER="mouseover",$J.MOUSE_OUT="mouseout",$J.MOUSE_WHEEL="mousewheel",$J.ROLL_OVER="mouseover",$J.ROLL_OUT="mouseout",$J.DOUBLE_CLICK="doubleclick",$J.CHANGE="change",$J.CHANGED="changed",$J.RESIZE="resize",$J.ADDED="added",$J.REMOVED="removed",$J.DISPLAY="display",$J.UNDISPLAY="undisplay",$J.ERROR="error",$J.COMPLETE="complete",$J.LOADED="loaded",$J.INITED="inited",$J.PROGRESS="progress",$J.INPUT="input",$J.RENDER="render",$J.OPEN="open",$J.MESSAGE="message",$J.CLOSE="close",$J.KEY_DOWN="keydown",$J.KEY_PRESS="keypress",$J.KEY_UP="keyup",$J.FRAME="enterframe",$J.DRAG_START="dragstart",$J.DRAG_MOVE="dragmove",$J.DRAG_END="dragend",$J.ENTER="enter",$J.SELECT="select",$J.BLUR="blur",$J.FOCUS="focus",$J.VISIBILITY_CHANGE="visibilitychange",$J.FOCUS_CHANGE="focuschange",$J.PLAYED="played",$J.PAUSED="paused",$J.STOPPED="stopped",$J.START="start",$J.END="end",$J.ENABLE_CHANGED="enablechanged",$J.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",$J.COMPONENT_ADDED="componentadded",$J.COMPONENT_REMOVED="componentremoved",$J.LAYER_CHANGED="layerchanged",$J.HIERARCHY_LOADED="hierarchyloaded",$J.RECOVERED="recovered",$J.RELEASED="released",$J.LINK="link",$J.LABEL="label",$J.FULL_SCREEN_CHANGE="fullscreenchange",$J.DEVICE_LOST="devicelost",$J.MESH_CHANGED="meshchanged",$J.MATERIAL_CHANGED="materialchanged",$J.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",$J.ANIMATION_CHANGED="animationchanged",$J.TRIGGER_ENTER="triggerenter",$J.TRIGGER_STAY="triggerstay",$J.TRIGGER_EXIT="triggerexit",$J.TRAIL_FILTER_CHANGE="trailfilterchange",$J.DOMINO_FILTER_CHANGE="dominofilterchange",$J;}(),$j=(function(){function $J(){}$q($J,"laya.events.Keyboard"),$J.NUMBER_0=48,$J.NUMBER_1=49,$J.NUMBER_2=50,$J.NUMBER_3=51,$J.NUMBER_4=52,$J.NUMBER_5=53,$J.NUMBER_6=54,$J.NUMBER_7=55,$J.NUMBER_8=56,$J.NUMBER_9=57,$J.A=65,$J.B=66,$J.C=67,$J.D=68,$J.E=69,$J.F=70,$J.G=71,$J.H=72,$J.I=73,$J.J=74,$J.K=75,$J.L=76,$J.M=77,$J.N=78,$J.O=79,$J.P=80,$J.Q=81,$J.R=82,$J.S=83,$J.T=84,$J.U=85,$J.V=86,$J.W=87,$J.X=88,$J.Y=89,$J.Z=90,$J.F1=112,$J.F2=113,$J.F3=114,$J.F4=115,$J.F5=116,$J.F6=117,$J.F7=118,$J.F8=119,$J.F9=120,$J.F10=121,$J.F11=122,$J.F12=123,$J.F13=124,$J.F14=125,$J.F15=126,$J.NUMPAD=21,$J.NUMPAD_0=96,$J.NUMPAD_1=97,$J.NUMPAD_2=98,$J.NUMPAD_3=99,$J.NUMPAD_4=100,$J.NUMPAD_5=101,$J.NUMPAD_6=102,$J.NUMPAD_7=103,$J.NUMPAD_8=104,$J.NUMPAD_9=105,$J.NUMPAD_ADD=107,$J.NUMPAD_DECIMAL=110,$J.NUMPAD_DIVIDE=111,$J.NUMPAD_ENTER=108,$J.NUMPAD_MULTIPLY=106,$J.NUMPAD_SUBTRACT=109,$J.SEMICOLON=186,$J.EQUAL=187,$J.COMMA=188,$J.MINUS=189,$J.PERIOD=190,$J.SLASH=191,$J.BACKQUOTE=192,$J.LEFTBRACKET=219,$J.BACKSLASH=220,$J.RIGHTBRACKET=221,$J.QUOTE=222,$J.ALTERNATE=18,$J.BACKSPACE=8,$J.CAPS_LOCK=20,$J.COMMAND=15,$J.CONTROL=17,$J.DELETE=46,$J.ENTER=13,$J.ESCAPE=27,$J.PAGE_UP=33,$J.PAGE_DOWN=34,$J.END=35,$J.HOME=36,$J.LEFT=37,$J.UP=38,$J.RIGHT=39,$J.DOWN=40,$J.SHIFT=16,$J.SPACE=32,$J.TAB=9,$J.INSERT=45;}(),function(){function $L(){}return $q($L,"laya.events.KeyBoardManager"),$L.__init__=function(){$L._addEvent("keydown"),$L._addEvent("keypress"),$L._addEvent("keyup");},$L._addEvent=function($h){$a.document.addEventListener($h,function($J){laya.events.KeyBoardManager._dispatch($J,$h);},!0);},$L._dispatch=function($J,$h){if($L.enabled){$L._event._stoped=!1,$L._event.nativeEvent=$J,$L._event.keyCode=$J.keyCode||$J.which||$J.charCode,"keydown"===$h?$L._pressKeys[$L._event.keyCode]=!0:"keyup"===$h&&($L._pressKeys[$L._event.keyCode]=null);for(var $f=$Q.stage.focus&&null!=$Q.stage.focus.event&&$Q.stage.focus.displayedInStage?$Q.stage.focus:$Q.stage,$n=$f;$n;)$n.event($h,$L._event.setTo($h,$n,$f)),$n=$n.parent;}},$L.hasKeyDown=function($J){return $L._pressKeys[$J];},$L._pressKeys={},$L.enabled=!0,$S($L,["_event",function(){return this._event=new $T();}]),$L;}()),$i=(function(){function $J(){}$q($J,"laya.events.KeyLocation"),$J.STANDARD=0,$J.LEFT=1,$J.RIGHT=2,$J.NUM_PAD=3;}(),function(){function $x(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=$a.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new $T(),this._matrix=new $O(),this._point=new $D(),this._rect=new $g(),this._prePoint=new $D(),this._curTouchID=NaN;}$q($x,"laya.events.MouseManager");var $J=$x.prototype;return $J.__init__=function($J,$h){var $f=this;this._stage=$J;var $n=this,$L=this._eventList;$h.oncontextmenu=function($J){if($x.enabled)return!1;},$h.addEventListener("mousedown",function($J){$x.enabled&&($a.onIE||$J.preventDefault(),$L.push($J),$n.mouseDownTime=$a.now());}),$h.addEventListener("mouseup",function($J){$x.enabled&&($J.preventDefault(),$L.push($J),$n.mouseDownTime=-$a.now());},!0),$h.addEventListener("mousemove",function($J){if($x.enabled){$J.preventDefault();var $h=$a.now();if($h-$n._lastMoveTimer<10)return;$n._lastMoveTimer=$h,$L.push($J);}},!0),$h.addEventListener("mouseout",function($J){$x.enabled&&$L.push($J);}),$h.addEventListener("mouseover",function($J){$x.enabled&&$L.push($J);}),$h.addEventListener("touchstart",function($J){$x.enabled&&($L.push($J),$x._isFirstTouch||$pJ.isInputting||$J.preventDefault(),$n.mouseDownTime=$a.now());}),$h.addEventListener("touchend",function($J){$x.enabled?($x._isFirstTouch||$pJ.isInputting||$J.preventDefault(),$x._isFirstTouch=!1,$L.push($J),$n.mouseDownTime=-$a.now()):$f._curTouchID=NaN;},!0),$h.addEventListener("touchmove",function($J){$x.enabled&&($J.preventDefault(),$L.push($J));},!0),$h.addEventListener("touchcancel",function($J){$x.enabled?($J.preventDefault(),$L.push($J)):$f._curTouchID=NaN;},!0),$h.addEventListener("mousewheel",function($J){$x.enabled&&$L.push($J);}),$h.addEventListener("DOMMouseScroll",function($J){$x.enabled&&$L.push($J);});},$J.initEvent=function($J,$h){var $f;this._event._stoped=!1,this._event.nativeEvent=$h||$J,this._target=null,this._point.setTo($J.pageX||$J.clientX,$J.pageY||$J.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=$J.identifier||0,this._tTouchID=this._event.touchId,($f=$o.I._event)._stoped=!1,$f.nativeEvent=this._event.nativeEvent,$f.touchId=this._event.touchId;},$J.checkMouseWheel=function($J){this._event.delta=$J.wheelDelta?.025*$J.wheelDelta:-$J.detail;for(var $h=$o.I.getLastOvers(),$f=0,$n=$h.length;$f<$n;$f++){var $L=$h[$f];$L.event("mousewheel",this._event.setTo("mousewheel",$L,this._target));}},$J.onMouseMove=function($J){$o.I.onMouseMove($J,this._tTouchID);},$J.onMouseDown=function($J){if($pJ.isInputting&&$Q.stage.focus&&$Q.stage.focus.focus&&!$Q.stage.focus.contains(this._target)){var $h=$Q.stage.focus._tf||$Q.stage.focus,$f=$J._tf||$J;$f instanceof laya.display.Input&&$f.multiline==$h.multiline?$h._focusOut():$h.focus=!1;}$o.I.onMouseDown($J,this._tTouchID,this._isLeftMouse);},$J.onMouseUp=function($J){$o.I.onMouseUp($J,this._tTouchID,this._isLeftMouse);},$J.check=function($J,$h,$f,$n){this._point.setTo($h,$f),$J.fromParentPoint(this._point),$h=this._point.x,$f=this._point.y;var $L=$J.scrollRect;if($L&&(this._rect.setTo($L.x,$L.y,$L.width,$L.height),!this._rect.contains($h,$f)))return!1;if(!this.disableMouseEvent){if($J.hitTestPrior&&!$J.mouseThrough&&!this.hitTest($J,$h,$f))return!1;for(var $T=$J._childs.length-1;-1<$T;$T--){var $k=$J._childs[$T];if(!$k.destroyed&&$k.mouseEnabled&&$k.visible&&this.check($k,$h,$f,$n))return!0;}}var $u=!(!$J.hitTestPrior||$J.mouseThrough||this.disableMouseEvent)||this.hitTest($J,$h,$f);return $u?(this._target=$J,$n.call(this,$J)):$n===this.onMouseUp&&$J===this._stage&&(this._target=this._stage,$n.call(this,this._target)),$u;},$J.hitTest=function($J,$h,$f){var $n=!1;if($J.scrollRect&&($h-=$J.scrollRect.x,$f-=$J.scrollRect.y),$J.hitArea instanceof laya.utils.HitArea)return $J.hitArea.isHit($h,$f);if(0<$J.width&&0<$J.height||$J.mouseThrough||$J.hitArea)if($J.mouseThrough)$n=$J.getGraphicBounds().contains($h,$f);else{var $L=this._rect;$J.hitArea?$L=$J.hitArea:$L.setTo(0,0,$J.width,$J.height),$n=$L.contains($h,$f);}return $n;},$J.runEvent=function(){var $J=this._eventList.length;if($J){var $h=this;$h.mouseEventTime=$a.now();var $f,$n=0,$L=0,$T=0;try{for(;$n<$J;){var $k=this._eventList[$n];switch("mousemove"!==$k.type&&(this._prePoint.x=this._prePoint.y=-1e6),$k.type){case"mousedown":this._touchIDs[0]=this._id++,$x._isTouchRespond?$x._isTouchRespond=!1:($h._isLeftMouse=0===$k.button,$h.initEvent($k),$h.check($h._stage,$h.mouseX,$h.mouseY,$h.onMouseDown));break;case"mouseup":$h._isLeftMouse=0===$k.button,$h.initEvent($k),$h.check($h._stage,$h.mouseX,$h.mouseY,$h.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-$k.clientX)+Math.abs(this._prePoint.y-$k.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=$k.clientX,this._prePoint.y=$k.clientY,$h.initEvent($k),$h.check($h._stage,$h.mouseX,$h.mouseY,$h.onMouseMove));break;case"touchstart":$x._isTouchRespond=!0,$h._isLeftMouse=!0;var $u=$k.changedTouches;for($L=0,$T=$u.length;$L<$T;$L++)$f=$u[$L],($x.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=$f.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[$f.identifier]=this._id++,$h.initEvent($f,$k),$h.check($h._stage,$h.mouseX,$h.mouseY,$h.onMouseDown));break;case"touchend":case"touchcancel":$x._isTouchRespond=!0,$h._isLeftMouse=!0;var $S=$k.changedTouches;for($L=0,$T=$S.length;$L<$T;$L++)if($f=$S[$L],$x.multiTouchEnabled||$f.identifier==this._curTouchID){this._curTouchID=NaN,$h.initEvent($f,$k);$h.check($h._stage,$h.mouseX,$h.mouseY,$h.onMouseUp)||$h.onMouseUp(null);}break;case"touchmove":var $Y=$k.changedTouches;for($L=0,$T=$Y.length;$L<$T;$L++)$f=$Y[$L],($x.multiTouchEnabled||$f.identifier==this._curTouchID)&&($h.initEvent($f,$k),$h.check($h._stage,$h.mouseX,$h.mouseY,$h.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":$h.checkMouseWheel($k);break;case"mouseout":$o.I.stageMouseOut();break;case"mouseover":$h._stage.event("mouseover",$h._event.setTo("mouseover",$h._stage,$h._stage));}$n++;}}catch($J){throw this._eventList.length=0,$J;}this._eventList.length=0;}},$x.enabled=!0,$x.multiTouchEnabled=!0,$x._isTouchRespond=!1,$x._isFirstTouch=!0,$S($x,["instance",function(){return this.instance=new $x();}]),$x;}()),$o=function(){function $i(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new $T();}$q($i,"laya.events.TouchManager");var $J=$i.prototype;return $J._clearTempArrs=function(){$i._oldArr.length=0,$i._newArr.length=0,$i._tEleArr.length=0;},$J.getTouchFromArr=function($J,$h){var $f,$n,$L=0;for($f=$h.length,$L=0;$L<$f;$L++)if(($n=$h[$L]).id==$J)return $n;return null;},$J.removeTouchFromArr=function($J,$h){var $f=0;for($f=$h.length-1;0<=$f;$f--)$h[$f].id==$J&&$h.splice($f,1);},$J.createTouchO=function($J,$h){var $f;return($f=$$.getItem("TouchData")||{}).id=$h,$f.tar=$J,$f;},$J.onMouseDown=function($J,$h,$f){var $n,$L,$T,$k;(void 0===$f&&($f=!1),this.enable)&&($n=this.getTouchFromArr($h,this.preOvers),$T=this.getEles($J,null,$i._tEleArr),$n?$n.tar=$J:($L=this.createTouchO($J,$h),this.preOvers.push($L)),$a.onMobile&&this.sendEvents($T,"mouseover",$h),$k=$f?this.preDowns:this.preRightDowns,($n=this.getTouchFromArr($h,$k))?$n.tar=$J:($L=this.createTouchO($J,$h),$k.push($L)),this.sendEvents($T,$f?"mousedown":"rightmousedown",$h),this._clearTempArrs());},$J.sendEvents=function($J,$h,$f){void 0===$f&&($f=0);var $n,$L,$T,$k=0;for($n=$J.length,this._event._stoped=!1,$L=$J[0],$k=0;$k<$n;$k++){if(($T=$J[$k]).destroyed)return;if($T.event($h,this._event.setTo($h,$T,$L)),this._event._stoped)break;}},$J.getEles=function($J,$h,$f){for($f?$f.length=0:$f=[];$J&&$J!=$h;)$f.push($J),$J=$J.parent;return $f;},$J.checkMouseOutAndOverOfMove=function($J,$h,$f){if(void 0===$f&&($f=0),$h!=$J){var $n,$L,$T=0,$k=0;if($h.contains($J))$L=this.getEles($J,$h,$i._tEleArr),this.sendEvents($L,"mouseover",$f);else if($J.contains($h))$L=this.getEles($h,$J,$i._tEleArr),this.sendEvents($L,"mouseout",$f);else{var $u,$S;($L=$i._tEleArr).length=0,$u=this.getEles($h,null,$i._oldArr),$S=this.getEles($J,null,$i._newArr),$k=$u.length;var $Y=0;for($T=0;$T<$k;$T++){if($n=$u[$T],0<=($Y=$S.indexOf($n))){$S.splice($Y,$S.length-$Y);break;}$L.push($n);}0<$L.length&&this.sendEvents($L,"mouseout",$f),0<$S.length&&this.sendEvents($S,"mouseover",$f);}}},$J.onMouseMove=function($J,$h){var $f,$n;this.enable&&(($f=this.getTouchFromArr($h,this.preOvers))?(this.checkMouseOutAndOverOfMove($J,$f.tar),$f.tar=$J,$n=this.getEles($J,null,$i._tEleArr)):($n=this.getEles($J,null,$i._tEleArr),this.sendEvents($n,"mouseover",$h),this.preOvers.push(this.createTouchO($J,$h))),this.sendEvents($n,"mousemove",$h),this._clearTempArrs());},$J.getLastOvers=function(){return($i._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,$i._tEleArr):($i._tEleArr.push($Q.stage),$i._tEleArr);},$J.stageMouseOut=function(){var $J;$J=this.getLastOvers(),this.preOvers.length=0,this.sendEvents($J,"mouseout",0);},$J.onMouseUp=function($J,$h,$f){if(void 0===$f&&($f=!1),this.enable){var $n,$L,$T,$k,$u,$S,$Y=0,$x=0,$j=$a.onMobile;if($L=this.getEles($J,null,$i._tEleArr),this.sendEvents($L,$f?"mouseup":"rightmouseup",$h),$S=$f?this.preDowns:this.preRightDowns,$n=this.getTouchFromArr($h,$S)){var $R,$l=$a.now();if($R=$l-this._lastClickTime<300,this._lastClickTime=$l,$J==$n.tar)$u=$L;else for($T=this.getEles($n.tar,null,$i._oldArr),($u=$i._newArr).length=0,$x=$T.length,$Y=0;$Y<$x;$Y++)$k=$T[$Y],0<=$L.indexOf($k)&&$u.push($k);0<$u.length&&this.sendEvents($u,$f?"click":"rightclick",$h),$f&&$R&&this.sendEvents($u,"doubleclick",$h),this.removeTouchFromArr($h,$S),$n.tar=null,$$.recover("TouchData",$n);}else;($n=this.getTouchFromArr($h,this.preOvers))&&$j&&(($u=this.getEles($n.tar,null,$u))&&0<$u.length&&this.sendEvents($u,"mouseout",$h),this.removeTouchFromArr($h,this.preOvers),$n.tar=null,$$.recover("TouchData",$n)),this._clearTempArrs();}},$i._oldArr=[],$i._newArr=[],$i._tEleArr=[],$S($i,["I",function(){return this.I=new $i();}]),$i;}(),$r=function(){function $J(){this._action=null;}$q($J,"laya.filters.Filter");var $h=$J.prototype;return $Q.imps($h,{"laya.filters.IFilter":!0}),$h.callNative=function($J){},$x(0,$h,"type",function(){return-1;}),$x(0,$h,"action",function(){return this._action;}),$J.BLUR=16,$J.COLOR=32,$J.GLOW=8,$J._filterStart=null,$J._filterEnd=null,$J._EndTarget=null,$J._recycleScope=null,$J._filter=null,$J._useSrc=null,$J._endSrc=null,$J._useOut=null,$J._endOut=null,$J;}(),$s=function(){function $J(){this.data=null;}$q($J,"laya.filters.ColorFilterAction");var $h=$J.prototype;return $Q.imps($h,{"laya.filters.IFilterAction":!0}),$h.apply=function($J){var $h=$J.ctx.ctx,$f=$J.ctx.ctx.canvas;if(0==$f.width||0==$f.height)return $f;for(var $n,$L=$h.getImageData(0,0,$f.width,$f.height),$T=$L.data,$k=0,$u=$T.length;$k<$u;$k+=4)$n=this.getColor($T[$k],$T[$k+1],$T[$k+2],$T[$k+3]),0!=$T[$k+3]&&($T[$k]=$n[0],$T[$k+1]=$n[1],$T[$k+2]=$n[2],$T[$k+3]=$n[3]);return $h.putImageData($L,0,0),$J;},$h.getColor=function($J,$h,$f,$n){var $L=[];if(this.data._mat&&this.data._alpha){var $T=this.data._mat,$k=this.data._alpha;$L[0]=$T[0]*$J+$T[1]*$h+$T[2]*$f+$T[3]*$n+$k[0],$L[1]=$T[4]*$J+$T[5]*$h+$T[6]*$f+$T[7]*$n+$k[1],$L[2]=$T[8]*$J+$T[9]*$h+$T[10]*$f+$T[11]*$n+$k[2],$L[3]=$T[12]*$J+$T[13]*$h+$T[14]*$f+$T[15]*$n+$k[3];}return $L;},$J;}(),$d=(function(){function $J(){}$q($J,"laya.maths.Arith"),$J.formatR=function($J){return $J>Math.PI&&($J-=2*Math.PI),$J<-Math.PI&&($J+=2*Math.PI),$J;},$J.isPOT=function($J,$h){return 0<$J&&0==($J&$J-1)&&0<$h&&0==($h&$h-1);},$J.setMatToArray=function($J,$h){$J.a,$J.b,$J.c,$J.d,$J.tx,$J.ty,$h[0]=$J.a,$h[1]=$J.b,$h[4]=$J.c,$h[5]=$J.d,$h[12]=$J.tx,$h[13]=$J.ty;};}(),function(){function $J(){this._controlPoints=[new $D(),new $D(),new $D()],this._calFun=this.getPoint2;}$q($J,"laya.maths.Bezier");var $h=$J.prototype;return $h._switchPoint=function($J,$h){var $f=this._controlPoints.shift();$f.setTo($J,$h),this._controlPoints.push($f);},$h.getPoint2=function($J,$h){var $f=this._controlPoints[0],$n=this._controlPoints[1],$L=this._controlPoints[2],$T=Math.pow(1-$J,2)*$f.x+2*$J*(1-$J)*$n.x+Math.pow($J,2)*$L.x,$k=Math.pow(1-$J,2)*$f.y+2*$J*(1-$J)*$n.y+Math.pow($J,2)*$L.y;$h.push($T,$k);},$h.getPoint3=function($J,$h){var $f=this._controlPoints[0],$n=this._controlPoints[1],$L=this._controlPoints[2],$T=this._controlPoints[3],$k=Math.pow(1-$J,3)*$f.x+3*$n.x*$J*(1-$J)*(1-$J)+3*$L.x*$J*$J*(1-$J)+$T.x*Math.pow($J,3),$u=Math.pow(1-$J,3)*$f.y+3*$n.y*$J*(1-$J)*(1-$J)+3*$L.y*$J*$J*(1-$J)+$T.y*Math.pow($J,3);$h.push($k,$u);},$h.insertPoints=function($J,$h){var $f,$n=NaN;for($f=1/($J=0<$J?$J:5),$n=0;$n<=1;$n+=$f)this._calFun($n,$h);},$h.getBezierPoints=function($J,$h,$f){void 0===$h&&($h=5),void 0===$f&&($f=2);var $n,$L,$T=0;if(($n=$J.length)<2*($f+1))return[];switch($L=[],$f){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[];}for(;this._controlPoints.length<=$f;)this._controlPoints.push(new $D());for($T=0;$T<2*$f;$T+=2)this._switchPoint($J[$T],$J[$T+1]);for($T=2*$f;$T<$n;$T+=2)this._switchPoint($J[$T],$J[$T+1]),$T/2%$f==0&&this.insertPoints($h,$L);return $L;},$S($J,["I",function(){return this.I=new $J();}]),$J;}()),$p=function(){function $Y(){}return $q($Y,"laya.maths.GrahamScan"),$Y.multiply=function($J,$h,$f){return($J.x-$f.x)*($h.y-$f.y)-($h.x-$f.x)*($J.y-$f.y);},$Y.dis=function($J,$h){return($J.x-$h.x)*($J.x-$h.x)+($J.y-$h.y)*($J.y-$h.y);},$Y._getPoints=function($J,$h,$f){for(void 0===$h&&($h=!1),$Y._mPointList||($Y._mPointList=[]);$Y._mPointList.length<$J;)$Y._mPointList.push(new $D());return $f||($f=[]),$f.length=0,$h?$Y.getFrom($f,$Y._mPointList,$J):$Y.getFromR($f,$Y._mPointList,$J),$f;},$Y.getFrom=function($J,$h,$f){var $n=0;for($n=0;$n<$f;$n++)$J.push($h[$n]);return $J;},$Y.getFromR=function($J,$h,$f){var $n=0;for($n=0;$n<$f;$n++)$J.push($h.pop());return $J;},$Y.pListToPointList=function($J,$h){void 0===$h&&($h=!1);var $f=0,$n=$J.length/2,$L=$Y._getPoints($n,$h,$Y._tempPointList);for($f=0;$f<$n;$f++)$L[$f].setTo($J[$f+$f],$J[$f+$f+1]);return $L;},$Y.pointListToPlist=function($J){var $h,$f=0,$n=$J.length,$L=$Y._temPList;for($f=$L.length=0;$f<$n;$f++)$h=$J[$f],$L.push($h.x,$h.y);return $L;},$Y.scanPList=function($J){return $E.copyArray($J,$Y.pointListToPlist($Y.scan($Y.pListToPointList($J,!0))));},$Y.scan=function($J){var $h,$f,$n,$L=0,$T=0,$k=0,$u=$J.length,$S={};for(($f=$Y._temArr).length=0,$L=($u=$J.length)-1;0<=$L;$L--)$n=($h=$J[$L]).x+"_"+$h.y,$S.hasOwnProperty($n)||($S[$n]=!0,$f.push($h));for($u=$f.length,$E.copyArray($J,$f),$L=1;$L<$u;$L++)($J[$L].y<$J[$k].y||$J[$L].y==$J[$k].y&&$J[$L].x<$J[$k].x)&&($k=$L);for($h=$J[0],$J[0]=$J[$k],$J[$k]=$h,$L=1;$L<$u-1;$L++){for($T=($k=$L)+1;$T<$u;$T++)(0<$Y.multiply($J[$T],$J[$k],$J[0])||0==$Y.multiply($J[$T],$J[$k],$J[0])&&$Y.dis($J[0],$J[$T])<$Y.dis($J[0],$J[$k]))&&($k=$T);$h=$J[$L],$J[$L]=$J[$k],$J[$k]=$h;}if(($f=$Y._temArr).length=0,$J.length<3)return $E.copyArray($f,$J);for($f.push($J[0],$J[1],$J[2]),$L=3;$L<$u;$L++){for(;2<=$f.length&&0<=$Y.multiply($J[$L],$f[$f.length-1],$f[$f.length-2]);)$f.pop();$J[$L]&&$f.push($J[$L]);}return $f;},$Y._mPointList=null,$Y._tempPointList=[],$Y._temPList=[],$Y._temArr=[],$Y;}(),$U=function(){function $L(){}return $q($L,"laya.maths.MathUtil"),$L.subtractVector3=function($J,$h,$f){$f[0]=$J[0]-$h[0],$f[1]=$J[1]-$h[1],$f[2]=$J[2]-$h[2];},$L.lerp=function($J,$h,$f){return $J*(1-$f)+$h*$f;},$L.scaleVector3=function($J,$h,$f){$f[0]=$J[0]*$h,$f[1]=$J[1]*$h,$f[2]=$J[2]*$h;},$L.lerpVector3=function($J,$h,$f,$n){var $L=$J[0],$T=$J[1],$k=$J[2];$n[0]=$L+$f*($h[0]-$L),$n[1]=$T+$f*($h[1]-$T),$n[2]=$k+$f*($h[2]-$k);},$L.lerpVector4=function($J,$h,$f,$n){var $L=$J[0],$T=$J[1],$k=$J[2],$u=$J[3];$n[0]=$L+$f*($h[0]-$L),$n[1]=$T+$f*($h[1]-$T),$n[2]=$k+$f*($h[2]-$k),$n[3]=$u+$f*($h[3]-$u);},$L.slerpQuaternionArray=function($J,$h,$f,$n,$L,$T,$k){var $u,$S,$Y,$x,$j,$R=$J[$h+0],$l=$J[$h+1],$i=$J[$h+2],$q=$J[$h+3],$o=$f[$n+0],$r=$f[$n+1],$_=$f[$n+2],$s=$f[$n+3];return($S=$R*$o+$l*$r+$i*$_+$q*$s)<0&&($S=-$S,$o=-$o,$r=-$r,$_=-$_,$s=-$s),$j=1e-6<1-$S?($u=Math.acos($S),$Y=Math.sin($u),$x=Math.sin((1-$L)*$u)/$Y,Math.sin($L*$u)/$Y):($x=1-$L,$L),$T[$k+0]=$x*$R+$j*$o,$T[$k+1]=$x*$l+$j*$r,$T[$k+2]=$x*$i+$j*$_,$T[$k+3]=$x*$q+$j*$s,$T;},$L.getRotation=function($J,$h,$f,$n){return Math.atan2($n-$h,$f-$J)/Math.PI*180;},$L.sortBigFirst=function($J,$h){return $J==$h?0:$J<$h?1:-1;},$L.sortSmallFirst=function($J,$h){return $J==$h?0:$J<$h?-1:1;},$L.sortNumBigFirst=function($J,$h){return parseFloat($h)-parseFloat($J);},$L.sortNumSmallFirst=function($J,$h){return parseFloat($J)-parseFloat($h);},$L.sortByKey=function($f,$J,$h){var $n;return void 0===$J&&($J=!1),void 0===$h&&($h=!0),$n=$J?$h?$L.sortNumBigFirst:$L.sortBigFirst:$h?$L.sortNumSmallFirst:$L.sortSmallFirst,function($J,$h){return $n($J[$f],$h[$f]);};},$L;}(),$O=function(){function $f($J,$h,$f,$n,$L,$T){this.inPool=!1,this.bTransform=!1,void 0===$J&&($J=1),void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=1),void 0===$L&&($L=0),void 0===$T&&($T=0),this.a=$J,this.b=$h,this.c=$f,this.d=$n,this.tx=$L,this.ty=$T,this._checkTransform();}$q($f,"laya.maths.Matrix");var $J=$f.prototype;return $J.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this;},$J._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d;},$J.setTranslate=function($J,$h){return this.tx=$J,this.ty=$h,this;},$J.translate=function($J,$h){return this.tx+=$J,this.ty+=$h,this;},$J.scale=function($J,$h){this.a*=$J,this.d*=$h,this.c*=$J,this.b*=$h,this.tx*=$J,this.ty*=$h,this.bTransform=!0;},$J.rotate=function($J){var $h=Math.cos($J),$f=Math.sin($J),$n=this.a,$L=this.c,$T=this.tx;this.a=$n*$h-this.b*$f,this.b=$n*$f+this.b*$h,this.c=$L*$h-this.d*$f,this.d=$L*$f+this.d*$h,this.tx=$T*$h-this.ty*$f,this.ty=$T*$f+this.ty*$h,this.bTransform=!0;},$J.skew=function($J,$h){var $f=Math.tan($J),$n=Math.tan($h),$L=this.a,$T=this.b;return this.a+=$n*this.c,this.b+=$n*this.d,this.c+=$f*$L,this.d+=$f*$T,this;},$J.invertTransformPoint=function($J){var $h=this.a,$f=this.b,$n=this.c,$L=this.d,$T=this.tx,$k=$h*$L-$f*$n,$u=$L/$k,$S=-$f/$k,$Y=-$n/$k,$x=$h/$k,$j=($n*this.ty-$L*$T)/$k,$R=-($h*this.ty-$f*$T)/$k;return $J.setTo($u*$J.x+$Y*$J.y+$j,$S*$J.x+$x*$J.y+$R);},$J.transformPoint=function($J){return $J.setTo(this.a*$J.x+this.c*$J.y+this.tx,this.b*$J.x+this.d*$J.y+this.ty);},$J.transformPointN=function($J){return $J.setTo(this.a*$J.x+this.c*$J.y,this.b*$J.x+this.d*$J.y);},$J.transformPointArray=function($J,$h){for(var $f=$J.length,$n=0;$n<$f;$n+=2){var $L=$J[$n],$T=$J[$n+1];$h[$n]=this.a*$L+this.c*$T+this.tx,$h[$n+1]=this.b*$L+this.d*$T+this.ty;}return $h;},$J.transformPointArrayScale=function($J,$h){for(var $f=$J.length,$n=0;$n<$f;$n+=2){var $L=$J[$n],$T=$J[$n+1];$h[$n]=this.a*$L+this.c*$T,$h[$n+1]=this.b*$L+this.d*$T;}return $h;},$J.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b);},$J.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d);},$J.invert=function(){var $J=this.a,$h=this.b,$f=this.c,$n=this.d,$L=this.tx,$T=$J*$n-$h*$f;return this.a=$n/$T,this.b=-$h/$T,this.c=-$f/$T,this.d=$J/$T,this.tx=($f*this.ty-$n*$L)/$T,this.ty=-($J*this.ty-$h*$L)/$T,this;},$J.setTo=function($J,$h,$f,$n,$L,$T){return this.a=$J,this.b=$h,this.c=$f,this.d=$n,this.tx=$L,this.ty=$T,this;},$J.concat=function($J){var $h=this.a,$f=this.c,$n=this.tx;return this.a=$h*$J.a+this.b*$J.c,this.b=$h*$J.b+this.b*$J.d,this.c=$f*$J.a+this.d*$J.c,this.d=$f*$J.b+this.d*$J.d,this.tx=$n*$J.a+this.ty*$J.c+$J.tx,this.ty=$n*$J.b+this.ty*$J.d+$J.ty,this;},$J.scaleEx=function($J,$h){var $f=this.a,$n=this.b,$L=this.c,$T=this.d;0!==$n||0!==$L?(this.a=$J*$f,this.b=$J*$n,this.c=$h*$L):(this.a=$J*$f,this.b=0*$T,this.c=0*$f),this.d=$h*$T,this.bTransform=!0;},$J.rotateEx=function($J){var $h=Math.cos($J),$f=Math.sin($J),$n=this.a,$L=this.b,$T=this.c,$k=this.d;0!==$L||0!==$T?(this.a=$h*$n+$f*$T,this.b=$h*$L+$f*$k,this.c=-$f*$n+$h*$T,this.d=-$f*$L+$h*$k):(this.a=$h*$n,this.b=$f*$k,this.c=-$f*$n,this.d=$h*$k),this.bTransform=!0;},$J.clone=function(){var $J=$f.create();return $J.a=this.a,$J.b=this.b,$J.c=this.c,$J.d=this.d,$J.tx=this.tx,$J.ty=this.ty,$J.bTransform=this.bTransform,$J;},$J.copyTo=function($J){return $J.a=this.a,$J.b=this.b,$J.c=this.c,$J.d=this.d,$J.tx=this.tx,$J.ty=this.ty,$J.bTransform=this.bTransform,$J;},$J.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty;},$J.destroy=function(){if(!this.inPool){var $J=$f._cache;this.inPool=!0,$J._length||($J._length=0),($J[$J._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1;}},$f.mul=function($J,$h,$f){var $n=$J.a,$L=$J.b,$T=$J.c,$k=$J.d,$u=$J.tx,$S=$J.ty,$Y=$h.a,$x=$h.b,$j=$h.c,$R=$h.d,$l=$h.tx,$i=$h.ty;return 0!==$x||0!==$j?($f.a=$n*$Y+$L*$j,$f.b=$n*$x+$L*$R,$f.c=$T*$Y+$k*$j,$f.d=$T*$x+$k*$R,$f.tx=$Y*$u+$j*$S+$l,$f.ty=$x*$u+$R*$S+$i):($f.a=$n*$Y,$f.b=$L*$R,$f.c=$T*$Y,$f.d=$k*$R,$f.tx=$Y*$u+$l,$f.ty=$R*$S+$i),$f;},$f.mul16=function($J,$h,$f){var $n=$J.a,$L=$J.b,$T=$J.c,$k=$J.d,$u=$J.tx,$S=$J.ty,$Y=$h.a,$x=$h.b,$j=$h.c,$R=$h.d,$l=$h.tx,$i=$h.ty;return 0!==$x||0!==$j?($f[0]=$n*$Y+$L*$j,$f[1]=$n*$x+$L*$R,$f[4]=$T*$Y+$k*$j,$f[5]=$T*$x+$k*$R,$f[12]=$Y*$u+$j*$S+$l,$f[13]=$x*$u+$R*$S+$i):($f[0]=$n*$Y,$f[1]=$L*$R,$f[4]=$T*$Y,$f[5]=$k*$R,$f[12]=$Y*$u+$l,$f[13]=$R*$S+$i),$f;},$f.mulPre=function($J,$h,$f,$n,$L,$T,$k,$u){var $S=$J.a,$Y=$J.b,$x=$J.c,$j=$J.d,$R=$J.tx,$l=$J.ty;return 0!==$f||0!==$n?($u.a=$S*$h+$Y*$n,$u.b=$S*$f+$Y*$L,$u.c=$x*$h+$j*$n,$u.d=$x*$f+$j*$L,$u.tx=$h*$R+$n*$l+$T,$u.ty=$f*$R+$L*$l+$k):($u.a=$S*$h,$u.b=$Y*$L,$u.c=$x*$h,$u.d=$j*$L,$u.tx=$h*$R+$T,$u.ty=$L*$l+$k),$u;},$f.mulPos=function($J,$h,$f,$n,$L,$T,$k,$u){var $S=$J.a,$Y=$J.b,$x=$J.c,$j=$J.d,$R=$J.tx,$l=$J.ty;return 0!==$Y||0!==$x?($u.a=$h*$S+$f*$x,$u.b=$h*$Y+$f*$j,$u.c=$n*$S+$L*$x,$u.d=$n*$Y+$L*$j,$u.tx=$S*$T+$x*$k+$R,$u.ty=$Y*$T+$j*$k+$l):($u.a=$h*$S,$u.b=$f*$j,$u.c=$n*$S,$u.d=$L*$j,$u.tx=$S*$T+$R,$u.ty=$j*$k+$l),$u;},$f.preMul=function($J,$h,$f){var $n=$J.a,$L=$J.b,$T=$J.c,$k=$J.d,$u=$h.a,$S=$h.b,$Y=$h.c,$x=$h.d,$j=$h.tx,$R=$h.ty;return $f.a=$u*$n,$f.b=$f.c=0,$f.d=$x*$k,$f.tx=$j*$n+$J.tx,$f.ty=$R*$k+$J.ty,0===$S&&0===$Y&&0===$L&&0===$T||($f.a+=$S*$T,$f.d+=$Y*$L,$f.b+=$u*$L+$S*$k,$f.c+=$Y*$n+$x*$T,$f.tx+=$R*$T,$f.ty+=$j*$L),$f;},$f.preMulXY=function($J,$h,$f,$n){var $L=$J.a,$T=$J.b,$k=$J.c,$u=$J.d;return $n.a=$L,$n.b=$T,$n.c=$k,$n.d=$u,$n.tx=$h*$L+$J.tx+$f*$k,$n.ty=$f*$u+$J.ty+$h*$T,$n;},$f.create=function(){var $J=$f._cache,$h=$J._length?$J[--$J._length]:new $f();return $h.inPool=!1,$h;},$f.EMPTY=new $f(),$f.TEMP=new $f(),$f._cache=[],$f;}(),$D=function(){function $J($J,$h){void 0===$J&&($J=0),void 0===$h&&($h=0),this.x=$J,this.y=$h;}$q($J,"laya.maths.Point");var $h=$J.prototype;return $h.setTo=function($J,$h){return this.x=$J,this.y=$h,this;},$h.distance=function($J,$h){return Math.sqrt((this.x-$J)*(this.x-$J)+(this.y-$h)*(this.y-$h));},$h.toString=function(){return this.x+","+this.y;},$h.normalize=function(){var $J=Math.sqrt(this.x*this.x+this.y*this.y);if(0<$J){var $h=1/$J;this.x*=$h,this.y*=$h;}},$J.TEMP=new $J(),$J.EMPTY=new $J(),$J;}(),$g=function(){function $Y($J,$h,$f,$n){void 0===$J&&($J=0),void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=0),this.x=$J,this.y=$h,this.width=$f,this.height=$n;}$q($Y,"laya.maths.Rectangle");var $J=$Y.prototype;return $J.setTo=function($J,$h,$f,$n){return this.x=$J,this.y=$h,this.width=$f,this.height=$n,this;},$J.copyFrom=function($J){return this.x=$J.x,this.y=$J.y,this.width=$J.width,this.height=$J.height,this;},$J.contains=function($J,$h){return!(this.width<=0||this.height<=0)&&$J>=this.x&&$J<this.right&&$h>=this.y&&$h<this.bottom;},$J.intersects=function($J){return!($J.x>this.x+this.width||$J.x+$J.width<this.x||$J.y>this.y+this.height||$J.y+$J.height<this.y);},$J.intersection=function($J,$h){return this.intersects($J)?($h||($h=new $Y()),$h.x=Math.max(this.x,$J.x),$h.y=Math.max(this.y,$J.y),$h.width=Math.min(this.right,$J.right)-$h.x,$h.height=Math.min(this.bottom,$J.bottom)-$h.y,$h):null;},$J.union=function($J,$h){return $h||($h=new $Y()),this.clone($h),$J.width<=0||$J.height<=0?$h:($h.addPoint($J.x,$J.y),$h.addPoint($J.right,$J.bottom),this);},$J.clone=function($J){return $J||($J=new $Y()),$J.x=this.x,$J.y=this.y,$J.width=this.width,$J.height=this.height,$J;},$J.toString=function(){return this.x+","+this.y+","+this.width+","+this.height;},$J.equals=function($J){return!(!$J||$J.x!==this.x||$J.y!==this.y||$J.width!==this.width||$J.height!==this.height);},$J.addPoint=function($J,$h){return this.x>$J&&(this.width+=this.x-$J,this.x=$J),this.y>$h&&(this.height+=this.y-$h,this.y=$h),this.width<$J-this.x&&(this.width=$J-this.x),this.height<$h-this.y&&(this.height=$h-this.y),this;},$J._getBoundPoints=function(){var $J=$Y._temB;return($J.length=0)==this.width||0==this.height||$J.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),$J;},$J.isEmpty=function(){return this.width<=0||this.height<=0;},$x(0,$J,"right",function(){return this.x+this.width;}),$x(0,$J,"bottom",function(){return this.y+this.height;}),$Y._getBoundPointS=function($J,$h,$f,$n){var $L=$Y._temA;return($L.length=0)==$f||0==$n||$L.push($J,$h,$J+$f,$h,$J,$h+$n,$J+$f,$h+$n),$L;},$Y._getWrapRec=function($J,$h){if(!$J||$J.length<1)return $h?$h.setTo(0,0,0,0):$Y.TEMP.setTo(0,0,0,0);$h=$h||new $Y();var $f,$n,$L,$T,$k,$u=$J.length,$S=$D.TEMP;for($L=$k=-($n=$T=99999),$f=0;$f<$u;$f+=2)$S.x=$J[$f],$S.y=$J[$f+1],$n=$n<$S.x?$n:$S.x,$T=$T<$S.y?$T:$S.y,$L=$L>$S.x?$L:$S.x,$k=$k>$S.y?$k:$S.y;return $h.setTo($n,$T,$L-$n,$k-$T);},$Y.EMPTY=new $Y(),$Y.TEMP=new $Y(),$Y._temB=[],$Y._temA=[],$Y;}(),$G=function(){function $S(){}return $q($S,"laya.media.SoundManager"),$x(1,$S,"useAudioMusic",function(){return $S._useAudioMusic;},function($J){$S._useAudioMusic=$J,$S._musicClass=$J?$fJ:null;}),$x(1,$S,"autoStopMusic",function(){return $S._autoStopMusic;},function($J){$Q.stage.off("blur",null,$S._stageOnBlur),$Q.stage.off("focus",null,$S._stageOnFocus),$Q.stage.off("visibilitychange",null,$S._visibilityChange),($S._autoStopMusic=$J)&&($Q.stage.on("blur",null,$S._stageOnBlur),$Q.stage.on("focus",null,$S._stageOnFocus),$Q.stage.on("visibilitychange",null,$S._visibilityChange));}),$x(1,$S,"muted",function(){return $S._muted;},function($J){$J!=$S._muted&&($J&&$S.stopAllSound(),$S.musicMuted=$J,$S._muted=$J);}),$x(1,$S,"musicMuted",function(){return $S._musicMuted;},function($J){$J!=$S._musicMuted&&($J?($S._tMusic&&$S._musicChannel&&!$S._musicChannel.isStopped?$S._musicChannel.pause():$S._musicChannel=null,$S._musicMuted=$J):($S._musicMuted=$J,$S._tMusic&&$S._musicChannel&&$S._musicChannel.resume()));}),$x(1,$S,"soundMuted",function(){return $S._soundMuted;},function($J){$S._soundMuted=$J;}),$S.addChannel=function($J){0<=$S._channels.indexOf($J)||($S._channels.push($J),$S.autoReleaseSound&&0!=$S._notUsedCount&&$S._notUsedUrls[$J.url]&&(delete $S._notUsedUrls[$J.url],0==--$S._notUsedCount&&$Q.timer.clear($S,$S.disposeSoundIfNotUsed)));},$S.removeChannel=function($J){var $h=$S._channels,$f=$h.indexOf($J);if(-1!=$f&&($h.splice($f,1),$S.autoReleaseSound)){var $n=$J.url,$L=$S.defaultIntervals[$n]||2e4;if(0<$L){var $T=!0;for($f=$h.length-1;0<=$f;$f--)if($h[$f].url==$n){$T=!1;break;}$T&&($S._notUsedUrls[$n]=Date.now()+$L,0==$S._notUsedCount++&&$Q.timer.loop(1e4,$S,$S.disposeSoundIfNotUsed));}}},$S.disposeSoundIfNotUsed=function(){var $J=$S._notUsedUrls;if(0!=$S._notUsedCount){var $h=Date.now();for(var $f in $J)$h>=$J[$f]&&(delete $J[$f],--$S._notUsedCount,$S.destroySound($f));if(0!=$S._notUsedCount)return;}$Q.timer.clear($S,$S.disposeSoundIfNotUsed);},$S._visibilityChange=function(){$Q.stage.isVisibility?$S._stageOnFocus():$S._stageOnBlur();},$S._stageOnBlur=function(){$S._isActive=!1,$S._musicChannel&&($S._musicChannel.isStopped||($S._blurPaused=!0,$S._musicChannel.pause())),$S.stopAllSound(),$Q.stage.once("mousedown",null,$S._stageOnFocus);},$S._recoverWebAudio=function(){$TJ.ctx&&"running"!=$TJ.ctx.state&&$TJ.ctx.resume&&$TJ.ctx.resume();},$S._stageOnFocus=function(){if($S._isActive=!0,$S._recoverWebAudio(),$Q.stage.off("mousedown",null,$S._stageOnFocus),$S._blurPaused){var $J=$S._musicChannel;$J&&$S._music&&$J.isStopped&&($S._blurPaused=!1,$S._music._disposed?$S.playMusic($J.url,$J.loops,$J.startHandler,$J.completeHandler,$J.startTime):$J.audioBuffer?$J.resume():$S._music.play($J.startTime,$J.loops,$J.startHandler,$J));}},$S.playSound=function($J,$h,$f,$n,$L,$T){if(void 0===$h&&($h=1),void 0===$T&&($T=0),!$J)return null;if($S._muted)return null;if($S._recoverWebAudio(),$J==$S._tMusic){if($S._musicMuted)return null;}else{if(!$S._isActive)return null;if($S._soundMuted)return null;}var $k,$u=$S._pool[$J];return $L||($L=$S._soundClass),$u||(($u=new $L()).load($J),$S._pool[$J]=$u),($k=$u.play($T,$h,$f))?($J==$S._tMusic&&($S._music=$u,$S._isActive||($S._blurPaused=!0,$k.pause())),$k.url=$J,$k.volume=$J==$S._tMusic?$S.musicVolume:$S.soundVolume,$k.completeHandler=$n,$k):null;},$S.destroySound=function($J){var $h=$S._pool[$J];$h&&(delete $S._pool[$J],$h.dispose());},$S.playMusic=function($J,$h,$f,$n,$L){return void 0===$h&&($h=0),void 0===$L&&($L=0),$S._tMusic=$J,$S._musicChannel&&$S._musicChannel.stop(),$S._musicChannel=$S.playSound($J,$h,$f,$n,null,$L);},$S.stopSound=function($J){for(var $h,$f=$S._channels.length-1;0<=$f;$f--)($h=$S._channels[$f]).url==$J&&$h.stop();},$S.stopAll=function(){$S._tMusic=null;var $J=0;for($J=$S._channels.length-1;0<=$J;$J--)$S._channels[$J].stop();},$S.stopAllSound=function(){var $J,$h=0;for($h=$S._channels.length-1;0<=$h;$h--)($J=$S._channels[$h]).url!=$S._tMusic&&$J.stop();},$S.stopMusic=function(){$S._musicChannel&&$S._musicChannel.stop(),$S._tMusic=null;},$S.setSoundVolume=function($J,$h){if($h)$S._setVolume($h,$J);else{$S.soundVolume=$J;var $f,$n=0;for($n=$S._channels.length-1;0<=$n;$n--)($f=$S._channels[$n]).url!=$S._tMusic&&($f.volume=$J);}},$S.setMusicVolume=function($J){$S.musicVolume=$J,$S._setVolume($S._tMusic,$J);},$S._setVolume=function($J,$h){for(var $f,$n=$S._channels.length-1;0<=$n;$n--)($f=$S._channels[$n]).url==$J&&($f.volume=$h);},$S.musicVolume=1,$S.soundVolume=1,$S.playbackRate=1,$S._useAudioMusic=!0,$S._muted=!1,$S._soundMuted=!1,$S._musicMuted=!1,$S._tMusic=null,$S._musicChannel=null,$S._music=null,$S._channels=[],$S._autoStopMusic=!1,$S._blurPaused=!1,$S._isActive=!0,$S._soundClass=null,$S._musicClass=null,$S.autoReleaseSound=!0,$S._pool={},$S.defaultIntervals={},$S._notUsedUrls={},$S._notUsedCount=0,$S;}(),$F=function(){var $J;function $f(){}return $q($f,"laya.net.LocalStorage"),$f.__init__=function(){$f._baseClass||($f._baseClass=$J).init(),$f.items=$f._baseClass.items,$f.support=$f._baseClass.support;},$f.setItem=function($J,$h){$f._baseClass.setItem($J,$h);},$f.getItem=function($J){return $f._baseClass.getItem($J);},$f.setJSON=function($J,$h){$f._baseClass.setJSON($J,$h);},$f.getJSON=function($J){return $f._baseClass.getJSON($J);},$f.removeItem=function($J){$f._baseClass.removeItem($J);},$f.clear=function(){$f._baseClass.clear();},$f._baseClass=null,$f.items=null,$f.support=!1,$f.__init$=function(){$J=function(){function $f(){}return $q($f,""),$f.init=function(){try{$f.support=!0,$f.items=$k.localStorage,$f.setItem("laya","1"),$f.removeItem("laya");}catch($J){$f.support=!1;}$f.support||console.log("LocalStorage is not supprot or browser is private mode.");},$f.setItem=function($J,$h){try{$f.support&&$f.items.setItem($J,$h);}catch($J){console.warn("set localStorage failed",$J);}},$f.getItem=function($J){return $f.support?$f.items.getItem($J):null;},$f.setJSON=function($J,$h){try{$f.support&&$f.items.setItem($J,JSON.stringify($h));}catch($J){console.warn("set localStorage failed",$J);}},$f.getJSON=function($J){return JSON.parse($f.support?$f.items.getItem($J):null);},$f.removeItem=function($J){$f.support&&$f.items.removeItem($J);},$f.clear=function(){$f.support&&$f.items.clear();},$f.items=null,$f.support=!1,$f;}();},$f;}(),$P=(function(){function $n(){}$q($n,"laya.net.ResourceVersion"),$n.enable=function($J,$h,$f){void 0===$f&&($f=2),laya.net.ResourceVersion.type=$f,$Q.loader.load($J,$_.create(null,$n.onManifestLoaded,[$h]),null,"json"),$W.customFormat=$n.addVersionPrefix;},$n.onManifestLoaded=function($J,$h){$n.manifest=$h,$J.run(),$h||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。");},$n.addVersionPrefix=function($J){return $n.manifest&&$n.manifest[$J]?2==$n.type?$n.manifest[$J]:$n.manifest[$J]+"/"+$J:$J;},$n.FOLDER_VERSION=1,$n.FILENAME_VERSION=2,$n.manifest=null,$n.type=1;}(),function(){function $J(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null;}$q($J,"laya.net.TTFLoader");var $h=$J.prototype;return $h.load=function($J){var $h=(this._url=$J).split(".ttf")[0].split("/");this.fontName=$h[$h.length-1],$a.window.conch?this._loadConch():$a.window.FontFace?this._loadWithFontFace():this._loadWithCSS();},$h._loadConch=function(){this._http=new $kJ(),this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer");},$h._onHttpLoaded=function($J){$a.window.conch.setFontFaceFromBuffer(this.fontName,$J),this._clearHttp(),this._complete();},$h._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null);},$h._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null);},$h._complete=function(){$Q.timer.clear(this,this._complete),$Q.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null);},$h._checkComplete=function(){$y.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete();},$h._loadWithFontFace=function(){var $J=new $a.window.FontFace(this.fontName,"url('"+this._url+"')");$a.window.document.fonts.add($J);var $h=this;$J.loaded.then(function(){$h._complete();}),$J.load();},$h._createDiv=function(){this._div=$a.createElement("div"),this._div.innerHTML="laya";var $J=this._div.style;$J.fontFamily=this.fontName,$J.position="absolute",$J.left="-100px",$J.top="-100px",$a.document.body.appendChild(this._div);},$h._loadWithCSS=function(){var $J=this,$h=$a.createElement("style");$h.type="text/css",$a.document.body.appendChild($h),$h.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=$y.measureText("LayaTTFFont",this._fontTxt).width;var $f=this;$h.onload=function(){$Q.timer.once(1e4,$f,$J._complete);},$Q.timer.loop(20,this,this._checkComplete),this._createDiv();},$J._testString="LayaTTFFont",$J;}()),$W=function(){function $n($J){this._url=null,this._path=null,this._url=$n.formatURL($J),this._path=$n.getPath($J);}$q($n,"laya.net.URL");var $J=$n.prototype;return $x(0,$J,"path",function(){return this._path;}),$x(0,$J,"url",function(){return this._url;}),$n.formatURL=function($J,$h){if(!$J)return"null path";if(0<$J.indexOf(":"))return $J;null!=$n.customFormat&&($J=$n.customFormat($J,$h));var $f=$J.charAt(0);if("."===$f)return $n.formatRelativePath(($h||$n.basePath)+$J);if("~"===$f)return $n.rootPath+$J.substring(1);if("d"===$f){if(0===$J.indexOf("data:image"))return $J;}else if("/"===$f)return $J;return($h||$n.basePath)+$J;},$n.formatRelativePath=function($J){for(var $h=$J.split("/"),$f=0,$n=$h.length;$f<$n;$f++)".."==$h[$f]&&($h.splice($f-1,2),$f-=2);return $h.join("/");},$n.isAbsolute=function($J){return 0<$J.indexOf(":")||"/"==$J.charAt(0);},$n.getPath=function($J){var $h=$J.lastIndexOf("/");return 0<$h?$J.substr(0,$h+1):"";},$n.getFileName=function($J){var $h=$J.lastIndexOf("/");return 0<$h?$J.substr($h+1):$J;},$n.version={},$n.basePath="",$n.rootPath="",$n.customFormat=function($J){var $h=$n.version[$J];return!$I.isConchApp&&$h&&($J+="?v="+$h),$J;},$n;}(),$I=function(){function $L($J,$h){this._timeId=0;var $f=$L._mainCanvas.source.style;$f.position="absolute",$f.top=$f.left="0px",$f.background="#000000",$L._mainCanvas.source.id="layaCanvas";var $n=laya.renders.Render.isWebGL;$L._mainCanvas.source.width=$J,$L._mainCanvas.source.height=$h,$n&&$L.WebGL.init($L._mainCanvas,$J,$h),$a.container.appendChild($L._mainCanvas.source),($L._context=new $m($J,$h,$n?null:$L._mainCanvas)).ctx.setIsMainContext(),$a.window.requestAnimationFrame(function $J($h){$a.window.requestAnimationFrame($J);$Q.stage._loop();}),$Q.stage.on("visibilitychange",this,this._onVisibilitychange);}$q($L,"laya.renders.Render");var $J=$L.prototype;return $J._onVisibilitychange=function(){$Q.stage.isVisibility?0!=this._timeId&&$a.window.clearInterval(this._timeId):this._timeId=$a.window.setInterval(this._enterFrame,1e3);},$J._enterFrame=function($J){$Q.stage._loop();},$x(1,$L,"context",function(){return $L._context;}),$x(1,$L,"canvas",function(){return $L._mainCanvas.source;}),$L._context=null,$L._mainCanvas=null,$L.WebGL=null,$L.isConchNode=!1,$L.isConchApp=!1,$L.isConchWebGL=!1,$L.isWebGL=!1,$L.is3DMode=!1,$L.optimizeTextureMemory=function($J,$h){return!0;},$L.__init$=function(){$k.ConchRenderType=$k.ConchRenderType||1,$k.ConchRenderType|=$k.conch?4:0,$L.isConchNode=5==(5&$k.ConchRenderType),$L.isConchApp=4==(4&$k.ConchRenderType),$L.isConchWebGL=6==$k.ConchRenderType;},$L;}(),$m=function(){function $k($J,$h,$f){this.x=0,this.y=0,this._drawTexture=function($J,$h,$f){$f[0].loaded&&this.ctx.drawTexture($f[0],$f[1],$f[2],$f[3],$f[4],$J,$h);},this._fillTexture=function($J,$h,$f){$f[0].loaded&&this.ctx.fillTexture($f[0],$f[1]+$J,$f[2]+$h,$f[3],$f[4],$f[5],$f[6],$f[7]);},this._drawTextureWithTransform=function($J,$h,$f){$f[0].loaded&&this.ctx.drawTextureWithTransform($f[0],$f[1],$f[2],$f[3],$f[4],$f[5],$J,$h,$f[6]);},this._fillQuadrangle=function($J,$h,$f){this.ctx.fillQuadrangle($f[0],$f[1],$f[2],$f[3],$f[4]);},this._drawRect=function($J,$h,$f){var $n=this.ctx;null!=$f[4]&&($n.fillStyle=$f[4],$n.fillRect($J+$f[0],$h+$f[1],$f[2],$f[3],null)),null!=$f[5]&&($n.strokeStyle=$f[5],$n.lineWidth=$f[6],$n.strokeRect($J+$f[0],$h+$f[1],$f[2],$f[3],$f[6]));},this._drawPie=function($J,$h,$f){var $n=this.ctx;$I.isWebGL&&$n.setPathId($f[8]),$n.beginPath(),$I.isWebGL?($n.movePath($f[0]+$J,$f[1]+$h),$n.moveTo(0,0)):$n.moveTo($J+$f[0],$h+$f[1]),$n.arc($J+$f[0],$h+$f[1],$f[2],$f[3],$f[4]),$n.closePath(),this._fillAndStroke($f[5],$f[6],$f[7],!0);},this._clipRect=function($J,$h,$f){this.ctx.clipRect($J+$f[0],$h+$f[1],$f[2],$f[3]);},this._fillRect=function($J,$h,$f){this.ctx.fillRect($J+$f[0],$h+$f[1],$f[2],$f[3],$f[4]);},this._drawCircle=function($J,$h,$f){var $n=this.ctx;$I.isWebGL&&$n.setPathId($f[6]),$M.drawCall++,$n.beginPath(),$I.isWebGL&&$n.movePath($f[0]+$J,$f[1]+$h),$n.arc($f[0]+$J,$f[1]+$h,$f[2],0,$k.PI2),$n.closePath(),this._fillAndStroke($f[3],$f[4],$f[5],!0);},this._fillCircle=function($J,$h,$f){$M.drawCall++;var $n=this.ctx;$n.beginPath(),$n.fillStyle=$f[3],$n.arc($f[0]+$J,$f[1]+$h,$f[2],0,$k.PI2),$n.fill();},this._setShader=function($J,$h,$f){this.ctx.setShader($f[0]);},this._drawLine=function($J,$h,$f){var $n=this.ctx;$I.isWebGL&&$n.setPathId($f[6]),$n.beginPath(),$n.strokeStyle=$f[4],$n.lineWidth=$f[5],$I.isWebGL?($n.movePath($J,$h),$n.moveTo($f[0],$f[1]),$n.lineTo($f[2],$f[3])):($n.moveTo($J+$f[0],$h+$f[1]),$n.lineTo($J+$f[2],$h+$f[3])),$n.stroke();},this._drawLines=function($J,$h,$f){var $n=this.ctx;$I.isWebGL&&$n.setPathId($f[5]),$n.beginPath(),$J+=$f[0],$h+=$f[1],$I.isWebGL&&$n.movePath($J,$h),$n.strokeStyle=$f[3],$n.lineWidth=$f[4];var $L=$f[2],$T=2,$k=$L.length;if($I.isWebGL)for($n.moveTo($L[0],$L[1]);$T<$k;)$n.lineTo($L[$T++],$L[$T++]);else for($n.moveTo($J+$L[0],$h+$L[1]);$T<$k;)$n.lineTo($J+$L[$T++],$h+$L[$T++]);$n.stroke();},this._drawLinesWebGL=function($J,$h,$f){this.ctx.drawLines($J+this.x+$f[0],$h+this.y+$f[1],$f[2],$f[3],$f[4]);},this._drawCurves=function($J,$h,$f){this.ctx.drawCurves($J,$h,$f);},this._draw=function($J,$h,$f){$f[0].call(null,this,$J,$h);},this._transformByMatrix=function($J,$h,$f){this.ctx.transformByMatrix($f[0]);},this._setTransform=function($J,$h,$f){this.ctx.setTransform($f[0],$f[1],$f[2],$f[3],$f[4],$f[5]);},this._setTransformByMatrix=function($J,$h,$f){this.ctx.setTransformByMatrix($f[0]);},this._save=function($J,$h,$f){this.ctx.save();},this._restore=function($J,$h,$f){this.ctx.restore();},this._translate=function($J,$h,$f){this.ctx.translate($f[0],$f[1]);},this._transform=function($J,$h,$f){this.ctx.translate($f[1]+$J,$f[2]+$h);var $n=$f[0];this.ctx.transform($n.a,$n.b,$n.c,$n.d,$n.tx,$n.ty),this.ctx.translate(-$J-$f[1],-$h-$f[2]);},this._rotate=function($J,$h,$f){this.ctx.translate($f[1]+$J,$f[2]+$h),this.ctx.rotate($f[0]),this.ctx.translate(-$J-$f[1],-$h-$f[2]);},this._scale=function($J,$h,$f){this.ctx.translate($f[2]+$J,$f[3]+$h),this.ctx.scale($f[0],$f[1]),this.ctx.translate(-$J-$f[2],-$h-$f[3]);},this._alpha=function($J,$h,$f){this.ctx.globalAlpha*=$f[0];},this._setAlpha=function($J,$h,$f){this.ctx.globalAlpha=$f[0];},this._fillText=function($J,$h,$f){this.ctx.fillText($f[0],$f[1]+$J,$f[2]+$h,$f[3],$f[4],$f[5]);},this._strokeText=function($J,$h,$f){this.ctx.strokeText($f[0],$f[1]+$J,$f[2]+$h,$f[3],$f[4],$f[5],$f[6]);},this._fillBorderText=function($J,$h,$f){this.ctx.fillBorderText($f[0],$f[1]+$J,$f[2]+$h,$f[3],$f[4],$f[5],$f[6],$f[7]);},this._blendMode=function($J,$h,$f){this.ctx.globalCompositeOperation=$f[0];},this._beginClip=function($J,$h,$f){this.ctx.beginClip&&this.ctx.beginClip($J+$f[0],$h+$f[1],$f[2],$f[3]);},this._setIBVB=function($J,$h,$f){this.ctx.setIBVB($f[0]+$J,$f[1]+$h,$f[2],$f[3],$f[4],$f[5],$f[6],$f[7]);},this._fillTrangles=function($J,$h,$f){this.ctx.fillTrangles($f[0],$f[1]+$J,$f[2]+$h,$f[3],$f[4]);},this._drawPath=function($J,$h,$f){var $n=this.ctx;$I.isWebGL&&$n.setPathId(-1),$n.beginPath(),$J+=$f[0],$h+=$f[1],$I.isWebGL&&$n.movePath($J,$h);for(var $L=$f[2],$T=0,$k=$L.length;$T<$k;$T++){var $u=$L[$T];switch($u[0]){case"moveTo":$I.isWebGL?$n.moveTo($u[1],$u[2]):$n.moveTo($J+$u[1],$h+$u[2]);break;case"lineTo":$I.isWebGL?$n.lineTo($u[1],$u[2]):$n.lineTo($J+$u[1],$h+$u[2]);break;case"arcTo":$I.isWebGL?$n.arcTo($u[1],$u[2],$u[3],$u[4],$u[5]):$n.arcTo($J+$u[1],$h+$u[2],$J+$u[3],$h+$u[4],$u[5]);break;case"closePath":$n.closePath();}}var $S=$f[3];null!=$S&&($n.fillStyle=$S.fillStyle,$n.fill());var $Y=$f[4];null!=$Y&&($n.strokeStyle=$Y.strokeStyle,$n.lineWidth=$Y.lineWidth||1,$n.lineJoin=$Y.lineJoin,$n.lineCap=$Y.lineCap,$n.miterLimit=$Y.miterLimit,$n.stroke());},this.drawPoly=function($J,$h,$f){this.ctx.drawPoly($J+this.x+$f[0],$h+this.y+$f[1],$f[2],$f[3],$f[4],$f[5],$f[6]);},this._drawPoly=function($J,$h,$f){var $n=this.ctx,$L=$f[2],$T=2,$k=$L.length;if($I.isWebGL)for($n.setPathId($f[6]),$n.beginPath(),$J+=$f[0],$h+=$f[1],$n.movePath($J,$h),$n.moveTo($L[0],$L[1]);$T<$k;)$n.lineTo($L[$T++],$L[$T++]);else for($n.beginPath(),$J+=$f[0],$h+=$f[1],$n.moveTo($J+$L[0],$h+$L[1]);$T<$k;)$n.lineTo($J+$L[$T++],$h+$L[$T++]);$n.closePath(),this._fillAndStroke($f[3],$f[4],$f[5],$f[7]);},this._drawSkin=function($J,$h,$f){var $n=$f[0];if($n){var $L=this.ctx;$n.render($L,$J,$h);}},this._drawParticle=function($J,$h,$f){this.ctx.drawParticle($J+this.x,$h+this.y,$f[0]);},this._setFilters=function($J,$h,$f){this.ctx.setFilters($f);},$f?this.ctx=$f.getContext("2d"):($f=$sJ.create("3D"),this.ctx=$y.createWebGLContext2D($f),$f._setContext(this.ctx)),$f.size($J,$h),this.canvas=$f;}$q($k,"laya.renders.RenderContext");var $J=$k.prototype;return $J.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null);},$J.drawTexture=function($J,$h,$f,$n,$L){$J.loaded&&this.ctx.drawTexture($J,$h,$f,$n,$L,this.x,this.y);},$J._drawTextures=function($J,$h,$f){$f[0].loaded&&this.ctx.drawTextures($f[0],$f[1],$J+this.x,$h+this.y);},$J.drawTextureWithTransform=function($J,$h,$f,$n,$L,$T,$k){$J.loaded&&this.ctx.drawTextureWithTransform($J,$h,$f,$n,$L,$T,this.x,this.y,$k);},$J.fillQuadrangle=function($J,$h,$f,$n,$L){this.ctx.fillQuadrangle($J,$h,$f,$n,$L);},$J.drawCanvas=function($J,$h,$f,$n,$L){this.ctx.drawCanvas($J,$h+this.x,$f+this.y,$n,$L);},$J.drawRect=function($J,$h,$f,$n,$L,$T){void 0===$T&&($T=1);var $k=this.ctx;$k.strokeStyle=$L,$k.lineWidth=$T,$k.strokeRect($J+this.x,$h+this.y,$f,$n,$T);},$J._fillAndStroke=function($J,$h,$f,$n){void 0===$n&&($n=!1);var $L=this.ctx;null!=$J&&($L.fillStyle=$J,$I.isWebGL?$L.fill($n):$L.fill()),null!=$h&&0<$f&&($L.strokeStyle=$h,$L.lineWidth=$f,$L.stroke());},$J.clipRect=function($J,$h,$f,$n){this.ctx.clipRect($J+this.x,$h+this.y,$f,$n);},$J.fillRect=function($J,$h,$f,$n,$L){this.ctx.fillRect($J+this.x,$h+this.y,$f,$n,$L);},$J.drawCircle=function($J,$h,$f,$n,$L){void 0===$L&&($L=1),$M.drawCall++;var $T=this.ctx;$T.beginPath(),$T.strokeStyle=$n,$T.lineWidth=$L,$T.arc($J+this.x,$h+this.y,$f,0,$k.PI2),$T.stroke();},$J.drawTriangles=function($J,$h,$f){if($I.isWebGL)this.ctx.drawTriangles($f[0],$J+$f[1],$h+$f[2],$f[3],$f[4],$f[5],$f[6],$f[7],$f[8],$f[9]);else{var $n=$f[5],$L=0,$T=$n.length,$k=this.ctx;for($L=0;$L<$T;$L+=3){var $u=2*$n[$L],$S=2*$n[$L+1],$Y=2*$n[$L+2];$k.drawTriangle($f[0],$f[3],$f[4],$u,$S,$Y,$f[6],!0);}}},$J.fillCircle=function($J,$h,$f,$n){$M.drawCall++;var $L=this.ctx;$L.beginPath(),$L.fillStyle=$n,$L.arc($J+this.x,$h+this.y,$f,0,$k.PI2),$L.fill();},$J.setShader=function($J){this.ctx.setShader($J);},$J.drawLine=function($J,$h,$f,$n,$L,$T){void 0===$T&&($T=1);var $k=this.ctx;$k.beginPath(),$k.strokeStyle=$L,$k.lineWidth=$T,$k.moveTo(this.x+$J,this.y+$h),$k.lineTo(this.x+$f,this.y+$n),$k.stroke();},$J.clear=function(){this.ctx.clear();},$J.transformByMatrix=function($J){this.ctx.transformByMatrix($J);},$J.setTransform=function($J,$h,$f,$n,$L,$T){this.ctx.setTransform($J,$h,$f,$n,$L,$T);},$J.setTransformByMatrix=function($J){this.ctx.setTransformByMatrix($J);},$J.save=function(){this.ctx.save();},$J.restore=function(){this.ctx.restore();},$J.translate=function($J,$h){this.ctx.translate($J,$h);},$J.transform=function($J,$h,$f,$n,$L,$T){this.ctx.transform($J,$h,$f,$n,$L,$T);},$J.rotate=function($J){this.ctx.rotate($J);},$J.scale=function($J,$h){this.ctx.scale($J,$h);},$J.alpha=function($J){this.ctx.globalAlpha*=$J;},$J.setAlpha=function($J){this.ctx.globalAlpha=$J;},$J.fillWords=function($J,$h,$f,$n,$L,$T){void 0===$T&&($T=0),this.ctx.fillWords($J,$h,$f,$n,$L,$T);},$J.fillBorderWords=function($J,$h,$f,$n,$L,$T,$k){this.ctx.fillBorderWords($J,$h,$f,$n,$L,$T,$k);},$J.fillText=function($J,$h,$f,$n,$L,$T){this.ctx.fillText($J,$h+this.x,$f+this.y,$n,$L,$T);},$J.strokeText=function($J,$h,$f,$n,$L,$T,$k){this.ctx.strokeText($J,$h+this.x,$f+this.y,$n,$L,$T,$k);},$J.blendMode=function($J){this.ctx.globalCompositeOperation=$J;},$J.flush=function(){this.ctx.flush&&this.ctx.flush();},$J.addRenderObject=function($J){this.ctx.addRenderObject($J);},$J.beginClip=function($J,$h,$f,$n){this.ctx.beginClip&&this.ctx.beginClip($J,$h,$f,$n);},$J.endClip=function(){this.ctx.endClip&&this.ctx.endClip();},$J.fillTrangles=function($J,$h,$f){this.ctx.fillTrangles($f[0],$f[1],$f[2],$f[3],4<$f.length?$f[4]:null);},$k.PI2=2*Math.PI,$k;}(),$Z=function(){function $k($J,$h){switch(this._next=$h||$k.NORENDER,$J){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=$r._filter);case 69905:return void(this._fun=$k._initRenderFun);}this.onCreate($J);}$q($k,"laya.renders.RenderSprite");var $J=$k.prototype;return $J.onCreate=function($J){},$J._style=function($J,$h,$f,$n){$J._style.render($J,$h,$f,$n);var $L=this._next;$L._fun.call($L,$J,$h,$f,$n);},$J._no=function($J,$h,$f,$n){},$J._custom=function($J,$h,$f,$n){$J.customRender($h,$f,$n);var $L=$J._style._tf;this._next._fun.call(this._next,$J,$h,$f-$L.translateX,$n-$L.translateY);},$J._clip=function($J,$h,$f,$n){var $L=this._next;if($L!=$k.NORENDER){var $T=$J._style.scrollRect;$h.ctx.save(),$h.ctx.clipRect($f,$n,$T.width,$T.height),$L._fun.call($L,$J,$h,$f-$T.x,$n-$T.y),$h.ctx.restore();}},$J._blend=function($J,$h,$f,$n){var $L=$J._style;$L.blendMode&&($h.ctx.globalCompositeOperation=$L.blendMode);var $T=this._next;$T._fun.call($T,$J,$h,$f,$n),$h.ctx.globalCompositeOperation="source-over";},$J._mask=function($J,$h,$f,$n){var $L=this._next;$L._fun.call($L,$J,$h,$f,$n);var $T=$J.mask;$T&&($h.ctx.globalCompositeOperation="destination-in",(0<$T.numChildren||!$T.graphics._isOnlyOne())&&($T.cacheAsBitmap=!0),$T.render($h,$f-$J.pivotX,$n-$J.pivotY)),$h.ctx.globalCompositeOperation="source-over";},$J._graphics=function($J,$h,$f,$n){var $L=$J._style._tf;$J._graphics&&$J._graphics._render($J,$h,$f-$L.translateX,$n-$L.translateY);var $T=this._next;$T._fun.call($T,$J,$h,$f,$n);},$J._image=function($J,$h,$f,$n){var $L=$J._style;$h.ctx.drawTexture2($f,$n,$L._tf.translateX,$L._tf.translateY,$J.transform,$L.alpha,$L.blendMode,$J._graphics._one);},$J._image2=function($J,$h,$f,$n){var $L=$J._style._tf;$h.ctx.drawTexture2($f,$n,$L.translateX,$L.translateY,$J.transform,1,null,$J._graphics._one);},$J._alpha=function($J,$h,$f,$n){var $L;if(.01<($L=$J._style.alpha)||$J._needRepaint()){var $T=$h.ctx.globalAlpha;$h.ctx.globalAlpha*=$L;var $k=this._next;$k._fun.call($k,$J,$h,$f,$n),$h.ctx.globalAlpha=$T;}},$J._transform=function($J,$h,$f,$n){var $L=$J.transform,$T=this._next;$L&&$T!=$k.NORENDER?($h.save(),$h.transform($L.a,$L.b,$L.c,$L.d,$L.tx+$f,$L.ty+$n),$T._fun.call($T,$J,$h,0,0),$h.restore()):$T._fun.call($T,$J,$h,$f,$n);},$J._childs=function($J,$h,$f,$n){var $L=$J._style,$T=$L._tf;if($f=$f-$T.translateX+$L.paddingLeft,$n=$n-$T.translateY+$L.paddingTop,$L._calculation){var $k=$J._getWords();if($k){var $u=$L;$u&&($u.stroke?$h.fillBorderWords($k,$f,$n,$u.font,$u.color,$u.strokeColor,$u.stroke):$h.fillWords($k,$f,$n,$u.font,$u.color,"none"!=$u.textDecoration&&$u.underLine?1:0));}}var $S,$Y=$J._childs,$x=$Y.length;if($J.viewport||$J.optimizeScrollRect&&$J._style.scrollRect){var $j=$J.viewport||$J._style.scrollRect,$R=$j.x,$l=$j.y,$i=$j.right,$q=$j.bottom,$o=NaN,$r=NaN;for($_=0;$_<$x;++$_)($S=$Y[$_]).visible&&($o=$S._x)<$i&&$o+$S.width>$R&&($r=$S._y)<$q&&$r+$S.height>$l&&$S.render($h,$f,$n);}else for(var $_=0;$_<$x;++$_)($S=$Y[$_])._style.visible&&$S.render($h,$f,$n);},$J._canvas=function($J,$h,$f,$n){var $L=$J._$P.cacheCanvas;if($L){"bitmap"===$L.type?$M.canvasBitmap++:$M.canvasNormal++;var $T=$L.ctx;if($J._needRepaint()||!$T)this._canvas_repaint($J,$h,$f,$n);else{var $k=$L._cacheRec;$h.drawCanvas($T.canvas,$f+$k.x,$n+$k.y,$k.width,$k.height);}}else this._next._fun.call(this._next,$J,$h,$f,$n);},$J._canvas_repaint=function($J,$h,$f,$n){var $L=$J._$P.cacheCanvas,$T=this._next;if($L){var $k,$u,$S,$Y,$x=$L.ctx,$j=$J._needRepaint()||!$x,$R=$L.type;if("bitmap"===$R?$M.canvasBitmap++:$M.canvasNormal++,$j){var $l,$i;$L._cacheRec||($L._cacheRec=new $g()),$I.isWebGL&&"bitmap"!==$R?$L._cacheRec.setTo(-$J.pivotX,-$J.pivotY,1,1):(($Y=$J.getSelfBounds()).x=$Y.x-$J.pivotX,$Y.y=$Y.y-$J.pivotY,$Y.x=$Y.x-16,$Y.y=$Y.y-16,$Y.width=$Y.width+32,$Y.height=$Y.height+32,$Y.x=Math.floor($Y.x+$f)-$f,$Y.y=Math.floor($Y.y+$n)-$n,$Y.width=Math.floor($Y.width),$Y.height=Math.floor($Y.height),$L._cacheRec.copyFrom($Y)),$Y=$L._cacheRec;var $q,$o=$I.isWebGL?1:$a.pixelRatio*$Q.stage.clientScaleX,$r=$I.isWebGL?1:$a.pixelRatio*$Q.stage.clientScaleY;if(!$I.isWebGL){var $_,$s=1,$d=1;for($_=$J;$_&&$_!=$Q.stage;)$s*=$_.scaleX,$d*=$_.scaleY,$_=$_.parent;$I.isWebGL?($s<1&&($o*=$s),$d<1&&($r*=$d)):(1<$s&&($o*=$s),1<$d&&($r*=$d));}if($J.scrollRect){var $p=$J.scrollRect;$Y.x-=$p.x,$Y.y-=$p.y;}if($l=$Y.width*$o,$i=$Y.height*$r,$u=$Y.x,$S=$Y.y,$I.isWebGL&&"bitmap"===$R&&(2048<$l||2048<$i))return console.warn("cache bitmap size larger than 2048,cache ignored"),$L.ctx&&($$.recover("RenderContext",$L.ctx),$L.ctx.canvas.size(0,0),$L.ctx=null),void $T._fun.call($T,$J,$h,$f,$n);if($x||($x=$L.ctx=$$.getItem("RenderContext")||new $m($l,$i,$sJ.create("AUTO"))),$x.ctx.sprite=$J,($k=$x.canvas).clear(),($k.width!=$l||$k.height!=$i)&&$k.size($l,$i),"bitmap"===$R?$k.context.asBitmap=!0:"normal"===$R&&($k.context.asBitmap=!1),1!=$o||1!=$r){var $U=$x.ctx;$U.save(),$U.scale($o,$r),!$I.isConchWebGL&&$I.isConchApp&&($q=$J._$P.cf)&&$U.setFilterMatrix&&$U.setFilterMatrix($q._mat,$q._alpha),$T._fun.call($T,$J,$x,-$u,-$S),$U.restore(),$I.isConchApp&&!$I.isConchWebGL||$J._applyFilters();}else $U=$x.ctx,!$I.isConchWebGL&&$I.isConchApp&&($q=$J._$P.cf)&&$U.setFilterMatrix&&$U.setFilterMatrix($q._mat,$q._alpha),$T._fun.call($T,$J,$x,-$u,-$S),$I.isConchApp&&!$I.isConchWebGL||$J._applyFilters();$J._$P.staticCache&&($L.reCache=!1),$M.canvasReCache++;}else $u=($Y=$L._cacheRec).x,$S=$Y.y,$k=$x.canvas;$h.drawCanvas($k,$f+$u,$n+$S,$Y.width,$Y.height);}else $T._fun.call($T,$J,$x,$f,$n);},$k.__init__=function(){var $J,$h,$f=0;for($h=$y.createRenderSprite(69905,null),$J=$k.renders.length=4096,$f=0;$f<$J;$f++)$k.renders[$f]=$h;$k.renders[0]=$y.createRenderSprite(0,null),function($J,$h){for(var $f=0,$n=0;$n<$J.length;$n++)$f|=$J[$n],$k.renders[$f]=$h;}([1,512,4,2],new $k(1,null)),$k.renders[513]=$y.createRenderSprite(513,null),$k.renders[517]=new $k(517,null);},$k._initRenderFun=function($J,$h,$f,$n){var $L=$J._renderType;($k.renders[$L]=$k._getTypeRender($L))._fun($J,$h,$f,$n);},$k._getTypeRender=function($J){for(var $h=null,$f=2048;1<$f;)$f&$J&&($h=$y.createRenderSprite($f,$h)),$f>>=1;return $h;},$k.IMAGE=1,$k.ALPHA=2,$k.TRANSFORM=4,$k.BLEND=8,$k.CANVAS=16,$k.FILTERS=32,$k.MASK=64,$k.CLIP=128,$k.STYLE=256,$k.GRAPHICS=512,$k.CUSTOM=1024,$k.CHILDS=2048,$k.INIT=69905,$k.renders=[],$k.NORENDER=new $k(0,null),$k;}(),$t=function(){function $u(){this._repaint=!1;}$q($u,"laya.resource.Context");var $J=$u.prototype;return $J.replaceReset=function(){var $J,$h,$f=0;for($J=$u.replaceKeys.length,$f=0;$f<$J;$f++)$h=$u.replaceKeys[$f],this[$u.newKeys[$f]]=this[$h];},$J.replaceResotre=function(){this.__restore(),this.__reset();},$J.setIsMainContext=function(){},$J.drawTextures=function($J,$h,$f,$n){$M.drawCall+=$h.length/2;for(var $L=$J.width,$T=$J.height,$k=0,$u=$h.length;$k<$u;$k+=2)this.drawTexture($J,$h[$k],$h[$k+1],$L,$T,$f,$n);},$J.drawCanvas=function($J,$h,$f,$n,$L){$M.drawCall++,this.drawImage($J.source,$h,$f,$n,$L);},$J.fillRect=function($J,$h,$f,$n,$L){$M.drawCall++,$L&&(this.fillStyle=$L),this.__fillRect($J,$h,$f,$n);},$J.fillText=function($J,$h,$f,$n,$L,$T){$M.drawCall++,3<arguments.length&&null!=$n&&(this.font=$n,this.fillStyle=$L,this.textAlign=$T,this.textBaseline="top"),this.__fillText($J,$h,$f);},$J.fillBorderText=function($J,$h,$f,$n,$L,$T,$k,$u){$M.drawCall++,this.font=$n,this.fillStyle=$L,this.textBaseline="top",this.strokeStyle=$T,this.lineWidth=$k,this.textAlign=$u,this.__strokeText($J,$h,$f),this.__fillText($J,$h,$f);},$J.strokeText=function($J,$h,$f,$n,$L,$T,$k){$M.drawCall++,3<arguments.length&&null!=$n&&(this.font=$n,this.strokeStyle=$L,this.lineWidth=$T,this.textAlign=$k,this.textBaseline="top"),this.__strokeText($J,$h,$f);},$J.transformByMatrix=function($J){this.transform($J.a,$J.b,$J.c,$J.d,$J.tx,$J.ty);},$J.setTransformByMatrix=function($J){this.setTransform($J.a,$J.b,$J.c,$J.d,$J.tx,$J.ty);},$J.clipRect=function($J,$h,$f,$n){$M.drawCall++,this.beginPath(),this.rect($J,$h,$f,$n),this.clip();},$J.drawTexture=function($J,$h,$f,$n,$L,$T,$k){$M.drawCall++;var $u=$J.uv,$S=$J.bitmap.width,$Y=$J.bitmap.height;this.drawImage($J.source,$u[0]*$S,$u[1]*$Y,($u[2]-$u[0])*$S,($u[5]-$u[3])*$Y,$h+$T,$f+$k,$n,$L);},$J.drawTextureWithTransform=function($J,$h,$f,$n,$L,$T,$k,$u,$S){$M.drawCall++;var $Y=$J.uv,$x=$J.bitmap.width,$j=$J.bitmap.height;this.save(),1!=$S&&(this.globalAlpha*=$S),$T?(this.transform($T.a,$T.b,$T.c,$T.d,$T.tx+$k,$T.ty+$u),this.drawImage($J.source,$Y[0]*$x,$Y[1]*$j,($Y[2]-$Y[0])*$x,($Y[5]-$Y[3])*$j,$h,$f,$n,$L)):this.drawImage($J.source,$Y[0]*$x,$Y[1]*$j,($Y[2]-$Y[0])*$x,($Y[5]-$Y[3])*$j,$h+$k,$f+$u,$n,$L),this.restore();},$J.drawTexture2=function($J,$h,$f,$n,$L,$T,$k,$u){var $S=$u[0];if($S.loaded&&$S.bitmap&&$S.source){$M.drawCall++;var $Y=1!==$T;if($Y){var $x=this.globalAlpha;this.globalAlpha*=$T;}var $j=$S.uv,$R=$S.bitmap.width,$l=$S.bitmap.height;$L?(this.save(),this.transform($L.a,$L.b,$L.c,$L.d,$L.tx+$J,$L.ty+$h),this.drawImage($S.source,$j[0]*$R,$j[1]*$l,($j[2]-$j[0])*$R,($j[5]-$j[3])*$l,$u[1]-$f,$u[2]-$n,$u[3],$u[4]),this.restore()):this.drawImage($S.source,$j[0]*$R,$j[1]*$l,($j[2]-$j[0])*$R,($j[5]-$j[3])*$l,$u[1]-$f+$J,$u[2]-$n+$h,$u[3],$u[4]),$Y&&(this.globalAlpha=$x);}},$J.fillTexture=function($J,$h,$f,$n,$L,$T,$k,$u){if(!$u.pat){if($J.uv!=$xJ.DEF_UV){var $S=new $sJ("2D");$S.getContext("2d"),$S.size($J.width,$J.height),$S.context.drawTexture($J,0,0,$J.width,$J.height,0,0),$J=new $xJ($S);}$u.pat=this.createPattern($J.bitmap.source,$T);}var $Y=$h,$x=$f,$j=0,$R=0;$k&&($Y+=$k.x%$J.width,$x+=$k.y%$J.height,$j-=$k.x%$J.width,$R-=$k.y%$J.height),this.translate($Y,$x),this.fillRect($j,$R,$n,$L,$u.pat),this.translate(-$Y,-$x);},$J.drawTriangle=function($J,$h,$f,$n,$L,$T,$k,$u){var $S=$J.bitmap,$Y=$S.source,$x=$J.width,$j=$J.height,$R=$S.width,$l=$S.height,$i=$f[$n]*$R,$q=$f[$L]*$R,$o=$f[$T]*$R,$r=$f[$n+1]*$l,$_=$f[$L+1]*$l,$s=$f[$T+1]*$l,$d=$h[$n],$p=$h[$L],$U=$h[$T],$Q=$h[$n+1],$D=$h[$L+1],$g=$h[$T+1];if($u){var $F=($d+$p+$U)/3,$A=($Q+$D+$g)/3,$G=$d-$F,$y=$Q-$A,$O=Math.sqrt($G*$G+$y*$y);$d=$F+$G/$O*($O+1),$Q=$A+$y/$O*($O+1),$y=$D-$A,$p=$F+($G=$p-$F)/($O=Math.sqrt($G*$G+$y*$y))*($O+1),$D=$A+$y/$O*($O+1),$y=$g-$A,$U=$F+($G=$U-$F)/($O=Math.sqrt($G*$G+$y*$y))*($O+1),$g=$A+$y/$O*($O+1);}this.save(),$k&&this.transform($k.a,$k.b,$k.c,$k.d,$k.tx,$k.ty),this.beginPath(),this.moveTo($d,$Q),this.lineTo($p,$D),this.lineTo($U,$g),this.closePath(),this.clip();var $P=1/($i*$_+$r*$o+$q*$s-$_*$o-$r*$q-$i*$s),$W=$d*$_+$r*$U+$p*$s-$_*$U-$r*$p-$d*$s,$I=$i*$p+$d*$o+$q*$U-$p*$o-$d*$q-$i*$U,$m=$i*$_*$U+$r*$p*$o+$d*$q*$s-$d*$_*$o-$r*$q*$U-$i*$p*$s,$Z=$Q*$_+$r*$g+$D*$s-$_*$g-$r*$D-$Q*$s,$t=$i*$D+$Q*$o+$q*$g-$D*$o-$Q*$q-$i*$g,$c=$i*$_*$g+$r*$D*$o+$Q*$q*$s-$Q*$_*$o-$r*$q*$g-$i*$D*$s;this.transform($W*$P,$Z*$P,$I*$P,$t*$P,$m*$P,$c*$P),this.drawImage($Y,$J.uv[0]*$R,$J.uv[1]*$l,$x,$j,$J.uv[0]*$R,$J.uv[1]*$l,$x,$j),this.restore();},$J.flush=function(){return 0;},$J.fillWords=function($J,$h,$f,$n,$L,$T){$n&&(this.font=$n),$L&&(this.fillStyle=$L);this.textBaseline="top",this.textAlign="left";for(var $k=0,$u=$J.length;$k<$u;$k++){var $S=$J[$k];if(this.__fillText($S.char,$S.x+$h,$S.y+$f),1===$T){var $Y=$S.height,$x=.5*$S.style.letterSpacing;$x||($x=0),this.beginPath(),this.strokeStyle=$L,this.lineWidth=1,this.moveTo($h+$S.x-$x+.5,$f+$S.y+$Y+.5),this.lineTo($h+$S.x+$S.width+$x+.5,$f+$S.y+$Y+.5),this.stroke();}}},$J.fillBorderWords=function($J,$h,$f,$n,$L,$T,$k){$n&&(this.font=$n),$L&&(this.fillStyle=$L),this.textBaseline="top",this.lineWidth=$k,this.textAlign="left",this.strokeStyle=$T;for(var $u=0,$S=$J.length;$u<$S;$u++){var $Y=$J[$u];this.__strokeText($Y.char,$Y.x+$h,$Y.y+$f),this.__fillText($Y.char,$Y.x+$h,$Y.y+$f);}},$J.destroy=function(){this.canvas.width=this.canvas.height=0;},$J.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1;},$J.drawCurves=function($J,$h,$f){this.beginPath(),this.strokeStyle=$f[3],this.lineWidth=$f[4];var $n=$f[2];$J+=$f[0],$h+=$f[1],this.moveTo($J+$n[0],$h+$n[1]);for(var $L=2,$T=$n.length;$L<$T;)this.quadraticCurveTo($J+$n[$L++],$h+$n[$L++],$J+$n[$L++],$h+$n[$L++]);this.stroke();},$u.__init__=function($h){var $f=laya.resource.Context.prototype;if(!($h=$h||CanvasRenderingContext2D.prototype).inited){$h.inited=!0,$h.__fillText=$h.fillText,$h.__fillRect=$h.fillRect,$h.__strokeText=$h.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function($J){$h[$J]=$f[$J];});}},$u.replaceCanvasGetSet=function($J,$h){var $f=Object.getOwnPropertyDescriptor($J,$h);if(!$f||!$f.configurable)return!1;var $n,$L={};for($n in $f)"set"!=$n&&($L[$n]=$f[$n]);var $T=$f.set;return $L.set=function($J){$T.call(this,$J);var $h=this.getContext("2d");$h&&"__reset"in $h&&$h.__reset();},Object.defineProperty($J,$h,$L),!0;},$u.replaceGetSet=function($J,$h){var $f=Object.getOwnPropertyDescriptor($J,$h);if(!$f||!$f.configurable)return!1;var $n,$L={};for($n in $f)"set"!=$n&&($L[$n]=$f[$n]);var $T=$f.set,$k="___"+$h+"__";return $u.newKeys.push($k),$L.set=function($J){$J!=this[$k]&&(this[$k]=$J,$T.call(this,$J));},Object.defineProperty($J,$h,$L),!0;},$u._default=new $u(),$u.newKeys=[],$S($u,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"];}]),$u;}(),$c=function(){function $T($J){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++$T._uniqueIDCounter,this._name=$J||"Content Manager",$T._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,$T._resourceManagers.push(this),this._resources=[],this._records={};}$q($T,"laya.resource.ResourceManager");var $J=$T.prototype;return $Q.imps($J,{"laya.resource.IDispose":!0}),$J.getResourceByIndex=function($J){return this._resources[$J];},$J.getResourcesLength=function(){return this._resources.length;},$J.addResource=function($J){return $J.resourceManager&&$J.resourceManager.removeResource($J),-1===this._resources.indexOf($J)&&(($J._resourceManager=this)._resources.push($J),this.addRecord($J.uri,$J.__className,$J.memorySize),this.addSize($J.memorySize),!0);},$J.removeResource=function($J){var $h=this._resources.indexOf($J);return-1!==$h&&(this._resources.splice($h,1),$J._resourceManager=null,this._memorySize-=$J.memorySize,this.addRecord($J.uri,$J.__className,-$J.memorySize),!0);},$J.unload=function(){for(var $J=this._resources.slice(0,this._resources.length),$h=0;$h<$J.length;$h++){$J[$h].destroy();}$J.length=0;},$J.dispose=function(){if(this===$T._systemResourceManager)throw new Error("systemResourceManager不能被释放！");$T._resourceManagers.splice($T._resourceManagers.indexOf(this),1),$T._isResourceManagersSorted=!1;for(var $J=this._resources.slice(0,this._resources.length),$h=0;$h<$J.length;$h++){var $f=$J[$h];$f.resourceManager.removeResource($f),$f.destroy();}$J.length=0;},$J.addSize=function($J){$J&&(this.autoRelease&&0<$J&&this._memorySize+$J>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=$J);},$J.addRecord=function($J,$h,$f){DEBUG&&$f&&!$J&&console.error($J,$h,$f);},$J.garbageCollection=function($J){var $h=this._resources;($h=$h.slice()).sort(function($J,$h){if(!$J||!$h)throw new Error("a或b不能为空！");return $J.released&&$h.released?0:$J.released?1:$h.released?-1:$J._lastUseFrameCount-$h._lastUseFrameCount;});for(var $f=$M.loopCount,$n=0,$L=$h.length;$n<$L;$n++){var $T=$h[$n];if(!(1<$f-$T._lastUseFrameCount))return void(this._memorySize>=$J&&(this._isOverflow=!0));if($T.releaseResource(),this._memorySize<$J)return void(this._isOverflow=!1);}},$x(0,$J,"id",function(){return this._id;}),$x(0,$J,"name",function(){return this._name;},function($J){!$J&&""===$J||this._name===$J||(this._name=$J,$T._isResourceManagersSorted=!1);}),$x(0,$J,"memorySize",function(){return this._memorySize;}),$x(0,$J,"records",function(){return this._records;}),$x(1,$T,"systemResourceManager",function(){return $T._systemResourceManager;}),$T.__init__=function(){$T.currentResourceManager=$T.systemResourceManager;},$T.getLoadedResourceManagerByIndex=function($J){return $T._resourceManagers[$J];},$T.getLoadedResourceManagersCount=function(){return $T._resourceManagers.length;},$T.recreateContentManagers=function($J){void 0===$J&&($J=!1);for(var $h=$T.currentResourceManager,$f=0;$f<$T._resourceManagers.length;$f++){$T.currentResourceManager=$T._resourceManagers[$f];for(var $n=0;$n<$T.currentResourceManager._resources.length;$n++)$T.currentResourceManager._resources[$n].releaseResource($J),$T.currentResourceManager._resources[$n].activeResource($J);}$T.currentResourceManager=$h;},$T.releaseContentManagers=function($J){void 0===$J&&($J=!1);for(var $h=$T.currentResourceManager,$f=0;$f<$T._resourceManagers.length;$f++){$T.currentResourceManager=$T._resourceManagers[$f];for(var $n=0;$n<$T.currentResourceManager._resources.length;$n++){var $L=$T.currentResourceManager._resources[$n];!$L.released&&$L.releaseResource($J);}}$T.currentResourceManager=$h;},$T._uniqueIDCounter=0,$T._isResourceManagersSorted=!1,$T._resourceManagers=[],$S($T,["_systemResourceManager",function(){return this._systemResourceManager=new $T("System Resource Manager");},"currentResourceManager",function(){return this.currentResourceManager=$T._systemResourceManager;}]),$T;}(),$a=(function(){function $J(){}$q($J,"laya.system.System"),$J.changeDefinition=function($J,$h){$Q[$J]=$h;var $f=$J+"=classObj";$Q._runScript($f);},$J.__init__=function(){$I.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice());};}(),function(){function $f(){}return $q($f,"laya.utils.Browser"),$x(1,$f,"pixelRatio",function(){return $f.__init__(),-1<$f.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:$y.getPixelRatio();}),$x(1,$f,"height",function(){return $f.__init__(),($Q.stage&&$Q.stage.canvasRotation?$f.clientWidth:$f.clientHeight)*$f.pixelRatio;}),$x(1,$f,"clientWidth",function(){return $f.__init__(),$f.window.innerWidth||$f.document.body.clientWidth;}),$x(1,$f,"window",function(){return $f.__init__(),$f._window;}),$x(1,$f,"clientHeight",function(){return $f.__init__(),$f.window.innerHeight||$f.document.body.clientHeight||$f.document.documentElement.clientHeight;}),$x(1,$f,"width",function(){return $f.__init__(),($Q.stage&&$Q.stage.canvasRotation?$f.clientHeight:$f.clientWidth)*$f.pixelRatio;}),$x(1,$f,"container",function(){return $f.__init__(),$f._container||(($f._container=$f.createElement("div")).id="layaContainer",$f.document.body.appendChild($f._container)),$f._container;},function($J){$f._container=$J;}),$x(1,$f,"document",function(){return $f.__init__(),$f._document;}),$f.__init__=function(){if(!$f._window){$f._window=$y.getWindow(),$f._document=$f.window.document,$f._window.addEventListener("message",function($J){laya.utils.Browser._onMessage($J);},!1),$f.document.__createElement=$f.document.createElement,$k.requestAnimationFrame=$k.requestAnimationFrame||$k.webkitRequestAnimationFrame||$k.mozRequestAnimationFrame||$k.oRequestAnimationFrame||$k.msRequestAnimationFrame||function($J){return $k.setTimeout($J,1e3/60);};var $J=$k.document.body.style;$J["-webkit-user-select"]="none",$J["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",$f.userAgent=$f.window.navigator.userAgent,$f.onIOS=!!($f.u=$f.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),$f.onMobile=-1<$f.u.indexOf("Mobile"),$f.onIPhone=-1<$f.u.indexOf("iPhone"),$f.onMac=-1<$f.u.indexOf("Mac OS X"),$f.onIPad=-1<$f.u.indexOf("iPad"),$f.onAndroid=-1<$f.u.indexOf("Android")||-1<$f.u.indexOf("Adr"),$f.onWP=-1<$f.u.indexOf("Windows Phone"),$f.onQQBrowser=-1<$f.u.indexOf("QQBrowser"),$f.onMQQBrowser=-1<$f.u.indexOf("MQQBrowser")||-1<$f.u.indexOf("Mobile")&&-1<$f.u.indexOf("QQ"),$f.onIE=!!$f.window.ActiveXObject||"ActiveXObject"in $f.window,$f.onWeiXin=-1<$f.u.indexOf("MicroMessenger"),$f.onPC=!$f.onMobile,$f.onSafari=-1<$f.u.indexOf("Safari"),$f.onFirefox=-1<$f.u.indexOf("Firefox"),$f.onEdge=-1<$f.u.indexOf("Edge"),$f.onMiniGame=-1<$f.u.indexOf("MiniGame"),$f.onLimixiu=-1<$f.u.indexOf("limixiu"),$f.httpProtocol="http:"==$f.window.location.protocol,$f.onMiniGame&&null==$f.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),$f.webAudioEnabled=!!($f.window.AudioContext||$f.window.webkitAudioContext||$f.window.mozAudioContext),$f.soundType=$f.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",$LJ=$f.webAudioEnabled?$TJ:$fJ,$f.webAudioEnabled&&$TJ.initWebAudio(),$fJ._initMusicAudio(),$f.enableTouch="ontouchstart"in $k||$k.DocumentTouch&&$h instanceof DocumentTouch,$k.focus(),$G._soundClass=$LJ,$G._musicClass=$fJ,$I._mainCanvas=$I._mainCanvas||$sJ.create("2D"),$f.canvas||($f.canvas=$sJ.create("2D"),$f.context=$f.canvas.getContext("2d"));}},$f._onMessage=function($J){if($J.data&&"size"==$J.data.name){if($f.window.innerWidth=$J.data.width,$f.window.innerHeight=$J.data.height,$f.window.__innerHeight=$J.data.clientHeight,!$f.document.createEvent)return void console.warn("no document.createEvent");var $h=$f.document.createEvent("HTMLEvents");return $h.initEvent("resize",!1,!1),void $f.window.dispatchEvent($h);}},$f.createElement=function($J){return $f.__init__(),$f.document.__createElement($J);},$f.getElementById=function($J){return $f.__init__(),$f.document.getElementById($J);},$f.removeElement=function($J){$J&&$J.parentNode&&$J.parentNode.removeChild($J);},$f.now=function(){return $y.now();},$f._window=null,$f._document=null,$f._container=null,$f.userAgent=null,$f.u=null,$f.onIOS=!1,$f.onMac=!1,$f.onMobile=!1,$f.onIPhone=!1,$f.onIPad=!1,$f.onAndroid=!1,$f.onWP=!1,$f.onQQBrowser=!1,$f.onMQQBrowser=!1,$f.onSafari=!1,$f.onFirefox=!1,$f.onEdge=!1,$f.onIE=!1,$f.onWeiXin=!1,$f.onMiniGame=!1,$f.onLimixiu=!1,$f.onPC=!1,$f.httpProtocol=!1,$f.webAudioEnabled=!1,$f.soundType=null,$f.enableTouch=!1,$f.canvas=null,$f.context=null,$f.__init$=function(){},$f;}()),$B=function(){function $h($J){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,$J?(this._u8d_=new Uint8Array($J),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_);}$q($h,"laya.utils.Byte");var $J=$h.prototype;return $J.___resizeBuffer=function($h){try{var $J=new Uint8Array($h);null!=this._u8d_&&(this._u8d_.length<=$h?$J.set(this._u8d_):$J.set(this._u8d_.subarray(0,$h))),this._u8d_=$J,this._d_=new DataView($J.buffer);}catch($J){throw"___resizeBuffer err:"+$h;}},$J.getString=function(){return this.rUTF(this.getUint16());},$J.getFloat32Array=function($J,$h){var $f=$J+$h;$f=$f>this._length?this._length:$f;var $n=new Float32Array(this._d_.buffer.slice($J,$f));return this._pos_=$f,$n;},$J.getUint8Array=function($J,$h){var $f=$J+$h;$f=$f>this._length?this._length:$f;var $n=new Uint8Array(this._d_.buffer.slice($J,$f));return this._pos_=$f,$n;},$J.getInt16Array=function($J,$h){var $f=$J+$h;$f=$f>this._length?this._length:$f;var $n=new Int16Array(this._d_.buffer.slice($J,$f));return this._pos_=$f,$n;},$J.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var $J=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,$J;},$J.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var $J=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,$J;},$J.writeFloat32=function($J){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,$J,this._xd_),this._pos_+=4;},$J.writeFloat64=function($J){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,$J,this._xd_),this._pos_+=8;},$J.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var $J=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,$J;},$J.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var $J=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,$J;},$J.writeInt32=function($J){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,$J,this._xd_),this._pos_+=4;},$J.writeUint32=function($J){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,$J,this._xd_),this._pos_+=4;},$J.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var $J=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,$J;},$J.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var $J=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,$J;},$J.writeUint16=function($J){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,$J,this._xd_),this._pos_+=2;},$J.writeInt16=function($J){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,$J,this._xd_),this._pos_+=2;},$J.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++);},$J.writeUint8=function($J){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,$J),this._pos_++;},$J._getUInt8=function($J){return this._d_.getUint8($J);},$J._getUint16=function($J){return this._d_.getUint16($J,this._xd_);},$J._getMatrix=function(){return new $O(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32());},$J.rUTF=function($J){for(var $h=[],$f=this._pos_+$J,$n=0,$L=0,$T=0,$k=String.fromCharCode,$u=this._u8d_;this._pos_<$f;)($n=$u[this._pos_++])<128?0!=$n&&$h.push($k($n)):$n<224?$h.push($k((63&$n)<<6|127&$u[this._pos_++])):$n<240?($L=$u[this._pos_++],$h.push($k((31&$n)<<12|(127&$L)<<6|127&$u[this._pos_++]))):($L=$u[this._pos_++],$T=$u[this._pos_++],$h.push($k((15&$n)<<18|(127&$L)<<12|$T<<6&127|127&$u[this._pos_++]))),0;return $h.join("");},$J.getCustomString=function($J){for(var $h=[],$f=0,$n=0,$L=0,$T=String.fromCharCode,$k=this._u8d_;0<$J;)if(($n=$k[this._pos_])<128)$h.push($T($n)),this._pos_++,$J--;else for($f=$n-128,this._pos_++,$J-=$f;0<$f;)$n=$k[this._pos_++],$L=$k[this._pos_++],$h.push($T($L<<8|$n)),$f--;return $h.join("");},$J.clear=function(){this._pos_=0,this.length=0;},$J.__getBuffer=function(){return this._d_.buffer;},$J.writeUTFBytes=function($J){for(var $h=0,$f=($J+="").length;$h<$f;$h++){var $n=$J.charCodeAt($h);$n<=127?this.writeByte($n):$n<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|$n>>6,128|63&$n],this._pos_),this._pos_+=2):$n<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|$n>>12,128|$n>>6&63,128|63&$n],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|$n>>18,128|$n>>12&63,128|$n>>6&63,128|63&$n],this._pos_),this._pos_+=4);}},$J.writeUTFString=function($J){var $h=this.pos;this.writeUint16(1),this.writeUTFBytes($J);var $f=this.pos-$h-2;if(65536<=$f)throw"writeUTFString byte len more than 65536";this._d_.setUint16($h,$f,this._xd_);},$J.readUTFString=function(){return this.readUTFBytes(this.getUint16());},$J.getUTFString=function(){return this.readUTFString();},$J.readUTFBytes=function($J){if(void 0===$J&&($J=-1),0==$J)return"";var $h=this.bytesAvailable;if($h<$J)throw"readUTFBytes error - Out of bounds";return $J=0<$J?$J:$h,this.rUTF($J);},$J.getUTFBytes=function($J){return void 0===$J&&($J=-1),this.readUTFBytes($J);},$J.writeByte=function($J){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,$J),this._pos_+=1;},$J.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++);},$J.getByte=function(){return this.readByte();},$J.ensureWrite=function($J){this._length<$J&&(this._length=$J),this._allocated_<$J&&(this.length=$J);},$J.writeArrayBuffer=function($J,$h,$f){if(void 0===$h&&($h=0),void 0===$f&&($f=0),$h<0||$f<0)throw"writeArrayBuffer error - Out of bounds";0==$f&&($f=$J.byteLength-$h),this.ensureWrite(this._pos_+$f);var $n=new Uint8Array($J);this._u8d_.set($n.subarray($h,$h+$f),this._pos_),this._pos_+=$f;},$x(0,$J,"buffer",function(){var $J=this._d_.buffer;return $J.byteLength==this.length?$J:$J.slice(0,this.length);}),$x(0,$J,"endian",function(){return this._xd_?"littleEndian":"bigEndian";},function($J){this._xd_="littleEndian"==$J;}),$x(0,$J,"length",function(){return this._length;},function($J){this._allocated_<$J?this.___resizeBuffer(this._allocated_=Math.floor(Math.max($J,2*this._allocated_))):this._allocated_>$J&&this.___resizeBuffer(this._allocated_=$J),this._length=$J;}),$x(0,$J,"pos",function(){return this._pos_;},function($J){this._pos_=$J;}),$x(0,$J,"bytesAvailable",function(){return this._length-this._pos_;}),$h.getSystemEndian=function(){if(!$h._sysEndian){var $J=new ArrayBuffer(2);new DataView($J).setInt16(0,256,!0),$h._sysEndian=256===new Int16Array($J)[0]?"littleEndian":"bigEndian";}return $h._sysEndian;},$h.BIG_ENDIAN="bigEndian",$h.LITTLE_ENDIAN="littleEndian",$h._sysEndian=null,$h;}(),$V=function(){function $L(){}return $q($L,"laya.utils.CacheManager"),$L.regCacheByFunction=function($J,$h){var $f;$L.unRegCacheByFunction($J,$h),$f={tryDispose:$J,getCacheList:$h},$L._cacheList.push($f);},$L.unRegCacheByFunction=function($J,$h){var $f,$n=0;for($f=$L._cacheList.length,$n=0;$n<$f;$n++)if($L._cacheList[$n].tryDispose==$J&&$L._cacheList[$n].getCacheList==$h)return void $L._cacheList.splice($n,1);},$L.forceDispose=function(){var $J=0,$h=$L._cacheList.length;for($J=0;$J<$h;$J++)$L._cacheList[$J].tryDispose(!0);},$L.beginCheck=function($J){void 0===$J&&($J=15e3),$Q.timer.loop($J,null,$L._checkLoop);},$L.stopCheck=function(){$Q.timer.clear(null,$L._checkLoop);},$L._checkLoop=function(){var $J=$L._cacheList;if(!($J.length<1)){var $h,$f=$a.now(),$n=0;for($h=$n=$J.length;0<$n&&($J[$L._index=++$L._index%$h].tryDispose(!1),!($a.now()-$f>$L.loopTimeLimit));)$n--;}},$L.loopTimeLimit=2,$L._cacheList=[],$L._index=0,$L;}(),$C=function(){function $l(){}return $q($l,"laya.utils.ClassUtils"),$l.regClass=function($J,$h){$l._classMap[$J]=$h;},$l.getRegClass=function($J){return $l._classMap[$J];},$l.getInstance=function($J){var $h=$l.getClass($J);return $h?new $h():(console.warn("[error] Undefined class:",$J),null);},$l.createByJson=function($J,$h,$f,$n,$L){"string"==typeof $J&&($J=JSON.parse($J));var $T=$J.props;if(!$h&&!($h=$L?$L.runWith($J):$l.getInstance($T.runtime||$J.type)))return null;var $k=$J.child;if($k)for(var $u=0,$S=$k.length;$u<$S;$u++){var $Y=$k[$u];if("render"!==$Y.props.name&&"render"!==$Y.props.renderType||!$h._$set_itemRender){if("Graphic"==$Y.type)$l.addGraphicsToSprite($Y,$h);else if($l.isDrawType($Y.type))$l.addGraphicToSprite($Y,$h,!0);else{var $x=$l.createByJson($Y,null,$f,$n,$L);"Script"==$Y.type?$x.hasOwnProperty("owner")?$x.owner=$h:$x.hasOwnProperty("target")&&($x.target=$h):"mask"==$Y.props.renderType?$h.mask=$x:$h.addChild($x);}}else $h.itemRender=$Y;}if($T)for(var $j in $T){var $R=$T[$j];"var"===$j&&$f?$f[$R]=$h:$R instanceof Array&&"function"==typeof $h[$j]?$h[$j].apply($h,$R):$h[$j]=$R;}return $n&&$J.customProps&&$n.runWith([$h,$J]),$h.created&&$h.created(),$h;},$l.addGraphicsToSprite=function($J,$h){var $f;if(($f=$J.child)&&!($f.length<1)){var $n;$n=$l._getGraphicsFromSprite($J,$h);var $L=0,$T=0;$J.props&&($L=$l._getObjVar($J.props,"x",0),$T=$l._getObjVar($J.props,"y",0)),0!=$L&&0!=$T&&$n.translate($L,$T);var $k,$u=0;for($k=$f.length,$u=0;$u<$k;$u++)$l._addGraphicToGraphics($f[$u],$n);0!=$L&&0!=$T&&$n.translate(-$L,-$T);}},$l.addGraphicToSprite=function($J,$h,$f){var $n;void 0===$f&&($f=!1),$n=$f?$l._getGraphicsFromSprite($J,$h):$h.graphics,$l._addGraphicToGraphics($J,$n);},$l._getGraphicsFromSprite=function($J,$h){var $f,$n;if(!$J||!$J.props)return $h.graphics;switch($n=$J.props.renderType){case"hit":case"unHit":var $L;$h.hitArea||($h.hitArea=new $v()),($L=$h.hitArea)[$n]||($L[$n]=new $R()),$f=$L[$n];}return $f||($f=$h.graphics),$f;},$l._getTransformData=function($J){var $h;($J.hasOwnProperty("pivotX")||$J.hasOwnProperty("pivotY"))&&($h=$h||new $O()).translate(-$l._getObjVar($J,"pivotX",0),-$l._getObjVar($J,"pivotY",0));var $f=$l._getObjVar($J,"scaleX",1),$n=$l._getObjVar($J,"scaleY",1),$L=$l._getObjVar($J,"rotation",0);$l._getObjVar($J,"skewX",0),$l._getObjVar($J,"skewY",0);return 1==$f&&1==$n&&0==$L||(($h=$h||new $O()).scale($f,$n),$h.rotate(.0174532922222222*$L)),$h;},$l._addGraphicToGraphics=function($J,$h){var $f,$n;if(($f=$J.props)&&($n=$l.DrawTypeDic[$J.type])){var $L,$T;$L=$h;var $k=$l._getParams($f,$n[1],$n[2],$n[3]);(($T=$l._tM)||1!=$l._alpha)&&($L.save(),$T&&$L.transform($T),1!=$l._alpha&&$L.alpha($l._alpha)),$L[$n[0]].apply($L,$k),($T||1!=$l._alpha)&&$L.restore();}},$l._adptLineData=function($J){return $J[2]=parseFloat($J[0])+parseFloat($J[2]),$J[3]=parseFloat($J[1])+parseFloat($J[3]),$J;},$l._adptTextureData=function($J){return $J[0]=$uJ.getRes($J[0]),$J;},$l._adptLinesData=function($J){return $J[2]=$l._getPointListByStr($J[2]),$J;},$l.isDrawType=function($J){return"Image"!=$J&&$l.DrawTypeDic.hasOwnProperty($J);},$l._getParams=function($J,$h,$f,$n){var $L;void 0===$f&&($f=0),($L=$l._temParam).length=$h.length;var $T,$k,$u=0;for($T=$h.length,$u=0;$u<$T;$u++)$L[$u]=$l._getObjVar($J,$h[$u][0],$h[$u][1]);return $l._alpha=$l._getObjVar($J,"alpha",1),$k=$l._getTransformData($J),$l._tM=$k?($f||($f=0),$k.translate($L[$f],$L[$f+1]),$L[$f]=$L[$f+1]=0,$k):null,$n&&$l[$n]&&($L=$l[$n]($L)),$L;},$l._getPointListByStr=function($J){var $h,$f,$n=0;for($f=($h=$J.split(",")).length,$n=0;$n<$f;$n++)$h[$n]=parseFloat($h[$n]);return $h;},$l._getObjVar=function($J,$h,$f){return $J.hasOwnProperty($h)?$J[$h]:$f;},$l._temParam=[],$l._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},$l.getClass=function($J){var $h=$l._classMap[$J]||$J;return"string"==typeof $h?$Q.__classmap[$h]:$h;},$l._tM=null,$l._alpha=NaN,$S($l,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]};}]),$l;}(),$e=function(){function $T($J){if(this._color=[],"string"==typeof $J){null===(this.strColor=$J)&&($J="#000000"),"#"==$J.charAt(0)&&($J=$J.substr(1));var $h=$J.length;if(3==$h||4==$h){for(var $f="",$n=0;$n<$h;$n++)$f+=$J[$n]+$J[$n];$J=$f;}var $L=this.numColor=parseInt($J,16);if(8==$J.length)return void(this._color=[parseInt($J.substr(0,2),16)/255,((16711680&$L)>>16)/255,((65280&$L)>>8)/255,(255&$L)/255]);}else $L=this.numColor=$J,this.strColor=$E.toHexColor($L);this._color=[((16711680&$L)>>16)/255,((65280&$L)>>8)/255,(255&$L)/255,1],this._color.__id=++$T._COLODID;}return $q($T,"laya.utils.Color"),$T._initDefault=function(){for(var $J in $T._DEFAULT={},$T._COLOR_MAP)$T._SAVE[$J]=$T._DEFAULT[$J]=new $T($T._COLOR_MAP[$J]);return $T._DEFAULT;},$T._initSaveMap=function(){for(var $J in $T._SAVE_SIZE=0,$T._SAVE={},$T._DEFAULT)$T._SAVE[$J]=$T._DEFAULT[$J];},$T.create=function($J){var $h=$T._SAVE[$J+""];return null!=$h?$h:($T._SAVE_SIZE<1e3||$T._initSaveMap(),$T._SAVE[$J+""]=new $T($J));},$T._SAVE={},$T._SAVE_SIZE=0,$T._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},$T._DEFAULT=$T._initDefault(),$T._COLODID=1,$T;}(),$H=(function(){function $J(){this._values=[],this._keys=[];}$q($J,"laya.utils.Dictionary");var $h=$J.prototype;$h.set=function($J,$h){var $f=this.indexOf($J);0<=$f?this._values[$f]=$h:(this._keys.push($J),this._values.push($h));},$h.indexOf=function($J){var $h=this._keys.indexOf($J);return 0<=$h?$h:($J="string"==typeof $J?Number($J):"number"==typeof $J?$J.toString():$J,this._keys.indexOf($J));},$h.get=function($J){var $h=this.indexOf($J);return $h<0?null:this._values[$h];},$h.remove=function($J){var $h=this.indexOf($J);return 0<=$h&&(this._keys.splice($h,1),this._values.splice($h,1),!0);},$h.clear=function(){this._values.length=0,this._keys.length=0;},$x(0,$h,"values",function(){return this._values;}),$x(0,$h,"keys",function(){return this._keys;});}(),function(){function $J(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0;}$q($J,"laya.utils.Dragging");var $h=$J.prototype;return $h.start=function($J,$h,$f,$n,$L,$T,$k,$u){void 0===$u&&($u=.92),this.clearTimer(),this.target=$J,this.area=$h,this.hasInertia=$f,this.elasticDistance=$h?$n:0,this.elasticBackTime=$L,this.data=$T,this._disableMouseEvent=$k,this.ratio=$u,1!=$J.globalScaleX||1!=$J.globalScaleY?this._parent=$J.parent:this._parent=$Q.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,$Q.stage.on("mouseup",this,this.onStageMouseUp),$Q.stage.on("mouseout",this,this.onStageMouseUp),$Q.timer.frameLoop(1,this,this.loop);},$h.clearTimer=function(){$Q.timer.clear(this,this.loop),$Q.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null);},$h.stop=function(){this._dragging&&($i.instance.disableMouseEvent=!1,$Q.stage.off("mouseup",this,this.onStageMouseUp),$Q.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear());},$h.loop=function(){var $J=this._parent.getMousePoint(),$h=$J.x,$f=$J.y,$n=$h-this._lastX,$L=$f-this._lastY;if(this._clickOnly){if(!(1<Math.abs($n*$Q.stage._canvasTransform.getScaleX())||1<Math.abs($L*$Q.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),$i.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1);}else this._offsets.push($n,$L);0==$n&&0==$L||(this._lastX=$h,this._lastY=$f,this.target.x+=$n*this._elasticRateX,this.target.y+=$L*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data));},$h.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var $J=this.area.x-this.target.x;else $J=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-$J/this.elasticDistance),this.target.y<this.area.y)var $h=this.area.y-this.target.y;else $h=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-$h/this.elasticDistance);}},$h.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height);},$h.onStageMouseUp=function($J){if($i.instance.disableMouseEvent=!1,$Q.stage.off("mouseup",this,this.onStageMouseUp),$Q.stage.off("mouseout",this,this.onStageMouseUp),$Q.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var $h=this._offsets.length,$f=Math.min($h,6),$n=this._offsets.length-$f,$L=$h-1;$n<$L;$L--)this._offsetY+=this._offsets[$L--],this._offsetX+=this._offsets[$L];this._offsetX=this._offsetX/$f*2,this._offsetY=this._offsetY/$f*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),$Q.timer.frameLoop(1,this,this.tweenMove);}else 0<this.elasticDistance?this.checkElastic():this.clear();},$h.checkElastic=function(){var $J=NaN,$h=NaN;if(this.target.x<this.area.x?$J=this.area.x:this.target.x>this.area.x+this.area.width&&($J=this.area.x+this.area.width),this.target.y<this.area.y?$h=this.area.y:this.target.y>this.area.y+this.area.height&&($h=this.area.y+this.area.height),isNaN($J)&&isNaN($h))this.clear();else{var $f={};isNaN($J)||($f.x=$J),isNaN($h)||($f.y=$h),this._tween=$w.to(this.target,$f,this.elasticBackTime,$b.sineOut,$_.create(this,this.clear),0,!1,!1);}},$h.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&($Q.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear());},$h.clear=function(){if(this.target){this.clearTimer();var $J=this.target;this.target=null,this._parent=null,$J.event("dragend",this.data);}},$J;}()),$b=function(){function $u(){}return $q($u,"laya.utils.Ease"),$u.linearNone=function($J,$h,$f,$n){return $f*$J/$n+$h;},$u.linearIn=function($J,$h,$f,$n){return $f*$J/$n+$h;},$u.linearInOut=function($J,$h,$f,$n){return $f*$J/$n+$h;},$u.linearOut=function($J,$h,$f,$n){return $f*$J/$n+$h;},$u.bounceIn=function($J,$h,$f,$n){return $f-$u.bounceOut($n-$J,0,$f,$n)+$h;},$u.bounceInOut=function($J,$h,$f,$n){return $J<.5*$n?.5*$u.bounceIn(2*$J,0,$f,$n)+$h:.5*$u.bounceOut(2*$J-$n,0,$f,$n)+.5*$f+$h;},$u.bounceOut=function($J,$h,$f,$n){return($J/=$n)<1/2.75?$f*(7.5625*$J*$J)+$h:$J<2/2.75?$f*(7.5625*($J-=1.5/2.75)*$J+.75)+$h:$J<2.5/2.75?$f*(7.5625*($J-=2.25/2.75)*$J+.9375)+$h:$f*(7.5625*($J-=2.625/2.75)*$J+.984375)+$h;},$u.backIn=function($J,$h,$f,$n,$L){return void 0===$L&&($L=1.70158),$f*($J/=$n)*$J*(($L+1)*$J-$L)+$h;},$u.backInOut=function($J,$h,$f,$n,$L){return void 0===$L&&($L=1.70158),($J/=.5*$n)<1?.5*$f*($J*$J*((1+($L*=1.525))*$J-$L))+$h:$f/2*(($J-=2)*$J*((1+($L*=1.525))*$J+$L)+2)+$h;},$u.backOut=function($J,$h,$f,$n,$L){return void 0===$L&&($L=1.70158),$f*(($J=$J/$n-1)*$J*(($L+1)*$J+$L)+1)+$h;},$u.elasticIn=function($J,$h,$f,$n,$L,$T){var $k;return void 0===$L&&($L=0),void 0===$T&&($T=0),0==$J?$h:1==($J/=$n)?$h+$f:($T||($T=.3*$n),$k=!$L||0<$f&&$L<$f||$f<0&&$L<-$f?($L=$f,$T/4):$T/$u.PI2*Math.asin($f/$L),-$L*Math.pow(2,10*($J-=1))*Math.sin(($J*$n-$k)*$u.PI2/$T)+$h);},$u.elasticInOut=function($J,$h,$f,$n,$L,$T){var $k;return void 0===$L&&($L=0),void 0===$T&&($T=0),0==$J?$h:2==($J/=.5*$n)?$h+$f:($T||($T=$n*(.3*1.5)),$k=!$L||0<$f&&$L<$f||$f<0&&$L<-$f?($L=$f,$T/4):$T/$u.PI2*Math.asin($f/$L),$J<1?$L*Math.pow(2,10*($J-=1))*Math.sin(($J*$n-$k)*$u.PI2/$T)*-.5+$h:$L*Math.pow(2,-10*($J-=1))*Math.sin(($J*$n-$k)*$u.PI2/$T)*.5+$f+$h);},$u.elasticOut=function($J,$h,$f,$n,$L,$T){var $k;return void 0===$L&&($L=0),void 0===$T&&($T=0),0==$J?$h:1==($J/=$n)?$h+$f:($T||($T=.3*$n),$k=!$L||0<$f&&$L<$f||$f<0&&$L<-$f?($L=$f,$T/4):$T/$u.PI2*Math.asin($f/$L),$L*Math.pow(2,-10*$J)*Math.sin(($J*$n-$k)*$u.PI2/$T)+$f+$h);},$u.strongIn=function($J,$h,$f,$n){return $f*($J/=$n)*$J*$J*$J*$J+$h;},$u.strongInOut=function($J,$h,$f,$n){return($J/=.5*$n)<1?.5*$f*$J*$J*$J*$J*$J+$h:.5*$f*(($J-=2)*$J*$J*$J*$J+2)+$h;},$u.strongOut=function($J,$h,$f,$n){return $f*(($J=$J/$n-1)*$J*$J*$J*$J+1)+$h;},$u.sineInOut=function($J,$h,$f,$n){return .5*-$f*(Math.cos(Math.PI*$J/$n)-1)+$h;},$u.sineIn=function($J,$h,$f,$n){return-$f*Math.cos($J/$n*$u.HALF_PI)+$f+$h;},$u.sineOut=function($J,$h,$f,$n){return $f*Math.sin($J/$n*$u.HALF_PI)+$h;},$u.quintIn=function($J,$h,$f,$n){return $f*($J/=$n)*$J*$J*$J*$J+$h;},$u.quintInOut=function($J,$h,$f,$n){return($J/=.5*$n)<1?.5*$f*$J*$J*$J*$J*$J+$h:.5*$f*(($J-=2)*$J*$J*$J*$J+2)+$h;},$u.quintOut=function($J,$h,$f,$n){return $f*(($J=$J/$n-1)*$J*$J*$J*$J+1)+$h;},$u.quartIn=function($J,$h,$f,$n){return $f*($J/=$n)*$J*$J*$J+$h;},$u.quartInOut=function($J,$h,$f,$n){return($J/=.5*$n)<1?.5*$f*$J*$J*$J*$J+$h:.5*-$f*(($J-=2)*$J*$J*$J-2)+$h;},$u.quartOut=function($J,$h,$f,$n){return-$f*(($J=$J/$n-1)*$J*$J*$J-1)+$h;},$u.cubicIn=function($J,$h,$f,$n){return $f*($J/=$n)*$J*$J+$h;},$u.cubicInOut=function($J,$h,$f,$n){return($J/=.5*$n)<1?.5*$f*$J*$J*$J+$h:.5*$f*(($J-=2)*$J*$J+2)+$h;},$u.cubicOut=function($J,$h,$f,$n){return $f*(($J=$J/$n-1)*$J*$J+1)+$h;},$u.quadIn=function($J,$h,$f,$n){return $f*($J/=$n)*$J+$h;},$u.quadInOut=function($J,$h,$f,$n){return($J/=.5*$n)<1?.5*$f*$J*$J+$h:.5*-$f*(--$J*($J-2)-1)+$h;},$u.quadOut=function($J,$h,$f,$n){return-$f*($J/=$n)*($J-2)+$h;},$u.expoIn=function($J,$h,$f,$n){return 0==$J?$h:$f*Math.pow(2,10*($J/$n-1))+$h-.001*$f;},$u.expoInOut=function($J,$h,$f,$n){return 0==$J?$h:$J==$n?$h+$f:($J/=.5*$n)<1?.5*$f*Math.pow(2,10*($J-1))+$h:.5*$f*(2-Math.pow(2,-10*--$J))+$h;},$u.expoOut=function($J,$h,$f,$n){return $J==$n?$h+$f:$f*(1-Math.pow(2,-10*$J/$n))+$h;},$u.circIn=function($J,$h,$f,$n){return-$f*(Math.sqrt(1-($J/=$n)*$J)-1)+$h;},$u.circInOut=function($J,$h,$f,$n){return($J/=.5*$n)<1?.5*-$f*(Math.sqrt(1-$J*$J)-1)+$h:.5*$f*(Math.sqrt(1-($J-=2)*$J)+1)+$h;},$u.circOut=function($J,$h,$f,$n){return $f*Math.sqrt(1-($J=$J/$n-1)*$J)+$h;},$u.HALF_PI=.5*Math.PI,$u.PI2=2*Math.PI,$u;}(),$v=function(){function $j(){this._hit=null,this._unHit=null;}$q($j,"laya.utils.HitArea");var $J=$j.prototype;return $J.isHit=function($J,$h){return!!$j.isHitGraphic($J,$h,this.hit)&&!$j.isHitGraphic($J,$h,this.unHit);},$J.contains=function($J,$h){return this.isHit($J,$h);},$x(0,$J,"hit",function(){return this._hit||(this._hit=new $R()),this._hit;},function($J){this._hit=$J;}),$x(0,$J,"unHit",function(){return this._unHit||(this._unHit=new $R()),this._unHit;},function($J){this._unHit=$J;}),$j.isHitGraphic=function($J,$h,$f){if(!$f)return!1;var $n;if(!($n=$f.cmds)&&$f._one&&(($n=$j._cmds).length=1,$n[0]=$f._one),!$n)return!1;var $L,$T,$k=0;for($L=$n.length,$k=0;$k<$L;$k++)if($T=$n[$k]){var $u=$I._context;switch($T.callee){case $u._translate:case 6:$J-=$T[0],$h-=$T[1];}if($j.isHitCmd($J,$h,$T))return!0;}return!1;},$j.isHitCmd=function($J,$h,$f){if(!$f)return!1;var $n=$I._context,$L=!1;switch($f.callee){case $n._drawRect:case 13:$j._rec.setTo($f[0],$f[1],$f[2],$f[3]),$L=$j._rec.contains($J,$h);break;case $n._drawCircle:case $n._fillCircle:case 14:$L=($J-=$f[0])*$J+($h-=$f[1])*$h<$f[2]*$f[2];break;case $n._drawPoly:case 18:$J-=$f[0],$h-=$f[1],$L=$j.ptInPolygon($J,$h,$f[2]);}return $L;},$j.ptInPolygon=function($J,$h,$f){var $n;($n=$j._ptPoint).setTo($J,$h);var $L,$T=0,$k=NaN,$u=NaN,$S=NaN,$Y=NaN;$L=$f.length;for(var $x=0;$x<$L;$x+=2){if($k=$f[$x],$u=$f[$x+1],$S=$f[($x+2)%$L],$u!=($Y=$f[($x+3)%$L]))if(!($n.y<Math.min($u,$Y)))if(!($n.y>=Math.max($u,$Y)))($n.y-$u)*($S-$k)/($Y-$u)+$k>$n.x&&$T++;}return $T%2==1;},$j._cmds=[],$S($j,["_rec",function(){return this._rec=new $g();},"_ptPoint",function(){return this._ptPoint=new $D();}]),$j;}(),$$=(function(){function $L($J,$h,$f,$n){this.char=$J,this.charNum=$J.charCodeAt(0),this._x=this._y=0,this.width=$h,this.height=$f,this.style=$n,this.isWord=!$L._isWordRegExp.test($J);}$q($L,"laya.utils.HTMLChar");var $J=$L.prototype;$Q.imps($J,{"laya.display.ILayout":!0}),$J.setSprite=function($J){this._sprite=$J;},$J.getSprite=function(){return this._sprite;},$J._isChar=function(){return!0;},$J._getCSSStyle=function(){return this.style;},$x(0,$J,"width",function(){return this._w;},function($J){this._w=$J;}),$x(0,$J,"x",function(){return this._x;},function($J){this._sprite&&(this._sprite.x=$J),this._x=$J;}),$x(0,$J,"y",function(){return this._y;},function($J){this._sprite&&(this._sprite.y=$J),this._y=$J;}),$x(0,$J,"height",function(){return this._h;},function($J){this._h=$J;}),$L._isWordRegExp=new RegExp("[\\w.]","");}(),function(){function $h(){}$q($h,"laya.utils.Log"),$h.enable=function(){$h._logdiv||($h._logdiv=$a.window.document.createElement("div"),$a.window.document.body.appendChild($h._logdiv),$h._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;");},$h.toggle=function(){var $J=$h._logdiv.style;"1px"==$J.width?$J.width=$J.height="50%":$J.width=$J.height="1px";},$h.print=function($J){$h._logdiv&&($h.maxCount<=$h._count&&$h.clear(),$h._count++,$h._logdiv.innerText+=$J+"\n",$h._logdiv.scrollTop=$h._logdiv.scrollHeight);},$h.clear=function(){$h._logdiv.innerText="",$h._count=0;},$h._logdiv=null,$h._count=0,$h.maxCount=20;}(),function(){function $h(){}$q($h,"laya.utils.Mouse"),$x(1,$h,"cursor",function(){return $h._style.cursor;},function($J){$h._style.cursor=$J;}),$h.hide=function(){"none"!=$h.cursor&&($h._preCursor=$h.cursor,$h.cursor="none");},$h.show=function(){"none"==$h.cursor&&($h.cursor=$h._preCursor?$h._preCursor:"auto");},$h._preCursor=null,$S($h,["_style",function(){return this._style=$a.document.body.style;}]);}(),function(){function $T(){}return $q($T,"laya.utils.Pool"),$T.getPoolBySign=function($J){return $T._poolDic[$J]||($T._poolDic[$J]=[]);},$T.clearBySign=function($J){$T._poolDic[$J]&&($T._poolDic[$J].length=0);},$T.recover=function($J,$h){$h.__InPool||($h.__InPool=!0,$T.getPoolBySign($J).push($h));},$T.getItemByClass=function($J,$h){var $f=$T.getPoolBySign($J),$n=$f.length?$f.pop():new $h();return $n.__InPool=!1,$n;},$T.getItemByCreateFun=function($J,$h,$f){var $n=$T.getPoolBySign($J),$L=$n.length?$n.pop():$h.call($f);return $L.__InPool=!1,$L;},$T.getItem=function($J){var $h=$T.getPoolBySign($J),$f=$h.length?$h.pop():null;return $f&&($f.__InPool=!1),$f;},$T._poolDic={},$T.InPoolSign="__InPool",$T;}()),$M=function(){function $S(){}return $q($S,"laya.utils.Stat"),$x(1,$S,"onclick",null,function($J){$S._sp&&$S._sp.on("click",$S._sp,$J),$S._canvas&&($S._canvas.source.onclick=$J,$S._canvas.source.style.pointerEvents="");}),$S.show=function($J,$h,$f){if(void 0===$J&&($J=0),void 0===$h&&($h=0),void 0===$f&&($f=0),!$I.isConchApp||$I.isConchWebGL){if($I.isConchWebGL||$a.onMiniGame||$a.onLimixiu||($S._useCanvas=!0),$S._show=!0,$S._fpsData.length=60,$S._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},$S._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},$S._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},$S._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},$I.isWebGL){if($S._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},$I.is3DMode){if($S._view[0].title="FPS(3D)",$S._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},$S._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},$S._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==$f){var $n=8;$S._view[$n++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},$S._view[$n++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$S._view[$n++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},$S._view[$n++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$S._view[$n++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$S._view[$n++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$S._view[$n++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$S._view[$n++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},$S._view[$n++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1};}else if(2==$f){$n=8;$S._view[$n++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},$S._view[$n++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},$S._view[$n++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},$S._view[$n++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},$S._view[$n++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},$S._view[$n++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},$S._view[$n++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2};}}else $S._view[0].title="FPS(WebGL)",$S._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};}else $S._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};$S._useCanvas?$S.createUIPre($J,$h):$S.createUI($J,$h),$S.enable();}else $a.window.conch.showFPS&&$a.window.conch.showFPS($J,$h);},$S.createUIPre=function($J,$h){var $f=$a.pixelRatio;$S._width=170*$f,$S._vx=75*$f,$S._height=$f*(12*$S._view.length+3*$f)+4,$S._fontSize=12*$f;for(var $n=0;$n<$S._view.length;$n++)$S._view[$n].x=4,$S._view[$n].y=$n*$S._fontSize+2*$f;$S._canvas||(($S._canvas=new $sJ("2D")).size($S._width,$S._height),($S._ctx=$S._canvas.getContext("2d")).textBaseline="top",$S._ctx.font=$S._fontSize+"px Sans-serif",$S._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+$J+"px;top:"+$h+"px;width:"+$S._width/$f+"px;height:"+$S._height/$f+"px;"),$S._first=!0,$S.loop(),$S._first=!1,$a.container.appendChild($S._canvas.source);},$S.createUI=function($J,$h){var $f=$S._sp,$n=$a.pixelRatio;$f||($f=new $jJ(),($S._leftText=new $oJ()).pos(5,5),$S._leftText.color="#ffffff",$f.addChild($S._leftText),($S._txt=new $oJ()).pos(80*$n,5),$S._txt.color="#ffffff",$f.addChild($S._txt),$S._sp=$f),$f.pos($J,$h);for(var $L="",$T=0;$T<$S._view.length;$T++){$L+=$S._view[$T].title+"\n";}$S._leftText.text=$L;var $k=170*$n,$u=$n*(12*$S._view.length+3*$n)+4;$S._txt.fontSize=$S._fontSize*$n,$S._leftText.fontSize=$S._fontSize*$n,$f.size($k,$u),$f.graphics.clear(),$f.graphics.setAlpha(.5),$f.graphics.drawRect(0,0,$k,$u,"#999999"),$f.graphics.setAlpha(1),$S.loop();},$S.enable=function(){$Q.timer.frameLoop(1,$S,$S.loop);},$S.hide=function(){$S._show=!1,$Q.timer.clear($S,$S.loop),$S._canvas&&$a.removeElement($S._canvas.source);},$S.clear=function(){$S.trianglesFaces=$S.drawCall=$S.shaderCall=$S.spriteCount=$S.spriteRenderUseCacheCount=$S.treeNodeCollision=$S.treeSpriteCollision=$S.canvasNormal=$S.canvasBitmap=$S.canvasReCache=0;},$S.loop=function(){$S._count++;var $J=$a.now();if(!($J-$S._timer<1e3)){var $h=$S._count;if($S.FPS=Math.round(1e3*$h/($J-$S._timer)),$S._show){$S.trianglesFaces=Math.round($S.trianglesFaces/$h),$S.spriteCount=$S._useCanvas?($S.drawCall=Math.round($S.drawCall/$h)-2,$S.shaderCall=Math.round($S.shaderCall/$h),Math.round($S.spriteCount/$h)-1):($S.drawCall=Math.round($S.drawCall/$h)-2,$S.shaderCall=Math.round($S.shaderCall/$h)-4,Math.round($S.spriteCount/$h)-4),$S.spriteRenderUseCacheCount=Math.round($S.spriteRenderUseCacheCount/$h),$S.canvasNormal=Math.round($S.canvasNormal/$h),$S.canvasBitmap=Math.round($S.canvasBitmap/$h),$S.canvasReCache=Math.ceil($S.canvasReCache/$h),$S.treeNodeCollision=Math.round($S.treeNodeCollision/$h),$S.treeSpriteCollision=Math.round($S.treeSpriteCollision/$h);var $f=0<$S.FPS?Math.floor(1e3/$S.FPS).toString():" ";$S._fpsStr=$S.FPS+($S.renderSlow?" slow":"")+" "+$f,$S._spriteStr=$S.spriteCount+($S.spriteRenderUseCacheCount?"/"+$S.spriteRenderUseCacheCount:""),$S._canvasStr=$S.canvasReCache+"/"+$S.canvasNormal+"/"+$S.canvasBitmap,$S.currentMemorySize=$c.systemResourceManager.memorySize,$S._useCanvas?$S.renderInfoPre():$S.renderInfo(),$S.clear();}$S._count=0,$S._timer=$J;}},$S.renderInfoPre=function(){if($S._canvas){var $J=$S._ctx;$J.clearRect($S._first?0:$S._vx,0,$S._width,$S._height);for(var $h=$I.WebGL.mainContext,$f=0;$f<$S._view.length;$f++){var $n=$S._view[$f];$S._first&&($J.fillStyle="white",$J.fillText($n.title,$n.x,$n.y,null,null,null)),$J.fillStyle=$n.color;var $L=-1;if(($n=$S._view[$f]).varying){if($h)switch($n.varying){case 1:$L=$h.getParameter($h[$n.value]);break;case 2:$L=$h.getExtension($n.value);}}else $L=$S[$n.value];"M"==$n.units&&($L=Math.floor($L/1048576*100)/100+" M"),"K"==$n.units&&($L=Math.floor($L/1024*100)/100+" K"),"string"==$n.units&&($L=$L.match(/\d+\.?\d/i)),$J.fillText($L+"",$n.x+$S._vx,$n.y,null,null,null);}}},$S.renderInfo=function(){for(var $J="",$h=$I.WebGL.mainContext,$f=0;$f<$S._view.length;$f++){var $n=$S._view[$f],$L=-1;if($n.varying){if($h)switch($n.varying){case 1:$L=$h.getParameter($h[$n.value]);break;case 2:$L=$h.getExtension($n.value);}}else $L=$S[$n.value];"M"==$n.units&&($L=Math.floor($L/1048576*100)/100+" M"),"K"==$n.units&&($L=Math.floor($L/1024*100)/100+" K"),"string"==$n.units&&($L=$L.match(/\d+\.?\d/i)),$J+=$L+"\n";}$S._txt.text=$J;},$S.FPS=0,$S.loopCount=0,$S.shaderCall=0,$S.drawCall=0,$S.trianglesFaces=0,$S.spriteCount=0,$S.spriteRenderUseCacheCount=0,$S.treeNodeCollision=0,$S.treeSpriteCollision=0,$S.canvasNormal=0,$S.canvasBitmap=0,$S.canvasReCache=0,$S.renderSlow=!1,$S.currentMemorySize=0,$S._fpsStr=null,$S._canvasStr=null,$S._spriteStr=null,$S._fpsData=[],$S._timer=0,$S._count=0,$S._view=[],$S._fontSize=12,$S._txt=null,$S._leftText=null,$S._sp=null,$S._show=!1,$S._useCanvas=!1,$S._canvas=null,$S._ctx=null,$S._first=!1,$S._vx=NaN,$S._width=0,$S._height=100,$S;}(),$X=(function(){function $J(){this._strsToID={},this._idToStrs=[],this._length=0;}$q($J,"laya.utils.StringKey");var $h=$J.prototype;$h.add=function($J){var $h=this._strsToID[$J];return null!=$h?$h:(this._idToStrs[this._length]=$J,this._strsToID[$J]=this._length++);},$h.getID=function($J){var $h=this._strsToID[$J];return null==$h?-1:$h;},$h.getName=function($J){var $h=this._idToStrs[$J];return null==$h?void 0:$h;};}(),function(){var $Y;function $J(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init();}$q($J,"laya.utils.Timer");var $h=$J.prototype;return $h._init=function(){$Q.timer&&$Q.timer.frameLoop(1,this,this._update);},$h._now=function(){return Date.now();},$h._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var $J=this.currFrame=this.currFrame+this.scale,$h=this._now();this._delta=($h-this._lastTimer)*this.scale;var $f=this.currTimer=this.currTimer+this._delta;$Q.isDebug&&6e4<Math.abs($h-this._lastTimer)&&console.error("系统时间错误！"+($h-this._lastTimer)),this._lastTimer=$h;var $n=this._handlers;for($k=this._count=0,$u=$n.length;$k<$u;$k++)if(null!==($S=$n[$k]).method){var $L=$S.userFrame?$J:$f;if($L>=$S.exeTime)if($S.repeat){if($S.jumpFrame)for(;$L>=$S.exeTime;)$S.exeTime+=$S.delay,$S.run(!1);else $S.exeTime+=$S.delay,$S.run(!1),$L>$S.exeTime&&($S.exeTime+=Math.ceil(($L-$S.exeTime)/$S.delay)*$S.delay);}else $S.run(!0);}else this._count++;(30<this._count||$J%200==0)&&this._clearHandlers();for(var $T=this._laters,$k=0,$u=$T.length-1;$k<=$u;$k++){var $S=$T[$k];this._isIgnoreRecover($S)||(null!==$S.method&&(delete this._map[$S.key],$S.run(!1)),this._recoverHandler($S)),$k===$u&&($u=$T.length-1);}$T.length=0;}},$h._clearHandlers=function(){for(var $J=this._handlers,$h=0,$f=$J.length;$h<$f;$h++){var $n=$J[$h];null!==$n.method?this._temp.push($n):this._isIgnoreRecover($n)?this._temp.push($n):this._recoverHandler($n);}this._handlers=this._temp,this._temp=$J,this._temp.length=0;},$h._recoverHandler=function($J){this._map[$J.key]==$J&&delete this._map[$J.key],$J.recover();},$h._create=function($J,$h,$f,$n,$L,$T,$k,$u){if(!$f)return $L.apply($n,$T),null;if($k){var $S=this._getHandler($n,$L);if($S)return $S.repeat=$h,$S.userFrame=$J,$S.delay=$f,$S.ignoreRecover=$u,$S.caller=$n,$S.method=$L,$S.args=$T,$S.exeTime=$f+($J?this.currFrame:this.currTimer+this._now()-this._lastTimer),$S;}return($S=$Y.create()).repeat=$h,$S.userFrame=$J,$S.delay=$f,$S.ignoreRecover=$u,$S.caller=$n,$S.method=$L,$S.args=$T,$S.exeTime=$f+($J?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler($S),this._handlers.push($S),$S;},$h._indexHandler=function($J){var $h=$J.caller,$f=$J.method,$n=$h?$h.$_GID||($h.$_GID=$E.getGID()):0,$L=$f.$_TID||($f.$_TID=this._mid++);$J.key=$n+"_"+$L,this._map[$J.key]=$J;},$h.once=function($J,$h,$f,$n,$L){void 0===$L&&($L=!0),this._create(!1,!1,$J,$h,$f,$n,$L,!1);},$h.loop=function($J,$h,$f,$n,$L,$T,$k){void 0===$L&&($L=!0),void 0===$T&&($T=!1),void 0===$k&&($k=!1);var $u=this._create(!1,!0,$J,$h,$f,$n,$L,$k);$u&&($u.jumpFrame=$T);},$h.frameOnce=function($J,$h,$f,$n,$L){void 0===$L&&($L=!0),this._create(!0,!1,$J,$h,$f,$n,$L,!1);},$h.frameLoop=function($J,$h,$f,$n,$L,$T){void 0===$L&&($L=!0),void 0===$T&&($T=!1),this._create(!0,!0,$J,$h,$f,$n,$L,$T);},$h.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+$Y._freeCount;},$h.clear=function($J,$h){var $f=this._getHandler($J,$h);return!(!$f||this._isIgnoreRecover($f))&&(delete this._map[$f.key],$f.key=null,$f.clear(),!0);},$h.clearAll=function($J){if($J)for(var $h=0,$f=this._handlers.length;$h<$f;$h++){var $n=this._handlers[$h];$n.caller===$J&&(this._isIgnoreRecover($n)||(delete this._map[$n.key],$n.key=null,$n.clear()));}},$h._getHandler=function($J,$h){var $f=$J?$J.$_GID||($J.$_GID=$E.getGID()):0,$n=$h.$_TID||($h.$_TID=this._mid++);return this._map[$f+"_"+$n];},$h._isIgnoreRecover=function($J){if($J.ignoreRecover||$J.caller&&"IgnoreRecover"==$J.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var $h="";try{arguments.propertyIsEnumerable.caller;}catch($J){$h=$J.stack;}$Q.recordError("报错：核心定时器销毁忽略  "+$h);}return!0;}return!1;},$h.hasHandler=function($J,$h){return this._map[$J.$_GID+"_"+$h.$_TID];},$h.callLater=function($J,$h,$f){if(null==this._getHandler($J,$h)){var $n=$Y.create();$n.caller=$J,$n.method=$h,$n.args=$f,this._indexHandler($n),this._laters.push($n);}},$h.runCallLater=function($J,$h){var $f=this._getHandler($J,$h);$f&&null!=$f.method&&(this._isIgnoreRecover($f)||(delete this._map[$f.key],$f.run(!0)));},$h.runTimer=function($J,$h){this.runCallLater($J,$h);},$x(0,$h,"delta",function(){return this._delta;}),$J.__init$=function(){$Y=function(){function $h(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1;}$q($h,"");var $J=$h.prototype;return $J.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1;},$J.recover=function(){this.clear(),this.args=$h._freeHandler,$h._freeHandler=this,$h._freeCount++;},$J.run=function($J){var $h=this.caller;if($h&&$h.destroyed)return this.clear();var $f=this.method,$n=this.args;$J&&this.clear(),null!=$f&&($n?$f.apply($h,$n):$f.call($h));},$h._freeHandler=null,$h._freeCount=0,$h.create=function(){var $J=$h._freeHandler;return $J?($h._freeHandler=$J.args,--$h._freeCount,$J.args=null,$J):new $h();},$h;}();},$J;}()),$w=function(){function $j(){this.gid=0;}$q($j,"laya.utils.Tween");var $J=$j.prototype;return $J.to=function($J,$h,$f,$n,$L,$T,$k){return void 0===$T&&($T=0),void 0===$k&&($k=!1),this._create($J,$h,$f,$n,$L,$T,$k,!0,!1,!0);},$J.from=function($J,$h,$f,$n,$L,$T,$k){return void 0===$T&&($T=0),void 0===$k&&($k=!1),this._create($J,$h,$f,$n,$L,$T,$k,!1,!1,!0);},$J._create=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){if(!$J)throw new Error("Tween:target is null");this._target=$J,this._duration=$f,this._ease=$n||$h.ease||$j.easeNone,this._complete=$L||$h.complete,this._delay=$T,this._props=[],this._usedTimer=0,this._startTimer=$a.now(),this._usedPool=$S,this._delayParam=null,this.update=$h.update;var $x=$J.$_GID||($J.$_GID=$E.getGID());return $j.tweenMap[$x]?($k&&$j.clearTween($J),$j.tweenMap[$x].push(this)):$j.tweenMap[$x]=[this],$Y?$T<=0?this.firstStart($J,$h,$u):(this._delayParam=[$J,$h,$u],$Q.scaleTimer.once($T,this,this.firstStart,this._delayParam)):this._initProps($J,$h,$u),this;},$J.firstStart=function($J,$h,$f){this._delayParam=null,$J.destroyed?this.clear():(this._initProps($J,$h,$f),this._beginLoop());},$J._initProps=function($J,$h,$f){for(var $n in $h)if("number"==typeof $J[$n]){var $L=$f?$J[$n]:$h[$n],$T=$f?$h[$n]:$J[$n];this._props.push([$n,$L,$T-$L]),$f||($J[$n]=$L);}},$J._beginLoop=function(){$Q.scaleTimer.frameLoop(1,this,this._doEase);},$J._doEase=function(){this._updateEase($a.now());},$J._updateEase=function($J){var $h=this._target;if($h){if($h.destroyed)return $j.clearTween($h);var $f=this._usedTimer=$J-this._startTimer-this._delay;if(!($f<0)){if($f>=this._duration)return this.complete();for(var $n=0<$f?this._ease($f,0,1,this._duration):0,$L=this._props,$T=0,$k=$L.length;$T<$k;$T++){var $u=$L[$T];$h[$u[0]]=$u[1]+$n*$u[2];}this.update&&this.update.run();}}},$J.complete=function(){if(this._target){$Q.scaleTimer.runTimer(this,this.firstStart);for(var $J=this._target,$h=this._props,$f=this._complete,$n=0,$L=$h.length;$n<$L;$n++){var $T=$h[$n];$J[$T[0]]=$T[1]+$T[2];}this.update&&this.update.run(),this.clear(),$f&&$f.run();}},$J.pause=function(){$Q.scaleTimer.clear(this,this._beginLoop),$Q.scaleTimer.clear(this,this._doEase),$Q.scaleTimer.clear(this,this.firstStart);var $J;($J=$a.now()-this._startTimer-this._delay)<0&&(this._usedTimer=$J);},$J.setStartTime=function($J){this._startTimer=$J;},$J.clear=function(){this._target&&(this._remove(),this._clear());},$J._clear=function(){this.pause(),$Q.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,$$.recover("tween",this));},$J.recover=function(){this._usedPool=!0,this._clear();},$J._remove=function(){var $J=$j.tweenMap[this._target.$_GID];if($J)for(var $h=0,$f=$J.length;$h<$f;$h++)if($J[$h]===this){$J.splice($h,1);break;}},$J.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=$a.now(),this._delayParam)$Q.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var $J=this._props,$h=0,$f=$J.length;$h<$f;$h++){var $n=$J[$h];this._target[$n[0]]=$n[1];}$Q.scaleTimer.once(this._delay,this,this._beginLoop);}},$J.resume=function(){this._usedTimer>=this._duration||(this._startTimer=$a.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?$Q.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop());},$x(0,$J,"progress",null,function($J){var $h=$J*this._duration;this._startTimer=$a.now()-this._delay-$h;}),$j.to=function($J,$h,$f,$n,$L,$T,$k,$u){return void 0===$T&&($T=0),void 0===$k&&($k=!1),void 0===$u&&($u=!0),$$.getItemByClass("tween",$j)._create($J,$h,$f,$n,$L,$T,$k,!0,$u,!0);},$j.from=function($J,$h,$f,$n,$L,$T,$k,$u){return void 0===$T&&($T=0),void 0===$k&&($k=!1),void 0===$u&&($u=!0),$$.getItemByClass("tween",$j)._create($J,$h,$f,$n,$L,$T,$k,!1,$u,!0);},$j.clearAll=function($J){if($J&&$J.$_GID){var $h=$j.tweenMap[$J.$_GID];if($h){for(var $f=0,$n=$h.length;$f<$n;$f++)$h[$f]._clear();$h.length=0;}}},$j.clear=function($J){$J.clear();},$j.clearTween=function($J){$j.clearAll($J);},$j.easeNone=function($J,$h,$f,$n){return $f*$J/$n+$h;},$j.tweenMap={},$j;}(),$E=function(){function $u(){}return $q($u,"laya.utils.Utils"),$u.toRadian=function($J){return $J*$u._pi2;},$u.toAngle=function($J){return $J*$u._pi;},$u.toHexColor=function($J){if($J<0||isNaN($J))return null;for(var $h=$J.toString(16);$h.length<6;)$h="0"+$h;return"#"+$h;},$u.getGID=function(){return $u._gid++;},$u.concatArray=function($J,$h){if(!$h)return $J;if(!$J)return $h;var $f=0,$n=$h.length;for($f=0;$f<$n;$f++)$J.push($h[$f]);return $J;},$u.clearArray=function($J){return $J&&($J.length=0),$J;},$u.copyArray=function($J,$h){if($J||($J=[]),!$h)return $J;$J.length=$h.length;var $f=0,$n=$h.length;for($f=0;$f<$n;$f++)$J[$f]=$h[$f];return $J;},$u.getGlobalRecByPoints=function($J,$h,$f,$n,$L){var $T,$k;return $T=new $D($h,$f),$T=$J.localToGlobal($T),$k=new $D($n,$L),$k=$J.localToGlobal($k),$g._getWrapRec([$T.x,$T.y,$k.x,$k.y]);},$u.getGlobalPosAndScale=function($J){return $u.getGlobalRecByPoints($J,0,0,1,1);},$u.bind=function($J,$h){return $J.bind($h);},$u.measureText=function($J,$h){return $y.measureText($J,$h);},$u.contextMeasureText=function($J){var $h=$a.context.measureText($J);return $h||($h={width:16,height:16}),$h;},$u.updateOrder=function($J){if(!$J||$J.length<2)return!1;for(var $h,$f=1,$n=0,$L=$J.length,$T=NaN;$f<$L;){for($h=$J[$n=$f],$T=$J[$n]._zOrder;-1<--$n&&$J[$n]._zOrder>$T;)$J[$n+1]=$J[$n];$J[$n+1]=$h,$f++;}var $k=$h.parent.conchModel;if($k)if(null!=$k.updateZOrder)$k.updateZOrder();else{for($f=0;$f<$L;$f++)$k.removeChild($J[$f].conchModel);for($f=0;$f<$L;$f++)$k.addChildAt($J[$f].conchModel,$f);}return!0;},$u.transPointList=function($J,$h,$f){var $n=0,$L=$J.length;for($n=0;$n<$L;$n+=2)$J[$n]+=$h,$J[$n+1]+=$f;},$u.parseInt=function($J,$h){void 0===$h&&($h=0);var $f=$a.window.parseInt($J,$h);return isNaN($f)?0:$f;},$u.getFileExtension=function($J){$u._extReg.lastIndex=$J.lastIndexOf(".");var $h=$u._extReg.exec($J);return $h&&1<$h.length?$h[1].toLowerCase():null;},$u.getTransformRelativeToWindow=function($J,$h,$f){var $n=$Q.stage,$L=laya.utils.Utils.getGlobalPosAndScale($J),$T=$n._canvasTransform.clone(),$k=$T.tx,$u=$T.ty;$T.rotate(-Math.PI/180*$Q.stage.canvasDegree),$T.scale($Q.stage.clientScaleX,$Q.stage.clientScaleY);var $S=$Q.stage.canvasDegree%180!=0,$Y=NaN,$x=NaN;$S?($Y=$f+$L.y,$x=$h+$L.x,$Y*=$T.d,$x*=$T.a,90==$Q.stage.canvasDegree?($Y=$k-$Y,$x+=$u):($Y+=$k,$x=$u-$x)):($Y=$h+$L.x,$x=$f+$L.y,$Y*=$T.a,$x*=$T.d,$Y+=$k,$x+=$u);var $j=NaN,$R=NaN;return $R=$S?($j=$T.d*$L.height,$T.a*$L.width):($j=$T.a*$L.width,$T.d*$L.height),{x:$Y,y:$x,scaleX:$j,scaleY:$R};},$u.fitDOMElementInArea=function($J,$h,$f,$n,$L,$T){$J._fitLayaAirInitialized||($J._fitLayaAirInitialized=!0,$J.style.transformOrigin=$J.style.webKittransformOrigin="left top",$J.style.position="absolute");var $k=$u.getTransformRelativeToWindow($h,$f,$n);$J.style.transform=$J.style.webkitTransform="scale("+$k.scaleX+","+$k.scaleY+") rotate("+$Q.stage.canvasDegree+"deg)",$J.style.width=$L+"px",$J.style.height=$T+"px",$J.style.left=$k.x+"px",$J.style.top=$k.y+"px";},$u.isOkTextureList=function($J){if(!$J)return!1;var $h,$f=0,$n=$J.length;for($f=0;$f<$n;$f++)if(!($h=$J[$f])||!$h.source)return!1;return!0;},$u.isOKCmdList=function($J){if(!$J)return!1;var $h,$f,$n=0,$L=$J.length,$T=$I._context;for($n=0;$n<$L;$n++)switch(($h=$J[$n]).callee){case $T._drawTexture:case $T._fillTexture:case $T._drawTextureWithTransform:if(!($f=$h[0])||!$f.source)return!1;}return!0;},$u._gid=1,$u._pi=180/Math.PI,$u._pi2=Math.PI/180,$u._extReg=/\.(\w+)\??/g,$u.parseXMLFromString=function($J){var $h;if($J=$J.replace(/>\s+</g,"><"),-1<($h=new DOMParser().parseFromString($J,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error($h.firstChild.firstChild.textContent);return $h;},$u;}(),$N=function(){function $J(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],$I.isWebGL&&$V.regCacheByFunction($E.bind(this.startDispose,this),$E.bind(this.getCacheList,this));}$q($J,"laya.utils.VectorGraphManager");var $h=$J.prototype;return $h.getId=function(){return this._id++;},$h.addShape=function($J,$h){this.shapeDic[$J]=$h,this.useDic[$J]||(this.useDic[$J]=!0);},$h.addLine=function($J,$h){this.shapeLineDic[$J]=$h,this.shapeLineDic[$J]||(this.shapeLineDic[$J]=!0);},$h.getShape=function($J){this._checkKey&&null!=this.useDic[$J]&&(this.useDic[$J]=!0);},$h.deleteShape=function($J){this.shapeDic[$J]&&(this.shapeDic[$J]=null,delete this.shapeDic[$J]),this.shapeLineDic[$J]&&(this.shapeLineDic[$J]=null,delete this.shapeLineDic[$J]),null!=this.useDic[$J]&&delete this.useDic[$J];},$h.getCacheList=function(){var $J,$h=[];for($J in this.shapeDic)$h.push(this.shapeDic[$J]);for($J in this.shapeLineDic)$h.push(this.shapeLineDic[$J]);return $h;},$h.startDispose=function($J){var $h;for($h in this.useDic)this.useDic[$h]=!1;this._checkKey=!0;},$h.endDispose=function(){if(this._checkKey){var $J;for($J in this.useDic)this.useDic[$J]||this.deleteShape($J);this._checkKey=!1;}},$J.getInstance=function(){return $J.instance=$J.instance||new $J();},$J.instance=null,$J;}(),$z=function(){function $n(){this._obj=null,this._obj=$n.supportWeakMap?new $a.window.WeakMap():{},$n.supportWeakMap||$n._maps.push(this);}$q($n,"laya.utils.WeakObject");var $J=$n.prototype;return $J.set=function($J,$h){if(null!=$J)if($n.supportWeakMap){var $f=$J;"string"!=typeof $J&&"number"!=typeof $J||($f=$n._keys[$J])||($f=$n._keys[$J]={k:$J}),this._obj.set($f,$h);}else"string"==typeof $J||"number"==typeof $J?this._obj[$J]=$h:($J.$_GID||($J.$_GID=$E.getGID()),this._obj[$J.$_GID]=$h);},$J.get=function($J){if(null==$J)return null;if($n.supportWeakMap){var $h="string"==typeof $J||"number"==typeof $J?$n._keys[$J]:$J;return $h?this._obj.get($h):null;}return"string"==typeof $J||"number"==typeof $J?this._obj[$J]:this._obj[$J.$_GID];},$J.del=function($J){if(null!=$J)if($n.supportWeakMap){var $h="string"==typeof $J||"number"==typeof $J?$n._keys[$J]:$J;if(!$h)return;this._obj.delete($h);}else"string"==typeof $J||"number"==typeof $J?delete this._obj[$J]:delete this._obj[this._obj.$_GID];},$J.has=function($J){if(null==$J)return!1;if($n.supportWeakMap){var $h="string"==typeof $J||"number"==typeof $J?$n._keys[$J]:$J;return this._obj.has($h);}return"string"==typeof $J||"number"==typeof $J?null!=this._obj[$J]:null!=this._obj[this._obj.$_GID];},$n.__init__=function(){($n.supportWeakMap=null!=$a.window.WeakMap)||$Q.timer.loop($n.delInterval,null,$n.clearCache);},$n.clearCache=function(){for(var $J=0,$h=$n._maps.length;$J<$h;$J++){$n._maps[$J]._obj={};}},$n.supportWeakMap=!1,$n.delInterval=3e5,$n._keys={},$n._maps=[],$S($n,["I",function(){return this.I=new $n();}]),$n;}(),$K=function(){function $J(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null;}$q($J,"laya.utils.WordText");var $h=$J.prototype;return $h.setText=function($J){this.changed=!0,this._text=$J;},$h.toString=function(){return this._text;},$h.charCodeAt=function($J){return this._text?this._text.charCodeAt($J):NaN;},$h.charAt=function($J){return this._text?this._text.charAt($J):null;},$x(0,$h,"length",function(){return this._text?this._text.length:0;}),$J;}(),$JJ=function($J){function $k(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,$k.__super.call(this),this._childs=$k.ARRAY_EMPTY,this._$P=$k.PROP_EMPTY,this.timer=$Q.scaleTimer,this.conchModel=$I.isConchNode?this.createConchModel():null;}$q($k,"laya.display.Node",$Y);var $h=$k.prototype;return $h._setBit=function($J,$h){1==$J&&this._getBit($J)!=$h&&this._updateDisplayedInstage();$h?this._bits|=$J:this._bits&=~$J;},$h._getBit=function($J){return 0!=(this._bits&$J);},$h._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1);},$h._setUpNoticeType=function($J){var $h=this;for($h._setBit($J,!0),$h=$h.parent;$h;){if($h._getBit($J))return;$h._setBit($J,!0),$h=$h.parent;}},$h.on=function($J,$h,$f,$n){return"display"!==$J&&"undisplay"!==$J||this._getBit(1)||this._setUpNoticeType(1),this._createListener($J,$h,$f,$n,!1);},$h.once=function($J,$h,$f,$n){return"display"!==$J&&"undisplay"!==$J||this._getBit(1)||this._setUpNoticeType(1),this._createListener($J,$h,$f,$n,!0);},$h.createConchModel=function(){return null;},$h.destroy=function($J){void 0===$J&&($J=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&($J?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this);},$h.destroyChildren=function(){if(this._childs)for(var $J=this._childs.length-1;-1<$J;$J--)this._childs[$J].destroy(!0);},$h.addChild=function($J){if(!$J||this.destroyed||$J===this)return $J;if($J.zOrder&&this._set$P("hasZorder",!0),$J._parent===this){var $h=this.getChildIndex($J);$h!==this._childs.length-1&&(this._childs.splice($h,1),this._childs.push($J),this.conchModel&&(this.conchModel.removeChild($J.conchModel),this.conchModel.addChildAt($J.conchModel,this._childs.length-1)),this._childChanged());}else $J.parent&&$J.parent.removeChild($J),this._childs===$k.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($J),this.conchModel&&this.conchModel.addChildAt($J.conchModel,this._childs.length-1),($J.parent=this)._childChanged();return $J;},$h.addChildren=function($J){for(var $h=arguments,$f=0,$n=$h.length;$f<$n;)this.addChild($h[$f++]);},$h.addChildAt=function($J,$h){if(!$J||this.destroyed||$J===this)return $J;if($J.zOrder&&this._set$P("hasZorder",!0),0<=$h&&$h<=this._childs.length){if($J._parent===this){var $f=this.getChildIndex($J);this._childs.splice($f,1),this._childs.splice($h,0,$J),this.conchModel&&(this.conchModel.removeChild($J.conchModel),this.conchModel.addChildAt($J.conchModel,$h)),this._childChanged();}else $J.parent&&$J.parent.removeChild($J),this._childs===$k.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($h,0,$J),this.conchModel&&this.conchModel.addChildAt($J.conchModel,$h),$J.parent=this;return $J;}throw new Error("appendChildAt:The index is out of bounds");},$h.getChildIndex=function($J){return this._childs.indexOf($J);},$h.getChildByName=function($J){var $h=this._childs;if($h)for(var $f=0,$n=$h.length;$f<$n;$f++){var $L=$h[$f];if($L.name===$J)return $L;}return null;},$h._get$P=function($J){return this._$P[$J];},$h._set$P=function($J,$h){return this.destroyed||(this._$P===$k.PROP_EMPTY&&(this._$P={}),this._$P[$J]=$h),$h;},$h.getChildAt=function($J){return this._childs[$J];},$h.setChildIndex=function($J,$h){var $f=this._childs;if($h<0||$h>=$f.length)throw new Error("setChildIndex:The index is out of bounds.");var $n=this.getChildIndex($J);if($n<0)throw new Error("setChildIndex:node is must child of this object.");return $f.splice($n,1),$f.splice($h,0,$J),this.conchModel&&(this.conchModel.removeChild($J.conchModel),this.conchModel.addChildAt($J.conchModel,$h)),this._childChanged(),$J;},$h._childChanged=function($J){},$h.removeChild=function($J){if(!this._childs)return $J;var $h=this._childs.indexOf($J);return this.removeChildAt($h);},$h.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this;},$h.removeChildByName=function($J){var $h=this.getChildByName($J);return $h&&this.removeChild($h),$h;},$h.removeChildAt=function($J){var $h=this.getChildAt($J);if($h){for(var $f=this._childs.length-1,$n=$J;$n<$f;++$n)this._childs[$n]=this._childs[$n+1];this._childs.length=$f,this.conchModel&&this.conchModel.removeChild($h.conchModel),$h.parent=null;}return $h;},$h.removeChildren=function($J,$h){if(void 0===$J&&($J=0),void 0===$h&&($h=2147483647),this._childs&&0<this._childs.length){var $f=this._childs;if(0===$J&&$T<=$h){var $n=$f;this._childs=$k.ARRAY_EMPTY;}else $n=$f.splice($J,$h-$J);for(var $L=0,$T=$n.length;$L<$T;$L++)$n[$L].parent=null,this.conchModel&&this.conchModel.removeChild($n[$L].conchModel);}return this;},$h.replaceChild=function($J,$h){var $f=this._childs.indexOf($h);return-1<$f?(this._childs.splice($f,1,$J),this.conchModel&&(this.conchModel.removeChild($h.conchModel),this.conchModel.addChildAt($J.conchModel,$f)),$h.parent=null,$J.parent=this,$J):null;},$h._updateDisplayedInstage=function(){var $J;$J=this;var $h=$Q.stage;for(this._displayedInStage=!1;$J;){if($J._getBit(1)){this._displayedInStage=$J._displayedInStage;break;}if($J==$h||$J._displayedInStage){this._displayedInStage=!0;break;}$J=$J.parent;}},$h._setDisplay=function($J){this._displayedInStage!==$J&&((this._displayedInStage=$J)?this.event("display"):this.event("undisplay"));},$h._displayChild=function($J,$h){var $f=$J._childs;if($f)for(var $n=0;$n<$f.length;$n++){var $L=$f[$n];$L&&$L._getBit(1)&&(0<$L._childs.length?this._displayChild($L,$h):$L._setDisplay($h));}$J._setDisplay($h);},$h.contains=function($J){if($J===this)return!0;for(;$J;){if($J.parent===this)return!0;$J=$J.parent;}return!1;},$h.timerLoop=function($J,$h,$f,$n,$L,$T){void 0===$L&&($L=!0),void 0===$T&&($T=!1),this.timer.loop($J,$h,$f,$n,$L,$T);},$h.timerOnce=function($J,$h,$f,$n,$L){void 0===$L&&($L=!0),this.timer._create(!1,!1,$J,$h,$f,$n,$L);},$h.frameLoop=function($J,$h,$f,$n,$L){void 0===$L&&($L=!0),this.timer._create(!0,!0,$J,$h,$f,$n,$L);},$h.frameOnce=function($J,$h,$f,$n,$L){void 0===$L&&($L=!0),this.timer._create(!0,!1,$J,$h,$f,$n,$L);},$h.clearTimer=function($J,$h){this.timer.clear($J,$h);},$x(0,$h,"numChildren",function(){return this._childs.length;}),$x(0,$h,"destroyed",function(){return this._destroyed;}),$x(0,$h,"parent",function(){return this._parent;},function($J){this._parent!==$J&&($J?(this._parent=$J,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),$J.displayedInStage&&this._displayChild(this,!0)),$J._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=$J));}),$x(0,$h,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage;}),$k.ARRAY_EMPTY=[],$k.PROP_EMPTY={},$k.NOTICE_DISPLAY=1,$k.MOUSEENABLE=2,$k;}(),$hJ=function($J){function $R($J){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,$R.__super.call(this),this._padding=$R._PADDING,this._spacing=$R._SPACING,this._aligns=$R._ALIGNS,this._font=$l.EMPTY,this._ower=$J;}$q($R,"laya.display.css.CSSStyle",$J);var $h=$R.prototype;return $h.destroy=function(){this._ower=null,this._font=null,this._rect=null;},$h.inherit=function($J){this._font=$J._font,this._spacing=$J._spacing===$R._SPACING?$R._SPACING:$J._spacing.slice(),this.lineHeight=$J.lineHeight;},$h._widthAuto=function(){return 0!=(262144&this._type);},$h.widthed=function($J){return 0!=(8&this._type);},$h._calculation=function($J,$h){if($h.indexOf("%")<0)return!1;var $n=this._ower,$L=$n.parent,$T=this._rect;function $k($J,$h,$f){return $J*$f[0]+$h*$f[1]+$f[2];}function $f($J){var $h=$L.width,$f=$n.width;$T.width&&($n.width=$k($h,$f,$T.width)),$T.height&&($n.height=$k($h,$f,$T.height)),$T.left&&($n.x=$k($h,$f,$T.left)),$T.top&&($n.y=$k($h,$f,$T.top));}null===$T&&($L._getCSSStyle()._type|=524288,$L.on("resize",this,$f),this._rect=$T={input:{}});var $u=$h.split(" ");return $u[0]=parseFloat($u[0])/100,1==$u.length?$u[1]=$u[2]=0:($u[1]=parseFloat($u[1])/100,$u[2]=parseFloat($u[2])),$T[$J]=$u,$T.input[$J]=$h,$f(),!0;},$h.heighted=function($J){return 0!=(8192&this._type);},$h.size=function($J,$h){var $f=this._ower,$n=!1;-1!==$J&&$J!=this._ower.width&&(this._type|=8,this._ower.width=$J,$n=!0),-1!==$h&&$h!=this._ower.height&&(this._type|=8192,this._ower.height=$h,$n=!0),$n&&($f._layoutLater(),524288&this._type&&$f.event("resize",this));},$h._getAlign=function(){return this._aligns[0];},$h._getValign=function(){return this._aligns[1];},$h._getCssFloat=function(){return 0!=(32768&this._type)?32768:0;},$h._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new $l(this._font));},$h.render=function($J,$h,$f,$n){var $L=$J.width,$T=$J.height;$f-=$J.pivotX,$n-=$J.pivotY,this._bgground&&null!=this._bgground.color&&$h.ctx.fillRect($f,$n,$L,$T,this._bgground.color),this._border&&this._border.color&&$h.drawRect($f,$n,$L,$T,this._border.color.strColor,this._border.size);},$h.getCSSStyle=function(){return this;},$h.cssText=function($J){this.attrs($R.parseOneCSS($J,";"));},$h.attrs=function($J){if($J)for(var $h=0,$f=$J.length;$h<$f;$h++){var $n=$J[$h];this[$n[0]]=$n[1];}},$h.setTransform=function($J){"none"===$J?this._tf=$u._TF_EMPTY:this.attrs($R.parseOneCSS($J,","));},$h.translate=function($J,$h){this._tf===$u._TF_EMPTY&&(this._tf=new $L()),this._tf.translateX=$J,this._tf.translateY=$h;},$h.scale=function($J,$h){this._tf===$u._TF_EMPTY&&(this._tf=new $L()),this._tf.scaleX=$J,this._tf.scaleY=$h;},$h._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type);},$x(0,$h,"block",$J.prototype._$get_block,function($J){$J?this._type|=1:this._type&=-2;}),$x(0,$h,"valign",function(){return $R._valigndef[this._aligns[1]];},function($J){this._aligns===$R._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=$R._valigndef[$J];}),$x(0,$h,"height",null,function($J){if(this._type|=8192,"string"==typeof $J){if(this._calculation("height",$J))return;$J=parseInt($J);}this.size(-1,$J);}),$x(0,$h,"width",null,function($J){if(this._type|=8,"string"==typeof $J){var $h=$J.indexOf("auto");if(0<=$h&&(this._type|=262144,$J=$J.substr(0,$h)),this._calculation("width",$J))return;$J=parseInt($J);}this.size($J,-1);}),$x(0,$h,"fontWeight",function(){return this._font.weight;},function($J){this._createFont().weight=$J;}),$x(0,$h,"left",null,function($J){var $h=this._ower;if("string"==typeof $J){if("center"===$J?$J="50% -50% 0":"right"===$J&&($J="100% -100% 0"),this._calculation("left",$J))return;$J=parseInt($J);}$h.x=$J;}),$x(0,$h,"_translate",null,function($J){this.translate($J[0],$J[1]);}),$x(0,$h,"absolute",function(){return 0!=(4&this._type);}),$x(0,$h,"top",null,function($J){var $h=this._ower;if("string"==typeof $J){if("middle"===$J?$J="50% -50% 0":"bottom"===$J&&($J="100% -100% 0"),this._calculation("top",$J))return;$J=parseInt($J);}$h.y=$J;}),$x(0,$h,"align",function(){return $R._aligndef[this._aligns[0]];},function($J){this._aligns===$R._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=$R._aligndef[$J];}),$x(0,$h,"bold",function(){return this._font.bold;},function($J){this._createFont().bold=$J;}),$x(0,$h,"padding",function(){return this._padding;},function($J){this._padding=$J;}),$x(0,$h,"leading",function(){return this._spacing[1];},function($J){"string"==typeof $J&&($J=parseInt($J+"")),this._spacing===$R._SPACING&&(this._spacing=[0,0]),this._spacing[1]=$J;}),$x(0,$h,"lineElement",function(){return 0!=(65536&this._type);},function($J){$J?this._type|=65536:this._type&=-65537;}),$x(0,$h,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left";},function($J){this.lineElement=!1,"right"===$J?this._type|=32768:this._type&=-32769;}),$x(0,$h,"textDecoration",function(){return this._font.decoration;},function($J){this._createFont().decoration=$J;}),$x(0,$h,"whiteSpace",function(){return 131072&this._type?"nowrap":"";},function($J){"nowrap"===$J&&(this._type|=131072),"none"===$J&&(this._type&=-131073);}),$x(0,$h,"background",null,function($J){$J?(this._bgground||(this._bgground={}),this._bgground.color=$J,this._ower.conchModel&&this._ower.conchModel.bgColor($J),this._type|=16384,this._ower._renderType|=256):this._bgground=null;}),$x(0,$h,"wordWrap",function(){return 0==(131072&this._type);},function($J){$J?this._type&=-131073:this._type|=131072;}),$x(0,$h,"color",function(){return this._font.color;},function($J){this._createFont().color=$J;}),$x(0,$h,"password",function(){return this._font.password;},function($J){this._createFont().password=$J;}),$x(0,$h,"backgroundColor",function(){return this._bgground?this._bgground.color:null;},function($J){"none"===$J?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=$J),this._ower.conchModel&&this._ower.conchModel.bgColor($J),this._ower._renderType|=256;}),$x(0,$h,"font",function(){return this._font.toString();},function($J){this._createFont().set($J);}),$x(0,$h,"weight",null,function($J){this._createFont().weight=$J;}),$x(0,$h,"letterSpacing",function(){return this._spacing[0];},function($J){"string"==typeof $J&&($J=parseInt($J+"")),this._spacing===$R._SPACING&&(this._spacing=[0,0]),this._spacing[0]=$J;}),$x(0,$h,"fontSize",function(){return this._font.size;},function($J){this._createFont().size=$J;}),$x(0,$h,"italic",function(){return this._font.italic;},function($J){this._createFont().italic=$J;}),$x(0,$h,"fontFamily",function(){return this._font.family;},function($J){this._createFont().family=$J;}),$x(0,$h,"stroke",function(){return this._font.stroke[0];},function($J){this._createFont().stroke===$l._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=$J;}),$x(0,$h,"strokeColor",function(){return this._font.stroke[1];},function($J){this._createFont().stroke===$l._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=$J;}),$x(0,$h,"border",function(){return this._border?this._border.value:"";},function($J){if("none"!=$J){this._border||(this._border={});var $h=(this._border.value=$J).split(" ");if(this._border.color=$e.create($h[$h.length-1]),1==$h.length)return this._border.size=1,void(this._border.type="solid");var $f=0;0<$h[0].indexOf("px")?(this._border.size=parseInt($h[0]),$f++):this._border.size=1,this._border.type=$h[$f],this._ower._renderType|=256;}else this._border=null;}),$x(0,$h,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null;},function($J){$J?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==$J?null:$e.create($J),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null;}),$x(0,$h,"position",function(){return 4&this._type?"absolute":"";},function($J){"absolute"==$J?this._type|=4:this._type&=-5;}),$x(0,$h,"display",null,function($J){switch($J){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater();}}),$x(0,$h,"paddingLeft",function(){return this.padding[3];}),$x(0,$h,"paddingTop",function(){return this.padding[0];}),$x(0,$h,"_scale",null,function($J){this._ower.scale($J[0],$J[1]);}),$x(0,$h,"_rotate",null,function($J){this._ower.rotation=$J;}),$R.parseOneCSS=function($J,$h){for(var $f,$n=[],$L=$J.split($h),$T=0,$k=$L.length;$T<$k;$T++){var $u=$L[$T],$S=$u.indexOf(":"),$Y=$u.substr(0,$S).replace(/^\s+|\s+$/g,"");if(0!=$Y.length){var $x=$u.substr($S+1).replace(/^\s+|\s+$/g,""),$j=[$Y,$x];switch($Y){case"italic":case"bold":$j[1]="true"==$x;break;case"line-height":$j[0]="lineHeight",$j[1]=parseInt($x);break;case"font-size":$j[0]="fontSize",$j[1]=parseInt($x);break;case"padding":1<($f=$x.split(" ")).length||($f[1]=$f[2]=$f[3]=$f[0]),$j[1]=[parseInt($f[0]),parseInt($f[1]),parseInt($f[2]),parseInt($f[3])];break;case"rotate":$j[0]="_rotate",$j[1]=parseFloat($x);break;case"scale":$f=$x.split(" "),$j[0]="_scale",$j[1]=[parseFloat($f[0]),parseFloat($f[1])];break;case"translate":$f=$x.split(" "),$j[0]="_translate",$j[1]=[parseInt($f[0]),parseInt($f[1])];break;default:($j[0]=$R._CSSTOVALUE[$Y])||($j[0]=$Y);}$n.push($j);}}return $n;},$R.parseCSS=function($J,$h){for(var $f;null!=($f=$R._parseCSSRegExp.exec($J));)$R.styleSheets[$f[1]]=$R.parseOneCSS($f[2],";");},$R.EMPTY=new $R(null),$R._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},$R._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),$R._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},$R._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},$R.styleSheets={},$R.ALIGN_CENTER=1,$R.ALIGN_RIGHT=2,$R.VALIGN_MIDDLE=1,$R.VALIGN_BOTTOM=2,$R._CSS_BLOCK=1,$R._DISPLAY_NONE=2,$R._ABSOLUTE=4,$R._WIDTH_SET=8,$R._PADDING=[0,0,0,0],$R._RECT=[-1,-1,-1,-1],$R._SPACING=[0,0],$R._ALIGNS=[0,0,0],$R.ADDLAYOUTED=512,$R._NEWFONT=4096,$R._HEIGHT_SET=8192,$R._BACKGROUND_SET=16384,$R._FLOAT_RIGHT=32768,$R._LINE_ELEMENT=65536,$R._NOWARP=131072,$R._WIDTHAUTO=262144,$R._LISTERRESZIE=524288,$R;}($u),$fJ=function($J){function $k(){this.url=null,this.audio=null,this.loaded=!1,$k.__super.call(this);}$q($k,"laya.media.h5audio.AudioSound",$Y);var $h=$k.prototype;return $h.dispose=function(){var $J=$k._audioCache[this.url];$J&&($J.src="",delete $k._audioCache[this.url]);},$h.load=function($J){var $h;if($J=$W.formatURL($J),(this.url=$J)==$G._tMusic?($k._initMusicAudio(),($h=$k._musicAudio).src!=$J&&($k._audioCache[$h.src]=null,$h=null)):$h=$k._audioCache[$J],$h&&2<=$h.readyState)this.event("complete");else{$h||($h=$J==$G._tMusic?($k._initMusicAudio(),$k._musicAudio):$a.createElement("audio"),($k._audioCache[$J]=$h).src=$J),$h.addEventListener("canplaythrough",$n),$h.addEventListener("error",$L);var $f=this;(this.audio=$h).load?$h.load():$L();}function $n(){$T(),$f.loaded=!0,$f.event("complete");}function $L(){$h.load=null,$T(),$f.event("error");}function $T(){$h.removeEventListener("canplaythrough",$n),$h.removeEventListener("error",$L);}},$h.play=function($J,$h,$f){if(void 0===$J&&($J=0),void 0===$h&&($h=0),!this.url)return null;var $n,$L;if(!($n=this.url==$G._tMusic?$k._musicAudio:$k._audioCache[this.url]))return null;$L=$$.getItem("audio:"+this.url),$I.isConchApp?$L||(($L=$a.createElement("audio")).src=this.url):this.url==$G._tMusic?($k._initMusicAudio(),($L=$k._musicAudio).src=this.url):$L=$L||$n.cloneNode(!0);var $T=new $RJ($L);return $T.url=this.url,$T.loops=$h,$T.startTime=$J,$T.startHandler=$f,$T.play(!1),$G.addChannel($T),$T;},$x(0,$h,"duration",function(){var $J;return($J=$k._audioCache[this.url])?$J.duration:0;}),$k._initMusicAudio=function(){$k._musicAudio||($k._musicAudio||($k._musicAudio=$a.createElement("audio")),$I.isConchApp||$a.document.addEventListener("mousedown",$k._makeMusicOK));},$k._makeMusicOK=function(){$a.document.removeEventListener("mousedown",$k._makeMusicOK),$k._musicAudio.src?$k._musicAudio.play():($k._musicAudio.src="",$k._musicAudio.load());},$k._audioCache={},$k._musicAudio=null,$k;}(),$nJ=function($J){function $h(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,$h.__super.call(this);}$q($h,"laya.media.SoundChannel",$Y);var $f=$h.prototype;return $f.play=function(){},$f.stop=function(){},$f.pause=function(){},$f.resume=function(){},$f.__runComplete=function($J){$J&&$J.run();},$x(0,$f,"volume",function(){return 1;},function($J){}),$x(0,$f,"position",function(){return 0;}),$x(0,$f,"duration",function(){return 0;}),$h;}(),$LJ=function($J){function $h(){$h.__super.call(this);}$q($h,"laya.media.Sound",$Y);var $f=$h.prototype;return $f.load=function($J){},$f.play=function($J,$h,$f){return void 0===$J&&($J=0),void 0===$h&&($h=0),null;},$f.dispose=function(){},$x(0,$f,"duration",function(){return 0;}),$h;}(),$TJ=function($J){function $L(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,$L.__super.call(this);}$q($L,"laya.media.webaudio.WebAudioSound",$Y);var $h=$L.prototype;return $h.load=function($J){this.url=$J,this.audioBuffer=$L._dataCache[$J],this.audioBuffer?this._loaded(this.audioBuffer):($L.e.on("loaded:"+$J,this,this._loaded),$L.e.on("err:"+$J,this,this._err),$L.__loadingSound[$J]||($L.__loadingSound[$J]=!0,$Q.loader.load($J,$_.create(this,this.onloaded),null,$uJ.BUFFER,4,!1,null,!0)));},$h.onloaded=function($J){$J||this._err(),this._disposed?this._removeLoadEvents():(this.data=$J,$L.buffs.push({buffer:this.data,url:this.url}),$L.decode());},$h._err=function(){if(this._removeLoadEvents(),$L.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var $J,$h,$f,$n=0;for($J=($h=this.__toPlays).length,$n=0;$n<$J;$n++)($f=$h[$n])[3]&&!$f[3].isStopped&&$f[3].event("error");this.__toPlays.length=0;}},$h._loaded=function($J){this._removeLoadEvents(),this._disposed||(this.audioBuffer=$J,this.loaded=!0,this.event("complete"));},$h._removeLoadEvents=function(){$L.e.off("loaded:"+this.url,this,this._loaded),$L.e.off("err:"+this.url,this,this._err);},$h.__playAfterLoaded=function(){if(this.__toPlays){var $J,$h,$f,$n=0;for($J=($h=this.__toPlays).length,$n=0;$n<$J;$n++)($f=$h[$n])[3]&&!$f[3].isStopped&&this.play($f[0],$f[1],$f[2],$f[3]);this.__toPlays.length=0;}},$h.play=function($J,$h,$f,$n){return void 0===$J&&($J=0),void 0===$h&&($h=0),$n=$n||new $lJ(),this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([$J,$h,$f,$n]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),$n.url=this.url,$n.loops=$h,$n.audioBuffer=this.audioBuffer,$n.startTime=$J,$n.startHandler=$f,$n.play(!1),$G.addChannel($n),$n;},$h.dispose=function(){this._disposed=!0,delete $L._dataCache[this.url],delete $L.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[];},$x(0,$h,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0;}),$L.decode=function(){if(!($L.buffs.length<=0||$L.isDecoding))if($L.isDecoding=!0,($L.tInfo=$L.buffs.shift())&&$L.tInfo.buffer&&$L.tInfo.buffer.byteLength)try{$L.ctx.decodeAudioData($L.tInfo.buffer,$L._done,$L._fail);}catch($J){console.error("decodeAudioData error  byteLength:"+$L.tInfo.buffer.byteLength+"  url:"+$L.tInfo.url);}else $L._fail();},$L._done=function($J){$L.e.event("loaded:"+$L.tInfo.url,$J),$L._dataCache[$L.tInfo.url]=$J,$L.isDecoding=!1,$L.decode();},$L._fail=function(){$L.e.event("err:"+$L.tInfo.url,null),$L.isDecoding=!1,$L.decode();},$L._playEmptySound=function(){if(null!=$L.ctx){if($L._emptySource&&($L._emptySource.stop(),$L._emptySource.disconnect(0),!$lJ._tryCleanFailed))try{$L._emptySource.buffer=null;}catch($J){$lJ._tryCleanFailed=!0;}var $J=$L.ctx.createBufferSource();$J.buffer=$L._miniBuffer,$J.connect($L.ctx.destination),$J.start(0,0,0),$L._emptySource=$J;}},$L._unlock=function(){$L._unlocked||($L._playEmptySound(),"running"==$L.ctx.state?($a.document.removeEventListener("mousedown",$L._unlock,!0),$a.document.removeEventListener("touchend",$L._unlock,!0),$a.document.removeEventListener("touchstart",$L._unlock,!0),$L._unlocked=!0):"suspended"==$L.ctx.state&&$G._recoverWebAudio());},$L.initWebAudio=function(){"running"!=$L.ctx.state&&($L._unlock(),$a.document.addEventListener("mousedown",$L._unlock,!0),$a.document.addEventListener("touchend",$L._unlock,!0),$a.document.addEventListener("touchstart",$L._unlock,!0));},$L._emptySource=null,$L._dataCache={},$L.buffs=[],$L.isDecoding=!1,$L._unlocked=!1,$L.tInfo=null,$L.__loadingSound={},$S($L,["window",function(){return this.window=$a.window;},"webAudioEnabled",function(){return this.webAudioEnabled=$L.window.AudioContext||$L.window.webkitAudioContext||$L.window.mozAudioContext;},"ctx",function(){return this.ctx=$L.webAudioEnabled?new($L.window.AudioContext||$L.window.webkitAudioContext||$L.window.mozAudioContext)():void 0;},"_miniBuffer",function(){return this._miniBuffer=$L.ctx.createBuffer(1,1,22050);},"e",function(){return this.e=new $Y();}]),$L;}(),$kJ=function($J){function $h(){this._responseType=null,this._data=null,$h.__super.call(this),this._http=new $a.window.XMLHttpRequest();}$q($h,"laya.net.HttpRequest",$Y);var $f=$h.prototype;return $f.send=function($J,$h,$f,$n,$L){void 0===$f&&($f="get"),void 0===$n&&($n="text"),this._responseType=$n,this._data=null;var $T=this,$k=this._http;if($k.open($f,$J,!0),$L)for(var $u=0;$u<$L.length;$u++)$k.setRequestHeader($L[$u++],$L[$u]);else $I.isConchApp||($h&&"string"!=typeof $h?$k.setRequestHeader("Content-Type","application/json"):$k.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));$k.responseType="arraybuffer"!==$n?"text":"arraybuffer",$k.onerror=function($J){$T._onError($J);},$k.onabort=function($J){$T._onAbort($J);},$k.onprogress=function($J){$T._onProgress($J);},$k.onload=function($J){$T._onLoad($J);},$k.send($h);},$f._onProgress=function($J){$J&&$J.lengthComputable&&this.event("progress",$J.loaded/$J.total);},$f._onAbort=function($J){this.error("Request was aborted by user");},$f._onError=function($J){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText);},$f._onLoad=function($J){var $h=this._http,$f=void 0!==$h.status?$h.status:200;200===$f||204===$f||0===$f?this.complete():this.error("["+$h.status+"]"+$h.statusText+":"+$h.responseURL);},$f.error=function($J){this.clear(),this.event("error",$J);},$f.complete=function(){this.clear();var $h=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=$E.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText;}catch($J){$h=!1,this.error($J.message);}$h&&this.event("complete",this._data instanceof Array?[this._data]:this._data);},$f.clear=function(){var $J=this._http;$J.onerror=$J.onabort=$J.onprogress=$J.onload=null;},$x(0,$f,"url",function(){return this._http.responseURL;}),$x(0,$f,"http",function(){return this._http;}),$x(0,$f,"data",function(){return this._data;}),$h;}(),$uJ=function($J){function $F(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,$F.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1;}$q($F,"laya.net.Loader",$Y);var $h=$F.prototype;return $h.load=function($J,$h,$f,$n,$L){if($J&&""!=$J||console.error("Loader 加载的url不合法 "+$J),void 0===$f&&($f=!0),void 0===$L&&($L=!1),0===(this._url=$J).indexOf("data:image")?this._type=$h="image":this._type=$h||($h=this.getTypeFromUrl($J)),this._cache=$f,this._data=null,!$L&&$F.loadedMap[$J])return this._data=$F.loadedMap[$J],this.event("progress",1),void this.event("complete",this._data);if($n&&$F.setGroup($J,$n),null!=$F.parserMap[$h])return this._customParse=!0,void($F.parserMap[$h]instanceof laya.utils.Handler?$F.parserMap[$h].runWith(this):$F.parserMap[$h].call(null,this));if("image"===$h||"htmlimage"===$h||"nativeimage"===$h)return this._loadImage($J);if("ttf"===$h)return this._loadTTF($J);switch($h){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:$h;}$F.preLoadedMap[$J]?this.onLoaded($F.preLoadedMap[$J]):$k.resMgrLoad($J,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime);},$h.getTypeFromUrl=function($J){var $h=$E.getFileExtension($J);return $h?$F.typeMap[$h]:(console.warn("Not recognize the resources suffix",$J),"text");},$h._loadTTF=function($J){$J=$W.formatURL($J);var $h=new $P();$h.complete=$_.create(this,this.onLoaded),$h.load($J);},$h._loadImage=function($J){$k.imgMgrLoad($J,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime);},$h._loadImageComplete=function($J,$h,$f){if(null!=$f){if($f instanceof ArrayBuffer){var $n=new DataView($f),$L=new laya.webgl.resource.WebGLImage(new Uint8Array($f,8),$J,0,!1,$n.getUint32(0),$n.getUint32(4));this.onLoaded($L);}else if($f instanceof $xJ)$F.imgMgrSet[$J]=$h,$k.imgMgrLock($J,$F.imgMgrSet[$J]),this._url=$J,this.complete($f);else{var $T=-1!=$J.indexOf(".png",$J.length-4)?6408:6407;$L=new laya.webgl.resource.WebGLImage($f,$J,$T,!1,$f.width,$f.height);this.onLoaded($L);}}else this.event("error","Load image failed");},$h.imageCancel=function($J,$h,$f){$k.imgMgrCancel($J,this._onImageCallback);},$h._loadSound=function($J){var $h=new $G._soundClass(),$f=this;function $n(){$h.offAll();}$h.on("complete",this,function(){$n(),$f.onLoaded($h);}),$h.on("error",this,function(){$n(),$h.dispose(),$f.event("error","Load sound failed");}),$h.load($J);},$h.onProgress=function($J){"atlas"===this._type?this.event("progress",.3*$J):this.event("progress",$J);},$h.onError=function($J){this.event("error",$J);},$h._loadedComplete=function($J,$h,$f){if(null!=$f)switch(this._type){case"atlas":case"plf":case"json":var $n=new $B($f);this.onLoaded(JSON.parse($n.readUTFBytes()));break;case"font":$n=new $B($f);this.onLoaded($E.parseXMLFromString($n.readUTFBytes()));break;default:this.onLoaded($f);}else this.event("error",$J);},$h.onLoaded=function($J){var $h=this._type;if("plf"==$h)this.parsePLFData($J),this.complete($J);else if("image"===$h){var $f=new $xJ($J);$f.url=this._url,this.complete($f);}else if("sound"===$h||"htmlimage"===$h||"nativeimage"===$h)this.complete($J);else if("atlas"===$h){if(!$J.src&&!$J._setContext){if(!this._data){if((this._data=$J).meta&&$J.meta.image)for(var $n=$J.meta.image.split(","),$L=0<=this._url.indexOf("/")?"/":"\\",$T=this._url.lastIndexOf($L),$k=0<=$T?this._url.substr(0,$T+1):"",$u=0,$S=$n.length;$u<$S;$u++)$n[$u]=$k+$n[$u];else $n=[this._url.replace(".json",".png")];$n.reverse(),$J.toLoads=$n,$J.pics=[];}return this.event("progress",.3+1/$n.length*.6),this._loadImage($n.pop());}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push($J),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var $Y=this._data.frames,$x=this._url.split("?")[0],$j=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:$x.substring(0,$x.lastIndexOf("."))+"/",$R=this._data.pics,$l=$W.formatURL(this._url),$i=$F.atlasMap[$l]||($F.atlasMap[$l]=[]);$i.dir=$j;var $q=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var $o in $q=parseFloat(this._data.meta.scale),$Y){var $r,$_=$Y[$o],$s=$R[$_.frame.idx?$_.frame.idx:0],$d=$W.formatURL($j+$o);$s.scaleRate=$q,$r=$xJ.create($s,$_.frame.x,$_.frame.y,$_.frame.w,$_.frame.h,$_.spriteSourceSize.x,$_.spriteSourceSize.y,$_.sourceSize.w,$_.sourceSize.h),$F.cacheRes($d,$r),$F.keepCache(this._url,$j+$o),$r.url=$d,$i.push($d);}else for($o in $Y)$s=$R[($_=$Y[$o]).frame.idx?$_.frame.idx:0],$d=$W.formatURL($j+$o),$F.cacheRes($d,$xJ.create($s,$_.frame.x,$_.frame.y,$_.frame.w,$_.frame.h,$_.spriteSourceSize.x,$_.spriteSourceSize.y,$_.sourceSize.w,$_.sourceSize.h)),$F.loadedMap[$d].url=$d,$F.keepCache(this._url,$j+$o),$i.push($d);delete this._data.pics,this.complete(this._data);}else if("font"==$h){if(!$J.src)return this._data=$J,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var $p=new $A();$p.parseFont(this._data,$J);var $U=this._url.split(".fnt")[0].split("/"),$Q=$U[$U.length-1];$oJ.registerBitmapFont($Q,$p),this._data=$p,this.complete(this._data);}else if("pkm"==$h){var $D=$UJ.create($J,this._url),$g=new $xJ($D);$g.url=this._url,this.complete($g);}else this.complete($J);},$h.parsePLFData=function($J){var $h,$f,$n;for($h in $J)switch($n=$J[$h],$h){case"json":case"text":for($f in $n)$F.preLoadedMap[$W.formatURL($f)]=$n[$f];break;default:for($f in $n)$F.preLoadedMap[$W.formatURL($f)]=$n[$f];}},$h.complete=function($J){this._data=$J,this._customParse?this.event("loaded",$J instanceof Array?[$J]:$J):($F._loaders.push(this),$F._isWorking||$F.checkNext());},$h.endLoad=function($J){$J&&(this._data=$J),this._cache&&$F.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data);},$x(0,$h,"url",function(){return this._url;}),$x(0,$h,"data",function(){return this._data;}),$x(0,$h,"cache",function(){return this._cache;}),$x(0,$h,"type",function(){return this._type;}),$F.checkNext=function(){$F._isWorking=!0;for(var $J=$a.now();$F._startIndex<$F._loaders.length;)if($a.now(),$F._loaders[$F._startIndex].endLoad(),$F._startIndex++,$a.now()-$J>$F.maxTimeOut)return console.warn("loader callback cost a long time:"+($a.now()-$J)+" url="+$F._loaders[$F._startIndex-1].url),void $Q.timer.frameOnce(1,null,$F.checkNext);$F._loaders.length=0,$F._startIndex=0,$F._isWorking=!1;},$F.clearRes=function($J,$h){if(null!=$J){void 0===$h&&($h=!1),$J=$W.formatURL($J);var $f=$F.getAtlas($J);if($f){for(var $n=0,$L=$f.length;$n<$L;$n++){var $T=$f[$n],$k=$F.getRes($T);delete $F.loadedMap[$T],$F.clearCache($J.substring($W.basePath.length),$T.substring($W.basePath.length)),$k&&$k.destroy($h);}$f.length=0,delete $F.atlasMap[$J],delete $F.loadedMap[$J];}else{var $u=$F.loadedMap[$J];$u&&(delete $F.loadedMap[$J],$u instanceof laya.resource.Texture&&$u.bitmap&&$u.destroy($h));}}},$F.clearTextureRes=function($J){$J=$W.formatURL($J);var $h=laya.net.Loader.getAtlas($J),$f=$h&&0<$h.length?laya.net.Loader.getRes($h[0]):laya.net.Loader.getRes($J);$f&&$f.bitmap&&($I.isConchApp&&!$I.isConchWebGL?$f.bitmap.source.releaseTexture&&$f.bitmap.source.releaseTexture():null==$f.bitmap._atlaser&&$f.bitmap.releaseResource(!0));},$F.getRes=function($J){return $F.loadedMap[$W.formatURL($J)];},$F.getAtlas=function($J){return $F.atlasMap[$W.formatURL($J)];},$F.cacheRes=function($J,$h){$J=$W.formatURL($J),null!=$F.loadedMap[$J]?console.warn("Resources already exist,is repeated loading:",$J):$F.loadedMap[$J]=$h;},$F.setGroup=function($J,$h){$F.groupMap[$h]||($F.groupMap[$h]=[]),$F.groupMap[$h].push($J);},$F.clearResByGroup=function($J){if($F.groupMap[$J]){var $h=$F.groupMap[$J],$f=0,$n=$h.length;for($f=0;$f<$n;$f++)$F.clearRes($h[$f]);$h.length=0;}},$F.keepCache=function($J,$h){if($J&&$h){var $f=$F.cacheSet[$h];$f?-1==$f.indexOf($J)&&$f.push($J):$F.cacheSet[$h]=[$J];}},$F.clearCache=function($J,$h){if($J&&$h){var $f=$F.cacheSet[$h];if($f){var $n=$f.indexOf($J);if(-1!==$n){var $L=$f.length-1;0==$L?(delete $F.cacheSet[$h],0<$F.imgMgrSet[$h]?$k.imgMgrFree($h,$F.imgMgrSet[$h]):$F.clearRes($h,!0)):($f[$n]=$f[$L],$f.length=$L);}}}},$F.saveObject=function($J,$h,$f){if($h&&$J){var $n=$F.objectSet[$J];$n?(console.warn("Loader.saveObject: "+$J),$n[0]=$h,$n[1]=$f):$F.objectSet[$J]=[$h,$f,[]];}},$F.findObject=function($J){if($J){var $h=$F.objectSet[$J];if($h)return $h[0];}return null;},$F.keepObject=function($J,$h){if($J&&$h){var $f=$F.objectSet[$h];$f&&-1===$f[2].indexOf($J)&&$f[2].push($J);}},$F.clearObject=function($J,$h){if($J&&$h){var $f=$F.objectSet[$h];if($f){var $n=$f[2],$L=$n.indexOf($J);if(-1!==$L){var $T=$n.length-1;0==$T?(delete $F.objectSet[$h],$f[1]&&$f[1].call(null,$f[0])):($n[$L]=$n[$T],$n.length=$T);}}}},$F.TEXT="text",$F.JSON="json",$F.XML="xml",$F.BUFFER="arraybuffer",$F.IMAGE="image",$F.SOUND="sound",$F.ATLAS="atlas",$F.FONT="font",$F.TTF="ttf",$F.PLF="plf",$F.PKM="pkm",$F.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},$F.parserMap={},$F.groupMap={},$F.maxTimeOut=100,$F.loadedMap={},$F.preLoadedMap={},$F.atlasMap={},$F._loaders=[],$F._isWorking=!1,$F._startIndex=0,$F.imgCache={},$F.cacheSet={},$F.objectSet={},$F.imgMgrSet={},$F;}(),$SJ=function($J){var $R;function $l(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},$l.__super.call(this);for(var $J=0;$J<this._maxPriority;$J++)this._resInfos[$J]=[];}$q($l,"laya.net.LoaderManager",$Y);var $h=$l.prototype;return $h.create=function($J,$f,$h,$n,$L,$T,$k,$u){if(null==$T&&($T=2),null==$k&&($k=!0),$J instanceof Array){var $S=$J,$Y=$S.length,$x=0;if($h)var $j=$_.create($h.caller,$h.method,$h.args,!1);for(var $R=0;$R<$Y;$R++){var $l=$S[$R];"string"==typeof $l&&($l=$S[$R]={url:$l}),$l.progress=0;}for($R=0;$R<$Y;$R++){$l=$S[$R];var $i=$h?$_.create(null,$r,[$l],!1):null,$q=$h||$f?$_.create(null,$o,[$l]):null;this._create($l.url,$q,$i,$l.clas||$n,$l.params||$L,null!=$l.priority&&0<=$l.priority?$l.priority:$T,$k,$l.group||$u);}function $o($J,$h){$x++,$J.progress=1,$x===$Y&&$f&&$f.run();}function $r($J,$h){$J.progress=$h;for(var $f=0,$n=0;$n<$Y;$n++){$f+=$S[$n].progress;}var $L=$f/$Y;$j.runWith($L);}return!0;}return this._create($J,$f,$h,$n,$L,$T,$k,$u);},$h._create=function($h,$f,$J,$n,$L,$T,$k,$u){$h&&""!=$h||console.error("加载的url不合法 "+$h),null==$T&&($T=2),null==$k&&($k=!0);var $S=$W.formatURL($h),$Y=this.getRes($S);if($Y)!$Y.hasOwnProperty("loaded")||$Y.loaded?($J&&$J.runWith(1),$f&&$f.run()):$f&&$Q.loader._createListener($h,$f.caller,$f.method,$f.args,!0,!1);else{var $x=$E.getFileExtension($h),$j=$l.createMap[$x];if(!$j)throw new Error("LoaderManager:unknown file("+$h+") extension with: "+$x+".");$n||($n=$j[0]);var $R=$j[1];if("atlas"==$x)this.load($h,$f,$J,$R,$T,$k);else{$n===$xJ&&($R="htmlimage"),($Y=$n?new $n():null).hasOwnProperty("_loaded")&&($Y._loaded=!1),$Y._setUrl($h),$u&&$Y._setGroup($u),this._createLoad($Y,$h,$_.create(null,function($J){$Y&&!$Y.destroyed&&$J&&$Y.onAsynLoaded.call($Y,$h,$J,$L),$f&&$f.run();$Q.loader.event($h);}),$J,$R,$T,!1,$u,!0),$k&&this.cacheRes($S,$Y);}}return $Y;},$h.load=function($J,$h,$f,$n,$L,$T,$k,$u){$J&&""!=$J||console.error("加载的url不合法 "+$J);var $S=this;if(null==$L&&($L=2),null==$T&&($T=!0),void 0===$u&&($u=!1),$J instanceof Array)return this._loadAssets($J,$h,$f,$n,$L,$T,$k);var $Y=$uJ.getRes($J);if(null!=$Y)$Q.timer.frameOnce(1,null,function(){$f&&$f.runWith(1),$h&&$h.runWith($Y),$S._loaderCount||$S.event("complete");});else{var $x=$l._resMap[$J];$x?($h&&$x._createListener("complete",$h.caller,$h.method,$h.args,!1,!1),$f&&$x._createListener("progress",$f.caller,$f.method,$f.args,!1,!1)):(($x=this._infoPool.length?this._infoPool.pop():new $R()).url=$J,$x.clas=null,$x.type=$n,$x.cache=$T,$x.group=$k,$x.ignoreCache=$u,$x.priority=$L,$h&&$x.on("complete",$h.caller,$h.method,$h.args),$f&&$x.on("progress",$f.caller,$f.method,$f.args),$l._resMap[$J]=$x,$L=$L<this._maxPriority?0<=$L?$L:0:this._maxPriority-1,this._resInfos[$L].push($x),this._next());}return this;},$h.cancel=function($J,$h,$f){if($Y=$l._resMap[$J]){$h&&$Y.off("complete",$h.caller,$h.method,!1),$f&&$Y.off("progress",$f.caller,$f.method,!1);var $n=$Y.getListener("complete"),$L=$Y.getListener("progress");if(!($n&&$n.head||$L&&$L.head)){if($Y.loader){var $T=$Y.loader;$T.imageCancel($J),$T.offAll(),$T._data=null,$T._customParse=!1,$T._url=null,$T._class=null,$T._type=null,this._loaders.push($T),this._loaderCount--,delete this._loaderMap[$Y.url];}for(var $k=0;$k<this._maxPriority;$k++)for(var $u=this._resInfos[$k],$S=$u.length-1;-1<$S;$S--){var $Y;($Y=$u[$S])&&$Y.url===$J&&($u[$S]=null,$Y.destroy(),$Y.offAll(),this._infoPool.push($Y));}delete $l._resMap[$J],this._next();}}},$h._createLoad=function($J,$h,$f,$n,$L,$T,$k,$u,$S){var $Y=this;if(null==$T&&($T=2),null==$k&&($k=!0),void 0===$S&&($S=!1),$h instanceof Array)return this._loadAssets($h,$f,$n,$L,$T,$k,$u);var $x=$uJ.getRes($h);if(null!=$x)$Q.timer.frameOnce(1,null,function(){$n&&$n.runWith(1),$f&&$f.runWith($x),$Y._loaderCount||$Y.event("complete");});else{var $j=$l._resMap[$h];$j?($f&&$j._createListener("complete",$f.caller,$f.method,$f.args,!1,!1),$n&&$j._createListener("progress",$n.caller,$n.method,$n.args,!1,!1)):(($j=this._infoPool.length?this._infoPool.pop():new $R()).url=$h,$j.clas=$J,$j.type=$L,$j.cache=$k,$j.group=$u,$j.ignoreCache=$S,$j.priority=$T,$f&&$j.on("complete",$f.caller,$f.method,$f.args),$n&&$j.on("progress",$n.caller,$n.method,$n.args),$l._resMap[$h]=$j,$T=$T<this._maxPriority?0<=$T?$T:0:this._maxPriority-1,this._resInfos[$T].push($j),this._next());}return this;},$h._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var $J=0;$J<this._maxPriority;$J++)for(var $h=this._resInfos[$J];0<$h.length;){var $f=$h.shift();if($f)return this._doLoad($f);}this._loaderCount||this.event("complete");}},$h._doLoad=function($h){var $f=this._loaders.length?this._loaders.pop():new $uJ();this._loaderCount++,(this._loaderMap[$h.url]=$f).on("complete",null,$L),$f.on("progress",null,function($J){$h.event("progress",$J);}),$f.on("error",null,function($J){$L(null);}),$h.loader=$f;var $n=this;function $L($J){$f.offAll(),$f._data=null,$f._customParse=!1,$f._url=null,$f._class=null,$f._type=null,$n._loaders.push($f),$n._loaderCount--,delete $n._loaderMap[$h.url],$n._endLoad($h,$J instanceof Array?[$J]:$J),$n._next();}$f._class=$h.clas,1<=$h.priority?($f.priority=$h.priority,$f.realTime=!1):($f.priority=0,$f.realTime=!0),$f.load($h.url,$h.type,$h.cache,$h.group,$h.ignoreCache);},$h._endLoad=function($J,$h){var $f=$J.url;if(null==$h){var $n=this._failRes[$f]||0;if($n<this.retryNum)return console.warn("[warn]Retry to load:",$f),this._failRes[$f]=$n+1,void $Q.timer.once(this.retryDelay,this,this._addReTry,[$J],!1);console.warn("[error]Failed to load:",$f),this.event("error",$f);}this._failRes[$f]&&(this._failRes[$f]=0),delete $l._resMap[$f],$J.event("complete",$h),$J.destroy(),$J.offAll(),this._infoPool.push($J);},$h._addReTry=function($J){this._resInfos[this._maxPriority-1].push($J),this._next();},$h.clearRes=function($J,$h){void 0===$h&&($h=!1),$uJ.clearRes($J,$h);},$h.getRes=function($J){return $uJ.getRes($J);},$h.cacheRes=function($J,$h){$uJ.cacheRes($J,$h);},$h.clearTextureRes=function($J){$uJ.clearTextureRes($J);},$h.setGroup=function($J,$h){$uJ.setGroup($J,$h);},$h.clearResByGroup=function($J){$uJ.clearResByGroup($J);},$h.clearUnLoaded=function(){for(var $J=0;$J<this._maxPriority;$J++){for(var $h=this._resInfos[$J],$f=$h.length-1;-1<$f;$f--){var $n=$h[$f];$n&&($n.destroy(),$n.offAll(),this._infoPool.push($n));}$h.length=0;}this._loaderCount=0,$l._resMap={};},$h.cancelLoadByUrls=function($J){if($J)for(var $h=0,$f=$J.length;$h<$f;$h++)this.cancelLoadByUrl($J[$h]);},$h.cancelLoadByUrl=function($J){for(var $h=0;$h<this._maxPriority;$h++)for(var $f=this._resInfos[$h],$n=$f.length-1;-1<$n;$n--){var $L=$f[$n];$L&&$L.url===$J&&($f[$n]=null,$L.destroy(),$L.offAll(),this._infoPool.push($L));}$l._resMap[$J]&&delete $l._resMap[$J];},$h._loadAssets=function($J,$f,$k,$h,$n,$L,$T){null==$n&&($n=2),null==$L&&($L=!0);for(var $u=$J.length,$S=0,$Y=0,$x=[],$j=!0,$R=0;$R<$u;$R++){var $l=$J[$R];if(!$l)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+$J);"string"==typeof $l&&($l={url:$l,type:$h,size:1,priority:$n}),$l.size||($l.size=1),$l.progress=0,$Y+=$l.size,$x.push($l);var $i=$k?$_.create(null,$r,[$l],!1):null,$q=$f||$k?$_.create(null,$o,[$l]):null;this.load($l.url,$q,$i,$l.type,null!=$l.priority&&0<=$l.priority?$l.priority:2,$L,$l.group||$T);}function $o($J,$h){$S++,$J.progress=1,$h||($j=!1),$S===$u&&$f&&$f.runWith($j);}function $r($J,$h){if(null!=$k){$J.progress=$h;for(var $f=0,$n=0;$n<$x.length;$n++){var $L=$x[$n];$f+=$L.size*$L.progress;}var $T=$f/$Y;$k.runWith($T);}}return this;},$l.cacheRes=function($J,$h){$uJ.cacheRes($J,$h);},$l._resMap={},$S($l,["createMap",function(){return this.createMap={atlas:[null,"atlas"]};}]),$l.__init$=function(){$R=function($J){function $h(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,$h.__super.call(this);}return $q($h,"",$Y),$h.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1;},$h;}();},$l;}(),$YJ=(function($J){function $L($J){$L.__super.call(this),$J||($J=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var $h=0,$f=0,$n=0;$n<20;$n++)$n%5!=4?this._mat[$h++]=$J[$n]:this._alpha[$f++]=$J[$n];this._action=$y.createFilterAction(32),this._action.data=this;}$q($L,"laya.filters.ColorFilter",$r);var $h=$L.prototype;$Q.imps($h,{"laya.filters.IFilter":!0}),$h.callNative=function($J){$J._$P.cf=this;$J.conchModel&&$J.conchModel.setFilterMatrix&&$J.conchModel.setFilterMatrix(this._mat,this._alpha);},$x(0,$h,"type",function(){return 32;}),$x(0,$h,"action",function(){return this._action;});}(),function($J){function $n($J,$h,$f){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===$h&&($h=0),$n.__super.call(this),this._byteClass=$f||$B,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,$J&&0<$h&&$h<65535&&this.connect($J,$h);}$q($n,"laya.net.Socket",$Y);var $h=$n.prototype;$h.connect=function($J,$h){var $f="ws://"+$J+":"+$h;$f="https:"==$a.window.location.protocol?"wss://"+$J+":"+$h:"ws://"+$J+":"+$h,this.connectByUrl($f);},$h.connectByUrl=function($J){var $h=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new $a.window.WebSocket($J,this.protocols):this._socket=new $a.window.WebSocket($J),this._socket.binaryType="arraybuffer",this._output=new this._byteClass(),this._output.endian=this.endian,this._input=new this._byteClass(),this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function($J){$h._onOpen($J);},this._socket.onmessage=function($J){$h._onMessage($J);},this._socket.onclose=function($J){$h._onClose($J);},this._socket.onerror=function($J){$h._onError($J);};},$h.cleanSocket=function(){try{this._socket.close();}catch($J){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null;},$h.close=function(){if(null!=this._socket)try{this._socket.close();}catch($J){}},$h._onOpen=function($J){this._connected=!0,this.event("open",$J);},$h._onMessage=function($J){if($J&&$J.data){var $h=$J.data;if(this.disableInput&&$h)this.event("message",$h);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var $f=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,$h&&("string"==typeof $h?this._input.writeUTFBytes($h):this._input.writeArrayBuffer($h),this._addInputPosition=this._input.pos,this._input.pos=$f),this.event("message",$h);}}},$h._onClose=function($J){this._connected=!1,this.event("close",$J);},$h._onError=function($J){this.event("error",$J);},$h.send=function($J){this._socket.send($J);},$h.flush=function(){if(this._output&&0<this._output.length){var $h;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length));}catch($J){$h=$J;}this._output.endian=this.endian,this._output.clear(),$h&&this.event("error",$h);}},$x(0,$h,"input",function(){return this._input;}),$x(0,$h,"output",function(){return this._output;}),$x(0,$h,"connected",function(){return this._connected;}),$x(0,$h,"endian",function(){return this._endian;},function($J){this._endian=$J,null!=this._input&&(this._input.endian=$J),null!=this._output&&(this._output.endian=$J);}),$n.LITTLE_ENDIAN="littleEndian",$n.BIG_ENDIAN="bigEndian";}(),function($J){function $u(){$u.__super.call(this),this._$1__id=++$u._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,($u._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,$c.currentResourceManager&&$c.currentResourceManager.addResource(this);}$q($u,"laya.resource.Resource",$Y);var $h=$u.prototype;return $Q.imps($h,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),$h._setUrl=function($J){var $h;this._url!==$J&&(this._url&&(($h=$u._urlResourcesMap[this._url]).splice($h.indexOf(this),1),0===$h.length&&delete $u._urlResourcesMap[this._url]),$J&&(($h=$u._urlResourcesMap[$J])||($u._urlResourcesMap[$J]=$h=[]),$h.push(this)),this._url=$J);},$h._getGroup=function(){return this._group;},$h._setGroup=function($J){var $h;this._group!==$J&&(this._group&&(($h=$u._groupResourcesMap[this._group]).splice($h.indexOf(this),1),0===$h.length&&delete $u._groupResourcesMap[this._group]),$J&&(($h=$u._groupResourcesMap[$J])||($u._groupResourcesMap[$J]=$h=[]),$h.push(this)),this._group=$J);},$h._addReference=function(){this._referenceCount++;},$h._removeReference=function(){this._referenceCount--;},$h._clearReference=function(){this._referenceCount=0;},$h._endLoaded=function(){this.__loaded=!0,this.event("loaded",this);},$h.recreateResource=function(){this.completeCreate();},$h.disposeResource=function(){},$h.activeResource=function($J){void 0===$J&&($J=!1),this._lastUseFrameCount=$M.loopCount,!this._destroyed&&this.__loaded&&(this._released||$J)&&this.recreateResource();},$h.releaseResource=function($J){return void 0===$J&&($J=!0),!(!$J&&this.lock)&&!(this._released&&!$J)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0);},$h.onAsynLoaded=function($J,$h,$f){throw new Error("Resource: must override this function!");},$h.destroy=function(){var $J;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete $u._idResourcesMap[this.id],this._url&&(($J=$u._urlResourcesMap[this._url])&&($J.splice($J.indexOf(this),1),0===$J.length&&delete $u._urlResourcesMap[this.url]),$uJ.clearRes(this._url),this.__loaded||$y.cancelLoadByUrl(this._url)),this._group&&(($J=$u._groupResourcesMap[this._group]).splice($J.indexOf(this),1),0===$J.length&&delete $u._groupResourcesMap[this.url]));},$h.completeCreate=function(){this._released=!1,this.event("recovered",this);},$h.dispose=function(){this.destroy();},$x(0,$h,"memorySize",function(){return this._memorySize;},function($J){var $h=$J-this._memorySize;this._memorySize=$J,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,$h),this.resourceManager&&this.resourceManager.addSize($h);}),$x(0,$h,"_loaded",null,function($J){this.__loaded=$J;}),$x(0,$h,"loaded",function(){return this.__loaded;}),$x(0,$h,"id",function(){return this._$1__id;}),$x(0,$h,"destroyed",function(){return this._destroyed;}),$x(0,$h,"group",function(){return this._getGroup();},function($J){this._setGroup($J);}),$x(0,$h,"resourceManager",function(){return this._resourceManager;}),$x(0,$h,"url",function(){return this._url;}),$x(0,$h,"released",function(){return this._released;}),$x(0,$h,"referenceCount",function(){return this._referenceCount;}),$u.getResourceByID=function($J){return $u._idResourcesMap[$J];},$u.getResourceByURL=function($J,$h){return void 0===$h&&($h=0),null==$u._urlResourcesMap[$J]?null:$u._urlResourcesMap[$J][$h];},$u.getResourceCountByURL=function($J){return $u._urlResourcesMap[$J].length;},$u.destroyUnusedResources=function($J){var $h;if($J){var $f=$u._groupResourcesMap[$J];if($f)for(var $n=$f.slice(),$L=0,$T=$n.length;$L<$T;$L++)($h=$n[$L]).lock||0!==$h._referenceCount||$h.destroy();}else for(var $k in $u._idResourcesMap)($h=$u._idResourcesMap[$k]).lock||0!==$h._referenceCount||$h.destroy();},$u._uniqueIDCounter=0,$u._idResourcesMap={},$u._urlResourcesMap={},$u._groupResourcesMap={},$u;}()),$xJ=function($J){function $F($J,$h){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,$F.__super.call(this),$J&&null!=$J._addReference&&$J._addReference(),this.setTo($J,$h);}$q($F,"laya.resource.Texture",$Y);var $h=$F.prototype;return $h._setUrl=function($J){this.url=$J;},$h.setTo=function($J,$h){if($J instanceof $k.HTMLElement){var $f=$sJ.create("2D",$J);this.bitmap=$f;}else this.bitmap=$J;if(this.uv=$h||$F.DEF_UV,$J){this._w=$J.width,this._h=$J.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var $n=this;if(this._loaded)$y.addToAtlas&&$y.addToAtlas($n);else{var $L=$J;$L instanceof laya.resource.HTMLImage&&$L.image&&$L.image.addEventListener("load",function($J){$y.addToAtlas&&$y.addToAtlas($n);},!1);}}},$h.active=function(){this.bitmap&&this.bitmap.activeResource();},$h.destroy=function($J){if(void 0===$J&&($J=!1),this.alphaTexture&&(this.alphaTexture.destroy($J),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var $h=this.bitmap;$J?($I.isConchApp&&$h.source&&$h.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$h.dispose(),$h._clearReference()):($h._removeReference(),0==$h.referenceCount&&($I.isConchApp&&$h.source&&$h.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$h.dispose())),this.url&&this===$Q.loader.getRes(this.url)&&$Q.loader.clearRes(this.url,$J),this._loaded=!1;}},$h.load=function($J){var $h=this;this._loaded=!1,$J=$W.customFormat($J);var $f=this.bitmap||(this.bitmap=$UJ.create($J));$f.uri=$J,$f&&$f._addReference();var $n=this;$f.onload=function(){$f.onload=null,$n._loaded=!0,$h.sourceWidth=$h._w=$f.width,$h.sourceHeight=$h._h=$f.height,$n.event("loaded",this),$y.addToAtlas&&$y.addToAtlas($n);};},$h.addTextureToAtlas=function($J){$y.addTextureToAtlas(this);},$h.getPixels=function($J,$h,$f,$n){if($I.isConchApp){var $L=this.bitmap;if($L.source&&$L.source.getImageData){var $T=$L.source.getImageData($J,$h,$f,$n),$k=new Uint8Array($T);return Array.from($k);}return null;}return $I.isWebGL?$y.getTexturePixels(this,$J,$h,$f,$n):($a.canvas.size($f,$n),$a.canvas.clear(),$a.context.drawTexture(this,-$J,-$h,this.width,this.height,0,0),$a.context.getImageData(0,0,$f,$n).data);},$h.onAsynLoaded=function($J,$h){if($h){if("function"!=typeof $h._addReference)throw new Error("bitmap._addReference is not a function. "+$h.className+" "+typeof $h._addReference+" "+$h.constructor);$h._addReference();}this.setTo($h,this.uv),this._loaded&&this.event("loaded",this);},$x(0,$h,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null;}),$x(0,$h,"loaded",function(){return this._loaded;}),$x(0,$h,"released",function(){return!this.bitmap||this.bitmap.released;}),$x(0,$h,"width",function(){return this._w?this._w:this.uv&&this.uv!==$F.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width;},function($J){this._w=$J,this.sourceWidth||(this.sourceWidth=$J);}),$x(0,$h,"repeat",function(){return!$I.isWebGL||!this.bitmap||this.bitmap.repeat;},function($J){$J&&$I.isWebGL&&this.bitmap&&(this.bitmap.repeat=$J)&&(this.bitmap.enableMerageInAtlas=!1);}),$x(0,$h,"height",function(){return this._h?this._h:this.uv&&this.uv!==$F.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height;},function($J){this._h=$J,this.sourceHeight||(this.sourceHeight=$J);}),$x(0,$h,"isLinearSampling",function(){return!$I.isWebGL||9728!=this.bitmap.minFifter;},function($J){!$J&&$I.isWebGL&&($J||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1));}),$F.moveUV=function($J,$h,$f){for(var $n=0;$n<8;$n+=2)$f[$n]+=$J,$f[$n+1]+=$h;return $f;},$F.create=function($J,$h,$f,$n,$L,$T,$k,$u,$S){void 0===$T&&($T=0),void 0===$k&&($k=0),void 0===$u&&($u=0),void 0===$S&&($S=0);var $Y=$J instanceof laya.resource.Texture,$x=$Y?$J.uv:$F.DEF_UV,$j=$Y?$J.bitmap:$J,$R=$y.isAtlas($j);if($R){var $l=$j._atlaser,$i=$J._atlasID;if(-1==$i)throw new Error("create texture error");$j=$l._inAtlasTextureBitmapValue[$i],$x=$l._inAtlasTextureOriUVValue[$i];}var $q=new $F($j,null);$j.width&&$h+$n>$j.width&&($n=$j.width-$h),$j.height&&$f+$L>$j.height&&($L=$j.height-$f),$q.width=$n,$q.height=$L,$q.offsetX=$T,$q.offsetY=$k,$q.sourceWidth=$u||$n,$q.sourceHeight=$S||$L;var $o=1/$j.width,$r=1/$j.height;$h*=$o,$f*=$r,$n*=$o,$L*=$r;var $_=$q.uv[0],$s=$q.uv[1],$d=$q.uv[4],$p=$q.uv[5],$U=$d-$_,$Q=$p-$s,$D=$F.moveUV($x[0],$x[1],[$h,$f,$h+$n,$f,$h+$n,$f+$L,$h,$f+$L]);$q.uv=[$_+$D[0]*$U,$s+$D[1]*$Q,$d-(1-$D[2])*$U,$s+$D[3]*$Q,$d-(1-$D[4])*$U,$p-(1-$D[5])*$Q,$_+$D[6]*$U,$p-(1-$D[7])*$Q],$R&&$q.addTextureToAtlas();var $g=$j.scaleRate;return $g&&1!=$g?($q.sourceWidth/=$g,$q.sourceHeight/=$g,$q.width/=$g,$q.height/=$g,$q.scaleRate=$g,$q.offsetX/=$g,$q.offsetY/=$g):$q.scaleRate=1,$q;},$F.createFromTexture=function($J,$h,$f,$n,$L){var $T=$J.scaleRate;1!=$T&&($h*=$T,$f*=$T,$n*=$T,$L*=$T);var $k=$g.TEMP.setTo($h-$J.offsetX,$f-$J.offsetY,$n,$L),$u=$k.intersection($F._rect1.setTo(0,0,$J.width,$J.height),$F._rect2);if(!$u)return null;var $S=$F.create($J,$u.x,$u.y,$u.width,$u.height,$u.x-$k.x,$u.y-$k.y,$n,$L);if($S.bitmap&&$S.bitmap._removeReference)return $S.bitmap._removeReference(),$S;var $Y="bitmap:"+($S.bitmap?$S.bitmap.constructor?$S.bitmap.constructor.name:$S.bitmap.__className:"")+", url:"+($J.url+" | "+($S.bitmap?$S.bitmap.url:$J.url))+", x="+$h+",y="+$f+",width="+$n+",height="+$L+", result="+($u?$u.x+","+$u.y+","+$u.width+","+$u.height:"null")+", rect="+$k.x+","+$k.y+","+$k.width+","+$k.height;throw new Error("报错：bitmap._removeReference is not a function  "+$Y);},$F.DEF_UV=[0,0,1,0,1,1,0,1],$F.INV_UV=[0,1,1,1,1,0,0,0],$F._rect1=new $g(),$F._rect2=new $g(),$F;}(),$J=function($J){var $u;function $T(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,$T.__super.call(this);}$q($T,"laya.utils.TimeLine",$Y);var $h=$T.prototype;return $h.to=function($J,$h,$f,$n,$L){return void 0===$L&&($L=0),this._create($J,$h,$f,$n,$L,!0);},$h.from=function($J,$h,$f,$n,$L){return void 0===$L&&($L=0),this._create($J,$h,$f,$n,$L,!1);},$h._create=function($J,$h,$f,$n,$L,$T){var $k=$$.getItemByClass("tweenData",$u);return $k.isTo=$T,$k.type=0,$k.target=$J,$k.duration=$f,$k.data=$h,$k.startTime=this._startTime+$L,$k.endTime=$k.startTime+$k.duration,$k.ease=$n,this._startTime=Math.max($k.endTime,this._startTime),this._tweenDataList.push($k),this._startTimeSort=!0,this._endTimeSort=!0,this;},$h.addLabel=function($J,$h){var $f=$$.getItemByClass("tweenData",$u);return $f.type=1,$f.data=$J,$f.endTime=$f.startTime=this._startTime+$h,this._labelDic||(this._labelDic={}),this._labelDic[$J]=$f,this._tweenDataList.push($f),this;},$h.removeLabel=function($J){if(this._labelDic&&this._labelDic[$J]){var $h=this._labelDic[$J];if($h){var $f=this._tweenDataList.indexOf($h);-1<$f&&this._tweenDataList.splice($f,1);}delete this._labelDic[$J];}},$h.gotoTime=function($J){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var $h,$f,$n,$L;for(var $T in this._firstTweenDic)if($f=this._firstTweenDic[$T])for(var $k in $f)$f.diyTarget.hasOwnProperty($k)&&($f.diyTarget[$k]=$f[$k]);for($T in this._tweenDic)($h=this._tweenDic[$T]).clear(),delete this._tweenDic[$T];if(this._index=0,this._gidIndex=0,this._currTime=$J,this._lastTime=$a.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=$n=this._tweenDataList.concat(),$n.sort(function($J,$h){return $J.endTime>$h.endTime?1:$J.endTime<$h.endTime?-1:0;});}else $n=this._endTweenDataList;for(var $u=0,$S=$n.length;$u<$S;$u++)if(0==($L=$n[$u]).type){if(!($J>=$L.endTime))break;this._index=Math.max(this._index,$u+1);var $Y=$L.data;if($L.isTo)for(var $x in $Y)$L.target[$x]=$Y[$x];}for($u=0,$S=this._tweenDataList.length;$u<$S;$u++)0==($L=this._tweenDataList[$u]).type&&$J>=$L.startTime&&$J<$L.endTime&&(this._index=Math.max(this._index,$u+1),this._gidIndex++,($h=$$.getItemByClass("tween",$w))._create($L.target,$L.data,$L.duration,$L.ease,$_.create(this,this._animComplete,[this._gidIndex]),0,!1,$L.isTo,!0,!1),$h.setStartTime(this._currTime-($J-$L.startTime)),$h._updateEase(this._currTime),$h.gid=this._gidIndex,this._tweenDic[this._gidIndex]=$h);}},$h.gotoLabel=function($J){if(null!=this._labelDic){var $h=this._labelDic[$J];$h&&this.gotoTime($h.startTime);}},$h.pause=function(){$Q.timer.clear(this,this._update);},$h.resume=function(){this.play(this._currTime,this._loopKey);},$h.play=function($J,$h){if(void 0===$J&&($J=0),void 0===$h&&($h=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function($J,$h){return $J.startTime>$h.startTime?1:$J.startTime<$h.startTime?-1:0;});for(var $f=0,$n=this._tweenDataList.length;$f<$n;$f++){var $L=this._tweenDataList[$f];if(null!=$L&&0==$L.type){var $T=$L.target,$k=$T.$_GID||($T.$_GID=$E.getGID()),$u=null;for(var $S in null==this._firstTweenDic[$k]?(($u={}).diyTarget=$T,this._firstTweenDic[$k]=$u):$u=this._firstTweenDic[$k],$L.data)null==$u[$S]&&($u[$S]=$T[$S]);}}}"string"==typeof $J?this.gotoLabel($J):this.gotoTime($J),this._loopKey=$h,this._lastTime=$a.now(),$Q.timer.frameLoop(1,this,this._update);}},$h._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var $J in this._tweenDic)($h=this._tweenDic[$J]).complete();return this._complete(),void this.pause();}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0);}var $h,$f=$a.now(),$n=$f-this._lastTime,$L=this._currTime+=$n*this.scale;for($J in this._lastTime=$f,this._tweenDic)($h=this._tweenDic[$J])._updateEase($L);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var $T=this._tweenDataList[this._index];$L>=$T.startTime&&(this._index++,0==$T.type?(this._gidIndex++,($h=$$.getItemByClass("tween",$w))._create($T.target,$T.data,$T.duration,$T.ease,$_.create(this,this._animComplete,[this._gidIndex]),0,!1,$T.isTo,!0,!1),$h.setStartTime($L),$h.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=$h)._updateEase($L)):this.event("label",$T.data));}},$h._animComplete=function($J){this._tweenDic[$J]&&delete this._tweenDic[$J];},$h._complete=function(){this.event("complete");},$h.reset=function(){var $J;if(this._labelDic)for($J in this._labelDic)delete this._labelDic[$J];for($J in this._tweenDic)this._tweenDic[$J].clear(),delete this._tweenDic[$J];for($J in this._firstTweenDic)delete this._firstTweenDic[$J];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var $h,$f=0;for($h=this._tweenDataList.length,$f=0;$f<$h;$f++)this._tweenDataList[$f]&&this._tweenDataList[$f].destroy();}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,$Q.timer.clear(this,this._update);},$h.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null;},$x(0,$h,"index",function(){return this._frameIndex;},function($J){this._frameIndex=$J,this.gotoTime(this._frameIndex/this._frameRate*1e3);}),$x(0,$h,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total;}),$T.to=function($J,$h,$f,$n,$L){return void 0===$L&&($L=0),new $T().to($J,$h,$f,$n,$L);},$T.from=function($J,$h,$f,$n,$L){return void 0===$L&&($L=0),new $T().from($J,$h,$f,$n,$L);},$T.__init$=function(){$u=function(){function $J(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null;}return $q($J,""),$J.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,$$.recover("tweenData",this);},$J;}();},$T;}(),$jJ=function($L){function $f(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,$f.__super.call(this),this._style=$u.EMPTY;}$q($f,"laya.display.Sprite",$L);var $J=$f.prototype;return $Q.imps($J,{"laya.display.ILayout":!0}),$J.createConchModel=function(){return new ConchNode();},$J.destroy=function($J){if(void 0===$J&&($J=!0),this._releaseMem(),!this._destroyed){this.filters=null;var $h=this.mask;$h&&(this.mask=null,$h.destroy($J));}$L.prototype.destroy.call(this,$J),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null;},$J.updateZOrder=function(){$E.updateOrder(this._childs)&&this.repaint();},$J.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1;},$J.setBounds=function($J){this._set$P("uBounds",$J);},$J.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new $g()),$g._getWrapRec(this._boundPointsToParent(),this._$P.mBounds);},$J.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new $g()),$g._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds));},$J._boundPointsToParent=function($J){void 0===$J&&($J=!1);var $h=0,$f=0;this._style&&($h=this._style._tf.translateX,$f=this._style._tf.translateY,$J=$J||0!==this._style._tf.rotate,this._style.scrollRect&&($h+=this._style.scrollRect.x,$f+=this._style.scrollRect.y));var $n=this._getBoundPointsM($J);if(!$n||$n.length<1)return $n;if(8!=$n.length&&($n=$J?$p.scanPList($n):$g._getWrapRec($n,$g.TEMP)._getBoundPoints()),!this.transform)return $E.transPointList($n,this._x-$h,this._y-$f),$n;var $L=$D.TEMP,$T=0,$k=$n.length;for($T=0;$T<$k;$T+=2)$L.x=$n[$T],$L.y=$n[$T+1],this.toParentPoint($L),$n[$T]=$L.x,$n[$T+1]=$L.y;return $n;},$J.getGraphicBounds=function($J){return void 0===$J&&($J=!1),this._graphics?this._graphics.getBounds($J):$g.TEMP.setTo(0,0,0,0);},$J._getBoundPointsM=function($J){if(void 0===$J&&($J=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var $h=$E.clearArray(this._$P.temBM),$f=$g.TEMP;return $f.copyFrom(this.scrollRect),$E.concatArray($h,$f._getBoundPoints()),$h;}for(var $n,$L,$T,$k=this._graphics?this._graphics.getBoundPoints():$E.clearArray(this._$P.temBM),$u=0,$S=($T=this._childs).length;$u<$S;$u++)($n=$T[$u])instanceof laya.display.Sprite&&1==$n.visible&&($L=$n._boundPointsToParent($J))&&($k=$k?$E.concatArray($k,$L):$L);return $k;},$J.getStyle=function(){return this._style===$u.EMPTY&&(this._style=new $u()),this._style;},$J.setStyle=function($J){this._style=$J;},$J._adjustTransform=function(){this._tfChanged=!1;var $J,$h=this._style._tf,$f=$h.scaleX,$n=$h.scaleY;if($h.rotate||1!==$f||1!==$n||$h.skewX||$h.skewY){($J=this._transform||(this._transform=$O.create())).bTransform=!0;var $L=.0174532922222222*($h.rotate-$h.skewX),$T=.0174532922222222*($h.rotate+$h.skewY),$k=Math.cos($T),$u=Math.sin($T),$S=Math.sin($L),$Y=Math.cos($L);return $J.a=$f*$k,$J.b=$f*$u,$J.c=-$n*$S,$J.d=$n*$Y,$J.tx=$J.ty=0,$J;}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,$J;},$J.pos=function($J,$h,$f){if(void 0===$f&&($f=!1),this._x!==$J||this._y!==$h){if(this.destroyed)return this;if($f){this._x=$J,this._y=$h,this.conchModel&&this.conchModel.pos(this._x,this._y);var $n=this._parent;$n&&0===$n._repaint&&($n._repaint=1,$n.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint());}else this.x=$J,this.y=$h;}return this;},$J.pivot=function($J,$h){return this.pivotX=$J,this.pivotY=$h,this;},$J.size=function($J,$h){return this.width=$J,this.height=$h,this;},$J.scale=function($J,$h,$f){void 0===$f&&($f=!1);var $n=this.getStyle(),$L=$n._tf;if($L.scaleX!=$J||$L.scaleY!=$h){if(this.destroyed)return this;if($f){$n.setScale($J,$h),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($J,$h),this._renderType|=4;var $T=this._parent;$T&&0===$T._repaint&&($T._repaint=1,$T.parentRepaint());}else this.scaleX=$J,this.scaleY=$h;}return this;},$J.skew=function($J,$h){return this.skewX=$J,this.skewY=$h,this;},$J.render=function($J,$h,$f){$M.spriteCount++,$Z.renders[this._renderType]._fun(this,$J,$h+this._x,$f+this._y),this._repaint=0;},$J.drawToCanvas=function($J,$h,$f,$n){if($I.isConchNode){var $L=$sJ.create("2D");return new $m($J,$h,$L).ctx.setCanvasType(1),this.conchModel.drawToCanvas($L.source,$f,$n),$L;}return $y.drawToCanvas(this,this._renderType,$J,$h,$f,$n);},$J.customRender=function($J,$h,$f){this._renderType|=1024;},$J._applyFilters=function(){var $J;if(!$I.isWebGL&&($J=this._$P.filters)&&!($J.length<1))for(var $h=0,$f=$J.length;$h<$f;$h++)$J[$h].action.apply(this._$P.cacheCanvas);},$J._isHaveGlowFilter=function(){var $J,$h=0;if(this.filters)for($h=0;$h<this.filters.length;$h++)if(8==this.filters[$h].type)return!0;for($h=0,$J=this._childs.length;$h<$J;$h++)if(this._childs[$h]._isHaveGlowFilter())return!0;return!1;},$J.localToGlobal=function($J,$h){void 0===$h&&($h=!1),!0===$h&&($J=new $D($J.x,$J.y));for(var $f=this;$f&&$f!=$Q.stage;)$J=$f.toParentPoint($J),$f=$f.parent;return $J;},$J.globalToLocal=function($J,$h){void 0===$h&&($h=!1),$h&&($J=new $D($J.x,$J.y));for(var $f=this,$n=[];$f&&$f!=$Q.stage;)$n.push($f),$f=$f.parent;for(var $L=$n.length-1;0<=$L;)$J=($f=$n[$L]).fromParentPoint($J),$L--;return $J;},$J.toParentPoint=function($J){if(!$J)return $J;$J.x-=this.pivotX,$J.y-=this.pivotY,this.transform&&this._transform.transformPoint($J),$J.x+=this._x,$J.y+=this._y;var $h=this._style.scrollRect;return $h&&($J.x-=$h.x,$J.y-=$h.y),$J;},$J.fromParentPoint=function($J){if(!$J)return $J;$J.x-=this._x,$J.y-=this._y;var $h=this._style.scrollRect;return $h&&($J.x+=$h.x,$J.y+=$h.y),this.transform&&this._transform.invertTransformPoint($J),$J.x+=this.pivotX,$J.y+=this.pivotY,$J;},$J.on=function($J,$h,$f,$n){return 1!==this._mouseEnableState&&this.isMouseEvent($J)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($J,$h,$f,$n,!1)):$L.prototype.on.call(this,$J,$h,$f,$n);},$J.once=function($J,$h,$f,$n){return 1!==this._mouseEnableState&&this.isMouseEvent($J)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($J,$h,$f,$n,!0)):$L.prototype.once.call(this,$J,$h,$f,$n);},$J._$2__onDisplay=function(){if(1!==this._mouseEnableState){var $J=this;for($J=$J.parent;$J&&1!==$J._mouseEnableState&&!$J._getBit(2);)$J.mouseEnabled=!0,$J._setBit(2,!0),$J=$J.parent;}},$J.loadImage=function($J,$h,$f,$n,$L,$T){var $k=this;return void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=0),void 0===$L&&($L=0),this.graphics.loadImage($J,$h,$f,$n,$L,function($J){$k.destroyed||($k.size($h+($n||$J.width),$f+($L||$J.height)),$k.repaint(),$T&&$T.runWith($J));}),this;},$J.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint();},$J._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache;},$J._childChanged=function($J){this._childs.length?this._renderType|=2048:this._renderType&=-2049,$J&&this._get$P("hasZorder")&&$Q.timer.callLater(this,this.updateZOrder),this.repaint();},$J.parentRepaint=function(){var $J=this._parent;$J&&0===$J._repaint&&($J._repaint=1,$J.parentRepaint());},$J.startDrag=function($J,$h,$f,$n,$L,$T,$k){void 0===$h&&($h=!1),void 0===$f&&($f=0),void 0===$n&&($n=300),void 0===$T&&($T=!1),void 0===$k&&($k=.92),this._$P.dragging||this._set$P("dragging",new $H()),this._$P.dragging.start(this,$J,$h,$f,$n,$L,$T,$k);},$J.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop();},$J._releaseMem=function(){if(this._$P){var $J=this._$P.cacheCanvas;$J&&$J.ctx&&($$.recover("RenderContext",$J.ctx),$J.ctx.canvas.size(0,0),$J.ctx=null);var $h=this._$P._filterCache;$h&&($h.destroy(),$h.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null;}},$J._setDisplay=function($J){$J||this._releaseMem(),$L.prototype._setDisplay.call(this,$J);},$J.hitTestPoint=function($J,$h){var $f=this.globalToLocal($D.TEMP.setTo($J,$h));return $J=$f.x,$h=$f.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?$g.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains($J,$h);},$J.getMousePoint=function(){return this.globalToLocal($D.TEMP.setTo($Q.stage.mouseX,$Q.stage.mouseY));},$J._getWords=function(){return null;},$J._addChildsToLayout=function($J){var $h=this._getWords();if(null==$h&&0==this._childs.length)return!1;if($h)for(var $f=0,$n=$h.length;$f<$n;$f++)$J.push($h[$f]);$f=0;for(var $L=this._childs.length;$f<$L;++$f){var $T=this._childs[$f];$T._style._enableLayout()&&$T._addToLayout($J);}return!0;},$J._addToLayout=function($J){this._style.absolute||(this._style.block?$J.push(this):this._addChildsToLayout($J)&&(this.x=this.y=0));},$J._isChar=function(){return!1;},$J._getCSSStyle=function(){return this._style.getCSSStyle();},$J._setAttributes=function($J,$h){switch($J){case"x":this.x=parseFloat($h);break;case"y":this.y=parseFloat($h);break;case"width":this.width=parseFloat($h);break;case"height":this.height=parseFloat($h);break;default:this[$J]=$h;}},$J._layoutLater=function(){this.parent&&this.parent._layoutLater();},$x(0,$J,"optimizeScrollRect",function(){return this._optimizeScrollRect;},function($J){this._optimizeScrollRect!=$J&&(this._optimizeScrollRect=$J,this.conchModel&&this.conchModel.optimizeScrollRect($J));}),$x(0,$J,"customRenderEnable",null,function($J){if($J&&(this._renderType|=1024,$I.isConchNode)){$f.CustomList.push(this);var $h=new $sJ("2d");$h._setContext(new CanvasRenderingContext2D()),this.customContext=new $m(0,0,$h),$h.context.setCanvasType&&$h.context.setCanvasType(2),this.conchModel.custom($h.context);}}),$x(0,$J,"cacheAsBitmap",function(){return"none"!==this.cacheAs;},function($J){this.cacheAs=$J?this._$P.hasFilter?"none":"normal":"none";}),$x(0,$J,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type;},function($J){var $h=this._$P.cacheCanvas;if($J!==($h?$h.type:"none")){if("none"!==$J)this._getBit(1)||this._setUpNoticeType(1),$h||($h=this._set$P("cacheCanvas",$$.getItemByClass("cacheCanvas",Object))),$h.type=$J,$h.reCache=!0,this._renderType|=16,"bitmap"==$J&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if($h){var $f=$h;$f&&$f.ctx&&($$.recover("RenderContext",$f.ctx),$f.ctx.canvas.size(0,0),$f.ctx=null),$$.recover("cacheCanvas",$h);}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0);}this.repaint();}}),$x(0,$J,"zOrder",function(){return this._zOrder;},function($J){this._zOrder!=$J&&(this._zOrder=$J,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder($J),this._parent&&($J&&this._parent._set$P("hasZorder",!0),$Q.timer.callLater(this._parent,this.updateZOrder)));}),$x(0,$J,"rotation",function(){return this._style._tf.rotate;},function($J){var $h=this.getStyle();if($h._tf.rotate!==$J){$h.setRotate($J),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate($J),this._renderType|=4;var $f=this._parent;$f&&0===$f._repaint&&($f._repaint=1,$f.parentRepaint());}}),$x(0,$J,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width;},function($J){this._width!==$J&&(this._width=$J,this.conchModel&&this.conchModel.size($J,this._height),this.repaint());}),$x(0,$J,"x",function(){return this._x;},function($J){if(this._x!==$J){if(this.destroyed)return;this._x=$J,this.conchModel&&this.conchModel.pos($J,this._y);var $h=this._parent;$h&&0===$h._repaint&&($h._repaint=1,$h.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint());}}),$x(0,$J,"globalScaleY",function(){for(var $J=1,$h=this;$h&&$h!==$Q.stage;)$J*=$h.scaleY,$h=$h.parent;return $J;}),$x(0,$J,"hitArea",function(){return this._$P.hitArea;},function($J){this._set$P("hitArea",$J);}),$x(0,$J,"staticCache",function(){return this._$P.staticCache;},function($J){this._set$P("staticCache",$J),$J||this.reCache();}),$x(0,$J,"texture",function(){return this._texture;},function($J){this._texture!=$J&&(this._texture=$J,this.graphics.cleanByTexture($J,0,0));}),$x(0,$J,"y",function(){return this._y;},function($J){if(this._y!==$J){if(this.destroyed)return;this._y=$J,this.conchModel&&this.conchModel.pos(this._x,$J);var $h=this._parent;$h&&0===$h._repaint&&($h._repaint=1,$h.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint());}}),$x(0,$J,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height;},function($J){this._height!==$J&&(this._height=$J,this.conchModel&&this.conchModel.size(this._width,$J),this.repaint());}),$x(0,$J,"blendMode",function(){return this._style.blendMode;},function($J){this.getStyle().blendMode=$J,this.conchModel&&this.conchModel.blendMode($J),$J&&"source-over"!=$J?this._renderType|=8:this._renderType&=-9,this.parentRepaint();}),$x(0,$J,"scaleX",function(){return this._style._tf.scaleX;},function($J){var $h=this.getStyle();if($h._tf.scaleX!==$J){$h.setScaleX($J),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($J,$h._tf.scaleY),this._renderType|=4;var $f=this._parent;$f&&0===$f._repaint&&($f._repaint=1,$f.parentRepaint());}}),$x(0,$J,"scaleY",function(){return this._style._tf.scaleY;},function($J){var $h=this.getStyle();if($h._tf.scaleY!==$J){$h.setScaleY($J),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($h._tf.scaleX,$J),this._renderType|=4;var $f=this._parent;$f&&0===$f._repaint&&($f._repaint=1,$f.parentRepaint());}}),$x(0,$J,"stage",function(){return $Q.stage;}),$x(0,$J,"skewX",function(){return this._style._tf.skewX;},function($J){var $h=this.getStyle();if($h._tf.skewX!==$J){$h.setSkewX($J),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($J,$h._tf.skewY),this._renderType|=4;var $f=this._parent;$f&&0===$f._repaint&&($f._repaint=1,$f.parentRepaint());}}),$x(0,$J,"scrollRect",function(){return this._style.scrollRect;},function($J){this.getStyle().scrollRect=$J,this.repaint(),$J?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect($J.x,$J.y,$J.width,$J.height)):(this._renderType&=-129,this.conchModel&&($f.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)));}),$x(0,$J,"skewY",function(){return this._style._tf.skewY;},function($J){var $h=this.getStyle();if($h._tf.skewY!==$J){$h.setSkewY($J),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($h._tf.skewX,$J),this._renderType|=4;var $f=this._parent;$f&&0===$f._repaint&&($f._repaint=1,$f.parentRepaint());}}),$x(0,$J,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform;},function($J){this._tfChanged=!1,(this._transform=$J)&&(this._x=$J.tx,this._y=$J.ty,$J.tx=$J.ty=0,this.conchModel&&this.conchModel.transform($J.a,$J.b,$J.c,$J.d,this._x,this._y)),$J?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint();}),$x(0,$J,"pivotX",function(){return this._style._tf.translateX;},function($J){this.getStyle().setTranslateX($J),this.conchModel&&this.conchModel.pivot($J,this._style._tf.translateY),this.repaint();}),$x(0,$J,"pivotY",function(){return this._style._tf.translateY;},function($J){this.getStyle().setTranslateY($J),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,$J),this.repaint();}),$x(0,$J,"alpha",function(){return this._style.alpha;},function($J){this._style&&this._style.alpha!==$J&&($J=$J<0?0:1<$J?1:$J,this.getStyle().alpha=$J,this.conchModel&&this.conchModel.alpha($J),1!==$J?this._renderType|=2:this._renderType&=-3,this.parentRepaint());}),$x(0,$J,"visible",function(){return this._style.visible;},function($J){this._style&&this._style.visible!==$J&&(this.getStyle().visible=$J,this.conchModel&&this.conchModel.visible($J),this.parentRepaint());}),$x(0,$J,"graphics",function(){return this._graphics||(this.graphics=$y.createGraphics());},function($J){this._graphics&&(this._graphics._sp=null),(this._graphics=$J)?(this._renderType&=-2,this._renderType|=512,($J._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&($f.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint();}),$x(0,$J,"filters",function(){return this._$P.filters;},function($J){$J&&0===$J.length&&($J=null),this._$P.filters!=$J&&(this._set$P("filters",$J?$J.slice():null),$I.isConchApp&&(this.conchModel&&($f.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),$I.isWebGL&&($J&&$J.length?this._renderType|=32:this._renderType&=-33),$J&&0<$J.length?(this._getBit(1)||this._setUpNoticeType(1),$I.isWebGL&&1==$J.length&&$J[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&($I.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint());}),$x(0,$J,"parent",$L.prototype._$get_parent,function($J){$Q.superSet($JJ,this,"parent",$J),$J&&this._getBit(2)&&this._$2__onDisplay();}),$x(0,$J,"mask",function(){return this._$P._mask;},function($J){$J&&this.mask&&this.mask._$P.maskParent||($J?(this.cacheAs="bitmap",this._set$P("_mask",$J),$J._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",$J),this.cacheAs="none"),this.conchModel&&this.conchModel.mask($J?$J.conchModel:null),this._renderType|=64,this.parentRepaint());}),$x(0,$J,"mouseEnabled",function(){return 1<this._mouseEnableState;},function($J){this._mouseEnableState=$J?2:1;}),$x(0,$J,"globalScaleX",function(){for(var $J=1,$h=this;$h&&$h!==$Q.stage;)$J*=$h.scaleX,$h=$h.parent;return $J;}),$x(0,$J,"mouseX",function(){return this.getMousePoint().x;}),$x(0,$J,"mouseY",function(){return this.getMousePoint().y;}),$f.fromImage=function($J){return new $f().loadImage($J);},$f._cachePool=[],$f.CustomList=[],$S($f,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=$k.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):"";}]),$f;}($JJ),$RJ=function($J){function $h($J){this._audio=null,this._onEnd=null,this._resumePlay=null,$h.__super.call(this),this._onEnd=$E.bind(this.__onEnd,this),this._resumePlay=$E.bind(this.__resumePlay,this),$J.addEventListener("ended",this._onEnd),this._audio=$J;}$q($h,"laya.media.h5audio.AudioSoundChannel",$nJ);var $f=$h.prototype;return $f.__onEnd=function(){if(1==this.loops)return this.completeHandler&&($Q.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0);},$f.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,$a.container.appendChild(this._audio),this._audio.play();}catch($J){this.event("error");}},$f.play=function($J){this.isStopped=!1;try{this._audio.playbackRate=$G.playbackRate,this._audio.currentTime=this.startTime;}catch($J){return void this._audio.addEventListener("canplay",this._resumePlay);}$G.addChannel(this),$a.container.appendChild(this._audio),!$J&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play();},$f.stop=function(){this.isStopped=!0,$G.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&$I.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),$a.onIE||this._audio!=$fJ._musicAudio&&$$.recover("audio:"+this.url,this._audio),$a.removeElement(this._audio),this._audio=null);},$f.pause=function(){this.isStopped=!0,$G.removeChannel(this),"pause"in this._audio&&this._audio.pause();},$f.resume=function(){this._audio&&(this.isStopped=!1,$G.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play());},$x(0,$f,"position",function(){return this._audio?this._audio.currentTime:0;}),$x(0,$f,"duration",function(){return this._audio?this._audio.duration:0;}),$x(0,$f,"volume",function(){return this._audio?this._audio.volume:1;},function($J){this._audio&&(this._audio.volume=$J);}),$h;}(),$lJ=function($J){function $h(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=$TJ.ctx,$h.__super.call(this),this._onPlayEnd=$E.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode();}$q($h,"laya.media.webaudio.WebAudioSoundChannel",$nJ);var $f=$h.prototype;return $f.play=function($J){if($G.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var $h=this.context,$f=this.gain,$n=$h.createBufferSource();(this.bufferSource=$n).buffer=this.audioBuffer,$n.connect($f),$f&&$f.disconnect(),$f.connect($h.destination),$n.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=$a.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&($n.loop=!0),$n.playbackRate.setTargetAtTime?$n.playbackRate.setTargetAtTime($G.playbackRate,this.context.currentTime,.1):$n.playbackRate.value=$G.playbackRate,$n.start(0,this.startTime),!$J&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0;}},$f.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&($Q.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0);},$f._clearBufferSource=function(){if(this.bufferSource){var $J=this.bufferSource;$J.stop?$J.stop(0):$J.noteOff(0),$J.disconnect(0),$J.onended=null,$h._tryCleanFailed||this._tryClearBuffer($J),this.bufferSource=null;}},$f._tryClearBuffer=function($J){try{$J.buffer=null;}catch($J){$h._tryCleanFailed=!0;}},$f.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,$G.removeChannel(this),this.startHandler=null,this.completeHandler=null;},$f.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,$G.removeChannel(this);},$f.resume=function(){this.startTime=this._pauseTime,this.play(!1);},$x(0,$f,"position",function(){return this.bufferSource?($a.now()-this._startTime)/1e3+this.startTime:0;}),$x(0,$f,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0;}),$x(0,$f,"volume",function(){return this._volume;},function($J){this.isStopped||(this._volume=$J,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime($J,this.context.currentTime,.1):this.gain.gain.value=$J);}),$h._tryCleanFailed=!1,$h;}(),$iJ=function($J){function $h(){$h.__super.call(this),this._w=0,this._h=0;}$q($h,"laya.resource.Bitmap",$YJ);var $f=$h.prototype;return $x(0,$f,"width",function(){return this._w;}),$x(0,$f,"height",function(){return this._h;}),$x(0,$f,"source",function(){return this._source;}),$h;}(),$qJ=function($h){function $J(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,$J.__super.call(this),this._interval=$n.animationInterval,this._setUpNoticeType(1);}$q($J,"laya.display.AnimationPlayerBase",$h);var $f=$J.prototype;return $f.play=function($J,$h,$f,$n){void 0===$J&&($J=0),void 0===$h&&($h=!0),void 0===$f&&($f=""),void 0===$n&&($n=!0),this._isPlaying=!0,this.index="string"==typeof $J?this._getFrameByLabel($J):$J,this.loop=$h,this._actionName=$f,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0);},$f._getFrameByLabel=function($J){var $h=0;for($h=0;$h<this._count;$h++)if(this._labels[$h]&&0<=this._labels[$h].indexOf($J))return $h;return 0;},$f._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete");}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete");}this.index=this._index;},$f._setControlNode=function($J){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=$J)&&$J!=this&&($J.on("display",this,this._checkResumePlaying),$J.on("undisplay",this,this._checkResumePlaying));},$f._setDisplay=function($J){$h.prototype._setDisplay.call(this,$J),this._checkResumePlaying();},$f._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop));},$f.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop);},$f.addLabel=function($J,$h){this._labels||(this._labels={}),this._labels[$h]||(this._labels[$h]=[]),this._labels[$h].push($J);},$f.removeLabel=function($J){if($J){if(this._labels)for(var $h in this._labels)this._removeLabelFromLabelList(this._labels[$h],$J);}else this._labels=null;},$f._removeLabelFromLabelList=function($J,$h){if($J)for(var $f=$J.length-1;0<=$f;$f--)$J[$f]==$h&&$J.splice($f,1);},$f.gotoAndStop=function($J){this.index="string"==typeof $J?this._getFrameByLabel($J):$J,this.stop();},$f._displayToIndex=function($J){},$f.clear=function(){this.stop(),this._labels=null;},$x(0,$f,"interval",function(){return this._interval;},function($J){this._interval!=$J&&(this._frameRateChanged=!0,this._interval=$J,this._isPlaying&&0<$J&&this.timerLoop($J,this,this._frameLoop,null,!0,!0));}),$x(0,$f,"isPlaying",function(){return this._isPlaying;}),$x(0,$f,"index",function(){return this._index;},function($J){if(this._index=$J,this._displayToIndex($J),this._labels&&this._labels[$J])for(var $h=this._labels[$J],$f=0,$n=$h.length;$f<$n;$f++)this.event("label",$h[$f]);}),$x(0,$f,"count",function(){return this._count;}),$J.WRAP_POSITIVE=0,$J.WRAP_REVERSE=1,$J.WRAP_PINGPONG=2,$J;}($jJ),$oJ=function($h){function $l(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,$l.__super.call(this),this.overflow=$l.VISIBLE,this._style=new $hJ(this),this._style.wordWrap=!1;}$q($l,"laya.display.Text",$h);var $J=$l.prototype;return $J.destroy=function($J){void 0===$J&&($J=!0),$h.prototype.destroy.call(this,$J),this._lines=null,this._words&&(this._words.length=0,this._words=null);},$J._getBoundPointsM=function($J){void 0===$J&&($J=!1);var $h=$g.TEMP;return $h.setTo(0,0,this.width,this.height),$h._getBoundPoints();},$J.getGraphicBounds=function($J){void 0===$J&&($J=!1);var $h=$g.TEMP;return $h.setTo(0,0,this.width,this.height),$h;},$J._getCSSStyle=function(){return this._style;},$J.lang=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x){if($J=$l.langPacks&&$l.langPacks[$J]?$l.langPacks[$J]:$J,arguments.length<2)this._text=$J;else{for(var $j=0,$R=arguments.length;$j<$R;$j++)$J=$J.replace("{"+$j+"}",arguments[$j+1]);this._text=$J;}},$J._isPassWordMode=function(){var $J=this._style.password;return"prompt"in this&&this.prompt==this._text&&($J=!1),$J;},$J._getPassWordTxt=function($J){var $h;$h="";for(var $f=$J.length;0<$f;$f--)$h+="●";return $h;},$J.renderText=function($J,$h){var $f=this.graphics;$f.clear(!0);var $n=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+($a.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);$a.context.font=$n;var $L=this.padding,$T=$L[3],$k="left",$u=this._lines,$S=this.leading+this._charSize.height,$Y=this._currBitmapFont;$Y&&($S=this.leading+$Y.getMaxHeight());var $x=$L[0];if(!$Y&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?($k="right",$T=this._width-$L[1]):"center"==this.align&&($k="center",$T=.5*this._width+$L[3]-$L[1])),0<this._height){var $j=this._textHeight>this._height?"top":this.valign;"middle"===$j?$x=.5*(this._height-$h*$S)+$L[0]-$L[2]:"bottom"===$j&&($x=this._height-$h*$S-$L[2]);}var $R=this._style;if($Y&&$Y.autoScaleSize)var $l=$Y.fontSize/this.fontSize;if(this._clipPoint)if($f.save(),$Y&&$Y.autoScaleSize){var $i=0,$q=0;$i=this._width?this._width-$L[3]-$L[1]:this._textWidth,$q=this._height?this._height-$L[0]-$L[2]:this._textHeight,$i*=$l,$q*=$l,$f.clipRect($L[3],$L[0],$i,$q);}else $f.clipRect($L[3],$L[0],this._width?this._width-$L[3]-$L[1]:this._textWidth,this._height?this._height-$L[0]-$L[2]:this._textHeight);var $o=$R.password;"prompt"in this&&this.prompt==this._text&&($o=!1);for(var $r=0,$_=0,$s=Math.min(this._lines.length,$h+$J)||1,$d=$J;$d<$s;$d++){var $p,$U=$u[$d];if($o){var $Q=$U.length;$U="";for(var $D=$Q;0<$D;$D--)$U+="●";}if($r=$T-(this._clipPoint?this._clipPoint.x:0),$_=$x+$S*$d-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline($k,$r,$_,$d),$Y){var $g=this.width;$Y.autoScaleSize&&($g=this.width*$l),$Y.drawText($U,this,$r,$_,this.align,$g);}else $I.isWebGL?(this._words||(this._words=[]),($p=this._words.length>$d-$J?this._words[$d-$J]:new $K()).setText($U)):$p=$U,$R.stroke?$f.fillBorderText($p,$r,$_,$n,this.color,$R.strokeColor,$R.stroke,$k):$f.fillText($p,$r,$_,$n,this.color,$k);}if($Y&&$Y.autoScaleSize){var $F=1/$l;this.scale($F,$F);}this._clipPoint&&$f.restore(),this._startX=$T,this._startY=$x;},$J.drawUnderline=function($J,$h,$f,$n){var $L=this._lineWidths[$n];switch($J){case"center":$h-=$L/2;break;case"right":$h-=$L;}$f+=this._charSize.height,this._graphics.drawLine($h,$f,$h+$L,$f,this.underlineColor||this.color,1);},$J.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);$a.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new $D(0,0)):this._clipPoint=null;var $J=this._lines.length;if(this.overflow!=$l.VISIBLE){var $h=this.overflow==$l.HIDDEN?Math.floor:Math.ceil;$J=Math.min($J,$h((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)));}var $f=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText($f,$J),this.repaint();},$J.evalTextSize=function(){var $J,$h=NaN;$J=Math.max.apply(this,this._lineWidths),$h=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],$J==this._textWidth&&$h==this._textHeight||(this._textWidth=$J,this._textHeight=$h,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight));},$J.checkEnabledViewportOrNot=function(){return this.overflow==$l.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height);},$J.changeText=function($J){this._text!==$J&&(this.lang($J+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset());},$J.parseLines=function($J){var $h=this.wordWrap||this.overflow==$l.HIDDEN;if($h)var $f=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var $n=$E.contextMeasureText($l._testWord);$I.isConchApp&&0===$n.width&&0===$n.height&&($n=$E.contextMeasureText("W")),this._charSize.width=$n.width,this._charSize.height=$n.height||this.fontSize;}for(var $L=$J.replace(/\r\n/g,"\n").split("\n"),$T=0,$k=$L.length;$T<$k;$T++){var $u=$L[$T];$h?this.parseLine($u,$f):(this._lineWidths.push(this.getTextWidth($u)),this._lines.push($u));}},$J.parseLine=function($J,$h){$a.context;var $f,$n=this._lines,$L=0,$T=NaN,$k=NaN,$u=0;if(($T=this.getTextWidth($J))<=$h)return $n.push($J),void this._lineWidths.push($T);$T=this._charSize.width,0==($L=Math.floor($h/$T))&&($L=1),$k=$T=this.getTextWidth($J.substring(0,$L));for(var $S=$L,$Y=$J.length;$S<$Y;$S++)if($h<($k+=$T=this.getTextWidth($J.charAt($S))))if(this.wordWrap){var $x=$J.substring($u,$S);if($x.charCodeAt($x.length-1)<255?($f=/(?:\w|-)+$/.exec($x))&&($S=$f.index+$u,0==$f.index?$S+=$x.length:$x=$J.substring($u,$S)):$l.RightToLeft&&($f=/([\u0600-\u06FF])+$/.exec($x))&&($S=$f.index+$u,0==$f.index?$S+=$x.length:$x=$J.substring($u,$S)),$n.push($x),this._lineWidths.push($k-$T),!(($u=$S)+$L<$Y)){$n.push($J.substring($u,$Y)),this._lineWidths.push(this.getTextWidth($n[$n.length-1])),$u=-1;break;}$S+=$L,$k=$T=this.getTextWidth($J.substring($u,$S)),$S--;}else if(this.overflow==$l.HIDDEN)return $n.push($J.substring(0,$S)),void this._lineWidths.push(this.getTextWidth($n[$n.length-1]));this.wordWrap&&-1!=$u&&($n.push($J.substring($u,$Y)),this._lineWidths.push(this.getTextWidth($n[$n.length-1])));},$J.getTextWidth=function($J){return this._currBitmapFont?this._currBitmapFont.getTextWidth($J):$E.contextMeasureText($J).width;},$J.getWordWrapWidth=function(){var $J=this.padding,$h=NaN;return($h=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&($h=this.wordWrap?100:$a.width),$h<=0&&($h=100),$h-$J[3]-$J[1];},$J.getCharPoint=function($J,$h){this._isChanged&&$Q.timer.runCallLater(this,this.typeset);for(var $f=0,$n=this._lines,$L=0,$T=0,$k=$n.length;$T<$k;$T++){if($J<($f+=$n[$T].length)){var $u=$T;break;}$L=$f;}var $S=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;$a.context.font=$S;var $Y=this.getTextWidth(this._text.substring($L,$J));return($h||new $D()).setTo(this._startX+$Y-(this._clipPoint?this._clipPoint.x:0),this._startY+$u*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0));},$x(0,$J,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3];},function($J){$J!=this._width&&($Q.superSet($jJ,this,"width",$J),this.isChanged=!0);}),$x(0,$J,"textWidth",function(){return this._isChanged&&$Q.timer.runCallLater(this,this.typeset),this._textWidth;}),$x(0,$J,"height",function(){return this._height?this._height:this.textHeight;},function($J){$J!=this._height&&($Q.superSet($jJ,this,"height",$J),this.isChanged=!0);}),$x(0,$J,"textHeight",function(){return this._isChanged&&$Q.timer.runCallLater(this,this.typeset),this._textHeight;}),$x(0,$J,"padding",function(){return this._getCSSStyle().padding;},function($J){this._getCSSStyle().padding=$J,this.isChanged=!0;}),$x(0,$J,"bold",function(){return this._getCSSStyle().bold;},function($J){this._getCSSStyle().bold=$J,this.isChanged=!0;}),$x(0,$J,"text",function(){return this._text||"";},function($J){this._text!==$J&&(this.lang($J+""),this.isChanged=!0,this.event("change"));}),$x(0,$J,"color",function(){return this._getCSSStyle().color;},function($J){this._getCSSStyle().color!=$J&&(this._getCSSStyle().color=$J,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0);}),$x(0,$J,"font",function(){return this._getCSSStyle().fontFamily;},function($J){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),$l._bitmapFonts&&$l._bitmapFonts[$J]&&(this._currBitmapFont=$l._bitmapFonts[$J]),this._getCSSStyle().fontFamily=$J,this.isChanged=!0;}),$x(0,$J,"fontSize",function(){return this._getCSSStyle().fontSize;},function($J){this._getCSSStyle().fontSize=$J,this.isChanged=!0;}),$x(0,$J,"italic",function(){return this._getCSSStyle().italic;},function($J){this._getCSSStyle().italic=$J,this.isChanged=!0;}),$x(0,$J,"align",function(){return this._getCSSStyle().align;},function($J){this._getCSSStyle().align=$J,this.isChanged=!0;}),$x(0,$J,"valign",function(){return this._getCSSStyle().valign;},function($J){this._getCSSStyle().valign=$J,this.isChanged=!0;}),$x(0,$J,"wordWrap",function(){return this._getCSSStyle().wordWrap;},function($J){this._getCSSStyle().wordWrap=$J,this.isChanged=!0;}),$x(0,$J,"leading",function(){return this._getCSSStyle().leading;},function($J){this._getCSSStyle().leading=$J,this.isChanged=!0;}),$x(0,$J,"bgColor",function(){return this._getCSSStyle().backgroundColor;},function($J){this._getCSSStyle().backgroundColor=$J,this.isChanged=!0;}),$x(0,$J,"borderColor",function(){return this._getCSSStyle().borderColor;},function($J){this._getCSSStyle().borderColor=$J,this.isChanged=!0;}),$x(0,$J,"stroke",function(){return this._getCSSStyle().stroke;},function($J){this._getCSSStyle().stroke=$J,this.isChanged=!0;}),$x(0,$J,"strokeColor",function(){return this._getCSSStyle().strokeColor;},function($J){this._getCSSStyle().strokeColor=$J,this.isChanged=!0;}),$x(0,$J,"isChanged",null,function($J){this._isChanged!==$J&&(this._isChanged=$J)&&$Q.timer.callLater(this,this.typeset);}),$x(0,$J,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0;},function($J){if(!(this.overflow!=$l.SCROLL||this.textWidth<this._width)&&this._clipPoint){$J=$J<this.padding[3]?this.padding[3]:$J;var $h=this._textWidth-this._width;$J=$h<$J?$h:$J;var $f=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=$J,this.renderText(this._lastVisibleLineIndex,$f);}}),$x(0,$J,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0;},function($J){if(!(this.overflow!=$l.SCROLL||this.textHeight<this._height)&&this._clipPoint){$J=$J<this.padding[0]?this.padding[0]:$J;var $h=this._textHeight-this._height,$f=($J=$h<$J?$h:$J)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=$f;var $n=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=$J,this.renderText($f,$n);}}),$x(0,$J,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width;}),$x(0,$J,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height;}),$x(0,$J,"lines",function(){return this._isChanged&&this.typeset(),this._lines;}),$x(0,$J,"underlineColor",function(){return this._underlineColor;},function($J){this._underlineColor=$J,this._isChanged=!0,this.typeset();}),$l.registerBitmapFont=function($J,$h){$l._bitmapFonts||($l._bitmapFonts={}),$l._bitmapFonts[$J]=$h;},$l.unregisterBitmapFont=function($J,$h){if(void 0===$h&&($h=!0),$l._bitmapFonts&&$l._bitmapFonts[$J]){var $f=$l._bitmapFonts[$J];$h&&$f.destroy(),delete $l._bitmapFonts[$J];}},$l.setTextRightToLeft=function(){var $J;($J=$a.canvas.source.style).display="none",$J.position="absolute",$J.direction="rtl",$I._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,$a.document.body.appendChild($a.canvas.source);},$l.supportFont=function($J){$a.context.font="10px sans-serif";var $h=$E.contextMeasureText("abcji").width;$a.context.font="10px "+$J;var $f=$E.contextMeasureText("abcji").width;return console.log($h,$f),$h!==$f;},$l._testWord="游",$l.langPacks=null,$l.VISIBLE="visible",$l.SCROLL="scroll",$l.HIDDEN="hidden",$l.CharacterCache=!0,$l.RightToLeft=!1,$l._bitmapFonts=null,$S($l,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"};}]),$l;}($jJ),$rJ=function($j){function $k(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",$k.__super.call(this),this.offset=new $D(),this._canvasTransform=new $O(),this._previousOrientation=$a.window.orientation;var $h=this;this.transform=$O.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var $J=$a.window,$f=this;$J.addEventListener("focus",function(){$h._isFocused=!0,$f.event("focus"),$f.event("focuschange");}),$J.addEventListener("blur",function(){$h._isFocused=!1,$f.event("blur"),$f.event("focuschange"),$f._isInputting()&&($pJ.inputElement.target.focus=!1);});var $n="visibilityState",$L="visibilitychange",$T=$J.document;void 0!==$T.hidden?($L="visibilitychange",$n="visibilityState"):void 0!==$T.mozHidden?($L="mozvisibilitychange",$n="mozVisibilityState"):void 0!==$T.msHidden?($L="msvisibilitychange",$n="msVisibilityState"):void 0!==$T.webkitHidden&&($L="webkitvisibilitychange",$n="webkitVisibilityState"),$J.document.addEventListener($L,function(){"hidden"==$a.document[$n]?$f._setStageVisible(!1):$f._setStageVisible(!0);}),$J.document.addEventListener("qbrowserVisibilityChange",function($J){$f._setStageVisible(!$J.hidden);}),$J.addEventListener("resize",function(){var $J=$a.window.orientation;null!=$J&&$J!=$h._previousOrientation&&$f._isInputting()&&($pJ.inputElement.target.focus=!1),$h._previousOrientation=$J,$f._isInputting()||$f._resetCanvas();}),$J.addEventListener("orientationchange",function($J){$f._resetCanvas();}),this.on("mousemove",this,this._onmouseMove),$a.onMobile&&this.on("mousedown",this,this._onmouseMove);}$q($k,"laya.display.Stage",$j);var $J=$k.prototype;return $J._setStageVisible=function($J){this._isVisibility!=$J&&(this._isVisibility=$J,this._isVisibility||this._isInputting()&&($pJ.inputElement.target.focus=!1),this.event("visibilitychange"));},$J._isInputting=function(){return $a.onMobile&&$pJ.isInputting;},$J._changeCanvasSize=function(){this.setScreenSize($a.clientWidth*$a.pixelRatio,$a.clientHeight*$a.pixelRatio);},$J._resetCanvas=function(){if(this.screenAdaptationEnabled){var $J=$I._mainCanvas;$J.source.style;$J.size(1,1),$Q.timer.once(100,this,this._changeCanvasSize);}},$J.setScreenSize=function($J,$h){var $f=!1;if("none"!==this._screenMode&&($f=($J/$h<1?"vertical":"horizontal")!==this._screenMode)){var $n=$h;$h=$J,$J=$n;}this.canvasRotation=$f;var $L=$I._mainCanvas,$T=$L.source.style,$k=this._canvasTransform.identity(),$u=this._scaleMode,$S=$J/this.designWidth,$Y=$h/this.designHeight,$x=this.designWidth,$j=this.designHeight,$R=$J,$l=$h,$i=$a.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,$u){case"noscale":$S=$Y=1,$R=this.designWidth,$l=this.designHeight;break;case"showall":$S=$Y=Math.min($S,$Y),$x=$R=Math.round(this.designWidth*$S),$j=$l=Math.round(this.designHeight*$Y);break;case"noborder":$S=$Y=Math.max($S,$Y),$R=Math.round(this.designWidth*$S),$l=Math.round(this.designHeight*$Y);break;case"full":$S=$Y=1,this._width=$x=$J,this._height=$j=$h;break;case"fixedwidth":$Y=$S,this._height=$j=Math.round($h/$S);break;case"fixedheight":$S=$Y,this._width=$x=Math.round($J/$Y);break;case"fixedauto":$J/$h<this.designWidth/this.designHeight?($Y=$S,this._height=$j=Math.round($h/$S)):($S=$Y,this._width=$x=Math.round($J/$Y));}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,$x=$x+1&2147483646,$j=$j+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),$S*=this.scaleX,$Y*=this.scaleY,1===$S&&1===$Y?this.transform.identity():(this.transform.a=this._formatData($S/($R/$x)),this.transform.d=this._formatData($Y/($l/$j)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),$L.size($x,$j),$y.changeWebGLSize($x,$j),$k.scale($R/$x/$i,$l/$j/$i),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=($J-$R)/$i:this.offset.x=.5*($J-$R)/$i,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=($h-$l)/$i:this.offset.y=.5*($h-$l)/$i,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),$k.translate(this.offset.x,this.offset.y),this.canvasDegree=0,$f&&("horizontal"===this._screenMode?($k.rotate(Math.PI/2),$k.translate($h/$i,0),this.canvasDegree=90):($k.rotate(-Math.PI/2),$k.translate(0,$J/$i),this.canvasDegree=-90)),$k.a=this._formatData($k.a),$k.d=this._formatData($k.d),$k.tx=this._formatData($k.tx),$k.ty=this._formatData($k.ty),$T.transformOrigin=$T.webkitTransformOrigin=$T.msTransformOrigin=$T.mozTransformOrigin=$T.oTransformOrigin="0px 0px 0px",$T.transform=$T.webkitTransform=$T.msTransform=$T.mozTransform=$T.oTransform="matrix("+$k.toString()+")",$k.translate(parseInt($T.left)||0,parseInt($T.top)||0),this.visible=!0,this._repaint=1,this.event("resize");},$J._formatData=function($J){return Math.abs($J)<1e-6?0:Math.abs(1-$J)<.001?0<$J?1:-1:$J;},$J.getMousePoint=function(){return $D.TEMP.setTo(this.mouseX,this.mouseY);},$J.repaint=function(){this._repaint=1;},$J.parentRepaint=function(){},$J._loop=function(){return this.render($I.context,0,0),!0;},$J._onmouseMove=function($J){this._mouseMoveTime=$a.now();},$J.getTimeFromFrameStart=function(){return $a.now()-this._frameStartTime;},$J.render=function($J,$h,$f){if("sleep"===this._frameRate&&!$I.isConchApp){var $n=$a.now();if(!(1e3<=$n-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&($M.loopCount++,$i.instance.runEvent(),$Q.timer._update()));this._frameStartTime=$n;}if(this._renderCount++,$I.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=$a.now();var $L="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),$T=this._renderCount%2==0;if($M.renderSlow=!$L,$L||$T||$I.isConchApp){var $k;$M.loopCount++,$i.instance.runEvent(),$Q.timer._update(),$y.update3DLoop();var $u=0,$S=0;if($I.isConchNode)for($u=0,$S=this._scenes.length;$u<$S;$u++)($k=this._scenes[$u])&&$k._updateSceneConch();else for($u=0,$S=this._scenes.length;$u<$S;$u++)($k=this._scenes[$u])&&$k._updateScene();if($I.isConchNode){var $Y=$jJ.CustomList;for($u=0,$S=$Y.length;$u<$S;$u++){var $x=$Y[$u];$x.customRender($x.customContext,0,0);}return;}}$I.isConchNode||this.renderingEnabled&&($L||!$T||$I.isConchWebGL)&&($I.isWebGL?$I.WebGL.mainContext&&!$I.WebGL.mainContext.isContextLost()&&($J.clear(),$j.prototype.render.call(this,$J,$h,$f),$M._show&&$M._sp&&$M._sp.render($J,$h,$f),$y.clear(this._bgColor),$y.beginFlush(),$J.flush(),$y.endFinish(),$N.instance&&$N.getInstance().endDispose()):($y.clear(this._bgColor),$j.prototype.render.call(this,$J,$h,$f),$M._show&&$M._sp&&$M._sp.render($J,$h,$f)));}else this._renderCount%5==0&&($M.loopCount++,$i.instance.runEvent(),$Q.timer._update());},$J._requestFullscreen=function(){var $J=$a.document.documentElement;$J.requestFullscreen?$J.requestFullscreen():$J.mozRequestFullScreen?$J.mozRequestFullScreen():$J.webkitRequestFullscreen?$J.webkitRequestFullscreen():$J.msRequestFullscreen&&$J.msRequestFullscreen();},$J._fullScreenChanged=function(){$Q.stage.event("fullscreenchange");},$J.exitFullscreen=function(){var $J=$a.document;$J.exitFullscreen?$J.exitFullscreen():$J.mozCancelFullScreen?$J.mozCancelFullScreen():$J.webkitExitFullscreen&&$J.webkitExitFullscreen();},$x(0,$J,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1;}),$x(0,$J,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight;}),$x(0,$J,"frameRate",function(){return this._frameRate;},function($J){if(this._frameRate=$J,$I.isConchApp)switch(this._frameRate){case"slow":$a.window.conch&&$a.window.conchConfig.setSlowFrame&&$a.window.conchConfig.setSlowFrame(!0);break;case"fast":$a.window.conch&&$a.window.conchConfig.setSlowFrame&&$a.window.conchConfig.setSlowFrame(!1);break;case"mouse":$a.window.conch&&$a.window.conchConfig.setMouseFrame&&$a.window.conchConfig.setMouseFrame(2e3);break;case"sleep":$a.window.conch&&$a.window.conchConfig.setLimitFPS&&$a.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.");}}),$x(0,$J,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1;}),$x(0,$J,"width",$j.prototype._$get_width,function($J){this.designWidth=$J,$Q.superSet($jJ,this,"width",$J),$Q.timer.callLater(this,this._changeCanvasSize);}),$x(0,$J,"alignH",function(){return this._alignH;},function($J){this._alignH=$J,$Q.timer.callLater(this,this._changeCanvasSize);}),$x(0,$J,"isFocused",function(){return this._isFocused;}),$x(0,$J,"height",$j.prototype._$get_height,function($J){this.designHeight=$J,$Q.superSet($jJ,this,"height",$J),$Q.timer.callLater(this,this._changeCanvasSize);}),$x(0,$J,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||$O.create();},$j.prototype._$set_transform),$x(0,$J,"isVisibility",function(){return this._isVisibility;}),$x(0,$J,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth;}),$x(0,$J,"scaleMode",function(){return this._scaleMode;},function($J){this._scaleMode=$J,$Q.timer.callLater(this,this._changeCanvasSize);}),$x(0,$J,"alignV",function(){return this._alignV;},function($J){this._alignV=$J,$Q.timer.callLater(this,this._changeCanvasSize);}),$x(0,$J,"bgColor",function(){return this._bgColor;},function($J){this._bgColor=$J,this.conchModel&&this.conchModel.bgColor($J),$I.isWebGL&&($J?$k._wgColor=$e.create($J)._color:$a.onMiniGame||($k._wgColor=null)),$a.onLimixiu?$k._wgColor=$e.create($J)._color:$I.canvas.style.background=$J||"none";}),$x(0,$J,"mouseX",function(){return Math.round($i.instance.mouseX/this.clientScaleX);}),$x(0,$J,"mouseY",function(){return Math.round($i.instance.mouseY/this.clientScaleY);}),$x(0,$J,"screenMode",function(){return this._screenMode;},function($J){this._screenMode=$J;}),$x(0,$J,"visible",$j.prototype._$get_visible,function($J){this.visible!==$J&&($Q.superSet($jJ,this,"visible",$J),$I._mainCanvas.source.style.visibility=$J?"visible":"hidden");}),$x(0,$J,"fullScreenEnabled",null,function($J){var $h=$a.document,$f=$I.canvas;$J?($f.addEventListener("mousedown",this._requestFullscreen),$f.addEventListener("touchstart",this._requestFullscreen),$h.addEventListener("fullscreenchange",this._fullScreenChanged),$h.addEventListener("mozfullscreenchange",this._fullScreenChanged),$h.addEventListener("webkitfullscreenchange",this._fullScreenChanged),$h.addEventListener("msfullscreenchange",this._fullScreenChanged)):($f.removeEventListener("mousedown",this._requestFullscreen),$f.removeEventListener("touchstart",this._requestFullscreen),$h.removeEventListener("fullscreenchange",this._fullScreenChanged),$h.removeEventListener("mozfullscreenchange",this._fullScreenChanged),$h.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),$h.removeEventListener("msfullscreenchange",this._fullScreenChanged));}),$k.SCALE_NOSCALE="noscale",$k.SCALE_EXACTFIT="exactfit",$k.SCALE_SHOWALL="showall",$k.SCALE_NOBORDER="noborder",$k.SCALE_FULL="full",$k.SCALE_FIXED_WIDTH="fixedwidth",$k.SCALE_FIXED_HEIGHT="fixedheight",$k.SCALE_FIXED_AUTO="fixedauto",$k.ALIGN_LEFT="left",$k.ALIGN_RIGHT="right",$k.ALIGN_CENTER="center",$k.ALIGN_TOP="top",$k.ALIGN_MIDDLE="middle",$k.ALIGN_BOTTOM="bottom",$k.SCREEN_NONE="none",$k.SCREEN_HORIZONTAL="horizontal",$k.SCREEN_VERTICAL="vertical",$k.FRAME_FAST="fast",$k.FRAME_SLOW="slow",$k.FRAME_MOUSE="mouse",$k.FRAME_SLEEP="sleep",$k.FRAME_MOUSE_THREDHOLD=2e3,$S($k,["_wgColor",function(){return this._wgColor=[0,0,0,1];}]),$k;}($jJ),$_J=(function($J){function $h(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,$h.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange);}$q($h,"laya.media.SoundNode",$jJ);var $f=$h.prototype;$f._onParentChange=function(){this.target=this.parent;},$f.play=function($J,$h){void 0===$J&&($J=1),isNaN($J)&&($J=1),this.url&&(this.stop(),this._channel=$G.playSound(this.url,$J,null,$h));},$f.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null;},$f._setPlayAction=function($J,$h,$f,$n){void 0===$n&&($n=!0),this[$f]&&$J&&($n?$J.on($h,this,this[$f]):$J.off($h,this,this[$f]));},$f._setPlayActions=function($J,$h,$f,$n){if(void 0===$n&&($n=!0),$J&&$h){var $L,$T=$h.split(","),$k=0;for($L=$T.length,$k=0;$k<$L;$k++)this._setPlayAction($J,$T[$k],$f,$n);}},$x(0,$f,"playEvent",null,function($J){(this._playEvents=$J)&&this._tar&&this._setPlayActions(this._tar,$J,"play");}),$x(0,$f,"target",null,function($J){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=$J,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0));}),$x(0,$f,"stopEvent",null,function($J){(this._stopEvents=$J)&&this._tar&&this._setPlayActions(this._tar,$J,"stop");});}(),function($J){function $h(){this._src=null,this._onload=null,this._onerror=null,$h.__super.call(this);}$q($h,"laya.resource.FileBitmap",$iJ);var $f=$h.prototype;return $x(0,$f,"src",function(){return this._src;},function($J){this._src=$J;}),$x(0,$f,"onload",null,function($J){}),$x(0,$f,"onerror",null,function($J){}),$h;}()),$sJ=function($J){function $f($J,$h){this._is2D=!1,$f.__super.call(this);var $n=this;if(this._source=this,"2D"===$J||"AUTO"===$J&&!$I.isWebGL){this._is2D=!0,this._source=$h||$a.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var $L=this;$L.getContext=function($J,$h){if($n._ctx)return $n._ctx;var $f=$n._ctx=$n._source.getContext($J,$h);return $f&&($f._canvas=$L,$I.isFlash||$a.onLimixiu||($f.size=function($J,$h){})),$f;};}this.uri="HTMLCanvas_"+this.id,this.lock=!0;}$q($f,"laya.resource.HTMLCanvas",$iJ);var $h=$f.prototype;return $h.clear=function(){this._ctx&&this._ctx.clear();},$h.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this);},$h.release=function(){},$h._setContext=function($J){this._ctx=$J;},$h.getContext=function($J,$h){return this._ctx?this._ctx:this._ctx=$f._createContext(this);},$h.getMemSize=function(){return 0;},$h.size=function($J,$h){(this._w!=$J||this._h!=$h||this._source&&(this._source.width!=$J||this._source.height!=$h))&&(this._w=$J,this._h=$h,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size($J,$h),this._source&&(this._source.height=$h,this._source.width=$J));},$h.getCanvas=function(){return this._source;},$h.toBase64=function($J,$h,$f){if(this._source)if($I.isConchApp&&this._source.toBase64)this._source.toBase64($J,$h,$f);else{var $n=this._source.toDataURL($J,$h);$f.call(this,$n);}},$x(0,$h,"context",function(){return this._ctx;}),$x(0,$h,"asBitmap",null,function($J){}),$f.create=function($J,$h){return new $f($J,$h);},$f.TYPE2D="2D",$f.TYPE3D="3D",$f.TYPEAUTO="AUTO",$f._createContext=null,$f;}(),$dJ=(function($J){function $S($J,$h,$f,$n,$L,$T,$k,$u){throw $S.__super.call(this),new Error("不允许new！");}$q($S,"laya.resource.HTMLSubImage",$iJ),$S.create=function($J,$h,$f,$n,$L,$T,$k,$u){return void 0===$u&&($u=!1),new $S($J,$h,$f,$n,$L,$T,$k,$u);};}(),function($J){function $j(){this._frames=null,this._url=null,$j.__super.call(this),this._setControlNode(this);}$q($j,"laya.display.Animation",$J);var $h=$j.prototype;$h.destroy=function($J){void 0===$J&&($J=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,$J),this._frames=null,this._labels=null;},$h.play=function($J,$h,$f,$n){void 0===$J&&($J=0),void 0===$h&&($h=!0),void 0===$f&&($f=""),void 0===$n&&($n=!0),$f&&this._setFramesFromCache($f,$n),this._isPlaying=!0,this.index="string"==typeof $J?this._getFrameByLabel($J):$J,this.loop=$h,this._actionName=$f,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0);},$h._setFramesFromCache=function($J,$h){var $f;return void 0===$h&&($h=!1),this._url&&($J=this._url+"#"+$J),$J&&$j.framesMap[$J]?(($f=$j.framesMap[$J])instanceof Array?(this._frames=$j.framesMap[$J],this._count=this._frames.length):($f.nodeRoot&&($j.framesMap[$J]=this._parseGraphicAnimationByData($f),$f=$j.framesMap[$J]),this._frames=$f.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=$f.interval),this._labels=this._copyLabels($f.labels)),!0):($h&&console.log("ani not found:",$J),!1);},$h._copyLabels=function($J){if(!$J)return null;var $h,$f;for($f in $h={},$J)$h[$f]=$E.copyArray([],$J[$f]);return $h;},$h._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&$J.prototype._frameLoop.call(this);},$h._displayToIndex=function($J){this._frames&&(this.graphics=this._frames[$J]);},$h.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null;},$h.loadImages=function($J,$h){return void 0===$h&&($h=""),this._url="",this._setFramesFromCache($h)||(this.frames=$j.framesMap[$h]?$j.framesMap[$h]:$j.createFrames($J,$h)),this;},$h.loadAtlas=function($h,$f,$n){void 0===$n&&($n=""),this._url="";var $L=this;function $J($J){$h===$J&&($L.frames=$j.framesMap[$n]?$j.framesMap[$n]:$j.createFrames($h,$n),$f&&$f.run());}return $L._setFramesFromCache($n)||($uJ.getAtlas($h)?$J($h):$Q.loader.load($h,$_.create(null,$J,[$h]),null,"atlas")),this;},$h.loadAnimation=function($J,$h,$f){this._url=$J;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,$h&&$h.run()):!$f||$uJ.getAtlas($f)?this._loadAnimationData($J,$h,$f):$Q.loader.load($f,$_.create(this,this._loadAnimationData,[$J,$h,$f]),null,"atlas"),this;},$h._loadAnimationData=function($u,$S,$J){var $Y=this;if(!$J||$uJ.getAtlas($J)){var $x=this;$uJ.getRes($u)?$h($u):$Q.loader.load($u,$_.create(null,$h,[$u]),null,"json"),$uJ.clearRes($u);}else console.warn("atlas load fail:"+$J);function $h($J){if($uJ.getRes($J)&&$u===$J){var $h;if($j.framesMap[$u+"#"])$x._setFramesFromCache($Y._actionName,!0),$Y.index=0,$Y._checkResumePlaying();else{var $f=$x._parseGraphicAnimation($uJ.getRes($u));if(!$f)return;var $n,$L=$f.animationList,$T=0,$k=$L.length;for($T=0;$T<$k;$T++)$h=$L[$T],$j.framesMap[$u+"#"+$h.name]=$h,$n||($n=$h);$n&&($j.framesMap[$u+"#"]=$n,$x._setFramesFromCache($Y._actionName,!0),$Y.index=0),$Y._checkResumePlaying();}$S&&$S.run();}}},$h._parseGraphicAnimation=function($J){return $QJ.parseAnimationData($J);},$h._parseGraphicAnimationByData=function($J){return $QJ.parseAnimationByData($J);},$x(0,$h,"frames",function(){return this._frames;},function($J){(this._frames=$J)&&(this._count=$J.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index);}),$x(0,$h,"autoPlay",null,function($J){$J?this.play():this.stop();}),$x(0,$h,"source",null,function($J){-1<$J.indexOf(".ani")?this.loadAnimation($J):-1<$J.indexOf(".json")||-1<$J.indexOf("als")||-1<$J.indexOf("atlas")?this.loadAtlas($J):this.loadImages($J.split(","));}),$x(0,$h,"autoAnimation",null,function($J){this.play(0,!0,$J,!1);}),$j.createFrames=function($J,$h){var $f,$n,$L=0,$T=0;if("string"==typeof $J){var $k=$uJ.getAtlas($J);if($k&&$k.length)for($f=[],$L=0,$T=$k.length;$L<$T;$L++)($n=new $y.createGraphics()).drawTexture($uJ.getRes($k[$L]),0,0),$f.push($n);}else if($J instanceof Array)for($f=[],$L=0,$T=$J.length;$L<$T;$L++)($n=new $y.createGraphics()).loadImage($J[$L],0,0),$f.push($n);return $h&&($j.framesMap[$h]=$f),$f;},$j.clearCache=function($J){var $h,$f=$j.framesMap,$n=$J+"#";for($h in $f)$h!==$J&&0!=$h.indexOf($n)||delete $j.framesMap[$h];},$j.framesMap={};}($qJ),function($J){function $T(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,$T.__super.call(this),null==$T._sortIndexFun&&($T._sortIndexFun=$U.sortByKey("index",!1,!0));}$q($T,"laya.display.FrameAnimation",$J);var $h=$T.prototype;return $h._setUp=function($J,$h){this._labels=null,this._animationNewFrames=null,this._targetDic=$J,this._animationData=$h,this.interval=1e3/$h.frameRate,$h.parsed?(this._count=$h.count,this._labels=$h.labels,this._animationNewFrames=$h.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),$h.parsed=!0,$h.labels=this._labels,$h.count=this._count,$h.animationNewFrames=this._animationNewFrames;},$h.clear=function(){$J.prototype.clear.call(this),this._targetDic=null,this._animationData=null;},$h._displayToIndex=function($J){if(this._animationData){$J<0&&($J=0),$J>this._count&&($J=this._count);var $h=this._animationData.nodes,$f=0,$n=$h.length;for($f=0;$f<$n;$f++)this._displayNodeToFrame($h[$f],$J);}},$h._displayNodeToFrame=function($J,$h,$f){$f||($f=this._targetDic);var $n=$f[$J.target];if($n){var $L,$T,$k,$u=$J.frames,$S=$J.keys,$Y=0,$x=$S.length;for($Y=0;$Y<$x;$Y++)$k=($T=$u[$L=$S[$Y]]).length>$h?$T[$h]:$T[$T.length-1],$n[$L]=$k;}},$h._calculateDatas=function(){if(this._animationData){var $J,$h=this._animationData.nodes,$f=0,$n=$h.length;for($f=this._count=0;$f<$n;$f++)$J=$h[$f],this._calculateNodeKeyFrames($J);this._count+=1;}},$h._calculateNodeKeyFrames=function($J){var $h,$f,$n=$J.keyframes,$L=$J.target;for($h in $J.frames||($J.frames={}),$J.keys?$J.keys.length=0:$J.keys=[],$J.initValues||($J.initValues={}),$n)$f=$n[$h],$J.frames[$h]||($J.frames[$h]=[]),this._targetDic&&this._targetDic[$L]&&($J.initValues[$h]=this._targetDic[$L][$h]),$f.sort($T._sortIndexFun),$J.keys.push($h),this._calculateNodePropFrames($f,$J.frames[$h],$h,$L);},$h.resetToInitState=function(){if(this._targetDic&&this._animationData){var $J,$h,$f=this._animationData.nodes,$n=0,$L=$f.length;for($n=0;$n<$L;$n++)if($h=($J=$f[$n]).initValues){var $T,$k=this._targetDic[$J.target];if($k)for($T in $h)$k[$T]=$h[$T];}}},$h._calculateNodePropFrames=function($J,$h,$f,$n){var $L=0,$T=$J.length-1;if(0<$T){for($h.length=$J[$T].index+1,$L=0;$L<$T;$L++)this._dealKeyFrame($J[$L]),this._calculateFrameValues($J[$L],$J[$L+1],$h);this._dealKeyFrame($J[$L]);}0==$T&&($h[$J[0].index]=$J[0].value,this._animationNewFrames&&(this._animationNewFrames[$J[0].index]=!0));},$h._dealKeyFrame=function($J){$J.label&&""!=$J.label&&this.addLabel($J.label,$J.index);},$h._calculateFrameValues=function($J,$h,$f){var $n,$L=0,$T=$J.index,$k=$h.index,$u=$J.value,$S=$h.value-$J.value,$Y=$k-$T;if($k>this._count&&(this._count=$k),$J.tween)for(null==($n=$b[$J.tweenMethod])&&($n=$b.linearNone),$L=$T;$L<$k;$L++)$f[$L]=$n($L-$T,$u,$S,$Y),this._animationNewFrames&&(this._animationNewFrames[$L]=!0);else for($L=$T;$L<$k;$L++)$f[$L]=$u;this._animationNewFrames&&(this._animationNewFrames[$J.index]=!0,this._animationNewFrames[$h.index]=!0),$f[$h.index]=$h.value;},$T._sortIndexFun=null,$T;}($qJ)),$pJ=function($h){function $L(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",$L.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=$oJ.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay);}$q($L,"laya.display.Input",$h);var $J=$L.prototype;return $J.setSelection=function($J,$h){this.focus=!0,laya.display.Input.inputElement.selectionStart=$J,laya.display.Input.inputElement.selectionEnd=$h;},$J._onUnDisplay=function($J){this.focus=!1;},$J._onMouseDown=function($J){this.focus=!0;},$J._syncInputTransform=function(){var $J=this.nativeInput,$h=$E.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),$f=this._width-this.padding[1]-this.padding[3],$n=this._height-this.padding[0]-this.padding[2];$I.isConchApp?($J.setScale($h.scaleX,$h.scaleY),$J.setSize($f,$n),$J.setPos($h.x,$h.y)):($L.inputContainer.style.transform=$L.inputContainer.style.webkitTransform="scale("+$h.scaleX+","+$h.scaleY+") rotate("+$Q.stage.canvasDegree+"deg)",$J.style.width=$f+"px",$J.style.height=$n+"px",$L.inputContainer.style.left=$h.x+"px",$L.inputContainer.style.top=$h.y+"px");},$J.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select();},$J._setInputMethod=function(){$L.input.parentElement&&$L.inputContainer.removeChild($L.input),$L.area.parentElement&&$L.inputContainer.removeChild($L.area),$L.inputElement=this._multiline?$L.area:$L.input,$L.inputContainer.appendChild($L.inputElement),$oJ.RightToLeft&&($L.inputElement.style.direction="rtl");},$J._focusIn=function(){laya.display.Input.isInputting=!0;var $J=this.nativeInput;this._focus=!0;var $h=$J.style;$h.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),$J.readOnly=!this._editable,$I.isConchApp&&($J.setType(this._type),$J.setForbidEdit(!this._editable)),$J.maxLength=this._maxChars;this.padding;if($J.type=this._type,$J.value=this._content,$J.placeholder=this._prompt,$Q.stage.off("keydown",this,this._onKeyDown),$Q.stage.on("keydown",this,this._onKeyDown),($Q.stage.focus=this).event("focus"),$a.onPC&&$J.focus(),!$a.onMiniGame){this._text;this._text=null;}this.typeset(),$J.setColor(this._originColor),$J.setFontSize(this.fontSize),$J.setFontFace($a.onIPhone&&$oJ._fontFamilyMap[this.font]||this.font),$I.isConchApp&&$J.setMultiAble&&$J.setMultiAble(this._multiline),$h.lineHeight=this.leading+this.fontSize+"px",$h.fontStyle=this.italic?"italic":"normal",$h.fontWeight=this.bold?"bold":"normal",$h.textAlign=this.align,$h.padding="0 0",this._syncInputTransform(),!$I.isConchApp&&$a.onPC&&$Q.timer.frameLoop(1,this,this._syncInputTransform);},$J._setPromptColor=function(){($L.promptStyleDOM=$a.getElementById("promptStyle"))||(($L.promptStyleDOM=$a.createElement("style")).setAttribute("id","promptStyle"),$a.document.head.appendChild($L.promptStyleDOM)),$L.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}";},$J._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?($Q.superSet($oJ,this,"text",this._content),$Q.superSet($oJ,this,"color",this._originColor)):($Q.superSet($oJ,this,"text",this._prompt),$Q.superSet($oJ,this,"color",this._promptColor)),$Q.stage.off("keydown",this,this._onKeyDown),$Q.stage.focus=null,this.event("blur"),$I.isConchApp&&this.nativeInput.blur(),$a.onPC&&$Q.timer.clear(this,this._syncInputTransform);},$J._onKeyDown=function($J){13===$J.keyCode&&($a.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"));},$J.changeText=function($J){this._content=$J,this._focus?(this.nativeInput.value=$J||"",this.event("change")):$h.prototype.changeText.call(this,$J);},$x(0,$J,"color",$h.prototype._$get_color,function($J){this._focus&&this.nativeInput.setColor($J),$Q.superSet($oJ,this,"color",this._content?$J:this._promptColor),this._originColor=$J;}),$x(0,$J,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0;},function($J){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。");}),$x(0,$J,"multiline",function(){return this._multiline;},function($J){this._multiline=$J,this.valign=$J?"top":"middle";}),$x(0,$J,"maxChars",function(){return this._maxChars;},function($J){$J<=0&&($J=1e5),this._maxChars=$J;}),$x(0,$J,"text",function(){return this._focus?this.nativeInput.value:this._content||"";},function($J){$Q.superSet($oJ,this,"color",this._originColor),$J+="",this._focus?(this.nativeInput.value=$J||"",this.event("change")):(this._multiline||($J=$J.replace(/\r?\n/g,"")),(this._content=$J)?$Q.superSet($oJ,this,"text",$J):($Q.superSet($oJ,this,"text",this._prompt),$Q.superSet($oJ,this,"color",this.promptColor)));}),$x(0,$J,"nativeInput",function(){return this._multiline?$L.area:$L.input;}),$x(0,$J,"prompt",function(){return this._prompt;},function($J){!this._text&&$J&&$Q.superSet($oJ,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?$Q.superSet($oJ,this,"text",this._text==this._prompt?$J:this._text):$Q.superSet($oJ,this,"text",$J),this._prompt=$oJ.langPacks&&$oJ.langPacks[$J]?$oJ.langPacks[$J]:$J;}),$x(0,$J,"focus",function(){return this._focus;},function($J){var $h=this.nativeInput;this._focus!==$J&&($J?($h.target?$h.target._focusOut():this._setInputMethod(),($h.target=this)._focusIn()):($h.target=null,this._focusOut(),$a.document.body.scrollTop=0,$h.blur(),$I.isConchApp?$h.setPos(-1e4,-1e4):$L.inputContainer.contains($h)&&$L.inputContainer.removeChild($h)));}),$x(0,$J,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:"";},function($J){$J?(-1<($J="[^"+$J+"]").indexOf("^^")&&($J=$J.replace("^^","")),this._restrictPattern=new RegExp($J,"g")):this._restrictPattern=null;}),$x(0,$J,"editable",function(){return this._editable;},function($J){this._editable=$J,$I.isConchApp&&$L.input.setForbidEdit(!$J);}),$x(0,$J,"promptColor",function(){return this._promptColor;},function($J){this._promptColor=$J,this._content||$Q.superSet($oJ,this,"color",$J);}),$x(0,$J,"type",function(){return this._type;},function($J){this._getCSSStyle().password="password"==$J,this._type=$J,$I.isConchApp&&this.nativeInput.setType($J);}),$x(0,$J,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0;},function($J){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。");}),$x(0,$J,"asPassword",function(){return this._getCSSStyle().password;},function($J){this._getCSSStyle().password=$J,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0;}),$L.__init__=function(){$L._createInputElement(),$a.onMobile&&$I.canvas.addEventListener($L.IOS_IFRAME?$a.onMiniGame?"touchend":"click":"touchend",$L._popupInputMethod);},$L._popupInputMethod=function($J){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus();},$L._createInputElement=function(){$L._initInput($L.area=$a.createElement("textarea")),$L._initInput($L.input=$a.createElement("input")),($L.inputContainer=$a.createElement("div")).style.position="absolute",$L.inputContainer.style.zIndex=1e5,$a.container.appendChild($L.inputContainer),$L.inputContainer.setPos=function($J,$h){$L.inputContainer.style.left=$J+"px",$L.inputContainer.style.top=$h+"px";};},$L._initInput=function($h){var $J=$h.style;$J.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",$J.resize="none",$J.backgroundColor="transparent",$J.border="none",$J.outline="none",$J.zIndex=1,$h.addEventListener("input",$L._processInputting),$h.addEventListener("mousemove",$L._stopEvent),$h.addEventListener("mousedown",$L._stopEvent),$h.addEventListener("touchmove",$L._stopEvent),$h.setFontFace=function($J){$h.style.fontFamily=$J;},$I.isConchApp||($h.setColor=function($J){$h.style.color=$J;},$h.setFontSize=function($J){$h.style.fontSize=$J+"px";});},$L._processInputting=function($J){var $h=laya.display.Input.inputElement.target;if($h){var $f=laya.display.Input.inputElement.value;$h._restrictPattern&&($f=$f.replace(/\u2006|\x27/g,""),$h._restrictPattern.test($f)&&($f=$f.replace($h._restrictPattern,""),laya.display.Input.inputElement.value=$f)),$h._text=$f,$h.event("input");}},$L._stopEvent=function($J){"touchmove"==$J.type&&$J.preventDefault(),$J.stopPropagation&&$J.stopPropagation();},$L.TYPE_TEXT="text",$L.TYPE_PASSWORD="password",$L.TYPE_EMAIL="email",$L.TYPE_URL="url",$L.TYPE_NUMBER="number",$L.TYPE_RANGE="range",$L.TYPE_DATE="date",$L.TYPE_MONTH="month",$L.TYPE_WEEK="week",$L.TYPE_TIME="time",$L.TYPE_DATE_TIME="datetime",$L.TYPE_DATE_TIME_LOCAL="datetime-local",$L.TYPE_SEARCH="search",$L.input=null,$L.area=null,$L.inputElement=null,$L.inputContainer=null,$L.confirmButton=null,$L.promptStyleDOM=null,$L.inputHeight=45,$L.isInputting=!1,$L.stageMatrix=null,$S($L,["IOS_IFRAME",function(){return this.IOS_IFRAME=$a.onIOS&&$a.window.top!=$a.window.self;}]),$L;}($oJ),$UJ=function($J){function $f($J,$h){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,$f.__super.call(this),$J&&this._init_($J,$h);}$q($f,"laya.resource.HTMLImage",$_J);var $h=$f.prototype;return $h._init_=function($J,$h){this._src=$J,this._source=new $a.window.Image(),$h&&($h.onload&&(this.onload=$h.onload),$h.onerror&&(this.onerror=$h.onerror),$h.onCreate&&$h.onCreate(this)),0!=$J.indexOf("data:image")&&(this._source.crossOrigin=""),$J&&(this._source.src=$J);},$h.recreateResource=function(){var $J=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate();}else{this._recreateLock=!0;var $h=this;this._source=new $a.window.Image(),this._source.crossOrigin="",this._source.onload=function(){if($h._needReleaseAgain)return $h._needReleaseAgain=!1,$h._source.onload=null,void($h._source=null);$h._source.onload=null,$h.memorySize=$J._w*$J._h*4,$h._recreateLock=!1,$h.completeCreate();},this._source.src=this._src;}},$h.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0);},$h.onresize=function(){this._w=this._source.width,this._h=this._source.height;},$x(0,$h,"onload",null,function($J){var $h=this;this._onload=$J,this._source&&(this._source.onload=null!=this._onload?function(){$h.onresize(),$h._onload();}:null);}),$x(0,$h,"onerror",null,function($J){var $h=this;this._onerror=$J,this._source&&(this._source.onerror=null!=this._onerror?function(){$h._onerror();}:null);}),$x(0,$h,"enableMerageInAtlas",function(){return this._enableMerageInAtlas;},function($J){this._enableMerageInAtlas=$J,$I.isConchApp&&this._source&&(this._source.enableMerageInAtlas=$J);}),$f.create=function($J,$h){return new $f($J,$h);},$f;}(),$QJ=(function($T){function $J(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,$J.__super.call(this);}$q($J,"laya.display.EffectAnimation",$T);var $h=$J.prototype;$h._onOtherBegin=function($J){$J!=this&&this.stop();},$h.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction));},$h._onPlayAction=function(){this.play(0,!1);},$h.play=function($J,$h,$f,$n){void 0===$J&&($J=0),void 0===$h&&($h=!0),void 0===$f&&($f=""),void 0===$n&&($n=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,$J,$h,$f,$n));},$h._recordInitData=function(){if(this._aniKeys){var $J,$h,$f=0;for($J=this._aniKeys.length,$f=0;$f<$J;$f++)$h=this._aniKeys[$f],this._initData[$h]=this._target[$h];}},$h._displayToIndex=function($J){if(this._animationData){$J<0&&($J=0),$J>this._count&&($J=this._count);var $h=this._animationData.nodes,$f=0,$n=$h.length;for($n=1<$n?1:$n,$f=0;$f<$n;$f++)this._displayNodeToFrame($h[$f],$J);}},$h._displayNodeToFrame=function($J,$h,$f){if(this._target){var $n;$n=this._target;var $L,$T,$k,$u,$S=$J.frames,$Y=$J.keys,$x=0,$j=$Y.length;$u=$J.secondFrames;var $R,$l,$i,$q,$o=0;for($x=0;$x<$j;$x++)$T=$S[$L=$Y[$x]],$k=-1==($o=$u[$L])?this._initData[$L]:$h<$o?($i=($l=$J.keyframes[$L])[0]).tween?(null==($R=$b[$i.tweenMethod])&&($R=$b.linearNone),$q=$l[1],$R($h,this._initData[$L],$q.value-this._initData[$L],$q.index)):this._initData[$L]:$T.length>$h?$T[$h]:$T[$T.length-1],$n[$L]=$k;}},$h._calculateNodeKeyFrames=function($J){$T.prototype._calculateNodeKeyFrames.call(this,$J);var $h,$f,$n,$L=$J.keyframes;$J.target;for($h in $n={},$J.secondFrames=$n,$L)($f=$L[$h]).length<=1?$n[$h]=-1:$n[$h]=$f[1].index;},$x(0,$h,"target",function(){return this._target;},function($J){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=$J,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent();}),$x(0,$h,"playEvent",null,function($J){(this._playEvents=$J)&&this.addEvent();}),$x(0,$h,"effectData",null,function($J){var $h;$J&&($h=$J.animations)&&$h[0]&&(this._setUp({},$h[0]),$h[0].nodes&&$h[0].nodes[0]&&(this._aniKeys=$h[0].nodes[0].keys));}),$x(0,$h,"effectClass",null,function($J){var $h,$f;(this._effectClass=$C.getClass($J),this._effectClass)&&($h=this._effectClass.uiView)&&($f=$h.animations)&&$f[0]&&(this._setUp({},$f[0]),$f[0].nodes&&$f[0].nodes[0]&&(this._aniKeys=$f[0].nodes[0].keys));}),$J.EffectAnimationBegin="effectanimationbegin";}($dJ),function($h){var $A;function $G(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,$G.__super.call(this);}$q($G,"laya.utils.GraphicAnimation",$h);var $J=$G.prototype;return $J._parseNodeList=function($J){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[$J.compId]=$J.props,$J.compId&&this._nodeList.push($J.compId);var $h=$J.child;if($h){var $f=0,$n=$h.length;for($f=0;$f<$n;$f++)this._parseNodeList($h[$f]);}},$J._calGraphicData=function($J){var $h;if(this._setUp(null,$J),this._createGraphicData(),this._nodeIDAniDic)for($h in this._nodeIDAniDic)this._nodeIDAniDic[$h]=null;},$J._createGraphicData=function(){var $J,$h=[],$f=0,$n=this.count,$L=this._animationNewFrames;for($L||($L=[]),$f=0;$f<$n;$f++)!$L[$f]&&$J||($J=this._createFrameGraphic($f)),$h.push($J);this._gList=$h;},$J._createFrameGraphic=function($J){var $h=$y.createGraphics();return $G._rootMatrix||($G._rootMatrix=new $O()),this._updateNodeGraphic(this._rootNode,$J,$G._rootMatrix,$h),$h;},$J._updateNodeGraphic=function($J,$h,$f,$n,$L){var $T;void 0===$L&&($L=1);var $k,$u,$S,$Y=($T=this._nodeGDic[$J.compId]=this._getNodeGraphicData($J.compId,$h,this._nodeGDic[$J.compId])).alpha*$L;if(!($Y<.01)&&($T.resultTransform||($T.resultTransform=$O.create()),$k=$T.resultTransform,$O.mul($T.transform,$f,$k),$T.skin&&($u=this._getTextureByUrl($T.skin))&&($k._checkTransform()?($n.drawTexture($u,0,0,$T.width,$T.height,$k,$Y),$T.resultTransform=null):$n.drawTexture($u,$k.tx,$k.ty,$T.width,$T.height,null,$Y)),$S=$J.child)){var $x,$j=0;for($x=$S.length,$j=0;$j<$x;$j++)this._updateNodeGraphic($S[$j],$h,$k,$n,$Y);}},$J._updateNoChilds=function($J,$h){if($J.skin){var $f=this._getTextureByUrl($J.skin);if($f){var $n=$J.transform;$n._checkTransform();!$n.bTransform?$h.drawTexture($f,$n.tx,$n.ty,$J.width,$J.height,null,$J.alpha):$h.drawTexture($f,0,0,$J.width,$J.height,$n.clone(),$J.alpha);}}},$J._updateNodeGraphic2=function($J,$h,$f){var $n;if($n=this._nodeGDic[$J.compId]=this._getNodeGraphicData($J.compId,$h,this._nodeGDic[$J.compId]),$J.child){var $L=$n.transform;$L._checkTransform();var $T,$k;$k=($T=!$L.bTransform)&&(0!=$L.tx||0!=$L.ty);var $u,$S,$Y;if(($u=$L.bTransform||1!=$n.alpha)&&$f.save(),1!=$n.alpha&&$f.alpha($n.alpha),$T?$k&&$f.translate($L.tx,$L.ty):$f.transform($L.clone()),$S=$J.child,$n.skin&&($Y=this._getTextureByUrl($n.skin))&&$f.drawTexture($Y,0,0,$n.width,$n.height),$S){var $x,$j=0;for($x=$S.length,$j=0;$j<$x;$j++)this._updateNodeGraphic2($S[$j],$h,$f);}$u?$f.restore():$T?$k&&$f.translate(-$L.tx,-$L.ty):$f.transform($L.clone().invert());}else this._updateNoChilds($n,$f);},$J._calculateNodeKeyFrames=function($J){$h.prototype._calculateNodeKeyFrames.call(this,$J),this._nodeIDAniDic[$J.target]=$J;},$J.getNodeDataByID=function($J){return this._nodeIDAniDic[$J];},$J._getParams=function($J,$h,$f,$n){var $L=$G._temParam;$L.length=$h.length;var $T=0,$k=$h.length;for($T=0;$T<$k;$T++)$L[$T]=this._getObjVar($J,$h[$T][0],$f,$h[$T][1],$n);return $L;},$J._getObjVar=function($J,$h,$f,$n,$L){if($J.hasOwnProperty($h)){var $T=$J[$h];if($f>=$T.length&&($f=$T.length-1),null!=$J[$h][$f])return $J[$h][$f];}return $L.hasOwnProperty($h)?$L[$h]:$n;},$J._getNodeGraphicData=function($J,$h,$f){$f||($f=$A.create()),$f.transform?$f.transform.identity():$f.transform=$O.create();var $n=this.getNodeDataByID($J);if(!$n)return $f;var $L,$T,$k=$n.frames,$u=this._getParams($k,$G._drawTextureCmd,$h,this._nodeDefaultProps[$J]),$S=$u[0],$Y=NaN,$x=NaN,$j=$u[5],$R=$u[6],$l=$u[13],$i=$u[14],$q=$u[7],$o=$u[8],$r=$u[9],$_=$u[11],$s=$u[12];$Y=$u[3],$x=$u[4],0!=$Y&&0!=$x||($S=null),-1==$Y&&($Y=0),-1==$x&&($x=0),$f.skin=$S,$f.width=$Y,$f.height=$x,$S&&(($L=this._getTextureByUrl($S))?($Y||($Y=$L.sourceWidth),$x||($x=$L.sourceHeight)):console.warn("lost skin:",$S,",you may load pics first")),$f.alpha=$u[10],$T=$f.transform,0!=$l&&($j=$l*$Y),0!=$i&&($R=$i*$x),0==$j&&0==$R||$T.translate(-$j,-$R);var $d=null;if($r||1!==$q||1!==$o||$_||$s){($d=$G._tempMt).identity(),$d.bTransform=!0;var $p=.0174532922222222*($r-$_),$U=.0174532922222222*($r+$s),$Q=Math.cos($U),$D=Math.sin($U),$g=Math.sin($p),$F=Math.cos($p);$d.a=$q*$Q,$d.b=$q*$D,$d.c=-$o*$g,$d.d=$o*$F,$d.tx=$d.ty=0;}return $d&&($T=$O.mul($T,$d,$T)),$T.translate($u[1],$u[2]),$f;},$J._getTextureByUrl=function($J){return $uJ.getRes($J);},$J.setAniData=function($J,$h){if($J.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$J,this._parseNodeList($J);var $f,$n={},$L=[],$T=$J.animations,$k=0,$u=$T.length;for($k=0;$k<$u;$k++)if($f=$T[$k],this._labels=null,(!$h||$h==$f.name)&&$f){try{this._calGraphicData($f);}catch($J){console.warn("parse animation fail:"+$f.name+",empty animation created"),this._gList=[];}var $S={};$S.interval=1e3/$f.frameRate,$S.frames=this._gList,$S.labels=this._labels,$S.name=$f.name,$L.push($S),$n[$f.name]=$S;}this.animationList=$L,this.animationDic=$n;}$G._temParam.length=0;},$J.parseByData=function($J){var $h,$f;$h=$J.nodeRoot,$f=$J.aniO,delete $J.nodeRoot,delete $J.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$h,this._parseNodeList($h),this._labels=null;try{this._calGraphicData($f);}catch($J){console.warn("parse animation fail:"+$f.name+",empty animation created"),this._gList=[];}var $n=$J;return $n.interval=1e3/$f.frameRate,$n.frames=this._gList,$n.labels=this._labels,$n.name=$f.name,$n;},$J.setUpAniData=function($J){if($J.animations){var $h,$f={},$n=[],$L=$J.animations,$T=0,$k=$L.length;for($T=0;$T<$k;$T++)if($h=$L[$T]){var $u={};$u.name=$h.name,$u.aniO=$h,$u.nodeRoot=$J,$n.push($u),$f[$h.name]=$u;}this.animationList=$n,this.animationDic=$f;}},$J._clear=function(){var $J,$h;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for($J in this._nodeGDic)($h=this._nodeGDic[$J])&&$h.recover();this._nodeGDic=null;},$G.parseAnimationByData=function($J){var $h;return $G._I||($G._I=new $G()),$h=$G._I.parseByData($J),$G._I._clear(),$h;},$G.parseAnimationData=function($J){var $h;return $G._I||($G._I=new $G()),$G._I.setUpAniData($J),($h={}).animationList=$G._I.animationList,$h.animationDic=$G._I.animationDic,$G._I._clear(),$h;},$G._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],$G._temParam=[],$G._I=null,$G._rootMatrix=null,$S($G,["_tempMt",function(){return this._tempMt=new $O();}]),$G.__init$=function(){$A=function(){function $J(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1;}return $q($J,""),$J.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),$$.recover("GraphicNode",this);},$J.create=function(){return $$.getItemByClass("GraphicNode",$J);},$J;}();},$G;}($dJ));$Q.__init([$Y,$SJ,$I,$a,$X,$F,$J,$QJ]);}(window,document,Laya),function($J,$h,$f){$f.un,$f.uns,$f.static;var $n=$f.class;$f.getset,$f.__newvec;new(function(){function $J(){}return $n($J,"LayaMain"),$J;}())();}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($J,$h){"use strict";for(var $f in Object.defineProperty($h,"__esModule",{value:!0}),Laya){var $n=Laya[$f];$n&&$n.__isclass&&($h[$f]=$n);}}),function($J,$h,$U){$U.un,$U.uns;var $k=$U.static,$R=$U.class,$n=$U.getset,$T=$U.__newvec,$x=laya.maths.Arith,$j=laya.maths.Bezier,$f=laya.resource.Bitmap,$l=laya.utils.Browser,$S=laya.utils.Byte,$i=laya.utils.Color,$Q=(laya.filters.ColorFilter,$U.Config),$L=laya.resource.Context,$D=(laya.events.Event,laya.filters.Filter),$u=laya.display.Graphics,$Y=laya.resource.HTMLCanvas,$q=(laya.utils.HTMLChar,laya.resource.HTMLImage),$o=laya.resource.HTMLSubImage,$g=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),$F=laya.maths.Point,$A=laya.maths.Rectangle,$r=laya.renders.Render,$_=(laya.renders.RenderContext,laya.renders.RenderSprite),$s=laya.resource.Resource,$d=laya.resource.ResourceManager,$p=laya.utils.RunDriver,$G=laya.display.Sprite,$y=laya.display.Stage,$O=laya.utils.Stat,$P=laya.utils.StringKey,$W=(laya.display.css.Style,laya.system.System),$I=laya.display.Text,$m=laya.resource.Texture,$Z=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),$t=laya.utils.VectorGraphManager;laya.utils.WordText;$U.interface("laya.webgl.shapes.IShape"),$U.interface("laya.webgl.submit.ISubmit"),$U.interface("laya.webgl.text.ICharSegment"),$U.interface("laya.webgl.canvas.save.ISaveData"),$U.interface("laya.webgl.resource.IMergeAtlasBitmap"),$U.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var $c=function(){function $J(){}$R($J,"laya.filters.webgl.FilterActionGL");var $h=$J.prototype;return $U.imps($h,{"laya.filters.IFilterActionGL":!0}),$h.setValue=function($J){},$h.setValueMix=function($J){},$h.apply3d=function($J,$h,$f,$n,$L){return null;},$h.apply=function($J){return null;},$n(0,$h,"typeMix",function(){return 0;}),$J;}(),$a=function(){function $J(){}return $R($J,"laya.webgl.shader.ShaderValue"),$J;}(),$B=function(){var $n,$L;function $J($J,$h,$f){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new $L(),void 0===$J&&($J=0),void 0===$h&&($h=0),void 0===$f&&($f=0),this._cells=null,this._rowInfo=null,this._init($J,$h),this._atlasID=$f;}$R($J,"laya.webgl.atlas.AtlasGrid");var $h=$J.prototype;return $h.getAltasID=function(){return this._atlasID;},$h.setAltasID=function($J){0<=$J&&(this._atlasID=$J);},$h.addTex=function($J,$h,$f){var $n=this._get($h,$f);return 0==$n.ret||(this._fill($n.x,$n.y,$h,$f,$J),this._texCount++),$n;},$h._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null);},$h._init=function($J,$h){if(this._width=$J,this._height=$h,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=$T(this._height);for(var $f=0;$f<this._height;$f++)this._rowInfo[$f]=new $n();return this._clear(),!0;},$h._get=function($J,$h){var $f=new $C();if($J>=this._failSize.width&&$h>=this._failSize.height)return $f;for(var $n=-1,$L=-1,$T=this._width,$k=this._height,$u=this._cells,$S=0;$S<$k;$S++)if(!(this._rowInfo[$S].spaceCount<$J))for(var $Y=0;$Y<$T;){var $x=3*($S*$T+$Y);if(0!=$u[$x]||$u[1+$x]<$J||$u[2+$x]<$h)$Y+=$u[1+$x];else{$n=$Y,$L=$S;for(var $j=0;$j<$J;$j++)if($u[3*$j+$x+2]<$h){$n=-1;break;}if(!($n<0))return $f.ret=!0,$f.x=$n,$f.y=$L,$f;$Y+=$u[1+$x];}}return $f;},$h._fill=function($J,$h,$f,$n,$L){var $T=this._width,$k=this._height;this._check($J+$f<=$T&&$h+$n<=$k);for(var $u=$h;$u<$n+$h;++$u){this._check(this._rowInfo[$u].spaceCount>=$f),this._rowInfo[$u].spaceCount-=$f;for(var $S=0;$S<$f;$S++){var $Y=3*($J+$u*$T+$S);this._check(0==this._cells[$Y]),this._cells[$Y]=$L,this._cells[1+$Y]=$f,this._cells[2+$Y]=$n;}}if(0<$J)for($u=0;$u<$n;++$u){var $x=0;for($S=$J-1;0<=$S&&0==this._cells[3*(($h+$u)*$T+$S)];--$S,++$x);for($S=$x;0<$S;--$S)this._cells[3*(($h+$u)*$T+$J-$S)+1]=$S,this._check(0<$S);}if(0<$h)for($S=$J;$S<$J+$f;++$S){for($x=0,$u=$h-1;0<=$u&&0==this._cells[3*($S+$u*$T)];--$u,$x++);for($u=$x;0<$u;--$u)this._cells[3*($S+($h-$u)*$T)+2]=$u,this._check(0<$u);}},$h._check=function($J){0==$J&&console.log("xtexMerger 错误啦");},$h._clear=function(){for(var $J=this._texCount=0;$J<this._height;$J++)this._rowInfo[$J].spaceCount=this._width;for(var $h=0;$h<this._height;$h++)for(var $f=0;$f<this._width;$f++){var $n=3*($h*this._width+$f);this._cells[$n]=0,this._cells[1+$n]=this._width-$f,this._cells[2+$n]=this._width-$h;}this._failSize.width=this._width+1,this._failSize.height=this._height+1;},$J.__init$=function(){$n=function(){function $J(){this.spaceCount=0;}return $R($J,""),$J;}(),$L=function(){function $J(){this.width=0,this.height=0;}return $R($J,""),$J;}();},$J;}(),$V=function(){function $r($J,$h,$f,$n){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=$J,this._height=$h,this._gridSize=$f,this._maxAtlaserCount=$n,this._gridNumX=$J/$f,this._gridNumY=$h/$f,this._curAtlasIndex=0,this._atlaserArray=[];}$R($r,"laya.webgl.atlas.AtlasResourceManager");var $J=$r.prototype;return $J.setAtlasParam=function($J,$h,$f,$n){if(1==this._setAtlasParam)return $r._sid_=0,this._width=$J,this._height=$h,this._gridSize=$f,this._maxAtlaserCount=$n,this._gridNumX=$J/$f,this._gridNumY=$h/$f,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1;},$J.pushData=function($J){var $h,$f=$J.bitmap,$n=-1,$L=null,$T=0,$k=0;for($T=0,$h=this._atlaserArray.length;$T<$h&&($k=(this._curAtlasIndex+$T)%$h,-1==($n=($L=this._atlaserArray[$k]).findBitmapIsExist($f)));$T++);if(-1!=$n){var $u=$L.InAtlasWebGLImagesOffsetValue[$n];return $i=$u[0],$q=$u[1],$L.addToAtlas($J,$i,$q),!0;}this._setAtlasParam=!1;for(var $S=Math.ceil(($J.bitmap.width+2)/this._gridSize),$Y=Math.ceil(($J.bitmap.height+2)/this._gridSize),$x=!1,$j=0;$j<2;$j++){var $R=this._maxAtlaserCount;for($T=0;$T<$R;$T++){$k=(this._curAtlasIndex+$T)%$R,this._atlaserArray.length-1>=$k||this._atlaserArray.push(new $AJ(this._gridNumX,this._gridNumY,this._width,this._height,$r._sid_++));var $l=this._atlaserArray[$k],$i=0,$q=0,$o=$l.addTex(1,$S,$Y);if($o.ret){$i=$o.x*this._gridSize+1,$q=$o.y*this._gridSize+1,$f.lock=!0,$l.addToAtlasTexture($f,$i,$q),$l.addToAtlas($J,$i,$q),$x=!0,this._curAtlasIndex=$k;break;}}if($x)break;this._atlaserArray.push(new $AJ(this._gridNumX,this._gridNumY,this._width,this._height,$r._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1;}return $x||console.log(">>>AtlasManager pushData error"),$x;},$J.addToAtlas=function($J){laya.webgl.atlas.AtlasResourceManager.instance.pushData($J);},$J.garbageCollection=function(){if(!0===this._needGC){for(var $J=this._atlaserArray.length-this._maxAtlaserCount,$h=0;$h<$J;$h++)this._atlaserArray[$h].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+$J),this._atlaserArray.splice(0,$J),this._needGC=!1;}return!0;},$J.freeAll=function(){for(var $J=0,$h=this._atlaserArray.length;$J<$h;$J++)this._atlaserArray[$J].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0;},$J.getAtlaserCount=function(){return this._atlaserArray.length;},$J.getAtlaserByIndex=function($J){return this._atlaserArray[$J];},$n(1,$r,"instance",function(){return $r._Instance||($r._Instance=new $r(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),$r._Instance;}),$n(1,$r,"enabled",function(){return $Q.atlasEnable;}),$n(1,$r,"atlasLimitWidth",function(){return $r._atlasLimitWidth;},function($J){$r._atlasLimitWidth=$J;}),$n(1,$r,"atlasLimitHeight",function(){return $r._atlasLimitHeight;},function($J){$r._atlasLimitHeight=$J;}),$r._enable=function(){$Q.atlasEnable=!0;},$r._disable=function(){$Q.atlasEnable=!1;},$r.__init__=function(){$r.atlasTextureWidth=2048,$r.atlasTextureHeight=2048,$r.maxTextureCount=6,$r.atlasLimitWidth=512,$r.atlasLimitHeight=512;},$r._atlasLimitWidth=0,$r._atlasLimitHeight=0,$r.gridSize=16,$r.atlasTextureWidth=0,$r.atlasTextureHeight=0,$r.maxTextureCount=0,$r._atlasRestore=0,$r.BOARDER_TYPE_NO=0,$r.BOARDER_TYPE_RIGHT=1,$r.BOARDER_TYPE_LEFT=2,$r.BOARDER_TYPE_BOTTOM=4,$r.BOARDER_TYPE_TOP=8,$r.BOARDER_TYPE_ALL=15,$r._sid_=0,$r._Instance=null,$r;}(),$C=function(){function $J(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0;}return $R($J,"laya.webgl.atlas.MergeFillInfo"),$J;}(),$e=function(){function $h(){}return $R($h,"laya.webgl.canvas.BlendMode"),$h._init_=function($J){$h.fns=[$h.BlendNormal,$h.BlendAdd,$h.BlendMultiply,$h.BlendScreen,$h.BlendOverlay,$h.BlendLight,$h.BlendMask,$h.BlendDestinationOut],$h.targetFns=[$h.BlendNormalTarget,$h.BlendAddTarget,$h.BlendMultiplyTarget,$h.BlendScreenTarget,$h.BlendOverlayTarget,$h.BlendLightTarget,$h.BlendMask,$h.BlendDestinationOut];},$h.BlendNormal=function($J){$J.blendFunc(1,771);},$h.BlendAdd=function($J){$J.blendFunc(1,772);},$h.BlendMultiply=function($J){$J.blendFunc(774,771);},$h.BlendScreen=function($J){$J.blendFunc(1,1);},$h.BlendOverlay=function($J){$J.blendFunc(1,769);},$h.BlendLight=function($J){$J.blendFunc(1,1);},$h.BlendNormalTarget=function($J){$J.blendFunc(1,771);},$h.BlendAddTarget=function($J){$J.blendFunc(1,772);},$h.BlendMultiplyTarget=function($J){$J.blendFunc(774,771);},$h.BlendScreenTarget=function($J){$J.blendFunc(1,1);},$h.BlendOverlayTarget=function($J){$J.blendFunc(1,769);},$h.BlendLightTarget=function($J){$J.blendFunc(1,1);},$h.BlendMask=function($J){$J.blendFunc(0,770);},$h.BlendDestinationOut=function($J){$J.blendFunc(0,0);},$h.activeBlendFunction=null,$h.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],$h.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},$h.NORMAL="normal",$h.ADD="add",$h.MULTIPLY="multiply",$h.SCREEN="screen",$h.LIGHT="light",$h.OVERLAY="overlay",$h.DESTINATIONOUT="destination-out",$h.fns=[],$h.targetFns=[],$h;}(),$H=function(){function $f($J){this._color=$i.create("black"),this.setValue($J);}$R($f,"laya.webgl.canvas.DrawStyle");var $J=$f.prototype;return $J.setValue=function($J){if($J){if("string"==typeof $J)return void(this._color=$i.create($J));if($J instanceof laya.utils.Color)return void(this._color=$J);}},$J.reset=function(){this._color=$i.create("black");},$J.equal=function($J){return"string"==typeof $J?this._color.strColor===$J:$J instanceof laya.utils.Color&&this._color.numColor===$J.numColor;},$J.toColorStr=function(){return this._color.strColor;},$f.create=function($J){var $h;if($J&&("string"==typeof $J?$h=$i.create($J):$J instanceof laya.utils.Color&&($h=$J),$h))return $h._drawStyle||($h._drawStyle=new $f($J));return laya.webgl.canvas.DrawStyle.DEFAULT;},$k($f,["DEFAULT",function(){return this.DEFAULT=new $f("#000000");}]),$f;}(),$b=function(){function $J(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];$dJ.mainContext;this.ib=$zJ.create(35048),this.vb=$KJ.create(5);}$R($J,"laya.webgl.canvas.Path");var $h=$J.prototype;return $h.addPoint=function($J,$h){this.tempArray.push($J,$h);},$h.getEndPointX=function(){return this.tempArray[this.tempArray.length-2];},$h.getEndPointY=function(){return this.tempArray[this.tempArray.length-1];},$h.polygon=function($J,$h,$f,$n,$L,$T){var $k;return this.geomatrys.push(this._curGeomatry=$k=new $PJ($J,$h,$f,$n,$L,$T)),$n||($k.fill=!1),null==$T&&($k.borderWidth=0),$k;},$h.setGeomtry=function($J){this.geomatrys.push(this._curGeomatry=$J);},$h.drawLine=function($J,$h,$f,$n,$L){var $T;return this.closePath?this.geomatrys.push(this._curGeomatry=$T=new $OJ($J,$h,$f,$n,$L)):this.geomatrys.push(this._curGeomatry=$T=new $yJ($J,$h,$f,$n,$L)),$T.fill=!1,$T;},$h.update=function(){var $J=this.ib._byteLength,$h=this.geomatrys.length;this.offset=$J;for(var $f=this.geoStart;$f<$h;$f++)this.geomatrys[$f].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=$h,this.count=(this.ib._byteLength-$J)/$qJ.BYTES_PIDX;},$h.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0;},$h.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null;},$J;}(),$v=function(){function $u(){}$R($u,"laya.webgl.canvas.save.SaveBase");var $J=$u.prototype;return $U.imps($J,{"laya.webgl.canvas.save.ISaveData":!0}),$J.isSaveMark=function(){return!1;},$J.restore=function($J){this._dataObj[this._valueName]=this._value,($u._cache[$u._cache._length++]=this)._newSubmit&&($J._curSubmit=$TJ.RENDERBASE,$J._renderKey=0);},$u._createArray=function(){var $J=[];return $J._length=0,$J;},$u._init=function(){var $J=$u._namemap={};return $J[1]="ALPHA",$J[2]="fillStyle",$J[8]="font",$J[256]="lineWidth",$J[512]="strokeStyle",$J[8192]="_mergeID",$J[1024]=$J[2048]=$J[4096]=[],$J[16384]="textBaseline",$J[32768]="textAlign",$J[65536]="_nBlendType",$J[1048576]="shader",$J[2097152]="filters",$J;},$u.save=function($J,$h,$f,$n){if(($J._saveMark._saveuse&$h)!==$h){$J._saveMark._saveuse|=$h;var $L=$u._cache,$T=0<$L._length?$L[--$L._length]:new $u();$T._value=$f[$T._valueName=$u._namemap[$h]],$T._dataObj=$f,$T._newSubmit=$n;var $k=$J._save;$k[$k._length++]=$T;}},$u._cache=laya.webgl.canvas.save.SaveBase._createArray(),$u._namemap=$u._init(),$u;}(),$$=function(){function $T(){this._clipRect=new $A();}$R($T,"laya.webgl.canvas.save.SaveClipRect");var $J=$T.prototype;return $U.imps($J,{"laya.webgl.canvas.save.ISaveData":!0}),$J.isSaveMark=function(){return!1;},$J.restore=function($J){$J._clipRect=this._clipSaveRect,($T._cache[$T._cache._length++]=this)._submitScissor.submitLength=$J._submits._length-this._submitScissor.submitIndex,$J._curSubmit=$TJ.RENDERBASE,$J._renderKey=0;},$T.save=function($J,$h){if(131072!=(131072&$J._saveMark._saveuse)){$J._saveMark._saveuse|=131072;var $f=$T._cache,$n=0<$f._length?$f[--$f._length]:new $T();$n._clipSaveRect=$J._clipRect,$J._clipRect=$n._clipRect.copyFrom($J._clipRect),$n._submitScissor=$h;var $L=$J._save;$L[$L._length++]=$n;}},$k($T,["_cache",function(){return this._cache=$v._createArray();}]),$T;}(),$M=function(){function $l(){this._contextX=0,this._contextY=0,this._clipRect=new $A(),this._rect=new $A(),this._matrix=new $g();}$R($l,"laya.webgl.canvas.save.SaveClipRectStencil");var $J=$l.prototype;return $U.imps($J,{"laya.webgl.canvas.save.ISaveData":!0}),$J.isSaveMark=function(){return!1;},$J.restore=function($J){$xJ.restore($J,this._rect,this._saveMatrix,this._contextX,this._contextY),$J._clipRect=this._clipSaveRect,$J._curMat=this._saveMatrix,$J._x=this._contextX,$J._y=this._contextY,$l._cache[$l._cache._length++]=this,$J._curSubmit=$TJ.RENDERBASE;},$l.save=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){if(262144!=(262144&$J._saveMark._saveuse)){$J._saveMark._saveuse|=262144;var $x=$l._cache,$j=0<$x._length?$x[--$x._length]:new $l();$j._clipSaveRect=$J._clipRect,$j._clipRect.setTo($k,$u,$S,$Y),$J._clipRect=$j._clipRect,$j._rect.x=$f,$j._rect.y=$n,$j._rect.width=$L,$j._rect.height=$T,$j._contextX=$J._x,$j._contextY=$J._y,$j._saveMatrix=$J._curMat,$J._curMat.copyTo($j._matrix),$J._curMat=$j._matrix,$j._submitStencil=$h;var $R=$J._save;$R[$R._length++]=$j;}},$k($l,["_cache",function(){return this._cache=$v._createArray();}]),$l;}(),$X=function(){function $n(){this._saveuse=0;}$R($n,"laya.webgl.canvas.save.SaveMark");var $J=$n.prototype;return $U.imps($J,{"laya.webgl.canvas.save.ISaveData":!0}),$J.isSaveMark=function(){return!0;},$J.restore=function($J){$J._saveMark=this._preSaveMark,$n._no[$n._no._length++]=this;},$n.Create=function($J){var $h=$n._no,$f=0<$h._length?$h[--$h._length]:new $n();return $f._saveuse=0,$f._preSaveMark=$J._saveMark,$J._saveMark=$f;},$k($n,["_no",function(){return this._no=$v._createArray();}]),$n;}(),$w=function(){function $T(){this._matrix=new $g();}$R($T,"laya.webgl.canvas.save.SaveTransform");var $J=$T.prototype;return $U.imps($J,{"laya.webgl.canvas.save.ISaveData":!0}),$J.isSaveMark=function(){return!1;},$J.restore=function($J){$J._curMat=this._savematrix,$T._no[$T._no._length++]=this;},$T.save=function($J){var $h=$J._saveMark;if(2048!=(2048&$h._saveuse)){$h._saveuse|=2048;var $f=$T._no,$n=0<$f._length?$f[--$f._length]:new $T();$n._savematrix=$J._curMat,$J._curMat=$J._curMat.copyTo($n._matrix);var $L=$J._save;$L[$L._length++]=$n;}},$k($T,["_no",function(){return this._no=$v._createArray();}]),$T;}(),$E=function(){function $L(){}$R($L,"laya.webgl.canvas.save.SaveTranslate");var $J=$L.prototype;return $U.imps($J,{"laya.webgl.canvas.save.ISaveData":!0}),$J.isSaveMark=function(){return!1;},$J.restore=function($J){$J._curMat;$J._x=this._x,$J._y=this._y,$L._no[$L._no._length++]=this;},$L.save=function($J){var $h=$L._no,$f=0<$h._length?$h[--$h._length]:new $L();$f._x=$J._x,$f._y=$J._y;var $n=$J._save;$n[$n._length++]=$f;},$k($L,["_no",function(){return this._no=$v._createArray();}]),$L;}(),$N=function(){function $J(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new $A();}$R($J,"laya.webgl.resource.RenderTargetMAX");var $h=$J.prototype;return $h.setSP=function($J){this._sp=$J;},$h.size=function($J,$h){var $f=this;this._width!==$J||this._height!==$h?(this.repaint=!0,this._width=$J,this._height=$h,this.target?this.target.size($J,$h):this.target=$tJ.create($J,$h),this.target.hasListener("recovered")||this.target.on("recovered",this,function($J){$U.timer.callLater($f._sp,$f._sp.repaint);})):this.target.size($J,$h);},$h._flushToTarget=function($J,$h){if(!$h._destroy){var $f=$_J.worldScissorTest,$n=$_J.worldClipRect;$_J.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,$_J.worldScissorTest=!1,$dJ.mainContext.disable(3089);var $L=$_J.worldAlpha,$T=$_J.worldMatrix4,$k=$_J.worldMatrix,$u=$_J.worldFilters,$S=$_J.worldShaderDefines;if($_J.worldMatrix=$g.EMPTY,$_J.restoreTempArray(),$_J.worldMatrix4=$_J.TEMPMAT4_ARRAY,$_J.worldAlpha=1,$_J.worldFilters=null,$_J.worldShaderDefines=null,$ZJ.activeShader=null,$h.start(),$Q.showCanvasMark?$h.clear(0,1,0,.3):$h.clear(0,0,0,0),$J.flush(),$h.end(),$ZJ.activeShader=null,$_J.worldAlpha=$L,$_J.worldMatrix4=$T,$_J.worldMatrix=$k,$_J.worldFilters=$u,$_J.worldShaderDefines=$S,$_J.worldScissorTest=$f){var $Y=$_J.height-$n.y-$n.height;$dJ.mainContext.scissor($n.x,$Y,$n.width,$n.height),$dJ.mainContext.enable(3089);}$_J.worldClipRect=$n;}},$h.flush=function($J){this.repaint&&(this._flushToTarget($J,this.target),this.repaint=!1);},$h.drawTo=function($J,$h,$f,$n,$L){$J.drawTexture(this.target.getTexture(),$h,$f,$n,$L,0,0);},$h.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null);},$J;}(),$z=function(){function $J(){this.ALPHA=1,this.shaderType=0,this.defines=new $GJ();}return $R($J,"laya.webgl.shader.d2.Shader2D"),$J.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null;},$J.__init__=function(){var $J,$h;$XJ.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),$XJ.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),$XJ.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),$XJ.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),$XJ.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),$XJ.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),$XJ.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),$XJ.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),$J="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$h='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$XJ.preCompile2D(0,1,$J,$h,null),$J="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",$h='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',$XJ.preCompile2D(0,2,$J,$h,null),$J="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",$h="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",$XJ.preCompile2D(0,4,$J,$h,null),$J="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$h='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$XJ.preCompile2D(0,256,$J,$h,null),$J="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",$h="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",$XJ.preCompile2D(0,512,$J,$h,null);},$J;}(),$K=function(){function $h($J,$h,$f){this._value=0,this._name2int=$J,this._int2name=$h,this._int2nameMap=$f;}$R($h,"laya.webgl.shader.ShaderDefines");var $J=$h.prototype;return $J.add=function($J){return"string"==typeof $J&&($J=this._name2int[$J]),this._value|=$J,this._value;},$J.addInt=function($J){return this._value|=$J,this._value;},$J.remove=function($J){return"string"==typeof $J&&($J=this._name2int[$J]),this._value&=~$J,this._value;},$J.isDefine=function($J){return(this._value&$J)===$J;},$J.getValue=function(){return this._value;},$J.setValue=function($J){this._value=$J;},$J.toNameDic=function(){var $J=this._int2nameMap[this._value];return $J||$h._toText(this._value,this._int2name,this._int2nameMap);},$h._reg=function($J,$h,$f,$n){$n[$f[$J]=$h]=$J;},$h._toText=function($J,$h,$f){var $n=$f[$J];if($n)return $n;for(var $L={},$T=1,$k=0;$k<32&&!($J<($T=1<<$k));$k++)if($J&$T){var $u=$h[$T];$u&&($L[$u]="");}return $f[$J]=$L;},$h._toInt=function($J,$h){for(var $f=$J.split("."),$n=0,$L=0,$T=$f.length;$L<$T;$L++){var $k=$h[$f[$L]];if(!$k)throw new Error("Defines to int err:"+$J+"/"+$f[$L]);$n|=$k;}return $n;},$h;}(),$JJ=function(){function $k(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new $g();}$R($k,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var $J=$k.prototype;return $J.init=function($J,$h,$f){if($h)this._vs=$h;else{this._vs=[];var $n=$J.width,$L=$J.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push($n,0,1,0,1,1,1,1),this._vs.push($n,$L,1,1,1,1,1,1),this._vs.push(0,$L,0,1,1,1,1,1);}$f?this._ps=$f:($k._defaultPS||($k._defaultPS=[]).push(0,1,3,3,1,2),this._ps=$k._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=$J;},$J.init2=function($J,$h,$f,$n,$L){this.transform&&(this.transform=null),$f?this._ps=$f:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=$n,this._uvs=$L,this.mEleNum=this._ps.length,this.mTexture=$J,($r.isConchNode||$r.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs));},$J._initMyData=function(){var $J=0,$h=0,$f=4*this._verticles.length;this._vs=$k._tempVS;var $n=!1;if($r.isConchNode||$r.isConchApp?(this._vs.length=$f,$n=!0):this._vs.length<$f&&(this._vs.length=$f,$n=!0),$k._tVSLen=$f,$n)for(;$J<$f;)this._vs[$J]=this._verticles[$h],this._vs[$J+1]=this._verticles[$h+1],this._vs[$J+2]=this._uvs[$h],this._vs[$J+3]=this._uvs[$h+1],this._vs[$J+4]=1,this._vs[$J+5]=1,this._vs[$J+6]=1,this._vs[$J+7]=1,$J+=8,$h+=2;else for(;$J<$f;)this._vs[$J]=this._verticles[$h],this._vs[$J+1]=this._verticles[$h+1],this._vs[$J+2]=this._uvs[$h],this._vs[$J+3]=this._uvs[$h+1],$J+=8,$h+=2;},$J.getData2=function($J,$h,$f){var $n;this.mVBBuffer=$J,this.mIBBuffer=$h,this._initMyData(),$J.appendEx2(this._vs,Float32Array,$k._tVSLen,4),this._indexStart=$h._byteLength,($n=$k._tempIB).length<this._ps.length&&($n.length=this._ps.length);for(var $L=0,$T=this._ps.length;$L<$T;$L++)$n[$L]=this._ps[$L]+$f;$h.appendEx2($n,Uint16Array,this._ps.length,2);},$J.getData=function($J,$h,$f){if(this.mVBBuffer=$J,this.mIBBuffer=$h,$J.append(this.mVBData),this._indexStart=$h._byteLength,this.mIBData.start!=$f){for(var $n=0,$L=this._ps.length;$n<$L;$n++)this.mIBData[$n]=this._ps[$n]+$f;this.mIBData.start=$f;}$h.append(this.mIBData);},$J.render=function($J,$h,$f){if($r.isWebGL&&this.mTexture){$J._renderKey=0,$J._shader2D.glTexture=null,$hJ.getInstance().addSkinMesh(this);var $n=$TJ.createShape($J,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,$DJ.create(512,0));this.transform||(this.transform=$g.EMPTY),this.transform.translate($h,$f),$g.mul(this.transform,$J._curMat,this._tempMatrix),this.transform.translate(-$h,-$f);var $L=$n.shaderValue,$T=$L.u_mmat2||$_J.getMatrArray();$_J.mat2MatArray(this._tempMatrix,$T),$L.textureHost=this.mTexture,$L.offsetX=0,$L.offsetY=0,$L.u_mmat2=$T,$L.ALPHA=$J._shader2D.ALPHA,$J._submits[$J._submits._length++]=$n;}else $r.isConchApp&&this.mTexture&&(this.transform||(this.transform=$g.EMPTY),$J.setSkinMesh&&$J.setSkinMesh($h,$f,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform));},$k._tempVS=[],$k._tempIB=[],$k._defaultPS=null,$k._tVSLen=0,$k;}(),$hJ=function(){function $J(){this.ib=null,this.vb=null;$dJ.mainContext;this.ib=$zJ.create(35048),this.vb=$KJ.create(8);}$R($J,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var $h=$J.prototype;return $h.addSkinMesh=function($J){$J.getData2(this.vb,this.ib,this.vb._byteLength/32);},$h.reset=function(){this.vb.clear(),this.ib.clear();},$J.getInstance=function(){return $J.instance=$J.instance||new $J();},$J.instance=null,$J;}(),$fJ=function(){function $J($J,$h,$f,$n,$L,$T,$k,$u,$S){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===$S&&($S=0),this.x=$J,this.y=$h,this.width=$f,this.height=$n,this.edges=$L,this.color=$T,this.borderWidth=$k,this.borderColor=$u;}$R($J,"laya.webgl.shapes.BasePoly");var $h=$J.prototype;return $U.imps($h,{"laya.webgl.shapes.IShape":!0}),$h.getData=function($J,$h,$f){},$h.rebuild=function($J){},$h.setMatrix=function($J){},$h.needUpdate=function($J){return!0;},$h.sector=function($J,$h,$f){var $n=this.x,$L=this.y,$T=this.edges,$k=(this.r1-this.r0)/$T,$u=this.width,$S=this.height,$Y=this.color,$x=($Y>>16&255)/255,$j=($Y>>8&255)/255,$R=(255&$Y)/255;$J.push($n,$L,$x,$j,$R);for(var $l=0;$l<$T+1;$l++)$J.push($n+Math.sin($k*$l+this.r0)*$u,$L+Math.cos($k*$l+this.r0)*$S),$J.push($x,$j,$R);for($l=0;$l<$T;$l++)$h.push($f,$f+$l+1,$f+$l+2);},$h.createLine2=function($J,$h,$f,$n,$L,$T){var $k,$u,$S,$Y,$x,$j,$R,$l,$i,$q,$o,$r,$_,$s,$d,$p,$U,$Q,$D,$g,$F=$J.concat(),$A=$L,$G=this.borderColor,$y=($G>>16&255)/255,$O=($G>>8&255)/255,$P=(255&$G)/255,$W=$F.length/2,$I=$n,$m=$f/2;$S=$F[0],$Y=$F[1],$q=$S-($x=$F[2]),$i=($i=-($Y-($j=$F[3])))/($g=Math.sqrt($i*$i+$q*$q))*$m,$q=$q/$g*$m,$A.push($S-$i+this.x,$Y-$q+this.y,$y,$O,$P,$S+$i+this.x,$Y+$q+this.y,$y,$O,$P);for(var $Z=1;$Z<$W-1;$Z++)$S=$F[2*($Z-1)],$Y=$F[2*($Z-1)+1],$x=$F[2*$Z],$j=$F[2*$Z+1],$R=$F[2*($Z+1)],$l=$F[2*($Z+1)+1],$q=$S-$x,$r=$x-$R,$d=(-($i=($i=-($Y-$j))/($g=Math.sqrt($i*$i+$q*$q))*$m)+$S)*(-($q=$q/$g*$m)+$j)-(-$i+$x)*(-$q+$Y),$Q=(-($o=($o=-($j-$l))/($g=Math.sqrt($o*$o+$r*$r))*$m)+$R)*(-($r=$r/$g*$m)+$j)-(-$o+$x)*(-$r+$l),$D=($_=-$q+$Y-(-$q+$j))*($U=-$o+$x-(-$o+$R))-($p=-$r+$l-(-$r+$j))*($s=-$i+$x-(-$i+$S)),Math.abs($D)<.1?($D+=10.1,$A.push($x-$i+this.x,$j-$q+this.y,$y,$O,$P,$x+$i+this.x,$j+$q+this.y,$y,$O,$P)):((($k=($s*$Q-$U*$d)/$D)-$x)*($k-$x)+(($u=($p*$d-$_*$Q)/$D)-$j)+($u-$j),$A.push($k+this.x,$u+this.y,$y,$O,$P,$x-($k-$x)+this.x,$j-($u-$j)+this.y,$y,$O,$P));$S=$F[$F.length-4],$Y=$F[$F.length-3],$q=$S-($x=$F[$F.length-2]),$i=($i=-($Y-($j=$F[$F.length-1])))/($g=Math.sqrt($i*$i+$q*$q))*$m,$q=$q/$g*$m,$A.push($x-$i+this.x,$j-$q+this.y,$y,$O,$P,$x+$i+this.x,$j+$q+this.y,$y,$O,$P);var $t=$T;for($Z=1;$Z<$t;$Z++)$h.push($I+2*($Z-1),$I+2*($Z-1)+1,$I+2*$Z+1,$I+2*$Z+1,$I+2*$Z,$I+2*($Z-1));return $A;},$h.createLine=function($J,$h,$f,$n){var $L=$J.concat(),$T=$J,$k=this.borderColor,$u=($k>>16&255)/255,$S=($k>>8&255)/255,$Y=(255&$k)/255;$L.splice(0,5);var $x,$j,$R,$l,$i,$q,$o,$r,$_,$s,$d,$p,$U,$Q,$D,$g,$F,$A,$G,$y,$O=$L.length/5,$P=$n,$W=$f/2;$R=$L[0],$l=$L[1],$s=$R-($i=$L[5]),$_=($_=-($l-($q=$L[6])))/($y=Math.sqrt($_*$_+$s*$s))*$W,$s=$s/$y*$W,$T.push($R-$_,$l-$s,$u,$S,$Y,$R+$_,$l+$s,$u,$S,$Y);for(var $I=1;$I<$O-1;$I++)$R=$L[5*($I-1)],$l=$L[5*($I-1)+1],$i=$L[5*$I],$q=$L[5*$I+1],$o=$L[5*($I+1)],$r=$L[5*($I+1)+1],$s=$R-$i,$p=$i-$o,$D=(-($_=($_=-($l-$q))/($y=Math.sqrt($_*$_+$s*$s))*$W)+$R)*(-($s=$s/$y*$W)+$q)-(-$_+$i)*(-$s+$l),$A=(-($d=($d=-($q-$r))/($y=Math.sqrt($d*$d+$p*$p))*$W)+$o)*(-($p=$p/$y*$W)+$q)-(-$d+$i)*(-$p+$r),$G=($U=-$s+$l-(-$s+$q))*($F=-$d+$i-(-$d+$o))-($g=-$p+$r-(-$p+$q))*($Q=-$_+$i-(-$_+$R)),Math.abs($G)<.1?($G+=10.1,$T.push($i-$_,$q-$s,$u,$S,$Y,$i+$_,$q+$s,$u,$S,$Y)):((($x=($Q*$A-$F*$D)/$G)-$i)*($x-$i)+(($j=($g*$D-$U*$A)/$G)-$q)+($j-$q),$T.push($x,$j,$u,$S,$Y,$i-($x-$i),$q-($j-$q),$u,$S,$Y));$R=$L[$L.length-10],$l=$L[$L.length-9],$s=$R-($i=$L[$L.length-5]),$_=($_=-($l-($q=$L[$L.length-4])))/($y=Math.sqrt($_*$_+$s*$s))*$W,$s=$s/$y*$W,$T.push($i-$_,$q-$s,$u,$S,$Y,$i+$_,$q+$s,$u,$S,$Y);var $m=this.edges+1;for($I=1;$I<$m;$I++)$h.push($P+2*($I-1),$P+2*($I-1)+1,$P+2*$I+1,$P+2*$I+1,$P+2*$I,$P+2*($I-1));return $T;},$h.createLoopLine=function($J,$h,$f,$n,$L,$T){var $k=$J.concat(),$u=$L||$J,$S=this.borderColor,$Y=($S>>16&255)/255,$x=($S>>8&255)/255,$j=(255&$S)/255;$k.splice(0,5);var $R=[$k[0],$k[1]],$l=[$k[$k.length-5],$k[$k.length-4]],$i=$l[0]+.5*($R[0]-$l[0]),$q=$l[1]+.5*($R[1]-$l[1]);$k.unshift($i,$q,0,0,0),$k.push($i,$q,0,0,0);var $o,$r,$_,$s,$d,$p,$U,$Q,$D,$g,$F,$A,$G,$y,$O,$P,$W,$I,$m,$Z,$t=$k.length/5,$c=$n,$a=$f/2;$_=$k[0],$s=$k[1],$g=$_-($d=$k[5]),$D=($D=-($s-($p=$k[6])))/($Z=Math.sqrt($D*$D+$g*$g))*$a,$g=$g/$Z*$a,$u.push($_-$D,$s-$g,$Y,$x,$j,$_+$D,$s+$g,$Y,$x,$j);for(var $B=1;$B<$t-1;$B++)$_=$k[5*($B-1)],$s=$k[5*($B-1)+1],$d=$k[5*$B],$p=$k[5*$B+1],$U=$k[5*($B+1)],$Q=$k[5*($B+1)+1],$g=$_-$d,$A=$d-$U,$O=(-($D=($D=-($s-$p))/($Z=Math.sqrt($D*$D+$g*$g))*$a)+$_)*(-($g=$g/$Z*$a)+$p)-(-$D+$d)*(-$g+$s),$I=(-($F=($F=-($p-$Q))/($Z=Math.sqrt($F*$F+$A*$A))*$a)+$U)*(-($A=$A/$Z*$a)+$p)-(-$F+$d)*(-$A+$Q),$m=($G=-$g+$s-(-$g+$p))*($W=-$F+$d-(-$F+$U))-($P=-$A+$Q-(-$A+$p))*($y=-$D+$d-(-$D+$_)),Math.abs($m)<.1?($m+=10.1,$u.push($d-$D,$p-$g,$Y,$x,$j,$d+$D,$p+$g,$Y,$x,$j)):((($o=($y*$I-$W*$O)/$m)-$d)*($o-$d)+(($r=($P*$O-$G*$I)/$m)-$p)+($r-$p),$u.push($o,$r,$Y,$x,$j,$d-($o-$d),$p-($r-$p),$Y,$x,$j));$T&&($h=$T);var $V=this.edges+1;for($B=1;$B<$V;$B++)$h.push($c+2*($B-1),$c+2*($B-1)+1,$c+2*$B+1,$c+2*$B+1,$c+2*$B,$c+2*($B-1));return $h.push($c+2*($B-1),$c+2*($B-1)+1,$c+1,$c+1,$c,$c+2*($B-1)),$u;},$J;}(),$nJ=function(){function $q(){}return $R($q,"laya.webgl.shapes.Earcut"),$q.earcut=function($J,$h,$f){$f=$f||2;var $n,$L,$T,$k,$u,$S,$Y,$x=$h&&$h.length,$j=$x?$h[0]*$f:$J.length,$R=$q.linkedList($J,0,$j,$f,!0),$l=[];if(!$R)return $l;if($x&&($R=$q.eliminateHoles($J,$h,$R,$f)),$J.length>80*$f){$n=$T=$J[0],$L=$k=$J[1];for(var $i=$f;$i<$j;$i+=$f)($u=$J[$i])<$n&&($n=$u),($S=$J[$i+1])<$L&&($L=$S),$T<$u&&($T=$u),$k<$S&&($k=$S);$Y=0!==($Y=Math.max($T-$n,$k-$L))?1/$Y:0;}return $q.earcutLinked($R,$l,$f,$n,$L,$Y),$l;},$q.linkedList=function($J,$h,$f,$n,$L){var $T,$k;if($L===0<$q.signedArea($J,$h,$f,$n))for($T=$h;$T<$f;$T+=$n)$k=$q.insertNode($T,$J[$T],$J[$T+1],$k);else for($T=$f-$n;$h<=$T;$T-=$n)$k=$q.insertNode($T,$J[$T],$J[$T+1],$k);return $k&&$q.equals($k,$k.next)&&($q.removeNode($k),$k=$k.next),$k;},$q.filterPoints=function($J,$h){if(!$J)return $J;$h||($h=$J);var $f,$n=$J;do{if($f=!1,$n.steiner||!$q.equals($n,$n.next)&&0!==$q.area($n.prev,$n,$n.next))$n=$n.next;else{if($q.removeNode($n),($n=$h=$n.prev)===$n.next)break;$f=!0;}}while($f||$n!==$h);return $h;},$q.earcutLinked=function($J,$h,$f,$n,$L,$T,$k){if($J){!$k&&$T&&$q.indexCurve($J,$n,$L,$T);for(var $u,$S,$Y=$J;$J.prev!==$J.next;)if($u=$J.prev,$S=$J.next,$T?$q.isEarHashed($J,$n,$L,$T):$q.isEar($J))$h.push($u.i/$f),$h.push($J.i/$f),$h.push($S.i/$f),$q.removeNode($J),$J=$S.next,$Y=$S.next;else if(($J=$S)===$Y){$k?1===$k?($J=$q.cureLocalIntersections($J,$h,$f),$q.earcutLinked($J,$h,$f,$n,$L,$T,2)):2===$k&&$q.splitEarcut($J,$h,$f,$n,$L,$T):$q.earcutLinked($q.filterPoints($J,null),$h,$f,$n,$L,$T,1);break;}}},$q.isEar=function($J){var $h=$J.prev,$f=$J,$n=$J.next;if(0<=$q.area($h,$f,$n))return!1;for(var $L=$J.next.next;$L!==$J.prev;){if($q.pointInTriangle($h.x,$h.y,$f.x,$f.y,$n.x,$n.y,$L.x,$L.y)&&0<=$q.area($L.prev,$L,$L.next))return!1;$L=$L.next;}return!0;},$q.isEarHashed=function($J,$h,$f,$n){var $L=$J.prev,$T=$J,$k=$J.next;if(0<=$q.area($L,$T,$k))return!1;for(var $u=$L.x<$T.x?$L.x<$k.x?$L.x:$k.x:$T.x<$k.x?$T.x:$k.x,$S=$L.y<$T.y?$L.y<$k.y?$L.y:$k.y:$T.y<$k.y?$T.y:$k.y,$Y=$L.x>$T.x?$L.x>$k.x?$L.x:$k.x:$T.x>$k.x?$T.x:$k.x,$x=$L.y>$T.y?$L.y>$k.y?$L.y:$k.y:$T.y>$k.y?$T.y:$k.y,$j=$q.zOrder($u,$S,$h,$f,$n),$R=$q.zOrder($Y,$x,$h,$f,$n),$l=$J.nextZ;$l&&$l.z<=$R;){if($l!==$J.prev&&$l!==$J.next&&$q.pointInTriangle($L.x,$L.y,$T.x,$T.y,$k.x,$k.y,$l.x,$l.y)&&0<=$q.area($l.prev,$l,$l.next))return!1;$l=$l.nextZ;}for($l=$J.prevZ;$l&&$l.z>=$j;){if($l!==$J.prev&&$l!==$J.next&&$q.pointInTriangle($L.x,$L.y,$T.x,$T.y,$k.x,$k.y,$l.x,$l.y)&&0<=$q.area($l.prev,$l,$l.next))return!1;$l=$l.prevZ;}return!0;},$q.cureLocalIntersections=function($J,$h,$f){var $n=$J;do{var $L=$n.prev,$T=$n.next.next;!$q.equals($L,$T)&&$q.intersects($L,$n,$n.next,$T)&&$q.locallyInside($L,$T)&&$q.locallyInside($T,$L)&&($h.push($L.i/$f),$h.push($n.i/$f),$h.push($T.i/$f),$q.removeNode($n),$q.removeNode($n.next),$n=$J=$T),$n=$n.next;}while($n!==$J);return $n;},$q.splitEarcut=function($J,$h,$f,$n,$L,$T){var $k=$J;do{for(var $u=$k.next.next;$u!==$k.prev;){if($k.i!==$u.i&&$q.isValidDiagonal($k,$u)){var $S=$q.splitPolygon($k,$u);return $k=$q.filterPoints($k,$k.next),$S=$q.filterPoints($S,$S.next),$q.earcutLinked($k,$h,$f,$n,$L,$T),void $q.earcutLinked($S,$h,$f,$n,$L,$T);}$u=$u.next;}$k=$k.next;}while($k!==$J);},$q.eliminateHoles=function($J,$h,$f,$n){var $L,$T,$k,$u,$S,$Y=[];for($L=0,$T=$h.length;$L<$T;$L++)$k=$h[$L]*$n,$u=$L<$T-1?$h[$L+1]*$n:$J.length,($S=$q.linkedList($J,$k,$u,$n,!1))===$S.next&&($S.steiner=!0),$Y.push($q.getLeftmost($S));for($Y.sort($q.compareX),$L=0;$L<$Y.length;$L++)$q.eliminateHole($Y[$L],$f),$f=$q.filterPoints($f,$f.next);return $f;},$q.compareX=function($J,$h){return $J.x-$h.x;},$q.eliminateHole=function($J,$h){if($h=$q.findHoleBridge($J,$h)){var $f=$q.splitPolygon($h,$J);$q.filterPoints($f,$f.next);}},$q.findHoleBridge=function($J,$h){var $f,$n=$h,$L=$J.x,$T=$J.y,$k=-1/0;do{if($T<=$n.y&&$T>=$n.next.y&&$n.next.y!==$n.y){var $u=$n.x+($T-$n.y)*($n.next.x-$n.x)/($n.next.y-$n.y);if($u<=$L&&$k<$u){if(($k=$u)===$L){if($T===$n.y)return $n;if($T===$n.next.y)return $n.next;}$f=$n.x<$n.next.x?$n:$n.next;}}$n=$n.next;}while($n!==$h);if(!$f)return null;if($L===$k)return $f.prev;var $S,$Y=$f,$x=$f.x,$j=$f.y,$R=1/0;for($n=$f.next;$n!==$Y;)$L>=$n.x&&$n.x>=$x&&$L!==$n.x&&$q.pointInTriangle($T<$j?$L:$k,$T,$x,$j,$T<$j?$k:$L,$T,$n.x,$n.y)&&(($S=Math.abs($T-$n.y)/($L-$n.x))<$R||$S===$R&&$n.x>$f.x)&&$q.locallyInside($n,$J)&&($f=$n,$R=$S),$n=$n.next;return $f;},$q.indexCurve=function($J,$h,$f,$n){for(var $L=$J;null===$L.z&&($L.z=$q.zOrder($L.x,$L.y,$h,$f,$n)),$L.prevZ=$L.prev,$L.nextZ=$L.next,($L=$L.next)!==$J;);$L.prevZ.nextZ=null,$L.prevZ=null,$q.sortLinked($L);},$q.sortLinked=function($J){var $h,$f,$n,$L,$T,$k,$u,$S,$Y=1;do{for($f=$J,$T=$J=null,$k=0;$f;){for($k++,$n=$f,$h=$u=0;$h<$Y&&($u++,$n=$n.nextZ);$h++);for($S=$Y;0<$u||0<$S&&$n;)0!==$u&&(0===$S||!$n||$f.z<=$n.z)?($f=($L=$f).nextZ,$u--):($n=($L=$n).nextZ,$S--),$T?$T.nextZ=$L:$J=$L,$L.prevZ=$T,$T=$L;$f=$n;}$T.nextZ=null,$Y*=2;}while(1<$k);return $J;},$q.zOrder=function($J,$h,$f,$n,$L){return($J=1431655765&(($J=858993459&(($J=252645135&(($J=16711935&(($J=32767*($J-$f)*$L)|$J<<8))|$J<<4))|$J<<2))|$J<<1))|($h=1431655765&(($h=858993459&(($h=252645135&(($h=16711935&(($h=32767*($h-$n)*$L)|$h<<8))|$h<<4))|$h<<2))|$h<<1))<<1;},$q.getLeftmost=function($J){for(var $h=$J,$f=$J;$h.x<$f.x&&($f=$h),($h=$h.next)!==$J;);return $f;},$q.pointInTriangle=function($J,$h,$f,$n,$L,$T,$k,$u){return 0<=($L-$k)*($h-$u)-($J-$k)*($T-$u)&&0<=($J-$k)*($n-$u)-($f-$k)*($h-$u)&&0<=($f-$k)*($T-$u)-($L-$k)*($n-$u);},$q.isValidDiagonal=function($J,$h){return $J.next.i!==$h.i&&$J.prev.i!==$h.i&&!$q.intersectsPolygon($J,$h)&&$q.locallyInside($J,$h)&&$q.locallyInside($h,$J)&&$q.middleInside($J,$h);},$q.area=function($J,$h,$f){return($h.y-$J.y)*($f.x-$h.x)-($h.x-$J.x)*($f.y-$h.y);},$q.equals=function($J,$h){return $J.x===$h.x&&$J.y===$h.y;},$q.intersects=function($J,$h,$f,$n){return!!($q.equals($J,$h)&&$q.equals($f,$n)||$q.equals($J,$n)&&$q.equals($f,$h))||0<$q.area($J,$h,$f)!=0<$q.area($J,$h,$n)&&0<$q.area($f,$n,$J)!=0<$q.area($f,$n,$h);},$q.intersectsPolygon=function($J,$h){var $f=$J;do{if($f.i!==$J.i&&$f.next.i!==$J.i&&$f.i!==$h.i&&$f.next.i!==$h.i&&$q.intersects($f,$f.next,$J,$h))return!0;$f=$f.next;}while($f!==$J);return!1;},$q.locallyInside=function($J,$h){return $q.area($J.prev,$J,$J.next)<0?0<=$q.area($J,$h,$J.next)&&0<=$q.area($J,$J.prev,$h):$q.area($J,$h,$J.prev)<0||$q.area($J,$J.next,$h)<0;},$q.middleInside=function($J,$h){for(var $f=$J,$n=!1,$L=($J.x+$h.x)/2,$T=($J.y+$h.y)/2;$f.y>$T!=$f.next.y>$T&&$f.next.y!==$f.y&&$L<($f.next.x-$f.x)*($T-$f.y)/($f.next.y-$f.y)+$f.x&&($n=!$n),($f=$f.next)!==$J;);return $n;},$q.splitPolygon=function($J,$h){var $f=new $LJ($J.i,$J.x,$J.y),$n=new $LJ($h.i,$h.x,$h.y),$L=$J.next,$T=$h.prev;return($J.next=$h).prev=$J,($f.next=$L).prev=$f,($n.next=$f).prev=$n,($T.next=$n).prev=$T,$n;},$q.insertNode=function($J,$h,$f,$n){var $L=new $LJ($J,$h,$f);return $n?($L.next=$n.next,($L.prev=$n).next.prev=$L,$n.next=$L):($L.prev=$L).next=$L,$L;},$q.removeNode=function($J){$J.next.prev=$J.prev,$J.prev.next=$J.next,$J.prevZ&&($J.prevZ.nextZ=$J.nextZ),$J.nextZ&&($J.nextZ.prevZ=$J.prevZ);},$q.signedArea=function($J,$h,$f,$n){for(var $L=0,$T=$h,$k=$f-$n;$T<$f;$T+=$n)$L+=($J[$k]-$J[$T])*($J[$T+1]+$J[$k+1]),$k=$T;return $L;},$q;}(),$LJ=function(){function $J($J,$h,$f){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=$J,this.x=$h,this.y=$f,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1;}return $R($J,"laya.webgl.shapes.EarcutNode"),$J;}(),$TJ=(function(){function $J($J,$h,$f,$n,$L,$T,$k){this.lineWidth=$J,this.lineColor=$h,this.lineAlpha=$f,this.fillColor=$n,this.fillAlpha=$L,this.shape=$k,this.fill=$T;}$R($J,"laya.webgl.shapes.GeometryData");var $h=$J.prototype;$h.clone=function(){return new $J(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape);},$h.getIndexData=function(){return null;},$h.getVertexData=function(){return null;},$h.destroy=function(){this.shape=null;};}(),function(){function $J($J){if($J instanceof Float32Array)this.points=$J;else if($J instanceof Array){$J.length;this.points=new Float32Array($J);}}$R($J,"laya.webgl.shapes.Vertex");var $h=$J.prototype;$U.imps($h,{"laya.webgl.shapes.IShape":!0}),$h.getData=function($J,$h,$f){},$h.needUpdate=function($J){return!1;},$h.rebuild=function($J){},$h.setMatrix=function($J){};}(),function(){function $S($J){void 0===$J&&($J=1e4),this._renderType=$J;}$R($S,"laya.webgl.submit.Submit");var $J=$S.prototype;return $U.imps($J,{"laya.webgl.submit.ISubmit":!0}),$J.releaseRender=function(){var $J=$S._cache;($J[$J._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null;},$J.getRenderType=function(){return this._renderType;},$J.renderSubmit=function(){if(0===this._numEle)return 1;var $J=this.shaderValue.textureHost;if($J){var $h=$J.source;if(!$J.bitmap||!$h)return 1;this.shaderValue.texture=$h,$J.alphaTexture&&$J.alphaTexture.source&&(this.shaderValue.texture1=$J.alphaTexture.source);}this._vb.bind_upload(this._ib);var $f=$dJ.mainContext;return this.shaderValue.upload(),$e.activeBlendFunction!==this._blendFn&&($f.enable(3042),this._blendFn($f),$e.activeBlendFunction=this._blendFn),$O.drawCall++,$O.trianglesFaces+=this._numEle/3,$f.drawElements(4,this._numEle,5123,this._startIdx),1;},$S.__init__=function(){var $J=$S.RENDERBASE=new $S(-1);$J.shaderValue=new $DJ(0,0),$J.shaderValue.ALPHA=-1234;},$S.createSubmit=function($J,$h,$f,$n,$L){var $T=$S._cache._length?$S._cache[--$S._cache._length]:new $S();null==$f&&(($f=$T._selfVb||($T._selfVb=$KJ.create(-1))).clear(),$n=0),$T._ib=$h,$T._vb=$f,$T._startIdx=$n*$qJ.BYTES_PIDX,$T._numEle=0;var $k=$J._nBlendType;$T._blendFn=$J._targets?$e.targetFns[$k]:$e.fns[$k],$T.shaderValue=$L,$T.shaderValue.setValue($J._shader2D);var $u=$J._shader2D.filters;return $u&&$T.shaderValue.setFilters($u),$T;},$S.createShape=function($J,$h,$f,$n,$L,$T){var $k=$S._cache._length?$S._cache[--$S._cache._length]:new $S();$k._ib=$h,$k._vb=$f,$k._numEle=$n,$k._startIdx=$L,$k.shaderValue=$T,$k.shaderValue.setValue($J._shader2D);var $u=$J._nBlendType;return $k._blendFn=$J._targets?$e.targetFns[$u]:$e.fns[$u],$k;},$S.TYPE_2D=1e4,$S.TYPE_CANVAS=10003,$S.TYPE_CMDSETRT=10004,$S.TYPE_CUSTOM=10005,$S.TYPE_BLURRT=10006,$S.TYPE_CMDDESTORYPRERT=10007,$S.TYPE_DISABLESTENCIL=10008,$S.TYPE_OTHERIBVB=10009,$S.TYPE_PRIMITIVE=10010,$S.TYPE_RT=10011,$S.TYPE_BLUR_RT=10012,$S.TYPE_TARGET=10013,$S.TYPE_CHANGE_VALUE=10014,$S.TYPE_SHAPE=10015,$S.TYPE_TEXTURE=10016,$S.TYPE_FILLTEXTURE=10017,$S.RENDERBASE=null,$S._cache=(($S._cache=[])._length=0,$S._cache),$S;}()),$kJ=function(){function $n(){this.fun=null,this.args=null;}$R($n,"laya.webgl.submit.SubmitCMD");var $J=$n.prototype;return $U.imps($J,{"laya.webgl.submit.ISubmit":!0}),$J.renderSubmit=function(){return this.fun.apply(null,this.args),1;},$J.getRenderType=function(){return 0;},$J.releaseRender=function(){var $J=$n._cache;$J[$J._length++]=this;},$n.create=function($J,$h){var $f=$n._cache._length?$n._cache[--$n._cache._length]:new $n();return $f.fun=$h,$f.args=$J,$f;},$n._cache=(($n._cache=[])._length=0,$n._cache),$n;}(),$uJ=function(){function $h(){this.variables={};}$R($h,"laya.webgl.submit.SubmitCMDScope");var $J=$h.prototype;return $J.getValue=function($J){return this.variables[$J];},$J.addValue=function($J,$h){return this.variables[$J]=$h;},$J.setValue=function($J,$h){return this.variables.hasOwnProperty($J)?this.variables[$J]=$h:null;},$J.clear=function(){for(var $J in this.variables)delete this.variables[$J];},$J.recycle=function(){this.clear(),$h.POOL.push(this);},$h.create=function(){var $J=$h.POOL.pop();return $J||($J=new $h()),$J;},$h.POOL=[],$h;}(),$SJ=function(){function $j(){this.offset=0,this.startIndex=0,this._mat=$g.create();}$R($j,"laya.webgl.submit.SubmitOtherIBVB");var $J=$j.prototype;return $U.imps($J,{"laya.webgl.submit.ISubmit":!0}),$J.releaseRender=function(){var $J=$j._cache;($J[$J._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null;},$J.getRenderType=function(){return 10009;},$J.renderSubmit=function(){var $J=this._shaderValue.textureHost;if($J){var $h=$J.source;if(!$J.bitmap||!$h)return 1;this._shaderValue.texture=$h;}this._vb.bind_upload(this._ib);var $f=$_J.worldMatrix4,$n=$g.TEMP;$g.mulPre(this._mat,$f[0],$f[1],$f[4],$f[5],$f[12],$f[13],$n);var $L=$_J.worldMatrix4=$j.tempMatrix4;$L[0]=$n.a,$L[1]=$n.b,$L[4]=$n.c,$L[5]=$n.d,$L[12]=$n.tx,$L[13]=$n.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var $T=$dJ.mainContext;return $e.activeBlendFunction!==this._blendFn&&($T.enable(3042),this._blendFn($T),$e.activeBlendFunction=this._blendFn),$O.drawCall++,$O.trianglesFaces+=this._numEle/3,$T.drawElements(4,this._numEle,5123,this.startIndex),$_J.worldMatrix4=$f,$ZJ.activeShader=null,1;},$j.create=function($J,$h,$f,$n,$L,$T,$k,$u,$S){void 0===$S&&($S=0);var $Y=$j._cache._length?$j._cache[--$j._cache._length]:new $j();$Y._ib=$f,$Y._vb=$h,$Y._numEle=$n,$Y._shader=$L,$Y._shaderValue=$T;var $x=$J._nBlendType;switch($Y._blendFn=$J._targets?$e.targetFns[$x]:$e.fns[$x],$S){case 0:$Y.offset=0,$Y.startIndex=$u/($qJ.BYTES_PE*$h.vertexStride)*1.5,$Y.startIndex*=$qJ.BYTES_PIDX;break;case 1:$Y.startIndex=$k,$Y.offset=$u;}return $Y;},$j._cache=(($j._cache=[])._length=0,$j._cache),$j.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$j;}(),$YJ=function(){function $f(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new $A(),this.screenRect=new $A();}$R($f,"laya.webgl.submit.SubmitScissor");var $J=$f.prototype;return $U.imps($J,{"laya.webgl.submit.ISubmit":!0}),$J._scissor=function($J,$h,$f,$n){var $L=$_J.worldMatrix4,$T=$L[0],$k=$L[5],$u=$L[12],$S=$L[13];if($n*=$k,($f*=$T)<1||$n<1)return!1;var $Y=($J=$J*$T+$u)+$f,$x=($h=$h*$k+$S)+$n;$J<0&&($f=$Y-($J=0)),$h<0&&($n=$x-($h=0));var $j=$_J.worldClipRect;if($J=Math.max($J,$j.x),$h=Math.max($h,$j.y),$f=Math.min($Y,$j.right)-$J,$n=Math.min($x,$j.bottom)-$h,$f<1||$n<1)return!1;var $R=$_J.worldScissorTest;return this.screenRect.copyFrom($j),$j.x=$J,$j.y=$h,$j.width=$f,$j.height=$n,$_J.worldScissorTest=!0,$h=$_J.height-$h-$n,$dJ.mainContext.scissor($J,$h,$f,$n),$dJ.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$R?($h=$_J.height-this.screenRect.y-this.screenRect.height,$dJ.mainContext.scissor(this.screenRect.x,$h,this.screenRect.width,this.screenRect.height),$dJ.mainContext.enable(3089)):($dJ.mainContext.disable(3089),$_J.worldScissorTest=!1),$j.copyFrom(this.screenRect),!0;},$J._scissorWithTagart=function($J,$h,$f,$n){if($f<1||$n<1)return!1;var $L=$J+$f,$T=$h+$n;$J<0&&($f=$L-($J=0)),$h<0&&($n=$T-($h=0));var $k=$_J.worldClipRect;if($J=Math.max($J,$k.x),$h=Math.max($h,$k.y),$f=Math.min($L,$k.right)-$J,$n=Math.min($T,$k.bottom)-$h,$f<1||$n<1)return!1;var $u=$_J.worldScissorTest;return this.screenRect.copyFrom($k),$_J.worldScissorTest=!0,$k.x=$J,$k.y=$h,$k.width=$f,$k.height=$n,$h=$_J.height-$h-$n,$dJ.mainContext.scissor($J,$h,$f,$n),$dJ.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$u?($h=$_J.height-this.screenRect.y-this.screenRect.height,$dJ.mainContext.scissor(this.screenRect.x,$h,this.screenRect.width,this.screenRect.height),$dJ.mainContext.enable(3089)):($dJ.mainContext.disable(3089),$_J.worldScissorTest=!1),$k.copyFrom(this.screenRect),!0;},$J.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1;},$J.getRenderType=function(){return 0;},$J.releaseRender=function(){var $J=$f._cache;($J[$J._length++]=this).context=null;},$f.create=function($J){var $h=$f._cache._length?$f._cache[--$f._cache._length]:new $f();return $h.context=$J,$h;},$f._cache=(($f._cache=[])._length=0,$f._cache),$f;}(),$xJ=function(){function $S(){this.step=0,this.blendMode=null,this.level=0;}$R($S,"laya.webgl.submit.SubmitStencil");var $J=$S.prototype;return $U.imps($J,{"laya.webgl.submit.ISubmit":!0}),$J.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8();}return 1;},$J.getRenderType=function(){return 0;},$J.releaseRender=function(){var $J=$S._cache;$J[$J._length++]=this;},$J.do1=function(){var $J=$dJ.mainContext;$J.enable(2960),$J.clear(1024),$J.colorMask(!1,!1,!1,!1),$J.stencilFunc(514,this.level,255),$J.stencilOp(7680,7680,7682);},$J.do2=function(){var $J=$dJ.mainContext;$J.stencilFunc(514,this.level+1,255),$J.colorMask(!0,!0,!0,!0),$J.stencilOp(7680,7680,7680);},$J.do3=function(){var $J=$dJ.mainContext;$J.colorMask(!0,!0,!0,!0),$J.stencilOp(7680,7680,7680),$J.clear(1024),$J.disable(2960);},$J.do4=function(){var $J=$dJ.mainContext;0==this.level&&($J.enable(2960),$J.clear(1024)),$J.colorMask(!1,!1,!1,!1),$J.stencilFunc(519,0,255),$J.stencilOp(7680,7680,7682);},$J.do5=function(){var $J=$dJ.mainContext;$J.stencilFunc(514,this.level,255),$J.colorMask(!0,!0,!0,!0),$J.stencilOp(7680,7680,7680);},$J.do6=function(){var $J=$dJ.mainContext;$e.targetFns[$e.TOINT[this.blendMode]]($J);},$J.do7=function(){var $J=$dJ.mainContext;$J.colorMask(!1,!1,!1,!1),$J.stencilOp(7680,7680,7683);},$J.do8=function(){var $J=$dJ.mainContext;$J.colorMask(!0,!0,!0,!0),$J.stencilFunc(514,this.level,255),$J.stencilOp(7680,7680,7680);},$S.restore=function($J,$h,$f,$n,$L){var $T;if(($J._renderKey=0)<$S._mask&&$S._mask--,0==$S._mask)$T=laya.webgl.submit.SubmitStencil.create(3),$J.addRenderObject($T),$J._curSubmit=$TJ.RENDERBASE;else{$T=laya.webgl.submit.SubmitStencil.create(7),$J.addRenderObject($T);var $k=$J._vb;$k._byteLength;if($oJ.fillRectImgVb($k,null,$h.x,$h.y,$h.width,$h.height,$m.DEF_UV,$f,$n,$L,0,0)){$J._shader2D.glTexture=null;var $u=$J._curSubmit=$TJ.createSubmit($J,$J._ib,$k,($k._byteLength-64)/32*3,$DJ.create(2,0));$u.shaderValue.ALPHA=1,$J._submits[$J._submits._length++]=$u,$J._curSubmit._numEle+=6,$J._curSubmit=$TJ.RENDERBASE;}else alert("clipRect calc stencil rect error");$T=laya.webgl.submit.SubmitStencil.create(8),$J.addRenderObject($T);}},$S.restore2=function($J,$h){var $f;($J._renderKey=0)<$S._mask&&$S._mask--,0==$S._mask?($f=laya.webgl.submit.SubmitStencil.create(3),$J.addRenderObject($f),$J._curSubmit=$TJ.RENDERBASE):($f=laya.webgl.submit.SubmitStencil.create(7),$J.addRenderObject($f),$J._submits[$J._submits._length++]=$h,$f=laya.webgl.submit.SubmitStencil.create(8),$J.addRenderObject($f));},$S.create=function($J){var $h=$S._cache._length?$S._cache[--$S._cache._length]:new $S();return 5==($h.step=$J)&&++$S._mask,$h.level=$S._mask,$h;},$S._cache=(($S._cache=[])._length=0,$S._cache),$S._mask=0,$S;}(),$jJ=function(){function $u(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null;}$R($u,"laya.webgl.submit.SubmitTarget");var $J=$u.prototype;return $U.imps($J,{"laya.webgl.submit.ISubmit":!0}),$J.renderSubmit=function(){this._vb.bind_upload(this._ib);var $J=this.scope.getValue(this.proName);return $J&&(this.shaderValue.texture=$J.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[$J.width,$J.height]),this.shaderValue.upload(),this.blend(),$O.drawCall++,$O.trianglesFaces+=this._numEle/3,$dJ.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1;},$J.blend=function(){if($e.activeBlendFunction!==$e.fns[this.blendType]){var $J=$dJ.mainContext;$J.enable(3042),$e.fns[this.blendType]($J),$e.activeBlendFunction=$e.fns[this.blendType];}},$J.getRenderType=function(){return 0;},$J.releaseRender=function(){var $J=$u._cache;($J[$J._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null;},$u.create=function($J,$h,$f,$n,$L,$T){var $k=$u._cache._length?$u._cache[--$u._cache._length]:new $u();return $k._ib=$h,$k._vb=$f,$k.proName=$T,$k._startIdx=$n*$qJ.BYTES_PIDX,$k._numEle=0,$k.blendType=$J._nBlendType,$k.shaderValue=$L,$k.shaderValue.setValue($J._shader2D),$k;},$u._cache=(($u._cache=[])._length=0,$u._cache),$u;}(),$RJ=function(){function $J(){this._sourceStr=null;}$R($J,"laya.webgl.text.CharSegment");var $h=$J.prototype;return $U.imps($h,{"laya.webgl.text.ICharSegment":!0}),$h.textToSpit=function($J){this._sourceStr=$J;},$h.getChar=function($J){return this._sourceStr.charAt($J);},$h.getCharCode=function($J){return this._sourceStr.charCodeAt($J);},$h.length=function(){return this._sourceStr.length;},$J;}(),$lJ=function(){var $J;function $O(){}return $R($O,"laya.webgl.text.DrawText"),$O.__init__=function(){$O._charsTemp=[],$O._drawValue=new $J(),$O._charSeg=new $RJ();},$O.customCharSeg=function($J){$O._charSeg=$J;},$O.getChar=function($J,$h,$f){var $n=$vJ.createOneChar($J,$f);return-1!=$h&&($O._charsCache[$h]=$n),$n;},$O._drawSlow=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$j,$R,$l,$i){var $q,$o,$r=$O._drawValue.value($T,$u,$S,$Y,$R,$l,$i),$_=0,$s=0,$d=$O._charsTemp,$p=0,$U=NaN;if($n)for($d.length=$n.length,$_=0,$s=$n.length;$_<$s;$_++)($o=$n[$_])&&($U=$o.charNum+$r.txtID,$d[$_]=$q=$O._charsCache[$U]||$O.getChar($o.char,$U,$r),$q.active());else{var $Q=$f instanceof laya.utils.WordText?$f.toString():$f;if($I.CharacterCache){$O._charSeg.textToSpit($Q);var $D=$O._charSeg.length();for($_=0,$s=$d.length=$D;$_<$s;$_++)$U=$O._charSeg.getCharCode($_)+$r.txtID,$d[$_]=$q=$O._charsCache[$U]||$O.getChar($O._charSeg.getChar($_),$U,$r),$q.active(),$p+=$q.cw;}else $d.length=0,($q=$O.getChar($Q,-1,$r)).active(),$p+=$q.cw,$d[0]=$q;}var $g=0;null!==$k&&"left"!==$k&&($g=-("center"==$k?$p/2:$p));var $F,$A,$G=NaN,$y=0;if($n)for($_=0,$s=$d.length;$_<$s;$_++)$q=$d[$_],$o=$n[$_],$q&&$o&&!$q.isSpace&&($G=$q.borderSize,$F=$q.texture,$h._drawText($F,$x+$g+$o.x*$R-$G,$j+$o.y*$l-$G,$F.width,$F.height,$L,0,0,0,0));else{for($_=0,$s=$d.length;$_<$s;$_++)($q=$d[$_])&&!$q.isSpace&&($G=$q.borderSize,$F=$q.texture,$h._drawText($F,$x+$g-$G,$j-$G,$F.width,$F.height,$L,0,0,0,0),$J&&(($A=$J[$y++])||($A=$J[$y-1]=[]),$A[0]=$F,$A[1]=$g-$G,$A[2]=-$G)),$g+=$q.cw;$J&&($J.length=$y);}},$O._drawFast=function($J,$h,$f,$n,$L){for(var $T,$k,$u=0,$S=$J.length;$u<$S;$u++)($T=($k=$J[$u])[0]).active(),$h._drawText($T,$n+$k[1],$L+$k[2],$T.width,$T.height,$f,0,0,0,0);},$O.drawText=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$j){if(void 0===$j&&($j=0),!($h&&0===$h.length||$f&&0===$f.length)){var $R=$n.a,$l=$n.d;(0!==$n.b||0!==$n.c)&&($R=$l=1);var $i=1!==$R||1!==$l;if($i&&$U.stage.transform){var $q=$U.stage.transform;$i=$q.a===$R&&$q.d===$l;}else $i=!1;if($i){var $o=($n=$n.copyTo($QJ._tmpMatrix)).tx,$r=$n.ty;$n.scale(1/$R,1/$l),$n._checkTransform(),$Y*=$R,$x*=$l,$Y+=$o-$n.tx,$x+=$r-$n.ty;}else $R=$l=1;if($f)$O._drawSlow(null,$J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$R,$l,$j);else{if(null===$h.toUpperCase){var $_=$R+1e5*$l,$s=$h;return void($s.changed||$s.id!==$_?($s.id=$_,$s.changed=!1,$O._drawSlow($s.save,$J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$R,$l,$j)):$O._drawFast($s.save,$J,$n,$Y,$x));}var $d=$h+$L.toString()+$k+$u+$S+$R+$l+$T,$p=$O._textsCache[$d];$I.CharacterCache?$p?$O._drawFast($p,$J,$n,$Y,$x):($O._textsCache.__length||($O._textsCache.__length=0),$O._textsCache.__length>$Q.WebGLTextCacheCount&&(($O._textsCache={}).__length=0,$O._curPoolIndex=0),$O._textCachesPool[$O._curPoolIndex]?($p=$O._textsCache[$d]=$O._textCachesPool[$O._curPoolIndex]).length=0:$O._textCachesPool[$O._curPoolIndex]=$p=$O._textsCache[$d]=[],$O._textsCache.__length++,$O._curPoolIndex++,$O._drawSlow($p,$J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$R,$l,$j)):$O._drawSlow($p,$J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$R,$l,$j);}}},$O._charsTemp=null,$O._textCachesPool=[],$O._curPoolIndex=0,$O._charsCache={},$O._textsCache={},$O._drawValue=null,$O.d=[],$O._charSeg=null,$O.__init$=function(){$J=function(){function $S(){}return $R($S,""),$S.prototype.value=function($J,$h,$f,$n,$L,$T,$k){this.font=$J,this.fillColor=$h,this.borderColor=$f,this.lineWidth=$n,this.scaleX=$L,this.scaleY=$T,this.underLine=$k;var $u=$J.toString()+$L+$T+$n+($h?$h.toLowerCase():" ")+($f?$f.toLowerCase():" ")+$k;return this.txtID=$S._keymap[$u],this.txtID||(this.txtID=1e-7*++$S._keymapCount,$S._keymap[$u]=this.txtID),this;},$S.clear=function(){$S._keymap={},$S._keymapCount=1;},$S._keymap={},$S._keymapCount=1,$S;}();},$O;}(),$iJ=function(){function $L($J){this._index=0,this._size=14,this._italic=-2,$L._cache2=$L._cache2||[],this.setFont($J||"14px Arial");}$R($L,"laya.webgl.text.FontInContext");var $J=$L.prototype;return $J.setFont=function($J){var $h=$L._cache2[$J];if($h)this._words=$h[0],this._size=$h[1];else{this._words=$J.split(" ");for(var $f=0,$n=this._words.length;$f<$n;$f++)if(0<this._words[$f].indexOf("px")){this._index=$f;break;}this._size=parseInt(this._words[this._index]),$L._cache2[$J]=[this._words,this._size];}this._text=null,this._italic=-2;},$J.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic;},$J.hasType=function($J){for(var $h=0,$f=this._words.length;$h<$f;$h++)if(this._words[$h]===$J)return $h;return-1;},$J.removeType=function($J){for(var $h=0,$f=this._words.length;$h<$f;$h++)if(this._words[$h]===$J){this._words.splice($h,1),this._index>$h&&this._index--;break;}this._text=null,this._italic=-2;},$J.copyTo=function($J){return $J._text=this._text,$J._size=this._size,$J._index=this._index,$J._words=this._words.slice(),$J._italic=-2,$J;},$J.toString=function(){return this._text?this._text:this._text=this._words.join(" ");},$n(0,$J,"size",function(){return this._size;},function($J){this._size=$J,this._words[this._index]=$J+"px",this._text=null;}),$L.create=function($J){var $h=$L._cache[$J];return $h||($h=$L._cache[$J]=new $L($J));},$L.EMPTY=new $L(),$L._cache={},$L._cache2=null,$L;}(),$qJ=function(){function $J(){}return $R($J,"laya.webgl.utils.CONST3D2D"),$J.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$J.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],$J.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],$J._TMPARRAY=[],$J._OFFSETX=0,$J._OFFSETY=0,$k($J,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT;},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT;}]),$J;}(),$oJ=function(){function $i(){}return $R($i,"laya.webgl.utils.GlUtils"),$i.make2DProjection=function($J,$h,$f){return[2/$J,0,0,0,0,-2/$h,0,0,0,0,2/$f,0,-1,1,0,1];},$i.fillIBQuadrangle=function($J,$h){if(65535/4<$h)throw Error("IBQuadrangle count:"+$h+" must<:"+Math.floor(65535/4));$h=Math.floor($h),$J._resizeBuffer(6*($h+1)*2,!1),$J.byteLength=$J.bufferLength;for(var $f=$J.getUint16Array(),$n=0,$L=0;$L<$h;$L++)$f[$n++]=4*$L,$f[$n++]=4*$L+2,$f[$n++]=4*$L+1,$f[$n++]=4*$L,$f[$n++]=4*$L+3,$f[$n++]=4*$L+2;return $J.setNeedUpload(),!0;},$i.expandIBQuadrangle=function($J,$h){$J.bufferLength>=6*$h*2||$i.fillIBQuadrangle($J,$h);},$i.mathCeilPowerOfTwo=function($J){return $J--,$J|=$J>>1,$J|=$J>>2,$J|=$J>>4,$J|=$J>>8,$J|=$J>>16,++$J;},$i.fillQuadrangleImgVb=function($J,$h,$f,$n,$L,$T,$k,$u){var $S=16+($J._byteLength>>2);$J.byteLength=$S<<2;var $Y=$J.getFloat32Array();$Y[($S-=16)+2]=$L[0],$Y[$S+3]=$L[1],$Y[$S+6]=$L[2],$Y[$S+7]=$L[3],$Y[$S+10]=$L[4],$Y[$S+11]=$L[5],$Y[$S+14]=$L[6],$Y[$S+15]=$L[7];var $x=$T.a,$j=$T.b,$R=$T.c,$l=$T.d;if(1!==$x||0!==$j||0!==$R||1!==$l){$T.bTransform=!0;var $i=$T.tx+$k,$q=$T.ty+$u;$Y[$S]=($n[0]+$h)*$x+($n[1]+$f)*$R+$i,$Y[$S+1]=($n[0]+$h)*$j+($n[1]+$f)*$l+$q,$Y[$S+4]=($n[2]+$h)*$x+($n[3]+$f)*$R+$i,$Y[$S+5]=($n[2]+$h)*$j+($n[3]+$f)*$l+$q,$Y[$S+8]=($n[4]+$h)*$x+($n[5]+$f)*$R+$i,$Y[$S+9]=($n[4]+$h)*$j+($n[5]+$f)*$l+$q,$Y[$S+12]=($n[6]+$h)*$x+($n[7]+$f)*$R+$i,$Y[$S+13]=($n[6]+$h)*$j+($n[7]+$f)*$l+$q;}else $T.bTransform=!1,$h+=$T.tx+$k,$f+=$T.ty+$u,$Y[$S]=$h+$n[0],$Y[$S+1]=$f+$n[1],$Y[$S+4]=$h+$n[2],$Y[$S+5]=$f+$n[3],$Y[$S+8]=$h+$n[4],$Y[$S+9]=$f+$n[5],$Y[$S+12]=$h+$n[6],$Y[$S+13]=$f+$n[7];return $J._upload=!0;},$i.fillTranglesVB=function($J,$h,$f,$n,$L,$T,$k){var $u=($J._byteLength>>2)+$n.length;$J.byteLength=$u<<2;var $S=$J.getFloat32Array();$u-=$n.length;for(var $Y=$n.length,$x=$L.a,$j=$L.b,$R=$L.c,$l=$L.d,$i=0;$i<$Y;$i+=4)if($S[$u+$i+2]=$n[$i+2],$S[$u+$i+3]=$n[$i+3],1!==$x||0!==$j||0!==$R||1!==$l){$L.bTransform=!0;var $q=$L.tx+$T,$o=$L.ty+$k;$S[$u+$i]=($n[$i]+$h)*$x+($n[$i+1]+$f)*$R+$q,$S[$u+$i+1]=($n[$i]+$h)*$j+($n[$i+1]+$f)*$l+$o;}else $L.bTransform=!1,$h+=$L.tx+$T,$f+=$L.ty+$k,$S[$u+$i]=$h+$n[$i],$S[$u+$i+1]=$f+$n[$i+1];return $J._upload=!0;},$i.copyPreImgVb=function($J,$h,$f){var $n=$J._byteLength>>2;$J.byteLength=$n+16<<2;for(var $L=$J.getFloat32Array(),$T=0,$k=$n-16;$T<4;$T++)$L[$n]=$L[$k]+$h,++$k,$L[++$n]=$L[$k]+$f,++$k,$L[++$n]=$L[$k],++$k,$L[++$n]=$L[$k],++$n,++$k;$J._upload=!0;},$i.fillRectImgVb=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$j,$R){void 0===$R&&($R=!1);var $l,$i,$q,$o,$r,$_,$s,$d,$p,$U,$Q,$D,$g,$F,$A,$G,$y=1,$O=$u.a,$P=$u.b,$W=$u.c,$I=$u.d,$m=$h&&$h.width<99999999;if(1!==$O||0!==$P||0!==$W||1!==$I?($u.bTransform=!0,0===$P&&0===$W&&($y=23,$p=$L+$f,$U=$T+$n,$l=$O*$f+($Q=$u.tx+$S),$q=$O*$p+$Q,$i=$I*$n+($D=$u.ty+$Y),$o=$I*$U+$D)):($y=23,$u.bTransform=!1,$q=($l=$f+$u.tx+$S)+$L,$o=($i=$n+$u.ty+$Y)+$T),$m&&($r=$h.x,$_=$h.y,$s=$h.width+$r,$d=$h.height+$_),1!==$y){if(Math.min($l,$q)>=$s)return!1;if(Math.min($i,$o)>=$d)return!1;if(Math.max($q,$l)<=$r)return!1;if(Math.max($o,$i)<=$_)return!1;}var $Z=$J._byteLength>>2;$J.byteLength=16+$Z<<2;var $t=$J.getFloat32Array();switch($t[2+$Z]=$k[0],$t[3+$Z]=$k[1],$t[6+$Z]=$k[2],$t[7+$Z]=$k[3],$t[10+$Z]=$k[4],$t[11+$Z]=$k[5],$t[14+$Z]=$k[6],$t[15+$Z]=$k[7],$y){case 1:$Q=$u.tx+$S,$D=$u.ty+$Y;var $c=$O*$f,$a=$W*$n,$B=$I*$n,$V=$P*$f,$C=$O*($p=$L+$f),$e=$W*($U=$T+$n),$H=$I*$U,$b=$P*$p;$R?($g=$c+$a+$Q,$A=Math.round($g)-$g,$F=$B+$V+$D,$G=Math.round($F)-$F,$t[$Z]=$g+$A,$t[1+$Z]=$F+$G,$t[4+$Z]=$C+$a+$Q+$A,$t[5+$Z]=$B+$b+$D+$G,$t[8+$Z]=$C+$e+$Q+$A,$t[9+$Z]=$H+$b+$D+$G,$t[12+$Z]=$c+$e+$Q+$A,$t[13+$Z]=$H+$V+$D+$G):($t[$Z]=$c+$a+$Q,$t[1+$Z]=$B+$V+$D,$t[4+$Z]=$C+$a+$Q,$t[5+$Z]=$B+$b+$D,$t[8+$Z]=$C+$e+$Q,$t[9+$Z]=$H+$b+$D,$t[12+$Z]=$c+$e+$Q,$t[13+$Z]=$H+$V+$D);break;case 23:$R?($g=$l+$x,$A=Math.round($g)-$g,$F=$i,$G=Math.round($F)-$F,$t[$Z]=$g+$A,$t[1+$Z]=$F+$G,$t[4+$Z]=$q+$x+$A,$t[5+$Z]=$i+$G,$t[8+$Z]=$q+$A,$t[9+$Z]=$o+$G,$t[12+$Z]=$l+$A,$t[13+$Z]=$o+$G):($t[$Z]=$l+$x,$t[1+$Z]=$i,$t[4+$Z]=$q+$x,$t[5+$Z]=$i,$t[8+$Z]=$q,$t[9+$Z]=$o,$t[12+$Z]=$l,$t[13+$Z]=$o);}return $J._upload=!0;},$i.fillLineVb=function($J,$h,$f,$n,$L,$T,$k,$u){var $S=.5*$k,$Y=$i._fillLineArray,$x=-($n-$T),$j=$f-$L,$R=Math.sqrt($x*$x+$j*$j);$x/=$R,$j/=$R,$x*=$S,$j*=$S,$Y[0]=$f-$x,$Y[1]=$n-$j,$Y[4]=$f+$x,$Y[5]=$n+$j,$Y[8]=$L+$x,$Y[9]=$T+$j,$Y[12]=$L-$x,$Y[13]=$T-$j,$u&&$u.transformPointArray($Y,$Y);var $l=16+($J._byteLength>>2);return $J.byteLength=$l<<2,$J.insertData($Y,$l-16),!0;},$i._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$i;}(),$rJ=(function(){function $S(){}$R($S,"laya.webgl.utils.MatirxArray"),$S.ArrayMul=function($J,$h,$f){if($J){if($h)for(var $n=NaN,$L=NaN,$T=NaN,$k=NaN,$u=0;$u<4;$u++)$n=$J[$u],$L=$J[$u+4],$T=$J[$u+8],$k=$J[$u+12],$f[$u]=$n*$h[0]+$L*$h[1]+$T*$h[2]+$k*$h[3],$f[$u+4]=$n*$h[4]+$L*$h[5]+$T*$h[6]+$k*$h[7],$f[$u+8]=$n*$h[8]+$L*$h[9]+$T*$h[10]+$k*$h[11],$f[$u+12]=$n*$h[12]+$L*$h[13]+$T*$h[14]+$k*$h[15];else $S.copyArray($J,$f);}else $S.copyArray($h,$f);},$S.copyArray=function($J,$h){if($J&&$h)for(var $f=0;$f<$J.length;$f++)$h[$f]=$J[$f];};}(),function(){function $h($J,$h,$f){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=$J,this._vb=new $KJ($J,35048),$h&&this._vb._resizeBuffer($h,!1),this._ib=new $zJ(),$f&&this._ib._resizeBuffer($f,!1);}$R($h,"laya.webgl.utils.Mesh2D");var $J=$h.prototype;return $J.cloneWithNewVB=function(){var $J=new $h(this._stride,0,0);return $J._ib=this._ib,$J._quadNum=this._quadNum,$J._attribInfo=this._attribInfo,$J;},$J.cloneWithNewVBIB=function(){var $J=new $h(this._stride,0,0);return $J._attribInfo=this._attribInfo,$J;},$J.getVBW=function(){return this._vb.setNeedUpload(),this._vb;},$J.getVBR=function(){return this._vb;},$J.getIBR=function(){return this._ib;},$J.getIBW=function(){return this._ib.setNeedUpload(),this._ib;},$J.createQuadIB=function($J){this._quadNum=$J,this._ib._resizeBuffer(6*$J*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var $h=this._ib.getUint16Array(),$f=0,$n=0,$L=0;$L<$J;$L++)$h[$f++]=$n,$h[$f++]=$n+2,$h[$f++]=$n+1,$h[$f++]=$n,$h[$f++]=$n+3,$h[$f++]=$n+2,$n+=4;this._ib.setNeedUpload();},$J.setAttributes=function($J){if(this._attribInfo=$J,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!";},$J.getEleNum=function(){return this._ib.getBuffer().byteLength/2;},$J.releaseMesh=function(){},$J.destroy=function(){},$J.clearVB=function(){this._vb.clear();},$h._gvaoid=0,$h;}()),$_J=function(){function $L(){}return $R($L,"laya.webgl.utils.RenderState2D"),$L.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];},$L.mat2MatArray=function($J,$h){var $f=$J,$n=$h;return $n[0]=$f.a,$n[1]=$f.b,$n[2]=$L.EMPTYMAT4_ARRAY[2],$n[3]=$L.EMPTYMAT4_ARRAY[3],$n[4]=$f.c,$n[5]=$f.d,$n[6]=$L.EMPTYMAT4_ARRAY[6],$n[7]=$L.EMPTYMAT4_ARRAY[7],$n[8]=$L.EMPTYMAT4_ARRAY[8],$n[9]=$L.EMPTYMAT4_ARRAY[9],$n[10]=$L.EMPTYMAT4_ARRAY[10],$n[11]=$L.EMPTYMAT4_ARRAY[11],$n[12]=$f.tx,$n[13]=$f.ty,$n[14]=$L.EMPTYMAT4_ARRAY[14],$n[15]=$L.EMPTYMAT4_ARRAY[15],$h;},$L.restoreTempArray=function(){$L.TEMPMAT4_ARRAY[0]=1,$L.TEMPMAT4_ARRAY[1]=0,$L.TEMPMAT4_ARRAY[4]=0,$L.TEMPMAT4_ARRAY[5]=1,$L.TEMPMAT4_ARRAY[12]=0,$L.TEMPMAT4_ARRAY[13]=0;},$L.clear=function(){$L.worldScissorTest=!1,$L.worldShaderDefines=null,$L.worldFilters=null,$L.worldAlpha=1,$L.worldClipRect.x=$L.worldClipRect.y=0,$L.worldClipRect.width=$L.width,$L.worldClipRect.height=$L.height,$L.curRenderTarget=null;},$L._MAXSIZE=99999999,$L.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$L.worldMatrix4=$L.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$L.worldAlpha=1,$L.worldScissorTest=!1,$L.worldFilters=null,$L.worldShaderDefines=null,$L.curRenderTarget=null,$L.width=0,$L.height=0,$k($L,["worldMatrix",function(){return this.worldMatrix=new $g();},"worldClipRect",function(){return this.worldClipRect=new $A(0,0,99999999,99999999);}]),$L;}(),$sJ=function(){var $_,$f;function $s($J,$h,$f,$n,$L){var $T=this;function $k($J){var $h=[],$f=new $_($h);return $T._compileToTree($f,$J.split("\n"),0,$h,$L),$f;}var $u=$l.now();this._VS=$k($h),this._PS=$k($f),this._nameMap=$n,2<$l.now()-$u&&console.log("ShaderCompile use time:"+($l.now()-$u)+"  size:"+$h.length+"/"+$f.length);}$R($s,"laya.webgl.utils.ShaderCompile");var $J=$s.prototype;return $J._compileToTree=function($J,$h,$f,$n,$L){var $T,$k,$u,$S,$Y,$x,$j,$R=0,$l=0,$i=0,$q=0;for($l=$f;$l<$h.length;$l++)if(!(($u=$h[$l]).length<1)&&0!==($R=$u.indexOf("//"))){if(0<=$R&&($u=$u.substr(0,$R)),$T=$j||new $_($n),$j=null,$T.text=$u,$T.noCompile=!0,0<=($R=$u.indexOf("#"))){for($S="#",$q=$R+1,$i=$u.length;$q<$i;$q++){var $o=$u.charAt($q);if(" "===$o||"\t"===$o||"\r"===$o||"\n"===$o||"?"===$o)break;$S+=$o;}switch($T.name=$S){case"#ifdef":case"#ifndef":if($T.src=$u,$T.noCompile=null!=$u.match(/[!&|()=<>]/),$T.noCompile?console.log("function():Boolean{return "+$u.substr($R+$T.name.length)+"}"):($x=$u.replace(/^\s*/,"").split(/\s+/),$T.setCondition($x[1],"#ifdef"===$S?1:2),$T.text="//"+$T.text),$T.setParent($J),$J=$T,$L)for($x=$u.substr($q).split($s._splitToWordExps3),$q=0;$q<$x.length;$q++)($u=$x[$q]).length&&($L[$u]=!0);continue;case"#if":if($T.src=$u,$T.noCompile=!0,$T.setParent($J),$J=$T,$L)for($x=$u.substr($q).split($s._splitToWordExps3),$q=0;$q<$x.length;$q++)($u=$x[$q]).length&&"defined"!=$u&&($L[$u]=!0);continue;case"#else":$T.src=$u,$k=($J=$J.parent).childs[$J.childs.length-1],$T.noCompile=$k.noCompile,$T.noCompile||($T.condition=$k.condition,$T.conditionType=1==$k.conditionType?2:1,$T.text="//"+$T.text+" "+$k.text+" "+$T.conditionType),$T.setParent($J),$J=$T;continue;case"#endif":$k=($J=$J.parent).childs[$J.childs.length-1],$T.noCompile=$k.noCompile,$T.noCompile||($T.text="//"+$T.text),$T.setParent($J);continue;case"#include":$x=$s.splitToWords($u,null);var $r=$s.includes[$x[1]];if(!$r)throw"ShaderCompile error no this include file:"+$x[1];if(($R=$x[0].indexOf("?"))<0){$T.setParent($J),$u=$r.getWith("with"==$x[2]?$x[3]:null),this._compileToTree($T,$u.split("\n"),0,$n,$L),$T.text="";continue;}$T.setCondition($x[0].substr($R+1),1),$T.text=$r.getWith("with"==$x[2]?$x[3]:null);break;case"#import":$Y=($x=$s.splitToWords($u,null))[1],$n.push({node:$T,file:$s.includes[$Y],ofs:$T.text.length});continue;}}else{if(($k=$J.childs[$J.childs.length-1])&&!$k.name){0<$n.length&&$s.splitToWords($u,$k),$j=$T,$k.text+="\n"+$u;continue;}0<$n.length&&$s.splitToWords($u,$T);}$T.setParent($J);}},$J.createShader=function($J,$h,$f){var $n={},$L="";if($J)for(var $T in $J)$L+="#define "+$T+"\n",$n[$T]=!0;var $k=this._VS.toscript($n,[]),$u=this._PS.toscript($n,[]);return($f||$XJ.create)($L+$k.join("\n"),$L+$u.join("\n"),$h,this._nameMap);},$s._parseOne=function($J,$h,$f,$n,$L,$T){var $k={type:$s.shaderParamsMap[$f[$n+1]],name:$f[$n+2],size:isNaN(parseInt($f[$n+3]))?1:parseInt($f[$n+3])};return $T&&("attribute"==$L?$J.push($k):$h.push($k)),":"==$f[$n+3]&&($k.type=$f[$n+4],$n+=2),$n+=2;},$s.addInclude=function($J,$h){if(!$h||0===$h.length)throw new Error("add shader include file err:"+$J);if($s.includes[$J])throw new Error("add shader include file err, has add:"+$J);$s.includes[$J]=new $f($h);},$s.preGetParams=function($J,$h){var $f=[$J,$h],$n={},$L=[],$T=[],$k={},$u=[];$n.attributes=$L,$n.uniforms=$T,$n.defines=$k;for(var $S=0,$Y=0,$x=0;$x<2;$x++){$f[$x]=$f[$x].replace($s._removeAnnotation,"");var $j,$R=$f[$x].match($s._reg);for($S=0,$Y=$R.length;$S<$Y;$S++){var $l=$R[$S];if("attribute"==$l||"uniform"==$l)$S=$s._parseOne($L,$T,$R,$S,$l,!0);else{if("#define"==$l){$u[$l=$R[++$S]]=1;continue;}if("#ifdef"==$l){$k[$j=$R[++$S]]=$k[$j]||[];for($S++;$S<$Y;$S++)if("attribute"==($l=$R[$S])||"uniform"==$l)$S=$s._parseOne($L,$T,$R,$S,$l,$u[$j]);else if("#else"==$l)for($S++;$S<$Y;$S++)if("attribute"==($l=$R[$S])||"uniform"==$l)$S=$s._parseOne($L,$T,$R,$S,$l,!$u[$j]);else if("#endif"==$l)break;}}}}return $n;},$s.splitToWords=function($J,$h){for(var $f,$n,$L=[],$T=-1,$k=0,$u=$J.length;$k<$u;$k++)if($f=$J.charAt($k),0<=" \t=+-*/&%!<>()'\",;".indexOf($f)){if(0<=$T&&1<$k-$T&&($n=$J.substr($T,$k-$T),$L.push($n)),'"'==$f||"'"==$f){var $S=$J.indexOf($f,$k+1);if($S<0)throw"Sharder err:"+$J;$L.push($J.substr($k+1,$S-$k-1)),$k=$S,$T=-1;continue;}"("==$f&&$h&&0<$L.length&&($n=$L[$L.length-1]+";","vec4;main;".indexOf($n)<0&&($h.useFuns+=$n)),$T=-1;}else $T<0&&($T=$k);return $T<$u&&1<$u-$T&&($n=$J.substr($T,$u-$T),$L.push($n)),$L;},$s.IFDEF_NO=0,$s.IFDEF_YES=1,$s.IFDEF_ELSE=2,$s.IFDEF_PARENT=3,$s._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),$s._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),$s._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),$s.includes={},$k($s,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680};},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g");}]),$s.__init$=function(){$_=function(){function $f($J){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=$J;}$R($f,"");var $J=$f.prototype;return $J.setParent=function($J){$J.childs.push(this),this.z=$J.z+1,this.parent=$J;},$J.setCondition=function($J,$h){$J&&(this.conditionType=$h,$J=$J.replace(/(\s*$)/g,""),this.condition=function(){return this[$J];},this.condition.__condition=$J);},$J.toscript=function($J,$h){return this._toscript($J,$h,++$f.__id);},$J._toscript=function($n,$L,$T){if(this.childs.length<1&&!this.text)return $L;$L.length;if(this.condition){var $J=!!this.condition.call($n);if(2===this.conditionType&&($J=!$J),!$J)return $L;}if(this.text&&$L.push(this.text),0<this.childs.length&&this.childs.forEach(function($J,$h,$f){$J._toscript($n,$L,$T);}),0<this.includefiles.length&&0<this.useFuns.length)for(var $h,$f=0,$k=this.includefiles.length;$f<$k;$f++)this.includefiles[$f].curUseID!=$T&&0<($h=this.includefiles[$f].file.getFunsScript(this.useFuns)).length&&(this.includefiles[$f].curUseID=$T,$L[0]=$h+$L[0]);return $L;},$f.__id=1,$f;}(),$f=function(){function $J($J){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=$J;for(var $h=0,$f=0,$n=0;!(($h=$J.indexOf("#begin",$h))<0);){for($n=$h+5;!(($n=$J.indexOf("#end",$n))<0)&&"i"===$J.charAt($n+4);)$n+=5;if($n<0)throw"add include err,no #end:"+$J;$f=$J.indexOf("\n",$h);var $L=$s.splitToWords($J.substr($h,$f-$h),null);"code"==$L[1]?this.codes[$L[2]]=$J.substr($f+1,$n-$f-1):"function"==$L[1]&&($f=$J.indexOf("function",$h),$f+="function".length,this.funs[$L[3]]=$J.substr($f+1,$n-$f-1),this.funnames+=$L[3]+";"),$h=$n+1;}}$R($J,"");var $h=$J.prototype;return $h.getWith=function($J){var $h=$J?this.codes[$J]:this.script;if(!$h)throw"get with error:"+$J;return $h;},$h.getFunsScript=function($J){var $h="";for(var $f in this.funs)0<=$J.indexOf($f+";")&&($h+=this.funs[$f]);return $h;},$J;}();},$s;}(),$dJ=function(){function $k(){}return $R($k,"laya.webgl.WebGL"),$k._uint8ArraySlice=function(){for(var $J=this.length,$h=new Uint8Array(this.length),$f=0;$f<$J;$f++)$h[$f]=this[$f];return $h;},$k._float32ArraySlice=function(){for(var $J=this.length,$h=new Float32Array(this.length),$f=0;$f<$J;$f++)$h[$f]=this[$f];return $h;},$k._uint16ArraySlice=function($J){var $h,$f=arguments,$n=0,$L=0;if(0===$f.length)for($n=this.length,$h=new Uint16Array($n),$L=0;$L<$n;$L++)$h[$L]=this[$L];else if(2===$f.length){var $T=$f[0],$k=$f[1];if($T<$k)for($n=$k-$T,$h=new Uint16Array($n),$L=$T;$L<$k;$L++)$h[$L-$T]=this[$L];else $h=new Uint16Array(0);}return $h;},$k.expandContext=function(){var $J=$L.prototype,$h=CanvasRenderingContext2D.prototype;$h.fillTrangles=$J.fillTrangles,$wJ.__int__(null),$h.setIBVB=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){void 0===$S&&($S=0),void 0===$Y&&($Y=0),null===$f&&(this._ib=this._ib||$zJ.QuadrangleIB,$f=this._ib,$oJ.expandIBQuadrangle($f,$n._byteLength/64+8)),this._setIBVB($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y);},$h.fillTrangles=function($J,$h,$f,$n,$L){this._curMat=this._curMat||$g.create(),this._vb=this._vb||$KJ.create(),this._ib||(this._ib=$zJ.create(),$oJ.fillIBQuadrangle(this._ib,$k/4));var $T=this._vb,$k=$n.length>>4;$oJ.fillTranglesVB($T,$h,$f,$n,$L||this._curMat,0,0),$oJ.expandIBQuadrangle(this._ib,$T._byteLength/64+8);var $u=new $DJ(1,0);$u.textureHost=$J;var $S=new $NJ("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");$T._vertType=3,this._setIBVB($h,$f,this._ib,$T,6*$k,$L,$S,$u,0,0);};},$k.enable=function(){if($l.__init__(),$r.isConchApp&&!$r.isConchWebGL)return $p.skinAniSprite=function(){return new $JJ();},$k.expandContext(),!1;if($p.getWebGLContext=function($J){for(var $h,$f=["webgl","experimental-webgl","webkit-3d","moz-webgl"],$n=0;$n<$f.length;$n++){try{$h=$J.getContext($f[$n],{stencil:$Q.isStencil,alpha:$Q.isAlpha,antialias:$Q.isAntialias,premultipliedAlpha:$Q.premultipliedAlpha,preserveDrawingBuffer:$Q.preserveDrawingBuffer});}catch($J){}if($h)return $h;}return null;},null==($k.mainContext=$k.mainContext||$p.getWebGLContext($r._mainCanvas)))return!1;if($r.isWebGL)return!0;$q.create=function($J,$h){return new $Jh($J,$h);},$o.create=function($J,$h,$f,$n,$L,$T,$k){return new $MJ($J,$h,$f,$n,$L,$T,$k);},$r.WebGL=$k,$r.isWebGL=!0,$lJ.__init__(),$p.createRenderSprite=function($J,$h){return new $gJ($J,$h);},$p.createWebGLContext2D=function($J){return new $QJ($J);},$p.changeWebGLSize=function($J,$h){laya.webgl.WebGL.onStageResize($J,$h);},$p.createGraphics=function(){return new $UJ();};var $J=$p.createFilterAction;return $p.createFilterAction=$J||function($J){return new $FJ();},$p.clear=function($J){$_J.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var $h=$r.context.ctx,$f=0==$h._submits._length||$Q.preserveDrawingBuffer?$i.create($J)._color:$y._wgColor;$f&&$h.clearBG($f[0],$f[1],$f[2],$f[3]),$_J.clear();},$p.addToAtlas=function($J,$h){void 0===$h&&($h=!1);var $f=$J.bitmap;$r.optimizeTextureMemory($J.url,$J)?$U.__typeof($f,"laya.webgl.resource.IMergeAtlasBitmap")&&$f.allowMerageInAtlas&&$f.on("recovered",$J,$J.addTextureToAtlas):$f.enableMerageInAtlas=!1;},$p.isAtlas=function($J){return $J instanceof laya.webgl.atlas.AtlasWebGLCanvas;},$V._enable(),$p.beginFlush=function(){for(var $J=$V.instance,$h=$J.getAtlaserCount(),$f=0;$f<$h;$f++){var $n=$J.getAtlaserByIndex($f).texture;$n._flashCacheImageNeedFlush&&$p.flashFlushImage($n);}},$p.drawToCanvas=function($J,$h,$f,$n,$L,$T){($f<=0||$n<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),$f|=0,$n|=0,$L|=0,$T|=0;var $k=$tJ.create($f,$n,6408,5121,0,!1);$k.start(),$k.clear(0,0,0,0),$r.context.clear(),$_.renders[$h]._fun($J,$r.context,$L,$_J.height-$n+$T),$r.context.flush(),$k.end();var $u=$k.getData(0,0,$f,$n);if($k.recycle(),$u.byteLength==$f*$n*4){var $S=new $bJ();$S._canvas=$l.createElement("canvas"),$S.size($f,$n);var $Y=$S._canvas.getContext("2d");$l.canvas.size($f,$n);var $x=$l.context,$j=$x.createImageData($f,$n);return $j.data.set(new Uint8ClampedArray($u.buffer)),$S._imgData=$j,$x.putImageData($j,0,0),$Y.save(),$Y.translate(0,$n),$Y.scale(1,-1),$Y.drawImage($l.canvas.source,0,0),$Y.restore(),$S;}console.log("drawToCanvas error: w:"+$f+",h:"+$n+",datalen:"+$u.byteLength);},$p.createFilterAction=function($J){var $h;switch($J){case 32:$h=new $FJ();}return $h;},$p.addTextureToAtlas=function($J){$J._uvID++,$V._atlasRestore++,$J.bitmap.enableMerageInAtlas&&$V.instance.addToAtlas($J);},$p.getTexturePixels=function($J,$h,$f,$n,$L){$r.context.ctx.clear();var $T=new $G();$T.graphics.drawTexture($J,-$h,-$f);var $k=$tJ.create($n,$L);$k.start(),$k.clear(0,0,0,0),$T.render($r.context,0,0),$r.context.ctx.flush(),$k.end();for(var $u=$k.getData(0,0,$n,$L),$S=[],$Y=0,$x=$L-1;0<=$x;$x--)for(var $j=0;$j<$n;$j++)$Y=4*($x*$n+$j),$S.push($u[$Y]),$S.push($u[$Y+1]),$S.push($u[$Y+2]),$S.push($u[$Y+3]);return $S;},$p.skinAniSprite=function(){return new $JJ();},$Y.create=function($J,$h){var $f=new $bJ();return $f._imgData=$h,$f.flipY=!1,$f;},$D._filterStart=function($J,$h,$f,$n,$L){var $T=$J.getValue("bounds"),$k=$tJ.create($T.width,$T.height);if($k.start(),$k.clear(0,0,0,0),$J.addValue("src",$k),$J.addValue("ScissorTest",$_J.worldScissorTest),$_J.worldScissorTest){var $u=new $A();$u.copyFrom($f.ctx._clipRect),$J.addValue("clipRect",$u),$_J.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089);}},$D._filterEnd=function($J,$h,$f,$n,$L){var $T=$J.getValue("bounds");$J.getValue("src").end();var $k=$tJ.create($T.width,$T.height);$k.start(),$k.clear(0,0,0,0),$J.addValue("out",$k),$h._set$P("_filterCache",$k),$h._set$P("_isHaveGlowFilter",$J.getValue("_isHaveGlowFilter"));},$D._EndTarget=function($J,$h){if($J.getValue("src").recycle(),$J.getValue("out").end(),$J.getValue("ScissorTest")){$_J.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),$h.ctx.save();var $f=$J.getValue("clipRect");$h.ctx.clipRect($f.x,$f.y,$f.width,$f.height);}},$D._useSrc=function($J){var $h=$J.getValue("out");$h.end(),($h=$J.getValue("src")).start(),$h.clear(0,0,0,0);},$D._endSrc=function($J){$J.getValue("src").end();},$D._useOut=function($J){var $h=$J.getValue("src");$h.end(),($h=$J.getValue("out")).start(),$h.clear(0,0,0,0);},$D._endOut=function($J){$J.getValue("out").end();},$D._recycleScope=function($J){$J.recycle();},$D._filter=function($J,$h,$f,$n){var $L=this._next;if($L){var $T,$k,$u=$J.filters,$S=$u.length;if(1==$S&&32==$u[0].type)return $h.ctx.save(),$h.ctx.setFilters([$u[0]]),$L._fun.call($L,$J,$h,$f,$n),void $h.ctx.restore();var $Y=$uJ.create(),$x=$F.TEMP,$j=$h.ctx._getTransformMatrix(),$R=$g.create();$j.copyTo($R);var $l=0,$i=0,$q=!1,$o=$J._$P._filterCache?$J._$P._filterCache:null;if(!$o||$J._repaint){$q=$J._isHaveGlowFilter(),$Y.addValue("_isHaveGlowFilter",$q),$q&&($l=50,$i=25),($k=new $A()).copyFrom($J.getSelfBounds()),$k.x+=$J.x,$k.y+=$J.y,$k.x-=$J.pivotX+4,$k.y-=$J.pivotY+4;var $r=$k.x,$_=$k.y;if($k.width+=$l+8,$k.height+=$l+8,$x.x=$k.x*$R.a+$k.y*$R.c,$x.y=$k.y*$R.d+$k.x*$R.b,$k.x=$x.x,$k.y=$x.y,$x.x=$k.width*$R.a+$k.height*$R.c,$x.y=$k.height*$R.d+$k.width*$R.b,$k.width=$x.x,$k.height=$x.y,$k.width<=0||$k.height<=0)return;$o&&$o.recycle(),$Y.addValue("bounds",$k);var $s=$kJ.create([$Y,$J,$h,0,0],$D._filterStart);$h.addRenderObject($s),$h.ctx._renderKey=0,$h.ctx._shader2D.glTexture=null;var $d=$J.x-$r+$i,$p=$J.y-$_+$i;$L._fun.call($L,$J,$h,$d,$p),$s=$kJ.create([$Y,$J,$h,0,0],$D._filterEnd),$h.addRenderObject($s);for(var $U=0;$U<$S;$U++){0!=$U&&($s=$kJ.create([$Y],$D._useSrc),$h.addRenderObject($s),$T=$DJ.create(1,0),$g.TEMP.identity(),$h.ctx.drawTarget($Y,0,0,$k.width,$k.height,$g.TEMP,"out",$T,null,$e.TOINT.overlay),$s=$kJ.create([$Y],$D._useOut),$h.addRenderObject($s)),$u[$U].action.apply3d($Y,$J,$h,0,0);}$s=$kJ.create([$Y,$h],$D._EndTarget),$h.addRenderObject($s);}else{if(($q=!!$J._$P._isHaveGlowFilter&&$J._$P._isHaveGlowFilter)&&($l=50,$i=25),($k=$J.getBounds()).width<=0||$k.height<=0)return;$k.width+=$l,$k.height+=$l,$x.x=$k.x*$R.a+$k.y*$R.c,$x.y=$k.y*$R.d+$k.x*$R.b,$k.x=$x.x,$k.y=$x.y,$x.x=$k.width*$R.a+$k.height*$R.c,$x.y=$k.height*$R.d+$k.width*$R.b,$k.width=$x.x,$k.height=$x.y,$Y.addValue("out",$o);}$f=$f-$i-$J.x,$n=$n-$i-$J.y,$x.setTo($f,$n),$R.transformPoint($x),$f=$x.x+$k.x,$n=$x.y+$k.y,$T=$DJ.create(1,0),$g.TEMP.identity(),$h.ctx.drawTarget($Y,$f,$n,$k.width,$k.height,$g.TEMP,"out",$T,null,$e.TOINT.overlay),$s=$kJ.create([$Y],$D._recycleScope),$h.addRenderObject($s),$R.destroy();}},Float32Array.prototype.slice||(Float32Array.prototype.slice=$k._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=$k._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=$k._uint8ArraySlice),!0;},$k.onStageResize=function($J,$h){null!=$k.mainContext&&($k.mainContext.viewport(0,0,$J,$h),$_J.width=$J,$_J.height=$h);},$k.onInvalidGLRes=function(){$V.instance.freeAll(),$d.releaseContentManagers(!0),$k.doNodeRepaint($U.stage),$k.mainContext.viewport(0,0,$_J.width,$_J.height),$U.stage.event("devicelost");},$k.doNodeRepaint=function($J){0==$J.numChildren&&$J.repaint();for(var $h=0;$h<$J.numChildren;$h++)$k.doNodeRepaint($J.getChildAt($h));},$k.init=function($J,$h,$f){$k.mainCanvas=$J,$Y._createContext=function($J){return new $QJ($J);},$bJ._createContext=function($J){return new $QJ($J);};var $n=laya.webgl.WebGL.mainContext;if(null!=$n.getShaderPrecisionFormat){var $L=$n.getShaderPrecisionFormat(35633,36338),$T=$n.getShaderPrecisionFormat(35632,36338);$k.shaderHighPrecision=!(!$L.precision||!$T.precision);}else $k.shaderHighPrecision=!1;if($k.compressAstc=$n.getExtension("WEBGL_compressed_texture_astc"),$k.compressAtc=$n.getExtension("WEBGL_compressed_texture_atc"),$k.compressEtc=$n.getExtension("WEBGL_compressed_texture_etc"),$k.compressEtc1=$n.getExtension("WEBGL_compressed_texture_etc1"),$k.compressPvrtc=$n.getExtension("WEBGL_compressed_texture_pvrtc"),$k.compressS3tc=$n.getExtension("WEBGL_compressed_texture_s3tc"),$k.compressS3tc_srgb=$n.getExtension("WEBGL_compressed_texture_s3tc_srgb"),$k.compressAstc=$k.compressAstc?$k.compressAstc:{},$k.compressAtc=$k.compressAtc?$k.compressAtc:{},$k.compressEtc=$k.compressEtc?$k.compressEtc:{},$k.compressEtc1=$k.compressEtc1?$k.compressEtc1:{},$k.compressPvrtc=$k.compressPvrtc?$k.compressPvrtc:{},$k.compressS3tc=$k.compressS3tc?$k.compressS3tc:{},$k.compressS3tc_srgb=$k.compressS3tc_srgb?$k.compressS3tc_srgb:{},$n.deleteTexture1=$n.deleteTexture,$n.deleteTexture=function($J){$J==$pJ.curBindTexValue&&($pJ.curBindTexValue=null),$n.deleteTexture1($J);},$k.onStageResize($h,$f),null==$k.mainContext)throw new Error("webGL getContext err!");$W.__init__(),$V.__init__(),$GJ.__init__(),$TJ.__init__(),$QJ.__init__(),$DJ.__init__(),$z.__init__(),$wJ.__int__($n),$e._init_($n),$r.isConchApp&&conch.setOnInvalidGLRes($k.onInvalidGLRes);},$k.mainCanvas=null,$k.antialias=!0,$k.shaderHighPrecision=!1,$k._bg_null=[0,0,0,0],$k;}(),$pJ=function(){function $n(){}return $R($n,"laya.webgl.WebGLContext"),$n.UseProgram=function($J){return $n._useProgram!==$J&&($dJ.mainContext.useProgram($J),$n._useProgram=$J,!0);},$n.setDepthTest=function($J,$h){$h!==$n._depthTest&&(($n._depthTest=$h)?$J.enable(2929):$J.disable(2929));},$n.setDepthMask=function($J,$h){$h!==$n._depthMask&&($n._depthMask=$h,$J.depthMask($h));},$n.setDepthFunc=function($J,$h){$h!==$n._depthFunc&&($n._depthFunc=$h,$J.depthFunc($h));},$n.setBlend=function($J,$h){$h!==$n._blend&&(($n._blend=$h)?$J.enable(3042):$J.disable(3042));},$n.setBlendFunc=function($J,$h,$f){($h!==$n._sFactor||$f!==$n._dFactor)&&($n._sFactor=$h,$n._dFactor=$f,$J.blendFunc($h,$f));},$n.setCullFace=function($J,$h){$h!==$n._cullFace&&(($n._cullFace=$h)?$J.enable(2884):$J.disable(2884));},$n.setFrontFace=function($J,$h){$h!==$n._frontFace&&($n._frontFace=$h,$J.frontFace($h));},$n.bindTexture=function($J,$h,$f){$J.bindTexture($h,$f),$n.curBindTexTarget=$h,$n.curBindTexValue=$f;},$n.DEPTH_BUFFER_BIT=256,$n.STENCIL_BUFFER_BIT=1024,$n.COLOR_BUFFER_BIT=16384,$n.POINTS=0,$n.LINES=1,$n.LINE_LOOP=2,$n.LINE_STRIP=3,$n.TRIANGLES=4,$n.TRIANGLE_STRIP=5,$n.TRIANGLE_FAN=6,$n.ZERO=0,$n.ONE=1,$n.SRC_COLOR=768,$n.ONE_MINUS_SRC_COLOR=769,$n.SRC_ALPHA=770,$n.ONE_MINUS_SRC_ALPHA=771,$n.DST_ALPHA=772,$n.ONE_MINUS_DST_ALPHA=773,$n.DST_COLOR=774,$n.ONE_MINUS_DST_COLOR=775,$n.SRC_ALPHA_SATURATE=776,$n.FUNC_ADD=32774,$n.BLEND_EQUATION=32777,$n.BLEND_EQUATION_RGB=32777,$n.BLEND_EQUATION_ALPHA=34877,$n.FUNC_SUBTRACT=32778,$n.FUNC_REVERSE_SUBTRACT=32779,$n.BLEND_DST_RGB=32968,$n.BLEND_SRC_RGB=32969,$n.BLEND_DST_ALPHA=32970,$n.BLEND_SRC_ALPHA=32971,$n.CONSTANT_COLOR=32769,$n.ONE_MINUS_CONSTANT_COLOR=32770,$n.CONSTANT_ALPHA=32771,$n.ONE_MINUS_CONSTANT_ALPHA=32772,$n.BLEND_COLOR=32773,$n.ARRAY_BUFFER=34962,$n.ELEMENT_ARRAY_BUFFER=34963,$n.ARRAY_BUFFER_BINDING=34964,$n.ELEMENT_ARRAY_BUFFER_BINDING=34965,$n.STREAM_DRAW=35040,$n.STATIC_DRAW=35044,$n.DYNAMIC_DRAW=35048,$n.BUFFER_SIZE=34660,$n.BUFFER_USAGE=34661,$n.CURRENT_VERTEX_ATTRIB=34342,$n.FRONT=1028,$n.BACK=1029,$n.CULL_FACE=2884,$n.FRONT_AND_BACK=1032,$n.BLEND=3042,$n.DITHER=3024,$n.STENCIL_TEST=2960,$n.DEPTH_TEST=2929,$n.SCISSOR_TEST=3089,$n.POLYGON_OFFSET_FILL=32823,$n.SAMPLE_ALPHA_TO_COVERAGE=32926,$n.SAMPLE_COVERAGE=32928,$n.NO_ERROR=0,$n.INVALID_ENUM=1280,$n.INVALID_VALUE=1281,$n.INVALID_OPERATION=1282,$n.OUT_OF_MEMORY=1285,$n.CW=2304,$n.CCW=2305,$n.LINE_WIDTH=2849,$n.ALIASED_POINT_SIZE_RANGE=33901,$n.ALIASED_LINE_WIDTH_RANGE=33902,$n.CULL_FACE_MODE=2885,$n.FRONT_FACE=2886,$n.DEPTH_RANGE=2928,$n.DEPTH_WRITEMASK=2930,$n.DEPTH_CLEAR_VALUE=2931,$n.DEPTH_FUNC=2932,$n.STENCIL_CLEAR_VALUE=2961,$n.STENCIL_FUNC=2962,$n.STENCIL_FAIL=2964,$n.STENCIL_PASS_DEPTH_FAIL=2965,$n.STENCIL_PASS_DEPTH_PASS=2966,$n.STENCIL_REF=2967,$n.STENCIL_VALUE_MASK=2963,$n.STENCIL_WRITEMASK=2968,$n.STENCIL_BACK_FUNC=34816,$n.STENCIL_BACK_FAIL=34817,$n.STENCIL_BACK_PASS_DEPTH_FAIL=34818,$n.STENCIL_BACK_PASS_DEPTH_PASS=34819,$n.STENCIL_BACK_REF=36003,$n.STENCIL_BACK_VALUE_MASK=36004,$n.STENCIL_BACK_WRITEMASK=36005,$n.VIEWPORT=2978,$n.SCISSOR_BOX=3088,$n.COLOR_CLEAR_VALUE=3106,$n.COLOR_WRITEMASK=3107,$n.UNPACK_ALIGNMENT=3317,$n.PACK_ALIGNMENT=3333,$n.MAX_TEXTURE_SIZE=3379,$n.MAX_VIEWPORT_DIMS=3386,$n.SUBPIXEL_BITS=3408,$n.RED_BITS=3410,$n.GREEN_BITS=3411,$n.BLUE_BITS=3412,$n.ALPHA_BITS=3413,$n.DEPTH_BITS=3414,$n.STENCIL_BITS=3415,$n.POLYGON_OFFSET_UNITS=10752,$n.POLYGON_OFFSET_FACTOR=32824,$n.TEXTURE_BINDING_2D=32873,$n.SAMPLE_BUFFERS=32936,$n.SAMPLES=32937,$n.SAMPLE_COVERAGE_VALUE=32938,$n.SAMPLE_COVERAGE_INVERT=32939,$n.NUM_COMPRESSED_TEXTURE_FORMATS=34466,$n.COMPRESSED_TEXTURE_FORMATS=34467,$n.DONT_CARE=4352,$n.FASTEST=4353,$n.NICEST=4354,$n.GENERATE_MIPMAP_HINT=33170,$n.BYTE=5120,$n.UNSIGNED_BYTE=5121,$n.SHORT=5122,$n.UNSIGNED_SHORT=5123,$n.INT=5124,$n.UNSIGNED_INT=5125,$n.FLOAT=5126,$n.DEPTH_COMPONENT=6402,$n.ALPHA=6406,$n.RGB=6407,$n.RGBA=6408,$n.LUMINANCE=6409,$n.LUMINANCE_ALPHA=6410,$n.UNSIGNED_SHORT_4_4_4_4=32819,$n.UNSIGNED_SHORT_5_5_5_1=32820,$n.UNSIGNED_SHORT_5_6_5=33635,$n.FRAGMENT_SHADER=35632,$n.VERTEX_SHADER=35633,$n.MAX_VERTEX_ATTRIBS=34921,$n.MAX_VERTEX_UNIFORM_VECTORS=36347,$n.MAX_VARYING_VECTORS=36348,$n.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,$n.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,$n.MAX_TEXTURE_IMAGE_UNITS=34930,$n.MAX_FRAGMENT_UNIFORM_VECTORS=36349,$n.SHADER_TYPE=35663,$n.DELETE_STATUS=35712,$n.LINK_STATUS=35714,$n.VALIDATE_STATUS=35715,$n.ATTACHED_SHADERS=35717,$n.ACTIVE_UNIFORMS=35718,$n.ACTIVE_ATTRIBUTES=35721,$n.SHADING_LANGUAGE_VERSION=35724,$n.CURRENT_PROGRAM=35725,$n.NEVER=512,$n.LESS=513,$n.EQUAL=514,$n.LEQUAL=515,$n.GREATER=516,$n.NOTEQUAL=517,$n.GEQUAL=518,$n.ALWAYS=519,$n.KEEP=7680,$n.REPLACE=7681,$n.INCR=7682,$n.DECR=7683,$n.INVERT=5386,$n.INCR_WRAP=34055,$n.DECR_WRAP=34056,$n.VENDOR=7936,$n.RENDERER=7937,$n.VERSION=7938,$n.NEAREST=9728,$n.LINEAR=9729,$n.NEAREST_MIPMAP_NEAREST=9984,$n.LINEAR_MIPMAP_NEAREST=9985,$n.NEAREST_MIPMAP_LINEAR=9986,$n.LINEAR_MIPMAP_LINEAR=9987,$n.TEXTURE_MAG_FILTER=10240,$n.TEXTURE_MIN_FILTER=10241,$n.TEXTURE_WRAP_S=10242,$n.TEXTURE_WRAP_T=10243,$n.TEXTURE_2D=3553,$n.TEXTURE=5890,$n.TEXTURE_CUBE_MAP=34067,$n.TEXTURE_BINDING_CUBE_MAP=34068,$n.TEXTURE_CUBE_MAP_POSITIVE_X=34069,$n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,$n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,$n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,$n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,$n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,$n.MAX_CUBE_MAP_TEXTURE_SIZE=34076,$n.TEXTURE0=33984,$n.TEXTURE1=33985,$n.TEXTURE2=33986,$n.TEXTURE3=33987,$n.TEXTURE4=33988,$n.TEXTURE5=33989,$n.TEXTURE6=33990,$n.TEXTURE7=33991,$n.TEXTURE8=33992,$n.TEXTURE9=33993,$n.TEXTURE10=33994,$n.TEXTURE11=33995,$n.TEXTURE12=33996,$n.TEXTURE13=33997,$n.TEXTURE14=33998,$n.TEXTURE15=33999,$n.TEXTURE16=34e3,$n.TEXTURE17=34001,$n.TEXTURE18=34002,$n.TEXTURE19=34003,$n.TEXTURE20=34004,$n.TEXTURE21=34005,$n.TEXTURE22=34006,$n.TEXTURE23=34007,$n.TEXTURE24=34008,$n.TEXTURE25=34009,$n.TEXTURE26=34010,$n.TEXTURE27=34011,$n.TEXTURE28=34012,$n.TEXTURE29=34013,$n.TEXTURE30=34014,$n.TEXTURE31=34015,$n.ACTIVE_TEXTURE=34016,$n.REPEAT=10497,$n.CLAMP_TO_EDGE=33071,$n.MIRRORED_REPEAT=33648,$n.FLOAT_VEC2=35664,$n.FLOAT_VEC3=35665,$n.FLOAT_VEC4=35666,$n.INT_VEC2=35667,$n.INT_VEC3=35668,$n.INT_VEC4=35669,$n.BOOL=35670,$n.BOOL_VEC2=35671,$n.BOOL_VEC3=35672,$n.BOOL_VEC4=35673,$n.FLOAT_MAT2=35674,$n.FLOAT_MAT3=35675,$n.FLOAT_MAT4=35676,$n.SAMPLER_2D=35678,$n.SAMPLER_CUBE=35680,$n.VERTEX_ATTRIB_ARRAY_ENABLED=34338,$n.VERTEX_ATTRIB_ARRAY_SIZE=34339,$n.VERTEX_ATTRIB_ARRAY_STRIDE=34340,$n.VERTEX_ATTRIB_ARRAY_TYPE=34341,$n.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,$n.VERTEX_ATTRIB_ARRAY_POINTER=34373,$n.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,$n.COMPILE_STATUS=35713,$n.LOW_FLOAT=36336,$n.MEDIUM_FLOAT=36337,$n.HIGH_FLOAT=36338,$n.LOW_INT=36339,$n.MEDIUM_INT=36340,$n.HIGH_INT=36341,$n.FRAMEBUFFER=36160,$n.RENDERBUFFER=36161,$n.RGBA4=32854,$n.RGB5_A1=32855,$n.RGB565=36194,$n.DEPTH_COMPONENT16=33189,$n.STENCIL_INDEX=6401,$n.STENCIL_INDEX8=36168,$n.DEPTH_STENCIL=34041,$n.RENDERBUFFER_WIDTH=36162,$n.RENDERBUFFER_HEIGHT=36163,$n.RENDERBUFFER_INTERNAL_FORMAT=36164,$n.RENDERBUFFER_RED_SIZE=36176,$n.RENDERBUFFER_GREEN_SIZE=36177,$n.RENDERBUFFER_BLUE_SIZE=36178,$n.RENDERBUFFER_ALPHA_SIZE=36179,$n.RENDERBUFFER_DEPTH_SIZE=36180,$n.RENDERBUFFER_STENCIL_SIZE=36181,$n.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,$n.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,$n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,$n.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,$n.COLOR_ATTACHMENT0=36064,$n.DEPTH_ATTACHMENT=36096,$n.STENCIL_ATTACHMENT=36128,$n.DEPTH_STENCIL_ATTACHMENT=33306,$n.NONE=0,$n.FRAMEBUFFER_COMPLETE=36053,$n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,$n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,$n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,$n.FRAMEBUFFER_UNSUPPORTED=36061,$n.FRAMEBUFFER_BINDING=36006,$n.RENDERBUFFER_BINDING=36007,$n.MAX_RENDERBUFFER_SIZE=34024,$n.INVALID_FRAMEBUFFER_OPERATION=1286,$n.UNPACK_FLIP_Y_WEBGL=37440,$n.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,$n.CONTEXT_LOST_WEBGL=37442,$n.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,$n.BROWSER_DEFAULT_WEBGL=37444,$n._useProgram=null,$n._depthTest=!0,$n._depthMask=!0,$n._blend=!1,$n._cullFace=!1,$n.curBindTexTarget=null,$n.curBindTexValue=null,$k($n,["_depthFunc",function(){return this._depthFunc=513;},"_sFactor",function(){return this._sFactor=1;},"_dFactor",function(){return this._dFactor=0;},"_frontFace",function(){return this._frontFace=2305;}]),$n;}(),$UJ=function($J){function $h(){$h.__super.call(this);}$R($h,"laya.webgl.display.GraphicsGL",$u);var $f=$h.prototype;return $f.setShader=function($J){this._saveToCmd($r.context._setShader,[$J]);},$f.setIBVB=function($J,$h,$f,$n,$L,$T){this._saveToCmd($r.context._setIBVB,[$J,$h,$f,$n,$L,$T]);},$f.drawParticle=function($J,$h,$f){var $n=$p.createParticleTemplate2D($f);$n.x=$J,$n.y=$h,this._saveToCmd($r.context._drawParticle,[$n]);},$h;}(),$QJ=function($J){var $f;function $B($J){this._x=0,this._y=0,this._id=++$B._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,$B.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=$B.MAXCLIPRECT,this.mOutPoint,this._canvas=$J,this._canvas._addReference(),$B._contextcount++,$r.isFlash?(this._ib=$zJ.create(35044),$oJ.fillIBQuadrangle(this._ib,16)):this._ib=$zJ.QuadrangleIB,this.clear();}$R($B,"laya.webgl.canvas.WebGLContext2D",$L);var $h=$B.prototype;return $h.setIsMainContext=function(){this._isMain=!0;},$h.clearBG=function($J,$h,$f,$n){var $L=$dJ.mainContext;$L.clearColor($J,$h,$f,$n),$L.clear(16384);},$h._getSubmits=function(){return this._submits;},$h._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var $J=0,$h=this._submits._length;$J<$h;$J++)this._submits[$J].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null);}},$h.destroy=function(){--$B._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=$zJ.QuadrangleIB&&this._ib.releaseResource();},$h.clear=function(){this._submits||(this._other=$f.DEFAULT,this._curMat=$g.create(),this._vb=$KJ.create(-1),this._submits=[],this._save=[$X.Create(this)],this._save.length=10,this._shader2D=new $z(),this._triangleMesh=$mJ.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=$f.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=$B.MAXCLIPRECT,this._curSubmit=$TJ.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=$H.DEFAULT;for(var $J=0,$h=this._submits._length;$J<$h;$J++)this._submits[$J].releaseRender(),this._submits[$J]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1;},$h.size=function($J,$h){if(this._width!=$J||this._height!=$h)if(0==$J||0==$h){0!=this._vb._byteLength&&(this._width=$J,this._height=$h,this._vb.clear(),this._vb.upload());for(var $f=0,$n=this._submits._length;$f<$n;$f++)this._submits[$f].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null;}else this._width=$J,this._height=$h,this._targets&&this._targets.size($J,$h),this._canvas.memorySize-=this._canvas.memorySize;0===$J&&0===$h&&this._releaseMem();},$h._getTransformMatrix=function(){return this._curMat;},$h.translate=function($J,$h){0===$J&&0===$h||($E.save(this),this._curMat.bTransform&&($w.save(this),this._curMat.transformPointN($F.TEMP.setTo($J,$h)),$J=$F.TEMP.x,$h=$F.TEMP.y),this._x+=$J,this._y+=$h);},$h.save=function(){this._save[this._save._length++]=$X.Create(this);},$h.restore=function(){var $J=this._save._length;if(!($J<1))for(var $h=$J-1;0<=$h;$h--){var $f=this._save[$h];if($f.restore(this),$f.isSaveMark())return void(this._save._length=$h);}},$h._fillText=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){void 0===$Y&&($Y=0);var $x=this._shader2D,$j=this._curSubmit.shaderValue,$R=$L?$iJ.create($L):this._other.font;if($V.enabled)$x.ALPHA!==$j.ALPHA&&($x.glTexture=null),$lJ.drawText(this,$J,$h,this._curMat,$R,$S||this._other.textAlign,$T,$k,$u,$f,$n,$Y);else{this._shader2D.defines.getValue();var $l=$T?$i.create($T)._color:$x.colorAdd;$x.ALPHA===$j.ALPHA&&$l===$x.colorAdd&&$j.colorAdd===$x.colorAdd||($x.glTexture=null,$x.colorAdd=$l),$lJ.drawText(this,$J,$h,this._curMat,$R,$S||this._other.textAlign,$T,$k,$u,$f,$n,$Y);}},$h.fillWords=function($J,$h,$f,$n,$L,$T){this._fillText(null,$J,$h,$f,$n,$L,null,-1,null,$T);},$h.fillBorderWords=function($J,$h,$f,$n,$L,$T,$k){this._fillBorderText(null,$J,$h,$f,$n,$L,$T,$k,null);},$h.fillText=function($J,$h,$f,$n,$L,$T){this._fillText($J,null,$h,$f,$n,$L,null,-1,$T);},$h.strokeText=function($J,$h,$f,$n,$L,$T,$k){this._fillText($J,null,$h,$f,$n,null,$L,$T||1,$k);},$h.fillBorderText=function($J,$h,$f,$n,$L,$T,$k,$u){this._fillBorderText($J,null,$h,$f,$n,$L,$T,$k,$u);},$h._fillBorderText=function($J,$h,$f,$n,$L,$T,$k,$u,$S){if(!$V.enabled)return this._fillText($J,$h,$f,$n,$L,null,$k,$u||1,$S),void this._fillText($J,$h,$f,$n,$L,$T,null,-1,$S);var $Y=this._shader2D,$x=this._curSubmit.shaderValue;$Y.ALPHA!==$x.ALPHA&&($Y.glTexture=null);var $j=$L?($B._fontTemp.setFont($L),$B._fontTemp):this._other.font;$lJ.drawText(this,$J,$h,this._curMat,$j,$S||this._other.textAlign,$T,$k,$u||1,$f,$n,0);},$h.fillRect=function($J,$h,$f,$n,$L){var $T=this._vb;if($oJ.fillRectImgVb($T,this._clipRect,$J,$h,$f,$n,$m.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $k=this._shader2D.fillStyle;$L&&(this._shader2D.fillStyle=$H.create($L));var $u=this._shader2D,$S=this._curSubmit.shaderValue;if($u.fillStyle!==$S.fillStyle||$u.ALPHA!==$S.ALPHA){$u.glTexture=null;var $Y=this._curSubmit=$TJ.createSubmit(this,this._ib,$T,($T._byteLength-64)/32*3,$DJ.create(2,0));$Y.shaderValue.color=$u.fillStyle._color._color,$Y.shaderValue.ALPHA=$u.ALPHA,this._submits[this._submits._length++]=$Y;}this._curSubmit._numEle+=6,this._shader2D.fillStyle=$k;}},$h.fillTexture=function($J,$h,$f,$n,$L,$T,$k,$u){if($J.loaded&&$J.bitmap&&$J.source){var $S=this._vb,$Y=$J.bitmap.width,$x=$J.bitmap.height,$j=$J.uv,$R=$k.x%$J.width,$l=$k.y%$J.height;if($Y!=$u.w||$x!=$u.h){if(!$u.w&&!$u.h)switch($u.oy=$u.ox=0,$T){case"repeat":$u.width=$n,$u.height=$L;break;case"repeat-x":$u.width=$n,$l<0?$J.height+$l>$L?$u.height=$L:$u.height=$J.height+$l:($u.oy=$l,$J.height+$l>$L?$u.height=$L-$l:$u.height=$J.height);break;case"repeat-y":$R<0?$J.width+$R>$n?$u.width=$n:$u.width=$J.width+$R:($u.ox=$R,$J.width+$R>$n?$u.width=$n-$R:$u.width=$J.width),$u.height=$L;break;case"no-repeat":$R<0?$J.width+$R>$n?$u.width=$n:$u.width=$J.width+$R:($u.ox=$R,$J.width+$R>$n?$u.width=$n-$R:$u.width=$J.width),$l<0?$J.height+$l>$L?$u.height=$L:$u.height=$J.height+$l:($u.oy=$l,$J.height+$l>$L?$u.height=$L-$l:$u.height=$J.height);break;default:$u.width=$n,$u.height=$L;}$u.w=$Y,$u.h=$x,$u.uv=[0,0,$u.width/$Y,0,$u.width/$Y,$u.height/$x,0,$u.height/$x];}if($h+=$u.ox,$f+=$u.oy,$R-=$u.ox,$l-=$u.oy,$oJ.fillRectImgVb($S,this._clipRect,$h,$f,$u.width,$u.height,$u.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $i=$IJ.create(this,this._ib,$S,($S._byteLength-64)/32*3,$DJ.create(256,0)),$q=(this._submits[this._submits._length++]=$i).shaderValue;$q.textureHost=$J;var $o=$j[0]*$Y,$r=$j[1]*$x,$_=($j[2]-$j[0])*$Y,$s=($j[5]-$j[3])*$x,$d=-$R/$Y,$p=-$l/$x;$q.u_TexRange[0]=$o/$Y,$q.u_TexRange[1]=$_/$Y,$q.u_TexRange[2]=$r/$x,$q.u_TexRange[3]=$s/$x,$q.u_offset[0]=$d,$q.u_offset[1]=$p,$V.enabled&&!this._isMain&&$i.addTexture($J,($S._byteLength>>2)-16),(this._curSubmit=$i)._renderType=10017,$i._numEle+=6;}}else this.sprite&&$U.timer.callLater(this,this._repaintSprite);},$h.setShader=function($J){$v.save(this,1048576,this._shader2D,!0),this._shader2D.shader=$J;},$h.setFilters=function($J){$v.save(this,2097152,this._shader2D,!0),this._shader2D.filters=$J,this._curSubmit=$TJ.RENDERBASE,this._renderKey=0,this._drawCount++;},$h.drawTexture=function($J,$h,$f,$n,$L,$T,$k){this._drawTextureM($J,$h,$f,$n,$L,$T,$k,null,1);},$h.addTextureVb=function($J,$h,$f){var $n=this._curSubmit._vb||this._vb,$L=$n._byteLength>>2;$n.byteLength=$L+16<<2;for(var $T=$n.getFloat32Array(),$k=0;$k<16;$k+=4)$T[$L++]=$J[$k]+$h,$T[$L++]=$J[$k+1]+$f,$T[$L++]=$J[$k+2],$T[$L++]=$J[$k+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),$n._upload=!0;},$h.willDrawTexture=function($J,$h){if(!($J.loaded&&$J.bitmap&&$J.source))return this.sprite&&$U.timer.callLater(this,this._repaintSprite),0;var $f=$J.bitmap,$n=$f.id+this._shader2D.ALPHA*$h+10016;if($n==this._renderKey)return $n;var $L=this._shader2D,$T=$L.ALPHA,$k=this._curSubmit.shaderValue;$L.ALPHA*=$h,this._renderKey=$n,this._drawCount++,$L.glTexture=$f;var $u=this._vb,$S=null,$Y=$u._byteLength/32*3,$x=$k.textureHost&&$k.textureHost==$J&&$k.textureHost.alphaTexture==$J.alphaTexture;return $S=$IJ.create(this,this._ib,$u,$Y,$DJ.create(1,0)),(this._submits[this._submits._length++]=$S).shaderValue.textureHost=$J,$S._renderType=10016,$S._preIsSameTextureShader=10016===this._curSubmit._renderType&&$L.ALPHA===$k.ALPHA&&$x,this._curSubmit=$S,$L.ALPHA=$T,$n;},$h.drawTextures=function($J,$h,$f,$n){if($J.loaded&&$J.bitmap&&$J.source){var $L=this._clipRect;if(this._clipRect=$B.MAXCLIPRECT,this._drawTextureM($J,$h[0],$h[1],$J.width,$J.height,$f,$n,null,1)){if(this._clipRect=$L,$O.drawCall++,!($h.length<4)){for(var $T=this._curSubmit._vb||this._vb,$k=this._curMat.a,$u=this._curMat.d,$S=2,$Y=$h.length;$S<$Y;$S+=2)$oJ.copyPreImgVb($T,($h[$S]-$h[$S-2])*$k,($h[$S+1]-$h[$S-1])*$u),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle);}}else alert("drawTextures err");}else this.sprite&&$U.timer.callLater(this,this._repaintSprite);},$h._drawTextureM=function($J,$h,$f,$n,$L,$T,$k,$u,$S){if(!$J.loaded||!$J.source)return this.sprite&&$U.timer.callLater(this,this._repaintSprite),!1;var $Y=this._curSubmit._vb||this._vb,$x=$J.bitmap;$h+=$T,$f+=$k,this._drawCount++;var $j=$x.id+this._shader2D.ALPHA*$S+10016;if($j!=this._renderKey){this._renderKey=$j;var $R=this._curSubmit.shaderValue,$l=this._shader2D,$i=$l.ALPHA;$l.ALPHA*=$S,$l.glTexture=$x;var $q=this._vb,$o=null,$r=$q._byteLength/32*3,$_=$R.textureHost&&$R.textureHost==$J&&$R.textureHost.alphaTexture==$J.alphaTexture;$o=$IJ.create(this,this._ib,$q,$r,$DJ.create(1,0)),(this._submits[this._submits._length++]=$o).shaderValue.textureHost=$J,$o._renderType=10016,$o._preIsSameTextureShader=10016===this._curSubmit._renderType&&$l.ALPHA===$R.ALPHA&&$_,this._curSubmit=$o,$Y=this._curSubmit._vb||this._vb,$l.ALPHA=$i;}return!!$oJ.fillRectImgVb($Y,this._clipRect,$h,$f,$n||$J.width,$L||$J.height,$J.uv,$u||this._curMat,this._x,this._y,0,0)&&($V.enabled&&!this._isMain&&this._curSubmit.addTexture($J,($Y._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0);},$h._repaintSprite=function(){this.sprite&&this.sprite.repaint();},$h._drawText=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){var $x=$J.bitmap;this._drawCount++;var $j=$x.id+this._shader2D.ALPHA+10016;if($j!=this._renderKey){this._renderKey=$j;var $R=this._curSubmit.shaderValue,$l=this._shader2D;$l.glTexture=$x;var $i=this._vb,$q=null,$o=$i._byteLength/32*3,$r=$R.textureHost&&$R.textureHost==$J&&$R.textureHost.alphaTexture==$J.alphaTexture;($q=$V.enabled?$IJ.create(this,this._ib,$i,$o,$DJ.create(1,0)):$IJ.create(this,this._ib,$i,$o,$EJ.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&$l.ALPHA===$R.ALPHA&&$r,(this._submits[this._submits._length++]=$q).shaderValue.textureHost=$J,$q._renderType=10016,this._curSubmit=$q;}$J.active();var $_=this._curSubmit._vb||this._vb;$oJ.fillRectImgVb($_,this._clipRect,$h+$k,$f+$u,$n||$J.width,$L||$J.height,$J.uv,$T||this._curMat,this._x,this._y,$S,$Y,!0)&&($V.enabled&&!this._isMain&&this._curSubmit.addTexture($J,($_._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle));},$h.drawTextureWithTransform=function($J,$h,$f,$n,$L,$T,$k,$u,$S){if($T){var $Y=this._curMat,$x=this._x,$j=this._y;(0!==$k||0!==$u)&&(this._x=$k*$Y.a+$u*$Y.c,this._y=$u*$Y.d+$k*$Y.b),$T&&$Y.bTransform?($g.mul($T,$Y,$B._tmpMatrix),($T=$B._tmpMatrix)._checkTransform()):(this._x+=$Y.tx,this._y+=$Y.ty),this._drawTextureM($J,$h,$f,$n,$L,0,0,$T,$S),this._x=$x,this._y=$j;}else this._drawTextureM($J,$h,$f,$n,$L,$k,$u,null,$S);},$h.fillQuadrangle=function($J,$h,$f,$n,$L){var $T=this._curSubmit,$k=this._vb,$u=this._shader2D,$S=$T.shaderValue;if(this._renderKey=0,$J.bitmap){var $Y=$J.bitmap;$u.glTexture==$Y&&$u.ALPHA===$S.ALPHA||($u.glTexture=$Y,($T=this._curSubmit=$TJ.createSubmit(this,this._ib,$k,$k._byteLength/32*3,$DJ.create(1,0))).shaderValue.glTexture=$Y,this._submits[this._submits._length++]=$T),$oJ.fillQuadrangleImgVb($k,$h,$f,$n,$J.uv,$L||this._curMat,this._x,this._y);}else $T.shaderValue.fillStyle&&$T.shaderValue.fillStyle.equal($J)&&$u.ALPHA===$S.ALPHA||($u.glTexture=null,($T=this._curSubmit=$TJ.createSubmit(this,this._ib,$k,$k._byteLength/32*3,$DJ.create(2,0))).shaderValue.defines.add(2),$T.shaderValue.fillStyle=$H.create($J),this._submits[this._submits._length++]=$T),$oJ.fillQuadrangleImgVb($k,$h,$f,$n,$m.DEF_UV,$L||this._curMat,this._x,this._y);$T._numEle+=6;},$h.drawTexture2=function($J,$h,$f,$n,$L,$T,$k,$u){if(0!=$T){var $S=this._curMat;if(this._x=$J*$S.a+$h*$S.c,this._y=$h*$S.d+$J*$S.b,$L&&($L=$S.bTransform||$L.bTransform?($g.mul($L,$S,$B._tmpMatrix),$B._tmpMatrix):(this._x+=$L.tx+$S.tx,this._y+=$L.ty+$S.ty,$g.EMPTY)),1!==$T||$k){var $Y=this._shader2D.ALPHA,$x=this._nBlendType;this._shader2D.ALPHA=$T,$k&&(this._nBlendType=$e.TOINT($k)),this._drawTextureM($u[0],$u[1]-$f,$u[2]-$n,$u[3],$u[4],0,0,$L,1),this._shader2D.ALPHA=$Y,this._nBlendType=$x;}else this._drawTextureM($u[0],$u[1]-$f,$u[2]-$n,$u[3],$u[4],0,0,$L,1);this._x=this._y=0;}},$h.drawCanvas=function($J,$h,$f,$n,$L){var $T=$J.context;if(this._renderKey=0,$T._targets)this._submits[this._submits._length++]=$WJ.create($T,0,null),this._curSubmit=$TJ.RENDERBASE,$T._targets.drawTo(this,$h,$f,$n,$L);else{var $k=this._submits[this._submits._length++]=$WJ.create($T,this._shader2D.ALPHA,this._shader2D.filters),$u=$n/$J.width,$S=$L/$J.height,$Y=$k._matrix;this._curMat.copyTo($Y),1!=$u&&1!=$S&&$Y.scale($u,$S);var $x=$Y.tx,$j=$Y.ty;$Y.tx=$Y.ty=0,$Y.transformPoint($F.TEMP.setTo($h,$f)),$Y.translate($F.TEMP.x+$x,$F.TEMP.y+$j),this._curSubmit=$TJ.RENDERBASE;}$Q.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=$T._targets?"yellow":"green",this.strokeRect($h-1,$f-1,$n+2,$L+2,1),this.strokeRect($h,$f,$n,$L,1),this.restore());},$h.drawTarget=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){void 0===$Y&&($Y=-1);var $x=this._vb;if($oJ.fillRectImgVb($x,this._clipRect,$h,$f,$n,$L,$S||$m.DEF_UV,$T||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var $j=this._curSubmit=$jJ.create(this,this._ib,$x,($x._byteLength-64)/32*3,$u,$k);$j.blendType=-1==$Y?this._nBlendType:$Y,$j.scope=$J,this._submits[this._submits._length++]=$j,this._curSubmit._numEle+=6;}},$h.mixRGBandAlpha=function($J){return this._mixRGBandAlpha($J,this._shader2D.ALPHA);},$h._mixRGBandAlpha=function($J,$h){var $f=(4278190080&$J)>>>24;return 0!=$f?$f*=$h:$f=255*$h,16777215&$J|$f<<24;},$h.drawTriangles=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){if(!$J.loaded||!$J.source)return this.sprite&&$U.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;$J.bitmap;var $x=this._mixRGBandAlpha(4294967295,$u),$j=($n.length,$T.length);this._renderKey=-1;var $R=this._curSubmit=$IJ.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,$DJ.create(1,0));return $R.shaderValue.textureHost=$J,$R._renderType=10016,this._submits[this._submits._length++]=$R,$k?($B._tmpMatrix.a=$k.a,$B._tmpMatrix.b=$k.b,$B._tmpMatrix.c=$k.c,$B._tmpMatrix.d=$k.d,$B._tmpMatrix.tx=$k.tx+$h,$B._tmpMatrix.ty=$k.ty+$f,$g.mul($B._tmpMatrix,this._curMat,$B._tmpMatrix)):($B._tmpMatrix.a=this._curMat.a,$B._tmpMatrix.b=this._curMat.b,$B._tmpMatrix.c=this._curMat.c,$B._tmpMatrix.d=this._curMat.d,$B._tmpMatrix.tx=this._curMat.tx+$h,$B._tmpMatrix.ty=this._curMat.ty+$f),this._triangleMesh.addData($n,$L,$T,$B._tmpMatrix,$x,this),this._curSubmit._numEle+=$j,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0;},$h.transform=function($J,$h,$f,$n,$L,$T){$w.save(this),$g.mul($g.TEMP.setTo($J,$h,$f,$n,$L,$T),this._curMat,this._curMat),this._curMat._checkTransform();},$h.setTransformByMatrix=function($J){$J.copyTo(this._curMat);},$h.transformByMatrix=function($J){$w.save(this),$g.mul($J,this._curMat,this._curMat),this._curMat._checkTransform();},$h.rotate=function($J){$w.save(this),this._curMat.rotateEx($J);},$h.scale=function($J,$h){$w.save(this),this._curMat.scaleEx($J,$h);},$h.clipRect=function($J,$h,$f,$n){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var $L=$xJ.create(4);this.addRenderObject($L);var $T=this._vb,$k=$T._byteLength>>2;if($oJ.fillRectImgVb($T,null,$J,$h,$f,$n,$m.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var $u=this._curSubmit=$TJ.createSubmit(this,this._ib,$T,($T._byteLength-64)/32*3,$DJ.create(2,0));$u.shaderValue.ALPHA=1,this._submits[this._submits._length++]=$u,this._curSubmit._numEle+=6;}else alert("clipRect calc stencil rect error");var $S=$xJ.create(5);this.addRenderObject($S);var $Y=$T.getFloat32Array(),$x=Math.min(Math.min(Math.min($Y[0+$k],$Y[4+$k]),$Y[8+$k]),$Y[12+$k]),$j=Math.max(Math.max(Math.max($Y[0+$k],$Y[4+$k]),$Y[8+$k]),$Y[12+$k]),$R=Math.min(Math.min(Math.min($Y[1+$k],$Y[5+$k]),$Y[9+$k]),$Y[13+$k]),$l=Math.max(Math.max(Math.max($Y[1+$k],$Y[5+$k]),$Y[9+$k]),$Y[13+$k]);$M.save(this,$S,$J,$h,$f,$n,$x,$R,$j-$x,$l-$R),this._curSubmit=$TJ.RENDERBASE;}else{$f*=this._curMat.a,$n*=this._curMat.d;var $i=$F.TEMP;this._curMat.transformPoint($i.setTo($J,$h)),$f<0&&($i.x=$i.x+$f,$f=-$f),$n<0&&($i.y=$i.y+$n,$n=-$n),this._renderKey=0;var $q=this._curSubmit=$YJ.create(this);(this._submits[this._submits._length++]=$q).submitIndex=this._submits._length,$q.submitLength=9999999,$$.save(this,$q);var $o=this._clipRect,$r=$o.x,$_=$o.y,$s=$i.x+$f,$d=$i.y+$n;$r<$i.x&&($o.x=$i.x),$_<$i.y&&($o.y=$i.y),$o.width=Math.min($s,$r+$o.width)-$o.x,$o.height=Math.min($d,$_+$o.height)-$o.y,this._shader2D.glTexture=null,$q.clipRect.copyFrom($o),this._curSubmit=$TJ.RENDERBASE;}},$h.setIBVB=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x){if(void 0===$S&&($S=0),void 0===$Y&&($Y=0),void 0===$x&&($x=0),null===$f){if($r.isFlash){var $j=$n;$j._selfIB||($j._selfIB=$zJ.create(35044)),$j._selfIB.clear(),$f=$j._selfIB;}else $f=this._ib;$oJ.expandIBQuadrangle($f,$n._byteLength/(4*$n.vertexStride*4));}if(!$u||!$k)throw Error("setIBVB must input:shader shaderValues");var $R=$SJ.create(this,$n,$f,$L,$k,$u,$S,$Y,$x);$T||($T=$g.EMPTY),$T.translate($J,$h),$g.mul($T,this._curMat,$R._mat),$T.translate(-$J,-$h),this._submits[this._submits._length++]=$R,this._curSubmit=$TJ.RENDERBASE,this._renderKey=0;},$h.addRenderObject=function($J){this._submits[this._submits._length++]=$J;},$h.fillTrangles=function($J,$h,$f,$n,$L){var $T=this._curSubmit,$k=this._vb,$u=this._shader2D,$S=$T.shaderValue,$Y=$n.length>>4,$x=$J.bitmap;this._renderKey=0,$u.glTexture==$x&&$u.ALPHA===$S.ALPHA||(($T=this._curSubmit=$TJ.createSubmit(this,this._ib,$k,$k._byteLength/32*3,$DJ.create(1,0))).shaderValue.textureHost=$J,this._submits[this._submits._length++]=$T),$oJ.fillTranglesVB($k,$h,$f,$n,$L||this._curMat,this._x,this._y),$T._numEle+=6*$Y;},$h.submitElement=function($J,$h){var $f=this._submits;for($h<0&&($h=$f._length);$J<$h;)$J+=$f[$J].renderSubmit();},$h.finish=function(){$dJ.mainContext.finish();},$h.flush=function(){var $J=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if($J>this._ib.bufferLength/12&&$oJ.expandIBQuadrangle(this._ib,$J),!this._isMain&&$V.enabled&&$V._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=$V._atlasRestore;for(var $h=this._submits,$f=0,$n=$h._length;$f<$n;$f++){var $L=$h[$f];10016===$L.getRenderType()&&$L.checkTexture();}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),$hJ.instance&&$hJ.getInstance().reset();var $T;for($f=0,$T=this.meshlist.length;$f<$T;$f++){var $k=this.meshlist[$f];$k.canReuse?$k.releaseMesh():$k.destroy();}return this.meshlist.length=0,this._curSubmit=$TJ.RENDERBASE,this._renderKey=0,this._triangleMesh=$mJ.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length;},$h.setPathId=function($J){if(this.mId=$J,-1!=this.mId){this.mHaveKey=!1;var $h=$t.getInstance();$h.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,$h.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0);}},$h.movePath=function($J,$h){var $f=$J,$n=$h;$J=this._curMat.a*$f+this._curMat.c*$n+this._curMat.tx,$h=this._curMat.b*$f+this._curMat.d*$n+this._curMat.ty,this.mX+=$J,this.mY+=$h;},$h.beginPath=function(){var $J=this._getPath();$J.tempArray.length=0,$J.closePath=!1,this.mX=0,this.mY=0;},$h.closePath=function(){this._path.closePath=!0;},$h.fill=function($J){void 0===$J&&($J=!1);var $h=this._getPath();this.drawPoly(0,0,$h.tempArray,this.fillStyle._color.numColor,0,0,$J);},$h.stroke=function(){var $J=this._getPath();if(0<this.lineWidth){if(-1==this.mId)$J.drawLine(0,0,$J.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var $h=$t.getInstance().shapeLineDic[this.mId];$h.rebuild($J.tempArray),$J.setGeomtry($h);}else $t.getInstance().addLine(this.mId,$J.drawLine(0,0,$J.tempArray,this.lineWidth,this.strokeStyle._color.numColor));$J.update();var $f=[this.mX,this.mY],$n=$TJ.createShape(this,$J.ib,$J.vb,$J.count,$J.offset,$DJ.create(4,0));$n.shaderValue.ALPHA=this._shader2D.ALPHA,$n.shaderValue.u_pos=$f,$n.shaderValue.u_mmat2=$_J.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=$n,this._renderKey=-1;}},$h.line=function($J,$h,$f,$n,$L,$T){var $k=this._curSubmit,$u=this._vb;if($oJ.fillLineVb($u,this._clipRect,$J,$h,$f,$n,$L,$T)){this._renderKey=0;var $S=this._shader2D,$Y=$k.shaderValue;$S.strokeStyle===$Y.strokeStyle&&$S.ALPHA===$Y.ALPHA||($S.glTexture=null,($k=this._curSubmit=$TJ.createSubmit(this,this._ib,$u,($u._byteLength-64)/32*3,$DJ.create(2,0))).shaderValue.strokeStyle=$S.strokeStyle,$k.shaderValue.mainID=2,$k.shaderValue.ALPHA=$S.ALPHA,this._submits[this._submits._length++]=$k),$k._numEle+=6;}},$h.moveTo=function($J,$h,$f){void 0===$f&&($f=!0);var $n=this._getPath();if($f){var $L=$J,$T=$h;$J=this._curMat.a*$L+this._curMat.c*$T,$h=this._curMat.b*$L+this._curMat.d*$T;}$n.addPoint($J,$h);},$h.lineTo=function($J,$h,$f){void 0===$f&&($f=!0);var $n=this._getPath();if($f){var $L=$J,$T=$h;$J=this._curMat.a*$L+this._curMat.c*$T,$h=this._curMat.b*$L+this._curMat.d*$T;}$n.addPoint($J,$h);},$h.drawCurves=function($J,$h,$f){this.setPathId(-1),this.beginPath(),this.strokeStyle=$f[3],this.lineWidth=$f[4];var $n=$f[2];$J+=$f[0],$h+=$f[1],this.movePath($J,$h),this.moveTo($n[0],$n[1]);for(var $L=2,$T=$n.length;$L<$T;)this.quadraticCurveTo($n[$L++],$n[$L++],$n[$L++],$n[$L++]);this.stroke();},$h.arcTo=function($J,$h,$f,$n,$L){if(-1==this.mId||!this.mHaveKey){var $T=0,$k=0,$u=0,$S=this._getPath();this._curMat.copyTo($B._tmpMatrix),$B._tmpMatrix.tx=$B._tmpMatrix.ty=0,$B._tempPoint.setTo($S.getEndPointX(),$S.getEndPointY()),$B._tmpMatrix.invertTransformPoint($B._tempPoint);var $Y=$B._tempPoint.x-$J,$x=$B._tempPoint.y-$h,$j=Math.sqrt($Y*$Y+$x*$x);if(!($j<=1e-6)){var $R=$Y/$j,$l=$x/$j,$i=$f-$J,$q=$n-$h,$o=$i*$i+$q*$q,$r=Math.sqrt($o);if(!($r<=1e-6)){var $_=$i/$r,$s=$q/$r,$d=$R+$_,$p=$l+$s,$U=Math.sqrt($d*$d+$p*$p);if(!($U<=1e-6)){var $Q=$d/$U,$D=$p/$U,$g=Math.acos($Q*$R+$D*$l),$F=Math.PI/2-$g,$A=($j=$L/Math.tan($F))*$R+$J,$G=$j*$l+$h,$y=Math.sqrt($j*$j+$L*$L),$O=$J+$Q*$y,$P=$h+$D*$y,$W=0,$I=0;if(0<=$R*$s-$l*$_){var $m=2*$F/$B.SEGNUM;$W=Math.sin($m),$I=Math.cos($m);}else $m=2*-$F/$B.SEGNUM,$W=Math.sin($m),$I=Math.cos($m);$k=this._curMat.a*$A+this._curMat.c*$G,$u=this._curMat.b*$A+this._curMat.d*$G,$k==this._path.getEndPointX()&&$u==this._path.getEndPointY()||$S.addPoint($k,$u);var $Z=$A-$O,$t=$G-$P;for($T=0;$T<$B.SEGNUM;$T++){var $c=$Z*$I+$t*$W,$a=-$Z*$W+$t*$I;$k=$c+$O,$u=$a+$P,$J=this._curMat.a*$k+this._curMat.c*$u,$u=$h=this._curMat.b*$k+this._curMat.d*$u,($k=$J)==this._path.getEndPointX()&&$u==this._path.getEndPointY()||$S.addPoint($k,$u),$Z=$c,$t=$a;}}}}}},$h.arc=function($J,$h,$f,$n,$L,$T,$k){if(void 0===$T&&($T=!1),void 0===$k&&($k=!0),-1!=this.mId){var $u=$t.getInstance().shapeDic[this.mId];if($u&&this.mHaveKey&&!$u.needUpdate(this._curMat))return;$h=$J=0;}var $S,$Y=0,$x=0,$j=0,$R=0,$l=0,$i=0,$q=0;if($x=$L-$n,$T){if(Math.abs($x)>=2*Math.PI)$x=2*-Math.PI;else for(;0<$x;)$x-=2*Math.PI;}else if(Math.abs($x)>=2*Math.PI)$x=2*Math.PI;else for(;$x<0;)$x+=2*Math.PI;$S=$x/($q=$f<101?Math.max(10,$x*$f/5):$f<201?Math.max(10,$x*$f/20):Math.max(10,$x*$f/40))/2,$j=Math.abs(4/3*(1-Math.cos($S))/Math.sin($S)),$T&&($j=-$j);var $o=this._getPath(),$r=NaN,$_=NaN;for($i=0;$i<=$q;$i++)$Y=$n+$x*($i/$q),$R=$J+Math.cos($Y)*$f,$l=$h+Math.sin($Y)*$f,$k&&($r=$R,$_=$l,$R=this._curMat.a*$r+this._curMat.c*$_,$l=this._curMat.b*$r+this._curMat.d*$_),$R==this._path.getEndPointX()&&$l==this._path.getEndPointY()||$o.addPoint($R,$l);$R=$J+Math.cos($L)*$f,$l=$h+Math.sin($L)*$f,$k&&($r=$R,$_=$l,$R=this._curMat.a*$r+this._curMat.c*$_,$l=this._curMat.b*$r+this._curMat.d*$_),$R==this._path.getEndPointX()&&$l==this._path.getEndPointY()||$o.addPoint($R,$l);},$h.quadraticCurveTo=function($J,$h,$f,$n){var $L=$j.I,$T=$f,$k=$n;$f=this._curMat.a*$T+this._curMat.c*$k,$n=this._curMat.b*$T+this._curMat.d*$k,$T=$J,$k=$h,$J=this._curMat.a*$T+this._curMat.c*$k,$h=this._curMat.b*$T+this._curMat.d*$k;for(var $u=$L.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),$J,$h,$f,$n],30,2),$S=0,$Y=$u.length/2;$S<$Y;$S++)this.lineTo($u[2*$S],$u[2*$S+1],!1);this.lineTo($f,$n,!1);},$h.rect=function($J,$h,$f,$n){this._other=this._other.make(),this._other.path||(this._other.path=new $b()),this._other.path.rect($J,$h,$f,$n);},$h.strokeRect=function($J,$h,$f,$n,$L){var $T=.5*$L;this.line($J-$T,$h,$J+$f+$T,$h,$L,this._curMat),this.line($J+$f,$h,$J+$f,$h+$n,$L,this._curMat),this.line($J,$h,$J,$h+$n,$L,this._curMat),this.line($J-$T,$h+$n,$J+$f+$T,$h+$n,$L,this._curMat);},$h.clip=function(){},$h.drawPoly=function($J,$h,$f,$n,$L,$T,$k){void 0===$k&&($k=!1),this._renderKey=0,this._shader2D.glTexture=null;var $u=this._getPath();if(-1==this.mId)$u.polygon($J,$h,$f,$n,$L||1,$T);else if(this.mHaveKey){var $S=$t.getInstance().shapeDic[this.mId];$S.setMatrix(this._curMat),$S.rebuild($u.tempArray),$u.setGeomtry($S);}else{var $Y=$u.polygon($J,$h,$f,$n,$L||1,$T);$t.getInstance().addShape(this.mId,$Y),$Y.setMatrix(this._curMat);}$u.update();var $x,$j=[this.mX,this.mY];if(($x=$TJ.createShape(this,$u.ib,$u.vb,$u.count,$u.offset,$DJ.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$x.shaderValue.u_pos=$j,$x.shaderValue.u_mmat2=$_J.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$x,0<$L){if(this.mHaveLineKey){var $R=$t.getInstance().shapeLineDic[this.mId];$R.rebuild($u.tempArray),$u.setGeomtry($R);}else $t.getInstance().addShape(this.mId,$u.drawLine($J,$h,$f,$L,$T));$u.update(),($x=$TJ.createShape(this,$u.ib,$u.vb,$u.count,$u.offset,$DJ.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$x.shaderValue.u_mmat2=$_J.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$x;}},$h.drawParticle=function($J,$h,$f){$f.x=$J,$f.y=$h,this._submits[this._submits._length++]=$f;},$h._getPath=function(){return this._path||(this._path=new $b());},$n(0,$h,"globalCompositeOperation",function(){return $e.NAMES[this._nBlendType];},function($J){var $h=$e.TOINT[$J];null==$h||this._nBlendType===$h||($v.save(this,65536,this,!0),this._curSubmit=$TJ.RENDERBASE,this._renderKey=0,this._nBlendType=$h);}),$n(0,$h,"strokeStyle",function(){return this._shader2D.strokeStyle;},function($J){this._shader2D.strokeStyle.equal($J)||($v.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=$H.create($J));}),$n(0,$h,"globalAlpha",function(){return this._shader2D.ALPHA;},function($J){($J=Math.floor(1e3*$J)/1e3)!=this._shader2D.ALPHA&&($v.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=$J);}),$n(0,$h,"asBitmap",null,function($J){if($J){if(this._targets||(this._targets=new $N()),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height);}else this._targets=null;}),$n(0,$h,"fillStyle",function(){return this._shader2D.fillStyle;},function($J){this._shader2D.fillStyle.equal($J)||($v.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=$H.create($J));}),$n(0,$h,"textAlign",function(){return this._other.textAlign;},function($J){this._other.textAlign===$J||(this._other=this._other.make(),$v.save(this,32768,this._other,!1),this._other.textAlign=$J);}),$n(0,$h,"lineWidth",function(){return this._other.lineWidth;},function($J){this._other.lineWidth===$J||(this._other=this._other.make(),$v.save(this,256,this._other,!1),this._other.lineWidth=$J);}),$n(0,$h,"textBaseline",function(){return this._other.textBaseline;},function($J){this._other.textBaseline===$J||(this._other=this._other.make(),$v.save(this,16384,this._other,!1),this._other.textBaseline=$J);}),$n(0,$h,"font",null,function($J){$J!=this._other.font.toString()&&(this._other=this._other.make(),$v.save(this,8,this._other,!1),this._other.font===$iJ.EMPTY?this._other.font=new $iJ($J):this._other.font.setFont($J));}),$B.__init__=function(){$f.DEFAULT=new $f();},$B._tempPoint=new $F(),$B._SUBMITVBSIZE=32e3,$B._MAXSIZE=99999999,$B._RECTVBSIZE=16,$B.MAXCLIPRECT=new $A(0,0,99999999,99999999),$B._COUNT=0,$B._tmpMatrix=new $g(),$B.SEGNUM=32,$B._contextcount=0,$k($B,["_fontTemp",function(){return this._fontTemp=new $iJ();},"_drawStyleTemp",function(){return this._drawStyleTemp=new $H(null);}]),$B.__init$=function(){$f=function(){function $J(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=$iJ.EMPTY;}$R($J,"");var $h=$J.prototype;return $h.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=$iJ.EMPTY;},$h.make=function(){return this===$J.DEFAULT?new $J():this;},$J.DEFAULT=null,$J;}();},$B;}(),$DJ=function($J){function $n($J,$h){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,$n.__super.call(this),this.defines=new $GJ(),this.position=$n._POSITION,this.mainID=$J,this.subID=$h,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=$J|$h,this._inClassCache=$n._cache[this._cacheID],0<$J&&!this._inClassCache&&(this._inClassCache=$n._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear();}$R($n,"laya.webgl.shader.d2.value.Value2D",$a);var $h=$n.prototype;return $h.setValue=function($J){},$h.refresh=function(){var $J=this.size;return $J[0]=$_J.width,$J[1]=$_J.height,this.alpha=this.ALPHA*$_J.worldAlpha,this.mmat=$_J.worldMatrix4,this;},$h._ShaderWithCompile=function(){return $XJ.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,$NJ.create);},$h._withWorldShaderDefines=function(){var $J=$_J.worldShaderDefines,$h=$XJ.sharders[this.mainID|this.defines._value|$J.getValue()];if(!$h){var $f,$n={};for($f in this.defines.toNameDic())$n[$f]="";for($f in $J.toNameDic())$n[$f]="";$h=$XJ.withCompile2D(0,this.mainID,$n,this.mainID|this.defines._value|$J.getValue(),$NJ.create);}var $L=$_J.worldFilters;if(!$L)return $h;for(var $T,$k=$L.length,$u=0;$u<$k;$u++)($T=$L[$u])&&$T.action.setValue(this);return $h;},$h.upload=function(){var $J=$_J;this.alpha=this.ALPHA*$J.worldAlpha,$_J.worldMatrix4!==$_J.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),$dJ.shaderHighPrecision&&this.defines.add(1024);var $h,$f=$J.worldShaderDefines?this._withWorldShaderDefines():$XJ.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=$J.width,this.size[1]=$J.height,this.mmat=$J.worldMatrix4,$ZJ.activeShader!==$f?$f._shaderValueWidth!==$J.width||$f._shaderValueHeight!==$J.height?($f._shaderValueWidth=$J.width,$f._shaderValueHeight=$J.height):$h=$f._params2dQuick2||$f._make2dQuick2():$f._shaderValueWidth!==$J.width||$f._shaderValueHeight!==$J.height?($f._shaderValueWidth=$J.width,$f._shaderValueHeight=$J.height):$h=$f._params2dQuick1||$f._make2dQuick1(),$f.upload(this,$h);},$h.setFilters=function($J){if(this.filters=$J)for(var $h,$f=$J.length,$n=0;$n<$f;$n++)($h=$J[$n])&&(this.defines.add($h.type),$h.action.setValue(this));},$h.clear=function(){this.defines.setValue(this.subID);},$h.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear();},$n._initone=function($J,$h){$n._typeClass[$J]=$h,$n._cache[$J]=[],$n._cache[$J]._length=0;},$n.__init__=function(){$n._POSITION=[2,5126,!1,4*$qJ.BYTES_PE,0],$n._TEXCOORD=[2,5126,!1,4*$qJ.BYTES_PE,2*$qJ.BYTES_PE],$n._initone(2,$BJ),$n._initone(4,$eJ),$n._initone(256,$VJ),$n._initone(512,$aJ),$n._initone(1,$CJ),$n._initone(65,$EJ),$n._initone(9,$CJ);},$n.create=function($J,$h){var $f=$n._cache[$J|$h];return $f._length?$f[--$f._length]:new $n._typeClass[$J|$h]($h);},$n._POSITION=null,$n._TEXCOORD=null,$n._cache=[],$n._typeClass=[],$n.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$n;}(),$gJ=function($J){function $o($J,$h){$o.__super.call(this,$J,$h);}$R($o,"laya.webgl.utils.RenderSprite3D",$_);var $h=$o.prototype;return $h.onCreate=function($J){switch($J){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform);}},$h._mask=function($J,$h,$f,$n){var $L,$T,$k=this._next,$u=$J.mask;if($u){$h.ctx.save();var $S=$h.ctx.globalCompositeOperation,$Y=new $A();if($Y.copyFrom($u.getBounds()),$Y.width=Math.round($Y.width),$Y.height=Math.round($Y.height),$Y.x=Math.round($Y.x),$Y.y=Math.round($Y.y),0<$Y.width&&0<$Y.height){var $x=$J._style._tf,$j=$uJ.create();$j.addValue("bounds",$Y),$L=$kJ.create([$j,$h],laya.webgl.utils.RenderSprite3D.tmpTarget),$h.addRenderObject($L),$u.render($h,-$Y.x,-$Y.y),$L=$kJ.create([$j],laya.webgl.utils.RenderSprite3D.endTmpTarget),$h.addRenderObject($L),$h.ctx.save(),$h.clipRect($f-$x.translateX+$Y.x,$n-$x.translateY+$Y.y,$Y.width,$Y.height),$k._fun.call($k,$J,$h,$f,$n),$h.ctx.restore(),$T=$xJ.create(6),$S=$h.ctx.globalCompositeOperation,$T.blendMode="mask",$h.addRenderObject($T),$g.TEMP.identity();var $R=$DJ.create(1,0),$l=$m.INV_UV,$i=$Y.width,$q=$Y.height;($Y.width<32||$Y.height<32)&&(($l=$o.tempUV)[0]=0,$l[1]=0,$l[2]=32<=$Y.width?1:$Y.width/32,$l[3]=0,$l[4]=32<=$Y.width?1:$Y.width/32,$l[5]=32<=$Y.height?1:$Y.height/32,$l[6]=0,$l[7]=32<=$Y.height?1:$Y.height/32,$Y.width=32<=$Y.width?$Y.width:32,$Y.height=32<=$Y.height?$Y.height:32,$l[1]*=-1,$l[3]*=-1,$l[5]*=-1,$l[7]*=-1,$l[1]+=1,$l[3]+=1,$l[5]+=1,$l[7]+=1),$h.ctx.drawTarget($j,$f+$Y.x-$x.translateX,$n+$Y.y-$x.translateY,$i,$q,$g.TEMP,"tmpTarget",$R,$l,6),$L=$kJ.create([$j],laya.webgl.utils.RenderSprite3D.recycleTarget),$h.addRenderObject($L),($T=$xJ.create(6)).blendMode=$S,$h.addRenderObject($T);}$h.ctx.restore();}else $k._fun.call($k,$J,$h,$f,$n);},$h._blend=function($J,$h,$f,$n){var $L=$J._style,$T=this._next;$L.blendMode?($h.ctx.save(),$h.ctx.globalCompositeOperation=$L.blendMode,$T._fun.call($T,$J,$h,$f,$n),$h.ctx.restore()):$T._fun.call($T,$J,$h,$f,$n);},$h._transform=function($J,$h,$f,$n){var $L=$J.transform,$T=this._next;if($L&&$T!=$_.NORENDER){var $k=$h.ctx;$J._style;$L.tx=$f,$L.ty=$n;var $u=$k._getTransformMatrix(),$S=$u.clone();$g.mul($L,$u,$u),$u._checkTransform(),$L.tx=$L.ty=0,$T._fun.call($T,$J,$h,0,0),$S.copyTo($u),$S.destroy();}else $T._fun.call($T,$J,$h,$f,$n);},$o.tmpTarget=function($J,$h){var $f=$J.getValue("bounds"),$n=$tJ.create($f.width,$f.height);$n.start(),$n.clear(0,0,0,0),$J.addValue("tmpTarget",$n);},$o.endTmpTarget=function($J){$J.getValue("tmpTarget").end();},$o.recycleTarget=function($J){$J.getValue("tmpTarget").recycle(),$J.recycle();},$k($o,["tempUV",function(){return this.tempUV=[];}]),$o;}(),$FJ=function($J){function $h(){this.data=null,$h.__super.call(this);}$R($h,"laya.filters.webgl.ColorFilterActionGL",$c);var $f=$h.prototype;return $U.imps($f,{"laya.filters.IFilterActionGL":!0}),$f.setValue=function($J){$J.colorMat=this.data._mat,$J.colorAlpha=this.data._alpha;},$f.apply3d=function($J,$h,$f,$n,$L){var $T=$J.getValue("bounds"),$k=$DJ.create(1,0);$k.setFilters([this.data]);var $u=$g.TEMP;$u.identity(),$f.ctx.drawTarget($J,0,0,$T.width,$T.height,$u,"src",$k);},$h;}(),$AJ=function($J){function $T($J,$h,$f,$n,$L){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,$T.__super.call(this,$J,$h,$L),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new $HJ(),this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=$f,this._atlasCanvas.height=$n,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0;}$R($T,"laya.webgl.atlas.Atlaser",$B);var $h=$T.prototype;return $h.computeUVinAtlasTexture=function($J,$h,$f,$n){var $L=$V.atlasTextureWidth,$T=$V.atlasTextureHeight,$k=$f/$L,$u=$n/$T,$S=($f+$J.bitmap.width)/$L,$Y=($n+$J.bitmap.height)/$T,$x=$J.bitmap.width/$L,$j=$J.bitmap.height/$T;$J.uv=[$k+$h[0]*$x,$u+$h[1]*$j,$S-(1-$h[2])*$x,$u+$h[3]*$j,$S-(1-$h[4])*$x,$Y-(1-$h[5])*$j,$k+$h[6]*$x,$Y-(1-$h[7])*$j];},$h.findBitmapIsExist=function($J){if($J instanceof laya.webgl.resource.WebGLImage){var $h=$J,$f=$h.url,$n=this._InAtlasWebGLImagesKey[$f||$h.id];if($n)return $n.offsetInfoID;}return-1;},$h.addToAtlasTexture=function($J,$h,$f){if($J instanceof laya.webgl.resource.WebGLImage){var $n=$J,$L=$n.url;this._InAtlasWebGLImagesKey[$L||$n.id]={bitmap:$J,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([$h,$f]);}this._atlasCanvas.texSubImage2D($h,$f,$J.atlasSource),$J.clearAtlasSource();},$h.addToAtlas=function($J,$h,$f){$J._atlasID=this._inAtlasTextureKey.length;var $n=$J.uv.slice(),$L=$J.bitmap;this._inAtlasTextureKey.push($J),this._inAtlasTextureOriUVValue.push($n),this._inAtlasTextureBitmapValue.push($L),this.computeUVinAtlasTexture($J,$n,$h,$f),$J.bitmap=this._atlasCanvas;},$h.clear=function(){for(var $J=0,$h=this._inAtlasTextureKey.length;$J<$h;$J++)this._inAtlasTextureKey[$J].bitmap=this._inAtlasTextureBitmapValue[$J],this._inAtlasTextureKey[$J].uv=this._inAtlasTextureOriUVValue[$J],this._inAtlasTextureKey[$J]._atlasID=-1,this._inAtlasTextureKey[$J].bitmap.lock=!1,this._inAtlasTextureKey[$J].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0;},$h.dispose=function(){this.clear(),this._atlasCanvas.destroy();},$n(0,$h,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue;}),$n(0,$h,"texture",function(){return this._atlasCanvas;}),$n(0,$h,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey;}),$T;}(),$GJ=function($J){function $f(){$f.__super.call(this,$f.__name2int,$f.__int2name,$f.__int2nameMap);}return $R($f,"laya.webgl.shader.d2.ShaderDefines2D",$K),$f.__init__=function(){$f.reg("TEXTURE2D",1),$f.reg("COLOR2D",2),$f.reg("PRIMITIVE",4),$f.reg("GLOW_FILTER",8),$f.reg("BLUR_FILTER",16),$f.reg("COLOR_FILTER",32),$f.reg("COLOR_ADD",64),$f.reg("WORLDMAT",128),$f.reg("FILLTEXTURE",256),$f.reg("FSHIGHPRECISION",1024),$f.reg("TXTALPHA",2048),$f.reg("TXTCOMPRESS",4096);},$f.reg=function($J,$h){$K._reg($J,$h,$f.__name2int,$f.__int2name);},$f.toText=function($J,$h,$f){return $K._toText($J,$h,$f);},$f.toInt=function($J){return $K._toInt($J,$f.__name2int);},$f.TEXTURE2D=1,$f.COLOR2D=2,$f.PRIMITIVE=4,$f.FILTERGLOW=8,$f.FILTERBLUR=16,$f.FILTERCOLOR=32,$f.COLORADD=64,$f.WORLDMAT=128,$f.FILLTEXTURE=256,$f.SKINMESH=512,$f.SHADERDEFINE_FSHIGHPRECISION=1024,$f.TXTALPHA=2048,$f.TXTCOMPRESS=4096,$f.__name2int={},$f.__int2name=[],$f.__int2nameMap=[],$f;}(),$yJ=(function($J){function $u($J,$h,$f,$n,$L,$T,$k){$u.__super.call(this,$J,$h,$f,$n,40,$L,$T,$k);}$R($u,"laya.webgl.shapes.Ellipse",$fJ);}(),function($J){function $T($J,$h,$f,$n,$L){this._points=[],this.rebuild($f),$T.__super.call(this,$J,$h,0,0,0,$L,$n,$L,0);}$R($T,"laya.webgl.shapes.Line",$fJ);var $h=$T.prototype;return $h.rebuild=function($J){var $h=$J.length;$h!=this._points.length&&(this.mUint16Array=new Uint16Array(6*($h/2-1)),this.mFloat32Array=new Float32Array(5*$h)),this._points.length=0;for(var $f=NaN,$n=NaN,$L=-1,$T=-1,$k=$J.length/2,$u=0;$u<$k;$u++)$f=$J[2*$u],$n=$J[2*$u+1],(.01<Math.abs($L-$f)||.01<Math.abs($T-$n))&&this._points.push($f,$n),$L=$f,$T=$n;},$h.getData=function($J,$h,$f){var $n=[],$L=[];0<this.borderWidth&&this.createLine2(this._points,$n,this.borderWidth,$f,$L,this._points.length/2),this.mUint16Array.set($n,0),this.mFloat32Array.set($L,0),$J.append(this.mUint16Array),$h.append(this.mFloat32Array);},$T;}()),$OJ=function($J){function $j($J,$h,$f,$n,$L){this._points=[];for(var $T=NaN,$k=NaN,$u=-1,$S=-1,$Y=$f.length/2-1,$x=0;$x<$Y;$x++)$T=$f[2*$x],$k=$f[2*$x+1],(.01<Math.abs($u-$T)||.01<Math.abs($S-$k))&&this._points.push($T,$k),$u=$T,$S=$k;$T=$f[2*$Y],$k=$f[2*$Y+1],$u=this._points[0],$S=this._points[1],(.01<Math.abs($u-$T)||.01<Math.abs($S-$k))&&this._points.push($T,$k),$j.__super.call(this,$J,$h,0,0,this._points.length/2,0,$n,$L);}$R($j,"laya.webgl.shapes.LoopLine",$fJ);var $h=$j.prototype;return $h.getData=function($J,$h,$f){if(0<this.borderWidth){for(var $n=this.color,$L=($n>>16&255)/255,$T=($n>>8&255)/255,$k=(255&$n)/255,$u=[],$S=0,$Y=0,$x=[],$j=Math.floor(this._points.length/2),$R=0;$R<$j;$R++)$S=this._points[2*$R],$Y=this._points[2*$R+1],$u.push(this.x+$S,this.y+$Y,$L,$T,$k);this.createLoopLine($u,$x,this.borderWidth,$f+$u.length/5),$J.append(new Uint16Array($x)),$h.append(new Float32Array($u));}},$h.createLoopLine=function($J,$h,$f,$n,$L,$T){$J.length;var $k=$J.concat(),$u=$L||$J,$S=this.borderColor,$Y=($S>>16&255)/255,$x=($S>>8&255)/255,$j=(255&$S)/255,$R=[$k[0],$k[1]],$l=[$k[$k.length-5],$k[$k.length-4]],$i=$l[0]+.5*($R[0]-$l[0]),$q=$l[1]+.5*($R[1]-$l[1]);$k.unshift($i,$q,0,0,0),$k.push($i,$q,0,0,0);var $o,$r,$_,$s,$d,$p,$U,$Q,$D,$g,$F,$A,$G,$y,$O,$P,$W,$I,$m,$Z,$t=$k.length/5,$c=$n,$a=$f/2;$_=$k[0],$s=$k[1],$g=$_-($d=$k[5]),$D=($D=-($s-($p=$k[6])))/($Z=Math.sqrt($D*$D+$g*$g))*$a,$g=$g/$Z*$a,$u.push($_-$D,$s-$g,$Y,$x,$j,$_+$D,$s+$g,$Y,$x,$j);for(var $B=1;$B<$t-1;$B++)$_=$k[5*($B-1)],$s=$k[5*($B-1)+1],$d=$k[5*$B],$p=$k[5*$B+1],$U=$k[5*($B+1)],$Q=$k[5*($B+1)+1],$g=$_-$d,$A=$d-$U,$O=(-($D=($D=-($s-$p))/($Z=Math.sqrt($D*$D+$g*$g))*$a)+$_)*(-($g=$g/$Z*$a)+$p)-(-$D+$d)*(-$g+$s),$I=(-($F=($F=-($p-$Q))/($Z=Math.sqrt($F*$F+$A*$A))*$a)+$U)*(-($A=$A/$Z*$a)+$p)-(-$F+$d)*(-$A+$Q),$m=($G=-$g+$s-(-$g+$p))*($W=-$F+$d-(-$F+$U))-($P=-$A+$Q-(-$A+$p))*($y=-$D+$d-(-$D+$_)),Math.abs($m)<.1?($m+=10.1,$u.push($d-$D,$p-$g,$Y,$x,$j,$d+$D,$p+$g,$Y,$x,$j)):((($o=($y*$I-$W*$O)/$m)-$d)*($o-$d)+(($r=($P*$O-$G*$I)/$m)-$p)+($r-$p),$u.push($o,$r,$Y,$x,$j,$d-($o-$d),$p-($r-$p),$Y,$x,$j));$T&&($h=$T);var $V=this.edges+1;for($B=1;$B<$V;$B++)$h.push($c+2*($B-1),$c+2*($B-1)+1,$c+2*$B+1,$c+2*$B+1,$c+2*$B,$c+2*($B-1));return $h.push($c+2*($B-1),$c+2*($B-1)+1,$c+1,$c+1,$c,$c+2*($B-1)),$u;},$j;}(),$PJ=function($J){function $k($J,$h,$f,$n,$L,$T){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=$g.create(),this._points=$f.slice(0,$f.length),$k.__super.call(this,$J,$h,0,0,this._points.length/2,$n,$L,$T);}$R($k,"laya.webgl.shapes.Polygon",$fJ);var $h=$k.prototype;return $h.rebuild=function($J){this._repaint||(this._points.length=0,this._points=this._points.concat($J));},$h.setMatrix=function($J){$J.copyTo(this._mat);},$h.needUpdate=function($J){return this._repaint=this._mat.a==$J.a&&this._mat.b==$J.b&&this._mat.c==$J.c&&this._mat.d==$J.d&&this._mat.tx==$J.tx&&this._mat.ty==$J.ty,!this._repaint;},$h.getData=function($J,$h,$f){var $n,$L=0,$T=this._points,$k=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=$f){for(this._start=$f,$n=[],$k=this.earcutTriangles.length,$L=0;$L<$k;$L++)$n.push(this.earcutTriangles[$L]+$f);this.mUint16Array=new Uint16Array($n);}}else{this._start=$f,$n=[];var $u=[],$S=[],$Y=this.color,$x=($Y>>16&255)/255,$j=($Y>>8&255)/255,$R=(255&$Y)/255;for($k=Math.floor($T.length/2),$L=0;$L<$k;$L++)$u.push(this.x+$T[2*$L],this.y+$T[2*$L+1],$x,$j,$R),$S.push(this.x+$T[2*$L],this.y+$T[2*$L+1]);for(this.earcutTriangles=$nJ.earcut($S,null,2),$k=this.earcutTriangles.length,$L=0;$L<$k;$L++)$n.push(this.earcutTriangles[$L]+$f);this.mUint16Array=new Uint16Array($n),this.mFloat32Array=new Float32Array($u);}$J.append(this.mUint16Array),$h.append(this.mFloat32Array);},$k;}(),$WJ=function($J){function $T(){this._matrix=new $g(),this._matrix4=$qJ.defaultMatrix4.concat(),$T.__super.call(this,1e4),this.shaderValue=new $DJ(0,0);}$R($T,"laya.webgl.submit.SubmitCanvas",$TJ);var $h=$T.prototype;return $h.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var $J=$_J.worldAlpha,$h=$_J.worldMatrix4,$f=$_J.worldMatrix,$n=$_J.worldFilters,$L=$_J.worldShaderDefines,$T=this.shaderValue,$k=this._matrix,$u=this._matrix4,$S=$g.TEMP;return $g.mul($k,$f,$S),$u[0]=$S.a,$u[1]=$S.b,$u[4]=$S.c,$u[5]=$S.d,$u[12]=$S.tx,$u[13]=$S.ty,$_J.worldMatrix=$S.clone(),$_J.worldMatrix4=$u,$_J.worldAlpha=$_J.worldAlpha*$T.alpha,$T.filters&&$T.filters.length&&($_J.worldFilters=$T.filters,$_J.worldShaderDefines=$T.defines),this._ctx_src.flush(),$_J.worldAlpha=$J,$_J.worldMatrix4=$h,$_J.worldMatrix.destroy(),$_J.worldMatrix=$f,$_J.worldFilters=$n,$_J.worldShaderDefines=$L,1;},$h.releaseRender=function(){var $J=$T._cache;this._ctx_src=null,$J[$J._length++]=this;},$h.getRenderType=function(){return 10003;},$T.create=function($J,$h,$f){var $n=$T._cache._length?$T._cache[--$T._cache._length]:new $T();$n._ctx_src=$J;var $L=$n.shaderValue;return $L.alpha=$h,$L.defines.setValue(0),$f&&$f.length&&$L.setFilters($f),$n;},$T._cache=(($T._cache=[])._length=0,$T._cache),$T;}(),$IJ=function($J){function $Y($J){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=[],this._texsID=[],this._vbPos=[],void 0===$J&&($J=1e4),$Y.__super.call(this,$J);}$R($Y,"laya.webgl.submit.SubmitTexture",$TJ);var $h=$Y.prototype;return $h.releaseRender=function(){var $J=$Y._cache;($J[$J._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0;},$h.addTexture=function($J,$h){this._texsID[this._texs.length]=$J._uvID,this._texs.push($J),this._vbPos.push($h);},$h.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var $J=this.shaderValue.textureHost.bitmap;if(null!==$J)for(var $h=this._vb.getFloat32Array(),$f=0,$n=this._texs.length;$f<$n;$f++){var $L=this._texs[$f];$L.active();var $T=$L.uv;if(this._texsID[$f]!==$L._uvID){this._texsID[$f]=$L._uvID;var $k=this._vbPos[$f];$h[$k+2]=$T[0],$h[$k+3]=$T[1],$h[$k+6]=$T[2],$h[$k+7]=$T[3],$h[$k+10]=$T[4],$h[$k+11]=$T[5],$h[$k+14]=$T[6],$h[$k+15]=$T[7],this._vb.setNeedUpload();}$L.bitmap!==$J&&(this._isSameTexture=!1);}}},$h.renderSubmit=function(){if(0===this._numEle)return $Y._shaderSet=!1,1;var $J=this.shaderValue.textureHost;if($J){var $h=$J.source;if(!$J.bitmap||!$h)return $Y._shaderSet=!1,1;this.shaderValue.texture=$h,$J.alphaTexture&&$J.alphaTexture.source&&(this.shaderValue.texture1=$J.alphaTexture.source);}this._vb.bind_upload(this._ib);var $f=$dJ.mainContext;if($e.activeBlendFunction!==this._blendFn&&($f.enable(3042),this._blendFn($f),$e.activeBlendFunction=this._blendFn),$O.drawCall++,$O.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&$ZJ.activeShader&&$Y._shaderSet?($ZJ.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&$ZJ.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),$Y._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var $n=$J.bitmap,$L=0,$T=$ZJ.activeShader,$k=0,$u=this._texs.length;$k<$u;$k++){var $S=this._texs[$k];$S.bitmap===$n&&$k+1!==$u||($T.uploadTexture2D($S.source),$f.drawElements(4,6*($k-$L+1),5123,this._startIdx+6*$L*$qJ.BYTES_PIDX),$n=$S.bitmap,$L=$k);}else $f.drawElements(4,this._numEle,5123,this._startIdx);return 1;},$Y.create=function($J,$h,$f,$n,$L){var $T=$Y._cache._length?$Y._cache[--$Y._cache._length]:new $Y();null==$f&&(($f=$T._selfVb||($T._selfVb=$KJ.create(-1))).clear(),$n=0),$T._ib=$h,$T._vb=$f,$T._startIdx=$n*$qJ.BYTES_PIDX,$T._numEle=0;var $k=$J._nBlendType;$T._blendFn=$J._targets?$e.targetFns[$k]:$e.fns[$k],$T.shaderValue=$L,$T.shaderValue.setValue($J._shader2D);var $u=$J._shader2D.filters;return $u&&$T.shaderValue.setFilters($u),$T;},$Y._cache=(($Y._cache=[])._length=0,$Y._cache),$Y._shaderSet=!0,$Y;}(),$mJ=function($J){function $r(){$r.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo);}$R($r,"laya.webgl.utils.MeshTexture",$rJ);var $h=$r.prototype;return $h.addData=function($J,$h,$f,$n,$L,$T){for(var $k=$J.length/2,$u=this._vb.needSize($k*$r.const_stride)>>2,$S=this._vb.getFloat32Array(),$Y=0,$x=0;$x<$k;$x++){var $j=$J[$Y],$R=$J[$Y+1],$l=$j*$n.a+$R*$n.c+$n.tx,$i=$j*$n.b+$R*$n.d+$n.ty;$S[$u++]=$l,$S[$u++]=$i,$S[$u++]=$h[$Y],$S[$u++]=$h[$Y+1],$Y+=2;}this._vb.setNeedUpload();var $q=this.vertNum;if(0<$q){($k=$f.length)>$r.tmpIdx.length&&($r.tmpIdx=new Uint16Array($k));for(var $o=0;$o<$k;$o++)$r.tmpIdx[$o]=$f[$o]+$q;this._ib.appendU16Array($r.tmpIdx,$f.length);}else this._ib.append($f);this._ib.setNeedUpload(),this.vertNum+=$k,this.indexNum+=$f.length;},$h.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this);},$h.destroy=function(){this._ib.destroy(),this._vb.destroy();},$r.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new $r();},$r.const_stride=16,$r._POOL=[],$k($r,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8];},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4);}]),$r;}(),$ZJ=function($J){function $h(){$h.__super.call(this),this.lock=!0;}return $R($h,"laya.webgl.shader.BaseShader",$s),$h.activeShader=null,$h.bindShader=null,$h;}(),$tJ=function($h){function $x($J,$h,$f,$n,$L,$T,$k,$u,$S){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===$f&&($f=6408),void 0===$n&&($n=5121),void 0===$L&&($L=34041),void 0===$T&&($T=!1),void 0===$k&&($k=!1),void 0===$u&&($u=-1),void 0===$S&&($S=-1),this._type=1,this._w=$J,this._h=$h,this._surfaceFormat=$f,this._surfaceType=$n,this._depthStencilFormat=$L,$r.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=$T,this._repeat=$k,this._minFifter=$u,this._magFifter=$S,this._createWebGLRenderTarget(),this.bitmap.lock=!0,$x.__super.call(this,this.bitmap,$m.INV_UV);}$R($x,"laya.webgl.resource.RenderTarget2D",$h);var $J=$x.prototype;return $U.imps($J,{"laya.resource.IDispose":!0}),$J.getType=function(){return this._type;},$J.getTexture=function(){return this;},$J.size=function($J,$h){this._w==$J&&this._h==$h||(this._w=$J,this._h=$h,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget());},$J.release=function(){this.destroy();},$J.recycle=function(){$x.POOL.push(this);},$J.start=function(){var $J=$dJ.mainContext;return this._preRenderTarget=$_J.curRenderTarget,$_J.curRenderTarget=this,$J.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&($J.viewport(0,0,this._w,this._h),this._svWidth=$_J.width,this._svHeight=$_J.height,$_J.width=this._w,$_J.height=this._h,$ZJ.activeShader=null),this;},$J.clear=function($J,$h,$f,$n){void 0===$J&&($J=0),void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=1);var $L=$dJ.mainContext;$L.clearColor($J,$h,$f,$n);var $T=16384;switch(this._depthStencilFormat){case 33189:$T|=256;break;case 36168:$T|=1024;break;case 34041:$T|=256,$T|=1024;}$L.clear($T);},$J.end=function(){var $J=$dJ.mainContext;$J.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,$_J.curRenderTarget=this._preRenderTarget,1==this._type?($J.viewport(0,0,this._svWidth,this._svHeight),$_J.width=this._svWidth,$_J.height=this._svHeight,$ZJ.activeShader=null):$J.viewport(0,0,$U.stage.width,$U.stage.height);},$J.getData=function($J,$h,$f,$n){var $L=$dJ.mainContext;if($L.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===$L.checkFramebufferStatus(36160)))return $L.bindFramebuffer(36160,null),null;var $T=new Uint8Array(this._w*this._h*4);return $L.readPixels($J,$h,$f,$n,this._surfaceFormat,this._surfaceType,$T),$L.bindFramebuffer(36160,null),$T;},$J.destroy=function($J){void 0===$J&&($J=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,$h.prototype.destroy.call(this));},$J.dispose=function(){},$J._createWebGLRenderTarget=function(){this.bitmap=new $$J(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function($J){this.event("recovered");});},$n(0,$J,"surfaceFormat",function(){return this._surfaceFormat;}),$n(0,$J,"magFifter",function(){return this._magFifter;}),$n(0,$J,"surfaceType",function(){return this._surfaceType;}),$n(0,$J,"mipMap",function(){return this._mipMap;}),$n(0,$J,"depthStencilFormat",function(){return this._depthStencilFormat;}),$n(0,$J,"minFifter",function(){return this._minFifter;}),$n(0,$J,"source",function(){return this._alreadyResolved?$U.superGet($m,this,"source"):null;}),$x.create=function($J,$h,$f,$n,$L,$T,$k,$u,$S){void 0===$f&&($f=6408),void 0===$n&&($n=5121),void 0===$L&&($L=34041),void 0===$T&&($T=!1),void 0===$k&&($k=!1),void 0===$u&&($u=-1),void 0===$S&&($S=-1);var $Y=$x.POOL.pop();return $Y||($Y=new $x($J,$h)),$Y.bitmap&&$Y._w==$J&&$Y._h==$h&&$Y._surfaceFormat==$f&&$Y._surfaceType==$n&&$Y._depthStencilFormat==$L&&$Y._mipMap==$T&&$Y._repeat==$k&&$Y._minFifter==$u&&$Y._magFifter==$S||($Y._w=$J,$Y._h=$h,$Y._surfaceFormat=$f,$Y._surfaceType=$n,$Y._depthStencilFormat=$L,$r.isConchWebGL&&34041===$Y._depthStencilFormat&&($Y._depthStencilFormat=33189),$Y._mipMap=$T,$Y._repeat=$k,$Y._minFifter=$u,$Y._magFifter=$S,$Y.release(),$Y._createWebGLRenderTarget()),$Y;},$x.TYPE2D=1,$x.TYPE3D=2,$x.POOL=[],$x;}($m),$cJ=function($J){function $h(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,$h.__super.call(this),$h._gl=$dJ.mainContext;}$R($h,"laya.webgl.utils.Buffer",$s);var $f=$h.prototype;return $f._bind=function(){this.activeResource(),$h._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&($h._bindVertexBuffer=this._glBuffer),$h._gl.bindBuffer(this._bufferType,$h._bindActive[this._bufferType]=this._glBuffer),$ZJ.activeShader=null);},$f.recreateResource=function(){this._glBuffer||(this._glBuffer=$h._gl.createBuffer()),this.completeCreate();},$f.disposeResource=function(){this._glBuffer&&($dJ.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0;},$n(0,$f,"bufferUsage",function(){return this._bufferUsage;}),$h._gl=null,$h._bindActive={},$h._bindVertexBuffer=null,$h._enableAtributes=[],$h;}(),$aJ=function($J){function $f($J){this.texcoord=null,this.offsetX=300,this.offsetY=0,$f.__super.call(this,512,0);var $h=8*$qJ.BYTES_PE;this.position=[2,5126,!1,$h,0],this.texcoord=[2,5126,!1,$h,2*$qJ.BYTES_PE],this.color=[4,5126,!1,$h,4*$qJ.BYTES_PE];}return $R($f,"laya.webgl.shader.d2.skinAnishader.SkinSV",$DJ),$f;}(),$BJ=function($J){function $h($J){$h.__super.call(this,2,0),this.color=[];}return $R($h,"laya.webgl.shader.d2.value.Color2dSV",$DJ),$h.prototype.setValue=function($J){$J.fillStyle&&(this.color=$J.fillStyle._color._color),$J.strokeStyle&&(this.color=$J.strokeStyle._color._color);},$h;}(),$VJ=function($J){function $h($J){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=$DJ._TEXCOORD,$h.__super.call(this,256,0);}$R($h,"laya.webgl.shader.d2.value.FillTextureSV",$DJ);var $f=$h.prototype;return $f.setValue=function($J){this.ALPHA=$J.ALPHA,$J.filters&&this.setFilters($J.filters);},$f.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0);},$h;}(),$CJ=function($J){function $h($J){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=$DJ._TEXCOORD,void 0===$J&&($J=0),$h.__super.call(this,1,$J);}$R($h,"laya.webgl.shader.d2.value.TextureSV",$DJ);var $f=$h.prototype;return $f.setValue=function($J){this.ALPHA=$J.ALPHA,$J.filters&&this.setFilters($J.filters);},$f.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0);},$h;}(),$eJ=function($J){function $h($J){this.a_color=null,this.u_pos=[0,0],$h.__super.call(this,4,0),this.position=[2,5126,!1,5*$qJ.BYTES_PE,0],this.a_color=[3,5126,!1,5*$qJ.BYTES_PE,2*$qJ.BYTES_PE];}return $R($h,"laya.webgl.shader.d2.value.PrimitiveSV",$DJ),$h;}(),$HJ=function($J){function $h(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,$h.__super.call(this);}$R($h,"laya.webgl.atlas.AtlasWebGLCanvas",$J);var $f=$h.prototype;return $f.recreateResource=function(){var $J=$dJ.mainContext,$h=this._source=$J.createTexture(),$f=$pJ.curBindTexTarget,$n=$pJ.curBindTexValue;$pJ.bindTexture($J,3553,$h),$J.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),$J.texParameteri(3553,10241,9729),$J.texParameteri(3553,10240,9729),$J.texParameteri(3553,10242,33071),$J.texParameteri(3553,10243,33071),$f&&$n&&$pJ.bindTexture($J,$f,$n),this.memorySize=this._w*this._h*4,this.completeCreate();},$f.disposeResource=function(){this._source&&($dJ.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0);},$f.texSubImage2D=function($J,$h,$f){if($r.isFlash){this._flashCacheImage||(this._flashCacheImage=$q.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var $n=$f.bitmapdata;this._flashCacheImage._image.copyPixels($n,0,0,$n.width,$n.height,$J,$h),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0);}else{var $L=$dJ.mainContext,$T=$pJ.curBindTexTarget,$k=$pJ.curBindTexValue;$pJ.bindTexture($L,3553,this._source),$L.pixelStorei(37441,!0),0<=$J-1&&$L.texSubImage2D(3553,0,$J-1,$h,6408,5121,$f),$J+1<=this._w&&$L.texSubImage2D(3553,0,$J+1,$h,6408,5121,$f),0<=$h-1&&$L.texSubImage2D(3553,0,$J,$h-1,6408,5121,$f),$h+1<=this._h&&$L.texSubImage2D(3553,0,$J,$h+1,6408,5121,$f),$L.texSubImage2D(3553,0,$J,$h,6408,5121,$f),$L.pixelStorei(37441,!1),$T&&$k&&$pJ.bindTexture($L,$T,$k);}},$f.texSubImage2DPixel=function($J,$h,$f,$n,$L){var $T=$dJ.mainContext,$k=$pJ.curBindTexTarget,$u=$pJ.curBindTexValue;$pJ.bindTexture($T,3553,this._source);var $S=new Uint8Array($L.data);$T.pixelStorei(37441,!0),$T.texSubImage2D(3553,0,$J,$h,$f,$n,6408,5121,$S),$T.pixelStorei(37441,!1),$k&&$u&&$pJ.bindTexture($T,$k,$u);},$n(0,$f,"width",$J.prototype._$get_width,function($J){this._w=$J;}),$n(0,$f,"height",$J.prototype._$get_height,function($J){this._h=$J;}),$h;}($f),$bJ=function($J){function $L(){this.flipY=!0,this.alwaysChange=!1,$L.__super.call(this);}$R($L,"laya.webgl.resource.WebGLCanvas",$f);var $h=$L.prototype;return $h.getCanvas=function(){return this._canvas;},$h.clear=function(){this._ctx&&this._ctx.clear();},$h.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this);},$h._setContext=function($J){this._ctx=$J;},$h.getContext=function($J,$h){return this._ctx?this._ctx:this._ctx=$L._createContext(this);},$h.size=function($J,$h){this._w==$J&&this._h==$h||(this._w=$J,this._h=$h,this._ctx&&this._ctx.size($J,$h),this._canvas&&(this._canvas.height=$h,this._canvas.width=$J));},$h.activeResource=function($J){void 0===$J&&($J=!1),this._source||this.recreateResource();},$h.recreateResource=function(){this.createWebGlTexture(),this.completeCreate();},$h.disposeResource=function(){this._source&&!this.iscpuSource&&($dJ.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0);},$h.createWebGlTexture=function(){var $J=$dJ.mainContext;this._canvas;var $h=this._source=$J.createTexture();this.iscpuSource=!1;var $f=$pJ.curBindTexTarget,$n=$pJ.curBindTexValue;$pJ.bindTexture($J,3553,$h),$J.pixelStorei(37440,this.flipY?1:0),$L.premulAlpha&&$J.pixelStorei(37441,!0),$J.texImage2D(3553,0,6408,6408,5121,this._imgData),$L.premulAlpha&&$J.pixelStorei(37441,!1),$J.texParameteri(3553,10240,9729),$J.texParameteri(3553,10241,9729),$J.texParameteri(3553,10242,33071),$J.texParameteri(3553,10243,33071),$J.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,$f&&$n&&$pJ.bindTexture($J,$f,$n);},$h.reloadCanvasData=function(){var $J=$dJ.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var $h=$pJ.curBindTexTarget,$f=$pJ.curBindTexValue;$pJ.bindTexture($J,3553,this._source),$L.premulAlpha&&$J.pixelStorei(37441,!0),$J.texImage2D(3553,0,6408,6408,5121,this._imgData),$L.premulAlpha&&$J.pixelStorei(37441,!1),$J.pixelStorei(37440,0),$h&&$f&&$pJ.bindTexture($J,$h,$f);},$h.texSubImage2D=function($J,$h,$f){var $n=$dJ.mainContext,$L=$pJ.curBindTexTarget,$T=$pJ.curBindTexValue;$pJ.bindTexture($n,3553,this._source),$n.pixelStorei(37441,!0),$n.texSubImage2D(3553,0,$h,$f,6408,5121,$J._source),$n.pixelStorei(37441,!1),$L&&$T&&$pJ.bindTexture($n,$L,$T);},$h.toBase64=function($J,$h,$f){var $n=null;this._canvas&&($n=this._canvas.toDataURL($J,$h)),$f.call(this,$n);},$n(0,$h,"context",function(){return this._ctx;}),$n(0,$h,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source;}),$n(0,$h,"asBitmap",null,function($J){this._ctx&&(this._ctx.asBitmap=$J);}),$L._createContext=null,$L.premulAlpha=!1,$L;}(),$vJ=function($J){function $T($J,$h){this.CborderSize=12,$T.__super.call(this),this.char=$J,this.isSpace=" "===$J,this.xs=$h.scaleX,this.ys=$h.scaleY,this.font=$h.font.toString(),this.fontSize=$h.font.size,this.fillColor=$h.fillColor,this.borderColor=$h.borderColor,this.lineWidth=$h.lineWidth,this.underLine=$h.underLine;var $f,$n=$r.isConchApp;$n?(($f=ConchTextCanvas)._source=ConchTextCanvas,$f._source.canvas=ConchTextCanvas):$f=$l.canvas.source,this.canvas=$f,this._enableMerageInAtlas=!0,this._ctx=$n?$f:this.canvas.getContext("2d",void 0);var $L=$Z.measureText(this.char,this.font);this.cw=$L.width*this.xs,this.ch=($L.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new $m(this);}$R($T,"laya.webgl.resource.WebGLCharImage",$f);var $h=$T.prototype;return $U.imps($h,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$h.active=function(){this.texture.active();},$h.recreateResource=function(){var $J=$r.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),$J){var $h=this.fontSize;1==this.xs&&1==this.ys||($h=parseInt($h*(this.xs>this.ys?this.xs:this.ys)+""));var $f="normal 100 "+this.font;$f=$f.replace($T._fontSizeReg,$h),this.borderColor&&($f+=" 1 "+this.borderColor),this._ctx.font=$f,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null);}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,$I.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var $n=this._ctx.measureText(this.char);$n||($n={width:16});var $L=$n.width+1;this._ctx.lineTo($L,this.fontSize+1),this._ctx.stroke();}this._ctx.restore();}this.borderSize=this.CborderSize,this.completeCreate();},$h.onresize=function($J,$h){this._w=$J,this._h=$h,this._allowMerageInAtlas=!0;},$h.clearAtlasSource=function(){},$n(0,$h,"allowMerageInAtlas",function(){return this._allowMerageInAtlas;}),$n(0,$h,"atlasSource",function(){return this.canvas;}),$n(0,$h,"enableMerageInAtlas",function(){return this._enableMerageInAtlas;},function($J){this._enableMerageInAtlas=$J;}),$T.createOneChar=function($J,$h){return new $T($J,$h);},$T._fontSizeReg=new RegExp("\\d+(?=px)","g"),$T;}(),$$J=function($J){function $Y($J,$h,$f,$n,$L,$T,$k,$u,$S){void 0===$f&&($f=6408),void 0===$n&&($n=5121),void 0===$L&&($L=34041),void 0===$T&&($T=!1),void 0===$k&&($k=!1),void 0===$u&&($u=-1),void 0===$S&&($S=1),$Y.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=$J,this._h=$h,this._surfaceFormat=$f,this._surfaceType=$n,this._depthStencilFormat=$L,this._mipMap=$T,this._repeat=$k,this._minFifter=$u,this._magFifter=$S;}$R($Y,"laya.webgl.resource.WebGLRenderTarget",$f);var $h=$Y.prototype;return $h.recreateResource=function(){var $J=$dJ.mainContext;this._frameBuffer||(this._frameBuffer=$J.createFramebuffer()),this._source||(this._source=$J.createTexture());var $h=$pJ.curBindTexTarget,$f=$pJ.curBindTexValue;$pJ.bindTexture($J,3553,this._source),$J.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var $n=this._minFifter,$L=this._magFifter,$T=this._repeat?10497:33071,$k=$x.isPOT(this._w,this._h);if($k?(this._mipMap?-1!==$n||($n=9987):-1!==$n||($n=9729),-1!==$L||($L=9729),$J.texParameteri(3553,10241,$n),$J.texParameteri(3553,10240,$L),$J.texParameteri(3553,10242,$T),$J.texParameteri(3553,10243,$T),this._mipMap&&$J.generateMipmap(3553)):(-1!==$n||($n=9729),-1!==$L||($L=9729),$J.texParameteri(3553,10241,$n),$J.texParameteri(3553,10240,$L),$J.texParameteri(3553,10242,33071),$J.texParameteri(3553,10243,33071)),$J.bindFramebuffer(36160,this._frameBuffer),$J.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=$J.createRenderbuffer()),$J.bindRenderbuffer(36161,this._depthStencilBuffer),$J.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:$J.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$J.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$J.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer);}$J.bindFramebuffer(36160,null),$h&&$f&&$pJ.bindTexture($J,$h,$f),$J.bindRenderbuffer(36161,null),$k&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate();},$h.disposeResource=function(){this._frameBuffer&&($dJ.mainContext.deleteTexture(this._source),$dJ.mainContext.deleteFramebuffer(this._frameBuffer),$dJ.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null);},$n(0,$h,"depthStencilBuffer",function(){return this._depthStencilBuffer;}),$n(0,$h,"frameBuffer",function(){return this._frameBuffer;}),$Y;}(),$MJ=function($J){function $u($J,$h,$f,$n,$L,$T,$k){this.offsetX=0,this.offsetY=0,$u.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=$T,this.canvas=$J,this._ctx=$J.getContext("2d",void 0),this._w=$n,this._h=$L,this.offsetX=$h,this.offsetY=$f,this.src=$k,this._enableMerageInAtlas=!0,$V.enabled&&this._w<$V.atlasLimitWidth&&this._h<$V.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1;}$R($u,"laya.webgl.resource.WebGLSubImage",$f);var $h=$u.prototype;return $U.imps($h,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$h.size=function($J,$h){this._w=$J,this._h=$h,this._ctx&&this._ctx.size($J,$h),this.canvas&&(this.canvas.height=$h,this.canvas.width=$J);},$h.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate();},$h.createWebGlTexture=function(){var $J=$dJ.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var $h=this._source=$J.createTexture(),$f=$pJ.curBindTexTarget,$n=$pJ.curBindTexValue;$pJ.bindTexture($J,3553,$h),$J.pixelStorei(37441,!0),$J.texImage2D(3553,0,6408,6408,5121,this.canvas),$J.pixelStorei(37441,!1);var $L=this.minFifter,$T=this.magFifter,$k=this.repeat?10497:33071,$u=$x.isPOT(this.width,this.height);$u?(this.mipmap?-1!==$L||($L=9987):-1!==$L||($L=9729),-1!==$T||($T=9729),$J.texParameteri(3553,10240,$T),$J.texParameteri(3553,10241,$L),$J.texParameteri(3553,10242,$k),$J.texParameteri(3553,10243,$k),this.mipmap&&$J.generateMipmap(3553)):(-1!==$L||($L=9729),-1!==$T||($T=9729),$J.texParameteri(3553,10241,$L),$J.texParameteri(3553,10240,$T),$J.texParameteri(3553,10242,33071),$J.texParameteri(3553,10243,33071)),$f&&$n&&$pJ.bindTexture($J,$f,$n),this.canvas=null,$u&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4;},$h.disposeResource=function(){$V.enabled&&this._allowMerageInAtlas||!this._source||($dJ.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0);},$h.clearAtlasSource=function(){},$n(0,$h,"allowMerageInAtlas",function(){return this._allowMerageInAtlas;}),$n(0,$h,"atlasSource",function(){return this.canvas;}),$n(0,$h,"enableMerageInAtlas",function(){return this._allowMerageInAtlas;},function($J){this._allowMerageInAtlas=$J;}),$u;}(),$XJ=function($J){function $Y($J,$h,$f,$n){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,$Y.__super.call(this),!$J||!$h)throw"Shader Error";this._id=++$Y._count,this._vs=$J,this._ps=$h,this._nameMap=$n||{},null!=$f&&($Y.sharders[$f]=this);}$R($Y,"laya.webgl.shader.Shader",$ZJ);var $h=$Y.prototype;return $h.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0;},$h.disposeResource=function(){$dJ.mainContext.deleteShader(this._vshader),$dJ.mainContext.deleteShader(this._pshader),$dJ.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0;},$h._compile=function(){if(!$dJ.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var $J=[this._vs,this._ps],$h=$dJ.mainContext;if(this._program=$h.createProgram(),this._vshader=$Y._createShader($h,$J[0],35633),this._pshader=$Y._createShader($h,$J[1],35632),$h.attachShader(this._program,this._vshader),$h.attachShader(this._program,this._pshader),$h.linkProgram(this._program),!$r.isConchApp&&!$h.getProgramParameter(this._program,35714))throw $h.getProgramInfoLog(this._program);var $f,$n,$L=0,$T=0;for($T=$r.isConchApp?$h.getProgramParameterEx(this._vs,this._ps,"",35721):$h.getProgramParameter(this._program,35721),$L=0;$L<$T;$L++){var $k=null;$f={vartype:"attribute",glfun:null,ivartype:0,attrib:$k=$r.isConchApp?$h.getActiveAttribEx(this._vs,this._ps,"",$L):$h.getActiveAttrib(this._program,$L),location:$h.getAttribLocation(this._program,$k.name),name:$k.name,type:$k.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push($f);}var $u=0;for($u=$r.isConchApp?$h.getProgramParameterEx(this._vs,this._ps,"",35718):$h.getProgramParameter(this._program,35718),$L=0;$L<$u;$L++){var $S=null;$S=$r.isConchApp?$h.getActiveUniformEx(this._vs,this._ps,"",$L):$h.getActiveUniform(this._program,$L),0<($f={vartype:"uniform",glfun:null,ivartype:1,attrib:$k,location:$h.getUniformLocation(this._program,$S.name),name:$S.name,type:$S.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($f.name=$f.name.substr(0,$f.name.length-3),$f.isArray=!0,$f.location=$h.getUniformLocation(this._program,$f.name)),this._params.push($f);}for($L=0,$n=this._params.length;$L<$n;$L++)if(($f=this._params[$L]).indexOfParams=$L,$f.index=1,$f.value=[$f.location,null],$f.codename=$f.name,$f.name=this._nameMap[$f.codename]?this._nameMap[$f.codename]:$f.codename,(this._paramsMap[$f.name]=$f)._this=this,$f.uploadedValue=[],"attribute"!==$f.vartype)switch($f.type){case 5124:$f.fun=$f.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$f.fun=$f.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$f.fun=$f.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$f.fun=$f.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$f.fun=$f.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$f.fun=this._uniform_sampler2D;break;case 35680:$f.fun=this._uniform_samplerCube;break;case 35676:$f.glfun=$h.uniformMatrix4fv,$f.fun=this._uniformMatrix4fv;break;case 35670:$f.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!");}else $f.fun=this._attribute;}},$h.getUniform=function($J){return this._paramsMap[$J];},$h._attribute=function($J,$h){var $f=$dJ.mainContext,$n=$cJ._enableAtributes,$L=$J.location;return $n[$L]||$f.enableVertexAttribArray($L),$f.vertexAttribPointer($L,$h[0],$h[1],$h[2],$h[3],$h[4]+this._offset),$n[$L]=$cJ._bindVertexBuffer,1;},$h._uniform1f=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h?($dJ.mainContext.uniform1f($J.location,$f[0]=$h),1):0;},$h._uniform1fv=function($J,$h){if($h.length<4){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]||$f[2]!==$h[2]||$f[3]!==$h[3]?($dJ.mainContext.uniform1fv($J.location,$h),$f[0]=$h[0],$f[1]=$h[1],$f[2]=$h[2],$f[3]=$h[3],1):0;}return $dJ.mainContext.uniform1fv($J.location,$h),1;},$h._uniform_vec2=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]?($dJ.mainContext.uniform2f($J.location,$f[0]=$h[0],$f[1]=$h[1]),1):0;},$h._uniform_vec2v=function($J,$h){if($h.length<2){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]||$f[2]!==$h[2]||$f[3]!==$h[3]?($dJ.mainContext.uniform2fv($J.location,$h),$f[0]=$h[0],$f[1]=$h[1],$f[2]=$h[2],$f[3]=$h[3],1):0;}return $dJ.mainContext.uniform2fv($J.location,$h),1;},$h._uniform_vec3=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]||$f[2]!==$h[2]?($dJ.mainContext.uniform3f($J.location,$f[0]=$h[0],$f[1]=$h[1],$f[2]=$h[2]),1):0;},$h._uniform_vec3v=function($J,$h){return $dJ.mainContext.uniform3fv($J.location,$h),1;},$h._uniform_vec4=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]||$f[2]!==$h[2]||$f[3]!==$h[3]?($dJ.mainContext.uniform4f($J.location,$f[0]=$h[0],$f[1]=$h[1],$f[2]=$h[2],$f[3]=$h[3]),1):0;},$h._uniform_vec4v=function($J,$h){return $dJ.mainContext.uniform4fv($J.location,$h),1;},$h._uniformMatrix2fv=function($J,$h){return $dJ.mainContext.uniformMatrix2fv($J.location,!1,$h),1;},$h._uniformMatrix3fv=function($J,$h){return $dJ.mainContext.uniformMatrix3fv($J.location,!1,$h),1;},$h._uniformMatrix4fv=function($J,$h){return $dJ.mainContext.uniformMatrix4fv($J.location,!1,$h),1;},$h._uniform1i=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h?($dJ.mainContext.uniform1i($J.location,$f[0]=$h),1):0;},$h._uniform1iv=function($J,$h){return $dJ.mainContext.uniform1iv($J.location,$h),1;},$h._uniform_ivec2=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]?($dJ.mainContext.uniform2i($J.location,$f[0]=$h[0],$f[1]=$h[1]),1):0;},$h._uniform_ivec2v=function($J,$h){return $dJ.mainContext.uniform2iv($J.location,$h),1;},$h._uniform_vec3i=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]||$f[2]!==$h[2]?($dJ.mainContext.uniform3i($J.location,$f[0]=$h[0],$f[1]=$h[1],$f[2]=$h[2]),1):0;},$h._uniform_vec3vi=function($J,$h){return $dJ.mainContext.uniform3iv($J.location,$h),1;},$h._uniform_vec4i=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]||$f[2]!==$h[2]||$f[3]!==$h[3]?($dJ.mainContext.uniform4i($J.location,$f[0]=$h[0],$f[1]=$h[1],$f[2]=$h[2],$f[3]=$h[3]),1):0;},$h._uniform_vec4vi=function($J,$h){return $dJ.mainContext.uniform4iv($J.location,$h),1;},$h._uniform_sampler2D=function($J,$h){var $f=$dJ.mainContext,$n=$J.uploadedValue;return null==$n[0]?($n[0]=this._curActTexIndex,$f.uniform1i($J.location,this._curActTexIndex),$f.activeTexture($Y._TEXTURES[this._curActTexIndex]),$pJ.bindTexture($f,3553,$h),this._curActTexIndex++,1):($f.activeTexture($Y._TEXTURES[$n[0]]),$pJ.bindTexture($f,3553,$h),0);},$h._uniform_samplerCube=function($J,$h){var $f=$dJ.mainContext,$n=$J.uploadedValue;return null==$n[0]?($n[0]=this._curActTexIndex,$f.uniform1i($J.location,this._curActTexIndex),$f.activeTexture($Y._TEXTURES[this._curActTexIndex]),$pJ.bindTexture($f,34067,$h),this._curActTexIndex++,1):($f.activeTexture($Y._TEXTURES[$n[0]]),$pJ.bindTexture($f,34067,$h),0);},$h._noSetValue=function($J){console.log("no....:"+$J.name);},$h.uploadOne=function($J,$h){this.activeResource(),$pJ.UseProgram(this._program);var $f=this._paramsMap[$J];$f.fun.call(this,$f,$h);},$h.uploadTexture2D=function($J){$O.shaderCall++;var $h=$dJ.mainContext;$h.activeTexture(33984),$pJ.bindTexture($h,3553,$J);},$h.uploadTexture2D1=function($J){$O.shaderCall++;var $h=$dJ.mainContext;$h.activeTexture(33985),$pJ.bindTexture($h,3553,$J);},$h.upload=function($J,$h){$ZJ.activeShader=$ZJ.bindShader=this,this._lastUseFrameCount===$O.loopCount||this.activeResource(),$pJ.UseProgram(this._program),this._reCompile?($h=this._params,this._reCompile=!1):$h=$h||this._params;$dJ.mainContext;for(var $f,$n,$L=$h.length,$T=0,$k=0;$k<$L;$k++)null!==($n=$J[($f=$h[$k]).name])&&($T+=$f.fun.call(this,$f,$n));$O.shaderCall+=$T;},$h.uploadArray=function($J,$h,$f){$ZJ.activeShader=this,($ZJ.bindShader=this).activeResource(),$pJ.UseProgram(this._program);this._params;for(var $n,$L,$T=0,$k=$h-2;0<=$k;$k-=2)($L=this._paramsMap[$J[$k]])&&null!=($n=$J[$k+1])&&($f&&$f[$L.name]&&$f[$L.name].bind(),$T+=$L.fun.call(this,$L,$n));$O.shaderCall+=$T;},$h.getParams=function(){return this._params;},$Y.getShader=function($J){return $Y.sharders[$J];},$Y.create=function($J,$h,$f,$n){return new $Y($J,$h,$f,$n);},$Y.withCompile=function($J,$h,$f,$n){if($f&&$Y.sharders[$f])return $Y.sharders[$f];var $L=$Y._preCompileShader[2e-4*$J];if(!$L)throw new Error("withCompile shader err!"+$J);return $L.createShader($h,$f,$n);},$Y.withCompile2D=function($J,$h,$f,$n,$L){if($n&&$Y.sharders[$n])return $Y.sharders[$n];var $T=$Y._preCompileShader[2e-4*$J+$h];if(!$T)throw new Error("withCompile shader err!"+$J+" "+$h);return $T.createShader($f,$n,$L);},$Y.addInclude=function($J,$h){$sJ.addInclude($J,$h);},$Y.preCompile=function($J,$h,$f,$n){var $L=2e-4*$J;$Y._preCompileShader[$L]=new $sJ($L,$h,$f,$n);},$Y.preCompile2D=function($J,$h,$f,$n,$L){var $T=2e-4*$J+$h;$Y._preCompileShader[$T]=new $sJ($T,$f,$n,$L);},$Y._createShader=function($J,$h,$f){var $n=$J.createShader($f);return $J.shaderSource($n,$h),$J.compileShader($n),$n;},$Y._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],$Y._count=0,$Y._preCompileShader={},$Y.SHADERNAME2ID=2e-4,$Y.sharders=(($Y.sharders=[]).length=32,$Y.sharders),$k($Y,["nameKey",function(){return this.nameKey=new $P();}]),$Y;}(),$wJ=function($J){function $h(){this._maxsize=0,this._upload=!0,this._uploadSize=0,$h.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id;}$R($h,"laya.webgl.utils.Buffer2D",$J);var $f=$h.prototype;return $f.needSize=function($J){var $h=this._byteLength;if($J){var $f=this._byteLength+$J;$f<=this._buffer.byteLength||this._resizeBuffer($f<<1,!0),this._byteLength=$f;}return $h;},$f._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),$O.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$cJ._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$cJ._gl.bufferSubData(this._bufferType,0,this._buffer);},$f._bufferSubData=function($J,$h,$f){if(void 0===$J&&($J=0),void 0===$h&&($h=0),void 0===$f&&($f=0),this._maxsize=Math.max(this._maxsize,this._byteLength),$O.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$cJ._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$h||$f){var $n=this._buffer.slice($h,$f);$cJ._gl.bufferSubData(this._bufferType,$J,$n);}else $cJ._gl.bufferSubData(this._bufferType,$J,this._buffer);},$f._checkArrayUse=function(){},$f._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0);},$f._bind_subUpload=function($J,$h,$f){return void 0===$J&&($J=0),void 0===$h&&($h=0),void 0===$f&&($f=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData($J,$h,$f),!0);},$f._resizeBuffer=function($J,$h){if($J<this._buffer.byteLength)return this;if(this.memorySize=$J,$h&&this._buffer&&0<this._buffer.byteLength){var $f=new ArrayBuffer($J);new Uint8Array($f).set(new Uint8Array(this._buffer),0),this._buffer=$f;}else this._buffer=new ArrayBuffer($J);return this._checkArrayUse(),this._upload=!0,this;},$f.append=function($J){this._upload=!0;var $h,$f;$h=$J.byteLength,$J instanceof Uint8Array?(this._resizeBuffer(this._byteLength+$h,!0),$f=new Uint8Array(this._buffer,this._byteLength)):$J instanceof Uint16Array?(this._resizeBuffer(this._byteLength+$h,!0),$f=new Uint16Array(this._buffer,this._byteLength)):$J instanceof Float32Array&&(this._resizeBuffer(this._byteLength+$h,!0),$f=new Float32Array(this._buffer,this._byteLength)),$f.set($J,0),this._byteLength+=$h,this._checkArrayUse();},$f.appendU16Array=function($J,$h){this._resizeBuffer(this._byteLength+2*$h,!0);for(var $f=new Uint16Array(this._buffer,this._byteLength,$h),$n=0;$n<$h;$n++)$f[$n]=$J[$n];this._byteLength+=2*$h,this._checkArrayUse();},$f.appendEx=function($J,$h){this._upload=!0;var $f;$f=$J.byteLength,this._resizeBuffer(this._byteLength+$f,!0),new $h(this._buffer,this._byteLength).set($J,0),this._byteLength+=$f,this._checkArrayUse();},$f.appendEx2=function($J,$h,$f,$n){void 0===$n&&($n=1),this._upload=!0;var $L,$T;$L=$f*$n,this._resizeBuffer(this._byteLength+$L,!0),$T=new $h(this._buffer,this._byteLength);var $k=0;for($k=0;$k<$f;$k++)$T[$k]=$J[$k];this._byteLength+=$L,this._checkArrayUse();},$f.getBuffer=function(){return this._buffer;},$f.setNeedUpload=function(){this._upload=!0;},$f.getNeedUpload=function(){return this._upload;},$f.upload=function(){var $J=this._bind_upload();return $cJ._gl.bindBuffer(this._bufferType,null),$cJ._bindActive[this._bufferType]=null,$ZJ.activeShader=null,$J;},$f.subUpload=function($J,$h,$f){void 0===$J&&($J=0),void 0===$h&&($h=0),void 0===$f&&($f=0);var $n=this._bind_subUpload();return $cJ._gl.bindBuffer(this._bufferType,null),$cJ._bindActive[this._bufferType]=null,$ZJ.activeShader=null,$n;},$f.disposeResource=function(){$J.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0;},$f.clear=function(){this._byteLength=0,this._upload=!0;},$n(0,$f,"bufferLength",function(){return this._buffer.byteLength;}),$n(0,$f,"byteLength",null,function($J){this._byteLength!==$J&&($J<=this._buffer.byteLength||this._resizeBuffer(2*$J+256,!0),this._byteLength=$J);}),$h.__int__=function($J){$zJ.QuadrangleIB=$zJ.create(35044),$oJ.fillIBQuadrangle($zJ.QuadrangleIB,16);},$h.FLOAT32=4,$h.SHORT=2,$h;}($cJ),$EJ=(function($h){function $f($J){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,$f.__super.call(this,9);}$R($f,"laya.webgl.shader.d2.value.GlowSV",$h);var $J=$f.prototype;$J.setValue=function($J){$h.prototype.setValue.call(this,$J);},$J.clear=function(){$h.prototype.clear.call(this);};}($CJ),function($J){function $h($J){$h.__super.call(this,64),this.defines.add(64);}$R($h,"laya.webgl.shader.d2.value.TextSV",$J);var $f=$h.prototype;return $f.release=function(){($h.pool[$h._length++]=this).clear();},$f.clear=function(){$J.prototype.clear.call(this);},$h.create=function(){return $h._length?$h.pool[--$h._length]:new $h(null);},$h.pool=[],$h._length=0,$h;}($CJ)),$NJ=function($J){function $L($J,$h,$f,$n){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,$L.__super.call(this,$J,$h,$f,$n);}$R($L,"laya.webgl.shader.d2.Shader2X",$J);var $h=$L.prototype;return $h.upload2dQuick1=function($J){this.upload($J,this._params2dQuick1||this._make2dQuick1());},$h._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var $J,$h=this._params,$f=0,$n=$h.length;$f<$n;$f++)$J=$h[$f],($r.isFlash||"size"!==$J.name&&"position"!==$J.name&&"texcoord"!==$J.name)&&this._params2dQuick1.push($J);}return this._params2dQuick1;},$h.disposeResource=function(){$J.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null;},$h.upload2dQuick2=function($J){this.upload($J,this._params2dQuick2||this._make2dQuick2());},$h._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var $J,$h=this._params,$f=0,$n=$h.length;$f<$n;$f++)$J=$h[$f],($r.isFlash||"size"!==$J.name)&&this._params2dQuick2.push($J);}return this._params2dQuick2;},$L.create=function($J,$h,$f,$n){return new $L($J,$h,$f,$n);},$L;}($XJ),$zJ=function($J){function $h($J){this._uint8Array=null,this._uint16Array=null,void 0===$J&&($J=35044),$h.__super.call(this),this._bufferUsage=$J,this._bufferType=34963,$r.isFlash||(this._buffer=new ArrayBuffer(8));}$R($h,"laya.webgl.utils.IndexBuffer2D",$wJ);var $f=$h.prototype;return $f._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer));},$f.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer));},$f.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer));},$f.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null;},$h.QuadrangleIB=null,$h.create=function($J){return void 0===$J&&($J=35044),new $h($J);},$h;}(),$KJ=function($J){function $f($J,$h){this._floatArray32=null,this._vertexStride=0,$f.__super.call(this),this._vertexStride=$J,this._bufferUsage=$h,this._bufferType=34962,$r.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array();}$R($f,"laya.webgl.utils.VertexBuffer2D",$J);var $h=$f.prototype;return $h.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer));},$h.bind=function($J){$J&&$J._bind(),this._bind();},$h.insertData=function($J,$h){this.getFloat32Array().set($J,$h),this._upload=!0;},$h.bind_upload=function($J){$J._bind_upload()||$J._bind(),this._bind_upload()||this._bind();},$h._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer));},$h.disposeResource=function(){$J.prototype.disposeResource.call(this);},$h.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null;},$n(0,$h,"vertexStride",function(){return this._vertexStride;}),$f.create=function($J,$h){return void 0===$h&&($h=35048),new $f($J,$h);},$f;}($wJ),$Jh=function($J){function $u($J,$h,$f,$n,$L,$T){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===$f&&($f=6408),void 0===$n&&($n=!0),$u.__super.call(this,$J,$h),$J){if(this._format=$f,this._mipmap=$n,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof $J)this._url=$J,this._src=$J,this._image=new $l.window.Image(),$h&&($h.onload&&(this.onload=$h.onload),$h.onerror&&(this.onerror=$h.onerror),$h.onCreate&&$h.onCreate(this)),this._image.crossOrigin=$J&&0==$J.indexOf("data:")?null:"",$J&&(this._image.src=$J);else if($J instanceof ArrayBuffer){this._src=$h,this._url=this._src;var $k=new $S($J);$k.readUTFBytes(4),$k.readUTFBytes(2),$k.getInt16();$k.endian="bigEndian",this._w=$k.getInt16(),this._h=$k.getInt16();$k.getInt16(),$k.getInt16();this._image=new Uint8Array($J,$k.pos),this._format=$dJ.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,$V.enabled&&this._w<$V.atlasLimitWidth&&this._h<$V.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1;}else{if(!($J instanceof Uint8Array))return this._src=$h,this._url=this._src,this._image=$J.source||$J,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=$h,this._url=this._src,this._w=$L,this._h=$T,this._image=$J,this._format=0===$f?$J.byteLength/($L*$T)==4?6408:6407:$f;}this._$5__enableMerageInAtlas=!0;}}$R($u,"laya.webgl.resource.WebGLImage",$q);var $h=$u.prototype;return $U.imps($h,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$h._init_=function($J,$h){},$h._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $J=$dJ.mainContext,$h=this._source=$J.createTexture(),$f=$pJ.curBindTexTarget,$n=$pJ.curBindTexValue;$pJ.bindTexture($J,3553,$h);var $L=this.minFifter,$T=this.magFifter,$k=this.repeat?10497:33071,$u=$x.isPOT(this._w,this._h),$S=!1;switch($u?(this.mipmap?-1!==$L||($L=9987):-1!==$L||($L=9729),-1!==$T||($T=9729),$J.texParameteri(3553,10241,$L),$J.texParameteri(3553,10240,$T),$J.texParameteri(3553,10242,$k),$J.texParameteri(3553,10243,$k),this.mipmap&&$J.generateMipmap(3553)):(-1!==$L||($L=9729),-1!==$T||($T=9729),$J.texParameteri(3553,10241,$L),$J.texParameteri(3553,10240,$T),$J.texParameteri(3553,10242,33071),$J.texParameteri(3553,10243,33071)),$J.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&$J.pixelStorei($J.UNPACK_ALIGNMENT,1),$J.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&$J.pixelStorei($J.UNPACK_ALIGNMENT,1),$J.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:$S=!0,$J.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case $dJ.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$S=!0,$J.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format);}$J.pixelStorei(37441,!1),$f&&$n&&$pJ.bindTexture($J,$f,$n),this.uri||(this.uri=this._url),$S?this.memorySize=this._image.length:$u&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1;},$h.recreateResource=function(){var $J=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate();}else{this._recreateLock=!0;var $h=this;this._image=new $l.window.Image(),this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if($h._needReleaseAgain)return $h._needReleaseAgain=!1,$h._image.onload=null,void($h._image=null);$h._allowMerageInAtlas&&$h._enableMerageInAtlas?($J.memorySize=0,$J._recreateLock=!1):$h._createWebGlTexture(),$h.completeCreate();},this._image.src=this._src;}},$h.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&$dJ.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0;},$h.onresize=function(){this._w=this._image.width,this._h=this._image.height,$V.enabled&&this._w<$V.atlasLimitWidth&&this._h<$V.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1;},$h.clearAtlasSource=function(){this._image=null;},$n(0,$h,"format",function(){return this._format;}),$n(0,$h,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas;},function($J){this._$5__enableMerageInAtlas=$J;}),$n(0,$h,"mipmap",function(){return this._mipmap;}),$n(0,$h,"allowMerageInAtlas",function(){return this._allowMerageInAtlas;}),$n(0,$h,"atlasSource",function(){return this._image;}),$n(0,$h,"onload",null,function($J){var $h=this;this._onload=$J,this._image&&(this._image.onload=null!=this._onload?function(){$h.onresize(),$h._onload();}:null);}),$n(0,$h,"onerror",null,function($J){var $h=this;this._onerror=$J,this._image&&(this._image.onerror=null!=this._onerror?function(){$h._onerror();}:null);}),$u;}();$U.__init([$lJ,$B,$QJ,$sJ]);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($J,$h){"use strict";for(var $f in Object.defineProperty($h,"__esModule",{value:!0}),Laya){var $n=Laya[$f];$n&&$n.__isclass&&($h[$f]=$n);}}),function($T,$J,$n){$n.un,$n.uns;var $L=$n.static,$k=$n.class,$u=$n.getset,$S=($n.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),$i=laya.utils.ClassUtils,$j=(laya.events.Event,laya.utils.HTMLChar),$Y=laya.net.Loader,$x=(laya.display.Node,laya.maths.Rectangle),$R=laya.renders.Render,$l=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),$q=laya.utils.Stat,$Z=laya.display.Text,$o=laya.resource.Texture,$r=laya.net.URL,$_=laya.utils.Utils,$s=function(){function $l(){}return $k($l,"laya.html.utils.HTMLParse"),$l.parse=function($J,$h,$f){$h=($h="<root>"+($h=$h.replace(/<br>/g,"<br/>"))+"</root>").replace($l.spacePattern,$l.char255);var $n=$_.parseXMLFromString($h);$l._parseXML($J,$n.childNodes[0].childNodes,$f);},$l._parseXML=function($J,$h,$f,$n){var $L=0,$T=0;if($h.join||$h.item)for($L=0,$T=$h.length;$L<$T;++$L)$l._parseXML($J,$h[$L],$f,$n);else{var $k,$u,$S;if(3==$h.nodeType)return void($J instanceof laya.html.dom.HTMLDivElement?(null==$h.nodeName&&($h.nodeName="#text"),$u=$h.nodeName.toLowerCase(),0<($S=$h.textContent.replace(/^\s+|\s+$/g,"")).length&&($k=$i.getInstance($u))&&($J.addChild($k),$k.innerTEXT=$S.replace($l.char255AndOneSpacePattern," "))):0<($S=$h.textContent.replace(/^\s+|\s+$/g,"")).length&&($J.innerTEXT=$S.replace($l.char255AndOneSpacePattern," ")));if("#comment"==($u=$h.nodeName.toLowerCase()))return;if($k=$i.getInstance($u)){($k=$J.addChild($k)).URI=$f,$k.href=$n;var $Y=$h.attributes;if($Y&&0<$Y.length)for($L=0,$T=$Y.length;$L<$T;++$L){var $x=$Y[$L],$j=$x.nodeName,$R=$x.value;$k._setAttributes($j,$R);}$l._parseXML($k,$h.childNodes,$f,$k.href);}else $l._parseXML($J,$h.childNodes,$f,$n);}},$l.char255=String.fromCharCode(255),$l.spacePattern=/&nbsp;|&#160;/g,$l.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),$l;}(),$d=function(){function $m(){}return $k($m,"laya.html.utils.Layout"),$m.later=function($J){null==$m._will&&($m._will=[],$n.stage.frameLoop(1,null,function(){if(!($m._will.length<1)){for(var $J=0;$J<$m._will.length;$J++)laya.html.utils.Layout.layout($m._will[$J]);$m._will.length=0;}})),$m._will.push($J);},$m.layout=function($J){if(!$J||!$J._style)return null;if(0==(512&$J._style._type))return null;$J.getStyle()._type&=-513;var $h=$m._multiLineLayout($J);return $R.isConchApp&&$J.layaoutCallNative&&$J.layaoutCallNative(),$h;},$m._multiLineLayout=function($J){if($Z.RightToLeft)return $m._multiLineLayout2($J);var $h=[];$J._addChildsToLayout($h);var $f,$n,$L,$T,$k,$u=0,$S=$h.length,$Y=$J._getCSSStyle(),$x=$Y.letterSpacing,$j=$Y.leading,$R=$Y.lineHeight,$l=$Y._widthAuto()||!$Y.wordWrap,$i=$l?999999:$J.width,$q=($J.height,0),$o=$Y.italic?$Y.fontSize/3:0,$r=$Y._getAlign(),$_=$Y._getValign(),$s=0!==$_||0!==$r||0!=$R,$d=0,$p=0,$U=0,$Q=0,$D=[],$g=$D[0]=new $t(),$F=!1,$A=!1;$g.h=0,$Y.italic&&($i-=$Y.fontSize/3);var $G=0,$y=!0;function $O(){$g.y=$p,$p+=$g.h+$j,0==$g.h&&($p+=$R),$g.mWidth=$G,$G=0,$g=new $t(),$D.push($g),$g.h=0,$F=!($y=!($d=0));}for($u=0;$u<$S;$u++)if(null!=($f=$h[$u])){if($y=!1,$f instanceof laya.html.dom.HTMLBrElement)$O(),$g.y=$p;else{if($f._isChar()){if(($T=$f).isWord)$F=$A||"\n"===$T.char,$g.wordStartIndex=$g.elements.length;else{if($U=$T.width+$T.style.letterSpacin,0<$D.length&&$i<$d+$U&&0<$g.wordStartIndex){var $P;$P=$g.elements.length-$g.wordStartIndex+1,$g.elements.length=$g.wordStartIndex,$u-=$P,$O();continue;}$F=!1,$G+=$T.width;}$U=$T.width+$x,$Q=$T.height,$A=!1,($F=$F||$i<$d+$U)&&$O(),$g.minTextHeight=Math.min($g.minTextHeight,$f.height);}else $n=$f._getCSSStyle(),$k=$f,$L=$n.padding,0===$n._getCssFloat()||($s=!0),$F=$A||$n.lineElement,$U=$k.width*$k._style._tf.scaleX+$L[1]+$L[3]+$x,$Q=$k.height*$k._style._tf.scaleY+$L[0]+$L[2],$A=$n.lineElement,($F=$F||$i<$d+$U&&$n.wordWrap)&&$O();$g.elements.push($f),$g.h=Math.max($g.h,$Q),$f.x=$d,$f.y=$p,$d+=$U,$g.w=$d-$x,$g.y=$p,$q=Math.max($d+$o,$q);}}else $y||($d+=$m.DIV_ELEMENT_PADDING),$g.wordStartIndex=$g.elements.length;if($p=$g.y+$g.h,$s){var $W=0,$I=$i;for($l&&0<$J.width&&($I=$J.width),$u=0,$S=$D.length;$u<$S;$u++)$D[$u].updatePos(0,$I,$u,$W,$r,$_,$R),$W+=Math.max($R,$D[$u].h+$j);$p=$W;}return $l&&($J.width=$q),$p>$J.height&&($J.height=$p),[$q,$p];},$m._multiLineLayout2=function($J){var $h=[];$J._addChildsToLayout($h);var $f,$n,$L,$T,$k,$u=0,$S=$h.length,$Y=$J._getCSSStyle(),$x=$Y.letterSpacing,$j=$Y.leading,$R=$Y.lineHeight,$l=$Y._widthAuto()||!$Y.wordWrap,$i=$l?999999:$J.width,$q=($J.height,0),$o=$Y.italic?$Y.fontSize/3:0,$r=2-$Y._getAlign(),$_=$Y._getValign(),$s=0!==$_||0!=$r||0!=$R,$d=0,$p=0,$U=0,$Q=0,$D=[],$g=$D[0]=new $t(),$F=!1,$A=!1;$g.h=0,$Y.italic&&($i-=$Y.fontSize/3);var $G=0,$y=!0;function $O(){$g.y=$p,$p+=$g.h+$j,0==$g.h&&($p+=$R),$g.mWidth=$G,$G=0,$g=new $t(),$D.push($g),$g.h=0,$F=!($y=!($d=0));}for($u=0;$u<$S;$u++)if(null!=($f=$h[$u])){if($y=!1,$f instanceof laya.html.dom.HTMLBrElement)$O(),$g.y=$p;else{if($f._isChar()){if(($T=$f).isWord)$F=$A||"\n"===$T.char,$g.wordStartIndex=$g.elements.length;else{if(0<$D.length&&$i<$d+$U&&0<$g.wordStartIndex){var $P;$P=$g.elements.length-$g.wordStartIndex+1,$g.elements.length=$g.wordStartIndex,$u-=$P,$O();continue;}$F=!1,$G+=$T.width;}$U=$T.width+$x,$Q=$T.height,$A=!1,($F=$F||$i<$d+$U)&&$O(),$g.minTextHeight=Math.min($g.minTextHeight,$f.height);}else $n=$f._getCSSStyle(),$k=$f,$L=$n.padding,0===$n._getCssFloat()||($s=!0),$F=$A||$n.lineElement,$U=$k.width*$k._style._tf.scaleX+$L[1]+$L[3]+$x,$Q=$k.height*$k._style._tf.scaleY+$L[0]+$L[2],$A=$n.lineElement,($F=$F||$i<$d+$U&&$n.wordWrap)&&$O();$g.elements.push($f),$g.h=Math.max($g.h,$Q),$f.x=$d,$f.y=$p,$d+=$U,$g.w=$d-$x,$g.y=$p,$q=Math.max($d+$o,$q);}}else $y||($d+=$m.DIV_ELEMENT_PADDING),$g.wordStartIndex=$g.elements.length;if($p=$g.y+$g.h,$s){var $W=0,$I=$i;for($u=0,$S=$D.length;$u<$S;$u++)$D[$u].updatePos(0,$I,$u,$W,$r,$_,$R),$W+=Math.max($R,$D[$u].h+$j);$p=$W;}for($l&&($J.width=$q),$p>$J.height&&($J.height=$p),$u=0,$S=$D.length;$u<$S;$u++)$D[$u].revertOrder($i);return[$q,$p];},$m._will=null,$m.DIV_ELEMENT_PADDING=0,$m;}(),$t=function(){function $J(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=[];}$k($J,"laya.html.utils.LayoutLine");var $h=$J.prototype;return $h.updatePos=function($J,$h,$f,$n,$L,$T,$k){var $u,$S=0;0<this.elements.length&&($S=($u=this.elements[this.elements.length-1]).x+$u.width-this.elements[0].x);var $Y=0,$x=NaN;1===$L&&($Y=($h-$S)/2),2===$L&&($Y=$h-$S),0===$k||0!=$T||($T=1);for(var $j=0,$R=this.elements.length;$j<$R;$j++){var $l=($u=this.elements[$j])._getCSSStyle();switch(0!==$Y&&($u.x+=$Y),$l._getValign()){case 0:$u.y=$n;break;case 1:var $i=0;99999!=this.minTextHeight&&($i=this.minTextHeight);var $q=($i+$k)/2;$q=Math.max($q,this.h),$x=(laya.html.dom.HTMLImageElement,$n+$q-$u.height),$u.y=$x;break;case 2:$u.y=$n+($k-$u.height);}}},$h.revertOrder=function($J){var $h;if(0<this.elements.length){var $f,$n=0;for($f=this.elements.length,$n=0;$n<$f;$n++)($h=this.elements[$n]).x=$J-$h.x-$h.width;}},$J;}(),$p=function($f){function $h(){this.URI=null,this._href=null,$h.__super.call(this),this._text=$h._EMPTYTEXT,this.setStyle(new $S(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0;}$k($h,"laya.html.dom.HTMLElement",$f);var $J=$h.prototype;return $J.layaoutCallNative=function(){var $J=0;if(this._childs&&0<($J=this._childs.length))for(var $h=0;$h<$J;$h++)this._childs[$h].layaoutCallNative&&this._childs[$h].layaoutCallNative();var $f=this._getWords();$f?laya.html.dom.HTMLElement.fillWords(this,$f,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear();},$J.appendChild=function($J){return this.addChild($J);},$J._getWords2=function(){var $J=this._text.text;if(!$J||0===$J.length)return null;var $h,$f,$n=0,$L=0;if(this._text.drawWords)$f=this._text.drawWords;else{for($L=($h=$J.split(" ")).length-1,$f=[],$n=0;$n<$L;$n++)$f.push($h[$n]," ");0<=$L&&$f.push($h[$L]),this._text.drawWords=$f;}var $T,$k=this._text.words;if($k&&$k.length===$f.length)return $k;null===$k&&(this._text.words=$k=[]),$k.length=$f.length;var $u=this.style,$S=$u.font;for($n=0,$L=$f.length;$n<$L;$n++){$T=$_.measureText($f[$n],$S);var $Y=$k[$n]=new $j($f[$n],$T.width,$T.height||$u.fontSize,$u);if(1<$Y.char.length&&($Y.charNum=$Y.char),this.href){var $x=new $l();this.addChild($x),$Y.setSprite($x);}}return $k;},$J._getWords=function(){if(!$Z.CharacterCache)return this._getWords2();var $J=this._text.text;if(!$J||0===$J.length)return null;var $h,$f=this._text.words;if($f&&$f.length===$J.length)return $f;null===$f&&(this._text.words=$f=[]),$f.length=$J.length;for(var $n=this.style,$L=$n.font,$T=0,$k=$J.length;$T<$k;$T++)if($h=$_.measureText($J.charAt($T),$L)){var $u=$f[$T]=new $j($J.charAt($T),$h.width,$h.height||$n.fontSize,$n);if(this.href){var $S=new $l();this.addChild($S),$u.setSprite($S);}}else console.warn("_getWords size is null"+$J.charAt($T),$L);return $f;},$J.showLinkSprite=function(){var $J=this._text.words;if($J)for(var $h,$f,$n=[],$L=0;$L<$J.length;$L++)$f=$J[$L],($h=new $l()).graphics.drawRect(0,0,$f.width,$f.height,"#ff0000"),$h.width=$f.width,$h.height=$f.height,this.addChild($h),$n.push($h);},$J._layoutLater=function(){var $J=this.style;512&$J._type||($J.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&$J.block?($d.later(this),$J._type|=512):this.parent&&this.parent._layoutLater());},$J._setAttributes=function($J,$h){switch($J){case"style":return void this.style.cssText($h);case"class":return void(this.className=$h);}$f.prototype._setAttributes.call(this,$J,$h);},$J.updateHref=function(){if(null!=this._href){var $J=this._getWords();if($J)for(var $h,$f,$n=0;$n<$J.length;$n++)($f=($h=$J[$n]).getSprite())&&($f.size($h.width,$h.height),$f.on("click",this,this.onLinkHandler));}},$J.onLinkHandler=function($J){switch($J.type){case"click":for(var $h=this;$h;)$h.event("link",[this.href]),$h=$h.parent;}},$J.formatURL=function($J){return this.URI?$r.formatURL($J,this.URI?this.URI.path:null):$J;},$u(0,$J,"href",function(){return this._href;},function($J){null!=(this._href=$J)&&(this._getCSSStyle().underLine=1,this.updateHref());}),$u(0,$J,"color",null,function($J){this.style.color=$J;}),$u(0,$J,"onClick",null,function($J){$n._runScript("fn=function(event){"+$J+";}"),this.on("click",this,void 0);}),$u(0,$J,"id",null,function($J){$U.document.setElementById($J,this);}),$u(0,$J,"innerTEXT",function(){return this._text.text;},function($J){this.text=$J;}),$u(0,$J,"style",function(){return this._style;}),$u(0,$J,"text",function(){return this._text.text;},function($J){this._text==$h._EMPTYTEXT?this._text={text:$J,words:null}:(this._text.text=$J,this._text.words&&(this._text.words.length=0)),$R.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref();}),$u(0,$J,"parent",$f.prototype._$get_parent,function($J){if($J instanceof laya.html.dom.HTMLElement){var $h=$J;this.URI||(this.URI=$h.URI),this.style.inherit($h.style);}$n.superSet($l,this,"parent",$J);}),$u(0,$J,"className",null,function($J){this.style.attrs($U.document.styleSheets["."+$J]);}),$h.fillWords=function($J,$h,$f,$n,$L,$T,$k){$J.graphics.clear();for(var $u=0,$S=$h.length;$u<$S;$u++){var $Y=$h[$u];$J.graphics.fillText($Y.char,$Y.x+$f,$Y.y+$n,$L,$T,"left",$k);}},$h._EMPTYTEXT={text:null,words:null},$h;}($l),$h=(function($J){function $h(){$h.__super.call(this),this.style.lineElement=!0,this.style.block=!0;}$k($h,"laya.html.dom.HTMLBrElement",$p);}(),function($J){function $h(){this.contextHeight=NaN,this.contextWidth=NaN,$h.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200;}$k($h,"laya.html.dom.HTMLDivElement",$J);var $f=$h.prototype;return $f.appendHTML=function($J){$s.parse(this,$J,this.URI),this.layout();},$f._addChildsToLayout=function($h){var $J=this._getWords();if(null==$J&&0==this._childs.length)return!1;$J&&$J.forEach(function($J){$h.push($J);});for(var $f=!0,$n=0,$L=this._childs.length;$n<$L;$n++){var $T=this._childs[$n];$f?$f=!1:$h.push(null),$T._addToLayout($h);}return!0;},$f._addToLayout=function($J){this.layout();},$f.layout=function(){if(this.style){this.style._type|=512;var $J=$d.layout(this);if($J){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new $x());var $h=this._$P.mHtmlBounds;$h.x=$h.y=0,$h.width=this.contextWidth=$J[0],$h.height=this.contextHeight=$J[1],this.setBounds($h);}}},$u(0,$f,"height",function(){return this._height?this._height:this.contextHeight;},$J.prototype._$set_height),$u(0,$f,"innerHTML",null,function($J){this.destroyChildren(),this.appendHTML($J);}),$u(0,$f,"width",function(){return this._width?this._width:this.contextWidth;},function($J){var $h=!1;$h=0===$J?$J!=this._width:$J!=this.width,$n.superSet($p,this,"width",$J),$h&&this.layout();}),$h;}($p)),$U=function($J){function $h(){this.all=[],this.styleSheets=$S.styleSheets,$h.__super.call(this);}$k($h,"laya.html.dom.HTMLDocument",$p);var $f=$h.prototype;return $f.getElementById=function($J){return this.all[$J];},$f.setElementById=function($J,$h){this.all[$J]=$h;},$L($h,["document",function(){return this.document=new $h();}]),$h;}();(function($J){function $h(){this._tex=null,this._url=null,this._renderArgs=[],$h.__super.call(this),this.style.block=!0;}$k($h,"laya.html.dom.HTMLImageElement",$p);var $f=$h.prototype;$f._addToLayout=function($J){!this._style.absolute&&$J.push(this);},$f.render=function($J,$h,$f){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||($q.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,$J.ctx.drawTexture2($h,$f,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs));},$f.layaoutCallNative=function(){var $J=0;if(this._childs&&0<($J=this._childs.length))for(var $h=0;$h<$J;$h++)this._childs[$h].layaoutCallNative&&this._childs[$h].layaoutCallNative();},$u(0,$f,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width;},function($J){this._width!==$J&&(this._width=$J,this._style.width=$J,this.repaint());}),$u(0,$f,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height;},function($J){this._height!==$J&&(this._height=$J,this._style.height=$J,this.repaint());}),$f.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),$Y.clearCache(this,this._url),this._tex=null),$p.prototype.destroy.call(this);},$f.onloaded=function(){var $J=this._style;$J&&!$J.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),$J&&!$J.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),$R.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint();},$f._loadImageComplete=function($J,$h,$f){if(!this._destroyed)if(null!=$f){if($f instanceof ArrayBuffer){var $n=new DataView($f);new laya.webgl.resource.WebGLImage(new Uint8Array($f,8),$J,0,!1,$n.getUint32(0),$n.getUint32(4));this.onloaded();}else if($f instanceof $o)$Y.imgMgrSet[$J]=$h,$T.imgMgrLock($J,$Y.imgMgrSet[$J]),this._url=$J,this._tex=$f,$Y.keepCache(this,$J),$Y.cacheRes($J,this._tex),this.onloaded();else{var $L=-1!=$J.indexOf(".png",$J.length-4)?6408:6407;new laya.webgl.resource.WebGLImage($f,$J,$L,!1,$f.width,$f.height);this.onloaded();}}else this.event("error","Load image failed");},$u(0,$f,"src",null,function($J){($J=this.formatURL($J),this._url!=$J)&&(null!=this._tex&&($Y.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=$J,(this._tex=$Y.getRes($J))?($Y.keepCache(this,$J),this.onloaded()):$T.imgMgrLoad($J,this._loadImageComplete.bind(this),2,!1));});})(),function($J){function $h(){this.type=null,$h.__super.call(this),this.visible=!1;}$k($h,"laya.html.dom.HTMLLinkElement",$J);var $f=$h.prototype;$f._onload=function($J){switch(this.type){case"text/css":$S.parseCSS($J,this.URI);}},$u(0,$f,"href",$J.prototype._$get_href,function($J){var $h=this;$J=this.formatURL($J),this.URI=new $r($J);var $f=new $Y();$f.once("complete",null,function($J){$h._onload($J);}),$f.load($J,"text");}),$h._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g");}($p),function($J){function $h(){$h.__super.call(this),this.visible=!1;}$k($h,"laya.html.dom.HTMLStyleElement",$J),$u(0,$h.prototype,"text",$J.prototype._$get_text,function($J){$S.parseCSS($J,null);});}($p),function($J){function $h(){$h.__super.call(this),this._getCSSStyle().valign="middle";}$k($h,"laya.html.dom.HTMLIframeElement",$J),$u(0,$h.prototype,"href",$J.prototype._$get_href,function($f){var $n=this;$f=this.formatURL($f);var $J=new $Y();$J.once("complete",null,function($J){var $h=$n.URI;$n.URI=new $r($f),$n.innerHTML=$J,!$h||($n.URI=$h);}),$J.load($f,"text");});}($h);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($J,$h){"use strict";for(var $f in Object.defineProperty($h,"__esModule",{value:!0}),Laya){var $n=Laya[$f];$n&&$n.__isclass&&($h[$f]=$n);}}),function($L,$J,$q){$q.un,$q.uns;var $n=$q.static,$T=$q.class,$k=$q.getset,$f=($q.__newvec,laya.display.Animation),$o=(laya.utils.Browser,laya.utils.ClassUtils),$u=laya.filters.ColorFilter,$S=laya.utils.Ease,$Y=laya.events.Event,$x=(laya.events.EventDispatcher,laya.display.css.Font),$j=laya.display.FrameAnimation,$h=laya.display.Graphics,$R=laya.utils.Handler,$l=laya.display.Input,$_=laya.net.Loader,$i=(laya.display.Node,laya.maths.Point),$r=laya.maths.Rectangle,$s=laya.renders.Render,$d=laya.display.Sprite,$p=laya.display.Text,$U=laya.resource.Texture,$Q=laya.utils.Tween,$D=laya.utils.Utils,$g=laya.utils.WeakObject;$q.interface("laya.ui.IItem"),$q.interface("laya.ui.ISelect"),$q.interface("laya.ui.IRender"),$q.interface("laya.ui.IComponent"),$q.interface("laya.ui.IBox","IComponent");var $F=function(){function $J(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN;}return $T($J,"laya.ui.LayoutStyle"),$n($J,["EMPTY",function(){return this.EMPTY=new $J();}]),$J;}(),$A=function(){function $J(){}return $T($J,"laya.ui.Styles"),$J.labelColor="#000000",$J.buttonStateNum=3,$J.scrollBarMinNum=15,$J.scrollBarDelayTime=500,$n($J,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0];},"labelPadding",function(){return this.labelPadding=[2,2,2,2];},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3];},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"];},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"];}]),$J;}(),$G=function(){function $L(){}return $T($L,"laya.ui.UIUtils"),$L.fillArray=function($J,$h,$f){var $n=$J.concat();if($h)for(var $L=$h.split(","),$T=0,$k=Math.min($n.length,$L.length);$T<$k;$T++){var $u=$L[$T];$n[$T]="true"==$u||"false"!=$u&&$u,null!=$f&&($n[$T]=$f($u));}return $n;},$L.toColor=function($J){return $D.toHexColor($J);},$L.gray=function($J,$h){void 0===$h&&($h=!0),$h?$L.addFilter($J,$L.grayFilter):$L.clearFilter($J,$u);},$L.addFilter=function($J,$h){var $f=$J.filters||[];$f.push($h),$J.filters=$f;},$L.clearFilter=function($J,$h){var $f=$J.filters;if(null!=$f&&0<$f.length){for(var $n=$f.length-1;-1<$n;$n--){var $L=$f[$n];$q.__typeof($L,$h)&&$f.splice($n,1);}$J.filters=$f;}},$L._getReplaceStr=function($J){return $L.escapeSequence[$J];},$L.adptString=function($J){return $J.replace(/\\(\w)/g,$L._getReplaceStr);},$L.getBindFun=function($J){var $h=$L._funMap.get($J);if(null==$h){var $f='"'+$J+'"',$n="(function(data){if(data==null)return;with(data){try{\nreturn "+($f=$f.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";$h=$q._runScript($n),$L._funMap.set($J,$h);}return $h;},$n($L,["grayFilter",function(){return this.grayFilter=new $u([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0]);},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"};},"_funMap",function(){return this._funMap=new $g();}]),$L;}(),$y=function(){function $J(){}return $T($J,"UIConfig"),$J.touchScrollEnable=!0,$J.mouseWheelEnable=!0,$J.showButtons=!0,$J.popupBgColor="#000000",$J.popupBgAlpha=.5,$J.closeDialogOnSide=!0,$J;}(),$O=function($f){function $r(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,$r.__super.call(this),this._weakKeys=[];}$T($r,"laya.ui.AutoBitmap",$f);var $J=$r.prototype;return $J.destroy=function(){if($_.clearObject(this,this._weakKey),this._weakKeys){for(var $J=0,$h=this._weakKeys.length;$J<$h;++$J)$_.clearObject(this,this._weakKeys[$J]);this._weakKeys=null;}$f.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null;},$J._setChanged=function(){this._isChanged||(this._isChanged=!0,$q.timer.callLater(this,this.changeSource));},$J.changeSource=function(){this._isChanged=!1;var $J=this._source;if($J&&$J.bitmap){var $h=this.width,$f=this.height,$n=this._sizeGrid,$L=$J.sourceWidth,$T=$J.sourceHeight;if(!$n||$L===$h&&$T===$f)this.cleanByTexture($J,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,$h,$f);else{$_.clearObject(this,this._weakKey),$J.$_GID||($J.$_GID=$D.getGID());var $k=$J.$_GID+"."+$h+"."+$f+"."+$n.join("."),$u=$_.findObject($k);if($D.isOKCmdList($u))return this._weakKey=$k,$_.keepObject(this,this._weakKey),void(this.cmds=$u);this.clear();var $S,$Y,$x=$n[0],$j=$n[1],$R=$n[2],$l=$n[3],$i=$n[4],$q=!1;if($h==$L&&($l=$j=0),$f==$T&&($x=$R=0),$h<$l+$j){var $o=$h;$q=!0,$h=$l+$j,this.save(),this.clipRect(0,0,$o,$f);}$l&&$x&&($S=$r.getTexture($J,0,0,$l,$x),$Y=this._weakKeys[0],$S?($Y!=$S.weakKey&&($_.clearObject(this,$Y),$_.keepObject(this,$S.weakKey),this._weakKeys[0]=$S.weakKey),this.drawTexture($S,0,0,$l,$x)):($_.clearObject(this,$Y),this._weakKeys[0]="")),$j&&$x&&($S=$r.getTexture($J,$L-$j,0,$j,$x),$Y=this._weakKeys[1],$S?($Y!=$S.weakKey&&($_.clearObject(this,$Y),$_.keepObject(this,$S.weakKey),this._weakKeys[1]=$S.weakKey),this.drawTexture($S,$h-$j,0,$j,$x)):($_.clearObject(this,$Y),this._weakKeys[1]="")),$l&&$R&&($S=$r.getTexture($J,0,$T-$R,$l,$R),$Y=this._weakKeys[2],$S?($Y!=$S.weakKey&&($_.clearObject(this,$Y),$_.keepObject(this,$S.weakKey),this._weakKeys[2]=$S.weakKey),this.drawTexture($S,0,$f-$R,$l,$R)):($_.clearObject(this,$Y),this._weakKeys[2]="")),$j&&$R&&($S=$r.getTexture($J,$L-$j,$T-$R,$j,$R),$Y=this._weakKeys[3],$S?($Y!=$S.weakKey&&($_.clearObject(this,$Y),$_.keepObject(this,$S.weakKey),this._weakKeys[3]=$S.weakKey),this.drawTexture($S,$h-$j,$f-$R,$j,$R)):($_.clearObject(this,$Y),this._weakKeys[3]="")),$x&&($S=$r.getTexture($J,$l,0,$L-$l-$j,$x),$Y=this._weakKeys[4],$S?($Y!=$S.weakKey&&($_.clearObject(this,$Y),$_.keepObject(this,$S.weakKey),this._weakKeys[4]=$S.weakKey),this.drawBitmap($i,$S,$l,0,$h-$l-$j,$x)):($_.clearObject(this,$Y),this._weakKeys[4]="")),$R&&($S=$r.getTexture($J,$l,$T-$R,$L-$l-$j,$R),$Y=this._weakKeys[5],$S?($Y!=$S.weakKey&&($_.clearObject(this,$Y),$_.keepObject(this,$S.weakKey),this._weakKeys[5]=$S.weakKey),this.drawBitmap($i,$S,$l,$f-$R,$h-$l-$j,$R)):($_.clearObject(this,$Y),this._weakKeys[5]="")),$l&&($S=$r.getTexture($J,0,$x,$l,$T-$x-$R),$Y=this._weakKeys[6],$S?($Y!=$S.weakKey&&($_.clearObject(this,$Y),$_.keepObject(this,$S.weakKey),this._weakKeys[6]=$S.weakKey),this.drawBitmap($i,$S,0,$x,$l,$f-$x-$R)):($_.clearObject(this,$Y),this._weakKeys[6]="")),$j&&($S=$r.getTexture($J,$L-$j,$x,$j,$T-$x-$R),$Y=this._weakKeys[7],$S?($Y!=$S.weakKey&&($_.clearObject(this,$Y),$_.keepObject(this,$S.weakKey),this._weakKeys[7]=$S.weakKey),this.drawBitmap($i,$S,$h-$j,$x,$j,$f-$x-$R)):($_.clearObject(this,$Y),this._weakKeys[7]="")),$S=$r.getTexture($J,$l,$x,$L-$l-$j,$T-$x-$R),$Y=this._weakKeys[8],$S?($Y!=$S.weakKey&&($_.clearObject(this,$Y),$_.keepObject(this,$S.weakKey),this._weakKeys[8]=$S.weakKey),this.drawBitmap($i,$S,$l,$x,$h-$l-$j,$f-$x-$R)):($_.clearObject(this,$Y),this._weakKeys[8]=""),$q&&this.restore(),this.autoCacheCmd&&!$s.isConchApp&&($_.saveObject($k,this.cmds,null),this._weakKey=$k,$_.keepObject(this,this._weakKey));}this._repaint();}},$J.drawBitmap=function($J,$h,$f,$n,$L,$T){void 0===$L&&($L=0),void 0===$T&&($T=0),$L<.1||$T<.1||(!$J||$h.width==$L&&$h.height==$T?this.drawTexture($h,$f,$n,$L,$T):this.fillTexture($h,$f,$n,$L,$T));},$J.clear=function($J){void 0===$J&&($J=!0),$f.prototype.clear.call(this,!1);},$k(0,$J,"sizeGrid",function(){return this._sizeGrid;},function($J){this._sizeGrid=$J,this._setChanged();}),$k(0,$J,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0;},function($J){this._width!=$J&&(this._width=$J,this._setChanged());}),$k(0,$J,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0;},function($J){this._height!=$J&&(this._height=$J,this._setChanged());}),$k(0,$J,"source",function(){return this._source;},function($J){$J?(this._source=$J,this._setChanged()):(this._source=null,this.clear());}),$r.getTexture=function($J,$h,$f,$n,$L){$n<=0&&($n=1),$L<=0&&($L=1),$J.$_GID||($J.$_GID=$D.getGID());var $T=$J.$_GID+"."+$h+"."+$f+"."+$n+"."+$L,$k=$_.findObject($T);if((!$k||!$k.source)&&($k=$U.createFromTexture($J,$h,$f,$n,$L))){if($J.alphaTexture){var $u=$J.width/$J.alphaTexture.width;$k.alphaTexture=$U.createFromTexture($J.alphaTexture,$h/$u,$f/$u,$n/$u,$L/$u);}$_.saveObject($T,$k),$k.weakKey=$T;}return $k;},$r;}($h),$P=(function($J){function $h(){$h.__super.call(this);}$T($h,"laya.ui.UIEvent",$Y),$h.SHOW_TIP="showtip",$h.HIDE_TIP="hidetip";}(),function($h){function $J(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,$J.__super.call(this),this._layout=$F.EMPTY,this.preinitialize(),this.createChildren(),this.initialize();}$T($J,"laya.ui.Component",$h);var $f=$J.prototype;return $q.imps($f,{"laya.ui.IComponent":!0}),$f.destroy=function($J){void 0===$J&&($J=!0),$h.prototype.destroy.call(this,$J),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null;},$f.preinitialize=function(){},$f.createChildren=function(){},$f.initialize=function(){},$f.callLater=function($J,$h){$q.timer.callLater(this,$J,$h);},$f.runCallLater=function($J){$q.timer.runCallLater(this,$J);},$f.commitMeasure=function(){},$f.changeSize=function(){this.event("resize");},$f.getLayout=function(){return this._layout===$F.EMPTY&&(this._layout=new $F()),this._layout;},$f._setLayoutEnabled=function($J){this._layout&&this._layout.enable!=$J&&(this._layout.enable=$J,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded());},$f.onRemoved=function(){this.parent.off("resize",this,this.onCompResize);},$f.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY();},$f.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY());},$f.resetLayoutX=function(){var $J=this._layout;if(isNaN($J.anchorX)||(this.pivotX=$J.anchorX*this.width),this.layoutEnabled){var $h=this.parent;$h&&(isNaN($J.centerX)?isNaN($J.left)?isNaN($J.right)||(this.x=Math.round($h.width-this.displayWidth-$J.right+this.pivotX*this.scaleX)):(this.x=Math.round($J.left+this.pivotX*this.scaleX),isNaN($J.right)||(this.width=($h._width-$J.left-$J.right)/(this.scaleX||.01))):this.x=Math.round(.5*($h.width-this.displayWidth)+$J.centerX+this.pivotX*this.scaleX));}},$f.resetLayoutY=function(){var $J=this._layout;if(isNaN($J.anchorY)||(this.pivotY=$J.anchorY*this.height),this.layoutEnabled){var $h=this.parent;$h&&(isNaN($J.centerY)?isNaN($J.top)?isNaN($J.bottom)||(this.y=Math.round($h.height-this.displayHeight-$J.bottom+this.pivotY*this.scaleY)):(this.y=Math.round($J.top+this.pivotY*this.scaleY),isNaN($J.bottom)||(this.height=($h._height-$J.top-$J.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*($h.height-this.displayHeight)+$J.centerY+this.pivotY*this.scaleY));}},$f.onMouseOver=function($J){$q.stage.event("showtip",this._toolTip);},$f.onMouseOut=function($J){$q.stage.event("hidetip",this._toolTip);},$k(0,$f,"displayWidth",function(){return this.width*this.scaleX;}),$k(0,$f,"width",function(){return this._width?this._width:this.measureWidth;},function($J){this._width!=$J&&(this._width=$J,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX());}),$k(0,$f,"measureWidth",function(){var $J=0;this.commitMeasure();for(var $h=this.numChildren-1;-1<$h;$h--){var $f=this.getChildAt($h);$f.visible&&($J=Math.max($f.x+$f.width*$f.scaleX,$J));}return $J;}),$k(0,$f,"displayHeight",function(){return this.height*this.scaleY;}),$k(0,$f,"height",function(){return this._height?this._height:this.measureHeight;},function($J){this._height!=$J&&(this._height=$J,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY());}),$k(0,$f,"dataSource",function(){return this._dataSource;},function($J){for(var $h in this._dataSource=$J,this._dataSource)this.hasOwnProperty($h)&&"function"!=typeof this[$h]&&(this[$h]=this._dataSource[$h]);}),$k(0,$f,"scaleY",$h.prototype._$get_scaleY,function($J){$q.superGet($d,this,"scaleY")!=$J&&($q.superSet($d,this,"scaleY",$J),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY());}),$k(0,$f,"measureHeight",function(){var $J=0;this.commitMeasure();for(var $h=this.numChildren-1;-1<$h;$h--){var $f=this.getChildAt($h);$f.visible&&($J=Math.max($f.y+$f.height*$f.scaleY,$J));}return $J;}),$k(0,$f,"scaleX",$h.prototype._$get_scaleX,function($J){$q.superGet($d,this,"scaleX")!=$J&&($q.superSet($d,this,"scaleX",$J),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX());}),$k(0,$f,"top",function(){return this._layout.top;},function($J){$J!=this._layout.top&&(this.getLayout().top=$J,this._setLayoutEnabled(!0)),this.resetLayoutY();}),$k(0,$f,"bottom",function(){return this._layout.bottom;},function($J){$J!=this._layout.bottom&&(this.getLayout().bottom=$J,this._setLayoutEnabled(!0)),this.resetLayoutY();}),$k(0,$f,"left",function(){return this._layout.left;},function($J){$J!=this._layout.left&&(this.getLayout().left=$J,this._setLayoutEnabled(!0)),this.resetLayoutX();}),$k(0,$f,"right",function(){return this._layout.right;},function($J){$J!=this._layout.right&&(this.getLayout().right=$J,this._setLayoutEnabled(!0)),this.resetLayoutX();}),$k(0,$f,"centerX",function(){return this._layout.centerX;},function($J){$J!=this._layout.centerX&&(this.getLayout().centerX=$J,this._setLayoutEnabled(!0)),this.resetLayoutX();}),$k(0,$f,"centerY",function(){return this._layout.centerY;},function($J){$J!=this._layout.centerY&&(this.getLayout().centerY=$J,this._setLayoutEnabled(!0)),this.resetLayoutY();}),$k(0,$f,"anchorX",function(){return this._layout.anchorX;},function($J){$J!=this._layout.anchorX&&(this.getLayout().anchorX=$J,this._setLayoutEnabled(!0)),this.resetLayoutX();}),$k(0,$f,"anchorY",function(){return this._layout.anchorY;},function($J){$J!=this._layout.anchorY&&(this.getLayout().anchorY=$J,this._setLayoutEnabled(!0)),this.resetLayoutY();}),$k(0,$f,"tag",function(){return this._tag;},function($J){this._tag=$J;}),$k(0,$f,"toolTip",function(){return this._toolTip;},function($J){this._toolTip!=$J&&(null!=(this._toolTip=$J)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)));}),$k(0,$f,"comXml",function(){return this._comXml;},function($J){this._comXml=$J;}),$k(0,$f,"gray",function(){return this._gray;},function($J){$J!==this._gray&&(this._gray=$J,$G.gray(this,$J));}),$k(0,$f,"disabled",function(){return this._disabled;},function($J){$J!==this._disabled&&(this.gray=this._disabled=$J,this.mouseEnabled=!$J);}),$J;}($d)),$W=function($J){function $h(){this.lockLayer=null,this.popupEffect=function($J){$J.scale(1,1),$Q.from($J,{x:$q.stage.width/2,y:$q.stage.height/2,scaleX:0,scaleY:0},300,$S.backOut,$R.create(this,this.doOpen,[$J]));},this.closeEffect=function($J,$h){$Q.to($J,{x:$q.stage.width/2,y:$q.stage.height/2,scaleX:0,scaleY:0},300,$S.strongOut,$R.create(this,this.doClose,[$J,$h]));},$h.__super.call(this),this.maskLayer=new $d(),this.popupEffectHandler=$R.create(this,this.popupEffect,null,!1),this.closeEffectHandler=$R.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,$q.stage.addChild(this),$q.stage.on("resize",this,this._onResize),$y.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null);}$T($h,"laya.ui.DialogManager",$d);var $f=$h.prototype;return $f._closeOnSide=function(){var $J=this.getChildAt(this.numChildren-1);$J instanceof laya.ui.Dialog&&$J.close("side");},$f.setLockView=function($J){this.lockLayer||(this.lockLayer=new $I(),this.lockLayer.mouseEnabled=!0,this.lockLayer.size($q.stage.width,$q.stage.height)),this.lockLayer.removeChildren(),$J&&($J.centerX=$J.centerY=0,this.lockLayer.addChild($J));},$f._onResize=function($J){var $h=this.maskLayer.width=$q.stage.width,$f=this.maskLayer.height=$q.stage.height;this.lockLayer&&this.lockLayer.size($h,$f),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,$h,$f,$y.popupBgColor),this.maskLayer.alpha=$y.popupBgAlpha;for(var $n=this.numChildren-1;-1<$n;$n--){var $L=this.getChildAt($n);$L.popupCenter&&this._centerDialog($L);}},$f._centerDialog=function($J){$J.x=Math.round(($q.stage.width-$J.width>>1)+$J.pivotX),$J.y=Math.round(($q.stage.height-$J.height>>1)+$J.pivotY);},$f.open=function($J,$h,$f){void 0===$h&&($h=!1),void 0===$f&&($f=!1),$h&&this._closeAll(),$J.popupCenter&&this._centerDialog($J),this.addChild($J),($J.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),$f&&null!=$J.popupEffect?$J.popupEffect.runWith($J):this.doOpen($J),this.event("open");},$f.doOpen=function($J){$J.onOpened();},$f.lock=function($J){this.lockLayer&&($J?this.addChild(this.lockLayer):this.lockLayer.removeSelf());},$f.close=function($J,$h,$f){void 0===$f&&($f=!1),$f&&null!=$J.closeEffect?$J.closeEffect.runWith([$J,$h]):this.doClose($J,$h),this.event("close");},$f.doClose=function($J,$h){$J.removeSelf(),$J.isModal&&this._checkMask(),$J.closeHandler&&$J.closeHandler.runWith($h),$J.onClosed($h);},$f.closeAll=function(){this._closeAll(),this.event("close");},$f._closeAll=function(){for(var $J=this.numChildren-1;-1<$J;$J--){var $h=this.getChildAt($J);$h&&null!=$h.close&&this.doClose($h);}},$f.getDialogsByGroup=function($J){for(var $h=[],$f=this.numChildren-1;-1<$f;$f--){var $n=this.getChildAt($f);$n&&$n.group===$J&&$h.push($n);}return $h;},$f.closeByGroup=function($J){for(var $h=[],$f=this.numChildren-1;-1<$f;$f--){var $n=this.getChildAt($f);$n&&$n.group===$J&&($n.close(),$h.push($n));}return $h;},$f._checkMask=function(){this.maskLayer.removeSelf();for(var $J=this.numChildren-1;-1<$J;$J--){var $h=this.getChildAt($J);if($h&&$h.isModal)return void this.addChildAt(this.maskLayer,$J);}},$h;}(),$I=function($J){function $h(){$h.__super.call(this);}$T($h,"laya.ui.Box",$J);var $f=$h.prototype;return $q.imps($f,{"laya.ui.IBox":!0}),$k(0,$f,"dataSource",$J.prototype._$get_dataSource,function($J){for(var $h in this._dataSource=$J){var $f=this.getChildByName($h);$f?$f.dataSource=$J[$h]:this.hasOwnProperty($h)&&"function"!=typeof this[$h]&&(this[$h]=$J[$h]);}}),$h;}($P),$m=function($h){function $f($J,$h){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,$f.__super.call(this),this._labelColors=$A.buttonLabelColors,this._stateNum=$A.buttonStateNum,void 0===$h&&($h=""),this.skin=$J,this.label=$h;}$T($f,"laya.ui.Button",$h);var $J=$f.prototype;return $q.imps($J,{"laya.ui.ISelect":!0}),$J.destroy=function($J){this.clearEvent(),$_.clearCache(this,this._skin),$_.clearObject(this,this._weakKey),void 0===$J&&($J=!0),$h.prototype.destroy.call(this,$J),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy($J),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null;},$J.clearEvent=function(){this._skin&&$L.atalsNotify&&$L.atalsNotify.off(this._skin,this,this._setBtnSource);},$J.createChildren=function(){this.graphics=this._bitmap=new $O();},$J.createText=function(){this._text||(this._text=new $p(),this._text.overflow=$p.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height);},$J.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1);},$J.onMouse=function($J){if(!1!==this.toggle||!this._selected)return"click"===$J.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=$f.stateMap[$J.type]));},$J.changeClips=function(){var $J=$_.getRes(this._skin);if($J)if(this._skin&&""!=this._skin){$_.clearObject(this,this._weakKey);var $h=$J.sourceWidth,$f=$J.sourceHeight/this._stateNum;$J.$_GID||($J.$_GID=$D.getGID());var $n=$J.$_GID+"-"+this._stateNum,$L=$_.findObject($n);if($D.isOkTextureList($L)||($L=null),$L)this._weakKey=$n,$_.keepObject(this,this._weakKey),this._sources=$L;else{if(this._sources=[],1===this._stateNum)this._sources.push($J);else for(var $T=0;$T<this._stateNum;$T++){var $k=$U.createFromTexture($J,0,$f*$T,$h,$f);if($J.alphaTexture){var $u=$J.width/$J.alphaTexture.width;$k.alphaTexture=$U.createFromTexture($J.alphaTexture,0/$u,$f*$T/$u,$h/$u,$f/$u);}this._sources.push($k);}$_.saveObject($n,this._sources),this._weakKey=$n,$_.keepObject(this,this._weakKey);}this._autoSize?(this._bitmap.width=this._width||$h,this._bitmap.height=this._height||$f,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=$h);}else console.warn("lose skin ",this._skin,this.name,this.__className);},$J.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var $J=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[$J]),this.label&&(this._text.color=this._labelColors[$J],this._strokeColors&&(this._text.strokeColor=this._strokeColors[$J]));},$J._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState));},$k(0,$J,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor;},function($J){this.createText(),this._text.strokeColor=$J;}),$k(0,$J,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height;}),$k(0,$J,"skin",function(){return this._skin;},function($J){if(this._skin!=$J)if(this.clearEvent(),$_.clearCache(this,this._skin),this._skin=$J,$_.keepCache(this,this._skin),$_.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var $h=$L.resAtalsObj&&$L.resAtalsObj[this._skin];$h?($L.atalsNotify&&$L.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=$h.sourceW),0==this.height&&(this.height=$h.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className);}}),$J._setBtnSource=function($J,$h){$J===this._skin&&$h&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent());},$k(0,$J,"state",function(){return this._state;},function($J){this._state!=$J&&(this._state=$J,this._setStateChanged());}),$k(0,$J,"text",function(){return this.createText(),this._text;}),$k(0,$J,"stateNum",function(){return this._stateNum;},function($J){"string"==typeof $J&&($J=parseInt($J)),this._stateNum!=$J&&(this._stateNum=$J<1?1:3<$J?3:$J,this.callLater(this.changeClips));}),$k(0,$J,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):"";},function($J){this._strokeColors=$G.fillArray($A.buttonLabelColors,$J,String),this._setStateChanged();}),$k(0,$J,"labelColors",function(){return this._labelColors.join(",");},function($J){this._labelColors=$G.fillArray($A.buttonLabelColors,$J,String),this._setStateChanged();}),$k(0,$J,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0));}),$k(0,$J,"label",function(){return this._text?this._text.text:null;},function($J){(this._text||$J)&&(this.createText(),this._text.text!=$J&&($J&&!this._text.parent&&this.addChild(this._text),this._text.text=($J+"").replace(/\\n/g,"\n"),this._setStateChanged()));}),$k(0,$J,"selected",function(){return this._selected;},function($J){this._selected!=$J&&(this._selected=$J,this.state=this._selected?2:0,this.event("change"));}),$k(0,$J,"labelPadding",function(){return this.createText(),this._text.padding.join(",");},function($J){this.createText(),this._text.padding=$G.fillArray($A.labelPadding,$J,Number);}),$k(0,$J,"labelSize",function(){return this.createText(),this._text.fontSize;},function($J){this.createText(),this._text.fontSize=$J;}),$k(0,$J,"labelStroke",function(){return this.createText(),this._text.stroke;},function($J){this.createText(),this._text.stroke=$J;}),$k(0,$J,"labelBold",function(){return this.createText(),this._text.bold;},function($J){this.createText(),this._text.bold=$J;}),$k(0,$J,"labelFont",function(){return this.createText(),this._text.font;},function($J){this.createText(),this._text.font=$J;}),$k(0,$J,"labelAlign",function(){return this.createText(),this._text.align;},function($J){this.createText(),this._text.align=$J;}),$k(0,$J,"clickHandler",function(){return this._clickHandler;},function($J){this._clickHandler=$J;}),$k(0,$J,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null;},function($J){this._bitmap.sizeGrid=$G.fillArray($A.defaultSizeGrid,$J,Number);}),$k(0,$J,"width",$h.prototype._$get_width,function($J){$q.superSet($P,this,"width",$J),this._autoSize&&(this._bitmap.width=$J,this._text&&(this._text.width=$J));}),$k(0,$J,"height",$h.prototype._$get_height,function($J){$q.superSet($P,this,"height",$J),this._autoSize&&(this._bitmap.height=$J,this._text&&(this._text.height=$J));}),$k(0,$J,"dataSource",$h.prototype._$get_dataSource,function($J){"number"==typeof(this._dataSource=$J)||"string"==typeof $J?this.label=$J+"":$q.superSet($P,this,"dataSource",$J);}),$k(0,$J,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null;},function($J){this._bitmap._offset=$J?$G.fillArray([1,1],$J,Number):[];}),$n($f,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0};}]),$f;}($P),$Z=function($h){function $n($J,$h,$f){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,$n.__super.call(this),void 0===$h&&($h=1),void 0===$f&&($f=1),this._clipX=$h,this._clipY=$f,this.skin=$J;}$T($n,"laya.ui.Clip",$h);var $J=$n.prototype;return $J.destroy=function($J){this.clearEvent(),this.clearLoad(),$_.clearCache(this,this._skin),$_.clearObject(this,this._weakKey),void 0===$J&&($J=!0),$h.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null;},$J.dispose=function(){this.destroy(!0),$q.loader.clearRes(this._skin);},$J.createChildren=function(){this.graphics=this._bitmap=new $O();},$J._onDisplay=function($J){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play();},$J.changeClip=function(){if(this._clipChanged=!1,this._skin){var $J=$_.getRes(this._skin);if($J)this.loadComplete(this._skin,$J);else{if($L.resAtalsObj&&$L.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=$R.create(this,this.loadComplete,[this._skin]),this._progress=null,$q.loader.load(this._skin,this._complete,this._progress);}}},$J.loadComplete=function($J,$h){if($J===this._skin&&$h){$_.clearObject(this,this._weakKey);var $f=this._clipWidth||Math.ceil($h.sourceWidth/this._clipX),$n=this._clipHeight||Math.ceil($h.sourceHeight/this._clipY),$L=this._skin+$f+$n,$T=$_.findObject($L);if($D.isOkTextureList($T)||($T=null),$T)this._weakKey=$L,$_.keepObject(this,this._weakKey),this._sources=$T;else{this._sources=[];for(var $k=0;$k<this._clipY;$k++)for(var $u=0;$u<this._clipX;$u++){var $S=$U.createFromTexture($h,$f*$u,$n*$k,$f,$n);if($h.alphaTexture){var $Y=$h.width/$h.alphaTexture.width;$S.alphaTexture=$U.createFromTexture($h.alphaTexture,$f*$u/$Y,$n*$k/$Y,$f/$Y,$n/$Y);}this._sources.push($S);}$_.saveObject($L,this._sources),this._weakKey=$L,$_.keepObject(this,this._weakKey);}this.index=this._index,this.event("loaded"),this.onCompResize();}},$J.play=function($J,$h){void 0===$J&&($J=0),void 0===$h&&($h=-1),this._isPlaying=!0,this.index=$J,this._toIndex=$h,this._index++,$q.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay);},$J._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index);},$J.stop=function(){this._isPlaying=!1,$q.timer.clear(this,this._loop),this.event("complete");},$J._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip));},$k(0,$J,"interval",function(){return this._interval;},function($J){this._interval!=$J&&(this._interval=$J,this._isPlaying&&this.play());}),$J.clearEvent=function(){this._skin&&$L.atalsNotify&&$L.atalsNotify.off(this._skin,this,this._setBtnSource);},$J.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$q.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null);},$k(0,$J,"skin",function(){return this._skin;},function($J){if(this._skin!=$J)if(this.clearLoad(),this.clearEvent(),$_.clearCache(this,this._skin),this._skin=$J){$_.keepCache(this,this._skin);var $h=$_.getRes($J),$f=$L.resAtalsObj&&$L.resAtalsObj[this._skin];!$h&&$f?$L.atalsNotify&&$L.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged();}else this._bitmap.source=null;}),$J._setBtnSource=function($J,$h){$J===this._skin&&$h&&(this.loadComplete($J,$h),this.clearEvent());},$k(0,$J,"sources",function(){return this._sources;},function($J){this._sources=$J,this.index=this._index,this.event("loaded");}),$k(0,$J,"clipX",function(){return this._clipX;},function($J){this._clipX=$J||1,this._setClipChanged();}),$k(0,$J,"clipY",function(){return this._clipY;},function($J){this._clipY=$J||1,this._setClipChanged();}),$k(0,$J,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0;}),$k(0,$J,"clipWidth",function(){return this._clipWidth;},function($J){this._clipWidth=$J,this._setClipChanged();}),$k(0,$J,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null;},function($J){this._bitmap.sizeGrid=$G.fillArray($A.defaultSizeGrid,$J,Number);}),$k(0,$J,"group",function(){return this._group;},function($J){$J&&this._skin&&$_.setGroup(this._skin,$J),this._group=$J;}),$k(0,$J,"clipHeight",function(){return this._clipHeight;},function($J){this._clipHeight=$J,this._setClipChanged();}),$k(0,$J,"width",$h.prototype._$get_width,function($J){$q.superSet($P,this,"width",$J),this._bitmap.width=$J;}),$k(0,$J,"height",$h.prototype._$get_height,function($J){$q.superSet($P,this,"height",$J),this._bitmap.height=$J;}),$k(0,$J,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width;}),$k(0,$J,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height;}),$k(0,$J,"index",function(){return this._index;},function($J){this._index=$J,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[$J]),this.event("change");}),$k(0,$J,"autoPlay",function(){return this._autoPlay;},function($J){this._autoPlay!=$J&&((this._autoPlay=$J)?this.play():this.stop());}),$k(0,$J,"isPlaying",function(){return this._isPlaying;},function($J){this._isPlaying=$J;}),$k(0,$J,"dataSource",$h.prototype._$get_dataSource,function($J){"number"==typeof(this._dataSource=$J)&&Math.floor($J)==$J||"string"==typeof $J?this.index=parseInt($J):$q.superSet($P,this,"dataSource",$J);}),$k(0,$J,"bitmap",function(){return this._bitmap;}),$n;}($P),$t=function($h){function $J(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,$J.__super.call(this);}$T($J,"laya.ui.ColorPicker",$h);var $f=$J.prototype;return $f.destroy=function($J){void 0===$J&&($J=!0),$h.prototype.destroy.call(this,$J),this._colorPanel&&this._colorPanel.destroy($J),this._colorButton&&this._colorButton.destroy($J),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null;},$f.createChildren=function(){this.addChild(this._colorButton=new $m()),this._colorPanel=new $I(),this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new $d()),this._colorPanel.addChild(this._colorBlock=new $d()),this._colorPanel.addChild(this._colorInput=new $l());},$f.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor;},$f.onPanelMouseDown=function($J){$J.stopPropagation();},$f.changePanel=function(){this._panelChanged=!1;var $J=this._colorPanel.graphics;$J.clear(),$J.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,($J=this._colorTiles.graphics).clear();for(var $h=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],$f=0;$f<12;$f++)for(var $n=0;$n<20;$n++){var $L=0;$L=0===$n?$h[$f]:1===$n?0:51*(((3*$f+$n/6)%3<<0)+3*($f/6<<0))<<16|$n%6*51<<8|($f<<0)%6*51;var $T=$G.toColor($L);this._colors.push($T);var $k=$n*this._gridSize,$u=$f*this._gridSize;$J.drawRect($k,$u,this._gridSize,this._gridSize,$T,"#000000");}},$f.onColorButtonClick=function($J){this._colorPanel.parent?this.close():this.open();},$f.open=function(){var $J=this.localToGlobal(new $i()),$h=$J.x+this._colorPanel.width<=$q.stage.width?$J.x:$q.stage.width-this._colorPanel.width,$f=$J.y+this._colorButton.height;$f=$f+this._colorPanel.height<=$q.stage.height?$f:$J.y-this._colorPanel.height,this._colorPanel.pos($h,$f),this._colorPanel.zOrder=1001,$q._currentStage.addChild(this._colorPanel),$q.stage.on("mousedown",this,this.removeColorBox);},$f.close=function(){$q.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf();},$f.removeColorBox=function($J){this.close();},$f.onColorFieldKeyDown=function($J){13==$J.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),$J.stopPropagation());},$f.onColorInputChange=function($J){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF");},$f.onColorTilesClick=function($J){this.selectedColor=this.getColorByMouse(),this.close();},$f.onColorTilesMouseMove=function($J){this._colorInput.focus=!1;var $h=this.getColorByMouse();this._colorInput.text=$h,this.drawBlock($h);},$f.getColorByMouse=function(){var $J=this._colorTiles.getMousePoint(),$h=Math.floor($J.x/this._gridSize),$f=Math.floor($J.y/this._gridSize);return this._colors[20*$f+$h];},$f.drawBlock=function($J){var $h=this._colorBlock.graphics;$h.clear();var $f=$J||"#ffffff";$h.drawRect(0,0,50,20,$f,this._borderColor),$J||$h.drawLine(0,0,50,20,"#ff0000");},$f.changeColor=function(){var $J=this.graphics;$J.clear();var $h=this._selectedColor||"#000000";$J.drawRect(0,0,this._colorButton.width,this._colorButton.height,$h);},$f._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel));},$k(0,$f,"inputBgColor",function(){return this._inputBgColor;},function($J){this._inputBgColor=$J,this._setPanelChanged();}),$k(0,$f,"selectedColor",function(){return this._selectedColor;},function($J){this._selectedColor!=$J&&(this._selectedColor=this._colorInput.text=$J,this.drawBlock($J),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",$Y.EMPTY.setTo("change",this,this)));}),$k(0,$f,"skin",function(){return this._colorButton.skin;},function($J){this._colorButton.skin=$J,this.changeColor();}),$k(0,$f,"bgColor",function(){return this._bgColor;},function($J){this._bgColor=$J,this._setPanelChanged();}),$k(0,$f,"borderColor",function(){return this._borderColor;},function($J){this._borderColor=$J,this._setPanelChanged();}),$k(0,$f,"inputColor",function(){return this._inputColor;},function($J){this._inputColor=$J,this._setPanelChanged();}),$J;}($P),$c=function($h){function $f($J,$h){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,$f.__super.call(this),this._itemColors=$A.comboBoxItemColors,this.skin=$J,this.labels=$h;}$T($f,"laya.ui.ComboBox",$h);var $J=$f.prototype;return $J.destroy=function($J){void 0===$J&&($J=!0),$h.prototype.destroy.call(this,$J),this._button&&this._button.destroy($J),this._list&&this._list.destroy($J),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null;},$J.createChildren=function(){this.addChild(this._button=new $m()),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown);},$J._createList=function(){this._list=new $M(),this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list);},$J._setListEvent=function($J){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=$R.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown);},$J.onListDown=function($J){$J.stopPropagation();},$J.onScrollBarDown=function($J){$J.stopPropagation();},$J.onButtonMouseDown=function($J){this.callLater(this.switchTo,[!this._isOpen]);},$J.changeList=function(){this._listChanged=!1;var $J=this.width-2,$h=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:$J,height:this._itemHeight,fontSize:this._itemSize,color:$h}}]},this._list.repeatY=this._visibleNum,this._list.refresh();},$J.onlistItemMouse=function($J,$h){var $f=$J.type;if("mouseover"===$f||"mouseout"===$f){if(this._isCustomList)return;var $n=this._list.getCell($h);if(!$n)return;var $L=$n.getChildByName("label");$L&&("mouseover"===$f?($L.bgColor=this._itemColors[0],$L.color=this._itemColors[1]):($L.bgColor=null,$L.color=this._itemColors[2]));}else"click"===$f&&(this.selectedIndex=$h,this.isOpen=!1);},$J.switchTo=function($J){this.isOpen=$J;},$J.changeOpen=function(){this.isOpen=!this._isOpen;},$J.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var $J=this._list.graphics;$J.clear(),$J.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3]);}for(var $h=this._list.array||[],$f=$h.length=0,$n=this._labels.length;$f<$n;$f++)$h.push({label:this._labels[$f]});this._list.height=this._listHeight,this._list.array=$h;},$J.changeSelected=function(){this._button.label=this.selectedLabel;},$J._onStageMouseWheel=function($J){this._list&&!this._list.contains($J.target)&&this.removeList(null);},$J.removeList=function($J){$q.stage.off("mousedown",this,this.removeList),$q.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1;},$k(0,$J,"selectedIndex",function(){return this._selectedIndex;},function($J){this._selectedIndex!=$J&&(this._selectedIndex=$J,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[$Y.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex));}),$k(0,$J,"measureHeight",function(){return this._button.height;}),$k(0,$J,"skin",function(){return this._button.skin;},function($J){this._button.skin!=$J&&(this._button.skin=$J,this._listChanged=!0);}),$k(0,$J,"measureWidth",function(){return this._button.width;}),$k(0,$J,"width",$h.prototype._$get_width,function($J){$q.superSet($P,this,"width",$J),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0;}),$k(0,$J,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null;},function($J){this.selectedIndex=this._labels.indexOf($J);}),$k(0,$J,"labels",function(){return this._labels.join(",");},function($J){0<this._labels.length&&(this.selectedIndex=-1),$J?this._labels=$J.split(","):this._labels.length=0,this._itemChanged=!0;}),$k(0,$J,"height",$h.prototype._$get_height,function($J){$q.superSet($P,this,"height",$J),this._button.height=this._height;}),$k(0,$J,"selectHandler",function(){return this._selectHandler;},function($J){this._selectHandler=$J;}),$k(0,$J,"visibleNum",function(){return this._visibleNum;},function($J){this._visibleNum=$J,this._listChanged=!0;}),$k(0,$J,"labelBold",function(){return this._button.text.bold;},function($J){this._button.text.bold=$J;}),$k(0,$J,"itemColors",function(){return String(this._itemColors);},function($J){this._itemColors=$G.fillArray(this._itemColors,$J,String),this._listChanged=!0;}),$k(0,$J,"itemSize",function(){return this._itemSize;},function($J){this._itemSize=$J,this._listChanged=!0;}),$k(0,$J,"scrollBar",function(){return this.list.scrollBar;}),$k(0,$J,"isOpen",function(){return this._isOpen;},function($J){if(this._isOpen!=$J)if(this._isOpen=$J,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var $h=this.localToGlobal($i.TEMP.setTo(0,0)),$f=$h.y+this._button.height;$f=$f+this._listHeight<=$q.stage.height?$f:$h.y-this._listHeight,this._list.pos($h.x,$f),this._list.zOrder=1001,$q._currentStage.addChild(this._list),$q.stage.once("mousedown",this,this.removeList),$q.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex;}else this._list&&this._list.removeSelf();}),$k(0,$J,"scrollBarSkin",function(){return this._scrollBarSkin;},function($J){this._scrollBarSkin=$J;}),$k(0,$J,"sizeGrid",function(){return this._button.sizeGrid;},function($J){this._button.sizeGrid=$J;}),$k(0,$J,"button",function(){return this._button;}),$k(0,$J,"list",function(){return this._list||this._createList(),this._list;},function($J){$J&&($J.removeSelf(),this._isCustomList=!0,this._list=$J,this._setListEvent($J),this._itemHeight=$J.getCell(0).height+$J.spaceY);}),$k(0,$J,"dataSource",$h.prototype._$get_dataSource,function($J){"number"==typeof(this._dataSource=$J)&&Math.floor($J)==$J||"string"==typeof $J?this.selectedIndex=parseInt($J):$J instanceof Array?this.labels=$J.join(","):$q.superSet($P,this,"dataSource",$J);}),$k(0,$J,"labelColors",function(){return this._button.labelColors;},function($J){this._button.labelColors!=$J&&(this._button.labelColors=$J);}),$k(0,$J,"labelPadding",function(){return this._button.text.padding.join(",");},function($J){this._button.text.padding=$G.fillArray($A.labelPadding,$J,Number);}),$k(0,$J,"labelSize",function(){return this._button.text.fontSize;},function($J){this._button.text.fontSize=$J;}),$k(0,$J,"labelFont",function(){return this._button.text.font;},function($J){this._button.text.font=$J;}),$k(0,$J,"stateNum",function(){return this._button.stateNum;},function($J){this._button.stateNum=$J;}),$f;}($P),$a=function($h){function $f($J){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,$f.__super.call(this),this._showButtons=$y.showButtons,this._touchScrollEnable=$y.touchScrollEnable,this._mouseWheelEnable=$y.mouseWheelEnable,this.skin=$J,this.max=1;}$T($f,"laya.ui.ScrollBar",$h);var $J=$f.prototype;return $J.destroy=function($J){void 0===$J&&($J=!0),this.stopScroll(),this.target=null,$h.prototype.destroy.call(this,$J),this.upButton&&this.upButton.destroy($J),this.downButton&&this.downButton.destroy($J),this.slider&&this.slider.destroy($J),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null;},$J.createChildren=function(){this.addChild(this.slider=new $B()),this.addChild(this.upButton=new $m()),this.addChild(this.downButton=new $m());},$J.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown);},$J.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value);},$J.onButtonMouseDown=function($J){var $h=$J.currentTarget===this.upButton;this.slide($h),$q.timer.once($A.scrollBarDelayTime,this,this.startLoop,[$h]),$q.stage.once("mouseup",this,this.onStageMouseUp);},$J.startLoop=function($J){$q.timer.frameLoop(1,this,this.slide,[$J]);},$J.slide=function($J){$J?this.value-=this._scrollSize:this.value+=this._scrollSize;},$J.onStageMouseUp=function($J){$q.timer.clear(this,this.startLoop),$q.timer.clear(this,this.slide);},$J.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint();},$J.changeSize=function(){$h.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value);},$J.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition();},$J.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width;},$J.setScroll=function($J,$h,$f){this.runCallLater(this.changeSize),this.slider.setSlider($J,$h,$f),this.slider.bar.visible=0<$h,!this._hide&&this.autoHide&&(this.visible=!1);},$J.onTargetMouseWheel=function($J){this.value-=$J.delta*this._scrollSize,this.target=this._target;},$J.onTargetMouseDown=function($J){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $i()),this._lastPoint.setTo($q.stage.mouseX,$q.stage.mouseY),$q.timer.clear(this,this.tweenMove),$Q.clearTween(this),$q.stage.once("mouseup",this,this.onStageMouseUp2),$q.stage.once("mouseout",this,this.onStageMouseUp2),$q.timer.frameLoop(1,this,this.loop);},$J.loop=function(){var $J=$q.stage.mouseY,$h=$q.stage.mouseX;if(this._lastOffset=this.isVertical?$J-this._lastPoint.y:$h-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?$q.stage._canvasTransform.getScaleY():$q.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start");}this._offsets.push(this._lastOffset),this._lastPoint.x=$h,this._lastPoint.y=$J,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset);},$J.onStageMouseUp2=function($J){if($q.stage.off("mouseup",this,this.onStageMouseUp2),$q.stage.off("mouseout",this,this.onStageMouseUp2),$q.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?$Q.to(this,{value:this.min},this.elasticBackTime,$S.sineOut,$R.create(this,this.elasticOver)):this._value>this.max&&$Q.to(this,{value:this.max},this.elasticBackTime,$S.sineOut,$R.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?$q.stage.mouseY-this._lastPoint.y:$q.stage.mouseX-this._lastPoint.x);for(var $h=0,$f=Math.min(this._offsets.length,3),$n=0;$n<$f;$n++)$h+=this._offsets[this._offsets.length-1-$n];if(this._lastOffset=$h/$f,($h=Math.abs(this._lastOffset))<2)return void this.event("end");60<$h&&(this._lastOffset=0<this._lastOffset?60:-60);var $L=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));$q.timer.frameLoop(1,this,this.tweenMove,[$L]);}},$J.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&$Q.to(this,{alpha:0},500),this.event("end");},$J.tweenMove=function($J){this._lastOffset*=this.rollRatio;var $h=NaN;if(0<$J&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,$h=.5*-(this.min-$J-this.value),this._lastOffset>$h&&(this._lastOffset=$h)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,$h=.5*-(this.max+$J-this.value),this._lastOffset<$h&&(this._lastOffset=$h))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if($q.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?$Q.to(this,{value:this.min},this.elasticBackTime,$S.sineOut,$R.create(this,this.elasticOver)):this._value>this.max?$Q.to(this,{value:this.max},this.elasticBackTime,$S.sineOut,$R.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&$Q.to(this,{alpha:0},500);}},$J.stopScroll=function(){this.onStageMouseUp2(null),$q.timer.clear(this,this.tweenMove),$Q.clearTween(this);},$k(0,$J,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height;}),$k(0,$J,"skin",function(){return this._skin;},function($J){this._skin!=$J&&(this._skin=$J,this.slider.skin=this._skin,this.callLater(this.changeScrollBar));}),$k(0,$J,"max",function(){return this.slider.max;},function($J){this.slider.max=$J;}),$k(0,$J,"showButtons",function(){return this._showButtons;},function($J){this._showButtons=$J,this.callLater(this.changeScrollBar);}),$k(0,$J,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100;}),$k(0,$J,"min",function(){return this.slider.min;},function($J){this.slider.min=$J;}),$k(0,$J,"value",function(){return this._value;},function($J){$J!==this._value&&(this._value=$J,this._isElastic||(this.slider._value!=$J&&(this.slider._value=$J,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value));}),$k(0,$J,"isVertical",function(){return this.slider.isVertical;},function($J){this.slider.isVertical=$J;}),$k(0,$J,"sizeGrid",function(){return this.slider.sizeGrid;},function($J){this.slider.sizeGrid=$J;}),$k(0,$J,"scrollSize",function(){return this._scrollSize;},function($J){this._scrollSize=$J;}),$k(0,$J,"dataSource",$h.prototype._$get_dataSource,function($J){"number"==typeof(this._dataSource=$J)||"string"==typeof $J?this.value=Number($J):$q.superSet($P,this,"dataSource",$J);}),$k(0,$J,"thumbPercent",function(){return this._thumbPercent;},function($J){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),$J=1<=$J?.99:$J,this._thumbPercent=$J,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*$J,$A.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*$J,$A.scrollBarMinNum));}),$k(0,$J,"target",function(){return this._target;},function($J){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=$J)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown));}),$k(0,$J,"hide",function(){return this._hide;},function($J){this._hide=$J,this.visible=!$J;}),$k(0,$J,"touchScrollEnable",function(){return this._touchScrollEnable;},function($J){this._touchScrollEnable=$J,this.target=this._target;}),$k(0,$J,"mouseWheelEnable",function(){return this._mouseWheelEnable;},function($J){this._mouseWheelEnable=$J,this.target=this._target;}),$k(0,$J,"tick",function(){return this.slider.tick;},function($J){this.slider.tick=$J;}),$f;}($P),$B=function($h){function $f($J){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,$f.__super.call(this),this.skin=$J;}$T($f,"laya.ui.Slider",$h);var $J=$f.prototype;return $J.destroy=function($J){void 0===$J&&($J=!0),$h.prototype.destroy.call(this,$J),this._bg&&this._bg.destroy($J),this._bar&&this._bar.destroy($J),this._progress&&this._progress.destroy($J),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null;},$J.createChildren=function(){this.addChild(this._bg=new $V()),this.addChild(this._bar=new $m());},$J.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0;},$J.onBarMouseDown=function($J){this._globalSacle||(this._globalSacle=new $i()),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=$q.stage.mouseX,this._ty=$q.stage.mouseY,$q.stage.on("mousemove",this,this.mouseMove),$q.stage.once("mouseup",this,this.mouseUp),$q.stage.once("mouseout",this,this.mouseUp),this.showValueText();},$J.showValueText=function(){if(this.showLabel){var $J=laya.ui.Slider.label;this.addChild($J),$J.textField.changeText(this._value+""),this.isVertical?($J.x=this._bar.x+20,$J.y=.5*(this._bar.height-$J.height)+this._bar.y):($J.y=this._bar.y-20,$J.x=.5*(this._bar.width-$J.width)+this._bar.x);}},$J.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf();},$J.mouseUp=function($J){$q.stage.off("mousemove",this,this.mouseMove),$q.stage.off("mouseup",this,this.mouseUp),$q.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText();},$J.mouseMove=function($J){var $h=this._value;this.isVertical?(this._bar.y+=($q.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=($q.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=$q.stage.mouseX,this._ty=$q.stage.mouseY;var $f=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$f)/$f,this._value!=$h&&this.sendChangeEvent(),this.showValueText();},$J.sendChangeEvent=function($J){void 0===$J&&($J="change"),this.event($J),this.changeHandler&&this.changeHandler.runWith(this._value);},$J.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height));},$J.changeSize=function(){$h.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue();},$J.setSlider=function($J,$h,$f){this._value=-1,this._min=$J,this._max=$J<$h?$h:$J,this.value=$f<$J?$J:$h<$f?$h:$f;},$J.changeValue=function(){var $J=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$J)/$J,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var $h=this._max-this._min;0===$h&&($h=1),this.isVertical?(this._bar.y=(this._value-this._min)/$h*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/$h*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width));},$J.onBgMouseDown=function($J){var $h=this._bg.getMousePoint();this.isVertical?this.value=$h.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=$h.x/(this.width-this._bar.width)*(this._max-this._min)+this._min;},$k(0,$J,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height);}),$k(0,$J,"skin",function(){return this._skin;},function($J){if(this._skin!=$J){this._skin=$J,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var $h=this._skin.replace(".png","$progress.png");$_.getRes($h)&&(this._progress||(this.addChild(this._progress=new $V()),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=$h),this.setBarPoint(),this.callLater(this.changeValue);}}),$k(0,$J,"allowClickBack",function(){return this._allowClickBack;},function($J){this._allowClickBack!=$J&&((this._allowClickBack=$J)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown));}),$k(0,$J,"max",function(){return this._max;},function($J){this._max!=$J&&(this._max=$J,this.callLater(this.changeValue));}),$k(0,$J,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width);}),$k(0,$J,"tick",function(){return this._tick;},function($J){this._tick!=$J&&(this._tick=$J,this.callLater(this.changeValue));}),$k(0,$J,"sizeGrid",function(){return this._bg.sizeGrid;},function($J){this._bg.sizeGrid=$J,this._bar.sizeGrid=$J,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid);}),$k(0,$J,"min",function(){return this._min;},function($J){this._min!=$J&&(this._min=$J,this.callLater(this.changeValue));}),$k(0,$J,"value",function(){return this._value;},function($J){if(this._value!=$J){var $h=this._value;this._value=$J,this.changeValue(),this._value!=$h&&this.sendChangeEvent();}}),$k(0,$J,"dataSource",$h.prototype._$get_dataSource,function($J){"number"==typeof(this._dataSource=$J)||"string"==typeof $J?this.value=Number($J):$q.superSet($P,this,"dataSource",$J);}),$k(0,$J,"bar",function(){return this._bar;}),$n($f,["label",function(){return this.label=new $C();}]),$f;}($P),$V=function($h){function $f($J){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,$f.__super.call(this),this.skin=$J;}$T($f,"laya.ui.Image",$h);var $J=$f.prototype;return $J.destroy=function($J){void 0===$J&&($J=!0),$h.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,$_.clearCache(this,this._skin);},$J.dispose=function(){this.destroy(!0),$_.clearCache(this,this._skin),this.clearEvent();},$J.createChildren=function(){this.graphics=this._bitmap=new $O();},$J.setSource=function($J,$h){this.destroyed||$J===this._skin&&$h&&(this.source=$h,this.onCompResize(),this.clearEvent());},$J.clearEvent=function(){this._skin&&$L.atalsNotify&&$L.atalsNotify.off(this._skin,this,this.setSource);},$J.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$q.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null);},$k(0,$J,"source",function(){return this._bitmap.source;},function($J){this._bitmap&&(this._bitmap.source=$J,this.event("loaded"),this.repaint());}),$k(0,$J,"dataSource",$h.prototype._$get_dataSource,function($J){"string"==typeof(this._dataSource=$J)?this.skin=$J:$q.superSet($P,this,"dataSource",$J);}),$k(0,$J,"measureHeight",function(){return this._bitmap.height;}),$k(0,$J,"skin",function(){return this._skin;},function($J){if(this._skin!=$J)if($_.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=$J){$_.keepCache(this,this._skin);var $h=$_.getRes($J),$f=$L.resAtalsObj&&$L.resAtalsObj[this._skin];$h?(this.source=$h,this.onCompResize()):$f?($L.atalsNotify&&$L.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=$f.sourceW),0==this.height&&(this.height=$f.sourceH)):(this._complete=$R.create(this,this.setSource,[this._skin]),this._progress=null,$q.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group));}else this.source=null;}),$k(0,$J,"group",function(){return this._group;},function($J){$J&&this._skin&&$_.setGroup(this._skin,$J),this._group=$J;}),$k(0,$J,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null;},function($J){this._bitmap.sizeGrid=$G.fillArray($A.defaultSizeGrid,$J,Number);}),$k(0,$J,"measureWidth",function(){return this._bitmap.width;}),$k(0,$J,"width",$h.prototype._$get_width,function($J){$q.superSet($P,this,"width",$J),this._bitmap.width=0==$J?1e-7:$J;}),$k(0,$J,"height",$h.prototype._$get_height,function($J){$q.superSet($P,this,"height",$J),this._bitmap.height=0==$J?1e-7:$J;}),$f;}($P),$C=function($h){function $f($J){this._tf=null,$f.__super.call(this),void 0===$J&&($J=""),$x.defaultColor=$A.labelColor,this.text=$J;}$T($f,"laya.ui.Label",$h);var $J=$f.prototype;return $J.destroy=function($J){void 0===$J&&($J=!0),$h.prototype.destroy.call(this,$J),this._tf=null;},$J.createChildren=function(){this.addChild(this._tf=new $p());},$J.changeText=function($J){this._tf.changeText($J);},$k(0,$J,"padding",function(){return this._tf.padding.join(",");},function($J){this._tf.padding=$G.fillArray($A.labelPadding,$J,Number);}),$k(0,$J,"bold",function(){return this._tf.bold;},function($J){this._tf.bold=$J;}),$k(0,$J,"align",function(){return this._tf.align;},function($J){this._tf.align=$J;}),$k(0,$J,"text",function(){return this._tf.text;},function($J){this._tf.text!=$J&&($J&&($J=$G.adptString($J+"")),this._tf.text=$J,this.event("change"),this._width&&this._height||this.onCompResize());}),$k(0,$J,"italic",function(){return this._tf.italic;},function($J){this._tf.italic=$J;}),$k(0,$J,"wordWrap",function(){return this._tf.wordWrap;},function($J){this._tf.wordWrap=$J;}),$k(0,$J,"font",function(){return this._tf.font;},function($J){this._tf.font=$J;}),$k(0,$J,"dataSource",$h.prototype._$get_dataSource,function($J){"number"==typeof(this._dataSource=$J)||"string"==typeof $J?this.text=$J+"":$q.superSet($P,this,"dataSource",$J);}),$k(0,$J,"color",function(){return this._tf.color;},function($J){this._tf.color=$J;}),$k(0,$J,"valign",function(){return this._tf.valign;},function($J){this._tf.valign=$J;}),$k(0,$J,"leading",function(){return this._tf.leading;},function($J){this._tf.leading=$J;}),$k(0,$J,"fontSize",function(){return this._tf.fontSize;},function($J){this._tf.fontSize=$J;}),$k(0,$J,"bgColor",function(){return this._tf.bgColor;},function($J){this._tf.bgColor=$J;}),$k(0,$J,"borderColor",function(){return this._tf.borderColor;},function($J){this._tf.borderColor=$J;}),$k(0,$J,"stroke",function(){return this._tf.stroke;},function($J){this._tf.stroke=$J;}),$k(0,$J,"strokeColor",function(){return this._tf.strokeColor;},function($J){this._tf.strokeColor=$J;}),$k(0,$J,"textField",function(){return this._tf;}),$k(0,$J,"measureWidth",function(){return this._tf.width;}),$k(0,$J,"measureHeight",function(){return this._tf.height;}),$k(0,$J,"width",function(){return this._width||this._tf.text?$q.superGet($P,this,"width"):0;},function($J){$q.superSet($P,this,"width",$J),this._tf.width=$J;}),$k(0,$J,"height",function(){return this._height||this._tf.text?$q.superGet($P,this,"height"):0;},function($J){$q.superSet($P,this,"height",$J),this._tf.height=$J;}),$k(0,$J,"overflow",function(){return this._tf.overflow;},function($J){this._tf.overflow=$J;}),$k(0,$J,"underline",function(){return this._tf.underline;},function($J){this._tf.underline=$J;}),$k(0,$J,"underlineColor",function(){return this._tf.underlineColor;},function($J){this._tf.underlineColor=$J;}),$f;}($P),$e=function($h){function $f($J){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,$f.__super.call(this),this.skin=$J;}$T($f,"laya.ui.ProgressBar",$h);var $J=$f.prototype;return $J.destroy=function($J){void 0===$J&&($J=!0),$h.prototype.destroy.call(this,$J),this._bg&&this._bg.destroy($J),this._bar&&this._bar.destroy($J),this._bg=this._bar=null,this.changeHandler=null;},$J.createChildren=function(){this.addChild(this._bg=new $V()),this.addChild(this._bar=new $V());},$J.changeValue=function(){if(this.sizeGrid){var $J=this.sizeGrid.split(","),$h=Number($J[3]),$f=Number($J[1]),$n=(this.width-$h-$f)*this._value;this._bar.width=$h+$f+$n,this._bar.visible=this._bar.width>$h+$f;}else this._bar.width=this.width*this._value;},$k(0,$J,"measureHeight",function(){return this._bg.height;}),$k(0,$J,"skin",function(){return this._skin;},function($J){this._skin!=$J&&(this._skin=$J,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue));}),$k(0,$J,"measureWidth",function(){return this._bg.width;}),$k(0,$J,"height",$h.prototype._$get_height,function($J){$q.superSet($P,this,"height",$J),this._bg.height=this._height,this._bar.height=this._height;}),$k(0,$J,"bar",function(){return this._bar;}),$k(0,$J,"value",function(){return this._value;},function($J){this._value!=$J&&($J=1<$J?1:$J<0?0:$J,this._value=$J,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith($J));}),$k(0,$J,"bg",function(){return this._bg;}),$k(0,$J,"sizeGrid",function(){return this._bg.sizeGrid;},function($J){this._bg.sizeGrid=this._bar.sizeGrid=$J;}),$k(0,$J,"width",$h.prototype._$get_width,function($J){$q.superSet($P,this,"width",$J),this._bg.width=this._width,this.callLater(this.changeValue);}),$k(0,$J,"dataSource",$h.prototype._$get_dataSource,function($J){"number"==typeof(this._dataSource=$J)||"string"==typeof $J?this.value=Number($J):$q.superSet($P,this,"dataSource",$J);}),$f;}($P),$H=(function($J){function $f(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,$f.__super.call(this),this._tipBox=new $P(),this._tipBox.addChild(this._tipText=new $p()),this._tipText.x=this._tipText.y=5,this._tipText.color=$f.tipTextColor,this._defaultTipHandler=this._showDefaultTip,$q.stage.on("showtip",this,this._onStageShowTip),$q.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100;}$T($f,"laya.ui.TipManager",$P);var $h=$f.prototype;$h._onStageHideTip=function($J){$q.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf();},$h._onStageShowTip=function($J){$q.timer.once($f.tipDelay,this,this._showTip,[$J],!0);},$h._showTip=function($J){if("string"==typeof $J){var $h=String($J);Boolean($h)&&this._defaultTipHandler($h);}else $J instanceof laya.utils.Handler?$J.run():"function"==typeof $J&&$J.apply();$q.stage.on("mousemove",this,this._onStageMouseMove),$q.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null);},$h._onStageMouseDown=function($J){this.closeAll();},$h._onStageMouseMove=function($J){this._showToStage(this,$f.offsetX,$f.offsetY);},$h._showToStage=function($J,$h,$f){void 0===$h&&($h=0),void 0===$f&&($f=0);var $n=$J.getBounds();$J.x=$q.stage.mouseX+$h,$J.y=$q.stage.mouseY+$f,$J.x+$n.width>$q.stage.width&&($J.x-=$n.width+$h),$J.y+$n.height>$q.stage.height&&($J.y-=$n.height+$f);},$h.closeAll=function(){$q.timer.clear(this,this._showTip),$q.stage.off("mousemove",this,this._onStageMouseMove),$q.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren();},$h.showDislayTip=function($J){this.addChild($J),this._showToStage(this),$q._currentStage.addChild(this);},$h._showDefaultTip=function($J){this._tipText.text=$J;var $h=this._tipBox.graphics;$h.clear(),$h.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,$f.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),$q._currentStage.addChild(this);},$k(0,$h,"defaultTipHandler",function(){return this._defaultTipHandler;},function($J){this._defaultTipHandler=$J;}),$f.offsetX=10,$f.offsetY=15,$f.tipTextColor="#ffffff",$f.tipBackColor="#111111",$f.tipDelay=200;}(),function($J){var $l;function $i(){this._idMap=null,this._aniList=null,this._watchMap={},$i.__super.call(this);}$T($i,"laya.ui.View",$I);var $h=$i.prototype;return $h.createView=function($J){if($J.animations&&!this._idMap&&(this._idMap={}),$i.createComp($J,this,this),$J.animations){var $h,$f,$n=[],$L=$J.animations,$T=0,$k=$L.length;for($T=0;$T<$k;$T++){switch($h=new $j(),$f=$L[$T],$h._setUp(this._idMap,$f),(this[$f.name]=$h)._setControlNode(this),$f.action){case 1:$h.play(0,!1);break;case 2:$h.play(0,!0);}$n.push($h);}this._aniList=$n;}0<this._width&&null==$J.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0);},$h.onEvent=function($J,$h){},$h.loadUI=function($J){var $h=$i.uiMap[$J];$h&&this.createView($h);},$h.destroy=function($J){void 0===$J&&($J=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,$J);},$h.changeData=function($J){var $h=this._watchMap[$J];if($h){console.log("change",$J);for(var $f=0,$n=$h.length;$f<$n;$f++){$h[$f].exe(this);}}},$i._regs=function(){for(var $J in $i.uiClassMap)$o.regClass($J,$i.uiClassMap[$J]);},$i.createComp=function($J,$h,$f,$n){if(!($h=$h||$i.getCompInstance($J)))return console.warn("can not create:"+$J.type),null;var $L=$J.child;if($L)for(var $T=$h instanceof laya.ui.List,$k=0,$u=$L.length;$k<$u;$k++){var $S=$L[$k];if(!$h.hasOwnProperty("itemRender")||"render"!=$S.props.name&&"render"!==$S.props.renderType){if("Graphic"==$S.type)$o.addGraphicsToSprite($S,$h);else if($o.isDrawType($S.type))$o.addGraphicToSprite($S,$h,!0);else{if($T){var $Y=[],$x=$i.createComp($S,null,$f,$Y);$Y.length&&($x._$bindData=$Y);}else $x=$i.createComp($S,null,$f,$n);"Script"==$S.type?"owner"in $x?$x.owner=$h:"target"in $x&&($x.target=$h):"mask"==$S.props.renderType||"mask"==$S.props.name?$h.mask=$x:$x instanceof laya.display.Sprite&&$h.addChild($x);}}else $h.itemRender=$S;}var $j=$J.props;for(var $R in $j){var $l=$j[$R];$i.eventDic[$R]?$l&&$f&&$h.on($R,$f,$f.onEvent,[$l]):$i.setCompValue($h,$R,$l,$f,$n);}return $q.__typeof($h,"laya.ui.IItem")&&$h.initItems(),$J.compId&&$f&&$f._idMap&&($f._idMap[$J.compId]=$h),$h;},$i.setCompValue=function($J,$h,$f,$n,$L){if("string"==typeof $f&&-1<$f.indexOf("${")){if($i._sheet||($i._sheet=$o.getClass("laya.data.Table")),!$i._sheet)return void console.warn("Can not find class Sheet");if($L)$L.push($J,$h,$f);else if($n){-1==$f.indexOf("].")&&($f=$f.replace(".","[0]."));var $T,$k,$u=new $l($J,$h,$f);$u.exe($n);for(var $S=$f.replace(/\[.*?\]\./g,".");null!=($T=$i._parseWatchData.exec($S));){for(var $Y=$T[1];null!=($k=$i._parseKeyWord.exec($Y));){var $x=$k[0],$j=$n._watchMap[$x]||($n._watchMap[$x]=[]);$j.push($u),$i._sheet.I.notifer.on($x,$n,$n.changeData,[$x]);}($j=$n._watchMap[$Y]||($n._watchMap[$Y]=[])).push($u),$i._sheet.I.notifer.on($Y,$n,$n.changeData,[$Y]);}}}else if("var"===$h&&$n)$n[$f]=$J;else if("onClick"==$h){var $R=$q._runScript("(function(){"+$f+"})");$J.on("click",$n,$R);}else $J[$h]="true"===$f||"false"!==$f&&$f;},$i.getCompInstance=function($J){var $h,$f=$J.props?$J.props.runtime:null;return $h=$f?$i.viewClassMap[$f]||$i.uiClassMap[$f]||$q.__classmap[$f]:$i.uiClassMap[$J.type],$J.props&&$J.props.hasOwnProperty("renderType")&&"instance"==$J.props.renderType?$h.instance:$h?new $h():null;},$i.regComponent=function($J,$h){$i.uiClassMap[$J]=$h,$o.regClass($J,$h);},$i.regViewRuntime=function($J,$h){$i.viewClassMap[$J]=$h;},$i.uiMap={},$i.viewClassMap={},$i._sheet=null,$n($i,["uiClassMap",function(){return this.uiClassMap={ViewStack:$JJ,LinkButton:$m,TextArea:$YJ,ColorPicker:$t,Box:$I,Button:$m,CheckBox:$b,Clip:$Z,ComboBox:$c,Component:$P,HScrollBar:$X,HSlider:$E,Image:$V,Label:$C,List:$M,Panel:$w,ProgressBar:$e,Radio:$z,RadioGroup:$uJ,ScrollBar:$a,Slider:$B,Tab:$SJ,TextInput:$fJ,View:$i,VScrollBar:$hJ,VSlider:$nJ,Tree:$K,HBox:$TJ,VBox:$kJ,Sprite:$d,Animation:$f,Text:$p,FontClip:$$};},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0};},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g;},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g;}]),$i.__init$=function(){$i._regs(),$l=function(){function $J($J,$h,$f){this.comp=null,this.prop=null,this.value=null,this.comp=$J,this.prop=$h,this.value=$f;}return $T($J,""),$J.prototype.exe=function($J){var $h=$G.getBindFun(this.value);this.comp[this.prop]=$h.call(this,$J);},$J;}();},$i;}()),$b=function($J){function $f($J,$h){void 0===$h&&($h=""),$f.__super.call(this,$J,$h);}$T($f,"laya.ui.CheckBox",$J);var $h=$f.prototype;return $h.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1;},$h.initialize=function(){$J.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0;},$k(0,$h,"dataSource",$J.prototype._$get_dataSource,function($J){"boolean"==typeof(this._dataSource=$J)?this.selected=$J:"string"==typeof $J?this.selected="true"===$J:$q.superSet($m,this,"dataSource",$J);}),$f;}($m),$v=function($J){function $h(){this._space=0,this._align="none",this._itemChanged=!1,$h.__super.call(this);}$T($h,"laya.ui.LayoutBox",$I);var $f=$h.prototype;return $f.addChild=function($J){return $J.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,$J);},$f.onResize=function($J){this._setItemChanged();},$f.addChildAt=function($J,$h){return $J.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,$J,$h);},$f.removeChild=function($J){return $J.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,$J);},$f.removeChildAt=function($J){return this.getChildAt($J).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,$J);},$f.refresh=function(){this._setItemChanged();},$f.changeItems=function(){this._itemChanged=!1;},$f.sortItem=function($J){$J&&$J.sort(function($J,$h){return $J.y-$h.y;});},$f._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems));},$k(0,$f,"space",function(){return this._space;},function($J){this._space=$J,this._setItemChanged();}),$k(0,$f,"align",function(){return this._align;},function($J){this._align=$J,this._setItemChanged();}),$h;}(),$$=function($h){function $f($J,$h){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,$f.__super.call(this),$J&&(this.skin=$J),$h&&(this.sheet=$h);}$T($f,"laya.ui.FontClip",$h);var $J=$f.prototype;return $J.createChildren=function(){this._bitmap=new $O(),this.on("loaded",this,this._onClipLoaded);},$J._onClipLoaded=function(){this.callLater(this.changeValue);},$J.changeValue=function(){var $J;if(this._sources&&this._valueArr&&(this.graphics.clear(!0),$J=this._sources[0])){var $h="horizontal"===this._direction;$h?(this._wordsW=this._valueArr.length*($J.sourceWidth+this.spaceX),this._wordsH=$J.sourceHeight):(this._wordsW=$J.sourceWidth,this._wordsH=($J.sourceHeight+this.spaceY)*this._valueArr.length);var $f=0;if(this._width)switch(this._align){case"center":$f=.5*(this._width-this._wordsW);break;case"right":$f=this._width-this._wordsW;break;default:$f=0;}for(var $n=0,$L=this._valueArr.length;$n<$L;$n++){var $T=this._indexMap[this._valueArr.charAt($n)];this.sources[$T]&&($J=this.sources[$T],$h?this.graphics.drawTexture($J,$f+$n*($J.sourceWidth+this.spaceX),0,$J.sourceWidth,$J.sourceHeight):this.graphics.drawTexture($J,0+$f,$n*($J.sourceHeight+this.spaceY),$J.sourceWidth,$J.sourceHeight));}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize));}},$J.destroy=function($J){void 0===$J&&($J=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),$h.prototype.destroy.call(this,$J);},$k(0,$J,"sheet",function(){return this._sheet;},function($J){$J+="";var $h=(this._sheet=$J).split(" ");this._clipX=String($h[0]).length,this.clipY=$h.length,this._indexMap={};for(var $f=0;$f<this._clipY;$f++)for(var $n=$h[$f].split(""),$L=0,$T=$n.length;$L<$T;$L++)this._indexMap[$n[$L]]=$f*this._clipX+$L;}),$k(0,$J,"height",$h.prototype._$get_height,function($J){$q.superSet($Z,this,"height",$J),this.callLater(this.changeValue);}),$k(0,$J,"direction",function(){return this._direction;},function($J){this._direction=$J,this.callLater(this.changeValue);}),$k(0,$J,"value",function(){return this._valueArr?this._valueArr:"";},function($J){$J+="",this._valueArr=$J,this.callLater(this.changeValue);}),$k(0,$J,"width",$h.prototype._$get_width,function($J){$q.superSet($Z,this,"width",$J),this.callLater(this.changeValue);}),$k(0,$J,"spaceX",function(){return this._spaceX;},function($J){this._spaceX=$J,"horizontal"===this._direction&&this.callLater(this.changeValue);}),$k(0,$J,"spaceY",function(){return this._spaceY;},function($J){this._spaceY=$J,"horizontal"!==this._direction&&this.callLater(this.changeValue);}),$k(0,$J,"align",function(){return this._align;},function($J){this._align=$J,this.callLater(this.changeValue);}),$k(0,$J,"measureWidth",function(){return this._wordsW;}),$k(0,$J,"measureHeight",function(){return this._wordsH;}),$f;}($Z),$M=function($J){function $h(){this.selectHandler=null,this.renderHandler=null,this.renderTwHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this._twSwitch=!0,this._twDone=!0,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new $i(),$h.__super.call(this);}$T($h,"laya.ui.List",$J);var $f=$h.prototype;return $q.imps($f,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),$f.destroy=function($J){void 0===$J&&($J=!0),this._content&&this._content.destroy($J),this._scrollBar&&this._scrollBar.destroy($J),laya.ui.Component.prototype.destroy.call(this,$J),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this._twSwitch=null,this._twDone=null,this.selectHandler=this.renderHandler=this.mouseHandler=this.renderTwHandler=null;},$f.createChildren=function(){this.addChild(this._content=new $I());},$f.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$q.superGet($I,this,"cacheAs")),$q.superSet($I,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd);},$f.onScrollEnd=function(){$q.superSet($I,this,"cacheAs",this._$P.cacheAs);},$f._removePreScrollBar=function(){var $J=this.removeChildByName("scrollBar");$J&&$J.destroy(!0);},$f.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var $J=this._getOneCell(),$h=$J.width+this._spaceX||1,$f=$J.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/$h):Math.ceil(this._width/$h)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/$f):Math.round(this._height/$f));var $n=this._width?this._width:$h*this.repeatX-this._spaceX,$L=this._height?this._height:$f*this.repeatY-this._spaceY;this._cellSize=this._isVertical?$f:$h,this._cellOffset=this._isVertical?$f*Math.max(this._repeatY2,this._repeatY)-$L-this._spaceY:$h*Math.max(this._repeatX2,this._repeatX)-$n-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=$L:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=$n),this.setContentSize($n,$L);var $T=this._isVertical?this.repeatX:this.repeatY,$k=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,$T,$k),this._createdLine=$k,this._array&&(this.array=this._array,this.runCallLater(this.renderItems));}},$f._getOneCell=function(){if(0===this._cells.length){var $J=this.createItem();if(this._offset.setTo($J.x,$J.y),this.cacheContent)return $J;this._cells.push($J);}return this._cells[0];},$f._createItems=function($J,$h,$f){var $n=this._content,$L=this._getOneCell(),$T=$L.width+this._spaceX,$k=$L.height+this._spaceY;if(this.cacheContent){var $u=new $I();$u.cacheAsBitmap=!0,$u.pos((this._isVertical?0:$J)*$T,(this._isVertical?$J:0)*$k),this._content.addChild($u),this._content.optimizeScrollRect=!0,$n=$u;}else{for(var $S=[],$Y=this._cells.length-1;-1<$Y;$Y--){var $x=this._cells[$Y];$x.removeSelf(),$S.push($x);}this._cells.length=0;}for(var $j=$J;$j<$f;$j++)for(var $R=0;$R<$h;$R++)($L=$S&&$S.length?$S.pop():this.createItem()).x=(this._isVertical?$R:$j)*$T-$n.x,$L.y=(this._isVertical?$j:$R)*$k-$n.y,$L.name="item"+($j*$h+$R),$n.addChild($L),this.addCell($L);},$f.createItem=function(){var $J=[];if("function"==typeof this._itemRender)var $h=new this._itemRender();else $h=$H.createComp(this._itemRender,null,null,$J);if(0==$J.length&&$h._watchMap){var $f=$h._watchMap;for(var $n in $f)for(var $L=$f[$n],$T=0;$T<$L.length;$T++){var $k=$L[$T];$J.push($k.comp,$k.prop,$k.value);}}return $J.length&&($h._$bindData=$J),$h;},$f.addCell=function($J){$J.on("click",this,this.onCellMouse),$J.on("rightclick",this,this.onCellMouse),$J.on("mouseover",this,this.onCellMouse),$J.on("mouseout",this,this.onCellMouse),$J.on("mousedown",this,this.onCellMouse),$J.on("mouseup",this,this.onCellMouse),this._cells.push($J);},$f.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var $J=0,$h=$J=0;$h<1e4;$h++){var $f=this.getChildByName("item"+$h);if(!$f)break;this.addCell($f),$J++;}this.repeatY=$J;}},$f.setContentSize=function($J,$h){this._content.width=$J,this._content.height=$h,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new $r()),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,$J,$h),this._content.scrollRect=this._content.scrollRect),this.event("resize");},$f.onCellMouse=function($J){"mousedown"===$J.type&&(this._isMoved=!1);var $h=$J.currentTarget,$f=this._startIndex+this._cells.indexOf($h);$f<0||("click"===$J.type||"rightclick"===$J.type?this.selectEnable&&!this._isMoved?this.selectedIndex=$f:this.changeCellState($h,!0,0):"mouseover"!==$J.type&&"mouseout"!==$J.type||this._selectedIndex===$f||this.changeCellState($h,"mouseover"===$J.type,0),this.mouseHandler&&this.mouseHandler.runWith([$J,$f]));},$f.changeCellState=function($J,$h,$f){var $n=$J.getChildByName("selectBox");$n&&(this.selectEnable=!0,$n.visible=$h,$n.index=$f);},$f.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange);},$f.onScrollBarChange=function($J){this.runCallLater(this.changeCells);var $h=this._scrollBar.value,$f=this._isVertical?this.repeatX:this.repeatY,$n=this._isVertical?this.repeatY:this.repeatX,$L=Math.floor($h/this._cellSize);if(this.cacheContent)$k=$n+1,this._createdLine-$L<$k&&(this._createItems(this._createdLine,$f,this._createdLine+$k),this.renderItems(this._createdLine*$f,0),this._createdLine+=$k);else{var $T=$L*$f,$k=0;if($T>this._startIndex){$k=$T-this._startIndex;var $u=!0,$S=this._startIndex+$f*($n+1);this._isMoved=!0;}else $T<this._startIndex&&($k=this._startIndex-$T,$u=!1,$S=this._startIndex-1,this._isMoved=!0);for(var $Y=0;$Y<$k;$Y++){if($u){var $x=this._cells.shift();this._cells[this._cells.length]=$x;var $j=$S+$Y;}else $x=this._cells.pop(),this._cells.unshift($x),$j=$S-$Y;var $R=Math.floor($j/$f)*this._cellSize;this._isVertical?$x.y=$R:$x.x=$R,this.renderItem($x,$j);}this._startIndex=$T,this.changeSelectStatus();}var $l=this._content.scrollRect;this._isVertical?($l.y=$h-this._offset.y,$l.x=-this._offset.x):($l.y=-this._offset.y,$l.x=$h-this._offset.x),this._content.scrollRect=$l;},$f.posCell=function($J,$h){if(this._scrollBar){var $f=this._isVertical?this.repeatX:this.repeatY,$n=(this._isVertical?this.repeatY:this.repeatX,Math.floor($h/$f)*this._cellSize);this._isVertical?$J.y=$n:$J.x=$n;}},$f.changeSelectStatus=function(){for(var $J=0,$h=this._cells.length;$J<$h;$J++)this.changeCellState(this._cells[$J],this._selectedIndex===this._startIndex+$J,1);},$f.renderItems=function($J,$h){void 0===$J&&($J=0),void 0===$h&&($h=0);for(var $f=$J,$n=$h||this._cells.length;$f<$n;$f++)this.renderItem(this._cells[$f],this._startIndex+$f);this.changeSelectStatus(),this._twDone=!0;},$f.renderItem=function($J,$h){this._array&&0<=$h&&$h<this._array.length?($J.visible=!0,$J._$bindData?($J._dataSource=this._array[$h],this._bindData($J,this._array[$h])):$J.dataSource=this._array[$h],this.cacheContent||this.posCell($J,$h),this.hasListener("render")&&this.event("render",[$J,$h]),this.renderHandler&&this.renderHandler.runWith([$J,$h]),this.renderTwHandler&&this.renderTwHandler.runWith([$J,$h])):($J.visible=!1,$J.dataSource=null);},$f._bindData=function($J,$h){for(var $f=$J._$bindData,$n=0,$L=$f.length;$n<$L;$n++){var $T=$f[$n++],$k=$f[$n++],$u=$f[$n],$S=$G.getBindFun($u);$T[$k]=$S.call(this,$h);}},$f.refresh=function(){this.array=this._array;},$f.getItem=function($J){return-1<$J&&$J<this._array.length?this._array[$J]:null;},$f.changeItem=function($J,$h){-1<$J&&$J<this._array.length&&(this._array[$J]=$h,$J>=this._startIndex&&$J<this._startIndex+this._cells.length&&this.renderItem(this.getCell($J),$J));},$f.setItem=function($J,$h){this.changeItem($J,$h);},$f.addItem=function($J){this._array.push($J),this.array=this._array;},$f.addItemAt=function($J,$h){this._array.splice($h,0,$J),this.array=this._array;},$f.deleteItem=function($J){this._array.splice($J,1),this.array=this._array;},$f.getCell=function($J){return this.runCallLater(this.changeCells),-1<$J&&this._cells?this._cells[($J-this._startIndex)%this._cells.length]:null;},$f.scrollTo=function($J){if(this._scrollBar){var $h=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor($J/$h)*this._cellSize;}else this.startIndex=$J;},$f.tweenTo=function($J,$h,$f){if(void 0===$h&&($h=200),this._scrollBar){var $n=this._isVertical?this.repeatX:this.repeatY;$Q.to(this._scrollBar,{value:Math.floor($J/$n)*this._cellSize},$h,null,$f,0,!0);}else this.startIndex=$J,$f&&$f.run();},$f._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells));},$f.commitMeasure=function(){this.runCallLater(this.changeCells);},$k(0,$f,"cacheAs",$J.prototype._$get_cacheAs,function($J){$q.superSet($I,this,"cacheAs",$J),this._scrollBar&&(this._$P.cacheAs=null,"none"!==$J?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart));}),$k(0,$f,"content",function(){return this._content;}),$k(0,$f,"height",$J.prototype._$get_height,function($J){$J!=this._height&&($q.superSet($I,this,"height",$J),this._setCellChanged());}),$k(0,$f,"itemRender",function(){return this._itemRender;},function($J){if(this._itemRender!=$J){this._itemRender=$J;for(var $h=this._cells.length-1;-1<$h;$h--)this._cells[$h].destroy();this._cells.length=0,this._setCellChanged();}}),$k(0,$f,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null;},function($J){this._removePreScrollBar();var $h=new $hJ();$h.name="scrollBar",$h.right=0,$J&&" "!=$J&&($h.skin=$J),this.scrollBar=$h,this.addChild($h),this._setCellChanged();}),$k(0,$f,"page",function(){return this._page;},function($J){this._page=$J,this._array&&(this._page=0<$J?$J:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY);}),$k(0,$f,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null;},function($J){this._removePreScrollBar();var $h=new $X();$h.name="scrollBar",$h.bottom=0,$J&&" "!=$J&&($h.skin=$J),this.scrollBar=$h,this.addChild($h),this._setCellChanged();}),$k(0,$f,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1;},function($J){this._repeatX=$J,this._setCellChanged();}),$k(0,$f,"scrollBar",function(){return this._scrollBar;},function($J){this._scrollBar!=$J&&(this._scrollBar=$J)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange));}),$k(0,$f,"width",$J.prototype._$get_width,function($J){$J!=this._width&&($q.superSet($I,this,"width",$J),this._setCellChanged());}),$k(0,$f,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1;},function($J){this._repeatY=$J,this._setCellChanged();}),$k(0,$f,"spaceX",function(){return this._spaceX;},function($J){this._spaceX=$J,this._setCellChanged();}),$k(0,$f,"spaceY",function(){return this._spaceY;},function($J){this._spaceY=$J,this._setCellChanged();}),$k(0,$f,"selectedIndex",function(){return this._selectedIndex;},function($J){this._selectedIndex!=$J&&(this._selectedIndex=$J,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith($J),this.startIndex=this._startIndex);}),$k(0,$f,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null;},function($J){this.selectedIndex=this._array.indexOf($J);}),$k(0,$f,"length",function(){return this._array?this._array.length:0;}),$k(0,$f,"selection",function(){return this.getCell(this._selectedIndex);},function($J){this.selectedIndex=this._startIndex+this._cells.indexOf($J);}),$k(0,$f,"startIndex",function(){return this._startIndex;},function($J){this._startIndex=0<$J?$J:0,this.callLater(this.renderItems);}),$k(0,$f,"twSwitch",function(){return this._twSwitch;},function($J){this._twSwitch=$J;}),$k(0,$f,"twDone",function(){return this._twDone;},function($J){this._twDone=$J;}),$k(0,$f,"array",function(){return this._array;},function($J){this.runCallLater(this.changeCells),this._array=$J||[];var $h=this._array.length;if(this.totalPage=Math.ceil($h/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<$h?this._selectedIndex:$h-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var $f=this._isVertical?this.repeatX:this.repeatY,$n=this._isVertical?this.repeatY:this.repeatX,$L=Math.ceil($h/$f);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=$n/$L,this._scrollBar.setScroll(0,($L-$n)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content;}}),$k(0,$f,"dataSource",$J.prototype._$get_dataSource,function($J){"number"==typeof(this._dataSource=$J)&&Math.floor($J)==$J||"string"==typeof $J?this.selectedIndex=parseInt($J):$J instanceof Array?this.array=$J:$q.superSet($I,this,"dataSource",$J);}),$k(0,$f,"cells",function(){return this.runCallLater(this.changeCells),this._cells;}),$h;}($I),$X=function($J){function $h(){$h.__super.call(this);}return $T($h,"laya.ui.HScrollBar",$J),$h.prototype.initialize=function(){$J.prototype.initialize.call(this),this.slider.isVertical=!1;},$h;}($a),$w=function($J){function $h(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,$h.__super.call(this),this.width=this.height=100;}$T($h,"laya.ui.Panel",$J);var $f=$h.prototype;return $f.destroy=function($J){void 0===$J&&($J=!0),laya.ui.Component.prototype.destroy.call(this,$J),this._content&&this._content.destroy($J),this._vScrollBar&&this._vScrollBar.destroy($J),this._hScrollBar&&this._hScrollBar.destroy($J),this._vScrollBar=null,this._hScrollBar=null,this._content=null;},$f.destroyChildren=function(){this._content.destroyChildren();},$f.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new $I());},$f.addChild=function($J){return $J.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild($J);},$f.onResize=function(){this._setScrollChanged();},$f.addChildAt=function($J,$h){return $J.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt($J,$h);},$f.removeChild=function($J){return $J.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild($J);},$f.removeChildAt=function($J){return this.getChildAt($J).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt($J);},$f.removeChildren=function($J,$h){return void 0===$J&&($J=0),void 0===$h&&($h=2147483647),this._content.removeChildren($J,$h),this._setScrollChanged(),this;},$f.getChildAt=function($J){return this._content.getChildAt($J);},$f.getChildByName=function($J){return this._content.getChildByName($J);},$f.getChildIndex=function($J){return this._content.getChildIndex($J);},$f.changeScroll=function(){this._scrollChanged=!1;var $J=this.contentWidth||1,$h=this.contentHeight||1,$f=this._vScrollBar,$n=this._hScrollBar,$L=$f&&$h>this._height,$T=$n&&$J>this._width,$k=$L?this._width-$f.width:this._width,$u=$T?this._height-$n.height:this._height;$f&&($f.x=this._width-$f.width,$f.y=0,$f.height=this._height-($T?$n.height:0),$f.scrollSize=Math.max(.033*this._height,1),$f.thumbPercent=$u/$h,$f.setScroll(0,$h-$u,$f.value)),$n&&($n.x=0,$n.y=this._height-$n.height,$n.width=this._width-($L?$f.width:0),$n.scrollSize=Math.max(.033*this._width,1),$n.thumbPercent=$k/$J,$n.setScroll(0,$J-$k,$n.value));},$f.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height);},$f.setContentSize=function($J,$h){var $f=this._content;$f.width=$J,$f.height=$h,$f.scrollRect||($f.scrollRect=new $r()),$f.scrollRect.setTo(0,0,$J,$h),$f.scrollRect=$f.scrollRect;},$f.onScrollBarChange=function($J){var $h=this._content.scrollRect;if($h){var $f=Math.round($J.value);$J.isVertical?$h.y=$f:$h.x=$f,this._content.scrollRect=$h;}},$f.scrollTo=function($J,$h){void 0===$J&&($J=0),void 0===$h&&($h=0),this.vScrollBar&&(this.vScrollBar.value=$h),this.hScrollBar&&(this.hScrollBar.value=$J);},$f.refresh=function(){this.changeScroll();},$f.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$q.superGet($I,this,"cacheAs")),$q.superSet($I,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd);},$f.onScrollEnd=function(){$q.superSet($I,this,"cacheAs",this._$P.cacheAs);},$f._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll));},$k(0,$f,"numChildren",function(){return this._content.numChildren;}),$k(0,$f,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null;},function($J){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new $X()),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=$J;}),$k(0,$f,"contentWidth",function(){for(var $J=0,$h=this._content.numChildren-1;-1<$h;$h--){var $f=this._content.getChildAt($h);$J=Math.max($f.x+$f.width*$f.scaleX,$J);}return $J;}),$k(0,$f,"contentHeight",function(){for(var $J=0,$h=this._content.numChildren-1;-1<$h;$h--){var $f=this._content.getChildAt($h);$J=Math.max($f.y+$f.height*$f.scaleY,$J);}return $J;}),$k(0,$f,"width",$J.prototype._$get_width,function($J){$q.superSet($I,this,"width",$J),this._setScrollChanged();}),$k(0,$f,"hScrollBar",function(){return this._hScrollBar;}),$k(0,$f,"content",function(){return this._content;}),$k(0,$f,"height",$J.prototype._$get_height,function($J){$q.superSet($I,this,"height",$J),this._setScrollChanged();}),$k(0,$f,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null;},function($J){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new $hJ()),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=$J;}),$k(0,$f,"vScrollBar",function(){return this._vScrollBar;}),$k(0,$f,"cacheAs",$J.prototype._$get_cacheAs,function($J){$q.superSet($I,this,"cacheAs",$J),this._$P.cacheAs=null,"none"!==$J?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart));}),$h;}($I),$E=function($J){function $h($J){$h.__super.call(this,$J),this.isVertical=!1;}return $T($h,"laya.ui.HSlider",$B),$h;}(),$N=function($J){function $f($J,$h){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,$f.__super.call(this),this.skin=$h,this.labels=$J;}$T($f,"laya.ui.UIGroup",$J);var $h=$f.prototype;return $q.imps($h,{"laya.ui.IItem":!0}),$h.preinitialize=function(){this.mouseEnabled=!0;},$h.destroy=function($J){void 0===$J&&($J=!0),laya.ui.Component.prototype.destroy.call(this,$J),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null;},$h.addItem=function($J,$h){void 0===$h&&($h=!0);var $f=$J,$n=this._items.length;if($f.name="item"+$n,this.addChild($f),this.initItems(),$h&&0<$n){var $L=this._items[$n-1];"horizontal"==this._direction?$f.x=$L.x+$L.width+this._space:$f.y=$L.y+$L.height+this._space;}else $h&&($f.x=0,$f.y=0);return $n;},$h.delItem=function($J,$h){void 0===$h&&($h=!0);var $f=this._items.indexOf($J);if(-1!=$f){var $n=$J;this.removeChild($n);for(var $L=$f+1,$T=this._items.length;$L<$T;$L++){var $k=this._items[$L];$k.name="item"+($L-1),$h&&("horizontal"==this._direction?$k.x-=$n.width+this._space:$k.y-=$n.height+this._space);}if(this.initItems(),-1<this._selectedIndex){var $u;$u=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=$u;}}},$h.initItems=function(){this._items||(this._items=[]);for(var $J=this._items.length=0;$J<1e4;$J++){var $h=this.getChildByName("item"+$J);if(null==$h)break;this._items.push($h),$h.selected=$J===this._selectedIndex,$h.clickHandler=$R.create(this,this.itemClick,[$J],!1);}},$h.itemClick=function($J){this.selectedIndex=$J;},$h.setSelect=function($J,$h){this._items&&-1<$J&&$J<this._items.length&&(this._items[$J].selected=$h);},$h.createItem=function($J,$h){return null;},$h.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var $J=0,$h=0,$f=this._items.length;$h<$f;$h++){var $n=this._items[$h];this._skin&&($n.skin=this._skin),this._labelColors&&($n.labelColors=this._labelColors),this._labelSize&&($n.labelSize=this._labelSize),this._labelStroke&&($n.labelStroke=this._labelStroke),this._labelStrokeColor&&($n.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&($n.strokeColors=this._strokeColors),this._labelBold&&($n.labelBold=this._labelBold),this._labelPadding&&($n.labelPadding=this._labelPadding),this._labelAlign&&($n.labelAlign=this._labelAlign),this._stateNum&&($n.stateNum=this._stateNum),this._labelFont&&($n.labelFont=this._labelFont),"horizontal"===this._direction?($n.y=0,$n.x=$J,$J+=$n.width+this._space):($n.x=0,$n.y=$J,$J+=$n.height+this._space);}this.changeSize();},$h.commitMeasure=function(){this.runCallLater(this.changeLabels);},$h._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels));},$k(0,$h,"labelStrokeColor",function(){return this._labelStrokeColor;},function($J){this._labelStrokeColor!=$J&&(this._labelStrokeColor=$J,this._setLabelChanged());}),$k(0,$h,"skin",function(){return this._skin;},function($J){this._skin!=$J&&(this._skin=$J,this._setLabelChanged());}),$k(0,$h,"selectedIndex",function(){return this._selectedIndex;},function($J){this._selectedIndex!=$J&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$J,this.setSelect($J,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex));}),$k(0,$h,"labels",function(){return this._labels;},function($J){if(this._labels!=$J){if(this._labels=$J,this.removeChildren(),this._setLabelChanged(),this._labels)for(var $h=this._labels.split(","),$f=0,$n=$h.length;$f<$n;$f++){var $L=this.createItem(this._skin,$h[$f]);$L.name="item"+$f,this.addChild($L);}this.initItems();}}),$k(0,$h,"strokeColors",function(){return this._strokeColors;},function($J){this._strokeColors!=$J&&(this._strokeColors=$J,this._setLabelChanged());}),$k(0,$h,"labelColors",function(){return this._labelColors;},function($J){this._labelColors!=$J&&(this._labelColors=$J,this._setLabelChanged());}),$k(0,$h,"labelStroke",function(){return this._labelStroke;},function($J){this._labelStroke!=$J&&(this._labelStroke=$J,this._setLabelChanged());}),$k(0,$h,"labelSize",function(){return this._labelSize;},function($J){this._labelSize!=$J&&(this._labelSize=$J,this._setLabelChanged());}),$k(0,$h,"stateNum",function(){return this._stateNum;},function($J){this._stateNum!=$J&&(this._stateNum=$J,this._setLabelChanged());}),$k(0,$h,"labelBold",function(){return this._labelBold;},function($J){this._labelBold!=$J&&(this._labelBold=$J,this._setLabelChanged());}),$k(0,$h,"labelFont",function(){return this._labelFont;},function($J){this._labelFont!=$J&&(this._labelFont=$J,this._setLabelChanged());}),$k(0,$h,"labelPadding",function(){return this._labelPadding;},function($J){this._labelPadding!=$J&&(this._labelPadding=$J,this._setLabelChanged());}),$k(0,$h,"direction",function(){return this._direction;},function($J){this._direction=$J,this._setLabelChanged();}),$k(0,$h,"space",function(){return this._space;},function($J){this._space=$J,this._setLabelChanged();}),$k(0,$h,"items",function(){return this._items;}),$k(0,$h,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null;},function($J){this.selectedIndex=this._items.indexOf($J);}),$k(0,$h,"dataSource",$J.prototype._$get_dataSource,function($J){"number"==typeof(this._dataSource=$J)&&Math.floor($J)==$J||"string"==typeof $J?this.selectedIndex=parseInt($J):$J instanceof Array?this.labels=$J.join(","):$q.superSet($I,this,"dataSource",$J);}),$f;}($I),$z=function($h){function $f($J,$h){this._value=null,void 0===$h&&($h=""),$f.__super.call(this,$J,$h);}$T($f,"laya.ui.Radio",$h);var $J=$f.prototype;return $J.destroy=function($J){void 0===$J&&($J=!0),$h.prototype.destroy.call(this,$J),this._value=null;},$J.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1;},$J.initialize=function(){$h.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick);},$J.onClick=function($J){this.selected=!0;},$k(0,$J,"value",function(){return null!=this._value?this._value:this.label;},function($J){this._value=$J;}),$f;}($m),$K=function($J){function $h(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,$h.__super.call(this),this.width=this.height=200;}$T($h,"laya.ui.Tree",$J);var $f=$h.prototype;return $q.imps($f,{"laya.ui.IRender":!0}),$f.destroy=function($J){void 0===$J&&($J=!0),laya.ui.Component.prototype.destroy.call(this,$J),this._list&&this._list.destroy($J),this._list=null,this._source=null,this._renderHandler=null;},$f.createChildren=function(){this.addChild(this._list=new $M()),this._list.renderHandler=$R.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange);},$f.onListChange=function($J){this.event("change");},$f.getArray=function(){var $J,$h=[];for(var $f in this._source)$J=this._source[$f],this.getParentOpenStatus($J)&&($J.x=this._spaceLeft*this.getDepth($J),$h.push($J));return $h;},$f.getDepth=function($J,$h){return void 0===$h&&($h=0),null==$J.nodeParent?$h:this.getDepth($J.nodeParent,$h+1);},$f.getParentOpenStatus=function($J){var $h=$J.nodeParent;return null==$h||!!$h.isOpen&&(null==$h.nodeParent||this.getParentOpenStatus($h));},$f.renderItem=function($J,$h){var $f=$J.dataSource;if($f){$J.left=$f.x;var $n=$J.getChildByName("arrow");$n&&($f.hasChild?($n.visible=!0,$n.index=$f.isOpen?1:0,$n.tag=$h,$n.off("click",this,this.onArrowClick),$n.on("click",this,this.onArrowClick)):$n.visible=!1);var $L=$J.getChildByName("folder");$L&&(2==$L.clipY?$L.index=$f.isDirectory?0:1:$L.index=$f.isDirectory?$f.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([$J,$h]);}},$f.onArrowClick=function($J){var $h=$J.currentTarget.tag;this._list.array[$h].isOpen=!this._list.array[$h].isOpen,this.event("open"),this._list.array=this.getArray();},$f.setItemState=function($J,$h){this._list.array[$J]&&(this._list.array[$J].isOpen=$h,this._list.array=this.getArray());},$f.fresh=function(){this._list.array=this.getArray(),this.repaint();},$f.parseXml=function($J,$h,$f,$n){var $L,$T=$J.childNodes,$k=$T.length;if(!$n){$L={};var $u,$S=$J.attributes;for(var $Y in $S){var $x=($u=$S[$Y]).nodeName,$j=$u.nodeValue;$L[$x]="true"==$j||"false"!=$j&&$j;}$L.nodeParent=$f,0<$k&&($L.isDirectory=!0),$L.hasChild=0<$k,$h.push($L);}for(var $R=0;$R<$k;$R++){var $l=$T[$R];this.parseXml($l,$h,$L,!1);}},$f.parseOpenStatus=function($J,$h){for(var $f=0,$n=$h.length;$f<$n;$f++){var $L=$h[$f];if($L.isDirectory)for(var $T=0,$k=$J.length;$T<$k;$T++){var $u=$J[$T];if($u.isDirectory&&this.isSameParent($u,$L)&&$L.label==$u.label){$L.isOpen=$u.isOpen;break;}}}},$f.isSameParent=function($J,$h){return null==$J.nodeParent&&null==$h.nodeParent||null!=$J.nodeParent&&null!=$h.nodeParent&&$J.nodeParent.label==$h.nodeParent.label&&this.isSameParent($J.nodeParent,$h.nodeParent);},$f.filter=function($J){if(Boolean($J)){var $h=[];this.getFilterSource(this._source,$h,$J),this._list.array=$h;}else this._list.array=this.getArray();},$f.getFilterSource=function($J,$h,$f){var $n;for(var $L in $f=$f.toLocaleLowerCase(),$J)!($n=$J[$L]).isDirectory&&-1<String($n.label).toLowerCase().indexOf($f)&&($n.x=0,$h.push($n)),$n.child&&0<$n.child.length&&this.getFilterSource($n.child,$h,$f);},$k(0,$f,"spaceBottom",function(){return this._list.spaceY;},function($J){this._list.spaceY=$J;}),$k(0,$f,"keepStatus",function(){return this._keepStatus;},function($J){this._keepStatus=$J;}),$k(0,$f,"itemRender",function(){return this._list.itemRender;},function($J){this._list.itemRender=$J;}),$k(0,$f,"array",function(){return this._list.array;},function($J){this._keepStatus&&this._list.array&&$J&&this.parseOpenStatus(this._list.array,$J),this._source=$J,this._list.array=this.getArray();}),$k(0,$f,"mouseHandler",function(){return this._list.mouseHandler;},function($J){this._list.mouseHandler=$J;}),$k(0,$f,"dataSource",$J.prototype._$get_dataSource,function($J){this._dataSource=$J,$q.superSet($I,this,"dataSource",$J);}),$k(0,$f,"source",function(){return this._source;}),$k(0,$f,"scrollBar",function(){return this._list.scrollBar;}),$k(0,$f,"list",function(){return this._list;}),$k(0,$f,"scrollBarSkin",function(){return this._list.vScrollBarSkin;},function($J){this._list.vScrollBarSkin=$J;}),$k(0,$f,"renderHandler",function(){return this._renderHandler;},function($J){this._renderHandler=$J;}),$k(0,$f,"selectedIndex",function(){return this._list.selectedIndex;},function($J){this._list.selectedIndex=$J;}),$k(0,$f,"spaceLeft",function(){return this._spaceLeft;},function($J){this._spaceLeft=$J;}),$k(0,$f,"selectedItem",function(){return this._list.selectedItem;},function($J){this._list.selectedItem=$J;}),$k(0,$f,"width",$J.prototype._$get_width,function($J){$q.superSet($I,this,"width",$J),this._list.width=$J;}),$k(0,$f,"height",$J.prototype._$get_height,function($J){$q.superSet($I,this,"height",$J),this._list.height=$J;}),$k(0,$f,"xml",null,function($J){var $h=[];this.parseXml($J.childNodes[0],$h,null,!0),this.array=$h;}),$k(0,$f,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null;}),$h;}($I),$JJ=function($J){function $h(){this._items=null,this._selectedIndex=0,$h.__super.call(this),this._setIndexHandler=$R.create(this,this.setIndex,null,!1);}$T($h,"laya.ui.ViewStack",$J);var $f=$h.prototype;return $q.imps($f,{"laya.ui.IItem":!0}),$f.setItems=function($J){this.removeChildren();for(var $h=0,$f=0,$n=$J.length;$f<$n;$f++){var $L=$J[$f];$L&&($L.name="item"+$h,this.addChild($L),$h++);}this.initItems();},$f.addItem=function($J){$J.name="item"+this._items.length,this.addChild($J),this.initItems();},$f.initItems=function(){this._items=[];for(var $J=0;$J<1e4;$J++){var $h=this.getChildByName("item"+$J);if(null==$h)break;this._items.push($h),$h.visible=$J==this._selectedIndex;}},$f.setSelect=function($J,$h){this._items&&-1<$J&&$J<this._items.length&&(this._items[$J].visible=$h);},$f.setIndex=function($J){this.selectedIndex=$J;},$k(0,$f,"dataSource",$J.prototype._$get_dataSource,function($J){if("number"==typeof(this._dataSource=$J)&&Math.floor($J)==$J||"string"==typeof $J)this.selectedIndex=parseInt($J);else for(var $h in this._dataSource)this.hasOwnProperty($h)&&(this[$h]=this._dataSource[$h]);}),$k(0,$f,"selectedIndex",function(){return this._selectedIndex;},function($J){this._selectedIndex!=$J&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$J,this.setSelect(this._selectedIndex,!0));}),$k(0,$f,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null;},function($J){this.selectedIndex=this._items.indexOf($J);}),$k(0,$f,"items",function(){return this._items;}),$k(0,$f,"setIndexHandler",function(){return this._setIndexHandler;},function($J){this._setIndexHandler=$J;}),$h;}($I),$hJ=function($J){function $h(){$h.__super.call(this);}return $T($h,"laya.ui.VScrollBar",$a),$h;}(),$fJ=function($h){function $f($J){this._bg=null,this._skin=null,$f.__super.call(this),void 0===$J&&($J=""),this.text=$J,this.skin=this.skin;}$T($f,"laya.ui.TextInput",$h);var $J=$f.prototype;return $J.preinitialize=function(){this.mouseEnabled=!0;},$J.destroy=function($J){$_.clearCache(this,this._skin),void 0===$J&&($J=!0),$h.prototype.destroy.call(this,$J),this._bg&&this._bg.destroy(),this._bg=null;},$J.createChildren=function(){this.addChild(this._tf=new $l()),this._tf.padding=$A.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus);},$J._onFocus=function(){this.event("focus",this);},$J._onBlur=function(){this.event("blur",this);},$J._onInput=function(){this.event("input",this);},$J._onEnter=function(){this.event("enter",this);},$J.initialize=function(){this.width=128,this.height=22;},$J.select=function(){this._tf.select();},$J.setSelection=function($J,$h){this._tf.setSelection($J,$h);},$k(0,$J,"text",$h.prototype._$get_text,function($J){this._tf.text!=$J&&($J+="",this._tf.text=$J,this.event("change"));}),$k(0,$J,"bg",function(){return this._bg;},function($J){this.graphics=this._bg=$J;}),$k(0,$J,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster;},function($J){this._tf.inputElementYAdjuster=$J;}),$k(0,$J,"multiline",function(){return this._tf.multiline;},function($J){this._tf.multiline=$J;}),$k(0,$J,"skin",function(){return this._skin;},function($J){this._skin!=$J&&($_.clearCache(this,this._skin),this._skin=$J,this._bg||(this.graphics=this._bg=new $O()),$_.keepCache(this,this._skin),this._bg.source=$_.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height));}),$k(0,$J,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null;},function($J){this._bg||(this.graphics=this._bg=new $O()),this._bg.sizeGrid=$G.fillArray($A.defaultSizeGrid,$J,Number);}),$k(0,$J,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster;},function($J){this._tf.inputElementXAdjuster=$J;}),$k(0,$J,"width",$h.prototype._$get_width,function($J){$q.superSet($C,this,"width",$J),this._bg&&(this._bg.width=$J);}),$k(0,$J,"height",$h.prototype._$get_height,function($J){$q.superSet($C,this,"height",$J),this._bg&&(this._bg.height=$J);}),$k(0,$J,"editable",function(){return this._tf.editable;},function($J){this._tf.editable=$J;}),$k(0,$J,"restrict",function(){return this._tf.restrict;},function($J){this._tf.restrict=$J;}),$k(0,$J,"prompt",function(){return this._tf.prompt;},function($J){this._tf.prompt=$J;}),$k(0,$J,"promptColor",function(){return this._tf.promptColor;},function($J){this._tf.promptColor=$J;}),$k(0,$J,"maxChars",function(){return this._tf.maxChars;},function($J){this._tf.maxChars=$J;}),$k(0,$J,"focus",function(){return this._tf.focus;},function($J){this._tf.focus=$J;}),$k(0,$J,"type",function(){return this._tf.type;},function($J){this._tf.type=$J;}),$k(0,$J,"asPassword",function(){return this._tf.asPassword;},function($J){this._tf.asPassword=$J;}),$f;}($C),$nJ=function($J){function $h(){$h.__super.call(this);}return $T($h,"laya.ui.VSlider",$B),$h;}(),$LJ=function($J){function $n(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,$n.__super.call(this);}$T($n,"laya.ui.Dialog",$J);var $h=$n.prototype;return $h.initialize=function(){this.popupEffect=$n.manager.popupEffectHandler,this.closeEffect=$n.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick);},$h._dealDragArea=function(){var $J=this.getChildByName("drag");$J&&(this.dragArea=$J.x+","+$J.y+","+$J.width+","+$J.height,$J.removeSelf());},$h._onClick=function($J){var $h=$J.target;if($h)switch($h.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close($h.name);}},$h.show=function($J,$h){void 0===$J&&($J=!1),void 0===$h&&($h=!0),this._open(!1,$J,$h);},$h.popup=function($J,$h){void 0===$J&&($J=!1),void 0===$h&&($h=!0),this._open(!0,$J,$h);},$h._open=function($J,$h,$f){$n.manager.lock(!1),this.isModal=$J,$n.manager.open(this,$h,$f);},$h.onOpened=function(){},$h.close=function($J,$h){void 0===$h&&($h=!0),$n.manager.close(this,$J,$h);},$h.onClosed=function($J){},$h._onMouseDown=function($J){var $h=this.getMousePoint();this._dragArea.contains($h.x,$h.y)?this.startDrag():this.stopDrag();},$k(0,$h,"dragArea",function(){return this._dragArea?this._dragArea.toString():null;},function($J){if($J){var $h=$G.fillArray([0,0,0,0],$J,Number);this._dragArea=new $r($h[0],$h[1],$h[2],$h[3]),this.on("mousedown",this,this._onMouseDown);}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown);}),$k(0,$h,"isPopup",function(){return null!=this.parent;}),$k(0,$h,"zOrder",$J.prototype._$get_zOrder,function($J){$q.superSet($H,this,"zOrder",$J),$n.manager._checkMask();}),$k(1,$n,"manager",function(){return $n._manager=$n._manager||new $W();},function($J){$n._manager=$J;}),$n.setLockView=function($J){$n.manager.setLockView($J);},$n.lock=function($J){$n.manager.lock($J);},$n.closeAll=function(){$n.manager.closeAll();},$n.getDialogsByGroup=function($J){return $n.manager.getDialogsByGroup($J);},$n.closeByGroup=function($J){return $n.manager.closeByGroup($J);},$n.CLOSE="close",$n.CANCEL="cancel",$n.SURE="sure",$n.NO="no",$n.OK="ok",$n.YES="yes",$n._manager=null,$n;}($H),$TJ=function($J){function $h(){$h.__super.call(this);}$T($h,"laya.ui.HBox",$J);var $f=$h.prototype;return $f.sortItem=function($J){$J&&$J.sort(function($J,$h){return $J.x-$h.x;});},$f.changeItems=function(){this._itemChanged=!1;for(var $J=[],$h=0,$f=0,$n=this.numChildren;$f<$n;$f++){var $L=this.getChildAt($f);$L&&$L.layoutEnabled&&($J.push($L),$h=this._height?this._height:Math.max($h,$L.height*$L.scaleY));}this.sortItem($J);var $T=0;for($f=0,$n=$J.length;$f<$n;$f++)($L=$J[$f]).x=$T,$T+=$L.width*$L.scaleX+this._space,"top"==this._align?$L.y=0:"middle"==this._align?$L.y=.5*($h-$L.height*$L.scaleY):"bottom"==this._align&&($L.y=$h-$L.height*$L.scaleY);this.changeSize();},$k(0,$f,"height",$J.prototype._$get_height,function($J){this._height!=$J&&($q.superSet($v,this,"height",$J),this.callLater(this.changeItems));}),$h.NONE="none",$h.TOP="top",$h.MIDDLE="middle",$h.BOTTOM="bottom",$h;}($v),$kJ=function($J){function $h(){$h.__super.call(this);}$T($h,"laya.ui.VBox",$J);var $f=$h.prototype;return $f.changeItems=function(){this._itemChanged=!1;for(var $J=[],$h=0,$f=0,$n=this.numChildren;$f<$n;$f++){var $L=this.getChildAt($f);$L&&$L.layoutEnabled&&($J.push($L),$h=this._width?this._width:Math.max($h,$L.width*$L.scaleX));}this.sortItem($J);var $T=0;for($f=0,$n=$J.length;$f<$n;$f++)($L=$J[$f]).y=$T,$T+=$L.height*$L.scaleY+this._space,"left"==this._align?$L.x=0:"center"==this._align?$L.x=.5*($h-$L.width*$L.scaleX):"right"==this._align&&($L.x=$h-$L.width*$L.scaleX);this.changeSize();},$k(0,$f,"width",$J.prototype._$get_width,function($J){this._width!=$J&&($q.superSet($v,this,"width",$J),this.callLater(this.changeItems));}),$h.NONE="none",$h.LEFT="left",$h.CENTER="center",$h.RIGHT="right",$h;}($v),$uJ=function($J){function $h(){$h.__super.call(this);}return $T($h,"laya.ui.RadioGroup",$N),$h.prototype.createItem=function($J,$h){return new $z($J,$h);},$h;}(),$SJ=function($J){function $h(){$h.__super.call(this);}return $T($h,"laya.ui.Tab",$N),$h.prototype.createItem=function($J,$h){return new $m($J,$h);},$h;}(),$YJ=function($h){function $f($J){this._vScrollBar=null,this._hScrollBar=null,void 0===$J&&($J=""),$f.__super.call(this,$J);}$T($f,"laya.ui.TextArea",$h);var $J=$f.prototype;return $J.destroy=function($J){void 0===$J&&($J=!0),$h.prototype.destroy.call(this,$J),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null;},$J.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0;},$J.onVBarChanged=function($J){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value);},$J.onHBarChanged=function($J){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value);},$J.changeScroll=function(){var $J=this._vScrollBar&&0<this._tf.maxScrollY,$h=this._hScrollBar&&0<this._tf.maxScrollX,$f=$J?this._width-this._vScrollBar.width:this._width,$n=$h?this._height-this._hScrollBar.height:this._height,$L=this._tf.padding||$A.labelPadding;this._tf.width=$f,this._tf.height=$n,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-$L[2],this._vScrollBar.y=$L[1],this._vScrollBar.height=this._height-($h?this._hScrollBar.height:0)-$L[1]-$L[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=$n/Math.max(this._tf.textHeight,$n),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=$J),this._hScrollBar&&(this._hScrollBar.x=$L[0],this._hScrollBar.y=this._height-this._hScrollBar.height-$L[3],this._hScrollBar.width=this._width-($J?this._vScrollBar.width:0)-$L[0]-$L[2],this._hScrollBar.scrollSize=Math.max(.033*$f,1),this._hScrollBar.thumbPercent=$f/Math.max(this._tf.textWidth,$f),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=$h);},$J.scrollTo=function($J){this.commitMeasure(),this._tf.scrollY=$J;},$k(0,$J,"scrollY",function(){return this._tf.scrollY;}),$k(0,$J,"width",$h.prototype._$get_width,function($J){$q.superSet($fJ,this,"width",$J),this.callLater(this.changeScroll);}),$k(0,$J,"hScrollBar",function(){return this._hScrollBar;}),$k(0,$J,"height",$h.prototype._$get_height,function($J){$q.superSet($fJ,this,"height",$J),this.callLater(this.changeScroll);}),$k(0,$J,"maxScrollX",function(){return this._tf.maxScrollX;}),$k(0,$J,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null;},function($J){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new $hJ()),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=$J;}),$k(0,$J,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null;},function($J){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new $X()),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=$J;}),$k(0,$J,"vScrollBar",function(){return this._vScrollBar;}),$k(0,$J,"maxScrollY",function(){return this._tf.maxScrollY;}),$k(0,$J,"scrollX",function(){return this._tf.scrollX;}),$f;}($fJ);!function($J){function $h(){this._uiView=null,this.isCloseOther=!1,$h.__super.call(this);}$T($h,"laya.ui.AsynDialog",$LJ);var $f=$h.prototype;$f.createView=function($J){this._uiView=$J;},$f._open=function($J,$h,$f){this.isModal=$J,this.isCloseOther=$h,$LJ.manager.lock(!0),this._uiView?this.onCreated():this.onOpen();},$f.onCreated=function(){this.createUI(),this.onOpen();},$f.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea();},$f.onOpen=function(){$LJ.manager.open(this,this.isCloseOther),$LJ.manager.lock(!1);},$f.close=function($J,$h){void 0===$h&&($h=!0),$LJ.manager.close(this),this.onClose();},$f.onClose=function(){},$f.destroy=function($J){void 0===$J&&($J=!0),laya.ui.View.prototype.destroy.call(this,$J),this._uiView=null,this.onDestroy();},$f.onDestroy=function(){};}();$q.__init([$H]);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($J,$h){"use strict";for(var $f in Object.defineProperty($h,"__esModule",{value:!0}),Laya){var $n=Laya[$f];$n&&$n.__isclass&&($h[$f]=$n);}}),function($R,$J,$p){$p.un,$p.uns;var $j=$p.static,$l=$p.class,$i=$p.getset,$n=$p.__newvec,$d=laya.maths.Arith,$k=laya.webgl.atlas.AtlasResourceManager,$f=laya.webgl.shader.BaseShader,$P=laya.utils.Browser,$u=laya.webgl.utils.Buffer,$U=laya.utils.Byte,$L=laya.utils.ClassUtils,$S=$p.Config,$T=(laya.events.Event,laya.events.EventDispatcher),$A=laya.utils.Handler,$r=laya.net.Loader,$h=laya.net.LoaderManager,$Y=(laya.maths.MathUtil,laya.display.Node),$q=laya.renders.Render,$x=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),$o=laya.resource.Resource,$_=laya.utils.RunDriver,$s=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),$Q=laya.display.Sprite,$D=laya.utils.Stat,$g=laya.utils.StringKey,$G=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),$F=laya.utils.Utils,$y=laya.webgl.WebGL,$O=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;$p.interface("laya.d3.core.IClone"),$p.interface("laya.d3.graphics.IVertex"),$p.interface("laya.d3.core.render.IUpdate"),$p.interface("laya.d3.core.scene.ITreeNode"),$p.interface("laya.d3.core.render.IRenderable");(function(){function $m(){}$l($m,"laya.d3.animation.AnimationClipParser01"),$m.READ_DATA=function(){$m._DATA.offset=$m._reader.getUint32(),$m._DATA.size=$m._reader.getUint32();},$m.READ_BLOCK=function(){for(var $J=$m._BLOCK.count=$m._reader.getUint16(),$h=$m._BLOCK.blockStarts=[],$f=$m._BLOCK.blockLengths=[],$n=0;$n<$J;$n++)$h.push($m._reader.getUint32()),$f.push($m._reader.getUint32());},$m.READ_STRINGS=function(){var $J=$m._reader.getUint32(),$h=$m._reader.getUint16(),$f=$m._reader.pos;$m._reader.pos=$J+$m._DATA.offset;for(var $n=0;$n<$h;$n++)$m._strings[$n]=$m._reader.readUTFString();$m._reader.pos=$f;},$m.parse=function($J,$h){$m._animationClip=$J;($m._reader=$h).__getBuffer();$m.READ_DATA(),$m.READ_BLOCK(),$m.READ_STRINGS();for(var $f=0,$n=$m._BLOCK.count;$f<$n;$f++){var $L=$h.getUint16(),$T=$m._strings[$L],$k=$m["READ_"+$T];if(null==$k)throw new Error("model file err,no this function:"+$L+" "+$T);$k.call();}},$m.READ_ANIMATIONS=function(){var $J,$h=0,$f=0,$n=$m._reader,$L=$n.__getBuffer(),$T=[],$k=$n.getUint8();for($T.length=$k,$h=0;$h<$k;$h++)$T[$h]=$n.getUint16();var $u=[],$S=$n.getUint16();for($u.length=$S,$h=0;$h<$S;$h++)$u[$h]=$n.getFloat32();var $Y=$m._animationClip;$Y.name=$m._strings[$n.getUint16()];var $x=$Y._duration=$n.getFloat32();$Y.islooping=!!$n.getByte(),$Y._frameRate=$n.getInt16();var $j=$n.getInt16(),$R=$Y._nodes=[];$R.length=$j,($Y._publicClipDatas=[]).length=$j;var $l=$Y._nodesMap={},$i=0,$q=0;for($h=0;$h<$j;$h++){$J=$R[$h]=new $e();var $o=$n.getUint16(),$r=$J.path=[];for($r.length=$o,$f=0;$f<$o;$f++)$r[$f]=$m._strings[$n.getUint16()];var $_=$r.join("/"),$s=$l[$_];$s||($l[$_]=$s=[]),$s.push($J);var $d=$n.getInt16();-1!==$d&&($J.componentType=$m._strings[$d]);var $p=$V._propertyIndexDic[$m._strings[$n.getUint16()]];if(null==$p)throw new Error("AnimationClipParser01:unknown property name.");var $U=$p<4,$Q=!$U||$U&&""===$r[0];($J._cacheProperty=$Q)?$i++:$q++,$J.propertyNameID=$p;var $D=$T[$n.getUint8()];$J.keyFrameWidth=$D/4;var $g=$J.keyFrames=[],$F=$g.length=$n.getUint16(),$A=null,$G=NaN;for($f=0;$f<$F;$f++){var $y=$g[$f]=new $C();$G=$y.startTime=$u[$n.getUint16()];var $O=$n.pos;$y.inTangent=new Float32Array($L.slice($O,$O+$D)),$n.pos+=$D,$O=$n.pos,$y.outTangent=new Float32Array($L.slice($O,$O+$D)),$n.pos+=$D,$O=$n.pos,$y.data=new Float32Array($L.slice($O,$O+$D)),$n.pos+=$D,$A&&($A.next=$y,$A.duration=$G-$A.startTime),$A=$y;}$y.next=null,$y.duration=$x-$G;}var $P=$Y._nodeToCachePropertyMap=new Int32Array($j),$W=$Y._cachePropertyMap=new Int32Array($i),$I=$Y._unCachePropertyMap=new Int32Array($q);for($i=$q=0,$h=0;$h<$j;$h++)($J=$R[$h])._cacheProperty?($P[$h]=$i,$W[$i++]=$h):$I[$q++]=$h;},$m._animationClip=null,$m._reader=null,$m._strings=[],$j($m,["_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]);})(),function(){function $a(){}$l($a,"laya.d3.animation.AnimationClipParser02"),$a.READ_DATA=function(){$a._DATA.offset=$a._reader.getUint32(),$a._DATA.size=$a._reader.getUint32();},$a.READ_BLOCK=function(){for(var $J=$a._BLOCK.count=$a._reader.getUint16(),$h=$a._BLOCK.blockStarts=[],$f=$a._BLOCK.blockLengths=[],$n=0;$n<$J;$n++)$h.push($a._reader.getUint32()),$f.push($a._reader.getUint32());},$a.READ_STRINGS=function(){var $J=$a._reader.getUint32(),$h=$a._reader.getUint16(),$f=$a._reader.pos;$a._reader.pos=$J+$a._DATA.offset;for(var $n=0;$n<$h;$n++)$a._strings[$n]=$a._reader.readUTFString();$a._reader.pos=$f;},$a.parse=function($J,$h){$a._animationClip=$J;($a._reader=$h).__getBuffer();$a.READ_DATA(),$a.READ_BLOCK(),$a.READ_STRINGS();for(var $f=0,$n=$a._BLOCK.count;$f<$n;$f++){var $L=$h.getUint16(),$T=$a._strings[$L],$k=$a["READ_"+$T];if(null==$k)throw new Error("model file err,no this function:"+$L+" "+$T);$k.call();}},$a.READ_ANIMATIONS=function(){var $J,$h=0,$f=0,$n=$a._reader,$L=$n.__getBuffer(),$T=[],$k=$n.getUint8();for($T.length=$k,$h=0;$h<$k;$h++)$T[$h]=$n.getUint16();var $u=[],$S=$n.getUint16();for($u.length=$S,$h=0;$h<$S;$h++)$u[$h]=$n.getFloat32();var $Y=$a._animationClip;$Y.name=$a._strings[$n.getUint16()];var $x=$Y._duration=$n.getFloat32();$Y.islooping=!!$n.getByte(),$Y._frameRate=$n.getInt16();var $j=$n.getInt16(),$R=$Y._nodes=[];$R.length=$j,($Y._publicClipDatas=[]).length=$j;var $l=$Y._nodesMap={},$i=0,$q=0;for($h=0;$h<$j;$h++){$J=$R[$h]=new $e();var $o=$n.getUint16(),$r=$J.path=[];for($r.length=$o,$f=0;$f<$o;$f++)$r[$f]=$a._strings[$n.getUint16()];var $_=$r.join("/"),$s=$l[$_];$s||($l[$_]=$s=[]),$s.push($J);var $d=$n.getInt16();-1!==$d&&($J.componentType=$a._strings[$d]);var $p=$V._propertyIndexDic[$a._strings[$n.getUint16()]];if(null==$p)throw new Error("AnimationClipParser02:unknown property name.");var $U=$p<4,$Q=!$U||$U&&""===$r[0];($J._cacheProperty=$Q)?$i++:$q++,$J.propertyNameID=$p;var $D=$T[$n.getUint8()];$J.keyFrameWidth=$D/4;var $g=$J.keyFrames=[],$F=$g.length=$n.getUint16(),$A=null,$G=NaN;for($f=0;$f<$F;$f++){var $y=$g[$f]=new $C();$G=$y.startTime=$u[$n.getUint16()];var $O=$n.pos;$y.inTangent=new Float32Array($L.slice($O,$O+$D)),$n.pos+=$D,$O=$n.pos,$y.outTangent=new Float32Array($L.slice($O,$O+$D)),$n.pos+=$D,$O=$n.pos,$y.data=new Float32Array($L.slice($O,$O+$D)),$n.pos+=$D,$A&&($A.next=$y,$A.duration=$G-$A.startTime),$A=$y;}$y.next=null,$y.duration=$x-$G;}var $P=$n.getUint16();for($h=0;$h<$P;$h++){var $W,$I=new $B();$I.time=$n.getFloat32(),$I.eventName=$a._strings[$n.getUint16()];var $m=$n.getUint16();for(0<$m&&($I.params=$W=[]),$f=0;$f<$m;$f++){switch($n.getByte()){case 0:$W.push(!!$n.getByte());break;case 1:$W.push($n.getInt32());break;case 2:$W.push($n.getFloat32());break;case 3:$W.push($a._strings[$n.getUint16()]);break;default:throw new Error("unknown type.");}}$Y.addEvent($I);}var $Z=$Y._nodeToCachePropertyMap=new Int32Array($j),$t=$Y._cachePropertyMap=new Int32Array($i),$c=$Y._unCachePropertyMap=new Int32Array($q);for($i=$q=0,$h=0;$h<$j;$h++)($J=$R[$h])._cacheProperty?($Z[$h]=$i,$t[$i++]=$h):$c[$q++]=$h;},$a._animationClip=null,$a._reader=null,$a._strings=[],$j($a,["_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]);}();var $B=function(){function $J(){this.time=NaN,this.eventName=null,this.params=null;}return $l($J,"laya.d3.animation.AnimationEvent"),$J;}(),$V=function(){function $n(){this._childs=[],this.transform=new $_h(this);}$l($n,"laya.d3.animation.AnimationNode");var $J=$n.prototype;return $p.imps($J,{"laya.d3.core.IClone":!0}),$J.addChild=function($J){$J._parent=this,$J.transform.setParent(this.transform),this._childs.push($J);},$J.removeChild=function($J){var $h=this._childs.indexOf($J);-1!==$h&&this._childs.splice($h,1);},$J.getChildByName=function($J){for(var $h=0,$f=this._childs.length;$h<$f;$h++){var $n=this._childs[$h];if($n.name===$J)return $n;}return null;},$J.getChildByIndex=function($J){return this._childs[$J];},$J.getChildCount=function(){return this._childs.length;},$J.cloneTo=function($J){var $h=$J;$h.name=this.name;for(var $f=0,$n=this._childs.length;$f<$n;$f++){var $L=this._childs[$f],$T=$L.clone();$h.addChild($T);var $k=$L.transform,$u=$T.transform;$u.setLocalPosition($k.getLocalPosition()),$u.setLocalRotation($k.getLocalRotation()),$u.setLocalScale($k.getLocalScale()),$u._localRotationEuler=$k._localRotationEuler,$u._setWorldMatrixIgnoreUpdate($k.getWorldMatrix());}},$J.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$n.__init__=function(){$n.registerAnimationNodeProperty("localPosition",$n._getLocalPosition,$n._setLocalPosition),$n.registerAnimationNodeProperty("localRotation",$n._getLocalRotation,$n._setLocalRotation),$n.registerAnimationNodeProperty("localScale",$n._getLocalScale,$n._setLocalScale),$n.registerAnimationNodeProperty("localRotationEuler",$n._getLocalRotationEuler,$n._setLocalRotationEuler),$n.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",$n._getParticleRenderSharedMaterialTintColor,$n._setParticleRenderSharedMaterialTintColor),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",$n._getMeshRenderSharedMaterialTilingOffset,$n._setMeshRenderSharedMaterialTilingOffset),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",$n._getMeshRenderSharedMaterialAlbedo,$n._setMeshRenderSharedMaterialAlbedo),$n.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",$n._getSkinnedMeshRenderSharedMaterialTilingOffset,$n._setSkinnedMeshRenderSharedMaterialTilingOffset),$n.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",$n._getSkinnedMeshRenderSharedMaterialAlbedo,$n._setSkinnedMeshRenderSharedMaterialAlbedo),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",$n._getMeshRenderSharedMaterialAlbedo,$n._setMeshRenderSharedMaterialAlbedo),$n.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",$n._getSkinnedMeshRenderSharedMaterialAlbedo,$n._setSkinnedMeshRenderSharedMaterialAlbedo),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",$n._getMeshRenderSharedMaterialIntensity,$n._setMeshRenderSharedMaterialIntensity),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",$n._getMeshRenderSharedMaterialAlpha,$n._setMeshRenderSharedMaterialAlpha),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",$n._getMeshRenderSharedMaterialAlphaColor,$n._setMeshRenderSharedMaterialAlphaColor),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",$n._getMeshRenderSharedMaterialBaseColor,$n._setMeshRenderSharedMaterialBaseColor),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",$n._getMeshRenderSharedMaterialDissolve,$n._setMeshRenderSharedMaterialDissolve),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",$n._getMeshRenderSharedMaterialDissolveSpeed,$n._setMeshRenderSharedMaterialDissolveSpeed),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",$n._getMeshRenderSharedMaterialMMultiplier,$n._setMeshRenderSharedMaterialMMultiplier),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",$n._getMeshRenderSharedMaterialBaseScrollSpeedX,$n._setMeshRenderSharedMaterialBaseScrollSpeedX),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",$n._getMeshRenderSharedMaterialBaseScrollSpeedY,$n._setMeshRenderSharedMaterialBaseScrollSpeedY),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",$n._getMeshRenderSharedMaterialSecondScrollSpeedX,$n._setMeshRenderSharedMaterialSecondScrollSpeedX),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",$n._getMeshRenderSharedMaterialSecondScrollSpeedY,$n._setMeshRenderSharedMaterialSecondScrollSpeedY),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",$n._getMeshRenderSharedMaterialDetailTilingOffset,$n._setMeshRenderSharedMaterialDetailTilingOffset),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",$n._getMeshRenderSharedMaterialDissolveTilingOffset,$n._setMeshRenderSharedMaterialDissolveTilingOffset),$n.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",$n._getMeshRenderSharedMaterialMaskTilingOffset,$n._setMeshRenderSharedMaterialMaskTilingOffset);},$n.registerAnimationNodeProperty=function($J,$h,$f){if($n._propertyIndexDic[$J])throw new Error("AnimationNode: this propertyName has registered.");$n._propertyIndexDic[$J]=$n._propertyIDCounter,$n._propertyGetFuncs[$n._propertyIDCounter]=$h,$n._propertySetFuncs[$n._propertyIDCounter]=$f,$n._propertyIDCounter++;},$n._getLocalPosition=function($J,$h){return $J?$J.transform.getLocalPosition():$h._transform.localPosition.elements;},$n._setLocalPosition=function($J,$h,$f){if($J)$J.transform.setLocalPosition($f);else{var $n=$h._transform,$L=$n.localPosition;$L.elements=$f,$n.localPosition=$L;}},$n._getLocalRotation=function($J,$h){return $J?$J.transform.getLocalRotation():$h._transform.localRotation.elements;},$n._setLocalRotation=function($J,$h,$f){if($J)$J.transform.setLocalRotation($f);else{var $n=$h._transform,$L=$n.localRotation;$L.elements=$f,$n.localRotation=$L;}},$n._getLocalScale=function($J,$h){return $J?$J.transform.getLocalScale():$h._transform.localScale.elements;},$n._setLocalScale=function($J,$h,$f){if($J)$J.transform.setLocalScale($f);else{var $n=$h._transform,$L=$n.localScale;$L.elements=$f,$n.localScale=$L;}},$n._getLocalRotationEuler=function($J,$h){return $J?$J.transform.getLocalRotationEuler():$h._transform.localRotationEuler.elements;},$n._setLocalRotationEuler=function($J,$h,$f){if($J)$J.transform.setLocalRotationEuler($f);else{var $n=$h._transform,$L=$n.localRotationEuler;$L.elements=$f,$n.localRotationEuler=$L;}},$n._getMeshRenderSharedMaterialTilingOffset=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.tilingOffset.elements:null;}return $h.meshRender.sharedMaterial.tilingOffset.elements;},$n._setMeshRenderSharedMaterialTilingOffset=function($J,$h,$f){var $n,$L;if($J){var $T=$J.transform._entity;$T&&(($L=($n=$T.owner.meshRender.material).tilingOffset).elements=$f,$n.tilingOffset=$L);}else($L=($n=$h.meshRender.material).tilingOffset).elements=$f,$n.tilingOffset=$L;},$n._getMeshRenderSharedMaterialAlbedo=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.albedoColor.elements:null;}return $h.meshRender.sharedMaterial.albedoColor.elements;},$n._setMeshRenderSharedMaterialAlbedo=function($J,$h,$f){var $n,$L;if($J){var $T=$J.transform._entity;$T&&(($L=($n=$T.owner.meshRender.material).albedoColor).elements=$f,$n.albedoColor=$L);}else($L=($n=$h.meshRender.material).albedoColor).elements=$f,$n.albedoColor=$L;},$n._getSkinnedMeshRenderSharedMaterialTilingOffset=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null;}return $h.skinnedMeshRender.sharedMaterial.tilingOffset.elements;},$n._setSkinnedMeshRenderSharedMaterialTilingOffset=function($J,$h,$f){var $n,$L;if($J){var $T=$J.transform._entity;$T&&(($L=($n=$T.owner.skinnedMeshRender.material).tilingOffset).elements=$f,$n.tilingOffset=$L);}else($L=($n=$h.skinnedMeshRender.material).tilingOffset).elements=$f,$n.tilingOffset=$L;},$n._getSkinnedMeshRenderSharedMaterialAlbedo=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null;}return $h.skinnedMeshRender.sharedMaterial.albedoColor.elements;},$n._setSkinnedMeshRenderSharedMaterialAlbedo=function($J,$h,$f){var $n,$L;if($J){var $T=$J.transform._entity;$T&&(($L=($n=$T.owner.skinnedMeshRender.material).albedoColor).elements=$f,$n.albedoColor=$L);}else($L=($n=$h.skinnedMeshRender.material).albedoColor).elements=$f,$n.albedoColor=$L;},$n._getParticleRenderSharedMaterialTintColor=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.particleRender.sharedMaterial.tintColor.elements:null;}return $h.particleRender.sharedMaterial.tintColor.elements;},$n._setParticleRenderSharedMaterialTintColor=function($J,$h,$f){var $n,$L;if($J){var $T=$J.transform._entity;$T&&(($L=($n=$T.owner.particleRender.material).tintColor).elements=$f,$n.tintColor=$L);}else($L=($n=$h.particleRender.material).tintColor).elements=$f,$n.tintColor=$L;},$n._getMeshRenderSharedMaterialAlphaColor=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.alphaColor.elements:null;}return $h.meshRender.sharedMaterial.alphaColor.elements;},$n._setMeshRenderSharedMaterialAlphaColor=function($J,$h,$f){var $n,$L;if($J){var $T=$J.transform._entity;$T&&(($L=($n=$T.owner.meshRender.material).alphaColor).elements=$f,$n.alphaColor=$L);}else($L=($n=$h.meshRender.material).alphaColor).elements=$f,$n.alphaColor=$L;},$n._getMeshRenderSharedMaterialBaseColor=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.baseColor.elements:null;}return $h.meshRender.sharedMaterial.baseColor.elements;},$n._setMeshRenderSharedMaterialBaseColor=function($J,$h,$f){var $n,$L;if($J){var $T=$J.transform._entity;$T&&(($L=($n=$T.owner.meshRender.material).baseColor).elements=$f,$n.baseColor=$L);}else($L=($n=$h.meshRender.material).baseColor).elements=$f,$n.baseColor=$L;},$n._getMeshRenderSharedMaterialDissolve=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.dissolve:0;}return $h.meshRender.sharedMaterial.dissolve;},$n._setMeshRenderSharedMaterialDissolve=function($J,$h,$f){if($J){var $n=$J.transform._entity;$n&&($n.owner.meshRender.material.dissolve=$f[0]);}else $h.meshRender.material.dissolve=$f[0];},$n._getMeshRenderSharedMaterialDissolveSpeed=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.dissolveSpeed:0;}return $h.meshRender.sharedMaterial.dissolveSpeed;},$n._setMeshRenderSharedMaterialDissolveSpeed=function($J,$h,$f){if($J){var $n=$J.transform._entity;$n&&($n.owner.meshRender.material.dissolveSpeed=$f[0]);}else $h.meshRender.material.dissolveSpeed=$f[0];},$n._getMeshRenderSharedMaterialMMultiplier=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.mMultiplier:0;}return $h.meshRender.sharedMaterial.mMultiplier;},$n._setMeshRenderSharedMaterialMMultiplier=function($J,$h,$f){if($J){var $n=$J.transform._entity;$n&&($n.owner.meshRender.material.mMultiplier=$f[0]);}else $h.meshRender.material.mMultiplier=$f[0];},$n._getMeshRenderSharedMaterialBaseScrollSpeedX=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.baseScrollSpeedX:0;}return $h.meshRender.sharedMaterial.baseScrollSpeedX;},$n._setMeshRenderSharedMaterialBaseScrollSpeedX=function($J,$h,$f){if($J){var $n=$J.transform._entity;$n&&($n.owner.meshRender.material.baseScrollSpeedX=$f[0]);}else $h.meshRender.material.baseScrollSpeedX=$f[0];},$n._getMeshRenderSharedMaterialBaseScrollSpeedY=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.baseScrollSpeedY:0;}return $h.meshRender.sharedMaterial.baseScrollSpeedY;},$n._setMeshRenderSharedMaterialBaseScrollSpeedY=function($J,$h,$f){if($J){var $n=$J.transform._entity;$n&&($n.owner.meshRender.material.baseScrollSpeedY=$f[0]);}else $h.meshRender.material.baseScrollSpeedY=$f[0];},$n._getMeshRenderSharedMaterialSecondScrollSpeedX=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.secondScrollSpeedX:0;}return $h.meshRender.sharedMaterial.secondScrollSpeedX;},$n._setMeshRenderSharedMaterialSecondScrollSpeedX=function($J,$h,$f){if($J){var $n=$J.transform._entity;$n&&($n.owner.meshRender.material.secondScrollSpeedX=$f[0]);}else $h.meshRender.material.secondScrollSpeedX=$f[0];},$n._getMeshRenderSharedMaterialSecondScrollSpeedY=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.secondScrollSpeedY:0;}return $h.meshRender.sharedMaterial.secondScrollSpeedY;},$n._setMeshRenderSharedMaterialSecondScrollSpeedY=function($J,$h,$f){if($J){var $n=$J.transform._entity;$n&&($n.owner.meshRender.material.secondScrollSpeedY=$f[0]);}else $h.meshRender.material.secondScrollSpeedY=$f[0];},$n._getMeshRenderSharedMaterialAlpha=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.alpha:0;}return $h.meshRender.sharedMaterial.alpha;},$n._setMeshRenderSharedMaterialAlpha=function($J,$h,$f){if($J){var $n=$J.transform._entity;$n&&($n.owner.meshRender.material.alpha=$f[0]);}else $h.meshRender.material.alpha=$f[0];},$n._getMeshRenderSharedMaterialIntensity=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.intensity:0;}return $h.meshRender.sharedMaterial.intensity;},$n._setMeshRenderSharedMaterialIntensity=function($J,$h,$f){if($J){var $n=$J.transform._entity;$n&&($n.owner.meshRender.material.intensity=$f[0]);}else $h.meshRender.material.intensity=$f[0];},$n._getMeshRenderSharedMaterialDetailTilingOffset=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null;}return $h.meshRender.sharedMaterial.detailTilingOffset.elements;},$n._setMeshRenderSharedMaterialDetailTilingOffset=function($J,$h,$f){var $n,$L;if($J){var $T=$J.transform._entity;$T&&(($L=($n=$T.owner.meshRender.material).detailTilingOffset).elements=$f,$n.detailTilingOffset=$L);}else($L=($n=$h.meshRender.material).detailTilingOffset).elements=$f,$n.detailTilingOffset=$L;},$n._getMeshRenderSharedMaterialDissolveTilingOffset=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null;}return $h.meshRender.sharedMaterial.dissolveTilingOffset.elements;},$n._setMeshRenderSharedMaterialDissolveTilingOffset=function($J,$h,$f){var $n,$L;if($J){var $T=$J.transform._entity;$T&&(($L=($n=$T.owner.meshRender.material).dissolveTilingOffset).elements=$f,$n.dissolveTilingOffset=$L);}else($L=($n=$h.meshRender.material).dissolveTilingOffset).elements=$f,$n.dissolveTilingOffset=$L;},$n._getMeshRenderSharedMaterialMaskTilingOffset=function($J,$h){if($J){var $f=$J.transform._entity;return $f?$f.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null;}return $h.meshRender.sharedMaterial.maskTilingOffset.elements;},$n._setMeshRenderSharedMaterialMaskTilingOffset=function($J,$h,$f){var $n,$L;if($J){var $T=$J.transform._entity;$T&&(($L=($n=$T.owner.meshRender.material).maskTilingOffset).elements=$f,$n.maskTilingOffset=$L);}else($L=($n=$h.meshRender.material).maskTilingOffset).elements=$f,$n.maskTilingOffset=$L;},$n._propertyIDCounter=0,$n._propertyIndexDic={},$n._propertySetFuncs=[],$n._propertyGetFuncs=[],$n;}(),$C=function(){function $J(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null;}return $l($J,"laya.d3.animation.Keyframe"),$J;}(),$e=function(){function $J(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null;}return $l($J,"laya.d3.animation.KeyframeNode"),$J;}(),$W=(function(){function $J(){this._tempVector30=new $kh(),this._tempVector31=new $kh(),this._tempVector32=new $kh(),this._a=new $kh(),this._b=new $kh(),this._c=new $kh(),this._d=new $kh();}$l($J,"laya.d3.core.glitter.SplineCurvePositionVelocity");var $h=$J.prototype;$h.Init=function($J,$h,$f,$n){$J.cloneTo(this._d),$h.cloneTo(this._c),$kh.scale($J,2,this._a),$kh.scale($f,2,this._tempVector30),$kh.subtract(this._a,this._tempVector30,this._a),$kh.add(this._a,$h,this._a),$kh.add(this._a,$n,this._a),$kh.scale($f,3,this._b),$kh.scale($J,3,this._tempVector30),$kh.subtract(this._b,this._tempVector30,this._b),$kh.subtract(this._b,$n,this._b),$kh.scale($h,2,this._tempVector30),$kh.subtract(this._b,this._tempVector30,this._b);},$h.Slerp=function($J,$h){$kh.scale(this._a,$J*$J*$J,this._tempVector30),$kh.scale(this._b,$J*$J,this._tempVector31),$kh.scale(this._c,$J,this._tempVector32),$kh.add(this._tempVector30,this._tempVector31,$h),$kh.add($h,this._tempVector32,$h),$kh.add($h,this._d,$h);};}(),function(){function $t($J,$h,$f,$n){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=$J,this._h=$h,this._minHeight=$f,this._maxHeight=$n;}$l($t,"laya.d3.core.HeightMap");var $J=$t.prototype;$J._inBounds=function($J,$h){return 0<=$J&&$J<this._h&&0<=$h&&$h<this._w;},$J.getHeight=function($J,$h){return this._inBounds($J,$h)?this._datas[$J][$h]:NaN;},$i(0,$J,"width",function(){return this._w;}),$i(0,$J,"height",function(){return this._h;}),$i(0,$J,"maxHeight",function(){return this._maxHeight;}),$i(0,$J,"minHeight",function(){return this._minHeight;}),$t.creatFromMesh=function($J,$h,$f,$n){for(var $L=[],$T=[],$k=$J.getSubMeshCount(),$u=0;$u<$k;$u++){for(var $S=$J.getSubMesh($u),$Y=$S._getVertexBuffer(),$x=$Y.getData(),$j=[],$R=0;$R<$x.length;$R+=$Y.vertexDeclaration.vertexStride/4){var $l=new $kh($x[$R+0],$x[$R+1],$x[$R+2]);$j.push($l);}$L.push($j);var $i=$S._getIndexBuffer();$T.push($i.getData());}var $q=$J.boundingBox,$o=$q.min.x,$r=$q.min.z,$_=$q.max.x,$s=$q.max.z,$d=$q.min.y,$p=$q.max.y,$U=$_-$o,$Q=$s-$r,$D=$n.elements[0]=$U/($h-1),$g=$n.elements[1]=$Q/($f-1),$F=new $t($h,$f,$d,$p),$A=$t._tempRay,$G=$A.direction.elements;$G[0]=0,$G[1]=-1,$G[2]=0;var $y=$p+.1;$A.origin.elements[1]=$y;for(var $O=0;$O<$f;$O++){var $P=$r+$O*$g;$F._datas[$O]=[];for(var $W=0;$W<$h;$W++){var $I=$o+$W*$D,$m=$A.origin.elements;$m[0]=$I,$m[2]=$P;var $Z=$t._getPosition($A,$L,$T);$F._datas[$O][$W]=$Z===Number.MAX_VALUE?NaN:$y-$Z;}}return $F;},$t.createFromImage=function($J,$h,$f){for(var $n=$J.width,$L=$J.height,$T=new $t($n,$L,$h,$f),$k=($f-$h)/254,$u=$J.getPixels(),$S=0,$Y=0;$Y<$L;$Y++)for(var $x=$T._datas[$Y]=[],$j=0;$j<$n;$j++){var $R=$u[$S++],$l=$u[$S++],$i=$u[$S++],$q=$u[$S++];$x[$j]=255==$R&&255==$l&&255==$i&&255==$q?NaN:($R+$l+$i)/3*$k+$h;}return $T;},$t._getPosition=function($J,$h,$f){for(var $n=Number.MAX_VALUE,$L=0;$L<$h.length;$L++)for(var $T=$h[$L],$k=$f[$L],$u=0;$u<$k.length;$u+=3){var $S=$T[$k[$u+0]],$Y=$T[$k[$u+1]],$x=$T[$k[$u+2]],$j=$ih.rayIntersectsTriangle($J,$S,$Y,$x);!isNaN($j)&&$j<$n&&($n=$j);}return $n;},$j($t,["_tempRay",function(){return this._tempRay=new $Lh(new $kh(),new $kh());}]);}(),function(){function $L(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[];}$l($L,"laya.d3.core.Layer");var $J=$L.prototype;return $J._binarySearchIndex=function(){for(var $J=0,$h=$L._collsionTestList.length-1,$f=0;$J<=$h;){$f=Math.floor(($J+$h)/2);var $n=$L._collsionTestList[$f];if($n==this._number)return $f;$n>this._number?$h=$f-1:$J=$f+1;}return $J;},$J._addCollider=function($J){0===this._colliders.length&&$L._collsionTestList.splice(this._binarySearchIndex(),0,this._number),$J._isRigidbody?(this._colliders.unshift($J),this._nonRigidbodyOffset++):this._colliders.push($J);},$J._removeCollider=function($J){var $h=this._colliders.indexOf($J);$h<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice($h,1),0===this._colliders.length&&$L._collsionTestList.splice($L._collsionTestList.indexOf(this._number),1);},$i(0,$J,"number",function(){return this._number;}),$i(0,$J,"visible",function(){return this._visible;},function($J){this._visible=$J,$L._visibleLayers=$J?$L._visibleLayers|this.mask:$L._visibleLayers&~this.mask;}),$i(0,$J,"mask",function(){return this._mask;}),$i(1,$L,"visibleLayers",function(){return $L._visibleLayers;},function($J){$L._visibleLayers=$J;for(var $h=0,$f=$L._layerList.length;$h<$f;$h++){var $n=$L._layerList[$h];$n._visible=0!=($n._mask&$L._visibleLayers);}}),$L.__init__=function(){$L._layerList.length=31;for(var $J=0;$J<31;$J++){var $h=new $L();$L._layerList[$J]=$h,0===$J?($h.name="Default Layer",$h.visible=!0):($h.name="Layer-"+$J,$h.visible=!1),$h._number=$J,$h._mask=Math.pow(2,$J);}$L.currentCreationLayer=$L._layerList[0];},$L.getLayerByNumber=function($J){if($J<0||30<$J)throw new Error("无法返回指定Layer，该number超出范围！");return $L._layerList[$J];},$L.getLayerByName=function($J){for(var $h=0;$h<31;$h++)if($L._layerList[$h].name===$J)return $L._layerList[$h];throw new Error("无法返回指定Layer,该name不存在");},$L.isVisible=function($J){return 0!=($J&$L._currentCameraCullingMask&$L._visibleLayers);},$L._layerList=[],$L._visibleLayers=2147483647,$L._collsionTestList=[],$L._currentCameraCullingMask=2147483647,$L.maxCount=31,$L.currentCreationLayer=null,$L;}()),$I=(function(){function $J($J,$h,$f){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=$J,this._minCount=$h,this._maxCount=$f;}$l($J,"laya.d3.core.particleShuriKen.module.Burst");var $h=$J.prototype;$p.imps($h,{"laya.d3.core.IClone":!0}),$h.cloneTo=function($J){var $h=$J;$h._time=this._time,$h._minCount=this._minCount,$h._maxCount=this._maxCount;},$h.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$h,"time",function(){return this._time;}),$i(0,$h,"minCount",function(){return this._minCount;}),$i(0,$h,"maxCount",function(){return this._maxCount;});}(),function(){function $J($J){this._color=null,this.enbale=!1,this._color=$J;}$l($J,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var $h=$J.prototype;$h.cloneTo=function($J){var $h=$J;this._color.cloneTo($h._color),$h.enbale=this.enbale;},$h.clone=function(){var $J;switch(this._color.type){case 0:$J=$Z.createByConstant(this._color.constant.clone());break;case 1:$J=$Z.createByGradient(this._color.gradient.clone());break;case 2:$J=$Z.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:$J=$Z.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone());}var $h=new this.constructor($J);return $h.enbale=this.enbale,$h;},$i(0,$h,"color",function(){return this._color;});}(),function(){function $J(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[];}$l($J,"laya.d3.core.particleShuriKen.module.Emission");var $h=$J.prototype;$p.imps($h,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),$h._destroy=function(){this._bursts=null,this._destroyed=!0;},$h.getBurstsCount=function(){return this._bursts.length;},$h.getBurstByIndex=function($J){return this._bursts[$J];},$h.addBurst=function($J){var $h=this._bursts.length;if(0<$h)for(var $f=0;$f<$h;$f++)this._bursts[$f].time>$J.time&&this._bursts.splice($f,0,$J);this._bursts.push($J);},$h.removeBurst=function($J){var $h=this._bursts.indexOf($J);-1!==$h&&this._bursts.splice($h,1);},$h.removeBurstByIndex=function($J){this._bursts.splice($J,1);},$h.clearBurst=function(){this._bursts.length=0;},$h.cloneTo=function($J){var $h=$J,$f=$h._bursts;$f.length=this._bursts.length;for(var $n=0,$L=this._bursts.length;$n<$L;$n++){var $T=$f[$n];$T?this._bursts[$n].cloneTo($T):$f[$n]=this._bursts[$n].clone();}$h._emissionRate=this._emissionRate,$h.enbale=this.enbale;},$h.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$h,"destroyed",function(){return this._destroyed;}),$i(0,$h,"emissionRate",function(){return this._emissionRate;},function($J){if($J<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=$J;});}(),function(){function $n(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null;}$l($n,"laya.d3.core.particleShuriKen.module.FrameOverTime");var $J=$n.prototype;return $p.imps($J,{"laya.d3.core.IClone":!0}),$J.cloneTo=function($J){var $h=$J;$h._type=this._type,$h._constant=this._constant,this._overTime.cloneTo($h._overTime),$h._constantMin=this._constantMin,$h._constantMax=this._constantMax,this._overTimeMin.cloneTo($h._overTimeMin),this._overTimeMax.cloneTo($h._overTimeMax);},$J.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$J,"frameOverTimeData",function(){return this._overTime;}),$i(0,$J,"constant",function(){return this._constant;}),$i(0,$J,"type",function(){return this._type;}),$i(0,$J,"frameOverTimeDataMin",function(){return this._overTimeMin;}),$i(0,$J,"constantMin",function(){return this._constantMin;}),$i(0,$J,"frameOverTimeDataMax",function(){return this._overTimeMax;}),$i(0,$J,"constantMax",function(){return this._constantMax;}),$n.createByConstant=function($J){var $h=new $n();return $h._type=0,$h._constant=$J,$h;},$n.createByOverTime=function($J){var $h=new $n();return $h._type=1,$h._overTime=$J,$h;},$n.createByRandomTwoConstant=function($J,$h){var $f=new $n();return $f._type=2,$f._constantMin=$J,$f._constantMax=$h,$f;},$n.createByRandomTwoOverTime=function($J,$h){var $f=new $n();return $f._type=3,$f._overTimeMin=$J,$f._overTimeMax=$h,$f;},$n;}()),$m=function(){function $Y(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null;}$l($Y,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var $J=$Y.prototype;return $p.imps($J,{"laya.d3.core.IClone":!0}),$J.cloneTo=function($J){var $h=$J;$h._type=this._type,$h._separateAxes=this._separateAxes,$h._constant=this._constant,this._constantSeparate.cloneTo($h._constantSeparate),this._gradient.cloneTo($h._gradient),this._gradientX.cloneTo($h._gradientX),this._gradientY.cloneTo($h._gradientY),this._gradientZ.cloneTo($h._gradientZ),$h._constantMin=this._constantMin,$h._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($h._constantMinSeparate),this._constantMaxSeparate.cloneTo($h._constantMaxSeparate),this._gradientMin.cloneTo($h._gradientMin),this._gradientMax.cloneTo($h._gradientMax),this._gradientXMin.cloneTo($h._gradientXMin),this._gradientXMax.cloneTo($h._gradientXMax),this._gradientYMin.cloneTo($h._gradientYMin),this._gradientYMax.cloneTo($h._gradientYMax),this._gradientZMin.cloneTo($h._gradientZMin),this._gradientZMax.cloneTo($h._gradientZMax);},$J.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$J,"gradientZ",function(){return this._gradientZ;}),$i(0,$J,"constant",function(){return this._constant;}),$i(0,$J,"gradient",function(){return this._gradient;}),$i(0,$J,"separateAxes",function(){return this._separateAxes;}),$i(0,$J,"type",function(){return this._type;}),$i(0,$J,"constantSeparate",function(){return this._constantSeparate;}),$i(0,$J,"gradientX",function(){return this._gradientX;}),$i(0,$J,"gradientY",function(){return this._gradientY;}),$i(0,$J,"gradientW",function(){return this._gradientW;}),$i(0,$J,"gradientMin",function(){return this._gradientMin;}),$i(0,$J,"constantMin",function(){return this._constantMin;}),$i(0,$J,"gradientMax",function(){return this._gradientMax;}),$i(0,$J,"constantMax",function(){return this._constantMax;}),$i(0,$J,"gradientWMin",function(){return this._gradientWMin;}),$i(0,$J,"constantMinSeparate",function(){return this._constantMinSeparate;}),$i(0,$J,"constantMaxSeparate",function(){return this._constantMaxSeparate;}),$i(0,$J,"gradientXMin",function(){return this._gradientXMin;}),$i(0,$J,"gradientXMax",function(){return this._gradientXMax;}),$i(0,$J,"gradientWMax",function(){return this._gradientWMax;}),$i(0,$J,"gradientYMin",function(){return this._gradientYMin;}),$i(0,$J,"gradientYMax",function(){return this._gradientYMax;}),$i(0,$J,"gradientZMin",function(){return this._gradientZMin;}),$i(0,$J,"gradientZMax",function(){return this._gradientZMax;}),$Y.createByConstant=function($J){var $h=new $Y();return $h._type=0,$h._separateAxes=!1,$h._constant=$J,$h;},$Y.createByConstantSeparate=function($J){var $h=new $Y();return $h._type=0,$h._separateAxes=!0,$h._constantSeparate=$J,$h;},$Y.createByGradient=function($J){var $h=new $Y();return $h._type=1,$h._separateAxes=!1,$h._gradient=$J,$h;},$Y.createByGradientSeparate=function($J,$h,$f,$n){var $L=new $Y();return $L._type=1,$L._separateAxes=!0,$L._gradientX=$J,$L._gradientY=$h,$L._gradientZ=$f,$L._gradientW=$n,$L;},$Y.createByRandomTwoConstant=function($J,$h){var $f=new $Y();return $f._type=2,$f._separateAxes=!1,$f._constantMin=$J,$f._constantMax=$h,$f;},$Y.createByRandomTwoConstantSeparate=function($J,$h){var $f=new $Y();return $f._type=2,$f._separateAxes=!0,$f._constantMinSeparate=$J,$f._constantMaxSeparate=$h,$f;},$Y.createByRandomTwoGradient=function($J,$h){var $f=new $Y();return $f._type=3,$f._separateAxes=!1,$f._gradientMin=$J,$f._gradientMax=$h,$f;},$Y.createByRandomTwoGradientSeparate=function($J,$h,$f,$n,$L,$T,$k,$u){var $S=new $Y();return $S._type=3,$S._separateAxes=!0,$S._gradientXMin=$J,$S._gradientXMax=$h,$S._gradientYMin=$f,$S._gradientYMax=$n,$S._gradientZMin=$L,$S._gradientZMax=$T,$S._gradientWMin=$k,$S._gradientWMax=$u,$S;},$Y;}(),$Z=function(){function $n(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null;}$l($n,"laya.d3.core.particleShuriKen.module.GradientColor");var $J=$n.prototype;return $p.imps($J,{"laya.d3.core.IClone":!0}),$J.cloneTo=function($J){var $h=$J;$h._type=this._type,this._constant.cloneTo($h._constant),this._constantMin.cloneTo($h._constantMin),this._constantMax.cloneTo($h._constantMax),this._gradient.cloneTo($h._gradient),this._gradientMin.cloneTo($h._gradientMin),this._gradientMax.cloneTo($h._gradientMax);},$J.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$J,"gradient",function(){return this._gradient;}),$i(0,$J,"constant",function(){return this._constant;}),$i(0,$J,"type",function(){return this._type;}),$i(0,$J,"gradientMin",function(){return this._gradientMin;}),$i(0,$J,"constantMin",function(){return this._constantMin;}),$i(0,$J,"gradientMax",function(){return this._gradientMax;}),$i(0,$J,"constantMax",function(){return this._constantMax;}),$n.createByConstant=function($J){var $h=new $n();return $h._type=0,$h._constant=$J,$h;},$n.createByGradient=function($J){var $h=new $n();return $h._type=1,$h._gradient=$J,$h;},$n.createByRandomTwoConstant=function($J,$h){var $f=new $n();return $f._type=2,$f._constantMin=$J,$f._constantMax=$h,$f;},$n.createByRandomTwoGradient=function($J,$h){var $f=new $n();return $f._type=3,$f._gradientMin=$J,$f._gradientMax=$h,$f;},$n;}(),$t=(function(){function $J(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16);}$l($J,"laya.d3.core.particleShuriKen.module.GradientDataColor");var $h=$J.prototype;$p.imps($h,{"laya.d3.core.IClone":!0}),$h.addAlpha=function($J,$h){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==$J&&($J=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=$J,this._alphaElements[this._alphaCurrentLength++]=$h):DEBUG;},$h.addRGB=function($J,$h){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==$J&&($J=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=$J,this._rgbElements[this._rgbCurrentLength++]=$h.x,this._rgbElements[this._rgbCurrentLength++]=$h.y,this._rgbElements[this._rgbCurrentLength++]=$h.z):DEBUG;},$h.cloneTo=function($J){var $h=$J,$f=0,$n=0;$h._alphaCurrentLength=this._alphaCurrentLength;var $L=$h._alphaElements;for($L.length=this._alphaElements.length,$f=0,$n=this._alphaElements.length;$f<$n;$f++)$L[$f]=this._alphaElements[$f];$h._rgbCurrentLength=this._rgbCurrentLength;var $T=$h._rgbElements;for($T.length=this._rgbElements.length,$f=0,$n=this._rgbElements.length;$f<$n;$f++)$T[$f]=this._rgbElements[$f];},$h.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$h,"alphaGradientCount",function(){return this._alphaCurrentLength/2;}),$i(0,$h,"rgbGradientCount",function(){return this._rgbCurrentLength/4;});}(),function(){function $J(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8);}$l($J,"laya.d3.core.particleShuriKen.module.GradientDataInt");var $h=$J.prototype;$p.imps($h,{"laya.d3.core.IClone":!0}),$h.add=function($J,$h){this._currentLength<8?(6===this._currentLength&&1!==$J&&($J=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$J,this._elements[this._currentLength++]=$h):console.log("Warning:data count must lessEqual than 4");},$h.cloneTo=function($J){var $h=$J;$h._currentLength=this._currentLength;var $f=$h._elements;$f.length=this._elements.length;for(var $n=0,$L=this._elements.length;$n<$L;$n++)$f[$n]=this._elements[$n];},$h.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$h,"gradientCount",function(){return this._currentLength/2;});}(),function(){function $J(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8);}$l($J,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var $h=$J.prototype;$p.imps($h,{"laya.d3.core.IClone":!0}),$h.add=function($J,$h){this._currentLength<8?(6===this._currentLength&&1!==$J&&($J=1,DEBUG),this._elements[this._currentLength++]=$J,this._elements[this._currentLength++]=$h):DEBUG;},$h.getKeyByIndex=function($J){return this._elements[2*$J];},$h.getValueByIndex=function($J){return this._elements[2*$J+1];},$h.getAverageValue=function(){for(var $J=0,$h=this._currentLength-2;$J<$h;$J+=2){this._elements[$J+1];this._elements[$J+3],this._elements[$J+2]-this._elements[$J];}return 0;},$h.cloneTo=function($J){var $h=$J;$h._currentLength=this._currentLength;var $f=$h._elements;$f.length=this._elements.length;for(var $n=0,$L=this._elements.length;$n<$L;$n++)$f[$n]=this._elements[$n];},$h.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$h,"gradientCount",function(){return this._currentLength/2;});}(),function(){function $J(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12);}$l($J,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var $h=$J.prototype;$p.imps($h,{"laya.d3.core.IClone":!0}),$h.add=function($J,$h){this._currentLength<8?(6===this._currentLength&&1!==$J&&($J=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$J,this._elements[this._currentLength++]=$h.x,this._elements[this._currentLength++]=$h.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4");},$h.cloneTo=function($J){var $h=$J;$h._currentLength=this._currentLength;var $f=$h._elements;$f.length=this._elements.length;for(var $n=0,$L=this._elements.length;$n<$L;$n++)$f[$n]=this._elements[$n];},$h.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$h,"gradientCount",function(){return this._currentLength/3;});}(),function(){function $u(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null;}$l($u,"laya.d3.core.particleShuriKen.module.GradientSize");var $J=$u.prototype;return $p.imps($J,{"laya.d3.core.IClone":!0}),$J.getMaxSizeInGradient=function(){var $J=0,$h=0,$f=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for($J=0,$h=this._gradientX.gradientCount;$J<$h;$J++)$f=Math.max($f,this._gradientX.getValueByIndex($J));for($J=0,$h=this._gradientY.gradientCount;$J<$h;$J++)$f=Math.max($f,this._gradientY.getValueByIndex($J));}else for($J=0,$h=this._gradient.gradientCount;$J<$h;$J++)$f=Math.max($f,this._gradient.getValueByIndex($J));break;case 1:$f=this._separateAxes?($f=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),$f=Math.max($f,this._constantMinSeparate.y),Math.max($f,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for($J=0,$h=this._gradientXMin.gradientCount;$J<$h;$J++)$f=Math.max($f,this._gradientXMin.getValueByIndex($J));for($J=0,$h=this._gradientXMax.gradientCount;$J<$h;$J++)$f=Math.max($f,this._gradientXMax.getValueByIndex($J));for($J=0,$h=this._gradientYMin.gradientCount;$J<$h;$J++)$f=Math.max($f,this._gradientYMin.getValueByIndex($J));for($J=0,$h=this._gradientZMax.gradientCount;$J<$h;$J++)$f=Math.max($f,this._gradientZMax.getValueByIndex($J));}else{for($J=0,$h=this._gradientMin.gradientCount;$J<$h;$J++)$f=Math.max($f,this._gradientMin.getValueByIndex($J));for($J=0,$h=this._gradientMax.gradientCount;$J<$h;$J++)$f=Math.max($f,this._gradientMax.getValueByIndex($J));}}return $f;},$J.cloneTo=function($J){var $h=$J;$h._type=this._type,$h._separateAxes=this._separateAxes,this._gradient.cloneTo($h._gradient),this._gradientX.cloneTo($h._gradientX),this._gradientY.cloneTo($h._gradientY),this._gradientZ.cloneTo($h._gradientZ),$h._constantMin=this._constantMin,$h._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($h._constantMinSeparate),this._constantMaxSeparate.cloneTo($h._constantMaxSeparate),this._gradientMin.cloneTo($h._gradientMin),this._gradientMax.cloneTo($h._gradientMax),this._gradientXMin.cloneTo($h._gradientXMin),this._gradientXMax.cloneTo($h._gradientXMax),this._gradientYMin.cloneTo($h._gradientYMin),this._gradientYMax.cloneTo($h._gradientYMax),this._gradientZMin.cloneTo($h._gradientZMin),this._gradientZMax.cloneTo($h._gradientZMax);},$J.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$J,"gradientZ",function(){return this._gradientZ;}),$i(0,$J,"gradient",function(){return this._gradient;}),$i(0,$J,"separateAxes",function(){return this._separateAxes;}),$i(0,$J,"type",function(){return this._type;}),$i(0,$J,"gradientMin",function(){return this._gradientMin;}),$i(0,$J,"constantMin",function(){return this._constantMin;}),$i(0,$J,"gradientX",function(){return this._gradientX;}),$i(0,$J,"gradientY",function(){return this._gradientY;}),$i(0,$J,"gradientMax",function(){return this._gradientMax;}),$i(0,$J,"constantMax",function(){return this._constantMax;}),$i(0,$J,"constantMinSeparate",function(){return this._constantMinSeparate;}),$i(0,$J,"constantMaxSeparate",function(){return this._constantMaxSeparate;}),$i(0,$J,"gradientXMin",function(){return this._gradientXMin;}),$i(0,$J,"gradientXMax",function(){return this._gradientXMax;}),$i(0,$J,"gradientYMin",function(){return this._gradientYMin;}),$i(0,$J,"gradientYMax",function(){return this._gradientYMax;}),$i(0,$J,"gradientZMin",function(){return this._gradientZMin;}),$i(0,$J,"gradientZMax",function(){return this._gradientZMax;}),$u.createByGradient=function($J){var $h=new $u();return $h._type=0,$h._separateAxes=!1,$h._gradient=$J,$h;},$u.createByGradientSeparate=function($J,$h,$f){var $n=new $u();return $n._type=0,$n._separateAxes=!0,$n._gradientX=$J,$n._gradientY=$h,$n._gradientZ=$f,$n;},$u.createByRandomTwoConstant=function($J,$h){var $f=new $u();return $f._type=1,$f._separateAxes=!1,$f._constantMin=$J,$f._constantMax=$h,$f;},$u.createByRandomTwoConstantSeparate=function($J,$h){var $f=new $u();return $f._type=1,$f._separateAxes=!0,$f._constantMinSeparate=$J,$f._constantMaxSeparate=$h,$f;},$u.createByRandomTwoGradient=function($J,$h){var $f=new $u();return $f._type=2,$f._separateAxes=!1,$f._gradientMin=$J,$f._gradientMax=$h,$f;},$u.createByRandomTwoGradientSeparate=function($J,$h,$f,$n,$L,$T){var $k=new $u();return $k._type=2,$k._separateAxes=!0,$k._gradientXMin=$J,$k._gradientXMax=$h,$k._gradientYMin=$f,$k._gradientYMax=$n,$k._gradientZMin=$L,$k._gradientZMax=$T,$k;},$u;}()),$c=function(){function $u(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null;}$l($u,"laya.d3.core.particleShuriKen.module.GradientVelocity");var $J=$u.prototype;return $p.imps($J,{"laya.d3.core.IClone":!0}),$J.cloneTo=function($J){var $h=$J;$h._type=this._type,this._constant.cloneTo($h._constant),this._gradientX.cloneTo($h._gradientX),this._gradientY.cloneTo($h._gradientY),this._gradientZ.cloneTo($h._gradientZ),this._constantMin.cloneTo($h._constantMin),this._constantMax.cloneTo($h._constantMax),this._gradientXMin.cloneTo($h._gradientXMin),this._gradientXMax.cloneTo($h._gradientXMax),this._gradientYMin.cloneTo($h._gradientYMin),this._gradientYMax.cloneTo($h._gradientYMax),this._gradientZMin.cloneTo($h._gradientZMin),this._gradientZMax.cloneTo($h._gradientZMax);},$J.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$J,"gradientZ",function(){return this._gradientZ;}),$i(0,$J,"constant",function(){return this._constant;}),$i(0,$J,"type",function(){return this._type;}),$i(0,$J,"gradientXMax",function(){return this._gradientXMax;}),$i(0,$J,"constantMin",function(){return this._constantMin;}),$i(0,$J,"gradientX",function(){return this._gradientX;}),$i(0,$J,"gradientY",function(){return this._gradientY;}),$i(0,$J,"gradientXMin",function(){return this._gradientXMin;}),$i(0,$J,"constantMax",function(){return this._constantMax;}),$i(0,$J,"gradientYMin",function(){return this._gradientYMin;}),$i(0,$J,"gradientYMax",function(){return this._gradientYMax;}),$i(0,$J,"gradientZMin",function(){return this._gradientZMin;}),$i(0,$J,"gradientZMax",function(){return this._gradientZMax;}),$u.createByConstant=function($J){var $h=new $u();return $h._type=0,$h._constant=$J,$h;},$u.createByGradient=function($J,$h,$f){var $n=new $u();return $n._type=1,$n._gradientX=$J,$n._gradientY=$h,$n._gradientZ=$f,$n;},$u.createByRandomTwoConstant=function($J,$h){var $f=new $u();return $f._type=2,$f._constantMin=$J,$f._constantMax=$h,$f;},$u.createByRandomTwoGradient=function($J,$h,$f,$n,$L,$T){var $k=new $u();return $k._type=3,$k._gradientXMin=$J,$k._gradientXMax=$h,$k._gradientYMin=$f,$k._gradientYMax=$n,$k._gradientZMin=$L,$k._gradientZMax=$T,$k;},$u;}(),$a=(function(){function $J($J){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=$J;}$l($J,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var $h=$J.prototype;$p.imps($h,{"laya.d3.core.IClone":!0}),$h.cloneTo=function($J){var $h=$J;this._angularVelocity.cloneTo($h._angularVelocity),$h.enbale=this.enbale;},$h.clone=function(){var $J;switch(this._angularVelocity.type){case 0:$J=this._angularVelocity.separateAxes?$m.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):$m.createByConstant(this._angularVelocity.constant);break;case 1:$J=this._angularVelocity.separateAxes?$m.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):$m.createByGradient(this._angularVelocity.gradient.clone());break;case 2:$J=this._angularVelocity.separateAxes?$m.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):$m.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:$J=this._angularVelocity.separateAxes?$m.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):$m.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone());}var $h=new this.constructor($J);return $h.enbale=this.enbale,$h;},$i(0,$h,"angularVelocity",function(){return this._angularVelocity;});}(),function(){function $J(){this.enable=!1,this.randomDirection=!1;}$l($J,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var $h=$J.prototype;return $p.imps($h,{"laya.d3.core.IClone":!0}),$h._getShapeBoundBox=function($J){throw new Error("BaseShape: must override it.");},$h._getSpeedBoundBox=function($J){throw new Error("BaseShape: must override it.");},$h.generatePositionAndDirection=function($J,$h,$f,$n){throw new Error("BaseShape: must override it.");},$h._calculateProceduralBounds=function($J,$h,$f){this._getShapeBoundBox($J);var $n=$J.min,$L=$J.max;$kh.multiply($n,$h,$n),$kh.multiply($L,$h,$L);var $T=new $wJ(new $kh(),new $kh());this.randomDirection?($T.min=new $kh(-1,-1,-1),$T.max=new $kh(1,1,1)):this._getSpeedBoundBox($T);var $k=new $wJ(new $kh(),new $kh()),$u=$k.min,$S=$k.max;$kh.scale($T.min,$f.y,$u),$kh.scale($T.max,$f.y,$S),$kh.add($J.min,$u,$u),$kh.add($J.max,$S,$S),$kh.min($J.min,$u,$J.min),$kh.max($J.max,$u,$J.max);var $Y=new $wJ(new $kh(),new $kh()),$x=$Y.min,$j=$Y.max;$kh.scale($T.min,$f.x,$x),$kh.scale($T.max,$f.x,$j),$kh.min($Y.min,$j,$u),$kh.max($Y.min,$j,$S),$kh.min($J.min,$u,$J.min),$kh.max($J.max,$u,$J.max);},$h.cloneTo=function($J){$J.enable=this.enable;},$h.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$J;}()),$H=function(){function $T(){}return $l($T,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),$T._randomPointUnitArcCircle=function($J,$h,$f){var $n=$h.elements,$L=NaN;$L=$f?$f.getFloat()*$J:Math.random()*$J,$n[0]=Math.cos($L),$n[1]=Math.sin($L);},$T._randomPointInsideUnitArcCircle=function($J,$h,$f){var $n=$h.elements;$T._randomPointUnitArcCircle($J,$h,$f);var $L=NaN;$L=$f?Math.pow($f.getFloat(),.5):Math.pow(Math.random(),.5),$n[0]=$n[0]*$L,$n[1]=$n[1]*$L;},$T._randomPointUnitCircle=function($J,$h){var $f=$J.elements,$n=NaN;$n=$h?$h.getFloat()*Math.PI*2:Math.random()*Math.PI*2,$f[0]=Math.cos($n),$f[1]=Math.sin($n);},$T._randomPointInsideUnitCircle=function($J,$h){var $f=$J.elements;$T._randomPointUnitCircle($J);var $n=NaN;$n=$h?Math.pow($h.getFloat(),.5):Math.pow(Math.random(),.5),$f[0]=$f[0]*$n,$f[1]=$f[1]*$n;},$T._randomPointUnitSphere=function($J,$h){var $f=$J.elements,$n=NaN,$L=NaN;$L=$h?($n=$f[2]=2*$h.getFloat()-1,$h.getFloat()*Math.PI*2):($n=$f[2]=2*Math.random()-1,Math.random()*Math.PI*2);var $T=Math.sqrt(1-$n*$n);$f[0]=$T*Math.cos($L),$f[1]=$T*Math.sin($L);},$T._randomPointInsideUnitSphere=function($J,$h){var $f=$J.elements;$T._randomPointUnitSphere($J);var $n=NaN;$n=$h?Math.pow($h.getFloat(),1/3):Math.pow(Math.random(),1/3),$f[0]=$f[0]*$n,$f[1]=$f[1]*$n,$f[2]=$f[2]*$n;},$T._randomPointInsideHalfUnitBox=function($J,$h){var $f=$J.elements;$h?($f[0]=$h.getFloat()-.5,$f[1]=$h.getFloat()-.5,$f[2]=$h.getFloat()-.5):($f[0]=Math.random()-.5,$f[1]=Math.random()-.5,$f[2]=Math.random()-.5);},$T;}(),$b=(function(){function $J($J){this._size=null,this.enbale=!1,this._size=$J;}$l($J,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var $h=$J.prototype;$p.imps($h,{"laya.d3.core.IClone":!0}),$h.cloneTo=function($J){var $h=$J;this._size.cloneTo($h._size),$h.enbale=this.enbale;},$h.clone=function(){var $J;switch(this._size.type){case 0:$J=this._size.separateAxes?$t.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):$t.createByGradient(this._size.gradient.clone());break;case 1:$J=this._size.separateAxes?$t.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):$t.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:$J=this._size.separateAxes?$t.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):$t.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone());}var $h=new this.constructor($J);return $h.enbale=this.enbale,$h;},$i(0,$h,"size",function(){return this._size;});}(),function(){function $n(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN;}$l($n,"laya.d3.core.particleShuriKen.module.StartFrame");var $J=$n.prototype;return $p.imps($J,{"laya.d3.core.IClone":!0}),$J.cloneTo=function($J){var $h=$J;$h._type=this._type,$h._constant=this._constant,$h._constantMin=this._constantMin,$h._constantMax=this._constantMax;},$J.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$J,"constant",function(){return this._constant;}),$i(0,$J,"type",function(){return this._type;}),$i(0,$J,"constantMin",function(){return this._constantMin;}),$i(0,$J,"constantMax",function(){return this._constantMax;}),$n.createByConstant=function($J){var $h=new $n();return $h._type=0,$h._constant=$J,$h;},$n.createByRandomTwoConstant=function($J,$h){var $f=new $n();return $f._type=1,$f._constantMin=$J,$f._constantMax=$h,$f;},$n;}()),$v=(function(){function $J($J,$h){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new $Th(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=$J,this._startFrame=$h;}$l($J,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var $h=$J.prototype;$p.imps($h,{"laya.d3.core.IClone":!0}),$h.cloneTo=function($J){var $h=$J;this.tiles.cloneTo($h.tiles),$h.type=this.type,$h.randomRow=this.randomRow,this._frame.cloneTo($h._frame),this._startFrame.cloneTo($h._startFrame),$h.cycles=this.cycles,$h.enableUVChannels=this.enableUVChannels,$h.enable=this.enable;},$h.clone=function(){var $J,$h;switch(this._frame.type){case 0:$J=$I.createByConstant(this._frame.constant);break;case 1:$J=$I.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:$J=$I.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:$J=$I.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone());}switch(this._startFrame.type){case 0:$h=$b.createByConstant(this._startFrame.constant);break;case 1:$h=$b.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax);}var $f=new this.constructor($J,$h);return this.tiles.cloneTo($f.tiles),$f.type=this.type,$f.randomRow=this.randomRow,$f.cycles=this.cycles,$f.enableUVChannels=this.enableUVChannels,$f.enable=this.enable,$f;},$i(0,$h,"frame",function(){return this._frame;}),$i(0,$h,"startFrame",function(){return this._startFrame;});}(),function(){function $J($J){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=$J;}$l($J,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var $h=$J.prototype;$p.imps($h,{"laya.d3.core.IClone":!0}),$h.cloneTo=function($J){var $h=$J;this._velocity.cloneTo($h._velocity),$h.enbale=this.enbale,$h.space=this.space;},$h.clone=function(){var $J;switch(this._velocity.type){case 0:$J=$c.createByConstant(this._velocity.constant.clone());break;case 1:$J=$c.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:$J=$c.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:$J=$c.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone());}var $h=new this.constructor($J);return $h.enbale=this.enbale,$h.space=this.space,$h;},$i(0,$h,"velocity",function(){return this._velocity;});}(),function(){function $J(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new $Rh(),this._vb=$ah.create($J._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=$ch.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=$Zh.nameKey.getID("LINE"),this._shaderCompile=$Dh._preCompileShader[this._sharderNameID];}$l($J,"laya.d3.core.PhasorSpriter3D");var $h=$J.prototype;return $h.line=function($J,$h,$f,$n){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($J.x,$J.y,$J.z,$h.x,$h.y,$h.z,$h.w),this.addVertex($f.x,$f.y,$f.z,$n.x,$n.y,$n.z,$n.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this;},$h.circle=function($J,$h,$f,$n,$L,$T){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*$h,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/$h,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*$J,Math.cos(this._tempNumver0)*$J,0,$f,$n,$L,$T),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this;},$h.plane=function($J,$h,$f,$n,$L,$T,$k,$u,$S){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=$n/2,this._tempNumver1=$L/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($J-this._tempNumver0,$h+this._tempNumver1,$f,$T,$k,$u,$S),this.addVertex($J+this._tempNumver0,$h+this._tempNumver1,$f,$T,$k,$u,$S),this.addVertex($J-this._tempNumver0,$h-this._tempNumver1,$f,$T,$k,$u,$S),this.addVertex($J+this._tempNumver0,$h-this._tempNumver1,$f,$T,$k,$u,$S),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this;},$h.box=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=$n/2,this._tempNumver1=$L/2,this._tempNumver2=$T/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($J-this._tempNumver0,$h+this._tempNumver1,$f+this._tempNumver2,$k,$u,$S,$Y),this.addVertex($J+this._tempNumver0,$h+this._tempNumver1,$f+this._tempNumver2,$k,$u,$S,$Y),this.addVertex($J-this._tempNumver0,$h-this._tempNumver1,$f+this._tempNumver2,$k,$u,$S,$Y),this.addVertex($J+this._tempNumver0,$h-this._tempNumver1,$f+this._tempNumver2,$k,$u,$S,$Y),this.addVertex($J+this._tempNumver0,$h+this._tempNumver1,$f-this._tempNumver2,$k,$u,$S,$Y),this.addVertex($J-this._tempNumver0,$h+this._tempNumver1,$f-this._tempNumver2,$k,$u,$S,$Y),this.addVertex($J+this._tempNumver0,$h-this._tempNumver1,$f-this._tempNumver2,$k,$u,$S,$Y),this.addVertex($J-this._tempNumver0,$h-this._tempNumver1,$f-this._tempNumver2,$k,$u,$S,$Y),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this;},$h.cone=function($J,$h,$f,$n,$L,$T,$k){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*$f+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*$f>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/$f,this.addVertexIndex(0,$h,0,$n,$L,$T,$k,this._tempUint0),this.addVertexIndex(0,0,0,$n,$L,$T,$k,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<$f;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex($J*this._tempNumver2,0,$J*this._tempNumver3,$n,$L,$T,$k,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==$f-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex($J*this._tempNumver2,0,$J*this._tempNumver3,$n,$L,$T,$k,this._tempUint0+(this._tempInt0+$f)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==$f-1?this.addIndexes(this._tempUint1+$f+2):this.addIndexes(this._tempUint1+this._tempInt0+$f+1),this.addIndexes(this._tempUint1+this._tempInt0+$f),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this;},$h.boundingBoxLine=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($J,$L,$T,$k,$u,$S,$Y),this.addVertex($n,$L,$T,$k,$u,$S,$Y),this.addVertex($J,$h,$T,$k,$u,$S,$Y),this.addVertex($n,$h,$T,$k,$u,$S,$Y),this.addVertex($n,$L,$f,$k,$u,$S,$Y),this.addVertex($J,$L,$f,$k,$u,$S,$Y),this.addVertex($n,$h,$f,$k,$u,$S,$Y),this.addVertex($J,$h,$f,$k,$u,$S,$Y),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this;},$h.addVertex=function($J,$h,$f,$n,$L,$T,$k){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=$J,this._vbData[this._posInVBData+1]=$h,this._vbData[this._posInVBData+2]=$f,this._vbData[this._posInVBData+3]=$n,this._vbData[this._posInVBData+4]=$L,this._vbData[this._posInVBData+5]=$T,this._vbData[this._posInVBData+6]=$k,this._posInVBData+=this._floatSizePerVer,this;},$h.addVertexIndex=function($J,$h,$f,$n,$L,$T,$k,$u){return this._hasBegun||this.addVertexIndexException(),this._vbData[$u]=$J,this._vbData[$u+1]=$h,this._vbData[$u+2]=$f,this._vbData[$u+3]=$n,this._vbData[$u+4]=$L,this._vbData[$u+5]=$T,this._vbData[$u+6]=$k,($u+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=$u),this;},$h.addIndexes=function($J){var $h=arguments;this._hasBegun||this.addVertexIndexException();for(var $f=0;$f<$h.length;$f++)this._ibData[this._posInIBData]=$h[$f],this._posInIBData++;return this;},$h.begin=function($J,$h){return this._hasBegun&&this.beginException0(),1!==$J&&4!==$J&&this.beginException1(),this._primitiveType=$J,this._camera=$h,this._hasBegun=!0,this;},$h.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this;},$h.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes($J._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),$D.drawCall++,$y.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0);},$h.addVertexIndexException=function(){throw new Error("请先调用begin()函数");},$h.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！");},$h.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！");},$h.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！");},$h.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！");},$h.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！");},$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(28,[new $kJ(0,"vector3",0),new $kJ(12,"vector4",1)]);}]),$J;}()),$$=function(){function $J(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++$J._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new $Rh();}$l($J,"laya.d3.core.render.RenderElement");var $h=$J.prototype;return $h.getDynamicBatchBakedVertexs=function($J){for(var $h=this._renderObj._getVertexBuffer($J),$f=$h.getData().slice(),$n=$h.vertexDeclaration,$L=$n.getVertexElementByUsage(0).offset/4,$T=$n.getVertexElementByUsage(3).offset/4,$k=this._sprite3D.transform,$u=$k.worldMatrix,$S=$k.rotation,$Y=$n.vertexStride/4,$x=0,$j=$f.length;$x<$j;$x+=$Y){var $R=$x+$L,$l=$x+$T;$oh.transformVector3ArrayToVector3ArrayCoordinate($f,$R,$u,$f,$R),$oh.transformVector3ArrayByQuat($f,$l,$S,$f,$l);}return $f;},$h.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData();},$h._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this);},$i(0,$h,"id",function(){return this._id;}),$i(0,$h,"renderObj",function(){return this._renderObj;},function($J){this._renderObj!==$J&&(this._renderObj=$J);}),$J._uniqueIDCounter=0,$J;}(),$M=function(){function $h($J){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++$h._uniqueIDCounter,this._needSort=!1,this._scene=$J,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={};}$l($h,"laya.d3.core.render.RenderQueue");var $J=$h.prototype;return $J._sortOpaqueFunc=function($J,$h){if($J._render&&$h._render){var $f=$J._material.renderQueue-$h._material.renderQueue;return 0==$f?$J._render._distanceForSort-$h._render._distanceForSort:$f;}return 0;},$J._sortAlphaFunc=function($J,$h){if($J._render&&$h._render){var $f=$J._material.renderQueue-$h._material.renderQueue;return 0==$f?$h._render._distanceForSort-$J._render._distanceForSort:$f;}return 0;},$J._begainRenderElement=function($J,$h,$f){return!!$h._beforeRender($J);},$J._sortAlpha=function($J){$h._cameraPosition=$J,this._finalElements.sort(this._sortAlphaFunc);},$J._sortOpaque=function($J){$h._cameraPosition=$J,this._finalElements.sort(this._sortOpaqueFunc);},$J._preRender=function($J){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements);},$J._render=function($J,$h){for(var $f,$n,$L,$T,$k,$u,$S=$D.loopCount,$Y=this._scene,$x=$J.camera,$j=($x.id,!1),$R=0,$l=this._finalElements.length;$R<$l;$R++){var $i,$q,$o,$r=this._finalElements[$R];if(null!=$r._onPreRenderFunction&&$r._onPreRenderFunction.call($r._sprite3D,$J),0===$r._type){if($J.owner=$o=$r._sprite3D,$J.renderElement=$r,$o._preRenderUpdateComponents($J),$i=$r.renderObj,$q=$r._material,this._begainRenderElement($J,$i,$q)){if($f=$i._getVertexBuffers(),!($L=($n=$i._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[$n.id]){this._errorRecord[$n.id]=1;var $_="vertexBuffer:"+("("+$n._destroyed+","+$n._released+","+$n._referenceCount+","+$n._buffer+")")+", material:"+($q?$q.__className+"("+$q._destroyed+","+$q._released+")":"null")+", owner:"+($o?$o.__className+"("+$o._destroyed+","+$o._activeInHierarchy+","+$o._displayedInStage+")":"null")+", renderObj:"+($i?$i.__className+"("+$i._destroyed+","+$i._released+","+$i._referenceCount+")":"")+", parent:, url:"+($o?$o.url:"")+", disposeStack:"+$n.disposeStack;$p.recordError("报错：unknown vertexDeclaration  "+$_);}continue;}if($j=($T=$J._shader=$q._getShader($Y._shaderDefineValue,$L.shaderDefineValue,$o._shaderDefineValue)).bind()||$S!==$T._uploadLoopCount,$f){if($T._uploadVertexBuffer!==$f||$j){for(var $s=0;$s<$f.length;$s++){var $d=$f[$s];$T.uploadAttributesX($d.vertexDeclaration.shaderValues.data,$d);}$T._uploadVertexBuffer=$f;}}else($T._uploadVertexBuffer!==$n||$j)&&($T.uploadAttributes($L.shaderValues.data,null),$T._uploadVertexBuffer=$n);($T._uploadScene!==$Y||$j)&&($T.uploadSceneUniforms($Y._shaderValues.data),$T._uploadScene=$Y),($x!==$T._uploadCamera||$T._uploadSprite3D!==$o||$j)&&($T.uploadSpriteUniforms($o._shaderValues.data),$T._uploadSprite3D=$o),($x!==$T._uploadCamera||$j)&&($T.uploadCameraUniforms($x._shaderValues.data),$T._uploadCamera=$x),($T._uploadMaterial!==$q||$j)&&($q._upload(),$T._uploadMaterial=$q),$k!==$q?($q._setRenderStateBlendDepth(),$q._setRenderStateFrontFace($h,$o.transform),$k=$q,$u=$o):$u!==$o&&($q._setRenderStateFrontFace($h,$o.transform),$u=$o),$i._render($J),$T._uploadLoopCount=$S;}$o._postRenderUpdateComponents($J);}else if(2===$r._type){$r.renderObj;$J.owner=$o=$r._sprite3D,$J.renderElement=$r,$J._batchIndexStart=$r._tempBatchIndexStart,$J._batchIndexEnd=$r._tempBatchIndexEnd,$i=$r.renderObj,$q=$r._material,this._begainRenderElement($J,$i,$q)&&($L=($n=$i._getVertexBuffer(0)).vertexDeclaration,$j=($T=$J._shader=$q._getShader($Y._shaderDefineValue,$L.shaderDefineValue,$o._shaderDefineValue)).bind()||$S!==$T._uploadLoopCount,($T._uploadVertexBuffer!==$n||$j)&&($T.uploadAttributes($L.shaderValues.data,null),$T._uploadVertexBuffer=$n),($T._uploadScene!==$Y||$j)&&($T.uploadSceneUniforms($Y._shaderValues.data),$T._uploadScene=$Y),($x!==$T._uploadCamera||$T._uploadSprite3D!==$o||$j)&&($T.uploadSpriteUniforms($o._shaderValues.data),$T._uploadSprite3D=$o),($x!==$T._uploadCamera||$j)&&($T.uploadCameraUniforms($x._shaderValues.data),$T._uploadCamera=$x),($T._uploadMaterial!==$q||$j)&&($q._upload(),$T._uploadMaterial=$q),$k!==$q?($q._setRenderStateBlendDepth(),$q._setRenderStateFrontFace($h,$o.transform),$k=$q,$u=$o):$u!==$o&&($q._setRenderStateFrontFace($h,$o.transform),$u=$o),$i._render($J),$T._uploadLoopCount=$S);}}},$J._renderShadow=function($J,$h){for(var $f,$n,$L,$T,$k,$u=$D.loopCount,$S=this._scene,$Y=$J.camera,$x=!1,$j=0,$R=this._finalElements.length;$j<$R;$j++){var $l,$i,$q,$o=this._finalElements[$j];0===$o._type&&($J.owner=$q=$o._sprite3D,$h||$q._projectionViewWorldUpdateCamera===$Y&&$q._projectionViewWorldUpdateLoopCount===$D.loopCount||($q._render._renderUpdate($J._projectionViewMatrix),$q._projectionViewWorldUpdateLoopCount=$D.loopCount,$q._projectionViewWorldUpdateCamera=$Y),$J.renderElement=$o,$q._preRenderUpdateComponents($J),$l=$o.renderObj,$i=$o._material,this._begainRenderElement($J,$l,null)&&($n=($f=$l._getVertexBuffer(0)).vertexDeclaration,$x=($L=$J._shader=$i._getShader($S._shaderDefineValue,$n.shaderDefineValue,$q._shaderDefineValue)).bind()||$u!==$L._uploadLoopCount,($L._uploadVertexBuffer!==$f||$x)&&($L.uploadAttributes($n.shaderValues.data,null),$L._uploadVertexBuffer=$f),($Y!==$L._uploadCamera||$L._uploadSprite3D!==$q||$x)&&($L.uploadSpriteUniforms($q._shaderValues.data),$L._uploadSprite3D=$q),($Y!==$L._uploadCamera||$x)&&($L.uploadCameraUniforms($Y._shaderValues.data),$L._uploadCamera=$Y),($L._uploadMaterial!==$i||$x)&&($i._upload(),$L._uploadMaterial=$i),$L._uploadRenderElement,$T!==$i?($i._setRenderStateFrontFace(!1,$q.transform),$T=$i,$k=$q):$k!==$q&&($i._setRenderStateFrontFace(!1,$q.transform),$k=$q),$l._render($J),$L._uploadLoopCount=$u),$q._postRenderUpdateComponents($J));}},$J._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0;},$J._addRenderElement=function($J){this._renderElements.push($J),this._needSort=!0;},$J._addDynamicBatchElement=function($J){this._dynamicBatchCombineRenderElements.push($J);},$i(0,$J,"id",function(){return this._id;}),$h._uniqueIDCounter=0,$h._cameraPosition=null,$h;}(),$X=function(){function $J(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null;}return $l($J,"laya.d3.core.render.RenderState"),$J.clientWidth=0,$J.clientHeight=0,$J;}(),$w=function(){function $k($J,$h){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new $NJ(new $kh(),0),this._corners=[new $kh(),new $kh(),new $kh(),new $kh(),new $kh(),new $kh(),new $kh(),new $kh()],this._boundingBoxCenter=new $kh(),this._children=$n(8),this._objects=[],this._tempBoundBoxCorners=[new $kh(),new $kh(),new $kh(),new $kh(),new $kh(),new $kh(),new $kh(),new $kh()],this._scene=$J,this._currentDepth=$h;}$l($k,"laya.d3.core.scene.OctreeNode");var $J=$k.prototype;return $p.imps($J,{"laya.d3.core.scene.ITreeNode":!0}),$J.init=function($J,$h){var $f=new $kh(),$n=new $kh();$kh.scale($h,-.5,$f),$kh.scale($h,.5,$n),$kh.add($f,$J,$f),$kh.add($n,$J,$n),this.exactBox=new $wJ($f,$n),this.relaxBox=new $wJ($f,$n);},$J.addTreeNode=function($J){1===Collision.boxContainsBox(this._relaxBox,$J.boundingBox)?this.addNodeDown($J,0):this.addObject($J);},$J.addChild=function($J){var $h=this._children[$J];if(null==$h){$h=new $k(this._scene,this._currentDepth+1),(this._children[$J]=$h)._parent=this,$kh.subtract(this._exactBox.max,this._exactBox.min,$k.tempSize),$kh.multiply($k.tempSize,$k._octreeSplit[$J],$k.tempCenter),$kh.add(this._exactBox.min,$k.tempCenter,$k.tempCenter),$kh.scale($k.tempSize,.25,$k.tempSize);var $f=new $kh(),$n=new $kh();$kh.subtract($k.tempCenter,$k.tempSize,$f),$kh.add($k.tempCenter,$k.tempSize,$n),$h.exactBox=new $wJ($f,$n),$kh.scale($k.tempSize,$k.relax,$k.tempSize);var $L=new $kh(),$T=new $kh();$kh.subtract($k.tempCenter,$k.tempSize,$L),$kh.add($k.tempCenter,$k.tempSize,$T),$h.relaxBox=new $wJ($L,$T);}return $h;},$J.addObject=function($J){($J._treeNode=this)._objects.push($J);},$J.removeObject=function($J){if($J._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var $h=this._objects.indexOf($J);return-1!==$h&&(this._objects.splice($h,1),!0);},$J.clearObject=function(){this._objects.length=0;},$J.addNodeUp=function($J,$h){this._parent&&1!==Collision.boxContainsBox(this._exactBox,$J.boundingBox)?this._parent.addNodeUp($J,$h-1):this.addNodeDown($J,$h);},$J.addNodeDown=function($J,$h){if($h<this._scene.treeLevel){var $f=this.inChildIndex($J.boundingBoxCenter),$n=this.addChild($f);1===Collision.boxContainsBox($n._relaxBox,$J.boundingBox)?$n.addNodeDown($J,++$h):this.addObject($J);}else this.addObject($J);},$J.inChildIndex=function($J){return 4*($J.z<this._boundingBoxCenter.z?0:1)+2*($J.y<this._boundingBoxCenter.y?0:1)+($J.x<this._boundingBoxCenter.x?0:1);},$J.updateObject=function($J){1===Collision.boxContainsBox(this._relaxBox,$J.boundingBox)?(this.removeObject($J),$J._treeNode=null,this.addNodeDown($J,this._currentDepth)):this._parent&&(this.removeObject($J),$J._treeNode=null,this._parent.addNodeUp($J,this._currentDepth-1));},$J.cullingObjects=function($J,$h,$f,$n,$L){var $T,$k=0,$u=0,$S=0,$Y=this._scene._dynamicBatchManager;for($k=0,$T=this._objects.length;$k<$T;$k++){var $x=this._objects[$k];if($W.isVisible($x._owner.layer.mask)&&$x.enable){if($h&&($D.treeSpriteCollision+=1,0===$J.containsBoundSphere($x.boundingSphere)))continue;$x._renderUpdate($L),$x._distanceForSort=$kh.distance($x.boundingSphere.center,$n)+$x.sortingFudge;var $j=$x._renderElements;for($u=0,$S=$j.length;$u<$S;$u++){var $R=$j[$u],$l=$R._staticBatch;if($l&&$l._material===$R._material)$l._addBatchRenderElement($R);else{var $i=$R.renderObj;$i.triangleCount<10&&1===$i._vertexBufferCount&&$i._getIndexBuffer()&&$R._material.renderQueue<2&&$R._canDynamicBatch&&!$x._owner.isStatic?$Y._addPrepareRenderElement($R):this._scene.getRenderQueue($R._material.renderQueue)._addRenderElement($R);}}}}for($k=0;$k<8;$k++){var $q=this._children[$k];if(null!=$q){var $o=$h;if($h){var $r=$J.containsBoundBox($q._relaxBox);if($D.treeNodeCollision+=1,0===$r)continue;$o=2===$r;}$q.cullingObjects($J,$o,$f,$n,$L);}}},$J.cullingShadowObjects=function($J,$h,$f,$n,$L){var $T,$k=0,$u=0,$S=0;this._scene._dynamicBatchManager;for($k=0,$T=this._objects.length;$k<$T;$k++){var $Y=this._objects[$k];if($Y.castShadow&&$W.isVisible($Y._owner.layer.mask)&&$Y.enable){if($f&&0===$J[0].containsBoundSphere($Y.boundingSphere))continue;for(var $x=1,$j=$J.length;$x<$j;$x++){var $R=$h[$x-1];if(0!==$J[$x].containsBoundSphere($Y.boundingSphere)){var $l=$Y._renderElements;for($u=0,$S=$l.length;$u<$S;$u++)$R._addRenderElement($l[$u]);}}}}for($k=0;$k<8;$k++){var $i=this._children[$k];if(null!=$i){var $q=$f;if($f){var $o=$J[0].containsBoundBox($i._relaxBox);if(0===$o)continue;$q=2===$o;}$i.cullingShadowObjects($J,$h,$q,$n,$L);}}},$J.cullingShadowObjectsOnePSSM=function($J,$h,$f,$n,$L,$T){var $k,$u=$h[0],$S=0,$Y=0,$x=0;for($S=0,$k=this._objects.length;$S<$k;$S++){var $j=this._objects[$S];if($j.castShadow&&$W.isVisible($j._owner.layer.mask)&&$j.enable){if($n&&0===$J.containsBoundSphere($j.boundingSphere))continue;$j._renderUpdate($f);var $R=$j._renderElements;for($Y=0,$x=$R.length;$Y<$x;$Y++)$u._addRenderElement($R[$Y]);}}for($S=0;$S<8;$S++){var $l=this._children[$S];if(null!=$l){var $i=$n;if($n){var $q=$J.containsBoundBox($l._relaxBox);if(0===$q)continue;$i=2===$q;}$l.cullingShadowObjectsOnePSSM($J,$h,$f,$i,$L,$T);}}},$J.renderBoudingBox=function($J){this._renderBoudingBox($J);for(var $h=0;$h<8;++$h){var $f=this._children[$h];$f&&$f.renderBoudingBox($J);}},$J.buildAllChild=function($J){if($J<this._scene.treeLevel)for(var $h=0;$h<8;$h++){this.addChild($h).buildAllChild($J+1);}},$J._renderBoudingBox=function($J){},$i(0,$J,"exactBox",function(){return this._exactBox;},function($J){this._exactBox=$J,$kh.add($J.min,$J.max,this._boundingBoxCenter),$kh.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter);}),$i(0,$J,"relaxBox",function(){return this._relaxBox;},function($J){(this._relaxBox=$J).getCorners(this._corners),$NJ.createfromPoints(this._corners,this._boundingSphere);}),$k.debugMode=!1,$k.relax=1.15,$k.CHILDNUM=8,$j($k,["tempVector0",function(){return this.tempVector0=new $kh();},"tempSize",function(){return this.tempSize=new $kh();},"tempCenter",function(){return this.tempCenter=new $kh();},"_octreeSplit",function(){return this._octreeSplit=[new $kh(.25,.25,.25),new $kh(.75,.25,.25),new $kh(.25,.75,.25),new $kh(.75,.75,.25),new $kh(.25,.25,.75),new $kh(.75,.25,.75),new $kh(.25,.75,.75),new $kh(.75,.75,.75)];}]),$k;}(),$E=(function(){function $J(){}$l($J,"laya.d3.core.scene.SceneManager");}(),function(){function $J($J,$h,$f,$n){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===$J&&($J=1),void 0===$h&&($h=1),void 0===$f&&($f=1),void 0===$n&&($n=1),this._r=$J,this._g=$h,this._b=$f,this._a=$n;}return $l($J,"laya.d3.core.trail.module.Color",null,"Color$1"),$J.prototype.cloneTo=function($J){$J._r=this._r,$J._g=this._g,$J._b=this._b,$J._a=this._a;},$j($J,["RED",function(){return this.RED=new $J(1,0,0,1);},"GREEN",function(){return this.GREEN=new $J(0,1,0,1);},"BLUE",function(){return this.BLUE=new $J(0,0,1,1);},"CYAN",function(){return this.CYAN=new $J(0,1,1,1);},"YELLOW",function(){return this.YELLOW=new $J(1,.92,.016,1);},"MAGENTA",function(){return this.MAGENTA=new $J(1,0,1,1);},"GRAY",function(){return this.GRAY=new $J(.5,.5,.5,1);},"WHITE",function(){return this.WHITE=new $J(1,1,1,1);},"BLACK",function(){return this.BLACK=new $J(0,0,0,1);}]),$J;}()),$N=(function(){function $J(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[];}$l($J,"laya.d3.core.trail.module.Gradient");var $h=$J.prototype;$h.setKeys=function($J,$h){var $f,$n;this._colorKeys=$J;for(var $L=this.index=0;$L<$J.length;$L++){var $T=($f=$J[$L]).color;this._colorKeyData[this.index++]=$T._r,this._colorKeyData[this.index++]=$T._g,this._colorKeyData[this.index++]=$T._b,this._colorKeyData[this.index++]=$f.time;}this._alphaKeys=$h;for(var $k=this.index=0;$k<$h.length;$k++)$n=$h[$k],this._alphaKeyData[this.index++]=$n.alpha,this._alphaKeyData[this.index++]=$n.time;},$h.cloneTo=function($J){var $h=0,$f=0,$n=this.colorKeys,$L=[];for($h=0,$f=$n.length;$h<$f;$h++){var $T=new $z();$n[$h].cloneTo($T),$L.push($T);}var $k=this.alphaKeys,$u=[];for($h=0,$f=$k.length;$h<$f;$h++){var $S=new $N();$k[$h].cloneTo($S),$u.push($S);}$J.setKeys($L,$u);},$i(0,$h,"mode",function(){return this._mode;},function($J){this._mode=$J;}),$i(0,$h,"colorKeys",function(){return this._colorKeys;},function($J){this._colorKeys=$J;for(var $h=this.index=0;$h<$J.length;$h++){var $f=$J[$h],$n=$f.color;this._colorKeyData[this.index++]=$n._r,this._colorKeyData[this.index++]=$n._g,this._colorKeyData[this.index++]=$n._b,this._colorKeyData[this.index++]=$f.time;}}),$i(0,$h,"alphaKeys",function(){return this._alphaKeys;},function($J){this._alphaKeys=$J;for(var $h=this.index=0;$h<$J.length;$h++){var $f=$J[$h];this._alphaKeyData[this.index++]=$f.alpha,this._alphaKeyData[this.index++]=$f.time;}});}(),function(){function $J($J,$h){this._alpha=NaN,this._time=NaN,void 0===$J&&($J=0),void 0===$h&&($h=0),this._alpha=$J,this._time=$h;}$l($J,"laya.d3.core.trail.module.GradientAlphaKey");var $h=$J.prototype;return $h.cloneTo=function($J){$J.alpha=this.alpha,$J.time=this.time;},$i(0,$h,"alpha",function(){return this._alpha;},function($J){this._alpha=$J;}),$i(0,$h,"time",function(){return this._time;},function($J){this._time=$J;}),$J;}()),$z=function(){function $J($J,$h){this._color=null,this._time=NaN,void 0===$h&&($h=0),this._color=$J||new $E(),this._time=$h;}$l($J,"laya.d3.core.trail.module.GradientColorKey");var $h=$J.prototype;return $h.cloneTo=function($J){this.color.cloneTo($J.color),$J.time=this.time;},$i(0,$h,"color",function(){return this._color;},function($J){this._color=$J;}),$i(0,$h,"time",function(){return this._time;},function($J){this._time=$J;}),$J;}(),$K=(function(){function $J(){}$l($J,"laya.d3.core.trail.module.GradientMode"),$J.Blend=0,$J.Fixed=1;}(),function(){function $J(){}$l($J,"laya.d3.core.trail.module.TextureMode"),$J.Stretch=0,$J.Tile=1;}(),function(){function $J(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN;}$l($J,"laya.d3.core.trail.module.TrailKeyFrame"),$J.prototype.cloneTo=function($J){$J.time=this.time,$J.inTangent=this.inTangent,$J.outTangent=this.outTangent,$J.value=this.value;};}(),function(){function $h($J){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new $kh(),this._curPosition=new $kh(),this._delVector3=new $kh(),this._lastFixedVertexPosition=new $kh(),this._pointAtoBVector3=new $kh(),this._pointA=new $kh(),this._pointB=new $kh(),this._owner=$J,this._id=$h.renderElementCount++,0==this._id?$J._owner.transform.position.cloneTo(this._lastPosition):$J._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new $ah($K.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new $ah($K.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2);}$l($h,"laya.d3.core.trail.TrailRenderElement");var $J=$h.prototype;$p.imps($J,{"laya.d3.core.render.IRenderable":!0}),$J._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1);},$J._addTrailByFirstPosition=function($J,$h){$kh.subtract($h,$J,this._delVector3),$kh.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$kh.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$kh.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition($J),$J.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0;},$J._addTrailByNextPosition=function($J){$kh.subtract($J,this._lastFixedVertexPosition,this._delVector3),$kh.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$kh.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$kh.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=$kh.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=$zJ.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition($J),$J.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition($J),this._virtualVerticesCount=2);},$J._updateVerticesByPosition=function($J){this._pointe=$J.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0;},$J._updateVertexBuffer2=function(){var $J,$h=0,$f=0,$n=0;for($n=0,$J=(this._verticesCount+this._virtualVerticesCount)/2;$n<$J;$n++)$f=0==this._owner.textureMode?(this._VerticesToTailLength[$n]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[$n],this._vertices2[$h++]=1-$f,this._vertices2[$h++]=1-$f;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount);},$J._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0;},$J._updateDisappear=function(){var $J,$h=0;for($h=this._curDisappearIndex,$J=(this._verticesCount+this._virtualVerticesCount)/2;$h<$J;$h++)this._owner._curtime-this._everyGroupVertexBirthTime[$h]>=this._owner.time+$zJ.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0));},$J._beforeRender=function($J){return this._camera=$J.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),$kh.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0));},$J._render=function($J){this._isDead||($y.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),$D.drawCall++,$D.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2);},$J._getVertexBuffer=function($J){return void 0===$J&&($J=0),0===$J?this._vertexBuffer1:1===$J?this._vertexBuffer2:null;},$J._getVertexBuffers=function(){return this._vertexBuffers;},$J._getIndexBuffer=function(){return null;},$J.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition);},$J._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null;},$i(0,$J,"_vertexBufferCount",function(){return this._vertexBuffers.length;}),$i(0,$J,"triangleCount",function(){return 0;}),$h.renderElementCount=0;}(),function(){function $J(){}$l($J,"laya.d3.core.trail.VertexTrail");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration1;}),$i(1,$J,"vertexDeclaration1",function(){return $J._vertexDeclaration1;}),$i(1,$J,"vertexDeclaration2",function(){return $J._vertexDeclaration2;}),$j($J,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new $TJ(32,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",41),new $kJ(24,"single",33),new $kJ(28,"single",40)]);},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new $TJ(4,[new $kJ(0,"single",38)]);}]),$J;}()),$JJ=function(){function $d($J){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=$J;}$l($d,"laya.d3.graphics.DynamicBatch");var $J=$d.prototype;return $p.imps($J,{"laya.d3.core.render.IRenderable":!0}),$J._getVertexBuffer=function($J){return void 0===$J&&($J=0),0===$J?this._vertexBuffer:null;},$J._getIndexBuffer=function(){return this._indexBuffer;},$J._getCombineRenderElementFromPool=function($J,$h,$f){var $n=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return $n||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=$n=new $$(),$n._sprite3D=new $Mh()),$n._sprite3D._render._renderUpdate($f),$n;},$J._getRenderElement=function($J,$h,$f){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*$d.maxVertexCount),this._indexDatas=new Uint16Array($d.maxIndexCount),this._vertexBuffer=$ah.create(this._vertexDeclaration,$d.maxVertexCount,35048),this._indexBuffer=$ch.create("ushort",$d.maxIndexCount,35048));for(var $n=this._merageElements.length=0,$L=0,$T=0,$k=this._combineRenderElements.length;$T<$k;$T++){var $u=this._combineRenderElements[$T],$S=$u.getDynamicBatchBakedVertexs(0),$Y=$u.getBakedIndices(),$x=$u._sprite3D.transform._isFrontFaceInvert,$j=$n/(this._vertexDeclaration.vertexStride/4),$R=$L,$l=$R+$Y.length;$u._tempBatchIndexStart=$R,$u._tempBatchIndexEnd=$l,this._indexDatas.set($Y,$L);var $i=0;if($x)for($i=$R;$i<$l;$i+=3){this._indexDatas[$i]=$j+this._indexDatas[$i];var $q=this._indexDatas[$i+1],$o=this._indexDatas[$i+2];this._indexDatas[$i+1]=$j+$o,this._indexDatas[$i+2]=$j+$q;}else for($i=$R;$i<$l;$i+=3)this._indexDatas[$i]=$j+this._indexDatas[$i],this._indexDatas[$i+1]=$j+this._indexDatas[$i+1],this._indexDatas[$i+2]=$j+this._indexDatas[$i+2];$L+=$Y.length,this._vertexDatas.set($S,$n),$n+=$S.length;}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),$T=this._combineRenderElementPoolIndex=0,$k=this._materials.length;$T<$k;$T++){var $r=this._getCombineRenderElementFromPool($J,$h,$f);$r._type=2,$r._staticBatch=null;var $_=($r.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[$T]]._tempBatchIndexStart,$s=$T+1===this._materialToRenderElementsOffsets.length?$L:this._combineRenderElements[this._materialToRenderElementsOffsets[$T+1]]._tempBatchIndexStart;$r._tempBatchIndexStart=$_,$r._tempBatchIndexEnd=$s,$r._material=this._materials[$T],this._merageElements.push($r);}},$J._addCombineRenderObjTest=function($J){var $h=$J.renderObj,$f=this._currentCombineIndexCount+$h._getIndexBuffer().indexCount,$n=this._currentCombineVertexCount+$h._getVertexBuffer().vertexCount;return!($d.maxVertexCount<$n||$d.maxIndexCount<$f);},$J._addCombineRenderObj=function($J){var $h=$J.renderObj;this._combineRenderElements.push($J),this._currentCombineIndexCount=this._currentCombineIndexCount+$h._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$h._getVertexBuffer().vertexCount;},$J._addCombineMaterial=function($J){this._materials.push($J);},$J._addMaterialToRenderElementOffset=function($J){this._materialToRenderElementsOffsets.push($J);},$J._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0;},$J._addToRenderQueue=function($J,$h,$f,$n){this._getRenderElement($h,$f,$n);for(var $L=0,$T=this._materials.length;$L<$T;$L++)$J.getRenderQueue(this._materials[$L].renderQueue)._addDynamicBatchElement(this._merageElements[$L]);},$J._beforeRender=function($J){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0;},$J._render=function($J){var $h=$J._batchIndexEnd-$J._batchIndexStart;$y.mainContext.drawElements(4,$h,5123,2*$J._batchIndexStart),$D.drawCall++,$D.trianglesFaces+=$h/3;},$J._getVertexBuffers=function(){return null;},$i(0,$J,"_vertexBufferCount",function(){return 1;}),$i(0,$J,"triangleCount",function(){return this._indexBuffer.indexCount/3;}),$i(0,$J,"combineRenderElementsCount",function(){return this._combineRenderElements.length;}),$d.maxVertexCount=2e4,$d.maxIndexCount=4e4,$d.maxCombineTriangleCount=10,$d;}(),$hJ=function(){function $d(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[];}$l($d,"laya.d3.graphics.DynamicBatchManager");var $J=$d.prototype;return $J.getDynamicBatch=function($J,$h){var $f,$n=$J.id.toString()+$h;return this._dynamicBatches[$n]?$f=this._dynamicBatches[$n]:this._dynamicBatches[$n]=$f=new $JJ($J),$f;},$J._garbageCollection=function(){for(var $J in this._dynamicBatches)0===this._dynamicBatches[$J].combineRenderElementsCount&&delete this._dynamicBatches[$J];},$J._addPrepareRenderElement=function($J){this._prepareDynamicBatchCombineElements.push($J);},$J._finishCombineDynamicBatch=function($J){var $h,$f,$n;this._prepareDynamicBatchCombineElements.sort($d._sortPrepareDynamicBatch);for(var $L,$T,$k,$u,$S,$Y=-1,$x=!0,$j=0,$R=-1,$l=0,$i=this._prepareDynamicBatchCombineElements.length;$l<$i;$l++){var $q=($T=this._prepareDynamicBatchCombineElements[$l]).renderObj._getVertexBuffer(0).vertexDeclaration,$o=$f!==$q;$o&&($j=0,$f=$q);var $r=$j!==$Y;if($r&&($Y=$j),($o||$r)&&($k=this.getDynamicBatch($q,$j),$h=null),$x){if($k._addCombineRenderObjTest($T)){if($h!==($L=$T._material))$u&&($J.getRenderQueue($S._material.renderQueue)._addRenderElement($S),$S=$u=null,$R=-1),$u=$L,$R=$k.combineRenderElementsCount,$S=$T,$h=$L;else if($u){var $_=$S.renderObj,$s=$T.renderObj;$_._getVertexBuffer().vertexCount+$s._getVertexBuffer().vertexCount>$JJ.maxVertexCount||$_._getIndexBuffer().indexCount+$s._getIndexBuffer().indexCount>$JJ.maxIndexCount?($J.getRenderQueue($S._material.renderQueue)._addRenderElement($S),$u=$L,$R=$k.combineRenderElementsCount,$S=$T):($k._addCombineMaterial($u),$k._addMaterialToRenderElementOffset($R),$k._addCombineRenderObj($S),$S=$u=null,$R=-1,$k._addCombineRenderObj($T));}else $k._addCombineRenderObj($T);$x=!0;}else $u&&($J.getRenderQueue($S._material.renderQueue)._addRenderElement($S),$S=$u=null,$R=-1),$j++,$x=!1;}else $n=this._prepareDynamicBatchCombineElements[$l-1],$k._addMaterialToRenderElementOffset($k.combineRenderElementsCount),$h=$n._material,$k._addCombineMaterial($h),$k._addCombineRenderObj($n),$x=!0,$h!==($L=$T._material)?($u=$L,$R=$k.combineRenderElementsCount,$S=$T):$k._addCombineRenderObj($T),$h=$L;}$u&&($J.getRenderQueue($S._material.renderQueue)._addRenderElement($S),$S=$u=null,$R=-1),this._prepareDynamicBatchCombineElements.length=0;},$J._clearRenderElements=function(){for(var $J in this._dynamicBatches)this._dynamicBatches[$J]._clearRenderElements();},$J._addToRenderQueue=function($J,$h,$f,$n){for(var $L in this._dynamicBatches){var $T=this._dynamicBatches[$L];0<$T.combineRenderElementsCount&&$T._addToRenderQueue($J,$h,$f,$n);}},$J.dispose=function(){this._dynamicBatches=null;},$d._sortPrepareDynamicBatch=function($J,$h){return $J._mainSortID-$h._mainSortID;},$d;}(),$fJ=function(){function $J(){}return $l($J,"laya.d3.graphics.FrustumCulling"),$J.renderShadowObjectCulling=function($J,$h,$f,$n,$L){var $T=0,$k=0,$u=0,$S=0;for($T=0,$u=$f.length;$T<$u;$T++){var $Y=$f[$T];$Y&&$Y._clearRenderElements();}var $x,$j,$R,$l=$J._cullingRenders;if(1<$L){for($T=0,$u=$J._cullingRendersLength;$T<$u;$T++)if(($x=$l[$T]).castShadow&&$W.isVisible($x._owner.layer.mask)&&$x.enable)for(var $i=1,$q=$h.length;$i<$q;$i++)if($j=$f[$i-1],0!==$h[$i].containsBoundSphere($x.boundingSphere))for($k=0,$S=($R=$x._renderElements).length;$k<$S;$k++)$j._addRenderElement($R[$k]);}else for($T=0,$u=$J._cullingRendersLength;$T<$u;$T++)if(($x=$l[$T]).castShadow&&$W.isVisible($x._owner.layer.mask)&&$x.enable&&0!==$h[0].containsBoundSphere($x.boundingSphere))for($x._renderUpdate($n),$j=$f[0],$k=0,$S=($R=$x._renderElements).length;$k<$S;$k++)$j._addRenderElement($R[$k]);},$J.renderShadowObjectCullingOctree=function($J,$h,$f,$n,$L){for(var $T=0,$k=$f.length;$T<$k;$T++){var $u=$f[$T];$u&&$u._clearRenderElements();}1<$L?$J.treeRoot.cullingShadowObjects($h,$f,!0,0,$J):$J.treeRoot.cullingShadowObjectsOnePSSM($h[0],$f,$n,!0,0,$J);},$J.renderObjectCulling=function($J,$h,$f,$n,$L,$T){var $k=0,$u=0,$S=0,$Y=0,$x=$h._quenes,$j=$h._dynamicBatchManager,$R=$h._cullingRenders;for($k=0,$u=$x.length;$k<$u;$k++){var $l=$x[$k];$l&&$l._clearRenderElements();}var $i=$nJ._staticBatchManagers;for($k=0,$u=$i.length;$k<$u;$k++)$i[$k]._clearRenderElements();$j._clearRenderElements();var $q=$f.transform.position;for($k=0,$u=$h._cullingRendersLength;$k<$u;$k++){var $o=$R[$k];if($W.isVisible($o._owner.layer.mask)&&$o.enable&&0!==$J.containsBoundSphere($o.boundingSphere)&&$o._renderUpdate($T)){$o._distanceForSort=$kh.distance($o.boundingSphere.center,$q)+$o.sortingFudge;var $r=$o._renderElements;for($S=0,$Y=$r.length;$S<$Y;$S++){var $_=$r[$S],$s=$_._staticBatch;if($s&&$s._material===$_._material)$s._addBatchRenderElement($_);else{var $d=$_.renderObj;$d.triangleCount<10&&1===$d._vertexBufferCount&&$d._getIndexBuffer()&&$_._material.renderQueue<2&&$_._canDynamicBatch&&!$o._owner.isStatic?$j._addPrepareRenderElement($_):$h.getRenderQueue($_._material.renderQueue)._addRenderElement($_);}}}}for($k=0,$u=$i.length;$k<$u;$k++)$i[$k]._addToRenderQueue($h,$n,$L,$T);$j._finishCombineDynamicBatch($h),$j._addToRenderQueue($h,$n,$L,$T);},$J.renderObjectCullingOctree=function($J,$h,$f,$n,$L,$T){var $k=0,$u=0,$S=$h._quenes,$Y=$h._dynamicBatchManager;for($k=0,$u=$S.length;$k<$u;$k++){var $x=$S[$k];$x&&$x._clearRenderElements();}var $j=$nJ._staticBatchManagers;for($k=0,$u=$j.length;$k<$u;$k++)$j[$k]._clearRenderElements();for($Y._clearRenderElements(),$h._cullingRenders.length=0,$h.treeRoot.cullingObjects($J,!0,0,$f.transform.position,$T),$k=0,$u=$j.length;$k<$u;$k++)$j[$k]._addToRenderQueue($h,$n,$L,$T);$Y._finishCombineDynamicBatch($h),$Y._addToRenderQueue($h,$n,$L,$T);},$J.renderObjectCullingNoBoundFrustum=function($J,$h,$f,$n,$L){var $T=0,$k=0,$u=0,$S=0,$Y=$J._quenes,$x=$J._dynamicBatchManager,$j=$J._cullingRenders;for($T=0,$k=$Y.length;$T<$k;$T++){var $R=$Y[$T];$R&&$R._clearRenderElements();}var $l=$nJ._staticBatchManagers;for($T=0,$k=$l.length;$T<$k;$T++)$l[$T]._clearRenderElements();$x._clearRenderElements();var $i=$h.transform.position;for($T=0,$k=$J._cullingRendersLength;$T<$k;$T++){var $q=$j[$T];if($W.isVisible($q._owner.layer.mask)&&$q.enable){$q._renderUpdate($L),$q._distanceForSort=$kh.distance($q.boundingSphere.center,$i)+$q.sortingFudge;var $o=$q._renderElements;for($u=0,$S=$o.length;$u<$S;$u++){var $r=$o[$u],$_=$r._staticBatch;if($_&&$_._material===$r._material)$_._addBatchRenderElement($r);else{var $s=$r.renderObj;$s.triangleCount<10&&1===$s._vertexBufferCount&&$s._getIndexBuffer()&&$r._material.renderQueue<2&&$r._canDynamicBatch&&!$q._owner.isStatic?$x._addPrepareRenderElement($r):$J.getRenderQueue($r._material.renderQueue)._addRenderElement($r);}}}}for($T=0,$k=$l.length;$T<$k;$T++)$l[$T]._addToRenderQueue($J,$f,$n,$L);$x._finishCombineDynamicBatch($J),$x._addToRenderQueue($J,$f,$n,$L);},$J;}(),$nJ=function(){function $T(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={};}$l($T,"laya.d3.graphics.StaticBatchManager");var $J=$T.prototype;return $J._finishInit=function(){for(var $J in this._staticBatches)this._staticBatches[$J]._finishInit();this._initBatchRenderElements.length=0;},$J._initStaticBatchs=function($J){throw new Error("StaticBatchManager:must override this function.");},$J._addInitBatchSprite=function($J){for(var $h=$J._render._renderElements,$f=0,$n=$h.length;$f<$n;$f++)this._initBatchRenderElements.push($h[$f]);},$J._clearRenderElements=function(){for(var $J in this._staticBatches)this._staticBatches[$J]._clearRenderElements();},$J._garbageCollection=function($J){var $h=$J._staticBatch,$f=$h._initBatchRenderElements,$n=$f.indexOf($J);$f.splice($n,1),0===$f.length&&($h.dispose(),delete this._staticBatches[$h._key]);},$J._addToRenderQueue=function($J,$h,$f,$n){for(var $L in this._staticBatches){var $T=this._staticBatches[$L];0<$T._batchRenderElements.length&&$T._updateToRenderQueue($J,$n);}},$J.dispose=function(){this._staticBatches=null;},$T._addToStaticBatchQueue=function($J){$J instanceof laya.d3.core.RenderableSprite3D&&$J._addToInitStaticBatchManager();for(var $h=0,$f=$J.numChildren;$h<$f;$h++)$T._addToStaticBatchQueue($J._childs[$h]);},$T.combine=function($J,$h){var $f,$n=0,$L=0;if($h)for($n=0,$L=$h.length;$n<$L;$n++){$h[$n]._addToInitStaticBatchManager();}else $J&&$T._addToStaticBatchQueue($J);for($n=0,$L=$T._staticBatchManagers.length;$n<$L;$n++)($f=$T._staticBatchManagers[$n])._initStaticBatchs($J),$f._finishInit();},$T._staticBatchManagers=[],$T;}(),$LJ=function(){function $J($J,$h,$f){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=$J,this._manager=$h,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=$f;}$l($J,"laya.d3.graphics.StaticBatch");var $h=$J.prototype;return $p.imps($h,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$h._binarySearch=function($J){for(var $h=0,$f=this._batchRenderElements.length-1,$n=0;$h<=$f;)$n=Math.floor(($h+$f)/2),this._compareBatchRenderElement(this._batchRenderElements[$n],$J)?$f=$n-1:$h=$n+1;return $h;},$h._compareBatchRenderElement=function($J,$h){throw new Error("StaticBatch:must override this function.");},$h._getVertexDecLightMap=function($J){return $J===$cJ.vertexDeclaration?$WJ.vertexDeclaration:$J===$tJ.vertexDeclaration?$PJ.vertexDeclaration:$J===$gJ.vertexDeclaration?$dJ.vertexDeclaration:$J===$CJ.vertexDeclaration?null:$J===$qJ.vertexDeclaration?$oJ.vertexDeclaration:$J===$BJ.vertexDeclaration?$mJ.vertexDeclaration:$J===$yJ.vertexDeclaration?$OJ.vertexDeclaration:$J===$aJ.vertexDeclaration?$IJ.vertexDeclaration:$J===$tJ.vertexDeclaration?$PJ.vertexDeclaration:$J===$FJ.vertexDeclaration?$pJ.vertexDeclaration:$J===$CJ.vertexDeclaration?null:$J===$qJ.vertexDeclaration?$oJ.vertexDeclaration:$J===$VJ.vertexDeclaration?$ZJ.vertexDeclaration:$J===$yJ.vertexDeclaration?$OJ.vertexDeclaration:$J;},$h._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.");},$h._addBatchRenderElement=function($J){this._batchRenderElements.splice(this._binarySearch($J),0,$J);},$h._updateToRenderQueue=function($J,$h){this._combineRenderElementPoolIndex=0,this._getRenderElement($J.getRenderQueue(this._material.renderQueue)._renderElements,$J,$h);},$h._getRenderElement=function($J,$h,$f){throw new Error("StaticBatch:must override this function.");},$h._finishInit=function(){throw new Error("StaticBatch:must override this function.");},$h._clearRenderElements=function(){this._batchRenderElements.length=0;},$h.dispose=function(){},$h._getVertexBuffer=function($J){return void 0===$J&&($J=0),null;},$h._getIndexBuffer=function(){return null;},$h._beforeRender=function($J){return!0;},$h._render=function($J){},$h._getVertexBuffers=function(){return null;},$i(0,$h,"_vertexBufferCount",function(){return 1;}),$i(0,$h,"triangleCount",function(){return 0;}),$J.combine=function($J){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),$nJ.combine($J);},$J.maxBatchVertexCount=65535,$J;}(),$TJ=function(){function $k($J,$h){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++$k._uniqueIDCounter,this._id>$k.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",$k.maxVertexDeclaration);this._shaderValues=new $Rh(),this._vertexElementsDic={},this._vertexStride=$J,this._vertexElements=$h;for(var $f=0;$f<$h.length;$f++){var $n=$h[$f],$L=$n.elementUsage;this._vertexElementsDic[$L]=$n;var $T=[$k._getTypeSize($n.elementFormat)/4,5126,!1,this._vertexStride,$n.offset];switch(this._shaderValues.setValue($L,$T),$L){case 1:this._addShaderDefine($Dh.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine($Dh.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine($Dh.SHADERDEFINE_UV1);}}}$l($k,"laya.d3.graphics.VertexDeclaration");var $J=$k.prototype;return $J._addShaderDefine=function($J){this._shaderDefineValue|=$J;},$J._removeShaderDefine=function($J){this._shaderDefineValue&=~$J;},$J.getVertexElements=function(){return this._vertexElements.slice();},$J.getVertexElementByUsage=function($J){return this._vertexElementsDic[$J];},$J.unBinding=function(){},$i(0,$J,"shaderDefineValue",function(){return this._shaderDefineValue;}),$i(0,$J,"id",function(){return this._id;}),$i(0,$J,"vertexStride",function(){return this._vertexStride;}),$i(0,$J,"shaderValues",function(){return this._shaderValues;}),$k._getTypeSize=function($J){switch($J){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8;}return 0;},$k.getVertexStride=function($J){for(var $h=0,$f=0;$f<$J.Length;$f++){var $n=$J[$f],$L=$n.offset+$k._getTypeSize($n.elementFormat);$h<$L&&($h=$L);}return $h;},$k._maxVertexDeclarationBit=1e3,$k._uniqueIDCounter=1,$j($k,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647);}]),$k;}(),$kJ=function(){function $J($J,$h,$f){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=$J,this.elementFormat=$h,this.elementUsage=$f;}return $l($J,"laya.d3.graphics.VertexElement"),$J;}(),$uJ=(function(){function $J(){}$l($J,"laya.d3.graphics.VertexElementFormat"),$J.Single="single",$J.Vector2="vector2",$J.Vector3="vector3",$J.Vector4="vector4",$J.Color="color",$J.Byte4="byte4",$J.Short2="short2",$J.Short4="short4",$J.NormalizedShort2="normalizedshort2",$J.NormalizedShort4="normalizedshort4",$J.HalfVector2="halfvector2",$J.HalfVector4="halfvector4";}(),function(){function $J(){}$l($J,"laya.d3.graphics.VertexElementUsage"),$J.POSITION0=0,$J.COLOR0=1,$J.TEXTURECOORDINATE0=2,$J.NORMAL0=3,$J.BINORMAL0=4,$J.TANGENT0=5,$J.BLENDINDICES0=6,$J.BLENDWEIGHT0=7,$J.DEPTH0=8,$J.FOG0=9,$J.POINTSIZE0=10,$J.SAMPLE0=11,$J.TESSELLATEFACTOR0=12,$J.COLOR1=13,$J.NEXTTEXTURECOORDINATE0=14,$J.TEXTURECOORDINATE1=15,$J.NEXTTEXTURECOORDINATE1=16,$J.CORNERTEXTURECOORDINATE0=17,$J.VELOCITY0=18,$J.STARTCOLOR0=19,$J.STARTSIZE=20,$J.AGEADDSCALE0=21,$J.STARTROTATION=22,$J.ENDCOLOR0=23,$J.STARTLIFETIME=24,$J.TIME0=33,$J.SHAPEPOSITIONSTARTLIFETIME=30,$J.DIRECTIONTIME=32,$J.SIZEROTATION0=27,$J.RADIUS0=28,$J.RADIAN0=29,$J.STARTSPEED=31,$J.RANDOM0=34,$J.RANDOM1=35,$J.SIMULATIONWORLDPOSTION=36,$J.SIMULATIONWORLDROTATION=37,$J.TEXTURECOORDINATE0X=38,$J.TEXTURECOORDINATE0X1=39,$J.TEXTURECOORDINATE0Y=40,$J.OFFSETVECTOR=41;}(),function(){function $J($J,$h,$f){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=$J,this._textureCoordinate0=$h,this._time=$f;}$l($J,"laya.d3.graphics.VertexGlitter");var $h=$J.prototype;$p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate0;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"time",function(){return this._time;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(24,[new $kJ(0,"vector3",0),new $kJ(12,"vector2",2),new $kJ(20,"single",33)]);}]);}(),function(){function $J($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=$J,this._position=$h,this._velocity=$f,this._startColor=$n,this._endColor=$L,this._sizeRotation=$T,this._radius=$k,this._radian=$u,this._ageAddScale=$S,this._time=$Y;}$l($J,"laya.d3.graphics.VertexParticle");var $h=$J.prototype;$p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"endColor",function(){return this._endColor;}),$i(0,$h,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate;}),$i(0,$h,"sizeRotation",function(){return this._sizeRotation;}),$i(0,$h,"velocity",function(){return this._velocity;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"startColor",function(){return this._startColor;}),$i(0,$h,"radius",function(){return this._radius;}),$i(0,$h,"radian",function(){return this._radian;}),$i(0,$h,"ageAddScale",function(){return this._ageAddScale;}),$i(0,$h,"time",function(){return this._time;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(116,[new $kJ(0,"vector4",17),new $kJ(16,"vector3",0),new $kJ(28,"vector3",18),new $kJ(40,"vector4",19),new $kJ(56,"vector4",23),new $kJ(72,"vector3",27),new $kJ(84,"vector2",28),new $kJ(92,"vector4",29),new $kJ(108,"single",24),new $kJ(112,"single",33)]);}]);}(),function(){function $J($J){this._position=null,this._position=$J;}$l($J,"laya.d3.graphics.VertexPosition");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(12,[new $kJ(0,"vector3",0)]);}]),$J;}()),$SJ=function(){function $J($J,$h){this._position=null,this._normal=null,this._position=$J,this._normal=$h;}$l($J,"laya.d3.graphics.VertexPositionNormal");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(24,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3)]);}]),$J;}(),$YJ=function(){function $J($J,$h,$f){this._position=null,this._normal=null,this._color=null,this._position=$J,this._normal=$h,this._color=$f;}$l($J,"laya.d3.graphics.VertexPositionNormalColor");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(40,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1)]);}]),$J;}(),$xJ=function(){function $J($J,$h,$f,$n,$L){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=$J,this._normal=$h,this._color=$f,this._blendIndex=$n,this._blendWeight=$L;}$l($J,"laya.d3.graphics.VertexPositionNormalColorSkin");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(72,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector4",7),new $kJ(56,"vector4",6)]);}]),$J;}(),$jJ=function(){function $J($J,$h,$f,$n,$L,$T){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$J,this._normal=$h,this._color=$f,this._tangent=$n,this._blendIndex=$L,this._blendWeight=$T;}$l($J,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(88,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector4",7),new $kJ(56,"vector4",6),new $kJ(72,"vector4",5)]);}]),$J;}(),$RJ=function(){function $J($J,$h,$f,$n,$L,$T){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$J,this._normal=$h,this._color=$f,this._tangent=$n,this._blendIndex=$L,this._blendWeight=$T;}$l($J,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(84,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector4",7),new $kJ(56,"vector4",6),new $kJ(72,"vector3",5)]);}]),$J;}(),$lJ=function(){function $J($J,$h,$f,$n){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$J,this._normal=$h,this._color=$f,this._tangent=$n;}$l($J,"laya.d3.graphics.VertexPositionNormalColorSTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(56,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector4",5)]);}]),$J;}(),$iJ=function(){function $J($J,$h,$f,$n){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$J,this._normal=$h,this._color=$f,this._tangent=$n;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(52,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector3",5)]);}]),$J;}(),$qJ=function(){function $J($J,$h,$f,$n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=$J,this._normal=$h,this._color=$f,this._textureCoordinate=$n;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTexture");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(48,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector2",2)]);}]),$J;}(),$oJ=function(){function $J($J,$h,$f,$n,$L){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$J,this._normal=$h,this._color=$f,this._textureCoordinate0=$n,this._textureCoordinate1=$L;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(56,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector2",2),new $kJ(48,"vector2",15)]);}]),$J;}(),$rJ=function(){function $J($J,$h,$f,$n,$L,$T,$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$J,this._normal=$h,this._color=$f,this._textureCoordinate0=$n,this._textureCoordinate1=$L,this._blendIndex=$T,this._blendWeight=$k;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(88,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector2",2),new $kJ(48,"vector2",15),new $kJ(56,"vector4",7),new $kJ(72,"vector4",6)]);}]),$J;}(),$_J=function(){function $J($J,$h,$f,$n,$L,$T,$k,$u){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$J,this._normal=$h,this._color=$f,this._textureCoordinate0=$n,this._textureCoordinate1=$L,this._tangent=$T,this._blendIndex=$k,this._blendWeight=$u;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(104,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector2",2),new $kJ(48,"vector2",15),new $kJ(56,"vector4",7),new $kJ(72,"vector4",6),new $kJ(88,"vector4",5)]);}]),$J;}(),$sJ=function(){function $J(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$h.VertexPositionNormalColorTexture0SkinTangent=function($J,$h,$f,$n,$L,$T,$k,$u){this._position=$J,this._normal=$h,this._color=$f,this._textureCoordinate0=$n,this._textureCoordinate1=$L,this._tangent=$T,this._blendIndex=$k,this._blendWeight=$u;},$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(100,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector2",2),new $kJ(48,"vector2",15),new $kJ(56,"vector4",7),new $kJ(72,"vector4",6),new $kJ(88,"vector3",5)]);}]),$J;}(),$dJ=function(){function $J($J,$h,$f,$n,$L,$T){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$J,this._normal=$h,this._color=$f,this._textureCoordinate0=$n,this._textureCoordinate1=$L,this._tangent=$T;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(72,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector2",2),new $kJ(48,"vector2",15),new $kJ(56,"vector4",5)]);}]),$J;}(),$pJ=function(){function $J(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$h.VertexPositionNormalColorTexture0Tangent=function($J,$h,$f,$n,$L,$T){this._position=$J,this._normal=$h,this._color=$f,this._textureCoordinate0=$n,this._textureCoordinate1=$L,this._tangent=$T;},$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(68,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector2",2),new $kJ(48,"vector2",15),new $kJ(56,"vector3",5)]);}]),$J;}(),$UJ=function(){function $J($J,$h,$f,$n,$L,$T){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$J,this._normal=$h,this._color=$f,this._textureCoordinate=$n,this._blendIndex=$L,this._blendWeight=$T;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(80,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector2",2),new $kJ(48,"vector4",7),new $kJ(64,"vector4",6)]);}]),$J;}(),$QJ=function(){function $J($J,$h,$f,$n,$L,$T,$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$J,this._normal=$h,this._color=$f,this._textureCoordinate=$n,this._tangent=$L,this._blendIndex=$T,this._blendWeight=$k;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(96,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector2",2),new $kJ(48,"vector4",7),new $kJ(64,"vector4",6),new $kJ(80,"vector4",5)]);}]),$J;}(),$DJ=function(){function $J($J,$h,$f,$n,$L,$T,$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$J,this._normal=$h,this._color=$f,this._textureCoordinate=$n,this._tangent=$L,this._blendIndex=$T,this._blendWeight=$k;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(92,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector2",2),new $kJ(48,"vector4",7),new $kJ(64,"vector4",6),new $kJ(80,"vector3",5)]);}]),$J;}(),$gJ=function(){function $J($J,$h,$f,$n,$L){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$J,this._normal=$h,this._color=$f,this._textureCoordinate=$n,this._tangent=$L;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(64,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector2",2),new $kJ(48,"vector4",5)]);}]),$J;}(),$FJ=function(){function $J($J,$h,$f,$n,$L){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$J,this._normal=$h,this._color=$f,this._textureCoordinate=$n,this._tangent=$L;}$l($J,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"color",function(){return this._color;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(60,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",1),new $kJ(40,"vector2",2),new $kJ(48,"vector3",5)]);}]),$J;}(),$AJ=function(){function $J($J,$h,$f){this._position=null,this._normal=null,this._tangent=null,this._position=$J,this._normal=$h,this._tangent=$f;}$l($J,"laya.d3.graphics.VertexPositionNormalSTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(40,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector4",5)]);}]),$J;}(),$GJ=function(){function $J($J,$h,$f){this._position=null,this._normal=null,this._tangent=null,this._position=$J,this._normal=$h,this._tangent=$f;}$l($J,"laya.d3.graphics.VertexPositionNormalTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(36,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector3",5)]);}]),$J;}(),$yJ=function(){function $J($J,$h,$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$J,this._normal=$h,this._textureCoordinate=$f;}$l($J,"laya.d3.graphics.VertexPositionNormalTexture");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(32,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2)]);}]),$J;}(),$OJ=function(){function $J($J,$h,$f,$n){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$J,this._normal=$h,this._textureCoordinate0=$f,this._textureCoordinate1=$n;}$l($J,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(40,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2),new $kJ(32,"vector2",15)]);}]),$J;}(),$PJ=function(){function $J($J,$h,$f,$n,$L,$T){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$J,this._normal=$h,this._textureCoordinate0=$f,this._textureCoordinate1=$n,this._blendIndex=$L,this._blendWeight=$T;}$l($J,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(72,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2),new $kJ(32,"vector2",15),new $kJ(40,"vector4",7),new $kJ(56,"vector4",6)]);}]),$J;}(),$WJ=function(){function $J($J,$h,$f,$n,$L,$T,$k){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$J,this._normal=$h,this._textureCoordinate0=$f,this._textureCoordinate1=$n,this._tangent=$L,this._blendIndex=$T,this._blendWeight=$k;}$l($J,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(88,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2),new $kJ(32,"vector2",15),new $kJ(40,"vector4",7),new $kJ(56,"vector4",6),new $kJ(72,"vector4",5)]);}]),$J;}(),$IJ=function(){function $J(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null;}$l($J,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$h.VertexPositionNormalTexture0SkinTangent=function($J,$h,$f,$n,$L,$T,$k){this._position=$J,this._normal=$h,this._textureCoordinate0=$f,this._textureCoordinate1=$n,this._tangent=$L,this._blendIndex=$T,this._blendWeight=$k;},$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(84,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2),new $kJ(32,"vector2",15),new $kJ(40,"vector4",7),new $kJ(56,"vector4",6),new $kJ(72,"vector3",5)]);}]),$J;}(),$mJ=function(){function $J($J,$h,$f,$n,$L){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$J,this._normal=$h,this._textureCoordinate0=$f,this._textureCoordinate1=$n,this._tangent=$L;}$l($J,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(56,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2),new $kJ(32,"vector2",15),new $kJ(40,"vector4",5)]);}]),$J;}(),$ZJ=function(){function $J(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null;}$l($J,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$h.VertexPositionNormalTexture0Tangent=function($J,$h,$f,$n,$L){this._position=$J,this._normal=$h,this._textureCoordinate0=$f,this._textureCoordinate1=$n,this._tangent=$L;},$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(52,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2),new $kJ(32,"vector2",15),new $kJ(40,"vector3",5)]);}]),$J;}(),$tJ=function(){function $J($J,$h,$f,$n,$L){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$J,this._normal=$h,this._textureCoordinate=$f,this._blendIndex=$n,this._blendWeight=$L;}$l($J,"laya.d3.graphics.VertexPositionNormalTextureSkin");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(64,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2),new $kJ(32,"vector4",7),new $kJ(48,"vector4",6)]);}]),$J;}(),$cJ=function(){function $J($J,$h,$f,$n,$L,$T){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$J,this._normal=$h,this._textureCoordinate=$f,this._tangent=$n,this._blendIndex=$L,this._blendWeight=$T;}$l($J,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(80,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2),new $kJ(32,"vector4",7),new $kJ(48,"vector4",6),new $kJ(64,"vector4",5)]);}]),$J;}(),$aJ=function(){function $J($J,$h,$f,$n,$L,$T){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$J,this._normal=$h,this._textureCoordinate=$f,this._tangent=$n,this._blendIndex=$L,this._blendWeight=$T;}$l($J,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(76,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2),new $kJ(32,"vector4",7),new $kJ(48,"vector4",6),new $kJ(64,"vector3",5)]);}]),$J;}(),$BJ=function(){function $J($J,$h,$f,$n){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$J,this._normal=$h,this._textureCoordinate=$f,this._tangent=$n;}$l($J,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(48,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2),new $kJ(32,"vector4",5)]);}]),$J;}(),$VJ=function(){function $J($J,$h,$f,$n){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$J,this._normal=$h,this._textureCoordinate=$f,this._tangent=$n;}$l($J,"laya.d3.graphics.VertexPositionNormalTextureTangent");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(44,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2),new $kJ(32,"vector3",5)]);}]),$J;}(),$CJ=function(){function $J($J,$h,$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$J,this._normal=$h,this._textureCoordinate=$f;}$l($J,"laya.d3.graphics.VertexPositionNTBTexture");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(56,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector3",5),new $kJ(36,"vector3",4),new $kJ(48,"vector2",2)]);}]),$J;}(),$eJ=function(){function $J($J,$h,$f,$n,$L,$T,$k,$u){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=$J,this._normal=$h,this._textureCoordinate0=$n,this._textureCoordinate1=$L,this._tangent=$T,$f=$f,this._blendIndex=$k,this._blendWeight=$u;}$l($J,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"tangent",function(){return this._tangent;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(0,$h,"textureCoordinate1",function(){return this._textureCoordinate1;}),$i(0,$h,"blendIndex",function(){return this._blendIndex;}),$i(0,$h,"blendWeight",function(){return this._blendWeight;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(96,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector3",5),new $kJ(36,"vector3",4),new $kJ(48,"vector2",2),new $kJ(56,"vector2",15),new $kJ(64,"vector4",7),new $kJ(80,"vector4",6)]);}]),$J;}(),$HJ=function(){function $J($J,$h,$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$J,this._normal=$h,this._textureCoordinate=$f;}$l($J,"laya.d3.graphics.VertexPositionNTBTextureSkin");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"textureCoordinate",function(){return this._textureCoordinate;}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(88,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector3",5),new $kJ(36,"vector3",4),new $kJ(48,"vector2",2),new $kJ(56,"vector4",7),new $kJ(72,"vector4",6)]);}]),$J;}(),$bJ=(function(){function $J($J,$h,$f,$n){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=$J,this._normal=$h,this._textureCoord0=$f,this._textureCoord1=$n;}$l($J,"laya.d3.graphics.VertexPositionTerrain");var $h=$J.prototype;$p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"normal",function(){return this._normal;}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"textureCoord0",function(){return this._textureCoord0;}),$i(0,$h,"textureCoord1",function(){return this._textureCoord1;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(40,[new $kJ(0,"vector3",0),new $kJ(12,"vector3",3),new $kJ(24,"vector2",2),new $kJ(32,"vector2",15)]);}]);}(),function(){function $J($J,$h){this._position=null,this._textureCoordinate0=null,this._position=$J,this._textureCoordinate0=$h;}$l($J,"laya.d3.graphics.VertexPositionTexture0");var $h=$J.prototype;return $p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"position",function(){return this._position;}),$i(0,$h,"textureCoordinate0",function(){return this._textureCoordinate0;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(20,[new $kJ(0,"vector3",0),new $kJ(12,"vector2",2)]);}]),$J;}()),$vJ=(function(){function $J($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$j,$R,$l){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$J,this._positionStartLifeTime=$h,this._velocity=$f,this._startColor=$n,this._startSize=$L,this._startRotation0=$T,this._startRotation1=$k,this._startRotation2=$u,this._startLifeTime=$S,this._time=$Y,this._startSpeed=$x,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$l;}$l($J,"laya.d3.graphics.VertexShurikenParticleBillboard");var $h=$J.prototype;$p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate;}),$i(0,$h,"random1",function(){return this._randoms1;}),$i(0,$h,"startRotation2",function(){return this._startRotation2;}),$i(0,$h,"positionStartLifeTime",function(){return this._positionStartLifeTime;}),$i(0,$h,"velocity",function(){return this._velocity;}),$i(0,$h,"random0",function(){return this._randoms0;}),$i(0,$h,"startSize",function(){return this._startSize;}),$i(0,$h,"startColor",function(){return this._startColor;}),$i(0,$h,"startRotation0",function(){return this._startRotation0;}),$i(0,$h,"startRotation1",function(){return this._startRotation1;}),$i(0,$h,"startLifeTime",function(){return this._startLifeTime;}),$i(0,$h,"time",function(){return this._time;}),$i(0,$h,"startSpeed",function(){return this._startSpeed;}),$i(0,$h,"simulationWorldPostion",function(){return this._simulationWorldPostion;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(152,[new $kJ(0,"vector4",17),new $kJ(16,"vector4",30),new $kJ(32,"vector4",32),new $kJ(48,"vector4",19),new $kJ(64,"vector3",20),new $kJ(76,"vector3",22),new $kJ(88,"single",31),new $kJ(92,"vector4",34),new $kJ(108,"vector4",35),new $kJ(124,"vector3",36),new $kJ(136,"vector4",37)]);}]);}(),function(){function $J($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$j,$R,$l){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$J,this._positionStartLifeTime=$h,this._velocity=$f,this._startColor=$n,this._startSize=$L,this._startRotation0=$T,this._startRotation1=$k,this._startRotation2=$u,this._startLifeTime=$S,this._time=$Y,this._startSpeed=$x,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$l;}$l($J,"laya.d3.graphics.VertexShurikenParticleMesh");var $h=$J.prototype;$p.imps($h,{"laya.d3.graphics.IVertex":!0}),$i(0,$h,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate;}),$i(0,$h,"velocity",function(){return this._velocity;}),$i(0,$h,"position",function(){return this._positionStartLifeTime;}),$i(0,$h,"random0",function(){return this._randoms0;}),$i(0,$h,"startSize",function(){return this._startSize;}),$i(0,$h,"startColor",function(){return this._startColor;}),$i(0,$h,"startRotation0",function(){return this._startRotation0;}),$i(0,$h,"startRotation1",function(){return this._startRotation1;}),$i(0,$h,"random1",function(){return this._randoms1;}),$i(0,$h,"startRotation2",function(){return this._startRotation2;}),$i(0,$h,"startLifeTime",function(){return this._startLifeTime;}),$i(0,$h,"time",function(){return this._time;}),$i(0,$h,"startSpeed",function(){return this._startSpeed;}),$i(0,$h,"simulationWorldPostion",function(){return this._simulationWorldPostion;}),$i(0,$h,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$i(1,$J,"vertexDeclaration",function(){return $J._vertexDeclaration;}),$j($J,["_vertexDeclaration",function(){return this._vertexDeclaration=new $TJ(172,[new $kJ(0,"vector3",0),new $kJ(12,"vector4",1),new $kJ(28,"vector2",2),new $kJ(36,"vector4",30),new $kJ(52,"vector4",32),new $kJ(68,"vector4",19),new $kJ(84,"vector3",20),new $kJ(96,"vector3",22),new $kJ(108,"single",31),new $kJ(112,"vector4",34),new $kJ(128,"vector4",35),new $kJ(144,"vector3",36),new $kJ(156,"vector4",37)]);}]);}(),function(){function $s($J,$h,$f,$n,$L,$T){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=$f,this._materials=$n,this._subMeshes=$L,this._materialMap=$T,this._version=$h,this._onLoaded($J);}$l($s,"laya.d3.loaders.LoadModelV01");var $J=$s.prototype;return $J._onLoaded=function($J){this._readData=$J,this.READ_BLOCK();for(var $h=0;$h<this._BLOCK.count;$h++){var $f=this._readData.getUint16(),$n=this._strings[$f],$L=this["READ_"+$n];if(null==$L)throw new Error("model file err,no this function:"+$f+" "+$n);if(!$L.call(this))break;}return this._mesh;},$J.onError=function(){},$J._readString=function(){return this._strings[this._readData.getUint16()];},$J.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0;},$J.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0;},$J.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var $J=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var $h=0;$h<this._STRINGS.size;$h++)this._strings[$h]=this._readData.readUTFString();return this._readData.pos=$J,!0;},$J.READ_MATERIAL=function(){var $J=this._readData.getUint16(),$h=(this._readString(),this._readString());return this._materials[$J]="null"!==$h?$r.getRes(this._materialMap[$h]):new $Gh(),!0;},$J.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var $J,$h=this._readData.__getBuffer(),$f=0,$n=this._readData.getUint32(),$L=this._readData.getUint32(),$T=(new Float32Array($h.slice($n+this._DATA.offset,$n+this._DATA.offset+$L)),this._readData.getUint32()),$k=this._readData.getUint32(),$u=new Float32Array($h.slice($T+this._DATA.offset,$T+this._DATA.offset+$k));for(this.mesh._inverseBindPoses=[],$f=0,$J=$u.length;$f<$J;$f+=16){var $S=new $Jh($u[$f+0],$u[$f+1],$u[$f+2],$u[$f+3],$u[$f+4],$u[$f+5],$u[$f+6],$u[$f+7],$u[$f+8],$u[$f+9],$u[$f+10],$u[$f+11],$u[$f+12],$u[$f+13],$u[$f+14],$u[$f+15]);this.mesh._inverseBindPoses.push($S);}break;default:throw new Error("LoadModel:unknown version.");}return!0;},$J.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var $J=this._readString();this._shaderAttributes=$J.match($s._attrReg);var $h=this._readData.getUint32(),$f=this._readData.getUint32(),$n=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),$L=this._readData.getUint32(),$T=this._readData.getUint32(),$k=this._readData.getUint32(),$u=this._readData.__getBuffer(),$S=new $Yh(this._mesh),$Y=this._getVertexDeclaration(),$x=$ah.create($Y,$L/$Y.vertexStride,35044,!0),$j=$n+this._DATA.offset,$R=$u.slice($j,$j+$L);$x.setData(new Float32Array($R));for(var $l=($S._vertexBuffer=$x).vertexDeclaration.getVertexElements(),$i=0;$i<$l.length;$i++)$S._bufferUsage[$l[$i].elementUsage]=$x;var $q=$ch.create("ushort",$f/2,35044,!0),$o=$h+this._DATA.offset,$r=$u.slice($o,$o+$f);$q.setData(new Uint16Array($r)),$S._indexBuffer=$q;var $_=$u.slice($T+this._DATA.offset,$T+this._DATA.offset+$k);return $S._boneIndicesList[0]=new Uint8Array($_),this._subMeshes.push($S),!0;},$J.READ_DATAAREA=function(){return!1;},$J._getVertexDeclaration=function(){for(var $J,$h=!1,$f=!1,$n=!1,$L=!1,$T=!1,$k=!1,$u=!1,$S=!1,$Y=!1,$x=0;$x<this._shaderAttributes.length;$x+=8)switch(this._shaderAttributes[$x]){case"POSITION":$h=!0;break;case"NORMAL":$f=!0;break;case"COLOR":$n=!0;break;case"UV":$L=!0;break;case"UV1":$T=!0;break;case"BLENDWEIGHT":$u=!0;break;case"BLENDINDICES":$S=!0;break;case"TANGENT":$k=!0;break;case"BINORMAL":$Y=!0;}return $h&&$f&&$n&&$L&&$T&&$u&&$S&&$k?$J=$sJ.vertexDeclaration:$h&&$f&&$n&&$L&&$T&&$u&&$S?$J=$rJ.vertexDeclaration:$h&&$f&&$L&&$T&&$u&&$S&&$k?$J=$IJ.vertexDeclaration:$h&&$f&&$L&&$T&&$u&&$S?$J=$PJ.vertexDeclaration:$h&&$f&&$n&&$L&&$u&&$S&&$k?$J=$DJ.vertexDeclaration:$h&&$f&&$n&&$L&&$u&&$S?$J=$UJ.vertexDeclaration:$h&&$f&&$k&&$Y&&$L&&$u&&$S?$J=$HJ.vertexDeclaration:$h&&$f&&$L&&$u&&$S&&$k?$J=$aJ.vertexDeclaration:$h&&$f&&$L&&$u&&$S?$J=$tJ.vertexDeclaration:$h&&$f&&$n&&$u&&$S&&$k?$J=$RJ.vertexDeclaration:$h&&$f&&$n&&$u&&$S?$J=$xJ.vertexDeclaration:$h&&$f&&$n&&$L&&$T&&$k?$J=$pJ.vertexDeclaration:$h&&$f&&$n&&$L&&$T?$J=$oJ.vertexDeclaration:$h&&$f&&$L&&$T&&$k?$J=$ZJ.vertexDeclaration:$h&&$f&&$L&&$T?$J=$OJ.vertexDeclaration:$h&&$f&&$n&&$L&&$k?$J=$FJ.vertexDeclaration:$h&&$f&&$L&&$k&&$Y?$J=$CJ.vertexDeclaration:$h&&$f&&$n&&$L?$J=$qJ.vertexDeclaration:$h&&$f&&$L&&$k?$J=$VJ.vertexDeclaration:$h&&$f&&$L?$J=$yJ.vertexDeclaration:$h&&$f&&$n&&$k?$J=$iJ.vertexDeclaration:$h&&$f&&$n&&($J=$YJ.vertexDeclaration),$J;},$i(0,$J,"mesh",function(){return this._mesh;}),$s._attrReg=new RegExp("(\\w+)|([:,;])","g"),$s;}()),$$J=function(){function $Q(){}return $l($Q,"laya.d3.loaders.LoadModelV02"),$Q.parse=function($J,$h,$f,$n,$L,$T){$Q._mesh=$f,$Q._materials=$n,$Q._subMeshes=$L,$Q._materialMap=$T,$Q._version=$h,$Q._readData=$J,$Q.READ_DATA(),$Q.READ_BLOCK(),$Q.READ_STRINGS();for(var $k=0,$u=$Q._BLOCK.count;$k<$u;$k++){$Q._readData.pos=$Q._BLOCK.blockStarts[$k];var $S=$Q._readData.getUint16(),$Y=$Q._strings[$S],$x=$Q["READ_"+$Y];if(null==$x)throw new Error("model file err,no this function:"+$S+" "+$Y);$x.call();}$Q._strings.length=0,$Q._readData=null,$Q._version=null,$Q._mesh=null,$Q._materials=null,$Q._subMeshes=null,$Q._materialMap=null;},$Q._readString=function(){return $Q._strings[$Q._readData.getUint16()];},$Q.READ_DATA=function(){$Q._DATA.offset=$Q._readData.getUint32(),$Q._DATA.size=$Q._readData.getUint32();},$Q.READ_BLOCK=function(){for(var $J=$Q._BLOCK.count=$Q._readData.getUint16(),$h=$Q._BLOCK.blockStarts=[],$f=$Q._BLOCK.blockLengths=[],$n=0;$n<$J;$n++)$h.push($Q._readData.getUint32()),$f.push($Q._readData.getUint32());},$Q.READ_STRINGS=function(){var $J=$Q._readData.getUint32(),$h=$Q._readData.getUint16(),$f=$Q._readData.pos;$Q._readData.pos=$J+$Q._DATA.offset;for(var $n=0;$n<$h;$n++)$Q._strings[$n]=$Q._readData.readUTFString();$Q._readData.pos=$f;},$Q.READ_MATERIAL=function(){$Q._readString(),$Q._readString();var $J=$Q._readString();return""!==$J&&$Q._materials.push($r.getRes($Q._materialMap[$J])),!0;},$Q.READ_MESH=function(){$Q._readString();var $J,$h=$Q._readData.__getBuffer(),$f=0,$n=$Q._readData.getInt16(),$L=$Q._DATA.offset;for($f=0;$f<$n;$f++){var $T=$L+$Q._readData.getUint32(),$k=$Q._readData.getUint32(),$u=new Float32Array($h.slice($T,$T+$k)),$S=$Q._readString().match($Q._attrReg),$Y=$Q._getVertexDeclaration($S),$x=$ah.create($Y,4*$u.length/$Y.vertexStride,35044,!0);$x.setData($u),$Q._mesh._vertexBuffers.push($x);}var $j=$L+$Q._readData.getUint32(),$R=$Q._readData.getUint32(),$l=new Uint16Array($h.slice($j,$j+$R)),$i=$ch.create("ushort",$R/2,35044,!0);$i.setData($l),$Q._mesh._indexBuffer=$i;var $q=$Q._mesh._boneNames=[],$o=$Q._readData.getUint16();for($q.length=$o,$f=0;$f<$o;$f++)$q[$f]=$Q._strings[$Q._readData.getUint16()];var $r=$Q._readData.getUint32(),$_=$Q._readData.getUint32(),$s=(new Float32Array($h.slice($L+$r,$L+$r+$_)),$Q._readData.getUint32()),$d=$Q._readData.getUint32(),$p=new Float32Array($h.slice($L+$s,$L+$s+$d));for($Q._mesh._inverseBindPoses=[],$f=0,$J=$p.length;$f<$J;$f+=16){var $U=new $Jh($p[$f+0],$p[$f+1],$p[$f+2],$p[$f+3],$p[$f+4],$p[$f+5],$p[$f+6],$p[$f+7],$p[$f+8],$p[$f+9],$p[$f+10],$p[$f+11],$p[$f+12],$p[$f+13],$p[$f+14],$p[$f+15]);$Q._mesh._inverseBindPoses.push($U);}return $Q._mesh._skinnedDatas=new Float32Array(16*$p.length),!0;},$Q.READ_SUBMESH=function(){var $J=$Q._readData.__getBuffer(),$h=new $Yh($Q._mesh),$f=$Q._readData.getInt16(),$n=$Q._readData.getUint32(),$L=$Q._readData.getUint32();$h._vertexBuffer=$Q._mesh._vertexBuffers[$f],$h._vertexStart=$n,$h._vertexCount=$L;var $T=$Q._readData.getUint32(),$k=$Q._readData.getUint32(),$u=$Q._mesh._indexBuffer;$h._indexBuffer=$u,$h._indexStart=$T,$h._indexCount=$k,$h._indices=new Uint16Array($u.getData().buffer,2*$T,$k);var $S=$Q._DATA.offset,$Y=$h._subIndexBufferStart,$x=$h._subIndexBufferCount,$j=$h._boneIndicesList,$R=$Q._readData.getUint16();$Y.length=$R,$x.length=$R,$j.length=$R;for(var $l=0;$l<$R;$l++){$Y[$l]=$Q._readData.getUint32(),$x[$l]=$Q._readData.getUint32();var $i=$Q._readData.getUint32(),$q=$Q._readData.getUint32();$h._boneIndicesList[$l]=new Uint8Array($J.slice($S+$i,$S+$i+$q));}return $Q._subMeshes.push($h),!0;},$Q._getVertexDeclaration=function($J){for(var $h,$f=!1,$n=!1,$L=!1,$T=!1,$k=!1,$u=!1,$S=!1,$Y=!1,$x=!1,$j=0;$j<$J.length;$j++)switch($J[$j]){case"POSITION":$f=!0;break;case"NORMAL":$n=!0;break;case"COLOR":$L=!0;break;case"UV":$T=!0;break;case"UV1":$k=!0;break;case"BLENDWEIGHT":$S=!0;break;case"BLENDINDICES":$Y=!0;break;case"TANGENT":$u=!0;break;case"BINORMAL":$x=!0;}return $f&&$n&&$L&&$T&&$k&&$S&&$Y&&$u?$h=$sJ.vertexDeclaration:$f&&$n&&$L&&$T&&$k&&$S&&$Y?$h=$rJ.vertexDeclaration:$f&&$n&&$T&&$k&&$S&&$Y&&$u?$h=$IJ.vertexDeclaration:$f&&$n&&$T&&$k&&$S&&$Y?$h=$PJ.vertexDeclaration:$f&&$n&&$L&&$T&&$S&&$Y&&$u?$h=$DJ.vertexDeclaration:$f&&$n&&$L&&$T&&$S&&$Y?$h=$UJ.vertexDeclaration:$f&&$n&&$T&&$S&&$Y&&$u?$h=$aJ.vertexDeclaration:$f&&$n&&$T&&$S&&$Y?$h=$tJ.vertexDeclaration:$f&&$n&&$L&&$S&&$Y&&$u?$h=$RJ.vertexDeclaration:$f&&$n&&$L&&$S&&$Y?$h=$xJ.vertexDeclaration:$f&&$n&&$L&&$T&&$k&&$u?$h=$pJ.vertexDeclaration:$f&&$n&&$L&&$T&&$k?$h=$oJ.vertexDeclaration:$f&&$n&&$T&&$k&&$u?$h=$ZJ.vertexDeclaration:$f&&$n&&$T&&$k?$h=$OJ.vertexDeclaration:$f&&$n&&$L&&$T&&$u?$h=$FJ.vertexDeclaration:$f&&$n&&$T&&$u&&$x?$h=$CJ.vertexDeclaration:$f&&$n&&$L&&$T?$h=$qJ.vertexDeclaration:$f&&$n&&$T&&$u?$h=$VJ.vertexDeclaration:$f&&$n&&$T?$h=$yJ.vertexDeclaration:$f&&$n&&$L&&$u?$h=$iJ.vertexDeclaration:$f&&$n&&$L&&($h=$YJ.vertexDeclaration),$h;},$Q._attrReg=new RegExp("(\\w+)|([:,;])","g"),$Q._strings=[],$Q._readData=null,$Q._version=null,$Q._mesh=null,$Q._materials=null,$Q._subMeshes=null,$Q._materialMap=null,$j($Q,["_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]),$Q;}(),$MJ=function(){function $U(){}return $l($U,"laya.d3.loaders.LoadModelV03"),$U.parse=function($J,$h,$f,$n,$L){$U._mesh=$f,$U._subMeshes=$n,$U._materialMap=$L,$U._version=$h,$U._readData=$J,$U.READ_DATA(),$U.READ_BLOCK(),$U.READ_STRINGS();for(var $T=0,$k=$U._BLOCK.count;$T<$k;$T++){$U._readData.pos=$U._BLOCK.blockStarts[$T];var $u=$U._readData.getUint16(),$S=$U._strings[$u],$Y=$U["READ_"+$S];if(null==$Y)throw new Error("model file err,no this function:"+$u+" "+$S);$Y.call();}$U._strings.length=0,$U._readData=null,$U._version=null,$U._mesh=null,$U._subMeshes=null,$U._materialMap=null;},$U._readString=function(){return $U._strings[$U._readData.getUint16()];},$U.READ_DATA=function(){$U._DATA.offset=$U._readData.getUint32(),$U._DATA.size=$U._readData.getUint32();},$U.READ_BLOCK=function(){for(var $J=$U._BLOCK.count=$U._readData.getUint16(),$h=$U._BLOCK.blockStarts=[],$f=$U._BLOCK.blockLengths=[],$n=0;$n<$J;$n++)$h.push($U._readData.getUint32()),$f.push($U._readData.getUint32());},$U.READ_STRINGS=function(){var $J=$U._readData.getUint32(),$h=$U._readData.getUint16(),$f=$U._readData.pos;$U._readData.pos=$J+$U._DATA.offset;for(var $n=0;$n<$h;$n++)$U._strings[$n]=$U._readData.readUTFString();$U._readData.pos=$f;},$U.READ_MESH=function(){var $J,$h=$U._readString(),$f=$U._readData.__getBuffer(),$n=0,$L=$U._readData.getInt16(),$T=$U._DATA.offset;for($n=0;$n<$L;$n++){var $k,$u=$T+$U._readData.getUint32(),$S=$U._readData.getUint32(),$Y=new Float32Array($f.slice($u,$u+$S)),$x=$U._readString();switch($U._version){case"LAYAMODEL:03":$k=$U._vertexDeclarationMap_Discard[$x];break;case"LAYAMODEL:0301":$k=$U._vertexDeclarationMap[$x];break;default:throw new Error("LoadModelV03: unknown version.");}if(!$k)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+$U._version+"  bufferAttribute="+$x+"  name="+$h+"  url="+($U._mesh?$U._mesh.url:"null"));var $j=$ah.create($k,4*$Y.length/$k.vertexStride,35044,!0,$U._mesh._url+"_"+$n);$j.setData($Y),$U._mesh._vertexBuffers.push($j);}var $R=$T+$U._readData.getUint32(),$l=$U._readData.getUint32(),$i=new Uint16Array($f.slice($R,$R+$l)),$q=$ch.create("ushort",$l/2,35044,!0,$U._mesh._url);$q.setData($i),$U._mesh._indexBuffer=$q;var $o=$U._mesh._boneNames=[],$r=$U._readData.getUint16();for($o.length=$r,$n=0;$n<$r;$n++)$o[$n]=$U._strings[$U._readData.getUint16()];$U._readData.pos+=8;var $_=$U._readData.getUint32(),$s=$U._readData.getUint32(),$d=new Float32Array($f.slice($T+$_,$T+$_+$s));for($U._mesh._inverseBindPoses=[],$n=0,$J=$d.length;$n<$J;$n+=16){var $p=new $Jh($d[$n+0],$d[$n+1],$d[$n+2],$d[$n+3],$d[$n+4],$d[$n+5],$d[$n+6],$d[$n+7],$d[$n+8],$d[$n+9],$d[$n+10],$d[$n+11],$d[$n+12],$d[$n+13],$d[$n+14],$d[$n+15]);$U._mesh._inverseBindPoses.push($p);}return $U._mesh._skinnedDatas=new Float32Array(16*$d.length),!0;},$U.READ_SUBMESH=function(){var $J=$U._readData.__getBuffer(),$h=new $Yh($U._mesh),$f=$U._readData.getInt16(),$n=$U._readData.getUint32(),$L=$U._readData.getUint32();$h._vertexBuffer=$U._mesh._vertexBuffers[$f],$h._vertexStart=$n,$h._vertexCount=$L;var $T=$U._readData.getUint32(),$k=$U._readData.getUint32(),$u=$U._mesh._indexBuffer;$h._indexBuffer=$u,$h._indexStart=$T,$h._indexCount=$k,$h._indices=new Uint16Array($u.getData().buffer,2*$T,$k);var $S=$U._DATA.offset,$Y=$h._subIndexBufferStart,$x=$h._subIndexBufferCount,$j=$h._boneIndicesList,$R=$U._readData.getUint16();$Y.length=$R,$x.length=$R,$j.length=$R;for(var $l=0;$l<$R;$l++){$Y[$l]=$U._readData.getUint32(),$x[$l]=$U._readData.getUint32();var $i=$U._readData.getUint32(),$q=$U._readData.getUint32();$j[$l]=new Uint8Array($J.slice($S+$i,$S+$i+$q));}return $U._subMeshes.push($h),!0;},$U._strings=[],$U._readData=null,$U._version=null,$U._mesh=null,$U._subMeshes=null,$U._materialMap=null,$j($U,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$sJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$rJ.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$eJ.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$IJ.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$PJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$DJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$UJ.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$aJ.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$tJ.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$RJ.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$xJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$pJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$oJ.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$ZJ.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$OJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$FJ.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$CJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$qJ.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$VJ.vertexDeclaration,"POSITION,NORMAL,UV":$yJ.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$iJ.vertexDeclaration,"POSITION,NORMAL,COLOR":$YJ.vertexDeclaration,"POSITION,NORMAL,TANGENT":$GJ.vertexDeclaration,"POSITION,NORMAL":$SJ.vertexDeclaration,"POSITION,UV":$bJ.vertexDeclaration,POSITION:$uJ.vertexDeclaration};},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$_J.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$rJ.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$eJ.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$WJ.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$PJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$QJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$UJ.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$cJ.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$tJ.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$jJ.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$xJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$dJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$oJ.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$mJ.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$OJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$gJ.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$CJ.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$qJ.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$BJ.vertexDeclaration,"POSITION,NORMAL,UV":$yJ.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$lJ.vertexDeclaration,"POSITION,NORMAL,COLOR":$YJ.vertexDeclaration,"POSITION,NORMAL,TANGENT":$AJ.vertexDeclaration,"POSITION,NORMAL":$SJ.vertexDeclaration,"POSITION,UV":$bJ.vertexDeclaration,POSITION:$uJ.vertexDeclaration};},"_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]),$U;}(),$XJ=function(){function $u(){}return $l($u,"laya.d3.loaders.MeshReader"),$u.read=function($J,$h,$f,$n,$L){var $T=new $U($J);$T.pos=0;var $k=$T.readUTFString();switch($k){case"LAYAMODEL:01":case"LAYASKINANI:01":$u._readVersion01($T,$k,$h,$f,$n,$L);break;case"LAYAMODEL:02":$$J.parse($T,$k,$h,$f,$n,$L);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":$MJ.parse($T,$k,$h,$n,$L);break;default:throw new Error("MeshReader: unknown mesh version.");}$h._setSubMeshes($n);},$u._readVersion01=function($J,$h,$f,$n,$L,$T){new $vJ($J,$h,$f,$n,$L,$T);},$u;}(),$wJ=function(){function $J($J,$h){this.min=null,this.max=null,this.min=$J,this.max=$h;}$l($J,"laya.d3.math.BoundBox");var $h=$J.prototype;return $p.imps($h,{"laya.d3.core.IClone":!0}),$h.getCorners=function($J){$J.length=8;var $h=this.min.elements,$f=this.max.elements,$n=$h[0],$L=$h[1],$T=$h[2],$k=$f[0],$u=$f[1],$S=$f[2];$J[0]=new $kh($n,$u,$S),$J[1]=new $kh($k,$u,$S),$J[2]=new $kh($k,$L,$S),$J[3]=new $kh($n,$L,$S),$J[4]=new $kh($n,$u,$T),$J[5]=new $kh($k,$u,$T),$J[6]=new $kh($k,$L,$T),$J[7]=new $kh($n,$L,$T);},$h.toDefault=function(){this.min.toDefault(),this.max.toDefault();},$h.cloneTo=function($J){var $h=$J;this.min.cloneTo($h.min),this.max.cloneTo($h.max);},$h.clone=function(){var $J=new this.constructor(new $kh(),new $kh());return this.cloneTo($J),$J;},$J.createfromPoints=function($J,$h){if(null==$J)throw new Error("points");var $f=$h.min,$n=$h.max,$L=$f.elements;$L[0]=Number.MAX_VALUE,$L[1]=Number.MAX_VALUE,$L[2]=Number.MAX_VALUE;var $T=$n.elements;$T[0]=-Number.MAX_VALUE,$T[1]=-Number.MAX_VALUE,$T[2]=-Number.MAX_VALUE;for(var $k=0,$u=$J.length;$k<$u;++$k)$kh.min($f,$J[$k],$f),$kh.max($n,$J[$k],$n);},$J.merge=function($J,$h,$f){$kh.min($J.min,$h.min,$f.min),$kh.max($J.max,$h.max,$f.max);},$J;}(),$EJ=function(){function $Y($J){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=$J,this._near=new $hh(new $kh()),this._far=new $hh(new $kh()),this._left=new $hh(new $kh()),this._right=new $hh(new $kh()),this._top=new $hh(new $kh()),this._bottom=new $hh(new $kh()),$Y._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom);}$l($Y,"laya.d3.math.BoundFrustum");var $J=$Y.prototype;return $J.equalsBoundFrustum=function($J){return this._matrix.equalsOtherMatrix($J.matrix);},$J.equalsObj=function($J){if($J instanceof laya.d3.math.BoundFrustum){var $h=$J;return this.equalsBoundFrustum($h);}return!1;},$J.getPlane=function($J){switch($J){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null;}},$J.getCorners=function($J){$Y._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo($J[0]),$Y._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo($J[1]),$Y._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo($J[2]),$Y._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo($J[3]),$Y._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo($J[4]),$Y._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo($J[5]),$Y._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo($J[6]),$Y._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo($J[7]);},$J.containsPoint=function($J){for(var $h=$hh.PlaneIntersectionType_Front,$f=$hh.PlaneIntersectionType_Front,$n=0;$n<6;$n++){switch($n){case 0:$f=Collision.intersectsPlaneAndPoint(this._near,$J);break;case 1:$f=Collision.intersectsPlaneAndPoint(this._far,$J);break;case 2:$f=Collision.intersectsPlaneAndPoint(this._left,$J);break;case 3:$f=Collision.intersectsPlaneAndPoint(this._right,$J);break;case 4:$f=Collision.intersectsPlaneAndPoint(this._top,$J);break;case 5:$f=Collision.intersectsPlaneAndPoint(this._bottom,$J);}switch($f){case $hh.PlaneIntersectionType_Back:return 0;case $hh.PlaneIntersectionType_Intersecting:$h=$hh.PlaneIntersectionType_Intersecting;}}switch($h){case $hh.PlaneIntersectionType_Intersecting:return 2;default:return 1;}},$J.containsBoundBox=function($J){for(var $h,$f=$Y._tempV30,$n=$Y._tempV31,$L=1,$T=0;$T<6;$T++){if($h=this.getPlane($T),this._getBoxToPlanePVertexNVertex($J,$h.normal,$f,$n),Collision.intersectsPlaneAndPoint($h,$f)===$hh.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint($h,$n)===$hh.PlaneIntersectionType_Back&&($L=2);}return $L;},$J.containsBoundSphere=function($J){for(var $h=$hh.PlaneIntersectionType_Front,$f=$hh.PlaneIntersectionType_Front,$n=0;$n<6;$n++){switch($n){case 0:$f=Collision.intersectsPlaneAndSphere(this._near,$J);break;case 1:$f=Collision.intersectsPlaneAndSphere(this._far,$J);break;case 2:$f=Collision.intersectsPlaneAndSphere(this._left,$J);break;case 3:$f=Collision.intersectsPlaneAndSphere(this._right,$J);break;case 4:$f=Collision.intersectsPlaneAndSphere(this._top,$J);break;case 5:$f=Collision.intersectsPlaneAndSphere(this._bottom,$J);}switch($f){case $hh.PlaneIntersectionType_Back:return 0;case $hh.PlaneIntersectionType_Intersecting:$h=$hh.PlaneIntersectionType_Intersecting;}}switch($h){case $hh.PlaneIntersectionType_Intersecting:return 2;default:return 1;}},$J._getBoxToPlanePVertexNVertex=function($J,$h,$f,$n){var $L=$J.min,$T=$L.elements,$k=$J.max,$u=$k.elements,$S=$h.elements,$Y=$S[0],$x=$S[1],$j=$S[2];$L.cloneTo($f);var $R=$f.elements;0<=$Y&&($R[0]=$u[0]),0<=$x&&($R[1]=$u[1]),0<=$j&&($R[2]=$u[2]),$k.cloneTo($n);var $l=$n.elements;0<=$Y&&($l[0]=$T[0]),0<=$x&&($l[1]=$T[1]),0<=$j&&($l[2]=$T[2]);},$i(0,$J,"top",function(){return this._top;}),$i(0,$J,"matrix",function(){return this._matrix;},function($J){this._matrix=$J,$Y._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom);}),$i(0,$J,"near",function(){return this._near;}),$i(0,$J,"far",function(){return this._far;}),$i(0,$J,"left",function(){return this._left;}),$i(0,$J,"right",function(){return this._right;}),$i(0,$J,"bottom",function(){return this._bottom;}),$Y._getPlanesFromMatrix=function($J,$h,$f,$n,$L,$T,$k){var $u=$J.elements,$S=$u[0],$Y=$u[1],$x=$u[2],$j=$u[3],$R=$u[4],$l=$u[5],$i=$u[6],$q=$u[7],$o=$u[8],$r=$u[9],$_=$u[10],$s=$u[11],$d=$u[12],$p=$u[13],$U=$u[14],$Q=$u[15],$D=$h.normal.elements;$D[0]=$j+$x,$D[1]=$q+$i,$D[2]=$s+$_,$h.distance=$Q+$U,$h.normalize();var $g=$f.normal.elements;$g[0]=$j-$x,$g[1]=$q-$i,$g[2]=$s-$_,$f.distance=$Q-$U,$f.normalize();var $F=$n.normal.elements;$F[0]=$j+$S,$F[1]=$q+$R,$F[2]=$s+$o,$n.distance=$Q+$d,$n.normalize();var $A=$L.normal.elements;$A[0]=$j-$S,$A[1]=$q-$R,$A[2]=$s-$o,$L.distance=$Q-$d,$L.normalize();var $G=$T.normal.elements;$G[0]=$j-$Y,$G[1]=$q-$l,$G[2]=$s-$r,$T.distance=$Q-$p,$T.normalize();var $y=$k.normal.elements;$y[0]=$j+$Y,$y[1]=$q+$l,$y[2]=$s+$r,$k.distance=$Q+$p,$k.normalize();},$Y._get3PlaneInterPoint=function($J,$h,$f){var $n=$J.normal,$L=$h.normal,$T=$f.normal;$kh.cross($L,$T,$Y._tempV30),$kh.cross($T,$n,$Y._tempV31),$kh.cross($n,$L,$Y._tempV32);var $k=$kh.dot($n,$Y._tempV30),$u=$kh.dot($L,$Y._tempV31),$S=$kh.dot($T,$Y._tempV32);return $kh.scale($Y._tempV30,-$J.distance/$k,$Y._tempV33),$kh.scale($Y._tempV31,-$h.distance/$u,$Y._tempV34),$kh.scale($Y._tempV32,-$f.distance/$S,$Y._tempV35),$kh.add($Y._tempV33,$Y._tempV34,$Y._tempV36),$kh.add($Y._tempV35,$Y._tempV36,$Y._tempV37),$Y._tempV37;},$j($Y,["_tempV30",function(){return this._tempV30=new $kh();},"_tempV31",function(){return this._tempV31=new $kh();},"_tempV32",function(){return this._tempV32=new $kh();},"_tempV33",function(){return this._tempV33=new $kh();},"_tempV34",function(){return this._tempV34=new $kh();},"_tempV35",function(){return this._tempV35=new $kh();},"_tempV36",function(){return this._tempV36=new $kh();},"_tempV37",function(){return this._tempV37=new $kh();}]),$Y;}(),$NJ=function(){function $x($J,$h){this.center=null,this.radius=NaN,this.center=$J,this.radius=$h;}$l($x,"laya.d3.math.BoundSphere");var $J=$x.prototype;return $p.imps($J,{"laya.d3.core.IClone":!0}),$J.toDefault=function(){this.center.toDefault(),this.radius=0;},$J.intersectsRayDistance=function($J){return Collision.intersectsRayAndSphereRD($J,this);},$J.intersectsRayPoint=function($J,$h){return Collision.intersectsRayAndSphereRP($J,this,$h);},$J.cloneTo=function($J){var $h=$J;this.center.cloneTo($h.center),$h.radius=this.radius;},$J.clone=function(){var $J=new this.constructor(new $kh(),new $kh());return this.cloneTo($J),$J;},$x.createFromSubPoints=function($J,$h,$f,$n){if(null==$J)throw new Error("points");if($h<0||$h>=$J.length)throw new Error("start"+$h+"Must be in the range [0, "+($J.length-1)+"]");if($f<0||$h+$f>$J.length)throw new Error("count"+$f+"Must be in the range <= "+$J.length+"}");var $L=$h+$f,$T=$x._tempVector3;$T.elements[0]=0,$T.elements[1]=0,$T.elements[2]=0;for(var $k=$h;$k<$L;++$k)$kh.add($J[$k],$T,$T);var $u=$n.center;$kh.scale($T,1/$f,$u);var $S=0;for($k=$h;$k<$L;++$k){var $Y=$kh.distanceSquared($u,$J[$k]);$S<$Y&&($S=$Y);}$n.radius=Math.sqrt($S);},$x.createfromPoints=function($J,$h){if(null==$J)throw new Error("points");$x.createFromSubPoints($J,0,$J.length,$h);},$j($x,["_tempVector3",function(){return this._tempVector3=new $kh();}]),$x;}(),$zJ=(function(){function $J(){}$l($J,"laya.d3.math.ContainmentType"),$J.Disjoint=0,$J.Contains=1,$J.Intersects=2;}(),function(){function $f(){}return $l($f,"laya.d3.math.MathUtils3D"),$f.isZero=function($J){return Math.abs($J)<$f.zeroTolerance;},$f.nearEqual=function($J,$h){return!!$f.isZero($J-$h);},$f.fastInvSqrt=function($J){return $f.isZero($J)?$J:1/Math.sqrt($J);},$j($f,["zeroTolerance",function(){return this.zeroTolerance=1e-6;},"MaxValue",function(){return this.MaxValue=340282347e30;},"MinValue",function(){return this.MinValue=-340282347e30;}]),$f;}()),$KJ=function(){function $S(){var $J=this.elements=new Float32Array(9);$J[0]=1,$J[1]=0,$J[2]=0,$J[3]=0,$J[4]=1,$J[5]=0,$J[6]=0,$J[7]=0,$J[8]=1;}$l($S,"laya.d3.math.Matrix3x3");var $J=$S.prototype;return $p.imps($J,{"laya.d3.core.IClone":!0}),$J.determinant=function(){var $J=this.elements,$h=$J[0],$f=$J[1],$n=$J[2],$L=$J[3],$T=$J[4],$k=$J[5],$u=$J[6],$S=$J[7],$Y=$J[8];return $h*($Y*$T-$k*$S)+$f*(-$Y*$L+$k*$u)+$n*($S*$L-$T*$u);},$J.translate=function($J,$h){var $f=$h.elements,$n=this.elements,$L=$J.elements,$T=$n[0],$k=$n[1],$u=$n[2],$S=$n[3],$Y=$n[4],$x=$n[5],$j=$n[6],$R=$n[7],$l=$n[8],$i=$L[0],$q=$L[1];$f[0]=$T,$f[1]=$k,$f[2]=$u,$f[3]=$S,$f[4]=$Y,$f[5]=$x,$f[6]=$i*$T+$q*$S+$j,$f[7]=$i*$k+$q*$Y+$R,$f[8]=$i*$u+$q*$x+$l;},$J.rotate=function($J,$h){var $f=$h.elements,$n=this.elements,$L=$n[0],$T=$n[1],$k=$n[2],$u=$n[3],$S=$n[4],$Y=$n[5],$x=$n[6],$j=$n[7],$R=$n[8],$l=Math.sin($J),$i=Math.cos($J);$f[0]=$i*$L+$l*$u,$f[1]=$i*$T+$l*$S,$f[2]=$i*$k+$l*$Y,$f[3]=$i*$u-$l*$L,$f[4]=$i*$S-$l*$T,$f[5]=$i*$Y-$l*$k,$f[6]=$x,$f[7]=$j,$f[8]=$R;},$J.scale=function($J,$h){var $f=$h.elements,$n=this.elements,$L=$J.elements,$T=$L[0],$k=$L[1];$f[0]=$T*$n[0],$f[1]=$T*$n[1],$f[2]=$T*$n[2],$f[3]=$k*$n[3],$f[4]=$k*$n[4],$f[5]=$k*$n[5],$f[6]=$n[6],$f[7]=$n[7],$f[8]=$n[8];},$J.invert=function($J){var $h=$J.elements,$f=this.elements,$n=$f[0],$L=$f[1],$T=$f[2],$k=$f[3],$u=$f[4],$S=$f[5],$Y=$f[6],$x=$f[7],$j=$f[8],$R=$j*$u-$S*$x,$l=-$j*$k+$S*$Y,$i=$x*$k-$u*$Y,$q=$n*$R+$L*$l+$T*$i;$q||($J=null),$q=1/$q,$h[0]=$R*$q,$h[1]=(-$j*$L+$T*$x)*$q,$h[2]=($S*$L-$T*$u)*$q,$h[3]=$l*$q,$h[4]=($j*$n-$T*$Y)*$q,$h[5]=(-$S*$n+$T*$k)*$q,$h[6]=$i*$q,$h[7]=(-$x*$n+$L*$Y)*$q,$h[8]=($u*$n-$L*$k)*$q;},$J.transpose=function($J){var $h=$J.elements,$f=this.elements;if($J===this){var $n=$f[1],$L=$f[2],$T=$f[5];$h[1]=$f[3],$h[2]=$f[6],$h[3]=$n,$h[5]=$f[7],$h[6]=$L,$h[7]=$T;}else $h[0]=$f[0],$h[1]=$f[3],$h[2]=$f[6],$h[3]=$f[1],$h[4]=$f[4],$h[5]=$f[7],$h[6]=$f[2],$h[7]=$f[5],$h[8]=$f[8];},$J.identity=function(){var $J=this.elements;$J[0]=1,$J[1]=0,$J[2]=0,$J[3]=0,$J[4]=1,$J[5]=0,$J[6]=0,$J[7]=0,$J[8]=1;},$J.cloneTo=function($J){var $h,$f,$n;if(($f=this.elements)!==($n=$J.elements))for($h=0;$h<9;++$h)$n[$h]=$f[$h];},$J.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$S.createFromTranslation=function($J,$h){$h.elements;var $f=$J.elements;$h[0]=1,$h[1]=0,$h[2]=0,$h[3]=0,$h[4]=1,$h[5]=0,$h[6]=$f[0],$h[7]=$f[1],$h[8]=1;},$S.createFromRotation=function($J,$h){var $f=$h.elements,$n=Math.sin($J),$L=Math.cos($J);$f[0]=$L,$f[1]=$n,$f[2]=0,$f[3]=-$n,$f[4]=$L,$f[5]=0,$f[6]=0,$f[7]=0,$f[8]=1;},$S.createFromScaling=function($J,$h){var $f=$h.elements,$n=$J.elements;$f[0]=$n[0],$f[1]=0,$f[2]=0,$f[3]=0,$f[4]=$n[1],$f[5]=0,$f[6]=0,$f[7]=0,$f[8]=1;},$S.createFromMatrix4x4=function($J,$h){$h[0]=$J[0],$h[1]=$J[1],$h[2]=$J[2],$h[3]=$J[4],$h[4]=$J[5],$h[5]=$J[6],$h[6]=$J[8],$h[7]=$J[9],$h[8]=$J[10];},$S.multiply=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements,$k=$L[0],$u=$L[1],$S=$L[2],$Y=$L[3],$x=$L[4],$j=$L[5],$R=$L[6],$l=$L[7],$i=$L[8],$q=$T[0],$o=$T[1],$r=$T[2],$_=$T[3],$s=$T[4],$d=$T[5],$p=$T[6],$U=$T[7],$Q=$T[8];$n[0]=$q*$k+$o*$Y+$r*$R,$n[1]=$q*$u+$o*$x+$r*$l,$n[2]=$q*$S+$o*$j+$r*$i,$n[3]=$_*$k+$s*$Y+$d*$R,$n[4]=$_*$u+$s*$x+$d*$l,$n[5]=$_*$S+$s*$j+$d*$i,$n[6]=$p*$k+$U*$Y+$Q*$R,$n[7]=$p*$u+$U*$x+$Q*$l,$n[8]=$p*$S+$U*$j+$Q*$i;},$S.lookAt=function($J,$h,$f,$n){$kh.subtract($J,$h,$S._tempV30),$kh.normalize($S._tempV30,$S._tempV30),$kh.cross($f,$S._tempV30,$S._tempV31),$kh.normalize($S._tempV31,$S._tempV31),$kh.cross($S._tempV30,$S._tempV31,$S._tempV32);var $L=$S._tempV30.elements,$T=$S._tempV31.elements,$k=$S._tempV32.elements,$u=$n.elements;$u[0]=$T[0],$u[3]=$T[1],$u[6]=$T[2],$u[1]=$k[0],$u[4]=$k[1],$u[7]=$k[2],$u[2]=$L[0],$u[5]=$L[1],$u[8]=$L[2];},$S.DEFAULT=new $S(),$j($S,["_tempV30",function(){return this._tempV30=new $kh();},"_tempV31",function(){return this._tempV31=new $kh();},"_tempV32",function(){return this._tempV32=new $kh();}]),$S;}(),$Jh=function(){function $g($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$j,$R,$l,$i,$q){void 0===$J&&($J=1),void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=0),void 0===$L&&($L=0),void 0===$T&&($T=1),void 0===$k&&($k=0),void 0===$u&&($u=0),void 0===$S&&($S=0),void 0===$Y&&($Y=0),void 0===$x&&($x=1),void 0===$j&&($j=0),void 0===$R&&($R=0),void 0===$l&&($l=0),void 0===$i&&($i=0),void 0===$q&&($q=1);var $o=this.elements=new Float32Array(16);$o[0]=$J,$o[1]=$h,$o[2]=$f,$o[3]=$n,$o[4]=$L,$o[5]=$T,$o[6]=$k,$o[7]=$u,$o[8]=$S,$o[9]=$Y,$o[10]=$x,$o[11]=$j,$o[12]=$R,$o[13]=$l,$o[14]=$i,$o[15]=$q;}$l($g,"laya.d3.math.Matrix4x4");var $J=$g.prototype;return $p.imps($J,{"laya.d3.core.IClone":!0}),$J.getElementByRowColumn=function($J,$h){if($J<0||3<$J)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($h<0||3<$h)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*$J+$h];},$J.setElementByRowColumn=function($J,$h,$f){if($J<0||3<$J)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($h<0||3<$h)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*$J+$h]=$f;},$J.equalsOtherMatrix=function($J){var $h=this.elements,$f=$J.elements;return $zJ.nearEqual($h[0],$f[0])&&$zJ.nearEqual($h[1],$f[1])&&$zJ.nearEqual($h[2],$f[2])&&$zJ.nearEqual($h[3],$f[3])&&$zJ.nearEqual($h[4],$f[4])&&$zJ.nearEqual($h[5],$f[5])&&$zJ.nearEqual($h[6],$f[6])&&$zJ.nearEqual($h[7],$f[7])&&$zJ.nearEqual($h[8],$f[8])&&$zJ.nearEqual($h[9],$f[9])&&$zJ.nearEqual($h[10],$f[10])&&$zJ.nearEqual($h[11],$f[11])&&$zJ.nearEqual($h[12],$f[12])&&$zJ.nearEqual($h[13],$f[13])&&$zJ.nearEqual($h[14],$f[14])&&$zJ.nearEqual($h[15],$f[15]);},$J.decomposeTransRotScale=function($J,$h,$f){var $n=$g._tempMatrix4x4;return this.decomposeTransRotMatScale($J,$n,$f)?($fh.createFromMatrix4x4($n,$h),!0):($h.identity(),!1);},$J.decomposeTransRotMatScale=function($J,$h,$f){var $n=this.elements,$L=$J.elements,$T=$h.elements,$k=$f.elements;$L[0]=$n[12],$L[1]=$n[13],$L[2]=$n[14];var $u=$n[0],$S=$n[1],$Y=$n[2],$x=$n[4],$j=$n[5],$R=$n[6],$l=$n[8],$i=$n[9],$q=$n[10],$o=$k[0]=Math.sqrt($u*$u+$S*$S+$Y*$Y),$r=$k[1]=Math.sqrt($x*$x+$j*$j+$R*$R),$_=$k[2]=Math.sqrt($l*$l+$i*$i+$q*$q);if($zJ.isZero($o)||$zJ.isZero($r)||$zJ.isZero($_))return $T[1]=$T[2]=$T[3]=$T[4]=$T[6]=$T[7]=$T[8]=$T[9]=$T[11]=$T[12]=$T[13]=$T[14]=0,$T[0]=$T[5]=$T[10]=$T[15]=1,!1;var $s=$g._tempVector0,$d=$s.elements;$d[0]=$l/$_,$d[1]=$i/$_,$d[2]=$q/$_;var $p=$g._tempVector1,$U=$p.elements;$U[0]=$u/$o,$U[1]=$S/$o,$U[2]=$Y/$o;var $Q=$g._tempVector2;$kh.cross($s,$p,$Q);var $D=$g._tempVector1;return $kh.cross($Q,$s,$D),$T[3]=$T[7]=$T[11]=$T[12]=$T[13]=$T[14]=0,$T[15]=1,$T[0]=$D.x,$T[1]=$D.y,$T[2]=$D.z,$T[4]=$Q.x,$T[5]=$Q.y,$T[6]=$Q.z,$T[8]=$s.x,$T[9]=$s.y,$T[10]=$s.z,$T[0]*$u+$T[1]*$S+$T[2]*$Y<0&&($k[0]=-$o),$T[4]*$x+$T[5]*$j+$T[6]*$R<0&&($k[1]=-$r),$T[8]*$l+$T[9]*$i+$T[10]*$q<0&&($k[2]=-$_),!0;},$J.decomposeYawPitchRoll=function($J){var $h=$J.elements,$f=Math.asin(-this.elements[9]);$h[1]=$f,Math.cos($f)>$zJ.zeroTolerance?($h[2]=Math.atan2(this.elements[1],this.elements[5]),$h[0]=Math.atan2(this.elements[8],this.elements[10])):($h[2]=Math.atan2(-this.elements[4],this.elements[0]),$h[0]=0);},$J.normalize=function(){var $J=this.elements,$h=$J[0],$f=$J[1],$n=$J[2],$L=Math.sqrt($h*$h+$f*$f+$n*$n);if(!$L)return $J[0]=0,$J[1]=0,void($J[2]=0);1!=$L&&($L=1/$L,$J[0]=$h*$L,$J[1]=$f*$L,$J[2]=$n*$L);},$J.transpose=function(){var $J,$h;return $h=($J=this.elements)[1],$J[1]=$J[4],$J[4]=$h,$h=$J[2],$J[2]=$J[8],$J[8]=$h,$h=$J[3],$J[3]=$J[12],$J[12]=$h,$h=$J[6],$J[6]=$J[9],$J[9]=$h,$h=$J[7],$J[7]=$J[13],$J[13]=$h,$h=$J[11],$J[11]=$J[14],$J[14]=$h,this;},$J.invert=function($J){var $h=this.elements,$f=$J.elements,$n=$h[0],$L=$h[1],$T=$h[2],$k=$h[3],$u=$h[4],$S=$h[5],$Y=$h[6],$x=$h[7],$j=$h[8],$R=$h[9],$l=$h[10],$i=$h[11],$q=$h[12],$o=$h[13],$r=$h[14],$_=$h[15],$s=$n*$S-$L*$u,$d=$n*$Y-$T*$u,$p=$n*$x-$k*$u,$U=$L*$Y-$T*$S,$Q=$L*$x-$k*$S,$D=$T*$x-$k*$Y,$g=$j*$o-$R*$q,$F=$j*$r-$l*$q,$A=$j*$_-$i*$q,$G=$R*$r-$l*$o,$y=$R*$_-$i*$o,$O=$l*$_-$i*$r,$P=$s*$O-$d*$y+$p*$G+$U*$A-$Q*$F+$D*$g;0!==Math.abs($P)&&($P=1/$P,$f[0]=($S*$O-$Y*$y+$x*$G)*$P,$f[1]=($T*$y-$L*$O-$k*$G)*$P,$f[2]=($o*$D-$r*$Q+$_*$U)*$P,$f[3]=($l*$Q-$R*$D-$i*$U)*$P,$f[4]=($Y*$A-$u*$O-$x*$F)*$P,$f[5]=($n*$O-$T*$A+$k*$F)*$P,$f[6]=($r*$p-$q*$D-$_*$d)*$P,$f[7]=($j*$D-$l*$p+$i*$d)*$P,$f[8]=($u*$y-$S*$A+$x*$g)*$P,$f[9]=($L*$A-$n*$y-$k*$g)*$P,$f[10]=($q*$Q-$o*$p+$_*$s)*$P,$f[11]=($R*$p-$j*$Q-$i*$s)*$P,$f[12]=($S*$F-$u*$G-$Y*$g)*$P,$f[13]=($n*$G-$L*$F+$T*$g)*$P,$f[14]=($o*$d-$q*$U-$r*$s)*$P,$f[15]=($j*$U-$R*$d+$l*$s)*$P);},$J.identity=function(){var $J=this.elements;$J[1]=$J[2]=$J[3]=$J[4]=$J[6]=$J[7]=$J[8]=$J[9]=$J[11]=$J[12]=$J[13]=$J[14]=0,$J[0]=$J[5]=$J[10]=$J[15]=1;},$J.cloneTo=function($J){var $h,$f,$n;if(($f=this.elements)!==($n=$J.elements))for($h=0;$h<16;++$h)$n[$h]=$f[$h];},$J.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$J.getTranslationVector=function($J){var $h=this.elements,$f=$J.elements;$f[0]=$h[12],$f[1]=$h[13],$f[2]=$h[14];},$J.setTranslationVector=function($J){var $h=this.elements,$f=$J.elements;$h[12]=$f[0],$h[13]=$f[1],$h[14]=$f[2];},$J.getForward=function($J){var $h=this.elements,$f=$J.elements;$f[0]=-$h[8],$f[1]=-$h[9],$f[2]=-$h[10];},$J.setForward=function($J){var $h=this.elements,$f=$J.elements;$h[8]=-$f[0],$h[9]=-$f[1],$h[10]=-$f[2];},$g.createRotationX=function($J,$h){var $f=$h.elements,$n=Math.sin($J),$L=Math.cos($J);$f[1]=$f[2]=$f[3]=$f[4]=$f[7]=$f[8]=$f[11]=$f[12]=$f[13]=$f[14]=0,$f[0]=$f[15]=1,$f[5]=$f[10]=$L,$f[6]=$n,$f[9]=-$n;},$g.createRotationY=function($J,$h){var $f=$h.elements,$n=Math.sin($J),$L=Math.cos($J);$f[1]=$f[3]=$f[4]=$f[6]=$f[7]=$f[9]=$f[11]=$f[12]=$f[13]=$f[14]=0,$f[5]=$f[15]=1,$f[0]=$f[10]=$L,$f[2]=-$n,$f[8]=$n;},$g.createRotationZ=function($J,$h){var $f=$h.elements,$n=Math.sin($J),$L=Math.cos($J);$f[2]=$f[3]=$f[6]=$f[7]=$f[8]=$f[9]=$f[11]=$f[12]=$f[13]=$f[14]=0,$f[10]=$f[15]=1,$f[0]=$f[5]=$L,$f[1]=$n,$f[4]=-$n;},$g.createRotationYawPitchRoll=function($J,$h,$f,$n){$fh.createFromYawPitchRoll($J,$h,$f,$g._tempQuaternion),$g.createRotationQuaternion($g._tempQuaternion,$n);},$g.createRotationAxis=function($J,$h,$f){var $n=$J.elements,$L=$n[0],$T=$n[1],$k=$n[2],$u=Math.cos($h),$S=Math.sin($h),$Y=$L*$L,$x=$T*$T,$j=$k*$k,$R=$L*$T,$l=$L*$k,$i=$T*$k,$q=$f.elements;$q[3]=$q[7]=$q[11]=$q[12]=$q[13]=$q[14]=0,$q[15]=1,$q[0]=$Y+$u*(1-$Y),$q[1]=$R-$u*$R+$S*$k,$q[2]=$l-$u*$l-$S*$T,$q[4]=$R-$u*$R-$S*$k,$q[5]=$x+$u*(1-$x),$q[6]=$i-$u*$i+$S*$L,$q[8]=$l-$u*$l+$S*$T,$q[9]=$i-$u*$i-$S*$L,$q[10]=$j+$u*(1-$j);},$g.createRotationQuaternion=function($J,$h){var $f=$J.elements,$n=$h.elements,$L=$f[0],$T=$f[1],$k=$f[2],$u=$f[3],$S=$L*$L,$Y=$T*$T,$x=$k*$k,$j=$L*$T,$R=$k*$u,$l=$k*$L,$i=$T*$u,$q=$T*$k,$o=$L*$u;$n[3]=$n[7]=$n[11]=$n[12]=$n[13]=$n[14]=0,$n[15]=1,$n[0]=1-2*($Y+$x),$n[1]=2*($j+$R),$n[2]=2*($l-$i),$n[4]=2*($j-$R),$n[5]=1-2*($x+$S),$n[6]=2*($q+$o),$n[8]=2*($l+$i),$n[9]=2*($q-$o),$n[10]=1-2*($Y+$S);},$g.createTranslate=function($J,$h){var $f=$J.elements,$n=$h.elements;$n[4]=$n[8]=$n[1]=$n[9]=$n[2]=$n[6]=$n[3]=$n[7]=$n[11]=0,$n[0]=$n[5]=$n[10]=$n[15]=1,$n[12]=$f[0],$n[13]=$f[1],$n[14]=$f[2];},$g.createScaling=function($J,$h){var $f=$J.elements,$n=$h.elements;$n[0]=$f[0],$n[5]=$f[1],$n[10]=$f[2],$n[1]=$n[4]=$n[8]=$n[12]=$n[9]=$n[13]=$n[2]=$n[6]=$n[14]=$n[3]=$n[7]=$n[11]=0,$n[15]=1;},$g.multiply=function($J,$h,$f){var $n,$L,$T,$k,$u,$S,$Y,$x;for($L=$f.elements,$T=$J.elements,$L===($k=$h.elements)&&($k=$k.slice()),$n=0;$n<4;$n++)$u=$T[$n],$S=$T[$n+4],$Y=$T[$n+8],$x=$T[$n+12],$L[$n]=$u*$k[0]+$S*$k[1]+$Y*$k[2]+$x*$k[3],$L[$n+4]=$u*$k[4]+$S*$k[5]+$Y*$k[6]+$x*$k[7],$L[$n+8]=$u*$k[8]+$S*$k[9]+$Y*$k[10]+$x*$k[11],$L[$n+12]=$u*$k[12]+$S*$k[13]+$Y*$k[14]+$x*$k[15];},$g.createFromQuaternion=function($J,$h){var $f=$h.elements,$n=$J.elements,$L=$n[0],$T=$n[1],$k=$n[2],$u=$n[3],$S=$L+$L,$Y=$T+$T,$x=$k+$k,$j=$L*$S,$R=$T*$S,$l=$T*$Y,$i=$k*$S,$q=$k*$Y,$o=$k*$x,$r=$u*$S,$_=$u*$Y,$s=$u*$x;$f[0]=1-$l-$o,$f[1]=$R+$s,$f[2]=$i-$_,$f[3]=0,$f[4]=$R-$s,$f[5]=1-$j-$o,$f[6]=$q+$r,$f[7]=0,$f[8]=$i+$_,$f[9]=$q-$r,$f[10]=1-$j-$l,$f[11]=0,$f[12]=0,$f[13]=0,$f[14]=0,$f[15]=1;},$g.createAffineTransformation=function($J,$h,$f,$n){var $L=$J.elements,$T=$h.elements,$k=$f.elements,$u=$n.elements,$S=$T[0],$Y=$T[1],$x=$T[2],$j=$T[3],$R=$S+$S,$l=$Y+$Y,$i=$x+$x,$q=$S*$R,$o=$S*$l,$r=$S*$i,$_=$Y*$l,$s=$Y*$i,$d=$x*$i,$p=$j*$R,$U=$j*$l,$Q=$j*$i,$D=$k[0],$g=$k[1],$F=$k[2];$u[0]=(1-($_+$d))*$D,$u[1]=($o+$Q)*$D,$u[2]=($r-$U)*$D,$u[3]=0,$u[4]=($o-$Q)*$g,$u[5]=(1-($q+$d))*$g,$u[6]=($s+$p)*$g,$u[7]=0,$u[8]=($r+$U)*$F,$u[9]=($s-$p)*$F,$u[10]=(1-($q+$_))*$F,$u[11]=0,$u[12]=$L[0],$u[13]=$L[1],$u[14]=$L[2],$u[15]=1;},$g.createLookAt=function($J,$h,$f,$n){var $L=$n.elements,$T=$g._tempVector0,$k=$g._tempVector1,$u=$g._tempVector2;$kh.subtract($J,$h,$u),$kh.normalize($u,$u),$kh.cross($f,$u,$T),$kh.normalize($T,$T),$kh.cross($u,$T,$k),$n.identity(),$L[0]=$T.x,$L[4]=$T.y,$L[8]=$T.z,$L[1]=$k.x,$L[5]=$k.y,$L[9]=$k.z,$L[2]=$u.x,$L[6]=$u.y,$L[10]=$u.z,$L[12]=-$kh.dot($T,$J),$L[13]=-$kh.dot($k,$J),$L[14]=-$kh.dot($u,$J);},$g.createPerspective=function($J,$h,$f,$n,$L){var $T=$L.elements,$k=1/Math.tan($J/2),$u=1/($f-$n);$T[0]=$k/$h,$T[5]=$k,$T[10]=($n+$f)*$u,$T[11]=-1,$T[14]=2*$n*$f*$u,$T[1]=$T[2]=$T[3]=$T[4]=$T[6]=$T[7]=$T[8]=$T[9]=$T[12]=$T[13]=$T[15]=0;},$g.createOrthoOffCenterRH=function($J,$h,$f,$n,$L,$T,$k){var $u=$k.elements,$S=1/($J-$h),$Y=1/($f-$n),$x=1/($L-$T);$u[1]=$u[2]=$u[3]=$u[4]=$u[6]=$u[7]=$u[8]=$u[9]=$u[11]=0,$u[15]=1,$u[0]=-2*$S,$u[5]=-2*$Y,$u[10]=2*$x,$u[12]=($J+$h)*$S,$u[13]=($n+$f)*$Y,$u[14]=($T+$L)*$x;},$g.translation=function($J,$h){var $f=$J.elements,$n=$h.elements;$n[0]=$n[5]=$n[10]=$n[15]=1,$n[12]=$f[0],$n[13]=$f[1],$n[14]=$f[2];},$j($g,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $g();},"_tempVector0",function(){return this._tempVector0=new $kh();},"_tempVector1",function(){return this._tempVector1=new $kh();},"_tempVector2",function(){return this._tempVector2=new $kh();},"_tempQuaternion",function(){return this._tempQuaternion=new $fh();},"DEFAULT",function(){return this.DEFAULT=new $g();},"ZERO",function(){return this.ZERO=new $g(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);}]),$g;}(),$hh=(function(){function $s($J,$h){this.extents=null,this.transformation=null,this.extents=$J,this.transformation=$h;}$l($s,"laya.d3.math.OrientedBoundBox");var $J=$s.prototype;$J.getCorners=function($J){var $h=$s._tempV30.elements,$f=$s._tempV31.elements,$n=$s._tempV32.elements,$L=this.extents.elements;$h[0]=$L[0],$h[1]=$h[2]=0,$f[1]=$L[1],$f[0]=$f[2]=0,$n[2]=$L[2],$n[0]=$n[1]=0,$kh.TransformNormal($s._tempV30,this.transformation,$s._tempV30),$kh.TransformNormal($s._tempV31,this.transformation,$s._tempV31),$kh.TransformNormal($s._tempV32,this.transformation,$s._tempV32);var $T=$s._tempV33;this.transformation.getTranslationVector($T),$J.length=8,$kh.add($T,$s._tempV30,$s._tempV34),$kh.add($s._tempV34,$s._tempV31,$s._tempV34),$kh.add($s._tempV34,$s._tempV32,$J[0]),$kh.add($T,$s._tempV30,$s._tempV34),$kh.add($s._tempV34,$s._tempV31,$s._tempV34),$kh.subtract($s._tempV34,$s._tempV32,$J[1]),$kh.subtract($T,$s._tempV30,$s._tempV34),$kh.add($s._tempV34,$s._tempV31,$s._tempV34),$kh.subtract($s._tempV34,$s._tempV32,$J[2]),$kh.subtract($T,$s._tempV30,$s._tempV34),$kh.add($s._tempV34,$s._tempV31,$s._tempV34),$kh.add($s._tempV34,$s._tempV32,$J[3]),$kh.add($T,$s._tempV30,$s._tempV34),$kh.subtract($s._tempV34,$s._tempV31,$s._tempV34),$kh.add($s._tempV34,$s._tempV32,$J[4]),$kh.add($T,$s._tempV30,$s._tempV34),$kh.subtract($s._tempV34,$s._tempV31,$s._tempV34),$kh.subtract($s._tempV34,$s._tempV32,$J[5]),$kh.subtract($T,$s._tempV30,$s._tempV34),$kh.subtract($s._tempV34,$s._tempV31,$s._tempV34),$kh.subtract($s._tempV34,$s._tempV32,$J[6]),$kh.subtract($T,$s._tempV30,$s._tempV34),$kh.subtract($s._tempV34,$s._tempV31,$s._tempV34),$kh.add($s._tempV34,$s._tempV32,$J[7]);},$J.transform=function($J){$Jh.multiply(this.transformation,$J,this.transformation);},$J.scale=function($J){$kh.multiply(this.extents,$J,this.extents);},$J.translate=function($J){this.transformation.getTranslationVector($s._tempV30),$kh.add($s._tempV30,$J,$s._tempV31),this.transformation.setTranslationVector($s._tempV31);},$J.Size=function($J){$kh.scale(this.extents,2,$J);},$J.getSize=function($J){var $h=this.extents.elements;$s._tempV30.x=$h[0],$s._tempV31.y=$h[1],$s._tempV32.z=$h[2],$kh.TransformNormal($s._tempV30,this.transformation,$s._tempV30),$kh.TransformNormal($s._tempV31,this.transformation,$s._tempV31),$kh.TransformNormal($s._tempV31,this.transformation,$s._tempV32);var $f=$J.elements;$f[0]=$kh.scalarLength($s._tempV30),$f[1]=$kh.scalarLength($s._tempV31),$f[2]=$kh.scalarLength($s._tempV32);},$J.getSizeSquared=function($J){var $h=this.extents.elements;$s._tempV30.x=$h[0],$s._tempV31.y=$h[1],$s._tempV32.z=$h[2],$kh.TransformNormal($s._tempV30,this.transformation,$s._tempV30),$kh.TransformNormal($s._tempV31,this.transformation,$s._tempV31),$kh.TransformNormal($s._tempV31,this.transformation,$s._tempV32);var $f=$J.elements;$f[0]=$kh.scalarLengthSquared($s._tempV30),$f[1]=$kh.scalarLengthSquared($s._tempV31),$f[2]=$kh.scalarLengthSquared($s._tempV32);},$J.getCenter=function($J){this.transformation.getTranslationVector($J);},$J.containsPoint=function($J){var $h=this.extents.elements,$f=$h[0],$n=$h[1],$L=$h[2];this.transformation.invert($s._tempM0),$kh.transformCoordinate($J,$s._tempM0,$s._tempV30);var $T=$s._tempV30.elements,$k=Math.abs($T[0]),$u=Math.abs($T[1]),$S=Math.abs($T[2]);return $zJ.nearEqual($k,$f)&&$zJ.nearEqual($u,$n)&&$zJ.nearEqual($S,$L)?2:$k<$f&&$u<$n&&$S<$L?1:0;},$J.containsPoints=function($J){var $h=this.extents.elements,$f=$h[0],$n=$h[1],$L=$h[2];this.transformation.invert($s._tempM0);for(var $T=!0,$k=!1,$u=0;$u<$J.length;$u++){$kh.transformCoordinate($J[$u],$s._tempM0,$s._tempV30);var $S=$s._tempV30.elements,$Y=Math.abs($S[0]),$x=Math.abs($S[1]),$j=Math.abs($S[2]);$zJ.nearEqual($Y,$f)&&$zJ.nearEqual($x,$n)&&$zJ.nearEqual($j,$L)&&($k=!0),$Y<$f&&$x<$n&&$j<$L?$k=!0:$T=!1;}return $T?1:$k?2:0;},$J.containsSphere=function($J,$h){void 0===$h&&($h=!1);var $f=this.extents.elements,$n=$f[0],$L=$f[1],$T=$f[2],$k=$J.radius;this.transformation.invert($s._tempM0),$kh.transformCoordinate($J.center,$s._tempM0,$s._tempV30);var $u=NaN;if($u=$h?$k:($kh.scale($kh.UnitX,$k,$s._tempV31),$kh.TransformNormal($s._tempV31,$s._tempM0,$s._tempV31),$kh.scalarLength($s._tempV31)),$kh.scale(this.extents,-1,$s._tempV32),$kh.Clamp($s._tempV30,$s._tempV32,this.extents,$s._tempV33),$u*$u<$kh.distanceSquared($s._tempV30,$s._tempV33))return 0;var $S=$s._tempV30.elements,$Y=$S[0],$x=$S[1],$j=$S[2],$R=$s._tempV32.elements,$l=$R[0],$i=$R[1],$q=$R[2];return $l+$u<=$Y&&$Y<=$n-$u&&$u<$n-$l&&$i+$u<=$x&&$x<=$L-$u&&$u<$L-$i&&$q+$u<=$j&&$j<=$T-$u&&$u<$T-$q?1:2;},$J.containsOrientedBoundBox=function($J){var $h=0,$f=0;$J.getCorners($s._corners);var $n=this.containsPoints($s._corners);if(0!=$n)return $n;var $L=this.extents.elements;$J.extents.cloneTo($s._tempV35);var $T=$s._tempV35.elements;$s._getRows(this.transformation,$s._rows1),$s._getRows($J.transformation,$s._rows2);var $k=NaN;for($h=0;$h<4;$h++)for($f=0;$f<4;$f++)3==$h||3==$f?($s._tempM0.setElementByRowColumn($h,$f,0),$s._tempM1.setElementByRowColumn($h,$f,0)):($k=$kh.dot($s._rows1[$h],$s._rows2[$f]),$s._tempM0.setElementByRowColumn($h,$f,$k),$s._tempM1.setElementByRowColumn($h,$f,Math.abs($k)));$J.getCenter($s._tempV34),this.getCenter($s._tempV36),$kh.subtract($s._tempV34,$s._tempV36,$s._tempV30);var $u=$s._tempV31.elements;$u[0]=$kh.dot($s._tempV30,$s._rows1[0]),$u[1]=$kh.dot($s._tempV30,$s._rows1[1]),$u[2]=$kh.dot($s._tempV30,$s._rows1[2]);var $S=$s._tempV32.elements,$Y=$s._tempV33.elements;for($h=0;$h<3;$h++)if($S[0]=$s._tempM1.getElementByRowColumn($h,0),$S[1]=$s._tempM1.getElementByRowColumn($h,1),$S[2]=$s._tempM1.getElementByRowColumn($h,2),$L[$h]+$kh.dot($s._tempV35,$s._tempV32)<Math.abs($u[$h]))return 0;for($f=0;$f<3;$f++)if($S[0]=$s._tempM1.getElementByRowColumn(0,$f),$S[1]=$s._tempM1.getElementByRowColumn(1,$f),$S[2]=$s._tempM1.getElementByRowColumn(2,$f),$Y[0]=$s._tempM0.getElementByRowColumn(0,$f),$Y[1]=$s._tempM0.getElementByRowColumn(1,$f),$Y[2]=$s._tempM0.getElementByRowColumn(2,$f),$kh.dot(this.extents,$s._tempV32)+$T[$f]<Math.abs($kh.dot($s._tempV31,$s._tempV33)))return 0;for($h=0;$h<3;$h++)for($f=0;$f<3;$f++){var $x=($h+1)%3,$j=($h+2)%3,$R=($f+1)%3,$l=($f+2)%3;if($L[$x]*$s._tempM1.getElementByRowColumn($j,$f)+$L[$j]*$s._tempM1.getElementByRowColumn($x,$f)+($T[$R]*$s._tempM1.getElementByRowColumn($h,$l)+$T[$l]*$s._tempM1.getElementByRowColumn($h,$R))<Math.abs($u[$j]*$s._tempM0.getElementByRowColumn($x,$f)-$u[$x]*$s._tempM0.getElementByRowColumn($j,$f)))return 0;}return 2;},$J.containsLine=function($J,$h){$s._corners[0]=$J,$s._corners[1]=$h;var $f=this.containsPoints($s._corners);if(0!=$f)return $f;var $n=this.extents.elements,$L=$n[0],$T=$n[1],$k=$n[2];this.transformation.invert($s._tempM0),$kh.transformCoordinate($J,$s._tempM0,$s._tempV30),$kh.transformCoordinate($h,$s._tempM0,$s._tempV31),$kh.add($s._tempV30,$s._tempV31,$s._tempV32),$kh.scale($s._tempV32,.5,$s._tempV32),$kh.subtract($s._tempV30,$s._tempV32,$s._tempV33);var $u=$s._tempV33.elements,$S=$u[0],$Y=$u[1],$x=$u[2],$j=$s._tempV34.elements,$R=$j[0]=Math.abs($u[0]),$l=$j[1]=Math.abs($u[1]),$i=$j[2]=Math.abs($u[2]),$q=$s._tempV32.elements,$o=$q[0],$r=$q[1],$_=$q[2];return Math.abs($o)>$L+$R?0:Math.abs($r)>$T+$l?0:Math.abs($_)>$k+$i?0:Math.abs($r*$x-$_*$Y)>$T*$i+$k*$l?0:Math.abs($o*$x-$_*$S)>$L*$i+$k*$R?0:Math.abs($o*$Y-$r*$S)>$L*$l+$T*$R?0:2;},$J.containsBoundBox=function($J){var $h=0,$f=0,$n=$J.min,$L=$J.max;$J.getCorners($s._corners);var $T=this.containsPoints($s._corners);if(0!=$T)return $T;$kh.subtract($L,$n,$s._tempV30),$kh.scale($s._tempV30,.5,$s._tempV30),$kh.add($n,$s._tempV30,$s._tempV30),$kh.subtract($L,$s._tempV30,$s._tempV31);var $k=this.extents.elements,$u=$s._tempV31.elements;$s._getRows(this.transformation,$s._rows1),this.transformation.invert($s._tempM0);for($h=0;$h<3;$h++)for($f=0;$f<3;$f++)$s._tempM1.setElementByRowColumn($h,$f,Math.abs($s._tempM0.getElementByRowColumn($h,$f)));this.getCenter($s._tempV35),$kh.subtract($s._tempV30,$s._tempV35,$s._tempV32);var $S=$s._tempV31.elements;$S[0]=$kh.dot($s._tempV32,$s._rows1[0]),$S[1]=$kh.dot($s._tempV32,$s._rows1[1]),$S[2]=$kh.dot($s._tempV32,$s._rows1[2]);var $Y=$s._tempV33.elements,$x=$s._tempV34.elements;for($h=0;$h<3;$h++)if($Y[0]=$s._tempM1.getElementByRowColumn($h,0),$Y[1]=$s._tempM1.getElementByRowColumn($h,1),$Y[2]=$s._tempM1.getElementByRowColumn($h,2),$k[$h]+$kh.dot($s._tempV31,$s._tempV33)<Math.abs($S[$h]))return 0;for($f=0;$f<3;$f++)if($Y[0]=$s._tempM1.getElementByRowColumn(0,$f),$Y[1]=$s._tempM1.getElementByRowColumn(1,$f),$Y[2]=$s._tempM1.getElementByRowColumn(2,$f),$x[0]=$s._tempM0.getElementByRowColumn(0,$f),$x[1]=$s._tempM0.getElementByRowColumn(1,$f),$x[2]=$s._tempM0.getElementByRowColumn(2,$f),$kh.dot(this.extents,$s._tempV33)+$u[$f]<Math.abs($kh.dot($s._tempV31,$s._tempV34)))return 0;for($h=0;$h<3;$h++)for($f=0;$f<3;$f++){var $j=($h+1)%3,$R=($h+2)%3,$l=($f+1)%3,$i=($f+2)%3;if($k[$j]*$s._tempM1.getElementByRowColumn($R,$f)+$k[$R]*$s._tempM1.getElementByRowColumn($j,$f)+($u[$l]*$s._tempM1.getElementByRowColumn($h,$i)+$u[$i]*$s._tempM1.getElementByRowColumn($h,$l))<Math.abs($S[$R]*$s._tempM0.getElementByRowColumn($j,$f)-$S[$j]*$s._tempM0.getElementByRowColumn($R,$f)))return 0;}return 2;},$J.intersectsRay=function($J,$h){$kh.scale(this.extents,-1,$s._tempV30),this.transformation.invert($s._tempM0),$kh.TransformNormal($J.direction,$s._tempM0,$s._ray.direction),$kh.transformCoordinate($J.origin,$s._tempM0,$s._ray.origin),$s._boxBound1.min=$s._tempV30,$s._boxBound1.max=this.extents;var $f=Collision.intersectsRayAndBoxRP($s._ray,$s._boxBound1,$h);return-1!==$f&&$kh.transformCoordinate($h,this.transformation,$h),$f;},$J._getLocalCorners=function($J){$J.length=8;var $h=this.extents.elements;$s._tempV30.x=$h[0],$s._tempV31.y=$h[1],$s._tempV32.z=$h[2],$kh.add($s._tempV30,$s._tempV31,$s._tempV33),$kh.add($s._tempV33,$s._tempV32,$J[0]),$kh.add($s._tempV30,$s._tempV31,$s._tempV33),$kh.subtract($s._tempV33,$s._tempV32,$J[1]),$kh.subtract($s._tempV31,$s._tempV30,$s._tempV33),$kh.subtract($s._tempV33,$s._tempV30,$J[2]),$kh.subtract($s._tempV31,$s._tempV30,$s._tempV33),$kh.add($s._tempV33,$s._tempV32,$J[3]),$kh.subtract($s._tempV30,$s._tempV31,$s._tempV33),$kh.add($s._tempV33,$s._tempV32,$J[4]),$kh.subtract($s._tempV30,$s._tempV31,$s._tempV33),$kh.subtract($s._tempV33,$s._tempV32,$J[5]),$kh.scale($J[0],-1,$J[6]),$kh.subtract($s._tempV32,$s._tempV30,$s._tempV33),$kh.subtract($s._tempV33,$s._tempV31,$J[7]);},$J.equals=function($J){return this.extents==$J.extents&&this.transformation==$J.transformation;},$J.cloneTo=function($J){var $h=$J;this.extents.cloneTo($h.extents),this.transformation.cloneTo($h.transformation);},$s.createByBoundBox=function($J,$h){var $f=$J.min,$n=$J.max;$kh.subtract($n,$f,$s._tempV30),$kh.scale($s._tempV30,.5,$s._tempV30),$kh.add($f,$s._tempV30,$s._tempV31),$kh.subtract($n,$s._tempV31,$s._tempV32),$Jh.translation($s._tempV31,$s._tempM0);var $L=$s._tempV32.clone(),$T=$s._tempM0.clone();$h.extents=$L,$h.transformation=$T;},$s.createByMinAndMaxVertex=function($J,$h){return $kh.subtract($h,$J,$s._tempV30),$kh.scale($s._tempV30,.5,$s._tempV30),$kh.add($J,$s._tempV30,$s._tempV31),$kh.subtract($h,$s._tempV31,$s._tempV32),$Jh.translation($s._tempV31,$s._tempM0),new $s($s._tempV32,$s._tempM0);},$s._getRows=function($J,$h){$h.length=3;var $f=$J.elements,$n=$h[0].elements;$n[0]=$f[0],$n[1]=$f[1],$n[2]=$f[2];var $L=$h[1].elements;$L[0]=$f[4],$L[1]=$f[5],$L[2]=$f[6];var $T=$h[2].elements;$T[0]=$f[8],$T[1]=$f[9],$T[2]=$f[10];},$s.getObbtoObbMatrix4x4=function($J,$h,$f,$n){var $L=$J.transformation,$T=$h.transformation;if($f){$s._getRows($L,$s._rows1),$s._getRows($T,$s._rows2);for(var $k=0;$k<3;$k++)for(var $u=0;$u<3;$u++)$n.setElementByRowColumn($k,$u,$kh.dot($s._rows2[$k],$s._rows1[$u]));$h.getCenter($s._tempV30),$J.getCenter($s._tempV31),$kh.subtract($s._tempV30,$s._tempV31,$s._tempV32);var $S=$n.elements;$S[12]=$kh.dot($s._tempV32,$s._rows1[0]),$S[13]=$kh.dot($s._tempV32,$s._rows1[1]),$S[14]=$kh.dot($s._tempV32,$s._rows1[2]),$S[15]=1;}else $L.invert($s._tempM0),$Jh.multiply($T,$s._tempM0,$n);},$s.merge=function($J,$h,$f){var $n=$J.extents,$L=$J.transformation;$s.getObbtoObbMatrix4x4($J,$h,$f,$s._tempM0),$h._getLocalCorners($s._corners),$kh.transformCoordinate($s._corners[0],$s._tempM0,$s._corners[0]),$kh.transformCoordinate($s._corners[1],$s._tempM0,$s._corners[1]),$kh.transformCoordinate($s._corners[2],$s._tempM0,$s._corners[2]),$kh.transformCoordinate($s._corners[3],$s._tempM0,$s._corners[3]),$kh.transformCoordinate($s._corners[4],$s._tempM0,$s._corners[4]),$kh.transformCoordinate($s._corners[5],$s._tempM0,$s._corners[5]),$kh.transformCoordinate($s._corners[6],$s._tempM0,$s._corners[6]),$kh.transformCoordinate($s._corners[7],$s._tempM0,$s._corners[7]),$kh.scale($n,-1,$s._boxBound1.min),$n.cloneTo($s._boxBound1.max),$wJ.createfromPoints($s._corners,$s._boxBound2),$wJ.merge($s._boxBound2,$s._boxBound1,$s._boxBound3);var $T=$s._boxBound3.min,$k=$s._boxBound3.max;$kh.subtract($k,$T,$s._tempV30),$kh.scale($s._tempV30,.5,$s._tempV30),$kh.add($T,$s._tempV30,$s._tempV32),$kh.subtract($k,$s._tempV32,$n),$kh.transformCoordinate($s._tempV32,$L,$s._tempV33);},$j($s,["_tempV30",function(){return this._tempV30=new $kh();},"_tempV31",function(){return this._tempV31=new $kh();},"_tempV32",function(){return this._tempV32=new $kh();},"_tempV33",function(){return this._tempV33=new $kh();},"_tempV34",function(){return this._tempV34=new $kh();},"_tempV35",function(){return this._tempV35=new $kh();},"_tempV36",function(){return this._tempV36=new $kh();},"_tempM0",function(){return this._tempM0=new $Jh();},"_tempM1",function(){return this._tempM1=new $Jh();},"_corners",function(){return this._corners=[new $kh(),new $kh(),new $kh(),new $kh(),new $kh(),new $kh(),new $kh(),new $kh()];},"_rows1",function(){return this._rows1=[new $kh(),new $kh(),new $kh()];},"_rows2",function(){return this._rows2=[new $kh(),new $kh(),new $kh()];},"_ray",function(){return this._ray=new $Lh(new $kh(),new $kh());},"_boxBound1",function(){return this._boxBound1=new $wJ(new $kh(),new $kh());},"_boxBound2",function(){return this._boxBound2=new $wJ(new $kh(),new $kh());},"_boxBound3",function(){return this._boxBound3=new $wJ(new $kh(),new $kh());}]);}(),function(){function $p($J,$h){this.normal=null,this.distance=NaN,void 0===$h&&($h=0),this.normal=$J,this.distance=$h;}return $l($p,"laya.d3.math.Plane"),$p.prototype.normalize=function(){var $J=this.normal.elements,$h=$J[0],$f=$J[1],$n=$J[2],$L=1/Math.sqrt($h*$h+$f*$f+$n*$n);$J[0]=$h*$L,$J[1]=$f*$L,$J[2]=$n*$L,this.distance*=$L;},$p.createPlaneBy3P=function($J,$h,$f){var $n=$J.elements,$L=$h.elements,$T=$f.elements,$k=$L[0]-$n[0],$u=$L[1]-$n[1],$S=$L[2]-$n[2],$Y=$T[0]-$n[0],$x=$T[1]-$n[1],$j=$T[2]-$n[2],$R=$u*$j-$S*$x,$l=$S*$Y-$k*$j,$i=$k*$x-$u*$Y,$q=1/Math.sqrt($R*$R+$l*$l+$i*$i),$o=$R*$q,$r=$l*$q,$_=$i*$q,$s=$p._TEMPVec3.elements;$s[0]=$o,$s[1]=$r,$s[2]=$_;var $d=-($o*$n[0]+$r*$n[1]+$_*$n[2]);return new $p($p._TEMPVec3,$d);},$p.PlaneIntersectionType_Back=0,$p.PlaneIntersectionType_Front=1,$p.PlaneIntersectionType_Intersecting=2,$j($p,["_TEMPVec3",function(){return this._TEMPVec3=new $kh();}]),$p;}()),$fh=function(){function $L($J,$h,$f,$n){this.elements=new Float32Array(4),void 0===$J&&($J=0),void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=1),this.elements[0]=$J,this.elements[1]=$h,this.elements[2]=$f,this.elements[3]=$n;}$l($L,"laya.d3.math.Quaternion");var $J=$L.prototype;return $p.imps($J,{"laya.d3.core.IClone":!0}),$J.scaling=function($J,$h){var $f=$h.elements,$n=this.elements;$f[0]=$n[0]*$J,$f[1]=$n[1]*$J,$f[2]=$n[2]*$J,$f[3]=$n[3]*$J;},$J.normalize=function($J){var $h=$J.elements,$f=this.elements,$n=$f[0],$L=$f[1],$T=$f[2],$k=$f[3],$u=$n*$n+$L*$L+$T*$T+$k*$k;0<$u&&($u=1/Math.sqrt($u),$h[0]=$n*$u,$h[1]=$L*$u,$h[2]=$T*$u,$h[3]=$k*$u);},$J.length=function(){var $J=this.elements,$h=$J[0],$f=$J[1],$n=$J[2],$L=$J[3];return Math.sqrt($h*$h+$f*$f+$n*$n+$L*$L);},$J.rotateX=function($J,$h){var $f=$h.elements,$n=this.elements;$J*=.5;var $L=$n[0],$T=$n[1],$k=$n[2],$u=$n[3],$S=Math.sin($J),$Y=Math.cos($J);$f[0]=$L*$Y+$u*$S,$f[1]=$T*$Y+$k*$S,$f[2]=$k*$Y-$T*$S,$f[3]=$u*$Y-$L*$S;},$J.rotateY=function($J,$h){var $f=$h.elements,$n=this.elements;$J*=.5;var $L=$n[0],$T=$n[1],$k=$n[2],$u=$n[3],$S=Math.sin($J),$Y=Math.cos($J);$f[0]=$L*$Y-$k*$S,$f[1]=$T*$Y+$u*$S,$f[2]=$k*$Y+$L*$S,$f[3]=$u*$Y-$T*$S;},$J.rotateZ=function($J,$h){var $f=$h.elements,$n=this.elements;$J*=.5;var $L=$n[0],$T=$n[1],$k=$n[2],$u=$n[3],$S=Math.sin($J),$Y=Math.cos($J);$f[0]=$L*$Y+$T*$S,$f[1]=$T*$Y-$L*$S,$f[2]=$k*$Y+$u*$S,$f[3]=$u*$Y-$k*$S;},$J.getYawPitchRoll=function($J){$kh.transformQuat($kh.ForwardRH,this,$L.TEMPVector31),$kh.transformQuat($kh.Up,this,$L.TEMPVector32);var $h=$L.TEMPVector32.elements;$L.angleTo($kh.ZERO,$L.TEMPVector31,$L.TEMPVector33);var $f=$L.TEMPVector33.elements;$f[0]==Math.PI/2?($f[1]=$L.arcTanAngle($h[2],$h[0]),$f[2]=0):$f[0]==-Math.PI/2?($f[1]=$L.arcTanAngle(-$h[2],-$h[0]),$f[2]=0):($Jh.createRotationY(-$f[1],$L.TEMPMatrix0),$Jh.createRotationX(-$f[0],$L.TEMPMatrix1),$kh.transformCoordinate($L.TEMPVector32,$L.TEMPMatrix0,$L.TEMPVector32),$kh.transformCoordinate($L.TEMPVector32,$L.TEMPMatrix1,$L.TEMPVector32),$f[2]=$L.arcTanAngle($h[1],-$h[0])),$f[1]<=-Math.PI&&($f[1]=Math.PI),$f[2]<=-Math.PI&&($f[2]=Math.PI),$f[1]>=Math.PI&&$f[2]>=Math.PI&&($f[1]=0,$f[2]=0,$f[0]=Math.PI-$f[0]);var $n=$J.elements;$n[0]=$f[1],$n[1]=$f[0],$n[2]=$f[2];},$J.invert=function($J){var $h=$J.elements,$f=this.elements,$n=$f[0],$L=$f[1],$T=$f[2],$k=$f[3],$u=$n*$n+$L*$L+$T*$T+$k*$k,$S=$u?1/$u:0;$h[0]=-$n*$S,$h[1]=-$L*$S,$h[2]=-$T*$S,$h[3]=$k*$S;},$J.identity=function(){var $J=this.elements;$J[0]=0,$J[1]=0,$J[2]=0,$J[3]=1;},$J.fromArray=function($J,$h){void 0===$h&&($h=0),this.elements[0]=$J[$h+0],this.elements[1]=$J[$h+1],this.elements[2]=$J[$h+2],this.elements[3]=$J[$h+3];},$J.cloneTo=function($J){var $h,$f,$n;if(($f=this.elements)!==($n=$J.elements))for($h=0;$h<4;++$h)$n[$h]=$f[$h];},$J.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$J.equals=function($J){var $h=this.elements,$f=$J.elements;return $zJ.nearEqual($h[0],$f[0])&&$zJ.nearEqual($h[1],$f[1])&&$zJ.nearEqual($h[2],$f[2])&&$zJ.nearEqual($h[3],$f[3]);},$J.lengthSquared=function(){var $J=this.elements[0],$h=this.elements[1],$f=this.elements[2],$n=this.elements[3];return $J*$J+$h*$h+$f*$f+$n*$n;},$i(0,$J,"x",function(){return this.elements[0];}),$i(0,$J,"y",function(){return this.elements[1];}),$i(0,$J,"z",function(){return this.elements[2];}),$i(0,$J,"w",function(){return this.elements[3];}),$L.createFromYawPitchRoll=function($J,$h,$f,$n){var $L=.5*$f,$T=.5*$h,$k=.5*$J,$u=Math.sin($L),$S=Math.cos($L),$Y=Math.sin($T),$x=Math.cos($T),$j=Math.sin($k),$R=Math.cos($k),$l=$n.elements;$l[0]=$R*$Y*$S+$j*$x*$u,$l[1]=$j*$x*$S-$R*$Y*$u,$l[2]=$R*$x*$u-$j*$Y*$S,$l[3]=$R*$x*$S+$j*$Y*$u;},$L.multiply=function($J,$h,$f){var $n=$J.elements,$L=$h.elements,$T=$f.elements,$k=$n[0],$u=$n[1],$S=$n[2],$Y=$n[3],$x=$L[0],$j=$L[1],$R=$L[2],$l=$L[3],$i=$u*$R-$S*$j,$q=$S*$x-$k*$R,$o=$k*$j-$u*$x,$r=$k*$x+$u*$j+$S*$R;$T[0]=$k*$l+$x*$Y+$i,$T[1]=$u*$l+$j*$Y+$q,$T[2]=$S*$l+$R*$Y+$o,$T[3]=$Y*$l-$r;},$L.arcTanAngle=function($J,$h){return 0==$J?1==$h?Math.PI/2:-Math.PI/2:0<$J?Math.atan($h/$J):$J<0?0<$h?Math.atan($h/$J)+Math.PI:Math.atan($h/$J)-Math.PI:0;},$L.angleTo=function($J,$h,$f){$kh.subtract($h,$J,$L.TEMPVector30),$kh.normalize($L.TEMPVector30,$L.TEMPVector30),$f.elements[0]=Math.asin($L.TEMPVector30.y),$f.elements[1]=$L.arcTanAngle(-$L.TEMPVector30.z,-$L.TEMPVector30.x);},$L.createFromAxisAngle=function($J,$h,$f){var $n=$f.elements,$L=$J.elements;$h*=.5;var $T=Math.sin($h);$n[0]=$T*$L[0],$n[1]=$T*$L[1],$n[2]=$T*$L[2],$n[3]=Math.cos($h);},$L.createFromMatrix3x3=function($J,$h){var $f,$n=$h.elements,$L=$J.elements,$T=$L[0]+$L[4]+$L[8];if(0<$T)$f=Math.sqrt($T+1),$n[3]=.5*$f,$f=.5/$f,$n[0]=($L[5]-$L[7])*$f,$n[1]=($L[6]-$L[2])*$f,$n[2]=($L[1]-$L[3])*$f;else{var $k=0;$L[4]>$L[0]&&($k=1),$L[8]>$L[3*$k+$k]&&($k=2);var $u=($k+1)%3,$S=($k+2)%3;$f=Math.sqrt($L[3*$k+$k]-$L[3*$u+$u]-$L[3*$S+$S]+1),$n[$k]=.5*$f,$f=.5/$f,$n[3]=($L[3*$u+$S]-$L[3*$S+$u])*$f,$n[$u]=($L[3*$u+$k]+$L[3*$k+$u])*$f,$n[$S]=($L[3*$S+$k]+$L[3*$k+$S])*$f;}},$L.createFromMatrix4x4=function($J,$h){var $f,$n,$L=$J.elements,$T=$h.elements,$k=$L[0]+$L[5]+$L[10];0<$k?($f=Math.sqrt($k+1),$T[3]=.5*$f,$f=.5/$f,$T[0]=($L[6]-$L[9])*$f,$T[1]=($L[8]-$L[2])*$f,$T[2]=($L[1]-$L[4])*$f):$L[0]>=$L[5]&&$L[0]>=$L[10]?($n=.5/($f=Math.sqrt(1+$L[0]-$L[5]-$L[10])),$T[0]=.5*$f,$T[1]=($L[1]+$L[4])*$n,$T[2]=($L[2]+$L[8])*$n,$T[3]=($L[6]-$L[9])*$n):$L[5]>$L[10]?($n=.5/($f=Math.sqrt(1+$L[5]-$L[0]-$L[10])),$T[0]=($L[4]+$L[1])*$n,$T[1]=.5*$f,$T[2]=($L[9]+$L[6])*$n,$T[3]=($L[8]-$L[2])*$n):($n=.5/($f=Math.sqrt(1+$L[10]-$L[0]-$L[5])),$T[0]=($L[8]+$L[2])*$n,$T[1]=($L[9]+$L[6])*$n,$T[2]=.5*$f,$T[3]=($L[1]-$L[4])*$n);},$L.slerp=function($J,$h,$f,$n){var $L,$T,$k,$u,$S,$Y=$J.elements,$x=$h.elements,$j=$n.elements,$R=$Y[0],$l=$Y[1],$i=$Y[2],$q=$Y[3],$o=$x[0],$r=$x[1],$_=$x[2],$s=$x[3];return($T=$R*$o+$l*$r+$i*$_+$q*$s)<0&&($T=-$T,$o=-$o,$r=-$r,$_=-$_,$s=-$s),$S=1e-6<1-$T?($L=Math.acos($T),$k=Math.sin($L),$u=Math.sin((1-$f)*$L)/$k,Math.sin($f*$L)/$k):($u=1-$f,$f),$j[0]=$u*$R+$S*$o,$j[1]=$u*$l+$S*$r,$j[2]=$u*$i+$S*$_,$j[3]=$u*$q+$S*$s,$j;},$L.lerp=function($J,$h,$f,$n){var $L=$n.elements,$T=$J.elements,$k=$h.elements,$u=$T[0],$S=$T[1],$Y=$T[2],$x=$T[3];$L[0]=$u+$f*($k[0]-$u),$L[1]=$S+$f*($k[1]-$S),$L[2]=$Y+$f*($k[2]-$Y),$L[3]=$x+$f*($k[3]-$x);},$L.add=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements;$n[0]=$L[0]+$T[0],$n[1]=$L[1]+$T[1],$n[2]=$L[2]+$T[2],$n[3]=$L[3]+$T[3];},$L.dot=function($J,$h){var $f=$J.elements,$n=$h.elements;return $f[0]*$n[0]+$f[1]*$n[1]+$f[2]*$n[2]+$f[3]*$n[3];},$L.rotationLookAt=function($J,$h,$f){$L.lookAt($kh.ZERO,$J,$h,$f);},$L.lookAt=function($J,$h,$f,$n){$KJ.lookAt($J,$h,$f,$L._tempMatrix3x3),$L.rotationMatrix($L._tempMatrix3x3,$n);},$L.invert=function($J,$h){var $f=$J.elements,$n=$h.elements,$L=$J.lengthSquared();$zJ.isZero($L)||($L=1/$L,$n[0]=-$f[0]*$L,$n[1]=-$f[1]*$L,$n[2]=-$f[2]*$L,$n[3]=$f[3]*$L);},$L.rotationMatrix=function($J,$h){var $f=$J.elements,$n=$f[0],$L=$f[1],$T=$f[2],$k=$f[3],$u=$f[4],$S=$f[5],$Y=$f[6],$x=$f[7],$j=$f[8],$R=$h.elements,$l=NaN,$i=NaN,$q=$n+$u+$j;0<$q?($l=Math.sqrt($q+1),$R[3]=.5*$l,$l=.5/$l,$R[0]=($S-$x)*$l,$R[1]=($Y-$T)*$l,$R[2]=($L-$k)*$l):$u<=$n&&$j<=$n?($i=.5/($l=Math.sqrt(1+$n-$u-$j)),$R[0]=.5*$l,$R[1]=($L+$k)*$i,$R[2]=($T+$Y)*$i,$R[3]=($S-$x)*$i):$j<$u?($i=.5/($l=Math.sqrt(1+$u-$n-$j)),$R[0]=($k+$L)*$i,$R[1]=.5*$l,$R[2]=($x+$S)*$i,$R[3]=($Y-$T)*$i):($i=.5/($l=Math.sqrt(1+$j-$n-$u)),$R[0]=($Y+$T)*$i,$R[1]=($x+$S)*$i,$R[2]=.5*$l,$R[3]=($L-$k)*$i);},$L.DEFAULT=new $L(),$j($L,["TEMPVector30",function(){return this.TEMPVector30=new $kh();},"TEMPVector31",function(){return this.TEMPVector31=new $kh();},"TEMPVector32",function(){return this.TEMPVector32=new $kh();},"TEMPVector33",function(){return this.TEMPVector33=new $kh();},"TEMPMatrix0",function(){return this.TEMPMatrix0=new $Jh();},"TEMPMatrix1",function(){return this.TEMPMatrix1=new $Jh();},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new $KJ();},"NAN",function(){return this.NAN=new $L(NaN,NaN,NaN,NaN);}]),$L;}(),$nh=function(){function $J($J){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=$J,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1;}$l($J,"laya.d3.math.Rand");var $h=$J.prototype;return $h.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3];},$h.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607);},$h.getSignedFloat=function(){return 2*this.getFloat()-1;},$i(0,$h,"seed",function(){return this.seeds[0];},function($J){this.seeds[0]=$J,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1;}),$J.getFloatFromInt=function($J){return 1/8388607*(8388607&$J);},$J.getByteFromInt=function($J){return(8388607&$J)>>>15;},$J;}(),$Lh=(function(){function $L($J){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!($J instanceof Array)||4!==$J.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|$J[0],this._state0L=0|$J[1],this._state1U=0|$J[2],this._state1L=0|$J[3];}$l($L,"laya.d3.math.RandX");var $J=$L.prototype;$J.randomint=function(){var $J=this._state0U,$h=this._state0L,$f=this._state1U,$n=this._state1L,$L=($n>>>0)+($h>>>0),$T=$f+$J+($L/2>>>31)>>>0,$k=$L>>>0,$u=0,$S=0;$u=($J^=$u=$J<<23|(-512&$h)>>>9)^(this._state0U=$f),$S=($h^=$S=$h<<23)^(this._state0L=$n);$u^=$J>>>18,$S^=$h>>>18|(262143&$J)<<14;return $u^=$f>>>5,$S^=$n>>>5|(31&$f)<<27,this._state1U=$u,this._state1L=$S,[$T,$k];},$J.random=function(){var $J=this.randomint(),$h=$J[0],$f=1023<<20|$h>>>12,$n=0|($J[1]>>>12|(4095&$h)<<20);return $L._CONVERTION_BUFFER.setUint32(0,$f,!1),$L._CONVERTION_BUFFER.setUint32(4,$n,!1),$nh._CONVERTION_BUFFER.getFloat64(0,!1)-1;},$j($L,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8));},"defaultRand",function(){return this.defaultRand=new $nh([0,Date.now()/65536,0,Date.now()%65536]);}]);}(),function(){function $J($J,$h){this.origin=null,this.direction=null,this.origin=$J,this.direction=$h;}return $l($J,"laya.d3.math.Ray"),$J;}()),$Th=function(){function $J($J,$h){this.elements=new Float32Array(2),void 0===$J&&($J=0),void 0===$h&&($h=0);var $f=this.elements;$f[0]=$J,$f[1]=$h;}$l($J,"laya.d3.math.Vector2");var $h=$J.prototype;return $p.imps($h,{"laya.d3.core.IClone":!0}),$h.fromArray=function($J,$h){void 0===$h&&($h=0),this.elements[0]=$J[$h+0],this.elements[1]=$J[$h+1];},$h.cloneTo=function($J){var $h=$J.elements,$f=this.elements;$h[0]=$f[0],$h[1]=$f[1];},$h.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$h,"x",function(){return this.elements[0];},function($J){this.elements[0]=$J;}),$i(0,$h,"y",function(){return this.elements[1];},function($J){this.elements[1]=$J;}),$J.scale=function($J,$h,$f){var $n=$f.elements,$L=$J.elements;$n[0]=$L[0]*$h,$n[1]=$L[1]*$h;},$j($J,["ZERO",function(){return this.ZERO=new $J(0,0);},"ONE",function(){return this.ONE=new $J(1,1);}]),$J;}(),$kh=function(){function $x($J,$h,$f){this.elements=new Float32Array(3),void 0===$J&&($J=0),void 0===$h&&($h=0),void 0===$f&&($f=0);var $n=this.elements;$n[0]=$J,$n[1]=$h,$n[2]=$f;}$l($x,"laya.d3.math.Vector3");var $J=$x.prototype;return $p.imps($J,{"laya.d3.core.IClone":!0}),$J.fromArray=function($J,$h){void 0===$h&&($h=0),this.elements[0]=$J[$h+0],this.elements[1]=$J[$h+1],this.elements[2]=$J[$h+2];},$J.cloneTo=function($J){var $h=$J.elements,$f=this.elements;$h[0]=$f[0],$h[1]=$f[1],$h[2]=$f[2];},$J.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$J.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0;},$J.reset=function($J,$h,$f){this.elements[0]=$J,this.elements[1]=$h,this.elements[2]=$f;},$i(0,$J,"x",function(){return this.elements[0];},function($J){this.elements[0]=$J;}),$i(0,$J,"y",function(){return this.elements[1];},function($J){this.elements[1]=$J;}),$i(0,$J,"z",function(){return this.elements[2];},function($J){this.elements[2]=$J;}),$x.distanceSquared=function($J,$h){var $f=$J.elements,$n=$h.elements,$L=$f[0]-$n[0],$T=$f[1]-$n[1],$k=$f[2]-$n[2];return $L*$L+$T*$T+$k*$k;},$x.distance=function($J,$h){var $f=$J.elements,$n=$h.elements,$L=$f[0]-$n[0],$T=$f[1]-$n[1],$k=$f[2]-$n[2];return Math.sqrt($L*$L+$T*$T+$k*$k);},$x.min=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements;$n[0]=Math.min($L[0],$T[0]),$n[1]=Math.min($L[1],$T[1]),$n[2]=Math.min($L[2],$T[2]);},$x.max=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements;$n[0]=Math.max($L[0],$T[0]),$n[1]=Math.max($L[1],$T[1]),$n[2]=Math.max($L[2],$T[2]);},$x.transformQuat=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements,$k=$L[0],$u=$L[1],$S=$L[2],$Y=$T[0],$x=$T[1],$j=$T[2],$R=$T[3],$l=$R*$k+$x*$S-$j*$u,$i=$R*$u+$j*$k-$Y*$S,$q=$R*$S+$Y*$u-$x*$k,$o=-$Y*$k-$x*$u-$j*$S;$n[0]=$l*$R+$o*-$Y+$i*-$j-$q*-$x,$n[1]=$i*$R+$o*-$x+$q*-$Y-$l*-$j,$n[2]=$q*$R+$o*-$j+$l*-$x-$i*-$Y;},$x.scalarLength=function($J){var $h=$J.elements,$f=$h[0],$n=$h[1],$L=$h[2];return Math.sqrt($f*$f+$n*$n+$L*$L);},$x.scalarLengthSquared=function($J){var $h=$J.elements,$f=$h[0],$n=$h[1],$L=$h[2];return $f*$f+$n*$n+$L*$L;},$x.normalize=function($J,$h){var $f=$J.elements,$n=$h.elements,$L=$f[0],$T=$f[1],$k=$f[2],$u=$L*$L+$T*$T+$k*$k;0<$u&&($u=1/Math.sqrt($u),$n[0]=$f[0]*$u,$n[1]=$f[1]*$u,$n[2]=$f[2]*$u);},$x.multiply=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements;$n[0]=$L[0]*$T[0],$n[1]=$L[1]*$T[1],$n[2]=$L[2]*$T[2];},$x.scale=function($J,$h,$f){var $n=$f.elements,$L=$J.elements;$n[0]=$L[0]*$h,$n[1]=$L[1]*$h,$n[2]=$L[2]*$h;},$x.lerp=function($J,$h,$f,$n){var $L=$n.elements,$T=$J.elements,$k=$h.elements,$u=$T[0],$S=$T[1],$Y=$T[2];$L[0]=$u+$f*($k[0]-$u),$L[1]=$S+$f*($k[1]-$S),$L[2]=$Y+$f*($k[2]-$Y);},$x.transformV3ToV3=function($J,$h,$f){var $n=$x._tempVector4;$x.transformV3ToV4($J,$h,$n);var $L=$n.elements,$T=$f.elements;$T[0]=$L[0],$T[1]=$L[1],$T[2]=$L[2];},$x.transformV3ToV4=function($J,$h,$f){var $n=$J.elements,$L=$n[0],$T=$n[1],$k=$n[2],$u=$h.elements,$S=$f.elements;$S[0]=$L*$u[0]+$T*$u[4]+$k*$u[8]+$u[12],$S[1]=$L*$u[1]+$T*$u[5]+$k*$u[9]+$u[13],$S[2]=$L*$u[2]+$T*$u[6]+$k*$u[10]+$u[14],$S[3]=$L*$u[3]+$T*$u[7]+$k*$u[11]+$u[15];},$x.TransformNormal=function($J,$h,$f){var $n=$J.elements,$L=$n[0],$T=$n[1],$k=$n[2],$u=$h.elements,$S=$f.elements;$S[0]=$L*$u[0]+$T*$u[4]+$k*$u[8],$S[1]=$L*$u[1]+$T*$u[5]+$k*$u[9],$S[2]=$L*$u[2]+$T*$u[6]+$k*$u[10];},$x.transformCoordinate=function($J,$h,$f){var $n=$x._tempVector4.elements,$L=$J.elements,$T=$L[0],$k=$L[1],$u=$L[2],$S=$h.elements;$n[0]=$T*$S[0]+$k*$S[4]+$u*$S[8]+$S[12],$n[1]=$T*$S[1]+$k*$S[5]+$u*$S[9]+$S[13],$n[2]=$T*$S[2]+$k*$S[6]+$u*$S[10]+$S[14],$n[3]=1/($T*$S[3]+$k*$S[7]+$u*$S[11]+$S[15]);var $Y=$f.elements;$Y[0]=$n[0]*$n[3],$Y[1]=$n[1]*$n[3],$Y[2]=$n[2]*$n[3];},$x.Clamp=function($J,$h,$f,$n){var $L=$J.elements,$T=$L[0],$k=$L[1],$u=$L[2],$S=$h.elements,$Y=$S[0],$x=$S[1],$j=$S[2],$R=$f.elements,$l=$R[0],$i=$R[1],$q=$R[2],$o=$n.elements;$T=($T=$l<$T?$l:$T)<$Y?$Y:$T,$k=($k=$i<$k?$i:$k)<$x?$x:$k,$u=($u=$q<$u?$q:$u)<$j?$j:$u,$o[0]=$T,$o[1]=$k,$o[2]=$u;},$x.add=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements;$n[0]=$L[0]+$T[0],$n[1]=$L[1]+$T[1],$n[2]=$L[2]+$T[2];},$x.subtract=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements;$n[0]=$L[0]-$T[0],$n[1]=$L[1]-$T[1],$n[2]=$L[2]-$T[2];},$x.cross=function($J,$h,$f){var $n=$J.elements,$L=$h.elements,$T=$f.elements,$k=$n[0],$u=$n[1],$S=$n[2],$Y=$L[0],$x=$L[1],$j=$L[2];$T[0]=$u*$j-$S*$x,$T[1]=$S*$Y-$k*$j,$T[2]=$k*$x-$u*$Y;},$x.dot=function($J,$h){var $f=$J.elements,$n=$h.elements;return $f[0]*$n[0]+$f[1]*$n[1]+$f[2]*$n[2];},$x.equals=function($J,$h){var $f=$J.elements,$n=$h.elements;return $zJ.nearEqual(Math.abs($f[0]),Math.abs($n[0]))&&$zJ.nearEqual(Math.abs($f[1]),Math.abs($n[1]))&&$zJ.nearEqual(Math.abs($f[2]),Math.abs($n[2]));},$x.ZERO=new $x(0,0,0),$x.ONE=new $x(1,1,1),$x.NegativeUnitX=new $x(-1,0,0),$x.UnitX=new $x(1,0,0),$x.UnitY=new $x(0,1,0),$x.UnitZ=new $x(0,0,1),$x.ForwardRH=new $x(0,0,-1),$x.ForwardLH=new $x(0,0,1),$x.Up=new $x(0,1,0),$x.NAN=new $x(NaN,NaN,NaN),$j($x,["_tempVector4",function(){return this._tempVector4=new $uh();}]),$x;}(),$uh=function(){function $J($J,$h,$f,$n){this.elements=new Float32Array(4),void 0===$J&&($J=0),void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=0);var $L=this.elements;$L[0]=$J,$L[1]=$h,$L[2]=$f,$L[3]=$n;}$l($J,"laya.d3.math.Vector4");var $h=$J.prototype;return $p.imps($h,{"laya.d3.core.IClone":!0}),$h.fromArray=function($J,$h){void 0===$h&&($h=0),this.elements[0]=$J[$h+0],this.elements[1]=$J[$h+1],this.elements[2]=$J[$h+2],this.elements[3]=$J[$h+3];},$h.cloneTo=function($J){var $h=$J.elements,$f=this.elements;$h[0]=$f[0],$h[1]=$f[1],$h[2]=$f[2],$h[3]=$f[3];},$h.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$h.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);},$h.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w;},$i(0,$h,"x",function(){return this.elements[0];},function($J){this.elements[0]=$J;}),$i(0,$h,"y",function(){return this.elements[1];},function($J){this.elements[1]=$J;}),$i(0,$h,"z",function(){return this.elements[2];},function($J){this.elements[2]=$J;}),$i(0,$h,"w",function(){return this.elements[3];},function($J){this.elements[3]=$J;}),$J.lerp=function($J,$h,$f,$n){var $L=$n.elements,$T=$J.elements,$k=$h.elements,$u=$T[0],$S=$T[1],$Y=$T[2],$x=$T[3];$L[0]=$u+$f*($k[0]-$u),$L[1]=$S+$f*($k[1]-$S),$L[2]=$Y+$f*($k[2]-$Y),$L[3]=$x+$f*($k[3]-$x);},$J.transformByM4x4=function($J,$h,$f){var $n=$J.elements,$L=$n[0],$T=$n[1],$k=$n[2],$u=$n[3],$S=$h.elements,$Y=$f.elements;$Y[0]=$L*$S[0]+$T*$S[4]+$k*$S[8]+$u*$S[12],$Y[1]=$L*$S[1]+$T*$S[5]+$k*$S[9]+$u*$S[13],$Y[2]=$L*$S[2]+$T*$S[6]+$k*$S[10]+$u*$S[14],$Y[3]=$L*$S[3]+$T*$S[7]+$k*$S[11]+$u*$S[15];},$J.equals=function($J,$h){var $f=$J.elements,$n=$h.elements;return $zJ.nearEqual(Math.abs($f[0]),Math.abs($n[0]))&&$zJ.nearEqual(Math.abs($f[1]),Math.abs($n[1]))&&$zJ.nearEqual(Math.abs($f[2]),Math.abs($n[2]))&&$zJ.nearEqual(Math.abs($f[3]),Math.abs($n[3]));},$J.normalize=function($J,$h){var $f=$J.elements,$n=$h.elements,$L=$J.length();0<$L&&($n[0]=$f[0]*$L,$n[1]=$f[1]*$L,$n[2]=$f[2]*$L,$n[3]=$f[3]*$L);},$J.add=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements;$n[0]=$L[0]+$T[0],$n[1]=$L[1]+$T[1],$n[2]=$L[2]+$T[2],$n[3]=$L[3]+$T[3];},$J.subtract=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements;$n[0]=$L[0]-$T[0],$n[1]=$L[1]-$T[1],$n[2]=$L[2]-$T[2],$n[3]=$L[3]-$T[3];},$J.multiply=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements;$n[0]=$L[0]*$T[0],$n[1]=$L[1]*$T[1],$n[2]=$L[2]*$T[2],$n[3]=$L[3]*$T[3];},$J.scale=function($J,$h,$f){var $n=$f.elements,$L=$J.elements;$n[0]=$L[0]*$h,$n[1]=$L[1]*$h,$n[2]=$L[2]*$h,$n[3]=$L[3]*$h;},$J.Clamp=function($J,$h,$f,$n){var $L=$J.elements,$T=$L[0],$k=$L[1],$u=$L[2],$S=$L[3],$Y=$h.elements,$x=$Y[0],$j=$Y[1],$R=$Y[2],$l=$Y[3],$i=$f.elements,$q=$i[0],$o=$i[1],$r=$i[2],$_=$i[3],$s=$n.elements;$T=($T=$q<$T?$q:$T)<$x?$x:$T,$k=($k=$o<$k?$o:$k)<$j?$j:$k,$u=($u=$r<$u?$r:$u)<$R?$R:$u,$S=($S=$_<$S?$_:$S)<$l?$l:$S,$s[0]=$T,$s[1]=$k,$s[2]=$u,$s[3]=$S;},$J.distanceSquared=function($J,$h){var $f=$J.elements,$n=$h.elements,$L=$f[0]-$n[0],$T=$f[1]-$n[1],$k=$f[2]-$n[2],$u=$f[3]-$n[3];return $L*$L+$T*$T+$k*$k+$u*$u;},$J.distance=function($J,$h){var $f=$J.elements,$n=$h.elements,$L=$f[0]-$n[0],$T=$f[1]-$n[1],$k=$f[2]-$n[2],$u=$f[3]-$n[3];return Math.sqrt($L*$L+$T*$T+$k*$k+$u*$u);},$J.dot=function($J,$h){var $f=$J.elements,$n=$h.elements;return $f[0]*$n[0]+$f[1]*$n[1]+$f[2]*$n[2]+$f[3]*$n[3];},$J.min=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements;$n[0]=Math.min($L[0],$T[0]),$n[1]=Math.min($L[1],$T[1]),$n[2]=Math.min($L[2],$T[2]),$n[3]=Math.min($L[3],$T[3]);},$J.max=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h.elements;$n[0]=Math.max($L[0],$T[0]),$n[1]=Math.max($L[1],$T[1]),$n[2]=Math.max($L[2],$T[2]),$n[3]=Math.max($L[3],$T[3]);},$j($J,["ZERO",function(){return this.ZERO=new $J();},"ONE",function(){return this.ONE=new $J(1,1,1,1);},"UnitX",function(){return this.UnitX=new $J(1,0,0,0);},"UnitY",function(){return this.UnitY=new $J(0,1,0,0);},"UnitZ",function(){return this.UnitZ=new $J(0,0,1,0);},"UnitW",function(){return this.UnitW=new $J(0,0,0,1);}]),$J;}(),$Sh=function(){function $T($J,$h,$f,$n){this.minDepth=0,this.maxDepth=1,this.x=$J,this.y=$h,this.width=$f,this.height=$n;}$l($T,"laya.d3.math.Viewport");var $J=$T.prototype;return $J.project=function($J,$h,$f){$kh.transformV3ToV3($J,$h,$f);var $n=$J.elements,$L=$h.elements,$T=$f.elements,$k=$n[0]*$L[3]+$n[1]*$L[7]+$n[2]*$L[11]+$L[15];1!==$k&&($T[0]=$T[0]/$k,$T[1]=$T[1]/$k,$T[2]=$T[2]/$k),$T[0]=.5*($T[0]+1)*this.width+this.x,$T[1]=.5*(1-$T[1])*this.height+this.y,$T[2]=$T[2]*(this.maxDepth-this.minDepth)+this.minDepth;},$J.unprojectFromMat=function($J,$h,$f){var $n=$J.elements,$L=$h.elements,$T=$f.elements;$T[0]=($n[0]-this.x)/this.width*2-1,$T[1]=-(($n[1]-this.y)/this.height*2-1);var $k=(this.maxDepth-this.minDepth)/2;$T[2]=($n[2]-this.minDepth-$k)/$k;var $u=$T[0]*$L[3]+$T[1]*$L[7]+$T[2]*$L[11]+$L[15];$kh.transformV3ToV3($f,$h,$f),1!==$u&&($T[0]=$T[0]/$u,$T[1]=$T[1]/$u,$T[2]=$T[2]/$u);},$J.unprojectFromWVP=function($J,$h,$f,$n,$L){$Jh.multiply($h,$f,$T._tempMatrix4x4),$n&&$Jh.multiply($T._tempMatrix4x4,$n,$T._tempMatrix4x4),$T._tempMatrix4x4.invert($T._tempMatrix4x4),this.unprojectFromMat($J,$T._tempMatrix4x4,$L);},$j($T,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $Jh();}]),$T;}(),$Yh=function(){function $G($J){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=$J,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[];}$l($G,"laya.d3.resource.models.SubMesh");var $J=$G.prototype;return $p.imps($J,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$J._getVertexBuffer=function($J){return void 0===$J&&($J=0),0===$J?this._vertexBuffer:null;},$J._getIndexBuffer=function(){return this._indexBuffer;},$J._getStaticBatchBakedVertexs=function($J,$h){var $f,$n,$L=this._vertexBuffer,$T=$L.vertexDeclaration,$k=$T.getVertexElementByUsage(0).offset/4,$u=$T.getVertexElementByUsage(3).offset/4,$S=$h.meshRender.lightmapScaleOffset,$Y=0,$x=0,$j=0,$R=0,$l=0,$i=0;if($S){if($n=$T.getVertexElementByUsage(15))$j=$T.vertexStride/4,$f=0<this._vertexCount?$L.getData().slice(this._vertexStart*$j,(this._vertexStart+this._vertexCount)*$j):$L.getData().slice(),$R=$n.offset/4;else{$j=($i=$T.vertexStride/4)+2,$f=this._vertexCount?new Float32Array(this._vertexCount*($L.vertexDeclaration.vertexStride/4+2)):new Float32Array($L.vertexCount*($L.vertexDeclaration.vertexStride/4+2)),$R=($l=$T.getVertexElementByUsage(2).offset/4)+2;var $q=$L.getData();for($Y=0,$x=$q.length/$i;$Y<$x;$Y++){var $o=0;$o=0<this._vertexCount?(this._vertexStart+$Y)*$i:$Y*$i;var $r=$Y*$j,$_=0;for($_=0;$_<$R;$_++)$f[$r+$_]=$q[$o+$_];for($_=$R;$_<$i;$_++)$f[$r+$_+2]=$q[$o+$_];}}}else $j=$T.vertexStride/4,$f=this._vertexCount?$L.getData().slice(this._vertexStart*$j,(this._vertexStart+this._vertexCount)*$j):$L.getData().slice();if($J){var $s=$J.worldMatrix,$d=$G._tempMatrix4x40;$s.invert($d);var $p=$G._tempMatrix4x41,$U=$h.transform.worldMatrix;$Jh.multiply($d,$U,$p);}else $p=$h.transform.worldMatrix;var $Q=$G._tempQuaternion0;for($p.decomposeTransRotScale($G._tempVector30,$Q,$G._tempVector31),$Y=0,$x=$f.length/$j;$Y<$x;$Y++){var $D=$Y*$j+$k,$g=$Y*$j+$u;if($oh.transformVector3ArrayToVector3ArrayCoordinate($f,$D,$p,$f,$D),$oh.transformVector3ArrayByQuat($f,$g,$Q,$f,$g),$S){var $F=$Y*$j+$R;if($n)$oh.transformLightingMapTexcoordByUV1Array($f,$F,$S,$f,$F);else{var $A=$Y*$i+$l;$oh.transformLightingMapTexcoordByUV0Array($q,$A,$S,$f,$F);}}}return $f;},$J._getVertexBuffers=function(){return null;},$J._beforeRender=function($J){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0;},$J._render=function($J){var $h,$f=0,$n=$J.renderElement;if(1<this._indexCount){var $L=this._boneIndicesList.length;if(1<$L){for(var $T=0;$T<$L;$T++)($h=$n._skinAnimationDatas||this._skinAnimationDatas)&&($n._shaderValue.setValue(0,$h[$T]),$J._shader.uploadRenderElementUniforms($n._shaderValue.data)),$y.mainContext.drawElements(4,this._subIndexBufferCount[$T],5123,2*this._subIndexBufferStart[$T]);$D.drawCall+=$L;}else($h=$n._skinAnimationDatas||this._skinAnimationDatas)&&($n._shaderValue.setValue(0,$h[0]),$J._shader.uploadRenderElementUniforms($n._shaderValue.data)),$y.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),$D.drawCall++;$f=this._indexCount;}else $f=this._indexBuffer.indexCount,($h=$n._skinAnimationDatas||this._skinAnimationDatas)&&($n._shaderValue.setValue(0,$h[0]),$J._shader.uploadRenderElementUniforms($n._shaderValue.data)),$y.mainContext.drawElements(4,$f,5123,0),$D.drawCall++;$D.trianglesFaces+=$f/3;},$J.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData();},$J.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null;},$i(0,$J,"_vertexBufferCount",function(){return 1;}),$i(0,$J,"triangleCount",function(){return this._indexBuffer.indexCount/3;}),$j($G,["_tempVector30",function(){return this._tempVector30=new $kh();},"_tempVector31",function(){return this._tempVector31=new $kh();},"_tempQuaternion0",function(){return this._tempQuaternion0=new $fh();},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new $Jh();},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new $Jh();}]),$G;}(),$xh=function(){function $J($J){this.defineCounter=0,this.defines=null,$J?(this.defineCounter=$J.defineCounter,this.defines=$J.defines.slice()):(this.defineCounter=0,this.defines=[]);}return $l($J,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),$J.prototype.registerDefine=function($J){var $h=Math.pow(2,this.defineCounter++);return this.defines[$h]=$J,$h;},$J;}(),$jh=function(){function $J(){}return $l($J,"laya.d3.shader.ShaderInit3D"),$J.__init__=function(){var $J,$h;$Dh._globalRegDefine("HIGHPRECISION",$Dh.SHADERDEFINE_HIGHPRECISION),$Dh._globalRegDefine("FOG",$Dh.SHADERDEFINE_FOG),$Dh._globalRegDefine("DIRECTIONLIGHT",$Dh.SHADERDEFINE_DIRECTIONLIGHT),$Dh._globalRegDefine("POINTLIGHT",$Dh.SHADERDEFINE_POINTLIGHT),$Dh._globalRegDefine("SPOTLIGHT",$Dh.SHADERDEFINE_SPOTLIGHT),$Dh._globalRegDefine("UV",$Dh.SHADERDEFINE_UV0),$Dh._globalRegDefine("COLOR",$Dh.SHADERDEFINE_COLOR),$Dh._globalRegDefine("UV1",$Dh.SHADERDEFINE_UV1),$Dh._globalRegDefine("CASTSHADOW",$lh.SHADERDEFINE_CAST_SHADOW),$Dh._globalRegDefine("SHADOWMAP_PSSM1",$lh.SHADERDEFINE_SHADOW_PSSM1),$Dh._globalRegDefine("SHADOWMAP_PSSM2",$lh.SHADERDEFINE_SHADOW_PSSM2),$Dh._globalRegDefine("SHADOWMAP_PSSM3",$lh.SHADERDEFINE_SHADOW_PSSM3),$Dh._globalRegDefine("SHADOWMAP_PCF_NO",$lh.SHADERDEFINE_SHADOW_PCF_NO),$Dh._globalRegDefine("SHADOWMAP_PCF1",$lh.SHADERDEFINE_SHADOW_PCF1),$Dh._globalRegDefine("SHADOWMAP_PCF2",$lh.SHADERDEFINE_SHADOW_PCF2),$Dh._globalRegDefine("SHADOWMAP_PCF3",$lh.SHADERDEFINE_SHADOW_PCF3),$Dh._globalRegDefine("DEPTHFOG",$Dh.SAHDERDEFINE_DEPTHFOG),$Zh.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),$Zh.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),$J={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},$h={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var $f=$Zh.nameKey.add("SIMPLE");shaderCompile=$Dh.add($f,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',$J,$h),$th.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),$th.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),$th.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),$th.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),$th.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),$th.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),$th.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),$th.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),$th.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG");},$J;}(),$Rh=function(){function $J(){this._data=null,this._data=[];}$l($J,"laya.d3.shader.ValusArray");var $h=$J.prototype;return $h.setValue=function($J,$h){this._data[$J]=$h;},$i(0,$h,"data",function(){return this._data;}),$J;}(),$lh=function(){function $J(){}return $J.SHADERDEFINE_RECEIVE_SHADOW=1,$J.SHADERDEFINE_CAST_SHADOW=512,$J.SHADERDEFINE_SHADOW_PSSM1=1024,$J.SHADERDEFINE_SHADOW_PSSM2=2048,$J.SHADERDEFINE_SHADOW_PSSM3=4096,$J.SHADERDEFINE_SHADOW_PCF_NO=8192,$J.SHADERDEFINE_SHADOW_PCF1=16384,$J.SHADERDEFINE_SHADOW_PCF2=32768,$J.SHADERDEFINE_SHADOW_PCF3=65536,$J.MAX_PSSM_COUNT=3,$J;}(),$ih=function(){function $M(){}return $l($M,"laya.d3.utils.Picker"),$M.calculateCursorRay=function($J,$h,$f,$n,$L,$T){var $k=$J.elements[0],$u=$J.elements[1],$S=$M._tempVector30,$Y=$S.elements;$Y[0]=$k,$Y[1]=$u,$Y[2]=$h.minDepth;var $x=$M._tempVector31,$j=$x.elements;$j[0]=$k,$j[1]=$u,$j[2]=$h.maxDepth;var $R=$T.origin,$l=$M._tempVector32;$h.unprojectFromWVP($S,$f,$n,$L,$R),$h.unprojectFromWVP($x,$f,$n,$L,$l);var $i=$T.direction.elements;$i[0]=$l.x-$R.x,$i[1]=$l.y-$R.y,$i[2]=$l.z-$R.z,$kh.normalize($T.direction,$T.direction);},$M.rayIntersectsPositionsAndIndices=function($J,$h,$f,$n,$L){for(var $T=$f.vertexStride/4,$k=$f.getVertexElementByUsage(0).offset/4,$u=Number.MAX_VALUE,$S=-1,$Y=-1,$x=-1,$j=0;$j<$n.length;$j+=3){var $R=$M._tempVector35,$l=$R.elements,$i=$n[$j]*$T,$q=$i+$k;$l[0]=$h[$q],$l[1]=$h[1+$q],$l[2]=$h[2+$q];var $o=$M._tempVector36,$r=$o.elements,$_=$n[$j+1]*$T,$s=$_+$k;$r[0]=$h[$s],$r[1]=$h[1+$s],$r[2]=$h[2+$s];var $d=$M._tempVector37,$p=$d.elements,$U=$n[$j+2]*$T,$Q=$U+$k;$p[0]=$h[$Q],$p[1]=$h[1+$Q],$p[2]=$h[2+$Q];var $D=laya.d3.utils.Picker.rayIntersectsTriangle($J,$R,$o,$d);!isNaN($D)&&$D<$u&&($u=$D,$S=$i,$Y=$_,$x=$U);}if($u===Number.MAX_VALUE)return $L.position.toDefault(),$L.distance=Number.MAX_VALUE,$L.trianglePositions[0].toDefault(),$L.trianglePositions[1].toDefault(),$L.trianglePositions[2].toDefault(),$L.triangleNormals[0].toDefault(),$L.triangleNormals[1].toDefault(),$L.triangleNormals[2].toDefault(),!1;$L.distance=$u,$kh.scale($J.direction,$u,$L.position),$kh.add($J.origin,$L.position,$L.position);var $g=$L.trianglePositions,$F=$g[0],$A=$g[1],$G=$g[2],$y=$F.elements,$O=$A.elements,$P=$G.elements,$W=$S+$k;$y[0]=$h[$W],$y[1]=$h[$W+1],$y[2]=$h[$W+2];var $I=$Y+$k;$O[0]=$h[$I],$O[1]=$h[$I+1],$O[2]=$h[$I+2];var $m=$x+$k;$P[0]=$h[$m],$P[1]=$h[$m+1],$P[2]=$h[$m+2];var $Z=$f.getVertexElementByUsage(3);if($Z){var $t=$Z.offset/4,$c=$L.triangleNormals,$a=$c[0],$B=$c[1],$V=$c[2],$C=$a.elements,$e=$B.elements,$H=$V.elements,$b=$S+$t;$C[0]=$h[$b],$C[1]=$h[$b+1],$C[2]=$h[$b+2];var $v=$Y+$t;$e[0]=$h[$v],$e[1]=$h[$v+1],$e[2]=$h[$v+2];var $$=$x+$t;$H[0]=$h[$$],$H[1]=$h[$$+1],$H[2]=$h[$$+2];}return!0;},$M.rayIntersectsTriangle=function($J,$h,$f,$n){var $L=$M._tempVector30,$T=$M._tempVector31;$kh.subtract($f,$h,$L),$kh.subtract($n,$h,$T);var $k,$u=$M._tempVector32;if($kh.cross($J.direction,$T,$u),($k=$kh.dot($L,$u))>-Number.MIN_VALUE&&$k<Number.MIN_VALUE)return Number.NaN;var $S,$Y=1/$k,$x=$M._tempVector33;if($kh.subtract($J.origin,$h,$x),$S=$kh.dot($x,$u),($S*=$Y)<0||1<$S)return Number.NaN;var $j,$R,$l=$M._tempVector34;return $kh.cross($x,$L,$l),$j=$kh.dot($J.direction,$l),($j*=$Y)<0||1<$S+$j?Number.NaN:($R=$kh.dot($T,$l),($R*=$Y)<0?Number.NaN:$R);},$j($M,["_tempVector30",function(){return this._tempVector30=new $kh();},"_tempVector31",function(){return this._tempVector31=new $kh();},"_tempVector32",function(){return this._tempVector32=new $kh();},"_tempVector33",function(){return this._tempVector33=new $kh();},"_tempVector34",function(){return this._tempVector34=new $kh();},"_tempVector35",function(){return this._tempVector35=new $kh();},"_tempVector36",function(){return this._tempVector36=new $kh();},"_tempVector37",function(){return this._tempVector37=new $kh();}]),$M;}(),$qh=(function(){function $J(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new $kh(),new $kh(),new $kh()],this.trianglePositions.length=3,this.triangleNormals=[new $kh(),new $kh(),new $kh()],this.triangleNormals.length=3,this.position=new $kh();}$l($J,"laya.d3.utils.RaycastHit"),$J.prototype.cloneTo=function($J){$J.distance=this.distance,this.trianglePositions[0].cloneTo($J.trianglePositions[0]),this.trianglePositions[1].cloneTo($J.trianglePositions[1]),this.trianglePositions[2].cloneTo($J.trianglePositions[2]),this.triangleNormals[0].cloneTo($J.triangleNormals[0]),this.triangleNormals[1].cloneTo($J.triangleNormals[1]),this.triangleNormals[2].cloneTo($J.triangleNormals[2]),this.position.cloneTo($J.position),$J.sprite3D=this.sprite3D;};}(),function(){function $J($J,$h){this._width=0,this._height=0,this._width=$J,this._height=$h;}$l($J,"laya.d3.utils.Size");var $h=$J.prototype;return $i(0,$h,"width",function(){return-1===this._width?$X.clientWidth:this._width;}),$i(0,$h,"height",function(){return-1===this._height?$X.clientHeight:this._height;}),$i(1,$J,"fullScreen",function(){return new $J(-1,-1);}),$J;}()),$oh=function(){function $W(){}return $l($W,"laya.d3.utils.Utils3D"),$W._rotationTransformScaleSkinAnimation=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$j){var $R,$l,$i,$q,$o,$r=$W._tempArray16_0,$_=$W._tempArray16_1,$s=$W._tempArray16_2,$d=$n+$n,$p=$L+$L,$U=$T+$T,$Q=$n*$d,$D=$L*$d,$g=$L*$p,$F=$T*$d,$A=$T*$p,$G=$T*$U,$y=$k*$d,$O=$k*$p,$P=$k*$U;for($r[15]=1,$r[0]=1-$g-$G,$r[1]=$D+$P,$r[2]=$F-$O,$r[4]=$D-$P,$r[5]=1-$Q-$G,$r[6]=$A+$y,$r[8]=$F+$O,$r[9]=$A-$y,$r[10]=1-$Q-$g,$_[15]=1,$_[0]=$u,$_[5]=$S,$_[10]=$Y,$R=0;$R<4;$R++)$l=$r[$R],$i=$r[$R+4],$q=$r[$R+8],$o=$r[$R+12],$s[$R]=$l,$s[$R+4]=$i,$s[$R+8]=$q,$s[$R+12]=$l*$J+$i*$h+$q*$f+$o;for($R=0;$R<4;$R++)$l=$s[$R],$i=$s[$R+4],$q=$s[$R+8],$o=$s[$R+12],$x[$R+$j]=$l*$_[0]+$i*$_[1]+$q*$_[2]+$o*$_[3],$x[$R+$j+4]=$l*$_[4]+$i*$_[5]+$q*$_[6]+$o*$_[7],$x[$R+$j+8]=$l*$_[8]+$i*$_[9]+$q*$_[10]+$o*$_[11],$x[$R+$j+12]=$l*$_[12]+$i*$_[13]+$q*$_[14]+$o*$_[15];},$W._createNodeByJson=function($J,$h,$f,$n){if(!$f)switch($h.type){case"Sprite3D":$f=new $mh();break;case"MeshSprite3D":$f=new $Mh();break;case"SkinnedMeshSprite3D":$f=new SkinnedMeshSprite3D();break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":$f=new ShuriKenParticle3D();break;case"TrailSprite3D":$f=new TrailSprite3D();break;case"Terrain":$f=new Terrain();break;case"Camera":$f=new $$h();break;case"DirectionLight":$f=new DirectionLight();break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.");}var $L=$h.props;if($L)for(var $T in $L)$f[$T]=$L[$T];var $k=$h.customProps;$k&&($f instanceof laya.d3.core.Sprite3D?($f._parseBaseCustomProps($k),$f._parseCustomProps($J,$n,$k,$h),$f._parseCustomComponent($J,$n,$h.components)):$f._parseCustomProps($J,$n,$k,$h));var $u=$h.child;if($u)for(var $S=0,$Y=$u.length;$S<$Y;$S++){var $x=$W._createNodeByJson($J,$u[$S],null,$n);$f.addChild($x);}return $f;},$W._computeBoneAndAnimationDatasByBindPoseMatrxix=function($J,$h,$f,$n,$L,$T){var $k,$u,$S=0,$Y=0,$x=$J.length;for($k=0;$k<$x;$S+=$J[$k].keyframeWidth,$Y+=16,$k++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($h[$S+0],$h[$S+1],$h[$S+2],$h[$S+3],$h[$S+4],$h[$S+5],$h[$S+6],$h[$S+7],$h[$S+8],$h[$S+9],$n,$Y),0!=$k&&($u=16*$J[$k].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($n,$u,$n,$Y,$n,$Y));var $j=$f.length;for($k=0;$k<$j;$k++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($n,16*$T[$k],$f[$k],$L,16*$k);},$W._computeAnimationDatasByArrayAndMatrixFast=function($J,$h,$f,$n){for(var $L=0,$T=$J.length;$L<$T;$L++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($h,16*$n[$L],$J[$L],$f,16*$L);},$W._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function($J,$h,$f,$n,$L){var $T,$k,$u=0,$S=0,$Y=$J.length;for($T=0;$T<$Y;$u+=$J[$T].keyframeWidth,$S+=16,$T++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($h[$u+7],$h[$u+8],$h[$u+9],$h[$u+3],$h[$u+4],$h[$u+5],$h[$u+6],$h[$u+0],$h[$u+1],$h[$u+2],$n,$S),0!=$T&&($k=16*$J[$T].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($n,$k,$n,$S,$n,$S));var $x=$f.length;for($T=0;$T<$x;$T++){var $j=16*$T;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($n,$j,$f[$T],$L,$j);}},$W._computeAnimationDatasByArrayAndMatrixFastOld=function($J,$h,$f){for(var $n=$J.length,$L=0;$L<$n;$L++){var $T=16*$L;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($h,$T,$J[$L],$f,$T);}},$W._computeRootAnimationData=function($J,$h,$f){for(var $n=0,$L=0,$T=0,$k=$J.length;$n<$k;$L+=$J[$n].keyframeWidth,$T+=16,$n++)laya.d3.utils.Utils3D.createAffineTransformationArray($h[$L+0],$h[$L+1],$h[$L+2],$h[$L+3],$h[$L+4],$h[$L+5],$h[$L+6],$h[$L+7],$h[$L+8],$h[$L+9],$f,$T);},$W.transformVector3ArrayByQuat=function($J,$h,$f,$n,$L){var $T=$f.elements,$k=$J[$h],$u=$J[$h+1],$S=$J[$h+2],$Y=$T[0],$x=$T[1],$j=$T[2],$R=$T[3],$l=$R*$k+$x*$S-$j*$u,$i=$R*$u+$j*$k-$Y*$S,$q=$R*$S+$Y*$u-$x*$k,$o=-$Y*$k-$x*$u-$j*$S;$n[$L]=$l*$R+$o*-$Y+$i*-$j-$q*-$x,$n[$L+1]=$i*$R+$o*-$x+$q*-$Y-$l*-$j,$n[$L+2]=$q*$R+$o*-$j+$l*-$x-$i*-$Y;},$W.mulMatrixByArray=function($J,$h,$f,$n,$L,$T){var $k,$u,$S,$Y,$x;if($L===$f){for($f=$W._tempArray16_3,$k=0;$k<16;++$k)$f[$k]=$L[$T+$k];$n=0;}for($k=0;$k<4;$k++)$u=$J[$h+$k],$S=$J[$h+$k+4],$Y=$J[$h+$k+8],$x=$J[$h+$k+12],$L[$T+$k]=$u*$f[$n+0]+$S*$f[$n+1]+$Y*$f[$n+2]+$x*$f[$n+3],$L[$T+$k+4]=$u*$f[$n+4]+$S*$f[$n+5]+$Y*$f[$n+6]+$x*$f[$n+7],$L[$T+$k+8]=$u*$f[$n+8]+$S*$f[$n+9]+$Y*$f[$n+10]+$x*$f[$n+11],$L[$T+$k+12]=$u*$f[$n+12]+$S*$f[$n+13]+$Y*$f[$n+14]+$x*$f[$n+15];},$W.mulMatrixByArrayFast=function($J,$h,$f,$n,$L,$T){var $k,$u,$S,$Y,$x;for($k=0;$k<4;$k++)$u=$J[$h+$k],$S=$J[$h+$k+4],$Y=$J[$h+$k+8],$x=$J[$h+$k+12],$L[$T+$k]=$u*$f[$n+0]+$S*$f[$n+1]+$Y*$f[$n+2]+$x*$f[$n+3],$L[$T+$k+4]=$u*$f[$n+4]+$S*$f[$n+5]+$Y*$f[$n+6]+$x*$f[$n+7],$L[$T+$k+8]=$u*$f[$n+8]+$S*$f[$n+9]+$Y*$f[$n+10]+$x*$f[$n+11],$L[$T+$k+12]=$u*$f[$n+12]+$S*$f[$n+13]+$Y*$f[$n+14]+$x*$f[$n+15];},$W.mulMatrixByArrayAndMatrixFast=function($J,$h,$f,$n,$L){var $T,$k,$u,$S,$Y,$x=$f.elements,$j=$x[0],$R=$x[1],$l=$x[2],$i=$x[3],$q=$x[4],$o=$x[5],$r=$x[6],$_=$x[7],$s=$x[8],$d=$x[9],$p=$x[10],$U=$x[11],$Q=$x[12],$D=$x[13],$g=$x[14],$F=$x[15],$A=$h,$G=$h+4,$y=$h+8,$O=$h+12,$P=$L,$W=$L+4,$I=$L+8,$m=$L+12;for($T=0;$T<4;$T++)$k=$J[$A+$T],$u=$J[$G+$T],$S=$J[$y+$T],$Y=$J[$O+$T],$n[$P+$T]=$k*$j+$u*$R+$S*$l+$Y*$i,$n[$W+$T]=$k*$q+$u*$o+$S*$r+$Y*$_,$n[$I+$T]=$k*$s+$u*$d+$S*$p+$Y*$U,$n[$m+$T]=$k*$Q+$u*$D+$S*$g+$Y*$F;},$W.createAffineTransformationArray=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$j){var $R=$n+$n,$l=$L+$L,$i=$T+$T,$q=$n*$R,$o=$n*$l,$r=$n*$i,$_=$L*$l,$s=$L*$i,$d=$T*$i,$p=$k*$R,$U=$k*$l,$Q=$k*$i;$x[$j+0]=(1-($_+$d))*$u,$x[$j+1]=($o+$Q)*$u,$x[$j+2]=($r-$U)*$u,$x[$j+3]=0,$x[$j+4]=($o-$Q)*$S,$x[$j+5]=(1-($q+$d))*$S,$x[$j+6]=($s+$p)*$S,$x[$j+7]=0,$x[$j+8]=($r+$U)*$Y,$x[$j+9]=($s-$p)*$Y,$x[$j+10]=(1-($q+$_))*$Y,$x[$j+11]=0,$x[$j+12]=$J,$x[$j+13]=$h,$x[$j+14]=$f,$x[$j+15]=1;},$W.transformVector3ArrayToVector3ArrayCoordinate=function($J,$h,$f,$n,$L){var $T=$W._tempArray4_0,$k=$J[$h+0],$u=$J[$h+1],$S=$J[$h+2],$Y=$f.elements;$T[0]=$k*$Y[0]+$u*$Y[4]+$S*$Y[8]+$Y[12],$T[1]=$k*$Y[1]+$u*$Y[5]+$S*$Y[9]+$Y[13],$T[2]=$k*$Y[2]+$u*$Y[6]+$S*$Y[10]+$Y[14],$T[3]=1/($k*$Y[3]+$u*$Y[7]+$S*$Y[11]+$Y[15]),$n[$L+0]=$T[0]*$T[3],$n[$L+1]=$T[1]*$T[3],$n[$L+2]=$T[2]*$T[3];},$W.transformLightingMapTexcoordByUV0Array=function($J,$h,$f,$n,$L){var $T=$f.elements;$n[$L+0]=$J[$h+0]*$T[0]+$T[2],$n[$L+1]=($J[$h+1]-1)*$T[1]+$T[3];},$W.transformLightingMapTexcoordByUV1Array=function($J,$h,$f,$n,$L){var $T=$f.elements;$n[$L+0]=$J[$h+0]*$T[0]+$T[2],$n[$L+1]=1+$J[$h+1]*$T[1]+$T[3];},$W.getURLVerion=function($J){var $h=$J.indexOf("?");return 0<=$h?$J.substr($h):null;},$W._quaternionCreateFromYawPitchRollArray=function($J,$h,$f,$n){var $L=.5*$f,$T=.5*$h,$k=.5*$J,$u=Math.sin($L),$S=Math.cos($L),$Y=Math.sin($T),$x=Math.cos($T),$j=Math.sin($k),$R=Math.cos($k);$n[0]=$R*$Y*$S+$j*$x*$u,$n[1]=$j*$x*$S-$R*$Y*$u,$n[2]=$R*$x*$u-$j*$Y*$S,$n[3]=$R*$x*$S+$j*$Y*$u;},$W._createAffineTransformationArray=function($J,$h,$f,$n){var $L=$h[0],$T=$h[1],$k=$h[2],$u=$h[3],$S=$L+$L,$Y=$T+$T,$x=$k+$k,$j=$L*$S,$R=$L*$Y,$l=$L*$x,$i=$T*$Y,$q=$T*$x,$o=$k*$x,$r=$u*$S,$_=$u*$Y,$s=$u*$x,$d=$f[0],$p=$f[1],$U=$f[2];$n[0]=(1-($i+$o))*$d,$n[1]=($R+$s)*$d,$n[2]=($l-$_)*$d,$n[3]=0,$n[4]=($R-$s)*$p,$n[5]=(1-($j+$o))*$p,$n[6]=($q+$r)*$p,$n[7]=0,$n[8]=($l+$_)*$U,$n[9]=($q-$r)*$U,$n[10]=(1-($j+$i))*$U,$n[11]=0,$n[12]=$J[0],$n[13]=$J[1],$n[14]=$J[2],$n[15]=1;},$W._mulMatrixArray=function($J,$h,$f,$n){var $L,$T,$k,$u,$S,$Y=$h.elements,$x=$Y[0],$j=$Y[1],$R=$Y[2],$l=$Y[3],$i=$Y[4],$q=$Y[5],$o=$Y[6],$r=$Y[7],$_=$Y[8],$s=$Y[9],$d=$Y[10],$p=$Y[11],$U=$Y[12],$Q=$Y[13],$D=$Y[14],$g=$Y[15],$F=$n,$A=$n+4,$G=$n+8,$y=$n+12;for($L=0;$L<4;$L++)$T=$J[$L],$k=$J[$L+4],$u=$J[$L+8],$S=$J[$L+12],$f[$F+$L]=$T*$x+$k*$j+$u*$R+$S*$l,$f[$A+$L]=$T*$i+$k*$q+$u*$o+$S*$r,$f[$G+$L]=$T*$_+$k*$s+$u*$d+$S*$p,$f[$y+$L]=$T*$U+$k*$Q+$u*$D+$S*$g;},$W.getYawPitchRoll=function($J,$h){$W.transformQuat($kh.ForwardRH,$J,$fh.TEMPVector31),$W.transformQuat($kh.Up,$J,$fh.TEMPVector32);var $f=$fh.TEMPVector32.elements;$W.angleTo($kh.ZERO,$fh.TEMPVector31,$fh.TEMPVector33);var $n=$fh.TEMPVector33.elements;$n[0]==Math.PI/2?($n[1]=$W.arcTanAngle($f[2],$f[0]),$n[2]=0):$n[0]==-Math.PI/2?($n[1]=$W.arcTanAngle(-$f[2],-$f[0]),$n[2]=0):($Jh.createRotationY(-$n[1],$fh.TEMPMatrix0),$Jh.createRotationX(-$n[0],$fh.TEMPMatrix1),$kh.transformCoordinate($fh.TEMPVector32,$fh.TEMPMatrix0,$fh.TEMPVector32),$kh.transformCoordinate($fh.TEMPVector32,$fh.TEMPMatrix1,$fh.TEMPVector32),$n[2]=$W.arcTanAngle($f[1],-$f[0])),$n[1]<=-Math.PI&&($n[1]=Math.PI),$n[2]<=-Math.PI&&($n[2]=Math.PI),$n[1]>=Math.PI&&$n[2]>=Math.PI&&($n[1]=0,$n[2]=0,$n[0]=Math.PI-$n[0]),$h[0]=$n[1],$h[1]=$n[0],$h[2]=$n[2];},$W.arcTanAngle=function($J,$h){return 0==$J?1==$h?Math.PI/2:-Math.PI/2:0<$J?Math.atan($h/$J):$J<0?0<$h?Math.atan($h/$J)+Math.PI:Math.atan($h/$J)-Math.PI:0;},$W.angleTo=function($J,$h,$f){$kh.subtract($h,$J,$fh.TEMPVector30),$kh.normalize($fh.TEMPVector30,$fh.TEMPVector30),$f.elements[0]=Math.asin($fh.TEMPVector30.y),$f.elements[1]=$W.arcTanAngle(-$fh.TEMPVector30.z,-$fh.TEMPVector30.x);},$W.transformQuat=function($J,$h,$f){var $n=$f.elements,$L=$J.elements,$T=$h,$k=$L[0],$u=$L[1],$S=$L[2],$Y=$T[0],$x=$T[1],$j=$T[2],$R=$T[3],$l=$R*$k+$x*$S-$j*$u,$i=$R*$u+$j*$k-$Y*$S,$q=$R*$S+$Y*$u-$x*$k,$o=-$Y*$k-$x*$u-$j*$S;$n[0]=$l*$R+$o*-$Y+$i*-$j-$q*-$x,$n[1]=$i*$R+$o*-$x+$q*-$Y-$l*-$j,$n[2]=$q*$R+$o*-$j+$l*-$x-$i*-$Y;},$W.quaterionNormalize=function($J,$h){var $f=$J[0],$n=$J[1],$L=$J[2],$T=$J[3],$k=$f*$f+$n*$n+$L*$L+$T*$T;0<$k&&($k=1/Math.sqrt($k),$h[0]=$f*$k,$h[1]=$n*$k,$h[2]=$L*$k,$h[3]=$T*$k);},$W.matrix4x4MultiplyFFF=function($J,$h,$f){var $n,$L,$T,$k,$u;if($f===$h)for($h=new Float32Array(16),$n=0;$n<16;++$n)$h[$n]=$f[$n];for($n=0;$n<4;$n++)$L=$J[$n],$T=$J[$n+4],$k=$J[$n+8],$u=$J[$n+12],$f[$n]=$L*$h[0]+$T*$h[1]+$k*$h[2]+$u*$h[3],$f[$n+4]=$L*$h[4]+$T*$h[5]+$k*$h[6]+$u*$h[7],$f[$n+8]=$L*$h[8]+$T*$h[9]+$k*$h[10]+$u*$h[11],$f[$n+12]=$L*$h[12]+$T*$h[13]+$k*$h[14]+$u*$h[15];},$W.matrix4x4MultiplyMFM=function($J,$h,$f){$W.matrix4x4MultiplyFFF($J.elements,$h,$f.elements);},$j($W,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"};},"_tempVector3_0",function(){return this._tempVector3_0=new $kh();},"_tempVector3_1",function(){return this._tempVector3_1=new $kh();},"_tempVector3_2",function(){return this._tempVector3_2=new $kh();},"_tempVector3_3",function(){return this._tempVector3_3=new $kh();},"_tempVector3_4",function(){return this._tempVector3_4=new $kh();},"_tempVector3_5",function(){return this._tempVector3_5=new $kh();},"_tempVector3_6",function(){return this._tempVector3_6=new $kh();},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4);},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16);},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16);},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16);},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16);}]),$W;}(),$rh=function(){function $O(){}return $l($O,"Laya3D"),$O._cancelLoadByUrl=function($J){$p.loader.cancelLoadByUrl($J),$O._innerFirstLevelLoaderManager.cancelLoadByUrl($J),$O._innerSecondLevelLoaderManager.cancelLoadByUrl($J),$O._innerThirdLevelLoaderManager.cancelLoadByUrl($J),$O._innerFourthLevelLoaderManager.cancelLoadByUrl($J);},$O._changeWebGLSize=function($J,$h){$y.onStageResize($J,$h),$X.clientWidth=$J,$X.clientHeight=$h;},$O.__init__=function(){var $J=$h.createMap;$J.lh=[$mh,"SPRITE3DHIERARCHY"],$J.ls=[$Ih,"SPRITE3DHIERARCHY"],$J.lm=[$Ch,"MESH"],$J.lmat=[$th,"MATERIAL"],$J.jpg=[$Hh,"nativeimage"],$J.jpeg=[$Hh,"nativeimage"],$J.png=[$Hh,"nativeimage"],$J.pkm=[$Hh,"arraybuffer"],$J.raw=[$Bh,"arraybuffer"],$J.mipmaps=[$Bh,"arraybuffer"],$r.parserMap.SPRITE3DHIERARCHY=$O._loadHierarchy,$r.parserMap.MESH=$O._loadMesh,$r.parserMap.MATERIAL=$O._loadMaterial,$r.parserMap.TEXTURECUBE=$O._loadTextureCube,$r.parserMap.TERRAIN=$O._loadTerrain,$O._innerFirstLevelLoaderManager.on("error",null,$O._eventLoadManagerError),$O._innerSecondLevelLoaderManager.on("error",null,$O._eventLoadManagerError),$O._innerThirdLevelLoaderManager.on("error",null,$O._eventLoadManagerError),$O._innerFourthLevelLoaderManager.on("error",null,$O._eventLoadManagerError);},$O.READ_BLOCK=function(){return $O._readData.pos+=4,!0;},$O.READ_DATA=function(){return $O._DATA.offset=$O._readData.getUint32(),$O._DATA.size=$O._readData.getUint32(),!0;},$O.READ_STRINGS=function(){var $J=[],$h={offset:0,size:0};$h.offset=$O._readData.getUint16(),$h.size=$O._readData.getUint16();$O._readData.pos;$O._readData.pos=$h.offset+$O._DATA.offset;for(var $f=0;$f<$h.size;$f++){var $n=$O._readData.readUTFString();-1===$n.lastIndexOf(".lmat")&&-1===$n.lastIndexOf(".lpbr")||$J.push($n);}return $J;},$O.formatRelativePath=function($J,$h){var $f;if("."===$h.charAt(0)){for(var $n=($J+$h).split("/"),$L=0,$T=$n.length;$L<$T;$L++)if(".."==$n[$L]){var $k=$L-1;0<$k&&".."!==$n[$k]&&($n.splice($k,2),$L-=2);}$f=$n.join("/");}else $f=$J+$h;return null!=$G.customFormat&&($f=$G.customFormat($f,null)),$f;},$O._eventLoadManagerError=function($J){$p.loader.event("error",$J);},$O._addHierarchyInnerUrls=function($J,$h,$f,$n,$L,$T){var $k=$O.formatRelativePath($n,$L);$f&&($k+=$f),$J.push({url:$k,clas:$T}),$h[$L]=$k;},$O._getSprite3DHierarchyInnerUrls=function($J,$h,$f,$n,$L,$T,$k){var $u,$S=0,$Y=0;switch($J.type){case"Scene":var $x=$J.customProps.lightmaps;for($S=0,$Y=$x.length;$S<$Y;$S++){var $j=$x[$S].replace(".exr",".png");$O._addHierarchyInnerUrls($n,$L,$T,$k,$j,$Hh);}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var $R;if($J.instanceParams)($R=$J.instanceParams.loadPath)&&$O._addHierarchyInnerUrls($h,$L,$T,$k,$R,$Ch);else{($R=($u=$J.customProps).meshPath)&&$O._addHierarchyInnerUrls($h,$L,$T,$k,$R,$Ch);var $l=$u.materials;if($l)for($S=0,$Y=$l.length;$S<$Y;$S++){for(var $i=$l[$S],$q=$i.type.split("."),$o=$P.window,$r=0,$_=$q.length;$r<$_;++$r){$o=$o[this.clasPaths[$r]];}if("function"!=typeof $o)throw"_getSprite3DHierarchyInnerUrls 错误: "+$i.type+" 不是类";$O._addHierarchyInnerUrls($f,$L,$T,$k,$i.path,$o);}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var $s=($u=$J.customProps).meshPath;$s&&$O._addHierarchyInnerUrls($h,$L,$T,$k,$s,$Ch);var $d=$u.material;if($d){$q=$d.type.split("."),$o=$P.window;for($r=0,$_=$q.length;$r<$_;++$r){$o=$o[this.clasPaths[$r]];}$O._addHierarchyInnerUrls($f,$L,$T,$k,$d.path,$o);}else{var $p=$u.materialPath;if($p)$O._addHierarchyInnerUrls($f,$L,$T,$k,$p,ShurikenParticleMaterial);else{var $U=$u.texturePath;$U&&$O._addHierarchyInnerUrls($n,$L,$T,$k,$U,$Hh);}}break;case"Terrain":$O._addHierarchyInnerUrls($n,$L,$T,$k,$J.customProps.dataPath,TerrainRes);}var $Q=$J.components;for(var $D in $Q){var $g=$Q[$D];switch($D){case"Animator":var $F=$g.avatarPath;if($F)$O._addHierarchyInnerUrls($n,$L,$T,$k,$F,Avatar);else{var $A=$g.avatar;$A&&$O._addHierarchyInnerUrls($n,$L,$T,$k,$A.path,Avatar);}var $G=$g.clipPaths;for($S=0,$Y=$G.length;$S<$Y;$S++)$O._addHierarchyInnerUrls($n,$L,$T,$k,$G[$S],AnimationClip);}}var $y=$J.child;for($S=0,$Y=$y.length;$S<$Y;$S++)$O._getSprite3DHierarchyInnerUrls($y[$S],$h,$f,$n,$L,$T,$k);},$O._loadHierarchy=function($J){$J.on("loaded",null,$O._onHierarchylhLoaded,[$J,$J._class._getGroup()]),$J.load($J.url,"json",!1,null,!0);},$O._onHierarchylhLoaded=function($J,$h,$f){if($J._class.destroyed)$J.endLoad();else{var $n=$J.url,$L=$oh.getURLVerion($n),$T=$G.getPath($n),$k=[],$u=[],$S=[],$Y={};$O._getSprite3DHierarchyInnerUrls($f,$k,$u,$S,$Y,$L,$T);var $x=$k.length+$u.length+$S.length,$j=$x+1,$R=1/$j;if($O._onProcessChange($J,0,$R,1),0<$S.length){var $l=$x/$j,$i=$A.create(null,$O._onProcessChange,[$J,$R,$l],!1);$O._innerFourthLevelLoaderManager.create($S,$A.create(null,$O._onHierarchyInnerForthLevResouLoaded,[$J,$h,$i,$f,$Y,$k,$u,$R+$l*$S.length,$l]),$i,null,null,1,!0,$h);}else $O._onHierarchyInnerForthLevResouLoaded($J,$h,null,$f,$Y,$k,$u,$R,$l);}},$O._onHierarchyInnerForthLevResouLoaded=function($J,$h,$f,$n,$L,$T,$k,$u,$S){if($J._class.destroyed)$J.endLoad();else if($f&&$f.recover(),0<$k.length){var $Y=$A.create(null,$O._onProcessChange,[$J,$u,$S],!1);$O._innerSecondLevelLoaderManager.create($k,$A.create(null,$O._onHierarchyInnerSecondLevResouLoaded,[$J,$h,$Y,$n,$L,$T,$u+$S*$k.length,$S]),$f,null,null,1,!0,$h);}else $O._onHierarchyInnerSecondLevResouLoaded($J,$h,null,$n,$L,$T,$u,$S);},$O._onHierarchyInnerSecondLevResouLoaded=function($J,$h,$f,$n,$L,$T,$k,$u){if($J._class.destroyed)$J.endLoad();else if($f&&$f.recover(),0<$T.length){var $S=$A.create(null,$O._onProcessChange,[$J,$k,$u],!1);$O._innerFirstLevelLoaderManager.create($T,$A.create(null,$O._onHierarchyInnerFirstLevResouLoaded,[$J,$S,$n,$L]),$f,null,null,1,!0,$h);}else $O._onHierarchyInnerFirstLevResouLoaded($J,null,$n,$L);},$O._onHierarchyInnerFirstLevResouLoaded=function($J,$h,$f,$n){$h&&$h.recover(),$J.endLoad([$f,$n]);},$O._loadTerrain=function($J){$J.on("loaded",null,$O._onTerrainLtLoaded,[$J,$J._class._getGroup()]),$J.load($J.url,"json",!1,null,!0);},$O._onTerrainLtLoaded=function($J,$h,$f){if($J._class.destroyed)$J.endLoad();else{var $n,$L,$T=$J.url,$k=$oh.getURLVerion($T),$u=$G.getPath($T),$S=[],$Y={},$x=0,$j=0,$R=$f.heightData;$n=$R.url,$L=$O.formatRelativePath($u,$n),$k&&($L+=$k),$n=$Y[$n]=$L;var $l=$f.detailTexture;for($x=0,$j=$l.length;$x<$j;$x++)$S.push({url:$l[$x].diffuse});var $i=$f.normalMap;for($x=0,$j=$i.length;$x<$j;$x++)$S.push({url:$i[$x]});var $q=$f.alphaMap;for($x=0,$j=$q.length;$x<$j;$x++)$S.push({url:$q[$x],params:[!1,!1,6408,!0]});for($x=0,$j=$S.length;$x<$j;$x++){var $o=$S[$x].url;$L=$O.formatRelativePath($u,$o),$k&&($L+=$k),$S[$x].url=$L,$Y[$o]=$L;}var $r=$S.length,$_=$r+2,$s=1/$_;$O._onProcessChange($J,0,$s,1);var $d={heightMapLoaded:!1,texturesLoaded:!1},$p=$A.create(null,$O._onProcessChange,[$J,$s,$s],!1);$O._innerFourthLevelLoaderManager.create($n,$A.create(null,$O._onTerrainHeightMapLoaded,[$J,$p,$f,$Y,$d]),$p,null,[$R.numX,$R.numZ,$R.bitType,$R.value],1,!0,$h);var $U=$A.create(null,$O._onProcessChange,[$J,2*$s,$r/$_],!1);$O._innerFourthLevelLoaderManager.create($S,$A.create(null,$O._onTerrainTexturesLoaded,[$J,$U,$f,$Y,$d]),$U,null,null,1,!0,$h);}},$O._onTerrainHeightMapLoaded=function($J,$h,$f,$n,$L){$L.heightMapLoaded=!0,$L.texturesLoaded&&($J.endLoad([$f,$n]),$h.recover());},$O._onTerrainTexturesLoaded=function($J,$h,$f,$n,$L){$L.texturesLoaded=!0,$L.heightMapLoaded&&($J.endLoad([$f,$n]),$h.recover());},$O._loadMesh=function($J){$J.on("loaded",null,$O._onMeshLmLoaded,[$J,$J._class._getGroup()]),$J.load($J.url,"arraybuffer",!1,null,!0);},$O._onMeshLmLoaded=function($J,$h,$f){if($J._class.destroyed)$J.endLoad();else{var $n,$L,$T,$k=$J.url,$u=$oh.getURLVerion($k),$S=$G.getPath($k),$Y={},$x=0,$j=0;switch(($O._readData=new $U($f)).pos=0,$O._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var $R=$O._readData.getUint32();$O._readData.pos=$O._readData.pos+4,$j=$O._readData.getUint16(),$O._readData.pos=$O._readData.pos+8*$j;var $l=$O._readData.getUint32();for($j=$O._readData.getUint16(),$O._readData.pos=$R+$l,$n=[],$x=0;$x<$j;$x++){var $i=$O._readData.readUTFString();-1!==$i.lastIndexOf(".lmat")&&$n.push($i);}break;default:for($O.READ_BLOCK(),$x=0;$x<2;$x++){var $q=$O._readData.getUint16(),$o=$O._strings[$q],$r=$O["READ_"+$o];if(null==$r)throw new Error("model file err,no this function:"+$q+" "+$o);1===$x?$n=$r.call():$r.call();}}for($x=0,$T=$n.length;$x<$T;$x++){var $_=$n[$x];$L=$O.formatRelativePath($S,$_),$u&&($L+=$u),$n[$x]=$L,$Y[$_]=$L;}if(0<$n.length){$O._onProcessChange($J,0,.5,1);var $s=$A.create(null,$O._onProcessChange,[$J,.5,.5],!1);$O._innerSecondLevelLoaderManager.create($n,$A.create(null,$O._onMeshMateialLoaded,[$J,$s,$f,$Y]),$s,null,null,1,!0,$h);}else $J.endLoad([$f,$Y]);}},$O._onMeshMateialLoaded=function($J,$h,$f,$n){$J.endLoad([$f,$n]),$h.recover();},$O._getMaterialTexturePath=function($J,$h,$f){var $n=$J.length-4;return $J.indexOf(".dds")!=$n&&$J.indexOf(".tga")!=$n&&$J.indexOf(".exr")!=$n&&$J.indexOf(".DDS")!=$n&&$J.indexOf(".TGA")!=$n&&$J.indexOf(".EXR")!=$n||($J=$J.substr(0,$n)+".png"),$J=$O.formatRelativePath($f,$J),$h&&($J+=$h),$J;},$O._loadMaterial=function($J){$J.on("loaded",null,$O._onMaterilLmatLoaded,[$J,$J._class._getGroup()]),$J.load($J.url,"json",!1,null,!0);},$O._onMaterilLmatLoaded=function($J,$h,$f){if($J._class.destroyed)$J.endLoad();else{var $n,$L=$J.url,$T=$oh.getURLVerion($L),$k=$G.getPath($L),$u=[],$S={},$Y=$f.customProps,$x=$f.version;if($x)switch($x){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var $j=$f.props.textures,$R=0,$l=$j.length;$R<$l;$R++){var $i=$j[$R],$q=$i.path;if($q){var $o=$q.length-4;$q.indexOf(".exr")!=$o&&$q.indexOf(".EXR")!=$o||($q=$q.substr(0,$o)+".png"),$n=$O.formatRelativePath($k,$q),$T&&($n+=$T),$u.push({url:$n,params:$i.params}),$S[$q]=$n;}}break;default:throw new Error("Laya3D:unkonwn version.");}else{var $r=$Y.diffuseTexture.texture2D;if($r&&($n=$O._getMaterialTexturePath($r,$T,$k),$u.push($n),$S[$r]=$n),$Y.normalTexture){var $_=$Y.normalTexture.texture2D;$_&&($n=$O._getMaterialTexturePath($_,$T,$k),$u.push($n),$S[$_]=$n);}if($Y.specularTexture){var $s=$Y.specularTexture.texture2D;$s&&($n=$O._getMaterialTexturePath($s,$T,$k),$u.push($n),$S[$s]=$n);}if($Y.emissiveTexture){var $d=$Y.emissiveTexture.texture2D;$d&&($n=$O._getMaterialTexturePath($d,$T,$k),$u.push($n),$S[$d]=$n);}if($Y.ambientTexture){var $p=$Y.ambientTexture.texture2D;$p&&($n=$O._getMaterialTexturePath($p,$T,$k),$u.push($n),$S[$p]=$n);}if($Y.reflectTexture){var $U=$Y.reflectTexture.texture2D;$U&&($n=$O._getMaterialTexturePath($U,$T,$k),$u.push($n),$S[$U]=$n);}}var $Q=$u.length,$D=$Q+1,$g=1/$D;if($O._onProcessChange($J,0,$g,1),0<$Q){var $F=$A.create(null,$O._onProcessChange,[$J,$g,$Q/$D],!1);$O._innerFourthLevelLoaderManager.create($u,$A.create(null,$O._onMateialTexturesLoaded,[$J,$F,$f,$S]),$F,$Hh,null,1,!0,$h);}else $O._onMateialTexturesLoaded($J,null,$f,null);}},$O._onMateialTexturesLoaded=function($J,$h,$f,$n){$J.endLoad([$f,$n]),$h&&$h.recover();},$O._loadTextureCube=function($J){$J.on("loaded",null,$O._onTextureCubeLtcLoaded,[$J]),$J.load($J.url,"json",!1,null,!0);},$O._onTextureCubeLtcLoaded=function($J,$h){if($J._class.destroyed)$J.endLoad();else{var $f=$G.getPath($J.url),$n=[$O.formatRelativePath($f,$h.px),$O.formatRelativePath($f,$h.nx),$O.formatRelativePath($f,$h.py),$O.formatRelativePath($f,$h.ny),$O.formatRelativePath($f,$h.pz),$O.formatRelativePath($f,$h.nz)];$O._onProcessChange($J,0,1/7,1);var $L=$A.create(null,$O._onProcessChange,[$J,1/7,6/7],!1);$O._innerFourthLevelLoaderManager.load($n,$A.create(null,$O._onTextureCubeImagesLoaded,[$J,$n,$L]),$L,"nativeimage");}},$O._onTextureCubeImagesLoaded=function($J,$h,$f){var $n=[];$n.length=6;for(var $L=0;$L<6;$L++){var $T=$h[$L];$n[$L]=$r.getRes($T),$r.clearRes($T);}$J.endLoad($n),$f.recover();},$O._onProcessChange=function($J,$h,$f,$n){($n=$h+$n*$f)<1&&$J.event("progress",$n);},$O.init=function($J,$h,$f,$n,$L,$T){if(void 0===$f&&($f=!1),void 0===$n&&($n=!1),void 0===$L&&($L=!0),void 0===$T&&($T=!0),$_.update3DLoop=function(){},$_.cancelLoadByUrl=function($J){$O._cancelLoadByUrl($J);},$S.isAntialias=$f,$S.isAlpha=$n,$S.premultipliedAlpha=$L,$S.isStencil=$T,!$y.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");$_.changeWebGLSize=$O._changeWebGLSize,$q.is3DMode=!0,$p.init($J,$h),$W.__init__(),$jh.__init__(),$Mh.__init__(),$V.__init__(),$O.__init__(),$k.maxTextureCount=2,($O.debugMode||$w.debugMode)&&($O._debugPhasorSprite=new $v());},$O.HIERARCHY="SPRITE3DHIERARCHY",$O.MESH="MESH",$O.MATERIAL="MATERIAL",$O.PBRMATERIAL="PBRMTL",$O.TEXTURECUBE="TEXTURECUBE",$O.TERRAIN="TERRAIN",$O._readData=null,$O._debugPhasorSprite=null,$O.debugMode=!1,$j($O,["_DATA",function(){return this._DATA={offset:0,size:0};},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"];},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new $h();},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new $h();},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new $h();},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new $h();}]),$O;}(),$_h=function($J){function $L($J){$L.__super.call(this),this._owner=$J,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0;}$l($L,"laya.d3.animation.AnimationTransform3D",$T);var $h=$L.prototype;return $h._getlocalMatrix=function(){return this._localUpdate&&($oh._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix;},$h._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var $J=0,$h=this._childs.length;$J<$h;$J++)this._childs[$J]._onWorldTransform();}},$h._setWorldMatrixAndUpdate=function($J){if(this._worldMatrix=$J,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var $h=this._getlocalMatrix(),$f=0;$f<16;++$f)this._worldMatrix[$f]=$h[$f];else $oh.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1;},$h._setWorldMatrixNoUpdate=function($J){this._worldMatrix=$J;},$h._setWorldMatrixIgnoreUpdate=function($J){this._worldMatrix=$J,this._worldUpdate=!1;},$h.getLocalPosition=function(){return this._localPosition;},$h.setLocalPosition=function($J){if(this._parent)this._localPosition=$J,this._localUpdate=!0,this._onWorldTransform();else{var $h=this._entity.owner._transform,$f=this._entity.localPosition,$n=$f.elements;$n[0]=$J[0],$n[1]=$J[1],$n[2]=$J[2],$h.localPosition=$f;}},$h.getLocalRotation=function(){if(this._localQuaternionUpdate){var $J=this._localRotationEuler;$oh._quaternionCreateFromYawPitchRollArray($J[1]/$L._angleToRandin,$J[0]/$L._angleToRandin,$J[2]/$L._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1;}return this._localRotation;},$h.setLocalRotation=function($J){if(this._parent)this._localRotation=$J,$oh.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $h=this._entity.owner._transform,$f=this._entity.localRotation,$n=$f.elements;$n[0]=$J[0],$n[1]=$J[1],$n[2]=$J[2],$n[3]=$J[3],$h.localRotation=$f;}},$h.getLocalScale=function(){return this._localScale;},$h.setLocalScale=function($J){if(this._parent)this._localScale=$J,this._localUpdate=!0,this._onWorldTransform();else{var $h=this._entity.owner._transform,$f=this._entity.localScale,$n=$f.elements;$n[0]=$J[0],$n[1]=$J[1],$n[2]=$J[2],$h.localScale=$f;}},$h.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){$oh.getYawPitchRoll(this._localRotation,$L._tempVector3);var $J=$L._tempVector3,$h=this._localRotationEuler;$h[0]=$J[1]*$L._angleToRandin,$h[1]=$J[0]*$L._angleToRandin,$h[2]=$J[2]*$L._angleToRandin,this._locaEulerlUpdate=!1;}return this._localRotationEuler;},$h.setLocalRotationEuler=function($J){if(this._parent)$oh._quaternionCreateFromYawPitchRollArray($J[1]/$L._angleToRandin,$J[0]/$L._angleToRandin,$J[2]/$L._angleToRandin,this._localRotation),this._localRotationEuler=$J,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $h=this._entity.owner._transform,$f=this._entity.localRotationEuler,$n=$f.elements;$n[0]=$J[0],$n[1]=$J[1],$n[2]=$J[2],$h.localRotationEuler=$f;}},$h.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)$oh.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var $J=this._getlocalMatrix(),$h=0;$h<16;++$h)this._worldMatrix[$h]=$J[$h];this._worldUpdate=!1;}return this._worldMatrix;},$h.setParent=function($J){if(this._parent!==$J){if(this._parent){var $h=this._parent._childs,$f=$h.indexOf(this);$h.splice($f,1);}$J&&($J._childs.push(this),$J&&this._onWorldTransform()),this._parent=$J;}},$j($L,["_tempVector3",function(){return this._tempVector3=new Float32Array(3);},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI;}]),$L;}(),$sh=function($J){function $h(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,$h.__super.call(this),this._destroyed=!1,this._id=$h._uniqueIDCounter,$h._uniqueIDCounter++;}$l($h,"laya.d3.component.Component3D",$T);var $f=$h.prototype;return $p.imps($f,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),$f._initialize=function($J){this._owner=$J,this._enable=!0,this.started=!1,this._load($J);},$f._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0;},$f._load=function($J){},$f._start=function($J){},$f._update=function($J){},$f._lateUpdate=function($J){},$f._preRenderUpdate=function($J){},$f._postRenderUpdate=function($J){},$f._unload=function($J){this.offAll();},$f._cloneTo=function($J){},$i(0,$f,"id",function(){return this._id;}),$i(0,$f,"destroyed",function(){return this._destroyed;}),$i(0,$f,"owner",function(){return this._owner;}),$i(0,$f,"enable",function(){return this._enable;},function($J){this._enable!==$J&&(this._enable=$J,this.event("enablechanged",this._enable));}),$i(0,$f,"isSingleton",function(){return $h._isSingleton;}),$h._isSingleton=!0,$h._uniqueIDCounter=1,$h;}(),$dh=function($J){function $h(){this._destroyed=!1,$h.__super.call(this),this._destroyed=!1;}$l($h,"laya.d3.core.GeometryFilter",$T);var $f=$h.prototype;return $p.imps($f,{"laya.resource.IDestroy":!0}),$f._destroy=function(){this.offAll(),this._destroyed=!0;},$i(0,$f,"_isAsyncLoaded",function(){return!0;}),$i(0,$f,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.");}),$i(0,$f,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.");}),$i(0,$f,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.");}),$i(0,$f,"destroyed",function(){return this._destroyed;}),$h;}(),$ph=function($J){function $n($J){$n.__super.call(this),this._id=++$n._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new $wJ(new $kh(),new $kh()),this._boundingBoxCenter=new $kh(),this._boundingSphere=new $NJ(new $kh(),0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=$J,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange);}$l($n,"laya.d3.core.render.BaseRender",$T);var $h=$n.prototype;return $p.imps($h,{"laya.resource.IDestroy":!0}),$h._changeMaterialReference=function($J,$h){$J&&$J._removeReference(),$h._addReference();},$h._getInstanceMaterial=function($J,$h){var $f=new $J.constructor();return $J.cloneTo($f),$f.name=$f.name+"(Instance)",this._materialsInstance[$h]=!0,this._changeMaterialReference(this._materials[$h],$f),this._materials[$h]=$f;},$h._setShaderValuelightMap=function($J){this._setShaderValueTexture(3,$J);},$h._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0;},$h._renderRenderableBoundBox=function(){var $J=$rh._debugPhasorSprite,$h=this.boundingBox,$f=$n._tempBoundBoxCorners;$h.getCorners($f),$J.line($f[0],$n._greenColor,$f[1],$n._greenColor),$J.line($f[2],$n._greenColor,$f[3],$n._greenColor),$J.line($f[4],$n._greenColor,$f[5],$n._greenColor),$J.line($f[6],$n._greenColor,$f[7],$n._greenColor),$J.line($f[0],$n._greenColor,$f[3],$n._greenColor),$J.line($f[1],$n._greenColor,$f[2],$n._greenColor),$J.line($f[2],$n._greenColor,$f[6],$n._greenColor),$J.line($f[3],$n._greenColor,$f[7],$n._greenColor),$J.line($f[0],$n._greenColor,$f[4],$n._greenColor),$J.line($f[1],$n._greenColor,$f[5],$n._greenColor),$J.line($f[4],$n._greenColor,$f[7],$n._greenColor),$J.line($f[5],$n._greenColor,$f[6],$n._greenColor);},$h._calculateBoundingSphere=function(){throw"BaseRender: must override it.";},$h._calculateBoundingBox=function(){throw"BaseRender: must override it.";},$h._setShaderValueTexture=function($J,$h){this._owner._shaderValues.setValue($J,$h);},$h._setShaderValueMatrix4x4=function($J,$h){this._owner._shaderValues.setValue($J,$h?$h.elements:null);},$h._setShaderValueColor=function($J,$h){this._owner._shaderValues.setValue($J,$h?$h.elements:null);},$h._setShaderValueBuffer=function($J,$h){this._owner._shaderValues.setValue($J,$h);},$h._setShaderValueInt=function($J,$h){this._owner._shaderValues.setValue($J,$h);},$h._setShaderValueBool=function($J,$h){this._owner._shaderValues.setValue($J,$h);},$h._setShaderValueNumber=function($J,$h){this._owner._shaderValues.setValue($J,$h);},$h._setShaderValueVector2=function($J,$h){this._owner._shaderValues.setValue($J,$h?$h.elements:null);},$h._addShaderDefine=function($J){this._owner._shaderDefineValue|=$J;},$h._removeShaderDefine=function($J){this._owner._shaderDefineValue&=~$J;},$h._renderUpdate=function($J){return!0;},$h._applyLightMapParams=function(){if(0<=this._lightmapIndex){var $J=this._owner.scene;if($J){var $h=$J.getlightmaps()[this._lightmapIndex];$h?(this._addShaderDefine($vh.SAHDERDEFINE_LIGHTMAP),$h.loaded?this._setShaderValuelightMap($h):$h.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine($vh.SAHDERDEFINE_LIGHTMAP);}else this._removeShaderDefine($vh.SAHDERDEFINE_LIGHTMAP);}else this._removeShaderDefine($vh.SAHDERDEFINE_LIGHTMAP);},$h._updateOctreeNode=function(){var $J=this._treeNode;$J&&this._octreeNodeNeedChange&&($J.updateObject(this),this._octreeNodeNeedChange=!1);},$h._destroy=function(){this.offAll();var $J=0,$h=0;for($J=0,$h=this._renderElements.length;$J<$h;$J++)this._renderElements[$J]._destroy();for($J=0,$h=this._materials.length;$J<$h;$J++)this._materials[$J]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0;},$i(0,$h,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere;}),$i(0,$h,"id",function(){return this._id;}),$i(0,$h,"material",function(){var $J=this._materials[0];if($J&&!this._materialsInstance[0]){var $h=this._getInstanceMaterial($J,0);this.event("materialchanged",[this,0,$h]);}return this._materials[0];},function($J){this.sharedMaterial=$J;}),$i(0,$h,"sharedMaterial",function(){return this._materials[0];},function($J){var $h=this._materials[0];$h!==$J&&(this._materials[0]=$J,this._materialsInstance[0]=!1,this._changeMaterialReference($h,$J),this.event("materialchanged",[this,0,$J]));}),$i(0,$h,"lightmapIndex",function(){return this._lightmapIndex;},function($J){this._lightmapIndex=$J,this._applyLightMapParams();}),$i(0,$h,"lightmapScaleOffset",function(){return this._lightmapScaleOffset;},function($J){this._lightmapScaleOffset=$J,this._setShaderValueColor(2,$J),this._addShaderDefine($vh.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV);}),$i(0,$h,"enable",function(){return this._enable;},function($J){this._enable=$J,this.event("enablechanged",[this,$J]);}),$i(0,$h,"materials",function(){for(var $J=0,$h=this._materials.length;$J<$h;$J++)if(!this._materialsInstance[$J]){var $f=this._getInstanceMaterial(this._materials[$J],$J);this.event("materialchanged",[this,$J,$f]);}return this._materials.slice();},function($J){this.sharedMaterials=$J;}),$i(0,$h,"sharedMaterials",function(){return this._materials.slice();},function($J){if(!$J)throw new Error("MeshRender: shadredMaterials value can't be null.");var $h=$J.length;this._materialsInstance.length=$h;for(var $f=0;$f<$h;$f++){var $n=this._materials[$f];$n!==$J[$f]&&(this._materialsInstance[$f]=!1,this._changeMaterialReference($n,$J[$f]),this.event("materialchanged",[this,$f,$J[$f]]));}this._materials=$J;}),$i(0,$h,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox;}),$i(0,$h,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var $J=this.boundingBox;$kh.add($J.min,$J.max,this._boundingBoxCenter),$kh.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1;}return this._boundingBoxCenter;}),$i(0,$h,"receiveShadow",function(){return this._receiveShadow;},function($J){this._receiveShadow!==$J&&((this._receiveShadow=$J)?this._addShaderDefine($lh.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine($lh.SHADERDEFINE_RECEIVE_SHADOW));}),$i(0,$h,"destroyed",function(){return this._destroyed;}),$n._uniqueIDCounter=0,$j($n,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new $kh(),new $kh(),new $kh(),new $kh(),new $kh(),new $kh(),new $kh(),new $kh()];},"_greenColor",function(){return this._greenColor=new $uh(0,1,0,1);}]),$n;}(),$Uh=function($J){function $u($J){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,$u.__super.call(this),this._localPosition=new $kh(),this._localRotation=new $fh(0,0,0,1),this._localScale=new $kh(1,1,1),this._localRotationEuler=new $kh(),this._localMatrix=new $Jh(),this._position=new $kh(),this._rotation=new $fh(0,0,0,1),this._scale=new $kh(1,1,1),this._worldMatrix=new $Jh(),this._forward=new $kh(),this._up=new $kh(),this._right=new $kh(),this._owner=$J,this._childs=[];}$l($u,"laya.d3.core.Transform3D",$T);var $h=$u.prototype;return $h._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)$Jh.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var $J=$u._tempVector30;$kh.multiply(this.pivot,this._localScale,$J);var $h=$u._tempVector31;$kh.subtract($J,this.pivot,$h);var $f=$u._tempVector32,$n=this.localRotation;$kh.transformQuat($J,$n,$f),$kh.subtract($f,$J,$f);var $L=$u._tempVector33;$kh.subtract(this._localPosition,$h,$L),$kh.subtract($L,$f,$L),$Jh.createAffineTransformation($L,$n,this._localScale,this._localMatrix);}},$h._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $J=0,$h=this._childs.length;$J<$h;$J++)this._childs[$J]._onWorldPositionRotationTransform();}},$h._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $J=0,$h=this._childs.length;$J<$h;$J++)this._childs[$J]._onWorldPositionScaleTransform();}},$h._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var $J=0,$h=this._childs.length;$J<$h;$J++)this._childs[$J]._onWorldPositionTransform();}},$h._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $J=0,$h=this._childs.length;$J<$h;$J++)this._childs[$J]._onWorldPositionRotationTransform();}},$h._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $J=0,$h=this._childs.length;$J<$h;$J++)this._childs[$J]._onWorldPositionScaleTransform();}},$h._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $J=0,$h=this._childs.length;$J<$h;$J++)this._childs[$J]._onWorldTransform();}},$h.translate=function($J,$h){void 0===$h&&($h=!0),$h?($Jh.createFromQuaternion(this.localRotation,$u._tempMatrix0),$kh.transformCoordinate($J,$u._tempMatrix0,$u._tempVector30),$kh.add(this.localPosition,$u._tempVector30,this._localPosition),this.localPosition=this._localPosition):($kh.add(this.position,$J,this._position),this.position=this._position);},$h.rotate=function($J,$h,$f){var $n;void 0===$h&&($h=!0),void 0===$f&&($f=!0),$n=$f?$J:($kh.scale($J,Math.PI/180,$u._tempVector30),$u._tempVector30),$fh.createFromYawPitchRoll($n.y,$n.x,$n.z,$u._tempQuaternion0),$h?($fh.multiply(this._localRotation,$u._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):($fh.multiply($u._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation);},$h.lookAt=function($J,$h,$f){void 0===$f&&($f=!1);var $n,$L=$J.elements;if($f){if($n=this._localPosition.elements,Math.abs($n[0]-$L[0])<$zJ.zeroTolerance&&Math.abs($n[1]-$L[1])<$zJ.zeroTolerance&&Math.abs($n[2]-$L[2])<$zJ.zeroTolerance)return;$fh.lookAt(this._localPosition,$J,$h,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation;}else{var $T=this.position;if($n=$T.elements,Math.abs($n[0]-$L[0])<$zJ.zeroTolerance&&Math.abs($n[1]-$L[1])<$zJ.zeroTolerance&&Math.abs($n[2]-$L[2])<$zJ.zeroTolerance)return;$fh.lookAt($T,$J,$h,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation;}},$i(0,$h,"_isFrontFaceInvert",function(){var $J=this.scale,$h=$J.x<0;return $J.y<0&&($h=!$h),$J.z<0&&($h=!$h),$h;}),$i(0,$h,"owner",function(){return this._owner;}),$i(0,$h,"localRotation",function(){if(this._localQuaternionUpdate){var $J=this._localRotationEuler.elements;$fh.createFromYawPitchRoll($J[1]/$u._angleToRandin,$J[0]/$u._angleToRandin,$J[2]/$u._angleToRandin,this._localRotation);}return this._localRotation;},function($J){this._localRotation=$J,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform();}),$i(0,$h,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?$Jh.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix;},function($J){null===this._parent?$J.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),$Jh.multiply(this._localMatrix,$J,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=$J,this._worldUpdate=!1;}),$i(0,$h,"worldNeedUpdate",function(){return this._worldUpdate;}),$i(0,$h,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix;},function($J){this._localMatrix=$J,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform();}),$i(0,$h,"dummy",function(){return this._dummy;},function($J){this._dummy!==$J&&(this._dummy&&(this._dummy._entity=null),$J&&($J._entity=this),this._dummy=$J);}),$i(0,$h,"localPosition",function(){return this._localPosition;},function($J){this._localPosition=$J,this._localUpdate=!0,this._onWorldPositionTransform();}),$i(0,$h,"position",function(){if(this._positionUpdate){if(null!=this._parent){var $J=this._parent.position;$kh.multiply(this._localPosition,this._parent.scale,$u._tempVector30),$kh.transformQuat($u._tempVector30,this._parent.rotation,$u._tempVector30),$kh.add($J,$u._tempVector30,this._position);}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1;}return this._position;},function($J){if(null!=this._parent){$kh.subtract($J,this._parent.position,this._localPosition);var $h=this._parent.scale.elements,$f=$h[0],$n=$h[1],$L=$h[2];if(1!==$f||1!==$n||1!==$L){var $T=$u._tempVector30,$k=$T.elements;$k[0]=1/$f,$k[1]=1/$n,$k[2]=1/$L,$kh.multiply(this._localPosition,$T,this._localPosition);}this._parent.rotation.invert($u._tempQuaternion0),$kh.transformQuat(this._localPosition,$u._tempQuaternion0,this._localPosition);}else $J.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=$J,this._positionUpdate=!1;}),$i(0,$h,"localScale",function(){return this._localScale;},function($J){this._localScale=$J,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform();}),$i(0,$h,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll($u._tempVector30);var $J=$u._tempVector30.elements,$h=this._localRotationEuler.elements;$h[0]=$J[1]*$u._angleToRandin,$h[1]=$J[0]*$u._angleToRandin,$h[2]=$J[2]*$u._angleToRandin;}return this._localRotationEuler;},function($J){this._localRotationEuler=$J,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform();}),$i(0,$h,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?$fh.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation;},function($J){null!=this._parent?(this._parent.rotation.invert($u._tempQuaternion0),$fh.multiply($J,$u._tempQuaternion0,this._localRotation)):$J.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=$J,this._rotationUpdate=!1;}),$i(0,$h,"scale",function(){return this._scaleUpdate&&(null!==this._parent?$kh.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale;},function($J){if(null!==this._parent){var $h=this._parent.scale.elements,$f=$u._tempVector30.elements;$f[0]=1/$h[0],$f[1]=1/$h[1],$f[2]=1/$h[2],$kh.multiply($J,$u._tempVector30,this._localScale);}else $J.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=$J,this._scaleUpdate=!1;}),$i(0,$h,"rotationEuler",null,function($J){$fh.createFromYawPitchRoll($J.y,$J.x,$J.z,this._rotation),this.rotation=this._rotation;}),$i(0,$h,"forward",function(){var $J=this.worldMatrix.elements;return this._forward.elements[0]=-$J[8],this._forward.elements[1]=-$J[9],this._forward.elements[2]=-$J[10],this._forward;}),$i(0,$h,"up",function(){var $J=this.worldMatrix.elements;return this._up.elements[0]=$J[4],this._up.elements[1]=$J[5],this._up.elements[2]=$J[6],this._up;}),$i(0,$h,"right",function(){var $J=this.worldMatrix.elements;return this._right.elements[0]=$J[0],this._right.elements[1]=$J[1],this._right.elements[2]=$J[2],this._right;}),$i(0,$h,"parent",function(){return this._parent;},function($J){if(this._parent!==$J){if(this._parent){var $h=this._parent._childs,$f=$h.indexOf(this);$h.splice($f,1);}$J&&($J._childs.push(this),$J&&this._onWorldTransform()),this._parent=$J;}}),$j($u,["_tempVector30",function(){return this._tempVector30=new $kh();},"_tempVector31",function(){return this._tempVector31=new $kh();},"_tempVector32",function(){return this._tempVector32=new $kh();},"_tempVector33",function(){return this._tempVector33=new $kh();},"_tempQuaternion0",function(){return this._tempQuaternion0=new $fh();},"_tempMatrix0",function(){return this._tempMatrix0=new $Jh();},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI;}]),$u;}(),$Qh=(function($J){function $h(){this._rotation=0,this._matNeedUpdte=!1,$h.__super.call(this),this._matrix=new $Jh(),this._offset=new $Th(),this._tiling=new $Th(1,1);}$l($h,"laya.d3.core.TransformUV",$T);var $f=$h.prototype;$p.imps($f,{"laya.d3.core.IClone":!0}),$f._updateMatrix=function(){$h._tempOffsetV3.elements[0]=this._offset.x,$h._tempOffsetV3.elements[1]=this._offset.y,$fh.createFromYawPitchRoll(0,0,this._rotation,$h._tempRotationQua),$h._tempTitlingV3.elements[0]=this._tiling.x,$h._tempTitlingV3.elements[1]=this._tiling.y,$Jh.createAffineTransformation($h._tempOffsetV3,$h._tempRotationQua,$h._tempTitlingV3,this._matrix);},$f.cloneTo=function($J){$J._matrix=this._matrix.clone(),$J._offset=this._offset.clone(),$J._rotation=this._rotation,$J._tiling=this._tiling.clone();},$f.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$f,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix;}),$i(0,$f,"tiling",function(){return this._tiling;},function($J){this._tiling=$J,this._matNeedUpdte=!0;}),$i(0,$f,"offset",function(){return this._offset;},function($J){this._offset=$J,this._matNeedUpdte=!0;}),$i(0,$f,"rotation",function(){return this._rotation;},function($J){this._rotation=$J,this._matNeedUpdte=!0;}),$j($h,["_tempOffsetV3",function(){return this._tempOffsetV3=new $kh(0,0,0);},"_tempRotationQua",function(){return this._tempRotationQua=new $fh();},"_tempTitlingV3",function(){return this._tempTitlingV3=new $kh(1,1,1);}]);}(),function($f){function $J(){this.x=NaN,this.y=NaN,this.z=NaN,$J.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1;}$l($J,"laya.d3.core.particleShuriKen.module.shape.BoxShape",$f);var $h=$J.prototype;$h._getShapeBoundBox=function($J){var $h=$J.min.elements;$h[0]=.5*-this.x,$h[1]=.5*-this.y,$h[2]=.5*-this.z;var $f=$J.max.elements;$f[0]=.5*this.x,$f[1]=.5*this.y,$f[2]=.5*this.z;},$h._getSpeedBoundBox=function($J){var $h=$J.min.elements;$h[0]=0,$h[1]=0,$h[2]=0;var $f=$J.max.elements;$f[0]=0,$f[1]=1,$f[2]=0;},$h.generatePositionAndDirection=function($J,$h,$f,$n){var $L=$J.elements,$T=$h.elements;$f?($f.seed=$n[16],$H._randomPointInsideHalfUnitBox($J,$f),$n[16]=$f.seed):$H._randomPointInsideHalfUnitBox($J),$L[0]=this.x*$L[0],$L[1]=this.y*$L[1],$L[2]=this.z*$L[2],this.randomDirection?$f?($f.seed=$n[17],$H._randomPointUnitSphere($h,$f),$n[17]=$f.seed):$H._randomPointUnitSphere($h):($T[0]=0,$T[1]=0,$T[2]=1);},$h.cloneTo=function($J){$f.prototype.cloneTo.call(this,$J);var $h=$J;$h.x=this.x,$h.y=this.y,$h.z=this.z,$h.randomDirection=this.randomDirection;};}($a),function($f){function $k(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,$k.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1;}$l($k,"laya.d3.core.particleShuriKen.module.shape.CircleShape",$f);var $J=$k.prototype;$J._getShapeBoundBox=function($J){var $h=$J.min.elements;$h[0]=$h[2]=-this.radius,$h[1]=0;var $f=$J.max.elements;$f[0]=$f[2]=this.radius,$f[1]=0;},$J._getSpeedBoundBox=function($J){var $h=$J.min.elements;$h[0]=$h[1]=-1,$h[2]=0;var $f=$J.max.elements;$f[0]=$f[1]=1,$f[2]=0;},$J.generatePositionAndDirection=function($J,$h,$f,$n){var $L=$J.elements,$T=$k._tempPositionPoint.elements;$f?($f.seed=$n[16],this.emitFromEdge?$H._randomPointUnitArcCircle(this.arc,$k._tempPositionPoint,$f):$H._randomPointInsideUnitArcCircle(this.arc,$k._tempPositionPoint,$f),$n[16]=$f.seed):this.emitFromEdge?$H._randomPointUnitArcCircle(this.arc,$k._tempPositionPoint):$H._randomPointInsideUnitArcCircle(this.arc,$k._tempPositionPoint),$L[0]=-$T[0],$L[1]=$T[1],$L[2]=0,$kh.scale($J,this.radius,$J),this.randomDirection?$f?($f.seed=$n[17],$H._randomPointUnitSphere($h,$f),$n[17]=$f.seed):$H._randomPointUnitSphere($h):$J.cloneTo($h);},$J.cloneTo=function($J){$f.prototype.cloneTo.call(this,$J);var $h=$J;$h.radius=this.radius,$h.arc=this.arc,$h.emitFromEdge=this.emitFromEdge,$h.randomDirection=this.randomDirection;},$j($k,["_tempPositionPoint",function(){return this._tempPositionPoint=new $Th();}]);}($a),function($f){function $R(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,$R.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1;}$l($R,"laya.d3.core.particleShuriKen.module.shape.ConeShape",$f);var $J=$R.prototype;$J._getShapeBoundBox=function($J){var $h=this.radius+this.length*Math.sin(this.angle),$f=this.length*Math.cos(this.angle),$n=$J.min.elements;$n[0]=$n[1]=-$h,$n[2]=0;var $L=$J.max.elements;$L[0]=$L[1]=$h,$L[2]=$f;},$J._getSpeedBoundBox=function($J){var $h=Math.sin(this.angle),$f=$J.min.elements;$f[0]=$f[1]=-$h,$f[2]=0;var $n=$J.max.elements;$n[0]=$f[1]=$h,$n[2]=1;},$J.generatePositionAndDirection=function($J,$h,$f,$n){var $L,$T=$J.elements,$k=$h.elements,$u=$R._tempPositionPoint.elements,$S=NaN,$Y=NaN,$x=Math.cos(this.angle),$j=Math.sin(this.angle);switch(this.emitType){case 0:$f?($f.seed=$n[16],$H._randomPointInsideUnitCircle($R._tempPositionPoint,$f),$n[16]=$f.seed):$H._randomPointInsideUnitCircle($R._tempPositionPoint),$S=$u[0],$Y=$u[1],$T[0]=$S*this.radius,$T[1]=$Y*this.radius,$T[2]=0,this.randomDirection?($f?($f.seed=$n[17],$H._randomPointInsideUnitCircle($R._tempDirectionPoint,$f),$n[17]=$f.seed):$H._randomPointInsideUnitCircle($R._tempDirectionPoint),$L=$R._tempDirectionPoint.elements,$k[0]=$L[0]*$j,$k[1]=$L[1]*$j):($k[0]=$S*$j,$k[1]=$Y*$j),$k[2]=$x;break;case 1:$f?($f.seed=$n[16],$H._randomPointUnitCircle($R._tempPositionPoint,$f),$n[16]=$f.seed):$H._randomPointUnitCircle($R._tempPositionPoint),$S=$u[0],$Y=$u[1],$T[0]=$S*this.radius,$T[1]=$Y*this.radius,$T[2]=0,this.randomDirection?($f?($f.seed=$n[17],$H._randomPointInsideUnitCircle($R._tempDirectionPoint,$f),$n[17]=$f.seed):$H._randomPointInsideUnitCircle($R._tempDirectionPoint),$L=$R._tempDirectionPoint.elements,$k[0]=$L[0]*$j,$k[1]=$L[1]*$j):($k[0]=$S*$j,$k[1]=$Y*$j),$k[2]=$x;break;case 2:$f?($f.seed=$n[16],$H._randomPointInsideUnitCircle($R._tempPositionPoint,$f)):$H._randomPointInsideUnitCircle($R._tempPositionPoint),$S=$u[0],$Y=$u[1],$T[0]=$S*this.radius,$T[1]=$Y*this.radius,$k[$T[2]=0]=$S*$j,$k[1]=$Y*$j,$k[2]=$x,$kh.normalize($h,$h),$f?($kh.scale($h,this.length*$f.getFloat(),$h),$n[16]=$f.seed):$kh.scale($h,this.length*Math.random(),$h),$kh.add($J,$h,$J),this.randomDirection&&($f?($f.seed=$n[17],$H._randomPointUnitSphere($h,$f),$n[17]=$f.seed):$H._randomPointUnitSphere($h));break;case 3:$f?($f.seed=$n[16],$H._randomPointUnitCircle($R._tempPositionPoint,$f)):$H._randomPointUnitCircle($R._tempPositionPoint),$S=$u[0],$Y=$u[1],$T[0]=$S*this.radius,$T[1]=$Y*this.radius,$k[$T[2]=0]=$S*$j,$k[1]=$Y*$j,$k[2]=$x,$kh.normalize($h,$h),$f?($kh.scale($h,this.length*$f.getFloat(),$h),$n[16]=$f.seed):$kh.scale($h,this.length*Math.random(),$h),$kh.add($J,$h,$J),this.randomDirection&&($f?($f.seed=$n[17],$H._randomPointUnitSphere($h,$f),$n[17]=$f.seed):$H._randomPointUnitSphere($h));break;default:throw new Error("ConeShape:emitType is invalid.");}},$J.cloneTo=function($J){$f.prototype.cloneTo.call(this,$J);var $h=$J;$h.angle=this.angle,$h.radius=this.radius,$h.length=this.length,$h.emitType=this.emitType,$h.randomDirection=this.randomDirection;},$j($R,["_tempPositionPoint",function(){return this._tempPositionPoint=new $Th();},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new $Th();}]);}($a),function($f){function $J(){this.radius=NaN,this.emitFromShell=!1,$J.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1;}$l($J,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",$f);var $h=$J.prototype;$h._getShapeBoundBox=function($J){var $h=$J.min.elements;$h[0]=$h[1]=$h[2]=-this.radius;var $f=$J.max.elements;$f[0]=$f[1]=this.radius,$f[2]=0;},$h._getSpeedBoundBox=function($J){var $h=$J.min.elements;$h[0]=$h[1]=-1,$h[2]=0;var $f=$J.max.elements;$f[0]=$f[1]=$f[2]=1;},$h.generatePositionAndDirection=function($J,$h,$f,$n){var $L=$J.elements;$f?($f.seed=$n[16],this.emitFromShell?$H._randomPointUnitSphere($J,$f):$H._randomPointInsideUnitSphere($J,$f),$n[16]=$f.seed):this.emitFromShell?$H._randomPointUnitSphere($J):$H._randomPointInsideUnitSphere($J),$kh.scale($J,this.radius,$J);var $T=$L[2];$T<0&&($L[2]=-1*$T),this.randomDirection?$f?($f.seed=$n[17],$H._randomPointUnitSphere($h,$f),$n[17]=$f.seed):$H._randomPointUnitSphere($h):$J.cloneTo($h);},$h.cloneTo=function($J){$f.prototype.cloneTo.call(this,$J);var $h=$J;$h.radius=this.radius,$h.emitFromShell=this.emitFromShell,$h.randomDirection=this.randomDirection;};}($a),function($f){function $J(){this.radius=NaN,this.emitFromShell=!1,$J.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1;}$l($J,"laya.d3.core.particleShuriKen.module.shape.SphereShape",$f);var $h=$J.prototype;$h._getShapeBoundBox=function($J){var $h=$J.min.elements;$h[0]=$h[1]=$h[2]=-this.radius;var $f=$J.max.elements;$f[0]=$f[1]=$f[2]=this.radius;},$h._getSpeedBoundBox=function($J){var $h=$J.min.elements;$h[0]=$h[1]=$h[2]=-1;var $f=$J.max.elements;$f[0]=$f[1]=$f[2]=1;},$h.generatePositionAndDirection=function($J,$h,$f,$n){$f?($f.seed=$n[16],this.emitFromShell?$H._randomPointUnitSphere($J,$f):$H._randomPointInsideUnitSphere($J,$f),$n[16]=$f.seed):this.emitFromShell?$H._randomPointUnitSphere($J):$H._randomPointInsideUnitSphere($J),$kh.scale($J,this.radius,$J),this.randomDirection?$f?($f.seed=$n[17],$H._randomPointUnitSphere($h,$f),$n[17]=$f.seed):$H._randomPointUnitSphere($h):$J.cloneTo($h);},$h.cloneTo=function($J){$f.prototype.cloneTo.call(this,$J);var $h=$J;$h.radius=this.radius,$h.emitFromShell=this.emitFromShell,$h.randomDirection=this.randomDirection;};}($a),function($J){function $h(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,$h.__super.call(this);}return $l($h,"laya.d3.core.render.SubMeshRenderElement",$$),$h;}()),$Dh=function($J){function $o($J,$h,$f,$n,$L,$T){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=$J,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[$lh.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[$vh.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[$vh.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[$Gh.SHADERDEFINE_ALPHATEST]="ALPHATEST";$o.__super.call(this,$J,$h,$f,null,{}),this._attributeMap=$n;var $k;for($k in $L){var $u=$L[$k];switch($u[1]){case 0:this._renderElementUniformMap[$k]=$u[0];break;case 1:this._materialUniformMap[$k]=$u[0];break;case 2:this._spriteUniformMap[$k]=$u[0];break;case 3:this._cameraUniformMap[$k]=$u[0];break;case 4:this._sceneUniformMap[$k]=$u[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.");}}}$l($o,"laya.d3.shader.ShaderCompile3D",$s);var $h=$o.prototype;return $h._definesToNameDic=function($J,$h){for(var $f={},$n=1,$L=0;$L<32&&!($J<($n=1<<$L));$L++)if($J&$n){var $T=$h[$n];$T&&($f[$T]="");}return $f;},$h.withCompile=function($J,$h,$f,$n){var $L,$T,$k;if($T=this.sharders[$J]){if($k=$T[$h]){if($L=$k[$f])return $L;}else $k=$T[$h]=[];}else $k=($T=this.sharders[$J]=[])[$h]=[];var $u,$S=this._definesToNameDic($J,$o._globalInt2name),$Y=this._definesToNameDic($h,this._spriteInt2name),$x=this._definesToNameDic($f,this._materialInt2name),$j={},$R="";if($S)for($u in $S)$R+="#define "+$u+"\n",$j[$u]=!0;if($Y)for($u in $Y)$R+="#define "+$u+"\n",$j[$u]=!0;if($x)for($u in $x)$R+="#define "+$u+"\n",$j[$u]=!0;var $l=$Zh.nameKey.getName(this._name)+" compile ("+$J+","+$h+","+$f+")",$i=this._VS.toscript($j,[]),$q=this._PS.toscript($j,[]);$P.now();if($L=$Zh.create($R+$i.join("\n"),$R+$q.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,$n,$l),$k[$f]=$L,laya.d3.shader.ShaderCompile3D.debugMode)$P.now();return $L;},$h.precompileShaderWithShaderDefine=function($J,$h,$f){this.withCompile($J,$h,$f,!0);},$h.addMaterialDefines=function($J){var $h=$J.defines;for(var $f in $h){var $n=$h[$f],$L=parseInt($f);this._materialInt2name[$L]=$n,this._materialName2Int[$n]=$L;}},$h.addSpriteDefines=function($J){var $h=$J.defines;for(var $f in $h){var $n=$h[$f],$L=parseInt($f);this._spriteInt2name[$L]=$n,this._spriteName2Int[$n]=$L;}},$h.getMaterialDefineByName=function($J){return this._materialName2Int[$J];},$h.registerMaterialDefine=function($J){var $h=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[$h]=$J,this._materialName2Int[$J]=$h;},$h.registerSpriteDefine=function($J){var $h=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[$h]=$J,this._spriteName2Int[$J]=$h;},$o._globalRegDefine=function($J,$h){$o._globalInt2name[$h]=$J;},$o.add=function($J,$h,$f,$n,$L){return laya.d3.shader.ShaderCompile3D._preCompileShader[$J]=new $o($J,$h,$f,$n,$L,$s.includes);},$o.get=function($J){return laya.d3.shader.ShaderCompile3D._preCompileShader[$Zh.nameKey.getID($J)];},$o._preCompileShader={},$o._globalInt2name=[],$o.debugMode=!1,$o.SHADERDEFINE_HIGHPRECISION=1,$o.SHADERDEFINE_FOG=4,$o.SHADERDEFINE_DIRECTIONLIGHT=8,$o.SHADERDEFINE_POINTLIGHT=16,$o.SHADERDEFINE_SPOTLIGHT=32,$o.SHADERDEFINE_UV0=64,$o.SHADERDEFINE_COLOR=128,$o.SHADERDEFINE_UV1=256,$o.SAHDERDEFINE_DEPTHFOG=131072,$o;}(),$gh=function($J){function $i(){$i.__super.call(this);}$l($i,"laya.d3.graphics.MeshSprite3DStaticBatchManager",$nJ);var $h=$i.prototype;return $h._getStaticBatch=function($J,$h,$f,$n){var $L,$T;return $T=$J?$J.id.toString()+$f.id.toString()+$h.id.toString()+$n.toString():$f.id.toString()+$h.id.toString()+$n.toString(),this._staticBatches[$T]?$L=this._staticBatches[$T]:this._staticBatches[$T]=$L=new $Fh($T,this,$J,$h,$f),$L;},$h._initStaticBatchs=function($J){var $h,$f;this._initBatchRenderElements.sort($i._sortPrepareStaticBatch);for(var $n,$L=!1,$T=0,$k=0,$u=this._initBatchRenderElements.length;$k<$u;$k++){var $S,$Y=this._initBatchRenderElements[$k],$x=$Y.renderObj._getVertexBuffer(0);$Y._sprite3D;if($f===$x.vertexDeclaration&&$h===$Y._material){if($L)$n._addCombineBatchRenderObjTest($Y)?($S=$Y._staticBatch)!==$n&&($S&&$S._deleteCombineBatchRenderObj($Y),$n._addCombineBatchRenderObj($Y)):($L=!1,$T++);else{var $j=this._initBatchRenderElements[$k-1],$R=$j.renderObj,$l=$Y.renderObj;$L=!(65535<$R._getVertexBuffer().vertexCount+$l._getVertexBuffer().vertexCount)&&($n=this._getStaticBatch($J,$f,$h,$T),($S=$j._staticBatch)!==$n&&($S&&$S._deleteCombineBatchRenderObj($j),$n._addCombineBatchRenderObj($j)),($S=$Y._staticBatch)!==$n&&($S&&$S._deleteCombineBatchRenderObj($Y),$n._addCombineBatchRenderObj($Y)),!0);}}else $L=!1,$T=0;$h=$Y._material,$f=$x.vertexDeclaration;}},$i._sortPrepareStaticBatch=function($J,$h){var $f=$J._render,$n=$h._render,$L=$f.lightmapIndex-$n.lightmapIndex;if(0!=$L)return $L;var $T=$f.receiveShadow-$n.receiveShadow;if(0!=$T)return $T;var $k=$J._mainSortID-$h._mainSortID;return 0==$k?$J.renderObj.triangleCount-$h.renderObj.triangleCount:$k;},$i;}(),$Fh=function($J){function $T($J,$h,$f,$n,$L){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,$T.__super.call(this,$J,$h,$f),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=$n,this._material=$L;}$l($T,"laya.d3.graphics.SubMeshStaticBatch",$LJ);var $h=$T.prototype;return $h._compareBatchRenderElement=function($J,$h){return $J._batchIndexStart>$h._batchIndexStart;},$h._addCombineBatchRenderObjTest=function($J){var $h=$J.renderObj._vertexCount;return!(65535<(0<$h?this._currentCombineVertexCount+$h:this._currentCombineVertexCount+$J.renderObj._getVertexBuffer().vertexCount));},$h._addCombineBatchRenderObj=function($J){var $h=$J.renderObj,$f=$h._vertexCount;this._initBatchRenderElements.push($J),$J._staticBatch=this,0<$f?(this._currentCombineIndexCount+=$h._indexCount,this._currentCombineVertexCount+=$f):(this._currentCombineIndexCount=this._currentCombineIndexCount+$h._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$h._getVertexBuffer().vertexCount),this._needFinishCombine=!0;},$h._deleteCombineBatchRenderObj=function($J){var $h=$J.renderObj,$f=this._initBatchRenderElements.indexOf($J);if(-1!==$f){this._initBatchRenderElements.splice($f,1),$J._staticBatch=null;var $n=$h._vertexCount;0<$n?(this._currentCombineIndexCount=this._currentCombineIndexCount-$h._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$n):(this._currentCombineIndexCount=this._currentCombineIndexCount-$h._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$h._getVertexBuffer().vertexCount),this._needFinishCombine=!0;}},$h._finishInit=function(){if(this._needFinishCombine){var $J=0,$h=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var $f=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),$n=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=$ah.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=$ch.create("ushort",this._currentCombineIndexCount,35044);for(var $L=0,$T=this._initBatchRenderElements.length;$L<$T;$L++){var $k=this._initBatchRenderElements[$L],$u=$k.renderObj,$S=$u._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,$k._sprite3D),$Y=$u.getIndices(),$x=$k._sprite3D.transform._isFrontFaceInvert,$j=$J/(this._vertexDeclaration.vertexStride/4)-$u._vertexStart,$R=$h,$l=$R+$Y.length;$k._batchIndexStart=$R,$k._batchIndexEnd=$l,$n.set($Y,$h);var $i=0;if($x)for($i=$R;$i<$l;$i+=3){$n[$i]=$j+$n[$i];var $q=$n[$i+1],$o=$n[$i+2];$n[$i+1]=$j+$o,$n[$i+2]=$j+$q;}else for($i=$R;$i<$l;$i+=3)$n[$i]=$j+$n[$i],$n[$i+1]=$j+$n[$i+1],$n[$i+2]=$j+$n[$i+2];$h+=$Y.length,$f.set($S,$J),$J+=$S.length;}this._vertexBuffer.setData($f),this._indexBuffer.setData($n),this._needFinishCombine=!1;}},$h._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new $Qh());},$h._getRenderElement=function($J,$h,$f){for(var $n,$L,$T=this._batchRenderElements.length,$k=!0,$u=0;$u<$T;$u++){var $S,$Y,$x=($L=this._batchRenderElements[$u])._sprite3D._render;if(0!==$u&&($k=($S=($n=this._batchRenderElements[$u-1])._sprite3D._render).lightmapIndex!==$x.lightmapIndex||$S.receiveShadow!==$x.receiveShadow||$n._batchIndexEnd!==$L._batchIndexStart),$k){($Y=this._getCombineRenderElementFromPool()).renderObj=this,$Y._material=this._material,$Y._batchIndexStart=$L._batchIndexStart,$Y._batchIndexEnd=$L._batchIndexEnd;var $j=$x.lightmapIndex,$R=$j+1,$l=this._batchOwnerIndices[$R];$l||($l=this._batchOwnerIndices[$R]=[]);var $i,$q=$l[$L._render.receiveShadow?1:0];void 0===$q?($l[$x.receiveShadow?1:0]=this._batchOwners.length,($i=new $Mh(null,"StaticBatchMeshSprite3D"))._scene=$h,$i._transform=this._rootOwner?this._rootOwner._transform:null,$i._render.lightmapIndex=$j,$i._render.receiveShadow=$L._render.receiveShadow,this._batchOwners.push($i)):$i=this._batchOwners[$q],$i._render._renderUpdate($f),$Y._sprite3D=$i,$J.push($Y);}else $Y._batchIndexEnd=$L._batchIndexEnd;}},$h._beforeRender=function($J){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0;},$h._render=function($J){var $h=$J.renderElement,$f=$h._batchIndexStart,$n=$h._batchIndexEnd-$f;$y.mainContext.drawElements(4,$n,5123,2*$f),$D.drawCall++,$D.trianglesFaces+=$n/3;},$h.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy();},$h._getVertexBuffer=function($J){return void 0===$J&&($J=0),this._vertexBuffer;},$T;}(),$Ah=function($J){function $h(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,$h.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[];}$l($h,"laya.d3.core.ComponentNode",$Y);var $f=$h.prototype;return $f.addComponent=function($J){var $h,$f=this._componentsMap.indexOf($J);if(-1===$f)$h=[],this._componentsMap.push($J),this._typeComponentsIndices.push($h);else if($h=this._typeComponentsIndices[$f],this._components[$h[0]].isSingleton)throw new Error("无法单实例创建"+$J+"组件，"+$J+"组件已存在！");var $n=$L.getInstance($J);return $h.push(this._components.length),this._components.push($n),$n instanceof laya.d3.component.Script&&this._scripts.push($n),$n._initialize(this),$n;},$f._removeComponent=function($J,$h){var $f=this._typeComponentsIndices[$J],$n=$f[$h],$L=this._components[$n];this._components.splice($n,1),$L instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($L),1),$f.splice($h,1),0===$f.length&&(this._typeComponentsIndices.splice($J,1),this._componentsMap.splice($J,1));for(var $T=0,$k=this._componentsMap.length;$T<$k;$T++)for(var $u=($f=this._typeComponentsIndices[$T]).length-1;0<=$u;$u--){var $S=$f[$u];if(!($n<$S))break;$f[$u]=--$S;}$L._destroy();},$f.getComponentByType=function($J,$h){void 0===$h&&($h=0);var $f=this._componentsMap.indexOf($J);return-1===$f?null:this._components[this._typeComponentsIndices[$f][$h]];},$f.getComponentsByType=function($J,$h){var $f=this._componentsMap.indexOf($J);if(-1!==$f){var $n=this._typeComponentsIndices[$f],$L=$n.length;$h.length=$L;for(var $T=0;$T<$L;$T++)$h[$T]=this._components[$n[$T]];}else $h.length=0;},$f.getComponentByIndex=function($J){return this._components[$J];},$f.removeComponentByType=function($J,$h){void 0===$h&&($h=0);var $f=this._componentsMap.indexOf($J);-1!==$f&&this._removeComponent($f,$h);},$f.removeComponentsByType=function($J){var $h=this._componentsMap.indexOf($J);if(-1!==$h)for(var $f=this._typeComponentsIndices[$h],$n=0,$L=$f.length;$n<$L;$f.length<$L?$L--:$n++)this._removeComponent($h,$n);},$f.removeAllComponent=function(){for(var $J=0,$h=this._componentsMap.length;$J<$h;this._componentsMap.length<$h?$h--:$J++)this.removeComponentsByType(this._componentsMap[$J]);},$f._updateComponents=function($J){for(var $h=0,$f=this._components.length;$h<$f;$h++){var $n=this._components[$h];!$n.started&&($n._start($J),$n.started=!0),$n.enable&&$n._update($J);}},$f._lateUpdateComponents=function($J){for(var $h=0;$h<this._components.length;$h++){var $f=this._components[$h];!$f.started&&($f._start($J),$f.started=!0),$f.enable&&$f._lateUpdate($J);}},$f._preRenderUpdateComponents=function($J){for(var $h=0;$h<this._components.length;$h++){var $f=this._components[$h];!$f.started&&($f._start($J),$f.started=!0),$f.enable&&$f._preRenderUpdate($J);}},$f._postRenderUpdateComponents=function($J){for(var $h=0;$h<this._components.length;$h++){var $f=this._components[$h];!$f.started&&($f._start($J),$f.started=!0),$f.enable&&$f._postRenderUpdate($J);}},$h;}(),$Gh=function($n){function $J(){$J.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new $Rh(),this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new $uh(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0;}$l($J,"laya.d3.core.material.BaseMaterial",$n);var $h=$J.prototype;return $p.imps($h,{"laya.d3.core.IClone":!0}),$h._addShaderDefine=function($J){this._shaderDefineValue|=$J;},$h._removeShaderDefine=function($J){this._shaderDefineValue&=~$J;},$h._addDisablePublicShaderDefine=function($J){this._disablePublicShaderDefine|=$J;},$h._removeDisablePublicShaderDefine=function($J){this._disablePublicShaderDefine&=~$J;},$h._setBuffer=function($J,$h){this._shaderValues.setValue($J,$h),this._values[$J]=$h;},$h._getBuffer=function($J){return this._values[$J];},$h._setMatrix4x4=function($J,$h){this._shaderValues.setValue($J,$h?$h.elements:null),this._values[$J]=$h;},$h._getMatrix4x4=function($J){return this._values[$J];},$h._setInt=function($J,$h){this._shaderValues.setValue($J,$h),this._values[$J]=$h;},$h._getInt=function($J){return this._values[$J];},$h._setNumber=function($J,$h){this._shaderValues.setValue($J,$h),this._values[$J]=$h;},$h._getNumber=function($J){return this._values[$J];},$h._setBool=function($J,$h){this._shaderValues.setValue($J,$h),this._values[$J]=$h;},$h._getBool=function($J){return this._values[$J];},$h._setVector2=function($J,$h){this._shaderValues.setValue($J,$h?$h.elements:null),this._values[$J]=$h;},$h._getVector2=function($J){return this._values[$J];},$h._setColor=function($J,$h){this._shaderValues.setValue($J,$h?$h.elements:null),this._values[$J]=$h;},$h._getColor=function($J){return this._values[$J];},$h._setTexture=function($J,$h){var $f=this._values[$J];this._values[$J]=$h,this._shaderValues.setValue($J,$h),0<this.referenceCount&&($f&&$f._removeReference(),$h&&$h._addReference());},$h._getTexture=function($J){return this._values[$J];},$h._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data);},$h._getShader=function($J,$h,$f){var $n=($J|$h)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile($n,$f,this._shaderDefineValue),this._shader;},$h._setRenderStateBlendDepth=function(){var $J=$y.mainContext;switch($O.setDepthMask($J,this.depthWrite),0===this.depthTest?$O.setDepthTest($J,!1):($O.setDepthTest($J,!0),$O.setDepthFunc($J,this.depthTest)),this.blend){case 0:$O.setBlend($J,!1);break;case 1:$O.setBlend($J,!0),$O.setBlendFunc($J,this.srcBlend,this.dstBlend);break;case 2:$O.setBlend($J,!0);}},$h._setRenderStateFrontFace=function($J,$h){var $f=$y.mainContext,$n=0;switch(this.cull){case 0:$O.setCullFace($f,!1);break;case 1:$O.setCullFace($f,!0),$n=$J?$h&&$h._isFrontFaceInvert?2305:2304:$h&&$h._isFrontFaceInvert?2304:2305,$O.setFrontFace($f,$n);break;case 2:$O.setCullFace($f,!0),$n=$J?$h&&$h._isFrontFaceInvert?2304:2305:$h&&$h._isFrontFaceInvert?2305:2304,$O.setFrontFace($f,$n);}},$h.onAsynLoaded=function($J,$h,$f){var $n=$h[0],$L=$h[1];switch($n.version){case"LAYAMATERIAL:01":var $T=0,$k=0,$u=$n.props;for(var $S in $u)switch($S){case"vectors":var $Y=$u[$S];for($T=0,$k=$Y.length;$T<$k;$T++){var $x=$Y[$T],$j=$x.value;switch($j.length){case 2:this[$x.name]=new $Th($j[0],$j[1]);break;case 3:this[$x.name]=new $kh($j[0],$j[1],$j[2]);break;case 4:this[$x.name]=new $uh($j[0],$j[1],$j[2],$j[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.");}}break;case"textures":var $R=$u[$S];for($T=0,$k=$R.length;$T<$k;$T++){var $l=$R[$T],$i=$l.path;$i&&(this[$l.name]=$r.getRes($L[$i]));}break;case"defines":var $q=$u[$S];for($T=0,$k=$q.length;$T<$k;$T++){var $o=this._shaderCompile.getMaterialDefineByName($q[$T]);this._addShaderDefine($o);}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[$S]=$u[$S];break;case"renderQueue":switch($u[$S]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3;}break;default:this[$S]=$u[$S];}break;case"LAYAMATERIAL:02":for($S in $u=$n.props)switch($S){case"vectors":for($T=0,$k=($Y=$u[$S]).length;$T<$k;$T++)switch(($j=($x=$Y[$T]).value).length){case 2:this[$x.name]=new $Th($j[0],$j[1]);break;case 3:this[$x.name]=new $kh($j[0],$j[1],$j[2]);break;case 4:this[$x.name]=new $uh($j[0],$j[1],$j[2],$j[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.");}break;case"textures":for($T=0,$k=($R=$u[$S]).length;$T<$k;$T++)($i=($l=$R[$T]).path)&&(this[$l.name]=$r.getRes($L[$i]));break;case"defines":for($T=0,$k=($q=$u[$S]).length;$T<$k;$T++)$o=this._shaderCompile.getMaterialDefineByName($q[$T]),this._addShaderDefine($o);break;default:this[$S]=$u[$S];}break;default:throw new Error("BaseMaterial:unkonwn version.");}this._endLoaded();},$h._addReference=function(){$n.prototype._addReference.call(this);for(var $J=0,$h=this._values.length;$J<$h;$J++){var $f=this._values[$J];$f&&$f instanceof laya.d3.resource.BaseTexture&&$f._addReference();}},$h._removeReference=function(){$n.prototype._removeReference.call(this);for(var $J=0,$h=this._values.length;$J<$h;$J++){var $f=this._values[$J];$f&&$f instanceof laya.d3.resource.BaseTexture&&$f._removeReference();}},$h.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null;},$h.setShaderName=function($J){var $h=$Zh.nameKey.getID($J);if(-1===$h)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=$Dh._preCompileShader[$h];},$h.cloneTo=function($J){var $h=$J;$h.name=this.name,$h.cull=this.cull,$h.blend=this.blend,$h.srcBlend=this.srcBlend,$h.dstBlend=this.dstBlend,$h.srcBlendRGB=this.srcBlendRGB,$h.dstBlendRGB=this.dstBlendRGB,$h.srcBlendAlpha=this.srcBlendAlpha,$h.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo($h.blendConstColor),$h.blendEquation=this.blendEquation,$h.blendEquationRGB=this.blendEquationRGB,$h.blendEquationAlpha=this.blendEquationAlpha,$h.depthTest=this.depthTest,$h.depthWrite=this.depthWrite,$h.renderQueue=this.renderQueue,$h._shader=this._shader,$h._disablePublicShaderDefine=this._disablePublicShaderDefine,$h._shaderDefineValue=this._shaderDefineValue;var $f,$n=0,$L=$h._shaderValues;$h._shaderValues.data.length=this._shaderValues.data.length;var $T=this._values.length,$k=$h._values;for($n=0,$f=$k.length=$T;$n<$f;$n++){var $u=this._values[$n];if($u)if("number"==typeof $u)$k[$n]=$u,$L.data[$n]=$u;else if("number"==typeof $u&&Math.floor($u)==$u)$k[$n]=$u,$L.data[$n]=$u;else if("boolean"==typeof $u)$k[$n]=$u,$L.data[$n]=$u;else if($u instanceof laya.d3.math.Vector2){var $S=$k[$n]||($k[$n]=new $Th());$u.cloneTo($S),$L.data[$n]=$S.elements;}else if($u instanceof laya.d3.math.Vector3){var $Y=$k[$n]||($k[$n]=new $kh());$u.cloneTo($Y),$L.data[$n]=$Y.elements;}else if($u instanceof laya.d3.math.Vector4){var $x=$k[$n]||($k[$n]=new $uh());$u.cloneTo($x),$L.data[$n]=$x.elements;}else if($u instanceof laya.d3.math.Matrix4x4){var $j=$k[$n]||($k[$n]=new $Jh());$u.cloneTo($j),$L.data[$n]=$j.elements;}else $u instanceof laya.d3.resource.BaseTexture&&($k[$n]=$u,$L.data[$n]=$u);}},$h.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$i(0,$h,"alphaTestValue",function(){return this._getNumber(0);},function($J){this._setNumber(0,$J);}),$i(0,$h,"alphaTest",function(){return this._alphaTest;},function($J){(this._alphaTest=$J)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST);}),$J.__init__=function(){$J.SHADERDEFINE_ALPHATEST=$J.shaderDefines.registerDefine("ALPHATEST");},$J.RENDERQUEUE_OPAQUE=2e3,$J.RENDERQUEUE_ALPHATEST=2450,$J.RENDERQUEUE_TRANSPARENT=3e3,$J.CULL_NONE=0,$J.CULL_FRONT=1,$J.CULL_BACK=2,$J.BLEND_DISABLE=0,$J.BLEND_ENABLE_ALL=1,$J.BLEND_ENABLE_SEPERATE=2,$J.BLENDPARAM_ZERO=0,$J.BLENDPARAM_ONE=1,$J.BLENDPARAM_SRC_COLOR=768,$J.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,$J.BLENDPARAM_DST_COLOR=774,$J.BLENDPARAM_ONE_MINUS_DST_COLOR=775,$J.BLENDPARAM_SRC_ALPHA=770,$J.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,$J.BLENDPARAM_DST_ALPHA=772,$J.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,$J.BLENDPARAM_SRC_ALPHA_SATURATE=776,$J.BLENDEQUATION_ADD=0,$J.BLENDEQUATION_SUBTRACT=1,$J.BLENDEQUATION_REVERSE_SUBTRACT=2,$J.DEPTHTEST_OFF=0,$J.DEPTHTEST_NEVER=512,$J.DEPTHTEST_LESS=513,$J.DEPTHTEST_EQUAL=514,$J.DEPTHTEST_LEQUAL=515,$J.DEPTHTEST_GREATER=516,$J.DEPTHTEST_NOTEQUAL=517,$J.DEPTHTEST_GEQUAL=518,$J.DEPTHTEST_ALWAYS=519,$J.SHADERDEFINE_ALPHATEST=1,$J.ALPHATESTVALUE=0,$j($J,["shaderDefines",function(){return this.shaderDefines=new $xh();}]),$J;}($o),$yh=function($J){function $h(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,$h.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1;}$l($h,"laya.d3.resource.BaseTexture",$o);var $f=$h.prototype;return $i(0,$f,"width",function(){return this._width;}),$i(0,$f,"repeat",function(){return this._repeat;},function($J){if(this._repeat!==$J&&(this._repeat=$J,this._source)){var $h=$y.mainContext;$O.bindTexture($h,this._type,this._source),$d.isPOT(this._width,this._height)&&this._repeat?($h.texParameteri(this._type,10242,10497),$h.texParameteri(this._type,10243,10497)):($h.texParameteri(this._type,10242,33071),$h.texParameteri(this._type,10243,33071));}}),$i(0,$f,"height",function(){return this._height;}),$i(0,$f,"magFifter",function(){return this._magFifter;},function($J){(this._magFifter=$J)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter($J);}),$i(0,$f,"wrapModeV",function(){return this._wrapModeV;}),$i(0,$f,"size",function(){return this._size;}),$i(0,$f,"wrapModeU",function(){return this._wrapModeU;}),$i(0,$f,"mipmap",function(){return this._mipmap;},function($J){this._mipmap=$J,this._mipmap!=$J&&this._conchTexture&&this._conchTexture.setMipMap($J);}),$i(0,$f,"minFifter",function(){return this._minFifter;},function($J){this._minFifter=$J,this._minFifter!=$J&&this._conchTexture&&this._conchTexture.setMinFifter($J);}),$i(0,$f,"format",function(){return this._format;}),$i(0,$f,"source",function(){return this.activeResource(),this._source;}),$i(0,$f,"defaulteTexture",function(){return $eh.grayTexture;}),$h.WARPMODE_REPEAT=0,$h.WARPMODE_CLAMP=1,$h;}(),$Oh=function($J){function $h(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,$h.__super.call(this),this._boundingBoxCorners=$n(8,null);}$l($h,"laya.d3.resource.models.BaseMesh",$o);var $f=$h.prototype;return $f._getPositions=function(){throw new Error("未Override,请重载该属性！");},$f._generateBoundingObject=function(){this._boundingSphere=new $NJ(new $kh(),0),$NJ.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new $wJ(new $kh(),new $kh()),$wJ.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners);},$f.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！");},$f.getRenderElement=function($J){throw new Error("未Override,请重载该属性！");},$i(0,$f,"subMeshCount",function(){return this._subMeshCount;}),$i(0,$f,"boundingBox",function(){return this._boundingBox;}),$i(0,$f,"boundingBoxCorners",function(){return this._boundingBoxCorners;}),$i(0,$f,"boundingSphere",function(){return this._boundingSphere;}),$h;}(),$Ph=(function($J){function $h(){$h.__super.call(this);}$l($h,"laya.d3.component.Script",$sh);var $f=$h.prototype;$f.onTriggerEnter=function($J){},$f.onTriggerExit=function($J){},$f.onTriggerStay=function($J){},$i(0,$f,"isSingleton",function(){return $h._isSingleton;}),$h._isSingleton=!1;}(),function($J){function $h($J){this._owner=null,this._sharedMesh=null,$h.__super.call(this),this._owner=$J;}$l($h,"laya.d3.core.MeshFilter",$J);var $f=$h.prototype;return $f._sharedMeshLoaded=function(){this.event("loaded");},$f._destroy=function(){$J.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null);},$i(0,$f,"sharedMesh",function(){return this._sharedMesh;},function($J){var $h=this._sharedMesh;$h&&$h._removeReference(),(this._sharedMesh=$J)._addReference(),this.event("meshchanged",[this,$h,$J]),$J.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded);}),$i(0,$f,"_isAsyncLoaded",function(){return this._sharedMesh.loaded;}),$i(0,$f,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners;}),$i(0,$f,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere;}),$i(0,$f,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox;}),$h;}($dh)),$Wh=function($J){function $h($J){$h.__super.call(this,$J),$J.meshFilter.on("meshchanged",this,this._onMeshChanged);}$l($h,"laya.d3.core.MeshRender",$ph);var $f=$h.prototype;return $f._onMeshChanged=function($J,$h,$f){$f.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:$f.once("loaded",this,this._onMeshLoaed);},$f._onMeshLoaed=function($J,$h){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0;},$f._calculateBoundingSphereByInitSphere=function($J){var $h=NaN,$f=this._owner.transform,$n=$f.scale.elements,$L=Math.abs($n[0]),$T=Math.abs($n[1]),$k=Math.abs($n[2]);$h=$T<=$L&&$k<=$L?$L:$k<=$T?$T:$k,$kh.transformCoordinate($J.center,$f.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=$J.radius*$h;},$f._calculateBoundBoxByInitCorners=function($J){for(var $h=this._owner.transform.worldMatrix,$f=0;$f<8;$f++)$kh.transformCoordinate($J[$f],$h,$ph._tempBoundBoxCorners[$f]);$wJ.createfromPoints($ph._tempBoundBoxCorners,this._boundingBox);},$f._calculateBoundingSphere=function(){var $J=this._owner.meshFilter.sharedMesh;null==$J||null==$J.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere($J.boundingSphere);},$f._calculateBoundingBox=function(){var $J=this._owner.meshFilter.sharedMesh;null==$J||null==$J.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners($J.boundingBoxCorners);},$f._renderUpdate=function($J){var $h=this._owner.transform;if($h){this._setShaderValueMatrix4x4(0,$h.worldMatrix);var $f=this._owner.getProjectionViewWorldMatrix($J);this._setShaderValueMatrix4x4(1,$f);}else this._setShaderValueMatrix4x4(0,$Jh.DEFAULT),this._setShaderValueMatrix4x4(1,$J);return $rh.debugMode&&this._renderRenderableBoundBox(),!0;},$h;}(),$Ih=function($h){function $n(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,$n.__super.call(this),this._renderState=new $X(),this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new $Rh(),this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new $hJ(),this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new $kh(.7,.7,.7),this.ambientColor=new $kh(.212,.227,.259),$y.shaderHighPrecision&&this.addShaderDefine($Dh.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[];}$l($n,"laya.d3.core.scene.Scene",$h);var $J=$n.prototype;return $p.imps($J,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),$J._setUrl=function($J){this._url=$J;},$J._getGroup=function(){return this._group;},$J._setGroup=function($J){this._group=$J;},$J._display=function(){$p.stage._scenes.push(this),$p.stage._scenes.sort($n._sortScenes);for(var $J=0,$h=this._childs.length;$J<$h;$J++){var $f=this._childs[$J];$f.active&&$f._activeHierarchy();}},$J._unDisplay=function(){var $J=$p.stage._scenes;$J.splice($J.indexOf(this),1);for(var $h=0,$f=this._childs.length;$h<$f;$h++){var $n=this._childs[$h];$n.active&&$n._inActiveHierarchy();}},$J._addChild3D=function($J){$J.transform._onWorldTransform(),$J._setBelongScene(this),this.displayedInStage&&$J.active&&$J._activeHierarchy();},$J._removeChild3D=function($J){$J.transform.parent=null,this.displayedInStage&&$J.active&&$J._inActiveHierarchy(),$J._setUnBelongScene();},$J.initOctree=function($J,$h,$f,$n,$L){void 0===$L&&($L=6),this.treeSize=new $kh($J,$h,$f),this.treeLevel=$L,this.treeRoot=new $w(this,0),this.treeRoot.init($n,this.treeSize);},$J._prepareUpdateToRenderState=function($J,$h){$h.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,$h.scene=this;},$J._prepareSceneToRender=function($J){var $h=this._lights.length;if(0<$h)for(var $f=0,$n=0;$n<$h&&!(this._lights[$n]._prepareToScene($J)&&++$f>=this._enableLightCount);$n++);},$J._updateChilds=function($J){for(var $h=0,$f=this._childs.length;$h<$f;++$h)this._childs[$h]._update($J);},$J._preRenderScene=function($J,$h,$f){var $n,$L=$h._viewMatrix,$T=$h._projectionMatrix,$k=$h._projectionViewMatrix,$u=0,$S=$h.camera;for($S.useOcclusionCulling?this.treeRoot?$fJ.renderObjectCullingOctree($f,this,$S,$L,$T,$k):$fJ.renderObjectCulling($f,this,$S,$L,$T,$k):$fJ.renderObjectCullingNoBoundFrustum(this,$S,$L,$T,$k),$u=0,$n=this._quenes.length;$u<$n;$u++)this._quenes[$u]&&this._quenes[$u]._preRender($h);},$J._clear=function($J,$h){var $f=$h._viewport,$n=$h.camera,$L=$f.x,$T=$n.renderTargetSize.height-$f.y-$f.height,$k=$f.width,$u=$f.height;$J.viewport($L,$T,$k,$u);var $S=256,$Y=$n.renderTarget;switch($n.clearFlag){case 0:var $x=$n.clearColor;if($x){$J.enable(3089),$J.scissor($L,$T,$k,$u);var $j=$x.elements;$J.clearColor($j[0],$j[1],$j[2],$j[3]),$S|=16384;}if($Y)switch($x||($S=16384),$Y.depthStencilFormat){case 33189:$S|=256;break;case 36168:$S|=1024;break;case 34041:$S|=256,$S|=1024;}$J.clear($S),$x&&$J.disable(3089);break;case 1:case 2:if($Y)switch($S=16384,$Y.depthStencilFormat){case 33189:$S|=256;break;case 36168:$S|=1024;break;case 34041:$S|=256,$S|=1024;}$J.clear($S);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.");}},$J._renderScene=function($J,$h){var $f,$n,$L=$h.camera,$T=0;for($T=0;$T<2;$T++)($n=this._quenes[$T])&&($L.renderTarget?$n._render($h,!0):$n._render($h,!1));if(1===$L.clearFlag){var $k=$L.sky;$k&&($O.setCullFace($J,!1),$O.setDepthFunc($J,515),$O.setDepthMask($J,!1),$k._render($h),$O.setDepthFunc($J,513),$O.setDepthMask($J,!0));}for($T=2,$f=this._quenes.length;$T<$f;$T++)($n=this._quenes[$T])&&($n._sortAlpha($h.camera.transform.position),$L.renderTarget?$n._render($h,!0):$n._render($h,!1));},$J._set3DRenderConfig=function($J){$J.disable(3042),$O._blend=!1,$J.blendFunc(770,771),$O._sFactor=770,$O._dFactor=771,$J.disable(2929),$O._depthTest=!1,$J.enable(2884),$O._cullFace=!0,$J.depthMask(1),$O._depthMask=!0,$J.frontFace(2304),$O._frontFace=2304;},$J._set2DRenderConfig=function($J){$O.setBlend($J,!0),$O.setBlendFunc($J,1,771),$O.setDepthTest($J,!1),$O.setCullFace($J,!1),$O.setDepthMask($J,!0),$O.setFrontFace($J,2305),$J.viewport(0,0,$x.width,$x.height);},$J._parseCustomProps=function($J,$h,$f,$n){var $L=$n.customProps.lightmaps,$T=$L.length,$k=this._lightmaps;$k.length=$T;for(var $u=0;$u<$T;$u++)$k[$u]=$r.getRes($h[$L[$u].replace(".exr",".png")]);this.setlightmaps($k);var $S=$n.customProps.ambientColor;$S&&(this.ambientColor=new $kh($S[0],$S[1],$S[2]));var $Y=$n.customProps.fogColor;$Y&&(this.fogColor=new $kh($Y[0],$Y[1],$Y[2]));},$J._addLight=function($J){this._lights.indexOf($J)<0&&this._lights.push($J);},$J._removeLight=function($J){var $h=this._lights.indexOf($J);0<=$h&&this._lights.splice($h,1);},$J._updateScene=function(){var $J=this._renderState;this._prepareUpdateToRenderState($y.mainContext,$J),this._updateComponents($J),this._updateChilds($J),this._lateUpdateComponents($J),this._time+=$J.elapsedTime/1e3,this._shaderValues.setValue(22,this._time);},$J._updateSceneConch=function(){var $J=this._renderState;this._prepareUpdateToRenderState($y.mainContext,$J),this._updateComponents($J),this._lateUpdateComponents($J),this._prepareSceneToRender($J);for(var $h=0,$f=this._cameraPool.length;$h<$f;$h++){var $n=this._cameraPool[$h];($J.camera=$n)._prepareCameraToRender();}},$J._preRenderShadow=function($J,$h,$f,$n,$L){this.treeRoot?$fJ.renderShadowObjectCullingOctree(this,$h,$f,$n,$L):$fJ.renderShadowObjectCulling(this,$h,$f,$n,$L);for(var $T=0,$k=$f.length;$T<$k;$T++)$f[$T]&&$f[$T]._preRender($J);},$J._renderShadowMap=function($J,$h,$f){var $n=this.parallelSplitShadowMaps[0];$n._calcAllLightCameraInfo($f);var $L,$T,$k,$u=$n.PSSMNum;if(this._preRenderShadow($h,$n._lightCulling,$n._shadowQuenes,$n._lightVPMatrix[0],$u),this.addShaderDefine($lh.SHADERDEFINE_CAST_SHADOW),1<$u)for(var $S=0;$S<$u;$S++)$L=$n.getRenderTarget($S+1),$n.beginRenderTarget($S+1),$J.clearColor(1,1,1,1),$J.clear(16640),$J.viewport(0,0,$L.width,$L.height),$h.camera=$k=$n.getLightCamera($S),$k._prepareCameraToRender(),$k._prepareCameraViewProject($k.viewMatrix,$k.projectionMatrix),$h._projectionViewMatrix=$n._lightVPMatrix[$S+1],($T=$n._shadowQuenes[$S])._preRender($h),$T._renderShadow($h,!1),$n.endRenderTarget($S+1);else $L=$n.getRenderTarget(1),$n.beginRenderTarget(1),$J.clearColor(1,1,1,1),$J.clear(16640),$J.viewport(0,0,$L.width,$L.height),$h.camera=$k=$n.getLightCamera(0),$k._prepareCameraToRender(),$k._prepareCameraViewProject($k.viewMatrix,$k.projectionMatrix),$h._projectionViewMatrix=$n._lightVPMatrix[0],($T=$n._shadowQuenes[0])._preRender($h),$T._renderShadow($h,!0),$n.endRenderTarget(1);this.removeShaderDefine($lh.SHADERDEFINE_CAST_SHADOW);},$J.addTreeNode=function($J){this.treeRoot.addTreeNode($J);},$J.removeTreeNode=function($J){this.treeSize&&$J._treeNode&&$J._treeNode.removeObject($J);},$J.setlightmaps=function($J){this._lightmaps=$J;for(var $h=0,$f=this._renderableSprite3Ds.length;$h<$f;$h++)this._renderableSprite3Ds[$h]._render._applyLightMapParams();},$J.getlightmaps=function(){return this._lightmaps;},$J.addChildAt=function($J,$h){if(!($J instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+($J&&$J.__className));if(!$J||this.destroyed||$J===this)return $J;if($J.zOrder&&this._set$P("hasZorder",!0),0<=$h&&$h<=this._childs.length){if($J._parent===this){var $f=this.getChildIndex($J);this._childs.splice($f,1),this._childs.splice($h,0,$J),this.conchModel&&(this.conchModel.removeChild($J.conchModel),this.conchModel.addChildAt($J.conchModel,$h)),this._childChanged();}else $J.parent&&$J.parent.removeChild($J),this._childs===$Y.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($h,0,$J),this.conchModel&&this.conchModel.addChildAt($J.conchModel,$h),($J.parent=this)._addChild3D($J);return $J;}throw new Error("appendChildAt:The index is out of bounds");},$J.addChild=function($J){if(!($J instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$J||this.destroyed||$J===this)return $J;if($J.zOrder&&this._set$P("hasZorder",!0),$J._parent===this){var $h=this.getChildIndex($J);$h!==this._childs.length-1&&(this._childs.splice($h,1),this._childs.push($J),this.conchModel&&(this.conchModel.removeChild($J.conchModel),this.conchModel.addChildAt($J.conchModel,this._childs.length-1)),this._childChanged());}else $J.parent&&$J.parent.removeChild($J),this._childs===$Y.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($J),this.conchModel&&this.conchModel.addChildAt($J.conchModel,this._childs.length-1),($J.parent=this)._childChanged(),this._addChild3D($J);return $J;},$J.removeChildAt=function($J){var $h=this.getChildAt($J);return $h&&(this._removeChild3D($h),this._childs.splice($J,1),this.conchModel&&this.conchModel.removeChild($h.conchModel),$h.parent=null),$h;},$J.removeChildren=function($J,$h){if(void 0===$J&&($J=0),void 0===$h&&($h=2147483647),this._childs&&0<this._childs.length){var $f=this._childs;if(0===$J&&$T<=$h){var $n=$f;this._childs=$Y.ARRAY_EMPTY;}else $n=$f.splice($J,$h-$J);for(var $L=0,$T=$n.length;$L<$T;$L++)this._removeChild3D($n[$L]),$n[$L].parent=null,this.conchModel&&this.conchModel.removeChild($n[$L].conchModel);}return this;},$J.addFrustumCullingObject=function($J){this.treeRoot?this.addTreeNode($J):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push($J):this._cullingRenders[this._cullingRendersLength]=$J,$J._indexInSceneFrustumCullingObjects=this._cullingRendersLength++);},$J.removeFrustumCullingObject=function($J){if(this.treeRoot)this.removeTreeNode($J);else{this._cullingRendersLength--;var $h=$J._indexInSceneFrustumCullingObjects;if($h!==this._cullingRendersLength){var $f=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[$h]=$f)._indexInSceneFrustumCullingObjects=$h,$J._indexInSceneFrustumCullingObjects=-1;}}},$J.getRenderQueue=function($J){return $J<3e3?this._quenes[1]||(this._quenes[1]=new $M(this)):this._quenes[2]||(this._quenes[2]=new $M(this));},$J.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new $M(this);},$J.addShaderDefine=function($J){this._shaderDefineValue|=$J;},$J.removeShaderDefine=function($J){this._shaderDefineValue&=~$J;},$J.addScript=function($J){return this._addComponent($J);},$J.getScriptByType=function($J,$h){return void 0===$h&&($h=0),this._getComponentByType($J,$h);},$J.getScriptsByType=function($J,$h){this._getComponentsByType($J,$h);},$J.getScriptByIndex=function($J){return this._getComponentByIndex($J);},$J.removeScriptByType=function($J,$h){void 0===$h&&($h=0),this._removeComponentByType($J,$h);},$J.removeScriptsByType=function($J){this._removeComponentByType($J);},$J.removeAllScript=function(){this._removeAllComponent();},$J.render=function($J,$h,$f){($q._context.ctx._renderKey=0)<this._childs.length&&$J.addRenderObject(this);},$J.renderSubmit=function(){var $J=$y.mainContext,$h=this._renderState;this._set3DRenderConfig($J),this._prepareSceneToRender(this._renderState);var $f,$n=0,$L=0;if($rh.debugMode||$w.debugMode)for($n=0,$L=this._cameraPool.length;$n<$L;$n++)$f=this._cameraPool[$n],$rh._debugPhasorSprite.begin(1,$f),$f.activeInHierarchy&&$f._renderCamera($J,$h,this),$rh._debugPhasorSprite.end();else for($n=0,$L=this._cameraPool.length;$n<$L;$n++)($f=this._cameraPool[$n]).activeInHierarchy&&$f._renderCamera($J,$h,this);return this._set2DRenderConfig($J),1;},$J.onAsynLoaded=function($J,$h,$f){var $n=$h[0];if("Scene"!==$n.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var $L=$h[1];$oh._createNodeByJson(this,$n,this,$L),this.event("hierarchyloaded",[this]),this.__loaded=!0;},$J.destroy=function($J){void 0===$J&&($J=!0),this.destroyed||($h.prototype.destroy.call(this,$J),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,$r.clearRes(this.url),this.loaded||$rh._cancelLoadByUrl(this.url));},$J.getRenderType=function(){return 0;},$J.releaseRender=function(){},$J._addComponent=function($J){var $h,$f=this._componentsMap.indexOf($J);if(-1===$f)$h=[],this._componentsMap.push($J),this._typeComponentsIndices.push($h);else if($h=this._typeComponentsIndices[$f],this._components[$h[0]].isSingleton)throw new Error("无法单实例创建"+$J+"组件，"+$J+"组件已存在！");var $n=$L.getInstance($J);$h.push(this._components.length),this._components.push($n);return $n._initialize(this),$n;},$J._removeComponent=function($J,$h){var $f=this._typeComponentsIndices[$J],$n=$f[$h],$L=this._components[$n];this._components.splice($n,1),$f.splice($h,1),0===$f.length&&(this._typeComponentsIndices.splice($J,1),this._componentsMap.splice($J,1));for(var $T=0,$k=this._componentsMap.length;$T<$k;$T++)for(var $u=($f=this._typeComponentsIndices[$T]).length-1;0<=$u;$u--){var $S=$f[$u];if(!($n<$S))break;$f[$u]=--$S;}$L._destroy();},$J._getComponentByType=function($J,$h){void 0===$h&&($h=0);var $f=this._componentsMap.indexOf($J);return-1===$f?null:this._components[this._typeComponentsIndices[$f][$h]];},$J._getComponentsByType=function($J,$h){var $f=this._componentsMap.indexOf($J);if(-1!==$f){var $n=this._typeComponentsIndices[$f],$L=$n.length;$h.length=$L;for(var $T=0;$T<$L;$T++)$h[$T]=this._components[$n[$T]];}else $h.length=0;},$J._getComponentByIndex=function($J){return this._components[$J];},$J._removeComponentByType=function($J,$h){void 0===$h&&($h=0);var $f=this._componentsMap.indexOf($J);-1!==$f&&this._removeComponent($f,$h);},$J._removeComponentsByType=function($J){var $h=this._componentsMap.indexOf($J);if(-1!==$h)for(var $f=this._typeComponentsIndices[$h],$n=0,$L=$f.length;$n<$L;$f.length<$L?$L--:$n++)this._removeComponent($h,$n);},$J._removeAllComponent=function(){for(var $J=0,$h=this._componentsMap.length;$J<$h;this._componentsMap.length<$h?$h--:$J++)this._removeComponentsByType(this._componentsMap[$J]);},$J._updateComponents=function($J){for(var $h=0,$f=this._components.length;$h<$f;$h++){var $n=this._components[$h];!$n.started&&($n._start($J),$n.started=!0),$n.enable&&$n._update($J);}},$J._lateUpdateComponents=function($J){for(var $h=0;$h<this._components.length;$h++){var $f=this._components[$h];!$f.started&&($f._start($J),$f.started=!0),$f.enable&&$f._lateUpdate($J);}},$J._preRenderUpdateComponents=function($J){for(var $h=0;$h<this._components.length;$h++){var $f=this._components[$h];!$f.started&&($f._start($J),$f.started=!0),$f.enable&&$f._preRenderUpdate($J);}},$J._postRenderUpdateComponents=function($J){for(var $h=0;$h<this._components.length;$h++){var $f=this._components[$h];!$f.started&&($f._start($J),$f.started=!0),$f.enable&&$f._postRenderUpdate($J);}},$i(0,$J,"_loaded",null,function($J){this.__loaded=$J;}),$i(0,$J,"fogColor",function(){return this._fogColor;},function($J){this._fogColor=$J,this._shaderValues.setValue(0,$J.elements);}),$i(0,$J,"enableFog",function(){return this._enableFog;},function($J){this._enableFog!==$J&&((this._enableFog=$J)?(this.addShaderDefine($Dh.SHADERDEFINE_FOG),this.removeShaderDefine($Dh.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine($Dh.SHADERDEFINE_FOG));}),$i(0,$J,"url",function(){return this._url;}),$i(0,$J,"loaded",function(){return this.__loaded;}),$i(0,$J,"enableDepthFog",function(){return this._enableDepthFog;},function($J){this._enableDepthFog!=$J&&((this._enableDepthFog=$J)?(this.addShaderDefine($Dh.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine($Dh.SHADERDEFINE_FOG)):this.removeShaderDefine($Dh.SAHDERDEFINE_DEPTHFOG));}),$i(0,$J,"fogStart",function(){return this._fogStart;},function($J){this._fogStart=$J,this._shaderValues.setValue(1,$J);}),$i(0,$J,"fogRange",function(){return this._fogRange;},function($J){this._fogRange=$J,this._shaderValues.setValue(2,$J);}),$i(0,$J,"ambientColor",function(){return this._ambientColor;},function($J){this._ambientColor=$J,this._shaderValues.setValue(21,$J.elements);}),$i(0,$J,"scene",function(){return this;}),$i(0,$J,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice();}),$n._sortScenes=function($J,$h){if($J.parent!==$p.stage||$h.parent!==$p.stage)return $J.parent!==$p.stage&&$h.parent!==$p.stage?$n._sortScenes($J.parent,$h.parent):$J.parent===$p.stage?-1:1;var $f=$p.stage._childs;return $f.indexOf($J)-$f.indexOf($h);},$n.load=function($J){return $p.loader.create($J,null,null,$n);},$n.FOGCOLOR=0,$n.FOGSTART=1,$n.FOGRANGE=2,$n.LIGHTDIRECTION=3,$n.LIGHTDIRCOLOR=4,$n.POINTLIGHTPOS=5,$n.POINTLIGHTRANGE=6,$n.POINTLIGHTATTENUATION=7,$n.POINTLIGHTCOLOR=8,$n.SPOTLIGHTPOS=9,$n.SPOTLIGHTDIRECTION=10,$n.SPOTLIGHTSPOT=11,$n.SPOTLIGHTRANGE=12,$n.SPOTLIGHTATTENUATION=13,$n.SPOTLIGHTCOLOR=14,$n.SHADOWDISTANCE=15,$n.SHADOWLIGHTVIEWPROJECT=16,$n.SHADOWMAPPCFOFFSET=17,$n.SHADOWMAPTEXTURE1=18,$n.SHADOWMAPTEXTURE2=19,$n.SHADOWMAPTEXTURE3=20,$n.AMBIENTCOLOR=21,$n.TIME=22,$n;}($Q),$mh=function($J){function $h($J){$h.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new $Jh(),this._shaderValues=new $Rh(),this._colliders=[],this._id=++$h._uniqueIDCounter,this._transform=new $Uh(this),this.name=$J||"Sprite3D-"+$h._nameNumberCounter++,this.layer=$W.currentCreationLayer,this.active=!0;}$l($h,"laya.d3.core.Sprite3D",$Ah);var $f=$h.prototype;return $p.imps($f,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),$f._setUrl=function($J){this._url=$J;},$f._getGroup=function(){return this._group;},$f._setGroup=function($J){this._group=$J;},$f._addChild3D=function($J){$J.transform.parent=this.transform,this._hierarchyAnimator&&(!$J._hierarchyAnimator&&$J._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($J,!0,[$J.name])),this._scene&&($J._setBelongScene(this._scene),this._activeInHierarchy&&$J._active&&$J._activeHierarchy());},$f._removeChild3D=function($J){$J.transform.parent=null,this._scene&&(this._activeInHierarchy&&$J._active&&$J._inActiveHierarchy(),$J._setUnBelongScene()),this._hierarchyAnimator&&($J._hierarchyAnimator==this._hierarchyAnimator&&$J._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($J,!1,[$J.name]));},$f._parseBaseCustomProps=function($J){var $h=this.transform.localPosition;$J.translate?($h.fromArray($J.translate),$h.x*=100,$h.y*=100,$h.z*=100):$h.elements.fill(0),this.transform.localPosition=$h;var $f=this.transform.localRotation;$J.rotation?$f.fromArray($J.rotation):$f.fromArray([0,0,0,-1]),this.transform.localRotation=$f;var $n=this.transform.localScale;$J.scale?$n.fromArray($J.scale):$n.elements.fill(1),this.transform.localScale=$n;var $L=$J.layer;null!=$L&&(this.layer=$W.getLayerByNumber($L));},$f._parseCustomComponent=function($J,$h,$f){for(var $n in $f){var $L=$f[$n];switch($n){case"Animator":var $T=this.addComponent(Animator);if($L.avatarPath)$T.avatar=$r.getRes($h[$L.avatarPath]);else{var $k=$L.avatar;if($k){$T.avatar=$r.getRes($h[$k.path]);var $u=$k.linkSprites;$u&&$J.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[$T,$u]);}}for(var $S=$L.clipPaths,$Y=$S.length,$x=0;$x<$Y;$x++)$T.addClip($r.getRes($h[$S[$x]]));$T.clip=$r.getRes($h[$S[0]]);var $j=$L.playOnWake;void 0!==$j&&($T.playOnWake=$j);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var $R=this.addComponent(SphereCollider);$R.isTrigger=$L.isTrigger;var $l=$R.center;$l.fromArray($L.center),$R.center=$l,$R.radius=$L.radius;break;case"BoxCollider":var $i=this.addComponent(BoxCollider);$i.isTrigger=$L.isTrigger,$i.center.fromArray($L.center);var $q=$i.size;$q.fromArray($L.size),$i.size=$q;break;case"MeshCollider":this.addComponent(MeshCollider);}}},$f._onRootNodeHierarchyLoaded=function($J,$h){for(var $f in $h){for(var $n=this,$L=$h[$f],$T=0,$k=$L.length;$T<$k;$T++){var $u=$L[$T];if(""===$u)break;if(!($n=$n.getChildByName($u)))break;}$n&&$J.linkSprite3DToAvatarNode($f,$n);}},$f._setHierarchyAnimator=function($J,$h){this._changeHierarchyAnimator($J);for(var $f=0,$n=this._childs.length;$f<$n;$f++){var $L=this._childs[$f];$L._hierarchyAnimator==$h&&$L._setHierarchyAnimator($J,$h);}},$f._clearHierarchyAnimator=function($J,$h){this._changeHierarchyAnimator($h);for(var $f=0,$n=this._childs.length;$f<$n;$f++){var $L=this._childs[$f];$L._hierarchyAnimator==$J&&$L._clearHierarchyAnimator($J,$h);}},$f._getAnimatorToLinkSprite3D=function($J,$h,$f){var $n=this.getComponentByType(Animator);if($n&&($n.avatar?$n.avatar._version||$J._setAnimatorToLinkAvatar($n,$h):$J._setAnimatorToLinkSprite3DNoAvatar($n,$h,$f)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){$f.unshift(this._parent.name);var $L=this._parent;$L._hierarchyAnimator&&$L._getAnimatorToLinkSprite3D($J,$h,$f);}},$f._setAnimatorToLinkSprite3DNoAvatar=function($J,$h,$f){var $n=0,$L=0;for($n=0,$L=$J.getClipCount();$n<$L;$n++)$J._handleSpriteOwnersBySprite($n,$h,$f,this);for($n=0,$L=this._childs.length;$n<$L;$n++){var $T=this._childs[$n],$k=$f.length;$f.push($T.name),$T._setAnimatorToLinkSprite3DNoAvatar($J,$h,$f),$f.splice($k,1);}},$f._changeHierarchyAnimator=function($J){this._hierarchyAnimator=$J;},$f._isLinkSpriteToAnimationNode=function($J,$h,$f){var $n=$J._avatarNodes.indexOf($h),$L=$J._cacheSpriteToNodesMap;if($f)this._transform.dummy=$h.transform,$J._cacheNodesToSpriteMap[$n]=$L.length,$L.push($n);else{this._transform.dummy=null;var $T=$J._cacheNodesToSpriteMap[$n];$J._cacheNodesToSpriteMap[$n]=null,$L.splice($T,1);}},$f._setBelongScene=function($J){this._scene=$J;for(var $h=0,$f=this._childs.length;$h<$f;$h++)this._childs[$h]._setBelongScene($J);},$f._setUnBelongScene=function(){this._scene=null;for(var $J=0,$h=this._childs.length;$J<$h;$J++)this._childs[$J]._setUnBelongScene();},$f._activeHierarchy=function(){var $J=0,$h=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),$J=0,$h=this._colliders.length;$J<$h;$J++)this._layer._addCollider(this._colliders[$J]);for(this.event("activeinhierarchychanged",!0),$J=0,$h=this._childs.length;$J<$h;$J++){var $f=this._childs[$J];$f._active&&$f._activeHierarchy();}},$f._inActiveHierarchy=function(){var $J=0,$h=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),$J=0,$h=this._colliders.length;$J<$h;$J++){var $f=this._colliders[$J];$f._clearCollsionMap(),this._layer._removeCollider($f);}for(this.event("activeinhierarchychanged",!1),$J=0,$h=this._childs.length;$J<$h;$J++){var $n=this._childs[$J];$n._active&&$n._inActiveHierarchy();}},$f.addComponent=function($J){var $h,$f=this._componentsMap.indexOf($J);if(-1===$f)$h=[],this._componentsMap.push($J),this._typeComponentsIndices.push($h);else if($h=this._typeComponentsIndices[$f],this._components[$h[0]].isSingleton)throw new Error("无法单实例创建"+$J+"组件，"+$J+"组件已存在！");var $n=$L.getInstance($J);return $h.push(this._components.length),this._components.push($n),$n instanceof laya.d3.component.Script&&this._scripts.push($n),$n._initialize(this),$n;},$f._removeComponent=function($J,$h){var $f,$n=0,$L=this._typeComponentsIndices[$J],$T=$L[$h],$k=this._components[$T];for($k instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($k),1),$L.splice($h,1),0===$L.length&&(this._typeComponentsIndices.splice($J,1),this._componentsMap.splice($J,1)),$n=0,$f=this._componentsMap.length;$n<$f;$n++)for(var $u=($L=this._typeComponentsIndices[$n]).length-1;0<=$u;$u--){var $S=$L[$u];if(!($T<$S))break;$L[$u]=--$S;}$k._destroy();},$f._clearSelfRenderObjects=function(){},$f._addSelfRenderObjects=function(){},$f._parseCustomProps=function($J,$h,$f,$n){},$f._updateChilds=function($J){var $h=this._childs.length;if(0!==$h)for(var $f=0;$f<$h;++$f)this._childs[$f]._update($J);},$f._getSortID=function($J,$h){return 1e3*$h.id+$J._getVertexBuffer().vertexDeclaration.id;},$f._update=function($J){($J.owner=this)._activeInHierarchy&&(this._updateComponents($J),this._lateUpdateComponents($J),$D.spriteCount++,this._childs.length&&this._updateChilds($J));},$f.getProjectionViewWorldMatrix=function($J){return $Jh.multiply($J,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix;},$f.loadHierarchy=function($J){this.addChild(laya.d3.core.Sprite3D.load($J));},$f.addChildAt=function($J,$h){if(!($J instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$J||this.destroyed||$J===this)return $J;if($J.zOrder&&this._set$P("hasZorder",!0),0<=$h&&$h<=this._childs.length){if($J._parent===this){var $f=this.getChildIndex($J);this._childs.splice($f,1),this._childs.splice($h,0,$J),this.conchModel&&(this.conchModel.removeChild($J.conchModel),this.conchModel.addChildAt($J.conchModel,$h)),this._childChanged();}else $J.parent&&$J.parent.removeChild($J),this._childs===$Y.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($h,0,$J),this.conchModel&&this.conchModel.addChildAt($J.conchModel,$h),($J.parent=this)._addChild3D($J);return $J;}throw new Error("appendChildAt:The index is out of bounds");},$f.addChild=function($J){if(!($J instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$J||this.destroyed||$J===this)return $J;if($J.zOrder&&this._set$P("hasZorder",!0),$J._parent===this){var $h=this.getChildIndex($J);$h!==this._childs.length-1&&(this._childs.splice($h,1),this._childs.push($J),this.conchModel&&(this.conchModel.removeChild($J.conchModel),this.conchModel.addChildAt($J.conchModel,this._childs.length-1)),this._childChanged());}else $J.parent&&$J.parent.removeChild($J),this._childs===$Y.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($J),this.conchModel&&this.conchModel.addChildAt($J.conchModel,this._childs.length-1),($J.parent=this)._childChanged(),this._addChild3D($J);return $J;},$f.removeChildAt=function($J){var $h=this.getChildAt($J);return $h&&(this._removeChild3D($h),this._childs.splice($J,1),this.conchModel&&this.conchModel.removeChild($h.conchModel),$h.parent=null),$h;},$f.removeChildren=function($J,$h){if(void 0===$J&&($J=0),void 0===$h&&($h=2147483647),this._childs&&0<this._childs.length){var $f=this._childs;if(0===$J&&$T<=$h){var $n=$f;this._childs=$Y.ARRAY_EMPTY;}else $n=$f.splice($J,$h-$J);for(var $L=0,$T=$n.length;$L<$T;$L++)this._removeChild3D($n[$L]),$n[$L].parent=null,this.conchModel&&this.conchModel.removeChild($n[$L].conchModel);}return this;},$f.onAsynLoaded=function($J,$h,$f){var $n=$h[0];if("Sprite3D"!==$n.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var $L=$h[1];$oh._createNodeByJson(this,$n,this,$L),this.event("hierarchyloaded",[this]),this.__loaded=!0;},$f.cloneTo=function($J){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var $h=$J;$h.name=this.name,$h._destroyed=this._destroyed,$h.timer=this.timer,$h._$P=this._$P,$h.active=this._active;var $f=$h.transform.localPosition;this.transform.localPosition.cloneTo($f),$h.transform.localPosition=$f;var $n=$h.transform.localRotation;this.transform.localRotation.cloneTo($n),$h.transform.localRotation=$n;var $L=$h.transform.localScale;this.transform.localScale.cloneTo($L),$h.transform.localScale=$L,$h.isStatic=this.isStatic;var $T=0,$k=0;for($T=0,$k=this._componentsMap.length;$T<$k;$T++){var $u=$h.addComponent(this._componentsMap[$T]);this._components[$T]._cloneTo($u);}for($T=0,$k=this._childs.length;$T<$k;$T++)$h.addChild(this._childs[$T].clone());var $S=$h.getComponentByType(Animator);if($S){var $Y=$S._linkSpritesData;if($Y)for(var $x in $Y){for(var $j=$Y[$x],$R=$h,$l=0,$i=$j.length;$l<$i&&($R=$R.getChildByName($j[$l]));$l++);if($R){var $q=$S._avatarNodeMap[$x];$R._isLinkSpriteToAnimationNode($S,$q,!0);}}}},$f.clone=function(){var $J=new this.constructor();return this.cloneTo($J),$J;},$f.destroy=function($J){if(void 0===$J&&($J=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,$J);var $h,$f=0;for($f=0,$h=this._components.length;$f<$h;$f++)this._components[$f]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,$r.clearRes(this.url),this.loaded||$rh._cancelLoadByUrl(this.url);}},$f._handleSpriteToAvatar=function($J,$h){$J._avatarNodes;var $f=$J._avatarNodeMap[this.name];$f&&$f.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode($J,$f,$h);},$f._setAnimatorToLinkAvatar=function($J,$h){this._handleSpriteToAvatar($J,$h);for(var $f=0,$n=this._childs.length;$f<$n;$f++){this._childs[$f]._setAnimatorToLinkAvatar($J,$h);}},$i(0,$f,"activeInHierarchy",function(){return this._activeInHierarchy;}),$i(0,$f,"_loaded",null,function($J){this.__loaded=$J;}),$i(0,$f,"active",function(){return this._active;},function($J){this._active!==$J&&(this._active=$J,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&($J?this._activeHierarchy():this._inActiveHierarchy()));}),$i(0,$f,"componentsCount",function(){return this._components.length;}),$i(0,$f,"loaded",function(){return this.__loaded;}),$i(0,$f,"id",function(){return this._id;}),$i(0,$f,"url",function(){return this._url;}),$i(0,$f,"layer",function(){return this._layer;},function($J){if(this._layer!==$J){if(!$J)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var $h=0,$f=this._colliders.length;if(this._layer)for($h=0;$h<$f;$h++)this._layer._removeCollider(this._colliders[$h]);for($h=0;$h<$f;$h++)$J._addCollider(this._colliders[$h]);}this._layer=$J,this.event("layerchanged",$J);}}),$i(0,$f,"scene",function(){return this._scene;}),$i(0,$f,"transform",function(){return this._transform;}),$h.instantiate=function($J,$h,$f,$n,$L){void 0===$f&&($f=!0);var $T=$J.clone();$h&&$h.addChild($T);var $k=$T.transform;if($f){var $u=$k.worldMatrix;$J.transform.worldMatrix.cloneTo($u),$k.worldMatrix=$u;}else $n&&($k.position=$n),$L&&($k.rotation=$L);return $T;},$h.load=function($J){return $p.loader.create($J,null,null,$h);},$h.WORLDMATRIX=0,$h.MVPMATRIX=1,$h._uniqueIDCounter=0,$h._nameNumberCounter=0,$h;}(),$Zh=function($J){function $x($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],$x.__super.call(this),!$J||!$h)throw"Shader Error";this._id=++$x._count,this._vs=$J,this._ps=$h,this._attributeMap=$f,this._sceneUniformMap=$n,this._cameraUniformMap=$L,this._spriteUniformMap=$T,this._materialUniformMap=$k,this._renderElementUniformMap=$u,this._precompile=$S,this._define=$Y,this._precompile&&$x.extCompileObj&&$x.extCompileFunc?$x.extCompileFunc.call($x.extCompileObj,$J,$h,$Y):this.recreateResource();}$l($x,"laya.d3.shader.Shader3D",$f);var $h=$x.prototype;return $h.recreateResource=function(){$P.now();this._compile(),this.completeCreate(),this.memorySize=0;},$h.disposeResource=function(){$y.mainContext.deleteShader(this._vshader),$y.mainContext.deleteShader(this._pshader),$y.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0;},$h._compile=function(){if(!$y.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var $J=[this._vs,this._ps],$h=$y.mainContext;if(this._program=$h.createProgram(),this._vshader=$x._createShader($h,$J[0],35633),this._pshader=$x._createShader($h,$J[1],35632),$h.attachShader(this._program,this._vshader),$h.attachShader(this._program,this._pshader),$h.linkProgram(this._program),!$q.isConchApp&&$Dh.debugMode&&!$h.getProgramParameter(this._program,35714))throw $h.getProgramInfoLog(this._program);var $f,$n=0,$L=0,$T=0;for($T=$q.isConchApp?$h.getProgramParameterEx(this._vs,this._ps,"",35721):$h.getProgramParameter(this._program,35721),$n=0;$n<$T;$n++){var $k=null;$f={vartype:"attribute",ivartype:0,attrib:$k=$q.isConchApp?$h.getActiveAttribEx(this._vs,this._ps,"",$n):$h.getActiveAttrib(this._program,$n),location:$h.getAttribLocation(this._program,$k.name),name:$k.name,type:$k.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push($f);}var $u=0;for($u=$q.isConchApp?$h.getProgramParameterEx(this._vs,this._ps,"",35718):$h.getProgramParameter(this._program,35718),$n=0;$n<$u;$n++){var $S=null;$S=$q.isConchApp?$h.getActiveUniformEx(this._vs,this._ps,"",$n):$h.getActiveUniform(this._program,$n),0<($f={vartype:"uniform",ivartype:1,attrib:$k,location:$h.getUniformLocation(this._program,$S.name),name:$S.name,type:$S.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($f.name=$f.name.substr(0,$f.name.length-3),$f.isArray=!0,$f.location=$h.getUniformLocation(this._program,$f.name)),this._uniformParams.push($f);}for($n=0,$L=this._attributeParams.length;$n<$L;$n++)($f=this._attributeParams[$n]).indexOfParams=$n,$f.index=1,$f.value=[$f.location,null],$f.codename=$f.name,$f.name=null!=this._attributeMap[$f.codename]?this._attributeMap[$f.codename]:$f.codename,this._attributeParamsMap.push($f.name),this._attributeParamsMap.push($f),$f._this=this,$f.uploadedValue=[],$f.fun=this._attribute;for($n=0,$L=this._uniformParams.length;$n<$L;$n++)switch(($f=this._uniformParams[$n]).indexOfParams=$n,$f.index=1,$f.value=[$f.location,null],$f.codename=$f.name,null!=this._sceneUniformMap[$f.codename]?($f.name=this._sceneUniformMap[$f.codename],this._sceneUniformParamsMap.push($f.name),this._sceneUniformParamsMap.push($f)):null!=this._cameraUniformMap[$f.codename]?($f.name=this._cameraUniformMap[$f.codename],this._cameraUniformParamsMap.push($f.name),this._cameraUniformParamsMap.push($f)):null!=this._spriteUniformMap[$f.codename]?($f.name=this._spriteUniformMap[$f.codename],this._spriteUniformParamsMap.push($f.name),this._spriteUniformParamsMap.push($f)):null!=this._materialUniformMap[$f.codename]?($f.name=this._materialUniformMap[$f.codename],this._materialUniformParamsMap.push($f.name),this._materialUniformParamsMap.push($f)):null!=this._renderElementUniformMap[$f.codename]?($f.name=this._renderElementUniformMap[$f.codename],this._renderElementUniformParamsMap.push($f.name),this._renderElementUniformParamsMap.push($f)):console.log("Shader:can't find uinform name:"+$f.codename+" in shader file."),$f._this=this,$f.uploadedValue=[],$f.type){case 5124:$f.fun=$f.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$f.fun=$f.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$f.fun=$f.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$f.fun=$f.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$f.fun=$f.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$f.fun=this._uniform_sampler2D;break;case 35680:$f.fun=this._uniform_samplerCube;break;case 35676:$f.fun=this._uniformMatrix4fv;break;case 35670:$f.fun=this._uniform1i;break;case 35674:$f.fun=this._uinformMatrix2fv;break;case 35675:$f.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!");}}},$h._attribute=function($J,$h){var $f=$y.mainContext,$n=$u._enableAtributes,$L=$J.location;return $n[$L]||$f.enableVertexAttribArray($L),$f.vertexAttribPointer($L,$h[0],$h[1],$h[2],$h[3],$h[4]),$n[$L]=$u._bindVertexBuffer,1;},$h._uniform1f=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h?($y.mainContext.uniform1f($J.location,$f[0]=$h),1):0;},$h._uniform1fv=function($J,$h){if($h.length<4){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]||$f[2]!==$h[2]||$f[3]!==$h[3]?($y.mainContext.uniform1fv($J.location,$h),$f[0]=$h[0],$f[1]=$h[1],$f[2]=$h[2],$f[3]=$h[3],1):0;}return $y.mainContext.uniform1fv($J.location,$h),1;},$h._uniform_vec2=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]?($y.mainContext.uniform2f($J.location,$f[0]=$h[0],$f[1]=$h[1]),1):0;},$h._uniform_vec2v=function($J,$h){if($h.length<2){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]||$f[2]!==$h[2]||$f[3]!==$h[3]?($y.mainContext.uniform2fv($J.location,$h),$f[0]=$h[0],$f[1]=$h[1],$f[2]=$h[2],$f[3]=$h[3],1):0;}return $y.mainContext.uniform2fv($J.location,$h),1;},$h._uniform_vec3=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]||$f[2]!==$h[2]?($y.mainContext.uniform3f($J.location,$f[0]=$h[0],$f[1]=$h[1],$f[2]=$h[2]),1):0;},$h._uniform_vec3v=function($J,$h){return $y.mainContext.uniform3fv($J.location,$h),1;},$h._uniform_vec4=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]||$f[2]!==$h[2]||$f[3]!==$h[3]?($y.mainContext.uniform4f($J.location,$f[0]=$h[0],$f[1]=$h[1],$f[2]=$h[2],$f[3]=$h[3]),1):0;},$h._uniform_vec4v=function($J,$h){return $y.mainContext.uniform4fv($J.location,$h),1;},$h._uniformMatrix2fv=function($J,$h){return $y.mainContext.uniformMatrix2fv($J.location,!1,$h),1;},$h._uniformMatrix3fv=function($J,$h){return $y.mainContext.uniformMatrix3fv($J.location,!1,$h),1;},$h._uniformMatrix4fv=function($J,$h){return $y.mainContext.uniformMatrix4fv($J.location,!1,$h),1;},$h._uinformMatrix2fv=function($J,$h){return $y.mainContext.uniformMatrix2fv($J.location,!1,$h),1;},$h._uinformMatrix3fv=function($J,$h){return $y.mainContext.uniformMatrix3fv($J.location,!1,$h),1;},$h._uniform1i=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h?($y.mainContext.uniform1i($J.location,$f[0]=$h),1):0;},$h._uniform1iv=function($J,$h){return $y.mainContext.uniform1iv($J.location,$h),1;},$h._uniform_ivec2=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]?($y.mainContext.uniform2i($J.location,$f[0]=$h[0],$f[1]=$h[1]),1):0;},$h._uniform_ivec2v=function($J,$h){return $y.mainContext.uniform2iv($J.location,$h),1;},$h._uniform_vec3i=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]||$f[2]!==$h[2]?($y.mainContext.uniform3i($J.location,$f[0]=$h[0],$f[1]=$h[1],$f[2]=$h[2]),1):0;},$h._uniform_vec3vi=function($J,$h){return $y.mainContext.uniform3iv($J.location,$h),1;},$h._uniform_vec4i=function($J,$h){var $f=$J.uploadedValue;return $f[0]!==$h[0]||$f[1]!==$h[1]||$f[2]!==$h[2]||$f[3]!==$h[3]?($y.mainContext.uniform4i($J.location,$f[0]=$h[0],$f[1]=$h[1],$f[2]=$h[2],$f[3]=$h[3]),1):0;},$h._uniform_vec4vi=function($J,$h){return $y.mainContext.uniform4iv($J.location,$h),1;},$h._uniform_sampler2D=function($J,$h){var $f=$h.source||$h.defaulteTexture.source,$n=$y.mainContext,$L=$J.uploadedValue;if(null!=$L[0])return $n.activeTexture($x._TEXTURES[$L[0]]),$f&&$O.bindTexture($n,3553,$f),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $L[0]=this._curActTexIndex,$n.uniform1i($J.location,this._curActTexIndex),$n.activeTexture($x._TEXTURES[this._curActTexIndex]),$f&&$O.bindTexture($n,3553,$f),this._curActTexIndex++,1;},$h._uniform_samplerCube=function($J,$h){var $f=$h.source||$h.defaulteTexture.source,$n=$y.mainContext,$L=$J.uploadedValue;if(null!=$L[0])return $n.activeTexture($x._TEXTURES[$L[0]]),$f?$O.bindTexture($n,34067,$f):$O.bindTexture($n,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $L[0]=this._curActTexIndex,$n.uniform1i($J.location,this._curActTexIndex),$n.activeTexture($x._TEXTURES[this._curActTexIndex]),$f?$O.bindTexture($n,34067,$f):$O.bindTexture($n,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1;},$h._noSetValue=function($J){console.log("no....:"+$J.name);},$h.bind=function(){return $f.activeShader=this,($f.bindShader=this).activeResource(),$O.UseProgram(this._program);},$h.uploadAttributes=function($J,$h){for(var $f,$n,$L=0,$T=0,$k=this._attributeParamsMap.length;$T<$k;$T+=2)$n=this._attributeParamsMap[$T+1],null!=($f=$J[this._attributeParamsMap[$T]])&&($h&&$h[$n.name]&&$h[$n.name].bind(),$L+=$n.fun.call(this,$n,$f));$D.shaderCall+=$L;},$h.uploadAttributesX=function($J,$h){for(var $f,$n,$L=0,$T=0,$k=this._attributeParamsMap.length;$T<$k;$T+=2)$n=this._attributeParamsMap[$T+1],null!=($f=$J[this._attributeParamsMap[$T]])&&($h._bind(),$L+=$n.fun.call(this,$n,$f));$D.shaderCall+=$L;},$h.uploadSceneUniforms=function($J){for(var $h,$f,$n=0,$L=0,$T=this._sceneUniformParamsMap.length;$L<$T;$L+=2)$f=this._sceneUniformParamsMap[$L+1],null!=($h=$J[this._sceneUniformParamsMap[$L]])&&($n+=$f.fun.call(this,$f,$h));$D.shaderCall+=$n;},$h.uploadCameraUniforms=function($J){for(var $h,$f,$n=0,$L=0,$T=this._cameraUniformParamsMap.length;$L<$T;$L+=2)$f=this._cameraUniformParamsMap[$L+1],null!=($h=$J[this._cameraUniformParamsMap[$L]])&&($n+=$f.fun.call(this,$f,$h));$D.shaderCall+=$n;},$h.uploadSpriteUniforms=function($J){for(var $h,$f,$n=0,$L=0,$T=this._spriteUniformParamsMap.length;$L<$T;$L+=2)$f=this._spriteUniformParamsMap[$L+1],null!=($h=$J[this._spriteUniformParamsMap[$L]])&&($n+=$f.fun.call(this,$f,$h));$D.shaderCall+=$n;},$h.uploadMaterialUniforms=function($J){for(var $h,$f,$n=0,$L=0,$T=this._materialUniformParamsMap.length;$L<$T;$L+=2)$f=this._materialUniformParamsMap[$L+1],null!=($h=$J[this._materialUniformParamsMap[$L]])&&($n+=$f.fun.call(this,$f,$h));$D.shaderCall+=$n;},$h.uploadRenderElementUniforms=function($J){for(var $h,$f,$n=0,$L=0,$T=this._renderElementUniformParamsMap.length;$L<$T;$L+=2)$f=this._renderElementUniformParamsMap[$L+1],null!=($h=$J[this._renderElementUniformParamsMap[$L]])&&($n+=$f.fun.call(this,$f,$h));$D.shaderCall+=$n;},$x.create=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){return new $x($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y);},$x.addInclude=function($J,$h){$s.addInclude($J,$h);},$x._createShader=function($J,$h,$f){var $n=$J.createShader($f);if($J.shaderSource($n,$h),$J.compileShader($n),$Dh.debugMode&&!$J.getShaderParameter($n,35713))throw $J.getShaderInfoLog($n);return $n;},$x.PERIOD_RENDERELEMENT=0,$x.PERIOD_MATERIAL=1,$x.PERIOD_SPRITE=2,$x.PERIOD_CAMERA=3,$x.PERIOD_SCENE=4,$x._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],$x._count=0,$x._preCompile=!1,$x.extCompileFunc=null,$x.extCompileObj=null,$j($x,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680};},"nameKey",function(){return this.nameKey=new $g();}]),$x;}(),$th=function($u){function $S(){this._transformUV=null,$S.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new $kh(.6,.6,.6)),this._setColor(10,new $kh(1,1,1)),this._setColor(11,new $uh(1,1,1,8)),this._setColor(12,new $kh(1,1,1)),this._setColor(7,new $uh(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new $uh(1,1,0,0)),this.renderMode=1;}$l($S,"laya.d3.core.material.StandardMaterial",$u);var $J=$S.prototype;return $J.disableLight=function(){this._addDisablePublicShaderDefine($Dh.SHADERDEFINE_POINTLIGHT|$Dh.SHADERDEFINE_SPOTLIGHT|$Dh.SHADERDEFINE_DIRECTIONLIGHT);},$J.disableFog=function(){this._addDisablePublicShaderDefine($Dh.SHADERDEFINE_FOG);},$J.onAsynLoaded=function($J,$h,$f){var $n=$h[0];if($n.version)$u.prototype.onAsynLoaded.call(this,$J,$h,$f);else{var $L=$h[1],$T=$n.props;for(var $k in $T)this[$k]=$T[$k];$S._parseStandardMaterial($L,this,$n),this._endLoaded();}},$J.cloneTo=function($J){$u.prototype.cloneTo.call(this,$J);var $h=$J;this._transformUV&&($h._transformUV=this._transformUV.clone());},$i(0,$J,"ambientColor",function(){return this._getColor(9);},function($J){this._setColor(9,$J);}),$i(0,$J,"ambientTexture",function(){return this._getTexture(5);},function($J){$J?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,$J);}),$i(0,$J,"renderMode",null,function($J){switch($J){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($S.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.");}this._conchMaterial&&this._conchMaterial.setRenderMode($J);}),$i(0,$J,"reflectColor",function(){return this._getColor(12);},function($J){this._setColor(12,$J);}),$i(0,$J,"tilingOffset",function(){return this._getColor(15);},function($J){if($J){var $h=$J.elements;1!=$h[0]||1!=$h[1]||0!=$h[2]||0!=$h[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,$J);}),$i(0,$J,"albedo",function(){return this._getColor(7);},function($J){this._setColor(7,$J);}),$i(0,$J,"diffuseColor",function(){return this._getColor(10);},function($J){this._setColor(10,$J);}),$i(0,$J,"albedoColor",function(){return this._getColor(7);},function($J){this._setColor(7,$J);}),$i(0,$J,"specularColor",function(){return this._getColor(11);},function($J){this._setColor(11,$J);}),$i(0,$J,"diffuseTexture",function(){return this._getTexture(1);},function($J){$J?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,$J);}),$i(0,$J,"normalTexture",function(){return this._getTexture(2);},function($J){$J?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,$J);}),$i(0,$J,"specularTexture",function(){return this._getTexture(3);},function($J){$J?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,$J);}),$i(0,$J,"emissiveTexture",function(){return this._getTexture(4);},function($J){$J?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,$J);}),$i(0,$J,"reflectTexture",function(){return this._getTexture(6);},function($J){$J?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,$J);}),$i(0,$J,"transformUV",function(){return this._transformUV;},function($J){this._transformUV=$J,this._setMatrix4x4(13,$J.matrix),$J?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,$J.matrix.elements,0);}),$S.__init__=function(){$S.SHADERDEFINE_DIFFUSEMAP=$S.shaderDefines.registerDefine("DIFFUSEMAP"),$S.SHADERDEFINE_NORMALMAP=$S.shaderDefines.registerDefine("NORMALMAP"),$S.SHADERDEFINE_SPECULARMAP=$S.shaderDefines.registerDefine("SPECULARMAP"),$S.SHADERDEFINE_EMISSIVEMAP=$S.shaderDefines.registerDefine("EMISSIVEMAP"),$S.SHADERDEFINE_AMBIENTMAP=$S.shaderDefines.registerDefine("AMBIENTMAP"),$S.SHADERDEFINE_REFLECTMAP=$S.shaderDefines.registerDefine("REFLECTMAP"),$S.SHADERDEFINE_UVTRANSFORM=$S.shaderDefines.registerDefine("UVTRANSFORM"),$S.SHADERDEFINE_TILINGOFFSET=$S.shaderDefines.registerDefine("TILINGOFFSET"),$S.SHADERDEFINE_ADDTIVEFOG=$S.shaderDefines.registerDefine("ADDTIVEFOG");},$S.load=function($J){return $p.loader.create($J,null,null,$S);},$S._parseStandardMaterial=function($J,$h,$f){var $n=$f.customProps,$L=$n.ambientColor;$h.ambientColor=new $kh($L[0],$L[1],$L[2]);var $T=$n.diffuseColor;$h.diffuseColor=new $kh($T[0],$T[1],$T[2]);var $k=$n.specularColor;$h.specularColor=new $uh($k[0],$k[1],$k[2],$k[3]);var $u=$n.reflectColor;$h.reflectColor=new $kh($u[0],$u[1],$u[2]);var $S=$n.albedoColor;$S&&($h.albedo=new $uh($S[0],$S[1],$S[2],$S[3]));var $Y=$n.diffuseTexture.texture2D;$Y&&($h.diffuseTexture=$r.getRes($J[$Y]));var $x=$n.normalTexture.texture2D;$x&&($h.normalTexture=$r.getRes($J[$x]));var $j=$n.specularTexture.texture2D;$j&&($h.specularTexture=$r.getRes($J[$j]));var $R=$n.emissiveTexture.texture2D;$R&&($h.emissiveTexture=$r.getRes($J[$R]));var $l=$n.ambientTexture.texture2D;$l&&($h.ambientTexture=$r.getRes($J[$l]));var $i=$n.reflectTexture.texture2D;$i&&($h.reflectTexture=$r.getRes($J[$i]));},$S.RENDERMODE_OPAQUE=1,$S.RENDERMODE_OPAQUEDOUBLEFACE=2,$S.RENDERMODE_CUTOUT=3,$S.RENDERMODE_CUTOUTDOUBLEFACE=4,$S.RENDERMODE_TRANSPARENT=13,$S.RENDERMODE_TRANSPARENTDOUBLEFACE=14,$S.RENDERMODE_ADDTIVE=15,$S.RENDERMODE_ADDTIVEDOUBLEFACE=16,$S.RENDERMODE_DEPTHREAD_TRANSPARENT=5,$S.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,$S.RENDERMODE_DEPTHREAD_ADDTIVE=7,$S.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,$S.RENDERMODE_NONDEPTH_TRANSPARENT=9,$S.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,$S.RENDERMODE_NONDEPTH_ADDTIVE=11,$S.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,$S.SHADERDEFINE_DIFFUSEMAP=0,$S.SHADERDEFINE_NORMALMAP=0,$S.SHADERDEFINE_SPECULARMAP=0,$S.SHADERDEFINE_EMISSIVEMAP=0,$S.SHADERDEFINE_AMBIENTMAP=0,$S.SHADERDEFINE_REFLECTMAP=0,$S.SHADERDEFINE_UVTRANSFORM=0,$S.SHADERDEFINE_TILINGOFFSET=0,$S.SHADERDEFINE_ADDTIVEFOG=0,$S.DIFFUSETEXTURE=1,$S.NORMALTEXTURE=2,$S.SPECULARTEXTURE=3,$S.EMISSIVETEXTURE=4,$S.AMBIENTTEXTURE=5,$S.REFLECTTEXTURE=6,$S.ALBEDO=7,$S.UVANIAGE=8,$S.MATERIALAMBIENT=9,$S.MATERIALDIFFUSE=10,$S.MATERIALSPECULAR=11,$S.MATERIALREFLECT=12,$S.UVMATRIX=13,$S.UVAGE=14,$S.TILINGOFFSET=15,$j($S,["defaultMaterial",function(){var $J=new $S();return $J.lock=!0,this.defaultMaterial=$J;},"shaderDefines",function(){return this.shaderDefines=new $xh($Gh.shaderDefines);}]),$S;}($Gh),$ch=function($J){function $k($J,$h,$f,$n,$L){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===$f&&($f=35044),void 0===$n&&($n=!1),$k.__super.call(this),this._indexType=$J,this._indexCount=$h,this._bufferUsage=$f,this._bufferType=34963,this._canRead=$n;var $T;if("ushort"==$J)this._indexTypeByteCount=2;else{if("ubyte"!=$J)throw new Error("unidentification index type.");this._indexTypeByteCount=1;}$T=this._indexTypeByteCount*$h,this._byteLength=$T,this._bind(),$u._gl.bufferData(this._bufferType,$T,this._bufferUsage),this.uri=$L,$n?("ushort"==$J?this._buffer=new Uint16Array($h):"ubyte"==$J&&(this._buffer=new Uint8Array($h)),this.memorySize=2*$T):this.memorySize=$T;}$l($k,"laya.d3.graphics.IndexBuffer3D",$J);var $h=$k.prototype;return $h.setData=function($J,$h,$f,$n){void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=4294967295);var $L=0;if("ushort"==this._indexType?($L=2,0===$f&&4294967295===$n||($J=new Uint16Array($J.buffer,$f*$L,$n))):"ubyte"==this._indexType&&($L=1,0===$f&&4294967295===$n||($J=new Uint8Array($J.buffer,$f*$L,$n))),this._bind(),$u._gl.bufferSubData(this._bufferType,$h*$L,$J),this._canRead)if(0!==$h||0!==$f||4294967295!==$n){var $T=this._buffer.length-$h;$T<$n&&($n=$T);for(var $k=0;$k<$n;$k++)this._buffer[$h+$k]=$J[$k];}else this._buffer=$J;},$h.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!");},$h.disposeResource=function(){$J.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0;},$i(0,$h,"indexType",function(){return this._indexType;}),$i(0,$h,"indexTypeByteCount",function(){return this._indexTypeByteCount;}),$i(0,$h,"indexCount",function(){return this._indexCount;}),$i(0,$h,"canRead",function(){return this._canRead;}),$k.INDEXTYPE_UBYTE="ubyte",$k.INDEXTYPE_USHORT="ushort",$k.create=function($J,$h,$f,$n,$L){return void 0===$f&&($f=35044),void 0===$n&&($n=!1),new $k($J,$h,$f,$n,$L);},$k;}($u),$ah=function($T){function $k($J,$h,$f,$n,$L){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===$n&&($n=!1),$k.__super.call(this),this._vertexDeclaration=$J,this._vertexCount=$h,this._bufferUsage=$f,this._bufferType=34962,this._canRead=$n,this.uri=$L,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*$h,this._bind(),$u._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),$n&&(this._buffer=new Float32Array(this._byteLength/4));}$l($k,"laya.d3.graphics.VertexBuffer3D",$T);var $J=$k.prototype;return $J.bindWithIndexBuffer=function($J){$J&&$J._bind(),this._bind();},$J.setData=function($J,$h,$f,$n){if(void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=4294967295),0===$f&&4294967295===$n||($J=new Float32Array($J.buffer,4*$f,$n)),this._bind(),$u._gl.bufferSubData(this._bufferType,4*$h,$J),this._canRead)if(0!==$h||0!==$f||4294967295!==$n){var $L=this._buffer.length-$h;$L<$n&&($n=$L);for(var $T=0;$T<$n;$T++)this._buffer[$h+$T]=$J[$T];}else this._buffer=$J;},$J.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!");},$J.disposeResource=function(){for(var $J=$y.mainContext,$h=this._vertexDeclaration.getVertexElements(),$f=$u._enableAtributes,$n=0,$L=$h.length;$n<$L;$n++)$f[$n]===this._glBuffer&&($J.disableVertexAttribArray($n),$f[$n]=null);$T.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0;},$i(0,$J,"vertexDeclaration",function(){return this._vertexDeclaration;}),$i(0,$J,"vertexCount",function(){return this._vertexCount;}),$i(0,$J,"canRead",function(){return this._canRead;}),$k.create=function($J,$h,$f,$n,$L){return void 0===$f&&($f=35044),void 0===$n&&($n=!1),new $k($J,$h,$f,$n,$L);},$k;}($u),$Bh=function($J){function $s(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,$s.__super.call(this),this._type=3553;}$l($s,"laya.d3.resource.DataTexture2D",$yh);var $h=$s.prototype;return $h.genDebugMipmaps=function(){var $J=[];return $J.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),$J.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),$J.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),$J.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),$J.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),$J.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),$J.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),$J.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),$J.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),$J.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),$J;},$h._onTextureLoaded=function($J){},$h._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var $J=$y.mainContext,$h=this._source=$J.createTexture(),$f=this._width,$n=this._height,$L=$O.curBindTexTarget,$T=$O.curBindTexValue,$k=!1;if($O.bindTexture($J,this._type,$h),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var $u=0;$J.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var $S=0;$S<this._mipmaps.length;$S++){if(this._mipmaps[$S].byteLength!=$Y*$x*4)throw"mipmap size error  level:"+$S;$J.texSubImage2D(this._type,0,$s.simLodRect[$u++],$s.simLodRect[$u++],$s.simLodRect[$u++],$s.simLodRect[$u++],6408,5121,new Uint8Array(this._mipmaps[$S]));}this.minFifter=9729,this.magFifter=9729;}else{var $Y=this._width,$x=this._height;for($u=0,$J.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),$S=0;$S<this._mipmaps.length;$S++){if(this._mipmaps[$S].byteLength!=$Y*$x*4)throw"mipmap size error  level:"+$S;$J.texImage2D(this._type,$S,6408,$Y,$x,0,6408,5121,new Uint8Array(this._mipmaps[$S])),($Y/=2)<1&&($Y=1),($x/=2)<1&&($x=1),this.minFifter=9987,this.magFifter=9729;}}this.mipmap=!1;}else if(this._image)6407==this._format&&$J.pixelStorei($J.UNPACK_ALIGNMENT,1),$J.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var $j=0,$R=!1,$l=!1;this._buffer.byteLength==4*$f*$n?($j=6408,$R=!0):this._buffer.byteLength==3*$f*$n?($j=6407,$l=!0):$j=this._format,$R||$l?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),$l&&$J.pixelStorei($J.UNPACK_ALIGNMENT,1),$J.texImage2D(this._type,0,$j,$f,$n,0,$j,5121,this._buffer)):$J&&$j==$J.ALPHA?($J.texImage2D(3553,0,$j,$f,$n,0,$j,$J.UNSIGNED_BYTE,this._buffer),$k=!0):0!=$j&&($J.compressedTexImage2D(3553,0,$j,$f,$n,0,this._buffer),$k=!0);}var $i=this._minFifter,$q=this._magFifter,$o=0==this._wrapModeU?10497:33071,$r=0==this._wrapModeV?10497:33071,$_=$d.isPOT($f,$n);$_?(this._mipmap||this._mipmaps?-1!==$i||($i=9987):-1!==$i||($i=9729),-1!==$q||($q=9729),$J.texParameteri(this._type,10241,$i),$J.texParameteri(this._type,10240,$q),$J.texParameteri(this._type,10242,$o),$J.texParameteri(this._type,10243,$r),this._mipmap&&$J.generateMipmap(this._type)):(-1!==$i||($i=9729),-1!==$q||($q=9729),$J.texParameteri(this._type,10241,$i),$J.texParameteri(this._type,10240,$q),$J.texParameteri(this._type,10242,33071),$J.texParameteri(this._type,10243,33071)),$L&&$T&&$O.bindTexture($J,$L,$T),this.memorySize=$k?this._buffer.length:$_?$f*$n*4*(1+1/3):$f*$n*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1;},$h.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate();}else{this._recreateLock=!0;}},$h.onAsynLoaded=function($J,$h,$f){var $n;$f&&($n=$f[0].call(this,$h)),$n&&(this._width=$n.width,this._height=$n.height,this._buffer=$n.data),this._src=$J,this._size=new $qh(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded();},$h.getPixels=function(){return new Uint8Array(this._buffer);},$h.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&($y.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0);},$i(0,$h,"src",function(){return this._src;}),$s.create=function($J,$h,$f,$n,$L,$T,$k){if(void 0===$n&&($n=9729),void 0===$L&&($L=9729),void 0===$T&&($T=!0),!$J||$J.byteLength<$h*$f*4)throw"DataTexture2D create error";var $u=new $s();return $u.uri=$k,$u._buffer=$J,$u._width=$h,$u._height=$f,$u._mipmap=$T,$u._magFifter=$n,$u._minFifter=$L,$u._size=new $qh($u._width,$u._height),$u._conchTexture?alert("怎么给runtime传递datatexture数据"):$u.activeResource(),$u;},$s.load=function($J,$h,$f,$n,$L){if(void 0===$h&&($h=0),void 0===$f&&($f=0),void 0===$n&&($n=9729),void 0===$L&&($L=9729),"mipmaps"===$F.getFileExtension($J)){var $T=$p.loader.create($J,null,null,$s,[function($J){this._mipmaps=[];var $h=new Uint32Array($J);this._width=$h[0];var $f=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,$f=1024),this._width!=$f)throw"现在只支持512x256的环境贴图。当前的是"+$h[0];this._height=$h[1];for(var $n=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,$L=this._height,$T=8;;){var $k=$n*$L*4;if($T+$k>$J.byteLength)throw"load mipmaps data size error ";var $u=new Uint8Array($J,$T,$k);if(this._mipmaps.push($u),$T+=$k,1==$n&&1==$L)break;($n/=2)<1&&($n=1),($L/=2)<1&&($L=1);}return null;}]);if(laya.d3.resource.DataTexture2D.lodasatlas){$T.simLodInfo=new Float32Array(40);for(var $k=0;$k<$T.simLodInfo.length;)$T.simLodInfo[$k]=($s.simLodRect[$k]+.5)/1024,$k++,$T.simLodInfo[$k]=($s.simLodRect[$k]+.5)/256,$k++,$T.simLodInfo[$k]=Math.max($s.simLodRect[$k]-1,.1)/1024,$k++,$T.simLodInfo[$k]=Math.max($s.simLodRect[$k]-1.5,.1)/256,$k++;}return $T;}if("number"==typeof $h)return $p.loader.create($J,null,null,$s,[function($J){return this._width=$h,this._height=$f,this._buffer=$J,null;}]);if("function"==typeof $h)return $p.loader.create($J,null,null,$s,[$h]);throw new Error("unknown params.");},$s.lodasatlas=!1,$j($s,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1]);}]),$s;}(),$Vh=function($J){function $h(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,$h.__super.call(this);}$l($h,"laya.d3.resource.models.PrimitiveMesh",$Oh);var $f=$h.prototype;return $p.imps($f,{"laya.d3.core.render.IRenderable":!0}),$f._getVertexBuffer=function($J){return void 0===$J&&($J=0),0===$J?this._vertexBuffer:null;},$f._getVertexBuffers=function(){return null;},$f._getIndexBuffer=function(){return this._indexBuffer;},$f._getPositions=function(){var $J,$h=[],$f=this._vertexBuffer.vertexDeclaration.getVertexElements(),$n=0;for($n=0;$n<$f.length;$n++){var $L=$f[$n];if("vector3"===$L.elementFormat&&0===$L.elementUsage){$J=$L;break;}}var $T=this._vertexBuffer.getData();for($n=0;$n<$T.length;$n+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var $k=$n+$J.offset/4,$u=new $kh($T[$k+0],$T[$k+1],$T[$k+2]);$h.push($u);}return $h;},$f.getRenderElement=function($J){return this;},$f.getRenderElementsCount=function(){return 1;},$f.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0;},$f._beforeRender=function($J){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0;},$f._render=function($J){$y.mainContext.drawElements(4,this._numberIndices,5123,0),$D.drawCall++,$D.trianglesFaces+=this._numberIndices/3;},$i(0,$f,"_vertexBufferCount",function(){return 1;}),$i(0,$f,"triangleCount",function(){return this._indexBuffer.indexCount/3;}),$h;}(),$Ch=function($J){function $h(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,$h.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[];}$l($h,"laya.d3.resource.models.Mesh",$Oh);var $f=$h.prototype;return $f._getPositions=function(){var $J,$h,$f,$n,$L,$T=[],$k=0,$u=0,$S=0;if(0!==this._vertexBuffers.length){var $Y=this._vertexBuffers.length;for($k=0;$k<$Y;$k++){for($f=($J=this._vertexBuffers[$k]).vertexDeclaration.getVertexElements(),$u=0;$u<$f.length;$u++)if("vector3"===($n=$f[$u]).elementFormat&&0===$n.elementUsage){$h=$n;break;}for($L=$J.getData(),$u=0;$u<$L.length;$u+=$J.vertexDeclaration.vertexStride/4)$S=$u+$h.offset/4,$T.push(new $kh($L[$S+0],$L[$S+1],$L[$S+2]));}}else{var $x=this._subMeshes.length;for($k=0;$k<$x;$k++){for($f=($J=this._subMeshes[$k]._getVertexBuffer()).vertexDeclaration.getVertexElements(),$u=0;$u<$f.length;$u++)if("vector3"===($n=$f[$u]).elementFormat&&0===$n.elementUsage){$h=$n;break;}for($L=$J.getData(),$u=0;$u<$L.length;$u+=$J.vertexDeclaration.vertexStride/4)$S=$u+$h.offset/4,$T.push(new $kh($L[$S+0],$L[$S+1],$L[$S+2]));}}return $T;},$f._setSubMeshes=function($J){this._subMeshes=$J,this._subMeshCount=$J.length;for(var $h=0;$h<this._subMeshCount;$h++)$J[$h]._indexInMesh=$h;this._positions=this._getPositions(),this._generateBoundingObject();},$f.onAsynLoaded=function($J,$h,$f){var $n=$h[0],$L=$h[1];$XJ.read($n,this,this._materials,this._subMeshes,$L),this.completeCreate(),this._endLoaded();},$f.getSubMesh=function($J){return this._subMeshes[$J];},$f.getSubMeshCount=function(){return this._subMeshes.length;},$f.getRenderElementsCount=function(){return this._subMeshes.length;},$f.getRenderElement=function($J){return this._subMeshes[$J];},$f.disposeResource=function(){for(var $J=0;$J<this._subMeshes.length;$J++)this._subMeshes[$J].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null;},$i(0,$f,"materials",function(){return this._materials.slice();}),$i(0,$f,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses;}),$h.load=function($J){return $p.loader.create($J,null,null,$h);},$h;}(),$eh=(function($J){function $Y($J,$h,$f,$n,$L,$T,$k,$u,$S){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===$f&&($f=6408),void 0===$n&&($n=5121),void 0===$L&&($L=33189),void 0===$T&&($T=!1),void 0===$k&&($k=!1),void 0===$u&&($u=-1),void 0===$S&&($S=-1),$Y.__super.call(this),this._type=3553,this._width=$J,this._height=$h,this._size=new $qh($J,$h),this._surfaceFormat=$f,this._surfaceType=$n,this._depthStencilFormat=$L,$q.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=$T,this._repeat=$k,this._minFifter=$u,this._magFifter=$S,this.activeResource(),this._alreadyResolved=!0;}$l($Y,"laya.d3.resource.RenderTexture",$yh);var $h=$Y.prototype;$h.recreateResource=function(){var $J=$y.mainContext;this._frameBuffer=$J.createFramebuffer(),this._source=$J.createTexture();var $h=$O.curBindTexTarget,$f=$O.curBindTexValue;$O.bindTexture($J,this._type,this._source),$J.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var $n=this._minFifter,$L=this._magFifter,$T=this._repeat?10497:33071;if($d.isPOT(this._width,this._height)?(this._mipmap?-1!==$n||($n=9987):-1!==$n||($n=9729),-1!==$L||($L=9729),$J.texParameteri(this._type,10241,$n),$J.texParameteri(this._type,10240,$L),$J.texParameteri(this._type,10242,$T),$J.texParameteri(this._type,10243,$T),this._mipmap&&$J.generateMipmap(this._type)):(-1!==$n||($n=9729),-1!==$L||($L=9729),$J.texParameteri(this._type,10241,$n),$J.texParameteri(this._type,10240,$L),$J.texParameteri(this._type,10242,33071),$J.texParameteri(this._type,10243,33071)),$h&&$f&&$O.bindTexture($J,$h,$f),$J.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=$J.createRenderbuffer(),$J.bindRenderbuffer(36161,this._depthStencilBuffer),$J.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),$J.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:$J.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$J.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$J.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer);}$J.framebufferTexture2D(36160,36064,3553,this._source,0),$J.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate();},$h.start=function(){$y.mainContext.bindFramebuffer(36160,this.frameBuffer),($Y._currentRenderTarget=this)._alreadyResolved=!1;},$h.end=function(){$y.mainContext.bindFramebuffer(36160,null),$Y._currentRenderTarget=null,this._alreadyResolved=!0;},$h.getData=function($J,$h,$f,$n){var $L=$y.mainContext;if($L.bindFramebuffer(36160,this._frameBuffer),!(36053===$L.checkFramebufferStatus(36160)))return $L.bindFramebuffer(36160,null),null;var $T=new Uint8Array(this._width*this._height*4);return $L.readPixels($J,$h,$f,$n,this._surfaceFormat,this._surfaceType,$T),$L.bindFramebuffer(36160,null),$T;},$h.disposeResource=function(){if(this._frameBuffer){var $J=$y.mainContext;$J.deleteTexture(this._source),$J.deleteFramebuffer(this._frameBuffer),$J.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0;}},$i(0,$h,"surfaceFormat",function(){return this._surfaceFormat;}),$i(0,$h,"surfaceType",function(){return this._surfaceType;}),$i(0,$h,"depthStencilFormat",function(){return this._depthStencilFormat;}),$i(0,$h,"source",function(){return this._alreadyResolved?$p.superGet($yh,this,"source"):null;}),$i(0,$h,"depthStencilBuffer",function(){return this._depthStencilBuffer;}),$i(0,$h,"frameBuffer",function(){return this._frameBuffer;}),$Y._currentRenderTarget=null;}(),function($J){function $h($J){this._color=null,this._pixels=null,$h.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new $qh(this.width,this.height),this._color=$J,this._pixels=new Uint8Array([255*$J.x,255*$J.y,255*$J.z,255*$J.w]),this.uri="SolidColorTexture2D_"+this.id;}$l($h,"laya.d3.resource.SolidColorTexture2D",$yh);var $f=$h.prototype;return $f._createWebGlTexture=function(){var $J=$y.mainContext,$h=this._source=$J.createTexture(),$f=this._width,$n=this._height,$L=$O.curBindTexTarget,$T=$O.curBindTexValue;$O.bindTexture($J,this._type,$h),$J.texImage2D(this._type,0,6408,$f,$n,0,6408,5121,this._pixels);var $k=this._minFifter,$u=this._magFifter,$S=this._repeat?10497:33071,$Y=$d.isPOT($f,$n);$Y?(this._mipmap?-1!==$k||($k=9987):-1!==$k||($k=9729),-1!==$u||($u=9729),$J.texParameteri(this._type,10241,$k),$J.texParameteri(this._type,10240,$u),$J.texParameteri(this._type,10242,$S),$J.texParameteri(this._type,10243,$S),this._mipmap&&$J.generateMipmap(this._type)):(-1!==$k||($k=9729),-1!==$u||($u=9729),$J.texParameteri(this._type,10241,$k),$J.texParameteri(this._type,10240,$u),$J.texParameteri(this._type,10242,33071),$J.texParameteri(this._type,10243,33071)),$L&&$T&&$O.bindTexture($J,$L,$T),this.memorySize=$Y?$f*$n*4*(1+1/3):$f*$n*4;},$f.recreateResource=function(){this._createWebGlTexture(),this.completeCreate();},$f.disposeResource=function(){this._source&&($y.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0);},$j($h,["magentaTexture",function(){var $J=new $h(new $uh(1,0,1,1));return $J.lock=!0,this.magentaTexture=$J;},"grayTexture",function(){var $J=new $h(new $uh(.5,.5,.5,1));return $J.lock=!0,this.grayTexture=$J;}]),$h;}()),$Hh=function($J){function $L($J,$h,$f,$n){this._canRead=!1,this._image=null,this._pixels=null,void 0===$J&&($J=!1),void 0===$h&&($h=!0),void 0===$f&&($f=6408),void 0===$n&&($n=!0),$L.__super.call(this),this._type=3553,this._repeat=$h,this._canRead=$J,this._format=$f,this._mipmap=$n;}$l($L,"laya.d3.resource.Texture2D",$yh);var $h=$L.prototype;return $h._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $J=$y.mainContext,$h=this._source=$J.createTexture(),$f=this._width,$n=this._height,$L=$O.curBindTexTarget,$T=$O.curBindTexValue;switch($O.bindTexture($J,this._type,$h),this._format){case 6407:case 6408:this._canRead?$J.texImage2D(this._type,0,this._format,$f,$n,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?$J.texImage2D(this._type,0,this._image._format,$f,$n,0,this._image._format,5121,this._image.atlasSource):$J.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case $y.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$J.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format);}var $k=this._minFifter,$u=this._magFifter,$S=this._repeat?10497:33071,$Y=0==this._wrapModeU?10497:33071,$x=0==this._wrapModeV?10497:33071,$j=$d.isPOT($f,$n);$j?(this._mipmap?-1!==$k||($k=9987):-1!==$k||($k=9729),-1!==$u||($u=9729),$J.texParameteri(this._type,10241,$k),$J.texParameteri(this._type,10240,$u),$J.texParameteri(this._type,10242,$S),$J.texParameteri(this._type,10243,$S),$J.texParameteri(this._type,10242,$Y),$J.texParameteri(this._type,10243,$x),this._mipmap&&$J.generateMipmap(this._type)):(-1!==$k||($k=9729),-1!==$u||($u=9729),$J.texParameteri(this._type,10241,$k),$J.texParameteri(this._type,10240,$u),$J.texParameteri(this._type,10242,33071),$J.texParameteri(this._type,10243,33071)),$L&&$T&&$O.bindTexture($J,$L,$T),this._image.onload=null,this._image=null,this.memorySize=$j?$f*$n*4*(1+1/3):$f*$n*4;},$h.recreateResource=function(){this._createWebGlTexture(),this.completeCreate();},$h.onAsynLoaded=function($J,$h,$f){if($f){var $n=$f[0];void 0!==$n&&(this._canRead=$n);var $L=$f[1];void 0!==$L&&(this._repeat=$L);var $T=$f[2];void 0!==$T&&(this._format=$T);var $k=$f[3];void 0!==$k&&(this._mipmap=$k);var $u=$f.wrapModeU;void 0!==$u&&(this._wrapModeU=$u);var $S=$f.wrapModeV;void 0!==$S&&(this._wrapModeV=$S);}switch(this._format){case 6407:case 6408:var $Y=(this._image=$h).width,$x=$h.height;this._width=$Y,this._height=$x,this._size=new $qh($Y,$x),this._canRead&&($q.isConchApp?$h instanceof $R.HTMLElement&&(this._pixels=new Uint8Array($h.getImageData(0,0,$Y,$x))):($P.canvas.size($Y,$x),$P.canvas.clear(),$P.context.drawImage($h,0,0,$Y,$x),this._pixels=new Uint8Array($P.context.getImageData(0,0,$Y,$x).data.buffer)));break;case $y.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var $j=new $U($h);$j.readUTFBytes(4),$j.readUTFBytes(2),$j.getInt16();$j.endian="bigEndian",this._width=$j.getInt16(),this._height=$j.getInt16(),this._size=new $qh(this._width,this._height);$j.getInt16(),$j.getInt16();this._image=new Uint8Array($h,$j.pos);}this.recreateResource(),this._endLoaded();},$h.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.");},$h.disposeResource=function(){this._source&&($y.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0);},$i(0,$h,"_src",function(){return this.url;}),$i(0,$h,"src",function(){return this.url;}),$L.load=function($J){return $p.loader.create($J,null,null,$L);},$L;}(),$bh=function($h){function $f($J,$h){$f.__super.call(this),void 0===$J&&($J=.3),void 0===$h&&($h=1e3),this._tempVector3=new $kh(),this._position=new $kh(),this._up=new $kh(),this._forward=new $kh(),this._right=new $kh(),this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=$qh.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=$J,this._farPlane=$h,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),$p.stage.on("resize",this,this._onScreenSizeChanged);}$l($f,"laya.d3.core.BaseCamera",$h);var $J=$f.prototype;return $J._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var $J=this.scene._cameraPool,$h=$J.length-1,$f=0;$f<$h;$f++)if($J[$f].renderingOrder>$J[$h].renderingOrder){var $n=$J[$f];$J[$f]=$J[$h],$J[$h]=$n;}},$J._calculateProjectionMatrix=function(){},$J._onScreenSizeChanged=function(){this._calculateProjectionMatrix();},$J._prepareCameraToRender=function(){$W._currentCameraCullingMask=this.cullingMask;var $J=this._shaderValues;$J.setValue(0,this.transform.position.elements),$J.setValue(5,this.forward.elements),$J.setValue(6,this.up.elements);},$J._prepareCameraViewProject=function($J,$h){var $f=this._shaderValues;$f.setValue(1,$J.elements),$f.setValue(2,$h.elements);},$J._renderCamera=function($J,$h,$f){},$J.addLayer=function($J){29!==$J.number&&30!=$J.number&&(this.cullingMask=this.cullingMask|$J.mask);},$J.removeLayer=function($J){29!==$J.number&&30!=$J.number&&(this.cullingMask=this.cullingMask&~$J.mask);},$J.addAllLayers=function(){this.cullingMask=2147483647;},$J.removeAllLayers=function(){this.cullingMask=0|$W.getLayerByNumber(29).mask|$W.getLayerByNumber(30).mask;},$J.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix();},$J.moveForward=function($J){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=$J,this.transform.translate(this._tempVector3);},$J.moveRight=function($J){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=$J,this.transform.translate(this._tempVector3);},$J.moveVertical=function($J){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=$J,this.transform.translate(this._tempVector3,!1);},$J._addSelfRenderObjects=function(){var $J=this.scene._cameraPool,$h=$J.length;if(0<$h){for(var $f=$h-1;0<=$f;$f--)if(this.renderingOrder<=$J[$f].renderingOrder){$J.splice($f+1,0,this);break;}}else $J.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel);},$J._clearSelfRenderObjects=function(){var $J=this.scene._cameraPool;$J.splice($J.indexOf(this),1);},$J.destroy=function($J){void 0===$J&&($J=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,$p.stage.off("resize",this,this._onScreenSizeChanged),$h.prototype.destroy.call(this,$J);},$i(0,$J,"sky",function(){return this._sky;},function($J){(this._sky=$J)._ownerCamera=this;}),$i(0,$J,"forward",function(){var $J=this.transform.worldMatrix.elements,$h=this._forward.elements;return $h[0]=-$J[8],$h[1]=-$J[9],$h[2]=-$J[10],this._forward;}),$i(0,$J,"position",function(){var $J=this.transform.worldMatrix.elements,$h=this._position.elements;return $h[0]=$J[12],$h[1]=$J[13],$h[2]=$J[14],this._position;}),$i(0,$J,"renderTarget",function(){return this._renderTarget;},function($J){null!=(this._renderTarget=$J)&&(this._renderTargetSize=$J.size);}),$i(0,$J,"up",function(){var $J=this.transform.worldMatrix.elements,$h=this._up.elements;return $h[0]=$J[4],$h[1]=$J[5],$h[2]=$J[6],this._up;}),$i(0,$J,"right",function(){var $J=this.transform.worldMatrix.elements,$h=this._right.elements;return $h[0]=$J[0],$h[1]=$J[1],$h[2]=$J[2],this._right;}),$i(0,$J,"renderTargetSize",function(){return this._renderTargetSize;},function($J){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=$J,this._calculateProjectionMatrix();}),$i(0,$J,"fieldOfView",function(){return this._fieldOfView;},function($J){this._fieldOfView=$J,this._calculateProjectionMatrix();}),$i(0,$J,"nearPlane",function(){return this._nearPlane;},function($J){this._nearPlane=$J,this._calculateProjectionMatrix();}),$i(0,$J,"farPlane",function(){return this._farPlane;},function($J){this._farPlane=$J,this._calculateProjectionMatrix();}),$i(0,$J,"orthographic",function(){return this._orthographic;},function($J){this._orthographic=$J,this._calculateProjectionMatrix();}),$i(0,$J,"orthographicVerticalSize",function(){return this._orthographicVerticalSize;},function($J){this._orthographicVerticalSize=$J,this._calculateProjectionMatrix();}),$i(0,$J,"renderingOrder",function(){return this._renderingOrder;},function($J){this._renderingOrder=$J,this._sortCamerasByRenderingOrder();}),$f.CAMERAPOS=0,$f.VIEWMATRIX=1,$f.PROJECTMATRIX=2,$f.VPMATRIX=3,$f.VPMATRIX_NO_TRANSLATE=4,$f.CAMERADIRECTION=5,$f.CAMERAUP=6,$f.ENVIRONMENTDIFFUSE=7,$f.ENVIRONMENTSPECULAR=8,$f.SIMLODINFO=9,$f.DIFFUSEIRRADMATR=10,$f.DIFFUSEIRRADMATG=11,$f.DIFFUSEIRRADMATB=12,$f.HDREXPOSURE=13,$f.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",$f.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",$f.CLEARFLAG_SOLIDCOLOR=0,$f.CLEARFLAG_SKY=1,$f.CLEARFLAG_DEPTHONLY=2,$f.CLEARFLAG_NONE=3,$j($f,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new $Jh(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1);},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new $Jh();},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new $Jh();}]),$f;}($mh),$vh=function($f){function $h($J){this._render=null,this._geometryFilter=null,$h.__super.call(this,$J);}$l($h,"laya.d3.core.RenderableSprite3D",$f);var $J=$h.prototype;return $J._addToInitStaticBatchManager=function(){},$J._setBelongScene=function($J){$f.prototype._setBelongScene.call(this,$J),$J._renderableSprite3Ds.push(this),this._render._applyLightMapParams();},$J._setUnBelongScene=function(){var $J=this._scene._renderableSprite3Ds,$h=$J.indexOf(this);$J.splice($h,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),$f.prototype._setUnBelongScene.call(this);},$J._update=function($J){($J.owner=this)._activeInHierarchy&&(this._updateComponents($J),this._render._updateOctreeNode(),this._lateUpdateComponents($J),$D.spriteCount++,this._childs.length&&this._updateChilds($J));},$J.destroy=function($J){void 0===$J&&($J=!0),$f.prototype.destroy.call(this,$J),this._render._destroy(),this._render=null;},$h.__init__=function(){$h.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=$h.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),$h.SAHDERDEFINE_LIGHTMAP=$h.shaderDefines.registerDefine("LIGHTMAP");},$h.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,$h.SAHDERDEFINE_LIGHTMAP=4,$h.LIGHTMAPSCALEOFFSET=2,$h.LIGHTMAP=3,$j($h,["shaderDefines",function(){return this.shaderDefines=new $xh();}]),$h;}($mh),$$h=(function($J){function $n($J,$h,$f){this._long=NaN,this._width=NaN,this._height=NaN,void 0===$J&&($J=1),void 0===$h&&($h=1),void 0===$f&&($f=1),$n.__super.call(this),this._long=$J,this._width=$h,this._height=$f,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject();}$l($n,"laya.d3.resource.models.BoxMesh",$Vh);var $h=$n.prototype;$h.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var $J=$yJ.vertexDeclaration,$h=($J.vertexStride,this._long/2),$f=this._height/2,$n=this._width/2,$L=new Float32Array([-$h,$f,-$n,0,1,0,0,0,$h,$f,-$n,0,1,0,1,0,$h,$f,$n,0,1,0,1,1,-$h,$f,$n,0,1,0,0,1,-$h,-$f,-$n,0,-1,0,0,1,$h,-$f,-$n,0,-1,0,1,1,$h,-$f,$n,0,-1,0,1,0,-$h,-$f,$n,0,-1,0,0,0,-$h,$f,-$n,-1,0,0,0,0,-$h,$f,$n,-1,0,0,1,0,-$h,-$f,$n,-1,0,0,1,1,-$h,-$f,-$n,-1,0,0,0,1,$h,$f,-$n,1,0,0,1,0,$h,$f,$n,1,0,0,0,0,$h,-$f,$n,1,0,0,0,1,$h,-$f,-$n,1,0,0,1,1,-$h,$f,$n,0,0,1,0,0,$h,$f,$n,0,0,1,1,0,$h,-$f,$n,0,0,1,1,1,-$h,-$f,$n,0,0,1,0,1,-$h,$f,-$n,0,0,-1,1,0,$h,$f,-$n,0,0,-1,0,0,$h,-$f,-$n,0,0,-1,0,1,-$h,-$f,-$n,0,0,-1,1,1]),$T=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new $ah($J,this._numberVertices,35044,!0),this._indexBuffer=new $ch("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData($L),this._indexBuffer.setData($T),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate();},$i(0,$h,"long",function(){return this._long;},function($J){this._long!==$J&&(this._long=$J,this.releaseResource(),this.activeResource());}),$i(0,$h,"width",function(){return this._width;},function($J){this._width!==$J&&(this._width=$J,this.releaseResource(),this.activeResource());}),$i(0,$h,"height",function(){return this._height;},function($J){this._height!==$J&&(this._height=$J,this.releaseResource(),this.activeResource());});}(),function($J){function $L($J,$h,$f,$n){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===$J&&($J=10),void 0===$h&&($h=10),void 0===$f&&($f=10),void 0===$n&&($n=10),$L.__super.call(this),this._long=$J,this._width=$h,this._stacks=$f,this._slices=$n,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject();}$l($L,"laya.d3.resource.models.PlaneMesh",$Vh);var $h=$L.prototype;$h.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var $J=new Uint16Array(this._numberIndices),$h=$yJ.vertexDeclaration,$f=$h.vertexStride/4,$n=new Float32Array(this._numberVertices*$f),$L=this._long/2,$T=this._width/2,$k=this._long/this._stacks,$u=this._width/this._slices,$S=0,$Y=0;$Y<=this._slices;$Y++)for(var $x=0;$x<=this._stacks;$x++)$n[$S++]=$x*$k-$L,$n[$S++]=0,$n[$S++]=$Y*$u-$T,$n[$S++]=0,$n[$S++]=1,$n[$S++]=0,$n[$S++]=1*$x/this._stacks,$n[$S++]=1*$Y/this._slices;var $j=0;for($Y=0;$Y<this._slices;$Y++)for($x=0;$x<this._stacks;$x++)$J[$j++]=($Y+1)*(this._stacks+1)+$x,$J[$j++]=$Y*(this._stacks+1)+$x,$J[$j++]=($Y+1)*(this._stacks+1)+$x+1,$J[$j++]=$Y*(this._stacks+1)+$x,$J[$j++]=$Y*(this._stacks+1)+$x+1,$J[$j++]=($Y+1)*(this._stacks+1)+$x+1;this._vertexBuffer=new $ah($h,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new $ch("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData($n),this._indexBuffer.setData($J),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate();},$i(0,$h,"long",function(){return this._long;},function($J){this._long!==$J&&(this._long=$J,this.releaseResource(),this.activeResource());}),$i(0,$h,"width",function(){return this._width;},function($J){this._width!==$J&&(this._width=$J,this.releaseResource(),this.activeResource());}),$i(0,$h,"stacks",function(){return this._stacks;},function($J){this._stacks!==$J&&(this._stacks=$J,this.releaseResource(),this.activeResource());}),$i(0,$h,"slices",function(){return this._slices;},function($J){this._slices!==$J&&(this._slices=$J,this.releaseResource(),this.activeResource());});}(),function($J){function $k($J,$h,$f){void 0===$J&&($J=0),void 0===$h&&($h=.3),void 0===$f&&($f=1e3),this._viewMatrix=new $Jh(),this._projectionMatrix=new $Jh(),this._projectionViewMatrix=new $Jh(),this._viewport=new $Sh(0,0,0,0),this._normalizedViewport=new $Sh(0,0,1,1),this._aspectRatio=$J,this._boundFrustumUpdate=!0,this._boundFrustum=new $EJ($Jh.DEFAULT),$k.__super.call(this,$h,$f),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged);}$l($k,"laya.d3.core.Camera",$bh);var $h=$k.prototype;return $h._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0;},$h._parseCustomProps=function($J,$h,$f,$n){var $L=$f.clearColor;this.clearColor=new $uh($L[0],$L[1],$L[2],$L[3]);var $T=$f.viewport;this.normalizedViewport=new $Sh($T[0],$T[1],$T[2],$T[3]);},$h._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var $J=this.orthographicVerticalSize*this.aspectRatio*.5,$h=.5*this.orthographicVerticalSize;$Jh.createOrthoOffCenterRH(-$J,$J,-$h,$h,this.nearPlane,this.farPlane,this._projectionMatrix);}else $Jh.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0;},$h._update=function($J){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,$J);},$h._renderCamera=function($J,$h,$f){var $n,$L;$f.parallelSplitShadowMaps[0]&&$f._renderShadowMap($J,$h,this),($h.camera=this)._prepareCameraToRender(),$f._preRenderUpdateComponents($h),$n=$h._viewMatrix=this.viewMatrix;var $T=this._renderTarget;$T?($T.start(),$Jh.multiply($bh._invertYScaleMatrix,this._projectionMatrix,$bh._invertYProjectionMatrix),$Jh.multiply($bh._invertYScaleMatrix,this.projectionViewMatrix,$bh._invertYProjectionViewMatrix),$L=$h._projectionMatrix=$bh._invertYProjectionMatrix,$h._projectionViewMatrix=$bh._invertYProjectionViewMatrix):($L=$h._projectionMatrix=this._projectionMatrix,$h._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject($n,$L),$h._viewport=this.viewport,$f._preRenderScene($J,$h,this.boundFrustum),$f._clear($J,$h),$f._renderScene($J,$h),$f._postRenderUpdateComponents($h),$T&&$T.end();},$h.viewportPointToRay=function($J,$h){$ih.calculateCursorRay($J,this.viewport,this._projectionMatrix,this.viewMatrix,null,$h);},$h.normalizedViewportPointToRay=function($J,$h){var $f=$k._tempVector20,$n=this.viewport,$L=$J.elements,$T=$f.elements;$T[0]=$L[0]*$n.width,$T[1]=$L[1]*$n.height,$ih.calculateCursorRay($f,this.viewport,this._projectionMatrix,this.viewMatrix,null,$h);},$h.worldToViewportPoint=function($J,$h){$Jh.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project($J,this._projectionViewMatrix,$h);var $f=$h.elements;$f[0]=$f[0]/$p.stage.clientScaleX,$f[1]=$f[1]/$p.stage.clientScaleY;},$h.worldToNormalizedViewportPoint=function($J,$h){$Jh.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project($J,this._projectionViewMatrix,$h);var $f=$h.elements;$f[0]=$f[0]/$p.stage.clientScaleX,$f[1]=$f[1]/$p.stage.clientScaleY;},$h.convertScreenCoordToOrthographicCoord=function($J,$h){if(this._orthographic){var $f=$X.clientWidth,$n=$X.clientHeight,$L=this.orthographicVerticalSize*this.aspectRatio/$f,$T=this.orthographicVerticalSize/$n,$k=$J.elements,$u=$h.elements;return $u[0]=(-$f/2+$k[0])*$L,$u[1]=($n/2-$k[1])*$T,$u[2]=(this.nearPlane-this.farPlane)*($k[2]+1)/2-this.nearPlane,$kh.transformCoordinate($h,this.transform.worldMatrix,$h),!0;}return!1;},$i(0,$h,"projectionViewMatrix",function(){return $Jh.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix;}),$i(0,$h,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var $J=this.viewport;return $J.width/$J.height;},function($J){if($J<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=$J,this._calculateProjectionMatrix();}),$i(0,$h,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum;}),$i(0,$h,"needViewport",function(){var $J=this.normalizedViewport;return 0===$J.x&&0===$J.y&&1===$J.width&&1===$J.height;}),$i(0,$h,"viewport",function(){if(this._viewportExpressedInClipSpace){var $J=this._normalizedViewport,$h=this.renderTargetSize,$f=$h.width,$n=$h.height;this._viewport.x=$J.x*$f,this._viewport.y=$J.y*$n,this._viewport.width=$J.width*$f,this._viewport.height=$J.height*$n;}return this._viewport;},function($J){if(null!=this.renderTarget&&($J.x<0||$J.y<0||0==$J.width||0==$J.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=$J,this._calculateProjectionMatrix();}),$i(0,$h,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var $J=this._viewport,$h=this.renderTargetSize,$f=$h.width,$n=$h.height;this._normalizedViewport.x=$J.x/$f,this._normalizedViewport.y=$J.y/$n,this._normalizedViewport.width=$J.width/$f,this._normalizedViewport.height=$J.height/$n;}return this._normalizedViewport;},function($J){$J.x<0&&($J.x=0,console.warn("Camera: viewport.x must large than 0.0.")),$J.y<0&&($J.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<$J.x+$J.width&&($J.width=1-$J.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<$J.y+$J.height&&($J.height=1-$J.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=$J,this._calculateProjectionMatrix();}),$i(0,$h,"projectionMatrix",function(){return this._projectionMatrix;},function($J){this._projectionMatrix=$J,this._useUserProjectionMatrix=!0;}),$i(0,$h,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix;}),$j($k,["_tempVector20",function(){return this._tempVector20=new $Th();}]),$k;}()),$Mh=function($f){function $n($J,$h){$n.__super.call(this,$h),this._geometryFilter=new $Ph(this),this._render=new $Wh(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),$J&&(this._geometryFilter.sharedMesh=$J)instanceof laya.d3.resource.models.Mesh&&($J.loaded?this._render.sharedMaterials=$J.materials:$J.once("loaded",this,this._applyMeshMaterials));}$l($n,"laya.d3.core.MeshSprite3D",$f);var $J=$n.prototype;return $J._changeRenderObjectByMesh=function($J){var $h=this._render._renderElements,$f=$h[$J];$f||($f=$h[$J]=new $Qh()),$f._render=this._render;var $n=this._render.sharedMaterials[$J];$n||($n=$th.defaultMaterial);var $L=this._geometryFilter.sharedMesh.getRenderElement($J);return $f._mainSortID=this._getSortID($L,$n),$f._sprite3D=this,$f.renderObj=$L,$f._material=$n,$f;},$J._changeRenderObjectByMaterial=function($J,$h){var $f=this._render._renderElements[$J];$h||($h=$th.defaultMaterial);var $n=this._geometryFilter.sharedMesh.getRenderElement($J);return $f._mainSortID=this._getSortID($n,$h),$f._sprite3D=this,$f.renderObj=$n,$f._material=$h,$f;},$J._changeRenderObjectsByMesh=function(){var $J=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=$J;for(var $h=0;$h<$J;$h++)this._changeRenderObjectByMesh($h);},$J._onMeshChanged=function($J){var $h=$J.sharedMesh;$h.loaded?this._changeRenderObjectsByMesh():$h.once("loaded",this,this._onMeshLoaded);},$J._onMeshLoaded=function($J){$J===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh();},$J._onMaterialChanged=function($J,$h,$f){$h<this._render._renderElements.length&&this._changeRenderObjectByMaterial($h,$f);},$J._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render);},$J._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render);},$J._parseCustomProps=function($J,$h,$f,$n){var $L=this.meshRender,$T=$f.lightmapIndex;null!=$T&&($L.lightmapIndex=$T);var $k,$u,$S=$f.lightmapScaleOffset;if($S&&($L.lightmapScaleOffset=new $uh($S[0],$S[1],$S[2],$S[3])),$n.instanceParams)($k=$n.instanceParams.loadPath)&&($u=$r.getRes($h[$k]),(this.meshFilter.sharedMesh=$u).loaded?$L.sharedMaterials=$u.materials:$u.once("loaded",this,this._applyMeshMaterials));else{($k=$f.meshPath)&&($u=$r.getRes($h[$k]),this.meshFilter.sharedMesh=$u);var $Y=$f.materials;if($Y){var $x=$L.sharedMaterials,$j=$Y.length;$x.length=$j;for(var $R=0;$R<$j;$R++)$x[$R]=$r.getRes($h[$Y[$R].path]);$L.sharedMaterials=$x;}}},$J._applyMeshMaterials=function($J){for(var $h=this._render.sharedMaterials,$f=$J.materials,$n=0,$L=$f.length;$n<$L;$n++)$h[$n]||($h[$n]=$f[$n]);this._render.sharedMaterials=$h;},$J._addToInitStaticBatchManager=function(){$n._staticBatchManager._addInitBatchSprite(this);},$J.cloneTo=function($J){var $h=$J;$h._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var $f=this._render,$n=$h._render;$n.enable=$f.enable,$n.sharedMaterials=$f.sharedMaterials,$n.castShadow=$f.castShadow;var $L=$f.lightmapScaleOffset;$L&&($n.lightmapScaleOffset=$L.clone()),$n.lightmapIndex=$f.lightmapIndex,$n.receiveShadow=$f.receiveShadow,$n.sortingFudge=$f.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,$J);},$J.destroy=function($J){if(void 0===$J&&($J=!0),!this.destroyed){var $h=this.meshFilter.sharedMesh;null!=$h&&($h.loaded||$h.off("loaded",this,this._applyMeshMaterials)),$f.prototype.destroy.call(this,$J),this._geometryFilter._destroy();}},$i(0,$J,"meshFilter",function(){return this._geometryFilter;}),$i(0,$J,"meshRender",function(){return this._render;}),$n.__init__=function(){$nJ._staticBatchManagers.push($n._staticBatchManager);},$n.load=function($J){return $p.loader.create($J,null,null,$n);},$j($n,["_staticBatchManager",function(){return this._staticBatchManager=new $gh();}]),$n;}($vh);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($J,$h){"use strict";for(var $f in Object.defineProperty($h,"__esModule",{value:!0}),Laya){var $n=Laya[$f];$n&&$n.__isclass&&($h[$f]=$n);}}),function($J,$h,$LJ){$LJ.un,$LJ.uns;var $f=$LJ.static,$n=$LJ.class,$T=$LJ.getset,$q=$LJ.__newvec,$u=laya.maths.Bezier,$j=laya.utils.Browser,$yJ=laya.utils.Byte,$L=(laya.events.Event,laya.events.EventDispatcher),$k=laya.display.Graphics,$S=(laya.resource.HTMLCanvas,laya.utils.Handler),$Y=laya.net.Loader,$R=laya.maths.MathUtil,$OJ=laya.maths.Matrix,$o=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),$x=(laya.renders.RenderContext,laya.resource.Resource),$l=laya.utils.RunDriver,$TJ=laya.display.Sprite,$i=laya.utils.Stat,$PJ=laya.resource.Texture,$r=(laya.net.URL,laya.utils.Utils),$O=function(){function $J(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0;}return $n($J,"laya.ani.AnimationContent"),$J;}(),$P=function(){function $J(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0;}return $n($J,"laya.ani.AnimationNodeContent"),$J;}(),$s=function(){function $J(){}return $n($J,"laya.ani.AnimationParser01"),$J.parse=function($J,$h){var $f=$h.__getBuffer(),$n=0,$L=0,$T=0,$k=0,$u=0,$S=0,$Y=0,$x=$h.readUTFString();$J._aniClassName=$x;var $j,$R=$h.readUTFString().split("\n"),$l=$h.getUint8(),$i=$h.getUint32(),$q=$h.getUint32();0<$i&&($j=$f.slice($i,$q));var $o=new $yJ($j);for(0<$q&&($J._publicExtData=$f.slice($q,$f.byteLength)),$J._useParent=!!$h.getUint8(),$J._anis.length=$l,$n=0;$n<$l;$n++){var $r=$J._anis[$n]=new $O();$r.nodes=[];var $_=$r.name=$R[$h.getUint16()];$J._aniMap[$_]=$n,$r.bone3DMap={},$r.playTime=$h.getFloat32(),$r.playTime<=0&&console.error("播放时间不能为0  url="+$J.url+" name="+$r.name);var $s=$r.nodes.length=$h.getUint8();for($L=$r.totalKeyframeDatasLength=0;$L<$s;$L++){var $d=$r.nodes[$L]=new $P();$d.childs=[];var $p=$h.getInt16();0<=$p&&($d.name=$R[$p],$r.bone3DMap[$d.name]=$L),$d.keyFrame=[],$d.parentIndex=$h.getInt16(),-1==$d.parentIndex?$d.parent=null:$d.parent=$r.nodes[$d.parentIndex],$d.lerpType=$h.getUint8();var $U=$h.getUint32();$o.pos=$U;var $Q=$d.keyframeWidth=$o.getUint16();if($r.totalKeyframeDatasLength+=$Q,0===$d.lerpType||1===$d.lerpType)for($d.interpolationMethod=[],$d.interpolationMethod.length=$Q,$T=0;$T<$Q;$T++)$d.interpolationMethod[$T]=$m.interpolation[$o.getUint8()];null!=$d.parent&&$d.parent.childs.push($d);var $D=$h.getUint16();0<$D&&($d.extenData=$f.slice($h.pos,$h.pos+$D),$h.pos+=$D);var $g,$F=$h.getUint16(),$A=0;for($T=0,$k=$d.keyFrame.length=$F;$T<$k;$T++){if(($g=$d.keyFrame[$T]=new $W()).duration=$h.getFloat32(),$g.startTime=$A,2===$d.lerpType){$g.interpolationData=[];var $G,$y=$h.getUint8();switch($G=$h.getFloat32()){case 254:for($g.interpolationData.length=$Q,$Y=0;$Y<$Q;$Y++)$g.interpolationData[$Y]=0;break;case 255:for($g.interpolationData.length=$Q,$Y=0;$Y<$Q;$Y++)$g.interpolationData[$Y]=5;break;default:for($g.interpolationData.push($G),$S=1;$S<$y;$S++)$g.interpolationData.push($h.getFloat32());}}for($g.data=new Float32Array($Q),$u=0;$u<$Q;$u++)$g.data[$u]=$h.getFloat32(),-1e-8<$g.data[$u]&&$g.data[$u]<1e-8&&($g.data[$u]=0);$A+=$g.duration;}$g.startTime=$r.playTime,$d.playTime=$r.playTime,$J._calculateKeyFrame($d,$F,$Q);}}},$J;}(),$d=function(){function $p(){}return $n($p,"laya.ani.AnimationParser02"),$p.READ_DATA=function(){$p._DATA.offset=$p._reader.getUint32(),$p._DATA.size=$p._reader.getUint32();},$p.READ_BLOCK=function(){for(var $J=$p._BLOCK.count=$p._reader.getUint16(),$h=$p._BLOCK.blockStarts=[],$f=$p._BLOCK.blockLengths=[],$n=0;$n<$J;$n++)$h.push($p._reader.getUint32()),$f.push($p._reader.getUint32());},$p.READ_STRINGS=function(){var $J=$p._reader.getUint32(),$h=$p._reader.getUint16(),$f=$p._reader.pos;$p._reader.pos=$J+$p._DATA.offset;for(var $n=0;$n<$h;$n++)$p._strings[$n]=$p._reader.readUTFString();$p._reader.pos=$f;},$p.parse=function($J,$h){$p._templet=$J;($p._reader=$h).__getBuffer();$p.READ_DATA(),$p.READ_BLOCK(),$p.READ_STRINGS();for(var $f=0,$n=$p._BLOCK.count;$f<$n;$f++){var $L=$h.getUint16(),$T=$p._strings[$L],$k=$p["READ_"+$T];if(null==$k)throw new Error("model file err,no this function:"+$L+" "+$T);$k.call();}},$p.READ_ANIMATIONS=function(){var $J=$p._reader,$h=$J.__getBuffer(),$f=0,$n=0,$L=0,$T=0,$k=$J.getUint16(),$u=[];for($u.length=$k,$f=0;$f<$k;$f++)$u[$f]=$m.interpolation[$J.getByte()];var $S=$J.getUint8();for($p._templet._anis.length=$S,$f=0;$f<$S;$f++){var $Y=$p._templet._anis[$f]={};$Y.nodes=[];var $x=$Y.name=$p._strings[$J.getUint16()];$p._templet._aniMap[$x]=$f,$Y.bone3DMap={},$Y.playTime=$J.getFloat32();var $j=$Y.nodes.length=$J.getInt16();for($n=$Y.totalKeyframeDatasLength=0;$n<$j;$n++){var $R=$Y.nodes[$n]={};$R.keyframeWidth=$k,$R.childs=[];var $l=$J.getUint16();0<=$l&&($R.name=$p._strings[$l],$Y.bone3DMap[$R.name]=$n),$R.keyFrame=[],$R.parentIndex=$J.getInt16(),-1==$R.parentIndex?$R.parent=null:$R.parent=$Y.nodes[$R.parentIndex],$Y.totalKeyframeDatasLength+=$k,$R.interpolationMethod=$u,null!=$R.parent&&$R.parent.childs.push($R);var $i=$J.getUint16(),$q=null,$o=null;for($L=0,$T=$R.keyFrame.length=$i;$L<$T;$L++){($q=$R.keyFrame[$L]={}).startTime=$J.getFloat32(),$o&&($o.duration=$q.startTime-$o.startTime);var $r=$p._DATA.offset,$_=$J.getUint32(),$s=4*$k,$d=$h.slice($r+$_,$r+$_+$s);$q.data=new Float32Array($d),$o=$q;}$q.duration=0,$R.playTime=$Y.playTime,$p._templet._calculateKeyFrame($R,$i,$k);}}},$p._templet=null,$p._reader=null,$p._strings=[],$f($p,["_BLOCK",function(){return this._BLOCK={count:0};},"_DATA",function(){return this._DATA={offset:0,size:0};}]),$p;}(),$WJ=(function(){function $J(){}$n($J,"laya.ani.AnimationState"),$J.stopped=0,$J.paused=1,$J.playing=2;}(),function(){function $L(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new $vJ(),this.resultMatrix=new $OJ(),this._children=[];}$n($L,"laya.ani.bone.Bone");var $J=$L.prototype;return $J.setTempMatrix=function($J){this._tempMatrix=$J;var $h,$f=0;for($f=0,$h=this._children.length;$f<$h;$f++)this._children[$f].setTempMatrix(this._tempMatrix);},$J.update=function($J){var $h;if(this.rotation=this.transform.skX,$J)$h=this.resultTransform.getMatrix(),$OJ.mul($h,$J,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone){if(this.inheritRotation&&this.inheritScale)$h=this.resultTransform.getMatrix(),$OJ.mul($h,this.parentBone.resultMatrix,this.resultMatrix);else{var $f=this.parentBone,$n=NaN,$L=NaN,$T=NaN,$k=this.parentBone.resultMatrix;$h=this.resultTransform.getMatrix();var $u=$k.a*$h.tx+$k.c*$h.ty+$k.tx,$S=$k.b*$h.tx+$k.d*$h.ty+$k.ty,$Y=new $OJ();this.inheritRotation?($n=Math.atan2($f.resultMatrix.b,$f.resultMatrix.a),$L=Math.cos($n),$T=Math.sin($n),$Y.setTo($L,$T,-$T,$L,0,0),$OJ.mul(this._tempMatrix,$Y,$OJ.TEMP),$OJ.TEMP.copyTo($Y),$h=this.resultTransform.getMatrix(),$OJ.mul($h,$Y,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,$h=this.resultTransform.getMatrix(),$OJ.TEMP.identity(),$OJ.TEMP.d=this.d,$OJ.mul($h,$OJ.TEMP,this.resultMatrix)),this.resultMatrix.tx=$u,this.resultMatrix.ty=$S;}}else($h=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var $x,$j=0;for($j=0,$x=this._children.length;$j<$x;$j++)this._children[$j].update();},$J.updateChild=function(){var $J,$h=0;for($h=0,$J=this._children.length;$h<$J;$h++)this._children[$h].update();},$J.setRotation=function($J){this._sprite&&(this._sprite.rotation=180*$J/Math.PI);},$J.updateDraw=function($J,$h){$L.ShowBones&&!$L.ShowBones[this.name]||(this._sprite||(this._sprite=new $TJ(),this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),$LJ.stage.addChild(this._sprite)),this._sprite.x=$J+this.resultMatrix.tx,this._sprite.y=$h+this.resultMatrix.ty);var $f,$n=0;for($n=0,$f=this._children.length;$n<$f;$n++)this._children[$n].updateDraw($J,$h);},$J.addChild=function($J){this._children.push($J),$J.parentBone=this;},$J.findBone=function($J){if(this.name==$J)return this;var $h,$f,$n=0;for($n=0,$h=this._children.length;$n<$h;$n++)if($f=this._children[$n].findBone($J))return $f;return null;},$J.localToWorld=function($J){var $h=$J[0],$f=$J[1];$J[0]=$h*this.resultMatrix.a+$f*this.resultMatrix.c+this.resultMatrix.tx,$J[1]=$h*this.resultMatrix.b+$f*this.resultMatrix.d+this.resultMatrix.ty;},$L.ShowBones={},$L;}()),$IJ=function(){function $q(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null;}$n($q,"laya.ani.bone.BoneSlot");var $J=$q.prototype;return $J.showSlotData=function($J,$h){void 0===$h&&($h=!0),this.currSlotData=$J,$h&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null;},$J.showDisplayByName=function($J){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName($J));},$J.replaceDisplayByName=function($J,$h){if(this.currSlotData){var $f;$f=this.currSlotData.getDisplayByName($J);var $n;$n=this.currSlotData.getDisplayByName($h),this.replaceDisplayByIndex($f,$n);}},$J.replaceDisplayByIndex=function($J,$h){this.currSlotData&&(this._replaceDic[$J]=$h,this.displayIndex==$J&&this.showDisplayByIndex($J));},$J.showDisplayByIndex=function($J){if(null!=this._replaceDic[$J]&&($J=this._replaceDic[$J]),this.currSlotData&&-1<$J&&$J<this.currSlotData.displayArr.length){if(this.displayIndex=$J,this.currDisplayData=this.currSlotData.displayArr[$J],this.currDisplayData){var $h=this.currDisplayData.name;this.currTexture=this.templet.getTexture($h),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!$o.isConchApp||$o.isConchApp&&"0.9.15"<$TJ.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture));}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null;},$J.replaceSkin=function($J){this._diyTexture=$J,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null);},$J.setParentMatrix=function($J){this._parentMatrix=$J;},$J.draw=function($J,$h,$f,$n){if(void 0===$f&&($f=!1),void 0===$n&&($n=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var $L,$T=this.currTexture;switch(this._diyTexture&&($T=this._diyTexture),this.currDisplayData.type){case 0:if($J){var $k=this.getDisplayMatrix();if(this._parentMatrix){var $u=!1;if($k){var $S;if($OJ.mul($k,this._parentMatrix,$OJ.TEMP),$S=$f?(null==this._resultMatrix&&(this._resultMatrix=new $OJ()),this._resultMatrix):new $OJ(),!$o.isWebGL&&this.currDisplayData.uvs||$o.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var $Y=$q._tempMatrix;$Y.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($Y.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($u=!0,$Y.rotate(-Math.PI/2)),$OJ.mul($Y,$OJ.TEMP,$S);}else $OJ.TEMP.copyTo($S);$u?$J.drawTexture($T,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,$S):$J.drawTexture($T,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,$S);}}}break;case 1:if(null==($L=$f?(null==this._skinSprite&&(this._skinSprite=$q.createSkinMesh()),this._skinSprite):$q.createSkinMesh()))return;var $x;if(null==this.currDisplayData.bones){var $j,$R=this.currDisplayData.weights;this.deformData&&($R=this.deformData),$j=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$Q.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$Q.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=$R;this.currDisplayData.triangles.length;$x=this.currDisplayData.triangles,$L.init2($T,null,$x,this._mVerticleArr,$j);var $l,$i=this.getDisplayMatrix();if(this._parentMatrix)if($i)$OJ.mul($i,this._parentMatrix,$OJ.TEMP),$l=$f?(null==this._resultMatrix&&(this._resultMatrix=new $OJ()),this._resultMatrix):new $OJ(),$OJ.TEMP.copyTo($l),$L.transform=$l;}else this.skinMesh($h,$L,$n);$J.drawSkin($L);break;case 2:if(null==($L=$f?(null==this._skinSprite&&(this._skinSprite=$q.createSkinMesh()),this._skinSprite):$q.createSkinMesh()))return;this.skinMesh($h,$L,$n),$J.drawSkin($L);}}},$J.skinMesh=function($J,$h,$f){var $n,$L=this.currTexture,$T=this.currDisplayData.bones;$n=this._diyTexture?($L=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$Q.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$Q.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var $k,$u,$S=this.currDisplayData.weights,$Y=this.currDisplayData.triangles,$x=0,$j=0,$R=0,$l=NaN,$i=NaN,$q=0,$o=0,$r=[],$_=0,$s=0;if(this.deformData&&0<this.deformData.length){var $d=0;for($_=0,$s=$T.length;$_<$s;){for($R=$T[$_++]+$_,$j=$x=0;$_<$R;$_++)$u=$J[$T[$_]],$l=$S[$q]+this.deformData[$d++],$i=$S[$q+1]+this.deformData[$d++],$o=$S[$q+2],$x+=($l*$u.a+$i*$u.c+$u.tx)*$o,$j+=($l*$u.b+$i*$u.d+$u.ty)*$o,$q+=3;$r.push($x,$j);}}else for($_=0,$s=$T.length;$_<$s;){for($R=$T[$_++]+$_,$j=$x=0;$_<$R;$_++)$u=$J[$T[$_]],$l=$S[$q],$i=$S[$q+1],$o=$S[$q+2],$x+=($l*$u.a+$i*$u.c+$u.tx)*$o,$j+=($l*$u.b+$i*$u.d+$u.ty)*$o,$q+=3;$r.push($x,$j);}this._mVerticleArr=$r,$k=$Y,$h.init2($L,null,$k,this._mVerticleArr,$n);},$J.drawBonePoint=function($J){$J&&this._parentMatrix&&$J.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000");},$J.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null;},$J.getMatrix=function(){return this._resultMatrix;},$J.copy=function(){var $J=new $q();return $J.type="copy",$J.name=this.name,$J.attachmentName=this.attachmentName,$J.srcDisplayIndex=this.srcDisplayIndex,$J.parent=this.parent,$J.displayIndex=this.displayIndex,$J.templet=this.templet,$J.currSlotData=this.currSlotData,$J.currTexture=this.currTexture,$J.currDisplayData=this.currDisplayData,$J;},$q.createSkinMesh=function(){return $o.isWebGL||$o.isConchApp?$l.skinAniSprite():($o.isWebGL,null);},$f($q,["_tempMatrix",function(){return this._tempMatrix=new $OJ();}]),$q;}(),$mJ=function(){function $J(){this.skinName=null,this.deformSlotDataList=[];}return $n($J,"laya.ani.bone.DeformAniData"),$J;}(),$ZJ=function(){function $J(){this.deformSlotDisplayList=[];}return $n($J,"laya.ani.bone.DeformSlotData"),$J;}(),$tJ=function(){function $J(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[];}$n($J,"laya.ani.bone.DeformSlotDisplayData");var $h=$J.prototype;return $h.binarySearch1=function($J,$h){var $f=0,$n=$J.length-2;if(0==$n)return 1;for(var $L=$n>>>1;;){if($J[Math.floor($L+1)]<=$h?$f=$L+1:$n=$L,$f==$n)return $f+1;$L=$f+$n>>>1;}return 0;},$h.apply=function($J,$h,$f){if(void 0===$f&&($f=1),$J+=.05,!(this.timeList.length<=0)){var $n=0;if(!($J<this.timeList[0])){var $L=this.vectices[0].length,$T=[],$k=this.binarySearch1(this.timeList,$J);if(this.frameIndex=$k,$J>=this.timeList[this.timeList.length-1]){var $u=this.vectices[this.vectices.length-1];if($f<1)for($n=0;$n<$L;$n++)$T[$n]+=($u[$n]-$T[$n])*$f;else for($n=0;$n<$L;$n++)$T[$n]=$u[$n];this.deformData=$T;}else{this.tweenKeyList[this.frameIndex];var $S=this.vectices[this.frameIndex-1],$Y=this.vectices[this.frameIndex],$x=this.timeList[this.frameIndex-1],$j=this.timeList[this.frameIndex];$f=this.tweenKeyList[$k-1]?($J-$x)/($j-$x):0;var $R=NaN;for($n=0;$n<$L;$n++)$R=$S[$n],$T[$n]=$R+($Y[$n]-$R)*$f;this.deformData=$T;}}}},$J;}(),$cJ=function(){function $J(){this.time=NaN,this.drawOrder=[];}return $n($J,"laya.ani.bone.DrawOrderData"),$J;}(),$aJ=function(){function $J(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN;}return $n($J,"laya.ani.bone.EventData"),$J;}(),$_=function(){function $nJ($J,$h){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=$J,this._targetBone=$h[$J.targetBoneIndex],this.isSpine=$J.isSpine,null==this._bones&&(this._bones=[]);for(var $f=this._bones.length=0,$n=$J.boneIndexs.length;$f<$n;$f++)this._bones.push($h[$J.boneIndexs[$f]]);this.name=$J.name,this.mix=$J.mix,this.bendDirection=$J.bendDirection;}$n($nJ,"laya.ani.bone.IkConstraint");var $J=$nJ.prototype;return $J.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix);}},$J._applyIk1=function($J,$h,$f,$n){var $L=$J.parentBone,$T=1/($L.resultMatrix.a*$L.resultMatrix.d-$L.resultMatrix.b*$L.resultMatrix.c),$k=$h-$L.resultMatrix.tx,$u=$f-$L.resultMatrix.ty,$S=($k*$L.resultMatrix.d-$u*$L.resultMatrix.c)*$T-$J.transform.x,$Y=($u*$L.resultMatrix.a-$k*$L.resultMatrix.b)*$T-$J.transform.y,$x=Math.atan2($Y,$S)*$nJ.radDeg-0-$J.transform.skX;$J.transform.scX<0&&($x+=180),180<$x?$x-=360:$x<-180&&($x+=360),$J.transform.skX=$J.transform.skY=$J.transform.skX+$x*$n,$J.update();},$J.updatePos=function($J,$h){this._sp&&this._sp.pos($J,$h);},$J._applyIk2=function($J,$h,$f,$n,$L,$T){if(0!=$T){var $k=$J.resultTransform.x,$u=$J.resultTransform.y,$S=$J.transform.scX,$Y=$J.transform.scY,$x=$h.transform.scX,$j=0,$R=0,$l=0;$l=$S<0?($S=-$S,$j=180,-1):($j=0,1),$Y<0&&($Y=-$Y,$l=-$l),$R=$x<0?($x=-$x,180):0;var $i=$h.resultTransform.x,$q=NaN,$o=NaN,$r=NaN,$_=$J.resultMatrix.a,$s=$J.resultMatrix.c,$d=$J.resultMatrix.b,$p=$J.resultMatrix.d,$U=Math.abs($S-$Y)<=1e-4;$r=$U?($o=$_*$i+$s*($q=$h.resultTransform.y)+$J.resultMatrix.tx,$d*$i+$p*$q+$J.resultMatrix.ty):($q=0,$o=$_*$i+$J.resultMatrix.tx,$d*$i+$J.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new $TJ(),$LJ.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($f,$n,15,"#ffff00"),this._sp.graphics.drawCircle($o,$r,15,"#ff00ff")),$J.setRotation(Math.atan2($r-$J.resultMatrix.ty,$o-$J.resultMatrix.tx));var $Q=$J.parentBone;$_=$Q.resultMatrix.a,$s=$Q.resultMatrix.c,$d=$Q.resultMatrix.b;var $D=1/($_*($p=$Q.resultMatrix.d)-$s*$d),$g=$f-$Q.resultMatrix.tx,$F=$n-$Q.resultMatrix.ty,$A=($g*$p-$F*$s)*$D-$k,$G=($F*$_-$g*$d)*$D-$u,$y=(($g=$o-$Q.resultMatrix.tx)*$p-($F=$r-$Q.resultMatrix.ty)*$s)*$D-$k,$O=($F*$_-$g*$d)*$D-$u,$P=Math.sqrt($y*$y+$O*$O),$W=$h.length*$x,$I=NaN,$m=NaN;if($U){var $Z=($A*$A+$G*$G-$P*$P-($W*=$S)*$W)/(2*$P*$W);$Z<-1?$Z=-1:1<$Z&&($Z=1),$m=Math.acos($Z)*$L,$_=$P+$W*$Z,$s=$W*Math.sin($m),$I=Math.atan2($G*$_-$A*$s,$A*$_+$G*$s);}else{var $t=($_=$S*$W)*$_,$c=($s=$Y*$W)*$s,$a=$A*$A+$G*$G,$B=Math.atan2($G,$A),$V=-2*$c*$P,$C=$c-$t;if(0<($p=$V*$V-4*$C*($d=$c*$P*$P+$t*$a-$t*$c))){var $e=Math.sqrt($p);$V<0&&($e=-$e);var $H=($e=-($V+$e)/2)/$C,$b=$d/$e,$v=Math.abs($H)<Math.abs($b)?$H:$b;$v*$v<=$a&&($F=Math.sqrt($a-$v*$v)*$L,$I=$B-Math.atan2($F,$v),$m=Math.atan2($F/$Y,($v-$P)/$S));}var $$=0,$M=Number.MAX_VALUE,$X=0,$w=0,$E=0,$N=0,$z=0,$K=0;$N<($p=($g=$P+$_)*$g)&&($E=0,$N=$p,$z=$g),($p=($g=$P-$_)*$g)<$M&&($$=Math.PI,$M=$p,$X=$g);var $JJ=Math.acos(-$_*$P/($t-$c));($p=($g=$_*Math.cos($JJ)+$P)*$g+($F=$s*Math.sin($JJ))*$F)<$M&&($$=$JJ,$M=$p,$X=$g,$w=$F),$N<$p&&($E=$JJ,$N=$p,$z=$g,$K=$F),$m=$a<=($M+$N)/2?($I=$B-Math.atan2($w*$L,$X),$$*$L):($I=$B-Math.atan2($K*$L,$z),$E*$L);}var $hJ=Math.atan2($q,$i)*$l,$fJ=$J.resultTransform.skX;180<($I=($I-$hJ)*$nJ.radDeg+$j-$fJ)?$I-=360:$I<-180&&($I+=360),$J.resultTransform.x=$k,$J.resultTransform.y=$u,$J.resultTransform.skX=$J.resultTransform.skY=$fJ+$I*$T,$fJ=$h.resultTransform.skX,180<($m=(($m+$hJ)*$nJ.radDeg-0)*$l+$R-($fJ%=360))?$m-=360:$m<-180&&($m+=360),$h.resultTransform.x=$i,$h.resultTransform.y=$q,$h.resultTransform.skX=$h.resultTransform.skY=$h.resultTransform.skY+$m*$T,$J.update();}},$J._applyIk3=function($J,$h,$f,$n,$L,$T){if(0!=$T){var $k,$u,$S=$h.resultMatrix.a*$h.length,$Y=$h.resultMatrix.b*$h.length,$x=$S*$S+$Y*$Y,$j=Math.sqrt($x),$R=$J.resultMatrix.tx,$l=$J.resultMatrix.ty,$i=$h.resultMatrix.tx,$q=$h.resultMatrix.ty,$o=$i-$R,$r=$q-$l,$_=$o*$o+$r*$r,$s=Math.sqrt($_),$d=($o=$f-$J.resultMatrix.tx)*$o+($r=$n-$J.resultMatrix.ty)*$r,$p=Math.sqrt($d);if($j+$s<=$p||$p+$j<=$s||$p+$s<=$j){var $U=NaN;$i=$R+($U=$j+$s<=$p?1:-1)*($f-$R)*$s/$p,$q=$l+$U*($n-$l)*$s/$p;}else{var $Q=($_-$x+$d)/(2*$d),$D=Math.sqrt($_-$Q*$Q*$d)/$p,$g=$R+$o*$Q,$F=$l+$r*$Q,$A=-$r*$D,$G=$o*$D;$q=0<$L?($i=$g-$A,$F-$G):($i=$g+$A,$F+$G);}$k=$i,$u=$q,this.isDebug&&(this._sp||(this._sp=new $TJ(),$LJ.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($R,$l,15,"#ff00ff"),this._sp.graphics.drawCircle($f,$n,15,"#ffff00"),this._sp.graphics.drawCircle($k,$u,15,"#ff00ff"));var $y,$O;$y=Math.atan2($u-$J.resultMatrix.ty,$k-$J.resultMatrix.tx),$J.setRotation($y),($O=$nJ._tempMatrix).identity(),$O.rotate($y),$O.scale($J.resultMatrix.getScaleX(),$J.resultMatrix.getScaleY()),$O.translate($J.resultMatrix.tx,$J.resultMatrix.ty),$O.copyTo($J.resultMatrix),$J.updateChild();var $P,$W;$P=Math.atan2($n-$u,$f-$k),$h.setRotation($P),($W=$nJ._tempMatrix).identity(),$W.rotate($P),$W.scale($h.resultMatrix.getScaleX(),$h.resultMatrix.getScaleY()),$W.translate($k,$u),$O.copyTo($h.resultMatrix),$h.updateChild();}},$f($nJ,["radDeg",function(){return this.radDeg=180/Math.PI;},"degRad",function(){return this.degRad=Math.PI/180;},"_tempMatrix",function(){return this._tempMatrix=new $OJ();}]),$nJ;}(),$BJ=function(){function $J(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[];}return $n($J,"laya.ani.bone.IkConstraintData"),$J;}(),$p=function(){function $W($J,$h){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=$J,this.position=$J.position,this.spacing=$J.spacing,this.rotateMix=$J.rotateMix,this.translateMix=$J.translateMix,this.bones=[];for(var $f=this.data.bones,$n=0,$L=$f.length;$n<$L;$n++)this.bones.push($h[$f[$n]]);}$n($W,"laya.ani.bone.PathConstraint");var $J=$W.prototype;return $J.apply=function($J,$h){if(this.target){var $f=this.translateMix,$n=this.translateMix,$L=0<$n,$T=this.data.spacingMode,$k="length"==$T,$u=this.data.rotateMode,$S="tangent"==$u,$Y="chainScale"==$u,$x=[],$j=this.bones.length,$R=$S?$j:$j+1,$l=[];(this._spaces=$l)[0]=this.position;var $i=this.spacing;if($Y||$k)for(var $q=0,$o=$R-1;$q<$o;){var $r=this.bones[$q],$_=$r.length,$s=$_*$r.resultMatrix.a,$d=$_*$r.resultMatrix.b;$_=Math.sqrt($s*$s+$d*$d),$Y&&($x[$q]=$_),$l[++$q]=$k?Math.max(0,$_+$i):$i;}else for($q=1;$q<$R;$q++)$l[$q]=$i;var $p=this.computeWorldPositions(this.target,$J,$h,$R,$S,"percent"==this.data.positionMode,"percent"==$T);if(this._debugKey){for($q=0;$q<$p.length;$q++)$h.drawCircle($p[$q++],$p[$q++],5,"#00ff00");var $U=[];for($q=0;$q<$p.length;$q++)$U.push($p[$q++],$p[$q++]);$h.drawLines(0,0,$U,"#ff0000");}var $Q=$p[0],$D=$p[1],$g=this.data.offsetRotation,$F="chain"==$u&&0==$g,$A=NaN;for($q=0,$A=3;$q<$j;$q++,$A+=3){($r=this.bones[$q]).resultMatrix.tx+=($Q-$r.resultMatrix.tx)*$f,$r.resultMatrix.ty+=($D-$r.resultMatrix.ty)*$f;var $G=($s=$p[$A])-$Q,$y=($d=$p[$A+1])-$D;if($Y&&0!=($_=$x[$q])){var $O=(Math.sqrt($G*$G+$y*$y)/$_-1)*$n+1;$r.resultMatrix.a*=$O,$r.resultMatrix.c*=$O;}if($Q=$s,$D=$d,$L){var $P=$r.resultMatrix.a,$W=$r.resultMatrix.c,$I=$r.resultMatrix.b,$m=$r.resultMatrix.d,$Z=NaN,$t=NaN,$c=NaN;$Z=$S?$p[$A-1]:0==$l[$q+1]?$p[$A+2]:Math.atan2($y,$G),$Z-=Math.atan2($I,$P)-$g/180*Math.PI,$F&&($t=Math.cos($Z),$c=Math.sin($Z),$Q+=(($_=$r.length)*($t*$P-$c*$I)-$G)*$n,$D+=($_*($c*$P+$t*$I)-$y)*$n),$Z>Math.PI?$Z-=2*Math.PI:$Z<-Math.PI&&($Z+=2*Math.PI),$Z*=$n,$t=Math.cos($Z),$c=Math.sin($Z),$r.resultMatrix.a=$t*$P-$c*$I,$r.resultMatrix.c=$t*$W-$c*$m,$r.resultMatrix.b=$c*$P+$t*$I,$r.resultMatrix.d=$c*$W+$t*$m;}}}},$J.computeWorldVertices2=function($J,$h,$f,$n,$L,$T){var $k,$u,$S=$J.currDisplayData.bones,$Y=$J.currDisplayData.weights,$x=$J.currDisplayData.triangles,$j=0,$R=0,$l=0,$i=0,$q=0,$o=0,$r=0,$_=0,$s=0,$d=0,$p=0;if(null!=$S){for($j=0;$j<$f;$j+=2)$R+=($i=$S[$R])+1,$l+=$i;var $U=$h;for($q=$T,$o=3*$l;$q<$n;$q+=2){for($_=$r=0,$i=$S[$R++],$i+=$R;$R<$i;$R++,$o+=3){$k=$U[$S[$R]].resultMatrix,$s=$Y[$o],$d=$Y[$o+1];var $Q=$Y[$o+2];$r+=($s*$k.a+$d*$k.c+$k.tx)*$Q,$_+=($s*$k.b+$d*$k.d+$k.ty)*$Q;}$L[$q]=$r,$L[$q+1]=$_;}}else{var $D,$g;if($x||($x=$Y),$J.deformData&&($x=$J.deformData),$D=$J.parent,$h)for($p=$h.length,$j=0;$j<$p;$j++)if($h[$j].name==$D){$u=$h[$j];break;}$u&&($g=$u.resultMatrix),$g||($g=$W._tempMt);var $F=$g.tx,$A=$g.ty,$G=$g.a,$y=$g.b,$O=$g.c,$P=$g.d;for($u&&($P*=$u.d),$R=$f,$q=$T;$q<$n;$R+=2,$q+=2)$s=$x[$R],$d=$x[$R+1],$L[$q]=$s*$G+$d*$y+$F,$L[$q+1]=-($s*$O+$d*$P+$A);}},$J.computeWorldPositions=function($J,$h,$f,$n,$L,$T,$k){$J.currDisplayData.bones,$J.currDisplayData.weights,$J.currDisplayData.triangles;var $u=[],$S=0,$Y=$J.currDisplayData.verLen,$x=this.position,$j=this._spaces,$R=[],$l=[],$i=$Y/6,$q=-1,$o=NaN,$r=0,$_=0,$s=NaN,$d=NaN,$p=NaN,$U=NaN;if($i--,$Y-=4,this.computeWorldVertices2($J,$h,2,$Y,$u,0),this._debugKey)for($S=0;$S<$u.length;)$f.drawCircle($u[$S++],$u[$S++],10,"#ff0000");$R=$u,this._curves.length=$i;var $Q=this._curves,$D=$R[$o=0],$g=$R[1],$F=0,$A=0,$G=0,$y=0,$O=0,$P=0,$W=NaN,$I=NaN,$m=NaN,$Z=NaN,$t=NaN,$c=NaN,$a=NaN,$B=NaN,$V=0;for($S=0,$V=2;$S<$i;$S++,$V+=6)$F=$R[$V],$A=$R[$V+1],$G=$R[$V+2],$y=$R[$V+3],$t=2*($W=.1875*($D-2*$F+$G))+($m=.09375*(3*($F-$G)-$D+($O=$R[$V+4]))),$c=2*($I=.1875*($g-2*$A+$y))+($Z=.09375*(3*($A-$y)-$g+($P=$R[$V+5]))),$a=.75*($F-$D)+$W+.16666667*$m,$B=.75*($A-$g)+$I+.16666667*$Z,$o+=Math.sqrt($a*$a+$B*$B),$a+=$t,$B+=$c,$t+=$m,$c+=$Z,$o+=Math.sqrt($a*$a+$B*$B),$a+=$t,$B+=$c,$o+=Math.sqrt($a*$a+$B*$B),$a+=$t+$m,$B+=$c+$Z,$o+=Math.sqrt($a*$a+$B*$B),$Q[$S]=$o,$D=$O,$g=$P;if($T&&($x*=$o),$k)for($S=0;$S<$n;$S++)$j[$S]*=$o;var $C=this._segments,$e=0,$H=0;for($H=$_=$r=$S=0;$S<$n;$S++,$r+=3)if(($s=$x+=$d=$j[$S])<0)this.addBeforePosition($s,$R,0,$l,$r);else if($o<$s)this.addAfterPosition($s-$o,$R,$Y-4,$l,$r);else{for(;;$_++)if(!(($U=$Q[$_])<$s)){0==$_?$s/=$U:$s=($s-($p=$Q[$_-1]))/($U-$p);break;}if($_!=$q){var $b=6*($q=$_);for($D=$R[$b],$g=$R[$b+1],$F=$R[$b+2],$A=$R[$b+3],$G=$R[$b+4],$y=$R[$b+5],$t=2*($W=.03*($D-2*$F+$G))+($m=.006*(3*($F-$G)-$D+($O=$R[$b+6]))),$c=2*($I=.03*($g-2*$A+$y))+($Z=.006*(3*($A-$y)-$g+($P=$R[$b+7]))),$a=.3*($F-$D)+$W+.16666667*$m,$B=.3*($A-$g)+$I+.16666667*$Z,$e=Math.sqrt($a*$a+$B*$B),$C[0]=$e,$b=1;$b<8;$b++)$a+=$t,$B+=$c,$t+=$m,$c+=$Z,$e+=Math.sqrt($a*$a+$B*$B),$C[$b]=$e;$a+=$t,$B+=$c,$e+=Math.sqrt($a*$a+$B*$B),$C[8]=$e,$a+=$t+$m,$B+=$c+$Z,$e+=Math.sqrt($a*$a+$B*$B),$C[9]=$e,$H=0;}for($s*=$e;;$H++)if(!(($U=$C[$H])<$s)){0==$H?$s/=$U:$s=$H+($s-($p=$C[$H-1]))/($U-$p);break;}this.addCurvePosition(.1*$s,$D,$g,$F,$A,$G,$y,$O,$P,$l,$r,$L||0<$S&&0==$d);}return $l;},$J.addBeforePosition=function($J,$h,$f,$n,$L){var $T=$h[$f],$k=$h[$f+1],$u=$h[$f+2]-$T,$S=$h[$f+3]-$k,$Y=Math.atan2($S,$u);$n[$L]=$T+$J*Math.cos($Y),$n[$L+1]=$k+$J*Math.sin($Y),$n[$L+2]=$Y;},$J.addAfterPosition=function($J,$h,$f,$n,$L){var $T=$h[$f+2],$k=$h[$f+3],$u=$T-$h[$f],$S=$k-$h[$f+1],$Y=Math.atan2($S,$u);$n[$L]=$T+$J*Math.cos($Y),$n[$L+1]=$k+$J*Math.sin($Y),$n[$L+2]=$Y;},$J.addCurvePosition=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x,$j){0==$J&&($J=1e-4);var $R=$J*$J,$l=$R*$J,$i=1-$J,$q=$i*$i,$o=$q*$i,$r=$i*$J,$_=3*$r,$s=$i*$_,$d=$_*$J,$p=$h*$o+$n*$s+$T*$d+$u*$l,$U=$f*$o+$L*$s+$k*$d+$S*$l;$Y[$x]=$p,$Y[$x+1]=$U,$Y[$x+2]=$j?Math.atan2($U-($f*$q+$L*$r*2+$k*$R),$p-($h*$q+$n*$r*2+$T*$R)):0;},$W.NONE=-1,$W.BEFORE=-2,$W.AFTER=-3,$f($W,["_tempMt",function(){return this._tempMt=new $OJ();}]),$W;}(),$VJ=function(){function $J(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[];}return $n($J,"laya.ani.bone.PathConstraintData"),$J;}(),$CJ=function(){function $J(){this.name=null,this.slotArr=[];}return $n($J,"laya.ani.bone.SkinData"),$J;}(),$eJ=function(){function $J(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0;}$n($J,"laya.ani.bone.SkinSlotDisplayData");var $h=$J.prototype;return $h.createTexture=function($J){return this.texture||(this.texture=new $PJ($J.bitmap,this.uvs),$J.bitmap.alphaTexture&&(this.texture.alphaTexture=new $PJ($J.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=$J.height,this.texture.height=$J.width,this.texture.offsetX=-$J.offsetX,this.texture.offsetY=-$J.offsetY,this.texture.sourceWidth=$J.sourceHeight,this.texture.sourceHeight=$J.sourceWidth):(this.texture.width=$J.width,this.texture.height=$J.height,this.texture.offsetX=-$J.offsetX,this.texture.offsetY=-$J.offsetY,this.texture.sourceWidth=$J.sourceWidth,this.texture.sourceHeight=$J.sourceHeight),$o.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture;},$h.destory=function(){this.texture&&this.texture.destroy();},$J;}(),$HJ=function(){function $J(){this.name=null,this.displayArr=[];}return $n($J,"laya.ani.bone.SlotData"),$J.prototype.getDisplayByName=function($J){for(var $h=0,$f=this.displayArr.length;$h<$f;$h++)if(this.displayArr[$h].attachmentName==$J)return $h;return-1;},$J;}(),$U=function(){function $J($J,$h){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=$q(2,0),this._data=$J,null==this._bones&&(this._bones=[]),this.target=$h[$J.targetIndex];var $f,$n=0;for($n=0,$f=$J.boneIndexs.length;$n<$f;$n++)this._bones.push($h[$J.boneIndexs[$n]]);this.rotateMix=$J.rotateMix,this.translateMix=$J.translateMix,this.scaleMix=$J.scaleMix,this.shearMix=$J.shearMix;}return $n($J,"laya.ani.bone.TfConstraint"),$J.prototype.apply=function(){for(var $J,$h=this.target.resultMatrix.a,$f=this.target.resultMatrix.b,$n=this.target.resultMatrix.c,$L=this.target.resultMatrix.d,$T=0,$k=this._bones.length;$T<$k;$T++){if($J=this._bones[$T],0<this.rotateMix){var $u=$J.resultMatrix.a,$S=$J.resultMatrix.b,$Y=$J.resultMatrix.c,$x=$J.resultMatrix.d,$j=Math.atan2($n,$h)-Math.atan2($Y,$u)+this._data.offsetRotation*Math.PI/180;$j>Math.PI?$j-=2*Math.PI:$j<-Math.PI&&($j+=2*Math.PI),$j*=this.rotateMix;var $R=Math.cos($j),$l=Math.sin($j);$J.resultMatrix.a=$R*$u-$l*$Y,$J.resultMatrix.b=$R*$S-$l*$x,$J.resultMatrix.c=$l*$u+$R*$Y,$J.resultMatrix.d=$l*$S+$R*$x;}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),$J.resultMatrix.tx+=(this._temp[0]-$J.resultMatrix.tx)*this.translateMix,$J.resultMatrix.ty+=(this._temp[1]-$J.resultMatrix.ty)*this.translateMix,$J.updateChild()),0<this.scaleMix){var $i=Math.sqrt($J.resultMatrix.a*$J.resultMatrix.a+$J.resultMatrix.c*$J.resultMatrix.c),$q=Math.sqrt($h*$h+$n*$n),$o=1e-5<$i?($i+($q-$i+this._data.offsetScaleX)*this.scaleMix)/$i:0;$J.resultMatrix.a*=$o,$J.resultMatrix.c*=$o,$i=Math.sqrt($J.resultMatrix.b*$J.resultMatrix.b+$J.resultMatrix.d*$J.resultMatrix.d),$q=Math.sqrt($f*$f+$L*$L),$o=1e-5<$i?($i+($q-$i+this._data.offsetScaleY)*this.scaleMix)/$i:0,$J.resultMatrix.b*=$o,$J.resultMatrix.d*=$o;}if(0<this.shearMix){$S=$J.resultMatrix.b,$x=$J.resultMatrix.d;var $r=Math.atan2($x,$S);($j=Math.atan2($L,$f)-Math.atan2($n,$h)-($r-Math.atan2($J.resultMatrix.c,$J.resultMatrix.a)))>Math.PI?$j-=2*Math.PI:$j<-Math.PI&&($j+=2*Math.PI),$j=$r+($j+this._data.offsetShearY*Math.PI/180)*this.shearMix,$o=Math.sqrt($S*$S+$x*$x),$J.resultMatrix.b=Math.cos($j)*$o,$J.resultMatrix.d=Math.sin($j)*$o;}}},$J;}(),$bJ=function(){function $J(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[];}return $n($J,"laya.ani.bone.TfConstraintData"),$J;}(),$vJ=function(){function $J(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null;}$n($J,"laya.ani.bone.Transform");var $h=$J.prototype;return $h.initData=function($J){null!=$J.x&&(this.x=$J.x),null!=$J.y&&(this.y=$J.y),null!=$J.skX&&(this.skX=$J.skX),null!=$J.skY&&(this.skY=$J.skY),null!=$J.scX&&(this.scX=$J.scX),null!=$J.scY&&(this.scY=$J.scY);},$h.getMatrix=function(){var $J;return($J=this.mMatrix?this.mMatrix:this.mMatrix=new $OJ()).identity(),$J.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew($J,this.skewX*Math.PI/180,this.skewY*Math.PI/180),$J.rotate(this.skX*Math.PI/180),$J.translate(this.x,this.y),$J;},$h.skew=function($J,$h,$f){var $n=Math.sin($f),$L=Math.cos($f),$T=Math.sin($h),$k=Math.cos($h);return $J.setTo($J.a*$k-$J.b*$n,$J.a*$T+$J.b*$L,$J.c*$k-$J.d*$n,$J.c*$T+$J.d*$L,$J.tx*$k-$J.ty*$n,$J.tx*$T+$J.ty*$L),$J;},$J;}(),$Q=function(){function $J(){}return $n($J,"laya.ani.bone.UVTools"),$J.getRelativeUV=function($J,$h,$f){var $n=$J[0],$L=$J[2]-$J[0],$T=$J[1],$k=$J[5]-$J[1];$f||($f=[]),$f.length=$h.length;var $u,$S=0;$u=$f.length;var $Y=1/$L,$x=1/$k;for($S=0;$S<$u;$S+=2)$f[$S]=($h[$S]-$n)*$Y,$f[$S+1]=($h[$S+1]-$T)*$x;return $f;},$J.getAbsoluteUV=function($J,$h,$f){if(0==$J[0]&&0==$J[1]&&1==$J[4]&&1==$J[5])return $f?($r.copyArray($f,$h),$f):$h;var $n=$J[0],$L=$J[2]-$J[0],$T=$J[1],$k=$J[5]-$J[1];$f||($f=[]),$f.length=$h.length;var $u,$S=0;for($u=$f.length,$S=0;$S<$u;$S+=2)$f[$S]=$h[$S]*$L+$n,$f[$S+1]=$h[$S+1]*$k+$T;return $f;},$J;}(),$W=function(){function $J(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null;}return $n($J,"laya.ani.KeyFramesContent"),$J;}(),$D=function(){function $x(){}return $n($x,"laya.ani.math.BezierLerp"),$x.getBezierRate=function($J,$h,$f,$n,$L){var $T=$x._getBezierParamKey($h,$f,$n,$L),$k=100*$T+$J;if($x._bezierResultCache[$k])return $x._bezierResultCache[$k];var $u,$S=$x._getBezierPoints($h,$f,$n,$L,$T),$Y=0;for($u=$S.length,$Y=0;$Y<$u;$Y+=2)if($J<=$S[$Y])return $x._bezierResultCache[$k]=$S[$Y+1],$S[$Y+1];return $x._bezierResultCache[$k]=1;},$x._getBezierParamKey=function($J,$h,$f,$n){return 100*(100*(100*(100*$J+$h)+$f)+$n);},$x._getBezierPoints=function($J,$h,$f,$n,$L){return $x._bezierPointsCache[$L]?$x._bezierPointsCache[$L]:($T=[0,0,$J,$h,$f,$n,1,1],$k=new $u().getBezierPoints($T,100,3),$x._bezierPointsCache[$L]=$k);var $T,$k;},$x._bezierResultCache={},$x._bezierPointsCache={},$x;}(),$g=function($J){function $h(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,$h.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1;}$n($h,"laya.ani.AnimationPlayer",$L);var $f=$h.prototype;return $LJ.imps($f,{"laya.resource.IDestroy":!0}),$f._onTempletLoadedComputeFullKeyframeIndices=function($J,$h,$f){this._templet===$f&&this._cachePlayRate===$J&&this._cacheFrameRate===$h&&this._computeFullKeyframeIndices();},$f._computeFullKeyframeIndices=function(){for(var $J=this._fullFrames=[],$h=this._templet,$f=this._cacheFrameRateInterval*this._cachePlayRate,$n=0,$L=$h.getAnimationCount();$n<$L;$n++){for(var $T=[],$k=0,$u=$h.getAnimation($n).nodes.length;$k<$u;$k++){for(var $S=$h.getAnimation($n).nodes[$k],$Y=Math.floor($S.playTime/$f+.01),$x=new Uint16Array($Y+1),$j=-1,$R=0,$l=$S.keyFrame.length;$R<$l;$R++){var $i=$S.keyFrame[$R],$q=$i.startTime,$o=$q+$i.duration+$f;do{for(var $r=Math.floor($q/$f+.5),$_=$j+1;$_<$r;$_++)$x[$_]=$R;$x[$j=$r]=$R,$q+=$f;}while($q<=$o);}$T.push($x);}$J.push($T);}},$f._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration();},$f._calculatePlayDuration=function(){if(0!==this.state){var $J=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=$J),this._playEnd>$J&&(this._playEnd=$J),this._playDuration=this._playEnd-this._playStart;}},$f._setPlayParams=function($J,$h){this._currentTime=$J,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$h+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$h;},$f._setPlayParamsWhenStop=function($J,$h){this._currentTime=$J,this._currentKeyframeIndex=Math.max(Math.floor($J/$h+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$h,this._currentAnimationClipIndex=-1;},$f._update=function($J){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var $h=this._cacheFrameRateInterval*this._cachePlayRate,$f=0;this._startUpdateLoopCount!==$i.loopCount&&($f=$J*this.playbackRate,this._elapsedPlaybackTime+=$f);var $n=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=$n)return this._setPlayParamsWhenStop($n,$h),void this.event("stopped");if($f+=this._currentTime,0<$n){if($n<=$f)do{if($f-=$n,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($n,$h),this._stopWhenCircleFinish=!1,void this.event("stopped");$f<$n&&(this._setPlayParams($f,$h),this.event("complete"));}while($n<=$f);else this._setPlayParams($f,$h);}else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($n,$h),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete");}}},$f._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0;},$f.play=function($J,$h,$f,$n,$L){if(void 0===$J&&($J=0),void 0===$h&&($h=1),void 0===$f&&($f=2147483647),void 0===$n&&($n=0),void 0===$L&&($L=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if($f<0||$n<0||$L<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==$L&&$L<$n)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=$h,this._overallDuration=$f,this._playStart=$n,this._playEnd=$L,this._paused=!1,this._currentAnimationClipIndex=$J,this._currentKeyframeIndex=0,this._startUpdateLoopCount=$i.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0);},$f.playByFrame=function($J,$h,$f,$n,$L,$T){void 0===$J&&($J=0),void 0===$h&&($h=1),void 0===$f&&($f=2147483647),void 0===$n&&($n=0),void 0===$L&&($L=0),void 0===$T&&($T=30);var $k=1e3/$T;this.play($J,$h,$f,$n*$k,$L*$k);},$f.stop=function($J){void 0===$J&&($J=!0),$J?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0;},$T(0,$f,"playEnd",function(){return this._playEnd;}),$T(0,$f,"templet",function(){return this._templet;},function($J){0===!this.state&&this.stop(!0),this._templet!==$J&&((this._templet=$J).loaded?this._computeFullKeyframeIndices():$J.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]));}),$T(0,$f,"playStart",function(){return this._playStart;}),$T(0,$f,"playDuration",function(){return this._playDuration;}),$T(0,$f,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2;}),$T(0,$f,"currentKeyframeIndex",function(){return this._currentKeyframeIndex;}),$T(0,$f,"overallDuration",function(){return this._overallDuration;}),$T(0,$f,"currentFrameTime",function(){return this._currentFrameTime;}),$T(0,$f,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex;}),$T(0,$f,"currentPlayTime",function(){return this._currentTime+this._playStart;}),$T(0,$f,"cachePlayRate",function(){return this._cachePlayRate;},function($J){this._cachePlayRate!==$J&&(this._cachePlayRate=$J,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[$J,this._cacheFrameRate])));}),$T(0,$f,"cacheFrameRate",function(){return this._cacheFrameRate;},function($J){this._cacheFrameRate!==$J&&(this._cacheFrameRate=$J,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,$J])));}),$T(0,$f,"currentTime",null,function($J){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if($J<this._playStart||$J>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=$i.loopCount;var $h=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=$J,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$h),0),this._currentFrameTime=this._currentKeyframeIndex*$h;}}),$T(0,$f,"paused",function(){return this._paused;},function($J){(this._paused=$J)&&this.event("paused");}),$T(0,$f,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval;}),$T(0,$f,"destroyed",function(){return this._destroyed;}),$h;}(),$I=function($J){function $h(){$h.__super.call(this),$o.isConchNode&&(this.drawSkin=function($J){$J.transform||($J.transform=$OJ.EMPTY),this._addCmd([$J]),this.setSkinMesh&&this.setSkinMesh($J._ps,$J.mVBData,$J.mEleNum,0,$J.mTexture,$J.transform);});}return $n($h,"laya.ani.GraphicsAni",$k),$h.prototype.drawSkin=function($J){var $h=[$J];this._saveToCmd($o._context._drawSkin,$h);},$h.create=function(){return $h._caches.pop()||new $h();},$h.recycle=function($J){$J.clear(),$h._caches.push($J);},$h._caches=[],$h;}(),$m=function($J){function $_(){this._aniMap={},this.unfixedLastAniIndex=-1,$_.__super.call(this),this._anis=[];}$n($_,"laya.ani.AnimationTemplet",$x);var $h=$_.prototype;return $h.parse=function($J){var $h=new $yJ($J);this._aniVersion=$h.readUTFString(),$s.parse(this,$h);},$h._calculateKeyFrame=function($J,$h,$f){var $n=$J.keyFrame;$n[$h]=$n[0];for(var $L=0;$L<$h;$L++){var $T=$n[$L];$T.nextData=0===$T.duration?$T.data:$n[$L+1].data;}$n.length--;},$h.onAsynLoaded=function($J,$h,$f){var $n=new $yJ($h);switch(this._aniVersion=$n.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":$d.parse(this,$n);break;default:$s.parse(this,$n);}this._endLoaded();},$h.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null;},$h.getAnimationCount=function(){return this._anis.length;},$h.getAnimation=function($J){return this._anis[$J];},$h.getAniDuration=function($J){return this._anis[$J].playTime;},$h.getNodes=function($J){return this._anis[$J].nodes;},$h.getNodeIndexWithName=function($J,$h){return this._anis[$J].bone3DMap[$h];},$h.getNodeCount=function($J){return this._anis[$J].nodes.length;},$h.getTotalkeyframesLength=function($J){return this._anis[$J].totalKeyframeDatasLength;},$h.getPublicExtData=function(){return this._publicExtData;},$h.getAnimationDataWithCache=function($J,$h,$f,$n){var $L=$h[$f];if($L){var $T=$L[$J];return $T?$T[$n]:null;}return null;},$h.setAnimationDataWithCache=function($J,$h,$f,$n,$L){var $T=$h[$f]||($h[$f]={});($T[$J]||($T[$J]=[]))[$n]=$L;},$h.getOriginalData=function($J,$h,$f,$n,$L){for(var $T=this._anis[$J].nodes,$k=0,$u=0,$S=$T.length,$Y=0;$u<$S;$u++){var $x,$j=$T[$u];$x=$j.keyFrame[$f[$u][$n]],$j.dataOffset=$Y;var $R=$L-$x.startTime,$l=$j.lerpType;if($l)switch($l){case 0:case 1:for($k=0;$k<$j.keyframeWidth;)$k+=$j.interpolationMethod[$k]($j,$k,$h,$Y+$k,$x.data,$R,null,$x.duration,$x.nextData);break;case 2:var $i=$x.interpolationData,$q=$i.length,$o=0;for($k=0;$k<$q;){var $r=$i[$k];switch($r){case 6:case 7:$k+=$_.interpolation[$r]($j,$o,$h,$Y+$o,$x.data,$R,null,$x.duration,$x.nextData,$i,$k+1);break;default:$k+=$_.interpolation[$r]($j,$o,$h,$Y+$o,$x.data,$R,null,$x.duration,$x.nextData);}$o++;}}else for($k=0;$k<$j.keyframeWidth;)$k+=$j.interpolationMethod[$k]($j,$k,$h,$Y+$k,$x.data,$R,null,$x.duration,$x.nextData);$Y+=$j.keyframeWidth;}},$h.getNodesCurrentFrameIndex=function($J,$h){var $f=this._anis[$J].nodes;$J!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($f.length),this.unfixedCurrentTimes=new Float32Array($f.length),this.unfixedLastAniIndex=$J);for(var $n=0,$L=$f.length;$n<$L;$n++){var $T=$f[$n];for($h<this.unfixedCurrentTimes[$n]&&(this.unfixedCurrentFrameIndexes[$n]=0),this.unfixedCurrentTimes[$n]=$h;this.unfixedCurrentFrameIndexes[$n]<$T.keyFrame.length&&!($T.keyFrame[this.unfixedCurrentFrameIndexes[$n]].startTime>this.unfixedCurrentTimes[$n]);)this.unfixedCurrentFrameIndexes[$n]++;this.unfixedCurrentFrameIndexes[$n]--;}return this.unfixedCurrentFrameIndexes;},$h.getOriginalDataUnfixedRate=function($J,$h,$f){var $n=this._anis[$J].nodes;$J!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($n.length),this.unfixedCurrentTimes=new Float32Array($n.length),this.unfixedKeyframes=$q($n.length),this.unfixedLastAniIndex=$J);for(var $L=0,$T=0,$k=$n.length,$u=0;$T<$k;$T++){var $S=$n[$T];for($f<this.unfixedCurrentTimes[$T]&&(this.unfixedCurrentFrameIndexes[$T]=0),this.unfixedCurrentTimes[$T]=$f;this.unfixedCurrentFrameIndexes[$T]<$S.keyFrame.length&&!($S.keyFrame[this.unfixedCurrentFrameIndexes[$T]].startTime>this.unfixedCurrentTimes[$T]);)this.unfixedKeyframes[$T]=$S.keyFrame[this.unfixedCurrentFrameIndexes[$T]],this.unfixedCurrentFrameIndexes[$T]++;var $Y=this.unfixedKeyframes[$T];$S.dataOffset=$u;var $x=$f-$Y.startTime;if($S.lerpType)switch($S.lerpType){case 0:case 1:for($L=0;$L<$S.keyframeWidth;)$L+=$S.interpolationMethod[$L]($S,$L,$h,$u+$L,$Y.data,$x,null,$Y.duration,$Y.nextData);break;case 2:var $j=$Y.interpolationData,$R=$j.length,$l=0;for($L=0;$L<$R;){var $i=$j[$L];switch($i){case 6:case 7:$L+=$_.interpolation[$i]($S,$l,$h,$u+$l,$Y.data,$x,null,$Y.duration,$Y.nextData,$j,$L+1);break;default:$L+=$_.interpolation[$i]($S,$l,$h,$u+$l,$Y.data,$x,null,$Y.duration,$Y.nextData);}$l++;}}else for($L=0;$L<$S.keyframeWidth;)$L+=$S.interpolationMethod[$L]($S,$L,$h,$u+$L,$Y.data,$x,null,$Y.duration,$Y.nextData);$u+=$S.keyframeWidth;}},$_._LinearInterpolation_0=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){var $x=0===$u?0:$T/$u;return $f[$n]=(1-$x)*$L[$h]+$x*$S[$h],1;},$_._QuaternionInterpolation_1=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){var $x=0===$u?0:$T/$u;return $R.slerpQuaternionArray($L,$h,$S,$h,$x,$f,$n),4;},$_._AngleInterpolation_2=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){return 0;},$_._RadiansInterpolation_3=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){return 0;},$_._Matrix4x4Interpolation_4=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){for(var $x=0;$x<16;$x++,$h++)$f[$n+$x]=$L[$h]+$T*$k[$h];return 16;},$_._NoInterpolation_5=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y){return $f[$n]=$L[$h],1;},$_._BezierInterpolation_6=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x){return void 0===$x&&($x=0),$f[$n]=$L[$h]+($S[$h]-$L[$h])*$D.getBezierRate($T/$u,$Y[$x],$Y[$x+1],$Y[$x+2],$Y[$x+3]),5;},$_._BezierInterpolation_7=function($J,$h,$f,$n,$L,$T,$k,$u,$S,$Y,$x){return void 0===$x&&($x=0),$f[$n]=$Y[$x+4]+$Y[$x+5]*$D.getBezierRate((.001*$T+$Y[$x+6])/$Y[$x+7],$Y[$x],$Y[$x+1],$Y[$x+2],$Y[$x+3]),9;},$_.load=function($J){return $LJ.loader.create($J,null,null,$_);},$_.interpolation=[$_._LinearInterpolation_0,$_._QuaternionInterpolation_1,$_._AngleInterpolation_2,$_._RadiansInterpolation_3,$_._Matrix4x4Interpolation_4,$_._NoInterpolation_5,$_._BezierInterpolation_6,$_._BezierInterpolation_7],$_;}(),$F=function($h){function $f($J,$h){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,$f.__super.call(this),void 0===$h&&($h=0),$J&&this.init($J,$h);}$n($f,"laya.ani.bone.Skeleton",$h);var $J=$f.prototype;return $J.init=function($J,$h){void 0===$h&&($h=0);var $f,$n,$L,$T=0,$k=0;if(1==$h)for(this._graphicsCache=[],$T=0,$k=$J.getAnimationCount();$T<$k;$T++)this._graphicsCache.push([]);if(this._yReverseMatrix=$J.yReverseMatrix,this._aniMode=$h,this._templet=$J,this._player=new $g(),this._player.cacheFrameRate=$J.rate,this._player.templet=$J,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=$J.mBoneArr,this._rootBone=$J.mRootBone,this._aniSectionDic=$J.aniSectionDic,0<$J.ikArr.length)for(this._ikArr=[],$T=0,$k=$J.ikArr.length;$T<$k;$T++)this._ikArr.push(new $_($J.ikArr[$T],this._boneList));if(0<$J.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),$T=0,$k=$J.pathArr.length;$T<$k;$T++)$f=$J.pathArr[$T],$n=new $p($f,this._boneList),($L=this._boneSlotDic[$f.name])&&(($n=new $p($f,this._boneList)).target=$L),this._pathDic[$f.name]=$n;if(0<$J.tfArr.length)for(this._tfArr=[],$T=0,$k=$J.tfArr.length;$T<$k;$T++)this._tfArr.push(new $U($J.tfArr[$T],this._boneList));if(0<$J.skinDataArray.length){var $u=this._templet.skinDataArray[this._skinIndex];this._skinName=$u.name;}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause);},$J.load=function($J,$h,$f){},$J._onLoaded=function(){},$J._parseComplete=function(){var $J=$A.TEMPLET_DICTIONARY[this._aniPath];$J&&(this.init($J,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this);},$J._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败");},$J._onPlay=function(){this.event("played");},$J._onStop=function(){var $J,$h=this._templet.eventAniArr[this._aniClipIndex];if($h&&this._eventIndex<$h.length)for(;this._eventIndex<$h.length;this._eventIndex++)($J=$h[this._eventIndex]).time>=this._player.playStart&&$J.time<=this._player.playEnd&&this.event("label",$J);this._eventIndex=0,this._drawOrder=null,this.event("stopped");},$J._onPause=function(){this.event("paused");},$J._parseSrcBoneMatrix=function(){var $J=0,$h=0;for($h=this._templet.srcBoneMatrixArr.length,$J=0;$J<$h;$J++)this._boneMatrixArray.push(new $OJ());if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var $f,$n,$L=this._templet.boneSlotArray;for($J=0,$h=$L.length;$J<$h;$J++)$f=$L[$J],null==($n=this._bindBoneBoneSlotDic[$f.parent])&&(this._bindBoneBoneSlotDic[$f.parent]=$n=[]),this._boneSlotDic[$f.name]=$f=$f.copy(),$n.push($f),this._boneSlotArray.push($f);}},$J._emitMissedEvents=function($J,$h,$f){void 0===$f&&($f=0);var $n=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if($n){var $L,$T,$k=0;for($L=$n.length,$k=$f;$k<$L;$k++)($T=$n[$k]).time>=this._player.playStart&&$T.time<=this._player.playEnd&&this.event("label",$T);}},$J._update=function($J){if(void 0===$J&&($J=!0),!(this._pause||$J&&this._indexControl)){var $h=this.timer.currTimer,$f=this._player.currentKeyframeIndex,$n=$h-this._lastTime;if($J?this._player._update($n):$f=-1,this._lastTime=$h,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<$n&&this._clipIndex==$f&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var $L;this._lastUpdateAniClipIndex=this._aniClipIndex,$f>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var $T,$k=this._templet.eventAniArr[this._aniClipIndex];if($k&&this._eventIndex<$k.length&&(($L=$k[this._eventIndex]).time>=this._player.playStart&&$L.time<=this._player.playEnd?this._player.currentPlayTime>=$L.time&&(this.event("label",$L),this._eventIndex++):this._eventIndex++),0==this._aniMode){if($T=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$T&&(this.graphics=$T));var $u=0,$S=0;for($S=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,$S-1)&&0<$S;)$S--;if($S<this._clipIndex)for($u=$S;$u<this._clipIndex;$u++)this._createGraphics($u);}else if(1==this._aniMode){if($T=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$T&&(this.graphics=$T));for($S=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,$S-1)&&0<$S;)$S--;if($S<this._clipIndex)for($u=$S;$u<this._clipIndex;$u++)this._createGraphics($u);}this._createGraphics();}}},$J._createGraphics=function($J){void 0===$J&&($J=-1),-1==$J&&($J=this._clipIndex);var $h,$f,$n=$J*this._player.cacheFrameRateInterval,$L=this._templet.drawOrderAniArr[this._aniClipIndex];if($L&&0<$L.length)for(this._drawOrderIndex=0,$h=$L[this._drawOrderIndex];$n>=$h.time&&(this._drawOrder=$h.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=$L.length));)$h=$L[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=$I.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=$I.create(),$f=this.graphics;var $T=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],$J,$n);var $k,$u,$S,$Y,$x=this._aniSectionDic[this._aniClipIndex],$j=0,$R=0,$l=0,$i=0,$q=0,$o=this._templet.srcBoneMatrixArr.length;for($q=$x[$R=0];$R<$o;$R++)$Y=this._boneList[$R],$S=this._templet.srcBoneMatrixArr[$R],$Y.resultTransform.scX=$S.scX*this._curOriginalData[$j++],$Y.resultTransform.skX=$S.skX+this._curOriginalData[$j++],$Y.resultTransform.skY=$S.skY+this._curOriginalData[$j++],$Y.resultTransform.scY=$S.scY*this._curOriginalData[$j++],$Y.resultTransform.x=$S.x+this._curOriginalData[$j++],$Y.resultTransform.y=$S.y+this._curOriginalData[$j++],8===this._templet.tMatrixDataLen&&($Y.resultTransform.skewX=$S.skewX+this._curOriginalData[$j++],$Y.resultTransform.skewY=$S.skewY+this._curOriginalData[$j++]);var $r,$_={},$s={};for($q+=$x[1];$R<$q;$R++)$_[($r=$T[$R]).name]=this._curOriginalData[$j++],$s[$r.name]=this._curOriginalData[$j++],this._curOriginalData[$j++],this._curOriginalData[$j++],this._curOriginalData[$j++],this._curOriginalData[$j++];var $d,$p,$U={},$Q={};for($q+=$x[2];$R<$q;$R++)$U[($r=$T[$R]).name]=this._curOriginalData[$j++],$Q[$r.name]=this._curOriginalData[$j++],this._curOriginalData[$j++],this._curOriginalData[$j++],this._curOriginalData[$j++],this._curOriginalData[$j++];if(this._pathDic)for($q+=$x[3];$R<$q;$R++){if($r=$T[$R],$d=this._pathDic[$r.name])switch(new $yJ($r.extenData).getByte()){case 1:$d.position=this._curOriginalData[$j++];break;case 2:$d.spacing=this._curOriginalData[$j++];break;case 3:$d.rotateMix=this._curOriginalData[$j++],$d.translateMix=this._curOriginalData[$j++];}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update($OJ.TEMP.identity()),this._ikArr)for($R=0,$q=this._ikArr.length;$R<$q;$R++)$p=this._ikArr[$R],$U.hasOwnProperty($p.name)&&($p.bendDirection=$U[$p.name]),$Q.hasOwnProperty($p.name)&&($p.mix=$Q[$p.name]),$p.apply();if(this._pathDic)for(var $D in this._pathDic)($d=this._pathDic[$D]).apply(this._boneList,$f);if(this._tfArr)for($R=0,$i=this._tfArr.length;$R<$i;$R++)this._tfArr[$R].apply();for($R=0,$i=this._boneList.length;$R<$i;$R++)if($Y=this._boneList[$R],$u=this._bindBoneBoneSlotDic[$Y.name],$Y.resultMatrix.copyTo(this._boneMatrixArray[$R]),$u)for($l=0,$q=$u.length;$l<$q;$l++)($k=$u[$l])&&$k.setParentMatrix($Y.resultMatrix);var $g,$F,$A,$G,$y={},$O=this._templet.deformAniArr;if($O&&0<$O.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,$R=0,$q=this._boneSlotArray.length;$R<$q;$R++)($k=this._boneSlotArray[$R]).deformData=null;var $P,$W=$O[this._aniClipIndex];for($P in $g=$W.default,this._setDeform($g,$y,this._boneSlotArray,$n),$W)"default"!=$P&&$P!=this._skinName&&($g=$W[$P],this._setDeform($g,$y,this._boneSlotArray,$n));$g=$W[this._skinName],this._setDeform($g,$y,this._boneSlotArray,$n);}if(this._drawOrder)for($R=0,$q=this._drawOrder.length;$R<$q;$R++)$F=$_[($k=this._boneSlotArray[this._drawOrder[$R]]).name],$A=$s[$k.name],isNaN($A)||($f.save(),$f.alpha($A)),isNaN($F)||-2==$F||(this._templet.attachmentNames?$k.showDisplayByName(this._templet.attachmentNames[$F]):$k.showDisplayByIndex($F)),$y[this._drawOrder[$R]]?($G=$y[this._drawOrder[$R]],$k.currDisplayData&&$G[$k.currDisplayData.attachmentName]?$k.deformData=$G[$k.currDisplayData.attachmentName]:$k.deformData=null):$k.deformData=null,isNaN($A)?$k.draw($f,this._boneMatrixArray,2==this._aniMode):$k.draw($f,this._boneMatrixArray,2==this._aniMode,$A),isNaN($A)||$f.restore();else for($R=0,$q=this._boneSlotArray.length;$R<$q;$R++)$F=$_[($k=this._boneSlotArray[$R]).name],$A=$s[$k.name],isNaN($A)||($f.save(),$f.alpha($A)),isNaN($F)||-2==$F||(this._templet.attachmentNames?$k.showDisplayByName(this._templet.attachmentNames[$F]):$k.showDisplayByIndex($F)),$y[$R]?($G=$y[$R],$k.currDisplayData&&$G[$k.currDisplayData.attachmentName]?$k.deformData=$G[$k.currDisplayData.attachmentName]:$k.deformData=null):$k.deformData=null,isNaN($A)?$k.draw($f,this._boneMatrixArray,2==this._aniMode):$k.draw($f,this._boneMatrixArray,2==this._aniMode,$A),isNaN($A)||$f.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,$J,$f):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,$J,$f);},$J._setDeform=function($J,$h,$f,$n){if($J){var $L,$T,$k,$u=0,$S=0,$Y=0;if($J)for($u=0,$S=$J.deformSlotDataList.length;$u<$S;$u++)for($L=$J.deformSlotDataList[$u],$Y=0;$Y<$L.deformSlotDisplayList.length;$Y++)$k=$f[($T=$L.deformSlotDisplayList[$Y]).slotIndex],$T.apply($n,$k),$h[$T.slotIndex]||($h[$T.slotIndex]={}),$h[$T.slotIndex][$T.attachment]=$T.deformData;}},$J.getAnimNum=function(){return this._templet.getAnimationCount();},$J.getAniNameByIndex=function($J){return this._templet.getAniNameByIndex($J);},$J.getSlotByName=function($J){return this._boneSlotDic[$J];},$J.showSkinByName=function($J,$h){void 0===$h&&($h=!0),this.showSkinByIndex(this._templet.getSkinIndexByName($J),$h);},$J.showSkinByIndex=function($J,$h){void 0===$h&&($h=!0);for(var $f=0;$f<this._boneSlotArray.length;$f++)this._boneSlotArray[$f].showSlotData(null,$h);if(this._templet.showSkinByIndex(this._boneSlotDic,$J,$h)){var $n=this._templet.skinDataArray[$J];this._skinIndex=$J,this._skinName=$n.name;}this._clearCache();},$J.showSlotSkinByIndex=function($J,$h){if(0!=this._aniMode){var $f=this.getSlotByName($J);$f&&$f.showDisplayByIndex($h),this._clearCache();}},$J.showSlotSkinByName=function($J,$h){if(0!=this._aniMode){var $f=this.getSlotByName($J);$f&&$f.showDisplayByName($h),this._clearCache();}},$J.replaceSlotSkinName=function($J,$h,$f){if(0!=this._aniMode){var $n=this.getSlotByName($J);$n&&$n.replaceDisplayByName($h,$f),this._clearCache();}},$J.replaceSlotSkinByIndex=function($J,$h,$f){if(0!=this._aniMode){var $n=this.getSlotByName($J);$n&&$n.replaceDisplayByIndex($h,$f),this._clearCache();}},$J.setSlotSkin=function($J,$h){if(0!=this._aniMode){var $f=this.getSlotByName($J);$f&&$f.replaceSkin($h),this._clearCache();}},$J._clearCache=function(){if(1==this._aniMode)for(var $J=0,$h=this._graphicsCache.length;$J<$h;$J++){for(var $f=0,$n=this._graphicsCache[$J].length;$f<$n;$f++){var $L=this._graphicsCache[$J][$f];$L!=this.graphics&&$I.recycle($L);}this._graphicsCache[$J].length=0;}},$J.play=function($J,$h,$f,$n,$L,$T){void 0===$f&&($f=!0),void 0===$n&&($n=0),void 0===$L&&($L=0),void 0===$T&&($T=!0),this._indexControl=!1;var $k=-1,$u=NaN;if($u=$h?2147483647:0,"string"==typeof $J)for(var $S=0,$Y=this._templet.getAnimationCount();$S<$Y;$S++){var $x=this._templet.getAnimation($S);if($x&&$J==$x.name){$k=$S;break;}}else $k=$J;-1<$k&&$k<this.getAnimNum()&&(this._aniClipIndex=$k,($f||this._pause||this._currAniIndex!=$k)&&(this._currAniIndex=$k,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength($k)),this._drawOrder=null,this._eventIndex=0,this._player.play($k,this._player.playbackRate,$u,$n,$L),$T&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=$j.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()));},$J.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update));},$J.playbackRate=function($J){this._player&&(this._player.playbackRate=$J);},$J.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update));},$J.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=$j.now(),this.timer.frameLoop(1,this,this._update,null,!0));},$J._getGrahicsDataWithCache=function($J,$h){return this._graphicsCache[$J][$h];},$J._setGrahicsDataWithCache=function($J,$h,$f){this._graphicsCache[$J][$h]=$f;},$J.destroy=function($J){void 0===$J&&($J=!0),$h.prototype.destroy.call(this,$J),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update);},$T(0,$J,"url",function(){return this._aniPath;},function($J){this.load($J);}),$T(0,$J,"index",function(){return this._index;},function($J){this.player&&(this._index=$J,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1));}),$T(0,$J,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total;}),$T(0,$J,"templet",function(){return this._templet;}),$T(0,$J,"player",function(){return this._player;}),$f.useSimpleMeshInCanvas=!1,$f;}($TJ),$A=function($h){function $L(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,$L.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[];}$n($L,"laya.ani.bone.Templet",$h);var $J=$L.prototype;return $J.getLoadList=function(){return this._loadList;},$J.loadAni=function($J){this._skBufferUrl=$J,$LJ.loader.load($J,$S.create(this,this.onComplete),null,"arraybuffer");},$J.onComplete=function($J){if(this._isDestroyed)this.destroy();else{var $h=$Y.getRes(this._skBufferUrl);$h?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,$h)):this.event("error","load failed:"+this._skBufferUrl);}},$J.parseData=function($J,$h,$f){void 0===$f&&($f=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=$J,this._mainTexture&&$o.isWebGL&&$J.bitmap&&($J.bitmap.enableMerageInAtlas=!1),this._rate=$f,this.parse($h);},$J.buildArmature=function($J){return void 0===$J&&($J=0),new $F(this,$J);},$J.parse=function($J){$h.prototype.parse.call(this,$J),this._endLoaded(),this._aniVersion!=$L.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+$L.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0);},$J._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var $J=0;this._loadList=[];var $h,$f=new $yJ(this.getPublicExtData()),$n=0,$L=0,$T=0,$k=$f.getInt32(),$u=$f.readUTFString(),$S=$u.split("\n");for($J=0;$J<$k;$J++)$h=this._path+$S[2*$J],$u=$S[2*$J+1],$f.getFloat32(),$f.getFloat32(),$n=$f.getFloat32(),$L=$f.getFloat32(),$T=$f.getFloat32(),isNaN($T)?0:$T,$T=$f.getFloat32(),isNaN($T)?0:$T,$T=$f.getFloat32(),isNaN($T)?$n:$T,$T=$f.getFloat32(),isNaN($T)?$L:$T,-1==this._loadList.indexOf($h)&&this._loadList.push($h);this.event("inited",this);}},$J._textureComplete=function(){for(var $J,$h,$f=0,$n=this._loadList.length;$f<$n;$f++)$h=this._loadList[$f],$J=this._textureDic[$h]=$Y.getRes($h),$o.isWebGL&&$J&&$J.bitmap&&($J.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData();},$J._parsePublicExtData=function(){var $J=0,$h=0,$f=0,$n=0,$L=0;for($J=0,$L=this.getAnimationCount();$J<$L;$J++)this._graphicsCache.push([]);var $T;$T="Dragon"!=this._aniClassName;var $k,$u,$S=new $yJ(this.getPublicExtData()),$Y=0,$x=0,$j=0,$R=0,$l=0,$i=0,$q=0,$o=0,$r=0,$_=$S.getInt32(),$s=$S.readUTFString(),$d=$s.split("\n");for($J=0;$J<$_;$J++){if($k=this._mainTexture,$u=this._path+$d[2*$J],$s=$d[2*$J+1],null==this._mainTexture&&($k=this._textureDic[$u]),!$k)return this.event("error",this),void(this.isParseFail=!0);$Y=$S.getFloat32(),$x=$S.getFloat32(),$j=$S.getFloat32(),$R=$S.getFloat32(),$r=$S.getFloat32(),$l=isNaN($r)?0:$r,$r=$S.getFloat32(),$i=isNaN($r)?0:$r,$r=$S.getFloat32(),$q=isNaN($r)?$j:$r,$r=$S.getFloat32(),$o=isNaN($r)?$R:$r,this.subTextureDic[$s]=$PJ.create($k,$Y,$x,$j,$R,-$l,-$i,$q,$o),$k.alphaTexture&&(this.subTextureDic[$s].alphaTexture=$PJ.create($k.alphaTexture,$Y,$x,$j,$R,-$l,-$i,$q,$o));}this._mainTexture=$k;var $p,$U,$Q,$D,$g,$F=$S.getUint16();for($J=0;$J<$F;$J++)($p=[]).push($S.getUint16()),$p.push($S.getUint16()),$p.push($S.getUint16()),$p.push($S.getUint16()),this.aniSectionDic[$J]=$p;var $A,$G=$S.getInt16(),$y={};for($J=0;$J<$G;$J++)$U=new $WJ(),0==$J?$A=$U:$U.root=$A,$U.d=$T?-1:1,$D=$S.readUTFString(),$g=$S.readUTFString(),$U.length=$S.getFloat32(),1==$S.getByte()&&($U.inheritRotation=!1),1==$S.getByte()&&($U.inheritScale=!1),$U.name=$D,$g&&(($Q=$y[$g])?$Q.addChild($U):this.mRootBone=$U),$y[$D]=$U,this.mBoneArr.push($U);this.tMatrixDataLen=$S.getUint16();var $O,$P,$W=$S.getUint16(),$I=Math.floor($W/this.tMatrixDataLen),$m=this.srcBoneMatrixArr;for($J=0;$J<$I;$J++)($O=new $vJ()).scX=$S.getFloat32(),$O.skX=$S.getFloat32(),$O.skY=$S.getFloat32(),$O.scY=$S.getFloat32(),$O.x=$S.getFloat32(),$O.y=$S.getFloat32(),8===this.tMatrixDataLen&&($O.skewX=$S.getFloat32(),$O.skewY=$S.getFloat32()),$m.push($O),($U=this.mBoneArr[$J]).transform=$O;var $Z,$t=$S.getUint16(),$c=0;for($J=0;$J<$t;$J++){for($P=new $BJ(),$c=$S.getUint16(),$h=0;$h<$c;$h++)$P.boneNames.push($S.readUTFString()),$P.boneIndexs.push($S.getInt16());$P.name=$S.readUTFString(),$P.targetBoneName=$S.readUTFString(),$P.targetBoneIndex=$S.getInt16(),$P.bendDirection=$S.getFloat32(),$P.mix=$S.getFloat32(),$P.isSpine=$T,this.ikArr.push($P);}var $a,$B=$S.getUint16(),$V=0;for($J=0;$J<$B;$J++){for($Z=new $bJ(),$V=$S.getUint16(),$h=0;$h<$V;$h++)$Z.boneIndexs.push($S.getInt16());$Z.name=$S.getUTFString(),$Z.targetIndex=$S.getInt16(),$Z.rotateMix=$S.getFloat32(),$Z.translateMix=$S.getFloat32(),$Z.scaleMix=$S.getFloat32(),$Z.shearMix=$S.getFloat32(),$Z.offsetRotation=$S.getFloat32(),$Z.offsetX=$S.getFloat32(),$Z.offsetY=$S.getFloat32(),$Z.offsetScaleX=$S.getFloat32(),$Z.offsetScaleY=$S.getFloat32(),$Z.offsetShearY=$S.getFloat32(),this.tfArr.push($Z);}var $C=$S.getUint16(),$e=0;for($J=0;$J<$C;$J++){for(($a=new $VJ()).name=$S.readUTFString(),$e=$S.getUint16(),$h=0;$h<$e;$h++)$a.bones.push($S.getInt16());$a.target=$S.readUTFString(),$a.positionMode=$S.readUTFString(),$a.spacingMode=$S.readUTFString(),$a.rotateMode=$S.readUTFString(),$a.offsetRotation=$S.getFloat32(),$a.position=$S.getFloat32(),$a.spacing=$S.getFloat32(),$a.rotateMix=$S.getFloat32(),$a.translateMix=$S.getFloat32(),this.pathArr.push($a);}var $H,$b,$v,$$,$M,$X=0,$w=0,$E=0,$N=NaN,$z=0,$K=$S.getInt16();for($J=0;$J<$K;$J++){var $JJ=$S.getUint8(),$hJ={};this.deformAniArr.push($hJ);for(var $fJ=0;$fJ<$JJ;$fJ++)for(($H=new $mJ()).skinName=$S.getUTFString(),$hJ[$H.skinName]=$H,$X=$S.getInt16(),$h=0;$h<$X;$h++)for($b=new $ZJ(),$H.deformSlotDataList.push($b),$w=$S.getInt16(),$f=0;$f<$w;$f++)for($v=new $tJ(),$b.deformSlotDisplayList.push($v),$v.slotIndex=$S.getInt16(),$v.attachment=$S.getUTFString(),$E=$S.getInt16(),$n=0;$n<$E;$n++)for(1==$S.getByte()?$v.tweenKeyList.push(!0):$v.tweenKeyList.push(!1),$N=$S.getFloat32(),$v.timeList.push($N),$$=[],$v.vectices.push($$),$z=$S.getInt16(),$L=0;$L<$z;$L++)$$.push($S.getFloat32());}var $nJ,$LJ,$TJ=$S.getInt16(),$kJ=0,$uJ=0;for($J=0;$J<$TJ;$J++){for($kJ=$S.getInt16(),$M=[],$h=0;$h<$kJ;$h++){for(($nJ=new $cJ()).time=$S.getFloat32(),$uJ=$S.getInt16(),$f=0;$f<$uJ;$f++)$nJ.drawOrder.push($S.getInt16());$M.push($nJ);}this.drawOrderAniArr.push($M);}var $SJ,$YJ=$S.getInt16(),$xJ=0;for($J=0;$J<$YJ;$J++){for($xJ=$S.getInt16(),$LJ=[],$h=0;$h<$xJ;$h++)($SJ=new $aJ()).name=$S.getUTFString(),$SJ.intValue=$S.getInt32(),$SJ.floatValue=$S.getFloat32(),$SJ.stringValue=$S.getUTFString(),$SJ.time=$S.getFloat32(),$LJ.push($SJ);this.eventAniArr.push($LJ);}var $jJ=$S.getInt16();if(0<$jJ)for(this.attachmentNames=[],$J=0;$J<$jJ;$J++)this.attachmentNames.push($S.getUTFString());var $RJ,$lJ,$iJ=$S.getInt16();for($J=0;$J<$iJ;$J++)($RJ=new $IJ()).name=$S.readUTFString(),$RJ.parent=$S.readUTFString(),$RJ.attachmentName=$S.readUTFString(),$RJ.srcDisplayIndex=$RJ.displayIndex=$S.getInt16(),($RJ.templet=this).boneSlotDic[$RJ.name]=$RJ,null==($lJ=this.bindBoneBoneSlotDic[$RJ.parent])&&(this.bindBoneBoneSlotDic[$RJ.parent]=$lJ=[]),$lJ.push($RJ),this.boneSlotArray.push($RJ);var $qJ,$oJ,$rJ,$_J=$S.readUTFString().split("\n"),$sJ=0,$dJ=$S.getUint8(),$pJ=0,$UJ=0,$QJ=0,$DJ=0,$gJ=0,$FJ=0,$AJ=0;for($J=0;$J<$dJ;$J++){for(($qJ=new $CJ()).name=$_J[$sJ++],$pJ=$S.getUint8(),$h=0;$h<$pJ;$h++){for(($oJ=new $HJ()).name=$_J[$sJ++],$RJ=this.boneSlotDic[$oJ.name],$UJ=$S.getUint8(),$f=0;$f<$UJ;$f++){if($rJ=new $eJ(),this.skinSlotDisplayDataArr.push($rJ),$rJ.name=$_J[$sJ++],$rJ.attachmentName=$_J[$sJ++],$rJ.transform=new $vJ(),$rJ.transform.scX=$S.getFloat32(),$rJ.transform.skX=$S.getFloat32(),$rJ.transform.skY=$S.getFloat32(),$rJ.transform.scY=$S.getFloat32(),$rJ.transform.x=$S.getFloat32(),$rJ.transform.y=$S.getFloat32(),$oJ.displayArr.push($rJ),$rJ.width=$S.getFloat32(),$rJ.height=$S.getFloat32(),$rJ.type=$S.getUint8(),$rJ.verLen=$S.getUint16(),0<($G=$S.getUint16()))for($rJ.bones=[],$n=0;$n<$G;$n++){var $GJ=$S.getUint16();$rJ.bones.push($GJ);}if(0<($QJ=$S.getUint16()))for($rJ.uvs=[],$n=0;$n<$QJ;$n++)$rJ.uvs.push($S.getFloat32());if(0<($DJ=$S.getUint16()))for($rJ.weights=[],$n=0;$n<$DJ;$n++)$rJ.weights.push($S.getFloat32());if(0<($gJ=$S.getUint16()))for($rJ.triangles=[],$n=0;$n<$gJ;$n++)$rJ.triangles.push($S.getUint16());if(0<($FJ=$S.getUint16()))for($rJ.vertices=[],$n=0;$n<$FJ;$n++)$rJ.vertices.push($S.getFloat32());if(0<($AJ=$S.getUint16()))for($rJ.lengths=[],$n=0;$n<$AJ;$n++)$rJ.lengths.push($S.getFloat32());}$qJ.slotArr.push($oJ);}this.skinDic[$qJ.name]=$qJ,this.skinDataArray.push($qJ);}1==$S.getUint8()?(this.yReverseMatrix=new $OJ(1,0,0,-1,0,0),$A&&$A.setTempMatrix(this.yReverseMatrix)):$A&&$A.setTempMatrix(new $OJ()),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this);},$J.getTexture=function($J){var $h=this.subTextureDic[$J];return $h||($h=this.subTextureDic[$J.substr(0,$J.length-1)]),null==$h?this._mainTexture:$h;},$J.showSkinByIndex=function($J,$h,$f){if(void 0===$f&&($f=!0),$h<0&&$h>=this.skinDataArray.length)return!1;var $n,$L,$T=0,$k=0,$u=this.skinDataArray[$h];if($u){for($T=0,$k=$u.slotArr.length;$T<$k;$T++)($L=$u.slotArr[$T])&&($n=$J[$L.name])&&($n.showSlotData($L,$f),$f&&"undefined"!=$n.attachmentName&&"null"!=$n.attachmentName?$n.showDisplayByName($n.attachmentName):$n.showDisplayByIndex($n.displayIndex));return!0;}return!1;},$J.getSkinIndexByName=function($J){for(var $h=0,$f=this.skinDataArray.length;$h<$f;$h++)if(this.skinDataArray[$h].name==$J)return $h;return-1;},$J.getGrahicsDataWithCache=function($J,$h){return this._graphicsCache[$J][$h];},$J.setGrahicsDataWithCache=function($J,$h,$f){this._graphicsCache[$J][$h]=$f;},$J.destroy=function(){var $J;for(var $h in this._isDestroyed=!0,this.subTextureDic)($J=this.subTextureDic[$h])&&$J.destroy();for($h in this._textureDic)($J=this._textureDic[$h])&&$J.destroy();for(var $f=0,$n=this.skinSlotDisplayDataArr.length;$f<$n;$f++)this.skinSlotDisplayDataArr[$f].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete $L.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this);},$J.getAniNameByIndex=function($J){var $h=this.getAnimation($J);return $h?$h.name:null;},$T(0,$J,"rate",function(){return this._rate;},function($J){this._rate=$J;}),$L.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",$L.TEMPLET_DICTIONARY=null,$L;}($m);}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($J,$h){"use strict";for(var $f in Object.defineProperty($h,"__esModule",{value:!0}),Laya){var $n=Laya[$f];$n&&$n.__isclass&&($h[$f]=$n);}});