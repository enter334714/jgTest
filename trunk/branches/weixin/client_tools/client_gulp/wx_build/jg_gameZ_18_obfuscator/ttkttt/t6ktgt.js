var v=wx.$d;import XXSdk from"../utils/xxsdk.min";var config={game_id:256,game_pkg:v[1799],partner_label:v[1800],partner_id:v[1801],game_ver:v[1802],is_auth:!1,appId:v[1803],appBundleId:v[1804],appName:v[1805]};window.config=config;var D$H5$Q4=D$H$4Q5();var HOST=v[1806];var D$H5$4Q=null;var D$H$Q45=null;var sysInfo=wx.getSystemInfoSync();var platform=sysInfo.platform;var partner_user_info=null;const sdk=new XXSdk;function D$H$4Q5(){var n={};return{order_data:{},init:function(e,t){e=e&&e.game_ver?e.game_ver:0;console.log(v[1807]);var r=this;var o;o=wx.getStorageSync(v[1808])?0:(o=r.uuid(16,32),wx.setStorageSync(v[1808],o),1),wx.getStorageSync(v[1809])||(n=r.uuid(16,32),wx.setStorageSync(v[1809],n));var n=wx.getLaunchOptionsSync();var a=n.scene||"";o&&n.query&&n.query.ad_code&&wx.setStorageSync(v[1810],n.query.ad_code),r.log(v[1811],{install:o,scene:a}),wx.showShareMenu();r=n.query&&n.query.invite?n.query.invite:"";n=n.query&&n.query.invite_type?n.query.invite_type:"";r&&(D$H$Q45={invite:r,invite_type:n,is_new:o,scene:a}),sdk.init({appId:config.appId,appBundleId:config.appBundleId,appName:config.appName}).then(e=>{console.log(v[1812],e)}).catch(e=>{console.log(v[1813],e),t(1,{errMsg:v[1814]})}),e&&this.checkGameVersion(e,function(e){t&&t(e)})},login:function(e,t){console.log(v[1815]),n[v[1177]]=typeof t==v[130]?t:null;var r=this;console.log(sdk),sdk.login().then(e=>{1==e.code?(partner_user_info={userToken:e.sdkUserInfo[v[285]],uid:e.sdkUserInfo.id,openId:e.sdkUserInfo[v[1816]]},r.do_login(partner_user_info),console.log(v[1817]+JSON.stringify(e))):(t(1,{errMsg:v[1818]}),console.log(v[1819]+JSON.stringify(e)))}).catch(e=>{t(1,{errMsg:v[1818]}),console.log(v[1819]+JSON.stringify(e))})},do_login:function(e){var t=this.getPublicData();if(t[v[1820]]=JSON.stringify(e),D$H$Q45&&typeof D$H$Q45==v[13])for(var r in D$H$Q45)t[r]=D$H$Q45[r];wx.request({url:v[1821]+HOST+v[1822],method:v[1145],dataType:v[393],header:{"content-type":v[1321]},data:t,success:function(e){if(console.log(v[1823]+JSON.stringify(e)),200==e.statusCode){e=e.data;if(e.state){try{wx.getStorageSync(v[1824])||wx.setStorageSync(v[1825],new Date),Date.parse(wx.getStorageSync(v[1825])).toString().substr(0,10),partner_user_info={open_id:e.data.ext,user_id:e.data.user_id},wx.setStorageSync(v[1826],e.data.sdk_token),wx.setStorageSync(v[1824],e.data.user_id),wx.setStorageSync(v[1827],e.data.username),e.data.ext&&wx.setStorageSync(v[1828],e.data.ext)}catch(e){}var t={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};n[v[1177]]&&n[v[1177]](0,t)}else n[v[1177]]&&n[v[1177]](1,{errMsg:e.msg})}else n[v[1177]]&&n[v[1177]](1,{errMsg:v[1829]})}})},share:function(e){n[v[1281]]=typeof callback==v[130]?callback:null;var t=e.type||v[1281];console.log(v[1830]+t);var r=this;this.getShareInfo(t,function(e){r.logStartShare(t);e.query;r.logStartShare(t),wx.shareAppMessage({title:e.title,imageUrl:e.img,query:e.query})})},logStartShare:function(e){var t=wx.getStorageSync(v[1826]);wx.request({url:v[1821]+HOST+v[1831],method:v[1145],dataType:v[393],header:{"content-type":v[1321]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,server_id:D$H5$4Q?D$H5$4Q.server_id:"",role_id:D$H5$4Q?D$H5$4Q.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,r){console.log(v[1832]);wx.getStorageSync(v[1826]);wx.request({url:v[1821]+HOST+v[1833],method:v[1145],dataType:v[393],header:{"content-type":v[1321]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var t;console.log(v[1834]+JSON.stringify(e)),200==e.statusCode&&(t=e.data).state?r&&r(t.data):r&&r({develop:0})}})},getShareInfo:function(e,t){console.log(v[1835]);var r=wx.getStorageSync(v[1826]);wx.request({url:v[1821]+HOST+v[1836],method:v[1145],dataType:v[393],header:{"content-type":v[1321]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,type:e,server_id:D$H5$4Q?D$H5$4Q.server_id:"",role_id:D$H5$4Q?D$H5$4Q.role_id:"",no_log:1},success:function(e){console.log(v[1837]),console.log(e),200==e.statusCode?(e=e.data).state?t&&t(e.data):n[v[1281]]&&n[v[1281]](1,{errMsg:v[1838]+e.msg}):n[v[1281]]&&n[v[1281]](1,{errMsg:v[1839]})}})},updateShare:function(e,t,r,o,n,a){console.log(v[1840]);var i=wx.getStorageSync(v[1826]);wx.request({url:v[1821]+HOST+v[1841],method:v[1145],dataType:v[393],header:{"content-type":v[1321]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:t,is_new:r,role_id:o,sever_id:n,scene:a},success:function(e){console.log(v[1842]+JSON.stringify(e))}})},msgCheck2:function(e,t){console.log(v[1843],e),sdk.msgSecCheck(e).then(e=>{console.log(v[1812],e),t&&t(e)}).catch(e=>{console.log(v[1813],e),t&&t(res)})},msgCheck:function(e,t){console.log(v[1843],e);let r={data:{}};e={scene:4,content:e};sdk.msgSecCheck(e).then(e=>{console.log(v[1812],e),1==e.code?(e.data.result.suggest==v[1844]?r.data.state=1:r.data.state=0,r.statusCode=200):(r.data.state=0,r.statusCode=0),t&&t(r)}).catch(e=>{console.log(v[1813],e),r.data.state=0,r.statusCode=0,t&&t(r)})},pay:function(e,t){this.startPay(e,t)},startPay:function(e,t){console.log(v[1845]+JSON.stringify(e));n[v[1263]]=typeof t==v[130]?t:null;t=wx.getStorageSync(v[1826]);var r=wx.getStorageSync(v[1828]);var o;t?(o={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:t,session_key:r,platform:platform},this.order_data=o,(e=this.getPublicData())[v[1847]]=JSON.stringify(o),wx.request({url:v[1821]+HOST+v[1848],method:v[1145],dataType:v[393],header:{"content-type":v[1321]},data:e,success:function(e){var t;console.log(v[1849]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?""==e.data.ext?(t={server:o.serverid,item:o.productname,item_id:o.productid,amount:o.price,cp_order_id:e.data.orderId,role_id:o.roleid,role_level:o.rolelevel,role_name:o.rolename,cp_extra_info:o.extension},console.log(v[1850]+JSON.stringify(t)),sdk.createOrder(t).then(e=>{console.log(v[1812],e)}).catch(e=>{console.log(v[1813],e)})):(t={ext1:e.data.ext,ext2:{pay_data:{orderId:e.data.orderId,amount:o.price}}},console.log(v[1851],t)):n[v[1263]]&&n[v[1263]](1,{errMsg:e.msg}):n[v[1177]]&&n[v[1177]](1,{errMsg:v[1829]})}})):n[v[1263]]&&n[v[1263]](1,{errMsg:v[1846]})},extDo:function(e){wx.navigateToMiniProgram({appId:e.ext1,path:v[1852]+e.ext2.pay_data.orderId+v[1853]+e.ext2.pay_data.amount,extraData:{},envVersion:v[1854],success(e){}})},gameGoPay:function(e,t){console.log(v[1855]);wx.getStorageSync(v[1828]);wx.request({url:v[1821]+HOST+v[1856]+config.partner_id+"/"+config.game_pkg+"/",method:v[1145],dataType:v[393],header:{"content-type":v[1321]},data:{uid:partner_user_info.user_id,open_id:partner_user_info.open_id,user_create_time:wx.getStorageSync(v[1825]),in_sandbox:t.sandbox,cp_order_no:e.cpbill,amount:e.price},success:function(e){console.log(v[1857]),console.log(e),200==e.statusCode&&(1==e.data.state?n[v[1263]]&&n[v[1263]](0,{}):n[v[1263]]&&n[v[1263]](1,{errMsg:v[1858]}))},fail:function(){}})},logCreateRole:function(e){var t=wx.getStorageSync(v[1824]);var r=wx.getStorageSync(v[1827]);var o={};o[v[1859]]=t,o[v[1860]]=r,o[v[1861]]=e.roleid,o[v[1862]]=e.rolelevel,o[v[1863]]=e.rolename,o[v[956]]=e.serverid,console.log(v[1864],o),e.roleid&&e.serverid&&(D$H5$4Q={role_id:e.roleid,server_id:e.serverid}),this.log(v[14],o),Date.parse(new Date).toString().substr(0,10),sdk.updateRole({id:e.roleid,name:e.rolename,level:e.rolelevel,server:e.serverid})},logEnterGame:function(e){var t=wx.getStorageSync(v[1824]);var r=wx.getStorageSync(v[1827]);var o={};o[v[1859]]=t,o[v[1860]]=r,o[v[1861]]=e.roleid,o[v[1862]]=e.rolelevel,o[v[1863]]=e.rolename,o[v[956]]=e.serverid,e.roleid&&e.serverid&&(D$H5$4Q={role_id:e.roleid,server_id:e.serverid}),this.log(v[1865],o),D$H$Q45&&this.updateShare(D$H$Q45.invite,D$H$Q45.invite_type,D$H$Q45.is_new,e.roleid,e.serverid,D$H$Q45.scene)},logRoleUpLevel:function(e){var t=wx.getStorageSync(v[1824]);var r=wx.getStorageSync(v[1827]);var o={};o[v[1859]]=t,o[v[1860]]=r,o[v[1861]]=e.roleid,o[v[1862]]=e.rolelevel,o[v[1863]]=e.rolename,o[v[956]]=e.serverid,e.roleid&&e.serverid&&(D$H5$4Q={role_id:e.roleid,server_id:e.serverid}),this.log(v[1866],o),sdk.updateRole({id:e.roleid,name:e.rolename,level:e.rolelevel,server:e.serverid})},uuid:function(e,t){var r=v[1867].split("");var o,n=[];var a;if(e=e||r.length,t)for(o=0;o<t;o++)n[o]=r[0|Math.random()*e];else for(n[8]=n[13]=n[18]=n[23]="-",n[14]="4",o=0;o<36;o++)n[o]||(a=0|16*Math.random(),n[o]=r[19==o?3&a|8:a]);return n.join("")},getPublicData:function(){var e=wx.getStorageSync(v[1808]);var t=wx.getStorageSync(v[1809]);var r=wx.getStorageSync(v[1810]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:r,uuid:e,idfv:t,mac:v[1868],is_from_min:1,dname:sysInfo.model,net_type:0==sysInfo.wifiSignal?"4G":v[1869],os_ver:sysInfo.system,sdk_ver:sysInfo.version,game_ver:config.game_ver,device:sysInfo.platform==v[1036]?1:2}},subscribeMessage:function(e,t){console.log(v[1870]+e),n[v[1292]]=typeof t==v[130]?t:null,wx.requestSubscribeMessage({tmplIds:e,success(e){console.log(v[1871]),console.log(e),n[v[1292]]&&n[v[1292]](e)},fail(e){console.log(v[1872]),console.log(e),n[v[1292]]&&n[v[1292]](e)}})},log:function(e,t){var r=this.getPublicData();for(var o in t)r[o]=t[o];console.log(v[1873]+e),console.log(r),wx.request({url:v[1821]+HOST+v[1874]+e+v[1875]+encodeURIComponent(JSON.stringify(r))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){},reportStart:function(){JYSDK.sendLoadingLog(v[1811])},reportEnd:function(){JYSDDK.sendLoadingLog(v[334])},setMessageToFriendQuery:function(e,t){e=e.activity_id;t(wx.setMessageToFriendQuery({shareMessageToFriendScene:e}))}}}function run(e,t,r){e in D$H5$Q4&&D$H5$Q4[e](t,r)}exports.init=function(e,t){run(v[1156],e,t)},exports.subscribeMessage=function(e,t){run(v[1292],e,t)},exports.login=function(e){run(v[1177],"",e)},exports.login=function(e){run(v[1177],"",e)},exports.pay=function(e,t){run(v[1263],e,t)},exports.openService=function(){run(v[1282])},exports.logCreateRole=function(e,t,r,o,n){run(v[1276],{serverid:e,servername:t,roleid:r,rolename:o,rolelevel:n})},exports.logEnterGame=function(e,t,r,o,n){run(v[1278],{serverid:e,servername:t,roleid:r,rolename:o,rolelevel:n})},exports.logRoleUpLevel=function(e,t,r,o,n){run(v[1280],{serverid:e,servername:t,roleid:r,rolename:o,rolelevel:n})},exports.share=function(e){run(v[1281],{type:e})},exports.msgCheck=function(e,t){run(v[1123],e,t)},exports.downloadClient=function(){run(v[1876])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(v[1877])},exports.weiduanHelper=function(){run(v[1284])},exports.reportStart=function(){run(v[1878])},exports.reportEnd=function(){run(v[1879])},exports.setMessageToFriendQuery=function(e,t){run(v[1880],e,t)};