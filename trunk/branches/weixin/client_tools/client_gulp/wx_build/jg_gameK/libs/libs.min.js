var Laya=window.Laya=function(k$j,k$a){var k$k={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(k$a,k$b){return 1==arguments.length?k$k.__presubstr.call(this,k$a):k$k.__presubstr.call(this,k$a,0<k$b?k$b:this.length+k$b)},__init:function(k$a){k$a.forEach(function(k$a){k$a.__init$&&k$a.__init$()})},__isClass:function(k$a){return k$a&&(k$a.__isclass||k$a==Object||k$a==String||k$a==Array)},__newvec:function(k$a,k$b){var k$c=[];k$c.length=k$a;for(var k$d=0;k$d<k$a;k$d++)k$c[k$d]=k$b;return k$c},__extend:function(k$a,k$b){for(var k$c in k$b)if(k$b.hasOwnProperty(k$c)){var k$d=Object.getOwnPropertyDescriptor(k$b,k$c),k$e=k$d.get,k$f=k$d.set;k$e||k$f?k$e&&k$f?Object.defineProperty(k$a,k$c,k$d):(k$e&&Object.defineProperty(k$a,k$c,k$e),k$f&&Object.defineProperty(k$a,k$c,k$f)):k$a[k$c]=k$b[k$c]}function k$g(){k$k.un(this,"constructor",k$a)}k$g.prototype=k$b.prototype,k$a.prototype=new k$g,k$k.un(k$a.prototype,"__imps",k$k.__copy({},k$b.prototype.__imps))},__copy:function(k$a,k$b){if(!k$b)return null;for(var k$c in k$a=k$a||{},k$b)k$a[k$c]=k$b[k$c];return k$a},__package:function(k$a,k$b){if(!k$k.__packages[k$a]){k$k.__packages[k$a]=!0;var k$c=k$j,k$d=k$a.split(".");if(1<k$d.length)for(var k$e=0,k$f=k$d.length-1;k$e<k$f;k$e++){var k$g=k$c[k$d[k$e]];k$c=k$g||(k$c[k$d[k$e]]={})}k$c[k$d[k$d.length-1]]||(k$c[k$d[k$d.length-1]]=k$b||{})}},__hasOwnProperty:function(k$a,k$b){return k$b=k$b||this,Object.hasOwnProperty.call(k$b,k$a)||function k$a(k$b,k$c){if(Object.hasOwnProperty.call(k$c.prototype,k$b))return!0;var k$d=k$c.prototype.__super;return null==k$d?null:k$a(k$b,k$d)}(k$a,k$b.__class)},__typeof:function(k$a,k$b){if(!k$a||!k$b)return!1;if(k$b===String)return"string"==typeof k$a;if(k$b===Number)return"number"==typeof k$a;if(k$b.__interface__)k$b=k$b.__interface__;else if("string"!=typeof k$b)return k$a instanceof k$b;return k$a.__imps&&k$a.__imps[k$b]||k$a.__class==k$b},__as:function(k$a,k$b){return this.__typeof(k$a,k$b)?k$a:null},__int:function(k$a){return k$a?parseInt(k$a):0},interface:function(k$a,k$b){k$k.__package(k$a,{});var k$c=k$k.__internals,k$d=k$c[k$a]=k$c[k$a]||{self:k$a};if(k$b){var k$e=k$b.split(",");k$d.extend=[];for(var k$f=0;k$f<k$e.length;k$f++){var k$g=k$e[k$f];k$c[k$g]=k$c[k$g]||{self:k$g},k$d.extend.push(k$c[k$g])}}var k$h=k$j,k$i=k$a.split(".");for(k$f=0;k$f<k$i.length-1;k$f++)k$h=k$h[k$i[k$f]];k$h[k$i[k$i.length-1]]={__interface__:k$a}},class:function(k$a,k$b,k$c,k$d){if(k$c&&k$k.__extend(k$a,k$c),k$b)if(k$k.__package(k$b,k$a),k$k.__classmap[k$b]=k$a,0<k$b.indexOf(".")){if(0==k$b.indexOf("laya.")){var k$e=k$b.split(".");k$d=k$d||k$e[k$e.length-1],k$k[k$d]&&console.log("Warning!,this class["+k$d+"] already exist:",k$k[k$d]),k$k[k$d]=k$a}}else"Main"==k$b?k$j.Main=k$a:"MainWX"==k$b?k$j.MainWX=k$a:(k$k[k$b]&&console.log("Error!,this class["+k$b+"] already exist:",k$k[k$b]),k$k[k$b]=k$a);var k$f=k$k.un,k$g=k$a.prototype;k$f(k$g,"hasOwnProperty",k$k.__hasOwnProperty),k$f(k$g,"__class",k$a),k$f(k$g,"__super",k$c),k$f(k$g,"__className",k$b),k$f(k$a,"__super",k$c),k$f(k$a,"__className",k$b),k$f(k$a,"__isclass",!0),k$f(k$a,"super",function(k$a){this.__super.call(k$a)})},imps:function(k$a,k$b){if(!k$b)return null;var k$e=k$a.__imps||k$k.un(k$a,"__imps",{});function k$f(k$a){var k$b,k$c;if((k$b=k$k.__internals[k$a])&&(k$e[k$a]=!0,k$c=k$b.extend))for(var k$d=0;k$d<k$c.length;k$d++)k$f(k$c[k$d].self)}for(var k$c in k$b)k$f(k$c)},superSet:function(k$a,k$b,k$c,k$d){var k$e=k$a.prototype["_$set_"+k$c];k$e&&k$e.call(k$b,k$d)},superGet:function(k$a,k$b,k$c){var k$d=k$a.prototype["_$get_"+k$c];return k$d?k$d.call(k$b):null},getset:function(k$a,k$b,k$c,k$d,k$e){k$a?(k$d&&(k$b["_$GET_"+k$c]=k$d),k$e&&(k$b["_$SET_"+k$c]=k$e)):(k$d&&k$k.un(k$b,"_$get_"+k$c,k$d),k$e&&k$k.un(k$b,"_$set_"+k$c,k$e)),k$d&&k$e?Object.defineProperty(k$b,k$c,{get:k$d,set:k$e,enumerable:!1,configurable:!0}):(k$d&&Object.defineProperty(k$b,k$c,{get:k$d,enumerable:!1,configurable:!0}),k$e&&Object.defineProperty(k$b,k$c,{set:k$e,enumerable:!1,configurable:!0}))},static:function(k$c,k$d){for(var k$e=0,k$a=k$d.length;k$e<k$a;k$e+=2)if("length"==k$d[k$e])k$c.length=k$d[k$e+1].call(k$c);else{function k$b(){var k$b=k$d[k$e],k$a=k$d[k$e+1];Object.defineProperty(k$c,k$b,{get:function(){return delete this[k$b],this[k$b]=k$a.call(this)},set:function(k$a){delete this[k$b],this[k$b]=k$a},enumerable:!0,configurable:!0})}k$b()}},un:function(k$a,k$b,k$c){return k$c||(k$c=k$a[k$b]),k$k.__propun.value=k$c,Object.defineProperty(k$a,k$b,k$k.__propun),k$c},uns:function(k$b,k$a){k$a.forEach(function(k$a){k$k.un(k$b,k$a)})}};return k$j.console=k$j.console||{log:function(){}},k$j.trace=k$j.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),k$k}(window,document);!function(k$a,k$b,k$c){k$c.un,k$c.uns,k$c.static,k$c.class,k$c.getset,k$c.__newvec}(window,document,Laya),function(k$g,k$b,k$z){k$z.un,k$z.uns;var k$i=k$z.static,k$k=k$z.class,k$o=k$z.getset;k$z.__newvec;k$z.interface("laya.runtime.IMarket"),k$z.interface("laya.filters.IFilter"),k$z.interface("laya.display.ILayout"),k$z.interface("laya.resource.IDispose"),k$z.interface("laya.runtime.IPlatform"),k$z.interface("laya.resource.IDestroy"),k$z.interface("laya.runtime.IConchNode"),k$z.interface("laya.filters.IFilterAction"),k$z.interface("laya.runtime.ICPlatformClass"),k$z.interface("laya.resource.ICreateResource"),k$z.interface("laya.runtime.IConchRenderObject"),k$z.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var k$F=function(){function k$f(){}return k$k(k$f,"laya.utils.RunDriver"),k$f.FILTER_ACTIONS=[],k$f.pixelRatio=-1,k$f._charSizeTestDiv=null,k$f.now=function(){return Date.now()},k$f.getWindow=function(){return k$g},k$f.getPixelRatio=function(){if(k$f.pixelRatio<0){var k$a=k$O.context,k$b=k$a.backingStorePixelRatio||k$a.webkitBackingStorePixelRatio||k$a.mozBackingStorePixelRatio||k$a.msBackingStorePixelRatio||k$a.oBackingStorePixelRatio||k$a.backingStorePixelRatio||1;(k$f.pixelRatio=(k$O.window.devicePixelRatio||1)/k$b)<1&&(k$f.pixelRatio=1)}return k$f.pixelRatio},k$f.getIncludeStr=function(k$a){return null},k$f.createShaderCondition=function(k$a){var k$b="(function() {return "+k$a+";})";return k$z._runScript(k$b)},k$f.fontMap=[],k$f.measureText=function(k$a,k$b){var k$c=k$f.hanzi.test(k$a);if(k$c&&k$f.fontMap[k$b])return k$f.fontMap[k$b];var k$d=k$O.context;k$d.font=k$b;var k$e=k$d.measureText(k$a);return k$c&&(k$f.fontMap[k$b]=k$e),k$e},k$f.getWebGLContext=function(k$a){},k$f.beginFlush=function(){},k$f.endFinish=function(){},k$f.addToAtlas=null,k$f.flashFlushImage=function(k$a){},k$f.drawToCanvas=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=k$ta.create("2D"),k$h=new k$K(k$c,k$d,k$g);return k$L.renders[k$b]._fun(k$a,k$h,k$e,k$f),k$g},k$f.createParticleTemplate2D=null,k$f.createGLTextur=null,k$f.createWebGLContext2D=null,k$f.changeWebGLSize=function(k$a,k$b){},k$f.createRenderSprite=function(k$a,k$b){return new k$L(k$a,k$b)},k$f.createFilterAction=function(k$a){return new k$t},k$f.createGraphics=function(){return new k$m},k$f.clear=function(k$a){k$J._context.ctx.clear()},k$f.cancelLoadByUrl=function(k$a){},k$f.clearAtlas=function(k$a){},k$f.isAtlas=function(k$a){return!1},k$f.addTextureToAtlas=function(k$a){},k$f.getTexturePixels=function(k$a,k$b,k$c,k$d,k$e){return null},k$f.skinAniSprite=function(){return null},k$f.update3DLoop=function(){},k$i(k$f,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),k$f}(),k$d=(k$o(1,k$z,"alertGlobalError",null,function(k$a){var k$f=0;k$O.window.onerror=k$a?function(k$a,k$b,k$c,k$d,k$e){k$f++<5&&k$e&&alert(k$e.stack||k$e)}:null}),k$z.init=function(k$a,k$b,k$c){for(var k$d=[],k$e=2,k$f=arguments.length;k$e<k$f;k$e++)k$d.push(arguments[k$e]);if(!k$z._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=k$z._arrayBufferSlice),k$z._isinit=!0,k$O.__init__(),k$M.__init__(),k$m.__init__(),k$z.timer=new k$Y,k$z.scaleTimer=new k$Y,k$z.loader=new k$ia,k$u.__init__(),k$e=0;for(var k$g=k$d.length;k$e<k$g;k$e++)k$d[k$e].enable&&k$d[k$e].enable();return k$n.__init__(),k$h.__init__(),k$N.__init__(),k$Q.beginCheck(),k$z._currentStage=k$z.stage=new k$ra,k$z.stage.conchModel&&k$z.stage.conchModel.setRootNode(),k$z._getUrlPath(),k$z.render=new k$J(0,0),k$z.stage.size(k$a,k$b),k$L.__init__(),k$l.__init__(),k$p.instance.__init__(k$z.stage,k$J.canvas),k$xa.__init__(),k$E.autoStopMusic=!0,k$C.__init__(),k$J.canvas}},k$z._getUrlPath=function(){var k$a=k$O.window.location,k$b=k$a.pathname;k$b=k$b&&":"==k$b.charAt(2)?k$b.substring(1):k$b,k$I.rootPath=k$I.basePath=k$I.getPath("file:"==k$a.protocol?k$b:k$a.protocol+"//"+k$a.host+k$a.pathname)},k$z._arrayBufferSlice=function(k$a,k$b){var k$c=new Uint8Array(this,k$a,k$b-k$a),k$d=new Uint8Array(k$c.length);return k$d.set(k$c),k$d.buffer},k$z._runScript=function(k$a){return k$O.window[k$z._evcode](k$a)},k$z.stage=null,k$z.timer=null,k$z.scaleTimer=null,k$z.loader=null,k$z.version="1.8.6",k$z.render=null,k$z._currentStage=null,k$z._isinit=!1,k$z.isDebug=!1,k$z.MiniAdpter={init:function(){k$g.navigator&&k$g.navigator.userAgent&&-1<k$g.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},k$i(k$z,["conchMarket",function(){return this.conchMarket=k$g.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=k$g.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function k$a(){}return k$k(k$a,"Config"),k$a.WebGLTextCacheCount=500,k$a.atlasEnable=!1,k$a.showCanvasMark=!1,k$a.animationInterval=50,k$a.isAntialias=!1,k$a.isAlpha=!1,k$a.premultipliedAlpha=!0,k$a.isStencil=!0,k$a.preserveDrawingBuffer=!1,k$a}()),k$j=function(){function k$j(){this._events=null}k$k(k$j,"laya.events.EventDispatcher");var k$a=k$j.prototype;return k$a.hasListener=function(k$a){return!!(this._events&&this._events[k$a])},k$a.event=function(k$a,k$b){if(!this._events||!this._events[k$a])return!1;var k$c=this._events[k$a];if(k$c.lock)k$c.queue||(k$c.queue=[]),k$c.queue.push(k$b);else{var k$d;for(k$c.lock=!0,k$c.cursor=k$c.head;k$c.cursor;)k$d=k$c.cursor,k$c.cursor=k$d.next,k$d.once&&k$j.delNode(k$c,k$d),null!=k$b?k$d.args?k$d.method.apply(k$d.caller,k$d.args.concat(k$b)):k$b instanceof Array?k$d.method.apply(k$d.caller,k$b):k$d.method.call(k$d.caller,k$b):k$d.method.apply(k$d.caller,k$d.args),k$d.once&&k$j.recoverHandler(k$d);k$c.lock=!1,!k$c.head&&this._events&&this._events[k$a]==k$c&&delete this._events[k$a],k$c.queue&&k$c.queue.length&&this.event(k$a,k$c.queue.shift())}return!0},k$a.on=function(k$a,k$b,k$c,k$d){return this._createListener(k$a,k$b,k$c,k$d,!1)},k$a.once=function(k$a,k$b,k$c,k$d){return this._createListener(k$a,k$b,k$c,k$d,!0)},k$a._createListener=function(k$a,k$b,k$c,k$d,k$e,k$f){void 0===k$f&&(k$f=!0),k$f&&this.off(k$a,k$b,k$c,k$e);var k$g=k$j.createHandler(k$b||this,k$c,k$d,k$e);this._events||(this._events={});var k$h=this._events,k$i=k$h[k$a];return k$i?k$i.tail?(k$g.prev=k$i.tail,k$i.tail.next=k$g,k$i.tail=k$g):k$i.head=k$i.tail=k$g:k$h[k$a]={head:k$g,tail:k$g,cursor:null,lock:!1},this},k$a.off=function(k$a,k$b,k$c,k$d){if(void 0===k$d&&(k$d=!1),!this._events||!this._events[k$a])return this;for(var k$e=this._events[k$a],k$f=k$e.head;k$f;){if((!k$b||k$f.caller===k$b)&&k$f.method===k$c&&(!k$d||k$f.once)){k$j.delNode(k$e,k$f),k$e.cursor==k$f&&(k$e.cursor=k$f.next),k$j.recoverHandler(k$f);break}k$f=k$f.next}return this},k$a.offAll=function(k$a){var k$b=this._events;if(!k$b)return this;if(k$a)this._recoverHandlers(k$b[k$a]),delete k$b[k$a];else{for(var k$c in k$b)this._recoverHandlers(k$b[k$c]);this._events=null}return this},k$a._recoverHandlers=function(k$a){if(k$a){for(var k$b=k$a.head;k$b;){k$j.delNode(k$a,k$b);var k$c=k$b.next;k$j.recoverHandler(k$b),k$b=k$c}k$a.cursor=null}},k$a.isMouseEvent=function(k$a){return k$j.MOUSE_EVENTS[k$a]},k$j.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},k$j.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},k$j.delNode=function(k$a,k$b){k$b.prev?k$b.prev.next=k$b.next:k$a.head=k$b.next,k$b.next?k$b.next.prev=k$b.prev:k$a.tail=k$b.prev},k$j.createHandler=function(k$a,k$b,k$c,k$d){var k$e=k$j._freeHandler;return k$e?(k$j._freeCount--,k$j._freeHandler=k$e.next,k$e.caller=k$a,k$e.method=k$b,k$e.args=k$c,k$e.once=k$d):k$e={caller:k$a,method:k$b,args:k$c,once:k$d},k$e.prev=k$e.next=null,k$e},k$j.recoverHandler=function(k$a){k$a.caller=k$a.method=k$a.args=k$a.prev=null,k$a.next=k$j._freeHandler,k$j._freeHandler=k$a,k$j._freeCount++},k$j._freeHandler=null,k$j._freeCount=0,k$j}(),k$s=function(){function k$e(k$a,k$b,k$c,k$d){this.once=!1,void(this._id=0)===k$d&&(k$d=!1),this.setTo(k$a,k$b,k$c,k$d)}k$k(k$e,"laya.utils.Handler");var k$a=k$e.prototype;return k$a.setTo=function(k$a,k$b,k$c,k$d){return this._id=k$e._gid++,this.caller=k$a,this.method=k$b,this.args=k$c,this.once=k$d,this},k$a.run=function(){if(null==this.method)return null;var k$a=this._id,k$b=this.method.apply(this.caller,this.args);return this._id===k$a&&this.once&&this.recover(),k$b},k$a.runWith=function(k$a){if(null==this.method)return null;var k$b=this._id;if(null==k$a)var k$c=this.method.apply(this.caller,this.args);else k$c=this.args||k$a.unshift?this.args?this.method.apply(this.caller,this.args.concat(k$a)):this.method.apply(this.caller,k$a):this.method.call(this.caller,k$a);return this._id===k$b&&this.once&&this.recover(),k$c},k$a.clear=function(){return this.caller=null,this.method=null,this.args=null,this},k$a.recover=function(){0<this._id&&(this._id=0,this.clear())},k$e.create=function(k$a,k$b,k$c,k$d){return void 0===k$d&&(k$d=!0),new k$e(k$a,k$b,k$c,k$d)},k$e._gid=1,k$e}(),k$D=function(){function k$a(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}k$k(k$a,"laya.display.BitmapFont");var k$b=k$a.prototype;return k$b.loadFont=function(k$a,k$b){this._path=k$a,this._complete=k$b,k$z.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],k$s.create(this,this.onLoaded))},k$b.onLoaded=function(){this.parseFont(k$ha.getRes(this._path),k$ha.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},k$b.parseFont=function(k$a,k$b){if(null!=k$a&&null!=k$b){this._texture=k$b;var k$c=k$a.getElementsByTagName("info");if(!k$c[0].getAttributeNode)return this.parseFont2(k$a,k$b);this.fontSize=parseInt(k$c[0].getAttributeNode("size").nodeValue);var k$d,k$e=k$c[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(k$e[0]),parseInt(k$e[1]),parseInt(k$e[2]),parseInt(k$e[3])],k$d=k$a.getElementsByTagName("char");var k$f=0;for(k$f=0;k$f<k$d.length;k$f++){var k$g=k$d[k$f],k$h=parseInt(k$g.getAttributeNode("id").nodeValue),k$i=parseInt(k$g.getAttributeNode("xoffset").nodeValue)/1,k$j=parseInt(k$g.getAttributeNode("yoffset").nodeValue)/1,k$k=parseInt(k$g.getAttributeNode("xadvance").nodeValue)/1,k$l=new k$B;k$l.x=parseInt(k$g.getAttributeNode("x").nodeValue),k$l.y=parseInt(k$g.getAttributeNode("y").nodeValue),k$l.width=parseInt(k$g.getAttributeNode("width").nodeValue),k$l.height=parseInt(k$g.getAttributeNode("height").nodeValue);var k$m=k$ka.create(k$b,k$l.x,k$l.y,k$l.width,k$l.height,k$i,k$j);this._maxWidth=Math.max(this._maxWidth,k$k+this.letterSpacing),this._fontCharDic[k$h]=k$m,this._fontWidthMap[k$h]=k$k}}},k$b.parseFont2=function(k$a,k$b){if(null!=k$a&&null!=k$b){this._texture=k$b;var k$c=k$a.getElementsByTagName("info");this.fontSize=parseInt(k$c[0].attributes.size.nodeValue);var k$d=k$c[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(k$d[0]),parseInt(k$d[1]),parseInt(k$d[2]),parseInt(k$d[3])];var k$e=k$a.getElementsByTagName("char"),k$f=0;for(k$f=0;k$f<k$e.length;k$f++){var k$g=k$e[k$f].attributes,k$h=parseInt(k$g.id.nodeValue),k$i=parseInt(k$g.xoffset.nodeValue)/1,k$j=parseInt(k$g.yoffset.nodeValue)/1,k$k=parseInt(k$g.xadvance.nodeValue)/1,k$l=new k$B;k$l.x=parseInt(k$g.x.nodeValue),k$l.y=parseInt(k$g.y.nodeValue),k$l.width=parseInt(k$g.width.nodeValue),k$l.height=parseInt(k$g.height.nodeValue);var k$m=k$ka.create(k$b,k$l.x,k$l.y,k$l.width,k$l.height,k$i,k$j);this._maxWidth=Math.max(this._maxWidth,k$k+this.letterSpacing),this._fontCharDic[k$h]=k$m,this._fontWidthMap[k$h]=k$k}}},k$b.getCharTexture=function(k$a){return this._fontCharDic[k$a.charCodeAt(0)]},k$b.destroy=function(){if(this._texture){for(var k$a in this._fontCharDic){var k$b=this._fontCharDic[k$a];k$b&&k$b.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},k$b.setSpaceWidth=function(k$a){this._spaceWidth=k$a},k$b.getCharWidth=function(k$a){var k$b=k$a.charCodeAt(0);return this._fontWidthMap[k$b]?this._fontWidthMap[k$b]+this.letterSpacing:" "==k$a?this._spaceWidth+this.letterSpacing:0},k$b.getTextWidth=function(k$a){for(var k$b=0,k$c=0,k$d=k$a.length;k$c<k$d;k$c++)k$b+=this.getCharWidth(k$a.charAt(k$c));return k$b},k$b.getMaxWidth=function(){return this._maxWidth},k$b.getMaxHeight=function(){return this.fontSize},k$b.drawText=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g,k$h=this.getTextWidth(k$a),k$i=0;"center"===k$e&&(k$i=(k$f-k$h)/2),"right"===k$e&&(k$i=k$f-k$h);for(var k$j=0,k$k=0,k$l=k$a.length;k$k<k$l;k$k++)(k$g=this.getCharTexture(k$a.charAt(k$k)))&&(k$b.graphics.drawTexture(k$g,k$c+k$j+k$i,k$d),k$j+=this.getCharWidth(k$a.charAt(k$k)))},k$a}(),k$h=function(){function k$c(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=k$c._TF_EMPTY}k$k(k$c,"laya.display.css.Style");var k$a=k$c.prototype;return k$a.getTransform=function(){return this._tf},k$a.setTransform=function(k$a){this._tf="none"!==k$a&&k$a?k$a:k$c._TF_EMPTY},k$a.setTranslateX=function(k$a){this._tf===k$c._TF_EMPTY&&(this._tf=new k$e),this._tf.translateX=k$a},k$a.setTranslateY=function(k$a){this._tf===k$c._TF_EMPTY&&(this._tf=new k$e),this._tf.translateY=k$a},k$a.setScaleX=function(k$a){this._tf===k$c._TF_EMPTY&&(this._tf=new k$e),this._tf.scaleX=k$a},k$a.setScale=function(k$a,k$b){this._tf===k$c._TF_EMPTY&&(this._tf=new k$e),this._tf.scaleX=k$a,this._tf.scaleY=k$b},k$a.setScaleY=function(k$a){this._tf===k$c._TF_EMPTY&&(this._tf=new k$e),this._tf.scaleY=k$a},k$a.setRotate=function(k$a){this._tf===k$c._TF_EMPTY&&(this._tf=new k$e),this._tf.rotate=k$a},k$a.setSkewX=function(k$a){this._tf===k$c._TF_EMPTY&&(this._tf=new k$e),this._tf.skewX=k$a},k$a.setSkewY=function(k$a){this._tf===k$c._TF_EMPTY&&(this._tf=new k$e),this._tf.skewY=k$a},k$a.destroy=function(){this.scrollRect=null},k$a.render=function(k$a,k$b,k$c,k$d){},k$a.getCSSStyle=function(){return k$ba.EMPTY},k$a._enableLayout=function(){return!1},k$o(0,k$a,"scaleX",function(){return this._tf.scaleX},function(k$a){this.setScaleX(k$a)}),k$o(0,k$a,"transform",function(){return this.getTransform()},function(k$a){this.setTransform(k$a)}),k$o(0,k$a,"translateX",function(){return this._tf.translateX},function(k$a){this.setTranslateX(k$a)}),k$o(0,k$a,"translateY",function(){return this._tf.translateY},function(k$a){this.setTranslateY(k$a)}),k$o(0,k$a,"scaleY",function(){return this._tf.scaleY},function(k$a){this.setScaleY(k$a)}),k$o(0,k$a,"block",function(){return 0!=(1&this._type)}),k$o(0,k$a,"skewY",function(){return this._tf.skewY},function(k$a){this.setSkewY(k$a)}),k$o(0,k$a,"rotate",function(){return this._tf.rotate},function(k$a){this.setRotate(k$a)}),k$o(0,k$a,"skewX",function(){return this._tf.skewX},function(k$a){this.setSkewX(k$a)}),k$o(0,k$a,"paddingLeft",function(){return 0}),k$o(0,k$a,"paddingTop",function(){return 0}),k$o(0,k$a,"absolute",function(){return!0}),k$c.__init__=function(){k$c._TF_EMPTY=new k$e,k$c.EMPTY=new k$c},k$c.EMPTY=null,k$c._TF_EMPTY=null,k$c}(),k$n=function(){function k$b(k$a){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=k$S.create(k$b.defaultColor),this.family=k$b.defaultFamily,this.stroke=k$b._STROKE,this.size=k$b.defaultSize,k$a&&k$a!==k$b.EMPTY&&k$a.copyTo(this)}k$k(k$b,"laya.display.css.Font");var k$a=k$b.prototype;return k$a.set=function(k$a){this._text=null;for(var k$b=k$a.split(" "),k$c=0,k$d=k$b.length;k$c<k$d;k$c++){var k$e=k$b[k$c];switch(k$e){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<k$e.indexOf("px")&&(this.size=parseInt(k$e),this.family=k$b[k$c+1],k$c++)}},k$a.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},k$a.copyTo=function(k$a){k$a._type=this._type,k$a._text=this._text,k$a._weight=this._weight,k$a._color=this._color,k$a.family=this.family,k$a.stroke=this.stroke!=k$b._STROKE?this.stroke.slice():k$b._STROKE,k$a.indent=this.indent,k$a.size=this.size},k$o(0,k$a,"password",function(){return 0!=(1024&this._type)},function(k$a){k$a?this._type|=1024:this._type&=-1025}),k$o(0,k$a,"color",function(){return this._color.strColor},function(k$a){this._color=k$S.create(k$a)}),k$o(0,k$a,"italic",function(){return 0!=(512&this._type)},function(k$a){k$a?this._type|=512:this._type&=-513}),k$o(0,k$a,"bold",function(){return 0!=(2048&this._type)},function(k$a){k$a?this._type|=2048:this._type&=-2049}),k$o(0,k$a,"weight",function(){return""+this._weight},function(k$a){var k$b=0;switch(k$a){case"normal":break;case"bold":this.bold=!0,k$b=700;break;case"bolder":k$b=800;break;case"lighter":k$b=100;break;default:k$b=parseInt(k$a)}this._weight=k$b,this._text=null}),k$o(0,k$a,"decoration",function(){return this._decoration?this._decoration.value:null},function(k$a){var k$b=k$a.split(" ");switch(this._decoration||(this._decoration={}),k$b[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=k$b[0]}k$b[1]&&(this._decoration.color=k$S.create(k$b)),this._decoration.value=k$a}),k$b.__init__=function(){k$b.EMPTY=new k$b(null)},k$b.EMPTY=null,k$b.defaultColor="#000000",k$b.defaultSize=12,k$b.defaultFamily="Arial",k$b.defaultFont="12px Arial",k$b._STROKE=[0,"#000000"],k$b._ITALIC=512,k$b._PASSWORD=1024,k$b._BOLD=2048,k$b}(),k$e=function(){function k$a(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return k$k(k$a,"laya.display.css.TransformInfo"),k$a}(),k$m=function(){function k$l(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,k$J.isConchNode){this._nativeObj=new k$g._conchGraphics,this.id=this._nativeObj.conchID}}k$k(k$l,"laya.display.Graphics");var k$a=k$l.prototype;return k$a.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},k$a.clear=function(k$a){void 0===k$a&&(k$a=!1);var k$b=0,k$c=0;if(k$a){var k$d=this._one;if(this._cmds){for(k$c=this._cmds.length,k$b=0;k$b<k$c;k$b++)!(k$d=this._cmds[k$b])||k$d.callee!==k$J._context._drawTexture&&k$d.callee!==k$J._context._drawTextureWithTransform||(k$d[0]=null,k$l._cache.push(k$d));this._cmds.length=0}else k$d&&(!k$d||k$d.callee!==k$J._context._drawTexture&&k$d.callee!==k$J._context._drawTextureWithTransform||(k$d[0]=null,k$l._cache.push(k$d)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(k$b=0,k$c=this._vectorgraphArray.length;k$b<k$c;k$b++)k$_.getInstance().deleteShape(this._vectorgraphArray[k$b]);this._vectorgraphArray.length=0}},k$a._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},k$a._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new k$c,this._graphicBounds._graphics=this)},k$a._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},k$a._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},k$a.getBounds=function(k$a){return void 0===k$a&&(k$a=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(k$a)},k$a.getBoundPoints=function(k$a){return void 0===k$a&&(k$a=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(k$a)},k$a._addCmd=function(k$a){this._cmds=this._cmds||[],k$a.callee=k$a.shift(),this._cmds.push(k$a)},k$a.setFilters=function(k$a){this._saveToCmd(k$J._context._setFilters,k$a)},k$a.drawTexture=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){if(void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=0),void 0===k$e&&(k$e=0),void 0===k$g&&(k$g=1),!k$a||k$g<.01)return null;k$d||(k$d=k$a.sourceWidth),k$e||(k$e=k$a.sourceHeight),k$g=k$g<0?0:1<k$g?1:k$g;var k$h,k$i=!k$J.isWebGL&&(k$O.onFirefox||k$O.onEdge||k$O.onIE||k$O.onSafari)?.5:0,k$j=k$d/k$a.sourceWidth,k$k=k$e/k$a.sourceHeight;return k$d=k$a.width*k$j,k$e=k$a.height*k$k,k$a.loaded&&(k$d<=0||k$e<=0)?null:(k$b+=k$a.offsetX*k$j,k$c+=k$a.offsetY*k$k,this._sp&&(this._sp._renderType|=512),k$b-=k$i,k$c-=k$i,k$d+=2*k$i,k$e+=2*k$i,k$l._cache.length?((k$h=k$l._cache.pop())[0]=k$a,k$h[1]=k$b,k$h[2]=k$c,k$h[3]=k$d,k$h[4]=k$e,k$h[5]=k$f,k$h[6]=k$g):k$h=[k$a,k$b,k$c,k$d,k$e,k$f,k$g],k$h.callee=k$f||1!=k$g?k$J._context._drawTextureWithTransform:k$J._context._drawTexture,null!=this._one||k$f||1!=k$g?this._saveToCmd(k$h.callee,k$h):(this._one=k$h,this._render=this._renderOneImg),k$a.loaded||k$a.once("loaded",this,this._textureLoaded,[k$a,k$h]),this._repaint(),k$h)},k$a.cleanByTexture=function(k$a,k$b,k$c,k$d,k$e){if(void 0===k$d&&(k$d=0),void 0===k$e&&(k$e=0),!k$a)return this.clear();if(this._one&&this._render===this._renderOneImg){k$d||(k$d=k$a.sourceWidth),k$e||(k$e=k$a.sourceHeight);var k$f=k$d/k$a.sourceWidth,k$g=k$e/k$a.sourceHeight;k$d=k$a.width*k$f,k$e=k$a.height*k$g,k$b+=k$a.offsetX*k$f,k$c+=k$a.offsetY*k$g,this._one[0]=k$a,this._one[1]=k$b,this._one[2]=k$c,this._one[3]=k$d,this._one[4]=k$e,this._repaint()}else this.clear(),k$a&&this.drawTexture(k$a,k$b,k$c,k$d,k$e)},k$a.drawTextures=function(k$a,k$b){k$a&&this._saveToCmd(k$J._context._drawTextures,[k$a,k$b])},k$a.fillTexture=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){if(void 0===k$d&&(k$d=0),void 0===k$e&&(k$e=0),void 0===k$f&&(k$f="repeat"),k$a){var k$h=[k$a,k$b,k$c,k$d,k$e,k$f,k$g||k$A.EMPTY,{}];k$a.loaded||k$a.once("loaded",this,this._textureLoaded,[k$a,k$h]),this._saveToCmd(k$J._context._fillTexture,k$h)}},k$a._textureLoaded=function(k$a,k$b){k$b[3]=k$b[3]||k$a.width,k$b[4]=k$b[4]||k$a.height,this._repaint()},k$a.fillCircle=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){k$c.bitmap.enableMerageInAtlas=!1;var k$h=new Float32Array(2*(k$g+1)),k$i=new Float32Array(2*(k$g+1)),k$j=new Uint16Array(3*k$g),k$k=2*Math.PI/k$g,k$l=0;k$h[0]=k$d,k$h[1]=k$e,k$i[0]=k$d/k$c.width,k$i[1]=k$e/k$c.height;for(var k$m=2,k$n=0;k$n<k$g;k$n++){var k$o=k$f*Math.cos(k$l)+k$d,k$p=k$f*Math.sin(k$l)+k$e;k$h[k$m]=k$o,k$h[k$m+1]=k$p,k$i[k$m]=k$o/k$c.width,k$i[k$m+1]=k$p/k$c.height,k$l+=k$k,k$m+=2}for(k$n=k$m=0;k$n<k$g;k$n++)k$j[k$m++]=0,k$j[k$m++]=k$n+1,k$j[k$m++]=k$g+1<=k$n+2?1:k$n+2;this.drawTriangles(k$c,k$a,k$b,k$h,k$i,k$j)},k$a.drawTriangles=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){void 0===k$h&&(k$h=1),this._saveToCmd(k$J._context.drawTriangles,[k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j])},k$a._saveToCmd=function(k$a,k$b){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=k$b,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(k$b)),k$b.callee=k$a,this._repaint(),k$b},k$a.clipRect=function(k$a,k$b,k$c,k$d){this._saveToCmd(k$J._context._clipRect,[k$a,k$b,k$c,k$d])},k$a.fillText=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){void 0===k$g&&(k$g=0),this._saveToCmd(k$J._context._fillText,[k$a,k$b,k$c,k$d||k$n.defaultFont,k$e,k$f])},k$a.fillBorderText=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){this._saveToCmd(k$J._context._fillBorderText,[k$a,k$b,k$c,k$d||k$n.defaultFont,k$e,k$f,k$g,k$h])},k$a.strokeText=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this._saveToCmd(k$J._context._strokeText,[k$a,k$b,k$c,k$d||k$n.defaultFont,k$e,k$f,k$g])},k$a.alpha=function(k$a){k$a=k$a<0?0:1<k$a?1:k$a,this._saveToCmd(k$J._context._alpha,[k$a])},k$a.setAlpha=function(k$a){k$a=k$a<0?0:1<k$a?1:k$a,this._saveToCmd(k$J._context._setAlpha,[k$a])},k$a.transform=function(k$a,k$b,k$c){void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),this._saveToCmd(k$J._context._transform,[k$a,k$b,k$c])},k$a.rotate=function(k$a,k$b,k$c){void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),this._saveToCmd(k$J._context._rotate,[k$a,k$b,k$c])},k$a.scale=function(k$a,k$b,k$c,k$d){void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=0),this._saveToCmd(k$J._context._scale,[k$a,k$b,k$c,k$d])},k$a.translate=function(k$a,k$b){this._saveToCmd(k$J._context._translate,[k$a,k$b])},k$a.save=function(){this._saveToCmd(k$J._context._save,[])},k$a.restore=function(){this._saveToCmd(k$J._context._restore,[])},k$a.replaceText=function(k$a){this._repaint();var k$b=this._cmds;if(k$b){for(var k$c=k$b.length-1;-1<k$c;k$c--)if(this._isTextCmd(k$b[k$c].callee))return k$b[k$c][0].toUpperCase?k$b[k$c][0]=k$a:k$b[k$c][0].setText(k$a),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=k$a:this._one[0].setText(k$a),!0;return!1},k$a._isTextCmd=function(k$a){return k$a===k$J._context._fillText||k$a===k$J._context._fillBorderText||k$a===k$J._context._strokeText},k$a.replaceTextColor=function(k$a){this._repaint();var k$b=this._cmds;if(k$b)for(var k$c=k$b.length-1;-1<k$c;k$c--)this._isTextCmd(k$b[k$c].callee)&&(k$b[k$c][4]=k$a,k$b[k$c][0].toUpperCase||(k$b[k$c][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=k$a,this._one[0].toUpperCase||(this._one[0].changed=!0))},k$a.loadImage=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=this;void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=0),void 0===k$e&&(k$e=0);var k$h=k$ha.getRes(k$a);function k$i(k$a){k$a&&(k$g.drawTexture(k$a,k$b,k$c,k$d,k$e),null!=k$f&&k$f.call(k$g._sp,k$a))}k$h?k$i(k$h):k$z.loader.load(k$a,k$s.create(null,k$i),null,"image")},k$a._renderEmpty=function(k$a,k$b,k$c,k$d){},k$a._renderAll=function(k$a,k$b,k$c,k$d){for(var k$e,k$f=this._cmds,k$g=0,k$h=k$f.length;k$g<k$h;k$g++)(k$e=k$f[k$g]).callee.call(k$b,k$c,k$d,k$e)},k$a._renderOne=function(k$a,k$b,k$c,k$d){this._one.callee.call(k$b,k$c,k$d,this._one)},k$a._renderOneImg=function(k$a,k$b,k$c,k$d){this._one.callee.call(k$b,k$c,k$d,this._one),2305!==k$a._renderType&&(k$a._renderType|=1)},k$a.drawLine=function(k$a,k$b,k$c,k$d,k$e,k$f){void 0===k$f&&(k$f=1);var k$g=0;k$J.isWebGL&&(k$g=k$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(k$g));var k$h=k$f%2==0?0:.5,k$i=[k$a+k$h,k$b+k$h,k$c+k$h,k$d+k$h,k$e,k$f,k$g];this._saveToCmd(k$J._context._drawLine,k$i)},k$a.drawLines=function(k$a,k$b,k$c,k$d,k$e){void 0===k$e&&(k$e=1);var k$f=0;if(k$c&&!(k$c.length<4)){k$J.isWebGL&&(k$f=k$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(k$f));var k$g=k$e%2==0?0:.5,k$h=[k$a+k$g,k$b+k$g,k$c,k$d,k$e,k$f];this._saveToCmd(k$J._context._drawLines,k$h)}},k$a.drawCurves=function(k$a,k$b,k$c,k$d,k$e){void 0===k$e&&(k$e=1);var k$f=[k$a,k$b,k$c,k$d,k$e];this._saveToCmd(k$J._context._drawCurves,k$f)},k$a.drawRect=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){void 0===k$g&&(k$g=1);var k$h=k$f?k$g/2:0,k$i=k$f?k$g:0,k$j=[k$a+k$h,k$b+k$h,k$c-k$i,k$d-k$i,k$e,k$f,k$g];this._saveToCmd(k$J._context._drawRect,k$j)},k$a.drawCircle=function(k$a,k$b,k$c,k$d,k$e,k$f){void 0===k$f&&(k$f=1);var k$g=k$e?k$f/2:0,k$h=0;k$J.isWebGL&&(k$h=k$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(k$h));var k$i=[k$a,k$b,k$c-k$g,k$d,k$e,k$f,k$h];this._saveToCmd(k$J._context._drawCircle,k$i)},k$a.drawPie=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){void 0===k$h&&(k$h=1);var k$i=k$g?k$h/2:0,k$j=k$g?k$h:0,k$k=0;k$J.isWebGL&&(k$k=k$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(k$k));var k$l=[k$a+k$i,k$b+k$i,k$c-k$j,k$d,k$e,k$f,k$g,k$h,k$k];k$l[3]=k$$.toRadian(k$d),k$l[4]=k$$.toRadian(k$e),this._saveToCmd(k$J._context._drawPie,k$l)},k$a.drawPoly=function(k$a,k$b,k$c,k$d,k$e,k$f){void 0===k$f&&(k$f=1);var k$g=0,k$h=!1;k$J.isWebGL&&(k$g=k$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(k$g),k$h=!(6<k$c.length));var k$i=k$e?k$f%2==0?0:.5:0,k$j=[k$a+k$i,k$b+k$i,k$c,k$d,k$e,k$f,k$g,k$h];this._saveToCmd(k$J._context._drawPoly,k$j)},k$a.drawPath=function(k$a,k$b,k$c,k$d,k$e){var k$f=[k$a,k$b,k$c,k$d,k$e];this._saveToCmd(k$J._context._drawPath,k$f)},k$o(0,k$a,"cmds",function(){return this._cmds},function(k$a){this._sp&&(this._sp._renderType|=512),this._cmds=k$a,this._render=this._renderAll,this._repaint()}),k$l.__init__=function(){if(k$J.isConchNode){for(var k$a=laya.display.Graphics.prototype,k$b=k$O.window.ConchGraphics.prototype,k$c=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],k$d=0,k$e=k$c.length;k$d<=k$e;k$d++){var k$f=k$c[k$d];k$a[k$f]=k$b[k$f]}k$a._saveToCmd=null,k$b.drawImageS&&(k$a.drawTextures=function(k$a,k$b){if(k$a&&k$a.loaded&&k$a.bitmap&&k$a.source){var k$c=k$a.uv,k$d=k$a.bitmap.width,k$e=k$a.bitmap.height;this.drawImageS(k$a.bitmap.source,k$c[0]*k$d,k$c[1]*k$e,(k$c[2]-k$c[0])*k$d,(k$c[5]-k$c[3])*k$e,k$a.offsetX,k$a.offsetY,k$a.width,k$a.height,k$b)}}),k$a.drawTexture=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){if(void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=0),void 0===k$e&&(k$e=0),void 0===k$g&&(k$g=1),k$a)if(k$a.loaded){if(k$a.loaded&&k$a.bitmap&&k$a.source&&(k$d||(k$d=k$a.sourceWidth),k$e||(k$e=k$a.sourceHeight),k$g=k$g<0?0:1<k$g?1:k$g,k$d=k$d-k$a.sourceWidth+k$a.width,k$e=k$e-k$a.sourceHeight+k$a.height,!(k$d<=0||k$e<=0))){k$b+=k$a.offsetX,k$c+=k$a.offsetY;var k$h=k$a.uv,k$i=k$a.bitmap.width,k$j=k$a.bitmap.height;k$h[4]<k$h[0]&&k$h[5]<k$h[1]?this.drawImageM(k$a.bitmap.source,k$h[4]*k$i,k$h[5]*k$j,(k$h[0]-k$h[4])*k$i,(k$h[1]-k$h[5])*k$j,k$b,k$c,k$d,k$e,k$f,k$g):this.drawImageM(k$a.bitmap.source,k$h[0]*k$i,k$h[1]*k$j,(k$h[2]-k$h[0])*k$i,(k$h[5]-k$h[3])*k$j,k$b,k$c,k$d,k$e,k$f,k$g),this._repaint()}}else k$a.once("loaded",this,function(){this.drawTexture(k$a,k$b,k$c,k$d,k$e,k$f)})},k$a.fillTexture=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){if(void 0===k$d&&(k$d=0),void 0===k$e&&(k$e=0),void 0===k$f&&(k$f="repeat"),k$a&&k$a.loaded){var k$h,k$i=k$J._context.ctx,k$j=k$a.bitmap.width,k$k=k$a.bitmap.height,k$l=k$a.uv;k$h=k$a.uv!=k$ka.DEF_UV?k$i.createPattern(k$a.bitmap.source,k$f,k$l[0]*k$j,k$l[1]*k$k,(k$l[2]-k$l[0])*k$j,(k$l[5]-k$l[3])*k$k):k$i.createPattern(k$a.bitmap.source,k$f);var k$m=0,k$n=0;k$g&&(k$b+=k$g.x%k$a.width,k$c+=k$g.y%k$a.height,k$m-=k$g.x%k$a.width,k$n-=k$g.y%k$a.height),this._fillImage(k$h,k$b,k$c,k$m,k$n,k$d,k$e)}}}},k$l._cache=[],k$l}(),k$c=function(){function k$t(){this._cacheBoundsType=!1}k$k(k$t,"laya.display.GraphicsBounds");var k$a=k$t.prototype;return k$a.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},k$a.reset=function(){this._temp&&(this._temp.length=0)},k$a.getBounds=function(k$a){return void 0===k$a&&(k$a=!1),(!this._bounds||!this._temp||this._temp.length<1||k$a!=this._cacheBoundsType)&&(this._bounds=k$B._getWrapRec(this.getBoundPoints(k$a),this._bounds)),this._cacheBoundsType=k$a,this._bounds},k$a.getBoundPoints=function(k$a){return void 0===k$a&&(k$a=!1),(!this._temp||this._temp.length<1||k$a!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(k$a)),this._cacheBoundsType=k$a,this._rstBoundPoints=k$$.copyArray(this._rstBoundPoints,this._temp)},k$a._getCmdPoints=function(k$a){void 0===k$a&&(k$a=!1);var k$b,k$c,k$d=k$J._context,k$e=this._graphics.cmds;if((k$b=this._temp||(this._temp=[])).length=0,k$e||null==this._graphics._one||(k$t._tempCmds.length=0,k$t._tempCmds.push(this._graphics._one),k$e=k$t._tempCmds),!k$e)return k$b;(k$c=k$t._tempMatrixArrays).length=0;var k$f=k$t._initMatrix;k$f.identity();for(var k$g,k$h,k$i=k$t._tempMatrix,k$j=NaN,k$k=NaN,k$l=NaN,k$m=NaN,k$n=NaN,k$o=NaN,k$p=0,k$q=k$e.length;k$p<k$q;k$p++)if((k$g=k$e[k$p]).callee)switch(k$g.callee){case k$d._save:case 7:k$c.push(k$f),k$f=k$f.clone();break;case k$d._restore:case 8:k$f=k$c.pop();break;case k$d._scale:case 5:k$i.identity(),k$i.translate(-k$g[2],-k$g[3]),k$i.scale(k$g[0],k$g[1]),k$i.translate(k$g[2],k$g[3]),this._switchMatrix(k$f,k$i);break;case k$d._rotate:case 3:k$i.identity(),k$i.translate(-k$g[1],-k$g[2]),k$i.rotate(k$g[0]),k$i.translate(k$g[1],k$g[2]),this._switchMatrix(k$f,k$i);break;case k$d._translate:case 6:k$i.identity(),k$i.translate(k$g[0],k$g[1]),this._switchMatrix(k$f,k$i);break;case k$d._transform:case 4:k$i.identity(),k$i.translate(-k$g[1],-k$g[2]),k$i.concat(k$g[0]),k$i.translate(k$g[1],k$g[2]),this._switchMatrix(k$f,k$i);break;case 16:case 24:k$t._addPointArrToRst(k$b,k$B._getBoundPointS(k$g[0],k$g[1],k$g[2],k$g[3]),k$f);break;case 17:k$f.copyTo(k$i),k$i.concat(k$g[4]),k$t._addPointArrToRst(k$b,k$B._getBoundPointS(k$g[0],k$g[1],k$g[2],k$g[3]),k$i);break;case k$d._drawTexture:k$h=k$g[0],k$a?k$g[3]&&k$g[4]?k$t._addPointArrToRst(k$b,k$B._getBoundPointS(k$g[1],k$g[2],k$g[3],k$g[4]),k$f):(k$h=k$g[0],k$t._addPointArrToRst(k$b,k$B._getBoundPointS(k$g[1],k$g[2],k$h.width,k$h.height),k$f)):(k$j=(k$g[3]||k$h.sourceWidth)/k$h.width,k$k=(k$g[4]||k$h.sourceHeight)/k$h.height,k$l=k$j*k$h.sourceWidth,k$m=k$k*k$h.sourceHeight,k$n=0<k$h.offsetX?k$h.offsetX:0,k$o=0<k$h.offsetY?k$h.offsetY:0,k$n*=k$j,k$o*=k$k,k$t._addPointArrToRst(k$b,k$B._getBoundPointS(k$g[1]-k$n,k$g[2]-k$o,k$l,k$m),k$f));break;case k$d._fillTexture:k$g[3]&&k$g[4]?k$t._addPointArrToRst(k$b,k$B._getBoundPointS(k$g[1],k$g[2],k$g[3],k$g[4]),k$f):(k$h=k$g[0],k$t._addPointArrToRst(k$b,k$B._getBoundPointS(k$g[1],k$g[2],k$h.width,k$h.height),k$f));break;case k$d._drawTextureWithTransform:var k$r;k$r=k$g[5]?(k$f.copyTo(k$i),k$i.concat(k$g[5]),k$i):k$f,k$a?k$g[3]&&k$g[4]?k$t._addPointArrToRst(k$b,k$B._getBoundPointS(k$g[1],k$g[2],k$g[3],k$g[4]),k$r):(k$h=k$g[0],k$t._addPointArrToRst(k$b,k$B._getBoundPointS(k$g[1],k$g[2],k$h.width,k$h.height),k$r)):(k$h=k$g[0],k$j=(k$g[3]||k$h.sourceWidth)/k$h.width,k$k=(k$g[4]||k$h.sourceHeight)/k$h.height,k$l=k$j*k$h.sourceWidth,k$m=k$k*k$h.sourceHeight,k$n=0<k$h.offsetX?k$h.offsetX:0,k$o=0<k$h.offsetY?k$h.offsetY:0,k$n*=k$j,k$o*=k$k,k$t._addPointArrToRst(k$b,k$B._getBoundPointS(k$g[1]-k$n,k$g[2]-k$o,k$l,k$m),k$r));break;case k$d._drawRect:case 13:k$t._addPointArrToRst(k$b,k$B._getBoundPointS(k$g[0],k$g[1],k$g[2],k$g[3]),k$f);break;case k$d._drawCircle:case k$d._fillCircle:case 14:k$t._addPointArrToRst(k$b,k$B._getBoundPointS(k$g[0]-k$g[2],k$g[1]-k$g[2],k$g[2]+k$g[2],k$g[2]+k$g[2]),k$f);break;case k$d._drawLine:case 20:k$t._tempPoints.length=0;var k$s;k$s=.5*k$g[5],k$g[0]==k$g[2]?k$t._tempPoints.push(k$g[0]+k$s,k$g[1],k$g[2]+k$s,k$g[3],k$g[0]-k$s,k$g[1],k$g[2]-k$s,k$g[3]):k$g[1]==k$g[3]?k$t._tempPoints.push(k$g[0],k$g[1]+k$s,k$g[2],k$g[3]+k$s,k$g[0],k$g[1]-k$s,k$g[2],k$g[3]-k$s):k$t._tempPoints.push(k$g[0],k$g[1],k$g[2],k$g[3]),k$t._addPointArrToRst(k$b,k$t._tempPoints,k$f);break;case k$d._drawCurves:case 22:k$t._addPointArrToRst(k$b,k$w.I.getBezierPoints(k$g[2]),k$f,k$g[0],k$g[1]);break;case k$d._drawPoly:case k$d._drawLines:case 18:k$t._addPointArrToRst(k$b,k$g[2],k$f,k$g[0],k$g[1]);break;case k$d._drawPath:case 19:k$t._addPointArrToRst(k$b,this._getPathPoints(k$g[2]),k$f,k$g[0],k$g[1]);break;case k$d._drawPie:case 15:k$t._addPointArrToRst(k$b,this._getPiePoints(k$g[0],k$g[1],k$g[2],k$g[3],k$g[4]),k$f)}return 200<k$b.length?k$b=k$$.copyArray(k$b,k$B._getWrapRec(k$b)._getBoundPoints()):8<k$b.length&&(k$b=k$x.scanPList(k$b)),k$b},k$a._switchMatrix=function(k$a,k$b){k$b.concat(k$a),k$b.copyTo(k$a)},k$a._getPiePoints=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$t._tempPoints;k$t._tempPoints.length=0,k$f.push(k$a,k$b);var k$g=(k$e-k$d)%(2*Math.PI)/10,k$h=NaN,k$i=k$d;for(k$h=0;k$h<=10;k$h++)k$f.push(k$a+k$c*Math.cos(k$i),k$b+k$c*Math.sin(k$i)),k$i+=k$g;return k$f},k$a._getPathPoints=function(k$a){var k$b,k$c,k$d=0,k$e=k$t._tempPoints;for(k$e.length=0,k$b=k$a.length,k$d=0;k$d<k$b;k$d++)1<(k$c=k$a[k$d]).length&&(k$e.push(k$c[1],k$c[2]),3<k$c.length&&k$e.push(k$c[3],k$c[4]));return k$e},k$t._addPointArrToRst=function(k$a,k$b,k$c,k$d,k$e){void 0===k$d&&(k$d=0),void 0===k$e&&(k$e=0);var k$f,k$g=0;for(k$f=k$b.length,k$g=0;k$g<k$f;k$g+=2)k$t._addPointToRst(k$a,k$b[k$g]+k$d,k$b[k$g+1]+k$e,k$c)},k$t._addPointToRst=function(k$a,k$b,k$c,k$d){var k$e=k$A.TEMP;k$e.setTo(k$b||0,k$c||0),k$d.transformPoint(k$e),k$a.push(k$e.x,k$e.y)},k$t._tempPoints=[],k$t._tempMatrixArrays=[],k$t._tempCmds=[],k$i(k$t,["_tempMatrix",function(){return this._tempMatrix=new k$G},"_initMatrix",function(){return this._initMatrix=new k$G}]),k$t}(),k$f=function(){function k$a(){}k$k(k$a,"laya.events.Event");var k$b=k$a.prototype;return k$b.setTo=function(k$a,k$b,k$c){return this.type=k$a,this.currentTarget=k$b,this.target=k$c,this},k$b.stopPropagation=function(){this._stoped=!0},k$o(0,k$b,"stageY",function(){return k$z.stage.mouseY}),k$o(0,k$b,"charCode",function(){return this.nativeEvent.charCode}),k$o(0,k$b,"touches",function(){var k$a=this.nativeEvent.touches;if(k$a)for(var k$b=k$z.stage,k$c=0,k$d=k$a.length;k$c<k$d;k$c++){var k$e=k$a[k$c],k$f=k$A.TEMP;k$f.setTo(k$e.clientX,k$e.clientY),k$b._canvasTransform.invertTransformPoint(k$f),k$b.transform.invertTransformPoint(k$f),k$e.stageX=k$f.x,k$e.stageY=k$f.y}return k$a}),k$o(0,k$b,"keyLocation",function(){return this.nativeEvent.keyLocation}),k$o(0,k$b,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),k$o(0,k$b,"altKey",function(){return this.nativeEvent.altKey}),k$o(0,k$b,"shiftKey",function(){return this.nativeEvent.shiftKey}),k$o(0,k$b,"stageX",function(){return k$z.stage.mouseX}),k$a.EMPTY=new k$a,k$a.MOUSE_DOWN="mousedown",k$a.MOUSE_UP="mouseup",k$a.CLICK="click",k$a.RIGHT_MOUSE_DOWN="rightmousedown",k$a.RIGHT_MOUSE_UP="rightmouseup",k$a.RIGHT_CLICK="rightclick",k$a.MOUSE_MOVE="mousemove",k$a.MOUSE_OVER="mouseover",k$a.MOUSE_OUT="mouseout",k$a.MOUSE_WHEEL="mousewheel",k$a.ROLL_OVER="mouseover",k$a.ROLL_OUT="mouseout",k$a.DOUBLE_CLICK="doubleclick",k$a.CHANGE="change",k$a.CHANGED="changed",k$a.RESIZE="resize",k$a.ADDED="added",k$a.REMOVED="removed",k$a.DISPLAY="display",k$a.UNDISPLAY="undisplay",k$a.ERROR="error",k$a.COMPLETE="complete",k$a.LOADED="loaded",k$a.INITED="inited",k$a.PROGRESS="progress",k$a.INPUT="input",k$a.RENDER="render",k$a.OPEN="open",k$a.MESSAGE="message",k$a.CLOSE="close",k$a.KEY_DOWN="keydown",k$a.KEY_PRESS="keypress",k$a.KEY_UP="keyup",k$a.FRAME="enterframe",k$a.DRAG_START="dragstart",k$a.DRAG_MOVE="dragmove",k$a.DRAG_END="dragend",k$a.ENTER="enter",k$a.SELECT="select",k$a.BLUR="blur",k$a.FOCUS="focus",k$a.VISIBILITY_CHANGE="visibilitychange",k$a.FOCUS_CHANGE="focuschange",k$a.PLAYED="played",k$a.PAUSED="paused",k$a.STOPPED="stopped",k$a.START="start",k$a.END="end",k$a.ENABLE_CHANGED="enablechanged",k$a.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",k$a.COMPONENT_ADDED="componentadded",k$a.COMPONENT_REMOVED="componentremoved",k$a.LAYER_CHANGED="layerchanged",k$a.HIERARCHY_LOADED="hierarchyloaded",k$a.RECOVERED="recovered",k$a.RELEASED="released",k$a.LINK="link",k$a.LABEL="label",k$a.FULL_SCREEN_CHANGE="fullscreenchange",k$a.DEVICE_LOST="devicelost",k$a.MESH_CHANGED="meshchanged",k$a.MATERIAL_CHANGED="materialchanged",k$a.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",k$a.ANIMATION_CHANGED="animationchanged",k$a.TRIGGER_ENTER="triggerenter",k$a.TRIGGER_STAY="triggerstay",k$a.TRIGGER_EXIT="triggerexit",k$a.TRAIL_FILTER_CHANGE="trailfilterchange",k$a.DOMINO_FILTER_CHANGE="dominofilterchange",k$a}(),k$l=(function(){function k$a(){}k$k(k$a,"laya.events.Keyboard"),k$a.NUMBER_0=48,k$a.NUMBER_1=49,k$a.NUMBER_2=50,k$a.NUMBER_3=51,k$a.NUMBER_4=52,k$a.NUMBER_5=53,k$a.NUMBER_6=54,k$a.NUMBER_7=55,k$a.NUMBER_8=56,k$a.NUMBER_9=57,k$a.A=65,k$a.B=66,k$a.C=67,k$a.D=68,k$a.E=69,k$a.F=70,k$a.G=71,k$a.H=72,k$a.I=73,k$a.J=74,k$a.K=75,k$a.L=76,k$a.M=77,k$a.N=78,k$a.O=79,k$a.P=80,k$a.Q=81,k$a.R=82,k$a.S=83,k$a.T=84,k$a.U=85,k$a.V=86,k$a.W=87,k$a.X=88,k$a.Y=89,k$a.Z=90,k$a.F1=112,k$a.F2=113,k$a.F3=114,k$a.F4=115,k$a.F5=116,k$a.F6=117,k$a.F7=118,k$a.F8=119,k$a.F9=120,k$a.F10=121,k$a.F11=122,k$a.F12=123,k$a.F13=124,k$a.F14=125,k$a.F15=126,k$a.NUMPAD=21,k$a.NUMPAD_0=96,k$a.NUMPAD_1=97,k$a.NUMPAD_2=98,k$a.NUMPAD_3=99,k$a.NUMPAD_4=100,k$a.NUMPAD_5=101,k$a.NUMPAD_6=102,k$a.NUMPAD_7=103,k$a.NUMPAD_8=104,k$a.NUMPAD_9=105,k$a.NUMPAD_ADD=107,k$a.NUMPAD_DECIMAL=110,k$a.NUMPAD_DIVIDE=111,k$a.NUMPAD_ENTER=108,k$a.NUMPAD_MULTIPLY=106,k$a.NUMPAD_SUBTRACT=109,k$a.SEMICOLON=186,k$a.EQUAL=187,k$a.COMMA=188,k$a.MINUS=189,k$a.PERIOD=190,k$a.SLASH=191,k$a.BACKQUOTE=192,k$a.LEFTBRACKET=219,k$a.BACKSLASH=220,k$a.RIGHTBRACKET=221,k$a.QUOTE=222,k$a.ALTERNATE=18,k$a.BACKSPACE=8,k$a.CAPS_LOCK=20,k$a.COMMAND=15,k$a.CONTROL=17,k$a.DELETE=46,k$a.ENTER=13,k$a.ESCAPE=27,k$a.PAGE_UP=33,k$a.PAGE_DOWN=34,k$a.END=35,k$a.HOME=36,k$a.LEFT=37,k$a.UP=38,k$a.RIGHT=39,k$a.DOWN=40,k$a.SHIFT=16,k$a.SPACE=32,k$a.TAB=9,k$a.INSERT=45}(),function(){function k$e(){}return k$k(k$e,"laya.events.KeyBoardManager"),k$e.__init__=function(){k$e._addEvent("keydown"),k$e._addEvent("keypress"),k$e._addEvent("keyup")},k$e._addEvent=function(k$b){k$O.document.addEventListener(k$b,function(k$a){laya.events.KeyBoardManager._dispatch(k$a,k$b)},!0)},k$e._dispatch=function(k$a,k$b){if(k$e.enabled){k$e._event._stoped=!1,k$e._event.nativeEvent=k$a,k$e._event.keyCode=k$a.keyCode||k$a.which||k$a.charCode,"keydown"===k$b?k$e._pressKeys[k$e._event.keyCode]=!0:"keyup"===k$b&&(k$e._pressKeys[k$e._event.keyCode]=null);for(var k$c=k$z.stage.focus&&null!=k$z.stage.focus.event&&k$z.stage.focus.displayedInStage?k$z.stage.focus:k$z.stage,k$d=k$c;k$d;)k$d.event(k$b,k$e._event.setTo(k$b,k$d,k$c)),k$d=k$d.parent}},k$e.hasKeyDown=function(k$a){return k$e._pressKeys[k$a]},k$e._pressKeys={},k$e.enabled=!0,k$i(k$e,["_event",function(){return this._event=new k$f}]),k$e}()),k$p=(function(){function k$a(){}k$k(k$a,"laya.events.KeyLocation"),k$a.STANDARD=0,k$a.LEFT=1,k$a.RIGHT=2,k$a.NUM_PAD=3}(),function(){function k$j(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=k$O.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new k$f,this._matrix=new k$G,this._point=new k$A,this._rect=new k$B,this._prePoint=new k$A,this._curTouchID=NaN}k$k(k$j,"laya.events.MouseManager");var k$a=k$j.prototype;return k$a.__init__=function(k$a,k$b){var k$c=this;this._stage=k$a;var k$d=this,k$e=this._eventList;k$b.oncontextmenu=function(k$a){if(k$j.enabled)return!1},k$b.addEventListener("mousedown",function(k$a){k$j.enabled&&(k$O.onIE||k$a.preventDefault(),k$e.push(k$a),k$d.mouseDownTime=k$O.now())}),k$b.addEventListener("mouseup",function(k$a){k$j.enabled&&(k$a.preventDefault(),k$e.push(k$a),k$d.mouseDownTime=-k$O.now())},!0),k$b.addEventListener("mousemove",function(k$a){if(k$j.enabled){k$a.preventDefault();var k$b=k$O.now();if(k$b-k$d._lastMoveTimer<10)return;k$d._lastMoveTimer=k$b,k$e.push(k$a)}},!0),k$b.addEventListener("mouseout",function(k$a){k$j.enabled&&k$e.push(k$a)}),k$b.addEventListener("mouseover",function(k$a){k$j.enabled&&k$e.push(k$a)}),k$b.addEventListener("touchstart",function(k$a){k$j.enabled&&(k$e.push(k$a),k$j._isFirstTouch||k$xa.isInputting||k$a.preventDefault(),k$d.mouseDownTime=k$O.now())}),k$b.addEventListener("touchend",function(k$a){k$j.enabled?(k$j._isFirstTouch||k$xa.isInputting||k$a.preventDefault(),k$j._isFirstTouch=!1,k$e.push(k$a),k$d.mouseDownTime=-k$O.now()):k$c._curTouchID=NaN},!0),k$b.addEventListener("touchmove",function(k$a){k$j.enabled&&(k$a.preventDefault(),k$e.push(k$a))},!0),k$b.addEventListener("touchcancel",function(k$a){k$j.enabled?(k$a.preventDefault(),k$e.push(k$a)):k$c._curTouchID=NaN},!0),k$b.addEventListener("mousewheel",function(k$a){k$j.enabled&&k$e.push(k$a)}),k$b.addEventListener("DOMMouseScroll",function(k$a){k$j.enabled&&k$e.push(k$a)})},k$a.initEvent=function(k$a,k$b){var k$c;this._event._stoped=!1,this._event.nativeEvent=k$b||k$a,this._target=null,this._point.setTo(k$a.pageX||k$a.clientX,k$a.pageY||k$a.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=k$a.identifier||0,this._tTouchID=this._event.touchId,(k$c=k$q.I._event)._stoped=!1,k$c.nativeEvent=this._event.nativeEvent,k$c.touchId=this._event.touchId},k$a.checkMouseWheel=function(k$a){this._event.delta=k$a.wheelDelta?.025*k$a.wheelDelta:-k$a.detail;for(var k$b=k$q.I.getLastOvers(),k$c=0,k$d=k$b.length;k$c<k$d;k$c++){var k$e=k$b[k$c];k$e.event("mousewheel",this._event.setTo("mousewheel",k$e,this._target))}},k$a.onMouseMove=function(k$a){k$q.I.onMouseMove(k$a,this._tTouchID)},k$a.onMouseDown=function(k$a){if(k$xa.isInputting&&k$z.stage.focus&&k$z.stage.focus.focus&&!k$z.stage.focus.contains(this._target)){var k$b=k$z.stage.focus._tf||k$z.stage.focus,k$c=k$a._tf||k$a;k$c instanceof laya.display.Input&&k$c.multiline==k$b.multiline?k$b._focusOut():k$b.focus=!1}k$q.I.onMouseDown(k$a,this._tTouchID,this._isLeftMouse)},k$a.onMouseUp=function(k$a){k$q.I.onMouseUp(k$a,this._tTouchID,this._isLeftMouse)},k$a.check=function(k$a,k$b,k$c,k$d){this._point.setTo(k$b,k$c),k$a.fromParentPoint(this._point),k$b=this._point.x,k$c=this._point.y;var k$e=k$a.scrollRect;if(k$e&&(this._rect.setTo(k$e.x,k$e.y,k$e.width,k$e.height),!this._rect.contains(k$b,k$c)))return!1;if(!this.disableMouseEvent){if(k$a.hitTestPrior&&!k$a.mouseThrough&&!this.hitTest(k$a,k$b,k$c))return!1;for(var k$f=k$a._childs.length-1;-1<k$f;k$f--){var k$g=k$a._childs[k$f];if(!k$g.destroyed&&k$g.mouseEnabled&&k$g.visible&&this.check(k$g,k$b,k$c,k$d))return!0}}var k$h=!(!k$a.hitTestPrior||k$a.mouseThrough||this.disableMouseEvent)||this.hitTest(k$a,k$b,k$c);return k$h?(this._target=k$a,k$d.call(this,k$a)):k$d===this.onMouseUp&&k$a===this._stage&&(this._target=this._stage,k$d.call(this,this._target)),k$h},k$a.hitTest=function(k$a,k$b,k$c){var k$d=!1;if(k$a.scrollRect&&(k$b-=k$a.scrollRect.x,k$c-=k$a.scrollRect.y),k$a.hitArea instanceof laya.utils.HitArea)return k$a.hitArea.isHit(k$b,k$c);if(0<k$a.width&&0<k$a.height||k$a.mouseThrough||k$a.hitArea)if(k$a.mouseThrough)k$d=k$a.getGraphicBounds().contains(k$b,k$c);else{var k$e=this._rect;k$a.hitArea?k$e=k$a.hitArea:k$e.setTo(0,0,k$a.width,k$a.height),k$d=k$e.contains(k$b,k$c)}return k$d},k$a.runEvent=function(){var k$a=this._eventList.length;if(k$a){this.mouseEventTime=k$O.now();var k$b,k$c=0,k$d=0,k$e=0;try{for(;k$c<k$a;){var k$f=this._eventList[k$c];switch("mousemove"!==k$f.type&&(this._prePoint.x=this._prePoint.y=-1e6),k$f.type){case"mousedown":this._touchIDs[0]=this._id++,k$j._isTouchRespond?k$j._isTouchRespond=!1:(this._isLeftMouse=0===k$f.button,this.initEvent(k$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===k$f.button,this.initEvent(k$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-k$f.clientX)+Math.abs(this._prePoint.y-k$f.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=k$f.clientX,this._prePoint.y=k$f.clientY,this.initEvent(k$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":k$j._isTouchRespond=!0,this._isLeftMouse=!0;var k$g=k$f.changedTouches;for(k$d=0,k$e=k$g.length;k$d<k$e;k$d++)k$b=k$g[k$d],(k$j.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=k$b.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[k$b.identifier]=this._id++,this.initEvent(k$b,k$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":k$j._isTouchRespond=!0,this._isLeftMouse=!0;var k$h=k$f.changedTouches;for(k$d=0,k$e=k$h.length;k$d<k$e;k$d++)if(k$b=k$h[k$d],k$j.multiTouchEnabled||k$b.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(k$b,k$f);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var k$i=k$f.changedTouches;for(k$d=0,k$e=k$i.length;k$d<k$e;k$d++)k$b=k$i[k$d],(k$j.multiTouchEnabled||k$b.identifier==this._curTouchID)&&(this.initEvent(k$b,k$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(k$f);break;case"mouseout":k$q.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}k$c++}}catch(k$a){throw this._eventList.length=0,k$a}this._eventList.length=0}},k$j.enabled=!0,k$j.multiTouchEnabled=!0,k$j._isTouchRespond=!1,k$j._isFirstTouch=!0,k$i(k$j,["instance",function(){return this.instance=new k$j}]),k$j}()),k$q=function(){function k$o(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new k$f}k$k(k$o,"laya.events.TouchManager");var k$a=k$o.prototype;return k$a._clearTempArrs=function(){k$o._oldArr.length=0,k$o._newArr.length=0,k$o._tEleArr.length=0},k$a.getTouchFromArr=function(k$a,k$b){var k$c,k$d,k$e=0;for(k$c=k$b.length,k$e=0;k$e<k$c;k$e++)if((k$d=k$b[k$e]).id==k$a)return k$d;return null},k$a.removeTouchFromArr=function(k$a,k$b){var k$c=0;for(k$c=k$b.length-1;0<=k$c;k$c--)k$b[k$c].id==k$a&&k$b.splice(k$c,1)},k$a.createTouchO=function(k$a,k$b){var k$c;return(k$c=k$W.getItem("TouchData")||{}).id=k$b,k$c.tar=k$a,k$c},k$a.onMouseDown=function(k$a,k$b,k$c){var k$d,k$e,k$f,k$g;(void 0===k$c&&(k$c=!1),this.enable)&&(k$d=this.getTouchFromArr(k$b,this.preOvers),k$f=this.getEles(k$a,null,k$o._tEleArr),k$d?k$d.tar=k$a:(k$e=this.createTouchO(k$a,k$b),this.preOvers.push(k$e)),k$O.onMobile&&this.sendEvents(k$f,"mouseover",k$b),k$g=k$c?this.preDowns:this.preRightDowns,(k$d=this.getTouchFromArr(k$b,k$g))?k$d.tar=k$a:(k$e=this.createTouchO(k$a,k$b),k$g.push(k$e)),this.sendEvents(k$f,k$c?"mousedown":"rightmousedown",k$b),this._clearTempArrs())},k$a.sendEvents=function(k$a,k$b,k$c){void 0===k$c&&(k$c=0);var k$d,k$e,k$f,k$g=0;for(k$d=k$a.length,this._event._stoped=!1,k$e=k$a[0],k$g=0;k$g<k$d;k$g++){if((k$f=k$a[k$g]).destroyed)return;if(k$f.event(k$b,this._event.setTo(k$b,k$f,k$e)),this._event._stoped)break}},k$a.getEles=function(k$a,k$b,k$c){for(k$c?k$c.length=0:k$c=[];k$a&&k$a!=k$b;)k$c.push(k$a),k$a=k$a.parent;return k$c},k$a.checkMouseOutAndOverOfMove=function(k$a,k$b,k$c){if(void 0===k$c&&(k$c=0),k$b!=k$a){var k$d,k$e,k$f=0,k$g=0;if(k$b.contains(k$a))k$e=this.getEles(k$a,k$b,k$o._tEleArr),this.sendEvents(k$e,"mouseover",k$c);else if(k$a.contains(k$b))k$e=this.getEles(k$b,k$a,k$o._tEleArr),this.sendEvents(k$e,"mouseout",k$c);else{var k$h,k$i;(k$e=k$o._tEleArr).length=0,k$h=this.getEles(k$b,null,k$o._oldArr),k$i=this.getEles(k$a,null,k$o._newArr),k$g=k$h.length;var k$j=0;for(k$f=0;k$f<k$g;k$f++){if(k$d=k$h[k$f],0<=(k$j=k$i.indexOf(k$d))){k$i.splice(k$j,k$i.length-k$j);break}k$e.push(k$d)}0<k$e.length&&this.sendEvents(k$e,"mouseout",k$c),0<k$i.length&&this.sendEvents(k$i,"mouseover",k$c)}}},k$a.onMouseMove=function(k$a,k$b){var k$c,k$d;this.enable&&((k$c=this.getTouchFromArr(k$b,this.preOvers))?(this.checkMouseOutAndOverOfMove(k$a,k$c.tar),k$c.tar=k$a,k$d=this.getEles(k$a,null,k$o._tEleArr)):(k$d=this.getEles(k$a,null,k$o._tEleArr),this.sendEvents(k$d,"mouseover",k$b),this.preOvers.push(this.createTouchO(k$a,k$b))),this.sendEvents(k$d,"mousemove",k$b),this._clearTempArrs())},k$a.getLastOvers=function(){return(k$o._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,k$o._tEleArr):(k$o._tEleArr.push(k$z.stage),k$o._tEleArr)},k$a.stageMouseOut=function(){var k$a;k$a=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(k$a,"mouseout",0)},k$a.onMouseUp=function(k$a,k$b,k$c){if(void 0===k$c&&(k$c=!1),this.enable){var k$d,k$e,k$f,k$g,k$h,k$i,k$j=0,k$k=0,k$l=k$O.onMobile;if(k$e=this.getEles(k$a,null,k$o._tEleArr),this.sendEvents(k$e,k$c?"mouseup":"rightmouseup",k$b),k$i=k$c?this.preDowns:this.preRightDowns,k$d=this.getTouchFromArr(k$b,k$i)){var k$m,k$n=k$O.now();if(k$m=k$n-this._lastClickTime<300,this._lastClickTime=k$n,k$a==k$d.tar)k$h=k$e;else for(k$f=this.getEles(k$d.tar,null,k$o._oldArr),(k$h=k$o._newArr).length=0,k$k=k$f.length,k$j=0;k$j<k$k;k$j++)k$g=k$f[k$j],0<=k$e.indexOf(k$g)&&k$h.push(k$g);0<k$h.length&&this.sendEvents(k$h,k$c?"click":"rightclick",k$b),k$c&&k$m&&this.sendEvents(k$h,"doubleclick",k$b),this.removeTouchFromArr(k$b,k$i),k$d.tar=null,k$W.recover("TouchData",k$d)}else;(k$d=this.getTouchFromArr(k$b,this.preOvers))&&k$l&&((k$h=this.getEles(k$d.tar,null,k$h))&&0<k$h.length&&this.sendEvents(k$h,"mouseout",k$b),this.removeTouchFromArr(k$b,this.preOvers),k$d.tar=null,k$W.recover("TouchData",k$d)),this._clearTempArrs()}},k$o._oldArr=[],k$o._newArr=[],k$o._tEleArr=[],k$i(k$o,["I",function(){return this.I=new k$o}]),k$o}(),k$r=function(){function k$a(){this._action=null}k$k(k$a,"laya.filters.Filter");var k$b=k$a.prototype;return k$z.imps(k$b,{"laya.filters.IFilter":!0}),k$b.callNative=function(k$a){},k$o(0,k$b,"type",function(){return-1}),k$o(0,k$b,"action",function(){return this._action}),k$a.BLUR=16,k$a.COLOR=32,k$a.GLOW=8,k$a._filterStart=null,k$a._filterEnd=null,k$a._EndTarget=null,k$a._recycleScope=null,k$a._filter=null,k$a._useSrc=null,k$a._endSrc=null,k$a._useOut=null,k$a._endOut=null,k$a}(),k$t=function(){function k$a(){this.data=null}k$k(k$a,"laya.filters.ColorFilterAction");var k$b=k$a.prototype;return k$z.imps(k$b,{"laya.filters.IFilterAction":!0}),k$b.apply=function(k$a){var k$b=k$a.ctx.ctx,k$c=k$a.ctx.ctx.canvas;if(0==k$c.width||0==k$c.height)return k$c;for(var k$d,k$e=k$b.getImageData(0,0,k$c.width,k$c.height),k$f=k$e.data,k$g=0,k$h=k$f.length;k$g<k$h;k$g+=4)k$d=this.getColor(k$f[k$g],k$f[k$g+1],k$f[k$g+2],k$f[k$g+3]),0!=k$f[k$g+3]&&(k$f[k$g]=k$d[0],k$f[k$g+1]=k$d[1],k$f[k$g+2]=k$d[2],k$f[k$g+3]=k$d[3]);return k$b.putImageData(k$e,0,0),k$a},k$b.getColor=function(k$a,k$b,k$c,k$d){var k$e=[];if(this.data._mat&&this.data._alpha){var k$f=this.data._mat,k$g=this.data._alpha;k$e[0]=k$f[0]*k$a+k$f[1]*k$b+k$f[2]*k$c+k$f[3]*k$d+k$g[0],k$e[1]=k$f[4]*k$a+k$f[5]*k$b+k$f[6]*k$c+k$f[7]*k$d+k$g[1],k$e[2]=k$f[8]*k$a+k$f[9]*k$b+k$f[10]*k$c+k$f[11]*k$d+k$g[2],k$e[3]=k$f[12]*k$a+k$f[13]*k$b+k$f[14]*k$c+k$f[15]*k$d+k$g[3]}return k$e},k$a}(),k$w=(function(){function k$a(){}k$k(k$a,"laya.maths.Arith"),k$a.formatR=function(k$a){return k$a>Math.PI&&(k$a-=2*Math.PI),k$a<-Math.PI&&(k$a+=2*Math.PI),k$a},k$a.isPOT=function(k$a,k$b){return 0<k$a&&0==(k$a&k$a-1)&&0<k$b&&0==(k$b&k$b-1)},k$a.setMatToArray=function(k$a,k$b){k$a.a,k$a.b,k$a.c,k$a.d,k$a.tx,k$a.ty,k$b[0]=k$a.a,k$b[1]=k$a.b,k$b[4]=k$a.c,k$b[5]=k$a.d,k$b[12]=k$a.tx,k$b[13]=k$a.ty}}(),function(){function k$a(){this._controlPoints=[new k$A,new k$A,new k$A],this._calFun=this.getPoint2}k$k(k$a,"laya.maths.Bezier");var k$b=k$a.prototype;return k$b._switchPoint=function(k$a,k$b){var k$c=this._controlPoints.shift();k$c.setTo(k$a,k$b),this._controlPoints.push(k$c)},k$b.getPoint2=function(k$a,k$b){var k$c=this._controlPoints[0],k$d=this._controlPoints[1],k$e=this._controlPoints[2],k$f=Math.pow(1-k$a,2)*k$c.x+2*k$a*(1-k$a)*k$d.x+Math.pow(k$a,2)*k$e.x,k$g=Math.pow(1-k$a,2)*k$c.y+2*k$a*(1-k$a)*k$d.y+Math.pow(k$a,2)*k$e.y;k$b.push(k$f,k$g)},k$b.getPoint3=function(k$a,k$b){var k$c=this._controlPoints[0],k$d=this._controlPoints[1],k$e=this._controlPoints[2],k$f=this._controlPoints[3],k$g=Math.pow(1-k$a,3)*k$c.x+3*k$d.x*k$a*(1-k$a)*(1-k$a)+3*k$e.x*k$a*k$a*(1-k$a)+k$f.x*Math.pow(k$a,3),k$h=Math.pow(1-k$a,3)*k$c.y+3*k$d.y*k$a*(1-k$a)*(1-k$a)+3*k$e.y*k$a*k$a*(1-k$a)+k$f.y*Math.pow(k$a,3);k$b.push(k$g,k$h)},k$b.insertPoints=function(k$a,k$b){var k$c,k$d=NaN;for(k$c=1/(k$a=0<k$a?k$a:5),k$d=0;k$d<=1;k$d+=k$c)this._calFun(k$d,k$b)},k$b.getBezierPoints=function(k$a,k$b,k$c){void 0===k$b&&(k$b=5),void 0===k$c&&(k$c=2);var k$d,k$e,k$f=0;if((k$d=k$a.length)<2*(k$c+1))return[];switch(k$e=[],k$c){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=k$c;)this._controlPoints.push(new k$A);for(k$f=0;k$f<2*k$c;k$f+=2)this._switchPoint(k$a[k$f],k$a[k$f+1]);for(k$f=2*k$c;k$f<k$d;k$f+=2)this._switchPoint(k$a[k$f],k$a[k$f+1]),k$f/2%k$c==0&&this.insertPoints(k$b,k$e);return k$e},k$i(k$a,["I",function(){return this.I=new k$a}]),k$a}()),k$x=function(){function k$j(){}return k$k(k$j,"laya.maths.GrahamScan"),k$j.multiply=function(k$a,k$b,k$c){return(k$a.x-k$c.x)*(k$b.y-k$c.y)-(k$b.x-k$c.x)*(k$a.y-k$c.y)},k$j.dis=function(k$a,k$b){return(k$a.x-k$b.x)*(k$a.x-k$b.x)+(k$a.y-k$b.y)*(k$a.y-k$b.y)},k$j._getPoints=function(k$a,k$b,k$c){for(void 0===k$b&&(k$b=!1),k$j._mPointList||(k$j._mPointList=[]);k$j._mPointList.length<k$a;)k$j._mPointList.push(new k$A);return k$c||(k$c=[]),k$c.length=0,k$b?k$j.getFrom(k$c,k$j._mPointList,k$a):k$j.getFromR(k$c,k$j._mPointList,k$a),k$c},k$j.getFrom=function(k$a,k$b,k$c){var k$d=0;for(k$d=0;k$d<k$c;k$d++)k$a.push(k$b[k$d]);return k$a},k$j.getFromR=function(k$a,k$b,k$c){var k$d=0;for(k$d=0;k$d<k$c;k$d++)k$a.push(k$b.pop());return k$a},k$j.pListToPointList=function(k$a,k$b){void 0===k$b&&(k$b=!1);var k$c=0,k$d=k$a.length/2,k$e=k$j._getPoints(k$d,k$b,k$j._tempPointList);for(k$c=0;k$c<k$d;k$c++)k$e[k$c].setTo(k$a[k$c+k$c],k$a[k$c+k$c+1]);return k$e},k$j.pointListToPlist=function(k$a){var k$b,k$c=0,k$d=k$a.length,k$e=k$j._temPList;for(k$c=k$e.length=0;k$c<k$d;k$c++)k$b=k$a[k$c],k$e.push(k$b.x,k$b.y);return k$e},k$j.scanPList=function(k$a){return k$$.copyArray(k$a,k$j.pointListToPlist(k$j.scan(k$j.pListToPointList(k$a,!0))))},k$j.scan=function(k$a){var k$b,k$c,k$d,k$e=0,k$f=0,k$g=0,k$h=k$a.length,k$i={};for((k$c=k$j._temArr).length=0,k$e=(k$h=k$a.length)-1;0<=k$e;k$e--)k$d=(k$b=k$a[k$e]).x+"_"+k$b.y,k$i.hasOwnProperty(k$d)||(k$i[k$d]=!0,k$c.push(k$b));for(k$h=k$c.length,k$$.copyArray(k$a,k$c),k$e=1;k$e<k$h;k$e++)(k$a[k$e].y<k$a[k$g].y||k$a[k$e].y==k$a[k$g].y&&k$a[k$e].x<k$a[k$g].x)&&(k$g=k$e);for(k$b=k$a[0],k$a[0]=k$a[k$g],k$a[k$g]=k$b,k$e=1;k$e<k$h-1;k$e++){for(k$f=(k$g=k$e)+1;k$f<k$h;k$f++)(0<k$j.multiply(k$a[k$f],k$a[k$g],k$a[0])||0==k$j.multiply(k$a[k$f],k$a[k$g],k$a[0])&&k$j.dis(k$a[0],k$a[k$f])<k$j.dis(k$a[0],k$a[k$g]))&&(k$g=k$f);k$b=k$a[k$e],k$a[k$e]=k$a[k$g],k$a[k$g]=k$b}if((k$c=k$j._temArr).length=0,k$a.length<3)return k$$.copyArray(k$c,k$a);for(k$c.push(k$a[0],k$a[1],k$a[2]),k$e=3;k$e<k$h;k$e++){for(;2<=k$c.length&&0<=k$j.multiply(k$a[k$e],k$c[k$c.length-1],k$c[k$c.length-2]);)k$c.pop();k$a[k$e]&&k$c.push(k$a[k$e])}return k$c},k$j._mPointList=null,k$j._tempPointList=[],k$j._temPList=[],k$j._temArr=[],k$j}(),k$y=function(){function k$e(){}return k$k(k$e,"laya.maths.MathUtil"),k$e.subtractVector3=function(k$a,k$b,k$c){k$c[0]=k$a[0]-k$b[0],k$c[1]=k$a[1]-k$b[1],k$c[2]=k$a[2]-k$b[2]},k$e.lerp=function(k$a,k$b,k$c){return k$a*(1-k$c)+k$b*k$c},k$e.scaleVector3=function(k$a,k$b,k$c){k$c[0]=k$a[0]*k$b,k$c[1]=k$a[1]*k$b,k$c[2]=k$a[2]*k$b},k$e.lerpVector3=function(k$a,k$b,k$c,k$d){var k$e=k$a[0],k$f=k$a[1],k$g=k$a[2];k$d[0]=k$e+k$c*(k$b[0]-k$e),k$d[1]=k$f+k$c*(k$b[1]-k$f),k$d[2]=k$g+k$c*(k$b[2]-k$g)},k$e.lerpVector4=function(k$a,k$b,k$c,k$d){var k$e=k$a[0],k$f=k$a[1],k$g=k$a[2],k$h=k$a[3];k$d[0]=k$e+k$c*(k$b[0]-k$e),k$d[1]=k$f+k$c*(k$b[1]-k$f),k$d[2]=k$g+k$c*(k$b[2]-k$g),k$d[3]=k$h+k$c*(k$b[3]-k$h)},k$e.slerpQuaternionArray=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){var k$h,k$i,k$j,k$k,k$l,k$m=k$a[k$b+0],k$n=k$a[k$b+1],k$o=k$a[k$b+2],k$p=k$a[k$b+3],k$q=k$c[k$d+0],k$r=k$c[k$d+1],k$s=k$c[k$d+2],k$t=k$c[k$d+3];return(k$i=k$m*k$q+k$n*k$r+k$o*k$s+k$p*k$t)<0&&(k$i=-k$i,k$q=-k$q,k$r=-k$r,k$s=-k$s,k$t=-k$t),k$l=1e-6<1-k$i?(k$h=Math.acos(k$i),k$j=Math.sin(k$h),k$k=Math.sin((1-k$e)*k$h)/k$j,Math.sin(k$e*k$h)/k$j):(k$k=1-k$e,k$e),k$f[k$g+0]=k$k*k$m+k$l*k$q,k$f[k$g+1]=k$k*k$n+k$l*k$r,k$f[k$g+2]=k$k*k$o+k$l*k$s,k$f[k$g+3]=k$k*k$p+k$l*k$t,k$f},k$e.getRotation=function(k$a,k$b,k$c,k$d){return Math.atan2(k$d-k$b,k$c-k$a)/Math.PI*180},k$e.sortBigFirst=function(k$a,k$b){return k$a==k$b?0:k$a<k$b?1:-1},k$e.sortSmallFirst=function(k$a,k$b){return k$a==k$b?0:k$a<k$b?-1:1},k$e.sortNumBigFirst=function(k$a,k$b){return parseFloat(k$b)-parseFloat(k$a)},k$e.sortNumSmallFirst=function(k$a,k$b){return parseFloat(k$a)-parseFloat(k$b)},k$e.sortByKey=function(k$c,k$a,k$b){var k$d;return void 0===k$a&&(k$a=!1),void 0===k$b&&(k$b=!0),k$d=k$a?k$b?k$e.sortNumBigFirst:k$e.sortBigFirst:k$b?k$e.sortNumSmallFirst:k$e.sortSmallFirst,function(k$a,k$b){return k$d(k$a[k$c],k$b[k$c])}},k$e}(),k$G=function(){function k$c(k$a,k$b,k$c,k$d,k$e,k$f){this.inPool=!1,this.bTransform=!1,void 0===k$a&&(k$a=1),void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=1),void 0===k$e&&(k$e=0),void 0===k$f&&(k$f=0),this.a=k$a,this.b=k$b,this.c=k$c,this.d=k$d,this.tx=k$e,this.ty=k$f,this._checkTransform()}k$k(k$c,"laya.maths.Matrix");var k$a=k$c.prototype;return k$a.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},k$a._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},k$a.setTranslate=function(k$a,k$b){return this.tx=k$a,this.ty=k$b,this},k$a.translate=function(k$a,k$b){return this.tx+=k$a,this.ty+=k$b,this},k$a.scale=function(k$a,k$b){this.a*=k$a,this.d*=k$b,this.c*=k$a,this.b*=k$b,this.tx*=k$a,this.ty*=k$b,this.bTransform=!0},k$a.rotate=function(k$a){var k$b=Math.cos(k$a),k$c=Math.sin(k$a),k$d=this.a,k$e=this.c,k$f=this.tx;this.a=k$d*k$b-this.b*k$c,this.b=k$d*k$c+this.b*k$b,this.c=k$e*k$b-this.d*k$c,this.d=k$e*k$c+this.d*k$b,this.tx=k$f*k$b-this.ty*k$c,this.ty=k$f*k$c+this.ty*k$b,this.bTransform=!0},k$a.skew=function(k$a,k$b){var k$c=Math.tan(k$a),k$d=Math.tan(k$b),k$e=this.a,k$f=this.b;return this.a+=k$d*this.c,this.b+=k$d*this.d,this.c+=k$c*k$e,this.d+=k$c*k$f,this},k$a.invertTransformPoint=function(k$a){var k$b=this.a,k$c=this.b,k$d=this.c,k$e=this.d,k$f=this.tx,k$g=k$b*k$e-k$c*k$d,k$h=k$e/k$g,k$i=-k$c/k$g,k$j=-k$d/k$g,k$k=k$b/k$g,k$l=(k$d*this.ty-k$e*k$f)/k$g,k$m=-(k$b*this.ty-k$c*k$f)/k$g;return k$a.setTo(k$h*k$a.x+k$j*k$a.y+k$l,k$i*k$a.x+k$k*k$a.y+k$m)},k$a.transformPoint=function(k$a){return k$a.setTo(this.a*k$a.x+this.c*k$a.y+this.tx,this.b*k$a.x+this.d*k$a.y+this.ty)},k$a.transformPointN=function(k$a){return k$a.setTo(this.a*k$a.x+this.c*k$a.y,this.b*k$a.x+this.d*k$a.y)},k$a.transformPointArray=function(k$a,k$b){for(var k$c=k$a.length,k$d=0;k$d<k$c;k$d+=2){var k$e=k$a[k$d],k$f=k$a[k$d+1];k$b[k$d]=this.a*k$e+this.c*k$f+this.tx,k$b[k$d+1]=this.b*k$e+this.d*k$f+this.ty}return k$b},k$a.transformPointArrayScale=function(k$a,k$b){for(var k$c=k$a.length,k$d=0;k$d<k$c;k$d+=2){var k$e=k$a[k$d],k$f=k$a[k$d+1];k$b[k$d]=this.a*k$e+this.c*k$f,k$b[k$d+1]=this.b*k$e+this.d*k$f}return k$b},k$a.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},k$a.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},k$a.invert=function(){var k$a=this.a,k$b=this.b,k$c=this.c,k$d=this.d,k$e=this.tx,k$f=k$a*k$d-k$b*k$c;return this.a=k$d/k$f,this.b=-k$b/k$f,this.c=-k$c/k$f,this.d=k$a/k$f,this.tx=(k$c*this.ty-k$d*k$e)/k$f,this.ty=-(k$a*this.ty-k$b*k$e)/k$f,this},k$a.setTo=function(k$a,k$b,k$c,k$d,k$e,k$f){return this.a=k$a,this.b=k$b,this.c=k$c,this.d=k$d,this.tx=k$e,this.ty=k$f,this},k$a.concat=function(k$a){var k$b=this.a,k$c=this.c,k$d=this.tx;return this.a=k$b*k$a.a+this.b*k$a.c,this.b=k$b*k$a.b+this.b*k$a.d,this.c=k$c*k$a.a+this.d*k$a.c,this.d=k$c*k$a.b+this.d*k$a.d,this.tx=k$d*k$a.a+this.ty*k$a.c+k$a.tx,this.ty=k$d*k$a.b+this.ty*k$a.d+k$a.ty,this},k$a.scaleEx=function(k$a,k$b){var k$c=this.a,k$d=this.b,k$e=this.c,k$f=this.d;0!==k$d||0!==k$e?(this.a=k$a*k$c,this.b=k$a*k$d,this.c=k$b*k$e):(this.a=k$a*k$c,this.b=0*k$f,this.c=0*k$c),this.d=k$b*k$f,this.bTransform=!0},k$a.rotateEx=function(k$a){var k$b=Math.cos(k$a),k$c=Math.sin(k$a),k$d=this.a,k$e=this.b,k$f=this.c,k$g=this.d;0!==k$e||0!==k$f?(this.a=k$b*k$d+k$c*k$f,this.b=k$b*k$e+k$c*k$g,this.c=-k$c*k$d+k$b*k$f,this.d=-k$c*k$e+k$b*k$g):(this.a=k$b*k$d,this.b=k$c*k$g,this.c=-k$c*k$d,this.d=k$b*k$g),this.bTransform=!0},k$a.clone=function(){var k$a=k$c.create();return k$a.a=this.a,k$a.b=this.b,k$a.c=this.c,k$a.d=this.d,k$a.tx=this.tx,k$a.ty=this.ty,k$a.bTransform=this.bTransform,k$a},k$a.copyTo=function(k$a){return k$a.a=this.a,k$a.b=this.b,k$a.c=this.c,k$a.d=this.d,k$a.tx=this.tx,k$a.ty=this.ty,k$a.bTransform=this.bTransform,k$a},k$a.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},k$a.destroy=function(){if(!this.inPool){var k$a=k$c._cache;this.inPool=!0,k$a._length||(k$a._length=0),(k$a[k$a._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},k$c.mul=function(k$a,k$b,k$c){var k$d=k$a.a,k$e=k$a.b,k$f=k$a.c,k$g=k$a.d,k$h=k$a.tx,k$i=k$a.ty,k$j=k$b.a,k$k=k$b.b,k$l=k$b.c,k$m=k$b.d,k$n=k$b.tx,k$o=k$b.ty;return 0!==k$k||0!==k$l?(k$c.a=k$d*k$j+k$e*k$l,k$c.b=k$d*k$k+k$e*k$m,k$c.c=k$f*k$j+k$g*k$l,k$c.d=k$f*k$k+k$g*k$m,k$c.tx=k$j*k$h+k$l*k$i+k$n,k$c.ty=k$k*k$h+k$m*k$i+k$o):(k$c.a=k$d*k$j,k$c.b=k$e*k$m,k$c.c=k$f*k$j,k$c.d=k$g*k$m,k$c.tx=k$j*k$h+k$n,k$c.ty=k$m*k$i+k$o),k$c},k$c.mul16=function(k$a,k$b,k$c){var k$d=k$a.a,k$e=k$a.b,k$f=k$a.c,k$g=k$a.d,k$h=k$a.tx,k$i=k$a.ty,k$j=k$b.a,k$k=k$b.b,k$l=k$b.c,k$m=k$b.d,k$n=k$b.tx,k$o=k$b.ty;return 0!==k$k||0!==k$l?(k$c[0]=k$d*k$j+k$e*k$l,k$c[1]=k$d*k$k+k$e*k$m,k$c[4]=k$f*k$j+k$g*k$l,k$c[5]=k$f*k$k+k$g*k$m,k$c[12]=k$j*k$h+k$l*k$i+k$n,k$c[13]=k$k*k$h+k$m*k$i+k$o):(k$c[0]=k$d*k$j,k$c[1]=k$e*k$m,k$c[4]=k$f*k$j,k$c[5]=k$g*k$m,k$c[12]=k$j*k$h+k$n,k$c[13]=k$m*k$i+k$o),k$c},k$c.mulPre=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){var k$i=k$a.a,k$j=k$a.b,k$k=k$a.c,k$l=k$a.d,k$m=k$a.tx,k$n=k$a.ty;return 0!==k$c||0!==k$d?(k$h.a=k$i*k$b+k$j*k$d,k$h.b=k$i*k$c+k$j*k$e,k$h.c=k$k*k$b+k$l*k$d,k$h.d=k$k*k$c+k$l*k$e,k$h.tx=k$b*k$m+k$d*k$n+k$f,k$h.ty=k$c*k$m+k$e*k$n+k$g):(k$h.a=k$i*k$b,k$h.b=k$j*k$e,k$h.c=k$k*k$b,k$h.d=k$l*k$e,k$h.tx=k$b*k$m+k$f,k$h.ty=k$e*k$n+k$g),k$h},k$c.mulPos=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){var k$i=k$a.a,k$j=k$a.b,k$k=k$a.c,k$l=k$a.d,k$m=k$a.tx,k$n=k$a.ty;return 0!==k$j||0!==k$k?(k$h.a=k$b*k$i+k$c*k$k,k$h.b=k$b*k$j+k$c*k$l,k$h.c=k$d*k$i+k$e*k$k,k$h.d=k$d*k$j+k$e*k$l,k$h.tx=k$i*k$f+k$k*k$g+k$m,k$h.ty=k$j*k$f+k$l*k$g+k$n):(k$h.a=k$b*k$i,k$h.b=k$c*k$l,k$h.c=k$d*k$i,k$h.d=k$e*k$l,k$h.tx=k$i*k$f+k$m,k$h.ty=k$l*k$g+k$n),k$h},k$c.preMul=function(k$a,k$b,k$c){var k$d=k$a.a,k$e=k$a.b,k$f=k$a.c,k$g=k$a.d,k$h=k$b.a,k$i=k$b.b,k$j=k$b.c,k$k=k$b.d,k$l=k$b.tx,k$m=k$b.ty;return k$c.a=k$h*k$d,k$c.b=k$c.c=0,k$c.d=k$k*k$g,k$c.tx=k$l*k$d+k$a.tx,k$c.ty=k$m*k$g+k$a.ty,0===k$i&&0===k$j&&0===k$e&&0===k$f||(k$c.a+=k$i*k$f,k$c.d+=k$j*k$e,k$c.b+=k$h*k$e+k$i*k$g,k$c.c+=k$j*k$d+k$k*k$f,k$c.tx+=k$m*k$f,k$c.ty+=k$l*k$e),k$c},k$c.preMulXY=function(k$a,k$b,k$c,k$d){var k$e=k$a.a,k$f=k$a.b,k$g=k$a.c,k$h=k$a.d;return k$d.a=k$e,k$d.b=k$f,k$d.c=k$g,k$d.d=k$h,k$d.tx=k$b*k$e+k$a.tx+k$c*k$g,k$d.ty=k$c*k$h+k$a.ty+k$b*k$f,k$d},k$c.create=function(){var k$a=k$c._cache,k$b=k$a._length?k$a[--k$a._length]:new k$c;return k$b.inPool=!1,k$b},k$c.EMPTY=new k$c,k$c.TEMP=new k$c,k$c._cache=[],k$c}(),k$A=function(){function k$a(k$a,k$b){void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),this.x=k$a,this.y=k$b}k$k(k$a,"laya.maths.Point");var k$b=k$a.prototype;return k$b.setTo=function(k$a,k$b){return this.x=k$a,this.y=k$b,this},k$b.distance=function(k$a,k$b){return Math.sqrt((this.x-k$a)*(this.x-k$a)+(this.y-k$b)*(this.y-k$b))},k$b.toString=function(){return this.x+","+this.y},k$b.normalize=function(){var k$a=Math.sqrt(this.x*this.x+this.y*this.y);if(0<k$a){var k$b=1/k$a;this.x*=k$b,this.y*=k$b}},k$a.TEMP=new k$a,k$a.EMPTY=new k$a,k$a}(),k$B=function(){function k$j(k$a,k$b,k$c,k$d){void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=0),this.x=k$a,this.y=k$b,this.width=k$c,this.height=k$d}k$k(k$j,"laya.maths.Rectangle");var k$a=k$j.prototype;return k$a.setTo=function(k$a,k$b,k$c,k$d){return this.x=k$a,this.y=k$b,this.width=k$c,this.height=k$d,this},k$a.copyFrom=function(k$a){return this.x=k$a.x,this.y=k$a.y,this.width=k$a.width,this.height=k$a.height,this},k$a.contains=function(k$a,k$b){return!(this.width<=0||this.height<=0)&&(k$a>=this.x&&k$a<this.right&&k$b>=this.y&&k$b<this.bottom)},k$a.intersects=function(k$a){return!(k$a.x>this.x+this.width||k$a.x+k$a.width<this.x||k$a.y>this.y+this.height||k$a.y+k$a.height<this.y)},k$a.intersection=function(k$a,k$b){return this.intersects(k$a)?(k$b||(k$b=new k$j),k$b.x=Math.max(this.x,k$a.x),k$b.y=Math.max(this.y,k$a.y),k$b.width=Math.min(this.right,k$a.right)-k$b.x,k$b.height=Math.min(this.bottom,k$a.bottom)-k$b.y,k$b):null},k$a.union=function(k$a,k$b){return k$b||(k$b=new k$j),this.clone(k$b),k$a.width<=0||k$a.height<=0?k$b:(k$b.addPoint(k$a.x,k$a.y),k$b.addPoint(k$a.right,k$a.bottom),this)},k$a.clone=function(k$a){return k$a||(k$a=new k$j),k$a.x=this.x,k$a.y=this.y,k$a.width=this.width,k$a.height=this.height,k$a},k$a.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},k$a.equals=function(k$a){return!(!k$a||k$a.x!==this.x||k$a.y!==this.y||k$a.width!==this.width||k$a.height!==this.height)},k$a.addPoint=function(k$a,k$b){return this.x>k$a&&(this.width+=this.x-k$a,this.x=k$a),this.y>k$b&&(this.height+=this.y-k$b,this.y=k$b),this.width<k$a-this.x&&(this.width=k$a-this.x),this.height<k$b-this.y&&(this.height=k$b-this.y),this},k$a._getBoundPoints=function(){var k$a=k$j._temB;return(k$a.length=0)==this.width||0==this.height||k$a.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),k$a},k$a.isEmpty=function(){return this.width<=0||this.height<=0},k$o(0,k$a,"right",function(){return this.x+this.width}),k$o(0,k$a,"bottom",function(){return this.y+this.height}),k$j._getBoundPointS=function(k$a,k$b,k$c,k$d){var k$e=k$j._temA;return(k$e.length=0)==k$c||0==k$d||k$e.push(k$a,k$b,k$a+k$c,k$b,k$a,k$b+k$d,k$a+k$c,k$b+k$d),k$e},k$j._getWrapRec=function(k$a,k$b){if(!k$a||k$a.length<1)return k$b?k$b.setTo(0,0,0,0):k$j.TEMP.setTo(0,0,0,0);k$b=k$b||new k$j;var k$c,k$d,k$e,k$f,k$g,k$h=k$a.length,k$i=k$A.TEMP;for(k$e=k$g=-(k$d=k$f=99999),k$c=0;k$c<k$h;k$c+=2)k$i.x=k$a[k$c],k$i.y=k$a[k$c+1],k$d=k$d<k$i.x?k$d:k$i.x,k$f=k$f<k$i.y?k$f:k$i.y,k$e=k$e>k$i.x?k$e:k$i.x,k$g=k$g>k$i.y?k$g:k$i.y;return k$b.setTo(k$d,k$f,k$e-k$d,k$g-k$f)},k$j.EMPTY=new k$j,k$j.TEMP=new k$j,k$j._temB=[],k$j._temA=[],k$j}(),k$E=function(){function k$i(){}return k$k(k$i,"laya.media.SoundManager"),k$o(1,k$i,"useAudioMusic",function(){return k$i._useAudioMusic},function(k$a){k$i._useAudioMusic=k$a,k$i._musicClass=k$a?k$ca:null}),k$o(1,k$i,"autoStopMusic",function(){return k$i._autoStopMusic},function(k$a){k$z.stage.off("blur",null,k$i._stageOnBlur),k$z.stage.off("focus",null,k$i._stageOnFocus),k$z.stage.off("visibilitychange",null,k$i._visibilityChange),(k$i._autoStopMusic=k$a)&&(k$z.stage.on("blur",null,k$i._stageOnBlur),k$z.stage.on("focus",null,k$i._stageOnFocus),k$z.stage.on("visibilitychange",null,k$i._visibilityChange))}),k$o(1,k$i,"muted",function(){return k$i._muted},function(k$a){k$a!=k$i._muted&&(k$a&&k$i.stopAllSound(),k$i.musicMuted=k$a,k$i._muted=k$a)}),k$o(1,k$i,"musicMuted",function(){return k$i._musicMuted},function(k$a){k$a!=k$i._musicMuted&&(k$a?(k$i._tMusic&&k$i._musicChannel&&!k$i._musicChannel.isStopped?k$i._musicChannel.pause():k$i._musicChannel=null,k$i._musicMuted=k$a):(k$i._musicMuted=k$a,k$i._tMusic&&k$i._musicChannel&&k$i._musicChannel.resume()))}),k$o(1,k$i,"soundMuted",function(){return k$i._soundMuted},function(k$a){k$i._soundMuted=k$a}),k$i.addChannel=function(k$a){0<=k$i._channels.indexOf(k$a)||(k$i._channels.push(k$a),k$i.autoReleaseSound&&0!=k$i._notUsedCount&&k$i._notUsedUrls[k$a.url]&&(delete k$i._notUsedUrls[k$a.url],0==--k$i._notUsedCount&&k$z.timer.clear(k$i,k$i.disposeSoundIfNotUsed)))},k$i.removeChannel=function(k$a){var k$b=k$i._channels,k$c=k$b.indexOf(k$a);if(-1!=k$c&&(k$b.splice(k$c,1),k$i.autoReleaseSound)){var k$d=k$a.url,k$e=k$i.defaultIntervals[k$d]||2e4;if(0<k$e){var k$f=!0;for(k$c=k$b.length-1;0<=k$c;k$c--)if(k$b[k$c].url==k$d){k$f=!1;break}k$f&&(k$i._notUsedUrls[k$d]=Date.now()+k$e,0==k$i._notUsedCount++&&k$z.timer.loop(1e4,k$i,k$i.disposeSoundIfNotUsed))}}},k$i.disposeSoundIfNotUsed=function(){var k$a=k$i._notUsedUrls;if(0!=k$i._notUsedCount){var k$b=Date.now();for(var k$c in k$a)k$b>=k$a[k$c]&&(delete k$a[k$c],--k$i._notUsedCount,k$i.destroySound(k$c));if(0!=k$i._notUsedCount)return}k$z.timer.clear(k$i,k$i.disposeSoundIfNotUsed)},k$i._visibilityChange=function(){k$z.stage.isVisibility?k$i._stageOnFocus():k$i._stageOnBlur()},k$i._stageOnBlur=function(){k$i._isActive=!1,k$i._musicChannel&&(k$i._musicChannel.isStopped||(k$i._blurPaused=!0,k$i._musicChannel.pause())),k$i.stopAllSound(),k$z.stage.once("mousedown",null,k$i._stageOnFocus)},k$i._recoverWebAudio=function(){k$fa.ctx&&"running"!=k$fa.ctx.state&&k$fa.ctx.resume&&k$fa.ctx.resume()},k$i._stageOnFocus=function(){if(k$i._isActive=!0,k$i._recoverWebAudio(),k$z.stage.off("mousedown",null,k$i._stageOnFocus),k$i._blurPaused){var k$a=k$i._musicChannel;k$a&&k$i._music&&k$a.isStopped&&(k$i._blurPaused=!1,k$i._music._disposed?k$i.playMusic(k$a.url,k$a.loops,k$a.startHandler,k$a.completeHandler,k$a.startTime):k$a.audioBuffer?k$a.resume():k$i._music.play(k$a.startTime,k$a.loops,k$a.startHandler,k$a))}},k$i.playSound=function(k$a,k$b,k$c,k$d,k$e,k$f){if(void 0===k$b&&(k$b=1),void 0===k$f&&(k$f=0),!k$a)return null;if(k$i._muted)return null;if(k$i._recoverWebAudio(),k$a==k$i._tMusic){if(k$i._musicMuted)return null}else{if(!k$i._isActive)return null;if(k$i._soundMuted)return null}var k$g,k$h=k$i._pool[k$a];return k$e||(k$e=k$i._soundClass),k$h||((k$h=new k$e).load(k$a),k$i._pool[k$a]=k$h),(k$g=k$h.play(k$f,k$b,k$c))?(k$a==k$i._tMusic&&(k$i._music=k$h,k$i._isActive||(k$i._blurPaused=!0,k$g.pause())),k$g.url=k$a,k$g.volume=k$a==k$i._tMusic?k$i.musicVolume:k$i.soundVolume,k$g.completeHandler=k$d,k$g):null},k$i.destroySound=function(k$a){var k$b=k$i._pool[k$a];k$b&&(delete k$i._pool[k$a],k$b.dispose())},k$i.playMusic=function(k$a,k$b,k$c,k$d,k$e){return void 0===k$b&&(k$b=0),void 0===k$e&&(k$e=0),k$i._tMusic=k$a,k$i._musicChannel&&k$i._musicChannel.stop(),k$i._musicChannel=k$i.playSound(k$a,k$b,k$c,k$d,null,k$e)},k$i.stopSound=function(k$a){for(var k$b,k$c=k$i._channels.length-1;0<=k$c;k$c--)(k$b=k$i._channels[k$c]).url==k$a&&k$b.stop()},k$i.stopAll=function(){k$i._tMusic=null;var k$a=0;for(k$a=k$i._channels.length-1;0<=k$a;k$a--)k$i._channels[k$a].stop()},k$i.stopAllSound=function(){var k$a,k$b=0;for(k$b=k$i._channels.length-1;0<=k$b;k$b--)(k$a=k$i._channels[k$b]).url!=k$i._tMusic&&k$a.stop()},k$i.stopMusic=function(){k$i._musicChannel&&k$i._musicChannel.stop(),k$i._tMusic=null},k$i.setSoundVolume=function(k$a,k$b){if(k$b)k$i._setVolume(k$b,k$a);else{k$i.soundVolume=k$a;var k$c,k$d=0;for(k$d=k$i._channels.length-1;0<=k$d;k$d--)(k$c=k$i._channels[k$d]).url!=k$i._tMusic&&(k$c.volume=k$a)}},k$i.setMusicVolume=function(k$a){k$i.musicVolume=k$a,k$i._setVolume(k$i._tMusic,k$a)},k$i._setVolume=function(k$a,k$b){for(var k$c,k$d=k$i._channels.length-1;0<=k$d;k$d--)(k$c=k$i._channels[k$d]).url==k$a&&(k$c.volume=k$b)},k$i.musicVolume=1,k$i.soundVolume=1,k$i.playbackRate=1,k$i._useAudioMusic=!0,k$i._muted=!1,k$i._soundMuted=!1,k$i._musicMuted=!1,k$i._tMusic=null,k$i._musicChannel=null,k$i._music=null,k$i._channels=[],k$i._autoStopMusic=!1,k$i._blurPaused=!1,k$i._isActive=!0,k$i._soundClass=null,k$i._musicClass=null,k$i.autoReleaseSound=!0,k$i._pool={},k$i.defaultIntervals={},k$i._notUsedUrls={},k$i._notUsedCount=0,k$i}(),k$C=function(){var k$a;function k$c(){}return k$k(k$c,"laya.net.LocalStorage"),k$c.__init__=function(){k$c._baseClass||(k$c._baseClass=k$a).init(),k$c.items=k$c._baseClass.items,k$c.support=k$c._baseClass.support},k$c.setItem=function(k$a,k$b){k$c._baseClass.setItem(k$a,k$b)},k$c.getItem=function(k$a){return k$c._baseClass.getItem(k$a)},k$c.setJSON=function(k$a,k$b){k$c._baseClass.setJSON(k$a,k$b)},k$c.getJSON=function(k$a){return k$c._baseClass.getJSON(k$a)},k$c.removeItem=function(k$a){k$c._baseClass.removeItem(k$a)},k$c.clear=function(){k$c._baseClass.clear()},k$c._baseClass=null,k$c.items=null,k$c.support=!1,k$c.__init$=function(){k$a=function(){function k$c(){}return k$k(k$c,""),k$c.init=function(){try{k$c.support=!0,k$c.items=k$g.localStorage,k$c.setItem("laya","1"),k$c.removeItem("laya")}catch(k$a){k$c.support=!1}k$c.support||console.log("LocalStorage is not supprot or browser is private mode.")},k$c.setItem=function(k$a,k$b){try{k$c.support&&k$c.items.setItem(k$a,k$b)}catch(k$a){console.warn("set localStorage failed",k$a)}},k$c.getItem=function(k$a){return k$c.support?k$c.items.getItem(k$a):null},k$c.setJSON=function(k$a,k$b){try{k$c.support&&k$c.items.setItem(k$a,JSON.stringify(k$b))}catch(k$a){console.warn("set localStorage failed",k$a)}},k$c.getJSON=function(k$a){return JSON.parse(k$c.support?k$c.items.getItem(k$a):null)},k$c.removeItem=function(k$a){k$c.support&&k$c.items.removeItem(k$a)},k$c.clear=function(){k$c.support&&k$c.items.clear()},k$c.items=null,k$c.support=!1,k$c}()},k$c}(),k$H=(function(){function k$d(){}k$k(k$d,"laya.net.ResourceVersion"),k$d.enable=function(k$a,k$b,k$c){void 0===k$c&&(k$c=2),laya.net.ResourceVersion.type=k$c,k$z.loader.load(k$a,k$s.create(null,k$d.onManifestLoaded,[k$b]),null,"json"),k$I.customFormat=k$d.addVersionPrefix},k$d.onManifestLoaded=function(k$a,k$b){k$d.manifest=k$b,k$a.run(),k$b||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},k$d.addVersionPrefix=function(k$a){return k$d.manifest&&k$d.manifest[k$a]?2==k$d.type?k$d.manifest[k$a]:k$d.manifest[k$a]+"/"+k$a:k$a},k$d.FOLDER_VERSION=1,k$d.FILENAME_VERSION=2,k$d.manifest=null,k$d.type=1}(),function(){function k$a(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}k$k(k$a,"laya.net.TTFLoader");var k$b=k$a.prototype;return k$b.load=function(k$a){var k$b=(this._url=k$a).split(".ttf")[0].split("/");this.fontName=k$b[k$b.length-1],k$O.window.conch?this._loadConch():k$O.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},k$b._loadConch=function(){this._http=new k$ga,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},k$b._onHttpLoaded=function(k$a){k$O.window.conch.setFontFaceFromBuffer(this.fontName,k$a),this._clearHttp(),this._complete()},k$b._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},k$b._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},k$b._complete=function(){k$z.timer.clear(this,this._complete),k$z.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},k$b._checkComplete=function(){k$F.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},k$b._loadWithFontFace=function(){var k$a=new k$O.window.FontFace(this.fontName,"url('"+this._url+"')");k$O.window.document.fonts.add(k$a);var k$b=this;k$a.loaded.then(function(){k$b._complete()}),k$a.load()},k$b._createDiv=function(){this._div=k$O.createElement("div"),this._div.innerHTML="laya";var k$a=this._div.style;k$a.fontFamily=this.fontName,k$a.position="absolute",k$a.left="-100px",k$a.top="-100px",k$O.document.body.appendChild(this._div)},k$b._loadWithCSS=function(){var k$a=this,k$b=k$O.createElement("style");k$b.type="text/css",k$O.document.body.appendChild(k$b),k$b.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=k$F.measureText("LayaTTFFont",this._fontTxt).width;var k$c=this;k$b.onload=function(){k$z.timer.once(1e4,k$c,k$a._complete)},k$z.timer.loop(20,this,this._checkComplete),this._createDiv()},k$a._testString="LayaTTFFont",k$a}()),k$I=function(){function k$d(k$a){this._url=null,this._path=null,this._url=k$d.formatURL(k$a),this._path=k$d.getPath(k$a)}k$k(k$d,"laya.net.URL");var k$a=k$d.prototype;return k$o(0,k$a,"path",function(){return this._path}),k$o(0,k$a,"url",function(){return this._url}),k$d.formatURL=function(k$a,k$b){if(!k$a)return"null path";if(0<k$a.indexOf(":"))return k$a;null!=k$d.customFormat&&(k$a=k$d.customFormat(k$a,k$b));var k$c=k$a.charAt(0);if("."===k$c)return k$d.formatRelativePath((k$b||k$d.basePath)+k$a);if("~"===k$c)return k$d.rootPath+k$a.substring(1);if("d"===k$c){if(0===k$a.indexOf("data:image"))return k$a}else if("/"===k$c)return k$a;return(k$b||k$d.basePath)+k$a},k$d.formatRelativePath=function(k$a){for(var k$b=k$a.split("/"),k$c=0,k$d=k$b.length;k$c<k$d;k$c++)".."==k$b[k$c]&&(k$b.splice(k$c-1,2),k$c-=2);return k$b.join("/")},k$d.isAbsolute=function(k$a){return 0<k$a.indexOf(":")||"/"==k$a.charAt(0)},k$d.getPath=function(k$a){var k$b=k$a.lastIndexOf("/");return 0<k$b?k$a.substr(0,k$b+1):""},k$d.getFileName=function(k$a){var k$b=k$a.lastIndexOf("/");return 0<k$b?k$a.substr(k$b+1):k$a},k$d.version={},k$d.basePath="",k$d.rootPath="",k$d.customFormat=function(k$a){var k$b=k$d.version[k$a];return!k$J.isConchApp&&k$b&&(k$a+="?v="+k$b),k$a},k$d}(),k$J=function(){function k$e(k$a,k$b){this._timeId=0;var k$c=k$e._mainCanvas.source.style;k$c.position="absolute",k$c.top=k$c.left="0px",k$c.background="#000000",k$e._mainCanvas.source.id="layaCanvas";var k$d=laya.renders.Render.isWebGL;k$e._mainCanvas.source.width=k$a,k$e._mainCanvas.source.height=k$b,k$d&&k$e.WebGL.init(k$e._mainCanvas,k$a,k$b),k$O.container.appendChild(k$e._mainCanvas.source),(k$e._context=new k$K(k$a,k$b,k$d?null:k$e._mainCanvas)).ctx.setIsMainContext(),k$O.window.requestAnimationFrame(function k$a(k$b){k$O.window.requestAnimationFrame(k$a);k$z.stage._loop()}),k$z.stage.on("visibilitychange",this,this._onVisibilitychange)}k$k(k$e,"laya.renders.Render");var k$a=k$e.prototype;return k$a._onVisibilitychange=function(){k$z.stage.isVisibility?0!=this._timeId&&k$O.window.clearInterval(this._timeId):this._timeId=k$O.window.setInterval(this._enterFrame,1e3)},k$a._enterFrame=function(k$a){k$z.stage._loop()},k$o(1,k$e,"context",function(){return k$e._context}),k$o(1,k$e,"canvas",function(){return k$e._mainCanvas.source}),k$e._context=null,k$e._mainCanvas=null,k$e.WebGL=null,k$e.isConchNode=!1,k$e.isConchApp=!1,k$e.isConchWebGL=!1,k$e.isWebGL=!1,k$e.is3DMode=!1,k$e.optimizeTextureMemory=function(k$a,k$b){return!0},k$e.__init$=function(){k$g.ConchRenderType=k$g.ConchRenderType||1,k$g.ConchRenderType|=k$g.conch?4:0,k$e.isConchNode=5==(5&k$g.ConchRenderType),k$e.isConchApp=4==(4&k$g.ConchRenderType),k$e.isConchWebGL=6==k$g.ConchRenderType},k$e}(),k$K=function(){function k$g(k$a,k$b,k$c){this.x=0,this.y=0,this._drawTexture=function(k$a,k$b,k$c){k$c[0].loaded&&this.ctx.drawTexture(k$c[0],k$c[1],k$c[2],k$c[3],k$c[4],k$a,k$b)},this._fillTexture=function(k$a,k$b,k$c){k$c[0].loaded&&this.ctx.fillTexture(k$c[0],k$c[1]+k$a,k$c[2]+k$b,k$c[3],k$c[4],k$c[5],k$c[6],k$c[7])},this._drawTextureWithTransform=function(k$a,k$b,k$c){k$c[0].loaded&&this.ctx.drawTextureWithTransform(k$c[0],k$c[1],k$c[2],k$c[3],k$c[4],k$c[5],k$a,k$b,k$c[6])},this._fillQuadrangle=function(k$a,k$b,k$c){this.ctx.fillQuadrangle(k$c[0],k$c[1],k$c[2],k$c[3],k$c[4])},this._drawRect=function(k$a,k$b,k$c){var k$d=this.ctx;null!=k$c[4]&&(k$d.fillStyle=k$c[4],k$d.fillRect(k$a+k$c[0],k$b+k$c[1],k$c[2],k$c[3],null)),null!=k$c[5]&&(k$d.strokeStyle=k$c[5],k$d.lineWidth=k$c[6],k$d.strokeRect(k$a+k$c[0],k$b+k$c[1],k$c[2],k$c[3],k$c[6]))},this._drawPie=function(k$a,k$b,k$c){var k$d=this.ctx;k$J.isWebGL&&k$d.setPathId(k$c[8]),k$d.beginPath(),k$J.isWebGL?(k$d.movePath(k$c[0]+k$a,k$c[1]+k$b),k$d.moveTo(0,0)):k$d.moveTo(k$a+k$c[0],k$b+k$c[1]),k$d.arc(k$a+k$c[0],k$b+k$c[1],k$c[2],k$c[3],k$c[4]),k$d.closePath(),this._fillAndStroke(k$c[5],k$c[6],k$c[7],!0)},this._clipRect=function(k$a,k$b,k$c){this.ctx.clipRect(k$a+k$c[0],k$b+k$c[1],k$c[2],k$c[3])},this._fillRect=function(k$a,k$b,k$c){this.ctx.fillRect(k$a+k$c[0],k$b+k$c[1],k$c[2],k$c[3],k$c[4])},this._drawCircle=function(k$a,k$b,k$c){var k$d=this.ctx;k$J.isWebGL&&k$d.setPathId(k$c[6]),k$X.drawCall++,k$d.beginPath(),k$J.isWebGL&&k$d.movePath(k$c[0]+k$a,k$c[1]+k$b),k$d.arc(k$c[0]+k$a,k$c[1]+k$b,k$c[2],0,k$g.PI2),k$d.closePath(),this._fillAndStroke(k$c[3],k$c[4],k$c[5],!0)},this._fillCircle=function(k$a,k$b,k$c){k$X.drawCall++;var k$d=this.ctx;k$d.beginPath(),k$d.fillStyle=k$c[3],k$d.arc(k$c[0]+k$a,k$c[1]+k$b,k$c[2],0,k$g.PI2),k$d.fill()},this._setShader=function(k$a,k$b,k$c){this.ctx.setShader(k$c[0])},this._drawLine=function(k$a,k$b,k$c){var k$d=this.ctx;k$J.isWebGL&&k$d.setPathId(k$c[6]),k$d.beginPath(),k$d.strokeStyle=k$c[4],k$d.lineWidth=k$c[5],k$J.isWebGL?(k$d.movePath(k$a,k$b),k$d.moveTo(k$c[0],k$c[1]),k$d.lineTo(k$c[2],k$c[3])):(k$d.moveTo(k$a+k$c[0],k$b+k$c[1]),k$d.lineTo(k$a+k$c[2],k$b+k$c[3])),k$d.stroke()},this._drawLines=function(k$a,k$b,k$c){var k$d=this.ctx;k$J.isWebGL&&k$d.setPathId(k$c[5]),k$d.beginPath(),k$a+=k$c[0],k$b+=k$c[1],k$J.isWebGL&&k$d.movePath(k$a,k$b),k$d.strokeStyle=k$c[3],k$d.lineWidth=k$c[4];var k$e=k$c[2],k$f=2,k$g=k$e.length;if(k$J.isWebGL)for(k$d.moveTo(k$e[0],k$e[1]);k$f<k$g;)k$d.lineTo(k$e[k$f++],k$e[k$f++]);else for(k$d.moveTo(k$a+k$e[0],k$b+k$e[1]);k$f<k$g;)k$d.lineTo(k$a+k$e[k$f++],k$b+k$e[k$f++]);k$d.stroke()},this._drawLinesWebGL=function(k$a,k$b,k$c){this.ctx.drawLines(k$a+this.x+k$c[0],k$b+this.y+k$c[1],k$c[2],k$c[3],k$c[4])},this._drawCurves=function(k$a,k$b,k$c){this.ctx.drawCurves(k$a,k$b,k$c)},this._draw=function(k$a,k$b,k$c){k$c[0].call(null,this,k$a,k$b)},this._transformByMatrix=function(k$a,k$b,k$c){this.ctx.transformByMatrix(k$c[0])},this._setTransform=function(k$a,k$b,k$c){this.ctx.setTransform(k$c[0],k$c[1],k$c[2],k$c[3],k$c[4],k$c[5])},this._setTransformByMatrix=function(k$a,k$b,k$c){this.ctx.setTransformByMatrix(k$c[0])},this._save=function(k$a,k$b,k$c){this.ctx.save()},this._restore=function(k$a,k$b,k$c){this.ctx.restore()},this._translate=function(k$a,k$b,k$c){this.ctx.translate(k$c[0],k$c[1])},this._transform=function(k$a,k$b,k$c){this.ctx.translate(k$c[1]+k$a,k$c[2]+k$b);var k$d=k$c[0];this.ctx.transform(k$d.a,k$d.b,k$d.c,k$d.d,k$d.tx,k$d.ty),this.ctx.translate(-k$a-k$c[1],-k$b-k$c[2])},this._rotate=function(k$a,k$b,k$c){this.ctx.translate(k$c[1]+k$a,k$c[2]+k$b),this.ctx.rotate(k$c[0]),this.ctx.translate(-k$a-k$c[1],-k$b-k$c[2])},this._scale=function(k$a,k$b,k$c){this.ctx.translate(k$c[2]+k$a,k$c[3]+k$b),this.ctx.scale(k$c[0],k$c[1]),this.ctx.translate(-k$a-k$c[2],-k$b-k$c[3])},this._alpha=function(k$a,k$b,k$c){this.ctx.globalAlpha*=k$c[0]},this._setAlpha=function(k$a,k$b,k$c){this.ctx.globalAlpha=k$c[0]},this._fillText=function(k$a,k$b,k$c){this.ctx.fillText(k$c[0],k$c[1]+k$a,k$c[2]+k$b,k$c[3],k$c[4],k$c[5])},this._strokeText=function(k$a,k$b,k$c){this.ctx.strokeText(k$c[0],k$c[1]+k$a,k$c[2]+k$b,k$c[3],k$c[4],k$c[5],k$c[6])},this._fillBorderText=function(k$a,k$b,k$c){this.ctx.fillBorderText(k$c[0],k$c[1]+k$a,k$c[2]+k$b,k$c[3],k$c[4],k$c[5],k$c[6],k$c[7])},this._blendMode=function(k$a,k$b,k$c){this.ctx.globalCompositeOperation=k$c[0]},this._beginClip=function(k$a,k$b,k$c){this.ctx.beginClip&&this.ctx.beginClip(k$a+k$c[0],k$b+k$c[1],k$c[2],k$c[3])},this._setIBVB=function(k$a,k$b,k$c){this.ctx.setIBVB(k$c[0]+k$a,k$c[1]+k$b,k$c[2],k$c[3],k$c[4],k$c[5],k$c[6],k$c[7])},this._fillTrangles=function(k$a,k$b,k$c){this.ctx.fillTrangles(k$c[0],k$c[1]+k$a,k$c[2]+k$b,k$c[3],k$c[4])},this._drawPath=function(k$a,k$b,k$c){var k$d=this.ctx;k$J.isWebGL&&k$d.setPathId(-1),k$d.beginPath(),k$a+=k$c[0],k$b+=k$c[1],k$J.isWebGL&&k$d.movePath(k$a,k$b);for(var k$e=k$c[2],k$f=0,k$g=k$e.length;k$f<k$g;k$f++){var k$h=k$e[k$f];switch(k$h[0]){case"moveTo":k$J.isWebGL?k$d.moveTo(k$h[1],k$h[2]):k$d.moveTo(k$a+k$h[1],k$b+k$h[2]);break;case"lineTo":k$J.isWebGL?k$d.lineTo(k$h[1],k$h[2]):k$d.lineTo(k$a+k$h[1],k$b+k$h[2]);break;case"arcTo":k$J.isWebGL?k$d.arcTo(k$h[1],k$h[2],k$h[3],k$h[4],k$h[5]):k$d.arcTo(k$a+k$h[1],k$b+k$h[2],k$a+k$h[3],k$b+k$h[4],k$h[5]);break;case"closePath":k$d.closePath()}}var k$i=k$c[3];null!=k$i&&(k$d.fillStyle=k$i.fillStyle,k$d.fill());var k$j=k$c[4];null!=k$j&&(k$d.strokeStyle=k$j.strokeStyle,k$d.lineWidth=k$j.lineWidth||1,k$d.lineJoin=k$j.lineJoin,k$d.lineCap=k$j.lineCap,k$d.miterLimit=k$j.miterLimit,k$d.stroke())},this.drawPoly=function(k$a,k$b,k$c){this.ctx.drawPoly(k$a+this.x+k$c[0],k$b+this.y+k$c[1],k$c[2],k$c[3],k$c[4],k$c[5],k$c[6])},this._drawPoly=function(k$a,k$b,k$c){var k$d=this.ctx,k$e=k$c[2],k$f=2,k$g=k$e.length;if(k$J.isWebGL)for(k$d.setPathId(k$c[6]),k$d.beginPath(),k$a+=k$c[0],k$b+=k$c[1],k$d.movePath(k$a,k$b),k$d.moveTo(k$e[0],k$e[1]);k$f<k$g;)k$d.lineTo(k$e[k$f++],k$e[k$f++]);else for(k$d.beginPath(),k$a+=k$c[0],k$b+=k$c[1],k$d.moveTo(k$a+k$e[0],k$b+k$e[1]);k$f<k$g;)k$d.lineTo(k$a+k$e[k$f++],k$b+k$e[k$f++]);k$d.closePath(),this._fillAndStroke(k$c[3],k$c[4],k$c[5],k$c[7])},this._drawSkin=function(k$a,k$b,k$c){var k$d=k$c[0];if(k$d){var k$e=this.ctx;k$d.render(k$e,k$a,k$b)}},this._drawParticle=function(k$a,k$b,k$c){this.ctx.drawParticle(k$a+this.x,k$b+this.y,k$c[0])},this._setFilters=function(k$a,k$b,k$c){this.ctx.setFilters(k$c)},k$c?this.ctx=k$c.getContext("2d"):(k$c=k$ta.create("3D"),this.ctx=k$F.createWebGLContext2D(k$c),k$c._setContext(this.ctx)),k$c.size(k$a,k$b),this.canvas=k$c}k$k(k$g,"laya.renders.RenderContext");var k$a=k$g.prototype;return k$a.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},k$a.drawTexture=function(k$a,k$b,k$c,k$d,k$e){k$a.loaded&&this.ctx.drawTexture(k$a,k$b,k$c,k$d,k$e,this.x,this.y)},k$a._drawTextures=function(k$a,k$b,k$c){k$c[0].loaded&&this.ctx.drawTextures(k$c[0],k$c[1],k$a+this.x,k$b+this.y)},k$a.drawTextureWithTransform=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){k$a.loaded&&this.ctx.drawTextureWithTransform(k$a,k$b,k$c,k$d,k$e,k$f,this.x,this.y,k$g)},k$a.fillQuadrangle=function(k$a,k$b,k$c,k$d,k$e){this.ctx.fillQuadrangle(k$a,k$b,k$c,k$d,k$e)},k$a.drawCanvas=function(k$a,k$b,k$c,k$d,k$e){this.ctx.drawCanvas(k$a,k$b+this.x,k$c+this.y,k$d,k$e)},k$a.drawRect=function(k$a,k$b,k$c,k$d,k$e,k$f){void 0===k$f&&(k$f=1);var k$g=this.ctx;k$g.strokeStyle=k$e,k$g.lineWidth=k$f,k$g.strokeRect(k$a+this.x,k$b+this.y,k$c,k$d,k$f)},k$a._fillAndStroke=function(k$a,k$b,k$c,k$d){void 0===k$d&&(k$d=!1);var k$e=this.ctx;null!=k$a&&(k$e.fillStyle=k$a,k$J.isWebGL?k$e.fill(k$d):k$e.fill()),null!=k$b&&0<k$c&&(k$e.strokeStyle=k$b,k$e.lineWidth=k$c,k$e.stroke())},k$a.clipRect=function(k$a,k$b,k$c,k$d){this.ctx.clipRect(k$a+this.x,k$b+this.y,k$c,k$d)},k$a.fillRect=function(k$a,k$b,k$c,k$d,k$e){this.ctx.fillRect(k$a+this.x,k$b+this.y,k$c,k$d,k$e)},k$a.drawCircle=function(k$a,k$b,k$c,k$d,k$e){void 0===k$e&&(k$e=1),k$X.drawCall++;var k$f=this.ctx;k$f.beginPath(),k$f.strokeStyle=k$d,k$f.lineWidth=k$e,k$f.arc(k$a+this.x,k$b+this.y,k$c,0,k$g.PI2),k$f.stroke()},k$a.drawTriangles=function(k$a,k$b,k$c){if(k$J.isWebGL)this.ctx.drawTriangles(k$c[0],k$a+k$c[1],k$b+k$c[2],k$c[3],k$c[4],k$c[5],k$c[6],k$c[7],k$c[8],k$c[9]);else{var k$d=k$c[5],k$e=0,k$f=k$d.length,k$g=this.ctx;for(k$e=0;k$e<k$f;k$e+=3){var k$h=2*k$d[k$e],k$i=2*k$d[k$e+1],k$j=2*k$d[k$e+2];k$g.drawTriangle(k$c[0],k$c[3],k$c[4],k$h,k$i,k$j,k$c[6],!0)}}},k$a.fillCircle=function(k$a,k$b,k$c,k$d){k$X.drawCall++;var k$e=this.ctx;k$e.beginPath(),k$e.fillStyle=k$d,k$e.arc(k$a+this.x,k$b+this.y,k$c,0,k$g.PI2),k$e.fill()},k$a.setShader=function(k$a){this.ctx.setShader(k$a)},k$a.drawLine=function(k$a,k$b,k$c,k$d,k$e,k$f){void 0===k$f&&(k$f=1);var k$g=this.ctx;k$g.beginPath(),k$g.strokeStyle=k$e,k$g.lineWidth=k$f,k$g.moveTo(this.x+k$a,this.y+k$b),k$g.lineTo(this.x+k$c,this.y+k$d),k$g.stroke()},k$a.clear=function(){this.ctx.clear()},k$a.transformByMatrix=function(k$a){this.ctx.transformByMatrix(k$a)},k$a.setTransform=function(k$a,k$b,k$c,k$d,k$e,k$f){this.ctx.setTransform(k$a,k$b,k$c,k$d,k$e,k$f)},k$a.setTransformByMatrix=function(k$a){this.ctx.setTransformByMatrix(k$a)},k$a.save=function(){this.ctx.save()},k$a.restore=function(){this.ctx.restore()},k$a.translate=function(k$a,k$b){this.ctx.translate(k$a,k$b)},k$a.transform=function(k$a,k$b,k$c,k$d,k$e,k$f){this.ctx.transform(k$a,k$b,k$c,k$d,k$e,k$f)},k$a.rotate=function(k$a){this.ctx.rotate(k$a)},k$a.scale=function(k$a,k$b){this.ctx.scale(k$a,k$b)},k$a.alpha=function(k$a){this.ctx.globalAlpha*=k$a},k$a.setAlpha=function(k$a){this.ctx.globalAlpha=k$a},k$a.fillWords=function(k$a,k$b,k$c,k$d,k$e,k$f){void 0===k$f&&(k$f=0),this.ctx.fillWords(k$a,k$b,k$c,k$d,k$e,k$f)},k$a.fillBorderWords=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this.ctx.fillBorderWords(k$a,k$b,k$c,k$d,k$e,k$f,k$g)},k$a.fillText=function(k$a,k$b,k$c,k$d,k$e,k$f){this.ctx.fillText(k$a,k$b+this.x,k$c+this.y,k$d,k$e,k$f)},k$a.strokeText=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this.ctx.strokeText(k$a,k$b+this.x,k$c+this.y,k$d,k$e,k$f,k$g)},k$a.blendMode=function(k$a){this.ctx.globalCompositeOperation=k$a},k$a.flush=function(){this.ctx.flush&&this.ctx.flush()},k$a.addRenderObject=function(k$a){this.ctx.addRenderObject(k$a)},k$a.beginClip=function(k$a,k$b,k$c,k$d){this.ctx.beginClip&&this.ctx.beginClip(k$a,k$b,k$c,k$d)},k$a.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},k$a.fillTrangles=function(k$a,k$b,k$c){this.ctx.fillTrangles(k$c[0],k$c[1],k$c[2],k$c[3],4<k$c.length?k$c[4]:null)},k$g.PI2=2*Math.PI,k$g}(),k$L=function(){function k$g(k$a,k$b){switch(this._next=k$b||k$g.NORENDER,k$a){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=k$r._filter);case 69905:return void(this._fun=k$g._initRenderFun)}this.onCreate(k$a)}k$k(k$g,"laya.renders.RenderSprite");var k$a=k$g.prototype;return k$a.onCreate=function(k$a){},k$a._style=function(k$a,k$b,k$c,k$d){k$a._style.render(k$a,k$b,k$c,k$d);var k$e=this._next;k$e._fun.call(k$e,k$a,k$b,k$c,k$d)},k$a._no=function(k$a,k$b,k$c,k$d){},k$a._custom=function(k$a,k$b,k$c,k$d){k$a.customRender(k$b,k$c,k$d);var k$e=k$a._style._tf;this._next._fun.call(this._next,k$a,k$b,k$c-k$e.translateX,k$d-k$e.translateY)},k$a._clip=function(k$a,k$b,k$c,k$d){var k$e=this._next;if(k$e!=k$g.NORENDER){var k$f=k$a._style.scrollRect;k$b.ctx.save(),k$b.ctx.clipRect(k$c,k$d,k$f.width,k$f.height),k$e._fun.call(k$e,k$a,k$b,k$c-k$f.x,k$d-k$f.y),k$b.ctx.restore()}},k$a._blend=function(k$a,k$b,k$c,k$d){var k$e=k$a._style;k$e.blendMode&&(k$b.ctx.globalCompositeOperation=k$e.blendMode);var k$f=this._next;k$f._fun.call(k$f,k$a,k$b,k$c,k$d),k$b.ctx.globalCompositeOperation="source-over"},k$a._mask=function(k$a,k$b,k$c,k$d){var k$e=this._next;k$e._fun.call(k$e,k$a,k$b,k$c,k$d);var k$f=k$a.mask;k$f&&(k$b.ctx.globalCompositeOperation="destination-in",(0<k$f.numChildren||!k$f.graphics._isOnlyOne())&&(k$f.cacheAsBitmap=!0),k$f.render(k$b,k$c-k$a.pivotX,k$d-k$a.pivotY)),k$b.ctx.globalCompositeOperation="source-over"},k$a._graphics=function(k$a,k$b,k$c,k$d){var k$e=k$a._style._tf;k$a._graphics&&k$a._graphics._render(k$a,k$b,k$c-k$e.translateX,k$d-k$e.translateY);var k$f=this._next;k$f._fun.call(k$f,k$a,k$b,k$c,k$d)},k$a._image=function(k$a,k$b,k$c,k$d){var k$e=k$a._style;k$b.ctx.drawTexture2(k$c,k$d,k$e._tf.translateX,k$e._tf.translateY,k$a.transform,k$e.alpha,k$e.blendMode,k$a._graphics._one)},k$a._image2=function(k$a,k$b,k$c,k$d){var k$e=k$a._style._tf;k$b.ctx.drawTexture2(k$c,k$d,k$e.translateX,k$e.translateY,k$a.transform,1,null,k$a._graphics._one)},k$a._alpha=function(k$a,k$b,k$c,k$d){var k$e;if(.01<(k$e=k$a._style.alpha)||k$a._needRepaint()){var k$f=k$b.ctx.globalAlpha;k$b.ctx.globalAlpha*=k$e;var k$g=this._next;k$g._fun.call(k$g,k$a,k$b,k$c,k$d),k$b.ctx.globalAlpha=k$f}},k$a._transform=function(k$a,k$b,k$c,k$d){var k$e=k$a.transform,k$f=this._next;k$e&&k$f!=k$g.NORENDER?(k$b.save(),k$b.transform(k$e.a,k$e.b,k$e.c,k$e.d,k$e.tx+k$c,k$e.ty+k$d),k$f._fun.call(k$f,k$a,k$b,0,0),k$b.restore()):k$f._fun.call(k$f,k$a,k$b,k$c,k$d)},k$a._childs=function(k$a,k$b,k$c,k$d){var k$e=k$a._style,k$f=k$e._tf;if(k$c=k$c-k$f.translateX+k$e.paddingLeft,k$d=k$d-k$f.translateY+k$e.paddingTop,k$e._calculation){var k$g=k$a._getWords();if(k$g){var k$h=k$e;k$h&&(k$h.stroke?k$b.fillBorderWords(k$g,k$c,k$d,k$h.font,k$h.color,k$h.strokeColor,k$h.stroke):k$b.fillWords(k$g,k$c,k$d,k$h.font,k$h.color,"none"!=k$h.textDecoration&&k$h.underLine?1:0))}}var k$i,k$j=k$a._childs,k$k=k$j.length;if(k$a.viewport||k$a.optimizeScrollRect&&k$a._style.scrollRect){var k$l=k$a.viewport||k$a._style.scrollRect,k$m=k$l.x,k$n=k$l.y,k$o=k$l.right,k$p=k$l.bottom,k$q=NaN,k$r=NaN;for(k$s=0;k$s<k$k;++k$s)(k$i=k$j[k$s]).visible&&(k$q=k$i._x)<k$o&&k$q+k$i.width>k$m&&(k$r=k$i._y)<k$p&&k$r+k$i.height>k$n&&k$i.render(k$b,k$c,k$d)}else for(var k$s=0;k$s<k$k;++k$s)(k$i=k$j[k$s])._style.visible&&k$i.render(k$b,k$c,k$d)},k$a._canvas=function(k$a,k$b,k$c,k$d){var k$e=k$a._$P.cacheCanvas;if(k$e){"bitmap"===k$e.type?k$X.canvasBitmap++:k$X.canvasNormal++;var k$f=k$e.ctx;if(k$a._needRepaint()||!k$f)this._canvas_repaint(k$a,k$b,k$c,k$d);else{var k$g=k$e._cacheRec;k$b.drawCanvas(k$f.canvas,k$c+k$g.x,k$d+k$g.y,k$g.width,k$g.height)}}else this._next._fun.call(this._next,k$a,k$b,k$c,k$d)},k$a._canvas_repaint=function(k$a,k$b,k$c,k$d){var k$e=k$a._$P.cacheCanvas,k$f=this._next;if(k$e){var k$g,k$h,k$i,k$j,k$k=k$e.ctx,k$l=k$a._needRepaint()||!k$k,k$m=k$e.type;if("bitmap"===k$m?k$X.canvasBitmap++:k$X.canvasNormal++,k$l){var k$n,k$o;k$e._cacheRec||(k$e._cacheRec=new k$B),k$J.isWebGL&&"bitmap"!==k$m?k$e._cacheRec.setTo(-k$a.pivotX,-k$a.pivotY,1,1):((k$j=k$a.getSelfBounds()).x=k$j.x-k$a.pivotX,k$j.y=k$j.y-k$a.pivotY,k$j.x=k$j.x-16,k$j.y=k$j.y-16,k$j.width=k$j.width+32,k$j.height=k$j.height+32,k$j.x=Math.floor(k$j.x+k$c)-k$c,k$j.y=Math.floor(k$j.y+k$d)-k$d,k$j.width=Math.floor(k$j.width),k$j.height=Math.floor(k$j.height),k$e._cacheRec.copyFrom(k$j)),k$j=k$e._cacheRec;var k$p,k$q=k$J.isWebGL?1:k$O.pixelRatio*k$z.stage.clientScaleX,k$r=k$J.isWebGL?1:k$O.pixelRatio*k$z.stage.clientScaleY;if(!k$J.isWebGL){var k$s,k$t=1,k$w=1;for(k$s=k$a;k$s&&k$s!=k$z.stage;)k$t*=k$s.scaleX,k$w*=k$s.scaleY,k$s=k$s.parent;k$J.isWebGL?(k$t<1&&(k$q*=k$t),k$w<1&&(k$r*=k$w)):(1<k$t&&(k$q*=k$t),1<k$w&&(k$r*=k$w))}if(k$a.scrollRect){var k$x=k$a.scrollRect;k$j.x-=k$x.x,k$j.y-=k$x.y}if(k$n=k$j.width*k$q,k$o=k$j.height*k$r,k$h=k$j.x,k$i=k$j.y,k$J.isWebGL&&"bitmap"===k$m&&(2048<k$n||2048<k$o))return console.warn("cache bitmap size larger than 2048,cache ignored"),k$e.ctx&&(k$W.recover("RenderContext",k$e.ctx),k$e.ctx.canvas.size(0,0),k$e.ctx=null),void k$f._fun.call(k$f,k$a,k$b,k$c,k$d);if(k$k||(k$k=k$e.ctx=k$W.getItem("RenderContext")||new k$K(k$n,k$o,k$ta.create("AUTO"))),k$k.ctx.sprite=k$a,(k$g=k$k.canvas).clear(),(k$g.width!=k$n||k$g.height!=k$o)&&k$g.size(k$n,k$o),"bitmap"===k$m?k$g.context.asBitmap=!0:"normal"===k$m&&(k$g.context.asBitmap=!1),1!=k$q||1!=k$r){var k$y=k$k.ctx;k$y.save(),k$y.scale(k$q,k$r),!k$J.isConchWebGL&&k$J.isConchApp&&(k$p=k$a._$P.cf)&&k$y.setFilterMatrix&&k$y.setFilterMatrix(k$p._mat,k$p._alpha),k$f._fun.call(k$f,k$a,k$k,-k$h,-k$i),k$y.restore(),k$J.isConchApp&&!k$J.isConchWebGL||k$a._applyFilters()}else k$y=k$k.ctx,!k$J.isConchWebGL&&k$J.isConchApp&&(k$p=k$a._$P.cf)&&k$y.setFilterMatrix&&k$y.setFilterMatrix(k$p._mat,k$p._alpha),k$f._fun.call(k$f,k$a,k$k,-k$h,-k$i),k$J.isConchApp&&!k$J.isConchWebGL||k$a._applyFilters();k$a._$P.staticCache&&(k$e.reCache=!1),k$X.canvasReCache++}else k$h=(k$j=k$e._cacheRec).x,k$i=k$j.y,k$g=k$k.canvas;k$b.drawCanvas(k$g,k$c+k$h,k$d+k$i,k$j.width,k$j.height)}else k$f._fun.call(k$f,k$a,k$k,k$c,k$d)},k$g.__init__=function(){var k$a,k$b,k$c=0;for(k$b=k$F.createRenderSprite(69905,null),k$a=k$g.renders.length=4096,k$c=0;k$c<k$a;k$c++)k$g.renders[k$c]=k$b;k$g.renders[0]=k$F.createRenderSprite(0,null),function(k$a,k$b){for(var k$c=0,k$d=0;k$d<k$a.length;k$d++)k$c|=k$a[k$d],k$g.renders[k$c]=k$b}([1,512,4,2],new k$g(1,null)),k$g.renders[513]=k$F.createRenderSprite(513,null),k$g.renders[517]=new k$g(517,null)},k$g._initRenderFun=function(k$a,k$b,k$c,k$d){var k$e=k$a._renderType;(k$g.renders[k$e]=k$g._getTypeRender(k$e))._fun(k$a,k$b,k$c,k$d)},k$g._getTypeRender=function(k$a){for(var k$b=null,k$c=2048;1<k$c;)k$c&k$a&&(k$b=k$F.createRenderSprite(k$c,k$b)),k$c>>=1;return k$b},k$g.IMAGE=1,k$g.ALPHA=2,k$g.TRANSFORM=4,k$g.BLEND=8,k$g.CANVAS=16,k$g.FILTERS=32,k$g.MASK=64,k$g.CLIP=128,k$g.STYLE=256,k$g.GRAPHICS=512,k$g.CUSTOM=1024,k$g.CHILDS=2048,k$g.INIT=69905,k$g.renders=[],k$g.NORENDER=new k$g(0,null),k$g}(),k$M=function(){function k$h(){this._repaint=!1}k$k(k$h,"laya.resource.Context");var k$a=k$h.prototype;return k$a.replaceReset=function(){var k$a,k$b,k$c=0;for(k$a=k$h.replaceKeys.length,k$c=0;k$c<k$a;k$c++)k$b=k$h.replaceKeys[k$c],this[k$h.newKeys[k$c]]=this[k$b]},k$a.replaceResotre=function(){this.__restore(),this.__reset()},k$a.setIsMainContext=function(){},k$a.drawTextures=function(k$a,k$b,k$c,k$d){k$X.drawCall+=k$b.length/2;for(var k$e=k$a.width,k$f=k$a.height,k$g=0,k$h=k$b.length;k$g<k$h;k$g+=2)this.drawTexture(k$a,k$b[k$g],k$b[k$g+1],k$e,k$f,k$c,k$d)},k$a.drawCanvas=function(k$a,k$b,k$c,k$d,k$e){k$X.drawCall++,this.drawImage(k$a.source,k$b,k$c,k$d,k$e)},k$a.fillRect=function(k$a,k$b,k$c,k$d,k$e){k$X.drawCall++,k$e&&(this.fillStyle=k$e),this.__fillRect(k$a,k$b,k$c,k$d)},k$a.fillText=function(k$a,k$b,k$c,k$d,k$e,k$f){k$X.drawCall++,3<arguments.length&&null!=k$d&&(this.font=k$d,this.fillStyle=k$e,this.textAlign=k$f,this.textBaseline="top"),this.__fillText(k$a,k$b,k$c)},k$a.fillBorderText=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){k$X.drawCall++,this.font=k$d,this.fillStyle=k$e,this.textBaseline="top",this.strokeStyle=k$f,this.lineWidth=k$g,this.textAlign=k$h,this.__strokeText(k$a,k$b,k$c),this.__fillText(k$a,k$b,k$c)},k$a.strokeText=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){k$X.drawCall++,3<arguments.length&&null!=k$d&&(this.font=k$d,this.strokeStyle=k$e,this.lineWidth=k$f,this.textAlign=k$g,this.textBaseline="top"),this.__strokeText(k$a,k$b,k$c)},k$a.transformByMatrix=function(k$a){this.transform(k$a.a,k$a.b,k$a.c,k$a.d,k$a.tx,k$a.ty)},k$a.setTransformByMatrix=function(k$a){this.setTransform(k$a.a,k$a.b,k$a.c,k$a.d,k$a.tx,k$a.ty)},k$a.clipRect=function(k$a,k$b,k$c,k$d){k$X.drawCall++,this.beginPath(),this.rect(k$a,k$b,k$c,k$d),this.clip()},k$a.drawTexture=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){k$X.drawCall++;var k$h=k$a.uv,k$i=k$a.bitmap.width,k$j=k$a.bitmap.height;this.drawImage(k$a.source,k$h[0]*k$i,k$h[1]*k$j,(k$h[2]-k$h[0])*k$i,(k$h[5]-k$h[3])*k$j,k$b+k$f,k$c+k$g,k$d,k$e)},k$a.drawTextureWithTransform=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){k$X.drawCall++;var k$j=k$a.uv,k$k=k$a.bitmap.width,k$l=k$a.bitmap.height;this.save(),1!=k$i&&(this.globalAlpha*=k$i),k$f?(this.transform(k$f.a,k$f.b,k$f.c,k$f.d,k$f.tx+k$g,k$f.ty+k$h),this.drawImage(k$a.source,k$j[0]*k$k,k$j[1]*k$l,(k$j[2]-k$j[0])*k$k,(k$j[5]-k$j[3])*k$l,k$b,k$c,k$d,k$e)):this.drawImage(k$a.source,k$j[0]*k$k,k$j[1]*k$l,(k$j[2]-k$j[0])*k$k,(k$j[5]-k$j[3])*k$l,k$b+k$g,k$c+k$h,k$d,k$e),this.restore()},k$a.drawTexture2=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){var k$i=k$h[0];if(k$i.loaded&&k$i.bitmap&&k$i.source){k$X.drawCall++;var k$j=1!==k$f;if(k$j){var k$k=this.globalAlpha;this.globalAlpha*=k$f}var k$l=k$i.uv,k$m=k$i.bitmap.width,k$n=k$i.bitmap.height;k$e?(this.save(),this.transform(k$e.a,k$e.b,k$e.c,k$e.d,k$e.tx+k$a,k$e.ty+k$b),this.drawImage(k$i.source,k$l[0]*k$m,k$l[1]*k$n,(k$l[2]-k$l[0])*k$m,(k$l[5]-k$l[3])*k$n,k$h[1]-k$c,k$h[2]-k$d,k$h[3],k$h[4]),this.restore()):this.drawImage(k$i.source,k$l[0]*k$m,k$l[1]*k$n,(k$l[2]-k$l[0])*k$m,(k$l[5]-k$l[3])*k$n,k$h[1]-k$c+k$a,k$h[2]-k$d+k$b,k$h[3],k$h[4]),k$j&&(this.globalAlpha=k$k)}},k$a.fillTexture=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){if(!k$h.pat){if(k$a.uv!=k$ka.DEF_UV){var k$i=new k$ta("2D");k$i.getContext("2d"),k$i.size(k$a.width,k$a.height),k$i.context.drawTexture(k$a,0,0,k$a.width,k$a.height,0,0),k$a=new k$ka(k$i)}k$h.pat=this.createPattern(k$a.bitmap.source,k$f)}var k$j=k$b,k$k=k$c,k$l=0,k$m=0;k$g&&(k$j+=k$g.x%k$a.width,k$k+=k$g.y%k$a.height,k$l-=k$g.x%k$a.width,k$m-=k$g.y%k$a.height),this.translate(k$j,k$k),this.fillRect(k$l,k$m,k$d,k$e,k$h.pat),this.translate(-k$j,-k$k)},k$a.drawTriangle=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){var k$i=k$a.bitmap,k$j=k$i.source,k$k=k$a.width,k$l=k$a.height,k$m=k$i.width,k$n=k$i.height,k$o=k$c[k$d]*k$m,k$p=k$c[k$e]*k$m,k$q=k$c[k$f]*k$m,k$r=k$c[k$d+1]*k$n,k$s=k$c[k$e+1]*k$n,k$t=k$c[k$f+1]*k$n,k$w=k$b[k$d],k$x=k$b[k$e],k$y=k$b[k$f],k$z=k$b[k$d+1],k$A=k$b[k$e+1],k$B=k$b[k$f+1];if(k$h){var k$C=(k$w+k$x+k$y)/3,k$D=(k$z+k$A+k$B)/3,k$E=k$w-k$C,k$F=k$z-k$D,k$G=Math.sqrt(k$E*k$E+k$F*k$F);k$w=k$C+k$E/k$G*(k$G+1),k$z=k$D+k$F/k$G*(k$G+1),k$F=k$A-k$D,k$x=k$C+(k$E=k$x-k$C)/(k$G=Math.sqrt(k$E*k$E+k$F*k$F))*(k$G+1),k$A=k$D+k$F/k$G*(k$G+1),k$F=k$B-k$D,k$y=k$C+(k$E=k$y-k$C)/(k$G=Math.sqrt(k$E*k$E+k$F*k$F))*(k$G+1),k$B=k$D+k$F/k$G*(k$G+1)}this.save(),k$g&&this.transform(k$g.a,k$g.b,k$g.c,k$g.d,k$g.tx,k$g.ty),this.beginPath(),this.moveTo(k$w,k$z),this.lineTo(k$x,k$A),this.lineTo(k$y,k$B),this.closePath(),this.clip();var k$H=1/(k$o*k$s+k$r*k$q+k$p*k$t-k$s*k$q-k$r*k$p-k$o*k$t),k$I=k$w*k$s+k$r*k$y+k$x*k$t-k$s*k$y-k$r*k$x-k$w*k$t,k$J=k$o*k$x+k$w*k$q+k$p*k$y-k$x*k$q-k$w*k$p-k$o*k$y,k$K=k$o*k$s*k$y+k$r*k$x*k$q+k$w*k$p*k$t-k$w*k$s*k$q-k$r*k$p*k$y-k$o*k$x*k$t,k$L=k$z*k$s+k$r*k$B+k$A*k$t-k$s*k$B-k$r*k$A-k$z*k$t,k$M=k$o*k$A+k$z*k$q+k$p*k$B-k$A*k$q-k$z*k$p-k$o*k$B,k$N=k$o*k$s*k$B+k$r*k$A*k$q+k$z*k$p*k$t-k$z*k$s*k$q-k$r*k$p*k$B-k$o*k$A*k$t;this.transform(k$I*k$H,k$L*k$H,k$J*k$H,k$M*k$H,k$K*k$H,k$N*k$H),this.drawImage(k$j,k$a.uv[0]*k$m,k$a.uv[1]*k$n,k$k,k$l,k$a.uv[0]*k$m,k$a.uv[1]*k$n,k$k,k$l),this.restore()},k$a.flush=function(){return 0},k$a.fillWords=function(k$a,k$b,k$c,k$d,k$e,k$f){k$d&&(this.font=k$d),k$e&&(this.fillStyle=k$e);this.textBaseline="top",this.textAlign="left";for(var k$g=0,k$h=k$a.length;k$g<k$h;k$g++){var k$i=k$a[k$g];if(this.__fillText(k$i.char,k$i.x+k$b,k$i.y+k$c),1===k$f){var k$j=k$i.height,k$k=.5*k$i.style.letterSpacing;k$k||(k$k=0),this.beginPath(),this.strokeStyle=k$e,this.lineWidth=1,this.moveTo(k$b+k$i.x-k$k+.5,k$c+k$i.y+k$j+.5),this.lineTo(k$b+k$i.x+k$i.width+k$k+.5,k$c+k$i.y+k$j+.5),this.stroke()}}},k$a.fillBorderWords=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){k$d&&(this.font=k$d),k$e&&(this.fillStyle=k$e),this.textBaseline="top",this.lineWidth=k$g,this.textAlign="left",this.strokeStyle=k$f;for(var k$h=0,k$i=k$a.length;k$h<k$i;k$h++){var k$j=k$a[k$h];this.__strokeText(k$j.char,k$j.x+k$b,k$j.y+k$c),this.__fillText(k$j.char,k$j.x+k$b,k$j.y+k$c)}},k$a.destroy=function(){this.canvas.width=this.canvas.height=0},k$a.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},k$a.drawCurves=function(k$a,k$b,k$c){this.beginPath(),this.strokeStyle=k$c[3],this.lineWidth=k$c[4];var k$d=k$c[2];k$a+=k$c[0],k$b+=k$c[1],this.moveTo(k$a+k$d[0],k$b+k$d[1]);for(var k$e=2,k$f=k$d.length;k$e<k$f;)this.quadraticCurveTo(k$a+k$d[k$e++],k$b+k$d[k$e++],k$a+k$d[k$e++],k$b+k$d[k$e++]);this.stroke()},k$h.__init__=function(k$b){var k$c=laya.resource.Context.prototype;if(!(k$b=k$b||CanvasRenderingContext2D.prototype).inited){k$b.inited=!0,k$b.__fillText=k$b.fillText,k$b.__fillRect=k$b.fillRect,k$b.__strokeText=k$b.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(k$a){k$b[k$a]=k$c[k$a]})}},k$h.replaceCanvasGetSet=function(k$a,k$b){var k$c=Object.getOwnPropertyDescriptor(k$a,k$b);if(!k$c||!k$c.configurable)return!1;var k$d,k$e={};for(k$d in k$c)"set"!=k$d&&(k$e[k$d]=k$c[k$d]);var k$f=k$c.set;return k$e.set=function(k$a){k$f.call(this,k$a);var k$b=this.getContext("2d");k$b&&"__reset"in k$b&&k$b.__reset()},Object.defineProperty(k$a,k$b,k$e),!0},k$h.replaceGetSet=function(k$a,k$b){var k$c=Object.getOwnPropertyDescriptor(k$a,k$b);if(!k$c||!k$c.configurable)return!1;var k$d,k$e={};for(k$d in k$c)"set"!=k$d&&(k$e[k$d]=k$c[k$d]);var k$f=k$c.set,k$g="___"+k$b+"__";return k$h.newKeys.push(k$g),k$e.set=function(k$a){k$a!=this[k$g]&&(this[k$g]=k$a,k$f.call(this,k$a))},Object.defineProperty(k$a,k$b,k$e),!0},k$h._default=new k$h,k$h.newKeys=[],k$i(k$h,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),k$h}(),k$N=function(){function k$f(k$a){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++k$f._uniqueIDCounter,this._name=k$a||"Content Manager",k$f._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,k$f._resourceManagers.push(this),this._resources=[],this._records={}}k$k(k$f,"laya.resource.ResourceManager");var k$a=k$f.prototype;return k$z.imps(k$a,{"laya.resource.IDispose":!0}),k$a.getResourceByIndex=function(k$a){return this._resources[k$a]},k$a.getResourcesLength=function(){return this._resources.length},k$a.addResource=function(k$a){return k$a.resourceManager&&k$a.resourceManager.removeResource(k$a),-1===this._resources.indexOf(k$a)&&((k$a._resourceManager=this)._resources.push(k$a),this.addRecord(k$a.uri,k$a.__className,k$a.memorySize),this.addSize(k$a.memorySize),!0)},k$a.removeResource=function(k$a){var k$b=this._resources.indexOf(k$a);return-1!==k$b&&(this._resources.splice(k$b,1),k$a._resourceManager=null,this._memorySize-=k$a.memorySize,this.addRecord(k$a.uri,k$a.__className,-k$a.memorySize),!0)},k$a.unload=function(){for(var k$a=this._resources.slice(0,this._resources.length),k$b=0;k$b<k$a.length;k$b++){k$a[k$b].destroy()}k$a.length=0},k$a.dispose=function(){if(this===k$f._systemResourceManager)throw new Error("systemResourceManager不能被释放！");k$f._resourceManagers.splice(k$f._resourceManagers.indexOf(this),1),k$f._isResourceManagersSorted=!1;for(var k$a=this._resources.slice(0,this._resources.length),k$b=0;k$b<k$a.length;k$b++){var k$c=k$a[k$b];k$c.resourceManager.removeResource(k$c),k$c.destroy()}k$a.length=0},k$a.addSize=function(k$a){k$a&&(this.autoRelease&&0<k$a&&this._memorySize+k$a>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=k$a)},k$a.addRecord=function(k$a,k$b,k$c){DEBUG&&k$c&&!k$a&&console.error(k$a,k$b,k$c),k$a&&(this._records.hasOwnProperty(k$b+"|"+k$a)||(this._records[k$b+"|"+k$a]=0),this._records[k$b+"|"+k$a]+=k$c,DEBUG&&this._records[k$b+"|"+k$a]<0&&console.error(k$a,k$b,this._records[k$b+"|"+k$a]))},k$a.garbageCollection=function(k$a){var k$b=this._resources;(k$b=k$b.slice()).sort(function(k$a,k$b){if(!k$a||!k$b)throw new Error("a或b不能为空！");return k$a.released&&k$b.released?0:k$a.released?1:k$b.released?-1:k$a._lastUseFrameCount-k$b._lastUseFrameCount});for(var k$c=k$X.loopCount,k$d=0,k$e=k$b.length;k$d<k$e;k$d++){var k$f=k$b[k$d];if(!(1<k$c-k$f._lastUseFrameCount))return void(this._memorySize>=k$a&&(this._isOverflow=!0));if(k$f.releaseResource(),this._memorySize<k$a)return void(this._isOverflow=!1)}},k$o(0,k$a,"id",function(){return this._id}),k$o(0,k$a,"name",function(){return this._name},function(k$a){!k$a&&""===k$a||this._name===k$a||(this._name=k$a,k$f._isResourceManagersSorted=!1)}),k$o(0,k$a,"memorySize",function(){return this._memorySize}),k$o(0,k$a,"records",function(){return this._records}),k$o(1,k$f,"systemResourceManager",function(){return k$f._systemResourceManager}),k$f.__init__=function(){k$f.currentResourceManager=k$f.systemResourceManager},k$f.getLoadedResourceManagerByIndex=function(k$a){return k$f._resourceManagers[k$a]},k$f.getLoadedResourceManagersCount=function(){return k$f._resourceManagers.length},k$f.recreateContentManagers=function(k$a){void 0===k$a&&(k$a=!1);for(var k$b=k$f.currentResourceManager,k$c=0;k$c<k$f._resourceManagers.length;k$c++){k$f.currentResourceManager=k$f._resourceManagers[k$c];for(var k$d=0;k$d<k$f.currentResourceManager._resources.length;k$d++)k$f.currentResourceManager._resources[k$d].releaseResource(k$a),k$f.currentResourceManager._resources[k$d].activeResource(k$a)}k$f.currentResourceManager=k$b},k$f.releaseContentManagers=function(k$a){void 0===k$a&&(k$a=!1);for(var k$b=k$f.currentResourceManager,k$c=0;k$c<k$f._resourceManagers.length;k$c++){k$f.currentResourceManager=k$f._resourceManagers[k$c];for(var k$d=0;k$d<k$f.currentResourceManager._resources.length;k$d++){var k$e=k$f.currentResourceManager._resources[k$d];!k$e.released&&k$e.releaseResource(k$a)}}k$f.currentResourceManager=k$b},k$f._uniqueIDCounter=0,k$f._isResourceManagersSorted=!1,k$f._resourceManagers=[],k$i(k$f,["_systemResourceManager",function(){return this._systemResourceManager=new k$f("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=k$f._systemResourceManager}]),k$f}(),k$O=(function(){function k$a(){}k$k(k$a,"laya.system.System"),k$a.changeDefinition=function(k$a,k$b){k$z[k$a]=k$b;var k$c=k$a+"=classObj";k$z._runScript(k$c)},k$a.__init__=function(){k$J.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function k$c(){}return k$k(k$c,"laya.utils.Browser"),k$o(1,k$c,"pixelRatio",function(){return k$c.__init__(),-1<k$c.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:k$F.getPixelRatio()}),k$o(1,k$c,"height",function(){return k$c.__init__(),(k$z.stage&&k$z.stage.canvasRotation?k$c.clientWidth:k$c.clientHeight)*k$c.pixelRatio}),k$o(1,k$c,"clientWidth",function(){return k$c.__init__(),k$c.window.innerWidth||k$c.document.body.clientWidth}),k$o(1,k$c,"window",function(){return k$c.__init__(),k$c._window}),k$o(1,k$c,"clientHeight",function(){return k$c.__init__(),k$c.window.innerHeight||k$c.document.body.clientHeight||k$c.document.documentElement.clientHeight}),k$o(1,k$c,"width",function(){return k$c.__init__(),(k$z.stage&&k$z.stage.canvasRotation?k$c.clientHeight:k$c.clientWidth)*k$c.pixelRatio}),k$o(1,k$c,"container",function(){return k$c.__init__(),k$c._container||((k$c._container=k$c.createElement("div")).id="layaContainer",k$c.document.body.appendChild(k$c._container)),k$c._container},function(k$a){k$c._container=k$a}),k$o(1,k$c,"document",function(){return k$c.__init__(),k$c._document}),k$c.__init__=function(){if(!k$c._window){k$c._window=k$F.getWindow(),k$c._document=k$c.window.document,k$c._window.addEventListener("message",function(k$a){laya.utils.Browser._onMessage(k$a)},!1),k$c.document.__createElement=k$c.document.createElement,k$g.requestAnimationFrame=k$g.requestAnimationFrame||k$g.webkitRequestAnimationFrame||k$g.mozRequestAnimationFrame||k$g.oRequestAnimationFrame||k$g.msRequestAnimationFrame||function(k$a){return k$g.setTimeout(k$a,1e3/60)};var k$a=k$g.document.body.style;k$a["-webkit-user-select"]="none",k$a["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",k$c.userAgent=k$c.window.navigator.userAgent,k$c.onIOS=!!(k$c.u=k$c.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),k$c.onMobile=-1<k$c.u.indexOf("Mobile"),k$c.onIPhone=-1<k$c.u.indexOf("iPhone"),k$c.onMac=-1<k$c.u.indexOf("Mac OS X"),k$c.onIPad=-1<k$c.u.indexOf("iPad"),k$c.onAndroid=-1<k$c.u.indexOf("Android")||-1<k$c.u.indexOf("Adr"),k$c.onWP=-1<k$c.u.indexOf("Windows Phone"),k$c.onQQBrowser=-1<k$c.u.indexOf("QQBrowser"),k$c.onMQQBrowser=-1<k$c.u.indexOf("MQQBrowser")||-1<k$c.u.indexOf("Mobile")&&-1<k$c.u.indexOf("QQ"),k$c.onIE=!!k$c.window.ActiveXObject||"ActiveXObject"in k$c.window,k$c.onWeiXin=-1<k$c.u.indexOf("MicroMessenger"),k$c.onPC=!k$c.onMobile,k$c.onSafari=-1<k$c.u.indexOf("Safari"),k$c.onFirefox=-1<k$c.u.indexOf("Firefox"),k$c.onEdge=-1<k$c.u.indexOf("Edge"),k$c.onMiniGame=-1<k$c.u.indexOf("MiniGame"),k$c.onLimixiu=-1<k$c.u.indexOf("limixiu"),k$c.httpProtocol="http:"==k$c.window.location.protocol,k$c.onMiniGame&&null==k$c.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),k$c.webAudioEnabled=!!(k$c.window.AudioContext||k$c.window.webkitAudioContext||k$c.window.mozAudioContext),k$c.soundType=k$c.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",k$ea=k$c.webAudioEnabled?k$fa:k$ca,k$c.webAudioEnabled&&k$fa.initWebAudio(),k$ca._initMusicAudio(),k$c.enableTouch="ontouchstart"in k$g||k$g.DocumentTouch&&k$b instanceof DocumentTouch,k$g.focus(),k$E._soundClass=k$ea,k$E._musicClass=k$ca,k$J._mainCanvas=k$J._mainCanvas||k$ta.create("2D"),k$c.canvas||(k$c.canvas=k$ta.create("2D"),k$c.context=k$c.canvas.getContext("2d"))}},k$c._onMessage=function(k$a){if(k$a.data&&"size"==k$a.data.name){if(k$c.window.innerWidth=k$a.data.width,k$c.window.innerHeight=k$a.data.height,k$c.window.__innerHeight=k$a.data.clientHeight,!k$c.document.createEvent)return void console.warn("no document.createEvent");var k$b=k$c.document.createEvent("HTMLEvents");return k$b.initEvent("resize",!1,!1),void k$c.window.dispatchEvent(k$b)}},k$c.createElement=function(k$a){return k$c.__init__(),k$c.document.__createElement(k$a)},k$c.getElementById=function(k$a){return k$c.__init__(),k$c.document.getElementById(k$a)},k$c.removeElement=function(k$a){k$a&&k$a.parentNode&&k$a.parentNode.removeChild(k$a)},k$c.now=function(){return k$F.now()},k$c._window=null,k$c._document=null,k$c._container=null,k$c.userAgent=null,k$c.u=null,k$c.onIOS=!1,k$c.onMac=!1,k$c.onMobile=!1,k$c.onIPhone=!1,k$c.onIPad=!1,k$c.onAndroid=!1,k$c.onWP=!1,k$c.onQQBrowser=!1,k$c.onMQQBrowser=!1,k$c.onSafari=!1,k$c.onFirefox=!1,k$c.onEdge=!1,k$c.onIE=!1,k$c.onWeiXin=!1,k$c.onMiniGame=!1,k$c.onLimixiu=!1,k$c.onPC=!1,k$c.httpProtocol=!1,k$c.webAudioEnabled=!1,k$c.soundType=null,k$c.enableTouch=!1,k$c.canvas=null,k$c.context=null,k$c.__init$=function(){},k$c}()),k$P=function(){function k$b(k$a){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,k$a?(this._u8d_=new Uint8Array(k$a),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}k$k(k$b,"laya.utils.Byte");var k$a=k$b.prototype;return k$a.___resizeBuffer=function(k$b){try{var k$a=new Uint8Array(k$b);null!=this._u8d_&&(this._u8d_.length<=k$b?k$a.set(this._u8d_):k$a.set(this._u8d_.subarray(0,k$b))),this._u8d_=k$a,this._d_=new DataView(k$a.buffer)}catch(k$a){throw"___resizeBuffer err:"+k$b}},k$a.getString=function(){return this.rUTF(this.getUint16())},k$a.getFloat32Array=function(k$a,k$b){var k$c=k$a+k$b;k$c=k$c>this._length?this._length:k$c;var k$d=new Float32Array(this._d_.buffer.slice(k$a,k$c));return this._pos_=k$c,k$d},k$a.getUint8Array=function(k$a,k$b){var k$c=k$a+k$b;k$c=k$c>this._length?this._length:k$c;var k$d=new Uint8Array(this._d_.buffer.slice(k$a,k$c));return this._pos_=k$c,k$d},k$a.getInt16Array=function(k$a,k$b){var k$c=k$a+k$b;k$c=k$c>this._length?this._length:k$c;var k$d=new Int16Array(this._d_.buffer.slice(k$a,k$c));return this._pos_=k$c,k$d},k$a.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var k$a=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,k$a},k$a.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var k$a=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,k$a},k$a.writeFloat32=function(k$a){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,k$a,this._xd_),this._pos_+=4},k$a.writeFloat64=function(k$a){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,k$a,this._xd_),this._pos_+=8},k$a.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var k$a=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,k$a},k$a.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var k$a=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,k$a},k$a.writeInt32=function(k$a){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,k$a,this._xd_),this._pos_+=4},k$a.writeUint32=function(k$a){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,k$a,this._xd_),this._pos_+=4},k$a.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var k$a=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,k$a},k$a.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var k$a=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,k$a},k$a.writeUint16=function(k$a){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,k$a,this._xd_),this._pos_+=2},k$a.writeInt16=function(k$a){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,k$a,this._xd_),this._pos_+=2},k$a.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},k$a.writeUint8=function(k$a){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,k$a),this._pos_++},k$a._getUInt8=function(k$a){return this._d_.getUint8(k$a)},k$a._getUint16=function(k$a){return this._d_.getUint16(k$a,this._xd_)},k$a._getMatrix=function(){return new k$G(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},k$a.rUTF=function(k$a){for(var k$b=[],k$c=this._pos_+k$a,k$d=0,k$e=0,k$f=0,k$g=String.fromCharCode,k$h=this._u8d_;this._pos_<k$c;)(k$d=k$h[this._pos_++])<128?0!=k$d&&k$b.push(k$g(k$d)):k$d<224?k$b.push(k$g((63&k$d)<<6|127&k$h[this._pos_++])):k$d<240?(k$e=k$h[this._pos_++],k$b.push(k$g((31&k$d)<<12|(127&k$e)<<6|127&k$h[this._pos_++]))):(k$e=k$h[this._pos_++],k$f=k$h[this._pos_++],k$b.push(k$g((15&k$d)<<18|(127&k$e)<<12|k$f<<6&127|127&k$h[this._pos_++]))),0;return k$b.join("")},k$a.getCustomString=function(k$a){for(var k$b=[],k$c=0,k$d=0,k$e=0,k$f=String.fromCharCode,k$g=this._u8d_;0<k$a;)if((k$d=k$g[this._pos_])<128)k$b.push(k$f(k$d)),this._pos_++,k$a--;else for(k$c=k$d-128,this._pos_++,k$a-=k$c;0<k$c;)k$d=k$g[this._pos_++],k$e=k$g[this._pos_++],k$b.push(k$f(k$e<<8|k$d)),k$c--;return k$b.join("")},k$a.clear=function(){this._pos_=0,this.length=0},k$a.__getBuffer=function(){return this._d_.buffer},k$a.writeUTFBytes=function(k$a){for(var k$b=0,k$c=(k$a+="").length;k$b<k$c;k$b++){var k$d=k$a.charCodeAt(k$b);k$d<=127?this.writeByte(k$d):k$d<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|k$d>>6,128|63&k$d],this._pos_),this._pos_+=2):k$d<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|k$d>>12,128|k$d>>6&63,128|63&k$d],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|k$d>>18,128|k$d>>12&63,128|k$d>>6&63,128|63&k$d],this._pos_),this._pos_+=4)}},k$a.writeUTFString=function(k$a){var k$b=this.pos;this.writeUint16(1),this.writeUTFBytes(k$a);var k$c=this.pos-k$b-2;if(65536<=k$c)throw"writeUTFString byte len more than 65536";this._d_.setUint16(k$b,k$c,this._xd_)},k$a.readUTFString=function(){return this.readUTFBytes(this.getUint16())},k$a.getUTFString=function(){return this.readUTFString()},k$a.readUTFBytes=function(k$a){if(void 0===k$a&&(k$a=-1),0==k$a)return"";var k$b=this.bytesAvailable;if(k$b<k$a)throw"readUTFBytes error - Out of bounds";return k$a=0<k$a?k$a:k$b,this.rUTF(k$a)},k$a.getUTFBytes=function(k$a){return void 0===k$a&&(k$a=-1),this.readUTFBytes(k$a)},k$a.writeByte=function(k$a){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,k$a),this._pos_+=1},k$a.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},k$a.getByte=function(){return this.readByte()},k$a.ensureWrite=function(k$a){this._length<k$a&&(this._length=k$a),this._allocated_<k$a&&(this.length=k$a)},k$a.writeArrayBuffer=function(k$a,k$b,k$c){if(void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),k$b<0||k$c<0)throw"writeArrayBuffer error - Out of bounds";0==k$c&&(k$c=k$a.byteLength-k$b),this.ensureWrite(this._pos_+k$c);var k$d=new Uint8Array(k$a);this._u8d_.set(k$d.subarray(k$b,k$b+k$c),this._pos_),this._pos_+=k$c},k$o(0,k$a,"buffer",function(){var k$a=this._d_.buffer;return k$a.byteLength==this.length?k$a:k$a.slice(0,this.length)}),k$o(0,k$a,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(k$a){this._xd_="littleEndian"==k$a}),k$o(0,k$a,"length",function(){return this._length},function(k$a){this._allocated_<k$a?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(k$a,2*this._allocated_))):this._allocated_>k$a&&this.___resizeBuffer(this._allocated_=k$a),this._length=k$a}),k$o(0,k$a,"pos",function(){return this._pos_},function(k$a){this._pos_=k$a}),k$o(0,k$a,"bytesAvailable",function(){return this._length-this._pos_}),k$b.getSystemEndian=function(){if(!k$b._sysEndian){var k$a=new ArrayBuffer(2);new DataView(k$a).setInt16(0,256,!0),k$b._sysEndian=256===new Int16Array(k$a)[0]?"littleEndian":"bigEndian"}return k$b._sysEndian},k$b.BIG_ENDIAN="bigEndian",k$b.LITTLE_ENDIAN="littleEndian",k$b._sysEndian=null,k$b}(),k$Q=function(){function k$e(){}return k$k(k$e,"laya.utils.CacheManager"),k$e.regCacheByFunction=function(k$a,k$b){var k$c;k$e.unRegCacheByFunction(k$a,k$b),k$c={tryDispose:k$a,getCacheList:k$b},k$e._cacheList.push(k$c)},k$e.unRegCacheByFunction=function(k$a,k$b){var k$c,k$d=0;for(k$c=k$e._cacheList.length,k$d=0;k$d<k$c;k$d++)if(k$e._cacheList[k$d].tryDispose==k$a&&k$e._cacheList[k$d].getCacheList==k$b)return void k$e._cacheList.splice(k$d,1)},k$e.forceDispose=function(){var k$a=0,k$b=k$e._cacheList.length;for(k$a=0;k$a<k$b;k$a++)k$e._cacheList[k$a].tryDispose(!0)},k$e.beginCheck=function(k$a){void 0===k$a&&(k$a=15e3),k$z.timer.loop(k$a,null,k$e._checkLoop)},k$e.stopCheck=function(){k$z.timer.clear(null,k$e._checkLoop)},k$e._checkLoop=function(){var k$a=k$e._cacheList;if(!(k$a.length<1)){var k$b,k$c=k$O.now(),k$d=0;for(k$b=k$d=k$a.length;0<k$d&&(k$a[k$e._index=++k$e._index%k$b].tryDispose(!1),!(k$O.now()-k$c>k$e.loopTimeLimit));)k$d--}},k$e.loopTimeLimit=2,k$e._cacheList=[],k$e._index=0,k$e}(),k$R=function(){function k$n(){}return k$k(k$n,"laya.utils.ClassUtils"),k$n.regClass=function(k$a,k$b){k$n._classMap[k$a]=k$b},k$n.getRegClass=function(k$a){return k$n._classMap[k$a]},k$n.getInstance=function(k$a){var k$b=k$n.getClass(k$a);return k$b?new k$b:(console.warn("[error] Undefined class:",k$a),null)},k$n.createByJson=function(k$a,k$b,k$c,k$d,k$e){"string"==typeof k$a&&(k$a=JSON.parse(k$a));var k$f=k$a.props;if(!k$b&&!(k$b=k$e?k$e.runWith(k$a):k$n.getInstance(k$f.runtime||k$a.type)))return null;var k$g=k$a.child;if(k$g)for(var k$h=0,k$i=k$g.length;k$h<k$i;k$h++){var k$j=k$g[k$h];if("render"!==k$j.props.name&&"render"!==k$j.props.renderType||!k$b._$set_itemRender)if("Graphic"==k$j.type)k$n.addGraphicsToSprite(k$j,k$b);else if(k$n.isDrawType(k$j.type))k$n.addGraphicToSprite(k$j,k$b,!0);else{var k$k=k$n.createByJson(k$j,null,k$c,k$d,k$e);"Script"==k$j.type?k$k.hasOwnProperty("owner")?k$k.owner=k$b:k$k.hasOwnProperty("target")&&(k$k.target=k$b):"mask"==k$j.props.renderType?k$b.mask=k$k:k$b.addChild(k$k)}else k$b.itemRender=k$j}if(k$f)for(var k$l in k$f){var k$m=k$f[k$l];"var"===k$l&&k$c?k$c[k$m]=k$b:k$m instanceof Array&&"function"==typeof k$b[k$l]?k$b[k$l].apply(k$b,k$m):k$b[k$l]=k$m}return k$d&&k$a.customProps&&k$d.runWith([k$b,k$a]),k$b.created&&k$b.created(),k$b},k$n.addGraphicsToSprite=function(k$a,k$b){var k$c;if((k$c=k$a.child)&&!(k$c.length<1)){var k$d;k$d=k$n._getGraphicsFromSprite(k$a,k$b);var k$e=0,k$f=0;k$a.props&&(k$e=k$n._getObjVar(k$a.props,"x",0),k$f=k$n._getObjVar(k$a.props,"y",0)),0!=k$e&&0!=k$f&&k$d.translate(k$e,k$f);var k$g,k$h=0;for(k$g=k$c.length,k$h=0;k$h<k$g;k$h++)k$n._addGraphicToGraphics(k$c[k$h],k$d);0!=k$e&&0!=k$f&&k$d.translate(-k$e,-k$f)}},k$n.addGraphicToSprite=function(k$a,k$b,k$c){var k$d;void 0===k$c&&(k$c=!1),k$d=k$c?k$n._getGraphicsFromSprite(k$a,k$b):k$b.graphics,k$n._addGraphicToGraphics(k$a,k$d)},k$n._getGraphicsFromSprite=function(k$a,k$b){var k$c,k$d;if(!k$a||!k$a.props)return k$b.graphics;switch(k$d=k$a.props.renderType){case"hit":case"unHit":var k$e;k$b.hitArea||(k$b.hitArea=new k$V),(k$e=k$b.hitArea)[k$d]||(k$e[k$d]=new k$m),k$c=k$e[k$d]}return k$c||(k$c=k$b.graphics),k$c},k$n._getTransformData=function(k$a){var k$b;(k$a.hasOwnProperty("pivotX")||k$a.hasOwnProperty("pivotY"))&&(k$b=k$b||new k$G).translate(-k$n._getObjVar(k$a,"pivotX",0),-k$n._getObjVar(k$a,"pivotY",0));var k$c=k$n._getObjVar(k$a,"scaleX",1),k$d=k$n._getObjVar(k$a,"scaleY",1),k$e=k$n._getObjVar(k$a,"rotation",0);k$n._getObjVar(k$a,"skewX",0),k$n._getObjVar(k$a,"skewY",0);return 1==k$c&&1==k$d&&0==k$e||((k$b=k$b||new k$G).scale(k$c,k$d),k$b.rotate(.0174532922222222*k$e)),k$b},k$n._addGraphicToGraphics=function(k$a,k$b){var k$c,k$d;if((k$c=k$a.props)&&(k$d=k$n.DrawTypeDic[k$a.type])){var k$e,k$f;k$e=k$b;var k$g=k$n._getParams(k$c,k$d[1],k$d[2],k$d[3]);((k$f=k$n._tM)||1!=k$n._alpha)&&(k$e.save(),k$f&&k$e.transform(k$f),1!=k$n._alpha&&k$e.alpha(k$n._alpha)),k$e[k$d[0]].apply(k$e,k$g),(k$f||1!=k$n._alpha)&&k$e.restore()}},k$n._adptLineData=function(k$a){return k$a[2]=parseFloat(k$a[0])+parseFloat(k$a[2]),k$a[3]=parseFloat(k$a[1])+parseFloat(k$a[3]),k$a},k$n._adptTextureData=function(k$a){return k$a[0]=k$ha.getRes(k$a[0]),k$a},k$n._adptLinesData=function(k$a){return k$a[2]=k$n._getPointListByStr(k$a[2]),k$a},k$n.isDrawType=function(k$a){return"Image"!=k$a&&k$n.DrawTypeDic.hasOwnProperty(k$a)},k$n._getParams=function(k$a,k$b,k$c,k$d){var k$e;void 0===k$c&&(k$c=0),(k$e=k$n._temParam).length=k$b.length;var k$f,k$g,k$h=0;for(k$f=k$b.length,k$h=0;k$h<k$f;k$h++)k$e[k$h]=k$n._getObjVar(k$a,k$b[k$h][0],k$b[k$h][1]);return k$n._alpha=k$n._getObjVar(k$a,"alpha",1),k$g=k$n._getTransformData(k$a),k$n._tM=k$g?(k$c||(k$c=0),k$g.translate(k$e[k$c],k$e[k$c+1]),k$e[k$c]=k$e[k$c+1]=0,k$g):null,k$d&&k$n[k$d]&&(k$e=k$n[k$d](k$e)),k$e},k$n._getPointListByStr=function(k$a){var k$b,k$c,k$d=0;for(k$c=(k$b=k$a.split(",")).length,k$d=0;k$d<k$c;k$d++)k$b[k$d]=parseFloat(k$b[k$d]);return k$b},k$n._getObjVar=function(k$a,k$b,k$c){return k$a.hasOwnProperty(k$b)?k$a[k$b]:k$c},k$n._temParam=[],k$n._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},k$n.getClass=function(k$a){var k$b=k$n._classMap[k$a]||k$a;return"string"==typeof k$b?k$z.__classmap[k$b]:k$b},k$n._tM=null,k$n._alpha=NaN,k$i(k$n,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),k$n}(),k$S=function(){function k$f(k$a){if(this._color=[],"string"==typeof k$a){null===(this.strColor=k$a)&&(k$a="#000000"),"#"==k$a.charAt(0)&&(k$a=k$a.substr(1));var k$b=k$a.length;if(3==k$b||4==k$b){for(var k$c="",k$d=0;k$d<k$b;k$d++)k$c+=k$a[k$d]+k$a[k$d];k$a=k$c}var k$e=this.numColor=parseInt(k$a,16);if(8==k$a.length)return void(this._color=[parseInt(k$a.substr(0,2),16)/255,((16711680&k$e)>>16)/255,((65280&k$e)>>8)/255,(255&k$e)/255])}else k$e=this.numColor=k$a,this.strColor=k$$.toHexColor(k$e);this._color=[((16711680&k$e)>>16)/255,((65280&k$e)>>8)/255,(255&k$e)/255,1],this._color.__id=++k$f._COLODID}return k$k(k$f,"laya.utils.Color"),k$f._initDefault=function(){for(var k$a in k$f._DEFAULT={},k$f._COLOR_MAP)k$f._SAVE[k$a]=k$f._DEFAULT[k$a]=new k$f(k$f._COLOR_MAP[k$a]);return k$f._DEFAULT},k$f._initSaveMap=function(){for(var k$a in k$f._SAVE_SIZE=0,k$f._SAVE={},k$f._DEFAULT)k$f._SAVE[k$a]=k$f._DEFAULT[k$a]},k$f.create=function(k$a){var k$b=k$f._SAVE[k$a+""];return null!=k$b?k$b:(k$f._SAVE_SIZE<1e3||k$f._initSaveMap(),k$f._SAVE[k$a+""]=new k$f(k$a))},k$f._SAVE={},k$f._SAVE_SIZE=0,k$f._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},k$f._DEFAULT=k$f._initDefault(),k$f._COLODID=1,k$f}(),k$T=(function(){function k$a(){this._values=[],this._keys=[]}k$k(k$a,"laya.utils.Dictionary");var k$b=k$a.prototype;k$b.set=function(k$a,k$b){var k$c=this.indexOf(k$a);0<=k$c?this._values[k$c]=k$b:(this._keys.push(k$a),this._values.push(k$b))},k$b.indexOf=function(k$a){var k$b=this._keys.indexOf(k$a);return 0<=k$b?k$b:(k$a="string"==typeof k$a?Number(k$a):"number"==typeof k$a?k$a.toString():k$a,this._keys.indexOf(k$a))},k$b.get=function(k$a){var k$b=this.indexOf(k$a);return k$b<0?null:this._values[k$b]},k$b.remove=function(k$a){var k$b=this.indexOf(k$a);return 0<=k$b&&(this._keys.splice(k$b,1),this._values.splice(k$b,1),!0)},k$b.clear=function(){this._values.length=0,this._keys.length=0},k$o(0,k$b,"values",function(){return this._values}),k$o(0,k$b,"keys",function(){return this._keys})}(),function(){function k$a(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}k$k(k$a,"laya.utils.Dragging");var k$b=k$a.prototype;return k$b.start=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){void 0===k$h&&(k$h=.92),this.clearTimer(),this.target=k$a,this.area=k$b,this.hasInertia=k$c,this.elasticDistance=k$b?k$d:0,this.elasticBackTime=k$e,this.data=k$f,this._disableMouseEvent=k$g,this.ratio=k$h,1!=k$a.globalScaleX||1!=k$a.globalScaleY?this._parent=k$a.parent:this._parent=k$z.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,k$z.stage.on("mouseup",this,this.onStageMouseUp),k$z.stage.on("mouseout",this,this.onStageMouseUp),k$z.timer.frameLoop(1,this,this.loop)},k$b.clearTimer=function(){k$z.timer.clear(this,this.loop),k$z.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},k$b.stop=function(){this._dragging&&(k$p.instance.disableMouseEvent=!1,k$z.stage.off("mouseup",this,this.onStageMouseUp),k$z.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},k$b.loop=function(){var k$a=this._parent.getMousePoint(),k$b=k$a.x,k$c=k$a.y,k$d=k$b-this._lastX,k$e=k$c-this._lastY;if(this._clickOnly){if(!(1<Math.abs(k$d*k$z.stage._canvasTransform.getScaleX())||1<Math.abs(k$e*k$z.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),k$p.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(k$d,k$e);0==k$d&&0==k$e||(this._lastX=k$b,this._lastY=k$c,this.target.x+=k$d*this._elasticRateX,this.target.y+=k$e*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},k$b.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var k$a=this.area.x-this.target.x;else k$a=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-k$a/this.elasticDistance),this.target.y<this.area.y)var k$b=this.area.y-this.target.y;else k$b=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-k$b/this.elasticDistance)}},k$b.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},k$b.onStageMouseUp=function(k$a){if(k$p.instance.disableMouseEvent=!1,k$z.stage.off("mouseup",this,this.onStageMouseUp),k$z.stage.off("mouseout",this,this.onStageMouseUp),k$z.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var k$b=this._offsets.length,k$c=Math.min(k$b,6),k$d=this._offsets.length-k$c,k$e=k$b-1;k$d<k$e;k$e--)this._offsetY+=this._offsets[k$e--],this._offsetX+=this._offsets[k$e];this._offsetX=this._offsetX/k$c*2,this._offsetY=this._offsetY/k$c*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),k$z.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},k$b.checkElastic=function(){var k$a=NaN,k$b=NaN;if(this.target.x<this.area.x?k$a=this.area.x:this.target.x>this.area.x+this.area.width&&(k$a=this.area.x+this.area.width),this.target.y<this.area.y?k$b=this.area.y:this.target.y>this.area.y+this.area.height&&(k$b=this.area.y+this.area.height),isNaN(k$a)&&isNaN(k$b))this.clear();else{var k$c={};isNaN(k$a)||(k$c.x=k$a),isNaN(k$b)||(k$c.y=k$b),this._tween=k$Z.to(this.target,k$c,this.elasticBackTime,k$U.sineOut,k$s.create(this,this.clear),0,!1,!1)}},k$b.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(k$z.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},k$b.clear=function(){if(this.target){this.clearTimer();var k$a=this.target;this.target=null,this._parent=null,k$a.event("dragend",this.data)}},k$a}()),k$U=function(){function k$h(){}return k$k(k$h,"laya.utils.Ease"),k$h.linearNone=function(k$a,k$b,k$c,k$d){return k$c*k$a/k$d+k$b},k$h.linearIn=function(k$a,k$b,k$c,k$d){return k$c*k$a/k$d+k$b},k$h.linearInOut=function(k$a,k$b,k$c,k$d){return k$c*k$a/k$d+k$b},k$h.linearOut=function(k$a,k$b,k$c,k$d){return k$c*k$a/k$d+k$b},k$h.bounceIn=function(k$a,k$b,k$c,k$d){return k$c-k$h.bounceOut(k$d-k$a,0,k$c,k$d)+k$b},k$h.bounceInOut=function(k$a,k$b,k$c,k$d){return k$a<.5*k$d?.5*k$h.bounceIn(2*k$a,0,k$c,k$d)+k$b:.5*k$h.bounceOut(2*k$a-k$d,0,k$c,k$d)+.5*k$c+k$b},k$h.bounceOut=function(k$a,k$b,k$c,k$d){return(k$a/=k$d)<1/2.75?k$c*(7.5625*k$a*k$a)+k$b:k$a<2/2.75?k$c*(7.5625*(k$a-=1.5/2.75)*k$a+.75)+k$b:k$a<2.5/2.75?k$c*(7.5625*(k$a-=2.25/2.75)*k$a+.9375)+k$b:k$c*(7.5625*(k$a-=2.625/2.75)*k$a+.984375)+k$b},k$h.backIn=function(k$a,k$b,k$c,k$d,k$e){return void 0===k$e&&(k$e=1.70158),k$c*(k$a/=k$d)*k$a*((k$e+1)*k$a-k$e)+k$b},k$h.backInOut=function(k$a,k$b,k$c,k$d,k$e){return void 0===k$e&&(k$e=1.70158),(k$a/=.5*k$d)<1?.5*k$c*(k$a*k$a*((1+(k$e*=1.525))*k$a-k$e))+k$b:k$c/2*((k$a-=2)*k$a*((1+(k$e*=1.525))*k$a+k$e)+2)+k$b},k$h.backOut=function(k$a,k$b,k$c,k$d,k$e){return void 0===k$e&&(k$e=1.70158),k$c*((k$a=k$a/k$d-1)*k$a*((k$e+1)*k$a+k$e)+1)+k$b},k$h.elasticIn=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g;return void 0===k$e&&(k$e=0),void 0===k$f&&(k$f=0),0==k$a?k$b:1==(k$a/=k$d)?k$b+k$c:(k$f||(k$f=.3*k$d),k$g=!k$e||0<k$c&&k$e<k$c||k$c<0&&k$e<-k$c?(k$e=k$c,k$f/4):k$f/k$h.PI2*Math.asin(k$c/k$e),-k$e*Math.pow(2,10*(k$a-=1))*Math.sin((k$a*k$d-k$g)*k$h.PI2/k$f)+k$b)},k$h.elasticInOut=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g;return void 0===k$e&&(k$e=0),void 0===k$f&&(k$f=0),0==k$a?k$b:2==(k$a/=.5*k$d)?k$b+k$c:(k$f||(k$f=k$d*(.3*1.5)),k$g=!k$e||0<k$c&&k$e<k$c||k$c<0&&k$e<-k$c?(k$e=k$c,k$f/4):k$f/k$h.PI2*Math.asin(k$c/k$e),k$a<1?k$e*Math.pow(2,10*(k$a-=1))*Math.sin((k$a*k$d-k$g)*k$h.PI2/k$f)*-.5+k$b:k$e*Math.pow(2,-10*(k$a-=1))*Math.sin((k$a*k$d-k$g)*k$h.PI2/k$f)*.5+k$c+k$b)},k$h.elasticOut=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g;return void 0===k$e&&(k$e=0),void 0===k$f&&(k$f=0),0==k$a?k$b:1==(k$a/=k$d)?k$b+k$c:(k$f||(k$f=.3*k$d),k$g=!k$e||0<k$c&&k$e<k$c||k$c<0&&k$e<-k$c?(k$e=k$c,k$f/4):k$f/k$h.PI2*Math.asin(k$c/k$e),k$e*Math.pow(2,-10*k$a)*Math.sin((k$a*k$d-k$g)*k$h.PI2/k$f)+k$c+k$b)},k$h.strongIn=function(k$a,k$b,k$c,k$d){return k$c*(k$a/=k$d)*k$a*k$a*k$a*k$a+k$b},k$h.strongInOut=function(k$a,k$b,k$c,k$d){return(k$a/=.5*k$d)<1?.5*k$c*k$a*k$a*k$a*k$a*k$a+k$b:.5*k$c*((k$a-=2)*k$a*k$a*k$a*k$a+2)+k$b},k$h.strongOut=function(k$a,k$b,k$c,k$d){return k$c*((k$a=k$a/k$d-1)*k$a*k$a*k$a*k$a+1)+k$b},k$h.sineInOut=function(k$a,k$b,k$c,k$d){return.5*-k$c*(Math.cos(Math.PI*k$a/k$d)-1)+k$b},k$h.sineIn=function(k$a,k$b,k$c,k$d){return-k$c*Math.cos(k$a/k$d*k$h.HALF_PI)+k$c+k$b},k$h.sineOut=function(k$a,k$b,k$c,k$d){return k$c*Math.sin(k$a/k$d*k$h.HALF_PI)+k$b},k$h.quintIn=function(k$a,k$b,k$c,k$d){return k$c*(k$a/=k$d)*k$a*k$a*k$a*k$a+k$b},k$h.quintInOut=function(k$a,k$b,k$c,k$d){return(k$a/=.5*k$d)<1?.5*k$c*k$a*k$a*k$a*k$a*k$a+k$b:.5*k$c*((k$a-=2)*k$a*k$a*k$a*k$a+2)+k$b},k$h.quintOut=function(k$a,k$b,k$c,k$d){return k$c*((k$a=k$a/k$d-1)*k$a*k$a*k$a*k$a+1)+k$b},k$h.quartIn=function(k$a,k$b,k$c,k$d){return k$c*(k$a/=k$d)*k$a*k$a*k$a+k$b},k$h.quartInOut=function(k$a,k$b,k$c,k$d){return(k$a/=.5*k$d)<1?.5*k$c*k$a*k$a*k$a*k$a+k$b:.5*-k$c*((k$a-=2)*k$a*k$a*k$a-2)+k$b},k$h.quartOut=function(k$a,k$b,k$c,k$d){return-k$c*((k$a=k$a/k$d-1)*k$a*k$a*k$a-1)+k$b},k$h.cubicIn=function(k$a,k$b,k$c,k$d){return k$c*(k$a/=k$d)*k$a*k$a+k$b},k$h.cubicInOut=function(k$a,k$b,k$c,k$d){return(k$a/=.5*k$d)<1?.5*k$c*k$a*k$a*k$a+k$b:.5*k$c*((k$a-=2)*k$a*k$a+2)+k$b},k$h.cubicOut=function(k$a,k$b,k$c,k$d){return k$c*((k$a=k$a/k$d-1)*k$a*k$a+1)+k$b},k$h.quadIn=function(k$a,k$b,k$c,k$d){return k$c*(k$a/=k$d)*k$a+k$b},k$h.quadInOut=function(k$a,k$b,k$c,k$d){return(k$a/=.5*k$d)<1?.5*k$c*k$a*k$a+k$b:.5*-k$c*(--k$a*(k$a-2)-1)+k$b},k$h.quadOut=function(k$a,k$b,k$c,k$d){return-k$c*(k$a/=k$d)*(k$a-2)+k$b},k$h.expoIn=function(k$a,k$b,k$c,k$d){return 0==k$a?k$b:k$c*Math.pow(2,10*(k$a/k$d-1))+k$b-.001*k$c},k$h.expoInOut=function(k$a,k$b,k$c,k$d){return 0==k$a?k$b:k$a==k$d?k$b+k$c:(k$a/=.5*k$d)<1?.5*k$c*Math.pow(2,10*(k$a-1))+k$b:.5*k$c*(2-Math.pow(2,-10*--k$a))+k$b},k$h.expoOut=function(k$a,k$b,k$c,k$d){return k$a==k$d?k$b+k$c:k$c*(1-Math.pow(2,-10*k$a/k$d))+k$b},k$h.circIn=function(k$a,k$b,k$c,k$d){return-k$c*(Math.sqrt(1-(k$a/=k$d)*k$a)-1)+k$b},k$h.circInOut=function(k$a,k$b,k$c,k$d){return(k$a/=.5*k$d)<1?.5*-k$c*(Math.sqrt(1-k$a*k$a)-1)+k$b:.5*k$c*(Math.sqrt(1-(k$a-=2)*k$a)+1)+k$b},k$h.circOut=function(k$a,k$b,k$c,k$d){return k$c*Math.sqrt(1-(k$a=k$a/k$d-1)*k$a)+k$b},k$h.HALF_PI=.5*Math.PI,k$h.PI2=2*Math.PI,k$h}(),k$V=function(){function k$l(){this._hit=null,this._unHit=null}k$k(k$l,"laya.utils.HitArea");var k$a=k$l.prototype;return k$a.isHit=function(k$a,k$b){return!!k$l.isHitGraphic(k$a,k$b,this.hit)&&!k$l.isHitGraphic(k$a,k$b,this.unHit)},k$a.contains=function(k$a,k$b){return this.isHit(k$a,k$b)},k$o(0,k$a,"hit",function(){return this._hit||(this._hit=new k$m),this._hit},function(k$a){this._hit=k$a}),k$o(0,k$a,"unHit",function(){return this._unHit||(this._unHit=new k$m),this._unHit},function(k$a){this._unHit=k$a}),k$l.isHitGraphic=function(k$a,k$b,k$c){if(!k$c)return!1;var k$d;if(!(k$d=k$c.cmds)&&k$c._one&&((k$d=k$l._cmds).length=1,k$d[0]=k$c._one),!k$d)return!1;var k$e,k$f,k$g=0;for(k$e=k$d.length,k$g=0;k$g<k$e;k$g++)if(k$f=k$d[k$g]){var k$h=k$J._context;switch(k$f.callee){case k$h._translate:case 6:k$a-=k$f[0],k$b-=k$f[1]}if(k$l.isHitCmd(k$a,k$b,k$f))return!0}return!1},k$l.isHitCmd=function(k$a,k$b,k$c){if(!k$c)return!1;var k$d=k$J._context,k$e=!1;switch(k$c.callee){case k$d._drawRect:case 13:k$l._rec.setTo(k$c[0],k$c[1],k$c[2],k$c[3]),k$e=k$l._rec.contains(k$a,k$b);break;case k$d._drawCircle:case k$d._fillCircle:case 14:k$e=(k$a-=k$c[0])*k$a+(k$b-=k$c[1])*k$b<k$c[2]*k$c[2];break;case k$d._drawPoly:case 18:k$a-=k$c[0],k$b-=k$c[1],k$e=k$l.ptInPolygon(k$a,k$b,k$c[2])}return k$e},k$l.ptInPolygon=function(k$a,k$b,k$c){var k$d;(k$d=k$l._ptPoint).setTo(k$a,k$b);var k$e,k$f=0,k$g=NaN,k$h=NaN,k$i=NaN,k$j=NaN;k$e=k$c.length;for(var k$k=0;k$k<k$e;k$k+=2){if(k$g=k$c[k$k],k$h=k$c[k$k+1],k$i=k$c[(k$k+2)%k$e],k$h!=(k$j=k$c[(k$k+3)%k$e]))if(!(k$d.y<Math.min(k$h,k$j)))if(!(k$d.y>=Math.max(k$h,k$j)))(k$d.y-k$h)*(k$i-k$g)/(k$j-k$h)+k$g>k$d.x&&k$f++}return k$f%2==1},k$l._cmds=[],k$i(k$l,["_rec",function(){return this._rec=new k$B},"_ptPoint",function(){return this._ptPoint=new k$A}]),k$l}(),k$W=(function(){function k$e(k$a,k$b,k$c,k$d){this.char=k$a,this.charNum=k$a.charCodeAt(0),this._x=this._y=0,this.width=k$b,this.height=k$c,this.style=k$d,this.isWord=!k$e._isWordRegExp.test(k$a)}k$k(k$e,"laya.utils.HTMLChar");var k$a=k$e.prototype;k$z.imps(k$a,{"laya.display.ILayout":!0}),k$a.setSprite=function(k$a){this._sprite=k$a},k$a.getSprite=function(){return this._sprite},k$a._isChar=function(){return!0},k$a._getCSSStyle=function(){return this.style},k$o(0,k$a,"width",function(){return this._w},function(k$a){this._w=k$a}),k$o(0,k$a,"x",function(){return this._x},function(k$a){this._sprite&&(this._sprite.x=k$a),this._x=k$a}),k$o(0,k$a,"y",function(){return this._y},function(k$a){this._sprite&&(this._sprite.y=k$a),this._y=k$a}),k$o(0,k$a,"height",function(){return this._h},function(k$a){this._h=k$a}),k$e._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function k$b(){}k$k(k$b,"laya.utils.Log"),k$b.enable=function(){k$b._logdiv||(k$b._logdiv=k$O.window.document.createElement("div"),k$O.window.document.body.appendChild(k$b._logdiv),k$b._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},k$b.toggle=function(){var k$a=k$b._logdiv.style;"1px"==k$a.width?k$a.width=k$a.height="50%":k$a.width=k$a.height="1px"},k$b.print=function(k$a){k$b._logdiv&&(k$b.maxCount<=k$b._count&&k$b.clear(),k$b._count++,k$b._logdiv.innerText+=k$a+"\n",k$b._logdiv.scrollTop=k$b._logdiv.scrollHeight)},k$b.clear=function(){k$b._logdiv.innerText="",k$b._count=0},k$b._logdiv=null,k$b._count=0,k$b.maxCount=20}(),function(){function k$b(){}k$k(k$b,"laya.utils.Mouse"),k$o(1,k$b,"cursor",function(){return k$b._style.cursor},function(k$a){k$b._style.cursor=k$a}),k$b.hide=function(){"none"!=k$b.cursor&&(k$b._preCursor=k$b.cursor,k$b.cursor="none")},k$b.show=function(){"none"==k$b.cursor&&(k$b.cursor=k$b._preCursor?k$b._preCursor:"auto")},k$b._preCursor=null,k$i(k$b,["_style",function(){return this._style=k$O.document.body.style}])}(),function(){function k$f(){}return k$k(k$f,"laya.utils.Pool"),k$f.getPoolBySign=function(k$a){return k$f._poolDic[k$a]||(k$f._poolDic[k$a]=[])},k$f.clearBySign=function(k$a){k$f._poolDic[k$a]&&(k$f._poolDic[k$a].length=0)},k$f.recover=function(k$a,k$b){k$b.__InPool||(k$b.__InPool=!0,k$f.getPoolBySign(k$a).push(k$b))},k$f.getItemByClass=function(k$a,k$b){var k$c=k$f.getPoolBySign(k$a),k$d=k$c.length?k$c.pop():new k$b;return k$d.__InPool=!1,k$d},k$f.getItemByCreateFun=function(k$a,k$b,k$c){var k$d=k$f.getPoolBySign(k$a),k$e=k$d.length?k$d.pop():k$b.call(k$c);return k$e.__InPool=!1,k$e},k$f.getItem=function(k$a){var k$b=k$f.getPoolBySign(k$a),k$c=k$b.length?k$b.pop():null;return k$c&&(k$c.__InPool=!1),k$c},k$f._poolDic={},k$f.InPoolSign="__InPool",k$f}()),k$X=function(){function k$i(){}return k$k(k$i,"laya.utils.Stat"),k$o(1,k$i,"onclick",null,function(k$a){k$i._sp&&k$i._sp.on("click",k$i._sp,k$a),k$i._canvas&&(k$i._canvas.source.onclick=k$a,k$i._canvas.source.style.pointerEvents="")}),k$i.show=function(k$a,k$b,k$c){if(void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),!k$J.isConchApp||k$J.isConchWebGL){if(k$J.isConchWebGL||k$O.onMiniGame||k$O.onLimixiu||(k$i._useCanvas=!0),k$i._show=!0,k$i._fpsData.length=60,k$i._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},k$i._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},k$i._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},k$i._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},k$J.isWebGL)if(k$i._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},k$J.is3DMode){if(k$i._view[0].title="FPS(3D)",k$i._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},k$i._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},k$i._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==k$c){var k$d=8;k$i._view[k$d++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},k$i._view[k$d++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},k$i._view[k$d++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},k$i._view[k$d++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},k$i._view[k$d++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},k$i._view[k$d++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},k$i._view[k$d++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},k$i._view[k$d++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},k$i._view[k$d++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==k$c){k$d=8;k$i._view[k$d++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},k$i._view[k$d++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},k$i._view[k$d++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},k$i._view[k$d++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},k$i._view[k$d++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},k$i._view[k$d++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},k$i._view[k$d++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else k$i._view[0].title="FPS(WebGL)",k$i._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else k$i._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};k$i._useCanvas?k$i.createUIPre(k$a,k$b):k$i.createUI(k$a,k$b),k$i.enable()}else k$O.window.conch.showFPS&&k$O.window.conch.showFPS(k$a,k$b)},k$i.createUIPre=function(k$a,k$b){var k$c=k$O.pixelRatio;k$i._width=170*k$c,k$i._vx=75*k$c,k$i._height=k$c*(12*k$i._view.length+3*k$c)+4,k$i._fontSize=12*k$c;for(var k$d=0;k$d<k$i._view.length;k$d++)k$i._view[k$d].x=4,k$i._view[k$d].y=k$d*k$i._fontSize+2*k$c;k$i._canvas||((k$i._canvas=new k$ta("2D")).size(k$i._width,k$i._height),(k$i._ctx=k$i._canvas.getContext("2d")).textBaseline="top",k$i._ctx.font=k$i._fontSize+"px Sans-serif",k$i._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+k$a+"px;top:"+k$b+"px;width:"+k$i._width/k$c+"px;height:"+k$i._height/k$c+"px;"),k$i._first=!0,k$i.loop(),k$i._first=!1,k$O.container.appendChild(k$i._canvas.source)},k$i.createUI=function(k$a,k$b){var k$c=k$i._sp,k$d=k$O.pixelRatio;k$c||(k$c=new k$la,(k$i._leftText=new k$qa).pos(5,5),k$i._leftText.color="#ffffff",k$c.addChild(k$i._leftText),(k$i._txt=new k$qa).pos(80*k$d,5),k$i._txt.color="#ffffff",k$c.addChild(k$i._txt),k$i._sp=k$c),k$c.pos(k$a,k$b);for(var k$e="",k$f=0;k$f<k$i._view.length;k$f++){k$e+=k$i._view[k$f].title+"\n"}k$i._leftText.text=k$e;var k$g=170*k$d,k$h=k$d*(12*k$i._view.length+3*k$d)+4;k$i._txt.fontSize=k$i._fontSize*k$d,k$i._leftText.fontSize=k$i._fontSize*k$d,k$c.size(k$g,k$h),k$c.graphics.clear(),k$c.graphics.setAlpha(.5),k$c.graphics.drawRect(0,0,k$g,k$h,"#999999"),k$c.graphics.setAlpha(1),k$i.loop()},k$i.enable=function(){k$z.timer.frameLoop(1,k$i,k$i.loop)},k$i.hide=function(){k$i._show=!1,k$z.timer.clear(k$i,k$i.loop),k$i._canvas&&k$O.removeElement(k$i._canvas.source)},k$i.clear=function(){k$i.trianglesFaces=k$i.drawCall=k$i.shaderCall=k$i.spriteCount=k$i.spriteRenderUseCacheCount=k$i.treeNodeCollision=k$i.treeSpriteCollision=k$i.canvasNormal=k$i.canvasBitmap=k$i.canvasReCache=0},k$i.loop=function(){k$i._count++;var k$a=k$O.now();if(!(k$a-k$i._timer<1e3)){var k$b=k$i._count;if(k$i.FPS=Math.round(1e3*k$b/(k$a-k$i._timer)),k$i._show){k$i.trianglesFaces=Math.round(k$i.trianglesFaces/k$b),k$i.spriteCount=k$i._useCanvas?(k$i.drawCall=Math.round(k$i.drawCall/k$b)-2,k$i.shaderCall=Math.round(k$i.shaderCall/k$b),Math.round(k$i.spriteCount/k$b)-1):(k$i.drawCall=Math.round(k$i.drawCall/k$b)-2,k$i.shaderCall=Math.round(k$i.shaderCall/k$b)-4,Math.round(k$i.spriteCount/k$b)-4),k$i.spriteRenderUseCacheCount=Math.round(k$i.spriteRenderUseCacheCount/k$b),k$i.canvasNormal=Math.round(k$i.canvasNormal/k$b),k$i.canvasBitmap=Math.round(k$i.canvasBitmap/k$b),k$i.canvasReCache=Math.ceil(k$i.canvasReCache/k$b),k$i.treeNodeCollision=Math.round(k$i.treeNodeCollision/k$b),k$i.treeSpriteCollision=Math.round(k$i.treeSpriteCollision/k$b);var k$c=0<k$i.FPS?Math.floor(1e3/k$i.FPS).toString():" ";k$i._fpsStr=k$i.FPS+(k$i.renderSlow?" slow":"")+" "+k$c,k$i._spriteStr=k$i.spriteCount+(k$i.spriteRenderUseCacheCount?"/"+k$i.spriteRenderUseCacheCount:""),k$i._canvasStr=k$i.canvasReCache+"/"+k$i.canvasNormal+"/"+k$i.canvasBitmap,k$i.currentMemorySize=k$N.systemResourceManager.memorySize,k$i._useCanvas?k$i.renderInfoPre():k$i.renderInfo(),k$i.clear()}k$i._count=0,k$i._timer=k$a}},k$i.renderInfoPre=function(){if(k$i._canvas){var k$a=k$i._ctx;k$a.clearRect(k$i._first?0:k$i._vx,0,k$i._width,k$i._height);for(var k$b=k$J.WebGL.mainContext,k$c=0;k$c<k$i._view.length;k$c++){var k$d=k$i._view[k$c];k$i._first&&(k$a.fillStyle="white",k$a.fillText(k$d.title,k$d.x,k$d.y,null,null,null)),k$a.fillStyle=k$d.color;var k$e=-1;if((k$d=k$i._view[k$c]).varying){if(k$b)switch(k$d.varying){case 1:k$e=k$b.getParameter(k$b[k$d.value]);break;case 2:k$e=k$b.getExtension(k$d.value)}}else k$e=k$i[k$d.value];"M"==k$d.units&&(k$e=Math.floor(k$e/1048576*100)/100+" M"),"K"==k$d.units&&(k$e=Math.floor(k$e/1024*100)/100+" K"),"string"==k$d.units&&(k$e=k$e.match(/\d+\.?\d/i)),k$a.fillText(k$e+"",k$d.x+k$i._vx,k$d.y,null,null,null)}}},k$i.renderInfo=function(){for(var k$a="",k$b=k$J.WebGL.mainContext,k$c=0;k$c<k$i._view.length;k$c++){var k$d=k$i._view[k$c],k$e=-1;if(k$d.varying){if(k$b)switch(k$d.varying){case 1:k$e=k$b.getParameter(k$b[k$d.value]);break;case 2:k$e=k$b.getExtension(k$d.value)}}else k$e=k$i[k$d.value];"M"==k$d.units&&(k$e=Math.floor(k$e/1048576*100)/100+" M"),"K"==k$d.units&&(k$e=Math.floor(k$e/1024*100)/100+" K"),"string"==k$d.units&&(k$e=k$e.match(/\d+\.?\d/i)),k$a+=k$e+"\n"}k$i._txt.text=k$a},k$i.FPS=0,k$i.loopCount=0,k$i.shaderCall=0,k$i.drawCall=0,k$i.trianglesFaces=0,k$i.spriteCount=0,k$i.spriteRenderUseCacheCount=0,k$i.treeNodeCollision=0,k$i.treeSpriteCollision=0,k$i.canvasNormal=0,k$i.canvasBitmap=0,k$i.canvasReCache=0,k$i.renderSlow=!1,k$i.currentMemorySize=0,k$i._fpsStr=null,k$i._canvasStr=null,k$i._spriteStr=null,k$i._fpsData=[],k$i._timer=0,k$i._count=0,k$i._view=[],k$i._fontSize=12,k$i._txt=null,k$i._leftText=null,k$i._sp=null,k$i._show=!1,k$i._useCanvas=!1,k$i._canvas=null,k$i._ctx=null,k$i._first=!1,k$i._vx=NaN,k$i._width=0,k$i._height=100,k$i}(),k$Y=(function(){function k$a(){this._strsToID={},this._idToStrs=[],this._length=0}k$k(k$a,"laya.utils.StringKey");var k$b=k$a.prototype;k$b.add=function(k$a){var k$b=this._strsToID[k$a];return null!=k$b?k$b:(this._idToStrs[this._length]=k$a,this._strsToID[k$a]=this._length++)},k$b.getID=function(k$a){var k$b=this._strsToID[k$a];return null==k$b?-1:k$b},k$b.getName=function(k$a){var k$b=this._idToStrs[k$a];return null==k$b?void 0:k$b}}(),function(){var k$j;function k$a(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}k$k(k$a,"laya.utils.Timer");var k$b=k$a.prototype;return k$b._init=function(){k$z.timer&&k$z.timer.frameLoop(1,this,this._update)},k$b._now=function(){return Date.now()},k$b._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var k$a=this.currFrame=this.currFrame+this.scale,k$b=this._now();this._delta=(k$b-this._lastTimer)*this.scale;var k$c=this.currTimer=this.currTimer+this._delta;k$z.isDebug&&6e4<Math.abs(k$b-this._lastTimer)&&console.error("系统时间错误！"+(k$b-this._lastTimer)),this._lastTimer=k$b;var k$d=this._handlers;for(k$g=this._count=0,k$h=k$d.length;k$g<k$h;k$g++)if(null!==(k$i=k$d[k$g]).method){var k$e=k$i.userFrame?k$a:k$c;if(k$e>=k$i.exeTime)if(k$i.repeat)if(k$i.jumpFrame)for(;k$e>=k$i.exeTime;)k$i.exeTime+=k$i.delay,k$i.run(!1);else k$i.exeTime+=k$i.delay,k$i.run(!1),k$e>k$i.exeTime&&(k$i.exeTime+=Math.ceil((k$e-k$i.exeTime)/k$i.delay)*k$i.delay);else k$i.run(!0)}else this._count++;(30<this._count||k$a%200==0)&&this._clearHandlers();for(var k$f=this._laters,k$g=0,k$h=k$f.length-1;k$g<=k$h;k$g++){var k$i=k$f[k$g];this._isIgnoreRecover(k$i)||(null!==k$i.method&&(delete this._map[k$i.key],k$i.run(!1)),this._recoverHandler(k$i)),k$g===k$h&&(k$h=k$f.length-1)}k$f.length=0}},k$b._clearHandlers=function(){for(var k$a=this._handlers,k$b=0,k$c=k$a.length;k$b<k$c;k$b++){var k$d=k$a[k$b];null!==k$d.method?this._temp.push(k$d):this._isIgnoreRecover(k$d)?this._temp.push(k$d):this._recoverHandler(k$d)}this._handlers=this._temp,this._temp=k$a,this._temp.length=0},k$b._recoverHandler=function(k$a){this._map[k$a.key]==k$a&&delete this._map[k$a.key],k$a.recover()},k$b._create=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){if(!k$c)return k$e.apply(k$d,k$f),null;if(k$g){var k$i=this._getHandler(k$d,k$e);if(k$i)return k$i.repeat=k$b,k$i.userFrame=k$a,k$i.delay=k$c,k$i.ignoreRecover=k$h,k$i.caller=k$d,k$i.method=k$e,k$i.args=k$f,k$i.exeTime=k$c+(k$a?this.currFrame:this.currTimer+this._now()-this._lastTimer),k$i}return(k$i=k$j.create()).repeat=k$b,k$i.userFrame=k$a,k$i.delay=k$c,k$i.ignoreRecover=k$h,k$i.caller=k$d,k$i.method=k$e,k$i.args=k$f,k$i.exeTime=k$c+(k$a?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(k$i),this._handlers.push(k$i),k$i},k$b._indexHandler=function(k$a){var k$b=k$a.caller,k$c=k$a.method,k$d=k$b?k$b.$_GID||(k$b.$_GID=k$$.getGID()):0,k$e=k$c.$_TID||(k$c.$_TID=this._mid++);k$a.key=k$d+"_"+k$e,this._map[k$a.key]=k$a},k$b.once=function(k$a,k$b,k$c,k$d,k$e){void 0===k$e&&(k$e=!0),this._create(!1,!1,k$a,k$b,k$c,k$d,k$e,!1)},k$b.loop=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){void 0===k$e&&(k$e=!0),void 0===k$f&&(k$f=!1),void 0===k$g&&(k$g=!1);var k$h=this._create(!1,!0,k$a,k$b,k$c,k$d,k$e,k$g);k$h&&(k$h.jumpFrame=k$f)},k$b.frameOnce=function(k$a,k$b,k$c,k$d,k$e){void 0===k$e&&(k$e=!0),this._create(!0,!1,k$a,k$b,k$c,k$d,k$e,!1)},k$b.frameLoop=function(k$a,k$b,k$c,k$d,k$e,k$f){void 0===k$e&&(k$e=!0),void 0===k$f&&(k$f=!1),this._create(!0,!0,k$a,k$b,k$c,k$d,k$e,k$f)},k$b.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+k$j._freeCount},k$b.clear=function(k$a,k$b){var k$c=this._getHandler(k$a,k$b);return!(!k$c||this._isIgnoreRecover(k$c))&&(delete this._map[k$c.key],k$c.key=null,k$c.clear(),!0)},k$b.clearAll=function(k$a){if(k$a)for(var k$b=0,k$c=this._handlers.length;k$b<k$c;k$b++){var k$d=this._handlers[k$b];k$d.caller===k$a&&(this._isIgnoreRecover(k$d)||(delete this._map[k$d.key],k$d.key=null,k$d.clear()))}},k$b._getHandler=function(k$a,k$b){var k$c=k$a?k$a.$_GID||(k$a.$_GID=k$$.getGID()):0,k$d=k$b.$_TID||(k$b.$_TID=this._mid++);return this._map[k$c+"_"+k$d]},k$b._isIgnoreRecover=function(k$a){if(k$a.ignoreRecover||k$a.caller&&"IgnoreRecover"==k$a.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var k$b="";try{arguments.propertyIsEnumerable.caller}catch(k$a){k$b=k$a.stack}k$z.recordError("报错：核心定时器销毁忽略  "+k$b)}return!0}return!1},k$b.hasHandler=function(k$a,k$b){return this._map[k$a.$_GID+"_"+k$b.$_TID]},k$b.callLater=function(k$a,k$b,k$c){if(null==this._getHandler(k$a,k$b)){var k$d=k$j.create();k$d.caller=k$a,k$d.method=k$b,k$d.args=k$c,this._indexHandler(k$d),this._laters.push(k$d)}},k$b.runCallLater=function(k$a,k$b){var k$c=this._getHandler(k$a,k$b);k$c&&null!=k$c.method&&(this._isIgnoreRecover(k$c)||(delete this._map[k$c.key],k$c.run(!0)))},k$b.runTimer=function(k$a,k$b){this.runCallLater(k$a,k$b)},k$o(0,k$b,"delta",function(){return this._delta}),k$a.__init$=function(){k$j=function(){function k$b(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}k$k(k$b,"");var k$a=k$b.prototype;return k$a.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},k$a.recover=function(){this.clear(),this.args=k$b._freeHandler,k$b._freeHandler=this,k$b._freeCount++},k$a.run=function(k$a){var k$b=this.caller;if(k$b&&k$b.destroyed)return this.clear();var k$c=this.method,k$d=this.args;k$a&&this.clear(),null!=k$c&&(k$d?k$c.apply(k$b,k$d):k$c.call(k$b))},k$b._freeHandler=null,k$b._freeCount=0,k$b.create=function(){var k$a=k$b._freeHandler;return k$a?(k$b._freeHandler=k$a.args,--k$b._freeCount,k$a.args=null,k$a):new k$b},k$b}()},k$a}()),k$Z=function(){function k$l(){this.gid=0}k$k(k$l,"laya.utils.Tween");var k$a=k$l.prototype;return k$a.to=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){return void 0===k$f&&(k$f=0),void 0===k$g&&(k$g=!1),this._create(k$a,k$b,k$c,k$d,k$e,k$f,k$g,!0,!1,!0)},k$a.from=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){return void 0===k$f&&(k$f=0),void 0===k$g&&(k$g=!1),this._create(k$a,k$b,k$c,k$d,k$e,k$f,k$g,!1,!1,!0)},k$a._create=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){if(!k$a)throw new Error("Tween:target is null");this._target=k$a,this._duration=k$c,this._ease=k$d||k$b.ease||k$l.easeNone,this._complete=k$e||k$b.complete,this._delay=k$f,this._props=[],this._usedTimer=0,this._startTimer=k$O.now(),this._usedPool=k$i,this._delayParam=null,this.update=k$b.update;var k$k=k$a.$_GID||(k$a.$_GID=k$$.getGID());return k$l.tweenMap[k$k]?(k$g&&k$l.clearTween(k$a),k$l.tweenMap[k$k].push(this)):k$l.tweenMap[k$k]=[this],k$j?k$f<=0?this.firstStart(k$a,k$b,k$h):(this._delayParam=[k$a,k$b,k$h],k$z.scaleTimer.once(k$f,this,this.firstStart,this._delayParam)):this._initProps(k$a,k$b,k$h),this},k$a.firstStart=function(k$a,k$b,k$c){this._delayParam=null,k$a.destroyed?this.clear():(this._initProps(k$a,k$b,k$c),this._beginLoop())},k$a._initProps=function(k$a,k$b,k$c){for(var k$d in k$b)if("number"==typeof k$a[k$d]){var k$e=k$c?k$a[k$d]:k$b[k$d],k$f=k$c?k$b[k$d]:k$a[k$d];this._props.push([k$d,k$e,k$f-k$e]),k$c||(k$a[k$d]=k$e)}},k$a._beginLoop=function(){k$z.scaleTimer.frameLoop(1,this,this._doEase)},k$a._doEase=function(){this._updateEase(k$O.now())},k$a._updateEase=function(k$a){var k$b=this._target;if(k$b){if(k$b.destroyed)return k$l.clearTween(k$b);var k$c=this._usedTimer=k$a-this._startTimer-this._delay;if(!(k$c<0)){if(k$c>=this._duration)return this.complete();for(var k$d=0<k$c?this._ease(k$c,0,1,this._duration):0,k$e=this._props,k$f=0,k$g=k$e.length;k$f<k$g;k$f++){var k$h=k$e[k$f];k$b[k$h[0]]=k$h[1]+k$d*k$h[2]}this.update&&this.update.run()}}},k$a.complete=function(){if(this._target){k$z.scaleTimer.runTimer(this,this.firstStart);for(var k$a=this._target,k$b=this._props,k$c=this._complete,k$d=0,k$e=k$b.length;k$d<k$e;k$d++){var k$f=k$b[k$d];k$a[k$f[0]]=k$f[1]+k$f[2]}this.update&&this.update.run(),this.clear(),k$c&&k$c.run()}},k$a.pause=function(){k$z.scaleTimer.clear(this,this._beginLoop),k$z.scaleTimer.clear(this,this._doEase),k$z.scaleTimer.clear(this,this.firstStart);var k$a;(k$a=k$O.now()-this._startTimer-this._delay)<0&&(this._usedTimer=k$a)},k$a.setStartTime=function(k$a){this._startTimer=k$a},k$a.clear=function(){this._target&&(this._remove(),this._clear())},k$a._clear=function(){this.pause(),k$z.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,k$W.recover("tween",this))},k$a.recover=function(){this._usedPool=!0,this._clear()},k$a._remove=function(){var k$a=k$l.tweenMap[this._target.$_GID];if(k$a)for(var k$b=0,k$c=k$a.length;k$b<k$c;k$b++)if(k$a[k$b]===this){k$a.splice(k$b,1);break}},k$a.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=k$O.now(),this._delayParam)k$z.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var k$a=this._props,k$b=0,k$c=k$a.length;k$b<k$c;k$b++){var k$d=k$a[k$b];this._target[k$d[0]]=k$d[1]}k$z.scaleTimer.once(this._delay,this,this._beginLoop)}},k$a.resume=function(){this._usedTimer>=this._duration||(this._startTimer=k$O.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?k$z.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},k$o(0,k$a,"progress",null,function(k$a){var k$b=k$a*this._duration;this._startTimer=k$O.now()-this._delay-k$b}),k$l.to=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){return void 0===k$f&&(k$f=0),void 0===k$g&&(k$g=!1),void 0===k$h&&(k$h=!0),k$W.getItemByClass("tween",k$l)._create(k$a,k$b,k$c,k$d,k$e,k$f,k$g,!0,k$h,!0)},k$l.from=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){return void 0===k$f&&(k$f=0),void 0===k$g&&(k$g=!1),void 0===k$h&&(k$h=!0),k$W.getItemByClass("tween",k$l)._create(k$a,k$b,k$c,k$d,k$e,k$f,k$g,!1,k$h,!0)},k$l.clearAll=function(k$a){if(k$a&&k$a.$_GID){var k$b=k$l.tweenMap[k$a.$_GID];if(k$b){for(var k$c=0,k$d=k$b.length;k$c<k$d;k$c++)k$b[k$c]._clear();k$b.length=0}}},k$l.clear=function(k$a){k$a.clear()},k$l.clearTween=function(k$a){k$l.clearAll(k$a)},k$l.easeNone=function(k$a,k$b,k$c,k$d){return k$c*k$a/k$d+k$b},k$l.tweenMap={},k$l}(),k$$=function(){function k$h(){}return k$k(k$h,"laya.utils.Utils"),k$h.toRadian=function(k$a){return k$a*k$h._pi2},k$h.toAngle=function(k$a){return k$a*k$h._pi},k$h.toHexColor=function(k$a){if(k$a<0||isNaN(k$a))return null;for(var k$b=k$a.toString(16);k$b.length<6;)k$b="0"+k$b;return"#"+k$b},k$h.getGID=function(){return k$h._gid++},k$h.concatArray=function(k$a,k$b){if(!k$b)return k$a;if(!k$a)return k$b;var k$c=0,k$d=k$b.length;for(k$c=0;k$c<k$d;k$c++)k$a.push(k$b[k$c]);return k$a},k$h.clearArray=function(k$a){return k$a&&(k$a.length=0),k$a},k$h.copyArray=function(k$a,k$b){if(k$a||(k$a=[]),!k$b)return k$a;k$a.length=k$b.length;var k$c=0,k$d=k$b.length;for(k$c=0;k$c<k$d;k$c++)k$a[k$c]=k$b[k$c];return k$a},k$h.getGlobalRecByPoints=function(k$a,k$b,k$c,k$d,k$e){var k$f,k$g;return k$f=new k$A(k$b,k$c),k$f=k$a.localToGlobal(k$f),k$g=new k$A(k$d,k$e),k$g=k$a.localToGlobal(k$g),k$B._getWrapRec([k$f.x,k$f.y,k$g.x,k$g.y])},k$h.getGlobalPosAndScale=function(k$a){return k$h.getGlobalRecByPoints(k$a,0,0,1,1)},k$h.bind=function(k$a,k$b){return k$a.bind(k$b)},k$h.measureText=function(k$a,k$b){return k$F.measureText(k$a,k$b)},k$h.updateOrder=function(k$a){if(!k$a||k$a.length<2)return!1;for(var k$b,k$c=1,k$d=0,k$e=k$a.length,k$f=NaN;k$c<k$e;){for(k$b=k$a[k$d=k$c],k$f=k$a[k$d]._zOrder;-1<--k$d&&k$a[k$d]._zOrder>k$f;)k$a[k$d+1]=k$a[k$d];k$a[k$d+1]=k$b,k$c++}var k$g=k$b.parent.conchModel;if(k$g)if(null!=k$g.updateZOrder)k$g.updateZOrder();else{for(k$c=0;k$c<k$e;k$c++)k$g.removeChild(k$a[k$c].conchModel);for(k$c=0;k$c<k$e;k$c++)k$g.addChildAt(k$a[k$c].conchModel,k$c)}return!0},k$h.transPointList=function(k$a,k$b,k$c){var k$d=0,k$e=k$a.length;for(k$d=0;k$d<k$e;k$d+=2)k$a[k$d]+=k$b,k$a[k$d+1]+=k$c},k$h.parseInt=function(k$a,k$b){void 0===k$b&&(k$b=0);var k$c=k$O.window.parseInt(k$a,k$b);return isNaN(k$c)?0:k$c},k$h.getFileExtension=function(k$a){k$h._extReg.lastIndex=k$a.lastIndexOf(".");var k$b=k$h._extReg.exec(k$a);return k$b&&1<k$b.length?k$b[1].toLowerCase():null},k$h.getTransformRelativeToWindow=function(k$a,k$b,k$c){var k$d=k$z.stage,k$e=laya.utils.Utils.getGlobalPosAndScale(k$a),k$f=k$d._canvasTransform.clone(),k$g=k$f.tx,k$h=k$f.ty;k$f.rotate(-Math.PI/180*k$z.stage.canvasDegree),k$f.scale(k$z.stage.clientScaleX,k$z.stage.clientScaleY);var k$i=k$z.stage.canvasDegree%180!=0,k$j=NaN,k$k=NaN;k$i?(k$j=k$c+k$e.y,k$k=k$b+k$e.x,k$j*=k$f.d,k$k*=k$f.a,90==k$z.stage.canvasDegree?(k$j=k$g-k$j,k$k+=k$h):(k$j+=k$g,k$k=k$h-k$k)):(k$j=k$b+k$e.x,k$k=k$c+k$e.y,k$j*=k$f.a,k$k*=k$f.d,k$j+=k$g,k$k+=k$h);var k$l=NaN,k$m=NaN;return k$m=k$i?(k$l=k$f.d*k$e.height,k$f.a*k$e.width):(k$l=k$f.a*k$e.width,k$f.d*k$e.height),{x:k$j,y:k$k,scaleX:k$l,scaleY:k$m}},k$h.fitDOMElementInArea=function(k$a,k$b,k$c,k$d,k$e,k$f){k$a._fitLayaAirInitialized||(k$a._fitLayaAirInitialized=!0,k$a.style.transformOrigin=k$a.style.webKittransformOrigin="left top",k$a.style.position="absolute");var k$g=k$h.getTransformRelativeToWindow(k$b,k$c,k$d);k$a.style.transform=k$a.style.webkitTransform="scale("+k$g.scaleX+","+k$g.scaleY+") rotate("+k$z.stage.canvasDegree+"deg)",k$a.style.width=k$e+"px",k$a.style.height=k$f+"px",k$a.style.left=k$g.x+"px",k$a.style.top=k$g.y+"px"},k$h.isOkTextureList=function(k$a){if(!k$a)return!1;var k$b,k$c=0,k$d=k$a.length;for(k$c=0;k$c<k$d;k$c++)if(!(k$b=k$a[k$c])||!k$b.source)return!1;return!0},k$h.isOKCmdList=function(k$a){if(!k$a)return!1;var k$b,k$c,k$d=0,k$e=k$a.length,k$f=k$J._context;for(k$d=0;k$d<k$e;k$d++)switch((k$b=k$a[k$d]).callee){case k$f._drawTexture:case k$f._fillTexture:case k$f._drawTextureWithTransform:if(!(k$c=k$b[0])||!k$c.source)return!1}return!0},k$h._gid=1,k$h._pi=180/Math.PI,k$h._pi2=Math.PI/180,k$h._extReg=/\.(\w+)\??/g,k$h.parseXMLFromString=function(k$a){var k$b;if(k$a=k$a.replace(/>\s+</g,"><"),-1<(k$b=(new DOMParser).parseFromString(k$a,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(k$b.firstChild.firstChild.textContent);return k$b},k$h}(),k$_=function(){function k$a(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],k$J.isWebGL&&k$Q.regCacheByFunction(k$$.bind(this.startDispose,this),k$$.bind(this.getCacheList,this))}k$k(k$a,"laya.utils.VectorGraphManager");var k$b=k$a.prototype;return k$b.getId=function(){return this._id++},k$b.addShape=function(k$a,k$b){this.shapeDic[k$a]=k$b,this.useDic[k$a]||(this.useDic[k$a]=!0)},k$b.addLine=function(k$a,k$b){this.shapeLineDic[k$a]=k$b,this.shapeLineDic[k$a]||(this.shapeLineDic[k$a]=!0)},k$b.getShape=function(k$a){this._checkKey&&null!=this.useDic[k$a]&&(this.useDic[k$a]=!0)},k$b.deleteShape=function(k$a){this.shapeDic[k$a]&&(this.shapeDic[k$a]=null,delete this.shapeDic[k$a]),this.shapeLineDic[k$a]&&(this.shapeLineDic[k$a]=null,delete this.shapeLineDic[k$a]),null!=this.useDic[k$a]&&delete this.useDic[k$a]},k$b.getCacheList=function(){var k$a,k$b=[];for(k$a in this.shapeDic)k$b.push(this.shapeDic[k$a]);for(k$a in this.shapeLineDic)k$b.push(this.shapeLineDic[k$a]);return k$b},k$b.startDispose=function(k$a){var k$b;for(k$b in this.useDic)this.useDic[k$b]=!1;this._checkKey=!0},k$b.endDispose=function(){if(this._checkKey){var k$a;for(k$a in this.useDic)this.useDic[k$a]||this.deleteShape(k$a);this._checkKey=!1}},k$a.getInstance=function(){return k$a.instance=k$a.instance||new k$a},k$a.instance=null,k$a}(),k$u=function(){function k$d(){this._obj=null,this._obj=k$d.supportWeakMap?new k$O.window.WeakMap:{},k$d.supportWeakMap||k$d._maps.push(this)}k$k(k$d,"laya.utils.WeakObject");var k$a=k$d.prototype;return k$a.set=function(k$a,k$b){if(null!=k$a)if(k$d.supportWeakMap){var k$c=k$a;"string"!=typeof k$a&&"number"!=typeof k$a||(k$c=k$d._keys[k$a])||(k$c=k$d._keys[k$a]={k:k$a}),this._obj.set(k$c,k$b)}else"string"==typeof k$a||"number"==typeof k$a?this._obj[k$a]=k$b:(k$a.$_GID||(k$a.$_GID=k$$.getGID()),this._obj[k$a.$_GID]=k$b)},k$a.get=function(k$a){if(null==k$a)return null;if(k$d.supportWeakMap){var k$b="string"==typeof k$a||"number"==typeof k$a?k$d._keys[k$a]:k$a;return k$b?this._obj.get(k$b):null}return"string"==typeof k$a||"number"==typeof k$a?this._obj[k$a]:this._obj[k$a.$_GID]},k$a.del=function(k$a){if(null!=k$a)if(k$d.supportWeakMap){var k$b="string"==typeof k$a||"number"==typeof k$a?k$d._keys[k$a]:k$a;if(!k$b)return;this._obj.delete(k$b)}else"string"==typeof k$a||"number"==typeof k$a?delete this._obj[k$a]:delete this._obj[this._obj.$_GID]},k$a.has=function(k$a){if(null==k$a)return!1;if(k$d.supportWeakMap){var k$b="string"==typeof k$a||"number"==typeof k$a?k$d._keys[k$a]:k$a;return this._obj.has(k$b)}return"string"==typeof k$a||"number"==typeof k$a?null!=this._obj[k$a]:null!=this._obj[this._obj.$_GID]},k$d.__init__=function(){(k$d.supportWeakMap=null!=k$O.window.WeakMap)||k$z.timer.loop(k$d.delInterval,null,k$d.clearCache)},k$d.clearCache=function(){for(var k$a=0,k$b=k$d._maps.length;k$a<k$b;k$a++){k$d._maps[k$a]._obj={}}},k$d.supportWeakMap=!1,k$d.delInterval=3e5,k$d._keys={},k$d._maps=[],k$i(k$d,["I",function(){return this.I=new k$d}]),k$d}(),k$v=function(){function k$a(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}k$k(k$a,"laya.utils.WordText");var k$b=k$a.prototype;return k$b.setText=function(k$a){this.changed=!0,this._text=k$a},k$b.toString=function(){return this._text},k$b.charCodeAt=function(k$a){return this._text?this._text.charCodeAt(k$a):NaN},k$b.charAt=function(k$a){return this._text?this._text.charAt(k$a):null},k$o(0,k$b,"length",function(){return this._text?this._text.length:0}),k$a}(),k$aa=function(k$a){function k$g(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,k$g.__super.call(this),this._childs=k$g.ARRAY_EMPTY,this._$P=k$g.PROP_EMPTY,this.timer=k$z.scaleTimer,this.conchModel=k$J.isConchNode?this.createConchModel():null}k$k(k$g,"laya.display.Node",k$j);var k$b=k$g.prototype;return k$b._setBit=function(k$a,k$b){1==k$a&&(this._getBit(k$a)!=k$b&&this._updateDisplayedInstage());k$b?this._bits|=k$a:this._bits&=~k$a},k$b._getBit=function(k$a){return 0!=(this._bits&k$a)},k$b._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},k$b._setUpNoticeType=function(k$a){var k$b=this;for(k$b._setBit(k$a,!0),k$b=k$b.parent;k$b;){if(k$b._getBit(k$a))return;k$b._setBit(k$a,!0),k$b=k$b.parent}},k$b.on=function(k$a,k$b,k$c,k$d){return"display"!==k$a&&"undisplay"!==k$a||this._getBit(1)||this._setUpNoticeType(1),this._createListener(k$a,k$b,k$c,k$d,!1)},k$b.once=function(k$a,k$b,k$c,k$d){return"display"!==k$a&&"undisplay"!==k$a||this._getBit(1)||this._setUpNoticeType(1),this._createListener(k$a,k$b,k$c,k$d,!0)},k$b.createConchModel=function(){return null},k$b.destroy=function(k$a){void 0===k$a&&(k$a=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(k$a?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},k$b.destroyChildren=function(){if(this._childs)for(var k$a=this._childs.length-1;-1<k$a;k$a--)this._childs[k$a].destroy(!0)},k$b.addChild=function(k$a){if(!k$a||this.destroyed||k$a===this)return k$a;if(k$a.zOrder&&this._set$P("hasZorder",!0),k$a._parent===this){var k$b=this.getChildIndex(k$a);k$b!==this._childs.length-1&&(this._childs.splice(k$b,1),this._childs.push(k$a),this.conchModel&&(this.conchModel.removeChild(k$a.conchModel),this.conchModel.addChildAt(k$a.conchModel,this._childs.length-1)),this._childChanged())}else k$a.parent&&k$a.parent.removeChild(k$a),this._childs===k$g.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(k$a),this.conchModel&&this.conchModel.addChildAt(k$a.conchModel,this._childs.length-1),(k$a.parent=this)._childChanged();return k$a},k$b.addChildren=function(k$a){for(var k$b=arguments,k$c=0,k$d=k$b.length;k$c<k$d;)this.addChild(k$b[k$c++])},k$b.addChildAt=function(k$a,k$b){if(!k$a||this.destroyed||k$a===this)return k$a;if(k$a.zOrder&&this._set$P("hasZorder",!0),0<=k$b&&k$b<=this._childs.length){if(k$a._parent===this){var k$c=this.getChildIndex(k$a);this._childs.splice(k$c,1),this._childs.splice(k$b,0,k$a),this.conchModel&&(this.conchModel.removeChild(k$a.conchModel),this.conchModel.addChildAt(k$a.conchModel,k$b)),this._childChanged()}else k$a.parent&&k$a.parent.removeChild(k$a),this._childs===k$g.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(k$b,0,k$a),this.conchModel&&this.conchModel.addChildAt(k$a.conchModel,k$b),k$a.parent=this;return k$a}throw new Error("appendChildAt:The index is out of bounds")},k$b.getChildIndex=function(k$a){return this._childs.indexOf(k$a)},k$b.getChildByName=function(k$a){var k$b=this._childs;if(k$b)for(var k$c=0,k$d=k$b.length;k$c<k$d;k$c++){var k$e=k$b[k$c];if(k$e.name===k$a)return k$e}return null},k$b._get$P=function(k$a){return this._$P[k$a]},k$b._set$P=function(k$a,k$b){return this.destroyed||(this._$P===k$g.PROP_EMPTY&&(this._$P={}),this._$P[k$a]=k$b),k$b},k$b.getChildAt=function(k$a){return this._childs[k$a]},k$b.setChildIndex=function(k$a,k$b){var k$c=this._childs;if(k$b<0||k$b>=k$c.length)throw new Error("setChildIndex:The index is out of bounds.");var k$d=this.getChildIndex(k$a);if(k$d<0)throw new Error("setChildIndex:node is must child of this object.");return k$c.splice(k$d,1),k$c.splice(k$b,0,k$a),this.conchModel&&(this.conchModel.removeChild(k$a.conchModel),this.conchModel.addChildAt(k$a.conchModel,k$b)),this._childChanged(),k$a},k$b._childChanged=function(k$a){},k$b.removeChild=function(k$a){if(!this._childs)return k$a;var k$b=this._childs.indexOf(k$a);return this.removeChildAt(k$b)},k$b.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},k$b.removeChildByName=function(k$a){var k$b=this.getChildByName(k$a);return k$b&&this.removeChild(k$b),k$b},k$b.removeChildAt=function(k$a){var k$b=this.getChildAt(k$a);if(k$b){for(var k$c=this._childs.length-1,k$d=k$a;k$d<k$c;++k$d)this._childs[k$d]=this._childs[k$d+1];this._childs.length=k$c,this.conchModel&&this.conchModel.removeChild(k$b.conchModel),k$b.parent=null}return k$b},k$b.removeChildren=function(k$a,k$b){if(void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=2147483647),this._childs&&0<this._childs.length){var k$c=this._childs;if(0===k$a&&k$f<=k$b){var k$d=k$c;this._childs=k$g.ARRAY_EMPTY}else k$d=k$c.splice(k$a,k$b-k$a);for(var k$e=0,k$f=k$d.length;k$e<k$f;k$e++)k$d[k$e].parent=null,this.conchModel&&this.conchModel.removeChild(k$d[k$e].conchModel)}return this},k$b.replaceChild=function(k$a,k$b){var k$c=this._childs.indexOf(k$b);return-1<k$c?(this._childs.splice(k$c,1,k$a),this.conchModel&&(this.conchModel.removeChild(k$b.conchModel),this.conchModel.addChildAt(k$a.conchModel,k$c)),k$b.parent=null,k$a.parent=this,k$a):null},k$b._updateDisplayedInstage=function(){var k$a;k$a=this;var k$b=k$z.stage;for(this._displayedInStage=!1;k$a;){if(k$a._getBit(1)){this._displayedInStage=k$a._displayedInStage;break}if(k$a==k$b||k$a._displayedInStage){this._displayedInStage=!0;break}k$a=k$a.parent}},k$b._setDisplay=function(k$a){this._displayedInStage!==k$a&&((this._displayedInStage=k$a)?this.event("display"):this.event("undisplay"))},k$b._displayChild=function(k$a,k$b){var k$c=k$a._childs;if(k$c)for(var k$d=0;k$d<k$c.length;k$d++){var k$e=k$c[k$d];k$e&&k$e._getBit(1)&&(0<k$e._childs.length?this._displayChild(k$e,k$b):k$e._setDisplay(k$b))}k$a._setDisplay(k$b)},k$b.contains=function(k$a){if(k$a===this)return!0;for(;k$a;){if(k$a.parent===this)return!0;k$a=k$a.parent}return!1},k$b.timerLoop=function(k$a,k$b,k$c,k$d,k$e,k$f){void 0===k$e&&(k$e=!0),void 0===k$f&&(k$f=!1),this.timer.loop(k$a,k$b,k$c,k$d,k$e,k$f)},k$b.timerOnce=function(k$a,k$b,k$c,k$d,k$e){void 0===k$e&&(k$e=!0),this.timer._create(!1,!1,k$a,k$b,k$c,k$d,k$e)},k$b.frameLoop=function(k$a,k$b,k$c,k$d,k$e){void 0===k$e&&(k$e=!0),this.timer._create(!0,!0,k$a,k$b,k$c,k$d,k$e)},k$b.frameOnce=function(k$a,k$b,k$c,k$d,k$e){void 0===k$e&&(k$e=!0),this.timer._create(!0,!1,k$a,k$b,k$c,k$d,k$e)},k$b.clearTimer=function(k$a,k$b){this.timer.clear(k$a,k$b)},k$o(0,k$b,"numChildren",function(){return this._childs.length}),k$o(0,k$b,"destroyed",function(){return this._destroyed}),k$o(0,k$b,"parent",function(){return this._parent},function(k$a){this._parent!==k$a&&(k$a?(this._parent=k$a,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),k$a.displayedInStage&&this._displayChild(this,!0)),k$a._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=k$a))}),k$o(0,k$b,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),k$g.ARRAY_EMPTY=[],k$g.PROP_EMPTY={},k$g.NOTICE_DISPLAY=1,k$g.MOUSEENABLE=2,k$g}(),k$ba=function(k$a){function k$m(k$a){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,k$m.__super.call(this),this._padding=k$m._PADDING,this._spacing=k$m._SPACING,this._aligns=k$m._ALIGNS,this._font=k$n.EMPTY,this._ower=k$a}k$k(k$m,"laya.display.css.CSSStyle",k$a);var k$b=k$m.prototype;return k$b.destroy=function(){this._ower=null,this._font=null,this._rect=null},k$b.inherit=function(k$a){this._font=k$a._font,this._spacing=k$a._spacing===k$m._SPACING?k$m._SPACING:k$a._spacing.slice(),this.lineHeight=k$a.lineHeight},k$b._widthAuto=function(){return 0!=(262144&this._type)},k$b.widthed=function(k$a){return 0!=(8&this._type)},k$b._calculation=function(k$a,k$b){if(k$b.indexOf("%")<0)return!1;var k$d=this._ower,k$e=k$d.parent,k$f=this._rect;function k$g(k$a,k$b,k$c){return k$a*k$c[0]+k$b*k$c[1]+k$c[2]}function k$c(k$a){var k$b=k$e.width,k$c=k$d.width;k$f.width&&(k$d.width=k$g(k$b,k$c,k$f.width)),k$f.height&&(k$d.height=k$g(k$b,k$c,k$f.height)),k$f.left&&(k$d.x=k$g(k$b,k$c,k$f.left)),k$f.top&&(k$d.y=k$g(k$b,k$c,k$f.top))}null===k$f&&(k$e._getCSSStyle()._type|=524288,k$e.on("resize",this,k$c),this._rect=k$f={input:{}});var k$h=k$b.split(" ");return k$h[0]=parseFloat(k$h[0])/100,1==k$h.length?k$h[1]=k$h[2]=0:(k$h[1]=parseFloat(k$h[1])/100,k$h[2]=parseFloat(k$h[2])),k$f[k$a]=k$h,k$f.input[k$a]=k$b,k$c(),!0},k$b.heighted=function(k$a){return 0!=(8192&this._type)},k$b.size=function(k$a,k$b){var k$c=this._ower,k$d=!1;-1!==k$a&&k$a!=this._ower.width&&(this._type|=8,this._ower.width=k$a,k$d=!0),-1!==k$b&&k$b!=this._ower.height&&(this._type|=8192,this._ower.height=k$b,k$d=!0),k$d&&(k$c._layoutLater(),524288&this._type&&k$c.event("resize",this))},k$b._getAlign=function(){return this._aligns[0]},k$b._getValign=function(){return this._aligns[1]},k$b._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},k$b._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new k$n(this._font))},k$b.render=function(k$a,k$b,k$c,k$d){var k$e=k$a.width,k$f=k$a.height;k$c-=k$a.pivotX,k$d-=k$a.pivotY,this._bgground&&null!=this._bgground.color&&k$b.ctx.fillRect(k$c,k$d,k$e,k$f,this._bgground.color),this._border&&this._border.color&&k$b.drawRect(k$c,k$d,k$e,k$f,this._border.color.strColor,this._border.size)},k$b.getCSSStyle=function(){return this},k$b.cssText=function(k$a){this.attrs(k$m.parseOneCSS(k$a,";"))},k$b.attrs=function(k$a){if(k$a)for(var k$b=0,k$c=k$a.length;k$b<k$c;k$b++){var k$d=k$a[k$b];this[k$d[0]]=k$d[1]}},k$b.setTransform=function(k$a){"none"===k$a?this._tf=k$h._TF_EMPTY:this.attrs(k$m.parseOneCSS(k$a,","))},k$b.translate=function(k$a,k$b){this._tf===k$h._TF_EMPTY&&(this._tf=new k$e),this._tf.translateX=k$a,this._tf.translateY=k$b},k$b.scale=function(k$a,k$b){this._tf===k$h._TF_EMPTY&&(this._tf=new k$e),this._tf.scaleX=k$a,this._tf.scaleY=k$b},k$b._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},k$o(0,k$b,"block",k$a.prototype._$get_block,function(k$a){k$a?this._type|=1:this._type&=-2}),k$o(0,k$b,"valign",function(){return k$m._valigndef[this._aligns[1]]},function(k$a){this._aligns===k$m._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=k$m._valigndef[k$a]}),k$o(0,k$b,"height",null,function(k$a){if(this._type|=8192,"string"==typeof k$a){if(this._calculation("height",k$a))return;k$a=parseInt(k$a)}this.size(-1,k$a)}),k$o(0,k$b,"width",null,function(k$a){if(this._type|=8,"string"==typeof k$a){var k$b=k$a.indexOf("auto");if(0<=k$b&&(this._type|=262144,k$a=k$a.substr(0,k$b)),this._calculation("width",k$a))return;k$a=parseInt(k$a)}this.size(k$a,-1)}),k$o(0,k$b,"fontWeight",function(){return this._font.weight},function(k$a){this._createFont().weight=k$a}),k$o(0,k$b,"left",null,function(k$a){var k$b=this._ower;if("string"==typeof k$a){if("center"===k$a?k$a="50% -50% 0":"right"===k$a&&(k$a="100% -100% 0"),this._calculation("left",k$a))return;k$a=parseInt(k$a)}k$b.x=k$a}),k$o(0,k$b,"_translate",null,function(k$a){this.translate(k$a[0],k$a[1])}),k$o(0,k$b,"absolute",function(){return 0!=(4&this._type)}),k$o(0,k$b,"top",null,function(k$a){var k$b=this._ower;if("string"==typeof k$a){if("middle"===k$a?k$a="50% -50% 0":"bottom"===k$a&&(k$a="100% -100% 0"),this._calculation("top",k$a))return;k$a=parseInt(k$a)}k$b.y=k$a}),k$o(0,k$b,"align",function(){return k$m._aligndef[this._aligns[0]]},function(k$a){this._aligns===k$m._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=k$m._aligndef[k$a]}),k$o(0,k$b,"bold",function(){return this._font.bold},function(k$a){this._createFont().bold=k$a}),k$o(0,k$b,"padding",function(){return this._padding},function(k$a){this._padding=k$a}),k$o(0,k$b,"leading",function(){return this._spacing[1]},function(k$a){"string"==typeof k$a&&(k$a=parseInt(k$a+"")),this._spacing===k$m._SPACING&&(this._spacing=[0,0]),this._spacing[1]=k$a}),k$o(0,k$b,"lineElement",function(){return 0!=(65536&this._type)},function(k$a){k$a?this._type|=65536:this._type&=-65537}),k$o(0,k$b,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(k$a){this.lineElement=!1,"right"===k$a?this._type|=32768:this._type&=-32769}),k$o(0,k$b,"textDecoration",function(){return this._font.decoration},function(k$a){this._createFont().decoration=k$a}),k$o(0,k$b,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(k$a){"nowrap"===k$a&&(this._type|=131072),"none"===k$a&&(this._type&=-131073)}),k$o(0,k$b,"background",null,function(k$a){k$a?(this._bgground||(this._bgground={}),this._bgground.color=k$a,this._ower.conchModel&&this._ower.conchModel.bgColor(k$a),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),k$o(0,k$b,"wordWrap",function(){return 0==(131072&this._type)},function(k$a){k$a?this._type&=-131073:this._type|=131072}),k$o(0,k$b,"color",function(){return this._font.color},function(k$a){this._createFont().color=k$a}),k$o(0,k$b,"password",function(){return this._font.password},function(k$a){this._createFont().password=k$a}),k$o(0,k$b,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(k$a){"none"===k$a?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=k$a),this._ower.conchModel&&this._ower.conchModel.bgColor(k$a),this._ower._renderType|=256}),k$o(0,k$b,"font",function(){return this._font.toString()},function(k$a){this._createFont().set(k$a)}),k$o(0,k$b,"weight",null,function(k$a){this._createFont().weight=k$a}),k$o(0,k$b,"letterSpacing",function(){return this._spacing[0]},function(k$a){"string"==typeof k$a&&(k$a=parseInt(k$a+"")),this._spacing===k$m._SPACING&&(this._spacing=[0,0]),this._spacing[0]=k$a}),k$o(0,k$b,"fontSize",function(){return this._font.size},function(k$a){this._createFont().size=k$a}),k$o(0,k$b,"italic",function(){return this._font.italic},function(k$a){this._createFont().italic=k$a}),k$o(0,k$b,"fontFamily",function(){return this._font.family},function(k$a){this._createFont().family=k$a}),k$o(0,k$b,"stroke",function(){return this._font.stroke[0]},function(k$a){this._createFont().stroke===k$n._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=k$a}),k$o(0,k$b,"strokeColor",function(){return this._font.stroke[1]},function(k$a){this._createFont().stroke===k$n._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=k$a}),k$o(0,k$b,"border",function(){return this._border?this._border.value:""},function(k$a){if("none"!=k$a){this._border||(this._border={});var k$b=(this._border.value=k$a).split(" ");if(this._border.color=k$S.create(k$b[k$b.length-1]),1==k$b.length)return this._border.size=1,void(this._border.type="solid");var k$c=0;0<k$b[0].indexOf("px")?(this._border.size=parseInt(k$b[0]),k$c++):this._border.size=1,this._border.type=k$b[k$c],this._ower._renderType|=256}else this._border=null}),k$o(0,k$b,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(k$a){k$a?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==k$a?null:k$S.create(k$a),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),k$o(0,k$b,"position",function(){return 4&this._type?"absolute":""},function(k$a){"absolute"==k$a?this._type|=4:this._type&=-5}),k$o(0,k$b,"display",null,function(k$a){switch(k$a){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),k$o(0,k$b,"paddingLeft",function(){return this.padding[3]}),k$o(0,k$b,"paddingTop",function(){return this.padding[0]}),k$o(0,k$b,"_scale",null,function(k$a){this._ower.scale(k$a[0],k$a[1])}),k$o(0,k$b,"_rotate",null,function(k$a){this._ower.rotation=k$a}),k$m.parseOneCSS=function(k$a,k$b){for(var k$c,k$d=[],k$e=k$a.split(k$b),k$f=0,k$g=k$e.length;k$f<k$g;k$f++){var k$h=k$e[k$f],k$i=k$h.indexOf(":"),k$j=k$h.substr(0,k$i).replace(/^\s+|\s+$/g,"");if(0!=k$j.length){var k$k=k$h.substr(k$i+1).replace(/^\s+|\s+$/g,""),k$l=[k$j,k$k];switch(k$j){case"italic":case"bold":k$l[1]="true"==k$k;break;case"line-height":k$l[0]="lineHeight",k$l[1]=parseInt(k$k);break;case"font-size":k$l[0]="fontSize",k$l[1]=parseInt(k$k);break;case"padding":1<(k$c=k$k.split(" ")).length||(k$c[1]=k$c[2]=k$c[3]=k$c[0]),k$l[1]=[parseInt(k$c[0]),parseInt(k$c[1]),parseInt(k$c[2]),parseInt(k$c[3])];break;case"rotate":k$l[0]="_rotate",k$l[1]=parseFloat(k$k);break;case"scale":k$c=k$k.split(" "),k$l[0]="_scale",k$l[1]=[parseFloat(k$c[0]),parseFloat(k$c[1])];break;case"translate":k$c=k$k.split(" "),k$l[0]="_translate",k$l[1]=[parseInt(k$c[0]),parseInt(k$c[1])];break;default:(k$l[0]=k$m._CSSTOVALUE[k$j])||(k$l[0]=k$j)}k$d.push(k$l)}}return k$d},k$m.parseCSS=function(k$a,k$b){for(var k$c;null!=(k$c=k$m._parseCSSRegExp.exec(k$a));)k$m.styleSheets[k$c[1]]=k$m.parseOneCSS(k$c[2],";")},k$m.EMPTY=new k$m(null),k$m._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},k$m._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),k$m._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},k$m._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},k$m.styleSheets={},k$m.ALIGN_CENTER=1,k$m.ALIGN_RIGHT=2,k$m.VALIGN_MIDDLE=1,k$m.VALIGN_BOTTOM=2,k$m._CSS_BLOCK=1,k$m._DISPLAY_NONE=2,k$m._ABSOLUTE=4,k$m._WIDTH_SET=8,k$m._PADDING=[0,0,0,0],k$m._RECT=[-1,-1,-1,-1],k$m._SPACING=[0,0],k$m._ALIGNS=[0,0,0],k$m.ADDLAYOUTED=512,k$m._NEWFONT=4096,k$m._HEIGHT_SET=8192,k$m._BACKGROUND_SET=16384,k$m._FLOAT_RIGHT=32768,k$m._LINE_ELEMENT=65536,k$m._NOWARP=131072,k$m._WIDTHAUTO=262144,k$m._LISTERRESZIE=524288,k$m}(k$h),k$ca=function(k$a){function k$g(){this.url=null,this.audio=null,this.loaded=!1,k$g.__super.call(this)}k$k(k$g,"laya.media.h5audio.AudioSound",k$j);var k$b=k$g.prototype;return k$b.dispose=function(){var k$a=k$g._audioCache[this.url];k$a&&(k$a.src="",delete k$g._audioCache[this.url])},k$b.load=function(k$a){var k$b;if(k$a=k$I.formatURL(k$a),(this.url=k$a)==k$E._tMusic?(k$g._initMusicAudio(),(k$b=k$g._musicAudio).src!=k$a&&(k$g._audioCache[k$b.src]=null,k$b=null)):k$b=k$g._audioCache[k$a],k$b&&2<=k$b.readyState)this.event("complete");else{k$b||(k$b=k$a==k$E._tMusic?(k$g._initMusicAudio(),k$g._musicAudio):k$O.createElement("audio"),(k$g._audioCache[k$a]=k$b).src=k$a),k$b.addEventListener("canplaythrough",k$d),k$b.addEventListener("error",k$e);var k$c=this;(this.audio=k$b).load?k$b.load():k$e()}function k$d(){k$f(),k$c.loaded=!0,k$c.event("complete")}function k$e(){k$b.load=null,k$f(),k$c.event("error")}function k$f(){k$b.removeEventListener("canplaythrough",k$d),k$b.removeEventListener("error",k$e)}},k$b.play=function(k$a,k$b,k$c){if(void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),!this.url)return null;var k$d,k$e;if(!(k$d=this.url==k$E._tMusic?k$g._musicAudio:k$g._audioCache[this.url]))return null;k$e=k$W.getItem("audio:"+this.url),k$J.isConchApp?k$e||((k$e=k$O.createElement("audio")).src=this.url):this.url==k$E._tMusic?(k$g._initMusicAudio(),(k$e=k$g._musicAudio).src=this.url):k$e=k$e||k$d.cloneNode(!0);var k$f=new k$ma(k$e);return k$f.url=this.url,k$f.loops=k$b,k$f.startTime=k$a,k$f.startHandler=k$c,k$f.play(!1),k$E.addChannel(k$f),k$f},k$o(0,k$b,"duration",function(){var k$a;return(k$a=k$g._audioCache[this.url])?k$a.duration:0}),k$g._initMusicAudio=function(){k$g._musicAudio||(k$g._musicAudio||(k$g._musicAudio=k$O.createElement("audio")),k$J.isConchApp||k$O.document.addEventListener("mousedown",k$g._makeMusicOK))},k$g._makeMusicOK=function(){k$O.document.removeEventListener("mousedown",k$g._makeMusicOK),k$g._musicAudio.src?k$g._musicAudio.play():(k$g._musicAudio.src="",k$g._musicAudio.load())},k$g._audioCache={},k$g._musicAudio=null,k$g}(),k$da=function(k$a){function k$b(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,k$b.__super.call(this)}k$k(k$b,"laya.media.SoundChannel",k$j);var k$c=k$b.prototype;return k$c.play=function(){},k$c.stop=function(){},k$c.pause=function(){},k$c.resume=function(){},k$c.__runComplete=function(k$a){k$a&&k$a.run()},k$o(0,k$c,"volume",function(){return 1},function(k$a){}),k$o(0,k$c,"position",function(){return 0}),k$o(0,k$c,"duration",function(){return 0}),k$b}(),k$ea=function(k$a){function k$b(){k$b.__super.call(this)}k$k(k$b,"laya.media.Sound",k$j);var k$c=k$b.prototype;return k$c.load=function(k$a){},k$c.play=function(k$a,k$b,k$c){return void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),null},k$c.dispose=function(){},k$o(0,k$c,"duration",function(){return 0}),k$b}(),k$fa=function(k$a){function k$e(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,k$e.__super.call(this)}k$k(k$e,"laya.media.webaudio.WebAudioSound",k$j);var k$b=k$e.prototype;return k$b.load=function(k$a){this.url=k$a,this.audioBuffer=k$e._dataCache[k$a],this.audioBuffer?this._loaded(this.audioBuffer):(k$e.e.on("loaded:"+k$a,this,this._loaded),k$e.e.on("err:"+k$a,this,this._err),k$e.__loadingSound[k$a]||(k$e.__loadingSound[k$a]=!0,k$z.loader.load(k$a,k$s.create(this,this.onloaded),null,k$ha.BUFFER,4,!1,null,!0)))},k$b.onloaded=function(k$a){k$a||this._err(),this._disposed?this._removeLoadEvents():(this.data=k$a,k$e.buffs.push({buffer:this.data,url:this.url}),k$e.decode())},k$b._err=function(){if(this._removeLoadEvents(),k$e.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var k$a,k$b,k$c,k$d=0;for(k$a=(k$b=this.__toPlays).length,k$d=0;k$d<k$a;k$d++)(k$c=k$b[k$d])[3]&&!k$c[3].isStopped&&k$c[3].event("error");this.__toPlays.length=0}},k$b._loaded=function(k$a){this._removeLoadEvents(),this._disposed||(this.audioBuffer=k$a,this.loaded=!0,this.event("complete"))},k$b._removeLoadEvents=function(){k$e.e.off("loaded:"+this.url,this,this._loaded),k$e.e.off("err:"+this.url,this,this._err)},k$b.__playAfterLoaded=function(){if(this.__toPlays){var k$a,k$b,k$c,k$d=0;for(k$a=(k$b=this.__toPlays).length,k$d=0;k$d<k$a;k$d++)(k$c=k$b[k$d])[3]&&!k$c[3].isStopped&&this.play(k$c[0],k$c[1],k$c[2],k$c[3]);this.__toPlays.length=0}},k$b.play=function(k$a,k$b,k$c,k$d){return void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),k$d=k$d||new k$na,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([k$a,k$b,k$c,k$d]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),k$d.url=this.url,k$d.loops=k$b,k$d.audioBuffer=this.audioBuffer,k$d.startTime=k$a,k$d.startHandler=k$c,k$d.play(!1),k$E.addChannel(k$d),k$d},k$b.dispose=function(){this._disposed=!0,delete k$e._dataCache[this.url],delete k$e.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},k$o(0,k$b,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),k$e.decode=function(){if(!(k$e.buffs.length<=0||k$e.isDecoding))if(k$e.isDecoding=!0,(k$e.tInfo=k$e.buffs.shift())&&k$e.tInfo.buffer&&k$e.tInfo.buffer.byteLength)try{k$e.ctx.decodeAudioData(k$e.tInfo.buffer,k$e._done,k$e._fail)}catch(k$a){console.error("decodeAudioData error  byteLength:"+k$e.tInfo.buffer.byteLength+"  url:"+k$e.tInfo.url)}else k$e._fail()},k$e._done=function(k$a){k$e.e.event("loaded:"+k$e.tInfo.url,k$a),k$e._dataCache[k$e.tInfo.url]=k$a,k$e.isDecoding=!1,k$e.decode()},k$e._fail=function(){k$e.e.event("err:"+k$e.tInfo.url,null),k$e.isDecoding=!1,k$e.decode()},k$e._playEmptySound=function(){if(null!=k$e.ctx){if(k$e._emptySource&&(k$e._emptySource.stop(),k$e._emptySource.disconnect(0),!k$na._tryCleanFailed))try{k$e._emptySource.buffer=null}catch(k$a){k$na._tryCleanFailed=!0}var k$a=k$e.ctx.createBufferSource();k$a.buffer=k$e._miniBuffer,k$a.connect(k$e.ctx.destination),k$a.start(0,0,0),k$e._emptySource=k$a}},k$e._unlock=function(){k$e._unlocked||(k$e._playEmptySound(),"running"==k$e.ctx.state?(k$O.document.removeEventListener("mousedown",k$e._unlock,!0),k$O.document.removeEventListener("touchend",k$e._unlock,!0),k$O.document.removeEventListener("touchstart",k$e._unlock,!0),k$e._unlocked=!0):"suspended"==k$e.ctx.state&&k$E._recoverWebAudio())},k$e.initWebAudio=function(){"running"!=k$e.ctx.state&&(k$e._unlock(),k$O.document.addEventListener("mousedown",k$e._unlock,!0),k$O.document.addEventListener("touchend",k$e._unlock,!0),k$O.document.addEventListener("touchstart",k$e._unlock,!0))},k$e._emptySource=null,k$e._dataCache={},k$e.buffs=[],k$e.isDecoding=!1,k$e._unlocked=!1,k$e.tInfo=null,k$e.__loadingSound={},k$i(k$e,["window",function(){return this.window=k$O.window},"webAudioEnabled",function(){return this.webAudioEnabled=k$e.window.AudioContext||k$e.window.webkitAudioContext||k$e.window.mozAudioContext},"ctx",function(){return this.ctx=k$e.webAudioEnabled?new(k$e.window.AudioContext||k$e.window.webkitAudioContext||k$e.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=k$e.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new k$j}]),k$e}(),k$ga=function(k$a){function k$b(){this._responseType=null,this._data=null,k$b.__super.call(this),this._http=new k$O.window.XMLHttpRequest}k$k(k$b,"laya.net.HttpRequest",k$j);var k$c=k$b.prototype;return k$c.send=function(k$a,k$b,k$c,k$d,k$e){void 0===k$c&&(k$c="get"),void 0===k$d&&(k$d="text"),this._responseType=k$d,this._data=null;var k$f=this,k$g=this._http;if(k$g.open(k$c,k$a,!0),k$e)for(var k$h=0;k$h<k$e.length;k$h++)k$g.setRequestHeader(k$e[k$h++],k$e[k$h]);else k$J.isConchApp||(k$b&&"string"!=typeof k$b?k$g.setRequestHeader("Content-Type","application/json"):k$g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));k$g.responseType="arraybuffer"!==k$d?"text":"arraybuffer",k$g.onerror=function(k$a){k$f._onError(k$a)},k$g.onabort=function(k$a){k$f._onAbort(k$a)},k$g.onprogress=function(k$a){k$f._onProgress(k$a)},k$g.onload=function(k$a){k$f._onLoad(k$a)},k$g.send(k$b)},k$c._onProgress=function(k$a){k$a&&k$a.lengthComputable&&this.event("progress",k$a.loaded/k$a.total)},k$c._onAbort=function(k$a){this.error("Request was aborted by user")},k$c._onError=function(k$a){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},k$c._onLoad=function(k$a){var k$b=this._http,k$c=void 0!==k$b.status?k$b.status:200;200===k$c||204===k$c||0===k$c?this.complete():this.error("["+k$b.status+"]"+k$b.statusText+":"+k$b.responseURL)},k$c.error=function(k$a){this.clear(),this.event("error",k$a)},k$c.complete=function(){this.clear();var k$b=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=k$$.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(k$a){k$b=!1,this.error(k$a.message)}k$b&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},k$c.clear=function(){var k$a=this._http;k$a.onerror=k$a.onabort=k$a.onprogress=k$a.onload=null},k$o(0,k$c,"url",function(){return this._http.responseURL}),k$o(0,k$c,"http",function(){return this._http}),k$o(0,k$c,"data",function(){return this._data}),k$b}(),k$ha=function(k$a){function k$C(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,k$C.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}k$k(k$C,"laya.net.Loader",k$j);var k$b=k$C.prototype;return k$b.load=function(k$a,k$b,k$c,k$d,k$e){if(k$a&&""!=k$a||console.error("Loader 加载的url不合法 "+k$a),void 0===k$c&&(k$c=!0),void 0===k$e&&(k$e=!1),0===(this._url=k$a).indexOf("data:image")?this._type=k$b="image":this._type=k$b||(k$b=this.getTypeFromUrl(k$a)),this._cache=k$c,this._data=null,!k$e&&k$C.loadedMap[k$a])return this._data=k$C.loadedMap[k$a],this.event("progress",1),void this.event("complete",this._data);if(k$d&&k$C.setGroup(k$a,k$d),null!=k$C.parserMap[k$b])return this._customParse=!0,void(k$C.parserMap[k$b]instanceof laya.utils.Handler?k$C.parserMap[k$b].runWith(this):k$C.parserMap[k$b].call(null,this));if("image"===k$b||"htmlimage"===k$b||"nativeimage"===k$b)return this._loadImage(k$a);if("ttf"===k$b)return this._loadTTF(k$a);switch(k$b){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:k$b}k$C.preLoadedMap[k$a]?this.onLoaded(k$C.preLoadedMap[k$a]):k$g.resMgrLoad(k$a,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},k$b.getTypeFromUrl=function(k$a){var k$b=k$$.getFileExtension(k$a);return k$b?k$C.typeMap[k$b]:(console.warn("Not recognize the resources suffix",k$a),"text")},k$b._loadTTF=function(k$a){k$a=k$I.formatURL(k$a);var k$b=new k$H;k$b.complete=k$s.create(this,this.onLoaded),k$b.load(k$a)},k$b._loadImage=function(k$a){k$g.imgMgrLoad(k$a,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},k$b._loadImageComplete=function(k$a,k$b,k$c){if(null!=k$c)if(k$c instanceof ArrayBuffer){var k$d=new DataView(k$c),k$e=new laya.webgl.resource.WebGLImage(new Uint8Array(k$c,8),k$a,0,!1,k$d.getUint32(0),k$d.getUint32(4));this.onLoaded(k$e)}else if(k$c instanceof k$ka)k$C.imgMgrSet[k$a]=k$b,k$g.imgMgrLock(k$a,k$C.imgMgrSet[k$a]),this._url=k$a,this.complete(k$c);else{var k$f=-1!=k$a.indexOf(".png",k$a.length-4)?6408:6407;k$e=new laya.webgl.resource.WebGLImage(k$c,k$a,k$f,!1,k$c.width,k$c.height);this.onLoaded(k$e)}else this.event("error","Load image failed")},k$b._loadSound=function(k$a){var k$b=new k$E._soundClass,k$c=this;function k$d(){k$b.offAll()}k$b.on("complete",this,function(){k$d(),k$c.onLoaded(k$b)}),k$b.on("error",this,function(){k$d(),k$b.dispose(),k$c.event("error","Load sound failed")}),k$b.load(k$a)},k$b.onProgress=function(k$a){"atlas"===this._type?this.event("progress",.3*k$a):this.event("progress",k$a)},k$b.onError=function(k$a){this.event("error",k$a)},k$b._loadedComplete=function(k$a,k$b,k$c){if(null!=k$c)switch(this._type){case"atlas":case"plf":case"json":var k$d=new k$P(k$c);this.onLoaded(JSON.parse(k$d.readUTFBytes()));break;case"font":k$d=new k$P(k$c);this.onLoaded(k$$.parseXMLFromString(k$d.readUTFBytes()));break;default:this.onLoaded(k$c)}else this.event("error",k$a)},k$b.onLoaded=function(k$a){var k$b=this._type;if("plf"==k$b)this.parsePLFData(k$a),this.complete(k$a);else if("image"===k$b){var k$c=new k$ka(k$a);k$c.url=this._url,this.complete(k$c)}else if("sound"===k$b||"htmlimage"===k$b||"nativeimage"===k$b)this.complete(k$a);else if("atlas"===k$b){if(!k$a.src&&!k$a._setContext){if(!this._data){if((this._data=k$a).meta&&k$a.meta.image)for(var k$d=k$a.meta.image.split(","),k$e=0<=this._url.indexOf("/")?"/":"\\",k$f=this._url.lastIndexOf(k$e),k$g=0<=k$f?this._url.substr(0,k$f+1):"",k$h=0,k$i=k$d.length;k$h<k$i;k$h++)k$d[k$h]=k$g+k$d[k$h];else k$d=[this._url.replace(".json",".png")];k$d.reverse(),k$a.toLoads=k$d,k$a.pics=[]}return this.event("progress",.3+1/k$d.length*.6),this._loadImage(k$d.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(k$a),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var k$j=this._data.frames,k$k=this._url.split("?")[0],k$l=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:k$k.substring(0,k$k.lastIndexOf("."))+"/",k$m=this._data.pics,k$n=k$I.formatURL(this._url),k$o=k$C.atlasMap[k$n]||(k$C.atlasMap[k$n]=[]);k$o.dir=k$l;var k$p=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var k$q in k$p=parseFloat(this._data.meta.scale),k$j){var k$r,k$s=k$j[k$q],k$t=k$m[k$s.frame.idx?k$s.frame.idx:0],k$w=k$I.formatURL(k$l+k$q);k$t.scaleRate=k$p,k$r=k$ka.create(k$t,k$s.frame.x,k$s.frame.y,k$s.frame.w,k$s.frame.h,k$s.spriteSourceSize.x,k$s.spriteSourceSize.y,k$s.sourceSize.w,k$s.sourceSize.h),k$C.cacheRes(k$w,k$r),k$C.keepCache(this._url,k$l+k$q),k$r.url=k$w,k$o.push(k$w)}else for(k$q in k$j)k$t=k$m[(k$s=k$j[k$q]).frame.idx?k$s.frame.idx:0],k$w=k$I.formatURL(k$l+k$q),k$C.cacheRes(k$w,k$ka.create(k$t,k$s.frame.x,k$s.frame.y,k$s.frame.w,k$s.frame.h,k$s.spriteSourceSize.x,k$s.spriteSourceSize.y,k$s.sourceSize.w,k$s.sourceSize.h)),k$C.loadedMap[k$w].url=k$w,k$C.keepCache(this._url,k$l+k$q),k$o.push(k$w);delete this._data.pics,this.complete(this._data)}else if("font"==k$b){if(!k$a.src)return this._data=k$a,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var k$x=new k$D;k$x.parseFont(this._data,k$a);var k$y=this._url.split(".fnt")[0].split("/"),k$z=k$y[k$y.length-1];k$qa.registerBitmapFont(k$z,k$x),this._data=k$x,this.complete(this._data)}else if("pkm"==k$b){var k$A=k$ya.create(k$a,this._url),k$B=new k$ka(k$A);k$B.url=this._url,this.complete(k$B)}else this.complete(k$a)},k$b.parsePLFData=function(k$a){var k$b,k$c,k$d;for(k$b in k$a)switch(k$d=k$a[k$b],k$b){case"json":case"text":for(k$c in k$d)k$C.preLoadedMap[k$I.formatURL(k$c)]=k$d[k$c];break;default:for(k$c in k$d)k$C.preLoadedMap[k$I.formatURL(k$c)]=k$d[k$c]}},k$b.complete=function(k$a){this._data=k$a,this._customParse?this.event("loaded",k$a instanceof Array?[k$a]:k$a):(k$C._loaders.push(this),k$C._isWorking||k$C.checkNext())},k$b.endLoad=function(k$a){k$a&&(this._data=k$a),this._cache&&k$C.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},k$o(0,k$b,"url",function(){return this._url}),k$o(0,k$b,"data",function(){return this._data}),k$o(0,k$b,"cache",function(){return this._cache}),k$o(0,k$b,"type",function(){return this._type}),k$C.checkNext=function(){k$C._isWorking=!0;for(var k$a=k$O.now();k$C._startIndex<k$C._loaders.length;)if(k$O.now(),k$C._loaders[k$C._startIndex].endLoad(),k$C._startIndex++,k$O.now()-k$a>k$C.maxTimeOut)return console.warn("loader callback cost a long time:"+(k$O.now()-k$a)+" url="+k$C._loaders[k$C._startIndex-1].url),void k$z.timer.frameOnce(1,null,k$C.checkNext);k$C._loaders.length=0,k$C._startIndex=0,k$C._isWorking=!1},k$C.clearRes=function(k$a,k$b){if(null!=k$a){void 0===k$b&&(k$b=!1),k$a=k$I.formatURL(k$a);var k$c=k$C.getAtlas(k$a);if(k$c){for(var k$d=0,k$e=k$c.length;k$d<k$e;k$d++){var k$f=k$c[k$d],k$g=k$C.getRes(k$f);delete k$C.loadedMap[k$f],k$C.clearCache(k$a.substring(k$I.basePath.length),k$f.substring(k$I.basePath.length)),k$g&&k$g.destroy(k$b)}k$c.length=0,delete k$C.atlasMap[k$a],delete k$C.loadedMap[k$a]}else{var k$h=k$C.loadedMap[k$a];k$h&&(delete k$C.loadedMap[k$a],k$h instanceof laya.resource.Texture&&k$h.bitmap&&k$h.destroy(k$b))}}},k$C.clearTextureRes=function(k$a){k$a=k$I.formatURL(k$a);var k$b=laya.net.Loader.getAtlas(k$a),k$c=k$b&&0<k$b.length?laya.net.Loader.getRes(k$b[0]):laya.net.Loader.getRes(k$a);k$c&&k$c.bitmap&&(k$J.isConchApp&&!k$J.isConchWebGL?k$c.bitmap.source.releaseTexture&&k$c.bitmap.source.releaseTexture():null==k$c.bitmap._atlaser&&k$c.bitmap.releaseResource(!0))},k$C.getRes=function(k$a){return k$C.loadedMap[k$I.formatURL(k$a)]},k$C.getAtlas=function(k$a){return k$C.atlasMap[k$I.formatURL(k$a)]},k$C.cacheRes=function(k$a,k$b){k$a=k$I.formatURL(k$a),null!=k$C.loadedMap[k$a]?console.warn("Resources already exist,is repeated loading:",k$a):k$C.loadedMap[k$a]=k$b},k$C.setGroup=function(k$a,k$b){k$C.groupMap[k$b]||(k$C.groupMap[k$b]=[]),k$C.groupMap[k$b].push(k$a)},k$C.clearResByGroup=function(k$a){if(k$C.groupMap[k$a]){var k$b=k$C.groupMap[k$a],k$c=0,k$d=k$b.length;for(k$c=0;k$c<k$d;k$c++)k$C.clearRes(k$b[k$c]);k$b.length=0}},k$C.keepCache=function(k$a,k$b){if(k$a&&k$b){var k$c=k$C.cacheSet[k$b];k$c?-1==k$c.indexOf(k$a)&&k$c.push(k$a):k$C.cacheSet[k$b]=[k$a]}},k$C.clearCache=function(k$a,k$b){if(k$a&&k$b){var k$c=k$C.cacheSet[k$b];if(k$c){var k$d=k$c.indexOf(k$a);if(-1!==k$d){var k$e=k$c.length-1;0==k$e?(delete k$C.cacheSet[k$b],0<k$C.imgMgrSet[k$b]?k$g.imgMgrFree(k$b,k$C.imgMgrSet[k$b]):k$C.clearRes(k$b,!0)):(k$c[k$d]=k$c[k$e],k$c.length=k$e)}}}},k$C.saveObject=function(k$a,k$b,k$c){if(k$b&&k$a){var k$d=k$C.objectSet[k$a];k$d?(console.warn("Loader.saveObject: "+k$a),k$d[0]=k$b,k$d[1]=k$c):k$C.objectSet[k$a]=[k$b,k$c,[]]}},k$C.findObject=function(k$a){if(k$a){var k$b=k$C.objectSet[k$a];if(k$b)return k$b[0]}return null},k$C.keepObject=function(k$a,k$b){if(k$a&&k$b){var k$c=k$C.objectSet[k$b];k$c&&-1===k$c[2].indexOf(k$a)&&k$c[2].push(k$a)}},k$C.clearObject=function(k$a,k$b){if(k$a&&k$b){var k$c=k$C.objectSet[k$b];if(k$c){var k$d=k$c[2],k$e=k$d.indexOf(k$a);if(-1!==k$e){var k$f=k$d.length-1;0==k$f?(delete k$C.objectSet[k$b],k$c[1]&&k$c[1].call(null,k$c[0])):(k$d[k$e]=k$d[k$f],k$d.length=k$f)}}}},k$C.TEXT="text",k$C.JSON="json",k$C.XML="xml",k$C.BUFFER="arraybuffer",k$C.IMAGE="image",k$C.SOUND="sound",k$C.ATLAS="atlas",k$C.FONT="font",k$C.TTF="ttf",k$C.PLF="plf",k$C.PKM="pkm",k$C.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},k$C.parserMap={},k$C.groupMap={},k$C.maxTimeOut=100,k$C.loadedMap={},k$C.preLoadedMap={},k$C.atlasMap={},k$C._loaders=[],k$C._isWorking=!1,k$C._startIndex=0,k$C.imgCache={},k$C.cacheSet={},k$C.objectSet={},k$C.imgMgrSet={},k$C}(),k$ia=function(k$a){var k$m;function k$n(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},k$n.__super.call(this);for(var k$a=0;k$a<this._maxPriority;k$a++)this._resInfos[k$a]=[]}k$k(k$n,"laya.net.LoaderManager",k$j);var k$b=k$n.prototype;return k$b.create=function(k$a,k$c,k$b,k$d,k$e,k$f,k$g,k$h){if(null==k$f&&(k$f=2),null==k$g&&(k$g=!0),k$a instanceof Array){var k$i=k$a,k$j=k$i.length,k$k=0;if(k$b)var k$l=k$s.create(k$b.caller,k$b.method,k$b.args,!1);for(var k$m=0;k$m<k$j;k$m++){var k$n=k$i[k$m];"string"==typeof k$n&&(k$n=k$i[k$m]={url:k$n}),k$n.progress=0}for(k$m=0;k$m<k$j;k$m++){k$n=k$i[k$m];var k$o=k$b?k$s.create(null,k$r,[k$n],!1):null,k$p=k$b||k$c?k$s.create(null,k$q,[k$n]):null;this._create(k$n.url,k$p,k$o,k$n.clas||k$d,k$n.params||k$e,null!=k$n.priority&&0<=k$n.priority?k$n.priority:k$f,k$g,k$n.group||k$h)}function k$q(k$a,k$b){k$k++,k$a.progress=1,k$k===k$j&&k$c&&k$c.run()}function k$r(k$a,k$b){k$a.progress=k$b;for(var k$c=0,k$d=0;k$d<k$j;k$d++){k$c+=k$i[k$d].progress}var k$e=k$c/k$j;k$l.runWith(k$e)}return!0}return this._create(k$a,k$c,k$b,k$d,k$e,k$f,k$g,k$h)},k$b._create=function(k$b,k$c,k$a,k$d,k$e,k$f,k$g,k$h){k$b&&""!=k$b||console.error("加载的url不合法 "+k$b),null==k$f&&(k$f=2),null==k$g&&(k$g=!0);var k$i=k$I.formatURL(k$b),k$j=this.getRes(k$i);if(k$j)!k$j.hasOwnProperty("loaded")||k$j.loaded?(k$a&&k$a.runWith(1),k$c&&k$c.run()):k$c&&k$z.loader._createListener(k$b,k$c.caller,k$c.method,k$c.args,!0,!1);else{var k$k=k$$.getFileExtension(k$b),k$l=k$n.createMap[k$k];if(!k$l)throw new Error("LoaderManager:unknown file("+k$b+") extension with: "+k$k+".");k$d||(k$d=k$l[0]);var k$m=k$l[1];if("atlas"==k$k)this.load(k$b,k$c,k$a,k$m,k$f,k$g);else{k$d===k$ka&&(k$m="htmlimage"),(k$j=k$d?new k$d:null).hasOwnProperty("_loaded")&&(k$j._loaded=!1),k$j._setUrl(k$b),k$h&&k$j._setGroup(k$h),this._createLoad(k$j,k$b,k$s.create(null,function(k$a){k$j&&!k$j.destroyed&&k$a&&k$j.onAsynLoaded.call(k$j,k$b,k$a,k$e),k$c&&k$c.run();k$z.loader.event(k$b)}),k$a,k$m,k$f,!1,k$h,!0),k$g&&this.cacheRes(k$i,k$j)}}return k$j},k$b.load=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){k$a&&""!=k$a||console.error("加载的url不合法 "+k$a);var k$i=this;if(null==k$e&&(k$e=2),null==k$f&&(k$f=!0),void 0===k$h&&(k$h=!1),k$a instanceof Array)return this._loadAssets(k$a,k$b,k$c,k$d,k$e,k$f,k$g);var k$j=k$ha.getRes(k$a);if(null!=k$j)k$z.timer.frameOnce(1,null,function(){k$c&&k$c.runWith(1),k$b&&k$b.runWith(k$j),k$i._loaderCount||k$i.event("complete")});else{var k$k=k$n._resMap[k$a];k$k?(k$b&&k$k._createListener("complete",k$b.caller,k$b.method,k$b.args,!1,!1),k$c&&k$k._createListener("progress",k$c.caller,k$c.method,k$c.args,!1,!1)):((k$k=this._infoPool.length?this._infoPool.pop():new k$m).url=k$a,k$k.type=k$d,k$k.cache=k$f,k$k.group=k$g,k$k.ignoreCache=k$h,k$k.priority=k$e,k$b&&k$k.on("complete",k$b.caller,k$b.method,k$b.args),k$c&&k$k.on("progress",k$c.caller,k$c.method,k$c.args),k$n._resMap[k$a]=k$k,k$e=k$e<this._maxPriority?0<=k$e?k$e:0:this._maxPriority-1,this._resInfos[k$e].push(k$k),this._next())}return this},k$b._createLoad=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){var k$j=this;if(null==k$f&&(k$f=2),null==k$g&&(k$g=!0),void 0===k$i&&(k$i=!1),k$b instanceof Array)return this._loadAssets(k$b,k$c,k$d,k$e,k$f,k$g,k$h);var k$k=k$ha.getRes(k$b);if(null!=k$k)k$z.timer.frameOnce(1,null,function(){k$d&&k$d.runWith(1),k$c&&k$c.runWith(k$k),k$j._loaderCount||k$j.event("complete")});else{var k$l=k$n._resMap[k$b];k$l?(k$c&&k$l._createListener("complete",k$c.caller,k$c.method,k$c.args,!1,!1),k$d&&k$l._createListener("progress",k$d.caller,k$d.method,k$d.args,!1,!1)):((k$l=this._infoPool.length?this._infoPool.pop():new k$m).url=k$b,k$l.clas=k$a,k$l.type=k$e,k$l.cache=k$g,k$l.group=k$h,k$l.ignoreCache=k$i,k$l.priority=k$f,k$c&&k$l.on("complete",k$c.caller,k$c.method,k$c.args),k$d&&k$l.on("progress",k$d.caller,k$d.method,k$d.args),k$n._resMap[k$b]=k$l,k$f=k$f<this._maxPriority?0<=k$f?k$f:0:this._maxPriority-1,this._resInfos[k$f].push(k$l),this._next())}return this},k$b._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var k$a=0;k$a<this._maxPriority;k$a++)for(var k$b=this._resInfos[k$a];0<k$b.length;){var k$c=k$b.shift();if(k$c)return this._doLoad(k$c)}this._loaderCount||this.event("complete")}},k$b._doLoad=function(k$b){this._loaderCount++;var k$c=this._loaders.length?this._loaders.pop():new k$ha;k$c.on("complete",null,k$e),k$c.on("progress",null,function(k$a){k$b.event("progress",k$a)}),k$c.on("error",null,function(k$a){k$e(null)});var k$d=this;function k$e(k$a){k$c.offAll(),k$c._data=null,k$c._customParse=!1,k$d._loaders.push(k$c),k$d._endLoad(k$b,k$a instanceof Array?[k$a]:k$a),k$d._loaderCount--,k$d._next()}k$c._class=k$b.clas,1<=k$b.priority?(k$c.priority=k$b.priority,k$c.realTime=!1):(k$c.priority=0,k$c.realTime=!0),k$c.load(k$b.url,k$b.type,k$b.cache,k$b.group,k$b.ignoreCache)},k$b._endLoad=function(k$a,k$b){var k$c=k$a.url;if(null==k$b){var k$d=this._failRes[k$c]||0;if(k$d<this.retryNum)return console.warn("[warn]Retry to load:",k$c),this._failRes[k$c]=k$d+1,void k$z.timer.once(this.retryDelay,this,this._addReTry,[k$a],!1);console.warn("[error]Failed to load:",k$c),this.event("error",k$c)}this._failRes[k$c]&&(this._failRes[k$c]=0),delete k$n._resMap[k$c],k$a.event("complete",k$b),k$a.offAll(),this._infoPool.push(k$a)},k$b._addReTry=function(k$a){this._resInfos[this._maxPriority-1].push(k$a),this._next()},k$b.clearRes=function(k$a,k$b){void 0===k$b&&(k$b=!1),k$ha.clearRes(k$a,k$b)},k$b.getRes=function(k$a){return k$ha.getRes(k$a)},k$b.cacheRes=function(k$a,k$b){k$ha.cacheRes(k$a,k$b)},k$b.clearTextureRes=function(k$a){k$ha.clearTextureRes(k$a)},k$b.setGroup=function(k$a,k$b){k$ha.setGroup(k$a,k$b)},k$b.clearResByGroup=function(k$a){k$ha.clearResByGroup(k$a)},k$b.clearUnLoaded=function(){for(var k$a=0;k$a<this._maxPriority;k$a++){for(var k$b=this._resInfos[k$a],k$c=k$b.length-1;-1<k$c;k$c--){var k$d=k$b[k$c];k$d&&(k$d.offAll(),this._infoPool.push(k$d))}k$b.length=0}this._loaderCount=0,k$n._resMap={}},k$b.cancelLoadByUrls=function(k$a){if(k$a)for(var k$b=0,k$c=k$a.length;k$b<k$c;k$b++)this.cancelLoadByUrl(k$a[k$b])},k$b.cancelLoadByUrl=function(k$a){for(var k$b=0;k$b<this._maxPriority;k$b++)for(var k$c=this._resInfos[k$b],k$d=k$c.length-1;-1<k$d;k$d--){var k$e=k$c[k$d];k$e&&k$e.url===k$a&&(k$c[k$d]=null,k$e.offAll(),this._infoPool.push(k$e))}k$n._resMap[k$a]&&delete k$n._resMap[k$a]},k$b._loadAssets=function(k$a,k$c,k$g,k$b,k$d,k$e,k$f){null==k$d&&(k$d=2),null==k$e&&(k$e=!0);for(var k$h=k$a.length,k$i=0,k$j=0,k$k=[],k$l=!0,k$m=0;k$m<k$h;k$m++){var k$n=k$a[k$m];if(!k$n)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+k$a);"string"==typeof k$n&&(k$n={url:k$n,type:k$b,size:1,priority:k$d}),k$n.size||(k$n.size=1),k$n.progress=0,k$j+=k$n.size,k$k.push(k$n);var k$o=k$g?k$s.create(null,k$r,[k$n],!1):null,k$p=k$c||k$g?k$s.create(null,k$q,[k$n]):null;this.load(k$n.url,k$p,k$o,k$n.type,null!=k$n.priority&&0<=k$n.priority?k$n.priority:2,k$e,k$n.group||k$f)}function k$q(k$a,k$b){k$i++,k$a.progress=1,k$b||(k$l=!1),k$i===k$h&&k$c&&k$c.runWith(k$l)}function k$r(k$a,k$b){if(null!=k$g){k$a.progress=k$b;for(var k$c=0,k$d=0;k$d<k$k.length;k$d++){var k$e=k$k[k$d];k$c+=k$e.size*k$e.progress}var k$f=k$c/k$j;k$g.runWith(k$f)}}return this},k$n.cacheRes=function(k$a,k$b){k$ha.cacheRes(k$a,k$b)},k$n._resMap={},k$i(k$n,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),k$n.__init$=function(){k$m=function(k$a){function k$b(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,k$b.__super.call(this)}return k$k(k$b,"",k$j),k$b}()},k$n}(),k$ja=(function(k$a){function k$e(k$a){k$e.__super.call(this),k$a||(k$a=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var k$b=0,k$c=0,k$d=0;k$d<20;k$d++)k$d%5!=4?this._mat[k$b++]=k$a[k$d]:this._alpha[k$c++]=k$a[k$d];this._action=k$F.createFilterAction(32),this._action.data=this}k$k(k$e,"laya.filters.ColorFilter",k$r);var k$b=k$e.prototype;k$z.imps(k$b,{"laya.filters.IFilter":!0}),k$b.callNative=function(k$a){k$a._$P.cf=this;k$a.conchModel&&k$a.conchModel.setFilterMatrix&&k$a.conchModel.setFilterMatrix(this._mat,this._alpha)},k$o(0,k$b,"type",function(){return 32}),k$o(0,k$b,"action",function(){return this._action})}(),function(k$a){function k$d(k$a,k$b,k$c){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===k$b&&(k$b=0),k$d.__super.call(this),this._byteClass=k$c||k$P,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,k$a&&0<k$b&&k$b<65535&&this.connect(k$a,k$b)}k$k(k$d,"laya.net.Socket",k$j);var k$b=k$d.prototype;k$b.connect=function(k$a,k$b){var k$c="ws://"+k$a+":"+k$b;k$c="https:"==k$O.window.location.protocol?"wss://"+k$a+":"+k$b:"ws://"+k$a+":"+k$b,this.connectByUrl(k$c)},k$b.connectByUrl=function(k$a){var k$b=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new k$O.window.WebSocket(k$a,this.protocols):this._socket=new k$O.window.WebSocket(k$a),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(k$a){k$b._onOpen(k$a)},this._socket.onmessage=function(k$a){k$b._onMessage(k$a)},this._socket.onclose=function(k$a){k$b._onClose(k$a)},this._socket.onerror=function(k$a){k$b._onError(k$a)}},k$b.cleanSocket=function(){try{this._socket.close()}catch(k$a){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},k$b.close=function(){if(null!=this._socket)try{this._socket.close()}catch(k$a){}},k$b._onOpen=function(k$a){this._connected=!0,this.event("open",k$a)},k$b._onMessage=function(k$a){if(k$a&&k$a.data){var k$b=k$a.data;if(this.disableInput&&k$b)this.event("message",k$b);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var k$c=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,k$b&&("string"==typeof k$b?this._input.writeUTFBytes(k$b):this._input.writeArrayBuffer(k$b),this._addInputPosition=this._input.pos,this._input.pos=k$c),this.event("message",k$b)}}},k$b._onClose=function(k$a){this._connected=!1,this.event("close",k$a)},k$b._onError=function(k$a){this.event("error",k$a)},k$b.send=function(k$a){this._socket.send(k$a)},k$b.flush=function(){if(this._output&&0<this._output.length){var k$b;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(k$a){k$b=k$a}this._output.endian=this.endian,this._output.clear(),k$b&&this.event("error",k$b)}},k$o(0,k$b,"input",function(){return this._input}),k$o(0,k$b,"output",function(){return this._output}),k$o(0,k$b,"connected",function(){return this._connected}),k$o(0,k$b,"endian",function(){return this._endian},function(k$a){this._endian=k$a,null!=this._input&&(this._input.endian=k$a),null!=this._output&&(this._output.endian=k$a)}),k$d.LITTLE_ENDIAN="littleEndian",k$d.BIG_ENDIAN="bigEndian"}(),function(k$a){function k$h(){k$h.__super.call(this),this._$1__id=++k$h._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(k$h._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,k$N.currentResourceManager&&k$N.currentResourceManager.addResource(this)}k$k(k$h,"laya.resource.Resource",k$j);var k$b=k$h.prototype;return k$z.imps(k$b,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),k$b._setUrl=function(k$a){var k$b;this._url!==k$a&&(this._url&&((k$b=k$h._urlResourcesMap[this._url]).splice(k$b.indexOf(this),1),0===k$b.length&&delete k$h._urlResourcesMap[this._url]),k$a&&((k$b=k$h._urlResourcesMap[k$a])||(k$h._urlResourcesMap[k$a]=k$b=[]),k$b.push(this)),this._url=k$a)},k$b._getGroup=function(){return this._group},k$b._setGroup=function(k$a){var k$b;this._group!==k$a&&(this._group&&((k$b=k$h._groupResourcesMap[this._group]).splice(k$b.indexOf(this),1),0===k$b.length&&delete k$h._groupResourcesMap[this._group]),k$a&&((k$b=k$h._groupResourcesMap[k$a])||(k$h._groupResourcesMap[k$a]=k$b=[]),k$b.push(this)),this._group=k$a)},k$b._addReference=function(){this._referenceCount++},k$b._removeReference=function(){this._referenceCount--},k$b._clearReference=function(){this._referenceCount=0},k$b._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},k$b.recreateResource=function(){this.completeCreate()},k$b.disposeResource=function(){},k$b.activeResource=function(k$a){void 0===k$a&&(k$a=!1),this._lastUseFrameCount=k$X.loopCount,!this._destroyed&&this.__loaded&&(this._released||k$a)&&this.recreateResource()},k$b.releaseResource=function(k$a){return void 0===k$a&&(k$a=!0),!(!k$a&&this.lock)&&(!(this._released&&!k$a)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},k$b.onAsynLoaded=function(k$a,k$b,k$c){throw new Error("Resource: must override this function!")},k$b.destroy=function(){var k$a;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete k$h._idResourcesMap[this.id],this._url&&((k$a=k$h._urlResourcesMap[this._url])&&(k$a.splice(k$a.indexOf(this),1),0===k$a.length&&delete k$h._urlResourcesMap[this.url]),k$ha.clearRes(this._url),this.__loaded||k$F.cancelLoadByUrl(this._url)),this._group&&((k$a=k$h._groupResourcesMap[this._group]).splice(k$a.indexOf(this),1),0===k$a.length&&delete k$h._groupResourcesMap[this.url]))},k$b.completeCreate=function(){this._released=!1,this.event("recovered",this)},k$b.dispose=function(){this.destroy()},k$o(0,k$b,"memorySize",function(){return this._memorySize},function(k$a){var k$b=k$a-this._memorySize;this._memorySize=k$a,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,k$b),this.resourceManager&&this.resourceManager.addSize(k$b)}),k$o(0,k$b,"_loaded",null,function(k$a){this.__loaded=k$a}),k$o(0,k$b,"loaded",function(){return this.__loaded}),k$o(0,k$b,"id",function(){return this._$1__id}),k$o(0,k$b,"destroyed",function(){return this._destroyed}),k$o(0,k$b,"group",function(){return this._getGroup()},function(k$a){this._setGroup(k$a)}),k$o(0,k$b,"resourceManager",function(){return this._resourceManager}),k$o(0,k$b,"url",function(){return this._url}),k$o(0,k$b,"released",function(){return this._released}),k$o(0,k$b,"referenceCount",function(){return this._referenceCount}),k$h.getResourceByID=function(k$a){return k$h._idResourcesMap[k$a]},k$h.getResourceByURL=function(k$a,k$b){return void 0===k$b&&(k$b=0),null==k$h._urlResourcesMap[k$a]?null:k$h._urlResourcesMap[k$a][k$b]},k$h.getResourceCountByURL=function(k$a){return k$h._urlResourcesMap[k$a].length},k$h.destroyUnusedResources=function(k$a){var k$b;if(k$a){var k$c=k$h._groupResourcesMap[k$a];if(k$c)for(var k$d=k$c.slice(),k$e=0,k$f=k$d.length;k$e<k$f;k$e++)(k$b=k$d[k$e]).lock||0!==k$b._referenceCount||k$b.destroy()}else for(var k$g in k$h._idResourcesMap)(k$b=k$h._idResourcesMap[k$g]).lock||0!==k$b._referenceCount||k$b.destroy()},k$h._uniqueIDCounter=0,k$h._idResourcesMap={},k$h._urlResourcesMap={},k$h._groupResourcesMap={},k$h}()),k$ka=function(k$a){function k$C(k$a,k$b){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,k$C.__super.call(this),k$a&&null!=k$a._addReference&&k$a._addReference(),this.setTo(k$a,k$b)}k$k(k$C,"laya.resource.Texture",k$j);var k$b=k$C.prototype;return k$b._setUrl=function(k$a){this.url=k$a},k$b.setTo=function(k$a,k$b){if(k$a instanceof k$g.HTMLElement){var k$c=k$ta.create("2D",k$a);this.bitmap=k$c}else this.bitmap=k$a;if(this.uv=k$b||k$C.DEF_UV,k$a){this._w=k$a.width,this._h=k$a.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var k$d=this;if(this._loaded)k$F.addToAtlas&&k$F.addToAtlas(k$d);else{var k$e=k$a;k$e instanceof laya.resource.HTMLImage&&k$e.image&&k$e.image.addEventListener("load",function(k$a){k$F.addToAtlas&&k$F.addToAtlas(k$d)},!1)}}},k$b.active=function(){this.bitmap&&this.bitmap.activeResource()},k$b.destroy=function(k$a){if(void 0===k$a&&(k$a=!1),this.alphaTexture&&(this.alphaTexture.destroy(k$a),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var k$b=this.bitmap;k$a?(k$J.isConchApp&&k$b.source&&k$b.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,k$b.dispose(),k$b._clearReference()):(k$b._removeReference(),0==k$b.referenceCount&&(k$J.isConchApp&&k$b.source&&k$b.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,k$b.dispose())),this.url&&this===k$z.loader.getRes(this.url)&&k$z.loader.clearRes(this.url,k$a),this._loaded=!1}},k$b.load=function(k$a){var k$b=this;this._loaded=!1,k$a=k$I.customFormat(k$a);var k$c=this.bitmap||(this.bitmap=k$ya.create(k$a));k$c.uri=k$a,k$c&&k$c._addReference();var k$d=this;k$c.onload=function(){k$c.onload=null,k$d._loaded=!0,k$b.sourceWidth=k$b._w=k$c.width,k$b.sourceHeight=k$b._h=k$c.height,k$d.event("loaded",this),k$F.addToAtlas&&k$F.addToAtlas(k$d)}},k$b.addTextureToAtlas=function(k$a){k$F.addTextureToAtlas(this)},k$b.getPixels=function(k$a,k$b,k$c,k$d){if(k$J.isConchApp){var k$e=this.bitmap;if(k$e.source&&k$e.source.getImageData){var k$f=k$e.source.getImageData(k$a,k$b,k$c,k$d),k$g=new Uint8Array(k$f);return Array.from(k$g)}return null}return k$J.isWebGL?k$F.getTexturePixels(this,k$a,k$b,k$c,k$d):(k$O.canvas.size(k$c,k$d),k$O.canvas.clear(),k$O.context.drawTexture(this,-k$a,-k$b,this.width,this.height,0,0),k$O.context.getImageData(0,0,k$c,k$d).data)},k$b.onAsynLoaded=function(k$a,k$b){if(k$b){if("function"!=typeof k$b._addReference)throw new Error("bitmap._addReference is not a function. "+k$b.className+" "+typeof k$b._addReference+" "+k$b.constructor);k$b._addReference()}this.setTo(k$b,this.uv),this._loaded&&this.event("loaded",this)},k$o(0,k$b,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),k$o(0,k$b,"loaded",function(){return this._loaded}),k$o(0,k$b,"released",function(){return!this.bitmap||this.bitmap.released}),k$o(0,k$b,"width",function(){return this._w?this._w:this.uv&&this.uv!==k$C.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(k$a){this._w=k$a,this.sourceWidth||(this.sourceWidth=k$a)}),k$o(0,k$b,"repeat",function(){return!k$J.isWebGL||!this.bitmap||this.bitmap.repeat},function(k$a){k$a&&k$J.isWebGL&&this.bitmap&&(this.bitmap.repeat=k$a)&&(this.bitmap.enableMerageInAtlas=!1)}),k$o(0,k$b,"height",function(){return this._h?this._h:this.uv&&this.uv!==k$C.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(k$a){this._h=k$a,this.sourceHeight||(this.sourceHeight=k$a)}),k$o(0,k$b,"isLinearSampling",function(){return!k$J.isWebGL||9728!=this.bitmap.minFifter},function(k$a){!k$a&&k$J.isWebGL&&(k$a||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),k$C.moveUV=function(k$a,k$b,k$c){for(var k$d=0;k$d<8;k$d+=2)k$c[k$d]+=k$a,k$c[k$d+1]+=k$b;return k$c},k$C.create=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){void 0===k$f&&(k$f=0),void 0===k$g&&(k$g=0),void 0===k$h&&(k$h=0),void 0===k$i&&(k$i=0);var k$j=k$a instanceof laya.resource.Texture,k$k=k$j?k$a.uv:k$C.DEF_UV,k$l=k$j?k$a.bitmap:k$a,k$m=k$F.isAtlas(k$l);if(k$m){var k$n=k$l._atlaser,k$o=k$a._atlasID;if(-1==k$o)throw new Error("create texture error");k$l=k$n._inAtlasTextureBitmapValue[k$o],k$k=k$n._inAtlasTextureOriUVValue[k$o]}var k$p=new k$C(k$l,null);k$l.width&&k$b+k$d>k$l.width&&(k$d=k$l.width-k$b),k$l.height&&k$c+k$e>k$l.height&&(k$e=k$l.height-k$c),k$p.width=k$d,k$p.height=k$e,k$p.offsetX=k$f,k$p.offsetY=k$g,k$p.sourceWidth=k$h||k$d,k$p.sourceHeight=k$i||k$e;var k$q=1/k$l.width,k$r=1/k$l.height;k$b*=k$q,k$c*=k$r,k$d*=k$q,k$e*=k$r;var k$s=k$p.uv[0],k$t=k$p.uv[1],k$w=k$p.uv[4],k$x=k$p.uv[5],k$y=k$w-k$s,k$z=k$x-k$t,k$A=k$C.moveUV(k$k[0],k$k[1],[k$b,k$c,k$b+k$d,k$c,k$b+k$d,k$c+k$e,k$b,k$c+k$e]);k$p.uv=[k$s+k$A[0]*k$y,k$t+k$A[1]*k$z,k$w-(1-k$A[2])*k$y,k$t+k$A[3]*k$z,k$w-(1-k$A[4])*k$y,k$x-(1-k$A[5])*k$z,k$s+k$A[6]*k$y,k$x-(1-k$A[7])*k$z],k$m&&k$p.addTextureToAtlas();var k$B=k$l.scaleRate;return k$B&&1!=k$B?(k$p.sourceWidth/=k$B,k$p.sourceHeight/=k$B,k$p.width/=k$B,k$p.height/=k$B,k$p.scaleRate=k$B,k$p.offsetX/=k$B,k$p.offsetY/=k$B):k$p.scaleRate=1,k$p},k$C.createFromTexture=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$a.scaleRate;1!=k$f&&(k$b*=k$f,k$c*=k$f,k$d*=k$f,k$e*=k$f);var k$g=k$B.TEMP.setTo(k$b-k$a.offsetX,k$c-k$a.offsetY,k$d,k$e),k$h=k$g.intersection(k$C._rect1.setTo(0,0,k$a.width,k$a.height),k$C._rect2);if(!k$h)return null;var k$i=k$C.create(k$a,k$h.x,k$h.y,k$h.width,k$h.height,k$h.x-k$g.x,k$h.y-k$g.y,k$d,k$e);if(k$i.bitmap&&k$i.bitmap._removeReference)return k$i.bitmap._removeReference(),k$i;var k$j="bitmap:"+(k$i.bitmap?k$i.bitmap.constructor?k$i.bitmap.constructor.name:k$i.bitmap.__className:"")+", url:"+(k$a.url+" | "+(k$i.bitmap?k$i.bitmap.url:k$a.url))+", x="+k$b+",y="+k$c+",width="+k$d+",height="+k$e+", result="+(k$h?k$h.x+","+k$h.y+","+k$h.width+","+k$h.height:"null")+", rect="+k$g.x+","+k$g.y+","+k$g.width+","+k$g.height;throw new Error("报错：bitmap._removeReference is not a function  "+k$j)},k$C.DEF_UV=[0,0,1,0,1,1,0,1],k$C.INV_UV=[0,1,1,1,1,0,0,0],k$C._rect1=new k$B,k$C._rect2=new k$B,k$C}(),k$a=function(k$a){var k$h;function k$f(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,k$f.__super.call(this)}k$k(k$f,"laya.utils.TimeLine",k$j);var k$b=k$f.prototype;return k$b.to=function(k$a,k$b,k$c,k$d,k$e){return void 0===k$e&&(k$e=0),this._create(k$a,k$b,k$c,k$d,k$e,!0)},k$b.from=function(k$a,k$b,k$c,k$d,k$e){return void 0===k$e&&(k$e=0),this._create(k$a,k$b,k$c,k$d,k$e,!1)},k$b._create=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=k$W.getItemByClass("tweenData",k$h);return k$g.isTo=k$f,k$g.type=0,k$g.target=k$a,k$g.duration=k$c,k$g.data=k$b,k$g.startTime=this._startTime+k$e,k$g.endTime=k$g.startTime+k$g.duration,k$g.ease=k$d,this._startTime=Math.max(k$g.endTime,this._startTime),this._tweenDataList.push(k$g),this._startTimeSort=!0,this._endTimeSort=!0,this},k$b.addLabel=function(k$a,k$b){var k$c=k$W.getItemByClass("tweenData",k$h);return k$c.type=1,k$c.data=k$a,k$c.endTime=k$c.startTime=this._startTime+k$b,this._labelDic||(this._labelDic={}),this._labelDic[k$a]=k$c,this._tweenDataList.push(k$c),this},k$b.removeLabel=function(k$a){if(this._labelDic&&this._labelDic[k$a]){var k$b=this._labelDic[k$a];if(k$b){var k$c=this._tweenDataList.indexOf(k$b);-1<k$c&&this._tweenDataList.splice(k$c,1)}delete this._labelDic[k$a]}},k$b.gotoTime=function(k$a){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var k$b,k$c,k$d,k$e;for(var k$f in this._firstTweenDic)if(k$c=this._firstTweenDic[k$f])for(var k$g in k$c)k$c.diyTarget.hasOwnProperty(k$g)&&(k$c.diyTarget[k$g]=k$c[k$g]);for(k$f in this._tweenDic)(k$b=this._tweenDic[k$f]).clear(),delete this._tweenDic[k$f];if(this._index=0,this._gidIndex=0,this._currTime=k$a,this._lastTime=k$O.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=k$d=this._tweenDataList.concat(),k$d.sort(function(k$a,k$b){return k$a.endTime>k$b.endTime?1:k$a.endTime<k$b.endTime?-1:0})}else k$d=this._endTweenDataList;for(var k$h=0,k$i=k$d.length;k$h<k$i;k$h++)if(0==(k$e=k$d[k$h]).type){if(!(k$a>=k$e.endTime))break;this._index=Math.max(this._index,k$h+1);var k$j=k$e.data;if(k$e.isTo)for(var k$k in k$j)k$e.target[k$k]=k$j[k$k]}for(k$h=0,k$i=this._tweenDataList.length;k$h<k$i;k$h++)0==(k$e=this._tweenDataList[k$h]).type&&k$a>=k$e.startTime&&k$a<k$e.endTime&&(this._index=Math.max(this._index,k$h+1),this._gidIndex++,(k$b=k$W.getItemByClass("tween",k$Z))._create(k$e.target,k$e.data,k$e.duration,k$e.ease,k$s.create(this,this._animComplete,[this._gidIndex]),0,!1,k$e.isTo,!0,!1),k$b.setStartTime(this._currTime-(k$a-k$e.startTime)),k$b._updateEase(this._currTime),k$b.gid=this._gidIndex,this._tweenDic[this._gidIndex]=k$b)}},k$b.gotoLabel=function(k$a){if(null!=this._labelDic){var k$b=this._labelDic[k$a];k$b&&this.gotoTime(k$b.startTime)}},k$b.pause=function(){k$z.timer.clear(this,this._update)},k$b.resume=function(){this.play(this._currTime,this._loopKey)},k$b.play=function(k$a,k$b){if(void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(k$a,k$b){return k$a.startTime>k$b.startTime?1:k$a.startTime<k$b.startTime?-1:0});for(var k$c=0,k$d=this._tweenDataList.length;k$c<k$d;k$c++){var k$e=this._tweenDataList[k$c];if(null!=k$e&&0==k$e.type){var k$f=k$e.target,k$g=k$f.$_GID||(k$f.$_GID=k$$.getGID()),k$h=null;for(var k$i in null==this._firstTweenDic[k$g]?((k$h={}).diyTarget=k$f,this._firstTweenDic[k$g]=k$h):k$h=this._firstTweenDic[k$g],k$e.data)null==k$h[k$i]&&(k$h[k$i]=k$f[k$i])}}}"string"==typeof k$a?this.gotoLabel(k$a):this.gotoTime(k$a),this._loopKey=k$b,this._lastTime=k$O.now(),k$z.timer.frameLoop(1,this,this._update)}},k$b._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var k$a in this._tweenDic)(k$b=this._tweenDic[k$a]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var k$b,k$c=k$O.now(),k$d=k$c-this._lastTime,k$e=this._currTime+=k$d*this.scale;for(k$a in this._lastTime=k$c,this._tweenDic)(k$b=this._tweenDic[k$a])._updateEase(k$e);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var k$f=this._tweenDataList[this._index];k$e>=k$f.startTime&&(this._index++,0==k$f.type?(this._gidIndex++,(k$b=k$W.getItemByClass("tween",k$Z))._create(k$f.target,k$f.data,k$f.duration,k$f.ease,k$s.create(this,this._animComplete,[this._gidIndex]),0,!1,k$f.isTo,!0,!1),k$b.setStartTime(k$e),k$b.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=k$b)._updateEase(k$e)):this.event("label",k$f.data))}},k$b._animComplete=function(k$a){this._tweenDic[k$a]&&delete this._tweenDic[k$a]},k$b._complete=function(){this.event("complete")},k$b.reset=function(){var k$a;if(this._labelDic)for(k$a in this._labelDic)delete this._labelDic[k$a];for(k$a in this._tweenDic)this._tweenDic[k$a].clear(),delete this._tweenDic[k$a];for(k$a in this._firstTweenDic)delete this._firstTweenDic[k$a];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var k$b,k$c=0;for(k$b=this._tweenDataList.length,k$c=0;k$c<k$b;k$c++)this._tweenDataList[k$c]&&this._tweenDataList[k$c].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,k$z.timer.clear(this,this._update)},k$b.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},k$o(0,k$b,"index",function(){return this._frameIndex},function(k$a){this._frameIndex=k$a,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),k$o(0,k$b,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),k$f.to=function(k$a,k$b,k$c,k$d,k$e){return void 0===k$e&&(k$e=0),(new k$f).to(k$a,k$b,k$c,k$d,k$e)},k$f.from=function(k$a,k$b,k$c,k$d,k$e){return void 0===k$e&&(k$e=0),(new k$f).from(k$a,k$b,k$c,k$d,k$e)},k$f.__init$=function(){k$h=function(){function k$a(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return k$k(k$a,""),k$a.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,k$W.recover("tweenData",this)},k$a}()},k$f}(),k$la=function(k$e){function k$c(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,k$c.__super.call(this),this._style=k$h.EMPTY}k$k(k$c,"laya.display.Sprite",k$e);var k$a=k$c.prototype;return k$z.imps(k$a,{"laya.display.ILayout":!0}),k$a.createConchModel=function(){return new ConchNode},k$a.destroy=function(k$a){if(void 0===k$a&&(k$a=!0),this._releaseMem(),!this._destroyed){this.filters=null;var k$b=this.mask;k$b&&(this.mask=null,k$b.destroy(k$a))}k$e.prototype.destroy.call(this,k$a),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},k$a.updateZOrder=function(){k$$.updateOrder(this._childs)&&this.repaint()},k$a.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},k$a.setBounds=function(k$a){this._set$P("uBounds",k$a)},k$a.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new k$B),k$B._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},k$a.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new k$B),k$B._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},k$a._boundPointsToParent=function(k$a){void 0===k$a&&(k$a=!1);var k$b=0,k$c=0;this._style&&(k$b=this._style._tf.translateX,k$c=this._style._tf.translateY,k$a=k$a||0!==this._style._tf.rotate,this._style.scrollRect&&(k$b+=this._style.scrollRect.x,k$c+=this._style.scrollRect.y));var k$d=this._getBoundPointsM(k$a);if(!k$d||k$d.length<1)return k$d;if(8!=k$d.length&&(k$d=k$a?k$x.scanPList(k$d):k$B._getWrapRec(k$d,k$B.TEMP)._getBoundPoints()),!this.transform)return k$$.transPointList(k$d,this._x-k$b,this._y-k$c),k$d;var k$e=k$A.TEMP,k$f=0,k$g=k$d.length;for(k$f=0;k$f<k$g;k$f+=2)k$e.x=k$d[k$f],k$e.y=k$d[k$f+1],this.toParentPoint(k$e),k$d[k$f]=k$e.x,k$d[k$f+1]=k$e.y;return k$d},k$a.getGraphicBounds=function(k$a){return void 0===k$a&&(k$a=!1),this._graphics?this._graphics.getBounds(k$a):k$B.TEMP.setTo(0,0,0,0)},k$a._getBoundPointsM=function(k$a){if(void 0===k$a&&(k$a=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var k$b=k$$.clearArray(this._$P.temBM),k$c=k$B.TEMP;return k$c.copyFrom(this.scrollRect),k$$.concatArray(k$b,k$c._getBoundPoints()),k$b}for(var k$d,k$e,k$f,k$g=this._graphics?this._graphics.getBoundPoints():k$$.clearArray(this._$P.temBM),k$h=0,k$i=(k$f=this._childs).length;k$h<k$i;k$h++)(k$d=k$f[k$h])instanceof laya.display.Sprite&&1==k$d.visible&&(k$e=k$d._boundPointsToParent(k$a))&&(k$g=k$g?k$$.concatArray(k$g,k$e):k$e);return k$g},k$a.getStyle=function(){return this._style===k$h.EMPTY&&(this._style=new k$h),this._style},k$a.setStyle=function(k$a){this._style=k$a},k$a._adjustTransform=function(){this._tfChanged=!1;var k$a,k$b=this._style._tf,k$c=k$b.scaleX,k$d=k$b.scaleY;if(k$b.rotate||1!==k$c||1!==k$d||k$b.skewX||k$b.skewY){(k$a=this._transform||(this._transform=k$G.create())).bTransform=!0;var k$e=.0174532922222222*(k$b.rotate-k$b.skewX),k$f=.0174532922222222*(k$b.rotate+k$b.skewY),k$g=Math.cos(k$f),k$h=Math.sin(k$f),k$i=Math.sin(k$e),k$j=Math.cos(k$e);return k$a.a=k$c*k$g,k$a.b=k$c*k$h,k$a.c=-k$d*k$i,k$a.d=k$d*k$j,k$a.tx=k$a.ty=0,k$a}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,k$a},k$a.pos=function(k$a,k$b,k$c){if(void 0===k$c&&(k$c=!1),this._x!==k$a||this._y!==k$b){if(this.destroyed)return this;if(k$c){this._x=k$a,this._y=k$b,this.conchModel&&this.conchModel.pos(this._x,this._y);var k$d=this._parent;k$d&&0===k$d._repaint&&(k$d._repaint=1,k$d.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=k$a,this.y=k$b}return this},k$a.pivot=function(k$a,k$b){return this.pivotX=k$a,this.pivotY=k$b,this},k$a.size=function(k$a,k$b){return this.width=k$a,this.height=k$b,this},k$a.scale=function(k$a,k$b,k$c){void 0===k$c&&(k$c=!1);var k$d=this.getStyle(),k$e=k$d._tf;if(k$e.scaleX!=k$a||k$e.scaleY!=k$b){if(this.destroyed)return this;if(k$c){k$d.setScale(k$a,k$b),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(k$a,k$b),this._renderType|=4;var k$f=this._parent;k$f&&0===k$f._repaint&&(k$f._repaint=1,k$f.parentRepaint())}else this.scaleX=k$a,this.scaleY=k$b}return this},k$a.skew=function(k$a,k$b){return this.skewX=k$a,this.skewY=k$b,this},k$a.render=function(k$a,k$b,k$c){k$X.spriteCount++,k$L.renders[this._renderType]._fun(this,k$a,k$b+this._x,k$c+this._y),this._repaint=0},k$a.drawToCanvas=function(k$a,k$b,k$c,k$d){if(k$J.isConchNode){var k$e=k$ta.create("2D");return new k$K(k$a,k$b,k$e).ctx.setCanvasType(1),this.conchModel.drawToCanvas(k$e.source,k$c,k$d),k$e}return k$F.drawToCanvas(this,this._renderType,k$a,k$b,k$c,k$d)},k$a.customRender=function(k$a,k$b,k$c){this._renderType|=1024},k$a._applyFilters=function(){var k$a;if(!k$J.isWebGL&&((k$a=this._$P.filters)&&!(k$a.length<1)))for(var k$b=0,k$c=k$a.length;k$b<k$c;k$b++)k$a[k$b].action.apply(this._$P.cacheCanvas)},k$a._isHaveGlowFilter=function(){var k$a,k$b=0;if(this.filters)for(k$b=0;k$b<this.filters.length;k$b++)if(8==this.filters[k$b].type)return!0;for(k$b=0,k$a=this._childs.length;k$b<k$a;k$b++)if(this._childs[k$b]._isHaveGlowFilter())return!0;return!1},k$a.localToGlobal=function(k$a,k$b){void 0===k$b&&(k$b=!1),!0===k$b&&(k$a=new k$A(k$a.x,k$a.y));for(var k$c=this;k$c&&k$c!=k$z.stage;)k$a=k$c.toParentPoint(k$a),k$c=k$c.parent;return k$a},k$a.globalToLocal=function(k$a,k$b){void 0===k$b&&(k$b=!1),k$b&&(k$a=new k$A(k$a.x,k$a.y));for(var k$c=this,k$d=[];k$c&&k$c!=k$z.stage;)k$d.push(k$c),k$c=k$c.parent;for(var k$e=k$d.length-1;0<=k$e;)k$a=(k$c=k$d[k$e]).fromParentPoint(k$a),k$e--;return k$a},k$a.toParentPoint=function(k$a){if(!k$a)return k$a;k$a.x-=this.pivotX,k$a.y-=this.pivotY,this.transform&&this._transform.transformPoint(k$a),k$a.x+=this._x,k$a.y+=this._y;var k$b=this._style.scrollRect;return k$b&&(k$a.x-=k$b.x,k$a.y-=k$b.y),k$a},k$a.fromParentPoint=function(k$a){if(!k$a)return k$a;k$a.x-=this._x,k$a.y-=this._y;var k$b=this._style.scrollRect;return k$b&&(k$a.x+=k$b.x,k$a.y+=k$b.y),this.transform&&this._transform.invertTransformPoint(k$a),k$a.x+=this.pivotX,k$a.y+=this.pivotY,k$a},k$a.on=function(k$a,k$b,k$c,k$d){return 1!==this._mouseEnableState&&this.isMouseEvent(k$a)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(k$a,k$b,k$c,k$d,!1)):k$e.prototype.on.call(this,k$a,k$b,k$c,k$d)},k$a.once=function(k$a,k$b,k$c,k$d){return 1!==this._mouseEnableState&&this.isMouseEvent(k$a)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(k$a,k$b,k$c,k$d,!0)):k$e.prototype.once.call(this,k$a,k$b,k$c,k$d)},k$a._$2__onDisplay=function(){if(1!==this._mouseEnableState){var k$a=this;for(k$a=k$a.parent;k$a&&1!==k$a._mouseEnableState&&!k$a._getBit(2);)k$a.mouseEnabled=!0,k$a._setBit(2,!0),k$a=k$a.parent}},k$a.loadImage=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=this;return void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=0),void 0===k$e&&(k$e=0),this.graphics.loadImage(k$a,k$b,k$c,k$d,k$e,function(k$a){k$g.destroyed||(k$g.size(k$b+(k$d||k$a.width),k$c+(k$e||k$a.height)),k$g.repaint(),k$f&&k$f.runWith(k$a))}),this},k$a.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},k$a._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},k$a._childChanged=function(k$a){this._childs.length?this._renderType|=2048:this._renderType&=-2049,k$a&&this._get$P("hasZorder")&&k$z.timer.callLater(this,this.updateZOrder),this.repaint()},k$a.parentRepaint=function(){var k$a=this._parent;k$a&&0===k$a._repaint&&(k$a._repaint=1,k$a.parentRepaint())},k$a.startDrag=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){void 0===k$b&&(k$b=!1),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=300),void 0===k$f&&(k$f=!1),void 0===k$g&&(k$g=.92),this._$P.dragging||this._set$P("dragging",new k$T),this._$P.dragging.start(this,k$a,k$b,k$c,k$d,k$e,k$f,k$g)},k$a.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},k$a._releaseMem=function(){if(this._$P){var k$a=this._$P.cacheCanvas;k$a&&k$a.ctx&&(k$W.recover("RenderContext",k$a.ctx),k$a.ctx.canvas.size(0,0),k$a.ctx=null);var k$b=this._$P._filterCache;k$b&&(k$b.destroy(),k$b.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},k$a._setDisplay=function(k$a){k$a||this._releaseMem(),k$e.prototype._setDisplay.call(this,k$a)},k$a.hitTestPoint=function(k$a,k$b){var k$c=this.globalToLocal(k$A.TEMP.setTo(k$a,k$b));return k$a=k$c.x,k$b=k$c.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?k$B.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(k$a,k$b)},k$a.getMousePoint=function(){return this.globalToLocal(k$A.TEMP.setTo(k$z.stage.mouseX,k$z.stage.mouseY))},k$a._getWords=function(){return null},k$a._addChildsToLayout=function(k$a){var k$b=this._getWords();if(null==k$b&&0==this._childs.length)return!1;if(k$b)for(var k$c=0,k$d=k$b.length;k$c<k$d;k$c++)k$a.push(k$b[k$c]);k$c=0;for(var k$e=this._childs.length;k$c<k$e;++k$c){var k$f=this._childs[k$c];k$f._style._enableLayout()&&k$f._addToLayout(k$a)}return!0},k$a._addToLayout=function(k$a){this._style.absolute||(this._style.block?k$a.push(this):this._addChildsToLayout(k$a)&&(this.x=this.y=0))},k$a._isChar=function(){return!1},k$a._getCSSStyle=function(){return this._style.getCSSStyle()},k$a._setAttributes=function(k$a,k$b){switch(k$a){case"x":this.x=parseFloat(k$b);break;case"y":this.y=parseFloat(k$b);break;case"width":this.width=parseFloat(k$b);break;case"height":this.height=parseFloat(k$b);break;default:this[k$a]=k$b}},k$a._layoutLater=function(){this.parent&&this.parent._layoutLater()},k$o(0,k$a,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(k$a){this._optimizeScrollRect!=k$a&&(this._optimizeScrollRect=k$a,this.conchModel&&this.conchModel.optimizeScrollRect(k$a))}),k$o(0,k$a,"customRenderEnable",null,function(k$a){if(k$a&&(this._renderType|=1024,k$J.isConchNode)){k$c.CustomList.push(this);var k$b=new k$ta("2d");k$b._setContext(new CanvasRenderingContext2D),this.customContext=new k$K(0,0,k$b),k$b.context.setCanvasType&&k$b.context.setCanvasType(2),this.conchModel.custom(k$b.context)}}),k$o(0,k$a,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(k$a){this.cacheAs=k$a?this._$P.hasFilter?"none":"normal":"none"}),k$o(0,k$a,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(k$a){var k$b=this._$P.cacheCanvas;if(k$a!==(k$b?k$b.type:"none")){if("none"!==k$a)this._getBit(1)||this._setUpNoticeType(1),k$b||(k$b=this._set$P("cacheCanvas",k$W.getItemByClass("cacheCanvas",Object))),k$b.type=k$a,k$b.reCache=!0,this._renderType|=16,"bitmap"==k$a&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(k$b){var k$c=k$b;k$c&&k$c.ctx&&(k$W.recover("RenderContext",k$c.ctx),k$c.ctx.canvas.size(0,0),k$c.ctx=null),k$W.recover("cacheCanvas",k$b)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),k$o(0,k$a,"zOrder",function(){return this._zOrder},function(k$a){this._zOrder!=k$a&&(this._zOrder=k$a,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(k$a),this._parent&&(k$a&&this._parent._set$P("hasZorder",!0),k$z.timer.callLater(this._parent,this.updateZOrder)))}),k$o(0,k$a,"rotation",function(){return this._style._tf.rotate},function(k$a){var k$b=this.getStyle();if(k$b._tf.rotate!==k$a){k$b.setRotate(k$a),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(k$a),this._renderType|=4;var k$c=this._parent;k$c&&0===k$c._repaint&&(k$c._repaint=1,k$c.parentRepaint())}}),k$o(0,k$a,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(k$a){this._width!==k$a&&(this._width=k$a,this.conchModel&&this.conchModel.size(k$a,this._height),this.repaint())}),k$o(0,k$a,"x",function(){return this._x},function(k$a){if(this._x!==k$a){if(this.destroyed)return;this._x=k$a,this.conchModel&&this.conchModel.pos(k$a,this._y);var k$b=this._parent;k$b&&0===k$b._repaint&&(k$b._repaint=1,k$b.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),k$o(0,k$a,"globalScaleY",function(){for(var k$a=1,k$b=this;k$b&&k$b!==k$z.stage;)k$a*=k$b.scaleY,k$b=k$b.parent;return k$a}),k$o(0,k$a,"hitArea",function(){return this._$P.hitArea},function(k$a){this._set$P("hitArea",k$a)}),k$o(0,k$a,"staticCache",function(){return this._$P.staticCache},function(k$a){this._set$P("staticCache",k$a),k$a||this.reCache()}),k$o(0,k$a,"texture",function(){return this._texture},function(k$a){this._texture!=k$a&&(this._texture=k$a,this.graphics.cleanByTexture(k$a,0,0))}),k$o(0,k$a,"y",function(){return this._y},function(k$a){if(this._y!==k$a){if(this.destroyed)return;this._y=k$a,this.conchModel&&this.conchModel.pos(this._x,k$a);var k$b=this._parent;k$b&&0===k$b._repaint&&(k$b._repaint=1,k$b.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),k$o(0,k$a,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(k$a){this._height!==k$a&&(this._height=k$a,this.conchModel&&this.conchModel.size(this._width,k$a),this.repaint())}),k$o(0,k$a,"blendMode",function(){return this._style.blendMode},function(k$a){this.getStyle().blendMode=k$a,this.conchModel&&this.conchModel.blendMode(k$a),k$a&&"source-over"!=k$a?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),k$o(0,k$a,"scaleX",function(){return this._style._tf.scaleX},function(k$a){var k$b=this.getStyle();if(k$b._tf.scaleX!==k$a){k$b.setScaleX(k$a),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(k$a,k$b._tf.scaleY),this._renderType|=4;var k$c=this._parent;k$c&&0===k$c._repaint&&(k$c._repaint=1,k$c.parentRepaint())}}),k$o(0,k$a,"scaleY",function(){return this._style._tf.scaleY},function(k$a){var k$b=this.getStyle();if(k$b._tf.scaleY!==k$a){k$b.setScaleY(k$a),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(k$b._tf.scaleX,k$a),this._renderType|=4;var k$c=this._parent;k$c&&0===k$c._repaint&&(k$c._repaint=1,k$c.parentRepaint())}}),k$o(0,k$a,"stage",function(){return k$z.stage}),k$o(0,k$a,"skewX",function(){return this._style._tf.skewX},function(k$a){var k$b=this.getStyle();if(k$b._tf.skewX!==k$a){k$b.setSkewX(k$a),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(k$a,k$b._tf.skewY),this._renderType|=4;var k$c=this._parent;k$c&&0===k$c._repaint&&(k$c._repaint=1,k$c.parentRepaint())}}),k$o(0,k$a,"scrollRect",function(){return this._style.scrollRect},function(k$a){this.getStyle().scrollRect=k$a,this.repaint(),k$a?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(k$a.x,k$a.y,k$a.width,k$a.height)):(this._renderType&=-129,this.conchModel&&(k$c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),k$o(0,k$a,"skewY",function(){return this._style._tf.skewY},function(k$a){var k$b=this.getStyle();if(k$b._tf.skewY!==k$a){k$b.setSkewY(k$a),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(k$b._tf.skewX,k$a),this._renderType|=4;var k$c=this._parent;k$c&&0===k$c._repaint&&(k$c._repaint=1,k$c.parentRepaint())}}),k$o(0,k$a,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(k$a){this._tfChanged=!1,(this._transform=k$a)&&(this._x=k$a.tx,this._y=k$a.ty,k$a.tx=k$a.ty=0,this.conchModel&&this.conchModel.transform(k$a.a,k$a.b,k$a.c,k$a.d,this._x,this._y)),k$a?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),k$o(0,k$a,"pivotX",function(){return this._style._tf.translateX},function(k$a){this.getStyle().setTranslateX(k$a),this.conchModel&&this.conchModel.pivot(k$a,this._style._tf.translateY),this.repaint()}),k$o(0,k$a,"pivotY",function(){return this._style._tf.translateY},function(k$a){this.getStyle().setTranslateY(k$a),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,k$a),this.repaint()}),k$o(0,k$a,"alpha",function(){return this._style.alpha},function(k$a){this._style&&this._style.alpha!==k$a&&(k$a=k$a<0?0:1<k$a?1:k$a,this.getStyle().alpha=k$a,this.conchModel&&this.conchModel.alpha(k$a),1!==k$a?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),k$o(0,k$a,"visible",function(){return this._style.visible},function(k$a){this._style&&this._style.visible!==k$a&&(this.getStyle().visible=k$a,this.conchModel&&this.conchModel.visible(k$a),this.parentRepaint())}),k$o(0,k$a,"graphics",function(){return this._graphics||(this.graphics=k$F.createGraphics())},function(k$a){this._graphics&&(this._graphics._sp=null),(this._graphics=k$a)?(this._renderType&=-2,this._renderType|=512,(k$a._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(k$c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),k$o(0,k$a,"filters",function(){return this._$P.filters},function(k$a){k$a&&0===k$a.length&&(k$a=null),this._$P.filters!=k$a&&(this._set$P("filters",k$a?k$a.slice():null),k$J.isConchApp&&(this.conchModel&&(k$c.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),k$J.isWebGL&&(k$a&&k$a.length?this._renderType|=32:this._renderType&=-33),k$a&&0<k$a.length?(this._getBit(1)||this._setUpNoticeType(1),k$J.isWebGL&&1==k$a.length&&k$a[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(k$J.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),k$o(0,k$a,"parent",k$e.prototype._$get_parent,function(k$a){k$z.superSet(k$aa,this,"parent",k$a),k$a&&this._getBit(2)&&this._$2__onDisplay()}),k$o(0,k$a,"mask",function(){return this._$P._mask},function(k$a){k$a&&this.mask&&this.mask._$P.maskParent||(k$a?(this.cacheAs="bitmap",this._set$P("_mask",k$a),k$a._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",k$a),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(k$a?k$a.conchModel:null),this._renderType|=64,this.parentRepaint())}),k$o(0,k$a,"mouseEnabled",function(){return 1<this._mouseEnableState},function(k$a){this._mouseEnableState=k$a?2:1}),k$o(0,k$a,"globalScaleX",function(){for(var k$a=1,k$b=this;k$b&&k$b!==k$z.stage;)k$a*=k$b.scaleX,k$b=k$b.parent;return k$a}),k$o(0,k$a,"mouseX",function(){return this.getMousePoint().x}),k$o(0,k$a,"mouseY",function(){return this.getMousePoint().y}),k$c.fromImage=function(k$a){return(new k$c).loadImage(k$a)},k$c._cachePool=[],k$c.CustomList=[],k$i(k$c,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=k$g.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),k$c}(k$aa),k$ma=function(k$a){function k$b(k$a){this._audio=null,this._onEnd=null,this._resumePlay=null,k$b.__super.call(this),this._onEnd=k$$.bind(this.__onEnd,this),this._resumePlay=k$$.bind(this.__resumePlay,this),k$a.addEventListener("ended",this._onEnd),this._audio=k$a}k$k(k$b,"laya.media.h5audio.AudioSoundChannel",k$da);var k$c=k$b.prototype;return k$c.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(k$z.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},k$c.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,k$O.container.appendChild(this._audio),this._audio.play()}catch(k$a){this.event("error")}},k$c.play=function(k$a){this.isStopped=!1;try{this._audio.playbackRate=k$E.playbackRate,this._audio.currentTime=this.startTime}catch(k$a){return void this._audio.addEventListener("canplay",this._resumePlay)}k$E.addChannel(this),k$O.container.appendChild(this._audio),!k$a&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},k$c.stop=function(){this.isStopped=!0,k$E.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&k$J.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),k$O.onIE||this._audio!=k$ca._musicAudio&&k$W.recover("audio:"+this.url,this._audio),k$O.removeElement(this._audio),this._audio=null)},k$c.pause=function(){this.isStopped=!0,k$E.removeChannel(this),"pause"in this._audio&&this._audio.pause()},k$c.resume=function(){this._audio&&(this.isStopped=!1,k$E.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},k$o(0,k$c,"position",function(){return this._audio?this._audio.currentTime:0}),k$o(0,k$c,"duration",function(){return this._audio?this._audio.duration:0}),k$o(0,k$c,"volume",function(){return this._audio?this._audio.volume:1},function(k$a){this._audio&&(this._audio.volume=k$a)}),k$b}(),k$na=function(k$a){function k$b(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=k$fa.ctx,k$b.__super.call(this),this._onPlayEnd=k$$.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}k$k(k$b,"laya.media.webaudio.WebAudioSoundChannel",k$da);var k$c=k$b.prototype;return k$c.play=function(k$a){if(k$E.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var k$b=this.context,k$c=this.gain,k$d=k$b.createBufferSource();(this.bufferSource=k$d).buffer=this.audioBuffer,k$d.connect(k$c),k$c&&k$c.disconnect(),k$c.connect(k$b.destination),k$d.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=k$O.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(k$d.loop=!0),k$d.playbackRate.setTargetAtTime?k$d.playbackRate.setTargetAtTime(k$E.playbackRate,this.context.currentTime,.1):k$d.playbackRate.value=k$E.playbackRate,k$d.start(0,this.startTime),!k$a&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},k$c.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(k$z.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},k$c._clearBufferSource=function(){if(this.bufferSource){var k$a=this.bufferSource;k$a.stop?k$a.stop(0):k$a.noteOff(0),k$a.disconnect(0),k$a.onended=null,k$b._tryCleanFailed||this._tryClearBuffer(k$a),this.bufferSource=null}},k$c._tryClearBuffer=function(k$a){try{k$a.buffer=null}catch(k$a){k$b._tryCleanFailed=!0}},k$c.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,k$E.removeChannel(this),this.startHandler=null,this.completeHandler=null},k$c.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,k$E.removeChannel(this)},k$c.resume=function(){this.startTime=this._pauseTime,this.play(!1)},k$o(0,k$c,"position",function(){return this.bufferSource?(k$O.now()-this._startTime)/1e3+this.startTime:0}),k$o(0,k$c,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),k$o(0,k$c,"volume",function(){return this._volume},function(k$a){this.isStopped||(this._volume=k$a,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(k$a,this.context.currentTime,.1):this.gain.gain.value=k$a)}),k$b._tryCleanFailed=!1,k$b}(),k$oa=function(k$a){function k$b(){k$b.__super.call(this),this._w=0,this._h=0}k$k(k$b,"laya.resource.Bitmap",k$ja);var k$c=k$b.prototype;return k$o(0,k$c,"width",function(){return this._w}),k$o(0,k$c,"height",function(){return this._h}),k$o(0,k$c,"source",function(){return this._source}),k$b}(),k$pa=function(k$b){function k$a(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,k$a.__super.call(this),this._interval=k$d.animationInterval,this._setUpNoticeType(1)}k$k(k$a,"laya.display.AnimationPlayerBase",k$b);var k$c=k$a.prototype;return k$c.play=function(k$a,k$b,k$c,k$d){void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=!0),void 0===k$c&&(k$c=""),void 0===k$d&&(k$d=!0),this._isPlaying=!0,this.index="string"==typeof k$a?this._getFrameByLabel(k$a):k$a,this.loop=k$b,this._actionName=k$c,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},k$c._getFrameByLabel=function(k$a){var k$b=0;for(k$b=0;k$b<this._count;k$b++)if(this._labels[k$b]&&0<=this._labels[k$b].indexOf(k$a))return k$b;return 0},k$c._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},k$c._setControlNode=function(k$a){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=k$a)&&k$a!=this&&(k$a.on("display",this,this._checkResumePlaying),k$a.on("undisplay",this,this._checkResumePlaying))},k$c._setDisplay=function(k$a){k$b.prototype._setDisplay.call(this,k$a),this._checkResumePlaying()},k$c._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},k$c.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},k$c.addLabel=function(k$a,k$b){this._labels||(this._labels={}),this._labels[k$b]||(this._labels[k$b]=[]),this._labels[k$b].push(k$a)},k$c.removeLabel=function(k$a){if(k$a){if(this._labels)for(var k$b in this._labels)this._removeLabelFromLabelList(this._labels[k$b],k$a)}else this._labels=null},k$c._removeLabelFromLabelList=function(k$a,k$b){if(k$a)for(var k$c=k$a.length-1;0<=k$c;k$c--)k$a[k$c]==k$b&&k$a.splice(k$c,1)},k$c.gotoAndStop=function(k$a){this.index="string"==typeof k$a?this._getFrameByLabel(k$a):k$a,this.stop()},k$c._displayToIndex=function(k$a){},k$c.clear=function(){this.stop(),this._labels=null},k$o(0,k$c,"interval",function(){return this._interval},function(k$a){this._interval!=k$a&&(this._frameRateChanged=!0,this._interval=k$a,this._isPlaying&&0<k$a&&this.timerLoop(k$a,this,this._frameLoop,null,!0,!0))}),k$o(0,k$c,"isPlaying",function(){return this._isPlaying}),k$o(0,k$c,"index",function(){return this._index},function(k$a){if(this._index=k$a,this._displayToIndex(k$a),this._labels&&this._labels[k$a])for(var k$b=this._labels[k$a],k$c=0,k$d=k$b.length;k$c<k$d;k$c++)this.event("label",k$b[k$c])}),k$o(0,k$c,"count",function(){return this._count}),k$a.WRAP_POSITIVE=0,k$a.WRAP_REVERSE=1,k$a.WRAP_PINGPONG=2,k$a}(k$la),k$qa=function(k$b){function k$n(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,k$n.__super.call(this),this.overflow=k$n.VISIBLE,this._style=new k$ba(this),this._style.wordWrap=!1}k$k(k$n,"laya.display.Text",k$b);var k$a=k$n.prototype;return k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,k$a),this._lines=null,this._words&&(this._words.length=0,this._words=null)},k$a._getBoundPointsM=function(k$a){void 0===k$a&&(k$a=!1);var k$b=k$B.TEMP;return k$b.setTo(0,0,this.width,this.height),k$b._getBoundPoints()},k$a.getGraphicBounds=function(k$a){void 0===k$a&&(k$a=!1);var k$b=k$B.TEMP;return k$b.setTo(0,0,this.width,this.height),k$b},k$a._getCSSStyle=function(){return this._style},k$a.lang=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k){if(k$a=k$n.langPacks&&k$n.langPacks[k$a]?k$n.langPacks[k$a]:k$a,arguments.length<2)this._text=k$a;else{for(var k$l=0,k$m=arguments.length;k$l<k$m;k$l++)k$a=k$a.replace("{"+k$l+"}",arguments[k$l+1]);this._text=k$a}},k$a._isPassWordMode=function(){var k$a=this._style.password;return"prompt"in this&&this.prompt==this._text&&(k$a=!1),k$a},k$a._getPassWordTxt=function(k$a){var k$b;k$b="";for(var k$c=k$a.length;0<k$c;k$c--)k$b+="●";return k$b},k$a.renderText=function(k$a,k$b){var k$c=this.graphics;k$c.clear(!0);var k$d=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(k$O.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);k$O.context.font=k$d;var k$e=this.padding,k$f=k$e[3],k$g="left",k$h=this._lines,k$i=this.leading+this._charSize.height,k$j=this._currBitmapFont;k$j&&(k$i=this.leading+k$j.getMaxHeight());var k$k=k$e[0];if(!k$j&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(k$g="right",k$f=this._width-k$e[1]):"center"==this.align&&(k$g="center",k$f=.5*this._width+k$e[3]-k$e[1])),0<this._height){var k$l=this._textHeight>this._height?"top":this.valign;"middle"===k$l?k$k=.5*(this._height-k$b*k$i)+k$e[0]-k$e[2]:"bottom"===k$l&&(k$k=this._height-k$b*k$i-k$e[2])}var k$m=this._style;if(k$j&&k$j.autoScaleSize)var k$n=k$j.fontSize/this.fontSize;if(this._clipPoint)if(k$c.save(),k$j&&k$j.autoScaleSize){var k$o=0,k$p=0;k$o=this._width?this._width-k$e[3]-k$e[1]:this._textWidth,k$p=this._height?this._height-k$e[0]-k$e[2]:this._textHeight,k$o*=k$n,k$p*=k$n,k$c.clipRect(k$e[3],k$e[0],k$o,k$p)}else k$c.clipRect(k$e[3],k$e[0],this._width?this._width-k$e[3]-k$e[1]:this._textWidth,this._height?this._height-k$e[0]-k$e[2]:this._textHeight);var k$q=k$m.password;"prompt"in this&&this.prompt==this._text&&(k$q=!1);for(var k$r=0,k$s=0,k$t=Math.min(this._lines.length,k$b+k$a)||1,k$w=k$a;k$w<k$t;k$w++){var k$x,k$y=k$h[k$w];if(k$q){var k$z=k$y.length;k$y="";for(var k$A=k$z;0<k$A;k$A--)k$y+="●"}if(k$r=k$f-(this._clipPoint?this._clipPoint.x:0),k$s=k$k+k$i*k$w-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(k$g,k$r,k$s,k$w),k$j){var k$B=this.width;k$j.autoScaleSize&&(k$B=this.width*k$n),k$j.drawText(k$y,this,k$r,k$s,this.align,k$B)}else k$J.isWebGL?(this._words||(this._words=[]),(k$x=this._words.length>k$w-k$a?this._words[k$w-k$a]:new k$v).setText(k$y)):k$x=k$y,k$m.stroke?k$c.fillBorderText(k$x,k$r,k$s,k$d,this.color,k$m.strokeColor,k$m.stroke,k$g):k$c.fillText(k$x,k$r,k$s,k$d,this.color,k$g)}if(k$j&&k$j.autoScaleSize){var k$C=1/k$n;this.scale(k$C,k$C)}this._clipPoint&&k$c.restore(),this._startX=k$f,this._startY=k$k},k$a.drawUnderline=function(k$a,k$b,k$c,k$d){var k$e=this._lineWidths[k$d];switch(k$a){case"center":k$b-=k$e/2;break;case"right":k$b-=k$e}k$c+=this._charSize.height,this._graphics.drawLine(k$b,k$c,k$b+k$e,k$c,this.underlineColor||this.color,1)},k$a.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);k$O.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new k$A(0,0)):this._clipPoint=null;var k$a=this._lines.length;if(this.overflow!=k$n.VISIBLE){var k$b=this.overflow==k$n.HIDDEN?Math.floor:Math.ceil;k$a=Math.min(k$a,k$b((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var k$c=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(k$c,k$a),this.repaint()},k$a.evalTextSize=function(){var k$a,k$b=NaN;k$a=Math.max.apply(this,this._lineWidths),k$b=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],k$a==this._textWidth&&k$b==this._textHeight||(this._textWidth=k$a,this._textHeight=k$b,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},k$a.checkEnabledViewportOrNot=function(){return this.overflow==k$n.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},k$a.changeText=function(k$a){this._text!==k$a&&(this.lang(k$a+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},k$a.parseLines=function(k$a){var k$b=this.wordWrap||this.overflow==k$n.HIDDEN;if(k$b)var k$c=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var k$d=k$O.context.measureText(k$n._testWord);k$J.isConchApp&&0===k$d.width&&0===k$d.height&&(k$d=k$O.context.measureText("W")),this._charSize.width=k$d.width,this._charSize.height=k$d.height||this.fontSize}for(var k$e=k$a.replace(/\r\n/g,"\n").split("\n"),k$f=0,k$g=k$e.length;k$f<k$g;k$f++){var k$h=k$e[k$f];k$b?this.parseLine(k$h,k$c):(this._lineWidths.push(this.getTextWidth(k$h)),this._lines.push(k$h))}},k$a.parseLine=function(k$a,k$b){k$O.context;var k$c,k$d=this._lines,k$e=0,k$f=NaN,k$g=NaN,k$h=0;if((k$f=this.getTextWidth(k$a))<=k$b)return k$d.push(k$a),void this._lineWidths.push(k$f);k$f=this._charSize.width,0==(k$e=Math.floor(k$b/k$f))&&(k$e=1),k$g=k$f=this.getTextWidth(k$a.substring(0,k$e));for(var k$i=k$e,k$j=k$a.length;k$i<k$j;k$i++)if(k$b<(k$g+=k$f=this.getTextWidth(k$a.charAt(k$i))))if(this.wordWrap){var k$k=k$a.substring(k$h,k$i);if(k$k.charCodeAt(k$k.length-1)<255?(k$c=/(?:\w|-)+$/.exec(k$k))&&(k$i=k$c.index+k$h,0==k$c.index?k$i+=k$k.length:k$k=k$a.substring(k$h,k$i)):k$n.RightToLeft&&(k$c=/([\u0600-\u06FF])+$/.exec(k$k))&&(k$i=k$c.index+k$h,0==k$c.index?k$i+=k$k.length:k$k=k$a.substring(k$h,k$i)),k$d.push(k$k),this._lineWidths.push(k$g-k$f),!((k$h=k$i)+k$e<k$j)){k$d.push(k$a.substring(k$h,k$j)),this._lineWidths.push(this.getTextWidth(k$d[k$d.length-1])),k$h=-1;break}k$i+=k$e,k$g=k$f=this.getTextWidth(k$a.substring(k$h,k$i)),k$i--}else if(this.overflow==k$n.HIDDEN)return k$d.push(k$a.substring(0,k$i)),void this._lineWidths.push(this.getTextWidth(k$d[k$d.length-1]));this.wordWrap&&-1!=k$h&&(k$d.push(k$a.substring(k$h,k$j)),this._lineWidths.push(this.getTextWidth(k$d[k$d.length-1])))},k$a.getTextWidth=function(k$a){return this._currBitmapFont?this._currBitmapFont.getTextWidth(k$a):k$O.context.measureText(k$a).width},k$a.getWordWrapWidth=function(){var k$a=this.padding,k$b=NaN;return(k$b=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(k$b=this.wordWrap?100:k$O.width),k$b<=0&&(k$b=100),k$b-k$a[3]-k$a[1]},k$a.getCharPoint=function(k$a,k$b){this._isChanged&&k$z.timer.runCallLater(this,this.typeset);for(var k$c=0,k$d=this._lines,k$e=0,k$f=0,k$g=k$d.length;k$f<k$g;k$f++){if(k$a<(k$c+=k$d[k$f].length)){var k$h=k$f;break}k$e=k$c}var k$i=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;k$O.context.font=k$i;var k$j=this.getTextWidth(this._text.substring(k$e,k$a));return(k$b||new k$A).setTo(this._startX+k$j-(this._clipPoint?this._clipPoint.x:0),this._startY+k$h*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},k$o(0,k$a,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(k$a){k$a!=this._width&&(k$z.superSet(k$la,this,"width",k$a),this.isChanged=!0)}),k$o(0,k$a,"textWidth",function(){return this._isChanged&&k$z.timer.runCallLater(this,this.typeset),this._textWidth}),k$o(0,k$a,"height",function(){return this._height?this._height:this.textHeight},function(k$a){k$a!=this._height&&(k$z.superSet(k$la,this,"height",k$a),this.isChanged=!0)}),k$o(0,k$a,"textHeight",function(){return this._isChanged&&k$z.timer.runCallLater(this,this.typeset),this._textHeight}),k$o(0,k$a,"padding",function(){return this._getCSSStyle().padding},function(k$a){this._getCSSStyle().padding=k$a,this.isChanged=!0}),k$o(0,k$a,"bold",function(){return this._getCSSStyle().bold},function(k$a){this._getCSSStyle().bold=k$a,this.isChanged=!0}),k$o(0,k$a,"text",function(){return this._text||""},function(k$a){this._text!==k$a&&(this.lang(k$a+""),this.isChanged=!0,this.event("change"))}),k$o(0,k$a,"color",function(){return this._getCSSStyle().color},function(k$a){this._getCSSStyle().color!=k$a&&(this._getCSSStyle().color=k$a,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),k$o(0,k$a,"font",function(){return this._getCSSStyle().fontFamily},function(k$a){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),k$n._bitmapFonts&&k$n._bitmapFonts[k$a]&&(this._currBitmapFont=k$n._bitmapFonts[k$a]),this._getCSSStyle().fontFamily=k$a,this.isChanged=!0}),k$o(0,k$a,"fontSize",function(){return this._getCSSStyle().fontSize},function(k$a){this._getCSSStyle().fontSize=k$a,this.isChanged=!0}),k$o(0,k$a,"italic",function(){return this._getCSSStyle().italic},function(k$a){this._getCSSStyle().italic=k$a,this.isChanged=!0}),k$o(0,k$a,"align",function(){return this._getCSSStyle().align},function(k$a){this._getCSSStyle().align=k$a,this.isChanged=!0}),k$o(0,k$a,"valign",function(){return this._getCSSStyle().valign},function(k$a){this._getCSSStyle().valign=k$a,this.isChanged=!0}),k$o(0,k$a,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(k$a){this._getCSSStyle().wordWrap=k$a,this.isChanged=!0}),k$o(0,k$a,"leading",function(){return this._getCSSStyle().leading},function(k$a){this._getCSSStyle().leading=k$a,this.isChanged=!0}),k$o(0,k$a,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(k$a){this._getCSSStyle().backgroundColor=k$a,this.isChanged=!0}),k$o(0,k$a,"borderColor",function(){return this._getCSSStyle().borderColor},function(k$a){this._getCSSStyle().borderColor=k$a,this.isChanged=!0}),k$o(0,k$a,"stroke",function(){return this._getCSSStyle().stroke},function(k$a){this._getCSSStyle().stroke=k$a,this.isChanged=!0}),k$o(0,k$a,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(k$a){this._getCSSStyle().strokeColor=k$a,this.isChanged=!0}),k$o(0,k$a,"isChanged",null,function(k$a){this._isChanged!==k$a&&(this._isChanged=k$a)&&k$z.timer.callLater(this,this.typeset)}),k$o(0,k$a,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(k$a){if(!(this.overflow!=k$n.SCROLL||this.textWidth<this._width)&&this._clipPoint){k$a=k$a<this.padding[3]?this.padding[3]:k$a;var k$b=this._textWidth-this._width;k$a=k$b<k$a?k$b:k$a;var k$c=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=k$a,this.renderText(this._lastVisibleLineIndex,k$c)}}),k$o(0,k$a,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(k$a){if(!(this.overflow!=k$n.SCROLL||this.textHeight<this._height)&&this._clipPoint){k$a=k$a<this.padding[0]?this.padding[0]:k$a;var k$b=this._textHeight-this._height,k$c=(k$a=k$b<k$a?k$b:k$a)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=k$c;var k$d=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=k$a,this.renderText(k$c,k$d)}}),k$o(0,k$a,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),k$o(0,k$a,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),k$o(0,k$a,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),k$o(0,k$a,"underlineColor",function(){return this._underlineColor},function(k$a){this._underlineColor=k$a,this._isChanged=!0,this.typeset()}),k$n.registerBitmapFont=function(k$a,k$b){k$n._bitmapFonts||(k$n._bitmapFonts={}),k$n._bitmapFonts[k$a]=k$b},k$n.unregisterBitmapFont=function(k$a,k$b){if(void 0===k$b&&(k$b=!0),k$n._bitmapFonts&&k$n._bitmapFonts[k$a]){var k$c=k$n._bitmapFonts[k$a];k$b&&k$c.destroy(),delete k$n._bitmapFonts[k$a]}},k$n.setTextRightToLeft=function(){var k$a;(k$a=k$O.canvas.source.style).display="none",k$a.position="absolute",k$a.direction="rtl",k$J._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,k$O.document.body.appendChild(k$O.canvas.source)},k$n.supportFont=function(k$a){k$O.context.font="10px sans-serif";var k$b=k$O.context.measureText("abcji").width;k$O.context.font="10px "+k$a;var k$c=k$O.context.measureText("abcji").width;return console.log(k$b,k$c),k$b!==k$c},k$n._testWord="游",k$n.langPacks=null,k$n.VISIBLE="visible",k$n.SCROLL="scroll",k$n.HIDDEN="hidden",k$n.CharacterCache=!0,k$n.RightToLeft=!1,k$n._bitmapFonts=null,k$i(k$n,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),k$n}(k$la),k$ra=function(k$l){function k$g(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",k$g.__super.call(this),this.offset=new k$A,this._canvasTransform=new k$G,this._previousOrientation=k$O.window.orientation;var k$b=this;this.transform=k$G.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var k$a=k$O.window,k$c=this;k$a.addEventListener("focus",function(){k$b._isFocused=!0,k$c.event("focus"),k$c.event("focuschange")}),k$a.addEventListener("blur",function(){k$b._isFocused=!1,k$c.event("blur"),k$c.event("focuschange"),k$c._isInputting()&&(k$xa.inputElement.target.focus=!1)});var k$d="visibilityState",k$e="visibilitychange",k$f=k$a.document;void 0!==k$f.hidden?(k$e="visibilitychange",k$d="visibilityState"):void 0!==k$f.mozHidden?(k$e="mozvisibilitychange",k$d="mozVisibilityState"):void 0!==k$f.msHidden?(k$e="msvisibilitychange",k$d="msVisibilityState"):void 0!==k$f.webkitHidden&&(k$e="webkitvisibilitychange",k$d="webkitVisibilityState"),k$a.document.addEventListener(k$e,function(){"hidden"==k$O.document[k$d]?k$c._setStageVisible(!1):k$c._setStageVisible(!0)}),k$a.document.addEventListener("qbrowserVisibilityChange",function(k$a){k$c._setStageVisible(!k$a.hidden)}),k$a.addEventListener("resize",function(){var k$a=k$O.window.orientation;null!=k$a&&k$a!=k$b._previousOrientation&&k$c._isInputting()&&(k$xa.inputElement.target.focus=!1),k$b._previousOrientation=k$a,k$c._isInputting()||k$c._resetCanvas()}),k$a.addEventListener("orientationchange",function(k$a){k$c._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),k$O.onMobile&&this.on("mousedown",this,this._onmouseMove)}k$k(k$g,"laya.display.Stage",k$l);var k$a=k$g.prototype;return k$a._setStageVisible=function(k$a){this._isVisibility!=k$a&&(this._isVisibility=k$a,this._isVisibility||this._isInputting()&&(k$xa.inputElement.target.focus=!1),this.event("visibilitychange"))},k$a._isInputting=function(){return k$O.onMobile&&k$xa.isInputting},k$a._changeCanvasSize=function(){this.setScreenSize(k$O.clientWidth*k$O.pixelRatio,k$O.clientHeight*k$O.pixelRatio)},k$a._resetCanvas=function(){if(this.screenAdaptationEnabled){var k$a=k$J._mainCanvas;k$a.source.style;k$a.size(1,1),k$z.timer.once(100,this,this._changeCanvasSize)}},k$a.setScreenSize=function(k$a,k$b){var k$c=!1;if("none"!==this._screenMode&&(k$c=(k$a/k$b<1?"vertical":"horizontal")!==this._screenMode)){var k$d=k$b;k$b=k$a,k$a=k$d}this.canvasRotation=k$c;var k$e=k$J._mainCanvas,k$f=k$e.source.style,k$g=this._canvasTransform.identity(),k$h=this._scaleMode,k$i=k$a/this.designWidth,k$j=k$b/this.designHeight,k$k=this.designWidth,k$l=this.designHeight,k$m=k$a,k$n=k$b,k$o=k$O.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,k$h){case"noscale":k$i=k$j=1,k$m=this.designWidth,k$n=this.designHeight;break;case"showall":k$i=k$j=Math.min(k$i,k$j),k$k=k$m=Math.round(this.designWidth*k$i),k$l=k$n=Math.round(this.designHeight*k$j);break;case"noborder":k$i=k$j=Math.max(k$i,k$j),k$m=Math.round(this.designWidth*k$i),k$n=Math.round(this.designHeight*k$j);break;case"full":k$i=k$j=1,this._width=k$k=k$a,this._height=k$l=k$b;break;case"fixedwidth":k$j=k$i,this._height=k$l=Math.round(k$b/k$i);break;case"fixedheight":k$i=k$j,this._width=k$k=Math.round(k$a/k$j);break;case"fixedauto":k$a/k$b<this.designWidth/this.designHeight?(k$j=k$i,this._height=k$l=Math.round(k$b/k$i)):(k$i=k$j,this._width=k$k=Math.round(k$a/k$j))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,k$k=k$k+1&2147483646,k$l=k$l+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),k$i*=this.scaleX,k$j*=this.scaleY,1===k$i&&1===k$j?this.transform.identity():(this.transform.a=this._formatData(k$i/(k$m/k$k)),this.transform.d=this._formatData(k$j/(k$n/k$l)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),k$e.size(k$k,k$l),k$F.changeWebGLSize(k$k,k$l),k$g.scale(k$m/k$k/k$o,k$n/k$l/k$o),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(k$a-k$m)/k$o:this.offset.x=.5*(k$a-k$m)/k$o,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(k$b-k$n)/k$o:this.offset.y=.5*(k$b-k$n)/k$o,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),k$g.translate(this.offset.x,this.offset.y),this.canvasDegree=0,k$c&&("horizontal"===this._screenMode?(k$g.rotate(Math.PI/2),k$g.translate(k$b/k$o,0),this.canvasDegree=90):(k$g.rotate(-Math.PI/2),k$g.translate(0,k$a/k$o),this.canvasDegree=-90)),k$g.a=this._formatData(k$g.a),k$g.d=this._formatData(k$g.d),k$g.tx=this._formatData(k$g.tx),k$g.ty=this._formatData(k$g.ty),k$f.transformOrigin=k$f.webkitTransformOrigin=k$f.msTransformOrigin=k$f.mozTransformOrigin=k$f.oTransformOrigin="0px 0px 0px",k$f.transform=k$f.webkitTransform=k$f.msTransform=k$f.mozTransform=k$f.oTransform="matrix("+k$g.toString()+")",k$g.translate(parseInt(k$f.left)||0,parseInt(k$f.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},k$a._formatData=function(k$a){return Math.abs(k$a)<1e-6?0:Math.abs(1-k$a)<.001?0<k$a?1:-1:k$a},k$a.getMousePoint=function(){return k$A.TEMP.setTo(this.mouseX,this.mouseY)},k$a.repaint=function(){this._repaint=1},k$a.parentRepaint=function(){},k$a._loop=function(){return this.render(k$J.context,0,0),!0},k$a._onmouseMove=function(k$a){this._mouseMoveTime=k$O.now()},k$a.getTimeFromFrameStart=function(){return k$O.now()-this._frameStartTime},k$a.render=function(k$a,k$b,k$c){if("sleep"===this._frameRate&&!k$J.isConchApp){var k$d=k$O.now();if(!(1e3<=k$d-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(k$X.loopCount++,k$p.instance.runEvent(),k$z.timer._update()));this._frameStartTime=k$d}if(this._renderCount++,k$J.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=k$O.now();var k$e="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),k$f=this._renderCount%2==0;if(k$X.renderSlow=!k$e,k$e||k$f||k$J.isConchApp){var k$g;k$X.loopCount++,k$p.instance.runEvent(),k$z.timer._update(),k$F.update3DLoop();var k$h=0,k$i=0;if(k$J.isConchNode)for(k$h=0,k$i=this._scenes.length;k$h<k$i;k$h++)(k$g=this._scenes[k$h])&&k$g._updateSceneConch();else for(k$h=0,k$i=this._scenes.length;k$h<k$i;k$h++)(k$g=this._scenes[k$h])&&k$g._updateScene();if(k$J.isConchNode){var k$j=k$la.CustomList;for(k$h=0,k$i=k$j.length;k$h<k$i;k$h++){var k$k=k$j[k$h];k$k.customRender(k$k.customContext,0,0)}return}}k$J.isConchNode||this.renderingEnabled&&(k$e||!k$f||k$J.isConchWebGL)&&(k$J.isWebGL?k$J.WebGL.mainContext&&!k$J.WebGL.mainContext.isContextLost()&&(k$a.clear(),k$l.prototype.render.call(this,k$a,k$b,k$c),k$X._show&&k$X._sp&&k$X._sp.render(k$a,k$b,k$c),k$F.clear(this._bgColor),k$F.beginFlush(),k$a.flush(),k$F.endFinish(),k$_.instance&&k$_.getInstance().endDispose()):(k$F.clear(this._bgColor),k$l.prototype.render.call(this,k$a,k$b,k$c),k$X._show&&k$X._sp&&k$X._sp.render(k$a,k$b,k$c)))}else this._renderCount%5==0&&(k$X.loopCount++,k$p.instance.runEvent(),k$z.timer._update())},k$a._requestFullscreen=function(){var k$a=k$O.document.documentElement;k$a.requestFullscreen?k$a.requestFullscreen():k$a.mozRequestFullScreen?k$a.mozRequestFullScreen():k$a.webkitRequestFullscreen?k$a.webkitRequestFullscreen():k$a.msRequestFullscreen&&k$a.msRequestFullscreen()},k$a._fullScreenChanged=function(){k$z.stage.event("fullscreenchange")},k$a.exitFullscreen=function(){var k$a=k$O.document;k$a.exitFullscreen?k$a.exitFullscreen():k$a.mozCancelFullScreen?k$a.mozCancelFullScreen():k$a.webkitExitFullscreen&&k$a.webkitExitFullscreen()},k$o(0,k$a,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),k$o(0,k$a,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),k$o(0,k$a,"frameRate",function(){return this._frameRate},function(k$a){if(this._frameRate=k$a,k$J.isConchApp)switch(this._frameRate){case"slow":k$O.window.conch&&k$O.window.conchConfig.setSlowFrame&&k$O.window.conchConfig.setSlowFrame(!0);break;case"fast":k$O.window.conch&&k$O.window.conchConfig.setSlowFrame&&k$O.window.conchConfig.setSlowFrame(!1);break;case"mouse":k$O.window.conch&&k$O.window.conchConfig.setMouseFrame&&k$O.window.conchConfig.setMouseFrame(2e3);break;case"sleep":k$O.window.conch&&k$O.window.conchConfig.setLimitFPS&&k$O.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),k$o(0,k$a,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),k$o(0,k$a,"width",k$l.prototype._$get_width,function(k$a){this.designWidth=k$a,k$z.superSet(k$la,this,"width",k$a),k$z.timer.callLater(this,this._changeCanvasSize)}),k$o(0,k$a,"alignH",function(){return this._alignH},function(k$a){this._alignH=k$a,k$z.timer.callLater(this,this._changeCanvasSize)}),k$o(0,k$a,"isFocused",function(){return this._isFocused}),k$o(0,k$a,"height",k$l.prototype._$get_height,function(k$a){this.designHeight=k$a,k$z.superSet(k$la,this,"height",k$a),k$z.timer.callLater(this,this._changeCanvasSize)}),k$o(0,k$a,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||k$G.create()},k$l.prototype._$set_transform),k$o(0,k$a,"isVisibility",function(){return this._isVisibility}),k$o(0,k$a,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),k$o(0,k$a,"scaleMode",function(){return this._scaleMode},function(k$a){this._scaleMode=k$a,k$z.timer.callLater(this,this._changeCanvasSize)}),k$o(0,k$a,"alignV",function(){return this._alignV},function(k$a){this._alignV=k$a,k$z.timer.callLater(this,this._changeCanvasSize)}),k$o(0,k$a,"bgColor",function(){return this._bgColor},function(k$a){this._bgColor=k$a,this.conchModel&&this.conchModel.bgColor(k$a),k$J.isWebGL&&(k$a?k$g._wgColor=k$S.create(k$a)._color:k$O.onMiniGame||(k$g._wgColor=null)),k$O.onLimixiu?k$g._wgColor=k$S.create(k$a)._color:k$J.canvas.style.background=k$a||"none"}),k$o(0,k$a,"mouseX",function(){return Math.round(k$p.instance.mouseX/this.clientScaleX)}),k$o(0,k$a,"mouseY",function(){return Math.round(k$p.instance.mouseY/this.clientScaleY)}),k$o(0,k$a,"screenMode",function(){return this._screenMode},function(k$a){this._screenMode=k$a}),k$o(0,k$a,"visible",k$l.prototype._$get_visible,function(k$a){this.visible!==k$a&&(k$z.superSet(k$la,this,"visible",k$a),k$J._mainCanvas.source.style.visibility=k$a?"visible":"hidden")}),k$o(0,k$a,"fullScreenEnabled",null,function(k$a){var k$b=k$O.document,k$c=k$J.canvas;k$a?(k$c.addEventListener("mousedown",this._requestFullscreen),k$c.addEventListener("touchstart",this._requestFullscreen),k$b.addEventListener("fullscreenchange",this._fullScreenChanged),k$b.addEventListener("mozfullscreenchange",this._fullScreenChanged),k$b.addEventListener("webkitfullscreenchange",this._fullScreenChanged),k$b.addEventListener("msfullscreenchange",this._fullScreenChanged)):(k$c.removeEventListener("mousedown",this._requestFullscreen),k$c.removeEventListener("touchstart",this._requestFullscreen),k$b.removeEventListener("fullscreenchange",this._fullScreenChanged),k$b.removeEventListener("mozfullscreenchange",this._fullScreenChanged),k$b.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),k$b.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),k$g.SCALE_NOSCALE="noscale",k$g.SCALE_EXACTFIT="exactfit",k$g.SCALE_SHOWALL="showall",k$g.SCALE_NOBORDER="noborder",k$g.SCALE_FULL="full",k$g.SCALE_FIXED_WIDTH="fixedwidth",k$g.SCALE_FIXED_HEIGHT="fixedheight",k$g.SCALE_FIXED_AUTO="fixedauto",k$g.ALIGN_LEFT="left",k$g.ALIGN_RIGHT="right",k$g.ALIGN_CENTER="center",k$g.ALIGN_TOP="top",k$g.ALIGN_MIDDLE="middle",k$g.ALIGN_BOTTOM="bottom",k$g.SCREEN_NONE="none",k$g.SCREEN_HORIZONTAL="horizontal",k$g.SCREEN_VERTICAL="vertical",k$g.FRAME_FAST="fast",k$g.FRAME_SLOW="slow",k$g.FRAME_MOUSE="mouse",k$g.FRAME_SLEEP="sleep",k$g.FRAME_MOUSE_THREDHOLD=2e3,k$i(k$g,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),k$g}(k$la),k$sa=(function(k$a){function k$b(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,k$b.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}k$k(k$b,"laya.media.SoundNode",k$la);var k$c=k$b.prototype;k$c._onParentChange=function(){this.target=this.parent},k$c.play=function(k$a,k$b){void 0===k$a&&(k$a=1),isNaN(k$a)&&(k$a=1),this.url&&(this.stop(),this._channel=k$E.playSound(this.url,k$a,null,k$b))},k$c.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},k$c._setPlayAction=function(k$a,k$b,k$c,k$d){void 0===k$d&&(k$d=!0),this[k$c]&&k$a&&(k$d?k$a.on(k$b,this,this[k$c]):k$a.off(k$b,this,this[k$c]))},k$c._setPlayActions=function(k$a,k$b,k$c,k$d){if(void 0===k$d&&(k$d=!0),k$a&&k$b){var k$e,k$f=k$b.split(","),k$g=0;for(k$e=k$f.length,k$g=0;k$g<k$e;k$g++)this._setPlayAction(k$a,k$f[k$g],k$c,k$d)}},k$o(0,k$c,"playEvent",null,function(k$a){(this._playEvents=k$a)&&this._tar&&this._setPlayActions(this._tar,k$a,"play")}),k$o(0,k$c,"target",null,function(k$a){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=k$a,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),k$o(0,k$c,"stopEvent",null,function(k$a){(this._stopEvents=k$a)&&this._tar&&this._setPlayActions(this._tar,k$a,"stop")})}(),function(k$a){function k$b(){this._src=null,this._onload=null,this._onerror=null,k$b.__super.call(this)}k$k(k$b,"laya.resource.FileBitmap",k$oa);var k$c=k$b.prototype;return k$o(0,k$c,"src",function(){return this._src},function(k$a){this._src=k$a}),k$o(0,k$c,"onload",null,function(k$a){}),k$o(0,k$c,"onerror",null,function(k$a){}),k$b}()),k$ta=function(k$a){function k$c(k$a,k$b){this._is2D=!1,k$c.__super.call(this);var k$d=this;if(this._source=this,"2D"===k$a||"AUTO"===k$a&&!k$J.isWebGL){this._is2D=!0,this._source=k$b||k$O.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var k$e=this;k$e.getContext=function(k$a,k$b){if(k$d._ctx)return k$d._ctx;var k$c=k$d._ctx=k$d._source.getContext(k$a,k$b);return k$c&&(k$c._canvas=k$e,k$J.isFlash||k$O.onLimixiu||(k$c.size=function(k$a,k$b){})),k$c}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}k$k(k$c,"laya.resource.HTMLCanvas",k$oa);var k$b=k$c.prototype;return k$b.clear=function(){this._ctx&&this._ctx.clear()},k$b.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},k$b.release=function(){},k$b._setContext=function(k$a){this._ctx=k$a},k$b.getContext=function(k$a,k$b){return this._ctx?this._ctx:this._ctx=k$c._createContext(this)},k$b.getMemSize=function(){return 0},k$b.size=function(k$a,k$b){(this._w!=k$a||this._h!=k$b||this._source&&(this._source.width!=k$a||this._source.height!=k$b))&&(this._w=k$a,this._h=k$b,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(k$a,k$b),this._source&&(this._source.height=k$b,this._source.width=k$a))},k$b.getCanvas=function(){return this._source},k$b.toBase64=function(k$a,k$b,k$c){if(this._source)if(k$J.isConchApp&&this._source.toBase64)this._source.toBase64(k$a,k$b,k$c);else{var k$d=this._source.toDataURL(k$a,k$b);k$c.call(this,k$d)}},k$o(0,k$b,"context",function(){return this._ctx}),k$o(0,k$b,"asBitmap",null,function(k$a){}),k$c.create=function(k$a,k$b){return new k$c(k$a,k$b)},k$c.TYPE2D="2D",k$c.TYPE3D="3D",k$c.TYPEAUTO="AUTO",k$c._createContext=null,k$c}(),k$wa=(function(k$a){function k$i(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){throw k$i.__super.call(this),new Error("不允许new！")}k$k(k$i,"laya.resource.HTMLSubImage",k$oa),k$i.create=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){return void 0===k$h&&(k$h=!1),new k$i(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h)}}(),function(k$a){function k$l(){this._frames=null,this._url=null,k$l.__super.call(this),this._setControlNode(this)}k$k(k$l,"laya.display.Animation",k$a);var k$b=k$l.prototype;k$b.destroy=function(k$a){void 0===k$a&&(k$a=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,k$a),this._frames=null,this._labels=null},k$b.play=function(k$a,k$b,k$c,k$d){void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=!0),void 0===k$c&&(k$c=""),void 0===k$d&&(k$d=!0),k$c&&this._setFramesFromCache(k$c,k$d),this._isPlaying=!0,this.index="string"==typeof k$a?this._getFrameByLabel(k$a):k$a,this.loop=k$b,this._actionName=k$c,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},k$b._setFramesFromCache=function(k$a,k$b){var k$c;return void 0===k$b&&(k$b=!1),this._url&&(k$a=this._url+"#"+k$a),k$a&&k$l.framesMap[k$a]?((k$c=k$l.framesMap[k$a])instanceof Array?(this._frames=k$l.framesMap[k$a],this._count=this._frames.length):(k$c.nodeRoot&&(k$l.framesMap[k$a]=this._parseGraphicAnimationByData(k$c),k$c=k$l.framesMap[k$a]),this._frames=k$c.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=k$c.interval),this._labels=this._copyLabels(k$c.labels)),!0):(k$b&&console.log("ani not found:",k$a),!1)},k$b._copyLabels=function(k$a){if(!k$a)return null;var k$b,k$c;for(k$c in k$b={},k$a)k$b[k$c]=k$$.copyArray([],k$a[k$c]);return k$b},k$b._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&k$a.prototype._frameLoop.call(this)},k$b._displayToIndex=function(k$a){this._frames&&(this.graphics=this._frames[k$a])},k$b.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},k$b.loadImages=function(k$a,k$b){return void 0===k$b&&(k$b=""),this._url="",this._setFramesFromCache(k$b)||(this.frames=k$l.framesMap[k$b]?k$l.framesMap[k$b]:k$l.createFrames(k$a,k$b)),this},k$b.loadAtlas=function(k$b,k$c,k$d){void 0===k$d&&(k$d=""),this._url="";var k$e=this;function k$a(k$a){k$b===k$a&&(k$e.frames=k$l.framesMap[k$d]?k$l.framesMap[k$d]:k$l.createFrames(k$b,k$d),k$c&&k$c.run())}return k$e._setFramesFromCache(k$d)||(k$ha.getAtlas(k$b)?k$a(k$b):k$z.loader.load(k$b,k$s.create(null,k$a,[k$b]),null,"atlas")),this},k$b.loadAnimation=function(k$a,k$b,k$c){this._url=k$a;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,k$b&&k$b.run()):!k$c||k$ha.getAtlas(k$c)?this._loadAnimationData(k$a,k$b,k$c):k$z.loader.load(k$c,k$s.create(this,this._loadAnimationData,[k$a,k$b,k$c]),null,"atlas"),this},k$b._loadAnimationData=function(k$h,k$i,k$a){var k$j=this;if(!k$a||k$ha.getAtlas(k$a)){var k$k=this;k$ha.getRes(k$h)?k$b(k$h):k$z.loader.load(k$h,k$s.create(null,k$b,[k$h]),null,"json"),k$ha.clearRes(k$h)}else console.warn("atlas load fail:"+k$a);function k$b(k$a){if(k$ha.getRes(k$a)&&k$h===k$a){var k$b;if(k$l.framesMap[k$h+"#"])k$k._setFramesFromCache(k$j._actionName,!0),k$j.index=0,k$j._checkResumePlaying();else{var k$c=k$k._parseGraphicAnimation(k$ha.getRes(k$h));if(!k$c)return;var k$d,k$e=k$c.animationList,k$f=0,k$g=k$e.length;for(k$f=0;k$f<k$g;k$f++)k$b=k$e[k$f],k$l.framesMap[k$h+"#"+k$b.name]=k$b,k$d||(k$d=k$b);k$d&&(k$l.framesMap[k$h+"#"]=k$d,k$k._setFramesFromCache(k$j._actionName,!0),k$j.index=0),k$j._checkResumePlaying()}k$i&&k$i.run()}}},k$b._parseGraphicAnimation=function(k$a){return k$za.parseAnimationData(k$a)},k$b._parseGraphicAnimationByData=function(k$a){return k$za.parseAnimationByData(k$a)},k$o(0,k$b,"frames",function(){return this._frames},function(k$a){(this._frames=k$a)&&(this._count=k$a.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),k$o(0,k$b,"autoPlay",null,function(k$a){k$a?this.play():this.stop()}),k$o(0,k$b,"source",null,function(k$a){-1<k$a.indexOf(".ani")?this.loadAnimation(k$a):-1<k$a.indexOf(".json")||-1<k$a.indexOf("als")||-1<k$a.indexOf("atlas")?this.loadAtlas(k$a):this.loadImages(k$a.split(","))}),k$o(0,k$b,"autoAnimation",null,function(k$a){this.play(0,!0,k$a,!1)}),k$l.createFrames=function(k$a,k$b){var k$c,k$d,k$e=0,k$f=0;if("string"==typeof k$a){var k$g=k$ha.getAtlas(k$a);if(k$g&&k$g.length)for(k$c=[],k$e=0,k$f=k$g.length;k$e<k$f;k$e++)(k$d=new k$F.createGraphics).drawTexture(k$ha.getRes(k$g[k$e]),0,0),k$c.push(k$d)}else if(k$a instanceof Array)for(k$c=[],k$e=0,k$f=k$a.length;k$e<k$f;k$e++)(k$d=new k$F.createGraphics).loadImage(k$a[k$e],0,0),k$c.push(k$d);return k$b&&(k$l.framesMap[k$b]=k$c),k$c},k$l.clearCache=function(k$a){var k$b,k$c=k$l.framesMap,k$d=k$a+"#";for(k$b in k$c)k$b!==k$a&&0!=k$b.indexOf(k$d)||delete k$l.framesMap[k$b]},k$l.framesMap={}}(k$pa),function(k$a){function k$f(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,k$f.__super.call(this),null==k$f._sortIndexFun&&(k$f._sortIndexFun=k$y.sortByKey("index",!1,!0))}k$k(k$f,"laya.display.FrameAnimation",k$a);var k$b=k$f.prototype;return k$b._setUp=function(k$a,k$b){this._labels=null,this._animationNewFrames=null,this._targetDic=k$a,this._animationData=k$b,this.interval=1e3/k$b.frameRate,k$b.parsed?(this._count=k$b.count,this._labels=k$b.labels,this._animationNewFrames=k$b.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),k$b.parsed=!0,k$b.labels=this._labels,k$b.count=this._count,k$b.animationNewFrames=this._animationNewFrames},k$b.clear=function(){k$a.prototype.clear.call(this),this._targetDic=null,this._animationData=null},k$b._displayToIndex=function(k$a){if(this._animationData){k$a<0&&(k$a=0),k$a>this._count&&(k$a=this._count);var k$b=this._animationData.nodes,k$c=0,k$d=k$b.length;for(k$c=0;k$c<k$d;k$c++)this._displayNodeToFrame(k$b[k$c],k$a)}},k$b._displayNodeToFrame=function(k$a,k$b,k$c){k$c||(k$c=this._targetDic);var k$d=k$c[k$a.target];if(k$d){var k$e,k$f,k$g,k$h=k$a.frames,k$i=k$a.keys,k$j=0,k$k=k$i.length;for(k$j=0;k$j<k$k;k$j++)k$g=(k$f=k$h[k$e=k$i[k$j]]).length>k$b?k$f[k$b]:k$f[k$f.length-1],k$d[k$e]=k$g}},k$b._calculateDatas=function(){if(this._animationData){var k$a,k$b=this._animationData.nodes,k$c=0,k$d=k$b.length;for(k$c=this._count=0;k$c<k$d;k$c++)k$a=k$b[k$c],this._calculateNodeKeyFrames(k$a);this._count+=1}},k$b._calculateNodeKeyFrames=function(k$a){var k$b,k$c,k$d=k$a.keyframes,k$e=k$a.target;for(k$b in k$a.frames||(k$a.frames={}),k$a.keys?k$a.keys.length=0:k$a.keys=[],k$a.initValues||(k$a.initValues={}),k$d)k$c=k$d[k$b],k$a.frames[k$b]||(k$a.frames[k$b]=[]),this._targetDic&&this._targetDic[k$e]&&(k$a.initValues[k$b]=this._targetDic[k$e][k$b]),k$c.sort(k$f._sortIndexFun),k$a.keys.push(k$b),this._calculateNodePropFrames(k$c,k$a.frames[k$b],k$b,k$e)},k$b.resetToInitState=function(){if(this._targetDic&&this._animationData){var k$a,k$b,k$c=this._animationData.nodes,k$d=0,k$e=k$c.length;for(k$d=0;k$d<k$e;k$d++)if(k$b=(k$a=k$c[k$d]).initValues){var k$f,k$g=this._targetDic[k$a.target];if(k$g)for(k$f in k$b)k$g[k$f]=k$b[k$f]}}},k$b._calculateNodePropFrames=function(k$a,k$b,k$c,k$d){var k$e=0,k$f=k$a.length-1;if(0<k$f){for(k$b.length=k$a[k$f].index+1,k$e=0;k$e<k$f;k$e++)this._dealKeyFrame(k$a[k$e]),this._calculateFrameValues(k$a[k$e],k$a[k$e+1],k$b);this._dealKeyFrame(k$a[k$e])}0==k$f&&(k$b[k$a[0].index]=k$a[0].value,this._animationNewFrames&&(this._animationNewFrames[k$a[0].index]=!0))},k$b._dealKeyFrame=function(k$a){k$a.label&&""!=k$a.label&&this.addLabel(k$a.label,k$a.index)},k$b._calculateFrameValues=function(k$a,k$b,k$c){var k$d,k$e=0,k$f=k$a.index,k$g=k$b.index,k$h=k$a.value,k$i=k$b.value-k$a.value,k$j=k$g-k$f;if(k$g>this._count&&(this._count=k$g),k$a.tween)for(null==(k$d=k$U[k$a.tweenMethod])&&(k$d=k$U.linearNone),k$e=k$f;k$e<k$g;k$e++)k$c[k$e]=k$d(k$e-k$f,k$h,k$i,k$j),this._animationNewFrames&&(this._animationNewFrames[k$e]=!0);else for(k$e=k$f;k$e<k$g;k$e++)k$c[k$e]=k$h;this._animationNewFrames&&(this._animationNewFrames[k$a.index]=!0,this._animationNewFrames[k$b.index]=!0),k$c[k$b.index]=k$b.value},k$f._sortIndexFun=null,k$f}(k$pa)),k$xa=function(k$b){function k$e(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",k$e.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=k$qa.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}k$k(k$e,"laya.display.Input",k$b);var k$a=k$e.prototype;return k$a.setSelection=function(k$a,k$b){this.focus=!0,laya.display.Input.inputElement.selectionStart=k$a,laya.display.Input.inputElement.selectionEnd=k$b},k$a._onUnDisplay=function(k$a){this.focus=!1},k$a._onMouseDown=function(k$a){this.focus=!0},k$a._syncInputTransform=function(){var k$a=this.nativeInput,k$b=k$$.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),k$c=this._width-this.padding[1]-this.padding[3],k$d=this._height-this.padding[0]-this.padding[2];k$J.isConchApp?(k$a.setScale(k$b.scaleX,k$b.scaleY),k$a.setSize(k$c,k$d),k$a.setPos(k$b.x,k$b.y)):(k$e.inputContainer.style.transform=k$e.inputContainer.style.webkitTransform="scale("+k$b.scaleX+","+k$b.scaleY+") rotate("+k$z.stage.canvasDegree+"deg)",k$a.style.width=k$c+"px",k$a.style.height=k$d+"px",k$e.inputContainer.style.left=k$b.x+"px",k$e.inputContainer.style.top=k$b.y+"px")},k$a.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},k$a._setInputMethod=function(){k$e.input.parentElement&&k$e.inputContainer.removeChild(k$e.input),k$e.area.parentElement&&k$e.inputContainer.removeChild(k$e.area),k$e.inputElement=this._multiline?k$e.area:k$e.input,k$e.inputContainer.appendChild(k$e.inputElement),k$qa.RightToLeft&&(k$e.inputElement.style.direction="rtl")},k$a._focusIn=function(){laya.display.Input.isInputting=!0;var k$a=this.nativeInput;this._focus=!0;var k$b=k$a.style;k$b.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),k$a.readOnly=!this._editable,k$J.isConchApp&&(k$a.setType(this._type),k$a.setForbidEdit(!this._editable)),k$a.maxLength=this._maxChars;this.padding;if(k$a.type=this._type,k$a.value=this._content,k$a.placeholder=this._prompt,k$z.stage.off("keydown",this,this._onKeyDown),k$z.stage.on("keydown",this,this._onKeyDown),(k$z.stage.focus=this).event("focus"),k$O.onPC&&k$a.focus(),!k$O.onMiniGame){this._text;this._text=null}this.typeset(),k$a.setColor(this._originColor),k$a.setFontSize(this.fontSize),k$a.setFontFace(k$O.onIPhone&&k$qa._fontFamilyMap[this.font]||this.font),k$J.isConchApp&&k$a.setMultiAble&&k$a.setMultiAble(this._multiline),k$b.lineHeight=this.leading+this.fontSize+"px",k$b.fontStyle=this.italic?"italic":"normal",k$b.fontWeight=this.bold?"bold":"normal",k$b.textAlign=this.align,k$b.padding="0 0",this._syncInputTransform(),!k$J.isConchApp&&k$O.onPC&&k$z.timer.frameLoop(1,this,this._syncInputTransform)},k$a._setPromptColor=function(){(k$e.promptStyleDOM=k$O.getElementById("promptStyle"))||((k$e.promptStyleDOM=k$O.createElement("style")).setAttribute("id","promptStyle"),k$O.document.head.appendChild(k$e.promptStyleDOM)),k$e.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},k$a._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(k$z.superSet(k$qa,this,"text",this._content),k$z.superSet(k$qa,this,"color",this._originColor)):(k$z.superSet(k$qa,this,"text",this._prompt),k$z.superSet(k$qa,this,"color",this._promptColor)),k$z.stage.off("keydown",this,this._onKeyDown),k$z.stage.focus=null,this.event("blur"),k$J.isConchApp&&this.nativeInput.blur(),k$O.onPC&&k$z.timer.clear(this,this._syncInputTransform)},k$a._onKeyDown=function(k$a){13===k$a.keyCode&&(k$O.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},k$a.changeText=function(k$a){this._content=k$a,this._focus?(this.nativeInput.value=k$a||"",this.event("change")):k$b.prototype.changeText.call(this,k$a)},k$o(0,k$a,"color",k$b.prototype._$get_color,function(k$a){this._focus&&this.nativeInput.setColor(k$a),k$z.superSet(k$qa,this,"color",this._content?k$a:this._promptColor),this._originColor=k$a}),k$o(0,k$a,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(k$a){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),k$o(0,k$a,"multiline",function(){return this._multiline},function(k$a){this._multiline=k$a,this.valign=k$a?"top":"middle"}),k$o(0,k$a,"maxChars",function(){return this._maxChars},function(k$a){k$a<=0&&(k$a=1e5),this._maxChars=k$a}),k$o(0,k$a,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(k$a){k$z.superSet(k$qa,this,"color",this._originColor),k$a+="",this._focus?(this.nativeInput.value=k$a||"",this.event("change")):(this._multiline||(k$a=k$a.replace(/\r?\n/g,"")),(this._content=k$a)?k$z.superSet(k$qa,this,"text",k$a):(k$z.superSet(k$qa,this,"text",this._prompt),k$z.superSet(k$qa,this,"color",this.promptColor)))}),k$o(0,k$a,"nativeInput",function(){return this._multiline?k$e.area:k$e.input}),k$o(0,k$a,"prompt",function(){return this._prompt},function(k$a){!this._text&&k$a&&k$z.superSet(k$qa,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?k$z.superSet(k$qa,this,"text",this._text==this._prompt?k$a:this._text):k$z.superSet(k$qa,this,"text",k$a),this._prompt=k$qa.langPacks&&k$qa.langPacks[k$a]?k$qa.langPacks[k$a]:k$a}),k$o(0,k$a,"focus",function(){return this._focus},function(k$a){var k$b=this.nativeInput;this._focus!==k$a&&(k$a?(k$b.target?k$b.target._focusOut():this._setInputMethod(),(k$b.target=this)._focusIn()):(k$b.target=null,this._focusOut(),k$O.document.body.scrollTop=0,k$b.blur(),k$J.isConchApp?k$b.setPos(-1e4,-1e4):k$e.inputContainer.contains(k$b)&&k$e.inputContainer.removeChild(k$b)))}),k$o(0,k$a,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(k$a){k$a?(-1<(k$a="[^"+k$a+"]").indexOf("^^")&&(k$a=k$a.replace("^^","")),this._restrictPattern=new RegExp(k$a,"g")):this._restrictPattern=null}),k$o(0,k$a,"editable",function(){return this._editable},function(k$a){this._editable=k$a,k$J.isConchApp&&k$e.input.setForbidEdit(!k$a)}),k$o(0,k$a,"promptColor",function(){return this._promptColor},function(k$a){this._promptColor=k$a,this._content||k$z.superSet(k$qa,this,"color",k$a)}),k$o(0,k$a,"type",function(){return this._type},function(k$a){this._getCSSStyle().password="password"==k$a,this._type=k$a,k$J.isConchApp&&this.nativeInput.setType(k$a)}),k$o(0,k$a,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(k$a){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),k$o(0,k$a,"asPassword",function(){return this._getCSSStyle().password},function(k$a){this._getCSSStyle().password=k$a,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),k$e.__init__=function(){k$e._createInputElement(),k$O.onMobile&&k$J.canvas.addEventListener(k$e.IOS_IFRAME?k$O.onMiniGame?"touchend":"click":"touchend",k$e._popupInputMethod)},k$e._popupInputMethod=function(k$a){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},k$e._createInputElement=function(){k$e._initInput(k$e.area=k$O.createElement("textarea")),k$e._initInput(k$e.input=k$O.createElement("input")),(k$e.inputContainer=k$O.createElement("div")).style.position="absolute",k$e.inputContainer.style.zIndex=1e5,k$O.container.appendChild(k$e.inputContainer),k$e.inputContainer.setPos=function(k$a,k$b){k$e.inputContainer.style.left=k$a+"px",k$e.inputContainer.style.top=k$b+"px"}},k$e._initInput=function(k$b){var k$a=k$b.style;k$a.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",k$a.resize="none",k$a.backgroundColor="transparent",k$a.border="none",k$a.outline="none",k$a.zIndex=1,k$b.addEventListener("input",k$e._processInputting),k$b.addEventListener("mousemove",k$e._stopEvent),k$b.addEventListener("mousedown",k$e._stopEvent),k$b.addEventListener("touchmove",k$e._stopEvent),k$b.setFontFace=function(k$a){k$b.style.fontFamily=k$a},k$J.isConchApp||(k$b.setColor=function(k$a){k$b.style.color=k$a},k$b.setFontSize=function(k$a){k$b.style.fontSize=k$a+"px"})},k$e._processInputting=function(k$a){var k$b=laya.display.Input.inputElement.target;if(k$b){var k$c=laya.display.Input.inputElement.value;k$b._restrictPattern&&(k$c=k$c.replace(/\u2006|\x27/g,""),k$b._restrictPattern.test(k$c)&&(k$c=k$c.replace(k$b._restrictPattern,""),laya.display.Input.inputElement.value=k$c)),k$b._text=k$c,k$b.event("input")}},k$e._stopEvent=function(k$a){"touchmove"==k$a.type&&k$a.preventDefault(),k$a.stopPropagation&&k$a.stopPropagation()},k$e.TYPE_TEXT="text",k$e.TYPE_PASSWORD="password",k$e.TYPE_EMAIL="email",k$e.TYPE_URL="url",k$e.TYPE_NUMBER="number",k$e.TYPE_RANGE="range",k$e.TYPE_DATE="date",k$e.TYPE_MONTH="month",k$e.TYPE_WEEK="week",k$e.TYPE_TIME="time",k$e.TYPE_DATE_TIME="datetime",k$e.TYPE_DATE_TIME_LOCAL="datetime-local",k$e.TYPE_SEARCH="search",k$e.input=null,k$e.area=null,k$e.inputElement=null,k$e.inputContainer=null,k$e.confirmButton=null,k$e.promptStyleDOM=null,k$e.inputHeight=45,k$e.isInputting=!1,k$e.stageMatrix=null,k$i(k$e,["IOS_IFRAME",function(){return this.IOS_IFRAME=k$O.onIOS&&k$O.window.top!=k$O.window.self}]),k$e}(k$qa),k$ya=function(k$a){function k$c(k$a,k$b){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,k$c.__super.call(this),k$a&&this._init_(k$a,k$b)}k$k(k$c,"laya.resource.HTMLImage",k$sa);var k$b=k$c.prototype;return k$b._init_=function(k$a,k$b){this._src=k$a,this._source=new k$O.window.Image,k$b&&(k$b.onload&&(this.onload=k$b.onload),k$b.onerror&&(this.onerror=k$b.onerror),k$b.onCreate&&k$b.onCreate(this)),0!=k$a.indexOf("data:image")&&(this._source.crossOrigin=""),k$a&&(this._source.src=k$a)},k$b.recreateResource=function(){var k$a=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var k$b=this;this._source=new k$O.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(k$b._needReleaseAgain)return k$b._needReleaseAgain=!1,k$b._source.onload=null,void(k$b._source=null);k$b._source.onload=null,k$b.memorySize=k$a._w*k$a._h*4,k$b._recreateLock=!1,k$b.completeCreate()},this._source.src=this._src}},k$b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},k$b.onresize=function(){this._w=this._source.width,this._h=this._source.height},k$o(0,k$b,"onload",null,function(k$a){var k$b=this;this._onload=k$a,this._source&&(this._source.onload=null!=this._onload?function(){k$b.onresize(),k$b._onload()}:null)}),k$o(0,k$b,"onerror",null,function(k$a){var k$b=this;this._onerror=k$a,this._source&&(this._source.onerror=null!=this._onerror?function(){k$b._onerror()}:null)}),k$o(0,k$b,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(k$a){this._enableMerageInAtlas=k$a,k$J.isConchApp&&this._source&&(this._source.enableMerageInAtlas=k$a)}),k$c.create=function(k$a,k$b){return new k$c(k$a,k$b)},k$c}(),k$za=(function(k$f){function k$a(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,k$a.__super.call(this)}k$k(k$a,"laya.display.EffectAnimation",k$f);var k$b=k$a.prototype;k$b._onOtherBegin=function(k$a){k$a!=this&&this.stop()},k$b.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},k$b._onPlayAction=function(){this.play(0,!1)},k$b.play=function(k$a,k$b,k$c,k$d){void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=!0),void 0===k$c&&(k$c=""),void 0===k$d&&(k$d=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,k$a,k$b,k$c,k$d))},k$b._recordInitData=function(){if(this._aniKeys){var k$a,k$b,k$c=0;for(k$a=this._aniKeys.length,k$c=0;k$c<k$a;k$c++)k$b=this._aniKeys[k$c],this._initData[k$b]=this._target[k$b]}},k$b._displayToIndex=function(k$a){if(this._animationData){k$a<0&&(k$a=0),k$a>this._count&&(k$a=this._count);var k$b=this._animationData.nodes,k$c=0,k$d=k$b.length;for(k$d=1<k$d?1:k$d,k$c=0;k$c<k$d;k$c++)this._displayNodeToFrame(k$b[k$c],k$a)}},k$b._displayNodeToFrame=function(k$a,k$b,k$c){if(this._target){var k$d;k$d=this._target;var k$e,k$f,k$g,k$h,k$i=k$a.frames,k$j=k$a.keys,k$k=0,k$l=k$j.length;k$h=k$a.secondFrames;var k$m,k$n,k$o,k$p,k$q=0;for(k$k=0;k$k<k$l;k$k++)k$f=k$i[k$e=k$j[k$k]],k$g=-1==(k$q=k$h[k$e])?this._initData[k$e]:k$b<k$q?(k$o=(k$n=k$a.keyframes[k$e])[0]).tween?(null==(k$m=k$U[k$o.tweenMethod])&&(k$m=k$U.linearNone),k$p=k$n[1],k$m(k$b,this._initData[k$e],k$p.value-this._initData[k$e],k$p.index)):this._initData[k$e]:k$f.length>k$b?k$f[k$b]:k$f[k$f.length-1],k$d[k$e]=k$g}},k$b._calculateNodeKeyFrames=function(k$a){k$f.prototype._calculateNodeKeyFrames.call(this,k$a);var k$b,k$c,k$d,k$e=k$a.keyframes;k$a.target;for(k$b in k$d={},k$a.secondFrames=k$d,k$e)(k$c=k$e[k$b]).length<=1?k$d[k$b]=-1:k$d[k$b]=k$c[1].index},k$o(0,k$b,"target",function(){return this._target},function(k$a){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=k$a,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),k$o(0,k$b,"playEvent",null,function(k$a){(this._playEvents=k$a)&&this.addEvent()}),k$o(0,k$b,"effectData",null,function(k$a){var k$b;k$a&&((k$b=k$a.animations)&&k$b[0]&&(this._setUp({},k$b[0]),k$b[0].nodes&&k$b[0].nodes[0]&&(this._aniKeys=k$b[0].nodes[0].keys)))}),k$o(0,k$b,"effectClass",null,function(k$a){var k$b,k$c;(this._effectClass=k$R.getClass(k$a),this._effectClass)&&((k$b=this._effectClass.uiView)&&(k$c=k$b.animations)&&k$c[0]&&(this._setUp({},k$c[0]),k$c[0].nodes&&k$c[0].nodes[0]&&(this._aniKeys=k$c[0].nodes[0].keys)))}),k$a.EffectAnimationBegin="effectanimationbegin"}(k$wa),function(k$b){var k$D;function k$E(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,k$E.__super.call(this)}k$k(k$E,"laya.utils.GraphicAnimation",k$b);var k$a=k$E.prototype;return k$a._parseNodeList=function(k$a){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[k$a.compId]=k$a.props,k$a.compId&&this._nodeList.push(k$a.compId);var k$b=k$a.child;if(k$b){var k$c=0,k$d=k$b.length;for(k$c=0;k$c<k$d;k$c++)this._parseNodeList(k$b[k$c])}},k$a._calGraphicData=function(k$a){var k$b;if(this._setUp(null,k$a),this._createGraphicData(),this._nodeIDAniDic)for(k$b in this._nodeIDAniDic)this._nodeIDAniDic[k$b]=null},k$a._createGraphicData=function(){var k$a,k$b=[],k$c=0,k$d=this.count,k$e=this._animationNewFrames;for(k$e||(k$e=[]),k$c=0;k$c<k$d;k$c++)!k$e[k$c]&&k$a||(k$a=this._createFrameGraphic(k$c)),k$b.push(k$a);this._gList=k$b},k$a._createFrameGraphic=function(k$a){var k$b=k$F.createGraphics();return k$E._rootMatrix||(k$E._rootMatrix=new k$G),this._updateNodeGraphic(this._rootNode,k$a,k$E._rootMatrix,k$b),k$b},k$a._updateNodeGraphic=function(k$a,k$b,k$c,k$d,k$e){var k$f;void 0===k$e&&(k$e=1);var k$g,k$h,k$i,k$j=(k$f=this._nodeGDic[k$a.compId]=this._getNodeGraphicData(k$a.compId,k$b,this._nodeGDic[k$a.compId])).alpha*k$e;if(!(k$j<.01)&&(k$f.resultTransform||(k$f.resultTransform=k$G.create()),k$g=k$f.resultTransform,k$G.mul(k$f.transform,k$c,k$g),k$f.skin&&(k$h=this._getTextureByUrl(k$f.skin))&&(k$g._checkTransform()?(k$d.drawTexture(k$h,0,0,k$f.width,k$f.height,k$g,k$j),k$f.resultTransform=null):k$d.drawTexture(k$h,k$g.tx,k$g.ty,k$f.width,k$f.height,null,k$j)),k$i=k$a.child)){var k$k,k$l=0;for(k$k=k$i.length,k$l=0;k$l<k$k;k$l++)this._updateNodeGraphic(k$i[k$l],k$b,k$g,k$d,k$j)}},k$a._updateNoChilds=function(k$a,k$b){if(k$a.skin){var k$c=this._getTextureByUrl(k$a.skin);if(k$c){var k$d=k$a.transform;k$d._checkTransform();!k$d.bTransform?k$b.drawTexture(k$c,k$d.tx,k$d.ty,k$a.width,k$a.height,null,k$a.alpha):k$b.drawTexture(k$c,0,0,k$a.width,k$a.height,k$d.clone(),k$a.alpha)}}},k$a._updateNodeGraphic2=function(k$a,k$b,k$c){var k$d;if(k$d=this._nodeGDic[k$a.compId]=this._getNodeGraphicData(k$a.compId,k$b,this._nodeGDic[k$a.compId]),k$a.child){var k$e=k$d.transform;k$e._checkTransform();var k$f,k$g;k$g=(k$f=!k$e.bTransform)&&(0!=k$e.tx||0!=k$e.ty);var k$h,k$i,k$j;if((k$h=k$e.bTransform||1!=k$d.alpha)&&k$c.save(),1!=k$d.alpha&&k$c.alpha(k$d.alpha),k$f?k$g&&k$c.translate(k$e.tx,k$e.ty):k$c.transform(k$e.clone()),k$i=k$a.child,k$d.skin&&(k$j=this._getTextureByUrl(k$d.skin))&&k$c.drawTexture(k$j,0,0,k$d.width,k$d.height),k$i){var k$k,k$l=0;for(k$k=k$i.length,k$l=0;k$l<k$k;k$l++)this._updateNodeGraphic2(k$i[k$l],k$b,k$c)}k$h?k$c.restore():k$f?k$g&&k$c.translate(-k$e.tx,-k$e.ty):k$c.transform(k$e.clone().invert())}else this._updateNoChilds(k$d,k$c)},k$a._calculateNodeKeyFrames=function(k$a){k$b.prototype._calculateNodeKeyFrames.call(this,k$a),this._nodeIDAniDic[k$a.target]=k$a},k$a.getNodeDataByID=function(k$a){return this._nodeIDAniDic[k$a]},k$a._getParams=function(k$a,k$b,k$c,k$d){var k$e=k$E._temParam;k$e.length=k$b.length;var k$f=0,k$g=k$b.length;for(k$f=0;k$f<k$g;k$f++)k$e[k$f]=this._getObjVar(k$a,k$b[k$f][0],k$c,k$b[k$f][1],k$d);return k$e},k$a._getObjVar=function(k$a,k$b,k$c,k$d,k$e){if(k$a.hasOwnProperty(k$b)){var k$f=k$a[k$b];if(k$c>=k$f.length&&(k$c=k$f.length-1),null!=k$a[k$b][k$c])return k$a[k$b][k$c]}return k$e.hasOwnProperty(k$b)?k$e[k$b]:k$d},k$a._getNodeGraphicData=function(k$a,k$b,k$c){k$c||(k$c=k$D.create()),k$c.transform?k$c.transform.identity():k$c.transform=k$G.create();var k$d=this.getNodeDataByID(k$a);if(!k$d)return k$c;var k$e,k$f,k$g=k$d.frames,k$h=this._getParams(k$g,k$E._drawTextureCmd,k$b,this._nodeDefaultProps[k$a]),k$i=k$h[0],k$j=NaN,k$k=NaN,k$l=k$h[5],k$m=k$h[6],k$n=k$h[13],k$o=k$h[14],k$p=k$h[7],k$q=k$h[8],k$r=k$h[9],k$s=k$h[11],k$t=k$h[12];k$j=k$h[3],k$k=k$h[4],0!=k$j&&0!=k$k||(k$i=null),-1==k$j&&(k$j=0),-1==k$k&&(k$k=0),k$c.skin=k$i,k$c.width=k$j,k$c.height=k$k,k$i&&((k$e=this._getTextureByUrl(k$i))?(k$j||(k$j=k$e.sourceWidth),k$k||(k$k=k$e.sourceHeight)):console.warn("lost skin:",k$i,",you may load pics first")),k$c.alpha=k$h[10],k$f=k$c.transform,0!=k$n&&(k$l=k$n*k$j),0!=k$o&&(k$m=k$o*k$k),0==k$l&&0==k$m||k$f.translate(-k$l,-k$m);var k$w=null;if(k$r||1!==k$p||1!==k$q||k$s||k$t){(k$w=k$E._tempMt).identity(),k$w.bTransform=!0;var k$x=.0174532922222222*(k$r-k$s),k$y=.0174532922222222*(k$r+k$t),k$z=Math.cos(k$y),k$A=Math.sin(k$y),k$B=Math.sin(k$x),k$C=Math.cos(k$x);k$w.a=k$p*k$z,k$w.b=k$p*k$A,k$w.c=-k$q*k$B,k$w.d=k$q*k$C,k$w.tx=k$w.ty=0}return k$w&&(k$f=k$G.mul(k$f,k$w,k$f)),k$f.translate(k$h[1],k$h[2]),k$c},k$a._getTextureByUrl=function(k$a){return k$ha.getRes(k$a)},k$a.setAniData=function(k$a,k$b){if(k$a.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=k$a,this._parseNodeList(k$a);var k$c,k$d={},k$e=[],k$f=k$a.animations,k$g=0,k$h=k$f.length;for(k$g=0;k$g<k$h;k$g++)if(k$c=k$f[k$g],this._labels=null,(!k$b||k$b==k$c.name)&&k$c){try{this._calGraphicData(k$c)}catch(k$a){console.warn("parse animation fail:"+k$c.name+",empty animation created"),this._gList=[]}var k$i={};k$i.interval=1e3/k$c.frameRate,k$i.frames=this._gList,k$i.labels=this._labels,k$i.name=k$c.name,k$e.push(k$i),k$d[k$c.name]=k$i}this.animationList=k$e,this.animationDic=k$d}k$E._temParam.length=0},k$a.parseByData=function(k$a){var k$b,k$c;k$b=k$a.nodeRoot,k$c=k$a.aniO,delete k$a.nodeRoot,delete k$a.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=k$b,this._parseNodeList(k$b),this._labels=null;try{this._calGraphicData(k$c)}catch(k$a){console.warn("parse animation fail:"+k$c.name+",empty animation created"),this._gList=[]}var k$d=k$a;return k$d.interval=1e3/k$c.frameRate,k$d.frames=this._gList,k$d.labels=this._labels,k$d.name=k$c.name,k$d},k$a.setUpAniData=function(k$a){if(k$a.animations){var k$b,k$c={},k$d=[],k$e=k$a.animations,k$f=0,k$g=k$e.length;for(k$f=0;k$f<k$g;k$f++)if(k$b=k$e[k$f]){var k$h={};k$h.name=k$b.name,k$h.aniO=k$b,k$h.nodeRoot=k$a,k$d.push(k$h),k$c[k$b.name]=k$h}this.animationList=k$d,this.animationDic=k$c}},k$a._clear=function(){var k$a,k$b;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(k$a in this._nodeGDic)(k$b=this._nodeGDic[k$a])&&k$b.recover();this._nodeGDic=null},k$E.parseAnimationByData=function(k$a){var k$b;return k$E._I||(k$E._I=new k$E),k$b=k$E._I.parseByData(k$a),k$E._I._clear(),k$b},k$E.parseAnimationData=function(k$a){var k$b;return k$E._I||(k$E._I=new k$E),k$E._I.setUpAniData(k$a),(k$b={}).animationList=k$E._I.animationList,k$b.animationDic=k$E._I.animationDic,k$E._I._clear(),k$b},k$E._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],k$E._temParam=[],k$E._I=null,k$E._rootMatrix=null,k$i(k$E,["_tempMt",function(){return this._tempMt=new k$G}]),k$E.__init$=function(){k$D=function(){function k$a(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return k$k(k$a,""),k$a.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),k$W.recover("GraphicNode",this)},k$a.create=function(){return k$W.getItemByClass("GraphicNode",k$a)},k$a}()},k$E}(k$wa));k$z.__init([k$j,k$ia,k$J,k$O,k$Y,k$C,k$a,k$za])}(window,document,Laya),function(k$a,k$b,k$c){k$c.un,k$c.uns,k$c.static;var k$d=k$c.class;k$c.getset,k$c.__newvec;new(function(){function k$a(){}return k$d(k$a,"LayaMain"),k$a}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(k$a,k$b){"use strict";for(var k$c in Object.defineProperty(k$b,"__esModule",{value:!0}),Laya){var k$d=Laya[k$c];k$d&&k$d.__isclass&&(k$b[k$c]=k$d)}}),function(k$a,k$b,k$y){k$y.un,k$y.uns;var k$g=k$y.static,k$m=k$y.class,k$d=k$y.getset,k$f=k$y.__newvec,k$k=laya.maths.Arith,k$l=laya.maths.Bezier,k$c=laya.resource.Bitmap,k$n=laya.utils.Browser,k$i=laya.utils.Byte,k$o=laya.utils.Color,k$z=(laya.filters.ColorFilter,k$y.Config),k$e=laya.resource.Context,k$A=(laya.events.Event,laya.filters.Filter),k$h=laya.display.Graphics,k$j=laya.resource.HTMLCanvas,k$p=(laya.utils.HTMLChar,laya.resource.HTMLImage),k$q=laya.resource.HTMLSubImage,k$B=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),k$C=laya.maths.Point,k$D=laya.maths.Rectangle,k$r=laya.renders.Render,k$s=(laya.renders.RenderContext,laya.renders.RenderSprite),k$t=laya.resource.Resource,k$w=laya.resource.ResourceManager,k$x=laya.utils.RunDriver,k$E=laya.display.Sprite,k$F=laya.display.Stage,k$G=laya.utils.Stat,k$H=laya.utils.StringKey,k$I=(laya.display.css.Style,laya.system.System),k$J=laya.display.Text,k$K=laya.resource.Texture,k$L=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),k$M=laya.utils.VectorGraphManager;laya.utils.WordText;k$y.interface("laya.webgl.shapes.IShape"),k$y.interface("laya.webgl.submit.ISubmit"),k$y.interface("laya.webgl.text.ICharSegment"),k$y.interface("laya.webgl.canvas.save.ISaveData"),k$y.interface("laya.webgl.resource.IMergeAtlasBitmap"),k$y.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var k$N=function(){function k$a(){}k$m(k$a,"laya.filters.webgl.FilterActionGL");var k$b=k$a.prototype;return k$y.imps(k$b,{"laya.filters.IFilterActionGL":!0}),k$b.setValue=function(k$a){},k$b.setValueMix=function(k$a){},k$b.apply3d=function(k$a,k$b,k$c,k$d,k$e){return null},k$b.apply=function(k$a){return null},k$d(0,k$b,"typeMix",function(){return 0}),k$a}(),k$O=function(){function k$a(){}return k$m(k$a,"laya.webgl.shader.ShaderValue"),k$a}(),k$P=function(){var k$d,k$e;function k$a(k$a,k$b,k$c){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new k$e,void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),this._cells=null,this._rowInfo=null,this._init(k$a,k$b),this._atlasID=k$c}k$m(k$a,"laya.webgl.atlas.AtlasGrid");var k$b=k$a.prototype;return k$b.getAltasID=function(){return this._atlasID},k$b.setAltasID=function(k$a){0<=k$a&&(this._atlasID=k$a)},k$b.addTex=function(k$a,k$b,k$c){var k$d=this._get(k$b,k$c);return 0==k$d.ret||(this._fill(k$d.x,k$d.y,k$b,k$c,k$a),this._texCount++),k$d},k$b._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},k$b._init=function(k$a,k$b){if(this._width=k$a,this._height=k$b,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=k$f(this._height);for(var k$c=0;k$c<this._height;k$c++)this._rowInfo[k$c]=new k$d;return this._clear(),!0},k$b._get=function(k$a,k$b){var k$c=new k$R;if(k$a>=this._failSize.width&&k$b>=this._failSize.height)return k$c;for(var k$d=-1,k$e=-1,k$f=this._width,k$g=this._height,k$h=this._cells,k$i=0;k$i<k$g;k$i++)if(!(this._rowInfo[k$i].spaceCount<k$a))for(var k$j=0;k$j<k$f;){var k$k=3*(k$i*k$f+k$j);if(0!=k$h[k$k]||k$h[1+k$k]<k$a||k$h[2+k$k]<k$b)k$j+=k$h[1+k$k];else{k$d=k$j,k$e=k$i;for(var k$l=0;k$l<k$a;k$l++)if(k$h[3*k$l+k$k+2]<k$b){k$d=-1;break}if(!(k$d<0))return k$c.ret=!0,k$c.x=k$d,k$c.y=k$e,k$c;k$j+=k$h[1+k$k]}}return k$c},k$b._fill=function(k$a,k$b,k$c,k$d,k$e){var k$f=this._width,k$g=this._height;this._check(k$a+k$c<=k$f&&k$b+k$d<=k$g);for(var k$h=k$b;k$h<k$d+k$b;++k$h){this._check(this._rowInfo[k$h].spaceCount>=k$c),this._rowInfo[k$h].spaceCount-=k$c;for(var k$i=0;k$i<k$c;k$i++){var k$j=3*(k$a+k$h*k$f+k$i);this._check(0==this._cells[k$j]),this._cells[k$j]=k$e,this._cells[1+k$j]=k$c,this._cells[2+k$j]=k$d}}if(0<k$a)for(k$h=0;k$h<k$d;++k$h){var k$k=0;for(k$i=k$a-1;0<=k$i&&0==this._cells[3*((k$b+k$h)*k$f+k$i)];--k$i,++k$k);for(k$i=k$k;0<k$i;--k$i)this._cells[3*((k$b+k$h)*k$f+k$a-k$i)+1]=k$i,this._check(0<k$i)}if(0<k$b)for(k$i=k$a;k$i<k$a+k$c;++k$i){for(k$k=0,k$h=k$b-1;0<=k$h&&0==this._cells[3*(k$i+k$h*k$f)];--k$h,k$k++);for(k$h=k$k;0<k$h;--k$h)this._cells[3*(k$i+(k$b-k$h)*k$f)+2]=k$h,this._check(0<k$h)}},k$b._check=function(k$a){0==k$a&&console.log("xtexMerger 错误啦")},k$b._clear=function(){for(var k$a=this._texCount=0;k$a<this._height;k$a++)this._rowInfo[k$a].spaceCount=this._width;for(var k$b=0;k$b<this._height;k$b++)for(var k$c=0;k$c<this._width;k$c++){var k$d=3*(k$b*this._width+k$c);this._cells[k$d]=0,this._cells[1+k$d]=this._width-k$c,this._cells[2+k$d]=this._width-k$b}this._failSize.width=this._width+1,this._failSize.height=this._height+1},k$a.__init$=function(){k$d=function(){function k$a(){this.spaceCount=0}return k$m(k$a,""),k$a}(),k$e=function(){function k$a(){this.width=0,this.height=0}return k$m(k$a,""),k$a}()},k$a}(),k$Q=function(){function k$r(k$a,k$b,k$c,k$d){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=k$a,this._height=k$b,this._gridSize=k$c,this._maxAtlaserCount=k$d,this._gridNumX=k$a/k$c,this._gridNumY=k$b/k$c,this._curAtlasIndex=0,this._atlaserArray=[]}k$m(k$r,"laya.webgl.atlas.AtlasResourceManager");var k$a=k$r.prototype;return k$a.setAtlasParam=function(k$a,k$b,k$c,k$d){if(1==this._setAtlasParam)return k$r._sid_=0,this._width=k$a,this._height=k$b,this._gridSize=k$c,this._maxAtlaserCount=k$d,this._gridNumX=k$a/k$c,this._gridNumY=k$b/k$c,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},k$a.pushData=function(k$a){var k$b,k$c=k$a.bitmap,k$d=-1,k$e=null,k$f=0,k$g=0;for(k$f=0,k$b=this._atlaserArray.length;k$f<k$b&&(k$g=(this._curAtlasIndex+k$f)%k$b,-1==(k$d=(k$e=this._atlaserArray[k$g]).findBitmapIsExist(k$c)));k$f++);if(-1!=k$d){var k$h=k$e.InAtlasWebGLImagesOffsetValue[k$d];return k$o=k$h[0],k$p=k$h[1],k$e.addToAtlas(k$a,k$o,k$p),!0}this._setAtlasParam=!1;for(var k$i=Math.ceil((k$a.bitmap.width+2)/this._gridSize),k$j=Math.ceil((k$a.bitmap.height+2)/this._gridSize),k$k=!1,k$l=0;k$l<2;k$l++){var k$m=this._maxAtlaserCount;for(k$f=0;k$f<k$m;k$f++){k$g=(this._curAtlasIndex+k$f)%k$m,this._atlaserArray.length-1>=k$g||this._atlaserArray.push(new k$Da(this._gridNumX,this._gridNumY,this._width,this._height,k$r._sid_++));var k$n=this._atlaserArray[k$g],k$o=0,k$p=0,k$q=k$n.addTex(1,k$i,k$j);if(k$q.ret){k$o=k$q.x*this._gridSize+1,k$p=k$q.y*this._gridSize+1,k$c.lock=!0,k$n.addToAtlasTexture(k$c,k$o,k$p),k$n.addToAtlas(k$a,k$o,k$p),k$k=!0,this._curAtlasIndex=k$g;break}}if(k$k)break;this._atlaserArray.push(new k$Da(this._gridNumX,this._gridNumY,this._width,this._height,k$r._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return k$k||console.log(">>>AtlasManager pushData error"),k$k},k$a.addToAtlas=function(k$a){laya.webgl.atlas.AtlasResourceManager.instance.pushData(k$a)},k$a.garbageCollection=function(){if(!0===this._needGC){for(var k$a=this._atlaserArray.length-this._maxAtlaserCount,k$b=0;k$b<k$a;k$b++)this._atlaserArray[k$b].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+k$a),this._atlaserArray.splice(0,k$a),this._needGC=!1}return!0},k$a.freeAll=function(){for(var k$a=0,k$b=this._atlaserArray.length;k$a<k$b;k$a++)this._atlaserArray[k$a].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},k$a.getAtlaserCount=function(){return this._atlaserArray.length},k$a.getAtlaserByIndex=function(k$a){return this._atlaserArray[k$a]},k$d(1,k$r,"instance",function(){return k$r._Instance||(k$r._Instance=new k$r(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),k$r._Instance}),k$d(1,k$r,"enabled",function(){return k$z.atlasEnable}),k$d(1,k$r,"atlasLimitWidth",function(){return k$r._atlasLimitWidth},function(k$a){k$r._atlasLimitWidth=k$a}),k$d(1,k$r,"atlasLimitHeight",function(){return k$r._atlasLimitHeight},function(k$a){k$r._atlasLimitHeight=k$a}),k$r._enable=function(){k$z.atlasEnable=!0},k$r._disable=function(){k$z.atlasEnable=!1},k$r.__init__=function(){k$r.atlasTextureWidth=2048,k$r.atlasTextureHeight=2048,k$r.maxTextureCount=6,k$r.atlasLimitWidth=512,k$r.atlasLimitHeight=512},k$r._atlasLimitWidth=0,k$r._atlasLimitHeight=0,k$r.gridSize=16,k$r.atlasTextureWidth=0,k$r.atlasTextureHeight=0,k$r.maxTextureCount=0,k$r._atlasRestore=0,k$r.BOARDER_TYPE_NO=0,k$r.BOARDER_TYPE_RIGHT=1,k$r.BOARDER_TYPE_LEFT=2,k$r.BOARDER_TYPE_BOTTOM=4,k$r.BOARDER_TYPE_TOP=8,k$r.BOARDER_TYPE_ALL=15,k$r._sid_=0,k$r._Instance=null,k$r}(),k$R=function(){function k$a(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return k$m(k$a,"laya.webgl.atlas.MergeFillInfo"),k$a}(),k$S=function(){function k$b(){}return k$m(k$b,"laya.webgl.canvas.BlendMode"),k$b._init_=function(k$a){k$b.fns=[k$b.BlendNormal,k$b.BlendAdd,k$b.BlendMultiply,k$b.BlendScreen,k$b.BlendOverlay,k$b.BlendLight,k$b.BlendMask,k$b.BlendDestinationOut],k$b.targetFns=[k$b.BlendNormalTarget,k$b.BlendAddTarget,k$b.BlendMultiplyTarget,k$b.BlendScreenTarget,k$b.BlendOverlayTarget,k$b.BlendLightTarget,k$b.BlendMask,k$b.BlendDestinationOut]},k$b.BlendNormal=function(k$a){k$a.blendFunc(1,771)},k$b.BlendAdd=function(k$a){k$a.blendFunc(1,772)},k$b.BlendMultiply=function(k$a){k$a.blendFunc(774,771)},k$b.BlendScreen=function(k$a){k$a.blendFunc(1,1)},k$b.BlendOverlay=function(k$a){k$a.blendFunc(1,769)},k$b.BlendLight=function(k$a){k$a.blendFunc(1,1)},k$b.BlendNormalTarget=function(k$a){k$a.blendFunc(1,771)},k$b.BlendAddTarget=function(k$a){k$a.blendFunc(1,772)},k$b.BlendMultiplyTarget=function(k$a){k$a.blendFunc(774,771)},k$b.BlendScreenTarget=function(k$a){k$a.blendFunc(1,1)},k$b.BlendOverlayTarget=function(k$a){k$a.blendFunc(1,769)},k$b.BlendLightTarget=function(k$a){k$a.blendFunc(1,1)},k$b.BlendMask=function(k$a){k$a.blendFunc(0,770)},k$b.BlendDestinationOut=function(k$a){k$a.blendFunc(0,0)},k$b.activeBlendFunction=null,k$b.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],k$b.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},k$b.NORMAL="normal",k$b.ADD="add",k$b.MULTIPLY="multiply",k$b.SCREEN="screen",k$b.LIGHT="light",k$b.OVERLAY="overlay",k$b.DESTINATIONOUT="destination-out",k$b.fns=[],k$b.targetFns=[],k$b}(),k$T=function(){function k$c(k$a){this._color=k$o.create("black"),this.setValue(k$a)}k$m(k$c,"laya.webgl.canvas.DrawStyle");var k$a=k$c.prototype;return k$a.setValue=function(k$a){if(k$a){if("string"==typeof k$a)return void(this._color=k$o.create(k$a));if(k$a instanceof laya.utils.Color)return void(this._color=k$a)}},k$a.reset=function(){this._color=k$o.create("black")},k$a.equal=function(k$a){return"string"==typeof k$a?this._color.strColor===k$a:k$a instanceof laya.utils.Color&&this._color.numColor===k$a.numColor},k$a.toColorStr=function(){return this._color.strColor},k$c.create=function(k$a){var k$b;if(k$a&&("string"==typeof k$a?k$b=k$o.create(k$a):k$a instanceof laya.utils.Color&&(k$b=k$a),k$b))return k$b._drawStyle||(k$b._drawStyle=new k$c(k$a));return laya.webgl.canvas.DrawStyle.DEFAULT},k$g(k$c,["DEFAULT",function(){return this.DEFAULT=new k$c("#000000")}]),k$c}(),k$U=function(){function k$a(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];k$wa.mainContext;this.ib=k$ua.create(35048),this.vb=k$va.create(5)}k$m(k$a,"laya.webgl.canvas.Path");var k$b=k$a.prototype;return k$b.addPoint=function(k$a,k$b){this.tempArray.push(k$a,k$b)},k$b.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},k$b.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},k$b.polygon=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g;return this.geomatrys.push(this._curGeomatry=k$g=new k$Ha(k$a,k$b,k$c,k$d,k$e,k$f)),k$d||(k$g.fill=!1),null==k$f&&(k$g.borderWidth=0),k$g},k$b.setGeomtry=function(k$a){this.geomatrys.push(this._curGeomatry=k$a)},k$b.drawLine=function(k$a,k$b,k$c,k$d,k$e){var k$f;return this.closePath?this.geomatrys.push(this._curGeomatry=k$f=new k$Ga(k$a,k$b,k$c,k$d,k$e)):this.geomatrys.push(this._curGeomatry=k$f=new k$Fa(k$a,k$b,k$c,k$d,k$e)),k$f.fill=!1,k$f},k$b.update=function(){var k$a=this.ib._byteLength,k$b=this.geomatrys.length;this.offset=k$a;for(var k$c=this.geoStart;k$c<k$b;k$c++)this.geomatrys[k$c].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=k$b,this.count=(this.ib._byteLength-k$a)/k$pa.BYTES_PIDX},k$b.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},k$b.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},k$a}(),k$V=function(){function k$h(){}k$m(k$h,"laya.webgl.canvas.save.SaveBase");var k$a=k$h.prototype;return k$y.imps(k$a,{"laya.webgl.canvas.save.ISaveData":!0}),k$a.isSaveMark=function(){return!1},k$a.restore=function(k$a){this._dataObj[this._valueName]=this._value,(k$h._cache[k$h._cache._length++]=this)._newSubmit&&(k$a._curSubmit=k$fa.RENDERBASE,k$a._renderKey=0)},k$h._createArray=function(){var k$a=[];return k$a._length=0,k$a},k$h._init=function(){var k$a=k$h._namemap={};return k$a[1]="ALPHA",k$a[2]="fillStyle",k$a[8]="font",k$a[256]="lineWidth",k$a[512]="strokeStyle",k$a[8192]="_mergeID",k$a[1024]=k$a[2048]=k$a[4096]=[],k$a[16384]="textBaseline",k$a[32768]="textAlign",k$a[65536]="_nBlendType",k$a[1048576]="shader",k$a[2097152]="filters",k$a},k$h.save=function(k$a,k$b,k$c,k$d){if((k$a._saveMark._saveuse&k$b)!==k$b){k$a._saveMark._saveuse|=k$b;var k$e=k$h._cache,k$f=0<k$e._length?k$e[--k$e._length]:new k$h;k$f._value=k$c[k$f._valueName=k$h._namemap[k$b]],k$f._dataObj=k$c,k$f._newSubmit=k$d;var k$g=k$a._save;k$g[k$g._length++]=k$f}},k$h._cache=laya.webgl.canvas.save.SaveBase._createArray(),k$h._namemap=k$h._init(),k$h}(),k$W=function(){function k$f(){this._clipRect=new k$D}k$m(k$f,"laya.webgl.canvas.save.SaveClipRect");var k$a=k$f.prototype;return k$y.imps(k$a,{"laya.webgl.canvas.save.ISaveData":!0}),k$a.isSaveMark=function(){return!1},k$a.restore=function(k$a){k$a._clipRect=this._clipSaveRect,(k$f._cache[k$f._cache._length++]=this)._submitScissor.submitLength=k$a._submits._length-this._submitScissor.submitIndex,k$a._curSubmit=k$fa.RENDERBASE,k$a._renderKey=0},k$f.save=function(k$a,k$b){if(131072!=(131072&k$a._saveMark._saveuse)){k$a._saveMark._saveuse|=131072;var k$c=k$f._cache,k$d=0<k$c._length?k$c[--k$c._length]:new k$f;k$d._clipSaveRect=k$a._clipRect,k$a._clipRect=k$d._clipRect.copyFrom(k$a._clipRect),k$d._submitScissor=k$b;var k$e=k$a._save;k$e[k$e._length++]=k$d}},k$g(k$f,["_cache",function(){return this._cache=k$V._createArray()}]),k$f}(),k$X=function(){function k$n(){this._contextX=0,this._contextY=0,this._clipRect=new k$D,this._rect=new k$D,this._matrix=new k$B}k$m(k$n,"laya.webgl.canvas.save.SaveClipRectStencil");var k$a=k$n.prototype;return k$y.imps(k$a,{"laya.webgl.canvas.save.ISaveData":!0}),k$a.isSaveMark=function(){return!1},k$a.restore=function(k$a){k$ka.restore(k$a,this._rect,this._saveMatrix,this._contextX,this._contextY),k$a._clipRect=this._clipSaveRect,k$a._curMat=this._saveMatrix,k$a._x=this._contextX,k$a._y=this._contextY,k$n._cache[k$n._cache._length++]=this,k$a._curSubmit=k$fa.RENDERBASE},k$n.save=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){if(262144!=(262144&k$a._saveMark._saveuse)){k$a._saveMark._saveuse|=262144;var k$k=k$n._cache,k$l=0<k$k._length?k$k[--k$k._length]:new k$n;k$l._clipSaveRect=k$a._clipRect,k$l._clipRect.setTo(k$g,k$h,k$i,k$j),k$a._clipRect=k$l._clipRect,k$l._rect.x=k$c,k$l._rect.y=k$d,k$l._rect.width=k$e,k$l._rect.height=k$f,k$l._contextX=k$a._x,k$l._contextY=k$a._y,k$l._saveMatrix=k$a._curMat,k$a._curMat.copyTo(k$l._matrix),k$a._curMat=k$l._matrix,k$l._submitStencil=k$b;var k$m=k$a._save;k$m[k$m._length++]=k$l}},k$g(k$n,["_cache",function(){return this._cache=k$V._createArray()}]),k$n}(),k$Y=function(){function k$d(){this._saveuse=0}k$m(k$d,"laya.webgl.canvas.save.SaveMark");var k$a=k$d.prototype;return k$y.imps(k$a,{"laya.webgl.canvas.save.ISaveData":!0}),k$a.isSaveMark=function(){return!0},k$a.restore=function(k$a){k$a._saveMark=this._preSaveMark,k$d._no[k$d._no._length++]=this},k$d.Create=function(k$a){var k$b=k$d._no,k$c=0<k$b._length?k$b[--k$b._length]:new k$d;return k$c._saveuse=0,k$c._preSaveMark=k$a._saveMark,k$a._saveMark=k$c},k$g(k$d,["_no",function(){return this._no=k$V._createArray()}]),k$d}(),k$Z=function(){function k$f(){this._matrix=new k$B}k$m(k$f,"laya.webgl.canvas.save.SaveTransform");var k$a=k$f.prototype;return k$y.imps(k$a,{"laya.webgl.canvas.save.ISaveData":!0}),k$a.isSaveMark=function(){return!1},k$a.restore=function(k$a){k$a._curMat=this._savematrix,k$f._no[k$f._no._length++]=this},k$f.save=function(k$a){var k$b=k$a._saveMark;if(2048!=(2048&k$b._saveuse)){k$b._saveuse|=2048;var k$c=k$f._no,k$d=0<k$c._length?k$c[--k$c._length]:new k$f;k$d._savematrix=k$a._curMat,k$a._curMat=k$a._curMat.copyTo(k$d._matrix);var k$e=k$a._save;k$e[k$e._length++]=k$d}},k$g(k$f,["_no",function(){return this._no=k$V._createArray()}]),k$f}(),k$$=function(){function k$e(){}k$m(k$e,"laya.webgl.canvas.save.SaveTranslate");var k$a=k$e.prototype;return k$y.imps(k$a,{"laya.webgl.canvas.save.ISaveData":!0}),k$a.isSaveMark=function(){return!1},k$a.restore=function(k$a){k$a._curMat;k$a._x=this._x,k$a._y=this._y,k$e._no[k$e._no._length++]=this},k$e.save=function(k$a){var k$b=k$e._no,k$c=0<k$b._length?k$b[--k$b._length]:new k$e;k$c._x=k$a._x,k$c._y=k$a._y;var k$d=k$a._save;k$d[k$d._length++]=k$c},k$g(k$e,["_no",function(){return this._no=k$V._createArray()}]),k$e}(),k$_=function(){function k$a(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new k$D}k$m(k$a,"laya.webgl.resource.RenderTargetMAX");var k$b=k$a.prototype;return k$b.setSP=function(k$a){this._sp=k$a},k$b.size=function(k$a,k$b){var k$c=this;this._width!==k$a||this._height!==k$b?(this.repaint=!0,this._width=k$a,this._height=k$b,this.target?this.target.size(k$a,k$b):this.target=k$Ma.create(k$a,k$b),this.target.hasListener("recovered")||this.target.on("recovered",this,function(k$a){k$y.timer.callLater(k$c._sp,k$c._sp.repaint)})):this.target.size(k$a,k$b)},k$b._flushToTarget=function(k$a,k$b){if(!k$b._destroy){var k$c=k$sa.worldScissorTest,k$d=k$sa.worldClipRect;k$sa.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,k$sa.worldScissorTest=!1,k$wa.mainContext.disable(3089);var k$e=k$sa.worldAlpha,k$f=k$sa.worldMatrix4,k$g=k$sa.worldMatrix,k$h=k$sa.worldFilters,k$i=k$sa.worldShaderDefines;if(k$sa.worldMatrix=k$B.EMPTY,k$sa.restoreTempArray(),k$sa.worldMatrix4=k$sa.TEMPMAT4_ARRAY,k$sa.worldAlpha=1,k$sa.worldFilters=null,k$sa.worldShaderDefines=null,k$La.activeShader=null,k$b.start(),k$z.showCanvasMark?k$b.clear(0,1,0,.3):k$b.clear(0,0,0,0),k$a.flush(),k$b.end(),k$La.activeShader=null,k$sa.worldAlpha=k$e,k$sa.worldMatrix4=k$f,k$sa.worldMatrix=k$g,k$sa.worldFilters=k$h,k$sa.worldShaderDefines=k$i,k$sa.worldScissorTest=k$c){var k$j=k$sa.height-k$d.y-k$d.height;k$wa.mainContext.scissor(k$d.x,k$j,k$d.width,k$d.height),k$wa.mainContext.enable(3089)}k$sa.worldClipRect=k$d}},k$b.flush=function(k$a){this.repaint&&(this._flushToTarget(k$a,this.target),this.repaint=!1)},k$b.drawTo=function(k$a,k$b,k$c,k$d,k$e){k$a.drawTexture(this.target.getTexture(),k$b,k$c,k$d,k$e,0,0)},k$b.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},k$a}(),k$u=function(){function k$a(){this.ALPHA=1,this.shaderType=0,this.defines=new k$Ea}return k$m(k$a,"laya.webgl.shader.d2.Shader2D"),k$a.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},k$a.__init__=function(){var k$a,k$b;k$Ya.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),k$Ya.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),k$Ya.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),k$Ya.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),k$Ya.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),k$Ya.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),k$Ya.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),k$Ya.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),k$a="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",k$b='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',k$Ya.preCompile2D(0,1,k$a,k$b,null),k$a="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",k$b='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',k$Ya.preCompile2D(0,2,k$a,k$b,null),k$a="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",k$b="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",k$Ya.preCompile2D(0,4,k$a,k$b,null),k$a="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",k$b='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',k$Ya.preCompile2D(0,256,k$a,k$b,null),k$a="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",k$b="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",k$Ya.preCompile2D(0,512,k$a,k$b,null)},k$a}(),k$v=function(){function k$b(k$a,k$b,k$c){this._value=0,this._name2int=k$a,this._int2name=k$b,this._int2nameMap=k$c}k$m(k$b,"laya.webgl.shader.ShaderDefines");var k$a=k$b.prototype;return k$a.add=function(k$a){return"string"==typeof k$a&&(k$a=this._name2int[k$a]),this._value|=k$a,this._value},k$a.addInt=function(k$a){return this._value|=k$a,this._value},k$a.remove=function(k$a){return"string"==typeof k$a&&(k$a=this._name2int[k$a]),this._value&=~k$a,this._value},k$a.isDefine=function(k$a){return(this._value&k$a)===k$a},k$a.getValue=function(){return this._value},k$a.setValue=function(k$a){this._value=k$a},k$a.toNameDic=function(){var k$a=this._int2nameMap[this._value];return k$a||k$b._toText(this._value,this._int2name,this._int2nameMap)},k$b._reg=function(k$a,k$b,k$c,k$d){k$d[k$c[k$a]=k$b]=k$a},k$b._toText=function(k$a,k$b,k$c){var k$d=k$c[k$a];if(k$d)return k$d;for(var k$e={},k$f=1,k$g=0;k$g<32&&!(k$a<(k$f=1<<k$g));k$g++)if(k$a&k$f){var k$h=k$b[k$f];k$h&&(k$e[k$h]="")}return k$c[k$a]=k$e},k$b._toInt=function(k$a,k$b){for(var k$c=k$a.split("."),k$d=0,k$e=0,k$f=k$c.length;k$e<k$f;k$e++){var k$g=k$b[k$c[k$e]];if(!k$g)throw new Error("Defines to int err:"+k$a+"/"+k$c[k$e]);k$d|=k$g}return k$d},k$b}(),k$aa=function(){function k$g(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new k$B}k$m(k$g,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var k$a=k$g.prototype;return k$a.init=function(k$a,k$b,k$c){if(k$b)this._vs=k$b;else{this._vs=[];var k$d=k$a.width,k$e=k$a.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(k$d,0,1,0,1,1,1,1),this._vs.push(k$d,k$e,1,1,1,1,1,1),this._vs.push(0,k$e,0,1,1,1,1,1)}k$c?this._ps=k$c:(k$g._defaultPS||(k$g._defaultPS=[]).push(0,1,3,3,1,2),this._ps=k$g._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=k$a},k$a.init2=function(k$a,k$b,k$c,k$d,k$e){this.transform&&(this.transform=null),k$c?this._ps=k$c:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=k$d,this._uvs=k$e,this.mEleNum=this._ps.length,this.mTexture=k$a,(k$r.isConchNode||k$r.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},k$a._initMyData=function(){var k$a=0,k$b=0,k$c=4*this._verticles.length;this._vs=k$g._tempVS;var k$d=!1;if(k$r.isConchNode||k$r.isConchApp?(this._vs.length=k$c,k$d=!0):this._vs.length<k$c&&(this._vs.length=k$c,k$d=!0),k$g._tVSLen=k$c,k$d)for(;k$a<k$c;)this._vs[k$a]=this._verticles[k$b],this._vs[k$a+1]=this._verticles[k$b+1],this._vs[k$a+2]=this._uvs[k$b],this._vs[k$a+3]=this._uvs[k$b+1],this._vs[k$a+4]=1,this._vs[k$a+5]=1,this._vs[k$a+6]=1,this._vs[k$a+7]=1,k$a+=8,k$b+=2;else for(;k$a<k$c;)this._vs[k$a]=this._verticles[k$b],this._vs[k$a+1]=this._verticles[k$b+1],this._vs[k$a+2]=this._uvs[k$b],this._vs[k$a+3]=this._uvs[k$b+1],k$a+=8,k$b+=2},k$a.getData2=function(k$a,k$b,k$c){var k$d;this.mVBBuffer=k$a,this.mIBBuffer=k$b,this._initMyData(),k$a.appendEx2(this._vs,Float32Array,k$g._tVSLen,4),this._indexStart=k$b._byteLength,(k$d=k$g._tempIB).length<this._ps.length&&(k$d.length=this._ps.length);for(var k$e=0,k$f=this._ps.length;k$e<k$f;k$e++)k$d[k$e]=this._ps[k$e]+k$c;k$b.appendEx2(k$d,Uint16Array,this._ps.length,2)},k$a.getData=function(k$a,k$b,k$c){if(this.mVBBuffer=k$a,this.mIBBuffer=k$b,k$a.append(this.mVBData),this._indexStart=k$b._byteLength,this.mIBData.start!=k$c){for(var k$d=0,k$e=this._ps.length;k$d<k$e;k$d++)this.mIBData[k$d]=this._ps[k$d]+k$c;this.mIBData.start=k$c}k$b.append(this.mIBData)},k$a.render=function(k$a,k$b,k$c){if(k$r.isWebGL&&this.mTexture){k$a._renderKey=0,k$a._shader2D.glTexture=null,k$ba.getInstance().addSkinMesh(this);var k$d=k$fa.createShape(k$a,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,k$Aa.create(512,0));this.transform||(this.transform=k$B.EMPTY),this.transform.translate(k$b,k$c),k$B.mul(this.transform,k$a._curMat,this._tempMatrix),this.transform.translate(-k$b,-k$c);var k$e=k$d.shaderValue,k$f=k$e.u_mmat2||k$sa.getMatrArray();k$sa.mat2MatArray(this._tempMatrix,k$f),k$e.textureHost=this.mTexture,k$e.offsetX=0,k$e.offsetY=0,k$e.u_mmat2=k$f,k$e.ALPHA=k$a._shader2D.ALPHA,k$a._submits[k$a._submits._length++]=k$d}else k$r.isConchApp&&this.mTexture&&(this.transform||(this.transform=k$B.EMPTY),k$a.setSkinMesh&&k$a.setSkinMesh(k$b,k$c,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},k$g._tempVS=[],k$g._tempIB=[],k$g._defaultPS=null,k$g._tVSLen=0,k$g}(),k$ba=function(){function k$a(){this.ib=null,this.vb=null;k$wa.mainContext;this.ib=k$ua.create(35048),this.vb=k$va.create(8)}k$m(k$a,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var k$b=k$a.prototype;return k$b.addSkinMesh=function(k$a){k$a.getData2(this.vb,this.ib,this.vb._byteLength/32)},k$b.reset=function(){this.vb.clear(),this.ib.clear()},k$a.getInstance=function(){return k$a.instance=k$a.instance||new k$a},k$a.instance=null,k$a}(),k$ca=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===k$i&&(k$i=0),this.x=k$a,this.y=k$b,this.width=k$c,this.height=k$d,this.edges=k$e,this.color=k$f,this.borderWidth=k$g,this.borderColor=k$h}k$m(k$a,"laya.webgl.shapes.BasePoly");var k$b=k$a.prototype;return k$y.imps(k$b,{"laya.webgl.shapes.IShape":!0}),k$b.getData=function(k$a,k$b,k$c){},k$b.rebuild=function(k$a){},k$b.setMatrix=function(k$a){},k$b.needUpdate=function(k$a){return!0},k$b.sector=function(k$a,k$b,k$c){var k$d=this.x,k$e=this.y,k$f=this.edges,k$g=(this.r1-this.r0)/k$f,k$h=this.width,k$i=this.height,k$j=this.color,k$k=(k$j>>16&255)/255,k$l=(k$j>>8&255)/255,k$m=(255&k$j)/255;k$a.push(k$d,k$e,k$k,k$l,k$m);for(var k$n=0;k$n<k$f+1;k$n++)k$a.push(k$d+Math.sin(k$g*k$n+this.r0)*k$h,k$e+Math.cos(k$g*k$n+this.r0)*k$i),k$a.push(k$k,k$l,k$m);for(k$n=0;k$n<k$f;k$n++)k$b.push(k$c,k$c+k$n+1,k$c+k$n+2)},k$b.createLine2=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g,k$h,k$i,k$j,k$k,k$l,k$m,k$n,k$o,k$p,k$q,k$r,k$s,k$t,k$w,k$x,k$y,k$z,k$A,k$B,k$C=k$a.concat(),k$D=k$e,k$E=this.borderColor,k$F=(k$E>>16&255)/255,k$G=(k$E>>8&255)/255,k$H=(255&k$E)/255,k$I=k$C.length/2,k$J=k$d,k$K=k$c/2;k$i=k$C[0],k$j=k$C[1],k$p=k$i-(k$k=k$C[2]),k$o=(k$o=-(k$j-(k$l=k$C[3])))/(k$B=Math.sqrt(k$o*k$o+k$p*k$p))*k$K,k$p=k$p/k$B*k$K,k$D.push(k$i-k$o+this.x,k$j-k$p+this.y,k$F,k$G,k$H,k$i+k$o+this.x,k$j+k$p+this.y,k$F,k$G,k$H);for(var k$L=1;k$L<k$I-1;k$L++)k$i=k$C[2*(k$L-1)],k$j=k$C[2*(k$L-1)+1],k$k=k$C[2*k$L],k$l=k$C[2*k$L+1],k$m=k$C[2*(k$L+1)],k$n=k$C[2*(k$L+1)+1],k$p=k$i-k$k,k$r=k$k-k$m,k$w=(-(k$o=(k$o=-(k$j-k$l))/(k$B=Math.sqrt(k$o*k$o+k$p*k$p))*k$K)+k$i)*(-(k$p=k$p/k$B*k$K)+k$l)-(-k$o+k$k)*(-k$p+k$j),k$z=(-(k$q=(k$q=-(k$l-k$n))/(k$B=Math.sqrt(k$q*k$q+k$r*k$r))*k$K)+k$m)*(-(k$r=k$r/k$B*k$K)+k$l)-(-k$q+k$k)*(-k$r+k$n),k$A=(k$s=-k$p+k$j-(-k$p+k$l))*(k$y=-k$q+k$k-(-k$q+k$m))-(k$x=-k$r+k$n-(-k$r+k$l))*(k$t=-k$o+k$k-(-k$o+k$i)),Math.abs(k$A)<.1?(k$A+=10.1,k$D.push(k$k-k$o+this.x,k$l-k$p+this.y,k$F,k$G,k$H,k$k+k$o+this.x,k$l+k$p+this.y,k$F,k$G,k$H)):(((k$g=(k$t*k$z-k$y*k$w)/k$A)-k$k)*(k$g-k$k)+((k$h=(k$x*k$w-k$s*k$z)/k$A)-k$l)+(k$h-k$l),k$D.push(k$g+this.x,k$h+this.y,k$F,k$G,k$H,k$k-(k$g-k$k)+this.x,k$l-(k$h-k$l)+this.y,k$F,k$G,k$H));k$i=k$C[k$C.length-4],k$j=k$C[k$C.length-3],k$p=k$i-(k$k=k$C[k$C.length-2]),k$o=(k$o=-(k$j-(k$l=k$C[k$C.length-1])))/(k$B=Math.sqrt(k$o*k$o+k$p*k$p))*k$K,k$p=k$p/k$B*k$K,k$D.push(k$k-k$o+this.x,k$l-k$p+this.y,k$F,k$G,k$H,k$k+k$o+this.x,k$l+k$p+this.y,k$F,k$G,k$H);var k$M=k$f;for(k$L=1;k$L<k$M;k$L++)k$b.push(k$J+2*(k$L-1),k$J+2*(k$L-1)+1,k$J+2*k$L+1,k$J+2*k$L+1,k$J+2*k$L,k$J+2*(k$L-1));return k$D},k$b.createLine=function(k$a,k$b,k$c,k$d){var k$e=k$a.concat(),k$f=k$a,k$g=this.borderColor,k$h=(k$g>>16&255)/255,k$i=(k$g>>8&255)/255,k$j=(255&k$g)/255;k$e.splice(0,5);var k$k,k$l,k$m,k$n,k$o,k$p,k$q,k$r,k$s,k$t,k$w,k$x,k$y,k$z,k$A,k$B,k$C,k$D,k$E,k$F,k$G=k$e.length/5,k$H=k$d,k$I=k$c/2;k$m=k$e[0],k$n=k$e[1],k$t=k$m-(k$o=k$e[5]),k$s=(k$s=-(k$n-(k$p=k$e[6])))/(k$F=Math.sqrt(k$s*k$s+k$t*k$t))*k$I,k$t=k$t/k$F*k$I,k$f.push(k$m-k$s,k$n-k$t,k$h,k$i,k$j,k$m+k$s,k$n+k$t,k$h,k$i,k$j);for(var k$J=1;k$J<k$G-1;k$J++)k$m=k$e[5*(k$J-1)],k$n=k$e[5*(k$J-1)+1],k$o=k$e[5*k$J],k$p=k$e[5*k$J+1],k$q=k$e[5*(k$J+1)],k$r=k$e[5*(k$J+1)+1],k$t=k$m-k$o,k$x=k$o-k$q,k$A=(-(k$s=(k$s=-(k$n-k$p))/(k$F=Math.sqrt(k$s*k$s+k$t*k$t))*k$I)+k$m)*(-(k$t=k$t/k$F*k$I)+k$p)-(-k$s+k$o)*(-k$t+k$n),k$D=(-(k$w=(k$w=-(k$p-k$r))/(k$F=Math.sqrt(k$w*k$w+k$x*k$x))*k$I)+k$q)*(-(k$x=k$x/k$F*k$I)+k$p)-(-k$w+k$o)*(-k$x+k$r),k$E=(k$y=-k$t+k$n-(-k$t+k$p))*(k$C=-k$w+k$o-(-k$w+k$q))-(k$B=-k$x+k$r-(-k$x+k$p))*(k$z=-k$s+k$o-(-k$s+k$m)),Math.abs(k$E)<.1?(k$E+=10.1,k$f.push(k$o-k$s,k$p-k$t,k$h,k$i,k$j,k$o+k$s,k$p+k$t,k$h,k$i,k$j)):(((k$k=(k$z*k$D-k$C*k$A)/k$E)-k$o)*(k$k-k$o)+((k$l=(k$B*k$A-k$y*k$D)/k$E)-k$p)+(k$l-k$p),k$f.push(k$k,k$l,k$h,k$i,k$j,k$o-(k$k-k$o),k$p-(k$l-k$p),k$h,k$i,k$j));k$m=k$e[k$e.length-10],k$n=k$e[k$e.length-9],k$t=k$m-(k$o=k$e[k$e.length-5]),k$s=(k$s=-(k$n-(k$p=k$e[k$e.length-4])))/(k$F=Math.sqrt(k$s*k$s+k$t*k$t))*k$I,k$t=k$t/k$F*k$I,k$f.push(k$o-k$s,k$p-k$t,k$h,k$i,k$j,k$o+k$s,k$p+k$t,k$h,k$i,k$j);var k$K=this.edges+1;for(k$J=1;k$J<k$K;k$J++)k$b.push(k$H+2*(k$J-1),k$H+2*(k$J-1)+1,k$H+2*k$J+1,k$H+2*k$J+1,k$H+2*k$J,k$H+2*(k$J-1));return k$f},k$b.createLoopLine=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=k$a.concat(),k$h=k$e||k$a,k$i=this.borderColor,k$j=(k$i>>16&255)/255,k$k=(k$i>>8&255)/255,k$l=(255&k$i)/255;k$g.splice(0,5);var k$m=[k$g[0],k$g[1]],k$n=[k$g[k$g.length-5],k$g[k$g.length-4]],k$o=k$n[0]+.5*(k$m[0]-k$n[0]),k$p=k$n[1]+.5*(k$m[1]-k$n[1]);k$g.unshift(k$o,k$p,0,0,0),k$g.push(k$o,k$p,0,0,0);var k$q,k$r,k$s,k$t,k$w,k$x,k$y,k$z,k$A,k$B,k$C,k$D,k$E,k$F,k$G,k$H,k$I,k$J,k$K,k$L,k$M=k$g.length/5,k$N=k$d,k$O=k$c/2;k$s=k$g[0],k$t=k$g[1],k$B=k$s-(k$w=k$g[5]),k$A=(k$A=-(k$t-(k$x=k$g[6])))/(k$L=Math.sqrt(k$A*k$A+k$B*k$B))*k$O,k$B=k$B/k$L*k$O,k$h.push(k$s-k$A,k$t-k$B,k$j,k$k,k$l,k$s+k$A,k$t+k$B,k$j,k$k,k$l);for(var k$P=1;k$P<k$M-1;k$P++)k$s=k$g[5*(k$P-1)],k$t=k$g[5*(k$P-1)+1],k$w=k$g[5*k$P],k$x=k$g[5*k$P+1],k$y=k$g[5*(k$P+1)],k$z=k$g[5*(k$P+1)+1],k$B=k$s-k$w,k$D=k$w-k$y,k$G=(-(k$A=(k$A=-(k$t-k$x))/(k$L=Math.sqrt(k$A*k$A+k$B*k$B))*k$O)+k$s)*(-(k$B=k$B/k$L*k$O)+k$x)-(-k$A+k$w)*(-k$B+k$t),k$J=(-(k$C=(k$C=-(k$x-k$z))/(k$L=Math.sqrt(k$C*k$C+k$D*k$D))*k$O)+k$y)*(-(k$D=k$D/k$L*k$O)+k$x)-(-k$C+k$w)*(-k$D+k$z),k$K=(k$E=-k$B+k$t-(-k$B+k$x))*(k$I=-k$C+k$w-(-k$C+k$y))-(k$H=-k$D+k$z-(-k$D+k$x))*(k$F=-k$A+k$w-(-k$A+k$s)),Math.abs(k$K)<.1?(k$K+=10.1,k$h.push(k$w-k$A,k$x-k$B,k$j,k$k,k$l,k$w+k$A,k$x+k$B,k$j,k$k,k$l)):(((k$q=(k$F*k$J-k$I*k$G)/k$K)-k$w)*(k$q-k$w)+((k$r=(k$H*k$G-k$E*k$J)/k$K)-k$x)+(k$r-k$x),k$h.push(k$q,k$r,k$j,k$k,k$l,k$w-(k$q-k$w),k$x-(k$r-k$x),k$j,k$k,k$l));k$f&&(k$b=k$f);var k$Q=this.edges+1;for(k$P=1;k$P<k$Q;k$P++)k$b.push(k$N+2*(k$P-1),k$N+2*(k$P-1)+1,k$N+2*k$P+1,k$N+2*k$P+1,k$N+2*k$P,k$N+2*(k$P-1));return k$b.push(k$N+2*(k$P-1),k$N+2*(k$P-1)+1,k$N+1,k$N+1,k$N,k$N+2*(k$P-1)),k$h},k$a}(),k$da=function(){function k$p(){}return k$m(k$p,"laya.webgl.shapes.Earcut"),k$p.earcut=function(k$a,k$b,k$c){k$c=k$c||2;var k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k=k$b&&k$b.length,k$l=k$k?k$b[0]*k$c:k$a.length,k$m=k$p.linkedList(k$a,0,k$l,k$c,!0),k$n=[];if(!k$m)return k$n;if(k$k&&(k$m=k$p.eliminateHoles(k$a,k$b,k$m,k$c)),k$a.length>80*k$c){k$d=k$f=k$a[0],k$e=k$g=k$a[1];for(var k$o=k$c;k$o<k$l;k$o+=k$c)(k$h=k$a[k$o])<k$d&&(k$d=k$h),(k$i=k$a[k$o+1])<k$e&&(k$e=k$i),k$f<k$h&&(k$f=k$h),k$g<k$i&&(k$g=k$i);k$j=0!==(k$j=Math.max(k$f-k$d,k$g-k$e))?1/k$j:0}return k$p.earcutLinked(k$m,k$n,k$c,k$d,k$e,k$j),k$n},k$p.linkedList=function(k$a,k$b,k$c,k$d,k$e){var k$f,k$g;if(k$e===0<k$p.signedArea(k$a,k$b,k$c,k$d))for(k$f=k$b;k$f<k$c;k$f+=k$d)k$g=k$p.insertNode(k$f,k$a[k$f],k$a[k$f+1],k$g);else for(k$f=k$c-k$d;k$b<=k$f;k$f-=k$d)k$g=k$p.insertNode(k$f,k$a[k$f],k$a[k$f+1],k$g);return k$g&&k$p.equals(k$g,k$g.next)&&(k$p.removeNode(k$g),k$g=k$g.next),k$g},k$p.filterPoints=function(k$a,k$b){if(!k$a)return k$a;k$b||(k$b=k$a);var k$c,k$d=k$a;do{if(k$c=!1,k$d.steiner||!k$p.equals(k$d,k$d.next)&&0!==k$p.area(k$d.prev,k$d,k$d.next))k$d=k$d.next;else{if(k$p.removeNode(k$d),(k$d=k$b=k$d.prev)===k$d.next)break;k$c=!0}}while(k$c||k$d!==k$b);return k$b},k$p.earcutLinked=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){if(k$a){!k$g&&k$f&&k$p.indexCurve(k$a,k$d,k$e,k$f);for(var k$h,k$i,k$j=k$a;k$a.prev!==k$a.next;)if(k$h=k$a.prev,k$i=k$a.next,k$f?k$p.isEarHashed(k$a,k$d,k$e,k$f):k$p.isEar(k$a))k$b.push(k$h.i/k$c),k$b.push(k$a.i/k$c),k$b.push(k$i.i/k$c),k$p.removeNode(k$a),k$a=k$i.next,k$j=k$i.next;else if((k$a=k$i)===k$j){k$g?1===k$g?(k$a=k$p.cureLocalIntersections(k$a,k$b,k$c),k$p.earcutLinked(k$a,k$b,k$c,k$d,k$e,k$f,2)):2===k$g&&k$p.splitEarcut(k$a,k$b,k$c,k$d,k$e,k$f):k$p.earcutLinked(k$p.filterPoints(k$a,null),k$b,k$c,k$d,k$e,k$f,1);break}}},k$p.isEar=function(k$a){var k$b=k$a.prev,k$c=k$a,k$d=k$a.next;if(0<=k$p.area(k$b,k$c,k$d))return!1;for(var k$e=k$a.next.next;k$e!==k$a.prev;){if(k$p.pointInTriangle(k$b.x,k$b.y,k$c.x,k$c.y,k$d.x,k$d.y,k$e.x,k$e.y)&&0<=k$p.area(k$e.prev,k$e,k$e.next))return!1;k$e=k$e.next}return!0},k$p.isEarHashed=function(k$a,k$b,k$c,k$d){var k$e=k$a.prev,k$f=k$a,k$g=k$a.next;if(0<=k$p.area(k$e,k$f,k$g))return!1;for(var k$h=k$e.x<k$f.x?k$e.x<k$g.x?k$e.x:k$g.x:k$f.x<k$g.x?k$f.x:k$g.x,k$i=k$e.y<k$f.y?k$e.y<k$g.y?k$e.y:k$g.y:k$f.y<k$g.y?k$f.y:k$g.y,k$j=k$e.x>k$f.x?k$e.x>k$g.x?k$e.x:k$g.x:k$f.x>k$g.x?k$f.x:k$g.x,k$k=k$e.y>k$f.y?k$e.y>k$g.y?k$e.y:k$g.y:k$f.y>k$g.y?k$f.y:k$g.y,k$l=k$p.zOrder(k$h,k$i,k$b,k$c,k$d),k$m=k$p.zOrder(k$j,k$k,k$b,k$c,k$d),k$n=k$a.nextZ;k$n&&k$n.z<=k$m;){if(k$n!==k$a.prev&&k$n!==k$a.next&&k$p.pointInTriangle(k$e.x,k$e.y,k$f.x,k$f.y,k$g.x,k$g.y,k$n.x,k$n.y)&&0<=k$p.area(k$n.prev,k$n,k$n.next))return!1;k$n=k$n.nextZ}for(k$n=k$a.prevZ;k$n&&k$n.z>=k$l;){if(k$n!==k$a.prev&&k$n!==k$a.next&&k$p.pointInTriangle(k$e.x,k$e.y,k$f.x,k$f.y,k$g.x,k$g.y,k$n.x,k$n.y)&&0<=k$p.area(k$n.prev,k$n,k$n.next))return!1;k$n=k$n.prevZ}return!0},k$p.cureLocalIntersections=function(k$a,k$b,k$c){var k$d=k$a;do{var k$e=k$d.prev,k$f=k$d.next.next;!k$p.equals(k$e,k$f)&&k$p.intersects(k$e,k$d,k$d.next,k$f)&&k$p.locallyInside(k$e,k$f)&&k$p.locallyInside(k$f,k$e)&&(k$b.push(k$e.i/k$c),k$b.push(k$d.i/k$c),k$b.push(k$f.i/k$c),k$p.removeNode(k$d),k$p.removeNode(k$d.next),k$d=k$a=k$f),k$d=k$d.next}while(k$d!==k$a);return k$d},k$p.splitEarcut=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=k$a;do{for(var k$h=k$g.next.next;k$h!==k$g.prev;){if(k$g.i!==k$h.i&&k$p.isValidDiagonal(k$g,k$h)){var k$i=k$p.splitPolygon(k$g,k$h);return k$g=k$p.filterPoints(k$g,k$g.next),k$i=k$p.filterPoints(k$i,k$i.next),k$p.earcutLinked(k$g,k$b,k$c,k$d,k$e,k$f),void k$p.earcutLinked(k$i,k$b,k$c,k$d,k$e,k$f)}k$h=k$h.next}k$g=k$g.next}while(k$g!==k$a)},k$p.eliminateHoles=function(k$a,k$b,k$c,k$d){var k$e,k$f,k$g,k$h,k$i,k$j=[];for(k$e=0,k$f=k$b.length;k$e<k$f;k$e++)k$g=k$b[k$e]*k$d,k$h=k$e<k$f-1?k$b[k$e+1]*k$d:k$a.length,(k$i=k$p.linkedList(k$a,k$g,k$h,k$d,!1))===k$i.next&&(k$i.steiner=!0),k$j.push(k$p.getLeftmost(k$i));for(k$j.sort(k$p.compareX),k$e=0;k$e<k$j.length;k$e++)k$p.eliminateHole(k$j[k$e],k$c),k$c=k$p.filterPoints(k$c,k$c.next);return k$c},k$p.compareX=function(k$a,k$b){return k$a.x-k$b.x},k$p.eliminateHole=function(k$a,k$b){if(k$b=k$p.findHoleBridge(k$a,k$b)){var k$c=k$p.splitPolygon(k$b,k$a);k$p.filterPoints(k$c,k$c.next)}},k$p.findHoleBridge=function(k$a,k$b){var k$c,k$d=k$b,k$e=k$a.x,k$f=k$a.y,k$g=-1/0;do{if(k$f<=k$d.y&&k$f>=k$d.next.y&&k$d.next.y!==k$d.y){var k$h=k$d.x+(k$f-k$d.y)*(k$d.next.x-k$d.x)/(k$d.next.y-k$d.y);if(k$h<=k$e&&k$g<k$h){if((k$g=k$h)===k$e){if(k$f===k$d.y)return k$d;if(k$f===k$d.next.y)return k$d.next}k$c=k$d.x<k$d.next.x?k$d:k$d.next}}k$d=k$d.next}while(k$d!==k$b);if(!k$c)return null;if(k$e===k$g)return k$c.prev;var k$i,k$j=k$c,k$k=k$c.x,k$l=k$c.y,k$m=1/0;for(k$d=k$c.next;k$d!==k$j;)k$e>=k$d.x&&k$d.x>=k$k&&k$e!==k$d.x&&k$p.pointInTriangle(k$f<k$l?k$e:k$g,k$f,k$k,k$l,k$f<k$l?k$g:k$e,k$f,k$d.x,k$d.y)&&((k$i=Math.abs(k$f-k$d.y)/(k$e-k$d.x))<k$m||k$i===k$m&&k$d.x>k$c.x)&&k$p.locallyInside(k$d,k$a)&&(k$c=k$d,k$m=k$i),k$d=k$d.next;return k$c},k$p.indexCurve=function(k$a,k$b,k$c,k$d){for(var k$e=k$a;null===k$e.z&&(k$e.z=k$p.zOrder(k$e.x,k$e.y,k$b,k$c,k$d)),k$e.prevZ=k$e.prev,k$e.nextZ=k$e.next,(k$e=k$e.next)!==k$a;);k$e.prevZ.nextZ=null,k$e.prevZ=null,k$p.sortLinked(k$e)},k$p.sortLinked=function(k$a){var k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j=1;do{for(k$c=k$a,k$f=k$a=null,k$g=0;k$c;){for(k$g++,k$d=k$c,k$b=k$h=0;k$b<k$j&&(k$h++,k$d=k$d.nextZ);k$b++);for(k$i=k$j;0<k$h||0<k$i&&k$d;)0!==k$h&&(0===k$i||!k$d||k$c.z<=k$d.z)?(k$c=(k$e=k$c).nextZ,k$h--):(k$d=(k$e=k$d).nextZ,k$i--),k$f?k$f.nextZ=k$e:k$a=k$e,k$e.prevZ=k$f,k$f=k$e;k$c=k$d}k$f.nextZ=null,k$j*=2}while(1<k$g);return k$a},k$p.zOrder=function(k$a,k$b,k$c,k$d,k$e){return(k$a=1431655765&((k$a=858993459&((k$a=252645135&((k$a=16711935&((k$a=32767*(k$a-k$c)*k$e)|k$a<<8))|k$a<<4))|k$a<<2))|k$a<<1))|(k$b=1431655765&((k$b=858993459&((k$b=252645135&((k$b=16711935&((k$b=32767*(k$b-k$d)*k$e)|k$b<<8))|k$b<<4))|k$b<<2))|k$b<<1))<<1},k$p.getLeftmost=function(k$a){for(var k$b=k$a,k$c=k$a;k$b.x<k$c.x&&(k$c=k$b),(k$b=k$b.next)!==k$a;);return k$c},k$p.pointInTriangle=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){return 0<=(k$e-k$g)*(k$b-k$h)-(k$a-k$g)*(k$f-k$h)&&0<=(k$a-k$g)*(k$d-k$h)-(k$c-k$g)*(k$b-k$h)&&0<=(k$c-k$g)*(k$f-k$h)-(k$e-k$g)*(k$d-k$h)},k$p.isValidDiagonal=function(k$a,k$b){return k$a.next.i!==k$b.i&&k$a.prev.i!==k$b.i&&!k$p.intersectsPolygon(k$a,k$b)&&k$p.locallyInside(k$a,k$b)&&k$p.locallyInside(k$b,k$a)&&k$p.middleInside(k$a,k$b)},k$p.area=function(k$a,k$b,k$c){return(k$b.y-k$a.y)*(k$c.x-k$b.x)-(k$b.x-k$a.x)*(k$c.y-k$b.y)},k$p.equals=function(k$a,k$b){return k$a.x===k$b.x&&k$a.y===k$b.y},k$p.intersects=function(k$a,k$b,k$c,k$d){return!!(k$p.equals(k$a,k$b)&&k$p.equals(k$c,k$d)||k$p.equals(k$a,k$d)&&k$p.equals(k$c,k$b))||0<k$p.area(k$a,k$b,k$c)!=0<k$p.area(k$a,k$b,k$d)&&0<k$p.area(k$c,k$d,k$a)!=0<k$p.area(k$c,k$d,k$b)},k$p.intersectsPolygon=function(k$a,k$b){var k$c=k$a;do{if(k$c.i!==k$a.i&&k$c.next.i!==k$a.i&&k$c.i!==k$b.i&&k$c.next.i!==k$b.i&&k$p.intersects(k$c,k$c.next,k$a,k$b))return!0;k$c=k$c.next}while(k$c!==k$a);return!1},k$p.locallyInside=function(k$a,k$b){return k$p.area(k$a.prev,k$a,k$a.next)<0?0<=k$p.area(k$a,k$b,k$a.next)&&0<=k$p.area(k$a,k$a.prev,k$b):k$p.area(k$a,k$b,k$a.prev)<0||k$p.area(k$a,k$a.next,k$b)<0},k$p.middleInside=function(k$a,k$b){for(var k$c=k$a,k$d=!1,k$e=(k$a.x+k$b.x)/2,k$f=(k$a.y+k$b.y)/2;k$c.y>k$f!=k$c.next.y>k$f&&k$c.next.y!==k$c.y&&k$e<(k$c.next.x-k$c.x)*(k$f-k$c.y)/(k$c.next.y-k$c.y)+k$c.x&&(k$d=!k$d),(k$c=k$c.next)!==k$a;);return k$d},k$p.splitPolygon=function(k$a,k$b){var k$c=new k$ea(k$a.i,k$a.x,k$a.y),k$d=new k$ea(k$b.i,k$b.x,k$b.y),k$e=k$a.next,k$f=k$b.prev;return(k$a.next=k$b).prev=k$a,(k$c.next=k$e).prev=k$c,(k$d.next=k$c).prev=k$d,(k$f.next=k$d).prev=k$f,k$d},k$p.insertNode=function(k$a,k$b,k$c,k$d){var k$e=new k$ea(k$a,k$b,k$c);return k$d?(k$e.next=k$d.next,(k$e.prev=k$d).next.prev=k$e,k$d.next=k$e):(k$e.prev=k$e).next=k$e,k$e},k$p.removeNode=function(k$a){k$a.next.prev=k$a.prev,k$a.prev.next=k$a.next,k$a.prevZ&&(k$a.prevZ.nextZ=k$a.nextZ),k$a.nextZ&&(k$a.nextZ.prevZ=k$a.prevZ)},k$p.signedArea=function(k$a,k$b,k$c,k$d){for(var k$e=0,k$f=k$b,k$g=k$c-k$d;k$f<k$c;k$f+=k$d)k$e+=(k$a[k$g]-k$a[k$f])*(k$a[k$f+1]+k$a[k$g+1]),k$g=k$f;return k$e},k$p}(),k$ea=function(){function k$a(k$a,k$b,k$c){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=k$a,this.x=k$b,this.y=k$c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return k$m(k$a,"laya.webgl.shapes.EarcutNode"),k$a}(),k$fa=(function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this.lineWidth=k$a,this.lineColor=k$b,this.lineAlpha=k$c,this.fillColor=k$d,this.fillAlpha=k$e,this.shape=k$g,this.fill=k$f}k$m(k$a,"laya.webgl.shapes.GeometryData");var k$b=k$a.prototype;k$b.clone=function(){return new k$a(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},k$b.getIndexData=function(){return null},k$b.getVertexData=function(){return null},k$b.destroy=function(){this.shape=null}}(),function(){function k$a(k$a){if(k$a instanceof Float32Array)this.points=k$a;else if(k$a instanceof Array){k$a.length;this.points=new Float32Array(k$a)}}k$m(k$a,"laya.webgl.shapes.Vertex");var k$b=k$a.prototype;k$y.imps(k$b,{"laya.webgl.shapes.IShape":!0}),k$b.getData=function(k$a,k$b,k$c){},k$b.needUpdate=function(k$a){return!1},k$b.rebuild=function(k$a){},k$b.setMatrix=function(k$a){}}(),function(){function k$i(k$a){void 0===k$a&&(k$a=1e4),this._renderType=k$a}k$m(k$i,"laya.webgl.submit.Submit");var k$a=k$i.prototype;return k$y.imps(k$a,{"laya.webgl.submit.ISubmit":!0}),k$a.releaseRender=function(){var k$a=k$i._cache;(k$a[k$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},k$a.getRenderType=function(){return this._renderType},k$a.renderSubmit=function(){if(0===this._numEle)return 1;var k$a=this.shaderValue.textureHost;if(k$a){var k$b=k$a.source;if(!k$a.bitmap||!k$b)return 1;this.shaderValue.texture=k$b,k$a.alphaTexture&&k$a.alphaTexture.source&&(this.shaderValue.texture1=k$a.alphaTexture.source)}this._vb.bind_upload(this._ib);var k$c=k$wa.mainContext;return this.shaderValue.upload(),k$S.activeBlendFunction!==this._blendFn&&(k$c.enable(3042),this._blendFn(k$c),k$S.activeBlendFunction=this._blendFn),k$G.drawCall++,k$G.trianglesFaces+=this._numEle/3,k$c.drawElements(4,this._numEle,5123,this._startIdx),1},k$i.__init__=function(){var k$a=k$i.RENDERBASE=new k$i(-1);k$a.shaderValue=new k$Aa(0,0),k$a.shaderValue.ALPHA=-1234},k$i.createSubmit=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$i._cache._length?k$i._cache[--k$i._cache._length]:new k$i;null==k$c&&((k$c=k$f._selfVb||(k$f._selfVb=k$va.create(-1))).clear(),k$d=0),k$f._ib=k$b,k$f._vb=k$c,k$f._startIdx=k$d*k$pa.BYTES_PIDX,k$f._numEle=0;var k$g=k$a._nBlendType;k$f._blendFn=k$a._targets?k$S.targetFns[k$g]:k$S.fns[k$g],k$f.shaderValue=k$e,k$f.shaderValue.setValue(k$a._shader2D);var k$h=k$a._shader2D.filters;return k$h&&k$f.shaderValue.setFilters(k$h),k$f},k$i.createShape=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=k$i._cache._length?k$i._cache[--k$i._cache._length]:new k$i;k$g._ib=k$b,k$g._vb=k$c,k$g._numEle=k$d,k$g._startIdx=k$e,k$g.shaderValue=k$f,k$g.shaderValue.setValue(k$a._shader2D);var k$h=k$a._nBlendType;return k$g._blendFn=k$a._targets?k$S.targetFns[k$h]:k$S.fns[k$h],k$g},k$i.TYPE_2D=1e4,k$i.TYPE_CANVAS=10003,k$i.TYPE_CMDSETRT=10004,k$i.TYPE_CUSTOM=10005,k$i.TYPE_BLURRT=10006,k$i.TYPE_CMDDESTORYPRERT=10007,k$i.TYPE_DISABLESTENCIL=10008,k$i.TYPE_OTHERIBVB=10009,k$i.TYPE_PRIMITIVE=10010,k$i.TYPE_RT=10011,k$i.TYPE_BLUR_RT=10012,k$i.TYPE_TARGET=10013,k$i.TYPE_CHANGE_VALUE=10014,k$i.TYPE_SHAPE=10015,k$i.TYPE_TEXTURE=10016,k$i.TYPE_FILLTEXTURE=10017,k$i.RENDERBASE=null,k$i._cache=((k$i._cache=[])._length=0,k$i._cache),k$i}()),k$ga=function(){function k$d(){this.fun=null,this.args=null}k$m(k$d,"laya.webgl.submit.SubmitCMD");var k$a=k$d.prototype;return k$y.imps(k$a,{"laya.webgl.submit.ISubmit":!0}),k$a.renderSubmit=function(){return this.fun.apply(null,this.args),1},k$a.getRenderType=function(){return 0},k$a.releaseRender=function(){var k$a=k$d._cache;k$a[k$a._length++]=this},k$d.create=function(k$a,k$b){var k$c=k$d._cache._length?k$d._cache[--k$d._cache._length]:new k$d;return k$c.fun=k$b,k$c.args=k$a,k$c},k$d._cache=((k$d._cache=[])._length=0,k$d._cache),k$d}(),k$ha=function(){function k$b(){this.variables={}}k$m(k$b,"laya.webgl.submit.SubmitCMDScope");var k$a=k$b.prototype;return k$a.getValue=function(k$a){return this.variables[k$a]},k$a.addValue=function(k$a,k$b){return this.variables[k$a]=k$b},k$a.setValue=function(k$a,k$b){return this.variables.hasOwnProperty(k$a)?this.variables[k$a]=k$b:null},k$a.clear=function(){for(var k$a in this.variables)delete this.variables[k$a]},k$a.recycle=function(){this.clear(),k$b.POOL.push(this)},k$b.create=function(){var k$a=k$b.POOL.pop();return k$a||(k$a=new k$b),k$a},k$b.POOL=[],k$b}(),k$ia=function(){function k$l(){this.offset=0,this.startIndex=0,this._mat=k$B.create()}k$m(k$l,"laya.webgl.submit.SubmitOtherIBVB");var k$a=k$l.prototype;return k$y.imps(k$a,{"laya.webgl.submit.ISubmit":!0}),k$a.releaseRender=function(){var k$a=k$l._cache;(k$a[k$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},k$a.getRenderType=function(){return 10009},k$a.renderSubmit=function(){var k$a=this._shaderValue.textureHost;if(k$a){var k$b=k$a.source;if(!k$a.bitmap||!k$b)return 1;this._shaderValue.texture=k$b}this._vb.bind_upload(this._ib);var k$c=k$sa.worldMatrix4,k$d=k$B.TEMP;k$B.mulPre(this._mat,k$c[0],k$c[1],k$c[4],k$c[5],k$c[12],k$c[13],k$d);var k$e=k$sa.worldMatrix4=k$l.tempMatrix4;k$e[0]=k$d.a,k$e[1]=k$d.b,k$e[4]=k$d.c,k$e[5]=k$d.d,k$e[12]=k$d.tx,k$e[13]=k$d.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var k$f=k$wa.mainContext;return k$S.activeBlendFunction!==this._blendFn&&(k$f.enable(3042),this._blendFn(k$f),k$S.activeBlendFunction=this._blendFn),k$G.drawCall++,k$G.trianglesFaces+=this._numEle/3,k$f.drawElements(4,this._numEle,5123,this.startIndex),k$sa.worldMatrix4=k$c,k$La.activeShader=null,1},k$l.create=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){void 0===k$i&&(k$i=0);var k$j=k$l._cache._length?k$l._cache[--k$l._cache._length]:new k$l;k$j._ib=k$c,k$j._vb=k$b,k$j._numEle=k$d,k$j._shader=k$e,k$j._shaderValue=k$f;var k$k=k$a._nBlendType;switch(k$j._blendFn=k$a._targets?k$S.targetFns[k$k]:k$S.fns[k$k],k$i){case 0:k$j.offset=0,k$j.startIndex=k$h/(k$pa.BYTES_PE*k$b.vertexStride)*1.5,k$j.startIndex*=k$pa.BYTES_PIDX;break;case 1:k$j.startIndex=k$g,k$j.offset=k$h}return k$j},k$l._cache=((k$l._cache=[])._length=0,k$l._cache),k$l.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],k$l}(),k$ja=function(){function k$c(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new k$D,this.screenRect=new k$D}k$m(k$c,"laya.webgl.submit.SubmitScissor");var k$a=k$c.prototype;return k$y.imps(k$a,{"laya.webgl.submit.ISubmit":!0}),k$a._scissor=function(k$a,k$b,k$c,k$d){var k$e=k$sa.worldMatrix4,k$f=k$e[0],k$g=k$e[5],k$h=k$e[12],k$i=k$e[13];if(k$d*=k$g,(k$c*=k$f)<1||k$d<1)return!1;var k$j=(k$a=k$a*k$f+k$h)+k$c,k$k=(k$b=k$b*k$g+k$i)+k$d;k$a<0&&(k$c=k$j-(k$a=0)),k$b<0&&(k$d=k$k-(k$b=0));var k$l=k$sa.worldClipRect;if(k$a=Math.max(k$a,k$l.x),k$b=Math.max(k$b,k$l.y),k$c=Math.min(k$j,k$l.right)-k$a,k$d=Math.min(k$k,k$l.bottom)-k$b,k$c<1||k$d<1)return!1;var k$m=k$sa.worldScissorTest;return this.screenRect.copyFrom(k$l),k$l.x=k$a,k$l.y=k$b,k$l.width=k$c,k$l.height=k$d,k$sa.worldScissorTest=!0,k$b=k$sa.height-k$b-k$d,k$wa.mainContext.scissor(k$a,k$b,k$c,k$d),k$wa.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),k$m?(k$b=k$sa.height-this.screenRect.y-this.screenRect.height,k$wa.mainContext.scissor(this.screenRect.x,k$b,this.screenRect.width,this.screenRect.height),k$wa.mainContext.enable(3089)):(k$wa.mainContext.disable(3089),k$sa.worldScissorTest=!1),k$l.copyFrom(this.screenRect),!0},k$a._scissorWithTagart=function(k$a,k$b,k$c,k$d){if(k$c<1||k$d<1)return!1;var k$e=k$a+k$c,k$f=k$b+k$d;k$a<0&&(k$c=k$e-(k$a=0)),k$b<0&&(k$d=k$f-(k$b=0));var k$g=k$sa.worldClipRect;if(k$a=Math.max(k$a,k$g.x),k$b=Math.max(k$b,k$g.y),k$c=Math.min(k$e,k$g.right)-k$a,k$d=Math.min(k$f,k$g.bottom)-k$b,k$c<1||k$d<1)return!1;var k$h=k$sa.worldScissorTest;return this.screenRect.copyFrom(k$g),k$sa.worldScissorTest=!0,k$g.x=k$a,k$g.y=k$b,k$g.width=k$c,k$g.height=k$d,k$b=k$sa.height-k$b-k$d,k$wa.mainContext.scissor(k$a,k$b,k$c,k$d),k$wa.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),k$h?(k$b=k$sa.height-this.screenRect.y-this.screenRect.height,k$wa.mainContext.scissor(this.screenRect.x,k$b,this.screenRect.width,this.screenRect.height),k$wa.mainContext.enable(3089)):(k$wa.mainContext.disable(3089),k$sa.worldScissorTest=!1),k$g.copyFrom(this.screenRect),!0},k$a.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},k$a.getRenderType=function(){return 0},k$a.releaseRender=function(){var k$a=k$c._cache;(k$a[k$a._length++]=this).context=null},k$c.create=function(k$a){var k$b=k$c._cache._length?k$c._cache[--k$c._cache._length]:new k$c;return k$b.context=k$a,k$b},k$c._cache=((k$c._cache=[])._length=0,k$c._cache),k$c}(),k$ka=function(){function k$i(){this.step=0,this.blendMode=null,this.level=0}k$m(k$i,"laya.webgl.submit.SubmitStencil");var k$a=k$i.prototype;return k$y.imps(k$a,{"laya.webgl.submit.ISubmit":!0}),k$a.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},k$a.getRenderType=function(){return 0},k$a.releaseRender=function(){var k$a=k$i._cache;k$a[k$a._length++]=this},k$a.do1=function(){var k$a=k$wa.mainContext;k$a.enable(2960),k$a.clear(1024),k$a.colorMask(!1,!1,!1,!1),k$a.stencilFunc(514,this.level,255),k$a.stencilOp(7680,7680,7682)},k$a.do2=function(){var k$a=k$wa.mainContext;k$a.stencilFunc(514,this.level+1,255),k$a.colorMask(!0,!0,!0,!0),k$a.stencilOp(7680,7680,7680)},k$a.do3=function(){var k$a=k$wa.mainContext;k$a.colorMask(!0,!0,!0,!0),k$a.stencilOp(7680,7680,7680),k$a.clear(1024),k$a.disable(2960)},k$a.do4=function(){var k$a=k$wa.mainContext;0==this.level&&(k$a.enable(2960),k$a.clear(1024)),k$a.colorMask(!1,!1,!1,!1),k$a.stencilFunc(519,0,255),k$a.stencilOp(7680,7680,7682)},k$a.do5=function(){var k$a=k$wa.mainContext;k$a.stencilFunc(514,this.level,255),k$a.colorMask(!0,!0,!0,!0),k$a.stencilOp(7680,7680,7680)},k$a.do6=function(){var k$a=k$wa.mainContext;k$S.targetFns[k$S.TOINT[this.blendMode]](k$a)},k$a.do7=function(){var k$a=k$wa.mainContext;k$a.colorMask(!1,!1,!1,!1),k$a.stencilOp(7680,7680,7683)},k$a.do8=function(){var k$a=k$wa.mainContext;k$a.colorMask(!0,!0,!0,!0),k$a.stencilFunc(514,this.level,255),k$a.stencilOp(7680,7680,7680)},k$i.restore=function(k$a,k$b,k$c,k$d,k$e){var k$f;if((k$a._renderKey=0)<k$i._mask&&k$i._mask--,0==k$i._mask)k$f=laya.webgl.submit.SubmitStencil.create(3),k$a.addRenderObject(k$f),k$a._curSubmit=k$fa.RENDERBASE;else{k$f=laya.webgl.submit.SubmitStencil.create(7),k$a.addRenderObject(k$f);var k$g=k$a._vb;k$g._byteLength;if(k$qa.fillRectImgVb(k$g,null,k$b.x,k$b.y,k$b.width,k$b.height,k$K.DEF_UV,k$c,k$d,k$e,0,0)){k$a._shader2D.glTexture=null;var k$h=k$a._curSubmit=k$fa.createSubmit(k$a,k$a._ib,k$g,(k$g._byteLength-64)/32*3,k$Aa.create(2,0));k$h.shaderValue.ALPHA=1,k$a._submits[k$a._submits._length++]=k$h,k$a._curSubmit._numEle+=6,k$a._curSubmit=k$fa.RENDERBASE}else alert("clipRect calc stencil rect error");k$f=laya.webgl.submit.SubmitStencil.create(8),k$a.addRenderObject(k$f)}},k$i.restore2=function(k$a,k$b){var k$c;(k$a._renderKey=0)<k$i._mask&&k$i._mask--,0==k$i._mask?(k$c=laya.webgl.submit.SubmitStencil.create(3),k$a.addRenderObject(k$c),k$a._curSubmit=k$fa.RENDERBASE):(k$c=laya.webgl.submit.SubmitStencil.create(7),k$a.addRenderObject(k$c),k$a._submits[k$a._submits._length++]=k$b,k$c=laya.webgl.submit.SubmitStencil.create(8),k$a.addRenderObject(k$c))},k$i.create=function(k$a){var k$b=k$i._cache._length?k$i._cache[--k$i._cache._length]:new k$i;return 5==(k$b.step=k$a)&&++k$i._mask,k$b.level=k$i._mask,k$b},k$i._cache=((k$i._cache=[])._length=0,k$i._cache),k$i._mask=0,k$i}(),k$la=function(){function k$h(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}k$m(k$h,"laya.webgl.submit.SubmitTarget");var k$a=k$h.prototype;return k$y.imps(k$a,{"laya.webgl.submit.ISubmit":!0}),k$a.renderSubmit=function(){this._vb.bind_upload(this._ib);var k$a=this.scope.getValue(this.proName);return k$a&&(this.shaderValue.texture=k$a.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[k$a.width,k$a.height]),this.shaderValue.upload(),this.blend(),k$G.drawCall++,k$G.trianglesFaces+=this._numEle/3,k$wa.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},k$a.blend=function(){if(k$S.activeBlendFunction!==k$S.fns[this.blendType]){var k$a=k$wa.mainContext;k$a.enable(3042),k$S.fns[this.blendType](k$a),k$S.activeBlendFunction=k$S.fns[this.blendType]}},k$a.getRenderType=function(){return 0},k$a.releaseRender=function(){var k$a=k$h._cache;(k$a[k$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},k$h.create=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=k$h._cache._length?k$h._cache[--k$h._cache._length]:new k$h;return k$g._ib=k$b,k$g._vb=k$c,k$g.proName=k$f,k$g._startIdx=k$d*k$pa.BYTES_PIDX,k$g._numEle=0,k$g.blendType=k$a._nBlendType,k$g.shaderValue=k$e,k$g.shaderValue.setValue(k$a._shader2D),k$g},k$h._cache=((k$h._cache=[])._length=0,k$h._cache),k$h}(),k$ma=function(){function k$a(){this._sourceStr=null}k$m(k$a,"laya.webgl.text.CharSegment");var k$b=k$a.prototype;return k$y.imps(k$b,{"laya.webgl.text.ICharSegment":!0}),k$b.textToSpit=function(k$a){this._sourceStr=k$a},k$b.getChar=function(k$a){return this._sourceStr.charAt(k$a)},k$b.getCharCode=function(k$a){return this._sourceStr.charCodeAt(k$a)},k$b.length=function(){return this._sourceStr.length},k$a}(),k$na=function(){var k$a;function k$G(){}return k$m(k$G,"laya.webgl.text.DrawText"),k$G.__init__=function(){k$G._charsTemp=new Array,k$G._drawValue=new k$a,k$G._charSeg=new k$ma},k$G.customCharSeg=function(k$a){k$G._charSeg=k$a},k$G.getChar=function(k$a,k$b,k$c){var k$d=k$Va.createOneChar(k$a,k$c);return-1!=k$b&&(k$G._charsCache[k$b]=k$d),k$d},k$G._drawSlow=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$l,k$m,k$n,k$o){var k$p,k$q,k$r=k$G._drawValue.value(k$f,k$h,k$i,k$j,k$m,k$n,k$o),k$s=0,k$t=0,k$w=k$G._charsTemp,k$x=0,k$y=NaN;if(k$d)for(k$w.length=k$d.length,k$s=0,k$t=k$d.length;k$s<k$t;k$s++)(k$q=k$d[k$s])&&(k$y=k$q.charNum+k$r.txtID,k$w[k$s]=k$p=k$G._charsCache[k$y]||k$G.getChar(k$q.char,k$y,k$r),k$p.active());else{var k$z=k$c instanceof laya.utils.WordText?k$c.toString():k$c;if(k$J.CharacterCache){k$G._charSeg.textToSpit(k$z);var k$A=k$G._charSeg.length();for(k$s=0,k$t=k$w.length=k$A;k$s<k$t;k$s++)k$y=k$G._charSeg.getCharCode(k$s)+k$r.txtID,k$w[k$s]=k$p=k$G._charsCache[k$y]||k$G.getChar(k$G._charSeg.getChar(k$s),k$y,k$r),k$p.active(),k$x+=k$p.cw}else k$w.length=0,(k$p=k$G.getChar(k$z,-1,k$r)).active(),k$x+=k$p.cw,k$w[0]=k$p}var k$B=0;null!==k$g&&"left"!==k$g&&(k$B=-("center"==k$g?k$x/2:k$x));var k$C,k$D,k$E=NaN,k$F=0;if(k$d)for(k$s=0,k$t=k$w.length;k$s<k$t;k$s++)k$p=k$w[k$s],k$q=k$d[k$s],k$p&&k$q&&!k$p.isSpace&&(k$E=k$p.borderSize,k$C=k$p.texture,k$b._drawText(k$C,k$k+k$B+k$q.x*k$m-k$E,k$l+k$q.y*k$n-k$E,k$C.width,k$C.height,k$e,0,0,0,0));else{for(k$s=0,k$t=k$w.length;k$s<k$t;k$s++)(k$p=k$w[k$s])&&!k$p.isSpace&&(k$E=k$p.borderSize,k$C=k$p.texture,k$b._drawText(k$C,k$k+k$B-k$E,k$l-k$E,k$C.width,k$C.height,k$e,0,0,0,0),k$a&&((k$D=k$a[k$F++])||(k$D=k$a[k$F-1]=[]),k$D[0]=k$C,k$D[1]=k$B-k$E,k$D[2]=-k$E)),k$B+=k$p.cw;k$a&&(k$a.length=k$F)}},k$G._drawFast=function(k$a,k$b,k$c,k$d,k$e){for(var k$f,k$g,k$h=0,k$i=k$a.length;k$h<k$i;k$h++)(k$f=(k$g=k$a[k$h])[0]).active(),k$b._drawText(k$f,k$d+k$g[1],k$e+k$g[2],k$f.width,k$f.height,k$c,0,0,0,0)},k$G.drawText=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$l){if(void 0===k$l&&(k$l=0),!(k$b&&0===k$b.length||k$c&&0===k$c.length)){var k$m=k$d.a,k$n=k$d.d;(0!==k$d.b||0!==k$d.c)&&(k$m=k$n=1);var k$o=1!==k$m||1!==k$n;if(k$o&&k$y.stage.transform){var k$p=k$y.stage.transform;k$o=k$p.a===k$m&&k$p.d===k$n}else k$o=!1;if(k$o){var k$q=(k$d=k$d.copyTo(k$za._tmpMatrix)).tx,k$r=k$d.ty;k$d.scale(1/k$m,1/k$n),k$d._checkTransform(),k$j*=k$m,k$k*=k$n,k$j+=k$q-k$d.tx,k$k+=k$r-k$d.ty}else k$m=k$n=1;if(k$c)k$G._drawSlow(null,k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$m,k$n,k$l);else{if(null===k$b.toUpperCase){var k$s=k$m+1e5*k$n,k$t=k$b;return void(k$t.changed||k$t.id!==k$s?(k$t.id=k$s,k$t.changed=!1,k$G._drawSlow(k$t.save,k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$m,k$n,k$l)):k$G._drawFast(k$t.save,k$a,k$d,k$j,k$k))}var k$w=k$b+k$e.toString()+k$g+k$h+k$i+k$m+k$n+k$f,k$x=k$G._textsCache[k$w];k$J.CharacterCache?k$x?k$G._drawFast(k$x,k$a,k$d,k$j,k$k):(k$G._textsCache.__length||(k$G._textsCache.__length=0),k$G._textsCache.__length>k$z.WebGLTextCacheCount&&((k$G._textsCache={}).__length=0,k$G._curPoolIndex=0),k$G._textCachesPool[k$G._curPoolIndex]?(k$x=k$G._textsCache[k$w]=k$G._textCachesPool[k$G._curPoolIndex]).length=0:k$G._textCachesPool[k$G._curPoolIndex]=k$x=k$G._textsCache[k$w]=[],k$G._textsCache.__length++,k$G._curPoolIndex++,k$G._drawSlow(k$x,k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$m,k$n,k$l)):k$G._drawSlow(k$x,k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$m,k$n,k$l)}}},k$G._charsTemp=null,k$G._textCachesPool=[],k$G._curPoolIndex=0,k$G._charsCache={},k$G._textsCache={},k$G._drawValue=null,k$G.d=[],k$G._charSeg=null,k$G.__init$=function(){k$a=function(){function k$i(){}return k$m(k$i,""),k$i.prototype.value=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this.font=k$a,this.fillColor=k$b,this.borderColor=k$c,this.lineWidth=k$d,this.scaleX=k$e,this.scaleY=k$f,this.underLine=k$g;var k$h=k$a.toString()+k$e+k$f+k$d+(k$b?k$b.toLowerCase():" ")+(k$c?k$c.toLowerCase():" ")+k$g;return this.txtID=k$i._keymap[k$h],this.txtID||(this.txtID=1e-7*++k$i._keymapCount,k$i._keymap[k$h]=this.txtID),this},k$i.clear=function(){k$i._keymap={},k$i._keymapCount=1},k$i._keymap={},k$i._keymapCount=1,k$i}()},k$G}(),k$oa=function(){function k$e(k$a){this._index=0,this._size=14,this._italic=-2,k$e._cache2=k$e._cache2||[],this.setFont(k$a||"14px Arial")}k$m(k$e,"laya.webgl.text.FontInContext");var k$a=k$e.prototype;return k$a.setFont=function(k$a){var k$b=k$e._cache2[k$a];if(k$b)this._words=k$b[0],this._size=k$b[1];else{this._words=k$a.split(" ");for(var k$c=0,k$d=this._words.length;k$c<k$d;k$c++)if(0<this._words[k$c].indexOf("px")){this._index=k$c;break}this._size=parseInt(this._words[this._index]),k$e._cache2[k$a]=[this._words,this._size]}this._text=null,this._italic=-2},k$a.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},k$a.hasType=function(k$a){for(var k$b=0,k$c=this._words.length;k$b<k$c;k$b++)if(this._words[k$b]===k$a)return k$b;return-1},k$a.removeType=function(k$a){for(var k$b=0,k$c=this._words.length;k$b<k$c;k$b++)if(this._words[k$b]===k$a){this._words.splice(k$b,1),this._index>k$b&&this._index--;break}this._text=null,this._italic=-2},k$a.copyTo=function(k$a){return k$a._text=this._text,k$a._size=this._size,k$a._index=this._index,k$a._words=this._words.slice(),k$a._italic=-2,k$a},k$a.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},k$d(0,k$a,"size",function(){return this._size},function(k$a){this._size=k$a,this._words[this._index]=k$a+"px",this._text=null}),k$e.create=function(k$a){var k$b=k$e._cache[k$a];return k$b||(k$b=k$e._cache[k$a]=new k$e(k$a))},k$e.EMPTY=new k$e,k$e._cache={},k$e._cache2=null,k$e}(),k$pa=function(){function k$a(){}return k$m(k$a,"laya.webgl.utils.CONST3D2D"),k$a.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],k$a.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],k$a.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],k$a._TMPARRAY=[],k$a._OFFSETX=0,k$a._OFFSETY=0,k$g(k$a,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),k$a}(),k$qa=function(){function k$o(){}return k$m(k$o,"laya.webgl.utils.GlUtils"),k$o.make2DProjection=function(k$a,k$b,k$c){return[2/k$a,0,0,0,0,-2/k$b,0,0,0,0,2/k$c,0,-1,1,0,1]},k$o.fillIBQuadrangle=function(k$a,k$b){if(65535/4<k$b)throw Error("IBQuadrangle count:"+k$b+" must<:"+Math.floor(65535/4));k$b=Math.floor(k$b),k$a._resizeBuffer(6*(k$b+1)*2,!1),k$a.byteLength=k$a.bufferLength;for(var k$c=k$a.getUint16Array(),k$d=0,k$e=0;k$e<k$b;k$e++)k$c[k$d++]=4*k$e,k$c[k$d++]=4*k$e+2,k$c[k$d++]=4*k$e+1,k$c[k$d++]=4*k$e,k$c[k$d++]=4*k$e+3,k$c[k$d++]=4*k$e+2;return k$a.setNeedUpload(),!0},k$o.expandIBQuadrangle=function(k$a,k$b){k$a.bufferLength>=6*k$b*2||k$o.fillIBQuadrangle(k$a,k$b)},k$o.mathCeilPowerOfTwo=function(k$a){return k$a--,k$a|=k$a>>1,k$a|=k$a>>2,k$a|=k$a>>4,k$a|=k$a>>8,k$a|=k$a>>16,++k$a},k$o.fillQuadrangleImgVb=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){var k$i=16+(k$a._byteLength>>2);k$a.byteLength=k$i<<2;var k$j=k$a.getFloat32Array();k$j[(k$i-=16)+2]=k$e[0],k$j[k$i+3]=k$e[1],k$j[k$i+6]=k$e[2],k$j[k$i+7]=k$e[3],k$j[k$i+10]=k$e[4],k$j[k$i+11]=k$e[5],k$j[k$i+14]=k$e[6],k$j[k$i+15]=k$e[7];var k$k=k$f.a,k$l=k$f.b,k$m=k$f.c,k$n=k$f.d;if(1!==k$k||0!==k$l||0!==k$m||1!==k$n){k$f.bTransform=!0;var k$o=k$f.tx+k$g,k$p=k$f.ty+k$h;k$j[k$i]=(k$d[0]+k$b)*k$k+(k$d[1]+k$c)*k$m+k$o,k$j[k$i+1]=(k$d[0]+k$b)*k$l+(k$d[1]+k$c)*k$n+k$p,k$j[k$i+4]=(k$d[2]+k$b)*k$k+(k$d[3]+k$c)*k$m+k$o,k$j[k$i+5]=(k$d[2]+k$b)*k$l+(k$d[3]+k$c)*k$n+k$p,k$j[k$i+8]=(k$d[4]+k$b)*k$k+(k$d[5]+k$c)*k$m+k$o,k$j[k$i+9]=(k$d[4]+k$b)*k$l+(k$d[5]+k$c)*k$n+k$p,k$j[k$i+12]=(k$d[6]+k$b)*k$k+(k$d[7]+k$c)*k$m+k$o,k$j[k$i+13]=(k$d[6]+k$b)*k$l+(k$d[7]+k$c)*k$n+k$p}else k$f.bTransform=!1,k$b+=k$f.tx+k$g,k$c+=k$f.ty+k$h,k$j[k$i]=k$b+k$d[0],k$j[k$i+1]=k$c+k$d[1],k$j[k$i+4]=k$b+k$d[2],k$j[k$i+5]=k$c+k$d[3],k$j[k$i+8]=k$b+k$d[4],k$j[k$i+9]=k$c+k$d[5],k$j[k$i+12]=k$b+k$d[6],k$j[k$i+13]=k$c+k$d[7];return k$a._upload=!0},k$o.fillTranglesVB=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){var k$h=(k$a._byteLength>>2)+k$d.length;k$a.byteLength=k$h<<2;var k$i=k$a.getFloat32Array();k$h-=k$d.length;for(var k$j=k$d.length,k$k=k$e.a,k$l=k$e.b,k$m=k$e.c,k$n=k$e.d,k$o=0;k$o<k$j;k$o+=4)if(k$i[k$h+k$o+2]=k$d[k$o+2],k$i[k$h+k$o+3]=k$d[k$o+3],1!==k$k||0!==k$l||0!==k$m||1!==k$n){k$e.bTransform=!0;var k$p=k$e.tx+k$f,k$q=k$e.ty+k$g;k$i[k$h+k$o]=(k$d[k$o]+k$b)*k$k+(k$d[k$o+1]+k$c)*k$m+k$p,k$i[k$h+k$o+1]=(k$d[k$o]+k$b)*k$l+(k$d[k$o+1]+k$c)*k$n+k$q}else k$e.bTransform=!1,k$b+=k$e.tx+k$f,k$c+=k$e.ty+k$g,k$i[k$h+k$o]=k$b+k$d[k$o],k$i[k$h+k$o+1]=k$c+k$d[k$o+1];return k$a._upload=!0},k$o.copyPreImgVb=function(k$a,k$b,k$c){var k$d=k$a._byteLength>>2;k$a.byteLength=k$d+16<<2;for(var k$e=k$a.getFloat32Array(),k$f=0,k$g=k$d-16;k$f<4;k$f++)k$e[k$d]=k$e[k$g]+k$b,++k$g,k$e[++k$d]=k$e[k$g]+k$c,++k$g,k$e[++k$d]=k$e[k$g],++k$g,k$e[++k$d]=k$e[k$g],++k$d,++k$g;k$a._upload=!0},k$o.fillRectImgVb=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$l,k$m){void 0===k$m&&(k$m=!1);var k$n,k$o,k$p,k$q,k$r,k$s,k$t,k$w,k$x,k$y,k$z,k$A,k$B,k$C,k$D,k$E,k$F=1,k$G=k$h.a,k$H=k$h.b,k$I=k$h.c,k$J=k$h.d,k$K=k$b&&k$b.width<99999999;if(1!==k$G||0!==k$H||0!==k$I||1!==k$J?(k$h.bTransform=!0,0===k$H&&0===k$I&&(k$F=23,k$x=k$e+k$c,k$y=k$f+k$d,k$n=k$G*k$c+(k$z=k$h.tx+k$i),k$p=k$G*k$x+k$z,k$o=k$J*k$d+(k$A=k$h.ty+k$j),k$q=k$J*k$y+k$A)):(k$F=23,k$h.bTransform=!1,k$p=(k$n=k$c+k$h.tx+k$i)+k$e,k$q=(k$o=k$d+k$h.ty+k$j)+k$f),k$K&&(k$r=k$b.x,k$s=k$b.y,k$t=k$b.width+k$r,k$w=k$b.height+k$s),1!==k$F){if(Math.min(k$n,k$p)>=k$t)return!1;if(Math.min(k$o,k$q)>=k$w)return!1;if(Math.max(k$p,k$n)<=k$r)return!1;if(Math.max(k$q,k$o)<=k$s)return!1}var k$L=k$a._byteLength>>2;k$a.byteLength=16+k$L<<2;var k$M=k$a.getFloat32Array();switch(k$M[2+k$L]=k$g[0],k$M[3+k$L]=k$g[1],k$M[6+k$L]=k$g[2],k$M[7+k$L]=k$g[3],k$M[10+k$L]=k$g[4],k$M[11+k$L]=k$g[5],k$M[14+k$L]=k$g[6],k$M[15+k$L]=k$g[7],k$F){case 1:k$z=k$h.tx+k$i,k$A=k$h.ty+k$j;var k$N=k$G*k$c,k$O=k$I*k$d,k$P=k$J*k$d,k$Q=k$H*k$c,k$R=k$G*(k$x=k$e+k$c),k$S=k$I*(k$y=k$f+k$d),k$T=k$J*k$y,k$U=k$H*k$x;k$m?(k$B=k$N+k$O+k$z,k$D=Math.round(k$B)-k$B,k$C=k$P+k$Q+k$A,k$E=Math.round(k$C)-k$C,k$M[k$L]=k$B+k$D,k$M[1+k$L]=k$C+k$E,k$M[4+k$L]=k$R+k$O+k$z+k$D,k$M[5+k$L]=k$P+k$U+k$A+k$E,k$M[8+k$L]=k$R+k$S+k$z+k$D,k$M[9+k$L]=k$T+k$U+k$A+k$E,k$M[12+k$L]=k$N+k$S+k$z+k$D,k$M[13+k$L]=k$T+k$Q+k$A+k$E):(k$M[k$L]=k$N+k$O+k$z,k$M[1+k$L]=k$P+k$Q+k$A,k$M[4+k$L]=k$R+k$O+k$z,k$M[5+k$L]=k$P+k$U+k$A,k$M[8+k$L]=k$R+k$S+k$z,k$M[9+k$L]=k$T+k$U+k$A,k$M[12+k$L]=k$N+k$S+k$z,k$M[13+k$L]=k$T+k$Q+k$A);break;case 23:k$m?(k$B=k$n+k$k,k$D=Math.round(k$B)-k$B,k$C=k$o,k$E=Math.round(k$C)-k$C,k$M[k$L]=k$B+k$D,k$M[1+k$L]=k$C+k$E,k$M[4+k$L]=k$p+k$k+k$D,k$M[5+k$L]=k$o+k$E,k$M[8+k$L]=k$p+k$D,k$M[9+k$L]=k$q+k$E,k$M[12+k$L]=k$n+k$D,k$M[13+k$L]=k$q+k$E):(k$M[k$L]=k$n+k$k,k$M[1+k$L]=k$o,k$M[4+k$L]=k$p+k$k,k$M[5+k$L]=k$o,k$M[8+k$L]=k$p,k$M[9+k$L]=k$q,k$M[12+k$L]=k$n,k$M[13+k$L]=k$q)}return k$a._upload=!0},k$o.fillLineVb=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){var k$i=.5*k$g,k$j=k$o._fillLineArray,k$k=-(k$d-k$f),k$l=k$c-k$e,k$m=Math.sqrt(k$k*k$k+k$l*k$l);k$k/=k$m,k$l/=k$m,k$k*=k$i,k$l*=k$i,k$j[0]=k$c-k$k,k$j[1]=k$d-k$l,k$j[4]=k$c+k$k,k$j[5]=k$d+k$l,k$j[8]=k$e+k$k,k$j[9]=k$f+k$l,k$j[12]=k$e-k$k,k$j[13]=k$f-k$l,k$h&&k$h.transformPointArray(k$j,k$j);var k$n=16+(k$a._byteLength>>2);return k$a.byteLength=k$n<<2,k$a.insertData(k$j,k$n-16),!0},k$o._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],k$o}(),k$ra=(function(){function k$i(){}k$m(k$i,"laya.webgl.utils.MatirxArray"),k$i.ArrayMul=function(k$a,k$b,k$c){if(k$a)if(k$b)for(var k$d=NaN,k$e=NaN,k$f=NaN,k$g=NaN,k$h=0;k$h<4;k$h++)k$d=k$a[k$h],k$e=k$a[k$h+4],k$f=k$a[k$h+8],k$g=k$a[k$h+12],k$c[k$h]=k$d*k$b[0]+k$e*k$b[1]+k$f*k$b[2]+k$g*k$b[3],k$c[k$h+4]=k$d*k$b[4]+k$e*k$b[5]+k$f*k$b[6]+k$g*k$b[7],k$c[k$h+8]=k$d*k$b[8]+k$e*k$b[9]+k$f*k$b[10]+k$g*k$b[11],k$c[k$h+12]=k$d*k$b[12]+k$e*k$b[13]+k$f*k$b[14]+k$g*k$b[15];else k$i.copyArray(k$a,k$c);else k$i.copyArray(k$b,k$c)},k$i.copyArray=function(k$a,k$b){if(k$a&&k$b)for(var k$c=0;k$c<k$a.length;k$c++)k$b[k$c]=k$a[k$c]}}(),function(){function k$b(k$a,k$b,k$c){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=k$a,this._vb=new k$va(k$a,35048),k$b&&this._vb._resizeBuffer(k$b,!1),this._ib=new k$ua,k$c&&this._ib._resizeBuffer(k$c,!1)}k$m(k$b,"laya.webgl.utils.Mesh2D");var k$a=k$b.prototype;return k$a.cloneWithNewVB=function(){var k$a=new k$b(this._stride,0,0);return k$a._ib=this._ib,k$a._quadNum=this._quadNum,k$a._attribInfo=this._attribInfo,k$a},k$a.cloneWithNewVBIB=function(){var k$a=new k$b(this._stride,0,0);return k$a._attribInfo=this._attribInfo,k$a},k$a.getVBW=function(){return this._vb.setNeedUpload(),this._vb},k$a.getVBR=function(){return this._vb},k$a.getIBR=function(){return this._ib},k$a.getIBW=function(){return this._ib.setNeedUpload(),this._ib},k$a.createQuadIB=function(k$a){this._quadNum=k$a,this._ib._resizeBuffer(6*k$a*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var k$b=this._ib.getUint16Array(),k$c=0,k$d=0,k$e=0;k$e<k$a;k$e++)k$b[k$c++]=k$d,k$b[k$c++]=k$d+2,k$b[k$c++]=k$d+1,k$b[k$c++]=k$d,k$b[k$c++]=k$d+3,k$b[k$c++]=k$d+2,k$d+=4;this._ib.setNeedUpload()},k$a.setAttributes=function(k$a){if(this._attribInfo=k$a,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},k$a.getEleNum=function(){return this._ib.getBuffer().byteLength/2},k$a.releaseMesh=function(){},k$a.destroy=function(){},k$a.clearVB=function(){this._vb.clear()},k$b._gvaoid=0,k$b}()),k$sa=function(){function k$e(){}return k$m(k$e,"laya.webgl.utils.RenderState2D"),k$e.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},k$e.mat2MatArray=function(k$a,k$b){var k$c=k$a,k$d=k$b;return k$d[0]=k$c.a,k$d[1]=k$c.b,k$d[2]=k$e.EMPTYMAT4_ARRAY[2],k$d[3]=k$e.EMPTYMAT4_ARRAY[3],k$d[4]=k$c.c,k$d[5]=k$c.d,k$d[6]=k$e.EMPTYMAT4_ARRAY[6],k$d[7]=k$e.EMPTYMAT4_ARRAY[7],k$d[8]=k$e.EMPTYMAT4_ARRAY[8],k$d[9]=k$e.EMPTYMAT4_ARRAY[9],k$d[10]=k$e.EMPTYMAT4_ARRAY[10],k$d[11]=k$e.EMPTYMAT4_ARRAY[11],k$d[12]=k$c.tx,k$d[13]=k$c.ty,k$d[14]=k$e.EMPTYMAT4_ARRAY[14],k$d[15]=k$e.EMPTYMAT4_ARRAY[15],k$b},k$e.restoreTempArray=function(){k$e.TEMPMAT4_ARRAY[0]=1,k$e.TEMPMAT4_ARRAY[1]=0,k$e.TEMPMAT4_ARRAY[4]=0,k$e.TEMPMAT4_ARRAY[5]=1,k$e.TEMPMAT4_ARRAY[12]=0,k$e.TEMPMAT4_ARRAY[13]=0},k$e.clear=function(){k$e.worldScissorTest=!1,k$e.worldShaderDefines=null,k$e.worldFilters=null,k$e.worldAlpha=1,k$e.worldClipRect.x=k$e.worldClipRect.y=0,k$e.worldClipRect.width=k$e.width,k$e.worldClipRect.height=k$e.height,k$e.curRenderTarget=null},k$e._MAXSIZE=99999999,k$e.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],k$e.worldMatrix4=k$e.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],k$e.worldAlpha=1,k$e.worldScissorTest=!1,k$e.worldFilters=null,k$e.worldShaderDefines=null,k$e.curRenderTarget=null,k$e.width=0,k$e.height=0,k$g(k$e,["worldMatrix",function(){return this.worldMatrix=new k$B},"worldClipRect",function(){return this.worldClipRect=new k$D(0,0,99999999,99999999)}]),k$e}(),k$ta=function(){var k$s,k$c;function k$t(k$a,k$b,k$c,k$d,k$e){var k$f=this;function k$g(k$a){var k$b=[],k$c=new k$s(k$b);return k$f._compileToTree(k$c,k$a.split("\n"),0,k$b,k$e),k$c}var k$h=k$n.now();this._VS=k$g(k$b),this._PS=k$g(k$c),this._nameMap=k$d,2<k$n.now()-k$h&&console.log("ShaderCompile use time:"+(k$n.now()-k$h)+"  size:"+k$b.length+"/"+k$c.length)}k$m(k$t,"laya.webgl.utils.ShaderCompile");var k$a=k$t.prototype;return k$a._compileToTree=function(k$a,k$b,k$c,k$d,k$e){var k$f,k$g,k$h,k$i,k$j,k$k,k$l,k$m=0,k$n=0,k$o=0,k$p=0;for(k$n=k$c;k$n<k$b.length;k$n++)if(!((k$h=k$b[k$n]).length<1)&&0!==(k$m=k$h.indexOf("//"))){if(0<=k$m&&(k$h=k$h.substr(0,k$m)),k$f=k$l||new k$s(k$d),k$l=null,k$f.text=k$h,k$f.noCompile=!0,0<=(k$m=k$h.indexOf("#"))){for(k$i="#",k$p=k$m+1,k$o=k$h.length;k$p<k$o;k$p++){var k$q=k$h.charAt(k$p);if(" "===k$q||"\t"===k$q||"\r"===k$q||"\n"===k$q||"?"===k$q)break;k$i+=k$q}switch(k$f.name=k$i){case"#ifdef":case"#ifndef":if(k$f.src=k$h,k$f.noCompile=null!=k$h.match(/[!&|()=<>]/),k$f.noCompile?console.log("function():Boolean{return "+k$h.substr(k$m+k$f.name.length)+"}"):(k$k=k$h.replace(/^\s*/,"").split(/\s+/),k$f.setCondition(k$k[1],"#ifdef"===k$i?1:2),k$f.text="//"+k$f.text),k$f.setParent(k$a),k$a=k$f,k$e)for(k$k=k$h.substr(k$p).split(k$t._splitToWordExps3),k$p=0;k$p<k$k.length;k$p++)(k$h=k$k[k$p]).length&&(k$e[k$h]=!0);continue;case"#if":if(k$f.src=k$h,k$f.noCompile=!0,k$f.setParent(k$a),k$a=k$f,k$e)for(k$k=k$h.substr(k$p).split(k$t._splitToWordExps3),k$p=0;k$p<k$k.length;k$p++)(k$h=k$k[k$p]).length&&"defined"!=k$h&&(k$e[k$h]=!0);continue;case"#else":k$f.src=k$h,k$g=(k$a=k$a.parent).childs[k$a.childs.length-1],k$f.noCompile=k$g.noCompile,k$f.noCompile||(k$f.condition=k$g.condition,k$f.conditionType=1==k$g.conditionType?2:1,k$f.text="//"+k$f.text+" "+k$g.text+" "+k$f.conditionType),k$f.setParent(k$a),k$a=k$f;continue;case"#endif":k$g=(k$a=k$a.parent).childs[k$a.childs.length-1],k$f.noCompile=k$g.noCompile,k$f.noCompile||(k$f.text="//"+k$f.text),k$f.setParent(k$a);continue;case"#include":k$k=k$t.splitToWords(k$h,null);var k$r=k$t.includes[k$k[1]];if(!k$r)throw"ShaderCompile error no this include file:"+k$k[1];if((k$m=k$k[0].indexOf("?"))<0){k$f.setParent(k$a),k$h=k$r.getWith("with"==k$k[2]?k$k[3]:null),this._compileToTree(k$f,k$h.split("\n"),0,k$d,k$e),k$f.text="";continue}k$f.setCondition(k$k[0].substr(k$m+1),1),k$f.text=k$r.getWith("with"==k$k[2]?k$k[3]:null);break;case"#import":k$j=(k$k=k$t.splitToWords(k$h,null))[1],k$d.push({node:k$f,file:k$t.includes[k$j],ofs:k$f.text.length});continue}}else{if((k$g=k$a.childs[k$a.childs.length-1])&&!k$g.name){0<k$d.length&&k$t.splitToWords(k$h,k$g),k$l=k$f,k$g.text+="\n"+k$h;continue}0<k$d.length&&k$t.splitToWords(k$h,k$f)}k$f.setParent(k$a)}},k$a.createShader=function(k$a,k$b,k$c){var k$d={},k$e="";if(k$a)for(var k$f in k$a)k$e+="#define "+k$f+"\n",k$d[k$f]=!0;var k$g=this._VS.toscript(k$d,[]),k$h=this._PS.toscript(k$d,[]);return(k$c||k$Ya.create)(k$e+k$g.join("\n"),k$e+k$h.join("\n"),k$b,this._nameMap)},k$t._parseOne=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g={type:k$t.shaderParamsMap[k$c[k$d+1]],name:k$c[k$d+2],size:isNaN(parseInt(k$c[k$d+3]))?1:parseInt(k$c[k$d+3])};return k$f&&("attribute"==k$e?k$a.push(k$g):k$b.push(k$g)),":"==k$c[k$d+3]&&(k$g.type=k$c[k$d+4],k$d+=2),k$d+=2},k$t.addInclude=function(k$a,k$b){if(!k$b||0===k$b.length)throw new Error("add shader include file err:"+k$a);if(k$t.includes[k$a])throw new Error("add shader include file err, has add:"+k$a);k$t.includes[k$a]=new k$c(k$b)},k$t.preGetParams=function(k$a,k$b){var k$c=[k$a,k$b],k$d={},k$e=[],k$f=[],k$g={},k$h=[];k$d.attributes=k$e,k$d.uniforms=k$f,k$d.defines=k$g;for(var k$i=0,k$j=0,k$k=0;k$k<2;k$k++){k$c[k$k]=k$c[k$k].replace(k$t._removeAnnotation,"");var k$l,k$m=k$c[k$k].match(k$t._reg);for(k$i=0,k$j=k$m.length;k$i<k$j;k$i++){var k$n=k$m[k$i];if("attribute"==k$n||"uniform"==k$n)k$i=k$t._parseOne(k$e,k$f,k$m,k$i,k$n,!0);else{if("#define"==k$n){k$h[k$n=k$m[++k$i]]=1;continue}if("#ifdef"==k$n){k$g[k$l=k$m[++k$i]]=k$g[k$l]||[];for(k$i++;k$i<k$j;k$i++)if("attribute"==(k$n=k$m[k$i])||"uniform"==k$n)k$i=k$t._parseOne(k$e,k$f,k$m,k$i,k$n,k$h[k$l]);else if("#else"==k$n)for(k$i++;k$i<k$j;k$i++)if("attribute"==(k$n=k$m[k$i])||"uniform"==k$n)k$i=k$t._parseOne(k$e,k$f,k$m,k$i,k$n,!k$h[k$l]);else if("#endif"==k$n)break}}}}return k$d},k$t.splitToWords=function(k$a,k$b){for(var k$c,k$d,k$e=[],k$f=-1,k$g=0,k$h=k$a.length;k$g<k$h;k$g++)if(k$c=k$a.charAt(k$g),0<=" \t=+-*/&%!<>()'\",;".indexOf(k$c)){if(0<=k$f&&1<k$g-k$f&&(k$d=k$a.substr(k$f,k$g-k$f),k$e.push(k$d)),'"'==k$c||"'"==k$c){var k$i=k$a.indexOf(k$c,k$g+1);if(k$i<0)throw"Sharder err:"+k$a;k$e.push(k$a.substr(k$g+1,k$i-k$g-1)),k$g=k$i,k$f=-1;continue}"("==k$c&&k$b&&0<k$e.length&&(k$d=k$e[k$e.length-1]+";","vec4;main;".indexOf(k$d)<0&&(k$b.useFuns+=k$d)),k$f=-1}else k$f<0&&(k$f=k$g);return k$f<k$h&&1<k$h-k$f&&(k$d=k$a.substr(k$f,k$h-k$f),k$e.push(k$d)),k$e},k$t.IFDEF_NO=0,k$t.IFDEF_YES=1,k$t.IFDEF_ELSE=2,k$t.IFDEF_PARENT=3,k$t._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),k$t._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),k$t._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),k$t.includes={},k$g(k$t,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),k$t.__init$=function(){k$s=function(){function k$c(k$a){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=k$a}k$m(k$c,"");var k$a=k$c.prototype;return k$a.setParent=function(k$a){k$a.childs.push(this),this.z=k$a.z+1,this.parent=k$a},k$a.setCondition=function(k$a,k$b){k$a&&(this.conditionType=k$b,k$a=k$a.replace(/(\s*$)/g,""),this.condition=function(){return this[k$a]},this.condition.__condition=k$a)},k$a.toscript=function(k$a,k$b){return this._toscript(k$a,k$b,++k$c.__id)},k$a._toscript=function(k$d,k$e,k$f){if(this.childs.length<1&&!this.text)return k$e;k$e.length;if(this.condition){var k$a=!!this.condition.call(k$d);if(2===this.conditionType&&(k$a=!k$a),!k$a)return k$e}if(this.text&&k$e.push(this.text),0<this.childs.length&&this.childs.forEach(function(k$a,k$b,k$c){k$a._toscript(k$d,k$e,k$f)}),0<this.includefiles.length&&0<this.useFuns.length)for(var k$b,k$c=0,k$g=this.includefiles.length;k$c<k$g;k$c++)this.includefiles[k$c].curUseID!=k$f&&0<(k$b=this.includefiles[k$c].file.getFunsScript(this.useFuns)).length&&(this.includefiles[k$c].curUseID=k$f,k$e[0]=k$b+k$e[0]);return k$e},k$c.__id=1,k$c}(),k$c=function(){function k$a(k$a){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=k$a;for(var k$b=0,k$c=0,k$d=0;!((k$b=k$a.indexOf("#begin",k$b))<0);){for(k$d=k$b+5;!((k$d=k$a.indexOf("#end",k$d))<0)&&"i"===k$a.charAt(k$d+4);)k$d+=5;if(k$d<0)throw"add include err,no #end:"+k$a;k$c=k$a.indexOf("\n",k$b);var k$e=k$t.splitToWords(k$a.substr(k$b,k$c-k$b),null);"code"==k$e[1]?this.codes[k$e[2]]=k$a.substr(k$c+1,k$d-k$c-1):"function"==k$e[1]&&(k$c=k$a.indexOf("function",k$b),k$c+="function".length,this.funs[k$e[3]]=k$a.substr(k$c+1,k$d-k$c-1),this.funnames+=k$e[3]+";"),k$b=k$d+1}}k$m(k$a,"");var k$b=k$a.prototype;return k$b.getWith=function(k$a){var k$b=k$a?this.codes[k$a]:this.script;if(!k$b)throw"get with error:"+k$a;return k$b},k$b.getFunsScript=function(k$a){var k$b="";for(var k$c in this.funs)0<=k$a.indexOf(k$c+";")&&(k$b+=this.funs[k$c]);return k$b},k$a}()},k$t}(),k$wa=function(){function k$g(){}return k$m(k$g,"laya.webgl.WebGL"),k$g._uint8ArraySlice=function(){for(var k$a=this.length,k$b=new Uint8Array(this.length),k$c=0;k$c<k$a;k$c++)k$b[k$c]=this[k$c];return k$b},k$g._float32ArraySlice=function(){for(var k$a=this.length,k$b=new Float32Array(this.length),k$c=0;k$c<k$a;k$c++)k$b[k$c]=this[k$c];return k$b},k$g._uint16ArraySlice=function(k$a){var k$b,k$c=arguments,k$d=0,k$e=0;if(0===k$c.length)for(k$d=this.length,k$b=new Uint16Array(k$d),k$e=0;k$e<k$d;k$e++)k$b[k$e]=this[k$e];else if(2===k$c.length){var k$f=k$c[0],k$g=k$c[1];if(k$f<k$g)for(k$d=k$g-k$f,k$b=new Uint16Array(k$d),k$e=k$f;k$e<k$g;k$e++)k$b[k$e-k$f]=this[k$e];else k$b=new Uint16Array(0)}return k$b},k$g.expandContext=function(){var k$a=k$e.prototype,k$b=CanvasRenderingContext2D.prototype;k$b.fillTrangles=k$a.fillTrangles,k$Za.__int__(null),k$b.setIBVB=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){void 0===k$i&&(k$i=0),void 0===k$j&&(k$j=0),null===k$c&&(this._ib=this._ib||k$ua.QuadrangleIB,k$c=this._ib,k$qa.expandIBQuadrangle(k$c,k$d._byteLength/64+8)),this._setIBVB(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j)},k$b.fillTrangles=function(k$a,k$b,k$c,k$d,k$e){this._curMat=this._curMat||k$B.create(),this._vb=this._vb||k$va.create(),this._ib||(this._ib=k$ua.create(),k$qa.fillIBQuadrangle(this._ib,k$g/4));var k$f=this._vb,k$g=k$d.length>>4;k$qa.fillTranglesVB(k$f,k$b,k$c,k$d,k$e||this._curMat,0,0),k$qa.expandIBQuadrangle(this._ib,k$f._byteLength/64+8);var k$h=new k$Aa(1,0);k$h.textureHost=k$a;var k$i=new k$_a("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");k$f._vertType=3,this._setIBVB(k$b,k$c,this._ib,k$f,6*k$g,k$e,k$i,k$h,0,0)}},k$g.enable=function(){if(k$n.__init__(),k$r.isConchApp&&!k$r.isConchWebGL)return k$x.skinAniSprite=function(){return new k$aa},k$g.expandContext(),!1;if(k$x.getWebGLContext=function(k$a){for(var k$b,k$c=["webgl","experimental-webgl","webkit-3d","moz-webgl"],k$d=0;k$d<k$c.length;k$d++){try{k$b=k$a.getContext(k$c[k$d],{stencil:k$z.isStencil,alpha:k$z.isAlpha,antialias:k$z.isAntialias,premultipliedAlpha:k$z.premultipliedAlpha,preserveDrawingBuffer:k$z.preserveDrawingBuffer})}catch(k$a){}if(k$b)return k$b}return null},null==(k$g.mainContext=k$x.getWebGLContext(k$r._mainCanvas)))return!1;if(k$r.isWebGL)return!0;k$p.create=function(k$a,k$b){return new k$ab(k$a,k$b)},k$q.create=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){return new k$Xa(k$a,k$b,k$c,k$d,k$e,k$f,k$g)},k$r.WebGL=k$g,k$r.isWebGL=!0,k$na.__init__(),k$x.createRenderSprite=function(k$a,k$b){return new k$Ba(k$a,k$b)},k$x.createWebGLContext2D=function(k$a){return new k$za(k$a)},k$x.changeWebGLSize=function(k$a,k$b){laya.webgl.WebGL.onStageResize(k$a,k$b)},k$x.createGraphics=function(){return new k$ya};var k$a=k$x.createFilterAction;return k$x.createFilterAction=k$a||function(k$a){return new k$Ca},k$x.clear=function(k$a){k$sa.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var k$b=k$r.context.ctx,k$c=0==k$b._submits._length||k$z.preserveDrawingBuffer?k$o.create(k$a)._color:k$F._wgColor;k$c&&k$b.clearBG(k$c[0],k$c[1],k$c[2],k$c[3]),k$sa.clear()},k$x.addToAtlas=function(k$a,k$b){void 0===k$b&&(k$b=!1);var k$c=k$a.bitmap;k$r.optimizeTextureMemory(k$a.url,k$a)?k$y.__typeof(k$c,"laya.webgl.resource.IMergeAtlasBitmap")&&k$c.allowMerageInAtlas&&k$c.on("recovered",k$a,k$a.addTextureToAtlas):k$c.enableMerageInAtlas=!1},k$x.isAtlas=function(k$a){return k$a instanceof laya.webgl.atlas.AtlasWebGLCanvas},k$Q._enable(),k$x.beginFlush=function(){for(var k$a=k$Q.instance,k$b=k$a.getAtlaserCount(),k$c=0;k$c<k$b;k$c++){var k$d=k$a.getAtlaserByIndex(k$c).texture;k$d._flashCacheImageNeedFlush&&k$x.flashFlushImage(k$d)}},k$x.drawToCanvas=function(k$a,k$b,k$c,k$d,k$e,k$f){(k$c<=0||k$d<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),k$c|=0,k$d|=0,k$e|=0,k$f|=0;var k$g=k$Ma.create(k$c,k$d,6408,5121,0,!1);k$g.start(),k$g.clear(0,0,0,0),k$r.context.clear(),k$s.renders[k$b]._fun(k$a,k$r.context,k$e,k$sa.height-k$d+k$f),k$r.context.flush(),k$g.end();var k$h=k$g.getData(0,0,k$c,k$d);if(k$g.recycle(),k$h.byteLength==k$c*k$d*4){var k$i=new k$Ua;k$i._canvas=k$n.createElement("canvas"),k$i.size(k$c,k$d);var k$j=k$i._canvas.getContext("2d");k$n.canvas.size(k$c,k$d);var k$k=k$n.context,k$l=k$k.createImageData(k$c,k$d);return k$l.data.set(new Uint8ClampedArray(k$h.buffer)),k$i._imgData=k$l,k$k.putImageData(k$l,0,0),k$j.save(),k$j.translate(0,k$d),k$j.scale(1,-1),k$j.drawImage(k$n.canvas.source,0,0),k$j.restore(),k$i}console.log("drawToCanvas error: w:"+k$c+",h:"+k$d+",datalen:"+k$h.byteLength)},k$x.createFilterAction=function(k$a){var k$b;switch(k$a){case 32:k$b=new k$Ca}return k$b},k$x.addTextureToAtlas=function(k$a){k$a._uvID++,k$Q._atlasRestore++,k$a.bitmap.enableMerageInAtlas&&k$Q.instance.addToAtlas(k$a)},k$x.getTexturePixels=function(k$a,k$b,k$c,k$d,k$e){k$r.context.ctx.clear();var k$f=new k$E;k$f.graphics.drawTexture(k$a,-k$b,-k$c);var k$g=k$Ma.create(k$d,k$e);k$g.start(),k$g.clear(0,0,0,0),k$f.render(k$r.context,0,0),k$r.context.ctx.flush(),k$g.end();for(var k$h=k$g.getData(0,0,k$d,k$e),k$i=[],k$j=0,k$k=k$e-1;0<=k$k;k$k--)for(var k$l=0;k$l<k$d;k$l++)k$j=4*(k$k*k$d+k$l),k$i.push(k$h[k$j]),k$i.push(k$h[k$j+1]),k$i.push(k$h[k$j+2]),k$i.push(k$h[k$j+3]);return k$i},k$x.skinAniSprite=function(){return new k$aa},k$j.create=function(k$a,k$b){var k$c=new k$Ua;return k$c._imgData=k$b,k$c.flipY=!1,k$c},k$A._filterStart=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$a.getValue("bounds"),k$g=k$Ma.create(k$f.width,k$f.height);if(k$g.start(),k$g.clear(0,0,0,0),k$a.addValue("src",k$g),k$a.addValue("ScissorTest",k$sa.worldScissorTest),k$sa.worldScissorTest){var k$h=new k$D;k$h.copyFrom(k$c.ctx._clipRect),k$a.addValue("clipRect",k$h),k$sa.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},k$A._filterEnd=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$a.getValue("bounds");k$a.getValue("src").end();var k$g=k$Ma.create(k$f.width,k$f.height);k$g.start(),k$g.clear(0,0,0,0),k$a.addValue("out",k$g),k$b._set$P("_filterCache",k$g),k$b._set$P("_isHaveGlowFilter",k$a.getValue("_isHaveGlowFilter"))},k$A._EndTarget=function(k$a,k$b){if(k$a.getValue("src").recycle(),k$a.getValue("out").end(),k$a.getValue("ScissorTest")){k$sa.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),k$b.ctx.save();var k$c=k$a.getValue("clipRect");k$b.ctx.clipRect(k$c.x,k$c.y,k$c.width,k$c.height)}},k$A._useSrc=function(k$a){var k$b=k$a.getValue("out");k$b.end(),(k$b=k$a.getValue("src")).start(),k$b.clear(0,0,0,0)},k$A._endSrc=function(k$a){k$a.getValue("src").end()},k$A._useOut=function(k$a){var k$b=k$a.getValue("src");k$b.end(),(k$b=k$a.getValue("out")).start(),k$b.clear(0,0,0,0)},k$A._endOut=function(k$a){k$a.getValue("out").end()},k$A._recycleScope=function(k$a){k$a.recycle()},k$A._filter=function(k$a,k$b,k$c,k$d){var k$e=this._next;if(k$e){var k$f,k$g,k$h=k$a.filters,k$i=k$h.length;if(1==k$i&&32==k$h[0].type)return k$b.ctx.save(),k$b.ctx.setFilters([k$h[0]]),k$e._fun.call(k$e,k$a,k$b,k$c,k$d),void k$b.ctx.restore();var k$j=k$ha.create(),k$k=k$C.TEMP,k$l=k$b.ctx._getTransformMatrix(),k$m=k$B.create();k$l.copyTo(k$m);var k$n=0,k$o=0,k$p=!1,k$q=k$a._$P._filterCache?k$a._$P._filterCache:null;if(!k$q||k$a._repaint){k$p=k$a._isHaveGlowFilter(),k$j.addValue("_isHaveGlowFilter",k$p),k$p&&(k$n=50,k$o=25),(k$g=new k$D).copyFrom(k$a.getSelfBounds()),k$g.x+=k$a.x,k$g.y+=k$a.y,k$g.x-=k$a.pivotX+4,k$g.y-=k$a.pivotY+4;var k$r=k$g.x,k$s=k$g.y;if(k$g.width+=k$n+8,k$g.height+=k$n+8,k$k.x=k$g.x*k$m.a+k$g.y*k$m.c,k$k.y=k$g.y*k$m.d+k$g.x*k$m.b,k$g.x=k$k.x,k$g.y=k$k.y,k$k.x=k$g.width*k$m.a+k$g.height*k$m.c,k$k.y=k$g.height*k$m.d+k$g.width*k$m.b,k$g.width=k$k.x,k$g.height=k$k.y,k$g.width<=0||k$g.height<=0)return;k$q&&k$q.recycle(),k$j.addValue("bounds",k$g);var k$t=k$ga.create([k$j,k$a,k$b,0,0],k$A._filterStart);k$b.addRenderObject(k$t),k$b.ctx._renderKey=0,k$b.ctx._shader2D.glTexture=null;var k$w=k$a.x-k$r+k$o,k$x=k$a.y-k$s+k$o;k$e._fun.call(k$e,k$a,k$b,k$w,k$x),k$t=k$ga.create([k$j,k$a,k$b,0,0],k$A._filterEnd),k$b.addRenderObject(k$t);for(var k$y=0;k$y<k$i;k$y++){0!=k$y&&(k$t=k$ga.create([k$j],k$A._useSrc),k$b.addRenderObject(k$t),k$f=k$Aa.create(1,0),k$B.TEMP.identity(),k$b.ctx.drawTarget(k$j,0,0,k$g.width,k$g.height,k$B.TEMP,"out",k$f,null,k$S.TOINT.overlay),k$t=k$ga.create([k$j],k$A._useOut),k$b.addRenderObject(k$t)),k$h[k$y].action.apply3d(k$j,k$a,k$b,0,0)}k$t=k$ga.create([k$j,k$b],k$A._EndTarget),k$b.addRenderObject(k$t)}else{if((k$p=!!k$a._$P._isHaveGlowFilter&&k$a._$P._isHaveGlowFilter)&&(k$n=50,k$o=25),(k$g=k$a.getBounds()).width<=0||k$g.height<=0)return;k$g.width+=k$n,k$g.height+=k$n,k$k.x=k$g.x*k$m.a+k$g.y*k$m.c,k$k.y=k$g.y*k$m.d+k$g.x*k$m.b,k$g.x=k$k.x,k$g.y=k$k.y,k$k.x=k$g.width*k$m.a+k$g.height*k$m.c,k$k.y=k$g.height*k$m.d+k$g.width*k$m.b,k$g.width=k$k.x,k$g.height=k$k.y,k$j.addValue("out",k$q)}k$c=k$c-k$o-k$a.x,k$d=k$d-k$o-k$a.y,k$k.setTo(k$c,k$d),k$m.transformPoint(k$k),k$c=k$k.x+k$g.x,k$d=k$k.y+k$g.y,k$f=k$Aa.create(1,0),k$B.TEMP.identity(),k$b.ctx.drawTarget(k$j,k$c,k$d,k$g.width,k$g.height,k$B.TEMP,"out",k$f,null,k$S.TOINT.overlay),k$t=k$ga.create([k$j],k$A._recycleScope),k$b.addRenderObject(k$t),k$m.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=k$g._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=k$g._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=k$g._uint8ArraySlice),!0},k$g.onStageResize=function(k$a,k$b){null!=k$g.mainContext&&(k$g.mainContext.viewport(0,0,k$a,k$b),k$sa.width=k$a,k$sa.height=k$b)},k$g.onInvalidGLRes=function(){k$Q.instance.freeAll(),k$w.releaseContentManagers(!0),k$g.doNodeRepaint(k$y.stage),k$g.mainContext.viewport(0,0,k$sa.width,k$sa.height),k$y.stage.event("devicelost")},k$g.doNodeRepaint=function(k$a){0==k$a.numChildren&&k$a.repaint();for(var k$b=0;k$b<k$a.numChildren;k$b++)k$g.doNodeRepaint(k$a.getChildAt(k$b))},k$g.init=function(k$a,k$b,k$c){k$g.mainCanvas=k$a,k$j._createContext=function(k$a){return new k$za(k$a)},k$Ua._createContext=function(k$a){return new k$za(k$a)};var k$d=laya.webgl.WebGL.mainContext;if(null!=k$d.getShaderPrecisionFormat){var k$e=k$d.getShaderPrecisionFormat(35633,36338),k$f=k$d.getShaderPrecisionFormat(35632,36338);k$g.shaderHighPrecision=!(!k$e.precision||!k$f.precision)}else k$g.shaderHighPrecision=!1;if(k$d.deleteTexture1=k$d.deleteTexture,k$d.deleteTexture=function(k$a){k$a==k$xa.curBindTexValue&&(k$xa.curBindTexValue=null),k$d.deleteTexture1(k$a)},k$g.onStageResize(k$b,k$c),null==k$g.mainContext)throw new Error("webGL getContext err!");k$I.__init__(),k$Q.__init__(),k$Ea.__init__(),k$fa.__init__(),k$za.__init__(),k$Aa.__init__(),k$u.__init__(),k$Za.__int__(k$d),k$S._init_(k$d),k$r.isConchApp&&conch.setOnInvalidGLRes(k$g.onInvalidGLRes)},k$g.mainCanvas=null,k$g.mainContext=null,k$g.antialias=!0,k$g.shaderHighPrecision=!1,k$g._bg_null=[0,0,0,0],k$g}(),k$xa=function(){function k$d(){}return k$m(k$d,"laya.webgl.WebGLContext"),k$d.UseProgram=function(k$a){return k$d._useProgram!==k$a&&(k$wa.mainContext.useProgram(k$a),k$d._useProgram=k$a,!0)},k$d.setDepthTest=function(k$a,k$b){k$b!==k$d._depthTest&&((k$d._depthTest=k$b)?k$a.enable(2929):k$a.disable(2929))},k$d.setDepthMask=function(k$a,k$b){k$b!==k$d._depthMask&&(k$d._depthMask=k$b,k$a.depthMask(k$b))},k$d.setDepthFunc=function(k$a,k$b){k$b!==k$d._depthFunc&&(k$d._depthFunc=k$b,k$a.depthFunc(k$b))},k$d.setBlend=function(k$a,k$b){k$b!==k$d._blend&&((k$d._blend=k$b)?k$a.enable(3042):k$a.disable(3042))},k$d.setBlendFunc=function(k$a,k$b,k$c){(k$b!==k$d._sFactor||k$c!==k$d._dFactor)&&(k$d._sFactor=k$b,k$d._dFactor=k$c,k$a.blendFunc(k$b,k$c))},k$d.setCullFace=function(k$a,k$b){k$b!==k$d._cullFace&&((k$d._cullFace=k$b)?k$a.enable(2884):k$a.disable(2884))},k$d.setFrontFace=function(k$a,k$b){k$b!==k$d._frontFace&&(k$d._frontFace=k$b,k$a.frontFace(k$b))},k$d.bindTexture=function(k$a,k$b,k$c){k$a.bindTexture(k$b,k$c),k$d.curBindTexTarget=k$b,k$d.curBindTexValue=k$c},k$d.DEPTH_BUFFER_BIT=256,k$d.STENCIL_BUFFER_BIT=1024,k$d.COLOR_BUFFER_BIT=16384,k$d.POINTS=0,k$d.LINES=1,k$d.LINE_LOOP=2,k$d.LINE_STRIP=3,k$d.TRIANGLES=4,k$d.TRIANGLE_STRIP=5,k$d.TRIANGLE_FAN=6,k$d.ZERO=0,k$d.ONE=1,k$d.SRC_COLOR=768,k$d.ONE_MINUS_SRC_COLOR=769,k$d.SRC_ALPHA=770,k$d.ONE_MINUS_SRC_ALPHA=771,k$d.DST_ALPHA=772,k$d.ONE_MINUS_DST_ALPHA=773,k$d.DST_COLOR=774,k$d.ONE_MINUS_DST_COLOR=775,k$d.SRC_ALPHA_SATURATE=776,k$d.FUNC_ADD=32774,k$d.BLEND_EQUATION=32777,k$d.BLEND_EQUATION_RGB=32777,k$d.BLEND_EQUATION_ALPHA=34877,k$d.FUNC_SUBTRACT=32778,k$d.FUNC_REVERSE_SUBTRACT=32779,k$d.BLEND_DST_RGB=32968,k$d.BLEND_SRC_RGB=32969,k$d.BLEND_DST_ALPHA=32970,k$d.BLEND_SRC_ALPHA=32971,k$d.CONSTANT_COLOR=32769,k$d.ONE_MINUS_CONSTANT_COLOR=32770,k$d.CONSTANT_ALPHA=32771,k$d.ONE_MINUS_CONSTANT_ALPHA=32772,k$d.BLEND_COLOR=32773,k$d.ARRAY_BUFFER=34962,k$d.ELEMENT_ARRAY_BUFFER=34963,k$d.ARRAY_BUFFER_BINDING=34964,k$d.ELEMENT_ARRAY_BUFFER_BINDING=34965,k$d.STREAM_DRAW=35040,k$d.STATIC_DRAW=35044,k$d.DYNAMIC_DRAW=35048,k$d.BUFFER_SIZE=34660,k$d.BUFFER_USAGE=34661,k$d.CURRENT_VERTEX_ATTRIB=34342,k$d.FRONT=1028,k$d.BACK=1029,k$d.CULL_FACE=2884,k$d.FRONT_AND_BACK=1032,k$d.BLEND=3042,k$d.DITHER=3024,k$d.STENCIL_TEST=2960,k$d.DEPTH_TEST=2929,k$d.SCISSOR_TEST=3089,k$d.POLYGON_OFFSET_FILL=32823,k$d.SAMPLE_ALPHA_TO_COVERAGE=32926,k$d.SAMPLE_COVERAGE=32928,k$d.NO_ERROR=0,k$d.INVALID_ENUM=1280,k$d.INVALID_VALUE=1281,k$d.INVALID_OPERATION=1282,k$d.OUT_OF_MEMORY=1285,k$d.CW=2304,k$d.CCW=2305,k$d.LINE_WIDTH=2849,k$d.ALIASED_POINT_SIZE_RANGE=33901,k$d.ALIASED_LINE_WIDTH_RANGE=33902,k$d.CULL_FACE_MODE=2885,k$d.FRONT_FACE=2886,k$d.DEPTH_RANGE=2928,k$d.DEPTH_WRITEMASK=2930,k$d.DEPTH_CLEAR_VALUE=2931,k$d.DEPTH_FUNC=2932,k$d.STENCIL_CLEAR_VALUE=2961,k$d.STENCIL_FUNC=2962,k$d.STENCIL_FAIL=2964,k$d.STENCIL_PASS_DEPTH_FAIL=2965,k$d.STENCIL_PASS_DEPTH_PASS=2966,k$d.STENCIL_REF=2967,k$d.STENCIL_VALUE_MASK=2963,k$d.STENCIL_WRITEMASK=2968,k$d.STENCIL_BACK_FUNC=34816,k$d.STENCIL_BACK_FAIL=34817,k$d.STENCIL_BACK_PASS_DEPTH_FAIL=34818,k$d.STENCIL_BACK_PASS_DEPTH_PASS=34819,k$d.STENCIL_BACK_REF=36003,k$d.STENCIL_BACK_VALUE_MASK=36004,k$d.STENCIL_BACK_WRITEMASK=36005,k$d.VIEWPORT=2978,k$d.SCISSOR_BOX=3088,k$d.COLOR_CLEAR_VALUE=3106,k$d.COLOR_WRITEMASK=3107,k$d.UNPACK_ALIGNMENT=3317,k$d.PACK_ALIGNMENT=3333,k$d.MAX_TEXTURE_SIZE=3379,k$d.MAX_VIEWPORT_DIMS=3386,k$d.SUBPIXEL_BITS=3408,k$d.RED_BITS=3410,k$d.GREEN_BITS=3411,k$d.BLUE_BITS=3412,k$d.ALPHA_BITS=3413,k$d.DEPTH_BITS=3414,k$d.STENCIL_BITS=3415,k$d.POLYGON_OFFSET_UNITS=10752,k$d.POLYGON_OFFSET_FACTOR=32824,k$d.TEXTURE_BINDING_2D=32873,k$d.SAMPLE_BUFFERS=32936,k$d.SAMPLES=32937,k$d.SAMPLE_COVERAGE_VALUE=32938,k$d.SAMPLE_COVERAGE_INVERT=32939,k$d.NUM_COMPRESSED_TEXTURE_FORMATS=34466,k$d.COMPRESSED_TEXTURE_FORMATS=34467,k$d.DONT_CARE=4352,k$d.FASTEST=4353,k$d.NICEST=4354,k$d.GENERATE_MIPMAP_HINT=33170,k$d.BYTE=5120,k$d.UNSIGNED_BYTE=5121,k$d.SHORT=5122,k$d.UNSIGNED_SHORT=5123,k$d.INT=5124,k$d.UNSIGNED_INT=5125,k$d.FLOAT=5126,k$d.DEPTH_COMPONENT=6402,k$d.ALPHA=6406,k$d.RGB=6407,k$d.RGBA=6408,k$d.LUMINANCE=6409,k$d.LUMINANCE_ALPHA=6410,k$d.UNSIGNED_SHORT_4_4_4_4=32819,k$d.UNSIGNED_SHORT_5_5_5_1=32820,k$d.UNSIGNED_SHORT_5_6_5=33635,k$d.FRAGMENT_SHADER=35632,k$d.VERTEX_SHADER=35633,k$d.MAX_VERTEX_ATTRIBS=34921,k$d.MAX_VERTEX_UNIFORM_VECTORS=36347,k$d.MAX_VARYING_VECTORS=36348,k$d.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,k$d.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,k$d.MAX_TEXTURE_IMAGE_UNITS=34930,k$d.MAX_FRAGMENT_UNIFORM_VECTORS=36349,k$d.SHADER_TYPE=35663,k$d.DELETE_STATUS=35712,k$d.LINK_STATUS=35714,k$d.VALIDATE_STATUS=35715,k$d.ATTACHED_SHADERS=35717,k$d.ACTIVE_UNIFORMS=35718,k$d.ACTIVE_ATTRIBUTES=35721,k$d.SHADING_LANGUAGE_VERSION=35724,k$d.CURRENT_PROGRAM=35725,k$d.NEVER=512,k$d.LESS=513,k$d.EQUAL=514,k$d.LEQUAL=515,k$d.GREATER=516,k$d.NOTEQUAL=517,k$d.GEQUAL=518,k$d.ALWAYS=519,k$d.KEEP=7680,k$d.REPLACE=7681,k$d.INCR=7682,k$d.DECR=7683,k$d.INVERT=5386,k$d.INCR_WRAP=34055,k$d.DECR_WRAP=34056,k$d.VENDOR=7936,k$d.RENDERER=7937,k$d.VERSION=7938,k$d.NEAREST=9728,k$d.LINEAR=9729,k$d.NEAREST_MIPMAP_NEAREST=9984,k$d.LINEAR_MIPMAP_NEAREST=9985,k$d.NEAREST_MIPMAP_LINEAR=9986,k$d.LINEAR_MIPMAP_LINEAR=9987,k$d.TEXTURE_MAG_FILTER=10240,k$d.TEXTURE_MIN_FILTER=10241,k$d.TEXTURE_WRAP_S=10242,k$d.TEXTURE_WRAP_T=10243,k$d.TEXTURE_2D=3553,k$d.TEXTURE=5890,k$d.TEXTURE_CUBE_MAP=34067,k$d.TEXTURE_BINDING_CUBE_MAP=34068,k$d.TEXTURE_CUBE_MAP_POSITIVE_X=34069,k$d.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,k$d.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,k$d.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,k$d.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,k$d.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,k$d.MAX_CUBE_MAP_TEXTURE_SIZE=34076,k$d.TEXTURE0=33984,k$d.TEXTURE1=33985,k$d.TEXTURE2=33986,k$d.TEXTURE3=33987,k$d.TEXTURE4=33988,k$d.TEXTURE5=33989,k$d.TEXTURE6=33990,k$d.TEXTURE7=33991,k$d.TEXTURE8=33992,k$d.TEXTURE9=33993,k$d.TEXTURE10=33994,k$d.TEXTURE11=33995,k$d.TEXTURE12=33996,k$d.TEXTURE13=33997,k$d.TEXTURE14=33998,k$d.TEXTURE15=33999,k$d.TEXTURE16=34e3,k$d.TEXTURE17=34001,k$d.TEXTURE18=34002,k$d.TEXTURE19=34003,k$d.TEXTURE20=34004,k$d.TEXTURE21=34005,k$d.TEXTURE22=34006,k$d.TEXTURE23=34007,k$d.TEXTURE24=34008,k$d.TEXTURE25=34009,k$d.TEXTURE26=34010,k$d.TEXTURE27=34011,k$d.TEXTURE28=34012,k$d.TEXTURE29=34013,k$d.TEXTURE30=34014,k$d.TEXTURE31=34015,k$d.ACTIVE_TEXTURE=34016,k$d.REPEAT=10497,k$d.CLAMP_TO_EDGE=33071,k$d.MIRRORED_REPEAT=33648,k$d.FLOAT_VEC2=35664,k$d.FLOAT_VEC3=35665,k$d.FLOAT_VEC4=35666,k$d.INT_VEC2=35667,k$d.INT_VEC3=35668,k$d.INT_VEC4=35669,k$d.BOOL=35670,k$d.BOOL_VEC2=35671,k$d.BOOL_VEC3=35672,k$d.BOOL_VEC4=35673,k$d.FLOAT_MAT2=35674,k$d.FLOAT_MAT3=35675,k$d.FLOAT_MAT4=35676,k$d.SAMPLER_2D=35678,k$d.SAMPLER_CUBE=35680,k$d.VERTEX_ATTRIB_ARRAY_ENABLED=34338,k$d.VERTEX_ATTRIB_ARRAY_SIZE=34339,k$d.VERTEX_ATTRIB_ARRAY_STRIDE=34340,k$d.VERTEX_ATTRIB_ARRAY_TYPE=34341,k$d.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,k$d.VERTEX_ATTRIB_ARRAY_POINTER=34373,k$d.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,k$d.COMPILE_STATUS=35713,k$d.LOW_FLOAT=36336,k$d.MEDIUM_FLOAT=36337,k$d.HIGH_FLOAT=36338,k$d.LOW_INT=36339,k$d.MEDIUM_INT=36340,k$d.HIGH_INT=36341,k$d.FRAMEBUFFER=36160,k$d.RENDERBUFFER=36161,k$d.RGBA4=32854,k$d.RGB5_A1=32855,k$d.RGB565=36194,k$d.DEPTH_COMPONENT16=33189,k$d.STENCIL_INDEX=6401,k$d.STENCIL_INDEX8=36168,k$d.DEPTH_STENCIL=34041,k$d.RENDERBUFFER_WIDTH=36162,k$d.RENDERBUFFER_HEIGHT=36163,k$d.RENDERBUFFER_INTERNAL_FORMAT=36164,k$d.RENDERBUFFER_RED_SIZE=36176,k$d.RENDERBUFFER_GREEN_SIZE=36177,k$d.RENDERBUFFER_BLUE_SIZE=36178,k$d.RENDERBUFFER_ALPHA_SIZE=36179,k$d.RENDERBUFFER_DEPTH_SIZE=36180,k$d.RENDERBUFFER_STENCIL_SIZE=36181,k$d.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,k$d.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,k$d.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,k$d.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,k$d.COLOR_ATTACHMENT0=36064,k$d.DEPTH_ATTACHMENT=36096,k$d.STENCIL_ATTACHMENT=36128,k$d.DEPTH_STENCIL_ATTACHMENT=33306,k$d.NONE=0,k$d.FRAMEBUFFER_COMPLETE=36053,k$d.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,k$d.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,k$d.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,k$d.FRAMEBUFFER_UNSUPPORTED=36061,k$d.FRAMEBUFFER_BINDING=36006,k$d.RENDERBUFFER_BINDING=36007,k$d.MAX_RENDERBUFFER_SIZE=34024,k$d.INVALID_FRAMEBUFFER_OPERATION=1286,k$d.UNPACK_FLIP_Y_WEBGL=37440,k$d.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,k$d.CONTEXT_LOST_WEBGL=37442,k$d.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,k$d.BROWSER_DEFAULT_WEBGL=37444,k$d._useProgram=null,k$d._depthTest=!0,k$d._depthMask=!0,k$d._blend=!1,k$d._cullFace=!1,k$d.curBindTexTarget=null,k$d.curBindTexValue=null,k$g(k$d,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),k$d}(),k$ya=function(k$a){function k$b(){k$b.__super.call(this)}k$m(k$b,"laya.webgl.display.GraphicsGL",k$h);var k$c=k$b.prototype;return k$c.setShader=function(k$a){this._saveToCmd(k$r.context._setShader,[k$a])},k$c.setIBVB=function(k$a,k$b,k$c,k$d,k$e,k$f){this._saveToCmd(k$r.context._setIBVB,[k$a,k$b,k$c,k$d,k$e,k$f])},k$c.drawParticle=function(k$a,k$b,k$c){var k$d=k$x.createParticleTemplate2D(k$c);k$d.x=k$a,k$d.y=k$b,this._saveToCmd(k$r.context._drawParticle,[k$d])},k$b}(),k$za=function(k$a){var k$c;function k$P(k$a){this._x=0,this._y=0,this._id=++k$P._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,k$P.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=k$P.MAXCLIPRECT,this.mOutPoint,this._canvas=k$a,this._canvas._addReference(),k$P._contextcount++,k$r.isFlash?(this._ib=k$ua.create(35044),k$qa.fillIBQuadrangle(this._ib,16)):this._ib=k$ua.QuadrangleIB,this.clear()}k$m(k$P,"laya.webgl.canvas.WebGLContext2D",k$e);var k$b=k$P.prototype;return k$b.setIsMainContext=function(){this._isMain=!0},k$b.clearBG=function(k$a,k$b,k$c,k$d){var k$e=k$wa.mainContext;k$e.clearColor(k$a,k$b,k$c,k$d),k$e.clear(16384)},k$b._getSubmits=function(){return this._submits},k$b._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var k$a=0,k$b=this._submits._length;k$a<k$b;k$a++)this._submits[k$a].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},k$b.destroy=function(){--k$P._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=k$ua.QuadrangleIB&&this._ib.releaseResource()},k$b.clear=function(){this._submits||(this._other=k$c.DEFAULT,this._curMat=k$B.create(),this._vb=k$va.create(-1),this._submits=[],this._save=[k$Y.Create(this)],this._save.length=10,this._shader2D=new k$u,this._triangleMesh=k$Ka.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=k$c.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=k$P.MAXCLIPRECT,this._curSubmit=k$fa.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=k$T.DEFAULT;for(var k$a=0,k$b=this._submits._length;k$a<k$b;k$a++)this._submits[k$a].releaseRender(),this._submits[k$a]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},k$b.size=function(k$a,k$b){if(this._width!=k$a||this._height!=k$b)if(0==k$a||0==k$b){0!=this._vb._byteLength&&(this._width=k$a,this._height=k$b,this._vb.clear(),this._vb.upload());for(var k$c=0,k$d=this._submits._length;k$c<k$d;k$c++)this._submits[k$c].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=k$a,this._height=k$b,this._targets&&this._targets.size(k$a,k$b),this._canvas.memorySize-=this._canvas.memorySize;0===k$a&&0===k$b&&this._releaseMem()},k$b._getTransformMatrix=function(){return this._curMat},k$b.translate=function(k$a,k$b){0===k$a&&0===k$b||(k$$.save(this),this._curMat.bTransform&&(k$Z.save(this),this._curMat.transformPointN(k$C.TEMP.setTo(k$a,k$b)),k$a=k$C.TEMP.x,k$b=k$C.TEMP.y),this._x+=k$a,this._y+=k$b)},k$b.save=function(){this._save[this._save._length++]=k$Y.Create(this)},k$b.restore=function(){var k$a=this._save._length;if(!(k$a<1))for(var k$b=k$a-1;0<=k$b;k$b--){var k$c=this._save[k$b];if(k$c.restore(this),k$c.isSaveMark())return void(this._save._length=k$b)}},k$b._fillText=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){void 0===k$j&&(k$j=0);var k$k=this._shader2D,k$l=this._curSubmit.shaderValue,k$m=k$e?k$oa.create(k$e):this._other.font;if(k$Q.enabled)k$k.ALPHA!==k$l.ALPHA&&(k$k.glTexture=null),k$na.drawText(this,k$a,k$b,this._curMat,k$m,k$i||this._other.textAlign,k$f,k$g,k$h,k$c,k$d,k$j);else{this._shader2D.defines.getValue();var k$n=k$f?k$o.create(k$f)._color:k$k.colorAdd;k$k.ALPHA===k$l.ALPHA&&k$n===k$k.colorAdd&&k$l.colorAdd===k$k.colorAdd||(k$k.glTexture=null,k$k.colorAdd=k$n),k$na.drawText(this,k$a,k$b,this._curMat,k$m,k$i||this._other.textAlign,k$f,k$g,k$h,k$c,k$d,k$j)}},k$b.fillWords=function(k$a,k$b,k$c,k$d,k$e,k$f){this._fillText(null,k$a,k$b,k$c,k$d,k$e,null,-1,null,k$f)},k$b.fillBorderWords=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this._fillBorderText(null,k$a,k$b,k$c,k$d,k$e,k$f,k$g,null)},k$b.fillText=function(k$a,k$b,k$c,k$d,k$e,k$f){this._fillText(k$a,null,k$b,k$c,k$d,k$e,null,-1,k$f)},k$b.strokeText=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this._fillText(k$a,null,k$b,k$c,k$d,null,k$e,k$f||1,k$g)},k$b.fillBorderText=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){this._fillBorderText(k$a,null,k$b,k$c,k$d,k$e,k$f,k$g,k$h)},k$b._fillBorderText=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){if(!k$Q.enabled)return this._fillText(k$a,k$b,k$c,k$d,k$e,null,k$g,k$h||1,k$i),void this._fillText(k$a,k$b,k$c,k$d,k$e,k$f,null,-1,k$i);var k$j=this._shader2D,k$k=this._curSubmit.shaderValue;k$j.ALPHA!==k$k.ALPHA&&(k$j.glTexture=null);var k$l=k$e?(k$P._fontTemp.setFont(k$e),k$P._fontTemp):this._other.font;k$na.drawText(this,k$a,k$b,this._curMat,k$l,k$i||this._other.textAlign,k$f,k$g,k$h||1,k$c,k$d,0)},k$b.fillRect=function(k$a,k$b,k$c,k$d,k$e){var k$f=this._vb;if(k$qa.fillRectImgVb(k$f,this._clipRect,k$a,k$b,k$c,k$d,k$K.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var k$g=this._shader2D.fillStyle;k$e&&(this._shader2D.fillStyle=k$T.create(k$e));var k$h=this._shader2D,k$i=this._curSubmit.shaderValue;if(k$h.fillStyle!==k$i.fillStyle||k$h.ALPHA!==k$i.ALPHA){k$h.glTexture=null;var k$j=this._curSubmit=k$fa.createSubmit(this,this._ib,k$f,(k$f._byteLength-64)/32*3,k$Aa.create(2,0));k$j.shaderValue.color=k$h.fillStyle._color._color,k$j.shaderValue.ALPHA=k$h.ALPHA,this._submits[this._submits._length++]=k$j}this._curSubmit._numEle+=6,this._shader2D.fillStyle=k$g}},k$b.fillTexture=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){if(k$a.loaded&&k$a.bitmap&&k$a.source){var k$i=this._vb,k$j=k$a.bitmap.width,k$k=k$a.bitmap.height,k$l=k$a.uv,k$m=k$g.x%k$a.width,k$n=k$g.y%k$a.height;if(k$j!=k$h.w||k$k!=k$h.h){if(!k$h.w&&!k$h.h)switch(k$h.oy=k$h.ox=0,k$f){case"repeat":k$h.width=k$d,k$h.height=k$e;break;case"repeat-x":k$h.width=k$d,k$n<0?k$a.height+k$n>k$e?k$h.height=k$e:k$h.height=k$a.height+k$n:(k$h.oy=k$n,k$a.height+k$n>k$e?k$h.height=k$e-k$n:k$h.height=k$a.height);break;case"repeat-y":k$m<0?k$a.width+k$m>k$d?k$h.width=k$d:k$h.width=k$a.width+k$m:(k$h.ox=k$m,k$a.width+k$m>k$d?k$h.width=k$d-k$m:k$h.width=k$a.width),k$h.height=k$e;break;case"no-repeat":k$m<0?k$a.width+k$m>k$d?k$h.width=k$d:k$h.width=k$a.width+k$m:(k$h.ox=k$m,k$a.width+k$m>k$d?k$h.width=k$d-k$m:k$h.width=k$a.width),k$n<0?k$a.height+k$n>k$e?k$h.height=k$e:k$h.height=k$a.height+k$n:(k$h.oy=k$n,k$a.height+k$n>k$e?k$h.height=k$e-k$n:k$h.height=k$a.height);break;default:k$h.width=k$d,k$h.height=k$e}k$h.w=k$j,k$h.h=k$k,k$h.uv=[0,0,k$h.width/k$j,0,k$h.width/k$j,k$h.height/k$k,0,k$h.height/k$k]}if(k$b+=k$h.ox,k$c+=k$h.oy,k$m-=k$h.ox,k$n-=k$h.oy,k$qa.fillRectImgVb(k$i,this._clipRect,k$b,k$c,k$h.width,k$h.height,k$h.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var k$o=k$Ja.create(this,this._ib,k$i,(k$i._byteLength-64)/32*3,k$Aa.create(256,0)),k$p=(this._submits[this._submits._length++]=k$o).shaderValue;k$p.textureHost=k$a;var k$q=k$l[0]*k$j,k$r=k$l[1]*k$k,k$s=(k$l[2]-k$l[0])*k$j,k$t=(k$l[5]-k$l[3])*k$k,k$w=-k$m/k$j,k$x=-k$n/k$k;k$p.u_TexRange[0]=k$q/k$j,k$p.u_TexRange[1]=k$s/k$j,k$p.u_TexRange[2]=k$r/k$k,k$p.u_TexRange[3]=k$t/k$k,k$p.u_offset[0]=k$w,k$p.u_offset[1]=k$x,k$Q.enabled&&!this._isMain&&k$o.addTexture(k$a,(k$i._byteLength>>2)-16),(this._curSubmit=k$o)._renderType=10017,k$o._numEle+=6}}else this.sprite&&k$y.timer.callLater(this,this._repaintSprite)},k$b.setShader=function(k$a){k$V.save(this,1048576,this._shader2D,!0),this._shader2D.shader=k$a},k$b.setFilters=function(k$a){k$V.save(this,2097152,this._shader2D,!0),this._shader2D.filters=k$a,this._curSubmit=k$fa.RENDERBASE,this._renderKey=0,this._drawCount++},k$b.drawTexture=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this._drawTextureM(k$a,k$b,k$c,k$d,k$e,k$f,k$g,null,1)},k$b.addTextureVb=function(k$a,k$b,k$c){var k$d=this._curSubmit._vb||this._vb,k$e=k$d._byteLength>>2;k$d.byteLength=k$e+16<<2;for(var k$f=k$d.getFloat32Array(),k$g=0;k$g<16;k$g+=4)k$f[k$e++]=k$a[k$g]+k$b,k$f[k$e++]=k$a[k$g+1]+k$c,k$f[k$e++]=k$a[k$g+2],k$f[k$e++]=k$a[k$g+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),k$d._upload=!0},k$b.willDrawTexture=function(k$a,k$b){if(!(k$a.loaded&&k$a.bitmap&&k$a.source))return this.sprite&&k$y.timer.callLater(this,this._repaintSprite),0;var k$c=k$a.bitmap,k$d=k$c.id+this._shader2D.ALPHA*k$b+10016;if(k$d==this._renderKey)return k$d;var k$e=this._shader2D,k$f=k$e.ALPHA,k$g=this._curSubmit.shaderValue;k$e.ALPHA*=k$b,this._renderKey=k$d,this._drawCount++,k$e.glTexture=k$c;var k$h=this._vb,k$i=null,k$j=k$h._byteLength/32*3,k$k=k$g.textureHost&&k$g.textureHost==k$a&&k$g.textureHost.alphaTexture==k$a.alphaTexture;return k$i=k$Ja.create(this,this._ib,k$h,k$j,k$Aa.create(1,0)),(this._submits[this._submits._length++]=k$i).shaderValue.textureHost=k$a,k$i._renderType=10016,k$i._preIsSameTextureShader=10016===this._curSubmit._renderType&&k$e.ALPHA===k$g.ALPHA&&k$k,this._curSubmit=k$i,k$e.ALPHA=k$f,k$d},k$b.drawTextures=function(k$a,k$b,k$c,k$d){if(k$a.loaded&&k$a.bitmap&&k$a.source){var k$e=this._clipRect;if(this._clipRect=k$P.MAXCLIPRECT,this._drawTextureM(k$a,k$b[0],k$b[1],k$a.width,k$a.height,k$c,k$d,null,1)){if(this._clipRect=k$e,k$G.drawCall++,!(k$b.length<4)){for(var k$f=this._curSubmit._vb||this._vb,k$g=this._curMat.a,k$h=this._curMat.d,k$i=2,k$j=k$b.length;k$i<k$j;k$i+=2)k$qa.copyPreImgVb(k$f,(k$b[k$i]-k$b[k$i-2])*k$g,(k$b[k$i+1]-k$b[k$i-1])*k$h),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&k$y.timer.callLater(this,this._repaintSprite)},k$b._drawTextureM=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){if(!k$a.loaded||!k$a.source)return this.sprite&&k$y.timer.callLater(this,this._repaintSprite),!1;var k$j=this._curSubmit._vb||this._vb,k$k=k$a.bitmap;k$b+=k$f,k$c+=k$g,this._drawCount++;var k$l=k$k.id+this._shader2D.ALPHA*k$i+10016;if(k$l!=this._renderKey){this._renderKey=k$l;var k$m=this._curSubmit.shaderValue,k$n=this._shader2D,k$o=k$n.ALPHA;k$n.ALPHA*=k$i,k$n.glTexture=k$k;var k$p=this._vb,k$q=null,k$r=k$p._byteLength/32*3,k$s=k$m.textureHost&&k$m.textureHost==k$a&&k$m.textureHost.alphaTexture==k$a.alphaTexture;k$q=k$Ja.create(this,this._ib,k$p,k$r,k$Aa.create(1,0)),(this._submits[this._submits._length++]=k$q).shaderValue.textureHost=k$a,k$q._renderType=10016,k$q._preIsSameTextureShader=10016===this._curSubmit._renderType&&k$n.ALPHA===k$m.ALPHA&&k$s,this._curSubmit=k$q,k$j=this._curSubmit._vb||this._vb,k$n.ALPHA=k$o}return!!k$qa.fillRectImgVb(k$j,this._clipRect,k$b,k$c,k$d||k$a.width,k$e||k$a.height,k$a.uv,k$h||this._curMat,this._x,this._y,0,0)&&(k$Q.enabled&&!this._isMain&&this._curSubmit.addTexture(k$a,(k$j._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},k$b._repaintSprite=function(){this.sprite&&this.sprite.repaint()},k$b._drawText=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){var k$k=k$a.bitmap;this._drawCount++;var k$l=k$k.id+this._shader2D.ALPHA+10016;if(k$l!=this._renderKey){this._renderKey=k$l;var k$m=this._curSubmit.shaderValue,k$n=this._shader2D;k$n.glTexture=k$k;var k$o=this._vb,k$p=null,k$q=k$o._byteLength/32*3,k$r=k$m.textureHost&&k$m.textureHost==k$a&&k$m.textureHost.alphaTexture==k$a.alphaTexture;(k$p=k$Q.enabled?k$Ja.create(this,this._ib,k$o,k$q,k$Aa.create(1,0)):k$Ja.create(this,this._ib,k$o,k$q,k$$a.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&k$n.ALPHA===k$m.ALPHA&&k$r,(this._submits[this._submits._length++]=k$p).shaderValue.textureHost=k$a,k$p._renderType=10016,this._curSubmit=k$p}k$a.active();var k$s=this._curSubmit._vb||this._vb;k$qa.fillRectImgVb(k$s,this._clipRect,k$b+k$g,k$c+k$h,k$d||k$a.width,k$e||k$a.height,k$a.uv,k$f||this._curMat,this._x,this._y,k$i,k$j,!0)&&(k$Q.enabled&&!this._isMain&&this._curSubmit.addTexture(k$a,(k$s._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},k$b.drawTextureWithTransform=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){if(k$f){var k$j=this._curMat,k$k=this._x,k$l=this._y;(0!==k$g||0!==k$h)&&(this._x=k$g*k$j.a+k$h*k$j.c,this._y=k$h*k$j.d+k$g*k$j.b),k$f&&k$j.bTransform?(k$B.mul(k$f,k$j,k$P._tmpMatrix),(k$f=k$P._tmpMatrix)._checkTransform()):(this._x+=k$j.tx,this._y+=k$j.ty),this._drawTextureM(k$a,k$b,k$c,k$d,k$e,0,0,k$f,k$i),this._x=k$k,this._y=k$l}else this._drawTextureM(k$a,k$b,k$c,k$d,k$e,k$g,k$h,null,k$i)},k$b.fillQuadrangle=function(k$a,k$b,k$c,k$d,k$e){var k$f=this._curSubmit,k$g=this._vb,k$h=this._shader2D,k$i=k$f.shaderValue;if(this._renderKey=0,k$a.bitmap){var k$j=k$a.bitmap;k$h.glTexture==k$j&&k$h.ALPHA===k$i.ALPHA||(k$h.glTexture=k$j,(k$f=this._curSubmit=k$fa.createSubmit(this,this._ib,k$g,k$g._byteLength/32*3,k$Aa.create(1,0))).shaderValue.glTexture=k$j,this._submits[this._submits._length++]=k$f),k$qa.fillQuadrangleImgVb(k$g,k$b,k$c,k$d,k$a.uv,k$e||this._curMat,this._x,this._y)}else k$f.shaderValue.fillStyle&&k$f.shaderValue.fillStyle.equal(k$a)&&k$h.ALPHA===k$i.ALPHA||(k$h.glTexture=null,(k$f=this._curSubmit=k$fa.createSubmit(this,this._ib,k$g,k$g._byteLength/32*3,k$Aa.create(2,0))).shaderValue.defines.add(2),k$f.shaderValue.fillStyle=k$T.create(k$a),this._submits[this._submits._length++]=k$f),k$qa.fillQuadrangleImgVb(k$g,k$b,k$c,k$d,k$K.DEF_UV,k$e||this._curMat,this._x,this._y);k$f._numEle+=6},k$b.drawTexture2=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){if(0!=k$f){var k$i=this._curMat;if(this._x=k$a*k$i.a+k$b*k$i.c,this._y=k$b*k$i.d+k$a*k$i.b,k$e&&(k$e=k$i.bTransform||k$e.bTransform?(k$B.mul(k$e,k$i,k$P._tmpMatrix),k$P._tmpMatrix):(this._x+=k$e.tx+k$i.tx,this._y+=k$e.ty+k$i.ty,k$B.EMPTY)),1!==k$f||k$g){var k$j=this._shader2D.ALPHA,k$k=this._nBlendType;this._shader2D.ALPHA=k$f,k$g&&(this._nBlendType=k$S.TOINT(k$g)),this._drawTextureM(k$h[0],k$h[1]-k$c,k$h[2]-k$d,k$h[3],k$h[4],0,0,k$e,1),this._shader2D.ALPHA=k$j,this._nBlendType=k$k}else this._drawTextureM(k$h[0],k$h[1]-k$c,k$h[2]-k$d,k$h[3],k$h[4],0,0,k$e,1);this._x=this._y=0}},k$b.drawCanvas=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$a.context;if(this._renderKey=0,k$f._targets)this._submits[this._submits._length++]=k$Ia.create(k$f,0,null),this._curSubmit=k$fa.RENDERBASE,k$f._targets.drawTo(this,k$b,k$c,k$d,k$e);else{var k$g=this._submits[this._submits._length++]=k$Ia.create(k$f,this._shader2D.ALPHA,this._shader2D.filters),k$h=k$d/k$a.width,k$i=k$e/k$a.height,k$j=k$g._matrix;this._curMat.copyTo(k$j),1!=k$h&&1!=k$i&&k$j.scale(k$h,k$i);var k$k=k$j.tx,k$l=k$j.ty;k$j.tx=k$j.ty=0,k$j.transformPoint(k$C.TEMP.setTo(k$b,k$c)),k$j.translate(k$C.TEMP.x+k$k,k$C.TEMP.y+k$l),this._curSubmit=k$fa.RENDERBASE}k$z.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=k$f._targets?"yellow":"green",this.strokeRect(k$b-1,k$c-1,k$d+2,k$e+2,1),this.strokeRect(k$b,k$c,k$d,k$e,1),this.restore())},k$b.drawTarget=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){void 0===k$j&&(k$j=-1);var k$k=this._vb;if(k$qa.fillRectImgVb(k$k,this._clipRect,k$b,k$c,k$d,k$e,k$i||k$K.DEF_UV,k$f||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var k$l=this._curSubmit=k$la.create(this,this._ib,k$k,(k$k._byteLength-64)/32*3,k$h,k$g);k$l.blendType=-1==k$j?this._nBlendType:k$j,k$l.scope=k$a,this._submits[this._submits._length++]=k$l,this._curSubmit._numEle+=6}},k$b.mixRGBandAlpha=function(k$a){return this._mixRGBandAlpha(k$a,this._shader2D.ALPHA)},k$b._mixRGBandAlpha=function(k$a,k$b){var k$c=(4278190080&k$a)>>>24;return 0!=k$c?k$c*=k$b:k$c=255*k$b,16777215&k$a|k$c<<24},k$b.drawTriangles=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){if(!k$a.loaded||!k$a.source)return this.sprite&&k$y.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;k$a.bitmap;var k$k=this._mixRGBandAlpha(4294967295,k$h),k$l=(k$d.length,k$f.length);this._renderKey=-1;var k$m=this._curSubmit=k$Ja.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,k$Aa.create(1,0));return k$m.shaderValue.textureHost=k$a,k$m._renderType=10016,this._submits[this._submits._length++]=k$m,k$g?(k$P._tmpMatrix.a=k$g.a,k$P._tmpMatrix.b=k$g.b,k$P._tmpMatrix.c=k$g.c,k$P._tmpMatrix.d=k$g.d,k$P._tmpMatrix.tx=k$g.tx+k$b,k$P._tmpMatrix.ty=k$g.ty+k$c,k$B.mul(k$P._tmpMatrix,this._curMat,k$P._tmpMatrix)):(k$P._tmpMatrix.a=this._curMat.a,k$P._tmpMatrix.b=this._curMat.b,k$P._tmpMatrix.c=this._curMat.c,k$P._tmpMatrix.d=this._curMat.d,k$P._tmpMatrix.tx=this._curMat.tx+k$b,k$P._tmpMatrix.ty=this._curMat.ty+k$c),this._triangleMesh.addData(k$d,k$e,k$f,k$P._tmpMatrix,k$k,this),this._curSubmit._numEle+=k$l,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},k$b.transform=function(k$a,k$b,k$c,k$d,k$e,k$f){k$Z.save(this),k$B.mul(k$B.TEMP.setTo(k$a,k$b,k$c,k$d,k$e,k$f),this._curMat,this._curMat),this._curMat._checkTransform()},k$b.setTransformByMatrix=function(k$a){k$a.copyTo(this._curMat)},k$b.transformByMatrix=function(k$a){k$Z.save(this),k$B.mul(k$a,this._curMat,this._curMat),this._curMat._checkTransform()},k$b.rotate=function(k$a){k$Z.save(this),this._curMat.rotateEx(k$a)},k$b.scale=function(k$a,k$b){k$Z.save(this),this._curMat.scaleEx(k$a,k$b)},k$b.clipRect=function(k$a,k$b,k$c,k$d){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var k$e=k$ka.create(4);this.addRenderObject(k$e);var k$f=this._vb,k$g=k$f._byteLength>>2;if(k$qa.fillRectImgVb(k$f,null,k$a,k$b,k$c,k$d,k$K.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var k$h=this._curSubmit=k$fa.createSubmit(this,this._ib,k$f,(k$f._byteLength-64)/32*3,k$Aa.create(2,0));k$h.shaderValue.ALPHA=1,this._submits[this._submits._length++]=k$h,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var k$i=k$ka.create(5);this.addRenderObject(k$i);var k$j=k$f.getFloat32Array(),k$k=Math.min(Math.min(Math.min(k$j[0+k$g],k$j[4+k$g]),k$j[8+k$g]),k$j[12+k$g]),k$l=Math.max(Math.max(Math.max(k$j[0+k$g],k$j[4+k$g]),k$j[8+k$g]),k$j[12+k$g]),k$m=Math.min(Math.min(Math.min(k$j[1+k$g],k$j[5+k$g]),k$j[9+k$g]),k$j[13+k$g]),k$n=Math.max(Math.max(Math.max(k$j[1+k$g],k$j[5+k$g]),k$j[9+k$g]),k$j[13+k$g]);k$X.save(this,k$i,k$a,k$b,k$c,k$d,k$k,k$m,k$l-k$k,k$n-k$m),this._curSubmit=k$fa.RENDERBASE}else{k$c*=this._curMat.a,k$d*=this._curMat.d;var k$o=k$C.TEMP;this._curMat.transformPoint(k$o.setTo(k$a,k$b)),k$c<0&&(k$o.x=k$o.x+k$c,k$c=-k$c),k$d<0&&(k$o.y=k$o.y+k$d,k$d=-k$d),this._renderKey=0;var k$p=this._curSubmit=k$ja.create(this);(this._submits[this._submits._length++]=k$p).submitIndex=this._submits._length,k$p.submitLength=9999999,k$W.save(this,k$p);var k$q=this._clipRect,k$r=k$q.x,k$s=k$q.y,k$t=k$o.x+k$c,k$w=k$o.y+k$d;k$r<k$o.x&&(k$q.x=k$o.x),k$s<k$o.y&&(k$q.y=k$o.y),k$q.width=Math.min(k$t,k$r+k$q.width)-k$q.x,k$q.height=Math.min(k$w,k$s+k$q.height)-k$q.y,this._shader2D.glTexture=null,k$p.clipRect.copyFrom(k$q),this._curSubmit=k$fa.RENDERBASE}},k$b.setIBVB=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k){if(void 0===k$i&&(k$i=0),void 0===k$j&&(k$j=0),void 0===k$k&&(k$k=0),null===k$c){if(k$r.isFlash){var k$l=k$d;k$l._selfIB||(k$l._selfIB=k$ua.create(35044)),k$l._selfIB.clear(),k$c=k$l._selfIB}else k$c=this._ib;k$qa.expandIBQuadrangle(k$c,k$d._byteLength/(4*k$d.vertexStride*4))}if(!k$h||!k$g)throw Error("setIBVB must input:shader shaderValues");var k$m=k$ia.create(this,k$d,k$c,k$e,k$g,k$h,k$i,k$j,k$k);k$f||(k$f=k$B.EMPTY),k$f.translate(k$a,k$b),k$B.mul(k$f,this._curMat,k$m._mat),k$f.translate(-k$a,-k$b),this._submits[this._submits._length++]=k$m,this._curSubmit=k$fa.RENDERBASE,this._renderKey=0},k$b.addRenderObject=function(k$a){this._submits[this._submits._length++]=k$a},k$b.fillTrangles=function(k$a,k$b,k$c,k$d,k$e){var k$f=this._curSubmit,k$g=this._vb,k$h=this._shader2D,k$i=k$f.shaderValue,k$j=k$d.length>>4,k$k=k$a.bitmap;this._renderKey=0,k$h.glTexture==k$k&&k$h.ALPHA===k$i.ALPHA||((k$f=this._curSubmit=k$fa.createSubmit(this,this._ib,k$g,k$g._byteLength/32*3,k$Aa.create(1,0))).shaderValue.textureHost=k$a,this._submits[this._submits._length++]=k$f),k$qa.fillTranglesVB(k$g,k$b,k$c,k$d,k$e||this._curMat,this._x,this._y),k$f._numEle+=6*k$j},k$b.submitElement=function(k$a,k$b){var k$c=this._submits;for(k$b<0&&(k$b=k$c._length);k$a<k$b;)k$a+=k$c[k$a].renderSubmit()},k$b.finish=function(){k$wa.mainContext.finish()},k$b.flush=function(){var k$a=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(k$a>this._ib.bufferLength/12&&k$qa.expandIBQuadrangle(this._ib,k$a),!this._isMain&&k$Q.enabled&&k$Q._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=k$Q._atlasRestore;for(var k$b=this._submits,k$c=0,k$d=k$b._length;k$c<k$d;k$c++){var k$e=k$b[k$c];10016===k$e.getRenderType()&&k$e.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),k$ba.instance&&k$ba.getInstance().reset();var k$f;for(k$c=0,k$f=this.meshlist.length;k$c<k$f;k$c++){var k$g=this.meshlist[k$c];k$g.canReuse?k$g.releaseMesh():k$g.destroy()}return this.meshlist.length=0,this._curSubmit=k$fa.RENDERBASE,this._renderKey=0,this._triangleMesh=k$Ka.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},k$b.setPathId=function(k$a){if(this.mId=k$a,-1!=this.mId){this.mHaveKey=!1;var k$b=k$M.getInstance();k$b.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,k$b.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},k$b.movePath=function(k$a,k$b){var k$c=k$a,k$d=k$b;k$a=this._curMat.a*k$c+this._curMat.c*k$d+this._curMat.tx,k$b=this._curMat.b*k$c+this._curMat.d*k$d+this._curMat.ty,this.mX+=k$a,this.mY+=k$b},k$b.beginPath=function(){var k$a=this._getPath();k$a.tempArray.length=0,k$a.closePath=!1,this.mX=0,this.mY=0},k$b.closePath=function(){this._path.closePath=!0},k$b.fill=function(k$a){void 0===k$a&&(k$a=!1);var k$b=this._getPath();this.drawPoly(0,0,k$b.tempArray,this.fillStyle._color.numColor,0,0,k$a)},k$b.stroke=function(){var k$a=this._getPath();if(0<this.lineWidth){if(-1==this.mId)k$a.drawLine(0,0,k$a.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var k$b=k$M.getInstance().shapeLineDic[this.mId];k$b.rebuild(k$a.tempArray),k$a.setGeomtry(k$b)}else k$M.getInstance().addLine(this.mId,k$a.drawLine(0,0,k$a.tempArray,this.lineWidth,this.strokeStyle._color.numColor));k$a.update();var k$c=[this.mX,this.mY],k$d=k$fa.createShape(this,k$a.ib,k$a.vb,k$a.count,k$a.offset,k$Aa.create(4,0));k$d.shaderValue.ALPHA=this._shader2D.ALPHA,k$d.shaderValue.u_pos=k$c,k$d.shaderValue.u_mmat2=k$sa.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=k$d,this._renderKey=-1}},k$b.line=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=this._curSubmit,k$h=this._vb;if(k$qa.fillLineVb(k$h,this._clipRect,k$a,k$b,k$c,k$d,k$e,k$f)){this._renderKey=0;var k$i=this._shader2D,k$j=k$g.shaderValue;k$i.strokeStyle===k$j.strokeStyle&&k$i.ALPHA===k$j.ALPHA||(k$i.glTexture=null,(k$g=this._curSubmit=k$fa.createSubmit(this,this._ib,k$h,(k$h._byteLength-64)/32*3,k$Aa.create(2,0))).shaderValue.strokeStyle=k$i.strokeStyle,k$g.shaderValue.mainID=2,k$g.shaderValue.ALPHA=k$i.ALPHA,this._submits[this._submits._length++]=k$g),k$g._numEle+=6}},k$b.moveTo=function(k$a,k$b,k$c){void 0===k$c&&(k$c=!0);var k$d=this._getPath();if(k$c){var k$e=k$a,k$f=k$b;k$a=this._curMat.a*k$e+this._curMat.c*k$f,k$b=this._curMat.b*k$e+this._curMat.d*k$f}k$d.addPoint(k$a,k$b)},k$b.lineTo=function(k$a,k$b,k$c){void 0===k$c&&(k$c=!0);var k$d=this._getPath();if(k$c){var k$e=k$a,k$f=k$b;k$a=this._curMat.a*k$e+this._curMat.c*k$f,k$b=this._curMat.b*k$e+this._curMat.d*k$f}k$d.addPoint(k$a,k$b)},k$b.drawCurves=function(k$a,k$b,k$c){this.setPathId(-1),this.beginPath(),this.strokeStyle=k$c[3],this.lineWidth=k$c[4];var k$d=k$c[2];k$a+=k$c[0],k$b+=k$c[1],this.movePath(k$a,k$b),this.moveTo(k$d[0],k$d[1]);for(var k$e=2,k$f=k$d.length;k$e<k$f;)this.quadraticCurveTo(k$d[k$e++],k$d[k$e++],k$d[k$e++],k$d[k$e++]);this.stroke()},k$b.arcTo=function(k$a,k$b,k$c,k$d,k$e){if(-1==this.mId||!this.mHaveKey){var k$f=0,k$g=0,k$h=0,k$i=this._getPath();this._curMat.copyTo(k$P._tmpMatrix),k$P._tmpMatrix.tx=k$P._tmpMatrix.ty=0,k$P._tempPoint.setTo(k$i.getEndPointX(),k$i.getEndPointY()),k$P._tmpMatrix.invertTransformPoint(k$P._tempPoint);var k$j=k$P._tempPoint.x-k$a,k$k=k$P._tempPoint.y-k$b,k$l=Math.sqrt(k$j*k$j+k$k*k$k);if(!(k$l<=1e-6)){var k$m=k$j/k$l,k$n=k$k/k$l,k$o=k$c-k$a,k$p=k$d-k$b,k$q=k$o*k$o+k$p*k$p,k$r=Math.sqrt(k$q);if(!(k$r<=1e-6)){var k$s=k$o/k$r,k$t=k$p/k$r,k$w=k$m+k$s,k$x=k$n+k$t,k$y=Math.sqrt(k$w*k$w+k$x*k$x);if(!(k$y<=1e-6)){var k$z=k$w/k$y,k$A=k$x/k$y,k$B=Math.acos(k$z*k$m+k$A*k$n),k$C=Math.PI/2-k$B,k$D=(k$l=k$e/Math.tan(k$C))*k$m+k$a,k$E=k$l*k$n+k$b,k$F=Math.sqrt(k$l*k$l+k$e*k$e),k$G=k$a+k$z*k$F,k$H=k$b+k$A*k$F,k$I=0,k$J=0;if(0<=k$m*k$t-k$n*k$s){var k$K=2*k$C/k$P.SEGNUM;k$I=Math.sin(k$K),k$J=Math.cos(k$K)}else k$K=2*-k$C/k$P.SEGNUM,k$I=Math.sin(k$K),k$J=Math.cos(k$K);k$g=this._curMat.a*k$D+this._curMat.c*k$E,k$h=this._curMat.b*k$D+this._curMat.d*k$E,k$g==this._path.getEndPointX()&&k$h==this._path.getEndPointY()||k$i.addPoint(k$g,k$h);var k$L=k$D-k$G,k$M=k$E-k$H;for(k$f=0;k$f<k$P.SEGNUM;k$f++){var k$N=k$L*k$J+k$M*k$I,k$O=-k$L*k$I+k$M*k$J;k$g=k$N+k$G,k$h=k$O+k$H,k$a=this._curMat.a*k$g+this._curMat.c*k$h,k$h=k$b=this._curMat.b*k$g+this._curMat.d*k$h,(k$g=k$a)==this._path.getEndPointX()&&k$h==this._path.getEndPointY()||k$i.addPoint(k$g,k$h),k$L=k$N,k$M=k$O}}}}}},k$b.arc=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){if(void 0===k$f&&(k$f=!1),void 0===k$g&&(k$g=!0),-1!=this.mId){var k$h=k$M.getInstance().shapeDic[this.mId];if(k$h&&this.mHaveKey&&!k$h.needUpdate(this._curMat))return;k$b=k$a=0}var k$i,k$j=0,k$k=0,k$l=0,k$m=0,k$n=0,k$o=0,k$p=0;if(k$k=k$e-k$d,k$f)if(Math.abs(k$k)>=2*Math.PI)k$k=2*-Math.PI;else for(;0<k$k;)k$k-=2*Math.PI;else if(Math.abs(k$k)>=2*Math.PI)k$k=2*Math.PI;else for(;k$k<0;)k$k+=2*Math.PI;k$i=k$k/(k$p=k$c<101?Math.max(10,k$k*k$c/5):k$c<201?Math.max(10,k$k*k$c/20):Math.max(10,k$k*k$c/40))/2,k$l=Math.abs(4/3*(1-Math.cos(k$i))/Math.sin(k$i)),k$f&&(k$l=-k$l);var k$q=this._getPath(),k$r=NaN,k$s=NaN;for(k$o=0;k$o<=k$p;k$o++)k$j=k$d+k$k*(k$o/k$p),k$m=k$a+Math.cos(k$j)*k$c,k$n=k$b+Math.sin(k$j)*k$c,k$g&&(k$r=k$m,k$s=k$n,k$m=this._curMat.a*k$r+this._curMat.c*k$s,k$n=this._curMat.b*k$r+this._curMat.d*k$s),k$m==this._path.getEndPointX()&&k$n==this._path.getEndPointY()||k$q.addPoint(k$m,k$n);k$m=k$a+Math.cos(k$e)*k$c,k$n=k$b+Math.sin(k$e)*k$c,k$g&&(k$r=k$m,k$s=k$n,k$m=this._curMat.a*k$r+this._curMat.c*k$s,k$n=this._curMat.b*k$r+this._curMat.d*k$s),k$m==this._path.getEndPointX()&&k$n==this._path.getEndPointY()||k$q.addPoint(k$m,k$n)},k$b.quadraticCurveTo=function(k$a,k$b,k$c,k$d){var k$e=k$l.I,k$f=k$c,k$g=k$d;k$c=this._curMat.a*k$f+this._curMat.c*k$g,k$d=this._curMat.b*k$f+this._curMat.d*k$g,k$f=k$a,k$g=k$b,k$a=this._curMat.a*k$f+this._curMat.c*k$g,k$b=this._curMat.b*k$f+this._curMat.d*k$g;for(var k$h=k$e.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),k$a,k$b,k$c,k$d],30,2),k$i=0,k$j=k$h.length/2;k$i<k$j;k$i++)this.lineTo(k$h[2*k$i],k$h[2*k$i+1],!1);this.lineTo(k$c,k$d,!1)},k$b.rect=function(k$a,k$b,k$c,k$d){this._other=this._other.make(),this._other.path||(this._other.path=new k$U),this._other.path.rect(k$a,k$b,k$c,k$d)},k$b.strokeRect=function(k$a,k$b,k$c,k$d,k$e){var k$f=.5*k$e;this.line(k$a-k$f,k$b,k$a+k$c+k$f,k$b,k$e,this._curMat),this.line(k$a+k$c,k$b,k$a+k$c,k$b+k$d,k$e,this._curMat),this.line(k$a,k$b,k$a,k$b+k$d,k$e,this._curMat),this.line(k$a-k$f,k$b+k$d,k$a+k$c+k$f,k$b+k$d,k$e,this._curMat)},k$b.clip=function(){},k$b.drawPoly=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){void 0===k$g&&(k$g=!1),this._renderKey=0,this._shader2D.glTexture=null;var k$h=this._getPath();if(-1==this.mId)k$h.polygon(k$a,k$b,k$c,k$d,k$e||1,k$f);else if(this.mHaveKey){var k$i=k$M.getInstance().shapeDic[this.mId];k$i.setMatrix(this._curMat),k$i.rebuild(k$h.tempArray),k$h.setGeomtry(k$i)}else{var k$j=k$h.polygon(k$a,k$b,k$c,k$d,k$e||1,k$f);k$M.getInstance().addShape(this.mId,k$j),k$j.setMatrix(this._curMat)}k$h.update();var k$k,k$l=[this.mX,this.mY];if((k$k=k$fa.createShape(this,k$h.ib,k$h.vb,k$h.count,k$h.offset,k$Aa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,k$k.shaderValue.u_pos=k$l,k$k.shaderValue.u_mmat2=k$sa.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=k$k,0<k$e){if(this.mHaveLineKey){var k$m=k$M.getInstance().shapeLineDic[this.mId];k$m.rebuild(k$h.tempArray),k$h.setGeomtry(k$m)}else k$M.getInstance().addShape(this.mId,k$h.drawLine(k$a,k$b,k$c,k$e,k$f));k$h.update(),(k$k=k$fa.createShape(this,k$h.ib,k$h.vb,k$h.count,k$h.offset,k$Aa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,k$k.shaderValue.u_mmat2=k$sa.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=k$k}},k$b.drawParticle=function(k$a,k$b,k$c){k$c.x=k$a,k$c.y=k$b,this._submits[this._submits._length++]=k$c},k$b._getPath=function(){return this._path||(this._path=new k$U)},k$d(0,k$b,"globalCompositeOperation",function(){return k$S.NAMES[this._nBlendType]},function(k$a){var k$b=k$S.TOINT[k$a];null==k$b||this._nBlendType===k$b||(k$V.save(this,65536,this,!0),this._curSubmit=k$fa.RENDERBASE,this._renderKey=0,this._nBlendType=k$b)}),k$d(0,k$b,"strokeStyle",function(){return this._shader2D.strokeStyle},function(k$a){this._shader2D.strokeStyle.equal(k$a)||(k$V.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=k$T.create(k$a))}),k$d(0,k$b,"globalAlpha",function(){return this._shader2D.ALPHA},function(k$a){(k$a=Math.floor(1e3*k$a)/1e3)!=this._shader2D.ALPHA&&(k$V.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=k$a)}),k$d(0,k$b,"asBitmap",null,function(k$a){if(k$a){if(this._targets||(this._targets=new k$_),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),k$d(0,k$b,"fillStyle",function(){return this._shader2D.fillStyle},function(k$a){this._shader2D.fillStyle.equal(k$a)||(k$V.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=k$T.create(k$a))}),k$d(0,k$b,"textAlign",function(){return this._other.textAlign},function(k$a){this._other.textAlign===k$a||(this._other=this._other.make(),k$V.save(this,32768,this._other,!1),this._other.textAlign=k$a)}),k$d(0,k$b,"lineWidth",function(){return this._other.lineWidth},function(k$a){this._other.lineWidth===k$a||(this._other=this._other.make(),k$V.save(this,256,this._other,!1),this._other.lineWidth=k$a)}),k$d(0,k$b,"textBaseline",function(){return this._other.textBaseline},function(k$a){this._other.textBaseline===k$a||(this._other=this._other.make(),k$V.save(this,16384,this._other,!1),this._other.textBaseline=k$a)}),k$d(0,k$b,"font",null,function(k$a){k$a!=this._other.font.toString()&&(this._other=this._other.make(),k$V.save(this,8,this._other,!1),this._other.font===k$oa.EMPTY?this._other.font=new k$oa(k$a):this._other.font.setFont(k$a))}),k$P.__init__=function(){k$c.DEFAULT=new k$c},k$P._tempPoint=new k$C,k$P._SUBMITVBSIZE=32e3,k$P._MAXSIZE=99999999,k$P._RECTVBSIZE=16,k$P.MAXCLIPRECT=new k$D(0,0,99999999,99999999),k$P._COUNT=0,k$P._tmpMatrix=new k$B,k$P.SEGNUM=32,k$P._contextcount=0,k$g(k$P,["_fontTemp",function(){return this._fontTemp=new k$oa},"_drawStyleTemp",function(){return this._drawStyleTemp=new k$T(null)}]),k$P.__init$=function(){k$c=function(){function k$a(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=k$oa.EMPTY}k$m(k$a,"");var k$b=k$a.prototype;return k$b.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=k$oa.EMPTY},k$b.make=function(){return this===k$a.DEFAULT?new k$a:this},k$a.DEFAULT=null,k$a}()},k$P}(),k$Aa=function(k$a){function k$d(k$a,k$b){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,k$d.__super.call(this),this.defines=new k$Ea,this.position=k$d._POSITION,this.mainID=k$a,this.subID=k$b,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=k$a|k$b,this._inClassCache=k$d._cache[this._cacheID],0<k$a&&!this._inClassCache&&(this._inClassCache=k$d._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}k$m(k$d,"laya.webgl.shader.d2.value.Value2D",k$O);var k$b=k$d.prototype;return k$b.setValue=function(k$a){},k$b.refresh=function(){var k$a=this.size;return k$a[0]=k$sa.width,k$a[1]=k$sa.height,this.alpha=this.ALPHA*k$sa.worldAlpha,this.mmat=k$sa.worldMatrix4,this},k$b._ShaderWithCompile=function(){return k$Ya.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,k$_a.create)},k$b._withWorldShaderDefines=function(){var k$a=k$sa.worldShaderDefines,k$b=k$Ya.sharders[this.mainID|this.defines._value|k$a.getValue()];if(!k$b){var k$c,k$d={};for(k$c in this.defines.toNameDic())k$d[k$c]="";for(k$c in k$a.toNameDic())k$d[k$c]="";k$b=k$Ya.withCompile2D(0,this.mainID,k$d,this.mainID|this.defines._value|k$a.getValue(),k$_a.create)}var k$e=k$sa.worldFilters;if(!k$e)return k$b;for(var k$f,k$g=k$e.length,k$h=0;k$h<k$g;k$h++)(k$f=k$e[k$h])&&k$f.action.setValue(this);return k$b},k$b.upload=function(){var k$a=k$sa;this.alpha=this.ALPHA*k$a.worldAlpha,k$sa.worldMatrix4!==k$sa.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),k$wa.shaderHighPrecision&&this.defines.add(1024);var k$b,k$c=k$a.worldShaderDefines?this._withWorldShaderDefines():k$Ya.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=k$a.width,this.size[1]=k$a.height,this.mmat=k$a.worldMatrix4,k$La.activeShader!==k$c?k$c._shaderValueWidth!==k$a.width||k$c._shaderValueHeight!==k$a.height?(k$c._shaderValueWidth=k$a.width,k$c._shaderValueHeight=k$a.height):k$b=k$c._params2dQuick2||k$c._make2dQuick2():k$c._shaderValueWidth!==k$a.width||k$c._shaderValueHeight!==k$a.height?(k$c._shaderValueWidth=k$a.width,k$c._shaderValueHeight=k$a.height):k$b=k$c._params2dQuick1||k$c._make2dQuick1(),k$c.upload(this,k$b)},k$b.setFilters=function(k$a){if(this.filters=k$a)for(var k$b,k$c=k$a.length,k$d=0;k$d<k$c;k$d++)(k$b=k$a[k$d])&&(this.defines.add(k$b.type),k$b.action.setValue(this))},k$b.clear=function(){this.defines.setValue(this.subID)},k$b.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},k$d._initone=function(k$a,k$b){k$d._typeClass[k$a]=k$b,k$d._cache[k$a]=[],k$d._cache[k$a]._length=0},k$d.__init__=function(){k$d._POSITION=[2,5126,!1,4*k$pa.BYTES_PE,0],k$d._TEXCOORD=[2,5126,!1,4*k$pa.BYTES_PE,2*k$pa.BYTES_PE],k$d._initone(2,k$Pa),k$d._initone(4,k$Sa),k$d._initone(256,k$Qa),k$d._initone(512,k$Oa),k$d._initone(1,k$Ra),k$d._initone(65,k$$a),k$d._initone(9,k$Ra)},k$d.create=function(k$a,k$b){var k$c=k$d._cache[k$a|k$b];return k$c._length?k$c[--k$c._length]:new k$d._typeClass[k$a|k$b](k$b)},k$d._POSITION=null,k$d._TEXCOORD=null,k$d._cache=[],k$d._typeClass=[],k$d.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],k$d}(),k$Ba=function(k$a){function k$q(k$a,k$b){k$q.__super.call(this,k$a,k$b)}k$m(k$q,"laya.webgl.utils.RenderSprite3D",k$s);var k$b=k$q.prototype;return k$b.onCreate=function(k$a){switch(k$a){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},k$b._mask=function(k$a,k$b,k$c,k$d){var k$e,k$f,k$g=this._next,k$h=k$a.mask;if(k$h){k$b.ctx.save();var k$i=k$b.ctx.globalCompositeOperation,k$j=new k$D;if(k$j.copyFrom(k$h.getBounds()),k$j.width=Math.round(k$j.width),k$j.height=Math.round(k$j.height),k$j.x=Math.round(k$j.x),k$j.y=Math.round(k$j.y),0<k$j.width&&0<k$j.height){var k$k=k$a._style._tf,k$l=k$ha.create();k$l.addValue("bounds",k$j),k$e=k$ga.create([k$l,k$b],laya.webgl.utils.RenderSprite3D.tmpTarget),k$b.addRenderObject(k$e),k$h.render(k$b,-k$j.x,-k$j.y),k$e=k$ga.create([k$l],laya.webgl.utils.RenderSprite3D.endTmpTarget),k$b.addRenderObject(k$e),k$b.ctx.save(),k$b.clipRect(k$c-k$k.translateX+k$j.x,k$d-k$k.translateY+k$j.y,k$j.width,k$j.height),k$g._fun.call(k$g,k$a,k$b,k$c,k$d),k$b.ctx.restore(),k$f=k$ka.create(6),k$i=k$b.ctx.globalCompositeOperation,k$f.blendMode="mask",k$b.addRenderObject(k$f),k$B.TEMP.identity();var k$m=k$Aa.create(1,0),k$n=k$K.INV_UV,k$o=k$j.width,k$p=k$j.height;(k$j.width<32||k$j.height<32)&&((k$n=k$q.tempUV)[0]=0,k$n[1]=0,k$n[2]=32<=k$j.width?1:k$j.width/32,k$n[3]=0,k$n[4]=32<=k$j.width?1:k$j.width/32,k$n[5]=32<=k$j.height?1:k$j.height/32,k$n[6]=0,k$n[7]=32<=k$j.height?1:k$j.height/32,k$j.width=32<=k$j.width?k$j.width:32,k$j.height=32<=k$j.height?k$j.height:32,k$n[1]*=-1,k$n[3]*=-1,k$n[5]*=-1,k$n[7]*=-1,k$n[1]+=1,k$n[3]+=1,k$n[5]+=1,k$n[7]+=1),k$b.ctx.drawTarget(k$l,k$c+k$j.x-k$k.translateX,k$d+k$j.y-k$k.translateY,k$o,k$p,k$B.TEMP,"tmpTarget",k$m,k$n,6),k$e=k$ga.create([k$l],laya.webgl.utils.RenderSprite3D.recycleTarget),k$b.addRenderObject(k$e),(k$f=k$ka.create(6)).blendMode=k$i,k$b.addRenderObject(k$f)}k$b.ctx.restore()}else k$g._fun.call(k$g,k$a,k$b,k$c,k$d)},k$b._blend=function(k$a,k$b,k$c,k$d){var k$e=k$a._style,k$f=this._next;k$e.blendMode?(k$b.ctx.save(),k$b.ctx.globalCompositeOperation=k$e.blendMode,k$f._fun.call(k$f,k$a,k$b,k$c,k$d),k$b.ctx.restore()):k$f._fun.call(k$f,k$a,k$b,k$c,k$d)},k$b._transform=function(k$a,k$b,k$c,k$d){var k$e=k$a.transform,k$f=this._next;if(k$e&&k$f!=k$s.NORENDER){var k$g=k$b.ctx;k$a._style;k$e.tx=k$c,k$e.ty=k$d;var k$h=k$g._getTransformMatrix(),k$i=k$h.clone();k$B.mul(k$e,k$h,k$h),k$h._checkTransform(),k$e.tx=k$e.ty=0,k$f._fun.call(k$f,k$a,k$b,0,0),k$i.copyTo(k$h),k$i.destroy()}else k$f._fun.call(k$f,k$a,k$b,k$c,k$d)},k$q.tmpTarget=function(k$a,k$b){var k$c=k$a.getValue("bounds"),k$d=k$Ma.create(k$c.width,k$c.height);k$d.start(),k$d.clear(0,0,0,0),k$a.addValue("tmpTarget",k$d)},k$q.endTmpTarget=function(k$a){k$a.getValue("tmpTarget").end()},k$q.recycleTarget=function(k$a){k$a.getValue("tmpTarget").recycle(),k$a.recycle()},k$g(k$q,["tempUV",function(){return this.tempUV=new Array(8)}]),k$q}(),k$Ca=function(k$a){function k$b(){this.data=null,k$b.__super.call(this)}k$m(k$b,"laya.filters.webgl.ColorFilterActionGL",k$N);var k$c=k$b.prototype;return k$y.imps(k$c,{"laya.filters.IFilterActionGL":!0}),k$c.setValue=function(k$a){k$a.colorMat=this.data._mat,k$a.colorAlpha=this.data._alpha},k$c.apply3d=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$a.getValue("bounds"),k$g=k$Aa.create(1,0);k$g.setFilters([this.data]);var k$h=k$B.TEMP;k$h.identity(),k$c.ctx.drawTarget(k$a,0,0,k$f.width,k$f.height,k$h,"src",k$g)},k$b}(),k$Da=function(k$a){function k$f(k$a,k$b,k$c,k$d,k$e){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,k$f.__super.call(this,k$a,k$b,k$e),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new k$Ta,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=k$c,this._atlasCanvas.height=k$d,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}k$m(k$f,"laya.webgl.atlas.Atlaser",k$P);var k$b=k$f.prototype;return k$b.computeUVinAtlasTexture=function(k$a,k$b,k$c,k$d){var k$e=k$Q.atlasTextureWidth,k$f=k$Q.atlasTextureHeight,k$g=k$c/k$e,k$h=k$d/k$f,k$i=(k$c+k$a.bitmap.width)/k$e,k$j=(k$d+k$a.bitmap.height)/k$f,k$k=k$a.bitmap.width/k$e,k$l=k$a.bitmap.height/k$f;k$a.uv=[k$g+k$b[0]*k$k,k$h+k$b[1]*k$l,k$i-(1-k$b[2])*k$k,k$h+k$b[3]*k$l,k$i-(1-k$b[4])*k$k,k$j-(1-k$b[5])*k$l,k$g+k$b[6]*k$k,k$j-(1-k$b[7])*k$l]},k$b.findBitmapIsExist=function(k$a){if(k$a instanceof laya.webgl.resource.WebGLImage){var k$b=k$a,k$c=k$b.url,k$d=this._InAtlasWebGLImagesKey[k$c||k$b.id];if(k$d)return k$d.offsetInfoID}return-1},k$b.addToAtlasTexture=function(k$a,k$b,k$c){if(k$a instanceof laya.webgl.resource.WebGLImage){var k$d=k$a,k$e=k$d.url;this._InAtlasWebGLImagesKey[k$e||k$d.id]={bitmap:k$a,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([k$b,k$c])}this._atlasCanvas.texSubImage2D(k$b,k$c,k$a.atlasSource),k$a.clearAtlasSource()},k$b.addToAtlas=function(k$a,k$b,k$c){k$a._atlasID=this._inAtlasTextureKey.length;var k$d=k$a.uv.slice(),k$e=k$a.bitmap;this._inAtlasTextureKey.push(k$a),this._inAtlasTextureOriUVValue.push(k$d),this._inAtlasTextureBitmapValue.push(k$e),this.computeUVinAtlasTexture(k$a,k$d,k$b,k$c),k$a.bitmap=this._atlasCanvas},k$b.clear=function(){for(var k$a=0,k$b=this._inAtlasTextureKey.length;k$a<k$b;k$a++)this._inAtlasTextureKey[k$a].bitmap=this._inAtlasTextureBitmapValue[k$a],this._inAtlasTextureKey[k$a].uv=this._inAtlasTextureOriUVValue[k$a],this._inAtlasTextureKey[k$a]._atlasID=-1,this._inAtlasTextureKey[k$a].bitmap.lock=!1,this._inAtlasTextureKey[k$a].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},k$b.dispose=function(){this.clear(),this._atlasCanvas.destroy()},k$d(0,k$b,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),k$d(0,k$b,"texture",function(){return this._atlasCanvas}),k$d(0,k$b,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),k$f}(),k$Ea=function(k$a){function k$c(){k$c.__super.call(this,k$c.__name2int,k$c.__int2name,k$c.__int2nameMap)}return k$m(k$c,"laya.webgl.shader.d2.ShaderDefines2D",k$v),k$c.__init__=function(){k$c.reg("TEXTURE2D",1),k$c.reg("COLOR2D",2),k$c.reg("PRIMITIVE",4),k$c.reg("GLOW_FILTER",8),k$c.reg("BLUR_FILTER",16),k$c.reg("COLOR_FILTER",32),k$c.reg("COLOR_ADD",64),k$c.reg("WORLDMAT",128),k$c.reg("FILLTEXTURE",256),k$c.reg("FSHIGHPRECISION",1024),k$c.reg("TXTALPHA",2048),k$c.reg("TXTCOMPRESS",4096)},k$c.reg=function(k$a,k$b){k$v._reg(k$a,k$b,k$c.__name2int,k$c.__int2name)},k$c.toText=function(k$a,k$b,k$c){return k$v._toText(k$a,k$b,k$c)},k$c.toInt=function(k$a){return k$v._toInt(k$a,k$c.__name2int)},k$c.TEXTURE2D=1,k$c.COLOR2D=2,k$c.PRIMITIVE=4,k$c.FILTERGLOW=8,k$c.FILTERBLUR=16,k$c.FILTERCOLOR=32,k$c.COLORADD=64,k$c.WORLDMAT=128,k$c.FILLTEXTURE=256,k$c.SKINMESH=512,k$c.SHADERDEFINE_FSHIGHPRECISION=1024,k$c.TXTALPHA=2048,k$c.TXTCOMPRESS=4096,k$c.__name2int={},k$c.__int2name=[],k$c.__int2nameMap=[],k$c}(),k$Fa=(function(k$a){function k$h(k$a,k$b,k$c,k$d,k$e,k$f,k$g){k$h.__super.call(this,k$a,k$b,k$c,k$d,40,k$e,k$f,k$g)}k$m(k$h,"laya.webgl.shapes.Ellipse",k$ca)}(),function(k$a){function k$f(k$a,k$b,k$c,k$d,k$e){this._points=[],this.rebuild(k$c),k$f.__super.call(this,k$a,k$b,0,0,0,k$e,k$d,k$e,0)}k$m(k$f,"laya.webgl.shapes.Line",k$ca);var k$b=k$f.prototype;return k$b.rebuild=function(k$a){var k$b=k$a.length;k$b!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(k$b/2-1)),this.mFloat32Array=new Float32Array(5*k$b)),this._points.length=0;for(var k$c=NaN,k$d=NaN,k$e=-1,k$f=-1,k$g=k$a.length/2,k$h=0;k$h<k$g;k$h++)k$c=k$a[2*k$h],k$d=k$a[2*k$h+1],(.01<Math.abs(k$e-k$c)||.01<Math.abs(k$f-k$d))&&this._points.push(k$c,k$d),k$e=k$c,k$f=k$d},k$b.getData=function(k$a,k$b,k$c){var k$d=[],k$e=[];0<this.borderWidth&&this.createLine2(this._points,k$d,this.borderWidth,k$c,k$e,this._points.length/2),this.mUint16Array.set(k$d,0),this.mFloat32Array.set(k$e,0),k$a.append(this.mUint16Array),k$b.append(this.mFloat32Array)},k$f}()),k$Ga=function(k$a){function k$l(k$a,k$b,k$c,k$d,k$e){this._points=[];for(var k$f=NaN,k$g=NaN,k$h=-1,k$i=-1,k$j=k$c.length/2-1,k$k=0;k$k<k$j;k$k++)k$f=k$c[2*k$k],k$g=k$c[2*k$k+1],(.01<Math.abs(k$h-k$f)||.01<Math.abs(k$i-k$g))&&this._points.push(k$f,k$g),k$h=k$f,k$i=k$g;k$f=k$c[2*k$j],k$g=k$c[2*k$j+1],k$h=this._points[0],k$i=this._points[1],(.01<Math.abs(k$h-k$f)||.01<Math.abs(k$i-k$g))&&this._points.push(k$f,k$g),k$l.__super.call(this,k$a,k$b,0,0,this._points.length/2,0,k$d,k$e)}k$m(k$l,"laya.webgl.shapes.LoopLine",k$ca);var k$b=k$l.prototype;return k$b.getData=function(k$a,k$b,k$c){if(0<this.borderWidth){for(var k$d=this.color,k$e=(k$d>>16&255)/255,k$f=(k$d>>8&255)/255,k$g=(255&k$d)/255,k$h=[],k$i=0,k$j=0,k$k=[],k$l=Math.floor(this._points.length/2),k$m=0;k$m<k$l;k$m++)k$i=this._points[2*k$m],k$j=this._points[2*k$m+1],k$h.push(this.x+k$i,this.y+k$j,k$e,k$f,k$g);this.createLoopLine(k$h,k$k,this.borderWidth,k$c+k$h.length/5),k$a.append(new Uint16Array(k$k)),k$b.append(new Float32Array(k$h))}},k$b.createLoopLine=function(k$a,k$b,k$c,k$d,k$e,k$f){k$a.length;var k$g=k$a.concat(),k$h=k$e||k$a,k$i=this.borderColor,k$j=(k$i>>16&255)/255,k$k=(k$i>>8&255)/255,k$l=(255&k$i)/255,k$m=[k$g[0],k$g[1]],k$n=[k$g[k$g.length-5],k$g[k$g.length-4]],k$o=k$n[0]+.5*(k$m[0]-k$n[0]),k$p=k$n[1]+.5*(k$m[1]-k$n[1]);k$g.unshift(k$o,k$p,0,0,0),k$g.push(k$o,k$p,0,0,0);var k$q,k$r,k$s,k$t,k$w,k$x,k$y,k$z,k$A,k$B,k$C,k$D,k$E,k$F,k$G,k$H,k$I,k$J,k$K,k$L,k$M=k$g.length/5,k$N=k$d,k$O=k$c/2;k$s=k$g[0],k$t=k$g[1],k$B=k$s-(k$w=k$g[5]),k$A=(k$A=-(k$t-(k$x=k$g[6])))/(k$L=Math.sqrt(k$A*k$A+k$B*k$B))*k$O,k$B=k$B/k$L*k$O,k$h.push(k$s-k$A,k$t-k$B,k$j,k$k,k$l,k$s+k$A,k$t+k$B,k$j,k$k,k$l);for(var k$P=1;k$P<k$M-1;k$P++)k$s=k$g[5*(k$P-1)],k$t=k$g[5*(k$P-1)+1],k$w=k$g[5*k$P],k$x=k$g[5*k$P+1],k$y=k$g[5*(k$P+1)],k$z=k$g[5*(k$P+1)+1],k$B=k$s-k$w,k$D=k$w-k$y,k$G=(-(k$A=(k$A=-(k$t-k$x))/(k$L=Math.sqrt(k$A*k$A+k$B*k$B))*k$O)+k$s)*(-(k$B=k$B/k$L*k$O)+k$x)-(-k$A+k$w)*(-k$B+k$t),k$J=(-(k$C=(k$C=-(k$x-k$z))/(k$L=Math.sqrt(k$C*k$C+k$D*k$D))*k$O)+k$y)*(-(k$D=k$D/k$L*k$O)+k$x)-(-k$C+k$w)*(-k$D+k$z),k$K=(k$E=-k$B+k$t-(-k$B+k$x))*(k$I=-k$C+k$w-(-k$C+k$y))-(k$H=-k$D+k$z-(-k$D+k$x))*(k$F=-k$A+k$w-(-k$A+k$s)),Math.abs(k$K)<.1?(k$K+=10.1,k$h.push(k$w-k$A,k$x-k$B,k$j,k$k,k$l,k$w+k$A,k$x+k$B,k$j,k$k,k$l)):(((k$q=(k$F*k$J-k$I*k$G)/k$K)-k$w)*(k$q-k$w)+((k$r=(k$H*k$G-k$E*k$J)/k$K)-k$x)+(k$r-k$x),k$h.push(k$q,k$r,k$j,k$k,k$l,k$w-(k$q-k$w),k$x-(k$r-k$x),k$j,k$k,k$l));k$f&&(k$b=k$f);var k$Q=this.edges+1;for(k$P=1;k$P<k$Q;k$P++)k$b.push(k$N+2*(k$P-1),k$N+2*(k$P-1)+1,k$N+2*k$P+1,k$N+2*k$P+1,k$N+2*k$P,k$N+2*(k$P-1));return k$b.push(k$N+2*(k$P-1),k$N+2*(k$P-1)+1,k$N+1,k$N+1,k$N,k$N+2*(k$P-1)),k$h},k$l}(),k$Ha=function(k$a){function k$g(k$a,k$b,k$c,k$d,k$e,k$f){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=k$B.create(),this._points=k$c.slice(0,k$c.length),k$g.__super.call(this,k$a,k$b,0,0,this._points.length/2,k$d,k$e,k$f)}k$m(k$g,"laya.webgl.shapes.Polygon",k$ca);var k$b=k$g.prototype;return k$b.rebuild=function(k$a){this._repaint||(this._points.length=0,this._points=this._points.concat(k$a))},k$b.setMatrix=function(k$a){k$a.copyTo(this._mat)},k$b.needUpdate=function(k$a){return this._repaint=this._mat.a==k$a.a&&this._mat.b==k$a.b&&this._mat.c==k$a.c&&this._mat.d==k$a.d&&this._mat.tx==k$a.tx&&this._mat.ty==k$a.ty,!this._repaint},k$b.getData=function(k$a,k$b,k$c){var k$d,k$e=0,k$f=this._points,k$g=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=k$c){for(this._start=k$c,k$d=[],k$g=this.earcutTriangles.length,k$e=0;k$e<k$g;k$e++)k$d.push(this.earcutTriangles[k$e]+k$c);this.mUint16Array=new Uint16Array(k$d)}}else{this._start=k$c,k$d=[];var k$h=[],k$i=[],k$j=this.color,k$k=(k$j>>16&255)/255,k$l=(k$j>>8&255)/255,k$m=(255&k$j)/255;for(k$g=Math.floor(k$f.length/2),k$e=0;k$e<k$g;k$e++)k$h.push(this.x+k$f[2*k$e],this.y+k$f[2*k$e+1],k$k,k$l,k$m),k$i.push(this.x+k$f[2*k$e],this.y+k$f[2*k$e+1]);for(this.earcutTriangles=k$da.earcut(k$i,null,2),k$g=this.earcutTriangles.length,k$e=0;k$e<k$g;k$e++)k$d.push(this.earcutTriangles[k$e]+k$c);this.mUint16Array=new Uint16Array(k$d),this.mFloat32Array=new Float32Array(k$h)}k$a.append(this.mUint16Array),k$b.append(this.mFloat32Array)},k$g}(),k$Ia=function(k$a){function k$f(){this._matrix=new k$B,this._matrix4=k$pa.defaultMatrix4.concat(),k$f.__super.call(this,1e4),this.shaderValue=new k$Aa(0,0)}k$m(k$f,"laya.webgl.submit.SubmitCanvas",k$fa);var k$b=k$f.prototype;return k$b.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var k$a=k$sa.worldAlpha,k$b=k$sa.worldMatrix4,k$c=k$sa.worldMatrix,k$d=k$sa.worldFilters,k$e=k$sa.worldShaderDefines,k$f=this.shaderValue,k$g=this._matrix,k$h=this._matrix4,k$i=k$B.TEMP;return k$B.mul(k$g,k$c,k$i),k$h[0]=k$i.a,k$h[1]=k$i.b,k$h[4]=k$i.c,k$h[5]=k$i.d,k$h[12]=k$i.tx,k$h[13]=k$i.ty,k$sa.worldMatrix=k$i.clone(),k$sa.worldMatrix4=k$h,k$sa.worldAlpha=k$sa.worldAlpha*k$f.alpha,k$f.filters&&k$f.filters.length&&(k$sa.worldFilters=k$f.filters,k$sa.worldShaderDefines=k$f.defines),this._ctx_src.flush(),k$sa.worldAlpha=k$a,k$sa.worldMatrix4=k$b,k$sa.worldMatrix.destroy(),k$sa.worldMatrix=k$c,k$sa.worldFilters=k$d,k$sa.worldShaderDefines=k$e,1},k$b.releaseRender=function(){var k$a=k$f._cache;this._ctx_src=null,k$a[k$a._length++]=this},k$b.getRenderType=function(){return 10003},k$f.create=function(k$a,k$b,k$c){var k$d=k$f._cache._length?k$f._cache[--k$f._cache._length]:new k$f;k$d._ctx_src=k$a;var k$e=k$d.shaderValue;return k$e.alpha=k$b,k$e.defines.setValue(0),k$c&&k$c.length&&k$e.setFilters(k$c),k$d},k$f._cache=((k$f._cache=[])._length=0,k$f._cache),k$f}(),k$Ja=function(k$a){function k$j(k$a){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===k$a&&(k$a=1e4),k$j.__super.call(this,k$a)}k$m(k$j,"laya.webgl.submit.SubmitTexture",k$fa);var k$b=k$j.prototype;return k$b.releaseRender=function(){var k$a=k$j._cache;(k$a[k$a._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},k$b.addTexture=function(k$a,k$b){this._texsID[this._texs.length]=k$a._uvID,this._texs.push(k$a),this._vbPos.push(k$b)},k$b.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var k$a=this.shaderValue.textureHost.bitmap;if(null!==k$a)for(var k$b=this._vb.getFloat32Array(),k$c=0,k$d=this._texs.length;k$c<k$d;k$c++){var k$e=this._texs[k$c];k$e.active();var k$f=k$e.uv;if(this._texsID[k$c]!==k$e._uvID){this._texsID[k$c]=k$e._uvID;var k$g=this._vbPos[k$c];k$b[k$g+2]=k$f[0],k$b[k$g+3]=k$f[1],k$b[k$g+6]=k$f[2],k$b[k$g+7]=k$f[3],k$b[k$g+10]=k$f[4],k$b[k$g+11]=k$f[5],k$b[k$g+14]=k$f[6],k$b[k$g+15]=k$f[7],this._vb.setNeedUpload()}k$e.bitmap!==k$a&&(this._isSameTexture=!1)}}},k$b.renderSubmit=function(){if(0===this._numEle)return k$j._shaderSet=!1,1;var k$a=this.shaderValue.textureHost;if(k$a){var k$b=k$a.source;if(!k$a.bitmap||!k$b)return k$j._shaderSet=!1,1;this.shaderValue.texture=k$b,k$a.alphaTexture&&k$a.alphaTexture.source&&(this.shaderValue.texture1=k$a.alphaTexture.source)}this._vb.bind_upload(this._ib);var k$c=k$wa.mainContext;if(k$S.activeBlendFunction!==this._blendFn&&(k$c.enable(3042),this._blendFn(k$c),k$S.activeBlendFunction=this._blendFn),k$G.drawCall++,k$G.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&k$La.activeShader&&k$j._shaderSet?(k$La.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&k$La.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),k$j._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var k$d=k$a.bitmap,k$e=0,k$f=k$La.activeShader,k$g=0,k$h=this._texs.length;k$g<k$h;k$g++){var k$i=this._texs[k$g];k$i.bitmap===k$d&&k$g+1!==k$h||(k$f.uploadTexture2D(k$i.source),k$c.drawElements(4,6*(k$g-k$e+1),5123,this._startIdx+6*k$e*k$pa.BYTES_PIDX),k$d=k$i.bitmap,k$e=k$g)}else k$c.drawElements(4,this._numEle,5123,this._startIdx);return 1},k$j.create=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$j._cache._length?k$j._cache[--k$j._cache._length]:new k$j;null==k$c&&((k$c=k$f._selfVb||(k$f._selfVb=k$va.create(-1))).clear(),k$d=0),k$f._ib=k$b,k$f._vb=k$c,k$f._startIdx=k$d*k$pa.BYTES_PIDX,k$f._numEle=0;var k$g=k$a._nBlendType;k$f._blendFn=k$a._targets?k$S.targetFns[k$g]:k$S.fns[k$g],k$f.shaderValue=k$e,k$f.shaderValue.setValue(k$a._shader2D);var k$h=k$a._shader2D.filters;return k$h&&k$f.shaderValue.setFilters(k$h),k$f},k$j._cache=((k$j._cache=[])._length=0,k$j._cache),k$j._shaderSet=!0,k$j}(),k$Ka=function(k$a){function k$r(){k$r.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}k$m(k$r,"laya.webgl.utils.MeshTexture",k$ra);var k$b=k$r.prototype;return k$b.addData=function(k$a,k$b,k$c,k$d,k$e,k$f){for(var k$g=k$a.length/2,k$h=this._vb.needSize(k$g*k$r.const_stride)>>2,k$i=this._vb.getFloat32Array(),k$j=0,k$k=0;k$k<k$g;k$k++){var k$l=k$a[k$j],k$m=k$a[k$j+1],k$n=k$l*k$d.a+k$m*k$d.c+k$d.tx,k$o=k$l*k$d.b+k$m*k$d.d+k$d.ty;k$i[k$h++]=k$n,k$i[k$h++]=k$o,k$i[k$h++]=k$b[k$j],k$i[k$h++]=k$b[k$j+1],k$j+=2}this._vb.setNeedUpload();var k$p=this.vertNum;if(0<k$p){(k$g=k$c.length)>k$r.tmpIdx.length&&(k$r.tmpIdx=new Uint16Array(k$g));for(var k$q=0;k$q<k$g;k$q++)k$r.tmpIdx[k$q]=k$c[k$q]+k$p;this._ib.appendU16Array(k$r.tmpIdx,k$c.length)}else this._ib.append(k$c);this._ib.setNeedUpload(),this.vertNum+=k$g,this.indexNum+=k$c.length},k$b.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},k$b.destroy=function(){this._ib.destroy(),this._vb.destroy()},k$r.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new k$r},k$r.const_stride=16,k$r._POOL=[],k$g(k$r,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),k$r}(),k$La=function(k$a){function k$b(){k$b.__super.call(this),this.lock=!0}return k$m(k$b,"laya.webgl.shader.BaseShader",k$t),k$b.activeShader=null,k$b.bindShader=null,k$b}(),k$Ma=function(k$b){function k$k(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===k$c&&(k$c=6408),void 0===k$d&&(k$d=5121),void 0===k$e&&(k$e=34041),void 0===k$f&&(k$f=!1),void 0===k$g&&(k$g=!1),void 0===k$h&&(k$h=-1),void 0===k$i&&(k$i=-1),this._type=1,this._w=k$a,this._h=k$b,this._surfaceFormat=k$c,this._surfaceType=k$d,this._depthStencilFormat=k$e,k$r.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=k$f,this._repeat=k$g,this._minFifter=k$h,this._magFifter=k$i,this._createWebGLRenderTarget(),this.bitmap.lock=!0,k$k.__super.call(this,this.bitmap,k$K.INV_UV)}k$m(k$k,"laya.webgl.resource.RenderTarget2D",k$b);var k$a=k$k.prototype;return k$y.imps(k$a,{"laya.resource.IDispose":!0}),k$a.getType=function(){return this._type},k$a.getTexture=function(){return this},k$a.size=function(k$a,k$b){this._w==k$a&&this._h==k$b||(this._w=k$a,this._h=k$b,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},k$a.release=function(){this.destroy()},k$a.recycle=function(){k$k.POOL.push(this)},k$a.start=function(){var k$a=k$wa.mainContext;return this._preRenderTarget=k$sa.curRenderTarget,k$sa.curRenderTarget=this,k$a.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(k$a.viewport(0,0,this._w,this._h),this._svWidth=k$sa.width,this._svHeight=k$sa.height,k$sa.width=this._w,k$sa.height=this._h,k$La.activeShader=null),this},k$a.clear=function(k$a,k$b,k$c,k$d){void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=1);var k$e=k$wa.mainContext;k$e.clearColor(k$a,k$b,k$c,k$d);var k$f=16384;switch(this._depthStencilFormat){case 33189:k$f|=256;break;case 36168:k$f|=1024;break;case 34041:k$f|=256,k$f|=1024}k$e.clear(k$f)},k$a.end=function(){var k$a=k$wa.mainContext;k$a.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,k$sa.curRenderTarget=this._preRenderTarget,1==this._type?(k$a.viewport(0,0,this._svWidth,this._svHeight),k$sa.width=this._svWidth,k$sa.height=this._svHeight,k$La.activeShader=null):k$a.viewport(0,0,k$y.stage.width,k$y.stage.height)},k$a.getData=function(k$a,k$b,k$c,k$d){var k$e=k$wa.mainContext;if(k$e.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===k$e.checkFramebufferStatus(36160)))return k$e.bindFramebuffer(36160,null),null;var k$f=new Uint8Array(this._w*this._h*4);return k$e.readPixels(k$a,k$b,k$c,k$d,this._surfaceFormat,this._surfaceType,k$f),k$e.bindFramebuffer(36160,null),k$f},k$a.destroy=function(k$a){void 0===k$a&&(k$a=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,k$b.prototype.destroy.call(this))},k$a.dispose=function(){},k$a._createWebGLRenderTarget=function(){this.bitmap=new k$Wa(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(k$a){this.event("recovered")})},k$d(0,k$a,"surfaceFormat",function(){return this._surfaceFormat}),k$d(0,k$a,"magFifter",function(){return this._magFifter}),k$d(0,k$a,"surfaceType",function(){return this._surfaceType}),k$d(0,k$a,"mipMap",function(){return this._mipMap}),k$d(0,k$a,"depthStencilFormat",function(){return this._depthStencilFormat}),k$d(0,k$a,"minFifter",function(){return this._minFifter}),k$d(0,k$a,"source",function(){return this._alreadyResolved?k$y.superGet(k$K,this,"source"):null}),k$k.create=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){void 0===k$c&&(k$c=6408),void 0===k$d&&(k$d=5121),void 0===k$e&&(k$e=34041),void 0===k$f&&(k$f=!1),void 0===k$g&&(k$g=!1),void 0===k$h&&(k$h=-1),void 0===k$i&&(k$i=-1);var k$j=k$k.POOL.pop();return k$j||(k$j=new k$k(k$a,k$b)),k$j.bitmap&&k$j._w==k$a&&k$j._h==k$b&&k$j._surfaceFormat==k$c&&k$j._surfaceType==k$d&&k$j._depthStencilFormat==k$e&&k$j._mipMap==k$f&&k$j._repeat==k$g&&k$j._minFifter==k$h&&k$j._magFifter==k$i||(k$j._w=k$a,k$j._h=k$b,k$j._surfaceFormat=k$c,k$j._surfaceType=k$d,k$j._depthStencilFormat=k$e,k$r.isConchWebGL&&34041===k$j._depthStencilFormat&&(k$j._depthStencilFormat=33189),k$j._mipMap=k$f,k$j._repeat=k$g,k$j._minFifter=k$h,k$j._magFifter=k$i,k$j.release(),k$j._createWebGLRenderTarget()),k$j},k$k.TYPE2D=1,k$k.TYPE3D=2,k$k.POOL=[],k$k}(k$K),k$Na=function(k$a){function k$b(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,k$b.__super.call(this),k$b._gl=k$wa.mainContext}k$m(k$b,"laya.webgl.utils.Buffer",k$t);var k$c=k$b.prototype;return k$c._bind=function(){this.activeResource(),k$b._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(k$b._bindVertexBuffer=this._glBuffer),k$b._gl.bindBuffer(this._bufferType,k$b._bindActive[this._bufferType]=this._glBuffer),k$La.activeShader=null)},k$c.recreateResource=function(){this._glBuffer||(this._glBuffer=k$b._gl.createBuffer()),this.completeCreate()},k$c.disposeResource=function(){this._glBuffer&&(k$wa.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},k$d(0,k$c,"bufferUsage",function(){return this._bufferUsage}),k$b._gl=null,k$b._bindActive={},k$b._bindVertexBuffer=null,k$b._enableAtributes=[],k$b}(),k$Oa=function(k$a){function k$c(k$a){this.texcoord=null,this.offsetX=300,this.offsetY=0,k$c.__super.call(this,512,0);var k$b=8*k$pa.BYTES_PE;this.position=[2,5126,!1,k$b,0],this.texcoord=[2,5126,!1,k$b,2*k$pa.BYTES_PE],this.color=[4,5126,!1,k$b,4*k$pa.BYTES_PE]}return k$m(k$c,"laya.webgl.shader.d2.skinAnishader.SkinSV",k$Aa),k$c}(),k$Pa=function(k$a){function k$b(k$a){k$b.__super.call(this,2,0),this.color=[]}return k$m(k$b,"laya.webgl.shader.d2.value.Color2dSV",k$Aa),k$b.prototype.setValue=function(k$a){k$a.fillStyle&&(this.color=k$a.fillStyle._color._color),k$a.strokeStyle&&(this.color=k$a.strokeStyle._color._color)},k$b}(),k$Qa=function(k$a){function k$b(k$a){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=k$Aa._TEXCOORD,k$b.__super.call(this,256,0)}k$m(k$b,"laya.webgl.shader.d2.value.FillTextureSV",k$Aa);var k$c=k$b.prototype;return k$c.setValue=function(k$a){this.ALPHA=k$a.ALPHA,k$a.filters&&this.setFilters(k$a.filters)},k$c.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},k$b}(),k$Ra=function(k$a){function k$b(k$a){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=k$Aa._TEXCOORD,void 0===k$a&&(k$a=0),k$b.__super.call(this,1,k$a)}k$m(k$b,"laya.webgl.shader.d2.value.TextureSV",k$Aa);var k$c=k$b.prototype;return k$c.setValue=function(k$a){this.ALPHA=k$a.ALPHA,k$a.filters&&this.setFilters(k$a.filters)},k$c.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},k$b}(),k$Sa=function(k$a){function k$b(k$a){this.a_color=null,this.u_pos=[0,0],k$b.__super.call(this,4,0),this.position=[2,5126,!1,5*k$pa.BYTES_PE,0],this.a_color=[3,5126,!1,5*k$pa.BYTES_PE,2*k$pa.BYTES_PE]}return k$m(k$b,"laya.webgl.shader.d2.value.PrimitiveSV",k$Aa),k$b}(),k$Ta=function(k$a){function k$b(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,k$b.__super.call(this)}k$m(k$b,"laya.webgl.atlas.AtlasWebGLCanvas",k$a);var k$c=k$b.prototype;return k$c.recreateResource=function(){var k$a=k$wa.mainContext,k$b=this._source=k$a.createTexture(),k$c=k$xa.curBindTexTarget,k$d=k$xa.curBindTexValue;k$xa.bindTexture(k$a,3553,k$b),k$a.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),k$a.texParameteri(3553,10241,9729),k$a.texParameteri(3553,10240,9729),k$a.texParameteri(3553,10242,33071),k$a.texParameteri(3553,10243,33071),k$c&&k$d&&k$xa.bindTexture(k$a,k$c,k$d),this.memorySize=this._w*this._h*4,this.completeCreate()},k$c.disposeResource=function(){this._source&&(k$wa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},k$c.texSubImage2D=function(k$a,k$b,k$c){if(k$r.isFlash){this._flashCacheImage||(this._flashCacheImage=k$p.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var k$d=k$c.bitmapdata;this._flashCacheImage._image.copyPixels(k$d,0,0,k$d.width,k$d.height,k$a,k$b),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var k$e=k$wa.mainContext,k$f=k$xa.curBindTexTarget,k$g=k$xa.curBindTexValue;k$xa.bindTexture(k$e,3553,this._source),k$e.pixelStorei(37441,!0),0<=k$a-1&&k$e.texSubImage2D(3553,0,k$a-1,k$b,6408,5121,k$c),k$a+1<=this._w&&k$e.texSubImage2D(3553,0,k$a+1,k$b,6408,5121,k$c),0<=k$b-1&&k$e.texSubImage2D(3553,0,k$a,k$b-1,6408,5121,k$c),k$b+1<=this._h&&k$e.texSubImage2D(3553,0,k$a,k$b+1,6408,5121,k$c),k$e.texSubImage2D(3553,0,k$a,k$b,6408,5121,k$c),k$e.pixelStorei(37441,!1),k$f&&k$g&&k$xa.bindTexture(k$e,k$f,k$g)}},k$c.texSubImage2DPixel=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$wa.mainContext,k$g=k$xa.curBindTexTarget,k$h=k$xa.curBindTexValue;k$xa.bindTexture(k$f,3553,this._source);var k$i=new Uint8Array(k$e.data);k$f.pixelStorei(37441,!0),k$f.texSubImage2D(3553,0,k$a,k$b,k$c,k$d,6408,5121,k$i),k$f.pixelStorei(37441,!1),k$g&&k$h&&k$xa.bindTexture(k$f,k$g,k$h)},k$d(0,k$c,"width",k$a.prototype._$get_width,function(k$a){this._w=k$a}),k$d(0,k$c,"height",k$a.prototype._$get_height,function(k$a){this._h=k$a}),k$b}(k$c),k$Ua=function(k$a){function k$e(){this.flipY=!0,this.alwaysChange=!1,k$e.__super.call(this)}k$m(k$e,"laya.webgl.resource.WebGLCanvas",k$c);var k$b=k$e.prototype;return k$b.getCanvas=function(){return this._canvas},k$b.clear=function(){this._ctx&&this._ctx.clear()},k$b.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},k$b._setContext=function(k$a){this._ctx=k$a},k$b.getContext=function(k$a,k$b){return this._ctx?this._ctx:this._ctx=k$e._createContext(this)},k$b.size=function(k$a,k$b){this._w==k$a&&this._h==k$b||(this._w=k$a,this._h=k$b,this._ctx&&this._ctx.size(k$a,k$b),this._canvas&&(this._canvas.height=k$b,this._canvas.width=k$a))},k$b.activeResource=function(k$a){void 0===k$a&&(k$a=!1),this._source||this.recreateResource()},k$b.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},k$b.disposeResource=function(){this._source&&!this.iscpuSource&&(k$wa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},k$b.createWebGlTexture=function(){var k$a=k$wa.mainContext;this._canvas;var k$b=this._source=k$a.createTexture();this.iscpuSource=!1;var k$c=k$xa.curBindTexTarget,k$d=k$xa.curBindTexValue;k$xa.bindTexture(k$a,3553,k$b),k$a.pixelStorei(37440,this.flipY?1:0),k$e.premulAlpha&&k$a.pixelStorei(37441,!0),k$a.texImage2D(3553,0,6408,6408,5121,this._imgData),k$e.premulAlpha&&k$a.pixelStorei(37441,!1),k$a.texParameteri(3553,10240,9729),k$a.texParameteri(3553,10241,9729),k$a.texParameteri(3553,10242,33071),k$a.texParameteri(3553,10243,33071),k$a.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,k$c&&k$d&&k$xa.bindTexture(k$a,k$c,k$d)},k$b.reloadCanvasData=function(){var k$a=k$wa.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var k$b=k$xa.curBindTexTarget,k$c=k$xa.curBindTexValue;k$xa.bindTexture(k$a,3553,this._source),k$e.premulAlpha&&k$a.pixelStorei(37441,!0),k$a.texImage2D(3553,0,6408,6408,5121,this._imgData),k$e.premulAlpha&&k$a.pixelStorei(37441,!1),k$a.pixelStorei(37440,0),k$b&&k$c&&k$xa.bindTexture(k$a,k$b,k$c)},k$b.texSubImage2D=function(k$a,k$b,k$c){var k$d=k$wa.mainContext,k$e=k$xa.curBindTexTarget,k$f=k$xa.curBindTexValue;k$xa.bindTexture(k$d,3553,this._source),k$d.pixelStorei(37441,!0),k$d.texSubImage2D(3553,0,k$b,k$c,6408,5121,k$a._source),k$d.pixelStorei(37441,!1),k$e&&k$f&&k$xa.bindTexture(k$d,k$e,k$f)},k$b.toBase64=function(k$a,k$b,k$c){var k$d=null;this._canvas&&(k$d=this._canvas.toDataURL(k$a,k$b)),k$c.call(this,k$d)},k$d(0,k$b,"context",function(){return this._ctx}),k$d(0,k$b,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),k$d(0,k$b,"asBitmap",null,function(k$a){this._ctx&&(this._ctx.asBitmap=k$a)}),k$e._createContext=null,k$e.premulAlpha=!1,k$e}(),k$Va=function(k$a){function k$f(k$a,k$b){this.CborderSize=12,k$f.__super.call(this),this.char=k$a,this.isSpace=" "===k$a,this.xs=k$b.scaleX,this.ys=k$b.scaleY,this.font=k$b.font.toString(),this.fontSize=k$b.font.size,this.fillColor=k$b.fillColor,this.borderColor=k$b.borderColor,this.lineWidth=k$b.lineWidth,this.underLine=k$b.underLine;var k$c,k$d=k$r.isConchApp;k$d?((k$c=ConchTextCanvas)._source=ConchTextCanvas,k$c._source.canvas=ConchTextCanvas):k$c=k$n.canvas.source,this.canvas=k$c,this._enableMerageInAtlas=!0,this._ctx=k$d?k$c:this.canvas.getContext("2d",void 0);var k$e=k$L.measureText(this.char,this.font);this.cw=k$e.width*this.xs,this.ch=(k$e.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new k$K(this)}k$m(k$f,"laya.webgl.resource.WebGLCharImage",k$c);var k$b=k$f.prototype;return k$y.imps(k$b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),k$b.active=function(){this.texture.active()},k$b.recreateResource=function(){var k$a=k$r.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),k$a){var k$b=this.fontSize;1==this.xs&&1==this.ys||(k$b=parseInt(k$b*(this.xs>this.ys?this.xs:this.ys)+""));var k$c="normal 100 "+this.font;k$c=k$c.replace(k$f._fontSizeReg,k$b),this.borderColor&&(k$c+=" 1 "+this.borderColor),this._ctx.font=k$c,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,k$J.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var k$d=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(k$d,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},k$b.onresize=function(k$a,k$b){this._w=k$a,this._h=k$b,this._allowMerageInAtlas=!0},k$b.clearAtlasSource=function(){},k$d(0,k$b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),k$d(0,k$b,"atlasSource",function(){return this.canvas}),k$d(0,k$b,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(k$a){this._enableMerageInAtlas=k$a}),k$f.createOneChar=function(k$a,k$b){return new k$f(k$a,k$b)},k$f._fontSizeReg=new RegExp("\\d+(?=px)","g"),k$f}(),k$Wa=function(k$a){function k$j(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){void 0===k$c&&(k$c=6408),void 0===k$d&&(k$d=5121),void 0===k$e&&(k$e=34041),void 0===k$f&&(k$f=!1),void 0===k$g&&(k$g=!1),void 0===k$h&&(k$h=-1),void 0===k$i&&(k$i=1),k$j.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=k$a,this._h=k$b,this._surfaceFormat=k$c,this._surfaceType=k$d,this._depthStencilFormat=k$e,this._mipMap=k$f,this._repeat=k$g,this._minFifter=k$h,this._magFifter=k$i}k$m(k$j,"laya.webgl.resource.WebGLRenderTarget",k$c);var k$b=k$j.prototype;return k$b.recreateResource=function(){var k$a=k$wa.mainContext;this._frameBuffer||(this._frameBuffer=k$a.createFramebuffer()),this._source||(this._source=k$a.createTexture());var k$b=k$xa.curBindTexTarget,k$c=k$xa.curBindTexValue;k$xa.bindTexture(k$a,3553,this._source),k$a.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var k$d=this._minFifter,k$e=this._magFifter,k$f=this._repeat?10497:33071,k$g=k$k.isPOT(this._w,this._h);if(k$g?(this._mipMap?-1!==k$d||(k$d=9987):-1!==k$d||(k$d=9729),-1!==k$e||(k$e=9729),k$a.texParameteri(3553,10241,k$d),k$a.texParameteri(3553,10240,k$e),k$a.texParameteri(3553,10242,k$f),k$a.texParameteri(3553,10243,k$f),this._mipMap&&k$a.generateMipmap(3553)):(-1!==k$d||(k$d=9729),-1!==k$e||(k$e=9729),k$a.texParameteri(3553,10241,k$d),k$a.texParameteri(3553,10240,k$e),k$a.texParameteri(3553,10242,33071),k$a.texParameteri(3553,10243,33071)),k$a.bindFramebuffer(36160,this._frameBuffer),k$a.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=k$a.createRenderbuffer()),k$a.bindRenderbuffer(36161,this._depthStencilBuffer),k$a.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:k$a.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:k$a.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:k$a.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}k$a.bindFramebuffer(36160,null),k$b&&k$c&&k$xa.bindTexture(k$a,k$b,k$c),k$a.bindRenderbuffer(36161,null),k$g&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},k$b.disposeResource=function(){this._frameBuffer&&(k$wa.mainContext.deleteTexture(this._source),k$wa.mainContext.deleteFramebuffer(this._frameBuffer),k$wa.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},k$d(0,k$b,"depthStencilBuffer",function(){return this._depthStencilBuffer}),k$d(0,k$b,"frameBuffer",function(){return this._frameBuffer}),k$j}(),k$Xa=function(k$a){function k$h(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this.offsetX=0,this.offsetY=0,k$h.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=k$f,this.canvas=k$a,this._ctx=k$a.getContext("2d",void 0),this._w=k$d,this._h=k$e,this.offsetX=k$b,this.offsetY=k$c,this.src=k$g,this._enableMerageInAtlas=!0,k$Q.enabled&&this._w<k$Q.atlasLimitWidth&&this._h<k$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}k$m(k$h,"laya.webgl.resource.WebGLSubImage",k$c);var k$b=k$h.prototype;return k$y.imps(k$b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),k$b.size=function(k$a,k$b){this._w=k$a,this._h=k$b,this._ctx&&this._ctx.size(k$a,k$b),this.canvas&&(this.canvas.height=k$b,this.canvas.width=k$a)},k$b.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},k$b.createWebGlTexture=function(){var k$a=k$wa.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var k$b=this._source=k$a.createTexture(),k$c=k$xa.curBindTexTarget,k$d=k$xa.curBindTexValue;k$xa.bindTexture(k$a,3553,k$b),k$a.pixelStorei(37441,!0),k$a.texImage2D(3553,0,6408,6408,5121,this.canvas),k$a.pixelStorei(37441,!1);var k$e=this.minFifter,k$f=this.magFifter,k$g=this.repeat?10497:33071,k$h=k$k.isPOT(this.width,this.height);k$h?(this.mipmap?-1!==k$e||(k$e=9987):-1!==k$e||(k$e=9729),-1!==k$f||(k$f=9729),k$a.texParameteri(3553,10240,k$f),k$a.texParameteri(3553,10241,k$e),k$a.texParameteri(3553,10242,k$g),k$a.texParameteri(3553,10243,k$g),this.mipmap&&k$a.generateMipmap(3553)):(-1!==k$e||(k$e=9729),-1!==k$f||(k$f=9729),k$a.texParameteri(3553,10241,k$e),k$a.texParameteri(3553,10240,k$f),k$a.texParameteri(3553,10242,33071),k$a.texParameteri(3553,10243,33071)),k$c&&k$d&&k$xa.bindTexture(k$a,k$c,k$d),this.canvas=null,k$h&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},k$b.disposeResource=function(){k$Q.enabled&&this._allowMerageInAtlas||!this._source||(k$wa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},k$b.clearAtlasSource=function(){},k$d(0,k$b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),k$d(0,k$b,"atlasSource",function(){return this.canvas}),k$d(0,k$b,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(k$a){this._allowMerageInAtlas=k$a}),k$h}(),k$Ya=function(k$a){function k$j(k$a,k$b,k$c,k$d){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,k$j.__super.call(this),!k$a||!k$b)throw"Shader Error";this._id=++k$j._count,this._vs=k$a,this._ps=k$b,this._nameMap=k$d||{},null!=k$c&&(k$j.sharders[k$c]=this)}k$m(k$j,"laya.webgl.shader.Shader",k$La);var k$b=k$j.prototype;return k$b.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},k$b.disposeResource=function(){k$wa.mainContext.deleteShader(this._vshader),k$wa.mainContext.deleteShader(this._pshader),k$wa.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},k$b._compile=function(){if(!k$wa.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var k$a=[this._vs,this._ps],k$b=k$wa.mainContext;if(this._program=k$b.createProgram(),this._vshader=k$j._createShader(k$b,k$a[0],35633),this._pshader=k$j._createShader(k$b,k$a[1],35632),k$b.attachShader(this._program,this._vshader),k$b.attachShader(this._program,this._pshader),k$b.linkProgram(this._program),!k$r.isConchApp&&!k$b.getProgramParameter(this._program,35714))throw k$b.getProgramInfoLog(this._program);var k$c,k$d,k$e=0,k$f=0;for(k$f=k$r.isConchApp?k$b.getProgramParameterEx(this._vs,this._ps,"",35721):k$b.getProgramParameter(this._program,35721),k$e=0;k$e<k$f;k$e++){var k$g=null;k$c={vartype:"attribute",glfun:null,ivartype:0,attrib:k$g=k$r.isConchApp?k$b.getActiveAttribEx(this._vs,this._ps,"",k$e):k$b.getActiveAttrib(this._program,k$e),location:k$b.getAttribLocation(this._program,k$g.name),name:k$g.name,type:k$g.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(k$c)}var k$h=0;for(k$h=k$r.isConchApp?k$b.getProgramParameterEx(this._vs,this._ps,"",35718):k$b.getProgramParameter(this._program,35718),k$e=0;k$e<k$h;k$e++){var k$i=null;k$i=k$r.isConchApp?k$b.getActiveUniformEx(this._vs,this._ps,"",k$e):k$b.getActiveUniform(this._program,k$e),0<(k$c={vartype:"uniform",glfun:null,ivartype:1,attrib:k$g,location:k$b.getUniformLocation(this._program,k$i.name),name:k$i.name,type:k$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(k$c.name=k$c.name.substr(0,k$c.name.length-3),k$c.isArray=!0,k$c.location=k$b.getUniformLocation(this._program,k$c.name)),this._params.push(k$c)}for(k$e=0,k$d=this._params.length;k$e<k$d;k$e++)if((k$c=this._params[k$e]).indexOfParams=k$e,k$c.index=1,k$c.value=[k$c.location,null],k$c.codename=k$c.name,k$c.name=this._nameMap[k$c.codename]?this._nameMap[k$c.codename]:k$c.codename,(this._paramsMap[k$c.name]=k$c)._this=this,k$c.uploadedValue=[],"attribute"!==k$c.vartype)switch(k$c.type){case 5124:k$c.fun=k$c.isArray?this._uniform1iv:this._uniform1i;break;case 5126:k$c.fun=k$c.isArray?this._uniform1fv:this._uniform1f;break;case 35664:k$c.fun=k$c.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:k$c.fun=k$c.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:k$c.fun=k$c.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:k$c.fun=this._uniform_sampler2D;break;case 35680:k$c.fun=this._uniform_samplerCube;break;case 35676:k$c.glfun=k$b.uniformMatrix4fv,k$c.fun=this._uniformMatrix4fv;break;case 35670:k$c.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else k$c.fun=this._attribute}},k$b.getUniform=function(k$a){return this._paramsMap[k$a]},k$b._attribute=function(k$a,k$b){var k$c=k$wa.mainContext,k$d=k$Na._enableAtributes,k$e=k$a.location;return k$d[k$e]||k$c.enableVertexAttribArray(k$e),k$c.vertexAttribPointer(k$e,k$b[0],k$b[1],k$b[2],k$b[3],k$b[4]+this._offset),k$d[k$e]=k$Na._bindVertexBuffer,1},k$b._uniform1f=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b?(k$wa.mainContext.uniform1f(k$a.location,k$c[0]=k$b),1):0},k$b._uniform1fv=function(k$a,k$b){if(k$b.length<4){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]||k$c[2]!==k$b[2]||k$c[3]!==k$b[3]?(k$wa.mainContext.uniform1fv(k$a.location,k$b),k$c[0]=k$b[0],k$c[1]=k$b[1],k$c[2]=k$b[2],k$c[3]=k$b[3],1):0}return k$wa.mainContext.uniform1fv(k$a.location,k$b),1},k$b._uniform_vec2=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]?(k$wa.mainContext.uniform2f(k$a.location,k$c[0]=k$b[0],k$c[1]=k$b[1]),1):0},k$b._uniform_vec2v=function(k$a,k$b){if(k$b.length<2){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]||k$c[2]!==k$b[2]||k$c[3]!==k$b[3]?(k$wa.mainContext.uniform2fv(k$a.location,k$b),k$c[0]=k$b[0],k$c[1]=k$b[1],k$c[2]=k$b[2],k$c[3]=k$b[3],1):0}return k$wa.mainContext.uniform2fv(k$a.location,k$b),1},k$b._uniform_vec3=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]||k$c[2]!==k$b[2]?(k$wa.mainContext.uniform3f(k$a.location,k$c[0]=k$b[0],k$c[1]=k$b[1],k$c[2]=k$b[2]),1):0},k$b._uniform_vec3v=function(k$a,k$b){return k$wa.mainContext.uniform3fv(k$a.location,k$b),1},k$b._uniform_vec4=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]||k$c[2]!==k$b[2]||k$c[3]!==k$b[3]?(k$wa.mainContext.uniform4f(k$a.location,k$c[0]=k$b[0],k$c[1]=k$b[1],k$c[2]=k$b[2],k$c[3]=k$b[3]),1):0},k$b._uniform_vec4v=function(k$a,k$b){return k$wa.mainContext.uniform4fv(k$a.location,k$b),1},k$b._uniformMatrix2fv=function(k$a,k$b){return k$wa.mainContext.uniformMatrix2fv(k$a.location,!1,k$b),1},k$b._uniformMatrix3fv=function(k$a,k$b){return k$wa.mainContext.uniformMatrix3fv(k$a.location,!1,k$b),1},k$b._uniformMatrix4fv=function(k$a,k$b){return k$wa.mainContext.uniformMatrix4fv(k$a.location,!1,k$b),1},k$b._uniform1i=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b?(k$wa.mainContext.uniform1i(k$a.location,k$c[0]=k$b),1):0},k$b._uniform1iv=function(k$a,k$b){return k$wa.mainContext.uniform1iv(k$a.location,k$b),1},k$b._uniform_ivec2=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]?(k$wa.mainContext.uniform2i(k$a.location,k$c[0]=k$b[0],k$c[1]=k$b[1]),1):0},k$b._uniform_ivec2v=function(k$a,k$b){return k$wa.mainContext.uniform2iv(k$a.location,k$b),1},k$b._uniform_vec3i=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]||k$c[2]!==k$b[2]?(k$wa.mainContext.uniform3i(k$a.location,k$c[0]=k$b[0],k$c[1]=k$b[1],k$c[2]=k$b[2]),1):0},k$b._uniform_vec3vi=function(k$a,k$b){return k$wa.mainContext.uniform3iv(k$a.location,k$b),1},k$b._uniform_vec4i=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]||k$c[2]!==k$b[2]||k$c[3]!==k$b[3]?(k$wa.mainContext.uniform4i(k$a.location,k$c[0]=k$b[0],k$c[1]=k$b[1],k$c[2]=k$b[2],k$c[3]=k$b[3]),1):0},k$b._uniform_vec4vi=function(k$a,k$b){return k$wa.mainContext.uniform4iv(k$a.location,k$b),1},k$b._uniform_sampler2D=function(k$a,k$b){var k$c=k$wa.mainContext,k$d=k$a.uploadedValue;return null==k$d[0]?(k$d[0]=this._curActTexIndex,k$c.uniform1i(k$a.location,this._curActTexIndex),k$c.activeTexture(k$j._TEXTURES[this._curActTexIndex]),k$xa.bindTexture(k$c,3553,k$b),this._curActTexIndex++,1):(k$c.activeTexture(k$j._TEXTURES[k$d[0]]),k$xa.bindTexture(k$c,3553,k$b),0)},k$b._uniform_samplerCube=function(k$a,k$b){var k$c=k$wa.mainContext,k$d=k$a.uploadedValue;return null==k$d[0]?(k$d[0]=this._curActTexIndex,k$c.uniform1i(k$a.location,this._curActTexIndex),k$c.activeTexture(k$j._TEXTURES[this._curActTexIndex]),k$xa.bindTexture(k$c,34067,k$b),this._curActTexIndex++,1):(k$c.activeTexture(k$j._TEXTURES[k$d[0]]),k$xa.bindTexture(k$c,34067,k$b),0)},k$b._noSetValue=function(k$a){console.log("no....:"+k$a.name)},k$b.uploadOne=function(k$a,k$b){this.activeResource(),k$xa.UseProgram(this._program);var k$c=this._paramsMap[k$a];k$c.fun.call(this,k$c,k$b)},k$b.uploadTexture2D=function(k$a){k$G.shaderCall++;var k$b=k$wa.mainContext;k$b.activeTexture(33984),k$xa.bindTexture(k$b,3553,k$a)},k$b.uploadTexture2D1=function(k$a){k$G.shaderCall++;var k$b=k$wa.mainContext;k$b.activeTexture(33985),k$xa.bindTexture(k$b,3553,k$a)},k$b.upload=function(k$a,k$b){k$La.activeShader=k$La.bindShader=this,this._lastUseFrameCount===k$G.loopCount||this.activeResource(),k$xa.UseProgram(this._program),this._reCompile?(k$b=this._params,this._reCompile=!1):k$b=k$b||this._params;k$wa.mainContext;for(var k$c,k$d,k$e=k$b.length,k$f=0,k$g=0;k$g<k$e;k$g++)null!==(k$d=k$a[(k$c=k$b[k$g]).name])&&(k$f+=k$c.fun.call(this,k$c,k$d));k$G.shaderCall+=k$f},k$b.uploadArray=function(k$a,k$b,k$c){k$La.activeShader=this,(k$La.bindShader=this).activeResource(),k$xa.UseProgram(this._program);this._params;for(var k$d,k$e,k$f=0,k$g=k$b-2;0<=k$g;k$g-=2)(k$e=this._paramsMap[k$a[k$g]])&&null!=(k$d=k$a[k$g+1])&&(k$c&&k$c[k$e.name]&&k$c[k$e.name].bind(),k$f+=k$e.fun.call(this,k$e,k$d));k$G.shaderCall+=k$f},k$b.getParams=function(){return this._params},k$j.getShader=function(k$a){return k$j.sharders[k$a]},k$j.create=function(k$a,k$b,k$c,k$d){return new k$j(k$a,k$b,k$c,k$d)},k$j.withCompile=function(k$a,k$b,k$c,k$d){if(k$c&&k$j.sharders[k$c])return k$j.sharders[k$c];var k$e=k$j._preCompileShader[2e-4*k$a];if(!k$e)throw new Error("withCompile shader err!"+k$a);return k$e.createShader(k$b,k$c,k$d)},k$j.withCompile2D=function(k$a,k$b,k$c,k$d,k$e){if(k$d&&k$j.sharders[k$d])return k$j.sharders[k$d];var k$f=k$j._preCompileShader[2e-4*k$a+k$b];if(!k$f)throw new Error("withCompile shader err!"+k$a+" "+k$b);return k$f.createShader(k$c,k$d,k$e)},k$j.addInclude=function(k$a,k$b){k$ta.addInclude(k$a,k$b)},k$j.preCompile=function(k$a,k$b,k$c,k$d){var k$e=2e-4*k$a;k$j._preCompileShader[k$e]=new k$ta(k$e,k$b,k$c,k$d)},k$j.preCompile2D=function(k$a,k$b,k$c,k$d,k$e){var k$f=2e-4*k$a+k$b;k$j._preCompileShader[k$f]=new k$ta(k$f,k$c,k$d,k$e)},k$j._createShader=function(k$a,k$b,k$c){var k$d=k$a.createShader(k$c);return k$a.shaderSource(k$d,k$b),k$a.compileShader(k$d),k$d},k$j._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],k$j._count=0,k$j._preCompileShader={},k$j.SHADERNAME2ID=2e-4,k$j.sharders=((k$j.sharders=[]).length=32,k$j.sharders),k$g(k$j,["nameKey",function(){return this.nameKey=new k$H}]),k$j}(),k$Za=function(k$a){function k$b(){this._maxsize=0,this._upload=!0,this._uploadSize=0,k$b.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}k$m(k$b,"laya.webgl.utils.Buffer2D",k$a);var k$c=k$b.prototype;return k$c.needSize=function(k$a){var k$b=this._byteLength;if(k$a){var k$c=this._byteLength+k$a;k$c<=this._buffer.byteLength||this._resizeBuffer(k$c<<1,!0),this._byteLength=k$c}return k$b},k$c._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),k$G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,k$Na._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),k$Na._gl.bufferSubData(this._bufferType,0,this._buffer)},k$c._bufferSubData=function(k$a,k$b,k$c){if(void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),this._maxsize=Math.max(this._maxsize,this._byteLength),k$G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,k$Na._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),k$b||k$c){var k$d=this._buffer.slice(k$b,k$c);k$Na._gl.bufferSubData(this._bufferType,k$a,k$d)}else k$Na._gl.bufferSubData(this._bufferType,k$a,this._buffer)},k$c._checkArrayUse=function(){},k$c._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},k$c._bind_subUpload=function(k$a,k$b,k$c){return void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(k$a,k$b,k$c),!0)},k$c._resizeBuffer=function(k$a,k$b){if(k$a<this._buffer.byteLength)return this;if(this.memorySize=k$a,k$b&&this._buffer&&0<this._buffer.byteLength){var k$c=new ArrayBuffer(k$a);new Uint8Array(k$c).set(new Uint8Array(this._buffer),0),this._buffer=k$c}else this._buffer=new ArrayBuffer(k$a);return this._checkArrayUse(),this._upload=!0,this},k$c.append=function(k$a){this._upload=!0;var k$b,k$c;k$b=k$a.byteLength,k$a instanceof Uint8Array?(this._resizeBuffer(this._byteLength+k$b,!0),k$c=new Uint8Array(this._buffer,this._byteLength)):k$a instanceof Uint16Array?(this._resizeBuffer(this._byteLength+k$b,!0),k$c=new Uint16Array(this._buffer,this._byteLength)):k$a instanceof Float32Array&&(this._resizeBuffer(this._byteLength+k$b,!0),k$c=new Float32Array(this._buffer,this._byteLength)),k$c.set(k$a,0),this._byteLength+=k$b,this._checkArrayUse()},k$c.appendU16Array=function(k$a,k$b){this._resizeBuffer(this._byteLength+2*k$b,!0);for(var k$c=new Uint16Array(this._buffer,this._byteLength,k$b),k$d=0;k$d<k$b;k$d++)k$c[k$d]=k$a[k$d];this._byteLength+=2*k$b,this._checkArrayUse()},k$c.appendEx=function(k$a,k$b){this._upload=!0;var k$c;k$c=k$a.byteLength,this._resizeBuffer(this._byteLength+k$c,!0),new k$b(this._buffer,this._byteLength).set(k$a,0),this._byteLength+=k$c,this._checkArrayUse()},k$c.appendEx2=function(k$a,k$b,k$c,k$d){void 0===k$d&&(k$d=1),this._upload=!0;var k$e,k$f;k$e=k$c*k$d,this._resizeBuffer(this._byteLength+k$e,!0),k$f=new k$b(this._buffer,this._byteLength);var k$g=0;for(k$g=0;k$g<k$c;k$g++)k$f[k$g]=k$a[k$g];this._byteLength+=k$e,this._checkArrayUse()},k$c.getBuffer=function(){return this._buffer},k$c.setNeedUpload=function(){this._upload=!0},k$c.getNeedUpload=function(){return this._upload},k$c.upload=function(){var k$a=this._bind_upload();return k$Na._gl.bindBuffer(this._bufferType,null),k$Na._bindActive[this._bufferType]=null,k$La.activeShader=null,k$a},k$c.subUpload=function(k$a,k$b,k$c){void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0);var k$d=this._bind_subUpload();return k$Na._gl.bindBuffer(this._bufferType,null),k$Na._bindActive[this._bufferType]=null,k$La.activeShader=null,k$d},k$c.disposeResource=function(){k$a.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},k$c.clear=function(){this._byteLength=0,this._upload=!0},k$d(0,k$c,"bufferLength",function(){return this._buffer.byteLength}),k$d(0,k$c,"byteLength",null,function(k$a){this._byteLength!==k$a&&(k$a<=this._buffer.byteLength||this._resizeBuffer(2*k$a+256,!0),this._byteLength=k$a)}),k$b.__int__=function(k$a){k$ua.QuadrangleIB=k$ua.create(35044),k$qa.fillIBQuadrangle(k$ua.QuadrangleIB,16)},k$b.FLOAT32=4,k$b.SHORT=2,k$b}(k$Na),k$$a=(function(k$b){function k$c(k$a){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,k$c.__super.call(this,9)}k$m(k$c,"laya.webgl.shader.d2.value.GlowSV",k$b);var k$a=k$c.prototype;k$a.setValue=function(k$a){k$b.prototype.setValue.call(this,k$a)},k$a.clear=function(){k$b.prototype.clear.call(this)}}(k$Ra),function(k$a){function k$b(k$a){k$b.__super.call(this,64),this.defines.add(64)}k$m(k$b,"laya.webgl.shader.d2.value.TextSV",k$a);var k$c=k$b.prototype;return k$c.release=function(){(k$b.pool[k$b._length++]=this).clear()},k$c.clear=function(){k$a.prototype.clear.call(this)},k$b.create=function(){return k$b._length?k$b.pool[--k$b._length]:new k$b(null)},k$b.pool=[],k$b._length=0,k$b}(k$Ra)),k$_a=function(k$a){function k$e(k$a,k$b,k$c,k$d){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,k$e.__super.call(this,k$a,k$b,k$c,k$d)}k$m(k$e,"laya.webgl.shader.d2.Shader2X",k$a);var k$b=k$e.prototype;return k$b.upload2dQuick1=function(k$a){this.upload(k$a,this._params2dQuick1||this._make2dQuick1())},k$b._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var k$a,k$b=this._params,k$c=0,k$d=k$b.length;k$c<k$d;k$c++)k$a=k$b[k$c],(k$r.isFlash||"size"!==k$a.name&&"position"!==k$a.name&&"texcoord"!==k$a.name)&&this._params2dQuick1.push(k$a)}return this._params2dQuick1},k$b.disposeResource=function(){k$a.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},k$b.upload2dQuick2=function(k$a){this.upload(k$a,this._params2dQuick2||this._make2dQuick2())},k$b._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var k$a,k$b=this._params,k$c=0,k$d=k$b.length;k$c<k$d;k$c++)k$a=k$b[k$c],(k$r.isFlash||"size"!==k$a.name)&&this._params2dQuick2.push(k$a)}return this._params2dQuick2},k$e.create=function(k$a,k$b,k$c,k$d){return new k$e(k$a,k$b,k$c,k$d)},k$e}(k$Ya),k$ua=function(k$a){function k$b(k$a){this._uint8Array=null,this._uint16Array=null,void 0===k$a&&(k$a=35044),k$b.__super.call(this),this._bufferUsage=k$a,this._bufferType=34963,k$r.isFlash||(this._buffer=new ArrayBuffer(8))}k$m(k$b,"laya.webgl.utils.IndexBuffer2D",k$Za);var k$c=k$b.prototype;return k$c._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},k$c.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},k$c.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},k$c.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},k$b.QuadrangleIB=null,k$b.create=function(k$a){return void 0===k$a&&(k$a=35044),new k$b(k$a)},k$b}(),k$va=function(k$a){function k$c(k$a,k$b){this._floatArray32=null,this._vertexStride=0,k$c.__super.call(this),this._vertexStride=k$a,this._bufferUsage=k$b,this._bufferType=34962,k$r.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}k$m(k$c,"laya.webgl.utils.VertexBuffer2D",k$a);var k$b=k$c.prototype;return k$b.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},k$b.bind=function(k$a){k$a&&k$a._bind(),this._bind()},k$b.insertData=function(k$a,k$b){this.getFloat32Array().set(k$a,k$b),this._upload=!0},k$b.bind_upload=function(k$a){k$a._bind_upload()||k$a._bind(),this._bind_upload()||this._bind()},k$b._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},k$b.disposeResource=function(){k$a.prototype.disposeResource.call(this)},k$b.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},k$d(0,k$b,"vertexStride",function(){return this._vertexStride}),k$c.create=function(k$a,k$b){return void 0===k$b&&(k$b=35048),new k$c(k$a,k$b)},k$c}(k$Za),k$ab=function(k$a){function k$h(k$a,k$b,k$c,k$d,k$e,k$f){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===k$c&&(k$c=6408),void 0===k$d&&(k$d=!0),k$h.__super.call(this,k$a,k$b),k$a){if(this._format=k$c,this._mipmap=k$d,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof k$a)this._url=k$a,this._src=k$a,this._image=new k$n.window.Image,k$b&&(k$b.onload&&(this.onload=k$b.onload),k$b.onerror&&(this.onerror=k$b.onerror),k$b.onCreate&&k$b.onCreate(this)),this._image.crossOrigin=k$a&&0==k$a.indexOf("data:")?null:"",k$a&&(this._image.src=k$a);else if(k$a instanceof ArrayBuffer){this._src=k$b,this._url=this._src;var k$g=new k$i(k$a);k$g.readUTFBytes(4),k$g.readUTFBytes(2),k$g.getInt16();k$g.endian="bigEndian",this._w=k$g.getInt16(),this._h=k$g.getInt16();k$g.getInt16(),k$g.getInt16();this._image=new Uint8Array(k$a,k$g.pos),this._format=k$wa.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,k$Q.enabled&&this._w<k$Q.atlasLimitWidth&&this._h<k$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(k$a instanceof Uint8Array))return this._src=k$b,this._url=this._src,this._image=k$a.source||k$a,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=k$b,this._url=this._src,this._w=k$e,this._h=k$f,this._image=k$a,this._format=0===k$c?k$a.byteLength/(k$e*k$f)==4?6408:6407:k$c}this._$5__enableMerageInAtlas=!0}}k$m(k$h,"laya.webgl.resource.WebGLImage",k$p);var k$b=k$h.prototype;return k$y.imps(k$b,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),k$b._init_=function(k$a,k$b){},k$b._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var k$a=k$wa.mainContext,k$b=this._source=k$a.createTexture(),k$c=k$xa.curBindTexTarget,k$d=k$xa.curBindTexValue;k$xa.bindTexture(k$a,3553,k$b);var k$e=this.minFifter,k$f=this.magFifter,k$g=this.repeat?10497:33071,k$h=k$k.isPOT(this._w,this._h),k$i=!1;switch(k$h?(this.mipmap?-1!==k$e||(k$e=9987):-1!==k$e||(k$e=9729),-1!==k$f||(k$f=9729),k$a.texParameteri(3553,10241,k$e),k$a.texParameteri(3553,10240,k$f),k$a.texParameteri(3553,10242,k$g),k$a.texParameteri(3553,10243,k$g),this.mipmap&&k$a.generateMipmap(3553)):(-1!==k$e||(k$e=9729),-1!==k$f||(k$f=9729),k$a.texParameteri(3553,10241,k$e),k$a.texParameteri(3553,10240,k$f),k$a.texParameteri(3553,10242,33071),k$a.texParameteri(3553,10243,33071)),k$a.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&k$a.pixelStorei(k$a.UNPACK_ALIGNMENT,1),k$a.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&k$a.pixelStorei(k$a.UNPACK_ALIGNMENT,1),k$a.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:k$i=!0,k$a.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case k$wa.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:k$i=!0,k$a.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}k$a.pixelStorei(37441,!1),k$c&&k$d&&k$xa.bindTexture(k$a,k$c,k$d),this.uri||(this.uri=this._url),k$i?this.memorySize=this._image.length:k$h&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},k$b.recreateResource=function(){var k$a=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var k$b=this;this._image=new k$n.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(k$b._needReleaseAgain)return k$b._needReleaseAgain=!1,k$b._image.onload=null,void(k$b._image=null);k$b._allowMerageInAtlas&&k$b._enableMerageInAtlas?(k$a.memorySize=0,k$a._recreateLock=!1):k$b._createWebGlTexture(),k$b.completeCreate()},this._image.src=this._src}},k$b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&k$wa.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},k$b.onresize=function(){this._w=this._image.width,this._h=this._image.height,k$Q.enabled&&this._w<k$Q.atlasLimitWidth&&this._h<k$Q.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},k$b.clearAtlasSource=function(){this._image=null},k$d(0,k$b,"format",function(){return this._format}),k$d(0,k$b,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(k$a){this._$5__enableMerageInAtlas=k$a}),k$d(0,k$b,"mipmap",function(){return this._mipmap}),k$d(0,k$b,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),k$d(0,k$b,"atlasSource",function(){return this._image}),k$d(0,k$b,"onload",null,function(k$a){var k$b=this;this._onload=k$a,this._image&&(this._image.onload=null!=this._onload?function(){k$b.onresize(),k$b._onload()}:null)}),k$d(0,k$b,"onerror",null,function(k$a){var k$b=this;this._onerror=k$a,this._image&&(this._image.onerror=null!=this._onerror?function(){k$b._onerror()}:null)}),k$h}();k$y.__init([k$na,k$P,k$za,k$ta])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(k$a,k$b){"use strict";for(var k$c in Object.defineProperty(k$b,"__esModule",{value:!0}),Laya){var k$d=Laya[k$c];k$d&&k$d.__isclass&&(k$b[k$c]=k$d)}}),function(k$f,k$a,k$d){k$d.un,k$d.uns;var k$e=k$d.static,k$g=k$d.class,k$h=k$d.getset,k$i=(k$d.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),k$o=laya.utils.ClassUtils,k$l=(laya.events.Event,laya.utils.HTMLChar),k$j=laya.net.Loader,k$k=(laya.display.Node,laya.maths.Rectangle),k$m=laya.renders.Render,k$n=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),k$p=laya.utils.Stat,k$L=laya.display.Text,k$q=laya.resource.Texture,k$r=laya.net.URL,k$s=laya.utils.Utils,k$t=function(){function k$n(){}return k$g(k$n,"laya.html.utils.HTMLParse"),k$n.parse=function(k$a,k$b,k$c){k$b=(k$b="<root>"+(k$b=k$b.replace(/<br>/g,"<br/>"))+"</root>").replace(k$n.spacePattern,k$n.char255);var k$d=k$s.parseXMLFromString(k$b);k$n._parseXML(k$a,k$d.childNodes[0].childNodes,k$c)},k$n._parseXML=function(k$a,k$b,k$c,k$d){var k$e=0,k$f=0;if(k$b.join||k$b.item)for(k$e=0,k$f=k$b.length;k$e<k$f;++k$e)k$n._parseXML(k$a,k$b[k$e],k$c,k$d);else{var k$g,k$h,k$i;if(3==k$b.nodeType)return void(k$a instanceof laya.html.dom.HTMLDivElement?(null==k$b.nodeName&&(k$b.nodeName="#text"),k$h=k$b.nodeName.toLowerCase(),0<(k$i=k$b.textContent.replace(/^\s+|\s+$/g,"")).length&&(k$g=k$o.getInstance(k$h))&&(k$a.addChild(k$g),k$g.innerTEXT=k$i.replace(k$n.char255AndOneSpacePattern," "))):0<(k$i=k$b.textContent.replace(/^\s+|\s+$/g,"")).length&&(k$a.innerTEXT=k$i.replace(k$n.char255AndOneSpacePattern," ")));if("#comment"==(k$h=k$b.nodeName.toLowerCase()))return;if(k$g=k$o.getInstance(k$h)){(k$g=k$a.addChild(k$g)).URI=k$c,k$g.href=k$d;var k$j=k$b.attributes;if(k$j&&0<k$j.length)for(k$e=0,k$f=k$j.length;k$e<k$f;++k$e){var k$k=k$j[k$e],k$l=k$k.nodeName,k$m=k$k.value;k$g._setAttributes(k$l,k$m)}k$n._parseXML(k$g,k$b.childNodes,k$c,k$g.href)}else k$n._parseXML(k$a,k$b.childNodes,k$c,k$d)}},k$n.char255=String.fromCharCode(255),k$n.spacePattern=/&nbsp;|&#160;/g,k$n.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),k$n}(),k$w=function(){function k$K(){}return k$g(k$K,"laya.html.utils.Layout"),k$K.later=function(k$a){null==k$K._will&&(k$K._will=[],k$d.stage.frameLoop(1,null,function(){if(!(k$K._will.length<1)){for(var k$a=0;k$a<k$K._will.length;k$a++)laya.html.utils.Layout.layout(k$K._will[k$a]);k$K._will.length=0}})),k$K._will.push(k$a)},k$K.layout=function(k$a){if(!k$a||!k$a._style)return null;if(0==(512&k$a._style._type))return null;k$a.getStyle()._type&=-513;var k$b=k$K._multiLineLayout(k$a);return k$m.isConchApp&&k$a.layaoutCallNative&&k$a.layaoutCallNative(),k$b},k$K._multiLineLayout=function(k$a){if(k$L.RightToLeft)return k$K._multiLineLayout2(k$a);var k$b=new Array;k$a._addChildsToLayout(k$b);var k$c,k$d,k$e,k$f,k$g,k$h=0,k$i=k$b.length,k$j=k$a._getCSSStyle(),k$k=k$j.letterSpacing,k$l=k$j.leading,k$m=k$j.lineHeight,k$n=k$j._widthAuto()||!k$j.wordWrap,k$o=k$n?999999:k$a.width,k$p=(k$a.height,0),k$q=k$j.italic?k$j.fontSize/3:0,k$r=k$j._getAlign(),k$s=k$j._getValign(),k$t=0!==k$s||0!==k$r||0!=k$m,k$w=0,k$x=0,k$y=0,k$z=0,k$A=new Array,k$B=k$A[0]=new k$M,k$C=!1,k$D=!1;k$B.h=0,k$j.italic&&(k$o-=k$j.fontSize/3);var k$E=0,k$F=!0;function k$G(){k$B.y=k$x,k$x+=k$B.h+k$l,0==k$B.h&&(k$x+=k$m),k$B.mWidth=k$E,k$E=0,k$B=new k$M,k$A.push(k$B),k$B.h=0,k$C=!(k$F=!(k$w=0))}for(k$h=0;k$h<k$i;k$h++)if(null!=(k$c=k$b[k$h]))if(k$F=!1,k$c instanceof laya.html.dom.HTMLBrElement)k$G(),k$B.y=k$x;else{if(k$c._isChar()){if((k$f=k$c).isWord)k$C=k$D||"\n"===k$f.char,k$B.wordStartIndex=k$B.elements.length;else{if(k$y=k$f.width+k$f.style.letterSpacin,0<k$A.length&&k$o<k$w+k$y&&0<k$B.wordStartIndex){var k$H;k$H=k$B.elements.length-k$B.wordStartIndex+1,k$B.elements.length=k$B.wordStartIndex,k$h-=k$H,k$G();continue}k$C=!1,k$E+=k$f.width}k$y=k$f.width+k$k,k$z=k$f.height,k$D=!1,(k$C=k$C||k$o<k$w+k$y)&&k$G(),k$B.minTextHeight=Math.min(k$B.minTextHeight,k$c.height)}else k$d=k$c._getCSSStyle(),k$g=k$c,k$e=k$d.padding,0===k$d._getCssFloat()||(k$t=!0),k$C=k$D||k$d.lineElement,k$y=k$g.width*k$g._style._tf.scaleX+k$e[1]+k$e[3]+k$k,k$z=k$g.height*k$g._style._tf.scaleY+k$e[0]+k$e[2],k$D=k$d.lineElement,(k$C=k$C||k$o<k$w+k$y&&k$d.wordWrap)&&k$G();k$B.elements.push(k$c),k$B.h=Math.max(k$B.h,k$z),k$c.x=k$w,k$c.y=k$x,k$w+=k$y,k$B.w=k$w-k$k,k$B.y=k$x,k$p=Math.max(k$w+k$q,k$p)}else k$F||(k$w+=k$K.DIV_ELEMENT_PADDING),k$B.wordStartIndex=k$B.elements.length;if(k$x=k$B.y+k$B.h,k$t){var k$I=0,k$J=k$o;for(k$n&&0<k$a.width&&(k$J=k$a.width),k$h=0,k$i=k$A.length;k$h<k$i;k$h++)k$A[k$h].updatePos(0,k$J,k$h,k$I,k$r,k$s,k$m),k$I+=Math.max(k$m,k$A[k$h].h+k$l);k$x=k$I}return k$n&&(k$a.width=k$p),k$x>k$a.height&&(k$a.height=k$x),[k$p,k$x]},k$K._multiLineLayout2=function(k$a){var k$b=new Array;k$a._addChildsToLayout(k$b);var k$c,k$d,k$e,k$f,k$g,k$h=0,k$i=k$b.length,k$j=k$a._getCSSStyle(),k$k=k$j.letterSpacing,k$l=k$j.leading,k$m=k$j.lineHeight,k$n=k$j._widthAuto()||!k$j.wordWrap,k$o=k$n?999999:k$a.width,k$p=(k$a.height,0),k$q=k$j.italic?k$j.fontSize/3:0,k$r=2-k$j._getAlign(),k$s=k$j._getValign(),k$t=0!==k$s||0!=k$r||0!=k$m,k$w=0,k$x=0,k$y=0,k$z=0,k$A=new Array,k$B=k$A[0]=new k$M,k$C=!1,k$D=!1;k$B.h=0,k$j.italic&&(k$o-=k$j.fontSize/3);var k$E=0,k$F=!0;function k$G(){k$B.y=k$x,k$x+=k$B.h+k$l,0==k$B.h&&(k$x+=k$m),k$B.mWidth=k$E,k$E=0,k$B=new k$M,k$A.push(k$B),k$B.h=0,k$C=!(k$F=!(k$w=0))}for(k$h=0;k$h<k$i;k$h++)if(null!=(k$c=k$b[k$h]))if(k$F=!1,k$c instanceof laya.html.dom.HTMLBrElement)k$G(),k$B.y=k$x;else{if(k$c._isChar()){if((k$f=k$c).isWord)k$C=k$D||"\n"===k$f.char,k$B.wordStartIndex=k$B.elements.length;else{if(0<k$A.length&&k$o<k$w+k$y&&0<k$B.wordStartIndex){var k$H;k$H=k$B.elements.length-k$B.wordStartIndex+1,k$B.elements.length=k$B.wordStartIndex,k$h-=k$H,k$G();continue}k$C=!1,k$E+=k$f.width}k$y=k$f.width+k$k,k$z=k$f.height,k$D=!1,(k$C=k$C||k$o<k$w+k$y)&&k$G(),k$B.minTextHeight=Math.min(k$B.minTextHeight,k$c.height)}else k$d=k$c._getCSSStyle(),k$g=k$c,k$e=k$d.padding,0===k$d._getCssFloat()||(k$t=!0),k$C=k$D||k$d.lineElement,k$y=k$g.width*k$g._style._tf.scaleX+k$e[1]+k$e[3]+k$k,k$z=k$g.height*k$g._style._tf.scaleY+k$e[0]+k$e[2],k$D=k$d.lineElement,(k$C=k$C||k$o<k$w+k$y&&k$d.wordWrap)&&k$G();k$B.elements.push(k$c),k$B.h=Math.max(k$B.h,k$z),k$c.x=k$w,k$c.y=k$x,k$w+=k$y,k$B.w=k$w-k$k,k$B.y=k$x,k$p=Math.max(k$w+k$q,k$p)}else k$F||(k$w+=k$K.DIV_ELEMENT_PADDING),k$B.wordStartIndex=k$B.elements.length;if(k$x=k$B.y+k$B.h,k$t){var k$I=0,k$J=k$o;for(k$h=0,k$i=k$A.length;k$h<k$i;k$h++)k$A[k$h].updatePos(0,k$J,k$h,k$I,k$r,k$s,k$m),k$I+=Math.max(k$m,k$A[k$h].h+k$l);k$x=k$I}for(k$n&&(k$a.width=k$p),k$x>k$a.height&&(k$a.height=k$x),k$h=0,k$i=k$A.length;k$h<k$i;k$h++)k$A[k$h].revertOrder(k$o);return[k$p,k$x]},k$K._will=null,k$K.DIV_ELEMENT_PADDING=0,k$K}(),k$M=function(){function k$a(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}k$g(k$a,"laya.html.utils.LayoutLine");var k$b=k$a.prototype;return k$b.updatePos=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){var k$h,k$i=0;0<this.elements.length&&(k$i=(k$h=this.elements[this.elements.length-1]).x+k$h.width-this.elements[0].x);var k$j=0,k$k=NaN;1===k$e&&(k$j=(k$b-k$i)/2),2===k$e&&(k$j=k$b-k$i),0===k$g||0!=k$f||(k$f=1);for(var k$l=0,k$m=this.elements.length;k$l<k$m;k$l++){var k$n=(k$h=this.elements[k$l])._getCSSStyle();switch(0!==k$j&&(k$h.x+=k$j),k$n._getValign()){case 0:k$h.y=k$d;break;case 1:var k$o=0;99999!=this.minTextHeight&&(k$o=this.minTextHeight);var k$p=(k$o+k$g)/2;k$p=Math.max(k$p,this.h),k$k=(laya.html.dom.HTMLImageElement,k$d+k$p-k$h.height),k$h.y=k$k;break;case 2:k$h.y=k$d+(k$g-k$h.height)}}},k$b.revertOrder=function(k$a){var k$b;if(0<this.elements.length){var k$c,k$d=0;for(k$c=this.elements.length,k$d=0;k$d<k$c;k$d++)(k$b=this.elements[k$d]).x=k$a-k$b.x-k$b.width}},k$a}(),k$x=function(k$c){function k$b(){this.URI=null,this._href=null,k$b.__super.call(this),this._text=k$b._EMPTYTEXT,this.setStyle(new k$i(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}k$g(k$b,"laya.html.dom.HTMLElement",k$c);var k$a=k$b.prototype;return k$a.layaoutCallNative=function(){var k$a=0;if(this._childs&&0<(k$a=this._childs.length))for(var k$b=0;k$b<k$a;k$b++)this._childs[k$b].layaoutCallNative&&this._childs[k$b].layaoutCallNative();var k$c=this._getWords();k$c?laya.html.dom.HTMLElement.fillWords(this,k$c,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},k$a.appendChild=function(k$a){return this.addChild(k$a)},k$a._getWords2=function(){var k$a=this._text.text;if(!k$a||0===k$a.length)return null;var k$b,k$c,k$d=0,k$e=0;if(this._text.drawWords)k$c=this._text.drawWords;else{for(k$e=(k$b=k$a.split(" ")).length-1,k$c=[],k$d=0;k$d<k$e;k$d++)k$c.push(k$b[k$d]," ");0<=k$e&&k$c.push(k$b[k$e]),this._text.drawWords=k$c}var k$f,k$g=this._text.words;if(k$g&&k$g.length===k$c.length)return k$g;null===k$g&&(this._text.words=k$g=[]),k$g.length=k$c.length;var k$h=this.style,k$i=k$h.font;for(k$d=0,k$e=k$c.length;k$d<k$e;k$d++){k$f=k$s.measureText(k$c[k$d],k$i);var k$j=k$g[k$d]=new k$l(k$c[k$d],k$f.width,k$f.height||k$h.fontSize,k$h);if(1<k$j.char.length&&(k$j.charNum=k$j.char),this.href){var k$k=new k$n;this.addChild(k$k),k$j.setSprite(k$k)}}return k$g},k$a._getWords=function(){if(!k$L.CharacterCache)return this._getWords2();var k$a=this._text.text;if(!k$a||0===k$a.length)return null;var k$b,k$c=this._text.words;if(k$c&&k$c.length===k$a.length)return k$c;null===k$c&&(this._text.words=k$c=[]),k$c.length=k$a.length;for(var k$d=this.style,k$e=k$d.font,k$f=0,k$g=k$a.length;k$f<k$g;k$f++)if(k$b=k$s.measureText(k$a.charAt(k$f),k$e)){var k$h=k$c[k$f]=new k$l(k$a.charAt(k$f),k$b.width,k$b.height||k$d.fontSize,k$d);if(this.href){var k$i=new k$n;this.addChild(k$i),k$h.setSprite(k$i)}}else console.warn("_getWords size is null"+k$a.charAt(k$f),k$e);return k$c},k$a.showLinkSprite=function(){var k$a=this._text.words;if(k$a)for(var k$b,k$c,k$d=[],k$e=0;k$e<k$a.length;k$e++)k$c=k$a[k$e],(k$b=new k$n).graphics.drawRect(0,0,k$c.width,k$c.height,"#ff0000"),k$b.width=k$c.width,k$b.height=k$c.height,this.addChild(k$b),k$d.push(k$b)},k$a._layoutLater=function(){var k$a=this.style;512&k$a._type||(k$a.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&k$a.block?(k$w.later(this),k$a._type|=512):this.parent&&this.parent._layoutLater())},k$a._setAttributes=function(k$a,k$b){switch(k$a){case"style":return void this.style.cssText(k$b);case"class":return void(this.className=k$b)}k$c.prototype._setAttributes.call(this,k$a,k$b)},k$a.updateHref=function(){if(null!=this._href){var k$a=this._getWords();if(k$a)for(var k$b,k$c,k$d=0;k$d<k$a.length;k$d++)(k$c=(k$b=k$a[k$d]).getSprite())&&(k$c.size(k$b.width,k$b.height),k$c.on("click",this,this.onLinkHandler))}},k$a.onLinkHandler=function(k$a){switch(k$a.type){case"click":for(var k$b=this;k$b;)k$b.event("link",[this.href]),k$b=k$b.parent}},k$a.formatURL=function(k$a){return this.URI?k$r.formatURL(k$a,this.URI?this.URI.path:null):k$a},k$h(0,k$a,"href",function(){return this._href},function(k$a){null!=(this._href=k$a)&&(this._getCSSStyle().underLine=1,this.updateHref())}),k$h(0,k$a,"color",null,function(k$a){this.style.color=k$a}),k$h(0,k$a,"onClick",null,function(k$a){k$d._runScript("fn=function(event){"+k$a+";}"),this.on("click",this,void 0)}),k$h(0,k$a,"id",null,function(k$a){k$y.document.setElementById(k$a,this)}),k$h(0,k$a,"innerTEXT",function(){return this._text.text},function(k$a){this.text=k$a}),k$h(0,k$a,"style",function(){return this._style}),k$h(0,k$a,"text",function(){return this._text.text},function(k$a){this._text==k$b._EMPTYTEXT?this._text={text:k$a,words:null}:(this._text.text=k$a,this._text.words&&(this._text.words.length=0)),k$m.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),k$h(0,k$a,"parent",k$c.prototype._$get_parent,function(k$a){if(k$a instanceof laya.html.dom.HTMLElement){var k$b=k$a;this.URI||(this.URI=k$b.URI),this.style.inherit(k$b.style)}k$d.superSet(k$n,this,"parent",k$a)}),k$h(0,k$a,"className",null,function(k$a){this.style.attrs(k$y.document.styleSheets["."+k$a])}),k$b.fillWords=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){k$a.graphics.clear();for(var k$h=0,k$i=k$b.length;k$h<k$i;k$h++){var k$j=k$b[k$h];k$a.graphics.fillText(k$j.char,k$j.x+k$c,k$j.y+k$d,k$e,k$f,"left",k$g)}},k$b._EMPTYTEXT={text:null,words:null},k$b}(k$n),k$b=(function(k$a){function k$b(){k$b.__super.call(this),this.style.lineElement=!0,this.style.block=!0}k$g(k$b,"laya.html.dom.HTMLBrElement",k$x)}(),function(k$a){function k$b(){this.contextHeight=NaN,this.contextWidth=NaN,k$b.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}k$g(k$b,"laya.html.dom.HTMLDivElement",k$a);var k$c=k$b.prototype;return k$c.appendHTML=function(k$a){k$t.parse(this,k$a,this.URI),this.layout()},k$c._addChildsToLayout=function(k$b){var k$a=this._getWords();if(null==k$a&&0==this._childs.length)return!1;k$a&&k$a.forEach(function(k$a){k$b.push(k$a)});for(var k$c=!0,k$d=0,k$e=this._childs.length;k$d<k$e;k$d++){var k$f=this._childs[k$d];k$c?k$c=!1:k$b.push(null),k$f._addToLayout(k$b)}return!0},k$c._addToLayout=function(k$a){this.layout()},k$c.layout=function(){if(this.style){this.style._type|=512;var k$a=k$w.layout(this);if(k$a){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new k$k);var k$b=this._$P.mHtmlBounds;k$b.x=k$b.y=0,k$b.width=this.contextWidth=k$a[0],k$b.height=this.contextHeight=k$a[1],this.setBounds(k$b)}}},k$h(0,k$c,"height",function(){return this._height?this._height:this.contextHeight},k$a.prototype._$set_height),k$h(0,k$c,"innerHTML",null,function(k$a){this.destroyChildren(),this.appendHTML(k$a)}),k$h(0,k$c,"width",function(){return this._width?this._width:this.contextWidth},function(k$a){var k$b=!1;k$b=0===k$a?k$a!=this._width:k$a!=this.width,k$d.superSet(k$x,this,"width",k$a),k$b&&this.layout()}),k$b}(k$x)),k$y=function(k$a){function k$b(){this.all=new Array,this.styleSheets=k$i.styleSheets,k$b.__super.call(this)}k$g(k$b,"laya.html.dom.HTMLDocument",k$x);var k$c=k$b.prototype;return k$c.getElementById=function(k$a){return this.all[k$a]},k$c.setElementById=function(k$a,k$b){this.all[k$a]=k$b},k$e(k$b,["document",function(){return this.document=new k$b}]),k$b}();(function(k$a){function k$b(){this._tex=null,this._url=null,this._renderArgs=[],k$b.__super.call(this),this.style.block=!0}k$g(k$b,"laya.html.dom.HTMLImageElement",k$x);var k$c=k$b.prototype;k$c._addToLayout=function(k$a){!this._style.absolute&&k$a.push(this)},k$c.render=function(k$a,k$b,k$c){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(k$p.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,k$a.ctx.drawTexture2(k$b,k$c,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},k$c.layaoutCallNative=function(){var k$a=0;if(this._childs&&0<(k$a=this._childs.length))for(var k$b=0;k$b<k$a;k$b++)this._childs[k$b].layaoutCallNative&&this._childs[k$b].layaoutCallNative()},k$h(0,k$c,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(k$a){this._width!==k$a&&(this._width=k$a,this._style.width=k$a,this.repaint())}),k$h(0,k$c,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(k$a){this._height!==k$a&&(this._height=k$a,this._style.height=k$a,this.repaint())}),k$c.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),k$j.clearCache(this,this._url),this._tex=null),k$x.prototype.destroy.call(this)},k$c.onloaded=function(){var k$a=this._style;k$a&&!k$a.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),k$a&&!k$a.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),k$m.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},k$c._loadImageComplete=function(k$a,k$b,k$c){if(!this._destroyed)if(null!=k$c)if(k$c instanceof ArrayBuffer){var k$d=new DataView(k$c);new laya.webgl.resource.WebGLImage(new Uint8Array(k$c,8),k$a,0,!1,k$d.getUint32(0),k$d.getUint32(4));this.onloaded()}else if(k$c instanceof k$q)k$j.imgMgrSet[k$a]=k$b,k$f.imgMgrLock(k$a,k$j.imgMgrSet[k$a]),this._url=k$a,this._tex=k$c,k$j.keepCache(this,k$a),k$j.cacheRes(k$a,this._tex),this.onloaded();else{var k$e=-1!=k$a.indexOf(".png",k$a.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(k$c,k$a,k$e,!1,k$c.width,k$c.height);this.onloaded()}else this.event("error","Load image failed")},k$h(0,k$c,"src",null,function(k$a){(k$a=this.formatURL(k$a),this._url!=k$a)&&(null!=this._tex&&(k$j.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=k$a,(this._tex=k$j.getRes(k$a))?(k$j.keepCache(this,k$a),this.onloaded()):k$f.imgMgrLoad(k$a,this._loadImageComplete.bind(this),2,!1))})})(),function(k$a){function k$b(){this.type=null,k$b.__super.call(this),this.visible=!1}k$g(k$b,"laya.html.dom.HTMLLinkElement",k$a);var k$c=k$b.prototype;k$c._onload=function(k$a){switch(this.type){case"text/css":k$i.parseCSS(k$a,this.URI)}},k$h(0,k$c,"href",k$a.prototype._$get_href,function(k$a){var k$b=this;k$a=this.formatURL(k$a),this.URI=new k$r(k$a);var k$c=new k$j;k$c.once("complete",null,function(k$a){k$b._onload(k$a)}),k$c.load(k$a,"text")}),k$b._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(k$x),function(k$a){function k$b(){k$b.__super.call(this),this.visible=!1}k$g(k$b,"laya.html.dom.HTMLStyleElement",k$a),k$h(0,k$b.prototype,"text",k$a.prototype._$get_text,function(k$a){k$i.parseCSS(k$a,null)})}(k$x),function(k$a){function k$b(){k$b.__super.call(this),this._getCSSStyle().valign="middle"}k$g(k$b,"laya.html.dom.HTMLIframeElement",k$a),k$h(0,k$b.prototype,"href",k$a.prototype._$get_href,function(k$c){var k$d=this;k$c=this.formatURL(k$c);var k$a=new k$j;k$a.once("complete",null,function(k$a){var k$b=k$d.URI;k$d.URI=new k$r(k$c),k$d.innerHTML=k$a,!k$b||(k$d.URI=k$b)}),k$a.load(k$c,"text")})}(k$b)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(k$a,k$b){"use strict";for(var k$c in Object.defineProperty(k$b,"__esModule",{value:!0}),Laya){var k$d=Laya[k$c];k$d&&k$d.__isclass&&(k$b[k$c]=k$d)}}),function(k$a,k$b,k$p){k$p.un,k$p.uns;var k$d=k$p.static,k$f=k$p.class,k$e=k$p.getset,k$c=(k$p.__newvec,laya.display.Animation),k$q=(laya.utils.Browser,laya.utils.ClassUtils),k$g=laya.filters.ColorFilter,k$h=laya.utils.Ease,k$i=laya.events.Event,k$j=(laya.events.EventDispatcher,laya.display.css.Font),k$k=laya.display.FrameAnimation,k$l=laya.display.Graphics,k$m=laya.utils.Handler,k$n=laya.display.Input,k$s=laya.net.Loader,k$o=(laya.display.Node,laya.maths.Point),k$r=laya.maths.Rectangle,k$t=laya.renders.Render,k$w=laya.display.Sprite,k$x=laya.display.Text,k$y=laya.resource.Texture,k$z=laya.utils.Tween,k$A=laya.utils.Utils,k$B=laya.utils.WeakObject;k$p.interface("laya.ui.IItem"),k$p.interface("laya.ui.ISelect"),k$p.interface("laya.ui.IRender"),k$p.interface("laya.ui.IComponent"),k$p.interface("laya.ui.IBox","IComponent");var k$C=function(){function k$a(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return k$f(k$a,"laya.ui.LayoutStyle"),k$d(k$a,["EMPTY",function(){return this.EMPTY=new k$a}]),k$a}(),k$D=function(){function k$a(){}return k$f(k$a,"laya.ui.Styles"),k$a.labelColor="#000000",k$a.buttonStateNum=3,k$a.scrollBarMinNum=15,k$a.scrollBarDelayTime=500,k$d(k$a,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),k$a}(),k$E=function(){function k$e(){}return k$f(k$e,"laya.ui.UIUtils"),k$e.fillArray=function(k$a,k$b,k$c){var k$d=k$a.concat();if(k$b)for(var k$e=k$b.split(","),k$f=0,k$g=Math.min(k$d.length,k$e.length);k$f<k$g;k$f++){var k$h=k$e[k$f];k$d[k$f]="true"==k$h||"false"!=k$h&&k$h,null!=k$c&&(k$d[k$f]=k$c(k$h))}return k$d},k$e.toColor=function(k$a){return k$A.toHexColor(k$a)},k$e.gray=function(k$a,k$b){void 0===k$b&&(k$b=!0),k$b?k$e.addFilter(k$a,k$e.grayFilter):k$e.clearFilter(k$a,k$g)},k$e.addFilter=function(k$a,k$b){var k$c=k$a.filters||[];k$c.push(k$b),k$a.filters=k$c},k$e.clearFilter=function(k$a,k$b){var k$c=k$a.filters;if(null!=k$c&&0<k$c.length){for(var k$d=k$c.length-1;-1<k$d;k$d--){var k$e=k$c[k$d];k$p.__typeof(k$e,k$b)&&k$c.splice(k$d,1)}k$a.filters=k$c}},k$e._getReplaceStr=function(k$a){return k$e.escapeSequence[k$a]},k$e.adptString=function(k$a){return k$a.replace(/\\(\w)/g,k$e._getReplaceStr)},k$e.getBindFun=function(k$a){var k$b=k$e._funMap.get(k$a);if(null==k$b){var k$c='"'+k$a+'"',k$d="(function(data){if(data==null)return;with(data){try{\nreturn "+(k$c=k$c.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";k$b=k$p._runScript(k$d),k$e._funMap.set(k$a,k$b)}return k$b},k$d(k$e,["grayFilter",function(){return this.grayFilter=new k$g([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new k$B}]),k$e}(),k$F=function(){function k$a(){}return k$f(k$a,"UIConfig"),k$a.touchScrollEnable=!0,k$a.mouseWheelEnable=!0,k$a.showButtons=!0,k$a.popupBgColor="#000000",k$a.popupBgAlpha=.5,k$a.closeDialogOnSide=!0,k$a}(),k$G=function(k$c){function k$r(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,k$r.__super.call(this),this._weakKeys=[]}k$f(k$r,"laya.ui.AutoBitmap",k$c);var k$a=k$r.prototype;return k$a.destroy=function(){if(k$s.clearObject(this,this._weakKey),this._weakKeys){for(var k$a=0,k$b=this._weakKeys.length;k$a<k$b;++k$a)k$s.clearObject(this,this._weakKeys[k$a]);this._weakKeys=null}k$c.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},k$a._setChanged=function(){this._isChanged||(this._isChanged=!0,k$p.timer.callLater(this,this.changeSource))},k$a.changeSource=function(){this._isChanged=!1;var k$a=this._source;if(k$a&&k$a.bitmap){var k$b=this.width,k$c=this.height,k$d=this._sizeGrid,k$e=k$a.sourceWidth,k$f=k$a.sourceHeight;if(!k$d||k$e===k$b&&k$f===k$c)this.cleanByTexture(k$a,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,k$b,k$c);else{k$s.clearObject(this,this._weakKey),k$a.$_GID||(k$a.$_GID=k$A.getGID());var k$g=k$a.$_GID+"."+k$b+"."+k$c+"."+k$d.join("."),k$h=k$s.findObject(k$g);if(k$A.isOKCmdList(k$h))return this._weakKey=k$g,k$s.keepObject(this,this._weakKey),void(this.cmds=k$h);this.clear();var k$i,k$j,k$k=k$d[0],k$l=k$d[1],k$m=k$d[2],k$n=k$d[3],k$o=k$d[4],k$p=!1;if(k$b==k$e&&(k$n=k$l=0),k$c==k$f&&(k$k=k$m=0),k$b<k$n+k$l){var k$q=k$b;k$p=!0,k$b=k$n+k$l,this.save(),this.clipRect(0,0,k$q,k$c)}k$n&&k$k&&(k$i=k$r.getTexture(k$a,0,0,k$n,k$k),k$j=this._weakKeys[0],k$i?(k$j!=k$i.weakKey&&(k$s.clearObject(this,k$j),k$s.keepObject(this,k$i.weakKey),this._weakKeys[0]=k$i.weakKey),this.drawTexture(k$i,0,0,k$n,k$k)):(k$s.clearObject(this,k$j),this._weakKeys[0]="")),k$l&&k$k&&(k$i=k$r.getTexture(k$a,k$e-k$l,0,k$l,k$k),k$j=this._weakKeys[1],k$i?(k$j!=k$i.weakKey&&(k$s.clearObject(this,k$j),k$s.keepObject(this,k$i.weakKey),this._weakKeys[1]=k$i.weakKey),this.drawTexture(k$i,k$b-k$l,0,k$l,k$k)):(k$s.clearObject(this,k$j),this._weakKeys[1]="")),k$n&&k$m&&(k$i=k$r.getTexture(k$a,0,k$f-k$m,k$n,k$m),k$j=this._weakKeys[2],k$i?(k$j!=k$i.weakKey&&(k$s.clearObject(this,k$j),k$s.keepObject(this,k$i.weakKey),this._weakKeys[2]=k$i.weakKey),this.drawTexture(k$i,0,k$c-k$m,k$n,k$m)):(k$s.clearObject(this,k$j),this._weakKeys[2]="")),k$l&&k$m&&(k$i=k$r.getTexture(k$a,k$e-k$l,k$f-k$m,k$l,k$m),k$j=this._weakKeys[3],k$i?(k$j!=k$i.weakKey&&(k$s.clearObject(this,k$j),k$s.keepObject(this,k$i.weakKey),this._weakKeys[3]=k$i.weakKey),this.drawTexture(k$i,k$b-k$l,k$c-k$m,k$l,k$m)):(k$s.clearObject(this,k$j),this._weakKeys[3]="")),k$k&&(k$i=k$r.getTexture(k$a,k$n,0,k$e-k$n-k$l,k$k),k$j=this._weakKeys[4],k$i?(k$j!=k$i.weakKey&&(k$s.clearObject(this,k$j),k$s.keepObject(this,k$i.weakKey),this._weakKeys[4]=k$i.weakKey),this.drawBitmap(k$o,k$i,k$n,0,k$b-k$n-k$l,k$k)):(k$s.clearObject(this,k$j),this._weakKeys[4]="")),k$m&&(k$i=k$r.getTexture(k$a,k$n,k$f-k$m,k$e-k$n-k$l,k$m),k$j=this._weakKeys[5],k$i?(k$j!=k$i.weakKey&&(k$s.clearObject(this,k$j),k$s.keepObject(this,k$i.weakKey),this._weakKeys[5]=k$i.weakKey),this.drawBitmap(k$o,k$i,k$n,k$c-k$m,k$b-k$n-k$l,k$m)):(k$s.clearObject(this,k$j),this._weakKeys[5]="")),k$n&&(k$i=k$r.getTexture(k$a,0,k$k,k$n,k$f-k$k-k$m),k$j=this._weakKeys[6],k$i?(k$j!=k$i.weakKey&&(k$s.clearObject(this,k$j),k$s.keepObject(this,k$i.weakKey),this._weakKeys[6]=k$i.weakKey),this.drawBitmap(k$o,k$i,0,k$k,k$n,k$c-k$k-k$m)):(k$s.clearObject(this,k$j),this._weakKeys[6]="")),k$l&&(k$i=k$r.getTexture(k$a,k$e-k$l,k$k,k$l,k$f-k$k-k$m),k$j=this._weakKeys[7],k$i?(k$j!=k$i.weakKey&&(k$s.clearObject(this,k$j),k$s.keepObject(this,k$i.weakKey),this._weakKeys[7]=k$i.weakKey),this.drawBitmap(k$o,k$i,k$b-k$l,k$k,k$l,k$c-k$k-k$m)):(k$s.clearObject(this,k$j),this._weakKeys[7]="")),k$i=k$r.getTexture(k$a,k$n,k$k,k$e-k$n-k$l,k$f-k$k-k$m),k$j=this._weakKeys[8],k$i?(k$j!=k$i.weakKey&&(k$s.clearObject(this,k$j),k$s.keepObject(this,k$i.weakKey),this._weakKeys[8]=k$i.weakKey),this.drawBitmap(k$o,k$i,k$n,k$k,k$b-k$n-k$l,k$c-k$k-k$m)):(k$s.clearObject(this,k$j),this._weakKeys[8]=""),k$p&&this.restore(),this.autoCacheCmd&&!k$t.isConchApp&&(k$s.saveObject(k$g,this.cmds,null),this._weakKey=k$g,k$s.keepObject(this,this._weakKey))}this._repaint()}},k$a.drawBitmap=function(k$a,k$b,k$c,k$d,k$e,k$f){void 0===k$e&&(k$e=0),void 0===k$f&&(k$f=0),k$e<.1||k$f<.1||(!k$a||k$b.width==k$e&&k$b.height==k$f?this.drawTexture(k$b,k$c,k$d,k$e,k$f):this.fillTexture(k$b,k$c,k$d,k$e,k$f))},k$a.clear=function(k$a){void 0===k$a&&(k$a=!0),k$c.prototype.clear.call(this,!1)},k$e(0,k$a,"sizeGrid",function(){return this._sizeGrid},function(k$a){this._sizeGrid=k$a,this._setChanged()}),k$e(0,k$a,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(k$a){this._width!=k$a&&(this._width=k$a,this._setChanged())}),k$e(0,k$a,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(k$a){this._height!=k$a&&(this._height=k$a,this._setChanged())}),k$e(0,k$a,"source",function(){return this._source},function(k$a){k$a?(this._source=k$a,this._setChanged()):(this._source=null,this.clear())}),k$r.getTexture=function(k$a,k$b,k$c,k$d,k$e){k$d<=0&&(k$d=1),k$e<=0&&(k$e=1),k$a.$_GID||(k$a.$_GID=k$A.getGID());var k$f=k$a.$_GID+"."+k$b+"."+k$c+"."+k$d+"."+k$e,k$g=k$s.findObject(k$f);if((!k$g||!k$g.source)&&(k$g=k$y.createFromTexture(k$a,k$b,k$c,k$d,k$e))){if(k$a.alphaTexture){var k$h=k$a.width/k$a.alphaTexture.width;k$g.alphaTexture=k$y.createFromTexture(k$a.alphaTexture,k$b/k$h,k$c/k$h,k$d/k$h,k$e/k$h)}k$s.saveObject(k$f,k$g),k$g.weakKey=k$f}return k$g},k$r}(k$l),k$H=(function(k$a){function k$b(){k$b.__super.call(this)}k$f(k$b,"laya.ui.UIEvent",k$i),k$b.SHOW_TIP="showtip",k$b.HIDE_TIP="hidetip"}(),function(k$b){function k$a(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,k$a.__super.call(this),this._layout=k$C.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}k$f(k$a,"laya.ui.Component",k$b);var k$c=k$a.prototype;return k$p.imps(k$c,{"laya.ui.IComponent":!0}),k$c.destroy=function(k$a){void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,k$a),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},k$c.preinitialize=function(){},k$c.createChildren=function(){},k$c.initialize=function(){},k$c.callLater=function(k$a,k$b){k$p.timer.callLater(this,k$a,k$b)},k$c.runCallLater=function(k$a){k$p.timer.runCallLater(this,k$a)},k$c.commitMeasure=function(){},k$c.changeSize=function(){this.event("resize")},k$c.getLayout=function(){return this._layout===k$C.EMPTY&&(this._layout=new k$C),this._layout},k$c._setLayoutEnabled=function(k$a){this._layout&&this._layout.enable!=k$a&&(this._layout.enable=k$a,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},k$c.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},k$c.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},k$c.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},k$c.resetLayoutX=function(){var k$a=this._layout;if(isNaN(k$a.anchorX)||(this.pivotX=k$a.anchorX*this.width),this.layoutEnabled){var k$b=this.parent;k$b&&(isNaN(k$a.centerX)?isNaN(k$a.left)?isNaN(k$a.right)||(this.x=Math.round(k$b.width-this.displayWidth-k$a.right+this.pivotX*this.scaleX)):(this.x=Math.round(k$a.left+this.pivotX*this.scaleX),isNaN(k$a.right)||(this.width=(k$b._width-k$a.left-k$a.right)/(this.scaleX||.01))):this.x=Math.round(.5*(k$b.width-this.displayWidth)+k$a.centerX+this.pivotX*this.scaleX))}},k$c.resetLayoutY=function(){var k$a=this._layout;if(isNaN(k$a.anchorY)||(this.pivotY=k$a.anchorY*this.height),this.layoutEnabled){var k$b=this.parent;k$b&&(isNaN(k$a.centerY)?isNaN(k$a.top)?isNaN(k$a.bottom)||(this.y=Math.round(k$b.height-this.displayHeight-k$a.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(k$a.top+this.pivotY*this.scaleY),isNaN(k$a.bottom)||(this.height=(k$b._height-k$a.top-k$a.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(k$b.height-this.displayHeight)+k$a.centerY+this.pivotY*this.scaleY))}},k$c.onMouseOver=function(k$a){k$p.stage.event("showtip",this._toolTip)},k$c.onMouseOut=function(k$a){k$p.stage.event("hidetip",this._toolTip)},k$e(0,k$c,"displayWidth",function(){return this.width*this.scaleX}),k$e(0,k$c,"width",function(){return this._width?this._width:this.measureWidth},function(k$a){this._width!=k$a&&(this._width=k$a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),k$e(0,k$c,"measureWidth",function(){var k$a=0;this.commitMeasure();for(var k$b=this.numChildren-1;-1<k$b;k$b--){var k$c=this.getChildAt(k$b);k$c.visible&&(k$a=Math.max(k$c.x+k$c.width*k$c.scaleX,k$a))}return k$a}),k$e(0,k$c,"displayHeight",function(){return this.height*this.scaleY}),k$e(0,k$c,"height",function(){return this._height?this._height:this.measureHeight},function(k$a){this._height!=k$a&&(this._height=k$a,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),k$e(0,k$c,"dataSource",function(){return this._dataSource},function(k$a){for(var k$b in this._dataSource=k$a,this._dataSource)this.hasOwnProperty(k$b)&&"function"!=typeof this[k$b]&&(this[k$b]=this._dataSource[k$b])}),k$e(0,k$c,"scaleY",k$b.prototype._$get_scaleY,function(k$a){k$p.superGet(k$w,this,"scaleY")!=k$a&&(k$p.superSet(k$w,this,"scaleY",k$a),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),k$e(0,k$c,"measureHeight",function(){var k$a=0;this.commitMeasure();for(var k$b=this.numChildren-1;-1<k$b;k$b--){var k$c=this.getChildAt(k$b);k$c.visible&&(k$a=Math.max(k$c.y+k$c.height*k$c.scaleY,k$a))}return k$a}),k$e(0,k$c,"scaleX",k$b.prototype._$get_scaleX,function(k$a){k$p.superGet(k$w,this,"scaleX")!=k$a&&(k$p.superSet(k$w,this,"scaleX",k$a),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),k$e(0,k$c,"top",function(){return this._layout.top},function(k$a){k$a!=this._layout.top&&(this.getLayout().top=k$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),k$e(0,k$c,"bottom",function(){return this._layout.bottom},function(k$a){k$a!=this._layout.bottom&&(this.getLayout().bottom=k$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),k$e(0,k$c,"left",function(){return this._layout.left},function(k$a){k$a!=this._layout.left&&(this.getLayout().left=k$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),k$e(0,k$c,"right",function(){return this._layout.right},function(k$a){k$a!=this._layout.right&&(this.getLayout().right=k$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),k$e(0,k$c,"centerX",function(){return this._layout.centerX},function(k$a){k$a!=this._layout.centerX&&(this.getLayout().centerX=k$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),k$e(0,k$c,"centerY",function(){return this._layout.centerY},function(k$a){k$a!=this._layout.centerY&&(this.getLayout().centerY=k$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),k$e(0,k$c,"anchorX",function(){return this._layout.anchorX},function(k$a){k$a!=this._layout.anchorX&&(this.getLayout().anchorX=k$a,this._setLayoutEnabled(!0)),this.resetLayoutX()}),k$e(0,k$c,"anchorY",function(){return this._layout.anchorY},function(k$a){k$a!=this._layout.anchorY&&(this.getLayout().anchorY=k$a,this._setLayoutEnabled(!0)),this.resetLayoutY()}),k$e(0,k$c,"tag",function(){return this._tag},function(k$a){this._tag=k$a}),k$e(0,k$c,"toolTip",function(){return this._toolTip},function(k$a){this._toolTip!=k$a&&(null!=(this._toolTip=k$a)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),k$e(0,k$c,"comXml",function(){return this._comXml},function(k$a){this._comXml=k$a}),k$e(0,k$c,"gray",function(){return this._gray},function(k$a){k$a!==this._gray&&(this._gray=k$a,k$E.gray(this,k$a))}),k$e(0,k$c,"disabled",function(){return this._disabled},function(k$a){k$a!==this._disabled&&(this.gray=this._disabled=k$a,this.mouseEnabled=!k$a)}),k$a}(k$w)),k$I=function(k$a){function k$b(){this.lockLayer=null,this.popupEffect=function(k$a){k$a.scale(1,1),k$z.from(k$a,{x:k$p.stage.width/2,y:k$p.stage.height/2,scaleX:0,scaleY:0},300,k$h.backOut,k$m.create(this,this.doOpen,[k$a]))},this.closeEffect=function(k$a,k$b){k$z.to(k$a,{x:k$p.stage.width/2,y:k$p.stage.height/2,scaleX:0,scaleY:0},300,k$h.strongOut,k$m.create(this,this.doClose,[k$a,k$b]))},k$b.__super.call(this),this.maskLayer=new k$w,this.popupEffectHandler=k$m.create(this,this.popupEffect,null,!1),this.closeEffectHandler=k$m.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,k$p.stage.addChild(this),k$p.stage.on("resize",this,this._onResize),k$F.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}k$f(k$b,"laya.ui.DialogManager",k$w);var k$c=k$b.prototype;return k$c._closeOnSide=function(){var k$a=this.getChildAt(this.numChildren-1);k$a instanceof laya.ui.Dialog&&k$a.close("side")},k$c.setLockView=function(k$a){this.lockLayer||(this.lockLayer=new k$J,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(k$p.stage.width,k$p.stage.height)),this.lockLayer.removeChildren(),k$a&&(k$a.centerX=k$a.centerY=0,this.lockLayer.addChild(k$a))},k$c._onResize=function(k$a){var k$b=this.maskLayer.width=k$p.stage.width,k$c=this.maskLayer.height=k$p.stage.height;this.lockLayer&&this.lockLayer.size(k$b,k$c),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,k$b,k$c,k$F.popupBgColor),this.maskLayer.alpha=k$F.popupBgAlpha;for(var k$d=this.numChildren-1;-1<k$d;k$d--){var k$e=this.getChildAt(k$d);k$e.popupCenter&&this._centerDialog(k$e)}},k$c._centerDialog=function(k$a){k$a.x=Math.round((k$p.stage.width-k$a.width>>1)+k$a.pivotX),k$a.y=Math.round((k$p.stage.height-k$a.height>>1)+k$a.pivotY)},k$c.open=function(k$a,k$b,k$c){void 0===k$b&&(k$b=!1),void 0===k$c&&(k$c=!1),k$b&&this._closeAll(),k$a.popupCenter&&this._centerDialog(k$a),this.addChild(k$a),(k$a.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),k$c&&null!=k$a.popupEffect?k$a.popupEffect.runWith(k$a):this.doOpen(k$a),this.event("open")},k$c.doOpen=function(k$a){k$a.onOpened()},k$c.lock=function(k$a){this.lockLayer&&(k$a?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},k$c.close=function(k$a,k$b,k$c){void 0===k$c&&(k$c=!1),k$c&&null!=k$a.closeEffect?k$a.closeEffect.runWith([k$a,k$b]):this.doClose(k$a,k$b),this.event("close")},k$c.doClose=function(k$a,k$b){k$a.removeSelf(),k$a.isModal&&this._checkMask(),k$a.closeHandler&&k$a.closeHandler.runWith(k$b),k$a.onClosed(k$b)},k$c.closeAll=function(){this._closeAll(),this.event("close")},k$c._closeAll=function(){for(var k$a=this.numChildren-1;-1<k$a;k$a--){var k$b=this.getChildAt(k$a);k$b&&null!=k$b.close&&this.doClose(k$b)}},k$c.getDialogsByGroup=function(k$a){for(var k$b=[],k$c=this.numChildren-1;-1<k$c;k$c--){var k$d=this.getChildAt(k$c);k$d&&k$d.group===k$a&&k$b.push(k$d)}return k$b},k$c.closeByGroup=function(k$a){for(var k$b=[],k$c=this.numChildren-1;-1<k$c;k$c--){var k$d=this.getChildAt(k$c);k$d&&k$d.group===k$a&&(k$d.close(),k$b.push(k$d))}return k$b},k$c._checkMask=function(){this.maskLayer.removeSelf();for(var k$a=this.numChildren-1;-1<k$a;k$a--){var k$b=this.getChildAt(k$a);if(k$b&&k$b.isModal)return void this.addChildAt(this.maskLayer,k$a)}},k$b}(),k$J=function(k$a){function k$b(){k$b.__super.call(this)}k$f(k$b,"laya.ui.Box",k$a);var k$c=k$b.prototype;return k$p.imps(k$c,{"laya.ui.IBox":!0}),k$e(0,k$c,"dataSource",k$a.prototype._$get_dataSource,function(k$a){for(var k$b in this._dataSource=k$a){var k$c=this.getChildByName(k$b);k$c?k$c.dataSource=k$a[k$b]:this.hasOwnProperty(k$b)&&"function"!=typeof this[k$b]&&(this[k$b]=k$a[k$b])}}),k$b}(k$H),k$K=function(k$b){function k$c(k$a,k$b){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,k$c.__super.call(this),this._labelColors=k$D.buttonLabelColors,this._stateNum=k$D.buttonStateNum,void 0===k$b&&(k$b=""),this.skin=k$a,this.label=k$b}k$f(k$c,"laya.ui.Button",k$b);var k$a=k$c.prototype;return k$p.imps(k$a,{"laya.ui.ISelect":!0}),k$a.destroy=function(k$a){k$s.clearCache(this,this._skin),k$s.clearObject(this,this._weakKey),void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,k$a),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(k$a),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},k$a.createChildren=function(){this.graphics=this._bitmap=new k$G},k$a.createText=function(){this._text||(this._text=new k$x,this._text.overflow=k$x.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},k$a.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},k$a.onMouse=function(k$a){if(!1!==this.toggle||!this._selected)return"click"===k$a.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=k$c.stateMap[k$a.type]))},k$a.changeClips=function(){var k$a=k$s.getRes(this._skin);if(k$a&&this._skin&&""!=this._skin){k$s.clearObject(this,this._weakKey);var k$b=k$a.sourceWidth,k$c=k$a.sourceHeight/this._stateNum;k$a.$_GID||(k$a.$_GID=k$A.getGID());var k$d=k$a.$_GID+"-"+this._stateNum,k$e=k$s.findObject(k$d);if(k$A.isOkTextureList(k$e)||(k$e=null),k$e)this._weakKey=k$d,k$s.keepObject(this,this._weakKey),this._sources=k$e;else{if(this._sources=[],1===this._stateNum)this._sources.push(k$a);else for(var k$f=0;k$f<this._stateNum;k$f++){var k$g=k$y.createFromTexture(k$a,0,k$c*k$f,k$b,k$c);if(k$a.alphaTexture){var k$h=k$a.width/k$a.alphaTexture.width;k$g.alphaTexture=k$y.createFromTexture(k$a.alphaTexture,0/k$h,k$c*k$f/k$h,k$b/k$h,k$c/k$h)}this._sources.push(k$g)}k$s.saveObject(k$d,this._sources),this._weakKey=k$d,k$s.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||k$b,this._bitmap.height=this._height||k$c,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=k$b)}else console.warn("lose skin ",this._skin,this.name,this.__className)},k$a.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var k$a=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[k$a]),this.label&&(this._text.color=this._labelColors[k$a],this._strokeColors&&(this._text.strokeColor=this._strokeColors[k$a]))},k$a._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},k$e(0,k$a,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(k$a){this.createText(),this._text.strokeColor=k$a}),k$e(0,k$a,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),k$e(0,k$a,"skin",function(){return this._skin},function(k$a){this._skin!=k$a&&(k$s.clearCache(this,this._skin),this._skin=k$a,k$s.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),k$e(0,k$a,"state",function(){return this._state},function(k$a){this._state!=k$a&&(this._state=k$a,this._setStateChanged())}),k$e(0,k$a,"text",function(){return this.createText(),this._text}),k$e(0,k$a,"stateNum",function(){return this._stateNum},function(k$a){"string"==typeof k$a&&(k$a=parseInt(k$a)),this._stateNum!=k$a&&(this._stateNum=k$a<1?1:3<k$a?3:k$a,this.callLater(this.changeClips))}),k$e(0,k$a,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(k$a){this._strokeColors=k$E.fillArray(k$D.buttonLabelColors,k$a,String),this._setStateChanged()}),k$e(0,k$a,"labelColors",function(){return this._labelColors.join(",")},function(k$a){this._labelColors=k$E.fillArray(k$D.buttonLabelColors,k$a,String),this._setStateChanged()}),k$e(0,k$a,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),k$e(0,k$a,"label",function(){return this._text?this._text.text:null},function(k$a){(this._text||k$a)&&(this.createText(),this._text.text!=k$a&&(k$a&&!this._text.parent&&this.addChild(this._text),this._text.text=(k$a+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),k$e(0,k$a,"selected",function(){return this._selected},function(k$a){this._selected!=k$a&&(this._selected=k$a,this.state=this._selected?2:0,this.event("change"))}),k$e(0,k$a,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(k$a){this.createText(),this._text.padding=k$E.fillArray(k$D.labelPadding,k$a,Number)}),k$e(0,k$a,"labelSize",function(){return this.createText(),this._text.fontSize},function(k$a){this.createText(),this._text.fontSize=k$a}),k$e(0,k$a,"labelStroke",function(){return this.createText(),this._text.stroke},function(k$a){this.createText(),this._text.stroke=k$a}),k$e(0,k$a,"labelBold",function(){return this.createText(),this._text.bold},function(k$a){this.createText(),this._text.bold=k$a}),k$e(0,k$a,"labelFont",function(){return this.createText(),this._text.font},function(k$a){this.createText(),this._text.font=k$a}),k$e(0,k$a,"labelAlign",function(){return this.createText(),this._text.align},function(k$a){this.createText(),this._text.align=k$a}),k$e(0,k$a,"clickHandler",function(){return this._clickHandler},function(k$a){this._clickHandler=k$a}),k$e(0,k$a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(k$a){this._bitmap.sizeGrid=k$E.fillArray(k$D.defaultSizeGrid,k$a,Number)}),k$e(0,k$a,"width",k$b.prototype._$get_width,function(k$a){k$p.superSet(k$H,this,"width",k$a),this._autoSize&&(this._bitmap.width=k$a,this._text&&(this._text.width=k$a))}),k$e(0,k$a,"height",k$b.prototype._$get_height,function(k$a){k$p.superSet(k$H,this,"height",k$a),this._autoSize&&(this._bitmap.height=k$a,this._text&&(this._text.height=k$a))}),k$e(0,k$a,"dataSource",k$b.prototype._$get_dataSource,function(k$a){"number"==typeof(this._dataSource=k$a)||"string"==typeof k$a?this.label=k$a+"":k$p.superSet(k$H,this,"dataSource",k$a)}),k$e(0,k$a,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(k$a){this._bitmap._offset=k$a?k$E.fillArray([1,1],k$a,Number):[]}),k$d(k$c,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),k$c}(k$H),k$L=function(k$b){function k$d(k$a,k$b,k$c){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,k$d.__super.call(this),void 0===k$b&&(k$b=1),void 0===k$c&&(k$c=1),this._clipX=k$b,this._clipY=k$c,this.skin=k$a}k$f(k$d,"laya.ui.Clip",k$b);var k$a=k$d.prototype;return k$a.destroy=function(k$a){k$s.clearCache(this,this._skin),k$s.clearObject(this,this._weakKey),void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},k$a.dispose=function(){this.destroy(!0),k$p.loader.clearRes(this._skin)},k$a.createChildren=function(){this.graphics=this._bitmap=new k$G},k$a._onDisplay=function(k$a){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},k$a.changeClip=function(){if(this._clipChanged=!1,this._skin){var k$a=k$s.getRes(this._skin);k$a?this.loadComplete(this._skin,k$a):k$p.loader.load(this._skin,k$m.create(this,this.loadComplete,[this._skin]))}},k$a.loadComplete=function(k$a,k$b){if(k$a===this._skin&&k$b){k$s.clearObject(this,this._weakKey);var k$c=this._clipWidth||Math.ceil(k$b.sourceWidth/this._clipX),k$d=this._clipHeight||Math.ceil(k$b.sourceHeight/this._clipY),k$e=this._skin+k$c+k$d,k$f=k$s.findObject(k$e);if(k$A.isOkTextureList(k$f)||(k$f=null),k$f)this._weakKey=k$e,k$s.keepObject(this,this._weakKey),this._sources=k$f;else{this._sources=[];for(var k$g=0;k$g<this._clipY;k$g++)for(var k$h=0;k$h<this._clipX;k$h++){var k$i=k$y.createFromTexture(k$b,k$c*k$h,k$d*k$g,k$c,k$d);if(k$b.alphaTexture){var k$j=k$b.width/k$b.alphaTexture.width;k$i.alphaTexture=k$y.createFromTexture(k$b.alphaTexture,k$c*k$h/k$j,k$d*k$g/k$j,k$c/k$j,k$d/k$j)}this._sources.push(k$i)}k$s.saveObject(k$e,this._sources),this._weakKey=k$e,k$s.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},k$a.play=function(k$a,k$b){void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=-1),this._isPlaying=!0,this.index=k$a,this._toIndex=k$b,this._index++,k$p.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},k$a._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},k$a.stop=function(){this._isPlaying=!1,k$p.timer.clear(this,this._loop),this.event("complete")},k$a._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},k$e(0,k$a,"interval",function(){return this._interval},function(k$a){this._interval!=k$a&&(this._interval=k$a,this._isPlaying&&this.play())}),k$e(0,k$a,"skin",function(){return this._skin},function(k$a){this._skin!=k$a&&(k$s.clearCache(this,this._skin),(this._skin=k$a)?(k$s.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),k$e(0,k$a,"sources",function(){return this._sources},function(k$a){this._sources=k$a,this.index=this._index,this.event("loaded")}),k$e(0,k$a,"clipX",function(){return this._clipX},function(k$a){this._clipX=k$a||1,this._setClipChanged()}),k$e(0,k$a,"clipY",function(){return this._clipY},function(k$a){this._clipY=k$a||1,this._setClipChanged()}),k$e(0,k$a,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),k$e(0,k$a,"clipWidth",function(){return this._clipWidth},function(k$a){this._clipWidth=k$a,this._setClipChanged()}),k$e(0,k$a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(k$a){this._bitmap.sizeGrid=k$E.fillArray(k$D.defaultSizeGrid,k$a,Number)}),k$e(0,k$a,"group",function(){return this._group},function(k$a){k$a&&this._skin&&k$s.setGroup(this._skin,k$a),this._group=k$a}),k$e(0,k$a,"clipHeight",function(){return this._clipHeight},function(k$a){this._clipHeight=k$a,this._setClipChanged()}),k$e(0,k$a,"width",k$b.prototype._$get_width,function(k$a){k$p.superSet(k$H,this,"width",k$a),this._bitmap.width=k$a}),k$e(0,k$a,"height",k$b.prototype._$get_height,function(k$a){k$p.superSet(k$H,this,"height",k$a),this._bitmap.height=k$a}),k$e(0,k$a,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),k$e(0,k$a,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),k$e(0,k$a,"index",function(){return this._index},function(k$a){this._index=k$a,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[k$a]),this.event("change")}),k$e(0,k$a,"autoPlay",function(){return this._autoPlay},function(k$a){this._autoPlay!=k$a&&((this._autoPlay=k$a)?this.play():this.stop())}),k$e(0,k$a,"isPlaying",function(){return this._isPlaying},function(k$a){this._isPlaying=k$a}),k$e(0,k$a,"dataSource",k$b.prototype._$get_dataSource,function(k$a){"number"==typeof(this._dataSource=k$a)&&Math.floor(k$a)==k$a||"string"==typeof k$a?this.index=parseInt(k$a):k$p.superSet(k$H,this,"dataSource",k$a)}),k$e(0,k$a,"bitmap",function(){return this._bitmap}),k$d}(k$H),k$M=function(k$b){function k$a(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,k$a.__super.call(this)}k$f(k$a,"laya.ui.ColorPicker",k$b);var k$c=k$a.prototype;return k$c.destroy=function(k$a){void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,k$a),this._colorPanel&&this._colorPanel.destroy(k$a),this._colorButton&&this._colorButton.destroy(k$a),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},k$c.createChildren=function(){this.addChild(this._colorButton=new k$K),this._colorPanel=new k$J,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new k$w),this._colorPanel.addChild(this._colorBlock=new k$w),this._colorPanel.addChild(this._colorInput=new k$n)},k$c.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},k$c.onPanelMouseDown=function(k$a){k$a.stopPropagation()},k$c.changePanel=function(){this._panelChanged=!1;var k$a=this._colorPanel.graphics;k$a.clear(),k$a.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(k$a=this._colorTiles.graphics).clear();for(var k$b=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],k$c=0;k$c<12;k$c++)for(var k$d=0;k$d<20;k$d++){var k$e=0;k$e=0===k$d?k$b[k$c]:1===k$d?0:51*(((3*k$c+k$d/6)%3<<0)+3*(k$c/6<<0))<<16|k$d%6*51<<8|(k$c<<0)%6*51;var k$f=k$E.toColor(k$e);this._colors.push(k$f);var k$g=k$d*this._gridSize,k$h=k$c*this._gridSize;k$a.drawRect(k$g,k$h,this._gridSize,this._gridSize,k$f,"#000000")}},k$c.onColorButtonClick=function(k$a){this._colorPanel.parent?this.close():this.open()},k$c.open=function(){var k$a=this.localToGlobal(new k$o),k$b=k$a.x+this._colorPanel.width<=k$p.stage.width?k$a.x:k$p.stage.width-this._colorPanel.width,k$c=k$a.y+this._colorButton.height;k$c=k$c+this._colorPanel.height<=k$p.stage.height?k$c:k$a.y-this._colorPanel.height,this._colorPanel.pos(k$b,k$c),this._colorPanel.zOrder=1001,k$p._currentStage.addChild(this._colorPanel),k$p.stage.on("mousedown",this,this.removeColorBox)},k$c.close=function(){k$p.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},k$c.removeColorBox=function(k$a){this.close()},k$c.onColorFieldKeyDown=function(k$a){13==k$a.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),k$a.stopPropagation())},k$c.onColorInputChange=function(k$a){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},k$c.onColorTilesClick=function(k$a){this.selectedColor=this.getColorByMouse(),this.close()},k$c.onColorTilesMouseMove=function(k$a){this._colorInput.focus=!1;var k$b=this.getColorByMouse();this._colorInput.text=k$b,this.drawBlock(k$b)},k$c.getColorByMouse=function(){var k$a=this._colorTiles.getMousePoint(),k$b=Math.floor(k$a.x/this._gridSize),k$c=Math.floor(k$a.y/this._gridSize);return this._colors[20*k$c+k$b]},k$c.drawBlock=function(k$a){var k$b=this._colorBlock.graphics;k$b.clear();var k$c=k$a||"#ffffff";k$b.drawRect(0,0,50,20,k$c,this._borderColor),k$a||k$b.drawLine(0,0,50,20,"#ff0000")},k$c.changeColor=function(){var k$a=this.graphics;k$a.clear();var k$b=this._selectedColor||"#000000";k$a.drawRect(0,0,this._colorButton.width,this._colorButton.height,k$b)},k$c._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},k$e(0,k$c,"inputBgColor",function(){return this._inputBgColor},function(k$a){this._inputBgColor=k$a,this._setPanelChanged()}),k$e(0,k$c,"selectedColor",function(){return this._selectedColor},function(k$a){this._selectedColor!=k$a&&(this._selectedColor=this._colorInput.text=k$a,this.drawBlock(k$a),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",k$i.EMPTY.setTo("change",this,this)))}),k$e(0,k$c,"skin",function(){return this._colorButton.skin},function(k$a){this._colorButton.skin=k$a,this.changeColor()}),k$e(0,k$c,"bgColor",function(){return this._bgColor},function(k$a){this._bgColor=k$a,this._setPanelChanged()}),k$e(0,k$c,"borderColor",function(){return this._borderColor},function(k$a){this._borderColor=k$a,this._setPanelChanged()}),k$e(0,k$c,"inputColor",function(){return this._inputColor},function(k$a){this._inputColor=k$a,this._setPanelChanged()}),k$a}(k$H),k$N=function(k$b){function k$c(k$a,k$b){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,k$c.__super.call(this),this._itemColors=k$D.comboBoxItemColors,this.skin=k$a,this.labels=k$b}k$f(k$c,"laya.ui.ComboBox",k$b);var k$a=k$c.prototype;return k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,k$a),this._button&&this._button.destroy(k$a),this._list&&this._list.destroy(k$a),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},k$a.createChildren=function(){this.addChild(this._button=new k$K),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},k$a._createList=function(){this._list=new k$X,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},k$a._setListEvent=function(k$a){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=k$m.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},k$a.onListDown=function(k$a){k$a.stopPropagation()},k$a.onScrollBarDown=function(k$a){k$a.stopPropagation()},k$a.onButtonMouseDown=function(k$a){this.callLater(this.switchTo,[!this._isOpen])},k$a.changeList=function(){this._listChanged=!1;var k$a=this.width-2,k$b=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:k$a,height:this._itemHeight,fontSize:this._itemSize,color:k$b}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},k$a.onlistItemMouse=function(k$a,k$b){var k$c=k$a.type;if("mouseover"===k$c||"mouseout"===k$c){if(this._isCustomList)return;var k$d=this._list.getCell(k$b);if(!k$d)return;var k$e=k$d.getChildByName("label");k$e&&("mouseover"===k$c?(k$e.bgColor=this._itemColors[0],k$e.color=this._itemColors[1]):(k$e.bgColor=null,k$e.color=this._itemColors[2]))}else"click"===k$c&&(this.selectedIndex=k$b,this.isOpen=!1)},k$a.switchTo=function(k$a){this.isOpen=k$a},k$a.changeOpen=function(){this.isOpen=!this._isOpen},k$a.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var k$a=this._list.graphics;k$a.clear(),k$a.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var k$b=this._list.array||[],k$c=k$b.length=0,k$d=this._labels.length;k$c<k$d;k$c++)k$b.push({label:this._labels[k$c]});this._list.height=this._listHeight,this._list.array=k$b},k$a.changeSelected=function(){this._button.label=this.selectedLabel},k$a._onStageMouseWheel=function(k$a){this._list&&!this._list.contains(k$a.target)&&this.removeList(null)},k$a.removeList=function(k$a){k$p.stage.off("mousedown",this,this.removeList),k$p.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},k$e(0,k$a,"selectedIndex",function(){return this._selectedIndex},function(k$a){this._selectedIndex!=k$a&&(this._selectedIndex=k$a,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[k$i.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),k$e(0,k$a,"measureHeight",function(){return this._button.height}),k$e(0,k$a,"skin",function(){return this._button.skin},function(k$a){this._button.skin!=k$a&&(this._button.skin=k$a,this._listChanged=!0)}),k$e(0,k$a,"measureWidth",function(){return this._button.width}),k$e(0,k$a,"width",k$b.prototype._$get_width,function(k$a){k$p.superSet(k$H,this,"width",k$a),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),k$e(0,k$a,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(k$a){this.selectedIndex=this._labels.indexOf(k$a)}),k$e(0,k$a,"labels",function(){return this._labels.join(",")},function(k$a){0<this._labels.length&&(this.selectedIndex=-1),k$a?this._labels=k$a.split(","):this._labels.length=0,this._itemChanged=!0}),k$e(0,k$a,"height",k$b.prototype._$get_height,function(k$a){k$p.superSet(k$H,this,"height",k$a),this._button.height=this._height}),k$e(0,k$a,"selectHandler",function(){return this._selectHandler},function(k$a){this._selectHandler=k$a}),k$e(0,k$a,"visibleNum",function(){return this._visibleNum},function(k$a){this._visibleNum=k$a,this._listChanged=!0}),k$e(0,k$a,"labelBold",function(){return this._button.text.bold},function(k$a){this._button.text.bold=k$a}),k$e(0,k$a,"itemColors",function(){return String(this._itemColors)},function(k$a){this._itemColors=k$E.fillArray(this._itemColors,k$a,String),this._listChanged=!0}),k$e(0,k$a,"itemSize",function(){return this._itemSize},function(k$a){this._itemSize=k$a,this._listChanged=!0}),k$e(0,k$a,"scrollBar",function(){return this.list.scrollBar}),k$e(0,k$a,"isOpen",function(){return this._isOpen},function(k$a){if(this._isOpen!=k$a)if(this._isOpen=k$a,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var k$b=this.localToGlobal(k$o.TEMP.setTo(0,0)),k$c=k$b.y+this._button.height;k$c=k$c+this._listHeight<=k$p.stage.height?k$c:k$b.y-this._listHeight,this._list.pos(k$b.x,k$c),this._list.zOrder=1001,k$p._currentStage.addChild(this._list),k$p.stage.once("mousedown",this,this.removeList),k$p.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),k$e(0,k$a,"scrollBarSkin",function(){return this._scrollBarSkin},function(k$a){this._scrollBarSkin=k$a}),k$e(0,k$a,"sizeGrid",function(){return this._button.sizeGrid},function(k$a){this._button.sizeGrid=k$a}),k$e(0,k$a,"button",function(){return this._button}),k$e(0,k$a,"list",function(){return this._list||this._createList(),this._list},function(k$a){k$a&&(k$a.removeSelf(),this._isCustomList=!0,this._list=k$a,this._setListEvent(k$a),this._itemHeight=k$a.getCell(0).height+k$a.spaceY)}),k$e(0,k$a,"dataSource",k$b.prototype._$get_dataSource,function(k$a){"number"==typeof(this._dataSource=k$a)&&Math.floor(k$a)==k$a||"string"==typeof k$a?this.selectedIndex=parseInt(k$a):k$a instanceof Array?this.labels=k$a.join(","):k$p.superSet(k$H,this,"dataSource",k$a)}),k$e(0,k$a,"labelColors",function(){return this._button.labelColors},function(k$a){this._button.labelColors!=k$a&&(this._button.labelColors=k$a)}),k$e(0,k$a,"labelPadding",function(){return this._button.text.padding.join(",")},function(k$a){this._button.text.padding=k$E.fillArray(k$D.labelPadding,k$a,Number)}),k$e(0,k$a,"labelSize",function(){return this._button.text.fontSize},function(k$a){this._button.text.fontSize=k$a}),k$e(0,k$a,"labelFont",function(){return this._button.text.font},function(k$a){this._button.text.font=k$a}),k$e(0,k$a,"stateNum",function(){return this._button.stateNum},function(k$a){this._button.stateNum=k$a}),k$c}(k$H),k$O=function(k$b){function k$c(k$a){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,k$c.__super.call(this),this._showButtons=k$F.showButtons,this._touchScrollEnable=k$F.touchScrollEnable,this._mouseWheelEnable=k$F.mouseWheelEnable,this.skin=k$a,this.max=1}k$f(k$c,"laya.ui.ScrollBar",k$b);var k$a=k$c.prototype;return k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),this.stopScroll(),this.target=null,k$b.prototype.destroy.call(this,k$a),this.upButton&&this.upButton.destroy(k$a),this.downButton&&this.downButton.destroy(k$a),this.slider&&this.slider.destroy(k$a),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},k$a.createChildren=function(){this.addChild(this.slider=new k$P),this.addChild(this.upButton=new k$K),this.addChild(this.downButton=new k$K)},k$a.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},k$a.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},k$a.onButtonMouseDown=function(k$a){var k$b=k$a.currentTarget===this.upButton;this.slide(k$b),k$p.timer.once(k$D.scrollBarDelayTime,this,this.startLoop,[k$b]),k$p.stage.once("mouseup",this,this.onStageMouseUp)},k$a.startLoop=function(k$a){k$p.timer.frameLoop(1,this,this.slide,[k$a])},k$a.slide=function(k$a){k$a?this.value-=this._scrollSize:this.value+=this._scrollSize},k$a.onStageMouseUp=function(k$a){k$p.timer.clear(this,this.startLoop),k$p.timer.clear(this,this.slide)},k$a.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},k$a.changeSize=function(){k$b.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},k$a.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},k$a.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},k$a.setScroll=function(k$a,k$b,k$c){this.runCallLater(this.changeSize),this.slider.setSlider(k$a,k$b,k$c),this.slider.bar.visible=0<k$b,!this._hide&&this.autoHide&&(this.visible=!1)},k$a.onTargetMouseWheel=function(k$a){this.value-=k$a.delta*this._scrollSize,this.target=this._target},k$a.onTargetMouseDown=function(k$a){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new k$o),this._lastPoint.setTo(k$p.stage.mouseX,k$p.stage.mouseY),k$p.timer.clear(this,this.tweenMove),k$z.clearTween(this),k$p.stage.once("mouseup",this,this.onStageMouseUp2),k$p.stage.once("mouseout",this,this.onStageMouseUp2),k$p.timer.frameLoop(1,this,this.loop)},k$a.loop=function(){var k$a=k$p.stage.mouseY,k$b=k$p.stage.mouseX;if(this._lastOffset=this.isVertical?k$a-this._lastPoint.y:k$b-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?k$p.stage._canvasTransform.getScaleY():k$p.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=k$b,this._lastPoint.y=k$a,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},k$a.onStageMouseUp2=function(k$a){if(k$p.stage.off("mouseup",this,this.onStageMouseUp2),k$p.stage.off("mouseout",this,this.onStageMouseUp2),k$p.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?k$z.to(this,{value:this.min},this.elasticBackTime,k$h.sineOut,k$m.create(this,this.elasticOver)):this._value>this.max&&k$z.to(this,{value:this.max},this.elasticBackTime,k$h.sineOut,k$m.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?k$p.stage.mouseY-this._lastPoint.y:k$p.stage.mouseX-this._lastPoint.x);for(var k$b=0,k$c=Math.min(this._offsets.length,3),k$d=0;k$d<k$c;k$d++)k$b+=this._offsets[this._offsets.length-1-k$d];if(this._lastOffset=k$b/k$c,(k$b=Math.abs(this._lastOffset))<2)return void this.event("end");60<k$b&&(this._lastOffset=0<this._lastOffset?60:-60);var k$e=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));k$p.timer.frameLoop(1,this,this.tweenMove,[k$e])}},k$a.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&k$z.to(this,{alpha:0},500),this.event("end")},k$a.tweenMove=function(k$a){this._lastOffset*=this.rollRatio;var k$b=NaN;if(0<k$a&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,k$b=.5*-(this.min-k$a-this.value),this._lastOffset>k$b&&(this._lastOffset=k$b)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,k$b=.5*-(this.max+k$a-this.value),this._lastOffset<k$b&&(this._lastOffset=k$b))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(k$p.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?k$z.to(this,{value:this.min},this.elasticBackTime,k$h.sineOut,k$m.create(this,this.elasticOver)):this._value>this.max?k$z.to(this,{value:this.max},this.elasticBackTime,k$h.sineOut,k$m.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&k$z.to(this,{alpha:0},500)}},k$a.stopScroll=function(){this.onStageMouseUp2(null),k$p.timer.clear(this,this.tweenMove),k$z.clearTween(this)},k$e(0,k$a,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),k$e(0,k$a,"skin",function(){return this._skin},function(k$a){this._skin!=k$a&&(this._skin=k$a,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),k$e(0,k$a,"max",function(){return this.slider.max},function(k$a){this.slider.max=k$a}),k$e(0,k$a,"showButtons",function(){return this._showButtons},function(k$a){this._showButtons=k$a,this.callLater(this.changeScrollBar)}),k$e(0,k$a,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),k$e(0,k$a,"min",function(){return this.slider.min},function(k$a){this.slider.min=k$a}),k$e(0,k$a,"value",function(){return this._value},function(k$a){k$a!==this._value&&(this._value=k$a,this._isElastic||(this.slider._value!=k$a&&(this.slider._value=k$a,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),k$e(0,k$a,"isVertical",function(){return this.slider.isVertical},function(k$a){this.slider.isVertical=k$a}),k$e(0,k$a,"sizeGrid",function(){return this.slider.sizeGrid},function(k$a){this.slider.sizeGrid=k$a}),k$e(0,k$a,"scrollSize",function(){return this._scrollSize},function(k$a){this._scrollSize=k$a}),k$e(0,k$a,"dataSource",k$b.prototype._$get_dataSource,function(k$a){"number"==typeof(this._dataSource=k$a)||"string"==typeof k$a?this.value=Number(k$a):k$p.superSet(k$H,this,"dataSource",k$a)}),k$e(0,k$a,"thumbPercent",function(){return this._thumbPercent},function(k$a){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),k$a=1<=k$a?.99:k$a,this._thumbPercent=k$a,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*k$a,k$D.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*k$a,k$D.scrollBarMinNum))}),k$e(0,k$a,"target",function(){return this._target},function(k$a){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=k$a)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),k$e(0,k$a,"hide",function(){return this._hide},function(k$a){this._hide=k$a,this.visible=!k$a}),k$e(0,k$a,"touchScrollEnable",function(){return this._touchScrollEnable},function(k$a){this._touchScrollEnable=k$a,this.target=this._target}),k$e(0,k$a,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(k$a){this._mouseWheelEnable=k$a,this.target=this._target}),k$e(0,k$a,"tick",function(){return this.slider.tick},function(k$a){this.slider.tick=k$a}),k$c}(k$H),k$P=function(k$b){function k$c(k$a){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,k$c.__super.call(this),this.skin=k$a}k$f(k$c,"laya.ui.Slider",k$b);var k$a=k$c.prototype;return k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,k$a),this._bg&&this._bg.destroy(k$a),this._bar&&this._bar.destroy(k$a),this._progress&&this._progress.destroy(k$a),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},k$a.createChildren=function(){this.addChild(this._bg=new k$Q),this.addChild(this._bar=new k$K)},k$a.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},k$a.onBarMouseDown=function(k$a){this._globalSacle||(this._globalSacle=new k$o),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=k$p.stage.mouseX,this._ty=k$p.stage.mouseY,k$p.stage.on("mousemove",this,this.mouseMove),k$p.stage.once("mouseup",this,this.mouseUp),k$p.stage.once("mouseout",this,this.mouseUp),this.showValueText()},k$a.showValueText=function(){if(this.showLabel){var k$a=laya.ui.Slider.label;this.addChild(k$a),k$a.textField.changeText(this._value+""),this.isVertical?(k$a.x=this._bar.x+20,k$a.y=.5*(this._bar.height-k$a.height)+this._bar.y):(k$a.y=this._bar.y-20,k$a.x=.5*(this._bar.width-k$a.width)+this._bar.x)}},k$a.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},k$a.mouseUp=function(k$a){k$p.stage.off("mousemove",this,this.mouseMove),k$p.stage.off("mouseup",this,this.mouseUp),k$p.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},k$a.mouseMove=function(k$a){var k$b=this._value;this.isVertical?(this._bar.y+=(k$p.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(k$p.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=k$p.stage.mouseX,this._ty=k$p.stage.mouseY;var k$c=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*k$c)/k$c,this._value!=k$b&&this.sendChangeEvent(),this.showValueText()},k$a.sendChangeEvent=function(k$a){void 0===k$a&&(k$a="change"),this.event(k$a),this.changeHandler&&this.changeHandler.runWith(this._value)},k$a.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},k$a.changeSize=function(){k$b.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},k$a.setSlider=function(k$a,k$b,k$c){this._value=-1,this._min=k$a,this._max=k$a<k$b?k$b:k$a,this.value=k$c<k$a?k$a:k$b<k$c?k$b:k$c},k$a.changeValue=function(){var k$a=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*k$a)/k$a,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var k$b=this._max-this._min;0===k$b&&(k$b=1),this.isVertical?(this._bar.y=(this._value-this._min)/k$b*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/k$b*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},k$a.onBgMouseDown=function(k$a){var k$b=this._bg.getMousePoint();this.isVertical?this.value=k$b.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=k$b.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},k$e(0,k$a,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),k$e(0,k$a,"skin",function(){return this._skin},function(k$a){if(this._skin!=k$a){this._skin=k$a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var k$b=this._skin.replace(".png","$progress.png");k$s.getRes(k$b)&&(this._progress||(this.addChild(this._progress=new k$Q),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=k$b),this.setBarPoint(),this.callLater(this.changeValue)}}),k$e(0,k$a,"allowClickBack",function(){return this._allowClickBack},function(k$a){this._allowClickBack!=k$a&&((this._allowClickBack=k$a)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),k$e(0,k$a,"max",function(){return this._max},function(k$a){this._max!=k$a&&(this._max=k$a,this.callLater(this.changeValue))}),k$e(0,k$a,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),k$e(0,k$a,"tick",function(){return this._tick},function(k$a){this._tick!=k$a&&(this._tick=k$a,this.callLater(this.changeValue))}),k$e(0,k$a,"sizeGrid",function(){return this._bg.sizeGrid},function(k$a){this._bg.sizeGrid=k$a,this._bar.sizeGrid=k$a,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),k$e(0,k$a,"min",function(){return this._min},function(k$a){this._min!=k$a&&(this._min=k$a,this.callLater(this.changeValue))}),k$e(0,k$a,"value",function(){return this._value},function(k$a){if(this._value!=k$a){var k$b=this._value;this._value=k$a,this.changeValue(),this._value!=k$b&&this.sendChangeEvent()}}),k$e(0,k$a,"dataSource",k$b.prototype._$get_dataSource,function(k$a){"number"==typeof(this._dataSource=k$a)||"string"==typeof k$a?this.value=Number(k$a):k$p.superSet(k$H,this,"dataSource",k$a)}),k$e(0,k$a,"bar",function(){return this._bar}),k$d(k$c,["label",function(){return this.label=new k$R}]),k$c}(k$H),k$Q=function(k$b){function k$c(k$a){this._bitmap=null,this._skin=null,this._group=null,k$c.__super.call(this),this.skin=k$a}k$f(k$c,"laya.ui.Image",k$b);var k$a=k$c.prototype;return k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,k$s.clearCache(this,this._skin)},k$a.dispose=function(){this.destroy(!0),k$s.clearCache(this,this._skin)},k$a.createChildren=function(){this.graphics=this._bitmap=new k$G},k$a.setSource=function(k$a,k$b){k$a===this._skin&&k$b&&(this.source=k$b,this.onCompResize())},k$e(0,k$a,"source",function(){return this._bitmap.source},function(k$a){this._bitmap&&(this._bitmap.source=k$a,this.event("loaded"),this.repaint())}),k$e(0,k$a,"dataSource",k$b.prototype._$get_dataSource,function(k$a){"string"==typeof(this._dataSource=k$a)?this.skin=k$a:k$p.superSet(k$H,this,"dataSource",k$a)}),k$e(0,k$a,"measureHeight",function(){return this._bitmap.height}),k$e(0,k$a,"skin",function(){return this._skin},function(k$a){if(this._skin!=k$a)if(k$s.clearCache(this,this._skin),this._skin=k$a){k$s.keepCache(this,this._skin);var k$b=k$s.getRes(k$a);k$b?(this.source=k$b,this.onCompResize()):k$p.loader.load(this._skin,k$m.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),k$e(0,k$a,"group",function(){return this._group},function(k$a){k$a&&this._skin&&k$s.setGroup(this._skin,k$a),this._group=k$a}),k$e(0,k$a,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(k$a){this._bitmap.sizeGrid=k$E.fillArray(k$D.defaultSizeGrid,k$a,Number)}),k$e(0,k$a,"measureWidth",function(){return this._bitmap.width}),k$e(0,k$a,"width",k$b.prototype._$get_width,function(k$a){k$p.superSet(k$H,this,"width",k$a),this._bitmap.width=0==k$a?1e-7:k$a}),k$e(0,k$a,"height",k$b.prototype._$get_height,function(k$a){k$p.superSet(k$H,this,"height",k$a),this._bitmap.height=0==k$a?1e-7:k$a}),k$c}(k$H),k$R=function(k$b){function k$c(k$a){this._tf=null,k$c.__super.call(this),void 0===k$a&&(k$a=""),k$j.defaultColor=k$D.labelColor,this.text=k$a}k$f(k$c,"laya.ui.Label",k$b);var k$a=k$c.prototype;return k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,k$a),this._tf=null},k$a.createChildren=function(){this.addChild(this._tf=new k$x)},k$a.changeText=function(k$a){this._tf.changeText(k$a)},k$e(0,k$a,"padding",function(){return this._tf.padding.join(",")},function(k$a){this._tf.padding=k$E.fillArray(k$D.labelPadding,k$a,Number)}),k$e(0,k$a,"bold",function(){return this._tf.bold},function(k$a){this._tf.bold=k$a}),k$e(0,k$a,"align",function(){return this._tf.align},function(k$a){this._tf.align=k$a}),k$e(0,k$a,"text",function(){return this._tf.text},function(k$a){this._tf.text!=k$a&&(k$a&&(k$a=k$E.adptString(k$a+"")),this._tf.text=k$a,this.event("change"),this._width&&this._height||this.onCompResize())}),k$e(0,k$a,"italic",function(){return this._tf.italic},function(k$a){this._tf.italic=k$a}),k$e(0,k$a,"wordWrap",function(){return this._tf.wordWrap},function(k$a){this._tf.wordWrap=k$a}),k$e(0,k$a,"font",function(){return this._tf.font},function(k$a){this._tf.font=k$a}),k$e(0,k$a,"dataSource",k$b.prototype._$get_dataSource,function(k$a){"number"==typeof(this._dataSource=k$a)||"string"==typeof k$a?this.text=k$a+"":k$p.superSet(k$H,this,"dataSource",k$a)}),k$e(0,k$a,"color",function(){return this._tf.color},function(k$a){this._tf.color=k$a}),k$e(0,k$a,"valign",function(){return this._tf.valign},function(k$a){this._tf.valign=k$a}),k$e(0,k$a,"leading",function(){return this._tf.leading},function(k$a){this._tf.leading=k$a}),k$e(0,k$a,"fontSize",function(){return this._tf.fontSize},function(k$a){this._tf.fontSize=k$a}),k$e(0,k$a,"bgColor",function(){return this._tf.bgColor},function(k$a){this._tf.bgColor=k$a}),k$e(0,k$a,"borderColor",function(){return this._tf.borderColor},function(k$a){this._tf.borderColor=k$a}),k$e(0,k$a,"stroke",function(){return this._tf.stroke},function(k$a){this._tf.stroke=k$a}),k$e(0,k$a,"strokeColor",function(){return this._tf.strokeColor},function(k$a){this._tf.strokeColor=k$a}),k$e(0,k$a,"textField",function(){return this._tf}),k$e(0,k$a,"measureWidth",function(){return this._tf.width}),k$e(0,k$a,"measureHeight",function(){return this._tf.height}),k$e(0,k$a,"width",function(){return this._width||this._tf.text?k$p.superGet(k$H,this,"width"):0},function(k$a){k$p.superSet(k$H,this,"width",k$a),this._tf.width=k$a}),k$e(0,k$a,"height",function(){return this._height||this._tf.text?k$p.superGet(k$H,this,"height"):0},function(k$a){k$p.superSet(k$H,this,"height",k$a),this._tf.height=k$a}),k$e(0,k$a,"overflow",function(){return this._tf.overflow},function(k$a){this._tf.overflow=k$a}),k$e(0,k$a,"underline",function(){return this._tf.underline},function(k$a){this._tf.underline=k$a}),k$e(0,k$a,"underlineColor",function(){return this._tf.underlineColor},function(k$a){this._tf.underlineColor=k$a}),k$c}(k$H),k$S=function(k$b){function k$c(k$a){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,k$c.__super.call(this),this.skin=k$a}k$f(k$c,"laya.ui.ProgressBar",k$b);var k$a=k$c.prototype;return k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,k$a),this._bg&&this._bg.destroy(k$a),this._bar&&this._bar.destroy(k$a),this._bg=this._bar=null,this.changeHandler=null},k$a.createChildren=function(){this.addChild(this._bg=new k$Q),this.addChild(this._bar=new k$Q)},k$a.changeValue=function(){if(this.sizeGrid){var k$a=this.sizeGrid.split(","),k$b=Number(k$a[3]),k$c=Number(k$a[1]),k$d=(this.width-k$b-k$c)*this._value;this._bar.width=k$b+k$c+k$d,this._bar.visible=this._bar.width>k$b+k$c}else this._bar.width=this.width*this._value},k$e(0,k$a,"measureHeight",function(){return this._bg.height}),k$e(0,k$a,"skin",function(){return this._skin},function(k$a){this._skin!=k$a&&(this._skin=k$a,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),k$e(0,k$a,"measureWidth",function(){return this._bg.width}),k$e(0,k$a,"height",k$b.prototype._$get_height,function(k$a){k$p.superSet(k$H,this,"height",k$a),this._bg.height=this._height,this._bar.height=this._height}),k$e(0,k$a,"bar",function(){return this._bar}),k$e(0,k$a,"value",function(){return this._value},function(k$a){this._value!=k$a&&(k$a=1<k$a?1:k$a<0?0:k$a,this._value=k$a,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(k$a))}),k$e(0,k$a,"bg",function(){return this._bg}),k$e(0,k$a,"sizeGrid",function(){return this._bg.sizeGrid},function(k$a){this._bg.sizeGrid=this._bar.sizeGrid=k$a}),k$e(0,k$a,"width",k$b.prototype._$get_width,function(k$a){k$p.superSet(k$H,this,"width",k$a),this._bg.width=this._width,this.callLater(this.changeValue)}),k$e(0,k$a,"dataSource",k$b.prototype._$get_dataSource,function(k$a){"number"==typeof(this._dataSource=k$a)||"string"==typeof k$a?this.value=Number(k$a):k$p.superSet(k$H,this,"dataSource",k$a)}),k$c}(k$H),k$T=(function(k$a){function k$c(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,k$c.__super.call(this),this._tipBox=new k$H,this._tipBox.addChild(this._tipText=new k$x),this._tipText.x=this._tipText.y=5,this._tipText.color=k$c.tipTextColor,this._defaultTipHandler=this._showDefaultTip,k$p.stage.on("showtip",this,this._onStageShowTip),k$p.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}k$f(k$c,"laya.ui.TipManager",k$H);var k$b=k$c.prototype;k$b._onStageHideTip=function(k$a){k$p.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},k$b._onStageShowTip=function(k$a){k$p.timer.once(k$c.tipDelay,this,this._showTip,[k$a],!0)},k$b._showTip=function(k$a){if("string"==typeof k$a){var k$b=String(k$a);Boolean(k$b)&&this._defaultTipHandler(k$b)}else k$a instanceof laya.utils.Handler?k$a.run():"function"==typeof k$a&&k$a.apply();k$p.stage.on("mousemove",this,this._onStageMouseMove),k$p.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},k$b._onStageMouseDown=function(k$a){this.closeAll()},k$b._onStageMouseMove=function(k$a){this._showToStage(this,k$c.offsetX,k$c.offsetY)},k$b._showToStage=function(k$a,k$b,k$c){void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0);var k$d=k$a.getBounds();k$a.x=k$p.stage.mouseX+k$b,k$a.y=k$p.stage.mouseY+k$c,k$a.x+k$d.width>k$p.stage.width&&(k$a.x-=k$d.width+k$b),k$a.y+k$d.height>k$p.stage.height&&(k$a.y-=k$d.height+k$c)},k$b.closeAll=function(){k$p.timer.clear(this,this._showTip),k$p.stage.off("mousemove",this,this._onStageMouseMove),k$p.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},k$b.showDislayTip=function(k$a){this.addChild(k$a),this._showToStage(this),k$p._currentStage.addChild(this)},k$b._showDefaultTip=function(k$a){this._tipText.text=k$a;var k$b=this._tipBox.graphics;k$b.clear(),k$b.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,k$c.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),k$p._currentStage.addChild(this)},k$e(0,k$b,"defaultTipHandler",function(){return this._defaultTipHandler},function(k$a){this._defaultTipHandler=k$a}),k$c.offsetX=10,k$c.offsetY=15,k$c.tipTextColor="#ffffff",k$c.tipBackColor="#111111",k$c.tipDelay=200}(),function(k$a){var k$n;function k$o(){this._idMap=null,this._aniList=null,this._watchMap={},k$o.__super.call(this)}k$f(k$o,"laya.ui.View",k$J);var k$b=k$o.prototype;return k$b.createView=function(k$a){if(k$a.animations&&!this._idMap&&(this._idMap={}),k$o.createComp(k$a,this,this),k$a.animations){var k$b,k$c,k$d=[],k$e=k$a.animations,k$f=0,k$g=k$e.length;for(k$f=0;k$f<k$g;k$f++){switch(k$b=new k$k,k$c=k$e[k$f],k$b._setUp(this._idMap,k$c),(this[k$c.name]=k$b)._setControlNode(this),k$c.action){case 1:k$b.play(0,!1);break;case 2:k$b.play(0,!0)}k$d.push(k$b)}this._aniList=k$d}0<this._width&&null==k$a.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},k$b.onEvent=function(k$a,k$b){},k$b.loadUI=function(k$a){var k$b=k$o.uiMap[k$a];k$b&&this.createView(k$b)},k$b.destroy=function(k$a){void 0===k$a&&(k$a=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,k$a)},k$b.changeData=function(k$a){var k$b=this._watchMap[k$a];if(k$b){console.log("change",k$a);for(var k$c=0,k$d=k$b.length;k$c<k$d;k$c++){k$b[k$c].exe(this)}}},k$o._regs=function(){for(var k$a in k$o.uiClassMap)k$q.regClass(k$a,k$o.uiClassMap[k$a])},k$o.createComp=function(k$a,k$b,k$c,k$d){if(!(k$b=k$b||k$o.getCompInstance(k$a)))return console.warn("can not create:"+k$a.type),null;var k$e=k$a.child;if(k$e)for(var k$f=k$b instanceof laya.ui.List,k$g=0,k$h=k$e.length;k$g<k$h;k$g++){var k$i=k$e[k$g];if(!k$b.hasOwnProperty("itemRender")||"render"!=k$i.props.name&&"render"!==k$i.props.renderType)if("Graphic"==k$i.type)k$q.addGraphicsToSprite(k$i,k$b);else if(k$q.isDrawType(k$i.type))k$q.addGraphicToSprite(k$i,k$b,!0);else{if(k$f){var k$j=[],k$k=k$o.createComp(k$i,null,k$c,k$j);k$j.length&&(k$k._$bindData=k$j)}else k$k=k$o.createComp(k$i,null,k$c,k$d);"Script"==k$i.type?"owner"in k$k?k$k.owner=k$b:"target"in k$k&&(k$k.target=k$b):"mask"==k$i.props.renderType||"mask"==k$i.props.name?k$b.mask=k$k:k$k instanceof laya.display.Sprite&&k$b.addChild(k$k)}else k$b.itemRender=k$i}var k$l=k$a.props;for(var k$m in k$l){var k$n=k$l[k$m];k$o.eventDic[k$m]?k$n&&k$c&&k$b.on(k$m,k$c,k$c.onEvent,[k$n]):k$o.setCompValue(k$b,k$m,k$n,k$c,k$d)}return k$p.__typeof(k$b,"laya.ui.IItem")&&k$b.initItems(),k$a.compId&&k$c&&k$c._idMap&&(k$c._idMap[k$a.compId]=k$b),k$b},k$o.setCompValue=function(k$a,k$b,k$c,k$d,k$e){if("string"==typeof k$c&&-1<k$c.indexOf("${")){if(k$o._sheet||(k$o._sheet=k$q.getClass("laya.data.Table")),!k$o._sheet)return void console.warn("Can not find class Sheet");if(k$e)k$e.push(k$a,k$b,k$c);else if(k$d){-1==k$c.indexOf("].")&&(k$c=k$c.replace(".","[0]."));var k$f,k$g,k$h=new k$n(k$a,k$b,k$c);k$h.exe(k$d);for(var k$i=k$c.replace(/\[.*?\]\./g,".");null!=(k$f=k$o._parseWatchData.exec(k$i));){for(var k$j=k$f[1];null!=(k$g=k$o._parseKeyWord.exec(k$j));){var k$k=k$g[0],k$l=k$d._watchMap[k$k]||(k$d._watchMap[k$k]=[]);k$l.push(k$h),k$o._sheet.I.notifer.on(k$k,k$d,k$d.changeData,[k$k])}(k$l=k$d._watchMap[k$j]||(k$d._watchMap[k$j]=[])).push(k$h),k$o._sheet.I.notifer.on(k$j,k$d,k$d.changeData,[k$j])}}}else if("var"===k$b&&k$d)k$d[k$c]=k$a;else if("onClick"==k$b){var k$m=k$p._runScript("(function(){"+k$c+"})");k$a.on("click",k$d,k$m)}else k$a[k$b]="true"===k$c||"false"!==k$c&&k$c},k$o.getCompInstance=function(k$a){var k$b,k$c=k$a.props?k$a.props.runtime:null;return k$b=k$c?k$o.viewClassMap[k$c]||k$o.uiClassMap[k$c]||k$p.__classmap[k$c]:k$o.uiClassMap[k$a.type],k$a.props&&k$a.props.hasOwnProperty("renderType")&&"instance"==k$a.props.renderType?k$b.instance:k$b?new k$b:null},k$o.regComponent=function(k$a,k$b){k$o.uiClassMap[k$a]=k$b,k$q.regClass(k$a,k$b)},k$o.regViewRuntime=function(k$a,k$b){k$o.viewClassMap[k$a]=k$b},k$o.uiMap={},k$o.viewClassMap={},k$o._sheet=null,k$d(k$o,["uiClassMap",function(){return this.uiClassMap={ViewStack:k$aa,LinkButton:k$K,TextArea:k$ja,ColorPicker:k$M,Box:k$J,Button:k$K,CheckBox:k$U,Clip:k$L,ComboBox:k$N,Component:k$H,HScrollBar:k$Y,HSlider:k$$,Image:k$Q,Label:k$R,List:k$X,Panel:k$Z,ProgressBar:k$S,Radio:k$u,RadioGroup:k$ha,ScrollBar:k$O,Slider:k$P,Tab:k$ia,TextInput:k$ca,View:k$o,VScrollBar:k$ba,VSlider:k$da,Tree:k$v,HBox:k$fa,VBox:k$ga,Sprite:k$w,Animation:k$c,Text:k$x,FontClip:k$W}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),k$o.__init$=function(){k$o._regs(),k$n=function(){function k$a(k$a,k$b,k$c){this.comp=null,this.prop=null,this.value=null,this.comp=k$a,this.prop=k$b,this.value=k$c}return k$f(k$a,""),k$a.prototype.exe=function(k$a){var k$b=k$E.getBindFun(this.value);this.comp[this.prop]=k$b.call(this,k$a)},k$a}()},k$o}()),k$U=function(k$a){function k$c(k$a,k$b){void 0===k$b&&(k$b=""),k$c.__super.call(this,k$a,k$b)}k$f(k$c,"laya.ui.CheckBox",k$a);var k$b=k$c.prototype;return k$b.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},k$b.initialize=function(){k$a.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},k$e(0,k$b,"dataSource",k$a.prototype._$get_dataSource,function(k$a){"boolean"==typeof(this._dataSource=k$a)?this.selected=k$a:"string"==typeof k$a?this.selected="true"===k$a:k$p.superSet(k$K,this,"dataSource",k$a)}),k$c}(k$K),k$V=function(k$a){function k$b(){this._space=0,this._align="none",this._itemChanged=!1,k$b.__super.call(this)}k$f(k$b,"laya.ui.LayoutBox",k$J);var k$c=k$b.prototype;return k$c.addChild=function(k$a){return k$a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,k$a)},k$c.onResize=function(k$a){this._setItemChanged()},k$c.addChildAt=function(k$a,k$b){return k$a.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,k$a,k$b)},k$c.removeChild=function(k$a){return k$a.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,k$a)},k$c.removeChildAt=function(k$a){return this.getChildAt(k$a).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,k$a)},k$c.refresh=function(){this._setItemChanged()},k$c.changeItems=function(){this._itemChanged=!1},k$c.sortItem=function(k$a){k$a&&k$a.sort(function(k$a,k$b){return k$a.y-k$b.y})},k$c._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},k$e(0,k$c,"space",function(){return this._space},function(k$a){this._space=k$a,this._setItemChanged()}),k$e(0,k$c,"align",function(){return this._align},function(k$a){this._align=k$a,this._setItemChanged()}),k$b}(),k$W=function(k$b){function k$c(k$a,k$b){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,k$c.__super.call(this),k$a&&(this.skin=k$a),k$b&&(this.sheet=k$b)}k$f(k$c,"laya.ui.FontClip",k$b);var k$a=k$c.prototype;return k$a.createChildren=function(){this._bitmap=new k$G,this.on("loaded",this,this._onClipLoaded)},k$a._onClipLoaded=function(){this.callLater(this.changeValue)},k$a.changeValue=function(){var k$a;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),k$a=this._sources[0]))){var k$b="horizontal"===this._direction;k$b?(this._wordsW=this._valueArr.length*(k$a.sourceWidth+this.spaceX),this._wordsH=k$a.sourceHeight):(this._wordsW=k$a.sourceWidth,this._wordsH=(k$a.sourceHeight+this.spaceY)*this._valueArr.length);var k$c=0;if(this._width)switch(this._align){case"center":k$c=.5*(this._width-this._wordsW);break;case"right":k$c=this._width-this._wordsW;break;default:k$c=0}for(var k$d=0,k$e=this._valueArr.length;k$d<k$e;k$d++){var k$f=this._indexMap[this._valueArr.charAt(k$d)];this.sources[k$f]&&(k$a=this.sources[k$f],k$b?this.graphics.drawTexture(k$a,k$c+k$d*(k$a.sourceWidth+this.spaceX),0,k$a.sourceWidth,k$a.sourceHeight):this.graphics.drawTexture(k$a,0+k$c,k$d*(k$a.sourceHeight+this.spaceY),k$a.sourceWidth,k$a.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),k$b.prototype.destroy.call(this,k$a)},k$e(0,k$a,"sheet",function(){return this._sheet},function(k$a){k$a+="";var k$b=(this._sheet=k$a).split(" ");this._clipX=String(k$b[0]).length,this.clipY=k$b.length,this._indexMap={};for(var k$c=0;k$c<this._clipY;k$c++)for(var k$d=k$b[k$c].split(""),k$e=0,k$f=k$d.length;k$e<k$f;k$e++)this._indexMap[k$d[k$e]]=k$c*this._clipX+k$e}),k$e(0,k$a,"height",k$b.prototype._$get_height,function(k$a){k$p.superSet(k$L,this,"height",k$a),this.callLater(this.changeValue)}),k$e(0,k$a,"direction",function(){return this._direction},function(k$a){this._direction=k$a,this.callLater(this.changeValue)}),k$e(0,k$a,"value",function(){return this._valueArr?this._valueArr:""},function(k$a){k$a+="",this._valueArr=k$a,this.callLater(this.changeValue)}),k$e(0,k$a,"width",k$b.prototype._$get_width,function(k$a){k$p.superSet(k$L,this,"width",k$a),this.callLater(this.changeValue)}),k$e(0,k$a,"spaceX",function(){return this._spaceX},function(k$a){this._spaceX=k$a,"horizontal"===this._direction&&this.callLater(this.changeValue)}),k$e(0,k$a,"spaceY",function(){return this._spaceY},function(k$a){this._spaceY=k$a,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),k$e(0,k$a,"align",function(){return this._align},function(k$a){this._align=k$a,this.callLater(this.changeValue)}),k$e(0,k$a,"measureWidth",function(){return this._wordsW}),k$e(0,k$a,"measureHeight",function(){return this._wordsH}),k$c}(k$L),k$X=function(k$a){function k$b(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new k$o,k$b.__super.call(this)}k$f(k$b,"laya.ui.List",k$a);var k$c=k$b.prototype;return k$p.imps(k$c,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),k$c.destroy=function(k$a){void 0===k$a&&(k$a=!0),this._content&&this._content.destroy(k$a),this._scrollBar&&this._scrollBar.destroy(k$a),laya.ui.Component.prototype.destroy.call(this,k$a),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},k$c.createChildren=function(){this.addChild(this._content=new k$J)},k$c.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=k$p.superGet(k$J,this,"cacheAs")),k$p.superSet(k$J,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},k$c.onScrollEnd=function(){k$p.superSet(k$J,this,"cacheAs",this._$P.cacheAs)},k$c._removePreScrollBar=function(){var k$a=this.removeChildByName("scrollBar");k$a&&k$a.destroy(!0)},k$c.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var k$a=this._getOneCell(),k$b=k$a.width+this._spaceX||1,k$c=k$a.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/k$b):Math.ceil(this._width/k$b)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/k$c):Math.round(this._height/k$c));var k$d=this._width?this._width:k$b*this.repeatX-this._spaceX,k$e=this._height?this._height:k$c*this.repeatY-this._spaceY;this._cellSize=this._isVertical?k$c:k$b,this._cellOffset=this._isVertical?k$c*Math.max(this._repeatY2,this._repeatY)-k$e-this._spaceY:k$b*Math.max(this._repeatX2,this._repeatX)-k$d-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=k$e:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=k$d),this.setContentSize(k$d,k$e);var k$f=this._isVertical?this.repeatX:this.repeatY,k$g=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,k$f,k$g),this._createdLine=k$g,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},k$c._getOneCell=function(){if(0===this._cells.length){var k$a=this.createItem();if(this._offset.setTo(k$a.x,k$a.y),this.cacheContent)return k$a;this._cells.push(k$a)}return this._cells[0]},k$c._createItems=function(k$a,k$b,k$c){var k$d=this._content,k$e=this._getOneCell(),k$f=k$e.width+this._spaceX,k$g=k$e.height+this._spaceY;if(this.cacheContent){var k$h=new k$J;k$h.cacheAsBitmap=!0,k$h.pos((this._isVertical?0:k$a)*k$f,(this._isVertical?k$a:0)*k$g),this._content.addChild(k$h),this._content.optimizeScrollRect=!0,k$d=k$h}else{for(var k$i=[],k$j=this._cells.length-1;-1<k$j;k$j--){var k$k=this._cells[k$j];k$k.removeSelf(),k$i.push(k$k)}this._cells.length=0}for(var k$l=k$a;k$l<k$c;k$l++)for(var k$m=0;k$m<k$b;k$m++)(k$e=k$i&&k$i.length?k$i.pop():this.createItem()).x=(this._isVertical?k$m:k$l)*k$f-k$d.x,k$e.y=(this._isVertical?k$l:k$m)*k$g-k$d.y,k$e.name="item"+(k$l*k$b+k$m),k$d.addChild(k$e),this.addCell(k$e)},k$c.createItem=function(){var k$a=[];if("function"==typeof this._itemRender)var k$b=new this._itemRender;else k$b=k$T.createComp(this._itemRender,null,null,k$a);if(0==k$a.length&&k$b._watchMap){var k$c=k$b._watchMap;for(var k$d in k$c)for(var k$e=k$c[k$d],k$f=0;k$f<k$e.length;k$f++){var k$g=k$e[k$f];k$a.push(k$g.comp,k$g.prop,k$g.value)}}return k$a.length&&(k$b._$bindData=k$a),k$b},k$c.addCell=function(k$a){k$a.on("click",this,this.onCellMouse),k$a.on("rightclick",this,this.onCellMouse),k$a.on("mouseover",this,this.onCellMouse),k$a.on("mouseout",this,this.onCellMouse),k$a.on("mousedown",this,this.onCellMouse),k$a.on("mouseup",this,this.onCellMouse),this._cells.push(k$a)},k$c.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var k$a=0,k$b=k$a=0;k$b<1e4;k$b++){var k$c=this.getChildByName("item"+k$b);if(!k$c)break;this.addCell(k$c),k$a++}this.repeatY=k$a}},k$c.setContentSize=function(k$a,k$b){this._content.width=k$a,this._content.height=k$b,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new k$r),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,k$a,k$b),this._content.scrollRect=this._content.scrollRect),this.event("resize")},k$c.onCellMouse=function(k$a){"mousedown"===k$a.type&&(this._isMoved=!1);var k$b=k$a.currentTarget,k$c=this._startIndex+this._cells.indexOf(k$b);k$c<0||("click"===k$a.type||"rightclick"===k$a.type?this.selectEnable&&!this._isMoved?this.selectedIndex=k$c:this.changeCellState(k$b,!0,0):"mouseover"!==k$a.type&&"mouseout"!==k$a.type||this._selectedIndex===k$c||this.changeCellState(k$b,"mouseover"===k$a.type,0),this.mouseHandler&&this.mouseHandler.runWith([k$a,k$c]))},k$c.changeCellState=function(k$a,k$b,k$c){var k$d=k$a.getChildByName("selectBox");k$d&&(this.selectEnable=!0,k$d.visible=k$b,k$d.index=k$c)},k$c.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},k$c.onScrollBarChange=function(k$a){this.runCallLater(this.changeCells);var k$b=this._scrollBar.value,k$c=this._isVertical?this.repeatX:this.repeatY,k$d=this._isVertical?this.repeatY:this.repeatX,k$e=Math.floor(k$b/this._cellSize);if(this.cacheContent)k$g=k$d+1,this._createdLine-k$e<k$g&&(this._createItems(this._createdLine,k$c,this._createdLine+k$g),this.renderItems(this._createdLine*k$c,0),this._createdLine+=k$g);else{var k$f=k$e*k$c,k$g=0;if(k$f>this._startIndex){k$g=k$f-this._startIndex;var k$h=!0,k$i=this._startIndex+k$c*(k$d+1);this._isMoved=!0}else k$f<this._startIndex&&(k$g=this._startIndex-k$f,k$h=!1,k$i=this._startIndex-1,this._isMoved=!0);for(var k$j=0;k$j<k$g;k$j++){if(k$h){var k$k=this._cells.shift();this._cells[this._cells.length]=k$k;var k$l=k$i+k$j}else k$k=this._cells.pop(),this._cells.unshift(k$k),k$l=k$i-k$j;var k$m=Math.floor(k$l/k$c)*this._cellSize;this._isVertical?k$k.y=k$m:k$k.x=k$m,this.renderItem(k$k,k$l)}this._startIndex=k$f,this.changeSelectStatus()}var k$n=this._content.scrollRect;this._isVertical?(k$n.y=k$b-this._offset.y,k$n.x=-this._offset.x):(k$n.y=-this._offset.y,k$n.x=k$b-this._offset.x),this._content.scrollRect=k$n},k$c.posCell=function(k$a,k$b){if(this._scrollBar){var k$c=this._isVertical?this.repeatX:this.repeatY,k$d=(this._isVertical?this.repeatY:this.repeatX,Math.floor(k$b/k$c)*this._cellSize);this._isVertical?k$a.y=k$d:k$a.x=k$d}},k$c.changeSelectStatus=function(){for(var k$a=0,k$b=this._cells.length;k$a<k$b;k$a++)this.changeCellState(this._cells[k$a],this._selectedIndex===this._startIndex+k$a,1)},k$c.renderItems=function(k$a,k$b){void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0);for(var k$c=k$a,k$d=k$b||this._cells.length;k$c<k$d;k$c++)this.renderItem(this._cells[k$c],this._startIndex+k$c);this.changeSelectStatus()},k$c.renderItem=function(k$a,k$b){this._array&&0<=k$b&&k$b<this._array.length?(k$a.visible=!0,k$a._$bindData?(k$a._dataSource=this._array[k$b],this._bindData(k$a,this._array[k$b])):k$a.dataSource=this._array[k$b],this.cacheContent||this.posCell(k$a,k$b),this.hasListener("render")&&this.event("render",[k$a,k$b]),this.renderHandler&&this.renderHandler.runWith([k$a,k$b])):(k$a.visible=!1,k$a.dataSource=null)},k$c._bindData=function(k$a,k$b){for(var k$c=k$a._$bindData,k$d=0,k$e=k$c.length;k$d<k$e;k$d++){var k$f=k$c[k$d++],k$g=k$c[k$d++],k$h=k$c[k$d],k$i=k$E.getBindFun(k$h);k$f[k$g]=k$i.call(this,k$b)}},k$c.refresh=function(){this.array=this._array},k$c.getItem=function(k$a){return-1<k$a&&k$a<this._array.length?this._array[k$a]:null},k$c.changeItem=function(k$a,k$b){-1<k$a&&k$a<this._array.length&&(this._array[k$a]=k$b,k$a>=this._startIndex&&k$a<this._startIndex+this._cells.length&&this.renderItem(this.getCell(k$a),k$a))},k$c.setItem=function(k$a,k$b){this.changeItem(k$a,k$b)},k$c.addItem=function(k$a){this._array.push(k$a),this.array=this._array},k$c.addItemAt=function(k$a,k$b){this._array.splice(k$b,0,k$a),this.array=this._array},k$c.deleteItem=function(k$a){this._array.splice(k$a,1),this.array=this._array},k$c.getCell=function(k$a){return this.runCallLater(this.changeCells),-1<k$a&&this._cells?this._cells[(k$a-this._startIndex)%this._cells.length]:null},k$c.scrollTo=function(k$a){if(this._scrollBar){var k$b=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(k$a/k$b)*this._cellSize}else this.startIndex=k$a},k$c.tweenTo=function(k$a,k$b,k$c){if(void 0===k$b&&(k$b=200),this._scrollBar){var k$d=this._isVertical?this.repeatX:this.repeatY;k$z.to(this._scrollBar,{value:Math.floor(k$a/k$d)*this._cellSize},k$b,null,k$c,0,!0)}else this.startIndex=k$a,k$c&&k$c.run()},k$c._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},k$c.commitMeasure=function(){this.runCallLater(this.changeCells)},k$e(0,k$c,"cacheAs",k$a.prototype._$get_cacheAs,function(k$a){k$p.superSet(k$J,this,"cacheAs",k$a),this._scrollBar&&(this._$P.cacheAs=null,"none"!==k$a?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),k$e(0,k$c,"content",function(){return this._content}),k$e(0,k$c,"height",k$a.prototype._$get_height,function(k$a){k$a!=this._height&&(k$p.superSet(k$J,this,"height",k$a),this._setCellChanged())}),k$e(0,k$c,"itemRender",function(){return this._itemRender},function(k$a){if(this._itemRender!=k$a){this._itemRender=k$a;for(var k$b=this._cells.length-1;-1<k$b;k$b--)this._cells[k$b].destroy();this._cells.length=0,this._setCellChanged()}}),k$e(0,k$c,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(k$a){this._removePreScrollBar();var k$b=new k$ba;k$b.name="scrollBar",k$b.right=0,k$a&&" "!=k$a&&(k$b.skin=k$a),this.scrollBar=k$b,this.addChild(k$b),this._setCellChanged()}),k$e(0,k$c,"page",function(){return this._page},function(k$a){this._page=k$a,this._array&&(this._page=0<k$a?k$a:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),k$e(0,k$c,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(k$a){this._removePreScrollBar();var k$b=new k$Y;k$b.name="scrollBar",k$b.bottom=0,k$a&&" "!=k$a&&(k$b.skin=k$a),this.scrollBar=k$b,this.addChild(k$b),this._setCellChanged()}),k$e(0,k$c,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(k$a){this._repeatX=k$a,this._setCellChanged()}),k$e(0,k$c,"scrollBar",function(){return this._scrollBar},function(k$a){this._scrollBar!=k$a&&(this._scrollBar=k$a)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),k$e(0,k$c,"width",k$a.prototype._$get_width,function(k$a){k$a!=this._width&&(k$p.superSet(k$J,this,"width",k$a),this._setCellChanged())}),k$e(0,k$c,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(k$a){this._repeatY=k$a,this._setCellChanged()}),k$e(0,k$c,"spaceX",function(){return this._spaceX},function(k$a){this._spaceX=k$a,this._setCellChanged()}),k$e(0,k$c,"spaceY",function(){return this._spaceY},function(k$a){this._spaceY=k$a,this._setCellChanged()}),k$e(0,k$c,"selectedIndex",function(){return this._selectedIndex},function(k$a){this._selectedIndex!=k$a&&(this._selectedIndex=k$a,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(k$a),this.startIndex=this._startIndex)}),k$e(0,k$c,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(k$a){this.selectedIndex=this._array.indexOf(k$a)}),k$e(0,k$c,"length",function(){return this._array?this._array.length:0}),k$e(0,k$c,"selection",function(){return this.getCell(this._selectedIndex)},function(k$a){this.selectedIndex=this._startIndex+this._cells.indexOf(k$a)}),k$e(0,k$c,"startIndex",function(){return this._startIndex},function(k$a){this._startIndex=0<k$a?k$a:0,this.callLater(this.renderItems)}),k$e(0,k$c,"array",function(){return this._array},function(k$a){this.runCallLater(this.changeCells),this._array=k$a||[];var k$b=this._array.length;if(this.totalPage=Math.ceil(k$b/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<k$b?this._selectedIndex:k$b-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var k$c=this._isVertical?this.repeatX:this.repeatY,k$d=this._isVertical?this.repeatY:this.repeatX,k$e=Math.ceil(k$b/k$c);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=k$d/k$e,this._scrollBar.setScroll(0,(k$e-k$d)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),k$e(0,k$c,"dataSource",k$a.prototype._$get_dataSource,function(k$a){"number"==typeof(this._dataSource=k$a)&&Math.floor(k$a)==k$a||"string"==typeof k$a?this.selectedIndex=parseInt(k$a):k$a instanceof Array?this.array=k$a:k$p.superSet(k$J,this,"dataSource",k$a)}),k$e(0,k$c,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),k$b}(k$J),k$Y=function(k$a){function k$b(){k$b.__super.call(this)}return k$f(k$b,"laya.ui.HScrollBar",k$a),k$b.prototype.initialize=function(){k$a.prototype.initialize.call(this),this.slider.isVertical=!1},k$b}(k$O),k$Z=function(k$a){function k$b(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,k$b.__super.call(this),this.width=this.height=100}k$f(k$b,"laya.ui.Panel",k$a);var k$c=k$b.prototype;return k$c.destroy=function(k$a){void 0===k$a&&(k$a=!0),laya.ui.Component.prototype.destroy.call(this,k$a),this._content&&this._content.destroy(k$a),this._vScrollBar&&this._vScrollBar.destroy(k$a),this._hScrollBar&&this._hScrollBar.destroy(k$a),this._vScrollBar=null,this._hScrollBar=null,this._content=null},k$c.destroyChildren=function(){this._content.destroyChildren()},k$c.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new k$J)},k$c.addChild=function(k$a){return k$a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(k$a)},k$c.onResize=function(){this._setScrollChanged()},k$c.addChildAt=function(k$a,k$b){return k$a.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(k$a,k$b)},k$c.removeChild=function(k$a){return k$a.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(k$a)},k$c.removeChildAt=function(k$a){return this.getChildAt(k$a).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(k$a)},k$c.removeChildren=function(k$a,k$b){return void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=2147483647),this._content.removeChildren(k$a,k$b),this._setScrollChanged(),this},k$c.getChildAt=function(k$a){return this._content.getChildAt(k$a)},k$c.getChildByName=function(k$a){return this._content.getChildByName(k$a)},k$c.getChildIndex=function(k$a){return this._content.getChildIndex(k$a)},k$c.changeScroll=function(){this._scrollChanged=!1;var k$a=this.contentWidth||1,k$b=this.contentHeight||1,k$c=this._vScrollBar,k$d=this._hScrollBar,k$e=k$c&&k$b>this._height,k$f=k$d&&k$a>this._width,k$g=k$e?this._width-k$c.width:this._width,k$h=k$f?this._height-k$d.height:this._height;k$c&&(k$c.x=this._width-k$c.width,k$c.y=0,k$c.height=this._height-(k$f?k$d.height:0),k$c.scrollSize=Math.max(.033*this._height,1),k$c.thumbPercent=k$h/k$b,k$c.setScroll(0,k$b-k$h,k$c.value)),k$d&&(k$d.x=0,k$d.y=this._height-k$d.height,k$d.width=this._width-(k$e?k$c.width:0),k$d.scrollSize=Math.max(.033*this._width,1),k$d.thumbPercent=k$g/k$a,k$d.setScroll(0,k$a-k$g,k$d.value))},k$c.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},k$c.setContentSize=function(k$a,k$b){var k$c=this._content;k$c.width=k$a,k$c.height=k$b,k$c.scrollRect||(k$c.scrollRect=new k$r),k$c.scrollRect.setTo(0,0,k$a,k$b),k$c.scrollRect=k$c.scrollRect},k$c.onScrollBarChange=function(k$a){var k$b=this._content.scrollRect;if(k$b){var k$c=Math.round(k$a.value);k$a.isVertical?k$b.y=k$c:k$b.x=k$c,this._content.scrollRect=k$b}},k$c.scrollTo=function(k$a,k$b){void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),this.vScrollBar&&(this.vScrollBar.value=k$b),this.hScrollBar&&(this.hScrollBar.value=k$a)},k$c.refresh=function(){this.changeScroll()},k$c.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=k$p.superGet(k$J,this,"cacheAs")),k$p.superSet(k$J,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},k$c.onScrollEnd=function(){k$p.superSet(k$J,this,"cacheAs",this._$P.cacheAs)},k$c._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},k$e(0,k$c,"numChildren",function(){return this._content.numChildren}),k$e(0,k$c,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(k$a){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new k$Y),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=k$a}),k$e(0,k$c,"contentWidth",function(){for(var k$a=0,k$b=this._content.numChildren-1;-1<k$b;k$b--){var k$c=this._content.getChildAt(k$b);k$a=Math.max(k$c.x+k$c.width*k$c.scaleX,k$a)}return k$a}),k$e(0,k$c,"contentHeight",function(){for(var k$a=0,k$b=this._content.numChildren-1;-1<k$b;k$b--){var k$c=this._content.getChildAt(k$b);k$a=Math.max(k$c.y+k$c.height*k$c.scaleY,k$a)}return k$a}),k$e(0,k$c,"width",k$a.prototype._$get_width,function(k$a){k$p.superSet(k$J,this,"width",k$a),this._setScrollChanged()}),k$e(0,k$c,"hScrollBar",function(){return this._hScrollBar}),k$e(0,k$c,"content",function(){return this._content}),k$e(0,k$c,"height",k$a.prototype._$get_height,function(k$a){k$p.superSet(k$J,this,"height",k$a),this._setScrollChanged()}),k$e(0,k$c,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(k$a){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new k$ba),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=k$a}),k$e(0,k$c,"vScrollBar",function(){return this._vScrollBar}),k$e(0,k$c,"cacheAs",k$a.prototype._$get_cacheAs,function(k$a){k$p.superSet(k$J,this,"cacheAs",k$a),this._$P.cacheAs=null,"none"!==k$a?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),k$b}(k$J),k$$=function(k$a){function k$b(k$a){k$b.__super.call(this,k$a),this.isVertical=!1}return k$f(k$b,"laya.ui.HSlider",k$P),k$b}(),k$_=function(k$a){function k$c(k$a,k$b){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,k$c.__super.call(this),this.skin=k$b,this.labels=k$a}k$f(k$c,"laya.ui.UIGroup",k$a);var k$b=k$c.prototype;return k$p.imps(k$b,{"laya.ui.IItem":!0}),k$b.preinitialize=function(){this.mouseEnabled=!0},k$b.destroy=function(k$a){void 0===k$a&&(k$a=!0),laya.ui.Component.prototype.destroy.call(this,k$a),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},k$b.addItem=function(k$a,k$b){void 0===k$b&&(k$b=!0);var k$c=k$a,k$d=this._items.length;if(k$c.name="item"+k$d,this.addChild(k$c),this.initItems(),k$b&&0<k$d){var k$e=this._items[k$d-1];"horizontal"==this._direction?k$c.x=k$e.x+k$e.width+this._space:k$c.y=k$e.y+k$e.height+this._space}else k$b&&(k$c.x=0,k$c.y=0);return k$d},k$b.delItem=function(k$a,k$b){void 0===k$b&&(k$b=!0);var k$c=this._items.indexOf(k$a);if(-1!=k$c){var k$d=k$a;this.removeChild(k$d);for(var k$e=k$c+1,k$f=this._items.length;k$e<k$f;k$e++){var k$g=this._items[k$e];k$g.name="item"+(k$e-1),k$b&&("horizontal"==this._direction?k$g.x-=k$d.width+this._space:k$g.y-=k$d.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var k$h;k$h=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=k$h}}},k$b.initItems=function(){this._items||(this._items=[]);for(var k$a=this._items.length=0;k$a<1e4;k$a++){var k$b=this.getChildByName("item"+k$a);if(null==k$b)break;this._items.push(k$b),k$b.selected=k$a===this._selectedIndex,k$b.clickHandler=k$m.create(this,this.itemClick,[k$a],!1)}},k$b.itemClick=function(k$a){this.selectedIndex=k$a},k$b.setSelect=function(k$a,k$b){this._items&&-1<k$a&&k$a<this._items.length&&(this._items[k$a].selected=k$b)},k$b.createItem=function(k$a,k$b){return null},k$b.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var k$a=0,k$b=0,k$c=this._items.length;k$b<k$c;k$b++){var k$d=this._items[k$b];this._skin&&(k$d.skin=this._skin),this._labelColors&&(k$d.labelColors=this._labelColors),this._labelSize&&(k$d.labelSize=this._labelSize),this._labelStroke&&(k$d.labelStroke=this._labelStroke),this._labelStrokeColor&&(k$d.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(k$d.strokeColors=this._strokeColors),this._labelBold&&(k$d.labelBold=this._labelBold),this._labelPadding&&(k$d.labelPadding=this._labelPadding),this._labelAlign&&(k$d.labelAlign=this._labelAlign),this._stateNum&&(k$d.stateNum=this._stateNum),this._labelFont&&(k$d.labelFont=this._labelFont),"horizontal"===this._direction?(k$d.y=0,k$d.x=k$a,k$a+=k$d.width+this._space):(k$d.x=0,k$d.y=k$a,k$a+=k$d.height+this._space)}this.changeSize()},k$b.commitMeasure=function(){this.runCallLater(this.changeLabels)},k$b._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},k$e(0,k$b,"labelStrokeColor",function(){return this._labelStrokeColor},function(k$a){this._labelStrokeColor!=k$a&&(this._labelStrokeColor=k$a,this._setLabelChanged())}),k$e(0,k$b,"skin",function(){return this._skin},function(k$a){this._skin!=k$a&&(this._skin=k$a,this._setLabelChanged())}),k$e(0,k$b,"selectedIndex",function(){return this._selectedIndex},function(k$a){this._selectedIndex!=k$a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=k$a,this.setSelect(k$a,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),k$e(0,k$b,"labels",function(){return this._labels},function(k$a){if(this._labels!=k$a){if(this._labels=k$a,this.removeChildren(),this._setLabelChanged(),this._labels)for(var k$b=this._labels.split(","),k$c=0,k$d=k$b.length;k$c<k$d;k$c++){var k$e=this.createItem(this._skin,k$b[k$c]);k$e.name="item"+k$c,this.addChild(k$e)}this.initItems()}}),k$e(0,k$b,"strokeColors",function(){return this._strokeColors},function(k$a){this._strokeColors!=k$a&&(this._strokeColors=k$a,this._setLabelChanged())}),k$e(0,k$b,"labelColors",function(){return this._labelColors},function(k$a){this._labelColors!=k$a&&(this._labelColors=k$a,this._setLabelChanged())}),k$e(0,k$b,"labelStroke",function(){return this._labelStroke},function(k$a){this._labelStroke!=k$a&&(this._labelStroke=k$a,this._setLabelChanged())}),k$e(0,k$b,"labelSize",function(){return this._labelSize},function(k$a){this._labelSize!=k$a&&(this._labelSize=k$a,this._setLabelChanged())}),k$e(0,k$b,"stateNum",function(){return this._stateNum},function(k$a){this._stateNum!=k$a&&(this._stateNum=k$a,this._setLabelChanged())}),k$e(0,k$b,"labelBold",function(){return this._labelBold},function(k$a){this._labelBold!=k$a&&(this._labelBold=k$a,this._setLabelChanged())}),k$e(0,k$b,"labelFont",function(){return this._labelFont},function(k$a){this._labelFont!=k$a&&(this._labelFont=k$a,this._setLabelChanged())}),k$e(0,k$b,"labelPadding",function(){return this._labelPadding},function(k$a){this._labelPadding!=k$a&&(this._labelPadding=k$a,this._setLabelChanged())}),k$e(0,k$b,"direction",function(){return this._direction},function(k$a){this._direction=k$a,this._setLabelChanged()}),k$e(0,k$b,"space",function(){return this._space},function(k$a){this._space=k$a,this._setLabelChanged()}),k$e(0,k$b,"items",function(){return this._items}),k$e(0,k$b,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(k$a){this.selectedIndex=this._items.indexOf(k$a)}),k$e(0,k$b,"dataSource",k$a.prototype._$get_dataSource,function(k$a){"number"==typeof(this._dataSource=k$a)&&Math.floor(k$a)==k$a||"string"==typeof k$a?this.selectedIndex=parseInt(k$a):k$a instanceof Array?this.labels=k$a.join(","):k$p.superSet(k$J,this,"dataSource",k$a)}),k$c}(k$J),k$u=function(k$b){function k$c(k$a,k$b){this._value=null,void 0===k$b&&(k$b=""),k$c.__super.call(this,k$a,k$b)}k$f(k$c,"laya.ui.Radio",k$b);var k$a=k$c.prototype;return k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,k$a),this._value=null},k$a.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},k$a.initialize=function(){k$b.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},k$a.onClick=function(k$a){this.selected=!0},k$e(0,k$a,"value",function(){return null!=this._value?this._value:this.label},function(k$a){this._value=k$a}),k$c}(k$K),k$v=function(k$a){function k$b(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,k$b.__super.call(this),this.width=this.height=200}k$f(k$b,"laya.ui.Tree",k$a);var k$c=k$b.prototype;return k$p.imps(k$c,{"laya.ui.IRender":!0}),k$c.destroy=function(k$a){void 0===k$a&&(k$a=!0),laya.ui.Component.prototype.destroy.call(this,k$a),this._list&&this._list.destroy(k$a),this._list=null,this._source=null,this._renderHandler=null},k$c.createChildren=function(){this.addChild(this._list=new k$X),this._list.renderHandler=k$m.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},k$c.onListChange=function(k$a){this.event("change")},k$c.getArray=function(){var k$a,k$b=[];for(var k$c in this._source)k$a=this._source[k$c],this.getParentOpenStatus(k$a)&&(k$a.x=this._spaceLeft*this.getDepth(k$a),k$b.push(k$a));return k$b},k$c.getDepth=function(k$a,k$b){return void 0===k$b&&(k$b=0),null==k$a.nodeParent?k$b:this.getDepth(k$a.nodeParent,k$b+1)},k$c.getParentOpenStatus=function(k$a){var k$b=k$a.nodeParent;return null==k$b||!!k$b.isOpen&&(null==k$b.nodeParent||this.getParentOpenStatus(k$b))},k$c.renderItem=function(k$a,k$b){var k$c=k$a.dataSource;if(k$c){k$a.left=k$c.x;var k$d=k$a.getChildByName("arrow");k$d&&(k$c.hasChild?(k$d.visible=!0,k$d.index=k$c.isOpen?1:0,k$d.tag=k$b,k$d.off("click",this,this.onArrowClick),k$d.on("click",this,this.onArrowClick)):k$d.visible=!1);var k$e=k$a.getChildByName("folder");k$e&&(2==k$e.clipY?k$e.index=k$c.isDirectory?0:1:k$e.index=k$c.isDirectory?k$c.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([k$a,k$b])}},k$c.onArrowClick=function(k$a){var k$b=k$a.currentTarget.tag;this._list.array[k$b].isOpen=!this._list.array[k$b].isOpen,this.event("open"),this._list.array=this.getArray()},k$c.setItemState=function(k$a,k$b){this._list.array[k$a]&&(this._list.array[k$a].isOpen=k$b,this._list.array=this.getArray())},k$c.fresh=function(){this._list.array=this.getArray(),this.repaint()},k$c.parseXml=function(k$a,k$b,k$c,k$d){var k$e,k$f=k$a.childNodes,k$g=k$f.length;if(!k$d){k$e={};var k$h,k$i=k$a.attributes;for(var k$j in k$i){var k$k=(k$h=k$i[k$j]).nodeName,k$l=k$h.nodeValue;k$e[k$k]="true"==k$l||"false"!=k$l&&k$l}k$e.nodeParent=k$c,0<k$g&&(k$e.isDirectory=!0),k$e.hasChild=0<k$g,k$b.push(k$e)}for(var k$m=0;k$m<k$g;k$m++){var k$n=k$f[k$m];this.parseXml(k$n,k$b,k$e,!1)}},k$c.parseOpenStatus=function(k$a,k$b){for(var k$c=0,k$d=k$b.length;k$c<k$d;k$c++){var k$e=k$b[k$c];if(k$e.isDirectory)for(var k$f=0,k$g=k$a.length;k$f<k$g;k$f++){var k$h=k$a[k$f];if(k$h.isDirectory&&this.isSameParent(k$h,k$e)&&k$e.label==k$h.label){k$e.isOpen=k$h.isOpen;break}}}},k$c.isSameParent=function(k$a,k$b){return null==k$a.nodeParent&&null==k$b.nodeParent||null!=k$a.nodeParent&&null!=k$b.nodeParent&&(k$a.nodeParent.label==k$b.nodeParent.label&&this.isSameParent(k$a.nodeParent,k$b.nodeParent))},k$c.filter=function(k$a){if(Boolean(k$a)){var k$b=[];this.getFilterSource(this._source,k$b,k$a),this._list.array=k$b}else this._list.array=this.getArray()},k$c.getFilterSource=function(k$a,k$b,k$c){var k$d;for(var k$e in k$c=k$c.toLocaleLowerCase(),k$a)!(k$d=k$a[k$e]).isDirectory&&-1<String(k$d.label).toLowerCase().indexOf(k$c)&&(k$d.x=0,k$b.push(k$d)),k$d.child&&0<k$d.child.length&&this.getFilterSource(k$d.child,k$b,k$c)},k$e(0,k$c,"spaceBottom",function(){return this._list.spaceY},function(k$a){this._list.spaceY=k$a}),k$e(0,k$c,"keepStatus",function(){return this._keepStatus},function(k$a){this._keepStatus=k$a}),k$e(0,k$c,"itemRender",function(){return this._list.itemRender},function(k$a){this._list.itemRender=k$a}),k$e(0,k$c,"array",function(){return this._list.array},function(k$a){this._keepStatus&&this._list.array&&k$a&&this.parseOpenStatus(this._list.array,k$a),this._source=k$a,this._list.array=this.getArray()}),k$e(0,k$c,"mouseHandler",function(){return this._list.mouseHandler},function(k$a){this._list.mouseHandler=k$a}),k$e(0,k$c,"dataSource",k$a.prototype._$get_dataSource,function(k$a){this._dataSource=k$a,k$p.superSet(k$J,this,"dataSource",k$a)}),k$e(0,k$c,"source",function(){return this._source}),k$e(0,k$c,"scrollBar",function(){return this._list.scrollBar}),k$e(0,k$c,"list",function(){return this._list}),k$e(0,k$c,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(k$a){this._list.vScrollBarSkin=k$a}),k$e(0,k$c,"renderHandler",function(){return this._renderHandler},function(k$a){this._renderHandler=k$a}),k$e(0,k$c,"selectedIndex",function(){return this._list.selectedIndex},function(k$a){this._list.selectedIndex=k$a}),k$e(0,k$c,"spaceLeft",function(){return this._spaceLeft},function(k$a){this._spaceLeft=k$a}),k$e(0,k$c,"selectedItem",function(){return this._list.selectedItem},function(k$a){this._list.selectedItem=k$a}),k$e(0,k$c,"width",k$a.prototype._$get_width,function(k$a){k$p.superSet(k$J,this,"width",k$a),this._list.width=k$a}),k$e(0,k$c,"height",k$a.prototype._$get_height,function(k$a){k$p.superSet(k$J,this,"height",k$a),this._list.height=k$a}),k$e(0,k$c,"xml",null,function(k$a){var k$b=[];this.parseXml(k$a.childNodes[0],k$b,null,!0),this.array=k$b}),k$e(0,k$c,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),k$b}(k$J),k$aa=function(k$a){function k$b(){this._items=null,this._selectedIndex=0,k$b.__super.call(this),this._setIndexHandler=k$m.create(this,this.setIndex,null,!1)}k$f(k$b,"laya.ui.ViewStack",k$a);var k$c=k$b.prototype;return k$p.imps(k$c,{"laya.ui.IItem":!0}),k$c.setItems=function(k$a){this.removeChildren();for(var k$b=0,k$c=0,k$d=k$a.length;k$c<k$d;k$c++){var k$e=k$a[k$c];k$e&&(k$e.name="item"+k$b,this.addChild(k$e),k$b++)}this.initItems()},k$c.addItem=function(k$a){k$a.name="item"+this._items.length,this.addChild(k$a),this.initItems()},k$c.initItems=function(){this._items=[];for(var k$a=0;k$a<1e4;k$a++){var k$b=this.getChildByName("item"+k$a);if(null==k$b)break;this._items.push(k$b),k$b.visible=k$a==this._selectedIndex}},k$c.setSelect=function(k$a,k$b){this._items&&-1<k$a&&k$a<this._items.length&&(this._items[k$a].visible=k$b)},k$c.setIndex=function(k$a){this.selectedIndex=k$a},k$e(0,k$c,"dataSource",k$a.prototype._$get_dataSource,function(k$a){if("number"==typeof(this._dataSource=k$a)&&Math.floor(k$a)==k$a||"string"==typeof k$a)this.selectedIndex=parseInt(k$a);else for(var k$b in this._dataSource)this.hasOwnProperty(k$b)&&(this[k$b]=this._dataSource[k$b])}),k$e(0,k$c,"selectedIndex",function(){return this._selectedIndex},function(k$a){this._selectedIndex!=k$a&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=k$a,this.setSelect(this._selectedIndex,!0))}),k$e(0,k$c,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(k$a){this.selectedIndex=this._items.indexOf(k$a)}),k$e(0,k$c,"items",function(){return this._items}),k$e(0,k$c,"setIndexHandler",function(){return this._setIndexHandler},function(k$a){this._setIndexHandler=k$a}),k$b}(k$J),k$ba=function(k$a){function k$b(){k$b.__super.call(this)}return k$f(k$b,"laya.ui.VScrollBar",k$O),k$b}(),k$ca=function(k$b){function k$c(k$a){this._bg=null,this._skin=null,k$c.__super.call(this),void 0===k$a&&(k$a=""),this.text=k$a,this.skin=this.skin}k$f(k$c,"laya.ui.TextInput",k$b);var k$a=k$c.prototype;return k$a.preinitialize=function(){this.mouseEnabled=!0},k$a.destroy=function(k$a){k$s.clearCache(this,this._skin),void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,k$a),this._bg&&this._bg.destroy(),this._bg=null},k$a.createChildren=function(){this.addChild(this._tf=new k$n),this._tf.padding=k$D.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},k$a._onFocus=function(){this.event("focus",this)},k$a._onBlur=function(){this.event("blur",this)},k$a._onInput=function(){this.event("input",this)},k$a._onEnter=function(){this.event("enter",this)},k$a.initialize=function(){this.width=128,this.height=22},k$a.select=function(){this._tf.select()},k$a.setSelection=function(k$a,k$b){this._tf.setSelection(k$a,k$b)},k$e(0,k$a,"text",k$b.prototype._$get_text,function(k$a){this._tf.text!=k$a&&(k$a+="",this._tf.text=k$a,this.event("change"))}),k$e(0,k$a,"bg",function(){return this._bg},function(k$a){this.graphics=this._bg=k$a}),k$e(0,k$a,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(k$a){this._tf.inputElementYAdjuster=k$a}),k$e(0,k$a,"multiline",function(){return this._tf.multiline},function(k$a){this._tf.multiline=k$a}),k$e(0,k$a,"skin",function(){return this._skin},function(k$a){this._skin!=k$a&&(k$s.clearCache(this,this._skin),this._skin=k$a,this._bg||(this.graphics=this._bg=new k$G),k$s.keepCache(this,this._skin),this._bg.source=k$s.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),k$e(0,k$a,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(k$a){this._bg||(this.graphics=this._bg=new k$G),this._bg.sizeGrid=k$E.fillArray(k$D.defaultSizeGrid,k$a,Number)}),k$e(0,k$a,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(k$a){this._tf.inputElementXAdjuster=k$a}),k$e(0,k$a,"width",k$b.prototype._$get_width,function(k$a){k$p.superSet(k$R,this,"width",k$a),this._bg&&(this._bg.width=k$a)}),k$e(0,k$a,"height",k$b.prototype._$get_height,function(k$a){k$p.superSet(k$R,this,"height",k$a),this._bg&&(this._bg.height=k$a)}),k$e(0,k$a,"editable",function(){return this._tf.editable},function(k$a){this._tf.editable=k$a}),k$e(0,k$a,"restrict",function(){return this._tf.restrict},function(k$a){this._tf.restrict=k$a}),k$e(0,k$a,"prompt",function(){return this._tf.prompt},function(k$a){this._tf.prompt=k$a}),k$e(0,k$a,"promptColor",function(){return this._tf.promptColor},function(k$a){this._tf.promptColor=k$a}),k$e(0,k$a,"maxChars",function(){return this._tf.maxChars},function(k$a){this._tf.maxChars=k$a}),k$e(0,k$a,"focus",function(){return this._tf.focus},function(k$a){this._tf.focus=k$a}),k$e(0,k$a,"type",function(){return this._tf.type},function(k$a){this._tf.type=k$a}),k$e(0,k$a,"asPassword",function(){return this._tf.asPassword},function(k$a){this._tf.asPassword=k$a}),k$c}(k$R),k$da=function(k$a){function k$b(){k$b.__super.call(this)}return k$f(k$b,"laya.ui.VSlider",k$P),k$b}(),k$ea=function(k$a){function k$d(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,k$d.__super.call(this)}k$f(k$d,"laya.ui.Dialog",k$a);var k$b=k$d.prototype;return k$b.initialize=function(){this.popupEffect=k$d.manager.popupEffectHandler,this.closeEffect=k$d.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},k$b._dealDragArea=function(){var k$a=this.getChildByName("drag");k$a&&(this.dragArea=k$a.x+","+k$a.y+","+k$a.width+","+k$a.height,k$a.removeSelf())},k$b._onClick=function(k$a){var k$b=k$a.target;if(k$b)switch(k$b.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(k$b.name)}},k$b.show=function(k$a,k$b){void 0===k$a&&(k$a=!1),void 0===k$b&&(k$b=!0),this._open(!1,k$a,k$b)},k$b.popup=function(k$a,k$b){void 0===k$a&&(k$a=!1),void 0===k$b&&(k$b=!0),this._open(!0,k$a,k$b)},k$b._open=function(k$a,k$b,k$c){k$d.manager.lock(!1),this.isModal=k$a,k$d.manager.open(this,k$b,k$c)},k$b.onOpened=function(){},k$b.close=function(k$a,k$b){void 0===k$b&&(k$b=!0),k$d.manager.close(this,k$a,k$b)},k$b.onClosed=function(k$a){},k$b._onMouseDown=function(k$a){var k$b=this.getMousePoint();this._dragArea.contains(k$b.x,k$b.y)?this.startDrag():this.stopDrag()},k$e(0,k$b,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(k$a){if(k$a){var k$b=k$E.fillArray([0,0,0,0],k$a,Number);this._dragArea=new k$r(k$b[0],k$b[1],k$b[2],k$b[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),k$e(0,k$b,"isPopup",function(){return null!=this.parent}),k$e(0,k$b,"zOrder",k$a.prototype._$get_zOrder,function(k$a){k$p.superSet(k$T,this,"zOrder",k$a),k$d.manager._checkMask()}),k$e(1,k$d,"manager",function(){return k$d._manager=k$d._manager||new k$I},function(k$a){k$d._manager=k$a}),k$d.setLockView=function(k$a){k$d.manager.setLockView(k$a)},k$d.lock=function(k$a){k$d.manager.lock(k$a)},k$d.closeAll=function(){k$d.manager.closeAll()},k$d.getDialogsByGroup=function(k$a){return k$d.manager.getDialogsByGroup(k$a)},k$d.closeByGroup=function(k$a){return k$d.manager.closeByGroup(k$a)},k$d.CLOSE="close",k$d.CANCEL="cancel",k$d.SURE="sure",k$d.NO="no",k$d.OK="ok",k$d.YES="yes",k$d._manager=null,k$d}(k$T),k$fa=function(k$a){function k$b(){k$b.__super.call(this)}k$f(k$b,"laya.ui.HBox",k$a);var k$c=k$b.prototype;return k$c.sortItem=function(k$a){k$a&&k$a.sort(function(k$a,k$b){return k$a.x-k$b.x})},k$c.changeItems=function(){this._itemChanged=!1;for(var k$a=[],k$b=0,k$c=0,k$d=this.numChildren;k$c<k$d;k$c++){var k$e=this.getChildAt(k$c);k$e&&k$e.layoutEnabled&&(k$a.push(k$e),k$b=this._height?this._height:Math.max(k$b,k$e.height*k$e.scaleY))}this.sortItem(k$a);var k$f=0;for(k$c=0,k$d=k$a.length;k$c<k$d;k$c++)(k$e=k$a[k$c]).x=k$f,k$f+=k$e.width*k$e.scaleX+this._space,"top"==this._align?k$e.y=0:"middle"==this._align?k$e.y=.5*(k$b-k$e.height*k$e.scaleY):"bottom"==this._align&&(k$e.y=k$b-k$e.height*k$e.scaleY);this.changeSize()},k$e(0,k$c,"height",k$a.prototype._$get_height,function(k$a){this._height!=k$a&&(k$p.superSet(k$V,this,"height",k$a),this.callLater(this.changeItems))}),k$b.NONE="none",k$b.TOP="top",k$b.MIDDLE="middle",k$b.BOTTOM="bottom",k$b}(k$V),k$ga=function(k$a){function k$b(){k$b.__super.call(this)}k$f(k$b,"laya.ui.VBox",k$a);var k$c=k$b.prototype;return k$c.changeItems=function(){this._itemChanged=!1;for(var k$a=[],k$b=0,k$c=0,k$d=this.numChildren;k$c<k$d;k$c++){var k$e=this.getChildAt(k$c);k$e&&k$e.layoutEnabled&&(k$a.push(k$e),k$b=this._width?this._width:Math.max(k$b,k$e.width*k$e.scaleX))}this.sortItem(k$a);var k$f=0;for(k$c=0,k$d=k$a.length;k$c<k$d;k$c++)(k$e=k$a[k$c]).y=k$f,k$f+=k$e.height*k$e.scaleY+this._space,"left"==this._align?k$e.x=0:"center"==this._align?k$e.x=.5*(k$b-k$e.width*k$e.scaleX):"right"==this._align&&(k$e.x=k$b-k$e.width*k$e.scaleX);this.changeSize()},k$e(0,k$c,"width",k$a.prototype._$get_width,function(k$a){this._width!=k$a&&(k$p.superSet(k$V,this,"width",k$a),this.callLater(this.changeItems))}),k$b.NONE="none",k$b.LEFT="left",k$b.CENTER="center",k$b.RIGHT="right",k$b}(k$V),k$ha=function(k$a){function k$b(){k$b.__super.call(this)}return k$f(k$b,"laya.ui.RadioGroup",k$_),k$b.prototype.createItem=function(k$a,k$b){return new k$u(k$a,k$b)},k$b}(),k$ia=function(k$a){function k$b(){k$b.__super.call(this)}return k$f(k$b,"laya.ui.Tab",k$_),k$b.prototype.createItem=function(k$a,k$b){return new k$K(k$a,k$b)},k$b}(),k$ja=function(k$b){function k$c(k$a){this._vScrollBar=null,this._hScrollBar=null,void 0===k$a&&(k$a=""),k$c.__super.call(this,k$a)}k$f(k$c,"laya.ui.TextArea",k$b);var k$a=k$c.prototype;return k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,k$a),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},k$a.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},k$a.onVBarChanged=function(k$a){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},k$a.onHBarChanged=function(k$a){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},k$a.changeScroll=function(){var k$a=this._vScrollBar&&0<this._tf.maxScrollY,k$b=this._hScrollBar&&0<this._tf.maxScrollX,k$c=k$a?this._width-this._vScrollBar.width:this._width,k$d=k$b?this._height-this._hScrollBar.height:this._height,k$e=this._tf.padding||k$D.labelPadding;this._tf.width=k$c,this._tf.height=k$d,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-k$e[2],this._vScrollBar.y=k$e[1],this._vScrollBar.height=this._height-(k$b?this._hScrollBar.height:0)-k$e[1]-k$e[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=k$d/Math.max(this._tf.textHeight,k$d),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=k$a),this._hScrollBar&&(this._hScrollBar.x=k$e[0],this._hScrollBar.y=this._height-this._hScrollBar.height-k$e[3],this._hScrollBar.width=this._width-(k$a?this._vScrollBar.width:0)-k$e[0]-k$e[2],this._hScrollBar.scrollSize=Math.max(.033*k$c,1),this._hScrollBar.thumbPercent=k$c/Math.max(this._tf.textWidth,k$c),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=k$b)},k$a.scrollTo=function(k$a){this.commitMeasure(),this._tf.scrollY=k$a},k$e(0,k$a,"scrollY",function(){return this._tf.scrollY}),k$e(0,k$a,"width",k$b.prototype._$get_width,function(k$a){k$p.superSet(k$ca,this,"width",k$a),this.callLater(this.changeScroll)}),k$e(0,k$a,"hScrollBar",function(){return this._hScrollBar}),k$e(0,k$a,"height",k$b.prototype._$get_height,function(k$a){k$p.superSet(k$ca,this,"height",k$a),this.callLater(this.changeScroll)}),k$e(0,k$a,"maxScrollX",function(){return this._tf.maxScrollX}),k$e(0,k$a,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(k$a){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new k$ba),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=k$a}),k$e(0,k$a,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(k$a){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new k$Y),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=k$a}),k$e(0,k$a,"vScrollBar",function(){return this._vScrollBar}),k$e(0,k$a,"maxScrollY",function(){return this._tf.maxScrollY}),k$e(0,k$a,"scrollX",function(){return this._tf.scrollX}),k$c}(k$ca);!function(k$a){function k$b(){this._uiView=null,this.isCloseOther=!1,k$b.__super.call(this)}k$f(k$b,"laya.ui.AsynDialog",k$ea);var k$c=k$b.prototype;k$c.createView=function(k$a){this._uiView=k$a},k$c._open=function(k$a,k$b,k$c){this.isModal=k$a,this.isCloseOther=k$b,k$ea.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},k$c.onCreated=function(){this.createUI(),this.onOpen()},k$c.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},k$c.onOpen=function(){k$ea.manager.open(this,this.isCloseOther),k$ea.manager.lock(!1)},k$c.close=function(k$a,k$b){void 0===k$b&&(k$b=!0),k$ea.manager.close(this),this.onClose()},k$c.onClose=function(){},k$c.destroy=function(k$a){void 0===k$a&&(k$a=!0),laya.ui.View.prototype.destroy.call(this,k$a),this._uiView=null,this.onDestroy()},k$c.onDestroy=function(){}}();k$p.__init([k$T])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(k$a,k$b){"use strict";for(var k$c in Object.defineProperty(k$b,"__esModule",{value:!0}),Laya){var k$d=Laya[k$c];k$d&&k$d.__isclass&&(k$b[k$c]=k$d)}}),function(k$m,k$a,k$x){k$x.un,k$x.uns;var k$l=k$x.static,k$n=k$x.class,k$o=k$x.getset,k$d=k$x.__newvec,k$w=laya.maths.Arith,k$g=laya.webgl.atlas.AtlasResourceManager,k$c=laya.webgl.shader.BaseShader,k$H=laya.utils.Browser,k$h=laya.webgl.utils.Buffer,k$y=laya.utils.Byte,k$e=laya.utils.ClassUtils,k$i=k$x.Config,k$f=(laya.events.Event,laya.events.EventDispatcher),k$D=laya.utils.Handler,k$r=laya.net.Loader,k$b=laya.net.LoaderManager,k$j=(laya.maths.MathUtil,laya.display.Node),k$p=laya.renders.Render,k$k=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),k$q=laya.resource.Resource,k$s=laya.utils.RunDriver,k$t=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),k$z=laya.display.Sprite,k$A=laya.utils.Stat,k$B=laya.utils.StringKey,k$E=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),k$C=laya.utils.Utils,k$F=laya.webgl.WebGL,k$G=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;k$x.interface("laya.d3.core.IClone"),k$x.interface("laya.d3.graphics.IVertex"),k$x.interface("laya.d3.core.render.IUpdate"),k$x.interface("laya.d3.core.scene.ITreeNode"),k$x.interface("laya.d3.core.render.IRenderable");(function(){function k$K(){}k$n(k$K,"laya.d3.animation.AnimationClipParser01"),k$K.READ_DATA=function(){k$K._DATA.offset=k$K._reader.getUint32(),k$K._DATA.size=k$K._reader.getUint32()},k$K.READ_BLOCK=function(){for(var k$a=k$K._BLOCK.count=k$K._reader.getUint16(),k$b=k$K._BLOCK.blockStarts=[],k$c=k$K._BLOCK.blockLengths=[],k$d=0;k$d<k$a;k$d++)k$b.push(k$K._reader.getUint32()),k$c.push(k$K._reader.getUint32())},k$K.READ_STRINGS=function(){var k$a=k$K._reader.getUint32(),k$b=k$K._reader.getUint16(),k$c=k$K._reader.pos;k$K._reader.pos=k$a+k$K._DATA.offset;for(var k$d=0;k$d<k$b;k$d++)k$K._strings[k$d]=k$K._reader.readUTFString();k$K._reader.pos=k$c},k$K.parse=function(k$a,k$b){k$K._animationClip=k$a;(k$K._reader=k$b).__getBuffer();k$K.READ_DATA(),k$K.READ_BLOCK(),k$K.READ_STRINGS();for(var k$c=0,k$d=k$K._BLOCK.count;k$c<k$d;k$c++){var k$e=k$b.getUint16(),k$f=k$K._strings[k$e],k$g=k$K["READ_"+k$f];if(null==k$g)throw new Error("model file err,no this function:"+k$e+" "+k$f);k$g.call()}},k$K.READ_ANIMATIONS=function(){var k$a,k$b=0,k$c=0,k$d=k$K._reader,k$e=k$d.__getBuffer(),k$f=[],k$g=k$d.getUint8();for(k$f.length=k$g,k$b=0;k$b<k$g;k$b++)k$f[k$b]=k$d.getUint16();var k$h=[],k$i=k$d.getUint16();for(k$h.length=k$i,k$b=0;k$b<k$i;k$b++)k$h[k$b]=k$d.getFloat32();var k$j=k$K._animationClip;k$j.name=k$K._strings[k$d.getUint16()];var k$k=k$j._duration=k$d.getFloat32();k$j.islooping=!!k$d.getByte(),k$j._frameRate=k$d.getInt16();var k$l=k$d.getInt16(),k$m=k$j._nodes=new Array;k$m.length=k$l,(k$j._publicClipDatas=[]).length=k$l;var k$n=k$j._nodesMap={},k$o=0,k$p=0;for(k$b=0;k$b<k$l;k$b++){k$a=k$m[k$b]=new k$S;var k$q=k$d.getUint16(),k$r=k$a.path=[];for(k$r.length=k$q,k$c=0;k$c<k$q;k$c++)k$r[k$c]=k$K._strings[k$d.getUint16()];var k$s=k$r.join("/"),k$t=k$n[k$s];k$t||(k$n[k$s]=k$t=[]),k$t.push(k$a);var k$w=k$d.getInt16();-1!==k$w&&(k$a.componentType=k$K._strings[k$w]);var k$x=k$Q._propertyIndexDic[k$K._strings[k$d.getUint16()]];if(null==k$x)throw new Error("AnimationClipParser01:unknown property name.");var k$y=k$x<4,k$z=!k$y||k$y&&""===k$r[0];(k$a._cacheProperty=k$z)?k$o++:k$p++,k$a.propertyNameID=k$x;var k$A=k$f[k$d.getUint8()];k$a.keyFrameWidth=k$A/4;var k$B=k$a.keyFrames=[],k$C=k$B.length=k$d.getUint16(),k$D=null,k$E=NaN;for(k$c=0;k$c<k$C;k$c++){var k$F=k$B[k$c]=new k$R;k$E=k$F.startTime=k$h[k$d.getUint16()];var k$G=k$d.pos;k$F.inTangent=new Float32Array(k$e.slice(k$G,k$G+k$A)),k$d.pos+=k$A,k$G=k$d.pos,k$F.outTangent=new Float32Array(k$e.slice(k$G,k$G+k$A)),k$d.pos+=k$A,k$G=k$d.pos,k$F.data=new Float32Array(k$e.slice(k$G,k$G+k$A)),k$d.pos+=k$A,k$D&&(k$D.next=k$F,k$D.duration=k$E-k$D.startTime),k$D=k$F}k$F.next=null,k$F.duration=k$k-k$E}var k$H=k$j._nodeToCachePropertyMap=new Int32Array(k$l),k$I=k$j._cachePropertyMap=new Int32Array(k$o),k$J=k$j._unCachePropertyMap=new Int32Array(k$p);for(k$o=k$p=0,k$b=0;k$b<k$l;k$b++)(k$a=k$m[k$b])._cacheProperty?(k$H[k$b]=k$o,k$I[k$o++]=k$b):k$J[k$p++]=k$b},k$K._animationClip=null,k$K._reader=null,k$K._strings=[],k$l(k$K,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function k$O(){}k$n(k$O,"laya.d3.animation.AnimationClipParser02"),k$O.READ_DATA=function(){k$O._DATA.offset=k$O._reader.getUint32(),k$O._DATA.size=k$O._reader.getUint32()},k$O.READ_BLOCK=function(){for(var k$a=k$O._BLOCK.count=k$O._reader.getUint16(),k$b=k$O._BLOCK.blockStarts=[],k$c=k$O._BLOCK.blockLengths=[],k$d=0;k$d<k$a;k$d++)k$b.push(k$O._reader.getUint32()),k$c.push(k$O._reader.getUint32())},k$O.READ_STRINGS=function(){var k$a=k$O._reader.getUint32(),k$b=k$O._reader.getUint16(),k$c=k$O._reader.pos;k$O._reader.pos=k$a+k$O._DATA.offset;for(var k$d=0;k$d<k$b;k$d++)k$O._strings[k$d]=k$O._reader.readUTFString();k$O._reader.pos=k$c},k$O.parse=function(k$a,k$b){k$O._animationClip=k$a;(k$O._reader=k$b).__getBuffer();k$O.READ_DATA(),k$O.READ_BLOCK(),k$O.READ_STRINGS();for(var k$c=0,k$d=k$O._BLOCK.count;k$c<k$d;k$c++){var k$e=k$b.getUint16(),k$f=k$O._strings[k$e],k$g=k$O["READ_"+k$f];if(null==k$g)throw new Error("model file err,no this function:"+k$e+" "+k$f);k$g.call()}},k$O.READ_ANIMATIONS=function(){var k$a,k$b=0,k$c=0,k$d=k$O._reader,k$e=k$d.__getBuffer(),k$f=[],k$g=k$d.getUint8();for(k$f.length=k$g,k$b=0;k$b<k$g;k$b++)k$f[k$b]=k$d.getUint16();var k$h=[],k$i=k$d.getUint16();for(k$h.length=k$i,k$b=0;k$b<k$i;k$b++)k$h[k$b]=k$d.getFloat32();var k$j=k$O._animationClip;k$j.name=k$O._strings[k$d.getUint16()];var k$k=k$j._duration=k$d.getFloat32();k$j.islooping=!!k$d.getByte(),k$j._frameRate=k$d.getInt16();var k$l=k$d.getInt16(),k$m=k$j._nodes=new Array;k$m.length=k$l,(k$j._publicClipDatas=[]).length=k$l;var k$n=k$j._nodesMap={},k$o=0,k$p=0;for(k$b=0;k$b<k$l;k$b++){k$a=k$m[k$b]=new k$S;var k$q=k$d.getUint16(),k$r=k$a.path=[];for(k$r.length=k$q,k$c=0;k$c<k$q;k$c++)k$r[k$c]=k$O._strings[k$d.getUint16()];var k$s=k$r.join("/"),k$t=k$n[k$s];k$t||(k$n[k$s]=k$t=[]),k$t.push(k$a);var k$w=k$d.getInt16();-1!==k$w&&(k$a.componentType=k$O._strings[k$w]);var k$x=k$Q._propertyIndexDic[k$O._strings[k$d.getUint16()]];if(null==k$x)throw new Error("AnimationClipParser02:unknown property name.");var k$y=k$x<4,k$z=!k$y||k$y&&""===k$r[0];(k$a._cacheProperty=k$z)?k$o++:k$p++,k$a.propertyNameID=k$x;var k$A=k$f[k$d.getUint8()];k$a.keyFrameWidth=k$A/4;var k$B=k$a.keyFrames=[],k$C=k$B.length=k$d.getUint16(),k$D=null,k$E=NaN;for(k$c=0;k$c<k$C;k$c++){var k$F=k$B[k$c]=new k$R;k$E=k$F.startTime=k$h[k$d.getUint16()];var k$G=k$d.pos;k$F.inTangent=new Float32Array(k$e.slice(k$G,k$G+k$A)),k$d.pos+=k$A,k$G=k$d.pos,k$F.outTangent=new Float32Array(k$e.slice(k$G,k$G+k$A)),k$d.pos+=k$A,k$G=k$d.pos,k$F.data=new Float32Array(k$e.slice(k$G,k$G+k$A)),k$d.pos+=k$A,k$D&&(k$D.next=k$F,k$D.duration=k$E-k$D.startTime),k$D=k$F}k$F.next=null,k$F.duration=k$k-k$E}var k$H=k$d.getUint16();for(k$b=0;k$b<k$H;k$b++){var k$I,k$J=new k$P;k$J.time=k$d.getFloat32(),k$J.eventName=k$O._strings[k$d.getUint16()];var k$K=k$d.getUint16();for(0<k$K&&(k$J.params=k$I=[]),k$c=0;k$c<k$K;k$c++){switch(k$d.getByte()){case 0:k$I.push(!!k$d.getByte());break;case 1:k$I.push(k$d.getInt32());break;case 2:k$I.push(k$d.getFloat32());break;case 3:k$I.push(k$O._strings[k$d.getUint16()]);break;default:throw new Error("unknown type.")}}k$j.addEvent(k$J)}var k$L=k$j._nodeToCachePropertyMap=new Int32Array(k$l),k$M=k$j._cachePropertyMap=new Int32Array(k$o),k$N=k$j._unCachePropertyMap=new Int32Array(k$p);for(k$o=k$p=0,k$b=0;k$b<k$l;k$b++)(k$a=k$m[k$b])._cacheProperty?(k$L[k$b]=k$o,k$M[k$o++]=k$b):k$N[k$p++]=k$b},k$O._animationClip=null,k$O._reader=null,k$O._strings=[],k$l(k$O,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var k$P=function(){function k$a(){this.time=NaN,this.eventName=null,this.params=null}return k$n(k$a,"laya.d3.animation.AnimationEvent"),k$a}(),k$Q=function(){function k$d(){this._childs=[],this.transform=new k$sb(this)}k$n(k$d,"laya.d3.animation.AnimationNode");var k$a=k$d.prototype;return k$x.imps(k$a,{"laya.d3.core.IClone":!0}),k$a.addChild=function(k$a){k$a._parent=this,k$a.transform.setParent(this.transform),this._childs.push(k$a)},k$a.removeChild=function(k$a){var k$b=this._childs.indexOf(k$a);-1!==k$b&&this._childs.splice(k$b,1)},k$a.getChildByName=function(k$a){for(var k$b=0,k$c=this._childs.length;k$b<k$c;k$b++){var k$d=this._childs[k$b];if(k$d.name===k$a)return k$d}return null},k$a.getChildByIndex=function(k$a){return this._childs[k$a]},k$a.getChildCount=function(){return this._childs.length},k$a.cloneTo=function(k$a){var k$b=k$a;k$b.name=this.name;for(var k$c=0,k$d=this._childs.length;k$c<k$d;k$c++){var k$e=this._childs[k$c],k$f=k$e.clone();k$b.addChild(k$f);var k$g=k$e.transform,k$h=k$f.transform;k$h.setLocalPosition(k$g.getLocalPosition()),k$h.setLocalRotation(k$g.getLocalRotation()),k$h.setLocalScale(k$g.getLocalScale()),k$h._localRotationEuler=k$g._localRotationEuler,k$h._setWorldMatrixIgnoreUpdate(k$g.getWorldMatrix())}},k$a.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$d.__init__=function(){k$d.registerAnimationNodeProperty("localPosition",k$d._getLocalPosition,k$d._setLocalPosition),k$d.registerAnimationNodeProperty("localRotation",k$d._getLocalRotation,k$d._setLocalRotation),k$d.registerAnimationNodeProperty("localScale",k$d._getLocalScale,k$d._setLocalScale),k$d.registerAnimationNodeProperty("localRotationEuler",k$d._getLocalRotationEuler,k$d._setLocalRotationEuler),k$d.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",k$d._getParticleRenderSharedMaterialTintColor,k$d._setParticleRenderSharedMaterialTintColor),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",k$d._getMeshRenderSharedMaterialTilingOffset,k$d._setMeshRenderSharedMaterialTilingOffset),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",k$d._getMeshRenderSharedMaterialAlbedo,k$d._setMeshRenderSharedMaterialAlbedo),k$d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",k$d._getSkinnedMeshRenderSharedMaterialTilingOffset,k$d._setSkinnedMeshRenderSharedMaterialTilingOffset),k$d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",k$d._getSkinnedMeshRenderSharedMaterialAlbedo,k$d._setSkinnedMeshRenderSharedMaterialAlbedo),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",k$d._getMeshRenderSharedMaterialAlbedo,k$d._setMeshRenderSharedMaterialAlbedo),k$d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",k$d._getSkinnedMeshRenderSharedMaterialAlbedo,k$d._setSkinnedMeshRenderSharedMaterialAlbedo),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",k$d._getMeshRenderSharedMaterialIntensity,k$d._setMeshRenderSharedMaterialIntensity),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",k$d._getMeshRenderSharedMaterialAlpha,k$d._setMeshRenderSharedMaterialAlpha),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",k$d._getMeshRenderSharedMaterialAlphaColor,k$d._setMeshRenderSharedMaterialAlphaColor),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",k$d._getMeshRenderSharedMaterialBaseColor,k$d._setMeshRenderSharedMaterialBaseColor),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",k$d._getMeshRenderSharedMaterialDissolve,k$d._setMeshRenderSharedMaterialDissolve),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",k$d._getMeshRenderSharedMaterialDissolveSpeed,k$d._setMeshRenderSharedMaterialDissolveSpeed),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",k$d._getMeshRenderSharedMaterialMMultiplier,k$d._setMeshRenderSharedMaterialMMultiplier),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",k$d._getMeshRenderSharedMaterialBaseScrollSpeedX,k$d._setMeshRenderSharedMaterialBaseScrollSpeedX),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",k$d._getMeshRenderSharedMaterialBaseScrollSpeedY,k$d._setMeshRenderSharedMaterialBaseScrollSpeedY),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",k$d._getMeshRenderSharedMaterialSecondScrollSpeedX,k$d._setMeshRenderSharedMaterialSecondScrollSpeedX),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",k$d._getMeshRenderSharedMaterialSecondScrollSpeedY,k$d._setMeshRenderSharedMaterialSecondScrollSpeedY),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",k$d._getMeshRenderSharedMaterialDetailTilingOffset,k$d._setMeshRenderSharedMaterialDetailTilingOffset),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",k$d._getMeshRenderSharedMaterialDissolveTilingOffset,k$d._setMeshRenderSharedMaterialDissolveTilingOffset),k$d.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",k$d._getMeshRenderSharedMaterialMaskTilingOffset,k$d._setMeshRenderSharedMaterialMaskTilingOffset)},k$d.registerAnimationNodeProperty=function(k$a,k$b,k$c){if(k$d._propertyIndexDic[k$a])throw new Error("AnimationNode: this propertyName has registered.");k$d._propertyIndexDic[k$a]=k$d._propertyIDCounter,k$d._propertyGetFuncs[k$d._propertyIDCounter]=k$b,k$d._propertySetFuncs[k$d._propertyIDCounter]=k$c,k$d._propertyIDCounter++},k$d._getLocalPosition=function(k$a,k$b){return k$a?k$a.transform.getLocalPosition():k$b._transform.localPosition.elements},k$d._setLocalPosition=function(k$a,k$b,k$c){if(k$a)k$a.transform.setLocalPosition(k$c);else{var k$d=k$b._transform,k$e=k$d.localPosition;k$e.elements=k$c,k$d.localPosition=k$e}},k$d._getLocalRotation=function(k$a,k$b){return k$a?k$a.transform.getLocalRotation():k$b._transform.localRotation.elements},k$d._setLocalRotation=function(k$a,k$b,k$c){if(k$a)k$a.transform.setLocalRotation(k$c);else{var k$d=k$b._transform,k$e=k$d.localRotation;k$e.elements=k$c,k$d.localRotation=k$e}},k$d._getLocalScale=function(k$a,k$b){return k$a?k$a.transform.getLocalScale():k$b._transform.localScale.elements},k$d._setLocalScale=function(k$a,k$b,k$c){if(k$a)k$a.transform.setLocalScale(k$c);else{var k$d=k$b._transform,k$e=k$d.localScale;k$e.elements=k$c,k$d.localScale=k$e}},k$d._getLocalRotationEuler=function(k$a,k$b){return k$a?k$a.transform.getLocalRotationEuler():k$b._transform.localRotationEuler.elements},k$d._setLocalRotationEuler=function(k$a,k$b,k$c){if(k$a)k$a.transform.setLocalRotationEuler(k$c);else{var k$d=k$b._transform,k$e=k$d.localRotationEuler;k$e.elements=k$c,k$d.localRotationEuler=k$e}},k$d._getMeshRenderSharedMaterialTilingOffset=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return k$b.meshRender.sharedMaterial.tilingOffset.elements},k$d._setMeshRenderSharedMaterialTilingOffset=function(k$a,k$b,k$c){var k$d,k$e;if(k$a){var k$f=k$a.transform._entity;k$f&&((k$e=(k$d=k$f.owner.meshRender.material).tilingOffset).elements=k$c,k$d.tilingOffset=k$e)}else(k$e=(k$d=k$b.meshRender.material).tilingOffset).elements=k$c,k$d.tilingOffset=k$e},k$d._getMeshRenderSharedMaterialAlbedo=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.albedoColor.elements:null}return k$b.meshRender.sharedMaterial.albedoColor.elements},k$d._setMeshRenderSharedMaterialAlbedo=function(k$a,k$b,k$c){var k$d,k$e;if(k$a){var k$f=k$a.transform._entity;k$f&&((k$e=(k$d=k$f.owner.meshRender.material).albedoColor).elements=k$c,k$d.albedoColor=k$e)}else(k$e=(k$d=k$b.meshRender.material).albedoColor).elements=k$c,k$d.albedoColor=k$e},k$d._getSkinnedMeshRenderSharedMaterialTilingOffset=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return k$b.skinnedMeshRender.sharedMaterial.tilingOffset.elements},k$d._setSkinnedMeshRenderSharedMaterialTilingOffset=function(k$a,k$b,k$c){var k$d,k$e;if(k$a){var k$f=k$a.transform._entity;k$f&&((k$e=(k$d=k$f.owner.skinnedMeshRender.material).tilingOffset).elements=k$c,k$d.tilingOffset=k$e)}else(k$e=(k$d=k$b.skinnedMeshRender.material).tilingOffset).elements=k$c,k$d.tilingOffset=k$e},k$d._getSkinnedMeshRenderSharedMaterialAlbedo=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return k$b.skinnedMeshRender.sharedMaterial.albedoColor.elements},k$d._setSkinnedMeshRenderSharedMaterialAlbedo=function(k$a,k$b,k$c){var k$d,k$e;if(k$a){var k$f=k$a.transform._entity;k$f&&((k$e=(k$d=k$f.owner.skinnedMeshRender.material).albedoColor).elements=k$c,k$d.albedoColor=k$e)}else(k$e=(k$d=k$b.skinnedMeshRender.material).albedoColor).elements=k$c,k$d.albedoColor=k$e},k$d._getParticleRenderSharedMaterialTintColor=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.particleRender.sharedMaterial.tintColor.elements:null}return k$b.particleRender.sharedMaterial.tintColor.elements},k$d._setParticleRenderSharedMaterialTintColor=function(k$a,k$b,k$c){var k$d,k$e;if(k$a){var k$f=k$a.transform._entity;k$f&&((k$e=(k$d=k$f.owner.particleRender.material).tintColor).elements=k$c,k$d.tintColor=k$e)}else(k$e=(k$d=k$b.particleRender.material).tintColor).elements=k$c,k$d.tintColor=k$e},k$d._getMeshRenderSharedMaterialAlphaColor=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.alphaColor.elements:null}return k$b.meshRender.sharedMaterial.alphaColor.elements},k$d._setMeshRenderSharedMaterialAlphaColor=function(k$a,k$b,k$c){var k$d,k$e;if(k$a){var k$f=k$a.transform._entity;k$f&&((k$e=(k$d=k$f.owner.meshRender.material).alphaColor).elements=k$c,k$d.alphaColor=k$e)}else(k$e=(k$d=k$b.meshRender.material).alphaColor).elements=k$c,k$d.alphaColor=k$e},k$d._getMeshRenderSharedMaterialBaseColor=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.baseColor.elements:null}return k$b.meshRender.sharedMaterial.baseColor.elements},k$d._setMeshRenderSharedMaterialBaseColor=function(k$a,k$b,k$c){var k$d,k$e;if(k$a){var k$f=k$a.transform._entity;k$f&&((k$e=(k$d=k$f.owner.meshRender.material).baseColor).elements=k$c,k$d.baseColor=k$e)}else(k$e=(k$d=k$b.meshRender.material).baseColor).elements=k$c,k$d.baseColor=k$e},k$d._getMeshRenderSharedMaterialDissolve=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.dissolve:0}return k$b.meshRender.sharedMaterial.dissolve},k$d._setMeshRenderSharedMaterialDissolve=function(k$a,k$b,k$c){if(k$a){var k$d=k$a.transform._entity;k$d&&(k$d.owner.meshRender.material.dissolve=k$c[0])}else k$b.meshRender.material.dissolve=k$c[0]},k$d._getMeshRenderSharedMaterialDissolveSpeed=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.dissolveSpeed:0}return k$b.meshRender.sharedMaterial.dissolveSpeed},k$d._setMeshRenderSharedMaterialDissolveSpeed=function(k$a,k$b,k$c){if(k$a){var k$d=k$a.transform._entity;k$d&&(k$d.owner.meshRender.material.dissolveSpeed=k$c[0])}else k$b.meshRender.material.dissolveSpeed=k$c[0]},k$d._getMeshRenderSharedMaterialMMultiplier=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.mMultiplier:0}return k$b.meshRender.sharedMaterial.mMultiplier},k$d._setMeshRenderSharedMaterialMMultiplier=function(k$a,k$b,k$c){if(k$a){var k$d=k$a.transform._entity;k$d&&(k$d.owner.meshRender.material.mMultiplier=k$c[0])}else k$b.meshRender.material.mMultiplier=k$c[0]},k$d._getMeshRenderSharedMaterialBaseScrollSpeedX=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return k$b.meshRender.sharedMaterial.baseScrollSpeedX},k$d._setMeshRenderSharedMaterialBaseScrollSpeedX=function(k$a,k$b,k$c){if(k$a){var k$d=k$a.transform._entity;k$d&&(k$d.owner.meshRender.material.baseScrollSpeedX=k$c[0])}else k$b.meshRender.material.baseScrollSpeedX=k$c[0]},k$d._getMeshRenderSharedMaterialBaseScrollSpeedY=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return k$b.meshRender.sharedMaterial.baseScrollSpeedY},k$d._setMeshRenderSharedMaterialBaseScrollSpeedY=function(k$a,k$b,k$c){if(k$a){var k$d=k$a.transform._entity;k$d&&(k$d.owner.meshRender.material.baseScrollSpeedY=k$c[0])}else k$b.meshRender.material.baseScrollSpeedY=k$c[0]},k$d._getMeshRenderSharedMaterialSecondScrollSpeedX=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return k$b.meshRender.sharedMaterial.secondScrollSpeedX},k$d._setMeshRenderSharedMaterialSecondScrollSpeedX=function(k$a,k$b,k$c){if(k$a){var k$d=k$a.transform._entity;k$d&&(k$d.owner.meshRender.material.secondScrollSpeedX=k$c[0])}else k$b.meshRender.material.secondScrollSpeedX=k$c[0]},k$d._getMeshRenderSharedMaterialSecondScrollSpeedY=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return k$b.meshRender.sharedMaterial.secondScrollSpeedY},k$d._setMeshRenderSharedMaterialSecondScrollSpeedY=function(k$a,k$b,k$c){if(k$a){var k$d=k$a.transform._entity;k$d&&(k$d.owner.meshRender.material.secondScrollSpeedY=k$c[0])}else k$b.meshRender.material.secondScrollSpeedY=k$c[0]},k$d._getMeshRenderSharedMaterialAlpha=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.alpha:0}return k$b.meshRender.sharedMaterial.alpha},k$d._setMeshRenderSharedMaterialAlpha=function(k$a,k$b,k$c){if(k$a){var k$d=k$a.transform._entity;k$d&&(k$d.owner.meshRender.material.alpha=k$c[0])}else k$b.meshRender.material.alpha=k$c[0]},k$d._getMeshRenderSharedMaterialIntensity=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.intensity:0}return k$b.meshRender.sharedMaterial.intensity},k$d._setMeshRenderSharedMaterialIntensity=function(k$a,k$b,k$c){if(k$a){var k$d=k$a.transform._entity;k$d&&(k$d.owner.meshRender.material.intensity=k$c[0])}else k$b.meshRender.material.intensity=k$c[0]},k$d._getMeshRenderSharedMaterialDetailTilingOffset=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return k$b.meshRender.sharedMaterial.detailTilingOffset.elements},k$d._setMeshRenderSharedMaterialDetailTilingOffset=function(k$a,k$b,k$c){var k$d,k$e;if(k$a){var k$f=k$a.transform._entity;k$f&&((k$e=(k$d=k$f.owner.meshRender.material).detailTilingOffset).elements=k$c,k$d.detailTilingOffset=k$e)}else(k$e=(k$d=k$b.meshRender.material).detailTilingOffset).elements=k$c,k$d.detailTilingOffset=k$e},k$d._getMeshRenderSharedMaterialDissolveTilingOffset=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return k$b.meshRender.sharedMaterial.dissolveTilingOffset.elements},k$d._setMeshRenderSharedMaterialDissolveTilingOffset=function(k$a,k$b,k$c){var k$d,k$e;if(k$a){var k$f=k$a.transform._entity;k$f&&((k$e=(k$d=k$f.owner.meshRender.material).dissolveTilingOffset).elements=k$c,k$d.dissolveTilingOffset=k$e)}else(k$e=(k$d=k$b.meshRender.material).dissolveTilingOffset).elements=k$c,k$d.dissolveTilingOffset=k$e},k$d._getMeshRenderSharedMaterialMaskTilingOffset=function(k$a,k$b){if(k$a){var k$c=k$a.transform._entity;return k$c?k$c.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return k$b.meshRender.sharedMaterial.maskTilingOffset.elements},k$d._setMeshRenderSharedMaterialMaskTilingOffset=function(k$a,k$b,k$c){var k$d,k$e;if(k$a){var k$f=k$a.transform._entity;k$f&&((k$e=(k$d=k$f.owner.meshRender.material).maskTilingOffset).elements=k$c,k$d.maskTilingOffset=k$e)}else(k$e=(k$d=k$b.meshRender.material).maskTilingOffset).elements=k$c,k$d.maskTilingOffset=k$e},k$d._propertyIDCounter=0,k$d._propertyIndexDic={},k$d._propertySetFuncs=[],k$d._propertyGetFuncs=[],k$d}(),k$R=function(){function k$a(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return k$n(k$a,"laya.d3.animation.Keyframe"),k$a}(),k$S=function(){function k$a(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return k$n(k$a,"laya.d3.animation.KeyframeNode"),k$a}(),k$I=(function(){function k$a(){this._tempVector30=new k$gb,this._tempVector31=new k$gb,this._tempVector32=new k$gb,this._a=new k$gb,this._b=new k$gb,this._c=new k$gb,this._d=new k$gb}k$n(k$a,"laya.d3.core.glitter.SplineCurvePositionVelocity");var k$b=k$a.prototype;k$b.Init=function(k$a,k$b,k$c,k$d){k$a.cloneTo(this._d),k$b.cloneTo(this._c),k$gb.scale(k$a,2,this._a),k$gb.scale(k$c,2,this._tempVector30),k$gb.subtract(this._a,this._tempVector30,this._a),k$gb.add(this._a,k$b,this._a),k$gb.add(this._a,k$d,this._a),k$gb.scale(k$c,3,this._b),k$gb.scale(k$a,3,this._tempVector30),k$gb.subtract(this._b,this._tempVector30,this._b),k$gb.subtract(this._b,k$d,this._b),k$gb.scale(k$b,2,this._tempVector30),k$gb.subtract(this._b,this._tempVector30,this._b)},k$b.Slerp=function(k$a,k$b){k$gb.scale(this._a,k$a*k$a*k$a,this._tempVector30),k$gb.scale(this._b,k$a*k$a,this._tempVector31),k$gb.scale(this._c,k$a,this._tempVector32),k$gb.add(this._tempVector30,this._tempVector31,k$b),k$gb.add(k$b,this._tempVector32,k$b),k$gb.add(k$b,this._d,k$b)}}(),function(){function k$M(k$a,k$b,k$c,k$d){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=k$a,this._h=k$b,this._minHeight=k$c,this._maxHeight=k$d}k$n(k$M,"laya.d3.core.HeightMap");var k$a=k$M.prototype;k$a._inBounds=function(k$a,k$b){return 0<=k$a&&k$a<this._h&&0<=k$b&&k$b<this._w},k$a.getHeight=function(k$a,k$b){return this._inBounds(k$a,k$b)?this._datas[k$a][k$b]:NaN},k$o(0,k$a,"width",function(){return this._w}),k$o(0,k$a,"height",function(){return this._h}),k$o(0,k$a,"maxHeight",function(){return this._maxHeight}),k$o(0,k$a,"minHeight",function(){return this._minHeight}),k$M.creatFromMesh=function(k$a,k$b,k$c,k$d){for(var k$e=[],k$f=[],k$g=k$a.getSubMeshCount(),k$h=0;k$h<k$g;k$h++){for(var k$i=k$a.getSubMesh(k$h),k$j=k$i._getVertexBuffer(),k$k=k$j.getData(),k$l=[],k$m=0;k$m<k$k.length;k$m+=k$j.vertexDeclaration.vertexStride/4){var k$n=new k$gb(k$k[k$m+0],k$k[k$m+1],k$k[k$m+2]);k$l.push(k$n)}k$e.push(k$l);var k$o=k$i._getIndexBuffer();k$f.push(k$o.getData())}var k$p=k$a.boundingBox,k$q=k$p.min.x,k$r=k$p.min.z,k$s=k$p.max.x,k$t=k$p.max.z,k$w=k$p.min.y,k$x=k$p.max.y,k$y=k$s-k$q,k$z=k$t-k$r,k$A=k$d.elements[0]=k$y/(k$b-1),k$B=k$d.elements[1]=k$z/(k$c-1),k$C=new k$M(k$b,k$c,k$w,k$x),k$D=k$M._tempRay,k$E=k$D.direction.elements;k$E[0]=0,k$E[1]=-1,k$E[2]=0;var k$F=k$x+.1;k$D.origin.elements[1]=k$F;for(var k$G=0;k$G<k$c;k$G++){var k$H=k$r+k$G*k$B;k$C._datas[k$G]=[];for(var k$I=0;k$I<k$b;k$I++){var k$J=k$q+k$I*k$A,k$K=k$D.origin.elements;k$K[0]=k$J,k$K[2]=k$H;var k$L=k$M._getPosition(k$D,k$e,k$f);k$C._datas[k$G][k$I]=k$L===Number.MAX_VALUE?NaN:k$F-k$L}}return k$C},k$M.createFromImage=function(k$a,k$b,k$c){for(var k$d=k$a.width,k$e=k$a.height,k$f=new k$M(k$d,k$e,k$b,k$c),k$g=(k$c-k$b)/254,k$h=k$a.getPixels(),k$i=0,k$j=0;k$j<k$e;k$j++)for(var k$k=k$f._datas[k$j]=[],k$l=0;k$l<k$d;k$l++){var k$m=k$h[k$i++],k$n=k$h[k$i++],k$o=k$h[k$i++],k$p=k$h[k$i++];k$k[k$l]=255==k$m&&255==k$n&&255==k$o&&255==k$p?NaN:(k$m+k$n+k$o)/3*k$g+k$b}return k$f},k$M._getPosition=function(k$a,k$b,k$c){for(var k$d=Number.MAX_VALUE,k$e=0;k$e<k$b.length;k$e++)for(var k$f=k$b[k$e],k$g=k$c[k$e],k$h=0;k$h<k$g.length;k$h+=3){var k$i=k$f[k$g[k$h+0]],k$j=k$f[k$g[k$h+1]],k$k=k$f[k$g[k$h+2]],k$l=k$ob.rayIntersectsTriangle(k$a,k$i,k$j,k$k);!isNaN(k$l)&&k$l<k$d&&(k$d=k$l)}return k$d},k$l(k$M,["_tempRay",function(){return this._tempRay=new k$eb(new k$gb,new k$gb)}])}(),function(){function k$e(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}k$n(k$e,"laya.d3.core.Layer");var k$a=k$e.prototype;return k$a._binarySearchIndex=function(){for(var k$a=0,k$b=k$e._collsionTestList.length-1,k$c=0;k$a<=k$b;){k$c=Math.floor((k$a+k$b)/2);var k$d=k$e._collsionTestList[k$c];if(k$d==this._number)return k$c;k$d>this._number?k$b=k$c-1:k$a=k$c+1}return k$a},k$a._addCollider=function(k$a){0===this._colliders.length&&k$e._collsionTestList.splice(this._binarySearchIndex(),0,this._number),k$a._isRigidbody?(this._colliders.unshift(k$a),this._nonRigidbodyOffset++):this._colliders.push(k$a)},k$a._removeCollider=function(k$a){var k$b=this._colliders.indexOf(k$a);k$b<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(k$b,1),0===this._colliders.length&&k$e._collsionTestList.splice(k$e._collsionTestList.indexOf(this._number),1)},k$o(0,k$a,"number",function(){return this._number}),k$o(0,k$a,"visible",function(){return this._visible},function(k$a){this._visible=k$a,k$e._visibleLayers=k$a?k$e._visibleLayers|this.mask:k$e._visibleLayers&~this.mask}),k$o(0,k$a,"mask",function(){return this._mask}),k$o(1,k$e,"visibleLayers",function(){return k$e._visibleLayers},function(k$a){k$e._visibleLayers=k$a;for(var k$b=0,k$c=k$e._layerList.length;k$b<k$c;k$b++){var k$d=k$e._layerList[k$b];k$d._visible=0!=(k$d._mask&k$e._visibleLayers)}}),k$e.__init__=function(){k$e._layerList.length=31;for(var k$a=0;k$a<31;k$a++){var k$b=new k$e;k$e._layerList[k$a]=k$b,0===k$a?(k$b.name="Default Layer",k$b.visible=!0):(k$b.name="Layer-"+k$a,k$b.visible=!1),k$b._number=k$a,k$b._mask=Math.pow(2,k$a)}k$e.currentCreationLayer=k$e._layerList[0]},k$e.getLayerByNumber=function(k$a){if(k$a<0||30<k$a)throw new Error("无法返回指定Layer，该number超出范围！");return k$e._layerList[k$a]},k$e.getLayerByName=function(k$a){for(var k$b=0;k$b<31;k$b++)if(k$e._layerList[k$b].name===k$a)return k$e._layerList[k$b];throw new Error("无法返回指定Layer,该name不存在")},k$e.isVisible=function(k$a){return 0!=(k$a&k$e._currentCameraCullingMask&k$e._visibleLayers)},k$e._layerList=[],k$e._visibleLayers=2147483647,k$e._collsionTestList=[],k$e._currentCameraCullingMask=2147483647,k$e.maxCount=31,k$e.currentCreationLayer=null,k$e}()),k$J=(function(){function k$a(k$a,k$b,k$c){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=k$a,this._minCount=k$b,this._maxCount=k$c}k$n(k$a,"laya.d3.core.particleShuriKen.module.Burst");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b.cloneTo=function(k$a){var k$b=k$a;k$b._time=this._time,k$b._minCount=this._minCount,k$b._maxCount=this._maxCount},k$b.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$b,"time",function(){return this._time}),k$o(0,k$b,"minCount",function(){return this._minCount}),k$o(0,k$b,"maxCount",function(){return this._maxCount})}(),function(){function k$a(k$a){this._color=null,this.enbale=!1,this._color=k$a}k$n(k$a,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var k$b=k$a.prototype;k$b.cloneTo=function(k$a){var k$b=k$a;this._color.cloneTo(k$b._color),k$b.enbale=this.enbale},k$b.clone=function(){var k$a;switch(this._color.type){case 0:k$a=k$L.createByConstant(this._color.constant.clone());break;case 1:k$a=k$L.createByGradient(this._color.gradient.clone());break;case 2:k$a=k$L.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:k$a=k$L.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var k$b=new this.constructor(k$a);return k$b.enbale=this.enbale,k$b},k$o(0,k$b,"color",function(){return this._color})}(),function(){function k$a(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}k$n(k$a,"laya.d3.core.particleShuriKen.module.Emission");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),k$b._destroy=function(){this._bursts=null,this._destroyed=!0},k$b.getBurstsCount=function(){return this._bursts.length},k$b.getBurstByIndex=function(k$a){return this._bursts[k$a]},k$b.addBurst=function(k$a){var k$b=this._bursts.length;if(0<k$b)for(var k$c=0;k$c<k$b;k$c++)this._bursts[k$c].time>k$a.time&&this._bursts.splice(k$c,0,k$a);this._bursts.push(k$a)},k$b.removeBurst=function(k$a){var k$b=this._bursts.indexOf(k$a);-1!==k$b&&this._bursts.splice(k$b,1)},k$b.removeBurstByIndex=function(k$a){this._bursts.splice(k$a,1)},k$b.clearBurst=function(){this._bursts.length=0},k$b.cloneTo=function(k$a){var k$b=k$a,k$c=k$b._bursts;k$c.length=this._bursts.length;for(var k$d=0,k$e=this._bursts.length;k$d<k$e;k$d++){var k$f=k$c[k$d];k$f?this._bursts[k$d].cloneTo(k$f):k$c[k$d]=this._bursts[k$d].clone()}k$b._emissionRate=this._emissionRate,k$b.enbale=this.enbale},k$b.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$b,"destroyed",function(){return this._destroyed}),k$o(0,k$b,"emissionRate",function(){return this._emissionRate},function(k$a){if(k$a<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=k$a})}(),function(){function k$d(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}k$n(k$d,"laya.d3.core.particleShuriKen.module.FrameOverTime");var k$a=k$d.prototype;return k$x.imps(k$a,{"laya.d3.core.IClone":!0}),k$a.cloneTo=function(k$a){var k$b=k$a;k$b._type=this._type,k$b._constant=this._constant,this._overTime.cloneTo(k$b._overTime),k$b._constantMin=this._constantMin,k$b._constantMax=this._constantMax,this._overTimeMin.cloneTo(k$b._overTimeMin),this._overTimeMax.cloneTo(k$b._overTimeMax)},k$a.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$a,"frameOverTimeData",function(){return this._overTime}),k$o(0,k$a,"constant",function(){return this._constant}),k$o(0,k$a,"type",function(){return this._type}),k$o(0,k$a,"frameOverTimeDataMin",function(){return this._overTimeMin}),k$o(0,k$a,"constantMin",function(){return this._constantMin}),k$o(0,k$a,"frameOverTimeDataMax",function(){return this._overTimeMax}),k$o(0,k$a,"constantMax",function(){return this._constantMax}),k$d.createByConstant=function(k$a){var k$b=new k$d;return k$b._type=0,k$b._constant=k$a,k$b},k$d.createByOverTime=function(k$a){var k$b=new k$d;return k$b._type=1,k$b._overTime=k$a,k$b},k$d.createByRandomTwoConstant=function(k$a,k$b){var k$c=new k$d;return k$c._type=2,k$c._constantMin=k$a,k$c._constantMax=k$b,k$c},k$d.createByRandomTwoOverTime=function(k$a,k$b){var k$c=new k$d;return k$c._type=3,k$c._overTimeMin=k$a,k$c._overTimeMax=k$b,k$c},k$d}()),k$K=function(){function k$j(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}k$n(k$j,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var k$a=k$j.prototype;return k$x.imps(k$a,{"laya.d3.core.IClone":!0}),k$a.cloneTo=function(k$a){var k$b=k$a;k$b._type=this._type,k$b._separateAxes=this._separateAxes,k$b._constant=this._constant,this._constantSeparate.cloneTo(k$b._constantSeparate),this._gradient.cloneTo(k$b._gradient),this._gradientX.cloneTo(k$b._gradientX),this._gradientY.cloneTo(k$b._gradientY),this._gradientZ.cloneTo(k$b._gradientZ),k$b._constantMin=this._constantMin,k$b._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(k$b._constantMinSeparate),this._constantMaxSeparate.cloneTo(k$b._constantMaxSeparate),this._gradientMin.cloneTo(k$b._gradientMin),this._gradientMax.cloneTo(k$b._gradientMax),this._gradientXMin.cloneTo(k$b._gradientXMin),this._gradientXMax.cloneTo(k$b._gradientXMax),this._gradientYMin.cloneTo(k$b._gradientYMin),this._gradientYMax.cloneTo(k$b._gradientYMax),this._gradientZMin.cloneTo(k$b._gradientZMin),this._gradientZMax.cloneTo(k$b._gradientZMax)},k$a.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$a,"gradientZ",function(){return this._gradientZ}),k$o(0,k$a,"constant",function(){return this._constant}),k$o(0,k$a,"gradient",function(){return this._gradient}),k$o(0,k$a,"separateAxes",function(){return this._separateAxes}),k$o(0,k$a,"type",function(){return this._type}),k$o(0,k$a,"constantSeparate",function(){return this._constantSeparate}),k$o(0,k$a,"gradientX",function(){return this._gradientX}),k$o(0,k$a,"gradientY",function(){return this._gradientY}),k$o(0,k$a,"gradientW",function(){return this._gradientW}),k$o(0,k$a,"gradientMin",function(){return this._gradientMin}),k$o(0,k$a,"constantMin",function(){return this._constantMin}),k$o(0,k$a,"gradientMax",function(){return this._gradientMax}),k$o(0,k$a,"constantMax",function(){return this._constantMax}),k$o(0,k$a,"gradientWMin",function(){return this._gradientWMin}),k$o(0,k$a,"constantMinSeparate",function(){return this._constantMinSeparate}),k$o(0,k$a,"constantMaxSeparate",function(){return this._constantMaxSeparate}),k$o(0,k$a,"gradientXMin",function(){return this._gradientXMin}),k$o(0,k$a,"gradientXMax",function(){return this._gradientXMax}),k$o(0,k$a,"gradientWMax",function(){return this._gradientWMax}),k$o(0,k$a,"gradientYMin",function(){return this._gradientYMin}),k$o(0,k$a,"gradientYMax",function(){return this._gradientYMax}),k$o(0,k$a,"gradientZMin",function(){return this._gradientZMin}),k$o(0,k$a,"gradientZMax",function(){return this._gradientZMax}),k$j.createByConstant=function(k$a){var k$b=new k$j;return k$b._type=0,k$b._separateAxes=!1,k$b._constant=k$a,k$b},k$j.createByConstantSeparate=function(k$a){var k$b=new k$j;return k$b._type=0,k$b._separateAxes=!0,k$b._constantSeparate=k$a,k$b},k$j.createByGradient=function(k$a){var k$b=new k$j;return k$b._type=1,k$b._separateAxes=!1,k$b._gradient=k$a,k$b},k$j.createByGradientSeparate=function(k$a,k$b,k$c,k$d){var k$e=new k$j;return k$e._type=1,k$e._separateAxes=!0,k$e._gradientX=k$a,k$e._gradientY=k$b,k$e._gradientZ=k$c,k$e._gradientW=k$d,k$e},k$j.createByRandomTwoConstant=function(k$a,k$b){var k$c=new k$j;return k$c._type=2,k$c._separateAxes=!1,k$c._constantMin=k$a,k$c._constantMax=k$b,k$c},k$j.createByRandomTwoConstantSeparate=function(k$a,k$b){var k$c=new k$j;return k$c._type=2,k$c._separateAxes=!0,k$c._constantMinSeparate=k$a,k$c._constantMaxSeparate=k$b,k$c},k$j.createByRandomTwoGradient=function(k$a,k$b){var k$c=new k$j;return k$c._type=3,k$c._separateAxes=!1,k$c._gradientMin=k$a,k$c._gradientMax=k$b,k$c},k$j.createByRandomTwoGradientSeparate=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){var k$i=new k$j;return k$i._type=3,k$i._separateAxes=!0,k$i._gradientXMin=k$a,k$i._gradientXMax=k$b,k$i._gradientYMin=k$c,k$i._gradientYMax=k$d,k$i._gradientZMin=k$e,k$i._gradientZMax=k$f,k$i._gradientWMin=k$g,k$i._gradientWMax=k$h,k$i},k$j}(),k$L=function(){function k$d(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}k$n(k$d,"laya.d3.core.particleShuriKen.module.GradientColor");var k$a=k$d.prototype;return k$x.imps(k$a,{"laya.d3.core.IClone":!0}),k$a.cloneTo=function(k$a){var k$b=k$a;k$b._type=this._type,this._constant.cloneTo(k$b._constant),this._constantMin.cloneTo(k$b._constantMin),this._constantMax.cloneTo(k$b._constantMax),this._gradient.cloneTo(k$b._gradient),this._gradientMin.cloneTo(k$b._gradientMin),this._gradientMax.cloneTo(k$b._gradientMax)},k$a.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$a,"gradient",function(){return this._gradient}),k$o(0,k$a,"constant",function(){return this._constant}),k$o(0,k$a,"type",function(){return this._type}),k$o(0,k$a,"gradientMin",function(){return this._gradientMin}),k$o(0,k$a,"constantMin",function(){return this._constantMin}),k$o(0,k$a,"gradientMax",function(){return this._gradientMax}),k$o(0,k$a,"constantMax",function(){return this._constantMax}),k$d.createByConstant=function(k$a){var k$b=new k$d;return k$b._type=0,k$b._constant=k$a,k$b},k$d.createByGradient=function(k$a){var k$b=new k$d;return k$b._type=1,k$b._gradient=k$a,k$b},k$d.createByRandomTwoConstant=function(k$a,k$b){var k$c=new k$d;return k$c._type=2,k$c._constantMin=k$a,k$c._constantMax=k$b,k$c},k$d.createByRandomTwoGradient=function(k$a,k$b){var k$c=new k$d;return k$c._type=3,k$c._gradientMin=k$a,k$c._gradientMax=k$b,k$c},k$d}(),k$M=(function(){function k$a(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}k$n(k$a,"laya.d3.core.particleShuriKen.module.GradientDataColor");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b.addAlpha=function(k$a,k$b){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==k$a&&(k$a=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=k$a,this._alphaElements[this._alphaCurrentLength++]=k$b):DEBUG},k$b.addRGB=function(k$a,k$b){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==k$a&&(k$a=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=k$a,this._rgbElements[this._rgbCurrentLength++]=k$b.x,this._rgbElements[this._rgbCurrentLength++]=k$b.y,this._rgbElements[this._rgbCurrentLength++]=k$b.z):DEBUG},k$b.cloneTo=function(k$a){var k$b=k$a,k$c=0,k$d=0;k$b._alphaCurrentLength=this._alphaCurrentLength;var k$e=k$b._alphaElements;for(k$e.length=this._alphaElements.length,k$c=0,k$d=this._alphaElements.length;k$c<k$d;k$c++)k$e[k$c]=this._alphaElements[k$c];k$b._rgbCurrentLength=this._rgbCurrentLength;var k$f=k$b._rgbElements;for(k$f.length=this._rgbElements.length,k$c=0,k$d=this._rgbElements.length;k$c<k$d;k$c++)k$f[k$c]=this._rgbElements[k$c]},k$b.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$b,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),k$o(0,k$b,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function k$a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}k$n(k$a,"laya.d3.core.particleShuriKen.module.GradientDataInt");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b.add=function(k$a,k$b){this._currentLength<8?(6===this._currentLength&&1!==k$a&&(k$a=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=k$a,this._elements[this._currentLength++]=k$b):console.log("Warning:data count must lessEqual than 4")},k$b.cloneTo=function(k$a){var k$b=k$a;k$b._currentLength=this._currentLength;var k$c=k$b._elements;k$c.length=this._elements.length;for(var k$d=0,k$e=this._elements.length;k$d<k$e;k$d++)k$c[k$d]=this._elements[k$d]},k$b.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$b,"gradientCount",function(){return this._currentLength/2})}(),function(){function k$a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}k$n(k$a,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b.add=function(k$a,k$b){this._currentLength<8?(6===this._currentLength&&1!==k$a&&(k$a=1,DEBUG),this._elements[this._currentLength++]=k$a,this._elements[this._currentLength++]=k$b):DEBUG},k$b.getKeyByIndex=function(k$a){return this._elements[2*k$a]},k$b.getValueByIndex=function(k$a){return this._elements[2*k$a+1]},k$b.getAverageValue=function(){for(var k$a=0,k$b=this._currentLength-2;k$a<k$b;k$a+=2){this._elements[k$a+1];this._elements[k$a+3],this._elements[k$a+2]-this._elements[k$a]}return 0},k$b.cloneTo=function(k$a){var k$b=k$a;k$b._currentLength=this._currentLength;var k$c=k$b._elements;k$c.length=this._elements.length;for(var k$d=0,k$e=this._elements.length;k$d<k$e;k$d++)k$c[k$d]=this._elements[k$d]},k$b.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$b,"gradientCount",function(){return this._currentLength/2})}(),function(){function k$a(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}k$n(k$a,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b.add=function(k$a,k$b){this._currentLength<8?(6===this._currentLength&&1!==k$a&&(k$a=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=k$a,this._elements[this._currentLength++]=k$b.x,this._elements[this._currentLength++]=k$b.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},k$b.cloneTo=function(k$a){var k$b=k$a;k$b._currentLength=this._currentLength;var k$c=k$b._elements;k$c.length=this._elements.length;for(var k$d=0,k$e=this._elements.length;k$d<k$e;k$d++)k$c[k$d]=this._elements[k$d]},k$b.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$b,"gradientCount",function(){return this._currentLength/3})}(),function(){function k$h(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}k$n(k$h,"laya.d3.core.particleShuriKen.module.GradientSize");var k$a=k$h.prototype;return k$x.imps(k$a,{"laya.d3.core.IClone":!0}),k$a.getMaxSizeInGradient=function(){var k$a=0,k$b=0,k$c=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(k$a=0,k$b=this._gradientX.gradientCount;k$a<k$b;k$a++)k$c=Math.max(k$c,this._gradientX.getValueByIndex(k$a));for(k$a=0,k$b=this._gradientY.gradientCount;k$a<k$b;k$a++)k$c=Math.max(k$c,this._gradientY.getValueByIndex(k$a))}else for(k$a=0,k$b=this._gradient.gradientCount;k$a<k$b;k$a++)k$c=Math.max(k$c,this._gradient.getValueByIndex(k$a));break;case 1:k$c=this._separateAxes?(k$c=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),k$c=Math.max(k$c,this._constantMinSeparate.y),Math.max(k$c,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(k$a=0,k$b=this._gradientXMin.gradientCount;k$a<k$b;k$a++)k$c=Math.max(k$c,this._gradientXMin.getValueByIndex(k$a));for(k$a=0,k$b=this._gradientXMax.gradientCount;k$a<k$b;k$a++)k$c=Math.max(k$c,this._gradientXMax.getValueByIndex(k$a));for(k$a=0,k$b=this._gradientYMin.gradientCount;k$a<k$b;k$a++)k$c=Math.max(k$c,this._gradientYMin.getValueByIndex(k$a));for(k$a=0,k$b=this._gradientZMax.gradientCount;k$a<k$b;k$a++)k$c=Math.max(k$c,this._gradientZMax.getValueByIndex(k$a))}else{for(k$a=0,k$b=this._gradientMin.gradientCount;k$a<k$b;k$a++)k$c=Math.max(k$c,this._gradientMin.getValueByIndex(k$a));for(k$a=0,k$b=this._gradientMax.gradientCount;k$a<k$b;k$a++)k$c=Math.max(k$c,this._gradientMax.getValueByIndex(k$a))}}return k$c},k$a.cloneTo=function(k$a){var k$b=k$a;k$b._type=this._type,k$b._separateAxes=this._separateAxes,this._gradient.cloneTo(k$b._gradient),this._gradientX.cloneTo(k$b._gradientX),this._gradientY.cloneTo(k$b._gradientY),this._gradientZ.cloneTo(k$b._gradientZ),k$b._constantMin=this._constantMin,k$b._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(k$b._constantMinSeparate),this._constantMaxSeparate.cloneTo(k$b._constantMaxSeparate),this._gradientMin.cloneTo(k$b._gradientMin),this._gradientMax.cloneTo(k$b._gradientMax),this._gradientXMin.cloneTo(k$b._gradientXMin),this._gradientXMax.cloneTo(k$b._gradientXMax),this._gradientYMin.cloneTo(k$b._gradientYMin),this._gradientYMax.cloneTo(k$b._gradientYMax),this._gradientZMin.cloneTo(k$b._gradientZMin),this._gradientZMax.cloneTo(k$b._gradientZMax)},k$a.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$a,"gradientZ",function(){return this._gradientZ}),k$o(0,k$a,"gradient",function(){return this._gradient}),k$o(0,k$a,"separateAxes",function(){return this._separateAxes}),k$o(0,k$a,"type",function(){return this._type}),k$o(0,k$a,"gradientMin",function(){return this._gradientMin}),k$o(0,k$a,"constantMin",function(){return this._constantMin}),k$o(0,k$a,"gradientX",function(){return this._gradientX}),k$o(0,k$a,"gradientY",function(){return this._gradientY}),k$o(0,k$a,"gradientMax",function(){return this._gradientMax}),k$o(0,k$a,"constantMax",function(){return this._constantMax}),k$o(0,k$a,"constantMinSeparate",function(){return this._constantMinSeparate}),k$o(0,k$a,"constantMaxSeparate",function(){return this._constantMaxSeparate}),k$o(0,k$a,"gradientXMin",function(){return this._gradientXMin}),k$o(0,k$a,"gradientXMax",function(){return this._gradientXMax}),k$o(0,k$a,"gradientYMin",function(){return this._gradientYMin}),k$o(0,k$a,"gradientYMax",function(){return this._gradientYMax}),k$o(0,k$a,"gradientZMin",function(){return this._gradientZMin}),k$o(0,k$a,"gradientZMax",function(){return this._gradientZMax}),k$h.createByGradient=function(k$a){var k$b=new k$h;return k$b._type=0,k$b._separateAxes=!1,k$b._gradient=k$a,k$b},k$h.createByGradientSeparate=function(k$a,k$b,k$c){var k$d=new k$h;return k$d._type=0,k$d._separateAxes=!0,k$d._gradientX=k$a,k$d._gradientY=k$b,k$d._gradientZ=k$c,k$d},k$h.createByRandomTwoConstant=function(k$a,k$b){var k$c=new k$h;return k$c._type=1,k$c._separateAxes=!1,k$c._constantMin=k$a,k$c._constantMax=k$b,k$c},k$h.createByRandomTwoConstantSeparate=function(k$a,k$b){var k$c=new k$h;return k$c._type=1,k$c._separateAxes=!0,k$c._constantMinSeparate=k$a,k$c._constantMaxSeparate=k$b,k$c},k$h.createByRandomTwoGradient=function(k$a,k$b){var k$c=new k$h;return k$c._type=2,k$c._separateAxes=!1,k$c._gradientMin=k$a,k$c._gradientMax=k$b,k$c},k$h.createByRandomTwoGradientSeparate=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=new k$h;return k$g._type=2,k$g._separateAxes=!0,k$g._gradientXMin=k$a,k$g._gradientXMax=k$b,k$g._gradientYMin=k$c,k$g._gradientYMax=k$d,k$g._gradientZMin=k$e,k$g._gradientZMax=k$f,k$g},k$h}()),k$N=function(){function k$h(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}k$n(k$h,"laya.d3.core.particleShuriKen.module.GradientVelocity");var k$a=k$h.prototype;return k$x.imps(k$a,{"laya.d3.core.IClone":!0}),k$a.cloneTo=function(k$a){var k$b=k$a;k$b._type=this._type,this._constant.cloneTo(k$b._constant),this._gradientX.cloneTo(k$b._gradientX),this._gradientY.cloneTo(k$b._gradientY),this._gradientZ.cloneTo(k$b._gradientZ),this._constantMin.cloneTo(k$b._constantMin),this._constantMax.cloneTo(k$b._constantMax),this._gradientXMin.cloneTo(k$b._gradientXMin),this._gradientXMax.cloneTo(k$b._gradientXMax),this._gradientYMin.cloneTo(k$b._gradientYMin),this._gradientYMax.cloneTo(k$b._gradientYMax),this._gradientZMin.cloneTo(k$b._gradientZMin),this._gradientZMax.cloneTo(k$b._gradientZMax)},k$a.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$a,"gradientZ",function(){return this._gradientZ}),k$o(0,k$a,"constant",function(){return this._constant}),k$o(0,k$a,"type",function(){return this._type}),k$o(0,k$a,"gradientXMax",function(){return this._gradientXMax}),k$o(0,k$a,"constantMin",function(){return this._constantMin}),k$o(0,k$a,"gradientX",function(){return this._gradientX}),k$o(0,k$a,"gradientY",function(){return this._gradientY}),k$o(0,k$a,"gradientXMin",function(){return this._gradientXMin}),k$o(0,k$a,"constantMax",function(){return this._constantMax}),k$o(0,k$a,"gradientYMin",function(){return this._gradientYMin}),k$o(0,k$a,"gradientYMax",function(){return this._gradientYMax}),k$o(0,k$a,"gradientZMin",function(){return this._gradientZMin}),k$o(0,k$a,"gradientZMax",function(){return this._gradientZMax}),k$h.createByConstant=function(k$a){var k$b=new k$h;return k$b._type=0,k$b._constant=k$a,k$b},k$h.createByGradient=function(k$a,k$b,k$c){var k$d=new k$h;return k$d._type=1,k$d._gradientX=k$a,k$d._gradientY=k$b,k$d._gradientZ=k$c,k$d},k$h.createByRandomTwoConstant=function(k$a,k$b){var k$c=new k$h;return k$c._type=2,k$c._constantMin=k$a,k$c._constantMax=k$b,k$c},k$h.createByRandomTwoGradient=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=new k$h;return k$g._type=3,k$g._gradientXMin=k$a,k$g._gradientXMax=k$b,k$g._gradientYMin=k$c,k$g._gradientYMax=k$d,k$g._gradientZMin=k$e,k$g._gradientZMax=k$f,k$g},k$h}(),k$O=(function(){function k$a(k$a){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=k$a}k$n(k$a,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b.cloneTo=function(k$a){var k$b=k$a;this._angularVelocity.cloneTo(k$b._angularVelocity),k$b.enbale=this.enbale},k$b.clone=function(){var k$a;switch(this._angularVelocity.type){case 0:k$a=this._angularVelocity.separateAxes?k$K.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):k$K.createByConstant(this._angularVelocity.constant);break;case 1:k$a=this._angularVelocity.separateAxes?k$K.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):k$K.createByGradient(this._angularVelocity.gradient.clone());break;case 2:k$a=this._angularVelocity.separateAxes?k$K.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):k$K.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:k$a=this._angularVelocity.separateAxes?k$K.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):k$K.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var k$b=new this.constructor(k$a);return k$b.enbale=this.enbale,k$b},k$o(0,k$b,"angularVelocity",function(){return this._angularVelocity})}(),function(){function k$a(){this.enable=!1,this.randomDirection=!1}k$n(k$a,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b._getShapeBoundBox=function(k$a){throw new Error("BaseShape: must override it.")},k$b._getSpeedBoundBox=function(k$a){throw new Error("BaseShape: must override it.")},k$b.generatePositionAndDirection=function(k$a,k$b,k$c,k$d){throw new Error("BaseShape: must override it.")},k$b._calculateProceduralBounds=function(k$a,k$b,k$c){this._getShapeBoundBox(k$a);var k$d=k$a.min,k$e=k$a.max;k$gb.multiply(k$d,k$b,k$d),k$gb.multiply(k$e,k$b,k$e);var k$f=new k$Za(new k$gb,new k$gb);this.randomDirection?(k$f.min=new k$gb(-1,-1,-1),k$f.max=new k$gb(1,1,1)):this._getSpeedBoundBox(k$f);var k$g=new k$Za(new k$gb,new k$gb),k$h=k$g.min,k$i=k$g.max;k$gb.scale(k$f.min,k$c.y,k$h),k$gb.scale(k$f.max,k$c.y,k$i),k$gb.add(k$a.min,k$h,k$h),k$gb.add(k$a.max,k$i,k$i),k$gb.min(k$a.min,k$h,k$a.min),k$gb.max(k$a.max,k$h,k$a.max);var k$j=new k$Za(new k$gb,new k$gb),k$k=k$j.min,k$l=k$j.max;k$gb.scale(k$f.min,k$c.x,k$k),k$gb.scale(k$f.max,k$c.x,k$l),k$gb.min(k$j.min,k$l,k$h),k$gb.max(k$j.min,k$l,k$i),k$gb.min(k$a.min,k$h,k$a.min),k$gb.max(k$a.max,k$h,k$a.max)},k$b.cloneTo=function(k$a){k$a.enable=this.enable},k$b.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$a}()),k$T=function(){function k$f(){}return k$n(k$f,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),k$f._randomPointUnitArcCircle=function(k$a,k$b,k$c){var k$d=k$b.elements,k$e=NaN;k$e=k$c?k$c.getFloat()*k$a:Math.random()*k$a,k$d[0]=Math.cos(k$e),k$d[1]=Math.sin(k$e)},k$f._randomPointInsideUnitArcCircle=function(k$a,k$b,k$c){var k$d=k$b.elements;k$f._randomPointUnitArcCircle(k$a,k$b,k$c);var k$e=NaN;k$e=k$c?Math.pow(k$c.getFloat(),.5):Math.pow(Math.random(),.5),k$d[0]=k$d[0]*k$e,k$d[1]=k$d[1]*k$e},k$f._randomPointUnitCircle=function(k$a,k$b){var k$c=k$a.elements,k$d=NaN;k$d=k$b?k$b.getFloat()*Math.PI*2:Math.random()*Math.PI*2,k$c[0]=Math.cos(k$d),k$c[1]=Math.sin(k$d)},k$f._randomPointInsideUnitCircle=function(k$a,k$b){var k$c=k$a.elements;k$f._randomPointUnitCircle(k$a);var k$d=NaN;k$d=k$b?Math.pow(k$b.getFloat(),.5):Math.pow(Math.random(),.5),k$c[0]=k$c[0]*k$d,k$c[1]=k$c[1]*k$d},k$f._randomPointUnitSphere=function(k$a,k$b){var k$c=k$a.elements,k$d=NaN,k$e=NaN;k$e=k$b?(k$d=k$c[2]=2*k$b.getFloat()-1,k$b.getFloat()*Math.PI*2):(k$d=k$c[2]=2*Math.random()-1,Math.random()*Math.PI*2);var k$f=Math.sqrt(1-k$d*k$d);k$c[0]=k$f*Math.cos(k$e),k$c[1]=k$f*Math.sin(k$e)},k$f._randomPointInsideUnitSphere=function(k$a,k$b){var k$c=k$a.elements;k$f._randomPointUnitSphere(k$a);var k$d=NaN;k$d=k$b?Math.pow(k$b.getFloat(),1/3):Math.pow(Math.random(),1/3),k$c[0]=k$c[0]*k$d,k$c[1]=k$c[1]*k$d,k$c[2]=k$c[2]*k$d},k$f._randomPointInsideHalfUnitBox=function(k$a,k$b){var k$c=k$a.elements;k$b?(k$c[0]=k$b.getFloat()-.5,k$c[1]=k$b.getFloat()-.5,k$c[2]=k$b.getFloat()-.5):(k$c[0]=Math.random()-.5,k$c[1]=Math.random()-.5,k$c[2]=Math.random()-.5)},k$f}(),k$U=(function(){function k$a(k$a){this._size=null,this.enbale=!1,this._size=k$a}k$n(k$a,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b.cloneTo=function(k$a){var k$b=k$a;this._size.cloneTo(k$b._size),k$b.enbale=this.enbale},k$b.clone=function(){var k$a;switch(this._size.type){case 0:k$a=this._size.separateAxes?k$M.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):k$M.createByGradient(this._size.gradient.clone());break;case 1:k$a=this._size.separateAxes?k$M.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):k$M.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:k$a=this._size.separateAxes?k$M.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):k$M.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var k$b=new this.constructor(k$a);return k$b.enbale=this.enbale,k$b},k$o(0,k$b,"size",function(){return this._size})}(),function(){function k$d(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}k$n(k$d,"laya.d3.core.particleShuriKen.module.StartFrame");var k$a=k$d.prototype;return k$x.imps(k$a,{"laya.d3.core.IClone":!0}),k$a.cloneTo=function(k$a){var k$b=k$a;k$b._type=this._type,k$b._constant=this._constant,k$b._constantMin=this._constantMin,k$b._constantMax=this._constantMax},k$a.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$a,"constant",function(){return this._constant}),k$o(0,k$a,"type",function(){return this._type}),k$o(0,k$a,"constantMin",function(){return this._constantMin}),k$o(0,k$a,"constantMax",function(){return this._constantMax}),k$d.createByConstant=function(k$a){var k$b=new k$d;return k$b._type=0,k$b._constant=k$a,k$b},k$d.createByRandomTwoConstant=function(k$a,k$b){var k$c=new k$d;return k$c._type=1,k$c._constantMin=k$a,k$c._constantMax=k$b,k$c},k$d}()),k$V=(function(){function k$a(k$a,k$b){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new k$fb(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=k$a,this._startFrame=k$b}k$n(k$a,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b.cloneTo=function(k$a){var k$b=k$a;this.tiles.cloneTo(k$b.tiles),k$b.type=this.type,k$b.randomRow=this.randomRow,this._frame.cloneTo(k$b._frame),this._startFrame.cloneTo(k$b._startFrame),k$b.cycles=this.cycles,k$b.enableUVChannels=this.enableUVChannels,k$b.enable=this.enable},k$b.clone=function(){var k$a,k$b;switch(this._frame.type){case 0:k$a=k$J.createByConstant(this._frame.constant);break;case 1:k$a=k$J.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:k$a=k$J.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:k$a=k$J.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:k$b=k$U.createByConstant(this._startFrame.constant);break;case 1:k$b=k$U.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var k$c=new this.constructor(k$a,k$b);return this.tiles.cloneTo(k$c.tiles),k$c.type=this.type,k$c.randomRow=this.randomRow,k$c.cycles=this.cycles,k$c.enableUVChannels=this.enableUVChannels,k$c.enable=this.enable,k$c},k$o(0,k$b,"frame",function(){return this._frame}),k$o(0,k$b,"startFrame",function(){return this._startFrame})}(),function(){function k$a(k$a){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=k$a}k$n(k$a,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b.cloneTo=function(k$a){var k$b=k$a;this._velocity.cloneTo(k$b._velocity),k$b.enbale=this.enbale,k$b.space=this.space},k$b.clone=function(){var k$a;switch(this._velocity.type){case 0:k$a=k$N.createByConstant(this._velocity.constant.clone());break;case 1:k$a=k$N.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:k$a=k$N.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:k$a=k$N.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var k$b=new this.constructor(k$a);return k$b.enbale=this.enbale,k$b.space=this.space,k$b},k$o(0,k$b,"velocity",function(){return this._velocity})}(),function(){function k$a(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new k$mb,this._vb=k$Ob.create(k$a._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=k$Nb.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=k$Lb.nameKey.getID("LINE"),this._shaderCompile=k$Ab._preCompileShader[this._sharderNameID]}k$n(k$a,"laya.d3.core.PhasorSpriter3D");var k$b=k$a.prototype;return k$b.line=function(k$a,k$b,k$c,k$d){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(k$a.x,k$a.y,k$a.z,k$b.x,k$b.y,k$b.z,k$b.w),this.addVertex(k$c.x,k$c.y,k$c.z,k$d.x,k$d.y,k$d.z,k$d.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},k$b.circle=function(k$a,k$b,k$c,k$d,k$e,k$f){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*k$b,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/k$b,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*k$a,Math.cos(this._tempNumver0)*k$a,0,k$c,k$d,k$e,k$f),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},k$b.plane=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=k$d/2,this._tempNumver1=k$e/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(k$a-this._tempNumver0,k$b+this._tempNumver1,k$c,k$f,k$g,k$h,k$i),this.addVertex(k$a+this._tempNumver0,k$b+this._tempNumver1,k$c,k$f,k$g,k$h,k$i),this.addVertex(k$a-this._tempNumver0,k$b-this._tempNumver1,k$c,k$f,k$g,k$h,k$i),this.addVertex(k$a+this._tempNumver0,k$b-this._tempNumver1,k$c,k$f,k$g,k$h,k$i),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},k$b.box=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=k$d/2,this._tempNumver1=k$e/2,this._tempNumver2=k$f/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(k$a-this._tempNumver0,k$b+this._tempNumver1,k$c+this._tempNumver2,k$g,k$h,k$i,k$j),this.addVertex(k$a+this._tempNumver0,k$b+this._tempNumver1,k$c+this._tempNumver2,k$g,k$h,k$i,k$j),this.addVertex(k$a-this._tempNumver0,k$b-this._tempNumver1,k$c+this._tempNumver2,k$g,k$h,k$i,k$j),this.addVertex(k$a+this._tempNumver0,k$b-this._tempNumver1,k$c+this._tempNumver2,k$g,k$h,k$i,k$j),this.addVertex(k$a+this._tempNumver0,k$b+this._tempNumver1,k$c-this._tempNumver2,k$g,k$h,k$i,k$j),this.addVertex(k$a-this._tempNumver0,k$b+this._tempNumver1,k$c-this._tempNumver2,k$g,k$h,k$i,k$j),this.addVertex(k$a+this._tempNumver0,k$b-this._tempNumver1,k$c-this._tempNumver2,k$g,k$h,k$i,k$j),this.addVertex(k$a-this._tempNumver0,k$b-this._tempNumver1,k$c-this._tempNumver2,k$g,k$h,k$i,k$j),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},k$b.cone=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*k$c+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*k$c>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/k$c,this.addVertexIndex(0,k$b,0,k$d,k$e,k$f,k$g,this._tempUint0),this.addVertexIndex(0,0,0,k$d,k$e,k$f,k$g,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<k$c;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(k$a*this._tempNumver2,0,k$a*this._tempNumver3,k$d,k$e,k$f,k$g,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==k$c-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(k$a*this._tempNumver2,0,k$a*this._tempNumver3,k$d,k$e,k$f,k$g,this._tempUint0+(this._tempInt0+k$c)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==k$c-1?this.addIndexes(this._tempUint1+k$c+2):this.addIndexes(this._tempUint1+this._tempInt0+k$c+1),this.addIndexes(this._tempUint1+this._tempInt0+k$c),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},k$b.boundingBoxLine=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(k$a,k$e,k$f,k$g,k$h,k$i,k$j),this.addVertex(k$d,k$e,k$f,k$g,k$h,k$i,k$j),this.addVertex(k$a,k$b,k$f,k$g,k$h,k$i,k$j),this.addVertex(k$d,k$b,k$f,k$g,k$h,k$i,k$j),this.addVertex(k$d,k$e,k$c,k$g,k$h,k$i,k$j),this.addVertex(k$a,k$e,k$c,k$g,k$h,k$i,k$j),this.addVertex(k$d,k$b,k$c,k$g,k$h,k$i,k$j),this.addVertex(k$a,k$b,k$c,k$g,k$h,k$i,k$j),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},k$b.addVertex=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=k$a,this._vbData[this._posInVBData+1]=k$b,this._vbData[this._posInVBData+2]=k$c,this._vbData[this._posInVBData+3]=k$d,this._vbData[this._posInVBData+4]=k$e,this._vbData[this._posInVBData+5]=k$f,this._vbData[this._posInVBData+6]=k$g,this._posInVBData+=this._floatSizePerVer,this},k$b.addVertexIndex=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){return this._hasBegun||this.addVertexIndexException(),this._vbData[k$h]=k$a,this._vbData[k$h+1]=k$b,this._vbData[k$h+2]=k$c,this._vbData[k$h+3]=k$d,this._vbData[k$h+4]=k$e,this._vbData[k$h+5]=k$f,this._vbData[k$h+6]=k$g,(k$h+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=k$h),this},k$b.addIndexes=function(k$a){var k$b=arguments;this._hasBegun||this.addVertexIndexException();for(var k$c=0;k$c<k$b.length;k$c++)this._ibData[this._posInIBData]=k$b[k$c],this._posInIBData++;return this},k$b.begin=function(k$a,k$b){return this._hasBegun&&this.beginException0(),1!==k$a&&4!==k$a&&this.beginException1(),this._primitiveType=k$a,this._camera=k$b,this._hasBegun=!0,this},k$b.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},k$b.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(k$a._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),k$A.drawCall++,k$F.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},k$b.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},k$b.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},k$b.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},k$b.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},k$b.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},k$b.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(28,[new k$ga(0,"vector3",0),new k$ga(12,"vector4",1)])}]),k$a}()),k$W=function(){function k$a(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++k$a._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new k$mb}k$n(k$a,"laya.d3.core.render.RenderElement");var k$b=k$a.prototype;return k$b.getDynamicBatchBakedVertexs=function(k$a){for(var k$b=this._renderObj._getVertexBuffer(k$a),k$c=k$b.getData().slice(),k$d=k$b.vertexDeclaration,k$e=k$d.getVertexElementByUsage(0).offset/4,k$f=k$d.getVertexElementByUsage(3).offset/4,k$g=this._sprite3D.transform,k$h=k$g.worldMatrix,k$i=k$g.rotation,k$j=k$d.vertexStride/4,k$k=0,k$l=k$c.length;k$k<k$l;k$k+=k$j){var k$m=k$k+k$e,k$n=k$k+k$f;k$qb.transformVector3ArrayToVector3ArrayCoordinate(k$c,k$m,k$h,k$c,k$m),k$qb.transformVector3ArrayByQuat(k$c,k$n,k$i,k$c,k$n)}return k$c},k$b.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},k$b._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},k$o(0,k$b,"id",function(){return this._id}),k$o(0,k$b,"renderObj",function(){return this._renderObj},function(k$a){this._renderObj!==k$a&&(this._renderObj=k$a)}),k$a._uniqueIDCounter=0,k$a}(),k$X=function(){function k$b(k$a){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++k$b._uniqueIDCounter,this._needSort=!1,this._scene=k$a,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}k$n(k$b,"laya.d3.core.render.RenderQueue");var k$a=k$b.prototype;return k$a._sortOpaqueFunc=function(k$a,k$b){if(k$a._render&&k$b._render){var k$c=k$a._material.renderQueue-k$b._material.renderQueue;return 0==k$c?k$a._render._distanceForSort-k$b._render._distanceForSort:k$c}return 0},k$a._sortAlphaFunc=function(k$a,k$b){if(k$a._render&&k$b._render){var k$c=k$a._material.renderQueue-k$b._material.renderQueue;return 0==k$c?k$b._render._distanceForSort-k$a._render._distanceForSort:k$c}return 0},k$a._begainRenderElement=function(k$a,k$b,k$c){return!!k$b._beforeRender(k$a)},k$a._sortAlpha=function(k$a){k$b._cameraPosition=k$a,this._finalElements.sort(this._sortAlphaFunc)},k$a._sortOpaque=function(k$a){k$b._cameraPosition=k$a,this._finalElements.sort(this._sortOpaqueFunc)},k$a._preRender=function(k$a){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},k$a._render=function(k$a,k$b){for(var k$c,k$d,k$e,k$f,k$g,k$h,k$i=k$A.loopCount,k$j=this._scene,k$k=k$a.camera,k$l=(k$k.id,!1),k$m=0,k$n=this._finalElements.length;k$m<k$n;k$m++){var k$o,k$p,k$q,k$r=this._finalElements[k$m];if(null!=k$r._onPreRenderFunction&&k$r._onPreRenderFunction.call(k$r._sprite3D,k$a),0===k$r._type){if(k$a.owner=k$q=k$r._sprite3D,k$a.renderElement=k$r,k$q._preRenderUpdateComponents(k$a),k$o=k$r.renderObj,k$p=k$r._material,this._begainRenderElement(k$a,k$o,k$p)){if(k$c=k$o._getVertexBuffers(),!(k$e=(k$d=k$o._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[k$d.id]){this._errorRecord[k$d.id]=1;var k$s="vertexBuffer:"+("("+k$d._destroyed+","+k$d._released+","+k$d._referenceCount+","+k$d._buffer+")")+", material:"+(k$p?k$p.__className+"("+k$p._destroyed+","+k$p._released+")":"null")+", owner:"+(k$q?k$q.__className+"("+k$q._destroyed+","+k$q._activeInHierarchy+","+k$q._displayedInStage+")":"null")+", renderObj:"+(k$o?k$o.__className+"("+k$o._destroyed+","+k$o._released+","+k$o._referenceCount+")":"")+", parent:, url:"+(k$q?k$q.url:"")+", disposeStack:"+k$d.disposeStack;k$x.recordError("报错：unknown vertexDeclaration  "+k$s)}continue}if(k$l=(k$f=k$a._shader=k$p._getShader(k$j._shaderDefineValue,k$e.shaderDefineValue,k$q._shaderDefineValue)).bind()||k$i!==k$f._uploadLoopCount,k$c){if(k$f._uploadVertexBuffer!==k$c||k$l){for(var k$t=0;k$t<k$c.length;k$t++){var k$w=k$c[k$t];k$f.uploadAttributesX(k$w.vertexDeclaration.shaderValues.data,k$w)}k$f._uploadVertexBuffer=k$c}}else(k$f._uploadVertexBuffer!==k$d||k$l)&&(k$f.uploadAttributes(k$e.shaderValues.data,null),k$f._uploadVertexBuffer=k$d);(k$f._uploadScene!==k$j||k$l)&&(k$f.uploadSceneUniforms(k$j._shaderValues.data),k$f._uploadScene=k$j),(k$k!==k$f._uploadCamera||k$f._uploadSprite3D!==k$q||k$l)&&(k$f.uploadSpriteUniforms(k$q._shaderValues.data),k$f._uploadSprite3D=k$q),(k$k!==k$f._uploadCamera||k$l)&&(k$f.uploadCameraUniforms(k$k._shaderValues.data),k$f._uploadCamera=k$k),(k$f._uploadMaterial!==k$p||k$l)&&(k$p._upload(),k$f._uploadMaterial=k$p),k$g!==k$p?(k$p._setRenderStateBlendDepth(),k$p._setRenderStateFrontFace(k$b,k$q.transform),k$g=k$p,k$h=k$q):k$h!==k$q&&(k$p._setRenderStateFrontFace(k$b,k$q.transform),k$h=k$q),k$o._render(k$a),k$f._uploadLoopCount=k$i}k$q._postRenderUpdateComponents(k$a)}else if(2===k$r._type){k$r.renderObj;k$a.owner=k$q=k$r._sprite3D,k$a.renderElement=k$r,k$a._batchIndexStart=k$r._tempBatchIndexStart,k$a._batchIndexEnd=k$r._tempBatchIndexEnd,k$o=k$r.renderObj,k$p=k$r._material,this._begainRenderElement(k$a,k$o,k$p)&&(k$e=(k$d=k$o._getVertexBuffer(0)).vertexDeclaration,k$l=(k$f=k$a._shader=k$p._getShader(k$j._shaderDefineValue,k$e.shaderDefineValue,k$q._shaderDefineValue)).bind()||k$i!==k$f._uploadLoopCount,(k$f._uploadVertexBuffer!==k$d||k$l)&&(k$f.uploadAttributes(k$e.shaderValues.data,null),k$f._uploadVertexBuffer=k$d),(k$f._uploadScene!==k$j||k$l)&&(k$f.uploadSceneUniforms(k$j._shaderValues.data),k$f._uploadScene=k$j),(k$k!==k$f._uploadCamera||k$f._uploadSprite3D!==k$q||k$l)&&(k$f.uploadSpriteUniforms(k$q._shaderValues.data),k$f._uploadSprite3D=k$q),(k$k!==k$f._uploadCamera||k$l)&&(k$f.uploadCameraUniforms(k$k._shaderValues.data),k$f._uploadCamera=k$k),(k$f._uploadMaterial!==k$p||k$l)&&(k$p._upload(),k$f._uploadMaterial=k$p),k$g!==k$p?(k$p._setRenderStateBlendDepth(),k$p._setRenderStateFrontFace(k$b,k$q.transform),k$g=k$p,k$h=k$q):k$h!==k$q&&(k$p._setRenderStateFrontFace(k$b,k$q.transform),k$h=k$q),k$o._render(k$a),k$f._uploadLoopCount=k$i)}}},k$a._renderShadow=function(k$a,k$b){for(var k$c,k$d,k$e,k$f,k$g,k$h=k$A.loopCount,k$i=this._scene,k$j=k$a.camera,k$k=!1,k$l=0,k$m=this._finalElements.length;k$l<k$m;k$l++){var k$n,k$o,k$p,k$q=this._finalElements[k$l];0===k$q._type&&(k$a.owner=k$p=k$q._sprite3D,k$b||k$p._projectionViewWorldUpdateCamera===k$j&&k$p._projectionViewWorldUpdateLoopCount===k$A.loopCount||(k$p._render._renderUpdate(k$a._projectionViewMatrix),k$p._projectionViewWorldUpdateLoopCount=k$A.loopCount,k$p._projectionViewWorldUpdateCamera=k$j),k$a.renderElement=k$q,k$p._preRenderUpdateComponents(k$a),k$n=k$q.renderObj,k$o=k$q._material,this._begainRenderElement(k$a,k$n,null)&&(k$d=(k$c=k$n._getVertexBuffer(0)).vertexDeclaration,k$k=(k$e=k$a._shader=k$o._getShader(k$i._shaderDefineValue,k$d.shaderDefineValue,k$p._shaderDefineValue)).bind()||k$h!==k$e._uploadLoopCount,(k$e._uploadVertexBuffer!==k$c||k$k)&&(k$e.uploadAttributes(k$d.shaderValues.data,null),k$e._uploadVertexBuffer=k$c),(k$j!==k$e._uploadCamera||k$e._uploadSprite3D!==k$p||k$k)&&(k$e.uploadSpriteUniforms(k$p._shaderValues.data),k$e._uploadSprite3D=k$p),(k$j!==k$e._uploadCamera||k$k)&&(k$e.uploadCameraUniforms(k$j._shaderValues.data),k$e._uploadCamera=k$j),(k$e._uploadMaterial!==k$o||k$k)&&(k$o._upload(),k$e._uploadMaterial=k$o),k$e._uploadRenderElement,k$f!==k$o?(k$o._setRenderStateFrontFace(!1,k$p.transform),k$f=k$o,k$g=k$p):k$g!==k$p&&(k$o._setRenderStateFrontFace(!1,k$p.transform),k$g=k$p),k$n._render(k$a),k$e._uploadLoopCount=k$h),k$p._postRenderUpdateComponents(k$a))}},k$a._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},k$a._addRenderElement=function(k$a){this._renderElements.push(k$a),this._needSort=!0},k$a._addDynamicBatchElement=function(k$a){this._dynamicBatchCombineRenderElements.push(k$a)},k$o(0,k$a,"id",function(){return this._id}),k$b._uniqueIDCounter=0,k$b._cameraPosition=null,k$b}(),k$Y=function(){function k$a(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return k$n(k$a,"laya.d3.core.render.RenderState"),k$a.clientWidth=0,k$a.clientHeight=0,k$a}(),k$Z=function(){function k$g(k$a,k$b){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new k$_a(new k$gb,0),this._corners=[new k$gb,new k$gb,new k$gb,new k$gb,new k$gb,new k$gb,new k$gb,new k$gb],this._boundingBoxCenter=new k$gb,this._children=k$d(8),this._objects=[],this._tempBoundBoxCorners=[new k$gb,new k$gb,new k$gb,new k$gb,new k$gb,new k$gb,new k$gb,new k$gb],this._scene=k$a,this._currentDepth=k$b}k$n(k$g,"laya.d3.core.scene.OctreeNode");var k$a=k$g.prototype;return k$x.imps(k$a,{"laya.d3.core.scene.ITreeNode":!0}),k$a.init=function(k$a,k$b){var k$c=new k$gb,k$d=new k$gb;k$gb.scale(k$b,-.5,k$c),k$gb.scale(k$b,.5,k$d),k$gb.add(k$c,k$a,k$c),k$gb.add(k$d,k$a,k$d),this.exactBox=new k$Za(k$c,k$d),this.relaxBox=new k$Za(k$c,k$d)},k$a.addTreeNode=function(k$a){1===Collision.boxContainsBox(this._relaxBox,k$a.boundingBox)?this.addNodeDown(k$a,0):this.addObject(k$a)},k$a.addChild=function(k$a){var k$b=this._children[k$a];if(null==k$b){k$b=new k$g(this._scene,this._currentDepth+1),(this._children[k$a]=k$b)._parent=this,k$gb.subtract(this._exactBox.max,this._exactBox.min,k$g.tempSize),k$gb.multiply(k$g.tempSize,k$g._octreeSplit[k$a],k$g.tempCenter),k$gb.add(this._exactBox.min,k$g.tempCenter,k$g.tempCenter),k$gb.scale(k$g.tempSize,.25,k$g.tempSize);var k$c=new k$gb,k$d=new k$gb;k$gb.subtract(k$g.tempCenter,k$g.tempSize,k$c),k$gb.add(k$g.tempCenter,k$g.tempSize,k$d),k$b.exactBox=new k$Za(k$c,k$d),k$gb.scale(k$g.tempSize,k$g.relax,k$g.tempSize);var k$e=new k$gb,k$f=new k$gb;k$gb.subtract(k$g.tempCenter,k$g.tempSize,k$e),k$gb.add(k$g.tempCenter,k$g.tempSize,k$f),k$b.relaxBox=new k$Za(k$e,k$f)}return k$b},k$a.addObject=function(k$a){(k$a._treeNode=this)._objects.push(k$a)},k$a.removeObject=function(k$a){if(k$a._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var k$b=this._objects.indexOf(k$a);return-1!==k$b&&(this._objects.splice(k$b,1),!0)},k$a.clearObject=function(){this._objects.length=0},k$a.addNodeUp=function(k$a,k$b){this._parent&&1!==Collision.boxContainsBox(this._exactBox,k$a.boundingBox)?this._parent.addNodeUp(k$a,k$b-1):this.addNodeDown(k$a,k$b)},k$a.addNodeDown=function(k$a,k$b){if(k$b<this._scene.treeLevel){var k$c=this.inChildIndex(k$a.boundingBoxCenter),k$d=this.addChild(k$c);1===Collision.boxContainsBox(k$d._relaxBox,k$a.boundingBox)?k$d.addNodeDown(k$a,++k$b):this.addObject(k$a)}else this.addObject(k$a)},k$a.inChildIndex=function(k$a){return 4*(k$a.z<this._boundingBoxCenter.z?0:1)+2*(k$a.y<this._boundingBoxCenter.y?0:1)+(k$a.x<this._boundingBoxCenter.x?0:1)},k$a.updateObject=function(k$a){1===Collision.boxContainsBox(this._relaxBox,k$a.boundingBox)?(this.removeObject(k$a),k$a._treeNode=null,this.addNodeDown(k$a,this._currentDepth)):this._parent&&(this.removeObject(k$a),k$a._treeNode=null,this._parent.addNodeUp(k$a,this._currentDepth-1))},k$a.cullingObjects=function(k$a,k$b,k$c,k$d,k$e){var k$f,k$g=0,k$h=0,k$i=0,k$j=this._scene._dynamicBatchManager;for(k$g=0,k$f=this._objects.length;k$g<k$f;k$g++){var k$k=this._objects[k$g];if(k$I.isVisible(k$k._owner.layer.mask)&&k$k.enable){if(k$b&&(k$A.treeSpriteCollision+=1,0===k$a.containsBoundSphere(k$k.boundingSphere)))continue;k$k._renderUpdate(k$e),k$k._distanceForSort=k$gb.distance(k$k.boundingSphere.center,k$d)+k$k.sortingFudge;var k$l=k$k._renderElements;for(k$h=0,k$i=k$l.length;k$h<k$i;k$h++){var k$m=k$l[k$h],k$n=k$m._staticBatch;if(k$n&&k$n._material===k$m._material)k$n._addBatchRenderElement(k$m);else{var k$o=k$m.renderObj;k$o.triangleCount<10&&1===k$o._vertexBufferCount&&k$o._getIndexBuffer()&&k$m._material.renderQueue<2&&k$m._canDynamicBatch&&!k$k._owner.isStatic?k$j._addPrepareRenderElement(k$m):this._scene.getRenderQueue(k$m._material.renderQueue)._addRenderElement(k$m)}}}}for(k$g=0;k$g<8;k$g++){var k$p=this._children[k$g];if(null!=k$p){var k$q=k$b;if(k$b){var k$r=k$a.containsBoundBox(k$p._relaxBox);if(k$A.treeNodeCollision+=1,0===k$r)continue;k$q=2===k$r}k$p.cullingObjects(k$a,k$q,k$c,k$d,k$e)}}},k$a.cullingShadowObjects=function(k$a,k$b,k$c,k$d,k$e){var k$f,k$g=0,k$h=0,k$i=0;this._scene._dynamicBatchManager;for(k$g=0,k$f=this._objects.length;k$g<k$f;k$g++){var k$j=this._objects[k$g];if(k$j.castShadow&&k$I.isVisible(k$j._owner.layer.mask)&&k$j.enable){if(k$c&&0===k$a[0].containsBoundSphere(k$j.boundingSphere))continue;for(var k$k=1,k$l=k$a.length;k$k<k$l;k$k++){var k$m=k$b[k$k-1];if(0!==k$a[k$k].containsBoundSphere(k$j.boundingSphere)){var k$n=k$j._renderElements;for(k$h=0,k$i=k$n.length;k$h<k$i;k$h++)k$m._addRenderElement(k$n[k$h])}}}}for(k$g=0;k$g<8;k$g++){var k$o=this._children[k$g];if(null!=k$o){var k$p=k$c;if(k$c){var k$q=k$a[0].containsBoundBox(k$o._relaxBox);if(0===k$q)continue;k$p=2===k$q}k$o.cullingShadowObjects(k$a,k$b,k$p,k$d,k$e)}}},k$a.cullingShadowObjectsOnePSSM=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g,k$h=k$b[0],k$i=0,k$j=0,k$k=0;for(k$i=0,k$g=this._objects.length;k$i<k$g;k$i++){var k$l=this._objects[k$i];if(k$l.castShadow&&k$I.isVisible(k$l._owner.layer.mask)&&k$l.enable){if(k$d&&0===k$a.containsBoundSphere(k$l.boundingSphere))continue;k$l._renderUpdate(k$c);var k$m=k$l._renderElements;for(k$j=0,k$k=k$m.length;k$j<k$k;k$j++)k$h._addRenderElement(k$m[k$j])}}for(k$i=0;k$i<8;k$i++){var k$n=this._children[k$i];if(null!=k$n){var k$o=k$d;if(k$d){var k$p=k$a.containsBoundBox(k$n._relaxBox);if(0===k$p)continue;k$o=2===k$p}k$n.cullingShadowObjectsOnePSSM(k$a,k$b,k$c,k$o,k$e,k$f)}}},k$a.renderBoudingBox=function(k$a){this._renderBoudingBox(k$a);for(var k$b=0;k$b<8;++k$b){var k$c=this._children[k$b];k$c&&k$c.renderBoudingBox(k$a)}},k$a.buildAllChild=function(k$a){if(k$a<this._scene.treeLevel)for(var k$b=0;k$b<8;k$b++){this.addChild(k$b).buildAllChild(k$a+1)}},k$a._renderBoudingBox=function(k$a){},k$o(0,k$a,"exactBox",function(){return this._exactBox},function(k$a){this._exactBox=k$a,k$gb.add(k$a.min,k$a.max,this._boundingBoxCenter),k$gb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),k$o(0,k$a,"relaxBox",function(){return this._relaxBox},function(k$a){(this._relaxBox=k$a).getCorners(this._corners),k$_a.createfromPoints(this._corners,this._boundingSphere)}),k$g.debugMode=!1,k$g.relax=1.15,k$g.CHILDNUM=8,k$l(k$g,["tempVector0",function(){return this.tempVector0=new k$gb},"tempSize",function(){return this.tempSize=new k$gb},"tempCenter",function(){return this.tempCenter=new k$gb},"_octreeSplit",function(){return this._octreeSplit=[new k$gb(.25,.25,.25),new k$gb(.75,.25,.25),new k$gb(.25,.75,.25),new k$gb(.75,.75,.25),new k$gb(.25,.25,.75),new k$gb(.75,.25,.75),new k$gb(.25,.75,.75),new k$gb(.75,.75,.75)]}]),k$g}(),k$$=(function(){function k$a(){}k$n(k$a,"laya.d3.core.scene.SceneManager")}(),function(){function k$a(k$a,k$b,k$c,k$d){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===k$a&&(k$a=1),void 0===k$b&&(k$b=1),void 0===k$c&&(k$c=1),void 0===k$d&&(k$d=1),this._r=k$a,this._g=k$b,this._b=k$c,this._a=k$d}return k$n(k$a,"laya.d3.core.trail.module.Color",null,"Color$1"),k$a.prototype.cloneTo=function(k$a){k$a._r=this._r,k$a._g=this._g,k$a._b=this._b,k$a._a=this._a},k$l(k$a,["RED",function(){return this.RED=new k$a(1,0,0,1)},"GREEN",function(){return this.GREEN=new k$a(0,1,0,1)},"BLUE",function(){return this.BLUE=new k$a(0,0,1,1)},"CYAN",function(){return this.CYAN=new k$a(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new k$a(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new k$a(1,0,1,1)},"GRAY",function(){return this.GRAY=new k$a(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new k$a(1,1,1,1)},"BLACK",function(){return this.BLACK=new k$a(0,0,0,1)}]),k$a}()),k$_=(function(){function k$a(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}k$n(k$a,"laya.d3.core.trail.module.Gradient");var k$b=k$a.prototype;k$b.setKeys=function(k$a,k$b){var k$c,k$d;this._colorKeys=k$a;for(var k$e=this.index=0;k$e<k$a.length;k$e++){var k$f=(k$c=k$a[k$e]).color;this._colorKeyData[this.index++]=k$f._r,this._colorKeyData[this.index++]=k$f._g,this._colorKeyData[this.index++]=k$f._b,this._colorKeyData[this.index++]=k$c.time}this._alphaKeys=k$b;for(var k$g=this.index=0;k$g<k$b.length;k$g++)k$d=k$b[k$g],this._alphaKeyData[this.index++]=k$d.alpha,this._alphaKeyData[this.index++]=k$d.time},k$b.cloneTo=function(k$a){var k$b=0,k$c=0,k$d=this.colorKeys,k$e=[];for(k$b=0,k$c=k$d.length;k$b<k$c;k$b++){var k$f=new k$u;k$d[k$b].cloneTo(k$f),k$e.push(k$f)}var k$g=this.alphaKeys,k$h=[];for(k$b=0,k$c=k$g.length;k$b<k$c;k$b++){var k$i=new k$_;k$g[k$b].cloneTo(k$i),k$h.push(k$i)}k$a.setKeys(k$e,k$h)},k$o(0,k$b,"mode",function(){return this._mode},function(k$a){this._mode=k$a}),k$o(0,k$b,"colorKeys",function(){return this._colorKeys},function(k$a){this._colorKeys=k$a;for(var k$b=this.index=0;k$b<k$a.length;k$b++){var k$c=k$a[k$b],k$d=k$c.color;this._colorKeyData[this.index++]=k$d._r,this._colorKeyData[this.index++]=k$d._g,this._colorKeyData[this.index++]=k$d._b,this._colorKeyData[this.index++]=k$c.time}}),k$o(0,k$b,"alphaKeys",function(){return this._alphaKeys},function(k$a){this._alphaKeys=k$a;for(var k$b=this.index=0;k$b<k$a.length;k$b++){var k$c=k$a[k$b];this._alphaKeyData[this.index++]=k$c.alpha,this._alphaKeyData[this.index++]=k$c.time}})}(),function(){function k$a(k$a,k$b){this._alpha=NaN,this._time=NaN,void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),this._alpha=k$a,this._time=k$b}k$n(k$a,"laya.d3.core.trail.module.GradientAlphaKey");var k$b=k$a.prototype;return k$b.cloneTo=function(k$a){k$a.alpha=this.alpha,k$a.time=this.time},k$o(0,k$b,"alpha",function(){return this._alpha},function(k$a){this._alpha=k$a}),k$o(0,k$b,"time",function(){return this._time},function(k$a){this._time=k$a}),k$a}()),k$u=function(){function k$a(k$a,k$b){this._color=null,this._time=NaN,void 0===k$b&&(k$b=0),this._color=k$a||new k$$,this._time=k$b}k$n(k$a,"laya.d3.core.trail.module.GradientColorKey");var k$b=k$a.prototype;return k$b.cloneTo=function(k$a){this.color.cloneTo(k$a.color),k$a.time=this.time},k$o(0,k$b,"color",function(){return this._color},function(k$a){this._color=k$a}),k$o(0,k$b,"time",function(){return this._time},function(k$a){this._time=k$a}),k$a}(),k$v=(function(){function k$a(){}k$n(k$a,"laya.d3.core.trail.module.GradientMode"),k$a.Blend=0,k$a.Fixed=1}(),function(){function k$a(){}k$n(k$a,"laya.d3.core.trail.module.TextureMode"),k$a.Stretch=0,k$a.Tile=1}(),function(){function k$a(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}k$n(k$a,"laya.d3.core.trail.module.TrailKeyFrame"),k$a.prototype.cloneTo=function(k$a){k$a.time=this.time,k$a.inTangent=this.inTangent,k$a.outTangent=this.outTangent,k$a.value=this.value}}(),function(){function k$b(k$a){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new k$gb,this._curPosition=new k$gb,this._delVector3=new k$gb,this._lastFixedVertexPosition=new k$gb,this._pointAtoBVector3=new k$gb,this._pointA=new k$gb,this._pointB=new k$gb,this._owner=k$a,this._id=k$b.renderElementCount++,0==this._id?k$a._owner.transform.position.cloneTo(this._lastPosition):k$a._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new k$Ob(k$v.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new k$Ob(k$v.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}k$n(k$b,"laya.d3.core.trail.TrailRenderElement");var k$a=k$b.prototype;k$x.imps(k$a,{"laya.d3.core.render.IRenderable":!0}),k$a._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},k$a._addTrailByFirstPosition=function(k$a,k$b){k$gb.subtract(k$b,k$a,this._delVector3),k$gb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),k$gb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),k$gb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(k$a),k$a.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},k$a._addTrailByNextPosition=function(k$a){k$gb.subtract(k$a,this._lastFixedVertexPosition,this._delVector3),k$gb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),k$gb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),k$gb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=k$gb.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=k$ua.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(k$a),k$a.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(k$a),this._virtualVerticesCount=2)},k$a._updateVerticesByPosition=function(k$a){this._pointe=k$a.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},k$a._updateVertexBuffer2=function(){var k$a,k$b=0,k$c=0,k$d=0;for(k$d=0,k$a=(this._verticesCount+this._virtualVerticesCount)/2;k$d<k$a;k$d++)k$c=0==this._owner.textureMode?(this._VerticesToTailLength[k$d]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[k$d],this._vertices2[k$b++]=1-k$c,this._vertices2[k$b++]=1-k$c;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},k$a._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},k$a._updateDisappear=function(){var k$a,k$b=0;for(k$b=this._curDisappearIndex,k$a=(this._verticesCount+this._virtualVerticesCount)/2;k$b<k$a;k$b++)this._owner._curtime-this._everyGroupVertexBirthTime[k$b]>=this._owner.time+k$ua.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},k$a._beforeRender=function(k$a){return this._camera=k$a.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),k$gb.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},k$a._render=function(k$a){this._isDead||(k$F.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),k$A.drawCall++,k$A.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},k$a._getVertexBuffer=function(k$a){return void 0===k$a&&(k$a=0),0===k$a?this._vertexBuffer1:1===k$a?this._vertexBuffer2:null},k$a._getVertexBuffers=function(){return this._vertexBuffers},k$a._getIndexBuffer=function(){return null},k$a.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},k$a._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},k$o(0,k$a,"_vertexBufferCount",function(){return this._vertexBuffers.length}),k$o(0,k$a,"triangleCount",function(){return 0}),k$b.renderElementCount=0}(),function(){function k$a(){}k$n(k$a,"laya.d3.core.trail.VertexTrail");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration1}),k$o(1,k$a,"vertexDeclaration1",function(){return k$a._vertexDeclaration1}),k$o(1,k$a,"vertexDeclaration2",function(){return k$a._vertexDeclaration2}),k$l(k$a,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new k$fa(32,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",41),new k$ga(24,"single",33),new k$ga(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new k$fa(4,[new k$ga(0,"single",38)])}]),k$a}()),k$aa=function(){function k$w(k$a){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=k$a}k$n(k$w,"laya.d3.graphics.DynamicBatch");var k$a=k$w.prototype;return k$x.imps(k$a,{"laya.d3.core.render.IRenderable":!0}),k$a._getVertexBuffer=function(k$a){return void 0===k$a&&(k$a=0),0===k$a?this._vertexBuffer:null},k$a._getIndexBuffer=function(){return this._indexBuffer},k$a._getCombineRenderElementFromPool=function(k$a,k$b,k$c){var k$d=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return k$d||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=k$d=new k$W,k$d._sprite3D=new k$Xb),k$d._sprite3D._render._renderUpdate(k$c),k$d},k$a._getRenderElement=function(k$a,k$b,k$c){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*k$w.maxVertexCount),this._indexDatas=new Uint16Array(k$w.maxIndexCount),this._vertexBuffer=k$Ob.create(this._vertexDeclaration,k$w.maxVertexCount,35048),this._indexBuffer=k$Nb.create("ushort",k$w.maxIndexCount,35048));for(var k$d=this._merageElements.length=0,k$e=0,k$f=0,k$g=this._combineRenderElements.length;k$f<k$g;k$f++){var k$h=this._combineRenderElements[k$f],k$i=k$h.getDynamicBatchBakedVertexs(0),k$j=k$h.getBakedIndices(),k$k=k$h._sprite3D.transform._isFrontFaceInvert,k$l=k$d/(this._vertexDeclaration.vertexStride/4),k$m=k$e,k$n=k$m+k$j.length;k$h._tempBatchIndexStart=k$m,k$h._tempBatchIndexEnd=k$n,this._indexDatas.set(k$j,k$e);var k$o=0;if(k$k)for(k$o=k$m;k$o<k$n;k$o+=3){this._indexDatas[k$o]=k$l+this._indexDatas[k$o];var k$p=this._indexDatas[k$o+1],k$q=this._indexDatas[k$o+2];this._indexDatas[k$o+1]=k$l+k$q,this._indexDatas[k$o+2]=k$l+k$p}else for(k$o=k$m;k$o<k$n;k$o+=3)this._indexDatas[k$o]=k$l+this._indexDatas[k$o],this._indexDatas[k$o+1]=k$l+this._indexDatas[k$o+1],this._indexDatas[k$o+2]=k$l+this._indexDatas[k$o+2];k$e+=k$j.length,this._vertexDatas.set(k$i,k$d),k$d+=k$i.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),k$f=this._combineRenderElementPoolIndex=0,k$g=this._materials.length;k$f<k$g;k$f++){var k$r=this._getCombineRenderElementFromPool(k$a,k$b,k$c);k$r._type=2,k$r._staticBatch=null;var k$s=(k$r.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[k$f]]._tempBatchIndexStart,k$t=k$f+1===this._materialToRenderElementsOffsets.length?k$e:this._combineRenderElements[this._materialToRenderElementsOffsets[k$f+1]]._tempBatchIndexStart;k$r._tempBatchIndexStart=k$s,k$r._tempBatchIndexEnd=k$t,k$r._material=this._materials[k$f],this._merageElements.push(k$r)}},k$a._addCombineRenderObjTest=function(k$a){var k$b=k$a.renderObj,k$c=this._currentCombineIndexCount+k$b._getIndexBuffer().indexCount,k$d=this._currentCombineVertexCount+k$b._getVertexBuffer().vertexCount;return!(k$w.maxVertexCount<k$d||k$w.maxIndexCount<k$c)},k$a._addCombineRenderObj=function(k$a){var k$b=k$a.renderObj;this._combineRenderElements.push(k$a),this._currentCombineIndexCount=this._currentCombineIndexCount+k$b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+k$b._getVertexBuffer().vertexCount},k$a._addCombineMaterial=function(k$a){this._materials.push(k$a)},k$a._addMaterialToRenderElementOffset=function(k$a){this._materialToRenderElementsOffsets.push(k$a)},k$a._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},k$a._addToRenderQueue=function(k$a,k$b,k$c,k$d){this._getRenderElement(k$b,k$c,k$d);for(var k$e=0,k$f=this._materials.length;k$e<k$f;k$e++)k$a.getRenderQueue(this._materials[k$e].renderQueue)._addDynamicBatchElement(this._merageElements[k$e])},k$a._beforeRender=function(k$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},k$a._render=function(k$a){var k$b=k$a._batchIndexEnd-k$a._batchIndexStart;k$F.mainContext.drawElements(4,k$b,5123,2*k$a._batchIndexStart),k$A.drawCall++,k$A.trianglesFaces+=k$b/3},k$a._getVertexBuffers=function(){return null},k$o(0,k$a,"_vertexBufferCount",function(){return 1}),k$o(0,k$a,"triangleCount",function(){return this._indexBuffer.indexCount/3}),k$o(0,k$a,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),k$w.maxVertexCount=2e4,k$w.maxIndexCount=4e4,k$w.maxCombineTriangleCount=10,k$w}(),k$ba=function(){function k$w(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}k$n(k$w,"laya.d3.graphics.DynamicBatchManager");var k$a=k$w.prototype;return k$a.getDynamicBatch=function(k$a,k$b){var k$c,k$d=k$a.id.toString()+k$b;return this._dynamicBatches[k$d]?k$c=this._dynamicBatches[k$d]:this._dynamicBatches[k$d]=k$c=new k$aa(k$a),k$c},k$a._garbageCollection=function(){for(var k$a in this._dynamicBatches)0===this._dynamicBatches[k$a].combineRenderElementsCount&&delete this._dynamicBatches[k$a]},k$a._addPrepareRenderElement=function(k$a){this._prepareDynamicBatchCombineElements.push(k$a)},k$a._finishCombineDynamicBatch=function(k$a){var k$b,k$c,k$d;this._prepareDynamicBatchCombineElements.sort(k$w._sortPrepareDynamicBatch);for(var k$e,k$f,k$g,k$h,k$i,k$j=-1,k$k=!0,k$l=0,k$m=-1,k$n=0,k$o=this._prepareDynamicBatchCombineElements.length;k$n<k$o;k$n++){var k$p=(k$f=this._prepareDynamicBatchCombineElements[k$n]).renderObj._getVertexBuffer(0).vertexDeclaration,k$q=k$c!==k$p;k$q&&(k$l=0,k$c=k$p);var k$r=k$l!==k$j;if(k$r&&(k$j=k$l),(k$q||k$r)&&(k$g=this.getDynamicBatch(k$p,k$l),k$b=null),k$k)if(k$g._addCombineRenderObjTest(k$f)){if(k$b!==(k$e=k$f._material))k$h&&(k$a.getRenderQueue(k$i._material.renderQueue)._addRenderElement(k$i),k$i=k$h=null,k$m=-1),k$h=k$e,k$m=k$g.combineRenderElementsCount,k$i=k$f,k$b=k$e;else if(k$h){var k$s=k$i.renderObj,k$t=k$f.renderObj;k$s._getVertexBuffer().vertexCount+k$t._getVertexBuffer().vertexCount>k$aa.maxVertexCount||k$s._getIndexBuffer().indexCount+k$t._getIndexBuffer().indexCount>k$aa.maxIndexCount?(k$a.getRenderQueue(k$i._material.renderQueue)._addRenderElement(k$i),k$h=k$e,k$m=k$g.combineRenderElementsCount,k$i=k$f):(k$g._addCombineMaterial(k$h),k$g._addMaterialToRenderElementOffset(k$m),k$g._addCombineRenderObj(k$i),k$i=k$h=null,k$m=-1,k$g._addCombineRenderObj(k$f))}else k$g._addCombineRenderObj(k$f);k$k=!0}else k$h&&(k$a.getRenderQueue(k$i._material.renderQueue)._addRenderElement(k$i),k$i=k$h=null,k$m=-1),k$l++,k$k=!1;else k$d=this._prepareDynamicBatchCombineElements[k$n-1],k$g._addMaterialToRenderElementOffset(k$g.combineRenderElementsCount),k$b=k$d._material,k$g._addCombineMaterial(k$b),k$g._addCombineRenderObj(k$d),k$k=!0,k$b!==(k$e=k$f._material)?(k$h=k$e,k$m=k$g.combineRenderElementsCount,k$i=k$f):k$g._addCombineRenderObj(k$f),k$b=k$e}k$h&&(k$a.getRenderQueue(k$i._material.renderQueue)._addRenderElement(k$i),k$i=k$h=null,k$m=-1),this._prepareDynamicBatchCombineElements.length=0},k$a._clearRenderElements=function(){for(var k$a in this._dynamicBatches)this._dynamicBatches[k$a]._clearRenderElements()},k$a._addToRenderQueue=function(k$a,k$b,k$c,k$d){for(var k$e in this._dynamicBatches){var k$f=this._dynamicBatches[k$e];0<k$f.combineRenderElementsCount&&k$f._addToRenderQueue(k$a,k$b,k$c,k$d)}},k$a.dispose=function(){this._dynamicBatches=null},k$w._sortPrepareDynamicBatch=function(k$a,k$b){return k$a._mainSortID-k$b._mainSortID},k$w}(),k$ca=function(){function k$a(){}return k$n(k$a,"laya.d3.graphics.FrustumCulling"),k$a.renderShadowObjectCulling=function(k$a,k$b,k$c,k$d,k$e){var k$f=0,k$g=0,k$h=0,k$i=0;for(k$f=0,k$h=k$c.length;k$f<k$h;k$f++){var k$j=k$c[k$f];k$j&&k$j._clearRenderElements()}var k$k,k$l,k$m,k$n=k$a._cullingRenders;if(1<k$e){for(k$f=0,k$h=k$a._cullingRendersLength;k$f<k$h;k$f++)if((k$k=k$n[k$f]).castShadow&&k$I.isVisible(k$k._owner.layer.mask)&&k$k.enable)for(var k$o=1,k$p=k$b.length;k$o<k$p;k$o++)if(k$l=k$c[k$o-1],0!==k$b[k$o].containsBoundSphere(k$k.boundingSphere))for(k$g=0,k$i=(k$m=k$k._renderElements).length;k$g<k$i;k$g++)k$l._addRenderElement(k$m[k$g])}else for(k$f=0,k$h=k$a._cullingRendersLength;k$f<k$h;k$f++)if((k$k=k$n[k$f]).castShadow&&k$I.isVisible(k$k._owner.layer.mask)&&k$k.enable&&0!==k$b[0].containsBoundSphere(k$k.boundingSphere))for(k$k._renderUpdate(k$d),k$l=k$c[0],k$g=0,k$i=(k$m=k$k._renderElements).length;k$g<k$i;k$g++)k$l._addRenderElement(k$m[k$g])},k$a.renderShadowObjectCullingOctree=function(k$a,k$b,k$c,k$d,k$e){for(var k$f=0,k$g=k$c.length;k$f<k$g;k$f++){var k$h=k$c[k$f];k$h&&k$h._clearRenderElements()}1<k$e?k$a.treeRoot.cullingShadowObjects(k$b,k$c,!0,0,k$a):k$a.treeRoot.cullingShadowObjectsOnePSSM(k$b[0],k$c,k$d,!0,0,k$a)},k$a.renderObjectCulling=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=0,k$h=0,k$i=0,k$j=0,k$k=k$b._quenes,k$l=k$b._dynamicBatchManager,k$m=k$b._cullingRenders;for(k$g=0,k$h=k$k.length;k$g<k$h;k$g++){var k$n=k$k[k$g];k$n&&k$n._clearRenderElements()}var k$o=k$da._staticBatchManagers;for(k$g=0,k$h=k$o.length;k$g<k$h;k$g++)k$o[k$g]._clearRenderElements();k$l._clearRenderElements();var k$p=k$c.transform.position;for(k$g=0,k$h=k$b._cullingRendersLength;k$g<k$h;k$g++){var k$q=k$m[k$g];if(k$I.isVisible(k$q._owner.layer.mask)&&k$q.enable&&0!==k$a.containsBoundSphere(k$q.boundingSphere)&&k$q._renderUpdate(k$f)){k$q._distanceForSort=k$gb.distance(k$q.boundingSphere.center,k$p)+k$q.sortingFudge;var k$r=k$q._renderElements;for(k$i=0,k$j=k$r.length;k$i<k$j;k$i++){var k$s=k$r[k$i],k$t=k$s._staticBatch;if(k$t&&k$t._material===k$s._material)k$t._addBatchRenderElement(k$s);else{var k$w=k$s.renderObj;k$w.triangleCount<10&&1===k$w._vertexBufferCount&&k$w._getIndexBuffer()&&k$s._material.renderQueue<2&&k$s._canDynamicBatch&&!k$q._owner.isStatic?k$l._addPrepareRenderElement(k$s):k$b.getRenderQueue(k$s._material.renderQueue)._addRenderElement(k$s)}}}}for(k$g=0,k$h=k$o.length;k$g<k$h;k$g++)k$o[k$g]._addToRenderQueue(k$b,k$d,k$e,k$f);k$l._finishCombineDynamicBatch(k$b),k$l._addToRenderQueue(k$b,k$d,k$e,k$f)},k$a.renderObjectCullingOctree=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=0,k$h=0,k$i=k$b._quenes,k$j=k$b._dynamicBatchManager;for(k$g=0,k$h=k$i.length;k$g<k$h;k$g++){var k$k=k$i[k$g];k$k&&k$k._clearRenderElements()}var k$l=k$da._staticBatchManagers;for(k$g=0,k$h=k$l.length;k$g<k$h;k$g++)k$l[k$g]._clearRenderElements();for(k$j._clearRenderElements(),k$b._cullingRenders.length=0,k$b.treeRoot.cullingObjects(k$a,!0,0,k$c.transform.position,k$f),k$g=0,k$h=k$l.length;k$g<k$h;k$g++)k$l[k$g]._addToRenderQueue(k$b,k$d,k$e,k$f);k$j._finishCombineDynamicBatch(k$b),k$j._addToRenderQueue(k$b,k$d,k$e,k$f)},k$a.renderObjectCullingNoBoundFrustum=function(k$a,k$b,k$c,k$d,k$e){var k$f=0,k$g=0,k$h=0,k$i=0,k$j=k$a._quenes,k$k=k$a._dynamicBatchManager,k$l=k$a._cullingRenders;for(k$f=0,k$g=k$j.length;k$f<k$g;k$f++){var k$m=k$j[k$f];k$m&&k$m._clearRenderElements()}var k$n=k$da._staticBatchManagers;for(k$f=0,k$g=k$n.length;k$f<k$g;k$f++)k$n[k$f]._clearRenderElements();k$k._clearRenderElements();var k$o=k$b.transform.position;for(k$f=0,k$g=k$a._cullingRendersLength;k$f<k$g;k$f++){var k$p=k$l[k$f];if(k$I.isVisible(k$p._owner.layer.mask)&&k$p.enable){k$p._renderUpdate(k$e),k$p._distanceForSort=k$gb.distance(k$p.boundingSphere.center,k$o)+k$p.sortingFudge;var k$q=k$p._renderElements;for(k$h=0,k$i=k$q.length;k$h<k$i;k$h++){var k$r=k$q[k$h],k$s=k$r._staticBatch;if(k$s&&k$s._material===k$r._material)k$s._addBatchRenderElement(k$r);else{var k$t=k$r.renderObj;k$t.triangleCount<10&&1===k$t._vertexBufferCount&&k$t._getIndexBuffer()&&k$r._material.renderQueue<2&&k$r._canDynamicBatch&&!k$p._owner.isStatic?k$k._addPrepareRenderElement(k$r):k$a.getRenderQueue(k$r._material.renderQueue)._addRenderElement(k$r)}}}}for(k$f=0,k$g=k$n.length;k$f<k$g;k$f++)k$n[k$f]._addToRenderQueue(k$a,k$c,k$d,k$e);k$k._finishCombineDynamicBatch(k$a),k$k._addToRenderQueue(k$a,k$c,k$d,k$e)},k$a}(),k$da=function(){function k$f(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}k$n(k$f,"laya.d3.graphics.StaticBatchManager");var k$a=k$f.prototype;return k$a._finishInit=function(){for(var k$a in this._staticBatches)this._staticBatches[k$a]._finishInit();this._initBatchRenderElements.length=0},k$a._initStaticBatchs=function(k$a){throw new Error("StaticBatchManager:must override this function.")},k$a._addInitBatchSprite=function(k$a){for(var k$b=k$a._render._renderElements,k$c=0,k$d=k$b.length;k$c<k$d;k$c++)this._initBatchRenderElements.push(k$b[k$c])},k$a._clearRenderElements=function(){for(var k$a in this._staticBatches)this._staticBatches[k$a]._clearRenderElements()},k$a._garbageCollection=function(k$a){var k$b=k$a._staticBatch,k$c=k$b._initBatchRenderElements,k$d=k$c.indexOf(k$a);k$c.splice(k$d,1),0===k$c.length&&(k$b.dispose(),delete this._staticBatches[k$b._key])},k$a._addToRenderQueue=function(k$a,k$b,k$c,k$d){for(var k$e in this._staticBatches){var k$f=this._staticBatches[k$e];0<k$f._batchRenderElements.length&&k$f._updateToRenderQueue(k$a,k$d)}},k$a.dispose=function(){this._staticBatches=null},k$f._addToStaticBatchQueue=function(k$a){k$a instanceof laya.d3.core.RenderableSprite3D&&k$a._addToInitStaticBatchManager();for(var k$b=0,k$c=k$a.numChildren;k$b<k$c;k$b++)k$f._addToStaticBatchQueue(k$a._childs[k$b])},k$f.combine=function(k$a,k$b){var k$c,k$d=0,k$e=0;if(k$b)for(k$d=0,k$e=k$b.length;k$d<k$e;k$d++){k$b[k$d]._addToInitStaticBatchManager()}else k$a&&k$f._addToStaticBatchQueue(k$a);for(k$d=0,k$e=k$f._staticBatchManagers.length;k$d<k$e;k$d++)(k$c=k$f._staticBatchManagers[k$d])._initStaticBatchs(k$a),k$c._finishInit()},k$f._staticBatchManagers=[],k$f}(),k$ea=function(){function k$a(k$a,k$b,k$c){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=k$a,this._manager=k$b,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=k$c}k$n(k$a,"laya.d3.graphics.StaticBatch");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),k$b._binarySearch=function(k$a){for(var k$b=0,k$c=this._batchRenderElements.length-1,k$d=0;k$b<=k$c;)k$d=Math.floor((k$b+k$c)/2),this._compareBatchRenderElement(this._batchRenderElements[k$d],k$a)?k$c=k$d-1:k$b=k$d+1;return k$b},k$b._compareBatchRenderElement=function(k$a,k$b){throw new Error("StaticBatch:must override this function.")},k$b._getVertexDecLightMap=function(k$a){return k$a===k$Na.vertexDeclaration?k$Ia.vertexDeclaration:k$a===k$Ma.vertexDeclaration?k$Ha.vertexDeclaration:k$a===k$Ba.vertexDeclaration?k$wa.vertexDeclaration:k$a===k$Ra.vertexDeclaration?null:k$a===k$pa.vertexDeclaration?k$qa.vertexDeclaration:k$a===k$Pa.vertexDeclaration?k$Ka.vertexDeclaration:k$a===k$Fa.vertexDeclaration?k$Ga.vertexDeclaration:k$a===k$Oa.vertexDeclaration?k$Ja.vertexDeclaration:k$a===k$Ma.vertexDeclaration?k$Ha.vertexDeclaration:k$a===k$Ca.vertexDeclaration?k$xa.vertexDeclaration:k$a===k$Ra.vertexDeclaration?null:k$a===k$pa.vertexDeclaration?k$qa.vertexDeclaration:k$a===k$Qa.vertexDeclaration?k$La.vertexDeclaration:k$a===k$Fa.vertexDeclaration?k$Ga.vertexDeclaration:k$a},k$b._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},k$b._addBatchRenderElement=function(k$a){this._batchRenderElements.splice(this._binarySearch(k$a),0,k$a)},k$b._updateToRenderQueue=function(k$a,k$b){this._combineRenderElementPoolIndex=0,this._getRenderElement(k$a.getRenderQueue(this._material.renderQueue)._renderElements,k$a,k$b)},k$b._getRenderElement=function(k$a,k$b,k$c){throw new Error("StaticBatch:must override this function.")},k$b._finishInit=function(){throw new Error("StaticBatch:must override this function.")},k$b._clearRenderElements=function(){this._batchRenderElements.length=0},k$b.dispose=function(){},k$b._getVertexBuffer=function(k$a){return void 0===k$a&&(k$a=0),null},k$b._getIndexBuffer=function(){return null},k$b._beforeRender=function(k$a){return!0},k$b._render=function(k$a){},k$b._getVertexBuffers=function(){return null},k$o(0,k$b,"_vertexBufferCount",function(){return 1}),k$o(0,k$b,"triangleCount",function(){return 0}),k$a.combine=function(k$a){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),k$da.combine(k$a)},k$a.maxBatchVertexCount=65535,k$a}(),k$fa=function(){function k$g(k$a,k$b){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++k$g._uniqueIDCounter,this._id>k$g.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",k$g.maxVertexDeclaration);this._shaderValues=new k$mb,this._vertexElementsDic={},this._vertexStride=k$a,this._vertexElements=k$b;for(var k$c=0;k$c<k$b.length;k$c++){var k$d=k$b[k$c],k$e=k$d.elementUsage;this._vertexElementsDic[k$e]=k$d;var k$f=[k$g._getTypeSize(k$d.elementFormat)/4,5126,!1,this._vertexStride,k$d.offset];switch(this._shaderValues.setValue(k$e,k$f),k$e){case 1:this._addShaderDefine(k$Ab.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(k$Ab.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(k$Ab.SHADERDEFINE_UV1)}}}k$n(k$g,"laya.d3.graphics.VertexDeclaration");var k$a=k$g.prototype;return k$a._addShaderDefine=function(k$a){this._shaderDefineValue|=k$a},k$a._removeShaderDefine=function(k$a){this._shaderDefineValue&=~k$a},k$a.getVertexElements=function(){return this._vertexElements.slice()},k$a.getVertexElementByUsage=function(k$a){return this._vertexElementsDic[k$a]},k$a.unBinding=function(){},k$o(0,k$a,"shaderDefineValue",function(){return this._shaderDefineValue}),k$o(0,k$a,"id",function(){return this._id}),k$o(0,k$a,"vertexStride",function(){return this._vertexStride}),k$o(0,k$a,"shaderValues",function(){return this._shaderValues}),k$g._getTypeSize=function(k$a){switch(k$a){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},k$g.getVertexStride=function(k$a){for(var k$b=0,k$c=0;k$c<k$a.Length;k$c++){var k$d=k$a[k$c],k$e=k$d.offset+k$g._getTypeSize(k$d.elementFormat);k$b<k$e&&(k$b=k$e)}return k$b},k$g._maxVertexDeclarationBit=1e3,k$g._uniqueIDCounter=1,k$l(k$g,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),k$g}(),k$ga=function(){function k$a(k$a,k$b,k$c){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=k$a,this.elementFormat=k$b,this.elementUsage=k$c}return k$n(k$a,"laya.d3.graphics.VertexElement"),k$a}(),k$ha=(function(){function k$a(){}k$n(k$a,"laya.d3.graphics.VertexElementFormat"),k$a.Single="single",k$a.Vector2="vector2",k$a.Vector3="vector3",k$a.Vector4="vector4",k$a.Color="color",k$a.Byte4="byte4",k$a.Short2="short2",k$a.Short4="short4",k$a.NormalizedShort2="normalizedshort2",k$a.NormalizedShort4="normalizedshort4",k$a.HalfVector2="halfvector2",k$a.HalfVector4="halfvector4"}(),function(){function k$a(){}k$n(k$a,"laya.d3.graphics.VertexElementUsage"),k$a.POSITION0=0,k$a.COLOR0=1,k$a.TEXTURECOORDINATE0=2,k$a.NORMAL0=3,k$a.BINORMAL0=4,k$a.TANGENT0=5,k$a.BLENDINDICES0=6,k$a.BLENDWEIGHT0=7,k$a.DEPTH0=8,k$a.FOG0=9,k$a.POINTSIZE0=10,k$a.SAMPLE0=11,k$a.TESSELLATEFACTOR0=12,k$a.COLOR1=13,k$a.NEXTTEXTURECOORDINATE0=14,k$a.TEXTURECOORDINATE1=15,k$a.NEXTTEXTURECOORDINATE1=16,k$a.CORNERTEXTURECOORDINATE0=17,k$a.VELOCITY0=18,k$a.STARTCOLOR0=19,k$a.STARTSIZE=20,k$a.AGEADDSCALE0=21,k$a.STARTROTATION=22,k$a.ENDCOLOR0=23,k$a.STARTLIFETIME=24,k$a.TIME0=33,k$a.SHAPEPOSITIONSTARTLIFETIME=30,k$a.DIRECTIONTIME=32,k$a.SIZEROTATION0=27,k$a.RADIUS0=28,k$a.RADIAN0=29,k$a.STARTSPEED=31,k$a.RANDOM0=34,k$a.RANDOM1=35,k$a.SIMULATIONWORLDPOSTION=36,k$a.SIMULATIONWORLDROTATION=37,k$a.TEXTURECOORDINATE0X=38,k$a.TEXTURECOORDINATE0X1=39,k$a.TEXTURECOORDINATE0Y=40,k$a.OFFSETVECTOR=41}(),function(){function k$a(k$a,k$b,k$c){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=k$a,this._textureCoordinate0=k$b,this._time=k$c}k$n(k$a,"laya.d3.graphics.VertexGlitter");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate0}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"time",function(){return this._time}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(24,[new k$ga(0,"vector3",0),new k$ga(12,"vector2",2),new k$ga(20,"single",33)])}])}(),function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=k$a,this._position=k$b,this._velocity=k$c,this._startColor=k$d,this._endColor=k$e,this._sizeRotation=k$f,this._radius=k$g,this._radian=k$h,this._ageAddScale=k$i,this._time=k$j}k$n(k$a,"laya.d3.graphics.VertexParticle");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"endColor",function(){return this._endColor}),k$o(0,k$b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),k$o(0,k$b,"sizeRotation",function(){return this._sizeRotation}),k$o(0,k$b,"velocity",function(){return this._velocity}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"startColor",function(){return this._startColor}),k$o(0,k$b,"radius",function(){return this._radius}),k$o(0,k$b,"radian",function(){return this._radian}),k$o(0,k$b,"ageAddScale",function(){return this._ageAddScale}),k$o(0,k$b,"time",function(){return this._time}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(116,[new k$ga(0,"vector4",17),new k$ga(16,"vector3",0),new k$ga(28,"vector3",18),new k$ga(40,"vector4",19),new k$ga(56,"vector4",23),new k$ga(72,"vector3",27),new k$ga(84,"vector2",28),new k$ga(92,"vector4",29),new k$ga(108,"single",24),new k$ga(112,"single",33)])}])}(),function(){function k$a(k$a){this._position=null,this._position=k$a}k$n(k$a,"laya.d3.graphics.VertexPosition");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(12,[new k$ga(0,"vector3",0)])}]),k$a}()),k$ia=function(){function k$a(k$a,k$b){this._position=null,this._normal=null,this._position=k$a,this._normal=k$b}k$n(k$a,"laya.d3.graphics.VertexPositionNormal");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(24,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3)])}]),k$a}(),k$ja=function(){function k$a(k$a,k$b,k$c){this._position=null,this._normal=null,this._color=null,this._position=k$a,this._normal=k$b,this._color=k$c}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColor");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(40,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1)])}]),k$a}(),k$ka=function(){function k$a(k$a,k$b,k$c,k$d,k$e){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._blendIndex=k$d,this._blendWeight=k$e}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorSkin");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(72,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector4",7),new k$ga(56,"vector4",6)])}]),k$a}(),k$la=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._tangent=k$d,this._blendIndex=k$e,this._blendWeight=k$f}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(88,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector4",7),new k$ga(56,"vector4",6),new k$ga(72,"vector4",5)])}]),k$a}(),k$ma=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._tangent=k$d,this._blendIndex=k$e,this._blendWeight=k$f}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(84,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector4",7),new k$ga(56,"vector4",6),new k$ga(72,"vector3",5)])}]),k$a}(),k$na=function(){function k$a(k$a,k$b,k$c,k$d){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._tangent=k$d}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorSTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(56,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector4",5)])}]),k$a}(),k$oa=function(){function k$a(k$a,k$b,k$c,k$d){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._tangent=k$d}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(52,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector3",5)])}]),k$a}(),k$pa=function(){function k$a(k$a,k$b,k$c,k$d){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._textureCoordinate=k$d}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTexture");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(48,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector2",2)])}]),k$a}(),k$qa=function(){function k$a(k$a,k$b,k$c,k$d,k$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._textureCoordinate0=k$d,this._textureCoordinate1=k$e}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(56,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector2",2),new k$ga(48,"vector2",15)])}]),k$a}(),k$ra=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._textureCoordinate0=k$d,this._textureCoordinate1=k$e,this._blendIndex=k$f,this._blendWeight=k$g}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(88,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector2",2),new k$ga(48,"vector2",15),new k$ga(56,"vector4",7),new k$ga(72,"vector4",6)])}]),k$a}(),k$sa=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._textureCoordinate0=k$d,this._textureCoordinate1=k$e,this._tangent=k$f,this._blendIndex=k$g,this._blendWeight=k$h}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(104,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector2",2),new k$ga(48,"vector2",15),new k$ga(56,"vector4",7),new k$ga(72,"vector4",6),new k$ga(88,"vector4",5)])}]),k$a}(),k$ta=function(){function k$a(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$b.VertexPositionNormalColorTexture0SkinTangent=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){this._position=k$a,this._normal=k$b,this._color=k$c,this._textureCoordinate0=k$d,this._textureCoordinate1=k$e,this._tangent=k$f,this._blendIndex=k$g,this._blendWeight=k$h},k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(100,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector2",2),new k$ga(48,"vector2",15),new k$ga(56,"vector4",7),new k$ga(72,"vector4",6),new k$ga(88,"vector3",5)])}]),k$a}(),k$wa=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._textureCoordinate0=k$d,this._textureCoordinate1=k$e,this._tangent=k$f}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(72,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector2",2),new k$ga(48,"vector2",15),new k$ga(56,"vector4",5)])}]),k$a}(),k$xa=function(){function k$a(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$b.VertexPositionNormalColorTexture0Tangent=function(k$a,k$b,k$c,k$d,k$e,k$f){this._position=k$a,this._normal=k$b,this._color=k$c,this._textureCoordinate0=k$d,this._textureCoordinate1=k$e,this._tangent=k$f},k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(68,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector2",2),new k$ga(48,"vector2",15),new k$ga(56,"vector3",5)])}]),k$a}(),k$ya=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._textureCoordinate=k$d,this._blendIndex=k$e,this._blendWeight=k$f}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(80,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector2",2),new k$ga(48,"vector4",7),new k$ga(64,"vector4",6)])}]),k$a}(),k$za=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._textureCoordinate=k$d,this._tangent=k$e,this._blendIndex=k$f,this._blendWeight=k$g}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(96,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector2",2),new k$ga(48,"vector4",7),new k$ga(64,"vector4",6),new k$ga(80,"vector4",5)])}]),k$a}(),k$Aa=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._textureCoordinate=k$d,this._tangent=k$e,this._blendIndex=k$f,this._blendWeight=k$g}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(92,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector2",2),new k$ga(48,"vector4",7),new k$ga(64,"vector4",6),new k$ga(80,"vector3",5)])}]),k$a}(),k$Ba=function(){function k$a(k$a,k$b,k$c,k$d,k$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._textureCoordinate=k$d,this._tangent=k$e}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(64,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector2",2),new k$ga(48,"vector4",5)])}]),k$a}(),k$Ca=function(){function k$a(k$a,k$b,k$c,k$d,k$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._color=k$c,this._textureCoordinate=k$d,this._tangent=k$e}k$n(k$a,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"color",function(){return this._color}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(60,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",1),new k$ga(40,"vector2",2),new k$ga(48,"vector3",5)])}]),k$a}(),k$Da=function(){function k$a(k$a,k$b,k$c){this._position=null,this._normal=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._tangent=k$c}k$n(k$a,"laya.d3.graphics.VertexPositionNormalSTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(40,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector4",5)])}]),k$a}(),k$Ea=function(){function k$a(k$a,k$b,k$c){this._position=null,this._normal=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._tangent=k$c}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(36,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector3",5)])}]),k$a}(),k$Fa=function(){function k$a(k$a,k$b,k$c){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=k$a,this._normal=k$b,this._textureCoordinate=k$c}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTexture");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(32,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2)])}]),k$a}(),k$Ga=function(){function k$a(k$a,k$b,k$c,k$d){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=k$a,this._normal=k$b,this._textureCoordinate0=k$c,this._textureCoordinate1=k$d}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(40,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2),new k$ga(32,"vector2",15)])}]),k$a}(),k$Ha=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=k$a,this._normal=k$b,this._textureCoordinate0=k$c,this._textureCoordinate1=k$d,this._blendIndex=k$e,this._blendWeight=k$f}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(72,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2),new k$ga(32,"vector2",15),new k$ga(40,"vector4",7),new k$ga(56,"vector4",6)])}]),k$a}(),k$Ia=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._textureCoordinate0=k$c,this._textureCoordinate1=k$d,this._tangent=k$e,this._blendIndex=k$f,this._blendWeight=k$g}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(88,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2),new k$ga(32,"vector2",15),new k$ga(40,"vector4",7),new k$ga(56,"vector4",6),new k$ga(72,"vector4",5)])}]),k$a}(),k$Ja=function(){function k$a(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$b.VertexPositionNormalTexture0SkinTangent=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){this._position=k$a,this._normal=k$b,this._textureCoordinate0=k$c,this._textureCoordinate1=k$d,this._tangent=k$e,this._blendIndex=k$f,this._blendWeight=k$g},k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(84,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2),new k$ga(32,"vector2",15),new k$ga(40,"vector4",7),new k$ga(56,"vector4",6),new k$ga(72,"vector3",5)])}]),k$a}(),k$Ka=function(){function k$a(k$a,k$b,k$c,k$d,k$e){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._textureCoordinate0=k$c,this._textureCoordinate1=k$d,this._tangent=k$e}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(56,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2),new k$ga(32,"vector2",15),new k$ga(40,"vector4",5)])}]),k$a}(),k$La=function(){function k$a(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$b.VertexPositionNormalTexture0Tangent=function(k$a,k$b,k$c,k$d,k$e){this._position=k$a,this._normal=k$b,this._textureCoordinate0=k$c,this._textureCoordinate1=k$d,this._tangent=k$e},k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(52,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2),new k$ga(32,"vector2",15),new k$ga(40,"vector3",5)])}]),k$a}(),k$Ma=function(){function k$a(k$a,k$b,k$c,k$d,k$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=k$a,this._normal=k$b,this._textureCoordinate=k$c,this._blendIndex=k$d,this._blendWeight=k$e}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTextureSkin");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(64,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2),new k$ga(32,"vector4",7),new k$ga(48,"vector4",6)])}]),k$a}(),k$Na=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._textureCoordinate=k$c,this._tangent=k$d,this._blendIndex=k$e,this._blendWeight=k$f}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(80,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2),new k$ga(32,"vector4",7),new k$ga(48,"vector4",6),new k$ga(64,"vector4",5)])}]),k$a}(),k$Oa=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._textureCoordinate=k$c,this._tangent=k$d,this._blendIndex=k$e,this._blendWeight=k$f}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(76,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2),new k$ga(32,"vector4",7),new k$ga(48,"vector4",6),new k$ga(64,"vector3",5)])}]),k$a}(),k$Pa=function(){function k$a(k$a,k$b,k$c,k$d){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._textureCoordinate=k$c,this._tangent=k$d}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(48,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2),new k$ga(32,"vector4",5)])}]),k$a}(),k$Qa=function(){function k$a(k$a,k$b,k$c,k$d){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=k$a,this._normal=k$b,this._textureCoordinate=k$c,this._tangent=k$d}k$n(k$a,"laya.d3.graphics.VertexPositionNormalTextureTangent");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(44,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2),new k$ga(32,"vector3",5)])}]),k$a}(),k$Ra=function(){function k$a(k$a,k$b,k$c){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=k$a,this._normal=k$b,this._textureCoordinate=k$c}k$n(k$a,"laya.d3.graphics.VertexPositionNTBTexture");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(56,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector3",5),new k$ga(36,"vector3",4),new k$ga(48,"vector2",2)])}]),k$a}(),k$Sa=function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=k$a,this._normal=k$b,this._textureCoordinate0=k$d,this._textureCoordinate1=k$e,this._tangent=k$f,k$c=k$c,this._blendIndex=k$g,this._blendWeight=k$h}k$n(k$a,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"tangent",function(){return this._tangent}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(0,k$b,"textureCoordinate1",function(){return this._textureCoordinate1}),k$o(0,k$b,"blendIndex",function(){return this._blendIndex}),k$o(0,k$b,"blendWeight",function(){return this._blendWeight}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(96,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector3",5),new k$ga(36,"vector3",4),new k$ga(48,"vector2",2),new k$ga(56,"vector2",15),new k$ga(64,"vector4",7),new k$ga(80,"vector4",6)])}]),k$a}(),k$Ta=function(){function k$a(k$a,k$b,k$c){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=k$a,this._normal=k$b,this._textureCoordinate=k$c}k$n(k$a,"laya.d3.graphics.VertexPositionNTBTextureSkin");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"textureCoordinate",function(){return this._textureCoordinate}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(88,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector3",5),new k$ga(36,"vector3",4),new k$ga(48,"vector2",2),new k$ga(56,"vector4",7),new k$ga(72,"vector4",6)])}]),k$a}(),k$Ua=(function(){function k$a(k$a,k$b,k$c,k$d){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=k$a,this._normal=k$b,this._textureCoord0=k$c,this._textureCoord1=k$d}k$n(k$a,"laya.d3.graphics.VertexPositionTerrain");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"normal",function(){return this._normal}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"textureCoord0",function(){return this._textureCoord0}),k$o(0,k$b,"textureCoord1",function(){return this._textureCoord1}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(40,[new k$ga(0,"vector3",0),new k$ga(12,"vector3",3),new k$ga(24,"vector2",2),new k$ga(32,"vector2",15)])}])}(),function(){function k$a(k$a,k$b){this._position=null,this._textureCoordinate0=null,this._position=k$a,this._textureCoordinate0=k$b}k$n(k$a,"laya.d3.graphics.VertexPositionTexture0");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"position",function(){return this._position}),k$o(0,k$b,"textureCoordinate0",function(){return this._textureCoordinate0}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(20,[new k$ga(0,"vector3",0),new k$ga(12,"vector2",2)])}]),k$a}()),k$Va=(function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$l,k$m,k$n){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=k$a,this._positionStartLifeTime=k$b,this._velocity=k$c,this._startColor=k$d,this._startSize=k$e,this._startRotation0=k$f,this._startRotation1=k$g,this._startRotation2=k$h,this._startLifeTime=k$i,this._time=k$j,this._startSpeed=k$k,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=k$n}k$n(k$a,"laya.d3.graphics.VertexShurikenParticleBillboard");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),k$o(0,k$b,"random1",function(){return this._randoms1}),k$o(0,k$b,"startRotation2",function(){return this._startRotation2}),k$o(0,k$b,"positionStartLifeTime",function(){return this._positionStartLifeTime}),k$o(0,k$b,"velocity",function(){return this._velocity}),k$o(0,k$b,"random0",function(){return this._randoms0}),k$o(0,k$b,"startSize",function(){return this._startSize}),k$o(0,k$b,"startColor",function(){return this._startColor}),k$o(0,k$b,"startRotation0",function(){return this._startRotation0}),k$o(0,k$b,"startRotation1",function(){return this._startRotation1}),k$o(0,k$b,"startLifeTime",function(){return this._startLifeTime}),k$o(0,k$b,"time",function(){return this._time}),k$o(0,k$b,"startSpeed",function(){return this._startSpeed}),k$o(0,k$b,"simulationWorldPostion",function(){return this._simulationWorldPostion}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(152,[new k$ga(0,"vector4",17),new k$ga(16,"vector4",30),new k$ga(32,"vector4",32),new k$ga(48,"vector4",19),new k$ga(64,"vector3",20),new k$ga(76,"vector3",22),new k$ga(88,"single",31),new k$ga(92,"vector4",34),new k$ga(108,"vector4",35),new k$ga(124,"vector3",36),new k$ga(136,"vector4",37)])}])}(),function(){function k$a(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$l,k$m,k$n){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=k$a,this._positionStartLifeTime=k$b,this._velocity=k$c,this._startColor=k$d,this._startSize=k$e,this._startRotation0=k$f,this._startRotation1=k$g,this._startRotation2=k$h,this._startLifeTime=k$i,this._time=k$j,this._startSpeed=k$k,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=k$n}k$n(k$a,"laya.d3.graphics.VertexShurikenParticleMesh");var k$b=k$a.prototype;k$x.imps(k$b,{"laya.d3.graphics.IVertex":!0}),k$o(0,k$b,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),k$o(0,k$b,"velocity",function(){return this._velocity}),k$o(0,k$b,"position",function(){return this._positionStartLifeTime}),k$o(0,k$b,"random0",function(){return this._randoms0}),k$o(0,k$b,"startSize",function(){return this._startSize}),k$o(0,k$b,"startColor",function(){return this._startColor}),k$o(0,k$b,"startRotation0",function(){return this._startRotation0}),k$o(0,k$b,"startRotation1",function(){return this._startRotation1}),k$o(0,k$b,"random1",function(){return this._randoms1}),k$o(0,k$b,"startRotation2",function(){return this._startRotation2}),k$o(0,k$b,"startLifeTime",function(){return this._startLifeTime}),k$o(0,k$b,"time",function(){return this._time}),k$o(0,k$b,"startSpeed",function(){return this._startSpeed}),k$o(0,k$b,"simulationWorldPostion",function(){return this._simulationWorldPostion}),k$o(0,k$b,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$o(1,k$a,"vertexDeclaration",function(){return k$a._vertexDeclaration}),k$l(k$a,["_vertexDeclaration",function(){return this._vertexDeclaration=new k$fa(172,[new k$ga(0,"vector3",0),new k$ga(12,"vector4",1),new k$ga(28,"vector2",2),new k$ga(36,"vector4",30),new k$ga(52,"vector4",32),new k$ga(68,"vector4",19),new k$ga(84,"vector3",20),new k$ga(96,"vector3",22),new k$ga(108,"single",31),new k$ga(112,"vector4",34),new k$ga(128,"vector4",35),new k$ga(144,"vector3",36),new k$ga(156,"vector4",37)])}])}(),function(){function k$t(k$a,k$b,k$c,k$d,k$e,k$f){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=k$c,this._materials=k$d,this._subMeshes=k$e,this._materialMap=k$f,this._version=k$b,this._onLoaded(k$a)}k$n(k$t,"laya.d3.loaders.LoadModelV01");var k$a=k$t.prototype;return k$a._onLoaded=function(k$a){this._readData=k$a,this.READ_BLOCK();for(var k$b=0;k$b<this._BLOCK.count;k$b++){var k$c=this._readData.getUint16(),k$d=this._strings[k$c],k$e=this["READ_"+k$d];if(null==k$e)throw new Error("model file err,no this function:"+k$c+" "+k$d);if(!k$e.call(this))break}return this._mesh},k$a.onError=function(){},k$a._readString=function(){return this._strings[this._readData.getUint16()]},k$a.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},k$a.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},k$a.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var k$a=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var k$b=0;k$b<this._STRINGS.size;k$b++)this._strings[k$b]=this._readData.readUTFString();return this._readData.pos=k$a,!0},k$a.READ_MATERIAL=function(){var k$a=this._readData.getUint16(),k$b=(this._readString(),this._readString());return this._materials[k$a]="null"!==k$b?k$r.getRes(this._materialMap[k$b]):new k$Eb,!0},k$a.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var k$a,k$b=this._readData.__getBuffer(),k$c=0,k$d=this._readData.getUint32(),k$e=this._readData.getUint32(),k$f=(new Float32Array(k$b.slice(k$d+this._DATA.offset,k$d+this._DATA.offset+k$e)),this._readData.getUint32()),k$g=this._readData.getUint32(),k$h=new Float32Array(k$b.slice(k$f+this._DATA.offset,k$f+this._DATA.offset+k$g));for(this.mesh._inverseBindPoses=[],k$c=0,k$a=k$h.length;k$c<k$a;k$c+=16){var k$i=new k$ab(k$h[k$c+0],k$h[k$c+1],k$h[k$c+2],k$h[k$c+3],k$h[k$c+4],k$h[k$c+5],k$h[k$c+6],k$h[k$c+7],k$h[k$c+8],k$h[k$c+9],k$h[k$c+10],k$h[k$c+11],k$h[k$c+12],k$h[k$c+13],k$h[k$c+14],k$h[k$c+15]);this.mesh._inverseBindPoses.push(k$i)}break;default:throw new Error("LoadModel:unknown version.")}return!0},k$a.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var k$a=this._readString();this._shaderAttributes=k$a.match(k$t._attrReg);var k$b=this._readData.getUint32(),k$c=this._readData.getUint32(),k$d=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),k$e=this._readData.getUint32(),k$f=this._readData.getUint32(),k$g=this._readData.getUint32(),k$h=this._readData.__getBuffer(),k$i=new k$jb(this._mesh),k$j=this._getVertexDeclaration(),k$k=k$Ob.create(k$j,k$e/k$j.vertexStride,35044,!0),k$l=k$d+this._DATA.offset,k$m=k$h.slice(k$l,k$l+k$e);k$k.setData(new Float32Array(k$m));for(var k$n=(k$i._vertexBuffer=k$k).vertexDeclaration.getVertexElements(),k$o=0;k$o<k$n.length;k$o++)k$i._bufferUsage[k$n[k$o].elementUsage]=k$k;var k$p=k$Nb.create("ushort",k$c/2,35044,!0),k$q=k$b+this._DATA.offset,k$r=k$h.slice(k$q,k$q+k$c);k$p.setData(new Uint16Array(k$r)),k$i._indexBuffer=k$p;var k$s=k$h.slice(k$f+this._DATA.offset,k$f+this._DATA.offset+k$g);return k$i._boneIndicesList[0]=new Uint8Array(k$s),this._subMeshes.push(k$i),!0},k$a.READ_DATAAREA=function(){return!1},k$a._getVertexDeclaration=function(){for(var k$a,k$b=!1,k$c=!1,k$d=!1,k$e=!1,k$f=!1,k$g=!1,k$h=!1,k$i=!1,k$j=!1,k$k=0;k$k<this._shaderAttributes.length;k$k+=8)switch(this._shaderAttributes[k$k]){case"POSITION":k$b=!0;break;case"NORMAL":k$c=!0;break;case"COLOR":k$d=!0;break;case"UV":k$e=!0;break;case"UV1":k$f=!0;break;case"BLENDWEIGHT":k$h=!0;break;case"BLENDINDICES":k$i=!0;break;case"TANGENT":k$g=!0;break;case"BINORMAL":k$j=!0}return k$b&&k$c&&k$d&&k$e&&k$f&&k$h&&k$i&&k$g?k$a=k$ta.vertexDeclaration:k$b&&k$c&&k$d&&k$e&&k$f&&k$h&&k$i?k$a=k$ra.vertexDeclaration:k$b&&k$c&&k$e&&k$f&&k$h&&k$i&&k$g?k$a=k$Ja.vertexDeclaration:k$b&&k$c&&k$e&&k$f&&k$h&&k$i?k$a=k$Ha.vertexDeclaration:k$b&&k$c&&k$d&&k$e&&k$h&&k$i&&k$g?k$a=k$Aa.vertexDeclaration:k$b&&k$c&&k$d&&k$e&&k$h&&k$i?k$a=k$ya.vertexDeclaration:k$b&&k$c&&k$g&&k$j&&k$e&&k$h&&k$i?k$a=k$Ta.vertexDeclaration:k$b&&k$c&&k$e&&k$h&&k$i&&k$g?k$a=k$Oa.vertexDeclaration:k$b&&k$c&&k$e&&k$h&&k$i?k$a=k$Ma.vertexDeclaration:k$b&&k$c&&k$d&&k$h&&k$i&&k$g?k$a=k$ma.vertexDeclaration:k$b&&k$c&&k$d&&k$h&&k$i?k$a=k$ka.vertexDeclaration:k$b&&k$c&&k$d&&k$e&&k$f&&k$g?k$a=k$xa.vertexDeclaration:k$b&&k$c&&k$d&&k$e&&k$f?k$a=k$qa.vertexDeclaration:k$b&&k$c&&k$e&&k$f&&k$g?k$a=k$La.vertexDeclaration:k$b&&k$c&&k$e&&k$f?k$a=k$Ga.vertexDeclaration:k$b&&k$c&&k$d&&k$e&&k$g?k$a=k$Ca.vertexDeclaration:k$b&&k$c&&k$e&&k$g&&k$j?k$a=k$Ra.vertexDeclaration:k$b&&k$c&&k$d&&k$e?k$a=k$pa.vertexDeclaration:k$b&&k$c&&k$e&&k$g?k$a=k$Qa.vertexDeclaration:k$b&&k$c&&k$e?k$a=k$Fa.vertexDeclaration:k$b&&k$c&&k$d&&k$g?k$a=k$oa.vertexDeclaration:k$b&&k$c&&k$d&&(k$a=k$ja.vertexDeclaration),k$a},k$o(0,k$a,"mesh",function(){return this._mesh}),k$t._attrReg=new RegExp("(\\w+)|([:,;])","g"),k$t}()),k$Wa=function(){function k$z(){}return k$n(k$z,"laya.d3.loaders.LoadModelV02"),k$z.parse=function(k$a,k$b,k$c,k$d,k$e,k$f){k$z._mesh=k$c,k$z._materials=k$d,k$z._subMeshes=k$e,k$z._materialMap=k$f,k$z._version=k$b,k$z._readData=k$a,k$z.READ_DATA(),k$z.READ_BLOCK(),k$z.READ_STRINGS();for(var k$g=0,k$h=k$z._BLOCK.count;k$g<k$h;k$g++){k$z._readData.pos=k$z._BLOCK.blockStarts[k$g];var k$i=k$z._readData.getUint16(),k$j=k$z._strings[k$i],k$k=k$z["READ_"+k$j];if(null==k$k)throw new Error("model file err,no this function:"+k$i+" "+k$j);k$k.call()}k$z._strings.length=0,k$z._readData=null,k$z._version=null,k$z._mesh=null,k$z._materials=null,k$z._subMeshes=null,k$z._materialMap=null},k$z._readString=function(){return k$z._strings[k$z._readData.getUint16()]},k$z.READ_DATA=function(){k$z._DATA.offset=k$z._readData.getUint32(),k$z._DATA.size=k$z._readData.getUint32()},k$z.READ_BLOCK=function(){for(var k$a=k$z._BLOCK.count=k$z._readData.getUint16(),k$b=k$z._BLOCK.blockStarts=[],k$c=k$z._BLOCK.blockLengths=[],k$d=0;k$d<k$a;k$d++)k$b.push(k$z._readData.getUint32()),k$c.push(k$z._readData.getUint32())},k$z.READ_STRINGS=function(){var k$a=k$z._readData.getUint32(),k$b=k$z._readData.getUint16(),k$c=k$z._readData.pos;k$z._readData.pos=k$a+k$z._DATA.offset;for(var k$d=0;k$d<k$b;k$d++)k$z._strings[k$d]=k$z._readData.readUTFString();k$z._readData.pos=k$c},k$z.READ_MATERIAL=function(){k$z._readString(),k$z._readString();var k$a=k$z._readString();return""!==k$a&&k$z._materials.push(k$r.getRes(k$z._materialMap[k$a])),!0},k$z.READ_MESH=function(){k$z._readString();var k$a,k$b=k$z._readData.__getBuffer(),k$c=0,k$d=k$z._readData.getInt16(),k$e=k$z._DATA.offset;for(k$c=0;k$c<k$d;k$c++){var k$f=k$e+k$z._readData.getUint32(),k$g=k$z._readData.getUint32(),k$h=new Float32Array(k$b.slice(k$f,k$f+k$g)),k$i=k$z._readString().match(k$z._attrReg),k$j=k$z._getVertexDeclaration(k$i),k$k=k$Ob.create(k$j,4*k$h.length/k$j.vertexStride,35044,!0);k$k.setData(k$h),k$z._mesh._vertexBuffers.push(k$k)}var k$l=k$e+k$z._readData.getUint32(),k$m=k$z._readData.getUint32(),k$n=new Uint16Array(k$b.slice(k$l,k$l+k$m)),k$o=k$Nb.create("ushort",k$m/2,35044,!0);k$o.setData(k$n),k$z._mesh._indexBuffer=k$o;var k$p=k$z._mesh._boneNames=[],k$q=k$z._readData.getUint16();for(k$p.length=k$q,k$c=0;k$c<k$q;k$c++)k$p[k$c]=k$z._strings[k$z._readData.getUint16()];var k$r=k$z._readData.getUint32(),k$s=k$z._readData.getUint32(),k$t=(new Float32Array(k$b.slice(k$e+k$r,k$e+k$r+k$s)),k$z._readData.getUint32()),k$w=k$z._readData.getUint32(),k$x=new Float32Array(k$b.slice(k$e+k$t,k$e+k$t+k$w));for(k$z._mesh._inverseBindPoses=[],k$c=0,k$a=k$x.length;k$c<k$a;k$c+=16){var k$y=new k$ab(k$x[k$c+0],k$x[k$c+1],k$x[k$c+2],k$x[k$c+3],k$x[k$c+4],k$x[k$c+5],k$x[k$c+6],k$x[k$c+7],k$x[k$c+8],k$x[k$c+9],k$x[k$c+10],k$x[k$c+11],k$x[k$c+12],k$x[k$c+13],k$x[k$c+14],k$x[k$c+15]);k$z._mesh._inverseBindPoses.push(k$y)}return k$z._mesh._skinnedDatas=new Float32Array(16*k$x.length),!0},k$z.READ_SUBMESH=function(){var k$a=k$z._readData.__getBuffer(),k$b=new k$jb(k$z._mesh),k$c=k$z._readData.getInt16(),k$d=k$z._readData.getUint32(),k$e=k$z._readData.getUint32();k$b._vertexBuffer=k$z._mesh._vertexBuffers[k$c],k$b._vertexStart=k$d,k$b._vertexCount=k$e;var k$f=k$z._readData.getUint32(),k$g=k$z._readData.getUint32(),k$h=k$z._mesh._indexBuffer;k$b._indexBuffer=k$h,k$b._indexStart=k$f,k$b._indexCount=k$g,k$b._indices=new Uint16Array(k$h.getData().buffer,2*k$f,k$g);var k$i=k$z._DATA.offset,k$j=k$b._subIndexBufferStart,k$k=k$b._subIndexBufferCount,k$l=k$b._boneIndicesList,k$m=k$z._readData.getUint16();k$j.length=k$m,k$k.length=k$m,k$l.length=k$m;for(var k$n=0;k$n<k$m;k$n++){k$j[k$n]=k$z._readData.getUint32(),k$k[k$n]=k$z._readData.getUint32();var k$o=k$z._readData.getUint32(),k$p=k$z._readData.getUint32();k$b._boneIndicesList[k$n]=new Uint8Array(k$a.slice(k$i+k$o,k$i+k$o+k$p))}return k$z._subMeshes.push(k$b),!0},k$z._getVertexDeclaration=function(k$a){for(var k$b,k$c=!1,k$d=!1,k$e=!1,k$f=!1,k$g=!1,k$h=!1,k$i=!1,k$j=!1,k$k=!1,k$l=0;k$l<k$a.length;k$l++)switch(k$a[k$l]){case"POSITION":k$c=!0;break;case"NORMAL":k$d=!0;break;case"COLOR":k$e=!0;break;case"UV":k$f=!0;break;case"UV1":k$g=!0;break;case"BLENDWEIGHT":k$i=!0;break;case"BLENDINDICES":k$j=!0;break;case"TANGENT":k$h=!0;break;case"BINORMAL":k$k=!0}return k$c&&k$d&&k$e&&k$f&&k$g&&k$i&&k$j&&k$h?k$b=k$ta.vertexDeclaration:k$c&&k$d&&k$e&&k$f&&k$g&&k$i&&k$j?k$b=k$ra.vertexDeclaration:k$c&&k$d&&k$f&&k$g&&k$i&&k$j&&k$h?k$b=k$Ja.vertexDeclaration:k$c&&k$d&&k$f&&k$g&&k$i&&k$j?k$b=k$Ha.vertexDeclaration:k$c&&k$d&&k$e&&k$f&&k$i&&k$j&&k$h?k$b=k$Aa.vertexDeclaration:k$c&&k$d&&k$e&&k$f&&k$i&&k$j?k$b=k$ya.vertexDeclaration:k$c&&k$d&&k$f&&k$i&&k$j&&k$h?k$b=k$Oa.vertexDeclaration:k$c&&k$d&&k$f&&k$i&&k$j?k$b=k$Ma.vertexDeclaration:k$c&&k$d&&k$e&&k$i&&k$j&&k$h?k$b=k$ma.vertexDeclaration:k$c&&k$d&&k$e&&k$i&&k$j?k$b=k$ka.vertexDeclaration:k$c&&k$d&&k$e&&k$f&&k$g&&k$h?k$b=k$xa.vertexDeclaration:k$c&&k$d&&k$e&&k$f&&k$g?k$b=k$qa.vertexDeclaration:k$c&&k$d&&k$f&&k$g&&k$h?k$b=k$La.vertexDeclaration:k$c&&k$d&&k$f&&k$g?k$b=k$Ga.vertexDeclaration:k$c&&k$d&&k$e&&k$f&&k$h?k$b=k$Ca.vertexDeclaration:k$c&&k$d&&k$f&&k$h&&k$k?k$b=k$Ra.vertexDeclaration:k$c&&k$d&&k$e&&k$f?k$b=k$pa.vertexDeclaration:k$c&&k$d&&k$f&&k$h?k$b=k$Qa.vertexDeclaration:k$c&&k$d&&k$f?k$b=k$Fa.vertexDeclaration:k$c&&k$d&&k$e&&k$h?k$b=k$oa.vertexDeclaration:k$c&&k$d&&k$e&&(k$b=k$ja.vertexDeclaration),k$b},k$z._attrReg=new RegExp("(\\w+)|([:,;])","g"),k$z._strings=[],k$z._readData=null,k$z._version=null,k$z._mesh=null,k$z._materials=null,k$z._subMeshes=null,k$z._materialMap=null,k$l(k$z,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),k$z}(),k$Xa=function(){function k$y(){}return k$n(k$y,"laya.d3.loaders.LoadModelV03"),k$y.parse=function(k$a,k$b,k$c,k$d,k$e){k$y._mesh=k$c,k$y._subMeshes=k$d,k$y._materialMap=k$e,k$y._version=k$b,k$y._readData=k$a,k$y.READ_DATA(),k$y.READ_BLOCK(),k$y.READ_STRINGS();for(var k$f=0,k$g=k$y._BLOCK.count;k$f<k$g;k$f++){k$y._readData.pos=k$y._BLOCK.blockStarts[k$f];var k$h=k$y._readData.getUint16(),k$i=k$y._strings[k$h],k$j=k$y["READ_"+k$i];if(null==k$j)throw new Error("model file err,no this function:"+k$h+" "+k$i);k$j.call()}k$y._strings.length=0,k$y._readData=null,k$y._version=null,k$y._mesh=null,k$y._subMeshes=null,k$y._materialMap=null},k$y._readString=function(){return k$y._strings[k$y._readData.getUint16()]},k$y.READ_DATA=function(){k$y._DATA.offset=k$y._readData.getUint32(),k$y._DATA.size=k$y._readData.getUint32()},k$y.READ_BLOCK=function(){for(var k$a=k$y._BLOCK.count=k$y._readData.getUint16(),k$b=k$y._BLOCK.blockStarts=[],k$c=k$y._BLOCK.blockLengths=[],k$d=0;k$d<k$a;k$d++)k$b.push(k$y._readData.getUint32()),k$c.push(k$y._readData.getUint32())},k$y.READ_STRINGS=function(){var k$a=k$y._readData.getUint32(),k$b=k$y._readData.getUint16(),k$c=k$y._readData.pos;k$y._readData.pos=k$a+k$y._DATA.offset;for(var k$d=0;k$d<k$b;k$d++)k$y._strings[k$d]=k$y._readData.readUTFString();k$y._readData.pos=k$c},k$y.READ_MESH=function(){var k$a,k$b=k$y._readString(),k$c=k$y._readData.__getBuffer(),k$d=0,k$e=k$y._readData.getInt16(),k$f=k$y._DATA.offset;for(k$d=0;k$d<k$e;k$d++){var k$g,k$h=k$f+k$y._readData.getUint32(),k$i=k$y._readData.getUint32(),k$j=new Float32Array(k$c.slice(k$h,k$h+k$i)),k$k=k$y._readString();switch(k$y._version){case"LAYAMODEL:03":k$g=k$y._vertexDeclarationMap_Discard[k$k];break;case"LAYAMODEL:0301":k$g=k$y._vertexDeclarationMap[k$k];break;default:throw new Error("LoadModelV03: unknown version.")}if(!k$g)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+k$y._version+"  bufferAttribute="+k$k+"  name="+k$b+"  url="+(k$y._mesh?k$y._mesh.url:"null"));var k$l=k$Ob.create(k$g,4*k$j.length/k$g.vertexStride,35044,!0,k$y._mesh._url+"_"+k$d);k$l.setData(k$j),k$y._mesh._vertexBuffers.push(k$l)}var k$m=k$f+k$y._readData.getUint32(),k$n=k$y._readData.getUint32(),k$o=new Uint16Array(k$c.slice(k$m,k$m+k$n)),k$p=k$Nb.create("ushort",k$n/2,35044,!0,k$y._mesh._url);k$p.setData(k$o),k$y._mesh._indexBuffer=k$p;var k$q=k$y._mesh._boneNames=[],k$r=k$y._readData.getUint16();for(k$q.length=k$r,k$d=0;k$d<k$r;k$d++)k$q[k$d]=k$y._strings[k$y._readData.getUint16()];k$y._readData.pos+=8;var k$s=k$y._readData.getUint32(),k$t=k$y._readData.getUint32(),k$w=new Float32Array(k$c.slice(k$f+k$s,k$f+k$s+k$t));for(k$y._mesh._inverseBindPoses=[],k$d=0,k$a=k$w.length;k$d<k$a;k$d+=16){var k$x=new k$ab(k$w[k$d+0],k$w[k$d+1],k$w[k$d+2],k$w[k$d+3],k$w[k$d+4],k$w[k$d+5],k$w[k$d+6],k$w[k$d+7],k$w[k$d+8],k$w[k$d+9],k$w[k$d+10],k$w[k$d+11],k$w[k$d+12],k$w[k$d+13],k$w[k$d+14],k$w[k$d+15]);k$y._mesh._inverseBindPoses.push(k$x)}return k$y._mesh._skinnedDatas=new Float32Array(16*k$w.length),!0},k$y.READ_SUBMESH=function(){var k$a=k$y._readData.__getBuffer(),k$b=new k$jb(k$y._mesh),k$c=k$y._readData.getInt16(),k$d=k$y._readData.getUint32(),k$e=k$y._readData.getUint32();k$b._vertexBuffer=k$y._mesh._vertexBuffers[k$c],k$b._vertexStart=k$d,k$b._vertexCount=k$e;var k$f=k$y._readData.getUint32(),k$g=k$y._readData.getUint32(),k$h=k$y._mesh._indexBuffer;k$b._indexBuffer=k$h,k$b._indexStart=k$f,k$b._indexCount=k$g,k$b._indices=new Uint16Array(k$h.getData().buffer,2*k$f,k$g);var k$i=k$y._DATA.offset,k$j=k$b._subIndexBufferStart,k$k=k$b._subIndexBufferCount,k$l=k$b._boneIndicesList,k$m=k$y._readData.getUint16();k$j.length=k$m,k$k.length=k$m,k$l.length=k$m;for(var k$n=0;k$n<k$m;k$n++){k$j[k$n]=k$y._readData.getUint32(),k$k[k$n]=k$y._readData.getUint32();var k$o=k$y._readData.getUint32(),k$p=k$y._readData.getUint32();k$l[k$n]=new Uint8Array(k$a.slice(k$i+k$o,k$i+k$o+k$p))}return k$y._subMeshes.push(k$b),!0},k$y._strings=[],k$y._readData=null,k$y._version=null,k$y._mesh=null,k$y._subMeshes=null,k$y._materialMap=null,k$l(k$y,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":k$ta.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":k$ra.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":k$Sa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":k$Ja.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":k$Ha.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":k$Aa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":k$ya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":k$Oa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":k$Ma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":k$ma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":k$ka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":k$xa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":k$qa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":k$La.vertexDeclaration,"POSITION,NORMAL,UV,UV1":k$Ga.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":k$Ca.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":k$Ra.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":k$pa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":k$Qa.vertexDeclaration,"POSITION,NORMAL,UV":k$Fa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":k$oa.vertexDeclaration,"POSITION,NORMAL,COLOR":k$ja.vertexDeclaration,"POSITION,NORMAL,TANGENT":k$Ea.vertexDeclaration,"POSITION,NORMAL":k$ia.vertexDeclaration,"POSITION,UV":k$Ua.vertexDeclaration,POSITION:k$ha.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":k$sa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":k$ra.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":k$Sa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":k$Ia.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":k$Ha.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":k$za.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":k$ya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":k$Na.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":k$Ma.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":k$la.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":k$ka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":k$wa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":k$qa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":k$Ka.vertexDeclaration,"POSITION,NORMAL,UV,UV1":k$Ga.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":k$Ba.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":k$Ra.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":k$pa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":k$Pa.vertexDeclaration,"POSITION,NORMAL,UV":k$Fa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":k$na.vertexDeclaration,"POSITION,NORMAL,COLOR":k$ja.vertexDeclaration,"POSITION,NORMAL,TANGENT":k$Da.vertexDeclaration,"POSITION,NORMAL":k$ia.vertexDeclaration,"POSITION,UV":k$Ua.vertexDeclaration,POSITION:k$ha.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),k$y}(),k$Ya=function(){function k$h(){}return k$n(k$h,"laya.d3.loaders.MeshReader"),k$h.read=function(k$a,k$b,k$c,k$d,k$e){var k$f=new k$y(k$a);k$f.pos=0;var k$g=k$f.readUTFString();switch(k$g){case"LAYAMODEL:01":case"LAYASKINANI:01":k$h._readVersion01(k$f,k$g,k$b,k$c,k$d,k$e);break;case"LAYAMODEL:02":k$Wa.parse(k$f,k$g,k$b,k$c,k$d,k$e);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":k$Xa.parse(k$f,k$g,k$b,k$d,k$e);break;default:throw new Error("MeshReader: unknown mesh version.")}k$b._setSubMeshes(k$d)},k$h._readVersion01=function(k$a,k$b,k$c,k$d,k$e,k$f){new k$Va(k$a,k$b,k$c,k$d,k$e,k$f)},k$h}(),k$Za=function(){function k$a(k$a,k$b){this.min=null,this.max=null,this.min=k$a,this.max=k$b}k$n(k$a,"laya.d3.math.BoundBox");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b.getCorners=function(k$a){k$a.length=8;var k$b=this.min.elements,k$c=this.max.elements,k$d=k$b[0],k$e=k$b[1],k$f=k$b[2],k$g=k$c[0],k$h=k$c[1],k$i=k$c[2];k$a[0]=new k$gb(k$d,k$h,k$i),k$a[1]=new k$gb(k$g,k$h,k$i),k$a[2]=new k$gb(k$g,k$e,k$i),k$a[3]=new k$gb(k$d,k$e,k$i),k$a[4]=new k$gb(k$d,k$h,k$f),k$a[5]=new k$gb(k$g,k$h,k$f),k$a[6]=new k$gb(k$g,k$e,k$f),k$a[7]=new k$gb(k$d,k$e,k$f)},k$b.toDefault=function(){this.min.toDefault(),this.max.toDefault()},k$b.cloneTo=function(k$a){var k$b=k$a;this.min.cloneTo(k$b.min),this.max.cloneTo(k$b.max)},k$b.clone=function(){var k$a=new this.constructor(new k$gb,new k$gb);return this.cloneTo(k$a),k$a},k$a.createfromPoints=function(k$a,k$b){if(null==k$a)throw new Error("points");var k$c=k$b.min,k$d=k$b.max,k$e=k$c.elements;k$e[0]=Number.MAX_VALUE,k$e[1]=Number.MAX_VALUE,k$e[2]=Number.MAX_VALUE;var k$f=k$d.elements;k$f[0]=-Number.MAX_VALUE,k$f[1]=-Number.MAX_VALUE,k$f[2]=-Number.MAX_VALUE;for(var k$g=0,k$h=k$a.length;k$g<k$h;++k$g)k$gb.min(k$c,k$a[k$g],k$c),k$gb.max(k$d,k$a[k$g],k$d)},k$a.merge=function(k$a,k$b,k$c){k$gb.min(k$a.min,k$b.min,k$c.min),k$gb.max(k$a.max,k$b.max,k$c.max)},k$a}(),k$$a=function(){function k$j(k$a){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=k$a,this._near=new k$bb(new k$gb),this._far=new k$bb(new k$gb),this._left=new k$bb(new k$gb),this._right=new k$bb(new k$gb),this._top=new k$bb(new k$gb),this._bottom=new k$bb(new k$gb),k$j._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}k$n(k$j,"laya.d3.math.BoundFrustum");var k$a=k$j.prototype;return k$a.equalsBoundFrustum=function(k$a){return this._matrix.equalsOtherMatrix(k$a.matrix)},k$a.equalsObj=function(k$a){if(k$a instanceof laya.d3.math.BoundFrustum){var k$b=k$a;return this.equalsBoundFrustum(k$b)}return!1},k$a.getPlane=function(k$a){switch(k$a){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},k$a.getCorners=function(k$a){k$j._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(k$a[0]),k$j._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(k$a[1]),k$j._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(k$a[2]),k$j._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(k$a[3]),k$j._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(k$a[4]),k$j._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(k$a[5]),k$j._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(k$a[6]),k$j._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(k$a[7])},k$a.containsPoint=function(k$a){for(var k$b=k$bb.PlaneIntersectionType_Front,k$c=k$bb.PlaneIntersectionType_Front,k$d=0;k$d<6;k$d++){switch(k$d){case 0:k$c=Collision.intersectsPlaneAndPoint(this._near,k$a);break;case 1:k$c=Collision.intersectsPlaneAndPoint(this._far,k$a);break;case 2:k$c=Collision.intersectsPlaneAndPoint(this._left,k$a);break;case 3:k$c=Collision.intersectsPlaneAndPoint(this._right,k$a);break;case 4:k$c=Collision.intersectsPlaneAndPoint(this._top,k$a);break;case 5:k$c=Collision.intersectsPlaneAndPoint(this._bottom,k$a)}switch(k$c){case k$bb.PlaneIntersectionType_Back:return 0;case k$bb.PlaneIntersectionType_Intersecting:k$b=k$bb.PlaneIntersectionType_Intersecting}}switch(k$b){case k$bb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},k$a.containsBoundBox=function(k$a){for(var k$b,k$c=k$j._tempV30,k$d=k$j._tempV31,k$e=1,k$f=0;k$f<6;k$f++){if(k$b=this.getPlane(k$f),this._getBoxToPlanePVertexNVertex(k$a,k$b.normal,k$c,k$d),Collision.intersectsPlaneAndPoint(k$b,k$c)===k$bb.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(k$b,k$d)===k$bb.PlaneIntersectionType_Back&&(k$e=2)}return k$e},k$a.containsBoundSphere=function(k$a){for(var k$b=k$bb.PlaneIntersectionType_Front,k$c=k$bb.PlaneIntersectionType_Front,k$d=0;k$d<6;k$d++){switch(k$d){case 0:k$c=Collision.intersectsPlaneAndSphere(this._near,k$a);break;case 1:k$c=Collision.intersectsPlaneAndSphere(this._far,k$a);break;case 2:k$c=Collision.intersectsPlaneAndSphere(this._left,k$a);break;case 3:k$c=Collision.intersectsPlaneAndSphere(this._right,k$a);break;case 4:k$c=Collision.intersectsPlaneAndSphere(this._top,k$a);break;case 5:k$c=Collision.intersectsPlaneAndSphere(this._bottom,k$a)}switch(k$c){case k$bb.PlaneIntersectionType_Back:return 0;case k$bb.PlaneIntersectionType_Intersecting:k$b=k$bb.PlaneIntersectionType_Intersecting}}switch(k$b){case k$bb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},k$a._getBoxToPlanePVertexNVertex=function(k$a,k$b,k$c,k$d){var k$e=k$a.min,k$f=k$e.elements,k$g=k$a.max,k$h=k$g.elements,k$i=k$b.elements,k$j=k$i[0],k$k=k$i[1],k$l=k$i[2];k$e.cloneTo(k$c);var k$m=k$c.elements;0<=k$j&&(k$m[0]=k$h[0]),0<=k$k&&(k$m[1]=k$h[1]),0<=k$l&&(k$m[2]=k$h[2]),k$g.cloneTo(k$d);var k$n=k$d.elements;0<=k$j&&(k$n[0]=k$f[0]),0<=k$k&&(k$n[1]=k$f[1]),0<=k$l&&(k$n[2]=k$f[2])},k$o(0,k$a,"top",function(){return this._top}),k$o(0,k$a,"matrix",function(){return this._matrix},function(k$a){this._matrix=k$a,k$j._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),k$o(0,k$a,"near",function(){return this._near}),k$o(0,k$a,"far",function(){return this._far}),k$o(0,k$a,"left",function(){return this._left}),k$o(0,k$a,"right",function(){return this._right}),k$o(0,k$a,"bottom",function(){return this._bottom}),k$j._getPlanesFromMatrix=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){var k$h=k$a.elements,k$i=k$h[0],k$j=k$h[1],k$k=k$h[2],k$l=k$h[3],k$m=k$h[4],k$n=k$h[5],k$o=k$h[6],k$p=k$h[7],k$q=k$h[8],k$r=k$h[9],k$s=k$h[10],k$t=k$h[11],k$w=k$h[12],k$x=k$h[13],k$y=k$h[14],k$z=k$h[15],k$A=k$b.normal.elements;k$A[0]=k$l+k$k,k$A[1]=k$p+k$o,k$A[2]=k$t+k$s,k$b.distance=k$z+k$y,k$b.normalize();var k$B=k$c.normal.elements;k$B[0]=k$l-k$k,k$B[1]=k$p-k$o,k$B[2]=k$t-k$s,k$c.distance=k$z-k$y,k$c.normalize();var k$C=k$d.normal.elements;k$C[0]=k$l+k$i,k$C[1]=k$p+k$m,k$C[2]=k$t+k$q,k$d.distance=k$z+k$w,k$d.normalize();var k$D=k$e.normal.elements;k$D[0]=k$l-k$i,k$D[1]=k$p-k$m,k$D[2]=k$t-k$q,k$e.distance=k$z-k$w,k$e.normalize();var k$E=k$f.normal.elements;k$E[0]=k$l-k$j,k$E[1]=k$p-k$n,k$E[2]=k$t-k$r,k$f.distance=k$z-k$x,k$f.normalize();var k$F=k$g.normal.elements;k$F[0]=k$l+k$j,k$F[1]=k$p+k$n,k$F[2]=k$t+k$r,k$g.distance=k$z+k$x,k$g.normalize()},k$j._get3PlaneInterPoint=function(k$a,k$b,k$c){var k$d=k$a.normal,k$e=k$b.normal,k$f=k$c.normal;k$gb.cross(k$e,k$f,k$j._tempV30),k$gb.cross(k$f,k$d,k$j._tempV31),k$gb.cross(k$d,k$e,k$j._tempV32);var k$g=k$gb.dot(k$d,k$j._tempV30),k$h=k$gb.dot(k$e,k$j._tempV31),k$i=k$gb.dot(k$f,k$j._tempV32);return k$gb.scale(k$j._tempV30,-k$a.distance/k$g,k$j._tempV33),k$gb.scale(k$j._tempV31,-k$b.distance/k$h,k$j._tempV34),k$gb.scale(k$j._tempV32,-k$c.distance/k$i,k$j._tempV35),k$gb.add(k$j._tempV33,k$j._tempV34,k$j._tempV36),k$gb.add(k$j._tempV35,k$j._tempV36,k$j._tempV37),k$j._tempV37},k$l(k$j,["_tempV30",function(){return this._tempV30=new k$gb},"_tempV31",function(){return this._tempV31=new k$gb},"_tempV32",function(){return this._tempV32=new k$gb},"_tempV33",function(){return this._tempV33=new k$gb},"_tempV34",function(){return this._tempV34=new k$gb},"_tempV35",function(){return this._tempV35=new k$gb},"_tempV36",function(){return this._tempV36=new k$gb},"_tempV37",function(){return this._tempV37=new k$gb}]),k$j}(),k$_a=function(){function k$k(k$a,k$b){this.center=null,this.radius=NaN,this.center=k$a,this.radius=k$b}k$n(k$k,"laya.d3.math.BoundSphere");var k$a=k$k.prototype;return k$x.imps(k$a,{"laya.d3.core.IClone":!0}),k$a.toDefault=function(){this.center.toDefault(),this.radius=0},k$a.intersectsRayDistance=function(k$a){return Collision.intersectsRayAndSphereRD(k$a,this)},k$a.intersectsRayPoint=function(k$a,k$b){return Collision.intersectsRayAndSphereRP(k$a,this,k$b)},k$a.cloneTo=function(k$a){var k$b=k$a;this.center.cloneTo(k$b.center),k$b.radius=this.radius},k$a.clone=function(){var k$a=new this.constructor(new k$gb,new k$gb);return this.cloneTo(k$a),k$a},k$k.createFromSubPoints=function(k$a,k$b,k$c,k$d){if(null==k$a)throw new Error("points");if(k$b<0||k$b>=k$a.length)throw new Error("start"+k$b+"Must be in the range [0, "+(k$a.length-1)+"]");if(k$c<0||k$b+k$c>k$a.length)throw new Error("count"+k$c+"Must be in the range <= "+k$a.length+"}");var k$e=k$b+k$c,k$f=k$k._tempVector3;k$f.elements[0]=0,k$f.elements[1]=0,k$f.elements[2]=0;for(var k$g=k$b;k$g<k$e;++k$g)k$gb.add(k$a[k$g],k$f,k$f);var k$h=k$d.center;k$gb.scale(k$f,1/k$c,k$h);var k$i=0;for(k$g=k$b;k$g<k$e;++k$g){var k$j=k$gb.distanceSquared(k$h,k$a[k$g]);k$i<k$j&&(k$i=k$j)}k$d.radius=Math.sqrt(k$i)},k$k.createfromPoints=function(k$a,k$b){if(null==k$a)throw new Error("points");k$k.createFromSubPoints(k$a,0,k$a.length,k$b)},k$l(k$k,["_tempVector3",function(){return this._tempVector3=new k$gb}]),k$k}(),k$ua=(function(){function k$a(){}k$n(k$a,"laya.d3.math.ContainmentType"),k$a.Disjoint=0,k$a.Contains=1,k$a.Intersects=2}(),function(){function k$c(){}return k$n(k$c,"laya.d3.math.MathUtils3D"),k$c.isZero=function(k$a){return Math.abs(k$a)<k$c.zeroTolerance},k$c.nearEqual=function(k$a,k$b){return!!k$c.isZero(k$a-k$b)},k$c.fastInvSqrt=function(k$a){return k$c.isZero(k$a)?k$a:1/Math.sqrt(k$a)},k$l(k$c,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),k$c}()),k$va=function(){function k$i(){var k$a=this.elements=new Float32Array(9);k$a[0]=1,k$a[1]=0,k$a[2]=0,k$a[3]=0,k$a[4]=1,k$a[5]=0,k$a[6]=0,k$a[7]=0,k$a[8]=1}k$n(k$i,"laya.d3.math.Matrix3x3");var k$a=k$i.prototype;return k$x.imps(k$a,{"laya.d3.core.IClone":!0}),k$a.determinant=function(){var k$a=this.elements,k$b=k$a[0],k$c=k$a[1],k$d=k$a[2],k$e=k$a[3],k$f=k$a[4],k$g=k$a[5],k$h=k$a[6],k$i=k$a[7],k$j=k$a[8];return k$b*(k$j*k$f-k$g*k$i)+k$c*(-k$j*k$e+k$g*k$h)+k$d*(k$i*k$e-k$f*k$h)},k$a.translate=function(k$a,k$b){var k$c=k$b.elements,k$d=this.elements,k$e=k$a.elements,k$f=k$d[0],k$g=k$d[1],k$h=k$d[2],k$i=k$d[3],k$j=k$d[4],k$k=k$d[5],k$l=k$d[6],k$m=k$d[7],k$n=k$d[8],k$o=k$e[0],k$p=k$e[1];k$c[0]=k$f,k$c[1]=k$g,k$c[2]=k$h,k$c[3]=k$i,k$c[4]=k$j,k$c[5]=k$k,k$c[6]=k$o*k$f+k$p*k$i+k$l,k$c[7]=k$o*k$g+k$p*k$j+k$m,k$c[8]=k$o*k$h+k$p*k$k+k$n},k$a.rotate=function(k$a,k$b){var k$c=k$b.elements,k$d=this.elements,k$e=k$d[0],k$f=k$d[1],k$g=k$d[2],k$h=k$d[3],k$i=k$d[4],k$j=k$d[5],k$k=k$d[6],k$l=k$d[7],k$m=k$d[8],k$n=Math.sin(k$a),k$o=Math.cos(k$a);k$c[0]=k$o*k$e+k$n*k$h,k$c[1]=k$o*k$f+k$n*k$i,k$c[2]=k$o*k$g+k$n*k$j,k$c[3]=k$o*k$h-k$n*k$e,k$c[4]=k$o*k$i-k$n*k$f,k$c[5]=k$o*k$j-k$n*k$g,k$c[6]=k$k,k$c[7]=k$l,k$c[8]=k$m},k$a.scale=function(k$a,k$b){var k$c=k$b.elements,k$d=this.elements,k$e=k$a.elements,k$f=k$e[0],k$g=k$e[1];k$c[0]=k$f*k$d[0],k$c[1]=k$f*k$d[1],k$c[2]=k$f*k$d[2],k$c[3]=k$g*k$d[3],k$c[4]=k$g*k$d[4],k$c[5]=k$g*k$d[5],k$c[6]=k$d[6],k$c[7]=k$d[7],k$c[8]=k$d[8]},k$a.invert=function(k$a){var k$b=k$a.elements,k$c=this.elements,k$d=k$c[0],k$e=k$c[1],k$f=k$c[2],k$g=k$c[3],k$h=k$c[4],k$i=k$c[5],k$j=k$c[6],k$k=k$c[7],k$l=k$c[8],k$m=k$l*k$h-k$i*k$k,k$n=-k$l*k$g+k$i*k$j,k$o=k$k*k$g-k$h*k$j,k$p=k$d*k$m+k$e*k$n+k$f*k$o;k$p||(k$a=null),k$p=1/k$p,k$b[0]=k$m*k$p,k$b[1]=(-k$l*k$e+k$f*k$k)*k$p,k$b[2]=(k$i*k$e-k$f*k$h)*k$p,k$b[3]=k$n*k$p,k$b[4]=(k$l*k$d-k$f*k$j)*k$p,k$b[5]=(-k$i*k$d+k$f*k$g)*k$p,k$b[6]=k$o*k$p,k$b[7]=(-k$k*k$d+k$e*k$j)*k$p,k$b[8]=(k$h*k$d-k$e*k$g)*k$p},k$a.transpose=function(k$a){var k$b=k$a.elements,k$c=this.elements;if(k$a===this){var k$d=k$c[1],k$e=k$c[2],k$f=k$c[5];k$b[1]=k$c[3],k$b[2]=k$c[6],k$b[3]=k$d,k$b[5]=k$c[7],k$b[6]=k$e,k$b[7]=k$f}else k$b[0]=k$c[0],k$b[1]=k$c[3],k$b[2]=k$c[6],k$b[3]=k$c[1],k$b[4]=k$c[4],k$b[5]=k$c[7],k$b[6]=k$c[2],k$b[7]=k$c[5],k$b[8]=k$c[8]},k$a.identity=function(){var k$a=this.elements;k$a[0]=1,k$a[1]=0,k$a[2]=0,k$a[3]=0,k$a[4]=1,k$a[5]=0,k$a[6]=0,k$a[7]=0,k$a[8]=1},k$a.cloneTo=function(k$a){var k$b,k$c,k$d;if((k$c=this.elements)!==(k$d=k$a.elements))for(k$b=0;k$b<9;++k$b)k$d[k$b]=k$c[k$b]},k$a.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$i.createFromTranslation=function(k$a,k$b){k$b.elements;var k$c=k$a.elements;k$b[0]=1,k$b[1]=0,k$b[2]=0,k$b[3]=0,k$b[4]=1,k$b[5]=0,k$b[6]=k$c[0],k$b[7]=k$c[1],k$b[8]=1},k$i.createFromRotation=function(k$a,k$b){var k$c=k$b.elements,k$d=Math.sin(k$a),k$e=Math.cos(k$a);k$c[0]=k$e,k$c[1]=k$d,k$c[2]=0,k$c[3]=-k$d,k$c[4]=k$e,k$c[5]=0,k$c[6]=0,k$c[7]=0,k$c[8]=1},k$i.createFromScaling=function(k$a,k$b){var k$c=k$b.elements,k$d=k$a.elements;k$c[0]=k$d[0],k$c[1]=0,k$c[2]=0,k$c[3]=0,k$c[4]=k$d[1],k$c[5]=0,k$c[6]=0,k$c[7]=0,k$c[8]=1},k$i.createFromMatrix4x4=function(k$a,k$b){k$b[0]=k$a[0],k$b[1]=k$a[1],k$b[2]=k$a[2],k$b[3]=k$a[4],k$b[4]=k$a[5],k$b[5]=k$a[6],k$b[6]=k$a[8],k$b[7]=k$a[9],k$b[8]=k$a[10]},k$i.multiply=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements,k$g=k$e[0],k$h=k$e[1],k$i=k$e[2],k$j=k$e[3],k$k=k$e[4],k$l=k$e[5],k$m=k$e[6],k$n=k$e[7],k$o=k$e[8],k$p=k$f[0],k$q=k$f[1],k$r=k$f[2],k$s=k$f[3],k$t=k$f[4],k$w=k$f[5],k$x=k$f[6],k$y=k$f[7],k$z=k$f[8];k$d[0]=k$p*k$g+k$q*k$j+k$r*k$m,k$d[1]=k$p*k$h+k$q*k$k+k$r*k$n,k$d[2]=k$p*k$i+k$q*k$l+k$r*k$o,k$d[3]=k$s*k$g+k$t*k$j+k$w*k$m,k$d[4]=k$s*k$h+k$t*k$k+k$w*k$n,k$d[5]=k$s*k$i+k$t*k$l+k$w*k$o,k$d[6]=k$x*k$g+k$y*k$j+k$z*k$m,k$d[7]=k$x*k$h+k$y*k$k+k$z*k$n,k$d[8]=k$x*k$i+k$y*k$l+k$z*k$o},k$i.lookAt=function(k$a,k$b,k$c,k$d){k$gb.subtract(k$a,k$b,k$i._tempV30),k$gb.normalize(k$i._tempV30,k$i._tempV30),k$gb.cross(k$c,k$i._tempV30,k$i._tempV31),k$gb.normalize(k$i._tempV31,k$i._tempV31),k$gb.cross(k$i._tempV30,k$i._tempV31,k$i._tempV32);var k$e=k$i._tempV30.elements,k$f=k$i._tempV31.elements,k$g=k$i._tempV32.elements,k$h=k$d.elements;k$h[0]=k$f[0],k$h[3]=k$f[1],k$h[6]=k$f[2],k$h[1]=k$g[0],k$h[4]=k$g[1],k$h[7]=k$g[2],k$h[2]=k$e[0],k$h[5]=k$e[1],k$h[8]=k$e[2]},k$i.DEFAULT=new k$i,k$l(k$i,["_tempV30",function(){return this._tempV30=new k$gb},"_tempV31",function(){return this._tempV31=new k$gb},"_tempV32",function(){return this._tempV32=new k$gb}]),k$i}(),k$ab=function(){function k$B(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$l,k$m,k$n,k$o,k$p){void 0===k$a&&(k$a=1),void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=0),void 0===k$e&&(k$e=0),void 0===k$f&&(k$f=1),void 0===k$g&&(k$g=0),void 0===k$h&&(k$h=0),void 0===k$i&&(k$i=0),void 0===k$j&&(k$j=0),void 0===k$k&&(k$k=1),void 0===k$l&&(k$l=0),void 0===k$m&&(k$m=0),void 0===k$n&&(k$n=0),void 0===k$o&&(k$o=0),void 0===k$p&&(k$p=1);var k$q=this.elements=new Float32Array(16);k$q[0]=k$a,k$q[1]=k$b,k$q[2]=k$c,k$q[3]=k$d,k$q[4]=k$e,k$q[5]=k$f,k$q[6]=k$g,k$q[7]=k$h,k$q[8]=k$i,k$q[9]=k$j,k$q[10]=k$k,k$q[11]=k$l,k$q[12]=k$m,k$q[13]=k$n,k$q[14]=k$o,k$q[15]=k$p}k$n(k$B,"laya.d3.math.Matrix4x4");var k$a=k$B.prototype;return k$x.imps(k$a,{"laya.d3.core.IClone":!0}),k$a.getElementByRowColumn=function(k$a,k$b){if(k$a<0||3<k$a)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(k$b<0||3<k$b)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*k$a+k$b]},k$a.setElementByRowColumn=function(k$a,k$b,k$c){if(k$a<0||3<k$a)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(k$b<0||3<k$b)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*k$a+k$b]=k$c},k$a.equalsOtherMatrix=function(k$a){var k$b=this.elements,k$c=k$a.elements;return k$ua.nearEqual(k$b[0],k$c[0])&&k$ua.nearEqual(k$b[1],k$c[1])&&k$ua.nearEqual(k$b[2],k$c[2])&&k$ua.nearEqual(k$b[3],k$c[3])&&k$ua.nearEqual(k$b[4],k$c[4])&&k$ua.nearEqual(k$b[5],k$c[5])&&k$ua.nearEqual(k$b[6],k$c[6])&&k$ua.nearEqual(k$b[7],k$c[7])&&k$ua.nearEqual(k$b[8],k$c[8])&&k$ua.nearEqual(k$b[9],k$c[9])&&k$ua.nearEqual(k$b[10],k$c[10])&&k$ua.nearEqual(k$b[11],k$c[11])&&k$ua.nearEqual(k$b[12],k$c[12])&&k$ua.nearEqual(k$b[13],k$c[13])&&k$ua.nearEqual(k$b[14],k$c[14])&&k$ua.nearEqual(k$b[15],k$c[15])},k$a.decomposeTransRotScale=function(k$a,k$b,k$c){var k$d=k$B._tempMatrix4x4;return this.decomposeTransRotMatScale(k$a,k$d,k$c)?(k$cb.createFromMatrix4x4(k$d,k$b),!0):(k$b.identity(),!1)},k$a.decomposeTransRotMatScale=function(k$a,k$b,k$c){var k$d=this.elements,k$e=k$a.elements,k$f=k$b.elements,k$g=k$c.elements;k$e[0]=k$d[12],k$e[1]=k$d[13],k$e[2]=k$d[14];var k$h=k$d[0],k$i=k$d[1],k$j=k$d[2],k$k=k$d[4],k$l=k$d[5],k$m=k$d[6],k$n=k$d[8],k$o=k$d[9],k$p=k$d[10],k$q=k$g[0]=Math.sqrt(k$h*k$h+k$i*k$i+k$j*k$j),k$r=k$g[1]=Math.sqrt(k$k*k$k+k$l*k$l+k$m*k$m),k$s=k$g[2]=Math.sqrt(k$n*k$n+k$o*k$o+k$p*k$p);if(k$ua.isZero(k$q)||k$ua.isZero(k$r)||k$ua.isZero(k$s))return k$f[1]=k$f[2]=k$f[3]=k$f[4]=k$f[6]=k$f[7]=k$f[8]=k$f[9]=k$f[11]=k$f[12]=k$f[13]=k$f[14]=0,k$f[0]=k$f[5]=k$f[10]=k$f[15]=1,!1;var k$t=k$B._tempVector0,k$w=k$t.elements;k$w[0]=k$n/k$s,k$w[1]=k$o/k$s,k$w[2]=k$p/k$s;var k$x=k$B._tempVector1,k$y=k$x.elements;k$y[0]=k$h/k$q,k$y[1]=k$i/k$q,k$y[2]=k$j/k$q;var k$z=k$B._tempVector2;k$gb.cross(k$t,k$x,k$z);var k$A=k$B._tempVector1;return k$gb.cross(k$z,k$t,k$A),k$f[3]=k$f[7]=k$f[11]=k$f[12]=k$f[13]=k$f[14]=0,k$f[15]=1,k$f[0]=k$A.x,k$f[1]=k$A.y,k$f[2]=k$A.z,k$f[4]=k$z.x,k$f[5]=k$z.y,k$f[6]=k$z.z,k$f[8]=k$t.x,k$f[9]=k$t.y,k$f[10]=k$t.z,k$f[0]*k$h+k$f[1]*k$i+k$f[2]*k$j<0&&(k$g[0]=-k$q),k$f[4]*k$k+k$f[5]*k$l+k$f[6]*k$m<0&&(k$g[1]=-k$r),k$f[8]*k$n+k$f[9]*k$o+k$f[10]*k$p<0&&(k$g[2]=-k$s),!0},k$a.decomposeYawPitchRoll=function(k$a){var k$b=k$a.elements,k$c=Math.asin(-this.elements[9]);k$b[1]=k$c,Math.cos(k$c)>k$ua.zeroTolerance?(k$b[2]=Math.atan2(this.elements[1],this.elements[5]),k$b[0]=Math.atan2(this.elements[8],this.elements[10])):(k$b[2]=Math.atan2(-this.elements[4],this.elements[0]),k$b[0]=0)},k$a.normalize=function(){var k$a=this.elements,k$b=k$a[0],k$c=k$a[1],k$d=k$a[2],k$e=Math.sqrt(k$b*k$b+k$c*k$c+k$d*k$d);if(!k$e)return k$a[0]=0,k$a[1]=0,void(k$a[2]=0);1!=k$e&&(k$e=1/k$e,k$a[0]=k$b*k$e,k$a[1]=k$c*k$e,k$a[2]=k$d*k$e)},k$a.transpose=function(){var k$a,k$b;return k$b=(k$a=this.elements)[1],k$a[1]=k$a[4],k$a[4]=k$b,k$b=k$a[2],k$a[2]=k$a[8],k$a[8]=k$b,k$b=k$a[3],k$a[3]=k$a[12],k$a[12]=k$b,k$b=k$a[6],k$a[6]=k$a[9],k$a[9]=k$b,k$b=k$a[7],k$a[7]=k$a[13],k$a[13]=k$b,k$b=k$a[11],k$a[11]=k$a[14],k$a[14]=k$b,this},k$a.invert=function(k$a){var k$b=this.elements,k$c=k$a.elements,k$d=k$b[0],k$e=k$b[1],k$f=k$b[2],k$g=k$b[3],k$h=k$b[4],k$i=k$b[5],k$j=k$b[6],k$k=k$b[7],k$l=k$b[8],k$m=k$b[9],k$n=k$b[10],k$o=k$b[11],k$p=k$b[12],k$q=k$b[13],k$r=k$b[14],k$s=k$b[15],k$t=k$d*k$i-k$e*k$h,k$w=k$d*k$j-k$f*k$h,k$x=k$d*k$k-k$g*k$h,k$y=k$e*k$j-k$f*k$i,k$z=k$e*k$k-k$g*k$i,k$A=k$f*k$k-k$g*k$j,k$B=k$l*k$q-k$m*k$p,k$C=k$l*k$r-k$n*k$p,k$D=k$l*k$s-k$o*k$p,k$E=k$m*k$r-k$n*k$q,k$F=k$m*k$s-k$o*k$q,k$G=k$n*k$s-k$o*k$r,k$H=k$t*k$G-k$w*k$F+k$x*k$E+k$y*k$D-k$z*k$C+k$A*k$B;0!==Math.abs(k$H)&&(k$H=1/k$H,k$c[0]=(k$i*k$G-k$j*k$F+k$k*k$E)*k$H,k$c[1]=(k$f*k$F-k$e*k$G-k$g*k$E)*k$H,k$c[2]=(k$q*k$A-k$r*k$z+k$s*k$y)*k$H,k$c[3]=(k$n*k$z-k$m*k$A-k$o*k$y)*k$H,k$c[4]=(k$j*k$D-k$h*k$G-k$k*k$C)*k$H,k$c[5]=(k$d*k$G-k$f*k$D+k$g*k$C)*k$H,k$c[6]=(k$r*k$x-k$p*k$A-k$s*k$w)*k$H,k$c[7]=(k$l*k$A-k$n*k$x+k$o*k$w)*k$H,k$c[8]=(k$h*k$F-k$i*k$D+k$k*k$B)*k$H,k$c[9]=(k$e*k$D-k$d*k$F-k$g*k$B)*k$H,k$c[10]=(k$p*k$z-k$q*k$x+k$s*k$t)*k$H,k$c[11]=(k$m*k$x-k$l*k$z-k$o*k$t)*k$H,k$c[12]=(k$i*k$C-k$h*k$E-k$j*k$B)*k$H,k$c[13]=(k$d*k$E-k$e*k$C+k$f*k$B)*k$H,k$c[14]=(k$q*k$w-k$p*k$y-k$r*k$t)*k$H,k$c[15]=(k$l*k$y-k$m*k$w+k$n*k$t)*k$H)},k$a.identity=function(){var k$a=this.elements;k$a[1]=k$a[2]=k$a[3]=k$a[4]=k$a[6]=k$a[7]=k$a[8]=k$a[9]=k$a[11]=k$a[12]=k$a[13]=k$a[14]=0,k$a[0]=k$a[5]=k$a[10]=k$a[15]=1},k$a.cloneTo=function(k$a){var k$b,k$c,k$d;if((k$c=this.elements)!==(k$d=k$a.elements))for(k$b=0;k$b<16;++k$b)k$d[k$b]=k$c[k$b]},k$a.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$a.getTranslationVector=function(k$a){var k$b=this.elements,k$c=k$a.elements;k$c[0]=k$b[12],k$c[1]=k$b[13],k$c[2]=k$b[14]},k$a.setTranslationVector=function(k$a){var k$b=this.elements,k$c=k$a.elements;k$b[12]=k$c[0],k$b[13]=k$c[1],k$b[14]=k$c[2]},k$a.getForward=function(k$a){var k$b=this.elements,k$c=k$a.elements;k$c[0]=-k$b[8],k$c[1]=-k$b[9],k$c[2]=-k$b[10]},k$a.setForward=function(k$a){var k$b=this.elements,k$c=k$a.elements;k$b[8]=-k$c[0],k$b[9]=-k$c[1],k$b[10]=-k$c[2]},k$B.createRotationX=function(k$a,k$b){var k$c=k$b.elements,k$d=Math.sin(k$a),k$e=Math.cos(k$a);k$c[1]=k$c[2]=k$c[3]=k$c[4]=k$c[7]=k$c[8]=k$c[11]=k$c[12]=k$c[13]=k$c[14]=0,k$c[0]=k$c[15]=1,k$c[5]=k$c[10]=k$e,k$c[6]=k$d,k$c[9]=-k$d},k$B.createRotationY=function(k$a,k$b){var k$c=k$b.elements,k$d=Math.sin(k$a),k$e=Math.cos(k$a);k$c[1]=k$c[3]=k$c[4]=k$c[6]=k$c[7]=k$c[9]=k$c[11]=k$c[12]=k$c[13]=k$c[14]=0,k$c[5]=k$c[15]=1,k$c[0]=k$c[10]=k$e,k$c[2]=-k$d,k$c[8]=k$d},k$B.createRotationZ=function(k$a,k$b){var k$c=k$b.elements,k$d=Math.sin(k$a),k$e=Math.cos(k$a);k$c[2]=k$c[3]=k$c[6]=k$c[7]=k$c[8]=k$c[9]=k$c[11]=k$c[12]=k$c[13]=k$c[14]=0,k$c[10]=k$c[15]=1,k$c[0]=k$c[5]=k$e,k$c[1]=k$d,k$c[4]=-k$d},k$B.createRotationYawPitchRoll=function(k$a,k$b,k$c,k$d){k$cb.createFromYawPitchRoll(k$a,k$b,k$c,k$B._tempQuaternion),k$B.createRotationQuaternion(k$B._tempQuaternion,k$d)},k$B.createRotationAxis=function(k$a,k$b,k$c){var k$d=k$a.elements,k$e=k$d[0],k$f=k$d[1],k$g=k$d[2],k$h=Math.cos(k$b),k$i=Math.sin(k$b),k$j=k$e*k$e,k$k=k$f*k$f,k$l=k$g*k$g,k$m=k$e*k$f,k$n=k$e*k$g,k$o=k$f*k$g,k$p=k$c.elements;k$p[3]=k$p[7]=k$p[11]=k$p[12]=k$p[13]=k$p[14]=0,k$p[15]=1,k$p[0]=k$j+k$h*(1-k$j),k$p[1]=k$m-k$h*k$m+k$i*k$g,k$p[2]=k$n-k$h*k$n-k$i*k$f,k$p[4]=k$m-k$h*k$m-k$i*k$g,k$p[5]=k$k+k$h*(1-k$k),k$p[6]=k$o-k$h*k$o+k$i*k$e,k$p[8]=k$n-k$h*k$n+k$i*k$f,k$p[9]=k$o-k$h*k$o-k$i*k$e,k$p[10]=k$l+k$h*(1-k$l)},k$B.createRotationQuaternion=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements,k$e=k$c[0],k$f=k$c[1],k$g=k$c[2],k$h=k$c[3],k$i=k$e*k$e,k$j=k$f*k$f,k$k=k$g*k$g,k$l=k$e*k$f,k$m=k$g*k$h,k$n=k$g*k$e,k$o=k$f*k$h,k$p=k$f*k$g,k$q=k$e*k$h;k$d[3]=k$d[7]=k$d[11]=k$d[12]=k$d[13]=k$d[14]=0,k$d[15]=1,k$d[0]=1-2*(k$j+k$k),k$d[1]=2*(k$l+k$m),k$d[2]=2*(k$n-k$o),k$d[4]=2*(k$l-k$m),k$d[5]=1-2*(k$k+k$i),k$d[6]=2*(k$p+k$q),k$d[8]=2*(k$n+k$o),k$d[9]=2*(k$p-k$q),k$d[10]=1-2*(k$j+k$i)},k$B.createTranslate=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements;k$d[4]=k$d[8]=k$d[1]=k$d[9]=k$d[2]=k$d[6]=k$d[3]=k$d[7]=k$d[11]=0,k$d[0]=k$d[5]=k$d[10]=k$d[15]=1,k$d[12]=k$c[0],k$d[13]=k$c[1],k$d[14]=k$c[2]},k$B.createScaling=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements;k$d[0]=k$c[0],k$d[5]=k$c[1],k$d[10]=k$c[2],k$d[1]=k$d[4]=k$d[8]=k$d[12]=k$d[9]=k$d[13]=k$d[2]=k$d[6]=k$d[14]=k$d[3]=k$d[7]=k$d[11]=0,k$d[15]=1},k$B.multiply=function(k$a,k$b,k$c){var k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k;for(k$e=k$c.elements,k$f=k$a.elements,k$e===(k$g=k$b.elements)&&(k$g=k$g.slice()),k$d=0;k$d<4;k$d++)k$h=k$f[k$d],k$i=k$f[k$d+4],k$j=k$f[k$d+8],k$k=k$f[k$d+12],k$e[k$d]=k$h*k$g[0]+k$i*k$g[1]+k$j*k$g[2]+k$k*k$g[3],k$e[k$d+4]=k$h*k$g[4]+k$i*k$g[5]+k$j*k$g[6]+k$k*k$g[7],k$e[k$d+8]=k$h*k$g[8]+k$i*k$g[9]+k$j*k$g[10]+k$k*k$g[11],k$e[k$d+12]=k$h*k$g[12]+k$i*k$g[13]+k$j*k$g[14]+k$k*k$g[15]},k$B.createFromQuaternion=function(k$a,k$b){var k$c=k$b.elements,k$d=k$a.elements,k$e=k$d[0],k$f=k$d[1],k$g=k$d[2],k$h=k$d[3],k$i=k$e+k$e,k$j=k$f+k$f,k$k=k$g+k$g,k$l=k$e*k$i,k$m=k$f*k$i,k$n=k$f*k$j,k$o=k$g*k$i,k$p=k$g*k$j,k$q=k$g*k$k,k$r=k$h*k$i,k$s=k$h*k$j,k$t=k$h*k$k;k$c[0]=1-k$n-k$q,k$c[1]=k$m+k$t,k$c[2]=k$o-k$s,k$c[3]=0,k$c[4]=k$m-k$t,k$c[5]=1-k$l-k$q,k$c[6]=k$p+k$r,k$c[7]=0,k$c[8]=k$o+k$s,k$c[9]=k$p-k$r,k$c[10]=1-k$l-k$n,k$c[11]=0,k$c[12]=0,k$c[13]=0,k$c[14]=0,k$c[15]=1},k$B.createAffineTransformation=function(k$a,k$b,k$c,k$d){var k$e=k$a.elements,k$f=k$b.elements,k$g=k$c.elements,k$h=k$d.elements,k$i=k$f[0],k$j=k$f[1],k$k=k$f[2],k$l=k$f[3],k$m=k$i+k$i,k$n=k$j+k$j,k$o=k$k+k$k,k$p=k$i*k$m,k$q=k$i*k$n,k$r=k$i*k$o,k$s=k$j*k$n,k$t=k$j*k$o,k$w=k$k*k$o,k$x=k$l*k$m,k$y=k$l*k$n,k$z=k$l*k$o,k$A=k$g[0],k$B=k$g[1],k$C=k$g[2];k$h[0]=(1-(k$s+k$w))*k$A,k$h[1]=(k$q+k$z)*k$A,k$h[2]=(k$r-k$y)*k$A,k$h[3]=0,k$h[4]=(k$q-k$z)*k$B,k$h[5]=(1-(k$p+k$w))*k$B,k$h[6]=(k$t+k$x)*k$B,k$h[7]=0,k$h[8]=(k$r+k$y)*k$C,k$h[9]=(k$t-k$x)*k$C,k$h[10]=(1-(k$p+k$s))*k$C,k$h[11]=0,k$h[12]=k$e[0],k$h[13]=k$e[1],k$h[14]=k$e[2],k$h[15]=1},k$B.createLookAt=function(k$a,k$b,k$c,k$d){var k$e=k$d.elements,k$f=k$B._tempVector0,k$g=k$B._tempVector1,k$h=k$B._tempVector2;k$gb.subtract(k$a,k$b,k$h),k$gb.normalize(k$h,k$h),k$gb.cross(k$c,k$h,k$f),k$gb.normalize(k$f,k$f),k$gb.cross(k$h,k$f,k$g),k$d.identity(),k$e[0]=k$f.x,k$e[4]=k$f.y,k$e[8]=k$f.z,k$e[1]=k$g.x,k$e[5]=k$g.y,k$e[9]=k$g.z,k$e[2]=k$h.x,k$e[6]=k$h.y,k$e[10]=k$h.z,k$e[12]=-k$gb.dot(k$f,k$a),k$e[13]=-k$gb.dot(k$g,k$a),k$e[14]=-k$gb.dot(k$h,k$a)},k$B.createPerspective=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$e.elements,k$g=1/Math.tan(k$a/2),k$h=1/(k$c-k$d);k$f[0]=k$g/k$b,k$f[5]=k$g,k$f[10]=(k$d+k$c)*k$h,k$f[11]=-1,k$f[14]=2*k$d*k$c*k$h,k$f[1]=k$f[2]=k$f[3]=k$f[4]=k$f[6]=k$f[7]=k$f[8]=k$f[9]=k$f[12]=k$f[13]=k$f[15]=0},k$B.createOrthoOffCenterRH=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){var k$h=k$g.elements,k$i=1/(k$a-k$b),k$j=1/(k$c-k$d),k$k=1/(k$e-k$f);k$h[1]=k$h[2]=k$h[3]=k$h[4]=k$h[6]=k$h[7]=k$h[8]=k$h[9]=k$h[11]=0,k$h[15]=1,k$h[0]=-2*k$i,k$h[5]=-2*k$j,k$h[10]=2*k$k,k$h[12]=(k$a+k$b)*k$i,k$h[13]=(k$d+k$c)*k$j,k$h[14]=(k$f+k$e)*k$k},k$B.translation=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements;k$d[0]=k$d[5]=k$d[10]=k$d[15]=1,k$d[12]=k$c[0],k$d[13]=k$c[1],k$d[14]=k$c[2]},k$l(k$B,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new k$B},"_tempVector0",function(){return this._tempVector0=new k$gb},"_tempVector1",function(){return this._tempVector1=new k$gb},"_tempVector2",function(){return this._tempVector2=new k$gb},"_tempQuaternion",function(){return this._tempQuaternion=new k$cb},"DEFAULT",function(){return this.DEFAULT=new k$B},"ZERO",function(){return this.ZERO=new k$B(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),k$B}(),k$bb=(function(){function k$t(k$a,k$b){this.extents=null,this.transformation=null,this.extents=k$a,this.transformation=k$b}k$n(k$t,"laya.d3.math.OrientedBoundBox");var k$a=k$t.prototype;k$a.getCorners=function(k$a){var k$b=k$t._tempV30.elements,k$c=k$t._tempV31.elements,k$d=k$t._tempV32.elements,k$e=this.extents.elements;k$b[0]=k$e[0],k$b[1]=k$b[2]=0,k$c[1]=k$e[1],k$c[0]=k$c[2]=0,k$d[2]=k$e[2],k$d[0]=k$d[1]=0,k$gb.TransformNormal(k$t._tempV30,this.transformation,k$t._tempV30),k$gb.TransformNormal(k$t._tempV31,this.transformation,k$t._tempV31),k$gb.TransformNormal(k$t._tempV32,this.transformation,k$t._tempV32);var k$f=k$t._tempV33;this.transformation.getTranslationVector(k$f),k$a.length=8,k$gb.add(k$f,k$t._tempV30,k$t._tempV34),k$gb.add(k$t._tempV34,k$t._tempV31,k$t._tempV34),k$gb.add(k$t._tempV34,k$t._tempV32,k$a[0]),k$gb.add(k$f,k$t._tempV30,k$t._tempV34),k$gb.add(k$t._tempV34,k$t._tempV31,k$t._tempV34),k$gb.subtract(k$t._tempV34,k$t._tempV32,k$a[1]),k$gb.subtract(k$f,k$t._tempV30,k$t._tempV34),k$gb.add(k$t._tempV34,k$t._tempV31,k$t._tempV34),k$gb.subtract(k$t._tempV34,k$t._tempV32,k$a[2]),k$gb.subtract(k$f,k$t._tempV30,k$t._tempV34),k$gb.add(k$t._tempV34,k$t._tempV31,k$t._tempV34),k$gb.add(k$t._tempV34,k$t._tempV32,k$a[3]),k$gb.add(k$f,k$t._tempV30,k$t._tempV34),k$gb.subtract(k$t._tempV34,k$t._tempV31,k$t._tempV34),k$gb.add(k$t._tempV34,k$t._tempV32,k$a[4]),k$gb.add(k$f,k$t._tempV30,k$t._tempV34),k$gb.subtract(k$t._tempV34,k$t._tempV31,k$t._tempV34),k$gb.subtract(k$t._tempV34,k$t._tempV32,k$a[5]),k$gb.subtract(k$f,k$t._tempV30,k$t._tempV34),k$gb.subtract(k$t._tempV34,k$t._tempV31,k$t._tempV34),k$gb.subtract(k$t._tempV34,k$t._tempV32,k$a[6]),k$gb.subtract(k$f,k$t._tempV30,k$t._tempV34),k$gb.subtract(k$t._tempV34,k$t._tempV31,k$t._tempV34),k$gb.add(k$t._tempV34,k$t._tempV32,k$a[7])},k$a.transform=function(k$a){k$ab.multiply(this.transformation,k$a,this.transformation)},k$a.scale=function(k$a){k$gb.multiply(this.extents,k$a,this.extents)},k$a.translate=function(k$a){this.transformation.getTranslationVector(k$t._tempV30),k$gb.add(k$t._tempV30,k$a,k$t._tempV31),this.transformation.setTranslationVector(k$t._tempV31)},k$a.Size=function(k$a){k$gb.scale(this.extents,2,k$a)},k$a.getSize=function(k$a){var k$b=this.extents.elements;k$t._tempV30.x=k$b[0],k$t._tempV31.y=k$b[1],k$t._tempV32.z=k$b[2],k$gb.TransformNormal(k$t._tempV30,this.transformation,k$t._tempV30),k$gb.TransformNormal(k$t._tempV31,this.transformation,k$t._tempV31),k$gb.TransformNormal(k$t._tempV31,this.transformation,k$t._tempV32);var k$c=k$a.elements;k$c[0]=k$gb.scalarLength(k$t._tempV30),k$c[1]=k$gb.scalarLength(k$t._tempV31),k$c[2]=k$gb.scalarLength(k$t._tempV32)},k$a.getSizeSquared=function(k$a){var k$b=this.extents.elements;k$t._tempV30.x=k$b[0],k$t._tempV31.y=k$b[1],k$t._tempV32.z=k$b[2],k$gb.TransformNormal(k$t._tempV30,this.transformation,k$t._tempV30),k$gb.TransformNormal(k$t._tempV31,this.transformation,k$t._tempV31),k$gb.TransformNormal(k$t._tempV31,this.transformation,k$t._tempV32);var k$c=k$a.elements;k$c[0]=k$gb.scalarLengthSquared(k$t._tempV30),k$c[1]=k$gb.scalarLengthSquared(k$t._tempV31),k$c[2]=k$gb.scalarLengthSquared(k$t._tempV32)},k$a.getCenter=function(k$a){this.transformation.getTranslationVector(k$a)},k$a.containsPoint=function(k$a){var k$b=this.extents.elements,k$c=k$b[0],k$d=k$b[1],k$e=k$b[2];this.transformation.invert(k$t._tempM0),k$gb.transformCoordinate(k$a,k$t._tempM0,k$t._tempV30);var k$f=k$t._tempV30.elements,k$g=Math.abs(k$f[0]),k$h=Math.abs(k$f[1]),k$i=Math.abs(k$f[2]);return k$ua.nearEqual(k$g,k$c)&&k$ua.nearEqual(k$h,k$d)&&k$ua.nearEqual(k$i,k$e)?2:k$g<k$c&&k$h<k$d&&k$i<k$e?1:0},k$a.containsPoints=function(k$a){var k$b=this.extents.elements,k$c=k$b[0],k$d=k$b[1],k$e=k$b[2];this.transformation.invert(k$t._tempM0);for(var k$f=!0,k$g=!1,k$h=0;k$h<k$a.length;k$h++){k$gb.transformCoordinate(k$a[k$h],k$t._tempM0,k$t._tempV30);var k$i=k$t._tempV30.elements,k$j=Math.abs(k$i[0]),k$k=Math.abs(k$i[1]),k$l=Math.abs(k$i[2]);k$ua.nearEqual(k$j,k$c)&&k$ua.nearEqual(k$k,k$d)&&k$ua.nearEqual(k$l,k$e)&&(k$g=!0),k$j<k$c&&k$k<k$d&&k$l<k$e?k$g=!0:k$f=!1}return k$f?1:k$g?2:0},k$a.containsSphere=function(k$a,k$b){void 0===k$b&&(k$b=!1);var k$c=this.extents.elements,k$d=k$c[0],k$e=k$c[1],k$f=k$c[2],k$g=k$a.radius;this.transformation.invert(k$t._tempM0),k$gb.transformCoordinate(k$a.center,k$t._tempM0,k$t._tempV30);var k$h=NaN;if(k$h=k$b?k$g:(k$gb.scale(k$gb.UnitX,k$g,k$t._tempV31),k$gb.TransformNormal(k$t._tempV31,k$t._tempM0,k$t._tempV31),k$gb.scalarLength(k$t._tempV31)),k$gb.scale(this.extents,-1,k$t._tempV32),k$gb.Clamp(k$t._tempV30,k$t._tempV32,this.extents,k$t._tempV33),k$h*k$h<k$gb.distanceSquared(k$t._tempV30,k$t._tempV33))return 0;var k$i=k$t._tempV30.elements,k$j=k$i[0],k$k=k$i[1],k$l=k$i[2],k$m=k$t._tempV32.elements,k$n=k$m[0],k$o=k$m[1],k$p=k$m[2];return k$n+k$h<=k$j&&k$j<=k$d-k$h&&k$h<k$d-k$n&&k$o+k$h<=k$k&&k$k<=k$e-k$h&&k$h<k$e-k$o&&k$p+k$h<=k$l&&k$l<=k$f-k$h&&k$h<k$f-k$p?1:2},k$a.containsOrientedBoundBox=function(k$a){var k$b=0,k$c=0;k$a.getCorners(k$t._corners);var k$d=this.containsPoints(k$t._corners);if(0!=k$d)return k$d;var k$e=this.extents.elements;k$a.extents.cloneTo(k$t._tempV35);var k$f=k$t._tempV35.elements;k$t._getRows(this.transformation,k$t._rows1),k$t._getRows(k$a.transformation,k$t._rows2);var k$g=NaN;for(k$b=0;k$b<4;k$b++)for(k$c=0;k$c<4;k$c++)3==k$b||3==k$c?(k$t._tempM0.setElementByRowColumn(k$b,k$c,0),k$t._tempM1.setElementByRowColumn(k$b,k$c,0)):(k$g=k$gb.dot(k$t._rows1[k$b],k$t._rows2[k$c]),k$t._tempM0.setElementByRowColumn(k$b,k$c,k$g),k$t._tempM1.setElementByRowColumn(k$b,k$c,Math.abs(k$g)));k$a.getCenter(k$t._tempV34),this.getCenter(k$t._tempV36),k$gb.subtract(k$t._tempV34,k$t._tempV36,k$t._tempV30);var k$h=k$t._tempV31.elements;k$h[0]=k$gb.dot(k$t._tempV30,k$t._rows1[0]),k$h[1]=k$gb.dot(k$t._tempV30,k$t._rows1[1]),k$h[2]=k$gb.dot(k$t._tempV30,k$t._rows1[2]);var k$i=k$t._tempV32.elements,k$j=k$t._tempV33.elements;for(k$b=0;k$b<3;k$b++)if(k$i[0]=k$t._tempM1.getElementByRowColumn(k$b,0),k$i[1]=k$t._tempM1.getElementByRowColumn(k$b,1),k$i[2]=k$t._tempM1.getElementByRowColumn(k$b,2),k$e[k$b]+k$gb.dot(k$t._tempV35,k$t._tempV32)<Math.abs(k$h[k$b]))return 0;for(k$c=0;k$c<3;k$c++)if(k$i[0]=k$t._tempM1.getElementByRowColumn(0,k$c),k$i[1]=k$t._tempM1.getElementByRowColumn(1,k$c),k$i[2]=k$t._tempM1.getElementByRowColumn(2,k$c),k$j[0]=k$t._tempM0.getElementByRowColumn(0,k$c),k$j[1]=k$t._tempM0.getElementByRowColumn(1,k$c),k$j[2]=k$t._tempM0.getElementByRowColumn(2,k$c),k$gb.dot(this.extents,k$t._tempV32)+k$f[k$c]<Math.abs(k$gb.dot(k$t._tempV31,k$t._tempV33)))return 0;for(k$b=0;k$b<3;k$b++)for(k$c=0;k$c<3;k$c++){var k$k=(k$b+1)%3,k$l=(k$b+2)%3,k$m=(k$c+1)%3,k$n=(k$c+2)%3;if(k$e[k$k]*k$t._tempM1.getElementByRowColumn(k$l,k$c)+k$e[k$l]*k$t._tempM1.getElementByRowColumn(k$k,k$c)+(k$f[k$m]*k$t._tempM1.getElementByRowColumn(k$b,k$n)+k$f[k$n]*k$t._tempM1.getElementByRowColumn(k$b,k$m))<Math.abs(k$h[k$l]*k$t._tempM0.getElementByRowColumn(k$k,k$c)-k$h[k$k]*k$t._tempM0.getElementByRowColumn(k$l,k$c)))return 0}return 2},k$a.containsLine=function(k$a,k$b){k$t._corners[0]=k$a,k$t._corners[1]=k$b;var k$c=this.containsPoints(k$t._corners);if(0!=k$c)return k$c;var k$d=this.extents.elements,k$e=k$d[0],k$f=k$d[1],k$g=k$d[2];this.transformation.invert(k$t._tempM0),k$gb.transformCoordinate(k$a,k$t._tempM0,k$t._tempV30),k$gb.transformCoordinate(k$b,k$t._tempM0,k$t._tempV31),k$gb.add(k$t._tempV30,k$t._tempV31,k$t._tempV32),k$gb.scale(k$t._tempV32,.5,k$t._tempV32),k$gb.subtract(k$t._tempV30,k$t._tempV32,k$t._tempV33);var k$h=k$t._tempV33.elements,k$i=k$h[0],k$j=k$h[1],k$k=k$h[2],k$l=k$t._tempV34.elements,k$m=k$l[0]=Math.abs(k$h[0]),k$n=k$l[1]=Math.abs(k$h[1]),k$o=k$l[2]=Math.abs(k$h[2]),k$p=k$t._tempV32.elements,k$q=k$p[0],k$r=k$p[1],k$s=k$p[2];return Math.abs(k$q)>k$e+k$m?0:Math.abs(k$r)>k$f+k$n?0:Math.abs(k$s)>k$g+k$o?0:Math.abs(k$r*k$k-k$s*k$j)>k$f*k$o+k$g*k$n?0:Math.abs(k$q*k$k-k$s*k$i)>k$e*k$o+k$g*k$m?0:Math.abs(k$q*k$j-k$r*k$i)>k$e*k$n+k$f*k$m?0:2},k$a.containsBoundBox=function(k$a){var k$b=0,k$c=0,k$d=k$a.min,k$e=k$a.max;k$a.getCorners(k$t._corners);var k$f=this.containsPoints(k$t._corners);if(0!=k$f)return k$f;k$gb.subtract(k$e,k$d,k$t._tempV30),k$gb.scale(k$t._tempV30,.5,k$t._tempV30),k$gb.add(k$d,k$t._tempV30,k$t._tempV30),k$gb.subtract(k$e,k$t._tempV30,k$t._tempV31);var k$g=this.extents.elements,k$h=k$t._tempV31.elements;k$t._getRows(this.transformation,k$t._rows1),this.transformation.invert(k$t._tempM0);for(k$b=0;k$b<3;k$b++)for(k$c=0;k$c<3;k$c++)k$t._tempM1.setElementByRowColumn(k$b,k$c,Math.abs(k$t._tempM0.getElementByRowColumn(k$b,k$c)));this.getCenter(k$t._tempV35),k$gb.subtract(k$t._tempV30,k$t._tempV35,k$t._tempV32);var k$i=k$t._tempV31.elements;k$i[0]=k$gb.dot(k$t._tempV32,k$t._rows1[0]),k$i[1]=k$gb.dot(k$t._tempV32,k$t._rows1[1]),k$i[2]=k$gb.dot(k$t._tempV32,k$t._rows1[2]);var k$j=k$t._tempV33.elements,k$k=k$t._tempV34.elements;for(k$b=0;k$b<3;k$b++)if(k$j[0]=k$t._tempM1.getElementByRowColumn(k$b,0),k$j[1]=k$t._tempM1.getElementByRowColumn(k$b,1),k$j[2]=k$t._tempM1.getElementByRowColumn(k$b,2),k$g[k$b]+k$gb.dot(k$t._tempV31,k$t._tempV33)<Math.abs(k$i[k$b]))return 0;for(k$c=0;k$c<3;k$c++)if(k$j[0]=k$t._tempM1.getElementByRowColumn(0,k$c),k$j[1]=k$t._tempM1.getElementByRowColumn(1,k$c),k$j[2]=k$t._tempM1.getElementByRowColumn(2,k$c),k$k[0]=k$t._tempM0.getElementByRowColumn(0,k$c),k$k[1]=k$t._tempM0.getElementByRowColumn(1,k$c),k$k[2]=k$t._tempM0.getElementByRowColumn(2,k$c),k$gb.dot(this.extents,k$t._tempV33)+k$h[k$c]<Math.abs(k$gb.dot(k$t._tempV31,k$t._tempV34)))return 0;for(k$b=0;k$b<3;k$b++)for(k$c=0;k$c<3;k$c++){var k$l=(k$b+1)%3,k$m=(k$b+2)%3,k$n=(k$c+1)%3,k$o=(k$c+2)%3;if(k$g[k$l]*k$t._tempM1.getElementByRowColumn(k$m,k$c)+k$g[k$m]*k$t._tempM1.getElementByRowColumn(k$l,k$c)+(k$h[k$n]*k$t._tempM1.getElementByRowColumn(k$b,k$o)+k$h[k$o]*k$t._tempM1.getElementByRowColumn(k$b,k$n))<Math.abs(k$i[k$m]*k$t._tempM0.getElementByRowColumn(k$l,k$c)-k$i[k$l]*k$t._tempM0.getElementByRowColumn(k$m,k$c)))return 0}return 2},k$a.intersectsRay=function(k$a,k$b){k$gb.scale(this.extents,-1,k$t._tempV30),this.transformation.invert(k$t._tempM0),k$gb.TransformNormal(k$a.direction,k$t._tempM0,k$t._ray.direction),k$gb.transformCoordinate(k$a.origin,k$t._tempM0,k$t._ray.origin),k$t._boxBound1.min=k$t._tempV30,k$t._boxBound1.max=this.extents;var k$c=Collision.intersectsRayAndBoxRP(k$t._ray,k$t._boxBound1,k$b);return-1!==k$c&&k$gb.transformCoordinate(k$b,this.transformation,k$b),k$c},k$a._getLocalCorners=function(k$a){k$a.length=8;var k$b=this.extents.elements;k$t._tempV30.x=k$b[0],k$t._tempV31.y=k$b[1],k$t._tempV32.z=k$b[2],k$gb.add(k$t._tempV30,k$t._tempV31,k$t._tempV33),k$gb.add(k$t._tempV33,k$t._tempV32,k$a[0]),k$gb.add(k$t._tempV30,k$t._tempV31,k$t._tempV33),k$gb.subtract(k$t._tempV33,k$t._tempV32,k$a[1]),k$gb.subtract(k$t._tempV31,k$t._tempV30,k$t._tempV33),k$gb.subtract(k$t._tempV33,k$t._tempV30,k$a[2]),k$gb.subtract(k$t._tempV31,k$t._tempV30,k$t._tempV33),k$gb.add(k$t._tempV33,k$t._tempV32,k$a[3]),k$gb.subtract(k$t._tempV30,k$t._tempV31,k$t._tempV33),k$gb.add(k$t._tempV33,k$t._tempV32,k$a[4]),k$gb.subtract(k$t._tempV30,k$t._tempV31,k$t._tempV33),k$gb.subtract(k$t._tempV33,k$t._tempV32,k$a[5]),k$gb.scale(k$a[0],-1,k$a[6]),k$gb.subtract(k$t._tempV32,k$t._tempV30,k$t._tempV33),k$gb.subtract(k$t._tempV33,k$t._tempV31,k$a[7])},k$a.equals=function(k$a){return this.extents==k$a.extents&&this.transformation==k$a.transformation},k$a.cloneTo=function(k$a){var k$b=k$a;this.extents.cloneTo(k$b.extents),this.transformation.cloneTo(k$b.transformation)},k$t.createByBoundBox=function(k$a,k$b){var k$c=k$a.min,k$d=k$a.max;k$gb.subtract(k$d,k$c,k$t._tempV30),k$gb.scale(k$t._tempV30,.5,k$t._tempV30),k$gb.add(k$c,k$t._tempV30,k$t._tempV31),k$gb.subtract(k$d,k$t._tempV31,k$t._tempV32),k$ab.translation(k$t._tempV31,k$t._tempM0);var k$e=k$t._tempV32.clone(),k$f=k$t._tempM0.clone();k$b.extents=k$e,k$b.transformation=k$f},k$t.createByMinAndMaxVertex=function(k$a,k$b){return k$gb.subtract(k$b,k$a,k$t._tempV30),k$gb.scale(k$t._tempV30,.5,k$t._tempV30),k$gb.add(k$a,k$t._tempV30,k$t._tempV31),k$gb.subtract(k$b,k$t._tempV31,k$t._tempV32),k$ab.translation(k$t._tempV31,k$t._tempM0),new k$t(k$t._tempV32,k$t._tempM0)},k$t._getRows=function(k$a,k$b){k$b.length=3;var k$c=k$a.elements,k$d=k$b[0].elements;k$d[0]=k$c[0],k$d[1]=k$c[1],k$d[2]=k$c[2];var k$e=k$b[1].elements;k$e[0]=k$c[4],k$e[1]=k$c[5],k$e[2]=k$c[6];var k$f=k$b[2].elements;k$f[0]=k$c[8],k$f[1]=k$c[9],k$f[2]=k$c[10]},k$t.getObbtoObbMatrix4x4=function(k$a,k$b,k$c,k$d){var k$e=k$a.transformation,k$f=k$b.transformation;if(k$c){k$t._getRows(k$e,k$t._rows1),k$t._getRows(k$f,k$t._rows2);for(var k$g=0;k$g<3;k$g++)for(var k$h=0;k$h<3;k$h++)k$d.setElementByRowColumn(k$g,k$h,k$gb.dot(k$t._rows2[k$g],k$t._rows1[k$h]));k$b.getCenter(k$t._tempV30),k$a.getCenter(k$t._tempV31),k$gb.subtract(k$t._tempV30,k$t._tempV31,k$t._tempV32);var k$i=k$d.elements;k$i[12]=k$gb.dot(k$t._tempV32,k$t._rows1[0]),k$i[13]=k$gb.dot(k$t._tempV32,k$t._rows1[1]),k$i[14]=k$gb.dot(k$t._tempV32,k$t._rows1[2]),k$i[15]=1}else k$e.invert(k$t._tempM0),k$ab.multiply(k$f,k$t._tempM0,k$d)},k$t.merge=function(k$a,k$b,k$c){var k$d=k$a.extents,k$e=k$a.transformation;k$t.getObbtoObbMatrix4x4(k$a,k$b,k$c,k$t._tempM0),k$b._getLocalCorners(k$t._corners),k$gb.transformCoordinate(k$t._corners[0],k$t._tempM0,k$t._corners[0]),k$gb.transformCoordinate(k$t._corners[1],k$t._tempM0,k$t._corners[1]),k$gb.transformCoordinate(k$t._corners[2],k$t._tempM0,k$t._corners[2]),k$gb.transformCoordinate(k$t._corners[3],k$t._tempM0,k$t._corners[3]),k$gb.transformCoordinate(k$t._corners[4],k$t._tempM0,k$t._corners[4]),k$gb.transformCoordinate(k$t._corners[5],k$t._tempM0,k$t._corners[5]),k$gb.transformCoordinate(k$t._corners[6],k$t._tempM0,k$t._corners[6]),k$gb.transformCoordinate(k$t._corners[7],k$t._tempM0,k$t._corners[7]),k$gb.scale(k$d,-1,k$t._boxBound1.min),k$d.cloneTo(k$t._boxBound1.max),k$Za.createfromPoints(k$t._corners,k$t._boxBound2),k$Za.merge(k$t._boxBound2,k$t._boxBound1,k$t._boxBound3);var k$f=k$t._boxBound3.min,k$g=k$t._boxBound3.max;k$gb.subtract(k$g,k$f,k$t._tempV30),k$gb.scale(k$t._tempV30,.5,k$t._tempV30),k$gb.add(k$f,k$t._tempV30,k$t._tempV32),k$gb.subtract(k$g,k$t._tempV32,k$d),k$gb.transformCoordinate(k$t._tempV32,k$e,k$t._tempV33)},k$l(k$t,["_tempV30",function(){return this._tempV30=new k$gb},"_tempV31",function(){return this._tempV31=new k$gb},"_tempV32",function(){return this._tempV32=new k$gb},"_tempV33",function(){return this._tempV33=new k$gb},"_tempV34",function(){return this._tempV34=new k$gb},"_tempV35",function(){return this._tempV35=new k$gb},"_tempV36",function(){return this._tempV36=new k$gb},"_tempM0",function(){return this._tempM0=new k$ab},"_tempM1",function(){return this._tempM1=new k$ab},"_corners",function(){return this._corners=[new k$gb,new k$gb,new k$gb,new k$gb,new k$gb,new k$gb,new k$gb,new k$gb]},"_rows1",function(){return this._rows1=[new k$gb,new k$gb,new k$gb]},"_rows2",function(){return this._rows2=[new k$gb,new k$gb,new k$gb]},"_ray",function(){return this._ray=new k$eb(new k$gb,new k$gb)},"_boxBound1",function(){return this._boxBound1=new k$Za(new k$gb,new k$gb)},"_boxBound2",function(){return this._boxBound2=new k$Za(new k$gb,new k$gb)},"_boxBound3",function(){return this._boxBound3=new k$Za(new k$gb,new k$gb)}])}(),function(){function k$x(k$a,k$b){this.normal=null,this.distance=NaN,void 0===k$b&&(k$b=0),this.normal=k$a,this.distance=k$b}return k$n(k$x,"laya.d3.math.Plane"),k$x.prototype.normalize=function(){var k$a=this.normal.elements,k$b=k$a[0],k$c=k$a[1],k$d=k$a[2],k$e=1/Math.sqrt(k$b*k$b+k$c*k$c+k$d*k$d);k$a[0]=k$b*k$e,k$a[1]=k$c*k$e,k$a[2]=k$d*k$e,this.distance*=k$e},k$x.createPlaneBy3P=function(k$a,k$b,k$c){var k$d=k$a.elements,k$e=k$b.elements,k$f=k$c.elements,k$g=k$e[0]-k$d[0],k$h=k$e[1]-k$d[1],k$i=k$e[2]-k$d[2],k$j=k$f[0]-k$d[0],k$k=k$f[1]-k$d[1],k$l=k$f[2]-k$d[2],k$m=k$h*k$l-k$i*k$k,k$n=k$i*k$j-k$g*k$l,k$o=k$g*k$k-k$h*k$j,k$p=1/Math.sqrt(k$m*k$m+k$n*k$n+k$o*k$o),k$q=k$m*k$p,k$r=k$n*k$p,k$s=k$o*k$p,k$t=k$x._TEMPVec3.elements;k$t[0]=k$q,k$t[1]=k$r,k$t[2]=k$s;var k$w=-(k$q*k$d[0]+k$r*k$d[1]+k$s*k$d[2]);return new k$x(k$x._TEMPVec3,k$w)},k$x.PlaneIntersectionType_Back=0,k$x.PlaneIntersectionType_Front=1,k$x.PlaneIntersectionType_Intersecting=2,k$l(k$x,["_TEMPVec3",function(){return this._TEMPVec3=new k$gb}]),k$x}()),k$cb=function(){function k$e(k$a,k$b,k$c,k$d){this.elements=new Float32Array(4),void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=1),this.elements[0]=k$a,this.elements[1]=k$b,this.elements[2]=k$c,this.elements[3]=k$d}k$n(k$e,"laya.d3.math.Quaternion");var k$a=k$e.prototype;return k$x.imps(k$a,{"laya.d3.core.IClone":!0}),k$a.scaling=function(k$a,k$b){var k$c=k$b.elements,k$d=this.elements;k$c[0]=k$d[0]*k$a,k$c[1]=k$d[1]*k$a,k$c[2]=k$d[2]*k$a,k$c[3]=k$d[3]*k$a},k$a.normalize=function(k$a){var k$b=k$a.elements,k$c=this.elements,k$d=k$c[0],k$e=k$c[1],k$f=k$c[2],k$g=k$c[3],k$h=k$d*k$d+k$e*k$e+k$f*k$f+k$g*k$g;0<k$h&&(k$h=1/Math.sqrt(k$h),k$b[0]=k$d*k$h,k$b[1]=k$e*k$h,k$b[2]=k$f*k$h,k$b[3]=k$g*k$h)},k$a.length=function(){var k$a=this.elements,k$b=k$a[0],k$c=k$a[1],k$d=k$a[2],k$e=k$a[3];return Math.sqrt(k$b*k$b+k$c*k$c+k$d*k$d+k$e*k$e)},k$a.rotateX=function(k$a,k$b){var k$c=k$b.elements,k$d=this.elements;k$a*=.5;var k$e=k$d[0],k$f=k$d[1],k$g=k$d[2],k$h=k$d[3],k$i=Math.sin(k$a),k$j=Math.cos(k$a);k$c[0]=k$e*k$j+k$h*k$i,k$c[1]=k$f*k$j+k$g*k$i,k$c[2]=k$g*k$j-k$f*k$i,k$c[3]=k$h*k$j-k$e*k$i},k$a.rotateY=function(k$a,k$b){var k$c=k$b.elements,k$d=this.elements;k$a*=.5;var k$e=k$d[0],k$f=k$d[1],k$g=k$d[2],k$h=k$d[3],k$i=Math.sin(k$a),k$j=Math.cos(k$a);k$c[0]=k$e*k$j-k$g*k$i,k$c[1]=k$f*k$j+k$h*k$i,k$c[2]=k$g*k$j+k$e*k$i,k$c[3]=k$h*k$j-k$f*k$i},k$a.rotateZ=function(k$a,k$b){var k$c=k$b.elements,k$d=this.elements;k$a*=.5;var k$e=k$d[0],k$f=k$d[1],k$g=k$d[2],k$h=k$d[3],k$i=Math.sin(k$a),k$j=Math.cos(k$a);k$c[0]=k$e*k$j+k$f*k$i,k$c[1]=k$f*k$j-k$e*k$i,k$c[2]=k$g*k$j+k$h*k$i,k$c[3]=k$h*k$j-k$g*k$i},k$a.getYawPitchRoll=function(k$a){k$gb.transformQuat(k$gb.ForwardRH,this,k$e.TEMPVector31),k$gb.transformQuat(k$gb.Up,this,k$e.TEMPVector32);var k$b=k$e.TEMPVector32.elements;k$e.angleTo(k$gb.ZERO,k$e.TEMPVector31,k$e.TEMPVector33);var k$c=k$e.TEMPVector33.elements;k$c[0]==Math.PI/2?(k$c[1]=k$e.arcTanAngle(k$b[2],k$b[0]),k$c[2]=0):k$c[0]==-Math.PI/2?(k$c[1]=k$e.arcTanAngle(-k$b[2],-k$b[0]),k$c[2]=0):(k$ab.createRotationY(-k$c[1],k$e.TEMPMatrix0),k$ab.createRotationX(-k$c[0],k$e.TEMPMatrix1),k$gb.transformCoordinate(k$e.TEMPVector32,k$e.TEMPMatrix0,k$e.TEMPVector32),k$gb.transformCoordinate(k$e.TEMPVector32,k$e.TEMPMatrix1,k$e.TEMPVector32),k$c[2]=k$e.arcTanAngle(k$b[1],-k$b[0])),k$c[1]<=-Math.PI&&(k$c[1]=Math.PI),k$c[2]<=-Math.PI&&(k$c[2]=Math.PI),k$c[1]>=Math.PI&&k$c[2]>=Math.PI&&(k$c[1]=0,k$c[2]=0,k$c[0]=Math.PI-k$c[0]);var k$d=k$a.elements;k$d[0]=k$c[1],k$d[1]=k$c[0],k$d[2]=k$c[2]},k$a.invert=function(k$a){var k$b=k$a.elements,k$c=this.elements,k$d=k$c[0],k$e=k$c[1],k$f=k$c[2],k$g=k$c[3],k$h=k$d*k$d+k$e*k$e+k$f*k$f+k$g*k$g,k$i=k$h?1/k$h:0;k$b[0]=-k$d*k$i,k$b[1]=-k$e*k$i,k$b[2]=-k$f*k$i,k$b[3]=k$g*k$i},k$a.identity=function(){var k$a=this.elements;k$a[0]=0,k$a[1]=0,k$a[2]=0,k$a[3]=1},k$a.fromArray=function(k$a,k$b){void 0===k$b&&(k$b=0),this.elements[0]=k$a[k$b+0],this.elements[1]=k$a[k$b+1],this.elements[2]=k$a[k$b+2],this.elements[3]=k$a[k$b+3]},k$a.cloneTo=function(k$a){var k$b,k$c,k$d;if((k$c=this.elements)!==(k$d=k$a.elements))for(k$b=0;k$b<4;++k$b)k$d[k$b]=k$c[k$b]},k$a.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$a.equals=function(k$a){var k$b=this.elements,k$c=k$a.elements;return k$ua.nearEqual(k$b[0],k$c[0])&&k$ua.nearEqual(k$b[1],k$c[1])&&k$ua.nearEqual(k$b[2],k$c[2])&&k$ua.nearEqual(k$b[3],k$c[3])},k$a.lengthSquared=function(){var k$a=this.elements[0],k$b=this.elements[1],k$c=this.elements[2],k$d=this.elements[3];return k$a*k$a+k$b*k$b+k$c*k$c+k$d*k$d},k$o(0,k$a,"x",function(){return this.elements[0]}),k$o(0,k$a,"y",function(){return this.elements[1]}),k$o(0,k$a,"z",function(){return this.elements[2]}),k$o(0,k$a,"w",function(){return this.elements[3]}),k$e.createFromYawPitchRoll=function(k$a,k$b,k$c,k$d){var k$e=.5*k$c,k$f=.5*k$b,k$g=.5*k$a,k$h=Math.sin(k$e),k$i=Math.cos(k$e),k$j=Math.sin(k$f),k$k=Math.cos(k$f),k$l=Math.sin(k$g),k$m=Math.cos(k$g),k$n=k$d.elements;k$n[0]=k$m*k$j*k$i+k$l*k$k*k$h,k$n[1]=k$l*k$k*k$i-k$m*k$j*k$h,k$n[2]=k$m*k$k*k$h-k$l*k$j*k$i,k$n[3]=k$m*k$k*k$i+k$l*k$j*k$h},k$e.multiply=function(k$a,k$b,k$c){var k$d=k$a.elements,k$e=k$b.elements,k$f=k$c.elements,k$g=k$d[0],k$h=k$d[1],k$i=k$d[2],k$j=k$d[3],k$k=k$e[0],k$l=k$e[1],k$m=k$e[2],k$n=k$e[3],k$o=k$h*k$m-k$i*k$l,k$p=k$i*k$k-k$g*k$m,k$q=k$g*k$l-k$h*k$k,k$r=k$g*k$k+k$h*k$l+k$i*k$m;k$f[0]=k$g*k$n+k$k*k$j+k$o,k$f[1]=k$h*k$n+k$l*k$j+k$p,k$f[2]=k$i*k$n+k$m*k$j+k$q,k$f[3]=k$j*k$n-k$r},k$e.arcTanAngle=function(k$a,k$b){return 0==k$a?1==k$b?Math.PI/2:-Math.PI/2:0<k$a?Math.atan(k$b/k$a):k$a<0?0<k$b?Math.atan(k$b/k$a)+Math.PI:Math.atan(k$b/k$a)-Math.PI:0},k$e.angleTo=function(k$a,k$b,k$c){k$gb.subtract(k$b,k$a,k$e.TEMPVector30),k$gb.normalize(k$e.TEMPVector30,k$e.TEMPVector30),k$c.elements[0]=Math.asin(k$e.TEMPVector30.y),k$c.elements[1]=k$e.arcTanAngle(-k$e.TEMPVector30.z,-k$e.TEMPVector30.x)},k$e.createFromAxisAngle=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements;k$b*=.5;var k$f=Math.sin(k$b);k$d[0]=k$f*k$e[0],k$d[1]=k$f*k$e[1],k$d[2]=k$f*k$e[2],k$d[3]=Math.cos(k$b)},k$e.createFromMatrix3x3=function(k$a,k$b){var k$c,k$d=k$b.elements,k$e=k$a.elements,k$f=k$e[0]+k$e[4]+k$e[8];if(0<k$f)k$c=Math.sqrt(k$f+1),k$d[3]=.5*k$c,k$c=.5/k$c,k$d[0]=(k$e[5]-k$e[7])*k$c,k$d[1]=(k$e[6]-k$e[2])*k$c,k$d[2]=(k$e[1]-k$e[3])*k$c;else{var k$g=0;k$e[4]>k$e[0]&&(k$g=1),k$e[8]>k$e[3*k$g+k$g]&&(k$g=2);var k$h=(k$g+1)%3,k$i=(k$g+2)%3;k$c=Math.sqrt(k$e[3*k$g+k$g]-k$e[3*k$h+k$h]-k$e[3*k$i+k$i]+1),k$d[k$g]=.5*k$c,k$c=.5/k$c,k$d[3]=(k$e[3*k$h+k$i]-k$e[3*k$i+k$h])*k$c,k$d[k$h]=(k$e[3*k$h+k$g]+k$e[3*k$g+k$h])*k$c,k$d[k$i]=(k$e[3*k$i+k$g]+k$e[3*k$g+k$i])*k$c}},k$e.createFromMatrix4x4=function(k$a,k$b){var k$c,k$d,k$e=k$a.elements,k$f=k$b.elements,k$g=k$e[0]+k$e[5]+k$e[10];0<k$g?(k$c=Math.sqrt(k$g+1),k$f[3]=.5*k$c,k$c=.5/k$c,k$f[0]=(k$e[6]-k$e[9])*k$c,k$f[1]=(k$e[8]-k$e[2])*k$c,k$f[2]=(k$e[1]-k$e[4])*k$c):k$e[0]>=k$e[5]&&k$e[0]>=k$e[10]?(k$d=.5/(k$c=Math.sqrt(1+k$e[0]-k$e[5]-k$e[10])),k$f[0]=.5*k$c,k$f[1]=(k$e[1]+k$e[4])*k$d,k$f[2]=(k$e[2]+k$e[8])*k$d,k$f[3]=(k$e[6]-k$e[9])*k$d):k$e[5]>k$e[10]?(k$d=.5/(k$c=Math.sqrt(1+k$e[5]-k$e[0]-k$e[10])),k$f[0]=(k$e[4]+k$e[1])*k$d,k$f[1]=.5*k$c,k$f[2]=(k$e[9]+k$e[6])*k$d,k$f[3]=(k$e[8]-k$e[2])*k$d):(k$d=.5/(k$c=Math.sqrt(1+k$e[10]-k$e[0]-k$e[5])),k$f[0]=(k$e[8]+k$e[2])*k$d,k$f[1]=(k$e[9]+k$e[6])*k$d,k$f[2]=.5*k$c,k$f[3]=(k$e[1]-k$e[4])*k$d)},k$e.slerp=function(k$a,k$b,k$c,k$d){var k$e,k$f,k$g,k$h,k$i,k$j=k$a.elements,k$k=k$b.elements,k$l=k$d.elements,k$m=k$j[0],k$n=k$j[1],k$o=k$j[2],k$p=k$j[3],k$q=k$k[0],k$r=k$k[1],k$s=k$k[2],k$t=k$k[3];return(k$f=k$m*k$q+k$n*k$r+k$o*k$s+k$p*k$t)<0&&(k$f=-k$f,k$q=-k$q,k$r=-k$r,k$s=-k$s,k$t=-k$t),k$i=1e-6<1-k$f?(k$e=Math.acos(k$f),k$g=Math.sin(k$e),k$h=Math.sin((1-k$c)*k$e)/k$g,Math.sin(k$c*k$e)/k$g):(k$h=1-k$c,k$c),k$l[0]=k$h*k$m+k$i*k$q,k$l[1]=k$h*k$n+k$i*k$r,k$l[2]=k$h*k$o+k$i*k$s,k$l[3]=k$h*k$p+k$i*k$t,k$l},k$e.lerp=function(k$a,k$b,k$c,k$d){var k$e=k$d.elements,k$f=k$a.elements,k$g=k$b.elements,k$h=k$f[0],k$i=k$f[1],k$j=k$f[2],k$k=k$f[3];k$e[0]=k$h+k$c*(k$g[0]-k$h),k$e[1]=k$i+k$c*(k$g[1]-k$i),k$e[2]=k$j+k$c*(k$g[2]-k$j),k$e[3]=k$k+k$c*(k$g[3]-k$k)},k$e.add=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements;k$d[0]=k$e[0]+k$f[0],k$d[1]=k$e[1]+k$f[1],k$d[2]=k$e[2]+k$f[2],k$d[3]=k$e[3]+k$f[3]},k$e.dot=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements;return k$c[0]*k$d[0]+k$c[1]*k$d[1]+k$c[2]*k$d[2]+k$c[3]*k$d[3]},k$e.rotationLookAt=function(k$a,k$b,k$c){k$e.lookAt(k$gb.ZERO,k$a,k$b,k$c)},k$e.lookAt=function(k$a,k$b,k$c,k$d){k$va.lookAt(k$a,k$b,k$c,k$e._tempMatrix3x3),k$e.rotationMatrix(k$e._tempMatrix3x3,k$d)},k$e.invert=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements,k$e=k$a.lengthSquared();k$ua.isZero(k$e)||(k$e=1/k$e,k$d[0]=-k$c[0]*k$e,k$d[1]=-k$c[1]*k$e,k$d[2]=-k$c[2]*k$e,k$d[3]=k$c[3]*k$e)},k$e.rotationMatrix=function(k$a,k$b){var k$c=k$a.elements,k$d=k$c[0],k$e=k$c[1],k$f=k$c[2],k$g=k$c[3],k$h=k$c[4],k$i=k$c[5],k$j=k$c[6],k$k=k$c[7],k$l=k$c[8],k$m=k$b.elements,k$n=NaN,k$o=NaN,k$p=k$d+k$h+k$l;0<k$p?(k$n=Math.sqrt(k$p+1),k$m[3]=.5*k$n,k$n=.5/k$n,k$m[0]=(k$i-k$k)*k$n,k$m[1]=(k$j-k$f)*k$n,k$m[2]=(k$e-k$g)*k$n):k$h<=k$d&&k$l<=k$d?(k$o=.5/(k$n=Math.sqrt(1+k$d-k$h-k$l)),k$m[0]=.5*k$n,k$m[1]=(k$e+k$g)*k$o,k$m[2]=(k$f+k$j)*k$o,k$m[3]=(k$i-k$k)*k$o):k$l<k$h?(k$o=.5/(k$n=Math.sqrt(1+k$h-k$d-k$l)),k$m[0]=(k$g+k$e)*k$o,k$m[1]=.5*k$n,k$m[2]=(k$k+k$i)*k$o,k$m[3]=(k$j-k$f)*k$o):(k$o=.5/(k$n=Math.sqrt(1+k$l-k$d-k$h)),k$m[0]=(k$j+k$f)*k$o,k$m[1]=(k$k+k$i)*k$o,k$m[2]=.5*k$n,k$m[3]=(k$e-k$g)*k$o)},k$e.DEFAULT=new k$e,k$l(k$e,["TEMPVector30",function(){return this.TEMPVector30=new k$gb},"TEMPVector31",function(){return this.TEMPVector31=new k$gb},"TEMPVector32",function(){return this.TEMPVector32=new k$gb},"TEMPVector33",function(){return this.TEMPVector33=new k$gb},"TEMPMatrix0",function(){return this.TEMPMatrix0=new k$ab},"TEMPMatrix1",function(){return this.TEMPMatrix1=new k$ab},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new k$va},"NAN",function(){return this.NAN=new k$e(NaN,NaN,NaN,NaN)}]),k$e}(),k$db=function(){function k$a(k$a){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=k$a,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}k$n(k$a,"laya.d3.math.Rand");var k$b=k$a.prototype;return k$b.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},k$b.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},k$b.getSignedFloat=function(){return 2*this.getFloat()-1},k$o(0,k$b,"seed",function(){return this.seeds[0]},function(k$a){this.seeds[0]=k$a,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),k$a.getFloatFromInt=function(k$a){return 1/8388607*(8388607&k$a)},k$a.getByteFromInt=function(k$a){return(8388607&k$a)>>>15},k$a}(),k$eb=(function(){function k$e(k$a){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(k$a instanceof Array)||4!==k$a.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|k$a[0],this._state0L=0|k$a[1],this._state1U=0|k$a[2],this._state1L=0|k$a[3]}k$n(k$e,"laya.d3.math.RandX");var k$a=k$e.prototype;k$a.randomint=function(){var k$a=this._state0U,k$b=this._state0L,k$c=this._state1U,k$d=this._state1L,k$e=(k$d>>>0)+(k$b>>>0),k$f=k$c+k$a+(k$e/2>>>31)>>>0,k$g=k$e>>>0,k$h=0,k$i=0;k$h=(k$a^=k$h=k$a<<23|(-512&k$b)>>>9)^(this._state0U=k$c),k$i=(k$b^=k$i=k$b<<23)^(this._state0L=k$d);k$h^=k$a>>>18,k$i^=k$b>>>18|(262143&k$a)<<14;return k$h^=k$c>>>5,k$i^=k$d>>>5|(31&k$c)<<27,this._state1U=k$h,this._state1L=k$i,[k$f,k$g]},k$a.random=function(){var k$a=this.randomint(),k$b=k$a[0],k$c=1023<<20|k$b>>>12,k$d=0|(k$a[1]>>>12|(4095&k$b)<<20);return k$e._CONVERTION_BUFFER.setUint32(0,k$c,!1),k$e._CONVERTION_BUFFER.setUint32(4,k$d,!1),k$db._CONVERTION_BUFFER.getFloat64(0,!1)-1},k$l(k$e,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new k$db([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function k$a(k$a,k$b){this.origin=null,this.direction=null,this.origin=k$a,this.direction=k$b}return k$n(k$a,"laya.d3.math.Ray"),k$a}()),k$fb=function(){function k$a(k$a,k$b){this.elements=new Float32Array(2),void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0);var k$c=this.elements;k$c[0]=k$a,k$c[1]=k$b}k$n(k$a,"laya.d3.math.Vector2");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b.fromArray=function(k$a,k$b){void 0===k$b&&(k$b=0),this.elements[0]=k$a[k$b+0],this.elements[1]=k$a[k$b+1]},k$b.cloneTo=function(k$a){var k$b=k$a.elements,k$c=this.elements;k$b[0]=k$c[0],k$b[1]=k$c[1]},k$b.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$b,"x",function(){return this.elements[0]},function(k$a){this.elements[0]=k$a}),k$o(0,k$b,"y",function(){return this.elements[1]},function(k$a){this.elements[1]=k$a}),k$a.scale=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements;k$d[0]=k$e[0]*k$b,k$d[1]=k$e[1]*k$b},k$l(k$a,["ZERO",function(){return this.ZERO=new k$a(0,0)},"ONE",function(){return this.ONE=new k$a(1,1)}]),k$a}(),k$gb=function(){function k$k(k$a,k$b,k$c){this.elements=new Float32Array(3),void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0);var k$d=this.elements;k$d[0]=k$a,k$d[1]=k$b,k$d[2]=k$c}k$n(k$k,"laya.d3.math.Vector3");var k$a=k$k.prototype;return k$x.imps(k$a,{"laya.d3.core.IClone":!0}),k$a.fromArray=function(k$a,k$b){void 0===k$b&&(k$b=0),this.elements[0]=k$a[k$b+0],this.elements[1]=k$a[k$b+1],this.elements[2]=k$a[k$b+2]},k$a.cloneTo=function(k$a){var k$b=k$a.elements,k$c=this.elements;k$b[0]=k$c[0],k$b[1]=k$c[1],k$b[2]=k$c[2]},k$a.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$a.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},k$a.reset=function(k$a,k$b,k$c){this.elements[0]=k$a,this.elements[1]=k$b,this.elements[2]=k$c},k$o(0,k$a,"x",function(){return this.elements[0]},function(k$a){this.elements[0]=k$a}),k$o(0,k$a,"y",function(){return this.elements[1]},function(k$a){this.elements[1]=k$a}),k$o(0,k$a,"z",function(){return this.elements[2]},function(k$a){this.elements[2]=k$a}),k$k.distanceSquared=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements,k$e=k$c[0]-k$d[0],k$f=k$c[1]-k$d[1],k$g=k$c[2]-k$d[2];return k$e*k$e+k$f*k$f+k$g*k$g},k$k.distance=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements,k$e=k$c[0]-k$d[0],k$f=k$c[1]-k$d[1],k$g=k$c[2]-k$d[2];return Math.sqrt(k$e*k$e+k$f*k$f+k$g*k$g)},k$k.min=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements;k$d[0]=Math.min(k$e[0],k$f[0]),k$d[1]=Math.min(k$e[1],k$f[1]),k$d[2]=Math.min(k$e[2],k$f[2])},k$k.max=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements;k$d[0]=Math.max(k$e[0],k$f[0]),k$d[1]=Math.max(k$e[1],k$f[1]),k$d[2]=Math.max(k$e[2],k$f[2])},k$k.transformQuat=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements,k$g=k$e[0],k$h=k$e[1],k$i=k$e[2],k$j=k$f[0],k$k=k$f[1],k$l=k$f[2],k$m=k$f[3],k$n=k$m*k$g+k$k*k$i-k$l*k$h,k$o=k$m*k$h+k$l*k$g-k$j*k$i,k$p=k$m*k$i+k$j*k$h-k$k*k$g,k$q=-k$j*k$g-k$k*k$h-k$l*k$i;k$d[0]=k$n*k$m+k$q*-k$j+k$o*-k$l-k$p*-k$k,k$d[1]=k$o*k$m+k$q*-k$k+k$p*-k$j-k$n*-k$l,k$d[2]=k$p*k$m+k$q*-k$l+k$n*-k$k-k$o*-k$j},k$k.scalarLength=function(k$a){var k$b=k$a.elements,k$c=k$b[0],k$d=k$b[1],k$e=k$b[2];return Math.sqrt(k$c*k$c+k$d*k$d+k$e*k$e)},k$k.scalarLengthSquared=function(k$a){var k$b=k$a.elements,k$c=k$b[0],k$d=k$b[1],k$e=k$b[2];return k$c*k$c+k$d*k$d+k$e*k$e},k$k.normalize=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements,k$e=k$c[0],k$f=k$c[1],k$g=k$c[2],k$h=k$e*k$e+k$f*k$f+k$g*k$g;0<k$h&&(k$h=1/Math.sqrt(k$h),k$d[0]=k$c[0]*k$h,k$d[1]=k$c[1]*k$h,k$d[2]=k$c[2]*k$h)},k$k.multiply=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements;k$d[0]=k$e[0]*k$f[0],k$d[1]=k$e[1]*k$f[1],k$d[2]=k$e[2]*k$f[2]},k$k.scale=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements;k$d[0]=k$e[0]*k$b,k$d[1]=k$e[1]*k$b,k$d[2]=k$e[2]*k$b},k$k.lerp=function(k$a,k$b,k$c,k$d){var k$e=k$d.elements,k$f=k$a.elements,k$g=k$b.elements,k$h=k$f[0],k$i=k$f[1],k$j=k$f[2];k$e[0]=k$h+k$c*(k$g[0]-k$h),k$e[1]=k$i+k$c*(k$g[1]-k$i),k$e[2]=k$j+k$c*(k$g[2]-k$j)},k$k.transformV3ToV3=function(k$a,k$b,k$c){var k$d=k$k._tempVector4;k$k.transformV3ToV4(k$a,k$b,k$d);var k$e=k$d.elements,k$f=k$c.elements;k$f[0]=k$e[0],k$f[1]=k$e[1],k$f[2]=k$e[2]},k$k.transformV3ToV4=function(k$a,k$b,k$c){var k$d=k$a.elements,k$e=k$d[0],k$f=k$d[1],k$g=k$d[2],k$h=k$b.elements,k$i=k$c.elements;k$i[0]=k$e*k$h[0]+k$f*k$h[4]+k$g*k$h[8]+k$h[12],k$i[1]=k$e*k$h[1]+k$f*k$h[5]+k$g*k$h[9]+k$h[13],k$i[2]=k$e*k$h[2]+k$f*k$h[6]+k$g*k$h[10]+k$h[14],k$i[3]=k$e*k$h[3]+k$f*k$h[7]+k$g*k$h[11]+k$h[15]},k$k.TransformNormal=function(k$a,k$b,k$c){var k$d=k$a.elements,k$e=k$d[0],k$f=k$d[1],k$g=k$d[2],k$h=k$b.elements,k$i=k$c.elements;k$i[0]=k$e*k$h[0]+k$f*k$h[4]+k$g*k$h[8],k$i[1]=k$e*k$h[1]+k$f*k$h[5]+k$g*k$h[9],k$i[2]=k$e*k$h[2]+k$f*k$h[6]+k$g*k$h[10]},k$k.transformCoordinate=function(k$a,k$b,k$c){var k$d=k$k._tempVector4.elements,k$e=k$a.elements,k$f=k$e[0],k$g=k$e[1],k$h=k$e[2],k$i=k$b.elements;k$d[0]=k$f*k$i[0]+k$g*k$i[4]+k$h*k$i[8]+k$i[12],k$d[1]=k$f*k$i[1]+k$g*k$i[5]+k$h*k$i[9]+k$i[13],k$d[2]=k$f*k$i[2]+k$g*k$i[6]+k$h*k$i[10]+k$i[14],k$d[3]=1/(k$f*k$i[3]+k$g*k$i[7]+k$h*k$i[11]+k$i[15]);var k$j=k$c.elements;k$j[0]=k$d[0]*k$d[3],k$j[1]=k$d[1]*k$d[3],k$j[2]=k$d[2]*k$d[3]},k$k.Clamp=function(k$a,k$b,k$c,k$d){var k$e=k$a.elements,k$f=k$e[0],k$g=k$e[1],k$h=k$e[2],k$i=k$b.elements,k$j=k$i[0],k$k=k$i[1],k$l=k$i[2],k$m=k$c.elements,k$n=k$m[0],k$o=k$m[1],k$p=k$m[2],k$q=k$d.elements;k$f=(k$f=k$n<k$f?k$n:k$f)<k$j?k$j:k$f,k$g=(k$g=k$o<k$g?k$o:k$g)<k$k?k$k:k$g,k$h=(k$h=k$p<k$h?k$p:k$h)<k$l?k$l:k$h,k$q[0]=k$f,k$q[1]=k$g,k$q[2]=k$h},k$k.add=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements;k$d[0]=k$e[0]+k$f[0],k$d[1]=k$e[1]+k$f[1],k$d[2]=k$e[2]+k$f[2]},k$k.subtract=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements;k$d[0]=k$e[0]-k$f[0],k$d[1]=k$e[1]-k$f[1],k$d[2]=k$e[2]-k$f[2]},k$k.cross=function(k$a,k$b,k$c){var k$d=k$a.elements,k$e=k$b.elements,k$f=k$c.elements,k$g=k$d[0],k$h=k$d[1],k$i=k$d[2],k$j=k$e[0],k$k=k$e[1],k$l=k$e[2];k$f[0]=k$h*k$l-k$i*k$k,k$f[1]=k$i*k$j-k$g*k$l,k$f[2]=k$g*k$k-k$h*k$j},k$k.dot=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements;return k$c[0]*k$d[0]+k$c[1]*k$d[1]+k$c[2]*k$d[2]},k$k.equals=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements;return k$ua.nearEqual(Math.abs(k$c[0]),Math.abs(k$d[0]))&&k$ua.nearEqual(Math.abs(k$c[1]),Math.abs(k$d[1]))&&k$ua.nearEqual(Math.abs(k$c[2]),Math.abs(k$d[2]))},k$k.ZERO=new k$k(0,0,0),k$k.ONE=new k$k(1,1,1),k$k.NegativeUnitX=new k$k(-1,0,0),k$k.UnitX=new k$k(1,0,0),k$k.UnitY=new k$k(0,1,0),k$k.UnitZ=new k$k(0,0,1),k$k.ForwardRH=new k$k(0,0,-1),k$k.ForwardLH=new k$k(0,0,1),k$k.Up=new k$k(0,1,0),k$k.NAN=new k$k(NaN,NaN,NaN),k$l(k$k,["_tempVector4",function(){return this._tempVector4=new k$hb}]),k$k}(),k$hb=function(){function k$a(k$a,k$b,k$c,k$d){this.elements=new Float32Array(4),void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=0);var k$e=this.elements;k$e[0]=k$a,k$e[1]=k$b,k$e[2]=k$c,k$e[3]=k$d}k$n(k$a,"laya.d3.math.Vector4");var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b.fromArray=function(k$a,k$b){void 0===k$b&&(k$b=0),this.elements[0]=k$a[k$b+0],this.elements[1]=k$a[k$b+1],this.elements[2]=k$a[k$b+2],this.elements[3]=k$a[k$b+3]},k$b.cloneTo=function(k$a){var k$b=k$a.elements,k$c=this.elements;k$b[0]=k$c[0],k$b[1]=k$c[1],k$b[2]=k$c[2],k$b[3]=k$c[3]},k$b.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$b.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},k$b.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},k$o(0,k$b,"x",function(){return this.elements[0]},function(k$a){this.elements[0]=k$a}),k$o(0,k$b,"y",function(){return this.elements[1]},function(k$a){this.elements[1]=k$a}),k$o(0,k$b,"z",function(){return this.elements[2]},function(k$a){this.elements[2]=k$a}),k$o(0,k$b,"w",function(){return this.elements[3]},function(k$a){this.elements[3]=k$a}),k$a.lerp=function(k$a,k$b,k$c,k$d){var k$e=k$d.elements,k$f=k$a.elements,k$g=k$b.elements,k$h=k$f[0],k$i=k$f[1],k$j=k$f[2],k$k=k$f[3];k$e[0]=k$h+k$c*(k$g[0]-k$h),k$e[1]=k$i+k$c*(k$g[1]-k$i),k$e[2]=k$j+k$c*(k$g[2]-k$j),k$e[3]=k$k+k$c*(k$g[3]-k$k)},k$a.transformByM4x4=function(k$a,k$b,k$c){var k$d=k$a.elements,k$e=k$d[0],k$f=k$d[1],k$g=k$d[2],k$h=k$d[3],k$i=k$b.elements,k$j=k$c.elements;k$j[0]=k$e*k$i[0]+k$f*k$i[4]+k$g*k$i[8]+k$h*k$i[12],k$j[1]=k$e*k$i[1]+k$f*k$i[5]+k$g*k$i[9]+k$h*k$i[13],k$j[2]=k$e*k$i[2]+k$f*k$i[6]+k$g*k$i[10]+k$h*k$i[14],k$j[3]=k$e*k$i[3]+k$f*k$i[7]+k$g*k$i[11]+k$h*k$i[15]},k$a.equals=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements;return k$ua.nearEqual(Math.abs(k$c[0]),Math.abs(k$d[0]))&&k$ua.nearEqual(Math.abs(k$c[1]),Math.abs(k$d[1]))&&k$ua.nearEqual(Math.abs(k$c[2]),Math.abs(k$d[2]))&&k$ua.nearEqual(Math.abs(k$c[3]),Math.abs(k$d[3]))},k$a.normalize=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements,k$e=k$a.length();0<k$e&&(k$d[0]=k$c[0]*k$e,k$d[1]=k$c[1]*k$e,k$d[2]=k$c[2]*k$e,k$d[3]=k$c[3]*k$e)},k$a.add=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements;k$d[0]=k$e[0]+k$f[0],k$d[1]=k$e[1]+k$f[1],k$d[2]=k$e[2]+k$f[2],k$d[3]=k$e[3]+k$f[3]},k$a.subtract=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements;k$d[0]=k$e[0]-k$f[0],k$d[1]=k$e[1]-k$f[1],k$d[2]=k$e[2]-k$f[2],k$d[3]=k$e[3]-k$f[3]},k$a.multiply=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements;k$d[0]=k$e[0]*k$f[0],k$d[1]=k$e[1]*k$f[1],k$d[2]=k$e[2]*k$f[2],k$d[3]=k$e[3]*k$f[3]},k$a.scale=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements;k$d[0]=k$e[0]*k$b,k$d[1]=k$e[1]*k$b,k$d[2]=k$e[2]*k$b,k$d[3]=k$e[3]*k$b},k$a.Clamp=function(k$a,k$b,k$c,k$d){var k$e=k$a.elements,k$f=k$e[0],k$g=k$e[1],k$h=k$e[2],k$i=k$e[3],k$j=k$b.elements,k$k=k$j[0],k$l=k$j[1],k$m=k$j[2],k$n=k$j[3],k$o=k$c.elements,k$p=k$o[0],k$q=k$o[1],k$r=k$o[2],k$s=k$o[3],k$t=k$d.elements;k$f=(k$f=k$p<k$f?k$p:k$f)<k$k?k$k:k$f,k$g=(k$g=k$q<k$g?k$q:k$g)<k$l?k$l:k$g,k$h=(k$h=k$r<k$h?k$r:k$h)<k$m?k$m:k$h,k$i=(k$i=k$s<k$i?k$s:k$i)<k$n?k$n:k$i,k$t[0]=k$f,k$t[1]=k$g,k$t[2]=k$h,k$t[3]=k$i},k$a.distanceSquared=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements,k$e=k$c[0]-k$d[0],k$f=k$c[1]-k$d[1],k$g=k$c[2]-k$d[2],k$h=k$c[3]-k$d[3];return k$e*k$e+k$f*k$f+k$g*k$g+k$h*k$h},k$a.distance=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements,k$e=k$c[0]-k$d[0],k$f=k$c[1]-k$d[1],k$g=k$c[2]-k$d[2],k$h=k$c[3]-k$d[3];return Math.sqrt(k$e*k$e+k$f*k$f+k$g*k$g+k$h*k$h)},k$a.dot=function(k$a,k$b){var k$c=k$a.elements,k$d=k$b.elements;return k$c[0]*k$d[0]+k$c[1]*k$d[1]+k$c[2]*k$d[2]+k$c[3]*k$d[3]},k$a.min=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements;k$d[0]=Math.min(k$e[0],k$f[0]),k$d[1]=Math.min(k$e[1],k$f[1]),k$d[2]=Math.min(k$e[2],k$f[2]),k$d[3]=Math.min(k$e[3],k$f[3])},k$a.max=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b.elements;k$d[0]=Math.max(k$e[0],k$f[0]),k$d[1]=Math.max(k$e[1],k$f[1]),k$d[2]=Math.max(k$e[2],k$f[2]),k$d[3]=Math.max(k$e[3],k$f[3])},k$l(k$a,["ZERO",function(){return this.ZERO=new k$a},"ONE",function(){return this.ONE=new k$a(1,1,1,1)},"UnitX",function(){return this.UnitX=new k$a(1,0,0,0)},"UnitY",function(){return this.UnitY=new k$a(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new k$a(0,0,1,0)},"UnitW",function(){return this.UnitW=new k$a(0,0,0,1)}]),k$a}(),k$ib=function(){function k$f(k$a,k$b,k$c,k$d){this.minDepth=0,this.maxDepth=1,this.x=k$a,this.y=k$b,this.width=k$c,this.height=k$d}k$n(k$f,"laya.d3.math.Viewport");var k$a=k$f.prototype;return k$a.project=function(k$a,k$b,k$c){k$gb.transformV3ToV3(k$a,k$b,k$c);var k$d=k$a.elements,k$e=k$b.elements,k$f=k$c.elements,k$g=k$d[0]*k$e[3]+k$d[1]*k$e[7]+k$d[2]*k$e[11]+k$e[15];1!==k$g&&(k$f[0]=k$f[0]/k$g,k$f[1]=k$f[1]/k$g,k$f[2]=k$f[2]/k$g),k$f[0]=.5*(k$f[0]+1)*this.width+this.x,k$f[1]=.5*(1-k$f[1])*this.height+this.y,k$f[2]=k$f[2]*(this.maxDepth-this.minDepth)+this.minDepth},k$a.unprojectFromMat=function(k$a,k$b,k$c){var k$d=k$a.elements,k$e=k$b.elements,k$f=k$c.elements;k$f[0]=(k$d[0]-this.x)/this.width*2-1,k$f[1]=-((k$d[1]-this.y)/this.height*2-1);var k$g=(this.maxDepth-this.minDepth)/2;k$f[2]=(k$d[2]-this.minDepth-k$g)/k$g;var k$h=k$f[0]*k$e[3]+k$f[1]*k$e[7]+k$f[2]*k$e[11]+k$e[15];k$gb.transformV3ToV3(k$c,k$b,k$c),1!==k$h&&(k$f[0]=k$f[0]/k$h,k$f[1]=k$f[1]/k$h,k$f[2]=k$f[2]/k$h)},k$a.unprojectFromWVP=function(k$a,k$b,k$c,k$d,k$e){k$ab.multiply(k$b,k$c,k$f._tempMatrix4x4),k$d&&k$ab.multiply(k$f._tempMatrix4x4,k$d,k$f._tempMatrix4x4),k$f._tempMatrix4x4.invert(k$f._tempMatrix4x4),this.unprojectFromMat(k$a,k$f._tempMatrix4x4,k$e)},k$l(k$f,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new k$ab}]),k$f}(),k$jb=function(){function k$E(k$a){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=k$a,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}k$n(k$E,"laya.d3.resource.models.SubMesh");var k$a=k$E.prototype;return k$x.imps(k$a,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),k$a._getVertexBuffer=function(k$a){return void 0===k$a&&(k$a=0),0===k$a?this._vertexBuffer:null},k$a._getIndexBuffer=function(){return this._indexBuffer},k$a._getStaticBatchBakedVertexs=function(k$a,k$b){var k$c,k$d,k$e=this._vertexBuffer,k$f=k$e.vertexDeclaration,k$g=k$f.getVertexElementByUsage(0).offset/4,k$h=k$f.getVertexElementByUsage(3).offset/4,k$i=k$b.meshRender.lightmapScaleOffset,k$j=0,k$k=0,k$l=0,k$m=0,k$n=0,k$o=0;if(k$i)if(k$d=k$f.getVertexElementByUsage(15))k$l=k$f.vertexStride/4,k$c=0<this._vertexCount?k$e.getData().slice(this._vertexStart*k$l,(this._vertexStart+this._vertexCount)*k$l):k$e.getData().slice(),k$m=k$d.offset/4;else{k$l=(k$o=k$f.vertexStride/4)+2,k$c=this._vertexCount?new Float32Array(this._vertexCount*(k$e.vertexDeclaration.vertexStride/4+2)):new Float32Array(k$e.vertexCount*(k$e.vertexDeclaration.vertexStride/4+2)),k$m=(k$n=k$f.getVertexElementByUsage(2).offset/4)+2;var k$p=k$e.getData();for(k$j=0,k$k=k$p.length/k$o;k$j<k$k;k$j++){var k$q=0;k$q=0<this._vertexCount?(this._vertexStart+k$j)*k$o:k$j*k$o;var k$r=k$j*k$l,k$s=0;for(k$s=0;k$s<k$m;k$s++)k$c[k$r+k$s]=k$p[k$q+k$s];for(k$s=k$m;k$s<k$o;k$s++)k$c[k$r+k$s+2]=k$p[k$q+k$s]}}else k$l=k$f.vertexStride/4,k$c=this._vertexCount?k$e.getData().slice(this._vertexStart*k$l,(this._vertexStart+this._vertexCount)*k$l):k$e.getData().slice();if(k$a){var k$t=k$a.worldMatrix,k$w=k$E._tempMatrix4x40;k$t.invert(k$w);var k$x=k$E._tempMatrix4x41,k$y=k$b.transform.worldMatrix;k$ab.multiply(k$w,k$y,k$x)}else k$x=k$b.transform.worldMatrix;var k$z=k$E._tempQuaternion0;for(k$x.decomposeTransRotScale(k$E._tempVector30,k$z,k$E._tempVector31),k$j=0,k$k=k$c.length/k$l;k$j<k$k;k$j++){var k$A=k$j*k$l+k$g,k$B=k$j*k$l+k$h;if(k$qb.transformVector3ArrayToVector3ArrayCoordinate(k$c,k$A,k$x,k$c,k$A),k$qb.transformVector3ArrayByQuat(k$c,k$B,k$z,k$c,k$B),k$i){var k$C=k$j*k$l+k$m;if(k$d)k$qb.transformLightingMapTexcoordByUV1Array(k$c,k$C,k$i,k$c,k$C);else{var k$D=k$j*k$o+k$n;k$qb.transformLightingMapTexcoordByUV0Array(k$p,k$D,k$i,k$c,k$C)}}}return k$c},k$a._getVertexBuffers=function(){return null},k$a._beforeRender=function(k$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},k$a._render=function(k$a){var k$b,k$c=0,k$d=k$a.renderElement;if(1<this._indexCount){var k$e=this._boneIndicesList.length;if(1<k$e){for(var k$f=0;k$f<k$e;k$f++)(k$b=k$d._skinAnimationDatas||this._skinAnimationDatas)&&(k$d._shaderValue.setValue(0,k$b[k$f]),k$a._shader.uploadRenderElementUniforms(k$d._shaderValue.data)),k$F.mainContext.drawElements(4,this._subIndexBufferCount[k$f],5123,2*this._subIndexBufferStart[k$f]);k$A.drawCall+=k$e}else(k$b=k$d._skinAnimationDatas||this._skinAnimationDatas)&&(k$d._shaderValue.setValue(0,k$b[0]),k$a._shader.uploadRenderElementUniforms(k$d._shaderValue.data)),k$F.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),k$A.drawCall++;k$c=this._indexCount}else k$c=this._indexBuffer.indexCount,(k$b=k$d._skinAnimationDatas||this._skinAnimationDatas)&&(k$d._shaderValue.setValue(0,k$b[0]),k$a._shader.uploadRenderElementUniforms(k$d._shaderValue.data)),k$F.mainContext.drawElements(4,k$c,5123,0),k$A.drawCall++;k$A.trianglesFaces+=k$c/3},k$a.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},k$a.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},k$o(0,k$a,"_vertexBufferCount",function(){return 1}),k$o(0,k$a,"triangleCount",function(){return this._indexBuffer.indexCount/3}),k$l(k$E,["_tempVector30",function(){return this._tempVector30=new k$gb},"_tempVector31",function(){return this._tempVector31=new k$gb},"_tempQuaternion0",function(){return this._tempQuaternion0=new k$cb},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new k$ab},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new k$ab}]),k$E}(),k$kb=function(){function k$a(k$a){this.defineCounter=0,this.defines=null,k$a?(this.defineCounter=k$a.defineCounter,this.defines=k$a.defines.slice()):(this.defineCounter=0,this.defines=[])}return k$n(k$a,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),k$a.prototype.registerDefine=function(k$a){var k$b=Math.pow(2,this.defineCounter++);return this.defines[k$b]=k$a,k$b},k$a}(),k$lb=function(){function k$a(){}return k$n(k$a,"laya.d3.shader.ShaderInit3D"),k$a.__init__=function(){var k$a,k$b;k$Ab._globalRegDefine("HIGHPRECISION",k$Ab.SHADERDEFINE_HIGHPRECISION),k$Ab._globalRegDefine("FOG",k$Ab.SHADERDEFINE_FOG),k$Ab._globalRegDefine("DIRECTIONLIGHT",k$Ab.SHADERDEFINE_DIRECTIONLIGHT),k$Ab._globalRegDefine("POINTLIGHT",k$Ab.SHADERDEFINE_POINTLIGHT),k$Ab._globalRegDefine("SPOTLIGHT",k$Ab.SHADERDEFINE_SPOTLIGHT),k$Ab._globalRegDefine("UV",k$Ab.SHADERDEFINE_UV0),k$Ab._globalRegDefine("COLOR",k$Ab.SHADERDEFINE_COLOR),k$Ab._globalRegDefine("UV1",k$Ab.SHADERDEFINE_UV1),k$Ab._globalRegDefine("CASTSHADOW",k$nb.SHADERDEFINE_CAST_SHADOW),k$Ab._globalRegDefine("SHADOWMAP_PSSM1",k$nb.SHADERDEFINE_SHADOW_PSSM1),k$Ab._globalRegDefine("SHADOWMAP_PSSM2",k$nb.SHADERDEFINE_SHADOW_PSSM2),k$Ab._globalRegDefine("SHADOWMAP_PSSM3",k$nb.SHADERDEFINE_SHADOW_PSSM3),k$Ab._globalRegDefine("SHADOWMAP_PCF_NO",k$nb.SHADERDEFINE_SHADOW_PCF_NO),k$Ab._globalRegDefine("SHADOWMAP_PCF1",k$nb.SHADERDEFINE_SHADOW_PCF1),k$Ab._globalRegDefine("SHADOWMAP_PCF2",k$nb.SHADERDEFINE_SHADOW_PCF2),k$Ab._globalRegDefine("SHADOWMAP_PCF3",k$nb.SHADERDEFINE_SHADOW_PCF3),k$Ab._globalRegDefine("DEPTHFOG",k$Ab.SAHDERDEFINE_DEPTHFOG),k$Lb.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),k$Lb.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),k$a={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},k$b={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var k$c=k$Lb.nameKey.add("SIMPLE");shaderCompile=k$Ab.add(k$c,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',k$a,k$b),k$Mb.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),k$Mb.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),k$Mb.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),k$Mb.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),k$Mb.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),k$Mb.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),k$Mb.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),k$Mb.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),k$Mb.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},k$a}(),k$mb=function(){function k$a(){this._data=null,this._data=[]}k$n(k$a,"laya.d3.shader.ValusArray");var k$b=k$a.prototype;return k$b.setValue=function(k$a,k$b){this._data[k$a]=k$b},k$o(0,k$b,"data",function(){return this._data}),k$a}(),k$nb=function(){function k$a(){}return k$a.SHADERDEFINE_RECEIVE_SHADOW=1,k$a.SHADERDEFINE_CAST_SHADOW=512,k$a.SHADERDEFINE_SHADOW_PSSM1=1024,k$a.SHADERDEFINE_SHADOW_PSSM2=2048,k$a.SHADERDEFINE_SHADOW_PSSM3=4096,k$a.SHADERDEFINE_SHADOW_PCF_NO=8192,k$a.SHADERDEFINE_SHADOW_PCF1=16384,k$a.SHADERDEFINE_SHADOW_PCF2=32768,k$a.SHADERDEFINE_SHADOW_PCF3=65536,k$a.MAX_PSSM_COUNT=3,k$a}(),k$ob=function(){function k$X(){}return k$n(k$X,"laya.d3.utils.Picker"),k$X.calculateCursorRay=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=k$a.elements[0],k$h=k$a.elements[1],k$i=k$X._tempVector30,k$j=k$i.elements;k$j[0]=k$g,k$j[1]=k$h,k$j[2]=k$b.minDepth;var k$k=k$X._tempVector31,k$l=k$k.elements;k$l[0]=k$g,k$l[1]=k$h,k$l[2]=k$b.maxDepth;var k$m=k$f.origin,k$n=k$X._tempVector32;k$b.unprojectFromWVP(k$i,k$c,k$d,k$e,k$m),k$b.unprojectFromWVP(k$k,k$c,k$d,k$e,k$n);var k$o=k$f.direction.elements;k$o[0]=k$n.x-k$m.x,k$o[1]=k$n.y-k$m.y,k$o[2]=k$n.z-k$m.z,k$gb.normalize(k$f.direction,k$f.direction)},k$X.rayIntersectsPositionsAndIndices=function(k$a,k$b,k$c,k$d,k$e){for(var k$f=k$c.vertexStride/4,k$g=k$c.getVertexElementByUsage(0).offset/4,k$h=Number.MAX_VALUE,k$i=-1,k$j=-1,k$k=-1,k$l=0;k$l<k$d.length;k$l+=3){var k$m=k$X._tempVector35,k$n=k$m.elements,k$o=k$d[k$l]*k$f,k$p=k$o+k$g;k$n[0]=k$b[k$p],k$n[1]=k$b[1+k$p],k$n[2]=k$b[2+k$p];var k$q=k$X._tempVector36,k$r=k$q.elements,k$s=k$d[k$l+1]*k$f,k$t=k$s+k$g;k$r[0]=k$b[k$t],k$r[1]=k$b[1+k$t],k$r[2]=k$b[2+k$t];var k$w=k$X._tempVector37,k$x=k$w.elements,k$y=k$d[k$l+2]*k$f,k$z=k$y+k$g;k$x[0]=k$b[k$z],k$x[1]=k$b[1+k$z],k$x[2]=k$b[2+k$z];var k$A=laya.d3.utils.Picker.rayIntersectsTriangle(k$a,k$m,k$q,k$w);!isNaN(k$A)&&k$A<k$h&&(k$h=k$A,k$i=k$o,k$j=k$s,k$k=k$y)}if(k$h===Number.MAX_VALUE)return k$e.position.toDefault(),k$e.distance=Number.MAX_VALUE,k$e.trianglePositions[0].toDefault(),k$e.trianglePositions[1].toDefault(),k$e.trianglePositions[2].toDefault(),k$e.triangleNormals[0].toDefault(),k$e.triangleNormals[1].toDefault(),k$e.triangleNormals[2].toDefault(),!1;k$e.distance=k$h,k$gb.scale(k$a.direction,k$h,k$e.position),k$gb.add(k$a.origin,k$e.position,k$e.position);var k$B=k$e.trianglePositions,k$C=k$B[0],k$D=k$B[1],k$E=k$B[2],k$F=k$C.elements,k$G=k$D.elements,k$H=k$E.elements,k$I=k$i+k$g;k$F[0]=k$b[k$I],k$F[1]=k$b[k$I+1],k$F[2]=k$b[k$I+2];var k$J=k$j+k$g;k$G[0]=k$b[k$J],k$G[1]=k$b[k$J+1],k$G[2]=k$b[k$J+2];var k$K=k$k+k$g;k$H[0]=k$b[k$K],k$H[1]=k$b[k$K+1],k$H[2]=k$b[k$K+2];var k$L=k$c.getVertexElementByUsage(3);if(k$L){var k$M=k$L.offset/4,k$N=k$e.triangleNormals,k$O=k$N[0],k$P=k$N[1],k$Q=k$N[2],k$R=k$O.elements,k$S=k$P.elements,k$T=k$Q.elements,k$U=k$i+k$M;k$R[0]=k$b[k$U],k$R[1]=k$b[k$U+1],k$R[2]=k$b[k$U+2];var k$V=k$j+k$M;k$S[0]=k$b[k$V],k$S[1]=k$b[k$V+1],k$S[2]=k$b[k$V+2];var k$W=k$k+k$M;k$T[0]=k$b[k$W],k$T[1]=k$b[k$W+1],k$T[2]=k$b[k$W+2]}return!0},k$X.rayIntersectsTriangle=function(k$a,k$b,k$c,k$d){var k$e=k$X._tempVector30,k$f=k$X._tempVector31;k$gb.subtract(k$c,k$b,k$e),k$gb.subtract(k$d,k$b,k$f);var k$g,k$h=k$X._tempVector32;if(k$gb.cross(k$a.direction,k$f,k$h),(k$g=k$gb.dot(k$e,k$h))>-Number.MIN_VALUE&&k$g<Number.MIN_VALUE)return Number.NaN;var k$i,k$j=1/k$g,k$k=k$X._tempVector33;if(k$gb.subtract(k$a.origin,k$b,k$k),k$i=k$gb.dot(k$k,k$h),(k$i*=k$j)<0||1<k$i)return Number.NaN;var k$l,k$m,k$n=k$X._tempVector34;return k$gb.cross(k$k,k$e,k$n),k$l=k$gb.dot(k$a.direction,k$n),(k$l*=k$j)<0||1<k$i+k$l?Number.NaN:(k$m=k$gb.dot(k$f,k$n),(k$m*=k$j)<0?Number.NaN:k$m)},k$l(k$X,["_tempVector30",function(){return this._tempVector30=new k$gb},"_tempVector31",function(){return this._tempVector31=new k$gb},"_tempVector32",function(){return this._tempVector32=new k$gb},"_tempVector33",function(){return this._tempVector33=new k$gb},"_tempVector34",function(){return this._tempVector34=new k$gb},"_tempVector35",function(){return this._tempVector35=new k$gb},"_tempVector36",function(){return this._tempVector36=new k$gb},"_tempVector37",function(){return this._tempVector37=new k$gb}]),k$X}(),k$pb=(function(){function k$a(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new k$gb,new k$gb,new k$gb],this.trianglePositions.length=3,this.triangleNormals=[new k$gb,new k$gb,new k$gb],this.triangleNormals.length=3,this.position=new k$gb}k$n(k$a,"laya.d3.utils.RaycastHit"),k$a.prototype.cloneTo=function(k$a){k$a.distance=this.distance,this.trianglePositions[0].cloneTo(k$a.trianglePositions[0]),this.trianglePositions[1].cloneTo(k$a.trianglePositions[1]),this.trianglePositions[2].cloneTo(k$a.trianglePositions[2]),this.triangleNormals[0].cloneTo(k$a.triangleNormals[0]),this.triangleNormals[1].cloneTo(k$a.triangleNormals[1]),this.triangleNormals[2].cloneTo(k$a.triangleNormals[2]),this.position.cloneTo(k$a.position),k$a.sprite3D=this.sprite3D}}(),function(){function k$a(k$a,k$b){this._width=0,this._height=0,this._width=k$a,this._height=k$b}k$n(k$a,"laya.d3.utils.Size");var k$b=k$a.prototype;return k$o(0,k$b,"width",function(){return-1===this._width?k$Y.clientWidth:this._width}),k$o(0,k$b,"height",function(){return-1===this._height?k$Y.clientHeight:this._height}),k$o(1,k$a,"fullScreen",function(){return new k$a(-1,-1)}),k$a}()),k$qb=function(){function k$I(){}return k$n(k$I,"laya.d3.utils.Utils3D"),k$I._rotationTransformScaleSkinAnimation=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$l){var k$m,k$n,k$o,k$p,k$q,k$r=k$I._tempArray16_0,k$s=k$I._tempArray16_1,k$t=k$I._tempArray16_2,k$w=k$d+k$d,k$x=k$e+k$e,k$y=k$f+k$f,k$z=k$d*k$w,k$A=k$e*k$w,k$B=k$e*k$x,k$C=k$f*k$w,k$D=k$f*k$x,k$E=k$f*k$y,k$F=k$g*k$w,k$G=k$g*k$x,k$H=k$g*k$y;for(k$r[15]=1,k$r[0]=1-k$B-k$E,k$r[1]=k$A+k$H,k$r[2]=k$C-k$G,k$r[4]=k$A-k$H,k$r[5]=1-k$z-k$E,k$r[6]=k$D+k$F,k$r[8]=k$C+k$G,k$r[9]=k$D-k$F,k$r[10]=1-k$z-k$B,k$s[15]=1,k$s[0]=k$h,k$s[5]=k$i,k$s[10]=k$j,k$m=0;k$m<4;k$m++)k$n=k$r[k$m],k$o=k$r[k$m+4],k$p=k$r[k$m+8],k$q=k$r[k$m+12],k$t[k$m]=k$n,k$t[k$m+4]=k$o,k$t[k$m+8]=k$p,k$t[k$m+12]=k$n*k$a+k$o*k$b+k$p*k$c+k$q;for(k$m=0;k$m<4;k$m++)k$n=k$t[k$m],k$o=k$t[k$m+4],k$p=k$t[k$m+8],k$q=k$t[k$m+12],k$k[k$m+k$l]=k$n*k$s[0]+k$o*k$s[1]+k$p*k$s[2]+k$q*k$s[3],k$k[k$m+k$l+4]=k$n*k$s[4]+k$o*k$s[5]+k$p*k$s[6]+k$q*k$s[7],k$k[k$m+k$l+8]=k$n*k$s[8]+k$o*k$s[9]+k$p*k$s[10]+k$q*k$s[11],k$k[k$m+k$l+12]=k$n*k$s[12]+k$o*k$s[13]+k$p*k$s[14]+k$q*k$s[15]},k$I._createNodeByJson=function(k$a,k$b,k$c,k$d){if(!k$c)switch(k$b.type){case"Sprite3D":k$c=new k$Kb;break;case"MeshSprite3D":k$c=new k$Xb;break;case"SkinnedMeshSprite3D":k$c=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":k$c=new ShuriKenParticle3D;break;case"TrailSprite3D":k$c=new TrailSprite3D;break;case"Terrain":k$c=new Terrain;break;case"Camera":k$c=new k$Wb;break;case"DirectionLight":k$c=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var k$e=k$b.props;if(k$e)for(var k$f in k$e)k$c[k$f]=k$e[k$f];var k$g=k$b.customProps;k$g&&(k$c instanceof laya.d3.core.Sprite3D?(k$c._parseBaseCustomProps(k$g),k$c._parseCustomProps(k$a,k$d,k$g,k$b),k$c._parseCustomComponent(k$a,k$d,k$b.components)):k$c._parseCustomProps(k$a,k$d,k$g,k$b));var k$h=k$b.child;if(k$h)for(var k$i=0,k$j=k$h.length;k$i<k$j;k$i++){var k$k=k$I._createNodeByJson(k$a,k$h[k$i],null,k$d);k$c.addChild(k$k)}return k$c},k$I._computeBoneAndAnimationDatasByBindPoseMatrxix=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g,k$h,k$i=0,k$j=0,k$k=k$a.length;for(k$g=0;k$g<k$k;k$i+=k$a[k$g].keyframeWidth,k$j+=16,k$g++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(k$b[k$i+0],k$b[k$i+1],k$b[k$i+2],k$b[k$i+3],k$b[k$i+4],k$b[k$i+5],k$b[k$i+6],k$b[k$i+7],k$b[k$i+8],k$b[k$i+9],k$d,k$j),0!=k$g&&(k$h=16*k$a[k$g].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(k$d,k$h,k$d,k$j,k$d,k$j));var k$l=k$c.length;for(k$g=0;k$g<k$l;k$g++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(k$d,16*k$f[k$g],k$c[k$g],k$e,16*k$g)},k$I._computeAnimationDatasByArrayAndMatrixFast=function(k$a,k$b,k$c,k$d){for(var k$e=0,k$f=k$a.length;k$e<k$f;k$e++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(k$b,16*k$d[k$e],k$a[k$e],k$c,16*k$e)},k$I._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(k$a,k$b,k$c,k$d,k$e){var k$f,k$g,k$h=0,k$i=0,k$j=k$a.length;for(k$f=0;k$f<k$j;k$h+=k$a[k$f].keyframeWidth,k$i+=16,k$f++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(k$b[k$h+7],k$b[k$h+8],k$b[k$h+9],k$b[k$h+3],k$b[k$h+4],k$b[k$h+5],k$b[k$h+6],k$b[k$h+0],k$b[k$h+1],k$b[k$h+2],k$d,k$i),0!=k$f&&(k$g=16*k$a[k$f].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(k$d,k$g,k$d,k$i,k$d,k$i));var k$k=k$c.length;for(k$f=0;k$f<k$k;k$f++){var k$l=16*k$f;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(k$d,k$l,k$c[k$f],k$e,k$l)}},k$I._computeAnimationDatasByArrayAndMatrixFastOld=function(k$a,k$b,k$c){for(var k$d=k$a.length,k$e=0;k$e<k$d;k$e++){var k$f=16*k$e;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(k$b,k$f,k$a[k$e],k$c,k$f)}},k$I._computeRootAnimationData=function(k$a,k$b,k$c){for(var k$d=0,k$e=0,k$f=0,k$g=k$a.length;k$d<k$g;k$e+=k$a[k$d].keyframeWidth,k$f+=16,k$d++)laya.d3.utils.Utils3D.createAffineTransformationArray(k$b[k$e+0],k$b[k$e+1],k$b[k$e+2],k$b[k$e+3],k$b[k$e+4],k$b[k$e+5],k$b[k$e+6],k$b[k$e+7],k$b[k$e+8],k$b[k$e+9],k$c,k$f)},k$I.transformVector3ArrayByQuat=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$c.elements,k$g=k$a[k$b],k$h=k$a[k$b+1],k$i=k$a[k$b+2],k$j=k$f[0],k$k=k$f[1],k$l=k$f[2],k$m=k$f[3],k$n=k$m*k$g+k$k*k$i-k$l*k$h,k$o=k$m*k$h+k$l*k$g-k$j*k$i,k$p=k$m*k$i+k$j*k$h-k$k*k$g,k$q=-k$j*k$g-k$k*k$h-k$l*k$i;k$d[k$e]=k$n*k$m+k$q*-k$j+k$o*-k$l-k$p*-k$k,k$d[k$e+1]=k$o*k$m+k$q*-k$k+k$p*-k$j-k$n*-k$l,k$d[k$e+2]=k$p*k$m+k$q*-k$l+k$n*-k$k-k$o*-k$j},k$I.mulMatrixByArray=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g,k$h,k$i,k$j,k$k;if(k$e===k$c){for(k$c=k$I._tempArray16_3,k$g=0;k$g<16;++k$g)k$c[k$g]=k$e[k$f+k$g];k$d=0}for(k$g=0;k$g<4;k$g++)k$h=k$a[k$b+k$g],k$i=k$a[k$b+k$g+4],k$j=k$a[k$b+k$g+8],k$k=k$a[k$b+k$g+12],k$e[k$f+k$g]=k$h*k$c[k$d+0]+k$i*k$c[k$d+1]+k$j*k$c[k$d+2]+k$k*k$c[k$d+3],k$e[k$f+k$g+4]=k$h*k$c[k$d+4]+k$i*k$c[k$d+5]+k$j*k$c[k$d+6]+k$k*k$c[k$d+7],k$e[k$f+k$g+8]=k$h*k$c[k$d+8]+k$i*k$c[k$d+9]+k$j*k$c[k$d+10]+k$k*k$c[k$d+11],k$e[k$f+k$g+12]=k$h*k$c[k$d+12]+k$i*k$c[k$d+13]+k$j*k$c[k$d+14]+k$k*k$c[k$d+15]},k$I.mulMatrixByArrayFast=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g,k$h,k$i,k$j,k$k;for(k$g=0;k$g<4;k$g++)k$h=k$a[k$b+k$g],k$i=k$a[k$b+k$g+4],k$j=k$a[k$b+k$g+8],k$k=k$a[k$b+k$g+12],k$e[k$f+k$g]=k$h*k$c[k$d+0]+k$i*k$c[k$d+1]+k$j*k$c[k$d+2]+k$k*k$c[k$d+3],k$e[k$f+k$g+4]=k$h*k$c[k$d+4]+k$i*k$c[k$d+5]+k$j*k$c[k$d+6]+k$k*k$c[k$d+7],k$e[k$f+k$g+8]=k$h*k$c[k$d+8]+k$i*k$c[k$d+9]+k$j*k$c[k$d+10]+k$k*k$c[k$d+11],k$e[k$f+k$g+12]=k$h*k$c[k$d+12]+k$i*k$c[k$d+13]+k$j*k$c[k$d+14]+k$k*k$c[k$d+15]},k$I.mulMatrixByArrayAndMatrixFast=function(k$a,k$b,k$c,k$d,k$e){var k$f,k$g,k$h,k$i,k$j,k$k=k$c.elements,k$l=k$k[0],k$m=k$k[1],k$n=k$k[2],k$o=k$k[3],k$p=k$k[4],k$q=k$k[5],k$r=k$k[6],k$s=k$k[7],k$t=k$k[8],k$w=k$k[9],k$x=k$k[10],k$y=k$k[11],k$z=k$k[12],k$A=k$k[13],k$B=k$k[14],k$C=k$k[15],k$D=k$b,k$E=k$b+4,k$F=k$b+8,k$G=k$b+12,k$H=k$e,k$I=k$e+4,k$J=k$e+8,k$K=k$e+12;for(k$f=0;k$f<4;k$f++)k$g=k$a[k$D+k$f],k$h=k$a[k$E+k$f],k$i=k$a[k$F+k$f],k$j=k$a[k$G+k$f],k$d[k$H+k$f]=k$g*k$l+k$h*k$m+k$i*k$n+k$j*k$o,k$d[k$I+k$f]=k$g*k$p+k$h*k$q+k$i*k$r+k$j*k$s,k$d[k$J+k$f]=k$g*k$t+k$h*k$w+k$i*k$x+k$j*k$y,k$d[k$K+k$f]=k$g*k$z+k$h*k$A+k$i*k$B+k$j*k$C},k$I.createAffineTransformationArray=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$l){var k$m=k$d+k$d,k$n=k$e+k$e,k$o=k$f+k$f,k$p=k$d*k$m,k$q=k$d*k$n,k$r=k$d*k$o,k$s=k$e*k$n,k$t=k$e*k$o,k$w=k$f*k$o,k$x=k$g*k$m,k$y=k$g*k$n,k$z=k$g*k$o;k$k[k$l+0]=(1-(k$s+k$w))*k$h,k$k[k$l+1]=(k$q+k$z)*k$h,k$k[k$l+2]=(k$r-k$y)*k$h,k$k[k$l+3]=0,k$k[k$l+4]=(k$q-k$z)*k$i,k$k[k$l+5]=(1-(k$p+k$w))*k$i,k$k[k$l+6]=(k$t+k$x)*k$i,k$k[k$l+7]=0,k$k[k$l+8]=(k$r+k$y)*k$j,k$k[k$l+9]=(k$t-k$x)*k$j,k$k[k$l+10]=(1-(k$p+k$s))*k$j,k$k[k$l+11]=0,k$k[k$l+12]=k$a,k$k[k$l+13]=k$b,k$k[k$l+14]=k$c,k$k[k$l+15]=1},k$I.transformVector3ArrayToVector3ArrayCoordinate=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$I._tempArray4_0,k$g=k$a[k$b+0],k$h=k$a[k$b+1],k$i=k$a[k$b+2],k$j=k$c.elements;k$f[0]=k$g*k$j[0]+k$h*k$j[4]+k$i*k$j[8]+k$j[12],k$f[1]=k$g*k$j[1]+k$h*k$j[5]+k$i*k$j[9]+k$j[13],k$f[2]=k$g*k$j[2]+k$h*k$j[6]+k$i*k$j[10]+k$j[14],k$f[3]=1/(k$g*k$j[3]+k$h*k$j[7]+k$i*k$j[11]+k$j[15]),k$d[k$e+0]=k$f[0]*k$f[3],k$d[k$e+1]=k$f[1]*k$f[3],k$d[k$e+2]=k$f[2]*k$f[3]},k$I.transformLightingMapTexcoordByUV0Array=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$c.elements;k$d[k$e+0]=k$a[k$b+0]*k$f[0]+k$f[2],k$d[k$e+1]=(k$a[k$b+1]-1)*k$f[1]+k$f[3]},k$I.transformLightingMapTexcoordByUV1Array=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$c.elements;k$d[k$e+0]=k$a[k$b+0]*k$f[0]+k$f[2],k$d[k$e+1]=1+k$a[k$b+1]*k$f[1]+k$f[3]},k$I.getURLVerion=function(k$a){var k$b=k$a.indexOf("?");return 0<=k$b?k$a.substr(k$b):null},k$I._quaternionCreateFromYawPitchRollArray=function(k$a,k$b,k$c,k$d){var k$e=.5*k$c,k$f=.5*k$b,k$g=.5*k$a,k$h=Math.sin(k$e),k$i=Math.cos(k$e),k$j=Math.sin(k$f),k$k=Math.cos(k$f),k$l=Math.sin(k$g),k$m=Math.cos(k$g);k$d[0]=k$m*k$j*k$i+k$l*k$k*k$h,k$d[1]=k$l*k$k*k$i-k$m*k$j*k$h,k$d[2]=k$m*k$k*k$h-k$l*k$j*k$i,k$d[3]=k$m*k$k*k$i+k$l*k$j*k$h},k$I._createAffineTransformationArray=function(k$a,k$b,k$c,k$d){var k$e=k$b[0],k$f=k$b[1],k$g=k$b[2],k$h=k$b[3],k$i=k$e+k$e,k$j=k$f+k$f,k$k=k$g+k$g,k$l=k$e*k$i,k$m=k$e*k$j,k$n=k$e*k$k,k$o=k$f*k$j,k$p=k$f*k$k,k$q=k$g*k$k,k$r=k$h*k$i,k$s=k$h*k$j,k$t=k$h*k$k,k$w=k$c[0],k$x=k$c[1],k$y=k$c[2];k$d[0]=(1-(k$o+k$q))*k$w,k$d[1]=(k$m+k$t)*k$w,k$d[2]=(k$n-k$s)*k$w,k$d[3]=0,k$d[4]=(k$m-k$t)*k$x,k$d[5]=(1-(k$l+k$q))*k$x,k$d[6]=(k$p+k$r)*k$x,k$d[7]=0,k$d[8]=(k$n+k$s)*k$y,k$d[9]=(k$p-k$r)*k$y,k$d[10]=(1-(k$l+k$o))*k$y,k$d[11]=0,k$d[12]=k$a[0],k$d[13]=k$a[1],k$d[14]=k$a[2],k$d[15]=1},k$I._mulMatrixArray=function(k$a,k$b,k$c,k$d){var k$e,k$f,k$g,k$h,k$i,k$j=k$b.elements,k$k=k$j[0],k$l=k$j[1],k$m=k$j[2],k$n=k$j[3],k$o=k$j[4],k$p=k$j[5],k$q=k$j[6],k$r=k$j[7],k$s=k$j[8],k$t=k$j[9],k$w=k$j[10],k$x=k$j[11],k$y=k$j[12],k$z=k$j[13],k$A=k$j[14],k$B=k$j[15],k$C=k$d,k$D=k$d+4,k$E=k$d+8,k$F=k$d+12;for(k$e=0;k$e<4;k$e++)k$f=k$a[k$e],k$g=k$a[k$e+4],k$h=k$a[k$e+8],k$i=k$a[k$e+12],k$c[k$C+k$e]=k$f*k$k+k$g*k$l+k$h*k$m+k$i*k$n,k$c[k$D+k$e]=k$f*k$o+k$g*k$p+k$h*k$q+k$i*k$r,k$c[k$E+k$e]=k$f*k$s+k$g*k$t+k$h*k$w+k$i*k$x,k$c[k$F+k$e]=k$f*k$y+k$g*k$z+k$h*k$A+k$i*k$B},k$I.getYawPitchRoll=function(k$a,k$b){k$I.transformQuat(k$gb.ForwardRH,k$a,k$cb.TEMPVector31),k$I.transformQuat(k$gb.Up,k$a,k$cb.TEMPVector32);var k$c=k$cb.TEMPVector32.elements;k$I.angleTo(k$gb.ZERO,k$cb.TEMPVector31,k$cb.TEMPVector33);var k$d=k$cb.TEMPVector33.elements;k$d[0]==Math.PI/2?(k$d[1]=k$I.arcTanAngle(k$c[2],k$c[0]),k$d[2]=0):k$d[0]==-Math.PI/2?(k$d[1]=k$I.arcTanAngle(-k$c[2],-k$c[0]),k$d[2]=0):(k$ab.createRotationY(-k$d[1],k$cb.TEMPMatrix0),k$ab.createRotationX(-k$d[0],k$cb.TEMPMatrix1),k$gb.transformCoordinate(k$cb.TEMPVector32,k$cb.TEMPMatrix0,k$cb.TEMPVector32),k$gb.transformCoordinate(k$cb.TEMPVector32,k$cb.TEMPMatrix1,k$cb.TEMPVector32),k$d[2]=k$I.arcTanAngle(k$c[1],-k$c[0])),k$d[1]<=-Math.PI&&(k$d[1]=Math.PI),k$d[2]<=-Math.PI&&(k$d[2]=Math.PI),k$d[1]>=Math.PI&&k$d[2]>=Math.PI&&(k$d[1]=0,k$d[2]=0,k$d[0]=Math.PI-k$d[0]),k$b[0]=k$d[1],k$b[1]=k$d[0],k$b[2]=k$d[2]},k$I.arcTanAngle=function(k$a,k$b){return 0==k$a?1==k$b?Math.PI/2:-Math.PI/2:0<k$a?Math.atan(k$b/k$a):k$a<0?0<k$b?Math.atan(k$b/k$a)+Math.PI:Math.atan(k$b/k$a)-Math.PI:0},k$I.angleTo=function(k$a,k$b,k$c){k$gb.subtract(k$b,k$a,k$cb.TEMPVector30),k$gb.normalize(k$cb.TEMPVector30,k$cb.TEMPVector30),k$c.elements[0]=Math.asin(k$cb.TEMPVector30.y),k$c.elements[1]=k$I.arcTanAngle(-k$cb.TEMPVector30.z,-k$cb.TEMPVector30.x)},k$I.transformQuat=function(k$a,k$b,k$c){var k$d=k$c.elements,k$e=k$a.elements,k$f=k$b,k$g=k$e[0],k$h=k$e[1],k$i=k$e[2],k$j=k$f[0],k$k=k$f[1],k$l=k$f[2],k$m=k$f[3],k$n=k$m*k$g+k$k*k$i-k$l*k$h,k$o=k$m*k$h+k$l*k$g-k$j*k$i,k$p=k$m*k$i+k$j*k$h-k$k*k$g,k$q=-k$j*k$g-k$k*k$h-k$l*k$i;k$d[0]=k$n*k$m+k$q*-k$j+k$o*-k$l-k$p*-k$k,k$d[1]=k$o*k$m+k$q*-k$k+k$p*-k$j-k$n*-k$l,k$d[2]=k$p*k$m+k$q*-k$l+k$n*-k$k-k$o*-k$j},k$I.quaterionNormalize=function(k$a,k$b){var k$c=k$a[0],k$d=k$a[1],k$e=k$a[2],k$f=k$a[3],k$g=k$c*k$c+k$d*k$d+k$e*k$e+k$f*k$f;0<k$g&&(k$g=1/Math.sqrt(k$g),k$b[0]=k$c*k$g,k$b[1]=k$d*k$g,k$b[2]=k$e*k$g,k$b[3]=k$f*k$g)},k$I.matrix4x4MultiplyFFF=function(k$a,k$b,k$c){var k$d,k$e,k$f,k$g,k$h;if(k$c===k$b)for(k$b=new Float32Array(16),k$d=0;k$d<16;++k$d)k$b[k$d]=k$c[k$d];for(k$d=0;k$d<4;k$d++)k$e=k$a[k$d],k$f=k$a[k$d+4],k$g=k$a[k$d+8],k$h=k$a[k$d+12],k$c[k$d]=k$e*k$b[0]+k$f*k$b[1]+k$g*k$b[2]+k$h*k$b[3],k$c[k$d+4]=k$e*k$b[4]+k$f*k$b[5]+k$g*k$b[6]+k$h*k$b[7],k$c[k$d+8]=k$e*k$b[8]+k$f*k$b[9]+k$g*k$b[10]+k$h*k$b[11],k$c[k$d+12]=k$e*k$b[12]+k$f*k$b[13]+k$g*k$b[14]+k$h*k$b[15]},k$I.matrix4x4MultiplyMFM=function(k$a,k$b,k$c){k$I.matrix4x4MultiplyFFF(k$a.elements,k$b,k$c.elements)},k$l(k$I,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new k$gb},"_tempVector3_1",function(){return this._tempVector3_1=new k$gb},"_tempVector3_2",function(){return this._tempVector3_2=new k$gb},"_tempVector3_3",function(){return this._tempVector3_3=new k$gb},"_tempVector3_4",function(){return this._tempVector3_4=new k$gb},"_tempVector3_5",function(){return this._tempVector3_5=new k$gb},"_tempVector3_6",function(){return this._tempVector3_6=new k$gb},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),k$I}(),k$rb=function(){function k$G(){}return k$n(k$G,"Laya3D"),k$G._cancelLoadByUrl=function(k$a){k$x.loader.cancelLoadByUrl(k$a),k$G._innerFirstLevelLoaderManager.cancelLoadByUrl(k$a),k$G._innerSecondLevelLoaderManager.cancelLoadByUrl(k$a),k$G._innerThirdLevelLoaderManager.cancelLoadByUrl(k$a),k$G._innerFourthLevelLoaderManager.cancelLoadByUrl(k$a)},k$G._changeWebGLSize=function(k$a,k$b){k$F.onStageResize(k$a,k$b),k$Y.clientWidth=k$a,k$Y.clientHeight=k$b},k$G.__init__=function(){var k$a=k$b.createMap;k$a.lh=[k$Kb,"SPRITE3DHIERARCHY"],k$a.ls=[k$Jb,"SPRITE3DHIERARCHY"],k$a.lm=[k$Rb,"MESH"],k$a.lmat=[k$Mb,"MATERIAL"],k$a.jpg=[k$Tb,"nativeimage"],k$a.jpeg=[k$Tb,"nativeimage"],k$a.png=[k$Tb,"nativeimage"],k$a.pkm=[k$Tb,"arraybuffer"],k$a.raw=[k$Pb,"arraybuffer"],k$a.mipmaps=[k$Pb,"arraybuffer"],k$r.parserMap.SPRITE3DHIERARCHY=k$G._loadHierarchy,k$r.parserMap.MESH=k$G._loadMesh,k$r.parserMap.MATERIAL=k$G._loadMaterial,k$r.parserMap.TEXTURECUBE=k$G._loadTextureCube,k$r.parserMap.TERRAIN=k$G._loadTerrain,k$G._innerFirstLevelLoaderManager.on("error",null,k$G._eventLoadManagerError),k$G._innerSecondLevelLoaderManager.on("error",null,k$G._eventLoadManagerError),k$G._innerThirdLevelLoaderManager.on("error",null,k$G._eventLoadManagerError),k$G._innerFourthLevelLoaderManager.on("error",null,k$G._eventLoadManagerError)},k$G.READ_BLOCK=function(){return k$G._readData.pos+=4,!0},k$G.READ_DATA=function(){return k$G._DATA.offset=k$G._readData.getUint32(),k$G._DATA.size=k$G._readData.getUint32(),!0},k$G.READ_STRINGS=function(){var k$a=[],k$b={offset:0,size:0};k$b.offset=k$G._readData.getUint16(),k$b.size=k$G._readData.getUint16();k$G._readData.pos;k$G._readData.pos=k$b.offset+k$G._DATA.offset;for(var k$c=0;k$c<k$b.size;k$c++){var k$d=k$G._readData.readUTFString();-1===k$d.lastIndexOf(".lmat")&&-1===k$d.lastIndexOf(".lpbr")||k$a.push(k$d)}return k$a},k$G.formatRelativePath=function(k$a,k$b){var k$c;if("."===k$b.charAt(0)){for(var k$d=(k$a+k$b).split("/"),k$e=0,k$f=k$d.length;k$e<k$f;k$e++)if(".."==k$d[k$e]){var k$g=k$e-1;0<k$g&&".."!==k$d[k$g]&&(k$d.splice(k$g,2),k$e-=2)}k$c=k$d.join("/")}else k$c=k$a+k$b;return null!=k$E.customFormat&&(k$c=k$E.customFormat(k$c,null)),k$c},k$G._eventLoadManagerError=function(k$a){k$x.loader.event("error",k$a)},k$G._addHierarchyInnerUrls=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g=k$G.formatRelativePath(k$d,k$e);k$c&&(k$g+=k$c),k$a.push({url:k$g,clas:k$f}),k$b[k$e]=k$g},k$G._getSprite3DHierarchyInnerUrls=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){var k$h,k$i=0,k$j=0;switch(k$a.type){case"Scene":var k$k=k$a.customProps.lightmaps;for(k$i=0,k$j=k$k.length;k$i<k$j;k$i++){var k$l=k$k[k$i].replace(".exr",".png");k$G._addHierarchyInnerUrls(k$d,k$e,k$f,k$g,k$l,k$Tb)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var k$m;if(k$a.instanceParams)(k$m=k$a.instanceParams.loadPath)&&k$G._addHierarchyInnerUrls(k$b,k$e,k$f,k$g,k$m,k$Rb);else{(k$m=(k$h=k$a.customProps).meshPath)&&k$G._addHierarchyInnerUrls(k$b,k$e,k$f,k$g,k$m,k$Rb);var k$n=k$h.materials;if(k$n)for(k$i=0,k$j=k$n.length;k$i<k$j;k$i++){for(var k$o=k$n[k$i],k$p=k$o.type.split("."),k$q=k$H.window,k$r=0,k$s=k$p.length;k$r<k$s;++k$r){k$q=k$q[this.clasPaths[k$r]]}if("function"!=typeof k$q)throw"_getSprite3DHierarchyInnerUrls 错误: "+k$o.type+" 不是类";k$G._addHierarchyInnerUrls(k$c,k$e,k$f,k$g,k$o.path,k$q)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var k$t=(k$h=k$a.customProps).meshPath;k$t&&k$G._addHierarchyInnerUrls(k$b,k$e,k$f,k$g,k$t,k$Rb);var k$w=k$h.material;if(k$w){k$p=k$w.type.split("."),k$q=k$H.window;for(k$r=0,k$s=k$p.length;k$r<k$s;++k$r){k$q=k$q[this.clasPaths[k$r]]}k$G._addHierarchyInnerUrls(k$c,k$e,k$f,k$g,k$w.path,k$q)}else{var k$x=k$h.materialPath;if(k$x)k$G._addHierarchyInnerUrls(k$c,k$e,k$f,k$g,k$x,ShurikenParticleMaterial);else{var k$y=k$h.texturePath;k$y&&k$G._addHierarchyInnerUrls(k$d,k$e,k$f,k$g,k$y,k$Tb)}}break;case"Terrain":k$G._addHierarchyInnerUrls(k$d,k$e,k$f,k$g,k$a.customProps.dataPath,TerrainRes)}var k$z=k$a.components;for(var k$A in k$z){var k$B=k$z[k$A];switch(k$A){case"Animator":var k$C=k$B.avatarPath;if(k$C)k$G._addHierarchyInnerUrls(k$d,k$e,k$f,k$g,k$C,Avatar);else{var k$D=k$B.avatar;k$D&&k$G._addHierarchyInnerUrls(k$d,k$e,k$f,k$g,k$D.path,Avatar)}var k$E=k$B.clipPaths;for(k$i=0,k$j=k$E.length;k$i<k$j;k$i++)k$G._addHierarchyInnerUrls(k$d,k$e,k$f,k$g,k$E[k$i],AnimationClip)}}var k$F=k$a.child;for(k$i=0,k$j=k$F.length;k$i<k$j;k$i++)k$G._getSprite3DHierarchyInnerUrls(k$F[k$i],k$b,k$c,k$d,k$e,k$f,k$g)},k$G._loadHierarchy=function(k$a){k$a.on("loaded",null,k$G._onHierarchylhLoaded,[k$a,k$a._class._getGroup()]),k$a.load(k$a.url,"json",!1,null,!0)},k$G._onHierarchylhLoaded=function(k$a,k$b,k$c){if(k$a._class.destroyed)k$a.endLoad();else{var k$d=k$a.url,k$e=k$qb.getURLVerion(k$d),k$f=k$E.getPath(k$d),k$g=[],k$h=[],k$i=[],k$j={};k$G._getSprite3DHierarchyInnerUrls(k$c,k$g,k$h,k$i,k$j,k$e,k$f);var k$k=k$g.length+k$h.length+k$i.length,k$l=k$k+1,k$m=1/k$l;if(k$G._onProcessChange(k$a,0,k$m,1),0<k$i.length){var k$n=k$k/k$l,k$o=k$D.create(null,k$G._onProcessChange,[k$a,k$m,k$n],!1);k$G._innerFourthLevelLoaderManager.create(k$i,k$D.create(null,k$G._onHierarchyInnerForthLevResouLoaded,[k$a,k$b,k$o,k$c,k$j,k$g,k$h,k$m+k$n*k$i.length,k$n]),k$o,null,null,1,!0,k$b)}else k$G._onHierarchyInnerForthLevResouLoaded(k$a,k$b,null,k$c,k$j,k$g,k$h,k$m,k$n)}},k$G._onHierarchyInnerForthLevResouLoaded=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){if(k$a._class.destroyed)k$a.endLoad();else if(k$c&&k$c.recover(),0<k$g.length){var k$j=k$D.create(null,k$G._onProcessChange,[k$a,k$h,k$i],!1);k$G._innerSecondLevelLoaderManager.create(k$g,k$D.create(null,k$G._onHierarchyInnerSecondLevResouLoaded,[k$a,k$b,k$j,k$d,k$e,k$f,k$h+k$i*k$g.length,k$i]),k$c,null,null,1,!0,k$b)}else k$G._onHierarchyInnerSecondLevResouLoaded(k$a,k$b,null,k$d,k$e,k$f,k$h,k$i)},k$G._onHierarchyInnerSecondLevResouLoaded=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h){if(k$a._class.destroyed)k$a.endLoad();else if(k$c&&k$c.recover(),0<k$f.length){var k$i=k$D.create(null,k$G._onProcessChange,[k$a,k$g,k$h],!1);k$G._innerFirstLevelLoaderManager.create(k$f,k$D.create(null,k$G._onHierarchyInnerFirstLevResouLoaded,[k$a,k$i,k$d,k$e]),k$c,null,null,1,!0,k$b)}else k$G._onHierarchyInnerFirstLevResouLoaded(k$a,null,k$d,k$e)},k$G._onHierarchyInnerFirstLevResouLoaded=function(k$a,k$b,k$c,k$d){k$b&&k$b.recover(),k$a.endLoad([k$c,k$d])},k$G._loadTerrain=function(k$a){k$a.on("loaded",null,k$G._onTerrainLtLoaded,[k$a,k$a._class._getGroup()]),k$a.load(k$a.url,"json",!1,null,!0)},k$G._onTerrainLtLoaded=function(k$a,k$b,k$c){if(k$a._class.destroyed)k$a.endLoad();else{var k$d,k$e,k$f=k$a.url,k$g=k$qb.getURLVerion(k$f),k$h=k$E.getPath(k$f),k$i=[],k$j={},k$k=0,k$l=0,k$m=k$c.heightData;k$d=k$m.url,k$e=k$G.formatRelativePath(k$h,k$d),k$g&&(k$e+=k$g),k$d=k$j[k$d]=k$e;var k$n=k$c.detailTexture;for(k$k=0,k$l=k$n.length;k$k<k$l;k$k++)k$i.push({url:k$n[k$k].diffuse});var k$o=k$c.normalMap;for(k$k=0,k$l=k$o.length;k$k<k$l;k$k++)k$i.push({url:k$o[k$k]});var k$p=k$c.alphaMap;for(k$k=0,k$l=k$p.length;k$k<k$l;k$k++)k$i.push({url:k$p[k$k],params:[!1,!1,6408,!0]});for(k$k=0,k$l=k$i.length;k$k<k$l;k$k++){var k$q=k$i[k$k].url;k$e=k$G.formatRelativePath(k$h,k$q),k$g&&(k$e+=k$g),k$i[k$k].url=k$e,k$j[k$q]=k$e}var k$r=k$i.length,k$s=k$r+2,k$t=1/k$s;k$G._onProcessChange(k$a,0,k$t,1);var k$w={heightMapLoaded:!1,texturesLoaded:!1},k$x=k$D.create(null,k$G._onProcessChange,[k$a,k$t,k$t],!1);k$G._innerFourthLevelLoaderManager.create(k$d,k$D.create(null,k$G._onTerrainHeightMapLoaded,[k$a,k$x,k$c,k$j,k$w]),k$x,null,[k$m.numX,k$m.numZ,k$m.bitType,k$m.value],1,!0,k$b);var k$y=k$D.create(null,k$G._onProcessChange,[k$a,2*k$t,k$r/k$s],!1);k$G._innerFourthLevelLoaderManager.create(k$i,k$D.create(null,k$G._onTerrainTexturesLoaded,[k$a,k$y,k$c,k$j,k$w]),k$y,null,null,1,!0,k$b)}},k$G._onTerrainHeightMapLoaded=function(k$a,k$b,k$c,k$d,k$e){k$e.heightMapLoaded=!0,k$e.texturesLoaded&&(k$a.endLoad([k$c,k$d]),k$b.recover())},k$G._onTerrainTexturesLoaded=function(k$a,k$b,k$c,k$d,k$e){k$e.texturesLoaded=!0,k$e.heightMapLoaded&&(k$a.endLoad([k$c,k$d]),k$b.recover())},k$G._loadMesh=function(k$a){k$a.on("loaded",null,k$G._onMeshLmLoaded,[k$a,k$a._class._getGroup()]),k$a.load(k$a.url,"arraybuffer",!1,null,!0)},k$G._onMeshLmLoaded=function(k$a,k$b,k$c){if(k$a._class.destroyed)k$a.endLoad();else{var k$d,k$e,k$f,k$g=k$a.url,k$h=k$qb.getURLVerion(k$g),k$i=k$E.getPath(k$g),k$j={},k$k=0,k$l=0;switch((k$G._readData=new k$y(k$c)).pos=0,k$G._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var k$m=k$G._readData.getUint32();k$G._readData.pos=k$G._readData.pos+4,k$l=k$G._readData.getUint16(),k$G._readData.pos=k$G._readData.pos+8*k$l;var k$n=k$G._readData.getUint32();for(k$l=k$G._readData.getUint16(),k$G._readData.pos=k$m+k$n,k$d=[],k$k=0;k$k<k$l;k$k++){var k$o=k$G._readData.readUTFString();-1!==k$o.lastIndexOf(".lmat")&&k$d.push(k$o)}break;default:for(k$G.READ_BLOCK(),k$k=0;k$k<2;k$k++){var k$p=k$G._readData.getUint16(),k$q=k$G._strings[k$p],k$r=k$G["READ_"+k$q];if(null==k$r)throw new Error("model file err,no this function:"+k$p+" "+k$q);1===k$k?k$d=k$r.call():k$r.call()}}for(k$k=0,k$f=k$d.length;k$k<k$f;k$k++){var k$s=k$d[k$k];k$e=k$G.formatRelativePath(k$i,k$s),k$h&&(k$e+=k$h),k$d[k$k]=k$e,k$j[k$s]=k$e}if(0<k$d.length){k$G._onProcessChange(k$a,0,.5,1);var k$t=k$D.create(null,k$G._onProcessChange,[k$a,.5,.5],!1);k$G._innerSecondLevelLoaderManager.create(k$d,k$D.create(null,k$G._onMeshMateialLoaded,[k$a,k$t,k$c,k$j]),k$t,null,null,1,!0,k$b)}else k$a.endLoad([k$c,k$j])}},k$G._onMeshMateialLoaded=function(k$a,k$b,k$c,k$d){k$a.endLoad([k$c,k$d]),k$b.recover()},k$G._getMaterialTexturePath=function(k$a,k$b,k$c){var k$d=k$a.length-4;return k$a.indexOf(".dds")!=k$d&&k$a.indexOf(".tga")!=k$d&&k$a.indexOf(".exr")!=k$d&&k$a.indexOf(".DDS")!=k$d&&k$a.indexOf(".TGA")!=k$d&&k$a.indexOf(".EXR")!=k$d||(k$a=k$a.substr(0,k$d)+".png"),k$a=k$G.formatRelativePath(k$c,k$a),k$b&&(k$a+=k$b),k$a},k$G._loadMaterial=function(k$a){k$a.on("loaded",null,k$G._onMaterilLmatLoaded,[k$a,k$a._class._getGroup()]),k$a.load(k$a.url,"json",!1,null,!0)},k$G._onMaterilLmatLoaded=function(k$a,k$b,k$c){if(k$a._class.destroyed)k$a.endLoad();else{var k$d,k$e=k$a.url,k$f=k$qb.getURLVerion(k$e),k$g=k$E.getPath(k$e),k$h=[],k$i={},k$j=k$c.customProps,k$k=k$c.version;if(k$k)switch(k$k){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var k$l=k$c.props.textures,k$m=0,k$n=k$l.length;k$m<k$n;k$m++){var k$o=k$l[k$m],k$p=k$o.path;if(k$p){var k$q=k$p.length-4;k$p.indexOf(".exr")!=k$q&&k$p.indexOf(".EXR")!=k$q||(k$p=k$p.substr(0,k$q)+".png"),k$d=k$G.formatRelativePath(k$g,k$p),k$f&&(k$d+=k$f),k$h.push({url:k$d,params:k$o.params}),k$i[k$p]=k$d}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var k$r=k$j.diffuseTexture.texture2D;if(k$r&&(k$d=k$G._getMaterialTexturePath(k$r,k$f,k$g),k$h.push(k$d),k$i[k$r]=k$d),k$j.normalTexture){var k$s=k$j.normalTexture.texture2D;k$s&&(k$d=k$G._getMaterialTexturePath(k$s,k$f,k$g),k$h.push(k$d),k$i[k$s]=k$d)}if(k$j.specularTexture){var k$t=k$j.specularTexture.texture2D;k$t&&(k$d=k$G._getMaterialTexturePath(k$t,k$f,k$g),k$h.push(k$d),k$i[k$t]=k$d)}if(k$j.emissiveTexture){var k$w=k$j.emissiveTexture.texture2D;k$w&&(k$d=k$G._getMaterialTexturePath(k$w,k$f,k$g),k$h.push(k$d),k$i[k$w]=k$d)}if(k$j.ambientTexture){var k$x=k$j.ambientTexture.texture2D;k$x&&(k$d=k$G._getMaterialTexturePath(k$x,k$f,k$g),k$h.push(k$d),k$i[k$x]=k$d)}if(k$j.reflectTexture){var k$y=k$j.reflectTexture.texture2D;k$y&&(k$d=k$G._getMaterialTexturePath(k$y,k$f,k$g),k$h.push(k$d),k$i[k$y]=k$d)}}var k$z=k$h.length,k$A=k$z+1,k$B=1/k$A;if(k$G._onProcessChange(k$a,0,k$B,1),0<k$z){var k$C=k$D.create(null,k$G._onProcessChange,[k$a,k$B,k$z/k$A],!1);k$G._innerFourthLevelLoaderManager.create(k$h,k$D.create(null,k$G._onMateialTexturesLoaded,[k$a,k$C,k$c,k$i]),k$C,k$Tb,null,1,!0,k$b)}else k$G._onMateialTexturesLoaded(k$a,null,k$c,null)}},k$G._onMateialTexturesLoaded=function(k$a,k$b,k$c,k$d){k$a.endLoad([k$c,k$d]),k$b&&k$b.recover()},k$G._loadTextureCube=function(k$a){k$a.on("loaded",null,k$G._onTextureCubeLtcLoaded,[k$a]),k$a.load(k$a.url,"json",!1,null,!0)},k$G._onTextureCubeLtcLoaded=function(k$a,k$b){if(k$a._class.destroyed)k$a.endLoad();else{var k$c=k$E.getPath(k$a.url),k$d=[k$G.formatRelativePath(k$c,k$b.px),k$G.formatRelativePath(k$c,k$b.nx),k$G.formatRelativePath(k$c,k$b.py),k$G.formatRelativePath(k$c,k$b.ny),k$G.formatRelativePath(k$c,k$b.pz),k$G.formatRelativePath(k$c,k$b.nz)];k$G._onProcessChange(k$a,0,1/7,1);var k$e=k$D.create(null,k$G._onProcessChange,[k$a,1/7,6/7],!1);k$G._innerFourthLevelLoaderManager.load(k$d,k$D.create(null,k$G._onTextureCubeImagesLoaded,[k$a,k$d,k$e]),k$e,"nativeimage")}},k$G._onTextureCubeImagesLoaded=function(k$a,k$b,k$c){var k$d=[];k$d.length=6;for(var k$e=0;k$e<6;k$e++){var k$f=k$b[k$e];k$d[k$e]=k$r.getRes(k$f),k$r.clearRes(k$f)}k$a.endLoad(k$d),k$c.recover()},k$G._onProcessChange=function(k$a,k$b,k$c,k$d){(k$d=k$b+k$d*k$c)<1&&k$a.event("progress",k$d)},k$G.init=function(k$a,k$b,k$c,k$d,k$e,k$f){if(void 0===k$c&&(k$c=!1),void 0===k$d&&(k$d=!1),void 0===k$e&&(k$e=!0),void 0===k$f&&(k$f=!0),k$s.update3DLoop=function(){},k$s.cancelLoadByUrl=function(k$a){k$G._cancelLoadByUrl(k$a)},k$i.isAntialias=k$c,k$i.isAlpha=k$d,k$i.premultipliedAlpha=k$e,k$i.isStencil=k$f,!k$F.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");k$s.changeWebGLSize=k$G._changeWebGLSize,k$p.is3DMode=!0,k$x.init(k$a,k$b),k$I.__init__(),k$lb.__init__(),k$Xb.__init__(),k$Q.__init__(),k$G.__init__(),k$g.maxTextureCount=2,(k$G.debugMode||k$Z.debugMode)&&(k$G._debugPhasorSprite=new k$V)},k$G.HIERARCHY="SPRITE3DHIERARCHY",k$G.MESH="MESH",k$G.MATERIAL="MATERIAL",k$G.PBRMATERIAL="PBRMTL",k$G.TEXTURECUBE="TEXTURECUBE",k$G.TERRAIN="TERRAIN",k$G._readData=null,k$G._debugPhasorSprite=null,k$G.debugMode=!1,k$l(k$G,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new k$b},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new k$b},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new k$b},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new k$b}]),k$G}(),k$sb=function(k$a){function k$e(k$a){k$e.__super.call(this),this._owner=k$a,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}k$n(k$e,"laya.d3.animation.AnimationTransform3D",k$f);var k$b=k$e.prototype;return k$b._getlocalMatrix=function(){return this._localUpdate&&(k$qb._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},k$b._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var k$a=0,k$b=this._childs.length;k$a<k$b;k$a++)this._childs[k$a]._onWorldTransform()}},k$b._setWorldMatrixAndUpdate=function(k$a){if(this._worldMatrix=k$a,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var k$b=this._getlocalMatrix(),k$c=0;k$c<16;++k$c)this._worldMatrix[k$c]=k$b[k$c];else k$qb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},k$b._setWorldMatrixNoUpdate=function(k$a){this._worldMatrix=k$a},k$b._setWorldMatrixIgnoreUpdate=function(k$a){this._worldMatrix=k$a,this._worldUpdate=!1},k$b.getLocalPosition=function(){return this._localPosition},k$b.setLocalPosition=function(k$a){if(this._parent)this._localPosition=k$a,this._localUpdate=!0,this._onWorldTransform();else{var k$b=this._entity.owner._transform,k$c=this._entity.localPosition,k$d=k$c.elements;k$d[0]=k$a[0],k$d[1]=k$a[1],k$d[2]=k$a[2],k$b.localPosition=k$c}},k$b.getLocalRotation=function(){if(this._localQuaternionUpdate){var k$a=this._localRotationEuler;k$qb._quaternionCreateFromYawPitchRollArray(k$a[1]/k$e._angleToRandin,k$a[0]/k$e._angleToRandin,k$a[2]/k$e._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},k$b.setLocalRotation=function(k$a){if(this._parent)this._localRotation=k$a,k$qb.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var k$b=this._entity.owner._transform,k$c=this._entity.localRotation,k$d=k$c.elements;k$d[0]=k$a[0],k$d[1]=k$a[1],k$d[2]=k$a[2],k$d[3]=k$a[3],k$b.localRotation=k$c}},k$b.getLocalScale=function(){return this._localScale},k$b.setLocalScale=function(k$a){if(this._parent)this._localScale=k$a,this._localUpdate=!0,this._onWorldTransform();else{var k$b=this._entity.owner._transform,k$c=this._entity.localScale,k$d=k$c.elements;k$d[0]=k$a[0],k$d[1]=k$a[1],k$d[2]=k$a[2],k$b.localScale=k$c}},k$b.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){k$qb.getYawPitchRoll(this._localRotation,k$e._tempVector3);var k$a=k$e._tempVector3,k$b=this._localRotationEuler;k$b[0]=k$a[1]*k$e._angleToRandin,k$b[1]=k$a[0]*k$e._angleToRandin,k$b[2]=k$a[2]*k$e._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},k$b.setLocalRotationEuler=function(k$a){if(this._parent)k$qb._quaternionCreateFromYawPitchRollArray(k$a[1]/k$e._angleToRandin,k$a[0]/k$e._angleToRandin,k$a[2]/k$e._angleToRandin,this._localRotation),this._localRotationEuler=k$a,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var k$b=this._entity.owner._transform,k$c=this._entity.localRotationEuler,k$d=k$c.elements;k$d[0]=k$a[0],k$d[1]=k$a[1],k$d[2]=k$a[2],k$b.localRotationEuler=k$c}},k$b.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)k$qb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var k$a=this._getlocalMatrix(),k$b=0;k$b<16;++k$b)this._worldMatrix[k$b]=k$a[k$b];this._worldUpdate=!1}return this._worldMatrix},k$b.setParent=function(k$a){if(this._parent!==k$a){if(this._parent){var k$b=this._parent._childs,k$c=k$b.indexOf(this);k$b.splice(k$c,1)}k$a&&(k$a._childs.push(this),k$a&&this._onWorldTransform()),this._parent=k$a}},k$l(k$e,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),k$e}(),k$tb=function(k$a){function k$b(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,k$b.__super.call(this),this._destroyed=!1,this._id=k$b._uniqueIDCounter,k$b._uniqueIDCounter++}k$n(k$b,"laya.d3.component.Component3D",k$f);var k$c=k$b.prototype;return k$x.imps(k$c,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),k$c._initialize=function(k$a){this._owner=k$a,this._enable=!0,this.started=!1,this._load(k$a)},k$c._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},k$c._load=function(k$a){},k$c._start=function(k$a){},k$c._update=function(k$a){},k$c._lateUpdate=function(k$a){},k$c._preRenderUpdate=function(k$a){},k$c._postRenderUpdate=function(k$a){},k$c._unload=function(k$a){this.offAll()},k$c._cloneTo=function(k$a){},k$o(0,k$c,"id",function(){return this._id}),k$o(0,k$c,"destroyed",function(){return this._destroyed}),k$o(0,k$c,"owner",function(){return this._owner}),k$o(0,k$c,"enable",function(){return this._enable},function(k$a){this._enable!==k$a&&(this._enable=k$a,this.event("enablechanged",this._enable))}),k$o(0,k$c,"isSingleton",function(){return k$b._isSingleton}),k$b._isSingleton=!0,k$b._uniqueIDCounter=1,k$b}(),k$wb=function(k$a){function k$b(){this._destroyed=!1,k$b.__super.call(this),this._destroyed=!1}k$n(k$b,"laya.d3.core.GeometryFilter",k$f);var k$c=k$b.prototype;return k$x.imps(k$c,{"laya.resource.IDestroy":!0}),k$c._destroy=function(){this.offAll(),this._destroyed=!0},k$o(0,k$c,"_isAsyncLoaded",function(){return!0}),k$o(0,k$c,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),k$o(0,k$c,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),k$o(0,k$c,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),k$o(0,k$c,"destroyed",function(){return this._destroyed}),k$b}(),k$xb=function(k$a){function k$d(k$a){k$d.__super.call(this),this._id=++k$d._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new k$Za(new k$gb,new k$gb),this._boundingBoxCenter=new k$gb,this._boundingSphere=new k$_a(new k$gb,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=k$a,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}k$n(k$d,"laya.d3.core.render.BaseRender",k$f);var k$b=k$d.prototype;return k$x.imps(k$b,{"laya.resource.IDestroy":!0}),k$b._changeMaterialReference=function(k$a,k$b){k$a&&k$a._removeReference(),k$b._addReference()},k$b._getInstanceMaterial=function(k$a,k$b){var k$c=new k$a.constructor;return k$a.cloneTo(k$c),k$c.name=k$c.name+"(Instance)",this._materialsInstance[k$b]=!0,this._changeMaterialReference(this._materials[k$b],k$c),this._materials[k$b]=k$c},k$b._setShaderValuelightMap=function(k$a){this._setShaderValueTexture(3,k$a)},k$b._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},k$b._renderRenderableBoundBox=function(){var k$a=k$rb._debugPhasorSprite,k$b=this.boundingBox,k$c=k$d._tempBoundBoxCorners;k$b.getCorners(k$c),k$a.line(k$c[0],k$d._greenColor,k$c[1],k$d._greenColor),k$a.line(k$c[2],k$d._greenColor,k$c[3],k$d._greenColor),k$a.line(k$c[4],k$d._greenColor,k$c[5],k$d._greenColor),k$a.line(k$c[6],k$d._greenColor,k$c[7],k$d._greenColor),k$a.line(k$c[0],k$d._greenColor,k$c[3],k$d._greenColor),k$a.line(k$c[1],k$d._greenColor,k$c[2],k$d._greenColor),k$a.line(k$c[2],k$d._greenColor,k$c[6],k$d._greenColor),k$a.line(k$c[3],k$d._greenColor,k$c[7],k$d._greenColor),k$a.line(k$c[0],k$d._greenColor,k$c[4],k$d._greenColor),k$a.line(k$c[1],k$d._greenColor,k$c[5],k$d._greenColor),k$a.line(k$c[4],k$d._greenColor,k$c[7],k$d._greenColor),k$a.line(k$c[5],k$d._greenColor,k$c[6],k$d._greenColor)},k$b._calculateBoundingSphere=function(){throw"BaseRender: must override it."},k$b._calculateBoundingBox=function(){throw"BaseRender: must override it."},k$b._setShaderValueTexture=function(k$a,k$b){this._owner._shaderValues.setValue(k$a,k$b)},k$b._setShaderValueMatrix4x4=function(k$a,k$b){this._owner._shaderValues.setValue(k$a,k$b?k$b.elements:null)},k$b._setShaderValueColor=function(k$a,k$b){this._owner._shaderValues.setValue(k$a,k$b?k$b.elements:null)},k$b._setShaderValueBuffer=function(k$a,k$b){this._owner._shaderValues.setValue(k$a,k$b)},k$b._setShaderValueInt=function(k$a,k$b){this._owner._shaderValues.setValue(k$a,k$b)},k$b._setShaderValueBool=function(k$a,k$b){this._owner._shaderValues.setValue(k$a,k$b)},k$b._setShaderValueNumber=function(k$a,k$b){this._owner._shaderValues.setValue(k$a,k$b)},k$b._setShaderValueVector2=function(k$a,k$b){this._owner._shaderValues.setValue(k$a,k$b?k$b.elements:null)},k$b._addShaderDefine=function(k$a){this._owner._shaderDefineValue|=k$a},k$b._removeShaderDefine=function(k$a){this._owner._shaderDefineValue&=~k$a},k$b._renderUpdate=function(k$a){return!0},k$b._applyLightMapParams=function(){if(0<=this._lightmapIndex){var k$a=this._owner.scene;if(k$a){var k$b=k$a.getlightmaps()[this._lightmapIndex];k$b?(this._addShaderDefine(k$Vb.SAHDERDEFINE_LIGHTMAP),k$b.loaded?this._setShaderValuelightMap(k$b):k$b.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(k$Vb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(k$Vb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(k$Vb.SAHDERDEFINE_LIGHTMAP)},k$b._updateOctreeNode=function(){var k$a=this._treeNode;k$a&&this._octreeNodeNeedChange&&(k$a.updateObject(this),this._octreeNodeNeedChange=!1)},k$b._destroy=function(){this.offAll();var k$a=0,k$b=0;for(k$a=0,k$b=this._renderElements.length;k$a<k$b;k$a++)this._renderElements[k$a]._destroy();for(k$a=0,k$b=this._materials.length;k$a<k$b;k$a++)this._materials[k$a]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},k$o(0,k$b,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),k$o(0,k$b,"id",function(){return this._id}),k$o(0,k$b,"material",function(){var k$a=this._materials[0];if(k$a&&!this._materialsInstance[0]){var k$b=this._getInstanceMaterial(k$a,0);this.event("materialchanged",[this,0,k$b])}return this._materials[0]},function(k$a){this.sharedMaterial=k$a}),k$o(0,k$b,"sharedMaterial",function(){return this._materials[0]},function(k$a){var k$b=this._materials[0];k$b!==k$a&&(this._materials[0]=k$a,this._materialsInstance[0]=!1,this._changeMaterialReference(k$b,k$a),this.event("materialchanged",[this,0,k$a]))}),k$o(0,k$b,"lightmapIndex",function(){return this._lightmapIndex},function(k$a){this._lightmapIndex=k$a,this._applyLightMapParams()}),k$o(0,k$b,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(k$a){this._lightmapScaleOffset=k$a,this._setShaderValueColor(2,k$a),this._addShaderDefine(k$Vb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),k$o(0,k$b,"enable",function(){return this._enable},function(k$a){this._enable=k$a,this.event("enablechanged",[this,k$a])}),k$o(0,k$b,"materials",function(){for(var k$a=0,k$b=this._materials.length;k$a<k$b;k$a++)if(!this._materialsInstance[k$a]){var k$c=this._getInstanceMaterial(this._materials[k$a],k$a);this.event("materialchanged",[this,k$a,k$c])}return this._materials.slice()},function(k$a){this.sharedMaterials=k$a}),k$o(0,k$b,"sharedMaterials",function(){return this._materials.slice()},function(k$a){if(!k$a)throw new Error("MeshRender: shadredMaterials value can't be null.");var k$b=k$a.length;this._materialsInstance.length=k$b;for(var k$c=0;k$c<k$b;k$c++){var k$d=this._materials[k$c];k$d!==k$a[k$c]&&(this._materialsInstance[k$c]=!1,this._changeMaterialReference(k$d,k$a[k$c]),this.event("materialchanged",[this,k$c,k$a[k$c]]))}this._materials=k$a}),k$o(0,k$b,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),k$o(0,k$b,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var k$a=this.boundingBox;k$gb.add(k$a.min,k$a.max,this._boundingBoxCenter),k$gb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),k$o(0,k$b,"receiveShadow",function(){return this._receiveShadow},function(k$a){this._receiveShadow!==k$a&&((this._receiveShadow=k$a)?this._addShaderDefine(k$nb.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(k$nb.SHADERDEFINE_RECEIVE_SHADOW))}),k$o(0,k$b,"destroyed",function(){return this._destroyed}),k$d._uniqueIDCounter=0,k$l(k$d,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new k$gb,new k$gb,new k$gb,new k$gb,new k$gb,new k$gb,new k$gb,new k$gb]},"_greenColor",function(){return this._greenColor=new k$hb(0,1,0,1)}]),k$d}(),k$yb=function(k$a){function k$h(k$a){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,k$h.__super.call(this),this._localPosition=new k$gb,this._localRotation=new k$cb(0,0,0,1),this._localScale=new k$gb(1,1,1),this._localRotationEuler=new k$gb,this._localMatrix=new k$ab,this._position=new k$gb,this._rotation=new k$cb(0,0,0,1),this._scale=new k$gb(1,1,1),this._worldMatrix=new k$ab,this._forward=new k$gb,this._up=new k$gb,this._right=new k$gb,this._owner=k$a,this._childs=[]}k$n(k$h,"laya.d3.core.Transform3D",k$f);var k$b=k$h.prototype;return k$b._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)k$ab.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var k$a=k$h._tempVector30;k$gb.multiply(this.pivot,this._localScale,k$a);var k$b=k$h._tempVector31;k$gb.subtract(k$a,this.pivot,k$b);var k$c=k$h._tempVector32,k$d=this.localRotation;k$gb.transformQuat(k$a,k$d,k$c),k$gb.subtract(k$c,k$a,k$c);var k$e=k$h._tempVector33;k$gb.subtract(this._localPosition,k$b,k$e),k$gb.subtract(k$e,k$c,k$e),k$ab.createAffineTransformation(k$e,k$d,this._localScale,this._localMatrix)}},k$b._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var k$a=0,k$b=this._childs.length;k$a<k$b;k$a++)this._childs[k$a]._onWorldPositionRotationTransform()}},k$b._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var k$a=0,k$b=this._childs.length;k$a<k$b;k$a++)this._childs[k$a]._onWorldPositionScaleTransform()}},k$b._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var k$a=0,k$b=this._childs.length;k$a<k$b;k$a++)this._childs[k$a]._onWorldPositionTransform()}},k$b._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var k$a=0,k$b=this._childs.length;k$a<k$b;k$a++)this._childs[k$a]._onWorldPositionRotationTransform()}},k$b._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var k$a=0,k$b=this._childs.length;k$a<k$b;k$a++)this._childs[k$a]._onWorldPositionScaleTransform()}},k$b._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var k$a=0,k$b=this._childs.length;k$a<k$b;k$a++)this._childs[k$a]._onWorldTransform()}},k$b.translate=function(k$a,k$b){void 0===k$b&&(k$b=!0),k$b?(k$ab.createFromQuaternion(this.localRotation,k$h._tempMatrix0),k$gb.transformCoordinate(k$a,k$h._tempMatrix0,k$h._tempVector30),k$gb.add(this.localPosition,k$h._tempVector30,this._localPosition),this.localPosition=this._localPosition):(k$gb.add(this.position,k$a,this._position),this.position=this._position)},k$b.rotate=function(k$a,k$b,k$c){var k$d;void 0===k$b&&(k$b=!0),void 0===k$c&&(k$c=!0),k$d=k$c?k$a:(k$gb.scale(k$a,Math.PI/180,k$h._tempVector30),k$h._tempVector30),k$cb.createFromYawPitchRoll(k$d.y,k$d.x,k$d.z,k$h._tempQuaternion0),k$b?(k$cb.multiply(this._localRotation,k$h._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(k$cb.multiply(k$h._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},k$b.lookAt=function(k$a,k$b,k$c){void 0===k$c&&(k$c=!1);var k$d,k$e=k$a.elements;if(k$c){if(k$d=this._localPosition.elements,Math.abs(k$d[0]-k$e[0])<k$ua.zeroTolerance&&Math.abs(k$d[1]-k$e[1])<k$ua.zeroTolerance&&Math.abs(k$d[2]-k$e[2])<k$ua.zeroTolerance)return;k$cb.lookAt(this._localPosition,k$a,k$b,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var k$f=this.position;if(k$d=k$f.elements,Math.abs(k$d[0]-k$e[0])<k$ua.zeroTolerance&&Math.abs(k$d[1]-k$e[1])<k$ua.zeroTolerance&&Math.abs(k$d[2]-k$e[2])<k$ua.zeroTolerance)return;k$cb.lookAt(k$f,k$a,k$b,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},k$o(0,k$b,"_isFrontFaceInvert",function(){var k$a=this.scale,k$b=k$a.x<0;return k$a.y<0&&(k$b=!k$b),k$a.z<0&&(k$b=!k$b),k$b}),k$o(0,k$b,"owner",function(){return this._owner}),k$o(0,k$b,"localRotation",function(){if(this._localQuaternionUpdate){var k$a=this._localRotationEuler.elements;k$cb.createFromYawPitchRoll(k$a[1]/k$h._angleToRandin,k$a[0]/k$h._angleToRandin,k$a[2]/k$h._angleToRandin,this._localRotation)}return this._localRotation},function(k$a){this._localRotation=k$a,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),k$o(0,k$b,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?k$ab.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(k$a){null===this._parent?k$a.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),k$ab.multiply(this._localMatrix,k$a,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=k$a,this._worldUpdate=!1}),k$o(0,k$b,"worldNeedUpdate",function(){return this._worldUpdate}),k$o(0,k$b,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(k$a){this._localMatrix=k$a,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),k$o(0,k$b,"dummy",function(){return this._dummy},function(k$a){this._dummy!==k$a&&(this._dummy&&(this._dummy._entity=null),k$a&&(k$a._entity=this),this._dummy=k$a)}),k$o(0,k$b,"localPosition",function(){return this._localPosition},function(k$a){this._localPosition=k$a,this._localUpdate=!0,this._onWorldPositionTransform()}),k$o(0,k$b,"position",function(){if(this._positionUpdate){if(null!=this._parent){var k$a=this._parent.position;k$gb.multiply(this._localPosition,this._parent.scale,k$h._tempVector30),k$gb.transformQuat(k$h._tempVector30,this._parent.rotation,k$h._tempVector30),k$gb.add(k$a,k$h._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(k$a){if(null!=this._parent){k$gb.subtract(k$a,this._parent.position,this._localPosition);var k$b=this._parent.scale.elements,k$c=k$b[0],k$d=k$b[1],k$e=k$b[2];if(1!==k$c||1!==k$d||1!==k$e){var k$f=k$h._tempVector30,k$g=k$f.elements;k$g[0]=1/k$c,k$g[1]=1/k$d,k$g[2]=1/k$e,k$gb.multiply(this._localPosition,k$f,this._localPosition)}this._parent.rotation.invert(k$h._tempQuaternion0),k$gb.transformQuat(this._localPosition,k$h._tempQuaternion0,this._localPosition)}else k$a.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=k$a,this._positionUpdate=!1}),k$o(0,k$b,"localScale",function(){return this._localScale},function(k$a){this._localScale=k$a,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),k$o(0,k$b,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(k$h._tempVector30);var k$a=k$h._tempVector30.elements,k$b=this._localRotationEuler.elements;k$b[0]=k$a[1]*k$h._angleToRandin,k$b[1]=k$a[0]*k$h._angleToRandin,k$b[2]=k$a[2]*k$h._angleToRandin}return this._localRotationEuler},function(k$a){this._localRotationEuler=k$a,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),k$o(0,k$b,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?k$cb.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(k$a){null!=this._parent?(this._parent.rotation.invert(k$h._tempQuaternion0),k$cb.multiply(k$a,k$h._tempQuaternion0,this._localRotation)):k$a.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=k$a,this._rotationUpdate=!1}),k$o(0,k$b,"scale",function(){return this._scaleUpdate&&(null!==this._parent?k$gb.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(k$a){if(null!==this._parent){var k$b=this._parent.scale.elements,k$c=k$h._tempVector30.elements;k$c[0]=1/k$b[0],k$c[1]=1/k$b[1],k$c[2]=1/k$b[2],k$gb.multiply(k$a,k$h._tempVector30,this._localScale)}else k$a.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=k$a,this._scaleUpdate=!1}),k$o(0,k$b,"rotationEuler",null,function(k$a){k$cb.createFromYawPitchRoll(k$a.y,k$a.x,k$a.z,this._rotation),this.rotation=this._rotation}),k$o(0,k$b,"forward",function(){var k$a=this.worldMatrix.elements;return this._forward.elements[0]=-k$a[8],this._forward.elements[1]=-k$a[9],this._forward.elements[2]=-k$a[10],this._forward}),k$o(0,k$b,"up",function(){var k$a=this.worldMatrix.elements;return this._up.elements[0]=k$a[4],this._up.elements[1]=k$a[5],this._up.elements[2]=k$a[6],this._up}),k$o(0,k$b,"right",function(){var k$a=this.worldMatrix.elements;return this._right.elements[0]=k$a[0],this._right.elements[1]=k$a[1],this._right.elements[2]=k$a[2],this._right}),k$o(0,k$b,"parent",function(){return this._parent},function(k$a){if(this._parent!==k$a){if(this._parent){var k$b=this._parent._childs,k$c=k$b.indexOf(this);k$b.splice(k$c,1)}k$a&&(k$a._childs.push(this),k$a&&this._onWorldTransform()),this._parent=k$a}}),k$l(k$h,["_tempVector30",function(){return this._tempVector30=new k$gb},"_tempVector31",function(){return this._tempVector31=new k$gb},"_tempVector32",function(){return this._tempVector32=new k$gb},"_tempVector33",function(){return this._tempVector33=new k$gb},"_tempQuaternion0",function(){return this._tempQuaternion0=new k$cb},"_tempMatrix0",function(){return this._tempMatrix0=new k$ab},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),k$h}(),k$zb=(function(k$a){function k$b(){this._rotation=0,this._matNeedUpdte=!1,k$b.__super.call(this),this._matrix=new k$ab,this._offset=new k$fb,this._tiling=new k$fb(1,1)}k$n(k$b,"laya.d3.core.TransformUV",k$f);var k$c=k$b.prototype;k$x.imps(k$c,{"laya.d3.core.IClone":!0}),k$c._updateMatrix=function(){k$b._tempOffsetV3.elements[0]=this._offset.x,k$b._tempOffsetV3.elements[1]=this._offset.y,k$cb.createFromYawPitchRoll(0,0,this._rotation,k$b._tempRotationQua),k$b._tempTitlingV3.elements[0]=this._tiling.x,k$b._tempTitlingV3.elements[1]=this._tiling.y,k$ab.createAffineTransformation(k$b._tempOffsetV3,k$b._tempRotationQua,k$b._tempTitlingV3,this._matrix)},k$c.cloneTo=function(k$a){k$a._matrix=this._matrix.clone(),k$a._offset=this._offset.clone(),k$a._rotation=this._rotation,k$a._tiling=this._tiling.clone()},k$c.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$c,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),k$o(0,k$c,"tiling",function(){return this._tiling},function(k$a){this._tiling=k$a,this._matNeedUpdte=!0}),k$o(0,k$c,"offset",function(){return this._offset},function(k$a){this._offset=k$a,this._matNeedUpdte=!0}),k$o(0,k$c,"rotation",function(){return this._rotation},function(k$a){this._rotation=k$a,this._matNeedUpdte=!0}),k$l(k$b,["_tempOffsetV3",function(){return this._tempOffsetV3=new k$gb(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new k$cb},"_tempTitlingV3",function(){return this._tempTitlingV3=new k$gb(1,1,1)}])}(),function(k$c){function k$a(){this.x=NaN,this.y=NaN,this.z=NaN,k$a.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}k$n(k$a,"laya.d3.core.particleShuriKen.module.shape.BoxShape",k$c);var k$b=k$a.prototype;k$b._getShapeBoundBox=function(k$a){var k$b=k$a.min.elements;k$b[0]=.5*-this.x,k$b[1]=.5*-this.y,k$b[2]=.5*-this.z;var k$c=k$a.max.elements;k$c[0]=.5*this.x,k$c[1]=.5*this.y,k$c[2]=.5*this.z},k$b._getSpeedBoundBox=function(k$a){var k$b=k$a.min.elements;k$b[0]=0,k$b[1]=0,k$b[2]=0;var k$c=k$a.max.elements;k$c[0]=0,k$c[1]=1,k$c[2]=0},k$b.generatePositionAndDirection=function(k$a,k$b,k$c,k$d){var k$e=k$a.elements,k$f=k$b.elements;k$c?(k$c.seed=k$d[16],k$T._randomPointInsideHalfUnitBox(k$a,k$c),k$d[16]=k$c.seed):k$T._randomPointInsideHalfUnitBox(k$a),k$e[0]=this.x*k$e[0],k$e[1]=this.y*k$e[1],k$e[2]=this.z*k$e[2],this.randomDirection?k$c?(k$c.seed=k$d[17],k$T._randomPointUnitSphere(k$b,k$c),k$d[17]=k$c.seed):k$T._randomPointUnitSphere(k$b):(k$f[0]=0,k$f[1]=0,k$f[2]=1)},k$b.cloneTo=function(k$a){k$c.prototype.cloneTo.call(this,k$a);var k$b=k$a;k$b.x=this.x,k$b.y=this.y,k$b.z=this.z,k$b.randomDirection=this.randomDirection}}(k$O),function(k$c){function k$g(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,k$g.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}k$n(k$g,"laya.d3.core.particleShuriKen.module.shape.CircleShape",k$c);var k$a=k$g.prototype;k$a._getShapeBoundBox=function(k$a){var k$b=k$a.min.elements;k$b[0]=k$b[2]=-this.radius,k$b[1]=0;var k$c=k$a.max.elements;k$c[0]=k$c[2]=this.radius,k$c[1]=0},k$a._getSpeedBoundBox=function(k$a){var k$b=k$a.min.elements;k$b[0]=k$b[1]=-1,k$b[2]=0;var k$c=k$a.max.elements;k$c[0]=k$c[1]=1,k$c[2]=0},k$a.generatePositionAndDirection=function(k$a,k$b,k$c,k$d){var k$e=k$a.elements,k$f=k$g._tempPositionPoint.elements;k$c?(k$c.seed=k$d[16],this.emitFromEdge?k$T._randomPointUnitArcCircle(this.arc,k$g._tempPositionPoint,k$c):k$T._randomPointInsideUnitArcCircle(this.arc,k$g._tempPositionPoint,k$c),k$d[16]=k$c.seed):this.emitFromEdge?k$T._randomPointUnitArcCircle(this.arc,k$g._tempPositionPoint):k$T._randomPointInsideUnitArcCircle(this.arc,k$g._tempPositionPoint),k$e[0]=-k$f[0],k$e[1]=k$f[1],k$e[2]=0,k$gb.scale(k$a,this.radius,k$a),this.randomDirection?k$c?(k$c.seed=k$d[17],k$T._randomPointUnitSphere(k$b,k$c),k$d[17]=k$c.seed):k$T._randomPointUnitSphere(k$b):k$a.cloneTo(k$b)},k$a.cloneTo=function(k$a){k$c.prototype.cloneTo.call(this,k$a);var k$b=k$a;k$b.radius=this.radius,k$b.arc=this.arc,k$b.emitFromEdge=this.emitFromEdge,k$b.randomDirection=this.randomDirection},k$l(k$g,["_tempPositionPoint",function(){return this._tempPositionPoint=new k$fb}])}(k$O),function(k$c){function k$m(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,k$m.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}k$n(k$m,"laya.d3.core.particleShuriKen.module.shape.ConeShape",k$c);var k$a=k$m.prototype;k$a._getShapeBoundBox=function(k$a){var k$b=this.radius+this.length*Math.sin(this.angle),k$c=this.length*Math.cos(this.angle),k$d=k$a.min.elements;k$d[0]=k$d[1]=-k$b,k$d[2]=0;var k$e=k$a.max.elements;k$e[0]=k$e[1]=k$b,k$e[2]=k$c},k$a._getSpeedBoundBox=function(k$a){var k$b=Math.sin(this.angle),k$c=k$a.min.elements;k$c[0]=k$c[1]=-k$b,k$c[2]=0;var k$d=k$a.max.elements;k$d[0]=k$c[1]=k$b,k$d[2]=1},k$a.generatePositionAndDirection=function(k$a,k$b,k$c,k$d){var k$e,k$f=k$a.elements,k$g=k$b.elements,k$h=k$m._tempPositionPoint.elements,k$i=NaN,k$j=NaN,k$k=Math.cos(this.angle),k$l=Math.sin(this.angle);switch(this.emitType){case 0:k$c?(k$c.seed=k$d[16],k$T._randomPointInsideUnitCircle(k$m._tempPositionPoint,k$c),k$d[16]=k$c.seed):k$T._randomPointInsideUnitCircle(k$m._tempPositionPoint),k$i=k$h[0],k$j=k$h[1],k$f[0]=k$i*this.radius,k$f[1]=k$j*this.radius,k$f[2]=0,this.randomDirection?(k$c?(k$c.seed=k$d[17],k$T._randomPointInsideUnitCircle(k$m._tempDirectionPoint,k$c),k$d[17]=k$c.seed):k$T._randomPointInsideUnitCircle(k$m._tempDirectionPoint),k$e=k$m._tempDirectionPoint.elements,k$g[0]=k$e[0]*k$l,k$g[1]=k$e[1]*k$l):(k$g[0]=k$i*k$l,k$g[1]=k$j*k$l),k$g[2]=k$k;break;case 1:k$c?(k$c.seed=k$d[16],k$T._randomPointUnitCircle(k$m._tempPositionPoint,k$c),k$d[16]=k$c.seed):k$T._randomPointUnitCircle(k$m._tempPositionPoint),k$i=k$h[0],k$j=k$h[1],k$f[0]=k$i*this.radius,k$f[1]=k$j*this.radius,k$f[2]=0,this.randomDirection?(k$c?(k$c.seed=k$d[17],k$T._randomPointInsideUnitCircle(k$m._tempDirectionPoint,k$c),k$d[17]=k$c.seed):k$T._randomPointInsideUnitCircle(k$m._tempDirectionPoint),k$e=k$m._tempDirectionPoint.elements,k$g[0]=k$e[0]*k$l,k$g[1]=k$e[1]*k$l):(k$g[0]=k$i*k$l,k$g[1]=k$j*k$l),k$g[2]=k$k;break;case 2:k$c?(k$c.seed=k$d[16],k$T._randomPointInsideUnitCircle(k$m._tempPositionPoint,k$c)):k$T._randomPointInsideUnitCircle(k$m._tempPositionPoint),k$i=k$h[0],k$j=k$h[1],k$f[0]=k$i*this.radius,k$f[1]=k$j*this.radius,k$g[k$f[2]=0]=k$i*k$l,k$g[1]=k$j*k$l,k$g[2]=k$k,k$gb.normalize(k$b,k$b),k$c?(k$gb.scale(k$b,this.length*k$c.getFloat(),k$b),k$d[16]=k$c.seed):k$gb.scale(k$b,this.length*Math.random(),k$b),k$gb.add(k$a,k$b,k$a),this.randomDirection&&(k$c?(k$c.seed=k$d[17],k$T._randomPointUnitSphere(k$b,k$c),k$d[17]=k$c.seed):k$T._randomPointUnitSphere(k$b));break;case 3:k$c?(k$c.seed=k$d[16],k$T._randomPointUnitCircle(k$m._tempPositionPoint,k$c)):k$T._randomPointUnitCircle(k$m._tempPositionPoint),k$i=k$h[0],k$j=k$h[1],k$f[0]=k$i*this.radius,k$f[1]=k$j*this.radius,k$g[k$f[2]=0]=k$i*k$l,k$g[1]=k$j*k$l,k$g[2]=k$k,k$gb.normalize(k$b,k$b),k$c?(k$gb.scale(k$b,this.length*k$c.getFloat(),k$b),k$d[16]=k$c.seed):k$gb.scale(k$b,this.length*Math.random(),k$b),k$gb.add(k$a,k$b,k$a),this.randomDirection&&(k$c?(k$c.seed=k$d[17],k$T._randomPointUnitSphere(k$b,k$c),k$d[17]=k$c.seed):k$T._randomPointUnitSphere(k$b));break;default:throw new Error("ConeShape:emitType is invalid.")}},k$a.cloneTo=function(k$a){k$c.prototype.cloneTo.call(this,k$a);var k$b=k$a;k$b.angle=this.angle,k$b.radius=this.radius,k$b.length=this.length,k$b.emitType=this.emitType,k$b.randomDirection=this.randomDirection},k$l(k$m,["_tempPositionPoint",function(){return this._tempPositionPoint=new k$fb},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new k$fb}])}(k$O),function(k$c){function k$a(){this.radius=NaN,this.emitFromShell=!1,k$a.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}k$n(k$a,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",k$c);var k$b=k$a.prototype;k$b._getShapeBoundBox=function(k$a){var k$b=k$a.min.elements;k$b[0]=k$b[1]=k$b[2]=-this.radius;var k$c=k$a.max.elements;k$c[0]=k$c[1]=this.radius,k$c[2]=0},k$b._getSpeedBoundBox=function(k$a){var k$b=k$a.min.elements;k$b[0]=k$b[1]=-1,k$b[2]=0;var k$c=k$a.max.elements;k$c[0]=k$c[1]=k$c[2]=1},k$b.generatePositionAndDirection=function(k$a,k$b,k$c,k$d){var k$e=k$a.elements;k$c?(k$c.seed=k$d[16],this.emitFromShell?k$T._randomPointUnitSphere(k$a,k$c):k$T._randomPointInsideUnitSphere(k$a,k$c),k$d[16]=k$c.seed):this.emitFromShell?k$T._randomPointUnitSphere(k$a):k$T._randomPointInsideUnitSphere(k$a),k$gb.scale(k$a,this.radius,k$a);var k$f=k$e[2];k$f<0&&(k$e[2]=-1*k$f),this.randomDirection?k$c?(k$c.seed=k$d[17],k$T._randomPointUnitSphere(k$b,k$c),k$d[17]=k$c.seed):k$T._randomPointUnitSphere(k$b):k$a.cloneTo(k$b)},k$b.cloneTo=function(k$a){k$c.prototype.cloneTo.call(this,k$a);var k$b=k$a;k$b.radius=this.radius,k$b.emitFromShell=this.emitFromShell,k$b.randomDirection=this.randomDirection}}(k$O),function(k$c){function k$a(){this.radius=NaN,this.emitFromShell=!1,k$a.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}k$n(k$a,"laya.d3.core.particleShuriKen.module.shape.SphereShape",k$c);var k$b=k$a.prototype;k$b._getShapeBoundBox=function(k$a){var k$b=k$a.min.elements;k$b[0]=k$b[1]=k$b[2]=-this.radius;var k$c=k$a.max.elements;k$c[0]=k$c[1]=k$c[2]=this.radius},k$b._getSpeedBoundBox=function(k$a){var k$b=k$a.min.elements;k$b[0]=k$b[1]=k$b[2]=-1;var k$c=k$a.max.elements;k$c[0]=k$c[1]=k$c[2]=1},k$b.generatePositionAndDirection=function(k$a,k$b,k$c,k$d){k$c?(k$c.seed=k$d[16],this.emitFromShell?k$T._randomPointUnitSphere(k$a,k$c):k$T._randomPointInsideUnitSphere(k$a,k$c),k$d[16]=k$c.seed):this.emitFromShell?k$T._randomPointUnitSphere(k$a):k$T._randomPointInsideUnitSphere(k$a),k$gb.scale(k$a,this.radius,k$a),this.randomDirection?k$c?(k$c.seed=k$d[17],k$T._randomPointUnitSphere(k$b,k$c),k$d[17]=k$c.seed):k$T._randomPointUnitSphere(k$b):k$a.cloneTo(k$b)},k$b.cloneTo=function(k$a){k$c.prototype.cloneTo.call(this,k$a);var k$b=k$a;k$b.radius=this.radius,k$b.emitFromShell=this.emitFromShell,k$b.randomDirection=this.randomDirection}}(k$O),function(k$a){function k$b(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,k$b.__super.call(this)}return k$n(k$b,"laya.d3.core.render.SubMeshRenderElement",k$W),k$b}()),k$Ab=function(k$a){function k$q(k$a,k$b,k$c,k$d,k$e,k$f){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=k$a,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[k$nb.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[k$Vb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[k$Vb.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[k$Eb.SHADERDEFINE_ALPHATEST]="ALPHATEST";k$q.__super.call(this,k$a,k$b,k$c,null,{}),this._attributeMap=k$d;var k$g;for(k$g in k$e){var k$h=k$e[k$g];switch(k$h[1]){case 0:this._renderElementUniformMap[k$g]=k$h[0];break;case 1:this._materialUniformMap[k$g]=k$h[0];break;case 2:this._spriteUniformMap[k$g]=k$h[0];break;case 3:this._cameraUniformMap[k$g]=k$h[0];break;case 4:this._sceneUniformMap[k$g]=k$h[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}k$n(k$q,"laya.d3.shader.ShaderCompile3D",k$t);var k$b=k$q.prototype;return k$b._definesToNameDic=function(k$a,k$b){for(var k$c={},k$d=1,k$e=0;k$e<32&&!(k$a<(k$d=1<<k$e));k$e++)if(k$a&k$d){var k$f=k$b[k$d];k$f&&(k$c[k$f]="")}return k$c},k$b.withCompile=function(k$a,k$b,k$c,k$d){var k$e,k$f,k$g;if(k$f=this.sharders[k$a])if(k$g=k$f[k$b]){if(k$e=k$g[k$c])return k$e}else k$g=k$f[k$b]=[];else k$g=(k$f=this.sharders[k$a]=[])[k$b]=[];var k$h,k$i=this._definesToNameDic(k$a,k$q._globalInt2name),k$j=this._definesToNameDic(k$b,this._spriteInt2name),k$k=this._definesToNameDic(k$c,this._materialInt2name),k$l={},k$m="";if(k$i)for(k$h in k$i)k$m+="#define "+k$h+"\n",k$l[k$h]=!0;if(k$j)for(k$h in k$j)k$m+="#define "+k$h+"\n",k$l[k$h]=!0;if(k$k)for(k$h in k$k)k$m+="#define "+k$h+"\n",k$l[k$h]=!0;var k$n=k$Lb.nameKey.getName(this._name)+" compile ("+k$a+","+k$b+","+k$c+")",k$o=this._VS.toscript(k$l,[]),k$p=this._PS.toscript(k$l,[]);k$H.now();if(k$e=k$Lb.create(k$m+k$o.join("\n"),k$m+k$p.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,k$d,k$n),k$g[k$c]=k$e,laya.d3.shader.ShaderCompile3D.debugMode)k$H.now();return k$e},k$b.precompileShaderWithShaderDefine=function(k$a,k$b,k$c){this.withCompile(k$a,k$b,k$c,!0)},k$b.addMaterialDefines=function(k$a){var k$b=k$a.defines;for(var k$c in k$b){var k$d=k$b[k$c],k$e=parseInt(k$c);this._materialInt2name[k$e]=k$d,this._materialName2Int[k$d]=k$e}},k$b.addSpriteDefines=function(k$a){var k$b=k$a.defines;for(var k$c in k$b){var k$d=k$b[k$c],k$e=parseInt(k$c);this._spriteInt2name[k$e]=k$d,this._spriteName2Int[k$d]=k$e}},k$b.getMaterialDefineByName=function(k$a){return this._materialName2Int[k$a]},k$b.registerMaterialDefine=function(k$a){var k$b=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[k$b]=k$a,this._materialName2Int[k$a]=k$b},k$b.registerSpriteDefine=function(k$a){var k$b=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[k$b]=k$a,this._spriteName2Int[k$a]=k$b},k$q._globalRegDefine=function(k$a,k$b){k$q._globalInt2name[k$b]=k$a},k$q.add=function(k$a,k$b,k$c,k$d,k$e){return laya.d3.shader.ShaderCompile3D._preCompileShader[k$a]=new k$q(k$a,k$b,k$c,k$d,k$e,k$t.includes)},k$q.get=function(k$a){return laya.d3.shader.ShaderCompile3D._preCompileShader[k$Lb.nameKey.getID(k$a)]},k$q._preCompileShader={},k$q._globalInt2name=[],k$q.debugMode=!1,k$q.SHADERDEFINE_HIGHPRECISION=1,k$q.SHADERDEFINE_FOG=4,k$q.SHADERDEFINE_DIRECTIONLIGHT=8,k$q.SHADERDEFINE_POINTLIGHT=16,k$q.SHADERDEFINE_SPOTLIGHT=32,k$q.SHADERDEFINE_UV0=64,k$q.SHADERDEFINE_COLOR=128,k$q.SHADERDEFINE_UV1=256,k$q.SAHDERDEFINE_DEPTHFOG=131072,k$q}(),k$Bb=function(k$a){function k$o(){k$o.__super.call(this)}k$n(k$o,"laya.d3.graphics.MeshSprite3DStaticBatchManager",k$da);var k$b=k$o.prototype;return k$b._getStaticBatch=function(k$a,k$b,k$c,k$d){var k$e,k$f;return k$f=k$a?k$a.id.toString()+k$c.id.toString()+k$b.id.toString()+k$d.toString():k$c.id.toString()+k$b.id.toString()+k$d.toString(),this._staticBatches[k$f]?k$e=this._staticBatches[k$f]:this._staticBatches[k$f]=k$e=new k$Cb(k$f,this,k$a,k$b,k$c),k$e},k$b._initStaticBatchs=function(k$a){var k$b,k$c;this._initBatchRenderElements.sort(k$o._sortPrepareStaticBatch);for(var k$d,k$e=!1,k$f=0,k$g=0,k$h=this._initBatchRenderElements.length;k$g<k$h;k$g++){var k$i,k$j=this._initBatchRenderElements[k$g],k$k=k$j.renderObj._getVertexBuffer(0);k$j._sprite3D;if(k$c===k$k.vertexDeclaration&&k$b===k$j._material)if(k$e)k$d._addCombineBatchRenderObjTest(k$j)?(k$i=k$j._staticBatch)!==k$d&&(k$i&&k$i._deleteCombineBatchRenderObj(k$j),k$d._addCombineBatchRenderObj(k$j)):(k$e=!1,k$f++);else{var k$l=this._initBatchRenderElements[k$g-1],k$m=k$l.renderObj,k$n=k$j.renderObj;k$e=!(65535<k$m._getVertexBuffer().vertexCount+k$n._getVertexBuffer().vertexCount)&&(k$d=this._getStaticBatch(k$a,k$c,k$b,k$f),(k$i=k$l._staticBatch)!==k$d&&(k$i&&k$i._deleteCombineBatchRenderObj(k$l),k$d._addCombineBatchRenderObj(k$l)),(k$i=k$j._staticBatch)!==k$d&&(k$i&&k$i._deleteCombineBatchRenderObj(k$j),k$d._addCombineBatchRenderObj(k$j)),!0)}else k$e=!1,k$f=0;k$b=k$j._material,k$c=k$k.vertexDeclaration}},k$o._sortPrepareStaticBatch=function(k$a,k$b){var k$c=k$a._render,k$d=k$b._render,k$e=k$c.lightmapIndex-k$d.lightmapIndex;if(0!=k$e)return k$e;var k$f=k$c.receiveShadow-k$d.receiveShadow;if(0!=k$f)return k$f;var k$g=k$a._mainSortID-k$b._mainSortID;return 0==k$g?k$a.renderObj.triangleCount-k$b.renderObj.triangleCount:k$g},k$o}(),k$Cb=function(k$a){function k$f(k$a,k$b,k$c,k$d,k$e){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,k$f.__super.call(this,k$a,k$b,k$c),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=k$d,this._material=k$e}k$n(k$f,"laya.d3.graphics.SubMeshStaticBatch",k$ea);var k$b=k$f.prototype;return k$b._compareBatchRenderElement=function(k$a,k$b){return k$a._batchIndexStart>k$b._batchIndexStart},k$b._addCombineBatchRenderObjTest=function(k$a){var k$b=k$a.renderObj._vertexCount;return!(65535<(0<k$b?this._currentCombineVertexCount+k$b:this._currentCombineVertexCount+k$a.renderObj._getVertexBuffer().vertexCount))},k$b._addCombineBatchRenderObj=function(k$a){var k$b=k$a.renderObj,k$c=k$b._vertexCount;this._initBatchRenderElements.push(k$a),k$a._staticBatch=this,0<k$c?(this._currentCombineIndexCount+=k$b._indexCount,this._currentCombineVertexCount+=k$c):(this._currentCombineIndexCount=this._currentCombineIndexCount+k$b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+k$b._getVertexBuffer().vertexCount),this._needFinishCombine=!0},k$b._deleteCombineBatchRenderObj=function(k$a){var k$b=k$a.renderObj,k$c=this._initBatchRenderElements.indexOf(k$a);if(-1!==k$c){this._initBatchRenderElements.splice(k$c,1),k$a._staticBatch=null;var k$d=k$b._vertexCount;0<k$d?(this._currentCombineIndexCount=this._currentCombineIndexCount-k$b._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-k$d):(this._currentCombineIndexCount=this._currentCombineIndexCount-k$b._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-k$b._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},k$b._finishInit=function(){if(this._needFinishCombine){var k$a=0,k$b=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var k$c=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),k$d=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=k$Ob.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=k$Nb.create("ushort",this._currentCombineIndexCount,35044);for(var k$e=0,k$f=this._initBatchRenderElements.length;k$e<k$f;k$e++){var k$g=this._initBatchRenderElements[k$e],k$h=k$g.renderObj,k$i=k$h._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,k$g._sprite3D),k$j=k$h.getIndices(),k$k=k$g._sprite3D.transform._isFrontFaceInvert,k$l=k$a/(this._vertexDeclaration.vertexStride/4)-k$h._vertexStart,k$m=k$b,k$n=k$m+k$j.length;k$g._batchIndexStart=k$m,k$g._batchIndexEnd=k$n,k$d.set(k$j,k$b);var k$o=0;if(k$k)for(k$o=k$m;k$o<k$n;k$o+=3){k$d[k$o]=k$l+k$d[k$o];var k$p=k$d[k$o+1],k$q=k$d[k$o+2];k$d[k$o+1]=k$l+k$q,k$d[k$o+2]=k$l+k$p}else for(k$o=k$m;k$o<k$n;k$o+=3)k$d[k$o]=k$l+k$d[k$o],k$d[k$o+1]=k$l+k$d[k$o+1],k$d[k$o+2]=k$l+k$d[k$o+2];k$b+=k$j.length,k$c.set(k$i,k$a),k$a+=k$i.length}this._vertexBuffer.setData(k$c),this._indexBuffer.setData(k$d),this._needFinishCombine=!1}},k$b._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new k$zb)},k$b._getRenderElement=function(k$a,k$b,k$c){for(var k$d,k$e,k$f=this._batchRenderElements.length,k$g=!0,k$h=0;k$h<k$f;k$h++){var k$i,k$j,k$k=(k$e=this._batchRenderElements[k$h])._sprite3D._render;if(0!==k$h&&(k$g=(k$i=(k$d=this._batchRenderElements[k$h-1])._sprite3D._render).lightmapIndex!==k$k.lightmapIndex||k$i.receiveShadow!==k$k.receiveShadow||k$d._batchIndexEnd!==k$e._batchIndexStart),k$g){(k$j=this._getCombineRenderElementFromPool()).renderObj=this,k$j._material=this._material,k$j._batchIndexStart=k$e._batchIndexStart,k$j._batchIndexEnd=k$e._batchIndexEnd;var k$l=k$k.lightmapIndex,k$m=k$l+1,k$n=this._batchOwnerIndices[k$m];k$n||(k$n=this._batchOwnerIndices[k$m]=[]);var k$o,k$p=k$n[k$e._render.receiveShadow?1:0];void 0===k$p?(k$n[k$k.receiveShadow?1:0]=this._batchOwners.length,(k$o=new k$Xb(null,"StaticBatchMeshSprite3D"))._scene=k$b,k$o._transform=this._rootOwner?this._rootOwner._transform:null,k$o._render.lightmapIndex=k$l,k$o._render.receiveShadow=k$e._render.receiveShadow,this._batchOwners.push(k$o)):k$o=this._batchOwners[k$p],k$o._render._renderUpdate(k$c),k$j._sprite3D=k$o,k$a.push(k$j)}else k$j._batchIndexEnd=k$e._batchIndexEnd}},k$b._beforeRender=function(k$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},k$b._render=function(k$a){var k$b=k$a.renderElement,k$c=k$b._batchIndexStart,k$d=k$b._batchIndexEnd-k$c;k$F.mainContext.drawElements(4,k$d,5123,2*k$c),k$A.drawCall++,k$A.trianglesFaces+=k$d/3},k$b.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},k$b._getVertexBuffer=function(k$a){return void 0===k$a&&(k$a=0),this._vertexBuffer},k$f}(),k$Db=function(k$a){function k$b(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,k$b.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}k$n(k$b,"laya.d3.core.ComponentNode",k$j);var k$c=k$b.prototype;return k$c.addComponent=function(k$a){var k$b,k$c=this._componentsMap.indexOf(k$a);if(-1===k$c)k$b=[],this._componentsMap.push(k$a),this._typeComponentsIndices.push(k$b);else if(k$b=this._typeComponentsIndices[k$c],this._components[k$b[0]].isSingleton)throw new Error("无法单实例创建"+k$a+"组件，"+k$a+"组件已存在！");var k$d=k$e.getInstance(k$a);return k$b.push(this._components.length),this._components.push(k$d),k$d instanceof laya.d3.component.Script&&this._scripts.push(k$d),k$d._initialize(this),k$d},k$c._removeComponent=function(k$a,k$b){var k$c=this._typeComponentsIndices[k$a],k$d=k$c[k$b],k$e=this._components[k$d];this._components.splice(k$d,1),k$e instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(k$e),1),k$c.splice(k$b,1),0===k$c.length&&(this._typeComponentsIndices.splice(k$a,1),this._componentsMap.splice(k$a,1));for(var k$f=0,k$g=this._componentsMap.length;k$f<k$g;k$f++)for(var k$h=(k$c=this._typeComponentsIndices[k$f]).length-1;0<=k$h;k$h--){var k$i=k$c[k$h];if(!(k$d<k$i))break;k$c[k$h]=--k$i}k$e._destroy()},k$c.getComponentByType=function(k$a,k$b){void 0===k$b&&(k$b=0);var k$c=this._componentsMap.indexOf(k$a);return-1===k$c?null:this._components[this._typeComponentsIndices[k$c][k$b]]},k$c.getComponentsByType=function(k$a,k$b){var k$c=this._componentsMap.indexOf(k$a);if(-1!==k$c){var k$d=this._typeComponentsIndices[k$c],k$e=k$d.length;k$b.length=k$e;for(var k$f=0;k$f<k$e;k$f++)k$b[k$f]=this._components[k$d[k$f]]}else k$b.length=0},k$c.getComponentByIndex=function(k$a){return this._components[k$a]},k$c.removeComponentByType=function(k$a,k$b){void 0===k$b&&(k$b=0);var k$c=this._componentsMap.indexOf(k$a);-1!==k$c&&this._removeComponent(k$c,k$b)},k$c.removeComponentsByType=function(k$a){var k$b=this._componentsMap.indexOf(k$a);if(-1!==k$b)for(var k$c=this._typeComponentsIndices[k$b],k$d=0,k$e=k$c.length;k$d<k$e;k$c.length<k$e?k$e--:k$d++)this._removeComponent(k$b,k$d)},k$c.removeAllComponent=function(){for(var k$a=0,k$b=this._componentsMap.length;k$a<k$b;this._componentsMap.length<k$b?k$b--:k$a++)this.removeComponentsByType(this._componentsMap[k$a])},k$c._updateComponents=function(k$a){for(var k$b=0,k$c=this._components.length;k$b<k$c;k$b++){var k$d=this._components[k$b];!k$d.started&&(k$d._start(k$a),k$d.started=!0),k$d.enable&&k$d._update(k$a)}},k$c._lateUpdateComponents=function(k$a){for(var k$b=0;k$b<this._components.length;k$b++){var k$c=this._components[k$b];!k$c.started&&(k$c._start(k$a),k$c.started=!0),k$c.enable&&k$c._lateUpdate(k$a)}},k$c._preRenderUpdateComponents=function(k$a){for(var k$b=0;k$b<this._components.length;k$b++){var k$c=this._components[k$b];!k$c.started&&(k$c._start(k$a),k$c.started=!0),k$c.enable&&k$c._preRenderUpdate(k$a)}},k$c._postRenderUpdateComponents=function(k$a){for(var k$b=0;k$b<this._components.length;k$b++){var k$c=this._components[k$b];!k$c.started&&(k$c._start(k$a),k$c.started=!0),k$c.enable&&k$c._postRenderUpdate(k$a)}},k$b}(),k$Eb=function(k$d){function k$a(){k$a.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new k$mb,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new k$hb(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}k$n(k$a,"laya.d3.core.material.BaseMaterial",k$d);var k$b=k$a.prototype;return k$x.imps(k$b,{"laya.d3.core.IClone":!0}),k$b._addShaderDefine=function(k$a){this._shaderDefineValue|=k$a},k$b._removeShaderDefine=function(k$a){this._shaderDefineValue&=~k$a},k$b._addDisablePublicShaderDefine=function(k$a){this._disablePublicShaderDefine|=k$a},k$b._removeDisablePublicShaderDefine=function(k$a){this._disablePublicShaderDefine&=~k$a},k$b._setBuffer=function(k$a,k$b){this._shaderValues.setValue(k$a,k$b),this._values[k$a]=k$b},k$b._getBuffer=function(k$a){return this._values[k$a]},k$b._setMatrix4x4=function(k$a,k$b){this._shaderValues.setValue(k$a,k$b?k$b.elements:null),this._values[k$a]=k$b},k$b._getMatrix4x4=function(k$a){return this._values[k$a]},k$b._setInt=function(k$a,k$b){this._shaderValues.setValue(k$a,k$b),this._values[k$a]=k$b},k$b._getInt=function(k$a){return this._values[k$a]},k$b._setNumber=function(k$a,k$b){this._shaderValues.setValue(k$a,k$b),this._values[k$a]=k$b},k$b._getNumber=function(k$a){return this._values[k$a]},k$b._setBool=function(k$a,k$b){this._shaderValues.setValue(k$a,k$b),this._values[k$a]=k$b},k$b._getBool=function(k$a){return this._values[k$a]},k$b._setVector2=function(k$a,k$b){this._shaderValues.setValue(k$a,k$b?k$b.elements:null),this._values[k$a]=k$b},k$b._getVector2=function(k$a){return this._values[k$a]},k$b._setColor=function(k$a,k$b){this._shaderValues.setValue(k$a,k$b?k$b.elements:null),this._values[k$a]=k$b},k$b._getColor=function(k$a){return this._values[k$a]},k$b._setTexture=function(k$a,k$b){var k$c=this._values[k$a];this._values[k$a]=k$b,this._shaderValues.setValue(k$a,k$b),0<this.referenceCount&&(k$c&&k$c._removeReference(),k$b&&k$b._addReference())},k$b._getTexture=function(k$a){return this._values[k$a]},k$b._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},k$b._getShader=function(k$a,k$b,k$c){var k$d=(k$a|k$b)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(k$d,k$c,this._shaderDefineValue),this._shader},k$b._setRenderStateBlendDepth=function(){var k$a=k$F.mainContext;switch(k$G.setDepthMask(k$a,this.depthWrite),0===this.depthTest?k$G.setDepthTest(k$a,!1):(k$G.setDepthTest(k$a,!0),k$G.setDepthFunc(k$a,this.depthTest)),this.blend){case 0:k$G.setBlend(k$a,!1);break;case 1:k$G.setBlend(k$a,!0),k$G.setBlendFunc(k$a,this.srcBlend,this.dstBlend);break;case 2:k$G.setBlend(k$a,!0)}},k$b._setRenderStateFrontFace=function(k$a,k$b){var k$c=k$F.mainContext,k$d=0;switch(this.cull){case 0:k$G.setCullFace(k$c,!1);break;case 1:k$G.setCullFace(k$c,!0),k$d=k$a?k$b&&k$b._isFrontFaceInvert?2305:2304:k$b&&k$b._isFrontFaceInvert?2304:2305,k$G.setFrontFace(k$c,k$d);break;case 2:k$G.setCullFace(k$c,!0),k$d=k$a?k$b&&k$b._isFrontFaceInvert?2304:2305:k$b&&k$b._isFrontFaceInvert?2305:2304,k$G.setFrontFace(k$c,k$d)}},k$b.onAsynLoaded=function(k$a,k$b,k$c){var k$d=k$b[0],k$e=k$b[1];switch(k$d.version){case"LAYAMATERIAL:01":var k$f=0,k$g=0,k$h=k$d.props;for(var k$i in k$h)switch(k$i){case"vectors":var k$j=k$h[k$i];for(k$f=0,k$g=k$j.length;k$f<k$g;k$f++){var k$k=k$j[k$f],k$l=k$k.value;switch(k$l.length){case 2:this[k$k.name]=new k$fb(k$l[0],k$l[1]);break;case 3:this[k$k.name]=new k$gb(k$l[0],k$l[1],k$l[2]);break;case 4:this[k$k.name]=new k$hb(k$l[0],k$l[1],k$l[2],k$l[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var k$m=k$h[k$i];for(k$f=0,k$g=k$m.length;k$f<k$g;k$f++){var k$n=k$m[k$f],k$o=k$n.path;k$o&&(this[k$n.name]=k$r.getRes(k$e[k$o]))}break;case"defines":var k$p=k$h[k$i];for(k$f=0,k$g=k$p.length;k$f<k$g;k$f++){var k$q=this._shaderCompile.getMaterialDefineByName(k$p[k$f]);this._addShaderDefine(k$q)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[k$i]=k$h[k$i];break;case"renderQueue":switch(k$h[k$i]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[k$i]=k$h[k$i]}break;case"LAYAMATERIAL:02":for(k$i in k$h=k$d.props)switch(k$i){case"vectors":for(k$f=0,k$g=(k$j=k$h[k$i]).length;k$f<k$g;k$f++)switch((k$l=(k$k=k$j[k$f]).value).length){case 2:this[k$k.name]=new k$fb(k$l[0],k$l[1]);break;case 3:this[k$k.name]=new k$gb(k$l[0],k$l[1],k$l[2]);break;case 4:this[k$k.name]=new k$hb(k$l[0],k$l[1],k$l[2],k$l[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(k$f=0,k$g=(k$m=k$h[k$i]).length;k$f<k$g;k$f++)(k$o=(k$n=k$m[k$f]).path)&&(this[k$n.name]=k$r.getRes(k$e[k$o]));break;case"defines":for(k$f=0,k$g=(k$p=k$h[k$i]).length;k$f<k$g;k$f++)k$q=this._shaderCompile.getMaterialDefineByName(k$p[k$f]),this._addShaderDefine(k$q);break;default:this[k$i]=k$h[k$i]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},k$b._addReference=function(){k$d.prototype._addReference.call(this);for(var k$a=0,k$b=this._values.length;k$a<k$b;k$a++){var k$c=this._values[k$a];k$c&&k$c instanceof laya.d3.resource.BaseTexture&&k$c._addReference()}},k$b._removeReference=function(){k$d.prototype._removeReference.call(this);for(var k$a=0,k$b=this._values.length;k$a<k$b;k$a++){var k$c=this._values[k$a];k$c&&k$c instanceof laya.d3.resource.BaseTexture&&k$c._removeReference()}},k$b.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},k$b.setShaderName=function(k$a){var k$b=k$Lb.nameKey.getID(k$a);if(-1===k$b)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=k$Ab._preCompileShader[k$b]},k$b.cloneTo=function(k$a){var k$b=k$a;k$b.name=this.name,k$b.cull=this.cull,k$b.blend=this.blend,k$b.srcBlend=this.srcBlend,k$b.dstBlend=this.dstBlend,k$b.srcBlendRGB=this.srcBlendRGB,k$b.dstBlendRGB=this.dstBlendRGB,k$b.srcBlendAlpha=this.srcBlendAlpha,k$b.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(k$b.blendConstColor),k$b.blendEquation=this.blendEquation,k$b.blendEquationRGB=this.blendEquationRGB,k$b.blendEquationAlpha=this.blendEquationAlpha,k$b.depthTest=this.depthTest,k$b.depthWrite=this.depthWrite,k$b.renderQueue=this.renderQueue,k$b._shader=this._shader,k$b._disablePublicShaderDefine=this._disablePublicShaderDefine,k$b._shaderDefineValue=this._shaderDefineValue;var k$c,k$d=0,k$e=k$b._shaderValues;k$b._shaderValues.data.length=this._shaderValues.data.length;var k$f=this._values.length,k$g=k$b._values;for(k$d=0,k$c=k$g.length=k$f;k$d<k$c;k$d++){var k$h=this._values[k$d];if(k$h)if("number"==typeof k$h)k$g[k$d]=k$h,k$e.data[k$d]=k$h;else if("number"==typeof k$h&&Math.floor(k$h)==k$h)k$g[k$d]=k$h,k$e.data[k$d]=k$h;else if("boolean"==typeof k$h)k$g[k$d]=k$h,k$e.data[k$d]=k$h;else if(k$h instanceof laya.d3.math.Vector2){var k$i=k$g[k$d]||(k$g[k$d]=new k$fb);k$h.cloneTo(k$i),k$e.data[k$d]=k$i.elements}else if(k$h instanceof laya.d3.math.Vector3){var k$j=k$g[k$d]||(k$g[k$d]=new k$gb);k$h.cloneTo(k$j),k$e.data[k$d]=k$j.elements}else if(k$h instanceof laya.d3.math.Vector4){var k$k=k$g[k$d]||(k$g[k$d]=new k$hb);k$h.cloneTo(k$k),k$e.data[k$d]=k$k.elements}else if(k$h instanceof laya.d3.math.Matrix4x4){var k$l=k$g[k$d]||(k$g[k$d]=new k$ab);k$h.cloneTo(k$l),k$e.data[k$d]=k$l.elements}else k$h instanceof laya.d3.resource.BaseTexture&&(k$g[k$d]=k$h,k$e.data[k$d]=k$h)}},k$b.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$o(0,k$b,"alphaTestValue",function(){return this._getNumber(0)},function(k$a){this._setNumber(0,k$a)}),k$o(0,k$b,"alphaTest",function(){return this._alphaTest},function(k$a){(this._alphaTest=k$a)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),k$a.__init__=function(){k$a.SHADERDEFINE_ALPHATEST=k$a.shaderDefines.registerDefine("ALPHATEST")},k$a.RENDERQUEUE_OPAQUE=2e3,k$a.RENDERQUEUE_ALPHATEST=2450,k$a.RENDERQUEUE_TRANSPARENT=3e3,k$a.CULL_NONE=0,k$a.CULL_FRONT=1,k$a.CULL_BACK=2,k$a.BLEND_DISABLE=0,k$a.BLEND_ENABLE_ALL=1,k$a.BLEND_ENABLE_SEPERATE=2,k$a.BLENDPARAM_ZERO=0,k$a.BLENDPARAM_ONE=1,k$a.BLENDPARAM_SRC_COLOR=768,k$a.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,k$a.BLENDPARAM_DST_COLOR=774,k$a.BLENDPARAM_ONE_MINUS_DST_COLOR=775,k$a.BLENDPARAM_SRC_ALPHA=770,k$a.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,k$a.BLENDPARAM_DST_ALPHA=772,k$a.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,k$a.BLENDPARAM_SRC_ALPHA_SATURATE=776,k$a.BLENDEQUATION_ADD=0,k$a.BLENDEQUATION_SUBTRACT=1,k$a.BLENDEQUATION_REVERSE_SUBTRACT=2,k$a.DEPTHTEST_OFF=0,k$a.DEPTHTEST_NEVER=512,k$a.DEPTHTEST_LESS=513,k$a.DEPTHTEST_EQUAL=514,k$a.DEPTHTEST_LEQUAL=515,k$a.DEPTHTEST_GREATER=516,k$a.DEPTHTEST_NOTEQUAL=517,k$a.DEPTHTEST_GEQUAL=518,k$a.DEPTHTEST_ALWAYS=519,k$a.SHADERDEFINE_ALPHATEST=1,k$a.ALPHATESTVALUE=0,k$l(k$a,["shaderDefines",function(){return this.shaderDefines=new k$kb}]),k$a}(k$q),k$Fb=function(k$a){function k$b(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,k$b.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}k$n(k$b,"laya.d3.resource.BaseTexture",k$q);var k$c=k$b.prototype;return k$o(0,k$c,"width",function(){return this._width}),k$o(0,k$c,"repeat",function(){return this._repeat},function(k$a){if(this._repeat!==k$a&&(this._repeat=k$a,this._source)){var k$b=k$F.mainContext;k$G.bindTexture(k$b,this._type,this._source),k$w.isPOT(this._width,this._height)&&this._repeat?(k$b.texParameteri(this._type,10242,10497),k$b.texParameteri(this._type,10243,10497)):(k$b.texParameteri(this._type,10242,33071),k$b.texParameteri(this._type,10243,33071))}}),k$o(0,k$c,"height",function(){return this._height}),k$o(0,k$c,"magFifter",function(){return this._magFifter},function(k$a){(this._magFifter=k$a)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(k$a)}),k$o(0,k$c,"wrapModeV",function(){return this._wrapModeV}),k$o(0,k$c,"size",function(){return this._size}),k$o(0,k$c,"wrapModeU",function(){return this._wrapModeU}),k$o(0,k$c,"mipmap",function(){return this._mipmap},function(k$a){this._mipmap=k$a,this._mipmap!=k$a&&this._conchTexture&&this._conchTexture.setMipMap(k$a)}),k$o(0,k$c,"minFifter",function(){return this._minFifter},function(k$a){this._minFifter=k$a,this._minFifter!=k$a&&this._conchTexture&&this._conchTexture.setMinFifter(k$a)}),k$o(0,k$c,"format",function(){return this._format}),k$o(0,k$c,"source",function(){return this.activeResource(),this._source}),k$o(0,k$c,"defaulteTexture",function(){return k$Sb.grayTexture}),k$b.WARPMODE_REPEAT=0,k$b.WARPMODE_CLAMP=1,k$b}(),k$Gb=function(k$a){function k$b(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,k$b.__super.call(this),this._boundingBoxCorners=k$d(8,null)}k$n(k$b,"laya.d3.resource.models.BaseMesh",k$q);var k$c=k$b.prototype;return k$c._getPositions=function(){throw new Error("未Override,请重载该属性！")},k$c._generateBoundingObject=function(){this._boundingSphere=new k$_a(new k$gb,0),k$_a.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new k$Za(new k$gb,new k$gb),k$Za.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},k$c.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},k$c.getRenderElement=function(k$a){throw new Error("未Override,请重载该属性！")},k$o(0,k$c,"subMeshCount",function(){return this._subMeshCount}),k$o(0,k$c,"boundingBox",function(){return this._boundingBox}),k$o(0,k$c,"boundingBoxCorners",function(){return this._boundingBoxCorners}),k$o(0,k$c,"boundingSphere",function(){return this._boundingSphere}),k$b}(),k$Hb=(function(k$a){function k$b(){k$b.__super.call(this)}k$n(k$b,"laya.d3.component.Script",k$tb);var k$c=k$b.prototype;k$c.onTriggerEnter=function(k$a){},k$c.onTriggerExit=function(k$a){},k$c.onTriggerStay=function(k$a){},k$o(0,k$c,"isSingleton",function(){return k$b._isSingleton}),k$b._isSingleton=!1}(),function(k$a){function k$b(k$a){this._owner=null,this._sharedMesh=null,k$b.__super.call(this),this._owner=k$a}k$n(k$b,"laya.d3.core.MeshFilter",k$a);var k$c=k$b.prototype;return k$c._sharedMeshLoaded=function(){this.event("loaded")},k$c._destroy=function(){k$a.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},k$o(0,k$c,"sharedMesh",function(){return this._sharedMesh},function(k$a){var k$b=this._sharedMesh;k$b&&k$b._removeReference(),(this._sharedMesh=k$a)._addReference(),this.event("meshchanged",[this,k$b,k$a]),k$a.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),k$o(0,k$c,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),k$o(0,k$c,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),k$o(0,k$c,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),k$o(0,k$c,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),k$b}(k$wb)),k$Ib=function(k$a){function k$b(k$a){k$b.__super.call(this,k$a),k$a.meshFilter.on("meshchanged",this,this._onMeshChanged)}k$n(k$b,"laya.d3.core.MeshRender",k$xb);var k$c=k$b.prototype;return k$c._onMeshChanged=function(k$a,k$b,k$c){k$c.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:k$c.once("loaded",this,this._onMeshLoaed)},k$c._onMeshLoaed=function(k$a,k$b){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},k$c._calculateBoundingSphereByInitSphere=function(k$a){var k$b=NaN,k$c=this._owner.transform,k$d=k$c.scale.elements,k$e=Math.abs(k$d[0]),k$f=Math.abs(k$d[1]),k$g=Math.abs(k$d[2]);k$b=k$f<=k$e&&k$g<=k$e?k$e:k$g<=k$f?k$f:k$g,k$gb.transformCoordinate(k$a.center,k$c.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=k$a.radius*k$b},k$c._calculateBoundBoxByInitCorners=function(k$a){for(var k$b=this._owner.transform.worldMatrix,k$c=0;k$c<8;k$c++)k$gb.transformCoordinate(k$a[k$c],k$b,k$xb._tempBoundBoxCorners[k$c]);k$Za.createfromPoints(k$xb._tempBoundBoxCorners,this._boundingBox)},k$c._calculateBoundingSphere=function(){var k$a=this._owner.meshFilter.sharedMesh;null==k$a||null==k$a.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(k$a.boundingSphere)},k$c._calculateBoundingBox=function(){var k$a=this._owner.meshFilter.sharedMesh;null==k$a||null==k$a.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(k$a.boundingBoxCorners)},k$c._renderUpdate=function(k$a){var k$b=this._owner.transform;if(k$b){this._setShaderValueMatrix4x4(0,k$b.worldMatrix);var k$c=this._owner.getProjectionViewWorldMatrix(k$a);this._setShaderValueMatrix4x4(1,k$c)}else this._setShaderValueMatrix4x4(0,k$ab.DEFAULT),this._setShaderValueMatrix4x4(1,k$a);return k$rb.debugMode&&this._renderRenderableBoundBox(),!0},k$b}(),k$Jb=function(k$b){function k$d(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,k$d.__super.call(this),this._renderState=new k$Y,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new k$mb,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new k$ba,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new k$gb(.7,.7,.7),this.ambientColor=new k$gb(.212,.227,.259),k$F.shaderHighPrecision&&this.addShaderDefine(k$Ab.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}k$n(k$d,"laya.d3.core.scene.Scene",k$b);var k$a=k$d.prototype;return k$x.imps(k$a,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),k$a._setUrl=function(k$a){this._url=k$a},k$a._getGroup=function(){return this._group},k$a._setGroup=function(k$a){this._group=k$a},k$a._display=function(){k$x.stage._scenes.push(this),k$x.stage._scenes.sort(k$d._sortScenes);for(var k$a=0,k$b=this._childs.length;k$a<k$b;k$a++){var k$c=this._childs[k$a];k$c.active&&k$c._activeHierarchy()}},k$a._unDisplay=function(){var k$a=k$x.stage._scenes;k$a.splice(k$a.indexOf(this),1);for(var k$b=0,k$c=this._childs.length;k$b<k$c;k$b++){var k$d=this._childs[k$b];k$d.active&&k$d._inActiveHierarchy()}},k$a._addChild3D=function(k$a){k$a.transform._onWorldTransform(),k$a._setBelongScene(this),this.displayedInStage&&k$a.active&&k$a._activeHierarchy()},k$a._removeChild3D=function(k$a){k$a.transform.parent=null,this.displayedInStage&&k$a.active&&k$a._inActiveHierarchy(),k$a._setUnBelongScene()},k$a.initOctree=function(k$a,k$b,k$c,k$d,k$e){void 0===k$e&&(k$e=6),this.treeSize=new k$gb(k$a,k$b,k$c),this.treeLevel=k$e,this.treeRoot=new k$Z(this,0),this.treeRoot.init(k$d,this.treeSize)},k$a._prepareUpdateToRenderState=function(k$a,k$b){k$b.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,k$b.scene=this},k$a._prepareSceneToRender=function(k$a){var k$b=this._lights.length;if(0<k$b)for(var k$c=0,k$d=0;k$d<k$b&&!(this._lights[k$d]._prepareToScene(k$a)&&++k$c>=this._enableLightCount);k$d++);},k$a._updateChilds=function(k$a){for(var k$b=0,k$c=this._childs.length;k$b<k$c;++k$b)this._childs[k$b]._update(k$a)},k$a._preRenderScene=function(k$a,k$b,k$c){var k$d,k$e=k$b._viewMatrix,k$f=k$b._projectionMatrix,k$g=k$b._projectionViewMatrix,k$h=0,k$i=k$b.camera;for(k$i.useOcclusionCulling?this.treeRoot?k$ca.renderObjectCullingOctree(k$c,this,k$i,k$e,k$f,k$g):k$ca.renderObjectCulling(k$c,this,k$i,k$e,k$f,k$g):k$ca.renderObjectCullingNoBoundFrustum(this,k$i,k$e,k$f,k$g),k$h=0,k$d=this._quenes.length;k$h<k$d;k$h++)this._quenes[k$h]&&this._quenes[k$h]._preRender(k$b)},k$a._clear=function(k$a,k$b){var k$c=k$b._viewport,k$d=k$b.camera,k$e=k$c.x,k$f=k$d.renderTargetSize.height-k$c.y-k$c.height,k$g=k$c.width,k$h=k$c.height;k$a.viewport(k$e,k$f,k$g,k$h);var k$i=256,k$j=k$d.renderTarget;switch(k$d.clearFlag){case 0:var k$k=k$d.clearColor;if(k$k){k$a.enable(3089),k$a.scissor(k$e,k$f,k$g,k$h);var k$l=k$k.elements;k$a.clearColor(k$l[0],k$l[1],k$l[2],k$l[3]),k$i|=16384}if(k$j)switch(k$k||(k$i=16384),k$j.depthStencilFormat){case 33189:k$i|=256;break;case 36168:k$i|=1024;break;case 34041:k$i|=256,k$i|=1024}k$a.clear(k$i),k$k&&k$a.disable(3089);break;case 1:case 2:if(k$j)switch(k$i=16384,k$j.depthStencilFormat){case 33189:k$i|=256;break;case 36168:k$i|=1024;break;case 34041:k$i|=256,k$i|=1024}k$a.clear(k$i);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},k$a._renderScene=function(k$a,k$b){var k$c,k$d,k$e=k$b.camera,k$f=0;for(k$f=0;k$f<2;k$f++)(k$d=this._quenes[k$f])&&(k$e.renderTarget?k$d._render(k$b,!0):k$d._render(k$b,!1));if(1===k$e.clearFlag){var k$g=k$e.sky;k$g&&(k$G.setCullFace(k$a,!1),k$G.setDepthFunc(k$a,515),k$G.setDepthMask(k$a,!1),k$g._render(k$b),k$G.setDepthFunc(k$a,513),k$G.setDepthMask(k$a,!0))}for(k$f=2,k$c=this._quenes.length;k$f<k$c;k$f++)(k$d=this._quenes[k$f])&&(k$d._sortAlpha(k$b.camera.transform.position),k$e.renderTarget?k$d._render(k$b,!0):k$d._render(k$b,!1))},k$a._set3DRenderConfig=function(k$a){k$a.disable(3042),k$G._blend=!1,k$a.blendFunc(770,771),k$G._sFactor=770,k$G._dFactor=771,k$a.disable(2929),k$G._depthTest=!1,k$a.enable(2884),k$G._cullFace=!0,k$a.depthMask(1),k$G._depthMask=!0,k$a.frontFace(2304),k$G._frontFace=2304},k$a._set2DRenderConfig=function(k$a){k$G.setBlend(k$a,!0),k$G.setBlendFunc(k$a,1,771),k$G.setDepthTest(k$a,!1),k$G.setCullFace(k$a,!1),k$G.setDepthMask(k$a,!0),k$G.setFrontFace(k$a,2305),k$a.viewport(0,0,k$k.width,k$k.height)},k$a._parseCustomProps=function(k$a,k$b,k$c,k$d){var k$e=k$d.customProps.lightmaps,k$f=k$e.length,k$g=this._lightmaps;k$g.length=k$f;for(var k$h=0;k$h<k$f;k$h++)k$g[k$h]=k$r.getRes(k$b[k$e[k$h].replace(".exr",".png")]);this.setlightmaps(k$g);var k$i=k$d.customProps.ambientColor;k$i&&(this.ambientColor=new k$gb(k$i[0],k$i[1],k$i[2]));var k$j=k$d.customProps.fogColor;k$j&&(this.fogColor=new k$gb(k$j[0],k$j[1],k$j[2]))},k$a._addLight=function(k$a){this._lights.indexOf(k$a)<0&&this._lights.push(k$a)},k$a._removeLight=function(k$a){var k$b=this._lights.indexOf(k$a);0<=k$b&&this._lights.splice(k$b,1)},k$a._updateScene=function(){var k$a=this._renderState;this._prepareUpdateToRenderState(k$F.mainContext,k$a),this._updateComponents(k$a),this._updateChilds(k$a),this._lateUpdateComponents(k$a),this._time+=k$a.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},k$a._updateSceneConch=function(){var k$a=this._renderState;this._prepareUpdateToRenderState(k$F.mainContext,k$a),this._updateComponents(k$a),this._lateUpdateComponents(k$a),this._prepareSceneToRender(k$a);for(var k$b=0,k$c=this._cameraPool.length;k$b<k$c;k$b++){var k$d=this._cameraPool[k$b];(k$a.camera=k$d)._prepareCameraToRender()}},k$a._preRenderShadow=function(k$a,k$b,k$c,k$d,k$e){this.treeRoot?k$ca.renderShadowObjectCullingOctree(this,k$b,k$c,k$d,k$e):k$ca.renderShadowObjectCulling(this,k$b,k$c,k$d,k$e);for(var k$f=0,k$g=k$c.length;k$f<k$g;k$f++)k$c[k$f]&&k$c[k$f]._preRender(k$a)},k$a._renderShadowMap=function(k$a,k$b,k$c){var k$d=this.parallelSplitShadowMaps[0];k$d._calcAllLightCameraInfo(k$c);var k$e,k$f,k$g,k$h=k$d.PSSMNum;if(this._preRenderShadow(k$b,k$d._lightCulling,k$d._shadowQuenes,k$d._lightVPMatrix[0],k$h),this.addShaderDefine(k$nb.SHADERDEFINE_CAST_SHADOW),1<k$h)for(var k$i=0;k$i<k$h;k$i++)k$e=k$d.getRenderTarget(k$i+1),k$d.beginRenderTarget(k$i+1),k$a.clearColor(1,1,1,1),k$a.clear(16640),k$a.viewport(0,0,k$e.width,k$e.height),k$b.camera=k$g=k$d.getLightCamera(k$i),k$g._prepareCameraToRender(),k$g._prepareCameraViewProject(k$g.viewMatrix,k$g.projectionMatrix),k$b._projectionViewMatrix=k$d._lightVPMatrix[k$i+1],(k$f=k$d._shadowQuenes[k$i])._preRender(k$b),k$f._renderShadow(k$b,!1),k$d.endRenderTarget(k$i+1);else k$e=k$d.getRenderTarget(1),k$d.beginRenderTarget(1),k$a.clearColor(1,1,1,1),k$a.clear(16640),k$a.viewport(0,0,k$e.width,k$e.height),k$b.camera=k$g=k$d.getLightCamera(0),k$g._prepareCameraToRender(),k$g._prepareCameraViewProject(k$g.viewMatrix,k$g.projectionMatrix),k$b._projectionViewMatrix=k$d._lightVPMatrix[0],(k$f=k$d._shadowQuenes[0])._preRender(k$b),k$f._renderShadow(k$b,!0),k$d.endRenderTarget(1);this.removeShaderDefine(k$nb.SHADERDEFINE_CAST_SHADOW)},k$a.addTreeNode=function(k$a){this.treeRoot.addTreeNode(k$a)},k$a.removeTreeNode=function(k$a){this.treeSize&&k$a._treeNode&&k$a._treeNode.removeObject(k$a)},k$a.setlightmaps=function(k$a){this._lightmaps=k$a;for(var k$b=0,k$c=this._renderableSprite3Ds.length;k$b<k$c;k$b++)this._renderableSprite3Ds[k$b]._render._applyLightMapParams()},k$a.getlightmaps=function(){return this._lightmaps},k$a.addChildAt=function(k$a,k$b){if(!(k$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(k$a&&k$a.__className));if(!k$a||this.destroyed||k$a===this)return k$a;if(k$a.zOrder&&this._set$P("hasZorder",!0),0<=k$b&&k$b<=this._childs.length){if(k$a._parent===this){var k$c=this.getChildIndex(k$a);this._childs.splice(k$c,1),this._childs.splice(k$b,0,k$a),this.conchModel&&(this.conchModel.removeChild(k$a.conchModel),this.conchModel.addChildAt(k$a.conchModel,k$b)),this._childChanged()}else k$a.parent&&k$a.parent.removeChild(k$a),this._childs===k$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(k$b,0,k$a),this.conchModel&&this.conchModel.addChildAt(k$a.conchModel,k$b),(k$a.parent=this)._addChild3D(k$a);return k$a}throw new Error("appendChildAt:The index is out of bounds")},k$a.addChild=function(k$a){if(!(k$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!k$a||this.destroyed||k$a===this)return k$a;if(k$a.zOrder&&this._set$P("hasZorder",!0),k$a._parent===this){var k$b=this.getChildIndex(k$a);k$b!==this._childs.length-1&&(this._childs.splice(k$b,1),this._childs.push(k$a),this.conchModel&&(this.conchModel.removeChild(k$a.conchModel),this.conchModel.addChildAt(k$a.conchModel,this._childs.length-1)),this._childChanged())}else k$a.parent&&k$a.parent.removeChild(k$a),this._childs===k$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(k$a),this.conchModel&&this.conchModel.addChildAt(k$a.conchModel,this._childs.length-1),(k$a.parent=this)._childChanged(),this._addChild3D(k$a);return k$a},k$a.removeChildAt=function(k$a){var k$b=this.getChildAt(k$a);return k$b&&(this._removeChild3D(k$b),this._childs.splice(k$a,1),this.conchModel&&this.conchModel.removeChild(k$b.conchModel),k$b.parent=null),k$b},k$a.removeChildren=function(k$a,k$b){if(void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=2147483647),this._childs&&0<this._childs.length){var k$c=this._childs;if(0===k$a&&k$f<=k$b){var k$d=k$c;this._childs=k$j.ARRAY_EMPTY}else k$d=k$c.splice(k$a,k$b-k$a);for(var k$e=0,k$f=k$d.length;k$e<k$f;k$e++)this._removeChild3D(k$d[k$e]),k$d[k$e].parent=null,this.conchModel&&this.conchModel.removeChild(k$d[k$e].conchModel)}return this},k$a.addFrustumCullingObject=function(k$a){this.treeRoot?this.addTreeNode(k$a):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(k$a):this._cullingRenders[this._cullingRendersLength]=k$a,k$a._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},k$a.removeFrustumCullingObject=function(k$a){if(this.treeRoot)this.removeTreeNode(k$a);else{this._cullingRendersLength--;var k$b=k$a._indexInSceneFrustumCullingObjects;if(k$b!==this._cullingRendersLength){var k$c=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[k$b]=k$c)._indexInSceneFrustumCullingObjects=k$b,k$a._indexInSceneFrustumCullingObjects=-1}}},k$a.getRenderQueue=function(k$a){return k$a<3e3?this._quenes[1]||(this._quenes[1]=new k$X(this)):this._quenes[2]||(this._quenes[2]=new k$X(this))},k$a.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new k$X(this)},k$a.addShaderDefine=function(k$a){this._shaderDefineValue|=k$a},k$a.removeShaderDefine=function(k$a){this._shaderDefineValue&=~k$a},k$a.addScript=function(k$a){return this._addComponent(k$a)},k$a.getScriptByType=function(k$a,k$b){return void 0===k$b&&(k$b=0),this._getComponentByType(k$a,k$b)},k$a.getScriptsByType=function(k$a,k$b){this._getComponentsByType(k$a,k$b)},k$a.getScriptByIndex=function(k$a){return this._getComponentByIndex(k$a)},k$a.removeScriptByType=function(k$a,k$b){void 0===k$b&&(k$b=0),this._removeComponentByType(k$a,k$b)},k$a.removeScriptsByType=function(k$a){this._removeComponentByType(k$a)},k$a.removeAllScript=function(){this._removeAllComponent()},k$a.render=function(k$a,k$b,k$c){(k$p._context.ctx._renderKey=0)<this._childs.length&&k$a.addRenderObject(this)},k$a.renderSubmit=function(){var k$a=k$F.mainContext,k$b=this._renderState;this._set3DRenderConfig(k$a),this._prepareSceneToRender(this._renderState);var k$c,k$d=0,k$e=0;if(k$rb.debugMode||k$Z.debugMode)for(k$d=0,k$e=this._cameraPool.length;k$d<k$e;k$d++)k$c=this._cameraPool[k$d],k$rb._debugPhasorSprite.begin(1,k$c),k$c.activeInHierarchy&&k$c._renderCamera(k$a,k$b,this),k$rb._debugPhasorSprite.end();else for(k$d=0,k$e=this._cameraPool.length;k$d<k$e;k$d++)(k$c=this._cameraPool[k$d]).activeInHierarchy&&k$c._renderCamera(k$a,k$b,this);return this._set2DRenderConfig(k$a),1},k$a.onAsynLoaded=function(k$a,k$b,k$c){var k$d=k$b[0];if("Scene"!==k$d.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var k$e=k$b[1];k$qb._createNodeByJson(this,k$d,this,k$e),this.event("hierarchyloaded",[this]),this.__loaded=!0},k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),this.destroyed||(k$b.prototype.destroy.call(this,k$a),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,k$r.clearRes(this.url),this.loaded||k$rb._cancelLoadByUrl(this.url))},k$a.getRenderType=function(){return 0},k$a.releaseRender=function(){},k$a._addComponent=function(k$a){var k$b,k$c=this._componentsMap.indexOf(k$a);if(-1===k$c)k$b=[],this._componentsMap.push(k$a),this._typeComponentsIndices.push(k$b);else if(k$b=this._typeComponentsIndices[k$c],this._components[k$b[0]].isSingleton)throw new Error("无法单实例创建"+k$a+"组件，"+k$a+"组件已存在！");var k$d=k$e.getInstance(k$a);k$b.push(this._components.length),this._components.push(k$d);return k$d._initialize(this),k$d},k$a._removeComponent=function(k$a,k$b){var k$c=this._typeComponentsIndices[k$a],k$d=k$c[k$b],k$e=this._components[k$d];this._components.splice(k$d,1),k$c.splice(k$b,1),0===k$c.length&&(this._typeComponentsIndices.splice(k$a,1),this._componentsMap.splice(k$a,1));for(var k$f=0,k$g=this._componentsMap.length;k$f<k$g;k$f++)for(var k$h=(k$c=this._typeComponentsIndices[k$f]).length-1;0<=k$h;k$h--){var k$i=k$c[k$h];if(!(k$d<k$i))break;k$c[k$h]=--k$i}k$e._destroy()},k$a._getComponentByType=function(k$a,k$b){void 0===k$b&&(k$b=0);var k$c=this._componentsMap.indexOf(k$a);return-1===k$c?null:this._components[this._typeComponentsIndices[k$c][k$b]]},k$a._getComponentsByType=function(k$a,k$b){var k$c=this._componentsMap.indexOf(k$a);if(-1!==k$c){var k$d=this._typeComponentsIndices[k$c],k$e=k$d.length;k$b.length=k$e;for(var k$f=0;k$f<k$e;k$f++)k$b[k$f]=this._components[k$d[k$f]]}else k$b.length=0},k$a._getComponentByIndex=function(k$a){return this._components[k$a]},k$a._removeComponentByType=function(k$a,k$b){void 0===k$b&&(k$b=0);var k$c=this._componentsMap.indexOf(k$a);-1!==k$c&&this._removeComponent(k$c,k$b)},k$a._removeComponentsByType=function(k$a){var k$b=this._componentsMap.indexOf(k$a);if(-1!==k$b)for(var k$c=this._typeComponentsIndices[k$b],k$d=0,k$e=k$c.length;k$d<k$e;k$c.length<k$e?k$e--:k$d++)this._removeComponent(k$b,k$d)},k$a._removeAllComponent=function(){for(var k$a=0,k$b=this._componentsMap.length;k$a<k$b;this._componentsMap.length<k$b?k$b--:k$a++)this._removeComponentsByType(this._componentsMap[k$a])},k$a._updateComponents=function(k$a){for(var k$b=0,k$c=this._components.length;k$b<k$c;k$b++){var k$d=this._components[k$b];!k$d.started&&(k$d._start(k$a),k$d.started=!0),k$d.enable&&k$d._update(k$a)}},k$a._lateUpdateComponents=function(k$a){for(var k$b=0;k$b<this._components.length;k$b++){var k$c=this._components[k$b];!k$c.started&&(k$c._start(k$a),k$c.started=!0),k$c.enable&&k$c._lateUpdate(k$a)}},k$a._preRenderUpdateComponents=function(k$a){for(var k$b=0;k$b<this._components.length;k$b++){var k$c=this._components[k$b];!k$c.started&&(k$c._start(k$a),k$c.started=!0),k$c.enable&&k$c._preRenderUpdate(k$a)}},k$a._postRenderUpdateComponents=function(k$a){for(var k$b=0;k$b<this._components.length;k$b++){var k$c=this._components[k$b];!k$c.started&&(k$c._start(k$a),k$c.started=!0),k$c.enable&&k$c._postRenderUpdate(k$a)}},k$o(0,k$a,"_loaded",null,function(k$a){this.__loaded=k$a}),k$o(0,k$a,"fogColor",function(){return this._fogColor},function(k$a){this._fogColor=k$a,this._shaderValues.setValue(0,k$a.elements)}),k$o(0,k$a,"enableFog",function(){return this._enableFog},function(k$a){this._enableFog!==k$a&&((this._enableFog=k$a)?(this.addShaderDefine(k$Ab.SHADERDEFINE_FOG),this.removeShaderDefine(k$Ab.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(k$Ab.SHADERDEFINE_FOG))}),k$o(0,k$a,"url",function(){return this._url}),k$o(0,k$a,"loaded",function(){return this.__loaded}),k$o(0,k$a,"enableDepthFog",function(){return this._enableDepthFog},function(k$a){this._enableDepthFog!=k$a&&((this._enableDepthFog=k$a)?(this.addShaderDefine(k$Ab.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(k$Ab.SHADERDEFINE_FOG)):this.removeShaderDefine(k$Ab.SAHDERDEFINE_DEPTHFOG))}),k$o(0,k$a,"fogStart",function(){return this._fogStart},function(k$a){this._fogStart=k$a,this._shaderValues.setValue(1,k$a)}),k$o(0,k$a,"fogRange",function(){return this._fogRange},function(k$a){this._fogRange=k$a,this._shaderValues.setValue(2,k$a)}),k$o(0,k$a,"ambientColor",function(){return this._ambientColor},function(k$a){this._ambientColor=k$a,this._shaderValues.setValue(21,k$a.elements)}),k$o(0,k$a,"scene",function(){return this}),k$o(0,k$a,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),k$d._sortScenes=function(k$a,k$b){if(k$a.parent!==k$x.stage||k$b.parent!==k$x.stage)return k$a.parent!==k$x.stage&&k$b.parent!==k$x.stage?k$d._sortScenes(k$a.parent,k$b.parent):k$a.parent===k$x.stage?-1:1;var k$c=k$x.stage._childs;return k$c.indexOf(k$a)-k$c.indexOf(k$b)},k$d.load=function(k$a){return k$x.loader.create(k$a,null,null,k$d)},k$d.FOGCOLOR=0,k$d.FOGSTART=1,k$d.FOGRANGE=2,k$d.LIGHTDIRECTION=3,k$d.LIGHTDIRCOLOR=4,k$d.POINTLIGHTPOS=5,k$d.POINTLIGHTRANGE=6,k$d.POINTLIGHTATTENUATION=7,k$d.POINTLIGHTCOLOR=8,k$d.SPOTLIGHTPOS=9,k$d.SPOTLIGHTDIRECTION=10,k$d.SPOTLIGHTSPOT=11,k$d.SPOTLIGHTRANGE=12,k$d.SPOTLIGHTATTENUATION=13,k$d.SPOTLIGHTCOLOR=14,k$d.SHADOWDISTANCE=15,k$d.SHADOWLIGHTVIEWPROJECT=16,k$d.SHADOWMAPPCFOFFSET=17,k$d.SHADOWMAPTEXTURE1=18,k$d.SHADOWMAPTEXTURE2=19,k$d.SHADOWMAPTEXTURE3=20,k$d.AMBIENTCOLOR=21,k$d.TIME=22,k$d}(k$z),k$Kb=function(k$a){function k$b(k$a){k$b.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new k$ab,this._shaderValues=new k$mb,this._colliders=[],this._id=++k$b._uniqueIDCounter,this._transform=new k$yb(this),this.name=k$a||"Sprite3D-"+k$b._nameNumberCounter++,this.layer=k$I.currentCreationLayer,this.active=!0}k$n(k$b,"laya.d3.core.Sprite3D",k$Db);var k$c=k$b.prototype;return k$x.imps(k$c,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),k$c._setUrl=function(k$a){this._url=k$a},k$c._getGroup=function(){return this._group},k$c._setGroup=function(k$a){this._group=k$a},k$c._addChild3D=function(k$a){k$a.transform.parent=this.transform,this._hierarchyAnimator&&(!k$a._hierarchyAnimator&&k$a._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(k$a,!0,[k$a.name])),this._scene&&(k$a._setBelongScene(this._scene),this._activeInHierarchy&&k$a._active&&k$a._activeHierarchy())},k$c._removeChild3D=function(k$a){k$a.transform.parent=null,this._scene&&(this._activeInHierarchy&&k$a._active&&k$a._inActiveHierarchy(),k$a._setUnBelongScene()),this._hierarchyAnimator&&(k$a._hierarchyAnimator==this._hierarchyAnimator&&k$a._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(k$a,!1,[k$a.name]))},k$c._parseBaseCustomProps=function(k$a){var k$b=this.transform.localPosition;k$a.translate?(k$b.fromArray(k$a.translate),k$b.x*=100,k$b.y*=100,k$b.z*=100):k$b.elements.fill(0),this.transform.localPosition=k$b;var k$c=this.transform.localRotation;k$a.rotation?k$c.fromArray(k$a.rotation):k$c.fromArray([0,0,0,-1]),this.transform.localRotation=k$c;var k$d=this.transform.localScale;k$a.scale?k$d.fromArray(k$a.scale):k$d.elements.fill(1),this.transform.localScale=k$d;var k$e=k$a.layer;null!=k$e&&(this.layer=k$I.getLayerByNumber(k$e))},k$c._parseCustomComponent=function(k$a,k$b,k$c){for(var k$d in k$c){var k$e=k$c[k$d];switch(k$d){case"Animator":var k$f=this.addComponent(Animator);if(k$e.avatarPath)k$f.avatar=k$r.getRes(k$b[k$e.avatarPath]);else{var k$g=k$e.avatar;if(k$g){k$f.avatar=k$r.getRes(k$b[k$g.path]);var k$h=k$g.linkSprites;k$h&&k$a.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[k$f,k$h])}}for(var k$i=k$e.clipPaths,k$j=k$i.length,k$k=0;k$k<k$j;k$k++)k$f.addClip(k$r.getRes(k$b[k$i[k$k]]));k$f.clip=k$r.getRes(k$b[k$i[0]]);var k$l=k$e.playOnWake;void 0!==k$l&&(k$f.playOnWake=k$l);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var k$m=this.addComponent(SphereCollider);k$m.isTrigger=k$e.isTrigger;var k$n=k$m.center;k$n.fromArray(k$e.center),k$m.center=k$n,k$m.radius=k$e.radius;break;case"BoxCollider":var k$o=this.addComponent(BoxCollider);k$o.isTrigger=k$e.isTrigger,k$o.center.fromArray(k$e.center);var k$p=k$o.size;k$p.fromArray(k$e.size),k$o.size=k$p;break;case"MeshCollider":this.addComponent(MeshCollider)}}},k$c._onRootNodeHierarchyLoaded=function(k$a,k$b){for(var k$c in k$b){for(var k$d=this,k$e=k$b[k$c],k$f=0,k$g=k$e.length;k$f<k$g;k$f++){var k$h=k$e[k$f];if(""===k$h)break;if(!(k$d=k$d.getChildByName(k$h)))break}k$d&&k$a.linkSprite3DToAvatarNode(k$c,k$d)}},k$c._setHierarchyAnimator=function(k$a,k$b){this._changeHierarchyAnimator(k$a);for(var k$c=0,k$d=this._childs.length;k$c<k$d;k$c++){var k$e=this._childs[k$c];k$e._hierarchyAnimator==k$b&&k$e._setHierarchyAnimator(k$a,k$b)}},k$c._clearHierarchyAnimator=function(k$a,k$b){this._changeHierarchyAnimator(k$b);for(var k$c=0,k$d=this._childs.length;k$c<k$d;k$c++){var k$e=this._childs[k$c];k$e._hierarchyAnimator==k$a&&k$e._clearHierarchyAnimator(k$a,k$b)}},k$c._getAnimatorToLinkSprite3D=function(k$a,k$b,k$c){var k$d=this.getComponentByType(Animator);if(k$d&&(k$d.avatar?k$d.avatar._version||k$a._setAnimatorToLinkAvatar(k$d,k$b):k$a._setAnimatorToLinkSprite3DNoAvatar(k$d,k$b,k$c)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){k$c.unshift(this._parent.name);var k$e=this._parent;k$e._hierarchyAnimator&&k$e._getAnimatorToLinkSprite3D(k$a,k$b,k$c)}},k$c._setAnimatorToLinkSprite3DNoAvatar=function(k$a,k$b,k$c){var k$d=0,k$e=0;for(k$d=0,k$e=k$a.getClipCount();k$d<k$e;k$d++)k$a._handleSpriteOwnersBySprite(k$d,k$b,k$c,this);for(k$d=0,k$e=this._childs.length;k$d<k$e;k$d++){var k$f=this._childs[k$d],k$g=k$c.length;k$c.push(k$f.name),k$f._setAnimatorToLinkSprite3DNoAvatar(k$a,k$b,k$c),k$c.splice(k$g,1)}},k$c._changeHierarchyAnimator=function(k$a){this._hierarchyAnimator=k$a},k$c._isLinkSpriteToAnimationNode=function(k$a,k$b,k$c){var k$d=k$a._avatarNodes.indexOf(k$b),k$e=k$a._cacheSpriteToNodesMap;if(k$c)this._transform.dummy=k$b.transform,k$a._cacheNodesToSpriteMap[k$d]=k$e.length,k$e.push(k$d);else{this._transform.dummy=null;var k$f=k$a._cacheNodesToSpriteMap[k$d];k$a._cacheNodesToSpriteMap[k$d]=null,k$e.splice(k$f,1)}},k$c._setBelongScene=function(k$a){this._scene=k$a;for(var k$b=0,k$c=this._childs.length;k$b<k$c;k$b++)this._childs[k$b]._setBelongScene(k$a)},k$c._setUnBelongScene=function(){this._scene=null;for(var k$a=0,k$b=this._childs.length;k$a<k$b;k$a++)this._childs[k$a]._setUnBelongScene()},k$c._activeHierarchy=function(){var k$a=0,k$b=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),k$a=0,k$b=this._colliders.length;k$a<k$b;k$a++)this._layer._addCollider(this._colliders[k$a]);for(this.event("activeinhierarchychanged",!0),k$a=0,k$b=this._childs.length;k$a<k$b;k$a++){var k$c=this._childs[k$a];k$c._active&&k$c._activeHierarchy()}},k$c._inActiveHierarchy=function(){var k$a=0,k$b=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),k$a=0,k$b=this._colliders.length;k$a<k$b;k$a++){var k$c=this._colliders[k$a];k$c._clearCollsionMap(),this._layer._removeCollider(k$c)}for(this.event("activeinhierarchychanged",!1),k$a=0,k$b=this._childs.length;k$a<k$b;k$a++){var k$d=this._childs[k$a];k$d._active&&k$d._inActiveHierarchy()}},k$c.addComponent=function(k$a){var k$b,k$c=this._componentsMap.indexOf(k$a);if(-1===k$c)k$b=[],this._componentsMap.push(k$a),this._typeComponentsIndices.push(k$b);else if(k$b=this._typeComponentsIndices[k$c],this._components[k$b[0]].isSingleton)throw new Error("无法单实例创建"+k$a+"组件，"+k$a+"组件已存在！");var k$d=k$e.getInstance(k$a);return k$b.push(this._components.length),this._components.push(k$d),k$d instanceof laya.d3.component.Script&&this._scripts.push(k$d),k$d._initialize(this),k$d},k$c._removeComponent=function(k$a,k$b){var k$c,k$d=0,k$e=this._typeComponentsIndices[k$a],k$f=k$e[k$b],k$g=this._components[k$f];for(k$g instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(k$g),1),k$e.splice(k$b,1),0===k$e.length&&(this._typeComponentsIndices.splice(k$a,1),this._componentsMap.splice(k$a,1)),k$d=0,k$c=this._componentsMap.length;k$d<k$c;k$d++)for(var k$h=(k$e=this._typeComponentsIndices[k$d]).length-1;0<=k$h;k$h--){var k$i=k$e[k$h];if(!(k$f<k$i))break;k$e[k$h]=--k$i}k$g._destroy()},k$c._clearSelfRenderObjects=function(){},k$c._addSelfRenderObjects=function(){},k$c._parseCustomProps=function(k$a,k$b,k$c,k$d){},k$c._updateChilds=function(k$a){var k$b=this._childs.length;if(0!==k$b)for(var k$c=0;k$c<k$b;++k$c)this._childs[k$c]._update(k$a)},k$c._getSortID=function(k$a,k$b){return 1e3*k$b.id+k$a._getVertexBuffer().vertexDeclaration.id},k$c._update=function(k$a){(k$a.owner=this)._activeInHierarchy&&(this._updateComponents(k$a),this._lateUpdateComponents(k$a),k$A.spriteCount++,this._childs.length&&this._updateChilds(k$a))},k$c.getProjectionViewWorldMatrix=function(k$a){return k$ab.multiply(k$a,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},k$c.loadHierarchy=function(k$a){this.addChild(laya.d3.core.Sprite3D.load(k$a))},k$c.addChildAt=function(k$a,k$b){if(!(k$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!k$a||this.destroyed||k$a===this)return k$a;if(k$a.zOrder&&this._set$P("hasZorder",!0),0<=k$b&&k$b<=this._childs.length){if(k$a._parent===this){var k$c=this.getChildIndex(k$a);this._childs.splice(k$c,1),this._childs.splice(k$b,0,k$a),this.conchModel&&(this.conchModel.removeChild(k$a.conchModel),this.conchModel.addChildAt(k$a.conchModel,k$b)),this._childChanged()}else k$a.parent&&k$a.parent.removeChild(k$a),this._childs===k$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(k$b,0,k$a),this.conchModel&&this.conchModel.addChildAt(k$a.conchModel,k$b),(k$a.parent=this)._addChild3D(k$a);return k$a}throw new Error("appendChildAt:The index is out of bounds")},k$c.addChild=function(k$a){if(!(k$a instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!k$a||this.destroyed||k$a===this)return k$a;if(k$a.zOrder&&this._set$P("hasZorder",!0),k$a._parent===this){var k$b=this.getChildIndex(k$a);k$b!==this._childs.length-1&&(this._childs.splice(k$b,1),this._childs.push(k$a),this.conchModel&&(this.conchModel.removeChild(k$a.conchModel),this.conchModel.addChildAt(k$a.conchModel,this._childs.length-1)),this._childChanged())}else k$a.parent&&k$a.parent.removeChild(k$a),this._childs===k$j.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(k$a),this.conchModel&&this.conchModel.addChildAt(k$a.conchModel,this._childs.length-1),(k$a.parent=this)._childChanged(),this._addChild3D(k$a);return k$a},k$c.removeChildAt=function(k$a){var k$b=this.getChildAt(k$a);return k$b&&(this._removeChild3D(k$b),this._childs.splice(k$a,1),this.conchModel&&this.conchModel.removeChild(k$b.conchModel),k$b.parent=null),k$b},k$c.removeChildren=function(k$a,k$b){if(void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=2147483647),this._childs&&0<this._childs.length){var k$c=this._childs;if(0===k$a&&k$f<=k$b){var k$d=k$c;this._childs=k$j.ARRAY_EMPTY}else k$d=k$c.splice(k$a,k$b-k$a);for(var k$e=0,k$f=k$d.length;k$e<k$f;k$e++)this._removeChild3D(k$d[k$e]),k$d[k$e].parent=null,this.conchModel&&this.conchModel.removeChild(k$d[k$e].conchModel)}return this},k$c.onAsynLoaded=function(k$a,k$b,k$c){var k$d=k$b[0];if("Sprite3D"!==k$d.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var k$e=k$b[1];k$qb._createNodeByJson(this,k$d,this,k$e),this.event("hierarchyloaded",[this]),this.__loaded=!0},k$c.cloneTo=function(k$a){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var k$b=k$a;k$b.name=this.name,k$b._destroyed=this._destroyed,k$b.timer=this.timer,k$b._$P=this._$P,k$b.active=this._active;var k$c=k$b.transform.localPosition;this.transform.localPosition.cloneTo(k$c),k$b.transform.localPosition=k$c;var k$d=k$b.transform.localRotation;this.transform.localRotation.cloneTo(k$d),k$b.transform.localRotation=k$d;var k$e=k$b.transform.localScale;this.transform.localScale.cloneTo(k$e),k$b.transform.localScale=k$e,k$b.isStatic=this.isStatic;var k$f=0,k$g=0;for(k$f=0,k$g=this._componentsMap.length;k$f<k$g;k$f++){var k$h=k$b.addComponent(this._componentsMap[k$f]);this._components[k$f]._cloneTo(k$h)}for(k$f=0,k$g=this._childs.length;k$f<k$g;k$f++)k$b.addChild(this._childs[k$f].clone());var k$i=k$b.getComponentByType(Animator);if(k$i){var k$j=k$i._linkSpritesData;if(k$j)for(var k$k in k$j){for(var k$l=k$j[k$k],k$m=k$b,k$n=0,k$o=k$l.length;k$n<k$o&&(k$m=k$m.getChildByName(k$l[k$n]));k$n++);if(k$m){var k$p=k$i._avatarNodeMap[k$k];k$m._isLinkSpriteToAnimationNode(k$i,k$p,!0)}}}},k$c.clone=function(){var k$a=new this.constructor;return this.cloneTo(k$a),k$a},k$c.destroy=function(k$a){if(void 0===k$a&&(k$a=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,k$a);var k$b,k$c=0;for(k$c=0,k$b=this._components.length;k$c<k$b;k$c++)this._components[k$c]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,k$r.clearRes(this.url),this.loaded||k$rb._cancelLoadByUrl(this.url)}},k$c._handleSpriteToAvatar=function(k$a,k$b){k$a._avatarNodes;var k$c=k$a._avatarNodeMap[this.name];k$c&&k$c.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(k$a,k$c,k$b)},k$c._setAnimatorToLinkAvatar=function(k$a,k$b){this._handleSpriteToAvatar(k$a,k$b);for(var k$c=0,k$d=this._childs.length;k$c<k$d;k$c++){this._childs[k$c]._setAnimatorToLinkAvatar(k$a,k$b)}},k$o(0,k$c,"activeInHierarchy",function(){return this._activeInHierarchy}),k$o(0,k$c,"_loaded",null,function(k$a){this.__loaded=k$a}),k$o(0,k$c,"active",function(){return this._active},function(k$a){this._active!==k$a&&(this._active=k$a,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(k$a?this._activeHierarchy():this._inActiveHierarchy()))}),k$o(0,k$c,"componentsCount",function(){return this._components.length}),k$o(0,k$c,"loaded",function(){return this.__loaded}),k$o(0,k$c,"id",function(){return this._id}),k$o(0,k$c,"url",function(){return this._url}),k$o(0,k$c,"layer",function(){return this._layer},function(k$a){if(this._layer!==k$a){if(!k$a)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var k$b=0,k$c=this._colliders.length;if(this._layer)for(k$b=0;k$b<k$c;k$b++)this._layer._removeCollider(this._colliders[k$b]);for(k$b=0;k$b<k$c;k$b++)k$a._addCollider(this._colliders[k$b])}this._layer=k$a,this.event("layerchanged",k$a)}}),k$o(0,k$c,"scene",function(){return this._scene}),k$o(0,k$c,"transform",function(){return this._transform}),k$b.instantiate=function(k$a,k$b,k$c,k$d,k$e){void 0===k$c&&(k$c=!0);var k$f=k$a.clone();k$b&&k$b.addChild(k$f);var k$g=k$f.transform;if(k$c){var k$h=k$g.worldMatrix;k$a.transform.worldMatrix.cloneTo(k$h),k$g.worldMatrix=k$h}else k$d&&(k$g.position=k$d),k$e&&(k$g.rotation=k$e);return k$f},k$b.load=function(k$a){return k$x.loader.create(k$a,null,null,k$b)},k$b.WORLDMATRIX=0,k$b.MVPMATRIX=1,k$b._uniqueIDCounter=0,k$b._nameNumberCounter=0,k$b}(),k$Lb=function(k$a){function k$k(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],k$k.__super.call(this),!k$a||!k$b)throw"Shader Error";this._id=++k$k._count,this._vs=k$a,this._ps=k$b,this._attributeMap=k$c,this._sceneUniformMap=k$d,this._cameraUniformMap=k$e,this._spriteUniformMap=k$f,this._materialUniformMap=k$g,this._renderElementUniformMap=k$h,this._precompile=k$i,this._define=k$j,this._precompile&&k$k.extCompileObj&&k$k.extCompileFunc?k$k.extCompileFunc.call(k$k.extCompileObj,k$a,k$b,k$j):this.recreateResource()}k$n(k$k,"laya.d3.shader.Shader3D",k$c);var k$b=k$k.prototype;return k$b.recreateResource=function(){k$H.now();this._compile(),this.completeCreate(),this.memorySize=0},k$b.disposeResource=function(){k$F.mainContext.deleteShader(this._vshader),k$F.mainContext.deleteShader(this._pshader),k$F.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},k$b._compile=function(){if(!k$F.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var k$a=[this._vs,this._ps],k$b=k$F.mainContext;if(this._program=k$b.createProgram(),this._vshader=k$k._createShader(k$b,k$a[0],35633),this._pshader=k$k._createShader(k$b,k$a[1],35632),k$b.attachShader(this._program,this._vshader),k$b.attachShader(this._program,this._pshader),k$b.linkProgram(this._program),!k$p.isConchApp&&k$Ab.debugMode&&!k$b.getProgramParameter(this._program,35714))throw k$b.getProgramInfoLog(this._program);var k$c,k$d=0,k$e=0,k$f=0;for(k$f=k$p.isConchApp?k$b.getProgramParameterEx(this._vs,this._ps,"",35721):k$b.getProgramParameter(this._program,35721),k$d=0;k$d<k$f;k$d++){var k$g=null;k$c={vartype:"attribute",ivartype:0,attrib:k$g=k$p.isConchApp?k$b.getActiveAttribEx(this._vs,this._ps,"",k$d):k$b.getActiveAttrib(this._program,k$d),location:k$b.getAttribLocation(this._program,k$g.name),name:k$g.name,type:k$g.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(k$c)}var k$h=0;for(k$h=k$p.isConchApp?k$b.getProgramParameterEx(this._vs,this._ps,"",35718):k$b.getProgramParameter(this._program,35718),k$d=0;k$d<k$h;k$d++){var k$i=null;k$i=k$p.isConchApp?k$b.getActiveUniformEx(this._vs,this._ps,"",k$d):k$b.getActiveUniform(this._program,k$d),0<(k$c={vartype:"uniform",ivartype:1,attrib:k$g,location:k$b.getUniformLocation(this._program,k$i.name),name:k$i.name,type:k$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(k$c.name=k$c.name.substr(0,k$c.name.length-3),k$c.isArray=!0,k$c.location=k$b.getUniformLocation(this._program,k$c.name)),this._uniformParams.push(k$c)}for(k$d=0,k$e=this._attributeParams.length;k$d<k$e;k$d++)(k$c=this._attributeParams[k$d]).indexOfParams=k$d,k$c.index=1,k$c.value=[k$c.location,null],k$c.codename=k$c.name,k$c.name=null!=this._attributeMap[k$c.codename]?this._attributeMap[k$c.codename]:k$c.codename,this._attributeParamsMap.push(k$c.name),this._attributeParamsMap.push(k$c),k$c._this=this,k$c.uploadedValue=[],k$c.fun=this._attribute;for(k$d=0,k$e=this._uniformParams.length;k$d<k$e;k$d++)switch((k$c=this._uniformParams[k$d]).indexOfParams=k$d,k$c.index=1,k$c.value=[k$c.location,null],k$c.codename=k$c.name,null!=this._sceneUniformMap[k$c.codename]?(k$c.name=this._sceneUniformMap[k$c.codename],this._sceneUniformParamsMap.push(k$c.name),this._sceneUniformParamsMap.push(k$c)):null!=this._cameraUniformMap[k$c.codename]?(k$c.name=this._cameraUniformMap[k$c.codename],this._cameraUniformParamsMap.push(k$c.name),this._cameraUniformParamsMap.push(k$c)):null!=this._spriteUniformMap[k$c.codename]?(k$c.name=this._spriteUniformMap[k$c.codename],this._spriteUniformParamsMap.push(k$c.name),this._spriteUniformParamsMap.push(k$c)):null!=this._materialUniformMap[k$c.codename]?(k$c.name=this._materialUniformMap[k$c.codename],this._materialUniformParamsMap.push(k$c.name),this._materialUniformParamsMap.push(k$c)):null!=this._renderElementUniformMap[k$c.codename]?(k$c.name=this._renderElementUniformMap[k$c.codename],this._renderElementUniformParamsMap.push(k$c.name),this._renderElementUniformParamsMap.push(k$c)):console.log("Shader:can't find uinform name:"+k$c.codename+" in shader file."),k$c._this=this,k$c.uploadedValue=[],k$c.type){case 5124:k$c.fun=k$c.isArray?this._uniform1iv:this._uniform1i;break;case 5126:k$c.fun=k$c.isArray?this._uniform1fv:this._uniform1f;break;case 35664:k$c.fun=k$c.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:k$c.fun=k$c.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:k$c.fun=k$c.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:k$c.fun=this._uniform_sampler2D;break;case 35680:k$c.fun=this._uniform_samplerCube;break;case 35676:k$c.fun=this._uniformMatrix4fv;break;case 35670:k$c.fun=this._uniform1i;break;case 35674:k$c.fun=this._uinformMatrix2fv;break;case 35675:k$c.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},k$b._attribute=function(k$a,k$b){var k$c=k$F.mainContext,k$d=k$h._enableAtributes,k$e=k$a.location;return k$d[k$e]||k$c.enableVertexAttribArray(k$e),k$c.vertexAttribPointer(k$e,k$b[0],k$b[1],k$b[2],k$b[3],k$b[4]),k$d[k$e]=k$h._bindVertexBuffer,1},k$b._uniform1f=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b?(k$F.mainContext.uniform1f(k$a.location,k$c[0]=k$b),1):0},k$b._uniform1fv=function(k$a,k$b){if(k$b.length<4){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]||k$c[2]!==k$b[2]||k$c[3]!==k$b[3]?(k$F.mainContext.uniform1fv(k$a.location,k$b),k$c[0]=k$b[0],k$c[1]=k$b[1],k$c[2]=k$b[2],k$c[3]=k$b[3],1):0}return k$F.mainContext.uniform1fv(k$a.location,k$b),1},k$b._uniform_vec2=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]?(k$F.mainContext.uniform2f(k$a.location,k$c[0]=k$b[0],k$c[1]=k$b[1]),1):0},k$b._uniform_vec2v=function(k$a,k$b){if(k$b.length<2){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]||k$c[2]!==k$b[2]||k$c[3]!==k$b[3]?(k$F.mainContext.uniform2fv(k$a.location,k$b),k$c[0]=k$b[0],k$c[1]=k$b[1],k$c[2]=k$b[2],k$c[3]=k$b[3],1):0}return k$F.mainContext.uniform2fv(k$a.location,k$b),1},k$b._uniform_vec3=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]||k$c[2]!==k$b[2]?(k$F.mainContext.uniform3f(k$a.location,k$c[0]=k$b[0],k$c[1]=k$b[1],k$c[2]=k$b[2]),1):0},k$b._uniform_vec3v=function(k$a,k$b){return k$F.mainContext.uniform3fv(k$a.location,k$b),1},k$b._uniform_vec4=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]||k$c[2]!==k$b[2]||k$c[3]!==k$b[3]?(k$F.mainContext.uniform4f(k$a.location,k$c[0]=k$b[0],k$c[1]=k$b[1],k$c[2]=k$b[2],k$c[3]=k$b[3]),1):0},k$b._uniform_vec4v=function(k$a,k$b){return k$F.mainContext.uniform4fv(k$a.location,k$b),1},k$b._uniformMatrix2fv=function(k$a,k$b){return k$F.mainContext.uniformMatrix2fv(k$a.location,!1,k$b),1},k$b._uniformMatrix3fv=function(k$a,k$b){return k$F.mainContext.uniformMatrix3fv(k$a.location,!1,k$b),1},k$b._uniformMatrix4fv=function(k$a,k$b){return k$F.mainContext.uniformMatrix4fv(k$a.location,!1,k$b),1},k$b._uinformMatrix2fv=function(k$a,k$b){return k$F.mainContext.uniformMatrix2fv(k$a.location,!1,k$b),1},k$b._uinformMatrix3fv=function(k$a,k$b){return k$F.mainContext.uniformMatrix3fv(k$a.location,!1,k$b),1},k$b._uniform1i=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b?(k$F.mainContext.uniform1i(k$a.location,k$c[0]=k$b),1):0},k$b._uniform1iv=function(k$a,k$b){return k$F.mainContext.uniform1iv(k$a.location,k$b),1},k$b._uniform_ivec2=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]?(k$F.mainContext.uniform2i(k$a.location,k$c[0]=k$b[0],k$c[1]=k$b[1]),1):0},k$b._uniform_ivec2v=function(k$a,k$b){return k$F.mainContext.uniform2iv(k$a.location,k$b),1},k$b._uniform_vec3i=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]||k$c[2]!==k$b[2]?(k$F.mainContext.uniform3i(k$a.location,k$c[0]=k$b[0],k$c[1]=k$b[1],k$c[2]=k$b[2]),1):0},k$b._uniform_vec3vi=function(k$a,k$b){return k$F.mainContext.uniform3iv(k$a.location,k$b),1},k$b._uniform_vec4i=function(k$a,k$b){var k$c=k$a.uploadedValue;return k$c[0]!==k$b[0]||k$c[1]!==k$b[1]||k$c[2]!==k$b[2]||k$c[3]!==k$b[3]?(k$F.mainContext.uniform4i(k$a.location,k$c[0]=k$b[0],k$c[1]=k$b[1],k$c[2]=k$b[2],k$c[3]=k$b[3]),1):0},k$b._uniform_vec4vi=function(k$a,k$b){return k$F.mainContext.uniform4iv(k$a.location,k$b),1},k$b._uniform_sampler2D=function(k$a,k$b){var k$c=k$b.source||k$b.defaulteTexture.source,k$d=k$F.mainContext,k$e=k$a.uploadedValue;if(null!=k$e[0])return k$d.activeTexture(k$k._TEXTURES[k$e[0]]),k$c&&k$G.bindTexture(k$d,3553,k$c),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return k$e[0]=this._curActTexIndex,k$d.uniform1i(k$a.location,this._curActTexIndex),k$d.activeTexture(k$k._TEXTURES[this._curActTexIndex]),k$c&&k$G.bindTexture(k$d,3553,k$c),this._curActTexIndex++,1},k$b._uniform_samplerCube=function(k$a,k$b){var k$c=k$b.source||k$b.defaulteTexture.source,k$d=k$F.mainContext,k$e=k$a.uploadedValue;if(null!=k$e[0])return k$d.activeTexture(k$k._TEXTURES[k$e[0]]),k$c?k$G.bindTexture(k$d,34067,k$c):k$G.bindTexture(k$d,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return k$e[0]=this._curActTexIndex,k$d.uniform1i(k$a.location,this._curActTexIndex),k$d.activeTexture(k$k._TEXTURES[this._curActTexIndex]),k$c?k$G.bindTexture(k$d,34067,k$c):k$G.bindTexture(k$d,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},k$b._noSetValue=function(k$a){console.log("no....:"+k$a.name)},k$b.bind=function(){return k$c.activeShader=this,(k$c.bindShader=this).activeResource(),k$G.UseProgram(this._program)},k$b.uploadAttributes=function(k$a,k$b){for(var k$c,k$d,k$e=0,k$f=0,k$g=this._attributeParamsMap.length;k$f<k$g;k$f+=2)k$d=this._attributeParamsMap[k$f+1],null!=(k$c=k$a[this._attributeParamsMap[k$f]])&&(k$b&&k$b[k$d.name]&&k$b[k$d.name].bind(),k$e+=k$d.fun.call(this,k$d,k$c));k$A.shaderCall+=k$e},k$b.uploadAttributesX=function(k$a,k$b){for(var k$c,k$d,k$e=0,k$f=0,k$g=this._attributeParamsMap.length;k$f<k$g;k$f+=2)k$d=this._attributeParamsMap[k$f+1],null!=(k$c=k$a[this._attributeParamsMap[k$f]])&&(k$b._bind(),k$e+=k$d.fun.call(this,k$d,k$c));k$A.shaderCall+=k$e},k$b.uploadSceneUniforms=function(k$a){for(var k$b,k$c,k$d=0,k$e=0,k$f=this._sceneUniformParamsMap.length;k$e<k$f;k$e+=2)k$c=this._sceneUniformParamsMap[k$e+1],null!=(k$b=k$a[this._sceneUniformParamsMap[k$e]])&&(k$d+=k$c.fun.call(this,k$c,k$b));k$A.shaderCall+=k$d},k$b.uploadCameraUniforms=function(k$a){for(var k$b,k$c,k$d=0,k$e=0,k$f=this._cameraUniformParamsMap.length;k$e<k$f;k$e+=2)k$c=this._cameraUniformParamsMap[k$e+1],null!=(k$b=k$a[this._cameraUniformParamsMap[k$e]])&&(k$d+=k$c.fun.call(this,k$c,k$b));k$A.shaderCall+=k$d},k$b.uploadSpriteUniforms=function(k$a){for(var k$b,k$c,k$d=0,k$e=0,k$f=this._spriteUniformParamsMap.length;k$e<k$f;k$e+=2)k$c=this._spriteUniformParamsMap[k$e+1],null!=(k$b=k$a[this._spriteUniformParamsMap[k$e]])&&(k$d+=k$c.fun.call(this,k$c,k$b));k$A.shaderCall+=k$d},k$b.uploadMaterialUniforms=function(k$a){for(var k$b,k$c,k$d=0,k$e=0,k$f=this._materialUniformParamsMap.length;k$e<k$f;k$e+=2)k$c=this._materialUniformParamsMap[k$e+1],null!=(k$b=k$a[this._materialUniformParamsMap[k$e]])&&(k$d+=k$c.fun.call(this,k$c,k$b));k$A.shaderCall+=k$d},k$b.uploadRenderElementUniforms=function(k$a){for(var k$b,k$c,k$d=0,k$e=0,k$f=this._renderElementUniformParamsMap.length;k$e<k$f;k$e+=2)k$c=this._renderElementUniformParamsMap[k$e+1],null!=(k$b=k$a[this._renderElementUniformParamsMap[k$e]])&&(k$d+=k$c.fun.call(this,k$c,k$b));k$A.shaderCall+=k$d},k$k.create=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){return new k$k(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j)},k$k.addInclude=function(k$a,k$b){k$t.addInclude(k$a,k$b)},k$k._createShader=function(k$a,k$b,k$c){var k$d=k$a.createShader(k$c);if(k$a.shaderSource(k$d,k$b),k$a.compileShader(k$d),k$Ab.debugMode&&!k$a.getShaderParameter(k$d,35713))throw k$a.getShaderInfoLog(k$d);return k$d},k$k.PERIOD_RENDERELEMENT=0,k$k.PERIOD_MATERIAL=1,k$k.PERIOD_SPRITE=2,k$k.PERIOD_CAMERA=3,k$k.PERIOD_SCENE=4,k$k._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],k$k._count=0,k$k._preCompile=!1,k$k.extCompileFunc=null,k$k.extCompileObj=null,k$l(k$k,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new k$B}]),k$k}(),k$Mb=function(k$h){function k$i(){this._transformUV=null,k$i.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new k$gb(.6,.6,.6)),this._setColor(10,new k$gb(1,1,1)),this._setColor(11,new k$hb(1,1,1,8)),this._setColor(12,new k$gb(1,1,1)),this._setColor(7,new k$hb(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new k$hb(1,1,0,0)),this.renderMode=1}k$n(k$i,"laya.d3.core.material.StandardMaterial",k$h);var k$a=k$i.prototype;return k$a.disableLight=function(){this._addDisablePublicShaderDefine(k$Ab.SHADERDEFINE_POINTLIGHT|k$Ab.SHADERDEFINE_SPOTLIGHT|k$Ab.SHADERDEFINE_DIRECTIONLIGHT)},k$a.disableFog=function(){this._addDisablePublicShaderDefine(k$Ab.SHADERDEFINE_FOG)},k$a.onAsynLoaded=function(k$a,k$b,k$c){var k$d=k$b[0];if(k$d.version)k$h.prototype.onAsynLoaded.call(this,k$a,k$b,k$c);else{var k$e=k$b[1],k$f=k$d.props;for(var k$g in k$f)this[k$g]=k$f[k$g];k$i._parseStandardMaterial(k$e,this,k$d),this._endLoaded()}},k$a.cloneTo=function(k$a){k$h.prototype.cloneTo.call(this,k$a);var k$b=k$a;this._transformUV&&(k$b._transformUV=this._transformUV.clone())},k$o(0,k$a,"ambientColor",function(){return this._getColor(9)},function(k$a){this._setColor(9,k$a)}),k$o(0,k$a,"ambientTexture",function(){return this._getTexture(5)},function(k$a){k$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,k$a)}),k$o(0,k$a,"renderMode",null,function(k$a){switch(k$a){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(k$i.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(k$a)}),k$o(0,k$a,"reflectColor",function(){return this._getColor(12)},function(k$a){this._setColor(12,k$a)}),k$o(0,k$a,"tilingOffset",function(){return this._getColor(15)},function(k$a){if(k$a){var k$b=k$a.elements;1!=k$b[0]||1!=k$b[1]||0!=k$b[2]||0!=k$b[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,k$a)}),k$o(0,k$a,"albedo",function(){return this._getColor(7)},function(k$a){this._setColor(7,k$a)}),k$o(0,k$a,"diffuseColor",function(){return this._getColor(10)},function(k$a){this._setColor(10,k$a)}),k$o(0,k$a,"albedoColor",function(){return this._getColor(7)},function(k$a){this._setColor(7,k$a)}),k$o(0,k$a,"specularColor",function(){return this._getColor(11)},function(k$a){this._setColor(11,k$a)}),k$o(0,k$a,"diffuseTexture",function(){return this._getTexture(1)},function(k$a){k$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,k$a)}),k$o(0,k$a,"normalTexture",function(){return this._getTexture(2)},function(k$a){k$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,k$a)}),k$o(0,k$a,"specularTexture",function(){return this._getTexture(3)},function(k$a){k$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,k$a)}),k$o(0,k$a,"emissiveTexture",function(){return this._getTexture(4)},function(k$a){k$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,k$a)}),k$o(0,k$a,"reflectTexture",function(){return this._getTexture(6)},function(k$a){k$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,k$a)}),k$o(0,k$a,"transformUV",function(){return this._transformUV},function(k$a){this._transformUV=k$a,this._setMatrix4x4(13,k$a.matrix),k$a?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,k$a.matrix.elements,0)}),k$i.__init__=function(){k$i.SHADERDEFINE_DIFFUSEMAP=k$i.shaderDefines.registerDefine("DIFFUSEMAP"),k$i.SHADERDEFINE_NORMALMAP=k$i.shaderDefines.registerDefine("NORMALMAP"),k$i.SHADERDEFINE_SPECULARMAP=k$i.shaderDefines.registerDefine("SPECULARMAP"),k$i.SHADERDEFINE_EMISSIVEMAP=k$i.shaderDefines.registerDefine("EMISSIVEMAP"),k$i.SHADERDEFINE_AMBIENTMAP=k$i.shaderDefines.registerDefine("AMBIENTMAP"),k$i.SHADERDEFINE_REFLECTMAP=k$i.shaderDefines.registerDefine("REFLECTMAP"),k$i.SHADERDEFINE_UVTRANSFORM=k$i.shaderDefines.registerDefine("UVTRANSFORM"),k$i.SHADERDEFINE_TILINGOFFSET=k$i.shaderDefines.registerDefine("TILINGOFFSET"),k$i.SHADERDEFINE_ADDTIVEFOG=k$i.shaderDefines.registerDefine("ADDTIVEFOG")},k$i.load=function(k$a){return k$x.loader.create(k$a,null,null,k$i)},k$i._parseStandardMaterial=function(k$a,k$b,k$c){var k$d=k$c.customProps,k$e=k$d.ambientColor;k$b.ambientColor=new k$gb(k$e[0],k$e[1],k$e[2]);var k$f=k$d.diffuseColor;k$b.diffuseColor=new k$gb(k$f[0],k$f[1],k$f[2]);var k$g=k$d.specularColor;k$b.specularColor=new k$hb(k$g[0],k$g[1],k$g[2],k$g[3]);var k$h=k$d.reflectColor;k$b.reflectColor=new k$gb(k$h[0],k$h[1],k$h[2]);var k$i=k$d.albedoColor;k$i&&(k$b.albedo=new k$hb(k$i[0],k$i[1],k$i[2],k$i[3]));var k$j=k$d.diffuseTexture.texture2D;k$j&&(k$b.diffuseTexture=k$r.getRes(k$a[k$j]));var k$k=k$d.normalTexture.texture2D;k$k&&(k$b.normalTexture=k$r.getRes(k$a[k$k]));var k$l=k$d.specularTexture.texture2D;k$l&&(k$b.specularTexture=k$r.getRes(k$a[k$l]));var k$m=k$d.emissiveTexture.texture2D;k$m&&(k$b.emissiveTexture=k$r.getRes(k$a[k$m]));var k$n=k$d.ambientTexture.texture2D;k$n&&(k$b.ambientTexture=k$r.getRes(k$a[k$n]));var k$o=k$d.reflectTexture.texture2D;k$o&&(k$b.reflectTexture=k$r.getRes(k$a[k$o]))},k$i.RENDERMODE_OPAQUE=1,k$i.RENDERMODE_OPAQUEDOUBLEFACE=2,k$i.RENDERMODE_CUTOUT=3,k$i.RENDERMODE_CUTOUTDOUBLEFACE=4,k$i.RENDERMODE_TRANSPARENT=13,k$i.RENDERMODE_TRANSPARENTDOUBLEFACE=14,k$i.RENDERMODE_ADDTIVE=15,k$i.RENDERMODE_ADDTIVEDOUBLEFACE=16,k$i.RENDERMODE_DEPTHREAD_TRANSPARENT=5,k$i.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,k$i.RENDERMODE_DEPTHREAD_ADDTIVE=7,k$i.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,k$i.RENDERMODE_NONDEPTH_TRANSPARENT=9,k$i.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,k$i.RENDERMODE_NONDEPTH_ADDTIVE=11,k$i.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,k$i.SHADERDEFINE_DIFFUSEMAP=0,k$i.SHADERDEFINE_NORMALMAP=0,k$i.SHADERDEFINE_SPECULARMAP=0,k$i.SHADERDEFINE_EMISSIVEMAP=0,k$i.SHADERDEFINE_AMBIENTMAP=0,k$i.SHADERDEFINE_REFLECTMAP=0,k$i.SHADERDEFINE_UVTRANSFORM=0,k$i.SHADERDEFINE_TILINGOFFSET=0,k$i.SHADERDEFINE_ADDTIVEFOG=0,k$i.DIFFUSETEXTURE=1,k$i.NORMALTEXTURE=2,k$i.SPECULARTEXTURE=3,k$i.EMISSIVETEXTURE=4,k$i.AMBIENTTEXTURE=5,k$i.REFLECTTEXTURE=6,k$i.ALBEDO=7,k$i.UVANIAGE=8,k$i.MATERIALAMBIENT=9,k$i.MATERIALDIFFUSE=10,k$i.MATERIALSPECULAR=11,k$i.MATERIALREFLECT=12,k$i.UVMATRIX=13,k$i.UVAGE=14,k$i.TILINGOFFSET=15,k$l(k$i,["defaultMaterial",function(){var k$a=new k$i;return k$a.lock=!0,this.defaultMaterial=k$a},"shaderDefines",function(){return this.shaderDefines=new k$kb(k$Eb.shaderDefines)}]),k$i}(k$Eb),k$Nb=function(k$a){function k$g(k$a,k$b,k$c,k$d,k$e){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===k$c&&(k$c=35044),void 0===k$d&&(k$d=!1),k$g.__super.call(this),this._indexType=k$a,this._indexCount=k$b,this._bufferUsage=k$c,this._bufferType=34963,this._canRead=k$d;var k$f;if("ushort"==k$a)this._indexTypeByteCount=2;else{if("ubyte"!=k$a)throw new Error("unidentification index type.");this._indexTypeByteCount=1}k$f=this._indexTypeByteCount*k$b,this._byteLength=k$f,this._bind(),k$h._gl.bufferData(this._bufferType,k$f,this._bufferUsage),this.uri=k$e,k$d?("ushort"==k$a?this._buffer=new Uint16Array(k$b):"ubyte"==k$a&&(this._buffer=new Uint8Array(k$b)),this.memorySize=2*k$f):this.memorySize=k$f}k$n(k$g,"laya.d3.graphics.IndexBuffer3D",k$a);var k$b=k$g.prototype;return k$b.setData=function(k$a,k$b,k$c,k$d){void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=4294967295);var k$e=0;if("ushort"==this._indexType?(k$e=2,0===k$c&&4294967295===k$d||(k$a=new Uint16Array(k$a.buffer,k$c*k$e,k$d))):"ubyte"==this._indexType&&(k$e=1,0===k$c&&4294967295===k$d||(k$a=new Uint8Array(k$a.buffer,k$c*k$e,k$d))),this._bind(),k$h._gl.bufferSubData(this._bufferType,k$b*k$e,k$a),this._canRead)if(0!==k$b||0!==k$c||4294967295!==k$d){var k$f=this._buffer.length-k$b;k$f<k$d&&(k$d=k$f);for(var k$g=0;k$g<k$d;k$g++)this._buffer[k$b+k$g]=k$a[k$g]}else this._buffer=k$a},k$b.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},k$b.disposeResource=function(){k$a.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},k$o(0,k$b,"indexType",function(){return this._indexType}),k$o(0,k$b,"indexTypeByteCount",function(){return this._indexTypeByteCount}),k$o(0,k$b,"indexCount",function(){return this._indexCount}),k$o(0,k$b,"canRead",function(){return this._canRead}),k$g.INDEXTYPE_UBYTE="ubyte",k$g.INDEXTYPE_USHORT="ushort",k$g.create=function(k$a,k$b,k$c,k$d,k$e){return void 0===k$c&&(k$c=35044),void 0===k$d&&(k$d=!1),new k$g(k$a,k$b,k$c,k$d,k$e)},k$g}(k$h),k$Ob=function(k$f){function k$g(k$a,k$b,k$c,k$d,k$e){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===k$d&&(k$d=!1),k$g.__super.call(this),this._vertexDeclaration=k$a,this._vertexCount=k$b,this._bufferUsage=k$c,this._bufferType=34962,this._canRead=k$d,this.uri=k$e,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*k$b,this._bind(),k$h._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),k$d&&(this._buffer=new Float32Array(this._byteLength/4))}k$n(k$g,"laya.d3.graphics.VertexBuffer3D",k$f);var k$a=k$g.prototype;return k$a.bindWithIndexBuffer=function(k$a){k$a&&k$a._bind(),this._bind()},k$a.setData=function(k$a,k$b,k$c,k$d){if(void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=4294967295),0===k$c&&4294967295===k$d||(k$a=new Float32Array(k$a.buffer,4*k$c,k$d)),this._bind(),k$h._gl.bufferSubData(this._bufferType,4*k$b,k$a),this._canRead)if(0!==k$b||0!==k$c||4294967295!==k$d){var k$e=this._buffer.length-k$b;k$e<k$d&&(k$d=k$e);for(var k$f=0;k$f<k$d;k$f++)this._buffer[k$b+k$f]=k$a[k$f]}else this._buffer=k$a},k$a.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},k$a.disposeResource=function(){for(var k$a=k$F.mainContext,k$b=this._vertexDeclaration.getVertexElements(),k$c=k$h._enableAtributes,k$d=0,k$e=k$b.length;k$d<k$e;k$d++)k$c[k$d]===this._glBuffer&&(k$a.disableVertexAttribArray(k$d),k$c[k$d]=null);k$f.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},k$o(0,k$a,"vertexDeclaration",function(){return this._vertexDeclaration}),k$o(0,k$a,"vertexCount",function(){return this._vertexCount}),k$o(0,k$a,"canRead",function(){return this._canRead}),k$g.create=function(k$a,k$b,k$c,k$d,k$e){return void 0===k$c&&(k$c=35044),void 0===k$d&&(k$d=!1),new k$g(k$a,k$b,k$c,k$d,k$e)},k$g}(k$h),k$Pb=function(k$a){function k$t(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,k$t.__super.call(this),this._type=3553}k$n(k$t,"laya.d3.resource.DataTexture2D",k$Fb);var k$b=k$t.prototype;return k$b.genDebugMipmaps=function(){var k$a=[];return k$a.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),k$a.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),k$a.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),k$a.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),k$a.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),k$a.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),k$a.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),k$a.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),k$a.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),k$a.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),k$a},k$b._onTextureLoaded=function(k$a){},k$b._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var k$a=k$F.mainContext,k$b=this._source=k$a.createTexture(),k$c=this._width,k$d=this._height,k$e=k$G.curBindTexTarget,k$f=k$G.curBindTexValue,k$g=!1;if(k$G.bindTexture(k$a,this._type,k$b),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var k$h=0;k$a.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var k$i=0;k$i<this._mipmaps.length;k$i++){if(this._mipmaps[k$i].byteLength!=k$j*k$k*4)throw"mipmap size error  level:"+k$i;k$a.texSubImage2D(this._type,0,k$t.simLodRect[k$h++],k$t.simLodRect[k$h++],k$t.simLodRect[k$h++],k$t.simLodRect[k$h++],6408,5121,new Uint8Array(this._mipmaps[k$i]))}this.minFifter=9729,this.magFifter=9729}else{var k$j=this._width,k$k=this._height;for(k$h=0,k$a.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),k$i=0;k$i<this._mipmaps.length;k$i++){if(this._mipmaps[k$i].byteLength!=k$j*k$k*4)throw"mipmap size error  level:"+k$i;k$a.texImage2D(this._type,k$i,6408,k$j,k$k,0,6408,5121,new Uint8Array(this._mipmaps[k$i])),(k$j/=2)<1&&(k$j=1),(k$k/=2)<1&&(k$k=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&k$a.pixelStorei(k$a.UNPACK_ALIGNMENT,1),k$a.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var k$l=0,k$m=!1,k$n=!1;this._buffer.byteLength==4*k$c*k$d?(k$l=6408,k$m=!0):this._buffer.byteLength==3*k$c*k$d?(k$l=6407,k$n=!0):k$l=this._format,k$m||k$n?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),k$n&&k$a.pixelStorei(k$a.UNPACK_ALIGNMENT,1),k$a.texImage2D(this._type,0,k$l,k$c,k$d,0,k$l,5121,this._buffer)):k$a&&k$l==k$a.ALPHA?(k$a.texImage2D(3553,0,k$l,k$c,k$d,0,k$l,k$a.UNSIGNED_BYTE,this._buffer),k$g=!0):0!=k$l&&(k$a.compressedTexImage2D(3553,0,k$l,k$c,k$d,0,this._buffer),k$g=!0)}var k$o=this._minFifter,k$p=this._magFifter,k$q=0==this._wrapModeU?10497:33071,k$r=0==this._wrapModeV?10497:33071,k$s=k$w.isPOT(k$c,k$d);k$s?(this._mipmap||this._mipmaps?-1!==k$o||(k$o=9987):-1!==k$o||(k$o=9729),-1!==k$p||(k$p=9729),k$a.texParameteri(this._type,10241,k$o),k$a.texParameteri(this._type,10240,k$p),k$a.texParameteri(this._type,10242,k$q),k$a.texParameteri(this._type,10243,k$r),this._mipmap&&k$a.generateMipmap(this._type)):(-1!==k$o||(k$o=9729),-1!==k$p||(k$p=9729),k$a.texParameteri(this._type,10241,k$o),k$a.texParameteri(this._type,10240,k$p),k$a.texParameteri(this._type,10242,33071),k$a.texParameteri(this._type,10243,33071)),k$e&&k$f&&k$G.bindTexture(k$a,k$e,k$f),this.memorySize=k$g?this._buffer.length:k$s?k$c*k$d*4*(1+1/3):k$c*k$d*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},k$b.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},k$b.onAsynLoaded=function(k$a,k$b,k$c){var k$d;k$c&&(k$d=k$c[0].call(this,k$b)),k$d&&(this._width=k$d.width,this._height=k$d.height,this._buffer=k$d.data),this._src=k$a,this._size=new k$pb(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},k$b.getPixels=function(){return new Uint8Array(this._buffer)},k$b.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(k$F.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},k$o(0,k$b,"src",function(){return this._src}),k$t.create=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){if(void 0===k$d&&(k$d=9729),void 0===k$e&&(k$e=9729),void 0===k$f&&(k$f=!0),!k$a||k$a.byteLength<k$b*k$c*4)throw"DataTexture2D create error";var k$h=new k$t;return k$h.uri=k$g,k$h._buffer=k$a,k$h._width=k$b,k$h._height=k$c,k$h._mipmap=k$f,k$h._magFifter=k$d,k$h._minFifter=k$e,k$h._size=new k$pb(k$h._width,k$h._height),k$h._conchTexture?alert("怎么给runtime传递datatexture数据"):k$h.activeResource(),k$h},k$t.load=function(k$a,k$b,k$c,k$d,k$e){if(void 0===k$b&&(k$b=0),void 0===k$c&&(k$c=0),void 0===k$d&&(k$d=9729),void 0===k$e&&(k$e=9729),"mipmaps"===k$C.getFileExtension(k$a)){var k$f=k$x.loader.create(k$a,null,null,k$t,[function(k$a){this._mipmaps=[];var k$b=new Uint32Array(k$a);this._width=k$b[0];var k$c=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,k$c=1024),this._width!=k$c)throw"现在只支持512x256的环境贴图。当前的是"+k$b[0];this._height=k$b[1];for(var k$d=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,k$e=this._height,k$f=8;;){var k$g=k$d*k$e*4;if(k$f+k$g>k$a.byteLength)throw"load mipmaps data size error ";var k$h=new Uint8Array(k$a,k$f,k$g);if(this._mipmaps.push(k$h),k$f+=k$g,1==k$d&&1==k$e)break;(k$d/=2)<1&&(k$d=1),(k$e/=2)<1&&(k$e=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){k$f.simLodInfo=new Float32Array(40);for(var k$g=0;k$g<k$f.simLodInfo.length;)k$f.simLodInfo[k$g]=(k$t.simLodRect[k$g]+.5)/1024,k$g++,k$f.simLodInfo[k$g]=(k$t.simLodRect[k$g]+.5)/256,k$g++,k$f.simLodInfo[k$g]=Math.max(k$t.simLodRect[k$g]-1,.1)/1024,k$g++,k$f.simLodInfo[k$g]=Math.max(k$t.simLodRect[k$g]-1.5,.1)/256,k$g++}return k$f}if("number"==typeof k$b)return k$x.loader.create(k$a,null,null,k$t,[function(k$a){return this._width=k$b,this._height=k$c,this._buffer=k$a,null}]);if("function"==typeof k$b)return k$x.loader.create(k$a,null,null,k$t,[k$b]);throw new Error("unknown params.")},k$t.lodasatlas=!1,k$l(k$t,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),k$t}(),k$Qb=function(k$a){function k$b(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,k$b.__super.call(this)}k$n(k$b,"laya.d3.resource.models.PrimitiveMesh",k$Gb);var k$c=k$b.prototype;return k$x.imps(k$c,{"laya.d3.core.render.IRenderable":!0}),k$c._getVertexBuffer=function(k$a){return void 0===k$a&&(k$a=0),0===k$a?this._vertexBuffer:null},k$c._getVertexBuffers=function(){return null},k$c._getIndexBuffer=function(){return this._indexBuffer},k$c._getPositions=function(){var k$a,k$b=[],k$c=this._vertexBuffer.vertexDeclaration.getVertexElements(),k$d=0;for(k$d=0;k$d<k$c.length;k$d++){var k$e=k$c[k$d];if("vector3"===k$e.elementFormat&&0===k$e.elementUsage){k$a=k$e;break}}var k$f=this._vertexBuffer.getData();for(k$d=0;k$d<k$f.length;k$d+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var k$g=k$d+k$a.offset/4,k$h=new k$gb(k$f[k$g+0],k$f[k$g+1],k$f[k$g+2]);k$b.push(k$h)}return k$b},k$c.getRenderElement=function(k$a){return this},k$c.getRenderElementsCount=function(){return 1},k$c.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},k$c._beforeRender=function(k$a){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},k$c._render=function(k$a){k$F.mainContext.drawElements(4,this._numberIndices,5123,0),k$A.drawCall++,k$A.trianglesFaces+=this._numberIndices/3},k$o(0,k$c,"_vertexBufferCount",function(){return 1}),k$o(0,k$c,"triangleCount",function(){return this._indexBuffer.indexCount/3}),k$b}(),k$Rb=function(k$a){function k$b(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,k$b.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}k$n(k$b,"laya.d3.resource.models.Mesh",k$Gb);var k$c=k$b.prototype;return k$c._getPositions=function(){var k$a,k$b,k$c,k$d,k$e,k$f=[],k$g=0,k$h=0,k$i=0;if(0!==this._vertexBuffers.length){var k$j=this._vertexBuffers.length;for(k$g=0;k$g<k$j;k$g++){for(k$c=(k$a=this._vertexBuffers[k$g]).vertexDeclaration.getVertexElements(),k$h=0;k$h<k$c.length;k$h++)if("vector3"===(k$d=k$c[k$h]).elementFormat&&0===k$d.elementUsage){k$b=k$d;break}for(k$e=k$a.getData(),k$h=0;k$h<k$e.length;k$h+=k$a.vertexDeclaration.vertexStride/4)k$i=k$h+k$b.offset/4,k$f.push(new k$gb(k$e[k$i+0],k$e[k$i+1],k$e[k$i+2]))}}else{var k$k=this._subMeshes.length;for(k$g=0;k$g<k$k;k$g++){for(k$c=(k$a=this._subMeshes[k$g]._getVertexBuffer()).vertexDeclaration.getVertexElements(),k$h=0;k$h<k$c.length;k$h++)if("vector3"===(k$d=k$c[k$h]).elementFormat&&0===k$d.elementUsage){k$b=k$d;break}for(k$e=k$a.getData(),k$h=0;k$h<k$e.length;k$h+=k$a.vertexDeclaration.vertexStride/4)k$i=k$h+k$b.offset/4,k$f.push(new k$gb(k$e[k$i+0],k$e[k$i+1],k$e[k$i+2]))}}return k$f},k$c._setSubMeshes=function(k$a){this._subMeshes=k$a,this._subMeshCount=k$a.length;for(var k$b=0;k$b<this._subMeshCount;k$b++)k$a[k$b]._indexInMesh=k$b;this._positions=this._getPositions(),this._generateBoundingObject()},k$c.onAsynLoaded=function(k$a,k$b,k$c){var k$d=k$b[0],k$e=k$b[1];k$Ya.read(k$d,this,this._materials,this._subMeshes,k$e),this.completeCreate(),this._endLoaded()},k$c.getSubMesh=function(k$a){return this._subMeshes[k$a]},k$c.getSubMeshCount=function(){return this._subMeshes.length},k$c.getRenderElementsCount=function(){return this._subMeshes.length},k$c.getRenderElement=function(k$a){return this._subMeshes[k$a]},k$c.disposeResource=function(){for(var k$a=0;k$a<this._subMeshes.length;k$a++)this._subMeshes[k$a].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},k$o(0,k$c,"materials",function(){return this._materials.slice()}),k$o(0,k$c,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),k$b.load=function(k$a){return k$x.loader.create(k$a,null,null,k$b)},k$b}(),k$Sb=(function(k$a){function k$j(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===k$c&&(k$c=6408),void 0===k$d&&(k$d=5121),void 0===k$e&&(k$e=33189),void 0===k$f&&(k$f=!1),void 0===k$g&&(k$g=!1),void 0===k$h&&(k$h=-1),void 0===k$i&&(k$i=-1),k$j.__super.call(this),this._type=3553,this._width=k$a,this._height=k$b,this._size=new k$pb(k$a,k$b),this._surfaceFormat=k$c,this._surfaceType=k$d,this._depthStencilFormat=k$e,k$p.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=k$f,this._repeat=k$g,this._minFifter=k$h,this._magFifter=k$i,this.activeResource(),this._alreadyResolved=!0}k$n(k$j,"laya.d3.resource.RenderTexture",k$Fb);var k$b=k$j.prototype;k$b.recreateResource=function(){var k$a=k$F.mainContext;this._frameBuffer=k$a.createFramebuffer(),this._source=k$a.createTexture();var k$b=k$G.curBindTexTarget,k$c=k$G.curBindTexValue;k$G.bindTexture(k$a,this._type,this._source),k$a.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var k$d=this._minFifter,k$e=this._magFifter,k$f=this._repeat?10497:33071;if(k$w.isPOT(this._width,this._height)?(this._mipmap?-1!==k$d||(k$d=9987):-1!==k$d||(k$d=9729),-1!==k$e||(k$e=9729),k$a.texParameteri(this._type,10241,k$d),k$a.texParameteri(this._type,10240,k$e),k$a.texParameteri(this._type,10242,k$f),k$a.texParameteri(this._type,10243,k$f),this._mipmap&&k$a.generateMipmap(this._type)):(-1!==k$d||(k$d=9729),-1!==k$e||(k$e=9729),k$a.texParameteri(this._type,10241,k$d),k$a.texParameteri(this._type,10240,k$e),k$a.texParameteri(this._type,10242,33071),k$a.texParameteri(this._type,10243,33071)),k$b&&k$c&&k$G.bindTexture(k$a,k$b,k$c),k$a.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=k$a.createRenderbuffer(),k$a.bindRenderbuffer(36161,this._depthStencilBuffer),k$a.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),k$a.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:k$a.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:k$a.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:k$a.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}k$a.framebufferTexture2D(36160,36064,3553,this._source,0),k$a.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},k$b.start=function(){k$F.mainContext.bindFramebuffer(36160,this.frameBuffer),(k$j._currentRenderTarget=this)._alreadyResolved=!1},k$b.end=function(){k$F.mainContext.bindFramebuffer(36160,null),k$j._currentRenderTarget=null,this._alreadyResolved=!0},k$b.getData=function(k$a,k$b,k$c,k$d){var k$e=k$F.mainContext;if(k$e.bindFramebuffer(36160,this._frameBuffer),!(36053===k$e.checkFramebufferStatus(36160)))return k$e.bindFramebuffer(36160,null),null;var k$f=new Uint8Array(this._width*this._height*4);return k$e.readPixels(k$a,k$b,k$c,k$d,this._surfaceFormat,this._surfaceType,k$f),k$e.bindFramebuffer(36160,null),k$f},k$b.disposeResource=function(){if(this._frameBuffer){var k$a=k$F.mainContext;k$a.deleteTexture(this._source),k$a.deleteFramebuffer(this._frameBuffer),k$a.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},k$o(0,k$b,"surfaceFormat",function(){return this._surfaceFormat}),k$o(0,k$b,"surfaceType",function(){return this._surfaceType}),k$o(0,k$b,"depthStencilFormat",function(){return this._depthStencilFormat}),k$o(0,k$b,"source",function(){return this._alreadyResolved?k$x.superGet(k$Fb,this,"source"):null}),k$o(0,k$b,"depthStencilBuffer",function(){return this._depthStencilBuffer}),k$o(0,k$b,"frameBuffer",function(){return this._frameBuffer}),k$j._currentRenderTarget=null}(),function(k$a){function k$b(k$a){this._color=null,this._pixels=null,k$b.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new k$pb(this.width,this.height),this._color=k$a,this._pixels=new Uint8Array([255*k$a.x,255*k$a.y,255*k$a.z,255*k$a.w]),this.uri="SolidColorTexture2D_"+this.id}k$n(k$b,"laya.d3.resource.SolidColorTexture2D",k$Fb);var k$c=k$b.prototype;return k$c._createWebGlTexture=function(){var k$a=k$F.mainContext,k$b=this._source=k$a.createTexture(),k$c=this._width,k$d=this._height,k$e=k$G.curBindTexTarget,k$f=k$G.curBindTexValue;k$G.bindTexture(k$a,this._type,k$b),k$a.texImage2D(this._type,0,6408,k$c,k$d,0,6408,5121,this._pixels);var k$g=this._minFifter,k$h=this._magFifter,k$i=this._repeat?10497:33071,k$j=k$w.isPOT(k$c,k$d);k$j?(this._mipmap?-1!==k$g||(k$g=9987):-1!==k$g||(k$g=9729),-1!==k$h||(k$h=9729),k$a.texParameteri(this._type,10241,k$g),k$a.texParameteri(this._type,10240,k$h),k$a.texParameteri(this._type,10242,k$i),k$a.texParameteri(this._type,10243,k$i),this._mipmap&&k$a.generateMipmap(this._type)):(-1!==k$g||(k$g=9729),-1!==k$h||(k$h=9729),k$a.texParameteri(this._type,10241,k$g),k$a.texParameteri(this._type,10240,k$h),k$a.texParameteri(this._type,10242,33071),k$a.texParameteri(this._type,10243,33071)),k$e&&k$f&&k$G.bindTexture(k$a,k$e,k$f),this.memorySize=k$j?k$c*k$d*4*(1+1/3):k$c*k$d*4},k$c.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},k$c.disposeResource=function(){this._source&&(k$F.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},k$l(k$b,["magentaTexture",function(){var k$a=new k$b(new k$hb(1,0,1,1));return k$a.lock=!0,this.magentaTexture=k$a},"grayTexture",function(){var k$a=new k$b(new k$hb(.5,.5,.5,1));return k$a.lock=!0,this.grayTexture=k$a}]),k$b}()),k$Tb=function(k$a){function k$e(k$a,k$b,k$c,k$d){this._canRead=!1,this._image=null,this._pixels=null,void 0===k$a&&(k$a=!1),void 0===k$b&&(k$b=!0),void 0===k$c&&(k$c=6408),void 0===k$d&&(k$d=!0),k$e.__super.call(this),this._type=3553,this._repeat=k$b,this._canRead=k$a,this._format=k$c,this._mipmap=k$d}k$n(k$e,"laya.d3.resource.Texture2D",k$Fb);var k$b=k$e.prototype;return k$b._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var k$a=k$F.mainContext,k$b=this._source=k$a.createTexture(),k$c=this._width,k$d=this._height,k$e=k$G.curBindTexTarget,k$f=k$G.curBindTexValue;switch(k$G.bindTexture(k$a,this._type,k$b),this._format){case 6407:case 6408:this._canRead?k$a.texImage2D(this._type,0,this._format,k$c,k$d,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?k$a.texImage2D(this._type,0,this._image._format,k$c,k$d,0,this._image._format,5121,this._image.atlasSource):k$a.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case k$F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:k$a.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var k$g=this._minFifter,k$h=this._magFifter,k$i=this._repeat?10497:33071,k$j=0==this._wrapModeU?10497:33071,k$k=0==this._wrapModeV?10497:33071,k$l=k$w.isPOT(k$c,k$d);k$l?(this._mipmap?-1!==k$g||(k$g=9987):-1!==k$g||(k$g=9729),-1!==k$h||(k$h=9729),k$a.texParameteri(this._type,10241,k$g),k$a.texParameteri(this._type,10240,k$h),k$a.texParameteri(this._type,10242,k$i),k$a.texParameteri(this._type,10243,k$i),k$a.texParameteri(this._type,10242,k$j),k$a.texParameteri(this._type,10243,k$k),this._mipmap&&k$a.generateMipmap(this._type)):(-1!==k$g||(k$g=9729),-1!==k$h||(k$h=9729),k$a.texParameteri(this._type,10241,k$g),k$a.texParameteri(this._type,10240,k$h),k$a.texParameteri(this._type,10242,33071),k$a.texParameteri(this._type,10243,33071)),k$e&&k$f&&k$G.bindTexture(k$a,k$e,k$f),this._image.onload=null,this._image=null,this.memorySize=k$l?k$c*k$d*4*(1+1/3):k$c*k$d*4},k$b.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},k$b.onAsynLoaded=function(k$a,k$b,k$c){if(k$c){var k$d=k$c[0];void 0!==k$d&&(this._canRead=k$d);var k$e=k$c[1];void 0!==k$e&&(this._repeat=k$e);var k$f=k$c[2];void 0!==k$f&&(this._format=k$f);var k$g=k$c[3];void 0!==k$g&&(this._mipmap=k$g);var k$h=k$c.wrapModeU;void 0!==k$h&&(this._wrapModeU=k$h);var k$i=k$c.wrapModeV;void 0!==k$i&&(this._wrapModeV=k$i)}switch(this._format){case 6407:case 6408:var k$j=(this._image=k$b).width,k$k=k$b.height;this._width=k$j,this._height=k$k,this._size=new k$pb(k$j,k$k),this._canRead&&(k$p.isConchApp?k$b instanceof k$m.HTMLElement&&(this._pixels=new Uint8Array(k$b.getImageData(0,0,k$j,k$k))):(k$H.canvas.size(k$j,k$k),k$H.canvas.clear(),k$H.context.drawImage(k$b,0,0,k$j,k$k),this._pixels=new Uint8Array(k$H.context.getImageData(0,0,k$j,k$k).data.buffer)));break;case k$F.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var k$l=new k$y(k$b);k$l.readUTFBytes(4),k$l.readUTFBytes(2),k$l.getInt16();k$l.endian="bigEndian",this._width=k$l.getInt16(),this._height=k$l.getInt16(),this._size=new k$pb(this._width,this._height);k$l.getInt16(),k$l.getInt16();this._image=new Uint8Array(k$b,k$l.pos)}this.recreateResource(),this._endLoaded()},k$b.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},k$b.disposeResource=function(){this._source&&(k$F.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},k$o(0,k$b,"_src",function(){return this.url}),k$o(0,k$b,"src",function(){return this.url}),k$e.load=function(k$a){return k$x.loader.create(k$a,null,null,k$e)},k$e}(),k$Ub=function(k$b){function k$c(k$a,k$b){k$c.__super.call(this),void 0===k$a&&(k$a=.3),void 0===k$b&&(k$b=1e3),this._tempVector3=new k$gb,this._position=new k$gb,this._up=new k$gb,this._forward=new k$gb,this._right=new k$gb,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=k$pb.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=k$a,this._farPlane=k$b,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),k$x.stage.on("resize",this,this._onScreenSizeChanged)}k$n(k$c,"laya.d3.core.BaseCamera",k$b);var k$a=k$c.prototype;return k$a._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var k$a=this.scene._cameraPool,k$b=k$a.length-1,k$c=0;k$c<k$b;k$c++)if(k$a[k$c].renderingOrder>k$a[k$b].renderingOrder){var k$d=k$a[k$c];k$a[k$c]=k$a[k$b],k$a[k$b]=k$d}},k$a._calculateProjectionMatrix=function(){},k$a._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},k$a._prepareCameraToRender=function(){k$I._currentCameraCullingMask=this.cullingMask;var k$a=this._shaderValues;k$a.setValue(0,this.transform.position.elements),k$a.setValue(5,this.forward.elements),k$a.setValue(6,this.up.elements)},k$a._prepareCameraViewProject=function(k$a,k$b){var k$c=this._shaderValues;k$c.setValue(1,k$a.elements),k$c.setValue(2,k$b.elements)},k$a._renderCamera=function(k$a,k$b,k$c){},k$a.addLayer=function(k$a){29!==k$a.number&&30!=k$a.number&&(this.cullingMask=this.cullingMask|k$a.mask)},k$a.removeLayer=function(k$a){29!==k$a.number&&30!=k$a.number&&(this.cullingMask=this.cullingMask&~k$a.mask)},k$a.addAllLayers=function(){this.cullingMask=2147483647},k$a.removeAllLayers=function(){this.cullingMask=0|k$I.getLayerByNumber(29).mask|k$I.getLayerByNumber(30).mask},k$a.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},k$a.moveForward=function(k$a){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=k$a,this.transform.translate(this._tempVector3)},k$a.moveRight=function(k$a){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=k$a,this.transform.translate(this._tempVector3)},k$a.moveVertical=function(k$a){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=k$a,this.transform.translate(this._tempVector3,!1)},k$a._addSelfRenderObjects=function(){var k$a=this.scene._cameraPool,k$b=k$a.length;if(0<k$b){for(var k$c=k$b-1;0<=k$c;k$c--)if(this.renderingOrder<=k$a[k$c].renderingOrder){k$a.splice(k$c+1,0,this);break}}else k$a.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},k$a._clearSelfRenderObjects=function(){var k$a=this.scene._cameraPool;k$a.splice(k$a.indexOf(this),1)},k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,k$x.stage.off("resize",this,this._onScreenSizeChanged),k$b.prototype.destroy.call(this,k$a)},k$o(0,k$a,"sky",function(){return this._sky},function(k$a){(this._sky=k$a)._ownerCamera=this}),k$o(0,k$a,"forward",function(){var k$a=this.transform.worldMatrix.elements,k$b=this._forward.elements;return k$b[0]=-k$a[8],k$b[1]=-k$a[9],k$b[2]=-k$a[10],this._forward}),k$o(0,k$a,"position",function(){var k$a=this.transform.worldMatrix.elements,k$b=this._position.elements;return k$b[0]=k$a[12],k$b[1]=k$a[13],k$b[2]=k$a[14],this._position}),k$o(0,k$a,"renderTarget",function(){return this._renderTarget},function(k$a){null!=(this._renderTarget=k$a)&&(this._renderTargetSize=k$a.size)}),k$o(0,k$a,"up",function(){var k$a=this.transform.worldMatrix.elements,k$b=this._up.elements;return k$b[0]=k$a[4],k$b[1]=k$a[5],k$b[2]=k$a[6],this._up}),k$o(0,k$a,"right",function(){var k$a=this.transform.worldMatrix.elements,k$b=this._right.elements;return k$b[0]=k$a[0],k$b[1]=k$a[1],k$b[2]=k$a[2],this._right}),k$o(0,k$a,"renderTargetSize",function(){return this._renderTargetSize},function(k$a){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=k$a,this._calculateProjectionMatrix()}),k$o(0,k$a,"fieldOfView",function(){return this._fieldOfView},function(k$a){this._fieldOfView=k$a,this._calculateProjectionMatrix()}),k$o(0,k$a,"nearPlane",function(){return this._nearPlane},function(k$a){this._nearPlane=k$a,this._calculateProjectionMatrix()}),k$o(0,k$a,"farPlane",function(){return this._farPlane},function(k$a){this._farPlane=k$a,this._calculateProjectionMatrix()}),k$o(0,k$a,"orthographic",function(){return this._orthographic},function(k$a){this._orthographic=k$a,this._calculateProjectionMatrix()}),k$o(0,k$a,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(k$a){this._orthographicVerticalSize=k$a,this._calculateProjectionMatrix()}),k$o(0,k$a,"renderingOrder",function(){return this._renderingOrder},function(k$a){this._renderingOrder=k$a,this._sortCamerasByRenderingOrder()}),k$c.CAMERAPOS=0,k$c.VIEWMATRIX=1,k$c.PROJECTMATRIX=2,k$c.VPMATRIX=3,k$c.VPMATRIX_NO_TRANSLATE=4,k$c.CAMERADIRECTION=5,k$c.CAMERAUP=6,k$c.ENVIRONMENTDIFFUSE=7,k$c.ENVIRONMENTSPECULAR=8,k$c.SIMLODINFO=9,k$c.DIFFUSEIRRADMATR=10,k$c.DIFFUSEIRRADMATG=11,k$c.DIFFUSEIRRADMATB=12,k$c.HDREXPOSURE=13,k$c.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",k$c.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",k$c.CLEARFLAG_SOLIDCOLOR=0,k$c.CLEARFLAG_SKY=1,k$c.CLEARFLAG_DEPTHONLY=2,k$c.CLEARFLAG_NONE=3,k$l(k$c,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new k$ab(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new k$ab},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new k$ab}]),k$c}(k$Kb),k$Vb=function(k$c){function k$b(k$a){this._render=null,this._geometryFilter=null,k$b.__super.call(this,k$a)}k$n(k$b,"laya.d3.core.RenderableSprite3D",k$c);var k$a=k$b.prototype;return k$a._addToInitStaticBatchManager=function(){},k$a._setBelongScene=function(k$a){k$c.prototype._setBelongScene.call(this,k$a),k$a._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},k$a._setUnBelongScene=function(){var k$a=this._scene._renderableSprite3Ds,k$b=k$a.indexOf(this);k$a.splice(k$b,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),k$c.prototype._setUnBelongScene.call(this)},k$a._update=function(k$a){(k$a.owner=this)._activeInHierarchy&&(this._updateComponents(k$a),this._render._updateOctreeNode(),this._lateUpdateComponents(k$a),k$A.spriteCount++,this._childs.length&&this._updateChilds(k$a))},k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),k$c.prototype.destroy.call(this,k$a),this._render._destroy(),this._render=null},k$b.__init__=function(){k$b.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=k$b.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),k$b.SAHDERDEFINE_LIGHTMAP=k$b.shaderDefines.registerDefine("LIGHTMAP")},k$b.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,k$b.SAHDERDEFINE_LIGHTMAP=4,k$b.LIGHTMAPSCALEOFFSET=2,k$b.LIGHTMAP=3,k$l(k$b,["shaderDefines",function(){return this.shaderDefines=new k$kb}]),k$b}(k$Kb),k$Wb=(function(k$a){function k$d(k$a,k$b,k$c){this._long=NaN,this._width=NaN,this._height=NaN,void 0===k$a&&(k$a=1),void 0===k$b&&(k$b=1),void 0===k$c&&(k$c=1),k$d.__super.call(this),this._long=k$a,this._width=k$b,this._height=k$c,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}k$n(k$d,"laya.d3.resource.models.BoxMesh",k$Qb);var k$b=k$d.prototype;k$b.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var k$a=k$Fa.vertexDeclaration,k$b=(k$a.vertexStride,this._long/2),k$c=this._height/2,k$d=this._width/2,k$e=new Float32Array([-k$b,k$c,-k$d,0,1,0,0,0,k$b,k$c,-k$d,0,1,0,1,0,k$b,k$c,k$d,0,1,0,1,1,-k$b,k$c,k$d,0,1,0,0,1,-k$b,-k$c,-k$d,0,-1,0,0,1,k$b,-k$c,-k$d,0,-1,0,1,1,k$b,-k$c,k$d,0,-1,0,1,0,-k$b,-k$c,k$d,0,-1,0,0,0,-k$b,k$c,-k$d,-1,0,0,0,0,-k$b,k$c,k$d,-1,0,0,1,0,-k$b,-k$c,k$d,-1,0,0,1,1,-k$b,-k$c,-k$d,-1,0,0,0,1,k$b,k$c,-k$d,1,0,0,1,0,k$b,k$c,k$d,1,0,0,0,0,k$b,-k$c,k$d,1,0,0,0,1,k$b,-k$c,-k$d,1,0,0,1,1,-k$b,k$c,k$d,0,0,1,0,0,k$b,k$c,k$d,0,0,1,1,0,k$b,-k$c,k$d,0,0,1,1,1,-k$b,-k$c,k$d,0,0,1,0,1,-k$b,k$c,-k$d,0,0,-1,1,0,k$b,k$c,-k$d,0,0,-1,0,0,k$b,-k$c,-k$d,0,0,-1,0,1,-k$b,-k$c,-k$d,0,0,-1,1,1]),k$f=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new k$Ob(k$a,this._numberVertices,35044,!0),this._indexBuffer=new k$Nb("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(k$e),this._indexBuffer.setData(k$f),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},k$o(0,k$b,"long",function(){return this._long},function(k$a){this._long!==k$a&&(this._long=k$a,this.releaseResource(),this.activeResource())}),k$o(0,k$b,"width",function(){return this._width},function(k$a){this._width!==k$a&&(this._width=k$a,this.releaseResource(),this.activeResource())}),k$o(0,k$b,"height",function(){return this._height},function(k$a){this._height!==k$a&&(this._height=k$a,this.releaseResource(),this.activeResource())})}(),function(k$a){function k$g(k$a,k$b,k$c){void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=.3),void 0===k$c&&(k$c=1e3),this._viewMatrix=new k$ab,this._projectionMatrix=new k$ab,this._projectionViewMatrix=new k$ab,this._viewport=new k$ib(0,0,0,0),this._normalizedViewport=new k$ib(0,0,1,1),this._aspectRatio=k$a,this._boundFrustumUpdate=!0,this._boundFrustum=new k$$a(k$ab.DEFAULT),k$g.__super.call(this,k$b,k$c),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}k$n(k$g,"laya.d3.core.Camera",k$Ub);var k$b=k$g.prototype;return k$b._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},k$b._parseCustomProps=function(k$a,k$b,k$c,k$d){var k$e=k$c.clearColor;this.clearColor=new k$hb(k$e[0],k$e[1],k$e[2],k$e[3]);var k$f=k$c.viewport;this.normalizedViewport=new k$ib(k$f[0],k$f[1],k$f[2],k$f[3])},k$b._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var k$a=this.orthographicVerticalSize*this.aspectRatio*.5,k$b=.5*this.orthographicVerticalSize;k$ab.createOrthoOffCenterRH(-k$a,k$a,-k$b,k$b,this.nearPlane,this.farPlane,this._projectionMatrix)}else k$ab.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},k$b._update=function(k$a){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,k$a)},k$b._renderCamera=function(k$a,k$b,k$c){var k$d,k$e;k$c.parallelSplitShadowMaps[0]&&k$c._renderShadowMap(k$a,k$b,this),(k$b.camera=this)._prepareCameraToRender(),k$c._preRenderUpdateComponents(k$b),k$d=k$b._viewMatrix=this.viewMatrix;var k$f=this._renderTarget;k$f?(k$f.start(),k$ab.multiply(k$Ub._invertYScaleMatrix,this._projectionMatrix,k$Ub._invertYProjectionMatrix),k$ab.multiply(k$Ub._invertYScaleMatrix,this.projectionViewMatrix,k$Ub._invertYProjectionViewMatrix),k$e=k$b._projectionMatrix=k$Ub._invertYProjectionMatrix,k$b._projectionViewMatrix=k$Ub._invertYProjectionViewMatrix):(k$e=k$b._projectionMatrix=this._projectionMatrix,k$b._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(k$d,k$e),k$b._viewport=this.viewport,k$c._preRenderScene(k$a,k$b,this.boundFrustum),k$c._clear(k$a,k$b),k$c._renderScene(k$a,k$b),k$c._postRenderUpdateComponents(k$b),k$f&&k$f.end()},k$b.viewportPointToRay=function(k$a,k$b){k$ob.calculateCursorRay(k$a,this.viewport,this._projectionMatrix,this.viewMatrix,null,k$b)},k$b.normalizedViewportPointToRay=function(k$a,k$b){var k$c=k$g._tempVector20,k$d=this.viewport,k$e=k$a.elements,k$f=k$c.elements;k$f[0]=k$e[0]*k$d.width,k$f[1]=k$e[1]*k$d.height,k$ob.calculateCursorRay(k$c,this.viewport,this._projectionMatrix,this.viewMatrix,null,k$b)},k$b.worldToViewportPoint=function(k$a,k$b){k$ab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(k$a,this._projectionViewMatrix,k$b);var k$c=k$b.elements;k$c[0]=k$c[0]/k$x.stage.clientScaleX,k$c[1]=k$c[1]/k$x.stage.clientScaleY},k$b.worldToNormalizedViewportPoint=function(k$a,k$b){k$ab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(k$a,this._projectionViewMatrix,k$b);var k$c=k$b.elements;k$c[0]=k$c[0]/k$x.stage.clientScaleX,k$c[1]=k$c[1]/k$x.stage.clientScaleY},k$b.convertScreenCoordToOrthographicCoord=function(k$a,k$b){if(this._orthographic){var k$c=k$Y.clientWidth,k$d=k$Y.clientHeight,k$e=this.orthographicVerticalSize*this.aspectRatio/k$c,k$f=this.orthographicVerticalSize/k$d,k$g=k$a.elements,k$h=k$b.elements;return k$h[0]=(-k$c/2+k$g[0])*k$e,k$h[1]=(k$d/2-k$g[1])*k$f,k$h[2]=(this.nearPlane-this.farPlane)*(k$g[2]+1)/2-this.nearPlane,k$gb.transformCoordinate(k$b,this.transform.worldMatrix,k$b),!0}return!1},k$o(0,k$b,"projectionViewMatrix",function(){return k$ab.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),k$o(0,k$b,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var k$a=this.viewport;return k$a.width/k$a.height},function(k$a){if(k$a<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=k$a,this._calculateProjectionMatrix()}),k$o(0,k$b,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),k$o(0,k$b,"needViewport",function(){var k$a=this.normalizedViewport;return 0===k$a.x&&0===k$a.y&&1===k$a.width&&1===k$a.height}),k$o(0,k$b,"viewport",function(){if(this._viewportExpressedInClipSpace){var k$a=this._normalizedViewport,k$b=this.renderTargetSize,k$c=k$b.width,k$d=k$b.height;this._viewport.x=k$a.x*k$c,this._viewport.y=k$a.y*k$d,this._viewport.width=k$a.width*k$c,this._viewport.height=k$a.height*k$d}return this._viewport},function(k$a){if(null!=this.renderTarget&&(k$a.x<0||k$a.y<0||0==k$a.width||0==k$a.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=k$a,this._calculateProjectionMatrix()}),k$o(0,k$b,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var k$a=this._viewport,k$b=this.renderTargetSize,k$c=k$b.width,k$d=k$b.height;this._normalizedViewport.x=k$a.x/k$c,this._normalizedViewport.y=k$a.y/k$d,this._normalizedViewport.width=k$a.width/k$c,this._normalizedViewport.height=k$a.height/k$d}return this._normalizedViewport},function(k$a){k$a.x<0&&(k$a.x=0,console.warn("Camera: viewport.x must large than 0.0.")),k$a.y<0&&(k$a.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<k$a.x+k$a.width&&(k$a.width=1-k$a.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<k$a.y+k$a.height&&(k$a.height=1-k$a.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=k$a,this._calculateProjectionMatrix()}),k$o(0,k$b,"projectionMatrix",function(){return this._projectionMatrix},function(k$a){this._projectionMatrix=k$a,this._useUserProjectionMatrix=!0}),k$o(0,k$b,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),k$l(k$g,["_tempVector20",function(){return this._tempVector20=new k$fb}]),k$g}()),k$Xb=function(k$c){function k$d(k$a,k$b){k$d.__super.call(this,k$b),this._geometryFilter=new k$Hb(this),this._render=new k$Ib(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),k$a&&(this._geometryFilter.sharedMesh=k$a)instanceof laya.d3.resource.models.Mesh&&(k$a.loaded?this._render.sharedMaterials=k$a.materials:k$a.once("loaded",this,this._applyMeshMaterials))}k$n(k$d,"laya.d3.core.MeshSprite3D",k$c);var k$a=k$d.prototype;return k$a._changeRenderObjectByMesh=function(k$a){var k$b=this._render._renderElements,k$c=k$b[k$a];k$c||(k$c=k$b[k$a]=new k$zb),k$c._render=this._render;var k$d=this._render.sharedMaterials[k$a];k$d||(k$d=k$Mb.defaultMaterial);var k$e=this._geometryFilter.sharedMesh.getRenderElement(k$a);return k$c._mainSortID=this._getSortID(k$e,k$d),k$c._sprite3D=this,k$c.renderObj=k$e,k$c._material=k$d,k$c},k$a._changeRenderObjectByMaterial=function(k$a,k$b){var k$c=this._render._renderElements[k$a];k$b||(k$b=k$Mb.defaultMaterial);var k$d=this._geometryFilter.sharedMesh.getRenderElement(k$a);return k$c._mainSortID=this._getSortID(k$d,k$b),k$c._sprite3D=this,k$c.renderObj=k$d,k$c._material=k$b,k$c},k$a._changeRenderObjectsByMesh=function(){var k$a=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=k$a;for(var k$b=0;k$b<k$a;k$b++)this._changeRenderObjectByMesh(k$b)},k$a._onMeshChanged=function(k$a){var k$b=k$a.sharedMesh;k$b.loaded?this._changeRenderObjectsByMesh():k$b.once("loaded",this,this._onMeshLoaded)},k$a._onMeshLoaded=function(k$a){k$a===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},k$a._onMaterialChanged=function(k$a,k$b,k$c){k$b<this._render._renderElements.length&&this._changeRenderObjectByMaterial(k$b,k$c)},k$a._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},k$a._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},k$a._parseCustomProps=function(k$a,k$b,k$c,k$d){var k$e=this.meshRender,k$f=k$c.lightmapIndex;null!=k$f&&(k$e.lightmapIndex=k$f);var k$g,k$h,k$i=k$c.lightmapScaleOffset;if(k$i&&(k$e.lightmapScaleOffset=new k$hb(k$i[0],k$i[1],k$i[2],k$i[3])),k$d.instanceParams)(k$g=k$d.instanceParams.loadPath)&&(k$h=k$r.getRes(k$b[k$g]),(this.meshFilter.sharedMesh=k$h).loaded?k$e.sharedMaterials=k$h.materials:k$h.once("loaded",this,this._applyMeshMaterials));else{(k$g=k$c.meshPath)&&(k$h=k$r.getRes(k$b[k$g]),this.meshFilter.sharedMesh=k$h);var k$j=k$c.materials;if(k$j){var k$k=k$e.sharedMaterials,k$l=k$j.length;k$k.length=k$l;for(var k$m=0;k$m<k$l;k$m++)k$k[k$m]=k$r.getRes(k$b[k$j[k$m].path]);k$e.sharedMaterials=k$k}}},k$a._applyMeshMaterials=function(k$a){for(var k$b=this._render.sharedMaterials,k$c=k$a.materials,k$d=0,k$e=k$c.length;k$d<k$e;k$d++)k$b[k$d]||(k$b[k$d]=k$c[k$d]);this._render.sharedMaterials=k$b},k$a._addToInitStaticBatchManager=function(){k$d._staticBatchManager._addInitBatchSprite(this)},k$a.cloneTo=function(k$a){var k$b=k$a;k$b._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var k$c=this._render,k$d=k$b._render;k$d.enable=k$c.enable,k$d.sharedMaterials=k$c.sharedMaterials,k$d.castShadow=k$c.castShadow;var k$e=k$c.lightmapScaleOffset;k$e&&(k$d.lightmapScaleOffset=k$e.clone()),k$d.lightmapIndex=k$c.lightmapIndex,k$d.receiveShadow=k$c.receiveShadow,k$d.sortingFudge=k$c.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,k$a)},k$a.destroy=function(k$a){if(void 0===k$a&&(k$a=!0),!this.destroyed){var k$b=this.meshFilter.sharedMesh;null!=k$b&&(k$b.loaded||k$b.off("loaded",this,this._applyMeshMaterials)),k$c.prototype.destroy.call(this,k$a),this._geometryFilter._destroy()}},k$o(0,k$a,"meshFilter",function(){return this._geometryFilter}),k$o(0,k$a,"meshRender",function(){return this._render}),k$d.__init__=function(){k$da._staticBatchManagers.push(k$d._staticBatchManager)},k$d.load=function(k$a){return k$x.loader.create(k$a,null,null,k$d)},k$l(k$d,["_staticBatchManager",function(){return this._staticBatchManager=new k$Bb}]),k$d}(k$Vb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(k$a,k$b){"use strict";for(var k$c in Object.defineProperty(k$b,"__esModule",{value:!0}),Laya){var k$d=Laya[k$c];k$d&&k$d.__isclass&&(k$b[k$c]=k$d)}}),function(k$a,k$b,k$ea){k$ea.un,k$ea.uns;var k$c=k$ea.static,k$d=k$ea.class,k$f=k$ea.getset,k$p=k$ea.__newvec,k$h=laya.maths.Bezier,k$l=laya.utils.Browser,k$Fa=laya.utils.Byte,k$e=(laya.events.Event,laya.events.EventDispatcher),k$g=laya.display.Graphics,k$i=(laya.resource.HTMLCanvas,laya.utils.Handler),k$j=laya.net.Loader,k$m=laya.maths.MathUtil,k$Ga=laya.maths.Matrix,k$q=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),k$k=(laya.renders.RenderContext,laya.resource.Resource),k$n=laya.utils.RunDriver,k$fa=laya.display.Sprite,k$o=laya.utils.Stat,k$Ha=laya.resource.Texture,k$r=(laya.net.URL,laya.utils.Utils),k$G=function(){function k$a(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return k$d(k$a,"laya.ani.AnimationContent"),k$a}(),k$H=function(){function k$a(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return k$d(k$a,"laya.ani.AnimationNodeContent"),k$a}(),k$t=function(){function k$a(){}return k$d(k$a,"laya.ani.AnimationParser01"),k$a.parse=function(k$a,k$b){var k$c=k$b.__getBuffer(),k$d=0,k$e=0,k$f=0,k$g=0,k$h=0,k$i=0,k$j=0,k$k=k$b.readUTFString();k$a._aniClassName=k$k;var k$l,k$m=k$b.readUTFString().split("\n"),k$n=k$b.getUint8(),k$o=k$b.getUint32(),k$p=k$b.getUint32();0<k$o&&(k$l=k$c.slice(k$o,k$p));var k$q=new k$Fa(k$l);for(0<k$p&&(k$a._publicExtData=k$c.slice(k$p,k$c.byteLength)),k$a._useParent=!!k$b.getUint8(),k$a._anis.length=k$n,k$d=0;k$d<k$n;k$d++){var k$r=k$a._anis[k$d]=new k$G;k$r.nodes=new Array;var k$s=k$r.name=k$m[k$b.getUint16()];k$a._aniMap[k$s]=k$d,k$r.bone3DMap={},k$r.playTime=k$b.getFloat32(),k$r.playTime<=0&&console.error("播放时间不能为0  url="+k$a.url+" name="+k$r.name);var k$t=k$r.nodes.length=k$b.getUint8();for(k$e=k$r.totalKeyframeDatasLength=0;k$e<k$t;k$e++){var k$w=k$r.nodes[k$e]=new k$H;k$w.childs=[];var k$x=k$b.getInt16();0<=k$x&&(k$w.name=k$m[k$x],k$r.bone3DMap[k$w.name]=k$e),k$w.keyFrame=new Array,k$w.parentIndex=k$b.getInt16(),-1==k$w.parentIndex?k$w.parent=null:k$w.parent=k$r.nodes[k$w.parentIndex],k$w.lerpType=k$b.getUint8();var k$y=k$b.getUint32();k$q.pos=k$y;var k$z=k$w.keyframeWidth=k$q.getUint16();if(k$r.totalKeyframeDatasLength+=k$z,0===k$w.lerpType||1===k$w.lerpType)for(k$w.interpolationMethod=[],k$w.interpolationMethod.length=k$z,k$f=0;k$f<k$z;k$f++)k$w.interpolationMethod[k$f]=k$K.interpolation[k$q.getUint8()];null!=k$w.parent&&k$w.parent.childs.push(k$w);var k$A=k$b.getUint16();0<k$A&&(k$w.extenData=k$c.slice(k$b.pos,k$b.pos+k$A),k$b.pos+=k$A);var k$B,k$C=k$b.getUint16(),k$D=0;for(k$f=0,k$g=k$w.keyFrame.length=k$C;k$f<k$g;k$f++){if((k$B=k$w.keyFrame[k$f]=new k$I).duration=k$b.getFloat32(),k$B.startTime=k$D,2===k$w.lerpType){k$B.interpolationData=[];var k$E,k$F=k$b.getUint8();switch(k$E=k$b.getFloat32()){case 254:for(k$B.interpolationData.length=k$z,k$j=0;k$j<k$z;k$j++)k$B.interpolationData[k$j]=0;break;case 255:for(k$B.interpolationData.length=k$z,k$j=0;k$j<k$z;k$j++)k$B.interpolationData[k$j]=5;break;default:for(k$B.interpolationData.push(k$E),k$i=1;k$i<k$F;k$i++)k$B.interpolationData.push(k$b.getFloat32())}}for(k$B.data=new Float32Array(k$z),k$h=0;k$h<k$z;k$h++)k$B.data[k$h]=k$b.getFloat32(),-1e-8<k$B.data[k$h]&&k$B.data[k$h]<1e-8&&(k$B.data[k$h]=0);k$D+=k$B.duration}k$B.startTime=k$r.playTime,k$w.playTime=k$r.playTime,k$a._calculateKeyFrame(k$w,k$C,k$z)}}},k$a}(),k$w=function(){function k$x(){}return k$d(k$x,"laya.ani.AnimationParser02"),k$x.READ_DATA=function(){k$x._DATA.offset=k$x._reader.getUint32(),k$x._DATA.size=k$x._reader.getUint32()},k$x.READ_BLOCK=function(){for(var k$a=k$x._BLOCK.count=k$x._reader.getUint16(),k$b=k$x._BLOCK.blockStarts=[],k$c=k$x._BLOCK.blockLengths=[],k$d=0;k$d<k$a;k$d++)k$b.push(k$x._reader.getUint32()),k$c.push(k$x._reader.getUint32())},k$x.READ_STRINGS=function(){var k$a=k$x._reader.getUint32(),k$b=k$x._reader.getUint16(),k$c=k$x._reader.pos;k$x._reader.pos=k$a+k$x._DATA.offset;for(var k$d=0;k$d<k$b;k$d++)k$x._strings[k$d]=k$x._reader.readUTFString();k$x._reader.pos=k$c},k$x.parse=function(k$a,k$b){k$x._templet=k$a;(k$x._reader=k$b).__getBuffer();k$x.READ_DATA(),k$x.READ_BLOCK(),k$x.READ_STRINGS();for(var k$c=0,k$d=k$x._BLOCK.count;k$c<k$d;k$c++){var k$e=k$b.getUint16(),k$f=k$x._strings[k$e],k$g=k$x["READ_"+k$f];if(null==k$g)throw new Error("model file err,no this function:"+k$e+" "+k$f);k$g.call()}},k$x.READ_ANIMATIONS=function(){var k$a=k$x._reader,k$b=k$a.__getBuffer(),k$c=0,k$d=0,k$e=0,k$f=0,k$g=k$a.getUint16(),k$h=[];for(k$h.length=k$g,k$c=0;k$c<k$g;k$c++)k$h[k$c]=k$K.interpolation[k$a.getByte()];var k$i=k$a.getUint8();for(k$x._templet._anis.length=k$i,k$c=0;k$c<k$i;k$c++){var k$j=k$x._templet._anis[k$c]={};k$j.nodes=new Array;var k$k=k$j.name=k$x._strings[k$a.getUint16()];k$x._templet._aniMap[k$k]=k$c,k$j.bone3DMap={},k$j.playTime=k$a.getFloat32();var k$l=k$j.nodes.length=k$a.getInt16();for(k$d=k$j.totalKeyframeDatasLength=0;k$d<k$l;k$d++){var k$m=k$j.nodes[k$d]={};k$m.keyframeWidth=k$g,k$m.childs=[];var k$n=k$a.getUint16();0<=k$n&&(k$m.name=k$x._strings[k$n],k$j.bone3DMap[k$m.name]=k$d),k$m.keyFrame=new Array,k$m.parentIndex=k$a.getInt16(),-1==k$m.parentIndex?k$m.parent=null:k$m.parent=k$j.nodes[k$m.parentIndex],k$j.totalKeyframeDatasLength+=k$g,k$m.interpolationMethod=k$h,null!=k$m.parent&&k$m.parent.childs.push(k$m);var k$o=k$a.getUint16(),k$p=null,k$q=null;for(k$e=0,k$f=k$m.keyFrame.length=k$o;k$e<k$f;k$e++){(k$p=k$m.keyFrame[k$e]={}).startTime=k$a.getFloat32(),k$q&&(k$q.duration=k$p.startTime-k$q.startTime);var k$r=k$x._DATA.offset,k$s=k$a.getUint32(),k$t=4*k$g,k$w=k$b.slice(k$r+k$s,k$r+k$s+k$t);k$p.data=new Float32Array(k$w),k$q=k$p}k$p.duration=0,k$m.playTime=k$j.playTime,k$x._templet._calculateKeyFrame(k$m,k$o,k$g)}}},k$x._templet=null,k$x._reader=null,k$x._strings=[],k$c(k$x,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),k$x}(),k$Ia=(function(){function k$a(){}k$d(k$a,"laya.ani.AnimationState"),k$a.stopped=0,k$a.paused=1,k$a.playing=2}(),function(){function k$e(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new k$Va,this.resultMatrix=new k$Ga,this._children=[]}k$d(k$e,"laya.ani.bone.Bone");var k$a=k$e.prototype;return k$a.setTempMatrix=function(k$a){this._tempMatrix=k$a;var k$b,k$c=0;for(k$c=0,k$b=this._children.length;k$c<k$b;k$c++)this._children[k$c].setTempMatrix(this._tempMatrix)},k$a.update=function(k$a){var k$b;if(this.rotation=this.transform.skX,k$a)k$b=this.resultTransform.getMatrix(),k$Ga.mul(k$b,k$a,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)k$b=this.resultTransform.getMatrix(),k$Ga.mul(k$b,this.parentBone.resultMatrix,this.resultMatrix);else{var k$c=this.parentBone,k$d=NaN,k$e=NaN,k$f=NaN,k$g=this.parentBone.resultMatrix;k$b=this.resultTransform.getMatrix();var k$h=k$g.a*k$b.tx+k$g.c*k$b.ty+k$g.tx,k$i=k$g.b*k$b.tx+k$g.d*k$b.ty+k$g.ty,k$j=new k$Ga;this.inheritRotation?(k$d=Math.atan2(k$c.resultMatrix.b,k$c.resultMatrix.a),k$e=Math.cos(k$d),k$f=Math.sin(k$d),k$j.setTo(k$e,k$f,-k$f,k$e,0,0),k$Ga.mul(this._tempMatrix,k$j,k$Ga.TEMP),k$Ga.TEMP.copyTo(k$j),k$b=this.resultTransform.getMatrix(),k$Ga.mul(k$b,k$j,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,k$b=this.resultTransform.getMatrix(),k$Ga.TEMP.identity(),k$Ga.TEMP.d=this.d,k$Ga.mul(k$b,k$Ga.TEMP,this.resultMatrix)),this.resultMatrix.tx=k$h,this.resultMatrix.ty=k$i}else(k$b=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var k$k,k$l=0;for(k$l=0,k$k=this._children.length;k$l<k$k;k$l++)this._children[k$l].update()},k$a.updateChild=function(){var k$a,k$b=0;for(k$b=0,k$a=this._children.length;k$b<k$a;k$b++)this._children[k$b].update()},k$a.setRotation=function(k$a){this._sprite&&(this._sprite.rotation=180*k$a/Math.PI)},k$a.updateDraw=function(k$a,k$b){k$e.ShowBones&&!k$e.ShowBones[this.name]||(this._sprite||(this._sprite=new k$fa,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),k$ea.stage.addChild(this._sprite)),this._sprite.x=k$a+this.resultMatrix.tx,this._sprite.y=k$b+this.resultMatrix.ty);var k$c,k$d=0;for(k$d=0,k$c=this._children.length;k$d<k$c;k$d++)this._children[k$d].updateDraw(k$a,k$b)},k$a.addChild=function(k$a){this._children.push(k$a),k$a.parentBone=this},k$a.findBone=function(k$a){if(this.name==k$a)return this;var k$b,k$c,k$d=0;for(k$d=0,k$b=this._children.length;k$d<k$b;k$d++)if(k$c=this._children[k$d].findBone(k$a))return k$c;return null},k$a.localToWorld=function(k$a){var k$b=k$a[0],k$c=k$a[1];k$a[0]=k$b*this.resultMatrix.a+k$c*this.resultMatrix.c+this.resultMatrix.tx,k$a[1]=k$b*this.resultMatrix.b+k$c*this.resultMatrix.d+this.resultMatrix.ty},k$e.ShowBones={},k$e}()),k$Ja=function(){function k$p(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}k$d(k$p,"laya.ani.bone.BoneSlot");var k$a=k$p.prototype;return k$a.showSlotData=function(k$a,k$b){void 0===k$b&&(k$b=!0),this.currSlotData=k$a,k$b&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},k$a.showDisplayByName=function(k$a){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(k$a))},k$a.replaceDisplayByName=function(k$a,k$b){if(this.currSlotData){var k$c;k$c=this.currSlotData.getDisplayByName(k$a);var k$d;k$d=this.currSlotData.getDisplayByName(k$b),this.replaceDisplayByIndex(k$c,k$d)}},k$a.replaceDisplayByIndex=function(k$a,k$b){this.currSlotData&&(this._replaceDic[k$a]=k$b,this.displayIndex==k$a&&this.showDisplayByIndex(k$a))},k$a.showDisplayByIndex=function(k$a){if(null!=this._replaceDic[k$a]&&(k$a=this._replaceDic[k$a]),this.currSlotData&&-1<k$a&&k$a<this.currSlotData.displayArr.length){if(this.displayIndex=k$a,this.currDisplayData=this.currSlotData.displayArr[k$a],this.currDisplayData){var k$b=this.currDisplayData.name;this.currTexture=this.templet.getTexture(k$b),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!k$q.isConchApp||k$q.isConchApp&&"0.9.15"<k$fa.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},k$a.replaceSkin=function(k$a){this._diyTexture=k$a,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},k$a.setParentMatrix=function(k$a){this._parentMatrix=k$a},k$a.draw=function(k$a,k$b,k$c,k$d){if(void 0===k$c&&(k$c=!1),void 0===k$d&&(k$d=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var k$e,k$f=this.currTexture;switch(this._diyTexture&&(k$f=this._diyTexture),this.currDisplayData.type){case 0:if(k$a){var k$g=this.getDisplayMatrix();if(this._parentMatrix){var k$h=!1;if(k$g){var k$i;if(k$Ga.mul(k$g,this._parentMatrix,k$Ga.TEMP),k$i=k$c?(null==this._resultMatrix&&(this._resultMatrix=new k$Ga),this._resultMatrix):new k$Ga,!k$q.isWebGL&&this.currDisplayData.uvs||k$q.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var k$j=k$p._tempMatrix;k$j.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(k$j.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(k$h=!0,k$j.rotate(-Math.PI/2)),k$Ga.mul(k$j,k$Ga.TEMP,k$i)}else k$Ga.TEMP.copyTo(k$i);k$h?k$a.drawTexture(k$f,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,k$i):k$a.drawTexture(k$f,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,k$i)}}}break;case 1:if(null==(k$e=k$c?(null==this._skinSprite&&(this._skinSprite=k$p.createSkinMesh()),this._skinSprite):k$p.createSkinMesh()))return;var k$k;if(null==this.currDisplayData.bones){var k$l,k$m=this.currDisplayData.weights;this.deformData&&(k$m=this.deformData),k$l=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=k$z.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=k$z.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=k$m;this.currDisplayData.triangles.length;k$k=this.currDisplayData.triangles,k$e.init2(k$f,null,k$k,this._mVerticleArr,k$l);var k$n,k$o=this.getDisplayMatrix();if(this._parentMatrix)if(k$o)k$Ga.mul(k$o,this._parentMatrix,k$Ga.TEMP),k$n=k$c?(null==this._resultMatrix&&(this._resultMatrix=new k$Ga),this._resultMatrix):new k$Ga,k$Ga.TEMP.copyTo(k$n),k$e.transform=k$n}else this.skinMesh(k$b,k$e,k$d);k$a.drawSkin(k$e);break;case 2:if(null==(k$e=k$c?(null==this._skinSprite&&(this._skinSprite=k$p.createSkinMesh()),this._skinSprite):k$p.createSkinMesh()))return;this.skinMesh(k$b,k$e,k$d),k$a.drawSkin(k$e)}}},k$a.skinMesh=function(k$a,k$b,k$c){var k$d,k$e=this.currTexture,k$f=this.currDisplayData.bones;k$d=this._diyTexture?(k$e=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=k$z.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=k$z.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var k$g,k$h,k$i=this.currDisplayData.weights,k$j=this.currDisplayData.triangles,k$k=0,k$l=0,k$m=0,k$n=NaN,k$o=NaN,k$p=0,k$q=0,k$r=[],k$s=0,k$t=0;if(this.deformData&&0<this.deformData.length){var k$w=0;for(k$s=0,k$t=k$f.length;k$s<k$t;){for(k$m=k$f[k$s++]+k$s,k$l=k$k=0;k$s<k$m;k$s++)k$h=k$a[k$f[k$s]],k$n=k$i[k$p]+this.deformData[k$w++],k$o=k$i[k$p+1]+this.deformData[k$w++],k$q=k$i[k$p+2],k$k+=(k$n*k$h.a+k$o*k$h.c+k$h.tx)*k$q,k$l+=(k$n*k$h.b+k$o*k$h.d+k$h.ty)*k$q,k$p+=3;k$r.push(k$k,k$l)}}else for(k$s=0,k$t=k$f.length;k$s<k$t;){for(k$m=k$f[k$s++]+k$s,k$l=k$k=0;k$s<k$m;k$s++)k$h=k$a[k$f[k$s]],k$n=k$i[k$p],k$o=k$i[k$p+1],k$q=k$i[k$p+2],k$k+=(k$n*k$h.a+k$o*k$h.c+k$h.tx)*k$q,k$l+=(k$n*k$h.b+k$o*k$h.d+k$h.ty)*k$q,k$p+=3;k$r.push(k$k,k$l)}this._mVerticleArr=k$r,k$g=k$j,k$b.init2(k$e,null,k$g,this._mVerticleArr,k$d)},k$a.drawBonePoint=function(k$a){k$a&&this._parentMatrix&&k$a.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},k$a.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},k$a.getMatrix=function(){return this._resultMatrix},k$a.copy=function(){var k$a=new k$p;return k$a.type="copy",k$a.name=this.name,k$a.attachmentName=this.attachmentName,k$a.srcDisplayIndex=this.srcDisplayIndex,k$a.parent=this.parent,k$a.displayIndex=this.displayIndex,k$a.templet=this.templet,k$a.currSlotData=this.currSlotData,k$a.currTexture=this.currTexture,k$a.currDisplayData=this.currDisplayData,k$a},k$p.createSkinMesh=function(){return k$q.isWebGL||k$q.isConchApp?k$n.skinAniSprite():(k$q.isWebGL,null)},k$c(k$p,["_tempMatrix",function(){return this._tempMatrix=new k$Ga}]),k$p}(),k$Ka=function(){function k$a(){this.skinName=null,this.deformSlotDataList=[]}return k$d(k$a,"laya.ani.bone.DeformAniData"),k$a}(),k$La=function(){function k$a(){this.deformSlotDisplayList=[]}return k$d(k$a,"laya.ani.bone.DeformSlotData"),k$a}(),k$Ma=function(){function k$a(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}k$d(k$a,"laya.ani.bone.DeformSlotDisplayData");var k$b=k$a.prototype;return k$b.binarySearch1=function(k$a,k$b){var k$c=0,k$d=k$a.length-2;if(0==k$d)return 1;for(var k$e=k$d>>>1;;){if(k$a[Math.floor(k$e+1)]<=k$b?k$c=k$e+1:k$d=k$e,k$c==k$d)return k$c+1;k$e=k$c+k$d>>>1}return 0},k$b.apply=function(k$a,k$b,k$c){if(void 0===k$c&&(k$c=1),k$a+=.05,!(this.timeList.length<=0)){var k$d=0;if(!(k$a<this.timeList[0])){var k$e=this.vectices[0].length,k$f=[],k$g=this.binarySearch1(this.timeList,k$a);if(this.frameIndex=k$g,k$a>=this.timeList[this.timeList.length-1]){var k$h=this.vectices[this.vectices.length-1];if(k$c<1)for(k$d=0;k$d<k$e;k$d++)k$f[k$d]+=(k$h[k$d]-k$f[k$d])*k$c;else for(k$d=0;k$d<k$e;k$d++)k$f[k$d]=k$h[k$d];this.deformData=k$f}else{this.tweenKeyList[this.frameIndex];var k$i=this.vectices[this.frameIndex-1],k$j=this.vectices[this.frameIndex],k$k=this.timeList[this.frameIndex-1],k$l=this.timeList[this.frameIndex];k$c=this.tweenKeyList[k$g-1]?(k$a-k$k)/(k$l-k$k):0;var k$m=NaN;for(k$d=0;k$d<k$e;k$d++)k$m=k$i[k$d],k$f[k$d]=k$m+(k$j[k$d]-k$m)*k$c;this.deformData=k$f}}}},k$a}(),k$Na=function(){function k$a(){this.time=NaN,this.drawOrder=[]}return k$d(k$a,"laya.ani.bone.DrawOrderData"),k$a}(),k$Oa=function(){function k$a(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return k$d(k$a,"laya.ani.bone.EventData"),k$a}(),k$s=function(){function k$da(k$a,k$b){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=k$a,this._targetBone=k$b[k$a.targetBoneIndex],this.isSpine=k$a.isSpine,null==this._bones&&(this._bones=[]);for(var k$c=this._bones.length=0,k$d=k$a.boneIndexs.length;k$c<k$d;k$c++)this._bones.push(k$b[k$a.boneIndexs[k$c]]);this.name=k$a.name,this.mix=k$a.mix,this.bendDirection=k$a.bendDirection}k$d(k$da,"laya.ani.bone.IkConstraint");var k$a=k$da.prototype;return k$a.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},k$a._applyIk1=function(k$a,k$b,k$c,k$d){var k$e=k$a.parentBone,k$f=1/(k$e.resultMatrix.a*k$e.resultMatrix.d-k$e.resultMatrix.b*k$e.resultMatrix.c),k$g=k$b-k$e.resultMatrix.tx,k$h=k$c-k$e.resultMatrix.ty,k$i=(k$g*k$e.resultMatrix.d-k$h*k$e.resultMatrix.c)*k$f-k$a.transform.x,k$j=(k$h*k$e.resultMatrix.a-k$g*k$e.resultMatrix.b)*k$f-k$a.transform.y,k$k=Math.atan2(k$j,k$i)*k$da.radDeg-0-k$a.transform.skX;k$a.transform.scX<0&&(k$k+=180),180<k$k?k$k-=360:k$k<-180&&(k$k+=360),k$a.transform.skX=k$a.transform.skY=k$a.transform.skX+k$k*k$d,k$a.update()},k$a.updatePos=function(k$a,k$b){this._sp&&this._sp.pos(k$a,k$b)},k$a._applyIk2=function(k$a,k$b,k$c,k$d,k$e,k$f){if(0!=k$f){var k$g=k$a.resultTransform.x,k$h=k$a.resultTransform.y,k$i=k$a.transform.scX,k$j=k$a.transform.scY,k$k=k$b.transform.scX,k$l=0,k$m=0,k$n=0;k$n=k$i<0?(k$i=-k$i,k$l=180,-1):(k$l=0,1),k$j<0&&(k$j=-k$j,k$n=-k$n),k$m=k$k<0?(k$k=-k$k,180):0;var k$o=k$b.resultTransform.x,k$p=NaN,k$q=NaN,k$r=NaN,k$s=k$a.resultMatrix.a,k$t=k$a.resultMatrix.c,k$w=k$a.resultMatrix.b,k$x=k$a.resultMatrix.d,k$y=Math.abs(k$i-k$j)<=1e-4;k$r=k$y?(k$q=k$s*k$o+k$t*(k$p=k$b.resultTransform.y)+k$a.resultMatrix.tx,k$w*k$o+k$x*k$p+k$a.resultMatrix.ty):(k$p=0,k$q=k$s*k$o+k$a.resultMatrix.tx,k$w*k$o+k$a.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new k$fa,k$ea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(k$c,k$d,15,"#ffff00"),this._sp.graphics.drawCircle(k$q,k$r,15,"#ff00ff")),k$a.setRotation(Math.atan2(k$r-k$a.resultMatrix.ty,k$q-k$a.resultMatrix.tx));var k$z=k$a.parentBone;k$s=k$z.resultMatrix.a,k$t=k$z.resultMatrix.c,k$w=k$z.resultMatrix.b;var k$A=1/(k$s*(k$x=k$z.resultMatrix.d)-k$t*k$w),k$B=k$c-k$z.resultMatrix.tx,k$C=k$d-k$z.resultMatrix.ty,k$D=(k$B*k$x-k$C*k$t)*k$A-k$g,k$E=(k$C*k$s-k$B*k$w)*k$A-k$h,k$F=((k$B=k$q-k$z.resultMatrix.tx)*k$x-(k$C=k$r-k$z.resultMatrix.ty)*k$t)*k$A-k$g,k$G=(k$C*k$s-k$B*k$w)*k$A-k$h,k$H=Math.sqrt(k$F*k$F+k$G*k$G),k$I=k$b.length*k$k,k$J=NaN,k$K=NaN;if(k$y){var k$L=(k$D*k$D+k$E*k$E-k$H*k$H-(k$I*=k$i)*k$I)/(2*k$H*k$I);k$L<-1?k$L=-1:1<k$L&&(k$L=1),k$K=Math.acos(k$L)*k$e,k$s=k$H+k$I*k$L,k$t=k$I*Math.sin(k$K),k$J=Math.atan2(k$E*k$s-k$D*k$t,k$D*k$s+k$E*k$t)}else{var k$M=(k$s=k$i*k$I)*k$s,k$N=(k$t=k$j*k$I)*k$t,k$O=k$D*k$D+k$E*k$E,k$P=Math.atan2(k$E,k$D),k$Q=-2*k$N*k$H,k$R=k$N-k$M;if(0<(k$x=k$Q*k$Q-4*k$R*(k$w=k$N*k$H*k$H+k$M*k$O-k$M*k$N))){var k$S=Math.sqrt(k$x);k$Q<0&&(k$S=-k$S);var k$T=(k$S=-(k$Q+k$S)/2)/k$R,k$U=k$w/k$S,k$V=Math.abs(k$T)<Math.abs(k$U)?k$T:k$U;k$V*k$V<=k$O&&(k$C=Math.sqrt(k$O-k$V*k$V)*k$e,k$J=k$P-Math.atan2(k$C,k$V),k$K=Math.atan2(k$C/k$j,(k$V-k$H)/k$i))}var k$W=0,k$X=Number.MAX_VALUE,k$Y=0,k$Z=0,k$$=0,k$_=0,k$u=0,k$v=0;k$_<(k$x=(k$B=k$H+k$s)*k$B)&&(k$$=0,k$_=k$x,k$u=k$B),(k$x=(k$B=k$H-k$s)*k$B)<k$X&&(k$W=Math.PI,k$X=k$x,k$Y=k$B);var k$aa=Math.acos(-k$s*k$H/(k$M-k$N));(k$x=(k$B=k$s*Math.cos(k$aa)+k$H)*k$B+(k$C=k$t*Math.sin(k$aa))*k$C)<k$X&&(k$W=k$aa,k$X=k$x,k$Y=k$B,k$Z=k$C),k$_<k$x&&(k$$=k$aa,k$_=k$x,k$u=k$B,k$v=k$C),k$K=k$O<=(k$X+k$_)/2?(k$J=k$P-Math.atan2(k$Z*k$e,k$Y),k$W*k$e):(k$J=k$P-Math.atan2(k$v*k$e,k$u),k$$*k$e)}var k$ba=Math.atan2(k$p,k$o)*k$n,k$ca=k$a.resultTransform.skX;180<(k$J=(k$J-k$ba)*k$da.radDeg+k$l-k$ca)?k$J-=360:k$J<-180&&(k$J+=360),k$a.resultTransform.x=k$g,k$a.resultTransform.y=k$h,k$a.resultTransform.skX=k$a.resultTransform.skY=k$ca+k$J*k$f,k$ca=k$b.resultTransform.skX,180<(k$K=((k$K+k$ba)*k$da.radDeg-0)*k$n+k$m-(k$ca%=360))?k$K-=360:k$K<-180&&(k$K+=360),k$b.resultTransform.x=k$o,k$b.resultTransform.y=k$p,k$b.resultTransform.skX=k$b.resultTransform.skY=k$b.resultTransform.skY+k$K*k$f,k$a.update()}},k$a._applyIk3=function(k$a,k$b,k$c,k$d,k$e,k$f){if(0!=k$f){var k$g,k$h,k$i=k$b.resultMatrix.a*k$b.length,k$j=k$b.resultMatrix.b*k$b.length,k$k=k$i*k$i+k$j*k$j,k$l=Math.sqrt(k$k),k$m=k$a.resultMatrix.tx,k$n=k$a.resultMatrix.ty,k$o=k$b.resultMatrix.tx,k$p=k$b.resultMatrix.ty,k$q=k$o-k$m,k$r=k$p-k$n,k$s=k$q*k$q+k$r*k$r,k$t=Math.sqrt(k$s),k$w=(k$q=k$c-k$a.resultMatrix.tx)*k$q+(k$r=k$d-k$a.resultMatrix.ty)*k$r,k$x=Math.sqrt(k$w);if(k$l+k$t<=k$x||k$x+k$l<=k$t||k$x+k$t<=k$l){var k$y=NaN;k$o=k$m+(k$y=k$l+k$t<=k$x?1:-1)*(k$c-k$m)*k$t/k$x,k$p=k$n+k$y*(k$d-k$n)*k$t/k$x}else{var k$z=(k$s-k$k+k$w)/(2*k$w),k$A=Math.sqrt(k$s-k$z*k$z*k$w)/k$x,k$B=k$m+k$q*k$z,k$C=k$n+k$r*k$z,k$D=-k$r*k$A,k$E=k$q*k$A;k$p=0<k$e?(k$o=k$B-k$D,k$C-k$E):(k$o=k$B+k$D,k$C+k$E)}k$g=k$o,k$h=k$p,this.isDebug&&(this._sp||(this._sp=new k$fa,k$ea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(k$m,k$n,15,"#ff00ff"),this._sp.graphics.drawCircle(k$c,k$d,15,"#ffff00"),this._sp.graphics.drawCircle(k$g,k$h,15,"#ff00ff"));var k$F,k$G;k$F=Math.atan2(k$h-k$a.resultMatrix.ty,k$g-k$a.resultMatrix.tx),k$a.setRotation(k$F),(k$G=k$da._tempMatrix).identity(),k$G.rotate(k$F),k$G.scale(k$a.resultMatrix.getScaleX(),k$a.resultMatrix.getScaleY()),k$G.translate(k$a.resultMatrix.tx,k$a.resultMatrix.ty),k$G.copyTo(k$a.resultMatrix),k$a.updateChild();var k$H,k$I;k$H=Math.atan2(k$d-k$h,k$c-k$g),k$b.setRotation(k$H),(k$I=k$da._tempMatrix).identity(),k$I.rotate(k$H),k$I.scale(k$b.resultMatrix.getScaleX(),k$b.resultMatrix.getScaleY()),k$I.translate(k$g,k$h),k$G.copyTo(k$b.resultMatrix),k$b.updateChild()}},k$c(k$da,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new k$Ga}]),k$da}(),k$Pa=function(){function k$a(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return k$d(k$a,"laya.ani.bone.IkConstraintData"),k$a}(),k$x=function(){function k$I(k$a,k$b){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=k$a,this.position=k$a.position,this.spacing=k$a.spacing,this.rotateMix=k$a.rotateMix,this.translateMix=k$a.translateMix,this.bones=[];for(var k$c=this.data.bones,k$d=0,k$e=k$c.length;k$d<k$e;k$d++)this.bones.push(k$b[k$c[k$d]])}k$d(k$I,"laya.ani.bone.PathConstraint");var k$a=k$I.prototype;return k$a.apply=function(k$a,k$b){if(this.target){var k$c=this.translateMix,k$d=this.translateMix,k$e=0<k$d,k$f=this.data.spacingMode,k$g="length"==k$f,k$h=this.data.rotateMode,k$i="tangent"==k$h,k$j="chainScale"==k$h,k$k=[],k$l=this.bones.length,k$m=k$i?k$l:k$l+1,k$n=[];(this._spaces=k$n)[0]=this.position;var k$o=this.spacing;if(k$j||k$g)for(var k$p=0,k$q=k$m-1;k$p<k$q;){var k$r=this.bones[k$p],k$s=k$r.length,k$t=k$s*k$r.resultMatrix.a,k$w=k$s*k$r.resultMatrix.b;k$s=Math.sqrt(k$t*k$t+k$w*k$w),k$j&&(k$k[k$p]=k$s),k$n[++k$p]=k$g?Math.max(0,k$s+k$o):k$o}else for(k$p=1;k$p<k$m;k$p++)k$n[k$p]=k$o;var k$x=this.computeWorldPositions(this.target,k$a,k$b,k$m,k$i,"percent"==this.data.positionMode,"percent"==k$f);if(this._debugKey){for(k$p=0;k$p<k$x.length;k$p++)k$b.drawCircle(k$x[k$p++],k$x[k$p++],5,"#00ff00");var k$y=[];for(k$p=0;k$p<k$x.length;k$p++)k$y.push(k$x[k$p++],k$x[k$p++]);k$b.drawLines(0,0,k$y,"#ff0000")}var k$z=k$x[0],k$A=k$x[1],k$B=this.data.offsetRotation,k$C="chain"==k$h&&0==k$B,k$D=NaN;for(k$p=0,k$D=3;k$p<k$l;k$p++,k$D+=3){(k$r=this.bones[k$p]).resultMatrix.tx+=(k$z-k$r.resultMatrix.tx)*k$c,k$r.resultMatrix.ty+=(k$A-k$r.resultMatrix.ty)*k$c;var k$E=(k$t=k$x[k$D])-k$z,k$F=(k$w=k$x[k$D+1])-k$A;if(k$j&&0!=(k$s=k$k[k$p])){var k$G=(Math.sqrt(k$E*k$E+k$F*k$F)/k$s-1)*k$d+1;k$r.resultMatrix.a*=k$G,k$r.resultMatrix.c*=k$G}if(k$z=k$t,k$A=k$w,k$e){var k$H=k$r.resultMatrix.a,k$I=k$r.resultMatrix.c,k$J=k$r.resultMatrix.b,k$K=k$r.resultMatrix.d,k$L=NaN,k$M=NaN,k$N=NaN;k$L=k$i?k$x[k$D-1]:0==k$n[k$p+1]?k$x[k$D+2]:Math.atan2(k$F,k$E),k$L-=Math.atan2(k$J,k$H)-k$B/180*Math.PI,k$C&&(k$M=Math.cos(k$L),k$N=Math.sin(k$L),k$z+=((k$s=k$r.length)*(k$M*k$H-k$N*k$J)-k$E)*k$d,k$A+=(k$s*(k$N*k$H+k$M*k$J)-k$F)*k$d),k$L>Math.PI?k$L-=2*Math.PI:k$L<-Math.PI&&(k$L+=2*Math.PI),k$L*=k$d,k$M=Math.cos(k$L),k$N=Math.sin(k$L),k$r.resultMatrix.a=k$M*k$H-k$N*k$J,k$r.resultMatrix.c=k$M*k$I-k$N*k$K,k$r.resultMatrix.b=k$N*k$H+k$M*k$J,k$r.resultMatrix.d=k$N*k$I+k$M*k$K}}}},k$a.computeWorldVertices2=function(k$a,k$b,k$c,k$d,k$e,k$f){var k$g,k$h,k$i=k$a.currDisplayData.bones,k$j=k$a.currDisplayData.weights,k$k=k$a.currDisplayData.triangles,k$l=0,k$m=0,k$n=0,k$o=0,k$p=0,k$q=0,k$r=0,k$s=0,k$t=0,k$w=0,k$x=0;if(null!=k$i){for(k$l=0;k$l<k$c;k$l+=2)k$m+=(k$o=k$i[k$m])+1,k$n+=k$o;var k$y=k$b;for(k$p=k$f,k$q=3*k$n;k$p<k$d;k$p+=2){for(k$s=k$r=0,k$o=k$i[k$m++],k$o+=k$m;k$m<k$o;k$m++,k$q+=3){k$g=k$y[k$i[k$m]].resultMatrix,k$t=k$j[k$q],k$w=k$j[k$q+1];var k$z=k$j[k$q+2];k$r+=(k$t*k$g.a+k$w*k$g.c+k$g.tx)*k$z,k$s+=(k$t*k$g.b+k$w*k$g.d+k$g.ty)*k$z}k$e[k$p]=k$r,k$e[k$p+1]=k$s}}else{var k$A,k$B;if(k$k||(k$k=k$j),k$a.deformData&&(k$k=k$a.deformData),k$A=k$a.parent,k$b)for(k$x=k$b.length,k$l=0;k$l<k$x;k$l++)if(k$b[k$l].name==k$A){k$h=k$b[k$l];break}k$h&&(k$B=k$h.resultMatrix),k$B||(k$B=k$I._tempMt);var k$C=k$B.tx,k$D=k$B.ty,k$E=k$B.a,k$F=k$B.b,k$G=k$B.c,k$H=k$B.d;for(k$h&&(k$H*=k$h.d),k$m=k$c,k$p=k$f;k$p<k$d;k$m+=2,k$p+=2)k$t=k$k[k$m],k$w=k$k[k$m+1],k$e[k$p]=k$t*k$E+k$w*k$F+k$C,k$e[k$p+1]=-(k$t*k$G+k$w*k$H+k$D)}},k$a.computeWorldPositions=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g){k$a.currDisplayData.bones,k$a.currDisplayData.weights,k$a.currDisplayData.triangles;var k$h=[],k$i=0,k$j=k$a.currDisplayData.verLen,k$k=this.position,k$l=this._spaces,k$m=[],k$n=[],k$o=k$j/6,k$p=-1,k$q=NaN,k$r=0,k$s=0,k$t=NaN,k$w=NaN,k$x=NaN,k$y=NaN;if(k$o--,k$j-=4,this.computeWorldVertices2(k$a,k$b,2,k$j,k$h,0),this._debugKey)for(k$i=0;k$i<k$h.length;)k$c.drawCircle(k$h[k$i++],k$h[k$i++],10,"#ff0000");k$m=k$h,this._curves.length=k$o;var k$z=this._curves,k$A=k$m[k$q=0],k$B=k$m[1],k$C=0,k$D=0,k$E=0,k$F=0,k$G=0,k$H=0,k$I=NaN,k$J=NaN,k$K=NaN,k$L=NaN,k$M=NaN,k$N=NaN,k$O=NaN,k$P=NaN,k$Q=0;for(k$i=0,k$Q=2;k$i<k$o;k$i++,k$Q+=6)k$C=k$m[k$Q],k$D=k$m[k$Q+1],k$E=k$m[k$Q+2],k$F=k$m[k$Q+3],k$M=2*(k$I=.1875*(k$A-2*k$C+k$E))+(k$K=.09375*(3*(k$C-k$E)-k$A+(k$G=k$m[k$Q+4]))),k$N=2*(k$J=.1875*(k$B-2*k$D+k$F))+(k$L=.09375*(3*(k$D-k$F)-k$B+(k$H=k$m[k$Q+5]))),k$O=.75*(k$C-k$A)+k$I+.16666667*k$K,k$P=.75*(k$D-k$B)+k$J+.16666667*k$L,k$q+=Math.sqrt(k$O*k$O+k$P*k$P),k$O+=k$M,k$P+=k$N,k$M+=k$K,k$N+=k$L,k$q+=Math.sqrt(k$O*k$O+k$P*k$P),k$O+=k$M,k$P+=k$N,k$q+=Math.sqrt(k$O*k$O+k$P*k$P),k$O+=k$M+k$K,k$P+=k$N+k$L,k$q+=Math.sqrt(k$O*k$O+k$P*k$P),k$z[k$i]=k$q,k$A=k$G,k$B=k$H;if(k$f&&(k$k*=k$q),k$g)for(k$i=0;k$i<k$d;k$i++)k$l[k$i]*=k$q;var k$R=this._segments,k$S=0,k$T=0;for(k$T=k$s=k$r=k$i=0;k$i<k$d;k$i++,k$r+=3)if((k$t=k$k+=k$w=k$l[k$i])<0)this.addBeforePosition(k$t,k$m,0,k$n,k$r);else if(k$q<k$t)this.addAfterPosition(k$t-k$q,k$m,k$j-4,k$n,k$r);else{for(;;k$s++)if(!((k$y=k$z[k$s])<k$t)){0==k$s?k$t/=k$y:k$t=(k$t-(k$x=k$z[k$s-1]))/(k$y-k$x);break}if(k$s!=k$p){var k$U=6*(k$p=k$s);for(k$A=k$m[k$U],k$B=k$m[k$U+1],k$C=k$m[k$U+2],k$D=k$m[k$U+3],k$E=k$m[k$U+4],k$F=k$m[k$U+5],k$M=2*(k$I=.03*(k$A-2*k$C+k$E))+(k$K=.006*(3*(k$C-k$E)-k$A+(k$G=k$m[k$U+6]))),k$N=2*(k$J=.03*(k$B-2*k$D+k$F))+(k$L=.006*(3*(k$D-k$F)-k$B+(k$H=k$m[k$U+7]))),k$O=.3*(k$C-k$A)+k$I+.16666667*k$K,k$P=.3*(k$D-k$B)+k$J+.16666667*k$L,k$S=Math.sqrt(k$O*k$O+k$P*k$P),k$R[0]=k$S,k$U=1;k$U<8;k$U++)k$O+=k$M,k$P+=k$N,k$M+=k$K,k$N+=k$L,k$S+=Math.sqrt(k$O*k$O+k$P*k$P),k$R[k$U]=k$S;k$O+=k$M,k$P+=k$N,k$S+=Math.sqrt(k$O*k$O+k$P*k$P),k$R[8]=k$S,k$O+=k$M+k$K,k$P+=k$N+k$L,k$S+=Math.sqrt(k$O*k$O+k$P*k$P),k$R[9]=k$S,k$T=0}for(k$t*=k$S;;k$T++)if(!((k$y=k$R[k$T])<k$t)){0==k$T?k$t/=k$y:k$t=k$T+(k$t-(k$x=k$R[k$T-1]))/(k$y-k$x);break}this.addCurvePosition(.1*k$t,k$A,k$B,k$C,k$D,k$E,k$F,k$G,k$H,k$n,k$r,k$e||0<k$i&&0==k$w)}return k$n},k$a.addBeforePosition=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$b[k$c],k$g=k$b[k$c+1],k$h=k$b[k$c+2]-k$f,k$i=k$b[k$c+3]-k$g,k$j=Math.atan2(k$i,k$h);k$d[k$e]=k$f+k$a*Math.cos(k$j),k$d[k$e+1]=k$g+k$a*Math.sin(k$j),k$d[k$e+2]=k$j},k$a.addAfterPosition=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$b[k$c+2],k$g=k$b[k$c+3],k$h=k$f-k$b[k$c],k$i=k$g-k$b[k$c+1],k$j=Math.atan2(k$i,k$h);k$d[k$e]=k$f+k$a*Math.cos(k$j),k$d[k$e+1]=k$g+k$a*Math.sin(k$j),k$d[k$e+2]=k$j},k$a.addCurvePosition=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k,k$l){0==k$a&&(k$a=1e-4);var k$m=k$a*k$a,k$n=k$m*k$a,k$o=1-k$a,k$p=k$o*k$o,k$q=k$p*k$o,k$r=k$o*k$a,k$s=3*k$r,k$t=k$o*k$s,k$w=k$s*k$a,k$x=k$b*k$q+k$d*k$t+k$f*k$w+k$h*k$n,k$y=k$c*k$q+k$e*k$t+k$g*k$w+k$i*k$n;k$j[k$k]=k$x,k$j[k$k+1]=k$y,k$j[k$k+2]=k$l?Math.atan2(k$y-(k$c*k$p+k$e*k$r*2+k$g*k$m),k$x-(k$b*k$p+k$d*k$r*2+k$f*k$m)):0},k$I.NONE=-1,k$I.BEFORE=-2,k$I.AFTER=-3,k$c(k$I,["_tempMt",function(){return this._tempMt=new k$Ga}]),k$I}(),k$Qa=function(){function k$a(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return k$d(k$a,"laya.ani.bone.PathConstraintData"),k$a}(),k$Ra=function(){function k$a(){this.name=null,this.slotArr=[]}return k$d(k$a,"laya.ani.bone.SkinData"),k$a}(),k$Sa=function(){function k$a(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}k$d(k$a,"laya.ani.bone.SkinSlotDisplayData");var k$b=k$a.prototype;return k$b.createTexture=function(k$a){return this.texture||(this.texture=new k$Ha(k$a.bitmap,this.uvs),k$a.bitmap.alphaTexture&&(this.texture.alphaTexture=new k$Ha(k$a.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=k$a.height,this.texture.height=k$a.width,this.texture.offsetX=-k$a.offsetX,this.texture.offsetY=-k$a.offsetY,this.texture.sourceWidth=k$a.sourceHeight,this.texture.sourceHeight=k$a.sourceWidth):(this.texture.width=k$a.width,this.texture.height=k$a.height,this.texture.offsetX=-k$a.offsetX,this.texture.offsetY=-k$a.offsetY,this.texture.sourceWidth=k$a.sourceWidth,this.texture.sourceHeight=k$a.sourceHeight),k$q.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},k$b.destory=function(){this.texture&&this.texture.destroy()},k$a}(),k$Ta=function(){function k$a(){this.name=null,this.displayArr=[]}return k$d(k$a,"laya.ani.bone.SlotData"),k$a.prototype.getDisplayByName=function(k$a){for(var k$b=0,k$c=this.displayArr.length;k$b<k$c;k$b++)if(this.displayArr[k$b].attachmentName==k$a)return k$b;return-1},k$a}(),k$y=function(){function k$a(k$a,k$b){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=k$p(2,0),this._data=k$a,null==this._bones&&(this._bones=[]),this.target=k$b[k$a.targetIndex];var k$c,k$d=0;for(k$d=0,k$c=k$a.boneIndexs.length;k$d<k$c;k$d++)this._bones.push(k$b[k$a.boneIndexs[k$d]]);this.rotateMix=k$a.rotateMix,this.translateMix=k$a.translateMix,this.scaleMix=k$a.scaleMix,this.shearMix=k$a.shearMix}return k$d(k$a,"laya.ani.bone.TfConstraint"),k$a.prototype.apply=function(){for(var k$a,k$b=this.target.resultMatrix.a,k$c=this.target.resultMatrix.b,k$d=this.target.resultMatrix.c,k$e=this.target.resultMatrix.d,k$f=0,k$g=this._bones.length;k$f<k$g;k$f++){if(k$a=this._bones[k$f],0<this.rotateMix){var k$h=k$a.resultMatrix.a,k$i=k$a.resultMatrix.b,k$j=k$a.resultMatrix.c,k$k=k$a.resultMatrix.d,k$l=Math.atan2(k$d,k$b)-Math.atan2(k$j,k$h)+this._data.offsetRotation*Math.PI/180;k$l>Math.PI?k$l-=2*Math.PI:k$l<-Math.PI&&(k$l+=2*Math.PI),k$l*=this.rotateMix;var k$m=Math.cos(k$l),k$n=Math.sin(k$l);k$a.resultMatrix.a=k$m*k$h-k$n*k$j,k$a.resultMatrix.b=k$m*k$i-k$n*k$k,k$a.resultMatrix.c=k$n*k$h+k$m*k$j,k$a.resultMatrix.d=k$n*k$i+k$m*k$k}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),k$a.resultMatrix.tx+=(this._temp[0]-k$a.resultMatrix.tx)*this.translateMix,k$a.resultMatrix.ty+=(this._temp[1]-k$a.resultMatrix.ty)*this.translateMix,k$a.updateChild()),0<this.scaleMix){var k$o=Math.sqrt(k$a.resultMatrix.a*k$a.resultMatrix.a+k$a.resultMatrix.c*k$a.resultMatrix.c),k$p=Math.sqrt(k$b*k$b+k$d*k$d),k$q=1e-5<k$o?(k$o+(k$p-k$o+this._data.offsetScaleX)*this.scaleMix)/k$o:0;k$a.resultMatrix.a*=k$q,k$a.resultMatrix.c*=k$q,k$o=Math.sqrt(k$a.resultMatrix.b*k$a.resultMatrix.b+k$a.resultMatrix.d*k$a.resultMatrix.d),k$p=Math.sqrt(k$c*k$c+k$e*k$e),k$q=1e-5<k$o?(k$o+(k$p-k$o+this._data.offsetScaleY)*this.scaleMix)/k$o:0,k$a.resultMatrix.b*=k$q,k$a.resultMatrix.d*=k$q}if(0<this.shearMix){k$i=k$a.resultMatrix.b,k$k=k$a.resultMatrix.d;var k$r=Math.atan2(k$k,k$i);(k$l=Math.atan2(k$e,k$c)-Math.atan2(k$d,k$b)-(k$r-Math.atan2(k$a.resultMatrix.c,k$a.resultMatrix.a)))>Math.PI?k$l-=2*Math.PI:k$l<-Math.PI&&(k$l+=2*Math.PI),k$l=k$r+(k$l+this._data.offsetShearY*Math.PI/180)*this.shearMix,k$q=Math.sqrt(k$i*k$i+k$k*k$k),k$a.resultMatrix.b=Math.cos(k$l)*k$q,k$a.resultMatrix.d=Math.sin(k$l)*k$q}}},k$a}(),k$Ua=function(){function k$a(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return k$d(k$a,"laya.ani.bone.TfConstraintData"),k$a}(),k$Va=function(){function k$a(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}k$d(k$a,"laya.ani.bone.Transform");var k$b=k$a.prototype;return k$b.initData=function(k$a){null!=k$a.x&&(this.x=k$a.x),null!=k$a.y&&(this.y=k$a.y),null!=k$a.skX&&(this.skX=k$a.skX),null!=k$a.skY&&(this.skY=k$a.skY),null!=k$a.scX&&(this.scX=k$a.scX),null!=k$a.scY&&(this.scY=k$a.scY)},k$b.getMatrix=function(){var k$a;return(k$a=this.mMatrix?this.mMatrix:this.mMatrix=new k$Ga).identity(),k$a.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(k$a,this.skewX*Math.PI/180,this.skewY*Math.PI/180),k$a.rotate(this.skX*Math.PI/180),k$a.translate(this.x,this.y),k$a},k$b.skew=function(k$a,k$b,k$c){var k$d=Math.sin(k$c),k$e=Math.cos(k$c),k$f=Math.sin(k$b),k$g=Math.cos(k$b);return k$a.setTo(k$a.a*k$g-k$a.b*k$d,k$a.a*k$f+k$a.b*k$e,k$a.c*k$g-k$a.d*k$d,k$a.c*k$f+k$a.d*k$e,k$a.tx*k$g-k$a.ty*k$d,k$a.tx*k$f+k$a.ty*k$e),k$a},k$a}(),k$z=function(){function k$a(){}return k$d(k$a,"laya.ani.bone.UVTools"),k$a.getRelativeUV=function(k$a,k$b,k$c){var k$d=k$a[0],k$e=k$a[2]-k$a[0],k$f=k$a[1],k$g=k$a[5]-k$a[1];k$c||(k$c=[]),k$c.length=k$b.length;var k$h,k$i=0;k$h=k$c.length;var k$j=1/k$e,k$k=1/k$g;for(k$i=0;k$i<k$h;k$i+=2)k$c[k$i]=(k$b[k$i]-k$d)*k$j,k$c[k$i+1]=(k$b[k$i+1]-k$f)*k$k;return k$c},k$a.getAbsoluteUV=function(k$a,k$b,k$c){if(0==k$a[0]&&0==k$a[1]&&1==k$a[4]&&1==k$a[5])return k$c?(k$r.copyArray(k$c,k$b),k$c):k$b;var k$d=k$a[0],k$e=k$a[2]-k$a[0],k$f=k$a[1],k$g=k$a[5]-k$a[1];k$c||(k$c=[]),k$c.length=k$b.length;var k$h,k$i=0;for(k$h=k$c.length,k$i=0;k$i<k$h;k$i+=2)k$c[k$i]=k$b[k$i]*k$e+k$d,k$c[k$i+1]=k$b[k$i+1]*k$g+k$f;return k$c},k$a}(),k$I=function(){function k$a(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return k$d(k$a,"laya.ani.KeyFramesContent"),k$a}(),k$A=function(){function k$k(){}return k$d(k$k,"laya.ani.math.BezierLerp"),k$k.getBezierRate=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$k._getBezierParamKey(k$b,k$c,k$d,k$e),k$g=100*k$f+k$a;if(k$k._bezierResultCache[k$g])return k$k._bezierResultCache[k$g];var k$h,k$i=k$k._getBezierPoints(k$b,k$c,k$d,k$e,k$f),k$j=0;for(k$h=k$i.length,k$j=0;k$j<k$h;k$j+=2)if(k$a<=k$i[k$j])return k$k._bezierResultCache[k$g]=k$i[k$j+1],k$i[k$j+1];return k$k._bezierResultCache[k$g]=1},k$k._getBezierParamKey=function(k$a,k$b,k$c,k$d){return 100*(100*(100*(100*k$a+k$b)+k$c)+k$d)},k$k._getBezierPoints=function(k$a,k$b,k$c,k$d,k$e){return k$k._bezierPointsCache[k$e]?k$k._bezierPointsCache[k$e]:(k$f=[0,0,k$a,k$b,k$c,k$d,1,1],k$g=(new k$h).getBezierPoints(k$f,100,3),k$k._bezierPointsCache[k$e]=k$g);var k$f,k$g},k$k._bezierResultCache={},k$k._bezierPointsCache={},k$k}(),k$B=function(k$a){function k$b(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,k$b.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}k$d(k$b,"laya.ani.AnimationPlayer",k$e);var k$c=k$b.prototype;return k$ea.imps(k$c,{"laya.resource.IDestroy":!0}),k$c._onTempletLoadedComputeFullKeyframeIndices=function(k$a,k$b,k$c){this._templet===k$c&&this._cachePlayRate===k$a&&this._cacheFrameRate===k$b&&this._computeFullKeyframeIndices()},k$c._computeFullKeyframeIndices=function(){for(var k$a=this._fullFrames=[],k$b=this._templet,k$c=this._cacheFrameRateInterval*this._cachePlayRate,k$d=0,k$e=k$b.getAnimationCount();k$d<k$e;k$d++){for(var k$f=[],k$g=0,k$h=k$b.getAnimation(k$d).nodes.length;k$g<k$h;k$g++){for(var k$i=k$b.getAnimation(k$d).nodes[k$g],k$j=Math.floor(k$i.playTime/k$c+.01),k$k=new Uint16Array(k$j+1),k$l=-1,k$m=0,k$n=k$i.keyFrame.length;k$m<k$n;k$m++){var k$o=k$i.keyFrame[k$m],k$p=k$o.startTime,k$q=k$p+k$o.duration+k$c;do{for(var k$r=Math.floor(k$p/k$c+.5),k$s=k$l+1;k$s<k$r;k$s++)k$k[k$s]=k$m;k$k[k$l=k$r]=k$m,k$p+=k$c}while(k$p<=k$q)}k$f.push(k$k)}k$a.push(k$f)}},k$c._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},k$c._calculatePlayDuration=function(){if(0!==this.state){var k$a=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=k$a),this._playEnd>k$a&&(this._playEnd=k$a),this._playDuration=this._playEnd-this._playStart}},k$c._setPlayParams=function(k$a,k$b){this._currentTime=k$a,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/k$b+.01),0),this._currentFrameTime=this._currentKeyframeIndex*k$b},k$c._setPlayParamsWhenStop=function(k$a,k$b){this._currentTime=k$a,this._currentKeyframeIndex=Math.max(Math.floor(k$a/k$b+.01),0),this._currentFrameTime=this._currentKeyframeIndex*k$b,this._currentAnimationClipIndex=-1},k$c._update=function(k$a){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var k$b=this._cacheFrameRateInterval*this._cachePlayRate,k$c=0;this._startUpdateLoopCount!==k$o.loopCount&&(k$c=k$a*this.playbackRate,this._elapsedPlaybackTime+=k$c);var k$d=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=k$d)return this._setPlayParamsWhenStop(k$d,k$b),void this.event("stopped");if(k$c+=this._currentTime,0<k$d)if(k$d<=k$c)do{if(k$c-=k$d,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(k$d,k$b),this._stopWhenCircleFinish=!1,void this.event("stopped");k$c<k$d&&(this._setPlayParams(k$c,k$b),this.event("complete"))}while(k$d<=k$c);else this._setPlayParams(k$c,k$b);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(k$d,k$b),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},k$c._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},k$c.play=function(k$a,k$b,k$c,k$d,k$e){if(void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=1),void 0===k$c&&(k$c=2147483647),void 0===k$d&&(k$d=0),void 0===k$e&&(k$e=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(k$c<0||k$d<0||k$e<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==k$e&&k$e<k$d)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=k$b,this._overallDuration=k$c,this._playStart=k$d,this._playEnd=k$e,this._paused=!1,this._currentAnimationClipIndex=k$a,this._currentKeyframeIndex=0,this._startUpdateLoopCount=k$o.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},k$c.playByFrame=function(k$a,k$b,k$c,k$d,k$e,k$f){void 0===k$a&&(k$a=0),void 0===k$b&&(k$b=1),void 0===k$c&&(k$c=2147483647),void 0===k$d&&(k$d=0),void 0===k$e&&(k$e=0),void 0===k$f&&(k$f=30);var k$g=1e3/k$f;this.play(k$a,k$b,k$c,k$d*k$g,k$e*k$g)},k$c.stop=function(k$a){void 0===k$a&&(k$a=!0),k$a?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},k$f(0,k$c,"playEnd",function(){return this._playEnd}),k$f(0,k$c,"templet",function(){return this._templet},function(k$a){0===!this.state&&this.stop(!0),this._templet!==k$a&&((this._templet=k$a).loaded?this._computeFullKeyframeIndices():k$a.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),k$f(0,k$c,"playStart",function(){return this._playStart}),k$f(0,k$c,"playDuration",function(){return this._playDuration}),k$f(0,k$c,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),k$f(0,k$c,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),k$f(0,k$c,"overallDuration",function(){return this._overallDuration}),k$f(0,k$c,"currentFrameTime",function(){return this._currentFrameTime}),k$f(0,k$c,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),k$f(0,k$c,"currentPlayTime",function(){return this._currentTime+this._playStart}),k$f(0,k$c,"cachePlayRate",function(){return this._cachePlayRate},function(k$a){this._cachePlayRate!==k$a&&(this._cachePlayRate=k$a,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[k$a,this._cacheFrameRate])))}),k$f(0,k$c,"cacheFrameRate",function(){return this._cacheFrameRate},function(k$a){this._cacheFrameRate!==k$a&&(this._cacheFrameRate=k$a,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,k$a])))}),k$f(0,k$c,"currentTime",null,function(k$a){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(k$a<this._playStart||k$a>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=k$o.loopCount;var k$b=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=k$a,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/k$b),0),this._currentFrameTime=this._currentKeyframeIndex*k$b}}),k$f(0,k$c,"paused",function(){return this._paused},function(k$a){(this._paused=k$a)&&this.event("paused")}),k$f(0,k$c,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),k$f(0,k$c,"destroyed",function(){return this._destroyed}),k$b}(),k$J=function(k$a){function k$b(){k$b.__super.call(this),k$q.isConchNode&&(this.drawSkin=function(k$a){k$a.transform||(k$a.transform=k$Ga.EMPTY),this._addCmd([k$a]),this.setSkinMesh&&this.setSkinMesh(k$a._ps,k$a.mVBData,k$a.mEleNum,0,k$a.mTexture,k$a.transform)})}return k$d(k$b,"laya.ani.GraphicsAni",k$g),k$b.prototype.drawSkin=function(k$a){var k$b=[k$a];this._saveToCmd(k$q._context._drawSkin,k$b)},k$b.create=function(){return k$b._caches.pop()||new k$b},k$b.recycle=function(k$a){k$a.clear(),k$b._caches.push(k$a)},k$b._caches=[],k$b}(),k$K=function(k$a){function k$s(){this._aniMap={},this.unfixedLastAniIndex=-1,k$s.__super.call(this),this._anis=new Array}k$d(k$s,"laya.ani.AnimationTemplet",k$k);var k$b=k$s.prototype;return k$b.parse=function(k$a){var k$b=new k$Fa(k$a);this._aniVersion=k$b.readUTFString(),k$t.parse(this,k$b)},k$b._calculateKeyFrame=function(k$a,k$b,k$c){var k$d=k$a.keyFrame;k$d[k$b]=k$d[0];for(var k$e=0;k$e<k$b;k$e++){var k$f=k$d[k$e];k$f.nextData=0===k$f.duration?k$f.data:k$d[k$e+1].data}k$d.length--},k$b.onAsynLoaded=function(k$a,k$b,k$c){var k$d=new k$Fa(k$b);switch(this._aniVersion=k$d.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":k$w.parse(this,k$d);break;default:k$t.parse(this,k$d)}this._endLoaded()},k$b.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},k$b.getAnimationCount=function(){return this._anis.length},k$b.getAnimation=function(k$a){return this._anis[k$a]},k$b.getAniDuration=function(k$a){return this._anis[k$a].playTime},k$b.getNodes=function(k$a){return this._anis[k$a].nodes},k$b.getNodeIndexWithName=function(k$a,k$b){return this._anis[k$a].bone3DMap[k$b]},k$b.getNodeCount=function(k$a){return this._anis[k$a].nodes.length},k$b.getTotalkeyframesLength=function(k$a){return this._anis[k$a].totalKeyframeDatasLength},k$b.getPublicExtData=function(){return this._publicExtData},k$b.getAnimationDataWithCache=function(k$a,k$b,k$c,k$d){var k$e=k$b[k$c];if(k$e){var k$f=k$e[k$a];return k$f?k$f[k$d]:null}return null},k$b.setAnimationDataWithCache=function(k$a,k$b,k$c,k$d,k$e){var k$f=k$b[k$c]||(k$b[k$c]={});(k$f[k$a]||(k$f[k$a]=[]))[k$d]=k$e},k$b.getOriginalData=function(k$a,k$b,k$c,k$d,k$e){for(var k$f=this._anis[k$a].nodes,k$g=0,k$h=0,k$i=k$f.length,k$j=0;k$h<k$i;k$h++){var k$k,k$l=k$f[k$h];k$k=k$l.keyFrame[k$c[k$h][k$d]],k$l.dataOffset=k$j;var k$m=k$e-k$k.startTime,k$n=k$l.lerpType;if(k$n)switch(k$n){case 0:case 1:for(k$g=0;k$g<k$l.keyframeWidth;)k$g+=k$l.interpolationMethod[k$g](k$l,k$g,k$b,k$j+k$g,k$k.data,k$m,null,k$k.duration,k$k.nextData);break;case 2:var k$o=k$k.interpolationData,k$p=k$o.length,k$q=0;for(k$g=0;k$g<k$p;){var k$r=k$o[k$g];switch(k$r){case 6:case 7:k$g+=k$s.interpolation[k$r](k$l,k$q,k$b,k$j+k$q,k$k.data,k$m,null,k$k.duration,k$k.nextData,k$o,k$g+1);break;default:k$g+=k$s.interpolation[k$r](k$l,k$q,k$b,k$j+k$q,k$k.data,k$m,null,k$k.duration,k$k.nextData)}k$q++}}else for(k$g=0;k$g<k$l.keyframeWidth;)k$g+=k$l.interpolationMethod[k$g](k$l,k$g,k$b,k$j+k$g,k$k.data,k$m,null,k$k.duration,k$k.nextData);k$j+=k$l.keyframeWidth}},k$b.getNodesCurrentFrameIndex=function(k$a,k$b){var k$c=this._anis[k$a].nodes;k$a!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(k$c.length),this.unfixedCurrentTimes=new Float32Array(k$c.length),this.unfixedLastAniIndex=k$a);for(var k$d=0,k$e=k$c.length;k$d<k$e;k$d++){var k$f=k$c[k$d];for(k$b<this.unfixedCurrentTimes[k$d]&&(this.unfixedCurrentFrameIndexes[k$d]=0),this.unfixedCurrentTimes[k$d]=k$b;this.unfixedCurrentFrameIndexes[k$d]<k$f.keyFrame.length&&!(k$f.keyFrame[this.unfixedCurrentFrameIndexes[k$d]].startTime>this.unfixedCurrentTimes[k$d]);)this.unfixedCurrentFrameIndexes[k$d]++;this.unfixedCurrentFrameIndexes[k$d]--}return this.unfixedCurrentFrameIndexes},k$b.getOriginalDataUnfixedRate=function(k$a,k$b,k$c){var k$d=this._anis[k$a].nodes;k$a!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(k$d.length),this.unfixedCurrentTimes=new Float32Array(k$d.length),this.unfixedKeyframes=k$p(k$d.length),this.unfixedLastAniIndex=k$a);for(var k$e=0,k$f=0,k$g=k$d.length,k$h=0;k$f<k$g;k$f++){var k$i=k$d[k$f];for(k$c<this.unfixedCurrentTimes[k$f]&&(this.unfixedCurrentFrameIndexes[k$f]=0),this.unfixedCurrentTimes[k$f]=k$c;this.unfixedCurrentFrameIndexes[k$f]<k$i.keyFrame.length&&!(k$i.keyFrame[this.unfixedCurrentFrameIndexes[k$f]].startTime>this.unfixedCurrentTimes[k$f]);)this.unfixedKeyframes[k$f]=k$i.keyFrame[this.unfixedCurrentFrameIndexes[k$f]],this.unfixedCurrentFrameIndexes[k$f]++;var k$j=this.unfixedKeyframes[k$f];k$i.dataOffset=k$h;var k$k=k$c-k$j.startTime;if(k$i.lerpType)switch(k$i.lerpType){case 0:case 1:for(k$e=0;k$e<k$i.keyframeWidth;)k$e+=k$i.interpolationMethod[k$e](k$i,k$e,k$b,k$h+k$e,k$j.data,k$k,null,k$j.duration,k$j.nextData);break;case 2:var k$l=k$j.interpolationData,k$m=k$l.length,k$n=0;for(k$e=0;k$e<k$m;){var k$o=k$l[k$e];switch(k$o){case 6:case 7:k$e+=k$s.interpolation[k$o](k$i,k$n,k$b,k$h+k$n,k$j.data,k$k,null,k$j.duration,k$j.nextData,k$l,k$e+1);break;default:k$e+=k$s.interpolation[k$o](k$i,k$n,k$b,k$h+k$n,k$j.data,k$k,null,k$j.duration,k$j.nextData)}k$n++}}else for(k$e=0;k$e<k$i.keyframeWidth;)k$e+=k$i.interpolationMethod[k$e](k$i,k$e,k$b,k$h+k$e,k$j.data,k$k,null,k$j.duration,k$j.nextData);k$h+=k$i.keyframeWidth}},k$s._LinearInterpolation_0=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){var k$k=0===k$h?0:k$f/k$h;return k$c[k$d]=(1-k$k)*k$e[k$b]+k$k*k$i[k$b],1},k$s._QuaternionInterpolation_1=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){var k$k=0===k$h?0:k$f/k$h;return k$m.slerpQuaternionArray(k$e,k$b,k$i,k$b,k$k,k$c,k$d),4},k$s._AngleInterpolation_2=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){return 0},k$s._RadiansInterpolation_3=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){return 0},k$s._Matrix4x4Interpolation_4=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){for(var k$k=0;k$k<16;k$k++,k$b++)k$c[k$d+k$k]=k$e[k$b]+k$f*k$g[k$b];return 16},k$s._NoInterpolation_5=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j){return k$c[k$d]=k$e[k$b],1},k$s._BezierInterpolation_6=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k){return void 0===k$k&&(k$k=0),k$c[k$d]=k$e[k$b]+(k$i[k$b]-k$e[k$b])*k$A.getBezierRate(k$f/k$h,k$j[k$k],k$j[k$k+1],k$j[k$k+2],k$j[k$k+3]),5},k$s._BezierInterpolation_7=function(k$a,k$b,k$c,k$d,k$e,k$f,k$g,k$h,k$i,k$j,k$k){return void 0===k$k&&(k$k=0),k$c[k$d]=k$j[k$k+4]+k$j[k$k+5]*k$A.getBezierRate((.001*k$f+k$j[k$k+6])/k$j[k$k+7],k$j[k$k],k$j[k$k+1],k$j[k$k+2],k$j[k$k+3]),9},k$s.load=function(k$a){return k$ea.loader.create(k$a,null,null,k$s)},k$s.interpolation=[k$s._LinearInterpolation_0,k$s._QuaternionInterpolation_1,k$s._AngleInterpolation_2,k$s._RadiansInterpolation_3,k$s._Matrix4x4Interpolation_4,k$s._NoInterpolation_5,k$s._BezierInterpolation_6,k$s._BezierInterpolation_7],k$s}(),k$C=function(k$b){function k$c(k$a,k$b){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,k$c.__super.call(this),void 0===k$b&&(k$b=0),k$a&&this.init(k$a,k$b)}k$d(k$c,"laya.ani.bone.Skeleton",k$b);var k$a=k$c.prototype;return k$a.init=function(k$a,k$b){void 0===k$b&&(k$b=0);var k$c,k$d,k$e,k$f=0,k$g=0;if(1==k$b)for(this._graphicsCache=[],k$f=0,k$g=k$a.getAnimationCount();k$f<k$g;k$f++)this._graphicsCache.push([]);if(this._yReverseMatrix=k$a.yReverseMatrix,this._aniMode=k$b,this._templet=k$a,this._player=new k$B,this._player.cacheFrameRate=k$a.rate,this._player.templet=k$a,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=k$a.mBoneArr,this._rootBone=k$a.mRootBone,this._aniSectionDic=k$a.aniSectionDic,0<k$a.ikArr.length)for(this._ikArr=[],k$f=0,k$g=k$a.ikArr.length;k$f<k$g;k$f++)this._ikArr.push(new k$s(k$a.ikArr[k$f],this._boneList));if(0<k$a.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),k$f=0,k$g=k$a.pathArr.length;k$f<k$g;k$f++)k$c=k$a.pathArr[k$f],k$d=new k$x(k$c,this._boneList),(k$e=this._boneSlotDic[k$c.name])&&((k$d=new k$x(k$c,this._boneList)).target=k$e),this._pathDic[k$c.name]=k$d;if(0<k$a.tfArr.length)for(this._tfArr=[],k$f=0,k$g=k$a.tfArr.length;k$f<k$g;k$f++)this._tfArr.push(new k$y(k$a.tfArr[k$f],this._boneList));if(0<k$a.skinDataArray.length){var k$h=this._templet.skinDataArray[this._skinIndex];this._skinName=k$h.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},k$a.load=function(k$a,k$b,k$c){},k$a._onLoaded=function(){},k$a._parseComplete=function(){var k$a=k$D.TEMPLET_DICTIONARY[this._aniPath];k$a&&(this.init(k$a,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},k$a._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},k$a._onPlay=function(){this.event("played")},k$a._onStop=function(){var k$a,k$b=this._templet.eventAniArr[this._aniClipIndex];if(k$b&&this._eventIndex<k$b.length)for(;this._eventIndex<k$b.length;this._eventIndex++)(k$a=k$b[this._eventIndex]).time>=this._player.playStart&&k$a.time<=this._player.playEnd&&this.event("label",k$a);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},k$a._onPause=function(){this.event("paused")},k$a._parseSrcBoneMatrix=function(){var k$a=0,k$b=0;for(k$b=this._templet.srcBoneMatrixArr.length,k$a=0;k$a<k$b;k$a++)this._boneMatrixArray.push(new k$Ga);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var k$c,k$d,k$e=this._templet.boneSlotArray;for(k$a=0,k$b=k$e.length;k$a<k$b;k$a++)k$c=k$e[k$a],null==(k$d=this._bindBoneBoneSlotDic[k$c.parent])&&(this._bindBoneBoneSlotDic[k$c.parent]=k$d=[]),this._boneSlotDic[k$c.name]=k$c=k$c.copy(),k$d.push(k$c),this._boneSlotArray.push(k$c)}},k$a._emitMissedEvents=function(k$a,k$b,k$c){void 0===k$c&&(k$c=0);var k$d=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(k$d){var k$e,k$f,k$g=0;for(k$e=k$d.length,k$g=k$c;k$g<k$e;k$g++)(k$f=k$d[k$g]).time>=this._player.playStart&&k$f.time<=this._player.playEnd&&this.event("label",k$f)}},k$a._update=function(k$a){if(void 0===k$a&&(k$a=!0),!(this._pause||k$a&&this._indexControl)){var k$b=this.timer.currTimer,k$c=this._player.currentKeyframeIndex,k$d=k$b-this._lastTime;if(k$a?this._player._update(k$d):k$c=-1,this._lastTime=k$b,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<k$d&&this._clipIndex==k$c&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var k$e;this._lastUpdateAniClipIndex=this._aniClipIndex,k$c>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var k$f,k$g=this._templet.eventAniArr[this._aniClipIndex];if(k$g&&this._eventIndex<k$g.length&&((k$e=k$g[this._eventIndex]).time>=this._player.playStart&&k$e.time<=this._player.playEnd?this._player.currentPlayTime>=k$e.time&&(this.event("label",k$e),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(k$f=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=k$f&&(this.graphics=k$f));var k$h=0,k$i=0;for(k$i=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,k$i-1)&&0<k$i;)k$i--;if(k$i<this._clipIndex)for(k$h=k$i;k$h<this._clipIndex;k$h++)this._createGraphics(k$h)}else if(1==this._aniMode){if(k$f=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=k$f&&(this.graphics=k$f));for(k$i=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,k$i-1)&&0<k$i;)k$i--;if(k$i<this._clipIndex)for(k$h=k$i;k$h<this._clipIndex;k$h++)this._createGraphics(k$h)}this._createGraphics()}}},k$a._createGraphics=function(k$a){void 0===k$a&&(k$a=-1),-1==k$a&&(k$a=this._clipIndex);var k$b,k$c,k$d=k$a*this._player.cacheFrameRateInterval,k$e=this._templet.drawOrderAniArr[this._aniClipIndex];if(k$e&&0<k$e.length)for(this._drawOrderIndex=0,k$b=k$e[this._drawOrderIndex];k$d>=k$b.time&&(this._drawOrder=k$b.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=k$e.length));)k$b=k$e[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=k$J.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=k$J.create(),k$c=this.graphics;var k$f=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],k$a,k$d);var k$g,k$h,k$i,k$j,k$k=this._aniSectionDic[this._aniClipIndex],k$l=0,k$m=0,k$n=0,k$o=0,k$p=0,k$q=this._templet.srcBoneMatrixArr.length;for(k$p=k$k[k$m=0];k$m<k$q;k$m++)k$j=this._boneList[k$m],k$i=this._templet.srcBoneMatrixArr[k$m],k$j.resultTransform.scX=k$i.scX*this._curOriginalData[k$l++],k$j.resultTransform.skX=k$i.skX+this._curOriginalData[k$l++],k$j.resultTransform.skY=k$i.skY+this._curOriginalData[k$l++],k$j.resultTransform.scY=k$i.scY*this._curOriginalData[k$l++],k$j.resultTransform.x=k$i.x+this._curOriginalData[k$l++],k$j.resultTransform.y=k$i.y+this._curOriginalData[k$l++],8===this._templet.tMatrixDataLen&&(k$j.resultTransform.skewX=k$i.skewX+this._curOriginalData[k$l++],k$j.resultTransform.skewY=k$i.skewY+this._curOriginalData[k$l++]);var k$r,k$s={},k$t={};for(k$p+=k$k[1];k$m<k$p;k$m++)k$s[(k$r=k$f[k$m]).name]=this._curOriginalData[k$l++],k$t[k$r.name]=this._curOriginalData[k$l++],this._curOriginalData[k$l++],this._curOriginalData[k$l++],this._curOriginalData[k$l++],this._curOriginalData[k$l++];var k$w,k$x,k$y={},k$z={};for(k$p+=k$k[2];k$m<k$p;k$m++)k$y[(k$r=k$f[k$m]).name]=this._curOriginalData[k$l++],k$z[k$r.name]=this._curOriginalData[k$l++],this._curOriginalData[k$l++],this._curOriginalData[k$l++],this._curOriginalData[k$l++],this._curOriginalData[k$l++];if(this._pathDic)for(k$p+=k$k[3];k$m<k$p;k$m++){if(k$r=k$f[k$m],k$w=this._pathDic[k$r.name])switch(new k$Fa(k$r.extenData).getByte()){case 1:k$w.position=this._curOriginalData[k$l++];break;case 2:k$w.spacing=this._curOriginalData[k$l++];break;case 3:k$w.rotateMix=this._curOriginalData[k$l++],k$w.translateMix=this._curOriginalData[k$l++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(k$Ga.TEMP.identity()),this._ikArr)for(k$m=0,k$p=this._ikArr.length;k$m<k$p;k$m++)k$x=this._ikArr[k$m],k$y.hasOwnProperty(k$x.name)&&(k$x.bendDirection=k$y[k$x.name]),k$z.hasOwnProperty(k$x.name)&&(k$x.mix=k$z[k$x.name]),k$x.apply();if(this._pathDic)for(var k$A in this._pathDic)(k$w=this._pathDic[k$A]).apply(this._boneList,k$c);if(this._tfArr)for(k$m=0,k$o=this._tfArr.length;k$m<k$o;k$m++)this._tfArr[k$m].apply();for(k$m=0,k$o=this._boneList.length;k$m<k$o;k$m++)if(k$j=this._boneList[k$m],k$h=this._bindBoneBoneSlotDic[k$j.name],k$j.resultMatrix.copyTo(this._boneMatrixArray[k$m]),k$h)for(k$n=0,k$p=k$h.length;k$n<k$p;k$n++)(k$g=k$h[k$n])&&k$g.setParentMatrix(k$j.resultMatrix);var k$B,k$C,k$D,k$E,k$F={},k$G=this._templet.deformAniArr;if(k$G&&0<k$G.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,k$m=0,k$p=this._boneSlotArray.length;k$m<k$p;k$m++)(k$g=this._boneSlotArray[k$m]).deformData=null;var k$H,k$I=k$G[this._aniClipIndex];for(k$H in k$B=k$I.default,this._setDeform(k$B,k$F,this._boneSlotArray,k$d),k$I)"default"!=k$H&&k$H!=this._skinName&&(k$B=k$I[k$H],this._setDeform(k$B,k$F,this._boneSlotArray,k$d));k$B=k$I[this._skinName],this._setDeform(k$B,k$F,this._boneSlotArray,k$d)}if(this._drawOrder)for(k$m=0,k$p=this._drawOrder.length;k$m<k$p;k$m++)k$C=k$s[(k$g=this._boneSlotArray[this._drawOrder[k$m]]).name],k$D=k$t[k$g.name],isNaN(k$D)||(k$c.save(),k$c.alpha(k$D)),isNaN(k$C)||-2==k$C||(this._templet.attachmentNames?k$g.showDisplayByName(this._templet.attachmentNames[k$C]):k$g.showDisplayByIndex(k$C)),k$F[this._drawOrder[k$m]]?(k$E=k$F[this._drawOrder[k$m]],k$g.currDisplayData&&k$E[k$g.currDisplayData.attachmentName]?k$g.deformData=k$E[k$g.currDisplayData.attachmentName]:k$g.deformData=null):k$g.deformData=null,isNaN(k$D)?k$g.draw(k$c,this._boneMatrixArray,2==this._aniMode):k$g.draw(k$c,this._boneMatrixArray,2==this._aniMode,k$D),isNaN(k$D)||k$c.restore();else for(k$m=0,k$p=this._boneSlotArray.length;k$m<k$p;k$m++)k$C=k$s[(k$g=this._boneSlotArray[k$m]).name],k$D=k$t[k$g.name],isNaN(k$D)||(k$c.save(),k$c.alpha(k$D)),isNaN(k$C)||-2==k$C||(this._templet.attachmentNames?k$g.showDisplayByName(this._templet.attachmentNames[k$C]):k$g.showDisplayByIndex(k$C)),k$F[k$m]?(k$E=k$F[k$m],k$g.currDisplayData&&k$E[k$g.currDisplayData.attachmentName]?k$g.deformData=k$E[k$g.currDisplayData.attachmentName]:k$g.deformData=null):k$g.deformData=null,isNaN(k$D)?k$g.draw(k$c,this._boneMatrixArray,2==this._aniMode):k$g.draw(k$c,this._boneMatrixArray,2==this._aniMode,k$D),isNaN(k$D)||k$c.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,k$a,k$c):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,k$a,k$c)},k$a._setDeform=function(k$a,k$b,k$c,k$d){if(k$a){var k$e,k$f,k$g,k$h=0,k$i=0,k$j=0;if(k$a)for(k$h=0,k$i=k$a.deformSlotDataList.length;k$h<k$i;k$h++)for(k$e=k$a.deformSlotDataList[k$h],k$j=0;k$j<k$e.deformSlotDisplayList.length;k$j++)k$g=k$c[(k$f=k$e.deformSlotDisplayList[k$j]).slotIndex],k$f.apply(k$d,k$g),k$b[k$f.slotIndex]||(k$b[k$f.slotIndex]={}),k$b[k$f.slotIndex][k$f.attachment]=k$f.deformData}},k$a.getAnimNum=function(){return this._templet.getAnimationCount()},k$a.getAniNameByIndex=function(k$a){return this._templet.getAniNameByIndex(k$a)},k$a.getSlotByName=function(k$a){return this._boneSlotDic[k$a]},k$a.showSkinByName=function(k$a,k$b){void 0===k$b&&(k$b=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(k$a),k$b)},k$a.showSkinByIndex=function(k$a,k$b){void 0===k$b&&(k$b=!0);for(var k$c=0;k$c<this._boneSlotArray.length;k$c++)this._boneSlotArray[k$c].showSlotData(null,k$b);if(this._templet.showSkinByIndex(this._boneSlotDic,k$a,k$b)){var k$d=this._templet.skinDataArray[k$a];this._skinIndex=k$a,this._skinName=k$d.name}this._clearCache()},k$a.showSlotSkinByIndex=function(k$a,k$b){if(0!=this._aniMode){var k$c=this.getSlotByName(k$a);k$c&&k$c.showDisplayByIndex(k$b),this._clearCache()}},k$a.showSlotSkinByName=function(k$a,k$b){if(0!=this._aniMode){var k$c=this.getSlotByName(k$a);k$c&&k$c.showDisplayByName(k$b),this._clearCache()}},k$a.replaceSlotSkinName=function(k$a,k$b,k$c){if(0!=this._aniMode){var k$d=this.getSlotByName(k$a);k$d&&k$d.replaceDisplayByName(k$b,k$c),this._clearCache()}},k$a.replaceSlotSkinByIndex=function(k$a,k$b,k$c){if(0!=this._aniMode){var k$d=this.getSlotByName(k$a);k$d&&k$d.replaceDisplayByIndex(k$b,k$c),this._clearCache()}},k$a.setSlotSkin=function(k$a,k$b){if(0!=this._aniMode){var k$c=this.getSlotByName(k$a);k$c&&k$c.replaceSkin(k$b),this._clearCache()}},k$a._clearCache=function(){if(1==this._aniMode)for(var k$a=0,k$b=this._graphicsCache.length;k$a<k$b;k$a++){for(var k$c=0,k$d=this._graphicsCache[k$a].length;k$c<k$d;k$c++){var k$e=this._graphicsCache[k$a][k$c];k$e!=this.graphics&&k$J.recycle(k$e)}this._graphicsCache[k$a].length=0}},k$a.play=function(k$a,k$b,k$c,k$d,k$e,k$f){void 0===k$c&&(k$c=!0),void 0===k$d&&(k$d=0),void 0===k$e&&(k$e=0),void 0===k$f&&(k$f=!0),this._indexControl=!1;var k$g=-1,k$h=NaN;if(k$h=k$b?2147483647:0,"string"==typeof k$a)for(var k$i=0,k$j=this._templet.getAnimationCount();k$i<k$j;k$i++){var k$k=this._templet.getAnimation(k$i);if(k$k&&k$a==k$k.name){k$g=k$i;break}}else k$g=k$a;-1<k$g&&k$g<this.getAnimNum()&&(this._aniClipIndex=k$g,(k$c||this._pause||this._currAniIndex!=k$g)&&(this._currAniIndex=k$g,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(k$g)),this._drawOrder=null,this._eventIndex=0,this._player.play(k$g,this._player.playbackRate,k$h,k$d,k$e),k$f&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=k$l.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},k$a.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},k$a.playbackRate=function(k$a){this._player&&(this._player.playbackRate=k$a)},k$a.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},k$a.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=k$l.now(),this.timer.frameLoop(1,this,this._update,null,!0))},k$a._getGrahicsDataWithCache=function(k$a,k$b){return this._graphicsCache[k$a][k$b]},k$a._setGrahicsDataWithCache=function(k$a,k$b,k$c){this._graphicsCache[k$a][k$b]=k$c},k$a.destroy=function(k$a){void 0===k$a&&(k$a=!0),k$b.prototype.destroy.call(this,k$a),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},k$f(0,k$a,"url",function(){return this._aniPath},function(k$a){this.load(k$a)}),k$f(0,k$a,"index",function(){return this._index},function(k$a){this.player&&(this._index=k$a,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),k$f(0,k$a,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),k$f(0,k$a,"templet",function(){return this._templet}),k$f(0,k$a,"player",function(){return this._player}),k$c.useSimpleMeshInCanvas=!1,k$c}(k$fa),k$D=function(k$b){function k$e(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,k$e.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}k$d(k$e,"laya.ani.bone.Templet",k$b);var k$a=k$e.prototype;return k$a.getLoadList=function(){return this._loadList},k$a.loadAni=function(k$a){this._skBufferUrl=k$a,k$ea.loader.load(k$a,k$i.create(this,this.onComplete),null,"arraybuffer")},k$a.onComplete=function(k$a){if(this._isDestroyed)this.destroy();else{var k$b=k$j.getRes(this._skBufferUrl);k$b?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,k$b)):this.event("error","load failed:"+this._skBufferUrl)}},k$a.parseData=function(k$a,k$b,k$c){void 0===k$c&&(k$c=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=k$a,this._mainTexture&&k$q.isWebGL&&k$a.bitmap&&(k$a.bitmap.enableMerageInAtlas=!1),this._rate=k$c,this.parse(k$b)},k$a.buildArmature=function(k$a){return void 0===k$a&&(k$a=0),new k$C(this,k$a)},k$a.parse=function(k$a){k$b.prototype.parse.call(this,k$a),this._endLoaded(),this._aniVersion!=k$e.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+k$e.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},k$a._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var k$a=0;this._loadList=[];var k$b,k$c=new k$Fa(this.getPublicExtData()),k$d=0,k$e=0,k$f=0,k$g=k$c.getInt32(),k$h=k$c.readUTFString(),k$i=k$h.split("\n");for(k$a=0;k$a<k$g;k$a++)k$b=this._path+k$i[2*k$a],k$h=k$i[2*k$a+1],k$c.getFloat32(),k$c.getFloat32(),k$d=k$c.getFloat32(),k$e=k$c.getFloat32(),k$f=k$c.getFloat32(),isNaN(k$f)?0:k$f,k$f=k$c.getFloat32(),isNaN(k$f)?0:k$f,k$f=k$c.getFloat32(),isNaN(k$f)?k$d:k$f,k$f=k$c.getFloat32(),isNaN(k$f)?k$e:k$f,-1==this._loadList.indexOf(k$b)&&this._loadList.push(k$b);this.event("inited",this)}},k$a._textureComplete=function(){for(var k$a,k$b,k$c=0,k$d=this._loadList.length;k$c<k$d;k$c++)k$b=this._loadList[k$c],k$a=this._textureDic[k$b]=k$j.getRes(k$b),k$q.isWebGL&&k$a&&k$a.bitmap&&(k$a.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},k$a._parsePublicExtData=function(){var k$a=0,k$b=0,k$c=0,k$d=0,k$e=0;for(k$a=0,k$e=this.getAnimationCount();k$a<k$e;k$a++)this._graphicsCache.push([]);var k$f;k$f="Dragon"!=this._aniClassName;var k$g,k$h,k$i=new k$Fa(this.getPublicExtData()),k$j=0,k$k=0,k$l=0,k$m=0,k$n=0,k$o=0,k$p=0,k$q=0,k$r=0,k$s=k$i.getInt32(),k$t=k$i.readUTFString(),k$w=k$t.split("\n");for(k$a=0;k$a<k$s;k$a++){if(k$g=this._mainTexture,k$h=this._path+k$w[2*k$a],k$t=k$w[2*k$a+1],null==this._mainTexture&&(k$g=this._textureDic[k$h]),!k$g)return this.event("error",this),void(this.isParseFail=!0);k$j=k$i.getFloat32(),k$k=k$i.getFloat32(),k$l=k$i.getFloat32(),k$m=k$i.getFloat32(),k$r=k$i.getFloat32(),k$n=isNaN(k$r)?0:k$r,k$r=k$i.getFloat32(),k$o=isNaN(k$r)?0:k$r,k$r=k$i.getFloat32(),k$p=isNaN(k$r)?k$l:k$r,k$r=k$i.getFloat32(),k$q=isNaN(k$r)?k$m:k$r,this.subTextureDic[k$t]=k$Ha.create(k$g,k$j,k$k,k$l,k$m,-k$n,-k$o,k$p,k$q),k$g.alphaTexture&&(this.subTextureDic[k$t].alphaTexture=k$Ha.create(k$g.alphaTexture,k$j,k$k,k$l,k$m,-k$n,-k$o,k$p,k$q))}this._mainTexture=k$g;var k$x,k$y,k$z,k$A,k$B,k$C=k$i.getUint16();for(k$a=0;k$a<k$C;k$a++)(k$x=[]).push(k$i.getUint16()),k$x.push(k$i.getUint16()),k$x.push(k$i.getUint16()),k$x.push(k$i.getUint16()),this.aniSectionDic[k$a]=k$x;var k$D,k$E=k$i.getInt16(),k$F={};for(k$a=0;k$a<k$E;k$a++)k$y=new k$Ia,0==k$a?k$D=k$y:k$y.root=k$D,k$y.d=k$f?-1:1,k$A=k$i.readUTFString(),k$B=k$i.readUTFString(),k$y.length=k$i.getFloat32(),1==k$i.getByte()&&(k$y.inheritRotation=!1),1==k$i.getByte()&&(k$y.inheritScale=!1),k$y.name=k$A,k$B&&((k$z=k$F[k$B])?k$z.addChild(k$y):this.mRootBone=k$y),k$F[k$A]=k$y,this.mBoneArr.push(k$y);this.tMatrixDataLen=k$i.getUint16();var k$G,k$H,k$I=k$i.getUint16(),k$J=Math.floor(k$I/this.tMatrixDataLen),k$K=this.srcBoneMatrixArr;for(k$a=0;k$a<k$J;k$a++)(k$G=new k$Va).scX=k$i.getFloat32(),k$G.skX=k$i.getFloat32(),k$G.skY=k$i.getFloat32(),k$G.scY=k$i.getFloat32(),k$G.x=k$i.getFloat32(),k$G.y=k$i.getFloat32(),8===this.tMatrixDataLen&&(k$G.skewX=k$i.getFloat32(),k$G.skewY=k$i.getFloat32()),k$K.push(k$G),(k$y=this.mBoneArr[k$a]).transform=k$G;var k$L,k$M=k$i.getUint16(),k$N=0;for(k$a=0;k$a<k$M;k$a++){for(k$H=new k$Pa,k$N=k$i.getUint16(),k$b=0;k$b<k$N;k$b++)k$H.boneNames.push(k$i.readUTFString()),k$H.boneIndexs.push(k$i.getInt16());k$H.name=k$i.readUTFString(),k$H.targetBoneName=k$i.readUTFString(),k$H.targetBoneIndex=k$i.getInt16(),k$H.bendDirection=k$i.getFloat32(),k$H.mix=k$i.getFloat32(),k$H.isSpine=k$f,this.ikArr.push(k$H)}var k$O,k$P=k$i.getUint16(),k$Q=0;for(k$a=0;k$a<k$P;k$a++){for(k$L=new k$Ua,k$Q=k$i.getUint16(),k$b=0;k$b<k$Q;k$b++)k$L.boneIndexs.push(k$i.getInt16());k$L.name=k$i.getUTFString(),k$L.targetIndex=k$i.getInt16(),k$L.rotateMix=k$i.getFloat32(),k$L.translateMix=k$i.getFloat32(),k$L.scaleMix=k$i.getFloat32(),k$L.shearMix=k$i.getFloat32(),k$L.offsetRotation=k$i.getFloat32(),k$L.offsetX=k$i.getFloat32(),k$L.offsetY=k$i.getFloat32(),k$L.offsetScaleX=k$i.getFloat32(),k$L.offsetScaleY=k$i.getFloat32(),k$L.offsetShearY=k$i.getFloat32(),this.tfArr.push(k$L)}var k$R=k$i.getUint16(),k$S=0;for(k$a=0;k$a<k$R;k$a++){for((k$O=new k$Qa).name=k$i.readUTFString(),k$S=k$i.getUint16(),k$b=0;k$b<k$S;k$b++)k$O.bones.push(k$i.getInt16());k$O.target=k$i.readUTFString(),k$O.positionMode=k$i.readUTFString(),k$O.spacingMode=k$i.readUTFString(),k$O.rotateMode=k$i.readUTFString(),k$O.offsetRotation=k$i.getFloat32(),k$O.position=k$i.getFloat32(),k$O.spacing=k$i.getFloat32(),k$O.rotateMix=k$i.getFloat32(),k$O.translateMix=k$i.getFloat32(),this.pathArr.push(k$O)}var k$T,k$U,k$V,k$W,k$X,k$Y=0,k$Z=0,k$$=0,k$_=NaN,k$u=0,k$v=k$i.getInt16();for(k$a=0;k$a<k$v;k$a++){var k$aa=k$i.getUint8(),k$ba={};this.deformAniArr.push(k$ba);for(var k$ca=0;k$ca<k$aa;k$ca++)for((k$T=new k$Ka).skinName=k$i.getUTFString(),k$ba[k$T.skinName]=k$T,k$Y=k$i.getInt16(),k$b=0;k$b<k$Y;k$b++)for(k$U=new k$La,k$T.deformSlotDataList.push(k$U),k$Z=k$i.getInt16(),k$c=0;k$c<k$Z;k$c++)for(k$V=new k$Ma,k$U.deformSlotDisplayList.push(k$V),k$V.slotIndex=k$i.getInt16(),k$V.attachment=k$i.getUTFString(),k$$=k$i.getInt16(),k$d=0;k$d<k$$;k$d++)for(1==k$i.getByte()?k$V.tweenKeyList.push(!0):k$V.tweenKeyList.push(!1),k$_=k$i.getFloat32(),k$V.timeList.push(k$_),k$W=[],k$V.vectices.push(k$W),k$u=k$i.getInt16(),k$e=0;k$e<k$u;k$e++)k$W.push(k$i.getFloat32())}var k$da,k$ea,k$fa=k$i.getInt16(),k$ga=0,k$ha=0;for(k$a=0;k$a<k$fa;k$a++){for(k$ga=k$i.getInt16(),k$X=[],k$b=0;k$b<k$ga;k$b++){for((k$da=new k$Na).time=k$i.getFloat32(),k$ha=k$i.getInt16(),k$c=0;k$c<k$ha;k$c++)k$da.drawOrder.push(k$i.getInt16());k$X.push(k$da)}this.drawOrderAniArr.push(k$X)}var k$ia,k$ja=k$i.getInt16(),k$ka=0;for(k$a=0;k$a<k$ja;k$a++){for(k$ka=k$i.getInt16(),k$ea=[],k$b=0;k$b<k$ka;k$b++)(k$ia=new k$Oa).name=k$i.getUTFString(),k$ia.intValue=k$i.getInt32(),k$ia.floatValue=k$i.getFloat32(),k$ia.stringValue=k$i.getUTFString(),k$ia.time=k$i.getFloat32(),k$ea.push(k$ia);this.eventAniArr.push(k$ea)}var k$la=k$i.getInt16();if(0<k$la)for(this.attachmentNames=[],k$a=0;k$a<k$la;k$a++)this.attachmentNames.push(k$i.getUTFString());var k$ma,k$na,k$oa=k$i.getInt16();for(k$a=0;k$a<k$oa;k$a++)(k$ma=new k$Ja).name=k$i.readUTFString(),k$ma.parent=k$i.readUTFString(),k$ma.attachmentName=k$i.readUTFString(),k$ma.srcDisplayIndex=k$ma.displayIndex=k$i.getInt16(),(k$ma.templet=this).boneSlotDic[k$ma.name]=k$ma,null==(k$na=this.bindBoneBoneSlotDic[k$ma.parent])&&(this.bindBoneBoneSlotDic[k$ma.parent]=k$na=[]),k$na.push(k$ma),this.boneSlotArray.push(k$ma);var k$pa,k$qa,k$ra,k$sa=k$i.readUTFString().split("\n"),k$ta=0,k$wa=k$i.getUint8(),k$xa=0,k$ya=0,k$za=0,k$Aa=0,k$Ba=0,k$Ca=0,k$Da=0;for(k$a=0;k$a<k$wa;k$a++){for((k$pa=new k$Ra).name=k$sa[k$ta++],k$xa=k$i.getUint8(),k$b=0;k$b<k$xa;k$b++){for((k$qa=new k$Ta).name=k$sa[k$ta++],k$ma=this.boneSlotDic[k$qa.name],k$ya=k$i.getUint8(),k$c=0;k$c<k$ya;k$c++){if(k$ra=new k$Sa,this.skinSlotDisplayDataArr.push(k$ra),k$ra.name=k$sa[k$ta++],k$ra.attachmentName=k$sa[k$ta++],k$ra.transform=new k$Va,k$ra.transform.scX=k$i.getFloat32(),k$ra.transform.skX=k$i.getFloat32(),k$ra.transform.skY=k$i.getFloat32(),k$ra.transform.scY=k$i.getFloat32(),k$ra.transform.x=k$i.getFloat32(),k$ra.transform.y=k$i.getFloat32(),k$qa.displayArr.push(k$ra),k$ra.width=k$i.getFloat32(),k$ra.height=k$i.getFloat32(),k$ra.type=k$i.getUint8(),k$ra.verLen=k$i.getUint16(),0<(k$E=k$i.getUint16()))for(k$ra.bones=[],k$d=0;k$d<k$E;k$d++){var k$Ea=k$i.getUint16();k$ra.bones.push(k$Ea)}if(0<(k$za=k$i.getUint16()))for(k$ra.uvs=[],k$d=0;k$d<k$za;k$d++)k$ra.uvs.push(k$i.getFloat32());if(0<(k$Aa=k$i.getUint16()))for(k$ra.weights=[],k$d=0;k$d<k$Aa;k$d++)k$ra.weights.push(k$i.getFloat32());if(0<(k$Ba=k$i.getUint16()))for(k$ra.triangles=[],k$d=0;k$d<k$Ba;k$d++)k$ra.triangles.push(k$i.getUint16());if(0<(k$Ca=k$i.getUint16()))for(k$ra.vertices=[],k$d=0;k$d<k$Ca;k$d++)k$ra.vertices.push(k$i.getFloat32());if(0<(k$Da=k$i.getUint16()))for(k$ra.lengths=[],k$d=0;k$d<k$Da;k$d++)k$ra.lengths.push(k$i.getFloat32())}k$pa.slotArr.push(k$qa)}this.skinDic[k$pa.name]=k$pa,this.skinDataArray.push(k$pa)}1==k$i.getUint8()?(this.yReverseMatrix=new k$Ga(1,0,0,-1,0,0),k$D&&k$D.setTempMatrix(this.yReverseMatrix)):k$D&&k$D.setTempMatrix(new k$Ga),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},k$a.getTexture=function(k$a){var k$b=this.subTextureDic[k$a];return k$b||(k$b=this.subTextureDic[k$a.substr(0,k$a.length-1)]),null==k$b?this._mainTexture:k$b},k$a.showSkinByIndex=function(k$a,k$b,k$c){if(void 0===k$c&&(k$c=!0),k$b<0&&k$b>=this.skinDataArray.length)return!1;var k$d,k$e,k$f=0,k$g=0,k$h=this.skinDataArray[k$b];if(k$h){for(k$f=0,k$g=k$h.slotArr.length;k$f<k$g;k$f++)(k$e=k$h.slotArr[k$f])&&(k$d=k$a[k$e.name])&&(k$d.showSlotData(k$e,k$c),k$c&&"undefined"!=k$d.attachmentName&&"null"!=k$d.attachmentName?k$d.showDisplayByName(k$d.attachmentName):k$d.showDisplayByIndex(k$d.displayIndex));return!0}return!1},k$a.getSkinIndexByName=function(k$a){for(var k$b=0,k$c=this.skinDataArray.length;k$b<k$c;k$b++)if(this.skinDataArray[k$b].name==k$a)return k$b;return-1},k$a.getGrahicsDataWithCache=function(k$a,k$b){return this._graphicsCache[k$a][k$b]},k$a.setGrahicsDataWithCache=function(k$a,k$b,k$c){this._graphicsCache[k$a][k$b]=k$c},k$a.destroy=function(){var k$a;for(var k$b in this._isDestroyed=!0,this.subTextureDic)(k$a=this.subTextureDic[k$b])&&k$a.destroy();for(k$b in this._textureDic)(k$a=this._textureDic[k$b])&&k$a.destroy();for(var k$c=0,k$d=this.skinSlotDisplayDataArr.length;k$c<k$d;k$c++)this.skinSlotDisplayDataArr[k$c].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete k$e.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},k$a.getAniNameByIndex=function(k$a){var k$b=this.getAnimation(k$a);return k$b?k$b.name:null},k$f(0,k$a,"rate",function(){return this._rate},function(k$a){this._rate=k$a}),k$e.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",k$e.TEMPLET_DICTIONARY=null,k$e}(k$K)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(k$a,k$b){"use strict";for(var k$c in Object.defineProperty(k$b,"__esModule",{value:!0}),Laya){var k$d=Laya[k$c];k$d&&k$d.__isclass&&(k$b[k$c]=k$d)}});