var A=wx.$N;import FunSdk from"./nnnhp";const sdk=new FunSdk;var config={game_id:"88",partner_label:A[84],game_pkg:A[85],partner_id:A[86],game_ver:A[87],is_auth:!1,partner_and_key:A[88],partner_ios_key:A[89]};window.config=config;var _nO06SC=_nO6CS0();var HOST=A[90];var t;var t_second=0;var t_max=300;var _nO06CS=null;var _nO6SC0=null;var _nO6S0C=null;var user_invite_by_activity=null;var partner_user_info=null;var sys_info=wx.getSystemInfoSync();var platform=sys_info.platform;function getGameInfo(r){let e=config.partner_ios_key;platform!=A[27]&&platform!=A[91]||(e=config.partner_and_key),sdk.game({game_key:e},function(e){0==e.code?r&&r(e.data):r&&r({})})}function _nO6CS0(){var i={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(A[92]);var n=this;var t;t=wx.getStorageSync(A[93])?0:(t=n.uuid(16,32),wx.setStorageSync(A[93],t),1),wx.getStorageSync(A[94])||(o=n.uuid(16,32),wx.setStorageSync(A[94],o));var o=wx.getLaunchOptionsSync();var a=o.scene||"";console.log(A[95],JSON.stringify(o)),t&&o.query&&o.query.ad_code&&wx.setStorageSync(A[96],o.query.ad_code),n.log(A[97],{install:t,scene:a}),wx.showShareMenu();n=o.query&&o.query.invite?o.query.invite:"";var i=o.query&&o.query.invite_type?o.query.invite_type:"";var s=o.query&&o.query.cp_activity_id?o.query.cp_activity_id:"";s||(i=(s=o.query&&o.query.shareMessageToFriendScene?o.query.shareMessageToFriendScene:"")?A[98]:""),s&&(user_invite_by_activity={invite:n,invite_type:i,is_new:t,scene:a,cp_activity_id:s}),n&&(_nO6SC0={invite:n,invite_type:i,is_new:t,scene:a}),e&&this.checkGameVersion(e,function(e){r&&r(e)})},login:function(e,n){console.log(A[99]);var t=this;i[A[100]]=typeof n==A[101]?n:null,wx.login({success:function(r){console.log(A[102]+JSON.stringify(r)),r.code?getGameInfo(function(e){sdk.gameLogin({host_url:e.host_url,game_key:e.game_key,code:r.code},function(e){console.log(A[103]+JSON.stringify(e)),0==e.code?(partner_user_info=e.data,t.do_login(e.data)):n&&n(1)},function(e){console.log(A[104]+JSON.stringify(e)),n&&n(1)})}):n&&n(1,{errMsg:r.errMsg})},fail:function(e){console.log(A[105]+JSON.stringify(e)),(-1<e.errMsg.indexOf(A[106])||-1<e.errMsg.indexOf(A[107]))&&n&&n(1,{errMsg:e.errMsg})}})},do_login:function(e){var n=this;var r=n.getPublicData();if(r[A[108]]=JSON.stringify(e),_nO6SC0&&typeof _nO6SC0==A[109])for(var t in _nO6SC0)r[t]=_nO6SC0[t];wx.request({url:A[110]+HOST+A[111],method:A[4],dataType:A[5],header:{"content-type":A[3]},data:r,success:function(e){if(console.log(A[112]+JSON.stringify(e)),200==e.statusCode){e=e.data;if(e.state){try{wx.setStorageSync(A[113],e.data.sdk_token),wx.setStorageSync(A[114],e.data.user_id),wx.setStorageSync(A[115],e.data.username),e.data.ext&&wx.setStorageSync(A[116],e.data.ext)}catch(e){}var r={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};i[A[100]]&&i[A[100]](0,r)}else i[A[100]]&&i[A[100]](1,{errMsg:e.msg});n.getShareInfo(A[117],function(e){console.log(A[118]),wx.onShareAppMessage(function(){return n.logStartShare(A[117]),{title:e.title,imageUrl:e.img,query:e.query}})})}else i[A[100]]&&i[A[100]](1,{errMsg:A[119]})}})},share:function(e){i[A[120]]=typeof callback==A[101]?callback:null;var r=e.type||A[120];var n=e.cp_activity_id||"";console.log(A[121]+r);var t=this;this.getShareInfo(r,function(e){""!=n&&""!=e.query&&(e.query=e.query+A[122]+n),t.logStartShare(r),wx.shareAppMessage({title:e.title,imageUrl:e.img,query:e.query})})},logStartShare:function(e){var r=wx.getStorageSync(A[113]);wx.request({url:A[110]+HOST+A[123],method:A[4],dataType:A[5],header:{"content-type":A[3]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:_nO06CS?_nO06CS.server_id:"",role_id:_nO06CS?_nO06CS.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,n){console.log(A[124]);wx.getStorageSync(A[113]);wx.request({url:A[110]+HOST+A[125],method:A[4],dataType:A[5],header:{"content-type":A[3]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(A[126]+JSON.stringify(e)),200==e.statusCode&&(r=e.data).state?n&&n(r.data):n&&n({develop:0})}})},getShareInfo:function(e,r){console.log(A[127]);var n=wx.getStorageSync(A[113]);wx.request({url:A[110]+HOST+A[128],method:A[4],dataType:A[5],header:{"content-type":A[3]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:n,type:e,server_id:_nO06CS?_nO06CS.server_id:"",role_id:_nO06CS?_nO06CS.role_id:"",no_log:1},success:function(e){console.log(A[129]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):i[A[120]]&&i[A[120]](1,{errMsg:A[130]+e.msg}):i[A[120]]&&i[A[120]](1,{errMsg:A[131]})}})},updateShare:function(e,r,n,t,o,a){console.log(A[132]);var i=wx.getStorageSync(A[113]);wx.request({url:A[110]+HOST+A[133],method:A[4],dataType:A[5],header:{"content-type":A[3]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:r,is_new:n,role_id:t,sever_id:o,scene:a},success:function(e){console.log(A[134]+JSON.stringify(e))}})},msgCheck:function(n,t){console.log(A[135]);let o={data:{}};getGameInfo(function(e){var r=e.game_key;sdk.checkWords({game_key:r,account:partner_user_info.openid,scene:4,content:n,host_url:e.host_url},function(e){console.log(A[136]+JSON.stringify(e)),0==e.code?(o.statusCode=200,o.data.state=1):(o.statusCode=0,o.data.state=0),t&&t(o)},function(e){o.statusCode=0,o.data.state=0,t&&t(o)})})},pay:function(e,r){var n=this;wx.checkSession({success:function(){n.startPay(e,r)},fail:function(){console.log(A[137]),n.login({},function(){n.startPay(e,r)})}})},startPay:function(n,e){console.log(A[138]+JSON.stringify(n));var t=this;i[A[139]]=typeof e==A[101]?e:null;var o=wx.getStorageSync(A[113]);var a=wx.getStorageSync(A[116]);o&&a?getGameInfo(function(e){e={cpbill:n.cpbill,productid:n.productid,productname:n.productname,productdesc:n.productdesc,serverid:n.serverid,servername:n.servername,roleid:n.roleid,rolename:n.rolename,rolelevel:n.rolelevel,price:n.price,extension:n.extension,sdk_token:o,session_key:a,platform:platform,partner_game_info:e,partner_openid:partner_user_info.openid};t.order_data=e;var r=t.getPublicData();r[A[141]]=JSON.stringify(e),wx.request({url:A[110]+HOST+A[142],method:A[4],dataType:A[5],header:{"content-type":A[3]},data:r,success:function(e){console.log(A[143]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?typeof wx.requestPayment==A[10]&&(platform==A[27]||platform==A[91]?sdk.midasNotice(e.data.pay_data):t.kfPay(e.data)):i[A[139]]&&i[A[139]](1,{errMsg:e.msg}):i[A[100]]&&i[A[100]](1,{errMsg:A[119]})}})}):i[A[139]]&&i[A[139]](1,{errMsg:A[140]})},kfPay:function(e){console.log(A[144]),sdk.order({host_url:e.pay_data.host_url,game_key:e.pay_data.game_key,account:e.pay_data.account,server:e.pay_data.server,role:e.pay_data.role,amount:e.pay_data.amount,extend:e.pay_data.extend},function(e){console.log(A[145]+JSON.stringify(e)),wx.showModal({title:A[146],content:A[147],showCancel:!1,confirmText:A[148],success:function(){wx.openCustomerServiceConversation()}})})},logCreateRole:function(r){var e=wx.getStorageSync(A[114]);var n=wx.getStorageSync(A[115]);var t={};var o,a,i;t[A[149]]=e,t.user_name=n,t[A[150]]=r.roleid,t[A[151]]=r.rolelevel,t.role_name=r.rolename,t[A[152]]=r.serverid,r.roleid&&r.serverid&&(_nO06CS={role_id:r.roleid,server_id:r.serverid}),this.log(A[153],t),user_invite_by_activity&&(n=user_invite_by_activity.scene,t=user_invite_by_activity.is_new,o=user_invite_by_activity.invite,a=user_invite_by_activity&&user_invite_by_activity.invite_type?user_invite_by_activity.invite_type:"",i=user_invite_by_activity.cp_activity_id,e={uid:e,role_id:r.roleid,role_name:r.rolename,server_id:r.serverid,server_name:r.servername,game_id:config.game_id,partner_id:config.partner_id,game_pkg:config.game_pkg,scene:n,is_new:t,invite_code:o,invite_type:a,cp_activity_id:i},wx.request({url:A[110]+HOST+A[154],method:A[4],dataType:A[5],header:{"content-type":A[3]},data:e,success:function(e){console.log(A[155]+JSON.stringify(e))}})),getGameInfo(function(e){sdk.role({host_url:e.host_url,game_key:e.game_key,account:partner_user_info.openid,server:r.serverid,server_name:r.servername,role:r.roleid,role_name:r.rolename,level:r.rolelevel,type:3},function(e){console.log(A[156]+JSON.stringify(e))})})},logEnterGame:function(n){var e=wx.getStorageSync(A[114]);var r=wx.getStorageSync(A[115]);var t={};t[A[149]]=e,t.user_name=r,t[A[150]]=n.roleid,t[A[151]]=n.rolelevel,t.role_name=n.rolename,t[A[152]]=n.serverid,n.roleid&&n.serverid&&(_nO06CS={role_id:n.roleid,server_id:n.serverid}),this.log(A[157],t),_nO6SC0&&this.updateShare(_nO6SC0.invite,_nO6SC0.invite_type,_nO6SC0.is_new,n.roleid,n.serverid,_nO6SC0.scene),getGameInfo(function(e){var r=sdk.wxChannelCode();r&&sdk.role({host_url:e.host_url,game_key:e.game_key,account:partner_user_info.openid,server:n.serverid,server_name:n.servername,role:n.roleid,role_name:n.rolename,level:n.rolelevel,type:r&&r.type?r.type:"",code:r&&r.code?r.code:""},function(e){console.log(A[158]+JSON.stringify(e))}),sdk.role({host_url:e.host_url,game_key:e.game_key,account:partner_user_info.openid,server:n.serverid,server_name:n.servername,role:n.roleid,role_name:n.rolename,level:n.rolelevel,type:0},function(e){console.log(A[159]+JSON.stringify(e))}),sdk.role({host_url:e.host_url,game_key:e.game_key,account:partner_user_info.openid,server:n.serverid,server_name:n.servername,role:n.roleid,role_name:n.rolename,level:n.rolelevel,type:3},function(e){console.log(A[160]+JSON.stringify(e))}),sdk.role({host_url:e.host_url,game_key:e.game_key,account:partner_user_info.openid,server:n.serverid,server_name:n.servername,role:n.roleid,role_name:n.rolename,level:n.rolelevel,type:6},function(e){console.log(A[161]+JSON.stringify(e))})})},logRoleUpLevel:function(r){var e=wx.getStorageSync(A[114]);var n=wx.getStorageSync(A[115]);var t={};t[A[149]]=e,t.user_name=n,t[A[150]]=r.roleid,t[A[151]]=r.rolelevel,t.role_name=r.rolename,t[A[152]]=r.serverid,r.roleid&&r.serverid&&(_nO06CS={role_id:r.roleid,server_id:r.serverid}),this.log(A[162],t),getGameInfo(function(e){sdk.role({host_url:e.host_url,game_key:e.game_key,account:partner_user_info.openid,server:r.serverid,server_name:r.servername,role:r.roleid,role_name:r.rolename,level:r.rolelevel,type:8},function(e){console.log(A[163]+JSON.stringify(e))})})},uuid:function(e,r){var n=A[164].split("");var t,o=[];var a;if(e=e||n.length,r)for(t=0;t<r;t++)o[t]=n[0|Math.random()*e];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",t=0;t<36;t++)o[t]||(a=0|16*Math.random(),o[t]=n[19==t?3&a|8:a]);return o.join("")},getPublicData:function(){var e=wx.getSystemInfoSync();var r=wx.getStorageSync(A[93]);var n=wx.getStorageSync(A[94]);var t=wx.getStorageSync(A[96]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,is_from_min:1,ad_code:t,uuid:r,idfv:n,dname:e.model,mac:A[165],net_type:0==e.wifiSignal?"4G":A[166],os_ver:e.system,sdk_ver:e.version,game_ver:config.game_ver,device:e.platform==A[27]?1:2}},log:function(e,r){var n=this.getPublicData();for(var t in r)n[t]=r[t];console.log(A[167]+e),console.log(n),wx.request({url:A[110]+HOST+A[168]+e+A[169]+encodeURIComponent(JSON.stringify(n))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){},setMessageToFriendQuery:function(e,r){e=e.activity_id;e=wx.setMessageToFriendQuery({shareMessageToFriendScene:e});r&&r(e)},getFriendShareInfo:function(r){this.getShareInfo(A[98],function(e){r&&r({title:e.title,img:e.img})})}}}function run(e,r,n){e in _nO06SC&&_nO06SC[e](r,n)}exports.init=function(e,r){run(A[170],e,r)},exports.login=function(e){run(A[100],"",e)},exports.pay=function(e,r){run(A[139],e,r)},exports.openService=function(){run(A[171])},exports.logCreateRole=function(e,r,n,t,o){run(A[172],{serverid:e,servername:r,roleid:n,rolename:t,rolelevel:o})},exports.logEnterGame=function(e,r,n,t,o){run(A[173],{serverid:e,servername:r,roleid:n,rolename:t,rolelevel:o})},exports.logRoleUpLevel=function(e,r,n,t,o){run(A[174],{serverid:e,servername:r,roleid:n,rolename:t,rolelevel:o})},exports.share=function(e,r){r=r&&r.activity_id?r.activity_id:"";run(A[120],{type:e,cp_activity_id:r})},exports.msgCheck=function(e,r){run(A[175],e,r)},exports.downloadClient=function(){run(A[176])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(A[177])},exports.weiduanHelper=function(){run(A[178])},exports.setMessageToFriendQuery=function(e,r){run(A[179],e,r)},exports.getFriendShareInfo=function(e){run(A[180],e)};