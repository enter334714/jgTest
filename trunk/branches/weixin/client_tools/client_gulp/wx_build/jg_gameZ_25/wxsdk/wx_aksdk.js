require("../untils/ddtSDKPlat.js");var config={game_id:"256",game_pkg:"tjqy_tjqyxatl666wxxcx_TC",partner_label:"ddt6",partner_id:"489",game_ver:"56.0.7",platId:1e3,gameId:298,channelVer:"mxsdk_tjqy_xatl",mode:2,is_auth:!0};window.config=config;var PARTNER_SDK=mainSDK();var HOST="sdk.sh9130.com";var user_game_info=null;var user_invite_info=null;var partner_data={};function mainSDK(){var C$zus={};return{order_data:{},init:function(C$zue,C$zua){C$zue=C$zue&&C$zue.game_ver?C$zue.game_ver:0;console.log("[SDK]CP\u8c03\u7528init\u63a5\u53e3");var C$zut=this;var C$zur;C$zur=wx.getStorageSync("plat_uuid")?0:(C$zur=C$zut.uuid(16,32),wx.setStorageSync("plat_uuid",C$zur),1),wx.getStorageSync("plat_idfv")||(C$zuo=C$zut.uuid(16,32),wx.setStorageSync("plat_idfv",C$zuo));var C$zuo=wx.getLaunchOptionsSync();var C$zun=C$zuo.scene||"";C$zur&&C$zuo.query&&C$zuo.query.ad_code&&wx.setStorageSync("plat_ad_code",C$zuo.query.ad_code),C$zut.log("start",{install:C$zur,scene:C$zun});ddtSDKPlat.init({platId:config.platId,gameId:config.gameId,channelVer:config.channelVer,mode:config.mode},function(C$zue,C$zua){switch(C$zue){case"init_success":console.log("[SDK]\u521d\u59cb\u5316\u6210\u529f\uff1a",C$zue,C$zua);break;case"init_fail":console.log("[SDK]\u521d\u59cb\u5316\u5931\u8d25\uff1a",C$zue,C$zua);break;case"login_success":console.log("[SDK]\u767b\u5f55\u6210\u529f\uff1a",C$zue,C$zua),C$zut.do_login(C$zua);break;case"login_fail":console.log("[SDK]\u767b\u5f55\u5931\u8d25\uff1a",C$zue,C$zua),C$zus.login&&C$zus.login(1,{errMsg:C$zua.msg});break;case"pay_success":console.log("[SDK]\u652f\u4ed8\u6210\u529f\uff1a",C$zue,C$zua);break;case"pay_fail":console.log("[SDK]\u652f\u4ed8\u5931\u8d25\uff1a",C$zue,C$zua),C$zus.pay&&C$zus.pay(1,{errMsg:C$zua.errMsg})}},!0),wx.showShareMenu({withShareTicket:!0}),console.log("sdk\u7248\u672c\uff1a"+ddtSDKPlat.version);var C$zui=C$zuo.query&&C$zuo.query.invite?C$zuo.query.invite:"";C$zuo=C$zuo.query&&C$zuo.query.invite_type?C$zuo.query.invite_type:"";C$zui&&(user_invite_info={invite:C$zui,invite_type:C$zuo,is_new:C$zur,scene:C$zun}),C$zue&&this.checkGameVersion(C$zue,function(C$zue){C$zua&&C$zua(C$zue)})},login:function(C$zue,C$zua){console.log("[SDK]\u8c03\u8d77\u767b\u5f55"),C$zus.login="function"==typeof C$zua?C$zua:null},do_login:function(C$zue){var C$zut=this;partner_data={uid:C$zue.uid,gameToken:C$zue.gameToken,time:C$zue.time,sign:C$zue.sign};var C$zua=C$zut.getPublicData();if(C$zua.is_from_min=1,C$zua.partner_data=JSON.stringify(partner_data),user_invite_info&&"object"==typeof user_invite_info)for(var C$zur in user_invite_info)C$zua[C$zur]=user_invite_info[C$zur];wx.request({url:"https://"+HOST+"/partner/auth",method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},data:C$zua,success:function(C$zue){if(console.log("[SDK]\u767b\u5f55\u7ed3\u679c\uff1a"),console.log(C$zue),200===C$zue.statusCode){C$zue=C$zue.data;if(C$zue.state){try{wx.setStorageSync("plat_sdk_token",C$zue.data.sdk_token),wx.setStorageSync("plat_uid",C$zue.data.user_id),wx.setStorageSync("plat_username",C$zue.data.username),C$zue.data.ext&&wx.setStorageSync("plat_session_key",C$zue.data.ext)}catch(C$zue){}var C$zua={userid:C$zue.data.user_id,account:C$zue.data.nick_name,token:C$zue.data.token,invite_uid:C$zue.data.invite_uid||"",invite_nickname:C$zue.data.invite_nickname||"",invite_head_img:C$zue.data.invite_head_img||"",head_img:C$zue.data.head_img||"",is_client:C$zue.data.is_client||"0",ios_pay:C$zue.data.ios_pay||"0"};C$zus.login&&C$zus.login(0,C$zua)}else C$zus.login&&C$zus.login(1,{errMsg:C$zue.msg});C$zut.getShareInfo("menu",function(C$zue){console.log("[SDK]\u5f00\u59cb\u76d1\u542c\u53f3\u4e0a\u89d2\u83dc\u5355\u5206\u4eab"),wx.onShareAppMessage(function(){return C$zut.logStartShare("menu"),{title:C$zue.title,imageUrl:C$zue.img,query:C$zue.query}})})}else C$zus.login&&C$zus.login(1,{errMsg:"\u8bf7\u6c42\u5e73\u53f0\u670d\u52a1\u5668\u5931\u8d25\uff01"})}})},share:function(C$zue){C$zus.share="function"==typeof callback?callback:null;var C$zua=C$zue.type||"share";console.log("[SDK]CP\u8c03\u7528\u5206\u4eab type="+C$zua);var C$zut=this;this.getShareInfo(C$zua,function(C$zue){C$zut.logStartShare(C$zua),wx.shareAppMessage({title:C$zue.title,imageUrl:C$zue.img,query:C$zue.query})})},logStartShare:function(C$zue){var C$zua=wx.getStorageSync("plat_sdk_token");wx.request({url:"https://"+HOST+"/game/min/?ac=logStartShare",method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:C$zua,server_id:user_game_info?user_game_info.server_id:"",role_id:user_game_info?user_game_info.role_id:"",type:C$zue},success:function(C$zue){}})},openService:function(){ddtSDKPlat.toService()},checkGameVersion:function(C$zue,C$zut){console.log("[SDK]\u68c0\u67e5\u6e38\u620f\u7248\u672c");wx.getStorageSync("plat_sdk_token");wx.request({url:"https://"+HOST+"/game/min/?ac=checkGameVersion",method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:C$zue},success:function(C$zue){var C$zua;console.log("[SDK]\u83b7\u53d6\u6e38\u620f\u7248\u672c\u7ed3\u679c"),console.log(C$zue),200==C$zue.statusCode&&(C$zua=C$zue.data).state?C$zut&&C$zut(C$zua.data):C$zut&&C$zut({develop:0})}})},getShareInfo:function(C$zue,C$zua){console.log("[SDK]\u83b7\u53d6\u5206\u4eab\u53c2\u6570");var C$zut=wx.getStorageSync("plat_sdk_token");wx.request({url:"https://"+HOST+"/game/min/?ac=shareConfig",method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:C$zut,type:C$zue,server_id:user_game_info?user_game_info.server_id:"",role_id:user_game_info?user_game_info.role_id:"",no_log:1},success:function(C$zue){console.log("[SDK]\u83b7\u53d6\u5206\u4eab\u53c2\u6570\u7ed3\u679c"),console.log(C$zue),200==C$zue.statusCode?(C$zue=C$zue.data).state?C$zua&&C$zua(C$zue.data):C$zus.share&&C$zus.share(1,{errMsg:"\u5206\u4eab\u5931\u8d25\uff1a"+C$zue.msg}):C$zus.share&&C$zus.share(1,{errMsg:"\u83b7\u53d6\u5206\u4eab\u6570\u636e\u5931\u8d25\uff01"})}})},updateShare:function(C$zue,C$zua,C$zut,C$zur,C$zuo,C$zun){console.log("[SDK]\u5206\u4eab\u8fc7\u6765\u7684\u73a9\u5bb6\u4e0a\u62a5\u7ed9\u670d\u52a1\u5668");var C$zui=wx.getStorageSync("plat_sdk_token");wx.request({url:"https://"+HOST+"/game/min/?ac=updateShare",method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:C$zui,invite:C$zue,invite_type:C$zua,is_new:C$zut,role_id:C$zur,sever_id:C$zuo,scene:C$zun},success:function(C$zue){console.log("[SDK]\u4e0a\u62a5\u5206\u4eab\u7ed3\u679c\u8fd4\u56de:"),console.log(C$zue)}})},msgCheck:function(C$zue,C$zua){console.log("[SDK]\u67e5\u770b\u6587\u672c\u662f\u5426\u6709\u8fdd\u89c4\u5185\u5bb9");var C$zut=wx.getStorageSync("plat_sdk_token");wx.request({url:"https://"+HOST+"/partner/data/msgSecCheck/"+config.partner_id+"/"+config.game_pkg,method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:C$zut,content:C$zue,gameToken:partner_data.gameToken,uid:partner_data.uid,channelVer:config.channelVer,gameId:config.gameId,platId:config.platId},success:function(C$zue){console.log("[SDK]\u67e5\u770b\u6587\u672c\u662f\u5426\u6709\u8fdd\u89c4\u5185\u5bb9\u7ed3\u679c\u8fd4\u56de:"),console.log(C$zue),C$zua&&C$zua(C$zue)}})},pay:function(C$zue,C$zua){this.startPay(C$zue,C$zua)},startPay:function(C$zue,C$zua){console.log("[SDK]\u8c03\u8d77\u652f\u4ed8\uff0cCP\u4f20\u503c\uff1a"),console.log(C$zue);var C$zut=this;C$zus.pay="function"==typeof C$zua?C$zua:null;C$zua=wx.getStorageSync("plat_sdk_token");var C$zur=wx.getStorageSync("plat_session_key");var C$zuo;C$zua||C$zur?(C$zuo=wx.getSystemInfoSync(),C$zue={cpbill:C$zue.cpbill,productid:C$zue.productid,productname:C$zue.productname,productdesc:C$zue.productdesc,serverid:C$zue.serverid,servername:C$zue.servername,roleid:C$zue.roleid,rolename:C$zue.rolename,rolelevel:C$zue.rolelevel,price:C$zue.price,extension:C$zue.extension,sdk_token:C$zua,session_key:C$zur,platform:C$zuo.platform},C$zut.order_data=C$zue,(C$zua=C$zut.getPublicData()).order_data=JSON.stringify(C$zue),C$zua.is_from_min=1,wx.request({url:"https://"+HOST+"/partner/order",method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},data:C$zua,success:function(C$zue){var C$zua;console.log("[SDK]\u5b8c\u6210\u521b\u5efa\u8ba2\u5355"),console.log(C$zue),200==C$zue.statusCode?""==(C$zue=C$zue.data).data.ext?C$zue.state&&C$zue.data.pay_data&&""==C$zue.data.ext?(console.log("[SDK]\u8054\u8fd0\u652f\u4ed8\u53c2\u6570"+JSON.stringify(C$zue.data.pay_data)),C$zua={billNo:C$zue.data.pay_data.billNo,amount:C$zue.data.pay_data.amount,serverId:C$zue.data.pay_data.serverId,roleId:C$zue.data.pay_data.roleId,roleName:C$zue.data.pay_data.roleName,roleLevel:C$zue.data.pay_data.roleLevel,subject:C$zue.data.pay_data.subject,productDesc:C$zue.data.pay_data.productDesc,extraInfo:C$zue.data.pay_data.extraInfo},ddtSDKPlat.pay(C$zua)):C$zut.extDo({ext1:C$zue.data.ext,ext2:C$zue.data.pay_data}):C$zus.pay&&C$zus.pay(1,{errMsg:C$zue.errMsg}):C$zus.login&&C$zus.login(1,{errMsg:"\u8bf7\u6c42\u5e73\u53f0\u670d\u52a1\u5668\u5931\u8d25\uff01"})}})):C$zus.pay&&C$zus.pay(1,{errMsg:"\u7528\u6237\u672a\u767b\u5f55\uff0c\u652f\u4ed8\u5931\u8d25\uff01"})},extDo:function(C$zue){wx.navigateToMiniProgram({appId:C$zue.ext1,path:"pages/pay/pay?order_id="+C$zue.ext2.extraInfo+"&money="+C$zue.ext2.amount,extraData:{},envVersion:"release",success(C$zue){}})},logCreateRole:function(C$zue){var C$zua=wx.getStorageSync("plat_uid");var C$zut=wx.getStorageSync("plat_username");var C$zur={};C$zur.user_id=C$zua,C$zur.user_name=C$zut,C$zur.role_id=C$zue.roleid,C$zur.role_lev=C$zue.rolelevel,C$zur.role_name=C$zue.rolename,C$zur.server_id=C$zue.serverid,C$zue.roleid&&C$zue.serverid&&(user_game_info={role_id:C$zue.roleid,server_id:C$zue.serverid}),this.log("create",C$zur);C$zua={roleLevel:C$zue.rolelevel+"",roleId:C$zue.roleid+"",roleName:C$zue.rolename,serverName:C$zue.servername,serverId:C$zue.serverid+""};ddtSDKPlat.submitData("createRole",C$zua)},logEnterGame:function(C$zue,C$zua){var C$zut=wx.getStorageSync("plat_uid");var C$zur=wx.getStorageSync("plat_username");var C$zuo={};C$zuo.user_id=C$zut,C$zuo.user_name=C$zur,C$zuo.role_id=C$zue.roleid,C$zuo.role_lev=C$zue.rolelevel,C$zuo.role_name=C$zue.rolename,C$zuo.server_id=C$zue.serverid,C$zue.roleid&&C$zue.serverid&&(user_game_info={role_id:C$zue.roleid,server_id:C$zue.serverid}),this.log("enter",C$zuo);C$zut={roleLevel:C$zue.rolelevel,roleId:C$zue.roleid,roleName:C$zue.rolename,serverName:C$zue.servername,serverId:C$zue.serverid};ddtSDKPlat.submitData("enterGame",C$zut),user_invite_info&&this.updateShare(user_invite_info.invite,user_invite_info.invite_type,user_invite_info.is_new,C$zue.roleid,C$zue.serverid,user_invite_info.scene)},logRoleUpLevel:function(C$zue,C$zua){var C$zut=wx.getStorageSync("plat_uid");var C$zur=wx.getStorageSync("plat_username");this.log("levelup",C$zue);var C$zuo={};C$zuo.user_id=C$zut,C$zuo.user_name=C$zur,C$zuo.role_id=C$zue.roleid,C$zuo.role_lev=C$zue.rolelevel,C$zuo.role_name=C$zue.rolename,C$zuo.server_id=C$zue.serverid,C$zue.roleid&&C$zue.serverid&&(user_game_info={role_id:C$zue.roleid,server_id:C$zue.serverid,role_level:C$zue.rolelevel,role_createtime:C$zue.rolecreatetime});C$zut={roleLevel:C$zue.rolelevel,roleId:C$zue.roleid,roleName:C$zue.rolename,serverName:C$zue.servername,serverId:C$zue.serverid,rolecreatetime:C$zue.rolecreatetime,vipLevel:"",power:"",roleSex:"",partyId:"",partyName:""};ddtSDKPlat.submitData("upRoleLevel",C$zut)},subscribeMessage:function(C$zue,C$zua){console.log("[SDK]\u8ba2\u9605\u6d88\u606f\uff1a"+C$zue),C$zus.subscribeMessage="function"==typeof C$zua?C$zua:null,wx.requestSubscribeMessage({tmplIds:C$zue,success(C$zue){console.log("[SDK]\u8ba2\u9605\u6d88\u606f\u8fd4\u56de\uff1a\u6210\u529f"),console.log(C$zue),C$zus.subscribeMessage&&C$zus.subscribeMessage(C$zue)},fail(C$zue){console.log("[SDK]\u8ba2\u9605\u6d88\u606f\u8fd4\u56de\uff1a\u5931\u8d25"),console.log(C$zue),C$zus.subscribeMessage&&C$zus.subscribeMessage(C$zue)}})},weiduanHelper:function(){console.log("[SDK]\u8c03\u7528\u5fae\u7aef\u63a5\u53e3"),ddtSDKPlat.jump()},uuid:function(C$zue,C$zua){var C$zut="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");var C$zur,C$zuo=[];var C$zun;if(C$zue=C$zue||C$zut.length,C$zua)for(C$zur=0;C$zur<C$zua;C$zur++)C$zuo[C$zur]=C$zut[0|Math.random()*C$zue];else for(C$zuo[8]=C$zuo[13]=C$zuo[18]=C$zuo[23]="-",C$zuo[14]="4",C$zur=0;C$zur<36;C$zur++)C$zuo[C$zur]||(C$zun=0|16*Math.random(),C$zuo[C$zur]=C$zut[19==C$zur?3&C$zun|8:C$zun]);return C$zuo.join("")},getPublicData:function(){var C$zue=wx.getSystemInfoSync();var C$zua=wx.getStorageSync("plat_uuid");var C$zut=wx.getStorageSync("plat_idfv");var C$zur=wx.getStorageSync("plat_ad_code");return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:C$zur,uuid:C$zua,idfv:C$zut,dname:C$zue.model,mac:"0000",net_type:0==C$zue.wifiSignal?"4G":"WIFI",os_ver:C$zue.system,sdk_ver:C$zue.version,game_ver:config.game_ver,device:"android"==C$zue.platform?1:2}},log:function(C$zue,C$zua){var C$zut=this.getPublicData();for(var C$zur in C$zua)C$zut[C$zur]=C$zua[C$zur];console.log("[SDK]\u4e0a\u62a5\u6570\u636e\uff1a"+C$zue),console.log(C$zut),wx.request({url:"https://"+HOST+"/partner/h5Log/?type="+C$zue+"&data="+encodeURIComponent(JSON.stringify(C$zut))})},getDate:function(){var C$zue=new Date;return C$zue.getFullYear()+"-"+C$zue.getMonth()+"-"+C$zue.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()}}}function run(C$zue,C$zua,C$zut){C$zue in PARTNER_SDK&&PARTNER_SDK[C$zue](C$zua,C$zut)}exports.init=function(C$zue,C$zua){run("init",C$zue,C$zua)},exports.login=function(C$zue){run("login","",C$zue)},exports.pay=function(C$zue,C$zua){run("pay",C$zue,C$zua)},exports.openService=function(){run("openService")},exports.logCreateRole=function(C$zue,C$zua,C$zut,C$zur,C$zuo){run("logCreateRole",{serverid:C$zue,servername:C$zua,roleid:C$zut,rolename:C$zur,rolelevel:C$zuo})},exports.logEnterGame=function(C$zue,C$zua,C$zut,C$zur,C$zuo,C$zun,C$zui){run("logEnterGame",{serverid:C$zue,servername:C$zua,roleid:C$zut,rolename:C$zur,rolelevel:C$zuo,rolecreatetime:C$zun},C$zui)},exports.logRoleUpLevel=function(C$zue,C$zua,C$zut,C$zur,C$zuo,C$zun,C$zui){run("logRoleUpLevel",{serverid:C$zue,servername:C$zua,roleid:C$zut,rolename:C$zur,rolelevel:C$zuo,rolecreatetime:C$zun},C$zui)},exports.share=function(C$zue){run("share",{type:C$zue})},exports.subscribeMessage=function(C$zue,C$zua){run("subscribeMessage",C$zue,C$zua)},exports.msgCheck=function(C$zue,C$zua){run("msgCheck",C$zue,C$zua)},exports.downloadClient=function(){run("downloadClient")},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run("getPublicData")},exports.weiduanHelper=function(){run("weiduanHelper")};