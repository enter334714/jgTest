var Laya=window.Laya=function(l$P,l$i){var l$B={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(l$i,l$_){return 1==arguments.length?l$B.__presubstr.call(this,l$i):l$B.__presubstr.call(this,l$i,0<l$_?l$_:this.length+l$_)},__init:function(l$i){l$i.forEach(function(l$i){l$i.__init$&&l$i.__init$()})},__isClass:function(l$i){return l$i&&(l$i.__isclass||l$i==Object||l$i==String||l$i==Array)},__newvec:function(l$i,l$_){var l$R=[];l$R.length=l$i;for(var l$r=0;l$r<l$i;l$r++)l$R[l$r]=l$_;return l$R},__extend:function(l$i,l$_){for(var l$R in l$_)if(l$_.hasOwnProperty(l$R)){var l$r=Object.getOwnPropertyDescriptor(l$_,l$R),l$b=l$r.get,l$z=l$r.set;l$b||l$z?l$b&&l$z?Object.defineProperty(l$i,l$R,l$r):(l$b&&Object.defineProperty(l$i,l$R,l$b),l$z&&Object.defineProperty(l$i,l$R,l$z)):l$i[l$R]=l$_[l$R]}function l$L(){l$B.un(this,"constructor",l$i)}l$L.prototype=l$_.prototype,l$i.prototype=new l$L,l$B.un(l$i.prototype,"__imps",l$B.__copy({},l$_.prototype.__imps))},__copy:function(l$i,l$_){if(!l$_)return null;for(var l$R in l$i=l$i||{},l$_)l$i[l$R]=l$_[l$R];return l$i},__package:function(l$i,l$_){if(!l$B.__packages[l$i]){l$B.__packages[l$i]=!0;var l$R=l$P,l$r=l$i.split(".");if(1<l$r.length)for(var l$b=0,l$z=l$r.length-1;l$b<l$z;l$b++){var l$L=l$R[l$r[l$b]];l$R=l$L||(l$R[l$r[l$b]]={})}l$R[l$r[l$r.length-1]]||(l$R[l$r[l$r.length-1]]=l$_||{})}},__hasOwnProperty:function(l$i,l$_){return l$_=l$_||this,Object.hasOwnProperty.call(l$_,l$i)||function l$i(l$_,l$R){if(Object.hasOwnProperty.call(l$R.prototype,l$_))return!0;var l$r=l$R.prototype.__super;return null==l$r?null:l$i(l$_,l$r)}(l$i,l$_.__class)},__typeof:function(l$i,l$_){if(!l$i||!l$_)return!1;if(l$_===String)return"string"==typeof l$i;if(l$_===Number)return"number"==typeof l$i;if(l$_.__interface__)l$_=l$_.__interface__;else if("string"!=typeof l$_)return l$i instanceof l$_;return l$i.__imps&&l$i.__imps[l$_]||l$i.__class==l$_},__as:function(l$i,l$_){return this.__typeof(l$i,l$_)?l$i:null},__int:function(l$i){return l$i?parseInt(l$i):0},interface:function(l$i,l$_){l$B.__package(l$i,{});var l$R=l$B.__internals,l$r=l$R[l$i]=l$R[l$i]||{self:l$i};if(l$_){var l$b=l$_.split(",");l$r.extend=[];for(var l$z=0;l$z<l$b.length;l$z++){var l$L=l$b[l$z];l$R[l$L]=l$R[l$L]||{self:l$L},l$r.extend.push(l$R[l$L])}}var l$w=l$P,l$x=l$i.split(".");for(l$z=0;l$z<l$x.length-1;l$z++)l$w=l$w[l$x[l$z]];l$w[l$x[l$x.length-1]]={__interface__:l$i}},class:function(l$i,l$_,l$R,l$r){if(l$R&&l$B.__extend(l$i,l$R),l$_)if(l$B.__package(l$_,l$i),l$B.__classmap[l$_]=l$i,0<l$_.indexOf(".")){if(0==l$_.indexOf("laya.")){var l$b=l$_.split(".");l$r=l$r||l$b[l$b.length-1],l$B[l$r]&&console.log("Warning!,this class["+l$r+"] already exist:",l$B[l$r]),l$B[l$r]=l$i}}else"Main"==l$_?l$P.Main=l$i:"MainWX"==l$_?l$P.MainWX=l$i:(l$B[l$_]&&console.log("Error!,this class["+l$_+"] already exist:",l$B[l$_]),l$B[l$_]=l$i);var l$z=l$B.un,l$L=l$i.prototype;l$z(l$L,"hasOwnProperty",l$B.__hasOwnProperty),l$z(l$L,"__class",l$i),l$z(l$L,"__super",l$R),l$z(l$L,"__className",l$_),l$z(l$i,"__super",l$R),l$z(l$i,"__className",l$_),l$z(l$i,"__isclass",!0),l$z(l$i,"super",function(l$i){this.__super.call(l$i)})},imps:function(l$i,l$_){if(!l$_)return null;var l$b=l$i.__imps||l$B.un(l$i,"__imps",{});function l$z(l$i){var l$_,l$R;if((l$_=l$B.__internals[l$i])&&(l$b[l$i]=!0,l$R=l$_.extend))for(var l$r=0;l$r<l$R.length;l$r++)l$z(l$R[l$r].self)}for(var l$R in l$_)l$z(l$R)},superSet:function(l$i,l$_,l$R,l$r){var l$b=l$i.prototype["_$set_"+l$R];l$b&&l$b.call(l$_,l$r)},superGet:function(l$i,l$_,l$R){var l$r=l$i.prototype["_$get_"+l$R];return l$r?l$r.call(l$_):null},getset:function(l$i,l$_,l$R,l$r,l$b){l$i?(l$r&&(l$_["_$GET_"+l$R]=l$r),l$b&&(l$_["_$SET_"+l$R]=l$b)):(l$r&&l$B.un(l$_,"_$get_"+l$R,l$r),l$b&&l$B.un(l$_,"_$set_"+l$R,l$b)),l$r&&l$b?Object.defineProperty(l$_,l$R,{get:l$r,set:l$b,enumerable:!1,configurable:!0}):(l$r&&Object.defineProperty(l$_,l$R,{get:l$r,enumerable:!1,configurable:!0}),l$b&&Object.defineProperty(l$_,l$R,{set:l$b,enumerable:!1,configurable:!0}))},static:function(l$R,l$r){for(var l$b=0,l$i=l$r.length;l$b<l$i;l$b+=2)if("length"==l$r[l$b])l$R.length=l$r[l$b+1].call(l$R);else{function l$_(){var l$_=l$r[l$b],l$i=l$r[l$b+1];Object.defineProperty(l$R,l$_,{get:function(){return delete this[l$_],this[l$_]=l$i.call(this)},set:function(l$i){delete this[l$_],this[l$_]=l$i},enumerable:!0,configurable:!0})}l$_()}},un:function(l$i,l$_,l$R){return l$R||(l$R=l$i[l$_]),l$B.__propun.value=l$R,Object.defineProperty(l$i,l$_,l$B.__propun),l$R},uns:function(l$_,l$i){l$i.forEach(function(l$i){l$B.un(l$_,l$i)})}};return l$P.console=l$P.console||{log:function(){}},l$P.trace=l$P.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),l$B}(window,document);!function(l$i,l$_,l$R){l$R.un,l$R.uns,l$R.static,l$R.class,l$R.getset,l$R.__newvec}(window,document,Laya),function(l$L,l$_,l$A){l$A.un,l$A.uns;var l$x=l$A.static,l$B=l$A.class,l$h=l$A.getset;l$A.__newvec;l$A.interface("laya.runtime.IMarket"),l$A.interface("laya.filters.IFilter"),l$A.interface("laya.display.ILayout"),l$A.interface("laya.resource.IDispose"),l$A.interface("laya.runtime.IPlatform"),l$A.interface("laya.resource.IDestroy"),l$A.interface("laya.runtime.IConchNode"),l$A.interface("laya.filters.IFilterAction"),l$A.interface("laya.runtime.ICPlatformClass"),l$A.interface("laya.resource.ICreateResource"),l$A.interface("laya.runtime.IConchRenderObject"),l$A.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var l$$=function(){function l$z(){}return l$B(l$z,"laya.utils.RunDriver"),l$z.FILTER_ACTIONS=[],l$z.pixelRatio=-1,l$z._charSizeTestDiv=null,l$z.now=function(){return Date.now()},l$z.getWindow=function(){return l$L},l$z.getPixelRatio=function(){if(l$z.pixelRatio<0){var l$i=l$s.context,l$_=l$i.backingStorePixelRatio||l$i.webkitBackingStorePixelRatio||l$i.mozBackingStorePixelRatio||l$i.msBackingStorePixelRatio||l$i.oBackingStorePixelRatio||l$i.backingStorePixelRatio||1;(l$z.pixelRatio=(l$s.window.devicePixelRatio||1)/l$_)<1&&(l$z.pixelRatio=1)}return l$z.pixelRatio},l$z.getIncludeStr=function(l$i){return null},l$z.createShaderCondition=function(l$i){var l$_="(function() {return "+l$i+";})";return l$A._runScript(l$_)},l$z.fontMap=[],l$z.measureText=function(l$i,l$_){var l$R=l$z.hanzi.test(l$i);if(l$R&&l$z.fontMap[l$_])return l$z.fontMap[l$_];var l$r=l$s.context;l$r.font=l$_;var l$b=l$r.measureText(l$i);return l$b||(l$b={width:16,height:16}),l$R&&(l$z.fontMap[l$_]=l$b),l$b},l$z.getWebGLContext=function(l$i){},l$z.beginFlush=function(){},l$z.endFinish=function(){},l$z.addToAtlas=null,l$z.flashFlushImage=function(l$i){},l$z.drawToCanvas=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=l$Ii.create("2D"),l$w=new l$k(l$R,l$r,l$L);return l$K.renders[l$_]._fun(l$i,l$w,l$b,l$z),l$L},l$z.createParticleTemplate2D=null,l$z.createGLTextur=null,l$z.createWebGLContext2D=null,l$z.changeWebGLSize=function(l$i,l$_){},l$z.createRenderSprite=function(l$i,l$_){return new l$K(l$i,l$_)},l$z.createFilterAction=function(l$i){return new l$I},l$z.createGraphics=function(){return new l$f},l$z.clear=function(l$i){l$p._context.ctx.clear()},l$z.cancelLoadByUrl=function(l$i){},l$z.clearAtlas=function(l$i){},l$z.isAtlas=function(l$i){return!1},l$z.addTextureToAtlas=function(l$i){},l$z.getTexturePixels=function(l$i,l$_,l$R,l$r,l$b){return null},l$z.skinAniSprite=function(){return null},l$z.update3DLoop=function(){},l$x(l$z,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),l$z}(),l$r=(l$h(1,l$A,"alertGlobalError",null,function(l$i){var l$z=0;l$s.window.onerror=l$i?function(l$i,l$_,l$R,l$r,l$b){l$z++<5&&l$b&&alert(l$b.stack||l$b)}:null}),l$A.init=function(l$i,l$_,l$R){for(var l$r=[],l$b=2,l$z=arguments.length;l$b<l$z;l$b++)l$r.push(arguments[l$b]);if(!l$A._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=l$A._arrayBufferSlice),l$A._isinit=!0,l$s.__init__(),l$O.__init__(),l$f.__init__(),l$A.timer=new l$F,l$A.scaleTimer=new l$F,l$A.loader=new l$xi,l$W.__init__(),l$b=0;for(var l$L=l$r.length;l$b<l$L;l$b++)l$r[l$b].enable&&l$r[l$b].enable();return l$J.__init__(),l$w.__init__(),l$E.__init__(),l$C.beginCheck(),l$A._currentStage=l$A.stage=new l$Xi,l$A.stage.conchModel&&l$A.stage.conchModel.setRootNode(),l$A._getUrlPath(),l$A.render=new l$p(0,0),l$A.stage.size(l$i,l$_),l$K.__init__(),l$n.__init__(),l$M.instance.__init__(l$A.stage,l$p.canvas),l$ci.__init__(),l$v.autoStopMusic=!0,l$j.__init__(),l$p.canvas}},l$A._getUrlPath=function(){var l$i=l$s.window.location,l$_=l$i.pathname;l$_=l$_&&":"==l$_.charAt(2)?l$_.substring(1):l$_,l$o.rootPath=l$o.basePath=l$o.getPath("file:"==l$i.protocol?l$_:l$i.protocol+"//"+l$i.host+l$i.pathname)},l$A._arrayBufferSlice=function(l$i,l$_){var l$R=new Uint8Array(this,l$i,l$_-l$i),l$r=new Uint8Array(l$R.length);return l$r.set(l$R),l$r.buffer},l$A._runScript=function(l$i){return l$s.window[l$A._evcode](l$i)},l$A.stage=null,l$A.timer=null,l$A.scaleTimer=null,l$A.loader=null,l$A.version="1.8.6",l$A.render=null,l$A._currentStage=null,l$A._isinit=!1,l$A.isDebug=!1,l$A.MiniAdpter={init:function(){l$L.navigator&&l$L.navigator.userAgent&&-1<l$L.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},l$x(l$A,["conchMarket",function(){return this.conchMarket=l$L.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=l$L.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function l$i(){}return l$B(l$i,"Config"),l$i.WebGLTextCacheCount=500,l$i.atlasEnable=!1,l$i.showCanvasMark=!1,l$i.animationInterval=50,l$i.isAntialias=!1,l$i.isAlpha=!1,l$i.premultipliedAlpha=!0,l$i.isStencil=!0,l$i.preserveDrawingBuffer=!1,l$i}()),l$P=function(){function l$P(){this._events=null}l$B(l$P,"laya.events.EventDispatcher");var l$i=l$P.prototype;return l$i.hasListener=function(l$i){return!!(this._events&&this._events[l$i])},l$i.getListener=function(l$i){return this._events?this._events[l$i]:null},l$i.event=function(l$i,l$_){if(!this._events||!this._events[l$i])return!1;var l$R=this._events[l$i];if(l$R.lock)l$R.queue||(l$R.queue=[]),l$R.queue.push(l$_);else{var l$r;for(l$R.lock=!0,l$R.cursor=l$R.head;l$R.cursor;)(l$r=l$R.cursor).recover?(l$R.head=l$R.tail=l$R.cursor=null,console.error("node is recover："+l$r.id)):(l$R.cursor=l$r.next,l$r.once&&l$P.delNode(l$R,l$r),l$r.method&&(null!=l$_?l$r.args?l$r.method.apply(l$r.caller,l$r.args.concat(l$_)):l$_ instanceof Array?l$r.method.apply(l$r.caller,l$_):l$r.caller?l$r.method.call(l$r.caller,l$_):l$A.recordError("事件派发错误","node.caller:"+l$r.caller+"node.method:"+l$r.method+"data:"+l$_+"node.prev"+l$r.prev):l$r.method.apply(l$r.caller,l$r.args)),l$r.once&&l$P.recoverHandler(l$r));l$R.lock=!1,!l$R.head&&this._events&&this._events[l$i]==l$R&&delete this._events[l$i],l$R.queue&&l$R.queue.length&&this.event(l$i,l$R.queue.shift())}return!0},l$i.on=function(l$i,l$_,l$R,l$r){return this._createListener(l$i,l$_,l$R,l$r,!1)},l$i.once=function(l$i,l$_,l$R,l$r){return this._createListener(l$i,l$_,l$R,l$r,!0)},l$i._createListener=function(l$i,l$_,l$R,l$r,l$b,l$z){void 0===l$z&&(l$z=!0),l$z&&this.off(l$i,l$_,l$R,l$b);var l$L=l$P.createHandler(l$_||this,l$R,l$r,l$b);this._events||(this._events={});var l$w=this._events,l$x=l$w[l$i];return l$x?l$x.tail?(l$L.prev=l$x.tail,l$x.tail.next=l$L,l$x.tail=l$L):l$x.head=l$x.tail=l$L:l$w[l$i]={head:l$L,tail:l$L,cursor:null,lock:!1},this},l$i.off=function(l$i,l$_,l$R,l$r){if(void 0===l$r&&(l$r=!1),!this._events||!this._events[l$i])return this;for(var l$b=this._events[l$i],l$z=l$b.head;l$z;){if((!l$_||l$z.caller===l$_)&&l$z.method===l$R&&(!l$r||l$z.once)){l$P.delNode(l$b,l$z),l$b.cursor==l$z&&(l$b.cursor=l$z.next),l$P.recoverHandler(l$z);break}l$z=l$z.next}return this},l$i.offAll=function(l$i){var l$_=this._events;if(!l$_)return this;if(l$i)this._recoverHandlers(l$_[l$i]),delete l$_[l$i];else{for(var l$R in l$_)this._recoverHandlers(l$_[l$R]);this._events=null}return this},l$i._recoverHandlers=function(l$i){if(l$i){for(var l$_=l$i.head;l$_;){l$P.delNode(l$i,l$_);var l$R=l$_.next;l$P.recoverHandler(l$_),l$_=l$R}l$i.cursor=null}},l$i.isMouseEvent=function(l$i){return l$P.MOUSE_EVENTS[l$i]},l$P.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},l$P.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},l$P.delNode=function(l$i,l$_){l$_.prev?l$_.prev.next=l$_.next:l$i.head=l$_.next,l$_.next?l$_.next.prev=l$_.prev:l$i.tail=l$_.prev},l$P.createHandler=function(l$i,l$_,l$R,l$r){var l$b=500<l$P._freeHandler.length?l$P._freeHandler.shift():null;if(l$b)if(l$b.recover)l$b.recover=!1,l$b.caller=l$i,l$b.method=l$_,l$b.args=l$R,l$b.once=l$r;else{var l$z="";try{arguments.propertyIsEnumerable.caller}catch(l$i){l$z=l$i.stack}var l$L=l$b.caller?(l$b.caller.__proto__&&l$b.caller.__proto__.constructor&&l$b.caller.__proto__.constructor.name)+"|"+l$b.caller.__className+"|"+l$b.caller.name:"",l$w=l$b.method?l$b.method.name:"";l$A.recordError("EventDispatcher重复创建","caller="+l$L+"  method="+l$w+"  stack="+l$z),l$b={id:++l$P._nodeCount,caller:l$i,method:l$_,args:l$R,once:l$r,recover:!1}}else l$b={id:++l$P._nodeCount,caller:l$i,method:l$_,args:l$R,once:l$r,recover:!1};return l$b.prev=l$b.next=null,l$b},l$P.recoverHandler=function(l$i){if(l$i.recover){if(l$P._errorCount<5){l$P._errorCount++;var l$_="";try{arguments.propertyIsEnumerable.caller}catch(l$i){l$_=l$i.stack}var l$R=l$i.caller?(l$i.caller.__proto__&&l$i.caller.__proto__.constructor&&l$i.caller.__proto__.constructor.name)+"|"+l$i.caller.__className+"|"+l$i.caller.name:"",l$r=l$i.method?l$i.method.name:"";l$A.recordError("EventDispatcher重复回收","id="+l$i.id+"  caller="+l$R+"  method="+l$r+"  stack="+l$_)}l$i.caller=l$i.method=l$i.args=l$i.prev=null}else l$i.recover=!0,l$i.caller=l$i.method=l$i.args=l$i.prev=l$i.next=null,l$P._freeHandler&&l$P._freeHandler.length<3e3&&l$P._freeHandler.push(l$i)},l$P._freeHandler=[],l$P._nodeCount=0,l$P._errorCount=0,l$P}(),l$t=function(){function l$b(l$i,l$_,l$R,l$r){this.once=!1,void(this._id=0)===l$r&&(l$r=!1),this.setTo(l$i,l$_,l$R,l$r)}l$B(l$b,"laya.utils.Handler");var l$i=l$b.prototype;return l$i.setTo=function(l$i,l$_,l$R,l$r){return this._id=l$b._gid++,this.caller=l$i,this.method=l$_,this.args=l$R,this.once=l$r,this},l$i.run=function(){if(null==this.method)return null;var l$i=this._id,l$_=this.method.apply(this.caller,this.args);return this._id===l$i&&this.once&&this.recover(),l$_},l$i.runWith=function(l$i){if(null==this.method)return null;var l$_=this._id;if(null==l$i)var l$R=this.method.apply(this.caller,this.args);else l$R=this.args||l$i.unshift?this.args?this.method.apply(this.caller,this.args.concat(l$i)):this.method.apply(this.caller,l$i):this.method.call(this.caller,l$i);return this._id===l$_&&this.once&&this.recover(),l$R},l$i.clear=function(){return this.caller=null,this.method=null,this.args=null,this},l$i.recover=function(){0<this._id&&(this._id=0,this.clear())},l$b.create=function(l$i,l$_,l$R,l$r){return void 0===l$r&&(l$r=!0),new l$b(l$i,l$_,l$R,l$r)},l$b._gid=1,l$b}(),l$S=function(){function l$i(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}l$B(l$i,"laya.display.BitmapFont");var l$_=l$i.prototype;return l$_.loadFont=function(l$i,l$_){this._path=l$i,this._complete=l$_,l$A.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],l$t.create(this,this.onLoaded))},l$_.onLoaded=function(){this.parseFont(l$wi.getRes(this._path),l$wi.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},l$_.parseFont=function(l$i,l$_){if(null!=l$i&&null!=l$_){this._texture=l$_;var l$R=l$i.getElementsByTagName("info");if(!l$R[0].getAttributeNode)return this.parseFont2(l$i,l$_);this.fontSize=parseInt(l$R[0].getAttributeNode("size").nodeValue);var l$r,l$b=l$R[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(l$b[0]),parseInt(l$b[1]),parseInt(l$b[2]),parseInt(l$b[3])],l$r=l$i.getElementsByTagName("char");var l$z=0;for(l$z=0;l$z<l$r.length;l$z++){var l$L=l$r[l$z],l$w=parseInt(l$L.getAttributeNode("id").nodeValue),l$x=parseInt(l$L.getAttributeNode("xoffset").nodeValue)/1,l$P=parseInt(l$L.getAttributeNode("yoffset").nodeValue)/1,l$B=parseInt(l$L.getAttributeNode("xadvance").nodeValue)/1,l$n=new l$q;l$n.x=parseInt(l$L.getAttributeNode("x").nodeValue),l$n.y=parseInt(l$L.getAttributeNode("y").nodeValue),l$n.width=parseInt(l$L.getAttributeNode("width").nodeValue),l$n.height=parseInt(l$L.getAttributeNode("height").nodeValue);var l$f=l$Bi.create(l$_,l$n.x,l$n.y,l$n.width,l$n.height,l$x,l$P);this._maxWidth=Math.max(this._maxWidth,l$B+this.letterSpacing),this._fontCharDic[l$w]=l$f,this._fontWidthMap[l$w]=l$B}}},l$_.parseFont2=function(l$i,l$_){if(null!=l$i&&null!=l$_){this._texture=l$_;var l$R=l$i.getElementsByTagName("info");this.fontSize=parseInt(l$R[0].attributes.size.nodeValue);var l$r=l$R[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(l$r[0]),parseInt(l$r[1]),parseInt(l$r[2]),parseInt(l$r[3])];var l$b=l$i.getElementsByTagName("char"),l$z=0;for(l$z=0;l$z<l$b.length;l$z++){var l$L=l$b[l$z].attributes,l$w=parseInt(l$L.id.nodeValue),l$x=parseInt(l$L.xoffset.nodeValue)/1,l$P=parseInt(l$L.yoffset.nodeValue)/1,l$B=parseInt(l$L.xadvance.nodeValue)/1,l$n=new l$q;l$n.x=parseInt(l$L.x.nodeValue),l$n.y=parseInt(l$L.y.nodeValue),l$n.width=parseInt(l$L.width.nodeValue),l$n.height=parseInt(l$L.height.nodeValue);var l$f=l$Bi.create(l$_,l$n.x,l$n.y,l$n.width,l$n.height,l$x,l$P);this._maxWidth=Math.max(this._maxWidth,l$B+this.letterSpacing),this._fontCharDic[l$w]=l$f,this._fontWidthMap[l$w]=l$B}}},l$_.getCharTexture=function(l$i){return this._fontCharDic[l$i.charCodeAt(0)]},l$_.destroy=function(){if(this._texture){for(var l$i in this._fontCharDic){var l$_=this._fontCharDic[l$i];l$_&&l$_.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},l$_.setSpaceWidth=function(l$i){this._spaceWidth=l$i},l$_.getCharWidth=function(l$i){var l$_=l$i.charCodeAt(0);return this._fontWidthMap[l$_]?this._fontWidthMap[l$_]+this.letterSpacing:" "==l$i?this._spaceWidth+this.letterSpacing:0},l$_.getTextWidth=function(l$i){for(var l$_=0,l$R=0,l$r=l$i.length;l$R<l$r;l$R++)l$_+=this.getCharWidth(l$i.charAt(l$R));return l$_},l$_.getMaxWidth=function(){return this._maxWidth},l$_.getMaxHeight=function(){return this.fontSize},l$_.drawText=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L,l$w=this.getTextWidth(l$i),l$x=0;"center"===l$b&&(l$x=(l$z-l$w)/2),"right"===l$b&&(l$x=l$z-l$w);for(var l$P=0,l$B=0,l$n=l$i.length;l$B<l$n;l$B++)(l$L=this.getCharTexture(l$i.charAt(l$B)))&&(l$_.graphics.drawTexture(l$L,l$R+l$P+l$x,l$r),l$P+=this.getCharWidth(l$i.charAt(l$B)))},l$i}(),l$w=function(){function l$R(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=l$R._TF_EMPTY}l$B(l$R,"laya.display.css.Style");var l$i=l$R.prototype;return l$i.getTransform=function(){return this._tf},l$i.setTransform=function(l$i){this._tf="none"!==l$i&&l$i?l$i:l$R._TF_EMPTY},l$i.setTranslateX=function(l$i){this._tf===l$R._TF_EMPTY&&(this._tf=new l$b),this._tf.translateX=l$i},l$i.setTranslateY=function(l$i){this._tf===l$R._TF_EMPTY&&(this._tf=new l$b),this._tf.translateY=l$i},l$i.setScaleX=function(l$i){this._tf===l$R._TF_EMPTY&&(this._tf=new l$b),this._tf.scaleX=l$i},l$i.setScale=function(l$i,l$_){this._tf===l$R._TF_EMPTY&&(this._tf=new l$b),this._tf.scaleX=l$i,this._tf.scaleY=l$_},l$i.setScaleY=function(l$i){this._tf===l$R._TF_EMPTY&&(this._tf=new l$b),this._tf.scaleY=l$i},l$i.setRotate=function(l$i){this._tf===l$R._TF_EMPTY&&(this._tf=new l$b),this._tf.rotate=l$i},l$i.setSkewX=function(l$i){this._tf===l$R._TF_EMPTY&&(this._tf=new l$b),this._tf.skewX=l$i},l$i.setSkewY=function(l$i){this._tf===l$R._TF_EMPTY&&(this._tf=new l$b),this._tf.skewY=l$i},l$i.destroy=function(){this.scrollRect=null},l$i.render=function(l$i,l$_,l$R,l$r){},l$i.getCSSStyle=function(){return l$_i.EMPTY},l$i._enableLayout=function(){return!1},l$h(0,l$i,"scaleX",function(){return this._tf.scaleX},function(l$i){this.setScaleX(l$i)}),l$h(0,l$i,"transform",function(){return this.getTransform()},function(l$i){this.setTransform(l$i)}),l$h(0,l$i,"translateX",function(){return this._tf.translateX},function(l$i){this.setTranslateX(l$i)}),l$h(0,l$i,"translateY",function(){return this._tf.translateY},function(l$i){this.setTranslateY(l$i)}),l$h(0,l$i,"scaleY",function(){return this._tf.scaleY},function(l$i){this.setScaleY(l$i)}),l$h(0,l$i,"block",function(){return 0!=(1&this._type)}),l$h(0,l$i,"skewY",function(){return this._tf.skewY},function(l$i){this.setSkewY(l$i)}),l$h(0,l$i,"rotate",function(){return this._tf.rotate},function(l$i){this.setRotate(l$i)}),l$h(0,l$i,"skewX",function(){return this._tf.skewX},function(l$i){this.setSkewX(l$i)}),l$h(0,l$i,"paddingLeft",function(){return 0}),l$h(0,l$i,"paddingTop",function(){return 0}),l$h(0,l$i,"absolute",function(){return!0}),l$R.__init__=function(){l$R._TF_EMPTY=new l$b,l$R.EMPTY=new l$R},l$R.EMPTY=null,l$R._TF_EMPTY=null,l$R}(),l$J=function(){function l$_(l$i){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=l$D.create(l$_.defaultColor),this.family=l$_.defaultFamily,this.stroke=l$_._STROKE,this.size=l$_.defaultSize,l$i&&l$i!==l$_.EMPTY&&l$i.copyTo(this)}l$B(l$_,"laya.display.css.Font");var l$i=l$_.prototype;return l$i.set=function(l$i){this._text=null;for(var l$_=l$i.split(" "),l$R=0,l$r=l$_.length;l$R<l$r;l$R++){var l$b=l$_[l$R];switch(l$b){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<l$b.indexOf("px")&&(this.size=parseInt(l$b),this.family=l$_[l$R+1],l$R++)}},l$i.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},l$i.copyTo=function(l$i){l$i._type=this._type,l$i._text=this._text,l$i._weight=this._weight,l$i._color=this._color,l$i.family=this.family,l$i.stroke=this.stroke!=l$_._STROKE?this.stroke.slice():l$_._STROKE,l$i.indent=this.indent,l$i.size=this.size},l$h(0,l$i,"password",function(){return 0!=(1024&this._type)},function(l$i){l$i?this._type|=1024:this._type&=-1025}),l$h(0,l$i,"color",function(){return this._color.strColor},function(l$i){this._color=l$D.create(l$i)}),l$h(0,l$i,"italic",function(){return 0!=(512&this._type)},function(l$i){l$i?this._type|=512:this._type&=-513}),l$h(0,l$i,"bold",function(){return 0!=(2048&this._type)},function(l$i){l$i?this._type|=2048:this._type&=-2049}),l$h(0,l$i,"weight",function(){return""+this._weight},function(l$i){var l$_=0;switch(l$i){case"normal":break;case"bold":this.bold=!0,l$_=700;break;case"bolder":l$_=800;break;case"lighter":l$_=100;break;default:l$_=parseInt(l$i)}this._weight=l$_,this._text=null}),l$h(0,l$i,"decoration",function(){return this._decoration?this._decoration.value:null},function(l$i){var l$_=l$i.split(" ");switch(this._decoration||(this._decoration={}),l$_[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=l$_[0]}l$_[1]&&(this._decoration.color=l$D.create(l$_)),this._decoration.value=l$i}),l$_.__init__=function(){l$_.EMPTY=new l$_(null)},l$_.EMPTY=null,l$_.defaultColor="#000000",l$_.defaultSize=12,l$_.defaultFamily="Arial",l$_.defaultFont="12px Arial",l$_._STROKE=[0,"#000000"],l$_._ITALIC=512,l$_._PASSWORD=1024,l$_._BOLD=2048,l$_}(),l$b=function(){function l$i(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return l$B(l$i,"laya.display.css.TransformInfo"),l$i}(),l$f=function(){function l$n(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,l$p.isConchNode){this._nativeObj=new l$L._conchGraphics,this.id=this._nativeObj.conchID}}l$B(l$n,"laya.display.Graphics");var l$i=l$n.prototype;return l$i.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},l$i.clear=function(l$i){void 0===l$i&&(l$i=!1);var l$_=0,l$R=0;if(l$i){var l$r=this._one;if(this._cmds){for(l$R=this._cmds.length,l$_=0;l$_<l$R;l$_++)!(l$r=this._cmds[l$_])||l$r.callee!==l$p._context._drawTexture&&l$r.callee!==l$p._context._drawTextureWithTransform||(l$r[0]=null,l$n._cache.push(l$r));this._cmds.length=0}else l$r&&(!l$r||l$r.callee!==l$p._context._drawTexture&&l$r.callee!==l$p._context._drawTextureWithTransform||(l$r[0]=null,l$n._cache.push(l$r)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(l$_=0,l$R=this._vectorgraphArray.length;l$_<l$R;l$_++)l$H.getInstance().deleteShape(this._vectorgraphArray[l$_]);this._vectorgraphArray.length=0}},l$i._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},l$i._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new l$R,this._graphicBounds._graphics=this)},l$i._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},l$i._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},l$i.getBounds=function(l$i){return void 0===l$i&&(l$i=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(l$i)},l$i.getBoundPoints=function(l$i){return void 0===l$i&&(l$i=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(l$i)},l$i._addCmd=function(l$i){this._cmds=this._cmds||[],l$i.callee=l$i.shift(),this._cmds.push(l$i)},l$i.setFilters=function(l$i){this._saveToCmd(l$p._context._setFilters,l$i)},l$i.drawTexture=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){if(void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=0),void 0===l$b&&(l$b=0),void 0===l$L&&(l$L=1),!l$i||l$L<.01)return null;l$r||(l$r=l$i.sourceWidth),l$b||(l$b=l$i.sourceHeight),l$L=l$L<0?0:1<l$L?1:l$L;var l$w,l$x=!l$p.isWebGL&&(l$s.onFirefox||l$s.onEdge||l$s.onIE||l$s.onSafari)?.5:0,l$P=l$r/l$i.sourceWidth,l$B=l$b/l$i.sourceHeight;return l$r=l$i.width*l$P,l$b=l$i.height*l$B,l$i.loaded&&(l$r<=0||l$b<=0)?null:(l$_+=l$i.offsetX*l$P,l$R+=l$i.offsetY*l$B,this._sp&&(this._sp._renderType|=512),l$_-=l$x,l$R-=l$x,l$r+=2*l$x,l$b+=2*l$x,l$n._cache.length?((l$w=l$n._cache.pop())[0]=l$i,l$w[1]=l$_,l$w[2]=l$R,l$w[3]=l$r,l$w[4]=l$b,l$w[5]=l$z,l$w[6]=l$L):l$w=[l$i,l$_,l$R,l$r,l$b,l$z,l$L],l$w.callee=l$z||1!=l$L?l$p._context._drawTextureWithTransform:l$p._context._drawTexture,null!=this._one||l$z||1!=l$L?this._saveToCmd(l$w.callee,l$w):(this._one=l$w,this._render=this._renderOneImg),l$i.loaded||l$i.once("loaded",this,this._textureLoaded,[l$i,l$w]),this._repaint(),l$w)},l$i.cleanByTexture=function(l$i,l$_,l$R,l$r,l$b){if(void 0===l$r&&(l$r=0),void 0===l$b&&(l$b=0),!l$i)return this.clear();if(this._one&&this._render===this._renderOneImg){l$r||(l$r=l$i.sourceWidth),l$b||(l$b=l$i.sourceHeight);var l$z=l$r/l$i.sourceWidth,l$L=l$b/l$i.sourceHeight;l$r=l$i.width*l$z,l$b=l$i.height*l$L,l$_+=l$i.offsetX*l$z,l$R+=l$i.offsetY*l$L,this._one[0]=l$i,this._one[1]=l$_,this._one[2]=l$R,this._one[3]=l$r,this._one[4]=l$b,this._repaint()}else this.clear(),l$i&&this.drawTexture(l$i,l$_,l$R,l$r,l$b)},l$i.drawTextures=function(l$i,l$_){l$i&&this._saveToCmd(l$p._context._drawTextures,[l$i,l$_])},l$i.fillTexture=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){if(void 0===l$r&&(l$r=0),void 0===l$b&&(l$b=0),void 0===l$z&&(l$z="repeat"),l$i){var l$w=[l$i,l$_,l$R,l$r,l$b,l$z,l$L||l$Z.EMPTY,{}];l$i.loaded||l$i.once("loaded",this,this._textureLoaded,[l$i,l$w]),this._saveToCmd(l$p._context._fillTexture,l$w)}},l$i._textureLoaded=function(l$i,l$_){l$_[3]=l$_[3]||l$i.width,l$_[4]=l$_[4]||l$i.height,this._repaint()},l$i.fillCircle=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){l$R.bitmap.enableMerageInAtlas=!1;var l$w=new Float32Array(2*(l$L+1)),l$x=new Float32Array(2*(l$L+1)),l$P=new Uint16Array(3*l$L),l$B=2*Math.PI/l$L,l$n=0;l$w[0]=l$r,l$w[1]=l$b,l$x[0]=l$r/l$R.width,l$x[1]=l$b/l$R.height;for(var l$f=2,l$J=0;l$J<l$L;l$J++){var l$h=l$z*Math.cos(l$n)+l$r,l$M=l$z*Math.sin(l$n)+l$b;l$w[l$f]=l$h,l$w[l$f+1]=l$M,l$x[l$f]=l$h/l$R.width,l$x[l$f+1]=l$M/l$R.height,l$n+=l$B,l$f+=2}for(l$J=l$f=0;l$J<l$L;l$J++)l$P[l$f++]=0,l$P[l$f++]=l$J+1,l$P[l$f++]=l$L+1<=l$J+2?1:l$J+2;this.drawTriangles(l$R,l$i,l$_,l$w,l$x,l$P)},l$i.drawTriangles=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){void 0===l$w&&(l$w=1),this._saveToCmd(l$p._context.drawTriangles,[l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P])},l$i._saveToCmd=function(l$i,l$_){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=l$_,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(l$_)),l$_.callee=l$i,this._repaint(),l$_},l$i.clipRect=function(l$i,l$_,l$R,l$r){this._saveToCmd(l$p._context._clipRect,[l$i,l$_,l$R,l$r])},l$i.fillText=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){void 0===l$L&&(l$L=0),this._saveToCmd(l$p._context._fillText,[l$i,l$_,l$R,l$r||l$J.defaultFont,l$b,l$z])},l$i.fillBorderText=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){this._saveToCmd(l$p._context._fillBorderText,[l$i,l$_,l$R,l$r||l$J.defaultFont,l$b,l$z,l$L,l$w])},l$i.strokeText=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this._saveToCmd(l$p._context._strokeText,[l$i,l$_,l$R,l$r||l$J.defaultFont,l$b,l$z,l$L])},l$i.alpha=function(l$i){l$i=l$i<0?0:1<l$i?1:l$i,this._saveToCmd(l$p._context._alpha,[l$i])},l$i.setAlpha=function(l$i){l$i=l$i<0?0:1<l$i?1:l$i,this._saveToCmd(l$p._context._setAlpha,[l$i])},l$i.transform=function(l$i,l$_,l$R){void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),this._saveToCmd(l$p._context._transform,[l$i,l$_,l$R])},l$i.rotate=function(l$i,l$_,l$R){void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),this._saveToCmd(l$p._context._rotate,[l$i,l$_,l$R])},l$i.scale=function(l$i,l$_,l$R,l$r){void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=0),this._saveToCmd(l$p._context._scale,[l$i,l$_,l$R,l$r])},l$i.translate=function(l$i,l$_){this._saveToCmd(l$p._context._translate,[l$i,l$_])},l$i.save=function(){this._saveToCmd(l$p._context._save,[])},l$i.restore=function(){this._saveToCmd(l$p._context._restore,[])},l$i.replaceText=function(l$i){this._repaint();var l$_=this._cmds;if(l$_){for(var l$R=l$_.length-1;-1<l$R;l$R--)if(this._isTextCmd(l$_[l$R].callee))return l$_[l$R][0].toUpperCase?l$_[l$R][0]=l$i:l$_[l$R][0].setText(l$i),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=l$i:this._one[0].setText(l$i),!0;return!1},l$i._isTextCmd=function(l$i){return l$i===l$p._context._fillText||l$i===l$p._context._fillBorderText||l$i===l$p._context._strokeText},l$i.replaceTextColor=function(l$i){this._repaint();var l$_=this._cmds;if(l$_)for(var l$R=l$_.length-1;-1<l$R;l$R--)this._isTextCmd(l$_[l$R].callee)&&(l$_[l$R][4]=l$i,l$_[l$R][0].toUpperCase||(l$_[l$R][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=l$i,this._one[0].toUpperCase||(this._one[0].changed=!0))},l$i.loadImage=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=this;void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=0),void 0===l$b&&(l$b=0);var l$w=l$wi.getRes(l$i);function l$x(l$i){l$i&&(l$L.drawTexture(l$i,l$_,l$R,l$r,l$b),null!=l$z&&l$z.call(l$L._sp,l$i))}l$w?l$x(l$w):l$A.loader.load(l$i,l$t.create(null,l$x),null,"image")},l$i._renderEmpty=function(l$i,l$_,l$R,l$r){},l$i._renderAll=function(l$i,l$_,l$R,l$r){for(var l$b,l$z=this._cmds,l$L=0,l$w=l$z.length;l$L<l$w;l$L++)(l$b=l$z[l$L]).callee.call(l$_,l$R,l$r,l$b)},l$i._renderOne=function(l$i,l$_,l$R,l$r){this._one.callee.call(l$_,l$R,l$r,this._one)},l$i._renderOneImg=function(l$i,l$_,l$R,l$r){this._one.callee.call(l$_,l$R,l$r,this._one),2305!==l$i._renderType&&(l$i._renderType|=1)},l$i.drawLine=function(l$i,l$_,l$R,l$r,l$b,l$z){void 0===l$z&&(l$z=1);var l$L=0;l$p.isWebGL&&(l$L=l$H.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(l$L));var l$w=l$z%2==0?0:.5,l$x=[l$i+l$w,l$_+l$w,l$R+l$w,l$r+l$w,l$b,l$z,l$L];this._saveToCmd(l$p._context._drawLine,l$x)},l$i.drawLines=function(l$i,l$_,l$R,l$r,l$b){void 0===l$b&&(l$b=1);var l$z=0;if(l$R&&!(l$R.length<4)){l$p.isWebGL&&(l$z=l$H.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(l$z));var l$L=l$b%2==0?0:.5,l$w=[l$i+l$L,l$_+l$L,l$R,l$r,l$b,l$z];this._saveToCmd(l$p._context._drawLines,l$w)}},l$i.drawCurves=function(l$i,l$_,l$R,l$r,l$b){void 0===l$b&&(l$b=1);var l$z=[l$i,l$_,l$R,l$r,l$b];this._saveToCmd(l$p._context._drawCurves,l$z)},l$i.drawRect=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){void 0===l$L&&(l$L=1);var l$w=l$z?l$L/2:0,l$x=l$z?l$L:0,l$P=[l$i+l$w,l$_+l$w,l$R-l$x,l$r-l$x,l$b,l$z,l$L];this._saveToCmd(l$p._context._drawRect,l$P)},l$i.drawCircle=function(l$i,l$_,l$R,l$r,l$b,l$z){void 0===l$z&&(l$z=1);var l$L=l$b?l$z/2:0,l$w=0;l$p.isWebGL&&(l$w=l$H.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(l$w));var l$x=[l$i,l$_,l$R-l$L,l$r,l$b,l$z,l$w];this._saveToCmd(l$p._context._drawCircle,l$x)},l$i.drawPie=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){void 0===l$w&&(l$w=1);var l$x=l$L?l$w/2:0,l$P=l$L?l$w:0,l$B=0;l$p.isWebGL&&(l$B=l$H.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(l$B));var l$n=[l$i+l$x,l$_+l$x,l$R-l$P,l$r,l$b,l$z,l$L,l$w,l$B];l$n[3]=l$Q.toRadian(l$r),l$n[4]=l$Q.toRadian(l$b),this._saveToCmd(l$p._context._drawPie,l$n)},l$i.drawPoly=function(l$i,l$_,l$R,l$r,l$b,l$z){void 0===l$z&&(l$z=1);var l$L=0,l$w=!1;l$p.isWebGL&&(l$L=l$H.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(l$L),l$w=!(6<l$R.length));var l$x=l$b?l$z%2==0?0:.5:0,l$P=[l$i+l$x,l$_+l$x,l$R,l$r,l$b,l$z,l$L,l$w];this._saveToCmd(l$p._context._drawPoly,l$P)},l$i.drawPath=function(l$i,l$_,l$R,l$r,l$b){var l$z=[l$i,l$_,l$R,l$r,l$b];this._saveToCmd(l$p._context._drawPath,l$z)},l$h(0,l$i,"cmds",function(){return this._cmds},function(l$i){this._sp&&(this._sp._renderType|=512),this._cmds=l$i,this._render=this._renderAll,this._repaint()}),l$n.__init__=function(){if(l$p.isConchNode){for(var l$i=laya.display.Graphics.prototype,l$_=l$s.window.ConchGraphics.prototype,l$R=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],l$r=0,l$b=l$R.length;l$r<=l$b;l$r++){var l$z=l$R[l$r];l$i[l$z]=l$_[l$z]}l$i._saveToCmd=null,l$_.drawImageS&&(l$i.drawTextures=function(l$i,l$_){if(l$i&&l$i.loaded&&l$i.bitmap&&l$i.source){var l$R=l$i.uv,l$r=l$i.bitmap.width,l$b=l$i.bitmap.height;this.drawImageS(l$i.bitmap.source,l$R[0]*l$r,l$R[1]*l$b,(l$R[2]-l$R[0])*l$r,(l$R[5]-l$R[3])*l$b,l$i.offsetX,l$i.offsetY,l$i.width,l$i.height,l$_)}}),l$i.drawTexture=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){if(void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=0),void 0===l$b&&(l$b=0),void 0===l$L&&(l$L=1),l$i)if(l$i.loaded){if(l$i.loaded&&l$i.bitmap&&l$i.source&&(l$r||(l$r=l$i.sourceWidth),l$b||(l$b=l$i.sourceHeight),l$L=l$L<0?0:1<l$L?1:l$L,l$r=l$r-l$i.sourceWidth+l$i.width,l$b=l$b-l$i.sourceHeight+l$i.height,!(l$r<=0||l$b<=0))){l$_+=l$i.offsetX,l$R+=l$i.offsetY;var l$w=l$i.uv,l$x=l$i.bitmap.width,l$P=l$i.bitmap.height;l$w[4]<l$w[0]&&l$w[5]<l$w[1]?this.drawImageM(l$i.bitmap.source,l$w[4]*l$x,l$w[5]*l$P,(l$w[0]-l$w[4])*l$x,(l$w[1]-l$w[5])*l$P,l$_,l$R,l$r,l$b,l$z,l$L):this.drawImageM(l$i.bitmap.source,l$w[0]*l$x,l$w[1]*l$P,(l$w[2]-l$w[0])*l$x,(l$w[5]-l$w[3])*l$P,l$_,l$R,l$r,l$b,l$z,l$L),this._repaint()}}else l$i.once("loaded",this,function(){this.drawTexture(l$i,l$_,l$R,l$r,l$b,l$z)})},l$i.fillTexture=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){if(void 0===l$r&&(l$r=0),void 0===l$b&&(l$b=0),void 0===l$z&&(l$z="repeat"),l$i&&l$i.loaded){var l$w,l$x=l$p._context.ctx,l$P=l$i.bitmap.width,l$B=l$i.bitmap.height,l$n=l$i.uv;l$w=l$i.uv!=l$Bi.DEF_UV?l$x.createPattern(l$i.bitmap.source,l$z,l$n[0]*l$P,l$n[1]*l$B,(l$n[2]-l$n[0])*l$P,(l$n[5]-l$n[3])*l$B):l$x.createPattern(l$i.bitmap.source,l$z);var l$f=0,l$J=0;l$L&&(l$_+=l$L.x%l$i.width,l$R+=l$L.y%l$i.height,l$f-=l$L.x%l$i.width,l$J-=l$L.y%l$i.height),this._fillImage(l$w,l$_,l$R,l$f,l$J,l$r,l$b)}}}},l$n._cache=[],l$n}(),l$R=function(){function l$I(){this._cacheBoundsType=!1}l$B(l$I,"laya.display.GraphicsBounds");var l$i=l$I.prototype;return l$i.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},l$i.reset=function(){this._temp&&(this._temp.length=0)},l$i.getBounds=function(l$i){return void 0===l$i&&(l$i=!1),(!this._bounds||!this._temp||this._temp.length<1||l$i!=this._cacheBoundsType)&&(this._bounds=l$q._getWrapRec(this.getBoundPoints(l$i),this._bounds)),this._cacheBoundsType=l$i,this._bounds},l$i.getBoundPoints=function(l$i){return void 0===l$i&&(l$i=!1),(!this._temp||this._temp.length<1||l$i!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(l$i)),this._cacheBoundsType=l$i,this._rstBoundPoints=l$Q.copyArray(this._rstBoundPoints,this._temp)},l$i._getCmdPoints=function(l$i){void 0===l$i&&(l$i=!1);var l$_,l$R,l$r=l$p._context,l$b=this._graphics.cmds;if((l$_=this._temp||(this._temp=[])).length=0,l$b||null==this._graphics._one||(l$I._tempCmds.length=0,l$I._tempCmds.push(this._graphics._one),l$b=l$I._tempCmds),!l$b)return l$_;(l$R=l$I._tempMatrixArrays).length=0;var l$z=l$I._initMatrix;l$z.identity();for(var l$L,l$w,l$x=l$I._tempMatrix,l$P=NaN,l$B=NaN,l$n=NaN,l$f=NaN,l$J=NaN,l$h=NaN,l$M=0,l$N=l$b.length;l$M<l$N;l$M++)if((l$L=l$b[l$M]).callee)switch(l$L.callee){case l$r._save:case 7:l$R.push(l$z),l$z=l$z.clone();break;case l$r._restore:case 8:l$z=l$R.pop();break;case l$r._scale:case 5:l$x.identity(),l$x.translate(-l$L[2],-l$L[3]),l$x.scale(l$L[0],l$L[1]),l$x.translate(l$L[2],l$L[3]),this._switchMatrix(l$z,l$x);break;case l$r._rotate:case 3:l$x.identity(),l$x.translate(-l$L[1],-l$L[2]),l$x.rotate(l$L[0]),l$x.translate(l$L[1],l$L[2]),this._switchMatrix(l$z,l$x);break;case l$r._translate:case 6:l$x.identity(),l$x.translate(l$L[0],l$L[1]),this._switchMatrix(l$z,l$x);break;case l$r._transform:case 4:l$x.identity(),l$x.translate(-l$L[1],-l$L[2]),l$x.concat(l$L[0]),l$x.translate(l$L[1],l$L[2]),this._switchMatrix(l$z,l$x);break;case 16:case 24:l$I._addPointArrToRst(l$_,l$q._getBoundPointS(l$L[0],l$L[1],l$L[2],l$L[3]),l$z);break;case 17:l$z.copyTo(l$x),l$x.concat(l$L[4]),l$I._addPointArrToRst(l$_,l$q._getBoundPointS(l$L[0],l$L[1],l$L[2],l$L[3]),l$x);break;case l$r._drawTexture:l$w=l$L[0],l$i?l$L[3]&&l$L[4]?l$I._addPointArrToRst(l$_,l$q._getBoundPointS(l$L[1],l$L[2],l$L[3],l$L[4]),l$z):(l$w=l$L[0],l$I._addPointArrToRst(l$_,l$q._getBoundPointS(l$L[1],l$L[2],l$w.width,l$w.height),l$z)):(l$P=(l$L[3]||l$w.sourceWidth)/l$w.width,l$B=(l$L[4]||l$w.sourceHeight)/l$w.height,l$n=l$P*l$w.sourceWidth,l$f=l$B*l$w.sourceHeight,l$J=0<l$w.offsetX?l$w.offsetX:0,l$h=0<l$w.offsetY?l$w.offsetY:0,l$J*=l$P,l$h*=l$B,l$I._addPointArrToRst(l$_,l$q._getBoundPointS(l$L[1]-l$J,l$L[2]-l$h,l$n,l$f),l$z));break;case l$r._fillTexture:l$L[3]&&l$L[4]?l$I._addPointArrToRst(l$_,l$q._getBoundPointS(l$L[1],l$L[2],l$L[3],l$L[4]),l$z):(l$w=l$L[0],l$I._addPointArrToRst(l$_,l$q._getBoundPointS(l$L[1],l$L[2],l$w.width,l$w.height),l$z));break;case l$r._drawTextureWithTransform:var l$X;l$X=l$L[5]?(l$z.copyTo(l$x),l$x.concat(l$L[5]),l$x):l$z,l$i?l$L[3]&&l$L[4]?l$I._addPointArrToRst(l$_,l$q._getBoundPointS(l$L[1],l$L[2],l$L[3],l$L[4]),l$X):(l$w=l$L[0],l$I._addPointArrToRst(l$_,l$q._getBoundPointS(l$L[1],l$L[2],l$w.width,l$w.height),l$X)):(l$w=l$L[0],l$P=(l$L[3]||l$w.sourceWidth)/l$w.width,l$B=(l$L[4]||l$w.sourceHeight)/l$w.height,l$n=l$P*l$w.sourceWidth,l$f=l$B*l$w.sourceHeight,l$J=0<l$w.offsetX?l$w.offsetX:0,l$h=0<l$w.offsetY?l$w.offsetY:0,l$J*=l$P,l$h*=l$B,l$I._addPointArrToRst(l$_,l$q._getBoundPointS(l$L[1]-l$J,l$L[2]-l$h,l$n,l$f),l$X));break;case l$r._drawRect:case 13:l$I._addPointArrToRst(l$_,l$q._getBoundPointS(l$L[0],l$L[1],l$L[2],l$L[3]),l$z);break;case l$r._drawCircle:case l$r._fillCircle:case 14:l$I._addPointArrToRst(l$_,l$q._getBoundPointS(l$L[0]-l$L[2],l$L[1]-l$L[2],l$L[2]+l$L[2],l$L[2]+l$L[2]),l$z);break;case l$r._drawLine:case 20:l$I._tempPoints.length=0;var l$t;l$t=.5*l$L[5],l$L[0]==l$L[2]?l$I._tempPoints.push(l$L[0]+l$t,l$L[1],l$L[2]+l$t,l$L[3],l$L[0]-l$t,l$L[1],l$L[2]-l$t,l$L[3]):l$L[1]==l$L[3]?l$I._tempPoints.push(l$L[0],l$L[1]+l$t,l$L[2],l$L[3]+l$t,l$L[0],l$L[1]-l$t,l$L[2],l$L[3]-l$t):l$I._tempPoints.push(l$L[0],l$L[1],l$L[2],l$L[3]),l$I._addPointArrToRst(l$_,l$I._tempPoints,l$z);break;case l$r._drawCurves:case 22:l$I._addPointArrToRst(l$_,l$e.I.getBezierPoints(l$L[2]),l$z,l$L[0],l$L[1]);break;case l$r._drawPoly:case l$r._drawLines:case 18:l$I._addPointArrToRst(l$_,l$L[2],l$z,l$L[0],l$L[1]);break;case l$r._drawPath:case 19:l$I._addPointArrToRst(l$_,this._getPathPoints(l$L[2]),l$z,l$L[0],l$L[1]);break;case l$r._drawPie:case 15:l$I._addPointArrToRst(l$_,this._getPiePoints(l$L[0],l$L[1],l$L[2],l$L[3],l$L[4]),l$z)}return 200<l$_.length?l$_=l$Q.copyArray(l$_,l$q._getWrapRec(l$_)._getBoundPoints()):8<l$_.length&&(l$_=l$c.scanPList(l$_)),l$_},l$i._switchMatrix=function(l$i,l$_){l$_.concat(l$i),l$_.copyTo(l$i)},l$i._getPiePoints=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$I._tempPoints;l$I._tempPoints.length=0,l$z.push(l$i,l$_);var l$L=(l$b-l$r)%(2*Math.PI)/10,l$w=NaN,l$x=l$r;for(l$w=0;l$w<=10;l$w++)l$z.push(l$i+l$R*Math.cos(l$x),l$_+l$R*Math.sin(l$x)),l$x+=l$L;return l$z},l$i._getPathPoints=function(l$i){var l$_,l$R,l$r=0,l$b=l$I._tempPoints;for(l$b.length=0,l$_=l$i.length,l$r=0;l$r<l$_;l$r++)1<(l$R=l$i[l$r]).length&&(l$b.push(l$R[1],l$R[2]),3<l$R.length&&l$b.push(l$R[3],l$R[4]));return l$b},l$I._addPointArrToRst=function(l$i,l$_,l$R,l$r,l$b){void 0===l$r&&(l$r=0),void 0===l$b&&(l$b=0);var l$z,l$L=0;for(l$z=l$_.length,l$L=0;l$L<l$z;l$L+=2)l$I._addPointToRst(l$i,l$_[l$L]+l$r,l$_[l$L+1]+l$b,l$R)},l$I._addPointToRst=function(l$i,l$_,l$R,l$r){var l$b=l$Z.TEMP;l$b.setTo(l$_||0,l$R||0),l$r.transformPoint(l$b),l$i.push(l$b.x,l$b.y)},l$I._tempPoints=[],l$I._tempMatrixArrays=[],l$I._tempCmds=[],l$x(l$I,["_tempMatrix",function(){return this._tempMatrix=new l$G},"_initMatrix",function(){return this._initMatrix=new l$G}]),l$I}(),l$z=function(){function l$i(){}l$B(l$i,"laya.events.Event");var l$_=l$i.prototype;return l$_.setTo=function(l$i,l$_,l$R){return this.type=l$i,this.currentTarget=l$_,this.target=l$R,this},l$_.stopPropagation=function(){this._stoped=!0},l$h(0,l$_,"stageY",function(){return l$A.stage.mouseY}),l$h(0,l$_,"charCode",function(){return this.nativeEvent.charCode}),l$h(0,l$_,"touches",function(){var l$i=this.nativeEvent.touches;if(l$i)for(var l$_=l$A.stage,l$R=0,l$r=l$i.length;l$R<l$r;l$R++){var l$b=l$i[l$R],l$z=l$Z.TEMP;l$z.setTo(l$b.clientX,l$b.clientY),l$_._canvasTransform.invertTransformPoint(l$z),l$_.transform.invertTransformPoint(l$z),l$b.stageX=l$z.x,l$b.stageY=l$z.y}return l$i}),l$h(0,l$_,"keyLocation",function(){return this.nativeEvent.keyLocation}),l$h(0,l$_,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),l$h(0,l$_,"altKey",function(){return this.nativeEvent.altKey}),l$h(0,l$_,"shiftKey",function(){return this.nativeEvent.shiftKey}),l$h(0,l$_,"stageX",function(){return l$A.stage.mouseX}),l$i.EMPTY=new l$i,l$i.MOUSE_DOWN="mousedown",l$i.MOUSE_UP="mouseup",l$i.CLICK="click",l$i.RIGHT_MOUSE_DOWN="rightmousedown",l$i.RIGHT_MOUSE_UP="rightmouseup",l$i.RIGHT_CLICK="rightclick",l$i.MOUSE_MOVE="mousemove",l$i.MOUSE_OVER="mouseover",l$i.MOUSE_OUT="mouseout",l$i.MOUSE_WHEEL="mousewheel",l$i.ROLL_OVER="mouseover",l$i.ROLL_OUT="mouseout",l$i.DOUBLE_CLICK="doubleclick",l$i.CHANGE="change",l$i.CHANGED="changed",l$i.RESIZE="resize",l$i.ADDED="added",l$i.REMOVED="removed",l$i.DISPLAY="display",l$i.UNDISPLAY="undisplay",l$i.ERROR="error",l$i.COMPLETE="complete",l$i.LOADED="loaded",l$i.INITED="inited",l$i.PROGRESS="progress",l$i.INPUT="input",l$i.RENDER="render",l$i.OPEN="open",l$i.MESSAGE="message",l$i.CLOSE="close",l$i.KEY_DOWN="keydown",l$i.KEY_PRESS="keypress",l$i.KEY_UP="keyup",l$i.FRAME="enterframe",l$i.DRAG_START="dragstart",l$i.DRAG_MOVE="dragmove",l$i.DRAG_END="dragend",l$i.ENTER="enter",l$i.SELECT="select",l$i.BLUR="blur",l$i.FOCUS="focus",l$i.VISIBILITY_CHANGE="visibilitychange",l$i.FOCUS_CHANGE="focuschange",l$i.PLAYED="played",l$i.PAUSED="paused",l$i.STOPPED="stopped",l$i.START="start",l$i.END="end",l$i.ENABLE_CHANGED="enablechanged",l$i.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",l$i.COMPONENT_ADDED="componentadded",l$i.COMPONENT_REMOVED="componentremoved",l$i.LAYER_CHANGED="layerchanged",l$i.HIERARCHY_LOADED="hierarchyloaded",l$i.RECOVERED="recovered",l$i.RELEASED="released",l$i.LINK="link",l$i.LABEL="label",l$i.FULL_SCREEN_CHANGE="fullscreenchange",l$i.DEVICE_LOST="devicelost",l$i.MESH_CHANGED="meshchanged",l$i.MATERIAL_CHANGED="materialchanged",l$i.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",l$i.ANIMATION_CHANGED="animationchanged",l$i.TRIGGER_ENTER="triggerenter",l$i.TRIGGER_STAY="triggerstay",l$i.TRIGGER_EXIT="triggerexit",l$i.TRAIL_FILTER_CHANGE="trailfilterchange",l$i.DOMINO_FILTER_CHANGE="dominofilterchange",l$i}(),l$n=(function(){function l$i(){}l$B(l$i,"laya.events.Keyboard"),l$i.NUMBER_0=48,l$i.NUMBER_1=49,l$i.NUMBER_2=50,l$i.NUMBER_3=51,l$i.NUMBER_4=52,l$i.NUMBER_5=53,l$i.NUMBER_6=54,l$i.NUMBER_7=55,l$i.NUMBER_8=56,l$i.NUMBER_9=57,l$i.A=65,l$i.B=66,l$i.C=67,l$i.D=68,l$i.E=69,l$i.F=70,l$i.G=71,l$i.H=72,l$i.I=73,l$i.J=74,l$i.K=75,l$i.L=76,l$i.M=77,l$i.N=78,l$i.O=79,l$i.P=80,l$i.Q=81,l$i.R=82,l$i.S=83,l$i.T=84,l$i.U=85,l$i.V=86,l$i.W=87,l$i.X=88,l$i.Y=89,l$i.Z=90,l$i.F1=112,l$i.F2=113,l$i.F3=114,l$i.F4=115,l$i.F5=116,l$i.F6=117,l$i.F7=118,l$i.F8=119,l$i.F9=120,l$i.F10=121,l$i.F11=122,l$i.F12=123,l$i.F13=124,l$i.F14=125,l$i.F15=126,l$i.NUMPAD=21,l$i.NUMPAD_0=96,l$i.NUMPAD_1=97,l$i.NUMPAD_2=98,l$i.NUMPAD_3=99,l$i.NUMPAD_4=100,l$i.NUMPAD_5=101,l$i.NUMPAD_6=102,l$i.NUMPAD_7=103,l$i.NUMPAD_8=104,l$i.NUMPAD_9=105,l$i.NUMPAD_ADD=107,l$i.NUMPAD_DECIMAL=110,l$i.NUMPAD_DIVIDE=111,l$i.NUMPAD_ENTER=108,l$i.NUMPAD_MULTIPLY=106,l$i.NUMPAD_SUBTRACT=109,l$i.SEMICOLON=186,l$i.EQUAL=187,l$i.COMMA=188,l$i.MINUS=189,l$i.PERIOD=190,l$i.SLASH=191,l$i.BACKQUOTE=192,l$i.LEFTBRACKET=219,l$i.BACKSLASH=220,l$i.RIGHTBRACKET=221,l$i.QUOTE=222,l$i.ALTERNATE=18,l$i.BACKSPACE=8,l$i.CAPS_LOCK=20,l$i.COMMAND=15,l$i.CONTROL=17,l$i.DELETE=46,l$i.ENTER=13,l$i.ESCAPE=27,l$i.PAGE_UP=33,l$i.PAGE_DOWN=34,l$i.END=35,l$i.HOME=36,l$i.LEFT=37,l$i.UP=38,l$i.RIGHT=39,l$i.DOWN=40,l$i.SHIFT=16,l$i.SPACE=32,l$i.TAB=9,l$i.INSERT=45}(),function(){function l$b(){}return l$B(l$b,"laya.events.KeyBoardManager"),l$b.__init__=function(){l$b._addEvent("keydown"),l$b._addEvent("keypress"),l$b._addEvent("keyup")},l$b._addEvent=function(l$_){l$s.document.addEventListener(l$_,function(l$i){laya.events.KeyBoardManager._dispatch(l$i,l$_)},!0)},l$b._dispatch=function(l$i,l$_){if(l$b.enabled){l$b._event._stoped=!1,l$b._event.nativeEvent=l$i,l$b._event.keyCode=l$i.keyCode||l$i.which||l$i.charCode,"keydown"===l$_?l$b._pressKeys[l$b._event.keyCode]=!0:"keyup"===l$_&&(l$b._pressKeys[l$b._event.keyCode]=null);for(var l$R=l$A.stage.focus&&null!=l$A.stage.focus.event&&l$A.stage.focus.displayedInStage?l$A.stage.focus:l$A.stage,l$r=l$R;l$r;)l$r.event(l$_,l$b._event.setTo(l$_,l$r,l$R)),l$r=l$r.parent}},l$b.hasKeyDown=function(l$i){return l$b._pressKeys[l$i]},l$b._pressKeys={},l$b.enabled=!0,l$x(l$b,["_event",function(){return this._event=new l$z}]),l$b}()),l$M=(function(){function l$i(){}l$B(l$i,"laya.events.KeyLocation"),l$i.STANDARD=0,l$i.LEFT=1,l$i.RIGHT=2,l$i.NUM_PAD=3}(),function(){function l$P(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=l$s.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new l$z,this._matrix=new l$G,this._point=new l$Z,this._rect=new l$q,this._prePoint=new l$Z,this._curTouchID=NaN}l$B(l$P,"laya.events.MouseManager");var l$i=l$P.prototype;return l$i.__init__=function(l$i,l$_){var l$R=this;this._stage=l$i;var l$r=this,l$b=this._eventList;l$_.oncontextmenu=function(l$i){if(l$P.enabled)return!1},l$_.addEventListener("mousedown",function(l$i){l$P.enabled&&(l$s.onIE||l$i.preventDefault(),l$b.push(l$i),l$r.mouseDownTime=l$s.now())}),l$_.addEventListener("mouseup",function(l$i){l$P.enabled&&(l$i.preventDefault(),l$b.push(l$i),l$r.mouseDownTime=-l$s.now())},!0),l$_.addEventListener("mousemove",function(l$i){if(l$P.enabled){l$i.preventDefault();var l$_=l$s.now();if(l$_-l$r._lastMoveTimer<10)return;l$r._lastMoveTimer=l$_,l$b.push(l$i)}},!0),l$_.addEventListener("mouseout",function(l$i){l$P.enabled&&l$b.push(l$i)}),l$_.addEventListener("mouseover",function(l$i){l$P.enabled&&l$b.push(l$i)}),l$_.addEventListener("touchstart",function(l$i){l$P.enabled&&(l$b.push(l$i),l$P._isFirstTouch||l$ci.isInputting||l$i.preventDefault(),l$r.mouseDownTime=l$s.now())}),l$_.addEventListener("touchend",function(l$i){l$P.enabled?(l$P._isFirstTouch||l$ci.isInputting||l$i.preventDefault(),l$P._isFirstTouch=!1,l$b.push(l$i),l$r.mouseDownTime=-l$s.now()):l$R._curTouchID=NaN},!0),l$_.addEventListener("touchmove",function(l$i){l$P.enabled&&(l$i.preventDefault(),l$b.push(l$i))},!0),l$_.addEventListener("touchcancel",function(l$i){l$P.enabled?(l$i.preventDefault(),l$b.push(l$i)):l$R._curTouchID=NaN},!0),l$_.addEventListener("mousewheel",function(l$i){l$P.enabled&&l$b.push(l$i)}),l$_.addEventListener("DOMMouseScroll",function(l$i){l$P.enabled&&l$b.push(l$i)})},l$i.initEvent=function(l$i,l$_){var l$R;this._event._stoped=!1,this._event.nativeEvent=l$_||l$i,this._target=null,this._point.setTo(l$i.pageX||l$i.clientX,l$i.pageY||l$i.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=l$i.identifier||0,this._tTouchID=this._event.touchId,(l$R=l$N.I._event)._stoped=!1,l$R.nativeEvent=this._event.nativeEvent,l$R.touchId=this._event.touchId},l$i.checkMouseWheel=function(l$i){this._event.delta=l$i.wheelDelta?.025*l$i.wheelDelta:-l$i.detail;for(var l$_=l$N.I.getLastOvers(),l$R=0,l$r=l$_.length;l$R<l$r;l$R++){var l$b=l$_[l$R];l$b.event("mousewheel",this._event.setTo("mousewheel",l$b,this._target))}},l$i.onMouseMove=function(l$i){l$N.I.onMouseMove(l$i,this._tTouchID)},l$i.onMouseDown=function(l$i){if(l$ci.isInputting&&l$A.stage.focus&&l$A.stage.focus.focus&&!l$A.stage.focus.contains(this._target)){var l$_=l$A.stage.focus._tf||l$A.stage.focus,l$R=l$i._tf||l$i;l$R instanceof laya.display.Input&&l$R.multiline==l$_.multiline?l$_._focusOut():l$_.focus=!1}l$N.I.onMouseDown(l$i,this._tTouchID,this._isLeftMouse)},l$i.onMouseUp=function(l$i){l$N.I.onMouseUp(l$i,this._tTouchID,this._isLeftMouse)},l$i.check=function(l$i,l$_,l$R,l$r){this._point.setTo(l$_,l$R),l$i.fromParentPoint(this._point),l$_=this._point.x,l$R=this._point.y;var l$b=l$i.scrollRect;if(l$b&&(this._rect.setTo(l$b.x,l$b.y,l$b.width,l$b.height),!this._rect.contains(l$_,l$R)))return!1;if(!this.disableMouseEvent){if(l$i.hitTestPrior&&!l$i.mouseThrough&&!this.hitTest(l$i,l$_,l$R))return!1;for(var l$z=l$i._childs.length-1;-1<l$z;l$z--){var l$L=l$i._childs[l$z];if(!l$L.destroyed&&l$L.mouseEnabled&&l$L.visible&&this.check(l$L,l$_,l$R,l$r))return!0}}var l$w=!(!l$i.hitTestPrior||l$i.mouseThrough||this.disableMouseEvent)||this.hitTest(l$i,l$_,l$R);return l$w?(this._target=l$i,l$r.call(this,l$i)):l$r===this.onMouseUp&&l$i===this._stage&&(this._target=this._stage,l$r.call(this,this._target)),l$w},l$i.hitTest=function(l$i,l$_,l$R){var l$r=!1;if(l$i.scrollRect&&(l$_-=l$i.scrollRect.x,l$R-=l$i.scrollRect.y),l$i.hitArea instanceof laya.utils.HitArea)return l$i.hitArea.isHit(l$_,l$R);if(0<l$i.width&&0<l$i.height||l$i.mouseThrough||l$i.hitArea)if(l$i.mouseThrough)l$r=l$i.getGraphicBounds().contains(l$_,l$R);else{var l$b=this._rect;l$i.hitArea?l$b=l$i.hitArea:l$b.setTo(0,0,l$i.width,l$i.height),l$r=l$b.contains(l$_,l$R)}return l$r},l$i.runEvent=function(){var l$i=this._eventList.length;if(l$i){this.mouseEventTime=l$s.now();var l$_,l$R=0,l$r=0,l$b=0;try{for(;l$R<l$i;){var l$z=this._eventList[l$R];switch("mousemove"!==l$z.type&&(this._prePoint.x=this._prePoint.y=-1e6),l$z.type){case"mousedown":this._touchIDs[0]=this._id++,l$P._isTouchRespond?l$P._isTouchRespond=!1:(this._isLeftMouse=0===l$z.button,this.initEvent(l$z),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===l$z.button,this.initEvent(l$z),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-l$z.clientX)+Math.abs(this._prePoint.y-l$z.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=l$z.clientX,this._prePoint.y=l$z.clientY,this.initEvent(l$z),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":l$P._isTouchRespond=!0,this._isLeftMouse=!0;var l$L=l$z.changedTouches;for(l$r=0,l$b=l$L.length;l$r<l$b;l$r++)l$_=l$L[l$r],(l$P.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=l$_.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[l$_.identifier]=this._id++,this.initEvent(l$_,l$z),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":l$P._isTouchRespond=!0,this._isLeftMouse=!0;var l$w=l$z.changedTouches;for(l$r=0,l$b=l$w.length;l$r<l$b;l$r++)if(l$_=l$w[l$r],l$P.multiTouchEnabled||l$_.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(l$_,l$z);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var l$x=l$z.changedTouches;for(l$r=0,l$b=l$x.length;l$r<l$b;l$r++)l$_=l$x[l$r],(l$P.multiTouchEnabled||l$_.identifier==this._curTouchID)&&(this.initEvent(l$_,l$z),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(l$z);break;case"mouseout":l$N.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}l$R++}}catch(l$i){throw this._eventList.length=0,l$i}this._eventList.length=0}},l$P.enabled=!0,l$P.multiTouchEnabled=!0,l$P._isTouchRespond=!1,l$P._isFirstTouch=!0,l$x(l$P,["instance",function(){return this.instance=new l$P}]),l$P}()),l$N=function(){function l$h(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new l$z}l$B(l$h,"laya.events.TouchManager");var l$i=l$h.prototype;return l$i._clearTempArrs=function(){l$h._oldArr.length=0,l$h._newArr.length=0,l$h._tEleArr.length=0},l$i.getTouchFromArr=function(l$i,l$_){var l$R,l$r,l$b=0;for(l$R=l$_.length,l$b=0;l$b<l$R;l$b++)if((l$r=l$_[l$b]).id==l$i)return l$r;return null},l$i.removeTouchFromArr=function(l$i,l$_){var l$R=0;for(l$R=l$_.length-1;0<=l$R;l$R--)l$_[l$R].id==l$i&&l$_.splice(l$R,1)},l$i.createTouchO=function(l$i,l$_){var l$R;return(l$R=l$y.getItem("TouchData")||{}).id=l$_,l$R.tar=l$i,l$R},l$i.onMouseDown=function(l$i,l$_,l$R){var l$r,l$b,l$z,l$L;(void 0===l$R&&(l$R=!1),this.enable)&&(l$r=this.getTouchFromArr(l$_,this.preOvers),l$z=this.getEles(l$i,null,l$h._tEleArr),l$r?l$r.tar=l$i:(l$b=this.createTouchO(l$i,l$_),this.preOvers.push(l$b)),l$s.onMobile&&this.sendEvents(l$z,"mouseover",l$_),l$L=l$R?this.preDowns:this.preRightDowns,(l$r=this.getTouchFromArr(l$_,l$L))?l$r.tar=l$i:(l$b=this.createTouchO(l$i,l$_),l$L.push(l$b)),this.sendEvents(l$z,l$R?"mousedown":"rightmousedown",l$_),this._clearTempArrs())},l$i.sendEvents=function(l$i,l$_,l$R){void 0===l$R&&(l$R=0);var l$r,l$b,l$z,l$L=0;for(l$r=l$i.length,this._event._stoped=!1,l$b=l$i[0],l$L=0;l$L<l$r;l$L++){if((l$z=l$i[l$L]).destroyed)return;if(l$z.event(l$_,this._event.setTo(l$_,l$z,l$b)),this._event._stoped)break}},l$i.getEles=function(l$i,l$_,l$R){for(l$R?l$R.length=0:l$R=[];l$i&&l$i!=l$_;)l$R.push(l$i),l$i=l$i.parent;return l$R},l$i.checkMouseOutAndOverOfMove=function(l$i,l$_,l$R){if(void 0===l$R&&(l$R=0),l$_!=l$i){var l$r,l$b,l$z=0,l$L=0;if(l$_.contains(l$i))l$b=this.getEles(l$i,l$_,l$h._tEleArr),this.sendEvents(l$b,"mouseover",l$R);else if(l$i.contains(l$_))l$b=this.getEles(l$_,l$i,l$h._tEleArr),this.sendEvents(l$b,"mouseout",l$R);else{var l$w,l$x;(l$b=l$h._tEleArr).length=0,l$w=this.getEles(l$_,null,l$h._oldArr),l$x=this.getEles(l$i,null,l$h._newArr),l$L=l$w.length;var l$P=0;for(l$z=0;l$z<l$L;l$z++){if(l$r=l$w[l$z],0<=(l$P=l$x.indexOf(l$r))){l$x.splice(l$P,l$x.length-l$P);break}l$b.push(l$r)}0<l$b.length&&this.sendEvents(l$b,"mouseout",l$R),0<l$x.length&&this.sendEvents(l$x,"mouseover",l$R)}}},l$i.onMouseMove=function(l$i,l$_){var l$R,l$r;this.enable&&((l$R=this.getTouchFromArr(l$_,this.preOvers))?(this.checkMouseOutAndOverOfMove(l$i,l$R.tar),l$R.tar=l$i,l$r=this.getEles(l$i,null,l$h._tEleArr)):(l$r=this.getEles(l$i,null,l$h._tEleArr),this.sendEvents(l$r,"mouseover",l$_),this.preOvers.push(this.createTouchO(l$i,l$_))),this.sendEvents(l$r,"mousemove",l$_),this._clearTempArrs())},l$i.getLastOvers=function(){return(l$h._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,l$h._tEleArr):(l$h._tEleArr.push(l$A.stage),l$h._tEleArr)},l$i.stageMouseOut=function(){var l$i;l$i=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(l$i,"mouseout",0)},l$i.onMouseUp=function(l$i,l$_,l$R){if(void 0===l$R&&(l$R=!1),this.enable){var l$r,l$b,l$z,l$L,l$w,l$x,l$P=0,l$B=0,l$n=l$s.onMobile;if(l$b=this.getEles(l$i,null,l$h._tEleArr),this.sendEvents(l$b,l$R?"mouseup":"rightmouseup",l$_),l$x=l$R?this.preDowns:this.preRightDowns,l$r=this.getTouchFromArr(l$_,l$x)){var l$f,l$J=l$s.now();if(l$f=l$J-this._lastClickTime<300,this._lastClickTime=l$J,l$i==l$r.tar)l$w=l$b;else for(l$z=this.getEles(l$r.tar,null,l$h._oldArr),(l$w=l$h._newArr).length=0,l$B=l$z.length,l$P=0;l$P<l$B;l$P++)l$L=l$z[l$P],0<=l$b.indexOf(l$L)&&l$w.push(l$L);0<l$w.length&&this.sendEvents(l$w,l$R?"click":"rightclick",l$_),l$R&&l$f&&this.sendEvents(l$w,"doubleclick",l$_),this.removeTouchFromArr(l$_,l$x),l$r.tar=null,l$y.recover("TouchData",l$r)}else;(l$r=this.getTouchFromArr(l$_,this.preOvers))&&l$n&&((l$w=this.getEles(l$r.tar,null,l$w))&&0<l$w.length&&this.sendEvents(l$w,"mouseout",l$_),this.removeTouchFromArr(l$_,this.preOvers),l$r.tar=null,l$y.recover("TouchData",l$r)),this._clearTempArrs()}},l$h._oldArr=[],l$h._newArr=[],l$h._tEleArr=[],l$x(l$h,["I",function(){return this.I=new l$h}]),l$h}(),l$X=function(){function l$i(){this._action=null}l$B(l$i,"laya.filters.Filter");var l$_=l$i.prototype;return l$A.imps(l$_,{"laya.filters.IFilter":!0}),l$_.callNative=function(l$i){},l$h(0,l$_,"type",function(){return-1}),l$h(0,l$_,"action",function(){return this._action}),l$i.BLUR=16,l$i.COLOR=32,l$i.GLOW=8,l$i._filterStart=null,l$i._filterEnd=null,l$i._EndTarget=null,l$i._recycleScope=null,l$i._filter=null,l$i._useSrc=null,l$i._endSrc=null,l$i._useOut=null,l$i._endOut=null,l$i}(),l$I=function(){function l$i(){this.data=null}l$B(l$i,"laya.filters.ColorFilterAction");var l$_=l$i.prototype;return l$A.imps(l$_,{"laya.filters.IFilterAction":!0}),l$_.apply=function(l$i){var l$_=l$i.ctx.ctx,l$R=l$i.ctx.ctx.canvas;if(0==l$R.width||0==l$R.height)return l$R;for(var l$r,l$b=l$_.getImageData(0,0,l$R.width,l$R.height),l$z=l$b.data,l$L=0,l$w=l$z.length;l$L<l$w;l$L+=4)l$r=this.getColor(l$z[l$L],l$z[l$L+1],l$z[l$L+2],l$z[l$L+3]),0!=l$z[l$L+3]&&(l$z[l$L]=l$r[0],l$z[l$L+1]=l$r[1],l$z[l$L+2]=l$r[2],l$z[l$L+3]=l$r[3]);return l$_.putImageData(l$b,0,0),l$i},l$_.getColor=function(l$i,l$_,l$R,l$r){var l$b=[];if(this.data._mat&&this.data._alpha){var l$z=this.data._mat,l$L=this.data._alpha;l$b[0]=l$z[0]*l$i+l$z[1]*l$_+l$z[2]*l$R+l$z[3]*l$r+l$L[0],l$b[1]=l$z[4]*l$i+l$z[5]*l$_+l$z[6]*l$R+l$z[7]*l$r+l$L[1],l$b[2]=l$z[8]*l$i+l$z[9]*l$_+l$z[10]*l$R+l$z[11]*l$r+l$L[2],l$b[3]=l$z[12]*l$i+l$z[13]*l$_+l$z[14]*l$R+l$z[15]*l$r+l$L[3]}return l$b},l$i}(),l$e=(function(){function l$i(){}l$B(l$i,"laya.maths.Arith"),l$i.formatR=function(l$i){return l$i>Math.PI&&(l$i-=2*Math.PI),l$i<-Math.PI&&(l$i+=2*Math.PI),l$i},l$i.isPOT=function(l$i,l$_){return 0<l$i&&0==(l$i&l$i-1)&&0<l$_&&0==(l$_&l$_-1)},l$i.setMatToArray=function(l$i,l$_){l$i.a,l$i.b,l$i.c,l$i.d,l$i.tx,l$i.ty,l$_[0]=l$i.a,l$_[1]=l$i.b,l$_[4]=l$i.c,l$_[5]=l$i.d,l$_[12]=l$i.tx,l$_[13]=l$i.ty}}(),function(){function l$i(){this._controlPoints=[new l$Z,new l$Z,new l$Z],this._calFun=this.getPoint2}l$B(l$i,"laya.maths.Bezier");var l$_=l$i.prototype;return l$_._switchPoint=function(l$i,l$_){var l$R=this._controlPoints.shift();l$R.setTo(l$i,l$_),this._controlPoints.push(l$R)},l$_.getPoint2=function(l$i,l$_){var l$R=this._controlPoints[0],l$r=this._controlPoints[1],l$b=this._controlPoints[2],l$z=Math.pow(1-l$i,2)*l$R.x+2*l$i*(1-l$i)*l$r.x+Math.pow(l$i,2)*l$b.x,l$L=Math.pow(1-l$i,2)*l$R.y+2*l$i*(1-l$i)*l$r.y+Math.pow(l$i,2)*l$b.y;l$_.push(l$z,l$L)},l$_.getPoint3=function(l$i,l$_){var l$R=this._controlPoints[0],l$r=this._controlPoints[1],l$b=this._controlPoints[2],l$z=this._controlPoints[3],l$L=Math.pow(1-l$i,3)*l$R.x+3*l$r.x*l$i*(1-l$i)*(1-l$i)+3*l$b.x*l$i*l$i*(1-l$i)+l$z.x*Math.pow(l$i,3),l$w=Math.pow(1-l$i,3)*l$R.y+3*l$r.y*l$i*(1-l$i)*(1-l$i)+3*l$b.y*l$i*l$i*(1-l$i)+l$z.y*Math.pow(l$i,3);l$_.push(l$L,l$w)},l$_.insertPoints=function(l$i,l$_){var l$R,l$r=NaN;for(l$R=1/(l$i=0<l$i?l$i:5),l$r=0;l$r<=1;l$r+=l$R)this._calFun(l$r,l$_)},l$_.getBezierPoints=function(l$i,l$_,l$R){void 0===l$_&&(l$_=5),void 0===l$R&&(l$R=2);var l$r,l$b,l$z=0;if((l$r=l$i.length)<2*(l$R+1))return[];switch(l$b=[],l$R){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=l$R;)this._controlPoints.push(new l$Z);for(l$z=0;l$z<2*l$R;l$z+=2)this._switchPoint(l$i[l$z],l$i[l$z+1]);for(l$z=2*l$R;l$z<l$r;l$z+=2)this._switchPoint(l$i[l$z],l$i[l$z+1]),l$z/2%l$R==0&&this.insertPoints(l$_,l$b);return l$b},l$x(l$i,["I",function(){return this.I=new l$i}]),l$i}()),l$c=function(){function l$P(){}return l$B(l$P,"laya.maths.GrahamScan"),l$P.multiply=function(l$i,l$_,l$R){return(l$i.x-l$R.x)*(l$_.y-l$R.y)-(l$_.x-l$R.x)*(l$i.y-l$R.y)},l$P.dis=function(l$i,l$_){return(l$i.x-l$_.x)*(l$i.x-l$_.x)+(l$i.y-l$_.y)*(l$i.y-l$_.y)},l$P._getPoints=function(l$i,l$_,l$R){for(void 0===l$_&&(l$_=!1),l$P._mPointList||(l$P._mPointList=[]);l$P._mPointList.length<l$i;)l$P._mPointList.push(new l$Z);return l$R||(l$R=[]),l$R.length=0,l$_?l$P.getFrom(l$R,l$P._mPointList,l$i):l$P.getFromR(l$R,l$P._mPointList,l$i),l$R},l$P.getFrom=function(l$i,l$_,l$R){var l$r=0;for(l$r=0;l$r<l$R;l$r++)l$i.push(l$_[l$r]);return l$i},l$P.getFromR=function(l$i,l$_,l$R){var l$r=0;for(l$r=0;l$r<l$R;l$r++)l$i.push(l$_.pop());return l$i},l$P.pListToPointList=function(l$i,l$_){void 0===l$_&&(l$_=!1);var l$R=0,l$r=l$i.length/2,l$b=l$P._getPoints(l$r,l$_,l$P._tempPointList);for(l$R=0;l$R<l$r;l$R++)l$b[l$R].setTo(l$i[l$R+l$R],l$i[l$R+l$R+1]);return l$b},l$P.pointListToPlist=function(l$i){var l$_,l$R=0,l$r=l$i.length,l$b=l$P._temPList;for(l$R=l$b.length=0;l$R<l$r;l$R++)l$_=l$i[l$R],l$b.push(l$_.x,l$_.y);return l$b},l$P.scanPList=function(l$i){return l$Q.copyArray(l$i,l$P.pointListToPlist(l$P.scan(l$P.pListToPointList(l$i,!0))))},l$P.scan=function(l$i){var l$_,l$R,l$r,l$b=0,l$z=0,l$L=0,l$w=l$i.length,l$x={};for((l$R=l$P._temArr).length=0,l$b=(l$w=l$i.length)-1;0<=l$b;l$b--)l$r=(l$_=l$i[l$b]).x+"_"+l$_.y,l$x.hasOwnProperty(l$r)||(l$x[l$r]=!0,l$R.push(l$_));for(l$w=l$R.length,l$Q.copyArray(l$i,l$R),l$b=1;l$b<l$w;l$b++)(l$i[l$b].y<l$i[l$L].y||l$i[l$b].y==l$i[l$L].y&&l$i[l$b].x<l$i[l$L].x)&&(l$L=l$b);for(l$_=l$i[0],l$i[0]=l$i[l$L],l$i[l$L]=l$_,l$b=1;l$b<l$w-1;l$b++){for(l$z=(l$L=l$b)+1;l$z<l$w;l$z++)(0<l$P.multiply(l$i[l$z],l$i[l$L],l$i[0])||0==l$P.multiply(l$i[l$z],l$i[l$L],l$i[0])&&l$P.dis(l$i[0],l$i[l$z])<l$P.dis(l$i[0],l$i[l$L]))&&(l$L=l$z);l$_=l$i[l$b],l$i[l$b]=l$i[l$L],l$i[l$L]=l$_}if((l$R=l$P._temArr).length=0,l$i.length<3)return l$Q.copyArray(l$R,l$i);for(l$R.push(l$i[0],l$i[1],l$i[2]),l$b=3;l$b<l$w;l$b++){for(;2<=l$R.length&&0<=l$P.multiply(l$i[l$b],l$R[l$R.length-1],l$R[l$R.length-2]);)l$R.pop();l$i[l$b]&&l$R.push(l$i[l$b])}return l$R},l$P._mPointList=null,l$P._tempPointList=[],l$P._temPList=[],l$P._temArr=[],l$P}(),l$l=function(){function l$b(){}return l$B(l$b,"laya.maths.MathUtil"),l$b.subtractVector3=function(l$i,l$_,l$R){l$R[0]=l$i[0]-l$_[0],l$R[1]=l$i[1]-l$_[1],l$R[2]=l$i[2]-l$_[2]},l$b.lerp=function(l$i,l$_,l$R){return l$i*(1-l$R)+l$_*l$R},l$b.scaleVector3=function(l$i,l$_,l$R){l$R[0]=l$i[0]*l$_,l$R[1]=l$i[1]*l$_,l$R[2]=l$i[2]*l$_},l$b.lerpVector3=function(l$i,l$_,l$R,l$r){var l$b=l$i[0],l$z=l$i[1],l$L=l$i[2];l$r[0]=l$b+l$R*(l$_[0]-l$b),l$r[1]=l$z+l$R*(l$_[1]-l$z),l$r[2]=l$L+l$R*(l$_[2]-l$L)},l$b.lerpVector4=function(l$i,l$_,l$R,l$r){var l$b=l$i[0],l$z=l$i[1],l$L=l$i[2],l$w=l$i[3];l$r[0]=l$b+l$R*(l$_[0]-l$b),l$r[1]=l$z+l$R*(l$_[1]-l$z),l$r[2]=l$L+l$R*(l$_[2]-l$L),l$r[3]=l$w+l$R*(l$_[3]-l$w)},l$b.slerpQuaternionArray=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){var l$w,l$x,l$P,l$B,l$n,l$f=l$i[l$_+0],l$J=l$i[l$_+1],l$h=l$i[l$_+2],l$M=l$i[l$_+3],l$N=l$R[l$r+0],l$X=l$R[l$r+1],l$t=l$R[l$r+2],l$I=l$R[l$r+3];return(l$x=l$f*l$N+l$J*l$X+l$h*l$t+l$M*l$I)<0&&(l$x=-l$x,l$N=-l$N,l$X=-l$X,l$t=-l$t,l$I=-l$I),l$n=1e-6<1-l$x?(l$w=Math.acos(l$x),l$P=Math.sin(l$w),l$B=Math.sin((1-l$b)*l$w)/l$P,Math.sin(l$b*l$w)/l$P):(l$B=1-l$b,l$b),l$z[l$L+0]=l$B*l$f+l$n*l$N,l$z[l$L+1]=l$B*l$J+l$n*l$X,l$z[l$L+2]=l$B*l$h+l$n*l$t,l$z[l$L+3]=l$B*l$M+l$n*l$I,l$z},l$b.getRotation=function(l$i,l$_,l$R,l$r){return Math.atan2(l$r-l$_,l$R-l$i)/Math.PI*180},l$b.sortBigFirst=function(l$i,l$_){return l$i==l$_?0:l$i<l$_?1:-1},l$b.sortSmallFirst=function(l$i,l$_){return l$i==l$_?0:l$i<l$_?-1:1},l$b.sortNumBigFirst=function(l$i,l$_){return parseFloat(l$_)-parseFloat(l$i)},l$b.sortNumSmallFirst=function(l$i,l$_){return parseFloat(l$i)-parseFloat(l$_)},l$b.sortByKey=function(l$R,l$i,l$_){var l$r;return void 0===l$i&&(l$i=!1),void 0===l$_&&(l$_=!0),l$r=l$i?l$_?l$b.sortNumBigFirst:l$b.sortBigFirst:l$_?l$b.sortNumSmallFirst:l$b.sortSmallFirst,function(l$i,l$_){return l$r(l$i[l$R],l$_[l$R])}},l$b}(),l$G=function(){function l$R(l$i,l$_,l$R,l$r,l$b,l$z){this.inPool=!1,this.bTransform=!1,void 0===l$i&&(l$i=1),void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=1),void 0===l$b&&(l$b=0),void 0===l$z&&(l$z=0),this.a=l$i,this.b=l$_,this.c=l$R,this.d=l$r,this.tx=l$b,this.ty=l$z,this._checkTransform()}l$B(l$R,"laya.maths.Matrix");var l$i=l$R.prototype;return l$i.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},l$i._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},l$i.setTranslate=function(l$i,l$_){return this.tx=l$i,this.ty=l$_,this},l$i.translate=function(l$i,l$_){return this.tx+=l$i,this.ty+=l$_,this},l$i.scale=function(l$i,l$_){this.a*=l$i,this.d*=l$_,this.c*=l$i,this.b*=l$_,this.tx*=l$i,this.ty*=l$_,this.bTransform=!0},l$i.rotate=function(l$i){var l$_=Math.cos(l$i),l$R=Math.sin(l$i),l$r=this.a,l$b=this.c,l$z=this.tx;this.a=l$r*l$_-this.b*l$R,this.b=l$r*l$R+this.b*l$_,this.c=l$b*l$_-this.d*l$R,this.d=l$b*l$R+this.d*l$_,this.tx=l$z*l$_-this.ty*l$R,this.ty=l$z*l$R+this.ty*l$_,this.bTransform=!0},l$i.skew=function(l$i,l$_){var l$R=Math.tan(l$i),l$r=Math.tan(l$_),l$b=this.a,l$z=this.b;return this.a+=l$r*this.c,this.b+=l$r*this.d,this.c+=l$R*l$b,this.d+=l$R*l$z,this},l$i.invertTransformPoint=function(l$i){var l$_=this.a,l$R=this.b,l$r=this.c,l$b=this.d,l$z=this.tx,l$L=l$_*l$b-l$R*l$r,l$w=l$b/l$L,l$x=-l$R/l$L,l$P=-l$r/l$L,l$B=l$_/l$L,l$n=(l$r*this.ty-l$b*l$z)/l$L,l$f=-(l$_*this.ty-l$R*l$z)/l$L;return l$i.setTo(l$w*l$i.x+l$P*l$i.y+l$n,l$x*l$i.x+l$B*l$i.y+l$f)},l$i.transformPoint=function(l$i){return l$i.setTo(this.a*l$i.x+this.c*l$i.y+this.tx,this.b*l$i.x+this.d*l$i.y+this.ty)},l$i.transformPointN=function(l$i){return l$i.setTo(this.a*l$i.x+this.c*l$i.y,this.b*l$i.x+this.d*l$i.y)},l$i.transformPointArray=function(l$i,l$_){for(var l$R=l$i.length,l$r=0;l$r<l$R;l$r+=2){var l$b=l$i[l$r],l$z=l$i[l$r+1];l$_[l$r]=this.a*l$b+this.c*l$z+this.tx,l$_[l$r+1]=this.b*l$b+this.d*l$z+this.ty}return l$_},l$i.transformPointArrayScale=function(l$i,l$_){for(var l$R=l$i.length,l$r=0;l$r<l$R;l$r+=2){var l$b=l$i[l$r],l$z=l$i[l$r+1];l$_[l$r]=this.a*l$b+this.c*l$z,l$_[l$r+1]=this.b*l$b+this.d*l$z}return l$_},l$i.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},l$i.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},l$i.invert=function(){var l$i=this.a,l$_=this.b,l$R=this.c,l$r=this.d,l$b=this.tx,l$z=l$i*l$r-l$_*l$R;return this.a=l$r/l$z,this.b=-l$_/l$z,this.c=-l$R/l$z,this.d=l$i/l$z,this.tx=(l$R*this.ty-l$r*l$b)/l$z,this.ty=-(l$i*this.ty-l$_*l$b)/l$z,this},l$i.setTo=function(l$i,l$_,l$R,l$r,l$b,l$z){return this.a=l$i,this.b=l$_,this.c=l$R,this.d=l$r,this.tx=l$b,this.ty=l$z,this},l$i.concat=function(l$i){var l$_=this.a,l$R=this.c,l$r=this.tx;return this.a=l$_*l$i.a+this.b*l$i.c,this.b=l$_*l$i.b+this.b*l$i.d,this.c=l$R*l$i.a+this.d*l$i.c,this.d=l$R*l$i.b+this.d*l$i.d,this.tx=l$r*l$i.a+this.ty*l$i.c+l$i.tx,this.ty=l$r*l$i.b+this.ty*l$i.d+l$i.ty,this},l$i.scaleEx=function(l$i,l$_){var l$R=this.a,l$r=this.b,l$b=this.c,l$z=this.d;0!==l$r||0!==l$b?(this.a=l$i*l$R,this.b=l$i*l$r,this.c=l$_*l$b):(this.a=l$i*l$R,this.b=0*l$z,this.c=0*l$R),this.d=l$_*l$z,this.bTransform=!0},l$i.rotateEx=function(l$i){var l$_=Math.cos(l$i),l$R=Math.sin(l$i),l$r=this.a,l$b=this.b,l$z=this.c,l$L=this.d;0!==l$b||0!==l$z?(this.a=l$_*l$r+l$R*l$z,this.b=l$_*l$b+l$R*l$L,this.c=-l$R*l$r+l$_*l$z,this.d=-l$R*l$b+l$_*l$L):(this.a=l$_*l$r,this.b=l$R*l$L,this.c=-l$R*l$r,this.d=l$_*l$L),this.bTransform=!0},l$i.clone=function(){var l$i=l$R.create();return l$i.a=this.a,l$i.b=this.b,l$i.c=this.c,l$i.d=this.d,l$i.tx=this.tx,l$i.ty=this.ty,l$i.bTransform=this.bTransform,l$i},l$i.copyTo=function(l$i){return l$i.a=this.a,l$i.b=this.b,l$i.c=this.c,l$i.d=this.d,l$i.tx=this.tx,l$i.ty=this.ty,l$i.bTransform=this.bTransform,l$i},l$i.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},l$i.destroy=function(){if(!this.inPool){var l$i=l$R._cache;this.inPool=!0,l$i._length||(l$i._length=0),(l$i[l$i._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},l$R.mul=function(l$i,l$_,l$R){var l$r=l$i.a,l$b=l$i.b,l$z=l$i.c,l$L=l$i.d,l$w=l$i.tx,l$x=l$i.ty,l$P=l$_.a,l$B=l$_.b,l$n=l$_.c,l$f=l$_.d,l$J=l$_.tx,l$h=l$_.ty;return 0!==l$B||0!==l$n?(l$R.a=l$r*l$P+l$b*l$n,l$R.b=l$r*l$B+l$b*l$f,l$R.c=l$z*l$P+l$L*l$n,l$R.d=l$z*l$B+l$L*l$f,l$R.tx=l$P*l$w+l$n*l$x+l$J,l$R.ty=l$B*l$w+l$f*l$x+l$h):(l$R.a=l$r*l$P,l$R.b=l$b*l$f,l$R.c=l$z*l$P,l$R.d=l$L*l$f,l$R.tx=l$P*l$w+l$J,l$R.ty=l$f*l$x+l$h),l$R},l$R.mul16=function(l$i,l$_,l$R){var l$r=l$i.a,l$b=l$i.b,l$z=l$i.c,l$L=l$i.d,l$w=l$i.tx,l$x=l$i.ty,l$P=l$_.a,l$B=l$_.b,l$n=l$_.c,l$f=l$_.d,l$J=l$_.tx,l$h=l$_.ty;return 0!==l$B||0!==l$n?(l$R[0]=l$r*l$P+l$b*l$n,l$R[1]=l$r*l$B+l$b*l$f,l$R[4]=l$z*l$P+l$L*l$n,l$R[5]=l$z*l$B+l$L*l$f,l$R[12]=l$P*l$w+l$n*l$x+l$J,l$R[13]=l$B*l$w+l$f*l$x+l$h):(l$R[0]=l$r*l$P,l$R[1]=l$b*l$f,l$R[4]=l$z*l$P,l$R[5]=l$L*l$f,l$R[12]=l$P*l$w+l$J,l$R[13]=l$f*l$x+l$h),l$R},l$R.mulPre=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){var l$x=l$i.a,l$P=l$i.b,l$B=l$i.c,l$n=l$i.d,l$f=l$i.tx,l$J=l$i.ty;return 0!==l$R||0!==l$r?(l$w.a=l$x*l$_+l$P*l$r,l$w.b=l$x*l$R+l$P*l$b,l$w.c=l$B*l$_+l$n*l$r,l$w.d=l$B*l$R+l$n*l$b,l$w.tx=l$_*l$f+l$r*l$J+l$z,l$w.ty=l$R*l$f+l$b*l$J+l$L):(l$w.a=l$x*l$_,l$w.b=l$P*l$b,l$w.c=l$B*l$_,l$w.d=l$n*l$b,l$w.tx=l$_*l$f+l$z,l$w.ty=l$b*l$J+l$L),l$w},l$R.mulPos=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){var l$x=l$i.a,l$P=l$i.b,l$B=l$i.c,l$n=l$i.d,l$f=l$i.tx,l$J=l$i.ty;return 0!==l$P||0!==l$B?(l$w.a=l$_*l$x+l$R*l$B,l$w.b=l$_*l$P+l$R*l$n,l$w.c=l$r*l$x+l$b*l$B,l$w.d=l$r*l$P+l$b*l$n,l$w.tx=l$x*l$z+l$B*l$L+l$f,l$w.ty=l$P*l$z+l$n*l$L+l$J):(l$w.a=l$_*l$x,l$w.b=l$R*l$n,l$w.c=l$r*l$x,l$w.d=l$b*l$n,l$w.tx=l$x*l$z+l$f,l$w.ty=l$n*l$L+l$J),l$w},l$R.preMul=function(l$i,l$_,l$R){var l$r=l$i.a,l$b=l$i.b,l$z=l$i.c,l$L=l$i.d,l$w=l$_.a,l$x=l$_.b,l$P=l$_.c,l$B=l$_.d,l$n=l$_.tx,l$f=l$_.ty;return l$R.a=l$w*l$r,l$R.b=l$R.c=0,l$R.d=l$B*l$L,l$R.tx=l$n*l$r+l$i.tx,l$R.ty=l$f*l$L+l$i.ty,0===l$x&&0===l$P&&0===l$b&&0===l$z||(l$R.a+=l$x*l$z,l$R.d+=l$P*l$b,l$R.b+=l$w*l$b+l$x*l$L,l$R.c+=l$P*l$r+l$B*l$z,l$R.tx+=l$f*l$z,l$R.ty+=l$n*l$b),l$R},l$R.preMulXY=function(l$i,l$_,l$R,l$r){var l$b=l$i.a,l$z=l$i.b,l$L=l$i.c,l$w=l$i.d;return l$r.a=l$b,l$r.b=l$z,l$r.c=l$L,l$r.d=l$w,l$r.tx=l$_*l$b+l$i.tx+l$R*l$L,l$r.ty=l$R*l$w+l$i.ty+l$_*l$z,l$r},l$R.create=function(){var l$i=l$R._cache,l$_=l$i._length?l$i[--l$i._length]:new l$R;return l$_.inPool=!1,l$_},l$R.EMPTY=new l$R,l$R.TEMP=new l$R,l$R._cache=[],l$R}(),l$Z=function(){function l$i(l$i,l$_){void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),this.x=l$i,this.y=l$_}l$B(l$i,"laya.maths.Point");var l$_=l$i.prototype;return l$_.setTo=function(l$i,l$_){return this.x=l$i,this.y=l$_,this},l$_.distance=function(l$i,l$_){return Math.sqrt((this.x-l$i)*(this.x-l$i)+(this.y-l$_)*(this.y-l$_))},l$_.toString=function(){return this.x+","+this.y},l$_.normalize=function(){var l$i=Math.sqrt(this.x*this.x+this.y*this.y);if(0<l$i){var l$_=1/l$i;this.x*=l$_,this.y*=l$_}},l$i.TEMP=new l$i,l$i.EMPTY=new l$i,l$i}(),l$q=function(){function l$P(l$i,l$_,l$R,l$r){void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=0),this.x=l$i,this.y=l$_,this.width=l$R,this.height=l$r}l$B(l$P,"laya.maths.Rectangle");var l$i=l$P.prototype;return l$i.setTo=function(l$i,l$_,l$R,l$r){return this.x=l$i,this.y=l$_,this.width=l$R,this.height=l$r,this},l$i.copyFrom=function(l$i){return this.x=l$i.x,this.y=l$i.y,this.width=l$i.width,this.height=l$i.height,this},l$i.contains=function(l$i,l$_){return!(this.width<=0||this.height<=0)&&(l$i>=this.x&&l$i<this.right&&l$_>=this.y&&l$_<this.bottom)},l$i.intersects=function(l$i){return!(l$i.x>this.x+this.width||l$i.x+l$i.width<this.x||l$i.y>this.y+this.height||l$i.y+l$i.height<this.y)},l$i.intersection=function(l$i,l$_){return this.intersects(l$i)?(l$_||(l$_=new l$P),l$_.x=Math.max(this.x,l$i.x),l$_.y=Math.max(this.y,l$i.y),l$_.width=Math.min(this.right,l$i.right)-l$_.x,l$_.height=Math.min(this.bottom,l$i.bottom)-l$_.y,l$_):null},l$i.union=function(l$i,l$_){return l$_||(l$_=new l$P),this.clone(l$_),l$i.width<=0||l$i.height<=0?l$_:(l$_.addPoint(l$i.x,l$i.y),l$_.addPoint(l$i.right,l$i.bottom),this)},l$i.clone=function(l$i){return l$i||(l$i=new l$P),l$i.x=this.x,l$i.y=this.y,l$i.width=this.width,l$i.height=this.height,l$i},l$i.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},l$i.equals=function(l$i){return!(!l$i||l$i.x!==this.x||l$i.y!==this.y||l$i.width!==this.width||l$i.height!==this.height)},l$i.addPoint=function(l$i,l$_){return this.x>l$i&&(this.width+=this.x-l$i,this.x=l$i),this.y>l$_&&(this.height+=this.y-l$_,this.y=l$_),this.width<l$i-this.x&&(this.width=l$i-this.x),this.height<l$_-this.y&&(this.height=l$_-this.y),this},l$i._getBoundPoints=function(){var l$i=l$P._temB;return(l$i.length=0)==this.width||0==this.height||l$i.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),l$i},l$i.isEmpty=function(){return this.width<=0||this.height<=0},l$h(0,l$i,"right",function(){return this.x+this.width}),l$h(0,l$i,"bottom",function(){return this.y+this.height}),l$P._getBoundPointS=function(l$i,l$_,l$R,l$r){var l$b=l$P._temA;return(l$b.length=0)==l$R||0==l$r||l$b.push(l$i,l$_,l$i+l$R,l$_,l$i,l$_+l$r,l$i+l$R,l$_+l$r),l$b},l$P._getWrapRec=function(l$i,l$_){if(!l$i||l$i.length<1)return l$_?l$_.setTo(0,0,0,0):l$P.TEMP.setTo(0,0,0,0);l$_=l$_||new l$P;var l$R,l$r,l$b,l$z,l$L,l$w=l$i.length,l$x=l$Z.TEMP;for(l$b=l$L=-(l$r=l$z=99999),l$R=0;l$R<l$w;l$R+=2)l$x.x=l$i[l$R],l$x.y=l$i[l$R+1],l$r=l$r<l$x.x?l$r:l$x.x,l$z=l$z<l$x.y?l$z:l$x.y,l$b=l$b>l$x.x?l$b:l$x.x,l$L=l$L>l$x.y?l$L:l$x.y;return l$_.setTo(l$r,l$z,l$b-l$r,l$L-l$z)},l$P.EMPTY=new l$P,l$P.TEMP=new l$P,l$P._temB=[],l$P._temA=[],l$P}(),l$v=function(){function l$x(){}return l$B(l$x,"laya.media.SoundManager"),l$h(1,l$x,"useAudioMusic",function(){return l$x._useAudioMusic},function(l$i){l$x._useAudioMusic=l$i,l$x._musicClass=l$i?l$Ri:null}),l$h(1,l$x,"autoStopMusic",function(){return l$x._autoStopMusic},function(l$i){l$A.stage.off("blur",null,l$x._stageOnBlur),l$A.stage.off("focus",null,l$x._stageOnFocus),l$A.stage.off("visibilitychange",null,l$x._visibilityChange),(l$x._autoStopMusic=l$i)&&(l$A.stage.on("blur",null,l$x._stageOnBlur),l$A.stage.on("focus",null,l$x._stageOnFocus),l$A.stage.on("visibilitychange",null,l$x._visibilityChange))}),l$h(1,l$x,"muted",function(){return l$x._muted},function(l$i){l$i!=l$x._muted&&(l$i&&l$x.stopAllSound(),l$x.musicMuted=l$i,l$x._muted=l$i)}),l$h(1,l$x,"musicMuted",function(){return l$x._musicMuted},function(l$i){l$i!=l$x._musicMuted&&(l$i?(l$x._tMusic&&l$x._musicChannel&&!l$x._musicChannel.isStopped?l$x._musicChannel.pause():l$x._musicChannel=null,l$x._musicMuted=l$i):(l$x._musicMuted=l$i,l$x._tMusic&&l$x._musicChannel&&l$x._musicChannel.resume()))}),l$h(1,l$x,"soundMuted",function(){return l$x._soundMuted},function(l$i){l$x._soundMuted=l$i}),l$x.addChannel=function(l$i){0<=l$x._channels.indexOf(l$i)||(l$x._channels.push(l$i),l$x.autoReleaseSound&&0!=l$x._notUsedCount&&l$x._notUsedUrls[l$i.url]&&(delete l$x._notUsedUrls[l$i.url],0==--l$x._notUsedCount&&l$A.timer.clear(l$x,l$x.disposeSoundIfNotUsed)))},l$x.removeChannel=function(l$i){var l$_=l$x._channels,l$R=l$_.indexOf(l$i);if(-1!=l$R&&(l$_.splice(l$R,1),l$x.autoReleaseSound)){var l$r=l$i.url,l$b=l$x.defaultIntervals[l$r]||2e4;if(0<l$b){var l$z=!0;for(l$R=l$_.length-1;0<=l$R;l$R--)if(l$_[l$R].url==l$r){l$z=!1;break}l$z&&(l$x._notUsedUrls[l$r]=Date.now()+l$b,0==l$x._notUsedCount++&&l$A.timer.loop(1e4,l$x,l$x.disposeSoundIfNotUsed))}}},l$x.disposeSoundIfNotUsed=function(){var l$i=l$x._notUsedUrls;if(0!=l$x._notUsedCount){var l$_=Date.now();for(var l$R in l$i)l$_>=l$i[l$R]&&(delete l$i[l$R],--l$x._notUsedCount,l$x.destroySound(l$R));if(0!=l$x._notUsedCount)return}l$A.timer.clear(l$x,l$x.disposeSoundIfNotUsed)},l$x._visibilityChange=function(){l$A.stage.isVisibility?l$x._stageOnFocus():l$x._stageOnBlur()},l$x._stageOnBlur=function(){l$x._isActive=!1,l$x._musicChannel&&(l$x._musicChannel.isStopped||(l$x._blurPaused=!0,l$x._musicChannel.pause())),l$x.stopAllSound(),l$A.stage.once("mousedown",null,l$x._stageOnFocus)},l$x._recoverWebAudio=function(){l$zi.ctx&&"running"!=l$zi.ctx.state&&l$zi.ctx.resume&&l$zi.ctx.resume()},l$x._stageOnFocus=function(){if(l$x._isActive=!0,l$x._recoverWebAudio(),l$A.stage.off("mousedown",null,l$x._stageOnFocus),l$x._blurPaused){var l$i=l$x._musicChannel;l$i&&l$x._music&&l$i.isStopped&&(l$x._blurPaused=!1,l$x._music._disposed?l$x.playMusic(l$i.url,l$i.loops,l$i.startHandler,l$i.completeHandler,l$i.startTime):l$i.audioBuffer?l$i.resume():l$x._music.play(l$i.startTime,l$i.loops,l$i.startHandler,l$i))}},l$x.playSound=function(l$i,l$_,l$R,l$r,l$b,l$z){if(void 0===l$_&&(l$_=1),void 0===l$z&&(l$z=0),!l$i)return null;if(l$x._muted)return null;if(l$x._recoverWebAudio(),l$i==l$x._tMusic){if(l$x._musicMuted)return null}else{if(!l$x._isActive)return null;if(l$x._soundMuted)return null}var l$L,l$w=l$x._pool[l$i];return l$b||(l$b=l$x._soundClass),l$w||((l$w=new l$b).load(l$i),l$x._pool[l$i]=l$w),(l$L=l$w.play(l$z,l$_,l$R))?(l$i==l$x._tMusic&&(l$x._music=l$w,l$x._isActive||(l$x._blurPaused=!0,l$L.pause())),l$L.url=l$i,l$L.volume=l$i==l$x._tMusic?l$x.musicVolume:l$x.soundVolume,l$L.completeHandler=l$r,l$L):null},l$x.destroySound=function(l$i){var l$_=l$x._pool[l$i];l$_&&(delete l$x._pool[l$i],l$_.dispose())},l$x.playMusic=function(l$i,l$_,l$R,l$r,l$b){return void 0===l$_&&(l$_=0),void 0===l$b&&(l$b=0),l$x._tMusic=l$i,l$x._musicChannel&&l$x._musicChannel.stop(),l$x._musicChannel=l$x.playSound(l$i,l$_,l$R,l$r,null,l$b)},l$x.stopSound=function(l$i){for(var l$_,l$R=l$x._channels.length-1;0<=l$R;l$R--)(l$_=l$x._channels[l$R]).url==l$i&&l$_.stop()},l$x.stopAll=function(){l$x._tMusic=null;var l$i=0;for(l$i=l$x._channels.length-1;0<=l$i;l$i--)l$x._channels[l$i].stop()},l$x.stopAllSound=function(){var l$i,l$_=0;for(l$_=l$x._channels.length-1;0<=l$_;l$_--)(l$i=l$x._channels[l$_]).url!=l$x._tMusic&&l$i.stop()},l$x.stopMusic=function(){l$x._musicChannel&&l$x._musicChannel.stop(),l$x._tMusic=null},l$x.setSoundVolume=function(l$i,l$_){if(l$_)l$x._setVolume(l$_,l$i);else{l$x.soundVolume=l$i;var l$R,l$r=0;for(l$r=l$x._channels.length-1;0<=l$r;l$r--)(l$R=l$x._channels[l$r]).url!=l$x._tMusic&&(l$R.volume=l$i)}},l$x.setMusicVolume=function(l$i){l$x.musicVolume=l$i,l$x._setVolume(l$x._tMusic,l$i)},l$x._setVolume=function(l$i,l$_){for(var l$R,l$r=l$x._channels.length-1;0<=l$r;l$r--)(l$R=l$x._channels[l$r]).url==l$i&&(l$R.volume=l$_)},l$x.musicVolume=1,l$x.soundVolume=1,l$x.playbackRate=1,l$x._useAudioMusic=!0,l$x._muted=!1,l$x._soundMuted=!1,l$x._musicMuted=!1,l$x._tMusic=null,l$x._musicChannel=null,l$x._music=null,l$x._channels=[],l$x._autoStopMusic=!1,l$x._blurPaused=!1,l$x._isActive=!0,l$x._soundClass=null,l$x._musicClass=null,l$x.autoReleaseSound=!0,l$x._pool={},l$x.defaultIntervals={},l$x._notUsedUrls={},l$x._notUsedCount=0,l$x}(),l$j=function(){var l$i;function l$R(){}return l$B(l$R,"laya.net.LocalStorage"),l$R.__init__=function(){l$R._baseClass||(l$R._baseClass=l$i).init(),l$R.items=l$R._baseClass.items,l$R.support=l$R._baseClass.support},l$R.setItem=function(l$i,l$_){l$R._baseClass.setItem(l$i,l$_)},l$R.getItem=function(l$i){return l$R._baseClass.getItem(l$i)},l$R.setJSON=function(l$i,l$_){l$R._baseClass.setJSON(l$i,l$_)},l$R.getJSON=function(l$i){return l$R._baseClass.getJSON(l$i)},l$R.removeItem=function(l$i){l$R._baseClass.removeItem(l$i)},l$R.clear=function(){l$R._baseClass.clear()},l$R._baseClass=null,l$R.items=null,l$R.support=!1,l$R.__init$=function(){l$i=function(){function l$R(){}return l$B(l$R,""),l$R.init=function(){try{l$R.support=!0,l$R.items=l$L.localStorage,l$R.setItem("laya","1"),l$R.removeItem("laya")}catch(l$i){l$R.support=!1}l$R.support||console.log("LocalStorage is not supprot or browser is private mode.")},l$R.setItem=function(l$i,l$_){try{l$R.support&&l$R.items.setItem(l$i,l$_)}catch(l$i){console.warn("set localStorage failed",l$i)}},l$R.getItem=function(l$i){return l$R.support?l$R.items.getItem(l$i):null},l$R.setJSON=function(l$i,l$_){try{l$R.support&&l$R.items.setItem(l$i,JSON.stringify(l$_))}catch(l$i){console.warn("set localStorage failed",l$i)}},l$R.getJSON=function(l$i){return JSON.parse(l$R.support?l$R.items.getItem(l$i):null)},l$R.removeItem=function(l$i){l$R.support&&l$R.items.removeItem(l$i)},l$R.clear=function(){l$R.support&&l$R.items.clear()},l$R.items=null,l$R.support=!1,l$R}()},l$R}(),l$u=(function(){function l$r(){}l$B(l$r,"laya.net.ResourceVersion"),l$r.enable=function(l$i,l$_,l$R){void 0===l$R&&(l$R=2),laya.net.ResourceVersion.type=l$R,l$A.loader.load(l$i,l$t.create(null,l$r.onManifestLoaded,[l$_]),null,"json"),l$o.customFormat=l$r.addVersionPrefix},l$r.onManifestLoaded=function(l$i,l$_){l$r.manifest=l$_,l$i.run(),l$_||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},l$r.addVersionPrefix=function(l$i){return l$r.manifest&&l$r.manifest[l$i]?2==l$r.type?l$r.manifest[l$i]:l$r.manifest[l$i]+"/"+l$i:l$i},l$r.FOLDER_VERSION=1,l$r.FILENAME_VERSION=2,l$r.manifest=null,l$r.type=1}(),function(){function l$i(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}l$B(l$i,"laya.net.TTFLoader");var l$_=l$i.prototype;return l$_.load=function(l$i){var l$_=(this._url=l$i).split(".ttf")[0].split("/");this.fontName=l$_[l$_.length-1],l$s.window.conch?this._loadConch():l$s.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},l$_._loadConch=function(){this._http=new l$Li,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},l$_._onHttpLoaded=function(l$i){l$s.window.conch.setFontFaceFromBuffer(this.fontName,l$i),this._clearHttp(),this._complete()},l$_._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},l$_._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},l$_._complete=function(){l$A.timer.clear(this,this._complete),l$A.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},l$_._checkComplete=function(){l$$.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},l$_._loadWithFontFace=function(){var l$i=new l$s.window.FontFace(this.fontName,"url('"+this._url+"')");l$s.window.document.fonts.add(l$i);var l$_=this;l$i.loaded.then(function(){l$_._complete()}),l$i.load()},l$_._createDiv=function(){this._div=l$s.createElement("div"),this._div.innerHTML="laya";var l$i=this._div.style;l$i.fontFamily=this.fontName,l$i.position="absolute",l$i.left="-100px",l$i.top="-100px",l$s.document.body.appendChild(this._div)},l$_._loadWithCSS=function(){var l$i=this,l$_=l$s.createElement("style");l$_.type="text/css",l$s.document.body.appendChild(l$_),l$_.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=l$$.measureText("LayaTTFFont",this._fontTxt).width;var l$R=this;l$_.onload=function(){l$A.timer.once(1e4,l$R,l$i._complete)},l$A.timer.loop(20,this,this._checkComplete),this._createDiv()},l$i._testString="LayaTTFFont",l$i}()),l$o=function(){function l$r(l$i){this._url=null,this._path=null,this._url=l$r.formatURL(l$i),this._path=l$r.getPath(l$i)}l$B(l$r,"laya.net.URL");var l$i=l$r.prototype;return l$h(0,l$i,"path",function(){return this._path}),l$h(0,l$i,"url",function(){return this._url}),l$r.formatURL=function(l$i,l$_){if(!l$i)return"null path";if(0<l$i.indexOf(":"))return l$i;null!=l$r.customFormat&&(l$i=l$r.customFormat(l$i,l$_));var l$R=l$i.charAt(0);if("."===l$R)return l$r.formatRelativePath((l$_||l$r.basePath)+l$i);if("~"===l$R)return l$r.rootPath+l$i.substring(1);if("d"===l$R){if(0===l$i.indexOf("data:image"))return l$i}else if("/"===l$R)return l$i;return(l$_||l$r.basePath)+l$i},l$r.formatRelativePath=function(l$i){for(var l$_=l$i.split("/"),l$R=0,l$r=l$_.length;l$R<l$r;l$R++)".."==l$_[l$R]&&(l$_.splice(l$R-1,2),l$R-=2);return l$_.join("/")},l$r.isAbsolute=function(l$i){return 0<l$i.indexOf(":")||"/"==l$i.charAt(0)},l$r.getPath=function(l$i){var l$_=l$i.lastIndexOf("/");return 0<l$_?l$i.substr(0,l$_+1):""},l$r.getFileName=function(l$i){var l$_=l$i.lastIndexOf("/");return 0<l$_?l$i.substr(l$_+1):l$i},l$r.version={},l$r.basePath="",l$r.rootPath="",l$r.customFormat=function(l$i){var l$_=l$r.version[l$i];return!l$p.isConchApp&&l$_&&(l$i+="?v="+l$_),l$i},l$r}(),l$p=function(){function l$b(l$i,l$_){this._timeId=0;var l$R=l$b._mainCanvas.source.style;l$R.position="absolute",l$R.top=l$R.left="0px",l$R.background="#000000",l$b._mainCanvas.source.id="layaCanvas";var l$r=laya.renders.Render.isWebGL;l$b._mainCanvas.source.width=l$i,l$b._mainCanvas.source.height=l$_,l$r&&l$b.WebGL.init(l$b._mainCanvas,l$i,l$_),l$s.container.appendChild(l$b._mainCanvas.source),(l$b._context=new l$k(l$i,l$_,l$r?null:l$b._mainCanvas)).ctx.setIsMainContext(),l$s.window.requestAnimationFrame(function l$i(l$_){l$s.window.requestAnimationFrame(l$i);l$A.stage._loop()}),l$A.stage.on("visibilitychange",this,this._onVisibilitychange)}l$B(l$b,"laya.renders.Render");var l$i=l$b.prototype;return l$i._onVisibilitychange=function(){l$A.stage.isVisibility?0!=this._timeId&&l$s.window.clearInterval(this._timeId):this._timeId=l$s.window.setInterval(this._enterFrame,1e3)},l$i._enterFrame=function(l$i){l$A.stage._loop()},l$h(1,l$b,"context",function(){return l$b._context}),l$h(1,l$b,"canvas",function(){return l$b._mainCanvas.source}),l$b._context=null,l$b._mainCanvas=null,l$b.WebGL=null,l$b.isConchNode=!1,l$b.isConchApp=!1,l$b.isConchWebGL=!1,l$b.isWebGL=!1,l$b.is3DMode=!1,l$b.optimizeTextureMemory=function(l$i,l$_){return!0},l$b.__init$=function(){l$L.ConchRenderType=l$L.ConchRenderType||1,l$L.ConchRenderType|=l$L.conch?4:0,l$b.isConchNode=5==(5&l$L.ConchRenderType),l$b.isConchApp=4==(4&l$L.ConchRenderType),l$b.isConchWebGL=6==l$L.ConchRenderType},l$b}(),l$k=function(){function l$L(l$i,l$_,l$R){this.x=0,this.y=0,this._drawTexture=function(l$i,l$_,l$R){l$R[0].loaded&&this.ctx.drawTexture(l$R[0],l$R[1],l$R[2],l$R[3],l$R[4],l$i,l$_)},this._fillTexture=function(l$i,l$_,l$R){l$R[0].loaded&&this.ctx.fillTexture(l$R[0],l$R[1]+l$i,l$R[2]+l$_,l$R[3],l$R[4],l$R[5],l$R[6],l$R[7])},this._drawTextureWithTransform=function(l$i,l$_,l$R){l$R[0].loaded&&this.ctx.drawTextureWithTransform(l$R[0],l$R[1],l$R[2],l$R[3],l$R[4],l$R[5],l$i,l$_,l$R[6])},this._fillQuadrangle=function(l$i,l$_,l$R){this.ctx.fillQuadrangle(l$R[0],l$R[1],l$R[2],l$R[3],l$R[4])},this._drawRect=function(l$i,l$_,l$R){var l$r=this.ctx;null!=l$R[4]&&(l$r.fillStyle=l$R[4],l$r.fillRect(l$i+l$R[0],l$_+l$R[1],l$R[2],l$R[3],null)),null!=l$R[5]&&(l$r.strokeStyle=l$R[5],l$r.lineWidth=l$R[6],l$r.strokeRect(l$i+l$R[0],l$_+l$R[1],l$R[2],l$R[3],l$R[6]))},this._drawPie=function(l$i,l$_,l$R){var l$r=this.ctx;l$p.isWebGL&&l$r.setPathId(l$R[8]),l$r.beginPath(),l$p.isWebGL?(l$r.movePath(l$R[0]+l$i,l$R[1]+l$_),l$r.moveTo(0,0)):l$r.moveTo(l$i+l$R[0],l$_+l$R[1]),l$r.arc(l$i+l$R[0],l$_+l$R[1],l$R[2],l$R[3],l$R[4]),l$r.closePath(),this._fillAndStroke(l$R[5],l$R[6],l$R[7],!0)},this._clipRect=function(l$i,l$_,l$R){this.ctx.clipRect(l$i+l$R[0],l$_+l$R[1],l$R[2],l$R[3])},this._fillRect=function(l$i,l$_,l$R){this.ctx.fillRect(l$i+l$R[0],l$_+l$R[1],l$R[2],l$R[3],l$R[4])},this._drawCircle=function(l$i,l$_,l$R){var l$r=this.ctx;l$p.isWebGL&&l$r.setPathId(l$R[6]),l$a.drawCall++,l$r.beginPath(),l$p.isWebGL&&l$r.movePath(l$R[0]+l$i,l$R[1]+l$_),l$r.arc(l$R[0]+l$i,l$R[1]+l$_,l$R[2],0,l$L.PI2),l$r.closePath(),this._fillAndStroke(l$R[3],l$R[4],l$R[5],!0)},this._fillCircle=function(l$i,l$_,l$R){l$a.drawCall++;var l$r=this.ctx;l$r.beginPath(),l$r.fillStyle=l$R[3],l$r.arc(l$R[0]+l$i,l$R[1]+l$_,l$R[2],0,l$L.PI2),l$r.fill()},this._setShader=function(l$i,l$_,l$R){this.ctx.setShader(l$R[0])},this._drawLine=function(l$i,l$_,l$R){var l$r=this.ctx;l$p.isWebGL&&l$r.setPathId(l$R[6]),l$r.beginPath(),l$r.strokeStyle=l$R[4],l$r.lineWidth=l$R[5],l$p.isWebGL?(l$r.movePath(l$i,l$_),l$r.moveTo(l$R[0],l$R[1]),l$r.lineTo(l$R[2],l$R[3])):(l$r.moveTo(l$i+l$R[0],l$_+l$R[1]),l$r.lineTo(l$i+l$R[2],l$_+l$R[3])),l$r.stroke()},this._drawLines=function(l$i,l$_,l$R){var l$r=this.ctx;l$p.isWebGL&&l$r.setPathId(l$R[5]),l$r.beginPath(),l$i+=l$R[0],l$_+=l$R[1],l$p.isWebGL&&l$r.movePath(l$i,l$_),l$r.strokeStyle=l$R[3],l$r.lineWidth=l$R[4];var l$b=l$R[2],l$z=2,l$L=l$b.length;if(l$p.isWebGL)for(l$r.moveTo(l$b[0],l$b[1]);l$z<l$L;)l$r.lineTo(l$b[l$z++],l$b[l$z++]);else for(l$r.moveTo(l$i+l$b[0],l$_+l$b[1]);l$z<l$L;)l$r.lineTo(l$i+l$b[l$z++],l$_+l$b[l$z++]);l$r.stroke()},this._drawLinesWebGL=function(l$i,l$_,l$R){this.ctx.drawLines(l$i+this.x+l$R[0],l$_+this.y+l$R[1],l$R[2],l$R[3],l$R[4])},this._drawCurves=function(l$i,l$_,l$R){this.ctx.drawCurves(l$i,l$_,l$R)},this._draw=function(l$i,l$_,l$R){l$R[0].call(null,this,l$i,l$_)},this._transformByMatrix=function(l$i,l$_,l$R){this.ctx.transformByMatrix(l$R[0])},this._setTransform=function(l$i,l$_,l$R){this.ctx.setTransform(l$R[0],l$R[1],l$R[2],l$R[3],l$R[4],l$R[5])},this._setTransformByMatrix=function(l$i,l$_,l$R){this.ctx.setTransformByMatrix(l$R[0])},this._save=function(l$i,l$_,l$R){this.ctx.save()},this._restore=function(l$i,l$_,l$R){this.ctx.restore()},this._translate=function(l$i,l$_,l$R){this.ctx.translate(l$R[0],l$R[1])},this._transform=function(l$i,l$_,l$R){this.ctx.translate(l$R[1]+l$i,l$R[2]+l$_);var l$r=l$R[0];this.ctx.transform(l$r.a,l$r.b,l$r.c,l$r.d,l$r.tx,l$r.ty),this.ctx.translate(-l$i-l$R[1],-l$_-l$R[2])},this._rotate=function(l$i,l$_,l$R){this.ctx.translate(l$R[1]+l$i,l$R[2]+l$_),this.ctx.rotate(l$R[0]),this.ctx.translate(-l$i-l$R[1],-l$_-l$R[2])},this._scale=function(l$i,l$_,l$R){this.ctx.translate(l$R[2]+l$i,l$R[3]+l$_),this.ctx.scale(l$R[0],l$R[1]),this.ctx.translate(-l$i-l$R[2],-l$_-l$R[3])},this._alpha=function(l$i,l$_,l$R){this.ctx.globalAlpha*=l$R[0]},this._setAlpha=function(l$i,l$_,l$R){this.ctx.globalAlpha=l$R[0]},this._fillText=function(l$i,l$_,l$R){this.ctx.fillText(l$R[0],l$R[1]+l$i,l$R[2]+l$_,l$R[3],l$R[4],l$R[5])},this._strokeText=function(l$i,l$_,l$R){this.ctx.strokeText(l$R[0],l$R[1]+l$i,l$R[2]+l$_,l$R[3],l$R[4],l$R[5],l$R[6])},this._fillBorderText=function(l$i,l$_,l$R){this.ctx.fillBorderText(l$R[0],l$R[1]+l$i,l$R[2]+l$_,l$R[3],l$R[4],l$R[5],l$R[6],l$R[7])},this._blendMode=function(l$i,l$_,l$R){this.ctx.globalCompositeOperation=l$R[0]},this._beginClip=function(l$i,l$_,l$R){this.ctx.beginClip&&this.ctx.beginClip(l$i+l$R[0],l$_+l$R[1],l$R[2],l$R[3])},this._setIBVB=function(l$i,l$_,l$R){this.ctx.setIBVB(l$R[0]+l$i,l$R[1]+l$_,l$R[2],l$R[3],l$R[4],l$R[5],l$R[6],l$R[7])},this._fillTrangles=function(l$i,l$_,l$R){this.ctx.fillTrangles(l$R[0],l$R[1]+l$i,l$R[2]+l$_,l$R[3],l$R[4])},this._drawPath=function(l$i,l$_,l$R){var l$r=this.ctx;l$p.isWebGL&&l$r.setPathId(-1),l$r.beginPath(),l$i+=l$R[0],l$_+=l$R[1],l$p.isWebGL&&l$r.movePath(l$i,l$_);for(var l$b=l$R[2],l$z=0,l$L=l$b.length;l$z<l$L;l$z++){var l$w=l$b[l$z];switch(l$w[0]){case"moveTo":l$p.isWebGL?l$r.moveTo(l$w[1],l$w[2]):l$r.moveTo(l$i+l$w[1],l$_+l$w[2]);break;case"lineTo":l$p.isWebGL?l$r.lineTo(l$w[1],l$w[2]):l$r.lineTo(l$i+l$w[1],l$_+l$w[2]);break;case"arcTo":l$p.isWebGL?l$r.arcTo(l$w[1],l$w[2],l$w[3],l$w[4],l$w[5]):l$r.arcTo(l$i+l$w[1],l$_+l$w[2],l$i+l$w[3],l$_+l$w[4],l$w[5]);break;case"closePath":l$r.closePath()}}var l$x=l$R[3];null!=l$x&&(l$r.fillStyle=l$x.fillStyle,l$r.fill());var l$P=l$R[4];null!=l$P&&(l$r.strokeStyle=l$P.strokeStyle,l$r.lineWidth=l$P.lineWidth||1,l$r.lineJoin=l$P.lineJoin,l$r.lineCap=l$P.lineCap,l$r.miterLimit=l$P.miterLimit,l$r.stroke())},this.drawPoly=function(l$i,l$_,l$R){this.ctx.drawPoly(l$i+this.x+l$R[0],l$_+this.y+l$R[1],l$R[2],l$R[3],l$R[4],l$R[5],l$R[6])},this._drawPoly=function(l$i,l$_,l$R){var l$r=this.ctx,l$b=l$R[2],l$z=2,l$L=l$b.length;if(l$p.isWebGL)for(l$r.setPathId(l$R[6]),l$r.beginPath(),l$i+=l$R[0],l$_+=l$R[1],l$r.movePath(l$i,l$_),l$r.moveTo(l$b[0],l$b[1]);l$z<l$L;)l$r.lineTo(l$b[l$z++],l$b[l$z++]);else for(l$r.beginPath(),l$i+=l$R[0],l$_+=l$R[1],l$r.moveTo(l$i+l$b[0],l$_+l$b[1]);l$z<l$L;)l$r.lineTo(l$i+l$b[l$z++],l$_+l$b[l$z++]);l$r.closePath(),this._fillAndStroke(l$R[3],l$R[4],l$R[5],l$R[7])},this._drawSkin=function(l$i,l$_,l$R){var l$r=l$R[0];if(l$r){var l$b=this.ctx;l$r.render(l$b,l$i,l$_)}},this._drawParticle=function(l$i,l$_,l$R){this.ctx.drawParticle(l$i+this.x,l$_+this.y,l$R[0])},this._setFilters=function(l$i,l$_,l$R){this.ctx.setFilters(l$R)},l$R?this.ctx=l$R.getContext("2d"):(l$R=l$Ii.create("3D"),this.ctx=l$$.createWebGLContext2D(l$R),l$R._setContext(this.ctx)),l$R.size(l$i,l$_),this.canvas=l$R}l$B(l$L,"laya.renders.RenderContext");var l$i=l$L.prototype;return l$i.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},l$i.drawTexture=function(l$i,l$_,l$R,l$r,l$b){l$i.loaded&&this.ctx.drawTexture(l$i,l$_,l$R,l$r,l$b,this.x,this.y)},l$i._drawTextures=function(l$i,l$_,l$R){l$R[0].loaded&&this.ctx.drawTextures(l$R[0],l$R[1],l$i+this.x,l$_+this.y)},l$i.drawTextureWithTransform=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){l$i.loaded&&this.ctx.drawTextureWithTransform(l$i,l$_,l$R,l$r,l$b,l$z,this.x,this.y,l$L)},l$i.fillQuadrangle=function(l$i,l$_,l$R,l$r,l$b){this.ctx.fillQuadrangle(l$i,l$_,l$R,l$r,l$b)},l$i.drawCanvas=function(l$i,l$_,l$R,l$r,l$b){this.ctx.drawCanvas(l$i,l$_+this.x,l$R+this.y,l$r,l$b)},l$i.drawRect=function(l$i,l$_,l$R,l$r,l$b,l$z){void 0===l$z&&(l$z=1);var l$L=this.ctx;l$L.strokeStyle=l$b,l$L.lineWidth=l$z,l$L.strokeRect(l$i+this.x,l$_+this.y,l$R,l$r,l$z)},l$i._fillAndStroke=function(l$i,l$_,l$R,l$r){void 0===l$r&&(l$r=!1);var l$b=this.ctx;null!=l$i&&(l$b.fillStyle=l$i,l$p.isWebGL?l$b.fill(l$r):l$b.fill()),null!=l$_&&0<l$R&&(l$b.strokeStyle=l$_,l$b.lineWidth=l$R,l$b.stroke())},l$i.clipRect=function(l$i,l$_,l$R,l$r){this.ctx.clipRect(l$i+this.x,l$_+this.y,l$R,l$r)},l$i.fillRect=function(l$i,l$_,l$R,l$r,l$b){this.ctx.fillRect(l$i+this.x,l$_+this.y,l$R,l$r,l$b)},l$i.drawCircle=function(l$i,l$_,l$R,l$r,l$b){void 0===l$b&&(l$b=1),l$a.drawCall++;var l$z=this.ctx;l$z.beginPath(),l$z.strokeStyle=l$r,l$z.lineWidth=l$b,l$z.arc(l$i+this.x,l$_+this.y,l$R,0,l$L.PI2),l$z.stroke()},l$i.drawTriangles=function(l$i,l$_,l$R){if(l$p.isWebGL)this.ctx.drawTriangles(l$R[0],l$i+l$R[1],l$_+l$R[2],l$R[3],l$R[4],l$R[5],l$R[6],l$R[7],l$R[8],l$R[9]);else{var l$r=l$R[5],l$b=0,l$z=l$r.length,l$L=this.ctx;for(l$b=0;l$b<l$z;l$b+=3){var l$w=2*l$r[l$b],l$x=2*l$r[l$b+1],l$P=2*l$r[l$b+2];l$L.drawTriangle(l$R[0],l$R[3],l$R[4],l$w,l$x,l$P,l$R[6],!0)}}},l$i.fillCircle=function(l$i,l$_,l$R,l$r){l$a.drawCall++;var l$b=this.ctx;l$b.beginPath(),l$b.fillStyle=l$r,l$b.arc(l$i+this.x,l$_+this.y,l$R,0,l$L.PI2),l$b.fill()},l$i.setShader=function(l$i){this.ctx.setShader(l$i)},l$i.drawLine=function(l$i,l$_,l$R,l$r,l$b,l$z){void 0===l$z&&(l$z=1);var l$L=this.ctx;l$L.beginPath(),l$L.strokeStyle=l$b,l$L.lineWidth=l$z,l$L.moveTo(this.x+l$i,this.y+l$_),l$L.lineTo(this.x+l$R,this.y+l$r),l$L.stroke()},l$i.clear=function(){this.ctx.clear()},l$i.transformByMatrix=function(l$i){this.ctx.transformByMatrix(l$i)},l$i.setTransform=function(l$i,l$_,l$R,l$r,l$b,l$z){this.ctx.setTransform(l$i,l$_,l$R,l$r,l$b,l$z)},l$i.setTransformByMatrix=function(l$i){this.ctx.setTransformByMatrix(l$i)},l$i.save=function(){this.ctx.save()},l$i.restore=function(){this.ctx.restore()},l$i.translate=function(l$i,l$_){this.ctx.translate(l$i,l$_)},l$i.transform=function(l$i,l$_,l$R,l$r,l$b,l$z){this.ctx.transform(l$i,l$_,l$R,l$r,l$b,l$z)},l$i.rotate=function(l$i){this.ctx.rotate(l$i)},l$i.scale=function(l$i,l$_){this.ctx.scale(l$i,l$_)},l$i.alpha=function(l$i){this.ctx.globalAlpha*=l$i},l$i.setAlpha=function(l$i){this.ctx.globalAlpha=l$i},l$i.fillWords=function(l$i,l$_,l$R,l$r,l$b,l$z){void 0===l$z&&(l$z=0),this.ctx.fillWords(l$i,l$_,l$R,l$r,l$b,l$z)},l$i.fillBorderWords=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this.ctx.fillBorderWords(l$i,l$_,l$R,l$r,l$b,l$z,l$L)},l$i.fillText=function(l$i,l$_,l$R,l$r,l$b,l$z){this.ctx.fillText(l$i,l$_+this.x,l$R+this.y,l$r,l$b,l$z)},l$i.strokeText=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this.ctx.strokeText(l$i,l$_+this.x,l$R+this.y,l$r,l$b,l$z,l$L)},l$i.blendMode=function(l$i){this.ctx.globalCompositeOperation=l$i},l$i.flush=function(){this.ctx.flush&&this.ctx.flush()},l$i.addRenderObject=function(l$i){this.ctx.addRenderObject(l$i)},l$i.beginClip=function(l$i,l$_,l$R,l$r){this.ctx.beginClip&&this.ctx.beginClip(l$i,l$_,l$R,l$r)},l$i.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},l$i.fillTrangles=function(l$i,l$_,l$R){this.ctx.fillTrangles(l$R[0],l$R[1],l$R[2],l$R[3],4<l$R.length?l$R[4]:null)},l$L.PI2=2*Math.PI,l$L}(),l$K=function(){function l$L(l$i,l$_){switch(this._next=l$_||l$L.NORENDER,l$i){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=l$X._filter);case 69905:return void(this._fun=l$L._initRenderFun)}this.onCreate(l$i)}l$B(l$L,"laya.renders.RenderSprite");var l$i=l$L.prototype;return l$i.onCreate=function(l$i){},l$i._style=function(l$i,l$_,l$R,l$r){l$i._style.render(l$i,l$_,l$R,l$r);var l$b=this._next;l$b._fun.call(l$b,l$i,l$_,l$R,l$r)},l$i._no=function(l$i,l$_,l$R,l$r){},l$i._custom=function(l$i,l$_,l$R,l$r){l$i.customRender(l$_,l$R,l$r);var l$b=l$i._style._tf;this._next._fun.call(this._next,l$i,l$_,l$R-l$b.translateX,l$r-l$b.translateY)},l$i._clip=function(l$i,l$_,l$R,l$r){var l$b=this._next;if(l$b!=l$L.NORENDER){var l$z=l$i._style.scrollRect;l$_.ctx.save(),l$_.ctx.clipRect(l$R,l$r,l$z.width,l$z.height),l$b._fun.call(l$b,l$i,l$_,l$R-l$z.x,l$r-l$z.y),l$_.ctx.restore()}},l$i._blend=function(l$i,l$_,l$R,l$r){var l$b=l$i._style;l$b.blendMode&&(l$_.ctx.globalCompositeOperation=l$b.blendMode);var l$z=this._next;l$z._fun.call(l$z,l$i,l$_,l$R,l$r),l$_.ctx.globalCompositeOperation="source-over"},l$i._mask=function(l$i,l$_,l$R,l$r){var l$b=this._next;l$b._fun.call(l$b,l$i,l$_,l$R,l$r);var l$z=l$i.mask;l$z&&(l$_.ctx.globalCompositeOperation="destination-in",(0<l$z.numChildren||!l$z.graphics._isOnlyOne())&&(l$z.cacheAsBitmap=!0),l$z.render(l$_,l$R-l$i.pivotX,l$r-l$i.pivotY)),l$_.ctx.globalCompositeOperation="source-over"},l$i._graphics=function(l$i,l$_,l$R,l$r){var l$b=l$i._style._tf;l$i._graphics&&l$i._graphics._render(l$i,l$_,l$R-l$b.translateX,l$r-l$b.translateY);var l$z=this._next;l$z._fun.call(l$z,l$i,l$_,l$R,l$r)},l$i._image=function(l$i,l$_,l$R,l$r){var l$b=l$i._style;l$_.ctx.drawTexture2(l$R,l$r,l$b._tf.translateX,l$b._tf.translateY,l$i.transform,l$b.alpha,l$b.blendMode,l$i._graphics._one)},l$i._image2=function(l$i,l$_,l$R,l$r){var l$b=l$i._style._tf;l$_.ctx.drawTexture2(l$R,l$r,l$b.translateX,l$b.translateY,l$i.transform,1,null,l$i._graphics._one)},l$i._alpha=function(l$i,l$_,l$R,l$r){var l$b;if(.01<(l$b=l$i._style.alpha)||l$i._needRepaint()){var l$z=l$_.ctx.globalAlpha;l$_.ctx.globalAlpha*=l$b;var l$L=this._next;l$L._fun.call(l$L,l$i,l$_,l$R,l$r),l$_.ctx.globalAlpha=l$z}},l$i._transform=function(l$i,l$_,l$R,l$r){var l$b=l$i.transform,l$z=this._next;l$b&&l$z!=l$L.NORENDER?(l$_.save(),l$_.transform(l$b.a,l$b.b,l$b.c,l$b.d,l$b.tx+l$R,l$b.ty+l$r),l$z._fun.call(l$z,l$i,l$_,0,0),l$_.restore()):l$z._fun.call(l$z,l$i,l$_,l$R,l$r)},l$i._childs=function(l$i,l$_,l$R,l$r){var l$b=l$i._style,l$z=l$b._tf;if(l$R=l$R-l$z.translateX+l$b.paddingLeft,l$r=l$r-l$z.translateY+l$b.paddingTop,l$b._calculation){var l$L=l$i._getWords();if(l$L){var l$w=l$b;l$w&&(l$w.stroke?l$_.fillBorderWords(l$L,l$R,l$r,l$w.font,l$w.color,l$w.strokeColor,l$w.stroke):l$_.fillWords(l$L,l$R,l$r,l$w.font,l$w.color,"none"!=l$w.textDecoration&&l$w.underLine?1:0))}}var l$x,l$P=l$i._childs,l$B=l$P.length;if(l$i.viewport||l$i.optimizeScrollRect&&l$i._style.scrollRect){var l$n=l$i.viewport||l$i._style.scrollRect,l$f=l$n.x,l$J=l$n.y,l$h=l$n.right,l$M=l$n.bottom,l$N=NaN,l$X=NaN;for(l$t=0;l$t<l$B;++l$t)(l$x=l$P[l$t]).visible&&(l$N=l$x._x)<l$h&&l$N+l$x.width>l$f&&(l$X=l$x._y)<l$M&&l$X+l$x.height>l$J&&l$x.render(l$_,l$R,l$r)}else for(var l$t=0;l$t<l$B;++l$t)(l$x=l$P[l$t])._style.visible&&l$x.render(l$_,l$R,l$r)},l$i._canvas=function(l$i,l$_,l$R,l$r){var l$b=l$i._$P.cacheCanvas;if(l$b){"bitmap"===l$b.type?l$a.canvasBitmap++:l$a.canvasNormal++;var l$z=l$b.ctx;if(l$i._needRepaint()||!l$z)this._canvas_repaint(l$i,l$_,l$R,l$r);else{var l$L=l$b._cacheRec;l$_.drawCanvas(l$z.canvas,l$R+l$L.x,l$r+l$L.y,l$L.width,l$L.height)}}else this._next._fun.call(this._next,l$i,l$_,l$R,l$r)},l$i._canvas_repaint=function(l$i,l$_,l$R,l$r){var l$b=l$i._$P.cacheCanvas,l$z=this._next;if(l$b){var l$L,l$w,l$x,l$P,l$B=l$b.ctx,l$n=l$i._needRepaint()||!l$B,l$f=l$b.type;if("bitmap"===l$f?l$a.canvasBitmap++:l$a.canvasNormal++,l$n){var l$J,l$h;l$b._cacheRec||(l$b._cacheRec=new l$q),l$p.isWebGL&&"bitmap"!==l$f?l$b._cacheRec.setTo(-l$i.pivotX,-l$i.pivotY,1,1):((l$P=l$i.getSelfBounds()).x=l$P.x-l$i.pivotX,l$P.y=l$P.y-l$i.pivotY,l$P.x=l$P.x-16,l$P.y=l$P.y-16,l$P.width=l$P.width+32,l$P.height=l$P.height+32,l$P.x=Math.floor(l$P.x+l$R)-l$R,l$P.y=Math.floor(l$P.y+l$r)-l$r,l$P.width=Math.floor(l$P.width),l$P.height=Math.floor(l$P.height),l$b._cacheRec.copyFrom(l$P)),l$P=l$b._cacheRec;var l$M,l$N=l$p.isWebGL?1:l$s.pixelRatio*l$A.stage.clientScaleX,l$X=l$p.isWebGL?1:l$s.pixelRatio*l$A.stage.clientScaleY;if(!l$p.isWebGL){var l$t,l$I=1,l$e=1;for(l$t=l$i;l$t&&l$t!=l$A.stage;)l$I*=l$t.scaleX,l$e*=l$t.scaleY,l$t=l$t.parent;l$p.isWebGL?(l$I<1&&(l$N*=l$I),l$e<1&&(l$X*=l$e)):(1<l$I&&(l$N*=l$I),1<l$e&&(l$X*=l$e))}if(l$i.scrollRect){var l$c=l$i.scrollRect;l$P.x-=l$c.x,l$P.y-=l$c.y}if(l$J=l$P.width*l$N,l$h=l$P.height*l$X,l$w=l$P.x,l$x=l$P.y,l$p.isWebGL&&"bitmap"===l$f&&(2048<l$J||2048<l$h))return console.warn("cache bitmap size larger than 2048,cache ignored"),l$b.ctx&&(l$y.recover("RenderContext",l$b.ctx),l$b.ctx.canvas.size(0,0),l$b.ctx=null),void l$z._fun.call(l$z,l$i,l$_,l$R,l$r);if(l$B||(l$B=l$b.ctx=l$y.getItem("RenderContext")||new l$k(l$J,l$h,l$Ii.create("AUTO"))),l$B.ctx.sprite=l$i,(l$L=l$B.canvas).clear(),(l$L.width!=l$J||l$L.height!=l$h)&&l$L.size(l$J,l$h),"bitmap"===l$f?l$L.context.asBitmap=!0:"normal"===l$f&&(l$L.context.asBitmap=!1),1!=l$N||1!=l$X){var l$l=l$B.ctx;l$l.save(),l$l.scale(l$N,l$X),!l$p.isConchWebGL&&l$p.isConchApp&&(l$M=l$i._$P.cf)&&l$l.setFilterMatrix&&l$l.setFilterMatrix(l$M._mat,l$M._alpha),l$z._fun.call(l$z,l$i,l$B,-l$w,-l$x),l$l.restore(),l$p.isConchApp&&!l$p.isConchWebGL||l$i._applyFilters()}else l$l=l$B.ctx,!l$p.isConchWebGL&&l$p.isConchApp&&(l$M=l$i._$P.cf)&&l$l.setFilterMatrix&&l$l.setFilterMatrix(l$M._mat,l$M._alpha),l$z._fun.call(l$z,l$i,l$B,-l$w,-l$x),l$p.isConchApp&&!l$p.isConchWebGL||l$i._applyFilters();l$i._$P.staticCache&&(l$b.reCache=!1),l$a.canvasReCache++}else l$w=(l$P=l$b._cacheRec).x,l$x=l$P.y,l$L=l$B.canvas;l$_.drawCanvas(l$L,l$R+l$w,l$r+l$x,l$P.width,l$P.height)}else l$z._fun.call(l$z,l$i,l$B,l$R,l$r)},l$L.__init__=function(){var l$i,l$_,l$R=0;for(l$_=l$$.createRenderSprite(69905,null),l$i=l$L.renders.length=4096,l$R=0;l$R<l$i;l$R++)l$L.renders[l$R]=l$_;l$L.renders[0]=l$$.createRenderSprite(0,null),function(l$i,l$_){for(var l$R=0,l$r=0;l$r<l$i.length;l$r++)l$R|=l$i[l$r],l$L.renders[l$R]=l$_}([1,512,4,2],new l$L(1,null)),l$L.renders[513]=l$$.createRenderSprite(513,null),l$L.renders[517]=new l$L(517,null)},l$L._initRenderFun=function(l$i,l$_,l$R,l$r){var l$b=l$i._renderType;(l$L.renders[l$b]=l$L._getTypeRender(l$b))._fun(l$i,l$_,l$R,l$r)},l$L._getTypeRender=function(l$i){for(var l$_=null,l$R=2048;1<l$R;)l$R&l$i&&(l$_=l$$.createRenderSprite(l$R,l$_)),l$R>>=1;return l$_},l$L.IMAGE=1,l$L.ALPHA=2,l$L.TRANSFORM=4,l$L.BLEND=8,l$L.CANVAS=16,l$L.FILTERS=32,l$L.MASK=64,l$L.CLIP=128,l$L.STYLE=256,l$L.GRAPHICS=512,l$L.CUSTOM=1024,l$L.CHILDS=2048,l$L.INIT=69905,l$L.renders=[],l$L.NORENDER=new l$L(0,null),l$L}(),l$O=function(){function l$w(){this._repaint=!1}l$B(l$w,"laya.resource.Context");var l$i=l$w.prototype;return l$i.replaceReset=function(){var l$i,l$_,l$R=0;for(l$i=l$w.replaceKeys.length,l$R=0;l$R<l$i;l$R++)l$_=l$w.replaceKeys[l$R],this[l$w.newKeys[l$R]]=this[l$_]},l$i.replaceResotre=function(){this.__restore(),this.__reset()},l$i.setIsMainContext=function(){},l$i.drawTextures=function(l$i,l$_,l$R,l$r){l$a.drawCall+=l$_.length/2;for(var l$b=l$i.width,l$z=l$i.height,l$L=0,l$w=l$_.length;l$L<l$w;l$L+=2)this.drawTexture(l$i,l$_[l$L],l$_[l$L+1],l$b,l$z,l$R,l$r)},l$i.drawCanvas=function(l$i,l$_,l$R,l$r,l$b){l$a.drawCall++,this.drawImage(l$i.source,l$_,l$R,l$r,l$b)},l$i.fillRect=function(l$i,l$_,l$R,l$r,l$b){l$a.drawCall++,l$b&&(this.fillStyle=l$b),this.__fillRect(l$i,l$_,l$R,l$r)},l$i.fillText=function(l$i,l$_,l$R,l$r,l$b,l$z){l$a.drawCall++,3<arguments.length&&null!=l$r&&(this.font=l$r,this.fillStyle=l$b,this.textAlign=l$z,this.textBaseline="top"),this.__fillText(l$i,l$_,l$R)},l$i.fillBorderText=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){l$a.drawCall++,this.font=l$r,this.fillStyle=l$b,this.textBaseline="top",this.strokeStyle=l$z,this.lineWidth=l$L,this.textAlign=l$w,this.__strokeText(l$i,l$_,l$R),this.__fillText(l$i,l$_,l$R)},l$i.strokeText=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){l$a.drawCall++,3<arguments.length&&null!=l$r&&(this.font=l$r,this.strokeStyle=l$b,this.lineWidth=l$z,this.textAlign=l$L,this.textBaseline="top"),this.__strokeText(l$i,l$_,l$R)},l$i.transformByMatrix=function(l$i){this.transform(l$i.a,l$i.b,l$i.c,l$i.d,l$i.tx,l$i.ty)},l$i.setTransformByMatrix=function(l$i){this.setTransform(l$i.a,l$i.b,l$i.c,l$i.d,l$i.tx,l$i.ty)},l$i.clipRect=function(l$i,l$_,l$R,l$r){l$a.drawCall++,this.beginPath(),this.rect(l$i,l$_,l$R,l$r),this.clip()},l$i.drawTexture=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){l$a.drawCall++;var l$w=l$i.uv,l$x=l$i.bitmap.width,l$P=l$i.bitmap.height;this.drawImage(l$i.source,l$w[0]*l$x,l$w[1]*l$P,(l$w[2]-l$w[0])*l$x,(l$w[5]-l$w[3])*l$P,l$_+l$z,l$R+l$L,l$r,l$b)},l$i.drawTextureWithTransform=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){l$a.drawCall++;var l$P=l$i.uv,l$B=l$i.bitmap.width,l$n=l$i.bitmap.height;this.save(),1!=l$x&&(this.globalAlpha*=l$x),l$z?(this.transform(l$z.a,l$z.b,l$z.c,l$z.d,l$z.tx+l$L,l$z.ty+l$w),this.drawImage(l$i.source,l$P[0]*l$B,l$P[1]*l$n,(l$P[2]-l$P[0])*l$B,(l$P[5]-l$P[3])*l$n,l$_,l$R,l$r,l$b)):this.drawImage(l$i.source,l$P[0]*l$B,l$P[1]*l$n,(l$P[2]-l$P[0])*l$B,(l$P[5]-l$P[3])*l$n,l$_+l$L,l$R+l$w,l$r,l$b),this.restore()},l$i.drawTexture2=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){var l$x=l$w[0];if(l$x.loaded&&l$x.bitmap&&l$x.source){l$a.drawCall++;var l$P=1!==l$z;if(l$P){var l$B=this.globalAlpha;this.globalAlpha*=l$z}var l$n=l$x.uv,l$f=l$x.bitmap.width,l$J=l$x.bitmap.height;l$b?(this.save(),this.transform(l$b.a,l$b.b,l$b.c,l$b.d,l$b.tx+l$i,l$b.ty+l$_),this.drawImage(l$x.source,l$n[0]*l$f,l$n[1]*l$J,(l$n[2]-l$n[0])*l$f,(l$n[5]-l$n[3])*l$J,l$w[1]-l$R,l$w[2]-l$r,l$w[3],l$w[4]),this.restore()):this.drawImage(l$x.source,l$n[0]*l$f,l$n[1]*l$J,(l$n[2]-l$n[0])*l$f,(l$n[5]-l$n[3])*l$J,l$w[1]-l$R+l$i,l$w[2]-l$r+l$_,l$w[3],l$w[4]),l$P&&(this.globalAlpha=l$B)}},l$i.fillTexture=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){if(!l$w.pat){if(l$i.uv!=l$Bi.DEF_UV){var l$x=new l$Ii("2D");l$x.getContext("2d"),l$x.size(l$i.width,l$i.height),l$x.context.drawTexture(l$i,0,0,l$i.width,l$i.height,0,0),l$i=new l$Bi(l$x)}l$w.pat=this.createPattern(l$i.bitmap.source,l$z)}var l$P=l$_,l$B=l$R,l$n=0,l$f=0;l$L&&(l$P+=l$L.x%l$i.width,l$B+=l$L.y%l$i.height,l$n-=l$L.x%l$i.width,l$f-=l$L.y%l$i.height),this.translate(l$P,l$B),this.fillRect(l$n,l$f,l$r,l$b,l$w.pat),this.translate(-l$P,-l$B)},l$i.drawTriangle=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){var l$x=l$i.bitmap,l$P=l$x.source,l$B=l$i.width,l$n=l$i.height,l$f=l$x.width,l$J=l$x.height,l$h=l$R[l$r]*l$f,l$M=l$R[l$b]*l$f,l$N=l$R[l$z]*l$f,l$X=l$R[l$r+1]*l$J,l$t=l$R[l$b+1]*l$J,l$I=l$R[l$z+1]*l$J,l$e=l$_[l$r],l$c=l$_[l$b],l$l=l$_[l$z],l$A=l$_[l$r+1],l$Z=l$_[l$b+1],l$q=l$_[l$z+1];if(l$w){var l$j=(l$e+l$c+l$l)/3,l$S=(l$A+l$Z+l$q)/3,l$v=l$e-l$j,l$$=l$A-l$S,l$G=Math.sqrt(l$v*l$v+l$$*l$$);l$e=l$j+l$v/l$G*(l$G+1),l$A=l$S+l$$/l$G*(l$G+1),l$$=l$Z-l$S,l$c=l$j+(l$v=l$c-l$j)/(l$G=Math.sqrt(l$v*l$v+l$$*l$$))*(l$G+1),l$Z=l$S+l$$/l$G*(l$G+1),l$$=l$q-l$S,l$l=l$j+(l$v=l$l-l$j)/(l$G=Math.sqrt(l$v*l$v+l$$*l$$))*(l$G+1),l$q=l$S+l$$/l$G*(l$G+1)}this.save(),l$L&&this.transform(l$L.a,l$L.b,l$L.c,l$L.d,l$L.tx,l$L.ty),this.beginPath(),this.moveTo(l$e,l$A),this.lineTo(l$c,l$Z),this.lineTo(l$l,l$q),this.closePath(),this.clip();var l$u=1/(l$h*l$t+l$X*l$N+l$M*l$I-l$t*l$N-l$X*l$M-l$h*l$I),l$o=l$e*l$t+l$X*l$l+l$c*l$I-l$t*l$l-l$X*l$c-l$e*l$I,l$p=l$h*l$c+l$e*l$N+l$M*l$l-l$c*l$N-l$e*l$M-l$h*l$l,l$k=l$h*l$t*l$l+l$X*l$c*l$N+l$e*l$M*l$I-l$e*l$t*l$N-l$X*l$M*l$l-l$h*l$c*l$I,l$K=l$A*l$t+l$X*l$q+l$Z*l$I-l$t*l$q-l$X*l$Z-l$A*l$I,l$O=l$h*l$Z+l$A*l$N+l$M*l$q-l$Z*l$N-l$A*l$M-l$h*l$q,l$E=l$h*l$t*l$q+l$X*l$Z*l$N+l$A*l$M*l$I-l$A*l$t*l$N-l$X*l$M*l$q-l$h*l$Z*l$I;this.transform(l$o*l$u,l$K*l$u,l$p*l$u,l$O*l$u,l$k*l$u,l$E*l$u),this.drawImage(l$P,l$i.uv[0]*l$f,l$i.uv[1]*l$J,l$B,l$n,l$i.uv[0]*l$f,l$i.uv[1]*l$J,l$B,l$n),this.restore()},l$i.flush=function(){return 0},l$i.fillWords=function(l$i,l$_,l$R,l$r,l$b,l$z){l$r&&(this.font=l$r),l$b&&(this.fillStyle=l$b);this.textBaseline="top",this.textAlign="left";for(var l$L=0,l$w=l$i.length;l$L<l$w;l$L++){var l$x=l$i[l$L];if(this.__fillText(l$x.char,l$x.x+l$_,l$x.y+l$R),1===l$z){var l$P=l$x.height,l$B=.5*l$x.style.letterSpacing;l$B||(l$B=0),this.beginPath(),this.strokeStyle=l$b,this.lineWidth=1,this.moveTo(l$_+l$x.x-l$B+.5,l$R+l$x.y+l$P+.5),this.lineTo(l$_+l$x.x+l$x.width+l$B+.5,l$R+l$x.y+l$P+.5),this.stroke()}}},l$i.fillBorderWords=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){l$r&&(this.font=l$r),l$b&&(this.fillStyle=l$b),this.textBaseline="top",this.lineWidth=l$L,this.textAlign="left",this.strokeStyle=l$z;for(var l$w=0,l$x=l$i.length;l$w<l$x;l$w++){var l$P=l$i[l$w];this.__strokeText(l$P.char,l$P.x+l$_,l$P.y+l$R),this.__fillText(l$P.char,l$P.x+l$_,l$P.y+l$R)}},l$i.destroy=function(){this.canvas.width=this.canvas.height=0},l$i.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},l$i.drawCurves=function(l$i,l$_,l$R){this.beginPath(),this.strokeStyle=l$R[3],this.lineWidth=l$R[4];var l$r=l$R[2];l$i+=l$R[0],l$_+=l$R[1],this.moveTo(l$i+l$r[0],l$_+l$r[1]);for(var l$b=2,l$z=l$r.length;l$b<l$z;)this.quadraticCurveTo(l$i+l$r[l$b++],l$_+l$r[l$b++],l$i+l$r[l$b++],l$_+l$r[l$b++]);this.stroke()},l$w.__init__=function(l$_){var l$R=laya.resource.Context.prototype;if(!(l$_=l$_||CanvasRenderingContext2D.prototype).inited){l$_.inited=!0,l$_.__fillText=l$_.fillText,l$_.__fillRect=l$_.fillRect,l$_.__strokeText=l$_.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(l$i){l$_[l$i]=l$R[l$i]})}},l$w.replaceCanvasGetSet=function(l$i,l$_){var l$R=Object.getOwnPropertyDescriptor(l$i,l$_);if(!l$R||!l$R.configurable)return!1;var l$r,l$b={};for(l$r in l$R)"set"!=l$r&&(l$b[l$r]=l$R[l$r]);var l$z=l$R.set;return l$b.set=function(l$i){l$z.call(this,l$i);var l$_=this.getContext("2d");l$_&&"__reset"in l$_&&l$_.__reset()},Object.defineProperty(l$i,l$_,l$b),!0},l$w.replaceGetSet=function(l$i,l$_){var l$R=Object.getOwnPropertyDescriptor(l$i,l$_);if(!l$R||!l$R.configurable)return!1;var l$r,l$b={};for(l$r in l$R)"set"!=l$r&&(l$b[l$r]=l$R[l$r]);var l$z=l$R.set,l$L="___"+l$_+"__";return l$w.newKeys.push(l$L),l$b.set=function(l$i){l$i!=this[l$L]&&(this[l$L]=l$i,l$z.call(this,l$i))},Object.defineProperty(l$i,l$_,l$b),!0},l$w._default=new l$w,l$w.newKeys=[],l$x(l$w,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),l$w}(),l$E=function(){function l$z(l$i){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++l$z._uniqueIDCounter,this._name=l$i||"Content Manager",l$z._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,l$z._resourceManagers.push(this),this._resources=[],this._records={}}l$B(l$z,"laya.resource.ResourceManager");var l$i=l$z.prototype;return l$A.imps(l$i,{"laya.resource.IDispose":!0}),l$i.getResourceByIndex=function(l$i){return this._resources[l$i]},l$i.getResourcesLength=function(){return this._resources.length},l$i.addResource=function(l$i){return l$i.resourceManager&&l$i.resourceManager.removeResource(l$i),-1===this._resources.indexOf(l$i)&&((l$i._resourceManager=this)._resources.push(l$i),this.addRecord(l$i.uri,l$i.__className,l$i.memorySize),this.addSize(l$i.memorySize),!0)},l$i.removeResource=function(l$i){var l$_=this._resources.indexOf(l$i);return-1!==l$_&&(this._resources.splice(l$_,1),l$i._resourceManager=null,this._memorySize-=l$i.memorySize,this.addRecord(l$i.uri,l$i.__className,-l$i.memorySize),!0)},l$i.unload=function(){for(var l$i=this._resources.slice(0,this._resources.length),l$_=0;l$_<l$i.length;l$_++){l$i[l$_].destroy()}l$i.length=0},l$i.dispose=function(){if(this===l$z._systemResourceManager)throw new Error("systemResourceManager不能被释放！");l$z._resourceManagers.splice(l$z._resourceManagers.indexOf(this),1),l$z._isResourceManagersSorted=!1;for(var l$i=this._resources.slice(0,this._resources.length),l$_=0;l$_<l$i.length;l$_++){var l$R=l$i[l$_];l$R.resourceManager.removeResource(l$R),l$R.destroy()}l$i.length=0},l$i.addSize=function(l$i){l$i&&(this.autoRelease&&0<l$i&&this._memorySize+l$i>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=l$i)},l$i.addRecord=function(l$i,l$_,l$R){DEBUG&&l$R&&!l$i&&console.error(l$i,l$_,l$R)},l$i.garbageCollection=function(l$i){var l$_=this._resources;(l$_=l$_.slice()).sort(function(l$i,l$_){if(!l$i||!l$_)throw new Error("a或b不能为空！");return l$i.released&&l$_.released?0:l$i.released?1:l$_.released?-1:l$i._lastUseFrameCount-l$_._lastUseFrameCount});for(var l$R=l$a.loopCount,l$r=0,l$b=l$_.length;l$r<l$b;l$r++){var l$z=l$_[l$r];if(!(1<l$R-l$z._lastUseFrameCount))return void(this._memorySize>=l$i&&(this._isOverflow=!0));if(l$z.releaseResource(),this._memorySize<l$i)return void(this._isOverflow=!1)}},l$h(0,l$i,"id",function(){return this._id}),l$h(0,l$i,"name",function(){return this._name},function(l$i){!l$i&&""===l$i||this._name===l$i||(this._name=l$i,l$z._isResourceManagersSorted=!1)}),l$h(0,l$i,"memorySize",function(){return this._memorySize}),l$h(0,l$i,"records",function(){return this._records}),l$h(1,l$z,"systemResourceManager",function(){return l$z._systemResourceManager}),l$z.__init__=function(){l$z.currentResourceManager=l$z.systemResourceManager},l$z.getLoadedResourceManagerByIndex=function(l$i){return l$z._resourceManagers[l$i]},l$z.getLoadedResourceManagersCount=function(){return l$z._resourceManagers.length},l$z.recreateContentManagers=function(l$i){void 0===l$i&&(l$i=!1);for(var l$_=l$z.currentResourceManager,l$R=0;l$R<l$z._resourceManagers.length;l$R++){l$z.currentResourceManager=l$z._resourceManagers[l$R];for(var l$r=0;l$r<l$z.currentResourceManager._resources.length;l$r++)l$z.currentResourceManager._resources[l$r].releaseResource(l$i),l$z.currentResourceManager._resources[l$r].activeResource(l$i)}l$z.currentResourceManager=l$_},l$z.releaseContentManagers=function(l$i){void 0===l$i&&(l$i=!1);for(var l$_=l$z.currentResourceManager,l$R=0;l$R<l$z._resourceManagers.length;l$R++){l$z.currentResourceManager=l$z._resourceManagers[l$R];for(var l$r=0;l$r<l$z.currentResourceManager._resources.length;l$r++){var l$b=l$z.currentResourceManager._resources[l$r];!l$b.released&&l$b.releaseResource(l$i)}}l$z.currentResourceManager=l$_},l$z._uniqueIDCounter=0,l$z._isResourceManagersSorted=!1,l$z._resourceManagers=[],l$x(l$z,["_systemResourceManager",function(){return this._systemResourceManager=new l$z("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=l$z._systemResourceManager}]),l$z}(),l$s=(function(){function l$i(){}l$B(l$i,"laya.system.System"),l$i.changeDefinition=function(l$i,l$_){l$A[l$i]=l$_;var l$R=l$i+"=classObj";l$A._runScript(l$R)},l$i.__init__=function(){l$p.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function l$R(){}return l$B(l$R,"laya.utils.Browser"),l$h(1,l$R,"pixelRatio",function(){return l$R.__init__(),-1<l$R.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:l$$.getPixelRatio()}),l$h(1,l$R,"height",function(){return l$R.__init__(),(l$A.stage&&l$A.stage.canvasRotation?l$R.clientWidth:l$R.clientHeight)*l$R.pixelRatio}),l$h(1,l$R,"clientWidth",function(){return l$R.__init__(),l$R.window.innerWidth||l$R.document.body.clientWidth}),l$h(1,l$R,"window",function(){return l$R.__init__(),l$R._window}),l$h(1,l$R,"clientHeight",function(){return l$R.__init__(),l$R.window.innerHeight||l$R.document.body.clientHeight||l$R.document.documentElement.clientHeight}),l$h(1,l$R,"width",function(){return l$R.__init__(),(l$A.stage&&l$A.stage.canvasRotation?l$R.clientHeight:l$R.clientWidth)*l$R.pixelRatio}),l$h(1,l$R,"container",function(){return l$R.__init__(),l$R._container||((l$R._container=l$R.createElement("div")).id="layaContainer",l$R.document.body.appendChild(l$R._container)),l$R._container},function(l$i){l$R._container=l$i}),l$h(1,l$R,"document",function(){return l$R.__init__(),l$R._document}),l$R.__init__=function(){if(!l$R._window){l$R._window=l$$.getWindow(),l$R._document=l$R.window.document,l$R._window.addEventListener("message",function(l$i){laya.utils.Browser._onMessage(l$i)},!1),l$R.document.__createElement=l$R.document.createElement,l$L.requestAnimationFrame=l$L.requestAnimationFrame||l$L.webkitRequestAnimationFrame||l$L.mozRequestAnimationFrame||l$L.oRequestAnimationFrame||l$L.msRequestAnimationFrame||function(l$i){return l$L.setTimeout(l$i,1e3/60)};var l$i=l$L.document.body.style;l$i["-webkit-user-select"]="none",l$i["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",l$R.userAgent=l$R.window.navigator.userAgent,l$R.onIOS=!!(l$R.u=l$R.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),l$R.onMobile=-1<l$R.u.indexOf("Mobile"),l$R.onIPhone=-1<l$R.u.indexOf("iPhone"),l$R.onMac=-1<l$R.u.indexOf("Mac OS X"),l$R.onIPad=-1<l$R.u.indexOf("iPad"),l$R.onAndroid=-1<l$R.u.indexOf("Android")||-1<l$R.u.indexOf("Adr"),l$R.onWP=-1<l$R.u.indexOf("Windows Phone"),l$R.onQQBrowser=-1<l$R.u.indexOf("QQBrowser"),l$R.onMQQBrowser=-1<l$R.u.indexOf("MQQBrowser")||-1<l$R.u.indexOf("Mobile")&&-1<l$R.u.indexOf("QQ"),l$R.onIE=!!l$R.window.ActiveXObject||"ActiveXObject"in l$R.window,l$R.onWeiXin=-1<l$R.u.indexOf("MicroMessenger"),l$R.onPC=!l$R.onMobile,l$R.onSafari=-1<l$R.u.indexOf("Safari"),l$R.onFirefox=-1<l$R.u.indexOf("Firefox"),l$R.onEdge=-1<l$R.u.indexOf("Edge"),l$R.onMiniGame=-1<l$R.u.indexOf("MiniGame"),l$R.onLimixiu=-1<l$R.u.indexOf("limixiu"),l$R.httpProtocol="http:"==l$R.window.location.protocol,l$R.onMiniGame&&null==l$R.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),l$R.webAudioEnabled=!!(l$R.window.AudioContext||l$R.window.webkitAudioContext||l$R.window.mozAudioContext),l$R.soundType=l$R.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",l$bi=l$R.webAudioEnabled?l$zi:l$Ri,l$R.webAudioEnabled&&l$zi.initWebAudio(),l$Ri._initMusicAudio(),l$R.enableTouch="ontouchstart"in l$L||l$L.DocumentTouch&&l$_ instanceof DocumentTouch,l$L.focus(),l$v._soundClass=l$bi,l$v._musicClass=l$Ri,l$p._mainCanvas=l$p._mainCanvas||l$Ii.create("2D"),l$R.canvas||(l$R.canvas=l$Ii.create("2D"),l$R.context=l$R.canvas.getContext("2d"))}},l$R._onMessage=function(l$i){if(l$i.data&&"size"==l$i.data.name){if(l$R.window.innerWidth=l$i.data.width,l$R.window.innerHeight=l$i.data.height,l$R.window.__innerHeight=l$i.data.clientHeight,!l$R.document.createEvent)return void console.warn("no document.createEvent");var l$_=l$R.document.createEvent("HTMLEvents");return l$_.initEvent("resize",!1,!1),void l$R.window.dispatchEvent(l$_)}},l$R.createElement=function(l$i){return l$R.__init__(),l$R.document.__createElement(l$i)},l$R.getElementById=function(l$i){return l$R.__init__(),l$R.document.getElementById(l$i)},l$R.removeElement=function(l$i){l$i&&l$i.parentNode&&l$i.parentNode.removeChild(l$i)},l$R.now=function(){return l$$.now()},l$R._window=null,l$R._document=null,l$R._container=null,l$R.userAgent=null,l$R.u=null,l$R.onIOS=!1,l$R.onMac=!1,l$R.onMobile=!1,l$R.onIPhone=!1,l$R.onIPad=!1,l$R.onAndroid=!1,l$R.onWP=!1,l$R.onQQBrowser=!1,l$R.onMQQBrowser=!1,l$R.onSafari=!1,l$R.onFirefox=!1,l$R.onEdge=!1,l$R.onIE=!1,l$R.onWeiXin=!1,l$R.onMiniGame=!1,l$R.onLimixiu=!1,l$R.onPC=!1,l$R.httpProtocol=!1,l$R.webAudioEnabled=!1,l$R.soundType=null,l$R.enableTouch=!1,l$R.canvas=null,l$R.context=null,l$R.__init$=function(){},l$R}()),l$Y=function(){function l$_(l$i){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,l$i?(this._u8d_=new Uint8Array(l$i),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}l$B(l$_,"laya.utils.Byte");var l$i=l$_.prototype;return l$i.___resizeBuffer=function(l$_){try{var l$i=new Uint8Array(l$_);null!=this._u8d_&&(this._u8d_.length<=l$_?l$i.set(this._u8d_):l$i.set(this._u8d_.subarray(0,l$_))),this._u8d_=l$i,this._d_=new DataView(l$i.buffer)}catch(l$i){throw"___resizeBuffer err:"+l$_}},l$i.getString=function(){return this.rUTF(this.getUint16())},l$i.getFloat32Array=function(l$i,l$_){var l$R=l$i+l$_;l$R=l$R>this._length?this._length:l$R;var l$r=new Float32Array(this._d_.buffer.slice(l$i,l$R));return this._pos_=l$R,l$r},l$i.getUint8Array=function(l$i,l$_){var l$R=l$i+l$_;l$R=l$R>this._length?this._length:l$R;var l$r=new Uint8Array(this._d_.buffer.slice(l$i,l$R));return this._pos_=l$R,l$r},l$i.getInt16Array=function(l$i,l$_){var l$R=l$i+l$_;l$R=l$R>this._length?this._length:l$R;var l$r=new Int16Array(this._d_.buffer.slice(l$i,l$R));return this._pos_=l$R,l$r},l$i.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var l$i=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,l$i},l$i.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var l$i=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,l$i},l$i.writeFloat32=function(l$i){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,l$i,this._xd_),this._pos_+=4},l$i.writeFloat64=function(l$i){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,l$i,this._xd_),this._pos_+=8},l$i.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var l$i=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,l$i},l$i.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var l$i=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,l$i},l$i.writeInt32=function(l$i){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,l$i,this._xd_),this._pos_+=4},l$i.writeUint32=function(l$i){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,l$i,this._xd_),this._pos_+=4},l$i.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var l$i=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,l$i},l$i.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var l$i=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,l$i},l$i.writeUint16=function(l$i){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,l$i,this._xd_),this._pos_+=2},l$i.writeInt16=function(l$i){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,l$i,this._xd_),this._pos_+=2},l$i.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},l$i.writeUint8=function(l$i){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,l$i),this._pos_++},l$i._getUInt8=function(l$i){return this._d_.getUint8(l$i)},l$i._getUint16=function(l$i){return this._d_.getUint16(l$i,this._xd_)},l$i._getMatrix=function(){return new l$G(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},l$i.rUTF=function(l$i){for(var l$_=[],l$R=this._pos_+l$i,l$r=0,l$b=0,l$z=0,l$L=String.fromCharCode,l$w=this._u8d_;this._pos_<l$R;)(l$r=l$w[this._pos_++])<128?0!=l$r&&l$_.push(l$L(l$r)):l$r<224?l$_.push(l$L((63&l$r)<<6|127&l$w[this._pos_++])):l$r<240?(l$b=l$w[this._pos_++],l$_.push(l$L((31&l$r)<<12|(127&l$b)<<6|127&l$w[this._pos_++]))):(l$b=l$w[this._pos_++],l$z=l$w[this._pos_++],l$_.push(l$L((15&l$r)<<18|(127&l$b)<<12|l$z<<6&127|127&l$w[this._pos_++]))),0;return l$_.join("")},l$i.getCustomString=function(l$i){for(var l$_=[],l$R=0,l$r=0,l$b=0,l$z=String.fromCharCode,l$L=this._u8d_;0<l$i;)if((l$r=l$L[this._pos_])<128)l$_.push(l$z(l$r)),this._pos_++,l$i--;else for(l$R=l$r-128,this._pos_++,l$i-=l$R;0<l$R;)l$r=l$L[this._pos_++],l$b=l$L[this._pos_++],l$_.push(l$z(l$b<<8|l$r)),l$R--;return l$_.join("")},l$i.clear=function(){this._pos_=0,this.length=0},l$i.__getBuffer=function(){return this._d_.buffer},l$i.writeUTFBytes=function(l$i){for(var l$_=0,l$R=(l$i+="").length;l$_<l$R;l$_++){var l$r=l$i.charCodeAt(l$_);l$r<=127?this.writeByte(l$r):l$r<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|l$r>>6,128|63&l$r],this._pos_),this._pos_+=2):l$r<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|l$r>>12,128|l$r>>6&63,128|63&l$r],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|l$r>>18,128|l$r>>12&63,128|l$r>>6&63,128|63&l$r],this._pos_),this._pos_+=4)}},l$i.writeUTFString=function(l$i){var l$_=this.pos;this.writeUint16(1),this.writeUTFBytes(l$i);var l$R=this.pos-l$_-2;if(65536<=l$R)throw"writeUTFString byte len more than 65536";this._d_.setUint16(l$_,l$R,this._xd_)},l$i.readUTFString=function(){return this.readUTFBytes(this.getUint16())},l$i.getUTFString=function(){return this.readUTFString()},l$i.readUTFBytes=function(l$i){if(void 0===l$i&&(l$i=-1),0==l$i)return"";var l$_=this.bytesAvailable;if(l$_<l$i)throw"readUTFBytes error - Out of bounds";return l$i=0<l$i?l$i:l$_,this.rUTF(l$i)},l$i.getUTFBytes=function(l$i){return void 0===l$i&&(l$i=-1),this.readUTFBytes(l$i)},l$i.writeByte=function(l$i){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,l$i),this._pos_+=1},l$i.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},l$i.getByte=function(){return this.readByte()},l$i.ensureWrite=function(l$i){this._length<l$i&&(this._length=l$i),this._allocated_<l$i&&(this.length=l$i)},l$i.writeArrayBuffer=function(l$i,l$_,l$R){if(void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),l$_<0||l$R<0)throw"writeArrayBuffer error - Out of bounds";0==l$R&&(l$R=l$i.byteLength-l$_),this.ensureWrite(this._pos_+l$R);var l$r=new Uint8Array(l$i);this._u8d_.set(l$r.subarray(l$_,l$_+l$R),this._pos_),this._pos_+=l$R},l$h(0,l$i,"buffer",function(){var l$i=this._d_.buffer;return l$i.byteLength==this.length?l$i:l$i.slice(0,this.length)}),l$h(0,l$i,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(l$i){this._xd_="littleEndian"==l$i}),l$h(0,l$i,"length",function(){return this._length},function(l$i){this._allocated_<l$i?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(l$i,2*this._allocated_))):this._allocated_>l$i&&this.___resizeBuffer(this._allocated_=l$i),this._length=l$i}),l$h(0,l$i,"pos",function(){return this._pos_},function(l$i){this._pos_=l$i}),l$h(0,l$i,"bytesAvailable",function(){return this._length-this._pos_}),l$_.getSystemEndian=function(){if(!l$_._sysEndian){var l$i=new ArrayBuffer(2);new DataView(l$i).setInt16(0,256,!0),l$_._sysEndian=256===new Int16Array(l$i)[0]?"littleEndian":"bigEndian"}return l$_._sysEndian},l$_.BIG_ENDIAN="bigEndian",l$_.LITTLE_ENDIAN="littleEndian",l$_._sysEndian=null,l$_}(),l$C=function(){function l$b(){}return l$B(l$b,"laya.utils.CacheManager"),l$b.regCacheByFunction=function(l$i,l$_){var l$R;l$b.unRegCacheByFunction(l$i,l$_),l$R={tryDispose:l$i,getCacheList:l$_},l$b._cacheList.push(l$R)},l$b.unRegCacheByFunction=function(l$i,l$_){var l$R,l$r=0;for(l$R=l$b._cacheList.length,l$r=0;l$r<l$R;l$r++)if(l$b._cacheList[l$r].tryDispose==l$i&&l$b._cacheList[l$r].getCacheList==l$_)return void l$b._cacheList.splice(l$r,1)},l$b.forceDispose=function(){var l$i=0,l$_=l$b._cacheList.length;for(l$i=0;l$i<l$_;l$i++)l$b._cacheList[l$i].tryDispose(!0)},l$b.beginCheck=function(l$i){void 0===l$i&&(l$i=15e3),l$A.timer.loop(l$i,null,l$b._checkLoop)},l$b.stopCheck=function(){l$A.timer.clear(null,l$b._checkLoop)},l$b._checkLoop=function(){var l$i=l$b._cacheList;if(!(l$i.length<1)){var l$_,l$R=l$s.now(),l$r=0;for(l$_=l$r=l$i.length;0<l$r&&(l$i[l$b._index=++l$b._index%l$_].tryDispose(!1),!(l$s.now()-l$R>l$b.loopTimeLimit));)l$r--}},l$b.loopTimeLimit=2,l$b._cacheList=[],l$b._index=0,l$b}(),l$m=function(){function l$J(){}return l$B(l$J,"laya.utils.ClassUtils"),l$J.regClass=function(l$i,l$_){l$J._classMap[l$i]=l$_},l$J.getRegClass=function(l$i){return l$J._classMap[l$i]},l$J.getInstance=function(l$i){var l$_=l$J.getClass(l$i);return l$_?new l$_:(console.warn("[error] Undefined class:",l$i),null)},l$J.createByJson=function(l$i,l$_,l$R,l$r,l$b){"string"==typeof l$i&&(l$i=JSON.parse(l$i));var l$z=l$i.props;if(!l$_&&!(l$_=l$b?l$b.runWith(l$i):l$J.getInstance(l$z.runtime||l$i.type)))return null;var l$L=l$i.child;if(l$L)for(var l$w=0,l$x=l$L.length;l$w<l$x;l$w++){var l$P=l$L[l$w];if("render"!==l$P.props.name&&"render"!==l$P.props.renderType||!l$_._$set_itemRender)if("Graphic"==l$P.type)l$J.addGraphicsToSprite(l$P,l$_);else if(l$J.isDrawType(l$P.type))l$J.addGraphicToSprite(l$P,l$_,!0);else{var l$B=l$J.createByJson(l$P,null,l$R,l$r,l$b);"Script"==l$P.type?l$B.hasOwnProperty("owner")?l$B.owner=l$_:l$B.hasOwnProperty("target")&&(l$B.target=l$_):"mask"==l$P.props.renderType?l$_.mask=l$B:l$_.addChild(l$B)}else l$_.itemRender=l$P}if(l$z)for(var l$n in l$z){var l$f=l$z[l$n];"var"===l$n&&l$R?l$R[l$f]=l$_:l$f instanceof Array&&"function"==typeof l$_[l$n]?l$_[l$n].apply(l$_,l$f):l$_[l$n]=l$f}return l$r&&l$i.customProps&&l$r.runWith([l$_,l$i]),l$_.created&&l$_.created(),l$_},l$J.addGraphicsToSprite=function(l$i,l$_){var l$R;if((l$R=l$i.child)&&!(l$R.length<1)){var l$r;l$r=l$J._getGraphicsFromSprite(l$i,l$_);var l$b=0,l$z=0;l$i.props&&(l$b=l$J._getObjVar(l$i.props,"x",0),l$z=l$J._getObjVar(l$i.props,"y",0)),0!=l$b&&0!=l$z&&l$r.translate(l$b,l$z);var l$L,l$w=0;for(l$L=l$R.length,l$w=0;l$w<l$L;l$w++)l$J._addGraphicToGraphics(l$R[l$w],l$r);0!=l$b&&0!=l$z&&l$r.translate(-l$b,-l$z)}},l$J.addGraphicToSprite=function(l$i,l$_,l$R){var l$r;void 0===l$R&&(l$R=!1),l$r=l$R?l$J._getGraphicsFromSprite(l$i,l$_):l$_.graphics,l$J._addGraphicToGraphics(l$i,l$r)},l$J._getGraphicsFromSprite=function(l$i,l$_){var l$R,l$r;if(!l$i||!l$i.props)return l$_.graphics;switch(l$r=l$i.props.renderType){case"hit":case"unHit":var l$b;l$_.hitArea||(l$_.hitArea=new l$V),(l$b=l$_.hitArea)[l$r]||(l$b[l$r]=new l$f),l$R=l$b[l$r]}return l$R||(l$R=l$_.graphics),l$R},l$J._getTransformData=function(l$i){var l$_;(l$i.hasOwnProperty("pivotX")||l$i.hasOwnProperty("pivotY"))&&(l$_=l$_||new l$G).translate(-l$J._getObjVar(l$i,"pivotX",0),-l$J._getObjVar(l$i,"pivotY",0));var l$R=l$J._getObjVar(l$i,"scaleX",1),l$r=l$J._getObjVar(l$i,"scaleY",1),l$b=l$J._getObjVar(l$i,"rotation",0);l$J._getObjVar(l$i,"skewX",0),l$J._getObjVar(l$i,"skewY",0);return 1==l$R&&1==l$r&&0==l$b||((l$_=l$_||new l$G).scale(l$R,l$r),l$_.rotate(.0174532922222222*l$b)),l$_},l$J._addGraphicToGraphics=function(l$i,l$_){var l$R,l$r;if((l$R=l$i.props)&&(l$r=l$J.DrawTypeDic[l$i.type])){var l$b,l$z;l$b=l$_;var l$L=l$J._getParams(l$R,l$r[1],l$r[2],l$r[3]);((l$z=l$J._tM)||1!=l$J._alpha)&&(l$b.save(),l$z&&l$b.transform(l$z),1!=l$J._alpha&&l$b.alpha(l$J._alpha)),l$b[l$r[0]].apply(l$b,l$L),(l$z||1!=l$J._alpha)&&l$b.restore()}},l$J._adptLineData=function(l$i){return l$i[2]=parseFloat(l$i[0])+parseFloat(l$i[2]),l$i[3]=parseFloat(l$i[1])+parseFloat(l$i[3]),l$i},l$J._adptTextureData=function(l$i){return l$i[0]=l$wi.getRes(l$i[0]),l$i},l$J._adptLinesData=function(l$i){return l$i[2]=l$J._getPointListByStr(l$i[2]),l$i},l$J.isDrawType=function(l$i){return"Image"!=l$i&&l$J.DrawTypeDic.hasOwnProperty(l$i)},l$J._getParams=function(l$i,l$_,l$R,l$r){var l$b;void 0===l$R&&(l$R=0),(l$b=l$J._temParam).length=l$_.length;var l$z,l$L,l$w=0;for(l$z=l$_.length,l$w=0;l$w<l$z;l$w++)l$b[l$w]=l$J._getObjVar(l$i,l$_[l$w][0],l$_[l$w][1]);return l$J._alpha=l$J._getObjVar(l$i,"alpha",1),l$L=l$J._getTransformData(l$i),l$J._tM=l$L?(l$R||(l$R=0),l$L.translate(l$b[l$R],l$b[l$R+1]),l$b[l$R]=l$b[l$R+1]=0,l$L):null,l$r&&l$J[l$r]&&(l$b=l$J[l$r](l$b)),l$b},l$J._getPointListByStr=function(l$i){var l$_,l$R,l$r=0;for(l$R=(l$_=l$i.split(",")).length,l$r=0;l$r<l$R;l$r++)l$_[l$r]=parseFloat(l$_[l$r]);return l$_},l$J._getObjVar=function(l$i,l$_,l$R){return l$i.hasOwnProperty(l$_)?l$i[l$_]:l$R},l$J._temParam=[],l$J._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},l$J.getClass=function(l$i){var l$_=l$J._classMap[l$i]||l$i;return"string"==typeof l$_?l$A.__classmap[l$_]:l$_},l$J._tM=null,l$J._alpha=NaN,l$x(l$J,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),l$J}(),l$D=function(){function l$z(l$i){if(this._color=[],"string"==typeof l$i){null===(this.strColor=l$i)&&(l$i="#000000"),"#"==l$i.charAt(0)&&(l$i=l$i.substr(1));var l$_=l$i.length;if(3==l$_||4==l$_){for(var l$R="",l$r=0;l$r<l$_;l$r++)l$R+=l$i[l$r]+l$i[l$r];l$i=l$R}var l$b=this.numColor=parseInt(l$i,16);if(8==l$i.length)return void(this._color=[parseInt(l$i.substr(0,2),16)/255,((16711680&l$b)>>16)/255,((65280&l$b)>>8)/255,(255&l$b)/255])}else l$b=this.numColor=l$i,this.strColor=l$Q.toHexColor(l$b);this._color=[((16711680&l$b)>>16)/255,((65280&l$b)>>8)/255,(255&l$b)/255,1],this._color.__id=++l$z._COLODID}return l$B(l$z,"laya.utils.Color"),l$z._initDefault=function(){for(var l$i in l$z._DEFAULT={},l$z._COLOR_MAP)l$z._SAVE[l$i]=l$z._DEFAULT[l$i]=new l$z(l$z._COLOR_MAP[l$i]);return l$z._DEFAULT},l$z._initSaveMap=function(){for(var l$i in l$z._SAVE_SIZE=0,l$z._SAVE={},l$z._DEFAULT)l$z._SAVE[l$i]=l$z._DEFAULT[l$i]},l$z.create=function(l$i){var l$_=l$z._SAVE[l$i+""];return null!=l$_?l$_:(l$z._SAVE_SIZE<1e3||l$z._initSaveMap(),l$z._SAVE[l$i+""]=new l$z(l$i))},l$z._SAVE={},l$z._SAVE_SIZE=0,l$z._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},l$z._DEFAULT=l$z._initDefault(),l$z._COLODID=1,l$z}(),l$U=(function(){function l$i(){this._values=[],this._keys=[]}l$B(l$i,"laya.utils.Dictionary");var l$_=l$i.prototype;l$_.set=function(l$i,l$_){var l$R=this.indexOf(l$i);0<=l$R?this._values[l$R]=l$_:(this._keys.push(l$i),this._values.push(l$_))},l$_.indexOf=function(l$i){var l$_=this._keys.indexOf(l$i);return 0<=l$_?l$_:(l$i="string"==typeof l$i?Number(l$i):"number"==typeof l$i?l$i.toString():l$i,this._keys.indexOf(l$i))},l$_.get=function(l$i){var l$_=this.indexOf(l$i);return l$_<0?null:this._values[l$_]},l$_.remove=function(l$i){var l$_=this.indexOf(l$i);return 0<=l$_&&(this._keys.splice(l$_,1),this._values.splice(l$_,1),!0)},l$_.clear=function(){this._values.length=0,this._keys.length=0},l$h(0,l$_,"values",function(){return this._values}),l$h(0,l$_,"keys",function(){return this._keys})}(),function(){function l$i(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}l$B(l$i,"laya.utils.Dragging");var l$_=l$i.prototype;return l$_.start=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){void 0===l$w&&(l$w=.92),this.clearTimer(),this.target=l$i,this.area=l$_,this.hasInertia=l$R,this.elasticDistance=l$_?l$r:0,this.elasticBackTime=l$b,this.data=l$z,this._disableMouseEvent=l$L,this.ratio=l$w,1!=l$i.globalScaleX||1!=l$i.globalScaleY?this._parent=l$i.parent:this._parent=l$A.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,l$A.stage.on("mouseup",this,this.onStageMouseUp),l$A.stage.on("mouseout",this,this.onStageMouseUp),l$A.timer.frameLoop(1,this,this.loop)},l$_.clearTimer=function(){l$A.timer.clear(this,this.loop),l$A.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},l$_.stop=function(){this._dragging&&(l$M.instance.disableMouseEvent=!1,l$A.stage.off("mouseup",this,this.onStageMouseUp),l$A.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},l$_.loop=function(){var l$i=this._parent.getMousePoint(),l$_=l$i.x,l$R=l$i.y,l$r=l$_-this._lastX,l$b=l$R-this._lastY;if(this._clickOnly){if(!(1<Math.abs(l$r*l$A.stage._canvasTransform.getScaleX())||1<Math.abs(l$b*l$A.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),l$M.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(l$r,l$b);0==l$r&&0==l$b||(this._lastX=l$_,this._lastY=l$R,this.target.x+=l$r*this._elasticRateX,this.target.y+=l$b*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},l$_.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var l$i=this.area.x-this.target.x;else l$i=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-l$i/this.elasticDistance),this.target.y<this.area.y)var l$_=this.area.y-this.target.y;else l$_=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-l$_/this.elasticDistance)}},l$_.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},l$_.onStageMouseUp=function(l$i){if(l$M.instance.disableMouseEvent=!1,l$A.stage.off("mouseup",this,this.onStageMouseUp),l$A.stage.off("mouseout",this,this.onStageMouseUp),l$A.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var l$_=this._offsets.length,l$R=Math.min(l$_,6),l$r=this._offsets.length-l$R,l$b=l$_-1;l$r<l$b;l$b--)this._offsetY+=this._offsets[l$b--],this._offsetX+=this._offsets[l$b];this._offsetX=this._offsetX/l$R*2,this._offsetY=this._offsetY/l$R*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),l$A.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},l$_.checkElastic=function(){var l$i=NaN,l$_=NaN;if(this.target.x<this.area.x?l$i=this.area.x:this.target.x>this.area.x+this.area.width&&(l$i=this.area.x+this.area.width),this.target.y<this.area.y?l$_=this.area.y:this.target.y>this.area.y+this.area.height&&(l$_=this.area.y+this.area.height),isNaN(l$i)&&isNaN(l$_))this.clear();else{var l$R={};isNaN(l$i)||(l$R.x=l$i),isNaN(l$_)||(l$R.y=l$_),this._tween=l$d.to(this.target,l$R,this.elasticBackTime,l$g.sineOut,l$t.create(this,this.clear),0,!1,!1)}},l$_.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(l$A.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},l$_.clear=function(){if(this.target){this.clearTimer();var l$i=this.target;this.target=null,this._parent=null,l$i.event("dragend",this.data)}},l$i}()),l$g=function(){function l$w(){}return l$B(l$w,"laya.utils.Ease"),l$w.linearNone=function(l$i,l$_,l$R,l$r){return l$R*l$i/l$r+l$_},l$w.linearIn=function(l$i,l$_,l$R,l$r){return l$R*l$i/l$r+l$_},l$w.linearInOut=function(l$i,l$_,l$R,l$r){return l$R*l$i/l$r+l$_},l$w.linearOut=function(l$i,l$_,l$R,l$r){return l$R*l$i/l$r+l$_},l$w.bounceIn=function(l$i,l$_,l$R,l$r){return l$R-l$w.bounceOut(l$r-l$i,0,l$R,l$r)+l$_},l$w.bounceInOut=function(l$i,l$_,l$R,l$r){return l$i<.5*l$r?.5*l$w.bounceIn(2*l$i,0,l$R,l$r)+l$_:.5*l$w.bounceOut(2*l$i-l$r,0,l$R,l$r)+.5*l$R+l$_},l$w.bounceOut=function(l$i,l$_,l$R,l$r){return(l$i/=l$r)<1/2.75?l$R*(7.5625*l$i*l$i)+l$_:l$i<2/2.75?l$R*(7.5625*(l$i-=1.5/2.75)*l$i+.75)+l$_:l$i<2.5/2.75?l$R*(7.5625*(l$i-=2.25/2.75)*l$i+.9375)+l$_:l$R*(7.5625*(l$i-=2.625/2.75)*l$i+.984375)+l$_},l$w.backIn=function(l$i,l$_,l$R,l$r,l$b){return void 0===l$b&&(l$b=1.70158),l$R*(l$i/=l$r)*l$i*((l$b+1)*l$i-l$b)+l$_},l$w.backInOut=function(l$i,l$_,l$R,l$r,l$b){return void 0===l$b&&(l$b=1.70158),(l$i/=.5*l$r)<1?.5*l$R*(l$i*l$i*((1+(l$b*=1.525))*l$i-l$b))+l$_:l$R/2*((l$i-=2)*l$i*((1+(l$b*=1.525))*l$i+l$b)+2)+l$_},l$w.backOut=function(l$i,l$_,l$R,l$r,l$b){return void 0===l$b&&(l$b=1.70158),l$R*((l$i=l$i/l$r-1)*l$i*((l$b+1)*l$i+l$b)+1)+l$_},l$w.elasticIn=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L;return void 0===l$b&&(l$b=0),void 0===l$z&&(l$z=0),0==l$i?l$_:1==(l$i/=l$r)?l$_+l$R:(l$z||(l$z=.3*l$r),l$L=!l$b||0<l$R&&l$b<l$R||l$R<0&&l$b<-l$R?(l$b=l$R,l$z/4):l$z/l$w.PI2*Math.asin(l$R/l$b),-l$b*Math.pow(2,10*(l$i-=1))*Math.sin((l$i*l$r-l$L)*l$w.PI2/l$z)+l$_)},l$w.elasticInOut=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L;return void 0===l$b&&(l$b=0),void 0===l$z&&(l$z=0),0==l$i?l$_:2==(l$i/=.5*l$r)?l$_+l$R:(l$z||(l$z=l$r*(.3*1.5)),l$L=!l$b||0<l$R&&l$b<l$R||l$R<0&&l$b<-l$R?(l$b=l$R,l$z/4):l$z/l$w.PI2*Math.asin(l$R/l$b),l$i<1?l$b*Math.pow(2,10*(l$i-=1))*Math.sin((l$i*l$r-l$L)*l$w.PI2/l$z)*-.5+l$_:l$b*Math.pow(2,-10*(l$i-=1))*Math.sin((l$i*l$r-l$L)*l$w.PI2/l$z)*.5+l$R+l$_)},l$w.elasticOut=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L;return void 0===l$b&&(l$b=0),void 0===l$z&&(l$z=0),0==l$i?l$_:1==(l$i/=l$r)?l$_+l$R:(l$z||(l$z=.3*l$r),l$L=!l$b||0<l$R&&l$b<l$R||l$R<0&&l$b<-l$R?(l$b=l$R,l$z/4):l$z/l$w.PI2*Math.asin(l$R/l$b),l$b*Math.pow(2,-10*l$i)*Math.sin((l$i*l$r-l$L)*l$w.PI2/l$z)+l$R+l$_)},l$w.strongIn=function(l$i,l$_,l$R,l$r){return l$R*(l$i/=l$r)*l$i*l$i*l$i*l$i+l$_},l$w.strongInOut=function(l$i,l$_,l$R,l$r){return(l$i/=.5*l$r)<1?.5*l$R*l$i*l$i*l$i*l$i*l$i+l$_:.5*l$R*((l$i-=2)*l$i*l$i*l$i*l$i+2)+l$_},l$w.strongOut=function(l$i,l$_,l$R,l$r){return l$R*((l$i=l$i/l$r-1)*l$i*l$i*l$i*l$i+1)+l$_},l$w.sineInOut=function(l$i,l$_,l$R,l$r){return.5*-l$R*(Math.cos(Math.PI*l$i/l$r)-1)+l$_},l$w.sineIn=function(l$i,l$_,l$R,l$r){return-l$R*Math.cos(l$i/l$r*l$w.HALF_PI)+l$R+l$_},l$w.sineOut=function(l$i,l$_,l$R,l$r){return l$R*Math.sin(l$i/l$r*l$w.HALF_PI)+l$_},l$w.quintIn=function(l$i,l$_,l$R,l$r){return l$R*(l$i/=l$r)*l$i*l$i*l$i*l$i+l$_},l$w.quintInOut=function(l$i,l$_,l$R,l$r){return(l$i/=.5*l$r)<1?.5*l$R*l$i*l$i*l$i*l$i*l$i+l$_:.5*l$R*((l$i-=2)*l$i*l$i*l$i*l$i+2)+l$_},l$w.quintOut=function(l$i,l$_,l$R,l$r){return l$R*((l$i=l$i/l$r-1)*l$i*l$i*l$i*l$i+1)+l$_},l$w.quartIn=function(l$i,l$_,l$R,l$r){return l$R*(l$i/=l$r)*l$i*l$i*l$i+l$_},l$w.quartInOut=function(l$i,l$_,l$R,l$r){return(l$i/=.5*l$r)<1?.5*l$R*l$i*l$i*l$i*l$i+l$_:.5*-l$R*((l$i-=2)*l$i*l$i*l$i-2)+l$_},l$w.quartOut=function(l$i,l$_,l$R,l$r){return-l$R*((l$i=l$i/l$r-1)*l$i*l$i*l$i-1)+l$_},l$w.cubicIn=function(l$i,l$_,l$R,l$r){return l$R*(l$i/=l$r)*l$i*l$i+l$_},l$w.cubicInOut=function(l$i,l$_,l$R,l$r){return(l$i/=.5*l$r)<1?.5*l$R*l$i*l$i*l$i+l$_:.5*l$R*((l$i-=2)*l$i*l$i+2)+l$_},l$w.cubicOut=function(l$i,l$_,l$R,l$r){return l$R*((l$i=l$i/l$r-1)*l$i*l$i+1)+l$_},l$w.quadIn=function(l$i,l$_,l$R,l$r){return l$R*(l$i/=l$r)*l$i+l$_},l$w.quadInOut=function(l$i,l$_,l$R,l$r){return(l$i/=.5*l$r)<1?.5*l$R*l$i*l$i+l$_:.5*-l$R*(--l$i*(l$i-2)-1)+l$_},l$w.quadOut=function(l$i,l$_,l$R,l$r){return-l$R*(l$i/=l$r)*(l$i-2)+l$_},l$w.expoIn=function(l$i,l$_,l$R,l$r){return 0==l$i?l$_:l$R*Math.pow(2,10*(l$i/l$r-1))+l$_-.001*l$R},l$w.expoInOut=function(l$i,l$_,l$R,l$r){return 0==l$i?l$_:l$i==l$r?l$_+l$R:(l$i/=.5*l$r)<1?.5*l$R*Math.pow(2,10*(l$i-1))+l$_:.5*l$R*(2-Math.pow(2,-10*--l$i))+l$_},l$w.expoOut=function(l$i,l$_,l$R,l$r){return l$i==l$r?l$_+l$R:l$R*(1-Math.pow(2,-10*l$i/l$r))+l$_},l$w.circIn=function(l$i,l$_,l$R,l$r){return-l$R*(Math.sqrt(1-(l$i/=l$r)*l$i)-1)+l$_},l$w.circInOut=function(l$i,l$_,l$R,l$r){return(l$i/=.5*l$r)<1?.5*-l$R*(Math.sqrt(1-l$i*l$i)-1)+l$_:.5*l$R*(Math.sqrt(1-(l$i-=2)*l$i)+1)+l$_},l$w.circOut=function(l$i,l$_,l$R,l$r){return l$R*Math.sqrt(1-(l$i=l$i/l$r-1)*l$i)+l$_},l$w.HALF_PI=.5*Math.PI,l$w.PI2=2*Math.PI,l$w}(),l$V=function(){function l$n(){this._hit=null,this._unHit=null}l$B(l$n,"laya.utils.HitArea");var l$i=l$n.prototype;return l$i.isHit=function(l$i,l$_){return!!l$n.isHitGraphic(l$i,l$_,this.hit)&&!l$n.isHitGraphic(l$i,l$_,this.unHit)},l$i.contains=function(l$i,l$_){return this.isHit(l$i,l$_)},l$h(0,l$i,"hit",function(){return this._hit||(this._hit=new l$f),this._hit},function(l$i){this._hit=l$i}),l$h(0,l$i,"unHit",function(){return this._unHit||(this._unHit=new l$f),this._unHit},function(l$i){this._unHit=l$i}),l$n.isHitGraphic=function(l$i,l$_,l$R){if(!l$R)return!1;var l$r;if(!(l$r=l$R.cmds)&&l$R._one&&((l$r=l$n._cmds).length=1,l$r[0]=l$R._one),!l$r)return!1;var l$b,l$z,l$L=0;for(l$b=l$r.length,l$L=0;l$L<l$b;l$L++)if(l$z=l$r[l$L]){var l$w=l$p._context;switch(l$z.callee){case l$w._translate:case 6:l$i-=l$z[0],l$_-=l$z[1]}if(l$n.isHitCmd(l$i,l$_,l$z))return!0}return!1},l$n.isHitCmd=function(l$i,l$_,l$R){if(!l$R)return!1;var l$r=l$p._context,l$b=!1;switch(l$R.callee){case l$r._drawRect:case 13:l$n._rec.setTo(l$R[0],l$R[1],l$R[2],l$R[3]),l$b=l$n._rec.contains(l$i,l$_);break;case l$r._drawCircle:case l$r._fillCircle:case 14:l$b=(l$i-=l$R[0])*l$i+(l$_-=l$R[1])*l$_<l$R[2]*l$R[2];break;case l$r._drawPoly:case 18:l$i-=l$R[0],l$_-=l$R[1],l$b=l$n.ptInPolygon(l$i,l$_,l$R[2])}return l$b},l$n.ptInPolygon=function(l$i,l$_,l$R){var l$r;(l$r=l$n._ptPoint).setTo(l$i,l$_);var l$b,l$z=0,l$L=NaN,l$w=NaN,l$x=NaN,l$P=NaN;l$b=l$R.length;for(var l$B=0;l$B<l$b;l$B+=2){if(l$L=l$R[l$B],l$w=l$R[l$B+1],l$x=l$R[(l$B+2)%l$b],l$w!=(l$P=l$R[(l$B+3)%l$b]))if(!(l$r.y<Math.min(l$w,l$P)))if(!(l$r.y>=Math.max(l$w,l$P)))(l$r.y-l$w)*(l$x-l$L)/(l$P-l$w)+l$L>l$r.x&&l$z++}return l$z%2==1},l$n._cmds=[],l$x(l$n,["_rec",function(){return this._rec=new l$q},"_ptPoint",function(){return this._ptPoint=new l$Z}]),l$n}(),l$y=(function(){function l$b(l$i,l$_,l$R,l$r){this.char=l$i,this.charNum=l$i.charCodeAt(0),this._x=this._y=0,this.width=l$_,this.height=l$R,this.style=l$r,this.isWord=!l$b._isWordRegExp.test(l$i)}l$B(l$b,"laya.utils.HTMLChar");var l$i=l$b.prototype;l$A.imps(l$i,{"laya.display.ILayout":!0}),l$i.setSprite=function(l$i){this._sprite=l$i},l$i.getSprite=function(){return this._sprite},l$i._isChar=function(){return!0},l$i._getCSSStyle=function(){return this.style},l$h(0,l$i,"width",function(){return this._w},function(l$i){this._w=l$i}),l$h(0,l$i,"x",function(){return this._x},function(l$i){this._sprite&&(this._sprite.x=l$i),this._x=l$i}),l$h(0,l$i,"y",function(){return this._y},function(l$i){this._sprite&&(this._sprite.y=l$i),this._y=l$i}),l$h(0,l$i,"height",function(){return this._h},function(l$i){this._h=l$i}),l$b._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function l$_(){}l$B(l$_,"laya.utils.Log"),l$_.enable=function(){l$_._logdiv||(l$_._logdiv=l$s.window.document.createElement("div"),l$s.window.document.body.appendChild(l$_._logdiv),l$_._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},l$_.toggle=function(){var l$i=l$_._logdiv.style;"1px"==l$i.width?l$i.width=l$i.height="50%":l$i.width=l$i.height="1px"},l$_.print=function(l$i){l$_._logdiv&&(l$_.maxCount<=l$_._count&&l$_.clear(),l$_._count++,l$_._logdiv.innerText+=l$i+"\n",l$_._logdiv.scrollTop=l$_._logdiv.scrollHeight)},l$_.clear=function(){l$_._logdiv.innerText="",l$_._count=0},l$_._logdiv=null,l$_._count=0,l$_.maxCount=20}(),function(){function l$_(){}l$B(l$_,"laya.utils.Mouse"),l$h(1,l$_,"cursor",function(){return l$_._style.cursor},function(l$i){l$_._style.cursor=l$i}),l$_.hide=function(){"none"!=l$_.cursor&&(l$_._preCursor=l$_.cursor,l$_.cursor="none")},l$_.show=function(){"none"==l$_.cursor&&(l$_.cursor=l$_._preCursor?l$_._preCursor:"auto")},l$_._preCursor=null,l$x(l$_,["_style",function(){return this._style=l$s.document.body.style}])}(),function(){function l$z(){}return l$B(l$z,"laya.utils.Pool"),l$z.getPoolBySign=function(l$i){return l$z._poolDic[l$i]||(l$z._poolDic[l$i]=[])},l$z.clearBySign=function(l$i){l$z._poolDic[l$i]&&(l$z._poolDic[l$i].length=0)},l$z.recover=function(l$i,l$_){l$_.__InPool||(l$_.__InPool=!0,l$z.getPoolBySign(l$i).push(l$_))},l$z.getItemByClass=function(l$i,l$_){var l$R=l$z.getPoolBySign(l$i),l$r=l$R.length?l$R.pop():new l$_;return l$r.__InPool=!1,l$r},l$z.getItemByCreateFun=function(l$i,l$_,l$R){var l$r=l$z.getPoolBySign(l$i),l$b=l$r.length?l$r.pop():l$_.call(l$R);return l$b.__InPool=!1,l$b},l$z.getItem=function(l$i){var l$_=l$z.getPoolBySign(l$i),l$R=l$_.length?l$_.pop():null;return l$R&&(l$R.__InPool=!1),l$R},l$z._poolDic={},l$z.InPoolSign="__InPool",l$z}()),l$a=function(){function l$x(){}return l$B(l$x,"laya.utils.Stat"),l$h(1,l$x,"onclick",null,function(l$i){l$x._sp&&l$x._sp.on("click",l$x._sp,l$i),l$x._canvas&&(l$x._canvas.source.onclick=l$i,l$x._canvas.source.style.pointerEvents="")}),l$x.show=function(l$i,l$_,l$R){if(void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),!l$p.isConchApp||l$p.isConchWebGL){if(l$p.isConchWebGL||l$s.onMiniGame||l$s.onLimixiu||(l$x._useCanvas=!0),l$x._show=!0,l$x._fpsData.length=60,l$x._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},l$x._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},l$x._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},l$x._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},l$p.isWebGL)if(l$x._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},l$p.is3DMode){if(l$x._view[0].title="FPS(3D)",l$x._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},l$x._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},l$x._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==l$R){var l$r=8;l$x._view[l$r++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},l$x._view[l$r++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},l$x._view[l$r++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},l$x._view[l$r++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},l$x._view[l$r++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},l$x._view[l$r++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},l$x._view[l$r++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},l$x._view[l$r++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},l$x._view[l$r++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==l$R){l$r=8;l$x._view[l$r++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},l$x._view[l$r++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},l$x._view[l$r++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},l$x._view[l$r++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},l$x._view[l$r++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},l$x._view[l$r++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},l$x._view[l$r++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else l$x._view[0].title="FPS(WebGL)",l$x._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else l$x._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};l$x._useCanvas?l$x.createUIPre(l$i,l$_):l$x.createUI(l$i,l$_),l$x.enable()}else l$s.window.conch.showFPS&&l$s.window.conch.showFPS(l$i,l$_)},l$x.createUIPre=function(l$i,l$_){var l$R=l$s.pixelRatio;l$x._width=170*l$R,l$x._vx=75*l$R,l$x._height=l$R*(12*l$x._view.length+3*l$R)+4,l$x._fontSize=12*l$R;for(var l$r=0;l$r<l$x._view.length;l$r++)l$x._view[l$r].x=4,l$x._view[l$r].y=l$r*l$x._fontSize+2*l$R;l$x._canvas||((l$x._canvas=new l$Ii("2D")).size(l$x._width,l$x._height),(l$x._ctx=l$x._canvas.getContext("2d")).textBaseline="top",l$x._ctx.font=l$x._fontSize+"px Sans-serif",l$x._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+l$i+"px;top:"+l$_+"px;width:"+l$x._width/l$R+"px;height:"+l$x._height/l$R+"px;"),l$x._first=!0,l$x.loop(),l$x._first=!1,l$s.container.appendChild(l$x._canvas.source)},l$x.createUI=function(l$i,l$_){var l$R=l$x._sp,l$r=l$s.pixelRatio;l$R||(l$R=new l$ni,(l$x._leftText=new l$Ni).pos(5,5),l$x._leftText.color="#ffffff",l$R.addChild(l$x._leftText),(l$x._txt=new l$Ni).pos(80*l$r,5),l$x._txt.color="#ffffff",l$R.addChild(l$x._txt),l$x._sp=l$R),l$R.pos(l$i,l$_);for(var l$b="",l$z=0;l$z<l$x._view.length;l$z++){l$b+=l$x._view[l$z].title+"\n"}l$x._leftText.text=l$b;var l$L=170*l$r,l$w=l$r*(12*l$x._view.length+3*l$r)+4;l$x._txt.fontSize=l$x._fontSize*l$r,l$x._leftText.fontSize=l$x._fontSize*l$r,l$R.size(l$L,l$w),l$R.graphics.clear(),l$R.graphics.setAlpha(.5),l$R.graphics.drawRect(0,0,l$L,l$w,"#999999"),l$R.graphics.setAlpha(1),l$x.loop()},l$x.enable=function(){l$A.timer.frameLoop(1,l$x,l$x.loop)},l$x.hide=function(){l$x._show=!1,l$A.timer.clear(l$x,l$x.loop),l$x._canvas&&l$s.removeElement(l$x._canvas.source)},l$x.clear=function(){l$x.trianglesFaces=l$x.drawCall=l$x.shaderCall=l$x.spriteCount=l$x.spriteRenderUseCacheCount=l$x.treeNodeCollision=l$x.treeSpriteCollision=l$x.canvasNormal=l$x.canvasBitmap=l$x.canvasReCache=0},l$x.loop=function(){l$x._count++;var l$i=l$s.now();if(!(l$i-l$x._timer<1e3)){var l$_=l$x._count;if(l$x.FPS=Math.round(1e3*l$_/(l$i-l$x._timer)),l$x._show){l$x.trianglesFaces=Math.round(l$x.trianglesFaces/l$_),l$x.spriteCount=l$x._useCanvas?(l$x.drawCall=Math.round(l$x.drawCall/l$_)-2,l$x.shaderCall=Math.round(l$x.shaderCall/l$_),Math.round(l$x.spriteCount/l$_)-1):(l$x.drawCall=Math.round(l$x.drawCall/l$_)-2,l$x.shaderCall=Math.round(l$x.shaderCall/l$_)-4,Math.round(l$x.spriteCount/l$_)-4),l$x.spriteRenderUseCacheCount=Math.round(l$x.spriteRenderUseCacheCount/l$_),l$x.canvasNormal=Math.round(l$x.canvasNormal/l$_),l$x.canvasBitmap=Math.round(l$x.canvasBitmap/l$_),l$x.canvasReCache=Math.ceil(l$x.canvasReCache/l$_),l$x.treeNodeCollision=Math.round(l$x.treeNodeCollision/l$_),l$x.treeSpriteCollision=Math.round(l$x.treeSpriteCollision/l$_);var l$R=0<l$x.FPS?Math.floor(1e3/l$x.FPS).toString():" ";l$x._fpsStr=l$x.FPS+(l$x.renderSlow?" slow":"")+" "+l$R,l$x._spriteStr=l$x.spriteCount+(l$x.spriteRenderUseCacheCount?"/"+l$x.spriteRenderUseCacheCount:""),l$x._canvasStr=l$x.canvasReCache+"/"+l$x.canvasNormal+"/"+l$x.canvasBitmap,l$x.currentMemorySize=l$E.systemResourceManager.memorySize,l$x._useCanvas?l$x.renderInfoPre():l$x.renderInfo(),l$x.clear()}l$x._count=0,l$x._timer=l$i}},l$x.renderInfoPre=function(){if(l$x._canvas){var l$i=l$x._ctx;l$i.clearRect(l$x._first?0:l$x._vx,0,l$x._width,l$x._height);for(var l$_=l$p.WebGL.mainContext,l$R=0;l$R<l$x._view.length;l$R++){var l$r=l$x._view[l$R];l$x._first&&(l$i.fillStyle="white",l$i.fillText(l$r.title,l$r.x,l$r.y,null,null,null)),l$i.fillStyle=l$r.color;var l$b=-1;if((l$r=l$x._view[l$R]).varying){if(l$_)switch(l$r.varying){case 1:l$b=l$_.getParameter(l$_[l$r.value]);break;case 2:l$b=l$_.getExtension(l$r.value)}}else l$b=l$x[l$r.value];"M"==l$r.units&&(l$b=Math.floor(l$b/1048576*100)/100+" M"),"K"==l$r.units&&(l$b=Math.floor(l$b/1024*100)/100+" K"),"string"==l$r.units&&(l$b=l$b.match(/\d+\.?\d/i)),l$i.fillText(l$b+"",l$r.x+l$x._vx,l$r.y,null,null,null)}}},l$x.renderInfo=function(){for(var l$i="",l$_=l$p.WebGL.mainContext,l$R=0;l$R<l$x._view.length;l$R++){var l$r=l$x._view[l$R],l$b=-1;if(l$r.varying){if(l$_)switch(l$r.varying){case 1:l$b=l$_.getParameter(l$_[l$r.value]);break;case 2:l$b=l$_.getExtension(l$r.value)}}else l$b=l$x[l$r.value];"M"==l$r.units&&(l$b=Math.floor(l$b/1048576*100)/100+" M"),"K"==l$r.units&&(l$b=Math.floor(l$b/1024*100)/100+" K"),"string"==l$r.units&&(l$b=l$b.match(/\d+\.?\d/i)),l$i+=l$b+"\n"}l$x._txt.text=l$i},l$x.FPS=0,l$x.loopCount=0,l$x.shaderCall=0,l$x.drawCall=0,l$x.trianglesFaces=0,l$x.spriteCount=0,l$x.spriteRenderUseCacheCount=0,l$x.treeNodeCollision=0,l$x.treeSpriteCollision=0,l$x.canvasNormal=0,l$x.canvasBitmap=0,l$x.canvasReCache=0,l$x.renderSlow=!1,l$x.currentMemorySize=0,l$x._fpsStr=null,l$x._canvasStr=null,l$x._spriteStr=null,l$x._fpsData=[],l$x._timer=0,l$x._count=0,l$x._view=[],l$x._fontSize=12,l$x._txt=null,l$x._leftText=null,l$x._sp=null,l$x._show=!1,l$x._useCanvas=!1,l$x._canvas=null,l$x._ctx=null,l$x._first=!1,l$x._vx=NaN,l$x._width=0,l$x._height=100,l$x}(),l$F=(function(){function l$i(){this._strsToID={},this._idToStrs=[],this._length=0}l$B(l$i,"laya.utils.StringKey");var l$_=l$i.prototype;l$_.add=function(l$i){var l$_=this._strsToID[l$i];return null!=l$_?l$_:(this._idToStrs[this._length]=l$i,this._strsToID[l$i]=this._length++)},l$_.getID=function(l$i){var l$_=this._strsToID[l$i];return null==l$_?-1:l$_},l$_.getName=function(l$i){var l$_=this._idToStrs[l$i];return null==l$_?void 0:l$_}}(),function(){var l$P;function l$i(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}l$B(l$i,"laya.utils.Timer");var l$_=l$i.prototype;return l$_._init=function(){l$A.timer&&l$A.timer.frameLoop(1,this,this._update)},l$_._now=function(){return Date.now()},l$_._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var l$i=this.currFrame=this.currFrame+this.scale,l$_=this._now();this._delta=(l$_-this._lastTimer)*this.scale;var l$R=this.currTimer=this.currTimer+this._delta;l$A.isDebug&&6e4<Math.abs(l$_-this._lastTimer)&&console.error("系统时间错误！"+(l$_-this._lastTimer)),this._lastTimer=l$_;var l$r=this._handlers;for(l$L=this._count=0,l$w=l$r.length;l$L<l$w;l$L++)if(null!==(l$x=l$r[l$L]).method){var l$b=l$x.userFrame?l$i:l$R;if(l$b>=l$x.exeTime)if(l$x.repeat)if(l$x.jumpFrame)for(;l$b>=l$x.exeTime;)l$x.exeTime+=l$x.delay,l$x.run(!1);else l$x.exeTime+=l$x.delay,l$x.run(!1),l$b>l$x.exeTime&&(l$x.exeTime+=Math.ceil((l$b-l$x.exeTime)/l$x.delay)*l$x.delay);else l$x.run(!0)}else this._count++;(30<this._count||l$i%200==0)&&this._clearHandlers();for(var l$z=this._laters,l$L=0,l$w=l$z.length-1;l$L<=l$w;l$L++){var l$x=l$z[l$L];this._isIgnoreRecover(l$x)||(null!==l$x.method&&(delete this._map[l$x.key],l$x.run(!1)),this._recoverHandler(l$x)),l$L===l$w&&(l$w=l$z.length-1)}l$z.length=0}},l$_._clearHandlers=function(){for(var l$i=this._handlers,l$_=0,l$R=l$i.length;l$_<l$R;l$_++){var l$r=l$i[l$_];null!==l$r.method?this._temp.push(l$r):this._isIgnoreRecover(l$r)?this._temp.push(l$r):this._recoverHandler(l$r)}this._handlers=this._temp,this._temp=l$i,this._temp.length=0},l$_._recoverHandler=function(l$i){this._map[l$i.key]==l$i&&delete this._map[l$i.key],l$i.recover()},l$_._create=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){if(!l$R)return l$b.apply(l$r,l$z),null;if(l$L){var l$x=this._getHandler(l$r,l$b);if(l$x)return l$x.repeat=l$_,l$x.userFrame=l$i,l$x.delay=l$R,l$x.ignoreRecover=l$w,l$x.caller=l$r,l$x.method=l$b,l$x.args=l$z,l$x.exeTime=l$R+(l$i?this.currFrame:this.currTimer+this._now()-this._lastTimer),l$x}return(l$x=l$P.create()).repeat=l$_,l$x.userFrame=l$i,l$x.delay=l$R,l$x.ignoreRecover=l$w,l$x.caller=l$r,l$x.method=l$b,l$x.args=l$z,l$x.exeTime=l$R+(l$i?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(l$x),this._handlers.push(l$x),l$x},l$_._indexHandler=function(l$i){var l$_=l$i.caller,l$R=l$i.method,l$r=l$_?l$_.$_GID||(l$_.$_GID=l$Q.getGID()):0,l$b=l$R.$_TID||(l$R.$_TID=this._mid++);l$i.key=l$r+"_"+l$b,this._map[l$i.key]=l$i},l$_.once=function(l$i,l$_,l$R,l$r,l$b){void 0===l$b&&(l$b=!0),this._create(!1,!1,l$i,l$_,l$R,l$r,l$b,!1)},l$_.loop=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){void 0===l$b&&(l$b=!0),void 0===l$z&&(l$z=!1),void 0===l$L&&(l$L=!1);var l$w=this._create(!1,!0,l$i,l$_,l$R,l$r,l$b,l$L);l$w&&(l$w.jumpFrame=l$z)},l$_.frameOnce=function(l$i,l$_,l$R,l$r,l$b){void 0===l$b&&(l$b=!0),this._create(!0,!1,l$i,l$_,l$R,l$r,l$b,!1)},l$_.frameLoop=function(l$i,l$_,l$R,l$r,l$b,l$z){void 0===l$b&&(l$b=!0),void 0===l$z&&(l$z=!1),this._create(!0,!0,l$i,l$_,l$R,l$r,l$b,l$z)},l$_.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+l$P._freeCount},l$_.clear=function(l$i,l$_){var l$R=this._getHandler(l$i,l$_);return!(!l$R||this._isIgnoreRecover(l$R))&&(delete this._map[l$R.key],l$R.key=null,l$R.clear(),!0)},l$_.clearAll=function(l$i){if(l$i)for(var l$_=0,l$R=this._handlers.length;l$_<l$R;l$_++){var l$r=this._handlers[l$_];l$r.caller===l$i&&(this._isIgnoreRecover(l$r)||(delete this._map[l$r.key],l$r.key=null,l$r.clear()))}},l$_._getHandler=function(l$i,l$_){var l$R=l$i?l$i.$_GID||(l$i.$_GID=l$Q.getGID()):0,l$r=l$_.$_TID||(l$_.$_TID=this._mid++);return this._map[l$R+"_"+l$r]},l$_._isIgnoreRecover=function(l$i){if(l$i.ignoreRecover||l$i.caller&&"IgnoreRecover"==l$i.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var l$_="";try{arguments.propertyIsEnumerable.caller}catch(l$i){l$_=l$i.stack}l$A.recordError("报错：核心定时器销毁忽略  "+l$_)}return!0}return!1},l$_.hasHandler=function(l$i,l$_){return this._map[l$i.$_GID+"_"+l$_.$_TID]},l$_.callLater=function(l$i,l$_,l$R){if(null==this._getHandler(l$i,l$_)){var l$r=l$P.create();l$r.caller=l$i,l$r.method=l$_,l$r.args=l$R,this._indexHandler(l$r),this._laters.push(l$r)}},l$_.runCallLater=function(l$i,l$_){var l$R=this._getHandler(l$i,l$_);l$R&&null!=l$R.method&&(this._isIgnoreRecover(l$R)||(delete this._map[l$R.key],l$R.run(!0)))},l$_.runTimer=function(l$i,l$_){this.runCallLater(l$i,l$_)},l$h(0,l$_,"delta",function(){return this._delta}),l$i.__init$=function(){l$P=function(){function l$_(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}l$B(l$_,"");var l$i=l$_.prototype;return l$i.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},l$i.recover=function(){this.clear(),this.args=l$_._freeHandler,l$_._freeHandler=this,l$_._freeCount++},l$i.run=function(l$i){var l$_=this.caller;if(l$_&&l$_.destroyed)return this.clear();var l$R=this.method,l$r=this.args;l$i&&this.clear(),null!=l$R&&(l$r?l$R.apply(l$_,l$r):l$R.call(l$_))},l$_._freeHandler=null,l$_._freeCount=0,l$_.create=function(){var l$i=l$_._freeHandler;return l$i?(l$_._freeHandler=l$i.args,--l$_._freeCount,l$i.args=null,l$i):new l$_},l$_}()},l$i}()),l$d=function(){function l$n(){this.gid=0}l$B(l$n,"laya.utils.Tween");var l$i=l$n.prototype;return l$i.to=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){return void 0===l$z&&(l$z=0),void 0===l$L&&(l$L=!1),this._create(l$i,l$_,l$R,l$r,l$b,l$z,l$L,!0,!1,!0)},l$i.from=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){return void 0===l$z&&(l$z=0),void 0===l$L&&(l$L=!1),this._create(l$i,l$_,l$R,l$r,l$b,l$z,l$L,!1,!1,!0)},l$i._create=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){if(!l$i)throw new Error("Tween:target is null");this._target=l$i,this._duration=l$R,this._ease=l$r||l$_.ease||l$n.easeNone,this._complete=l$b||l$_.complete,this._delay=l$z,this._props=[],this._usedTimer=0,this._startTimer=l$s.now(),this._usedPool=l$x,this._delayParam=null,this.update=l$_.update;var l$B=l$i.$_GID||(l$i.$_GID=l$Q.getGID());return l$n.tweenMap[l$B]?(l$L&&l$n.clearTween(l$i),l$n.tweenMap[l$B].push(this)):l$n.tweenMap[l$B]=[this],l$P?l$z<=0?this.firstStart(l$i,l$_,l$w):(this._delayParam=[l$i,l$_,l$w],l$A.scaleTimer.once(l$z,this,this.firstStart,this._delayParam)):this._initProps(l$i,l$_,l$w),this},l$i.firstStart=function(l$i,l$_,l$R){this._delayParam=null,l$i.destroyed?this.clear():(this._initProps(l$i,l$_,l$R),this._beginLoop())},l$i._initProps=function(l$i,l$_,l$R){for(var l$r in l$_)if("number"==typeof l$i[l$r]){var l$b=l$R?l$i[l$r]:l$_[l$r],l$z=l$R?l$_[l$r]:l$i[l$r];this._props.push([l$r,l$b,l$z-l$b]),l$R||(l$i[l$r]=l$b)}},l$i._beginLoop=function(){l$A.scaleTimer.frameLoop(1,this,this._doEase)},l$i._doEase=function(){this._updateEase(l$s.now())},l$i._updateEase=function(l$i){var l$_=this._target;if(l$_){if(l$_.destroyed)return l$n.clearTween(l$_);var l$R=this._usedTimer=l$i-this._startTimer-this._delay;if(!(l$R<0)){if(l$R>=this._duration)return this.complete();for(var l$r=0<l$R?this._ease(l$R,0,1,this._duration):0,l$b=this._props,l$z=0,l$L=l$b.length;l$z<l$L;l$z++){var l$w=l$b[l$z];l$_[l$w[0]]=l$w[1]+l$r*l$w[2]}this.update&&this.update.run()}}},l$i.complete=function(){if(this._target){l$A.scaleTimer.runTimer(this,this.firstStart);for(var l$i=this._target,l$_=this._props,l$R=this._complete,l$r=0,l$b=l$_.length;l$r<l$b;l$r++){var l$z=l$_[l$r];l$i[l$z[0]]=l$z[1]+l$z[2]}this.update&&this.update.run(),this.clear(),l$R&&l$R.run()}},l$i.pause=function(){l$A.scaleTimer.clear(this,this._beginLoop),l$A.scaleTimer.clear(this,this._doEase),l$A.scaleTimer.clear(this,this.firstStart);var l$i;(l$i=l$s.now()-this._startTimer-this._delay)<0&&(this._usedTimer=l$i)},l$i.setStartTime=function(l$i){this._startTimer=l$i},l$i.clear=function(){this._target&&(this._remove(),this._clear())},l$i._clear=function(){this.pause(),l$A.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,l$y.recover("tween",this))},l$i.recover=function(){this._usedPool=!0,this._clear()},l$i._remove=function(){var l$i=l$n.tweenMap[this._target.$_GID];if(l$i)for(var l$_=0,l$R=l$i.length;l$_<l$R;l$_++)if(l$i[l$_]===this){l$i.splice(l$_,1);break}},l$i.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=l$s.now(),this._delayParam)l$A.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var l$i=this._props,l$_=0,l$R=l$i.length;l$_<l$R;l$_++){var l$r=l$i[l$_];this._target[l$r[0]]=l$r[1]}l$A.scaleTimer.once(this._delay,this,this._beginLoop)}},l$i.resume=function(){this._usedTimer>=this._duration||(this._startTimer=l$s.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?l$A.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},l$h(0,l$i,"progress",null,function(l$i){var l$_=l$i*this._duration;this._startTimer=l$s.now()-this._delay-l$_}),l$n.to=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){return void 0===l$z&&(l$z=0),void 0===l$L&&(l$L=!1),void 0===l$w&&(l$w=!0),l$y.getItemByClass("tween",l$n)._create(l$i,l$_,l$R,l$r,l$b,l$z,l$L,!0,l$w,!0)},l$n.from=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){return void 0===l$z&&(l$z=0),void 0===l$L&&(l$L=!1),void 0===l$w&&(l$w=!0),l$y.getItemByClass("tween",l$n)._create(l$i,l$_,l$R,l$r,l$b,l$z,l$L,!1,l$w,!0)},l$n.clearAll=function(l$i){if(l$i&&l$i.$_GID){var l$_=l$n.tweenMap[l$i.$_GID];if(l$_){for(var l$R=0,l$r=l$_.length;l$R<l$r;l$R++)l$_[l$R]._clear();l$_.length=0}}},l$n.clear=function(l$i){l$i.clear()},l$n.clearTween=function(l$i){l$n.clearAll(l$i)},l$n.easeNone=function(l$i,l$_,l$R,l$r){return l$R*l$i/l$r+l$_},l$n.tweenMap={},l$n}(),l$Q=function(){function l$w(){}return l$B(l$w,"laya.utils.Utils"),l$w.toRadian=function(l$i){return l$i*l$w._pi2},l$w.toAngle=function(l$i){return l$i*l$w._pi},l$w.toHexColor=function(l$i){if(l$i<0||isNaN(l$i))return null;for(var l$_=l$i.toString(16);l$_.length<6;)l$_="0"+l$_;return"#"+l$_},l$w.getGID=function(){return l$w._gid++},l$w.concatArray=function(l$i,l$_){if(!l$_)return l$i;if(!l$i)return l$_;var l$R=0,l$r=l$_.length;for(l$R=0;l$R<l$r;l$R++)l$i.push(l$_[l$R]);return l$i},l$w.clearArray=function(l$i){return l$i&&(l$i.length=0),l$i},l$w.copyArray=function(l$i,l$_){if(l$i||(l$i=[]),!l$_)return l$i;l$i.length=l$_.length;var l$R=0,l$r=l$_.length;for(l$R=0;l$R<l$r;l$R++)l$i[l$R]=l$_[l$R];return l$i},l$w.getGlobalRecByPoints=function(l$i,l$_,l$R,l$r,l$b){var l$z,l$L;return l$z=new l$Z(l$_,l$R),l$z=l$i.localToGlobal(l$z),l$L=new l$Z(l$r,l$b),l$L=l$i.localToGlobal(l$L),l$q._getWrapRec([l$z.x,l$z.y,l$L.x,l$L.y])},l$w.getGlobalPosAndScale=function(l$i){return l$w.getGlobalRecByPoints(l$i,0,0,1,1)},l$w.bind=function(l$i,l$_){return l$i.bind(l$_)},l$w.measureText=function(l$i,l$_){return l$$.measureText(l$i,l$_)},l$w.contextMeasureText=function(l$i){var l$_=l$s.context.measureText(l$i);return l$_||(l$_={width:16,height:16}),l$_},l$w.updateOrder=function(l$i){if(!l$i||l$i.length<2)return!1;for(var l$_,l$R=1,l$r=0,l$b=l$i.length,l$z=NaN;l$R<l$b;){for(l$_=l$i[l$r=l$R],l$z=l$i[l$r]._zOrder;-1<--l$r&&l$i[l$r]._zOrder>l$z;)l$i[l$r+1]=l$i[l$r];l$i[l$r+1]=l$_,l$R++}var l$L=l$_.parent.conchModel;if(l$L)if(null!=l$L.updateZOrder)l$L.updateZOrder();else{for(l$R=0;l$R<l$b;l$R++)l$L.removeChild(l$i[l$R].conchModel);for(l$R=0;l$R<l$b;l$R++)l$L.addChildAt(l$i[l$R].conchModel,l$R)}return!0},l$w.transPointList=function(l$i,l$_,l$R){var l$r=0,l$b=l$i.length;for(l$r=0;l$r<l$b;l$r+=2)l$i[l$r]+=l$_,l$i[l$r+1]+=l$R},l$w.parseInt=function(l$i,l$_){void 0===l$_&&(l$_=0);var l$R=l$s.window.parseInt(l$i,l$_);return isNaN(l$R)?0:l$R},l$w.getFileExtension=function(l$i){l$w._extReg.lastIndex=l$i.lastIndexOf(".");var l$_=l$w._extReg.exec(l$i);return l$_&&1<l$_.length?l$_[1].toLowerCase():null},l$w.getTransformRelativeToWindow=function(l$i,l$_,l$R){var l$r=l$A.stage,l$b=laya.utils.Utils.getGlobalPosAndScale(l$i),l$z=l$r._canvasTransform.clone(),l$L=l$z.tx,l$w=l$z.ty;l$z.rotate(-Math.PI/180*l$A.stage.canvasDegree),l$z.scale(l$A.stage.clientScaleX,l$A.stage.clientScaleY);var l$x=l$A.stage.canvasDegree%180!=0,l$P=NaN,l$B=NaN;l$x?(l$P=l$R+l$b.y,l$B=l$_+l$b.x,l$P*=l$z.d,l$B*=l$z.a,90==l$A.stage.canvasDegree?(l$P=l$L-l$P,l$B+=l$w):(l$P+=l$L,l$B=l$w-l$B)):(l$P=l$_+l$b.x,l$B=l$R+l$b.y,l$P*=l$z.a,l$B*=l$z.d,l$P+=l$L,l$B+=l$w);var l$n=NaN,l$f=NaN;return l$f=l$x?(l$n=l$z.d*l$b.height,l$z.a*l$b.width):(l$n=l$z.a*l$b.width,l$z.d*l$b.height),{x:l$P,y:l$B,scaleX:l$n,scaleY:l$f}},l$w.fitDOMElementInArea=function(l$i,l$_,l$R,l$r,l$b,l$z){l$i._fitLayaAirInitialized||(l$i._fitLayaAirInitialized=!0,l$i.style.transformOrigin=l$i.style.webKittransformOrigin="left top",l$i.style.position="absolute");var l$L=l$w.getTransformRelativeToWindow(l$_,l$R,l$r);l$i.style.transform=l$i.style.webkitTransform="scale("+l$L.scaleX+","+l$L.scaleY+") rotate("+l$A.stage.canvasDegree+"deg)",l$i.style.width=l$b+"px",l$i.style.height=l$z+"px",l$i.style.left=l$L.x+"px",l$i.style.top=l$L.y+"px"},l$w.isOkTextureList=function(l$i){if(!l$i)return!1;var l$_,l$R=0,l$r=l$i.length;for(l$R=0;l$R<l$r;l$R++)if(!(l$_=l$i[l$R])||!l$_.source)return!1;return!0},l$w.isOKCmdList=function(l$i){if(!l$i)return!1;var l$_,l$R,l$r=0,l$b=l$i.length,l$z=l$p._context;for(l$r=0;l$r<l$b;l$r++)switch((l$_=l$i[l$r]).callee){case l$z._drawTexture:case l$z._fillTexture:case l$z._drawTextureWithTransform:if(!(l$R=l$_[0])||!l$R.source)return!1}return!0},l$w._gid=1,l$w._pi=180/Math.PI,l$w._pi2=Math.PI/180,l$w._extReg=/\.(\w+)\??/g,l$w.parseXMLFromString=function(l$i){var l$_;if(l$i=l$i.replace(/>\s+</g,"><"),-1<(l$_=(new DOMParser).parseFromString(l$i,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(l$_.firstChild.firstChild.textContent);return l$_},l$w}(),l$H=function(){function l$i(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],l$p.isWebGL&&l$C.regCacheByFunction(l$Q.bind(this.startDispose,this),l$Q.bind(this.getCacheList,this))}l$B(l$i,"laya.utils.VectorGraphManager");var l$_=l$i.prototype;return l$_.getId=function(){return this._id++},l$_.addShape=function(l$i,l$_){this.shapeDic[l$i]=l$_,this.useDic[l$i]||(this.useDic[l$i]=!0)},l$_.addLine=function(l$i,l$_){this.shapeLineDic[l$i]=l$_,this.shapeLineDic[l$i]||(this.shapeLineDic[l$i]=!0)},l$_.getShape=function(l$i){this._checkKey&&null!=this.useDic[l$i]&&(this.useDic[l$i]=!0)},l$_.deleteShape=function(l$i){this.shapeDic[l$i]&&(this.shapeDic[l$i]=null,delete this.shapeDic[l$i]),this.shapeLineDic[l$i]&&(this.shapeLineDic[l$i]=null,delete this.shapeLineDic[l$i]),null!=this.useDic[l$i]&&delete this.useDic[l$i]},l$_.getCacheList=function(){var l$i,l$_=[];for(l$i in this.shapeDic)l$_.push(this.shapeDic[l$i]);for(l$i in this.shapeLineDic)l$_.push(this.shapeLineDic[l$i]);return l$_},l$_.startDispose=function(l$i){var l$_;for(l$_ in this.useDic)this.useDic[l$_]=!1;this._checkKey=!0},l$_.endDispose=function(){if(this._checkKey){var l$i;for(l$i in this.useDic)this.useDic[l$i]||this.deleteShape(l$i);this._checkKey=!1}},l$i.getInstance=function(){return l$i.instance=l$i.instance||new l$i},l$i.instance=null,l$i}(),l$W=function(){function l$r(){this._obj=null,this._obj=l$r.supportWeakMap?new l$s.window.WeakMap:{},l$r.supportWeakMap||l$r._maps.push(this)}l$B(l$r,"laya.utils.WeakObject");var l$i=l$r.prototype;return l$i.set=function(l$i,l$_){if(null!=l$i)if(l$r.supportWeakMap){var l$R=l$i;"string"!=typeof l$i&&"number"!=typeof l$i||(l$R=l$r._keys[l$i])||(l$R=l$r._keys[l$i]={k:l$i}),this._obj.set(l$R,l$_)}else"string"==typeof l$i||"number"==typeof l$i?this._obj[l$i]=l$_:(l$i.$_GID||(l$i.$_GID=l$Q.getGID()),this._obj[l$i.$_GID]=l$_)},l$i.get=function(l$i){if(null==l$i)return null;if(l$r.supportWeakMap){var l$_="string"==typeof l$i||"number"==typeof l$i?l$r._keys[l$i]:l$i;return l$_?this._obj.get(l$_):null}return"string"==typeof l$i||"number"==typeof l$i?this._obj[l$i]:this._obj[l$i.$_GID]},l$i.del=function(l$i){if(null!=l$i)if(l$r.supportWeakMap){var l$_="string"==typeof l$i||"number"==typeof l$i?l$r._keys[l$i]:l$i;if(!l$_)return;this._obj.delete(l$_)}else"string"==typeof l$i||"number"==typeof l$i?delete this._obj[l$i]:delete this._obj[this._obj.$_GID]},l$i.has=function(l$i){if(null==l$i)return!1;if(l$r.supportWeakMap){var l$_="string"==typeof l$i||"number"==typeof l$i?l$r._keys[l$i]:l$i;return this._obj.has(l$_)}return"string"==typeof l$i||"number"==typeof l$i?null!=this._obj[l$i]:null!=this._obj[this._obj.$_GID]},l$r.__init__=function(){(l$r.supportWeakMap=null!=l$s.window.WeakMap)||l$A.timer.loop(l$r.delInterval,null,l$r.clearCache)},l$r.clearCache=function(){for(var l$i=0,l$_=l$r._maps.length;l$i<l$_;l$i++){l$r._maps[l$i]._obj={}}},l$r.supportWeakMap=!1,l$r.delInterval=3e5,l$r._keys={},l$r._maps=[],l$x(l$r,["I",function(){return this.I=new l$r}]),l$r}(),l$T=function(){function l$i(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}l$B(l$i,"laya.utils.WordText");var l$_=l$i.prototype;return l$_.setText=function(l$i){this.changed=!0,this._text=l$i},l$_.toString=function(){return this._text},l$_.charCodeAt=function(l$i){return this._text?this._text.charCodeAt(l$i):NaN},l$_.charAt=function(l$i){return this._text?this._text.charAt(l$i):null},l$h(0,l$_,"length",function(){return this._text?this._text.length:0}),l$i}(),l$ii=function(l$i){function l$L(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,l$L.__super.call(this),this._childs=l$L.ARRAY_EMPTY,this._$P=l$L.PROP_EMPTY,this.timer=l$A.scaleTimer,this.conchModel=l$p.isConchNode?this.createConchModel():null}l$B(l$L,"laya.display.Node",l$P);var l$_=l$L.prototype;return l$_._setBit=function(l$i,l$_){1==l$i&&(this._getBit(l$i)!=l$_&&this._updateDisplayedInstage());l$_?this._bits|=l$i:this._bits&=~l$i},l$_._getBit=function(l$i){return 0!=(this._bits&l$i)},l$_._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},l$_._setUpNoticeType=function(l$i){var l$_=this;for(l$_._setBit(l$i,!0),l$_=l$_.parent;l$_;){if(l$_._getBit(l$i))return;l$_._setBit(l$i,!0),l$_=l$_.parent}},l$_.on=function(l$i,l$_,l$R,l$r){return"display"!==l$i&&"undisplay"!==l$i||this._getBit(1)||this._setUpNoticeType(1),this._createListener(l$i,l$_,l$R,l$r,!1)},l$_.once=function(l$i,l$_,l$R,l$r){return"display"!==l$i&&"undisplay"!==l$i||this._getBit(1)||this._setUpNoticeType(1),this._createListener(l$i,l$_,l$R,l$r,!0)},l$_.createConchModel=function(){return null},l$_.destroy=function(l$i){void 0===l$i&&(l$i=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(l$i?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},l$_.destroyChildren=function(){if(this._childs)for(var l$i=this._childs.length-1;-1<l$i;l$i--)this._childs[l$i].destroy(!0)},l$_.addChild=function(l$i){if(!l$i||this.destroyed||l$i===this)return l$i;if(l$i.zOrder&&this._set$P("hasZorder",!0),l$i._parent===this){var l$_=this.getChildIndex(l$i);l$_!==this._childs.length-1&&(this._childs.splice(l$_,1),this._childs.push(l$i),this.conchModel&&(this.conchModel.removeChild(l$i.conchModel),this.conchModel.addChildAt(l$i.conchModel,this._childs.length-1)),this._childChanged())}else l$i.parent&&l$i.parent.removeChild(l$i),this._childs===l$L.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(l$i),this.conchModel&&this.conchModel.addChildAt(l$i.conchModel,this._childs.length-1),(l$i.parent=this)._childChanged();return l$i},l$_.addChildren=function(l$i){for(var l$_=arguments,l$R=0,l$r=l$_.length;l$R<l$r;)this.addChild(l$_[l$R++])},l$_.addChildAt=function(l$i,l$_){if(!l$i||this.destroyed||l$i===this)return l$i;if(l$i.zOrder&&this._set$P("hasZorder",!0),0<=l$_&&l$_<=this._childs.length){if(l$i._parent===this){var l$R=this.getChildIndex(l$i);this._childs.splice(l$R,1),this._childs.splice(l$_,0,l$i),this.conchModel&&(this.conchModel.removeChild(l$i.conchModel),this.conchModel.addChildAt(l$i.conchModel,l$_)),this._childChanged()}else l$i.parent&&l$i.parent.removeChild(l$i),this._childs===l$L.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(l$_,0,l$i),this.conchModel&&this.conchModel.addChildAt(l$i.conchModel,l$_),l$i.parent=this;return l$i}throw new Error("appendChildAt:The index is out of bounds")},l$_.getChildIndex=function(l$i){return this._childs.indexOf(l$i)},l$_.getChildByName=function(l$i){var l$_=this._childs;if(l$_)for(var l$R=0,l$r=l$_.length;l$R<l$r;l$R++){var l$b=l$_[l$R];if(l$b.name===l$i)return l$b}return null},l$_._get$P=function(l$i){return this._$P[l$i]},l$_._set$P=function(l$i,l$_){return this.destroyed||(this._$P===l$L.PROP_EMPTY&&(this._$P={}),this._$P[l$i]=l$_),l$_},l$_.getChildAt=function(l$i){return this._childs[l$i]},l$_.setChildIndex=function(l$i,l$_){var l$R=this._childs;if(l$_<0||l$_>=l$R.length)throw new Error("setChildIndex:The index is out of bounds.");var l$r=this.getChildIndex(l$i);if(l$r<0)throw new Error("setChildIndex:node is must child of this object.");return l$R.splice(l$r,1),l$R.splice(l$_,0,l$i),this.conchModel&&(this.conchModel.removeChild(l$i.conchModel),this.conchModel.addChildAt(l$i.conchModel,l$_)),this._childChanged(),l$i},l$_._childChanged=function(l$i){},l$_.removeChild=function(l$i){if(!this._childs)return l$i;var l$_=this._childs.indexOf(l$i);return this.removeChildAt(l$_)},l$_.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},l$_.removeChildByName=function(l$i){var l$_=this.getChildByName(l$i);return l$_&&this.removeChild(l$_),l$_},l$_.removeChildAt=function(l$i){var l$_=this.getChildAt(l$i);if(l$_){for(var l$R=this._childs.length-1,l$r=l$i;l$r<l$R;++l$r)this._childs[l$r]=this._childs[l$r+1];this._childs.length=l$R,this.conchModel&&this.conchModel.removeChild(l$_.conchModel),l$_.parent=null}return l$_},l$_.removeChildren=function(l$i,l$_){if(void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=2147483647),this._childs&&0<this._childs.length){var l$R=this._childs;if(0===l$i&&l$z<=l$_){var l$r=l$R;this._childs=l$L.ARRAY_EMPTY}else l$r=l$R.splice(l$i,l$_-l$i);for(var l$b=0,l$z=l$r.length;l$b<l$z;l$b++)l$r[l$b].parent=null,this.conchModel&&this.conchModel.removeChild(l$r[l$b].conchModel)}return this},l$_.replaceChild=function(l$i,l$_){var l$R=this._childs.indexOf(l$_);return-1<l$R?(this._childs.splice(l$R,1,l$i),this.conchModel&&(this.conchModel.removeChild(l$_.conchModel),this.conchModel.addChildAt(l$i.conchModel,l$R)),l$_.parent=null,l$i.parent=this,l$i):null},l$_._updateDisplayedInstage=function(){var l$i;l$i=this;var l$_=l$A.stage;for(this._displayedInStage=!1;l$i;){if(l$i._getBit(1)){this._displayedInStage=l$i._displayedInStage;break}if(l$i==l$_||l$i._displayedInStage){this._displayedInStage=!0;break}l$i=l$i.parent}},l$_._setDisplay=function(l$i){this._displayedInStage!==l$i&&((this._displayedInStage=l$i)?this.event("display"):this.event("undisplay"))},l$_._displayChild=function(l$i,l$_){var l$R=l$i._childs;if(l$R)for(var l$r=0;l$r<l$R.length;l$r++){var l$b=l$R[l$r];l$b&&l$b._getBit(1)&&(0<l$b._childs.length?this._displayChild(l$b,l$_):l$b._setDisplay(l$_))}l$i._setDisplay(l$_)},l$_.contains=function(l$i){if(l$i===this)return!0;for(;l$i;){if(l$i.parent===this)return!0;l$i=l$i.parent}return!1},l$_.timerLoop=function(l$i,l$_,l$R,l$r,l$b,l$z){void 0===l$b&&(l$b=!0),void 0===l$z&&(l$z=!1),this.timer.loop(l$i,l$_,l$R,l$r,l$b,l$z)},l$_.timerOnce=function(l$i,l$_,l$R,l$r,l$b){void 0===l$b&&(l$b=!0),this.timer._create(!1,!1,l$i,l$_,l$R,l$r,l$b)},l$_.frameLoop=function(l$i,l$_,l$R,l$r,l$b){void 0===l$b&&(l$b=!0),this.timer._create(!0,!0,l$i,l$_,l$R,l$r,l$b)},l$_.frameOnce=function(l$i,l$_,l$R,l$r,l$b){void 0===l$b&&(l$b=!0),this.timer._create(!0,!1,l$i,l$_,l$R,l$r,l$b)},l$_.clearTimer=function(l$i,l$_){this.timer.clear(l$i,l$_)},l$h(0,l$_,"numChildren",function(){return this._childs.length}),l$h(0,l$_,"destroyed",function(){return this._destroyed}),l$h(0,l$_,"parent",function(){return this._parent},function(l$i){this._parent!==l$i&&(l$i?(this._parent=l$i,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),l$i.displayedInStage&&this._displayChild(this,!0)),l$i._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=l$i))}),l$h(0,l$_,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),l$L.ARRAY_EMPTY=[],l$L.PROP_EMPTY={},l$L.NOTICE_DISPLAY=1,l$L.MOUSEENABLE=2,l$L}(),l$_i=function(l$i){function l$f(l$i){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,l$f.__super.call(this),this._padding=l$f._PADDING,this._spacing=l$f._SPACING,this._aligns=l$f._ALIGNS,this._font=l$J.EMPTY,this._ower=l$i}l$B(l$f,"laya.display.css.CSSStyle",l$i);var l$_=l$f.prototype;return l$_.destroy=function(){this._ower=null,this._font=null,this._rect=null},l$_.inherit=function(l$i){this._font=l$i._font,this._spacing=l$i._spacing===l$f._SPACING?l$f._SPACING:l$i._spacing.slice(),this.lineHeight=l$i.lineHeight},l$_._widthAuto=function(){return 0!=(262144&this._type)},l$_.widthed=function(l$i){return 0!=(8&this._type)},l$_._calculation=function(l$i,l$_){if(l$_.indexOf("%")<0)return!1;var l$r=this._ower,l$b=l$r.parent,l$z=this._rect;function l$L(l$i,l$_,l$R){return l$i*l$R[0]+l$_*l$R[1]+l$R[2]}function l$R(l$i){var l$_=l$b.width,l$R=l$r.width;l$z.width&&(l$r.width=l$L(l$_,l$R,l$z.width)),l$z.height&&(l$r.height=l$L(l$_,l$R,l$z.height)),l$z.left&&(l$r.x=l$L(l$_,l$R,l$z.left)),l$z.top&&(l$r.y=l$L(l$_,l$R,l$z.top))}null===l$z&&(l$b._getCSSStyle()._type|=524288,l$b.on("resize",this,l$R),this._rect=l$z={input:{}});var l$w=l$_.split(" ");return l$w[0]=parseFloat(l$w[0])/100,1==l$w.length?l$w[1]=l$w[2]=0:(l$w[1]=parseFloat(l$w[1])/100,l$w[2]=parseFloat(l$w[2])),l$z[l$i]=l$w,l$z.input[l$i]=l$_,l$R(),!0},l$_.heighted=function(l$i){return 0!=(8192&this._type)},l$_.size=function(l$i,l$_){var l$R=this._ower,l$r=!1;-1!==l$i&&l$i!=this._ower.width&&(this._type|=8,this._ower.width=l$i,l$r=!0),-1!==l$_&&l$_!=this._ower.height&&(this._type|=8192,this._ower.height=l$_,l$r=!0),l$r&&(l$R._layoutLater(),524288&this._type&&l$R.event("resize",this))},l$_._getAlign=function(){return this._aligns[0]},l$_._getValign=function(){return this._aligns[1]},l$_._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},l$_._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new l$J(this._font))},l$_.render=function(l$i,l$_,l$R,l$r){var l$b=l$i.width,l$z=l$i.height;l$R-=l$i.pivotX,l$r-=l$i.pivotY,this._bgground&&null!=this._bgground.color&&l$_.ctx.fillRect(l$R,l$r,l$b,l$z,this._bgground.color),this._border&&this._border.color&&l$_.drawRect(l$R,l$r,l$b,l$z,this._border.color.strColor,this._border.size)},l$_.getCSSStyle=function(){return this},l$_.cssText=function(l$i){this.attrs(l$f.parseOneCSS(l$i,";"))},l$_.attrs=function(l$i){if(l$i)for(var l$_=0,l$R=l$i.length;l$_<l$R;l$_++){var l$r=l$i[l$_];this[l$r[0]]=l$r[1]}},l$_.setTransform=function(l$i){"none"===l$i?this._tf=l$w._TF_EMPTY:this.attrs(l$f.parseOneCSS(l$i,","))},l$_.translate=function(l$i,l$_){this._tf===l$w._TF_EMPTY&&(this._tf=new l$b),this._tf.translateX=l$i,this._tf.translateY=l$_},l$_.scale=function(l$i,l$_){this._tf===l$w._TF_EMPTY&&(this._tf=new l$b),this._tf.scaleX=l$i,this._tf.scaleY=l$_},l$_._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},l$h(0,l$_,"block",l$i.prototype._$get_block,function(l$i){l$i?this._type|=1:this._type&=-2}),l$h(0,l$_,"valign",function(){return l$f._valigndef[this._aligns[1]]},function(l$i){this._aligns===l$f._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=l$f._valigndef[l$i]}),l$h(0,l$_,"height",null,function(l$i){if(this._type|=8192,"string"==typeof l$i){if(this._calculation("height",l$i))return;l$i=parseInt(l$i)}this.size(-1,l$i)}),l$h(0,l$_,"width",null,function(l$i){if(this._type|=8,"string"==typeof l$i){var l$_=l$i.indexOf("auto");if(0<=l$_&&(this._type|=262144,l$i=l$i.substr(0,l$_)),this._calculation("width",l$i))return;l$i=parseInt(l$i)}this.size(l$i,-1)}),l$h(0,l$_,"fontWeight",function(){return this._font.weight},function(l$i){this._createFont().weight=l$i}),l$h(0,l$_,"left",null,function(l$i){var l$_=this._ower;if("string"==typeof l$i){if("center"===l$i?l$i="50% -50% 0":"right"===l$i&&(l$i="100% -100% 0"),this._calculation("left",l$i))return;l$i=parseInt(l$i)}l$_.x=l$i}),l$h(0,l$_,"_translate",null,function(l$i){this.translate(l$i[0],l$i[1])}),l$h(0,l$_,"absolute",function(){return 0!=(4&this._type)}),l$h(0,l$_,"top",null,function(l$i){var l$_=this._ower;if("string"==typeof l$i){if("middle"===l$i?l$i="50% -50% 0":"bottom"===l$i&&(l$i="100% -100% 0"),this._calculation("top",l$i))return;l$i=parseInt(l$i)}l$_.y=l$i}),l$h(0,l$_,"align",function(){return l$f._aligndef[this._aligns[0]]},function(l$i){this._aligns===l$f._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=l$f._aligndef[l$i]}),l$h(0,l$_,"bold",function(){return this._font.bold},function(l$i){this._createFont().bold=l$i}),l$h(0,l$_,"padding",function(){return this._padding},function(l$i){this._padding=l$i}),l$h(0,l$_,"leading",function(){return this._spacing[1]},function(l$i){"string"==typeof l$i&&(l$i=parseInt(l$i+"")),this._spacing===l$f._SPACING&&(this._spacing=[0,0]),this._spacing[1]=l$i}),l$h(0,l$_,"lineElement",function(){return 0!=(65536&this._type)},function(l$i){l$i?this._type|=65536:this._type&=-65537}),l$h(0,l$_,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(l$i){this.lineElement=!1,"right"===l$i?this._type|=32768:this._type&=-32769}),l$h(0,l$_,"textDecoration",function(){return this._font.decoration},function(l$i){this._createFont().decoration=l$i}),l$h(0,l$_,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(l$i){"nowrap"===l$i&&(this._type|=131072),"none"===l$i&&(this._type&=-131073)}),l$h(0,l$_,"background",null,function(l$i){l$i?(this._bgground||(this._bgground={}),this._bgground.color=l$i,this._ower.conchModel&&this._ower.conchModel.bgColor(l$i),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),l$h(0,l$_,"wordWrap",function(){return 0==(131072&this._type)},function(l$i){l$i?this._type&=-131073:this._type|=131072}),l$h(0,l$_,"color",function(){return this._font.color},function(l$i){this._createFont().color=l$i}),l$h(0,l$_,"password",function(){return this._font.password},function(l$i){this._createFont().password=l$i}),l$h(0,l$_,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(l$i){"none"===l$i?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=l$i),this._ower.conchModel&&this._ower.conchModel.bgColor(l$i),this._ower._renderType|=256}),l$h(0,l$_,"font",function(){return this._font.toString()},function(l$i){this._createFont().set(l$i)}),l$h(0,l$_,"weight",null,function(l$i){this._createFont().weight=l$i}),l$h(0,l$_,"letterSpacing",function(){return this._spacing[0]},function(l$i){"string"==typeof l$i&&(l$i=parseInt(l$i+"")),this._spacing===l$f._SPACING&&(this._spacing=[0,0]),this._spacing[0]=l$i}),l$h(0,l$_,"fontSize",function(){return this._font.size},function(l$i){this._createFont().size=l$i}),l$h(0,l$_,"italic",function(){return this._font.italic},function(l$i){this._createFont().italic=l$i}),l$h(0,l$_,"fontFamily",function(){return this._font.family},function(l$i){this._createFont().family=l$i}),l$h(0,l$_,"stroke",function(){return this._font.stroke[0]},function(l$i){this._createFont().stroke===l$J._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=l$i}),l$h(0,l$_,"strokeColor",function(){return this._font.stroke[1]},function(l$i){this._createFont().stroke===l$J._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=l$i}),l$h(0,l$_,"border",function(){return this._border?this._border.value:""},function(l$i){if("none"!=l$i){this._border||(this._border={});var l$_=(this._border.value=l$i).split(" ");if(this._border.color=l$D.create(l$_[l$_.length-1]),1==l$_.length)return this._border.size=1,void(this._border.type="solid");var l$R=0;0<l$_[0].indexOf("px")?(this._border.size=parseInt(l$_[0]),l$R++):this._border.size=1,this._border.type=l$_[l$R],this._ower._renderType|=256}else this._border=null}),l$h(0,l$_,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(l$i){l$i?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==l$i?null:l$D.create(l$i),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),l$h(0,l$_,"position",function(){return 4&this._type?"absolute":""},function(l$i){"absolute"==l$i?this._type|=4:this._type&=-5}),l$h(0,l$_,"display",null,function(l$i){switch(l$i){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),l$h(0,l$_,"paddingLeft",function(){return this.padding[3]}),l$h(0,l$_,"paddingTop",function(){return this.padding[0]}),l$h(0,l$_,"_scale",null,function(l$i){this._ower.scale(l$i[0],l$i[1])}),l$h(0,l$_,"_rotate",null,function(l$i){this._ower.rotation=l$i}),l$f.parseOneCSS=function(l$i,l$_){for(var l$R,l$r=[],l$b=l$i.split(l$_),l$z=0,l$L=l$b.length;l$z<l$L;l$z++){var l$w=l$b[l$z],l$x=l$w.indexOf(":"),l$P=l$w.substr(0,l$x).replace(/^\s+|\s+$/g,"");if(0!=l$P.length){var l$B=l$w.substr(l$x+1).replace(/^\s+|\s+$/g,""),l$n=[l$P,l$B];switch(l$P){case"italic":case"bold":l$n[1]="true"==l$B;break;case"line-height":l$n[0]="lineHeight",l$n[1]=parseInt(l$B);break;case"font-size":l$n[0]="fontSize",l$n[1]=parseInt(l$B);break;case"padding":1<(l$R=l$B.split(" ")).length||(l$R[1]=l$R[2]=l$R[3]=l$R[0]),l$n[1]=[parseInt(l$R[0]),parseInt(l$R[1]),parseInt(l$R[2]),parseInt(l$R[3])];break;case"rotate":l$n[0]="_rotate",l$n[1]=parseFloat(l$B);break;case"scale":l$R=l$B.split(" "),l$n[0]="_scale",l$n[1]=[parseFloat(l$R[0]),parseFloat(l$R[1])];break;case"translate":l$R=l$B.split(" "),l$n[0]="_translate",l$n[1]=[parseInt(l$R[0]),parseInt(l$R[1])];break;default:(l$n[0]=l$f._CSSTOVALUE[l$P])||(l$n[0]=l$P)}l$r.push(l$n)}}return l$r},l$f.parseCSS=function(l$i,l$_){for(var l$R;null!=(l$R=l$f._parseCSSRegExp.exec(l$i));)l$f.styleSheets[l$R[1]]=l$f.parseOneCSS(l$R[2],";")},l$f.EMPTY=new l$f(null),l$f._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},l$f._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),l$f._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},l$f._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},l$f.styleSheets={},l$f.ALIGN_CENTER=1,l$f.ALIGN_RIGHT=2,l$f.VALIGN_MIDDLE=1,l$f.VALIGN_BOTTOM=2,l$f._CSS_BLOCK=1,l$f._DISPLAY_NONE=2,l$f._ABSOLUTE=4,l$f._WIDTH_SET=8,l$f._PADDING=[0,0,0,0],l$f._RECT=[-1,-1,-1,-1],l$f._SPACING=[0,0],l$f._ALIGNS=[0,0,0],l$f.ADDLAYOUTED=512,l$f._NEWFONT=4096,l$f._HEIGHT_SET=8192,l$f._BACKGROUND_SET=16384,l$f._FLOAT_RIGHT=32768,l$f._LINE_ELEMENT=65536,l$f._NOWARP=131072,l$f._WIDTHAUTO=262144,l$f._LISTERRESZIE=524288,l$f}(l$w),l$Ri=function(l$i){function l$L(){this.url=null,this.audio=null,this.loaded=!1,l$L.__super.call(this)}l$B(l$L,"laya.media.h5audio.AudioSound",l$P);var l$_=l$L.prototype;return l$_.dispose=function(){var l$i=l$L._audioCache[this.url];l$i&&(l$i.src="",delete l$L._audioCache[this.url])},l$_.load=function(l$i){var l$_;if(l$i=l$o.formatURL(l$i),(this.url=l$i)==l$v._tMusic?(l$L._initMusicAudio(),(l$_=l$L._musicAudio).src!=l$i&&(l$L._audioCache[l$_.src]=null,l$_=null)):l$_=l$L._audioCache[l$i],l$_&&2<=l$_.readyState)this.event("complete");else{l$_||(l$_=l$i==l$v._tMusic?(l$L._initMusicAudio(),l$L._musicAudio):l$s.createElement("audio"),(l$L._audioCache[l$i]=l$_).src=l$i),l$_.addEventListener("canplaythrough",l$r),l$_.addEventListener("error",l$b);var l$R=this;(this.audio=l$_).load?l$_.load():l$b()}function l$r(){l$z(),l$R.loaded=!0,l$R.event("complete")}function l$b(){l$_.load=null,l$z(),l$R.event("error")}function l$z(){l$_.removeEventListener("canplaythrough",l$r),l$_.removeEventListener("error",l$b)}},l$_.play=function(l$i,l$_,l$R){if(void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),!this.url)return null;var l$r,l$b;if(!(l$r=this.url==l$v._tMusic?l$L._musicAudio:l$L._audioCache[this.url]))return null;l$b=l$y.getItem("audio:"+this.url),l$p.isConchApp?l$b||((l$b=l$s.createElement("audio")).src=this.url):this.url==l$v._tMusic?(l$L._initMusicAudio(),(l$b=l$L._musicAudio).src=this.url):l$b=l$b||l$r.cloneNode(!0);var l$z=new l$fi(l$b);return l$z.url=this.url,l$z.loops=l$_,l$z.startTime=l$i,l$z.startHandler=l$R,l$z.play(!1),l$v.addChannel(l$z),l$z},l$h(0,l$_,"duration",function(){var l$i;return(l$i=l$L._audioCache[this.url])?l$i.duration:0}),l$L._initMusicAudio=function(){l$L._musicAudio||(l$L._musicAudio||(l$L._musicAudio=l$s.createElement("audio")),l$p.isConchApp||l$s.document.addEventListener("mousedown",l$L._makeMusicOK))},l$L._makeMusicOK=function(){l$s.document.removeEventListener("mousedown",l$L._makeMusicOK),l$L._musicAudio.src?l$L._musicAudio.play():(l$L._musicAudio.src="",l$L._musicAudio.load())},l$L._audioCache={},l$L._musicAudio=null,l$L}(),l$ri=function(l$i){function l$_(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,l$_.__super.call(this)}l$B(l$_,"laya.media.SoundChannel",l$P);var l$R=l$_.prototype;return l$R.play=function(){},l$R.stop=function(){},l$R.pause=function(){},l$R.resume=function(){},l$R.__runComplete=function(l$i){l$i&&l$i.run()},l$h(0,l$R,"volume",function(){return 1},function(l$i){}),l$h(0,l$R,"position",function(){return 0}),l$h(0,l$R,"duration",function(){return 0}),l$_}(),l$bi=function(l$i){function l$_(){l$_.__super.call(this)}l$B(l$_,"laya.media.Sound",l$P);var l$R=l$_.prototype;return l$R.load=function(l$i){},l$R.play=function(l$i,l$_,l$R){return void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),null},l$R.dispose=function(){},l$h(0,l$R,"duration",function(){return 0}),l$_}(),l$zi=function(l$i){function l$b(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,l$b.__super.call(this)}l$B(l$b,"laya.media.webaudio.WebAudioSound",l$P);var l$_=l$b.prototype;return l$_.load=function(l$i){this.url=l$i,this.audioBuffer=l$b._dataCache[l$i],this.audioBuffer?this._loaded(this.audioBuffer):(l$b.e.on("loaded:"+l$i,this,this._loaded),l$b.e.on("err:"+l$i,this,this._err),l$b.__loadingSound[l$i]||(l$b.__loadingSound[l$i]=!0,l$A.loader.load(l$i,l$t.create(this,this.onloaded),null,l$wi.BUFFER,4,!1,null,!0)))},l$_.onloaded=function(l$i){l$i||this._err(),this._disposed?this._removeLoadEvents():(this.data=l$i,l$b.buffs.push({buffer:this.data,url:this.url}),l$b.decode())},l$_._err=function(){if(this._removeLoadEvents(),l$b.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var l$i,l$_,l$R,l$r=0;for(l$i=(l$_=this.__toPlays).length,l$r=0;l$r<l$i;l$r++)(l$R=l$_[l$r])[3]&&!l$R[3].isStopped&&l$R[3].event("error");this.__toPlays.length=0}},l$_._loaded=function(l$i){this._removeLoadEvents(),this._disposed||(this.audioBuffer=l$i,this.loaded=!0,this.event("complete"))},l$_._removeLoadEvents=function(){l$b.e.off("loaded:"+this.url,this,this._loaded),l$b.e.off("err:"+this.url,this,this._err)},l$_.__playAfterLoaded=function(){if(this.__toPlays){var l$i,l$_,l$R,l$r=0;for(l$i=(l$_=this.__toPlays).length,l$r=0;l$r<l$i;l$r++)(l$R=l$_[l$r])[3]&&!l$R[3].isStopped&&this.play(l$R[0],l$R[1],l$R[2],l$R[3]);this.__toPlays.length=0}},l$_.play=function(l$i,l$_,l$R,l$r){return void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),l$r=l$r||new l$Ji,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([l$i,l$_,l$R,l$r]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),l$r.url=this.url,l$r.loops=l$_,l$r.audioBuffer=this.audioBuffer,l$r.startTime=l$i,l$r.startHandler=l$R,l$r.play(!1),l$v.addChannel(l$r),l$r},l$_.dispose=function(){this._disposed=!0,delete l$b._dataCache[this.url],delete l$b.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},l$h(0,l$_,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),l$b.decode=function(){if(!(l$b.buffs.length<=0||l$b.isDecoding))if(l$b.isDecoding=!0,(l$b.tInfo=l$b.buffs.shift())&&l$b.tInfo.buffer&&l$b.tInfo.buffer.byteLength)try{l$b.ctx.decodeAudioData(l$b.tInfo.buffer,l$b._done,l$b._fail)}catch(l$i){console.error("decodeAudioData error  byteLength:"+l$b.tInfo.buffer.byteLength+"  url:"+l$b.tInfo.url)}else l$b._fail()},l$b._done=function(l$i){l$b.e.event("loaded:"+l$b.tInfo.url,l$i),l$b._dataCache[l$b.tInfo.url]=l$i,l$b.isDecoding=!1,l$b.decode()},l$b._fail=function(){l$b.e.event("err:"+l$b.tInfo.url,null),l$b.isDecoding=!1,l$b.decode()},l$b._playEmptySound=function(){if(null!=l$b.ctx){if(l$b._emptySource&&(l$b._emptySource.stop(),l$b._emptySource.disconnect(0),!l$Ji._tryCleanFailed))try{l$b._emptySource.buffer=null}catch(l$i){l$Ji._tryCleanFailed=!0}var l$i=l$b.ctx.createBufferSource();l$i.buffer=l$b._miniBuffer,l$i.connect(l$b.ctx.destination),l$i.start(0,0,0),l$b._emptySource=l$i}},l$b._unlock=function(){l$b._unlocked||(l$b._playEmptySound(),"running"==l$b.ctx.state?(l$s.document.removeEventListener("mousedown",l$b._unlock,!0),l$s.document.removeEventListener("touchend",l$b._unlock,!0),l$s.document.removeEventListener("touchstart",l$b._unlock,!0),l$b._unlocked=!0):"suspended"==l$b.ctx.state&&l$v._recoverWebAudio())},l$b.initWebAudio=function(){"running"!=l$b.ctx.state&&(l$b._unlock(),l$s.document.addEventListener("mousedown",l$b._unlock,!0),l$s.document.addEventListener("touchend",l$b._unlock,!0),l$s.document.addEventListener("touchstart",l$b._unlock,!0))},l$b._emptySource=null,l$b._dataCache={},l$b.buffs=[],l$b.isDecoding=!1,l$b._unlocked=!1,l$b.tInfo=null,l$b.__loadingSound={},l$x(l$b,["window",function(){return this.window=l$s.window},"webAudioEnabled",function(){return this.webAudioEnabled=l$b.window.AudioContext||l$b.window.webkitAudioContext||l$b.window.mozAudioContext},"ctx",function(){return this.ctx=l$b.webAudioEnabled?new(l$b.window.AudioContext||l$b.window.webkitAudioContext||l$b.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=l$b.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new l$P}]),l$b}(),l$Li=function(l$i){function l$_(){this._responseType=null,this._data=null,l$_.__super.call(this),this._http=new l$s.window.XMLHttpRequest}l$B(l$_,"laya.net.HttpRequest",l$P);var l$R=l$_.prototype;return l$R.send=function(l$i,l$_,l$R,l$r,l$b){void 0===l$R&&(l$R="get"),void 0===l$r&&(l$r="text"),this._responseType=l$r,this._data=null;var l$z=this,l$L=this._http;if(l$L.open(l$R,l$i,!0),l$b)for(var l$w=0;l$w<l$b.length;l$w++)l$L.setRequestHeader(l$b[l$w++],l$b[l$w]);else l$p.isConchApp||(l$_&&"string"!=typeof l$_?l$L.setRequestHeader("Content-Type","application/json"):l$L.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));l$L.responseType="arraybuffer"!==l$r?"text":"arraybuffer",l$L.onerror=function(l$i){l$z._onError(l$i)},l$L.onabort=function(l$i){l$z._onAbort(l$i)},l$L.onprogress=function(l$i){l$z._onProgress(l$i)},l$L.onload=function(l$i){l$z._onLoad(l$i)},l$L.send(l$_)},l$R._onProgress=function(l$i){l$i&&l$i.lengthComputable&&this.event("progress",l$i.loaded/l$i.total)},l$R._onAbort=function(l$i){this.error("Request was aborted by user")},l$R._onError=function(l$i){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},l$R._onLoad=function(l$i){var l$_=this._http,l$R=void 0!==l$_.status?l$_.status:200;200===l$R||204===l$R||0===l$R?this.complete():this.error("["+l$_.status+"]"+l$_.statusText+":"+l$_.responseURL)},l$R.error=function(l$i){this.clear(),this.event("error",l$i)},l$R.complete=function(){this.clear();var l$_=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=l$Q.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(l$i){l$_=!1,this.error(l$i.message)}l$_&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},l$R.clear=function(){var l$i=this._http;l$i.onerror=l$i.onabort=l$i.onprogress=l$i.onload=null},l$h(0,l$R,"url",function(){return this._http.responseURL}),l$h(0,l$R,"http",function(){return this._http}),l$h(0,l$R,"data",function(){return this._data}),l$_}(),l$wi=function(l$i){function l$j(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,l$j.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}l$B(l$j,"laya.net.Loader",l$P);var l$_=l$j.prototype;return l$_.load=function(l$i,l$_,l$R,l$r,l$b){if(l$i&&""!=l$i||console.error("Loader 加载的url不合法 "+l$i),void 0===l$R&&(l$R=!0),void 0===l$b&&(l$b=!1),0===(this._url=l$i).indexOf("data:image")?this._type=l$_="image":this._type=l$_||(l$_=this.getTypeFromUrl(l$i)),this._cache=l$R,this._data=null,!l$b&&l$j.loadedMap[l$i])return this._data=l$j.loadedMap[l$i],this.event("progress",1),void this.event("complete",this._data);if(l$r&&l$j.setGroup(l$i,l$r),null!=l$j.parserMap[l$_])return this._customParse=!0,void(l$j.parserMap[l$_]instanceof laya.utils.Handler?l$j.parserMap[l$_].runWith(this):l$j.parserMap[l$_].call(null,this));if("image"===l$_||"htmlimage"===l$_||"nativeimage"===l$_)return this._loadImage(l$i);if("ttf"===l$_)return this._loadTTF(l$i);switch(l$_){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:l$_}l$j.preLoadedMap[l$i]?this.onLoaded(l$j.preLoadedMap[l$i]):l$L.resMgrLoad(l$i,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},l$_.getTypeFromUrl=function(l$i){var l$_=l$Q.getFileExtension(l$i);return l$_?l$j.typeMap[l$_]:(console.warn("Not recognize the resources suffix",l$i),"text")},l$_._loadTTF=function(l$i){l$i=l$o.formatURL(l$i);var l$_=new l$u;l$_.complete=l$t.create(this,this.onLoaded),l$_.load(l$i)},l$_._loadImage=function(l$i){l$L.imgMgrLoad(l$i,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},l$_._loadImageComplete=function(l$i,l$_,l$R){if(null!=l$R)if(l$R instanceof ArrayBuffer){var l$r=new DataView(l$R),l$b=new laya.webgl.resource.WebGLImage(new Uint8Array(l$R,8),l$i,0,!1,l$r.getUint32(0),l$r.getUint32(4));this.onLoaded(l$b)}else if(l$R instanceof l$Bi)l$j.imgMgrSet[l$i]=l$_,l$L.imgMgrLock(l$i,l$j.imgMgrSet[l$i]),this._url=l$i,this.complete(l$R);else{var l$z=-1!=l$i.indexOf(".png",l$i.length-4)?6408:6407;l$b=new laya.webgl.resource.WebGLImage(l$R,l$i,l$z,!1,l$R.width,l$R.height);this.onLoaded(l$b)}else this.event("error","Load image failed")},l$_.imageCancel=function(l$i,l$_,l$R){l$L.imgMgrCancel(l$i,this._onImageCallback)},l$_._loadSound=function(l$i){var l$_=new l$v._soundClass,l$R=this;function l$r(){l$_.offAll()}l$_.on("complete",this,function(){l$r(),l$R.onLoaded(l$_)}),l$_.on("error",this,function(){l$r(),l$_.dispose(),l$R.event("error","Load sound failed")}),l$_.load(l$i)},l$_.onProgress=function(l$i){"atlas"===this._type?this.event("progress",.3*l$i):this.event("progress",l$i)},l$_.onError=function(l$i){this.event("error",l$i)},l$_._loadedComplete=function(l$i,l$_,l$R){if(null!=l$R)switch(this._type){case"atlas":case"plf":case"json":var l$r=new l$Y(l$R);this.onLoaded(JSON.parse(l$r.readUTFBytes()));break;case"font":l$r=new l$Y(l$R);this.onLoaded(l$Q.parseXMLFromString(l$r.readUTFBytes()));break;default:this.onLoaded(l$R)}else this.event("error",l$i)},l$_.onLoaded=function(l$i){var l$_=this._type;if("plf"==l$_)this.parsePLFData(l$i),this.complete(l$i);else if("image"===l$_){var l$R=new l$Bi(l$i);l$R.url=this._url,this.complete(l$R)}else if("sound"===l$_||"htmlimage"===l$_||"nativeimage"===l$_)this.complete(l$i);else if("atlas"===l$_){if(!l$i.src&&!l$i._setContext){if(!this._data){if((this._data=l$i).meta&&l$i.meta.image)for(var l$r=l$i.meta.image.split(","),l$b=0<=this._url.indexOf("/")?"/":"\\",l$z=this._url.lastIndexOf(l$b),l$L=0<=l$z?this._url.substr(0,l$z+1):"",l$w=0,l$x=l$r.length;l$w<l$x;l$w++)l$r[l$w]=l$L+l$r[l$w];else l$r=[this._url.replace(".json",".png")];l$r.reverse(),l$i.toLoads=l$r,l$i.pics=[]}return this.event("progress",.3+1/l$r.length*.6),this._loadImage(l$r.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(l$i),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var l$P=this._data.frames,l$B=this._url.split("?")[0],l$n=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:l$B.substring(0,l$B.lastIndexOf("."))+"/",l$f=this._data.pics,l$J=l$o.formatURL(this._url),l$h=l$j.atlasMap[l$J]||(l$j.atlasMap[l$J]=[]);l$h.dir=l$n;var l$M=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var l$N in l$M=parseFloat(this._data.meta.scale),l$P){var l$X,l$t=l$P[l$N],l$I=l$f[l$t.frame.idx?l$t.frame.idx:0],l$e=l$o.formatURL(l$n+l$N);l$I.scaleRate=l$M,l$X=l$Bi.create(l$I,l$t.frame.x,l$t.frame.y,l$t.frame.w,l$t.frame.h,l$t.spriteSourceSize.x,l$t.spriteSourceSize.y,l$t.sourceSize.w,l$t.sourceSize.h),l$j.cacheRes(l$e,l$X),l$j.keepCache(this._url,l$n+l$N),l$X.url=l$e,l$h.push(l$e)}else for(l$N in l$P)l$I=l$f[(l$t=l$P[l$N]).frame.idx?l$t.frame.idx:0],l$e=l$o.formatURL(l$n+l$N),l$j.cacheRes(l$e,l$Bi.create(l$I,l$t.frame.x,l$t.frame.y,l$t.frame.w,l$t.frame.h,l$t.spriteSourceSize.x,l$t.spriteSourceSize.y,l$t.sourceSize.w,l$t.sourceSize.h)),l$j.loadedMap[l$e].url=l$e,l$j.keepCache(this._url,l$n+l$N),l$h.push(l$e);delete this._data.pics,this.complete(this._data)}else if("font"==l$_){if(!l$i.src)return this._data=l$i,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var l$c=new l$S;l$c.parseFont(this._data,l$i);var l$l=this._url.split(".fnt")[0].split("/"),l$A=l$l[l$l.length-1];l$Ni.registerBitmapFont(l$A,l$c),this._data=l$c,this.complete(this._data)}else if("pkm"==l$_){var l$Z=l$li.create(l$i,this._url),l$q=new l$Bi(l$Z);l$q.url=this._url,this.complete(l$q)}else this.complete(l$i)},l$_.parsePLFData=function(l$i){var l$_,l$R,l$r;for(l$_ in l$i)switch(l$r=l$i[l$_],l$_){case"json":case"text":for(l$R in l$r)l$j.preLoadedMap[l$o.formatURL(l$R)]=l$r[l$R];break;default:for(l$R in l$r)l$j.preLoadedMap[l$o.formatURL(l$R)]=l$r[l$R]}},l$_.complete=function(l$i){this._data=l$i,this._customParse?this.event("loaded",l$i instanceof Array?[l$i]:l$i):(l$j._loaders.push(this),l$j._isWorking||l$j.checkNext())},l$_.endLoad=function(l$i){l$i&&(this._data=l$i),this._cache&&l$j.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},l$h(0,l$_,"url",function(){return this._url}),l$h(0,l$_,"data",function(){return this._data}),l$h(0,l$_,"cache",function(){return this._cache}),l$h(0,l$_,"type",function(){return this._type}),l$j.checkNext=function(){l$j._isWorking=!0;for(var l$i=l$s.now();l$j._startIndex<l$j._loaders.length;)if(l$s.now(),l$j._loaders[l$j._startIndex].endLoad(),l$j._startIndex++,l$s.now()-l$i>l$j.maxTimeOut)return console.warn("loader callback cost a long time:"+(l$s.now()-l$i)+" url="+l$j._loaders[l$j._startIndex-1].url),void l$A.timer.frameOnce(1,null,l$j.checkNext);l$j._loaders.length=0,l$j._startIndex=0,l$j._isWorking=!1},l$j.clearRes=function(l$i,l$_){if(null!=l$i){void 0===l$_&&(l$_=!1),l$i=l$o.formatURL(l$i);var l$R=l$j.getAtlas(l$i);if(l$R){for(var l$r=0,l$b=l$R.length;l$r<l$b;l$r++){var l$z=l$R[l$r],l$L=l$j.getRes(l$z);delete l$j.loadedMap[l$z],l$j.clearCache(l$i.substring(l$o.basePath.length),l$z.substring(l$o.basePath.length)),l$L&&l$L.destroy(l$_)}l$R.length=0,delete l$j.atlasMap[l$i],delete l$j.loadedMap[l$i]}else{var l$w=l$j.loadedMap[l$i];l$w&&(delete l$j.loadedMap[l$i],l$w instanceof laya.resource.Texture&&l$w.bitmap&&l$w.destroy(l$_))}}},l$j.clearTextureRes=function(l$i){l$i=l$o.formatURL(l$i);var l$_=laya.net.Loader.getAtlas(l$i),l$R=l$_&&0<l$_.length?laya.net.Loader.getRes(l$_[0]):laya.net.Loader.getRes(l$i);l$R&&l$R.bitmap&&(l$p.isConchApp&&!l$p.isConchWebGL?l$R.bitmap.source.releaseTexture&&l$R.bitmap.source.releaseTexture():null==l$R.bitmap._atlaser&&l$R.bitmap.releaseResource(!0))},l$j.getRes=function(l$i){return l$j.loadedMap[l$o.formatURL(l$i)]},l$j.getAtlas=function(l$i){return l$j.atlasMap[l$o.formatURL(l$i)]},l$j.cacheRes=function(l$i,l$_){l$i=l$o.formatURL(l$i),null!=l$j.loadedMap[l$i]?console.warn("Resources already exist,is repeated loading:",l$i):l$j.loadedMap[l$i]=l$_},l$j.setGroup=function(l$i,l$_){l$j.groupMap[l$_]||(l$j.groupMap[l$_]=[]),l$j.groupMap[l$_].push(l$i)},l$j.clearResByGroup=function(l$i){if(l$j.groupMap[l$i]){var l$_=l$j.groupMap[l$i],l$R=0,l$r=l$_.length;for(l$R=0;l$R<l$r;l$R++)l$j.clearRes(l$_[l$R]);l$_.length=0}},l$j.keepCache=function(l$i,l$_){if(l$i&&l$_){var l$R=l$j.cacheSet[l$_];l$R?-1==l$R.indexOf(l$i)&&l$R.push(l$i):l$j.cacheSet[l$_]=[l$i]}},l$j.clearCache=function(l$i,l$_){if(l$i&&l$_){var l$R=l$j.cacheSet[l$_];if(l$R){var l$r=l$R.indexOf(l$i);if(-1!==l$r){var l$b=l$R.length-1;0==l$b?(delete l$j.cacheSet[l$_],0<l$j.imgMgrSet[l$_]?l$L.imgMgrFree(l$_,l$j.imgMgrSet[l$_]):l$j.clearRes(l$_,!0)):(l$R[l$r]=l$R[l$b],l$R.length=l$b)}}}},l$j.saveObject=function(l$i,l$_,l$R){if(l$_&&l$i){var l$r=l$j.objectSet[l$i];l$r?(console.warn("Loader.saveObject: "+l$i),l$r[0]=l$_,l$r[1]=l$R):l$j.objectSet[l$i]=[l$_,l$R,[]]}},l$j.findObject=function(l$i){if(l$i){var l$_=l$j.objectSet[l$i];if(l$_)return l$_[0]}return null},l$j.keepObject=function(l$i,l$_){if(l$i&&l$_){var l$R=l$j.objectSet[l$_];l$R&&-1===l$R[2].indexOf(l$i)&&l$R[2].push(l$i)}},l$j.clearObject=function(l$i,l$_){if(l$i&&l$_){var l$R=l$j.objectSet[l$_];if(l$R){var l$r=l$R[2],l$b=l$r.indexOf(l$i);if(-1!==l$b){var l$z=l$r.length-1;0==l$z?(delete l$j.objectSet[l$_],l$R[1]&&l$R[1].call(null,l$R[0])):(l$r[l$b]=l$r[l$z],l$r.length=l$z)}}}},l$j.TEXT="text",l$j.JSON="json",l$j.XML="xml",l$j.BUFFER="arraybuffer",l$j.IMAGE="image",l$j.SOUND="sound",l$j.ATLAS="atlas",l$j.FONT="font",l$j.TTF="ttf",l$j.PLF="plf",l$j.PKM="pkm",l$j.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},l$j.parserMap={},l$j.groupMap={},l$j.maxTimeOut=100,l$j.loadedMap={},l$j.preLoadedMap={},l$j.atlasMap={},l$j._loaders=[],l$j._isWorking=!1,l$j._startIndex=0,l$j.imgCache={},l$j.cacheSet={},l$j.objectSet={},l$j.imgMgrSet={},l$j}(),l$xi=function(l$i){var l$f;function l$J(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},l$J.__super.call(this);for(var l$i=0;l$i<this._maxPriority;l$i++)this._resInfos[l$i]=[]}l$B(l$J,"laya.net.LoaderManager",l$P);var l$_=l$J.prototype;return l$_.create=function(l$i,l$R,l$_,l$r,l$b,l$z,l$L,l$w){if(null==l$z&&(l$z=2),null==l$L&&(l$L=!0),l$i instanceof Array){var l$x=l$i,l$P=l$x.length,l$B=0;if(l$_)var l$n=l$t.create(l$_.caller,l$_.method,l$_.args,!1);for(var l$f=0;l$f<l$P;l$f++){var l$J=l$x[l$f];"string"==typeof l$J&&(l$J=l$x[l$f]={url:l$J}),l$J.progress=0}for(l$f=0;l$f<l$P;l$f++){l$J=l$x[l$f];var l$h=l$_?l$t.create(null,l$X,[l$J],!1):null,l$M=l$_||l$R?l$t.create(null,l$N,[l$J]):null;this._create(l$J.url,l$M,l$h,l$J.clas||l$r,l$J.params||l$b,null!=l$J.priority&&0<=l$J.priority?l$J.priority:l$z,l$L,l$J.group||l$w)}function l$N(l$i,l$_){l$B++,l$i.progress=1,l$B===l$P&&l$R&&l$R.run()}function l$X(l$i,l$_){l$i.progress=l$_;for(var l$R=0,l$r=0;l$r<l$P;l$r++){l$R+=l$x[l$r].progress}var l$b=l$R/l$P;l$n.runWith(l$b)}return!0}return this._create(l$i,l$R,l$_,l$r,l$b,l$z,l$L,l$w)},l$_._create=function(l$_,l$R,l$i,l$r,l$b,l$z,l$L,l$w){l$_&&""!=l$_||console.error("加载的url不合法 "+l$_),null==l$z&&(l$z=2),null==l$L&&(l$L=!0);var l$x=l$o.formatURL(l$_),l$P=this.getRes(l$x);if(l$P)!l$P.hasOwnProperty("loaded")||l$P.loaded?(l$i&&l$i.runWith(1),l$R&&l$R.run()):l$R&&l$A.loader._createListener(l$_,l$R.caller,l$R.method,l$R.args,!0,!1);else{var l$B=l$Q.getFileExtension(l$_),l$n=l$J.createMap[l$B];if(!l$n)throw new Error("LoaderManager:unknown file("+l$_+") extension with: "+l$B+".");l$r||(l$r=l$n[0]);var l$f=l$n[1];if("atlas"==l$B)this.load(l$_,l$R,l$i,l$f,l$z,l$L);else{l$r===l$Bi&&(l$f="htmlimage"),(l$P=l$r?new l$r:null).hasOwnProperty("_loaded")&&(l$P._loaded=!1),l$P._setUrl(l$_),l$w&&l$P._setGroup(l$w),this._createLoad(l$P,l$_,l$t.create(null,function(l$i){l$P&&!l$P.destroyed&&l$i&&l$P.onAsynLoaded.call(l$P,l$_,l$i,l$b),l$R&&l$R.run();l$A.loader.event(l$_)}),l$i,l$f,l$z,!1,l$w,!0),l$L&&this.cacheRes(l$x,l$P)}}return l$P},l$_.load=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){l$i&&""!=l$i||console.error("加载的url不合法 "+l$i);var l$x=this;if(null==l$b&&(l$b=2),null==l$z&&(l$z=!0),void 0===l$w&&(l$w=!1),l$i instanceof Array)return this._loadAssets(l$i,l$_,l$R,l$r,l$b,l$z,l$L);var l$P=l$wi.getRes(l$i);if(null!=l$P)l$A.timer.frameOnce(1,null,function(){l$R&&l$R.runWith(1),l$_&&l$_.runWith(l$P),l$x._loaderCount||l$x.event("complete")});else{var l$B=l$J._resMap[l$i];l$B?(l$_&&l$B._createListener("complete",l$_.caller,l$_.method,l$_.args,!1,!1),l$R&&l$B._createListener("progress",l$R.caller,l$R.method,l$R.args,!1,!1)):((l$B=this._infoPool.length?this._infoPool.pop():new l$f).url=l$i,l$B.clas=null,l$B.type=l$r,l$B.cache=l$z,l$B.group=l$L,l$B.ignoreCache=l$w,l$B.priority=l$b,l$_&&l$B.on("complete",l$_.caller,l$_.method,l$_.args),l$R&&l$B.on("progress",l$R.caller,l$R.method,l$R.args),l$J._resMap[l$i]=l$B,l$b=l$b<this._maxPriority?0<=l$b?l$b:0:this._maxPriority-1,this._resInfos[l$b].push(l$B),this._next())}return this},l$_.cancel=function(l$i,l$_,l$R){if(l$P=l$J._resMap[l$i]){l$_&&l$P.off("complete",l$_.caller,l$_.method,!1),l$R&&l$P.off("progress",l$R.caller,l$R.method,!1);var l$r=l$P.getListener("complete"),l$b=l$P.getListener("progress");if(!(l$r&&l$r.head||l$b&&l$b.head)){if(l$P.loader){var l$z=l$P.loader;l$z.imageCancel(l$i),l$z.offAll(),l$z._data=null,l$z._customParse=!1,l$z._url=null,l$z._class=null,l$z._type=null,this._loaders.push(l$z),this._loaderCount--,delete this._loaderMap[l$P.url]}for(var l$L=0;l$L<this._maxPriority;l$L++)for(var l$w=this._resInfos[l$L],l$x=l$w.length-1;-1<l$x;l$x--){var l$P;(l$P=l$w[l$x])&&l$P.url===l$i&&(l$w[l$x]=null,l$P.destroy(),l$P.offAll(),this._infoPool.push(l$P))}delete l$J._resMap[l$i],this._next()}}},l$_._createLoad=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){var l$P=this;if(null==l$z&&(l$z=2),null==l$L&&(l$L=!0),void 0===l$x&&(l$x=!1),l$_ instanceof Array)return this._loadAssets(l$_,l$R,l$r,l$b,l$z,l$L,l$w);var l$B=l$wi.getRes(l$_);if(null!=l$B)l$A.timer.frameOnce(1,null,function(){l$r&&l$r.runWith(1),l$R&&l$R.runWith(l$B),l$P._loaderCount||l$P.event("complete")});else{var l$n=l$J._resMap[l$_];l$n?(l$R&&l$n._createListener("complete",l$R.caller,l$R.method,l$R.args,!1,!1),l$r&&l$n._createListener("progress",l$r.caller,l$r.method,l$r.args,!1,!1)):((l$n=this._infoPool.length?this._infoPool.pop():new l$f).url=l$_,l$n.clas=l$i,l$n.type=l$b,l$n.cache=l$L,l$n.group=l$w,l$n.ignoreCache=l$x,l$n.priority=l$z,l$R&&l$n.on("complete",l$R.caller,l$R.method,l$R.args),l$r&&l$n.on("progress",l$r.caller,l$r.method,l$r.args),l$J._resMap[l$_]=l$n,l$z=l$z<this._maxPriority?0<=l$z?l$z:0:this._maxPriority-1,this._resInfos[l$z].push(l$n),this._next())}return this},l$_._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var l$i=0;l$i<this._maxPriority;l$i++)for(var l$_=this._resInfos[l$i];0<l$_.length;){var l$R=l$_.shift();if(l$R)return this._doLoad(l$R)}this._loaderCount||this.event("complete")}},l$_._doLoad=function(l$_){var l$R=this._loaders.length?this._loaders.pop():new l$wi;this._loaderCount++,(this._loaderMap[l$_.url]=l$R).on("complete",null,l$b),l$R.on("progress",null,function(l$i){l$_.event("progress",l$i)}),l$R.on("error",null,function(l$i){l$b(null)}),l$_.loader=l$R;var l$r=this;function l$b(l$i){l$R.offAll(),l$R._data=null,l$R._customParse=!1,l$R._url=null,l$R._class=null,l$R._type=null,l$r._loaders.push(l$R),l$r._loaderCount--,delete l$r._loaderMap[l$_.url],l$r._endLoad(l$_,l$i instanceof Array?[l$i]:l$i),l$r._next()}l$R._class=l$_.clas,1<=l$_.priority?(l$R.priority=l$_.priority,l$R.realTime=!1):(l$R.priority=0,l$R.realTime=!0),l$R.load(l$_.url,l$_.type,l$_.cache,l$_.group,l$_.ignoreCache)},l$_._endLoad=function(l$i,l$_){var l$R=l$i.url;if(null==l$_){var l$r=this._failRes[l$R]||0;if(l$r<this.retryNum)return console.warn("[warn]Retry to load:",l$R),this._failRes[l$R]=l$r+1,void l$A.timer.once(this.retryDelay,this,this._addReTry,[l$i],!1);console.warn("[error]Failed to load:",l$R),this.event("error",l$R)}this._failRes[l$R]&&(this._failRes[l$R]=0),delete l$J._resMap[l$R],l$i.event("complete",l$_),l$i.destroy(),l$i.offAll(),this._infoPool.push(l$i)},l$_._addReTry=function(l$i){this._resInfos[this._maxPriority-1].push(l$i),this._next()},l$_.clearRes=function(l$i,l$_){void 0===l$_&&(l$_=!1),l$wi.clearRes(l$i,l$_)},l$_.getRes=function(l$i){return l$wi.getRes(l$i)},l$_.cacheRes=function(l$i,l$_){l$wi.cacheRes(l$i,l$_)},l$_.clearTextureRes=function(l$i){l$wi.clearTextureRes(l$i)},l$_.setGroup=function(l$i,l$_){l$wi.setGroup(l$i,l$_)},l$_.clearResByGroup=function(l$i){l$wi.clearResByGroup(l$i)},l$_.clearUnLoaded=function(){for(var l$i=0;l$i<this._maxPriority;l$i++){for(var l$_=this._resInfos[l$i],l$R=l$_.length-1;-1<l$R;l$R--){var l$r=l$_[l$R];l$r&&(l$r.destroy(),l$r.offAll(),this._infoPool.push(l$r))}l$_.length=0}this._loaderCount=0,l$J._resMap={}},l$_.cancelLoadByUrls=function(l$i){if(l$i)for(var l$_=0,l$R=l$i.length;l$_<l$R;l$_++)this.cancelLoadByUrl(l$i[l$_])},l$_.cancelLoadByUrl=function(l$i){for(var l$_=0;l$_<this._maxPriority;l$_++)for(var l$R=this._resInfos[l$_],l$r=l$R.length-1;-1<l$r;l$r--){var l$b=l$R[l$r];l$b&&l$b.url===l$i&&(l$R[l$r]=null,l$b.destroy(),l$b.offAll(),this._infoPool.push(l$b))}l$J._resMap[l$i]&&delete l$J._resMap[l$i]},l$_._loadAssets=function(l$i,l$R,l$L,l$_,l$r,l$b,l$z){null==l$r&&(l$r=2),null==l$b&&(l$b=!0);for(var l$w=l$i.length,l$x=0,l$P=0,l$B=[],l$n=!0,l$f=0;l$f<l$w;l$f++){var l$J=l$i[l$f];if(!l$J)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+l$i);"string"==typeof l$J&&(l$J={url:l$J,type:l$_,size:1,priority:l$r}),l$J.size||(l$J.size=1),l$J.progress=0,l$P+=l$J.size,l$B.push(l$J);var l$h=l$L?l$t.create(null,l$X,[l$J],!1):null,l$M=l$R||l$L?l$t.create(null,l$N,[l$J]):null;this.load(l$J.url,l$M,l$h,l$J.type,null!=l$J.priority&&0<=l$J.priority?l$J.priority:2,l$b,l$J.group||l$z)}function l$N(l$i,l$_){l$x++,l$i.progress=1,l$_||(l$n=!1),l$x===l$w&&l$R&&l$R.runWith(l$n)}function l$X(l$i,l$_){if(null!=l$L){l$i.progress=l$_;for(var l$R=0,l$r=0;l$r<l$B.length;l$r++){var l$b=l$B[l$r];l$R+=l$b.size*l$b.progress}var l$z=l$R/l$P;l$L.runWith(l$z)}}return this},l$J.cacheRes=function(l$i,l$_){l$wi.cacheRes(l$i,l$_)},l$J._resMap={},l$x(l$J,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),l$J.__init$=function(){l$f=function(l$i){function l$_(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,l$_.__super.call(this)}return l$B(l$_,"",l$P),l$_.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},l$_}()},l$J}(),l$Pi=(function(l$i){function l$b(l$i){l$b.__super.call(this),l$i||(l$i=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var l$_=0,l$R=0,l$r=0;l$r<20;l$r++)l$r%5!=4?this._mat[l$_++]=l$i[l$r]:this._alpha[l$R++]=l$i[l$r];this._action=l$$.createFilterAction(32),this._action.data=this}l$B(l$b,"laya.filters.ColorFilter",l$X);var l$_=l$b.prototype;l$A.imps(l$_,{"laya.filters.IFilter":!0}),l$_.callNative=function(l$i){l$i._$P.cf=this;l$i.conchModel&&l$i.conchModel.setFilterMatrix&&l$i.conchModel.setFilterMatrix(this._mat,this._alpha)},l$h(0,l$_,"type",function(){return 32}),l$h(0,l$_,"action",function(){return this._action})}(),function(l$i){function l$r(l$i,l$_,l$R){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===l$_&&(l$_=0),l$r.__super.call(this),this._byteClass=l$R||l$Y,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,l$i&&0<l$_&&l$_<65535&&this.connect(l$i,l$_)}l$B(l$r,"laya.net.Socket",l$P);var l$_=l$r.prototype;l$_.connect=function(l$i,l$_){var l$R="ws://"+l$i+":"+l$_;l$R="https:"==l$s.window.location.protocol?"wss://"+l$i+":"+l$_:"ws://"+l$i+":"+l$_,this.connectByUrl(l$R)},l$_.connectByUrl=function(l$i){var l$_=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new l$s.window.WebSocket(l$i,this.protocols):this._socket=new l$s.window.WebSocket(l$i),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(l$i){l$_._onOpen(l$i)},this._socket.onmessage=function(l$i){l$_._onMessage(l$i)},this._socket.onclose=function(l$i){l$_._onClose(l$i)},this._socket.onerror=function(l$i){l$_._onError(l$i)}},l$_.cleanSocket=function(){try{this._socket.close()}catch(l$i){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},l$_.close=function(){if(null!=this._socket)try{this._socket.close()}catch(l$i){}},l$_._onOpen=function(l$i){this._connected=!0,this.event("open",l$i)},l$_._onMessage=function(l$i){if(l$i&&l$i.data){var l$_=l$i.data;if(this.disableInput&&l$_)this.event("message",l$_);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var l$R=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,l$_&&("string"==typeof l$_?this._input.writeUTFBytes(l$_):this._input.writeArrayBuffer(l$_),this._addInputPosition=this._input.pos,this._input.pos=l$R),this.event("message",l$_)}}},l$_._onClose=function(l$i){this._connected=!1,this.event("close",l$i)},l$_._onError=function(l$i){this.event("error",l$i)},l$_.send=function(l$i){this._socket.send(l$i)},l$_.flush=function(){if(this._output&&0<this._output.length){var l$_;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(l$i){l$_=l$i}this._output.endian=this.endian,this._output.clear(),l$_&&this.event("error",l$_)}},l$h(0,l$_,"input",function(){return this._input}),l$h(0,l$_,"output",function(){return this._output}),l$h(0,l$_,"connected",function(){return this._connected}),l$h(0,l$_,"endian",function(){return this._endian},function(l$i){this._endian=l$i,null!=this._input&&(this._input.endian=l$i),null!=this._output&&(this._output.endian=l$i)}),l$r.LITTLE_ENDIAN="littleEndian",l$r.BIG_ENDIAN="bigEndian"}(),function(l$i){function l$w(){l$w.__super.call(this),this._$1__id=++l$w._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(l$w._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,l$E.currentResourceManager&&l$E.currentResourceManager.addResource(this)}l$B(l$w,"laya.resource.Resource",l$P);var l$_=l$w.prototype;return l$A.imps(l$_,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),l$_._setUrl=function(l$i){var l$_;this._url!==l$i&&(this._url&&((l$_=l$w._urlResourcesMap[this._url]).splice(l$_.indexOf(this),1),0===l$_.length&&delete l$w._urlResourcesMap[this._url]),l$i&&((l$_=l$w._urlResourcesMap[l$i])||(l$w._urlResourcesMap[l$i]=l$_=[]),l$_.push(this)),this._url=l$i)},l$_._getGroup=function(){return this._group},l$_._setGroup=function(l$i){var l$_;this._group!==l$i&&(this._group&&((l$_=l$w._groupResourcesMap[this._group]).splice(l$_.indexOf(this),1),0===l$_.length&&delete l$w._groupResourcesMap[this._group]),l$i&&((l$_=l$w._groupResourcesMap[l$i])||(l$w._groupResourcesMap[l$i]=l$_=[]),l$_.push(this)),this._group=l$i)},l$_._addReference=function(){this._referenceCount++},l$_._removeReference=function(){this._referenceCount--},l$_._clearReference=function(){this._referenceCount=0},l$_._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},l$_.recreateResource=function(){this.completeCreate()},l$_.disposeResource=function(){},l$_.activeResource=function(l$i){void 0===l$i&&(l$i=!1),this._lastUseFrameCount=l$a.loopCount,!this._destroyed&&this.__loaded&&(this._released||l$i)&&this.recreateResource()},l$_.releaseResource=function(l$i){return void 0===l$i&&(l$i=!0),!(!l$i&&this.lock)&&(!(this._released&&!l$i)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},l$_.onAsynLoaded=function(l$i,l$_,l$R){throw new Error("Resource: must override this function!")},l$_.destroy=function(){var l$i;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete l$w._idResourcesMap[this.id],this._url&&((l$i=l$w._urlResourcesMap[this._url])&&(l$i.splice(l$i.indexOf(this),1),0===l$i.length&&delete l$w._urlResourcesMap[this.url]),l$wi.clearRes(this._url),this.__loaded||l$$.cancelLoadByUrl(this._url)),this._group&&((l$i=l$w._groupResourcesMap[this._group]).splice(l$i.indexOf(this),1),0===l$i.length&&delete l$w._groupResourcesMap[this.url]))},l$_.completeCreate=function(){this._released=!1,this.event("recovered",this)},l$_.dispose=function(){this.destroy()},l$h(0,l$_,"memorySize",function(){return this._memorySize},function(l$i){var l$_=l$i-this._memorySize;this._memorySize=l$i,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,l$_),this.resourceManager&&this.resourceManager.addSize(l$_)}),l$h(0,l$_,"_loaded",null,function(l$i){this.__loaded=l$i}),l$h(0,l$_,"loaded",function(){return this.__loaded}),l$h(0,l$_,"id",function(){return this._$1__id}),l$h(0,l$_,"destroyed",function(){return this._destroyed}),l$h(0,l$_,"group",function(){return this._getGroup()},function(l$i){this._setGroup(l$i)}),l$h(0,l$_,"resourceManager",function(){return this._resourceManager}),l$h(0,l$_,"url",function(){return this._url}),l$h(0,l$_,"released",function(){return this._released}),l$h(0,l$_,"referenceCount",function(){return this._referenceCount}),l$w.getResourceByID=function(l$i){return l$w._idResourcesMap[l$i]},l$w.getResourceByURL=function(l$i,l$_){return void 0===l$_&&(l$_=0),null==l$w._urlResourcesMap[l$i]?null:l$w._urlResourcesMap[l$i][l$_]},l$w.getResourceCountByURL=function(l$i){return l$w._urlResourcesMap[l$i].length},l$w.destroyUnusedResources=function(l$i){var l$_;if(l$i){var l$R=l$w._groupResourcesMap[l$i];if(l$R)for(var l$r=l$R.slice(),l$b=0,l$z=l$r.length;l$b<l$z;l$b++)(l$_=l$r[l$b]).lock||0!==l$_._referenceCount||l$_.destroy()}else for(var l$L in l$w._idResourcesMap)(l$_=l$w._idResourcesMap[l$L]).lock||0!==l$_._referenceCount||l$_.destroy()},l$w._uniqueIDCounter=0,l$w._idResourcesMap={},l$w._urlResourcesMap={},l$w._groupResourcesMap={},l$w}()),l$Bi=function(l$i){function l$j(l$i,l$_){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,l$j.__super.call(this),l$i&&null!=l$i._addReference&&l$i._addReference(),this.setTo(l$i,l$_)}l$B(l$j,"laya.resource.Texture",l$P);var l$_=l$j.prototype;return l$_._setUrl=function(l$i){this.url=l$i},l$_.setTo=function(l$i,l$_){if(l$i instanceof l$L.HTMLElement){var l$R=l$Ii.create("2D",l$i);this.bitmap=l$R}else this.bitmap=l$i;if(this.uv=l$_||l$j.DEF_UV,l$i){this._w=l$i.width,this._h=l$i.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var l$r=this;if(this._loaded)l$$.addToAtlas&&l$$.addToAtlas(l$r);else{var l$b=l$i;l$b instanceof laya.resource.HTMLImage&&l$b.image&&l$b.image.addEventListener("load",function(l$i){l$$.addToAtlas&&l$$.addToAtlas(l$r)},!1)}}},l$_.active=function(){this.bitmap&&this.bitmap.activeResource()},l$_.destroy=function(l$i){if(void 0===l$i&&(l$i=!1),this.alphaTexture&&(this.alphaTexture.destroy(l$i),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var l$_=this.bitmap;l$i?(l$p.isConchApp&&l$_.source&&l$_.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,l$_.dispose(),l$_._clearReference()):(l$_._removeReference(),0==l$_.referenceCount&&(l$p.isConchApp&&l$_.source&&l$_.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,l$_.dispose())),this.url&&this===l$A.loader.getRes(this.url)&&l$A.loader.clearRes(this.url,l$i),this._loaded=!1}},l$_.load=function(l$i){var l$_=this;this._loaded=!1,l$i=l$o.customFormat(l$i);var l$R=this.bitmap||(this.bitmap=l$li.create(l$i));l$R.uri=l$i,l$R&&l$R._addReference();var l$r=this;l$R.onload=function(){l$R.onload=null,l$r._loaded=!0,l$_.sourceWidth=l$_._w=l$R.width,l$_.sourceHeight=l$_._h=l$R.height,l$r.event("loaded",this),l$$.addToAtlas&&l$$.addToAtlas(l$r)}},l$_.addTextureToAtlas=function(l$i){l$$.addTextureToAtlas(this)},l$_.getPixels=function(l$i,l$_,l$R,l$r){if(l$p.isConchApp){var l$b=this.bitmap;if(l$b.source&&l$b.source.getImageData){var l$z=l$b.source.getImageData(l$i,l$_,l$R,l$r),l$L=new Uint8Array(l$z);return Array.from(l$L)}return null}return l$p.isWebGL?l$$.getTexturePixels(this,l$i,l$_,l$R,l$r):(l$s.canvas.size(l$R,l$r),l$s.canvas.clear(),l$s.context.drawTexture(this,-l$i,-l$_,this.width,this.height,0,0),l$s.context.getImageData(0,0,l$R,l$r).data)},l$_.onAsynLoaded=function(l$i,l$_){if(l$_){if("function"!=typeof l$_._addReference)throw new Error("bitmap._addReference is not a function. "+l$_.className+" "+typeof l$_._addReference+" "+l$_.constructor);l$_._addReference()}this.setTo(l$_,this.uv),this._loaded&&this.event("loaded",this)},l$h(0,l$_,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),l$h(0,l$_,"loaded",function(){return this._loaded}),l$h(0,l$_,"released",function(){return!this.bitmap||this.bitmap.released}),l$h(0,l$_,"width",function(){return this._w?this._w:this.uv&&this.uv!==l$j.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(l$i){this._w=l$i,this.sourceWidth||(this.sourceWidth=l$i)}),l$h(0,l$_,"repeat",function(){return!l$p.isWebGL||!this.bitmap||this.bitmap.repeat},function(l$i){l$i&&l$p.isWebGL&&this.bitmap&&(this.bitmap.repeat=l$i)&&(this.bitmap.enableMerageInAtlas=!1)}),l$h(0,l$_,"height",function(){return this._h?this._h:this.uv&&this.uv!==l$j.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(l$i){this._h=l$i,this.sourceHeight||(this.sourceHeight=l$i)}),l$h(0,l$_,"isLinearSampling",function(){return!l$p.isWebGL||9728!=this.bitmap.minFifter},function(l$i){!l$i&&l$p.isWebGL&&(l$i||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),l$j.moveUV=function(l$i,l$_,l$R){for(var l$r=0;l$r<8;l$r+=2)l$R[l$r]+=l$i,l$R[l$r+1]+=l$_;return l$R},l$j.create=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){void 0===l$z&&(l$z=0),void 0===l$L&&(l$L=0),void 0===l$w&&(l$w=0),void 0===l$x&&(l$x=0);var l$P=l$i instanceof laya.resource.Texture,l$B=l$P?l$i.uv:l$j.DEF_UV,l$n=l$P?l$i.bitmap:l$i,l$f=l$$.isAtlas(l$n);if(l$f){var l$J=l$n._atlaser,l$h=l$i._atlasID;if(-1==l$h)throw new Error("create texture error");l$n=l$J._inAtlasTextureBitmapValue[l$h],l$B=l$J._inAtlasTextureOriUVValue[l$h]}var l$M=new l$j(l$n,null);l$n.width&&l$_+l$r>l$n.width&&(l$r=l$n.width-l$_),l$n.height&&l$R+l$b>l$n.height&&(l$b=l$n.height-l$R),l$M.width=l$r,l$M.height=l$b,l$M.offsetX=l$z,l$M.offsetY=l$L,l$M.sourceWidth=l$w||l$r,l$M.sourceHeight=l$x||l$b;var l$N=1/l$n.width,l$X=1/l$n.height;l$_*=l$N,l$R*=l$X,l$r*=l$N,l$b*=l$X;var l$t=l$M.uv[0],l$I=l$M.uv[1],l$e=l$M.uv[4],l$c=l$M.uv[5],l$l=l$e-l$t,l$A=l$c-l$I,l$Z=l$j.moveUV(l$B[0],l$B[1],[l$_,l$R,l$_+l$r,l$R,l$_+l$r,l$R+l$b,l$_,l$R+l$b]);l$M.uv=[l$t+l$Z[0]*l$l,l$I+l$Z[1]*l$A,l$e-(1-l$Z[2])*l$l,l$I+l$Z[3]*l$A,l$e-(1-l$Z[4])*l$l,l$c-(1-l$Z[5])*l$A,l$t+l$Z[6]*l$l,l$c-(1-l$Z[7])*l$A],l$f&&l$M.addTextureToAtlas();var l$q=l$n.scaleRate;return l$q&&1!=l$q?(l$M.sourceWidth/=l$q,l$M.sourceHeight/=l$q,l$M.width/=l$q,l$M.height/=l$q,l$M.scaleRate=l$q,l$M.offsetX/=l$q,l$M.offsetY/=l$q):l$M.scaleRate=1,l$M},l$j.createFromTexture=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$i.scaleRate;1!=l$z&&(l$_*=l$z,l$R*=l$z,l$r*=l$z,l$b*=l$z);var l$L=l$q.TEMP.setTo(l$_-l$i.offsetX,l$R-l$i.offsetY,l$r,l$b),l$w=l$L.intersection(l$j._rect1.setTo(0,0,l$i.width,l$i.height),l$j._rect2);if(!l$w)return null;var l$x=l$j.create(l$i,l$w.x,l$w.y,l$w.width,l$w.height,l$w.x-l$L.x,l$w.y-l$L.y,l$r,l$b);if(l$x.bitmap&&l$x.bitmap._removeReference)return l$x.bitmap._removeReference(),l$x;var l$P="bitmap:"+(l$x.bitmap?l$x.bitmap.constructor?l$x.bitmap.constructor.name:l$x.bitmap.__className:"")+", url:"+(l$i.url+" | "+(l$x.bitmap?l$x.bitmap.url:l$i.url))+", x="+l$_+",y="+l$R+",width="+l$r+",height="+l$b+", result="+(l$w?l$w.x+","+l$w.y+","+l$w.width+","+l$w.height:"null")+", rect="+l$L.x+","+l$L.y+","+l$L.width+","+l$L.height;throw new Error("报错：bitmap._removeReference is not a function  "+l$P)},l$j.DEF_UV=[0,0,1,0,1,1,0,1],l$j.INV_UV=[0,1,1,1,1,0,0,0],l$j._rect1=new l$q,l$j._rect2=new l$q,l$j}(),l$i=function(l$i){var l$w;function l$z(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,l$z.__super.call(this)}l$B(l$z,"laya.utils.TimeLine",l$P);var l$_=l$z.prototype;return l$_.to=function(l$i,l$_,l$R,l$r,l$b){return void 0===l$b&&(l$b=0),this._create(l$i,l$_,l$R,l$r,l$b,!0)},l$_.from=function(l$i,l$_,l$R,l$r,l$b){return void 0===l$b&&(l$b=0),this._create(l$i,l$_,l$R,l$r,l$b,!1)},l$_._create=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=l$y.getItemByClass("tweenData",l$w);return l$L.isTo=l$z,l$L.type=0,l$L.target=l$i,l$L.duration=l$R,l$L.data=l$_,l$L.startTime=this._startTime+l$b,l$L.endTime=l$L.startTime+l$L.duration,l$L.ease=l$r,this._startTime=Math.max(l$L.endTime,this._startTime),this._tweenDataList.push(l$L),this._startTimeSort=!0,this._endTimeSort=!0,this},l$_.addLabel=function(l$i,l$_){var l$R=l$y.getItemByClass("tweenData",l$w);return l$R.type=1,l$R.data=l$i,l$R.endTime=l$R.startTime=this._startTime+l$_,this._labelDic||(this._labelDic={}),this._labelDic[l$i]=l$R,this._tweenDataList.push(l$R),this},l$_.removeLabel=function(l$i){if(this._labelDic&&this._labelDic[l$i]){var l$_=this._labelDic[l$i];if(l$_){var l$R=this._tweenDataList.indexOf(l$_);-1<l$R&&this._tweenDataList.splice(l$R,1)}delete this._labelDic[l$i]}},l$_.gotoTime=function(l$i){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var l$_,l$R,l$r,l$b;for(var l$z in this._firstTweenDic)if(l$R=this._firstTweenDic[l$z])for(var l$L in l$R)l$R.diyTarget.hasOwnProperty(l$L)&&(l$R.diyTarget[l$L]=l$R[l$L]);for(l$z in this._tweenDic)(l$_=this._tweenDic[l$z]).clear(),delete this._tweenDic[l$z];if(this._index=0,this._gidIndex=0,this._currTime=l$i,this._lastTime=l$s.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=l$r=this._tweenDataList.concat(),l$r.sort(function(l$i,l$_){return l$i.endTime>l$_.endTime?1:l$i.endTime<l$_.endTime?-1:0})}else l$r=this._endTweenDataList;for(var l$w=0,l$x=l$r.length;l$w<l$x;l$w++)if(0==(l$b=l$r[l$w]).type){if(!(l$i>=l$b.endTime))break;this._index=Math.max(this._index,l$w+1);var l$P=l$b.data;if(l$b.isTo)for(var l$B in l$P)l$b.target[l$B]=l$P[l$B]}for(l$w=0,l$x=this._tweenDataList.length;l$w<l$x;l$w++)0==(l$b=this._tweenDataList[l$w]).type&&l$i>=l$b.startTime&&l$i<l$b.endTime&&(this._index=Math.max(this._index,l$w+1),this._gidIndex++,(l$_=l$y.getItemByClass("tween",l$d))._create(l$b.target,l$b.data,l$b.duration,l$b.ease,l$t.create(this,this._animComplete,[this._gidIndex]),0,!1,l$b.isTo,!0,!1),l$_.setStartTime(this._currTime-(l$i-l$b.startTime)),l$_._updateEase(this._currTime),l$_.gid=this._gidIndex,this._tweenDic[this._gidIndex]=l$_)}},l$_.gotoLabel=function(l$i){if(null!=this._labelDic){var l$_=this._labelDic[l$i];l$_&&this.gotoTime(l$_.startTime)}},l$_.pause=function(){l$A.timer.clear(this,this._update)},l$_.resume=function(){this.play(this._currTime,this._loopKey)},l$_.play=function(l$i,l$_){if(void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(l$i,l$_){return l$i.startTime>l$_.startTime?1:l$i.startTime<l$_.startTime?-1:0});for(var l$R=0,l$r=this._tweenDataList.length;l$R<l$r;l$R++){var l$b=this._tweenDataList[l$R];if(null!=l$b&&0==l$b.type){var l$z=l$b.target,l$L=l$z.$_GID||(l$z.$_GID=l$Q.getGID()),l$w=null;for(var l$x in null==this._firstTweenDic[l$L]?((l$w={}).diyTarget=l$z,this._firstTweenDic[l$L]=l$w):l$w=this._firstTweenDic[l$L],l$b.data)null==l$w[l$x]&&(l$w[l$x]=l$z[l$x])}}}"string"==typeof l$i?this.gotoLabel(l$i):this.gotoTime(l$i),this._loopKey=l$_,this._lastTime=l$s.now(),l$A.timer.frameLoop(1,this,this._update)}},l$_._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var l$i in this._tweenDic)(l$_=this._tweenDic[l$i]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var l$_,l$R=l$s.now(),l$r=l$R-this._lastTime,l$b=this._currTime+=l$r*this.scale;for(l$i in this._lastTime=l$R,this._tweenDic)(l$_=this._tweenDic[l$i])._updateEase(l$b);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var l$z=this._tweenDataList[this._index];l$b>=l$z.startTime&&(this._index++,0==l$z.type?(this._gidIndex++,(l$_=l$y.getItemByClass("tween",l$d))._create(l$z.target,l$z.data,l$z.duration,l$z.ease,l$t.create(this,this._animComplete,[this._gidIndex]),0,!1,l$z.isTo,!0,!1),l$_.setStartTime(l$b),l$_.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=l$_)._updateEase(l$b)):this.event("label",l$z.data))}},l$_._animComplete=function(l$i){this._tweenDic[l$i]&&delete this._tweenDic[l$i]},l$_._complete=function(){this.event("complete")},l$_.reset=function(){var l$i;if(this._labelDic)for(l$i in this._labelDic)delete this._labelDic[l$i];for(l$i in this._tweenDic)this._tweenDic[l$i].clear(),delete this._tweenDic[l$i];for(l$i in this._firstTweenDic)delete this._firstTweenDic[l$i];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var l$_,l$R=0;for(l$_=this._tweenDataList.length,l$R=0;l$R<l$_;l$R++)this._tweenDataList[l$R]&&this._tweenDataList[l$R].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,l$A.timer.clear(this,this._update)},l$_.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},l$h(0,l$_,"index",function(){return this._frameIndex},function(l$i){this._frameIndex=l$i,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),l$h(0,l$_,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),l$z.to=function(l$i,l$_,l$R,l$r,l$b){return void 0===l$b&&(l$b=0),(new l$z).to(l$i,l$_,l$R,l$r,l$b)},l$z.from=function(l$i,l$_,l$R,l$r,l$b){return void 0===l$b&&(l$b=0),(new l$z).from(l$i,l$_,l$R,l$r,l$b)},l$z.__init$=function(){l$w=function(){function l$i(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return l$B(l$i,""),l$i.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,l$y.recover("tweenData",this)},l$i}()},l$z}(),l$ni=function(l$b){function l$R(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,l$R.__super.call(this),this._style=l$w.EMPTY}l$B(l$R,"laya.display.Sprite",l$b);var l$i=l$R.prototype;return l$A.imps(l$i,{"laya.display.ILayout":!0}),l$i.createConchModel=function(){return new ConchNode},l$i.destroy=function(l$i){if(void 0===l$i&&(l$i=!0),this._releaseMem(),!this._destroyed){this.filters=null;var l$_=this.mask;l$_&&(this.mask=null,l$_.destroy(l$i))}l$b.prototype.destroy.call(this,l$i),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},l$i.updateZOrder=function(){l$Q.updateOrder(this._childs)&&this.repaint()},l$i.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},l$i.setBounds=function(l$i){this._set$P("uBounds",l$i)},l$i.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new l$q),l$q._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},l$i.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new l$q),l$q._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},l$i._boundPointsToParent=function(l$i){void 0===l$i&&(l$i=!1);var l$_=0,l$R=0;this._style&&(l$_=this._style._tf.translateX,l$R=this._style._tf.translateY,l$i=l$i||0!==this._style._tf.rotate,this._style.scrollRect&&(l$_+=this._style.scrollRect.x,l$R+=this._style.scrollRect.y));var l$r=this._getBoundPointsM(l$i);if(!l$r||l$r.length<1)return l$r;if(8!=l$r.length&&(l$r=l$i?l$c.scanPList(l$r):l$q._getWrapRec(l$r,l$q.TEMP)._getBoundPoints()),!this.transform)return l$Q.transPointList(l$r,this._x-l$_,this._y-l$R),l$r;var l$b=l$Z.TEMP,l$z=0,l$L=l$r.length;for(l$z=0;l$z<l$L;l$z+=2)l$b.x=l$r[l$z],l$b.y=l$r[l$z+1],this.toParentPoint(l$b),l$r[l$z]=l$b.x,l$r[l$z+1]=l$b.y;return l$r},l$i.getGraphicBounds=function(l$i){return void 0===l$i&&(l$i=!1),this._graphics?this._graphics.getBounds(l$i):l$q.TEMP.setTo(0,0,0,0)},l$i._getBoundPointsM=function(l$i){if(void 0===l$i&&(l$i=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var l$_=l$Q.clearArray(this._$P.temBM),l$R=l$q.TEMP;return l$R.copyFrom(this.scrollRect),l$Q.concatArray(l$_,l$R._getBoundPoints()),l$_}for(var l$r,l$b,l$z,l$L=this._graphics?this._graphics.getBoundPoints():l$Q.clearArray(this._$P.temBM),l$w=0,l$x=(l$z=this._childs).length;l$w<l$x;l$w++)(l$r=l$z[l$w])instanceof laya.display.Sprite&&1==l$r.visible&&(l$b=l$r._boundPointsToParent(l$i))&&(l$L=l$L?l$Q.concatArray(l$L,l$b):l$b);return l$L},l$i.getStyle=function(){return this._style===l$w.EMPTY&&(this._style=new l$w),this._style},l$i.setStyle=function(l$i){this._style=l$i},l$i._adjustTransform=function(){this._tfChanged=!1;var l$i,l$_=this._style._tf,l$R=l$_.scaleX,l$r=l$_.scaleY;if(l$_.rotate||1!==l$R||1!==l$r||l$_.skewX||l$_.skewY){(l$i=this._transform||(this._transform=l$G.create())).bTransform=!0;var l$b=.0174532922222222*(l$_.rotate-l$_.skewX),l$z=.0174532922222222*(l$_.rotate+l$_.skewY),l$L=Math.cos(l$z),l$w=Math.sin(l$z),l$x=Math.sin(l$b),l$P=Math.cos(l$b);return l$i.a=l$R*l$L,l$i.b=l$R*l$w,l$i.c=-l$r*l$x,l$i.d=l$r*l$P,l$i.tx=l$i.ty=0,l$i}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,l$i},l$i.pos=function(l$i,l$_,l$R){if(void 0===l$R&&(l$R=!1),this._x!==l$i||this._y!==l$_){if(this.destroyed)return this;if(l$R){this._x=l$i,this._y=l$_,this.conchModel&&this.conchModel.pos(this._x,this._y);var l$r=this._parent;l$r&&0===l$r._repaint&&(l$r._repaint=1,l$r.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=l$i,this.y=l$_}return this},l$i.pivot=function(l$i,l$_){return this.pivotX=l$i,this.pivotY=l$_,this},l$i.size=function(l$i,l$_){return this.width=l$i,this.height=l$_,this},l$i.scale=function(l$i,l$_,l$R){void 0===l$R&&(l$R=!1);var l$r=this.getStyle(),l$b=l$r._tf;if(l$b.scaleX!=l$i||l$b.scaleY!=l$_){if(this.destroyed)return this;if(l$R){l$r.setScale(l$i,l$_),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(l$i,l$_),this._renderType|=4;var l$z=this._parent;l$z&&0===l$z._repaint&&(l$z._repaint=1,l$z.parentRepaint())}else this.scaleX=l$i,this.scaleY=l$_}return this},l$i.skew=function(l$i,l$_){return this.skewX=l$i,this.skewY=l$_,this},l$i.render=function(l$i,l$_,l$R){l$a.spriteCount++,l$K.renders[this._renderType]._fun(this,l$i,l$_+this._x,l$R+this._y),this._repaint=0},l$i.drawToCanvas=function(l$i,l$_,l$R,l$r){if(l$p.isConchNode){var l$b=l$Ii.create("2D");return new l$k(l$i,l$_,l$b).ctx.setCanvasType(1),this.conchModel.drawToCanvas(l$b.source,l$R,l$r),l$b}return l$$.drawToCanvas(this,this._renderType,l$i,l$_,l$R,l$r)},l$i.customRender=function(l$i,l$_,l$R){this._renderType|=1024},l$i._applyFilters=function(){var l$i;if(!l$p.isWebGL&&((l$i=this._$P.filters)&&!(l$i.length<1)))for(var l$_=0,l$R=l$i.length;l$_<l$R;l$_++)l$i[l$_].action.apply(this._$P.cacheCanvas)},l$i._isHaveGlowFilter=function(){var l$i,l$_=0;if(this.filters)for(l$_=0;l$_<this.filters.length;l$_++)if(8==this.filters[l$_].type)return!0;for(l$_=0,l$i=this._childs.length;l$_<l$i;l$_++)if(this._childs[l$_]._isHaveGlowFilter())return!0;return!1},l$i.localToGlobal=function(l$i,l$_){void 0===l$_&&(l$_=!1),!0===l$_&&(l$i=new l$Z(l$i.x,l$i.y));for(var l$R=this;l$R&&l$R!=l$A.stage;)l$i=l$R.toParentPoint(l$i),l$R=l$R.parent;return l$i},l$i.globalToLocal=function(l$i,l$_){void 0===l$_&&(l$_=!1),l$_&&(l$i=new l$Z(l$i.x,l$i.y));for(var l$R=this,l$r=[];l$R&&l$R!=l$A.stage;)l$r.push(l$R),l$R=l$R.parent;for(var l$b=l$r.length-1;0<=l$b;)l$i=(l$R=l$r[l$b]).fromParentPoint(l$i),l$b--;return l$i},l$i.toParentPoint=function(l$i){if(!l$i)return l$i;l$i.x-=this.pivotX,l$i.y-=this.pivotY,this.transform&&this._transform.transformPoint(l$i),l$i.x+=this._x,l$i.y+=this._y;var l$_=this._style.scrollRect;return l$_&&(l$i.x-=l$_.x,l$i.y-=l$_.y),l$i},l$i.fromParentPoint=function(l$i){if(!l$i)return l$i;l$i.x-=this._x,l$i.y-=this._y;var l$_=this._style.scrollRect;return l$_&&(l$i.x+=l$_.x,l$i.y+=l$_.y),this.transform&&this._transform.invertTransformPoint(l$i),l$i.x+=this.pivotX,l$i.y+=this.pivotY,l$i},l$i.on=function(l$i,l$_,l$R,l$r){return 1!==this._mouseEnableState&&this.isMouseEvent(l$i)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(l$i,l$_,l$R,l$r,!1)):l$b.prototype.on.call(this,l$i,l$_,l$R,l$r)},l$i.once=function(l$i,l$_,l$R,l$r){return 1!==this._mouseEnableState&&this.isMouseEvent(l$i)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(l$i,l$_,l$R,l$r,!0)):l$b.prototype.once.call(this,l$i,l$_,l$R,l$r)},l$i._$2__onDisplay=function(){if(1!==this._mouseEnableState){var l$i=this;for(l$i=l$i.parent;l$i&&1!==l$i._mouseEnableState&&!l$i._getBit(2);)l$i.mouseEnabled=!0,l$i._setBit(2,!0),l$i=l$i.parent}},l$i.loadImage=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=this;return void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=0),void 0===l$b&&(l$b=0),this.graphics.loadImage(l$i,l$_,l$R,l$r,l$b,function(l$i){l$L.destroyed||(l$L.size(l$_+(l$r||l$i.width),l$R+(l$b||l$i.height)),l$L.repaint(),l$z&&l$z.runWith(l$i))}),this},l$i.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},l$i._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},l$i._childChanged=function(l$i){this._childs.length?this._renderType|=2048:this._renderType&=-2049,l$i&&this._get$P("hasZorder")&&l$A.timer.callLater(this,this.updateZOrder),this.repaint()},l$i.parentRepaint=function(){var l$i=this._parent;l$i&&0===l$i._repaint&&(l$i._repaint=1,l$i.parentRepaint())},l$i.startDrag=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){void 0===l$_&&(l$_=!1),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=300),void 0===l$z&&(l$z=!1),void 0===l$L&&(l$L=.92),this._$P.dragging||this._set$P("dragging",new l$U),this._$P.dragging.start(this,l$i,l$_,l$R,l$r,l$b,l$z,l$L)},l$i.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},l$i._releaseMem=function(){if(this._$P){var l$i=this._$P.cacheCanvas;l$i&&l$i.ctx&&(l$y.recover("RenderContext",l$i.ctx),l$i.ctx.canvas.size(0,0),l$i.ctx=null);var l$_=this._$P._filterCache;l$_&&(l$_.destroy(),l$_.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},l$i._setDisplay=function(l$i){l$i||this._releaseMem(),l$b.prototype._setDisplay.call(this,l$i)},l$i.hitTestPoint=function(l$i,l$_){var l$R=this.globalToLocal(l$Z.TEMP.setTo(l$i,l$_));return l$i=l$R.x,l$_=l$R.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?l$q.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(l$i,l$_)},l$i.getMousePoint=function(){return this.globalToLocal(l$Z.TEMP.setTo(l$A.stage.mouseX,l$A.stage.mouseY))},l$i._getWords=function(){return null},l$i._addChildsToLayout=function(l$i){var l$_=this._getWords();if(null==l$_&&0==this._childs.length)return!1;if(l$_)for(var l$R=0,l$r=l$_.length;l$R<l$r;l$R++)l$i.push(l$_[l$R]);l$R=0;for(var l$b=this._childs.length;l$R<l$b;++l$R){var l$z=this._childs[l$R];l$z._style._enableLayout()&&l$z._addToLayout(l$i)}return!0},l$i._addToLayout=function(l$i){this._style.absolute||(this._style.block?l$i.push(this):this._addChildsToLayout(l$i)&&(this.x=this.y=0))},l$i._isChar=function(){return!1},l$i._getCSSStyle=function(){return this._style.getCSSStyle()},l$i._setAttributes=function(l$i,l$_){switch(l$i){case"x":this.x=parseFloat(l$_);break;case"y":this.y=parseFloat(l$_);break;case"width":this.width=parseFloat(l$_);break;case"height":this.height=parseFloat(l$_);break;default:this[l$i]=l$_}},l$i._layoutLater=function(){this.parent&&this.parent._layoutLater()},l$h(0,l$i,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(l$i){this._optimizeScrollRect!=l$i&&(this._optimizeScrollRect=l$i,this.conchModel&&this.conchModel.optimizeScrollRect(l$i))}),l$h(0,l$i,"customRenderEnable",null,function(l$i){if(l$i&&(this._renderType|=1024,l$p.isConchNode)){l$R.CustomList.push(this);var l$_=new l$Ii("2d");l$_._setContext(new CanvasRenderingContext2D),this.customContext=new l$k(0,0,l$_),l$_.context.setCanvasType&&l$_.context.setCanvasType(2),this.conchModel.custom(l$_.context)}}),l$h(0,l$i,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(l$i){this.cacheAs=l$i?this._$P.hasFilter?"none":"normal":"none"}),l$h(0,l$i,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(l$i){var l$_=this._$P.cacheCanvas;if(l$i!==(l$_?l$_.type:"none")){if("none"!==l$i)this._getBit(1)||this._setUpNoticeType(1),l$_||(l$_=this._set$P("cacheCanvas",l$y.getItemByClass("cacheCanvas",Object))),l$_.type=l$i,l$_.reCache=!0,this._renderType|=16,"bitmap"==l$i&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(l$_){var l$R=l$_;l$R&&l$R.ctx&&(l$y.recover("RenderContext",l$R.ctx),l$R.ctx.canvas.size(0,0),l$R.ctx=null),l$y.recover("cacheCanvas",l$_)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),l$h(0,l$i,"zOrder",function(){return this._zOrder},function(l$i){this._zOrder!=l$i&&(this._zOrder=l$i,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(l$i),this._parent&&(l$i&&this._parent._set$P("hasZorder",!0),l$A.timer.callLater(this._parent,this.updateZOrder)))}),l$h(0,l$i,"rotation",function(){return this._style._tf.rotate},function(l$i){var l$_=this.getStyle();if(l$_._tf.rotate!==l$i){l$_.setRotate(l$i),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(l$i),this._renderType|=4;var l$R=this._parent;l$R&&0===l$R._repaint&&(l$R._repaint=1,l$R.parentRepaint())}}),l$h(0,l$i,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(l$i){this._width!==l$i&&(this._width=l$i,this.conchModel&&this.conchModel.size(l$i,this._height),this.repaint())}),l$h(0,l$i,"x",function(){return this._x},function(l$i){if(this._x!==l$i){if(this.destroyed)return;this._x=l$i,this.conchModel&&this.conchModel.pos(l$i,this._y);var l$_=this._parent;l$_&&0===l$_._repaint&&(l$_._repaint=1,l$_.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),l$h(0,l$i,"globalScaleY",function(){for(var l$i=1,l$_=this;l$_&&l$_!==l$A.stage;)l$i*=l$_.scaleY,l$_=l$_.parent;return l$i}),l$h(0,l$i,"hitArea",function(){return this._$P.hitArea},function(l$i){this._set$P("hitArea",l$i)}),l$h(0,l$i,"staticCache",function(){return this._$P.staticCache},function(l$i){this._set$P("staticCache",l$i),l$i||this.reCache()}),l$h(0,l$i,"texture",function(){return this._texture},function(l$i){this._texture!=l$i&&(this._texture=l$i,this.graphics.cleanByTexture(l$i,0,0))}),l$h(0,l$i,"y",function(){return this._y},function(l$i){if(this._y!==l$i){if(this.destroyed)return;this._y=l$i,this.conchModel&&this.conchModel.pos(this._x,l$i);var l$_=this._parent;l$_&&0===l$_._repaint&&(l$_._repaint=1,l$_.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),l$h(0,l$i,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(l$i){this._height!==l$i&&(this._height=l$i,this.conchModel&&this.conchModel.size(this._width,l$i),this.repaint())}),l$h(0,l$i,"blendMode",function(){return this._style.blendMode},function(l$i){this.getStyle().blendMode=l$i,this.conchModel&&this.conchModel.blendMode(l$i),l$i&&"source-over"!=l$i?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),l$h(0,l$i,"scaleX",function(){return this._style._tf.scaleX},function(l$i){var l$_=this.getStyle();if(l$_._tf.scaleX!==l$i){l$_.setScaleX(l$i),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(l$i,l$_._tf.scaleY),this._renderType|=4;var l$R=this._parent;l$R&&0===l$R._repaint&&(l$R._repaint=1,l$R.parentRepaint())}}),l$h(0,l$i,"scaleY",function(){return this._style._tf.scaleY},function(l$i){var l$_=this.getStyle();if(l$_._tf.scaleY!==l$i){l$_.setScaleY(l$i),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(l$_._tf.scaleX,l$i),this._renderType|=4;var l$R=this._parent;l$R&&0===l$R._repaint&&(l$R._repaint=1,l$R.parentRepaint())}}),l$h(0,l$i,"stage",function(){return l$A.stage}),l$h(0,l$i,"skewX",function(){return this._style._tf.skewX},function(l$i){var l$_=this.getStyle();if(l$_._tf.skewX!==l$i){l$_.setSkewX(l$i),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(l$i,l$_._tf.skewY),this._renderType|=4;var l$R=this._parent;l$R&&0===l$R._repaint&&(l$R._repaint=1,l$R.parentRepaint())}}),l$h(0,l$i,"scrollRect",function(){return this._style.scrollRect},function(l$i){this.getStyle().scrollRect=l$i,this.repaint(),l$i?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(l$i.x,l$i.y,l$i.width,l$i.height)):(this._renderType&=-129,this.conchModel&&(l$R.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),l$h(0,l$i,"skewY",function(){return this._style._tf.skewY},function(l$i){var l$_=this.getStyle();if(l$_._tf.skewY!==l$i){l$_.setSkewY(l$i),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(l$_._tf.skewX,l$i),this._renderType|=4;var l$R=this._parent;l$R&&0===l$R._repaint&&(l$R._repaint=1,l$R.parentRepaint())}}),l$h(0,l$i,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(l$i){this._tfChanged=!1,(this._transform=l$i)&&(this._x=l$i.tx,this._y=l$i.ty,l$i.tx=l$i.ty=0,this.conchModel&&this.conchModel.transform(l$i.a,l$i.b,l$i.c,l$i.d,this._x,this._y)),l$i?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),l$h(0,l$i,"pivotX",function(){return this._style._tf.translateX},function(l$i){this.getStyle().setTranslateX(l$i),this.conchModel&&this.conchModel.pivot(l$i,this._style._tf.translateY),this.repaint()}),l$h(0,l$i,"pivotY",function(){return this._style._tf.translateY},function(l$i){this.getStyle().setTranslateY(l$i),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,l$i),this.repaint()}),l$h(0,l$i,"alpha",function(){return this._style.alpha},function(l$i){this._style&&this._style.alpha!==l$i&&(l$i=l$i<0?0:1<l$i?1:l$i,this.getStyle().alpha=l$i,this.conchModel&&this.conchModel.alpha(l$i),1!==l$i?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),l$h(0,l$i,"visible",function(){return this._style.visible},function(l$i){this._style&&this._style.visible!==l$i&&(this.getStyle().visible=l$i,this.conchModel&&this.conchModel.visible(l$i),this.parentRepaint())}),l$h(0,l$i,"graphics",function(){return this._graphics||(this.graphics=l$$.createGraphics())},function(l$i){this._graphics&&(this._graphics._sp=null),(this._graphics=l$i)?(this._renderType&=-2,this._renderType|=512,(l$i._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(l$R.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),l$h(0,l$i,"filters",function(){return this._$P.filters},function(l$i){l$i&&0===l$i.length&&(l$i=null),this._$P.filters!=l$i&&(this._set$P("filters",l$i?l$i.slice():null),l$p.isConchApp&&(this.conchModel&&(l$R.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),l$p.isWebGL&&(l$i&&l$i.length?this._renderType|=32:this._renderType&=-33),l$i&&0<l$i.length?(this._getBit(1)||this._setUpNoticeType(1),l$p.isWebGL&&1==l$i.length&&l$i[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(l$p.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),l$h(0,l$i,"parent",l$b.prototype._$get_parent,function(l$i){l$A.superSet(l$ii,this,"parent",l$i),l$i&&this._getBit(2)&&this._$2__onDisplay()}),l$h(0,l$i,"mask",function(){return this._$P._mask},function(l$i){l$i&&this.mask&&this.mask._$P.maskParent||(l$i?(this.cacheAs="bitmap",this._set$P("_mask",l$i),l$i._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",l$i),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(l$i?l$i.conchModel:null),this._renderType|=64,this.parentRepaint())}),l$h(0,l$i,"mouseEnabled",function(){return 1<this._mouseEnableState},function(l$i){this._mouseEnableState=l$i?2:1}),l$h(0,l$i,"globalScaleX",function(){for(var l$i=1,l$_=this;l$_&&l$_!==l$A.stage;)l$i*=l$_.scaleX,l$_=l$_.parent;return l$i}),l$h(0,l$i,"mouseX",function(){return this.getMousePoint().x}),l$h(0,l$i,"mouseY",function(){return this.getMousePoint().y}),l$R.fromImage=function(l$i){return(new l$R).loadImage(l$i)},l$R._cachePool=[],l$R.CustomList=[],l$x(l$R,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=l$L.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),l$R}(l$ii),l$fi=function(l$i){function l$_(l$i){this._audio=null,this._onEnd=null,this._resumePlay=null,l$_.__super.call(this),this._onEnd=l$Q.bind(this.__onEnd,this),this._resumePlay=l$Q.bind(this.__resumePlay,this),l$i.addEventListener("ended",this._onEnd),this._audio=l$i}l$B(l$_,"laya.media.h5audio.AudioSoundChannel",l$ri);var l$R=l$_.prototype;return l$R.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(l$A.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},l$R.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,l$s.container.appendChild(this._audio),this._audio.play()}catch(l$i){this.event("error")}},l$R.play=function(l$i){this.isStopped=!1;try{this._audio.playbackRate=l$v.playbackRate,this._audio.currentTime=this.startTime}catch(l$i){return void this._audio.addEventListener("canplay",this._resumePlay)}l$v.addChannel(this),l$s.container.appendChild(this._audio),!l$i&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},l$R.stop=function(){this.isStopped=!0,l$v.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&l$p.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),l$s.onIE||this._audio!=l$Ri._musicAudio&&l$y.recover("audio:"+this.url,this._audio),l$s.removeElement(this._audio),this._audio=null)},l$R.pause=function(){this.isStopped=!0,l$v.removeChannel(this),"pause"in this._audio&&this._audio.pause()},l$R.resume=function(){this._audio&&(this.isStopped=!1,l$v.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},l$h(0,l$R,"position",function(){return this._audio?this._audio.currentTime:0}),l$h(0,l$R,"duration",function(){return this._audio?this._audio.duration:0}),l$h(0,l$R,"volume",function(){return this._audio?this._audio.volume:1},function(l$i){this._audio&&(this._audio.volume=l$i)}),l$_}(),l$Ji=function(l$i){function l$_(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=l$zi.ctx,l$_.__super.call(this),this._onPlayEnd=l$Q.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}l$B(l$_,"laya.media.webaudio.WebAudioSoundChannel",l$ri);var l$R=l$_.prototype;return l$R.play=function(l$i){if(l$v.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var l$_=this.context,l$R=this.gain,l$r=l$_.createBufferSource();(this.bufferSource=l$r).buffer=this.audioBuffer,l$r.connect(l$R),l$R&&l$R.disconnect(),l$R.connect(l$_.destination),l$r.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=l$s.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(l$r.loop=!0),l$r.playbackRate.setTargetAtTime?l$r.playbackRate.setTargetAtTime(l$v.playbackRate,this.context.currentTime,.1):l$r.playbackRate.value=l$v.playbackRate,l$r.start(0,this.startTime),!l$i&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},l$R.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(l$A.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},l$R._clearBufferSource=function(){if(this.bufferSource){var l$i=this.bufferSource;l$i.stop?l$i.stop(0):l$i.noteOff(0),l$i.disconnect(0),l$i.onended=null,l$_._tryCleanFailed||this._tryClearBuffer(l$i),this.bufferSource=null}},l$R._tryClearBuffer=function(l$i){try{l$i.buffer=null}catch(l$i){l$_._tryCleanFailed=!0}},l$R.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,l$v.removeChannel(this),this.startHandler=null,this.completeHandler=null},l$R.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,l$v.removeChannel(this)},l$R.resume=function(){this.startTime=this._pauseTime,this.play(!1)},l$h(0,l$R,"position",function(){return this.bufferSource?(l$s.now()-this._startTime)/1e3+this.startTime:0}),l$h(0,l$R,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),l$h(0,l$R,"volume",function(){return this._volume},function(l$i){this.isStopped||(this._volume=l$i,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(l$i,this.context.currentTime,.1):this.gain.gain.value=l$i)}),l$_._tryCleanFailed=!1,l$_}(),l$hi=function(l$i){function l$_(){l$_.__super.call(this),this._w=0,this._h=0}l$B(l$_,"laya.resource.Bitmap",l$Pi);var l$R=l$_.prototype;return l$h(0,l$R,"width",function(){return this._w}),l$h(0,l$R,"height",function(){return this._h}),l$h(0,l$R,"source",function(){return this._source}),l$_}(),l$Mi=function(l$_){function l$i(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,l$i.__super.call(this),this._interval=l$r.animationInterval,this._setUpNoticeType(1)}l$B(l$i,"laya.display.AnimationPlayerBase",l$_);var l$R=l$i.prototype;return l$R.play=function(l$i,l$_,l$R,l$r){void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=!0),void 0===l$R&&(l$R=""),void 0===l$r&&(l$r=!0),this._isPlaying=!0,this.index="string"==typeof l$i?this._getFrameByLabel(l$i):l$i,this.loop=l$_,this._actionName=l$R,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},l$R._getFrameByLabel=function(l$i){var l$_=0;for(l$_=0;l$_<this._count;l$_++)if(this._labels[l$_]&&0<=this._labels[l$_].indexOf(l$i))return l$_;return 0},l$R._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},l$R._setControlNode=function(l$i){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=l$i)&&l$i!=this&&(l$i.on("display",this,this._checkResumePlaying),l$i.on("undisplay",this,this._checkResumePlaying))},l$R._setDisplay=function(l$i){l$_.prototype._setDisplay.call(this,l$i),this._checkResumePlaying()},l$R._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},l$R.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},l$R.addLabel=function(l$i,l$_){this._labels||(this._labels={}),this._labels[l$_]||(this._labels[l$_]=[]),this._labels[l$_].push(l$i)},l$R.removeLabel=function(l$i){if(l$i){if(this._labels)for(var l$_ in this._labels)this._removeLabelFromLabelList(this._labels[l$_],l$i)}else this._labels=null},l$R._removeLabelFromLabelList=function(l$i,l$_){if(l$i)for(var l$R=l$i.length-1;0<=l$R;l$R--)l$i[l$R]==l$_&&l$i.splice(l$R,1)},l$R.gotoAndStop=function(l$i){this.index="string"==typeof l$i?this._getFrameByLabel(l$i):l$i,this.stop()},l$R._displayToIndex=function(l$i){},l$R.clear=function(){this.stop(),this._labels=null},l$h(0,l$R,"interval",function(){return this._interval},function(l$i){this._interval!=l$i&&(this._frameRateChanged=!0,this._interval=l$i,this._isPlaying&&0<l$i&&this.timerLoop(l$i,this,this._frameLoop,null,!0,!0))}),l$h(0,l$R,"isPlaying",function(){return this._isPlaying}),l$h(0,l$R,"index",function(){return this._index},function(l$i){if(this._index=l$i,this._displayToIndex(l$i),this._labels&&this._labels[l$i])for(var l$_=this._labels[l$i],l$R=0,l$r=l$_.length;l$R<l$r;l$R++)this.event("label",l$_[l$R])}),l$h(0,l$R,"count",function(){return this._count}),l$i.WRAP_POSITIVE=0,l$i.WRAP_REVERSE=1,l$i.WRAP_PINGPONG=2,l$i}(l$ni),l$Ni=function(l$_){function l$J(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,l$J.__super.call(this),this.overflow=l$J.VISIBLE,this._style=new l$_i(this),this._style.wordWrap=!1}l$B(l$J,"laya.display.Text",l$_);var l$i=l$J.prototype;return l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,l$i),this._lines=null,this._words&&(this._words.length=0,this._words=null)},l$i._getBoundPointsM=function(l$i){void 0===l$i&&(l$i=!1);var l$_=l$q.TEMP;return l$_.setTo(0,0,this.width,this.height),l$_._getBoundPoints()},l$i.getGraphicBounds=function(l$i){void 0===l$i&&(l$i=!1);var l$_=l$q.TEMP;return l$_.setTo(0,0,this.width,this.height),l$_},l$i._getCSSStyle=function(){return this._style},l$i.lang=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B){if(l$i=l$J.langPacks&&l$J.langPacks[l$i]?l$J.langPacks[l$i]:l$i,arguments.length<2)this._text=l$i;else{for(var l$n=0,l$f=arguments.length;l$n<l$f;l$n++)l$i=l$i.replace("{"+l$n+"}",arguments[l$n+1]);this._text=l$i}},l$i._isPassWordMode=function(){var l$i=this._style.password;return"prompt"in this&&this.prompt==this._text&&(l$i=!1),l$i},l$i._getPassWordTxt=function(l$i){var l$_;l$_="";for(var l$R=l$i.length;0<l$R;l$R--)l$_+="●";return l$_},l$i.renderText=function(l$i,l$_){var l$R=this.graphics;l$R.clear(!0);var l$r=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(l$s.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);l$s.context.font=l$r;var l$b=this.padding,l$z=l$b[3],l$L="left",l$w=this._lines,l$x=this.leading+this._charSize.height,l$P=this._currBitmapFont;l$P&&(l$x=this.leading+l$P.getMaxHeight());var l$B=l$b[0];if(!l$P&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(l$L="right",l$z=this._width-l$b[1]):"center"==this.align&&(l$L="center",l$z=.5*this._width+l$b[3]-l$b[1])),0<this._height){var l$n=this._textHeight>this._height?"top":this.valign;"middle"===l$n?l$B=.5*(this._height-l$_*l$x)+l$b[0]-l$b[2]:"bottom"===l$n&&(l$B=this._height-l$_*l$x-l$b[2])}var l$f=this._style;if(l$P&&l$P.autoScaleSize)var l$J=l$P.fontSize/this.fontSize;if(this._clipPoint)if(l$R.save(),l$P&&l$P.autoScaleSize){var l$h=0,l$M=0;l$h=this._width?this._width-l$b[3]-l$b[1]:this._textWidth,l$M=this._height?this._height-l$b[0]-l$b[2]:this._textHeight,l$h*=l$J,l$M*=l$J,l$R.clipRect(l$b[3],l$b[0],l$h,l$M)}else l$R.clipRect(l$b[3],l$b[0],this._width?this._width-l$b[3]-l$b[1]:this._textWidth,this._height?this._height-l$b[0]-l$b[2]:this._textHeight);var l$N=l$f.password;"prompt"in this&&this.prompt==this._text&&(l$N=!1);for(var l$X=0,l$t=0,l$I=Math.min(this._lines.length,l$_+l$i)||1,l$e=l$i;l$e<l$I;l$e++){var l$c,l$l=l$w[l$e];if(l$N){var l$A=l$l.length;l$l="";for(var l$Z=l$A;0<l$Z;l$Z--)l$l+="●"}if(l$X=l$z-(this._clipPoint?this._clipPoint.x:0),l$t=l$B+l$x*l$e-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(l$L,l$X,l$t,l$e),l$P){var l$q=this.width;l$P.autoScaleSize&&(l$q=this.width*l$J),l$P.drawText(l$l,this,l$X,l$t,this.align,l$q)}else l$p.isWebGL?(this._words||(this._words=[]),(l$c=this._words.length>l$e-l$i?this._words[l$e-l$i]:new l$T).setText(l$l)):l$c=l$l,l$f.stroke?l$R.fillBorderText(l$c,l$X,l$t,l$r,this.color,l$f.strokeColor,l$f.stroke,l$L):l$R.fillText(l$c,l$X,l$t,l$r,this.color,l$L)}if(l$P&&l$P.autoScaleSize){var l$j=1/l$J;this.scale(l$j,l$j)}this._clipPoint&&l$R.restore(),this._startX=l$z,this._startY=l$B},l$i.drawUnderline=function(l$i,l$_,l$R,l$r){var l$b=this._lineWidths[l$r];switch(l$i){case"center":l$_-=l$b/2;break;case"right":l$_-=l$b}l$R+=this._charSize.height,this._graphics.drawLine(l$_,l$R,l$_+l$b,l$R,this.underlineColor||this.color,1)},l$i.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);l$s.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new l$Z(0,0)):this._clipPoint=null;var l$i=this._lines.length;if(this.overflow!=l$J.VISIBLE){var l$_=this.overflow==l$J.HIDDEN?Math.floor:Math.ceil;l$i=Math.min(l$i,l$_((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var l$R=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(l$R,l$i),this.repaint()},l$i.evalTextSize=function(){var l$i,l$_=NaN;l$i=Math.max.apply(this,this._lineWidths),l$_=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],l$i==this._textWidth&&l$_==this._textHeight||(this._textWidth=l$i,this._textHeight=l$_,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},l$i.checkEnabledViewportOrNot=function(){return this.overflow==l$J.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},l$i.changeText=function(l$i){this._text!==l$i&&(this.lang(l$i+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},l$i.parseLines=function(l$i){var l$_=this.wordWrap||this.overflow==l$J.HIDDEN;if(l$_)var l$R=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var l$r=l$Q.contextMeasureText(l$J._testWord);l$p.isConchApp&&0===l$r.width&&0===l$r.height&&(l$r=l$Q.contextMeasureText("W")),this._charSize.width=l$r.width,this._charSize.height=l$r.height||this.fontSize}for(var l$b=l$i.replace(/\r\n/g,"\n").split("\n"),l$z=0,l$L=l$b.length;l$z<l$L;l$z++){var l$w=l$b[l$z];l$_?this.parseLine(l$w,l$R):(this._lineWidths.push(this.getTextWidth(l$w)),this._lines.push(l$w))}},l$i.parseLine=function(l$i,l$_){l$s.context;var l$R,l$r=this._lines,l$b=0,l$z=NaN,l$L=NaN,l$w=0;if((l$z=this.getTextWidth(l$i))<=l$_)return l$r.push(l$i),void this._lineWidths.push(l$z);l$z=this._charSize.width,0==(l$b=Math.floor(l$_/l$z))&&(l$b=1),l$L=l$z=this.getTextWidth(l$i.substring(0,l$b));for(var l$x=l$b,l$P=l$i.length;l$x<l$P;l$x++)if(l$_<(l$L+=l$z=this.getTextWidth(l$i.charAt(l$x))))if(this.wordWrap){var l$B=l$i.substring(l$w,l$x);if(l$B.charCodeAt(l$B.length-1)<255?(l$R=/(?:\w|-)+$/.exec(l$B))&&(l$x=l$R.index+l$w,0==l$R.index?l$x+=l$B.length:l$B=l$i.substring(l$w,l$x)):l$J.RightToLeft&&(l$R=/([\u0600-\u06FF])+$/.exec(l$B))&&(l$x=l$R.index+l$w,0==l$R.index?l$x+=l$B.length:l$B=l$i.substring(l$w,l$x)),l$r.push(l$B),this._lineWidths.push(l$L-l$z),!((l$w=l$x)+l$b<l$P)){l$r.push(l$i.substring(l$w,l$P)),this._lineWidths.push(this.getTextWidth(l$r[l$r.length-1])),l$w=-1;break}l$x+=l$b,l$L=l$z=this.getTextWidth(l$i.substring(l$w,l$x)),l$x--}else if(this.overflow==l$J.HIDDEN)return l$r.push(l$i.substring(0,l$x)),void this._lineWidths.push(this.getTextWidth(l$r[l$r.length-1]));this.wordWrap&&-1!=l$w&&(l$r.push(l$i.substring(l$w,l$P)),this._lineWidths.push(this.getTextWidth(l$r[l$r.length-1])))},l$i.getTextWidth=function(l$i){return this._currBitmapFont?this._currBitmapFont.getTextWidth(l$i):l$Q.contextMeasureText(l$i).width},l$i.getWordWrapWidth=function(){var l$i=this.padding,l$_=NaN;return(l$_=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(l$_=this.wordWrap?100:l$s.width),l$_<=0&&(l$_=100),l$_-l$i[3]-l$i[1]},l$i.getCharPoint=function(l$i,l$_){this._isChanged&&l$A.timer.runCallLater(this,this.typeset);for(var l$R=0,l$r=this._lines,l$b=0,l$z=0,l$L=l$r.length;l$z<l$L;l$z++){if(l$i<(l$R+=l$r[l$z].length)){var l$w=l$z;break}l$b=l$R}var l$x=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;l$s.context.font=l$x;var l$P=this.getTextWidth(this._text.substring(l$b,l$i));return(l$_||new l$Z).setTo(this._startX+l$P-(this._clipPoint?this._clipPoint.x:0),this._startY+l$w*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},l$h(0,l$i,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(l$i){l$i!=this._width&&(l$A.superSet(l$ni,this,"width",l$i),this.isChanged=!0)}),l$h(0,l$i,"textWidth",function(){return this._isChanged&&l$A.timer.runCallLater(this,this.typeset),this._textWidth}),l$h(0,l$i,"height",function(){return this._height?this._height:this.textHeight},function(l$i){l$i!=this._height&&(l$A.superSet(l$ni,this,"height",l$i),this.isChanged=!0)}),l$h(0,l$i,"textHeight",function(){return this._isChanged&&l$A.timer.runCallLater(this,this.typeset),this._textHeight}),l$h(0,l$i,"padding",function(){return this._getCSSStyle().padding},function(l$i){this._getCSSStyle().padding=l$i,this.isChanged=!0}),l$h(0,l$i,"bold",function(){return this._getCSSStyle().bold},function(l$i){this._getCSSStyle().bold=l$i,this.isChanged=!0}),l$h(0,l$i,"text",function(){return this._text||""},function(l$i){this._text!==l$i&&(this.lang(l$i+""),this.isChanged=!0,this.event("change"))}),l$h(0,l$i,"color",function(){return this._getCSSStyle().color},function(l$i){this._getCSSStyle().color!=l$i&&(this._getCSSStyle().color=l$i,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),l$h(0,l$i,"font",function(){return this._getCSSStyle().fontFamily},function(l$i){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),l$J._bitmapFonts&&l$J._bitmapFonts[l$i]&&(this._currBitmapFont=l$J._bitmapFonts[l$i]),this._getCSSStyle().fontFamily=l$i,this.isChanged=!0}),l$h(0,l$i,"fontSize",function(){return this._getCSSStyle().fontSize},function(l$i){this._getCSSStyle().fontSize=l$i,this.isChanged=!0}),l$h(0,l$i,"italic",function(){return this._getCSSStyle().italic},function(l$i){this._getCSSStyle().italic=l$i,this.isChanged=!0}),l$h(0,l$i,"align",function(){return this._getCSSStyle().align},function(l$i){this._getCSSStyle().align=l$i,this.isChanged=!0}),l$h(0,l$i,"valign",function(){return this._getCSSStyle().valign},function(l$i){this._getCSSStyle().valign=l$i,this.isChanged=!0}),l$h(0,l$i,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(l$i){this._getCSSStyle().wordWrap=l$i,this.isChanged=!0}),l$h(0,l$i,"leading",function(){return this._getCSSStyle().leading},function(l$i){this._getCSSStyle().leading=l$i,this.isChanged=!0}),l$h(0,l$i,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(l$i){this._getCSSStyle().backgroundColor=l$i,this.isChanged=!0}),l$h(0,l$i,"borderColor",function(){return this._getCSSStyle().borderColor},function(l$i){this._getCSSStyle().borderColor=l$i,this.isChanged=!0}),l$h(0,l$i,"stroke",function(){return this._getCSSStyle().stroke},function(l$i){this._getCSSStyle().stroke=l$i,this.isChanged=!0}),l$h(0,l$i,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(l$i){this._getCSSStyle().strokeColor=l$i,this.isChanged=!0}),l$h(0,l$i,"isChanged",null,function(l$i){this._isChanged!==l$i&&(this._isChanged=l$i)&&l$A.timer.callLater(this,this.typeset)}),l$h(0,l$i,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(l$i){if(!(this.overflow!=l$J.SCROLL||this.textWidth<this._width)&&this._clipPoint){l$i=l$i<this.padding[3]?this.padding[3]:l$i;var l$_=this._textWidth-this._width;l$i=l$_<l$i?l$_:l$i;var l$R=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=l$i,this.renderText(this._lastVisibleLineIndex,l$R)}}),l$h(0,l$i,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(l$i){if(!(this.overflow!=l$J.SCROLL||this.textHeight<this._height)&&this._clipPoint){l$i=l$i<this.padding[0]?this.padding[0]:l$i;var l$_=this._textHeight-this._height,l$R=(l$i=l$_<l$i?l$_:l$i)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=l$R;var l$r=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=l$i,this.renderText(l$R,l$r)}}),l$h(0,l$i,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),l$h(0,l$i,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),l$h(0,l$i,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),l$h(0,l$i,"underlineColor",function(){return this._underlineColor},function(l$i){this._underlineColor=l$i,this._isChanged=!0,this.typeset()}),l$J.registerBitmapFont=function(l$i,l$_){l$J._bitmapFonts||(l$J._bitmapFonts={}),l$J._bitmapFonts[l$i]=l$_},l$J.unregisterBitmapFont=function(l$i,l$_){if(void 0===l$_&&(l$_=!0),l$J._bitmapFonts&&l$J._bitmapFonts[l$i]){var l$R=l$J._bitmapFonts[l$i];l$_&&l$R.destroy(),delete l$J._bitmapFonts[l$i]}},l$J.setTextRightToLeft=function(){var l$i;(l$i=l$s.canvas.source.style).display="none",l$i.position="absolute",l$i.direction="rtl",l$p._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,l$s.document.body.appendChild(l$s.canvas.source)},l$J.supportFont=function(l$i){l$s.context.font="10px sans-serif";var l$_=l$Q.contextMeasureText("abcji").width;l$s.context.font="10px "+l$i;var l$R=l$Q.contextMeasureText("abcji").width;return console.log(l$_,l$R),l$_!==l$R},l$J._testWord="游",l$J.langPacks=null,l$J.VISIBLE="visible",l$J.SCROLL="scroll",l$J.HIDDEN="hidden",l$J.CharacterCache=!0,l$J.RightToLeft=!1,l$J._bitmapFonts=null,l$x(l$J,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),l$J}(l$ni),l$Xi=function(l$n){function l$L(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",l$L.__super.call(this),this.offset=new l$Z,this._canvasTransform=new l$G,this._previousOrientation=l$s.window.orientation;var l$_=this;this.transform=l$G.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var l$i=l$s.window,l$R=this;l$i.addEventListener("focus",function(){l$_._isFocused=!0,l$R.event("focus"),l$R.event("focuschange")}),l$i.addEventListener("blur",function(){l$_._isFocused=!1,l$R.event("blur"),l$R.event("focuschange"),l$R._isInputting()&&(l$ci.inputElement.target.focus=!1)});var l$r="visibilityState",l$b="visibilitychange",l$z=l$i.document;void 0!==l$z.hidden?(l$b="visibilitychange",l$r="visibilityState"):void 0!==l$z.mozHidden?(l$b="mozvisibilitychange",l$r="mozVisibilityState"):void 0!==l$z.msHidden?(l$b="msvisibilitychange",l$r="msVisibilityState"):void 0!==l$z.webkitHidden&&(l$b="webkitvisibilitychange",l$r="webkitVisibilityState"),l$i.document.addEventListener(l$b,function(){"hidden"==l$s.document[l$r]?l$R._setStageVisible(!1):l$R._setStageVisible(!0)}),l$i.document.addEventListener("qbrowserVisibilityChange",function(l$i){l$R._setStageVisible(!l$i.hidden)}),l$i.addEventListener("resize",function(){var l$i=l$s.window.orientation;null!=l$i&&l$i!=l$_._previousOrientation&&l$R._isInputting()&&(l$ci.inputElement.target.focus=!1),l$_._previousOrientation=l$i,l$R._isInputting()||l$R._resetCanvas()}),l$i.addEventListener("orientationchange",function(l$i){l$R._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),l$s.onMobile&&this.on("mousedown",this,this._onmouseMove)}l$B(l$L,"laya.display.Stage",l$n);var l$i=l$L.prototype;return l$i._setStageVisible=function(l$i){this._isVisibility!=l$i&&(this._isVisibility=l$i,this._isVisibility||this._isInputting()&&(l$ci.inputElement.target.focus=!1),this.event("visibilitychange"))},l$i._isInputting=function(){return l$s.onMobile&&l$ci.isInputting},l$i._changeCanvasSize=function(){this.setScreenSize(l$s.clientWidth*l$s.pixelRatio,l$s.clientHeight*l$s.pixelRatio)},l$i._resetCanvas=function(){if(this.screenAdaptationEnabled){var l$i=l$p._mainCanvas;l$i.source.style;l$i.size(1,1),l$A.timer.once(100,this,this._changeCanvasSize)}},l$i.setScreenSize=function(l$i,l$_){var l$R=!1;if("none"!==this._screenMode&&(l$R=(l$i/l$_<1?"vertical":"horizontal")!==this._screenMode)){var l$r=l$_;l$_=l$i,l$i=l$r}this.canvasRotation=l$R;var l$b=l$p._mainCanvas,l$z=l$b.source.style,l$L=this._canvasTransform.identity(),l$w=this._scaleMode,l$x=l$i/this.designWidth,l$P=l$_/this.designHeight,l$B=this.designWidth,l$n=this.designHeight,l$f=l$i,l$J=l$_,l$h=l$s.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,l$w){case"noscale":l$x=l$P=1,l$f=this.designWidth,l$J=this.designHeight;break;case"showall":l$x=l$P=Math.min(l$x,l$P),l$B=l$f=Math.round(this.designWidth*l$x),l$n=l$J=Math.round(this.designHeight*l$P);break;case"noborder":l$x=l$P=Math.max(l$x,l$P),l$f=Math.round(this.designWidth*l$x),l$J=Math.round(this.designHeight*l$P);break;case"full":l$x=l$P=1,this._width=l$B=l$i,this._height=l$n=l$_;break;case"fixedwidth":l$P=l$x,this._height=l$n=Math.round(l$_/l$x);break;case"fixedheight":l$x=l$P,this._width=l$B=Math.round(l$i/l$P);break;case"fixedauto":l$i/l$_<this.designWidth/this.designHeight?(l$P=l$x,this._height=l$n=Math.round(l$_/l$x)):(l$x=l$P,this._width=l$B=Math.round(l$i/l$P))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,l$B=l$B+1&2147483646,l$n=l$n+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),l$x*=this.scaleX,l$P*=this.scaleY,1===l$x&&1===l$P?this.transform.identity():(this.transform.a=this._formatData(l$x/(l$f/l$B)),this.transform.d=this._formatData(l$P/(l$J/l$n)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),l$b.size(l$B,l$n),l$$.changeWebGLSize(l$B,l$n),l$L.scale(l$f/l$B/l$h,l$J/l$n/l$h),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(l$i-l$f)/l$h:this.offset.x=.5*(l$i-l$f)/l$h,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(l$_-l$J)/l$h:this.offset.y=.5*(l$_-l$J)/l$h,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),l$L.translate(this.offset.x,this.offset.y),this.canvasDegree=0,l$R&&("horizontal"===this._screenMode?(l$L.rotate(Math.PI/2),l$L.translate(l$_/l$h,0),this.canvasDegree=90):(l$L.rotate(-Math.PI/2),l$L.translate(0,l$i/l$h),this.canvasDegree=-90)),l$L.a=this._formatData(l$L.a),l$L.d=this._formatData(l$L.d),l$L.tx=this._formatData(l$L.tx),l$L.ty=this._formatData(l$L.ty),l$z.transformOrigin=l$z.webkitTransformOrigin=l$z.msTransformOrigin=l$z.mozTransformOrigin=l$z.oTransformOrigin="0px 0px 0px",l$z.transform=l$z.webkitTransform=l$z.msTransform=l$z.mozTransform=l$z.oTransform="matrix("+l$L.toString()+")",l$L.translate(parseInt(l$z.left)||0,parseInt(l$z.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},l$i._formatData=function(l$i){return Math.abs(l$i)<1e-6?0:Math.abs(1-l$i)<.001?0<l$i?1:-1:l$i},l$i.getMousePoint=function(){return l$Z.TEMP.setTo(this.mouseX,this.mouseY)},l$i.repaint=function(){this._repaint=1},l$i.parentRepaint=function(){},l$i._loop=function(){return this.render(l$p.context,0,0),!0},l$i._onmouseMove=function(l$i){this._mouseMoveTime=l$s.now()},l$i.getTimeFromFrameStart=function(){return l$s.now()-this._frameStartTime},l$i.render=function(l$i,l$_,l$R){if("sleep"===this._frameRate&&!l$p.isConchApp){var l$r=l$s.now();if(!(1e3<=l$r-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(l$a.loopCount++,l$M.instance.runEvent(),l$A.timer._update()));this._frameStartTime=l$r}if(this._renderCount++,l$p.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=l$s.now();var l$b="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),l$z=this._renderCount%2==0;if(l$a.renderSlow=!l$b,l$b||l$z||l$p.isConchApp){var l$L;l$a.loopCount++,l$M.instance.runEvent(),l$A.timer._update(),l$$.update3DLoop();var l$w=0,l$x=0;if(l$p.isConchNode)for(l$w=0,l$x=this._scenes.length;l$w<l$x;l$w++)(l$L=this._scenes[l$w])&&l$L._updateSceneConch();else for(l$w=0,l$x=this._scenes.length;l$w<l$x;l$w++)(l$L=this._scenes[l$w])&&l$L._updateScene();if(l$p.isConchNode){var l$P=l$ni.CustomList;for(l$w=0,l$x=l$P.length;l$w<l$x;l$w++){var l$B=l$P[l$w];l$B.customRender(l$B.customContext,0,0)}return}}l$p.isConchNode||this.renderingEnabled&&(l$b||!l$z||l$p.isConchWebGL)&&(l$p.isWebGL?l$p.WebGL.mainContext&&!l$p.WebGL.mainContext.isContextLost()&&(l$i.clear(),l$n.prototype.render.call(this,l$i,l$_,l$R),l$a._show&&l$a._sp&&l$a._sp.render(l$i,l$_,l$R),l$$.clear(this._bgColor),l$$.beginFlush(),l$i.flush(),l$$.endFinish(),l$H.instance&&l$H.getInstance().endDispose()):(l$$.clear(this._bgColor),l$n.prototype.render.call(this,l$i,l$_,l$R),l$a._show&&l$a._sp&&l$a._sp.render(l$i,l$_,l$R)))}else this._renderCount%5==0&&(l$a.loopCount++,l$M.instance.runEvent(),l$A.timer._update())},l$i._requestFullscreen=function(){var l$i=l$s.document.documentElement;l$i.requestFullscreen?l$i.requestFullscreen():l$i.mozRequestFullScreen?l$i.mozRequestFullScreen():l$i.webkitRequestFullscreen?l$i.webkitRequestFullscreen():l$i.msRequestFullscreen&&l$i.msRequestFullscreen()},l$i._fullScreenChanged=function(){l$A.stage.event("fullscreenchange")},l$i.exitFullscreen=function(){var l$i=l$s.document;l$i.exitFullscreen?l$i.exitFullscreen():l$i.mozCancelFullScreen?l$i.mozCancelFullScreen():l$i.webkitExitFullscreen&&l$i.webkitExitFullscreen()},l$h(0,l$i,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),l$h(0,l$i,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),l$h(0,l$i,"frameRate",function(){return this._frameRate},function(l$i){if(this._frameRate=l$i,l$p.isConchApp)switch(this._frameRate){case"slow":l$s.window.conch&&l$s.window.conchConfig.setSlowFrame&&l$s.window.conchConfig.setSlowFrame(!0);break;case"fast":l$s.window.conch&&l$s.window.conchConfig.setSlowFrame&&l$s.window.conchConfig.setSlowFrame(!1);break;case"mouse":l$s.window.conch&&l$s.window.conchConfig.setMouseFrame&&l$s.window.conchConfig.setMouseFrame(2e3);break;case"sleep":l$s.window.conch&&l$s.window.conchConfig.setLimitFPS&&l$s.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),l$h(0,l$i,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),l$h(0,l$i,"width",l$n.prototype._$get_width,function(l$i){this.designWidth=l$i,l$A.superSet(l$ni,this,"width",l$i),l$A.timer.callLater(this,this._changeCanvasSize)}),l$h(0,l$i,"alignH",function(){return this._alignH},function(l$i){this._alignH=l$i,l$A.timer.callLater(this,this._changeCanvasSize)}),l$h(0,l$i,"isFocused",function(){return this._isFocused}),l$h(0,l$i,"height",l$n.prototype._$get_height,function(l$i){this.designHeight=l$i,l$A.superSet(l$ni,this,"height",l$i),l$A.timer.callLater(this,this._changeCanvasSize)}),l$h(0,l$i,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||l$G.create()},l$n.prototype._$set_transform),l$h(0,l$i,"isVisibility",function(){return this._isVisibility}),l$h(0,l$i,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),l$h(0,l$i,"scaleMode",function(){return this._scaleMode},function(l$i){this._scaleMode=l$i,l$A.timer.callLater(this,this._changeCanvasSize)}),l$h(0,l$i,"alignV",function(){return this._alignV},function(l$i){this._alignV=l$i,l$A.timer.callLater(this,this._changeCanvasSize)}),l$h(0,l$i,"bgColor",function(){return this._bgColor},function(l$i){this._bgColor=l$i,this.conchModel&&this.conchModel.bgColor(l$i),l$p.isWebGL&&(l$i?l$L._wgColor=l$D.create(l$i)._color:l$s.onMiniGame||(l$L._wgColor=null)),l$s.onLimixiu?l$L._wgColor=l$D.create(l$i)._color:l$p.canvas.style.background=l$i||"none"}),l$h(0,l$i,"mouseX",function(){return Math.round(l$M.instance.mouseX/this.clientScaleX)}),l$h(0,l$i,"mouseY",function(){return Math.round(l$M.instance.mouseY/this.clientScaleY)}),l$h(0,l$i,"screenMode",function(){return this._screenMode},function(l$i){this._screenMode=l$i}),l$h(0,l$i,"visible",l$n.prototype._$get_visible,function(l$i){this.visible!==l$i&&(l$A.superSet(l$ni,this,"visible",l$i),l$p._mainCanvas.source.style.visibility=l$i?"visible":"hidden")}),l$h(0,l$i,"fullScreenEnabled",null,function(l$i){var l$_=l$s.document,l$R=l$p.canvas;l$i?(l$R.addEventListener("mousedown",this._requestFullscreen),l$R.addEventListener("touchstart",this._requestFullscreen),l$_.addEventListener("fullscreenchange",this._fullScreenChanged),l$_.addEventListener("mozfullscreenchange",this._fullScreenChanged),l$_.addEventListener("webkitfullscreenchange",this._fullScreenChanged),l$_.addEventListener("msfullscreenchange",this._fullScreenChanged)):(l$R.removeEventListener("mousedown",this._requestFullscreen),l$R.removeEventListener("touchstart",this._requestFullscreen),l$_.removeEventListener("fullscreenchange",this._fullScreenChanged),l$_.removeEventListener("mozfullscreenchange",this._fullScreenChanged),l$_.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),l$_.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),l$L.SCALE_NOSCALE="noscale",l$L.SCALE_EXACTFIT="exactfit",l$L.SCALE_SHOWALL="showall",l$L.SCALE_NOBORDER="noborder",l$L.SCALE_FULL="full",l$L.SCALE_FIXED_WIDTH="fixedwidth",l$L.SCALE_FIXED_HEIGHT="fixedheight",l$L.SCALE_FIXED_AUTO="fixedauto",l$L.ALIGN_LEFT="left",l$L.ALIGN_RIGHT="right",l$L.ALIGN_CENTER="center",l$L.ALIGN_TOP="top",l$L.ALIGN_MIDDLE="middle",l$L.ALIGN_BOTTOM="bottom",l$L.SCREEN_NONE="none",l$L.SCREEN_HORIZONTAL="horizontal",l$L.SCREEN_VERTICAL="vertical",l$L.FRAME_FAST="fast",l$L.FRAME_SLOW="slow",l$L.FRAME_MOUSE="mouse",l$L.FRAME_SLEEP="sleep",l$L.FRAME_MOUSE_THREDHOLD=2e3,l$x(l$L,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),l$L}(l$ni),l$ti=(function(l$i){function l$_(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,l$_.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}l$B(l$_,"laya.media.SoundNode",l$ni);var l$R=l$_.prototype;l$R._onParentChange=function(){this.target=this.parent},l$R.play=function(l$i,l$_){void 0===l$i&&(l$i=1),isNaN(l$i)&&(l$i=1),this.url&&(this.stop(),this._channel=l$v.playSound(this.url,l$i,null,l$_))},l$R.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},l$R._setPlayAction=function(l$i,l$_,l$R,l$r){void 0===l$r&&(l$r=!0),this[l$R]&&l$i&&(l$r?l$i.on(l$_,this,this[l$R]):l$i.off(l$_,this,this[l$R]))},l$R._setPlayActions=function(l$i,l$_,l$R,l$r){if(void 0===l$r&&(l$r=!0),l$i&&l$_){var l$b,l$z=l$_.split(","),l$L=0;for(l$b=l$z.length,l$L=0;l$L<l$b;l$L++)this._setPlayAction(l$i,l$z[l$L],l$R,l$r)}},l$h(0,l$R,"playEvent",null,function(l$i){(this._playEvents=l$i)&&this._tar&&this._setPlayActions(this._tar,l$i,"play")}),l$h(0,l$R,"target",null,function(l$i){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=l$i,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),l$h(0,l$R,"stopEvent",null,function(l$i){(this._stopEvents=l$i)&&this._tar&&this._setPlayActions(this._tar,l$i,"stop")})}(),function(l$i){function l$_(){this._src=null,this._onload=null,this._onerror=null,l$_.__super.call(this)}l$B(l$_,"laya.resource.FileBitmap",l$hi);var l$R=l$_.prototype;return l$h(0,l$R,"src",function(){return this._src},function(l$i){this._src=l$i}),l$h(0,l$R,"onload",null,function(l$i){}),l$h(0,l$R,"onerror",null,function(l$i){}),l$_}()),l$Ii=function(l$i){function l$R(l$i,l$_){this._is2D=!1,l$R.__super.call(this);var l$r=this;if(this._source=this,"2D"===l$i||"AUTO"===l$i&&!l$p.isWebGL){this._is2D=!0,this._source=l$_||l$s.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var l$b=this;l$b.getContext=function(l$i,l$_){if(l$r._ctx)return l$r._ctx;var l$R=l$r._ctx=l$r._source.getContext(l$i,l$_);return l$R&&(l$R._canvas=l$b,l$p.isFlash||l$s.onLimixiu||(l$R.size=function(l$i,l$_){})),l$R}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}l$B(l$R,"laya.resource.HTMLCanvas",l$hi);var l$_=l$R.prototype;return l$_.clear=function(){this._ctx&&this._ctx.clear()},l$_.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},l$_.release=function(){},l$_._setContext=function(l$i){this._ctx=l$i},l$_.getContext=function(l$i,l$_){return this._ctx?this._ctx:this._ctx=l$R._createContext(this)},l$_.getMemSize=function(){return 0},l$_.size=function(l$i,l$_){(this._w!=l$i||this._h!=l$_||this._source&&(this._source.width!=l$i||this._source.height!=l$_))&&(this._w=l$i,this._h=l$_,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(l$i,l$_),this._source&&(this._source.height=l$_,this._source.width=l$i))},l$_.getCanvas=function(){return this._source},l$_.toBase64=function(l$i,l$_,l$R){if(this._source)if(l$p.isConchApp&&this._source.toBase64)this._source.toBase64(l$i,l$_,l$R);else{var l$r=this._source.toDataURL(l$i,l$_);l$R.call(this,l$r)}},l$h(0,l$_,"context",function(){return this._ctx}),l$h(0,l$_,"asBitmap",null,function(l$i){}),l$R.create=function(l$i,l$_){return new l$R(l$i,l$_)},l$R.TYPE2D="2D",l$R.TYPE3D="3D",l$R.TYPEAUTO="AUTO",l$R._createContext=null,l$R}(),l$ei=(function(l$i){function l$x(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){throw l$x.__super.call(this),new Error("不允许new！")}l$B(l$x,"laya.resource.HTMLSubImage",l$hi),l$x.create=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){return void 0===l$w&&(l$w=!1),new l$x(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w)}}(),function(l$i){function l$n(){this._frames=null,this._url=null,l$n.__super.call(this),this._setControlNode(this)}l$B(l$n,"laya.display.Animation",l$i);var l$_=l$n.prototype;l$_.destroy=function(l$i){void 0===l$i&&(l$i=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,l$i),this._frames=null,this._labels=null},l$_.play=function(l$i,l$_,l$R,l$r){void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=!0),void 0===l$R&&(l$R=""),void 0===l$r&&(l$r=!0),l$R&&this._setFramesFromCache(l$R,l$r),this._isPlaying=!0,this.index="string"==typeof l$i?this._getFrameByLabel(l$i):l$i,this.loop=l$_,this._actionName=l$R,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},l$_._setFramesFromCache=function(l$i,l$_){var l$R;return void 0===l$_&&(l$_=!1),this._url&&(l$i=this._url+"#"+l$i),l$i&&l$n.framesMap[l$i]?((l$R=l$n.framesMap[l$i])instanceof Array?(this._frames=l$n.framesMap[l$i],this._count=this._frames.length):(l$R.nodeRoot&&(l$n.framesMap[l$i]=this._parseGraphicAnimationByData(l$R),l$R=l$n.framesMap[l$i]),this._frames=l$R.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=l$R.interval),this._labels=this._copyLabels(l$R.labels)),!0):(l$_&&console.log("ani not found:",l$i),!1)},l$_._copyLabels=function(l$i){if(!l$i)return null;var l$_,l$R;for(l$R in l$_={},l$i)l$_[l$R]=l$Q.copyArray([],l$i[l$R]);return l$_},l$_._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&l$i.prototype._frameLoop.call(this)},l$_._displayToIndex=function(l$i){this._frames&&(this.graphics=this._frames[l$i])},l$_.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},l$_.loadImages=function(l$i,l$_){return void 0===l$_&&(l$_=""),this._url="",this._setFramesFromCache(l$_)||(this.frames=l$n.framesMap[l$_]?l$n.framesMap[l$_]:l$n.createFrames(l$i,l$_)),this},l$_.loadAtlas=function(l$_,l$R,l$r){void 0===l$r&&(l$r=""),this._url="";var l$b=this;function l$i(l$i){l$_===l$i&&(l$b.frames=l$n.framesMap[l$r]?l$n.framesMap[l$r]:l$n.createFrames(l$_,l$r),l$R&&l$R.run())}return l$b._setFramesFromCache(l$r)||(l$wi.getAtlas(l$_)?l$i(l$_):l$A.loader.load(l$_,l$t.create(null,l$i,[l$_]),null,"atlas")),this},l$_.loadAnimation=function(l$i,l$_,l$R){this._url=l$i;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,l$_&&l$_.run()):!l$R||l$wi.getAtlas(l$R)?this._loadAnimationData(l$i,l$_,l$R):l$A.loader.load(l$R,l$t.create(this,this._loadAnimationData,[l$i,l$_,l$R]),null,"atlas"),this},l$_._loadAnimationData=function(l$w,l$x,l$i){var l$P=this;if(!l$i||l$wi.getAtlas(l$i)){var l$B=this;l$wi.getRes(l$w)?l$_(l$w):l$A.loader.load(l$w,l$t.create(null,l$_,[l$w]),null,"json"),l$wi.clearRes(l$w)}else console.warn("atlas load fail:"+l$i);function l$_(l$i){if(l$wi.getRes(l$i)&&l$w===l$i){var l$_;if(l$n.framesMap[l$w+"#"])l$B._setFramesFromCache(l$P._actionName,!0),l$P.index=0,l$P._checkResumePlaying();else{var l$R=l$B._parseGraphicAnimation(l$wi.getRes(l$w));if(!l$R)return;var l$r,l$b=l$R.animationList,l$z=0,l$L=l$b.length;for(l$z=0;l$z<l$L;l$z++)l$_=l$b[l$z],l$n.framesMap[l$w+"#"+l$_.name]=l$_,l$r||(l$r=l$_);l$r&&(l$n.framesMap[l$w+"#"]=l$r,l$B._setFramesFromCache(l$P._actionName,!0),l$P.index=0),l$P._checkResumePlaying()}l$x&&l$x.run()}}},l$_._parseGraphicAnimation=function(l$i){return l$Ai.parseAnimationData(l$i)},l$_._parseGraphicAnimationByData=function(l$i){return l$Ai.parseAnimationByData(l$i)},l$h(0,l$_,"frames",function(){return this._frames},function(l$i){(this._frames=l$i)&&(this._count=l$i.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),l$h(0,l$_,"autoPlay",null,function(l$i){l$i?this.play():this.stop()}),l$h(0,l$_,"source",null,function(l$i){-1<l$i.indexOf(".ani")?this.loadAnimation(l$i):-1<l$i.indexOf(".json")||-1<l$i.indexOf("als")||-1<l$i.indexOf("atlas")?this.loadAtlas(l$i):this.loadImages(l$i.split(","))}),l$h(0,l$_,"autoAnimation",null,function(l$i){this.play(0,!0,l$i,!1)}),l$n.createFrames=function(l$i,l$_){var l$R,l$r,l$b=0,l$z=0;if("string"==typeof l$i){var l$L=l$wi.getAtlas(l$i);if(l$L&&l$L.length)for(l$R=[],l$b=0,l$z=l$L.length;l$b<l$z;l$b++)(l$r=new l$$.createGraphics).drawTexture(l$wi.getRes(l$L[l$b]),0,0),l$R.push(l$r)}else if(l$i instanceof Array)for(l$R=[],l$b=0,l$z=l$i.length;l$b<l$z;l$b++)(l$r=new l$$.createGraphics).loadImage(l$i[l$b],0,0),l$R.push(l$r);return l$_&&(l$n.framesMap[l$_]=l$R),l$R},l$n.clearCache=function(l$i){var l$_,l$R=l$n.framesMap,l$r=l$i+"#";for(l$_ in l$R)l$_!==l$i&&0!=l$_.indexOf(l$r)||delete l$n.framesMap[l$_]},l$n.framesMap={}}(l$Mi),function(l$i){function l$z(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,l$z.__super.call(this),null==l$z._sortIndexFun&&(l$z._sortIndexFun=l$l.sortByKey("index",!1,!0))}l$B(l$z,"laya.display.FrameAnimation",l$i);var l$_=l$z.prototype;return l$_._setUp=function(l$i,l$_){this._labels=null,this._animationNewFrames=null,this._targetDic=l$i,this._animationData=l$_,this.interval=1e3/l$_.frameRate,l$_.parsed?(this._count=l$_.count,this._labels=l$_.labels,this._animationNewFrames=l$_.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),l$_.parsed=!0,l$_.labels=this._labels,l$_.count=this._count,l$_.animationNewFrames=this._animationNewFrames},l$_.clear=function(){l$i.prototype.clear.call(this),this._targetDic=null,this._animationData=null},l$_._displayToIndex=function(l$i){if(this._animationData){l$i<0&&(l$i=0),l$i>this._count&&(l$i=this._count);var l$_=this._animationData.nodes,l$R=0,l$r=l$_.length;for(l$R=0;l$R<l$r;l$R++)this._displayNodeToFrame(l$_[l$R],l$i)}},l$_._displayNodeToFrame=function(l$i,l$_,l$R){l$R||(l$R=this._targetDic);var l$r=l$R[l$i.target];if(l$r){var l$b,l$z,l$L,l$w=l$i.frames,l$x=l$i.keys,l$P=0,l$B=l$x.length;for(l$P=0;l$P<l$B;l$P++)l$L=(l$z=l$w[l$b=l$x[l$P]]).length>l$_?l$z[l$_]:l$z[l$z.length-1],l$r[l$b]=l$L}},l$_._calculateDatas=function(){if(this._animationData){var l$i,l$_=this._animationData.nodes,l$R=0,l$r=l$_.length;for(l$R=this._count=0;l$R<l$r;l$R++)l$i=l$_[l$R],this._calculateNodeKeyFrames(l$i);this._count+=1}},l$_._calculateNodeKeyFrames=function(l$i){var l$_,l$R,l$r=l$i.keyframes,l$b=l$i.target;for(l$_ in l$i.frames||(l$i.frames={}),l$i.keys?l$i.keys.length=0:l$i.keys=[],l$i.initValues||(l$i.initValues={}),l$r)l$R=l$r[l$_],l$i.frames[l$_]||(l$i.frames[l$_]=[]),this._targetDic&&this._targetDic[l$b]&&(l$i.initValues[l$_]=this._targetDic[l$b][l$_]),l$R.sort(l$z._sortIndexFun),l$i.keys.push(l$_),this._calculateNodePropFrames(l$R,l$i.frames[l$_],l$_,l$b)},l$_.resetToInitState=function(){if(this._targetDic&&this._animationData){var l$i,l$_,l$R=this._animationData.nodes,l$r=0,l$b=l$R.length;for(l$r=0;l$r<l$b;l$r++)if(l$_=(l$i=l$R[l$r]).initValues){var l$z,l$L=this._targetDic[l$i.target];if(l$L)for(l$z in l$_)l$L[l$z]=l$_[l$z]}}},l$_._calculateNodePropFrames=function(l$i,l$_,l$R,l$r){var l$b=0,l$z=l$i.length-1;if(0<l$z){for(l$_.length=l$i[l$z].index+1,l$b=0;l$b<l$z;l$b++)this._dealKeyFrame(l$i[l$b]),this._calculateFrameValues(l$i[l$b],l$i[l$b+1],l$_);this._dealKeyFrame(l$i[l$b])}0==l$z&&(l$_[l$i[0].index]=l$i[0].value,this._animationNewFrames&&(this._animationNewFrames[l$i[0].index]=!0))},l$_._dealKeyFrame=function(l$i){l$i.label&&""!=l$i.label&&this.addLabel(l$i.label,l$i.index)},l$_._calculateFrameValues=function(l$i,l$_,l$R){var l$r,l$b=0,l$z=l$i.index,l$L=l$_.index,l$w=l$i.value,l$x=l$_.value-l$i.value,l$P=l$L-l$z;if(l$L>this._count&&(this._count=l$L),l$i.tween)for(null==(l$r=l$g[l$i.tweenMethod])&&(l$r=l$g.linearNone),l$b=l$z;l$b<l$L;l$b++)l$R[l$b]=l$r(l$b-l$z,l$w,l$x,l$P),this._animationNewFrames&&(this._animationNewFrames[l$b]=!0);else for(l$b=l$z;l$b<l$L;l$b++)l$R[l$b]=l$w;this._animationNewFrames&&(this._animationNewFrames[l$i.index]=!0,this._animationNewFrames[l$_.index]=!0),l$R[l$_.index]=l$_.value},l$z._sortIndexFun=null,l$z}(l$Mi)),l$ci=function(l$_){function l$b(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",l$b.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=l$Ni.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}l$B(l$b,"laya.display.Input",l$_);var l$i=l$b.prototype;return l$i.setSelection=function(l$i,l$_){this.focus=!0,laya.display.Input.inputElement.selectionStart=l$i,laya.display.Input.inputElement.selectionEnd=l$_},l$i._onUnDisplay=function(l$i){this.focus=!1},l$i._onMouseDown=function(l$i){this.focus=!0},l$i._syncInputTransform=function(){var l$i=this.nativeInput,l$_=l$Q.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),l$R=this._width-this.padding[1]-this.padding[3],l$r=this._height-this.padding[0]-this.padding[2];l$p.isConchApp?(l$i.setScale(l$_.scaleX,l$_.scaleY),l$i.setSize(l$R,l$r),l$i.setPos(l$_.x,l$_.y)):(l$b.inputContainer.style.transform=l$b.inputContainer.style.webkitTransform="scale("+l$_.scaleX+","+l$_.scaleY+") rotate("+l$A.stage.canvasDegree+"deg)",l$i.style.width=l$R+"px",l$i.style.height=l$r+"px",l$b.inputContainer.style.left=l$_.x+"px",l$b.inputContainer.style.top=l$_.y+"px")},l$i.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},l$i._setInputMethod=function(){l$b.input.parentElement&&l$b.inputContainer.removeChild(l$b.input),l$b.area.parentElement&&l$b.inputContainer.removeChild(l$b.area),l$b.inputElement=this._multiline?l$b.area:l$b.input,l$b.inputContainer.appendChild(l$b.inputElement),l$Ni.RightToLeft&&(l$b.inputElement.style.direction="rtl")},l$i._focusIn=function(){laya.display.Input.isInputting=!0;var l$i=this.nativeInput;this._focus=!0;var l$_=l$i.style;l$_.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),l$i.readOnly=!this._editable,l$p.isConchApp&&(l$i.setType(this._type),l$i.setForbidEdit(!this._editable)),l$i.maxLength=this._maxChars;this.padding;if(l$i.type=this._type,l$i.value=this._content,l$i.placeholder=this._prompt,l$A.stage.off("keydown",this,this._onKeyDown),l$A.stage.on("keydown",this,this._onKeyDown),(l$A.stage.focus=this).event("focus"),l$s.onPC&&l$i.focus(),!l$s.onMiniGame){this._text;this._text=null}this.typeset(),l$i.setColor(this._originColor),l$i.setFontSize(this.fontSize),l$i.setFontFace(l$s.onIPhone&&l$Ni._fontFamilyMap[this.font]||this.font),l$p.isConchApp&&l$i.setMultiAble&&l$i.setMultiAble(this._multiline),l$_.lineHeight=this.leading+this.fontSize+"px",l$_.fontStyle=this.italic?"italic":"normal",l$_.fontWeight=this.bold?"bold":"normal",l$_.textAlign=this.align,l$_.padding="0 0",this._syncInputTransform(),!l$p.isConchApp&&l$s.onPC&&l$A.timer.frameLoop(1,this,this._syncInputTransform)},l$i._setPromptColor=function(){(l$b.promptStyleDOM=l$s.getElementById("promptStyle"))||((l$b.promptStyleDOM=l$s.createElement("style")).setAttribute("id","promptStyle"),l$s.document.head.appendChild(l$b.promptStyleDOM)),l$b.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},l$i._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(l$A.superSet(l$Ni,this,"text",this._content),l$A.superSet(l$Ni,this,"color",this._originColor)):(l$A.superSet(l$Ni,this,"text",this._prompt),l$A.superSet(l$Ni,this,"color",this._promptColor)),l$A.stage.off("keydown",this,this._onKeyDown),l$A.stage.focus=null,this.event("blur"),l$p.isConchApp&&this.nativeInput.blur(),l$s.onPC&&l$A.timer.clear(this,this._syncInputTransform)},l$i._onKeyDown=function(l$i){13===l$i.keyCode&&(l$s.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},l$i.changeText=function(l$i){this._content=l$i,this._focus?(this.nativeInput.value=l$i||"",this.event("change")):l$_.prototype.changeText.call(this,l$i)},l$h(0,l$i,"color",l$_.prototype._$get_color,function(l$i){this._focus&&this.nativeInput.setColor(l$i),l$A.superSet(l$Ni,this,"color",this._content?l$i:this._promptColor),this._originColor=l$i}),l$h(0,l$i,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(l$i){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),l$h(0,l$i,"multiline",function(){return this._multiline},function(l$i){this._multiline=l$i,this.valign=l$i?"top":"middle"}),l$h(0,l$i,"maxChars",function(){return this._maxChars},function(l$i){l$i<=0&&(l$i=1e5),this._maxChars=l$i}),l$h(0,l$i,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(l$i){l$A.superSet(l$Ni,this,"color",this._originColor),l$i+="",this._focus?(this.nativeInput.value=l$i||"",this.event("change")):(this._multiline||(l$i=l$i.replace(/\r?\n/g,"")),(this._content=l$i)?l$A.superSet(l$Ni,this,"text",l$i):(l$A.superSet(l$Ni,this,"text",this._prompt),l$A.superSet(l$Ni,this,"color",this.promptColor)))}),l$h(0,l$i,"nativeInput",function(){return this._multiline?l$b.area:l$b.input}),l$h(0,l$i,"prompt",function(){return this._prompt},function(l$i){!this._text&&l$i&&l$A.superSet(l$Ni,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?l$A.superSet(l$Ni,this,"text",this._text==this._prompt?l$i:this._text):l$A.superSet(l$Ni,this,"text",l$i),this._prompt=l$Ni.langPacks&&l$Ni.langPacks[l$i]?l$Ni.langPacks[l$i]:l$i}),l$h(0,l$i,"focus",function(){return this._focus},function(l$i){var l$_=this.nativeInput;this._focus!==l$i&&(l$i?(l$_.target?l$_.target._focusOut():this._setInputMethod(),(l$_.target=this)._focusIn()):(l$_.target=null,this._focusOut(),l$s.document.body.scrollTop=0,l$_.blur(),l$p.isConchApp?l$_.setPos(-1e4,-1e4):l$b.inputContainer.contains(l$_)&&l$b.inputContainer.removeChild(l$_)))}),l$h(0,l$i,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(l$i){l$i?(-1<(l$i="[^"+l$i+"]").indexOf("^^")&&(l$i=l$i.replace("^^","")),this._restrictPattern=new RegExp(l$i,"g")):this._restrictPattern=null}),l$h(0,l$i,"editable",function(){return this._editable},function(l$i){this._editable=l$i,l$p.isConchApp&&l$b.input.setForbidEdit(!l$i)}),l$h(0,l$i,"promptColor",function(){return this._promptColor},function(l$i){this._promptColor=l$i,this._content||l$A.superSet(l$Ni,this,"color",l$i)}),l$h(0,l$i,"type",function(){return this._type},function(l$i){this._getCSSStyle().password="password"==l$i,this._type=l$i,l$p.isConchApp&&this.nativeInput.setType(l$i)}),l$h(0,l$i,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(l$i){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),l$h(0,l$i,"asPassword",function(){return this._getCSSStyle().password},function(l$i){this._getCSSStyle().password=l$i,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),l$b.__init__=function(){l$b._createInputElement(),l$s.onMobile&&l$p.canvas.addEventListener(l$b.IOS_IFRAME?l$s.onMiniGame?"touchend":"click":"touchend",l$b._popupInputMethod)},l$b._popupInputMethod=function(l$i){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},l$b._createInputElement=function(){l$b._initInput(l$b.area=l$s.createElement("textarea")),l$b._initInput(l$b.input=l$s.createElement("input")),(l$b.inputContainer=l$s.createElement("div")).style.position="absolute",l$b.inputContainer.style.zIndex=1e5,l$s.container.appendChild(l$b.inputContainer),l$b.inputContainer.setPos=function(l$i,l$_){l$b.inputContainer.style.left=l$i+"px",l$b.inputContainer.style.top=l$_+"px"}},l$b._initInput=function(l$_){var l$i=l$_.style;l$i.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",l$i.resize="none",l$i.backgroundColor="transparent",l$i.border="none",l$i.outline="none",l$i.zIndex=1,l$_.addEventListener("input",l$b._processInputting),l$_.addEventListener("mousemove",l$b._stopEvent),l$_.addEventListener("mousedown",l$b._stopEvent),l$_.addEventListener("touchmove",l$b._stopEvent),l$_.setFontFace=function(l$i){l$_.style.fontFamily=l$i},l$p.isConchApp||(l$_.setColor=function(l$i){l$_.style.color=l$i},l$_.setFontSize=function(l$i){l$_.style.fontSize=l$i+"px"})},l$b._processInputting=function(l$i){var l$_=laya.display.Input.inputElement.target;if(l$_){var l$R=laya.display.Input.inputElement.value;l$_._restrictPattern&&(l$R=l$R.replace(/\u2006|\x27/g,""),l$_._restrictPattern.test(l$R)&&(l$R=l$R.replace(l$_._restrictPattern,""),laya.display.Input.inputElement.value=l$R)),l$_._text=l$R,l$_.event("input")}},l$b._stopEvent=function(l$i){"touchmove"==l$i.type&&l$i.preventDefault(),l$i.stopPropagation&&l$i.stopPropagation()},l$b.TYPE_TEXT="text",l$b.TYPE_PASSWORD="password",l$b.TYPE_EMAIL="email",l$b.TYPE_URL="url",l$b.TYPE_NUMBER="number",l$b.TYPE_RANGE="range",l$b.TYPE_DATE="date",l$b.TYPE_MONTH="month",l$b.TYPE_WEEK="week",l$b.TYPE_TIME="time",l$b.TYPE_DATE_TIME="datetime",l$b.TYPE_DATE_TIME_LOCAL="datetime-local",l$b.TYPE_SEARCH="search",l$b.input=null,l$b.area=null,l$b.inputElement=null,l$b.inputContainer=null,l$b.confirmButton=null,l$b.promptStyleDOM=null,l$b.inputHeight=45,l$b.isInputting=!1,l$b.stageMatrix=null,l$x(l$b,["IOS_IFRAME",function(){return this.IOS_IFRAME=l$s.onIOS&&l$s.window.top!=l$s.window.self}]),l$b}(l$Ni),l$li=function(l$i){function l$R(l$i,l$_){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,l$R.__super.call(this),l$i&&this._init_(l$i,l$_)}l$B(l$R,"laya.resource.HTMLImage",l$ti);var l$_=l$R.prototype;return l$_._init_=function(l$i,l$_){this._src=l$i,this._source=new l$s.window.Image,l$_&&(l$_.onload&&(this.onload=l$_.onload),l$_.onerror&&(this.onerror=l$_.onerror),l$_.onCreate&&l$_.onCreate(this)),0!=l$i.indexOf("data:image")&&(this._source.crossOrigin=""),l$i&&(this._source.src=l$i)},l$_.recreateResource=function(){var l$i=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var l$_=this;this._source=new l$s.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(l$_._needReleaseAgain)return l$_._needReleaseAgain=!1,l$_._source.onload=null,void(l$_._source=null);l$_._source.onload=null,l$_.memorySize=l$i._w*l$i._h*4,l$_._recreateLock=!1,l$_.completeCreate()},this._source.src=this._src}},l$_.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},l$_.onresize=function(){this._w=this._source.width,this._h=this._source.height},l$h(0,l$_,"onload",null,function(l$i){var l$_=this;this._onload=l$i,this._source&&(this._source.onload=null!=this._onload?function(){l$_.onresize(),l$_._onload()}:null)}),l$h(0,l$_,"onerror",null,function(l$i){var l$_=this;this._onerror=l$i,this._source&&(this._source.onerror=null!=this._onerror?function(){l$_._onerror()}:null)}),l$h(0,l$_,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(l$i){this._enableMerageInAtlas=l$i,l$p.isConchApp&&this._source&&(this._source.enableMerageInAtlas=l$i)}),l$R.create=function(l$i,l$_){return new l$R(l$i,l$_)},l$R}(),l$Ai=(function(l$z){function l$i(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,l$i.__super.call(this)}l$B(l$i,"laya.display.EffectAnimation",l$z);var l$_=l$i.prototype;l$_._onOtherBegin=function(l$i){l$i!=this&&this.stop()},l$_.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},l$_._onPlayAction=function(){this.play(0,!1)},l$_.play=function(l$i,l$_,l$R,l$r){void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=!0),void 0===l$R&&(l$R=""),void 0===l$r&&(l$r=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,l$i,l$_,l$R,l$r))},l$_._recordInitData=function(){if(this._aniKeys){var l$i,l$_,l$R=0;for(l$i=this._aniKeys.length,l$R=0;l$R<l$i;l$R++)l$_=this._aniKeys[l$R],this._initData[l$_]=this._target[l$_]}},l$_._displayToIndex=function(l$i){if(this._animationData){l$i<0&&(l$i=0),l$i>this._count&&(l$i=this._count);var l$_=this._animationData.nodes,l$R=0,l$r=l$_.length;for(l$r=1<l$r?1:l$r,l$R=0;l$R<l$r;l$R++)this._displayNodeToFrame(l$_[l$R],l$i)}},l$_._displayNodeToFrame=function(l$i,l$_,l$R){if(this._target){var l$r;l$r=this._target;var l$b,l$z,l$L,l$w,l$x=l$i.frames,l$P=l$i.keys,l$B=0,l$n=l$P.length;l$w=l$i.secondFrames;var l$f,l$J,l$h,l$M,l$N=0;for(l$B=0;l$B<l$n;l$B++)l$z=l$x[l$b=l$P[l$B]],l$L=-1==(l$N=l$w[l$b])?this._initData[l$b]:l$_<l$N?(l$h=(l$J=l$i.keyframes[l$b])[0]).tween?(null==(l$f=l$g[l$h.tweenMethod])&&(l$f=l$g.linearNone),l$M=l$J[1],l$f(l$_,this._initData[l$b],l$M.value-this._initData[l$b],l$M.index)):this._initData[l$b]:l$z.length>l$_?l$z[l$_]:l$z[l$z.length-1],l$r[l$b]=l$L}},l$_._calculateNodeKeyFrames=function(l$i){l$z.prototype._calculateNodeKeyFrames.call(this,l$i);var l$_,l$R,l$r,l$b=l$i.keyframes;l$i.target;for(l$_ in l$r={},l$i.secondFrames=l$r,l$b)(l$R=l$b[l$_]).length<=1?l$r[l$_]=-1:l$r[l$_]=l$R[1].index},l$h(0,l$_,"target",function(){return this._target},function(l$i){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=l$i,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),l$h(0,l$_,"playEvent",null,function(l$i){(this._playEvents=l$i)&&this.addEvent()}),l$h(0,l$_,"effectData",null,function(l$i){var l$_;l$i&&((l$_=l$i.animations)&&l$_[0]&&(this._setUp({},l$_[0]),l$_[0].nodes&&l$_[0].nodes[0]&&(this._aniKeys=l$_[0].nodes[0].keys)))}),l$h(0,l$_,"effectClass",null,function(l$i){var l$_,l$R;(this._effectClass=l$m.getClass(l$i),this._effectClass)&&((l$_=this._effectClass.uiView)&&(l$R=l$_.animations)&&l$R[0]&&(this._setUp({},l$R[0]),l$R[0].nodes&&l$R[0].nodes[0]&&(this._aniKeys=l$R[0].nodes[0].keys)))}),l$i.EffectAnimationBegin="effectanimationbegin"}(l$ei),function(l$_){var l$S;function l$v(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,l$v.__super.call(this)}l$B(l$v,"laya.utils.GraphicAnimation",l$_);var l$i=l$v.prototype;return l$i._parseNodeList=function(l$i){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[l$i.compId]=l$i.props,l$i.compId&&this._nodeList.push(l$i.compId);var l$_=l$i.child;if(l$_){var l$R=0,l$r=l$_.length;for(l$R=0;l$R<l$r;l$R++)this._parseNodeList(l$_[l$R])}},l$i._calGraphicData=function(l$i){var l$_;if(this._setUp(null,l$i),this._createGraphicData(),this._nodeIDAniDic)for(l$_ in this._nodeIDAniDic)this._nodeIDAniDic[l$_]=null},l$i._createGraphicData=function(){var l$i,l$_=[],l$R=0,l$r=this.count,l$b=this._animationNewFrames;for(l$b||(l$b=[]),l$R=0;l$R<l$r;l$R++)!l$b[l$R]&&l$i||(l$i=this._createFrameGraphic(l$R)),l$_.push(l$i);this._gList=l$_},l$i._createFrameGraphic=function(l$i){var l$_=l$$.createGraphics();return l$v._rootMatrix||(l$v._rootMatrix=new l$G),this._updateNodeGraphic(this._rootNode,l$i,l$v._rootMatrix,l$_),l$_},l$i._updateNodeGraphic=function(l$i,l$_,l$R,l$r,l$b){var l$z;void 0===l$b&&(l$b=1);var l$L,l$w,l$x,l$P=(l$z=this._nodeGDic[l$i.compId]=this._getNodeGraphicData(l$i.compId,l$_,this._nodeGDic[l$i.compId])).alpha*l$b;if(!(l$P<.01)&&(l$z.resultTransform||(l$z.resultTransform=l$G.create()),l$L=l$z.resultTransform,l$G.mul(l$z.transform,l$R,l$L),l$z.skin&&(l$w=this._getTextureByUrl(l$z.skin))&&(l$L._checkTransform()?(l$r.drawTexture(l$w,0,0,l$z.width,l$z.height,l$L,l$P),l$z.resultTransform=null):l$r.drawTexture(l$w,l$L.tx,l$L.ty,l$z.width,l$z.height,null,l$P)),l$x=l$i.child)){var l$B,l$n=0;for(l$B=l$x.length,l$n=0;l$n<l$B;l$n++)this._updateNodeGraphic(l$x[l$n],l$_,l$L,l$r,l$P)}},l$i._updateNoChilds=function(l$i,l$_){if(l$i.skin){var l$R=this._getTextureByUrl(l$i.skin);if(l$R){var l$r=l$i.transform;l$r._checkTransform();!l$r.bTransform?l$_.drawTexture(l$R,l$r.tx,l$r.ty,l$i.width,l$i.height,null,l$i.alpha):l$_.drawTexture(l$R,0,0,l$i.width,l$i.height,l$r.clone(),l$i.alpha)}}},l$i._updateNodeGraphic2=function(l$i,l$_,l$R){var l$r;if(l$r=this._nodeGDic[l$i.compId]=this._getNodeGraphicData(l$i.compId,l$_,this._nodeGDic[l$i.compId]),l$i.child){var l$b=l$r.transform;l$b._checkTransform();var l$z,l$L;l$L=(l$z=!l$b.bTransform)&&(0!=l$b.tx||0!=l$b.ty);var l$w,l$x,l$P;if((l$w=l$b.bTransform||1!=l$r.alpha)&&l$R.save(),1!=l$r.alpha&&l$R.alpha(l$r.alpha),l$z?l$L&&l$R.translate(l$b.tx,l$b.ty):l$R.transform(l$b.clone()),l$x=l$i.child,l$r.skin&&(l$P=this._getTextureByUrl(l$r.skin))&&l$R.drawTexture(l$P,0,0,l$r.width,l$r.height),l$x){var l$B,l$n=0;for(l$B=l$x.length,l$n=0;l$n<l$B;l$n++)this._updateNodeGraphic2(l$x[l$n],l$_,l$R)}l$w?l$R.restore():l$z?l$L&&l$R.translate(-l$b.tx,-l$b.ty):l$R.transform(l$b.clone().invert())}else this._updateNoChilds(l$r,l$R)},l$i._calculateNodeKeyFrames=function(l$i){l$_.prototype._calculateNodeKeyFrames.call(this,l$i),this._nodeIDAniDic[l$i.target]=l$i},l$i.getNodeDataByID=function(l$i){return this._nodeIDAniDic[l$i]},l$i._getParams=function(l$i,l$_,l$R,l$r){var l$b=l$v._temParam;l$b.length=l$_.length;var l$z=0,l$L=l$_.length;for(l$z=0;l$z<l$L;l$z++)l$b[l$z]=this._getObjVar(l$i,l$_[l$z][0],l$R,l$_[l$z][1],l$r);return l$b},l$i._getObjVar=function(l$i,l$_,l$R,l$r,l$b){if(l$i.hasOwnProperty(l$_)){var l$z=l$i[l$_];if(l$R>=l$z.length&&(l$R=l$z.length-1),null!=l$i[l$_][l$R])return l$i[l$_][l$R]}return l$b.hasOwnProperty(l$_)?l$b[l$_]:l$r},l$i._getNodeGraphicData=function(l$i,l$_,l$R){l$R||(l$R=l$S.create()),l$R.transform?l$R.transform.identity():l$R.transform=l$G.create();var l$r=this.getNodeDataByID(l$i);if(!l$r)return l$R;var l$b,l$z,l$L=l$r.frames,l$w=this._getParams(l$L,l$v._drawTextureCmd,l$_,this._nodeDefaultProps[l$i]),l$x=l$w[0],l$P=NaN,l$B=NaN,l$n=l$w[5],l$f=l$w[6],l$J=l$w[13],l$h=l$w[14],l$M=l$w[7],l$N=l$w[8],l$X=l$w[9],l$t=l$w[11],l$I=l$w[12];l$P=l$w[3],l$B=l$w[4],0!=l$P&&0!=l$B||(l$x=null),-1==l$P&&(l$P=0),-1==l$B&&(l$B=0),l$R.skin=l$x,l$R.width=l$P,l$R.height=l$B,l$x&&((l$b=this._getTextureByUrl(l$x))?(l$P||(l$P=l$b.sourceWidth),l$B||(l$B=l$b.sourceHeight)):console.warn("lost skin:",l$x,",you may load pics first")),l$R.alpha=l$w[10],l$z=l$R.transform,0!=l$J&&(l$n=l$J*l$P),0!=l$h&&(l$f=l$h*l$B),0==l$n&&0==l$f||l$z.translate(-l$n,-l$f);var l$e=null;if(l$X||1!==l$M||1!==l$N||l$t||l$I){(l$e=l$v._tempMt).identity(),l$e.bTransform=!0;var l$c=.0174532922222222*(l$X-l$t),l$l=.0174532922222222*(l$X+l$I),l$A=Math.cos(l$l),l$Z=Math.sin(l$l),l$q=Math.sin(l$c),l$j=Math.cos(l$c);l$e.a=l$M*l$A,l$e.b=l$M*l$Z,l$e.c=-l$N*l$q,l$e.d=l$N*l$j,l$e.tx=l$e.ty=0}return l$e&&(l$z=l$G.mul(l$z,l$e,l$z)),l$z.translate(l$w[1],l$w[2]),l$R},l$i._getTextureByUrl=function(l$i){return l$wi.getRes(l$i)},l$i.setAniData=function(l$i,l$_){if(l$i.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=l$i,this._parseNodeList(l$i);var l$R,l$r={},l$b=[],l$z=l$i.animations,l$L=0,l$w=l$z.length;for(l$L=0;l$L<l$w;l$L++)if(l$R=l$z[l$L],this._labels=null,(!l$_||l$_==l$R.name)&&l$R){try{this._calGraphicData(l$R)}catch(l$i){console.warn("parse animation fail:"+l$R.name+",empty animation created"),this._gList=[]}var l$x={};l$x.interval=1e3/l$R.frameRate,l$x.frames=this._gList,l$x.labels=this._labels,l$x.name=l$R.name,l$b.push(l$x),l$r[l$R.name]=l$x}this.animationList=l$b,this.animationDic=l$r}l$v._temParam.length=0},l$i.parseByData=function(l$i){var l$_,l$R;l$_=l$i.nodeRoot,l$R=l$i.aniO,delete l$i.nodeRoot,delete l$i.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=l$_,this._parseNodeList(l$_),this._labels=null;try{this._calGraphicData(l$R)}catch(l$i){console.warn("parse animation fail:"+l$R.name+",empty animation created"),this._gList=[]}var l$r=l$i;return l$r.interval=1e3/l$R.frameRate,l$r.frames=this._gList,l$r.labels=this._labels,l$r.name=l$R.name,l$r},l$i.setUpAniData=function(l$i){if(l$i.animations){var l$_,l$R={},l$r=[],l$b=l$i.animations,l$z=0,l$L=l$b.length;for(l$z=0;l$z<l$L;l$z++)if(l$_=l$b[l$z]){var l$w={};l$w.name=l$_.name,l$w.aniO=l$_,l$w.nodeRoot=l$i,l$r.push(l$w),l$R[l$_.name]=l$w}this.animationList=l$r,this.animationDic=l$R}},l$i._clear=function(){var l$i,l$_;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(l$i in this._nodeGDic)(l$_=this._nodeGDic[l$i])&&l$_.recover();this._nodeGDic=null},l$v.parseAnimationByData=function(l$i){var l$_;return l$v._I||(l$v._I=new l$v),l$_=l$v._I.parseByData(l$i),l$v._I._clear(),l$_},l$v.parseAnimationData=function(l$i){var l$_;return l$v._I||(l$v._I=new l$v),l$v._I.setUpAniData(l$i),(l$_={}).animationList=l$v._I.animationList,l$_.animationDic=l$v._I.animationDic,l$v._I._clear(),l$_},l$v._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],l$v._temParam=[],l$v._I=null,l$v._rootMatrix=null,l$x(l$v,["_tempMt",function(){return this._tempMt=new l$G}]),l$v.__init$=function(){l$S=function(){function l$i(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return l$B(l$i,""),l$i.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),l$y.recover("GraphicNode",this)},l$i.create=function(){return l$y.getItemByClass("GraphicNode",l$i)},l$i}()},l$v}(l$ei));l$A.__init([l$P,l$xi,l$p,l$s,l$F,l$j,l$i,l$Ai])}(window,document,Laya),function(l$i,l$_,l$R){l$R.un,l$R.uns,l$R.static;var l$r=l$R.class;l$R.getset,l$R.__newvec;new(function(){function l$i(){}return l$r(l$i,"LayaMain"),l$i}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(l$i,l$_){"use strict";for(var l$R in Object.defineProperty(l$_,"__esModule",{value:!0}),Laya){var l$r=Laya[l$R];l$r&&l$r.__isclass&&(l$_[l$R]=l$r)}}),function(l$i,l$_,l$l){l$l.un,l$l.uns;var l$L=l$l.static,l$f=l$l.class,l$r=l$l.getset,l$z=l$l.__newvec,l$B=laya.maths.Arith,l$n=laya.maths.Bezier,l$R=laya.resource.Bitmap,l$J=laya.utils.Browser,l$x=laya.utils.Byte,l$h=laya.utils.Color,l$A=(laya.filters.ColorFilter,l$l.Config),l$b=laya.resource.Context,l$Z=(laya.events.Event,laya.filters.Filter),l$w=laya.display.Graphics,l$P=laya.resource.HTMLCanvas,l$M=(laya.utils.HTMLChar,laya.resource.HTMLImage),l$N=laya.resource.HTMLSubImage,l$q=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),l$j=laya.maths.Point,l$S=laya.maths.Rectangle,l$X=laya.renders.Render,l$t=(laya.renders.RenderContext,laya.renders.RenderSprite),l$I=laya.resource.Resource,l$e=laya.resource.ResourceManager,l$c=laya.utils.RunDriver,l$v=laya.display.Sprite,l$$=laya.display.Stage,l$G=laya.utils.Stat,l$u=laya.utils.StringKey,l$o=(laya.display.css.Style,laya.system.System),l$p=laya.display.Text,l$k=laya.resource.Texture,l$K=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),l$O=laya.utils.VectorGraphManager;laya.utils.WordText;l$l.interface("laya.webgl.shapes.IShape"),l$l.interface("laya.webgl.submit.ISubmit"),l$l.interface("laya.webgl.text.ICharSegment"),l$l.interface("laya.webgl.canvas.save.ISaveData"),l$l.interface("laya.webgl.resource.IMergeAtlasBitmap"),l$l.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var l$E=function(){function l$i(){}l$f(l$i,"laya.filters.webgl.FilterActionGL");var l$_=l$i.prototype;return l$l.imps(l$_,{"laya.filters.IFilterActionGL":!0}),l$_.setValue=function(l$i){},l$_.setValueMix=function(l$i){},l$_.apply3d=function(l$i,l$_,l$R,l$r,l$b){return null},l$_.apply=function(l$i){return null},l$r(0,l$_,"typeMix",function(){return 0}),l$i}(),l$s=function(){function l$i(){}return l$f(l$i,"laya.webgl.shader.ShaderValue"),l$i}(),l$Y=function(){var l$r,l$b;function l$i(l$i,l$_,l$R){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new l$b,void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),this._cells=null,this._rowInfo=null,this._init(l$i,l$_),this._atlasID=l$R}l$f(l$i,"laya.webgl.atlas.AtlasGrid");var l$_=l$i.prototype;return l$_.getAltasID=function(){return this._atlasID},l$_.setAltasID=function(l$i){0<=l$i&&(this._atlasID=l$i)},l$_.addTex=function(l$i,l$_,l$R){var l$r=this._get(l$_,l$R);return 0==l$r.ret||(this._fill(l$r.x,l$r.y,l$_,l$R,l$i),this._texCount++),l$r},l$_._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},l$_._init=function(l$i,l$_){if(this._width=l$i,this._height=l$_,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=l$z(this._height);for(var l$R=0;l$R<this._height;l$R++)this._rowInfo[l$R]=new l$r;return this._clear(),!0},l$_._get=function(l$i,l$_){var l$R=new l$m;if(l$i>=this._failSize.width&&l$_>=this._failSize.height)return l$R;for(var l$r=-1,l$b=-1,l$z=this._width,l$L=this._height,l$w=this._cells,l$x=0;l$x<l$L;l$x++)if(!(this._rowInfo[l$x].spaceCount<l$i))for(var l$P=0;l$P<l$z;){var l$B=3*(l$x*l$z+l$P);if(0!=l$w[l$B]||l$w[1+l$B]<l$i||l$w[2+l$B]<l$_)l$P+=l$w[1+l$B];else{l$r=l$P,l$b=l$x;for(var l$n=0;l$n<l$i;l$n++)if(l$w[3*l$n+l$B+2]<l$_){l$r=-1;break}if(!(l$r<0))return l$R.ret=!0,l$R.x=l$r,l$R.y=l$b,l$R;l$P+=l$w[1+l$B]}}return l$R},l$_._fill=function(l$i,l$_,l$R,l$r,l$b){var l$z=this._width,l$L=this._height;this._check(l$i+l$R<=l$z&&l$_+l$r<=l$L);for(var l$w=l$_;l$w<l$r+l$_;++l$w){this._check(this._rowInfo[l$w].spaceCount>=l$R),this._rowInfo[l$w].spaceCount-=l$R;for(var l$x=0;l$x<l$R;l$x++){var l$P=3*(l$i+l$w*l$z+l$x);this._check(0==this._cells[l$P]),this._cells[l$P]=l$b,this._cells[1+l$P]=l$R,this._cells[2+l$P]=l$r}}if(0<l$i)for(l$w=0;l$w<l$r;++l$w){var l$B=0;for(l$x=l$i-1;0<=l$x&&0==this._cells[3*((l$_+l$w)*l$z+l$x)];--l$x,++l$B);for(l$x=l$B;0<l$x;--l$x)this._cells[3*((l$_+l$w)*l$z+l$i-l$x)+1]=l$x,this._check(0<l$x)}if(0<l$_)for(l$x=l$i;l$x<l$i+l$R;++l$x){for(l$B=0,l$w=l$_-1;0<=l$w&&0==this._cells[3*(l$x+l$w*l$z)];--l$w,l$B++);for(l$w=l$B;0<l$w;--l$w)this._cells[3*(l$x+(l$_-l$w)*l$z)+2]=l$w,this._check(0<l$w)}},l$_._check=function(l$i){0==l$i&&console.log("xtexMerger 错误啦")},l$_._clear=function(){for(var l$i=this._texCount=0;l$i<this._height;l$i++)this._rowInfo[l$i].spaceCount=this._width;for(var l$_=0;l$_<this._height;l$_++)for(var l$R=0;l$R<this._width;l$R++){var l$r=3*(l$_*this._width+l$R);this._cells[l$r]=0,this._cells[1+l$r]=this._width-l$R,this._cells[2+l$r]=this._width-l$_}this._failSize.width=this._width+1,this._failSize.height=this._height+1},l$i.__init$=function(){l$r=function(){function l$i(){this.spaceCount=0}return l$f(l$i,""),l$i}(),l$b=function(){function l$i(){this.width=0,this.height=0}return l$f(l$i,""),l$i}()},l$i}(),l$C=function(){function l$X(l$i,l$_,l$R,l$r){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=l$i,this._height=l$_,this._gridSize=l$R,this._maxAtlaserCount=l$r,this._gridNumX=l$i/l$R,this._gridNumY=l$_/l$R,this._curAtlasIndex=0,this._atlaserArray=[]}l$f(l$X,"laya.webgl.atlas.AtlasResourceManager");var l$i=l$X.prototype;return l$i.setAtlasParam=function(l$i,l$_,l$R,l$r){if(1==this._setAtlasParam)return l$X._sid_=0,this._width=l$i,this._height=l$_,this._gridSize=l$R,this._maxAtlaserCount=l$r,this._gridNumX=l$i/l$R,this._gridNumY=l$_/l$R,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},l$i.pushData=function(l$i){var l$_,l$R=l$i.bitmap,l$r=-1,l$b=null,l$z=0,l$L=0;for(l$z=0,l$_=this._atlaserArray.length;l$z<l$_&&(l$L=(this._curAtlasIndex+l$z)%l$_,-1==(l$r=(l$b=this._atlaserArray[l$L]).findBitmapIsExist(l$R)));l$z++);if(-1!=l$r){var l$w=l$b.InAtlasWebGLImagesOffsetValue[l$r];return l$h=l$w[0],l$M=l$w[1],l$b.addToAtlas(l$i,l$h,l$M),!0}this._setAtlasParam=!1;for(var l$x=Math.ceil((l$i.bitmap.width+2)/this._gridSize),l$P=Math.ceil((l$i.bitmap.height+2)/this._gridSize),l$B=!1,l$n=0;l$n<2;l$n++){var l$f=this._maxAtlaserCount;for(l$z=0;l$z<l$f;l$z++){l$L=(this._curAtlasIndex+l$z)%l$f,this._atlaserArray.length-1>=l$L||this._atlaserArray.push(new l$Si(this._gridNumX,this._gridNumY,this._width,this._height,l$X._sid_++));var l$J=this._atlaserArray[l$L],l$h=0,l$M=0,l$N=l$J.addTex(1,l$x,l$P);if(l$N.ret){l$h=l$N.x*this._gridSize+1,l$M=l$N.y*this._gridSize+1,l$R.lock=!0,l$J.addToAtlasTexture(l$R,l$h,l$M),l$J.addToAtlas(l$i,l$h,l$M),l$B=!0,this._curAtlasIndex=l$L;break}}if(l$B)break;this._atlaserArray.push(new l$Si(this._gridNumX,this._gridNumY,this._width,this._height,l$X._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return l$B||console.log(">>>AtlasManager pushData error"),l$B},l$i.addToAtlas=function(l$i){laya.webgl.atlas.AtlasResourceManager.instance.pushData(l$i)},l$i.garbageCollection=function(){if(!0===this._needGC){for(var l$i=this._atlaserArray.length-this._maxAtlaserCount,l$_=0;l$_<l$i;l$_++)this._atlaserArray[l$_].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+l$i),this._atlaserArray.splice(0,l$i),this._needGC=!1}return!0},l$i.freeAll=function(){for(var l$i=0,l$_=this._atlaserArray.length;l$i<l$_;l$i++)this._atlaserArray[l$i].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},l$i.getAtlaserCount=function(){return this._atlaserArray.length},l$i.getAtlaserByIndex=function(l$i){return this._atlaserArray[l$i]},l$r(1,l$X,"instance",function(){return l$X._Instance||(l$X._Instance=new l$X(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),l$X._Instance}),l$r(1,l$X,"enabled",function(){return l$A.atlasEnable}),l$r(1,l$X,"atlasLimitWidth",function(){return l$X._atlasLimitWidth},function(l$i){l$X._atlasLimitWidth=l$i}),l$r(1,l$X,"atlasLimitHeight",function(){return l$X._atlasLimitHeight},function(l$i){l$X._atlasLimitHeight=l$i}),l$X._enable=function(){l$A.atlasEnable=!0},l$X._disable=function(){l$A.atlasEnable=!1},l$X.__init__=function(){l$X.atlasTextureWidth=2048,l$X.atlasTextureHeight=2048,l$X.maxTextureCount=6,l$X.atlasLimitWidth=512,l$X.atlasLimitHeight=512},l$X._atlasLimitWidth=0,l$X._atlasLimitHeight=0,l$X.gridSize=16,l$X.atlasTextureWidth=0,l$X.atlasTextureHeight=0,l$X.maxTextureCount=0,l$X._atlasRestore=0,l$X.BOARDER_TYPE_NO=0,l$X.BOARDER_TYPE_RIGHT=1,l$X.BOARDER_TYPE_LEFT=2,l$X.BOARDER_TYPE_BOTTOM=4,l$X.BOARDER_TYPE_TOP=8,l$X.BOARDER_TYPE_ALL=15,l$X._sid_=0,l$X._Instance=null,l$X}(),l$m=function(){function l$i(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return l$f(l$i,"laya.webgl.atlas.MergeFillInfo"),l$i}(),l$D=function(){function l$_(){}return l$f(l$_,"laya.webgl.canvas.BlendMode"),l$_._init_=function(l$i){l$_.fns=[l$_.BlendNormal,l$_.BlendAdd,l$_.BlendMultiply,l$_.BlendScreen,l$_.BlendOverlay,l$_.BlendLight,l$_.BlendMask,l$_.BlendDestinationOut],l$_.targetFns=[l$_.BlendNormalTarget,l$_.BlendAddTarget,l$_.BlendMultiplyTarget,l$_.BlendScreenTarget,l$_.BlendOverlayTarget,l$_.BlendLightTarget,l$_.BlendMask,l$_.BlendDestinationOut]},l$_.BlendNormal=function(l$i){l$i.blendFunc(1,771)},l$_.BlendAdd=function(l$i){l$i.blendFunc(1,772)},l$_.BlendMultiply=function(l$i){l$i.blendFunc(774,771)},l$_.BlendScreen=function(l$i){l$i.blendFunc(1,1)},l$_.BlendOverlay=function(l$i){l$i.blendFunc(1,769)},l$_.BlendLight=function(l$i){l$i.blendFunc(1,1)},l$_.BlendNormalTarget=function(l$i){l$i.blendFunc(1,771)},l$_.BlendAddTarget=function(l$i){l$i.blendFunc(1,772)},l$_.BlendMultiplyTarget=function(l$i){l$i.blendFunc(774,771)},l$_.BlendScreenTarget=function(l$i){l$i.blendFunc(1,1)},l$_.BlendOverlayTarget=function(l$i){l$i.blendFunc(1,769)},l$_.BlendLightTarget=function(l$i){l$i.blendFunc(1,1)},l$_.BlendMask=function(l$i){l$i.blendFunc(0,770)},l$_.BlendDestinationOut=function(l$i){l$i.blendFunc(0,0)},l$_.activeBlendFunction=null,l$_.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],l$_.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},l$_.NORMAL="normal",l$_.ADD="add",l$_.MULTIPLY="multiply",l$_.SCREEN="screen",l$_.LIGHT="light",l$_.OVERLAY="overlay",l$_.DESTINATIONOUT="destination-out",l$_.fns=[],l$_.targetFns=[],l$_}(),l$U=function(){function l$R(l$i){this._color=l$h.create("black"),this.setValue(l$i)}l$f(l$R,"laya.webgl.canvas.DrawStyle");var l$i=l$R.prototype;return l$i.setValue=function(l$i){if(l$i){if("string"==typeof l$i)return void(this._color=l$h.create(l$i));if(l$i instanceof laya.utils.Color)return void(this._color=l$i)}},l$i.reset=function(){this._color=l$h.create("black")},l$i.equal=function(l$i){return"string"==typeof l$i?this._color.strColor===l$i:l$i instanceof laya.utils.Color&&this._color.numColor===l$i.numColor},l$i.toColorStr=function(){return this._color.strColor},l$R.create=function(l$i){var l$_;if(l$i&&("string"==typeof l$i?l$_=l$h.create(l$i):l$i instanceof laya.utils.Color&&(l$_=l$i),l$_))return l$_._drawStyle||(l$_._drawStyle=new l$R(l$i));return laya.webgl.canvas.DrawStyle.DEFAULT},l$L(l$R,["DEFAULT",function(){return this.DEFAULT=new l$R("#000000")}]),l$R}(),l$g=function(){function l$i(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];l$ei.mainContext;this.ib=l$Wi.create(35048),this.vb=l$Ti.create(5)}l$f(l$i,"laya.webgl.canvas.Path");var l$_=l$i.prototype;return l$_.addPoint=function(l$i,l$_){this.tempArray.push(l$i,l$_)},l$_.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},l$_.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},l$_.polygon=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L;return this.geomatrys.push(this._curGeomatry=l$L=new l$ui(l$i,l$_,l$R,l$r,l$b,l$z)),l$r||(l$L.fill=!1),null==l$z&&(l$L.borderWidth=0),l$L},l$_.setGeomtry=function(l$i){this.geomatrys.push(this._curGeomatry=l$i)},l$_.drawLine=function(l$i,l$_,l$R,l$r,l$b){var l$z;return this.closePath?this.geomatrys.push(this._curGeomatry=l$z=new l$Gi(l$i,l$_,l$R,l$r,l$b)):this.geomatrys.push(this._curGeomatry=l$z=new l$$i(l$i,l$_,l$R,l$r,l$b)),l$z.fill=!1,l$z},l$_.update=function(){var l$i=this.ib._byteLength,l$_=this.geomatrys.length;this.offset=l$i;for(var l$R=this.geoStart;l$R<l$_;l$R++)this.geomatrys[l$R].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=l$_,this.count=(this.ib._byteLength-l$i)/l$Mi.BYTES_PIDX},l$_.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},l$_.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},l$i}(),l$V=function(){function l$w(){}l$f(l$w,"laya.webgl.canvas.save.SaveBase");var l$i=l$w.prototype;return l$l.imps(l$i,{"laya.webgl.canvas.save.ISaveData":!0}),l$i.isSaveMark=function(){return!1},l$i.restore=function(l$i){this._dataObj[this._valueName]=this._value,(l$w._cache[l$w._cache._length++]=this)._newSubmit&&(l$i._curSubmit=l$zi.RENDERBASE,l$i._renderKey=0)},l$w._createArray=function(){var l$i=[];return l$i._length=0,l$i},l$w._init=function(){var l$i=l$w._namemap={};return l$i[1]="ALPHA",l$i[2]="fillStyle",l$i[8]="font",l$i[256]="lineWidth",l$i[512]="strokeStyle",l$i[8192]="_mergeID",l$i[1024]=l$i[2048]=l$i[4096]=[],l$i[16384]="textBaseline",l$i[32768]="textAlign",l$i[65536]="_nBlendType",l$i[1048576]="shader",l$i[2097152]="filters",l$i},l$w.save=function(l$i,l$_,l$R,l$r){if((l$i._saveMark._saveuse&l$_)!==l$_){l$i._saveMark._saveuse|=l$_;var l$b=l$w._cache,l$z=0<l$b._length?l$b[--l$b._length]:new l$w;l$z._value=l$R[l$z._valueName=l$w._namemap[l$_]],l$z._dataObj=l$R,l$z._newSubmit=l$r;var l$L=l$i._save;l$L[l$L._length++]=l$z}},l$w._cache=laya.webgl.canvas.save.SaveBase._createArray(),l$w._namemap=l$w._init(),l$w}(),l$y=function(){function l$z(){this._clipRect=new l$S}l$f(l$z,"laya.webgl.canvas.save.SaveClipRect");var l$i=l$z.prototype;return l$l.imps(l$i,{"laya.webgl.canvas.save.ISaveData":!0}),l$i.isSaveMark=function(){return!1},l$i.restore=function(l$i){l$i._clipRect=this._clipSaveRect,(l$z._cache[l$z._cache._length++]=this)._submitScissor.submitLength=l$i._submits._length-this._submitScissor.submitIndex,l$i._curSubmit=l$zi.RENDERBASE,l$i._renderKey=0},l$z.save=function(l$i,l$_){if(131072!=(131072&l$i._saveMark._saveuse)){l$i._saveMark._saveuse|=131072;var l$R=l$z._cache,l$r=0<l$R._length?l$R[--l$R._length]:new l$z;l$r._clipSaveRect=l$i._clipRect,l$i._clipRect=l$r._clipRect.copyFrom(l$i._clipRect),l$r._submitScissor=l$_;var l$b=l$i._save;l$b[l$b._length++]=l$r}},l$L(l$z,["_cache",function(){return this._cache=l$V._createArray()}]),l$z}(),l$a=function(){function l$J(){this._contextX=0,this._contextY=0,this._clipRect=new l$S,this._rect=new l$S,this._matrix=new l$q}l$f(l$J,"laya.webgl.canvas.save.SaveClipRectStencil");var l$i=l$J.prototype;return l$l.imps(l$i,{"laya.webgl.canvas.save.ISaveData":!0}),l$i.isSaveMark=function(){return!1},l$i.restore=function(l$i){l$Bi.restore(l$i,this._rect,this._saveMatrix,this._contextX,this._contextY),l$i._clipRect=this._clipSaveRect,l$i._curMat=this._saveMatrix,l$i._x=this._contextX,l$i._y=this._contextY,l$J._cache[l$J._cache._length++]=this,l$i._curSubmit=l$zi.RENDERBASE},l$J.save=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){if(262144!=(262144&l$i._saveMark._saveuse)){l$i._saveMark._saveuse|=262144;var l$B=l$J._cache,l$n=0<l$B._length?l$B[--l$B._length]:new l$J;l$n._clipSaveRect=l$i._clipRect,l$n._clipRect.setTo(l$L,l$w,l$x,l$P),l$i._clipRect=l$n._clipRect,l$n._rect.x=l$R,l$n._rect.y=l$r,l$n._rect.width=l$b,l$n._rect.height=l$z,l$n._contextX=l$i._x,l$n._contextY=l$i._y,l$n._saveMatrix=l$i._curMat,l$i._curMat.copyTo(l$n._matrix),l$i._curMat=l$n._matrix,l$n._submitStencil=l$_;var l$f=l$i._save;l$f[l$f._length++]=l$n}},l$L(l$J,["_cache",function(){return this._cache=l$V._createArray()}]),l$J}(),l$F=function(){function l$r(){this._saveuse=0}l$f(l$r,"laya.webgl.canvas.save.SaveMark");var l$i=l$r.prototype;return l$l.imps(l$i,{"laya.webgl.canvas.save.ISaveData":!0}),l$i.isSaveMark=function(){return!0},l$i.restore=function(l$i){l$i._saveMark=this._preSaveMark,l$r._no[l$r._no._length++]=this},l$r.Create=function(l$i){var l$_=l$r._no,l$R=0<l$_._length?l$_[--l$_._length]:new l$r;return l$R._saveuse=0,l$R._preSaveMark=l$i._saveMark,l$i._saveMark=l$R},l$L(l$r,["_no",function(){return this._no=l$V._createArray()}]),l$r}(),l$d=function(){function l$z(){this._matrix=new l$q}l$f(l$z,"laya.webgl.canvas.save.SaveTransform");var l$i=l$z.prototype;return l$l.imps(l$i,{"laya.webgl.canvas.save.ISaveData":!0}),l$i.isSaveMark=function(){return!1},l$i.restore=function(l$i){l$i._curMat=this._savematrix,l$z._no[l$z._no._length++]=this},l$z.save=function(l$i){var l$_=l$i._saveMark;if(2048!=(2048&l$_._saveuse)){l$_._saveuse|=2048;var l$R=l$z._no,l$r=0<l$R._length?l$R[--l$R._length]:new l$z;l$r._savematrix=l$i._curMat,l$i._curMat=l$i._curMat.copyTo(l$r._matrix);var l$b=l$i._save;l$b[l$b._length++]=l$r}},l$L(l$z,["_no",function(){return this._no=l$V._createArray()}]),l$z}(),l$Q=function(){function l$b(){}l$f(l$b,"laya.webgl.canvas.save.SaveTranslate");var l$i=l$b.prototype;return l$l.imps(l$i,{"laya.webgl.canvas.save.ISaveData":!0}),l$i.isSaveMark=function(){return!1},l$i.restore=function(l$i){l$i._curMat;l$i._x=this._x,l$i._y=this._y,l$b._no[l$b._no._length++]=this},l$b.save=function(l$i){var l$_=l$b._no,l$R=0<l$_._length?l$_[--l$_._length]:new l$b;l$R._x=l$i._x,l$R._y=l$i._y;var l$r=l$i._save;l$r[l$r._length++]=l$R},l$L(l$b,["_no",function(){return this._no=l$V._createArray()}]),l$b}(),l$H=function(){function l$i(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new l$S}l$f(l$i,"laya.webgl.resource.RenderTargetMAX");var l$_=l$i.prototype;return l$_.setSP=function(l$i){this._sp=l$i},l$_.size=function(l$i,l$_){var l$R=this;this._width!==l$i||this._height!==l$_?(this.repaint=!0,this._width=l$i,this._height=l$_,this.target?this.target.size(l$i,l$_):this.target=l$Oi.create(l$i,l$_),this.target.hasListener("recovered")||this.target.on("recovered",this,function(l$i){l$l.timer.callLater(l$R._sp,l$R._sp.repaint)})):this.target.size(l$i,l$_)},l$_._flushToTarget=function(l$i,l$_){if(!l$_._destroy){var l$R=l$ti.worldScissorTest,l$r=l$ti.worldClipRect;l$ti.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,l$ti.worldScissorTest=!1,l$ei.mainContext.disable(3089);var l$b=l$ti.worldAlpha,l$z=l$ti.worldMatrix4,l$L=l$ti.worldMatrix,l$w=l$ti.worldFilters,l$x=l$ti.worldShaderDefines;if(l$ti.worldMatrix=l$q.EMPTY,l$ti.restoreTempArray(),l$ti.worldMatrix4=l$ti.TEMPMAT4_ARRAY,l$ti.worldAlpha=1,l$ti.worldFilters=null,l$ti.worldShaderDefines=null,l$Ki.activeShader=null,l$_.start(),l$A.showCanvasMark?l$_.clear(0,1,0,.3):l$_.clear(0,0,0,0),l$i.flush(),l$_.end(),l$Ki.activeShader=null,l$ti.worldAlpha=l$b,l$ti.worldMatrix4=l$z,l$ti.worldMatrix=l$L,l$ti.worldFilters=l$w,l$ti.worldShaderDefines=l$x,l$ti.worldScissorTest=l$R){var l$P=l$ti.height-l$r.y-l$r.height;l$ei.mainContext.scissor(l$r.x,l$P,l$r.width,l$r.height),l$ei.mainContext.enable(3089)}l$ti.worldClipRect=l$r}},l$_.flush=function(l$i){this.repaint&&(this._flushToTarget(l$i,this.target),this.repaint=!1)},l$_.drawTo=function(l$i,l$_,l$R,l$r,l$b){l$i.drawTexture(this.target.getTexture(),l$_,l$R,l$r,l$b,0,0)},l$_.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},l$i}(),l$W=function(){function l$i(){this.ALPHA=1,this.shaderType=0,this.defines=new l$vi}return l$f(l$i,"laya.webgl.shader.d2.Shader2D"),l$i.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},l$i.__init__=function(){var l$i,l$_;l$Fi.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),l$Fi.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),l$Fi.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),l$Fi.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),l$Fi.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),l$Fi.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),l$Fi.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),l$Fi.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),l$i="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",l$_='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',l$Fi.preCompile2D(0,1,l$i,l$_,null),l$i="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",l$_='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',l$Fi.preCompile2D(0,2,l$i,l$_,null),l$i="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",l$_="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",l$Fi.preCompile2D(0,4,l$i,l$_,null),l$i="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",l$_='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',l$Fi.preCompile2D(0,256,l$i,l$_,null),l$i="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",l$_="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",l$Fi.preCompile2D(0,512,l$i,l$_,null)},l$i}(),l$T=function(){function l$_(l$i,l$_,l$R){this._value=0,this._name2int=l$i,this._int2name=l$_,this._int2nameMap=l$R}l$f(l$_,"laya.webgl.shader.ShaderDefines");var l$i=l$_.prototype;return l$i.add=function(l$i){return"string"==typeof l$i&&(l$i=this._name2int[l$i]),this._value|=l$i,this._value},l$i.addInt=function(l$i){return this._value|=l$i,this._value},l$i.remove=function(l$i){return"string"==typeof l$i&&(l$i=this._name2int[l$i]),this._value&=~l$i,this._value},l$i.isDefine=function(l$i){return(this._value&l$i)===l$i},l$i.getValue=function(){return this._value},l$i.setValue=function(l$i){this._value=l$i},l$i.toNameDic=function(){var l$i=this._int2nameMap[this._value];return l$i||l$_._toText(this._value,this._int2name,this._int2nameMap)},l$_._reg=function(l$i,l$_,l$R,l$r){l$r[l$R[l$i]=l$_]=l$i},l$_._toText=function(l$i,l$_,l$R){var l$r=l$R[l$i];if(l$r)return l$r;for(var l$b={},l$z=1,l$L=0;l$L<32&&!(l$i<(l$z=1<<l$L));l$L++)if(l$i&l$z){var l$w=l$_[l$z];l$w&&(l$b[l$w]="")}return l$R[l$i]=l$b},l$_._toInt=function(l$i,l$_){for(var l$R=l$i.split("."),l$r=0,l$b=0,l$z=l$R.length;l$b<l$z;l$b++){var l$L=l$_[l$R[l$b]];if(!l$L)throw new Error("Defines to int err:"+l$i+"/"+l$R[l$b]);l$r|=l$L}return l$r},l$_}(),l$ii=function(){function l$L(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new l$q}l$f(l$L,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var l$i=l$L.prototype;return l$i.init=function(l$i,l$_,l$R){if(l$_)this._vs=l$_;else{this._vs=[];var l$r=l$i.width,l$b=l$i.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(l$r,0,1,0,1,1,1,1),this._vs.push(l$r,l$b,1,1,1,1,1,1),this._vs.push(0,l$b,0,1,1,1,1,1)}l$R?this._ps=l$R:(l$L._defaultPS||(l$L._defaultPS=[]).push(0,1,3,3,1,2),this._ps=l$L._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=l$i},l$i.init2=function(l$i,l$_,l$R,l$r,l$b){this.transform&&(this.transform=null),l$R?this._ps=l$R:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=l$r,this._uvs=l$b,this.mEleNum=this._ps.length,this.mTexture=l$i,(l$X.isConchNode||l$X.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},l$i._initMyData=function(){var l$i=0,l$_=0,l$R=4*this._verticles.length;this._vs=l$L._tempVS;var l$r=!1;if(l$X.isConchNode||l$X.isConchApp?(this._vs.length=l$R,l$r=!0):this._vs.length<l$R&&(this._vs.length=l$R,l$r=!0),l$L._tVSLen=l$R,l$r)for(;l$i<l$R;)this._vs[l$i]=this._verticles[l$_],this._vs[l$i+1]=this._verticles[l$_+1],this._vs[l$i+2]=this._uvs[l$_],this._vs[l$i+3]=this._uvs[l$_+1],this._vs[l$i+4]=1,this._vs[l$i+5]=1,this._vs[l$i+6]=1,this._vs[l$i+7]=1,l$i+=8,l$_+=2;else for(;l$i<l$R;)this._vs[l$i]=this._verticles[l$_],this._vs[l$i+1]=this._verticles[l$_+1],this._vs[l$i+2]=this._uvs[l$_],this._vs[l$i+3]=this._uvs[l$_+1],l$i+=8,l$_+=2},l$i.getData2=function(l$i,l$_,l$R){var l$r;this.mVBBuffer=l$i,this.mIBBuffer=l$_,this._initMyData(),l$i.appendEx2(this._vs,Float32Array,l$L._tVSLen,4),this._indexStart=l$_._byteLength,(l$r=l$L._tempIB).length<this._ps.length&&(l$r.length=this._ps.length);for(var l$b=0,l$z=this._ps.length;l$b<l$z;l$b++)l$r[l$b]=this._ps[l$b]+l$R;l$_.appendEx2(l$r,Uint16Array,this._ps.length,2)},l$i.getData=function(l$i,l$_,l$R){if(this.mVBBuffer=l$i,this.mIBBuffer=l$_,l$i.append(this.mVBData),this._indexStart=l$_._byteLength,this.mIBData.start!=l$R){for(var l$r=0,l$b=this._ps.length;l$r<l$b;l$r++)this.mIBData[l$r]=this._ps[l$r]+l$R;this.mIBData.start=l$R}l$_.append(this.mIBData)},l$i.render=function(l$i,l$_,l$R){if(l$X.isWebGL&&this.mTexture){l$i._renderKey=0,l$i._shader2D.glTexture=null,l$_i.getInstance().addSkinMesh(this);var l$r=l$zi.createShape(l$i,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,l$Zi.create(512,0));this.transform||(this.transform=l$q.EMPTY),this.transform.translate(l$_,l$R),l$q.mul(this.transform,l$i._curMat,this._tempMatrix),this.transform.translate(-l$_,-l$R);var l$b=l$r.shaderValue,l$z=l$b.u_mmat2||l$ti.getMatrArray();l$ti.mat2MatArray(this._tempMatrix,l$z),l$b.textureHost=this.mTexture,l$b.offsetX=0,l$b.offsetY=0,l$b.u_mmat2=l$z,l$b.ALPHA=l$i._shader2D.ALPHA,l$i._submits[l$i._submits._length++]=l$r}else l$X.isConchApp&&this.mTexture&&(this.transform||(this.transform=l$q.EMPTY),l$i.setSkinMesh&&l$i.setSkinMesh(l$_,l$R,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},l$L._tempVS=[],l$L._tempIB=[],l$L._defaultPS=null,l$L._tVSLen=0,l$L}(),l$_i=function(){function l$i(){this.ib=null,this.vb=null;l$ei.mainContext;this.ib=l$Wi.create(35048),this.vb=l$Ti.create(8)}l$f(l$i,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var l$_=l$i.prototype;return l$_.addSkinMesh=function(l$i){l$i.getData2(this.vb,this.ib,this.vb._byteLength/32)},l$_.reset=function(){this.vb.clear(),this.ib.clear()},l$i.getInstance=function(){return l$i.instance=l$i.instance||new l$i},l$i.instance=null,l$i}(),l$Ri=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===l$x&&(l$x=0),this.x=l$i,this.y=l$_,this.width=l$R,this.height=l$r,this.edges=l$b,this.color=l$z,this.borderWidth=l$L,this.borderColor=l$w}l$f(l$i,"laya.webgl.shapes.BasePoly");var l$_=l$i.prototype;return l$l.imps(l$_,{"laya.webgl.shapes.IShape":!0}),l$_.getData=function(l$i,l$_,l$R){},l$_.rebuild=function(l$i){},l$_.setMatrix=function(l$i){},l$_.needUpdate=function(l$i){return!0},l$_.sector=function(l$i,l$_,l$R){var l$r=this.x,l$b=this.y,l$z=this.edges,l$L=(this.r1-this.r0)/l$z,l$w=this.width,l$x=this.height,l$P=this.color,l$B=(l$P>>16&255)/255,l$n=(l$P>>8&255)/255,l$f=(255&l$P)/255;l$i.push(l$r,l$b,l$B,l$n,l$f);for(var l$J=0;l$J<l$z+1;l$J++)l$i.push(l$r+Math.sin(l$L*l$J+this.r0)*l$w,l$b+Math.cos(l$L*l$J+this.r0)*l$x),l$i.push(l$B,l$n,l$f);for(l$J=0;l$J<l$z;l$J++)l$_.push(l$R,l$R+l$J+1,l$R+l$J+2)},l$_.createLine2=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L,l$w,l$x,l$P,l$B,l$n,l$f,l$J,l$h,l$M,l$N,l$X,l$t,l$I,l$e,l$c,l$l,l$A,l$Z,l$q,l$j=l$i.concat(),l$S=l$b,l$v=this.borderColor,l$$=(l$v>>16&255)/255,l$G=(l$v>>8&255)/255,l$u=(255&l$v)/255,l$o=l$j.length/2,l$p=l$r,l$k=l$R/2;l$x=l$j[0],l$P=l$j[1],l$M=l$x-(l$B=l$j[2]),l$h=(l$h=-(l$P-(l$n=l$j[3])))/(l$q=Math.sqrt(l$h*l$h+l$M*l$M))*l$k,l$M=l$M/l$q*l$k,l$S.push(l$x-l$h+this.x,l$P-l$M+this.y,l$$,l$G,l$u,l$x+l$h+this.x,l$P+l$M+this.y,l$$,l$G,l$u);for(var l$K=1;l$K<l$o-1;l$K++)l$x=l$j[2*(l$K-1)],l$P=l$j[2*(l$K-1)+1],l$B=l$j[2*l$K],l$n=l$j[2*l$K+1],l$f=l$j[2*(l$K+1)],l$J=l$j[2*(l$K+1)+1],l$M=l$x-l$B,l$X=l$B-l$f,l$e=(-(l$h=(l$h=-(l$P-l$n))/(l$q=Math.sqrt(l$h*l$h+l$M*l$M))*l$k)+l$x)*(-(l$M=l$M/l$q*l$k)+l$n)-(-l$h+l$B)*(-l$M+l$P),l$A=(-(l$N=(l$N=-(l$n-l$J))/(l$q=Math.sqrt(l$N*l$N+l$X*l$X))*l$k)+l$f)*(-(l$X=l$X/l$q*l$k)+l$n)-(-l$N+l$B)*(-l$X+l$J),l$Z=(l$t=-l$M+l$P-(-l$M+l$n))*(l$l=-l$N+l$B-(-l$N+l$f))-(l$c=-l$X+l$J-(-l$X+l$n))*(l$I=-l$h+l$B-(-l$h+l$x)),Math.abs(l$Z)<.1?(l$Z+=10.1,l$S.push(l$B-l$h+this.x,l$n-l$M+this.y,l$$,l$G,l$u,l$B+l$h+this.x,l$n+l$M+this.y,l$$,l$G,l$u)):(((l$L=(l$I*l$A-l$l*l$e)/l$Z)-l$B)*(l$L-l$B)+((l$w=(l$c*l$e-l$t*l$A)/l$Z)-l$n)+(l$w-l$n),l$S.push(l$L+this.x,l$w+this.y,l$$,l$G,l$u,l$B-(l$L-l$B)+this.x,l$n-(l$w-l$n)+this.y,l$$,l$G,l$u));l$x=l$j[l$j.length-4],l$P=l$j[l$j.length-3],l$M=l$x-(l$B=l$j[l$j.length-2]),l$h=(l$h=-(l$P-(l$n=l$j[l$j.length-1])))/(l$q=Math.sqrt(l$h*l$h+l$M*l$M))*l$k,l$M=l$M/l$q*l$k,l$S.push(l$B-l$h+this.x,l$n-l$M+this.y,l$$,l$G,l$u,l$B+l$h+this.x,l$n+l$M+this.y,l$$,l$G,l$u);var l$O=l$z;for(l$K=1;l$K<l$O;l$K++)l$_.push(l$p+2*(l$K-1),l$p+2*(l$K-1)+1,l$p+2*l$K+1,l$p+2*l$K+1,l$p+2*l$K,l$p+2*(l$K-1));return l$S},l$_.createLine=function(l$i,l$_,l$R,l$r){var l$b=l$i.concat(),l$z=l$i,l$L=this.borderColor,l$w=(l$L>>16&255)/255,l$x=(l$L>>8&255)/255,l$P=(255&l$L)/255;l$b.splice(0,5);var l$B,l$n,l$f,l$J,l$h,l$M,l$N,l$X,l$t,l$I,l$e,l$c,l$l,l$A,l$Z,l$q,l$j,l$S,l$v,l$$,l$G=l$b.length/5,l$u=l$r,l$o=l$R/2;l$f=l$b[0],l$J=l$b[1],l$I=l$f-(l$h=l$b[5]),l$t=(l$t=-(l$J-(l$M=l$b[6])))/(l$$=Math.sqrt(l$t*l$t+l$I*l$I))*l$o,l$I=l$I/l$$*l$o,l$z.push(l$f-l$t,l$J-l$I,l$w,l$x,l$P,l$f+l$t,l$J+l$I,l$w,l$x,l$P);for(var l$p=1;l$p<l$G-1;l$p++)l$f=l$b[5*(l$p-1)],l$J=l$b[5*(l$p-1)+1],l$h=l$b[5*l$p],l$M=l$b[5*l$p+1],l$N=l$b[5*(l$p+1)],l$X=l$b[5*(l$p+1)+1],l$I=l$f-l$h,l$c=l$h-l$N,l$Z=(-(l$t=(l$t=-(l$J-l$M))/(l$$=Math.sqrt(l$t*l$t+l$I*l$I))*l$o)+l$f)*(-(l$I=l$I/l$$*l$o)+l$M)-(-l$t+l$h)*(-l$I+l$J),l$S=(-(l$e=(l$e=-(l$M-l$X))/(l$$=Math.sqrt(l$e*l$e+l$c*l$c))*l$o)+l$N)*(-(l$c=l$c/l$$*l$o)+l$M)-(-l$e+l$h)*(-l$c+l$X),l$v=(l$l=-l$I+l$J-(-l$I+l$M))*(l$j=-l$e+l$h-(-l$e+l$N))-(l$q=-l$c+l$X-(-l$c+l$M))*(l$A=-l$t+l$h-(-l$t+l$f)),Math.abs(l$v)<.1?(l$v+=10.1,l$z.push(l$h-l$t,l$M-l$I,l$w,l$x,l$P,l$h+l$t,l$M+l$I,l$w,l$x,l$P)):(((l$B=(l$A*l$S-l$j*l$Z)/l$v)-l$h)*(l$B-l$h)+((l$n=(l$q*l$Z-l$l*l$S)/l$v)-l$M)+(l$n-l$M),l$z.push(l$B,l$n,l$w,l$x,l$P,l$h-(l$B-l$h),l$M-(l$n-l$M),l$w,l$x,l$P));l$f=l$b[l$b.length-10],l$J=l$b[l$b.length-9],l$I=l$f-(l$h=l$b[l$b.length-5]),l$t=(l$t=-(l$J-(l$M=l$b[l$b.length-4])))/(l$$=Math.sqrt(l$t*l$t+l$I*l$I))*l$o,l$I=l$I/l$$*l$o,l$z.push(l$h-l$t,l$M-l$I,l$w,l$x,l$P,l$h+l$t,l$M+l$I,l$w,l$x,l$P);var l$k=this.edges+1;for(l$p=1;l$p<l$k;l$p++)l$_.push(l$u+2*(l$p-1),l$u+2*(l$p-1)+1,l$u+2*l$p+1,l$u+2*l$p+1,l$u+2*l$p,l$u+2*(l$p-1));return l$z},l$_.createLoopLine=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=l$i.concat(),l$w=l$b||l$i,l$x=this.borderColor,l$P=(l$x>>16&255)/255,l$B=(l$x>>8&255)/255,l$n=(255&l$x)/255;l$L.splice(0,5);var l$f=[l$L[0],l$L[1]],l$J=[l$L[l$L.length-5],l$L[l$L.length-4]],l$h=l$J[0]+.5*(l$f[0]-l$J[0]),l$M=l$J[1]+.5*(l$f[1]-l$J[1]);l$L.unshift(l$h,l$M,0,0,0),l$L.push(l$h,l$M,0,0,0);var l$N,l$X,l$t,l$I,l$e,l$c,l$l,l$A,l$Z,l$q,l$j,l$S,l$v,l$$,l$G,l$u,l$o,l$p,l$k,l$K,l$O=l$L.length/5,l$E=l$r,l$s=l$R/2;l$t=l$L[0],l$I=l$L[1],l$q=l$t-(l$e=l$L[5]),l$Z=(l$Z=-(l$I-(l$c=l$L[6])))/(l$K=Math.sqrt(l$Z*l$Z+l$q*l$q))*l$s,l$q=l$q/l$K*l$s,l$w.push(l$t-l$Z,l$I-l$q,l$P,l$B,l$n,l$t+l$Z,l$I+l$q,l$P,l$B,l$n);for(var l$Y=1;l$Y<l$O-1;l$Y++)l$t=l$L[5*(l$Y-1)],l$I=l$L[5*(l$Y-1)+1],l$e=l$L[5*l$Y],l$c=l$L[5*l$Y+1],l$l=l$L[5*(l$Y+1)],l$A=l$L[5*(l$Y+1)+1],l$q=l$t-l$e,l$S=l$e-l$l,l$G=(-(l$Z=(l$Z=-(l$I-l$c))/(l$K=Math.sqrt(l$Z*l$Z+l$q*l$q))*l$s)+l$t)*(-(l$q=l$q/l$K*l$s)+l$c)-(-l$Z+l$e)*(-l$q+l$I),l$p=(-(l$j=(l$j=-(l$c-l$A))/(l$K=Math.sqrt(l$j*l$j+l$S*l$S))*l$s)+l$l)*(-(l$S=l$S/l$K*l$s)+l$c)-(-l$j+l$e)*(-l$S+l$A),l$k=(l$v=-l$q+l$I-(-l$q+l$c))*(l$o=-l$j+l$e-(-l$j+l$l))-(l$u=-l$S+l$A-(-l$S+l$c))*(l$$=-l$Z+l$e-(-l$Z+l$t)),Math.abs(l$k)<.1?(l$k+=10.1,l$w.push(l$e-l$Z,l$c-l$q,l$P,l$B,l$n,l$e+l$Z,l$c+l$q,l$P,l$B,l$n)):(((l$N=(l$$*l$p-l$o*l$G)/l$k)-l$e)*(l$N-l$e)+((l$X=(l$u*l$G-l$v*l$p)/l$k)-l$c)+(l$X-l$c),l$w.push(l$N,l$X,l$P,l$B,l$n,l$e-(l$N-l$e),l$c-(l$X-l$c),l$P,l$B,l$n));l$z&&(l$_=l$z);var l$C=this.edges+1;for(l$Y=1;l$Y<l$C;l$Y++)l$_.push(l$E+2*(l$Y-1),l$E+2*(l$Y-1)+1,l$E+2*l$Y+1,l$E+2*l$Y+1,l$E+2*l$Y,l$E+2*(l$Y-1));return l$_.push(l$E+2*(l$Y-1),l$E+2*(l$Y-1)+1,l$E+1,l$E+1,l$E,l$E+2*(l$Y-1)),l$w},l$i}(),l$ri=function(){function l$M(){}return l$f(l$M,"laya.webgl.shapes.Earcut"),l$M.earcut=function(l$i,l$_,l$R){l$R=l$R||2;var l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B=l$_&&l$_.length,l$n=l$B?l$_[0]*l$R:l$i.length,l$f=l$M.linkedList(l$i,0,l$n,l$R,!0),l$J=[];if(!l$f)return l$J;if(l$B&&(l$f=l$M.eliminateHoles(l$i,l$_,l$f,l$R)),l$i.length>80*l$R){l$r=l$z=l$i[0],l$b=l$L=l$i[1];for(var l$h=l$R;l$h<l$n;l$h+=l$R)(l$w=l$i[l$h])<l$r&&(l$r=l$w),(l$x=l$i[l$h+1])<l$b&&(l$b=l$x),l$z<l$w&&(l$z=l$w),l$L<l$x&&(l$L=l$x);l$P=0!==(l$P=Math.max(l$z-l$r,l$L-l$b))?1/l$P:0}return l$M.earcutLinked(l$f,l$J,l$R,l$r,l$b,l$P),l$J},l$M.linkedList=function(l$i,l$_,l$R,l$r,l$b){var l$z,l$L;if(l$b===0<l$M.signedArea(l$i,l$_,l$R,l$r))for(l$z=l$_;l$z<l$R;l$z+=l$r)l$L=l$M.insertNode(l$z,l$i[l$z],l$i[l$z+1],l$L);else for(l$z=l$R-l$r;l$_<=l$z;l$z-=l$r)l$L=l$M.insertNode(l$z,l$i[l$z],l$i[l$z+1],l$L);return l$L&&l$M.equals(l$L,l$L.next)&&(l$M.removeNode(l$L),l$L=l$L.next),l$L},l$M.filterPoints=function(l$i,l$_){if(!l$i)return l$i;l$_||(l$_=l$i);var l$R,l$r=l$i;do{if(l$R=!1,l$r.steiner||!l$M.equals(l$r,l$r.next)&&0!==l$M.area(l$r.prev,l$r,l$r.next))l$r=l$r.next;else{if(l$M.removeNode(l$r),(l$r=l$_=l$r.prev)===l$r.next)break;l$R=!0}}while(l$R||l$r!==l$_);return l$_},l$M.earcutLinked=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){if(l$i){!l$L&&l$z&&l$M.indexCurve(l$i,l$r,l$b,l$z);for(var l$w,l$x,l$P=l$i;l$i.prev!==l$i.next;)if(l$w=l$i.prev,l$x=l$i.next,l$z?l$M.isEarHashed(l$i,l$r,l$b,l$z):l$M.isEar(l$i))l$_.push(l$w.i/l$R),l$_.push(l$i.i/l$R),l$_.push(l$x.i/l$R),l$M.removeNode(l$i),l$i=l$x.next,l$P=l$x.next;else if((l$i=l$x)===l$P){l$L?1===l$L?(l$i=l$M.cureLocalIntersections(l$i,l$_,l$R),l$M.earcutLinked(l$i,l$_,l$R,l$r,l$b,l$z,2)):2===l$L&&l$M.splitEarcut(l$i,l$_,l$R,l$r,l$b,l$z):l$M.earcutLinked(l$M.filterPoints(l$i,null),l$_,l$R,l$r,l$b,l$z,1);break}}},l$M.isEar=function(l$i){var l$_=l$i.prev,l$R=l$i,l$r=l$i.next;if(0<=l$M.area(l$_,l$R,l$r))return!1;for(var l$b=l$i.next.next;l$b!==l$i.prev;){if(l$M.pointInTriangle(l$_.x,l$_.y,l$R.x,l$R.y,l$r.x,l$r.y,l$b.x,l$b.y)&&0<=l$M.area(l$b.prev,l$b,l$b.next))return!1;l$b=l$b.next}return!0},l$M.isEarHashed=function(l$i,l$_,l$R,l$r){var l$b=l$i.prev,l$z=l$i,l$L=l$i.next;if(0<=l$M.area(l$b,l$z,l$L))return!1;for(var l$w=l$b.x<l$z.x?l$b.x<l$L.x?l$b.x:l$L.x:l$z.x<l$L.x?l$z.x:l$L.x,l$x=l$b.y<l$z.y?l$b.y<l$L.y?l$b.y:l$L.y:l$z.y<l$L.y?l$z.y:l$L.y,l$P=l$b.x>l$z.x?l$b.x>l$L.x?l$b.x:l$L.x:l$z.x>l$L.x?l$z.x:l$L.x,l$B=l$b.y>l$z.y?l$b.y>l$L.y?l$b.y:l$L.y:l$z.y>l$L.y?l$z.y:l$L.y,l$n=l$M.zOrder(l$w,l$x,l$_,l$R,l$r),l$f=l$M.zOrder(l$P,l$B,l$_,l$R,l$r),l$J=l$i.nextZ;l$J&&l$J.z<=l$f;){if(l$J!==l$i.prev&&l$J!==l$i.next&&l$M.pointInTriangle(l$b.x,l$b.y,l$z.x,l$z.y,l$L.x,l$L.y,l$J.x,l$J.y)&&0<=l$M.area(l$J.prev,l$J,l$J.next))return!1;l$J=l$J.nextZ}for(l$J=l$i.prevZ;l$J&&l$J.z>=l$n;){if(l$J!==l$i.prev&&l$J!==l$i.next&&l$M.pointInTriangle(l$b.x,l$b.y,l$z.x,l$z.y,l$L.x,l$L.y,l$J.x,l$J.y)&&0<=l$M.area(l$J.prev,l$J,l$J.next))return!1;l$J=l$J.prevZ}return!0},l$M.cureLocalIntersections=function(l$i,l$_,l$R){var l$r=l$i;do{var l$b=l$r.prev,l$z=l$r.next.next;!l$M.equals(l$b,l$z)&&l$M.intersects(l$b,l$r,l$r.next,l$z)&&l$M.locallyInside(l$b,l$z)&&l$M.locallyInside(l$z,l$b)&&(l$_.push(l$b.i/l$R),l$_.push(l$r.i/l$R),l$_.push(l$z.i/l$R),l$M.removeNode(l$r),l$M.removeNode(l$r.next),l$r=l$i=l$z),l$r=l$r.next}while(l$r!==l$i);return l$r},l$M.splitEarcut=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=l$i;do{for(var l$w=l$L.next.next;l$w!==l$L.prev;){if(l$L.i!==l$w.i&&l$M.isValidDiagonal(l$L,l$w)){var l$x=l$M.splitPolygon(l$L,l$w);return l$L=l$M.filterPoints(l$L,l$L.next),l$x=l$M.filterPoints(l$x,l$x.next),l$M.earcutLinked(l$L,l$_,l$R,l$r,l$b,l$z),void l$M.earcutLinked(l$x,l$_,l$R,l$r,l$b,l$z)}l$w=l$w.next}l$L=l$L.next}while(l$L!==l$i)},l$M.eliminateHoles=function(l$i,l$_,l$R,l$r){var l$b,l$z,l$L,l$w,l$x,l$P=[];for(l$b=0,l$z=l$_.length;l$b<l$z;l$b++)l$L=l$_[l$b]*l$r,l$w=l$b<l$z-1?l$_[l$b+1]*l$r:l$i.length,(l$x=l$M.linkedList(l$i,l$L,l$w,l$r,!1))===l$x.next&&(l$x.steiner=!0),l$P.push(l$M.getLeftmost(l$x));for(l$P.sort(l$M.compareX),l$b=0;l$b<l$P.length;l$b++)l$M.eliminateHole(l$P[l$b],l$R),l$R=l$M.filterPoints(l$R,l$R.next);return l$R},l$M.compareX=function(l$i,l$_){return l$i.x-l$_.x},l$M.eliminateHole=function(l$i,l$_){if(l$_=l$M.findHoleBridge(l$i,l$_)){var l$R=l$M.splitPolygon(l$_,l$i);l$M.filterPoints(l$R,l$R.next)}},l$M.findHoleBridge=function(l$i,l$_){var l$R,l$r=l$_,l$b=l$i.x,l$z=l$i.y,l$L=-1/0;do{if(l$z<=l$r.y&&l$z>=l$r.next.y&&l$r.next.y!==l$r.y){var l$w=l$r.x+(l$z-l$r.y)*(l$r.next.x-l$r.x)/(l$r.next.y-l$r.y);if(l$w<=l$b&&l$L<l$w){if((l$L=l$w)===l$b){if(l$z===l$r.y)return l$r;if(l$z===l$r.next.y)return l$r.next}l$R=l$r.x<l$r.next.x?l$r:l$r.next}}l$r=l$r.next}while(l$r!==l$_);if(!l$R)return null;if(l$b===l$L)return l$R.prev;var l$x,l$P=l$R,l$B=l$R.x,l$n=l$R.y,l$f=1/0;for(l$r=l$R.next;l$r!==l$P;)l$b>=l$r.x&&l$r.x>=l$B&&l$b!==l$r.x&&l$M.pointInTriangle(l$z<l$n?l$b:l$L,l$z,l$B,l$n,l$z<l$n?l$L:l$b,l$z,l$r.x,l$r.y)&&((l$x=Math.abs(l$z-l$r.y)/(l$b-l$r.x))<l$f||l$x===l$f&&l$r.x>l$R.x)&&l$M.locallyInside(l$r,l$i)&&(l$R=l$r,l$f=l$x),l$r=l$r.next;return l$R},l$M.indexCurve=function(l$i,l$_,l$R,l$r){for(var l$b=l$i;null===l$b.z&&(l$b.z=l$M.zOrder(l$b.x,l$b.y,l$_,l$R,l$r)),l$b.prevZ=l$b.prev,l$b.nextZ=l$b.next,(l$b=l$b.next)!==l$i;);l$b.prevZ.nextZ=null,l$b.prevZ=null,l$M.sortLinked(l$b)},l$M.sortLinked=function(l$i){var l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P=1;do{for(l$R=l$i,l$z=l$i=null,l$L=0;l$R;){for(l$L++,l$r=l$R,l$_=l$w=0;l$_<l$P&&(l$w++,l$r=l$r.nextZ);l$_++);for(l$x=l$P;0<l$w||0<l$x&&l$r;)0!==l$w&&(0===l$x||!l$r||l$R.z<=l$r.z)?(l$R=(l$b=l$R).nextZ,l$w--):(l$r=(l$b=l$r).nextZ,l$x--),l$z?l$z.nextZ=l$b:l$i=l$b,l$b.prevZ=l$z,l$z=l$b;l$R=l$r}l$z.nextZ=null,l$P*=2}while(1<l$L);return l$i},l$M.zOrder=function(l$i,l$_,l$R,l$r,l$b){return(l$i=1431655765&((l$i=858993459&((l$i=252645135&((l$i=16711935&((l$i=32767*(l$i-l$R)*l$b)|l$i<<8))|l$i<<4))|l$i<<2))|l$i<<1))|(l$_=1431655765&((l$_=858993459&((l$_=252645135&((l$_=16711935&((l$_=32767*(l$_-l$r)*l$b)|l$_<<8))|l$_<<4))|l$_<<2))|l$_<<1))<<1},l$M.getLeftmost=function(l$i){for(var l$_=l$i,l$R=l$i;l$_.x<l$R.x&&(l$R=l$_),(l$_=l$_.next)!==l$i;);return l$R},l$M.pointInTriangle=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){return 0<=(l$b-l$L)*(l$_-l$w)-(l$i-l$L)*(l$z-l$w)&&0<=(l$i-l$L)*(l$r-l$w)-(l$R-l$L)*(l$_-l$w)&&0<=(l$R-l$L)*(l$z-l$w)-(l$b-l$L)*(l$r-l$w)},l$M.isValidDiagonal=function(l$i,l$_){return l$i.next.i!==l$_.i&&l$i.prev.i!==l$_.i&&!l$M.intersectsPolygon(l$i,l$_)&&l$M.locallyInside(l$i,l$_)&&l$M.locallyInside(l$_,l$i)&&l$M.middleInside(l$i,l$_)},l$M.area=function(l$i,l$_,l$R){return(l$_.y-l$i.y)*(l$R.x-l$_.x)-(l$_.x-l$i.x)*(l$R.y-l$_.y)},l$M.equals=function(l$i,l$_){return l$i.x===l$_.x&&l$i.y===l$_.y},l$M.intersects=function(l$i,l$_,l$R,l$r){return!!(l$M.equals(l$i,l$_)&&l$M.equals(l$R,l$r)||l$M.equals(l$i,l$r)&&l$M.equals(l$R,l$_))||0<l$M.area(l$i,l$_,l$R)!=0<l$M.area(l$i,l$_,l$r)&&0<l$M.area(l$R,l$r,l$i)!=0<l$M.area(l$R,l$r,l$_)},l$M.intersectsPolygon=function(l$i,l$_){var l$R=l$i;do{if(l$R.i!==l$i.i&&l$R.next.i!==l$i.i&&l$R.i!==l$_.i&&l$R.next.i!==l$_.i&&l$M.intersects(l$R,l$R.next,l$i,l$_))return!0;l$R=l$R.next}while(l$R!==l$i);return!1},l$M.locallyInside=function(l$i,l$_){return l$M.area(l$i.prev,l$i,l$i.next)<0?0<=l$M.area(l$i,l$_,l$i.next)&&0<=l$M.area(l$i,l$i.prev,l$_):l$M.area(l$i,l$_,l$i.prev)<0||l$M.area(l$i,l$i.next,l$_)<0},l$M.middleInside=function(l$i,l$_){for(var l$R=l$i,l$r=!1,l$b=(l$i.x+l$_.x)/2,l$z=(l$i.y+l$_.y)/2;l$R.y>l$z!=l$R.next.y>l$z&&l$R.next.y!==l$R.y&&l$b<(l$R.next.x-l$R.x)*(l$z-l$R.y)/(l$R.next.y-l$R.y)+l$R.x&&(l$r=!l$r),(l$R=l$R.next)!==l$i;);return l$r},l$M.splitPolygon=function(l$i,l$_){var l$R=new l$bi(l$i.i,l$i.x,l$i.y),l$r=new l$bi(l$_.i,l$_.x,l$_.y),l$b=l$i.next,l$z=l$_.prev;return(l$i.next=l$_).prev=l$i,(l$R.next=l$b).prev=l$R,(l$r.next=l$R).prev=l$r,(l$z.next=l$r).prev=l$z,l$r},l$M.insertNode=function(l$i,l$_,l$R,l$r){var l$b=new l$bi(l$i,l$_,l$R);return l$r?(l$b.next=l$r.next,(l$b.prev=l$r).next.prev=l$b,l$r.next=l$b):(l$b.prev=l$b).next=l$b,l$b},l$M.removeNode=function(l$i){l$i.next.prev=l$i.prev,l$i.prev.next=l$i.next,l$i.prevZ&&(l$i.prevZ.nextZ=l$i.nextZ),l$i.nextZ&&(l$i.nextZ.prevZ=l$i.prevZ)},l$M.signedArea=function(l$i,l$_,l$R,l$r){for(var l$b=0,l$z=l$_,l$L=l$R-l$r;l$z<l$R;l$z+=l$r)l$b+=(l$i[l$L]-l$i[l$z])*(l$i[l$z+1]+l$i[l$L+1]),l$L=l$z;return l$b},l$M}(),l$bi=function(){function l$i(l$i,l$_,l$R){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=l$i,this.x=l$_,this.y=l$R,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return l$f(l$i,"laya.webgl.shapes.EarcutNode"),l$i}(),l$zi=(function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this.lineWidth=l$i,this.lineColor=l$_,this.lineAlpha=l$R,this.fillColor=l$r,this.fillAlpha=l$b,this.shape=l$L,this.fill=l$z}l$f(l$i,"laya.webgl.shapes.GeometryData");var l$_=l$i.prototype;l$_.clone=function(){return new l$i(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},l$_.getIndexData=function(){return null},l$_.getVertexData=function(){return null},l$_.destroy=function(){this.shape=null}}(),function(){function l$i(l$i){if(l$i instanceof Float32Array)this.points=l$i;else if(l$i instanceof Array){l$i.length;this.points=new Float32Array(l$i)}}l$f(l$i,"laya.webgl.shapes.Vertex");var l$_=l$i.prototype;l$l.imps(l$_,{"laya.webgl.shapes.IShape":!0}),l$_.getData=function(l$i,l$_,l$R){},l$_.needUpdate=function(l$i){return!1},l$_.rebuild=function(l$i){},l$_.setMatrix=function(l$i){}}(),function(){function l$x(l$i){void 0===l$i&&(l$i=1e4),this._renderType=l$i}l$f(l$x,"laya.webgl.submit.Submit");var l$i=l$x.prototype;return l$l.imps(l$i,{"laya.webgl.submit.ISubmit":!0}),l$i.releaseRender=function(){var l$i=l$x._cache;(l$i[l$i._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},l$i.getRenderType=function(){return this._renderType},l$i.renderSubmit=function(){if(0===this._numEle)return 1;var l$i=this.shaderValue.textureHost;if(l$i){var l$_=l$i.source;if(!l$i.bitmap||!l$_)return 1;this.shaderValue.texture=l$_,l$i.alphaTexture&&l$i.alphaTexture.source&&(this.shaderValue.texture1=l$i.alphaTexture.source)}this._vb.bind_upload(this._ib);var l$R=l$ei.mainContext;return this.shaderValue.upload(),l$D.activeBlendFunction!==this._blendFn&&(l$R.enable(3042),this._blendFn(l$R),l$D.activeBlendFunction=this._blendFn),l$G.drawCall++,l$G.trianglesFaces+=this._numEle/3,l$R.drawElements(4,this._numEle,5123,this._startIdx),1},l$x.__init__=function(){var l$i=l$x.RENDERBASE=new l$x(-1);l$i.shaderValue=new l$Zi(0,0),l$i.shaderValue.ALPHA=-1234},l$x.createSubmit=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$x._cache._length?l$x._cache[--l$x._cache._length]:new l$x;null==l$R&&((l$R=l$z._selfVb||(l$z._selfVb=l$Ti.create(-1))).clear(),l$r=0),l$z._ib=l$_,l$z._vb=l$R,l$z._startIdx=l$r*l$Mi.BYTES_PIDX,l$z._numEle=0;var l$L=l$i._nBlendType;l$z._blendFn=l$i._targets?l$D.targetFns[l$L]:l$D.fns[l$L],l$z.shaderValue=l$b,l$z.shaderValue.setValue(l$i._shader2D);var l$w=l$i._shader2D.filters;return l$w&&l$z.shaderValue.setFilters(l$w),l$z},l$x.createShape=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=l$x._cache._length?l$x._cache[--l$x._cache._length]:new l$x;l$L._ib=l$_,l$L._vb=l$R,l$L._numEle=l$r,l$L._startIdx=l$b,l$L.shaderValue=l$z,l$L.shaderValue.setValue(l$i._shader2D);var l$w=l$i._nBlendType;return l$L._blendFn=l$i._targets?l$D.targetFns[l$w]:l$D.fns[l$w],l$L},l$x.TYPE_2D=1e4,l$x.TYPE_CANVAS=10003,l$x.TYPE_CMDSETRT=10004,l$x.TYPE_CUSTOM=10005,l$x.TYPE_BLURRT=10006,l$x.TYPE_CMDDESTORYPRERT=10007,l$x.TYPE_DISABLESTENCIL=10008,l$x.TYPE_OTHERIBVB=10009,l$x.TYPE_PRIMITIVE=10010,l$x.TYPE_RT=10011,l$x.TYPE_BLUR_RT=10012,l$x.TYPE_TARGET=10013,l$x.TYPE_CHANGE_VALUE=10014,l$x.TYPE_SHAPE=10015,l$x.TYPE_TEXTURE=10016,l$x.TYPE_FILLTEXTURE=10017,l$x.RENDERBASE=null,l$x._cache=((l$x._cache=[])._length=0,l$x._cache),l$x}()),l$Li=function(){function l$r(){this.fun=null,this.args=null}l$f(l$r,"laya.webgl.submit.SubmitCMD");var l$i=l$r.prototype;return l$l.imps(l$i,{"laya.webgl.submit.ISubmit":!0}),l$i.renderSubmit=function(){return this.fun.apply(null,this.args),1},l$i.getRenderType=function(){return 0},l$i.releaseRender=function(){var l$i=l$r._cache;l$i[l$i._length++]=this},l$r.create=function(l$i,l$_){var l$R=l$r._cache._length?l$r._cache[--l$r._cache._length]:new l$r;return l$R.fun=l$_,l$R.args=l$i,l$R},l$r._cache=((l$r._cache=[])._length=0,l$r._cache),l$r}(),l$wi=function(){function l$_(){this.variables={}}l$f(l$_,"laya.webgl.submit.SubmitCMDScope");var l$i=l$_.prototype;return l$i.getValue=function(l$i){return this.variables[l$i]},l$i.addValue=function(l$i,l$_){return this.variables[l$i]=l$_},l$i.setValue=function(l$i,l$_){return this.variables.hasOwnProperty(l$i)?this.variables[l$i]=l$_:null},l$i.clear=function(){for(var l$i in this.variables)delete this.variables[l$i]},l$i.recycle=function(){this.clear(),l$_.POOL.push(this)},l$_.create=function(){var l$i=l$_.POOL.pop();return l$i||(l$i=new l$_),l$i},l$_.POOL=[],l$_}(),l$xi=function(){function l$n(){this.offset=0,this.startIndex=0,this._mat=l$q.create()}l$f(l$n,"laya.webgl.submit.SubmitOtherIBVB");var l$i=l$n.prototype;return l$l.imps(l$i,{"laya.webgl.submit.ISubmit":!0}),l$i.releaseRender=function(){var l$i=l$n._cache;(l$i[l$i._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},l$i.getRenderType=function(){return 10009},l$i.renderSubmit=function(){var l$i=this._shaderValue.textureHost;if(l$i){var l$_=l$i.source;if(!l$i.bitmap||!l$_)return 1;this._shaderValue.texture=l$_}this._vb.bind_upload(this._ib);var l$R=l$ti.worldMatrix4,l$r=l$q.TEMP;l$q.mulPre(this._mat,l$R[0],l$R[1],l$R[4],l$R[5],l$R[12],l$R[13],l$r);var l$b=l$ti.worldMatrix4=l$n.tempMatrix4;l$b[0]=l$r.a,l$b[1]=l$r.b,l$b[4]=l$r.c,l$b[5]=l$r.d,l$b[12]=l$r.tx,l$b[13]=l$r.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var l$z=l$ei.mainContext;return l$D.activeBlendFunction!==this._blendFn&&(l$z.enable(3042),this._blendFn(l$z),l$D.activeBlendFunction=this._blendFn),l$G.drawCall++,l$G.trianglesFaces+=this._numEle/3,l$z.drawElements(4,this._numEle,5123,this.startIndex),l$ti.worldMatrix4=l$R,l$Ki.activeShader=null,1},l$n.create=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){void 0===l$x&&(l$x=0);var l$P=l$n._cache._length?l$n._cache[--l$n._cache._length]:new l$n;l$P._ib=l$R,l$P._vb=l$_,l$P._numEle=l$r,l$P._shader=l$b,l$P._shaderValue=l$z;var l$B=l$i._nBlendType;switch(l$P._blendFn=l$i._targets?l$D.targetFns[l$B]:l$D.fns[l$B],l$x){case 0:l$P.offset=0,l$P.startIndex=l$w/(l$Mi.BYTES_PE*l$_.vertexStride)*1.5,l$P.startIndex*=l$Mi.BYTES_PIDX;break;case 1:l$P.startIndex=l$L,l$P.offset=l$w}return l$P},l$n._cache=((l$n._cache=[])._length=0,l$n._cache),l$n.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l$n}(),l$Pi=function(){function l$R(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new l$S,this.screenRect=new l$S}l$f(l$R,"laya.webgl.submit.SubmitScissor");var l$i=l$R.prototype;return l$l.imps(l$i,{"laya.webgl.submit.ISubmit":!0}),l$i._scissor=function(l$i,l$_,l$R,l$r){var l$b=l$ti.worldMatrix4,l$z=l$b[0],l$L=l$b[5],l$w=l$b[12],l$x=l$b[13];if(l$r*=l$L,(l$R*=l$z)<1||l$r<1)return!1;var l$P=(l$i=l$i*l$z+l$w)+l$R,l$B=(l$_=l$_*l$L+l$x)+l$r;l$i<0&&(l$R=l$P-(l$i=0)),l$_<0&&(l$r=l$B-(l$_=0));var l$n=l$ti.worldClipRect;if(l$i=Math.max(l$i,l$n.x),l$_=Math.max(l$_,l$n.y),l$R=Math.min(l$P,l$n.right)-l$i,l$r=Math.min(l$B,l$n.bottom)-l$_,l$R<1||l$r<1)return!1;var l$f=l$ti.worldScissorTest;return this.screenRect.copyFrom(l$n),l$n.x=l$i,l$n.y=l$_,l$n.width=l$R,l$n.height=l$r,l$ti.worldScissorTest=!0,l$_=l$ti.height-l$_-l$r,l$ei.mainContext.scissor(l$i,l$_,l$R,l$r),l$ei.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),l$f?(l$_=l$ti.height-this.screenRect.y-this.screenRect.height,l$ei.mainContext.scissor(this.screenRect.x,l$_,this.screenRect.width,this.screenRect.height),l$ei.mainContext.enable(3089)):(l$ei.mainContext.disable(3089),l$ti.worldScissorTest=!1),l$n.copyFrom(this.screenRect),!0},l$i._scissorWithTagart=function(l$i,l$_,l$R,l$r){if(l$R<1||l$r<1)return!1;var l$b=l$i+l$R,l$z=l$_+l$r;l$i<0&&(l$R=l$b-(l$i=0)),l$_<0&&(l$r=l$z-(l$_=0));var l$L=l$ti.worldClipRect;if(l$i=Math.max(l$i,l$L.x),l$_=Math.max(l$_,l$L.y),l$R=Math.min(l$b,l$L.right)-l$i,l$r=Math.min(l$z,l$L.bottom)-l$_,l$R<1||l$r<1)return!1;var l$w=l$ti.worldScissorTest;return this.screenRect.copyFrom(l$L),l$ti.worldScissorTest=!0,l$L.x=l$i,l$L.y=l$_,l$L.width=l$R,l$L.height=l$r,l$_=l$ti.height-l$_-l$r,l$ei.mainContext.scissor(l$i,l$_,l$R,l$r),l$ei.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),l$w?(l$_=l$ti.height-this.screenRect.y-this.screenRect.height,l$ei.mainContext.scissor(this.screenRect.x,l$_,this.screenRect.width,this.screenRect.height),l$ei.mainContext.enable(3089)):(l$ei.mainContext.disable(3089),l$ti.worldScissorTest=!1),l$L.copyFrom(this.screenRect),!0},l$i.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},l$i.getRenderType=function(){return 0},l$i.releaseRender=function(){var l$i=l$R._cache;(l$i[l$i._length++]=this).context=null},l$R.create=function(l$i){var l$_=l$R._cache._length?l$R._cache[--l$R._cache._length]:new l$R;return l$_.context=l$i,l$_},l$R._cache=((l$R._cache=[])._length=0,l$R._cache),l$R}(),l$Bi=function(){function l$x(){this.step=0,this.blendMode=null,this.level=0}l$f(l$x,"laya.webgl.submit.SubmitStencil");var l$i=l$x.prototype;return l$l.imps(l$i,{"laya.webgl.submit.ISubmit":!0}),l$i.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},l$i.getRenderType=function(){return 0},l$i.releaseRender=function(){var l$i=l$x._cache;l$i[l$i._length++]=this},l$i.do1=function(){var l$i=l$ei.mainContext;l$i.enable(2960),l$i.clear(1024),l$i.colorMask(!1,!1,!1,!1),l$i.stencilFunc(514,this.level,255),l$i.stencilOp(7680,7680,7682)},l$i.do2=function(){var l$i=l$ei.mainContext;l$i.stencilFunc(514,this.level+1,255),l$i.colorMask(!0,!0,!0,!0),l$i.stencilOp(7680,7680,7680)},l$i.do3=function(){var l$i=l$ei.mainContext;l$i.colorMask(!0,!0,!0,!0),l$i.stencilOp(7680,7680,7680),l$i.clear(1024),l$i.disable(2960)},l$i.do4=function(){var l$i=l$ei.mainContext;0==this.level&&(l$i.enable(2960),l$i.clear(1024)),l$i.colorMask(!1,!1,!1,!1),l$i.stencilFunc(519,0,255),l$i.stencilOp(7680,7680,7682)},l$i.do5=function(){var l$i=l$ei.mainContext;l$i.stencilFunc(514,this.level,255),l$i.colorMask(!0,!0,!0,!0),l$i.stencilOp(7680,7680,7680)},l$i.do6=function(){var l$i=l$ei.mainContext;l$D.targetFns[l$D.TOINT[this.blendMode]](l$i)},l$i.do7=function(){var l$i=l$ei.mainContext;l$i.colorMask(!1,!1,!1,!1),l$i.stencilOp(7680,7680,7683)},l$i.do8=function(){var l$i=l$ei.mainContext;l$i.colorMask(!0,!0,!0,!0),l$i.stencilFunc(514,this.level,255),l$i.stencilOp(7680,7680,7680)},l$x.restore=function(l$i,l$_,l$R,l$r,l$b){var l$z;if((l$i._renderKey=0)<l$x._mask&&l$x._mask--,0==l$x._mask)l$z=laya.webgl.submit.SubmitStencil.create(3),l$i.addRenderObject(l$z),l$i._curSubmit=l$zi.RENDERBASE;else{l$z=laya.webgl.submit.SubmitStencil.create(7),l$i.addRenderObject(l$z);var l$L=l$i._vb;l$L._byteLength;if(l$Ni.fillRectImgVb(l$L,null,l$_.x,l$_.y,l$_.width,l$_.height,l$k.DEF_UV,l$R,l$r,l$b,0,0)){l$i._shader2D.glTexture=null;var l$w=l$i._curSubmit=l$zi.createSubmit(l$i,l$i._ib,l$L,(l$L._byteLength-64)/32*3,l$Zi.create(2,0));l$w.shaderValue.ALPHA=1,l$i._submits[l$i._submits._length++]=l$w,l$i._curSubmit._numEle+=6,l$i._curSubmit=l$zi.RENDERBASE}else alert("clipRect calc stencil rect error");l$z=laya.webgl.submit.SubmitStencil.create(8),l$i.addRenderObject(l$z)}},l$x.restore2=function(l$i,l$_){var l$R;(l$i._renderKey=0)<l$x._mask&&l$x._mask--,0==l$x._mask?(l$R=laya.webgl.submit.SubmitStencil.create(3),l$i.addRenderObject(l$R),l$i._curSubmit=l$zi.RENDERBASE):(l$R=laya.webgl.submit.SubmitStencil.create(7),l$i.addRenderObject(l$R),l$i._submits[l$i._submits._length++]=l$_,l$R=laya.webgl.submit.SubmitStencil.create(8),l$i.addRenderObject(l$R))},l$x.create=function(l$i){var l$_=l$x._cache._length?l$x._cache[--l$x._cache._length]:new l$x;return 5==(l$_.step=l$i)&&++l$x._mask,l$_.level=l$x._mask,l$_},l$x._cache=((l$x._cache=[])._length=0,l$x._cache),l$x._mask=0,l$x}(),l$ni=function(){function l$w(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}l$f(l$w,"laya.webgl.submit.SubmitTarget");var l$i=l$w.prototype;return l$l.imps(l$i,{"laya.webgl.submit.ISubmit":!0}),l$i.renderSubmit=function(){this._vb.bind_upload(this._ib);var l$i=this.scope.getValue(this.proName);return l$i&&(this.shaderValue.texture=l$i.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[l$i.width,l$i.height]),this.shaderValue.upload(),this.blend(),l$G.drawCall++,l$G.trianglesFaces+=this._numEle/3,l$ei.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},l$i.blend=function(){if(l$D.activeBlendFunction!==l$D.fns[this.blendType]){var l$i=l$ei.mainContext;l$i.enable(3042),l$D.fns[this.blendType](l$i),l$D.activeBlendFunction=l$D.fns[this.blendType]}},l$i.getRenderType=function(){return 0},l$i.releaseRender=function(){var l$i=l$w._cache;(l$i[l$i._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},l$w.create=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=l$w._cache._length?l$w._cache[--l$w._cache._length]:new l$w;return l$L._ib=l$_,l$L._vb=l$R,l$L.proName=l$z,l$L._startIdx=l$r*l$Mi.BYTES_PIDX,l$L._numEle=0,l$L.blendType=l$i._nBlendType,l$L.shaderValue=l$b,l$L.shaderValue.setValue(l$i._shader2D),l$L},l$w._cache=((l$w._cache=[])._length=0,l$w._cache),l$w}(),l$fi=function(){function l$i(){this._sourceStr=null}l$f(l$i,"laya.webgl.text.CharSegment");var l$_=l$i.prototype;return l$l.imps(l$_,{"laya.webgl.text.ICharSegment":!0}),l$_.textToSpit=function(l$i){this._sourceStr=l$i},l$_.getChar=function(l$i){return this._sourceStr.charAt(l$i)},l$_.getCharCode=function(l$i){return this._sourceStr.charCodeAt(l$i)},l$_.length=function(){return this._sourceStr.length},l$i}(),l$Ji=function(){var l$i;function l$G(){}return l$f(l$G,"laya.webgl.text.DrawText"),l$G.__init__=function(){l$G._charsTemp=new Array,l$G._drawValue=new l$i,l$G._charSeg=new l$fi},l$G.customCharSeg=function(l$i){l$G._charSeg=l$i},l$G.getChar=function(l$i,l$_,l$R){var l$r=l$Vi.createOneChar(l$i,l$R);return-1!=l$_&&(l$G._charsCache[l$_]=l$r),l$r},l$G._drawSlow=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$n,l$f,l$J,l$h){var l$M,l$N,l$X=l$G._drawValue.value(l$z,l$w,l$x,l$P,l$f,l$J,l$h),l$t=0,l$I=0,l$e=l$G._charsTemp,l$c=0,l$l=NaN;if(l$r)for(l$e.length=l$r.length,l$t=0,l$I=l$r.length;l$t<l$I;l$t++)(l$N=l$r[l$t])&&(l$l=l$N.charNum+l$X.txtID,l$e[l$t]=l$M=l$G._charsCache[l$l]||l$G.getChar(l$N.char,l$l,l$X),l$M.active());else{var l$A=l$R instanceof laya.utils.WordText?l$R.toString():l$R;if(l$p.CharacterCache){l$G._charSeg.textToSpit(l$A);var l$Z=l$G._charSeg.length();for(l$t=0,l$I=l$e.length=l$Z;l$t<l$I;l$t++)l$l=l$G._charSeg.getCharCode(l$t)+l$X.txtID,l$e[l$t]=l$M=l$G._charsCache[l$l]||l$G.getChar(l$G._charSeg.getChar(l$t),l$l,l$X),l$M.active(),l$c+=l$M.cw}else l$e.length=0,(l$M=l$G.getChar(l$A,-1,l$X)).active(),l$c+=l$M.cw,l$e[0]=l$M}var l$q=0;null!==l$L&&"left"!==l$L&&(l$q=-("center"==l$L?l$c/2:l$c));var l$j,l$S,l$v=NaN,l$$=0;if(l$r)for(l$t=0,l$I=l$e.length;l$t<l$I;l$t++)l$M=l$e[l$t],l$N=l$r[l$t],l$M&&l$N&&!l$M.isSpace&&(l$v=l$M.borderSize,l$j=l$M.texture,l$_._drawText(l$j,l$B+l$q+l$N.x*l$f-l$v,l$n+l$N.y*l$J-l$v,l$j.width,l$j.height,l$b,0,0,0,0));else{for(l$t=0,l$I=l$e.length;l$t<l$I;l$t++)(l$M=l$e[l$t])&&!l$M.isSpace&&(l$v=l$M.borderSize,l$j=l$M.texture,l$_._drawText(l$j,l$B+l$q-l$v,l$n-l$v,l$j.width,l$j.height,l$b,0,0,0,0),l$i&&((l$S=l$i[l$$++])||(l$S=l$i[l$$-1]=[]),l$S[0]=l$j,l$S[1]=l$q-l$v,l$S[2]=-l$v)),l$q+=l$M.cw;l$i&&(l$i.length=l$$)}},l$G._drawFast=function(l$i,l$_,l$R,l$r,l$b){for(var l$z,l$L,l$w=0,l$x=l$i.length;l$w<l$x;l$w++)(l$z=(l$L=l$i[l$w])[0]).active(),l$_._drawText(l$z,l$r+l$L[1],l$b+l$L[2],l$z.width,l$z.height,l$R,0,0,0,0)},l$G.drawText=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$n){if(void 0===l$n&&(l$n=0),!(l$_&&0===l$_.length||l$R&&0===l$R.length)){var l$f=l$r.a,l$J=l$r.d;(0!==l$r.b||0!==l$r.c)&&(l$f=l$J=1);var l$h=1!==l$f||1!==l$J;if(l$h&&l$l.stage.transform){var l$M=l$l.stage.transform;l$h=l$M.a===l$f&&l$M.d===l$J}else l$h=!1;if(l$h){var l$N=(l$r=l$r.copyTo(l$Ai._tmpMatrix)).tx,l$X=l$r.ty;l$r.scale(1/l$f,1/l$J),l$r._checkTransform(),l$P*=l$f,l$B*=l$J,l$P+=l$N-l$r.tx,l$B+=l$X-l$r.ty}else l$f=l$J=1;if(l$R)l$G._drawSlow(null,l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$f,l$J,l$n);else{if(null===l$_.toUpperCase){var l$t=l$f+1e5*l$J,l$I=l$_;return void(l$I.changed||l$I.id!==l$t?(l$I.id=l$t,l$I.changed=!1,l$G._drawSlow(l$I.save,l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$f,l$J,l$n)):l$G._drawFast(l$I.save,l$i,l$r,l$P,l$B))}var l$e=l$_+l$b.toString()+l$L+l$w+l$x+l$f+l$J+l$z,l$c=l$G._textsCache[l$e];l$p.CharacterCache?l$c?l$G._drawFast(l$c,l$i,l$r,l$P,l$B):(l$G._textsCache.__length||(l$G._textsCache.__length=0),l$G._textsCache.__length>l$A.WebGLTextCacheCount&&((l$G._textsCache={}).__length=0,l$G._curPoolIndex=0),l$G._textCachesPool[l$G._curPoolIndex]?(l$c=l$G._textsCache[l$e]=l$G._textCachesPool[l$G._curPoolIndex]).length=0:l$G._textCachesPool[l$G._curPoolIndex]=l$c=l$G._textsCache[l$e]=[],l$G._textsCache.__length++,l$G._curPoolIndex++,l$G._drawSlow(l$c,l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$f,l$J,l$n)):l$G._drawSlow(l$c,l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$f,l$J,l$n)}}},l$G._charsTemp=null,l$G._textCachesPool=[],l$G._curPoolIndex=0,l$G._charsCache={},l$G._textsCache={},l$G._drawValue=null,l$G.d=[],l$G._charSeg=null,l$G.__init$=function(){l$i=function(){function l$x(){}return l$f(l$x,""),l$x.prototype.value=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this.font=l$i,this.fillColor=l$_,this.borderColor=l$R,this.lineWidth=l$r,this.scaleX=l$b,this.scaleY=l$z,this.underLine=l$L;var l$w=l$i.toString()+l$b+l$z+l$r+(l$_?l$_.toLowerCase():" ")+(l$R?l$R.toLowerCase():" ")+l$L;return this.txtID=l$x._keymap[l$w],this.txtID||(this.txtID=1e-7*++l$x._keymapCount,l$x._keymap[l$w]=this.txtID),this},l$x.clear=function(){l$x._keymap={},l$x._keymapCount=1},l$x._keymap={},l$x._keymapCount=1,l$x}()},l$G}(),l$hi=function(){function l$b(l$i){this._index=0,this._size=14,this._italic=-2,l$b._cache2=l$b._cache2||[],this.setFont(l$i||"14px Arial")}l$f(l$b,"laya.webgl.text.FontInContext");var l$i=l$b.prototype;return l$i.setFont=function(l$i){var l$_=l$b._cache2[l$i];if(l$_)this._words=l$_[0],this._size=l$_[1];else{this._words=l$i.split(" ");for(var l$R=0,l$r=this._words.length;l$R<l$r;l$R++)if(0<this._words[l$R].indexOf("px")){this._index=l$R;break}this._size=parseInt(this._words[this._index]),l$b._cache2[l$i]=[this._words,this._size]}this._text=null,this._italic=-2},l$i.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},l$i.hasType=function(l$i){for(var l$_=0,l$R=this._words.length;l$_<l$R;l$_++)if(this._words[l$_]===l$i)return l$_;return-1},l$i.removeType=function(l$i){for(var l$_=0,l$R=this._words.length;l$_<l$R;l$_++)if(this._words[l$_]===l$i){this._words.splice(l$_,1),this._index>l$_&&this._index--;break}this._text=null,this._italic=-2},l$i.copyTo=function(l$i){return l$i._text=this._text,l$i._size=this._size,l$i._index=this._index,l$i._words=this._words.slice(),l$i._italic=-2,l$i},l$i.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},l$r(0,l$i,"size",function(){return this._size},function(l$i){this._size=l$i,this._words[this._index]=l$i+"px",this._text=null}),l$b.create=function(l$i){var l$_=l$b._cache[l$i];return l$_||(l$_=l$b._cache[l$i]=new l$b(l$i))},l$b.EMPTY=new l$b,l$b._cache={},l$b._cache2=null,l$b}(),l$Mi=function(){function l$i(){}return l$f(l$i,"laya.webgl.utils.CONST3D2D"),l$i.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l$i.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],l$i.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],l$i._TMPARRAY=[],l$i._OFFSETX=0,l$i._OFFSETY=0,l$L(l$i,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),l$i}(),l$Ni=function(){function l$h(){}return l$f(l$h,"laya.webgl.utils.GlUtils"),l$h.make2DProjection=function(l$i,l$_,l$R){return[2/l$i,0,0,0,0,-2/l$_,0,0,0,0,2/l$R,0,-1,1,0,1]},l$h.fillIBQuadrangle=function(l$i,l$_){if(65535/4<l$_)throw Error("IBQuadrangle count:"+l$_+" must<:"+Math.floor(65535/4));l$_=Math.floor(l$_),l$i._resizeBuffer(6*(l$_+1)*2,!1),l$i.byteLength=l$i.bufferLength;for(var l$R=l$i.getUint16Array(),l$r=0,l$b=0;l$b<l$_;l$b++)l$R[l$r++]=4*l$b,l$R[l$r++]=4*l$b+2,l$R[l$r++]=4*l$b+1,l$R[l$r++]=4*l$b,l$R[l$r++]=4*l$b+3,l$R[l$r++]=4*l$b+2;return l$i.setNeedUpload(),!0},l$h.expandIBQuadrangle=function(l$i,l$_){l$i.bufferLength>=6*l$_*2||l$h.fillIBQuadrangle(l$i,l$_)},l$h.mathCeilPowerOfTwo=function(l$i){return l$i--,l$i|=l$i>>1,l$i|=l$i>>2,l$i|=l$i>>4,l$i|=l$i>>8,l$i|=l$i>>16,++l$i},l$h.fillQuadrangleImgVb=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){var l$x=16+(l$i._byteLength>>2);l$i.byteLength=l$x<<2;var l$P=l$i.getFloat32Array();l$P[(l$x-=16)+2]=l$b[0],l$P[l$x+3]=l$b[1],l$P[l$x+6]=l$b[2],l$P[l$x+7]=l$b[3],l$P[l$x+10]=l$b[4],l$P[l$x+11]=l$b[5],l$P[l$x+14]=l$b[6],l$P[l$x+15]=l$b[7];var l$B=l$z.a,l$n=l$z.b,l$f=l$z.c,l$J=l$z.d;if(1!==l$B||0!==l$n||0!==l$f||1!==l$J){l$z.bTransform=!0;var l$h=l$z.tx+l$L,l$M=l$z.ty+l$w;l$P[l$x]=(l$r[0]+l$_)*l$B+(l$r[1]+l$R)*l$f+l$h,l$P[l$x+1]=(l$r[0]+l$_)*l$n+(l$r[1]+l$R)*l$J+l$M,l$P[l$x+4]=(l$r[2]+l$_)*l$B+(l$r[3]+l$R)*l$f+l$h,l$P[l$x+5]=(l$r[2]+l$_)*l$n+(l$r[3]+l$R)*l$J+l$M,l$P[l$x+8]=(l$r[4]+l$_)*l$B+(l$r[5]+l$R)*l$f+l$h,l$P[l$x+9]=(l$r[4]+l$_)*l$n+(l$r[5]+l$R)*l$J+l$M,l$P[l$x+12]=(l$r[6]+l$_)*l$B+(l$r[7]+l$R)*l$f+l$h,l$P[l$x+13]=(l$r[6]+l$_)*l$n+(l$r[7]+l$R)*l$J+l$M}else l$z.bTransform=!1,l$_+=l$z.tx+l$L,l$R+=l$z.ty+l$w,l$P[l$x]=l$_+l$r[0],l$P[l$x+1]=l$R+l$r[1],l$P[l$x+4]=l$_+l$r[2],l$P[l$x+5]=l$R+l$r[3],l$P[l$x+8]=l$_+l$r[4],l$P[l$x+9]=l$R+l$r[5],l$P[l$x+12]=l$_+l$r[6],l$P[l$x+13]=l$R+l$r[7];return l$i._upload=!0},l$h.fillTranglesVB=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){var l$w=(l$i._byteLength>>2)+l$r.length;l$i.byteLength=l$w<<2;var l$x=l$i.getFloat32Array();l$w-=l$r.length;for(var l$P=l$r.length,l$B=l$b.a,l$n=l$b.b,l$f=l$b.c,l$J=l$b.d,l$h=0;l$h<l$P;l$h+=4)if(l$x[l$w+l$h+2]=l$r[l$h+2],l$x[l$w+l$h+3]=l$r[l$h+3],1!==l$B||0!==l$n||0!==l$f||1!==l$J){l$b.bTransform=!0;var l$M=l$b.tx+l$z,l$N=l$b.ty+l$L;l$x[l$w+l$h]=(l$r[l$h]+l$_)*l$B+(l$r[l$h+1]+l$R)*l$f+l$M,l$x[l$w+l$h+1]=(l$r[l$h]+l$_)*l$n+(l$r[l$h+1]+l$R)*l$J+l$N}else l$b.bTransform=!1,l$_+=l$b.tx+l$z,l$R+=l$b.ty+l$L,l$x[l$w+l$h]=l$_+l$r[l$h],l$x[l$w+l$h+1]=l$R+l$r[l$h+1];return l$i._upload=!0},l$h.copyPreImgVb=function(l$i,l$_,l$R){var l$r=l$i._byteLength>>2;l$i.byteLength=l$r+16<<2;for(var l$b=l$i.getFloat32Array(),l$z=0,l$L=l$r-16;l$z<4;l$z++)l$b[l$r]=l$b[l$L]+l$_,++l$L,l$b[++l$r]=l$b[l$L]+l$R,++l$L,l$b[++l$r]=l$b[l$L],++l$L,l$b[++l$r]=l$b[l$L],++l$r,++l$L;l$i._upload=!0},l$h.fillRectImgVb=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$n,l$f){void 0===l$f&&(l$f=!1);var l$J,l$h,l$M,l$N,l$X,l$t,l$I,l$e,l$c,l$l,l$A,l$Z,l$q,l$j,l$S,l$v,l$$=1,l$G=l$w.a,l$u=l$w.b,l$o=l$w.c,l$p=l$w.d,l$k=l$_&&l$_.width<99999999;if(1!==l$G||0!==l$u||0!==l$o||1!==l$p?(l$w.bTransform=!0,0===l$u&&0===l$o&&(l$$=23,l$c=l$b+l$R,l$l=l$z+l$r,l$J=l$G*l$R+(l$A=l$w.tx+l$x),l$M=l$G*l$c+l$A,l$h=l$p*l$r+(l$Z=l$w.ty+l$P),l$N=l$p*l$l+l$Z)):(l$$=23,l$w.bTransform=!1,l$M=(l$J=l$R+l$w.tx+l$x)+l$b,l$N=(l$h=l$r+l$w.ty+l$P)+l$z),l$k&&(l$X=l$_.x,l$t=l$_.y,l$I=l$_.width+l$X,l$e=l$_.height+l$t),1!==l$$){if(Math.min(l$J,l$M)>=l$I)return!1;if(Math.min(l$h,l$N)>=l$e)return!1;if(Math.max(l$M,l$J)<=l$X)return!1;if(Math.max(l$N,l$h)<=l$t)return!1}var l$K=l$i._byteLength>>2;l$i.byteLength=16+l$K<<2;var l$O=l$i.getFloat32Array();switch(l$O[2+l$K]=l$L[0],l$O[3+l$K]=l$L[1],l$O[6+l$K]=l$L[2],l$O[7+l$K]=l$L[3],l$O[10+l$K]=l$L[4],l$O[11+l$K]=l$L[5],l$O[14+l$K]=l$L[6],l$O[15+l$K]=l$L[7],l$$){case 1:l$A=l$w.tx+l$x,l$Z=l$w.ty+l$P;var l$E=l$G*l$R,l$s=l$o*l$r,l$Y=l$p*l$r,l$C=l$u*l$R,l$m=l$G*(l$c=l$b+l$R),l$D=l$o*(l$l=l$z+l$r),l$U=l$p*l$l,l$g=l$u*l$c;l$f?(l$q=l$E+l$s+l$A,l$S=Math.round(l$q)-l$q,l$j=l$Y+l$C+l$Z,l$v=Math.round(l$j)-l$j,l$O[l$K]=l$q+l$S,l$O[1+l$K]=l$j+l$v,l$O[4+l$K]=l$m+l$s+l$A+l$S,l$O[5+l$K]=l$Y+l$g+l$Z+l$v,l$O[8+l$K]=l$m+l$D+l$A+l$S,l$O[9+l$K]=l$U+l$g+l$Z+l$v,l$O[12+l$K]=l$E+l$D+l$A+l$S,l$O[13+l$K]=l$U+l$C+l$Z+l$v):(l$O[l$K]=l$E+l$s+l$A,l$O[1+l$K]=l$Y+l$C+l$Z,l$O[4+l$K]=l$m+l$s+l$A,l$O[5+l$K]=l$Y+l$g+l$Z,l$O[8+l$K]=l$m+l$D+l$A,l$O[9+l$K]=l$U+l$g+l$Z,l$O[12+l$K]=l$E+l$D+l$A,l$O[13+l$K]=l$U+l$C+l$Z);break;case 23:l$f?(l$q=l$J+l$B,l$S=Math.round(l$q)-l$q,l$j=l$h,l$v=Math.round(l$j)-l$j,l$O[l$K]=l$q+l$S,l$O[1+l$K]=l$j+l$v,l$O[4+l$K]=l$M+l$B+l$S,l$O[5+l$K]=l$h+l$v,l$O[8+l$K]=l$M+l$S,l$O[9+l$K]=l$N+l$v,l$O[12+l$K]=l$J+l$S,l$O[13+l$K]=l$N+l$v):(l$O[l$K]=l$J+l$B,l$O[1+l$K]=l$h,l$O[4+l$K]=l$M+l$B,l$O[5+l$K]=l$h,l$O[8+l$K]=l$M,l$O[9+l$K]=l$N,l$O[12+l$K]=l$J,l$O[13+l$K]=l$N)}return l$i._upload=!0},l$h.fillLineVb=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){var l$x=.5*l$L,l$P=l$h._fillLineArray,l$B=-(l$r-l$z),l$n=l$R-l$b,l$f=Math.sqrt(l$B*l$B+l$n*l$n);l$B/=l$f,l$n/=l$f,l$B*=l$x,l$n*=l$x,l$P[0]=l$R-l$B,l$P[1]=l$r-l$n,l$P[4]=l$R+l$B,l$P[5]=l$r+l$n,l$P[8]=l$b+l$B,l$P[9]=l$z+l$n,l$P[12]=l$b-l$B,l$P[13]=l$z-l$n,l$w&&l$w.transformPointArray(l$P,l$P);var l$J=16+(l$i._byteLength>>2);return l$i.byteLength=l$J<<2,l$i.insertData(l$P,l$J-16),!0},l$h._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l$h}(),l$Xi=(function(){function l$x(){}l$f(l$x,"laya.webgl.utils.MatirxArray"),l$x.ArrayMul=function(l$i,l$_,l$R){if(l$i)if(l$_)for(var l$r=NaN,l$b=NaN,l$z=NaN,l$L=NaN,l$w=0;l$w<4;l$w++)l$r=l$i[l$w],l$b=l$i[l$w+4],l$z=l$i[l$w+8],l$L=l$i[l$w+12],l$R[l$w]=l$r*l$_[0]+l$b*l$_[1]+l$z*l$_[2]+l$L*l$_[3],l$R[l$w+4]=l$r*l$_[4]+l$b*l$_[5]+l$z*l$_[6]+l$L*l$_[7],l$R[l$w+8]=l$r*l$_[8]+l$b*l$_[9]+l$z*l$_[10]+l$L*l$_[11],l$R[l$w+12]=l$r*l$_[12]+l$b*l$_[13]+l$z*l$_[14]+l$L*l$_[15];else l$x.copyArray(l$i,l$R);else l$x.copyArray(l$_,l$R)},l$x.copyArray=function(l$i,l$_){if(l$i&&l$_)for(var l$R=0;l$R<l$i.length;l$R++)l$_[l$R]=l$i[l$R]}}(),function(){function l$_(l$i,l$_,l$R){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=l$i,this._vb=new l$Ti(l$i,35048),l$_&&this._vb._resizeBuffer(l$_,!1),this._ib=new l$Wi,l$R&&this._ib._resizeBuffer(l$R,!1)}l$f(l$_,"laya.webgl.utils.Mesh2D");var l$i=l$_.prototype;return l$i.cloneWithNewVB=function(){var l$i=new l$_(this._stride,0,0);return l$i._ib=this._ib,l$i._quadNum=this._quadNum,l$i._attribInfo=this._attribInfo,l$i},l$i.cloneWithNewVBIB=function(){var l$i=new l$_(this._stride,0,0);return l$i._attribInfo=this._attribInfo,l$i},l$i.getVBW=function(){return this._vb.setNeedUpload(),this._vb},l$i.getVBR=function(){return this._vb},l$i.getIBR=function(){return this._ib},l$i.getIBW=function(){return this._ib.setNeedUpload(),this._ib},l$i.createQuadIB=function(l$i){this._quadNum=l$i,this._ib._resizeBuffer(6*l$i*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var l$_=this._ib.getUint16Array(),l$R=0,l$r=0,l$b=0;l$b<l$i;l$b++)l$_[l$R++]=l$r,l$_[l$R++]=l$r+2,l$_[l$R++]=l$r+1,l$_[l$R++]=l$r,l$_[l$R++]=l$r+3,l$_[l$R++]=l$r+2,l$r+=4;this._ib.setNeedUpload()},l$i.setAttributes=function(l$i){if(this._attribInfo=l$i,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},l$i.getEleNum=function(){return this._ib.getBuffer().byteLength/2},l$i.releaseMesh=function(){},l$i.destroy=function(){},l$i.clearVB=function(){this._vb.clear()},l$_._gvaoid=0,l$_}()),l$ti=function(){function l$b(){}return l$f(l$b,"laya.webgl.utils.RenderState2D"),l$b.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},l$b.mat2MatArray=function(l$i,l$_){var l$R=l$i,l$r=l$_;return l$r[0]=l$R.a,l$r[1]=l$R.b,l$r[2]=l$b.EMPTYMAT4_ARRAY[2],l$r[3]=l$b.EMPTYMAT4_ARRAY[3],l$r[4]=l$R.c,l$r[5]=l$R.d,l$r[6]=l$b.EMPTYMAT4_ARRAY[6],l$r[7]=l$b.EMPTYMAT4_ARRAY[7],l$r[8]=l$b.EMPTYMAT4_ARRAY[8],l$r[9]=l$b.EMPTYMAT4_ARRAY[9],l$r[10]=l$b.EMPTYMAT4_ARRAY[10],l$r[11]=l$b.EMPTYMAT4_ARRAY[11],l$r[12]=l$R.tx,l$r[13]=l$R.ty,l$r[14]=l$b.EMPTYMAT4_ARRAY[14],l$r[15]=l$b.EMPTYMAT4_ARRAY[15],l$_},l$b.restoreTempArray=function(){l$b.TEMPMAT4_ARRAY[0]=1,l$b.TEMPMAT4_ARRAY[1]=0,l$b.TEMPMAT4_ARRAY[4]=0,l$b.TEMPMAT4_ARRAY[5]=1,l$b.TEMPMAT4_ARRAY[12]=0,l$b.TEMPMAT4_ARRAY[13]=0},l$b.clear=function(){l$b.worldScissorTest=!1,l$b.worldShaderDefines=null,l$b.worldFilters=null,l$b.worldAlpha=1,l$b.worldClipRect.x=l$b.worldClipRect.y=0,l$b.worldClipRect.width=l$b.width,l$b.worldClipRect.height=l$b.height,l$b.curRenderTarget=null},l$b._MAXSIZE=99999999,l$b.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l$b.worldMatrix4=l$b.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l$b.worldAlpha=1,l$b.worldScissorTest=!1,l$b.worldFilters=null,l$b.worldShaderDefines=null,l$b.curRenderTarget=null,l$b.width=0,l$b.height=0,l$L(l$b,["worldMatrix",function(){return this.worldMatrix=new l$q},"worldClipRect",function(){return this.worldClipRect=new l$S(0,0,99999999,99999999)}]),l$b}(),l$Ii=function(){var l$t,l$R;function l$I(l$i,l$_,l$R,l$r,l$b){var l$z=this;function l$L(l$i){var l$_=[],l$R=new l$t(l$_);return l$z._compileToTree(l$R,l$i.split("\n"),0,l$_,l$b),l$R}var l$w=l$J.now();this._VS=l$L(l$_),this._PS=l$L(l$R),this._nameMap=l$r,2<l$J.now()-l$w&&console.log("ShaderCompile use time:"+(l$J.now()-l$w)+"  size:"+l$_.length+"/"+l$R.length)}l$f(l$I,"laya.webgl.utils.ShaderCompile");var l$i=l$I.prototype;return l$i._compileToTree=function(l$i,l$_,l$R,l$r,l$b){var l$z,l$L,l$w,l$x,l$P,l$B,l$n,l$f=0,l$J=0,l$h=0,l$M=0;for(l$J=l$R;l$J<l$_.length;l$J++)if(!((l$w=l$_[l$J]).length<1)&&0!==(l$f=l$w.indexOf("//"))){if(0<=l$f&&(l$w=l$w.substr(0,l$f)),l$z=l$n||new l$t(l$r),l$n=null,l$z.text=l$w,l$z.noCompile=!0,0<=(l$f=l$w.indexOf("#"))){for(l$x="#",l$M=l$f+1,l$h=l$w.length;l$M<l$h;l$M++){var l$N=l$w.charAt(l$M);if(" "===l$N||"\t"===l$N||"\r"===l$N||"\n"===l$N||"?"===l$N)break;l$x+=l$N}switch(l$z.name=l$x){case"#ifdef":case"#ifndef":if(l$z.src=l$w,l$z.noCompile=null!=l$w.match(/[!&|()=<>]/),l$z.noCompile?console.log("function():Boolean{return "+l$w.substr(l$f+l$z.name.length)+"}"):(l$B=l$w.replace(/^\s*/,"").split(/\s+/),l$z.setCondition(l$B[1],"#ifdef"===l$x?1:2),l$z.text="//"+l$z.text),l$z.setParent(l$i),l$i=l$z,l$b)for(l$B=l$w.substr(l$M).split(l$I._splitToWordExps3),l$M=0;l$M<l$B.length;l$M++)(l$w=l$B[l$M]).length&&(l$b[l$w]=!0);continue;case"#if":if(l$z.src=l$w,l$z.noCompile=!0,l$z.setParent(l$i),l$i=l$z,l$b)for(l$B=l$w.substr(l$M).split(l$I._splitToWordExps3),l$M=0;l$M<l$B.length;l$M++)(l$w=l$B[l$M]).length&&"defined"!=l$w&&(l$b[l$w]=!0);continue;case"#else":l$z.src=l$w,l$L=(l$i=l$i.parent).childs[l$i.childs.length-1],l$z.noCompile=l$L.noCompile,l$z.noCompile||(l$z.condition=l$L.condition,l$z.conditionType=1==l$L.conditionType?2:1,l$z.text="//"+l$z.text+" "+l$L.text+" "+l$z.conditionType),l$z.setParent(l$i),l$i=l$z;continue;case"#endif":l$L=(l$i=l$i.parent).childs[l$i.childs.length-1],l$z.noCompile=l$L.noCompile,l$z.noCompile||(l$z.text="//"+l$z.text),l$z.setParent(l$i);continue;case"#include":l$B=l$I.splitToWords(l$w,null);var l$X=l$I.includes[l$B[1]];if(!l$X)throw"ShaderCompile error no this include file:"+l$B[1];if((l$f=l$B[0].indexOf("?"))<0){l$z.setParent(l$i),l$w=l$X.getWith("with"==l$B[2]?l$B[3]:null),this._compileToTree(l$z,l$w.split("\n"),0,l$r,l$b),l$z.text="";continue}l$z.setCondition(l$B[0].substr(l$f+1),1),l$z.text=l$X.getWith("with"==l$B[2]?l$B[3]:null);break;case"#import":l$P=(l$B=l$I.splitToWords(l$w,null))[1],l$r.push({node:l$z,file:l$I.includes[l$P],ofs:l$z.text.length});continue}}else{if((l$L=l$i.childs[l$i.childs.length-1])&&!l$L.name){0<l$r.length&&l$I.splitToWords(l$w,l$L),l$n=l$z,l$L.text+="\n"+l$w;continue}0<l$r.length&&l$I.splitToWords(l$w,l$z)}l$z.setParent(l$i)}},l$i.createShader=function(l$i,l$_,l$R){var l$r={},l$b="";if(l$i)for(var l$z in l$i)l$b+="#define "+l$z+"\n",l$r[l$z]=!0;var l$L=this._VS.toscript(l$r,[]),l$w=this._PS.toscript(l$r,[]);return(l$R||l$Fi.create)(l$b+l$L.join("\n"),l$b+l$w.join("\n"),l$_,this._nameMap)},l$I._parseOne=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L={type:l$I.shaderParamsMap[l$R[l$r+1]],name:l$R[l$r+2],size:isNaN(parseInt(l$R[l$r+3]))?1:parseInt(l$R[l$r+3])};return l$z&&("attribute"==l$b?l$i.push(l$L):l$_.push(l$L)),":"==l$R[l$r+3]&&(l$L.type=l$R[l$r+4],l$r+=2),l$r+=2},l$I.addInclude=function(l$i,l$_){if(!l$_||0===l$_.length)throw new Error("add shader include file err:"+l$i);if(l$I.includes[l$i])throw new Error("add shader include file err, has add:"+l$i);l$I.includes[l$i]=new l$R(l$_)},l$I.preGetParams=function(l$i,l$_){var l$R=[l$i,l$_],l$r={},l$b=[],l$z=[],l$L={},l$w=[];l$r.attributes=l$b,l$r.uniforms=l$z,l$r.defines=l$L;for(var l$x=0,l$P=0,l$B=0;l$B<2;l$B++){l$R[l$B]=l$R[l$B].replace(l$I._removeAnnotation,"");var l$n,l$f=l$R[l$B].match(l$I._reg);for(l$x=0,l$P=l$f.length;l$x<l$P;l$x++){var l$J=l$f[l$x];if("attribute"==l$J||"uniform"==l$J)l$x=l$I._parseOne(l$b,l$z,l$f,l$x,l$J,!0);else{if("#define"==l$J){l$w[l$J=l$f[++l$x]]=1;continue}if("#ifdef"==l$J){l$L[l$n=l$f[++l$x]]=l$L[l$n]||[];for(l$x++;l$x<l$P;l$x++)if("attribute"==(l$J=l$f[l$x])||"uniform"==l$J)l$x=l$I._parseOne(l$b,l$z,l$f,l$x,l$J,l$w[l$n]);else if("#else"==l$J)for(l$x++;l$x<l$P;l$x++)if("attribute"==(l$J=l$f[l$x])||"uniform"==l$J)l$x=l$I._parseOne(l$b,l$z,l$f,l$x,l$J,!l$w[l$n]);else if("#endif"==l$J)break}}}}return l$r},l$I.splitToWords=function(l$i,l$_){for(var l$R,l$r,l$b=[],l$z=-1,l$L=0,l$w=l$i.length;l$L<l$w;l$L++)if(l$R=l$i.charAt(l$L),0<=" \t=+-*/&%!<>()'\",;".indexOf(l$R)){if(0<=l$z&&1<l$L-l$z&&(l$r=l$i.substr(l$z,l$L-l$z),l$b.push(l$r)),'"'==l$R||"'"==l$R){var l$x=l$i.indexOf(l$R,l$L+1);if(l$x<0)throw"Sharder err:"+l$i;l$b.push(l$i.substr(l$L+1,l$x-l$L-1)),l$L=l$x,l$z=-1;continue}"("==l$R&&l$_&&0<l$b.length&&(l$r=l$b[l$b.length-1]+";","vec4;main;".indexOf(l$r)<0&&(l$_.useFuns+=l$r)),l$z=-1}else l$z<0&&(l$z=l$L);return l$z<l$w&&1<l$w-l$z&&(l$r=l$i.substr(l$z,l$w-l$z),l$b.push(l$r)),l$b},l$I.IFDEF_NO=0,l$I.IFDEF_YES=1,l$I.IFDEF_ELSE=2,l$I.IFDEF_PARENT=3,l$I._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),l$I._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),l$I._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),l$I.includes={},l$L(l$I,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),l$I.__init$=function(){l$t=function(){function l$R(l$i){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=l$i}l$f(l$R,"");var l$i=l$R.prototype;return l$i.setParent=function(l$i){l$i.childs.push(this),this.z=l$i.z+1,this.parent=l$i},l$i.setCondition=function(l$i,l$_){l$i&&(this.conditionType=l$_,l$i=l$i.replace(/(\s*$)/g,""),this.condition=function(){return this[l$i]},this.condition.__condition=l$i)},l$i.toscript=function(l$i,l$_){return this._toscript(l$i,l$_,++l$R.__id)},l$i._toscript=function(l$r,l$b,l$z){if(this.childs.length<1&&!this.text)return l$b;l$b.length;if(this.condition){var l$i=!!this.condition.call(l$r);if(2===this.conditionType&&(l$i=!l$i),!l$i)return l$b}if(this.text&&l$b.push(this.text),0<this.childs.length&&this.childs.forEach(function(l$i,l$_,l$R){l$i._toscript(l$r,l$b,l$z)}),0<this.includefiles.length&&0<this.useFuns.length)for(var l$_,l$R=0,l$L=this.includefiles.length;l$R<l$L;l$R++)this.includefiles[l$R].curUseID!=l$z&&0<(l$_=this.includefiles[l$R].file.getFunsScript(this.useFuns)).length&&(this.includefiles[l$R].curUseID=l$z,l$b[0]=l$_+l$b[0]);return l$b},l$R.__id=1,l$R}(),l$R=function(){function l$i(l$i){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=l$i;for(var l$_=0,l$R=0,l$r=0;!((l$_=l$i.indexOf("#begin",l$_))<0);){for(l$r=l$_+5;!((l$r=l$i.indexOf("#end",l$r))<0)&&"i"===l$i.charAt(l$r+4);)l$r+=5;if(l$r<0)throw"add include err,no #end:"+l$i;l$R=l$i.indexOf("\n",l$_);var l$b=l$I.splitToWords(l$i.substr(l$_,l$R-l$_),null);"code"==l$b[1]?this.codes[l$b[2]]=l$i.substr(l$R+1,l$r-l$R-1):"function"==l$b[1]&&(l$R=l$i.indexOf("function",l$_),l$R+="function".length,this.funs[l$b[3]]=l$i.substr(l$R+1,l$r-l$R-1),this.funnames+=l$b[3]+";"),l$_=l$r+1}}l$f(l$i,"");var l$_=l$i.prototype;return l$_.getWith=function(l$i){var l$_=l$i?this.codes[l$i]:this.script;if(!l$_)throw"get with error:"+l$i;return l$_},l$_.getFunsScript=function(l$i){var l$_="";for(var l$R in this.funs)0<=l$i.indexOf(l$R+";")&&(l$_+=this.funs[l$R]);return l$_},l$i}()},l$I}(),l$ei=function(){function l$L(){}return l$f(l$L,"laya.webgl.WebGL"),l$L._uint8ArraySlice=function(){for(var l$i=this.length,l$_=new Uint8Array(this.length),l$R=0;l$R<l$i;l$R++)l$_[l$R]=this[l$R];return l$_},l$L._float32ArraySlice=function(){for(var l$i=this.length,l$_=new Float32Array(this.length),l$R=0;l$R<l$i;l$R++)l$_[l$R]=this[l$R];return l$_},l$L._uint16ArraySlice=function(l$i){var l$_,l$R=arguments,l$r=0,l$b=0;if(0===l$R.length)for(l$r=this.length,l$_=new Uint16Array(l$r),l$b=0;l$b<l$r;l$b++)l$_[l$b]=this[l$b];else if(2===l$R.length){var l$z=l$R[0],l$L=l$R[1];if(l$z<l$L)for(l$r=l$L-l$z,l$_=new Uint16Array(l$r),l$b=l$z;l$b<l$L;l$b++)l$_[l$b-l$z]=this[l$b];else l$_=new Uint16Array(0)}return l$_},l$L.expandContext=function(){var l$i=l$b.prototype,l$_=CanvasRenderingContext2D.prototype;l$_.fillTrangles=l$i.fillTrangles,l$di.__int__(null),l$_.setIBVB=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){void 0===l$x&&(l$x=0),void 0===l$P&&(l$P=0),null===l$R&&(this._ib=this._ib||l$Wi.QuadrangleIB,l$R=this._ib,l$Ni.expandIBQuadrangle(l$R,l$r._byteLength/64+8)),this._setIBVB(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P)},l$_.fillTrangles=function(l$i,l$_,l$R,l$r,l$b){this._curMat=this._curMat||l$q.create(),this._vb=this._vb||l$Ti.create(),this._ib||(this._ib=l$Wi.create(),l$Ni.fillIBQuadrangle(this._ib,l$L/4));var l$z=this._vb,l$L=l$r.length>>4;l$Ni.fillTranglesVB(l$z,l$_,l$R,l$r,l$b||this._curMat,0,0),l$Ni.expandIBQuadrangle(this._ib,l$z._byteLength/64+8);var l$w=new l$Zi(1,0);l$w.textureHost=l$i;var l$x=new l$Hi("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");l$z._vertType=3,this._setIBVB(l$_,l$R,this._ib,l$z,6*l$L,l$b,l$x,l$w,0,0)}},l$L.enable=function(){if(l$J.__init__(),l$X.isConchApp&&!l$X.isConchWebGL)return l$c.skinAniSprite=function(){return new l$ii},l$L.expandContext(),!1;if(l$c.getWebGLContext=function(l$i){for(var l$_,l$R=["webgl","experimental-webgl","webkit-3d","moz-webgl"],l$r=0;l$r<l$R.length;l$r++){try{l$_=l$i.getContext(l$R[l$r],{stencil:l$A.isStencil,alpha:l$A.isAlpha,antialias:l$A.isAntialias,premultipliedAlpha:l$A.premultipliedAlpha,preserveDrawingBuffer:l$A.preserveDrawingBuffer})}catch(l$i){}if(l$_)return l$_}return null},null==(l$L.mainContext=l$L.mainContext||l$c.getWebGLContext(l$X._mainCanvas)))return!1;if(l$X.isWebGL)return!0;l$M.create=function(l$i,l$_){return new l$i_(l$i,l$_)},l$N.create=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){return new l$ai(l$i,l$_,l$R,l$r,l$b,l$z,l$L)},l$X.WebGL=l$L,l$X.isWebGL=!0,l$Ji.__init__(),l$c.createRenderSprite=function(l$i,l$_){return new l$qi(l$i,l$_)},l$c.createWebGLContext2D=function(l$i){return new l$Ai(l$i)},l$c.changeWebGLSize=function(l$i,l$_){laya.webgl.WebGL.onStageResize(l$i,l$_)},l$c.createGraphics=function(){return new l$li};var l$i=l$c.createFilterAction;return l$c.createFilterAction=l$i||function(l$i){return new l$ji},l$c.clear=function(l$i){l$ti.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var l$_=l$X.context.ctx,l$R=0==l$_._submits._length||l$A.preserveDrawingBuffer?l$h.create(l$i)._color:l$$._wgColor;l$R&&l$_.clearBG(l$R[0],l$R[1],l$R[2],l$R[3]),l$ti.clear()},l$c.addToAtlas=function(l$i,l$_){void 0===l$_&&(l$_=!1);var l$R=l$i.bitmap;l$X.optimizeTextureMemory(l$i.url,l$i)?l$l.__typeof(l$R,"laya.webgl.resource.IMergeAtlasBitmap")&&l$R.allowMerageInAtlas&&l$R.on("recovered",l$i,l$i.addTextureToAtlas):l$R.enableMerageInAtlas=!1},l$c.isAtlas=function(l$i){return l$i instanceof laya.webgl.atlas.AtlasWebGLCanvas},l$C._enable(),l$c.beginFlush=function(){for(var l$i=l$C.instance,l$_=l$i.getAtlaserCount(),l$R=0;l$R<l$_;l$R++){var l$r=l$i.getAtlaserByIndex(l$R).texture;l$r._flashCacheImageNeedFlush&&l$c.flashFlushImage(l$r)}},l$c.drawToCanvas=function(l$i,l$_,l$R,l$r,l$b,l$z){(l$R<=0||l$r<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),l$R|=0,l$r|=0,l$b|=0,l$z|=0;var l$L=l$Oi.create(l$R,l$r,6408,5121,0,!1);l$L.start(),l$L.clear(0,0,0,0),l$X.context.clear(),l$t.renders[l$_]._fun(l$i,l$X.context,l$b,l$ti.height-l$r+l$z),l$X.context.flush(),l$L.end();var l$w=l$L.getData(0,0,l$R,l$r);if(l$L.recycle(),l$w.byteLength==l$R*l$r*4){var l$x=new l$gi;l$x._canvas=l$J.createElement("canvas"),l$x.size(l$R,l$r);var l$P=l$x._canvas.getContext("2d");l$J.canvas.size(l$R,l$r);var l$B=l$J.context,l$n=l$B.createImageData(l$R,l$r);return l$n.data.set(new Uint8ClampedArray(l$w.buffer)),l$x._imgData=l$n,l$B.putImageData(l$n,0,0),l$P.save(),l$P.translate(0,l$r),l$P.scale(1,-1),l$P.drawImage(l$J.canvas.source,0,0),l$P.restore(),l$x}console.log("drawToCanvas error: w:"+l$R+",h:"+l$r+",datalen:"+l$w.byteLength)},l$c.createFilterAction=function(l$i){var l$_;switch(l$i){case 32:l$_=new l$ji}return l$_},l$c.addTextureToAtlas=function(l$i){l$i._uvID++,l$C._atlasRestore++,l$i.bitmap.enableMerageInAtlas&&l$C.instance.addToAtlas(l$i)},l$c.getTexturePixels=function(l$i,l$_,l$R,l$r,l$b){l$X.context.ctx.clear();var l$z=new l$v;l$z.graphics.drawTexture(l$i,-l$_,-l$R);var l$L=l$Oi.create(l$r,l$b);l$L.start(),l$L.clear(0,0,0,0),l$z.render(l$X.context,0,0),l$X.context.ctx.flush(),l$L.end();for(var l$w=l$L.getData(0,0,l$r,l$b),l$x=[],l$P=0,l$B=l$b-1;0<=l$B;l$B--)for(var l$n=0;l$n<l$r;l$n++)l$P=4*(l$B*l$r+l$n),l$x.push(l$w[l$P]),l$x.push(l$w[l$P+1]),l$x.push(l$w[l$P+2]),l$x.push(l$w[l$P+3]);return l$x},l$c.skinAniSprite=function(){return new l$ii},l$P.create=function(l$i,l$_){var l$R=new l$gi;return l$R._imgData=l$_,l$R.flipY=!1,l$R},l$Z._filterStart=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$i.getValue("bounds"),l$L=l$Oi.create(l$z.width,l$z.height);if(l$L.start(),l$L.clear(0,0,0,0),l$i.addValue("src",l$L),l$i.addValue("ScissorTest",l$ti.worldScissorTest),l$ti.worldScissorTest){var l$w=new l$S;l$w.copyFrom(l$R.ctx._clipRect),l$i.addValue("clipRect",l$w),l$ti.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},l$Z._filterEnd=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$i.getValue("bounds");l$i.getValue("src").end();var l$L=l$Oi.create(l$z.width,l$z.height);l$L.start(),l$L.clear(0,0,0,0),l$i.addValue("out",l$L),l$_._set$P("_filterCache",l$L),l$_._set$P("_isHaveGlowFilter",l$i.getValue("_isHaveGlowFilter"))},l$Z._EndTarget=function(l$i,l$_){if(l$i.getValue("src").recycle(),l$i.getValue("out").end(),l$i.getValue("ScissorTest")){l$ti.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),l$_.ctx.save();var l$R=l$i.getValue("clipRect");l$_.ctx.clipRect(l$R.x,l$R.y,l$R.width,l$R.height)}},l$Z._useSrc=function(l$i){var l$_=l$i.getValue("out");l$_.end(),(l$_=l$i.getValue("src")).start(),l$_.clear(0,0,0,0)},l$Z._endSrc=function(l$i){l$i.getValue("src").end()},l$Z._useOut=function(l$i){var l$_=l$i.getValue("src");l$_.end(),(l$_=l$i.getValue("out")).start(),l$_.clear(0,0,0,0)},l$Z._endOut=function(l$i){l$i.getValue("out").end()},l$Z._recycleScope=function(l$i){l$i.recycle()},l$Z._filter=function(l$i,l$_,l$R,l$r){var l$b=this._next;if(l$b){var l$z,l$L,l$w=l$i.filters,l$x=l$w.length;if(1==l$x&&32==l$w[0].type)return l$_.ctx.save(),l$_.ctx.setFilters([l$w[0]]),l$b._fun.call(l$b,l$i,l$_,l$R,l$r),void l$_.ctx.restore();var l$P=l$wi.create(),l$B=l$j.TEMP,l$n=l$_.ctx._getTransformMatrix(),l$f=l$q.create();l$n.copyTo(l$f);var l$J=0,l$h=0,l$M=!1,l$N=l$i._$P._filterCache?l$i._$P._filterCache:null;if(!l$N||l$i._repaint){l$M=l$i._isHaveGlowFilter(),l$P.addValue("_isHaveGlowFilter",l$M),l$M&&(l$J=50,l$h=25),(l$L=new l$S).copyFrom(l$i.getSelfBounds()),l$L.x+=l$i.x,l$L.y+=l$i.y,l$L.x-=l$i.pivotX+4,l$L.y-=l$i.pivotY+4;var l$X=l$L.x,l$t=l$L.y;if(l$L.width+=l$J+8,l$L.height+=l$J+8,l$B.x=l$L.x*l$f.a+l$L.y*l$f.c,l$B.y=l$L.y*l$f.d+l$L.x*l$f.b,l$L.x=l$B.x,l$L.y=l$B.y,l$B.x=l$L.width*l$f.a+l$L.height*l$f.c,l$B.y=l$L.height*l$f.d+l$L.width*l$f.b,l$L.width=l$B.x,l$L.height=l$B.y,l$L.width<=0||l$L.height<=0)return;l$N&&l$N.recycle(),l$P.addValue("bounds",l$L);var l$I=l$Li.create([l$P,l$i,l$_,0,0],l$Z._filterStart);l$_.addRenderObject(l$I),l$_.ctx._renderKey=0,l$_.ctx._shader2D.glTexture=null;var l$e=l$i.x-l$X+l$h,l$c=l$i.y-l$t+l$h;l$b._fun.call(l$b,l$i,l$_,l$e,l$c),l$I=l$Li.create([l$P,l$i,l$_,0,0],l$Z._filterEnd),l$_.addRenderObject(l$I);for(var l$l=0;l$l<l$x;l$l++){0!=l$l&&(l$I=l$Li.create([l$P],l$Z._useSrc),l$_.addRenderObject(l$I),l$z=l$Zi.create(1,0),l$q.TEMP.identity(),l$_.ctx.drawTarget(l$P,0,0,l$L.width,l$L.height,l$q.TEMP,"out",l$z,null,l$D.TOINT.overlay),l$I=l$Li.create([l$P],l$Z._useOut),l$_.addRenderObject(l$I)),l$w[l$l].action.apply3d(l$P,l$i,l$_,0,0)}l$I=l$Li.create([l$P,l$_],l$Z._EndTarget),l$_.addRenderObject(l$I)}else{if((l$M=!!l$i._$P._isHaveGlowFilter&&l$i._$P._isHaveGlowFilter)&&(l$J=50,l$h=25),(l$L=l$i.getBounds()).width<=0||l$L.height<=0)return;l$L.width+=l$J,l$L.height+=l$J,l$B.x=l$L.x*l$f.a+l$L.y*l$f.c,l$B.y=l$L.y*l$f.d+l$L.x*l$f.b,l$L.x=l$B.x,l$L.y=l$B.y,l$B.x=l$L.width*l$f.a+l$L.height*l$f.c,l$B.y=l$L.height*l$f.d+l$L.width*l$f.b,l$L.width=l$B.x,l$L.height=l$B.y,l$P.addValue("out",l$N)}l$R=l$R-l$h-l$i.x,l$r=l$r-l$h-l$i.y,l$B.setTo(l$R,l$r),l$f.transformPoint(l$B),l$R=l$B.x+l$L.x,l$r=l$B.y+l$L.y,l$z=l$Zi.create(1,0),l$q.TEMP.identity(),l$_.ctx.drawTarget(l$P,l$R,l$r,l$L.width,l$L.height,l$q.TEMP,"out",l$z,null,l$D.TOINT.overlay),l$I=l$Li.create([l$P],l$Z._recycleScope),l$_.addRenderObject(l$I),l$f.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=l$L._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=l$L._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=l$L._uint8ArraySlice),!0},l$L.onStageResize=function(l$i,l$_){null!=l$L.mainContext&&(l$L.mainContext.viewport(0,0,l$i,l$_),l$ti.width=l$i,l$ti.height=l$_)},l$L.onInvalidGLRes=function(){l$C.instance.freeAll(),l$e.releaseContentManagers(!0),l$L.doNodeRepaint(l$l.stage),l$L.mainContext.viewport(0,0,l$ti.width,l$ti.height),l$l.stage.event("devicelost")},l$L.doNodeRepaint=function(l$i){0==l$i.numChildren&&l$i.repaint();for(var l$_=0;l$_<l$i.numChildren;l$_++)l$L.doNodeRepaint(l$i.getChildAt(l$_))},l$L.init=function(l$i,l$_,l$R){l$L.mainCanvas=l$i,l$P._createContext=function(l$i){return new l$Ai(l$i)},l$gi._createContext=function(l$i){return new l$Ai(l$i)};var l$r=laya.webgl.WebGL.mainContext;if(null!=l$r.getShaderPrecisionFormat){var l$b=l$r.getShaderPrecisionFormat(35633,36338),l$z=l$r.getShaderPrecisionFormat(35632,36338);l$L.shaderHighPrecision=!(!l$b.precision||!l$z.precision)}else l$L.shaderHighPrecision=!1;if(l$L.compressAstc=l$r.getExtension("WEBGL_compressed_texture_astc"),l$L.compressAtc=l$r.getExtension("WEBGL_compressed_texture_atc"),l$L.compressEtc=l$r.getExtension("WEBGL_compressed_texture_etc"),l$L.compressEtc1=l$r.getExtension("WEBGL_compressed_texture_etc1"),l$L.compressPvrtc=l$r.getExtension("WEBGL_compressed_texture_pvrtc"),l$L.compressS3tc=l$r.getExtension("WEBGL_compressed_texture_s3tc"),l$L.compressS3tc_srgb=l$r.getExtension("WEBGL_compressed_texture_s3tc_srgb"),l$L.compressAstc=l$L.compressAstc?l$L.compressAstc:{},l$L.compressAtc=l$L.compressAtc?l$L.compressAtc:{},l$L.compressEtc=l$L.compressEtc?l$L.compressEtc:{},l$L.compressEtc1=l$L.compressEtc1?l$L.compressEtc1:{},l$L.compressPvrtc=l$L.compressPvrtc?l$L.compressPvrtc:{},l$L.compressS3tc=l$L.compressS3tc?l$L.compressS3tc:{},l$L.compressS3tc_srgb=l$L.compressS3tc_srgb?l$L.compressS3tc_srgb:{},l$r.deleteTexture1=l$r.deleteTexture,l$r.deleteTexture=function(l$i){l$i==l$ci.curBindTexValue&&(l$ci.curBindTexValue=null),l$r.deleteTexture1(l$i)},l$L.onStageResize(l$_,l$R),null==l$L.mainContext)throw new Error("webGL getContext err!");l$o.__init__(),l$C.__init__(),l$vi.__init__(),l$zi.__init__(),l$Ai.__init__(),l$Zi.__init__(),l$W.__init__(),l$di.__int__(l$r),l$D._init_(l$r),l$X.isConchApp&&conch.setOnInvalidGLRes(l$L.onInvalidGLRes)},l$L.mainCanvas=null,l$L.antialias=!0,l$L.shaderHighPrecision=!1,l$L._bg_null=[0,0,0,0],l$L}(),l$ci=function(){function l$r(){}return l$f(l$r,"laya.webgl.WebGLContext"),l$r.UseProgram=function(l$i){return l$r._useProgram!==l$i&&(l$ei.mainContext.useProgram(l$i),l$r._useProgram=l$i,!0)},l$r.setDepthTest=function(l$i,l$_){l$_!==l$r._depthTest&&((l$r._depthTest=l$_)?l$i.enable(2929):l$i.disable(2929))},l$r.setDepthMask=function(l$i,l$_){l$_!==l$r._depthMask&&(l$r._depthMask=l$_,l$i.depthMask(l$_))},l$r.setDepthFunc=function(l$i,l$_){l$_!==l$r._depthFunc&&(l$r._depthFunc=l$_,l$i.depthFunc(l$_))},l$r.setBlend=function(l$i,l$_){l$_!==l$r._blend&&((l$r._blend=l$_)?l$i.enable(3042):l$i.disable(3042))},l$r.setBlendFunc=function(l$i,l$_,l$R){(l$_!==l$r._sFactor||l$R!==l$r._dFactor)&&(l$r._sFactor=l$_,l$r._dFactor=l$R,l$i.blendFunc(l$_,l$R))},l$r.setCullFace=function(l$i,l$_){l$_!==l$r._cullFace&&((l$r._cullFace=l$_)?l$i.enable(2884):l$i.disable(2884))},l$r.setFrontFace=function(l$i,l$_){l$_!==l$r._frontFace&&(l$r._frontFace=l$_,l$i.frontFace(l$_))},l$r.bindTexture=function(l$i,l$_,l$R){l$i.bindTexture(l$_,l$R),l$r.curBindTexTarget=l$_,l$r.curBindTexValue=l$R},l$r.DEPTH_BUFFER_BIT=256,l$r.STENCIL_BUFFER_BIT=1024,l$r.COLOR_BUFFER_BIT=16384,l$r.POINTS=0,l$r.LINES=1,l$r.LINE_LOOP=2,l$r.LINE_STRIP=3,l$r.TRIANGLES=4,l$r.TRIANGLE_STRIP=5,l$r.TRIANGLE_FAN=6,l$r.ZERO=0,l$r.ONE=1,l$r.SRC_COLOR=768,l$r.ONE_MINUS_SRC_COLOR=769,l$r.SRC_ALPHA=770,l$r.ONE_MINUS_SRC_ALPHA=771,l$r.DST_ALPHA=772,l$r.ONE_MINUS_DST_ALPHA=773,l$r.DST_COLOR=774,l$r.ONE_MINUS_DST_COLOR=775,l$r.SRC_ALPHA_SATURATE=776,l$r.FUNC_ADD=32774,l$r.BLEND_EQUATION=32777,l$r.BLEND_EQUATION_RGB=32777,l$r.BLEND_EQUATION_ALPHA=34877,l$r.FUNC_SUBTRACT=32778,l$r.FUNC_REVERSE_SUBTRACT=32779,l$r.BLEND_DST_RGB=32968,l$r.BLEND_SRC_RGB=32969,l$r.BLEND_DST_ALPHA=32970,l$r.BLEND_SRC_ALPHA=32971,l$r.CONSTANT_COLOR=32769,l$r.ONE_MINUS_CONSTANT_COLOR=32770,l$r.CONSTANT_ALPHA=32771,l$r.ONE_MINUS_CONSTANT_ALPHA=32772,l$r.BLEND_COLOR=32773,l$r.ARRAY_BUFFER=34962,l$r.ELEMENT_ARRAY_BUFFER=34963,l$r.ARRAY_BUFFER_BINDING=34964,l$r.ELEMENT_ARRAY_BUFFER_BINDING=34965,l$r.STREAM_DRAW=35040,l$r.STATIC_DRAW=35044,l$r.DYNAMIC_DRAW=35048,l$r.BUFFER_SIZE=34660,l$r.BUFFER_USAGE=34661,l$r.CURRENT_VERTEX_ATTRIB=34342,l$r.FRONT=1028,l$r.BACK=1029,l$r.CULL_FACE=2884,l$r.FRONT_AND_BACK=1032,l$r.BLEND=3042,l$r.DITHER=3024,l$r.STENCIL_TEST=2960,l$r.DEPTH_TEST=2929,l$r.SCISSOR_TEST=3089,l$r.POLYGON_OFFSET_FILL=32823,l$r.SAMPLE_ALPHA_TO_COVERAGE=32926,l$r.SAMPLE_COVERAGE=32928,l$r.NO_ERROR=0,l$r.INVALID_ENUM=1280,l$r.INVALID_VALUE=1281,l$r.INVALID_OPERATION=1282,l$r.OUT_OF_MEMORY=1285,l$r.CW=2304,l$r.CCW=2305,l$r.LINE_WIDTH=2849,l$r.ALIASED_POINT_SIZE_RANGE=33901,l$r.ALIASED_LINE_WIDTH_RANGE=33902,l$r.CULL_FACE_MODE=2885,l$r.FRONT_FACE=2886,l$r.DEPTH_RANGE=2928,l$r.DEPTH_WRITEMASK=2930,l$r.DEPTH_CLEAR_VALUE=2931,l$r.DEPTH_FUNC=2932,l$r.STENCIL_CLEAR_VALUE=2961,l$r.STENCIL_FUNC=2962,l$r.STENCIL_FAIL=2964,l$r.STENCIL_PASS_DEPTH_FAIL=2965,l$r.STENCIL_PASS_DEPTH_PASS=2966,l$r.STENCIL_REF=2967,l$r.STENCIL_VALUE_MASK=2963,l$r.STENCIL_WRITEMASK=2968,l$r.STENCIL_BACK_FUNC=34816,l$r.STENCIL_BACK_FAIL=34817,l$r.STENCIL_BACK_PASS_DEPTH_FAIL=34818,l$r.STENCIL_BACK_PASS_DEPTH_PASS=34819,l$r.STENCIL_BACK_REF=36003,l$r.STENCIL_BACK_VALUE_MASK=36004,l$r.STENCIL_BACK_WRITEMASK=36005,l$r.VIEWPORT=2978,l$r.SCISSOR_BOX=3088,l$r.COLOR_CLEAR_VALUE=3106,l$r.COLOR_WRITEMASK=3107,l$r.UNPACK_ALIGNMENT=3317,l$r.PACK_ALIGNMENT=3333,l$r.MAX_TEXTURE_SIZE=3379,l$r.MAX_VIEWPORT_DIMS=3386,l$r.SUBPIXEL_BITS=3408,l$r.RED_BITS=3410,l$r.GREEN_BITS=3411,l$r.BLUE_BITS=3412,l$r.ALPHA_BITS=3413,l$r.DEPTH_BITS=3414,l$r.STENCIL_BITS=3415,l$r.POLYGON_OFFSET_UNITS=10752,l$r.POLYGON_OFFSET_FACTOR=32824,l$r.TEXTURE_BINDING_2D=32873,l$r.SAMPLE_BUFFERS=32936,l$r.SAMPLES=32937,l$r.SAMPLE_COVERAGE_VALUE=32938,l$r.SAMPLE_COVERAGE_INVERT=32939,l$r.NUM_COMPRESSED_TEXTURE_FORMATS=34466,l$r.COMPRESSED_TEXTURE_FORMATS=34467,l$r.DONT_CARE=4352,l$r.FASTEST=4353,l$r.NICEST=4354,l$r.GENERATE_MIPMAP_HINT=33170,l$r.BYTE=5120,l$r.UNSIGNED_BYTE=5121,l$r.SHORT=5122,l$r.UNSIGNED_SHORT=5123,l$r.INT=5124,l$r.UNSIGNED_INT=5125,l$r.FLOAT=5126,l$r.DEPTH_COMPONENT=6402,l$r.ALPHA=6406,l$r.RGB=6407,l$r.RGBA=6408,l$r.LUMINANCE=6409,l$r.LUMINANCE_ALPHA=6410,l$r.UNSIGNED_SHORT_4_4_4_4=32819,l$r.UNSIGNED_SHORT_5_5_5_1=32820,l$r.UNSIGNED_SHORT_5_6_5=33635,l$r.FRAGMENT_SHADER=35632,l$r.VERTEX_SHADER=35633,l$r.MAX_VERTEX_ATTRIBS=34921,l$r.MAX_VERTEX_UNIFORM_VECTORS=36347,l$r.MAX_VARYING_VECTORS=36348,l$r.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,l$r.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,l$r.MAX_TEXTURE_IMAGE_UNITS=34930,l$r.MAX_FRAGMENT_UNIFORM_VECTORS=36349,l$r.SHADER_TYPE=35663,l$r.DELETE_STATUS=35712,l$r.LINK_STATUS=35714,l$r.VALIDATE_STATUS=35715,l$r.ATTACHED_SHADERS=35717,l$r.ACTIVE_UNIFORMS=35718,l$r.ACTIVE_ATTRIBUTES=35721,l$r.SHADING_LANGUAGE_VERSION=35724,l$r.CURRENT_PROGRAM=35725,l$r.NEVER=512,l$r.LESS=513,l$r.EQUAL=514,l$r.LEQUAL=515,l$r.GREATER=516,l$r.NOTEQUAL=517,l$r.GEQUAL=518,l$r.ALWAYS=519,l$r.KEEP=7680,l$r.REPLACE=7681,l$r.INCR=7682,l$r.DECR=7683,l$r.INVERT=5386,l$r.INCR_WRAP=34055,l$r.DECR_WRAP=34056,l$r.VENDOR=7936,l$r.RENDERER=7937,l$r.VERSION=7938,l$r.NEAREST=9728,l$r.LINEAR=9729,l$r.NEAREST_MIPMAP_NEAREST=9984,l$r.LINEAR_MIPMAP_NEAREST=9985,l$r.NEAREST_MIPMAP_LINEAR=9986,l$r.LINEAR_MIPMAP_LINEAR=9987,l$r.TEXTURE_MAG_FILTER=10240,l$r.TEXTURE_MIN_FILTER=10241,l$r.TEXTURE_WRAP_S=10242,l$r.TEXTURE_WRAP_T=10243,l$r.TEXTURE_2D=3553,l$r.TEXTURE=5890,l$r.TEXTURE_CUBE_MAP=34067,l$r.TEXTURE_BINDING_CUBE_MAP=34068,l$r.TEXTURE_CUBE_MAP_POSITIVE_X=34069,l$r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,l$r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,l$r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,l$r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,l$r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,l$r.MAX_CUBE_MAP_TEXTURE_SIZE=34076,l$r.TEXTURE0=33984,l$r.TEXTURE1=33985,l$r.TEXTURE2=33986,l$r.TEXTURE3=33987,l$r.TEXTURE4=33988,l$r.TEXTURE5=33989,l$r.TEXTURE6=33990,l$r.TEXTURE7=33991,l$r.TEXTURE8=33992,l$r.TEXTURE9=33993,l$r.TEXTURE10=33994,l$r.TEXTURE11=33995,l$r.TEXTURE12=33996,l$r.TEXTURE13=33997,l$r.TEXTURE14=33998,l$r.TEXTURE15=33999,l$r.TEXTURE16=34e3,l$r.TEXTURE17=34001,l$r.TEXTURE18=34002,l$r.TEXTURE19=34003,l$r.TEXTURE20=34004,l$r.TEXTURE21=34005,l$r.TEXTURE22=34006,l$r.TEXTURE23=34007,l$r.TEXTURE24=34008,l$r.TEXTURE25=34009,l$r.TEXTURE26=34010,l$r.TEXTURE27=34011,l$r.TEXTURE28=34012,l$r.TEXTURE29=34013,l$r.TEXTURE30=34014,l$r.TEXTURE31=34015,l$r.ACTIVE_TEXTURE=34016,l$r.REPEAT=10497,l$r.CLAMP_TO_EDGE=33071,l$r.MIRRORED_REPEAT=33648,l$r.FLOAT_VEC2=35664,l$r.FLOAT_VEC3=35665,l$r.FLOAT_VEC4=35666,l$r.INT_VEC2=35667,l$r.INT_VEC3=35668,l$r.INT_VEC4=35669,l$r.BOOL=35670,l$r.BOOL_VEC2=35671,l$r.BOOL_VEC3=35672,l$r.BOOL_VEC4=35673,l$r.FLOAT_MAT2=35674,l$r.FLOAT_MAT3=35675,l$r.FLOAT_MAT4=35676,l$r.SAMPLER_2D=35678,l$r.SAMPLER_CUBE=35680,l$r.VERTEX_ATTRIB_ARRAY_ENABLED=34338,l$r.VERTEX_ATTRIB_ARRAY_SIZE=34339,l$r.VERTEX_ATTRIB_ARRAY_STRIDE=34340,l$r.VERTEX_ATTRIB_ARRAY_TYPE=34341,l$r.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,l$r.VERTEX_ATTRIB_ARRAY_POINTER=34373,l$r.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,l$r.COMPILE_STATUS=35713,l$r.LOW_FLOAT=36336,l$r.MEDIUM_FLOAT=36337,l$r.HIGH_FLOAT=36338,l$r.LOW_INT=36339,l$r.MEDIUM_INT=36340,l$r.HIGH_INT=36341,l$r.FRAMEBUFFER=36160,l$r.RENDERBUFFER=36161,l$r.RGBA4=32854,l$r.RGB5_A1=32855,l$r.RGB565=36194,l$r.DEPTH_COMPONENT16=33189,l$r.STENCIL_INDEX=6401,l$r.STENCIL_INDEX8=36168,l$r.DEPTH_STENCIL=34041,l$r.RENDERBUFFER_WIDTH=36162,l$r.RENDERBUFFER_HEIGHT=36163,l$r.RENDERBUFFER_INTERNAL_FORMAT=36164,l$r.RENDERBUFFER_RED_SIZE=36176,l$r.RENDERBUFFER_GREEN_SIZE=36177,l$r.RENDERBUFFER_BLUE_SIZE=36178,l$r.RENDERBUFFER_ALPHA_SIZE=36179,l$r.RENDERBUFFER_DEPTH_SIZE=36180,l$r.RENDERBUFFER_STENCIL_SIZE=36181,l$r.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,l$r.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,l$r.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,l$r.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,l$r.COLOR_ATTACHMENT0=36064,l$r.DEPTH_ATTACHMENT=36096,l$r.STENCIL_ATTACHMENT=36128,l$r.DEPTH_STENCIL_ATTACHMENT=33306,l$r.NONE=0,l$r.FRAMEBUFFER_COMPLETE=36053,l$r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,l$r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,l$r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,l$r.FRAMEBUFFER_UNSUPPORTED=36061,l$r.FRAMEBUFFER_BINDING=36006,l$r.RENDERBUFFER_BINDING=36007,l$r.MAX_RENDERBUFFER_SIZE=34024,l$r.INVALID_FRAMEBUFFER_OPERATION=1286,l$r.UNPACK_FLIP_Y_WEBGL=37440,l$r.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,l$r.CONTEXT_LOST_WEBGL=37442,l$r.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,l$r.BROWSER_DEFAULT_WEBGL=37444,l$r._useProgram=null,l$r._depthTest=!0,l$r._depthMask=!0,l$r._blend=!1,l$r._cullFace=!1,l$r.curBindTexTarget=null,l$r.curBindTexValue=null,l$L(l$r,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),l$r}(),l$li=function(l$i){function l$_(){l$_.__super.call(this)}l$f(l$_,"laya.webgl.display.GraphicsGL",l$w);var l$R=l$_.prototype;return l$R.setShader=function(l$i){this._saveToCmd(l$X.context._setShader,[l$i])},l$R.setIBVB=function(l$i,l$_,l$R,l$r,l$b,l$z){this._saveToCmd(l$X.context._setIBVB,[l$i,l$_,l$R,l$r,l$b,l$z])},l$R.drawParticle=function(l$i,l$_,l$R){var l$r=l$c.createParticleTemplate2D(l$R);l$r.x=l$i,l$r.y=l$_,this._saveToCmd(l$X.context._drawParticle,[l$r])},l$_}(),l$Ai=function(l$i){var l$R;function l$Y(l$i){this._x=0,this._y=0,this._id=++l$Y._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,l$Y.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=l$Y.MAXCLIPRECT,this.mOutPoint,this._canvas=l$i,this._canvas._addReference(),l$Y._contextcount++,l$X.isFlash?(this._ib=l$Wi.create(35044),l$Ni.fillIBQuadrangle(this._ib,16)):this._ib=l$Wi.QuadrangleIB,this.clear()}l$f(l$Y,"laya.webgl.canvas.WebGLContext2D",l$b);var l$_=l$Y.prototype;return l$_.setIsMainContext=function(){this._isMain=!0},l$_.clearBG=function(l$i,l$_,l$R,l$r){var l$b=l$ei.mainContext;l$b.clearColor(l$i,l$_,l$R,l$r),l$b.clear(16384)},l$_._getSubmits=function(){return this._submits},l$_._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var l$i=0,l$_=this._submits._length;l$i<l$_;l$i++)this._submits[l$i].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},l$_.destroy=function(){--l$Y._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=l$Wi.QuadrangleIB&&this._ib.releaseResource()},l$_.clear=function(){this._submits||(this._other=l$R.DEFAULT,this._curMat=l$q.create(),this._vb=l$Ti.create(-1),this._submits=[],this._save=[l$F.Create(this)],this._save.length=10,this._shader2D=new l$W,this._triangleMesh=l$ki.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=l$R.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=l$Y.MAXCLIPRECT,this._curSubmit=l$zi.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=l$U.DEFAULT;for(var l$i=0,l$_=this._submits._length;l$i<l$_;l$i++)this._submits[l$i].releaseRender(),this._submits[l$i]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},l$_.size=function(l$i,l$_){if(this._width!=l$i||this._height!=l$_)if(0==l$i||0==l$_){0!=this._vb._byteLength&&(this._width=l$i,this._height=l$_,this._vb.clear(),this._vb.upload());for(var l$R=0,l$r=this._submits._length;l$R<l$r;l$R++)this._submits[l$R].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=l$i,this._height=l$_,this._targets&&this._targets.size(l$i,l$_),this._canvas.memorySize-=this._canvas.memorySize;0===l$i&&0===l$_&&this._releaseMem()},l$_._getTransformMatrix=function(){return this._curMat},l$_.translate=function(l$i,l$_){0===l$i&&0===l$_||(l$Q.save(this),this._curMat.bTransform&&(l$d.save(this),this._curMat.transformPointN(l$j.TEMP.setTo(l$i,l$_)),l$i=l$j.TEMP.x,l$_=l$j.TEMP.y),this._x+=l$i,this._y+=l$_)},l$_.save=function(){this._save[this._save._length++]=l$F.Create(this)},l$_.restore=function(){var l$i=this._save._length;if(!(l$i<1))for(var l$_=l$i-1;0<=l$_;l$_--){var l$R=this._save[l$_];if(l$R.restore(this),l$R.isSaveMark())return void(this._save._length=l$_)}},l$_._fillText=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){void 0===l$P&&(l$P=0);var l$B=this._shader2D,l$n=this._curSubmit.shaderValue,l$f=l$b?l$hi.create(l$b):this._other.font;if(l$C.enabled)l$B.ALPHA!==l$n.ALPHA&&(l$B.glTexture=null),l$Ji.drawText(this,l$i,l$_,this._curMat,l$f,l$x||this._other.textAlign,l$z,l$L,l$w,l$R,l$r,l$P);else{this._shader2D.defines.getValue();var l$J=l$z?l$h.create(l$z)._color:l$B.colorAdd;l$B.ALPHA===l$n.ALPHA&&l$J===l$B.colorAdd&&l$n.colorAdd===l$B.colorAdd||(l$B.glTexture=null,l$B.colorAdd=l$J),l$Ji.drawText(this,l$i,l$_,this._curMat,l$f,l$x||this._other.textAlign,l$z,l$L,l$w,l$R,l$r,l$P)}},l$_.fillWords=function(l$i,l$_,l$R,l$r,l$b,l$z){this._fillText(null,l$i,l$_,l$R,l$r,l$b,null,-1,null,l$z)},l$_.fillBorderWords=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this._fillBorderText(null,l$i,l$_,l$R,l$r,l$b,l$z,l$L,null)},l$_.fillText=function(l$i,l$_,l$R,l$r,l$b,l$z){this._fillText(l$i,null,l$_,l$R,l$r,l$b,null,-1,l$z)},l$_.strokeText=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this._fillText(l$i,null,l$_,l$R,l$r,null,l$b,l$z||1,l$L)},l$_.fillBorderText=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){this._fillBorderText(l$i,null,l$_,l$R,l$r,l$b,l$z,l$L,l$w)},l$_._fillBorderText=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){if(!l$C.enabled)return this._fillText(l$i,l$_,l$R,l$r,l$b,null,l$L,l$w||1,l$x),void this._fillText(l$i,l$_,l$R,l$r,l$b,l$z,null,-1,l$x);var l$P=this._shader2D,l$B=this._curSubmit.shaderValue;l$P.ALPHA!==l$B.ALPHA&&(l$P.glTexture=null);var l$n=l$b?(l$Y._fontTemp.setFont(l$b),l$Y._fontTemp):this._other.font;l$Ji.drawText(this,l$i,l$_,this._curMat,l$n,l$x||this._other.textAlign,l$z,l$L,l$w||1,l$R,l$r,0)},l$_.fillRect=function(l$i,l$_,l$R,l$r,l$b){var l$z=this._vb;if(l$Ni.fillRectImgVb(l$z,this._clipRect,l$i,l$_,l$R,l$r,l$k.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var l$L=this._shader2D.fillStyle;l$b&&(this._shader2D.fillStyle=l$U.create(l$b));var l$w=this._shader2D,l$x=this._curSubmit.shaderValue;if(l$w.fillStyle!==l$x.fillStyle||l$w.ALPHA!==l$x.ALPHA){l$w.glTexture=null;var l$P=this._curSubmit=l$zi.createSubmit(this,this._ib,l$z,(l$z._byteLength-64)/32*3,l$Zi.create(2,0));l$P.shaderValue.color=l$w.fillStyle._color._color,l$P.shaderValue.ALPHA=l$w.ALPHA,this._submits[this._submits._length++]=l$P}this._curSubmit._numEle+=6,this._shader2D.fillStyle=l$L}},l$_.fillTexture=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){if(l$i.loaded&&l$i.bitmap&&l$i.source){var l$x=this._vb,l$P=l$i.bitmap.width,l$B=l$i.bitmap.height,l$n=l$i.uv,l$f=l$L.x%l$i.width,l$J=l$L.y%l$i.height;if(l$P!=l$w.w||l$B!=l$w.h){if(!l$w.w&&!l$w.h)switch(l$w.oy=l$w.ox=0,l$z){case"repeat":l$w.width=l$r,l$w.height=l$b;break;case"repeat-x":l$w.width=l$r,l$J<0?l$i.height+l$J>l$b?l$w.height=l$b:l$w.height=l$i.height+l$J:(l$w.oy=l$J,l$i.height+l$J>l$b?l$w.height=l$b-l$J:l$w.height=l$i.height);break;case"repeat-y":l$f<0?l$i.width+l$f>l$r?l$w.width=l$r:l$w.width=l$i.width+l$f:(l$w.ox=l$f,l$i.width+l$f>l$r?l$w.width=l$r-l$f:l$w.width=l$i.width),l$w.height=l$b;break;case"no-repeat":l$f<0?l$i.width+l$f>l$r?l$w.width=l$r:l$w.width=l$i.width+l$f:(l$w.ox=l$f,l$i.width+l$f>l$r?l$w.width=l$r-l$f:l$w.width=l$i.width),l$J<0?l$i.height+l$J>l$b?l$w.height=l$b:l$w.height=l$i.height+l$J:(l$w.oy=l$J,l$i.height+l$J>l$b?l$w.height=l$b-l$J:l$w.height=l$i.height);break;default:l$w.width=l$r,l$w.height=l$b}l$w.w=l$P,l$w.h=l$B,l$w.uv=[0,0,l$w.width/l$P,0,l$w.width/l$P,l$w.height/l$B,0,l$w.height/l$B]}if(l$_+=l$w.ox,l$R+=l$w.oy,l$f-=l$w.ox,l$J-=l$w.oy,l$Ni.fillRectImgVb(l$x,this._clipRect,l$_,l$R,l$w.width,l$w.height,l$w.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var l$h=l$pi.create(this,this._ib,l$x,(l$x._byteLength-64)/32*3,l$Zi.create(256,0)),l$M=(this._submits[this._submits._length++]=l$h).shaderValue;l$M.textureHost=l$i;var l$N=l$n[0]*l$P,l$X=l$n[1]*l$B,l$t=(l$n[2]-l$n[0])*l$P,l$I=(l$n[5]-l$n[3])*l$B,l$e=-l$f/l$P,l$c=-l$J/l$B;l$M.u_TexRange[0]=l$N/l$P,l$M.u_TexRange[1]=l$t/l$P,l$M.u_TexRange[2]=l$X/l$B,l$M.u_TexRange[3]=l$I/l$B,l$M.u_offset[0]=l$e,l$M.u_offset[1]=l$c,l$C.enabled&&!this._isMain&&l$h.addTexture(l$i,(l$x._byteLength>>2)-16),(this._curSubmit=l$h)._renderType=10017,l$h._numEle+=6}}else this.sprite&&l$l.timer.callLater(this,this._repaintSprite)},l$_.setShader=function(l$i){l$V.save(this,1048576,this._shader2D,!0),this._shader2D.shader=l$i},l$_.setFilters=function(l$i){l$V.save(this,2097152,this._shader2D,!0),this._shader2D.filters=l$i,this._curSubmit=l$zi.RENDERBASE,this._renderKey=0,this._drawCount++},l$_.drawTexture=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this._drawTextureM(l$i,l$_,l$R,l$r,l$b,l$z,l$L,null,1)},l$_.addTextureVb=function(l$i,l$_,l$R){var l$r=this._curSubmit._vb||this._vb,l$b=l$r._byteLength>>2;l$r.byteLength=l$b+16<<2;for(var l$z=l$r.getFloat32Array(),l$L=0;l$L<16;l$L+=4)l$z[l$b++]=l$i[l$L]+l$_,l$z[l$b++]=l$i[l$L+1]+l$R,l$z[l$b++]=l$i[l$L+2],l$z[l$b++]=l$i[l$L+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),l$r._upload=!0},l$_.willDrawTexture=function(l$i,l$_){if(!(l$i.loaded&&l$i.bitmap&&l$i.source))return this.sprite&&l$l.timer.callLater(this,this._repaintSprite),0;var l$R=l$i.bitmap,l$r=l$R.id+this._shader2D.ALPHA*l$_+10016;if(l$r==this._renderKey)return l$r;var l$b=this._shader2D,l$z=l$b.ALPHA,l$L=this._curSubmit.shaderValue;l$b.ALPHA*=l$_,this._renderKey=l$r,this._drawCount++,l$b.glTexture=l$R;var l$w=this._vb,l$x=null,l$P=l$w._byteLength/32*3,l$B=l$L.textureHost&&l$L.textureHost==l$i&&l$L.textureHost.alphaTexture==l$i.alphaTexture;return l$x=l$pi.create(this,this._ib,l$w,l$P,l$Zi.create(1,0)),(this._submits[this._submits._length++]=l$x).shaderValue.textureHost=l$i,l$x._renderType=10016,l$x._preIsSameTextureShader=10016===this._curSubmit._renderType&&l$b.ALPHA===l$L.ALPHA&&l$B,this._curSubmit=l$x,l$b.ALPHA=l$z,l$r},l$_.drawTextures=function(l$i,l$_,l$R,l$r){if(l$i.loaded&&l$i.bitmap&&l$i.source){var l$b=this._clipRect;if(this._clipRect=l$Y.MAXCLIPRECT,this._drawTextureM(l$i,l$_[0],l$_[1],l$i.width,l$i.height,l$R,l$r,null,1)){if(this._clipRect=l$b,l$G.drawCall++,!(l$_.length<4)){for(var l$z=this._curSubmit._vb||this._vb,l$L=this._curMat.a,l$w=this._curMat.d,l$x=2,l$P=l$_.length;l$x<l$P;l$x+=2)l$Ni.copyPreImgVb(l$z,(l$_[l$x]-l$_[l$x-2])*l$L,(l$_[l$x+1]-l$_[l$x-1])*l$w),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&l$l.timer.callLater(this,this._repaintSprite)},l$_._drawTextureM=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){if(!l$i.loaded||!l$i.source)return this.sprite&&l$l.timer.callLater(this,this._repaintSprite),!1;var l$P=this._curSubmit._vb||this._vb,l$B=l$i.bitmap;l$_+=l$z,l$R+=l$L,this._drawCount++;var l$n=l$B.id+this._shader2D.ALPHA*l$x+10016;if(l$n!=this._renderKey){this._renderKey=l$n;var l$f=this._curSubmit.shaderValue,l$J=this._shader2D,l$h=l$J.ALPHA;l$J.ALPHA*=l$x,l$J.glTexture=l$B;var l$M=this._vb,l$N=null,l$X=l$M._byteLength/32*3,l$t=l$f.textureHost&&l$f.textureHost==l$i&&l$f.textureHost.alphaTexture==l$i.alphaTexture;l$N=l$pi.create(this,this._ib,l$M,l$X,l$Zi.create(1,0)),(this._submits[this._submits._length++]=l$N).shaderValue.textureHost=l$i,l$N._renderType=10016,l$N._preIsSameTextureShader=10016===this._curSubmit._renderType&&l$J.ALPHA===l$f.ALPHA&&l$t,this._curSubmit=l$N,l$P=this._curSubmit._vb||this._vb,l$J.ALPHA=l$h}return!!l$Ni.fillRectImgVb(l$P,this._clipRect,l$_,l$R,l$r||l$i.width,l$b||l$i.height,l$i.uv,l$w||this._curMat,this._x,this._y,0,0)&&(l$C.enabled&&!this._isMain&&this._curSubmit.addTexture(l$i,(l$P._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},l$_._repaintSprite=function(){this.sprite&&this.sprite.repaint()},l$_._drawText=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){var l$B=l$i.bitmap;this._drawCount++;var l$n=l$B.id+this._shader2D.ALPHA+10016;if(l$n!=this._renderKey){this._renderKey=l$n;var l$f=this._curSubmit.shaderValue,l$J=this._shader2D;l$J.glTexture=l$B;var l$h=this._vb,l$M=null,l$N=l$h._byteLength/32*3,l$X=l$f.textureHost&&l$f.textureHost==l$i&&l$f.textureHost.alphaTexture==l$i.alphaTexture;(l$M=l$C.enabled?l$pi.create(this,this._ib,l$h,l$N,l$Zi.create(1,0)):l$pi.create(this,this._ib,l$h,l$N,l$Qi.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&l$J.ALPHA===l$f.ALPHA&&l$X,(this._submits[this._submits._length++]=l$M).shaderValue.textureHost=l$i,l$M._renderType=10016,this._curSubmit=l$M}l$i.active();var l$t=this._curSubmit._vb||this._vb;l$Ni.fillRectImgVb(l$t,this._clipRect,l$_+l$L,l$R+l$w,l$r||l$i.width,l$b||l$i.height,l$i.uv,l$z||this._curMat,this._x,this._y,l$x,l$P,!0)&&(l$C.enabled&&!this._isMain&&this._curSubmit.addTexture(l$i,(l$t._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},l$_.drawTextureWithTransform=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){if(l$z){var l$P=this._curMat,l$B=this._x,l$n=this._y;(0!==l$L||0!==l$w)&&(this._x=l$L*l$P.a+l$w*l$P.c,this._y=l$w*l$P.d+l$L*l$P.b),l$z&&l$P.bTransform?(l$q.mul(l$z,l$P,l$Y._tmpMatrix),(l$z=l$Y._tmpMatrix)._checkTransform()):(this._x+=l$P.tx,this._y+=l$P.ty),this._drawTextureM(l$i,l$_,l$R,l$r,l$b,0,0,l$z,l$x),this._x=l$B,this._y=l$n}else this._drawTextureM(l$i,l$_,l$R,l$r,l$b,l$L,l$w,null,l$x)},l$_.fillQuadrangle=function(l$i,l$_,l$R,l$r,l$b){var l$z=this._curSubmit,l$L=this._vb,l$w=this._shader2D,l$x=l$z.shaderValue;if(this._renderKey=0,l$i.bitmap){var l$P=l$i.bitmap;l$w.glTexture==l$P&&l$w.ALPHA===l$x.ALPHA||(l$w.glTexture=l$P,(l$z=this._curSubmit=l$zi.createSubmit(this,this._ib,l$L,l$L._byteLength/32*3,l$Zi.create(1,0))).shaderValue.glTexture=l$P,this._submits[this._submits._length++]=l$z),l$Ni.fillQuadrangleImgVb(l$L,l$_,l$R,l$r,l$i.uv,l$b||this._curMat,this._x,this._y)}else l$z.shaderValue.fillStyle&&l$z.shaderValue.fillStyle.equal(l$i)&&l$w.ALPHA===l$x.ALPHA||(l$w.glTexture=null,(l$z=this._curSubmit=l$zi.createSubmit(this,this._ib,l$L,l$L._byteLength/32*3,l$Zi.create(2,0))).shaderValue.defines.add(2),l$z.shaderValue.fillStyle=l$U.create(l$i),this._submits[this._submits._length++]=l$z),l$Ni.fillQuadrangleImgVb(l$L,l$_,l$R,l$r,l$k.DEF_UV,l$b||this._curMat,this._x,this._y);l$z._numEle+=6},l$_.drawTexture2=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){if(0!=l$z){var l$x=this._curMat;if(this._x=l$i*l$x.a+l$_*l$x.c,this._y=l$_*l$x.d+l$i*l$x.b,l$b&&(l$b=l$x.bTransform||l$b.bTransform?(l$q.mul(l$b,l$x,l$Y._tmpMatrix),l$Y._tmpMatrix):(this._x+=l$b.tx+l$x.tx,this._y+=l$b.ty+l$x.ty,l$q.EMPTY)),1!==l$z||l$L){var l$P=this._shader2D.ALPHA,l$B=this._nBlendType;this._shader2D.ALPHA=l$z,l$L&&(this._nBlendType=l$D.TOINT(l$L)),this._drawTextureM(l$w[0],l$w[1]-l$R,l$w[2]-l$r,l$w[3],l$w[4],0,0,l$b,1),this._shader2D.ALPHA=l$P,this._nBlendType=l$B}else this._drawTextureM(l$w[0],l$w[1]-l$R,l$w[2]-l$r,l$w[3],l$w[4],0,0,l$b,1);this._x=this._y=0}},l$_.drawCanvas=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$i.context;if(this._renderKey=0,l$z._targets)this._submits[this._submits._length++]=l$oi.create(l$z,0,null),this._curSubmit=l$zi.RENDERBASE,l$z._targets.drawTo(this,l$_,l$R,l$r,l$b);else{var l$L=this._submits[this._submits._length++]=l$oi.create(l$z,this._shader2D.ALPHA,this._shader2D.filters),l$w=l$r/l$i.width,l$x=l$b/l$i.height,l$P=l$L._matrix;this._curMat.copyTo(l$P),1!=l$w&&1!=l$x&&l$P.scale(l$w,l$x);var l$B=l$P.tx,l$n=l$P.ty;l$P.tx=l$P.ty=0,l$P.transformPoint(l$j.TEMP.setTo(l$_,l$R)),l$P.translate(l$j.TEMP.x+l$B,l$j.TEMP.y+l$n),this._curSubmit=l$zi.RENDERBASE}l$A.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=l$z._targets?"yellow":"green",this.strokeRect(l$_-1,l$R-1,l$r+2,l$b+2,1),this.strokeRect(l$_,l$R,l$r,l$b,1),this.restore())},l$_.drawTarget=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){void 0===l$P&&(l$P=-1);var l$B=this._vb;if(l$Ni.fillRectImgVb(l$B,this._clipRect,l$_,l$R,l$r,l$b,l$x||l$k.DEF_UV,l$z||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var l$n=this._curSubmit=l$ni.create(this,this._ib,l$B,(l$B._byteLength-64)/32*3,l$w,l$L);l$n.blendType=-1==l$P?this._nBlendType:l$P,l$n.scope=l$i,this._submits[this._submits._length++]=l$n,this._curSubmit._numEle+=6}},l$_.mixRGBandAlpha=function(l$i){return this._mixRGBandAlpha(l$i,this._shader2D.ALPHA)},l$_._mixRGBandAlpha=function(l$i,l$_){var l$R=(4278190080&l$i)>>>24;return 0!=l$R?l$R*=l$_:l$R=255*l$_,16777215&l$i|l$R<<24},l$_.drawTriangles=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){if(!l$i.loaded||!l$i.source)return this.sprite&&l$l.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;l$i.bitmap;var l$B=this._mixRGBandAlpha(4294967295,l$w),l$n=(l$r.length,l$z.length);this._renderKey=-1;var l$f=this._curSubmit=l$pi.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,l$Zi.create(1,0));return l$f.shaderValue.textureHost=l$i,l$f._renderType=10016,this._submits[this._submits._length++]=l$f,l$L?(l$Y._tmpMatrix.a=l$L.a,l$Y._tmpMatrix.b=l$L.b,l$Y._tmpMatrix.c=l$L.c,l$Y._tmpMatrix.d=l$L.d,l$Y._tmpMatrix.tx=l$L.tx+l$_,l$Y._tmpMatrix.ty=l$L.ty+l$R,l$q.mul(l$Y._tmpMatrix,this._curMat,l$Y._tmpMatrix)):(l$Y._tmpMatrix.a=this._curMat.a,l$Y._tmpMatrix.b=this._curMat.b,l$Y._tmpMatrix.c=this._curMat.c,l$Y._tmpMatrix.d=this._curMat.d,l$Y._tmpMatrix.tx=this._curMat.tx+l$_,l$Y._tmpMatrix.ty=this._curMat.ty+l$R),this._triangleMesh.addData(l$r,l$b,l$z,l$Y._tmpMatrix,l$B,this),this._curSubmit._numEle+=l$n,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},l$_.transform=function(l$i,l$_,l$R,l$r,l$b,l$z){l$d.save(this),l$q.mul(l$q.TEMP.setTo(l$i,l$_,l$R,l$r,l$b,l$z),this._curMat,this._curMat),this._curMat._checkTransform()},l$_.setTransformByMatrix=function(l$i){l$i.copyTo(this._curMat)},l$_.transformByMatrix=function(l$i){l$d.save(this),l$q.mul(l$i,this._curMat,this._curMat),this._curMat._checkTransform()},l$_.rotate=function(l$i){l$d.save(this),this._curMat.rotateEx(l$i)},l$_.scale=function(l$i,l$_){l$d.save(this),this._curMat.scaleEx(l$i,l$_)},l$_.clipRect=function(l$i,l$_,l$R,l$r){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var l$b=l$Bi.create(4);this.addRenderObject(l$b);var l$z=this._vb,l$L=l$z._byteLength>>2;if(l$Ni.fillRectImgVb(l$z,null,l$i,l$_,l$R,l$r,l$k.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var l$w=this._curSubmit=l$zi.createSubmit(this,this._ib,l$z,(l$z._byteLength-64)/32*3,l$Zi.create(2,0));l$w.shaderValue.ALPHA=1,this._submits[this._submits._length++]=l$w,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var l$x=l$Bi.create(5);this.addRenderObject(l$x);var l$P=l$z.getFloat32Array(),l$B=Math.min(Math.min(Math.min(l$P[0+l$L],l$P[4+l$L]),l$P[8+l$L]),l$P[12+l$L]),l$n=Math.max(Math.max(Math.max(l$P[0+l$L],l$P[4+l$L]),l$P[8+l$L]),l$P[12+l$L]),l$f=Math.min(Math.min(Math.min(l$P[1+l$L],l$P[5+l$L]),l$P[9+l$L]),l$P[13+l$L]),l$J=Math.max(Math.max(Math.max(l$P[1+l$L],l$P[5+l$L]),l$P[9+l$L]),l$P[13+l$L]);l$a.save(this,l$x,l$i,l$_,l$R,l$r,l$B,l$f,l$n-l$B,l$J-l$f),this._curSubmit=l$zi.RENDERBASE}else{l$R*=this._curMat.a,l$r*=this._curMat.d;var l$h=l$j.TEMP;this._curMat.transformPoint(l$h.setTo(l$i,l$_)),l$R<0&&(l$h.x=l$h.x+l$R,l$R=-l$R),l$r<0&&(l$h.y=l$h.y+l$r,l$r=-l$r),this._renderKey=0;var l$M=this._curSubmit=l$Pi.create(this);(this._submits[this._submits._length++]=l$M).submitIndex=this._submits._length,l$M.submitLength=9999999,l$y.save(this,l$M);var l$N=this._clipRect,l$X=l$N.x,l$t=l$N.y,l$I=l$h.x+l$R,l$e=l$h.y+l$r;l$X<l$h.x&&(l$N.x=l$h.x),l$t<l$h.y&&(l$N.y=l$h.y),l$N.width=Math.min(l$I,l$X+l$N.width)-l$N.x,l$N.height=Math.min(l$e,l$t+l$N.height)-l$N.y,this._shader2D.glTexture=null,l$M.clipRect.copyFrom(l$N),this._curSubmit=l$zi.RENDERBASE}},l$_.setIBVB=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B){if(void 0===l$x&&(l$x=0),void 0===l$P&&(l$P=0),void 0===l$B&&(l$B=0),null===l$R){if(l$X.isFlash){var l$n=l$r;l$n._selfIB||(l$n._selfIB=l$Wi.create(35044)),l$n._selfIB.clear(),l$R=l$n._selfIB}else l$R=this._ib;l$Ni.expandIBQuadrangle(l$R,l$r._byteLength/(4*l$r.vertexStride*4))}if(!l$w||!l$L)throw Error("setIBVB must input:shader shaderValues");var l$f=l$xi.create(this,l$r,l$R,l$b,l$L,l$w,l$x,l$P,l$B);l$z||(l$z=l$q.EMPTY),l$z.translate(l$i,l$_),l$q.mul(l$z,this._curMat,l$f._mat),l$z.translate(-l$i,-l$_),this._submits[this._submits._length++]=l$f,this._curSubmit=l$zi.RENDERBASE,this._renderKey=0},l$_.addRenderObject=function(l$i){this._submits[this._submits._length++]=l$i},l$_.fillTrangles=function(l$i,l$_,l$R,l$r,l$b){var l$z=this._curSubmit,l$L=this._vb,l$w=this._shader2D,l$x=l$z.shaderValue,l$P=l$r.length>>4,l$B=l$i.bitmap;this._renderKey=0,l$w.glTexture==l$B&&l$w.ALPHA===l$x.ALPHA||((l$z=this._curSubmit=l$zi.createSubmit(this,this._ib,l$L,l$L._byteLength/32*3,l$Zi.create(1,0))).shaderValue.textureHost=l$i,this._submits[this._submits._length++]=l$z),l$Ni.fillTranglesVB(l$L,l$_,l$R,l$r,l$b||this._curMat,this._x,this._y),l$z._numEle+=6*l$P},l$_.submitElement=function(l$i,l$_){var l$R=this._submits;for(l$_<0&&(l$_=l$R._length);l$i<l$_;)l$i+=l$R[l$i].renderSubmit()},l$_.finish=function(){l$ei.mainContext.finish()},l$_.flush=function(){var l$i=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(l$i>this._ib.bufferLength/12&&l$Ni.expandIBQuadrangle(this._ib,l$i),!this._isMain&&l$C.enabled&&l$C._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=l$C._atlasRestore;for(var l$_=this._submits,l$R=0,l$r=l$_._length;l$R<l$r;l$R++){var l$b=l$_[l$R];10016===l$b.getRenderType()&&l$b.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),l$_i.instance&&l$_i.getInstance().reset();var l$z;for(l$R=0,l$z=this.meshlist.length;l$R<l$z;l$R++){var l$L=this.meshlist[l$R];l$L.canReuse?l$L.releaseMesh():l$L.destroy()}return this.meshlist.length=0,this._curSubmit=l$zi.RENDERBASE,this._renderKey=0,this._triangleMesh=l$ki.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},l$_.setPathId=function(l$i){if(this.mId=l$i,-1!=this.mId){this.mHaveKey=!1;var l$_=l$O.getInstance();l$_.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,l$_.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},l$_.movePath=function(l$i,l$_){var l$R=l$i,l$r=l$_;l$i=this._curMat.a*l$R+this._curMat.c*l$r+this._curMat.tx,l$_=this._curMat.b*l$R+this._curMat.d*l$r+this._curMat.ty,this.mX+=l$i,this.mY+=l$_},l$_.beginPath=function(){var l$i=this._getPath();l$i.tempArray.length=0,l$i.closePath=!1,this.mX=0,this.mY=0},l$_.closePath=function(){this._path.closePath=!0},l$_.fill=function(l$i){void 0===l$i&&(l$i=!1);var l$_=this._getPath();this.drawPoly(0,0,l$_.tempArray,this.fillStyle._color.numColor,0,0,l$i)},l$_.stroke=function(){var l$i=this._getPath();if(0<this.lineWidth){if(-1==this.mId)l$i.drawLine(0,0,l$i.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var l$_=l$O.getInstance().shapeLineDic[this.mId];l$_.rebuild(l$i.tempArray),l$i.setGeomtry(l$_)}else l$O.getInstance().addLine(this.mId,l$i.drawLine(0,0,l$i.tempArray,this.lineWidth,this.strokeStyle._color.numColor));l$i.update();var l$R=[this.mX,this.mY],l$r=l$zi.createShape(this,l$i.ib,l$i.vb,l$i.count,l$i.offset,l$Zi.create(4,0));l$r.shaderValue.ALPHA=this._shader2D.ALPHA,l$r.shaderValue.u_pos=l$R,l$r.shaderValue.u_mmat2=l$ti.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=l$r,this._renderKey=-1}},l$_.line=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=this._curSubmit,l$w=this._vb;if(l$Ni.fillLineVb(l$w,this._clipRect,l$i,l$_,l$R,l$r,l$b,l$z)){this._renderKey=0;var l$x=this._shader2D,l$P=l$L.shaderValue;l$x.strokeStyle===l$P.strokeStyle&&l$x.ALPHA===l$P.ALPHA||(l$x.glTexture=null,(l$L=this._curSubmit=l$zi.createSubmit(this,this._ib,l$w,(l$w._byteLength-64)/32*3,l$Zi.create(2,0))).shaderValue.strokeStyle=l$x.strokeStyle,l$L.shaderValue.mainID=2,l$L.shaderValue.ALPHA=l$x.ALPHA,this._submits[this._submits._length++]=l$L),l$L._numEle+=6}},l$_.moveTo=function(l$i,l$_,l$R){void 0===l$R&&(l$R=!0);var l$r=this._getPath();if(l$R){var l$b=l$i,l$z=l$_;l$i=this._curMat.a*l$b+this._curMat.c*l$z,l$_=this._curMat.b*l$b+this._curMat.d*l$z}l$r.addPoint(l$i,l$_)},l$_.lineTo=function(l$i,l$_,l$R){void 0===l$R&&(l$R=!0);var l$r=this._getPath();if(l$R){var l$b=l$i,l$z=l$_;l$i=this._curMat.a*l$b+this._curMat.c*l$z,l$_=this._curMat.b*l$b+this._curMat.d*l$z}l$r.addPoint(l$i,l$_)},l$_.drawCurves=function(l$i,l$_,l$R){this.setPathId(-1),this.beginPath(),this.strokeStyle=l$R[3],this.lineWidth=l$R[4];var l$r=l$R[2];l$i+=l$R[0],l$_+=l$R[1],this.movePath(l$i,l$_),this.moveTo(l$r[0],l$r[1]);for(var l$b=2,l$z=l$r.length;l$b<l$z;)this.quadraticCurveTo(l$r[l$b++],l$r[l$b++],l$r[l$b++],l$r[l$b++]);this.stroke()},l$_.arcTo=function(l$i,l$_,l$R,l$r,l$b){if(-1==this.mId||!this.mHaveKey){var l$z=0,l$L=0,l$w=0,l$x=this._getPath();this._curMat.copyTo(l$Y._tmpMatrix),l$Y._tmpMatrix.tx=l$Y._tmpMatrix.ty=0,l$Y._tempPoint.setTo(l$x.getEndPointX(),l$x.getEndPointY()),l$Y._tmpMatrix.invertTransformPoint(l$Y._tempPoint);var l$P=l$Y._tempPoint.x-l$i,l$B=l$Y._tempPoint.y-l$_,l$n=Math.sqrt(l$P*l$P+l$B*l$B);if(!(l$n<=1e-6)){var l$f=l$P/l$n,l$J=l$B/l$n,l$h=l$R-l$i,l$M=l$r-l$_,l$N=l$h*l$h+l$M*l$M,l$X=Math.sqrt(l$N);if(!(l$X<=1e-6)){var l$t=l$h/l$X,l$I=l$M/l$X,l$e=l$f+l$t,l$c=l$J+l$I,l$l=Math.sqrt(l$e*l$e+l$c*l$c);if(!(l$l<=1e-6)){var l$A=l$e/l$l,l$Z=l$c/l$l,l$q=Math.acos(l$A*l$f+l$Z*l$J),l$j=Math.PI/2-l$q,l$S=(l$n=l$b/Math.tan(l$j))*l$f+l$i,l$v=l$n*l$J+l$_,l$$=Math.sqrt(l$n*l$n+l$b*l$b),l$G=l$i+l$A*l$$,l$u=l$_+l$Z*l$$,l$o=0,l$p=0;if(0<=l$f*l$I-l$J*l$t){var l$k=2*l$j/l$Y.SEGNUM;l$o=Math.sin(l$k),l$p=Math.cos(l$k)}else l$k=2*-l$j/l$Y.SEGNUM,l$o=Math.sin(l$k),l$p=Math.cos(l$k);l$L=this._curMat.a*l$S+this._curMat.c*l$v,l$w=this._curMat.b*l$S+this._curMat.d*l$v,l$L==this._path.getEndPointX()&&l$w==this._path.getEndPointY()||l$x.addPoint(l$L,l$w);var l$K=l$S-l$G,l$O=l$v-l$u;for(l$z=0;l$z<l$Y.SEGNUM;l$z++){var l$E=l$K*l$p+l$O*l$o,l$s=-l$K*l$o+l$O*l$p;l$L=l$E+l$G,l$w=l$s+l$u,l$i=this._curMat.a*l$L+this._curMat.c*l$w,l$w=l$_=this._curMat.b*l$L+this._curMat.d*l$w,(l$L=l$i)==this._path.getEndPointX()&&l$w==this._path.getEndPointY()||l$x.addPoint(l$L,l$w),l$K=l$E,l$O=l$s}}}}}},l$_.arc=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){if(void 0===l$z&&(l$z=!1),void 0===l$L&&(l$L=!0),-1!=this.mId){var l$w=l$O.getInstance().shapeDic[this.mId];if(l$w&&this.mHaveKey&&!l$w.needUpdate(this._curMat))return;l$_=l$i=0}var l$x,l$P=0,l$B=0,l$n=0,l$f=0,l$J=0,l$h=0,l$M=0;if(l$B=l$b-l$r,l$z)if(Math.abs(l$B)>=2*Math.PI)l$B=2*-Math.PI;else for(;0<l$B;)l$B-=2*Math.PI;else if(Math.abs(l$B)>=2*Math.PI)l$B=2*Math.PI;else for(;l$B<0;)l$B+=2*Math.PI;l$x=l$B/(l$M=l$R<101?Math.max(10,l$B*l$R/5):l$R<201?Math.max(10,l$B*l$R/20):Math.max(10,l$B*l$R/40))/2,l$n=Math.abs(4/3*(1-Math.cos(l$x))/Math.sin(l$x)),l$z&&(l$n=-l$n);var l$N=this._getPath(),l$X=NaN,l$t=NaN;for(l$h=0;l$h<=l$M;l$h++)l$P=l$r+l$B*(l$h/l$M),l$f=l$i+Math.cos(l$P)*l$R,l$J=l$_+Math.sin(l$P)*l$R,l$L&&(l$X=l$f,l$t=l$J,l$f=this._curMat.a*l$X+this._curMat.c*l$t,l$J=this._curMat.b*l$X+this._curMat.d*l$t),l$f==this._path.getEndPointX()&&l$J==this._path.getEndPointY()||l$N.addPoint(l$f,l$J);l$f=l$i+Math.cos(l$b)*l$R,l$J=l$_+Math.sin(l$b)*l$R,l$L&&(l$X=l$f,l$t=l$J,l$f=this._curMat.a*l$X+this._curMat.c*l$t,l$J=this._curMat.b*l$X+this._curMat.d*l$t),l$f==this._path.getEndPointX()&&l$J==this._path.getEndPointY()||l$N.addPoint(l$f,l$J)},l$_.quadraticCurveTo=function(l$i,l$_,l$R,l$r){var l$b=l$n.I,l$z=l$R,l$L=l$r;l$R=this._curMat.a*l$z+this._curMat.c*l$L,l$r=this._curMat.b*l$z+this._curMat.d*l$L,l$z=l$i,l$L=l$_,l$i=this._curMat.a*l$z+this._curMat.c*l$L,l$_=this._curMat.b*l$z+this._curMat.d*l$L;for(var l$w=l$b.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),l$i,l$_,l$R,l$r],30,2),l$x=0,l$P=l$w.length/2;l$x<l$P;l$x++)this.lineTo(l$w[2*l$x],l$w[2*l$x+1],!1);this.lineTo(l$R,l$r,!1)},l$_.rect=function(l$i,l$_,l$R,l$r){this._other=this._other.make(),this._other.path||(this._other.path=new l$g),this._other.path.rect(l$i,l$_,l$R,l$r)},l$_.strokeRect=function(l$i,l$_,l$R,l$r,l$b){var l$z=.5*l$b;this.line(l$i-l$z,l$_,l$i+l$R+l$z,l$_,l$b,this._curMat),this.line(l$i+l$R,l$_,l$i+l$R,l$_+l$r,l$b,this._curMat),this.line(l$i,l$_,l$i,l$_+l$r,l$b,this._curMat),this.line(l$i-l$z,l$_+l$r,l$i+l$R+l$z,l$_+l$r,l$b,this._curMat)},l$_.clip=function(){},l$_.drawPoly=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){void 0===l$L&&(l$L=!1),this._renderKey=0,this._shader2D.glTexture=null;var l$w=this._getPath();if(-1==this.mId)l$w.polygon(l$i,l$_,l$R,l$r,l$b||1,l$z);else if(this.mHaveKey){var l$x=l$O.getInstance().shapeDic[this.mId];l$x.setMatrix(this._curMat),l$x.rebuild(l$w.tempArray),l$w.setGeomtry(l$x)}else{var l$P=l$w.polygon(l$i,l$_,l$R,l$r,l$b||1,l$z);l$O.getInstance().addShape(this.mId,l$P),l$P.setMatrix(this._curMat)}l$w.update();var l$B,l$n=[this.mX,this.mY];if((l$B=l$zi.createShape(this,l$w.ib,l$w.vb,l$w.count,l$w.offset,l$Zi.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,l$B.shaderValue.u_pos=l$n,l$B.shaderValue.u_mmat2=l$ti.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=l$B,0<l$b){if(this.mHaveLineKey){var l$f=l$O.getInstance().shapeLineDic[this.mId];l$f.rebuild(l$w.tempArray),l$w.setGeomtry(l$f)}else l$O.getInstance().addShape(this.mId,l$w.drawLine(l$i,l$_,l$R,l$b,l$z));l$w.update(),(l$B=l$zi.createShape(this,l$w.ib,l$w.vb,l$w.count,l$w.offset,l$Zi.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,l$B.shaderValue.u_mmat2=l$ti.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=l$B}},l$_.drawParticle=function(l$i,l$_,l$R){l$R.x=l$i,l$R.y=l$_,this._submits[this._submits._length++]=l$R},l$_._getPath=function(){return this._path||(this._path=new l$g)},l$r(0,l$_,"globalCompositeOperation",function(){return l$D.NAMES[this._nBlendType]},function(l$i){var l$_=l$D.TOINT[l$i];null==l$_||this._nBlendType===l$_||(l$V.save(this,65536,this,!0),this._curSubmit=l$zi.RENDERBASE,this._renderKey=0,this._nBlendType=l$_)}),l$r(0,l$_,"strokeStyle",function(){return this._shader2D.strokeStyle},function(l$i){this._shader2D.strokeStyle.equal(l$i)||(l$V.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=l$U.create(l$i))}),l$r(0,l$_,"globalAlpha",function(){return this._shader2D.ALPHA},function(l$i){(l$i=Math.floor(1e3*l$i)/1e3)!=this._shader2D.ALPHA&&(l$V.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=l$i)}),l$r(0,l$_,"asBitmap",null,function(l$i){if(l$i){if(this._targets||(this._targets=new l$H),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),l$r(0,l$_,"fillStyle",function(){return this._shader2D.fillStyle},function(l$i){this._shader2D.fillStyle.equal(l$i)||(l$V.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=l$U.create(l$i))}),l$r(0,l$_,"textAlign",function(){return this._other.textAlign},function(l$i){this._other.textAlign===l$i||(this._other=this._other.make(),l$V.save(this,32768,this._other,!1),this._other.textAlign=l$i)}),l$r(0,l$_,"lineWidth",function(){return this._other.lineWidth},function(l$i){this._other.lineWidth===l$i||(this._other=this._other.make(),l$V.save(this,256,this._other,!1),this._other.lineWidth=l$i)}),l$r(0,l$_,"textBaseline",function(){return this._other.textBaseline},function(l$i){this._other.textBaseline===l$i||(this._other=this._other.make(),l$V.save(this,16384,this._other,!1),this._other.textBaseline=l$i)}),l$r(0,l$_,"font",null,function(l$i){l$i!=this._other.font.toString()&&(this._other=this._other.make(),l$V.save(this,8,this._other,!1),this._other.font===l$hi.EMPTY?this._other.font=new l$hi(l$i):this._other.font.setFont(l$i))}),l$Y.__init__=function(){l$R.DEFAULT=new l$R},l$Y._tempPoint=new l$j,l$Y._SUBMITVBSIZE=32e3,l$Y._MAXSIZE=99999999,l$Y._RECTVBSIZE=16,l$Y.MAXCLIPRECT=new l$S(0,0,99999999,99999999),l$Y._COUNT=0,l$Y._tmpMatrix=new l$q,l$Y.SEGNUM=32,l$Y._contextcount=0,l$L(l$Y,["_fontTemp",function(){return this._fontTemp=new l$hi},"_drawStyleTemp",function(){return this._drawStyleTemp=new l$U(null)}]),l$Y.__init$=function(){l$R=function(){function l$i(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=l$hi.EMPTY}l$f(l$i,"");var l$_=l$i.prototype;return l$_.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=l$hi.EMPTY},l$_.make=function(){return this===l$i.DEFAULT?new l$i:this},l$i.DEFAULT=null,l$i}()},l$Y}(),l$Zi=function(l$i){function l$r(l$i,l$_){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,l$r.__super.call(this),this.defines=new l$vi,this.position=l$r._POSITION,this.mainID=l$i,this.subID=l$_,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=l$i|l$_,this._inClassCache=l$r._cache[this._cacheID],0<l$i&&!this._inClassCache&&(this._inClassCache=l$r._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}l$f(l$r,"laya.webgl.shader.d2.value.Value2D",l$s);var l$_=l$r.prototype;return l$_.setValue=function(l$i){},l$_.refresh=function(){var l$i=this.size;return l$i[0]=l$ti.width,l$i[1]=l$ti.height,this.alpha=this.ALPHA*l$ti.worldAlpha,this.mmat=l$ti.worldMatrix4,this},l$_._ShaderWithCompile=function(){return l$Fi.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,l$Hi.create)},l$_._withWorldShaderDefines=function(){var l$i=l$ti.worldShaderDefines,l$_=l$Fi.sharders[this.mainID|this.defines._value|l$i.getValue()];if(!l$_){var l$R,l$r={};for(l$R in this.defines.toNameDic())l$r[l$R]="";for(l$R in l$i.toNameDic())l$r[l$R]="";l$_=l$Fi.withCompile2D(0,this.mainID,l$r,this.mainID|this.defines._value|l$i.getValue(),l$Hi.create)}var l$b=l$ti.worldFilters;if(!l$b)return l$_;for(var l$z,l$L=l$b.length,l$w=0;l$w<l$L;l$w++)(l$z=l$b[l$w])&&l$z.action.setValue(this);return l$_},l$_.upload=function(){var l$i=l$ti;this.alpha=this.ALPHA*l$i.worldAlpha,l$ti.worldMatrix4!==l$ti.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),l$ei.shaderHighPrecision&&this.defines.add(1024);var l$_,l$R=l$i.worldShaderDefines?this._withWorldShaderDefines():l$Fi.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=l$i.width,this.size[1]=l$i.height,this.mmat=l$i.worldMatrix4,l$Ki.activeShader!==l$R?l$R._shaderValueWidth!==l$i.width||l$R._shaderValueHeight!==l$i.height?(l$R._shaderValueWidth=l$i.width,l$R._shaderValueHeight=l$i.height):l$_=l$R._params2dQuick2||l$R._make2dQuick2():l$R._shaderValueWidth!==l$i.width||l$R._shaderValueHeight!==l$i.height?(l$R._shaderValueWidth=l$i.width,l$R._shaderValueHeight=l$i.height):l$_=l$R._params2dQuick1||l$R._make2dQuick1(),l$R.upload(this,l$_)},l$_.setFilters=function(l$i){if(this.filters=l$i)for(var l$_,l$R=l$i.length,l$r=0;l$r<l$R;l$r++)(l$_=l$i[l$r])&&(this.defines.add(l$_.type),l$_.action.setValue(this))},l$_.clear=function(){this.defines.setValue(this.subID)},l$_.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},l$r._initone=function(l$i,l$_){l$r._typeClass[l$i]=l$_,l$r._cache[l$i]=[],l$r._cache[l$i]._length=0},l$r.__init__=function(){l$r._POSITION=[2,5126,!1,4*l$Mi.BYTES_PE,0],l$r._TEXCOORD=[2,5126,!1,4*l$Mi.BYTES_PE,2*l$Mi.BYTES_PE],l$r._initone(2,l$Yi),l$r._initone(4,l$Di),l$r._initone(256,l$Ci),l$r._initone(512,l$si),l$r._initone(1,l$mi),l$r._initone(65,l$Qi),l$r._initone(9,l$mi)},l$r.create=function(l$i,l$_){var l$R=l$r._cache[l$i|l$_];return l$R._length?l$R[--l$R._length]:new l$r._typeClass[l$i|l$_](l$_)},l$r._POSITION=null,l$r._TEXCOORD=null,l$r._cache=[],l$r._typeClass=[],l$r.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l$r}(),l$qi=function(l$i){function l$N(l$i,l$_){l$N.__super.call(this,l$i,l$_)}l$f(l$N,"laya.webgl.utils.RenderSprite3D",l$t);var l$_=l$N.prototype;return l$_.onCreate=function(l$i){switch(l$i){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},l$_._mask=function(l$i,l$_,l$R,l$r){var l$b,l$z,l$L=this._next,l$w=l$i.mask;if(l$w){l$_.ctx.save();var l$x=l$_.ctx.globalCompositeOperation,l$P=new l$S;if(l$P.copyFrom(l$w.getBounds()),l$P.width=Math.round(l$P.width),l$P.height=Math.round(l$P.height),l$P.x=Math.round(l$P.x),l$P.y=Math.round(l$P.y),0<l$P.width&&0<l$P.height){var l$B=l$i._style._tf,l$n=l$wi.create();l$n.addValue("bounds",l$P),l$b=l$Li.create([l$n,l$_],laya.webgl.utils.RenderSprite3D.tmpTarget),l$_.addRenderObject(l$b),l$w.render(l$_,-l$P.x,-l$P.y),l$b=l$Li.create([l$n],laya.webgl.utils.RenderSprite3D.endTmpTarget),l$_.addRenderObject(l$b),l$_.ctx.save(),l$_.clipRect(l$R-l$B.translateX+l$P.x,l$r-l$B.translateY+l$P.y,l$P.width,l$P.height),l$L._fun.call(l$L,l$i,l$_,l$R,l$r),l$_.ctx.restore(),l$z=l$Bi.create(6),l$x=l$_.ctx.globalCompositeOperation,l$z.blendMode="mask",l$_.addRenderObject(l$z),l$q.TEMP.identity();var l$f=l$Zi.create(1,0),l$J=l$k.INV_UV,l$h=l$P.width,l$M=l$P.height;(l$P.width<32||l$P.height<32)&&((l$J=l$N.tempUV)[0]=0,l$J[1]=0,l$J[2]=32<=l$P.width?1:l$P.width/32,l$J[3]=0,l$J[4]=32<=l$P.width?1:l$P.width/32,l$J[5]=32<=l$P.height?1:l$P.height/32,l$J[6]=0,l$J[7]=32<=l$P.height?1:l$P.height/32,l$P.width=32<=l$P.width?l$P.width:32,l$P.height=32<=l$P.height?l$P.height:32,l$J[1]*=-1,l$J[3]*=-1,l$J[5]*=-1,l$J[7]*=-1,l$J[1]+=1,l$J[3]+=1,l$J[5]+=1,l$J[7]+=1),l$_.ctx.drawTarget(l$n,l$R+l$P.x-l$B.translateX,l$r+l$P.y-l$B.translateY,l$h,l$M,l$q.TEMP,"tmpTarget",l$f,l$J,6),l$b=l$Li.create([l$n],laya.webgl.utils.RenderSprite3D.recycleTarget),l$_.addRenderObject(l$b),(l$z=l$Bi.create(6)).blendMode=l$x,l$_.addRenderObject(l$z)}l$_.ctx.restore()}else l$L._fun.call(l$L,l$i,l$_,l$R,l$r)},l$_._blend=function(l$i,l$_,l$R,l$r){var l$b=l$i._style,l$z=this._next;l$b.blendMode?(l$_.ctx.save(),l$_.ctx.globalCompositeOperation=l$b.blendMode,l$z._fun.call(l$z,l$i,l$_,l$R,l$r),l$_.ctx.restore()):l$z._fun.call(l$z,l$i,l$_,l$R,l$r)},l$_._transform=function(l$i,l$_,l$R,l$r){var l$b=l$i.transform,l$z=this._next;if(l$b&&l$z!=l$t.NORENDER){var l$L=l$_.ctx;l$i._style;l$b.tx=l$R,l$b.ty=l$r;var l$w=l$L._getTransformMatrix(),l$x=l$w.clone();l$q.mul(l$b,l$w,l$w),l$w._checkTransform(),l$b.tx=l$b.ty=0,l$z._fun.call(l$z,l$i,l$_,0,0),l$x.copyTo(l$w),l$x.destroy()}else l$z._fun.call(l$z,l$i,l$_,l$R,l$r)},l$N.tmpTarget=function(l$i,l$_){var l$R=l$i.getValue("bounds"),l$r=l$Oi.create(l$R.width,l$R.height);l$r.start(),l$r.clear(0,0,0,0),l$i.addValue("tmpTarget",l$r)},l$N.endTmpTarget=function(l$i){l$i.getValue("tmpTarget").end()},l$N.recycleTarget=function(l$i){l$i.getValue("tmpTarget").recycle(),l$i.recycle()},l$L(l$N,["tempUV",function(){return this.tempUV=new Array(8)}]),l$N}(),l$ji=function(l$i){function l$_(){this.data=null,l$_.__super.call(this)}l$f(l$_,"laya.filters.webgl.ColorFilterActionGL",l$E);var l$R=l$_.prototype;return l$l.imps(l$R,{"laya.filters.IFilterActionGL":!0}),l$R.setValue=function(l$i){l$i.colorMat=this.data._mat,l$i.colorAlpha=this.data._alpha},l$R.apply3d=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$i.getValue("bounds"),l$L=l$Zi.create(1,0);l$L.setFilters([this.data]);var l$w=l$q.TEMP;l$w.identity(),l$R.ctx.drawTarget(l$i,0,0,l$z.width,l$z.height,l$w,"src",l$L)},l$_}(),l$Si=function(l$i){function l$z(l$i,l$_,l$R,l$r,l$b){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,l$z.__super.call(this,l$i,l$_,l$b),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new l$Ui,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=l$R,this._atlasCanvas.height=l$r,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}l$f(l$z,"laya.webgl.atlas.Atlaser",l$Y);var l$_=l$z.prototype;return l$_.computeUVinAtlasTexture=function(l$i,l$_,l$R,l$r){var l$b=l$C.atlasTextureWidth,l$z=l$C.atlasTextureHeight,l$L=l$R/l$b,l$w=l$r/l$z,l$x=(l$R+l$i.bitmap.width)/l$b,l$P=(l$r+l$i.bitmap.height)/l$z,l$B=l$i.bitmap.width/l$b,l$n=l$i.bitmap.height/l$z;l$i.uv=[l$L+l$_[0]*l$B,l$w+l$_[1]*l$n,l$x-(1-l$_[2])*l$B,l$w+l$_[3]*l$n,l$x-(1-l$_[4])*l$B,l$P-(1-l$_[5])*l$n,l$L+l$_[6]*l$B,l$P-(1-l$_[7])*l$n]},l$_.findBitmapIsExist=function(l$i){if(l$i instanceof laya.webgl.resource.WebGLImage){var l$_=l$i,l$R=l$_.url,l$r=this._InAtlasWebGLImagesKey[l$R||l$_.id];if(l$r)return l$r.offsetInfoID}return-1},l$_.addToAtlasTexture=function(l$i,l$_,l$R){if(l$i instanceof laya.webgl.resource.WebGLImage){var l$r=l$i,l$b=l$r.url;this._InAtlasWebGLImagesKey[l$b||l$r.id]={bitmap:l$i,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([l$_,l$R])}this._atlasCanvas.texSubImage2D(l$_,l$R,l$i.atlasSource),l$i.clearAtlasSource()},l$_.addToAtlas=function(l$i,l$_,l$R){l$i._atlasID=this._inAtlasTextureKey.length;var l$r=l$i.uv.slice(),l$b=l$i.bitmap;this._inAtlasTextureKey.push(l$i),this._inAtlasTextureOriUVValue.push(l$r),this._inAtlasTextureBitmapValue.push(l$b),this.computeUVinAtlasTexture(l$i,l$r,l$_,l$R),l$i.bitmap=this._atlasCanvas},l$_.clear=function(){for(var l$i=0,l$_=this._inAtlasTextureKey.length;l$i<l$_;l$i++)this._inAtlasTextureKey[l$i].bitmap=this._inAtlasTextureBitmapValue[l$i],this._inAtlasTextureKey[l$i].uv=this._inAtlasTextureOriUVValue[l$i],this._inAtlasTextureKey[l$i]._atlasID=-1,this._inAtlasTextureKey[l$i].bitmap.lock=!1,this._inAtlasTextureKey[l$i].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},l$_.dispose=function(){this.clear(),this._atlasCanvas.destroy()},l$r(0,l$_,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),l$r(0,l$_,"texture",function(){return this._atlasCanvas}),l$r(0,l$_,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),l$z}(),l$vi=function(l$i){function l$R(){l$R.__super.call(this,l$R.__name2int,l$R.__int2name,l$R.__int2nameMap)}return l$f(l$R,"laya.webgl.shader.d2.ShaderDefines2D",l$T),l$R.__init__=function(){l$R.reg("TEXTURE2D",1),l$R.reg("COLOR2D",2),l$R.reg("PRIMITIVE",4),l$R.reg("GLOW_FILTER",8),l$R.reg("BLUR_FILTER",16),l$R.reg("COLOR_FILTER",32),l$R.reg("COLOR_ADD",64),l$R.reg("WORLDMAT",128),l$R.reg("FILLTEXTURE",256),l$R.reg("FSHIGHPRECISION",1024),l$R.reg("TXTALPHA",2048),l$R.reg("TXTCOMPRESS",4096)},l$R.reg=function(l$i,l$_){l$T._reg(l$i,l$_,l$R.__name2int,l$R.__int2name)},l$R.toText=function(l$i,l$_,l$R){return l$T._toText(l$i,l$_,l$R)},l$R.toInt=function(l$i){return l$T._toInt(l$i,l$R.__name2int)},l$R.TEXTURE2D=1,l$R.COLOR2D=2,l$R.PRIMITIVE=4,l$R.FILTERGLOW=8,l$R.FILTERBLUR=16,l$R.FILTERCOLOR=32,l$R.COLORADD=64,l$R.WORLDMAT=128,l$R.FILLTEXTURE=256,l$R.SKINMESH=512,l$R.SHADERDEFINE_FSHIGHPRECISION=1024,l$R.TXTALPHA=2048,l$R.TXTCOMPRESS=4096,l$R.__name2int={},l$R.__int2name=[],l$R.__int2nameMap=[],l$R}(),l$$i=(function(l$i){function l$w(l$i,l$_,l$R,l$r,l$b,l$z,l$L){l$w.__super.call(this,l$i,l$_,l$R,l$r,40,l$b,l$z,l$L)}l$f(l$w,"laya.webgl.shapes.Ellipse",l$Ri)}(),function(l$i){function l$z(l$i,l$_,l$R,l$r,l$b){this._points=[],this.rebuild(l$R),l$z.__super.call(this,l$i,l$_,0,0,0,l$b,l$r,l$b,0)}l$f(l$z,"laya.webgl.shapes.Line",l$Ri);var l$_=l$z.prototype;return l$_.rebuild=function(l$i){var l$_=l$i.length;l$_!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(l$_/2-1)),this.mFloat32Array=new Float32Array(5*l$_)),this._points.length=0;for(var l$R=NaN,l$r=NaN,l$b=-1,l$z=-1,l$L=l$i.length/2,l$w=0;l$w<l$L;l$w++)l$R=l$i[2*l$w],l$r=l$i[2*l$w+1],(.01<Math.abs(l$b-l$R)||.01<Math.abs(l$z-l$r))&&this._points.push(l$R,l$r),l$b=l$R,l$z=l$r},l$_.getData=function(l$i,l$_,l$R){var l$r=[],l$b=[];0<this.borderWidth&&this.createLine2(this._points,l$r,this.borderWidth,l$R,l$b,this._points.length/2),this.mUint16Array.set(l$r,0),this.mFloat32Array.set(l$b,0),l$i.append(this.mUint16Array),l$_.append(this.mFloat32Array)},l$z}()),l$Gi=function(l$i){function l$n(l$i,l$_,l$R,l$r,l$b){this._points=[];for(var l$z=NaN,l$L=NaN,l$w=-1,l$x=-1,l$P=l$R.length/2-1,l$B=0;l$B<l$P;l$B++)l$z=l$R[2*l$B],l$L=l$R[2*l$B+1],(.01<Math.abs(l$w-l$z)||.01<Math.abs(l$x-l$L))&&this._points.push(l$z,l$L),l$w=l$z,l$x=l$L;l$z=l$R[2*l$P],l$L=l$R[2*l$P+1],l$w=this._points[0],l$x=this._points[1],(.01<Math.abs(l$w-l$z)||.01<Math.abs(l$x-l$L))&&this._points.push(l$z,l$L),l$n.__super.call(this,l$i,l$_,0,0,this._points.length/2,0,l$r,l$b)}l$f(l$n,"laya.webgl.shapes.LoopLine",l$Ri);var l$_=l$n.prototype;return l$_.getData=function(l$i,l$_,l$R){if(0<this.borderWidth){for(var l$r=this.color,l$b=(l$r>>16&255)/255,l$z=(l$r>>8&255)/255,l$L=(255&l$r)/255,l$w=[],l$x=0,l$P=0,l$B=[],l$n=Math.floor(this._points.length/2),l$f=0;l$f<l$n;l$f++)l$x=this._points[2*l$f],l$P=this._points[2*l$f+1],l$w.push(this.x+l$x,this.y+l$P,l$b,l$z,l$L);this.createLoopLine(l$w,l$B,this.borderWidth,l$R+l$w.length/5),l$i.append(new Uint16Array(l$B)),l$_.append(new Float32Array(l$w))}},l$_.createLoopLine=function(l$i,l$_,l$R,l$r,l$b,l$z){l$i.length;var l$L=l$i.concat(),l$w=l$b||l$i,l$x=this.borderColor,l$P=(l$x>>16&255)/255,l$B=(l$x>>8&255)/255,l$n=(255&l$x)/255,l$f=[l$L[0],l$L[1]],l$J=[l$L[l$L.length-5],l$L[l$L.length-4]],l$h=l$J[0]+.5*(l$f[0]-l$J[0]),l$M=l$J[1]+.5*(l$f[1]-l$J[1]);l$L.unshift(l$h,l$M,0,0,0),l$L.push(l$h,l$M,0,0,0);var l$N,l$X,l$t,l$I,l$e,l$c,l$l,l$A,l$Z,l$q,l$j,l$S,l$v,l$$,l$G,l$u,l$o,l$p,l$k,l$K,l$O=l$L.length/5,l$E=l$r,l$s=l$R/2;l$t=l$L[0],l$I=l$L[1],l$q=l$t-(l$e=l$L[5]),l$Z=(l$Z=-(l$I-(l$c=l$L[6])))/(l$K=Math.sqrt(l$Z*l$Z+l$q*l$q))*l$s,l$q=l$q/l$K*l$s,l$w.push(l$t-l$Z,l$I-l$q,l$P,l$B,l$n,l$t+l$Z,l$I+l$q,l$P,l$B,l$n);for(var l$Y=1;l$Y<l$O-1;l$Y++)l$t=l$L[5*(l$Y-1)],l$I=l$L[5*(l$Y-1)+1],l$e=l$L[5*l$Y],l$c=l$L[5*l$Y+1],l$l=l$L[5*(l$Y+1)],l$A=l$L[5*(l$Y+1)+1],l$q=l$t-l$e,l$S=l$e-l$l,l$G=(-(l$Z=(l$Z=-(l$I-l$c))/(l$K=Math.sqrt(l$Z*l$Z+l$q*l$q))*l$s)+l$t)*(-(l$q=l$q/l$K*l$s)+l$c)-(-l$Z+l$e)*(-l$q+l$I),l$p=(-(l$j=(l$j=-(l$c-l$A))/(l$K=Math.sqrt(l$j*l$j+l$S*l$S))*l$s)+l$l)*(-(l$S=l$S/l$K*l$s)+l$c)-(-l$j+l$e)*(-l$S+l$A),l$k=(l$v=-l$q+l$I-(-l$q+l$c))*(l$o=-l$j+l$e-(-l$j+l$l))-(l$u=-l$S+l$A-(-l$S+l$c))*(l$$=-l$Z+l$e-(-l$Z+l$t)),Math.abs(l$k)<.1?(l$k+=10.1,l$w.push(l$e-l$Z,l$c-l$q,l$P,l$B,l$n,l$e+l$Z,l$c+l$q,l$P,l$B,l$n)):(((l$N=(l$$*l$p-l$o*l$G)/l$k)-l$e)*(l$N-l$e)+((l$X=(l$u*l$G-l$v*l$p)/l$k)-l$c)+(l$X-l$c),l$w.push(l$N,l$X,l$P,l$B,l$n,l$e-(l$N-l$e),l$c-(l$X-l$c),l$P,l$B,l$n));l$z&&(l$_=l$z);var l$C=this.edges+1;for(l$Y=1;l$Y<l$C;l$Y++)l$_.push(l$E+2*(l$Y-1),l$E+2*(l$Y-1)+1,l$E+2*l$Y+1,l$E+2*l$Y+1,l$E+2*l$Y,l$E+2*(l$Y-1));return l$_.push(l$E+2*(l$Y-1),l$E+2*(l$Y-1)+1,l$E+1,l$E+1,l$E,l$E+2*(l$Y-1)),l$w},l$n}(),l$ui=function(l$i){function l$L(l$i,l$_,l$R,l$r,l$b,l$z){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=l$q.create(),this._points=l$R.slice(0,l$R.length),l$L.__super.call(this,l$i,l$_,0,0,this._points.length/2,l$r,l$b,l$z)}l$f(l$L,"laya.webgl.shapes.Polygon",l$Ri);var l$_=l$L.prototype;return l$_.rebuild=function(l$i){this._repaint||(this._points.length=0,this._points=this._points.concat(l$i))},l$_.setMatrix=function(l$i){l$i.copyTo(this._mat)},l$_.needUpdate=function(l$i){return this._repaint=this._mat.a==l$i.a&&this._mat.b==l$i.b&&this._mat.c==l$i.c&&this._mat.d==l$i.d&&this._mat.tx==l$i.tx&&this._mat.ty==l$i.ty,!this._repaint},l$_.getData=function(l$i,l$_,l$R){var l$r,l$b=0,l$z=this._points,l$L=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=l$R){for(this._start=l$R,l$r=[],l$L=this.earcutTriangles.length,l$b=0;l$b<l$L;l$b++)l$r.push(this.earcutTriangles[l$b]+l$R);this.mUint16Array=new Uint16Array(l$r)}}else{this._start=l$R,l$r=[];var l$w=[],l$x=[],l$P=this.color,l$B=(l$P>>16&255)/255,l$n=(l$P>>8&255)/255,l$f=(255&l$P)/255;for(l$L=Math.floor(l$z.length/2),l$b=0;l$b<l$L;l$b++)l$w.push(this.x+l$z[2*l$b],this.y+l$z[2*l$b+1],l$B,l$n,l$f),l$x.push(this.x+l$z[2*l$b],this.y+l$z[2*l$b+1]);for(this.earcutTriangles=l$ri.earcut(l$x,null,2),l$L=this.earcutTriangles.length,l$b=0;l$b<l$L;l$b++)l$r.push(this.earcutTriangles[l$b]+l$R);this.mUint16Array=new Uint16Array(l$r),this.mFloat32Array=new Float32Array(l$w)}l$i.append(this.mUint16Array),l$_.append(this.mFloat32Array)},l$L}(),l$oi=function(l$i){function l$z(){this._matrix=new l$q,this._matrix4=l$Mi.defaultMatrix4.concat(),l$z.__super.call(this,1e4),this.shaderValue=new l$Zi(0,0)}l$f(l$z,"laya.webgl.submit.SubmitCanvas",l$zi);var l$_=l$z.prototype;return l$_.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var l$i=l$ti.worldAlpha,l$_=l$ti.worldMatrix4,l$R=l$ti.worldMatrix,l$r=l$ti.worldFilters,l$b=l$ti.worldShaderDefines,l$z=this.shaderValue,l$L=this._matrix,l$w=this._matrix4,l$x=l$q.TEMP;return l$q.mul(l$L,l$R,l$x),l$w[0]=l$x.a,l$w[1]=l$x.b,l$w[4]=l$x.c,l$w[5]=l$x.d,l$w[12]=l$x.tx,l$w[13]=l$x.ty,l$ti.worldMatrix=l$x.clone(),l$ti.worldMatrix4=l$w,l$ti.worldAlpha=l$ti.worldAlpha*l$z.alpha,l$z.filters&&l$z.filters.length&&(l$ti.worldFilters=l$z.filters,l$ti.worldShaderDefines=l$z.defines),this._ctx_src.flush(),l$ti.worldAlpha=l$i,l$ti.worldMatrix4=l$_,l$ti.worldMatrix.destroy(),l$ti.worldMatrix=l$R,l$ti.worldFilters=l$r,l$ti.worldShaderDefines=l$b,1},l$_.releaseRender=function(){var l$i=l$z._cache;this._ctx_src=null,l$i[l$i._length++]=this},l$_.getRenderType=function(){return 10003},l$z.create=function(l$i,l$_,l$R){var l$r=l$z._cache._length?l$z._cache[--l$z._cache._length]:new l$z;l$r._ctx_src=l$i;var l$b=l$r.shaderValue;return l$b.alpha=l$_,l$b.defines.setValue(0),l$R&&l$R.length&&l$b.setFilters(l$R),l$r},l$z._cache=((l$z._cache=[])._length=0,l$z._cache),l$z}(),l$pi=function(l$i){function l$P(l$i){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===l$i&&(l$i=1e4),l$P.__super.call(this,l$i)}l$f(l$P,"laya.webgl.submit.SubmitTexture",l$zi);var l$_=l$P.prototype;return l$_.releaseRender=function(){var l$i=l$P._cache;(l$i[l$i._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},l$_.addTexture=function(l$i,l$_){this._texsID[this._texs.length]=l$i._uvID,this._texs.push(l$i),this._vbPos.push(l$_)},l$_.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var l$i=this.shaderValue.textureHost.bitmap;if(null!==l$i)for(var l$_=this._vb.getFloat32Array(),l$R=0,l$r=this._texs.length;l$R<l$r;l$R++){var l$b=this._texs[l$R];l$b.active();var l$z=l$b.uv;if(this._texsID[l$R]!==l$b._uvID){this._texsID[l$R]=l$b._uvID;var l$L=this._vbPos[l$R];l$_[l$L+2]=l$z[0],l$_[l$L+3]=l$z[1],l$_[l$L+6]=l$z[2],l$_[l$L+7]=l$z[3],l$_[l$L+10]=l$z[4],l$_[l$L+11]=l$z[5],l$_[l$L+14]=l$z[6],l$_[l$L+15]=l$z[7],this._vb.setNeedUpload()}l$b.bitmap!==l$i&&(this._isSameTexture=!1)}}},l$_.renderSubmit=function(){if(0===this._numEle)return l$P._shaderSet=!1,1;var l$i=this.shaderValue.textureHost;if(l$i){var l$_=l$i.source;if(!l$i.bitmap||!l$_)return l$P._shaderSet=!1,1;this.shaderValue.texture=l$_,l$i.alphaTexture&&l$i.alphaTexture.source&&(this.shaderValue.texture1=l$i.alphaTexture.source)}this._vb.bind_upload(this._ib);var l$R=l$ei.mainContext;if(l$D.activeBlendFunction!==this._blendFn&&(l$R.enable(3042),this._blendFn(l$R),l$D.activeBlendFunction=this._blendFn),l$G.drawCall++,l$G.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&l$Ki.activeShader&&l$P._shaderSet?(l$Ki.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&l$Ki.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),l$P._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var l$r=l$i.bitmap,l$b=0,l$z=l$Ki.activeShader,l$L=0,l$w=this._texs.length;l$L<l$w;l$L++){var l$x=this._texs[l$L];l$x.bitmap===l$r&&l$L+1!==l$w||(l$z.uploadTexture2D(l$x.source),l$R.drawElements(4,6*(l$L-l$b+1),5123,this._startIdx+6*l$b*l$Mi.BYTES_PIDX),l$r=l$x.bitmap,l$b=l$L)}else l$R.drawElements(4,this._numEle,5123,this._startIdx);return 1},l$P.create=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$P._cache._length?l$P._cache[--l$P._cache._length]:new l$P;null==l$R&&((l$R=l$z._selfVb||(l$z._selfVb=l$Ti.create(-1))).clear(),l$r=0),l$z._ib=l$_,l$z._vb=l$R,l$z._startIdx=l$r*l$Mi.BYTES_PIDX,l$z._numEle=0;var l$L=l$i._nBlendType;l$z._blendFn=l$i._targets?l$D.targetFns[l$L]:l$D.fns[l$L],l$z.shaderValue=l$b,l$z.shaderValue.setValue(l$i._shader2D);var l$w=l$i._shader2D.filters;return l$w&&l$z.shaderValue.setFilters(l$w),l$z},l$P._cache=((l$P._cache=[])._length=0,l$P._cache),l$P._shaderSet=!0,l$P}(),l$ki=function(l$i){function l$X(){l$X.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}l$f(l$X,"laya.webgl.utils.MeshTexture",l$Xi);var l$_=l$X.prototype;return l$_.addData=function(l$i,l$_,l$R,l$r,l$b,l$z){for(var l$L=l$i.length/2,l$w=this._vb.needSize(l$L*l$X.const_stride)>>2,l$x=this._vb.getFloat32Array(),l$P=0,l$B=0;l$B<l$L;l$B++){var l$n=l$i[l$P],l$f=l$i[l$P+1],l$J=l$n*l$r.a+l$f*l$r.c+l$r.tx,l$h=l$n*l$r.b+l$f*l$r.d+l$r.ty;l$x[l$w++]=l$J,l$x[l$w++]=l$h,l$x[l$w++]=l$_[l$P],l$x[l$w++]=l$_[l$P+1],l$P+=2}this._vb.setNeedUpload();var l$M=this.vertNum;if(0<l$M){(l$L=l$R.length)>l$X.tmpIdx.length&&(l$X.tmpIdx=new Uint16Array(l$L));for(var l$N=0;l$N<l$L;l$N++)l$X.tmpIdx[l$N]=l$R[l$N]+l$M;this._ib.appendU16Array(l$X.tmpIdx,l$R.length)}else this._ib.append(l$R);this._ib.setNeedUpload(),this.vertNum+=l$L,this.indexNum+=l$R.length},l$_.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},l$_.destroy=function(){this._ib.destroy(),this._vb.destroy()},l$X.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new l$X},l$X.const_stride=16,l$X._POOL=[],l$L(l$X,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),l$X}(),l$Ki=function(l$i){function l$_(){l$_.__super.call(this),this.lock=!0}return l$f(l$_,"laya.webgl.shader.BaseShader",l$I),l$_.activeShader=null,l$_.bindShader=null,l$_}(),l$Oi=function(l$_){function l$B(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===l$R&&(l$R=6408),void 0===l$r&&(l$r=5121),void 0===l$b&&(l$b=34041),void 0===l$z&&(l$z=!1),void 0===l$L&&(l$L=!1),void 0===l$w&&(l$w=-1),void 0===l$x&&(l$x=-1),this._type=1,this._w=l$i,this._h=l$_,this._surfaceFormat=l$R,this._surfaceType=l$r,this._depthStencilFormat=l$b,l$X.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=l$z,this._repeat=l$L,this._minFifter=l$w,this._magFifter=l$x,this._createWebGLRenderTarget(),this.bitmap.lock=!0,l$B.__super.call(this,this.bitmap,l$k.INV_UV)}l$f(l$B,"laya.webgl.resource.RenderTarget2D",l$_);var l$i=l$B.prototype;return l$l.imps(l$i,{"laya.resource.IDispose":!0}),l$i.getType=function(){return this._type},l$i.getTexture=function(){return this},l$i.size=function(l$i,l$_){this._w==l$i&&this._h==l$_||(this._w=l$i,this._h=l$_,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},l$i.release=function(){this.destroy()},l$i.recycle=function(){l$B.POOL.push(this)},l$i.start=function(){var l$i=l$ei.mainContext;return this._preRenderTarget=l$ti.curRenderTarget,l$ti.curRenderTarget=this,l$i.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(l$i.viewport(0,0,this._w,this._h),this._svWidth=l$ti.width,this._svHeight=l$ti.height,l$ti.width=this._w,l$ti.height=this._h,l$Ki.activeShader=null),this},l$i.clear=function(l$i,l$_,l$R,l$r){void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=1);var l$b=l$ei.mainContext;l$b.clearColor(l$i,l$_,l$R,l$r);var l$z=16384;switch(this._depthStencilFormat){case 33189:l$z|=256;break;case 36168:l$z|=1024;break;case 34041:l$z|=256,l$z|=1024}l$b.clear(l$z)},l$i.end=function(){var l$i=l$ei.mainContext;l$i.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,l$ti.curRenderTarget=this._preRenderTarget,1==this._type?(l$i.viewport(0,0,this._svWidth,this._svHeight),l$ti.width=this._svWidth,l$ti.height=this._svHeight,l$Ki.activeShader=null):l$i.viewport(0,0,l$l.stage.width,l$l.stage.height)},l$i.getData=function(l$i,l$_,l$R,l$r){var l$b=l$ei.mainContext;if(l$b.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===l$b.checkFramebufferStatus(36160)))return l$b.bindFramebuffer(36160,null),null;var l$z=new Uint8Array(this._w*this._h*4);return l$b.readPixels(l$i,l$_,l$R,l$r,this._surfaceFormat,this._surfaceType,l$z),l$b.bindFramebuffer(36160,null),l$z},l$i.destroy=function(l$i){void 0===l$i&&(l$i=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,l$_.prototype.destroy.call(this))},l$i.dispose=function(){},l$i._createWebGLRenderTarget=function(){this.bitmap=new l$yi(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(l$i){this.event("recovered")})},l$r(0,l$i,"surfaceFormat",function(){return this._surfaceFormat}),l$r(0,l$i,"magFifter",function(){return this._magFifter}),l$r(0,l$i,"surfaceType",function(){return this._surfaceType}),l$r(0,l$i,"mipMap",function(){return this._mipMap}),l$r(0,l$i,"depthStencilFormat",function(){return this._depthStencilFormat}),l$r(0,l$i,"minFifter",function(){return this._minFifter}),l$r(0,l$i,"source",function(){return this._alreadyResolved?l$l.superGet(l$k,this,"source"):null}),l$B.create=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){void 0===l$R&&(l$R=6408),void 0===l$r&&(l$r=5121),void 0===l$b&&(l$b=34041),void 0===l$z&&(l$z=!1),void 0===l$L&&(l$L=!1),void 0===l$w&&(l$w=-1),void 0===l$x&&(l$x=-1);var l$P=l$B.POOL.pop();return l$P||(l$P=new l$B(l$i,l$_)),l$P.bitmap&&l$P._w==l$i&&l$P._h==l$_&&l$P._surfaceFormat==l$R&&l$P._surfaceType==l$r&&l$P._depthStencilFormat==l$b&&l$P._mipMap==l$z&&l$P._repeat==l$L&&l$P._minFifter==l$w&&l$P._magFifter==l$x||(l$P._w=l$i,l$P._h=l$_,l$P._surfaceFormat=l$R,l$P._surfaceType=l$r,l$P._depthStencilFormat=l$b,l$X.isConchWebGL&&34041===l$P._depthStencilFormat&&(l$P._depthStencilFormat=33189),l$P._mipMap=l$z,l$P._repeat=l$L,l$P._minFifter=l$w,l$P._magFifter=l$x,l$P.release(),l$P._createWebGLRenderTarget()),l$P},l$B.TYPE2D=1,l$B.TYPE3D=2,l$B.POOL=[],l$B}(l$k),l$Ei=function(l$i){function l$_(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,l$_.__super.call(this),l$_._gl=l$ei.mainContext}l$f(l$_,"laya.webgl.utils.Buffer",l$I);var l$R=l$_.prototype;return l$R._bind=function(){this.activeResource(),l$_._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(l$_._bindVertexBuffer=this._glBuffer),l$_._gl.bindBuffer(this._bufferType,l$_._bindActive[this._bufferType]=this._glBuffer),l$Ki.activeShader=null)},l$R.recreateResource=function(){this._glBuffer||(this._glBuffer=l$_._gl.createBuffer()),this.completeCreate()},l$R.disposeResource=function(){this._glBuffer&&(l$ei.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},l$r(0,l$R,"bufferUsage",function(){return this._bufferUsage}),l$_._gl=null,l$_._bindActive={},l$_._bindVertexBuffer=null,l$_._enableAtributes=[],l$_}(),l$si=function(l$i){function l$R(l$i){this.texcoord=null,this.offsetX=300,this.offsetY=0,l$R.__super.call(this,512,0);var l$_=8*l$Mi.BYTES_PE;this.position=[2,5126,!1,l$_,0],this.texcoord=[2,5126,!1,l$_,2*l$Mi.BYTES_PE],this.color=[4,5126,!1,l$_,4*l$Mi.BYTES_PE]}return l$f(l$R,"laya.webgl.shader.d2.skinAnishader.SkinSV",l$Zi),l$R}(),l$Yi=function(l$i){function l$_(l$i){l$_.__super.call(this,2,0),this.color=[]}return l$f(l$_,"laya.webgl.shader.d2.value.Color2dSV",l$Zi),l$_.prototype.setValue=function(l$i){l$i.fillStyle&&(this.color=l$i.fillStyle._color._color),l$i.strokeStyle&&(this.color=l$i.strokeStyle._color._color)},l$_}(),l$Ci=function(l$i){function l$_(l$i){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=l$Zi._TEXCOORD,l$_.__super.call(this,256,0)}l$f(l$_,"laya.webgl.shader.d2.value.FillTextureSV",l$Zi);var l$R=l$_.prototype;return l$R.setValue=function(l$i){this.ALPHA=l$i.ALPHA,l$i.filters&&this.setFilters(l$i.filters)},l$R.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},l$_}(),l$mi=function(l$i){function l$_(l$i){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=l$Zi._TEXCOORD,void 0===l$i&&(l$i=0),l$_.__super.call(this,1,l$i)}l$f(l$_,"laya.webgl.shader.d2.value.TextureSV",l$Zi);var l$R=l$_.prototype;return l$R.setValue=function(l$i){this.ALPHA=l$i.ALPHA,l$i.filters&&this.setFilters(l$i.filters)},l$R.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},l$_}(),l$Di=function(l$i){function l$_(l$i){this.a_color=null,this.u_pos=[0,0],l$_.__super.call(this,4,0),this.position=[2,5126,!1,5*l$Mi.BYTES_PE,0],this.a_color=[3,5126,!1,5*l$Mi.BYTES_PE,2*l$Mi.BYTES_PE]}return l$f(l$_,"laya.webgl.shader.d2.value.PrimitiveSV",l$Zi),l$_}(),l$Ui=function(l$i){function l$_(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,l$_.__super.call(this)}l$f(l$_,"laya.webgl.atlas.AtlasWebGLCanvas",l$i);var l$R=l$_.prototype;return l$R.recreateResource=function(){var l$i=l$ei.mainContext,l$_=this._source=l$i.createTexture(),l$R=l$ci.curBindTexTarget,l$r=l$ci.curBindTexValue;l$ci.bindTexture(l$i,3553,l$_),l$i.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),l$i.texParameteri(3553,10241,9729),l$i.texParameteri(3553,10240,9729),l$i.texParameteri(3553,10242,33071),l$i.texParameteri(3553,10243,33071),l$R&&l$r&&l$ci.bindTexture(l$i,l$R,l$r),this.memorySize=this._w*this._h*4,this.completeCreate()},l$R.disposeResource=function(){this._source&&(l$ei.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},l$R.texSubImage2D=function(l$i,l$_,l$R){if(l$X.isFlash){this._flashCacheImage||(this._flashCacheImage=l$M.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var l$r=l$R.bitmapdata;this._flashCacheImage._image.copyPixels(l$r,0,0,l$r.width,l$r.height,l$i,l$_),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var l$b=l$ei.mainContext,l$z=l$ci.curBindTexTarget,l$L=l$ci.curBindTexValue;l$ci.bindTexture(l$b,3553,this._source),l$b.pixelStorei(37441,!0),0<=l$i-1&&l$b.texSubImage2D(3553,0,l$i-1,l$_,6408,5121,l$R),l$i+1<=this._w&&l$b.texSubImage2D(3553,0,l$i+1,l$_,6408,5121,l$R),0<=l$_-1&&l$b.texSubImage2D(3553,0,l$i,l$_-1,6408,5121,l$R),l$_+1<=this._h&&l$b.texSubImage2D(3553,0,l$i,l$_+1,6408,5121,l$R),l$b.texSubImage2D(3553,0,l$i,l$_,6408,5121,l$R),l$b.pixelStorei(37441,!1),l$z&&l$L&&l$ci.bindTexture(l$b,l$z,l$L)}},l$R.texSubImage2DPixel=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$ei.mainContext,l$L=l$ci.curBindTexTarget,l$w=l$ci.curBindTexValue;l$ci.bindTexture(l$z,3553,this._source);var l$x=new Uint8Array(l$b.data);l$z.pixelStorei(37441,!0),l$z.texSubImage2D(3553,0,l$i,l$_,l$R,l$r,6408,5121,l$x),l$z.pixelStorei(37441,!1),l$L&&l$w&&l$ci.bindTexture(l$z,l$L,l$w)},l$r(0,l$R,"width",l$i.prototype._$get_width,function(l$i){this._w=l$i}),l$r(0,l$R,"height",l$i.prototype._$get_height,function(l$i){this._h=l$i}),l$_}(l$R),l$gi=function(l$i){function l$b(){this.flipY=!0,this.alwaysChange=!1,l$b.__super.call(this)}l$f(l$b,"laya.webgl.resource.WebGLCanvas",l$R);var l$_=l$b.prototype;return l$_.getCanvas=function(){return this._canvas},l$_.clear=function(){this._ctx&&this._ctx.clear()},l$_.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},l$_._setContext=function(l$i){this._ctx=l$i},l$_.getContext=function(l$i,l$_){return this._ctx?this._ctx:this._ctx=l$b._createContext(this)},l$_.size=function(l$i,l$_){this._w==l$i&&this._h==l$_||(this._w=l$i,this._h=l$_,this._ctx&&this._ctx.size(l$i,l$_),this._canvas&&(this._canvas.height=l$_,this._canvas.width=l$i))},l$_.activeResource=function(l$i){void 0===l$i&&(l$i=!1),this._source||this.recreateResource()},l$_.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},l$_.disposeResource=function(){this._source&&!this.iscpuSource&&(l$ei.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},l$_.createWebGlTexture=function(){var l$i=l$ei.mainContext;this._canvas;var l$_=this._source=l$i.createTexture();this.iscpuSource=!1;var l$R=l$ci.curBindTexTarget,l$r=l$ci.curBindTexValue;l$ci.bindTexture(l$i,3553,l$_),l$i.pixelStorei(37440,this.flipY?1:0),l$b.premulAlpha&&l$i.pixelStorei(37441,!0),l$i.texImage2D(3553,0,6408,6408,5121,this._imgData),l$b.premulAlpha&&l$i.pixelStorei(37441,!1),l$i.texParameteri(3553,10240,9729),l$i.texParameteri(3553,10241,9729),l$i.texParameteri(3553,10242,33071),l$i.texParameteri(3553,10243,33071),l$i.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,l$R&&l$r&&l$ci.bindTexture(l$i,l$R,l$r)},l$_.reloadCanvasData=function(){var l$i=l$ei.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var l$_=l$ci.curBindTexTarget,l$R=l$ci.curBindTexValue;l$ci.bindTexture(l$i,3553,this._source),l$b.premulAlpha&&l$i.pixelStorei(37441,!0),l$i.texImage2D(3553,0,6408,6408,5121,this._imgData),l$b.premulAlpha&&l$i.pixelStorei(37441,!1),l$i.pixelStorei(37440,0),l$_&&l$R&&l$ci.bindTexture(l$i,l$_,l$R)},l$_.texSubImage2D=function(l$i,l$_,l$R){var l$r=l$ei.mainContext,l$b=l$ci.curBindTexTarget,l$z=l$ci.curBindTexValue;l$ci.bindTexture(l$r,3553,this._source),l$r.pixelStorei(37441,!0),l$r.texSubImage2D(3553,0,l$_,l$R,6408,5121,l$i._source),l$r.pixelStorei(37441,!1),l$b&&l$z&&l$ci.bindTexture(l$r,l$b,l$z)},l$_.toBase64=function(l$i,l$_,l$R){var l$r=null;this._canvas&&(l$r=this._canvas.toDataURL(l$i,l$_)),l$R.call(this,l$r)},l$r(0,l$_,"context",function(){return this._ctx}),l$r(0,l$_,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),l$r(0,l$_,"asBitmap",null,function(l$i){this._ctx&&(this._ctx.asBitmap=l$i)}),l$b._createContext=null,l$b.premulAlpha=!1,l$b}(),l$Vi=function(l$i){function l$z(l$i,l$_){this.CborderSize=12,l$z.__super.call(this),this.char=l$i,this.isSpace=" "===l$i,this.xs=l$_.scaleX,this.ys=l$_.scaleY,this.font=l$_.font.toString(),this.fontSize=l$_.font.size,this.fillColor=l$_.fillColor,this.borderColor=l$_.borderColor,this.lineWidth=l$_.lineWidth,this.underLine=l$_.underLine;var l$R,l$r=l$X.isConchApp;l$r?((l$R=ConchTextCanvas)._source=ConchTextCanvas,l$R._source.canvas=ConchTextCanvas):l$R=l$J.canvas.source,this.canvas=l$R,this._enableMerageInAtlas=!0,this._ctx=l$r?l$R:this.canvas.getContext("2d",void 0);var l$b=l$K.measureText(this.char,this.font);this.cw=l$b.width*this.xs,this.ch=(l$b.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new l$k(this)}l$f(l$z,"laya.webgl.resource.WebGLCharImage",l$R);var l$_=l$z.prototype;return l$l.imps(l$_,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),l$_.active=function(){this.texture.active()},l$_.recreateResource=function(){var l$i=l$X.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),l$i){var l$_=this.fontSize;1==this.xs&&1==this.ys||(l$_=parseInt(l$_*(this.xs>this.ys?this.xs:this.ys)+""));var l$R="normal 100 "+this.font;l$R=l$R.replace(l$z._fontSizeReg,l$_),this.borderColor&&(l$R+=" 1 "+this.borderColor),this._ctx.font=l$R,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,l$p.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var l$r=this._ctx.measureText(this.char);l$r||(l$r={width:16});var l$b=l$r.width+1;this._ctx.lineTo(l$b,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},l$_.onresize=function(l$i,l$_){this._w=l$i,this._h=l$_,this._allowMerageInAtlas=!0},l$_.clearAtlasSource=function(){},l$r(0,l$_,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),l$r(0,l$_,"atlasSource",function(){return this.canvas}),l$r(0,l$_,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(l$i){this._enableMerageInAtlas=l$i}),l$z.createOneChar=function(l$i,l$_){return new l$z(l$i,l$_)},l$z._fontSizeReg=new RegExp("\\d+(?=px)","g"),l$z}(),l$yi=function(l$i){function l$P(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){void 0===l$R&&(l$R=6408),void 0===l$r&&(l$r=5121),void 0===l$b&&(l$b=34041),void 0===l$z&&(l$z=!1),void 0===l$L&&(l$L=!1),void 0===l$w&&(l$w=-1),void 0===l$x&&(l$x=1),l$P.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=l$i,this._h=l$_,this._surfaceFormat=l$R,this._surfaceType=l$r,this._depthStencilFormat=l$b,this._mipMap=l$z,this._repeat=l$L,this._minFifter=l$w,this._magFifter=l$x}l$f(l$P,"laya.webgl.resource.WebGLRenderTarget",l$R);var l$_=l$P.prototype;return l$_.recreateResource=function(){var l$i=l$ei.mainContext;this._frameBuffer||(this._frameBuffer=l$i.createFramebuffer()),this._source||(this._source=l$i.createTexture());var l$_=l$ci.curBindTexTarget,l$R=l$ci.curBindTexValue;l$ci.bindTexture(l$i,3553,this._source),l$i.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var l$r=this._minFifter,l$b=this._magFifter,l$z=this._repeat?10497:33071,l$L=l$B.isPOT(this._w,this._h);if(l$L?(this._mipMap?-1!==l$r||(l$r=9987):-1!==l$r||(l$r=9729),-1!==l$b||(l$b=9729),l$i.texParameteri(3553,10241,l$r),l$i.texParameteri(3553,10240,l$b),l$i.texParameteri(3553,10242,l$z),l$i.texParameteri(3553,10243,l$z),this._mipMap&&l$i.generateMipmap(3553)):(-1!==l$r||(l$r=9729),-1!==l$b||(l$b=9729),l$i.texParameteri(3553,10241,l$r),l$i.texParameteri(3553,10240,l$b),l$i.texParameteri(3553,10242,33071),l$i.texParameteri(3553,10243,33071)),l$i.bindFramebuffer(36160,this._frameBuffer),l$i.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=l$i.createRenderbuffer()),l$i.bindRenderbuffer(36161,this._depthStencilBuffer),l$i.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:l$i.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:l$i.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:l$i.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}l$i.bindFramebuffer(36160,null),l$_&&l$R&&l$ci.bindTexture(l$i,l$_,l$R),l$i.bindRenderbuffer(36161,null),l$L&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},l$_.disposeResource=function(){this._frameBuffer&&(l$ei.mainContext.deleteTexture(this._source),l$ei.mainContext.deleteFramebuffer(this._frameBuffer),l$ei.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null)},l$r(0,l$_,"depthStencilBuffer",function(){return this._depthStencilBuffer}),l$r(0,l$_,"frameBuffer",function(){return this._frameBuffer}),l$P}(),l$ai=function(l$i){function l$w(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this.offsetX=0,this.offsetY=0,l$w.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=l$z,this.canvas=l$i,this._ctx=l$i.getContext("2d",void 0),this._w=l$r,this._h=l$b,this.offsetX=l$_,this.offsetY=l$R,this.src=l$L,this._enableMerageInAtlas=!0,l$C.enabled&&this._w<l$C.atlasLimitWidth&&this._h<l$C.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}l$f(l$w,"laya.webgl.resource.WebGLSubImage",l$R);var l$_=l$w.prototype;return l$l.imps(l$_,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),l$_.size=function(l$i,l$_){this._w=l$i,this._h=l$_,this._ctx&&this._ctx.size(l$i,l$_),this.canvas&&(this.canvas.height=l$_,this.canvas.width=l$i)},l$_.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},l$_.createWebGlTexture=function(){var l$i=l$ei.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var l$_=this._source=l$i.createTexture(),l$R=l$ci.curBindTexTarget,l$r=l$ci.curBindTexValue;l$ci.bindTexture(l$i,3553,l$_),l$i.pixelStorei(37441,!0),l$i.texImage2D(3553,0,6408,6408,5121,this.canvas),l$i.pixelStorei(37441,!1);var l$b=this.minFifter,l$z=this.magFifter,l$L=this.repeat?10497:33071,l$w=l$B.isPOT(this.width,this.height);l$w?(this.mipmap?-1!==l$b||(l$b=9987):-1!==l$b||(l$b=9729),-1!==l$z||(l$z=9729),l$i.texParameteri(3553,10240,l$z),l$i.texParameteri(3553,10241,l$b),l$i.texParameteri(3553,10242,l$L),l$i.texParameteri(3553,10243,l$L),this.mipmap&&l$i.generateMipmap(3553)):(-1!==l$b||(l$b=9729),-1!==l$z||(l$z=9729),l$i.texParameteri(3553,10241,l$b),l$i.texParameteri(3553,10240,l$z),l$i.texParameteri(3553,10242,33071),l$i.texParameteri(3553,10243,33071)),l$R&&l$r&&l$ci.bindTexture(l$i,l$R,l$r),this.canvas=null,l$w&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},l$_.disposeResource=function(){l$C.enabled&&this._allowMerageInAtlas||!this._source||(l$ei.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},l$_.clearAtlasSource=function(){},l$r(0,l$_,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),l$r(0,l$_,"atlasSource",function(){return this.canvas}),l$r(0,l$_,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(l$i){this._allowMerageInAtlas=l$i}),l$w}(),l$Fi=function(l$i){function l$P(l$i,l$_,l$R,l$r){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,l$P.__super.call(this),!l$i||!l$_)throw"Shader Error";this._id=++l$P._count,this._vs=l$i,this._ps=l$_,this._nameMap=l$r||{},null!=l$R&&(l$P.sharders[l$R]=this)}l$f(l$P,"laya.webgl.shader.Shader",l$Ki);var l$_=l$P.prototype;return l$_.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},l$_.disposeResource=function(){l$ei.mainContext.deleteShader(this._vshader),l$ei.mainContext.deleteShader(this._pshader),l$ei.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},l$_._compile=function(){if(!l$ei.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var l$i=[this._vs,this._ps],l$_=l$ei.mainContext;if(this._program=l$_.createProgram(),this._vshader=l$P._createShader(l$_,l$i[0],35633),this._pshader=l$P._createShader(l$_,l$i[1],35632),l$_.attachShader(this._program,this._vshader),l$_.attachShader(this._program,this._pshader),l$_.linkProgram(this._program),!l$X.isConchApp&&!l$_.getProgramParameter(this._program,35714))throw l$_.getProgramInfoLog(this._program);var l$R,l$r,l$b=0,l$z=0;for(l$z=l$X.isConchApp?l$_.getProgramParameterEx(this._vs,this._ps,"",35721):l$_.getProgramParameter(this._program,35721),l$b=0;l$b<l$z;l$b++){var l$L=null;l$R={vartype:"attribute",glfun:null,ivartype:0,attrib:l$L=l$X.isConchApp?l$_.getActiveAttribEx(this._vs,this._ps,"",l$b):l$_.getActiveAttrib(this._program,l$b),location:l$_.getAttribLocation(this._program,l$L.name),name:l$L.name,type:l$L.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(l$R)}var l$w=0;for(l$w=l$X.isConchApp?l$_.getProgramParameterEx(this._vs,this._ps,"",35718):l$_.getProgramParameter(this._program,35718),l$b=0;l$b<l$w;l$b++){var l$x=null;l$x=l$X.isConchApp?l$_.getActiveUniformEx(this._vs,this._ps,"",l$b):l$_.getActiveUniform(this._program,l$b),0<(l$R={vartype:"uniform",glfun:null,ivartype:1,attrib:l$L,location:l$_.getUniformLocation(this._program,l$x.name),name:l$x.name,type:l$x.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(l$R.name=l$R.name.substr(0,l$R.name.length-3),l$R.isArray=!0,l$R.location=l$_.getUniformLocation(this._program,l$R.name)),this._params.push(l$R)}for(l$b=0,l$r=this._params.length;l$b<l$r;l$b++)if((l$R=this._params[l$b]).indexOfParams=l$b,l$R.index=1,l$R.value=[l$R.location,null],l$R.codename=l$R.name,l$R.name=this._nameMap[l$R.codename]?this._nameMap[l$R.codename]:l$R.codename,(this._paramsMap[l$R.name]=l$R)._this=this,l$R.uploadedValue=[],"attribute"!==l$R.vartype)switch(l$R.type){case 5124:l$R.fun=l$R.isArray?this._uniform1iv:this._uniform1i;break;case 5126:l$R.fun=l$R.isArray?this._uniform1fv:this._uniform1f;break;case 35664:l$R.fun=l$R.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:l$R.fun=l$R.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:l$R.fun=l$R.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:l$R.fun=this._uniform_sampler2D;break;case 35680:l$R.fun=this._uniform_samplerCube;break;case 35676:l$R.glfun=l$_.uniformMatrix4fv,l$R.fun=this._uniformMatrix4fv;break;case 35670:l$R.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else l$R.fun=this._attribute}},l$_.getUniform=function(l$i){return this._paramsMap[l$i]},l$_._attribute=function(l$i,l$_){var l$R=l$ei.mainContext,l$r=l$Ei._enableAtributes,l$b=l$i.location;return l$r[l$b]||l$R.enableVertexAttribArray(l$b),l$R.vertexAttribPointer(l$b,l$_[0],l$_[1],l$_[2],l$_[3],l$_[4]+this._offset),l$r[l$b]=l$Ei._bindVertexBuffer,1},l$_._uniform1f=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_?(l$ei.mainContext.uniform1f(l$i.location,l$R[0]=l$_),1):0},l$_._uniform1fv=function(l$i,l$_){if(l$_.length<4){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]||l$R[2]!==l$_[2]||l$R[3]!==l$_[3]?(l$ei.mainContext.uniform1fv(l$i.location,l$_),l$R[0]=l$_[0],l$R[1]=l$_[1],l$R[2]=l$_[2],l$R[3]=l$_[3],1):0}return l$ei.mainContext.uniform1fv(l$i.location,l$_),1},l$_._uniform_vec2=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]?(l$ei.mainContext.uniform2f(l$i.location,l$R[0]=l$_[0],l$R[1]=l$_[1]),1):0},l$_._uniform_vec2v=function(l$i,l$_){if(l$_.length<2){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]||l$R[2]!==l$_[2]||l$R[3]!==l$_[3]?(l$ei.mainContext.uniform2fv(l$i.location,l$_),l$R[0]=l$_[0],l$R[1]=l$_[1],l$R[2]=l$_[2],l$R[3]=l$_[3],1):0}return l$ei.mainContext.uniform2fv(l$i.location,l$_),1},l$_._uniform_vec3=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]||l$R[2]!==l$_[2]?(l$ei.mainContext.uniform3f(l$i.location,l$R[0]=l$_[0],l$R[1]=l$_[1],l$R[2]=l$_[2]),1):0},l$_._uniform_vec3v=function(l$i,l$_){return l$ei.mainContext.uniform3fv(l$i.location,l$_),1},l$_._uniform_vec4=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]||l$R[2]!==l$_[2]||l$R[3]!==l$_[3]?(l$ei.mainContext.uniform4f(l$i.location,l$R[0]=l$_[0],l$R[1]=l$_[1],l$R[2]=l$_[2],l$R[3]=l$_[3]),1):0},l$_._uniform_vec4v=function(l$i,l$_){return l$ei.mainContext.uniform4fv(l$i.location,l$_),1},l$_._uniformMatrix2fv=function(l$i,l$_){return l$ei.mainContext.uniformMatrix2fv(l$i.location,!1,l$_),1},l$_._uniformMatrix3fv=function(l$i,l$_){return l$ei.mainContext.uniformMatrix3fv(l$i.location,!1,l$_),1},l$_._uniformMatrix4fv=function(l$i,l$_){return l$ei.mainContext.uniformMatrix4fv(l$i.location,!1,l$_),1},l$_._uniform1i=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_?(l$ei.mainContext.uniform1i(l$i.location,l$R[0]=l$_),1):0},l$_._uniform1iv=function(l$i,l$_){return l$ei.mainContext.uniform1iv(l$i.location,l$_),1},l$_._uniform_ivec2=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]?(l$ei.mainContext.uniform2i(l$i.location,l$R[0]=l$_[0],l$R[1]=l$_[1]),1):0},l$_._uniform_ivec2v=function(l$i,l$_){return l$ei.mainContext.uniform2iv(l$i.location,l$_),1},l$_._uniform_vec3i=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]||l$R[2]!==l$_[2]?(l$ei.mainContext.uniform3i(l$i.location,l$R[0]=l$_[0],l$R[1]=l$_[1],l$R[2]=l$_[2]),1):0},l$_._uniform_vec3vi=function(l$i,l$_){return l$ei.mainContext.uniform3iv(l$i.location,l$_),1},l$_._uniform_vec4i=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]||l$R[2]!==l$_[2]||l$R[3]!==l$_[3]?(l$ei.mainContext.uniform4i(l$i.location,l$R[0]=l$_[0],l$R[1]=l$_[1],l$R[2]=l$_[2],l$R[3]=l$_[3]),1):0},l$_._uniform_vec4vi=function(l$i,l$_){return l$ei.mainContext.uniform4iv(l$i.location,l$_),1},l$_._uniform_sampler2D=function(l$i,l$_){var l$R=l$ei.mainContext,l$r=l$i.uploadedValue;return null==l$r[0]?(l$r[0]=this._curActTexIndex,l$R.uniform1i(l$i.location,this._curActTexIndex),l$R.activeTexture(l$P._TEXTURES[this._curActTexIndex]),l$ci.bindTexture(l$R,3553,l$_),this._curActTexIndex++,1):(l$R.activeTexture(l$P._TEXTURES[l$r[0]]),l$ci.bindTexture(l$R,3553,l$_),0)},l$_._uniform_samplerCube=function(l$i,l$_){var l$R=l$ei.mainContext,l$r=l$i.uploadedValue;return null==l$r[0]?(l$r[0]=this._curActTexIndex,l$R.uniform1i(l$i.location,this._curActTexIndex),l$R.activeTexture(l$P._TEXTURES[this._curActTexIndex]),l$ci.bindTexture(l$R,34067,l$_),this._curActTexIndex++,1):(l$R.activeTexture(l$P._TEXTURES[l$r[0]]),l$ci.bindTexture(l$R,34067,l$_),0)},l$_._noSetValue=function(l$i){console.log("no....:"+l$i.name)},l$_.uploadOne=function(l$i,l$_){this.activeResource(),l$ci.UseProgram(this._program);var l$R=this._paramsMap[l$i];l$R.fun.call(this,l$R,l$_)},l$_.uploadTexture2D=function(l$i){l$G.shaderCall++;var l$_=l$ei.mainContext;l$_.activeTexture(33984),l$ci.bindTexture(l$_,3553,l$i)},l$_.uploadTexture2D1=function(l$i){l$G.shaderCall++;var l$_=l$ei.mainContext;l$_.activeTexture(33985),l$ci.bindTexture(l$_,3553,l$i)},l$_.upload=function(l$i,l$_){l$Ki.activeShader=l$Ki.bindShader=this,this._lastUseFrameCount===l$G.loopCount||this.activeResource(),l$ci.UseProgram(this._program),this._reCompile?(l$_=this._params,this._reCompile=!1):l$_=l$_||this._params;l$ei.mainContext;for(var l$R,l$r,l$b=l$_.length,l$z=0,l$L=0;l$L<l$b;l$L++)null!==(l$r=l$i[(l$R=l$_[l$L]).name])&&(l$z+=l$R.fun.call(this,l$R,l$r));l$G.shaderCall+=l$z},l$_.uploadArray=function(l$i,l$_,l$R){l$Ki.activeShader=this,(l$Ki.bindShader=this).activeResource(),l$ci.UseProgram(this._program);this._params;for(var l$r,l$b,l$z=0,l$L=l$_-2;0<=l$L;l$L-=2)(l$b=this._paramsMap[l$i[l$L]])&&null!=(l$r=l$i[l$L+1])&&(l$R&&l$R[l$b.name]&&l$R[l$b.name].bind(),l$z+=l$b.fun.call(this,l$b,l$r));l$G.shaderCall+=l$z},l$_.getParams=function(){return this._params},l$P.getShader=function(l$i){return l$P.sharders[l$i]},l$P.create=function(l$i,l$_,l$R,l$r){return new l$P(l$i,l$_,l$R,l$r)},l$P.withCompile=function(l$i,l$_,l$R,l$r){if(l$R&&l$P.sharders[l$R])return l$P.sharders[l$R];var l$b=l$P._preCompileShader[2e-4*l$i];if(!l$b)throw new Error("withCompile shader err!"+l$i);return l$b.createShader(l$_,l$R,l$r)},l$P.withCompile2D=function(l$i,l$_,l$R,l$r,l$b){if(l$r&&l$P.sharders[l$r])return l$P.sharders[l$r];var l$z=l$P._preCompileShader[2e-4*l$i+l$_];if(!l$z)throw new Error("withCompile shader err!"+l$i+" "+l$_);return l$z.createShader(l$R,l$r,l$b)},l$P.addInclude=function(l$i,l$_){l$Ii.addInclude(l$i,l$_)},l$P.preCompile=function(l$i,l$_,l$R,l$r){var l$b=2e-4*l$i;l$P._preCompileShader[l$b]=new l$Ii(l$b,l$_,l$R,l$r)},l$P.preCompile2D=function(l$i,l$_,l$R,l$r,l$b){var l$z=2e-4*l$i+l$_;l$P._preCompileShader[l$z]=new l$Ii(l$z,l$R,l$r,l$b)},l$P._createShader=function(l$i,l$_,l$R){var l$r=l$i.createShader(l$R);return l$i.shaderSource(l$r,l$_),l$i.compileShader(l$r),l$r},l$P._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],l$P._count=0,l$P._preCompileShader={},l$P.SHADERNAME2ID=2e-4,l$P.sharders=((l$P.sharders=[]).length=32,l$P.sharders),l$L(l$P,["nameKey",function(){return this.nameKey=new l$u}]),l$P}(),l$di=function(l$i){function l$_(){this._maxsize=0,this._upload=!0,this._uploadSize=0,l$_.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}l$f(l$_,"laya.webgl.utils.Buffer2D",l$i);var l$R=l$_.prototype;return l$R.needSize=function(l$i){var l$_=this._byteLength;if(l$i){var l$R=this._byteLength+l$i;l$R<=this._buffer.byteLength||this._resizeBuffer(l$R<<1,!0),this._byteLength=l$R}return l$_},l$R._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),l$G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,l$Ei._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),l$Ei._gl.bufferSubData(this._bufferType,0,this._buffer)},l$R._bufferSubData=function(l$i,l$_,l$R){if(void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),this._maxsize=Math.max(this._maxsize,this._byteLength),l$G.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,l$Ei._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),l$_||l$R){var l$r=this._buffer.slice(l$_,l$R);l$Ei._gl.bufferSubData(this._bufferType,l$i,l$r)}else l$Ei._gl.bufferSubData(this._bufferType,l$i,this._buffer)},l$R._checkArrayUse=function(){},l$R._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},l$R._bind_subUpload=function(l$i,l$_,l$R){return void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(l$i,l$_,l$R),!0)},l$R._resizeBuffer=function(l$i,l$_){if(l$i<this._buffer.byteLength)return this;if(this.memorySize=l$i,l$_&&this._buffer&&0<this._buffer.byteLength){var l$R=new ArrayBuffer(l$i);new Uint8Array(l$R).set(new Uint8Array(this._buffer),0),this._buffer=l$R}else this._buffer=new ArrayBuffer(l$i);return this._checkArrayUse(),this._upload=!0,this},l$R.append=function(l$i){this._upload=!0;var l$_,l$R;l$_=l$i.byteLength,l$i instanceof Uint8Array?(this._resizeBuffer(this._byteLength+l$_,!0),l$R=new Uint8Array(this._buffer,this._byteLength)):l$i instanceof Uint16Array?(this._resizeBuffer(this._byteLength+l$_,!0),l$R=new Uint16Array(this._buffer,this._byteLength)):l$i instanceof Float32Array&&(this._resizeBuffer(this._byteLength+l$_,!0),l$R=new Float32Array(this._buffer,this._byteLength)),l$R.set(l$i,0),this._byteLength+=l$_,this._checkArrayUse()},l$R.appendU16Array=function(l$i,l$_){this._resizeBuffer(this._byteLength+2*l$_,!0);for(var l$R=new Uint16Array(this._buffer,this._byteLength,l$_),l$r=0;l$r<l$_;l$r++)l$R[l$r]=l$i[l$r];this._byteLength+=2*l$_,this._checkArrayUse()},l$R.appendEx=function(l$i,l$_){this._upload=!0;var l$R;l$R=l$i.byteLength,this._resizeBuffer(this._byteLength+l$R,!0),new l$_(this._buffer,this._byteLength).set(l$i,0),this._byteLength+=l$R,this._checkArrayUse()},l$R.appendEx2=function(l$i,l$_,l$R,l$r){void 0===l$r&&(l$r=1),this._upload=!0;var l$b,l$z;l$b=l$R*l$r,this._resizeBuffer(this._byteLength+l$b,!0),l$z=new l$_(this._buffer,this._byteLength);var l$L=0;for(l$L=0;l$L<l$R;l$L++)l$z[l$L]=l$i[l$L];this._byteLength+=l$b,this._checkArrayUse()},l$R.getBuffer=function(){return this._buffer},l$R.setNeedUpload=function(){this._upload=!0},l$R.getNeedUpload=function(){return this._upload},l$R.upload=function(){var l$i=this._bind_upload();return l$Ei._gl.bindBuffer(this._bufferType,null),l$Ei._bindActive[this._bufferType]=null,l$Ki.activeShader=null,l$i},l$R.subUpload=function(l$i,l$_,l$R){void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0);var l$r=this._bind_subUpload();return l$Ei._gl.bindBuffer(this._bufferType,null),l$Ei._bindActive[this._bufferType]=null,l$Ki.activeShader=null,l$r},l$R.disposeResource=function(){l$i.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},l$R.clear=function(){this._byteLength=0,this._upload=!0},l$r(0,l$R,"bufferLength",function(){return this._buffer.byteLength}),l$r(0,l$R,"byteLength",null,function(l$i){this._byteLength!==l$i&&(l$i<=this._buffer.byteLength||this._resizeBuffer(2*l$i+256,!0),this._byteLength=l$i)}),l$_.__int__=function(l$i){l$Wi.QuadrangleIB=l$Wi.create(35044),l$Ni.fillIBQuadrangle(l$Wi.QuadrangleIB,16)},l$_.FLOAT32=4,l$_.SHORT=2,l$_}(l$Ei),l$Qi=(function(l$_){function l$R(l$i){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,l$R.__super.call(this,9)}l$f(l$R,"laya.webgl.shader.d2.value.GlowSV",l$_);var l$i=l$R.prototype;l$i.setValue=function(l$i){l$_.prototype.setValue.call(this,l$i)},l$i.clear=function(){l$_.prototype.clear.call(this)}}(l$mi),function(l$i){function l$_(l$i){l$_.__super.call(this,64),this.defines.add(64)}l$f(l$_,"laya.webgl.shader.d2.value.TextSV",l$i);var l$R=l$_.prototype;return l$R.release=function(){(l$_.pool[l$_._length++]=this).clear()},l$R.clear=function(){l$i.prototype.clear.call(this)},l$_.create=function(){return l$_._length?l$_.pool[--l$_._length]:new l$_(null)},l$_.pool=[],l$_._length=0,l$_}(l$mi)),l$Hi=function(l$i){function l$b(l$i,l$_,l$R,l$r){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,l$b.__super.call(this,l$i,l$_,l$R,l$r)}l$f(l$b,"laya.webgl.shader.d2.Shader2X",l$i);var l$_=l$b.prototype;return l$_.upload2dQuick1=function(l$i){this.upload(l$i,this._params2dQuick1||this._make2dQuick1())},l$_._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var l$i,l$_=this._params,l$R=0,l$r=l$_.length;l$R<l$r;l$R++)l$i=l$_[l$R],(l$X.isFlash||"size"!==l$i.name&&"position"!==l$i.name&&"texcoord"!==l$i.name)&&this._params2dQuick1.push(l$i)}return this._params2dQuick1},l$_.disposeResource=function(){l$i.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},l$_.upload2dQuick2=function(l$i){this.upload(l$i,this._params2dQuick2||this._make2dQuick2())},l$_._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var l$i,l$_=this._params,l$R=0,l$r=l$_.length;l$R<l$r;l$R++)l$i=l$_[l$R],(l$X.isFlash||"size"!==l$i.name)&&this._params2dQuick2.push(l$i)}return this._params2dQuick2},l$b.create=function(l$i,l$_,l$R,l$r){return new l$b(l$i,l$_,l$R,l$r)},l$b}(l$Fi),l$Wi=function(l$i){function l$_(l$i){this._uint8Array=null,this._uint16Array=null,void 0===l$i&&(l$i=35044),l$_.__super.call(this),this._bufferUsage=l$i,this._bufferType=34963,l$X.isFlash||(this._buffer=new ArrayBuffer(8))}l$f(l$_,"laya.webgl.utils.IndexBuffer2D",l$di);var l$R=l$_.prototype;return l$R._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},l$R.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},l$R.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},l$R.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},l$_.QuadrangleIB=null,l$_.create=function(l$i){return void 0===l$i&&(l$i=35044),new l$_(l$i)},l$_}(),l$Ti=function(l$i){function l$R(l$i,l$_){this._floatArray32=null,this._vertexStride=0,l$R.__super.call(this),this._vertexStride=l$i,this._bufferUsage=l$_,this._bufferType=34962,l$X.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}l$f(l$R,"laya.webgl.utils.VertexBuffer2D",l$i);var l$_=l$R.prototype;return l$_.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},l$_.bind=function(l$i){l$i&&l$i._bind(),this._bind()},l$_.insertData=function(l$i,l$_){this.getFloat32Array().set(l$i,l$_),this._upload=!0},l$_.bind_upload=function(l$i){l$i._bind_upload()||l$i._bind(),this._bind_upload()||this._bind()},l$_._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},l$_.disposeResource=function(){l$i.prototype.disposeResource.call(this)},l$_.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},l$r(0,l$_,"vertexStride",function(){return this._vertexStride}),l$R.create=function(l$i,l$_){return void 0===l$_&&(l$_=35048),new l$R(l$i,l$_)},l$R}(l$di),l$i_=function(l$i){function l$w(l$i,l$_,l$R,l$r,l$b,l$z){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===l$R&&(l$R=6408),void 0===l$r&&(l$r=!0),l$w.__super.call(this,l$i,l$_),l$i){if(this._format=l$R,this._mipmap=l$r,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof l$i)this._url=l$i,this._src=l$i,this._image=new l$J.window.Image,l$_&&(l$_.onload&&(this.onload=l$_.onload),l$_.onerror&&(this.onerror=l$_.onerror),l$_.onCreate&&l$_.onCreate(this)),this._image.crossOrigin=l$i&&0==l$i.indexOf("data:")?null:"",l$i&&(this._image.src=l$i);else if(l$i instanceof ArrayBuffer){this._src=l$_,this._url=this._src;var l$L=new l$x(l$i);l$L.readUTFBytes(4),l$L.readUTFBytes(2),l$L.getInt16();l$L.endian="bigEndian",this._w=l$L.getInt16(),this._h=l$L.getInt16();l$L.getInt16(),l$L.getInt16();this._image=new Uint8Array(l$i,l$L.pos),this._format=l$ei.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,l$C.enabled&&this._w<l$C.atlasLimitWidth&&this._h<l$C.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(l$i instanceof Uint8Array))return this._src=l$_,this._url=this._src,this._image=l$i.source||l$i,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=l$_,this._url=this._src,this._w=l$b,this._h=l$z,this._image=l$i,this._format=0===l$R?l$i.byteLength/(l$b*l$z)==4?6408:6407:l$R}this._$5__enableMerageInAtlas=!0}}l$f(l$w,"laya.webgl.resource.WebGLImage",l$M);var l$_=l$w.prototype;return l$l.imps(l$_,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),l$_._init_=function(l$i,l$_){},l$_._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var l$i=l$ei.mainContext,l$_=this._source=l$i.createTexture(),l$R=l$ci.curBindTexTarget,l$r=l$ci.curBindTexValue;l$ci.bindTexture(l$i,3553,l$_);var l$b=this.minFifter,l$z=this.magFifter,l$L=this.repeat?10497:33071,l$w=l$B.isPOT(this._w,this._h),l$x=!1;switch(l$w?(this.mipmap?-1!==l$b||(l$b=9987):-1!==l$b||(l$b=9729),-1!==l$z||(l$z=9729),l$i.texParameteri(3553,10241,l$b),l$i.texParameteri(3553,10240,l$z),l$i.texParameteri(3553,10242,l$L),l$i.texParameteri(3553,10243,l$L),this.mipmap&&l$i.generateMipmap(3553)):(-1!==l$b||(l$b=9729),-1!==l$z||(l$z=9729),l$i.texParameteri(3553,10241,l$b),l$i.texParameteri(3553,10240,l$z),l$i.texParameteri(3553,10242,33071),l$i.texParameteri(3553,10243,33071)),l$i.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&l$i.pixelStorei(l$i.UNPACK_ALIGNMENT,1),l$i.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&l$i.pixelStorei(l$i.UNPACK_ALIGNMENT,1),l$i.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:l$x=!0,l$i.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case l$ei.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:l$x=!0,l$i.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}l$i.pixelStorei(37441,!1),l$R&&l$r&&l$ci.bindTexture(l$i,l$R,l$r),this.uri||(this.uri=this._url),l$x?this.memorySize=this._image.length:l$w&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},l$_.recreateResource=function(){var l$i=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var l$_=this;this._image=new l$J.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(l$_._needReleaseAgain)return l$_._needReleaseAgain=!1,l$_._image.onload=null,void(l$_._image=null);l$_._allowMerageInAtlas&&l$_._enableMerageInAtlas?(l$i.memorySize=0,l$i._recreateLock=!1):l$_._createWebGlTexture(),l$_.completeCreate()},this._image.src=this._src}},l$_.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&l$ei.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},l$_.onresize=function(){this._w=this._image.width,this._h=this._image.height,l$C.enabled&&this._w<l$C.atlasLimitWidth&&this._h<l$C.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},l$_.clearAtlasSource=function(){this._image=null},l$r(0,l$_,"format",function(){return this._format}),l$r(0,l$_,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(l$i){this._$5__enableMerageInAtlas=l$i}),l$r(0,l$_,"mipmap",function(){return this._mipmap}),l$r(0,l$_,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),l$r(0,l$_,"atlasSource",function(){return this._image}),l$r(0,l$_,"onload",null,function(l$i){var l$_=this;this._onload=l$i,this._image&&(this._image.onload=null!=this._onload?function(){l$_.onresize(),l$_._onload()}:null)}),l$r(0,l$_,"onerror",null,function(l$i){var l$_=this;this._onerror=l$i,this._image&&(this._image.onerror=null!=this._onerror?function(){l$_._onerror()}:null)}),l$w}();l$l.__init([l$Ji,l$Y,l$Ai,l$Ii])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(l$i,l$_){"use strict";for(var l$R in Object.defineProperty(l$_,"__esModule",{value:!0}),Laya){var l$r=Laya[l$R];l$r&&l$r.__isclass&&(l$_[l$R]=l$r)}}),function(l$z,l$i,l$r){l$r.un,l$r.uns;var l$b=l$r.static,l$L=l$r.class,l$w=l$r.getset,l$x=(l$r.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),l$h=laya.utils.ClassUtils,l$n=(laya.events.Event,laya.utils.HTMLChar),l$P=laya.net.Loader,l$B=(laya.display.Node,laya.maths.Rectangle),l$f=laya.renders.Render,l$J=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),l$M=laya.utils.Stat,l$K=laya.display.Text,l$N=laya.resource.Texture,l$X=laya.net.URL,l$t=laya.utils.Utils,l$I=function(){function l$J(){}return l$L(l$J,"laya.html.utils.HTMLParse"),l$J.parse=function(l$i,l$_,l$R){l$_=(l$_="<root>"+(l$_=l$_.replace(/<br>/g,"<br/>"))+"</root>").replace(l$J.spacePattern,l$J.char255);var l$r=l$t.parseXMLFromString(l$_);l$J._parseXML(l$i,l$r.childNodes[0].childNodes,l$R)},l$J._parseXML=function(l$i,l$_,l$R,l$r){var l$b=0,l$z=0;if(l$_.join||l$_.item)for(l$b=0,l$z=l$_.length;l$b<l$z;++l$b)l$J._parseXML(l$i,l$_[l$b],l$R,l$r);else{var l$L,l$w,l$x;if(3==l$_.nodeType)return void(l$i instanceof laya.html.dom.HTMLDivElement?(null==l$_.nodeName&&(l$_.nodeName="#text"),l$w=l$_.nodeName.toLowerCase(),0<(l$x=l$_.textContent.replace(/^\s+|\s+$/g,"")).length&&(l$L=l$h.getInstance(l$w))&&(l$i.addChild(l$L),l$L.innerTEXT=l$x.replace(l$J.char255AndOneSpacePattern," "))):0<(l$x=l$_.textContent.replace(/^\s+|\s+$/g,"")).length&&(l$i.innerTEXT=l$x.replace(l$J.char255AndOneSpacePattern," ")));if("#comment"==(l$w=l$_.nodeName.toLowerCase()))return;if(l$L=l$h.getInstance(l$w)){(l$L=l$i.addChild(l$L)).URI=l$R,l$L.href=l$r;var l$P=l$_.attributes;if(l$P&&0<l$P.length)for(l$b=0,l$z=l$P.length;l$b<l$z;++l$b){var l$B=l$P[l$b],l$n=l$B.nodeName,l$f=l$B.value;l$L._setAttributes(l$n,l$f)}l$J._parseXML(l$L,l$_.childNodes,l$R,l$L.href)}else l$J._parseXML(l$i,l$_.childNodes,l$R,l$r)}},l$J.char255=String.fromCharCode(255),l$J.spacePattern=/&nbsp;|&#160;/g,l$J.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),l$J}(),l$e=function(){function l$k(){}return l$L(l$k,"laya.html.utils.Layout"),l$k.later=function(l$i){null==l$k._will&&(l$k._will=[],l$r.stage.frameLoop(1,null,function(){if(!(l$k._will.length<1)){for(var l$i=0;l$i<l$k._will.length;l$i++)laya.html.utils.Layout.layout(l$k._will[l$i]);l$k._will.length=0}})),l$k._will.push(l$i)},l$k.layout=function(l$i){if(!l$i||!l$i._style)return null;if(0==(512&l$i._style._type))return null;l$i.getStyle()._type&=-513;var l$_=l$k._multiLineLayout(l$i);return l$f.isConchApp&&l$i.layaoutCallNative&&l$i.layaoutCallNative(),l$_},l$k._multiLineLayout=function(l$i){if(l$K.RightToLeft)return l$k._multiLineLayout2(l$i);var l$_=new Array;l$i._addChildsToLayout(l$_);var l$R,l$r,l$b,l$z,l$L,l$w=0,l$x=l$_.length,l$P=l$i._getCSSStyle(),l$B=l$P.letterSpacing,l$n=l$P.leading,l$f=l$P.lineHeight,l$J=l$P._widthAuto()||!l$P.wordWrap,l$h=l$J?999999:l$i.width,l$M=(l$i.height,0),l$N=l$P.italic?l$P.fontSize/3:0,l$X=l$P._getAlign(),l$t=l$P._getValign(),l$I=0!==l$t||0!==l$X||0!=l$f,l$e=0,l$c=0,l$l=0,l$A=0,l$Z=new Array,l$q=l$Z[0]=new l$O,l$j=!1,l$S=!1;l$q.h=0,l$P.italic&&(l$h-=l$P.fontSize/3);var l$v=0,l$$=!0;function l$G(){l$q.y=l$c,l$c+=l$q.h+l$n,0==l$q.h&&(l$c+=l$f),l$q.mWidth=l$v,l$v=0,l$q=new l$O,l$Z.push(l$q),l$q.h=0,l$j=!(l$$=!(l$e=0))}for(l$w=0;l$w<l$x;l$w++)if(null!=(l$R=l$_[l$w]))if(l$$=!1,l$R instanceof laya.html.dom.HTMLBrElement)l$G(),l$q.y=l$c;else{if(l$R._isChar()){if((l$z=l$R).isWord)l$j=l$S||"\n"===l$z.char,l$q.wordStartIndex=l$q.elements.length;else{if(l$l=l$z.width+l$z.style.letterSpacin,0<l$Z.length&&l$h<l$e+l$l&&0<l$q.wordStartIndex){var l$u;l$u=l$q.elements.length-l$q.wordStartIndex+1,l$q.elements.length=l$q.wordStartIndex,l$w-=l$u,l$G();continue}l$j=!1,l$v+=l$z.width}l$l=l$z.width+l$B,l$A=l$z.height,l$S=!1,(l$j=l$j||l$h<l$e+l$l)&&l$G(),l$q.minTextHeight=Math.min(l$q.minTextHeight,l$R.height)}else l$r=l$R._getCSSStyle(),l$L=l$R,l$b=l$r.padding,0===l$r._getCssFloat()||(l$I=!0),l$j=l$S||l$r.lineElement,l$l=l$L.width*l$L._style._tf.scaleX+l$b[1]+l$b[3]+l$B,l$A=l$L.height*l$L._style._tf.scaleY+l$b[0]+l$b[2],l$S=l$r.lineElement,(l$j=l$j||l$h<l$e+l$l&&l$r.wordWrap)&&l$G();l$q.elements.push(l$R),l$q.h=Math.max(l$q.h,l$A),l$R.x=l$e,l$R.y=l$c,l$e+=l$l,l$q.w=l$e-l$B,l$q.y=l$c,l$M=Math.max(l$e+l$N,l$M)}else l$$||(l$e+=l$k.DIV_ELEMENT_PADDING),l$q.wordStartIndex=l$q.elements.length;if(l$c=l$q.y+l$q.h,l$I){var l$o=0,l$p=l$h;for(l$J&&0<l$i.width&&(l$p=l$i.width),l$w=0,l$x=l$Z.length;l$w<l$x;l$w++)l$Z[l$w].updatePos(0,l$p,l$w,l$o,l$X,l$t,l$f),l$o+=Math.max(l$f,l$Z[l$w].h+l$n);l$c=l$o}return l$J&&(l$i.width=l$M),l$c>l$i.height&&(l$i.height=l$c),[l$M,l$c]},l$k._multiLineLayout2=function(l$i){var l$_=new Array;l$i._addChildsToLayout(l$_);var l$R,l$r,l$b,l$z,l$L,l$w=0,l$x=l$_.length,l$P=l$i._getCSSStyle(),l$B=l$P.letterSpacing,l$n=l$P.leading,l$f=l$P.lineHeight,l$J=l$P._widthAuto()||!l$P.wordWrap,l$h=l$J?999999:l$i.width,l$M=(l$i.height,0),l$N=l$P.italic?l$P.fontSize/3:0,l$X=2-l$P._getAlign(),l$t=l$P._getValign(),l$I=0!==l$t||0!=l$X||0!=l$f,l$e=0,l$c=0,l$l=0,l$A=0,l$Z=new Array,l$q=l$Z[0]=new l$O,l$j=!1,l$S=!1;l$q.h=0,l$P.italic&&(l$h-=l$P.fontSize/3);var l$v=0,l$$=!0;function l$G(){l$q.y=l$c,l$c+=l$q.h+l$n,0==l$q.h&&(l$c+=l$f),l$q.mWidth=l$v,l$v=0,l$q=new l$O,l$Z.push(l$q),l$q.h=0,l$j=!(l$$=!(l$e=0))}for(l$w=0;l$w<l$x;l$w++)if(null!=(l$R=l$_[l$w]))if(l$$=!1,l$R instanceof laya.html.dom.HTMLBrElement)l$G(),l$q.y=l$c;else{if(l$R._isChar()){if((l$z=l$R).isWord)l$j=l$S||"\n"===l$z.char,l$q.wordStartIndex=l$q.elements.length;else{if(0<l$Z.length&&l$h<l$e+l$l&&0<l$q.wordStartIndex){var l$u;l$u=l$q.elements.length-l$q.wordStartIndex+1,l$q.elements.length=l$q.wordStartIndex,l$w-=l$u,l$G();continue}l$j=!1,l$v+=l$z.width}l$l=l$z.width+l$B,l$A=l$z.height,l$S=!1,(l$j=l$j||l$h<l$e+l$l)&&l$G(),l$q.minTextHeight=Math.min(l$q.minTextHeight,l$R.height)}else l$r=l$R._getCSSStyle(),l$L=l$R,l$b=l$r.padding,0===l$r._getCssFloat()||(l$I=!0),l$j=l$S||l$r.lineElement,l$l=l$L.width*l$L._style._tf.scaleX+l$b[1]+l$b[3]+l$B,l$A=l$L.height*l$L._style._tf.scaleY+l$b[0]+l$b[2],l$S=l$r.lineElement,(l$j=l$j||l$h<l$e+l$l&&l$r.wordWrap)&&l$G();l$q.elements.push(l$R),l$q.h=Math.max(l$q.h,l$A),l$R.x=l$e,l$R.y=l$c,l$e+=l$l,l$q.w=l$e-l$B,l$q.y=l$c,l$M=Math.max(l$e+l$N,l$M)}else l$$||(l$e+=l$k.DIV_ELEMENT_PADDING),l$q.wordStartIndex=l$q.elements.length;if(l$c=l$q.y+l$q.h,l$I){var l$o=0,l$p=l$h;for(l$w=0,l$x=l$Z.length;l$w<l$x;l$w++)l$Z[l$w].updatePos(0,l$p,l$w,l$o,l$X,l$t,l$f),l$o+=Math.max(l$f,l$Z[l$w].h+l$n);l$c=l$o}for(l$J&&(l$i.width=l$M),l$c>l$i.height&&(l$i.height=l$c),l$w=0,l$x=l$Z.length;l$w<l$x;l$w++)l$Z[l$w].revertOrder(l$h);return[l$M,l$c]},l$k._will=null,l$k.DIV_ELEMENT_PADDING=0,l$k}(),l$O=function(){function l$i(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}l$L(l$i,"laya.html.utils.LayoutLine");var l$_=l$i.prototype;return l$_.updatePos=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){var l$w,l$x=0;0<this.elements.length&&(l$x=(l$w=this.elements[this.elements.length-1]).x+l$w.width-this.elements[0].x);var l$P=0,l$B=NaN;1===l$b&&(l$P=(l$_-l$x)/2),2===l$b&&(l$P=l$_-l$x),0===l$L||0!=l$z||(l$z=1);for(var l$n=0,l$f=this.elements.length;l$n<l$f;l$n++){var l$J=(l$w=this.elements[l$n])._getCSSStyle();switch(0!==l$P&&(l$w.x+=l$P),l$J._getValign()){case 0:l$w.y=l$r;break;case 1:var l$h=0;99999!=this.minTextHeight&&(l$h=this.minTextHeight);var l$M=(l$h+l$L)/2;l$M=Math.max(l$M,this.h),l$B=(laya.html.dom.HTMLImageElement,l$r+l$M-l$w.height),l$w.y=l$B;break;case 2:l$w.y=l$r+(l$L-l$w.height)}}},l$_.revertOrder=function(l$i){var l$_;if(0<this.elements.length){var l$R,l$r=0;for(l$R=this.elements.length,l$r=0;l$r<l$R;l$r++)(l$_=this.elements[l$r]).x=l$i-l$_.x-l$_.width}},l$i}(),l$c=function(l$R){function l$_(){this.URI=null,this._href=null,l$_.__super.call(this),this._text=l$_._EMPTYTEXT,this.setStyle(new l$x(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}l$L(l$_,"laya.html.dom.HTMLElement",l$R);var l$i=l$_.prototype;return l$i.layaoutCallNative=function(){var l$i=0;if(this._childs&&0<(l$i=this._childs.length))for(var l$_=0;l$_<l$i;l$_++)this._childs[l$_].layaoutCallNative&&this._childs[l$_].layaoutCallNative();var l$R=this._getWords();l$R?laya.html.dom.HTMLElement.fillWords(this,l$R,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},l$i.appendChild=function(l$i){return this.addChild(l$i)},l$i._getWords2=function(){var l$i=this._text.text;if(!l$i||0===l$i.length)return null;var l$_,l$R,l$r=0,l$b=0;if(this._text.drawWords)l$R=this._text.drawWords;else{for(l$b=(l$_=l$i.split(" ")).length-1,l$R=[],l$r=0;l$r<l$b;l$r++)l$R.push(l$_[l$r]," ");0<=l$b&&l$R.push(l$_[l$b]),this._text.drawWords=l$R}var l$z,l$L=this._text.words;if(l$L&&l$L.length===l$R.length)return l$L;null===l$L&&(this._text.words=l$L=[]),l$L.length=l$R.length;var l$w=this.style,l$x=l$w.font;for(l$r=0,l$b=l$R.length;l$r<l$b;l$r++){l$z=l$t.measureText(l$R[l$r],l$x);var l$P=l$L[l$r]=new l$n(l$R[l$r],l$z.width,l$z.height||l$w.fontSize,l$w);if(1<l$P.char.length&&(l$P.charNum=l$P.char),this.href){var l$B=new l$J;this.addChild(l$B),l$P.setSprite(l$B)}}return l$L},l$i._getWords=function(){if(!l$K.CharacterCache)return this._getWords2();var l$i=this._text.text;if(!l$i||0===l$i.length)return null;var l$_,l$R=this._text.words;if(l$R&&l$R.length===l$i.length)return l$R;null===l$R&&(this._text.words=l$R=[]),l$R.length=l$i.length;for(var l$r=this.style,l$b=l$r.font,l$z=0,l$L=l$i.length;l$z<l$L;l$z++)if(l$_=l$t.measureText(l$i.charAt(l$z),l$b)){var l$w=l$R[l$z]=new l$n(l$i.charAt(l$z),l$_.width,l$_.height||l$r.fontSize,l$r);if(this.href){var l$x=new l$J;this.addChild(l$x),l$w.setSprite(l$x)}}else console.warn("_getWords size is null"+l$i.charAt(l$z),l$b);return l$R},l$i.showLinkSprite=function(){var l$i=this._text.words;if(l$i)for(var l$_,l$R,l$r=[],l$b=0;l$b<l$i.length;l$b++)l$R=l$i[l$b],(l$_=new l$J).graphics.drawRect(0,0,l$R.width,l$R.height,"#ff0000"),l$_.width=l$R.width,l$_.height=l$R.height,this.addChild(l$_),l$r.push(l$_)},l$i._layoutLater=function(){var l$i=this.style;512&l$i._type||(l$i.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&l$i.block?(l$e.later(this),l$i._type|=512):this.parent&&this.parent._layoutLater())},l$i._setAttributes=function(l$i,l$_){switch(l$i){case"style":return void this.style.cssText(l$_);case"class":return void(this.className=l$_)}l$R.prototype._setAttributes.call(this,l$i,l$_)},l$i.updateHref=function(){if(null!=this._href){var l$i=this._getWords();if(l$i)for(var l$_,l$R,l$r=0;l$r<l$i.length;l$r++)(l$R=(l$_=l$i[l$r]).getSprite())&&(l$R.size(l$_.width,l$_.height),l$R.on("click",this,this.onLinkHandler))}},l$i.onLinkHandler=function(l$i){switch(l$i.type){case"click":for(var l$_=this;l$_;)l$_.event("link",[this.href]),l$_=l$_.parent}},l$i.formatURL=function(l$i){return this.URI?l$X.formatURL(l$i,this.URI?this.URI.path:null):l$i},l$w(0,l$i,"href",function(){return this._href},function(l$i){null!=(this._href=l$i)&&(this._getCSSStyle().underLine=1,this.updateHref())}),l$w(0,l$i,"color",null,function(l$i){this.style.color=l$i}),l$w(0,l$i,"onClick",null,function(l$i){l$r._runScript("fn=function(event){"+l$i+";}"),this.on("click",this,void 0)}),l$w(0,l$i,"id",null,function(l$i){l$l.document.setElementById(l$i,this)}),l$w(0,l$i,"innerTEXT",function(){return this._text.text},function(l$i){this.text=l$i}),l$w(0,l$i,"style",function(){return this._style}),l$w(0,l$i,"text",function(){return this._text.text},function(l$i){this._text==l$_._EMPTYTEXT?this._text={text:l$i,words:null}:(this._text.text=l$i,this._text.words&&(this._text.words.length=0)),l$f.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),l$w(0,l$i,"parent",l$R.prototype._$get_parent,function(l$i){if(l$i instanceof laya.html.dom.HTMLElement){var l$_=l$i;this.URI||(this.URI=l$_.URI),this.style.inherit(l$_.style)}l$r.superSet(l$J,this,"parent",l$i)}),l$w(0,l$i,"className",null,function(l$i){this.style.attrs(l$l.document.styleSheets["."+l$i])}),l$_.fillWords=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){l$i.graphics.clear();for(var l$w=0,l$x=l$_.length;l$w<l$x;l$w++){var l$P=l$_[l$w];l$i.graphics.fillText(l$P.char,l$P.x+l$R,l$P.y+l$r,l$b,l$z,"left",l$L)}},l$_._EMPTYTEXT={text:null,words:null},l$_}(l$J),l$_=(function(l$i){function l$_(){l$_.__super.call(this),this.style.lineElement=!0,this.style.block=!0}l$L(l$_,"laya.html.dom.HTMLBrElement",l$c)}(),function(l$i){function l$_(){this.contextHeight=NaN,this.contextWidth=NaN,l$_.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}l$L(l$_,"laya.html.dom.HTMLDivElement",l$i);var l$R=l$_.prototype;return l$R.appendHTML=function(l$i){l$I.parse(this,l$i,this.URI),this.layout()},l$R._addChildsToLayout=function(l$_){var l$i=this._getWords();if(null==l$i&&0==this._childs.length)return!1;l$i&&l$i.forEach(function(l$i){l$_.push(l$i)});for(var l$R=!0,l$r=0,l$b=this._childs.length;l$r<l$b;l$r++){var l$z=this._childs[l$r];l$R?l$R=!1:l$_.push(null),l$z._addToLayout(l$_)}return!0},l$R._addToLayout=function(l$i){this.layout()},l$R.layout=function(){if(this.style){this.style._type|=512;var l$i=l$e.layout(this);if(l$i){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new l$B);var l$_=this._$P.mHtmlBounds;l$_.x=l$_.y=0,l$_.width=this.contextWidth=l$i[0],l$_.height=this.contextHeight=l$i[1],this.setBounds(l$_)}}},l$w(0,l$R,"height",function(){return this._height?this._height:this.contextHeight},l$i.prototype._$set_height),l$w(0,l$R,"innerHTML",null,function(l$i){this.destroyChildren(),this.appendHTML(l$i)}),l$w(0,l$R,"width",function(){return this._width?this._width:this.contextWidth},function(l$i){var l$_=!1;l$_=0===l$i?l$i!=this._width:l$i!=this.width,l$r.superSet(l$c,this,"width",l$i),l$_&&this.layout()}),l$_}(l$c)),l$l=function(l$i){function l$_(){this.all=new Array,this.styleSheets=l$x.styleSheets,l$_.__super.call(this)}l$L(l$_,"laya.html.dom.HTMLDocument",l$c);var l$R=l$_.prototype;return l$R.getElementById=function(l$i){return this.all[l$i]},l$R.setElementById=function(l$i,l$_){this.all[l$i]=l$_},l$b(l$_,["document",function(){return this.document=new l$_}]),l$_}();(function(l$i){function l$_(){this._tex=null,this._url=null,this._renderArgs=[],l$_.__super.call(this),this.style.block=!0}l$L(l$_,"laya.html.dom.HTMLImageElement",l$c);var l$R=l$_.prototype;l$R._addToLayout=function(l$i){!this._style.absolute&&l$i.push(this)},l$R.render=function(l$i,l$_,l$R){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(l$M.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,l$i.ctx.drawTexture2(l$_,l$R,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},l$R.layaoutCallNative=function(){var l$i=0;if(this._childs&&0<(l$i=this._childs.length))for(var l$_=0;l$_<l$i;l$_++)this._childs[l$_].layaoutCallNative&&this._childs[l$_].layaoutCallNative()},l$w(0,l$R,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(l$i){this._width!==l$i&&(this._width=l$i,this._style.width=l$i,this.repaint())}),l$w(0,l$R,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(l$i){this._height!==l$i&&(this._height=l$i,this._style.height=l$i,this.repaint())}),l$R.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),l$P.clearCache(this,this._url),this._tex=null),l$c.prototype.destroy.call(this)},l$R.onloaded=function(){var l$i=this._style;l$i&&!l$i.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),l$i&&!l$i.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),l$f.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},l$R._loadImageComplete=function(l$i,l$_,l$R){if(!this._destroyed)if(null!=l$R)if(l$R instanceof ArrayBuffer){var l$r=new DataView(l$R);new laya.webgl.resource.WebGLImage(new Uint8Array(l$R,8),l$i,0,!1,l$r.getUint32(0),l$r.getUint32(4));this.onloaded()}else if(l$R instanceof l$N)l$P.imgMgrSet[l$i]=l$_,l$z.imgMgrLock(l$i,l$P.imgMgrSet[l$i]),this._url=l$i,this._tex=l$R,l$P.keepCache(this,l$i),l$P.cacheRes(l$i,this._tex),this.onloaded();else{var l$b=-1!=l$i.indexOf(".png",l$i.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(l$R,l$i,l$b,!1,l$R.width,l$R.height);this.onloaded()}else this.event("error","Load image failed")},l$w(0,l$R,"src",null,function(l$i){(l$i=this.formatURL(l$i),this._url!=l$i)&&(null!=this._tex&&(l$P.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=l$i,(this._tex=l$P.getRes(l$i))?(l$P.keepCache(this,l$i),this.onloaded()):l$z.imgMgrLoad(l$i,this._loadImageComplete.bind(this),2,!1))})})(),function(l$i){function l$_(){this.type=null,l$_.__super.call(this),this.visible=!1}l$L(l$_,"laya.html.dom.HTMLLinkElement",l$i);var l$R=l$_.prototype;l$R._onload=function(l$i){switch(this.type){case"text/css":l$x.parseCSS(l$i,this.URI)}},l$w(0,l$R,"href",l$i.prototype._$get_href,function(l$i){var l$_=this;l$i=this.formatURL(l$i),this.URI=new l$X(l$i);var l$R=new l$P;l$R.once("complete",null,function(l$i){l$_._onload(l$i)}),l$R.load(l$i,"text")}),l$_._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(l$c),function(l$i){function l$_(){l$_.__super.call(this),this.visible=!1}l$L(l$_,"laya.html.dom.HTMLStyleElement",l$i),l$w(0,l$_.prototype,"text",l$i.prototype._$get_text,function(l$i){l$x.parseCSS(l$i,null)})}(l$c),function(l$i){function l$_(){l$_.__super.call(this),this._getCSSStyle().valign="middle"}l$L(l$_,"laya.html.dom.HTMLIframeElement",l$i),l$w(0,l$_.prototype,"href",l$i.prototype._$get_href,function(l$R){var l$r=this;l$R=this.formatURL(l$R);var l$i=new l$P;l$i.once("complete",null,function(l$i){var l$_=l$r.URI;l$r.URI=new l$X(l$R),l$r.innerHTML=l$i,!l$_||(l$r.URI=l$_)}),l$i.load(l$R,"text")})}(l$_)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(l$i,l$_){"use strict";for(var l$R in Object.defineProperty(l$_,"__esModule",{value:!0}),Laya){var l$r=Laya[l$R];l$r&&l$r.__isclass&&(l$_[l$R]=l$r)}}),function(l$b,l$i,l$M){l$M.un,l$M.uns;var l$r=l$M.static,l$z=l$M.class,l$L=l$M.getset,l$R=(l$M.__newvec,laya.display.Animation),l$N=(laya.utils.Browser,laya.utils.ClassUtils),l$w=laya.filters.ColorFilter,l$x=laya.utils.Ease,l$P=laya.events.Event,l$B=(laya.events.EventDispatcher,laya.display.css.Font),l$n=laya.display.FrameAnimation,l$_=laya.display.Graphics,l$f=laya.utils.Handler,l$J=laya.display.Input,l$t=laya.net.Loader,l$h=(laya.display.Node,laya.maths.Point),l$X=laya.maths.Rectangle,l$I=laya.renders.Render,l$e=laya.display.Sprite,l$c=laya.display.Text,l$l=laya.resource.Texture,l$A=laya.utils.Tween,l$Z=laya.utils.Utils,l$q=laya.utils.WeakObject;l$M.interface("laya.ui.IItem"),l$M.interface("laya.ui.ISelect"),l$M.interface("laya.ui.IRender"),l$M.interface("laya.ui.IComponent"),l$M.interface("laya.ui.IBox","IComponent");var l$j=function(){function l$i(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return l$z(l$i,"laya.ui.LayoutStyle"),l$r(l$i,["EMPTY",function(){return this.EMPTY=new l$i}]),l$i}(),l$S=function(){function l$i(){}return l$z(l$i,"laya.ui.Styles"),l$i.labelColor="#000000",l$i.buttonStateNum=3,l$i.scrollBarMinNum=15,l$i.scrollBarDelayTime=500,l$r(l$i,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),l$i}(),l$v=function(){function l$b(){}return l$z(l$b,"laya.ui.UIUtils"),l$b.fillArray=function(l$i,l$_,l$R){var l$r=l$i.concat();if(l$_)for(var l$b=l$_.split(","),l$z=0,l$L=Math.min(l$r.length,l$b.length);l$z<l$L;l$z++){var l$w=l$b[l$z];l$r[l$z]="true"==l$w||"false"!=l$w&&l$w,null!=l$R&&(l$r[l$z]=l$R(l$w))}return l$r},l$b.toColor=function(l$i){return l$Z.toHexColor(l$i)},l$b.gray=function(l$i,l$_){void 0===l$_&&(l$_=!0),l$_?l$b.addFilter(l$i,l$b.grayFilter):l$b.clearFilter(l$i,l$w)},l$b.addFilter=function(l$i,l$_){var l$R=l$i.filters||[];l$R.push(l$_),l$i.filters=l$R},l$b.clearFilter=function(l$i,l$_){var l$R=l$i.filters;if(null!=l$R&&0<l$R.length){for(var l$r=l$R.length-1;-1<l$r;l$r--){var l$b=l$R[l$r];l$M.__typeof(l$b,l$_)&&l$R.splice(l$r,1)}l$i.filters=l$R}},l$b._getReplaceStr=function(l$i){return l$b.escapeSequence[l$i]},l$b.adptString=function(l$i){return l$i.replace(/\\(\w)/g,l$b._getReplaceStr)},l$b.getBindFun=function(l$i){var l$_=l$b._funMap.get(l$i);if(null==l$_){var l$R='"'+l$i+'"',l$r="(function(data){if(data==null)return;with(data){try{\nreturn "+(l$R=l$R.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";l$_=l$M._runScript(l$r),l$b._funMap.set(l$i,l$_)}return l$_},l$r(l$b,["grayFilter",function(){return this.grayFilter=new l$w([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new l$q}]),l$b}(),l$$=function(){function l$i(){}return l$z(l$i,"UIConfig"),l$i.touchScrollEnable=!0,l$i.mouseWheelEnable=!0,l$i.showButtons=!0,l$i.popupBgColor="#000000",l$i.popupBgAlpha=.5,l$i.closeDialogOnSide=!0,l$i}(),l$G=function(l$R){function l$X(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,l$X.__super.call(this),this._weakKeys=[]}l$z(l$X,"laya.ui.AutoBitmap",l$R);var l$i=l$X.prototype;return l$i.destroy=function(){if(l$t.clearObject(this,this._weakKey),this._weakKeys){for(var l$i=0,l$_=this._weakKeys.length;l$i<l$_;++l$i)l$t.clearObject(this,this._weakKeys[l$i]);this._weakKeys=null}l$R.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},l$i._setChanged=function(){this._isChanged||(this._isChanged=!0,l$M.timer.callLater(this,this.changeSource))},l$i.changeSource=function(){this._isChanged=!1;var l$i=this._source;if(l$i&&l$i.bitmap){var l$_=this.width,l$R=this.height,l$r=this._sizeGrid,l$b=l$i.sourceWidth,l$z=l$i.sourceHeight;if(!l$r||l$b===l$_&&l$z===l$R)this.cleanByTexture(l$i,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,l$_,l$R);else{l$t.clearObject(this,this._weakKey),l$i.$_GID||(l$i.$_GID=l$Z.getGID());var l$L=l$i.$_GID+"."+l$_+"."+l$R+"."+l$r.join("."),l$w=l$t.findObject(l$L);if(l$Z.isOKCmdList(l$w))return this._weakKey=l$L,l$t.keepObject(this,this._weakKey),void(this.cmds=l$w);this.clear();var l$x,l$P,l$B=l$r[0],l$n=l$r[1],l$f=l$r[2],l$J=l$r[3],l$h=l$r[4],l$M=!1;if(l$_==l$b&&(l$J=l$n=0),l$R==l$z&&(l$B=l$f=0),l$_<l$J+l$n){var l$N=l$_;l$M=!0,l$_=l$J+l$n,this.save(),this.clipRect(0,0,l$N,l$R)}l$J&&l$B&&(l$x=l$X.getTexture(l$i,0,0,l$J,l$B),l$P=this._weakKeys[0],l$x?(l$P!=l$x.weakKey&&(l$t.clearObject(this,l$P),l$t.keepObject(this,l$x.weakKey),this._weakKeys[0]=l$x.weakKey),this.drawTexture(l$x,0,0,l$J,l$B)):(l$t.clearObject(this,l$P),this._weakKeys[0]="")),l$n&&l$B&&(l$x=l$X.getTexture(l$i,l$b-l$n,0,l$n,l$B),l$P=this._weakKeys[1],l$x?(l$P!=l$x.weakKey&&(l$t.clearObject(this,l$P),l$t.keepObject(this,l$x.weakKey),this._weakKeys[1]=l$x.weakKey),this.drawTexture(l$x,l$_-l$n,0,l$n,l$B)):(l$t.clearObject(this,l$P),this._weakKeys[1]="")),l$J&&l$f&&(l$x=l$X.getTexture(l$i,0,l$z-l$f,l$J,l$f),l$P=this._weakKeys[2],l$x?(l$P!=l$x.weakKey&&(l$t.clearObject(this,l$P),l$t.keepObject(this,l$x.weakKey),this._weakKeys[2]=l$x.weakKey),this.drawTexture(l$x,0,l$R-l$f,l$J,l$f)):(l$t.clearObject(this,l$P),this._weakKeys[2]="")),l$n&&l$f&&(l$x=l$X.getTexture(l$i,l$b-l$n,l$z-l$f,l$n,l$f),l$P=this._weakKeys[3],l$x?(l$P!=l$x.weakKey&&(l$t.clearObject(this,l$P),l$t.keepObject(this,l$x.weakKey),this._weakKeys[3]=l$x.weakKey),this.drawTexture(l$x,l$_-l$n,l$R-l$f,l$n,l$f)):(l$t.clearObject(this,l$P),this._weakKeys[3]="")),l$B&&(l$x=l$X.getTexture(l$i,l$J,0,l$b-l$J-l$n,l$B),l$P=this._weakKeys[4],l$x?(l$P!=l$x.weakKey&&(l$t.clearObject(this,l$P),l$t.keepObject(this,l$x.weakKey),this._weakKeys[4]=l$x.weakKey),this.drawBitmap(l$h,l$x,l$J,0,l$_-l$J-l$n,l$B)):(l$t.clearObject(this,l$P),this._weakKeys[4]="")),l$f&&(l$x=l$X.getTexture(l$i,l$J,l$z-l$f,l$b-l$J-l$n,l$f),l$P=this._weakKeys[5],l$x?(l$P!=l$x.weakKey&&(l$t.clearObject(this,l$P),l$t.keepObject(this,l$x.weakKey),this._weakKeys[5]=l$x.weakKey),this.drawBitmap(l$h,l$x,l$J,l$R-l$f,l$_-l$J-l$n,l$f)):(l$t.clearObject(this,l$P),this._weakKeys[5]="")),l$J&&(l$x=l$X.getTexture(l$i,0,l$B,l$J,l$z-l$B-l$f),l$P=this._weakKeys[6],l$x?(l$P!=l$x.weakKey&&(l$t.clearObject(this,l$P),l$t.keepObject(this,l$x.weakKey),this._weakKeys[6]=l$x.weakKey),this.drawBitmap(l$h,l$x,0,l$B,l$J,l$R-l$B-l$f)):(l$t.clearObject(this,l$P),this._weakKeys[6]="")),l$n&&(l$x=l$X.getTexture(l$i,l$b-l$n,l$B,l$n,l$z-l$B-l$f),l$P=this._weakKeys[7],l$x?(l$P!=l$x.weakKey&&(l$t.clearObject(this,l$P),l$t.keepObject(this,l$x.weakKey),this._weakKeys[7]=l$x.weakKey),this.drawBitmap(l$h,l$x,l$_-l$n,l$B,l$n,l$R-l$B-l$f)):(l$t.clearObject(this,l$P),this._weakKeys[7]="")),l$x=l$X.getTexture(l$i,l$J,l$B,l$b-l$J-l$n,l$z-l$B-l$f),l$P=this._weakKeys[8],l$x?(l$P!=l$x.weakKey&&(l$t.clearObject(this,l$P),l$t.keepObject(this,l$x.weakKey),this._weakKeys[8]=l$x.weakKey),this.drawBitmap(l$h,l$x,l$J,l$B,l$_-l$J-l$n,l$R-l$B-l$f)):(l$t.clearObject(this,l$P),this._weakKeys[8]=""),l$M&&this.restore(),this.autoCacheCmd&&!l$I.isConchApp&&(l$t.saveObject(l$L,this.cmds,null),this._weakKey=l$L,l$t.keepObject(this,this._weakKey))}this._repaint()}},l$i.drawBitmap=function(l$i,l$_,l$R,l$r,l$b,l$z){void 0===l$b&&(l$b=0),void 0===l$z&&(l$z=0),l$b<.1||l$z<.1||(!l$i||l$_.width==l$b&&l$_.height==l$z?this.drawTexture(l$_,l$R,l$r,l$b,l$z):this.fillTexture(l$_,l$R,l$r,l$b,l$z))},l$i.clear=function(l$i){void 0===l$i&&(l$i=!0),l$R.prototype.clear.call(this,!1)},l$L(0,l$i,"sizeGrid",function(){return this._sizeGrid},function(l$i){this._sizeGrid=l$i,this._setChanged()}),l$L(0,l$i,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(l$i){this._width!=l$i&&(this._width=l$i,this._setChanged())}),l$L(0,l$i,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(l$i){this._height!=l$i&&(this._height=l$i,this._setChanged())}),l$L(0,l$i,"source",function(){return this._source},function(l$i){l$i?(this._source=l$i,this._setChanged()):(this._source=null,this.clear())}),l$X.getTexture=function(l$i,l$_,l$R,l$r,l$b){l$r<=0&&(l$r=1),l$b<=0&&(l$b=1),l$i.$_GID||(l$i.$_GID=l$Z.getGID());var l$z=l$i.$_GID+"."+l$_+"."+l$R+"."+l$r+"."+l$b,l$L=l$t.findObject(l$z);if((!l$L||!l$L.source)&&(l$L=l$l.createFromTexture(l$i,l$_,l$R,l$r,l$b))){if(l$i.alphaTexture){var l$w=l$i.width/l$i.alphaTexture.width;l$L.alphaTexture=l$l.createFromTexture(l$i.alphaTexture,l$_/l$w,l$R/l$w,l$r/l$w,l$b/l$w)}l$t.saveObject(l$z,l$L),l$L.weakKey=l$z}return l$L},l$X}(l$_),l$u=(function(l$i){function l$_(){l$_.__super.call(this)}l$z(l$_,"laya.ui.UIEvent",l$P),l$_.SHOW_TIP="showtip",l$_.HIDE_TIP="hidetip"}(),function(l$_){function l$i(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,l$i.__super.call(this),this._layout=l$j.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}l$z(l$i,"laya.ui.Component",l$_);var l$R=l$i.prototype;return l$M.imps(l$R,{"laya.ui.IComponent":!0}),l$R.destroy=function(l$i){void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,l$i),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},l$R.preinitialize=function(){},l$R.createChildren=function(){},l$R.initialize=function(){},l$R.callLater=function(l$i,l$_){l$M.timer.callLater(this,l$i,l$_)},l$R.runCallLater=function(l$i){l$M.timer.runCallLater(this,l$i)},l$R.commitMeasure=function(){},l$R.changeSize=function(){this.event("resize")},l$R.getLayout=function(){return this._layout===l$j.EMPTY&&(this._layout=new l$j),this._layout},l$R._setLayoutEnabled=function(l$i){this._layout&&this._layout.enable!=l$i&&(this._layout.enable=l$i,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},l$R.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},l$R.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},l$R.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},l$R.resetLayoutX=function(){var l$i=this._layout;if(isNaN(l$i.anchorX)||(this.pivotX=l$i.anchorX*this.width),this.layoutEnabled){var l$_=this.parent;l$_&&(isNaN(l$i.centerX)?isNaN(l$i.left)?isNaN(l$i.right)||(this.x=Math.round(l$_.width-this.displayWidth-l$i.right+this.pivotX*this.scaleX)):(this.x=Math.round(l$i.left+this.pivotX*this.scaleX),isNaN(l$i.right)||(this.width=(l$_._width-l$i.left-l$i.right)/(this.scaleX||.01))):this.x=Math.round(.5*(l$_.width-this.displayWidth)+l$i.centerX+this.pivotX*this.scaleX))}},l$R.resetLayoutY=function(){var l$i=this._layout;if(isNaN(l$i.anchorY)||(this.pivotY=l$i.anchorY*this.height),this.layoutEnabled){var l$_=this.parent;l$_&&(isNaN(l$i.centerY)?isNaN(l$i.top)?isNaN(l$i.bottom)||(this.y=Math.round(l$_.height-this.displayHeight-l$i.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(l$i.top+this.pivotY*this.scaleY),isNaN(l$i.bottom)||(this.height=(l$_._height-l$i.top-l$i.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(l$_.height-this.displayHeight)+l$i.centerY+this.pivotY*this.scaleY))}},l$R.onMouseOver=function(l$i){l$M.stage.event("showtip",this._toolTip)},l$R.onMouseOut=function(l$i){l$M.stage.event("hidetip",this._toolTip)},l$L(0,l$R,"displayWidth",function(){return this.width*this.scaleX}),l$L(0,l$R,"width",function(){return this._width?this._width:this.measureWidth},function(l$i){this._width!=l$i&&(this._width=l$i,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),l$L(0,l$R,"measureWidth",function(){var l$i=0;this.commitMeasure();for(var l$_=this.numChildren-1;-1<l$_;l$_--){var l$R=this.getChildAt(l$_);l$R.visible&&(l$i=Math.max(l$R.x+l$R.width*l$R.scaleX,l$i))}return l$i}),l$L(0,l$R,"displayHeight",function(){return this.height*this.scaleY}),l$L(0,l$R,"height",function(){return this._height?this._height:this.measureHeight},function(l$i){this._height!=l$i&&(this._height=l$i,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),l$L(0,l$R,"dataSource",function(){return this._dataSource},function(l$i){for(var l$_ in this._dataSource=l$i,this._dataSource)this.hasOwnProperty(l$_)&&"function"!=typeof this[l$_]&&(this[l$_]=this._dataSource[l$_])}),l$L(0,l$R,"scaleY",l$_.prototype._$get_scaleY,function(l$i){l$M.superGet(l$e,this,"scaleY")!=l$i&&(l$M.superSet(l$e,this,"scaleY",l$i),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),l$L(0,l$R,"measureHeight",function(){var l$i=0;this.commitMeasure();for(var l$_=this.numChildren-1;-1<l$_;l$_--){var l$R=this.getChildAt(l$_);l$R.visible&&(l$i=Math.max(l$R.y+l$R.height*l$R.scaleY,l$i))}return l$i}),l$L(0,l$R,"scaleX",l$_.prototype._$get_scaleX,function(l$i){l$M.superGet(l$e,this,"scaleX")!=l$i&&(l$M.superSet(l$e,this,"scaleX",l$i),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),l$L(0,l$R,"top",function(){return this._layout.top},function(l$i){l$i!=this._layout.top&&(this.getLayout().top=l$i,this._setLayoutEnabled(!0)),this.resetLayoutY()}),l$L(0,l$R,"bottom",function(){return this._layout.bottom},function(l$i){l$i!=this._layout.bottom&&(this.getLayout().bottom=l$i,this._setLayoutEnabled(!0)),this.resetLayoutY()}),l$L(0,l$R,"left",function(){return this._layout.left},function(l$i){l$i!=this._layout.left&&(this.getLayout().left=l$i,this._setLayoutEnabled(!0)),this.resetLayoutX()}),l$L(0,l$R,"right",function(){return this._layout.right},function(l$i){l$i!=this._layout.right&&(this.getLayout().right=l$i,this._setLayoutEnabled(!0)),this.resetLayoutX()}),l$L(0,l$R,"centerX",function(){return this._layout.centerX},function(l$i){l$i!=this._layout.centerX&&(this.getLayout().centerX=l$i,this._setLayoutEnabled(!0)),this.resetLayoutX()}),l$L(0,l$R,"centerY",function(){return this._layout.centerY},function(l$i){l$i!=this._layout.centerY&&(this.getLayout().centerY=l$i,this._setLayoutEnabled(!0)),this.resetLayoutY()}),l$L(0,l$R,"anchorX",function(){return this._layout.anchorX},function(l$i){l$i!=this._layout.anchorX&&(this.getLayout().anchorX=l$i,this._setLayoutEnabled(!0)),this.resetLayoutX()}),l$L(0,l$R,"anchorY",function(){return this._layout.anchorY},function(l$i){l$i!=this._layout.anchorY&&(this.getLayout().anchorY=l$i,this._setLayoutEnabled(!0)),this.resetLayoutY()}),l$L(0,l$R,"tag",function(){return this._tag},function(l$i){this._tag=l$i}),l$L(0,l$R,"toolTip",function(){return this._toolTip},function(l$i){this._toolTip!=l$i&&(null!=(this._toolTip=l$i)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),l$L(0,l$R,"comXml",function(){return this._comXml},function(l$i){this._comXml=l$i}),l$L(0,l$R,"gray",function(){return this._gray},function(l$i){l$i!==this._gray&&(this._gray=l$i,l$v.gray(this,l$i))}),l$L(0,l$R,"disabled",function(){return this._disabled},function(l$i){l$i!==this._disabled&&(this.gray=this._disabled=l$i,this.mouseEnabled=!l$i)}),l$i}(l$e)),l$o=function(l$i){function l$_(){this.lockLayer=null,this.popupEffect=function(l$i){l$i.scale(1,1),l$A.from(l$i,{x:l$M.stage.width/2,y:l$M.stage.height/2,scaleX:0,scaleY:0},300,l$x.backOut,l$f.create(this,this.doOpen,[l$i]))},this.closeEffect=function(l$i,l$_){l$A.to(l$i,{x:l$M.stage.width/2,y:l$M.stage.height/2,scaleX:0,scaleY:0},300,l$x.strongOut,l$f.create(this,this.doClose,[l$i,l$_]))},l$_.__super.call(this),this.maskLayer=new l$e,this.popupEffectHandler=l$f.create(this,this.popupEffect,null,!1),this.closeEffectHandler=l$f.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,l$M.stage.addChild(this),l$M.stage.on("resize",this,this._onResize),l$$.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}l$z(l$_,"laya.ui.DialogManager",l$e);var l$R=l$_.prototype;return l$R._closeOnSide=function(){var l$i=this.getChildAt(this.numChildren-1);l$i instanceof laya.ui.Dialog&&l$i.close("side")},l$R.setLockView=function(l$i){this.lockLayer||(this.lockLayer=new l$p,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(l$M.stage.width,l$M.stage.height)),this.lockLayer.removeChildren(),l$i&&(l$i.centerX=l$i.centerY=0,this.lockLayer.addChild(l$i))},l$R._onResize=function(l$i){var l$_=this.maskLayer.width=l$M.stage.width,l$R=this.maskLayer.height=l$M.stage.height;this.lockLayer&&this.lockLayer.size(l$_,l$R),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,l$_,l$R,l$$.popupBgColor),this.maskLayer.alpha=l$$.popupBgAlpha;for(var l$r=this.numChildren-1;-1<l$r;l$r--){var l$b=this.getChildAt(l$r);l$b.popupCenter&&this._centerDialog(l$b)}},l$R._centerDialog=function(l$i){l$i.x=Math.round((l$M.stage.width-l$i.width>>1)+l$i.pivotX),l$i.y=Math.round((l$M.stage.height-l$i.height>>1)+l$i.pivotY)},l$R.open=function(l$i,l$_,l$R){void 0===l$_&&(l$_=!1),void 0===l$R&&(l$R=!1),l$_&&this._closeAll(),l$i.popupCenter&&this._centerDialog(l$i),this.addChild(l$i),(l$i.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),l$R&&null!=l$i.popupEffect?l$i.popupEffect.runWith(l$i):this.doOpen(l$i),this.event("open")},l$R.doOpen=function(l$i){l$i.onOpened()},l$R.lock=function(l$i){this.lockLayer&&(l$i?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},l$R.close=function(l$i,l$_,l$R){void 0===l$R&&(l$R=!1),l$R&&null!=l$i.closeEffect?l$i.closeEffect.runWith([l$i,l$_]):this.doClose(l$i,l$_),this.event("close")},l$R.doClose=function(l$i,l$_){l$i.removeSelf(),l$i.isModal&&this._checkMask(),l$i.closeHandler&&l$i.closeHandler.runWith(l$_),l$i.onClosed(l$_)},l$R.closeAll=function(){this._closeAll(),this.event("close")},l$R._closeAll=function(){for(var l$i=this.numChildren-1;-1<l$i;l$i--){var l$_=this.getChildAt(l$i);l$_&&null!=l$_.close&&this.doClose(l$_)}},l$R.getDialogsByGroup=function(l$i){for(var l$_=[],l$R=this.numChildren-1;-1<l$R;l$R--){var l$r=this.getChildAt(l$R);l$r&&l$r.group===l$i&&l$_.push(l$r)}return l$_},l$R.closeByGroup=function(l$i){for(var l$_=[],l$R=this.numChildren-1;-1<l$R;l$R--){var l$r=this.getChildAt(l$R);l$r&&l$r.group===l$i&&(l$r.close(),l$_.push(l$r))}return l$_},l$R._checkMask=function(){this.maskLayer.removeSelf();for(var l$i=this.numChildren-1;-1<l$i;l$i--){var l$_=this.getChildAt(l$i);if(l$_&&l$_.isModal)return void this.addChildAt(this.maskLayer,l$i)}},l$_}(),l$p=function(l$i){function l$_(){l$_.__super.call(this)}l$z(l$_,"laya.ui.Box",l$i);var l$R=l$_.prototype;return l$M.imps(l$R,{"laya.ui.IBox":!0}),l$L(0,l$R,"dataSource",l$i.prototype._$get_dataSource,function(l$i){for(var l$_ in this._dataSource=l$i){var l$R=this.getChildByName(l$_);l$R?l$R.dataSource=l$i[l$_]:this.hasOwnProperty(l$_)&&"function"!=typeof this[l$_]&&(this[l$_]=l$i[l$_])}}),l$_}(l$u),l$k=function(l$_){function l$R(l$i,l$_){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,l$R.__super.call(this),this._labelColors=l$S.buttonLabelColors,this._stateNum=l$S.buttonStateNum,void 0===l$_&&(l$_=""),this.skin=l$i,this.label=l$_}l$z(l$R,"laya.ui.Button",l$_);var l$i=l$R.prototype;return l$M.imps(l$i,{"laya.ui.ISelect":!0}),l$i.destroy=function(l$i){this.clearEvent(),l$t.clearCache(this,this._skin),l$t.clearObject(this,this._weakKey),void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,l$i),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(l$i),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},l$i.clearEvent=function(){this._skin&&l$b.atalsNotify&&l$b.atalsNotify.off(this._skin,this,this._setBtnSource)},l$i.createChildren=function(){this.graphics=this._bitmap=new l$G},l$i.createText=function(){this._text||(this._text=new l$c,this._text.overflow=l$c.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},l$i.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},l$i.onMouse=function(l$i){if(!1!==this.toggle||!this._selected)return"click"===l$i.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=l$R.stateMap[l$i.type]))},l$i.changeClips=function(){var l$i=l$t.getRes(this._skin);if(l$i)if(this._skin&&""!=this._skin){l$t.clearObject(this,this._weakKey);var l$_=l$i.sourceWidth,l$R=l$i.sourceHeight/this._stateNum;l$i.$_GID||(l$i.$_GID=l$Z.getGID());var l$r=l$i.$_GID+"-"+this._stateNum,l$b=l$t.findObject(l$r);if(l$Z.isOkTextureList(l$b)||(l$b=null),l$b)this._weakKey=l$r,l$t.keepObject(this,this._weakKey),this._sources=l$b;else{if(this._sources=[],1===this._stateNum)this._sources.push(l$i);else for(var l$z=0;l$z<this._stateNum;l$z++){var l$L=l$l.createFromTexture(l$i,0,l$R*l$z,l$_,l$R);if(l$i.alphaTexture){var l$w=l$i.width/l$i.alphaTexture.width;l$L.alphaTexture=l$l.createFromTexture(l$i.alphaTexture,0/l$w,l$R*l$z/l$w,l$_/l$w,l$R/l$w)}this._sources.push(l$L)}l$t.saveObject(l$r,this._sources),this._weakKey=l$r,l$t.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||l$_,this._bitmap.height=this._height||l$R,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=l$_)}else console.warn("lose skin ",this._skin,this.name,this.__className)},l$i.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var l$i=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[l$i]),this.label&&(this._text.color=this._labelColors[l$i],this._strokeColors&&(this._text.strokeColor=this._strokeColors[l$i]))},l$i._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},l$L(0,l$i,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(l$i){this.createText(),this._text.strokeColor=l$i}),l$L(0,l$i,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),l$L(0,l$i,"skin",function(){return this._skin},function(l$i){if(this._skin!=l$i)if(this.clearEvent(),l$t.clearCache(this,this._skin),this._skin=l$i,l$t.keepCache(this,this._skin),l$t.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var l$_=l$b.resAtalsObj&&l$b.resAtalsObj[this._skin];l$_?(l$b.atalsNotify&&l$b.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=l$_.sourceW),0==this.height&&(this.height=l$_.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),l$i._setBtnSource=function(l$i,l$_){l$i===this._skin&&l$_&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},l$L(0,l$i,"state",function(){return this._state},function(l$i){this._state!=l$i&&(this._state=l$i,this._setStateChanged())}),l$L(0,l$i,"text",function(){return this.createText(),this._text}),l$L(0,l$i,"stateNum",function(){return this._stateNum},function(l$i){"string"==typeof l$i&&(l$i=parseInt(l$i)),this._stateNum!=l$i&&(this._stateNum=l$i<1?1:3<l$i?3:l$i,this.callLater(this.changeClips))}),l$L(0,l$i,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(l$i){this._strokeColors=l$v.fillArray(l$S.buttonLabelColors,l$i,String),this._setStateChanged()}),l$L(0,l$i,"labelColors",function(){return this._labelColors.join(",")},function(l$i){this._labelColors=l$v.fillArray(l$S.buttonLabelColors,l$i,String),this._setStateChanged()}),l$L(0,l$i,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),l$L(0,l$i,"label",function(){return this._text?this._text.text:null},function(l$i){(this._text||l$i)&&(this.createText(),this._text.text!=l$i&&(l$i&&!this._text.parent&&this.addChild(this._text),this._text.text=(l$i+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),l$L(0,l$i,"selected",function(){return this._selected},function(l$i){this._selected!=l$i&&(this._selected=l$i,this.state=this._selected?2:0,this.event("change"))}),l$L(0,l$i,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(l$i){this.createText(),this._text.padding=l$v.fillArray(l$S.labelPadding,l$i,Number)}),l$L(0,l$i,"labelSize",function(){return this.createText(),this._text.fontSize},function(l$i){this.createText(),this._text.fontSize=l$i}),l$L(0,l$i,"labelStroke",function(){return this.createText(),this._text.stroke},function(l$i){this.createText(),this._text.stroke=l$i}),l$L(0,l$i,"labelBold",function(){return this.createText(),this._text.bold},function(l$i){this.createText(),this._text.bold=l$i}),l$L(0,l$i,"labelFont",function(){return this.createText(),this._text.font},function(l$i){this.createText(),this._text.font=l$i}),l$L(0,l$i,"labelAlign",function(){return this.createText(),this._text.align},function(l$i){this.createText(),this._text.align=l$i}),l$L(0,l$i,"clickHandler",function(){return this._clickHandler},function(l$i){this._clickHandler=l$i}),l$L(0,l$i,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(l$i){this._bitmap.sizeGrid=l$v.fillArray(l$S.defaultSizeGrid,l$i,Number)}),l$L(0,l$i,"width",l$_.prototype._$get_width,function(l$i){l$M.superSet(l$u,this,"width",l$i),this._autoSize&&(this._bitmap.width=l$i,this._text&&(this._text.width=l$i))}),l$L(0,l$i,"height",l$_.prototype._$get_height,function(l$i){l$M.superSet(l$u,this,"height",l$i),this._autoSize&&(this._bitmap.height=l$i,this._text&&(this._text.height=l$i))}),l$L(0,l$i,"dataSource",l$_.prototype._$get_dataSource,function(l$i){"number"==typeof(this._dataSource=l$i)||"string"==typeof l$i?this.label=l$i+"":l$M.superSet(l$u,this,"dataSource",l$i)}),l$L(0,l$i,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(l$i){this._bitmap._offset=l$i?l$v.fillArray([1,1],l$i,Number):[]}),l$r(l$R,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),l$R}(l$u),l$K=function(l$_){function l$r(l$i,l$_,l$R){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,l$r.__super.call(this),void 0===l$_&&(l$_=1),void 0===l$R&&(l$R=1),this._clipX=l$_,this._clipY=l$R,this.skin=l$i}l$z(l$r,"laya.ui.Clip",l$_);var l$i=l$r.prototype;return l$i.destroy=function(l$i){this.clearEvent(),this.clearLoad(),l$t.clearCache(this,this._skin),l$t.clearObject(this,this._weakKey),void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},l$i.dispose=function(){this.destroy(!0),l$M.loader.clearRes(this._skin)},l$i.createChildren=function(){this.graphics=this._bitmap=new l$G},l$i._onDisplay=function(l$i){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},l$i.changeClip=function(){if(this._clipChanged=!1,this._skin){var l$i=l$t.getRes(this._skin);if(l$i)this.loadComplete(this._skin,l$i);else{if(l$b.resAtalsObj&&l$b.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=l$f.create(this,this.loadComplete,[this._skin]),this._progress=null,l$M.loader.load(this._skin,this._complete,this._progress)}}},l$i.loadComplete=function(l$i,l$_){if(l$i===this._skin&&l$_){l$t.clearObject(this,this._weakKey);var l$R=this._clipWidth||Math.ceil(l$_.sourceWidth/this._clipX),l$r=this._clipHeight||Math.ceil(l$_.sourceHeight/this._clipY),l$b=this._skin+l$R+l$r,l$z=l$t.findObject(l$b);if(l$Z.isOkTextureList(l$z)||(l$z=null),l$z)this._weakKey=l$b,l$t.keepObject(this,this._weakKey),this._sources=l$z;else{this._sources=[];for(var l$L=0;l$L<this._clipY;l$L++)for(var l$w=0;l$w<this._clipX;l$w++){var l$x=l$l.createFromTexture(l$_,l$R*l$w,l$r*l$L,l$R,l$r);if(l$_.alphaTexture){var l$P=l$_.width/l$_.alphaTexture.width;l$x.alphaTexture=l$l.createFromTexture(l$_.alphaTexture,l$R*l$w/l$P,l$r*l$L/l$P,l$R/l$P,l$r/l$P)}this._sources.push(l$x)}l$t.saveObject(l$b,this._sources),this._weakKey=l$b,l$t.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},l$i.play=function(l$i,l$_){void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=-1),this._isPlaying=!0,this.index=l$i,this._toIndex=l$_,this._index++,l$M.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},l$i._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},l$i.stop=function(){this._isPlaying=!1,l$M.timer.clear(this,this._loop),this.event("complete")},l$i._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},l$L(0,l$i,"interval",function(){return this._interval},function(l$i){this._interval!=l$i&&(this._interval=l$i,this._isPlaying&&this.play())}),l$i.clearEvent=function(){this._skin&&l$b.atalsNotify&&l$b.atalsNotify.off(this._skin,this,this._setBtnSource)},l$i.clearLoad=function(){this._skin&&((this._complete||this._progress)&&l$M.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},l$L(0,l$i,"skin",function(){return this._skin},function(l$i){if(this._skin!=l$i)if(this.clearLoad(),this.clearEvent(),l$t.clearCache(this,this._skin),this._skin=l$i){l$t.keepCache(this,this._skin);var l$_=l$t.getRes(l$i),l$R=l$b.resAtalsObj&&l$b.resAtalsObj[this._skin];!l$_&&l$R?l$b.atalsNotify&&l$b.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),l$i._setBtnSource=function(l$i,l$_){l$i===this._skin&&l$_&&(this.loadComplete(l$i,l$_),this.clearEvent())},l$L(0,l$i,"sources",function(){return this._sources},function(l$i){this._sources=l$i,this.index=this._index,this.event("loaded")}),l$L(0,l$i,"clipX",function(){return this._clipX},function(l$i){this._clipX=l$i||1,this._setClipChanged()}),l$L(0,l$i,"clipY",function(){return this._clipY},function(l$i){this._clipY=l$i||1,this._setClipChanged()}),l$L(0,l$i,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),l$L(0,l$i,"clipWidth",function(){return this._clipWidth},function(l$i){this._clipWidth=l$i,this._setClipChanged()}),l$L(0,l$i,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(l$i){this._bitmap.sizeGrid=l$v.fillArray(l$S.defaultSizeGrid,l$i,Number)}),l$L(0,l$i,"group",function(){return this._group},function(l$i){l$i&&this._skin&&l$t.setGroup(this._skin,l$i),this._group=l$i}),l$L(0,l$i,"clipHeight",function(){return this._clipHeight},function(l$i){this._clipHeight=l$i,this._setClipChanged()}),l$L(0,l$i,"width",l$_.prototype._$get_width,function(l$i){l$M.superSet(l$u,this,"width",l$i),this._bitmap.width=l$i}),l$L(0,l$i,"height",l$_.prototype._$get_height,function(l$i){l$M.superSet(l$u,this,"height",l$i),this._bitmap.height=l$i}),l$L(0,l$i,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),l$L(0,l$i,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),l$L(0,l$i,"index",function(){return this._index},function(l$i){this._index=l$i,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[l$i]),this.event("change")}),l$L(0,l$i,"autoPlay",function(){return this._autoPlay},function(l$i){this._autoPlay!=l$i&&((this._autoPlay=l$i)?this.play():this.stop())}),l$L(0,l$i,"isPlaying",function(){return this._isPlaying},function(l$i){this._isPlaying=l$i}),l$L(0,l$i,"dataSource",l$_.prototype._$get_dataSource,function(l$i){"number"==typeof(this._dataSource=l$i)&&Math.floor(l$i)==l$i||"string"==typeof l$i?this.index=parseInt(l$i):l$M.superSet(l$u,this,"dataSource",l$i)}),l$L(0,l$i,"bitmap",function(){return this._bitmap}),l$r}(l$u),l$O=function(l$_){function l$i(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,l$i.__super.call(this)}l$z(l$i,"laya.ui.ColorPicker",l$_);var l$R=l$i.prototype;return l$R.destroy=function(l$i){void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,l$i),this._colorPanel&&this._colorPanel.destroy(l$i),this._colorButton&&this._colorButton.destroy(l$i),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},l$R.createChildren=function(){this.addChild(this._colorButton=new l$k),this._colorPanel=new l$p,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new l$e),this._colorPanel.addChild(this._colorBlock=new l$e),this._colorPanel.addChild(this._colorInput=new l$J)},l$R.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},l$R.onPanelMouseDown=function(l$i){l$i.stopPropagation()},l$R.changePanel=function(){this._panelChanged=!1;var l$i=this._colorPanel.graphics;l$i.clear(),l$i.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(l$i=this._colorTiles.graphics).clear();for(var l$_=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],l$R=0;l$R<12;l$R++)for(var l$r=0;l$r<20;l$r++){var l$b=0;l$b=0===l$r?l$_[l$R]:1===l$r?0:51*(((3*l$R+l$r/6)%3<<0)+3*(l$R/6<<0))<<16|l$r%6*51<<8|(l$R<<0)%6*51;var l$z=l$v.toColor(l$b);this._colors.push(l$z);var l$L=l$r*this._gridSize,l$w=l$R*this._gridSize;l$i.drawRect(l$L,l$w,this._gridSize,this._gridSize,l$z,"#000000")}},l$R.onColorButtonClick=function(l$i){this._colorPanel.parent?this.close():this.open()},l$R.open=function(){var l$i=this.localToGlobal(new l$h),l$_=l$i.x+this._colorPanel.width<=l$M.stage.width?l$i.x:l$M.stage.width-this._colorPanel.width,l$R=l$i.y+this._colorButton.height;l$R=l$R+this._colorPanel.height<=l$M.stage.height?l$R:l$i.y-this._colorPanel.height,this._colorPanel.pos(l$_,l$R),this._colorPanel.zOrder=1001,l$M._currentStage.addChild(this._colorPanel),l$M.stage.on("mousedown",this,this.removeColorBox)},l$R.close=function(){l$M.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},l$R.removeColorBox=function(l$i){this.close()},l$R.onColorFieldKeyDown=function(l$i){13==l$i.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),l$i.stopPropagation())},l$R.onColorInputChange=function(l$i){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},l$R.onColorTilesClick=function(l$i){this.selectedColor=this.getColorByMouse(),this.close()},l$R.onColorTilesMouseMove=function(l$i){this._colorInput.focus=!1;var l$_=this.getColorByMouse();this._colorInput.text=l$_,this.drawBlock(l$_)},l$R.getColorByMouse=function(){var l$i=this._colorTiles.getMousePoint(),l$_=Math.floor(l$i.x/this._gridSize),l$R=Math.floor(l$i.y/this._gridSize);return this._colors[20*l$R+l$_]},l$R.drawBlock=function(l$i){var l$_=this._colorBlock.graphics;l$_.clear();var l$R=l$i||"#ffffff";l$_.drawRect(0,0,50,20,l$R,this._borderColor),l$i||l$_.drawLine(0,0,50,20,"#ff0000")},l$R.changeColor=function(){var l$i=this.graphics;l$i.clear();var l$_=this._selectedColor||"#000000";l$i.drawRect(0,0,this._colorButton.width,this._colorButton.height,l$_)},l$R._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},l$L(0,l$R,"inputBgColor",function(){return this._inputBgColor},function(l$i){this._inputBgColor=l$i,this._setPanelChanged()}),l$L(0,l$R,"selectedColor",function(){return this._selectedColor},function(l$i){this._selectedColor!=l$i&&(this._selectedColor=this._colorInput.text=l$i,this.drawBlock(l$i),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",l$P.EMPTY.setTo("change",this,this)))}),l$L(0,l$R,"skin",function(){return this._colorButton.skin},function(l$i){this._colorButton.skin=l$i,this.changeColor()}),l$L(0,l$R,"bgColor",function(){return this._bgColor},function(l$i){this._bgColor=l$i,this._setPanelChanged()}),l$L(0,l$R,"borderColor",function(){return this._borderColor},function(l$i){this._borderColor=l$i,this._setPanelChanged()}),l$L(0,l$R,"inputColor",function(){return this._inputColor},function(l$i){this._inputColor=l$i,this._setPanelChanged()}),l$i}(l$u),l$E=function(l$_){function l$R(l$i,l$_){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,l$R.__super.call(this),this._itemColors=l$S.comboBoxItemColors,this.skin=l$i,this.labels=l$_}l$z(l$R,"laya.ui.ComboBox",l$_);var l$i=l$R.prototype;return l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,l$i),this._button&&this._button.destroy(l$i),this._list&&this._list.destroy(l$i),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},l$i.createChildren=function(){this.addChild(this._button=new l$k),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},l$i._createList=function(){this._list=new l$a,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},l$i._setListEvent=function(l$i){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=l$f.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},l$i.onListDown=function(l$i){l$i.stopPropagation()},l$i.onScrollBarDown=function(l$i){l$i.stopPropagation()},l$i.onButtonMouseDown=function(l$i){this.callLater(this.switchTo,[!this._isOpen])},l$i.changeList=function(){this._listChanged=!1;var l$i=this.width-2,l$_=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:l$i,height:this._itemHeight,fontSize:this._itemSize,color:l$_}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},l$i.onlistItemMouse=function(l$i,l$_){var l$R=l$i.type;if("mouseover"===l$R||"mouseout"===l$R){if(this._isCustomList)return;var l$r=this._list.getCell(l$_);if(!l$r)return;var l$b=l$r.getChildByName("label");l$b&&("mouseover"===l$R?(l$b.bgColor=this._itemColors[0],l$b.color=this._itemColors[1]):(l$b.bgColor=null,l$b.color=this._itemColors[2]))}else"click"===l$R&&(this.selectedIndex=l$_,this.isOpen=!1)},l$i.switchTo=function(l$i){this.isOpen=l$i},l$i.changeOpen=function(){this.isOpen=!this._isOpen},l$i.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var l$i=this._list.graphics;l$i.clear(),l$i.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var l$_=this._list.array||[],l$R=l$_.length=0,l$r=this._labels.length;l$R<l$r;l$R++)l$_.push({label:this._labels[l$R]});this._list.height=this._listHeight,this._list.array=l$_},l$i.changeSelected=function(){this._button.label=this.selectedLabel},l$i._onStageMouseWheel=function(l$i){this._list&&!this._list.contains(l$i.target)&&this.removeList(null)},l$i.removeList=function(l$i){l$M.stage.off("mousedown",this,this.removeList),l$M.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},l$L(0,l$i,"selectedIndex",function(){return this._selectedIndex},function(l$i){this._selectedIndex!=l$i&&(this._selectedIndex=l$i,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[l$P.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),l$L(0,l$i,"measureHeight",function(){return this._button.height}),l$L(0,l$i,"skin",function(){return this._button.skin},function(l$i){this._button.skin!=l$i&&(this._button.skin=l$i,this._listChanged=!0)}),l$L(0,l$i,"measureWidth",function(){return this._button.width}),l$L(0,l$i,"width",l$_.prototype._$get_width,function(l$i){l$M.superSet(l$u,this,"width",l$i),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),l$L(0,l$i,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(l$i){this.selectedIndex=this._labels.indexOf(l$i)}),l$L(0,l$i,"labels",function(){return this._labels.join(",")},function(l$i){0<this._labels.length&&(this.selectedIndex=-1),l$i?this._labels=l$i.split(","):this._labels.length=0,this._itemChanged=!0}),l$L(0,l$i,"height",l$_.prototype._$get_height,function(l$i){l$M.superSet(l$u,this,"height",l$i),this._button.height=this._height}),l$L(0,l$i,"selectHandler",function(){return this._selectHandler},function(l$i){this._selectHandler=l$i}),l$L(0,l$i,"visibleNum",function(){return this._visibleNum},function(l$i){this._visibleNum=l$i,this._listChanged=!0}),l$L(0,l$i,"labelBold",function(){return this._button.text.bold},function(l$i){this._button.text.bold=l$i}),l$L(0,l$i,"itemColors",function(){return String(this._itemColors)},function(l$i){this._itemColors=l$v.fillArray(this._itemColors,l$i,String),this._listChanged=!0}),l$L(0,l$i,"itemSize",function(){return this._itemSize},function(l$i){this._itemSize=l$i,this._listChanged=!0}),l$L(0,l$i,"scrollBar",function(){return this.list.scrollBar}),l$L(0,l$i,"isOpen",function(){return this._isOpen},function(l$i){if(this._isOpen!=l$i)if(this._isOpen=l$i,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var l$_=this.localToGlobal(l$h.TEMP.setTo(0,0)),l$R=l$_.y+this._button.height;l$R=l$R+this._listHeight<=l$M.stage.height?l$R:l$_.y-this._listHeight,this._list.pos(l$_.x,l$R),this._list.zOrder=1001,l$M._currentStage.addChild(this._list),l$M.stage.once("mousedown",this,this.removeList),l$M.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),l$L(0,l$i,"scrollBarSkin",function(){return this._scrollBarSkin},function(l$i){this._scrollBarSkin=l$i}),l$L(0,l$i,"sizeGrid",function(){return this._button.sizeGrid},function(l$i){this._button.sizeGrid=l$i}),l$L(0,l$i,"button",function(){return this._button}),l$L(0,l$i,"list",function(){return this._list||this._createList(),this._list},function(l$i){l$i&&(l$i.removeSelf(),this._isCustomList=!0,this._list=l$i,this._setListEvent(l$i),this._itemHeight=l$i.getCell(0).height+l$i.spaceY)}),l$L(0,l$i,"dataSource",l$_.prototype._$get_dataSource,function(l$i){"number"==typeof(this._dataSource=l$i)&&Math.floor(l$i)==l$i||"string"==typeof l$i?this.selectedIndex=parseInt(l$i):l$i instanceof Array?this.labels=l$i.join(","):l$M.superSet(l$u,this,"dataSource",l$i)}),l$L(0,l$i,"labelColors",function(){return this._button.labelColors},function(l$i){this._button.labelColors!=l$i&&(this._button.labelColors=l$i)}),l$L(0,l$i,"labelPadding",function(){return this._button.text.padding.join(",")},function(l$i){this._button.text.padding=l$v.fillArray(l$S.labelPadding,l$i,Number)}),l$L(0,l$i,"labelSize",function(){return this._button.text.fontSize},function(l$i){this._button.text.fontSize=l$i}),l$L(0,l$i,"labelFont",function(){return this._button.text.font},function(l$i){this._button.text.font=l$i}),l$L(0,l$i,"stateNum",function(){return this._button.stateNum},function(l$i){this._button.stateNum=l$i}),l$R}(l$u),l$s=function(l$_){function l$R(l$i){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,l$R.__super.call(this),this._showButtons=l$$.showButtons,this._touchScrollEnable=l$$.touchScrollEnable,this._mouseWheelEnable=l$$.mouseWheelEnable,this.skin=l$i,this.max=1}l$z(l$R,"laya.ui.ScrollBar",l$_);var l$i=l$R.prototype;return l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),this.stopScroll(),this.target=null,l$_.prototype.destroy.call(this,l$i),this.upButton&&this.upButton.destroy(l$i),this.downButton&&this.downButton.destroy(l$i),this.slider&&this.slider.destroy(l$i),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},l$i.createChildren=function(){this.addChild(this.slider=new l$Y),this.addChild(this.upButton=new l$k),this.addChild(this.downButton=new l$k)},l$i.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},l$i.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},l$i.onButtonMouseDown=function(l$i){var l$_=l$i.currentTarget===this.upButton;this.slide(l$_),l$M.timer.once(l$S.scrollBarDelayTime,this,this.startLoop,[l$_]),l$M.stage.once("mouseup",this,this.onStageMouseUp)},l$i.startLoop=function(l$i){l$M.timer.frameLoop(1,this,this.slide,[l$i])},l$i.slide=function(l$i){l$i?this.value-=this._scrollSize:this.value+=this._scrollSize},l$i.onStageMouseUp=function(l$i){l$M.timer.clear(this,this.startLoop),l$M.timer.clear(this,this.slide)},l$i.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},l$i.changeSize=function(){l$_.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},l$i.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},l$i.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},l$i.setScroll=function(l$i,l$_,l$R){this.runCallLater(this.changeSize),this.slider.setSlider(l$i,l$_,l$R),this.slider.bar.visible=0<l$_,!this._hide&&this.autoHide&&(this.visible=!1)},l$i.onTargetMouseWheel=function(l$i){this.value-=l$i.delta*this._scrollSize,this.target=this._target},l$i.onTargetMouseDown=function(l$i){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new l$h),this._lastPoint.setTo(l$M.stage.mouseX,l$M.stage.mouseY),l$M.timer.clear(this,this.tweenMove),l$A.clearTween(this),l$M.stage.once("mouseup",this,this.onStageMouseUp2),l$M.stage.once("mouseout",this,this.onStageMouseUp2),l$M.timer.frameLoop(1,this,this.loop)},l$i.loop=function(){var l$i=l$M.stage.mouseY,l$_=l$M.stage.mouseX;if(this._lastOffset=this.isVertical?l$i-this._lastPoint.y:l$_-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?l$M.stage._canvasTransform.getScaleY():l$M.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=l$_,this._lastPoint.y=l$i,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},l$i.onStageMouseUp2=function(l$i){if(l$M.stage.off("mouseup",this,this.onStageMouseUp2),l$M.stage.off("mouseout",this,this.onStageMouseUp2),l$M.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?l$A.to(this,{value:this.min},this.elasticBackTime,l$x.sineOut,l$f.create(this,this.elasticOver)):this._value>this.max&&l$A.to(this,{value:this.max},this.elasticBackTime,l$x.sineOut,l$f.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?l$M.stage.mouseY-this._lastPoint.y:l$M.stage.mouseX-this._lastPoint.x);for(var l$_=0,l$R=Math.min(this._offsets.length,3),l$r=0;l$r<l$R;l$r++)l$_+=this._offsets[this._offsets.length-1-l$r];if(this._lastOffset=l$_/l$R,(l$_=Math.abs(this._lastOffset))<2)return void this.event("end");60<l$_&&(this._lastOffset=0<this._lastOffset?60:-60);var l$b=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));l$M.timer.frameLoop(1,this,this.tweenMove,[l$b])}},l$i.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&l$A.to(this,{alpha:0},500),this.event("end")},l$i.tweenMove=function(l$i){this._lastOffset*=this.rollRatio;var l$_=NaN;if(0<l$i&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,l$_=.5*-(this.min-l$i-this.value),this._lastOffset>l$_&&(this._lastOffset=l$_)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,l$_=.5*-(this.max+l$i-this.value),this._lastOffset<l$_&&(this._lastOffset=l$_))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(l$M.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?l$A.to(this,{value:this.min},this.elasticBackTime,l$x.sineOut,l$f.create(this,this.elasticOver)):this._value>this.max?l$A.to(this,{value:this.max},this.elasticBackTime,l$x.sineOut,l$f.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&l$A.to(this,{alpha:0},500)}},l$i.stopScroll=function(){this.onStageMouseUp2(null),l$M.timer.clear(this,this.tweenMove),l$A.clearTween(this)},l$L(0,l$i,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),l$L(0,l$i,"skin",function(){return this._skin},function(l$i){this._skin!=l$i&&(this._skin=l$i,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),l$L(0,l$i,"max",function(){return this.slider.max},function(l$i){this.slider.max=l$i}),l$L(0,l$i,"showButtons",function(){return this._showButtons},function(l$i){this._showButtons=l$i,this.callLater(this.changeScrollBar)}),l$L(0,l$i,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),l$L(0,l$i,"min",function(){return this.slider.min},function(l$i){this.slider.min=l$i}),l$L(0,l$i,"value",function(){return this._value},function(l$i){l$i!==this._value&&(this._value=l$i,this._isElastic||(this.slider._value!=l$i&&(this.slider._value=l$i,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),l$L(0,l$i,"isVertical",function(){return this.slider.isVertical},function(l$i){this.slider.isVertical=l$i}),l$L(0,l$i,"sizeGrid",function(){return this.slider.sizeGrid},function(l$i){this.slider.sizeGrid=l$i}),l$L(0,l$i,"scrollSize",function(){return this._scrollSize},function(l$i){this._scrollSize=l$i}),l$L(0,l$i,"dataSource",l$_.prototype._$get_dataSource,function(l$i){"number"==typeof(this._dataSource=l$i)||"string"==typeof l$i?this.value=Number(l$i):l$M.superSet(l$u,this,"dataSource",l$i)}),l$L(0,l$i,"thumbPercent",function(){return this._thumbPercent},function(l$i){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),l$i=1<=l$i?.99:l$i,this._thumbPercent=l$i,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*l$i,l$S.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*l$i,l$S.scrollBarMinNum))}),l$L(0,l$i,"target",function(){return this._target},function(l$i){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=l$i)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),l$L(0,l$i,"hide",function(){return this._hide},function(l$i){this._hide=l$i,this.visible=!l$i}),l$L(0,l$i,"touchScrollEnable",function(){return this._touchScrollEnable},function(l$i){this._touchScrollEnable=l$i,this.target=this._target}),l$L(0,l$i,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(l$i){this._mouseWheelEnable=l$i,this.target=this._target}),l$L(0,l$i,"tick",function(){return this.slider.tick},function(l$i){this.slider.tick=l$i}),l$R}(l$u),l$Y=function(l$_){function l$R(l$i){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,l$R.__super.call(this),this.skin=l$i}l$z(l$R,"laya.ui.Slider",l$_);var l$i=l$R.prototype;return l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,l$i),this._bg&&this._bg.destroy(l$i),this._bar&&this._bar.destroy(l$i),this._progress&&this._progress.destroy(l$i),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},l$i.createChildren=function(){this.addChild(this._bg=new l$C),this.addChild(this._bar=new l$k)},l$i.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},l$i.onBarMouseDown=function(l$i){this._globalSacle||(this._globalSacle=new l$h),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=l$M.stage.mouseX,this._ty=l$M.stage.mouseY,l$M.stage.on("mousemove",this,this.mouseMove),l$M.stage.once("mouseup",this,this.mouseUp),l$M.stage.once("mouseout",this,this.mouseUp),this.showValueText()},l$i.showValueText=function(){if(this.showLabel){var l$i=laya.ui.Slider.label;this.addChild(l$i),l$i.textField.changeText(this._value+""),this.isVertical?(l$i.x=this._bar.x+20,l$i.y=.5*(this._bar.height-l$i.height)+this._bar.y):(l$i.y=this._bar.y-20,l$i.x=.5*(this._bar.width-l$i.width)+this._bar.x)}},l$i.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},l$i.mouseUp=function(l$i){l$M.stage.off("mousemove",this,this.mouseMove),l$M.stage.off("mouseup",this,this.mouseUp),l$M.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},l$i.mouseMove=function(l$i){var l$_=this._value;this.isVertical?(this._bar.y+=(l$M.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(l$M.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=l$M.stage.mouseX,this._ty=l$M.stage.mouseY;var l$R=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*l$R)/l$R,this._value!=l$_&&this.sendChangeEvent(),this.showValueText()},l$i.sendChangeEvent=function(l$i){void 0===l$i&&(l$i="change"),this.event(l$i),this.changeHandler&&this.changeHandler.runWith(this._value)},l$i.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},l$i.changeSize=function(){l$_.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},l$i.setSlider=function(l$i,l$_,l$R){this._value=-1,this._min=l$i,this._max=l$i<l$_?l$_:l$i,this.value=l$R<l$i?l$i:l$_<l$R?l$_:l$R},l$i.changeValue=function(){var l$i=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*l$i)/l$i,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var l$_=this._max-this._min;0===l$_&&(l$_=1),this.isVertical?(this._bar.y=(this._value-this._min)/l$_*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/l$_*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},l$i.onBgMouseDown=function(l$i){var l$_=this._bg.getMousePoint();this.isVertical?this.value=l$_.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=l$_.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},l$L(0,l$i,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),l$L(0,l$i,"skin",function(){return this._skin},function(l$i){if(this._skin!=l$i){this._skin=l$i,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var l$_=this._skin.replace(".png","$progress.png");l$t.getRes(l$_)&&(this._progress||(this.addChild(this._progress=new l$C),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=l$_),this.setBarPoint(),this.callLater(this.changeValue)}}),l$L(0,l$i,"allowClickBack",function(){return this._allowClickBack},function(l$i){this._allowClickBack!=l$i&&((this._allowClickBack=l$i)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),l$L(0,l$i,"max",function(){return this._max},function(l$i){this._max!=l$i&&(this._max=l$i,this.callLater(this.changeValue))}),l$L(0,l$i,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),l$L(0,l$i,"tick",function(){return this._tick},function(l$i){this._tick!=l$i&&(this._tick=l$i,this.callLater(this.changeValue))}),l$L(0,l$i,"sizeGrid",function(){return this._bg.sizeGrid},function(l$i){this._bg.sizeGrid=l$i,this._bar.sizeGrid=l$i,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),l$L(0,l$i,"min",function(){return this._min},function(l$i){this._min!=l$i&&(this._min=l$i,this.callLater(this.changeValue))}),l$L(0,l$i,"value",function(){return this._value},function(l$i){if(this._value!=l$i){var l$_=this._value;this._value=l$i,this.changeValue(),this._value!=l$_&&this.sendChangeEvent()}}),l$L(0,l$i,"dataSource",l$_.prototype._$get_dataSource,function(l$i){"number"==typeof(this._dataSource=l$i)||"string"==typeof l$i?this.value=Number(l$i):l$M.superSet(l$u,this,"dataSource",l$i)}),l$L(0,l$i,"bar",function(){return this._bar}),l$r(l$R,["label",function(){return this.label=new l$m}]),l$R}(l$u),l$C=function(l$_){function l$R(l$i){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,l$R.__super.call(this),this.skin=l$i}l$z(l$R,"laya.ui.Image",l$_);var l$i=l$R.prototype;return l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,l$t.clearCache(this,this._skin)},l$i.dispose=function(){this.destroy(!0),l$t.clearCache(this,this._skin),this.clearEvent()},l$i.createChildren=function(){this.graphics=this._bitmap=new l$G},l$i.setSource=function(l$i,l$_){l$i===this._skin&&l$_&&(this.source=l$_,this.onCompResize(),this.clearEvent())},l$i.clearEvent=function(){this._skin&&l$b.atalsNotify&&l$b.atalsNotify.off(this._skin,this,this.setSource)},l$i.clearLoad=function(){this._skin&&((this._complete||this._progress)&&l$M.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},l$L(0,l$i,"source",function(){return this._bitmap.source},function(l$i){this._bitmap&&(this._bitmap.source=l$i,this.event("loaded"),this.repaint())}),l$L(0,l$i,"dataSource",l$_.prototype._$get_dataSource,function(l$i){"string"==typeof(this._dataSource=l$i)?this.skin=l$i:l$M.superSet(l$u,this,"dataSource",l$i)}),l$L(0,l$i,"measureHeight",function(){return this._bitmap.height}),l$L(0,l$i,"skin",function(){return this._skin},function(l$i){if(this._skin!=l$i)if(l$t.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=l$i){l$t.keepCache(this,this._skin);var l$_=l$t.getRes(l$i),l$R=l$b.resAtalsObj&&l$b.resAtalsObj[this._skin];l$_?(this.source=l$_,this.onCompResize()):l$R?(l$b.atalsNotify&&l$b.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=l$R.sourceW),0==this.height&&(this.height=l$R.sourceH)):(this._complete=l$f.create(this,this.setSource,[this._skin]),this._progress=null,l$M.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),l$L(0,l$i,"group",function(){return this._group},function(l$i){l$i&&this._skin&&l$t.setGroup(this._skin,l$i),this._group=l$i}),l$L(0,l$i,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(l$i){this._bitmap.sizeGrid=l$v.fillArray(l$S.defaultSizeGrid,l$i,Number)}),l$L(0,l$i,"measureWidth",function(){return this._bitmap.width}),l$L(0,l$i,"width",l$_.prototype._$get_width,function(l$i){l$M.superSet(l$u,this,"width",l$i),this._bitmap.width=0==l$i?1e-7:l$i}),l$L(0,l$i,"height",l$_.prototype._$get_height,function(l$i){l$M.superSet(l$u,this,"height",l$i),this._bitmap.height=0==l$i?1e-7:l$i}),l$R}(l$u),l$m=function(l$_){function l$R(l$i){this._tf=null,l$R.__super.call(this),void 0===l$i&&(l$i=""),l$B.defaultColor=l$S.labelColor,this.text=l$i}l$z(l$R,"laya.ui.Label",l$_);var l$i=l$R.prototype;return l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,l$i),this._tf=null},l$i.createChildren=function(){this.addChild(this._tf=new l$c)},l$i.changeText=function(l$i){this._tf.changeText(l$i)},l$L(0,l$i,"padding",function(){return this._tf.padding.join(",")},function(l$i){this._tf.padding=l$v.fillArray(l$S.labelPadding,l$i,Number)}),l$L(0,l$i,"bold",function(){return this._tf.bold},function(l$i){this._tf.bold=l$i}),l$L(0,l$i,"align",function(){return this._tf.align},function(l$i){this._tf.align=l$i}),l$L(0,l$i,"text",function(){return this._tf.text},function(l$i){this._tf.text!=l$i&&(l$i&&(l$i=l$v.adptString(l$i+"")),this._tf.text=l$i,this.event("change"),this._width&&this._height||this.onCompResize())}),l$L(0,l$i,"italic",function(){return this._tf.italic},function(l$i){this._tf.italic=l$i}),l$L(0,l$i,"wordWrap",function(){return this._tf.wordWrap},function(l$i){this._tf.wordWrap=l$i}),l$L(0,l$i,"font",function(){return this._tf.font},function(l$i){this._tf.font=l$i}),l$L(0,l$i,"dataSource",l$_.prototype._$get_dataSource,function(l$i){"number"==typeof(this._dataSource=l$i)||"string"==typeof l$i?this.text=l$i+"":l$M.superSet(l$u,this,"dataSource",l$i)}),l$L(0,l$i,"color",function(){return this._tf.color},function(l$i){this._tf.color=l$i}),l$L(0,l$i,"valign",function(){return this._tf.valign},function(l$i){this._tf.valign=l$i}),l$L(0,l$i,"leading",function(){return this._tf.leading},function(l$i){this._tf.leading=l$i}),l$L(0,l$i,"fontSize",function(){return this._tf.fontSize},function(l$i){this._tf.fontSize=l$i}),l$L(0,l$i,"bgColor",function(){return this._tf.bgColor},function(l$i){this._tf.bgColor=l$i}),l$L(0,l$i,"borderColor",function(){return this._tf.borderColor},function(l$i){this._tf.borderColor=l$i}),l$L(0,l$i,"stroke",function(){return this._tf.stroke},function(l$i){this._tf.stroke=l$i}),l$L(0,l$i,"strokeColor",function(){return this._tf.strokeColor},function(l$i){this._tf.strokeColor=l$i}),l$L(0,l$i,"textField",function(){return this._tf}),l$L(0,l$i,"measureWidth",function(){return this._tf.width}),l$L(0,l$i,"measureHeight",function(){return this._tf.height}),l$L(0,l$i,"width",function(){return this._width||this._tf.text?l$M.superGet(l$u,this,"width"):0},function(l$i){l$M.superSet(l$u,this,"width",l$i),this._tf.width=l$i}),l$L(0,l$i,"height",function(){return this._height||this._tf.text?l$M.superGet(l$u,this,"height"):0},function(l$i){l$M.superSet(l$u,this,"height",l$i),this._tf.height=l$i}),l$L(0,l$i,"overflow",function(){return this._tf.overflow},function(l$i){this._tf.overflow=l$i}),l$L(0,l$i,"underline",function(){return this._tf.underline},function(l$i){this._tf.underline=l$i}),l$L(0,l$i,"underlineColor",function(){return this._tf.underlineColor},function(l$i){this._tf.underlineColor=l$i}),l$R}(l$u),l$D=function(l$_){function l$R(l$i){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,l$R.__super.call(this),this.skin=l$i}l$z(l$R,"laya.ui.ProgressBar",l$_);var l$i=l$R.prototype;return l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,l$i),this._bg&&this._bg.destroy(l$i),this._bar&&this._bar.destroy(l$i),this._bg=this._bar=null,this.changeHandler=null},l$i.createChildren=function(){this.addChild(this._bg=new l$C),this.addChild(this._bar=new l$C)},l$i.changeValue=function(){if(this.sizeGrid){var l$i=this.sizeGrid.split(","),l$_=Number(l$i[3]),l$R=Number(l$i[1]),l$r=(this.width-l$_-l$R)*this._value;this._bar.width=l$_+l$R+l$r,this._bar.visible=this._bar.width>l$_+l$R}else this._bar.width=this.width*this._value},l$L(0,l$i,"measureHeight",function(){return this._bg.height}),l$L(0,l$i,"skin",function(){return this._skin},function(l$i){this._skin!=l$i&&(this._skin=l$i,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),l$L(0,l$i,"measureWidth",function(){return this._bg.width}),l$L(0,l$i,"height",l$_.prototype._$get_height,function(l$i){l$M.superSet(l$u,this,"height",l$i),this._bg.height=this._height,this._bar.height=this._height}),l$L(0,l$i,"bar",function(){return this._bar}),l$L(0,l$i,"value",function(){return this._value},function(l$i){this._value!=l$i&&(l$i=1<l$i?1:l$i<0?0:l$i,this._value=l$i,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(l$i))}),l$L(0,l$i,"bg",function(){return this._bg}),l$L(0,l$i,"sizeGrid",function(){return this._bg.sizeGrid},function(l$i){this._bg.sizeGrid=this._bar.sizeGrid=l$i}),l$L(0,l$i,"width",l$_.prototype._$get_width,function(l$i){l$M.superSet(l$u,this,"width",l$i),this._bg.width=this._width,this.callLater(this.changeValue)}),l$L(0,l$i,"dataSource",l$_.prototype._$get_dataSource,function(l$i){"number"==typeof(this._dataSource=l$i)||"string"==typeof l$i?this.value=Number(l$i):l$M.superSet(l$u,this,"dataSource",l$i)}),l$R}(l$u),l$U=(function(l$i){function l$R(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,l$R.__super.call(this),this._tipBox=new l$u,this._tipBox.addChild(this._tipText=new l$c),this._tipText.x=this._tipText.y=5,this._tipText.color=l$R.tipTextColor,this._defaultTipHandler=this._showDefaultTip,l$M.stage.on("showtip",this,this._onStageShowTip),l$M.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}l$z(l$R,"laya.ui.TipManager",l$u);var l$_=l$R.prototype;l$_._onStageHideTip=function(l$i){l$M.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},l$_._onStageShowTip=function(l$i){l$M.timer.once(l$R.tipDelay,this,this._showTip,[l$i],!0)},l$_._showTip=function(l$i){if("string"==typeof l$i){var l$_=String(l$i);Boolean(l$_)&&this._defaultTipHandler(l$_)}else l$i instanceof laya.utils.Handler?l$i.run():"function"==typeof l$i&&l$i.apply();l$M.stage.on("mousemove",this,this._onStageMouseMove),l$M.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},l$_._onStageMouseDown=function(l$i){this.closeAll()},l$_._onStageMouseMove=function(l$i){this._showToStage(this,l$R.offsetX,l$R.offsetY)},l$_._showToStage=function(l$i,l$_,l$R){void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0);var l$r=l$i.getBounds();l$i.x=l$M.stage.mouseX+l$_,l$i.y=l$M.stage.mouseY+l$R,l$i.x+l$r.width>l$M.stage.width&&(l$i.x-=l$r.width+l$_),l$i.y+l$r.height>l$M.stage.height&&(l$i.y-=l$r.height+l$R)},l$_.closeAll=function(){l$M.timer.clear(this,this._showTip),l$M.stage.off("mousemove",this,this._onStageMouseMove),l$M.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},l$_.showDislayTip=function(l$i){this.addChild(l$i),this._showToStage(this),l$M._currentStage.addChild(this)},l$_._showDefaultTip=function(l$i){this._tipText.text=l$i;var l$_=this._tipBox.graphics;l$_.clear(),l$_.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,l$R.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),l$M._currentStage.addChild(this)},l$L(0,l$_,"defaultTipHandler",function(){return this._defaultTipHandler},function(l$i){this._defaultTipHandler=l$i}),l$R.offsetX=10,l$R.offsetY=15,l$R.tipTextColor="#ffffff",l$R.tipBackColor="#111111",l$R.tipDelay=200}(),function(l$i){var l$J;function l$h(){this._idMap=null,this._aniList=null,this._watchMap={},l$h.__super.call(this)}l$z(l$h,"laya.ui.View",l$p);var l$_=l$h.prototype;return l$_.createView=function(l$i){if(l$i.animations&&!this._idMap&&(this._idMap={}),l$h.createComp(l$i,this,this),l$i.animations){var l$_,l$R,l$r=[],l$b=l$i.animations,l$z=0,l$L=l$b.length;for(l$z=0;l$z<l$L;l$z++){switch(l$_=new l$n,l$R=l$b[l$z],l$_._setUp(this._idMap,l$R),(this[l$R.name]=l$_)._setControlNode(this),l$R.action){case 1:l$_.play(0,!1);break;case 2:l$_.play(0,!0)}l$r.push(l$_)}this._aniList=l$r}0<this._width&&null==l$i.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},l$_.onEvent=function(l$i,l$_){},l$_.loadUI=function(l$i){var l$_=l$h.uiMap[l$i];l$_&&this.createView(l$_)},l$_.destroy=function(l$i){void 0===l$i&&(l$i=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,l$i)},l$_.changeData=function(l$i){var l$_=this._watchMap[l$i];if(l$_){console.log("change",l$i);for(var l$R=0,l$r=l$_.length;l$R<l$r;l$R++){l$_[l$R].exe(this)}}},l$h._regs=function(){for(var l$i in l$h.uiClassMap)l$N.regClass(l$i,l$h.uiClassMap[l$i])},l$h.createComp=function(l$i,l$_,l$R,l$r){if(!(l$_=l$_||l$h.getCompInstance(l$i)))return console.warn("can not create:"+l$i.type),null;var l$b=l$i.child;if(l$b)for(var l$z=l$_ instanceof laya.ui.List,l$L=0,l$w=l$b.length;l$L<l$w;l$L++){var l$x=l$b[l$L];if(!l$_.hasOwnProperty("itemRender")||"render"!=l$x.props.name&&"render"!==l$x.props.renderType)if("Graphic"==l$x.type)l$N.addGraphicsToSprite(l$x,l$_);else if(l$N.isDrawType(l$x.type))l$N.addGraphicToSprite(l$x,l$_,!0);else{if(l$z){var l$P=[],l$B=l$h.createComp(l$x,null,l$R,l$P);l$P.length&&(l$B._$bindData=l$P)}else l$B=l$h.createComp(l$x,null,l$R,l$r);"Script"==l$x.type?"owner"in l$B?l$B.owner=l$_:"target"in l$B&&(l$B.target=l$_):"mask"==l$x.props.renderType||"mask"==l$x.props.name?l$_.mask=l$B:l$B instanceof laya.display.Sprite&&l$_.addChild(l$B)}else l$_.itemRender=l$x}var l$n=l$i.props;for(var l$f in l$n){var l$J=l$n[l$f];l$h.eventDic[l$f]?l$J&&l$R&&l$_.on(l$f,l$R,l$R.onEvent,[l$J]):l$h.setCompValue(l$_,l$f,l$J,l$R,l$r)}return l$M.__typeof(l$_,"laya.ui.IItem")&&l$_.initItems(),l$i.compId&&l$R&&l$R._idMap&&(l$R._idMap[l$i.compId]=l$_),l$_},l$h.setCompValue=function(l$i,l$_,l$R,l$r,l$b){if("string"==typeof l$R&&-1<l$R.indexOf("${")){if(l$h._sheet||(l$h._sheet=l$N.getClass("laya.data.Table")),!l$h._sheet)return void console.warn("Can not find class Sheet");if(l$b)l$b.push(l$i,l$_,l$R);else if(l$r){-1==l$R.indexOf("].")&&(l$R=l$R.replace(".","[0]."));var l$z,l$L,l$w=new l$J(l$i,l$_,l$R);l$w.exe(l$r);for(var l$x=l$R.replace(/\[.*?\]\./g,".");null!=(l$z=l$h._parseWatchData.exec(l$x));){for(var l$P=l$z[1];null!=(l$L=l$h._parseKeyWord.exec(l$P));){var l$B=l$L[0],l$n=l$r._watchMap[l$B]||(l$r._watchMap[l$B]=[]);l$n.push(l$w),l$h._sheet.I.notifer.on(l$B,l$r,l$r.changeData,[l$B])}(l$n=l$r._watchMap[l$P]||(l$r._watchMap[l$P]=[])).push(l$w),l$h._sheet.I.notifer.on(l$P,l$r,l$r.changeData,[l$P])}}}else if("var"===l$_&&l$r)l$r[l$R]=l$i;else if("onClick"==l$_){var l$f=l$M._runScript("(function(){"+l$R+"})");l$i.on("click",l$r,l$f)}else l$i[l$_]="true"===l$R||"false"!==l$R&&l$R},l$h.getCompInstance=function(l$i){var l$_,l$R=l$i.props?l$i.props.runtime:null;return l$_=l$R?l$h.viewClassMap[l$R]||l$h.uiClassMap[l$R]||l$M.__classmap[l$R]:l$h.uiClassMap[l$i.type],l$i.props&&l$i.props.hasOwnProperty("renderType")&&"instance"==l$i.props.renderType?l$_.instance:l$_?new l$_:null},l$h.regComponent=function(l$i,l$_){l$h.uiClassMap[l$i]=l$_,l$N.regClass(l$i,l$_)},l$h.regViewRuntime=function(l$i,l$_){l$h.viewClassMap[l$i]=l$_},l$h.uiMap={},l$h.viewClassMap={},l$h._sheet=null,l$r(l$h,["uiClassMap",function(){return this.uiClassMap={ViewStack:l$ii,LinkButton:l$k,TextArea:l$Pi,ColorPicker:l$O,Box:l$p,Button:l$k,CheckBox:l$g,Clip:l$K,ComboBox:l$E,Component:l$u,HScrollBar:l$F,HSlider:l$Q,Image:l$C,Label:l$m,List:l$a,Panel:l$d,ProgressBar:l$D,Radio:l$W,RadioGroup:l$wi,ScrollBar:l$s,Slider:l$Y,Tab:l$xi,TextInput:l$Ri,View:l$h,VScrollBar:l$_i,VSlider:l$ri,Tree:l$T,HBox:l$zi,VBox:l$Li,Sprite:l$e,Animation:l$R,Text:l$c,FontClip:l$y}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),l$h.__init$=function(){l$h._regs(),l$J=function(){function l$i(l$i,l$_,l$R){this.comp=null,this.prop=null,this.value=null,this.comp=l$i,this.prop=l$_,this.value=l$R}return l$z(l$i,""),l$i.prototype.exe=function(l$i){var l$_=l$v.getBindFun(this.value);this.comp[this.prop]=l$_.call(this,l$i)},l$i}()},l$h}()),l$g=function(l$i){function l$R(l$i,l$_){void 0===l$_&&(l$_=""),l$R.__super.call(this,l$i,l$_)}l$z(l$R,"laya.ui.CheckBox",l$i);var l$_=l$R.prototype;return l$_.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},l$_.initialize=function(){l$i.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},l$L(0,l$_,"dataSource",l$i.prototype._$get_dataSource,function(l$i){"boolean"==typeof(this._dataSource=l$i)?this.selected=l$i:"string"==typeof l$i?this.selected="true"===l$i:l$M.superSet(l$k,this,"dataSource",l$i)}),l$R}(l$k),l$V=function(l$i){function l$_(){this._space=0,this._align="none",this._itemChanged=!1,l$_.__super.call(this)}l$z(l$_,"laya.ui.LayoutBox",l$p);var l$R=l$_.prototype;return l$R.addChild=function(l$i){return l$i.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,l$i)},l$R.onResize=function(l$i){this._setItemChanged()},l$R.addChildAt=function(l$i,l$_){return l$i.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,l$i,l$_)},l$R.removeChild=function(l$i){return l$i.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,l$i)},l$R.removeChildAt=function(l$i){return this.getChildAt(l$i).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,l$i)},l$R.refresh=function(){this._setItemChanged()},l$R.changeItems=function(){this._itemChanged=!1},l$R.sortItem=function(l$i){l$i&&l$i.sort(function(l$i,l$_){return l$i.y-l$_.y})},l$R._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},l$L(0,l$R,"space",function(){return this._space},function(l$i){this._space=l$i,this._setItemChanged()}),l$L(0,l$R,"align",function(){return this._align},function(l$i){this._align=l$i,this._setItemChanged()}),l$_}(),l$y=function(l$_){function l$R(l$i,l$_){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,l$R.__super.call(this),l$i&&(this.skin=l$i),l$_&&(this.sheet=l$_)}l$z(l$R,"laya.ui.FontClip",l$_);var l$i=l$R.prototype;return l$i.createChildren=function(){this._bitmap=new l$G,this.on("loaded",this,this._onClipLoaded)},l$i._onClipLoaded=function(){this.callLater(this.changeValue)},l$i.changeValue=function(){var l$i;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),l$i=this._sources[0]))){var l$_="horizontal"===this._direction;l$_?(this._wordsW=this._valueArr.length*(l$i.sourceWidth+this.spaceX),this._wordsH=l$i.sourceHeight):(this._wordsW=l$i.sourceWidth,this._wordsH=(l$i.sourceHeight+this.spaceY)*this._valueArr.length);var l$R=0;if(this._width)switch(this._align){case"center":l$R=.5*(this._width-this._wordsW);break;case"right":l$R=this._width-this._wordsW;break;default:l$R=0}for(var l$r=0,l$b=this._valueArr.length;l$r<l$b;l$r++){var l$z=this._indexMap[this._valueArr.charAt(l$r)];this.sources[l$z]&&(l$i=this.sources[l$z],l$_?this.graphics.drawTexture(l$i,l$R+l$r*(l$i.sourceWidth+this.spaceX),0,l$i.sourceWidth,l$i.sourceHeight):this.graphics.drawTexture(l$i,0+l$R,l$r*(l$i.sourceHeight+this.spaceY),l$i.sourceWidth,l$i.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),l$_.prototype.destroy.call(this,l$i)},l$L(0,l$i,"sheet",function(){return this._sheet},function(l$i){l$i+="";var l$_=(this._sheet=l$i).split(" ");this._clipX=String(l$_[0]).length,this.clipY=l$_.length,this._indexMap={};for(var l$R=0;l$R<this._clipY;l$R++)for(var l$r=l$_[l$R].split(""),l$b=0,l$z=l$r.length;l$b<l$z;l$b++)this._indexMap[l$r[l$b]]=l$R*this._clipX+l$b}),l$L(0,l$i,"height",l$_.prototype._$get_height,function(l$i){l$M.superSet(l$K,this,"height",l$i),this.callLater(this.changeValue)}),l$L(0,l$i,"direction",function(){return this._direction},function(l$i){this._direction=l$i,this.callLater(this.changeValue)}),l$L(0,l$i,"value",function(){return this._valueArr?this._valueArr:""},function(l$i){l$i+="",this._valueArr=l$i,this.callLater(this.changeValue)}),l$L(0,l$i,"width",l$_.prototype._$get_width,function(l$i){l$M.superSet(l$K,this,"width",l$i),this.callLater(this.changeValue)}),l$L(0,l$i,"spaceX",function(){return this._spaceX},function(l$i){this._spaceX=l$i,"horizontal"===this._direction&&this.callLater(this.changeValue)}),l$L(0,l$i,"spaceY",function(){return this._spaceY},function(l$i){this._spaceY=l$i,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),l$L(0,l$i,"align",function(){return this._align},function(l$i){this._align=l$i,this.callLater(this.changeValue)}),l$L(0,l$i,"measureWidth",function(){return this._wordsW}),l$L(0,l$i,"measureHeight",function(){return this._wordsH}),l$R}(l$K),l$a=function(l$i){function l$_(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new l$h,l$_.__super.call(this)}l$z(l$_,"laya.ui.List",l$i);var l$R=l$_.prototype;return l$M.imps(l$R,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),l$R.destroy=function(l$i){void 0===l$i&&(l$i=!0),this._content&&this._content.destroy(l$i),this._scrollBar&&this._scrollBar.destroy(l$i),laya.ui.Component.prototype.destroy.call(this,l$i),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},l$R.createChildren=function(){this.addChild(this._content=new l$p)},l$R.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=l$M.superGet(l$p,this,"cacheAs")),l$M.superSet(l$p,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},l$R.onScrollEnd=function(){l$M.superSet(l$p,this,"cacheAs",this._$P.cacheAs)},l$R._removePreScrollBar=function(){var l$i=this.removeChildByName("scrollBar");l$i&&l$i.destroy(!0)},l$R.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var l$i=this._getOneCell(),l$_=l$i.width+this._spaceX||1,l$R=l$i.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/l$_):Math.ceil(this._width/l$_)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/l$R):Math.round(this._height/l$R));var l$r=this._width?this._width:l$_*this.repeatX-this._spaceX,l$b=this._height?this._height:l$R*this.repeatY-this._spaceY;this._cellSize=this._isVertical?l$R:l$_,this._cellOffset=this._isVertical?l$R*Math.max(this._repeatY2,this._repeatY)-l$b-this._spaceY:l$_*Math.max(this._repeatX2,this._repeatX)-l$r-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=l$b:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=l$r),this.setContentSize(l$r,l$b);var l$z=this._isVertical?this.repeatX:this.repeatY,l$L=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,l$z,l$L),this._createdLine=l$L,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},l$R._getOneCell=function(){if(0===this._cells.length){var l$i=this.createItem();if(this._offset.setTo(l$i.x,l$i.y),this.cacheContent)return l$i;this._cells.push(l$i)}return this._cells[0]},l$R._createItems=function(l$i,l$_,l$R){var l$r=this._content,l$b=this._getOneCell(),l$z=l$b.width+this._spaceX,l$L=l$b.height+this._spaceY;if(this.cacheContent){var l$w=new l$p;l$w.cacheAsBitmap=!0,l$w.pos((this._isVertical?0:l$i)*l$z,(this._isVertical?l$i:0)*l$L),this._content.addChild(l$w),this._content.optimizeScrollRect=!0,l$r=l$w}else{for(var l$x=[],l$P=this._cells.length-1;-1<l$P;l$P--){var l$B=this._cells[l$P];l$B.removeSelf(),l$x.push(l$B)}this._cells.length=0}for(var l$n=l$i;l$n<l$R;l$n++)for(var l$f=0;l$f<l$_;l$f++)(l$b=l$x&&l$x.length?l$x.pop():this.createItem()).x=(this._isVertical?l$f:l$n)*l$z-l$r.x,l$b.y=(this._isVertical?l$n:l$f)*l$L-l$r.y,l$b.name="item"+(l$n*l$_+l$f),l$r.addChild(l$b),this.addCell(l$b)},l$R.createItem=function(){var l$i=[];if("function"==typeof this._itemRender)var l$_=new this._itemRender;else l$_=l$U.createComp(this._itemRender,null,null,l$i);if(0==l$i.length&&l$_._watchMap){var l$R=l$_._watchMap;for(var l$r in l$R)for(var l$b=l$R[l$r],l$z=0;l$z<l$b.length;l$z++){var l$L=l$b[l$z];l$i.push(l$L.comp,l$L.prop,l$L.value)}}return l$i.length&&(l$_._$bindData=l$i),l$_},l$R.addCell=function(l$i){l$i.on("click",this,this.onCellMouse),l$i.on("rightclick",this,this.onCellMouse),l$i.on("mouseover",this,this.onCellMouse),l$i.on("mouseout",this,this.onCellMouse),l$i.on("mousedown",this,this.onCellMouse),l$i.on("mouseup",this,this.onCellMouse),this._cells.push(l$i)},l$R.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var l$i=0,l$_=l$i=0;l$_<1e4;l$_++){var l$R=this.getChildByName("item"+l$_);if(!l$R)break;this.addCell(l$R),l$i++}this.repeatY=l$i}},l$R.setContentSize=function(l$i,l$_){this._content.width=l$i,this._content.height=l$_,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new l$X),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,l$i,l$_),this._content.scrollRect=this._content.scrollRect),this.event("resize")},l$R.onCellMouse=function(l$i){"mousedown"===l$i.type&&(this._isMoved=!1);var l$_=l$i.currentTarget,l$R=this._startIndex+this._cells.indexOf(l$_);l$R<0||("click"===l$i.type||"rightclick"===l$i.type?this.selectEnable&&!this._isMoved?this.selectedIndex=l$R:this.changeCellState(l$_,!0,0):"mouseover"!==l$i.type&&"mouseout"!==l$i.type||this._selectedIndex===l$R||this.changeCellState(l$_,"mouseover"===l$i.type,0),this.mouseHandler&&this.mouseHandler.runWith([l$i,l$R]))},l$R.changeCellState=function(l$i,l$_,l$R){var l$r=l$i.getChildByName("selectBox");l$r&&(this.selectEnable=!0,l$r.visible=l$_,l$r.index=l$R)},l$R.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},l$R.onScrollBarChange=function(l$i){this.runCallLater(this.changeCells);var l$_=this._scrollBar.value,l$R=this._isVertical?this.repeatX:this.repeatY,l$r=this._isVertical?this.repeatY:this.repeatX,l$b=Math.floor(l$_/this._cellSize);if(this.cacheContent)l$L=l$r+1,this._createdLine-l$b<l$L&&(this._createItems(this._createdLine,l$R,this._createdLine+l$L),this.renderItems(this._createdLine*l$R,0),this._createdLine+=l$L);else{var l$z=l$b*l$R,l$L=0;if(l$z>this._startIndex){l$L=l$z-this._startIndex;var l$w=!0,l$x=this._startIndex+l$R*(l$r+1);this._isMoved=!0}else l$z<this._startIndex&&(l$L=this._startIndex-l$z,l$w=!1,l$x=this._startIndex-1,this._isMoved=!0);for(var l$P=0;l$P<l$L;l$P++){if(l$w){var l$B=this._cells.shift();this._cells[this._cells.length]=l$B;var l$n=l$x+l$P}else l$B=this._cells.pop(),this._cells.unshift(l$B),l$n=l$x-l$P;var l$f=Math.floor(l$n/l$R)*this._cellSize;this._isVertical?l$B.y=l$f:l$B.x=l$f,this.renderItem(l$B,l$n)}this._startIndex=l$z,this.changeSelectStatus()}var l$J=this._content.scrollRect;this._isVertical?(l$J.y=l$_-this._offset.y,l$J.x=-this._offset.x):(l$J.y=-this._offset.y,l$J.x=l$_-this._offset.x),this._content.scrollRect=l$J},l$R.posCell=function(l$i,l$_){if(this._scrollBar){var l$R=this._isVertical?this.repeatX:this.repeatY,l$r=(this._isVertical?this.repeatY:this.repeatX,Math.floor(l$_/l$R)*this._cellSize);this._isVertical?l$i.y=l$r:l$i.x=l$r}},l$R.changeSelectStatus=function(){for(var l$i=0,l$_=this._cells.length;l$i<l$_;l$i++)this.changeCellState(this._cells[l$i],this._selectedIndex===this._startIndex+l$i,1)},l$R.renderItems=function(l$i,l$_){void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0);for(var l$R=l$i,l$r=l$_||this._cells.length;l$R<l$r;l$R++)this.renderItem(this._cells[l$R],this._startIndex+l$R);this.changeSelectStatus()},l$R.renderItem=function(l$i,l$_){this._array&&0<=l$_&&l$_<this._array.length?(l$i.visible=!0,l$i._$bindData?(l$i._dataSource=this._array[l$_],this._bindData(l$i,this._array[l$_])):l$i.dataSource=this._array[l$_],this.cacheContent||this.posCell(l$i,l$_),this.hasListener("render")&&this.event("render",[l$i,l$_]),this.renderHandler&&this.renderHandler.runWith([l$i,l$_])):(l$i.visible=!1,l$i.dataSource=null)},l$R._bindData=function(l$i,l$_){for(var l$R=l$i._$bindData,l$r=0,l$b=l$R.length;l$r<l$b;l$r++){var l$z=l$R[l$r++],l$L=l$R[l$r++],l$w=l$R[l$r],l$x=l$v.getBindFun(l$w);l$z[l$L]=l$x.call(this,l$_)}},l$R.refresh=function(){this.array=this._array},l$R.getItem=function(l$i){return-1<l$i&&l$i<this._array.length?this._array[l$i]:null},l$R.changeItem=function(l$i,l$_){-1<l$i&&l$i<this._array.length&&(this._array[l$i]=l$_,l$i>=this._startIndex&&l$i<this._startIndex+this._cells.length&&this.renderItem(this.getCell(l$i),l$i))},l$R.setItem=function(l$i,l$_){this.changeItem(l$i,l$_)},l$R.addItem=function(l$i){this._array.push(l$i),this.array=this._array},l$R.addItemAt=function(l$i,l$_){this._array.splice(l$_,0,l$i),this.array=this._array},l$R.deleteItem=function(l$i){this._array.splice(l$i,1),this.array=this._array},l$R.getCell=function(l$i){return this.runCallLater(this.changeCells),-1<l$i&&this._cells?this._cells[(l$i-this._startIndex)%this._cells.length]:null},l$R.scrollTo=function(l$i){if(this._scrollBar){var l$_=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(l$i/l$_)*this._cellSize}else this.startIndex=l$i},l$R.tweenTo=function(l$i,l$_,l$R){if(void 0===l$_&&(l$_=200),this._scrollBar){var l$r=this._isVertical?this.repeatX:this.repeatY;l$A.to(this._scrollBar,{value:Math.floor(l$i/l$r)*this._cellSize},l$_,null,l$R,0,!0)}else this.startIndex=l$i,l$R&&l$R.run()},l$R._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},l$R.commitMeasure=function(){this.runCallLater(this.changeCells)},l$L(0,l$R,"cacheAs",l$i.prototype._$get_cacheAs,function(l$i){l$M.superSet(l$p,this,"cacheAs",l$i),this._scrollBar&&(this._$P.cacheAs=null,"none"!==l$i?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),l$L(0,l$R,"content",function(){return this._content}),l$L(0,l$R,"height",l$i.prototype._$get_height,function(l$i){l$i!=this._height&&(l$M.superSet(l$p,this,"height",l$i),this._setCellChanged())}),l$L(0,l$R,"itemRender",function(){return this._itemRender},function(l$i){if(this._itemRender!=l$i){this._itemRender=l$i;for(var l$_=this._cells.length-1;-1<l$_;l$_--)this._cells[l$_].destroy();this._cells.length=0,this._setCellChanged()}}),l$L(0,l$R,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(l$i){this._removePreScrollBar();var l$_=new l$_i;l$_.name="scrollBar",l$_.right=0,l$i&&" "!=l$i&&(l$_.skin=l$i),this.scrollBar=l$_,this.addChild(l$_),this._setCellChanged()}),l$L(0,l$R,"page",function(){return this._page},function(l$i){this._page=l$i,this._array&&(this._page=0<l$i?l$i:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),l$L(0,l$R,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(l$i){this._removePreScrollBar();var l$_=new l$F;l$_.name="scrollBar",l$_.bottom=0,l$i&&" "!=l$i&&(l$_.skin=l$i),this.scrollBar=l$_,this.addChild(l$_),this._setCellChanged()}),l$L(0,l$R,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(l$i){this._repeatX=l$i,this._setCellChanged()}),l$L(0,l$R,"scrollBar",function(){return this._scrollBar},function(l$i){this._scrollBar!=l$i&&(this._scrollBar=l$i)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),l$L(0,l$R,"width",l$i.prototype._$get_width,function(l$i){l$i!=this._width&&(l$M.superSet(l$p,this,"width",l$i),this._setCellChanged())}),l$L(0,l$R,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(l$i){this._repeatY=l$i,this._setCellChanged()}),l$L(0,l$R,"spaceX",function(){return this._spaceX},function(l$i){this._spaceX=l$i,this._setCellChanged()}),l$L(0,l$R,"spaceY",function(){return this._spaceY},function(l$i){this._spaceY=l$i,this._setCellChanged()}),l$L(0,l$R,"selectedIndex",function(){return this._selectedIndex},function(l$i){this._selectedIndex!=l$i&&(this._selectedIndex=l$i,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(l$i),this.startIndex=this._startIndex)}),l$L(0,l$R,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(l$i){this.selectedIndex=this._array.indexOf(l$i)}),l$L(0,l$R,"length",function(){return this._array?this._array.length:0}),l$L(0,l$R,"selection",function(){return this.getCell(this._selectedIndex)},function(l$i){this.selectedIndex=this._startIndex+this._cells.indexOf(l$i)}),l$L(0,l$R,"startIndex",function(){return this._startIndex},function(l$i){this._startIndex=0<l$i?l$i:0,this.callLater(this.renderItems)}),l$L(0,l$R,"array",function(){return this._array},function(l$i){this.runCallLater(this.changeCells),this._array=l$i||[];var l$_=this._array.length;if(this.totalPage=Math.ceil(l$_/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<l$_?this._selectedIndex:l$_-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var l$R=this._isVertical?this.repeatX:this.repeatY,l$r=this._isVertical?this.repeatY:this.repeatX,l$b=Math.ceil(l$_/l$R);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=l$r/l$b,this._scrollBar.setScroll(0,(l$b-l$r)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),l$L(0,l$R,"dataSource",l$i.prototype._$get_dataSource,function(l$i){"number"==typeof(this._dataSource=l$i)&&Math.floor(l$i)==l$i||"string"==typeof l$i?this.selectedIndex=parseInt(l$i):l$i instanceof Array?this.array=l$i:l$M.superSet(l$p,this,"dataSource",l$i)}),l$L(0,l$R,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),l$_}(l$p),l$F=function(l$i){function l$_(){l$_.__super.call(this)}return l$z(l$_,"laya.ui.HScrollBar",l$i),l$_.prototype.initialize=function(){l$i.prototype.initialize.call(this),this.slider.isVertical=!1},l$_}(l$s),l$d=function(l$i){function l$_(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,l$_.__super.call(this),this.width=this.height=100}l$z(l$_,"laya.ui.Panel",l$i);var l$R=l$_.prototype;return l$R.destroy=function(l$i){void 0===l$i&&(l$i=!0),laya.ui.Component.prototype.destroy.call(this,l$i),this._content&&this._content.destroy(l$i),this._vScrollBar&&this._vScrollBar.destroy(l$i),this._hScrollBar&&this._hScrollBar.destroy(l$i),this._vScrollBar=null,this._hScrollBar=null,this._content=null},l$R.destroyChildren=function(){this._content.destroyChildren()},l$R.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new l$p)},l$R.addChild=function(l$i){return l$i.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(l$i)},l$R.onResize=function(){this._setScrollChanged()},l$R.addChildAt=function(l$i,l$_){return l$i.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(l$i,l$_)},l$R.removeChild=function(l$i){return l$i.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(l$i)},l$R.removeChildAt=function(l$i){return this.getChildAt(l$i).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(l$i)},l$R.removeChildren=function(l$i,l$_){return void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=2147483647),this._content.removeChildren(l$i,l$_),this._setScrollChanged(),this},l$R.getChildAt=function(l$i){return this._content.getChildAt(l$i)},l$R.getChildByName=function(l$i){return this._content.getChildByName(l$i)},l$R.getChildIndex=function(l$i){return this._content.getChildIndex(l$i)},l$R.changeScroll=function(){this._scrollChanged=!1;var l$i=this.contentWidth||1,l$_=this.contentHeight||1,l$R=this._vScrollBar,l$r=this._hScrollBar,l$b=l$R&&l$_>this._height,l$z=l$r&&l$i>this._width,l$L=l$b?this._width-l$R.width:this._width,l$w=l$z?this._height-l$r.height:this._height;l$R&&(l$R.x=this._width-l$R.width,l$R.y=0,l$R.height=this._height-(l$z?l$r.height:0),l$R.scrollSize=Math.max(.033*this._height,1),l$R.thumbPercent=l$w/l$_,l$R.setScroll(0,l$_-l$w,l$R.value)),l$r&&(l$r.x=0,l$r.y=this._height-l$r.height,l$r.width=this._width-(l$b?l$R.width:0),l$r.scrollSize=Math.max(.033*this._width,1),l$r.thumbPercent=l$L/l$i,l$r.setScroll(0,l$i-l$L,l$r.value))},l$R.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},l$R.setContentSize=function(l$i,l$_){var l$R=this._content;l$R.width=l$i,l$R.height=l$_,l$R.scrollRect||(l$R.scrollRect=new l$X),l$R.scrollRect.setTo(0,0,l$i,l$_),l$R.scrollRect=l$R.scrollRect},l$R.onScrollBarChange=function(l$i){var l$_=this._content.scrollRect;if(l$_){var l$R=Math.round(l$i.value);l$i.isVertical?l$_.y=l$R:l$_.x=l$R,this._content.scrollRect=l$_}},l$R.scrollTo=function(l$i,l$_){void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),this.vScrollBar&&(this.vScrollBar.value=l$_),this.hScrollBar&&(this.hScrollBar.value=l$i)},l$R.refresh=function(){this.changeScroll()},l$R.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=l$M.superGet(l$p,this,"cacheAs")),l$M.superSet(l$p,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},l$R.onScrollEnd=function(){l$M.superSet(l$p,this,"cacheAs",this._$P.cacheAs)},l$R._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},l$L(0,l$R,"numChildren",function(){return this._content.numChildren}),l$L(0,l$R,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(l$i){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new l$F),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=l$i}),l$L(0,l$R,"contentWidth",function(){for(var l$i=0,l$_=this._content.numChildren-1;-1<l$_;l$_--){var l$R=this._content.getChildAt(l$_);l$i=Math.max(l$R.x+l$R.width*l$R.scaleX,l$i)}return l$i}),l$L(0,l$R,"contentHeight",function(){for(var l$i=0,l$_=this._content.numChildren-1;-1<l$_;l$_--){var l$R=this._content.getChildAt(l$_);l$i=Math.max(l$R.y+l$R.height*l$R.scaleY,l$i)}return l$i}),l$L(0,l$R,"width",l$i.prototype._$get_width,function(l$i){l$M.superSet(l$p,this,"width",l$i),this._setScrollChanged()}),l$L(0,l$R,"hScrollBar",function(){return this._hScrollBar}),l$L(0,l$R,"content",function(){return this._content}),l$L(0,l$R,"height",l$i.prototype._$get_height,function(l$i){l$M.superSet(l$p,this,"height",l$i),this._setScrollChanged()}),l$L(0,l$R,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(l$i){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new l$_i),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=l$i}),l$L(0,l$R,"vScrollBar",function(){return this._vScrollBar}),l$L(0,l$R,"cacheAs",l$i.prototype._$get_cacheAs,function(l$i){l$M.superSet(l$p,this,"cacheAs",l$i),this._$P.cacheAs=null,"none"!==l$i?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),l$_}(l$p),l$Q=function(l$i){function l$_(l$i){l$_.__super.call(this,l$i),this.isVertical=!1}return l$z(l$_,"laya.ui.HSlider",l$Y),l$_}(),l$H=function(l$i){function l$R(l$i,l$_){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,l$R.__super.call(this),this.skin=l$_,this.labels=l$i}l$z(l$R,"laya.ui.UIGroup",l$i);var l$_=l$R.prototype;return l$M.imps(l$_,{"laya.ui.IItem":!0}),l$_.preinitialize=function(){this.mouseEnabled=!0},l$_.destroy=function(l$i){void 0===l$i&&(l$i=!0),laya.ui.Component.prototype.destroy.call(this,l$i),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},l$_.addItem=function(l$i,l$_){void 0===l$_&&(l$_=!0);var l$R=l$i,l$r=this._items.length;if(l$R.name="item"+l$r,this.addChild(l$R),this.initItems(),l$_&&0<l$r){var l$b=this._items[l$r-1];"horizontal"==this._direction?l$R.x=l$b.x+l$b.width+this._space:l$R.y=l$b.y+l$b.height+this._space}else l$_&&(l$R.x=0,l$R.y=0);return l$r},l$_.delItem=function(l$i,l$_){void 0===l$_&&(l$_=!0);var l$R=this._items.indexOf(l$i);if(-1!=l$R){var l$r=l$i;this.removeChild(l$r);for(var l$b=l$R+1,l$z=this._items.length;l$b<l$z;l$b++){var l$L=this._items[l$b];l$L.name="item"+(l$b-1),l$_&&("horizontal"==this._direction?l$L.x-=l$r.width+this._space:l$L.y-=l$r.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var l$w;l$w=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=l$w}}},l$_.initItems=function(){this._items||(this._items=[]);for(var l$i=this._items.length=0;l$i<1e4;l$i++){var l$_=this.getChildByName("item"+l$i);if(null==l$_)break;this._items.push(l$_),l$_.selected=l$i===this._selectedIndex,l$_.clickHandler=l$f.create(this,this.itemClick,[l$i],!1)}},l$_.itemClick=function(l$i){this.selectedIndex=l$i},l$_.setSelect=function(l$i,l$_){this._items&&-1<l$i&&l$i<this._items.length&&(this._items[l$i].selected=l$_)},l$_.createItem=function(l$i,l$_){return null},l$_.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var l$i=0,l$_=0,l$R=this._items.length;l$_<l$R;l$_++){var l$r=this._items[l$_];this._skin&&(l$r.skin=this._skin),this._labelColors&&(l$r.labelColors=this._labelColors),this._labelSize&&(l$r.labelSize=this._labelSize),this._labelStroke&&(l$r.labelStroke=this._labelStroke),this._labelStrokeColor&&(l$r.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(l$r.strokeColors=this._strokeColors),this._labelBold&&(l$r.labelBold=this._labelBold),this._labelPadding&&(l$r.labelPadding=this._labelPadding),this._labelAlign&&(l$r.labelAlign=this._labelAlign),this._stateNum&&(l$r.stateNum=this._stateNum),this._labelFont&&(l$r.labelFont=this._labelFont),"horizontal"===this._direction?(l$r.y=0,l$r.x=l$i,l$i+=l$r.width+this._space):(l$r.x=0,l$r.y=l$i,l$i+=l$r.height+this._space)}this.changeSize()},l$_.commitMeasure=function(){this.runCallLater(this.changeLabels)},l$_._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},l$L(0,l$_,"labelStrokeColor",function(){return this._labelStrokeColor},function(l$i){this._labelStrokeColor!=l$i&&(this._labelStrokeColor=l$i,this._setLabelChanged())}),l$L(0,l$_,"skin",function(){return this._skin},function(l$i){this._skin!=l$i&&(this._skin=l$i,this._setLabelChanged())}),l$L(0,l$_,"selectedIndex",function(){return this._selectedIndex},function(l$i){this._selectedIndex!=l$i&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=l$i,this.setSelect(l$i,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),l$L(0,l$_,"labels",function(){return this._labels},function(l$i){if(this._labels!=l$i){if(this._labels=l$i,this.removeChildren(),this._setLabelChanged(),this._labels)for(var l$_=this._labels.split(","),l$R=0,l$r=l$_.length;l$R<l$r;l$R++){var l$b=this.createItem(this._skin,l$_[l$R]);l$b.name="item"+l$R,this.addChild(l$b)}this.initItems()}}),l$L(0,l$_,"strokeColors",function(){return this._strokeColors},function(l$i){this._strokeColors!=l$i&&(this._strokeColors=l$i,this._setLabelChanged())}),l$L(0,l$_,"labelColors",function(){return this._labelColors},function(l$i){this._labelColors!=l$i&&(this._labelColors=l$i,this._setLabelChanged())}),l$L(0,l$_,"labelStroke",function(){return this._labelStroke},function(l$i){this._labelStroke!=l$i&&(this._labelStroke=l$i,this._setLabelChanged())}),l$L(0,l$_,"labelSize",function(){return this._labelSize},function(l$i){this._labelSize!=l$i&&(this._labelSize=l$i,this._setLabelChanged())}),l$L(0,l$_,"stateNum",function(){return this._stateNum},function(l$i){this._stateNum!=l$i&&(this._stateNum=l$i,this._setLabelChanged())}),l$L(0,l$_,"labelBold",function(){return this._labelBold},function(l$i){this._labelBold!=l$i&&(this._labelBold=l$i,this._setLabelChanged())}),l$L(0,l$_,"labelFont",function(){return this._labelFont},function(l$i){this._labelFont!=l$i&&(this._labelFont=l$i,this._setLabelChanged())}),l$L(0,l$_,"labelPadding",function(){return this._labelPadding},function(l$i){this._labelPadding!=l$i&&(this._labelPadding=l$i,this._setLabelChanged())}),l$L(0,l$_,"direction",function(){return this._direction},function(l$i){this._direction=l$i,this._setLabelChanged()}),l$L(0,l$_,"space",function(){return this._space},function(l$i){this._space=l$i,this._setLabelChanged()}),l$L(0,l$_,"items",function(){return this._items}),l$L(0,l$_,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(l$i){this.selectedIndex=this._items.indexOf(l$i)}),l$L(0,l$_,"dataSource",l$i.prototype._$get_dataSource,function(l$i){"number"==typeof(this._dataSource=l$i)&&Math.floor(l$i)==l$i||"string"==typeof l$i?this.selectedIndex=parseInt(l$i):l$i instanceof Array?this.labels=l$i.join(","):l$M.superSet(l$p,this,"dataSource",l$i)}),l$R}(l$p),l$W=function(l$_){function l$R(l$i,l$_){this._value=null,void 0===l$_&&(l$_=""),l$R.__super.call(this,l$i,l$_)}l$z(l$R,"laya.ui.Radio",l$_);var l$i=l$R.prototype;return l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,l$i),this._value=null},l$i.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},l$i.initialize=function(){l$_.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},l$i.onClick=function(l$i){this.selected=!0},l$L(0,l$i,"value",function(){return null!=this._value?this._value:this.label},function(l$i){this._value=l$i}),l$R}(l$k),l$T=function(l$i){function l$_(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,l$_.__super.call(this),this.width=this.height=200}l$z(l$_,"laya.ui.Tree",l$i);var l$R=l$_.prototype;return l$M.imps(l$R,{"laya.ui.IRender":!0}),l$R.destroy=function(l$i){void 0===l$i&&(l$i=!0),laya.ui.Component.prototype.destroy.call(this,l$i),this._list&&this._list.destroy(l$i),this._list=null,this._source=null,this._renderHandler=null},l$R.createChildren=function(){this.addChild(this._list=new l$a),this._list.renderHandler=l$f.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},l$R.onListChange=function(l$i){this.event("change")},l$R.getArray=function(){var l$i,l$_=[];for(var l$R in this._source)l$i=this._source[l$R],this.getParentOpenStatus(l$i)&&(l$i.x=this._spaceLeft*this.getDepth(l$i),l$_.push(l$i));return l$_},l$R.getDepth=function(l$i,l$_){return void 0===l$_&&(l$_=0),null==l$i.nodeParent?l$_:this.getDepth(l$i.nodeParent,l$_+1)},l$R.getParentOpenStatus=function(l$i){var l$_=l$i.nodeParent;return null==l$_||!!l$_.isOpen&&(null==l$_.nodeParent||this.getParentOpenStatus(l$_))},l$R.renderItem=function(l$i,l$_){var l$R=l$i.dataSource;if(l$R){l$i.left=l$R.x;var l$r=l$i.getChildByName("arrow");l$r&&(l$R.hasChild?(l$r.visible=!0,l$r.index=l$R.isOpen?1:0,l$r.tag=l$_,l$r.off("click",this,this.onArrowClick),l$r.on("click",this,this.onArrowClick)):l$r.visible=!1);var l$b=l$i.getChildByName("folder");l$b&&(2==l$b.clipY?l$b.index=l$R.isDirectory?0:1:l$b.index=l$R.isDirectory?l$R.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([l$i,l$_])}},l$R.onArrowClick=function(l$i){var l$_=l$i.currentTarget.tag;this._list.array[l$_].isOpen=!this._list.array[l$_].isOpen,this.event("open"),this._list.array=this.getArray()},l$R.setItemState=function(l$i,l$_){this._list.array[l$i]&&(this._list.array[l$i].isOpen=l$_,this._list.array=this.getArray())},l$R.fresh=function(){this._list.array=this.getArray(),this.repaint()},l$R.parseXml=function(l$i,l$_,l$R,l$r){var l$b,l$z=l$i.childNodes,l$L=l$z.length;if(!l$r){l$b={};var l$w,l$x=l$i.attributes;for(var l$P in l$x){var l$B=(l$w=l$x[l$P]).nodeName,l$n=l$w.nodeValue;l$b[l$B]="true"==l$n||"false"!=l$n&&l$n}l$b.nodeParent=l$R,0<l$L&&(l$b.isDirectory=!0),l$b.hasChild=0<l$L,l$_.push(l$b)}for(var l$f=0;l$f<l$L;l$f++){var l$J=l$z[l$f];this.parseXml(l$J,l$_,l$b,!1)}},l$R.parseOpenStatus=function(l$i,l$_){for(var l$R=0,l$r=l$_.length;l$R<l$r;l$R++){var l$b=l$_[l$R];if(l$b.isDirectory)for(var l$z=0,l$L=l$i.length;l$z<l$L;l$z++){var l$w=l$i[l$z];if(l$w.isDirectory&&this.isSameParent(l$w,l$b)&&l$b.label==l$w.label){l$b.isOpen=l$w.isOpen;break}}}},l$R.isSameParent=function(l$i,l$_){return null==l$i.nodeParent&&null==l$_.nodeParent||null!=l$i.nodeParent&&null!=l$_.nodeParent&&(l$i.nodeParent.label==l$_.nodeParent.label&&this.isSameParent(l$i.nodeParent,l$_.nodeParent))},l$R.filter=function(l$i){if(Boolean(l$i)){var l$_=[];this.getFilterSource(this._source,l$_,l$i),this._list.array=l$_}else this._list.array=this.getArray()},l$R.getFilterSource=function(l$i,l$_,l$R){var l$r;for(var l$b in l$R=l$R.toLocaleLowerCase(),l$i)!(l$r=l$i[l$b]).isDirectory&&-1<String(l$r.label).toLowerCase().indexOf(l$R)&&(l$r.x=0,l$_.push(l$r)),l$r.child&&0<l$r.child.length&&this.getFilterSource(l$r.child,l$_,l$R)},l$L(0,l$R,"spaceBottom",function(){return this._list.spaceY},function(l$i){this._list.spaceY=l$i}),l$L(0,l$R,"keepStatus",function(){return this._keepStatus},function(l$i){this._keepStatus=l$i}),l$L(0,l$R,"itemRender",function(){return this._list.itemRender},function(l$i){this._list.itemRender=l$i}),l$L(0,l$R,"array",function(){return this._list.array},function(l$i){this._keepStatus&&this._list.array&&l$i&&this.parseOpenStatus(this._list.array,l$i),this._source=l$i,this._list.array=this.getArray()}),l$L(0,l$R,"mouseHandler",function(){return this._list.mouseHandler},function(l$i){this._list.mouseHandler=l$i}),l$L(0,l$R,"dataSource",l$i.prototype._$get_dataSource,function(l$i){this._dataSource=l$i,l$M.superSet(l$p,this,"dataSource",l$i)}),l$L(0,l$R,"source",function(){return this._source}),l$L(0,l$R,"scrollBar",function(){return this._list.scrollBar}),l$L(0,l$R,"list",function(){return this._list}),l$L(0,l$R,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(l$i){this._list.vScrollBarSkin=l$i}),l$L(0,l$R,"renderHandler",function(){return this._renderHandler},function(l$i){this._renderHandler=l$i}),l$L(0,l$R,"selectedIndex",function(){return this._list.selectedIndex},function(l$i){this._list.selectedIndex=l$i}),l$L(0,l$R,"spaceLeft",function(){return this._spaceLeft},function(l$i){this._spaceLeft=l$i}),l$L(0,l$R,"selectedItem",function(){return this._list.selectedItem},function(l$i){this._list.selectedItem=l$i}),l$L(0,l$R,"width",l$i.prototype._$get_width,function(l$i){l$M.superSet(l$p,this,"width",l$i),this._list.width=l$i}),l$L(0,l$R,"height",l$i.prototype._$get_height,function(l$i){l$M.superSet(l$p,this,"height",l$i),this._list.height=l$i}),l$L(0,l$R,"xml",null,function(l$i){var l$_=[];this.parseXml(l$i.childNodes[0],l$_,null,!0),this.array=l$_}),l$L(0,l$R,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),l$_}(l$p),l$ii=function(l$i){function l$_(){this._items=null,this._selectedIndex=0,l$_.__super.call(this),this._setIndexHandler=l$f.create(this,this.setIndex,null,!1)}l$z(l$_,"laya.ui.ViewStack",l$i);var l$R=l$_.prototype;return l$M.imps(l$R,{"laya.ui.IItem":!0}),l$R.setItems=function(l$i){this.removeChildren();for(var l$_=0,l$R=0,l$r=l$i.length;l$R<l$r;l$R++){var l$b=l$i[l$R];l$b&&(l$b.name="item"+l$_,this.addChild(l$b),l$_++)}this.initItems()},l$R.addItem=function(l$i){l$i.name="item"+this._items.length,this.addChild(l$i),this.initItems()},l$R.initItems=function(){this._items=[];for(var l$i=0;l$i<1e4;l$i++){var l$_=this.getChildByName("item"+l$i);if(null==l$_)break;this._items.push(l$_),l$_.visible=l$i==this._selectedIndex}},l$R.setSelect=function(l$i,l$_){this._items&&-1<l$i&&l$i<this._items.length&&(this._items[l$i].visible=l$_)},l$R.setIndex=function(l$i){this.selectedIndex=l$i},l$L(0,l$R,"dataSource",l$i.prototype._$get_dataSource,function(l$i){if("number"==typeof(this._dataSource=l$i)&&Math.floor(l$i)==l$i||"string"==typeof l$i)this.selectedIndex=parseInt(l$i);else for(var l$_ in this._dataSource)this.hasOwnProperty(l$_)&&(this[l$_]=this._dataSource[l$_])}),l$L(0,l$R,"selectedIndex",function(){return this._selectedIndex},function(l$i){this._selectedIndex!=l$i&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=l$i,this.setSelect(this._selectedIndex,!0))}),l$L(0,l$R,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(l$i){this.selectedIndex=this._items.indexOf(l$i)}),l$L(0,l$R,"items",function(){return this._items}),l$L(0,l$R,"setIndexHandler",function(){return this._setIndexHandler},function(l$i){this._setIndexHandler=l$i}),l$_}(l$p),l$_i=function(l$i){function l$_(){l$_.__super.call(this)}return l$z(l$_,"laya.ui.VScrollBar",l$s),l$_}(),l$Ri=function(l$_){function l$R(l$i){this._bg=null,this._skin=null,l$R.__super.call(this),void 0===l$i&&(l$i=""),this.text=l$i,this.skin=this.skin}l$z(l$R,"laya.ui.TextInput",l$_);var l$i=l$R.prototype;return l$i.preinitialize=function(){this.mouseEnabled=!0},l$i.destroy=function(l$i){l$t.clearCache(this,this._skin),void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,l$i),this._bg&&this._bg.destroy(),this._bg=null},l$i.createChildren=function(){this.addChild(this._tf=new l$J),this._tf.padding=l$S.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},l$i._onFocus=function(){this.event("focus",this)},l$i._onBlur=function(){this.event("blur",this)},l$i._onInput=function(){this.event("input",this)},l$i._onEnter=function(){this.event("enter",this)},l$i.initialize=function(){this.width=128,this.height=22},l$i.select=function(){this._tf.select()},l$i.setSelection=function(l$i,l$_){this._tf.setSelection(l$i,l$_)},l$L(0,l$i,"text",l$_.prototype._$get_text,function(l$i){this._tf.text!=l$i&&(l$i+="",this._tf.text=l$i,this.event("change"))}),l$L(0,l$i,"bg",function(){return this._bg},function(l$i){this.graphics=this._bg=l$i}),l$L(0,l$i,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(l$i){this._tf.inputElementYAdjuster=l$i}),l$L(0,l$i,"multiline",function(){return this._tf.multiline},function(l$i){this._tf.multiline=l$i}),l$L(0,l$i,"skin",function(){return this._skin},function(l$i){this._skin!=l$i&&(l$t.clearCache(this,this._skin),this._skin=l$i,this._bg||(this.graphics=this._bg=new l$G),l$t.keepCache(this,this._skin),this._bg.source=l$t.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),l$L(0,l$i,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(l$i){this._bg||(this.graphics=this._bg=new l$G),this._bg.sizeGrid=l$v.fillArray(l$S.defaultSizeGrid,l$i,Number)}),l$L(0,l$i,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(l$i){this._tf.inputElementXAdjuster=l$i}),l$L(0,l$i,"width",l$_.prototype._$get_width,function(l$i){l$M.superSet(l$m,this,"width",l$i),this._bg&&(this._bg.width=l$i)}),l$L(0,l$i,"height",l$_.prototype._$get_height,function(l$i){l$M.superSet(l$m,this,"height",l$i),this._bg&&(this._bg.height=l$i)}),l$L(0,l$i,"editable",function(){return this._tf.editable},function(l$i){this._tf.editable=l$i}),l$L(0,l$i,"restrict",function(){return this._tf.restrict},function(l$i){this._tf.restrict=l$i}),l$L(0,l$i,"prompt",function(){return this._tf.prompt},function(l$i){this._tf.prompt=l$i}),l$L(0,l$i,"promptColor",function(){return this._tf.promptColor},function(l$i){this._tf.promptColor=l$i}),l$L(0,l$i,"maxChars",function(){return this._tf.maxChars},function(l$i){this._tf.maxChars=l$i}),l$L(0,l$i,"focus",function(){return this._tf.focus},function(l$i){this._tf.focus=l$i}),l$L(0,l$i,"type",function(){return this._tf.type},function(l$i){this._tf.type=l$i}),l$L(0,l$i,"asPassword",function(){return this._tf.asPassword},function(l$i){this._tf.asPassword=l$i}),l$R}(l$m),l$ri=function(l$i){function l$_(){l$_.__super.call(this)}return l$z(l$_,"laya.ui.VSlider",l$Y),l$_}(),l$bi=function(l$i){function l$r(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,l$r.__super.call(this)}l$z(l$r,"laya.ui.Dialog",l$i);var l$_=l$r.prototype;return l$_.initialize=function(){this.popupEffect=l$r.manager.popupEffectHandler,this.closeEffect=l$r.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},l$_._dealDragArea=function(){var l$i=this.getChildByName("drag");l$i&&(this.dragArea=l$i.x+","+l$i.y+","+l$i.width+","+l$i.height,l$i.removeSelf())},l$_._onClick=function(l$i){var l$_=l$i.target;if(l$_)switch(l$_.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(l$_.name)}},l$_.show=function(l$i,l$_){void 0===l$i&&(l$i=!1),void 0===l$_&&(l$_=!0),this._open(!1,l$i,l$_)},l$_.popup=function(l$i,l$_){void 0===l$i&&(l$i=!1),void 0===l$_&&(l$_=!0),this._open(!0,l$i,l$_)},l$_._open=function(l$i,l$_,l$R){l$r.manager.lock(!1),this.isModal=l$i,l$r.manager.open(this,l$_,l$R)},l$_.onOpened=function(){},l$_.close=function(l$i,l$_){void 0===l$_&&(l$_=!0),l$r.manager.close(this,l$i,l$_)},l$_.onClosed=function(l$i){},l$_._onMouseDown=function(l$i){var l$_=this.getMousePoint();this._dragArea.contains(l$_.x,l$_.y)?this.startDrag():this.stopDrag()},l$L(0,l$_,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(l$i){if(l$i){var l$_=l$v.fillArray([0,0,0,0],l$i,Number);this._dragArea=new l$X(l$_[0],l$_[1],l$_[2],l$_[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),l$L(0,l$_,"isPopup",function(){return null!=this.parent}),l$L(0,l$_,"zOrder",l$i.prototype._$get_zOrder,function(l$i){l$M.superSet(l$U,this,"zOrder",l$i),l$r.manager._checkMask()}),l$L(1,l$r,"manager",function(){return l$r._manager=l$r._manager||new l$o},function(l$i){l$r._manager=l$i}),l$r.setLockView=function(l$i){l$r.manager.setLockView(l$i)},l$r.lock=function(l$i){l$r.manager.lock(l$i)},l$r.closeAll=function(){l$r.manager.closeAll()},l$r.getDialogsByGroup=function(l$i){return l$r.manager.getDialogsByGroup(l$i)},l$r.closeByGroup=function(l$i){return l$r.manager.closeByGroup(l$i)},l$r.CLOSE="close",l$r.CANCEL="cancel",l$r.SURE="sure",l$r.NO="no",l$r.OK="ok",l$r.YES="yes",l$r._manager=null,l$r}(l$U),l$zi=function(l$i){function l$_(){l$_.__super.call(this)}l$z(l$_,"laya.ui.HBox",l$i);var l$R=l$_.prototype;return l$R.sortItem=function(l$i){l$i&&l$i.sort(function(l$i,l$_){return l$i.x-l$_.x})},l$R.changeItems=function(){this._itemChanged=!1;for(var l$i=[],l$_=0,l$R=0,l$r=this.numChildren;l$R<l$r;l$R++){var l$b=this.getChildAt(l$R);l$b&&l$b.layoutEnabled&&(l$i.push(l$b),l$_=this._height?this._height:Math.max(l$_,l$b.height*l$b.scaleY))}this.sortItem(l$i);var l$z=0;for(l$R=0,l$r=l$i.length;l$R<l$r;l$R++)(l$b=l$i[l$R]).x=l$z,l$z+=l$b.width*l$b.scaleX+this._space,"top"==this._align?l$b.y=0:"middle"==this._align?l$b.y=.5*(l$_-l$b.height*l$b.scaleY):"bottom"==this._align&&(l$b.y=l$_-l$b.height*l$b.scaleY);this.changeSize()},l$L(0,l$R,"height",l$i.prototype._$get_height,function(l$i){this._height!=l$i&&(l$M.superSet(l$V,this,"height",l$i),this.callLater(this.changeItems))}),l$_.NONE="none",l$_.TOP="top",l$_.MIDDLE="middle",l$_.BOTTOM="bottom",l$_}(l$V),l$Li=function(l$i){function l$_(){l$_.__super.call(this)}l$z(l$_,"laya.ui.VBox",l$i);var l$R=l$_.prototype;return l$R.changeItems=function(){this._itemChanged=!1;for(var l$i=[],l$_=0,l$R=0,l$r=this.numChildren;l$R<l$r;l$R++){var l$b=this.getChildAt(l$R);l$b&&l$b.layoutEnabled&&(l$i.push(l$b),l$_=this._width?this._width:Math.max(l$_,l$b.width*l$b.scaleX))}this.sortItem(l$i);var l$z=0;for(l$R=0,l$r=l$i.length;l$R<l$r;l$R++)(l$b=l$i[l$R]).y=l$z,l$z+=l$b.height*l$b.scaleY+this._space,"left"==this._align?l$b.x=0:"center"==this._align?l$b.x=.5*(l$_-l$b.width*l$b.scaleX):"right"==this._align&&(l$b.x=l$_-l$b.width*l$b.scaleX);this.changeSize()},l$L(0,l$R,"width",l$i.prototype._$get_width,function(l$i){this._width!=l$i&&(l$M.superSet(l$V,this,"width",l$i),this.callLater(this.changeItems))}),l$_.NONE="none",l$_.LEFT="left",l$_.CENTER="center",l$_.RIGHT="right",l$_}(l$V),l$wi=function(l$i){function l$_(){l$_.__super.call(this)}return l$z(l$_,"laya.ui.RadioGroup",l$H),l$_.prototype.createItem=function(l$i,l$_){return new l$W(l$i,l$_)},l$_}(),l$xi=function(l$i){function l$_(){l$_.__super.call(this)}return l$z(l$_,"laya.ui.Tab",l$H),l$_.prototype.createItem=function(l$i,l$_){return new l$k(l$i,l$_)},l$_}(),l$Pi=function(l$_){function l$R(l$i){this._vScrollBar=null,this._hScrollBar=null,void 0===l$i&&(l$i=""),l$R.__super.call(this,l$i)}l$z(l$R,"laya.ui.TextArea",l$_);var l$i=l$R.prototype;return l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,l$i),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},l$i.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},l$i.onVBarChanged=function(l$i){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},l$i.onHBarChanged=function(l$i){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},l$i.changeScroll=function(){var l$i=this._vScrollBar&&0<this._tf.maxScrollY,l$_=this._hScrollBar&&0<this._tf.maxScrollX,l$R=l$i?this._width-this._vScrollBar.width:this._width,l$r=l$_?this._height-this._hScrollBar.height:this._height,l$b=this._tf.padding||l$S.labelPadding;this._tf.width=l$R,this._tf.height=l$r,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-l$b[2],this._vScrollBar.y=l$b[1],this._vScrollBar.height=this._height-(l$_?this._hScrollBar.height:0)-l$b[1]-l$b[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=l$r/Math.max(this._tf.textHeight,l$r),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=l$i),this._hScrollBar&&(this._hScrollBar.x=l$b[0],this._hScrollBar.y=this._height-this._hScrollBar.height-l$b[3],this._hScrollBar.width=this._width-(l$i?this._vScrollBar.width:0)-l$b[0]-l$b[2],this._hScrollBar.scrollSize=Math.max(.033*l$R,1),this._hScrollBar.thumbPercent=l$R/Math.max(this._tf.textWidth,l$R),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=l$_)},l$i.scrollTo=function(l$i){this.commitMeasure(),this._tf.scrollY=l$i},l$L(0,l$i,"scrollY",function(){return this._tf.scrollY}),l$L(0,l$i,"width",l$_.prototype._$get_width,function(l$i){l$M.superSet(l$Ri,this,"width",l$i),this.callLater(this.changeScroll)}),l$L(0,l$i,"hScrollBar",function(){return this._hScrollBar}),l$L(0,l$i,"height",l$_.prototype._$get_height,function(l$i){l$M.superSet(l$Ri,this,"height",l$i),this.callLater(this.changeScroll)}),l$L(0,l$i,"maxScrollX",function(){return this._tf.maxScrollX}),l$L(0,l$i,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(l$i){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new l$_i),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=l$i}),l$L(0,l$i,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(l$i){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new l$F),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=l$i}),l$L(0,l$i,"vScrollBar",function(){return this._vScrollBar}),l$L(0,l$i,"maxScrollY",function(){return this._tf.maxScrollY}),l$L(0,l$i,"scrollX",function(){return this._tf.scrollX}),l$R}(l$Ri);!function(l$i){function l$_(){this._uiView=null,this.isCloseOther=!1,l$_.__super.call(this)}l$z(l$_,"laya.ui.AsynDialog",l$bi);var l$R=l$_.prototype;l$R.createView=function(l$i){this._uiView=l$i},l$R._open=function(l$i,l$_,l$R){this.isModal=l$i,this.isCloseOther=l$_,l$bi.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},l$R.onCreated=function(){this.createUI(),this.onOpen()},l$R.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},l$R.onOpen=function(){l$bi.manager.open(this,this.isCloseOther),l$bi.manager.lock(!1)},l$R.close=function(l$i,l$_){void 0===l$_&&(l$_=!0),l$bi.manager.close(this),this.onClose()},l$R.onClose=function(){},l$R.destroy=function(l$i){void 0===l$i&&(l$i=!0),laya.ui.View.prototype.destroy.call(this,l$i),this._uiView=null,this.onDestroy()},l$R.onDestroy=function(){}}();l$M.__init([l$U])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(l$i,l$_){"use strict";for(var l$R in Object.defineProperty(l$_,"__esModule",{value:!0}),Laya){var l$r=Laya[l$R];l$r&&l$r.__isclass&&(l$_[l$R]=l$r)}}),function(l$f,l$i,l$c){l$c.un,l$c.uns;var l$n=l$c.static,l$J=l$c.class,l$h=l$c.getset,l$r=l$c.__newvec,l$e=laya.maths.Arith,l$L=laya.webgl.atlas.AtlasResourceManager,l$R=laya.webgl.shader.BaseShader,l$u=laya.utils.Browser,l$w=laya.webgl.utils.Buffer,l$l=laya.utils.Byte,l$b=laya.utils.ClassUtils,l$x=l$c.Config,l$z=(laya.events.Event,laya.events.EventDispatcher),l$S=laya.utils.Handler,l$X=laya.net.Loader,l$_=laya.net.LoaderManager,l$P=(laya.maths.MathUtil,laya.display.Node),l$M=laya.renders.Render,l$B=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),l$N=laya.resource.Resource,l$t=laya.utils.RunDriver,l$I=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),l$A=laya.display.Sprite,l$Z=laya.utils.Stat,l$q=laya.utils.StringKey,l$v=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),l$j=laya.utils.Utils,l$$=laya.webgl.WebGL,l$G=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;l$c.interface("laya.d3.core.IClone"),l$c.interface("laya.d3.graphics.IVertex"),l$c.interface("laya.d3.core.render.IUpdate"),l$c.interface("laya.d3.core.scene.ITreeNode"),l$c.interface("laya.d3.core.render.IRenderable");(function(){function l$k(){}l$J(l$k,"laya.d3.animation.AnimationClipParser01"),l$k.READ_DATA=function(){l$k._DATA.offset=l$k._reader.getUint32(),l$k._DATA.size=l$k._reader.getUint32()},l$k.READ_BLOCK=function(){for(var l$i=l$k._BLOCK.count=l$k._reader.getUint16(),l$_=l$k._BLOCK.blockStarts=[],l$R=l$k._BLOCK.blockLengths=[],l$r=0;l$r<l$i;l$r++)l$_.push(l$k._reader.getUint32()),l$R.push(l$k._reader.getUint32())},l$k.READ_STRINGS=function(){var l$i=l$k._reader.getUint32(),l$_=l$k._reader.getUint16(),l$R=l$k._reader.pos;l$k._reader.pos=l$i+l$k._DATA.offset;for(var l$r=0;l$r<l$_;l$r++)l$k._strings[l$r]=l$k._reader.readUTFString();l$k._reader.pos=l$R},l$k.parse=function(l$i,l$_){l$k._animationClip=l$i;(l$k._reader=l$_).__getBuffer();l$k.READ_DATA(),l$k.READ_BLOCK(),l$k.READ_STRINGS();for(var l$R=0,l$r=l$k._BLOCK.count;l$R<l$r;l$R++){var l$b=l$_.getUint16(),l$z=l$k._strings[l$b],l$L=l$k["READ_"+l$z];if(null==l$L)throw new Error("model file err,no this function:"+l$b+" "+l$z);l$L.call()}},l$k.READ_ANIMATIONS=function(){var l$i,l$_=0,l$R=0,l$r=l$k._reader,l$b=l$r.__getBuffer(),l$z=[],l$L=l$r.getUint8();for(l$z.length=l$L,l$_=0;l$_<l$L;l$_++)l$z[l$_]=l$r.getUint16();var l$w=[],l$x=l$r.getUint16();for(l$w.length=l$x,l$_=0;l$_<l$x;l$_++)l$w[l$_]=l$r.getFloat32();var l$P=l$k._animationClip;l$P.name=l$k._strings[l$r.getUint16()];var l$B=l$P._duration=l$r.getFloat32();l$P.islooping=!!l$r.getByte(),l$P._frameRate=l$r.getInt16();var l$n=l$r.getInt16(),l$f=l$P._nodes=new Array;l$f.length=l$n,(l$P._publicClipDatas=[]).length=l$n;var l$J=l$P._nodesMap={},l$h=0,l$M=0;for(l$_=0;l$_<l$n;l$_++){l$i=l$f[l$_]=new l$D;var l$N=l$r.getUint16(),l$X=l$i.path=[];for(l$X.length=l$N,l$R=0;l$R<l$N;l$R++)l$X[l$R]=l$k._strings[l$r.getUint16()];var l$t=l$X.join("/"),l$I=l$J[l$t];l$I||(l$J[l$t]=l$I=[]),l$I.push(l$i);var l$e=l$r.getInt16();-1!==l$e&&(l$i.componentType=l$k._strings[l$e]);var l$c=l$C._propertyIndexDic[l$k._strings[l$r.getUint16()]];if(null==l$c)throw new Error("AnimationClipParser01:unknown property name.");var l$l=l$c<4,l$A=!l$l||l$l&&""===l$X[0];(l$i._cacheProperty=l$A)?l$h++:l$M++,l$i.propertyNameID=l$c;var l$Z=l$z[l$r.getUint8()];l$i.keyFrameWidth=l$Z/4;var l$q=l$i.keyFrames=[],l$j=l$q.length=l$r.getUint16(),l$S=null,l$v=NaN;for(l$R=0;l$R<l$j;l$R++){var l$$=l$q[l$R]=new l$m;l$v=l$$.startTime=l$w[l$r.getUint16()];var l$G=l$r.pos;l$$.inTangent=new Float32Array(l$b.slice(l$G,l$G+l$Z)),l$r.pos+=l$Z,l$G=l$r.pos,l$$.outTangent=new Float32Array(l$b.slice(l$G,l$G+l$Z)),l$r.pos+=l$Z,l$G=l$r.pos,l$$.data=new Float32Array(l$b.slice(l$G,l$G+l$Z)),l$r.pos+=l$Z,l$S&&(l$S.next=l$$,l$S.duration=l$v-l$S.startTime),l$S=l$$}l$$.next=null,l$$.duration=l$B-l$v}var l$u=l$P._nodeToCachePropertyMap=new Int32Array(l$n),l$o=l$P._cachePropertyMap=new Int32Array(l$h),l$p=l$P._unCachePropertyMap=new Int32Array(l$M);for(l$h=l$M=0,l$_=0;l$_<l$n;l$_++)(l$i=l$f[l$_])._cacheProperty?(l$u[l$_]=l$h,l$o[l$h++]=l$_):l$p[l$M++]=l$_},l$k._animationClip=null,l$k._reader=null,l$k._strings=[],l$n(l$k,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function l$s(){}l$J(l$s,"laya.d3.animation.AnimationClipParser02"),l$s.READ_DATA=function(){l$s._DATA.offset=l$s._reader.getUint32(),l$s._DATA.size=l$s._reader.getUint32()},l$s.READ_BLOCK=function(){for(var l$i=l$s._BLOCK.count=l$s._reader.getUint16(),l$_=l$s._BLOCK.blockStarts=[],l$R=l$s._BLOCK.blockLengths=[],l$r=0;l$r<l$i;l$r++)l$_.push(l$s._reader.getUint32()),l$R.push(l$s._reader.getUint32())},l$s.READ_STRINGS=function(){var l$i=l$s._reader.getUint32(),l$_=l$s._reader.getUint16(),l$R=l$s._reader.pos;l$s._reader.pos=l$i+l$s._DATA.offset;for(var l$r=0;l$r<l$_;l$r++)l$s._strings[l$r]=l$s._reader.readUTFString();l$s._reader.pos=l$R},l$s.parse=function(l$i,l$_){l$s._animationClip=l$i;(l$s._reader=l$_).__getBuffer();l$s.READ_DATA(),l$s.READ_BLOCK(),l$s.READ_STRINGS();for(var l$R=0,l$r=l$s._BLOCK.count;l$R<l$r;l$R++){var l$b=l$_.getUint16(),l$z=l$s._strings[l$b],l$L=l$s["READ_"+l$z];if(null==l$L)throw new Error("model file err,no this function:"+l$b+" "+l$z);l$L.call()}},l$s.READ_ANIMATIONS=function(){var l$i,l$_=0,l$R=0,l$r=l$s._reader,l$b=l$r.__getBuffer(),l$z=[],l$L=l$r.getUint8();for(l$z.length=l$L,l$_=0;l$_<l$L;l$_++)l$z[l$_]=l$r.getUint16();var l$w=[],l$x=l$r.getUint16();for(l$w.length=l$x,l$_=0;l$_<l$x;l$_++)l$w[l$_]=l$r.getFloat32();var l$P=l$s._animationClip;l$P.name=l$s._strings[l$r.getUint16()];var l$B=l$P._duration=l$r.getFloat32();l$P.islooping=!!l$r.getByte(),l$P._frameRate=l$r.getInt16();var l$n=l$r.getInt16(),l$f=l$P._nodes=new Array;l$f.length=l$n,(l$P._publicClipDatas=[]).length=l$n;var l$J=l$P._nodesMap={},l$h=0,l$M=0;for(l$_=0;l$_<l$n;l$_++){l$i=l$f[l$_]=new l$D;var l$N=l$r.getUint16(),l$X=l$i.path=[];for(l$X.length=l$N,l$R=0;l$R<l$N;l$R++)l$X[l$R]=l$s._strings[l$r.getUint16()];var l$t=l$X.join("/"),l$I=l$J[l$t];l$I||(l$J[l$t]=l$I=[]),l$I.push(l$i);var l$e=l$r.getInt16();-1!==l$e&&(l$i.componentType=l$s._strings[l$e]);var l$c=l$C._propertyIndexDic[l$s._strings[l$r.getUint16()]];if(null==l$c)throw new Error("AnimationClipParser02:unknown property name.");var l$l=l$c<4,l$A=!l$l||l$l&&""===l$X[0];(l$i._cacheProperty=l$A)?l$h++:l$M++,l$i.propertyNameID=l$c;var l$Z=l$z[l$r.getUint8()];l$i.keyFrameWidth=l$Z/4;var l$q=l$i.keyFrames=[],l$j=l$q.length=l$r.getUint16(),l$S=null,l$v=NaN;for(l$R=0;l$R<l$j;l$R++){var l$$=l$q[l$R]=new l$m;l$v=l$$.startTime=l$w[l$r.getUint16()];var l$G=l$r.pos;l$$.inTangent=new Float32Array(l$b.slice(l$G,l$G+l$Z)),l$r.pos+=l$Z,l$G=l$r.pos,l$$.outTangent=new Float32Array(l$b.slice(l$G,l$G+l$Z)),l$r.pos+=l$Z,l$G=l$r.pos,l$$.data=new Float32Array(l$b.slice(l$G,l$G+l$Z)),l$r.pos+=l$Z,l$S&&(l$S.next=l$$,l$S.duration=l$v-l$S.startTime),l$S=l$$}l$$.next=null,l$$.duration=l$B-l$v}var l$u=l$r.getUint16();for(l$_=0;l$_<l$u;l$_++){var l$o,l$p=new l$Y;l$p.time=l$r.getFloat32(),l$p.eventName=l$s._strings[l$r.getUint16()];var l$k=l$r.getUint16();for(0<l$k&&(l$p.params=l$o=[]),l$R=0;l$R<l$k;l$R++){switch(l$r.getByte()){case 0:l$o.push(!!l$r.getByte());break;case 1:l$o.push(l$r.getInt32());break;case 2:l$o.push(l$r.getFloat32());break;case 3:l$o.push(l$s._strings[l$r.getUint16()]);break;default:throw new Error("unknown type.")}}l$P.addEvent(l$p)}var l$K=l$P._nodeToCachePropertyMap=new Int32Array(l$n),l$O=l$P._cachePropertyMap=new Int32Array(l$h),l$E=l$P._unCachePropertyMap=new Int32Array(l$M);for(l$h=l$M=0,l$_=0;l$_<l$n;l$_++)(l$i=l$f[l$_])._cacheProperty?(l$K[l$_]=l$h,l$O[l$h++]=l$_):l$E[l$M++]=l$_},l$s._animationClip=null,l$s._reader=null,l$s._strings=[],l$n(l$s,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var l$Y=function(){function l$i(){this.time=NaN,this.eventName=null,this.params=null}return l$J(l$i,"laya.d3.animation.AnimationEvent"),l$i}(),l$C=function(){function l$r(){this._childs=[],this.transform=new l$t_(this)}l$J(l$r,"laya.d3.animation.AnimationNode");var l$i=l$r.prototype;return l$c.imps(l$i,{"laya.d3.core.IClone":!0}),l$i.addChild=function(l$i){l$i._parent=this,l$i.transform.setParent(this.transform),this._childs.push(l$i)},l$i.removeChild=function(l$i){var l$_=this._childs.indexOf(l$i);-1!==l$_&&this._childs.splice(l$_,1)},l$i.getChildByName=function(l$i){for(var l$_=0,l$R=this._childs.length;l$_<l$R;l$_++){var l$r=this._childs[l$_];if(l$r.name===l$i)return l$r}return null},l$i.getChildByIndex=function(l$i){return this._childs[l$i]},l$i.getChildCount=function(){return this._childs.length},l$i.cloneTo=function(l$i){var l$_=l$i;l$_.name=this.name;for(var l$R=0,l$r=this._childs.length;l$R<l$r;l$R++){var l$b=this._childs[l$R],l$z=l$b.clone();l$_.addChild(l$z);var l$L=l$b.transform,l$w=l$z.transform;l$w.setLocalPosition(l$L.getLocalPosition()),l$w.setLocalRotation(l$L.getLocalRotation()),l$w.setLocalScale(l$L.getLocalScale()),l$w._localRotationEuler=l$L._localRotationEuler,l$w._setWorldMatrixIgnoreUpdate(l$L.getWorldMatrix())}},l$i.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$r.__init__=function(){l$r.registerAnimationNodeProperty("localPosition",l$r._getLocalPosition,l$r._setLocalPosition),l$r.registerAnimationNodeProperty("localRotation",l$r._getLocalRotation,l$r._setLocalRotation),l$r.registerAnimationNodeProperty("localScale",l$r._getLocalScale,l$r._setLocalScale),l$r.registerAnimationNodeProperty("localRotationEuler",l$r._getLocalRotationEuler,l$r._setLocalRotationEuler),l$r.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",l$r._getParticleRenderSharedMaterialTintColor,l$r._setParticleRenderSharedMaterialTintColor),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",l$r._getMeshRenderSharedMaterialTilingOffset,l$r._setMeshRenderSharedMaterialTilingOffset),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",l$r._getMeshRenderSharedMaterialAlbedo,l$r._setMeshRenderSharedMaterialAlbedo),l$r.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",l$r._getSkinnedMeshRenderSharedMaterialTilingOffset,l$r._setSkinnedMeshRenderSharedMaterialTilingOffset),l$r.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",l$r._getSkinnedMeshRenderSharedMaterialAlbedo,l$r._setSkinnedMeshRenderSharedMaterialAlbedo),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",l$r._getMeshRenderSharedMaterialAlbedo,l$r._setMeshRenderSharedMaterialAlbedo),l$r.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",l$r._getSkinnedMeshRenderSharedMaterialAlbedo,l$r._setSkinnedMeshRenderSharedMaterialAlbedo),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",l$r._getMeshRenderSharedMaterialIntensity,l$r._setMeshRenderSharedMaterialIntensity),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",l$r._getMeshRenderSharedMaterialAlpha,l$r._setMeshRenderSharedMaterialAlpha),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",l$r._getMeshRenderSharedMaterialAlphaColor,l$r._setMeshRenderSharedMaterialAlphaColor),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",l$r._getMeshRenderSharedMaterialBaseColor,l$r._setMeshRenderSharedMaterialBaseColor),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",l$r._getMeshRenderSharedMaterialDissolve,l$r._setMeshRenderSharedMaterialDissolve),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",l$r._getMeshRenderSharedMaterialDissolveSpeed,l$r._setMeshRenderSharedMaterialDissolveSpeed),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",l$r._getMeshRenderSharedMaterialMMultiplier,l$r._setMeshRenderSharedMaterialMMultiplier),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",l$r._getMeshRenderSharedMaterialBaseScrollSpeedX,l$r._setMeshRenderSharedMaterialBaseScrollSpeedX),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",l$r._getMeshRenderSharedMaterialBaseScrollSpeedY,l$r._setMeshRenderSharedMaterialBaseScrollSpeedY),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",l$r._getMeshRenderSharedMaterialSecondScrollSpeedX,l$r._setMeshRenderSharedMaterialSecondScrollSpeedX),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",l$r._getMeshRenderSharedMaterialSecondScrollSpeedY,l$r._setMeshRenderSharedMaterialSecondScrollSpeedY),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",l$r._getMeshRenderSharedMaterialDetailTilingOffset,l$r._setMeshRenderSharedMaterialDetailTilingOffset),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",l$r._getMeshRenderSharedMaterialDissolveTilingOffset,l$r._setMeshRenderSharedMaterialDissolveTilingOffset),l$r.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",l$r._getMeshRenderSharedMaterialMaskTilingOffset,l$r._setMeshRenderSharedMaterialMaskTilingOffset)},l$r.registerAnimationNodeProperty=function(l$i,l$_,l$R){if(l$r._propertyIndexDic[l$i])throw new Error("AnimationNode: this propertyName has registered.");l$r._propertyIndexDic[l$i]=l$r._propertyIDCounter,l$r._propertyGetFuncs[l$r._propertyIDCounter]=l$_,l$r._propertySetFuncs[l$r._propertyIDCounter]=l$R,l$r._propertyIDCounter++},l$r._getLocalPosition=function(l$i,l$_){return l$i?l$i.transform.getLocalPosition():l$_._transform.localPosition.elements},l$r._setLocalPosition=function(l$i,l$_,l$R){if(l$i)l$i.transform.setLocalPosition(l$R);else{var l$r=l$_._transform,l$b=l$r.localPosition;l$b.elements=l$R,l$r.localPosition=l$b}},l$r._getLocalRotation=function(l$i,l$_){return l$i?l$i.transform.getLocalRotation():l$_._transform.localRotation.elements},l$r._setLocalRotation=function(l$i,l$_,l$R){if(l$i)l$i.transform.setLocalRotation(l$R);else{var l$r=l$_._transform,l$b=l$r.localRotation;l$b.elements=l$R,l$r.localRotation=l$b}},l$r._getLocalScale=function(l$i,l$_){return l$i?l$i.transform.getLocalScale():l$_._transform.localScale.elements},l$r._setLocalScale=function(l$i,l$_,l$R){if(l$i)l$i.transform.setLocalScale(l$R);else{var l$r=l$_._transform,l$b=l$r.localScale;l$b.elements=l$R,l$r.localScale=l$b}},l$r._getLocalRotationEuler=function(l$i,l$_){return l$i?l$i.transform.getLocalRotationEuler():l$_._transform.localRotationEuler.elements},l$r._setLocalRotationEuler=function(l$i,l$_,l$R){if(l$i)l$i.transform.setLocalRotationEuler(l$R);else{var l$r=l$_._transform,l$b=l$r.localRotationEuler;l$b.elements=l$R,l$r.localRotationEuler=l$b}},l$r._getMeshRenderSharedMaterialTilingOffset=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return l$_.meshRender.sharedMaterial.tilingOffset.elements},l$r._setMeshRenderSharedMaterialTilingOffset=function(l$i,l$_,l$R){var l$r,l$b;if(l$i){var l$z=l$i.transform._entity;l$z&&((l$b=(l$r=l$z.owner.meshRender.material).tilingOffset).elements=l$R,l$r.tilingOffset=l$b)}else(l$b=(l$r=l$_.meshRender.material).tilingOffset).elements=l$R,l$r.tilingOffset=l$b},l$r._getMeshRenderSharedMaterialAlbedo=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.albedoColor.elements:null}return l$_.meshRender.sharedMaterial.albedoColor.elements},l$r._setMeshRenderSharedMaterialAlbedo=function(l$i,l$_,l$R){var l$r,l$b;if(l$i){var l$z=l$i.transform._entity;l$z&&((l$b=(l$r=l$z.owner.meshRender.material).albedoColor).elements=l$R,l$r.albedoColor=l$b)}else(l$b=(l$r=l$_.meshRender.material).albedoColor).elements=l$R,l$r.albedoColor=l$b},l$r._getSkinnedMeshRenderSharedMaterialTilingOffset=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return l$_.skinnedMeshRender.sharedMaterial.tilingOffset.elements},l$r._setSkinnedMeshRenderSharedMaterialTilingOffset=function(l$i,l$_,l$R){var l$r,l$b;if(l$i){var l$z=l$i.transform._entity;l$z&&((l$b=(l$r=l$z.owner.skinnedMeshRender.material).tilingOffset).elements=l$R,l$r.tilingOffset=l$b)}else(l$b=(l$r=l$_.skinnedMeshRender.material).tilingOffset).elements=l$R,l$r.tilingOffset=l$b},l$r._getSkinnedMeshRenderSharedMaterialAlbedo=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return l$_.skinnedMeshRender.sharedMaterial.albedoColor.elements},l$r._setSkinnedMeshRenderSharedMaterialAlbedo=function(l$i,l$_,l$R){var l$r,l$b;if(l$i){var l$z=l$i.transform._entity;l$z&&((l$b=(l$r=l$z.owner.skinnedMeshRender.material).albedoColor).elements=l$R,l$r.albedoColor=l$b)}else(l$b=(l$r=l$_.skinnedMeshRender.material).albedoColor).elements=l$R,l$r.albedoColor=l$b},l$r._getParticleRenderSharedMaterialTintColor=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.particleRender.sharedMaterial.tintColor.elements:null}return l$_.particleRender.sharedMaterial.tintColor.elements},l$r._setParticleRenderSharedMaterialTintColor=function(l$i,l$_,l$R){var l$r,l$b;if(l$i){var l$z=l$i.transform._entity;l$z&&((l$b=(l$r=l$z.owner.particleRender.material).tintColor).elements=l$R,l$r.tintColor=l$b)}else(l$b=(l$r=l$_.particleRender.material).tintColor).elements=l$R,l$r.tintColor=l$b},l$r._getMeshRenderSharedMaterialAlphaColor=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.alphaColor.elements:null}return l$_.meshRender.sharedMaterial.alphaColor.elements},l$r._setMeshRenderSharedMaterialAlphaColor=function(l$i,l$_,l$R){var l$r,l$b;if(l$i){var l$z=l$i.transform._entity;l$z&&((l$b=(l$r=l$z.owner.meshRender.material).alphaColor).elements=l$R,l$r.alphaColor=l$b)}else(l$b=(l$r=l$_.meshRender.material).alphaColor).elements=l$R,l$r.alphaColor=l$b},l$r._getMeshRenderSharedMaterialBaseColor=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.baseColor.elements:null}return l$_.meshRender.sharedMaterial.baseColor.elements},l$r._setMeshRenderSharedMaterialBaseColor=function(l$i,l$_,l$R){var l$r,l$b;if(l$i){var l$z=l$i.transform._entity;l$z&&((l$b=(l$r=l$z.owner.meshRender.material).baseColor).elements=l$R,l$r.baseColor=l$b)}else(l$b=(l$r=l$_.meshRender.material).baseColor).elements=l$R,l$r.baseColor=l$b},l$r._getMeshRenderSharedMaterialDissolve=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.dissolve:0}return l$_.meshRender.sharedMaterial.dissolve},l$r._setMeshRenderSharedMaterialDissolve=function(l$i,l$_,l$R){if(l$i){var l$r=l$i.transform._entity;l$r&&(l$r.owner.meshRender.material.dissolve=l$R[0])}else l$_.meshRender.material.dissolve=l$R[0]},l$r._getMeshRenderSharedMaterialDissolveSpeed=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.dissolveSpeed:0}return l$_.meshRender.sharedMaterial.dissolveSpeed},l$r._setMeshRenderSharedMaterialDissolveSpeed=function(l$i,l$_,l$R){if(l$i){var l$r=l$i.transform._entity;l$r&&(l$r.owner.meshRender.material.dissolveSpeed=l$R[0])}else l$_.meshRender.material.dissolveSpeed=l$R[0]},l$r._getMeshRenderSharedMaterialMMultiplier=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.mMultiplier:0}return l$_.meshRender.sharedMaterial.mMultiplier},l$r._setMeshRenderSharedMaterialMMultiplier=function(l$i,l$_,l$R){if(l$i){var l$r=l$i.transform._entity;l$r&&(l$r.owner.meshRender.material.mMultiplier=l$R[0])}else l$_.meshRender.material.mMultiplier=l$R[0]},l$r._getMeshRenderSharedMaterialBaseScrollSpeedX=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return l$_.meshRender.sharedMaterial.baseScrollSpeedX},l$r._setMeshRenderSharedMaterialBaseScrollSpeedX=function(l$i,l$_,l$R){if(l$i){var l$r=l$i.transform._entity;l$r&&(l$r.owner.meshRender.material.baseScrollSpeedX=l$R[0])}else l$_.meshRender.material.baseScrollSpeedX=l$R[0]},l$r._getMeshRenderSharedMaterialBaseScrollSpeedY=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return l$_.meshRender.sharedMaterial.baseScrollSpeedY},l$r._setMeshRenderSharedMaterialBaseScrollSpeedY=function(l$i,l$_,l$R){if(l$i){var l$r=l$i.transform._entity;l$r&&(l$r.owner.meshRender.material.baseScrollSpeedY=l$R[0])}else l$_.meshRender.material.baseScrollSpeedY=l$R[0]},l$r._getMeshRenderSharedMaterialSecondScrollSpeedX=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return l$_.meshRender.sharedMaterial.secondScrollSpeedX},l$r._setMeshRenderSharedMaterialSecondScrollSpeedX=function(l$i,l$_,l$R){if(l$i){var l$r=l$i.transform._entity;l$r&&(l$r.owner.meshRender.material.secondScrollSpeedX=l$R[0])}else l$_.meshRender.material.secondScrollSpeedX=l$R[0]},l$r._getMeshRenderSharedMaterialSecondScrollSpeedY=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return l$_.meshRender.sharedMaterial.secondScrollSpeedY},l$r._setMeshRenderSharedMaterialSecondScrollSpeedY=function(l$i,l$_,l$R){if(l$i){var l$r=l$i.transform._entity;l$r&&(l$r.owner.meshRender.material.secondScrollSpeedY=l$R[0])}else l$_.meshRender.material.secondScrollSpeedY=l$R[0]},l$r._getMeshRenderSharedMaterialAlpha=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.alpha:0}return l$_.meshRender.sharedMaterial.alpha},l$r._setMeshRenderSharedMaterialAlpha=function(l$i,l$_,l$R){if(l$i){var l$r=l$i.transform._entity;l$r&&(l$r.owner.meshRender.material.alpha=l$R[0])}else l$_.meshRender.material.alpha=l$R[0]},l$r._getMeshRenderSharedMaterialIntensity=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.intensity:0}return l$_.meshRender.sharedMaterial.intensity},l$r._setMeshRenderSharedMaterialIntensity=function(l$i,l$_,l$R){if(l$i){var l$r=l$i.transform._entity;l$r&&(l$r.owner.meshRender.material.intensity=l$R[0])}else l$_.meshRender.material.intensity=l$R[0]},l$r._getMeshRenderSharedMaterialDetailTilingOffset=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return l$_.meshRender.sharedMaterial.detailTilingOffset.elements},l$r._setMeshRenderSharedMaterialDetailTilingOffset=function(l$i,l$_,l$R){var l$r,l$b;if(l$i){var l$z=l$i.transform._entity;l$z&&((l$b=(l$r=l$z.owner.meshRender.material).detailTilingOffset).elements=l$R,l$r.detailTilingOffset=l$b)}else(l$b=(l$r=l$_.meshRender.material).detailTilingOffset).elements=l$R,l$r.detailTilingOffset=l$b},l$r._getMeshRenderSharedMaterialDissolveTilingOffset=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return l$_.meshRender.sharedMaterial.dissolveTilingOffset.elements},l$r._setMeshRenderSharedMaterialDissolveTilingOffset=function(l$i,l$_,l$R){var l$r,l$b;if(l$i){var l$z=l$i.transform._entity;l$z&&((l$b=(l$r=l$z.owner.meshRender.material).dissolveTilingOffset).elements=l$R,l$r.dissolveTilingOffset=l$b)}else(l$b=(l$r=l$_.meshRender.material).dissolveTilingOffset).elements=l$R,l$r.dissolveTilingOffset=l$b},l$r._getMeshRenderSharedMaterialMaskTilingOffset=function(l$i,l$_){if(l$i){var l$R=l$i.transform._entity;return l$R?l$R.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return l$_.meshRender.sharedMaterial.maskTilingOffset.elements},l$r._setMeshRenderSharedMaterialMaskTilingOffset=function(l$i,l$_,l$R){var l$r,l$b;if(l$i){var l$z=l$i.transform._entity;l$z&&((l$b=(l$r=l$z.owner.meshRender.material).maskTilingOffset).elements=l$R,l$r.maskTilingOffset=l$b)}else(l$b=(l$r=l$_.meshRender.material).maskTilingOffset).elements=l$R,l$r.maskTilingOffset=l$b},l$r._propertyIDCounter=0,l$r._propertyIndexDic={},l$r._propertySetFuncs=[],l$r._propertyGetFuncs=[],l$r}(),l$m=function(){function l$i(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return l$J(l$i,"laya.d3.animation.Keyframe"),l$i}(),l$D=function(){function l$i(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return l$J(l$i,"laya.d3.animation.KeyframeNode"),l$i}(),l$o=(function(){function l$i(){this._tempVector30=new l$L_,this._tempVector31=new l$L_,this._tempVector32=new l$L_,this._a=new l$L_,this._b=new l$L_,this._c=new l$L_,this._d=new l$L_}l$J(l$i,"laya.d3.core.glitter.SplineCurvePositionVelocity");var l$_=l$i.prototype;l$_.Init=function(l$i,l$_,l$R,l$r){l$i.cloneTo(this._d),l$_.cloneTo(this._c),l$L_.scale(l$i,2,this._a),l$L_.scale(l$R,2,this._tempVector30),l$L_.subtract(this._a,this._tempVector30,this._a),l$L_.add(this._a,l$_,this._a),l$L_.add(this._a,l$r,this._a),l$L_.scale(l$R,3,this._b),l$L_.scale(l$i,3,this._tempVector30),l$L_.subtract(this._b,this._tempVector30,this._b),l$L_.subtract(this._b,l$r,this._b),l$L_.scale(l$_,2,this._tempVector30),l$L_.subtract(this._b,this._tempVector30,this._b)},l$_.Slerp=function(l$i,l$_){l$L_.scale(this._a,l$i*l$i*l$i,this._tempVector30),l$L_.scale(this._b,l$i*l$i,this._tempVector31),l$L_.scale(this._c,l$i,this._tempVector32),l$L_.add(this._tempVector30,this._tempVector31,l$_),l$L_.add(l$_,this._tempVector32,l$_),l$L_.add(l$_,this._d,l$_)}}(),function(){function l$O(l$i,l$_,l$R,l$r){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=l$i,this._h=l$_,this._minHeight=l$R,this._maxHeight=l$r}l$J(l$O,"laya.d3.core.HeightMap");var l$i=l$O.prototype;l$i._inBounds=function(l$i,l$_){return 0<=l$i&&l$i<this._h&&0<=l$_&&l$_<this._w},l$i.getHeight=function(l$i,l$_){return this._inBounds(l$i,l$_)?this._datas[l$i][l$_]:NaN},l$h(0,l$i,"width",function(){return this._w}),l$h(0,l$i,"height",function(){return this._h}),l$h(0,l$i,"maxHeight",function(){return this._maxHeight}),l$h(0,l$i,"minHeight",function(){return this._minHeight}),l$O.creatFromMesh=function(l$i,l$_,l$R,l$r){for(var l$b=[],l$z=[],l$L=l$i.getSubMeshCount(),l$w=0;l$w<l$L;l$w++){for(var l$x=l$i.getSubMesh(l$w),l$P=l$x._getVertexBuffer(),l$B=l$P.getData(),l$n=[],l$f=0;l$f<l$B.length;l$f+=l$P.vertexDeclaration.vertexStride/4){var l$J=new l$L_(l$B[l$f+0],l$B[l$f+1],l$B[l$f+2]);l$n.push(l$J)}l$b.push(l$n);var l$h=l$x._getIndexBuffer();l$z.push(l$h.getData())}var l$M=l$i.boundingBox,l$N=l$M.min.x,l$X=l$M.min.z,l$t=l$M.max.x,l$I=l$M.max.z,l$e=l$M.min.y,l$c=l$M.max.y,l$l=l$t-l$N,l$A=l$I-l$X,l$Z=l$r.elements[0]=l$l/(l$_-1),l$q=l$r.elements[1]=l$A/(l$R-1),l$j=new l$O(l$_,l$R,l$e,l$c),l$S=l$O._tempRay,l$v=l$S.direction.elements;l$v[0]=0,l$v[1]=-1,l$v[2]=0;var l$$=l$c+.1;l$S.origin.elements[1]=l$$;for(var l$G=0;l$G<l$R;l$G++){var l$u=l$X+l$G*l$q;l$j._datas[l$G]=[];for(var l$o=0;l$o<l$_;l$o++){var l$p=l$N+l$o*l$Z,l$k=l$S.origin.elements;l$k[0]=l$p,l$k[2]=l$u;var l$K=l$O._getPosition(l$S,l$b,l$z);l$j._datas[l$G][l$o]=l$K===Number.MAX_VALUE?NaN:l$$-l$K}}return l$j},l$O.createFromImage=function(l$i,l$_,l$R){for(var l$r=l$i.width,l$b=l$i.height,l$z=new l$O(l$r,l$b,l$_,l$R),l$L=(l$R-l$_)/254,l$w=l$i.getPixels(),l$x=0,l$P=0;l$P<l$b;l$P++)for(var l$B=l$z._datas[l$P]=[],l$n=0;l$n<l$r;l$n++){var l$f=l$w[l$x++],l$J=l$w[l$x++],l$h=l$w[l$x++],l$M=l$w[l$x++];l$B[l$n]=255==l$f&&255==l$J&&255==l$h&&255==l$M?NaN:(l$f+l$J+l$h)/3*l$L+l$_}return l$z},l$O._getPosition=function(l$i,l$_,l$R){for(var l$r=Number.MAX_VALUE,l$b=0;l$b<l$_.length;l$b++)for(var l$z=l$_[l$b],l$L=l$R[l$b],l$w=0;l$w<l$L.length;l$w+=3){var l$x=l$z[l$L[l$w+0]],l$P=l$z[l$L[l$w+1]],l$B=l$z[l$L[l$w+2]],l$n=l$h_.rayIntersectsTriangle(l$i,l$x,l$P,l$B);!isNaN(l$n)&&l$n<l$r&&(l$r=l$n)}return l$r},l$n(l$O,["_tempRay",function(){return this._tempRay=new l$b_(new l$L_,new l$L_)}])}(),function(){function l$b(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}l$J(l$b,"laya.d3.core.Layer");var l$i=l$b.prototype;return l$i._binarySearchIndex=function(){for(var l$i=0,l$_=l$b._collsionTestList.length-1,l$R=0;l$i<=l$_;){l$R=Math.floor((l$i+l$_)/2);var l$r=l$b._collsionTestList[l$R];if(l$r==this._number)return l$R;l$r>this._number?l$_=l$R-1:l$i=l$R+1}return l$i},l$i._addCollider=function(l$i){0===this._colliders.length&&l$b._collsionTestList.splice(this._binarySearchIndex(),0,this._number),l$i._isRigidbody?(this._colliders.unshift(l$i),this._nonRigidbodyOffset++):this._colliders.push(l$i)},l$i._removeCollider=function(l$i){var l$_=this._colliders.indexOf(l$i);l$_<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(l$_,1),0===this._colliders.length&&l$b._collsionTestList.splice(l$b._collsionTestList.indexOf(this._number),1)},l$h(0,l$i,"number",function(){return this._number}),l$h(0,l$i,"visible",function(){return this._visible},function(l$i){this._visible=l$i,l$b._visibleLayers=l$i?l$b._visibleLayers|this.mask:l$b._visibleLayers&~this.mask}),l$h(0,l$i,"mask",function(){return this._mask}),l$h(1,l$b,"visibleLayers",function(){return l$b._visibleLayers},function(l$i){l$b._visibleLayers=l$i;for(var l$_=0,l$R=l$b._layerList.length;l$_<l$R;l$_++){var l$r=l$b._layerList[l$_];l$r._visible=0!=(l$r._mask&l$b._visibleLayers)}}),l$b.__init__=function(){l$b._layerList.length=31;for(var l$i=0;l$i<31;l$i++){var l$_=new l$b;l$b._layerList[l$i]=l$_,0===l$i?(l$_.name="Default Layer",l$_.visible=!0):(l$_.name="Layer-"+l$i,l$_.visible=!1),l$_._number=l$i,l$_._mask=Math.pow(2,l$i)}l$b.currentCreationLayer=l$b._layerList[0]},l$b.getLayerByNumber=function(l$i){if(l$i<0||30<l$i)throw new Error("无法返回指定Layer，该number超出范围！");return l$b._layerList[l$i]},l$b.getLayerByName=function(l$i){for(var l$_=0;l$_<31;l$_++)if(l$b._layerList[l$_].name===l$i)return l$b._layerList[l$_];throw new Error("无法返回指定Layer,该name不存在")},l$b.isVisible=function(l$i){return 0!=(l$i&l$b._currentCameraCullingMask&l$b._visibleLayers)},l$b._layerList=[],l$b._visibleLayers=2147483647,l$b._collsionTestList=[],l$b._currentCameraCullingMask=2147483647,l$b.maxCount=31,l$b.currentCreationLayer=null,l$b}()),l$p=(function(){function l$i(l$i,l$_,l$R){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=l$i,this._minCount=l$_,this._maxCount=l$R}l$J(l$i,"laya.d3.core.particleShuriKen.module.Burst");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_.cloneTo=function(l$i){var l$_=l$i;l$_._time=this._time,l$_._minCount=this._minCount,l$_._maxCount=this._maxCount},l$_.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$_,"time",function(){return this._time}),l$h(0,l$_,"minCount",function(){return this._minCount}),l$h(0,l$_,"maxCount",function(){return this._maxCount})}(),function(){function l$i(l$i){this._color=null,this.enbale=!1,this._color=l$i}l$J(l$i,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var l$_=l$i.prototype;l$_.cloneTo=function(l$i){var l$_=l$i;this._color.cloneTo(l$_._color),l$_.enbale=this.enbale},l$_.clone=function(){var l$i;switch(this._color.type){case 0:l$i=l$K.createByConstant(this._color.constant.clone());break;case 1:l$i=l$K.createByGradient(this._color.gradient.clone());break;case 2:l$i=l$K.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:l$i=l$K.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var l$_=new this.constructor(l$i);return l$_.enbale=this.enbale,l$_},l$h(0,l$_,"color",function(){return this._color})}(),function(){function l$i(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}l$J(l$i,"laya.d3.core.particleShuriKen.module.Emission");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),l$_._destroy=function(){this._bursts=null,this._destroyed=!0},l$_.getBurstsCount=function(){return this._bursts.length},l$_.getBurstByIndex=function(l$i){return this._bursts[l$i]},l$_.addBurst=function(l$i){var l$_=this._bursts.length;if(0<l$_)for(var l$R=0;l$R<l$_;l$R++)this._bursts[l$R].time>l$i.time&&this._bursts.splice(l$R,0,l$i);this._bursts.push(l$i)},l$_.removeBurst=function(l$i){var l$_=this._bursts.indexOf(l$i);-1!==l$_&&this._bursts.splice(l$_,1)},l$_.removeBurstByIndex=function(l$i){this._bursts.splice(l$i,1)},l$_.clearBurst=function(){this._bursts.length=0},l$_.cloneTo=function(l$i){var l$_=l$i,l$R=l$_._bursts;l$R.length=this._bursts.length;for(var l$r=0,l$b=this._bursts.length;l$r<l$b;l$r++){var l$z=l$R[l$r];l$z?this._bursts[l$r].cloneTo(l$z):l$R[l$r]=this._bursts[l$r].clone()}l$_._emissionRate=this._emissionRate,l$_.enbale=this.enbale},l$_.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$_,"destroyed",function(){return this._destroyed}),l$h(0,l$_,"emissionRate",function(){return this._emissionRate},function(l$i){if(l$i<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=l$i})}(),function(){function l$r(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}l$J(l$r,"laya.d3.core.particleShuriKen.module.FrameOverTime");var l$i=l$r.prototype;return l$c.imps(l$i,{"laya.d3.core.IClone":!0}),l$i.cloneTo=function(l$i){var l$_=l$i;l$_._type=this._type,l$_._constant=this._constant,this._overTime.cloneTo(l$_._overTime),l$_._constantMin=this._constantMin,l$_._constantMax=this._constantMax,this._overTimeMin.cloneTo(l$_._overTimeMin),this._overTimeMax.cloneTo(l$_._overTimeMax)},l$i.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$i,"frameOverTimeData",function(){return this._overTime}),l$h(0,l$i,"constant",function(){return this._constant}),l$h(0,l$i,"type",function(){return this._type}),l$h(0,l$i,"frameOverTimeDataMin",function(){return this._overTimeMin}),l$h(0,l$i,"constantMin",function(){return this._constantMin}),l$h(0,l$i,"frameOverTimeDataMax",function(){return this._overTimeMax}),l$h(0,l$i,"constantMax",function(){return this._constantMax}),l$r.createByConstant=function(l$i){var l$_=new l$r;return l$_._type=0,l$_._constant=l$i,l$_},l$r.createByOverTime=function(l$i){var l$_=new l$r;return l$_._type=1,l$_._overTime=l$i,l$_},l$r.createByRandomTwoConstant=function(l$i,l$_){var l$R=new l$r;return l$R._type=2,l$R._constantMin=l$i,l$R._constantMax=l$_,l$R},l$r.createByRandomTwoOverTime=function(l$i,l$_){var l$R=new l$r;return l$R._type=3,l$R._overTimeMin=l$i,l$R._overTimeMax=l$_,l$R},l$r}()),l$k=function(){function l$P(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}l$J(l$P,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var l$i=l$P.prototype;return l$c.imps(l$i,{"laya.d3.core.IClone":!0}),l$i.cloneTo=function(l$i){var l$_=l$i;l$_._type=this._type,l$_._separateAxes=this._separateAxes,l$_._constant=this._constant,this._constantSeparate.cloneTo(l$_._constantSeparate),this._gradient.cloneTo(l$_._gradient),this._gradientX.cloneTo(l$_._gradientX),this._gradientY.cloneTo(l$_._gradientY),this._gradientZ.cloneTo(l$_._gradientZ),l$_._constantMin=this._constantMin,l$_._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(l$_._constantMinSeparate),this._constantMaxSeparate.cloneTo(l$_._constantMaxSeparate),this._gradientMin.cloneTo(l$_._gradientMin),this._gradientMax.cloneTo(l$_._gradientMax),this._gradientXMin.cloneTo(l$_._gradientXMin),this._gradientXMax.cloneTo(l$_._gradientXMax),this._gradientYMin.cloneTo(l$_._gradientYMin),this._gradientYMax.cloneTo(l$_._gradientYMax),this._gradientZMin.cloneTo(l$_._gradientZMin),this._gradientZMax.cloneTo(l$_._gradientZMax)},l$i.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$i,"gradientZ",function(){return this._gradientZ}),l$h(0,l$i,"constant",function(){return this._constant}),l$h(0,l$i,"gradient",function(){return this._gradient}),l$h(0,l$i,"separateAxes",function(){return this._separateAxes}),l$h(0,l$i,"type",function(){return this._type}),l$h(0,l$i,"constantSeparate",function(){return this._constantSeparate}),l$h(0,l$i,"gradientX",function(){return this._gradientX}),l$h(0,l$i,"gradientY",function(){return this._gradientY}),l$h(0,l$i,"gradientW",function(){return this._gradientW}),l$h(0,l$i,"gradientMin",function(){return this._gradientMin}),l$h(0,l$i,"constantMin",function(){return this._constantMin}),l$h(0,l$i,"gradientMax",function(){return this._gradientMax}),l$h(0,l$i,"constantMax",function(){return this._constantMax}),l$h(0,l$i,"gradientWMin",function(){return this._gradientWMin}),l$h(0,l$i,"constantMinSeparate",function(){return this._constantMinSeparate}),l$h(0,l$i,"constantMaxSeparate",function(){return this._constantMaxSeparate}),l$h(0,l$i,"gradientXMin",function(){return this._gradientXMin}),l$h(0,l$i,"gradientXMax",function(){return this._gradientXMax}),l$h(0,l$i,"gradientWMax",function(){return this._gradientWMax}),l$h(0,l$i,"gradientYMin",function(){return this._gradientYMin}),l$h(0,l$i,"gradientYMax",function(){return this._gradientYMax}),l$h(0,l$i,"gradientZMin",function(){return this._gradientZMin}),l$h(0,l$i,"gradientZMax",function(){return this._gradientZMax}),l$P.createByConstant=function(l$i){var l$_=new l$P;return l$_._type=0,l$_._separateAxes=!1,l$_._constant=l$i,l$_},l$P.createByConstantSeparate=function(l$i){var l$_=new l$P;return l$_._type=0,l$_._separateAxes=!0,l$_._constantSeparate=l$i,l$_},l$P.createByGradient=function(l$i){var l$_=new l$P;return l$_._type=1,l$_._separateAxes=!1,l$_._gradient=l$i,l$_},l$P.createByGradientSeparate=function(l$i,l$_,l$R,l$r){var l$b=new l$P;return l$b._type=1,l$b._separateAxes=!0,l$b._gradientX=l$i,l$b._gradientY=l$_,l$b._gradientZ=l$R,l$b._gradientW=l$r,l$b},l$P.createByRandomTwoConstant=function(l$i,l$_){var l$R=new l$P;return l$R._type=2,l$R._separateAxes=!1,l$R._constantMin=l$i,l$R._constantMax=l$_,l$R},l$P.createByRandomTwoConstantSeparate=function(l$i,l$_){var l$R=new l$P;return l$R._type=2,l$R._separateAxes=!0,l$R._constantMinSeparate=l$i,l$R._constantMaxSeparate=l$_,l$R},l$P.createByRandomTwoGradient=function(l$i,l$_){var l$R=new l$P;return l$R._type=3,l$R._separateAxes=!1,l$R._gradientMin=l$i,l$R._gradientMax=l$_,l$R},l$P.createByRandomTwoGradientSeparate=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){var l$x=new l$P;return l$x._type=3,l$x._separateAxes=!0,l$x._gradientXMin=l$i,l$x._gradientXMax=l$_,l$x._gradientYMin=l$R,l$x._gradientYMax=l$r,l$x._gradientZMin=l$b,l$x._gradientZMax=l$z,l$x._gradientWMin=l$L,l$x._gradientWMax=l$w,l$x},l$P}(),l$K=function(){function l$r(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}l$J(l$r,"laya.d3.core.particleShuriKen.module.GradientColor");var l$i=l$r.prototype;return l$c.imps(l$i,{"laya.d3.core.IClone":!0}),l$i.cloneTo=function(l$i){var l$_=l$i;l$_._type=this._type,this._constant.cloneTo(l$_._constant),this._constantMin.cloneTo(l$_._constantMin),this._constantMax.cloneTo(l$_._constantMax),this._gradient.cloneTo(l$_._gradient),this._gradientMin.cloneTo(l$_._gradientMin),this._gradientMax.cloneTo(l$_._gradientMax)},l$i.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$i,"gradient",function(){return this._gradient}),l$h(0,l$i,"constant",function(){return this._constant}),l$h(0,l$i,"type",function(){return this._type}),l$h(0,l$i,"gradientMin",function(){return this._gradientMin}),l$h(0,l$i,"constantMin",function(){return this._constantMin}),l$h(0,l$i,"gradientMax",function(){return this._gradientMax}),l$h(0,l$i,"constantMax",function(){return this._constantMax}),l$r.createByConstant=function(l$i){var l$_=new l$r;return l$_._type=0,l$_._constant=l$i,l$_},l$r.createByGradient=function(l$i){var l$_=new l$r;return l$_._type=1,l$_._gradient=l$i,l$_},l$r.createByRandomTwoConstant=function(l$i,l$_){var l$R=new l$r;return l$R._type=2,l$R._constantMin=l$i,l$R._constantMax=l$_,l$R},l$r.createByRandomTwoGradient=function(l$i,l$_){var l$R=new l$r;return l$R._type=3,l$R._gradientMin=l$i,l$R._gradientMax=l$_,l$R},l$r}(),l$O=(function(){function l$i(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}l$J(l$i,"laya.d3.core.particleShuriKen.module.GradientDataColor");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_.addAlpha=function(l$i,l$_){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==l$i&&(l$i=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=l$i,this._alphaElements[this._alphaCurrentLength++]=l$_):DEBUG},l$_.addRGB=function(l$i,l$_){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==l$i&&(l$i=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=l$i,this._rgbElements[this._rgbCurrentLength++]=l$_.x,this._rgbElements[this._rgbCurrentLength++]=l$_.y,this._rgbElements[this._rgbCurrentLength++]=l$_.z):DEBUG},l$_.cloneTo=function(l$i){var l$_=l$i,l$R=0,l$r=0;l$_._alphaCurrentLength=this._alphaCurrentLength;var l$b=l$_._alphaElements;for(l$b.length=this._alphaElements.length,l$R=0,l$r=this._alphaElements.length;l$R<l$r;l$R++)l$b[l$R]=this._alphaElements[l$R];l$_._rgbCurrentLength=this._rgbCurrentLength;var l$z=l$_._rgbElements;for(l$z.length=this._rgbElements.length,l$R=0,l$r=this._rgbElements.length;l$R<l$r;l$R++)l$z[l$R]=this._rgbElements[l$R]},l$_.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$_,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),l$h(0,l$_,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function l$i(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}l$J(l$i,"laya.d3.core.particleShuriKen.module.GradientDataInt");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_.add=function(l$i,l$_){this._currentLength<8?(6===this._currentLength&&1!==l$i&&(l$i=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=l$i,this._elements[this._currentLength++]=l$_):console.log("Warning:data count must lessEqual than 4")},l$_.cloneTo=function(l$i){var l$_=l$i;l$_._currentLength=this._currentLength;var l$R=l$_._elements;l$R.length=this._elements.length;for(var l$r=0,l$b=this._elements.length;l$r<l$b;l$r++)l$R[l$r]=this._elements[l$r]},l$_.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$_,"gradientCount",function(){return this._currentLength/2})}(),function(){function l$i(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}l$J(l$i,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_.add=function(l$i,l$_){this._currentLength<8?(6===this._currentLength&&1!==l$i&&(l$i=1,DEBUG),this._elements[this._currentLength++]=l$i,this._elements[this._currentLength++]=l$_):DEBUG},l$_.getKeyByIndex=function(l$i){return this._elements[2*l$i]},l$_.getValueByIndex=function(l$i){return this._elements[2*l$i+1]},l$_.getAverageValue=function(){for(var l$i=0,l$_=this._currentLength-2;l$i<l$_;l$i+=2){this._elements[l$i+1];this._elements[l$i+3],this._elements[l$i+2]-this._elements[l$i]}return 0},l$_.cloneTo=function(l$i){var l$_=l$i;l$_._currentLength=this._currentLength;var l$R=l$_._elements;l$R.length=this._elements.length;for(var l$r=0,l$b=this._elements.length;l$r<l$b;l$r++)l$R[l$r]=this._elements[l$r]},l$_.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$_,"gradientCount",function(){return this._currentLength/2})}(),function(){function l$i(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}l$J(l$i,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_.add=function(l$i,l$_){this._currentLength<8?(6===this._currentLength&&1!==l$i&&(l$i=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=l$i,this._elements[this._currentLength++]=l$_.x,this._elements[this._currentLength++]=l$_.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},l$_.cloneTo=function(l$i){var l$_=l$i;l$_._currentLength=this._currentLength;var l$R=l$_._elements;l$R.length=this._elements.length;for(var l$r=0,l$b=this._elements.length;l$r<l$b;l$r++)l$R[l$r]=this._elements[l$r]},l$_.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$_,"gradientCount",function(){return this._currentLength/3})}(),function(){function l$w(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}l$J(l$w,"laya.d3.core.particleShuriKen.module.GradientSize");var l$i=l$w.prototype;return l$c.imps(l$i,{"laya.d3.core.IClone":!0}),l$i.getMaxSizeInGradient=function(){var l$i=0,l$_=0,l$R=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(l$i=0,l$_=this._gradientX.gradientCount;l$i<l$_;l$i++)l$R=Math.max(l$R,this._gradientX.getValueByIndex(l$i));for(l$i=0,l$_=this._gradientY.gradientCount;l$i<l$_;l$i++)l$R=Math.max(l$R,this._gradientY.getValueByIndex(l$i))}else for(l$i=0,l$_=this._gradient.gradientCount;l$i<l$_;l$i++)l$R=Math.max(l$R,this._gradient.getValueByIndex(l$i));break;case 1:l$R=this._separateAxes?(l$R=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),l$R=Math.max(l$R,this._constantMinSeparate.y),Math.max(l$R,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(l$i=0,l$_=this._gradientXMin.gradientCount;l$i<l$_;l$i++)l$R=Math.max(l$R,this._gradientXMin.getValueByIndex(l$i));for(l$i=0,l$_=this._gradientXMax.gradientCount;l$i<l$_;l$i++)l$R=Math.max(l$R,this._gradientXMax.getValueByIndex(l$i));for(l$i=0,l$_=this._gradientYMin.gradientCount;l$i<l$_;l$i++)l$R=Math.max(l$R,this._gradientYMin.getValueByIndex(l$i));for(l$i=0,l$_=this._gradientZMax.gradientCount;l$i<l$_;l$i++)l$R=Math.max(l$R,this._gradientZMax.getValueByIndex(l$i))}else{for(l$i=0,l$_=this._gradientMin.gradientCount;l$i<l$_;l$i++)l$R=Math.max(l$R,this._gradientMin.getValueByIndex(l$i));for(l$i=0,l$_=this._gradientMax.gradientCount;l$i<l$_;l$i++)l$R=Math.max(l$R,this._gradientMax.getValueByIndex(l$i))}}return l$R},l$i.cloneTo=function(l$i){var l$_=l$i;l$_._type=this._type,l$_._separateAxes=this._separateAxes,this._gradient.cloneTo(l$_._gradient),this._gradientX.cloneTo(l$_._gradientX),this._gradientY.cloneTo(l$_._gradientY),this._gradientZ.cloneTo(l$_._gradientZ),l$_._constantMin=this._constantMin,l$_._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(l$_._constantMinSeparate),this._constantMaxSeparate.cloneTo(l$_._constantMaxSeparate),this._gradientMin.cloneTo(l$_._gradientMin),this._gradientMax.cloneTo(l$_._gradientMax),this._gradientXMin.cloneTo(l$_._gradientXMin),this._gradientXMax.cloneTo(l$_._gradientXMax),this._gradientYMin.cloneTo(l$_._gradientYMin),this._gradientYMax.cloneTo(l$_._gradientYMax),this._gradientZMin.cloneTo(l$_._gradientZMin),this._gradientZMax.cloneTo(l$_._gradientZMax)},l$i.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$i,"gradientZ",function(){return this._gradientZ}),l$h(0,l$i,"gradient",function(){return this._gradient}),l$h(0,l$i,"separateAxes",function(){return this._separateAxes}),l$h(0,l$i,"type",function(){return this._type}),l$h(0,l$i,"gradientMin",function(){return this._gradientMin}),l$h(0,l$i,"constantMin",function(){return this._constantMin}),l$h(0,l$i,"gradientX",function(){return this._gradientX}),l$h(0,l$i,"gradientY",function(){return this._gradientY}),l$h(0,l$i,"gradientMax",function(){return this._gradientMax}),l$h(0,l$i,"constantMax",function(){return this._constantMax}),l$h(0,l$i,"constantMinSeparate",function(){return this._constantMinSeparate}),l$h(0,l$i,"constantMaxSeparate",function(){return this._constantMaxSeparate}),l$h(0,l$i,"gradientXMin",function(){return this._gradientXMin}),l$h(0,l$i,"gradientXMax",function(){return this._gradientXMax}),l$h(0,l$i,"gradientYMin",function(){return this._gradientYMin}),l$h(0,l$i,"gradientYMax",function(){return this._gradientYMax}),l$h(0,l$i,"gradientZMin",function(){return this._gradientZMin}),l$h(0,l$i,"gradientZMax",function(){return this._gradientZMax}),l$w.createByGradient=function(l$i){var l$_=new l$w;return l$_._type=0,l$_._separateAxes=!1,l$_._gradient=l$i,l$_},l$w.createByGradientSeparate=function(l$i,l$_,l$R){var l$r=new l$w;return l$r._type=0,l$r._separateAxes=!0,l$r._gradientX=l$i,l$r._gradientY=l$_,l$r._gradientZ=l$R,l$r},l$w.createByRandomTwoConstant=function(l$i,l$_){var l$R=new l$w;return l$R._type=1,l$R._separateAxes=!1,l$R._constantMin=l$i,l$R._constantMax=l$_,l$R},l$w.createByRandomTwoConstantSeparate=function(l$i,l$_){var l$R=new l$w;return l$R._type=1,l$R._separateAxes=!0,l$R._constantMinSeparate=l$i,l$R._constantMaxSeparate=l$_,l$R},l$w.createByRandomTwoGradient=function(l$i,l$_){var l$R=new l$w;return l$R._type=2,l$R._separateAxes=!1,l$R._gradientMin=l$i,l$R._gradientMax=l$_,l$R},l$w.createByRandomTwoGradientSeparate=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=new l$w;return l$L._type=2,l$L._separateAxes=!0,l$L._gradientXMin=l$i,l$L._gradientXMax=l$_,l$L._gradientYMin=l$R,l$L._gradientYMax=l$r,l$L._gradientZMin=l$b,l$L._gradientZMax=l$z,l$L},l$w}()),l$E=function(){function l$w(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}l$J(l$w,"laya.d3.core.particleShuriKen.module.GradientVelocity");var l$i=l$w.prototype;return l$c.imps(l$i,{"laya.d3.core.IClone":!0}),l$i.cloneTo=function(l$i){var l$_=l$i;l$_._type=this._type,this._constant.cloneTo(l$_._constant),this._gradientX.cloneTo(l$_._gradientX),this._gradientY.cloneTo(l$_._gradientY),this._gradientZ.cloneTo(l$_._gradientZ),this._constantMin.cloneTo(l$_._constantMin),this._constantMax.cloneTo(l$_._constantMax),this._gradientXMin.cloneTo(l$_._gradientXMin),this._gradientXMax.cloneTo(l$_._gradientXMax),this._gradientYMin.cloneTo(l$_._gradientYMin),this._gradientYMax.cloneTo(l$_._gradientYMax),this._gradientZMin.cloneTo(l$_._gradientZMin),this._gradientZMax.cloneTo(l$_._gradientZMax)},l$i.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$i,"gradientZ",function(){return this._gradientZ}),l$h(0,l$i,"constant",function(){return this._constant}),l$h(0,l$i,"type",function(){return this._type}),l$h(0,l$i,"gradientXMax",function(){return this._gradientXMax}),l$h(0,l$i,"constantMin",function(){return this._constantMin}),l$h(0,l$i,"gradientX",function(){return this._gradientX}),l$h(0,l$i,"gradientY",function(){return this._gradientY}),l$h(0,l$i,"gradientXMin",function(){return this._gradientXMin}),l$h(0,l$i,"constantMax",function(){return this._constantMax}),l$h(0,l$i,"gradientYMin",function(){return this._gradientYMin}),l$h(0,l$i,"gradientYMax",function(){return this._gradientYMax}),l$h(0,l$i,"gradientZMin",function(){return this._gradientZMin}),l$h(0,l$i,"gradientZMax",function(){return this._gradientZMax}),l$w.createByConstant=function(l$i){var l$_=new l$w;return l$_._type=0,l$_._constant=l$i,l$_},l$w.createByGradient=function(l$i,l$_,l$R){var l$r=new l$w;return l$r._type=1,l$r._gradientX=l$i,l$r._gradientY=l$_,l$r._gradientZ=l$R,l$r},l$w.createByRandomTwoConstant=function(l$i,l$_){var l$R=new l$w;return l$R._type=2,l$R._constantMin=l$i,l$R._constantMax=l$_,l$R},l$w.createByRandomTwoGradient=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=new l$w;return l$L._type=3,l$L._gradientXMin=l$i,l$L._gradientXMax=l$_,l$L._gradientYMin=l$R,l$L._gradientYMax=l$r,l$L._gradientZMin=l$b,l$L._gradientZMax=l$z,l$L},l$w}(),l$s=(function(){function l$i(l$i){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=l$i}l$J(l$i,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_.cloneTo=function(l$i){var l$_=l$i;this._angularVelocity.cloneTo(l$_._angularVelocity),l$_.enbale=this.enbale},l$_.clone=function(){var l$i;switch(this._angularVelocity.type){case 0:l$i=this._angularVelocity.separateAxes?l$k.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):l$k.createByConstant(this._angularVelocity.constant);break;case 1:l$i=this._angularVelocity.separateAxes?l$k.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):l$k.createByGradient(this._angularVelocity.gradient.clone());break;case 2:l$i=this._angularVelocity.separateAxes?l$k.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):l$k.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:l$i=this._angularVelocity.separateAxes?l$k.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):l$k.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var l$_=new this.constructor(l$i);return l$_.enbale=this.enbale,l$_},l$h(0,l$_,"angularVelocity",function(){return this._angularVelocity})}(),function(){function l$i(){this.enable=!1,this.randomDirection=!1}l$J(l$i,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_._getShapeBoundBox=function(l$i){throw new Error("BaseShape: must override it.")},l$_._getSpeedBoundBox=function(l$i){throw new Error("BaseShape: must override it.")},l$_.generatePositionAndDirection=function(l$i,l$_,l$R,l$r){throw new Error("BaseShape: must override it.")},l$_._calculateProceduralBounds=function(l$i,l$_,l$R){this._getShapeBoundBox(l$i);var l$r=l$i.min,l$b=l$i.max;l$L_.multiply(l$r,l$_,l$r),l$L_.multiply(l$b,l$_,l$b);var l$z=new l$di(new l$L_,new l$L_);this.randomDirection?(l$z.min=new l$L_(-1,-1,-1),l$z.max=new l$L_(1,1,1)):this._getSpeedBoundBox(l$z);var l$L=new l$di(new l$L_,new l$L_),l$w=l$L.min,l$x=l$L.max;l$L_.scale(l$z.min,l$R.y,l$w),l$L_.scale(l$z.max,l$R.y,l$x),l$L_.add(l$i.min,l$w,l$w),l$L_.add(l$i.max,l$x,l$x),l$L_.min(l$i.min,l$w,l$i.min),l$L_.max(l$i.max,l$w,l$i.max);var l$P=new l$di(new l$L_,new l$L_),l$B=l$P.min,l$n=l$P.max;l$L_.scale(l$z.min,l$R.x,l$B),l$L_.scale(l$z.max,l$R.x,l$n),l$L_.min(l$P.min,l$n,l$w),l$L_.max(l$P.min,l$n,l$x),l$L_.min(l$i.min,l$w,l$i.min),l$L_.max(l$i.max,l$w,l$i.max)},l$_.cloneTo=function(l$i){l$i.enable=this.enable},l$_.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$i}()),l$U=function(){function l$z(){}return l$J(l$z,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),l$z._randomPointUnitArcCircle=function(l$i,l$_,l$R){var l$r=l$_.elements,l$b=NaN;l$b=l$R?l$R.getFloat()*l$i:Math.random()*l$i,l$r[0]=Math.cos(l$b),l$r[1]=Math.sin(l$b)},l$z._randomPointInsideUnitArcCircle=function(l$i,l$_,l$R){var l$r=l$_.elements;l$z._randomPointUnitArcCircle(l$i,l$_,l$R);var l$b=NaN;l$b=l$R?Math.pow(l$R.getFloat(),.5):Math.pow(Math.random(),.5),l$r[0]=l$r[0]*l$b,l$r[1]=l$r[1]*l$b},l$z._randomPointUnitCircle=function(l$i,l$_){var l$R=l$i.elements,l$r=NaN;l$r=l$_?l$_.getFloat()*Math.PI*2:Math.random()*Math.PI*2,l$R[0]=Math.cos(l$r),l$R[1]=Math.sin(l$r)},l$z._randomPointInsideUnitCircle=function(l$i,l$_){var l$R=l$i.elements;l$z._randomPointUnitCircle(l$i);var l$r=NaN;l$r=l$_?Math.pow(l$_.getFloat(),.5):Math.pow(Math.random(),.5),l$R[0]=l$R[0]*l$r,l$R[1]=l$R[1]*l$r},l$z._randomPointUnitSphere=function(l$i,l$_){var l$R=l$i.elements,l$r=NaN,l$b=NaN;l$b=l$_?(l$r=l$R[2]=2*l$_.getFloat()-1,l$_.getFloat()*Math.PI*2):(l$r=l$R[2]=2*Math.random()-1,Math.random()*Math.PI*2);var l$z=Math.sqrt(1-l$r*l$r);l$R[0]=l$z*Math.cos(l$b),l$R[1]=l$z*Math.sin(l$b)},l$z._randomPointInsideUnitSphere=function(l$i,l$_){var l$R=l$i.elements;l$z._randomPointUnitSphere(l$i);var l$r=NaN;l$r=l$_?Math.pow(l$_.getFloat(),1/3):Math.pow(Math.random(),1/3),l$R[0]=l$R[0]*l$r,l$R[1]=l$R[1]*l$r,l$R[2]=l$R[2]*l$r},l$z._randomPointInsideHalfUnitBox=function(l$i,l$_){var l$R=l$i.elements;l$_?(l$R[0]=l$_.getFloat()-.5,l$R[1]=l$_.getFloat()-.5,l$R[2]=l$_.getFloat()-.5):(l$R[0]=Math.random()-.5,l$R[1]=Math.random()-.5,l$R[2]=Math.random()-.5)},l$z}(),l$g=(function(){function l$i(l$i){this._size=null,this.enbale=!1,this._size=l$i}l$J(l$i,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_.cloneTo=function(l$i){var l$_=l$i;this._size.cloneTo(l$_._size),l$_.enbale=this.enbale},l$_.clone=function(){var l$i;switch(this._size.type){case 0:l$i=this._size.separateAxes?l$O.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):l$O.createByGradient(this._size.gradient.clone());break;case 1:l$i=this._size.separateAxes?l$O.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):l$O.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:l$i=this._size.separateAxes?l$O.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):l$O.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var l$_=new this.constructor(l$i);return l$_.enbale=this.enbale,l$_},l$h(0,l$_,"size",function(){return this._size})}(),function(){function l$r(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}l$J(l$r,"laya.d3.core.particleShuriKen.module.StartFrame");var l$i=l$r.prototype;return l$c.imps(l$i,{"laya.d3.core.IClone":!0}),l$i.cloneTo=function(l$i){var l$_=l$i;l$_._type=this._type,l$_._constant=this._constant,l$_._constantMin=this._constantMin,l$_._constantMax=this._constantMax},l$i.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$i,"constant",function(){return this._constant}),l$h(0,l$i,"type",function(){return this._type}),l$h(0,l$i,"constantMin",function(){return this._constantMin}),l$h(0,l$i,"constantMax",function(){return this._constantMax}),l$r.createByConstant=function(l$i){var l$_=new l$r;return l$_._type=0,l$_._constant=l$i,l$_},l$r.createByRandomTwoConstant=function(l$i,l$_){var l$R=new l$r;return l$R._type=1,l$R._constantMin=l$i,l$R._constantMax=l$_,l$R},l$r}()),l$V=(function(){function l$i(l$i,l$_){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new l$z_(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=l$i,this._startFrame=l$_}l$J(l$i,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_.cloneTo=function(l$i){var l$_=l$i;this.tiles.cloneTo(l$_.tiles),l$_.type=this.type,l$_.randomRow=this.randomRow,this._frame.cloneTo(l$_._frame),this._startFrame.cloneTo(l$_._startFrame),l$_.cycles=this.cycles,l$_.enableUVChannels=this.enableUVChannels,l$_.enable=this.enable},l$_.clone=function(){var l$i,l$_;switch(this._frame.type){case 0:l$i=l$p.createByConstant(this._frame.constant);break;case 1:l$i=l$p.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:l$i=l$p.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:l$i=l$p.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:l$_=l$g.createByConstant(this._startFrame.constant);break;case 1:l$_=l$g.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var l$R=new this.constructor(l$i,l$_);return this.tiles.cloneTo(l$R.tiles),l$R.type=this.type,l$R.randomRow=this.randomRow,l$R.cycles=this.cycles,l$R.enableUVChannels=this.enableUVChannels,l$R.enable=this.enable,l$R},l$h(0,l$_,"frame",function(){return this._frame}),l$h(0,l$_,"startFrame",function(){return this._startFrame})}(),function(){function l$i(l$i){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=l$i}l$J(l$i,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_.cloneTo=function(l$i){var l$_=l$i;this._velocity.cloneTo(l$_._velocity),l$_.enbale=this.enbale,l$_.space=this.space},l$_.clone=function(){var l$i;switch(this._velocity.type){case 0:l$i=l$E.createByConstant(this._velocity.constant.clone());break;case 1:l$i=l$E.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:l$i=l$E.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:l$i=l$E.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var l$_=new this.constructor(l$i);return l$_.enbale=this.enbale,l$_.space=this.space,l$_},l$h(0,l$_,"velocity",function(){return this._velocity})}(),function(){function l$i(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new l$f_,this._vb=l$s_.create(l$i._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=l$E_.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=l$K_.nameKey.getID("LINE"),this._shaderCompile=l$Z_._preCompileShader[this._sharderNameID]}l$J(l$i,"laya.d3.core.PhasorSpriter3D");var l$_=l$i.prototype;return l$_.line=function(l$i,l$_,l$R,l$r){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(l$i.x,l$i.y,l$i.z,l$_.x,l$_.y,l$_.z,l$_.w),this.addVertex(l$R.x,l$R.y,l$R.z,l$r.x,l$r.y,l$r.z,l$r.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},l$_.circle=function(l$i,l$_,l$R,l$r,l$b,l$z){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*l$_,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/l$_,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*l$i,Math.cos(this._tempNumver0)*l$i,0,l$R,l$r,l$b,l$z),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},l$_.plane=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=l$r/2,this._tempNumver1=l$b/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(l$i-this._tempNumver0,l$_+this._tempNumver1,l$R,l$z,l$L,l$w,l$x),this.addVertex(l$i+this._tempNumver0,l$_+this._tempNumver1,l$R,l$z,l$L,l$w,l$x),this.addVertex(l$i-this._tempNumver0,l$_-this._tempNumver1,l$R,l$z,l$L,l$w,l$x),this.addVertex(l$i+this._tempNumver0,l$_-this._tempNumver1,l$R,l$z,l$L,l$w,l$x),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},l$_.box=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=l$r/2,this._tempNumver1=l$b/2,this._tempNumver2=l$z/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(l$i-this._tempNumver0,l$_+this._tempNumver1,l$R+this._tempNumver2,l$L,l$w,l$x,l$P),this.addVertex(l$i+this._tempNumver0,l$_+this._tempNumver1,l$R+this._tempNumver2,l$L,l$w,l$x,l$P),this.addVertex(l$i-this._tempNumver0,l$_-this._tempNumver1,l$R+this._tempNumver2,l$L,l$w,l$x,l$P),this.addVertex(l$i+this._tempNumver0,l$_-this._tempNumver1,l$R+this._tempNumver2,l$L,l$w,l$x,l$P),this.addVertex(l$i+this._tempNumver0,l$_+this._tempNumver1,l$R-this._tempNumver2,l$L,l$w,l$x,l$P),this.addVertex(l$i-this._tempNumver0,l$_+this._tempNumver1,l$R-this._tempNumver2,l$L,l$w,l$x,l$P),this.addVertex(l$i+this._tempNumver0,l$_-this._tempNumver1,l$R-this._tempNumver2,l$L,l$w,l$x,l$P),this.addVertex(l$i-this._tempNumver0,l$_-this._tempNumver1,l$R-this._tempNumver2,l$L,l$w,l$x,l$P),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},l$_.cone=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*l$R+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*l$R>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/l$R,this.addVertexIndex(0,l$_,0,l$r,l$b,l$z,l$L,this._tempUint0),this.addVertexIndex(0,0,0,l$r,l$b,l$z,l$L,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<l$R;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(l$i*this._tempNumver2,0,l$i*this._tempNumver3,l$r,l$b,l$z,l$L,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==l$R-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(l$i*this._tempNumver2,0,l$i*this._tempNumver3,l$r,l$b,l$z,l$L,this._tempUint0+(this._tempInt0+l$R)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==l$R-1?this.addIndexes(this._tempUint1+l$R+2):this.addIndexes(this._tempUint1+this._tempInt0+l$R+1),this.addIndexes(this._tempUint1+this._tempInt0+l$R),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},l$_.boundingBoxLine=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(l$i,l$b,l$z,l$L,l$w,l$x,l$P),this.addVertex(l$r,l$b,l$z,l$L,l$w,l$x,l$P),this.addVertex(l$i,l$_,l$z,l$L,l$w,l$x,l$P),this.addVertex(l$r,l$_,l$z,l$L,l$w,l$x,l$P),this.addVertex(l$r,l$b,l$R,l$L,l$w,l$x,l$P),this.addVertex(l$i,l$b,l$R,l$L,l$w,l$x,l$P),this.addVertex(l$r,l$_,l$R,l$L,l$w,l$x,l$P),this.addVertex(l$i,l$_,l$R,l$L,l$w,l$x,l$P),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},l$_.addVertex=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=l$i,this._vbData[this._posInVBData+1]=l$_,this._vbData[this._posInVBData+2]=l$R,this._vbData[this._posInVBData+3]=l$r,this._vbData[this._posInVBData+4]=l$b,this._vbData[this._posInVBData+5]=l$z,this._vbData[this._posInVBData+6]=l$L,this._posInVBData+=this._floatSizePerVer,this},l$_.addVertexIndex=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){return this._hasBegun||this.addVertexIndexException(),this._vbData[l$w]=l$i,this._vbData[l$w+1]=l$_,this._vbData[l$w+2]=l$R,this._vbData[l$w+3]=l$r,this._vbData[l$w+4]=l$b,this._vbData[l$w+5]=l$z,this._vbData[l$w+6]=l$L,(l$w+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=l$w),this},l$_.addIndexes=function(l$i){var l$_=arguments;this._hasBegun||this.addVertexIndexException();for(var l$R=0;l$R<l$_.length;l$R++)this._ibData[this._posInIBData]=l$_[l$R],this._posInIBData++;return this},l$_.begin=function(l$i,l$_){return this._hasBegun&&this.beginException0(),1!==l$i&&4!==l$i&&this.beginException1(),this._primitiveType=l$i,this._camera=l$_,this._hasBegun=!0,this},l$_.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},l$_.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(l$i._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),l$Z.drawCall++,l$$.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},l$_.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},l$_.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},l$_.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},l$_.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},l$_.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},l$_.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(28,[new l$Li(0,"vector3",0),new l$Li(12,"vector4",1)])}]),l$i}()),l$y=function(){function l$i(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++l$i._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new l$f_}l$J(l$i,"laya.d3.core.render.RenderElement");var l$_=l$i.prototype;return l$_.getDynamicBatchBakedVertexs=function(l$i){for(var l$_=this._renderObj._getVertexBuffer(l$i),l$R=l$_.getData().slice(),l$r=l$_.vertexDeclaration,l$b=l$r.getVertexElementByUsage(0).offset/4,l$z=l$r.getVertexElementByUsage(3).offset/4,l$L=this._sprite3D.transform,l$w=l$L.worldMatrix,l$x=l$L.rotation,l$P=l$r.vertexStride/4,l$B=0,l$n=l$R.length;l$B<l$n;l$B+=l$P){var l$f=l$B+l$b,l$J=l$B+l$z;l$N_.transformVector3ArrayToVector3ArrayCoordinate(l$R,l$f,l$w,l$R,l$f),l$N_.transformVector3ArrayByQuat(l$R,l$J,l$x,l$R,l$J)}return l$R},l$_.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},l$_._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},l$h(0,l$_,"id",function(){return this._id}),l$h(0,l$_,"renderObj",function(){return this._renderObj},function(l$i){this._renderObj!==l$i&&(this._renderObj=l$i)}),l$i._uniqueIDCounter=0,l$i}(),l$a=function(){function l$_(l$i){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++l$_._uniqueIDCounter,this._needSort=!1,this._scene=l$i,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}l$J(l$_,"laya.d3.core.render.RenderQueue");var l$i=l$_.prototype;return l$i._sortOpaqueFunc=function(l$i,l$_){if(l$i._render&&l$_._render){var l$R=l$i._material.renderQueue-l$_._material.renderQueue;return 0==l$R?l$i._render._distanceForSort-l$_._render._distanceForSort:l$R}return 0},l$i._sortAlphaFunc=function(l$i,l$_){if(l$i._render&&l$_._render){var l$R=l$i._material.renderQueue-l$_._material.renderQueue;return 0==l$R?l$_._render._distanceForSort-l$i._render._distanceForSort:l$R}return 0},l$i._begainRenderElement=function(l$i,l$_,l$R){return!!l$_._beforeRender(l$i)},l$i._sortAlpha=function(l$i){l$_._cameraPosition=l$i,this._finalElements.sort(this._sortAlphaFunc)},l$i._sortOpaque=function(l$i){l$_._cameraPosition=l$i,this._finalElements.sort(this._sortOpaqueFunc)},l$i._preRender=function(l$i){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},l$i._render=function(l$i,l$_){for(var l$R,l$r,l$b,l$z,l$L,l$w,l$x=l$Z.loopCount,l$P=this._scene,l$B=l$i.camera,l$n=(l$B.id,!1),l$f=0,l$J=this._finalElements.length;l$f<l$J;l$f++){var l$h,l$M,l$N,l$X=this._finalElements[l$f];if(null!=l$X._onPreRenderFunction&&l$X._onPreRenderFunction.call(l$X._sprite3D,l$i),0===l$X._type){if(l$i.owner=l$N=l$X._sprite3D,l$i.renderElement=l$X,l$N._preRenderUpdateComponents(l$i),l$h=l$X.renderObj,l$M=l$X._material,this._begainRenderElement(l$i,l$h,l$M)){if(l$R=l$h._getVertexBuffers(),!(l$b=(l$r=l$h._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[l$r.id]){this._errorRecord[l$r.id]=1;var l$t="vertexBuffer:"+("("+l$r._destroyed+","+l$r._released+","+l$r._referenceCount+","+l$r._buffer+")")+", material:"+(l$M?l$M.__className+"("+l$M._destroyed+","+l$M._released+")":"null")+", owner:"+(l$N?l$N.__className+"("+l$N._destroyed+","+l$N._activeInHierarchy+","+l$N._displayedInStage+")":"null")+", renderObj:"+(l$h?l$h.__className+"("+l$h._destroyed+","+l$h._released+","+l$h._referenceCount+")":"")+", parent:, url:"+(l$N?l$N.url:"")+", disposeStack:"+l$r.disposeStack;l$c.recordError("报错：unknown vertexDeclaration  "+l$t)}continue}if(l$n=(l$z=l$i._shader=l$M._getShader(l$P._shaderDefineValue,l$b.shaderDefineValue,l$N._shaderDefineValue)).bind()||l$x!==l$z._uploadLoopCount,l$R){if(l$z._uploadVertexBuffer!==l$R||l$n){for(var l$I=0;l$I<l$R.length;l$I++){var l$e=l$R[l$I];l$z.uploadAttributesX(l$e.vertexDeclaration.shaderValues.data,l$e)}l$z._uploadVertexBuffer=l$R}}else(l$z._uploadVertexBuffer!==l$r||l$n)&&(l$z.uploadAttributes(l$b.shaderValues.data,null),l$z._uploadVertexBuffer=l$r);(l$z._uploadScene!==l$P||l$n)&&(l$z.uploadSceneUniforms(l$P._shaderValues.data),l$z._uploadScene=l$P),(l$B!==l$z._uploadCamera||l$z._uploadSprite3D!==l$N||l$n)&&(l$z.uploadSpriteUniforms(l$N._shaderValues.data),l$z._uploadSprite3D=l$N),(l$B!==l$z._uploadCamera||l$n)&&(l$z.uploadCameraUniforms(l$B._shaderValues.data),l$z._uploadCamera=l$B),(l$z._uploadMaterial!==l$M||l$n)&&(l$M._upload(),l$z._uploadMaterial=l$M),l$L!==l$M?(l$M._setRenderStateBlendDepth(),l$M._setRenderStateFrontFace(l$_,l$N.transform),l$L=l$M,l$w=l$N):l$w!==l$N&&(l$M._setRenderStateFrontFace(l$_,l$N.transform),l$w=l$N),l$h._render(l$i),l$z._uploadLoopCount=l$x}l$N._postRenderUpdateComponents(l$i)}else if(2===l$X._type){l$X.renderObj;l$i.owner=l$N=l$X._sprite3D,l$i.renderElement=l$X,l$i._batchIndexStart=l$X._tempBatchIndexStart,l$i._batchIndexEnd=l$X._tempBatchIndexEnd,l$h=l$X.renderObj,l$M=l$X._material,this._begainRenderElement(l$i,l$h,l$M)&&(l$b=(l$r=l$h._getVertexBuffer(0)).vertexDeclaration,l$n=(l$z=l$i._shader=l$M._getShader(l$P._shaderDefineValue,l$b.shaderDefineValue,l$N._shaderDefineValue)).bind()||l$x!==l$z._uploadLoopCount,(l$z._uploadVertexBuffer!==l$r||l$n)&&(l$z.uploadAttributes(l$b.shaderValues.data,null),l$z._uploadVertexBuffer=l$r),(l$z._uploadScene!==l$P||l$n)&&(l$z.uploadSceneUniforms(l$P._shaderValues.data),l$z._uploadScene=l$P),(l$B!==l$z._uploadCamera||l$z._uploadSprite3D!==l$N||l$n)&&(l$z.uploadSpriteUniforms(l$N._shaderValues.data),l$z._uploadSprite3D=l$N),(l$B!==l$z._uploadCamera||l$n)&&(l$z.uploadCameraUniforms(l$B._shaderValues.data),l$z._uploadCamera=l$B),(l$z._uploadMaterial!==l$M||l$n)&&(l$M._upload(),l$z._uploadMaterial=l$M),l$L!==l$M?(l$M._setRenderStateBlendDepth(),l$M._setRenderStateFrontFace(l$_,l$N.transform),l$L=l$M,l$w=l$N):l$w!==l$N&&(l$M._setRenderStateFrontFace(l$_,l$N.transform),l$w=l$N),l$h._render(l$i),l$z._uploadLoopCount=l$x)}}},l$i._renderShadow=function(l$i,l$_){for(var l$R,l$r,l$b,l$z,l$L,l$w=l$Z.loopCount,l$x=this._scene,l$P=l$i.camera,l$B=!1,l$n=0,l$f=this._finalElements.length;l$n<l$f;l$n++){var l$J,l$h,l$M,l$N=this._finalElements[l$n];0===l$N._type&&(l$i.owner=l$M=l$N._sprite3D,l$_||l$M._projectionViewWorldUpdateCamera===l$P&&l$M._projectionViewWorldUpdateLoopCount===l$Z.loopCount||(l$M._render._renderUpdate(l$i._projectionViewMatrix),l$M._projectionViewWorldUpdateLoopCount=l$Z.loopCount,l$M._projectionViewWorldUpdateCamera=l$P),l$i.renderElement=l$N,l$M._preRenderUpdateComponents(l$i),l$J=l$N.renderObj,l$h=l$N._material,this._begainRenderElement(l$i,l$J,null)&&(l$r=(l$R=l$J._getVertexBuffer(0)).vertexDeclaration,l$B=(l$b=l$i._shader=l$h._getShader(l$x._shaderDefineValue,l$r.shaderDefineValue,l$M._shaderDefineValue)).bind()||l$w!==l$b._uploadLoopCount,(l$b._uploadVertexBuffer!==l$R||l$B)&&(l$b.uploadAttributes(l$r.shaderValues.data,null),l$b._uploadVertexBuffer=l$R),(l$P!==l$b._uploadCamera||l$b._uploadSprite3D!==l$M||l$B)&&(l$b.uploadSpriteUniforms(l$M._shaderValues.data),l$b._uploadSprite3D=l$M),(l$P!==l$b._uploadCamera||l$B)&&(l$b.uploadCameraUniforms(l$P._shaderValues.data),l$b._uploadCamera=l$P),(l$b._uploadMaterial!==l$h||l$B)&&(l$h._upload(),l$b._uploadMaterial=l$h),l$b._uploadRenderElement,l$z!==l$h?(l$h._setRenderStateFrontFace(!1,l$M.transform),l$z=l$h,l$L=l$M):l$L!==l$M&&(l$h._setRenderStateFrontFace(!1,l$M.transform),l$L=l$M),l$J._render(l$i),l$b._uploadLoopCount=l$w),l$M._postRenderUpdateComponents(l$i))}},l$i._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},l$i._addRenderElement=function(l$i){this._renderElements.push(l$i),this._needSort=!0},l$i._addDynamicBatchElement=function(l$i){this._dynamicBatchCombineRenderElements.push(l$i)},l$h(0,l$i,"id",function(){return this._id}),l$_._uniqueIDCounter=0,l$_._cameraPosition=null,l$_}(),l$F=function(){function l$i(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return l$J(l$i,"laya.d3.core.render.RenderState"),l$i.clientWidth=0,l$i.clientHeight=0,l$i}(),l$d=function(){function l$L(l$i,l$_){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new l$Hi(new l$L_,0),this._corners=[new l$L_,new l$L_,new l$L_,new l$L_,new l$L_,new l$L_,new l$L_,new l$L_],this._boundingBoxCenter=new l$L_,this._children=l$r(8),this._objects=[],this._tempBoundBoxCorners=[new l$L_,new l$L_,new l$L_,new l$L_,new l$L_,new l$L_,new l$L_,new l$L_],this._scene=l$i,this._currentDepth=l$_}l$J(l$L,"laya.d3.core.scene.OctreeNode");var l$i=l$L.prototype;return l$c.imps(l$i,{"laya.d3.core.scene.ITreeNode":!0}),l$i.init=function(l$i,l$_){var l$R=new l$L_,l$r=new l$L_;l$L_.scale(l$_,-.5,l$R),l$L_.scale(l$_,.5,l$r),l$L_.add(l$R,l$i,l$R),l$L_.add(l$r,l$i,l$r),this.exactBox=new l$di(l$R,l$r),this.relaxBox=new l$di(l$R,l$r)},l$i.addTreeNode=function(l$i){1===Collision.boxContainsBox(this._relaxBox,l$i.boundingBox)?this.addNodeDown(l$i,0):this.addObject(l$i)},l$i.addChild=function(l$i){var l$_=this._children[l$i];if(null==l$_){l$_=new l$L(this._scene,this._currentDepth+1),(this._children[l$i]=l$_)._parent=this,l$L_.subtract(this._exactBox.max,this._exactBox.min,l$L.tempSize),l$L_.multiply(l$L.tempSize,l$L._octreeSplit[l$i],l$L.tempCenter),l$L_.add(this._exactBox.min,l$L.tempCenter,l$L.tempCenter),l$L_.scale(l$L.tempSize,.25,l$L.tempSize);var l$R=new l$L_,l$r=new l$L_;l$L_.subtract(l$L.tempCenter,l$L.tempSize,l$R),l$L_.add(l$L.tempCenter,l$L.tempSize,l$r),l$_.exactBox=new l$di(l$R,l$r),l$L_.scale(l$L.tempSize,l$L.relax,l$L.tempSize);var l$b=new l$L_,l$z=new l$L_;l$L_.subtract(l$L.tempCenter,l$L.tempSize,l$b),l$L_.add(l$L.tempCenter,l$L.tempSize,l$z),l$_.relaxBox=new l$di(l$b,l$z)}return l$_},l$i.addObject=function(l$i){(l$i._treeNode=this)._objects.push(l$i)},l$i.removeObject=function(l$i){if(l$i._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var l$_=this._objects.indexOf(l$i);return-1!==l$_&&(this._objects.splice(l$_,1),!0)},l$i.clearObject=function(){this._objects.length=0},l$i.addNodeUp=function(l$i,l$_){this._parent&&1!==Collision.boxContainsBox(this._exactBox,l$i.boundingBox)?this._parent.addNodeUp(l$i,l$_-1):this.addNodeDown(l$i,l$_)},l$i.addNodeDown=function(l$i,l$_){if(l$_<this._scene.treeLevel){var l$R=this.inChildIndex(l$i.boundingBoxCenter),l$r=this.addChild(l$R);1===Collision.boxContainsBox(l$r._relaxBox,l$i.boundingBox)?l$r.addNodeDown(l$i,++l$_):this.addObject(l$i)}else this.addObject(l$i)},l$i.inChildIndex=function(l$i){return 4*(l$i.z<this._boundingBoxCenter.z?0:1)+2*(l$i.y<this._boundingBoxCenter.y?0:1)+(l$i.x<this._boundingBoxCenter.x?0:1)},l$i.updateObject=function(l$i){1===Collision.boxContainsBox(this._relaxBox,l$i.boundingBox)?(this.removeObject(l$i),l$i._treeNode=null,this.addNodeDown(l$i,this._currentDepth)):this._parent&&(this.removeObject(l$i),l$i._treeNode=null,this._parent.addNodeUp(l$i,this._currentDepth-1))},l$i.cullingObjects=function(l$i,l$_,l$R,l$r,l$b){var l$z,l$L=0,l$w=0,l$x=0,l$P=this._scene._dynamicBatchManager;for(l$L=0,l$z=this._objects.length;l$L<l$z;l$L++){var l$B=this._objects[l$L];if(l$o.isVisible(l$B._owner.layer.mask)&&l$B.enable){if(l$_&&(l$Z.treeSpriteCollision+=1,0===l$i.containsBoundSphere(l$B.boundingSphere)))continue;l$B._renderUpdate(l$b),l$B._distanceForSort=l$L_.distance(l$B.boundingSphere.center,l$r)+l$B.sortingFudge;var l$n=l$B._renderElements;for(l$w=0,l$x=l$n.length;l$w<l$x;l$w++){var l$f=l$n[l$w],l$J=l$f._staticBatch;if(l$J&&l$J._material===l$f._material)l$J._addBatchRenderElement(l$f);else{var l$h=l$f.renderObj;l$h.triangleCount<10&&1===l$h._vertexBufferCount&&l$h._getIndexBuffer()&&l$f._material.renderQueue<2&&l$f._canDynamicBatch&&!l$B._owner.isStatic?l$P._addPrepareRenderElement(l$f):this._scene.getRenderQueue(l$f._material.renderQueue)._addRenderElement(l$f)}}}}for(l$L=0;l$L<8;l$L++){var l$M=this._children[l$L];if(null!=l$M){var l$N=l$_;if(l$_){var l$X=l$i.containsBoundBox(l$M._relaxBox);if(l$Z.treeNodeCollision+=1,0===l$X)continue;l$N=2===l$X}l$M.cullingObjects(l$i,l$N,l$R,l$r,l$b)}}},l$i.cullingShadowObjects=function(l$i,l$_,l$R,l$r,l$b){var l$z,l$L=0,l$w=0,l$x=0;this._scene._dynamicBatchManager;for(l$L=0,l$z=this._objects.length;l$L<l$z;l$L++){var l$P=this._objects[l$L];if(l$P.castShadow&&l$o.isVisible(l$P._owner.layer.mask)&&l$P.enable){if(l$R&&0===l$i[0].containsBoundSphere(l$P.boundingSphere))continue;for(var l$B=1,l$n=l$i.length;l$B<l$n;l$B++){var l$f=l$_[l$B-1];if(0!==l$i[l$B].containsBoundSphere(l$P.boundingSphere)){var l$J=l$P._renderElements;for(l$w=0,l$x=l$J.length;l$w<l$x;l$w++)l$f._addRenderElement(l$J[l$w])}}}}for(l$L=0;l$L<8;l$L++){var l$h=this._children[l$L];if(null!=l$h){var l$M=l$R;if(l$R){var l$N=l$i[0].containsBoundBox(l$h._relaxBox);if(0===l$N)continue;l$M=2===l$N}l$h.cullingShadowObjects(l$i,l$_,l$M,l$r,l$b)}}},l$i.cullingShadowObjectsOnePSSM=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L,l$w=l$_[0],l$x=0,l$P=0,l$B=0;for(l$x=0,l$L=this._objects.length;l$x<l$L;l$x++){var l$n=this._objects[l$x];if(l$n.castShadow&&l$o.isVisible(l$n._owner.layer.mask)&&l$n.enable){if(l$r&&0===l$i.containsBoundSphere(l$n.boundingSphere))continue;l$n._renderUpdate(l$R);var l$f=l$n._renderElements;for(l$P=0,l$B=l$f.length;l$P<l$B;l$P++)l$w._addRenderElement(l$f[l$P])}}for(l$x=0;l$x<8;l$x++){var l$J=this._children[l$x];if(null!=l$J){var l$h=l$r;if(l$r){var l$M=l$i.containsBoundBox(l$J._relaxBox);if(0===l$M)continue;l$h=2===l$M}l$J.cullingShadowObjectsOnePSSM(l$i,l$_,l$R,l$h,l$b,l$z)}}},l$i.renderBoudingBox=function(l$i){this._renderBoudingBox(l$i);for(var l$_=0;l$_<8;++l$_){var l$R=this._children[l$_];l$R&&l$R.renderBoudingBox(l$i)}},l$i.buildAllChild=function(l$i){if(l$i<this._scene.treeLevel)for(var l$_=0;l$_<8;l$_++){this.addChild(l$_).buildAllChild(l$i+1)}},l$i._renderBoudingBox=function(l$i){},l$h(0,l$i,"exactBox",function(){return this._exactBox},function(l$i){this._exactBox=l$i,l$L_.add(l$i.min,l$i.max,this._boundingBoxCenter),l$L_.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),l$h(0,l$i,"relaxBox",function(){return this._relaxBox},function(l$i){(this._relaxBox=l$i).getCorners(this._corners),l$Hi.createfromPoints(this._corners,this._boundingSphere)}),l$L.debugMode=!1,l$L.relax=1.15,l$L.CHILDNUM=8,l$n(l$L,["tempVector0",function(){return this.tempVector0=new l$L_},"tempSize",function(){return this.tempSize=new l$L_},"tempCenter",function(){return this.tempCenter=new l$L_},"_octreeSplit",function(){return this._octreeSplit=[new l$L_(.25,.25,.25),new l$L_(.75,.25,.25),new l$L_(.25,.75,.25),new l$L_(.75,.75,.25),new l$L_(.25,.25,.75),new l$L_(.75,.25,.75),new l$L_(.25,.75,.75),new l$L_(.75,.75,.75)]}]),l$L}(),l$Q=(function(){function l$i(){}l$J(l$i,"laya.d3.core.scene.SceneManager")}(),function(){function l$i(l$i,l$_,l$R,l$r){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===l$i&&(l$i=1),void 0===l$_&&(l$_=1),void 0===l$R&&(l$R=1),void 0===l$r&&(l$r=1),this._r=l$i,this._g=l$_,this._b=l$R,this._a=l$r}return l$J(l$i,"laya.d3.core.trail.module.Color",null,"Color$1"),l$i.prototype.cloneTo=function(l$i){l$i._r=this._r,l$i._g=this._g,l$i._b=this._b,l$i._a=this._a},l$n(l$i,["RED",function(){return this.RED=new l$i(1,0,0,1)},"GREEN",function(){return this.GREEN=new l$i(0,1,0,1)},"BLUE",function(){return this.BLUE=new l$i(0,0,1,1)},"CYAN",function(){return this.CYAN=new l$i(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new l$i(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new l$i(1,0,1,1)},"GRAY",function(){return this.GRAY=new l$i(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new l$i(1,1,1,1)},"BLACK",function(){return this.BLACK=new l$i(0,0,0,1)}]),l$i}()),l$H=(function(){function l$i(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}l$J(l$i,"laya.d3.core.trail.module.Gradient");var l$_=l$i.prototype;l$_.setKeys=function(l$i,l$_){var l$R,l$r;this._colorKeys=l$i;for(var l$b=this.index=0;l$b<l$i.length;l$b++){var l$z=(l$R=l$i[l$b]).color;this._colorKeyData[this.index++]=l$z._r,this._colorKeyData[this.index++]=l$z._g,this._colorKeyData[this.index++]=l$z._b,this._colorKeyData[this.index++]=l$R.time}this._alphaKeys=l$_;for(var l$L=this.index=0;l$L<l$_.length;l$L++)l$r=l$_[l$L],this._alphaKeyData[this.index++]=l$r.alpha,this._alphaKeyData[this.index++]=l$r.time},l$_.cloneTo=function(l$i){var l$_=0,l$R=0,l$r=this.colorKeys,l$b=[];for(l$_=0,l$R=l$r.length;l$_<l$R;l$_++){var l$z=new l$W;l$r[l$_].cloneTo(l$z),l$b.push(l$z)}var l$L=this.alphaKeys,l$w=[];for(l$_=0,l$R=l$L.length;l$_<l$R;l$_++){var l$x=new l$H;l$L[l$_].cloneTo(l$x),l$w.push(l$x)}l$i.setKeys(l$b,l$w)},l$h(0,l$_,"mode",function(){return this._mode},function(l$i){this._mode=l$i}),l$h(0,l$_,"colorKeys",function(){return this._colorKeys},function(l$i){this._colorKeys=l$i;for(var l$_=this.index=0;l$_<l$i.length;l$_++){var l$R=l$i[l$_],l$r=l$R.color;this._colorKeyData[this.index++]=l$r._r,this._colorKeyData[this.index++]=l$r._g,this._colorKeyData[this.index++]=l$r._b,this._colorKeyData[this.index++]=l$R.time}}),l$h(0,l$_,"alphaKeys",function(){return this._alphaKeys},function(l$i){this._alphaKeys=l$i;for(var l$_=this.index=0;l$_<l$i.length;l$_++){var l$R=l$i[l$_];this._alphaKeyData[this.index++]=l$R.alpha,this._alphaKeyData[this.index++]=l$R.time}})}(),function(){function l$i(l$i,l$_){this._alpha=NaN,this._time=NaN,void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),this._alpha=l$i,this._time=l$_}l$J(l$i,"laya.d3.core.trail.module.GradientAlphaKey");var l$_=l$i.prototype;return l$_.cloneTo=function(l$i){l$i.alpha=this.alpha,l$i.time=this.time},l$h(0,l$_,"alpha",function(){return this._alpha},function(l$i){this._alpha=l$i}),l$h(0,l$_,"time",function(){return this._time},function(l$i){this._time=l$i}),l$i}()),l$W=function(){function l$i(l$i,l$_){this._color=null,this._time=NaN,void 0===l$_&&(l$_=0),this._color=l$i||new l$Q,this._time=l$_}l$J(l$i,"laya.d3.core.trail.module.GradientColorKey");var l$_=l$i.prototype;return l$_.cloneTo=function(l$i){this.color.cloneTo(l$i.color),l$i.time=this.time},l$h(0,l$_,"color",function(){return this._color},function(l$i){this._color=l$i}),l$h(0,l$_,"time",function(){return this._time},function(l$i){this._time=l$i}),l$i}(),l$T=(function(){function l$i(){}l$J(l$i,"laya.d3.core.trail.module.GradientMode"),l$i.Blend=0,l$i.Fixed=1}(),function(){function l$i(){}l$J(l$i,"laya.d3.core.trail.module.TextureMode"),l$i.Stretch=0,l$i.Tile=1}(),function(){function l$i(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}l$J(l$i,"laya.d3.core.trail.module.TrailKeyFrame"),l$i.prototype.cloneTo=function(l$i){l$i.time=this.time,l$i.inTangent=this.inTangent,l$i.outTangent=this.outTangent,l$i.value=this.value}}(),function(){function l$_(l$i){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new l$L_,this._curPosition=new l$L_,this._delVector3=new l$L_,this._lastFixedVertexPosition=new l$L_,this._pointAtoBVector3=new l$L_,this._pointA=new l$L_,this._pointB=new l$L_,this._owner=l$i,this._id=l$_.renderElementCount++,0==this._id?l$i._owner.transform.position.cloneTo(this._lastPosition):l$i._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new l$s_(l$T.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new l$s_(l$T.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}l$J(l$_,"laya.d3.core.trail.TrailRenderElement");var l$i=l$_.prototype;l$c.imps(l$i,{"laya.d3.core.render.IRenderable":!0}),l$i._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},l$i._addTrailByFirstPosition=function(l$i,l$_){l$L_.subtract(l$_,l$i,this._delVector3),l$L_.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),l$L_.normalize(this._pointAtoBVector3,this._pointAtoBVector3),l$L_.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(l$i),l$i.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},l$i._addTrailByNextPosition=function(l$i){l$L_.subtract(l$i,this._lastFixedVertexPosition,this._delVector3),l$L_.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),l$L_.normalize(this._pointAtoBVector3,this._pointAtoBVector3),l$L_.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=l$L_.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=l$Wi.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(l$i),l$i.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(l$i),this._virtualVerticesCount=2)},l$i._updateVerticesByPosition=function(l$i){this._pointe=l$i.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},l$i._updateVertexBuffer2=function(){var l$i,l$_=0,l$R=0,l$r=0;for(l$r=0,l$i=(this._verticesCount+this._virtualVerticesCount)/2;l$r<l$i;l$r++)l$R=0==this._owner.textureMode?(this._VerticesToTailLength[l$r]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[l$r],this._vertices2[l$_++]=1-l$R,this._vertices2[l$_++]=1-l$R;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},l$i._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},l$i._updateDisappear=function(){var l$i,l$_=0;for(l$_=this._curDisappearIndex,l$i=(this._verticesCount+this._virtualVerticesCount)/2;l$_<l$i;l$_++)this._owner._curtime-this._everyGroupVertexBirthTime[l$_]>=this._owner.time+l$Wi.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},l$i._beforeRender=function(l$i){return this._camera=l$i.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),l$L_.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},l$i._render=function(l$i){this._isDead||(l$$.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),l$Z.drawCall++,l$Z.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},l$i._getVertexBuffer=function(l$i){return void 0===l$i&&(l$i=0),0===l$i?this._vertexBuffer1:1===l$i?this._vertexBuffer2:null},l$i._getVertexBuffers=function(){return this._vertexBuffers},l$i._getIndexBuffer=function(){return null},l$i.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},l$i._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},l$h(0,l$i,"_vertexBufferCount",function(){return this._vertexBuffers.length}),l$h(0,l$i,"triangleCount",function(){return 0}),l$_.renderElementCount=0}(),function(){function l$i(){}l$J(l$i,"laya.d3.core.trail.VertexTrail");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration1}),l$h(1,l$i,"vertexDeclaration1",function(){return l$i._vertexDeclaration1}),l$h(1,l$i,"vertexDeclaration2",function(){return l$i._vertexDeclaration2}),l$n(l$i,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new l$zi(32,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",41),new l$Li(24,"single",33),new l$Li(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new l$zi(4,[new l$Li(0,"single",38)])}]),l$i}()),l$ii=function(){function l$e(l$i){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=l$i}l$J(l$e,"laya.d3.graphics.DynamicBatch");var l$i=l$e.prototype;return l$c.imps(l$i,{"laya.d3.core.render.IRenderable":!0}),l$i._getVertexBuffer=function(l$i){return void 0===l$i&&(l$i=0),0===l$i?this._vertexBuffer:null},l$i._getIndexBuffer=function(){return this._indexBuffer},l$i._getCombineRenderElementFromPool=function(l$i,l$_,l$R){var l$r=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return l$r||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=l$r=new l$y,l$r._sprite3D=new l$a_),l$r._sprite3D._render._renderUpdate(l$R),l$r},l$i._getRenderElement=function(l$i,l$_,l$R){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*l$e.maxVertexCount),this._indexDatas=new Uint16Array(l$e.maxIndexCount),this._vertexBuffer=l$s_.create(this._vertexDeclaration,l$e.maxVertexCount,35048),this._indexBuffer=l$E_.create("ushort",l$e.maxIndexCount,35048));for(var l$r=this._merageElements.length=0,l$b=0,l$z=0,l$L=this._combineRenderElements.length;l$z<l$L;l$z++){var l$w=this._combineRenderElements[l$z],l$x=l$w.getDynamicBatchBakedVertexs(0),l$P=l$w.getBakedIndices(),l$B=l$w._sprite3D.transform._isFrontFaceInvert,l$n=l$r/(this._vertexDeclaration.vertexStride/4),l$f=l$b,l$J=l$f+l$P.length;l$w._tempBatchIndexStart=l$f,l$w._tempBatchIndexEnd=l$J,this._indexDatas.set(l$P,l$b);var l$h=0;if(l$B)for(l$h=l$f;l$h<l$J;l$h+=3){this._indexDatas[l$h]=l$n+this._indexDatas[l$h];var l$M=this._indexDatas[l$h+1],l$N=this._indexDatas[l$h+2];this._indexDatas[l$h+1]=l$n+l$N,this._indexDatas[l$h+2]=l$n+l$M}else for(l$h=l$f;l$h<l$J;l$h+=3)this._indexDatas[l$h]=l$n+this._indexDatas[l$h],this._indexDatas[l$h+1]=l$n+this._indexDatas[l$h+1],this._indexDatas[l$h+2]=l$n+this._indexDatas[l$h+2];l$b+=l$P.length,this._vertexDatas.set(l$x,l$r),l$r+=l$x.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),l$z=this._combineRenderElementPoolIndex=0,l$L=this._materials.length;l$z<l$L;l$z++){var l$X=this._getCombineRenderElementFromPool(l$i,l$_,l$R);l$X._type=2,l$X._staticBatch=null;var l$t=(l$X.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[l$z]]._tempBatchIndexStart,l$I=l$z+1===this._materialToRenderElementsOffsets.length?l$b:this._combineRenderElements[this._materialToRenderElementsOffsets[l$z+1]]._tempBatchIndexStart;l$X._tempBatchIndexStart=l$t,l$X._tempBatchIndexEnd=l$I,l$X._material=this._materials[l$z],this._merageElements.push(l$X)}},l$i._addCombineRenderObjTest=function(l$i){var l$_=l$i.renderObj,l$R=this._currentCombineIndexCount+l$_._getIndexBuffer().indexCount,l$r=this._currentCombineVertexCount+l$_._getVertexBuffer().vertexCount;return!(l$e.maxVertexCount<l$r||l$e.maxIndexCount<l$R)},l$i._addCombineRenderObj=function(l$i){var l$_=l$i.renderObj;this._combineRenderElements.push(l$i),this._currentCombineIndexCount=this._currentCombineIndexCount+l$_._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+l$_._getVertexBuffer().vertexCount},l$i._addCombineMaterial=function(l$i){this._materials.push(l$i)},l$i._addMaterialToRenderElementOffset=function(l$i){this._materialToRenderElementsOffsets.push(l$i)},l$i._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},l$i._addToRenderQueue=function(l$i,l$_,l$R,l$r){this._getRenderElement(l$_,l$R,l$r);for(var l$b=0,l$z=this._materials.length;l$b<l$z;l$b++)l$i.getRenderQueue(this._materials[l$b].renderQueue)._addDynamicBatchElement(this._merageElements[l$b])},l$i._beforeRender=function(l$i){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},l$i._render=function(l$i){var l$_=l$i._batchIndexEnd-l$i._batchIndexStart;l$$.mainContext.drawElements(4,l$_,5123,2*l$i._batchIndexStart),l$Z.drawCall++,l$Z.trianglesFaces+=l$_/3},l$i._getVertexBuffers=function(){return null},l$h(0,l$i,"_vertexBufferCount",function(){return 1}),l$h(0,l$i,"triangleCount",function(){return this._indexBuffer.indexCount/3}),l$h(0,l$i,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),l$e.maxVertexCount=2e4,l$e.maxIndexCount=4e4,l$e.maxCombineTriangleCount=10,l$e}(),l$_i=function(){function l$e(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}l$J(l$e,"laya.d3.graphics.DynamicBatchManager");var l$i=l$e.prototype;return l$i.getDynamicBatch=function(l$i,l$_){var l$R,l$r=l$i.id.toString()+l$_;return this._dynamicBatches[l$r]?l$R=this._dynamicBatches[l$r]:this._dynamicBatches[l$r]=l$R=new l$ii(l$i),l$R},l$i._garbageCollection=function(){for(var l$i in this._dynamicBatches)0===this._dynamicBatches[l$i].combineRenderElementsCount&&delete this._dynamicBatches[l$i]},l$i._addPrepareRenderElement=function(l$i){this._prepareDynamicBatchCombineElements.push(l$i)},l$i._finishCombineDynamicBatch=function(l$i){var l$_,l$R,l$r;this._prepareDynamicBatchCombineElements.sort(l$e._sortPrepareDynamicBatch);for(var l$b,l$z,l$L,l$w,l$x,l$P=-1,l$B=!0,l$n=0,l$f=-1,l$J=0,l$h=this._prepareDynamicBatchCombineElements.length;l$J<l$h;l$J++){var l$M=(l$z=this._prepareDynamicBatchCombineElements[l$J]).renderObj._getVertexBuffer(0).vertexDeclaration,l$N=l$R!==l$M;l$N&&(l$n=0,l$R=l$M);var l$X=l$n!==l$P;if(l$X&&(l$P=l$n),(l$N||l$X)&&(l$L=this.getDynamicBatch(l$M,l$n),l$_=null),l$B)if(l$L._addCombineRenderObjTest(l$z)){if(l$_!==(l$b=l$z._material))l$w&&(l$i.getRenderQueue(l$x._material.renderQueue)._addRenderElement(l$x),l$x=l$w=null,l$f=-1),l$w=l$b,l$f=l$L.combineRenderElementsCount,l$x=l$z,l$_=l$b;else if(l$w){var l$t=l$x.renderObj,l$I=l$z.renderObj;l$t._getVertexBuffer().vertexCount+l$I._getVertexBuffer().vertexCount>l$ii.maxVertexCount||l$t._getIndexBuffer().indexCount+l$I._getIndexBuffer().indexCount>l$ii.maxIndexCount?(l$i.getRenderQueue(l$x._material.renderQueue)._addRenderElement(l$x),l$w=l$b,l$f=l$L.combineRenderElementsCount,l$x=l$z):(l$L._addCombineMaterial(l$w),l$L._addMaterialToRenderElementOffset(l$f),l$L._addCombineRenderObj(l$x),l$x=l$w=null,l$f=-1,l$L._addCombineRenderObj(l$z))}else l$L._addCombineRenderObj(l$z);l$B=!0}else l$w&&(l$i.getRenderQueue(l$x._material.renderQueue)._addRenderElement(l$x),l$x=l$w=null,l$f=-1),l$n++,l$B=!1;else l$r=this._prepareDynamicBatchCombineElements[l$J-1],l$L._addMaterialToRenderElementOffset(l$L.combineRenderElementsCount),l$_=l$r._material,l$L._addCombineMaterial(l$_),l$L._addCombineRenderObj(l$r),l$B=!0,l$_!==(l$b=l$z._material)?(l$w=l$b,l$f=l$L.combineRenderElementsCount,l$x=l$z):l$L._addCombineRenderObj(l$z),l$_=l$b}l$w&&(l$i.getRenderQueue(l$x._material.renderQueue)._addRenderElement(l$x),l$x=l$w=null,l$f=-1),this._prepareDynamicBatchCombineElements.length=0},l$i._clearRenderElements=function(){for(var l$i in this._dynamicBatches)this._dynamicBatches[l$i]._clearRenderElements()},l$i._addToRenderQueue=function(l$i,l$_,l$R,l$r){for(var l$b in this._dynamicBatches){var l$z=this._dynamicBatches[l$b];0<l$z.combineRenderElementsCount&&l$z._addToRenderQueue(l$i,l$_,l$R,l$r)}},l$i.dispose=function(){this._dynamicBatches=null},l$e._sortPrepareDynamicBatch=function(l$i,l$_){return l$i._mainSortID-l$_._mainSortID},l$e}(),l$Ri=function(){function l$i(){}return l$J(l$i,"laya.d3.graphics.FrustumCulling"),l$i.renderShadowObjectCulling=function(l$i,l$_,l$R,l$r,l$b){var l$z=0,l$L=0,l$w=0,l$x=0;for(l$z=0,l$w=l$R.length;l$z<l$w;l$z++){var l$P=l$R[l$z];l$P&&l$P._clearRenderElements()}var l$B,l$n,l$f,l$J=l$i._cullingRenders;if(1<l$b){for(l$z=0,l$w=l$i._cullingRendersLength;l$z<l$w;l$z++)if((l$B=l$J[l$z]).castShadow&&l$o.isVisible(l$B._owner.layer.mask)&&l$B.enable)for(var l$h=1,l$M=l$_.length;l$h<l$M;l$h++)if(l$n=l$R[l$h-1],0!==l$_[l$h].containsBoundSphere(l$B.boundingSphere))for(l$L=0,l$x=(l$f=l$B._renderElements).length;l$L<l$x;l$L++)l$n._addRenderElement(l$f[l$L])}else for(l$z=0,l$w=l$i._cullingRendersLength;l$z<l$w;l$z++)if((l$B=l$J[l$z]).castShadow&&l$o.isVisible(l$B._owner.layer.mask)&&l$B.enable&&0!==l$_[0].containsBoundSphere(l$B.boundingSphere))for(l$B._renderUpdate(l$r),l$n=l$R[0],l$L=0,l$x=(l$f=l$B._renderElements).length;l$L<l$x;l$L++)l$n._addRenderElement(l$f[l$L])},l$i.renderShadowObjectCullingOctree=function(l$i,l$_,l$R,l$r,l$b){for(var l$z=0,l$L=l$R.length;l$z<l$L;l$z++){var l$w=l$R[l$z];l$w&&l$w._clearRenderElements()}1<l$b?l$i.treeRoot.cullingShadowObjects(l$_,l$R,!0,0,l$i):l$i.treeRoot.cullingShadowObjectsOnePSSM(l$_[0],l$R,l$r,!0,0,l$i)},l$i.renderObjectCulling=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=0,l$w=0,l$x=0,l$P=0,l$B=l$_._quenes,l$n=l$_._dynamicBatchManager,l$f=l$_._cullingRenders;for(l$L=0,l$w=l$B.length;l$L<l$w;l$L++){var l$J=l$B[l$L];l$J&&l$J._clearRenderElements()}var l$h=l$ri._staticBatchManagers;for(l$L=0,l$w=l$h.length;l$L<l$w;l$L++)l$h[l$L]._clearRenderElements();l$n._clearRenderElements();var l$M=l$R.transform.position;for(l$L=0,l$w=l$_._cullingRendersLength;l$L<l$w;l$L++){var l$N=l$f[l$L];if(l$o.isVisible(l$N._owner.layer.mask)&&l$N.enable&&0!==l$i.containsBoundSphere(l$N.boundingSphere)&&l$N._renderUpdate(l$z)){l$N._distanceForSort=l$L_.distance(l$N.boundingSphere.center,l$M)+l$N.sortingFudge;var l$X=l$N._renderElements;for(l$x=0,l$P=l$X.length;l$x<l$P;l$x++){var l$t=l$X[l$x],l$I=l$t._staticBatch;if(l$I&&l$I._material===l$t._material)l$I._addBatchRenderElement(l$t);else{var l$e=l$t.renderObj;l$e.triangleCount<10&&1===l$e._vertexBufferCount&&l$e._getIndexBuffer()&&l$t._material.renderQueue<2&&l$t._canDynamicBatch&&!l$N._owner.isStatic?l$n._addPrepareRenderElement(l$t):l$_.getRenderQueue(l$t._material.renderQueue)._addRenderElement(l$t)}}}}for(l$L=0,l$w=l$h.length;l$L<l$w;l$L++)l$h[l$L]._addToRenderQueue(l$_,l$r,l$b,l$z);l$n._finishCombineDynamicBatch(l$_),l$n._addToRenderQueue(l$_,l$r,l$b,l$z)},l$i.renderObjectCullingOctree=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=0,l$w=0,l$x=l$_._quenes,l$P=l$_._dynamicBatchManager;for(l$L=0,l$w=l$x.length;l$L<l$w;l$L++){var l$B=l$x[l$L];l$B&&l$B._clearRenderElements()}var l$n=l$ri._staticBatchManagers;for(l$L=0,l$w=l$n.length;l$L<l$w;l$L++)l$n[l$L]._clearRenderElements();for(l$P._clearRenderElements(),l$_._cullingRenders.length=0,l$_.treeRoot.cullingObjects(l$i,!0,0,l$R.transform.position,l$z),l$L=0,l$w=l$n.length;l$L<l$w;l$L++)l$n[l$L]._addToRenderQueue(l$_,l$r,l$b,l$z);l$P._finishCombineDynamicBatch(l$_),l$P._addToRenderQueue(l$_,l$r,l$b,l$z)},l$i.renderObjectCullingNoBoundFrustum=function(l$i,l$_,l$R,l$r,l$b){var l$z=0,l$L=0,l$w=0,l$x=0,l$P=l$i._quenes,l$B=l$i._dynamicBatchManager,l$n=l$i._cullingRenders;for(l$z=0,l$L=l$P.length;l$z<l$L;l$z++){var l$f=l$P[l$z];l$f&&l$f._clearRenderElements()}var l$J=l$ri._staticBatchManagers;for(l$z=0,l$L=l$J.length;l$z<l$L;l$z++)l$J[l$z]._clearRenderElements();l$B._clearRenderElements();var l$h=l$_.transform.position;for(l$z=0,l$L=l$i._cullingRendersLength;l$z<l$L;l$z++){var l$M=l$n[l$z];if(l$o.isVisible(l$M._owner.layer.mask)&&l$M.enable){l$M._renderUpdate(l$b),l$M._distanceForSort=l$L_.distance(l$M.boundingSphere.center,l$h)+l$M.sortingFudge;var l$N=l$M._renderElements;for(l$w=0,l$x=l$N.length;l$w<l$x;l$w++){var l$X=l$N[l$w],l$t=l$X._staticBatch;if(l$t&&l$t._material===l$X._material)l$t._addBatchRenderElement(l$X);else{var l$I=l$X.renderObj;l$I.triangleCount<10&&1===l$I._vertexBufferCount&&l$I._getIndexBuffer()&&l$X._material.renderQueue<2&&l$X._canDynamicBatch&&!l$M._owner.isStatic?l$B._addPrepareRenderElement(l$X):l$i.getRenderQueue(l$X._material.renderQueue)._addRenderElement(l$X)}}}}for(l$z=0,l$L=l$J.length;l$z<l$L;l$z++)l$J[l$z]._addToRenderQueue(l$i,l$R,l$r,l$b);l$B._finishCombineDynamicBatch(l$i),l$B._addToRenderQueue(l$i,l$R,l$r,l$b)},l$i}(),l$ri=function(){function l$z(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}l$J(l$z,"laya.d3.graphics.StaticBatchManager");var l$i=l$z.prototype;return l$i._finishInit=function(){for(var l$i in this._staticBatches)this._staticBatches[l$i]._finishInit();this._initBatchRenderElements.length=0},l$i._initStaticBatchs=function(l$i){throw new Error("StaticBatchManager:must override this function.")},l$i._addInitBatchSprite=function(l$i){for(var l$_=l$i._render._renderElements,l$R=0,l$r=l$_.length;l$R<l$r;l$R++)this._initBatchRenderElements.push(l$_[l$R])},l$i._clearRenderElements=function(){for(var l$i in this._staticBatches)this._staticBatches[l$i]._clearRenderElements()},l$i._garbageCollection=function(l$i){var l$_=l$i._staticBatch,l$R=l$_._initBatchRenderElements,l$r=l$R.indexOf(l$i);l$R.splice(l$r,1),0===l$R.length&&(l$_.dispose(),delete this._staticBatches[l$_._key])},l$i._addToRenderQueue=function(l$i,l$_,l$R,l$r){for(var l$b in this._staticBatches){var l$z=this._staticBatches[l$b];0<l$z._batchRenderElements.length&&l$z._updateToRenderQueue(l$i,l$r)}},l$i.dispose=function(){this._staticBatches=null},l$z._addToStaticBatchQueue=function(l$i){l$i instanceof laya.d3.core.RenderableSprite3D&&l$i._addToInitStaticBatchManager();for(var l$_=0,l$R=l$i.numChildren;l$_<l$R;l$_++)l$z._addToStaticBatchQueue(l$i._childs[l$_])},l$z.combine=function(l$i,l$_){var l$R,l$r=0,l$b=0;if(l$_)for(l$r=0,l$b=l$_.length;l$r<l$b;l$r++){l$_[l$r]._addToInitStaticBatchManager()}else l$i&&l$z._addToStaticBatchQueue(l$i);for(l$r=0,l$b=l$z._staticBatchManagers.length;l$r<l$b;l$r++)(l$R=l$z._staticBatchManagers[l$r])._initStaticBatchs(l$i),l$R._finishInit()},l$z._staticBatchManagers=[],l$z}(),l$bi=function(){function l$i(l$i,l$_,l$R){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=l$i,this._manager=l$_,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=l$R}l$J(l$i,"laya.d3.graphics.StaticBatch");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),l$_._binarySearch=function(l$i){for(var l$_=0,l$R=this._batchRenderElements.length-1,l$r=0;l$_<=l$R;)l$r=Math.floor((l$_+l$R)/2),this._compareBatchRenderElement(this._batchRenderElements[l$r],l$i)?l$R=l$r-1:l$_=l$r+1;return l$_},l$_._compareBatchRenderElement=function(l$i,l$_){throw new Error("StaticBatch:must override this function.")},l$_._getVertexDecLightMap=function(l$i){return l$i===l$Ei.vertexDeclaration?l$oi.vertexDeclaration:l$i===l$Oi.vertexDeclaration?l$ui.vertexDeclaration:l$i===l$qi.vertexDeclaration?l$ei.vertexDeclaration:l$i===l$mi.vertexDeclaration?null:l$i===l$Mi.vertexDeclaration?l$Ni.vertexDeclaration:l$i===l$Yi.vertexDeclaration?l$ki.vertexDeclaration:l$i===l$$i.vertexDeclaration?l$Gi.vertexDeclaration:l$i===l$si.vertexDeclaration?l$pi.vertexDeclaration:l$i===l$Oi.vertexDeclaration?l$ui.vertexDeclaration:l$i===l$ji.vertexDeclaration?l$ci.vertexDeclaration:l$i===l$mi.vertexDeclaration?null:l$i===l$Mi.vertexDeclaration?l$Ni.vertexDeclaration:l$i===l$Ci.vertexDeclaration?l$Ki.vertexDeclaration:l$i===l$$i.vertexDeclaration?l$Gi.vertexDeclaration:l$i},l$_._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},l$_._addBatchRenderElement=function(l$i){this._batchRenderElements.splice(this._binarySearch(l$i),0,l$i)},l$_._updateToRenderQueue=function(l$i,l$_){this._combineRenderElementPoolIndex=0,this._getRenderElement(l$i.getRenderQueue(this._material.renderQueue)._renderElements,l$i,l$_)},l$_._getRenderElement=function(l$i,l$_,l$R){throw new Error("StaticBatch:must override this function.")},l$_._finishInit=function(){throw new Error("StaticBatch:must override this function.")},l$_._clearRenderElements=function(){this._batchRenderElements.length=0},l$_.dispose=function(){},l$_._getVertexBuffer=function(l$i){return void 0===l$i&&(l$i=0),null},l$_._getIndexBuffer=function(){return null},l$_._beforeRender=function(l$i){return!0},l$_._render=function(l$i){},l$_._getVertexBuffers=function(){return null},l$h(0,l$_,"_vertexBufferCount",function(){return 1}),l$h(0,l$_,"triangleCount",function(){return 0}),l$i.combine=function(l$i){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),l$ri.combine(l$i)},l$i.maxBatchVertexCount=65535,l$i}(),l$zi=function(){function l$L(l$i,l$_){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++l$L._uniqueIDCounter,this._id>l$L.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",l$L.maxVertexDeclaration);this._shaderValues=new l$f_,this._vertexElementsDic={},this._vertexStride=l$i,this._vertexElements=l$_;for(var l$R=0;l$R<l$_.length;l$R++){var l$r=l$_[l$R],l$b=l$r.elementUsage;this._vertexElementsDic[l$b]=l$r;var l$z=[l$L._getTypeSize(l$r.elementFormat)/4,5126,!1,this._vertexStride,l$r.offset];switch(this._shaderValues.setValue(l$b,l$z),l$b){case 1:this._addShaderDefine(l$Z_.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(l$Z_.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(l$Z_.SHADERDEFINE_UV1)}}}l$J(l$L,"laya.d3.graphics.VertexDeclaration");var l$i=l$L.prototype;return l$i._addShaderDefine=function(l$i){this._shaderDefineValue|=l$i},l$i._removeShaderDefine=function(l$i){this._shaderDefineValue&=~l$i},l$i.getVertexElements=function(){return this._vertexElements.slice()},l$i.getVertexElementByUsage=function(l$i){return this._vertexElementsDic[l$i]},l$i.unBinding=function(){},l$h(0,l$i,"shaderDefineValue",function(){return this._shaderDefineValue}),l$h(0,l$i,"id",function(){return this._id}),l$h(0,l$i,"vertexStride",function(){return this._vertexStride}),l$h(0,l$i,"shaderValues",function(){return this._shaderValues}),l$L._getTypeSize=function(l$i){switch(l$i){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},l$L.getVertexStride=function(l$i){for(var l$_=0,l$R=0;l$R<l$i.Length;l$R++){var l$r=l$i[l$R],l$b=l$r.offset+l$L._getTypeSize(l$r.elementFormat);l$_<l$b&&(l$_=l$b)}return l$_},l$L._maxVertexDeclarationBit=1e3,l$L._uniqueIDCounter=1,l$n(l$L,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),l$L}(),l$Li=function(){function l$i(l$i,l$_,l$R){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=l$i,this.elementFormat=l$_,this.elementUsage=l$R}return l$J(l$i,"laya.d3.graphics.VertexElement"),l$i}(),l$wi=(function(){function l$i(){}l$J(l$i,"laya.d3.graphics.VertexElementFormat"),l$i.Single="single",l$i.Vector2="vector2",l$i.Vector3="vector3",l$i.Vector4="vector4",l$i.Color="color",l$i.Byte4="byte4",l$i.Short2="short2",l$i.Short4="short4",l$i.NormalizedShort2="normalizedshort2",l$i.NormalizedShort4="normalizedshort4",l$i.HalfVector2="halfvector2",l$i.HalfVector4="halfvector4"}(),function(){function l$i(){}l$J(l$i,"laya.d3.graphics.VertexElementUsage"),l$i.POSITION0=0,l$i.COLOR0=1,l$i.TEXTURECOORDINATE0=2,l$i.NORMAL0=3,l$i.BINORMAL0=4,l$i.TANGENT0=5,l$i.BLENDINDICES0=6,l$i.BLENDWEIGHT0=7,l$i.DEPTH0=8,l$i.FOG0=9,l$i.POINTSIZE0=10,l$i.SAMPLE0=11,l$i.TESSELLATEFACTOR0=12,l$i.COLOR1=13,l$i.NEXTTEXTURECOORDINATE0=14,l$i.TEXTURECOORDINATE1=15,l$i.NEXTTEXTURECOORDINATE1=16,l$i.CORNERTEXTURECOORDINATE0=17,l$i.VELOCITY0=18,l$i.STARTCOLOR0=19,l$i.STARTSIZE=20,l$i.AGEADDSCALE0=21,l$i.STARTROTATION=22,l$i.ENDCOLOR0=23,l$i.STARTLIFETIME=24,l$i.TIME0=33,l$i.SHAPEPOSITIONSTARTLIFETIME=30,l$i.DIRECTIONTIME=32,l$i.SIZEROTATION0=27,l$i.RADIUS0=28,l$i.RADIAN0=29,l$i.STARTSPEED=31,l$i.RANDOM0=34,l$i.RANDOM1=35,l$i.SIMULATIONWORLDPOSTION=36,l$i.SIMULATIONWORLDROTATION=37,l$i.TEXTURECOORDINATE0X=38,l$i.TEXTURECOORDINATE0X1=39,l$i.TEXTURECOORDINATE0Y=40,l$i.OFFSETVECTOR=41}(),function(){function l$i(l$i,l$_,l$R){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=l$i,this._textureCoordinate0=l$_,this._time=l$R}l$J(l$i,"laya.d3.graphics.VertexGlitter");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate0}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"time",function(){return this._time}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(24,[new l$Li(0,"vector3",0),new l$Li(12,"vector2",2),new l$Li(20,"single",33)])}])}(),function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=l$i,this._position=l$_,this._velocity=l$R,this._startColor=l$r,this._endColor=l$b,this._sizeRotation=l$z,this._radius=l$L,this._radian=l$w,this._ageAddScale=l$x,this._time=l$P}l$J(l$i,"laya.d3.graphics.VertexParticle");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"endColor",function(){return this._endColor}),l$h(0,l$_,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),l$h(0,l$_,"sizeRotation",function(){return this._sizeRotation}),l$h(0,l$_,"velocity",function(){return this._velocity}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"startColor",function(){return this._startColor}),l$h(0,l$_,"radius",function(){return this._radius}),l$h(0,l$_,"radian",function(){return this._radian}),l$h(0,l$_,"ageAddScale",function(){return this._ageAddScale}),l$h(0,l$_,"time",function(){return this._time}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(116,[new l$Li(0,"vector4",17),new l$Li(16,"vector3",0),new l$Li(28,"vector3",18),new l$Li(40,"vector4",19),new l$Li(56,"vector4",23),new l$Li(72,"vector3",27),new l$Li(84,"vector2",28),new l$Li(92,"vector4",29),new l$Li(108,"single",24),new l$Li(112,"single",33)])}])}(),function(){function l$i(l$i){this._position=null,this._position=l$i}l$J(l$i,"laya.d3.graphics.VertexPosition");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(12,[new l$Li(0,"vector3",0)])}]),l$i}()),l$xi=function(){function l$i(l$i,l$_){this._position=null,this._normal=null,this._position=l$i,this._normal=l$_}l$J(l$i,"laya.d3.graphics.VertexPositionNormal");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(24,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3)])}]),l$i}(),l$Pi=function(){function l$i(l$i,l$_,l$R){this._position=null,this._normal=null,this._color=null,this._position=l$i,this._normal=l$_,this._color=l$R}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColor");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(40,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1)])}]),l$i}(),l$Bi=function(){function l$i(l$i,l$_,l$R,l$r,l$b){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._blendIndex=l$r,this._blendWeight=l$b}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorSkin");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(72,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector4",7),new l$Li(56,"vector4",6)])}]),l$i}(),l$ni=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._tangent=l$r,this._blendIndex=l$b,this._blendWeight=l$z}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(88,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector4",7),new l$Li(56,"vector4",6),new l$Li(72,"vector4",5)])}]),l$i}(),l$fi=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._tangent=l$r,this._blendIndex=l$b,this._blendWeight=l$z}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(84,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector4",7),new l$Li(56,"vector4",6),new l$Li(72,"vector3",5)])}]),l$i}(),l$Ji=function(){function l$i(l$i,l$_,l$R,l$r){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._tangent=l$r}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorSTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(56,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector4",5)])}]),l$i}(),l$hi=function(){function l$i(l$i,l$_,l$R,l$r){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._tangent=l$r}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(52,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector3",5)])}]),l$i}(),l$Mi=function(){function l$i(l$i,l$_,l$R,l$r){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._textureCoordinate=l$r}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTexture");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(48,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector2",2)])}]),l$i}(),l$Ni=function(){function l$i(l$i,l$_,l$R,l$r,l$b){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._textureCoordinate0=l$r,this._textureCoordinate1=l$b}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(56,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector2",2),new l$Li(48,"vector2",15)])}]),l$i}(),l$Xi=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._textureCoordinate0=l$r,this._textureCoordinate1=l$b,this._blendIndex=l$z,this._blendWeight=l$L}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(88,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector2",2),new l$Li(48,"vector2",15),new l$Li(56,"vector4",7),new l$Li(72,"vector4",6)])}]),l$i}(),l$ti=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._textureCoordinate0=l$r,this._textureCoordinate1=l$b,this._tangent=l$z,this._blendIndex=l$L,this._blendWeight=l$w}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(104,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector2",2),new l$Li(48,"vector2",15),new l$Li(56,"vector4",7),new l$Li(72,"vector4",6),new l$Li(88,"vector4",5)])}]),l$i}(),l$Ii=function(){function l$i(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$_.VertexPositionNormalColorTexture0SkinTangent=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){this._position=l$i,this._normal=l$_,this._color=l$R,this._textureCoordinate0=l$r,this._textureCoordinate1=l$b,this._tangent=l$z,this._blendIndex=l$L,this._blendWeight=l$w},l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(100,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector2",2),new l$Li(48,"vector2",15),new l$Li(56,"vector4",7),new l$Li(72,"vector4",6),new l$Li(88,"vector3",5)])}]),l$i}(),l$ei=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._textureCoordinate0=l$r,this._textureCoordinate1=l$b,this._tangent=l$z}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(72,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector2",2),new l$Li(48,"vector2",15),new l$Li(56,"vector4",5)])}]),l$i}(),l$ci=function(){function l$i(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$_.VertexPositionNormalColorTexture0Tangent=function(l$i,l$_,l$R,l$r,l$b,l$z){this._position=l$i,this._normal=l$_,this._color=l$R,this._textureCoordinate0=l$r,this._textureCoordinate1=l$b,this._tangent=l$z},l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(68,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector2",2),new l$Li(48,"vector2",15),new l$Li(56,"vector3",5)])}]),l$i}(),l$li=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._textureCoordinate=l$r,this._blendIndex=l$b,this._blendWeight=l$z}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(80,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector2",2),new l$Li(48,"vector4",7),new l$Li(64,"vector4",6)])}]),l$i}(),l$Ai=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._textureCoordinate=l$r,this._tangent=l$b,this._blendIndex=l$z,this._blendWeight=l$L}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(96,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector2",2),new l$Li(48,"vector4",7),new l$Li(64,"vector4",6),new l$Li(80,"vector4",5)])}]),l$i}(),l$Zi=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._textureCoordinate=l$r,this._tangent=l$b,this._blendIndex=l$z,this._blendWeight=l$L}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(92,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector2",2),new l$Li(48,"vector4",7),new l$Li(64,"vector4",6),new l$Li(80,"vector3",5)])}]),l$i}(),l$qi=function(){function l$i(l$i,l$_,l$R,l$r,l$b){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._textureCoordinate=l$r,this._tangent=l$b}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(64,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector2",2),new l$Li(48,"vector4",5)])}]),l$i}(),l$ji=function(){function l$i(l$i,l$_,l$R,l$r,l$b){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._color=l$R,this._textureCoordinate=l$r,this._tangent=l$b}l$J(l$i,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"color",function(){return this._color}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(60,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",1),new l$Li(40,"vector2",2),new l$Li(48,"vector3",5)])}]),l$i}(),l$Si=function(){function l$i(l$i,l$_,l$R){this._position=null,this._normal=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._tangent=l$R}l$J(l$i,"laya.d3.graphics.VertexPositionNormalSTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(40,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector4",5)])}]),l$i}(),l$vi=function(){function l$i(l$i,l$_,l$R){this._position=null,this._normal=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._tangent=l$R}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(36,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector3",5)])}]),l$i}(),l$$i=function(){function l$i(l$i,l$_,l$R){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=l$i,this._normal=l$_,this._textureCoordinate=l$R}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTexture");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(32,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2)])}]),l$i}(),l$Gi=function(){function l$i(l$i,l$_,l$R,l$r){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=l$i,this._normal=l$_,this._textureCoordinate0=l$R,this._textureCoordinate1=l$r}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(40,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2),new l$Li(32,"vector2",15)])}]),l$i}(),l$ui=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=l$i,this._normal=l$_,this._textureCoordinate0=l$R,this._textureCoordinate1=l$r,this._blendIndex=l$b,this._blendWeight=l$z}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(72,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2),new l$Li(32,"vector2",15),new l$Li(40,"vector4",7),new l$Li(56,"vector4",6)])}]),l$i}(),l$oi=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._textureCoordinate0=l$R,this._textureCoordinate1=l$r,this._tangent=l$b,this._blendIndex=l$z,this._blendWeight=l$L}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(88,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2),new l$Li(32,"vector2",15),new l$Li(40,"vector4",7),new l$Li(56,"vector4",6),new l$Li(72,"vector4",5)])}]),l$i}(),l$pi=function(){function l$i(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$_.VertexPositionNormalTexture0SkinTangent=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){this._position=l$i,this._normal=l$_,this._textureCoordinate0=l$R,this._textureCoordinate1=l$r,this._tangent=l$b,this._blendIndex=l$z,this._blendWeight=l$L},l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(84,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2),new l$Li(32,"vector2",15),new l$Li(40,"vector4",7),new l$Li(56,"vector4",6),new l$Li(72,"vector3",5)])}]),l$i}(),l$ki=function(){function l$i(l$i,l$_,l$R,l$r,l$b){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._textureCoordinate0=l$R,this._textureCoordinate1=l$r,this._tangent=l$b}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(56,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2),new l$Li(32,"vector2",15),new l$Li(40,"vector4",5)])}]),l$i}(),l$Ki=function(){function l$i(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$_.VertexPositionNormalTexture0Tangent=function(l$i,l$_,l$R,l$r,l$b){this._position=l$i,this._normal=l$_,this._textureCoordinate0=l$R,this._textureCoordinate1=l$r,this._tangent=l$b},l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(52,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2),new l$Li(32,"vector2",15),new l$Li(40,"vector3",5)])}]),l$i}(),l$Oi=function(){function l$i(l$i,l$_,l$R,l$r,l$b){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=l$i,this._normal=l$_,this._textureCoordinate=l$R,this._blendIndex=l$r,this._blendWeight=l$b}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTextureSkin");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(64,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2),new l$Li(32,"vector4",7),new l$Li(48,"vector4",6)])}]),l$i}(),l$Ei=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._textureCoordinate=l$R,this._tangent=l$r,this._blendIndex=l$b,this._blendWeight=l$z}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(80,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2),new l$Li(32,"vector4",7),new l$Li(48,"vector4",6),new l$Li(64,"vector4",5)])}]),l$i}(),l$si=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._textureCoordinate=l$R,this._tangent=l$r,this._blendIndex=l$b,this._blendWeight=l$z}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(76,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2),new l$Li(32,"vector4",7),new l$Li(48,"vector4",6),new l$Li(64,"vector3",5)])}]),l$i}(),l$Yi=function(){function l$i(l$i,l$_,l$R,l$r){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._textureCoordinate=l$R,this._tangent=l$r}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(48,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2),new l$Li(32,"vector4",5)])}]),l$i}(),l$Ci=function(){function l$i(l$i,l$_,l$R,l$r){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=l$i,this._normal=l$_,this._textureCoordinate=l$R,this._tangent=l$r}l$J(l$i,"laya.d3.graphics.VertexPositionNormalTextureTangent");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(44,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2),new l$Li(32,"vector3",5)])}]),l$i}(),l$mi=function(){function l$i(l$i,l$_,l$R){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=l$i,this._normal=l$_,this._textureCoordinate=l$R}l$J(l$i,"laya.d3.graphics.VertexPositionNTBTexture");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(56,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector3",5),new l$Li(36,"vector3",4),new l$Li(48,"vector2",2)])}]),l$i}(),l$Di=function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=l$i,this._normal=l$_,this._textureCoordinate0=l$r,this._textureCoordinate1=l$b,this._tangent=l$z,l$R=l$R,this._blendIndex=l$L,this._blendWeight=l$w}l$J(l$i,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"tangent",function(){return this._tangent}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(0,l$_,"textureCoordinate1",function(){return this._textureCoordinate1}),l$h(0,l$_,"blendIndex",function(){return this._blendIndex}),l$h(0,l$_,"blendWeight",function(){return this._blendWeight}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(96,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector3",5),new l$Li(36,"vector3",4),new l$Li(48,"vector2",2),new l$Li(56,"vector2",15),new l$Li(64,"vector4",7),new l$Li(80,"vector4",6)])}]),l$i}(),l$Ui=function(){function l$i(l$i,l$_,l$R){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=l$i,this._normal=l$_,this._textureCoordinate=l$R}l$J(l$i,"laya.d3.graphics.VertexPositionNTBTextureSkin");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"textureCoordinate",function(){return this._textureCoordinate}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(88,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector3",5),new l$Li(36,"vector3",4),new l$Li(48,"vector2",2),new l$Li(56,"vector4",7),new l$Li(72,"vector4",6)])}]),l$i}(),l$gi=(function(){function l$i(l$i,l$_,l$R,l$r){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=l$i,this._normal=l$_,this._textureCoord0=l$R,this._textureCoord1=l$r}l$J(l$i,"laya.d3.graphics.VertexPositionTerrain");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"normal",function(){return this._normal}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"textureCoord0",function(){return this._textureCoord0}),l$h(0,l$_,"textureCoord1",function(){return this._textureCoord1}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(40,[new l$Li(0,"vector3",0),new l$Li(12,"vector3",3),new l$Li(24,"vector2",2),new l$Li(32,"vector2",15)])}])}(),function(){function l$i(l$i,l$_){this._position=null,this._textureCoordinate0=null,this._position=l$i,this._textureCoordinate0=l$_}l$J(l$i,"laya.d3.graphics.VertexPositionTexture0");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"position",function(){return this._position}),l$h(0,l$_,"textureCoordinate0",function(){return this._textureCoordinate0}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(20,[new l$Li(0,"vector3",0),new l$Li(12,"vector2",2)])}]),l$i}()),l$Vi=(function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$n,l$f,l$J){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=l$i,this._positionStartLifeTime=l$_,this._velocity=l$R,this._startColor=l$r,this._startSize=l$b,this._startRotation0=l$z,this._startRotation1=l$L,this._startRotation2=l$w,this._startLifeTime=l$x,this._time=l$P,this._startSpeed=l$B,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=l$J}l$J(l$i,"laya.d3.graphics.VertexShurikenParticleBillboard");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),l$h(0,l$_,"random1",function(){return this._randoms1}),l$h(0,l$_,"startRotation2",function(){return this._startRotation2}),l$h(0,l$_,"positionStartLifeTime",function(){return this._positionStartLifeTime}),l$h(0,l$_,"velocity",function(){return this._velocity}),l$h(0,l$_,"random0",function(){return this._randoms0}),l$h(0,l$_,"startSize",function(){return this._startSize}),l$h(0,l$_,"startColor",function(){return this._startColor}),l$h(0,l$_,"startRotation0",function(){return this._startRotation0}),l$h(0,l$_,"startRotation1",function(){return this._startRotation1}),l$h(0,l$_,"startLifeTime",function(){return this._startLifeTime}),l$h(0,l$_,"time",function(){return this._time}),l$h(0,l$_,"startSpeed",function(){return this._startSpeed}),l$h(0,l$_,"simulationWorldPostion",function(){return this._simulationWorldPostion}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(152,[new l$Li(0,"vector4",17),new l$Li(16,"vector4",30),new l$Li(32,"vector4",32),new l$Li(48,"vector4",19),new l$Li(64,"vector3",20),new l$Li(76,"vector3",22),new l$Li(88,"single",31),new l$Li(92,"vector4",34),new l$Li(108,"vector4",35),new l$Li(124,"vector3",36),new l$Li(136,"vector4",37)])}])}(),function(){function l$i(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$n,l$f,l$J){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=l$i,this._positionStartLifeTime=l$_,this._velocity=l$R,this._startColor=l$r,this._startSize=l$b,this._startRotation0=l$z,this._startRotation1=l$L,this._startRotation2=l$w,this._startLifeTime=l$x,this._time=l$P,this._startSpeed=l$B,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=l$J}l$J(l$i,"laya.d3.graphics.VertexShurikenParticleMesh");var l$_=l$i.prototype;l$c.imps(l$_,{"laya.d3.graphics.IVertex":!0}),l$h(0,l$_,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),l$h(0,l$_,"velocity",function(){return this._velocity}),l$h(0,l$_,"position",function(){return this._positionStartLifeTime}),l$h(0,l$_,"random0",function(){return this._randoms0}),l$h(0,l$_,"startSize",function(){return this._startSize}),l$h(0,l$_,"startColor",function(){return this._startColor}),l$h(0,l$_,"startRotation0",function(){return this._startRotation0}),l$h(0,l$_,"startRotation1",function(){return this._startRotation1}),l$h(0,l$_,"random1",function(){return this._randoms1}),l$h(0,l$_,"startRotation2",function(){return this._startRotation2}),l$h(0,l$_,"startLifeTime",function(){return this._startLifeTime}),l$h(0,l$_,"time",function(){return this._time}),l$h(0,l$_,"startSpeed",function(){return this._startSpeed}),l$h(0,l$_,"simulationWorldPostion",function(){return this._simulationWorldPostion}),l$h(0,l$_,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$h(1,l$i,"vertexDeclaration",function(){return l$i._vertexDeclaration}),l$n(l$i,["_vertexDeclaration",function(){return this._vertexDeclaration=new l$zi(172,[new l$Li(0,"vector3",0),new l$Li(12,"vector4",1),new l$Li(28,"vector2",2),new l$Li(36,"vector4",30),new l$Li(52,"vector4",32),new l$Li(68,"vector4",19),new l$Li(84,"vector3",20),new l$Li(96,"vector3",22),new l$Li(108,"single",31),new l$Li(112,"vector4",34),new l$Li(128,"vector4",35),new l$Li(144,"vector3",36),new l$Li(156,"vector4",37)])}])}(),function(){function l$I(l$i,l$_,l$R,l$r,l$b,l$z){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=l$R,this._materials=l$r,this._subMeshes=l$b,this._materialMap=l$z,this._version=l$_,this._onLoaded(l$i)}l$J(l$I,"laya.d3.loaders.LoadModelV01");var l$i=l$I.prototype;return l$i._onLoaded=function(l$i){this._readData=l$i,this.READ_BLOCK();for(var l$_=0;l$_<this._BLOCK.count;l$_++){var l$R=this._readData.getUint16(),l$r=this._strings[l$R],l$b=this["READ_"+l$r];if(null==l$b)throw new Error("model file err,no this function:"+l$R+" "+l$r);if(!l$b.call(this))break}return this._mesh},l$i.onError=function(){},l$i._readString=function(){return this._strings[this._readData.getUint16()]},l$i.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},l$i.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},l$i.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var l$i=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var l$_=0;l$_<this._STRINGS.size;l$_++)this._strings[l$_]=this._readData.readUTFString();return this._readData.pos=l$i,!0},l$i.READ_MATERIAL=function(){var l$i=this._readData.getUint16(),l$_=(this._readString(),this._readString());return this._materials[l$i]="null"!==l$_?l$X.getRes(this._materialMap[l$_]):new l$v_,!0},l$i.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var l$i,l$_=this._readData.__getBuffer(),l$R=0,l$r=this._readData.getUint32(),l$b=this._readData.getUint32(),l$z=(new Float32Array(l$_.slice(l$r+this._DATA.offset,l$r+this._DATA.offset+l$b)),this._readData.getUint32()),l$L=this._readData.getUint32(),l$w=new Float32Array(l$_.slice(l$z+this._DATA.offset,l$z+this._DATA.offset+l$L));for(this.mesh._inverseBindPoses=[],l$R=0,l$i=l$w.length;l$R<l$i;l$R+=16){var l$x=new l$i_(l$w[l$R+0],l$w[l$R+1],l$w[l$R+2],l$w[l$R+3],l$w[l$R+4],l$w[l$R+5],l$w[l$R+6],l$w[l$R+7],l$w[l$R+8],l$w[l$R+9],l$w[l$R+10],l$w[l$R+11],l$w[l$R+12],l$w[l$R+13],l$w[l$R+14],l$w[l$R+15]);this.mesh._inverseBindPoses.push(l$x)}break;default:throw new Error("LoadModel:unknown version.")}return!0},l$i.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var l$i=this._readString();this._shaderAttributes=l$i.match(l$I._attrReg);var l$_=this._readData.getUint32(),l$R=this._readData.getUint32(),l$r=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),l$b=this._readData.getUint32(),l$z=this._readData.getUint32(),l$L=this._readData.getUint32(),l$w=this._readData.__getBuffer(),l$x=new l$P_(this._mesh),l$P=this._getVertexDeclaration(),l$B=l$s_.create(l$P,l$b/l$P.vertexStride,35044,!0),l$n=l$r+this._DATA.offset,l$f=l$w.slice(l$n,l$n+l$b);l$B.setData(new Float32Array(l$f));for(var l$J=(l$x._vertexBuffer=l$B).vertexDeclaration.getVertexElements(),l$h=0;l$h<l$J.length;l$h++)l$x._bufferUsage[l$J[l$h].elementUsage]=l$B;var l$M=l$E_.create("ushort",l$R/2,35044,!0),l$N=l$_+this._DATA.offset,l$X=l$w.slice(l$N,l$N+l$R);l$M.setData(new Uint16Array(l$X)),l$x._indexBuffer=l$M;var l$t=l$w.slice(l$z+this._DATA.offset,l$z+this._DATA.offset+l$L);return l$x._boneIndicesList[0]=new Uint8Array(l$t),this._subMeshes.push(l$x),!0},l$i.READ_DATAAREA=function(){return!1},l$i._getVertexDeclaration=function(){for(var l$i,l$_=!1,l$R=!1,l$r=!1,l$b=!1,l$z=!1,l$L=!1,l$w=!1,l$x=!1,l$P=!1,l$B=0;l$B<this._shaderAttributes.length;l$B+=8)switch(this._shaderAttributes[l$B]){case"POSITION":l$_=!0;break;case"NORMAL":l$R=!0;break;case"COLOR":l$r=!0;break;case"UV":l$b=!0;break;case"UV1":l$z=!0;break;case"BLENDWEIGHT":l$w=!0;break;case"BLENDINDICES":l$x=!0;break;case"TANGENT":l$L=!0;break;case"BINORMAL":l$P=!0}return l$_&&l$R&&l$r&&l$b&&l$z&&l$w&&l$x&&l$L?l$i=l$Ii.vertexDeclaration:l$_&&l$R&&l$r&&l$b&&l$z&&l$w&&l$x?l$i=l$Xi.vertexDeclaration:l$_&&l$R&&l$b&&l$z&&l$w&&l$x&&l$L?l$i=l$pi.vertexDeclaration:l$_&&l$R&&l$b&&l$z&&l$w&&l$x?l$i=l$ui.vertexDeclaration:l$_&&l$R&&l$r&&l$b&&l$w&&l$x&&l$L?l$i=l$Zi.vertexDeclaration:l$_&&l$R&&l$r&&l$b&&l$w&&l$x?l$i=l$li.vertexDeclaration:l$_&&l$R&&l$L&&l$P&&l$b&&l$w&&l$x?l$i=l$Ui.vertexDeclaration:l$_&&l$R&&l$b&&l$w&&l$x&&l$L?l$i=l$si.vertexDeclaration:l$_&&l$R&&l$b&&l$w&&l$x?l$i=l$Oi.vertexDeclaration:l$_&&l$R&&l$r&&l$w&&l$x&&l$L?l$i=l$fi.vertexDeclaration:l$_&&l$R&&l$r&&l$w&&l$x?l$i=l$Bi.vertexDeclaration:l$_&&l$R&&l$r&&l$b&&l$z&&l$L?l$i=l$ci.vertexDeclaration:l$_&&l$R&&l$r&&l$b&&l$z?l$i=l$Ni.vertexDeclaration:l$_&&l$R&&l$b&&l$z&&l$L?l$i=l$Ki.vertexDeclaration:l$_&&l$R&&l$b&&l$z?l$i=l$Gi.vertexDeclaration:l$_&&l$R&&l$r&&l$b&&l$L?l$i=l$ji.vertexDeclaration:l$_&&l$R&&l$b&&l$L&&l$P?l$i=l$mi.vertexDeclaration:l$_&&l$R&&l$r&&l$b?l$i=l$Mi.vertexDeclaration:l$_&&l$R&&l$b&&l$L?l$i=l$Ci.vertexDeclaration:l$_&&l$R&&l$b?l$i=l$$i.vertexDeclaration:l$_&&l$R&&l$r&&l$L?l$i=l$hi.vertexDeclaration:l$_&&l$R&&l$r&&(l$i=l$Pi.vertexDeclaration),l$i},l$h(0,l$i,"mesh",function(){return this._mesh}),l$I._attrReg=new RegExp("(\\w+)|([:,;])","g"),l$I}()),l$yi=function(){function l$A(){}return l$J(l$A,"laya.d3.loaders.LoadModelV02"),l$A.parse=function(l$i,l$_,l$R,l$r,l$b,l$z){l$A._mesh=l$R,l$A._materials=l$r,l$A._subMeshes=l$b,l$A._materialMap=l$z,l$A._version=l$_,l$A._readData=l$i,l$A.READ_DATA(),l$A.READ_BLOCK(),l$A.READ_STRINGS();for(var l$L=0,l$w=l$A._BLOCK.count;l$L<l$w;l$L++){l$A._readData.pos=l$A._BLOCK.blockStarts[l$L];var l$x=l$A._readData.getUint16(),l$P=l$A._strings[l$x],l$B=l$A["READ_"+l$P];if(null==l$B)throw new Error("model file err,no this function:"+l$x+" "+l$P);l$B.call()}l$A._strings.length=0,l$A._readData=null,l$A._version=null,l$A._mesh=null,l$A._materials=null,l$A._subMeshes=null,l$A._materialMap=null},l$A._readString=function(){return l$A._strings[l$A._readData.getUint16()]},l$A.READ_DATA=function(){l$A._DATA.offset=l$A._readData.getUint32(),l$A._DATA.size=l$A._readData.getUint32()},l$A.READ_BLOCK=function(){for(var l$i=l$A._BLOCK.count=l$A._readData.getUint16(),l$_=l$A._BLOCK.blockStarts=[],l$R=l$A._BLOCK.blockLengths=[],l$r=0;l$r<l$i;l$r++)l$_.push(l$A._readData.getUint32()),l$R.push(l$A._readData.getUint32())},l$A.READ_STRINGS=function(){var l$i=l$A._readData.getUint32(),l$_=l$A._readData.getUint16(),l$R=l$A._readData.pos;l$A._readData.pos=l$i+l$A._DATA.offset;for(var l$r=0;l$r<l$_;l$r++)l$A._strings[l$r]=l$A._readData.readUTFString();l$A._readData.pos=l$R},l$A.READ_MATERIAL=function(){l$A._readString(),l$A._readString();var l$i=l$A._readString();return""!==l$i&&l$A._materials.push(l$X.getRes(l$A._materialMap[l$i])),!0},l$A.READ_MESH=function(){l$A._readString();var l$i,l$_=l$A._readData.__getBuffer(),l$R=0,l$r=l$A._readData.getInt16(),l$b=l$A._DATA.offset;for(l$R=0;l$R<l$r;l$R++){var l$z=l$b+l$A._readData.getUint32(),l$L=l$A._readData.getUint32(),l$w=new Float32Array(l$_.slice(l$z,l$z+l$L)),l$x=l$A._readString().match(l$A._attrReg),l$P=l$A._getVertexDeclaration(l$x),l$B=l$s_.create(l$P,4*l$w.length/l$P.vertexStride,35044,!0);l$B.setData(l$w),l$A._mesh._vertexBuffers.push(l$B)}var l$n=l$b+l$A._readData.getUint32(),l$f=l$A._readData.getUint32(),l$J=new Uint16Array(l$_.slice(l$n,l$n+l$f)),l$h=l$E_.create("ushort",l$f/2,35044,!0);l$h.setData(l$J),l$A._mesh._indexBuffer=l$h;var l$M=l$A._mesh._boneNames=[],l$N=l$A._readData.getUint16();for(l$M.length=l$N,l$R=0;l$R<l$N;l$R++)l$M[l$R]=l$A._strings[l$A._readData.getUint16()];var l$X=l$A._readData.getUint32(),l$t=l$A._readData.getUint32(),l$I=(new Float32Array(l$_.slice(l$b+l$X,l$b+l$X+l$t)),l$A._readData.getUint32()),l$e=l$A._readData.getUint32(),l$c=new Float32Array(l$_.slice(l$b+l$I,l$b+l$I+l$e));for(l$A._mesh._inverseBindPoses=[],l$R=0,l$i=l$c.length;l$R<l$i;l$R+=16){var l$l=new l$i_(l$c[l$R+0],l$c[l$R+1],l$c[l$R+2],l$c[l$R+3],l$c[l$R+4],l$c[l$R+5],l$c[l$R+6],l$c[l$R+7],l$c[l$R+8],l$c[l$R+9],l$c[l$R+10],l$c[l$R+11],l$c[l$R+12],l$c[l$R+13],l$c[l$R+14],l$c[l$R+15]);l$A._mesh._inverseBindPoses.push(l$l)}return l$A._mesh._skinnedDatas=new Float32Array(16*l$c.length),!0},l$A.READ_SUBMESH=function(){var l$i=l$A._readData.__getBuffer(),l$_=new l$P_(l$A._mesh),l$R=l$A._readData.getInt16(),l$r=l$A._readData.getUint32(),l$b=l$A._readData.getUint32();l$_._vertexBuffer=l$A._mesh._vertexBuffers[l$R],l$_._vertexStart=l$r,l$_._vertexCount=l$b;var l$z=l$A._readData.getUint32(),l$L=l$A._readData.getUint32(),l$w=l$A._mesh._indexBuffer;l$_._indexBuffer=l$w,l$_._indexStart=l$z,l$_._indexCount=l$L,l$_._indices=new Uint16Array(l$w.getData().buffer,2*l$z,l$L);var l$x=l$A._DATA.offset,l$P=l$_._subIndexBufferStart,l$B=l$_._subIndexBufferCount,l$n=l$_._boneIndicesList,l$f=l$A._readData.getUint16();l$P.length=l$f,l$B.length=l$f,l$n.length=l$f;for(var l$J=0;l$J<l$f;l$J++){l$P[l$J]=l$A._readData.getUint32(),l$B[l$J]=l$A._readData.getUint32();var l$h=l$A._readData.getUint32(),l$M=l$A._readData.getUint32();l$_._boneIndicesList[l$J]=new Uint8Array(l$i.slice(l$x+l$h,l$x+l$h+l$M))}return l$A._subMeshes.push(l$_),!0},l$A._getVertexDeclaration=function(l$i){for(var l$_,l$R=!1,l$r=!1,l$b=!1,l$z=!1,l$L=!1,l$w=!1,l$x=!1,l$P=!1,l$B=!1,l$n=0;l$n<l$i.length;l$n++)switch(l$i[l$n]){case"POSITION":l$R=!0;break;case"NORMAL":l$r=!0;break;case"COLOR":l$b=!0;break;case"UV":l$z=!0;break;case"UV1":l$L=!0;break;case"BLENDWEIGHT":l$x=!0;break;case"BLENDINDICES":l$P=!0;break;case"TANGENT":l$w=!0;break;case"BINORMAL":l$B=!0}return l$R&&l$r&&l$b&&l$z&&l$L&&l$x&&l$P&&l$w?l$_=l$Ii.vertexDeclaration:l$R&&l$r&&l$b&&l$z&&l$L&&l$x&&l$P?l$_=l$Xi.vertexDeclaration:l$R&&l$r&&l$z&&l$L&&l$x&&l$P&&l$w?l$_=l$pi.vertexDeclaration:l$R&&l$r&&l$z&&l$L&&l$x&&l$P?l$_=l$ui.vertexDeclaration:l$R&&l$r&&l$b&&l$z&&l$x&&l$P&&l$w?l$_=l$Zi.vertexDeclaration:l$R&&l$r&&l$b&&l$z&&l$x&&l$P?l$_=l$li.vertexDeclaration:l$R&&l$r&&l$z&&l$x&&l$P&&l$w?l$_=l$si.vertexDeclaration:l$R&&l$r&&l$z&&l$x&&l$P?l$_=l$Oi.vertexDeclaration:l$R&&l$r&&l$b&&l$x&&l$P&&l$w?l$_=l$fi.vertexDeclaration:l$R&&l$r&&l$b&&l$x&&l$P?l$_=l$Bi.vertexDeclaration:l$R&&l$r&&l$b&&l$z&&l$L&&l$w?l$_=l$ci.vertexDeclaration:l$R&&l$r&&l$b&&l$z&&l$L?l$_=l$Ni.vertexDeclaration:l$R&&l$r&&l$z&&l$L&&l$w?l$_=l$Ki.vertexDeclaration:l$R&&l$r&&l$z&&l$L?l$_=l$Gi.vertexDeclaration:l$R&&l$r&&l$b&&l$z&&l$w?l$_=l$ji.vertexDeclaration:l$R&&l$r&&l$z&&l$w&&l$B?l$_=l$mi.vertexDeclaration:l$R&&l$r&&l$b&&l$z?l$_=l$Mi.vertexDeclaration:l$R&&l$r&&l$z&&l$w?l$_=l$Ci.vertexDeclaration:l$R&&l$r&&l$z?l$_=l$$i.vertexDeclaration:l$R&&l$r&&l$b&&l$w?l$_=l$hi.vertexDeclaration:l$R&&l$r&&l$b&&(l$_=l$Pi.vertexDeclaration),l$_},l$A._attrReg=new RegExp("(\\w+)|([:,;])","g"),l$A._strings=[],l$A._readData=null,l$A._version=null,l$A._mesh=null,l$A._materials=null,l$A._subMeshes=null,l$A._materialMap=null,l$n(l$A,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),l$A}(),l$ai=function(){function l$l(){}return l$J(l$l,"laya.d3.loaders.LoadModelV03"),l$l.parse=function(l$i,l$_,l$R,l$r,l$b){l$l._mesh=l$R,l$l._subMeshes=l$r,l$l._materialMap=l$b,l$l._version=l$_,l$l._readData=l$i,l$l.READ_DATA(),l$l.READ_BLOCK(),l$l.READ_STRINGS();for(var l$z=0,l$L=l$l._BLOCK.count;l$z<l$L;l$z++){l$l._readData.pos=l$l._BLOCK.blockStarts[l$z];var l$w=l$l._readData.getUint16(),l$x=l$l._strings[l$w],l$P=l$l["READ_"+l$x];if(null==l$P)throw new Error("model file err,no this function:"+l$w+" "+l$x);l$P.call()}l$l._strings.length=0,l$l._readData=null,l$l._version=null,l$l._mesh=null,l$l._subMeshes=null,l$l._materialMap=null},l$l._readString=function(){return l$l._strings[l$l._readData.getUint16()]},l$l.READ_DATA=function(){l$l._DATA.offset=l$l._readData.getUint32(),l$l._DATA.size=l$l._readData.getUint32()},l$l.READ_BLOCK=function(){for(var l$i=l$l._BLOCK.count=l$l._readData.getUint16(),l$_=l$l._BLOCK.blockStarts=[],l$R=l$l._BLOCK.blockLengths=[],l$r=0;l$r<l$i;l$r++)l$_.push(l$l._readData.getUint32()),l$R.push(l$l._readData.getUint32())},l$l.READ_STRINGS=function(){var l$i=l$l._readData.getUint32(),l$_=l$l._readData.getUint16(),l$R=l$l._readData.pos;l$l._readData.pos=l$i+l$l._DATA.offset;for(var l$r=0;l$r<l$_;l$r++)l$l._strings[l$r]=l$l._readData.readUTFString();l$l._readData.pos=l$R},l$l.READ_MESH=function(){var l$i,l$_=l$l._readString(),l$R=l$l._readData.__getBuffer(),l$r=0,l$b=l$l._readData.getInt16(),l$z=l$l._DATA.offset;for(l$r=0;l$r<l$b;l$r++){var l$L,l$w=l$z+l$l._readData.getUint32(),l$x=l$l._readData.getUint32(),l$P=new Float32Array(l$R.slice(l$w,l$w+l$x)),l$B=l$l._readString();switch(l$l._version){case"LAYAMODEL:03":l$L=l$l._vertexDeclarationMap_Discard[l$B];break;case"LAYAMODEL:0301":l$L=l$l._vertexDeclarationMap[l$B];break;default:throw new Error("LoadModelV03: unknown version.")}if(!l$L)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+l$l._version+"  bufferAttribute="+l$B+"  name="+l$_+"  url="+(l$l._mesh?l$l._mesh.url:"null"));var l$n=l$s_.create(l$L,4*l$P.length/l$L.vertexStride,35044,!0,l$l._mesh._url+"_"+l$r);l$n.setData(l$P),l$l._mesh._vertexBuffers.push(l$n)}var l$f=l$z+l$l._readData.getUint32(),l$J=l$l._readData.getUint32(),l$h=new Uint16Array(l$R.slice(l$f,l$f+l$J)),l$M=l$E_.create("ushort",l$J/2,35044,!0,l$l._mesh._url);l$M.setData(l$h),l$l._mesh._indexBuffer=l$M;var l$N=l$l._mesh._boneNames=[],l$X=l$l._readData.getUint16();for(l$N.length=l$X,l$r=0;l$r<l$X;l$r++)l$N[l$r]=l$l._strings[l$l._readData.getUint16()];l$l._readData.pos+=8;var l$t=l$l._readData.getUint32(),l$I=l$l._readData.getUint32(),l$e=new Float32Array(l$R.slice(l$z+l$t,l$z+l$t+l$I));for(l$l._mesh._inverseBindPoses=[],l$r=0,l$i=l$e.length;l$r<l$i;l$r+=16){var l$c=new l$i_(l$e[l$r+0],l$e[l$r+1],l$e[l$r+2],l$e[l$r+3],l$e[l$r+4],l$e[l$r+5],l$e[l$r+6],l$e[l$r+7],l$e[l$r+8],l$e[l$r+9],l$e[l$r+10],l$e[l$r+11],l$e[l$r+12],l$e[l$r+13],l$e[l$r+14],l$e[l$r+15]);l$l._mesh._inverseBindPoses.push(l$c)}return l$l._mesh._skinnedDatas=new Float32Array(16*l$e.length),!0},l$l.READ_SUBMESH=function(){var l$i=l$l._readData.__getBuffer(),l$_=new l$P_(l$l._mesh),l$R=l$l._readData.getInt16(),l$r=l$l._readData.getUint32(),l$b=l$l._readData.getUint32();l$_._vertexBuffer=l$l._mesh._vertexBuffers[l$R],l$_._vertexStart=l$r,l$_._vertexCount=l$b;var l$z=l$l._readData.getUint32(),l$L=l$l._readData.getUint32(),l$w=l$l._mesh._indexBuffer;l$_._indexBuffer=l$w,l$_._indexStart=l$z,l$_._indexCount=l$L,l$_._indices=new Uint16Array(l$w.getData().buffer,2*l$z,l$L);var l$x=l$l._DATA.offset,l$P=l$_._subIndexBufferStart,l$B=l$_._subIndexBufferCount,l$n=l$_._boneIndicesList,l$f=l$l._readData.getUint16();l$P.length=l$f,l$B.length=l$f,l$n.length=l$f;for(var l$J=0;l$J<l$f;l$J++){l$P[l$J]=l$l._readData.getUint32(),l$B[l$J]=l$l._readData.getUint32();var l$h=l$l._readData.getUint32(),l$M=l$l._readData.getUint32();l$n[l$J]=new Uint8Array(l$i.slice(l$x+l$h,l$x+l$h+l$M))}return l$l._subMeshes.push(l$_),!0},l$l._strings=[],l$l._readData=null,l$l._version=null,l$l._mesh=null,l$l._subMeshes=null,l$l._materialMap=null,l$n(l$l,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":l$Ii.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":l$Xi.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":l$Di.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":l$pi.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":l$ui.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":l$Zi.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":l$li.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":l$si.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":l$Oi.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":l$fi.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":l$Bi.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":l$ci.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":l$Ni.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":l$Ki.vertexDeclaration,"POSITION,NORMAL,UV,UV1":l$Gi.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":l$ji.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":l$mi.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":l$Mi.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":l$Ci.vertexDeclaration,"POSITION,NORMAL,UV":l$$i.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":l$hi.vertexDeclaration,"POSITION,NORMAL,COLOR":l$Pi.vertexDeclaration,"POSITION,NORMAL,TANGENT":l$vi.vertexDeclaration,"POSITION,NORMAL":l$xi.vertexDeclaration,"POSITION,UV":l$gi.vertexDeclaration,POSITION:l$wi.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":l$ti.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":l$Xi.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":l$Di.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":l$oi.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":l$ui.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":l$Ai.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":l$li.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":l$Ei.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":l$Oi.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":l$ni.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":l$Bi.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":l$ei.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":l$Ni.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":l$ki.vertexDeclaration,"POSITION,NORMAL,UV,UV1":l$Gi.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":l$qi.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":l$mi.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":l$Mi.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":l$Yi.vertexDeclaration,"POSITION,NORMAL,UV":l$$i.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":l$Ji.vertexDeclaration,"POSITION,NORMAL,COLOR":l$Pi.vertexDeclaration,"POSITION,NORMAL,TANGENT":l$Si.vertexDeclaration,"POSITION,NORMAL":l$xi.vertexDeclaration,"POSITION,UV":l$gi.vertexDeclaration,POSITION:l$wi.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),l$l}(),l$Fi=function(){function l$w(){}return l$J(l$w,"laya.d3.loaders.MeshReader"),l$w.read=function(l$i,l$_,l$R,l$r,l$b){var l$z=new l$l(l$i);l$z.pos=0;var l$L=l$z.readUTFString();switch(l$L){case"LAYAMODEL:01":case"LAYASKINANI:01":l$w._readVersion01(l$z,l$L,l$_,l$R,l$r,l$b);break;case"LAYAMODEL:02":l$yi.parse(l$z,l$L,l$_,l$R,l$r,l$b);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":l$ai.parse(l$z,l$L,l$_,l$r,l$b);break;default:throw new Error("MeshReader: unknown mesh version.")}l$_._setSubMeshes(l$r)},l$w._readVersion01=function(l$i,l$_,l$R,l$r,l$b,l$z){new l$Vi(l$i,l$_,l$R,l$r,l$b,l$z)},l$w}(),l$di=function(){function l$i(l$i,l$_){this.min=null,this.max=null,this.min=l$i,this.max=l$_}l$J(l$i,"laya.d3.math.BoundBox");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_.getCorners=function(l$i){l$i.length=8;var l$_=this.min.elements,l$R=this.max.elements,l$r=l$_[0],l$b=l$_[1],l$z=l$_[2],l$L=l$R[0],l$w=l$R[1],l$x=l$R[2];l$i[0]=new l$L_(l$r,l$w,l$x),l$i[1]=new l$L_(l$L,l$w,l$x),l$i[2]=new l$L_(l$L,l$b,l$x),l$i[3]=new l$L_(l$r,l$b,l$x),l$i[4]=new l$L_(l$r,l$w,l$z),l$i[5]=new l$L_(l$L,l$w,l$z),l$i[6]=new l$L_(l$L,l$b,l$z),l$i[7]=new l$L_(l$r,l$b,l$z)},l$_.toDefault=function(){this.min.toDefault(),this.max.toDefault()},l$_.cloneTo=function(l$i){var l$_=l$i;this.min.cloneTo(l$_.min),this.max.cloneTo(l$_.max)},l$_.clone=function(){var l$i=new this.constructor(new l$L_,new l$L_);return this.cloneTo(l$i),l$i},l$i.createfromPoints=function(l$i,l$_){if(null==l$i)throw new Error("points");var l$R=l$_.min,l$r=l$_.max,l$b=l$R.elements;l$b[0]=Number.MAX_VALUE,l$b[1]=Number.MAX_VALUE,l$b[2]=Number.MAX_VALUE;var l$z=l$r.elements;l$z[0]=-Number.MAX_VALUE,l$z[1]=-Number.MAX_VALUE,l$z[2]=-Number.MAX_VALUE;for(var l$L=0,l$w=l$i.length;l$L<l$w;++l$L)l$L_.min(l$R,l$i[l$L],l$R),l$L_.max(l$r,l$i[l$L],l$r)},l$i.merge=function(l$i,l$_,l$R){l$L_.min(l$i.min,l$_.min,l$R.min),l$L_.max(l$i.max,l$_.max,l$R.max)},l$i}(),l$Qi=function(){function l$P(l$i){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=l$i,this._near=new l$__(new l$L_),this._far=new l$__(new l$L_),this._left=new l$__(new l$L_),this._right=new l$__(new l$L_),this._top=new l$__(new l$L_),this._bottom=new l$__(new l$L_),l$P._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}l$J(l$P,"laya.d3.math.BoundFrustum");var l$i=l$P.prototype;return l$i.equalsBoundFrustum=function(l$i){return this._matrix.equalsOtherMatrix(l$i.matrix)},l$i.equalsObj=function(l$i){if(l$i instanceof laya.d3.math.BoundFrustum){var l$_=l$i;return this.equalsBoundFrustum(l$_)}return!1},l$i.getPlane=function(l$i){switch(l$i){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},l$i.getCorners=function(l$i){l$P._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(l$i[0]),l$P._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(l$i[1]),l$P._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(l$i[2]),l$P._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(l$i[3]),l$P._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(l$i[4]),l$P._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(l$i[5]),l$P._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(l$i[6]),l$P._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(l$i[7])},l$i.containsPoint=function(l$i){for(var l$_=l$__.PlaneIntersectionType_Front,l$R=l$__.PlaneIntersectionType_Front,l$r=0;l$r<6;l$r++){switch(l$r){case 0:l$R=Collision.intersectsPlaneAndPoint(this._near,l$i);break;case 1:l$R=Collision.intersectsPlaneAndPoint(this._far,l$i);break;case 2:l$R=Collision.intersectsPlaneAndPoint(this._left,l$i);break;case 3:l$R=Collision.intersectsPlaneAndPoint(this._right,l$i);break;case 4:l$R=Collision.intersectsPlaneAndPoint(this._top,l$i);break;case 5:l$R=Collision.intersectsPlaneAndPoint(this._bottom,l$i)}switch(l$R){case l$__.PlaneIntersectionType_Back:return 0;case l$__.PlaneIntersectionType_Intersecting:l$_=l$__.PlaneIntersectionType_Intersecting}}switch(l$_){case l$__.PlaneIntersectionType_Intersecting:return 2;default:return 1}},l$i.containsBoundBox=function(l$i){for(var l$_,l$R=l$P._tempV30,l$r=l$P._tempV31,l$b=1,l$z=0;l$z<6;l$z++){if(l$_=this.getPlane(l$z),this._getBoxToPlanePVertexNVertex(l$i,l$_.normal,l$R,l$r),Collision.intersectsPlaneAndPoint(l$_,l$R)===l$__.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(l$_,l$r)===l$__.PlaneIntersectionType_Back&&(l$b=2)}return l$b},l$i.containsBoundSphere=function(l$i){for(var l$_=l$__.PlaneIntersectionType_Front,l$R=l$__.PlaneIntersectionType_Front,l$r=0;l$r<6;l$r++){switch(l$r){case 0:l$R=Collision.intersectsPlaneAndSphere(this._near,l$i);break;case 1:l$R=Collision.intersectsPlaneAndSphere(this._far,l$i);break;case 2:l$R=Collision.intersectsPlaneAndSphere(this._left,l$i);break;case 3:l$R=Collision.intersectsPlaneAndSphere(this._right,l$i);break;case 4:l$R=Collision.intersectsPlaneAndSphere(this._top,l$i);break;case 5:l$R=Collision.intersectsPlaneAndSphere(this._bottom,l$i)}switch(l$R){case l$__.PlaneIntersectionType_Back:return 0;case l$__.PlaneIntersectionType_Intersecting:l$_=l$__.PlaneIntersectionType_Intersecting}}switch(l$_){case l$__.PlaneIntersectionType_Intersecting:return 2;default:return 1}},l$i._getBoxToPlanePVertexNVertex=function(l$i,l$_,l$R,l$r){var l$b=l$i.min,l$z=l$b.elements,l$L=l$i.max,l$w=l$L.elements,l$x=l$_.elements,l$P=l$x[0],l$B=l$x[1],l$n=l$x[2];l$b.cloneTo(l$R);var l$f=l$R.elements;0<=l$P&&(l$f[0]=l$w[0]),0<=l$B&&(l$f[1]=l$w[1]),0<=l$n&&(l$f[2]=l$w[2]),l$L.cloneTo(l$r);var l$J=l$r.elements;0<=l$P&&(l$J[0]=l$z[0]),0<=l$B&&(l$J[1]=l$z[1]),0<=l$n&&(l$J[2]=l$z[2])},l$h(0,l$i,"top",function(){return this._top}),l$h(0,l$i,"matrix",function(){return this._matrix},function(l$i){this._matrix=l$i,l$P._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),l$h(0,l$i,"near",function(){return this._near}),l$h(0,l$i,"far",function(){return this._far}),l$h(0,l$i,"left",function(){return this._left}),l$h(0,l$i,"right",function(){return this._right}),l$h(0,l$i,"bottom",function(){return this._bottom}),l$P._getPlanesFromMatrix=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){var l$w=l$i.elements,l$x=l$w[0],l$P=l$w[1],l$B=l$w[2],l$n=l$w[3],l$f=l$w[4],l$J=l$w[5],l$h=l$w[6],l$M=l$w[7],l$N=l$w[8],l$X=l$w[9],l$t=l$w[10],l$I=l$w[11],l$e=l$w[12],l$c=l$w[13],l$l=l$w[14],l$A=l$w[15],l$Z=l$_.normal.elements;l$Z[0]=l$n+l$B,l$Z[1]=l$M+l$h,l$Z[2]=l$I+l$t,l$_.distance=l$A+l$l,l$_.normalize();var l$q=l$R.normal.elements;l$q[0]=l$n-l$B,l$q[1]=l$M-l$h,l$q[2]=l$I-l$t,l$R.distance=l$A-l$l,l$R.normalize();var l$j=l$r.normal.elements;l$j[0]=l$n+l$x,l$j[1]=l$M+l$f,l$j[2]=l$I+l$N,l$r.distance=l$A+l$e,l$r.normalize();var l$S=l$b.normal.elements;l$S[0]=l$n-l$x,l$S[1]=l$M-l$f,l$S[2]=l$I-l$N,l$b.distance=l$A-l$e,l$b.normalize();var l$v=l$z.normal.elements;l$v[0]=l$n-l$P,l$v[1]=l$M-l$J,l$v[2]=l$I-l$X,l$z.distance=l$A-l$c,l$z.normalize();var l$$=l$L.normal.elements;l$$[0]=l$n+l$P,l$$[1]=l$M+l$J,l$$[2]=l$I+l$X,l$L.distance=l$A+l$c,l$L.normalize()},l$P._get3PlaneInterPoint=function(l$i,l$_,l$R){var l$r=l$i.normal,l$b=l$_.normal,l$z=l$R.normal;l$L_.cross(l$b,l$z,l$P._tempV30),l$L_.cross(l$z,l$r,l$P._tempV31),l$L_.cross(l$r,l$b,l$P._tempV32);var l$L=l$L_.dot(l$r,l$P._tempV30),l$w=l$L_.dot(l$b,l$P._tempV31),l$x=l$L_.dot(l$z,l$P._tempV32);return l$L_.scale(l$P._tempV30,-l$i.distance/l$L,l$P._tempV33),l$L_.scale(l$P._tempV31,-l$_.distance/l$w,l$P._tempV34),l$L_.scale(l$P._tempV32,-l$R.distance/l$x,l$P._tempV35),l$L_.add(l$P._tempV33,l$P._tempV34,l$P._tempV36),l$L_.add(l$P._tempV35,l$P._tempV36,l$P._tempV37),l$P._tempV37},l$n(l$P,["_tempV30",function(){return this._tempV30=new l$L_},"_tempV31",function(){return this._tempV31=new l$L_},"_tempV32",function(){return this._tempV32=new l$L_},"_tempV33",function(){return this._tempV33=new l$L_},"_tempV34",function(){return this._tempV34=new l$L_},"_tempV35",function(){return this._tempV35=new l$L_},"_tempV36",function(){return this._tempV36=new l$L_},"_tempV37",function(){return this._tempV37=new l$L_}]),l$P}(),l$Hi=function(){function l$B(l$i,l$_){this.center=null,this.radius=NaN,this.center=l$i,this.radius=l$_}l$J(l$B,"laya.d3.math.BoundSphere");var l$i=l$B.prototype;return l$c.imps(l$i,{"laya.d3.core.IClone":!0}),l$i.toDefault=function(){this.center.toDefault(),this.radius=0},l$i.intersectsRayDistance=function(l$i){return Collision.intersectsRayAndSphereRD(l$i,this)},l$i.intersectsRayPoint=function(l$i,l$_){return Collision.intersectsRayAndSphereRP(l$i,this,l$_)},l$i.cloneTo=function(l$i){var l$_=l$i;this.center.cloneTo(l$_.center),l$_.radius=this.radius},l$i.clone=function(){var l$i=new this.constructor(new l$L_,new l$L_);return this.cloneTo(l$i),l$i},l$B.createFromSubPoints=function(l$i,l$_,l$R,l$r){if(null==l$i)throw new Error("points");if(l$_<0||l$_>=l$i.length)throw new Error("start"+l$_+"Must be in the range [0, "+(l$i.length-1)+"]");if(l$R<0||l$_+l$R>l$i.length)throw new Error("count"+l$R+"Must be in the range <= "+l$i.length+"}");var l$b=l$_+l$R,l$z=l$B._tempVector3;l$z.elements[0]=0,l$z.elements[1]=0,l$z.elements[2]=0;for(var l$L=l$_;l$L<l$b;++l$L)l$L_.add(l$i[l$L],l$z,l$z);var l$w=l$r.center;l$L_.scale(l$z,1/l$R,l$w);var l$x=0;for(l$L=l$_;l$L<l$b;++l$L){var l$P=l$L_.distanceSquared(l$w,l$i[l$L]);l$x<l$P&&(l$x=l$P)}l$r.radius=Math.sqrt(l$x)},l$B.createfromPoints=function(l$i,l$_){if(null==l$i)throw new Error("points");l$B.createFromSubPoints(l$i,0,l$i.length,l$_)},l$n(l$B,["_tempVector3",function(){return this._tempVector3=new l$L_}]),l$B}(),l$Wi=(function(){function l$i(){}l$J(l$i,"laya.d3.math.ContainmentType"),l$i.Disjoint=0,l$i.Contains=1,l$i.Intersects=2}(),function(){function l$R(){}return l$J(l$R,"laya.d3.math.MathUtils3D"),l$R.isZero=function(l$i){return Math.abs(l$i)<l$R.zeroTolerance},l$R.nearEqual=function(l$i,l$_){return!!l$R.isZero(l$i-l$_)},l$R.fastInvSqrt=function(l$i){return l$R.isZero(l$i)?l$i:1/Math.sqrt(l$i)},l$n(l$R,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),l$R}()),l$Ti=function(){function l$x(){var l$i=this.elements=new Float32Array(9);l$i[0]=1,l$i[1]=0,l$i[2]=0,l$i[3]=0,l$i[4]=1,l$i[5]=0,l$i[6]=0,l$i[7]=0,l$i[8]=1}l$J(l$x,"laya.d3.math.Matrix3x3");var l$i=l$x.prototype;return l$c.imps(l$i,{"laya.d3.core.IClone":!0}),l$i.determinant=function(){var l$i=this.elements,l$_=l$i[0],l$R=l$i[1],l$r=l$i[2],l$b=l$i[3],l$z=l$i[4],l$L=l$i[5],l$w=l$i[6],l$x=l$i[7],l$P=l$i[8];return l$_*(l$P*l$z-l$L*l$x)+l$R*(-l$P*l$b+l$L*l$w)+l$r*(l$x*l$b-l$z*l$w)},l$i.translate=function(l$i,l$_){var l$R=l$_.elements,l$r=this.elements,l$b=l$i.elements,l$z=l$r[0],l$L=l$r[1],l$w=l$r[2],l$x=l$r[3],l$P=l$r[4],l$B=l$r[5],l$n=l$r[6],l$f=l$r[7],l$J=l$r[8],l$h=l$b[0],l$M=l$b[1];l$R[0]=l$z,l$R[1]=l$L,l$R[2]=l$w,l$R[3]=l$x,l$R[4]=l$P,l$R[5]=l$B,l$R[6]=l$h*l$z+l$M*l$x+l$n,l$R[7]=l$h*l$L+l$M*l$P+l$f,l$R[8]=l$h*l$w+l$M*l$B+l$J},l$i.rotate=function(l$i,l$_){var l$R=l$_.elements,l$r=this.elements,l$b=l$r[0],l$z=l$r[1],l$L=l$r[2],l$w=l$r[3],l$x=l$r[4],l$P=l$r[5],l$B=l$r[6],l$n=l$r[7],l$f=l$r[8],l$J=Math.sin(l$i),l$h=Math.cos(l$i);l$R[0]=l$h*l$b+l$J*l$w,l$R[1]=l$h*l$z+l$J*l$x,l$R[2]=l$h*l$L+l$J*l$P,l$R[3]=l$h*l$w-l$J*l$b,l$R[4]=l$h*l$x-l$J*l$z,l$R[5]=l$h*l$P-l$J*l$L,l$R[6]=l$B,l$R[7]=l$n,l$R[8]=l$f},l$i.scale=function(l$i,l$_){var l$R=l$_.elements,l$r=this.elements,l$b=l$i.elements,l$z=l$b[0],l$L=l$b[1];l$R[0]=l$z*l$r[0],l$R[1]=l$z*l$r[1],l$R[2]=l$z*l$r[2],l$R[3]=l$L*l$r[3],l$R[4]=l$L*l$r[4],l$R[5]=l$L*l$r[5],l$R[6]=l$r[6],l$R[7]=l$r[7],l$R[8]=l$r[8]},l$i.invert=function(l$i){var l$_=l$i.elements,l$R=this.elements,l$r=l$R[0],l$b=l$R[1],l$z=l$R[2],l$L=l$R[3],l$w=l$R[4],l$x=l$R[5],l$P=l$R[6],l$B=l$R[7],l$n=l$R[8],l$f=l$n*l$w-l$x*l$B,l$J=-l$n*l$L+l$x*l$P,l$h=l$B*l$L-l$w*l$P,l$M=l$r*l$f+l$b*l$J+l$z*l$h;l$M||(l$i=null),l$M=1/l$M,l$_[0]=l$f*l$M,l$_[1]=(-l$n*l$b+l$z*l$B)*l$M,l$_[2]=(l$x*l$b-l$z*l$w)*l$M,l$_[3]=l$J*l$M,l$_[4]=(l$n*l$r-l$z*l$P)*l$M,l$_[5]=(-l$x*l$r+l$z*l$L)*l$M,l$_[6]=l$h*l$M,l$_[7]=(-l$B*l$r+l$b*l$P)*l$M,l$_[8]=(l$w*l$r-l$b*l$L)*l$M},l$i.transpose=function(l$i){var l$_=l$i.elements,l$R=this.elements;if(l$i===this){var l$r=l$R[1],l$b=l$R[2],l$z=l$R[5];l$_[1]=l$R[3],l$_[2]=l$R[6],l$_[3]=l$r,l$_[5]=l$R[7],l$_[6]=l$b,l$_[7]=l$z}else l$_[0]=l$R[0],l$_[1]=l$R[3],l$_[2]=l$R[6],l$_[3]=l$R[1],l$_[4]=l$R[4],l$_[5]=l$R[7],l$_[6]=l$R[2],l$_[7]=l$R[5],l$_[8]=l$R[8]},l$i.identity=function(){var l$i=this.elements;l$i[0]=1,l$i[1]=0,l$i[2]=0,l$i[3]=0,l$i[4]=1,l$i[5]=0,l$i[6]=0,l$i[7]=0,l$i[8]=1},l$i.cloneTo=function(l$i){var l$_,l$R,l$r;if((l$R=this.elements)!==(l$r=l$i.elements))for(l$_=0;l$_<9;++l$_)l$r[l$_]=l$R[l$_]},l$i.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$x.createFromTranslation=function(l$i,l$_){l$_.elements;var l$R=l$i.elements;l$_[0]=1,l$_[1]=0,l$_[2]=0,l$_[3]=0,l$_[4]=1,l$_[5]=0,l$_[6]=l$R[0],l$_[7]=l$R[1],l$_[8]=1},l$x.createFromRotation=function(l$i,l$_){var l$R=l$_.elements,l$r=Math.sin(l$i),l$b=Math.cos(l$i);l$R[0]=l$b,l$R[1]=l$r,l$R[2]=0,l$R[3]=-l$r,l$R[4]=l$b,l$R[5]=0,l$R[6]=0,l$R[7]=0,l$R[8]=1},l$x.createFromScaling=function(l$i,l$_){var l$R=l$_.elements,l$r=l$i.elements;l$R[0]=l$r[0],l$R[1]=0,l$R[2]=0,l$R[3]=0,l$R[4]=l$r[1],l$R[5]=0,l$R[6]=0,l$R[7]=0,l$R[8]=1},l$x.createFromMatrix4x4=function(l$i,l$_){l$_[0]=l$i[0],l$_[1]=l$i[1],l$_[2]=l$i[2],l$_[3]=l$i[4],l$_[4]=l$i[5],l$_[5]=l$i[6],l$_[6]=l$i[8],l$_[7]=l$i[9],l$_[8]=l$i[10]},l$x.multiply=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements,l$L=l$b[0],l$w=l$b[1],l$x=l$b[2],l$P=l$b[3],l$B=l$b[4],l$n=l$b[5],l$f=l$b[6],l$J=l$b[7],l$h=l$b[8],l$M=l$z[0],l$N=l$z[1],l$X=l$z[2],l$t=l$z[3],l$I=l$z[4],l$e=l$z[5],l$c=l$z[6],l$l=l$z[7],l$A=l$z[8];l$r[0]=l$M*l$L+l$N*l$P+l$X*l$f,l$r[1]=l$M*l$w+l$N*l$B+l$X*l$J,l$r[2]=l$M*l$x+l$N*l$n+l$X*l$h,l$r[3]=l$t*l$L+l$I*l$P+l$e*l$f,l$r[4]=l$t*l$w+l$I*l$B+l$e*l$J,l$r[5]=l$t*l$x+l$I*l$n+l$e*l$h,l$r[6]=l$c*l$L+l$l*l$P+l$A*l$f,l$r[7]=l$c*l$w+l$l*l$B+l$A*l$J,l$r[8]=l$c*l$x+l$l*l$n+l$A*l$h},l$x.lookAt=function(l$i,l$_,l$R,l$r){l$L_.subtract(l$i,l$_,l$x._tempV30),l$L_.normalize(l$x._tempV30,l$x._tempV30),l$L_.cross(l$R,l$x._tempV30,l$x._tempV31),l$L_.normalize(l$x._tempV31,l$x._tempV31),l$L_.cross(l$x._tempV30,l$x._tempV31,l$x._tempV32);var l$b=l$x._tempV30.elements,l$z=l$x._tempV31.elements,l$L=l$x._tempV32.elements,l$w=l$r.elements;l$w[0]=l$z[0],l$w[3]=l$z[1],l$w[6]=l$z[2],l$w[1]=l$L[0],l$w[4]=l$L[1],l$w[7]=l$L[2],l$w[2]=l$b[0],l$w[5]=l$b[1],l$w[8]=l$b[2]},l$x.DEFAULT=new l$x,l$n(l$x,["_tempV30",function(){return this._tempV30=new l$L_},"_tempV31",function(){return this._tempV31=new l$L_},"_tempV32",function(){return this._tempV32=new l$L_}]),l$x}(),l$i_=function(){function l$q(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$n,l$f,l$J,l$h,l$M){void 0===l$i&&(l$i=1),void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=0),void 0===l$b&&(l$b=0),void 0===l$z&&(l$z=1),void 0===l$L&&(l$L=0),void 0===l$w&&(l$w=0),void 0===l$x&&(l$x=0),void 0===l$P&&(l$P=0),void 0===l$B&&(l$B=1),void 0===l$n&&(l$n=0),void 0===l$f&&(l$f=0),void 0===l$J&&(l$J=0),void 0===l$h&&(l$h=0),void 0===l$M&&(l$M=1);var l$N=this.elements=new Float32Array(16);l$N[0]=l$i,l$N[1]=l$_,l$N[2]=l$R,l$N[3]=l$r,l$N[4]=l$b,l$N[5]=l$z,l$N[6]=l$L,l$N[7]=l$w,l$N[8]=l$x,l$N[9]=l$P,l$N[10]=l$B,l$N[11]=l$n,l$N[12]=l$f,l$N[13]=l$J,l$N[14]=l$h,l$N[15]=l$M}l$J(l$q,"laya.d3.math.Matrix4x4");var l$i=l$q.prototype;return l$c.imps(l$i,{"laya.d3.core.IClone":!0}),l$i.getElementByRowColumn=function(l$i,l$_){if(l$i<0||3<l$i)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(l$_<0||3<l$_)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*l$i+l$_]},l$i.setElementByRowColumn=function(l$i,l$_,l$R){if(l$i<0||3<l$i)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(l$_<0||3<l$_)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*l$i+l$_]=l$R},l$i.equalsOtherMatrix=function(l$i){var l$_=this.elements,l$R=l$i.elements;return l$Wi.nearEqual(l$_[0],l$R[0])&&l$Wi.nearEqual(l$_[1],l$R[1])&&l$Wi.nearEqual(l$_[2],l$R[2])&&l$Wi.nearEqual(l$_[3],l$R[3])&&l$Wi.nearEqual(l$_[4],l$R[4])&&l$Wi.nearEqual(l$_[5],l$R[5])&&l$Wi.nearEqual(l$_[6],l$R[6])&&l$Wi.nearEqual(l$_[7],l$R[7])&&l$Wi.nearEqual(l$_[8],l$R[8])&&l$Wi.nearEqual(l$_[9],l$R[9])&&l$Wi.nearEqual(l$_[10],l$R[10])&&l$Wi.nearEqual(l$_[11],l$R[11])&&l$Wi.nearEqual(l$_[12],l$R[12])&&l$Wi.nearEqual(l$_[13],l$R[13])&&l$Wi.nearEqual(l$_[14],l$R[14])&&l$Wi.nearEqual(l$_[15],l$R[15])},l$i.decomposeTransRotScale=function(l$i,l$_,l$R){var l$r=l$q._tempMatrix4x4;return this.decomposeTransRotMatScale(l$i,l$r,l$R)?(l$R_.createFromMatrix4x4(l$r,l$_),!0):(l$_.identity(),!1)},l$i.decomposeTransRotMatScale=function(l$i,l$_,l$R){var l$r=this.elements,l$b=l$i.elements,l$z=l$_.elements,l$L=l$R.elements;l$b[0]=l$r[12],l$b[1]=l$r[13],l$b[2]=l$r[14];var l$w=l$r[0],l$x=l$r[1],l$P=l$r[2],l$B=l$r[4],l$n=l$r[5],l$f=l$r[6],l$J=l$r[8],l$h=l$r[9],l$M=l$r[10],l$N=l$L[0]=Math.sqrt(l$w*l$w+l$x*l$x+l$P*l$P),l$X=l$L[1]=Math.sqrt(l$B*l$B+l$n*l$n+l$f*l$f),l$t=l$L[2]=Math.sqrt(l$J*l$J+l$h*l$h+l$M*l$M);if(l$Wi.isZero(l$N)||l$Wi.isZero(l$X)||l$Wi.isZero(l$t))return l$z[1]=l$z[2]=l$z[3]=l$z[4]=l$z[6]=l$z[7]=l$z[8]=l$z[9]=l$z[11]=l$z[12]=l$z[13]=l$z[14]=0,l$z[0]=l$z[5]=l$z[10]=l$z[15]=1,!1;var l$I=l$q._tempVector0,l$e=l$I.elements;l$e[0]=l$J/l$t,l$e[1]=l$h/l$t,l$e[2]=l$M/l$t;var l$c=l$q._tempVector1,l$l=l$c.elements;l$l[0]=l$w/l$N,l$l[1]=l$x/l$N,l$l[2]=l$P/l$N;var l$A=l$q._tempVector2;l$L_.cross(l$I,l$c,l$A);var l$Z=l$q._tempVector1;return l$L_.cross(l$A,l$I,l$Z),l$z[3]=l$z[7]=l$z[11]=l$z[12]=l$z[13]=l$z[14]=0,l$z[15]=1,l$z[0]=l$Z.x,l$z[1]=l$Z.y,l$z[2]=l$Z.z,l$z[4]=l$A.x,l$z[5]=l$A.y,l$z[6]=l$A.z,l$z[8]=l$I.x,l$z[9]=l$I.y,l$z[10]=l$I.z,l$z[0]*l$w+l$z[1]*l$x+l$z[2]*l$P<0&&(l$L[0]=-l$N),l$z[4]*l$B+l$z[5]*l$n+l$z[6]*l$f<0&&(l$L[1]=-l$X),l$z[8]*l$J+l$z[9]*l$h+l$z[10]*l$M<0&&(l$L[2]=-l$t),!0},l$i.decomposeYawPitchRoll=function(l$i){var l$_=l$i.elements,l$R=Math.asin(-this.elements[9]);l$_[1]=l$R,Math.cos(l$R)>l$Wi.zeroTolerance?(l$_[2]=Math.atan2(this.elements[1],this.elements[5]),l$_[0]=Math.atan2(this.elements[8],this.elements[10])):(l$_[2]=Math.atan2(-this.elements[4],this.elements[0]),l$_[0]=0)},l$i.normalize=function(){var l$i=this.elements,l$_=l$i[0],l$R=l$i[1],l$r=l$i[2],l$b=Math.sqrt(l$_*l$_+l$R*l$R+l$r*l$r);if(!l$b)return l$i[0]=0,l$i[1]=0,void(l$i[2]=0);1!=l$b&&(l$b=1/l$b,l$i[0]=l$_*l$b,l$i[1]=l$R*l$b,l$i[2]=l$r*l$b)},l$i.transpose=function(){var l$i,l$_;return l$_=(l$i=this.elements)[1],l$i[1]=l$i[4],l$i[4]=l$_,l$_=l$i[2],l$i[2]=l$i[8],l$i[8]=l$_,l$_=l$i[3],l$i[3]=l$i[12],l$i[12]=l$_,l$_=l$i[6],l$i[6]=l$i[9],l$i[9]=l$_,l$_=l$i[7],l$i[7]=l$i[13],l$i[13]=l$_,l$_=l$i[11],l$i[11]=l$i[14],l$i[14]=l$_,this},l$i.invert=function(l$i){var l$_=this.elements,l$R=l$i.elements,l$r=l$_[0],l$b=l$_[1],l$z=l$_[2],l$L=l$_[3],l$w=l$_[4],l$x=l$_[5],l$P=l$_[6],l$B=l$_[7],l$n=l$_[8],l$f=l$_[9],l$J=l$_[10],l$h=l$_[11],l$M=l$_[12],l$N=l$_[13],l$X=l$_[14],l$t=l$_[15],l$I=l$r*l$x-l$b*l$w,l$e=l$r*l$P-l$z*l$w,l$c=l$r*l$B-l$L*l$w,l$l=l$b*l$P-l$z*l$x,l$A=l$b*l$B-l$L*l$x,l$Z=l$z*l$B-l$L*l$P,l$q=l$n*l$N-l$f*l$M,l$j=l$n*l$X-l$J*l$M,l$S=l$n*l$t-l$h*l$M,l$v=l$f*l$X-l$J*l$N,l$$=l$f*l$t-l$h*l$N,l$G=l$J*l$t-l$h*l$X,l$u=l$I*l$G-l$e*l$$+l$c*l$v+l$l*l$S-l$A*l$j+l$Z*l$q;0!==Math.abs(l$u)&&(l$u=1/l$u,l$R[0]=(l$x*l$G-l$P*l$$+l$B*l$v)*l$u,l$R[1]=(l$z*l$$-l$b*l$G-l$L*l$v)*l$u,l$R[2]=(l$N*l$Z-l$X*l$A+l$t*l$l)*l$u,l$R[3]=(l$J*l$A-l$f*l$Z-l$h*l$l)*l$u,l$R[4]=(l$P*l$S-l$w*l$G-l$B*l$j)*l$u,l$R[5]=(l$r*l$G-l$z*l$S+l$L*l$j)*l$u,l$R[6]=(l$X*l$c-l$M*l$Z-l$t*l$e)*l$u,l$R[7]=(l$n*l$Z-l$J*l$c+l$h*l$e)*l$u,l$R[8]=(l$w*l$$-l$x*l$S+l$B*l$q)*l$u,l$R[9]=(l$b*l$S-l$r*l$$-l$L*l$q)*l$u,l$R[10]=(l$M*l$A-l$N*l$c+l$t*l$I)*l$u,l$R[11]=(l$f*l$c-l$n*l$A-l$h*l$I)*l$u,l$R[12]=(l$x*l$j-l$w*l$v-l$P*l$q)*l$u,l$R[13]=(l$r*l$v-l$b*l$j+l$z*l$q)*l$u,l$R[14]=(l$N*l$e-l$M*l$l-l$X*l$I)*l$u,l$R[15]=(l$n*l$l-l$f*l$e+l$J*l$I)*l$u)},l$i.identity=function(){var l$i=this.elements;l$i[1]=l$i[2]=l$i[3]=l$i[4]=l$i[6]=l$i[7]=l$i[8]=l$i[9]=l$i[11]=l$i[12]=l$i[13]=l$i[14]=0,l$i[0]=l$i[5]=l$i[10]=l$i[15]=1},l$i.cloneTo=function(l$i){var l$_,l$R,l$r;if((l$R=this.elements)!==(l$r=l$i.elements))for(l$_=0;l$_<16;++l$_)l$r[l$_]=l$R[l$_]},l$i.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$i.getTranslationVector=function(l$i){var l$_=this.elements,l$R=l$i.elements;l$R[0]=l$_[12],l$R[1]=l$_[13],l$R[2]=l$_[14]},l$i.setTranslationVector=function(l$i){var l$_=this.elements,l$R=l$i.elements;l$_[12]=l$R[0],l$_[13]=l$R[1],l$_[14]=l$R[2]},l$i.getForward=function(l$i){var l$_=this.elements,l$R=l$i.elements;l$R[0]=-l$_[8],l$R[1]=-l$_[9],l$R[2]=-l$_[10]},l$i.setForward=function(l$i){var l$_=this.elements,l$R=l$i.elements;l$_[8]=-l$R[0],l$_[9]=-l$R[1],l$_[10]=-l$R[2]},l$q.createRotationX=function(l$i,l$_){var l$R=l$_.elements,l$r=Math.sin(l$i),l$b=Math.cos(l$i);l$R[1]=l$R[2]=l$R[3]=l$R[4]=l$R[7]=l$R[8]=l$R[11]=l$R[12]=l$R[13]=l$R[14]=0,l$R[0]=l$R[15]=1,l$R[5]=l$R[10]=l$b,l$R[6]=l$r,l$R[9]=-l$r},l$q.createRotationY=function(l$i,l$_){var l$R=l$_.elements,l$r=Math.sin(l$i),l$b=Math.cos(l$i);l$R[1]=l$R[3]=l$R[4]=l$R[6]=l$R[7]=l$R[9]=l$R[11]=l$R[12]=l$R[13]=l$R[14]=0,l$R[5]=l$R[15]=1,l$R[0]=l$R[10]=l$b,l$R[2]=-l$r,l$R[8]=l$r},l$q.createRotationZ=function(l$i,l$_){var l$R=l$_.elements,l$r=Math.sin(l$i),l$b=Math.cos(l$i);l$R[2]=l$R[3]=l$R[6]=l$R[7]=l$R[8]=l$R[9]=l$R[11]=l$R[12]=l$R[13]=l$R[14]=0,l$R[10]=l$R[15]=1,l$R[0]=l$R[5]=l$b,l$R[1]=l$r,l$R[4]=-l$r},l$q.createRotationYawPitchRoll=function(l$i,l$_,l$R,l$r){l$R_.createFromYawPitchRoll(l$i,l$_,l$R,l$q._tempQuaternion),l$q.createRotationQuaternion(l$q._tempQuaternion,l$r)},l$q.createRotationAxis=function(l$i,l$_,l$R){var l$r=l$i.elements,l$b=l$r[0],l$z=l$r[1],l$L=l$r[2],l$w=Math.cos(l$_),l$x=Math.sin(l$_),l$P=l$b*l$b,l$B=l$z*l$z,l$n=l$L*l$L,l$f=l$b*l$z,l$J=l$b*l$L,l$h=l$z*l$L,l$M=l$R.elements;l$M[3]=l$M[7]=l$M[11]=l$M[12]=l$M[13]=l$M[14]=0,l$M[15]=1,l$M[0]=l$P+l$w*(1-l$P),l$M[1]=l$f-l$w*l$f+l$x*l$L,l$M[2]=l$J-l$w*l$J-l$x*l$z,l$M[4]=l$f-l$w*l$f-l$x*l$L,l$M[5]=l$B+l$w*(1-l$B),l$M[6]=l$h-l$w*l$h+l$x*l$b,l$M[8]=l$J-l$w*l$J+l$x*l$z,l$M[9]=l$h-l$w*l$h-l$x*l$b,l$M[10]=l$n+l$w*(1-l$n)},l$q.createRotationQuaternion=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements,l$b=l$R[0],l$z=l$R[1],l$L=l$R[2],l$w=l$R[3],l$x=l$b*l$b,l$P=l$z*l$z,l$B=l$L*l$L,l$n=l$b*l$z,l$f=l$L*l$w,l$J=l$L*l$b,l$h=l$z*l$w,l$M=l$z*l$L,l$N=l$b*l$w;l$r[3]=l$r[7]=l$r[11]=l$r[12]=l$r[13]=l$r[14]=0,l$r[15]=1,l$r[0]=1-2*(l$P+l$B),l$r[1]=2*(l$n+l$f),l$r[2]=2*(l$J-l$h),l$r[4]=2*(l$n-l$f),l$r[5]=1-2*(l$B+l$x),l$r[6]=2*(l$M+l$N),l$r[8]=2*(l$J+l$h),l$r[9]=2*(l$M-l$N),l$r[10]=1-2*(l$P+l$x)},l$q.createTranslate=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements;l$r[4]=l$r[8]=l$r[1]=l$r[9]=l$r[2]=l$r[6]=l$r[3]=l$r[7]=l$r[11]=0,l$r[0]=l$r[5]=l$r[10]=l$r[15]=1,l$r[12]=l$R[0],l$r[13]=l$R[1],l$r[14]=l$R[2]},l$q.createScaling=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements;l$r[0]=l$R[0],l$r[5]=l$R[1],l$r[10]=l$R[2],l$r[1]=l$r[4]=l$r[8]=l$r[12]=l$r[9]=l$r[13]=l$r[2]=l$r[6]=l$r[14]=l$r[3]=l$r[7]=l$r[11]=0,l$r[15]=1},l$q.multiply=function(l$i,l$_,l$R){var l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B;for(l$b=l$R.elements,l$z=l$i.elements,l$b===(l$L=l$_.elements)&&(l$L=l$L.slice()),l$r=0;l$r<4;l$r++)l$w=l$z[l$r],l$x=l$z[l$r+4],l$P=l$z[l$r+8],l$B=l$z[l$r+12],l$b[l$r]=l$w*l$L[0]+l$x*l$L[1]+l$P*l$L[2]+l$B*l$L[3],l$b[l$r+4]=l$w*l$L[4]+l$x*l$L[5]+l$P*l$L[6]+l$B*l$L[7],l$b[l$r+8]=l$w*l$L[8]+l$x*l$L[9]+l$P*l$L[10]+l$B*l$L[11],l$b[l$r+12]=l$w*l$L[12]+l$x*l$L[13]+l$P*l$L[14]+l$B*l$L[15]},l$q.createFromQuaternion=function(l$i,l$_){var l$R=l$_.elements,l$r=l$i.elements,l$b=l$r[0],l$z=l$r[1],l$L=l$r[2],l$w=l$r[3],l$x=l$b+l$b,l$P=l$z+l$z,l$B=l$L+l$L,l$n=l$b*l$x,l$f=l$z*l$x,l$J=l$z*l$P,l$h=l$L*l$x,l$M=l$L*l$P,l$N=l$L*l$B,l$X=l$w*l$x,l$t=l$w*l$P,l$I=l$w*l$B;l$R[0]=1-l$J-l$N,l$R[1]=l$f+l$I,l$R[2]=l$h-l$t,l$R[3]=0,l$R[4]=l$f-l$I,l$R[5]=1-l$n-l$N,l$R[6]=l$M+l$X,l$R[7]=0,l$R[8]=l$h+l$t,l$R[9]=l$M-l$X,l$R[10]=1-l$n-l$J,l$R[11]=0,l$R[12]=0,l$R[13]=0,l$R[14]=0,l$R[15]=1},l$q.createAffineTransformation=function(l$i,l$_,l$R,l$r){var l$b=l$i.elements,l$z=l$_.elements,l$L=l$R.elements,l$w=l$r.elements,l$x=l$z[0],l$P=l$z[1],l$B=l$z[2],l$n=l$z[3],l$f=l$x+l$x,l$J=l$P+l$P,l$h=l$B+l$B,l$M=l$x*l$f,l$N=l$x*l$J,l$X=l$x*l$h,l$t=l$P*l$J,l$I=l$P*l$h,l$e=l$B*l$h,l$c=l$n*l$f,l$l=l$n*l$J,l$A=l$n*l$h,l$Z=l$L[0],l$q=l$L[1],l$j=l$L[2];l$w[0]=(1-(l$t+l$e))*l$Z,l$w[1]=(l$N+l$A)*l$Z,l$w[2]=(l$X-l$l)*l$Z,l$w[3]=0,l$w[4]=(l$N-l$A)*l$q,l$w[5]=(1-(l$M+l$e))*l$q,l$w[6]=(l$I+l$c)*l$q,l$w[7]=0,l$w[8]=(l$X+l$l)*l$j,l$w[9]=(l$I-l$c)*l$j,l$w[10]=(1-(l$M+l$t))*l$j,l$w[11]=0,l$w[12]=l$b[0],l$w[13]=l$b[1],l$w[14]=l$b[2],l$w[15]=1},l$q.createLookAt=function(l$i,l$_,l$R,l$r){var l$b=l$r.elements,l$z=l$q._tempVector0,l$L=l$q._tempVector1,l$w=l$q._tempVector2;l$L_.subtract(l$i,l$_,l$w),l$L_.normalize(l$w,l$w),l$L_.cross(l$R,l$w,l$z),l$L_.normalize(l$z,l$z),l$L_.cross(l$w,l$z,l$L),l$r.identity(),l$b[0]=l$z.x,l$b[4]=l$z.y,l$b[8]=l$z.z,l$b[1]=l$L.x,l$b[5]=l$L.y,l$b[9]=l$L.z,l$b[2]=l$w.x,l$b[6]=l$w.y,l$b[10]=l$w.z,l$b[12]=-l$L_.dot(l$z,l$i),l$b[13]=-l$L_.dot(l$L,l$i),l$b[14]=-l$L_.dot(l$w,l$i)},l$q.createPerspective=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$b.elements,l$L=1/Math.tan(l$i/2),l$w=1/(l$R-l$r);l$z[0]=l$L/l$_,l$z[5]=l$L,l$z[10]=(l$r+l$R)*l$w,l$z[11]=-1,l$z[14]=2*l$r*l$R*l$w,l$z[1]=l$z[2]=l$z[3]=l$z[4]=l$z[6]=l$z[7]=l$z[8]=l$z[9]=l$z[12]=l$z[13]=l$z[15]=0},l$q.createOrthoOffCenterRH=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){var l$w=l$L.elements,l$x=1/(l$i-l$_),l$P=1/(l$R-l$r),l$B=1/(l$b-l$z);l$w[1]=l$w[2]=l$w[3]=l$w[4]=l$w[6]=l$w[7]=l$w[8]=l$w[9]=l$w[11]=0,l$w[15]=1,l$w[0]=-2*l$x,l$w[5]=-2*l$P,l$w[10]=2*l$B,l$w[12]=(l$i+l$_)*l$x,l$w[13]=(l$r+l$R)*l$P,l$w[14]=(l$z+l$b)*l$B},l$q.translation=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements;l$r[0]=l$r[5]=l$r[10]=l$r[15]=1,l$r[12]=l$R[0],l$r[13]=l$R[1],l$r[14]=l$R[2]},l$n(l$q,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new l$q},"_tempVector0",function(){return this._tempVector0=new l$L_},"_tempVector1",function(){return this._tempVector1=new l$L_},"_tempVector2",function(){return this._tempVector2=new l$L_},"_tempQuaternion",function(){return this._tempQuaternion=new l$R_},"DEFAULT",function(){return this.DEFAULT=new l$q},"ZERO",function(){return this.ZERO=new l$q(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),l$q}(),l$__=(function(){function l$I(l$i,l$_){this.extents=null,this.transformation=null,this.extents=l$i,this.transformation=l$_}l$J(l$I,"laya.d3.math.OrientedBoundBox");var l$i=l$I.prototype;l$i.getCorners=function(l$i){var l$_=l$I._tempV30.elements,l$R=l$I._tempV31.elements,l$r=l$I._tempV32.elements,l$b=this.extents.elements;l$_[0]=l$b[0],l$_[1]=l$_[2]=0,l$R[1]=l$b[1],l$R[0]=l$R[2]=0,l$r[2]=l$b[2],l$r[0]=l$r[1]=0,l$L_.TransformNormal(l$I._tempV30,this.transformation,l$I._tempV30),l$L_.TransformNormal(l$I._tempV31,this.transformation,l$I._tempV31),l$L_.TransformNormal(l$I._tempV32,this.transformation,l$I._tempV32);var l$z=l$I._tempV33;this.transformation.getTranslationVector(l$z),l$i.length=8,l$L_.add(l$z,l$I._tempV30,l$I._tempV34),l$L_.add(l$I._tempV34,l$I._tempV31,l$I._tempV34),l$L_.add(l$I._tempV34,l$I._tempV32,l$i[0]),l$L_.add(l$z,l$I._tempV30,l$I._tempV34),l$L_.add(l$I._tempV34,l$I._tempV31,l$I._tempV34),l$L_.subtract(l$I._tempV34,l$I._tempV32,l$i[1]),l$L_.subtract(l$z,l$I._tempV30,l$I._tempV34),l$L_.add(l$I._tempV34,l$I._tempV31,l$I._tempV34),l$L_.subtract(l$I._tempV34,l$I._tempV32,l$i[2]),l$L_.subtract(l$z,l$I._tempV30,l$I._tempV34),l$L_.add(l$I._tempV34,l$I._tempV31,l$I._tempV34),l$L_.add(l$I._tempV34,l$I._tempV32,l$i[3]),l$L_.add(l$z,l$I._tempV30,l$I._tempV34),l$L_.subtract(l$I._tempV34,l$I._tempV31,l$I._tempV34),l$L_.add(l$I._tempV34,l$I._tempV32,l$i[4]),l$L_.add(l$z,l$I._tempV30,l$I._tempV34),l$L_.subtract(l$I._tempV34,l$I._tempV31,l$I._tempV34),l$L_.subtract(l$I._tempV34,l$I._tempV32,l$i[5]),l$L_.subtract(l$z,l$I._tempV30,l$I._tempV34),l$L_.subtract(l$I._tempV34,l$I._tempV31,l$I._tempV34),l$L_.subtract(l$I._tempV34,l$I._tempV32,l$i[6]),l$L_.subtract(l$z,l$I._tempV30,l$I._tempV34),l$L_.subtract(l$I._tempV34,l$I._tempV31,l$I._tempV34),l$L_.add(l$I._tempV34,l$I._tempV32,l$i[7])},l$i.transform=function(l$i){l$i_.multiply(this.transformation,l$i,this.transformation)},l$i.scale=function(l$i){l$L_.multiply(this.extents,l$i,this.extents)},l$i.translate=function(l$i){this.transformation.getTranslationVector(l$I._tempV30),l$L_.add(l$I._tempV30,l$i,l$I._tempV31),this.transformation.setTranslationVector(l$I._tempV31)},l$i.Size=function(l$i){l$L_.scale(this.extents,2,l$i)},l$i.getSize=function(l$i){var l$_=this.extents.elements;l$I._tempV30.x=l$_[0],l$I._tempV31.y=l$_[1],l$I._tempV32.z=l$_[2],l$L_.TransformNormal(l$I._tempV30,this.transformation,l$I._tempV30),l$L_.TransformNormal(l$I._tempV31,this.transformation,l$I._tempV31),l$L_.TransformNormal(l$I._tempV31,this.transformation,l$I._tempV32);var l$R=l$i.elements;l$R[0]=l$L_.scalarLength(l$I._tempV30),l$R[1]=l$L_.scalarLength(l$I._tempV31),l$R[2]=l$L_.scalarLength(l$I._tempV32)},l$i.getSizeSquared=function(l$i){var l$_=this.extents.elements;l$I._tempV30.x=l$_[0],l$I._tempV31.y=l$_[1],l$I._tempV32.z=l$_[2],l$L_.TransformNormal(l$I._tempV30,this.transformation,l$I._tempV30),l$L_.TransformNormal(l$I._tempV31,this.transformation,l$I._tempV31),l$L_.TransformNormal(l$I._tempV31,this.transformation,l$I._tempV32);var l$R=l$i.elements;l$R[0]=l$L_.scalarLengthSquared(l$I._tempV30),l$R[1]=l$L_.scalarLengthSquared(l$I._tempV31),l$R[2]=l$L_.scalarLengthSquared(l$I._tempV32)},l$i.getCenter=function(l$i){this.transformation.getTranslationVector(l$i)},l$i.containsPoint=function(l$i){var l$_=this.extents.elements,l$R=l$_[0],l$r=l$_[1],l$b=l$_[2];this.transformation.invert(l$I._tempM0),l$L_.transformCoordinate(l$i,l$I._tempM0,l$I._tempV30);var l$z=l$I._tempV30.elements,l$L=Math.abs(l$z[0]),l$w=Math.abs(l$z[1]),l$x=Math.abs(l$z[2]);return l$Wi.nearEqual(l$L,l$R)&&l$Wi.nearEqual(l$w,l$r)&&l$Wi.nearEqual(l$x,l$b)?2:l$L<l$R&&l$w<l$r&&l$x<l$b?1:0},l$i.containsPoints=function(l$i){var l$_=this.extents.elements,l$R=l$_[0],l$r=l$_[1],l$b=l$_[2];this.transformation.invert(l$I._tempM0);for(var l$z=!0,l$L=!1,l$w=0;l$w<l$i.length;l$w++){l$L_.transformCoordinate(l$i[l$w],l$I._tempM0,l$I._tempV30);var l$x=l$I._tempV30.elements,l$P=Math.abs(l$x[0]),l$B=Math.abs(l$x[1]),l$n=Math.abs(l$x[2]);l$Wi.nearEqual(l$P,l$R)&&l$Wi.nearEqual(l$B,l$r)&&l$Wi.nearEqual(l$n,l$b)&&(l$L=!0),l$P<l$R&&l$B<l$r&&l$n<l$b?l$L=!0:l$z=!1}return l$z?1:l$L?2:0},l$i.containsSphere=function(l$i,l$_){void 0===l$_&&(l$_=!1);var l$R=this.extents.elements,l$r=l$R[0],l$b=l$R[1],l$z=l$R[2],l$L=l$i.radius;this.transformation.invert(l$I._tempM0),l$L_.transformCoordinate(l$i.center,l$I._tempM0,l$I._tempV30);var l$w=NaN;if(l$w=l$_?l$L:(l$L_.scale(l$L_.UnitX,l$L,l$I._tempV31),l$L_.TransformNormal(l$I._tempV31,l$I._tempM0,l$I._tempV31),l$L_.scalarLength(l$I._tempV31)),l$L_.scale(this.extents,-1,l$I._tempV32),l$L_.Clamp(l$I._tempV30,l$I._tempV32,this.extents,l$I._tempV33),l$w*l$w<l$L_.distanceSquared(l$I._tempV30,l$I._tempV33))return 0;var l$x=l$I._tempV30.elements,l$P=l$x[0],l$B=l$x[1],l$n=l$x[2],l$f=l$I._tempV32.elements,l$J=l$f[0],l$h=l$f[1],l$M=l$f[2];return l$J+l$w<=l$P&&l$P<=l$r-l$w&&l$w<l$r-l$J&&l$h+l$w<=l$B&&l$B<=l$b-l$w&&l$w<l$b-l$h&&l$M+l$w<=l$n&&l$n<=l$z-l$w&&l$w<l$z-l$M?1:2},l$i.containsOrientedBoundBox=function(l$i){var l$_=0,l$R=0;l$i.getCorners(l$I._corners);var l$r=this.containsPoints(l$I._corners);if(0!=l$r)return l$r;var l$b=this.extents.elements;l$i.extents.cloneTo(l$I._tempV35);var l$z=l$I._tempV35.elements;l$I._getRows(this.transformation,l$I._rows1),l$I._getRows(l$i.transformation,l$I._rows2);var l$L=NaN;for(l$_=0;l$_<4;l$_++)for(l$R=0;l$R<4;l$R++)3==l$_||3==l$R?(l$I._tempM0.setElementByRowColumn(l$_,l$R,0),l$I._tempM1.setElementByRowColumn(l$_,l$R,0)):(l$L=l$L_.dot(l$I._rows1[l$_],l$I._rows2[l$R]),l$I._tempM0.setElementByRowColumn(l$_,l$R,l$L),l$I._tempM1.setElementByRowColumn(l$_,l$R,Math.abs(l$L)));l$i.getCenter(l$I._tempV34),this.getCenter(l$I._tempV36),l$L_.subtract(l$I._tempV34,l$I._tempV36,l$I._tempV30);var l$w=l$I._tempV31.elements;l$w[0]=l$L_.dot(l$I._tempV30,l$I._rows1[0]),l$w[1]=l$L_.dot(l$I._tempV30,l$I._rows1[1]),l$w[2]=l$L_.dot(l$I._tempV30,l$I._rows1[2]);var l$x=l$I._tempV32.elements,l$P=l$I._tempV33.elements;for(l$_=0;l$_<3;l$_++)if(l$x[0]=l$I._tempM1.getElementByRowColumn(l$_,0),l$x[1]=l$I._tempM1.getElementByRowColumn(l$_,1),l$x[2]=l$I._tempM1.getElementByRowColumn(l$_,2),l$b[l$_]+l$L_.dot(l$I._tempV35,l$I._tempV32)<Math.abs(l$w[l$_]))return 0;for(l$R=0;l$R<3;l$R++)if(l$x[0]=l$I._tempM1.getElementByRowColumn(0,l$R),l$x[1]=l$I._tempM1.getElementByRowColumn(1,l$R),l$x[2]=l$I._tempM1.getElementByRowColumn(2,l$R),l$P[0]=l$I._tempM0.getElementByRowColumn(0,l$R),l$P[1]=l$I._tempM0.getElementByRowColumn(1,l$R),l$P[2]=l$I._tempM0.getElementByRowColumn(2,l$R),l$L_.dot(this.extents,l$I._tempV32)+l$z[l$R]<Math.abs(l$L_.dot(l$I._tempV31,l$I._tempV33)))return 0;for(l$_=0;l$_<3;l$_++)for(l$R=0;l$R<3;l$R++){var l$B=(l$_+1)%3,l$n=(l$_+2)%3,l$f=(l$R+1)%3,l$J=(l$R+2)%3;if(l$b[l$B]*l$I._tempM1.getElementByRowColumn(l$n,l$R)+l$b[l$n]*l$I._tempM1.getElementByRowColumn(l$B,l$R)+(l$z[l$f]*l$I._tempM1.getElementByRowColumn(l$_,l$J)+l$z[l$J]*l$I._tempM1.getElementByRowColumn(l$_,l$f))<Math.abs(l$w[l$n]*l$I._tempM0.getElementByRowColumn(l$B,l$R)-l$w[l$B]*l$I._tempM0.getElementByRowColumn(l$n,l$R)))return 0}return 2},l$i.containsLine=function(l$i,l$_){l$I._corners[0]=l$i,l$I._corners[1]=l$_;var l$R=this.containsPoints(l$I._corners);if(0!=l$R)return l$R;var l$r=this.extents.elements,l$b=l$r[0],l$z=l$r[1],l$L=l$r[2];this.transformation.invert(l$I._tempM0),l$L_.transformCoordinate(l$i,l$I._tempM0,l$I._tempV30),l$L_.transformCoordinate(l$_,l$I._tempM0,l$I._tempV31),l$L_.add(l$I._tempV30,l$I._tempV31,l$I._tempV32),l$L_.scale(l$I._tempV32,.5,l$I._tempV32),l$L_.subtract(l$I._tempV30,l$I._tempV32,l$I._tempV33);var l$w=l$I._tempV33.elements,l$x=l$w[0],l$P=l$w[1],l$B=l$w[2],l$n=l$I._tempV34.elements,l$f=l$n[0]=Math.abs(l$w[0]),l$J=l$n[1]=Math.abs(l$w[1]),l$h=l$n[2]=Math.abs(l$w[2]),l$M=l$I._tempV32.elements,l$N=l$M[0],l$X=l$M[1],l$t=l$M[2];return Math.abs(l$N)>l$b+l$f?0:Math.abs(l$X)>l$z+l$J?0:Math.abs(l$t)>l$L+l$h?0:Math.abs(l$X*l$B-l$t*l$P)>l$z*l$h+l$L*l$J?0:Math.abs(l$N*l$B-l$t*l$x)>l$b*l$h+l$L*l$f?0:Math.abs(l$N*l$P-l$X*l$x)>l$b*l$J+l$z*l$f?0:2},l$i.containsBoundBox=function(l$i){var l$_=0,l$R=0,l$r=l$i.min,l$b=l$i.max;l$i.getCorners(l$I._corners);var l$z=this.containsPoints(l$I._corners);if(0!=l$z)return l$z;l$L_.subtract(l$b,l$r,l$I._tempV30),l$L_.scale(l$I._tempV30,.5,l$I._tempV30),l$L_.add(l$r,l$I._tempV30,l$I._tempV30),l$L_.subtract(l$b,l$I._tempV30,l$I._tempV31);var l$L=this.extents.elements,l$w=l$I._tempV31.elements;l$I._getRows(this.transformation,l$I._rows1),this.transformation.invert(l$I._tempM0);for(l$_=0;l$_<3;l$_++)for(l$R=0;l$R<3;l$R++)l$I._tempM1.setElementByRowColumn(l$_,l$R,Math.abs(l$I._tempM0.getElementByRowColumn(l$_,l$R)));this.getCenter(l$I._tempV35),l$L_.subtract(l$I._tempV30,l$I._tempV35,l$I._tempV32);var l$x=l$I._tempV31.elements;l$x[0]=l$L_.dot(l$I._tempV32,l$I._rows1[0]),l$x[1]=l$L_.dot(l$I._tempV32,l$I._rows1[1]),l$x[2]=l$L_.dot(l$I._tempV32,l$I._rows1[2]);var l$P=l$I._tempV33.elements,l$B=l$I._tempV34.elements;for(l$_=0;l$_<3;l$_++)if(l$P[0]=l$I._tempM1.getElementByRowColumn(l$_,0),l$P[1]=l$I._tempM1.getElementByRowColumn(l$_,1),l$P[2]=l$I._tempM1.getElementByRowColumn(l$_,2),l$L[l$_]+l$L_.dot(l$I._tempV31,l$I._tempV33)<Math.abs(l$x[l$_]))return 0;for(l$R=0;l$R<3;l$R++)if(l$P[0]=l$I._tempM1.getElementByRowColumn(0,l$R),l$P[1]=l$I._tempM1.getElementByRowColumn(1,l$R),l$P[2]=l$I._tempM1.getElementByRowColumn(2,l$R),l$B[0]=l$I._tempM0.getElementByRowColumn(0,l$R),l$B[1]=l$I._tempM0.getElementByRowColumn(1,l$R),l$B[2]=l$I._tempM0.getElementByRowColumn(2,l$R),l$L_.dot(this.extents,l$I._tempV33)+l$w[l$R]<Math.abs(l$L_.dot(l$I._tempV31,l$I._tempV34)))return 0;for(l$_=0;l$_<3;l$_++)for(l$R=0;l$R<3;l$R++){var l$n=(l$_+1)%3,l$f=(l$_+2)%3,l$J=(l$R+1)%3,l$h=(l$R+2)%3;if(l$L[l$n]*l$I._tempM1.getElementByRowColumn(l$f,l$R)+l$L[l$f]*l$I._tempM1.getElementByRowColumn(l$n,l$R)+(l$w[l$J]*l$I._tempM1.getElementByRowColumn(l$_,l$h)+l$w[l$h]*l$I._tempM1.getElementByRowColumn(l$_,l$J))<Math.abs(l$x[l$f]*l$I._tempM0.getElementByRowColumn(l$n,l$R)-l$x[l$n]*l$I._tempM0.getElementByRowColumn(l$f,l$R)))return 0}return 2},l$i.intersectsRay=function(l$i,l$_){l$L_.scale(this.extents,-1,l$I._tempV30),this.transformation.invert(l$I._tempM0),l$L_.TransformNormal(l$i.direction,l$I._tempM0,l$I._ray.direction),l$L_.transformCoordinate(l$i.origin,l$I._tempM0,l$I._ray.origin),l$I._boxBound1.min=l$I._tempV30,l$I._boxBound1.max=this.extents;var l$R=Collision.intersectsRayAndBoxRP(l$I._ray,l$I._boxBound1,l$_);return-1!==l$R&&l$L_.transformCoordinate(l$_,this.transformation,l$_),l$R},l$i._getLocalCorners=function(l$i){l$i.length=8;var l$_=this.extents.elements;l$I._tempV30.x=l$_[0],l$I._tempV31.y=l$_[1],l$I._tempV32.z=l$_[2],l$L_.add(l$I._tempV30,l$I._tempV31,l$I._tempV33),l$L_.add(l$I._tempV33,l$I._tempV32,l$i[0]),l$L_.add(l$I._tempV30,l$I._tempV31,l$I._tempV33),l$L_.subtract(l$I._tempV33,l$I._tempV32,l$i[1]),l$L_.subtract(l$I._tempV31,l$I._tempV30,l$I._tempV33),l$L_.subtract(l$I._tempV33,l$I._tempV30,l$i[2]),l$L_.subtract(l$I._tempV31,l$I._tempV30,l$I._tempV33),l$L_.add(l$I._tempV33,l$I._tempV32,l$i[3]),l$L_.subtract(l$I._tempV30,l$I._tempV31,l$I._tempV33),l$L_.add(l$I._tempV33,l$I._tempV32,l$i[4]),l$L_.subtract(l$I._tempV30,l$I._tempV31,l$I._tempV33),l$L_.subtract(l$I._tempV33,l$I._tempV32,l$i[5]),l$L_.scale(l$i[0],-1,l$i[6]),l$L_.subtract(l$I._tempV32,l$I._tempV30,l$I._tempV33),l$L_.subtract(l$I._tempV33,l$I._tempV31,l$i[7])},l$i.equals=function(l$i){return this.extents==l$i.extents&&this.transformation==l$i.transformation},l$i.cloneTo=function(l$i){var l$_=l$i;this.extents.cloneTo(l$_.extents),this.transformation.cloneTo(l$_.transformation)},l$I.createByBoundBox=function(l$i,l$_){var l$R=l$i.min,l$r=l$i.max;l$L_.subtract(l$r,l$R,l$I._tempV30),l$L_.scale(l$I._tempV30,.5,l$I._tempV30),l$L_.add(l$R,l$I._tempV30,l$I._tempV31),l$L_.subtract(l$r,l$I._tempV31,l$I._tempV32),l$i_.translation(l$I._tempV31,l$I._tempM0);var l$b=l$I._tempV32.clone(),l$z=l$I._tempM0.clone();l$_.extents=l$b,l$_.transformation=l$z},l$I.createByMinAndMaxVertex=function(l$i,l$_){return l$L_.subtract(l$_,l$i,l$I._tempV30),l$L_.scale(l$I._tempV30,.5,l$I._tempV30),l$L_.add(l$i,l$I._tempV30,l$I._tempV31),l$L_.subtract(l$_,l$I._tempV31,l$I._tempV32),l$i_.translation(l$I._tempV31,l$I._tempM0),new l$I(l$I._tempV32,l$I._tempM0)},l$I._getRows=function(l$i,l$_){l$_.length=3;var l$R=l$i.elements,l$r=l$_[0].elements;l$r[0]=l$R[0],l$r[1]=l$R[1],l$r[2]=l$R[2];var l$b=l$_[1].elements;l$b[0]=l$R[4],l$b[1]=l$R[5],l$b[2]=l$R[6];var l$z=l$_[2].elements;l$z[0]=l$R[8],l$z[1]=l$R[9],l$z[2]=l$R[10]},l$I.getObbtoObbMatrix4x4=function(l$i,l$_,l$R,l$r){var l$b=l$i.transformation,l$z=l$_.transformation;if(l$R){l$I._getRows(l$b,l$I._rows1),l$I._getRows(l$z,l$I._rows2);for(var l$L=0;l$L<3;l$L++)for(var l$w=0;l$w<3;l$w++)l$r.setElementByRowColumn(l$L,l$w,l$L_.dot(l$I._rows2[l$L],l$I._rows1[l$w]));l$_.getCenter(l$I._tempV30),l$i.getCenter(l$I._tempV31),l$L_.subtract(l$I._tempV30,l$I._tempV31,l$I._tempV32);var l$x=l$r.elements;l$x[12]=l$L_.dot(l$I._tempV32,l$I._rows1[0]),l$x[13]=l$L_.dot(l$I._tempV32,l$I._rows1[1]),l$x[14]=l$L_.dot(l$I._tempV32,l$I._rows1[2]),l$x[15]=1}else l$b.invert(l$I._tempM0),l$i_.multiply(l$z,l$I._tempM0,l$r)},l$I.merge=function(l$i,l$_,l$R){var l$r=l$i.extents,l$b=l$i.transformation;l$I.getObbtoObbMatrix4x4(l$i,l$_,l$R,l$I._tempM0),l$_._getLocalCorners(l$I._corners),l$L_.transformCoordinate(l$I._corners[0],l$I._tempM0,l$I._corners[0]),l$L_.transformCoordinate(l$I._corners[1],l$I._tempM0,l$I._corners[1]),l$L_.transformCoordinate(l$I._corners[2],l$I._tempM0,l$I._corners[2]),l$L_.transformCoordinate(l$I._corners[3],l$I._tempM0,l$I._corners[3]),l$L_.transformCoordinate(l$I._corners[4],l$I._tempM0,l$I._corners[4]),l$L_.transformCoordinate(l$I._corners[5],l$I._tempM0,l$I._corners[5]),l$L_.transformCoordinate(l$I._corners[6],l$I._tempM0,l$I._corners[6]),l$L_.transformCoordinate(l$I._corners[7],l$I._tempM0,l$I._corners[7]),l$L_.scale(l$r,-1,l$I._boxBound1.min),l$r.cloneTo(l$I._boxBound1.max),l$di.createfromPoints(l$I._corners,l$I._boxBound2),l$di.merge(l$I._boxBound2,l$I._boxBound1,l$I._boxBound3);var l$z=l$I._boxBound3.min,l$L=l$I._boxBound3.max;l$L_.subtract(l$L,l$z,l$I._tempV30),l$L_.scale(l$I._tempV30,.5,l$I._tempV30),l$L_.add(l$z,l$I._tempV30,l$I._tempV32),l$L_.subtract(l$L,l$I._tempV32,l$r),l$L_.transformCoordinate(l$I._tempV32,l$b,l$I._tempV33)},l$n(l$I,["_tempV30",function(){return this._tempV30=new l$L_},"_tempV31",function(){return this._tempV31=new l$L_},"_tempV32",function(){return this._tempV32=new l$L_},"_tempV33",function(){return this._tempV33=new l$L_},"_tempV34",function(){return this._tempV34=new l$L_},"_tempV35",function(){return this._tempV35=new l$L_},"_tempV36",function(){return this._tempV36=new l$L_},"_tempM0",function(){return this._tempM0=new l$i_},"_tempM1",function(){return this._tempM1=new l$i_},"_corners",function(){return this._corners=[new l$L_,new l$L_,new l$L_,new l$L_,new l$L_,new l$L_,new l$L_,new l$L_]},"_rows1",function(){return this._rows1=[new l$L_,new l$L_,new l$L_]},"_rows2",function(){return this._rows2=[new l$L_,new l$L_,new l$L_]},"_ray",function(){return this._ray=new l$b_(new l$L_,new l$L_)},"_boxBound1",function(){return this._boxBound1=new l$di(new l$L_,new l$L_)},"_boxBound2",function(){return this._boxBound2=new l$di(new l$L_,new l$L_)},"_boxBound3",function(){return this._boxBound3=new l$di(new l$L_,new l$L_)}])}(),function(){function l$c(l$i,l$_){this.normal=null,this.distance=NaN,void 0===l$_&&(l$_=0),this.normal=l$i,this.distance=l$_}return l$J(l$c,"laya.d3.math.Plane"),l$c.prototype.normalize=function(){var l$i=this.normal.elements,l$_=l$i[0],l$R=l$i[1],l$r=l$i[2],l$b=1/Math.sqrt(l$_*l$_+l$R*l$R+l$r*l$r);l$i[0]=l$_*l$b,l$i[1]=l$R*l$b,l$i[2]=l$r*l$b,this.distance*=l$b},l$c.createPlaneBy3P=function(l$i,l$_,l$R){var l$r=l$i.elements,l$b=l$_.elements,l$z=l$R.elements,l$L=l$b[0]-l$r[0],l$w=l$b[1]-l$r[1],l$x=l$b[2]-l$r[2],l$P=l$z[0]-l$r[0],l$B=l$z[1]-l$r[1],l$n=l$z[2]-l$r[2],l$f=l$w*l$n-l$x*l$B,l$J=l$x*l$P-l$L*l$n,l$h=l$L*l$B-l$w*l$P,l$M=1/Math.sqrt(l$f*l$f+l$J*l$J+l$h*l$h),l$N=l$f*l$M,l$X=l$J*l$M,l$t=l$h*l$M,l$I=l$c._TEMPVec3.elements;l$I[0]=l$N,l$I[1]=l$X,l$I[2]=l$t;var l$e=-(l$N*l$r[0]+l$X*l$r[1]+l$t*l$r[2]);return new l$c(l$c._TEMPVec3,l$e)},l$c.PlaneIntersectionType_Back=0,l$c.PlaneIntersectionType_Front=1,l$c.PlaneIntersectionType_Intersecting=2,l$n(l$c,["_TEMPVec3",function(){return this._TEMPVec3=new l$L_}]),l$c}()),l$R_=function(){function l$b(l$i,l$_,l$R,l$r){this.elements=new Float32Array(4),void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=1),this.elements[0]=l$i,this.elements[1]=l$_,this.elements[2]=l$R,this.elements[3]=l$r}l$J(l$b,"laya.d3.math.Quaternion");var l$i=l$b.prototype;return l$c.imps(l$i,{"laya.d3.core.IClone":!0}),l$i.scaling=function(l$i,l$_){var l$R=l$_.elements,l$r=this.elements;l$R[0]=l$r[0]*l$i,l$R[1]=l$r[1]*l$i,l$R[2]=l$r[2]*l$i,l$R[3]=l$r[3]*l$i},l$i.normalize=function(l$i){var l$_=l$i.elements,l$R=this.elements,l$r=l$R[0],l$b=l$R[1],l$z=l$R[2],l$L=l$R[3],l$w=l$r*l$r+l$b*l$b+l$z*l$z+l$L*l$L;0<l$w&&(l$w=1/Math.sqrt(l$w),l$_[0]=l$r*l$w,l$_[1]=l$b*l$w,l$_[2]=l$z*l$w,l$_[3]=l$L*l$w)},l$i.length=function(){var l$i=this.elements,l$_=l$i[0],l$R=l$i[1],l$r=l$i[2],l$b=l$i[3];return Math.sqrt(l$_*l$_+l$R*l$R+l$r*l$r+l$b*l$b)},l$i.rotateX=function(l$i,l$_){var l$R=l$_.elements,l$r=this.elements;l$i*=.5;var l$b=l$r[0],l$z=l$r[1],l$L=l$r[2],l$w=l$r[3],l$x=Math.sin(l$i),l$P=Math.cos(l$i);l$R[0]=l$b*l$P+l$w*l$x,l$R[1]=l$z*l$P+l$L*l$x,l$R[2]=l$L*l$P-l$z*l$x,l$R[3]=l$w*l$P-l$b*l$x},l$i.rotateY=function(l$i,l$_){var l$R=l$_.elements,l$r=this.elements;l$i*=.5;var l$b=l$r[0],l$z=l$r[1],l$L=l$r[2],l$w=l$r[3],l$x=Math.sin(l$i),l$P=Math.cos(l$i);l$R[0]=l$b*l$P-l$L*l$x,l$R[1]=l$z*l$P+l$w*l$x,l$R[2]=l$L*l$P+l$b*l$x,l$R[3]=l$w*l$P-l$z*l$x},l$i.rotateZ=function(l$i,l$_){var l$R=l$_.elements,l$r=this.elements;l$i*=.5;var l$b=l$r[0],l$z=l$r[1],l$L=l$r[2],l$w=l$r[3],l$x=Math.sin(l$i),l$P=Math.cos(l$i);l$R[0]=l$b*l$P+l$z*l$x,l$R[1]=l$z*l$P-l$b*l$x,l$R[2]=l$L*l$P+l$w*l$x,l$R[3]=l$w*l$P-l$L*l$x},l$i.getYawPitchRoll=function(l$i){l$L_.transformQuat(l$L_.ForwardRH,this,l$b.TEMPVector31),l$L_.transformQuat(l$L_.Up,this,l$b.TEMPVector32);var l$_=l$b.TEMPVector32.elements;l$b.angleTo(l$L_.ZERO,l$b.TEMPVector31,l$b.TEMPVector33);var l$R=l$b.TEMPVector33.elements;l$R[0]==Math.PI/2?(l$R[1]=l$b.arcTanAngle(l$_[2],l$_[0]),l$R[2]=0):l$R[0]==-Math.PI/2?(l$R[1]=l$b.arcTanAngle(-l$_[2],-l$_[0]),l$R[2]=0):(l$i_.createRotationY(-l$R[1],l$b.TEMPMatrix0),l$i_.createRotationX(-l$R[0],l$b.TEMPMatrix1),l$L_.transformCoordinate(l$b.TEMPVector32,l$b.TEMPMatrix0,l$b.TEMPVector32),l$L_.transformCoordinate(l$b.TEMPVector32,l$b.TEMPMatrix1,l$b.TEMPVector32),l$R[2]=l$b.arcTanAngle(l$_[1],-l$_[0])),l$R[1]<=-Math.PI&&(l$R[1]=Math.PI),l$R[2]<=-Math.PI&&(l$R[2]=Math.PI),l$R[1]>=Math.PI&&l$R[2]>=Math.PI&&(l$R[1]=0,l$R[2]=0,l$R[0]=Math.PI-l$R[0]);var l$r=l$i.elements;l$r[0]=l$R[1],l$r[1]=l$R[0],l$r[2]=l$R[2]},l$i.invert=function(l$i){var l$_=l$i.elements,l$R=this.elements,l$r=l$R[0],l$b=l$R[1],l$z=l$R[2],l$L=l$R[3],l$w=l$r*l$r+l$b*l$b+l$z*l$z+l$L*l$L,l$x=l$w?1/l$w:0;l$_[0]=-l$r*l$x,l$_[1]=-l$b*l$x,l$_[2]=-l$z*l$x,l$_[3]=l$L*l$x},l$i.identity=function(){var l$i=this.elements;l$i[0]=0,l$i[1]=0,l$i[2]=0,l$i[3]=1},l$i.fromArray=function(l$i,l$_){void 0===l$_&&(l$_=0),this.elements[0]=l$i[l$_+0],this.elements[1]=l$i[l$_+1],this.elements[2]=l$i[l$_+2],this.elements[3]=l$i[l$_+3]},l$i.cloneTo=function(l$i){var l$_,l$R,l$r;if((l$R=this.elements)!==(l$r=l$i.elements))for(l$_=0;l$_<4;++l$_)l$r[l$_]=l$R[l$_]},l$i.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$i.equals=function(l$i){var l$_=this.elements,l$R=l$i.elements;return l$Wi.nearEqual(l$_[0],l$R[0])&&l$Wi.nearEqual(l$_[1],l$R[1])&&l$Wi.nearEqual(l$_[2],l$R[2])&&l$Wi.nearEqual(l$_[3],l$R[3])},l$i.lengthSquared=function(){var l$i=this.elements[0],l$_=this.elements[1],l$R=this.elements[2],l$r=this.elements[3];return l$i*l$i+l$_*l$_+l$R*l$R+l$r*l$r},l$h(0,l$i,"x",function(){return this.elements[0]}),l$h(0,l$i,"y",function(){return this.elements[1]}),l$h(0,l$i,"z",function(){return this.elements[2]}),l$h(0,l$i,"w",function(){return this.elements[3]}),l$b.createFromYawPitchRoll=function(l$i,l$_,l$R,l$r){var l$b=.5*l$R,l$z=.5*l$_,l$L=.5*l$i,l$w=Math.sin(l$b),l$x=Math.cos(l$b),l$P=Math.sin(l$z),l$B=Math.cos(l$z),l$n=Math.sin(l$L),l$f=Math.cos(l$L),l$J=l$r.elements;l$J[0]=l$f*l$P*l$x+l$n*l$B*l$w,l$J[1]=l$n*l$B*l$x-l$f*l$P*l$w,l$J[2]=l$f*l$B*l$w-l$n*l$P*l$x,l$J[3]=l$f*l$B*l$x+l$n*l$P*l$w},l$b.multiply=function(l$i,l$_,l$R){var l$r=l$i.elements,l$b=l$_.elements,l$z=l$R.elements,l$L=l$r[0],l$w=l$r[1],l$x=l$r[2],l$P=l$r[3],l$B=l$b[0],l$n=l$b[1],l$f=l$b[2],l$J=l$b[3],l$h=l$w*l$f-l$x*l$n,l$M=l$x*l$B-l$L*l$f,l$N=l$L*l$n-l$w*l$B,l$X=l$L*l$B+l$w*l$n+l$x*l$f;l$z[0]=l$L*l$J+l$B*l$P+l$h,l$z[1]=l$w*l$J+l$n*l$P+l$M,l$z[2]=l$x*l$J+l$f*l$P+l$N,l$z[3]=l$P*l$J-l$X},l$b.arcTanAngle=function(l$i,l$_){return 0==l$i?1==l$_?Math.PI/2:-Math.PI/2:0<l$i?Math.atan(l$_/l$i):l$i<0?0<l$_?Math.atan(l$_/l$i)+Math.PI:Math.atan(l$_/l$i)-Math.PI:0},l$b.angleTo=function(l$i,l$_,l$R){l$L_.subtract(l$_,l$i,l$b.TEMPVector30),l$L_.normalize(l$b.TEMPVector30,l$b.TEMPVector30),l$R.elements[0]=Math.asin(l$b.TEMPVector30.y),l$R.elements[1]=l$b.arcTanAngle(-l$b.TEMPVector30.z,-l$b.TEMPVector30.x)},l$b.createFromAxisAngle=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements;l$_*=.5;var l$z=Math.sin(l$_);l$r[0]=l$z*l$b[0],l$r[1]=l$z*l$b[1],l$r[2]=l$z*l$b[2],l$r[3]=Math.cos(l$_)},l$b.createFromMatrix3x3=function(l$i,l$_){var l$R,l$r=l$_.elements,l$b=l$i.elements,l$z=l$b[0]+l$b[4]+l$b[8];if(0<l$z)l$R=Math.sqrt(l$z+1),l$r[3]=.5*l$R,l$R=.5/l$R,l$r[0]=(l$b[5]-l$b[7])*l$R,l$r[1]=(l$b[6]-l$b[2])*l$R,l$r[2]=(l$b[1]-l$b[3])*l$R;else{var l$L=0;l$b[4]>l$b[0]&&(l$L=1),l$b[8]>l$b[3*l$L+l$L]&&(l$L=2);var l$w=(l$L+1)%3,l$x=(l$L+2)%3;l$R=Math.sqrt(l$b[3*l$L+l$L]-l$b[3*l$w+l$w]-l$b[3*l$x+l$x]+1),l$r[l$L]=.5*l$R,l$R=.5/l$R,l$r[3]=(l$b[3*l$w+l$x]-l$b[3*l$x+l$w])*l$R,l$r[l$w]=(l$b[3*l$w+l$L]+l$b[3*l$L+l$w])*l$R,l$r[l$x]=(l$b[3*l$x+l$L]+l$b[3*l$L+l$x])*l$R}},l$b.createFromMatrix4x4=function(l$i,l$_){var l$R,l$r,l$b=l$i.elements,l$z=l$_.elements,l$L=l$b[0]+l$b[5]+l$b[10];0<l$L?(l$R=Math.sqrt(l$L+1),l$z[3]=.5*l$R,l$R=.5/l$R,l$z[0]=(l$b[6]-l$b[9])*l$R,l$z[1]=(l$b[8]-l$b[2])*l$R,l$z[2]=(l$b[1]-l$b[4])*l$R):l$b[0]>=l$b[5]&&l$b[0]>=l$b[10]?(l$r=.5/(l$R=Math.sqrt(1+l$b[0]-l$b[5]-l$b[10])),l$z[0]=.5*l$R,l$z[1]=(l$b[1]+l$b[4])*l$r,l$z[2]=(l$b[2]+l$b[8])*l$r,l$z[3]=(l$b[6]-l$b[9])*l$r):l$b[5]>l$b[10]?(l$r=.5/(l$R=Math.sqrt(1+l$b[5]-l$b[0]-l$b[10])),l$z[0]=(l$b[4]+l$b[1])*l$r,l$z[1]=.5*l$R,l$z[2]=(l$b[9]+l$b[6])*l$r,l$z[3]=(l$b[8]-l$b[2])*l$r):(l$r=.5/(l$R=Math.sqrt(1+l$b[10]-l$b[0]-l$b[5])),l$z[0]=(l$b[8]+l$b[2])*l$r,l$z[1]=(l$b[9]+l$b[6])*l$r,l$z[2]=.5*l$R,l$z[3]=(l$b[1]-l$b[4])*l$r)},l$b.slerp=function(l$i,l$_,l$R,l$r){var l$b,l$z,l$L,l$w,l$x,l$P=l$i.elements,l$B=l$_.elements,l$n=l$r.elements,l$f=l$P[0],l$J=l$P[1],l$h=l$P[2],l$M=l$P[3],l$N=l$B[0],l$X=l$B[1],l$t=l$B[2],l$I=l$B[3];return(l$z=l$f*l$N+l$J*l$X+l$h*l$t+l$M*l$I)<0&&(l$z=-l$z,l$N=-l$N,l$X=-l$X,l$t=-l$t,l$I=-l$I),l$x=1e-6<1-l$z?(l$b=Math.acos(l$z),l$L=Math.sin(l$b),l$w=Math.sin((1-l$R)*l$b)/l$L,Math.sin(l$R*l$b)/l$L):(l$w=1-l$R,l$R),l$n[0]=l$w*l$f+l$x*l$N,l$n[1]=l$w*l$J+l$x*l$X,l$n[2]=l$w*l$h+l$x*l$t,l$n[3]=l$w*l$M+l$x*l$I,l$n},l$b.lerp=function(l$i,l$_,l$R,l$r){var l$b=l$r.elements,l$z=l$i.elements,l$L=l$_.elements,l$w=l$z[0],l$x=l$z[1],l$P=l$z[2],l$B=l$z[3];l$b[0]=l$w+l$R*(l$L[0]-l$w),l$b[1]=l$x+l$R*(l$L[1]-l$x),l$b[2]=l$P+l$R*(l$L[2]-l$P),l$b[3]=l$B+l$R*(l$L[3]-l$B)},l$b.add=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements;l$r[0]=l$b[0]+l$z[0],l$r[1]=l$b[1]+l$z[1],l$r[2]=l$b[2]+l$z[2],l$r[3]=l$b[3]+l$z[3]},l$b.dot=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements;return l$R[0]*l$r[0]+l$R[1]*l$r[1]+l$R[2]*l$r[2]+l$R[3]*l$r[3]},l$b.rotationLookAt=function(l$i,l$_,l$R){l$b.lookAt(l$L_.ZERO,l$i,l$_,l$R)},l$b.lookAt=function(l$i,l$_,l$R,l$r){l$Ti.lookAt(l$i,l$_,l$R,l$b._tempMatrix3x3),l$b.rotationMatrix(l$b._tempMatrix3x3,l$r)},l$b.invert=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements,l$b=l$i.lengthSquared();l$Wi.isZero(l$b)||(l$b=1/l$b,l$r[0]=-l$R[0]*l$b,l$r[1]=-l$R[1]*l$b,l$r[2]=-l$R[2]*l$b,l$r[3]=l$R[3]*l$b)},l$b.rotationMatrix=function(l$i,l$_){var l$R=l$i.elements,l$r=l$R[0],l$b=l$R[1],l$z=l$R[2],l$L=l$R[3],l$w=l$R[4],l$x=l$R[5],l$P=l$R[6],l$B=l$R[7],l$n=l$R[8],l$f=l$_.elements,l$J=NaN,l$h=NaN,l$M=l$r+l$w+l$n;0<l$M?(l$J=Math.sqrt(l$M+1),l$f[3]=.5*l$J,l$J=.5/l$J,l$f[0]=(l$x-l$B)*l$J,l$f[1]=(l$P-l$z)*l$J,l$f[2]=(l$b-l$L)*l$J):l$w<=l$r&&l$n<=l$r?(l$h=.5/(l$J=Math.sqrt(1+l$r-l$w-l$n)),l$f[0]=.5*l$J,l$f[1]=(l$b+l$L)*l$h,l$f[2]=(l$z+l$P)*l$h,l$f[3]=(l$x-l$B)*l$h):l$n<l$w?(l$h=.5/(l$J=Math.sqrt(1+l$w-l$r-l$n)),l$f[0]=(l$L+l$b)*l$h,l$f[1]=.5*l$J,l$f[2]=(l$B+l$x)*l$h,l$f[3]=(l$P-l$z)*l$h):(l$h=.5/(l$J=Math.sqrt(1+l$n-l$r-l$w)),l$f[0]=(l$P+l$z)*l$h,l$f[1]=(l$B+l$x)*l$h,l$f[2]=.5*l$J,l$f[3]=(l$b-l$L)*l$h)},l$b.DEFAULT=new l$b,l$n(l$b,["TEMPVector30",function(){return this.TEMPVector30=new l$L_},"TEMPVector31",function(){return this.TEMPVector31=new l$L_},"TEMPVector32",function(){return this.TEMPVector32=new l$L_},"TEMPVector33",function(){return this.TEMPVector33=new l$L_},"TEMPMatrix0",function(){return this.TEMPMatrix0=new l$i_},"TEMPMatrix1",function(){return this.TEMPMatrix1=new l$i_},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new l$Ti},"NAN",function(){return this.NAN=new l$b(NaN,NaN,NaN,NaN)}]),l$b}(),l$r_=function(){function l$i(l$i){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=l$i,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}l$J(l$i,"laya.d3.math.Rand");var l$_=l$i.prototype;return l$_.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},l$_.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},l$_.getSignedFloat=function(){return 2*this.getFloat()-1},l$h(0,l$_,"seed",function(){return this.seeds[0]},function(l$i){this.seeds[0]=l$i,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),l$i.getFloatFromInt=function(l$i){return 1/8388607*(8388607&l$i)},l$i.getByteFromInt=function(l$i){return(8388607&l$i)>>>15},l$i}(),l$b_=(function(){function l$b(l$i){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(l$i instanceof Array)||4!==l$i.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|l$i[0],this._state0L=0|l$i[1],this._state1U=0|l$i[2],this._state1L=0|l$i[3]}l$J(l$b,"laya.d3.math.RandX");var l$i=l$b.prototype;l$i.randomint=function(){var l$i=this._state0U,l$_=this._state0L,l$R=this._state1U,l$r=this._state1L,l$b=(l$r>>>0)+(l$_>>>0),l$z=l$R+l$i+(l$b/2>>>31)>>>0,l$L=l$b>>>0,l$w=0,l$x=0;l$w=(l$i^=l$w=l$i<<23|(-512&l$_)>>>9)^(this._state0U=l$R),l$x=(l$_^=l$x=l$_<<23)^(this._state0L=l$r);l$w^=l$i>>>18,l$x^=l$_>>>18|(262143&l$i)<<14;return l$w^=l$R>>>5,l$x^=l$r>>>5|(31&l$R)<<27,this._state1U=l$w,this._state1L=l$x,[l$z,l$L]},l$i.random=function(){var l$i=this.randomint(),l$_=l$i[0],l$R=1023<<20|l$_>>>12,l$r=0|(l$i[1]>>>12|(4095&l$_)<<20);return l$b._CONVERTION_BUFFER.setUint32(0,l$R,!1),l$b._CONVERTION_BUFFER.setUint32(4,l$r,!1),l$r_._CONVERTION_BUFFER.getFloat64(0,!1)-1},l$n(l$b,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new l$r_([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function l$i(l$i,l$_){this.origin=null,this.direction=null,this.origin=l$i,this.direction=l$_}return l$J(l$i,"laya.d3.math.Ray"),l$i}()),l$z_=function(){function l$i(l$i,l$_){this.elements=new Float32Array(2),void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0);var l$R=this.elements;l$R[0]=l$i,l$R[1]=l$_}l$J(l$i,"laya.d3.math.Vector2");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_.fromArray=function(l$i,l$_){void 0===l$_&&(l$_=0),this.elements[0]=l$i[l$_+0],this.elements[1]=l$i[l$_+1]},l$_.cloneTo=function(l$i){var l$_=l$i.elements,l$R=this.elements;l$_[0]=l$R[0],l$_[1]=l$R[1]},l$_.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$_,"x",function(){return this.elements[0]},function(l$i){this.elements[0]=l$i}),l$h(0,l$_,"y",function(){return this.elements[1]},function(l$i){this.elements[1]=l$i}),l$i.scale=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements;l$r[0]=l$b[0]*l$_,l$r[1]=l$b[1]*l$_},l$n(l$i,["ZERO",function(){return this.ZERO=new l$i(0,0)},"ONE",function(){return this.ONE=new l$i(1,1)}]),l$i}(),l$L_=function(){function l$B(l$i,l$_,l$R){this.elements=new Float32Array(3),void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0);var l$r=this.elements;l$r[0]=l$i,l$r[1]=l$_,l$r[2]=l$R}l$J(l$B,"laya.d3.math.Vector3");var l$i=l$B.prototype;return l$c.imps(l$i,{"laya.d3.core.IClone":!0}),l$i.fromArray=function(l$i,l$_){void 0===l$_&&(l$_=0),this.elements[0]=l$i[l$_+0],this.elements[1]=l$i[l$_+1],this.elements[2]=l$i[l$_+2]},l$i.cloneTo=function(l$i){var l$_=l$i.elements,l$R=this.elements;l$_[0]=l$R[0],l$_[1]=l$R[1],l$_[2]=l$R[2]},l$i.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$i.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},l$i.reset=function(l$i,l$_,l$R){this.elements[0]=l$i,this.elements[1]=l$_,this.elements[2]=l$R},l$h(0,l$i,"x",function(){return this.elements[0]},function(l$i){this.elements[0]=l$i}),l$h(0,l$i,"y",function(){return this.elements[1]},function(l$i){this.elements[1]=l$i}),l$h(0,l$i,"z",function(){return this.elements[2]},function(l$i){this.elements[2]=l$i}),l$B.distanceSquared=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements,l$b=l$R[0]-l$r[0],l$z=l$R[1]-l$r[1],l$L=l$R[2]-l$r[2];return l$b*l$b+l$z*l$z+l$L*l$L},l$B.distance=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements,l$b=l$R[0]-l$r[0],l$z=l$R[1]-l$r[1],l$L=l$R[2]-l$r[2];return Math.sqrt(l$b*l$b+l$z*l$z+l$L*l$L)},l$B.min=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements;l$r[0]=Math.min(l$b[0],l$z[0]),l$r[1]=Math.min(l$b[1],l$z[1]),l$r[2]=Math.min(l$b[2],l$z[2])},l$B.max=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements;l$r[0]=Math.max(l$b[0],l$z[0]),l$r[1]=Math.max(l$b[1],l$z[1]),l$r[2]=Math.max(l$b[2],l$z[2])},l$B.transformQuat=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements,l$L=l$b[0],l$w=l$b[1],l$x=l$b[2],l$P=l$z[0],l$B=l$z[1],l$n=l$z[2],l$f=l$z[3],l$J=l$f*l$L+l$B*l$x-l$n*l$w,l$h=l$f*l$w+l$n*l$L-l$P*l$x,l$M=l$f*l$x+l$P*l$w-l$B*l$L,l$N=-l$P*l$L-l$B*l$w-l$n*l$x;l$r[0]=l$J*l$f+l$N*-l$P+l$h*-l$n-l$M*-l$B,l$r[1]=l$h*l$f+l$N*-l$B+l$M*-l$P-l$J*-l$n,l$r[2]=l$M*l$f+l$N*-l$n+l$J*-l$B-l$h*-l$P},l$B.scalarLength=function(l$i){var l$_=l$i.elements,l$R=l$_[0],l$r=l$_[1],l$b=l$_[2];return Math.sqrt(l$R*l$R+l$r*l$r+l$b*l$b)},l$B.scalarLengthSquared=function(l$i){var l$_=l$i.elements,l$R=l$_[0],l$r=l$_[1],l$b=l$_[2];return l$R*l$R+l$r*l$r+l$b*l$b},l$B.normalize=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements,l$b=l$R[0],l$z=l$R[1],l$L=l$R[2],l$w=l$b*l$b+l$z*l$z+l$L*l$L;0<l$w&&(l$w=1/Math.sqrt(l$w),l$r[0]=l$R[0]*l$w,l$r[1]=l$R[1]*l$w,l$r[2]=l$R[2]*l$w)},l$B.multiply=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements;l$r[0]=l$b[0]*l$z[0],l$r[1]=l$b[1]*l$z[1],l$r[2]=l$b[2]*l$z[2]},l$B.scale=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements;l$r[0]=l$b[0]*l$_,l$r[1]=l$b[1]*l$_,l$r[2]=l$b[2]*l$_},l$B.lerp=function(l$i,l$_,l$R,l$r){var l$b=l$r.elements,l$z=l$i.elements,l$L=l$_.elements,l$w=l$z[0],l$x=l$z[1],l$P=l$z[2];l$b[0]=l$w+l$R*(l$L[0]-l$w),l$b[1]=l$x+l$R*(l$L[1]-l$x),l$b[2]=l$P+l$R*(l$L[2]-l$P)},l$B.transformV3ToV3=function(l$i,l$_,l$R){var l$r=l$B._tempVector4;l$B.transformV3ToV4(l$i,l$_,l$r);var l$b=l$r.elements,l$z=l$R.elements;l$z[0]=l$b[0],l$z[1]=l$b[1],l$z[2]=l$b[2]},l$B.transformV3ToV4=function(l$i,l$_,l$R){var l$r=l$i.elements,l$b=l$r[0],l$z=l$r[1],l$L=l$r[2],l$w=l$_.elements,l$x=l$R.elements;l$x[0]=l$b*l$w[0]+l$z*l$w[4]+l$L*l$w[8]+l$w[12],l$x[1]=l$b*l$w[1]+l$z*l$w[5]+l$L*l$w[9]+l$w[13],l$x[2]=l$b*l$w[2]+l$z*l$w[6]+l$L*l$w[10]+l$w[14],l$x[3]=l$b*l$w[3]+l$z*l$w[7]+l$L*l$w[11]+l$w[15]},l$B.TransformNormal=function(l$i,l$_,l$R){var l$r=l$i.elements,l$b=l$r[0],l$z=l$r[1],l$L=l$r[2],l$w=l$_.elements,l$x=l$R.elements;l$x[0]=l$b*l$w[0]+l$z*l$w[4]+l$L*l$w[8],l$x[1]=l$b*l$w[1]+l$z*l$w[5]+l$L*l$w[9],l$x[2]=l$b*l$w[2]+l$z*l$w[6]+l$L*l$w[10]},l$B.transformCoordinate=function(l$i,l$_,l$R){var l$r=l$B._tempVector4.elements,l$b=l$i.elements,l$z=l$b[0],l$L=l$b[1],l$w=l$b[2],l$x=l$_.elements;l$r[0]=l$z*l$x[0]+l$L*l$x[4]+l$w*l$x[8]+l$x[12],l$r[1]=l$z*l$x[1]+l$L*l$x[5]+l$w*l$x[9]+l$x[13],l$r[2]=l$z*l$x[2]+l$L*l$x[6]+l$w*l$x[10]+l$x[14],l$r[3]=1/(l$z*l$x[3]+l$L*l$x[7]+l$w*l$x[11]+l$x[15]);var l$P=l$R.elements;l$P[0]=l$r[0]*l$r[3],l$P[1]=l$r[1]*l$r[3],l$P[2]=l$r[2]*l$r[3]},l$B.Clamp=function(l$i,l$_,l$R,l$r){var l$b=l$i.elements,l$z=l$b[0],l$L=l$b[1],l$w=l$b[2],l$x=l$_.elements,l$P=l$x[0],l$B=l$x[1],l$n=l$x[2],l$f=l$R.elements,l$J=l$f[0],l$h=l$f[1],l$M=l$f[2],l$N=l$r.elements;l$z=(l$z=l$J<l$z?l$J:l$z)<l$P?l$P:l$z,l$L=(l$L=l$h<l$L?l$h:l$L)<l$B?l$B:l$L,l$w=(l$w=l$M<l$w?l$M:l$w)<l$n?l$n:l$w,l$N[0]=l$z,l$N[1]=l$L,l$N[2]=l$w},l$B.add=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements;l$r[0]=l$b[0]+l$z[0],l$r[1]=l$b[1]+l$z[1],l$r[2]=l$b[2]+l$z[2]},l$B.subtract=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements;l$r[0]=l$b[0]-l$z[0],l$r[1]=l$b[1]-l$z[1],l$r[2]=l$b[2]-l$z[2]},l$B.cross=function(l$i,l$_,l$R){var l$r=l$i.elements,l$b=l$_.elements,l$z=l$R.elements,l$L=l$r[0],l$w=l$r[1],l$x=l$r[2],l$P=l$b[0],l$B=l$b[1],l$n=l$b[2];l$z[0]=l$w*l$n-l$x*l$B,l$z[1]=l$x*l$P-l$L*l$n,l$z[2]=l$L*l$B-l$w*l$P},l$B.dot=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements;return l$R[0]*l$r[0]+l$R[1]*l$r[1]+l$R[2]*l$r[2]},l$B.equals=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements;return l$Wi.nearEqual(Math.abs(l$R[0]),Math.abs(l$r[0]))&&l$Wi.nearEqual(Math.abs(l$R[1]),Math.abs(l$r[1]))&&l$Wi.nearEqual(Math.abs(l$R[2]),Math.abs(l$r[2]))},l$B.ZERO=new l$B(0,0,0),l$B.ONE=new l$B(1,1,1),l$B.NegativeUnitX=new l$B(-1,0,0),l$B.UnitX=new l$B(1,0,0),l$B.UnitY=new l$B(0,1,0),l$B.UnitZ=new l$B(0,0,1),l$B.ForwardRH=new l$B(0,0,-1),l$B.ForwardLH=new l$B(0,0,1),l$B.Up=new l$B(0,1,0),l$B.NAN=new l$B(NaN,NaN,NaN),l$n(l$B,["_tempVector4",function(){return this._tempVector4=new l$w_}]),l$B}(),l$w_=function(){function l$i(l$i,l$_,l$R,l$r){this.elements=new Float32Array(4),void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=0);var l$b=this.elements;l$b[0]=l$i,l$b[1]=l$_,l$b[2]=l$R,l$b[3]=l$r}l$J(l$i,"laya.d3.math.Vector4");var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_.fromArray=function(l$i,l$_){void 0===l$_&&(l$_=0),this.elements[0]=l$i[l$_+0],this.elements[1]=l$i[l$_+1],this.elements[2]=l$i[l$_+2],this.elements[3]=l$i[l$_+3]},l$_.cloneTo=function(l$i){var l$_=l$i.elements,l$R=this.elements;l$_[0]=l$R[0],l$_[1]=l$R[1],l$_[2]=l$R[2],l$_[3]=l$R[3]},l$_.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$_.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},l$_.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},l$h(0,l$_,"x",function(){return this.elements[0]},function(l$i){this.elements[0]=l$i}),l$h(0,l$_,"y",function(){return this.elements[1]},function(l$i){this.elements[1]=l$i}),l$h(0,l$_,"z",function(){return this.elements[2]},function(l$i){this.elements[2]=l$i}),l$h(0,l$_,"w",function(){return this.elements[3]},function(l$i){this.elements[3]=l$i}),l$i.lerp=function(l$i,l$_,l$R,l$r){var l$b=l$r.elements,l$z=l$i.elements,l$L=l$_.elements,l$w=l$z[0],l$x=l$z[1],l$P=l$z[2],l$B=l$z[3];l$b[0]=l$w+l$R*(l$L[0]-l$w),l$b[1]=l$x+l$R*(l$L[1]-l$x),l$b[2]=l$P+l$R*(l$L[2]-l$P),l$b[3]=l$B+l$R*(l$L[3]-l$B)},l$i.transformByM4x4=function(l$i,l$_,l$R){var l$r=l$i.elements,l$b=l$r[0],l$z=l$r[1],l$L=l$r[2],l$w=l$r[3],l$x=l$_.elements,l$P=l$R.elements;l$P[0]=l$b*l$x[0]+l$z*l$x[4]+l$L*l$x[8]+l$w*l$x[12],l$P[1]=l$b*l$x[1]+l$z*l$x[5]+l$L*l$x[9]+l$w*l$x[13],l$P[2]=l$b*l$x[2]+l$z*l$x[6]+l$L*l$x[10]+l$w*l$x[14],l$P[3]=l$b*l$x[3]+l$z*l$x[7]+l$L*l$x[11]+l$w*l$x[15]},l$i.equals=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements;return l$Wi.nearEqual(Math.abs(l$R[0]),Math.abs(l$r[0]))&&l$Wi.nearEqual(Math.abs(l$R[1]),Math.abs(l$r[1]))&&l$Wi.nearEqual(Math.abs(l$R[2]),Math.abs(l$r[2]))&&l$Wi.nearEqual(Math.abs(l$R[3]),Math.abs(l$r[3]))},l$i.normalize=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements,l$b=l$i.length();0<l$b&&(l$r[0]=l$R[0]*l$b,l$r[1]=l$R[1]*l$b,l$r[2]=l$R[2]*l$b,l$r[3]=l$R[3]*l$b)},l$i.add=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements;l$r[0]=l$b[0]+l$z[0],l$r[1]=l$b[1]+l$z[1],l$r[2]=l$b[2]+l$z[2],l$r[3]=l$b[3]+l$z[3]},l$i.subtract=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements;l$r[0]=l$b[0]-l$z[0],l$r[1]=l$b[1]-l$z[1],l$r[2]=l$b[2]-l$z[2],l$r[3]=l$b[3]-l$z[3]},l$i.multiply=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements;l$r[0]=l$b[0]*l$z[0],l$r[1]=l$b[1]*l$z[1],l$r[2]=l$b[2]*l$z[2],l$r[3]=l$b[3]*l$z[3]},l$i.scale=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements;l$r[0]=l$b[0]*l$_,l$r[1]=l$b[1]*l$_,l$r[2]=l$b[2]*l$_,l$r[3]=l$b[3]*l$_},l$i.Clamp=function(l$i,l$_,l$R,l$r){var l$b=l$i.elements,l$z=l$b[0],l$L=l$b[1],l$w=l$b[2],l$x=l$b[3],l$P=l$_.elements,l$B=l$P[0],l$n=l$P[1],l$f=l$P[2],l$J=l$P[3],l$h=l$R.elements,l$M=l$h[0],l$N=l$h[1],l$X=l$h[2],l$t=l$h[3],l$I=l$r.elements;l$z=(l$z=l$M<l$z?l$M:l$z)<l$B?l$B:l$z,l$L=(l$L=l$N<l$L?l$N:l$L)<l$n?l$n:l$L,l$w=(l$w=l$X<l$w?l$X:l$w)<l$f?l$f:l$w,l$x=(l$x=l$t<l$x?l$t:l$x)<l$J?l$J:l$x,l$I[0]=l$z,l$I[1]=l$L,l$I[2]=l$w,l$I[3]=l$x},l$i.distanceSquared=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements,l$b=l$R[0]-l$r[0],l$z=l$R[1]-l$r[1],l$L=l$R[2]-l$r[2],l$w=l$R[3]-l$r[3];return l$b*l$b+l$z*l$z+l$L*l$L+l$w*l$w},l$i.distance=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements,l$b=l$R[0]-l$r[0],l$z=l$R[1]-l$r[1],l$L=l$R[2]-l$r[2],l$w=l$R[3]-l$r[3];return Math.sqrt(l$b*l$b+l$z*l$z+l$L*l$L+l$w*l$w)},l$i.dot=function(l$i,l$_){var l$R=l$i.elements,l$r=l$_.elements;return l$R[0]*l$r[0]+l$R[1]*l$r[1]+l$R[2]*l$r[2]+l$R[3]*l$r[3]},l$i.min=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements;l$r[0]=Math.min(l$b[0],l$z[0]),l$r[1]=Math.min(l$b[1],l$z[1]),l$r[2]=Math.min(l$b[2],l$z[2]),l$r[3]=Math.min(l$b[3],l$z[3])},l$i.max=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_.elements;l$r[0]=Math.max(l$b[0],l$z[0]),l$r[1]=Math.max(l$b[1],l$z[1]),l$r[2]=Math.max(l$b[2],l$z[2]),l$r[3]=Math.max(l$b[3],l$z[3])},l$n(l$i,["ZERO",function(){return this.ZERO=new l$i},"ONE",function(){return this.ONE=new l$i(1,1,1,1)},"UnitX",function(){return this.UnitX=new l$i(1,0,0,0)},"UnitY",function(){return this.UnitY=new l$i(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new l$i(0,0,1,0)},"UnitW",function(){return this.UnitW=new l$i(0,0,0,1)}]),l$i}(),l$x_=function(){function l$z(l$i,l$_,l$R,l$r){this.minDepth=0,this.maxDepth=1,this.x=l$i,this.y=l$_,this.width=l$R,this.height=l$r}l$J(l$z,"laya.d3.math.Viewport");var l$i=l$z.prototype;return l$i.project=function(l$i,l$_,l$R){l$L_.transformV3ToV3(l$i,l$_,l$R);var l$r=l$i.elements,l$b=l$_.elements,l$z=l$R.elements,l$L=l$r[0]*l$b[3]+l$r[1]*l$b[7]+l$r[2]*l$b[11]+l$b[15];1!==l$L&&(l$z[0]=l$z[0]/l$L,l$z[1]=l$z[1]/l$L,l$z[2]=l$z[2]/l$L),l$z[0]=.5*(l$z[0]+1)*this.width+this.x,l$z[1]=.5*(1-l$z[1])*this.height+this.y,l$z[2]=l$z[2]*(this.maxDepth-this.minDepth)+this.minDepth},l$i.unprojectFromMat=function(l$i,l$_,l$R){var l$r=l$i.elements,l$b=l$_.elements,l$z=l$R.elements;l$z[0]=(l$r[0]-this.x)/this.width*2-1,l$z[1]=-((l$r[1]-this.y)/this.height*2-1);var l$L=(this.maxDepth-this.minDepth)/2;l$z[2]=(l$r[2]-this.minDepth-l$L)/l$L;var l$w=l$z[0]*l$b[3]+l$z[1]*l$b[7]+l$z[2]*l$b[11]+l$b[15];l$L_.transformV3ToV3(l$R,l$_,l$R),1!==l$w&&(l$z[0]=l$z[0]/l$w,l$z[1]=l$z[1]/l$w,l$z[2]=l$z[2]/l$w)},l$i.unprojectFromWVP=function(l$i,l$_,l$R,l$r,l$b){l$i_.multiply(l$_,l$R,l$z._tempMatrix4x4),l$r&&l$i_.multiply(l$z._tempMatrix4x4,l$r,l$z._tempMatrix4x4),l$z._tempMatrix4x4.invert(l$z._tempMatrix4x4),this.unprojectFromMat(l$i,l$z._tempMatrix4x4,l$b)},l$n(l$z,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new l$i_}]),l$z}(),l$P_=function(){function l$v(l$i){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=l$i,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}l$J(l$v,"laya.d3.resource.models.SubMesh");var l$i=l$v.prototype;return l$c.imps(l$i,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),l$i._getVertexBuffer=function(l$i){return void 0===l$i&&(l$i=0),0===l$i?this._vertexBuffer:null},l$i._getIndexBuffer=function(){return this._indexBuffer},l$i._getStaticBatchBakedVertexs=function(l$i,l$_){var l$R,l$r,l$b=this._vertexBuffer,l$z=l$b.vertexDeclaration,l$L=l$z.getVertexElementByUsage(0).offset/4,l$w=l$z.getVertexElementByUsage(3).offset/4,l$x=l$_.meshRender.lightmapScaleOffset,l$P=0,l$B=0,l$n=0,l$f=0,l$J=0,l$h=0;if(l$x)if(l$r=l$z.getVertexElementByUsage(15))l$n=l$z.vertexStride/4,l$R=0<this._vertexCount?l$b.getData().slice(this._vertexStart*l$n,(this._vertexStart+this._vertexCount)*l$n):l$b.getData().slice(),l$f=l$r.offset/4;else{l$n=(l$h=l$z.vertexStride/4)+2,l$R=this._vertexCount?new Float32Array(this._vertexCount*(l$b.vertexDeclaration.vertexStride/4+2)):new Float32Array(l$b.vertexCount*(l$b.vertexDeclaration.vertexStride/4+2)),l$f=(l$J=l$z.getVertexElementByUsage(2).offset/4)+2;var l$M=l$b.getData();for(l$P=0,l$B=l$M.length/l$h;l$P<l$B;l$P++){var l$N=0;l$N=0<this._vertexCount?(this._vertexStart+l$P)*l$h:l$P*l$h;var l$X=l$P*l$n,l$t=0;for(l$t=0;l$t<l$f;l$t++)l$R[l$X+l$t]=l$M[l$N+l$t];for(l$t=l$f;l$t<l$h;l$t++)l$R[l$X+l$t+2]=l$M[l$N+l$t]}}else l$n=l$z.vertexStride/4,l$R=this._vertexCount?l$b.getData().slice(this._vertexStart*l$n,(this._vertexStart+this._vertexCount)*l$n):l$b.getData().slice();if(l$i){var l$I=l$i.worldMatrix,l$e=l$v._tempMatrix4x40;l$I.invert(l$e);var l$c=l$v._tempMatrix4x41,l$l=l$_.transform.worldMatrix;l$i_.multiply(l$e,l$l,l$c)}else l$c=l$_.transform.worldMatrix;var l$A=l$v._tempQuaternion0;for(l$c.decomposeTransRotScale(l$v._tempVector30,l$A,l$v._tempVector31),l$P=0,l$B=l$R.length/l$n;l$P<l$B;l$P++){var l$Z=l$P*l$n+l$L,l$q=l$P*l$n+l$w;if(l$N_.transformVector3ArrayToVector3ArrayCoordinate(l$R,l$Z,l$c,l$R,l$Z),l$N_.transformVector3ArrayByQuat(l$R,l$q,l$A,l$R,l$q),l$x){var l$j=l$P*l$n+l$f;if(l$r)l$N_.transformLightingMapTexcoordByUV1Array(l$R,l$j,l$x,l$R,l$j);else{var l$S=l$P*l$h+l$J;l$N_.transformLightingMapTexcoordByUV0Array(l$M,l$S,l$x,l$R,l$j)}}}return l$R},l$i._getVertexBuffers=function(){return null},l$i._beforeRender=function(l$i){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},l$i._render=function(l$i){var l$_,l$R=0,l$r=l$i.renderElement;if(1<this._indexCount){var l$b=this._boneIndicesList.length;if(1<l$b){for(var l$z=0;l$z<l$b;l$z++)(l$_=l$r._skinAnimationDatas||this._skinAnimationDatas)&&(l$r._shaderValue.setValue(0,l$_[l$z]),l$i._shader.uploadRenderElementUniforms(l$r._shaderValue.data)),l$$.mainContext.drawElements(4,this._subIndexBufferCount[l$z],5123,2*this._subIndexBufferStart[l$z]);l$Z.drawCall+=l$b}else(l$_=l$r._skinAnimationDatas||this._skinAnimationDatas)&&(l$r._shaderValue.setValue(0,l$_[0]),l$i._shader.uploadRenderElementUniforms(l$r._shaderValue.data)),l$$.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),l$Z.drawCall++;l$R=this._indexCount}else l$R=this._indexBuffer.indexCount,(l$_=l$r._skinAnimationDatas||this._skinAnimationDatas)&&(l$r._shaderValue.setValue(0,l$_[0]),l$i._shader.uploadRenderElementUniforms(l$r._shaderValue.data)),l$$.mainContext.drawElements(4,l$R,5123,0),l$Z.drawCall++;l$Z.trianglesFaces+=l$R/3},l$i.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},l$i.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},l$h(0,l$i,"_vertexBufferCount",function(){return 1}),l$h(0,l$i,"triangleCount",function(){return this._indexBuffer.indexCount/3}),l$n(l$v,["_tempVector30",function(){return this._tempVector30=new l$L_},"_tempVector31",function(){return this._tempVector31=new l$L_},"_tempQuaternion0",function(){return this._tempQuaternion0=new l$R_},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new l$i_},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new l$i_}]),l$v}(),l$B_=function(){function l$i(l$i){this.defineCounter=0,this.defines=null,l$i?(this.defineCounter=l$i.defineCounter,this.defines=l$i.defines.slice()):(this.defineCounter=0,this.defines=[])}return l$J(l$i,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),l$i.prototype.registerDefine=function(l$i){var l$_=Math.pow(2,this.defineCounter++);return this.defines[l$_]=l$i,l$_},l$i}(),l$n_=function(){function l$i(){}return l$J(l$i,"laya.d3.shader.ShaderInit3D"),l$i.__init__=function(){var l$i,l$_;l$Z_._globalRegDefine("HIGHPRECISION",l$Z_.SHADERDEFINE_HIGHPRECISION),l$Z_._globalRegDefine("FOG",l$Z_.SHADERDEFINE_FOG),l$Z_._globalRegDefine("DIRECTIONLIGHT",l$Z_.SHADERDEFINE_DIRECTIONLIGHT),l$Z_._globalRegDefine("POINTLIGHT",l$Z_.SHADERDEFINE_POINTLIGHT),l$Z_._globalRegDefine("SPOTLIGHT",l$Z_.SHADERDEFINE_SPOTLIGHT),l$Z_._globalRegDefine("UV",l$Z_.SHADERDEFINE_UV0),l$Z_._globalRegDefine("COLOR",l$Z_.SHADERDEFINE_COLOR),l$Z_._globalRegDefine("UV1",l$Z_.SHADERDEFINE_UV1),l$Z_._globalRegDefine("CASTSHADOW",l$J_.SHADERDEFINE_CAST_SHADOW),l$Z_._globalRegDefine("SHADOWMAP_PSSM1",l$J_.SHADERDEFINE_SHADOW_PSSM1),l$Z_._globalRegDefine("SHADOWMAP_PSSM2",l$J_.SHADERDEFINE_SHADOW_PSSM2),l$Z_._globalRegDefine("SHADOWMAP_PSSM3",l$J_.SHADERDEFINE_SHADOW_PSSM3),l$Z_._globalRegDefine("SHADOWMAP_PCF_NO",l$J_.SHADERDEFINE_SHADOW_PCF_NO),l$Z_._globalRegDefine("SHADOWMAP_PCF1",l$J_.SHADERDEFINE_SHADOW_PCF1),l$Z_._globalRegDefine("SHADOWMAP_PCF2",l$J_.SHADERDEFINE_SHADOW_PCF2),l$Z_._globalRegDefine("SHADOWMAP_PCF3",l$J_.SHADERDEFINE_SHADOW_PCF3),l$Z_._globalRegDefine("DEPTHFOG",l$Z_.SAHDERDEFINE_DEPTHFOG),l$K_.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),l$K_.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),l$i={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},l$_={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var l$R=l$K_.nameKey.add("SIMPLE");shaderCompile=l$Z_.add(l$R,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',l$i,l$_),l$O_.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),l$O_.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),l$O_.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),l$O_.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),l$O_.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),l$O_.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),l$O_.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),l$O_.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),l$O_.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},l$i}(),l$f_=function(){function l$i(){this._data=null,this._data=[]}l$J(l$i,"laya.d3.shader.ValusArray");var l$_=l$i.prototype;return l$_.setValue=function(l$i,l$_){this._data[l$i]=l$_},l$h(0,l$_,"data",function(){return this._data}),l$i}(),l$J_=function(){function l$i(){}return l$i.SHADERDEFINE_RECEIVE_SHADOW=1,l$i.SHADERDEFINE_CAST_SHADOW=512,l$i.SHADERDEFINE_SHADOW_PSSM1=1024,l$i.SHADERDEFINE_SHADOW_PSSM2=2048,l$i.SHADERDEFINE_SHADOW_PSSM3=4096,l$i.SHADERDEFINE_SHADOW_PCF_NO=8192,l$i.SHADERDEFINE_SHADOW_PCF1=16384,l$i.SHADERDEFINE_SHADOW_PCF2=32768,l$i.SHADERDEFINE_SHADOW_PCF3=65536,l$i.MAX_PSSM_COUNT=3,l$i}(),l$h_=function(){function l$a(){}return l$J(l$a,"laya.d3.utils.Picker"),l$a.calculateCursorRay=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=l$i.elements[0],l$w=l$i.elements[1],l$x=l$a._tempVector30,l$P=l$x.elements;l$P[0]=l$L,l$P[1]=l$w,l$P[2]=l$_.minDepth;var l$B=l$a._tempVector31,l$n=l$B.elements;l$n[0]=l$L,l$n[1]=l$w,l$n[2]=l$_.maxDepth;var l$f=l$z.origin,l$J=l$a._tempVector32;l$_.unprojectFromWVP(l$x,l$R,l$r,l$b,l$f),l$_.unprojectFromWVP(l$B,l$R,l$r,l$b,l$J);var l$h=l$z.direction.elements;l$h[0]=l$J.x-l$f.x,l$h[1]=l$J.y-l$f.y,l$h[2]=l$J.z-l$f.z,l$L_.normalize(l$z.direction,l$z.direction)},l$a.rayIntersectsPositionsAndIndices=function(l$i,l$_,l$R,l$r,l$b){for(var l$z=l$R.vertexStride/4,l$L=l$R.getVertexElementByUsage(0).offset/4,l$w=Number.MAX_VALUE,l$x=-1,l$P=-1,l$B=-1,l$n=0;l$n<l$r.length;l$n+=3){var l$f=l$a._tempVector35,l$J=l$f.elements,l$h=l$r[l$n]*l$z,l$M=l$h+l$L;l$J[0]=l$_[l$M],l$J[1]=l$_[1+l$M],l$J[2]=l$_[2+l$M];var l$N=l$a._tempVector36,l$X=l$N.elements,l$t=l$r[l$n+1]*l$z,l$I=l$t+l$L;l$X[0]=l$_[l$I],l$X[1]=l$_[1+l$I],l$X[2]=l$_[2+l$I];var l$e=l$a._tempVector37,l$c=l$e.elements,l$l=l$r[l$n+2]*l$z,l$A=l$l+l$L;l$c[0]=l$_[l$A],l$c[1]=l$_[1+l$A],l$c[2]=l$_[2+l$A];var l$Z=laya.d3.utils.Picker.rayIntersectsTriangle(l$i,l$f,l$N,l$e);!isNaN(l$Z)&&l$Z<l$w&&(l$w=l$Z,l$x=l$h,l$P=l$t,l$B=l$l)}if(l$w===Number.MAX_VALUE)return l$b.position.toDefault(),l$b.distance=Number.MAX_VALUE,l$b.trianglePositions[0].toDefault(),l$b.trianglePositions[1].toDefault(),l$b.trianglePositions[2].toDefault(),l$b.triangleNormals[0].toDefault(),l$b.triangleNormals[1].toDefault(),l$b.triangleNormals[2].toDefault(),!1;l$b.distance=l$w,l$L_.scale(l$i.direction,l$w,l$b.position),l$L_.add(l$i.origin,l$b.position,l$b.position);var l$q=l$b.trianglePositions,l$j=l$q[0],l$S=l$q[1],l$v=l$q[2],l$$=l$j.elements,l$G=l$S.elements,l$u=l$v.elements,l$o=l$x+l$L;l$$[0]=l$_[l$o],l$$[1]=l$_[l$o+1],l$$[2]=l$_[l$o+2];var l$p=l$P+l$L;l$G[0]=l$_[l$p],l$G[1]=l$_[l$p+1],l$G[2]=l$_[l$p+2];var l$k=l$B+l$L;l$u[0]=l$_[l$k],l$u[1]=l$_[l$k+1],l$u[2]=l$_[l$k+2];var l$K=l$R.getVertexElementByUsage(3);if(l$K){var l$O=l$K.offset/4,l$E=l$b.triangleNormals,l$s=l$E[0],l$Y=l$E[1],l$C=l$E[2],l$m=l$s.elements,l$D=l$Y.elements,l$U=l$C.elements,l$g=l$x+l$O;l$m[0]=l$_[l$g],l$m[1]=l$_[l$g+1],l$m[2]=l$_[l$g+2];var l$V=l$P+l$O;l$D[0]=l$_[l$V],l$D[1]=l$_[l$V+1],l$D[2]=l$_[l$V+2];var l$y=l$B+l$O;l$U[0]=l$_[l$y],l$U[1]=l$_[l$y+1],l$U[2]=l$_[l$y+2]}return!0},l$a.rayIntersectsTriangle=function(l$i,l$_,l$R,l$r){var l$b=l$a._tempVector30,l$z=l$a._tempVector31;l$L_.subtract(l$R,l$_,l$b),l$L_.subtract(l$r,l$_,l$z);var l$L,l$w=l$a._tempVector32;if(l$L_.cross(l$i.direction,l$z,l$w),(l$L=l$L_.dot(l$b,l$w))>-Number.MIN_VALUE&&l$L<Number.MIN_VALUE)return Number.NaN;var l$x,l$P=1/l$L,l$B=l$a._tempVector33;if(l$L_.subtract(l$i.origin,l$_,l$B),l$x=l$L_.dot(l$B,l$w),(l$x*=l$P)<0||1<l$x)return Number.NaN;var l$n,l$f,l$J=l$a._tempVector34;return l$L_.cross(l$B,l$b,l$J),l$n=l$L_.dot(l$i.direction,l$J),(l$n*=l$P)<0||1<l$x+l$n?Number.NaN:(l$f=l$L_.dot(l$z,l$J),(l$f*=l$P)<0?Number.NaN:l$f)},l$n(l$a,["_tempVector30",function(){return this._tempVector30=new l$L_},"_tempVector31",function(){return this._tempVector31=new l$L_},"_tempVector32",function(){return this._tempVector32=new l$L_},"_tempVector33",function(){return this._tempVector33=new l$L_},"_tempVector34",function(){return this._tempVector34=new l$L_},"_tempVector35",function(){return this._tempVector35=new l$L_},"_tempVector36",function(){return this._tempVector36=new l$L_},"_tempVector37",function(){return this._tempVector37=new l$L_}]),l$a}(),l$M_=(function(){function l$i(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new l$L_,new l$L_,new l$L_],this.trianglePositions.length=3,this.triangleNormals=[new l$L_,new l$L_,new l$L_],this.triangleNormals.length=3,this.position=new l$L_}l$J(l$i,"laya.d3.utils.RaycastHit"),l$i.prototype.cloneTo=function(l$i){l$i.distance=this.distance,this.trianglePositions[0].cloneTo(l$i.trianglePositions[0]),this.trianglePositions[1].cloneTo(l$i.trianglePositions[1]),this.trianglePositions[2].cloneTo(l$i.trianglePositions[2]),this.triangleNormals[0].cloneTo(l$i.triangleNormals[0]),this.triangleNormals[1].cloneTo(l$i.triangleNormals[1]),this.triangleNormals[2].cloneTo(l$i.triangleNormals[2]),this.position.cloneTo(l$i.position),l$i.sprite3D=this.sprite3D}}(),function(){function l$i(l$i,l$_){this._width=0,this._height=0,this._width=l$i,this._height=l$_}l$J(l$i,"laya.d3.utils.Size");var l$_=l$i.prototype;return l$h(0,l$_,"width",function(){return-1===this._width?l$F.clientWidth:this._width}),l$h(0,l$_,"height",function(){return-1===this._height?l$F.clientHeight:this._height}),l$h(1,l$i,"fullScreen",function(){return new l$i(-1,-1)}),l$i}()),l$N_=function(){function l$o(){}return l$J(l$o,"laya.d3.utils.Utils3D"),l$o._rotationTransformScaleSkinAnimation=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$n){var l$f,l$J,l$h,l$M,l$N,l$X=l$o._tempArray16_0,l$t=l$o._tempArray16_1,l$I=l$o._tempArray16_2,l$e=l$r+l$r,l$c=l$b+l$b,l$l=l$z+l$z,l$A=l$r*l$e,l$Z=l$b*l$e,l$q=l$b*l$c,l$j=l$z*l$e,l$S=l$z*l$c,l$v=l$z*l$l,l$$=l$L*l$e,l$G=l$L*l$c,l$u=l$L*l$l;for(l$X[15]=1,l$X[0]=1-l$q-l$v,l$X[1]=l$Z+l$u,l$X[2]=l$j-l$G,l$X[4]=l$Z-l$u,l$X[5]=1-l$A-l$v,l$X[6]=l$S+l$$,l$X[8]=l$j+l$G,l$X[9]=l$S-l$$,l$X[10]=1-l$A-l$q,l$t[15]=1,l$t[0]=l$w,l$t[5]=l$x,l$t[10]=l$P,l$f=0;l$f<4;l$f++)l$J=l$X[l$f],l$h=l$X[l$f+4],l$M=l$X[l$f+8],l$N=l$X[l$f+12],l$I[l$f]=l$J,l$I[l$f+4]=l$h,l$I[l$f+8]=l$M,l$I[l$f+12]=l$J*l$i+l$h*l$_+l$M*l$R+l$N;for(l$f=0;l$f<4;l$f++)l$J=l$I[l$f],l$h=l$I[l$f+4],l$M=l$I[l$f+8],l$N=l$I[l$f+12],l$B[l$f+l$n]=l$J*l$t[0]+l$h*l$t[1]+l$M*l$t[2]+l$N*l$t[3],l$B[l$f+l$n+4]=l$J*l$t[4]+l$h*l$t[5]+l$M*l$t[6]+l$N*l$t[7],l$B[l$f+l$n+8]=l$J*l$t[8]+l$h*l$t[9]+l$M*l$t[10]+l$N*l$t[11],l$B[l$f+l$n+12]=l$J*l$t[12]+l$h*l$t[13]+l$M*l$t[14]+l$N*l$t[15]},l$o._createNodeByJson=function(l$i,l$_,l$R,l$r){if(!l$R)switch(l$_.type){case"Sprite3D":l$R=new l$k_;break;case"MeshSprite3D":l$R=new l$a_;break;case"SkinnedMeshSprite3D":l$R=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":l$R=new ShuriKenParticle3D;break;case"TrailSprite3D":l$R=new TrailSprite3D;break;case"Terrain":l$R=new Terrain;break;case"Camera":l$R=new l$y_;break;case"DirectionLight":l$R=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var l$b=l$_.props;if(l$b)for(var l$z in l$b)l$R[l$z]=l$b[l$z];var l$L=l$_.customProps;l$L&&(l$R instanceof laya.d3.core.Sprite3D?(l$R._parseBaseCustomProps(l$L),l$R._parseCustomProps(l$i,l$r,l$L,l$_),l$R._parseCustomComponent(l$i,l$r,l$_.components)):l$R._parseCustomProps(l$i,l$r,l$L,l$_));var l$w=l$_.child;if(l$w)for(var l$x=0,l$P=l$w.length;l$x<l$P;l$x++){var l$B=l$o._createNodeByJson(l$i,l$w[l$x],null,l$r);l$R.addChild(l$B)}return l$R},l$o._computeBoneAndAnimationDatasByBindPoseMatrxix=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L,l$w,l$x=0,l$P=0,l$B=l$i.length;for(l$L=0;l$L<l$B;l$x+=l$i[l$L].keyframeWidth,l$P+=16,l$L++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(l$_[l$x+0],l$_[l$x+1],l$_[l$x+2],l$_[l$x+3],l$_[l$x+4],l$_[l$x+5],l$_[l$x+6],l$_[l$x+7],l$_[l$x+8],l$_[l$x+9],l$r,l$P),0!=l$L&&(l$w=16*l$i[l$L].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(l$r,l$w,l$r,l$P,l$r,l$P));var l$n=l$R.length;for(l$L=0;l$L<l$n;l$L++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(l$r,16*l$z[l$L],l$R[l$L],l$b,16*l$L)},l$o._computeAnimationDatasByArrayAndMatrixFast=function(l$i,l$_,l$R,l$r){for(var l$b=0,l$z=l$i.length;l$b<l$z;l$b++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(l$_,16*l$r[l$b],l$i[l$b],l$R,16*l$b)},l$o._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(l$i,l$_,l$R,l$r,l$b){var l$z,l$L,l$w=0,l$x=0,l$P=l$i.length;for(l$z=0;l$z<l$P;l$w+=l$i[l$z].keyframeWidth,l$x+=16,l$z++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(l$_[l$w+7],l$_[l$w+8],l$_[l$w+9],l$_[l$w+3],l$_[l$w+4],l$_[l$w+5],l$_[l$w+6],l$_[l$w+0],l$_[l$w+1],l$_[l$w+2],l$r,l$x),0!=l$z&&(l$L=16*l$i[l$z].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(l$r,l$L,l$r,l$x,l$r,l$x));var l$B=l$R.length;for(l$z=0;l$z<l$B;l$z++){var l$n=16*l$z;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(l$r,l$n,l$R[l$z],l$b,l$n)}},l$o._computeAnimationDatasByArrayAndMatrixFastOld=function(l$i,l$_,l$R){for(var l$r=l$i.length,l$b=0;l$b<l$r;l$b++){var l$z=16*l$b;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(l$_,l$z,l$i[l$b],l$R,l$z)}},l$o._computeRootAnimationData=function(l$i,l$_,l$R){for(var l$r=0,l$b=0,l$z=0,l$L=l$i.length;l$r<l$L;l$b+=l$i[l$r].keyframeWidth,l$z+=16,l$r++)laya.d3.utils.Utils3D.createAffineTransformationArray(l$_[l$b+0],l$_[l$b+1],l$_[l$b+2],l$_[l$b+3],l$_[l$b+4],l$_[l$b+5],l$_[l$b+6],l$_[l$b+7],l$_[l$b+8],l$_[l$b+9],l$R,l$z)},l$o.transformVector3ArrayByQuat=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$R.elements,l$L=l$i[l$_],l$w=l$i[l$_+1],l$x=l$i[l$_+2],l$P=l$z[0],l$B=l$z[1],l$n=l$z[2],l$f=l$z[3],l$J=l$f*l$L+l$B*l$x-l$n*l$w,l$h=l$f*l$w+l$n*l$L-l$P*l$x,l$M=l$f*l$x+l$P*l$w-l$B*l$L,l$N=-l$P*l$L-l$B*l$w-l$n*l$x;l$r[l$b]=l$J*l$f+l$N*-l$P+l$h*-l$n-l$M*-l$B,l$r[l$b+1]=l$h*l$f+l$N*-l$B+l$M*-l$P-l$J*-l$n,l$r[l$b+2]=l$M*l$f+l$N*-l$n+l$J*-l$B-l$h*-l$P},l$o.mulMatrixByArray=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L,l$w,l$x,l$P,l$B;if(l$b===l$R){for(l$R=l$o._tempArray16_3,l$L=0;l$L<16;++l$L)l$R[l$L]=l$b[l$z+l$L];l$r=0}for(l$L=0;l$L<4;l$L++)l$w=l$i[l$_+l$L],l$x=l$i[l$_+l$L+4],l$P=l$i[l$_+l$L+8],l$B=l$i[l$_+l$L+12],l$b[l$z+l$L]=l$w*l$R[l$r+0]+l$x*l$R[l$r+1]+l$P*l$R[l$r+2]+l$B*l$R[l$r+3],l$b[l$z+l$L+4]=l$w*l$R[l$r+4]+l$x*l$R[l$r+5]+l$P*l$R[l$r+6]+l$B*l$R[l$r+7],l$b[l$z+l$L+8]=l$w*l$R[l$r+8]+l$x*l$R[l$r+9]+l$P*l$R[l$r+10]+l$B*l$R[l$r+11],l$b[l$z+l$L+12]=l$w*l$R[l$r+12]+l$x*l$R[l$r+13]+l$P*l$R[l$r+14]+l$B*l$R[l$r+15]},l$o.mulMatrixByArrayFast=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L,l$w,l$x,l$P,l$B;for(l$L=0;l$L<4;l$L++)l$w=l$i[l$_+l$L],l$x=l$i[l$_+l$L+4],l$P=l$i[l$_+l$L+8],l$B=l$i[l$_+l$L+12],l$b[l$z+l$L]=l$w*l$R[l$r+0]+l$x*l$R[l$r+1]+l$P*l$R[l$r+2]+l$B*l$R[l$r+3],l$b[l$z+l$L+4]=l$w*l$R[l$r+4]+l$x*l$R[l$r+5]+l$P*l$R[l$r+6]+l$B*l$R[l$r+7],l$b[l$z+l$L+8]=l$w*l$R[l$r+8]+l$x*l$R[l$r+9]+l$P*l$R[l$r+10]+l$B*l$R[l$r+11],l$b[l$z+l$L+12]=l$w*l$R[l$r+12]+l$x*l$R[l$r+13]+l$P*l$R[l$r+14]+l$B*l$R[l$r+15]},l$o.mulMatrixByArrayAndMatrixFast=function(l$i,l$_,l$R,l$r,l$b){var l$z,l$L,l$w,l$x,l$P,l$B=l$R.elements,l$n=l$B[0],l$f=l$B[1],l$J=l$B[2],l$h=l$B[3],l$M=l$B[4],l$N=l$B[5],l$X=l$B[6],l$t=l$B[7],l$I=l$B[8],l$e=l$B[9],l$c=l$B[10],l$l=l$B[11],l$A=l$B[12],l$Z=l$B[13],l$q=l$B[14],l$j=l$B[15],l$S=l$_,l$v=l$_+4,l$$=l$_+8,l$G=l$_+12,l$u=l$b,l$o=l$b+4,l$p=l$b+8,l$k=l$b+12;for(l$z=0;l$z<4;l$z++)l$L=l$i[l$S+l$z],l$w=l$i[l$v+l$z],l$x=l$i[l$$+l$z],l$P=l$i[l$G+l$z],l$r[l$u+l$z]=l$L*l$n+l$w*l$f+l$x*l$J+l$P*l$h,l$r[l$o+l$z]=l$L*l$M+l$w*l$N+l$x*l$X+l$P*l$t,l$r[l$p+l$z]=l$L*l$I+l$w*l$e+l$x*l$c+l$P*l$l,l$r[l$k+l$z]=l$L*l$A+l$w*l$Z+l$x*l$q+l$P*l$j},l$o.createAffineTransformationArray=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$n){var l$f=l$r+l$r,l$J=l$b+l$b,l$h=l$z+l$z,l$M=l$r*l$f,l$N=l$r*l$J,l$X=l$r*l$h,l$t=l$b*l$J,l$I=l$b*l$h,l$e=l$z*l$h,l$c=l$L*l$f,l$l=l$L*l$J,l$A=l$L*l$h;l$B[l$n+0]=(1-(l$t+l$e))*l$w,l$B[l$n+1]=(l$N+l$A)*l$w,l$B[l$n+2]=(l$X-l$l)*l$w,l$B[l$n+3]=0,l$B[l$n+4]=(l$N-l$A)*l$x,l$B[l$n+5]=(1-(l$M+l$e))*l$x,l$B[l$n+6]=(l$I+l$c)*l$x,l$B[l$n+7]=0,l$B[l$n+8]=(l$X+l$l)*l$P,l$B[l$n+9]=(l$I-l$c)*l$P,l$B[l$n+10]=(1-(l$M+l$t))*l$P,l$B[l$n+11]=0,l$B[l$n+12]=l$i,l$B[l$n+13]=l$_,l$B[l$n+14]=l$R,l$B[l$n+15]=1},l$o.transformVector3ArrayToVector3ArrayCoordinate=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$o._tempArray4_0,l$L=l$i[l$_+0],l$w=l$i[l$_+1],l$x=l$i[l$_+2],l$P=l$R.elements;l$z[0]=l$L*l$P[0]+l$w*l$P[4]+l$x*l$P[8]+l$P[12],l$z[1]=l$L*l$P[1]+l$w*l$P[5]+l$x*l$P[9]+l$P[13],l$z[2]=l$L*l$P[2]+l$w*l$P[6]+l$x*l$P[10]+l$P[14],l$z[3]=1/(l$L*l$P[3]+l$w*l$P[7]+l$x*l$P[11]+l$P[15]),l$r[l$b+0]=l$z[0]*l$z[3],l$r[l$b+1]=l$z[1]*l$z[3],l$r[l$b+2]=l$z[2]*l$z[3]},l$o.transformLightingMapTexcoordByUV0Array=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$R.elements;l$r[l$b+0]=l$i[l$_+0]*l$z[0]+l$z[2],l$r[l$b+1]=(l$i[l$_+1]-1)*l$z[1]+l$z[3]},l$o.transformLightingMapTexcoordByUV1Array=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$R.elements;l$r[l$b+0]=l$i[l$_+0]*l$z[0]+l$z[2],l$r[l$b+1]=1+l$i[l$_+1]*l$z[1]+l$z[3]},l$o.getURLVerion=function(l$i){var l$_=l$i.indexOf("?");return 0<=l$_?l$i.substr(l$_):null},l$o._quaternionCreateFromYawPitchRollArray=function(l$i,l$_,l$R,l$r){var l$b=.5*l$R,l$z=.5*l$_,l$L=.5*l$i,l$w=Math.sin(l$b),l$x=Math.cos(l$b),l$P=Math.sin(l$z),l$B=Math.cos(l$z),l$n=Math.sin(l$L),l$f=Math.cos(l$L);l$r[0]=l$f*l$P*l$x+l$n*l$B*l$w,l$r[1]=l$n*l$B*l$x-l$f*l$P*l$w,l$r[2]=l$f*l$B*l$w-l$n*l$P*l$x,l$r[3]=l$f*l$B*l$x+l$n*l$P*l$w},l$o._createAffineTransformationArray=function(l$i,l$_,l$R,l$r){var l$b=l$_[0],l$z=l$_[1],l$L=l$_[2],l$w=l$_[3],l$x=l$b+l$b,l$P=l$z+l$z,l$B=l$L+l$L,l$n=l$b*l$x,l$f=l$b*l$P,l$J=l$b*l$B,l$h=l$z*l$P,l$M=l$z*l$B,l$N=l$L*l$B,l$X=l$w*l$x,l$t=l$w*l$P,l$I=l$w*l$B,l$e=l$R[0],l$c=l$R[1],l$l=l$R[2];l$r[0]=(1-(l$h+l$N))*l$e,l$r[1]=(l$f+l$I)*l$e,l$r[2]=(l$J-l$t)*l$e,l$r[3]=0,l$r[4]=(l$f-l$I)*l$c,l$r[5]=(1-(l$n+l$N))*l$c,l$r[6]=(l$M+l$X)*l$c,l$r[7]=0,l$r[8]=(l$J+l$t)*l$l,l$r[9]=(l$M-l$X)*l$l,l$r[10]=(1-(l$n+l$h))*l$l,l$r[11]=0,l$r[12]=l$i[0],l$r[13]=l$i[1],l$r[14]=l$i[2],l$r[15]=1},l$o._mulMatrixArray=function(l$i,l$_,l$R,l$r){var l$b,l$z,l$L,l$w,l$x,l$P=l$_.elements,l$B=l$P[0],l$n=l$P[1],l$f=l$P[2],l$J=l$P[3],l$h=l$P[4],l$M=l$P[5],l$N=l$P[6],l$X=l$P[7],l$t=l$P[8],l$I=l$P[9],l$e=l$P[10],l$c=l$P[11],l$l=l$P[12],l$A=l$P[13],l$Z=l$P[14],l$q=l$P[15],l$j=l$r,l$S=l$r+4,l$v=l$r+8,l$$=l$r+12;for(l$b=0;l$b<4;l$b++)l$z=l$i[l$b],l$L=l$i[l$b+4],l$w=l$i[l$b+8],l$x=l$i[l$b+12],l$R[l$j+l$b]=l$z*l$B+l$L*l$n+l$w*l$f+l$x*l$J,l$R[l$S+l$b]=l$z*l$h+l$L*l$M+l$w*l$N+l$x*l$X,l$R[l$v+l$b]=l$z*l$t+l$L*l$I+l$w*l$e+l$x*l$c,l$R[l$$+l$b]=l$z*l$l+l$L*l$A+l$w*l$Z+l$x*l$q},l$o.getYawPitchRoll=function(l$i,l$_){l$o.transformQuat(l$L_.ForwardRH,l$i,l$R_.TEMPVector31),l$o.transformQuat(l$L_.Up,l$i,l$R_.TEMPVector32);var l$R=l$R_.TEMPVector32.elements;l$o.angleTo(l$L_.ZERO,l$R_.TEMPVector31,l$R_.TEMPVector33);var l$r=l$R_.TEMPVector33.elements;l$r[0]==Math.PI/2?(l$r[1]=l$o.arcTanAngle(l$R[2],l$R[0]),l$r[2]=0):l$r[0]==-Math.PI/2?(l$r[1]=l$o.arcTanAngle(-l$R[2],-l$R[0]),l$r[2]=0):(l$i_.createRotationY(-l$r[1],l$R_.TEMPMatrix0),l$i_.createRotationX(-l$r[0],l$R_.TEMPMatrix1),l$L_.transformCoordinate(l$R_.TEMPVector32,l$R_.TEMPMatrix0,l$R_.TEMPVector32),l$L_.transformCoordinate(l$R_.TEMPVector32,l$R_.TEMPMatrix1,l$R_.TEMPVector32),l$r[2]=l$o.arcTanAngle(l$R[1],-l$R[0])),l$r[1]<=-Math.PI&&(l$r[1]=Math.PI),l$r[2]<=-Math.PI&&(l$r[2]=Math.PI),l$r[1]>=Math.PI&&l$r[2]>=Math.PI&&(l$r[1]=0,l$r[2]=0,l$r[0]=Math.PI-l$r[0]),l$_[0]=l$r[1],l$_[1]=l$r[0],l$_[2]=l$r[2]},l$o.arcTanAngle=function(l$i,l$_){return 0==l$i?1==l$_?Math.PI/2:-Math.PI/2:0<l$i?Math.atan(l$_/l$i):l$i<0?0<l$_?Math.atan(l$_/l$i)+Math.PI:Math.atan(l$_/l$i)-Math.PI:0},l$o.angleTo=function(l$i,l$_,l$R){l$L_.subtract(l$_,l$i,l$R_.TEMPVector30),l$L_.normalize(l$R_.TEMPVector30,l$R_.TEMPVector30),l$R.elements[0]=Math.asin(l$R_.TEMPVector30.y),l$R.elements[1]=l$o.arcTanAngle(-l$R_.TEMPVector30.z,-l$R_.TEMPVector30.x)},l$o.transformQuat=function(l$i,l$_,l$R){var l$r=l$R.elements,l$b=l$i.elements,l$z=l$_,l$L=l$b[0],l$w=l$b[1],l$x=l$b[2],l$P=l$z[0],l$B=l$z[1],l$n=l$z[2],l$f=l$z[3],l$J=l$f*l$L+l$B*l$x-l$n*l$w,l$h=l$f*l$w+l$n*l$L-l$P*l$x,l$M=l$f*l$x+l$P*l$w-l$B*l$L,l$N=-l$P*l$L-l$B*l$w-l$n*l$x;l$r[0]=l$J*l$f+l$N*-l$P+l$h*-l$n-l$M*-l$B,l$r[1]=l$h*l$f+l$N*-l$B+l$M*-l$P-l$J*-l$n,l$r[2]=l$M*l$f+l$N*-l$n+l$J*-l$B-l$h*-l$P},l$o.quaterionNormalize=function(l$i,l$_){var l$R=l$i[0],l$r=l$i[1],l$b=l$i[2],l$z=l$i[3],l$L=l$R*l$R+l$r*l$r+l$b*l$b+l$z*l$z;0<l$L&&(l$L=1/Math.sqrt(l$L),l$_[0]=l$R*l$L,l$_[1]=l$r*l$L,l$_[2]=l$b*l$L,l$_[3]=l$z*l$L)},l$o.matrix4x4MultiplyFFF=function(l$i,l$_,l$R){var l$r,l$b,l$z,l$L,l$w;if(l$R===l$_)for(l$_=new Float32Array(16),l$r=0;l$r<16;++l$r)l$_[l$r]=l$R[l$r];for(l$r=0;l$r<4;l$r++)l$b=l$i[l$r],l$z=l$i[l$r+4],l$L=l$i[l$r+8],l$w=l$i[l$r+12],l$R[l$r]=l$b*l$_[0]+l$z*l$_[1]+l$L*l$_[2]+l$w*l$_[3],l$R[l$r+4]=l$b*l$_[4]+l$z*l$_[5]+l$L*l$_[6]+l$w*l$_[7],l$R[l$r+8]=l$b*l$_[8]+l$z*l$_[9]+l$L*l$_[10]+l$w*l$_[11],l$R[l$r+12]=l$b*l$_[12]+l$z*l$_[13]+l$L*l$_[14]+l$w*l$_[15]},l$o.matrix4x4MultiplyMFM=function(l$i,l$_,l$R){l$o.matrix4x4MultiplyFFF(l$i.elements,l$_,l$R.elements)},l$n(l$o,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new l$L_},"_tempVector3_1",function(){return this._tempVector3_1=new l$L_},"_tempVector3_2",function(){return this._tempVector3_2=new l$L_},"_tempVector3_3",function(){return this._tempVector3_3=new l$L_},"_tempVector3_4",function(){return this._tempVector3_4=new l$L_},"_tempVector3_5",function(){return this._tempVector3_5=new l$L_},"_tempVector3_6",function(){return this._tempVector3_6=new l$L_},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),l$o}(),l$X_=function(){function l$G(){}return l$J(l$G,"Laya3D"),l$G._cancelLoadByUrl=function(l$i){l$c.loader.cancelLoadByUrl(l$i),l$G._innerFirstLevelLoaderManager.cancelLoadByUrl(l$i),l$G._innerSecondLevelLoaderManager.cancelLoadByUrl(l$i),l$G._innerThirdLevelLoaderManager.cancelLoadByUrl(l$i),l$G._innerFourthLevelLoaderManager.cancelLoadByUrl(l$i)},l$G._changeWebGLSize=function(l$i,l$_){l$$.onStageResize(l$i,l$_),l$F.clientWidth=l$i,l$F.clientHeight=l$_},l$G.__init__=function(){var l$i=l$_.createMap;l$i.lh=[l$k_,"SPRITE3DHIERARCHY"],l$i.ls=[l$p_,"SPRITE3DHIERARCHY"],l$i.lm=[l$m_,"MESH"],l$i.lmat=[l$O_,"MATERIAL"],l$i.jpg=[l$U_,"nativeimage"],l$i.jpeg=[l$U_,"nativeimage"],l$i.png=[l$U_,"nativeimage"],l$i.pkm=[l$U_,"arraybuffer"],l$i.raw=[l$Y_,"arraybuffer"],l$i.mipmaps=[l$Y_,"arraybuffer"],l$X.parserMap.SPRITE3DHIERARCHY=l$G._loadHierarchy,l$X.parserMap.MESH=l$G._loadMesh,l$X.parserMap.MATERIAL=l$G._loadMaterial,l$X.parserMap.TEXTURECUBE=l$G._loadTextureCube,l$X.parserMap.TERRAIN=l$G._loadTerrain,l$G._innerFirstLevelLoaderManager.on("error",null,l$G._eventLoadManagerError),l$G._innerSecondLevelLoaderManager.on("error",null,l$G._eventLoadManagerError),l$G._innerThirdLevelLoaderManager.on("error",null,l$G._eventLoadManagerError),l$G._innerFourthLevelLoaderManager.on("error",null,l$G._eventLoadManagerError)},l$G.READ_BLOCK=function(){return l$G._readData.pos+=4,!0},l$G.READ_DATA=function(){return l$G._DATA.offset=l$G._readData.getUint32(),l$G._DATA.size=l$G._readData.getUint32(),!0},l$G.READ_STRINGS=function(){var l$i=[],l$_={offset:0,size:0};l$_.offset=l$G._readData.getUint16(),l$_.size=l$G._readData.getUint16();l$G._readData.pos;l$G._readData.pos=l$_.offset+l$G._DATA.offset;for(var l$R=0;l$R<l$_.size;l$R++){var l$r=l$G._readData.readUTFString();-1===l$r.lastIndexOf(".lmat")&&-1===l$r.lastIndexOf(".lpbr")||l$i.push(l$r)}return l$i},l$G.formatRelativePath=function(l$i,l$_){var l$R;if("."===l$_.charAt(0)){for(var l$r=(l$i+l$_).split("/"),l$b=0,l$z=l$r.length;l$b<l$z;l$b++)if(".."==l$r[l$b]){var l$L=l$b-1;0<l$L&&".."!==l$r[l$L]&&(l$r.splice(l$L,2),l$b-=2)}l$R=l$r.join("/")}else l$R=l$i+l$_;return null!=l$v.customFormat&&(l$R=l$v.customFormat(l$R,null)),l$R},l$G._eventLoadManagerError=function(l$i){l$c.loader.event("error",l$i)},l$G._addHierarchyInnerUrls=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L=l$G.formatRelativePath(l$r,l$b);l$R&&(l$L+=l$R),l$i.push({url:l$L,clas:l$z}),l$_[l$b]=l$L},l$G._getSprite3DHierarchyInnerUrls=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){var l$w,l$x=0,l$P=0;switch(l$i.type){case"Scene":var l$B=l$i.customProps.lightmaps;for(l$x=0,l$P=l$B.length;l$x<l$P;l$x++){var l$n=l$B[l$x].replace(".exr",".png");l$G._addHierarchyInnerUrls(l$r,l$b,l$z,l$L,l$n,l$U_)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var l$f;if(l$i.instanceParams)(l$f=l$i.instanceParams.loadPath)&&l$G._addHierarchyInnerUrls(l$_,l$b,l$z,l$L,l$f,l$m_);else{(l$f=(l$w=l$i.customProps).meshPath)&&l$G._addHierarchyInnerUrls(l$_,l$b,l$z,l$L,l$f,l$m_);var l$J=l$w.materials;if(l$J)for(l$x=0,l$P=l$J.length;l$x<l$P;l$x++){for(var l$h=l$J[l$x],l$M=l$h.type.split("."),l$N=l$u.window,l$X=0,l$t=l$M.length;l$X<l$t;++l$X){l$N=l$N[this.clasPaths[l$X]]}if("function"!=typeof l$N)throw"_getSprite3DHierarchyInnerUrls 错误: "+l$h.type+" 不是类";l$G._addHierarchyInnerUrls(l$R,l$b,l$z,l$L,l$h.path,l$N)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var l$I=(l$w=l$i.customProps).meshPath;l$I&&l$G._addHierarchyInnerUrls(l$_,l$b,l$z,l$L,l$I,l$m_);var l$e=l$w.material;if(l$e){l$M=l$e.type.split("."),l$N=l$u.window;for(l$X=0,l$t=l$M.length;l$X<l$t;++l$X){l$N=l$N[this.clasPaths[l$X]]}l$G._addHierarchyInnerUrls(l$R,l$b,l$z,l$L,l$e.path,l$N)}else{var l$c=l$w.materialPath;if(l$c)l$G._addHierarchyInnerUrls(l$R,l$b,l$z,l$L,l$c,ShurikenParticleMaterial);else{var l$l=l$w.texturePath;l$l&&l$G._addHierarchyInnerUrls(l$r,l$b,l$z,l$L,l$l,l$U_)}}break;case"Terrain":l$G._addHierarchyInnerUrls(l$r,l$b,l$z,l$L,l$i.customProps.dataPath,TerrainRes)}var l$A=l$i.components;for(var l$Z in l$A){var l$q=l$A[l$Z];switch(l$Z){case"Animator":var l$j=l$q.avatarPath;if(l$j)l$G._addHierarchyInnerUrls(l$r,l$b,l$z,l$L,l$j,Avatar);else{var l$S=l$q.avatar;l$S&&l$G._addHierarchyInnerUrls(l$r,l$b,l$z,l$L,l$S.path,Avatar)}var l$v=l$q.clipPaths;for(l$x=0,l$P=l$v.length;l$x<l$P;l$x++)l$G._addHierarchyInnerUrls(l$r,l$b,l$z,l$L,l$v[l$x],AnimationClip)}}var l$$=l$i.child;for(l$x=0,l$P=l$$.length;l$x<l$P;l$x++)l$G._getSprite3DHierarchyInnerUrls(l$$[l$x],l$_,l$R,l$r,l$b,l$z,l$L)},l$G._loadHierarchy=function(l$i){l$i.on("loaded",null,l$G._onHierarchylhLoaded,[l$i,l$i._class._getGroup()]),l$i.load(l$i.url,"json",!1,null,!0)},l$G._onHierarchylhLoaded=function(l$i,l$_,l$R){if(l$i._class.destroyed)l$i.endLoad();else{var l$r=l$i.url,l$b=l$N_.getURLVerion(l$r),l$z=l$v.getPath(l$r),l$L=[],l$w=[],l$x=[],l$P={};l$G._getSprite3DHierarchyInnerUrls(l$R,l$L,l$w,l$x,l$P,l$b,l$z);var l$B=l$L.length+l$w.length+l$x.length,l$n=l$B+1,l$f=1/l$n;if(l$G._onProcessChange(l$i,0,l$f,1),0<l$x.length){var l$J=l$B/l$n,l$h=l$S.create(null,l$G._onProcessChange,[l$i,l$f,l$J],!1);l$G._innerFourthLevelLoaderManager.create(l$x,l$S.create(null,l$G._onHierarchyInnerForthLevResouLoaded,[l$i,l$_,l$h,l$R,l$P,l$L,l$w,l$f+l$J*l$x.length,l$J]),l$h,null,null,1,!0,l$_)}else l$G._onHierarchyInnerForthLevResouLoaded(l$i,l$_,null,l$R,l$P,l$L,l$w,l$f,l$J)}},l$G._onHierarchyInnerForthLevResouLoaded=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){if(l$i._class.destroyed)l$i.endLoad();else if(l$R&&l$R.recover(),0<l$L.length){var l$P=l$S.create(null,l$G._onProcessChange,[l$i,l$w,l$x],!1);l$G._innerSecondLevelLoaderManager.create(l$L,l$S.create(null,l$G._onHierarchyInnerSecondLevResouLoaded,[l$i,l$_,l$P,l$r,l$b,l$z,l$w+l$x*l$L.length,l$x]),l$R,null,null,1,!0,l$_)}else l$G._onHierarchyInnerSecondLevResouLoaded(l$i,l$_,null,l$r,l$b,l$z,l$w,l$x)},l$G._onHierarchyInnerSecondLevResouLoaded=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w){if(l$i._class.destroyed)l$i.endLoad();else if(l$R&&l$R.recover(),0<l$z.length){var l$x=l$S.create(null,l$G._onProcessChange,[l$i,l$L,l$w],!1);l$G._innerFirstLevelLoaderManager.create(l$z,l$S.create(null,l$G._onHierarchyInnerFirstLevResouLoaded,[l$i,l$x,l$r,l$b]),l$R,null,null,1,!0,l$_)}else l$G._onHierarchyInnerFirstLevResouLoaded(l$i,null,l$r,l$b)},l$G._onHierarchyInnerFirstLevResouLoaded=function(l$i,l$_,l$R,l$r){l$_&&l$_.recover(),l$i.endLoad([l$R,l$r])},l$G._loadTerrain=function(l$i){l$i.on("loaded",null,l$G._onTerrainLtLoaded,[l$i,l$i._class._getGroup()]),l$i.load(l$i.url,"json",!1,null,!0)},l$G._onTerrainLtLoaded=function(l$i,l$_,l$R){if(l$i._class.destroyed)l$i.endLoad();else{var l$r,l$b,l$z=l$i.url,l$L=l$N_.getURLVerion(l$z),l$w=l$v.getPath(l$z),l$x=[],l$P={},l$B=0,l$n=0,l$f=l$R.heightData;l$r=l$f.url,l$b=l$G.formatRelativePath(l$w,l$r),l$L&&(l$b+=l$L),l$r=l$P[l$r]=l$b;var l$J=l$R.detailTexture;for(l$B=0,l$n=l$J.length;l$B<l$n;l$B++)l$x.push({url:l$J[l$B].diffuse});var l$h=l$R.normalMap;for(l$B=0,l$n=l$h.length;l$B<l$n;l$B++)l$x.push({url:l$h[l$B]});var l$M=l$R.alphaMap;for(l$B=0,l$n=l$M.length;l$B<l$n;l$B++)l$x.push({url:l$M[l$B],params:[!1,!1,6408,!0]});for(l$B=0,l$n=l$x.length;l$B<l$n;l$B++){var l$N=l$x[l$B].url;l$b=l$G.formatRelativePath(l$w,l$N),l$L&&(l$b+=l$L),l$x[l$B].url=l$b,l$P[l$N]=l$b}var l$X=l$x.length,l$t=l$X+2,l$I=1/l$t;l$G._onProcessChange(l$i,0,l$I,1);var l$e={heightMapLoaded:!1,texturesLoaded:!1},l$c=l$S.create(null,l$G._onProcessChange,[l$i,l$I,l$I],!1);l$G._innerFourthLevelLoaderManager.create(l$r,l$S.create(null,l$G._onTerrainHeightMapLoaded,[l$i,l$c,l$R,l$P,l$e]),l$c,null,[l$f.numX,l$f.numZ,l$f.bitType,l$f.value],1,!0,l$_);var l$l=l$S.create(null,l$G._onProcessChange,[l$i,2*l$I,l$X/l$t],!1);l$G._innerFourthLevelLoaderManager.create(l$x,l$S.create(null,l$G._onTerrainTexturesLoaded,[l$i,l$l,l$R,l$P,l$e]),l$l,null,null,1,!0,l$_)}},l$G._onTerrainHeightMapLoaded=function(l$i,l$_,l$R,l$r,l$b){l$b.heightMapLoaded=!0,l$b.texturesLoaded&&(l$i.endLoad([l$R,l$r]),l$_.recover())},l$G._onTerrainTexturesLoaded=function(l$i,l$_,l$R,l$r,l$b){l$b.texturesLoaded=!0,l$b.heightMapLoaded&&(l$i.endLoad([l$R,l$r]),l$_.recover())},l$G._loadMesh=function(l$i){l$i.on("loaded",null,l$G._onMeshLmLoaded,[l$i,l$i._class._getGroup()]),l$i.load(l$i.url,"arraybuffer",!1,null,!0)},l$G._onMeshLmLoaded=function(l$i,l$_,l$R){if(l$i._class.destroyed)l$i.endLoad();else{var l$r,l$b,l$z,l$L=l$i.url,l$w=l$N_.getURLVerion(l$L),l$x=l$v.getPath(l$L),l$P={},l$B=0,l$n=0;switch((l$G._readData=new l$l(l$R)).pos=0,l$G._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var l$f=l$G._readData.getUint32();l$G._readData.pos=l$G._readData.pos+4,l$n=l$G._readData.getUint16(),l$G._readData.pos=l$G._readData.pos+8*l$n;var l$J=l$G._readData.getUint32();for(l$n=l$G._readData.getUint16(),l$G._readData.pos=l$f+l$J,l$r=[],l$B=0;l$B<l$n;l$B++){var l$h=l$G._readData.readUTFString();-1!==l$h.lastIndexOf(".lmat")&&l$r.push(l$h)}break;default:for(l$G.READ_BLOCK(),l$B=0;l$B<2;l$B++){var l$M=l$G._readData.getUint16(),l$N=l$G._strings[l$M],l$X=l$G["READ_"+l$N];if(null==l$X)throw new Error("model file err,no this function:"+l$M+" "+l$N);1===l$B?l$r=l$X.call():l$X.call()}}for(l$B=0,l$z=l$r.length;l$B<l$z;l$B++){var l$t=l$r[l$B];l$b=l$G.formatRelativePath(l$x,l$t),l$w&&(l$b+=l$w),l$r[l$B]=l$b,l$P[l$t]=l$b}if(0<l$r.length){l$G._onProcessChange(l$i,0,.5,1);var l$I=l$S.create(null,l$G._onProcessChange,[l$i,.5,.5],!1);l$G._innerSecondLevelLoaderManager.create(l$r,l$S.create(null,l$G._onMeshMateialLoaded,[l$i,l$I,l$R,l$P]),l$I,null,null,1,!0,l$_)}else l$i.endLoad([l$R,l$P])}},l$G._onMeshMateialLoaded=function(l$i,l$_,l$R,l$r){l$i.endLoad([l$R,l$r]),l$_.recover()},l$G._getMaterialTexturePath=function(l$i,l$_,l$R){var l$r=l$i.length-4;return l$i.indexOf(".dds")!=l$r&&l$i.indexOf(".tga")!=l$r&&l$i.indexOf(".exr")!=l$r&&l$i.indexOf(".DDS")!=l$r&&l$i.indexOf(".TGA")!=l$r&&l$i.indexOf(".EXR")!=l$r||(l$i=l$i.substr(0,l$r)+".png"),l$i=l$G.formatRelativePath(l$R,l$i),l$_&&(l$i+=l$_),l$i},l$G._loadMaterial=function(l$i){l$i.on("loaded",null,l$G._onMaterilLmatLoaded,[l$i,l$i._class._getGroup()]),l$i.load(l$i.url,"json",!1,null,!0)},l$G._onMaterilLmatLoaded=function(l$i,l$_,l$R){if(l$i._class.destroyed)l$i.endLoad();else{var l$r,l$b=l$i.url,l$z=l$N_.getURLVerion(l$b),l$L=l$v.getPath(l$b),l$w=[],l$x={},l$P=l$R.customProps,l$B=l$R.version;if(l$B)switch(l$B){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var l$n=l$R.props.textures,l$f=0,l$J=l$n.length;l$f<l$J;l$f++){var l$h=l$n[l$f],l$M=l$h.path;if(l$M){var l$N=l$M.length-4;l$M.indexOf(".exr")!=l$N&&l$M.indexOf(".EXR")!=l$N||(l$M=l$M.substr(0,l$N)+".png"),l$r=l$G.formatRelativePath(l$L,l$M),l$z&&(l$r+=l$z),l$w.push({url:l$r,params:l$h.params}),l$x[l$M]=l$r}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var l$X=l$P.diffuseTexture.texture2D;if(l$X&&(l$r=l$G._getMaterialTexturePath(l$X,l$z,l$L),l$w.push(l$r),l$x[l$X]=l$r),l$P.normalTexture){var l$t=l$P.normalTexture.texture2D;l$t&&(l$r=l$G._getMaterialTexturePath(l$t,l$z,l$L),l$w.push(l$r),l$x[l$t]=l$r)}if(l$P.specularTexture){var l$I=l$P.specularTexture.texture2D;l$I&&(l$r=l$G._getMaterialTexturePath(l$I,l$z,l$L),l$w.push(l$r),l$x[l$I]=l$r)}if(l$P.emissiveTexture){var l$e=l$P.emissiveTexture.texture2D;l$e&&(l$r=l$G._getMaterialTexturePath(l$e,l$z,l$L),l$w.push(l$r),l$x[l$e]=l$r)}if(l$P.ambientTexture){var l$c=l$P.ambientTexture.texture2D;l$c&&(l$r=l$G._getMaterialTexturePath(l$c,l$z,l$L),l$w.push(l$r),l$x[l$c]=l$r)}if(l$P.reflectTexture){var l$l=l$P.reflectTexture.texture2D;l$l&&(l$r=l$G._getMaterialTexturePath(l$l,l$z,l$L),l$w.push(l$r),l$x[l$l]=l$r)}}var l$A=l$w.length,l$Z=l$A+1,l$q=1/l$Z;if(l$G._onProcessChange(l$i,0,l$q,1),0<l$A){var l$j=l$S.create(null,l$G._onProcessChange,[l$i,l$q,l$A/l$Z],!1);l$G._innerFourthLevelLoaderManager.create(l$w,l$S.create(null,l$G._onMateialTexturesLoaded,[l$i,l$j,l$R,l$x]),l$j,l$U_,null,1,!0,l$_)}else l$G._onMateialTexturesLoaded(l$i,null,l$R,null)}},l$G._onMateialTexturesLoaded=function(l$i,l$_,l$R,l$r){l$i.endLoad([l$R,l$r]),l$_&&l$_.recover()},l$G._loadTextureCube=function(l$i){l$i.on("loaded",null,l$G._onTextureCubeLtcLoaded,[l$i]),l$i.load(l$i.url,"json",!1,null,!0)},l$G._onTextureCubeLtcLoaded=function(l$i,l$_){if(l$i._class.destroyed)l$i.endLoad();else{var l$R=l$v.getPath(l$i.url),l$r=[l$G.formatRelativePath(l$R,l$_.px),l$G.formatRelativePath(l$R,l$_.nx),l$G.formatRelativePath(l$R,l$_.py),l$G.formatRelativePath(l$R,l$_.ny),l$G.formatRelativePath(l$R,l$_.pz),l$G.formatRelativePath(l$R,l$_.nz)];l$G._onProcessChange(l$i,0,1/7,1);var l$b=l$S.create(null,l$G._onProcessChange,[l$i,1/7,6/7],!1);l$G._innerFourthLevelLoaderManager.load(l$r,l$S.create(null,l$G._onTextureCubeImagesLoaded,[l$i,l$r,l$b]),l$b,"nativeimage")}},l$G._onTextureCubeImagesLoaded=function(l$i,l$_,l$R){var l$r=[];l$r.length=6;for(var l$b=0;l$b<6;l$b++){var l$z=l$_[l$b];l$r[l$b]=l$X.getRes(l$z),l$X.clearRes(l$z)}l$i.endLoad(l$r),l$R.recover()},l$G._onProcessChange=function(l$i,l$_,l$R,l$r){(l$r=l$_+l$r*l$R)<1&&l$i.event("progress",l$r)},l$G.init=function(l$i,l$_,l$R,l$r,l$b,l$z){if(void 0===l$R&&(l$R=!1),void 0===l$r&&(l$r=!1),void 0===l$b&&(l$b=!0),void 0===l$z&&(l$z=!0),l$t.update3DLoop=function(){},l$t.cancelLoadByUrl=function(l$i){l$G._cancelLoadByUrl(l$i)},l$x.isAntialias=l$R,l$x.isAlpha=l$r,l$x.premultipliedAlpha=l$b,l$x.isStencil=l$z,!l$$.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");l$t.changeWebGLSize=l$G._changeWebGLSize,l$M.is3DMode=!0,l$c.init(l$i,l$_),l$o.__init__(),l$n_.__init__(),l$a_.__init__(),l$C.__init__(),l$G.__init__(),l$L.maxTextureCount=2,(l$G.debugMode||l$d.debugMode)&&(l$G._debugPhasorSprite=new l$V)},l$G.HIERARCHY="SPRITE3DHIERARCHY",l$G.MESH="MESH",l$G.MATERIAL="MATERIAL",l$G.PBRMATERIAL="PBRMTL",l$G.TEXTURECUBE="TEXTURECUBE",l$G.TERRAIN="TERRAIN",l$G._readData=null,l$G._debugPhasorSprite=null,l$G.debugMode=!1,l$n(l$G,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new l$_},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new l$_},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new l$_},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new l$_}]),l$G}(),l$t_=function(l$i){function l$b(l$i){l$b.__super.call(this),this._owner=l$i,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}l$J(l$b,"laya.d3.animation.AnimationTransform3D",l$z);var l$_=l$b.prototype;return l$_._getlocalMatrix=function(){return this._localUpdate&&(l$N_._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},l$_._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var l$i=0,l$_=this._childs.length;l$i<l$_;l$i++)this._childs[l$i]._onWorldTransform()}},l$_._setWorldMatrixAndUpdate=function(l$i){if(this._worldMatrix=l$i,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var l$_=this._getlocalMatrix(),l$R=0;l$R<16;++l$R)this._worldMatrix[l$R]=l$_[l$R];else l$N_.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},l$_._setWorldMatrixNoUpdate=function(l$i){this._worldMatrix=l$i},l$_._setWorldMatrixIgnoreUpdate=function(l$i){this._worldMatrix=l$i,this._worldUpdate=!1},l$_.getLocalPosition=function(){return this._localPosition},l$_.setLocalPosition=function(l$i){if(this._parent)this._localPosition=l$i,this._localUpdate=!0,this._onWorldTransform();else{var l$_=this._entity.owner._transform,l$R=this._entity.localPosition,l$r=l$R.elements;l$r[0]=l$i[0],l$r[1]=l$i[1],l$r[2]=l$i[2],l$_.localPosition=l$R}},l$_.getLocalRotation=function(){if(this._localQuaternionUpdate){var l$i=this._localRotationEuler;l$N_._quaternionCreateFromYawPitchRollArray(l$i[1]/l$b._angleToRandin,l$i[0]/l$b._angleToRandin,l$i[2]/l$b._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},l$_.setLocalRotation=function(l$i){if(this._parent)this._localRotation=l$i,l$N_.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var l$_=this._entity.owner._transform,l$R=this._entity.localRotation,l$r=l$R.elements;l$r[0]=l$i[0],l$r[1]=l$i[1],l$r[2]=l$i[2],l$r[3]=l$i[3],l$_.localRotation=l$R}},l$_.getLocalScale=function(){return this._localScale},l$_.setLocalScale=function(l$i){if(this._parent)this._localScale=l$i,this._localUpdate=!0,this._onWorldTransform();else{var l$_=this._entity.owner._transform,l$R=this._entity.localScale,l$r=l$R.elements;l$r[0]=l$i[0],l$r[1]=l$i[1],l$r[2]=l$i[2],l$_.localScale=l$R}},l$_.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){l$N_.getYawPitchRoll(this._localRotation,l$b._tempVector3);var l$i=l$b._tempVector3,l$_=this._localRotationEuler;l$_[0]=l$i[1]*l$b._angleToRandin,l$_[1]=l$i[0]*l$b._angleToRandin,l$_[2]=l$i[2]*l$b._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},l$_.setLocalRotationEuler=function(l$i){if(this._parent)l$N_._quaternionCreateFromYawPitchRollArray(l$i[1]/l$b._angleToRandin,l$i[0]/l$b._angleToRandin,l$i[2]/l$b._angleToRandin,this._localRotation),this._localRotationEuler=l$i,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var l$_=this._entity.owner._transform,l$R=this._entity.localRotationEuler,l$r=l$R.elements;l$r[0]=l$i[0],l$r[1]=l$i[1],l$r[2]=l$i[2],l$_.localRotationEuler=l$R}},l$_.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)l$N_.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var l$i=this._getlocalMatrix(),l$_=0;l$_<16;++l$_)this._worldMatrix[l$_]=l$i[l$_];this._worldUpdate=!1}return this._worldMatrix},l$_.setParent=function(l$i){if(this._parent!==l$i){if(this._parent){var l$_=this._parent._childs,l$R=l$_.indexOf(this);l$_.splice(l$R,1)}l$i&&(l$i._childs.push(this),l$i&&this._onWorldTransform()),this._parent=l$i}},l$n(l$b,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),l$b}(),l$I_=function(l$i){function l$_(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,l$_.__super.call(this),this._destroyed=!1,this._id=l$_._uniqueIDCounter,l$_._uniqueIDCounter++}l$J(l$_,"laya.d3.component.Component3D",l$z);var l$R=l$_.prototype;return l$c.imps(l$R,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),l$R._initialize=function(l$i){this._owner=l$i,this._enable=!0,this.started=!1,this._load(l$i)},l$R._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},l$R._load=function(l$i){},l$R._start=function(l$i){},l$R._update=function(l$i){},l$R._lateUpdate=function(l$i){},l$R._preRenderUpdate=function(l$i){},l$R._postRenderUpdate=function(l$i){},l$R._unload=function(l$i){this.offAll()},l$R._cloneTo=function(l$i){},l$h(0,l$R,"id",function(){return this._id}),l$h(0,l$R,"destroyed",function(){return this._destroyed}),l$h(0,l$R,"owner",function(){return this._owner}),l$h(0,l$R,"enable",function(){return this._enable},function(l$i){this._enable!==l$i&&(this._enable=l$i,this.event("enablechanged",this._enable))}),l$h(0,l$R,"isSingleton",function(){return l$_._isSingleton}),l$_._isSingleton=!0,l$_._uniqueIDCounter=1,l$_}(),l$e_=function(l$i){function l$_(){this._destroyed=!1,l$_.__super.call(this),this._destroyed=!1}l$J(l$_,"laya.d3.core.GeometryFilter",l$z);var l$R=l$_.prototype;return l$c.imps(l$R,{"laya.resource.IDestroy":!0}),l$R._destroy=function(){this.offAll(),this._destroyed=!0},l$h(0,l$R,"_isAsyncLoaded",function(){return!0}),l$h(0,l$R,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),l$h(0,l$R,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),l$h(0,l$R,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),l$h(0,l$R,"destroyed",function(){return this._destroyed}),l$_}(),l$c_=function(l$i){function l$r(l$i){l$r.__super.call(this),this._id=++l$r._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new l$di(new l$L_,new l$L_),this._boundingBoxCenter=new l$L_,this._boundingSphere=new l$Hi(new l$L_,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=l$i,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}l$J(l$r,"laya.d3.core.render.BaseRender",l$z);var l$_=l$r.prototype;return l$c.imps(l$_,{"laya.resource.IDestroy":!0}),l$_._changeMaterialReference=function(l$i,l$_){l$i&&l$i._removeReference(),l$_._addReference()},l$_._getInstanceMaterial=function(l$i,l$_){var l$R=new l$i.constructor;return l$i.cloneTo(l$R),l$R.name=l$R.name+"(Instance)",this._materialsInstance[l$_]=!0,this._changeMaterialReference(this._materials[l$_],l$R),this._materials[l$_]=l$R},l$_._setShaderValuelightMap=function(l$i){this._setShaderValueTexture(3,l$i)},l$_._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},l$_._renderRenderableBoundBox=function(){var l$i=l$X_._debugPhasorSprite,l$_=this.boundingBox,l$R=l$r._tempBoundBoxCorners;l$_.getCorners(l$R),l$i.line(l$R[0],l$r._greenColor,l$R[1],l$r._greenColor),l$i.line(l$R[2],l$r._greenColor,l$R[3],l$r._greenColor),l$i.line(l$R[4],l$r._greenColor,l$R[5],l$r._greenColor),l$i.line(l$R[6],l$r._greenColor,l$R[7],l$r._greenColor),l$i.line(l$R[0],l$r._greenColor,l$R[3],l$r._greenColor),l$i.line(l$R[1],l$r._greenColor,l$R[2],l$r._greenColor),l$i.line(l$R[2],l$r._greenColor,l$R[6],l$r._greenColor),l$i.line(l$R[3],l$r._greenColor,l$R[7],l$r._greenColor),l$i.line(l$R[0],l$r._greenColor,l$R[4],l$r._greenColor),l$i.line(l$R[1],l$r._greenColor,l$R[5],l$r._greenColor),l$i.line(l$R[4],l$r._greenColor,l$R[7],l$r._greenColor),l$i.line(l$R[5],l$r._greenColor,l$R[6],l$r._greenColor)},l$_._calculateBoundingSphere=function(){throw"BaseRender: must override it."},l$_._calculateBoundingBox=function(){throw"BaseRender: must override it."},l$_._setShaderValueTexture=function(l$i,l$_){this._owner._shaderValues.setValue(l$i,l$_)},l$_._setShaderValueMatrix4x4=function(l$i,l$_){this._owner._shaderValues.setValue(l$i,l$_?l$_.elements:null)},l$_._setShaderValueColor=function(l$i,l$_){this._owner._shaderValues.setValue(l$i,l$_?l$_.elements:null)},l$_._setShaderValueBuffer=function(l$i,l$_){this._owner._shaderValues.setValue(l$i,l$_)},l$_._setShaderValueInt=function(l$i,l$_){this._owner._shaderValues.setValue(l$i,l$_)},l$_._setShaderValueBool=function(l$i,l$_){this._owner._shaderValues.setValue(l$i,l$_)},l$_._setShaderValueNumber=function(l$i,l$_){this._owner._shaderValues.setValue(l$i,l$_)},l$_._setShaderValueVector2=function(l$i,l$_){this._owner._shaderValues.setValue(l$i,l$_?l$_.elements:null)},l$_._addShaderDefine=function(l$i){this._owner._shaderDefineValue|=l$i},l$_._removeShaderDefine=function(l$i){this._owner._shaderDefineValue&=~l$i},l$_._renderUpdate=function(l$i){return!0},l$_._applyLightMapParams=function(){if(0<=this._lightmapIndex){var l$i=this._owner.scene;if(l$i){var l$_=l$i.getlightmaps()[this._lightmapIndex];l$_?(this._addShaderDefine(l$V_.SAHDERDEFINE_LIGHTMAP),l$_.loaded?this._setShaderValuelightMap(l$_):l$_.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(l$V_.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(l$V_.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(l$V_.SAHDERDEFINE_LIGHTMAP)},l$_._updateOctreeNode=function(){var l$i=this._treeNode;l$i&&this._octreeNodeNeedChange&&(l$i.updateObject(this),this._octreeNodeNeedChange=!1)},l$_._destroy=function(){this.offAll();var l$i=0,l$_=0;for(l$i=0,l$_=this._renderElements.length;l$i<l$_;l$i++)this._renderElements[l$i]._destroy();for(l$i=0,l$_=this._materials.length;l$i<l$_;l$i++)this._materials[l$i]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},l$h(0,l$_,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),l$h(0,l$_,"id",function(){return this._id}),l$h(0,l$_,"material",function(){var l$i=this._materials[0];if(l$i&&!this._materialsInstance[0]){var l$_=this._getInstanceMaterial(l$i,0);this.event("materialchanged",[this,0,l$_])}return this._materials[0]},function(l$i){this.sharedMaterial=l$i}),l$h(0,l$_,"sharedMaterial",function(){return this._materials[0]},function(l$i){var l$_=this._materials[0];l$_!==l$i&&(this._materials[0]=l$i,this._materialsInstance[0]=!1,this._changeMaterialReference(l$_,l$i),this.event("materialchanged",[this,0,l$i]))}),l$h(0,l$_,"lightmapIndex",function(){return this._lightmapIndex},function(l$i){this._lightmapIndex=l$i,this._applyLightMapParams()}),l$h(0,l$_,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(l$i){this._lightmapScaleOffset=l$i,this._setShaderValueColor(2,l$i),this._addShaderDefine(l$V_.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),l$h(0,l$_,"enable",function(){return this._enable},function(l$i){this._enable=l$i,this.event("enablechanged",[this,l$i])}),l$h(0,l$_,"materials",function(){for(var l$i=0,l$_=this._materials.length;l$i<l$_;l$i++)if(!this._materialsInstance[l$i]){var l$R=this._getInstanceMaterial(this._materials[l$i],l$i);this.event("materialchanged",[this,l$i,l$R])}return this._materials.slice()},function(l$i){this.sharedMaterials=l$i}),l$h(0,l$_,"sharedMaterials",function(){return this._materials.slice()},function(l$i){if(!l$i)throw new Error("MeshRender: shadredMaterials value can't be null.");var l$_=l$i.length;this._materialsInstance.length=l$_;for(var l$R=0;l$R<l$_;l$R++){var l$r=this._materials[l$R];l$r!==l$i[l$R]&&(this._materialsInstance[l$R]=!1,this._changeMaterialReference(l$r,l$i[l$R]),this.event("materialchanged",[this,l$R,l$i[l$R]]))}this._materials=l$i}),l$h(0,l$_,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),l$h(0,l$_,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var l$i=this.boundingBox;l$L_.add(l$i.min,l$i.max,this._boundingBoxCenter),l$L_.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),l$h(0,l$_,"receiveShadow",function(){return this._receiveShadow},function(l$i){this._receiveShadow!==l$i&&((this._receiveShadow=l$i)?this._addShaderDefine(l$J_.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(l$J_.SHADERDEFINE_RECEIVE_SHADOW))}),l$h(0,l$_,"destroyed",function(){return this._destroyed}),l$r._uniqueIDCounter=0,l$n(l$r,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new l$L_,new l$L_,new l$L_,new l$L_,new l$L_,new l$L_,new l$L_,new l$L_]},"_greenColor",function(){return this._greenColor=new l$w_(0,1,0,1)}]),l$r}(),l$l_=function(l$i){function l$w(l$i){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,l$w.__super.call(this),this._localPosition=new l$L_,this._localRotation=new l$R_(0,0,0,1),this._localScale=new l$L_(1,1,1),this._localRotationEuler=new l$L_,this._localMatrix=new l$i_,this._position=new l$L_,this._rotation=new l$R_(0,0,0,1),this._scale=new l$L_(1,1,1),this._worldMatrix=new l$i_,this._forward=new l$L_,this._up=new l$L_,this._right=new l$L_,this._owner=l$i,this._childs=[]}l$J(l$w,"laya.d3.core.Transform3D",l$z);var l$_=l$w.prototype;return l$_._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)l$i_.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var l$i=l$w._tempVector30;l$L_.multiply(this.pivot,this._localScale,l$i);var l$_=l$w._tempVector31;l$L_.subtract(l$i,this.pivot,l$_);var l$R=l$w._tempVector32,l$r=this.localRotation;l$L_.transformQuat(l$i,l$r,l$R),l$L_.subtract(l$R,l$i,l$R);var l$b=l$w._tempVector33;l$L_.subtract(this._localPosition,l$_,l$b),l$L_.subtract(l$b,l$R,l$b),l$i_.createAffineTransformation(l$b,l$r,this._localScale,this._localMatrix)}},l$_._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var l$i=0,l$_=this._childs.length;l$i<l$_;l$i++)this._childs[l$i]._onWorldPositionRotationTransform()}},l$_._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var l$i=0,l$_=this._childs.length;l$i<l$_;l$i++)this._childs[l$i]._onWorldPositionScaleTransform()}},l$_._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var l$i=0,l$_=this._childs.length;l$i<l$_;l$i++)this._childs[l$i]._onWorldPositionTransform()}},l$_._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var l$i=0,l$_=this._childs.length;l$i<l$_;l$i++)this._childs[l$i]._onWorldPositionRotationTransform()}},l$_._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var l$i=0,l$_=this._childs.length;l$i<l$_;l$i++)this._childs[l$i]._onWorldPositionScaleTransform()}},l$_._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var l$i=0,l$_=this._childs.length;l$i<l$_;l$i++)this._childs[l$i]._onWorldTransform()}},l$_.translate=function(l$i,l$_){void 0===l$_&&(l$_=!0),l$_?(l$i_.createFromQuaternion(this.localRotation,l$w._tempMatrix0),l$L_.transformCoordinate(l$i,l$w._tempMatrix0,l$w._tempVector30),l$L_.add(this.localPosition,l$w._tempVector30,this._localPosition),this.localPosition=this._localPosition):(l$L_.add(this.position,l$i,this._position),this.position=this._position)},l$_.rotate=function(l$i,l$_,l$R){var l$r;void 0===l$_&&(l$_=!0),void 0===l$R&&(l$R=!0),l$r=l$R?l$i:(l$L_.scale(l$i,Math.PI/180,l$w._tempVector30),l$w._tempVector30),l$R_.createFromYawPitchRoll(l$r.y,l$r.x,l$r.z,l$w._tempQuaternion0),l$_?(l$R_.multiply(this._localRotation,l$w._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(l$R_.multiply(l$w._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},l$_.lookAt=function(l$i,l$_,l$R){void 0===l$R&&(l$R=!1);var l$r,l$b=l$i.elements;if(l$R){if(l$r=this._localPosition.elements,Math.abs(l$r[0]-l$b[0])<l$Wi.zeroTolerance&&Math.abs(l$r[1]-l$b[1])<l$Wi.zeroTolerance&&Math.abs(l$r[2]-l$b[2])<l$Wi.zeroTolerance)return;l$R_.lookAt(this._localPosition,l$i,l$_,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var l$z=this.position;if(l$r=l$z.elements,Math.abs(l$r[0]-l$b[0])<l$Wi.zeroTolerance&&Math.abs(l$r[1]-l$b[1])<l$Wi.zeroTolerance&&Math.abs(l$r[2]-l$b[2])<l$Wi.zeroTolerance)return;l$R_.lookAt(l$z,l$i,l$_,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},l$h(0,l$_,"_isFrontFaceInvert",function(){var l$i=this.scale,l$_=l$i.x<0;return l$i.y<0&&(l$_=!l$_),l$i.z<0&&(l$_=!l$_),l$_}),l$h(0,l$_,"owner",function(){return this._owner}),l$h(0,l$_,"localRotation",function(){if(this._localQuaternionUpdate){var l$i=this._localRotationEuler.elements;l$R_.createFromYawPitchRoll(l$i[1]/l$w._angleToRandin,l$i[0]/l$w._angleToRandin,l$i[2]/l$w._angleToRandin,this._localRotation)}return this._localRotation},function(l$i){this._localRotation=l$i,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),l$h(0,l$_,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?l$i_.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(l$i){null===this._parent?l$i.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),l$i_.multiply(this._localMatrix,l$i,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=l$i,this._worldUpdate=!1}),l$h(0,l$_,"worldNeedUpdate",function(){return this._worldUpdate}),l$h(0,l$_,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(l$i){this._localMatrix=l$i,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),l$h(0,l$_,"dummy",function(){return this._dummy},function(l$i){this._dummy!==l$i&&(this._dummy&&(this._dummy._entity=null),l$i&&(l$i._entity=this),this._dummy=l$i)}),l$h(0,l$_,"localPosition",function(){return this._localPosition},function(l$i){this._localPosition=l$i,this._localUpdate=!0,this._onWorldPositionTransform()}),l$h(0,l$_,"position",function(){if(this._positionUpdate){if(null!=this._parent){var l$i=this._parent.position;l$L_.multiply(this._localPosition,this._parent.scale,l$w._tempVector30),l$L_.transformQuat(l$w._tempVector30,this._parent.rotation,l$w._tempVector30),l$L_.add(l$i,l$w._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(l$i){if(null!=this._parent){l$L_.subtract(l$i,this._parent.position,this._localPosition);var l$_=this._parent.scale.elements,l$R=l$_[0],l$r=l$_[1],l$b=l$_[2];if(1!==l$R||1!==l$r||1!==l$b){var l$z=l$w._tempVector30,l$L=l$z.elements;l$L[0]=1/l$R,l$L[1]=1/l$r,l$L[2]=1/l$b,l$L_.multiply(this._localPosition,l$z,this._localPosition)}this._parent.rotation.invert(l$w._tempQuaternion0),l$L_.transformQuat(this._localPosition,l$w._tempQuaternion0,this._localPosition)}else l$i.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=l$i,this._positionUpdate=!1}),l$h(0,l$_,"localScale",function(){return this._localScale},function(l$i){this._localScale=l$i,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),l$h(0,l$_,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(l$w._tempVector30);var l$i=l$w._tempVector30.elements,l$_=this._localRotationEuler.elements;l$_[0]=l$i[1]*l$w._angleToRandin,l$_[1]=l$i[0]*l$w._angleToRandin,l$_[2]=l$i[2]*l$w._angleToRandin}return this._localRotationEuler},function(l$i){this._localRotationEuler=l$i,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),l$h(0,l$_,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?l$R_.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(l$i){null!=this._parent?(this._parent.rotation.invert(l$w._tempQuaternion0),l$R_.multiply(l$i,l$w._tempQuaternion0,this._localRotation)):l$i.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=l$i,this._rotationUpdate=!1}),l$h(0,l$_,"scale",function(){return this._scaleUpdate&&(null!==this._parent?l$L_.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(l$i){if(null!==this._parent){var l$_=this._parent.scale.elements,l$R=l$w._tempVector30.elements;l$R[0]=1/l$_[0],l$R[1]=1/l$_[1],l$R[2]=1/l$_[2],l$L_.multiply(l$i,l$w._tempVector30,this._localScale)}else l$i.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=l$i,this._scaleUpdate=!1}),l$h(0,l$_,"rotationEuler",null,function(l$i){l$R_.createFromYawPitchRoll(l$i.y,l$i.x,l$i.z,this._rotation),this.rotation=this._rotation}),l$h(0,l$_,"forward",function(){var l$i=this.worldMatrix.elements;return this._forward.elements[0]=-l$i[8],this._forward.elements[1]=-l$i[9],this._forward.elements[2]=-l$i[10],this._forward}),l$h(0,l$_,"up",function(){var l$i=this.worldMatrix.elements;return this._up.elements[0]=l$i[4],this._up.elements[1]=l$i[5],this._up.elements[2]=l$i[6],this._up}),l$h(0,l$_,"right",function(){var l$i=this.worldMatrix.elements;return this._right.elements[0]=l$i[0],this._right.elements[1]=l$i[1],this._right.elements[2]=l$i[2],this._right}),l$h(0,l$_,"parent",function(){return this._parent},function(l$i){if(this._parent!==l$i){if(this._parent){var l$_=this._parent._childs,l$R=l$_.indexOf(this);l$_.splice(l$R,1)}l$i&&(l$i._childs.push(this),l$i&&this._onWorldTransform()),this._parent=l$i}}),l$n(l$w,["_tempVector30",function(){return this._tempVector30=new l$L_},"_tempVector31",function(){return this._tempVector31=new l$L_},"_tempVector32",function(){return this._tempVector32=new l$L_},"_tempVector33",function(){return this._tempVector33=new l$L_},"_tempQuaternion0",function(){return this._tempQuaternion0=new l$R_},"_tempMatrix0",function(){return this._tempMatrix0=new l$i_},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),l$w}(),l$A_=(function(l$i){function l$_(){this._rotation=0,this._matNeedUpdte=!1,l$_.__super.call(this),this._matrix=new l$i_,this._offset=new l$z_,this._tiling=new l$z_(1,1)}l$J(l$_,"laya.d3.core.TransformUV",l$z);var l$R=l$_.prototype;l$c.imps(l$R,{"laya.d3.core.IClone":!0}),l$R._updateMatrix=function(){l$_._tempOffsetV3.elements[0]=this._offset.x,l$_._tempOffsetV3.elements[1]=this._offset.y,l$R_.createFromYawPitchRoll(0,0,this._rotation,l$_._tempRotationQua),l$_._tempTitlingV3.elements[0]=this._tiling.x,l$_._tempTitlingV3.elements[1]=this._tiling.y,l$i_.createAffineTransformation(l$_._tempOffsetV3,l$_._tempRotationQua,l$_._tempTitlingV3,this._matrix)},l$R.cloneTo=function(l$i){l$i._matrix=this._matrix.clone(),l$i._offset=this._offset.clone(),l$i._rotation=this._rotation,l$i._tiling=this._tiling.clone()},l$R.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$R,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),l$h(0,l$R,"tiling",function(){return this._tiling},function(l$i){this._tiling=l$i,this._matNeedUpdte=!0}),l$h(0,l$R,"offset",function(){return this._offset},function(l$i){this._offset=l$i,this._matNeedUpdte=!0}),l$h(0,l$R,"rotation",function(){return this._rotation},function(l$i){this._rotation=l$i,this._matNeedUpdte=!0}),l$n(l$_,["_tempOffsetV3",function(){return this._tempOffsetV3=new l$L_(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new l$R_},"_tempTitlingV3",function(){return this._tempTitlingV3=new l$L_(1,1,1)}])}(),function(l$R){function l$i(){this.x=NaN,this.y=NaN,this.z=NaN,l$i.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}l$J(l$i,"laya.d3.core.particleShuriKen.module.shape.BoxShape",l$R);var l$_=l$i.prototype;l$_._getShapeBoundBox=function(l$i){var l$_=l$i.min.elements;l$_[0]=.5*-this.x,l$_[1]=.5*-this.y,l$_[2]=.5*-this.z;var l$R=l$i.max.elements;l$R[0]=.5*this.x,l$R[1]=.5*this.y,l$R[2]=.5*this.z},l$_._getSpeedBoundBox=function(l$i){var l$_=l$i.min.elements;l$_[0]=0,l$_[1]=0,l$_[2]=0;var l$R=l$i.max.elements;l$R[0]=0,l$R[1]=1,l$R[2]=0},l$_.generatePositionAndDirection=function(l$i,l$_,l$R,l$r){var l$b=l$i.elements,l$z=l$_.elements;l$R?(l$R.seed=l$r[16],l$U._randomPointInsideHalfUnitBox(l$i,l$R),l$r[16]=l$R.seed):l$U._randomPointInsideHalfUnitBox(l$i),l$b[0]=this.x*l$b[0],l$b[1]=this.y*l$b[1],l$b[2]=this.z*l$b[2],this.randomDirection?l$R?(l$R.seed=l$r[17],l$U._randomPointUnitSphere(l$_,l$R),l$r[17]=l$R.seed):l$U._randomPointUnitSphere(l$_):(l$z[0]=0,l$z[1]=0,l$z[2]=1)},l$_.cloneTo=function(l$i){l$R.prototype.cloneTo.call(this,l$i);var l$_=l$i;l$_.x=this.x,l$_.y=this.y,l$_.z=this.z,l$_.randomDirection=this.randomDirection}}(l$s),function(l$R){function l$L(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,l$L.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}l$J(l$L,"laya.d3.core.particleShuriKen.module.shape.CircleShape",l$R);var l$i=l$L.prototype;l$i._getShapeBoundBox=function(l$i){var l$_=l$i.min.elements;l$_[0]=l$_[2]=-this.radius,l$_[1]=0;var l$R=l$i.max.elements;l$R[0]=l$R[2]=this.radius,l$R[1]=0},l$i._getSpeedBoundBox=function(l$i){var l$_=l$i.min.elements;l$_[0]=l$_[1]=-1,l$_[2]=0;var l$R=l$i.max.elements;l$R[0]=l$R[1]=1,l$R[2]=0},l$i.generatePositionAndDirection=function(l$i,l$_,l$R,l$r){var l$b=l$i.elements,l$z=l$L._tempPositionPoint.elements;l$R?(l$R.seed=l$r[16],this.emitFromEdge?l$U._randomPointUnitArcCircle(this.arc,l$L._tempPositionPoint,l$R):l$U._randomPointInsideUnitArcCircle(this.arc,l$L._tempPositionPoint,l$R),l$r[16]=l$R.seed):this.emitFromEdge?l$U._randomPointUnitArcCircle(this.arc,l$L._tempPositionPoint):l$U._randomPointInsideUnitArcCircle(this.arc,l$L._tempPositionPoint),l$b[0]=-l$z[0],l$b[1]=l$z[1],l$b[2]=0,l$L_.scale(l$i,this.radius,l$i),this.randomDirection?l$R?(l$R.seed=l$r[17],l$U._randomPointUnitSphere(l$_,l$R),l$r[17]=l$R.seed):l$U._randomPointUnitSphere(l$_):l$i.cloneTo(l$_)},l$i.cloneTo=function(l$i){l$R.prototype.cloneTo.call(this,l$i);var l$_=l$i;l$_.radius=this.radius,l$_.arc=this.arc,l$_.emitFromEdge=this.emitFromEdge,l$_.randomDirection=this.randomDirection},l$n(l$L,["_tempPositionPoint",function(){return this._tempPositionPoint=new l$z_}])}(l$s),function(l$R){function l$f(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,l$f.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}l$J(l$f,"laya.d3.core.particleShuriKen.module.shape.ConeShape",l$R);var l$i=l$f.prototype;l$i._getShapeBoundBox=function(l$i){var l$_=this.radius+this.length*Math.sin(this.angle),l$R=this.length*Math.cos(this.angle),l$r=l$i.min.elements;l$r[0]=l$r[1]=-l$_,l$r[2]=0;var l$b=l$i.max.elements;l$b[0]=l$b[1]=l$_,l$b[2]=l$R},l$i._getSpeedBoundBox=function(l$i){var l$_=Math.sin(this.angle),l$R=l$i.min.elements;l$R[0]=l$R[1]=-l$_,l$R[2]=0;var l$r=l$i.max.elements;l$r[0]=l$R[1]=l$_,l$r[2]=1},l$i.generatePositionAndDirection=function(l$i,l$_,l$R,l$r){var l$b,l$z=l$i.elements,l$L=l$_.elements,l$w=l$f._tempPositionPoint.elements,l$x=NaN,l$P=NaN,l$B=Math.cos(this.angle),l$n=Math.sin(this.angle);switch(this.emitType){case 0:l$R?(l$R.seed=l$r[16],l$U._randomPointInsideUnitCircle(l$f._tempPositionPoint,l$R),l$r[16]=l$R.seed):l$U._randomPointInsideUnitCircle(l$f._tempPositionPoint),l$x=l$w[0],l$P=l$w[1],l$z[0]=l$x*this.radius,l$z[1]=l$P*this.radius,l$z[2]=0,this.randomDirection?(l$R?(l$R.seed=l$r[17],l$U._randomPointInsideUnitCircle(l$f._tempDirectionPoint,l$R),l$r[17]=l$R.seed):l$U._randomPointInsideUnitCircle(l$f._tempDirectionPoint),l$b=l$f._tempDirectionPoint.elements,l$L[0]=l$b[0]*l$n,l$L[1]=l$b[1]*l$n):(l$L[0]=l$x*l$n,l$L[1]=l$P*l$n),l$L[2]=l$B;break;case 1:l$R?(l$R.seed=l$r[16],l$U._randomPointUnitCircle(l$f._tempPositionPoint,l$R),l$r[16]=l$R.seed):l$U._randomPointUnitCircle(l$f._tempPositionPoint),l$x=l$w[0],l$P=l$w[1],l$z[0]=l$x*this.radius,l$z[1]=l$P*this.radius,l$z[2]=0,this.randomDirection?(l$R?(l$R.seed=l$r[17],l$U._randomPointInsideUnitCircle(l$f._tempDirectionPoint,l$R),l$r[17]=l$R.seed):l$U._randomPointInsideUnitCircle(l$f._tempDirectionPoint),l$b=l$f._tempDirectionPoint.elements,l$L[0]=l$b[0]*l$n,l$L[1]=l$b[1]*l$n):(l$L[0]=l$x*l$n,l$L[1]=l$P*l$n),l$L[2]=l$B;break;case 2:l$R?(l$R.seed=l$r[16],l$U._randomPointInsideUnitCircle(l$f._tempPositionPoint,l$R)):l$U._randomPointInsideUnitCircle(l$f._tempPositionPoint),l$x=l$w[0],l$P=l$w[1],l$z[0]=l$x*this.radius,l$z[1]=l$P*this.radius,l$L[l$z[2]=0]=l$x*l$n,l$L[1]=l$P*l$n,l$L[2]=l$B,l$L_.normalize(l$_,l$_),l$R?(l$L_.scale(l$_,this.length*l$R.getFloat(),l$_),l$r[16]=l$R.seed):l$L_.scale(l$_,this.length*Math.random(),l$_),l$L_.add(l$i,l$_,l$i),this.randomDirection&&(l$R?(l$R.seed=l$r[17],l$U._randomPointUnitSphere(l$_,l$R),l$r[17]=l$R.seed):l$U._randomPointUnitSphere(l$_));break;case 3:l$R?(l$R.seed=l$r[16],l$U._randomPointUnitCircle(l$f._tempPositionPoint,l$R)):l$U._randomPointUnitCircle(l$f._tempPositionPoint),l$x=l$w[0],l$P=l$w[1],l$z[0]=l$x*this.radius,l$z[1]=l$P*this.radius,l$L[l$z[2]=0]=l$x*l$n,l$L[1]=l$P*l$n,l$L[2]=l$B,l$L_.normalize(l$_,l$_),l$R?(l$L_.scale(l$_,this.length*l$R.getFloat(),l$_),l$r[16]=l$R.seed):l$L_.scale(l$_,this.length*Math.random(),l$_),l$L_.add(l$i,l$_,l$i),this.randomDirection&&(l$R?(l$R.seed=l$r[17],l$U._randomPointUnitSphere(l$_,l$R),l$r[17]=l$R.seed):l$U._randomPointUnitSphere(l$_));break;default:throw new Error("ConeShape:emitType is invalid.")}},l$i.cloneTo=function(l$i){l$R.prototype.cloneTo.call(this,l$i);var l$_=l$i;l$_.angle=this.angle,l$_.radius=this.radius,l$_.length=this.length,l$_.emitType=this.emitType,l$_.randomDirection=this.randomDirection},l$n(l$f,["_tempPositionPoint",function(){return this._tempPositionPoint=new l$z_},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new l$z_}])}(l$s),function(l$R){function l$i(){this.radius=NaN,this.emitFromShell=!1,l$i.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}l$J(l$i,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",l$R);var l$_=l$i.prototype;l$_._getShapeBoundBox=function(l$i){var l$_=l$i.min.elements;l$_[0]=l$_[1]=l$_[2]=-this.radius;var l$R=l$i.max.elements;l$R[0]=l$R[1]=this.radius,l$R[2]=0},l$_._getSpeedBoundBox=function(l$i){var l$_=l$i.min.elements;l$_[0]=l$_[1]=-1,l$_[2]=0;var l$R=l$i.max.elements;l$R[0]=l$R[1]=l$R[2]=1},l$_.generatePositionAndDirection=function(l$i,l$_,l$R,l$r){var l$b=l$i.elements;l$R?(l$R.seed=l$r[16],this.emitFromShell?l$U._randomPointUnitSphere(l$i,l$R):l$U._randomPointInsideUnitSphere(l$i,l$R),l$r[16]=l$R.seed):this.emitFromShell?l$U._randomPointUnitSphere(l$i):l$U._randomPointInsideUnitSphere(l$i),l$L_.scale(l$i,this.radius,l$i);var l$z=l$b[2];l$z<0&&(l$b[2]=-1*l$z),this.randomDirection?l$R?(l$R.seed=l$r[17],l$U._randomPointUnitSphere(l$_,l$R),l$r[17]=l$R.seed):l$U._randomPointUnitSphere(l$_):l$i.cloneTo(l$_)},l$_.cloneTo=function(l$i){l$R.prototype.cloneTo.call(this,l$i);var l$_=l$i;l$_.radius=this.radius,l$_.emitFromShell=this.emitFromShell,l$_.randomDirection=this.randomDirection}}(l$s),function(l$R){function l$i(){this.radius=NaN,this.emitFromShell=!1,l$i.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}l$J(l$i,"laya.d3.core.particleShuriKen.module.shape.SphereShape",l$R);var l$_=l$i.prototype;l$_._getShapeBoundBox=function(l$i){var l$_=l$i.min.elements;l$_[0]=l$_[1]=l$_[2]=-this.radius;var l$R=l$i.max.elements;l$R[0]=l$R[1]=l$R[2]=this.radius},l$_._getSpeedBoundBox=function(l$i){var l$_=l$i.min.elements;l$_[0]=l$_[1]=l$_[2]=-1;var l$R=l$i.max.elements;l$R[0]=l$R[1]=l$R[2]=1},l$_.generatePositionAndDirection=function(l$i,l$_,l$R,l$r){l$R?(l$R.seed=l$r[16],this.emitFromShell?l$U._randomPointUnitSphere(l$i,l$R):l$U._randomPointInsideUnitSphere(l$i,l$R),l$r[16]=l$R.seed):this.emitFromShell?l$U._randomPointUnitSphere(l$i):l$U._randomPointInsideUnitSphere(l$i),l$L_.scale(l$i,this.radius,l$i),this.randomDirection?l$R?(l$R.seed=l$r[17],l$U._randomPointUnitSphere(l$_,l$R),l$r[17]=l$R.seed):l$U._randomPointUnitSphere(l$_):l$i.cloneTo(l$_)},l$_.cloneTo=function(l$i){l$R.prototype.cloneTo.call(this,l$i);var l$_=l$i;l$_.radius=this.radius,l$_.emitFromShell=this.emitFromShell,l$_.randomDirection=this.randomDirection}}(l$s),function(l$i){function l$_(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,l$_.__super.call(this)}return l$J(l$_,"laya.d3.core.render.SubMeshRenderElement",l$y),l$_}()),l$Z_=function(l$i){function l$N(l$i,l$_,l$R,l$r,l$b,l$z){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=l$i,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[l$J_.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[l$V_.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[l$V_.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[l$v_.SHADERDEFINE_ALPHATEST]="ALPHATEST";l$N.__super.call(this,l$i,l$_,l$R,null,{}),this._attributeMap=l$r;var l$L;for(l$L in l$b){var l$w=l$b[l$L];switch(l$w[1]){case 0:this._renderElementUniformMap[l$L]=l$w[0];break;case 1:this._materialUniformMap[l$L]=l$w[0];break;case 2:this._spriteUniformMap[l$L]=l$w[0];break;case 3:this._cameraUniformMap[l$L]=l$w[0];break;case 4:this._sceneUniformMap[l$L]=l$w[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}l$J(l$N,"laya.d3.shader.ShaderCompile3D",l$I);var l$_=l$N.prototype;return l$_._definesToNameDic=function(l$i,l$_){for(var l$R={},l$r=1,l$b=0;l$b<32&&!(l$i<(l$r=1<<l$b));l$b++)if(l$i&l$r){var l$z=l$_[l$r];l$z&&(l$R[l$z]="")}return l$R},l$_.withCompile=function(l$i,l$_,l$R,l$r){var l$b,l$z,l$L;if(l$z=this.sharders[l$i])if(l$L=l$z[l$_]){if(l$b=l$L[l$R])return l$b}else l$L=l$z[l$_]=[];else l$L=(l$z=this.sharders[l$i]=[])[l$_]=[];var l$w,l$x=this._definesToNameDic(l$i,l$N._globalInt2name),l$P=this._definesToNameDic(l$_,this._spriteInt2name),l$B=this._definesToNameDic(l$R,this._materialInt2name),l$n={},l$f="";if(l$x)for(l$w in l$x)l$f+="#define "+l$w+"\n",l$n[l$w]=!0;if(l$P)for(l$w in l$P)l$f+="#define "+l$w+"\n",l$n[l$w]=!0;if(l$B)for(l$w in l$B)l$f+="#define "+l$w+"\n",l$n[l$w]=!0;var l$J=l$K_.nameKey.getName(this._name)+" compile ("+l$i+","+l$_+","+l$R+")",l$h=this._VS.toscript(l$n,[]),l$M=this._PS.toscript(l$n,[]);l$u.now();if(l$b=l$K_.create(l$f+l$h.join("\n"),l$f+l$M.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,l$r,l$J),l$L[l$R]=l$b,laya.d3.shader.ShaderCompile3D.debugMode)l$u.now();return l$b},l$_.precompileShaderWithShaderDefine=function(l$i,l$_,l$R){this.withCompile(l$i,l$_,l$R,!0)},l$_.addMaterialDefines=function(l$i){var l$_=l$i.defines;for(var l$R in l$_){var l$r=l$_[l$R],l$b=parseInt(l$R);this._materialInt2name[l$b]=l$r,this._materialName2Int[l$r]=l$b}},l$_.addSpriteDefines=function(l$i){var l$_=l$i.defines;for(var l$R in l$_){var l$r=l$_[l$R],l$b=parseInt(l$R);this._spriteInt2name[l$b]=l$r,this._spriteName2Int[l$r]=l$b}},l$_.getMaterialDefineByName=function(l$i){return this._materialName2Int[l$i]},l$_.registerMaterialDefine=function(l$i){var l$_=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[l$_]=l$i,this._materialName2Int[l$i]=l$_},l$_.registerSpriteDefine=function(l$i){var l$_=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[l$_]=l$i,this._spriteName2Int[l$i]=l$_},l$N._globalRegDefine=function(l$i,l$_){l$N._globalInt2name[l$_]=l$i},l$N.add=function(l$i,l$_,l$R,l$r,l$b){return laya.d3.shader.ShaderCompile3D._preCompileShader[l$i]=new l$N(l$i,l$_,l$R,l$r,l$b,l$I.includes)},l$N.get=function(l$i){return laya.d3.shader.ShaderCompile3D._preCompileShader[l$K_.nameKey.getID(l$i)]},l$N._preCompileShader={},l$N._globalInt2name=[],l$N.debugMode=!1,l$N.SHADERDEFINE_HIGHPRECISION=1,l$N.SHADERDEFINE_FOG=4,l$N.SHADERDEFINE_DIRECTIONLIGHT=8,l$N.SHADERDEFINE_POINTLIGHT=16,l$N.SHADERDEFINE_SPOTLIGHT=32,l$N.SHADERDEFINE_UV0=64,l$N.SHADERDEFINE_COLOR=128,l$N.SHADERDEFINE_UV1=256,l$N.SAHDERDEFINE_DEPTHFOG=131072,l$N}(),l$q_=function(l$i){function l$h(){l$h.__super.call(this)}l$J(l$h,"laya.d3.graphics.MeshSprite3DStaticBatchManager",l$ri);var l$_=l$h.prototype;return l$_._getStaticBatch=function(l$i,l$_,l$R,l$r){var l$b,l$z;return l$z=l$i?l$i.id.toString()+l$R.id.toString()+l$_.id.toString()+l$r.toString():l$R.id.toString()+l$_.id.toString()+l$r.toString(),this._staticBatches[l$z]?l$b=this._staticBatches[l$z]:this._staticBatches[l$z]=l$b=new l$j_(l$z,this,l$i,l$_,l$R),l$b},l$_._initStaticBatchs=function(l$i){var l$_,l$R;this._initBatchRenderElements.sort(l$h._sortPrepareStaticBatch);for(var l$r,l$b=!1,l$z=0,l$L=0,l$w=this._initBatchRenderElements.length;l$L<l$w;l$L++){var l$x,l$P=this._initBatchRenderElements[l$L],l$B=l$P.renderObj._getVertexBuffer(0);l$P._sprite3D;if(l$R===l$B.vertexDeclaration&&l$_===l$P._material)if(l$b)l$r._addCombineBatchRenderObjTest(l$P)?(l$x=l$P._staticBatch)!==l$r&&(l$x&&l$x._deleteCombineBatchRenderObj(l$P),l$r._addCombineBatchRenderObj(l$P)):(l$b=!1,l$z++);else{var l$n=this._initBatchRenderElements[l$L-1],l$f=l$n.renderObj,l$J=l$P.renderObj;l$b=!(65535<l$f._getVertexBuffer().vertexCount+l$J._getVertexBuffer().vertexCount)&&(l$r=this._getStaticBatch(l$i,l$R,l$_,l$z),(l$x=l$n._staticBatch)!==l$r&&(l$x&&l$x._deleteCombineBatchRenderObj(l$n),l$r._addCombineBatchRenderObj(l$n)),(l$x=l$P._staticBatch)!==l$r&&(l$x&&l$x._deleteCombineBatchRenderObj(l$P),l$r._addCombineBatchRenderObj(l$P)),!0)}else l$b=!1,l$z=0;l$_=l$P._material,l$R=l$B.vertexDeclaration}},l$h._sortPrepareStaticBatch=function(l$i,l$_){var l$R=l$i._render,l$r=l$_._render,l$b=l$R.lightmapIndex-l$r.lightmapIndex;if(0!=l$b)return l$b;var l$z=l$R.receiveShadow-l$r.receiveShadow;if(0!=l$z)return l$z;var l$L=l$i._mainSortID-l$_._mainSortID;return 0==l$L?l$i.renderObj.triangleCount-l$_.renderObj.triangleCount:l$L},l$h}(),l$j_=function(l$i){function l$z(l$i,l$_,l$R,l$r,l$b){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,l$z.__super.call(this,l$i,l$_,l$R),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=l$r,this._material=l$b}l$J(l$z,"laya.d3.graphics.SubMeshStaticBatch",l$bi);var l$_=l$z.prototype;return l$_._compareBatchRenderElement=function(l$i,l$_){return l$i._batchIndexStart>l$_._batchIndexStart},l$_._addCombineBatchRenderObjTest=function(l$i){var l$_=l$i.renderObj._vertexCount;return!(65535<(0<l$_?this._currentCombineVertexCount+l$_:this._currentCombineVertexCount+l$i.renderObj._getVertexBuffer().vertexCount))},l$_._addCombineBatchRenderObj=function(l$i){var l$_=l$i.renderObj,l$R=l$_._vertexCount;this._initBatchRenderElements.push(l$i),l$i._staticBatch=this,0<l$R?(this._currentCombineIndexCount+=l$_._indexCount,this._currentCombineVertexCount+=l$R):(this._currentCombineIndexCount=this._currentCombineIndexCount+l$_._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+l$_._getVertexBuffer().vertexCount),this._needFinishCombine=!0},l$_._deleteCombineBatchRenderObj=function(l$i){var l$_=l$i.renderObj,l$R=this._initBatchRenderElements.indexOf(l$i);if(-1!==l$R){this._initBatchRenderElements.splice(l$R,1),l$i._staticBatch=null;var l$r=l$_._vertexCount;0<l$r?(this._currentCombineIndexCount=this._currentCombineIndexCount-l$_._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-l$r):(this._currentCombineIndexCount=this._currentCombineIndexCount-l$_._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-l$_._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},l$_._finishInit=function(){if(this._needFinishCombine){var l$i=0,l$_=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var l$R=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),l$r=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=l$s_.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=l$E_.create("ushort",this._currentCombineIndexCount,35044);for(var l$b=0,l$z=this._initBatchRenderElements.length;l$b<l$z;l$b++){var l$L=this._initBatchRenderElements[l$b],l$w=l$L.renderObj,l$x=l$w._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,l$L._sprite3D),l$P=l$w.getIndices(),l$B=l$L._sprite3D.transform._isFrontFaceInvert,l$n=l$i/(this._vertexDeclaration.vertexStride/4)-l$w._vertexStart,l$f=l$_,l$J=l$f+l$P.length;l$L._batchIndexStart=l$f,l$L._batchIndexEnd=l$J,l$r.set(l$P,l$_);var l$h=0;if(l$B)for(l$h=l$f;l$h<l$J;l$h+=3){l$r[l$h]=l$n+l$r[l$h];var l$M=l$r[l$h+1],l$N=l$r[l$h+2];l$r[l$h+1]=l$n+l$N,l$r[l$h+2]=l$n+l$M}else for(l$h=l$f;l$h<l$J;l$h+=3)l$r[l$h]=l$n+l$r[l$h],l$r[l$h+1]=l$n+l$r[l$h+1],l$r[l$h+2]=l$n+l$r[l$h+2];l$_+=l$P.length,l$R.set(l$x,l$i),l$i+=l$x.length}this._vertexBuffer.setData(l$R),this._indexBuffer.setData(l$r),this._needFinishCombine=!1}},l$_._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new l$A_)},l$_._getRenderElement=function(l$i,l$_,l$R){for(var l$r,l$b,l$z=this._batchRenderElements.length,l$L=!0,l$w=0;l$w<l$z;l$w++){var l$x,l$P,l$B=(l$b=this._batchRenderElements[l$w])._sprite3D._render;if(0!==l$w&&(l$L=(l$x=(l$r=this._batchRenderElements[l$w-1])._sprite3D._render).lightmapIndex!==l$B.lightmapIndex||l$x.receiveShadow!==l$B.receiveShadow||l$r._batchIndexEnd!==l$b._batchIndexStart),l$L){(l$P=this._getCombineRenderElementFromPool()).renderObj=this,l$P._material=this._material,l$P._batchIndexStart=l$b._batchIndexStart,l$P._batchIndexEnd=l$b._batchIndexEnd;var l$n=l$B.lightmapIndex,l$f=l$n+1,l$J=this._batchOwnerIndices[l$f];l$J||(l$J=this._batchOwnerIndices[l$f]=[]);var l$h,l$M=l$J[l$b._render.receiveShadow?1:0];void 0===l$M?(l$J[l$B.receiveShadow?1:0]=this._batchOwners.length,(l$h=new l$a_(null,"StaticBatchMeshSprite3D"))._scene=l$_,l$h._transform=this._rootOwner?this._rootOwner._transform:null,l$h._render.lightmapIndex=l$n,l$h._render.receiveShadow=l$b._render.receiveShadow,this._batchOwners.push(l$h)):l$h=this._batchOwners[l$M],l$h._render._renderUpdate(l$R),l$P._sprite3D=l$h,l$i.push(l$P)}else l$P._batchIndexEnd=l$b._batchIndexEnd}},l$_._beforeRender=function(l$i){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},l$_._render=function(l$i){var l$_=l$i.renderElement,l$R=l$_._batchIndexStart,l$r=l$_._batchIndexEnd-l$R;l$$.mainContext.drawElements(4,l$r,5123,2*l$R),l$Z.drawCall++,l$Z.trianglesFaces+=l$r/3},l$_.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},l$_._getVertexBuffer=function(l$i){return void 0===l$i&&(l$i=0),this._vertexBuffer},l$z}(),l$S_=function(l$i){function l$_(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,l$_.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}l$J(l$_,"laya.d3.core.ComponentNode",l$P);var l$R=l$_.prototype;return l$R.addComponent=function(l$i){var l$_,l$R=this._componentsMap.indexOf(l$i);if(-1===l$R)l$_=[],this._componentsMap.push(l$i),this._typeComponentsIndices.push(l$_);else if(l$_=this._typeComponentsIndices[l$R],this._components[l$_[0]].isSingleton)throw new Error("无法单实例创建"+l$i+"组件，"+l$i+"组件已存在！");var l$r=l$b.getInstance(l$i);return l$_.push(this._components.length),this._components.push(l$r),l$r instanceof laya.d3.component.Script&&this._scripts.push(l$r),l$r._initialize(this),l$r},l$R._removeComponent=function(l$i,l$_){var l$R=this._typeComponentsIndices[l$i],l$r=l$R[l$_],l$b=this._components[l$r];this._components.splice(l$r,1),l$b instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(l$b),1),l$R.splice(l$_,1),0===l$R.length&&(this._typeComponentsIndices.splice(l$i,1),this._componentsMap.splice(l$i,1));for(var l$z=0,l$L=this._componentsMap.length;l$z<l$L;l$z++)for(var l$w=(l$R=this._typeComponentsIndices[l$z]).length-1;0<=l$w;l$w--){var l$x=l$R[l$w];if(!(l$r<l$x))break;l$R[l$w]=--l$x}l$b._destroy()},l$R.getComponentByType=function(l$i,l$_){void 0===l$_&&(l$_=0);var l$R=this._componentsMap.indexOf(l$i);return-1===l$R?null:this._components[this._typeComponentsIndices[l$R][l$_]]},l$R.getComponentsByType=function(l$i,l$_){var l$R=this._componentsMap.indexOf(l$i);if(-1!==l$R){var l$r=this._typeComponentsIndices[l$R],l$b=l$r.length;l$_.length=l$b;for(var l$z=0;l$z<l$b;l$z++)l$_[l$z]=this._components[l$r[l$z]]}else l$_.length=0},l$R.getComponentByIndex=function(l$i){return this._components[l$i]},l$R.removeComponentByType=function(l$i,l$_){void 0===l$_&&(l$_=0);var l$R=this._componentsMap.indexOf(l$i);-1!==l$R&&this._removeComponent(l$R,l$_)},l$R.removeComponentsByType=function(l$i){var l$_=this._componentsMap.indexOf(l$i);if(-1!==l$_)for(var l$R=this._typeComponentsIndices[l$_],l$r=0,l$b=l$R.length;l$r<l$b;l$R.length<l$b?l$b--:l$r++)this._removeComponent(l$_,l$r)},l$R.removeAllComponent=function(){for(var l$i=0,l$_=this._componentsMap.length;l$i<l$_;this._componentsMap.length<l$_?l$_--:l$i++)this.removeComponentsByType(this._componentsMap[l$i])},l$R._updateComponents=function(l$i){for(var l$_=0,l$R=this._components.length;l$_<l$R;l$_++){var l$r=this._components[l$_];!l$r.started&&(l$r._start(l$i),l$r.started=!0),l$r.enable&&l$r._update(l$i)}},l$R._lateUpdateComponents=function(l$i){for(var l$_=0;l$_<this._components.length;l$_++){var l$R=this._components[l$_];!l$R.started&&(l$R._start(l$i),l$R.started=!0),l$R.enable&&l$R._lateUpdate(l$i)}},l$R._preRenderUpdateComponents=function(l$i){for(var l$_=0;l$_<this._components.length;l$_++){var l$R=this._components[l$_];!l$R.started&&(l$R._start(l$i),l$R.started=!0),l$R.enable&&l$R._preRenderUpdate(l$i)}},l$R._postRenderUpdateComponents=function(l$i){for(var l$_=0;l$_<this._components.length;l$_++){var l$R=this._components[l$_];!l$R.started&&(l$R._start(l$i),l$R.started=!0),l$R.enable&&l$R._postRenderUpdate(l$i)}},l$_}(),l$v_=function(l$r){function l$i(){l$i.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new l$f_,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new l$w_(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}l$J(l$i,"laya.d3.core.material.BaseMaterial",l$r);var l$_=l$i.prototype;return l$c.imps(l$_,{"laya.d3.core.IClone":!0}),l$_._addShaderDefine=function(l$i){this._shaderDefineValue|=l$i},l$_._removeShaderDefine=function(l$i){this._shaderDefineValue&=~l$i},l$_._addDisablePublicShaderDefine=function(l$i){this._disablePublicShaderDefine|=l$i},l$_._removeDisablePublicShaderDefine=function(l$i){this._disablePublicShaderDefine&=~l$i},l$_._setBuffer=function(l$i,l$_){this._shaderValues.setValue(l$i,l$_),this._values[l$i]=l$_},l$_._getBuffer=function(l$i){return this._values[l$i]},l$_._setMatrix4x4=function(l$i,l$_){this._shaderValues.setValue(l$i,l$_?l$_.elements:null),this._values[l$i]=l$_},l$_._getMatrix4x4=function(l$i){return this._values[l$i]},l$_._setInt=function(l$i,l$_){this._shaderValues.setValue(l$i,l$_),this._values[l$i]=l$_},l$_._getInt=function(l$i){return this._values[l$i]},l$_._setNumber=function(l$i,l$_){this._shaderValues.setValue(l$i,l$_),this._values[l$i]=l$_},l$_._getNumber=function(l$i){return this._values[l$i]},l$_._setBool=function(l$i,l$_){this._shaderValues.setValue(l$i,l$_),this._values[l$i]=l$_},l$_._getBool=function(l$i){return this._values[l$i]},l$_._setVector2=function(l$i,l$_){this._shaderValues.setValue(l$i,l$_?l$_.elements:null),this._values[l$i]=l$_},l$_._getVector2=function(l$i){return this._values[l$i]},l$_._setColor=function(l$i,l$_){this._shaderValues.setValue(l$i,l$_?l$_.elements:null),this._values[l$i]=l$_},l$_._getColor=function(l$i){return this._values[l$i]},l$_._setTexture=function(l$i,l$_){var l$R=this._values[l$i];this._values[l$i]=l$_,this._shaderValues.setValue(l$i,l$_),0<this.referenceCount&&(l$R&&l$R._removeReference(),l$_&&l$_._addReference())},l$_._getTexture=function(l$i){return this._values[l$i]},l$_._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},l$_._getShader=function(l$i,l$_,l$R){var l$r=(l$i|l$_)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(l$r,l$R,this._shaderDefineValue),this._shader},l$_._setRenderStateBlendDepth=function(){var l$i=l$$.mainContext;switch(l$G.setDepthMask(l$i,this.depthWrite),0===this.depthTest?l$G.setDepthTest(l$i,!1):(l$G.setDepthTest(l$i,!0),l$G.setDepthFunc(l$i,this.depthTest)),this.blend){case 0:l$G.setBlend(l$i,!1);break;case 1:l$G.setBlend(l$i,!0),l$G.setBlendFunc(l$i,this.srcBlend,this.dstBlend);break;case 2:l$G.setBlend(l$i,!0)}},l$_._setRenderStateFrontFace=function(l$i,l$_){var l$R=l$$.mainContext,l$r=0;switch(this.cull){case 0:l$G.setCullFace(l$R,!1);break;case 1:l$G.setCullFace(l$R,!0),l$r=l$i?l$_&&l$_._isFrontFaceInvert?2305:2304:l$_&&l$_._isFrontFaceInvert?2304:2305,l$G.setFrontFace(l$R,l$r);break;case 2:l$G.setCullFace(l$R,!0),l$r=l$i?l$_&&l$_._isFrontFaceInvert?2304:2305:l$_&&l$_._isFrontFaceInvert?2305:2304,l$G.setFrontFace(l$R,l$r)}},l$_.onAsynLoaded=function(l$i,l$_,l$R){var l$r=l$_[0],l$b=l$_[1];switch(l$r.version){case"LAYAMATERIAL:01":var l$z=0,l$L=0,l$w=l$r.props;for(var l$x in l$w)switch(l$x){case"vectors":var l$P=l$w[l$x];for(l$z=0,l$L=l$P.length;l$z<l$L;l$z++){var l$B=l$P[l$z],l$n=l$B.value;switch(l$n.length){case 2:this[l$B.name]=new l$z_(l$n[0],l$n[1]);break;case 3:this[l$B.name]=new l$L_(l$n[0],l$n[1],l$n[2]);break;case 4:this[l$B.name]=new l$w_(l$n[0],l$n[1],l$n[2],l$n[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var l$f=l$w[l$x];for(l$z=0,l$L=l$f.length;l$z<l$L;l$z++){var l$J=l$f[l$z],l$h=l$J.path;l$h&&(this[l$J.name]=l$X.getRes(l$b[l$h]))}break;case"defines":var l$M=l$w[l$x];for(l$z=0,l$L=l$M.length;l$z<l$L;l$z++){var l$N=this._shaderCompile.getMaterialDefineByName(l$M[l$z]);this._addShaderDefine(l$N)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[l$x]=l$w[l$x];break;case"renderQueue":switch(l$w[l$x]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[l$x]=l$w[l$x]}break;case"LAYAMATERIAL:02":for(l$x in l$w=l$r.props)switch(l$x){case"vectors":for(l$z=0,l$L=(l$P=l$w[l$x]).length;l$z<l$L;l$z++)switch((l$n=(l$B=l$P[l$z]).value).length){case 2:this[l$B.name]=new l$z_(l$n[0],l$n[1]);break;case 3:this[l$B.name]=new l$L_(l$n[0],l$n[1],l$n[2]);break;case 4:this[l$B.name]=new l$w_(l$n[0],l$n[1],l$n[2],l$n[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(l$z=0,l$L=(l$f=l$w[l$x]).length;l$z<l$L;l$z++)(l$h=(l$J=l$f[l$z]).path)&&(this[l$J.name]=l$X.getRes(l$b[l$h]));break;case"defines":for(l$z=0,l$L=(l$M=l$w[l$x]).length;l$z<l$L;l$z++)l$N=this._shaderCompile.getMaterialDefineByName(l$M[l$z]),this._addShaderDefine(l$N);break;default:this[l$x]=l$w[l$x]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},l$_._addReference=function(){l$r.prototype._addReference.call(this);for(var l$i=0,l$_=this._values.length;l$i<l$_;l$i++){var l$R=this._values[l$i];l$R&&l$R instanceof laya.d3.resource.BaseTexture&&l$R._addReference()}},l$_._removeReference=function(){l$r.prototype._removeReference.call(this);for(var l$i=0,l$_=this._values.length;l$i<l$_;l$i++){var l$R=this._values[l$i];l$R&&l$R instanceof laya.d3.resource.BaseTexture&&l$R._removeReference()}},l$_.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},l$_.setShaderName=function(l$i){var l$_=l$K_.nameKey.getID(l$i);if(-1===l$_)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=l$Z_._preCompileShader[l$_]},l$_.cloneTo=function(l$i){var l$_=l$i;l$_.name=this.name,l$_.cull=this.cull,l$_.blend=this.blend,l$_.srcBlend=this.srcBlend,l$_.dstBlend=this.dstBlend,l$_.srcBlendRGB=this.srcBlendRGB,l$_.dstBlendRGB=this.dstBlendRGB,l$_.srcBlendAlpha=this.srcBlendAlpha,l$_.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(l$_.blendConstColor),l$_.blendEquation=this.blendEquation,l$_.blendEquationRGB=this.blendEquationRGB,l$_.blendEquationAlpha=this.blendEquationAlpha,l$_.depthTest=this.depthTest,l$_.depthWrite=this.depthWrite,l$_.renderQueue=this.renderQueue,l$_._shader=this._shader,l$_._disablePublicShaderDefine=this._disablePublicShaderDefine,l$_._shaderDefineValue=this._shaderDefineValue;var l$R,l$r=0,l$b=l$_._shaderValues;l$_._shaderValues.data.length=this._shaderValues.data.length;var l$z=this._values.length,l$L=l$_._values;for(l$r=0,l$R=l$L.length=l$z;l$r<l$R;l$r++){var l$w=this._values[l$r];if(l$w)if("number"==typeof l$w)l$L[l$r]=l$w,l$b.data[l$r]=l$w;else if("number"==typeof l$w&&Math.floor(l$w)==l$w)l$L[l$r]=l$w,l$b.data[l$r]=l$w;else if("boolean"==typeof l$w)l$L[l$r]=l$w,l$b.data[l$r]=l$w;else if(l$w instanceof laya.d3.math.Vector2){var l$x=l$L[l$r]||(l$L[l$r]=new l$z_);l$w.cloneTo(l$x),l$b.data[l$r]=l$x.elements}else if(l$w instanceof laya.d3.math.Vector3){var l$P=l$L[l$r]||(l$L[l$r]=new l$L_);l$w.cloneTo(l$P),l$b.data[l$r]=l$P.elements}else if(l$w instanceof laya.d3.math.Vector4){var l$B=l$L[l$r]||(l$L[l$r]=new l$w_);l$w.cloneTo(l$B),l$b.data[l$r]=l$B.elements}else if(l$w instanceof laya.d3.math.Matrix4x4){var l$n=l$L[l$r]||(l$L[l$r]=new l$i_);l$w.cloneTo(l$n),l$b.data[l$r]=l$n.elements}else l$w instanceof laya.d3.resource.BaseTexture&&(l$L[l$r]=l$w,l$b.data[l$r]=l$w)}},l$_.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$h(0,l$_,"alphaTestValue",function(){return this._getNumber(0)},function(l$i){this._setNumber(0,l$i)}),l$h(0,l$_,"alphaTest",function(){return this._alphaTest},function(l$i){(this._alphaTest=l$i)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),l$i.__init__=function(){l$i.SHADERDEFINE_ALPHATEST=l$i.shaderDefines.registerDefine("ALPHATEST")},l$i.RENDERQUEUE_OPAQUE=2e3,l$i.RENDERQUEUE_ALPHATEST=2450,l$i.RENDERQUEUE_TRANSPARENT=3e3,l$i.CULL_NONE=0,l$i.CULL_FRONT=1,l$i.CULL_BACK=2,l$i.BLEND_DISABLE=0,l$i.BLEND_ENABLE_ALL=1,l$i.BLEND_ENABLE_SEPERATE=2,l$i.BLENDPARAM_ZERO=0,l$i.BLENDPARAM_ONE=1,l$i.BLENDPARAM_SRC_COLOR=768,l$i.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,l$i.BLENDPARAM_DST_COLOR=774,l$i.BLENDPARAM_ONE_MINUS_DST_COLOR=775,l$i.BLENDPARAM_SRC_ALPHA=770,l$i.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,l$i.BLENDPARAM_DST_ALPHA=772,l$i.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,l$i.BLENDPARAM_SRC_ALPHA_SATURATE=776,l$i.BLENDEQUATION_ADD=0,l$i.BLENDEQUATION_SUBTRACT=1,l$i.BLENDEQUATION_REVERSE_SUBTRACT=2,l$i.DEPTHTEST_OFF=0,l$i.DEPTHTEST_NEVER=512,l$i.DEPTHTEST_LESS=513,l$i.DEPTHTEST_EQUAL=514,l$i.DEPTHTEST_LEQUAL=515,l$i.DEPTHTEST_GREATER=516,l$i.DEPTHTEST_NOTEQUAL=517,l$i.DEPTHTEST_GEQUAL=518,l$i.DEPTHTEST_ALWAYS=519,l$i.SHADERDEFINE_ALPHATEST=1,l$i.ALPHATESTVALUE=0,l$n(l$i,["shaderDefines",function(){return this.shaderDefines=new l$B_}]),l$i}(l$N),l$$_=function(l$i){function l$_(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,l$_.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}l$J(l$_,"laya.d3.resource.BaseTexture",l$N);var l$R=l$_.prototype;return l$h(0,l$R,"width",function(){return this._width}),l$h(0,l$R,"repeat",function(){return this._repeat},function(l$i){if(this._repeat!==l$i&&(this._repeat=l$i,this._source)){var l$_=l$$.mainContext;l$G.bindTexture(l$_,this._type,this._source),l$e.isPOT(this._width,this._height)&&this._repeat?(l$_.texParameteri(this._type,10242,10497),l$_.texParameteri(this._type,10243,10497)):(l$_.texParameteri(this._type,10242,33071),l$_.texParameteri(this._type,10243,33071))}}),l$h(0,l$R,"height",function(){return this._height}),l$h(0,l$R,"magFifter",function(){return this._magFifter},function(l$i){(this._magFifter=l$i)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(l$i)}),l$h(0,l$R,"wrapModeV",function(){return this._wrapModeV}),l$h(0,l$R,"size",function(){return this._size}),l$h(0,l$R,"wrapModeU",function(){return this._wrapModeU}),l$h(0,l$R,"mipmap",function(){return this._mipmap},function(l$i){this._mipmap=l$i,this._mipmap!=l$i&&this._conchTexture&&this._conchTexture.setMipMap(l$i)}),l$h(0,l$R,"minFifter",function(){return this._minFifter},function(l$i){this._minFifter=l$i,this._minFifter!=l$i&&this._conchTexture&&this._conchTexture.setMinFifter(l$i)}),l$h(0,l$R,"format",function(){return this._format}),l$h(0,l$R,"source",function(){return this.activeResource(),this._source}),l$h(0,l$R,"defaulteTexture",function(){return l$D_.grayTexture}),l$_.WARPMODE_REPEAT=0,l$_.WARPMODE_CLAMP=1,l$_}(),l$G_=function(l$i){function l$_(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,l$_.__super.call(this),this._boundingBoxCorners=l$r(8,null)}l$J(l$_,"laya.d3.resource.models.BaseMesh",l$N);var l$R=l$_.prototype;return l$R._getPositions=function(){throw new Error("未Override,请重载该属性！")},l$R._generateBoundingObject=function(){this._boundingSphere=new l$Hi(new l$L_,0),l$Hi.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new l$di(new l$L_,new l$L_),l$di.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},l$R.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},l$R.getRenderElement=function(l$i){throw new Error("未Override,请重载该属性！")},l$h(0,l$R,"subMeshCount",function(){return this._subMeshCount}),l$h(0,l$R,"boundingBox",function(){return this._boundingBox}),l$h(0,l$R,"boundingBoxCorners",function(){return this._boundingBoxCorners}),l$h(0,l$R,"boundingSphere",function(){return this._boundingSphere}),l$_}(),l$u_=(function(l$i){function l$_(){l$_.__super.call(this)}l$J(l$_,"laya.d3.component.Script",l$I_);var l$R=l$_.prototype;l$R.onTriggerEnter=function(l$i){},l$R.onTriggerExit=function(l$i){},l$R.onTriggerStay=function(l$i){},l$h(0,l$R,"isSingleton",function(){return l$_._isSingleton}),l$_._isSingleton=!1}(),function(l$i){function l$_(l$i){this._owner=null,this._sharedMesh=null,l$_.__super.call(this),this._owner=l$i}l$J(l$_,"laya.d3.core.MeshFilter",l$i);var l$R=l$_.prototype;return l$R._sharedMeshLoaded=function(){this.event("loaded")},l$R._destroy=function(){l$i.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},l$h(0,l$R,"sharedMesh",function(){return this._sharedMesh},function(l$i){var l$_=this._sharedMesh;l$_&&l$_._removeReference(),(this._sharedMesh=l$i)._addReference(),this.event("meshchanged",[this,l$_,l$i]),l$i.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),l$h(0,l$R,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),l$h(0,l$R,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),l$h(0,l$R,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),l$h(0,l$R,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),l$_}(l$e_)),l$o_=function(l$i){function l$_(l$i){l$_.__super.call(this,l$i),l$i.meshFilter.on("meshchanged",this,this._onMeshChanged)}l$J(l$_,"laya.d3.core.MeshRender",l$c_);var l$R=l$_.prototype;return l$R._onMeshChanged=function(l$i,l$_,l$R){l$R.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:l$R.once("loaded",this,this._onMeshLoaed)},l$R._onMeshLoaed=function(l$i,l$_){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},l$R._calculateBoundingSphereByInitSphere=function(l$i){var l$_=NaN,l$R=this._owner.transform,l$r=l$R.scale.elements,l$b=Math.abs(l$r[0]),l$z=Math.abs(l$r[1]),l$L=Math.abs(l$r[2]);l$_=l$z<=l$b&&l$L<=l$b?l$b:l$L<=l$z?l$z:l$L,l$L_.transformCoordinate(l$i.center,l$R.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=l$i.radius*l$_},l$R._calculateBoundBoxByInitCorners=function(l$i){for(var l$_=this._owner.transform.worldMatrix,l$R=0;l$R<8;l$R++)l$L_.transformCoordinate(l$i[l$R],l$_,l$c_._tempBoundBoxCorners[l$R]);l$di.createfromPoints(l$c_._tempBoundBoxCorners,this._boundingBox)},l$R._calculateBoundingSphere=function(){var l$i=this._owner.meshFilter.sharedMesh;null==l$i||null==l$i.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(l$i.boundingSphere)},l$R._calculateBoundingBox=function(){var l$i=this._owner.meshFilter.sharedMesh;null==l$i||null==l$i.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(l$i.boundingBoxCorners)},l$R._renderUpdate=function(l$i){var l$_=this._owner.transform;if(l$_){this._setShaderValueMatrix4x4(0,l$_.worldMatrix);var l$R=this._owner.getProjectionViewWorldMatrix(l$i);this._setShaderValueMatrix4x4(1,l$R)}else this._setShaderValueMatrix4x4(0,l$i_.DEFAULT),this._setShaderValueMatrix4x4(1,l$i);return l$X_.debugMode&&this._renderRenderableBoundBox(),!0},l$_}(),l$p_=function(l$_){function l$r(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,l$r.__super.call(this),this._renderState=new l$F,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new l$f_,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new l$_i,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new l$L_(.7,.7,.7),this.ambientColor=new l$L_(.212,.227,.259),l$$.shaderHighPrecision&&this.addShaderDefine(l$Z_.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}l$J(l$r,"laya.d3.core.scene.Scene",l$_);var l$i=l$r.prototype;return l$c.imps(l$i,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),l$i._setUrl=function(l$i){this._url=l$i},l$i._getGroup=function(){return this._group},l$i._setGroup=function(l$i){this._group=l$i},l$i._display=function(){l$c.stage._scenes.push(this),l$c.stage._scenes.sort(l$r._sortScenes);for(var l$i=0,l$_=this._childs.length;l$i<l$_;l$i++){var l$R=this._childs[l$i];l$R.active&&l$R._activeHierarchy()}},l$i._unDisplay=function(){var l$i=l$c.stage._scenes;l$i.splice(l$i.indexOf(this),1);for(var l$_=0,l$R=this._childs.length;l$_<l$R;l$_++){var l$r=this._childs[l$_];l$r.active&&l$r._inActiveHierarchy()}},l$i._addChild3D=function(l$i){l$i.transform._onWorldTransform(),l$i._setBelongScene(this),this.displayedInStage&&l$i.active&&l$i._activeHierarchy()},l$i._removeChild3D=function(l$i){l$i.transform.parent=null,this.displayedInStage&&l$i.active&&l$i._inActiveHierarchy(),l$i._setUnBelongScene()},l$i.initOctree=function(l$i,l$_,l$R,l$r,l$b){void 0===l$b&&(l$b=6),this.treeSize=new l$L_(l$i,l$_,l$R),this.treeLevel=l$b,this.treeRoot=new l$d(this,0),this.treeRoot.init(l$r,this.treeSize)},l$i._prepareUpdateToRenderState=function(l$i,l$_){l$_.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,l$_.scene=this},l$i._prepareSceneToRender=function(l$i){var l$_=this._lights.length;if(0<l$_)for(var l$R=0,l$r=0;l$r<l$_&&!(this._lights[l$r]._prepareToScene(l$i)&&++l$R>=this._enableLightCount);l$r++);},l$i._updateChilds=function(l$i){for(var l$_=0,l$R=this._childs.length;l$_<l$R;++l$_)this._childs[l$_]._update(l$i)},l$i._preRenderScene=function(l$i,l$_,l$R){var l$r,l$b=l$_._viewMatrix,l$z=l$_._projectionMatrix,l$L=l$_._projectionViewMatrix,l$w=0,l$x=l$_.camera;for(l$x.useOcclusionCulling?this.treeRoot?l$Ri.renderObjectCullingOctree(l$R,this,l$x,l$b,l$z,l$L):l$Ri.renderObjectCulling(l$R,this,l$x,l$b,l$z,l$L):l$Ri.renderObjectCullingNoBoundFrustum(this,l$x,l$b,l$z,l$L),l$w=0,l$r=this._quenes.length;l$w<l$r;l$w++)this._quenes[l$w]&&this._quenes[l$w]._preRender(l$_)},l$i._clear=function(l$i,l$_){var l$R=l$_._viewport,l$r=l$_.camera,l$b=l$R.x,l$z=l$r.renderTargetSize.height-l$R.y-l$R.height,l$L=l$R.width,l$w=l$R.height;l$i.viewport(l$b,l$z,l$L,l$w);var l$x=256,l$P=l$r.renderTarget;switch(l$r.clearFlag){case 0:var l$B=l$r.clearColor;if(l$B){l$i.enable(3089),l$i.scissor(l$b,l$z,l$L,l$w);var l$n=l$B.elements;l$i.clearColor(l$n[0],l$n[1],l$n[2],l$n[3]),l$x|=16384}if(l$P)switch(l$B||(l$x=16384),l$P.depthStencilFormat){case 33189:l$x|=256;break;case 36168:l$x|=1024;break;case 34041:l$x|=256,l$x|=1024}l$i.clear(l$x),l$B&&l$i.disable(3089);break;case 1:case 2:if(l$P)switch(l$x=16384,l$P.depthStencilFormat){case 33189:l$x|=256;break;case 36168:l$x|=1024;break;case 34041:l$x|=256,l$x|=1024}l$i.clear(l$x);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},l$i._renderScene=function(l$i,l$_){var l$R,l$r,l$b=l$_.camera,l$z=0;for(l$z=0;l$z<2;l$z++)(l$r=this._quenes[l$z])&&(l$b.renderTarget?l$r._render(l$_,!0):l$r._render(l$_,!1));if(1===l$b.clearFlag){var l$L=l$b.sky;l$L&&(l$G.setCullFace(l$i,!1),l$G.setDepthFunc(l$i,515),l$G.setDepthMask(l$i,!1),l$L._render(l$_),l$G.setDepthFunc(l$i,513),l$G.setDepthMask(l$i,!0))}for(l$z=2,l$R=this._quenes.length;l$z<l$R;l$z++)(l$r=this._quenes[l$z])&&(l$r._sortAlpha(l$_.camera.transform.position),l$b.renderTarget?l$r._render(l$_,!0):l$r._render(l$_,!1))},l$i._set3DRenderConfig=function(l$i){l$i.disable(3042),l$G._blend=!1,l$i.blendFunc(770,771),l$G._sFactor=770,l$G._dFactor=771,l$i.disable(2929),l$G._depthTest=!1,l$i.enable(2884),l$G._cullFace=!0,l$i.depthMask(1),l$G._depthMask=!0,l$i.frontFace(2304),l$G._frontFace=2304},l$i._set2DRenderConfig=function(l$i){l$G.setBlend(l$i,!0),l$G.setBlendFunc(l$i,1,771),l$G.setDepthTest(l$i,!1),l$G.setCullFace(l$i,!1),l$G.setDepthMask(l$i,!0),l$G.setFrontFace(l$i,2305),l$i.viewport(0,0,l$B.width,l$B.height)},l$i._parseCustomProps=function(l$i,l$_,l$R,l$r){var l$b=l$r.customProps.lightmaps,l$z=l$b.length,l$L=this._lightmaps;l$L.length=l$z;for(var l$w=0;l$w<l$z;l$w++)l$L[l$w]=l$X.getRes(l$_[l$b[l$w].replace(".exr",".png")]);this.setlightmaps(l$L);var l$x=l$r.customProps.ambientColor;l$x&&(this.ambientColor=new l$L_(l$x[0],l$x[1],l$x[2]));var l$P=l$r.customProps.fogColor;l$P&&(this.fogColor=new l$L_(l$P[0],l$P[1],l$P[2]))},l$i._addLight=function(l$i){this._lights.indexOf(l$i)<0&&this._lights.push(l$i)},l$i._removeLight=function(l$i){var l$_=this._lights.indexOf(l$i);0<=l$_&&this._lights.splice(l$_,1)},l$i._updateScene=function(){var l$i=this._renderState;this._prepareUpdateToRenderState(l$$.mainContext,l$i),this._updateComponents(l$i),this._updateChilds(l$i),this._lateUpdateComponents(l$i),this._time+=l$i.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},l$i._updateSceneConch=function(){var l$i=this._renderState;this._prepareUpdateToRenderState(l$$.mainContext,l$i),this._updateComponents(l$i),this._lateUpdateComponents(l$i),this._prepareSceneToRender(l$i);for(var l$_=0,l$R=this._cameraPool.length;l$_<l$R;l$_++){var l$r=this._cameraPool[l$_];(l$i.camera=l$r)._prepareCameraToRender()}},l$i._preRenderShadow=function(l$i,l$_,l$R,l$r,l$b){this.treeRoot?l$Ri.renderShadowObjectCullingOctree(this,l$_,l$R,l$r,l$b):l$Ri.renderShadowObjectCulling(this,l$_,l$R,l$r,l$b);for(var l$z=0,l$L=l$R.length;l$z<l$L;l$z++)l$R[l$z]&&l$R[l$z]._preRender(l$i)},l$i._renderShadowMap=function(l$i,l$_,l$R){var l$r=this.parallelSplitShadowMaps[0];l$r._calcAllLightCameraInfo(l$R);var l$b,l$z,l$L,l$w=l$r.PSSMNum;if(this._preRenderShadow(l$_,l$r._lightCulling,l$r._shadowQuenes,l$r._lightVPMatrix[0],l$w),this.addShaderDefine(l$J_.SHADERDEFINE_CAST_SHADOW),1<l$w)for(var l$x=0;l$x<l$w;l$x++)l$b=l$r.getRenderTarget(l$x+1),l$r.beginRenderTarget(l$x+1),l$i.clearColor(1,1,1,1),l$i.clear(16640),l$i.viewport(0,0,l$b.width,l$b.height),l$_.camera=l$L=l$r.getLightCamera(l$x),l$L._prepareCameraToRender(),l$L._prepareCameraViewProject(l$L.viewMatrix,l$L.projectionMatrix),l$_._projectionViewMatrix=l$r._lightVPMatrix[l$x+1],(l$z=l$r._shadowQuenes[l$x])._preRender(l$_),l$z._renderShadow(l$_,!1),l$r.endRenderTarget(l$x+1);else l$b=l$r.getRenderTarget(1),l$r.beginRenderTarget(1),l$i.clearColor(1,1,1,1),l$i.clear(16640),l$i.viewport(0,0,l$b.width,l$b.height),l$_.camera=l$L=l$r.getLightCamera(0),l$L._prepareCameraToRender(),l$L._prepareCameraViewProject(l$L.viewMatrix,l$L.projectionMatrix),l$_._projectionViewMatrix=l$r._lightVPMatrix[0],(l$z=l$r._shadowQuenes[0])._preRender(l$_),l$z._renderShadow(l$_,!0),l$r.endRenderTarget(1);this.removeShaderDefine(l$J_.SHADERDEFINE_CAST_SHADOW)},l$i.addTreeNode=function(l$i){this.treeRoot.addTreeNode(l$i)},l$i.removeTreeNode=function(l$i){this.treeSize&&l$i._treeNode&&l$i._treeNode.removeObject(l$i)},l$i.setlightmaps=function(l$i){this._lightmaps=l$i;for(var l$_=0,l$R=this._renderableSprite3Ds.length;l$_<l$R;l$_++)this._renderableSprite3Ds[l$_]._render._applyLightMapParams()},l$i.getlightmaps=function(){return this._lightmaps},l$i.addChildAt=function(l$i,l$_){if(!(l$i instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(l$i&&l$i.__className));if(!l$i||this.destroyed||l$i===this)return l$i;if(l$i.zOrder&&this._set$P("hasZorder",!0),0<=l$_&&l$_<=this._childs.length){if(l$i._parent===this){var l$R=this.getChildIndex(l$i);this._childs.splice(l$R,1),this._childs.splice(l$_,0,l$i),this.conchModel&&(this.conchModel.removeChild(l$i.conchModel),this.conchModel.addChildAt(l$i.conchModel,l$_)),this._childChanged()}else l$i.parent&&l$i.parent.removeChild(l$i),this._childs===l$P.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(l$_,0,l$i),this.conchModel&&this.conchModel.addChildAt(l$i.conchModel,l$_),(l$i.parent=this)._addChild3D(l$i);return l$i}throw new Error("appendChildAt:The index is out of bounds")},l$i.addChild=function(l$i){if(!(l$i instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!l$i||this.destroyed||l$i===this)return l$i;if(l$i.zOrder&&this._set$P("hasZorder",!0),l$i._parent===this){var l$_=this.getChildIndex(l$i);l$_!==this._childs.length-1&&(this._childs.splice(l$_,1),this._childs.push(l$i),this.conchModel&&(this.conchModel.removeChild(l$i.conchModel),this.conchModel.addChildAt(l$i.conchModel,this._childs.length-1)),this._childChanged())}else l$i.parent&&l$i.parent.removeChild(l$i),this._childs===l$P.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(l$i),this.conchModel&&this.conchModel.addChildAt(l$i.conchModel,this._childs.length-1),(l$i.parent=this)._childChanged(),this._addChild3D(l$i);return l$i},l$i.removeChildAt=function(l$i){var l$_=this.getChildAt(l$i);return l$_&&(this._removeChild3D(l$_),this._childs.splice(l$i,1),this.conchModel&&this.conchModel.removeChild(l$_.conchModel),l$_.parent=null),l$_},l$i.removeChildren=function(l$i,l$_){if(void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=2147483647),this._childs&&0<this._childs.length){var l$R=this._childs;if(0===l$i&&l$z<=l$_){var l$r=l$R;this._childs=l$P.ARRAY_EMPTY}else l$r=l$R.splice(l$i,l$_-l$i);for(var l$b=0,l$z=l$r.length;l$b<l$z;l$b++)this._removeChild3D(l$r[l$b]),l$r[l$b].parent=null,this.conchModel&&this.conchModel.removeChild(l$r[l$b].conchModel)}return this},l$i.addFrustumCullingObject=function(l$i){this.treeRoot?this.addTreeNode(l$i):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(l$i):this._cullingRenders[this._cullingRendersLength]=l$i,l$i._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},l$i.removeFrustumCullingObject=function(l$i){if(this.treeRoot)this.removeTreeNode(l$i);else{this._cullingRendersLength--;var l$_=l$i._indexInSceneFrustumCullingObjects;if(l$_!==this._cullingRendersLength){var l$R=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[l$_]=l$R)._indexInSceneFrustumCullingObjects=l$_,l$i._indexInSceneFrustumCullingObjects=-1}}},l$i.getRenderQueue=function(l$i){return l$i<3e3?this._quenes[1]||(this._quenes[1]=new l$a(this)):this._quenes[2]||(this._quenes[2]=new l$a(this))},l$i.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new l$a(this)},l$i.addShaderDefine=function(l$i){this._shaderDefineValue|=l$i},l$i.removeShaderDefine=function(l$i){this._shaderDefineValue&=~l$i},l$i.addScript=function(l$i){return this._addComponent(l$i)},l$i.getScriptByType=function(l$i,l$_){return void 0===l$_&&(l$_=0),this._getComponentByType(l$i,l$_)},l$i.getScriptsByType=function(l$i,l$_){this._getComponentsByType(l$i,l$_)},l$i.getScriptByIndex=function(l$i){return this._getComponentByIndex(l$i)},l$i.removeScriptByType=function(l$i,l$_){void 0===l$_&&(l$_=0),this._removeComponentByType(l$i,l$_)},l$i.removeScriptsByType=function(l$i){this._removeComponentByType(l$i)},l$i.removeAllScript=function(){this._removeAllComponent()},l$i.render=function(l$i,l$_,l$R){(l$M._context.ctx._renderKey=0)<this._childs.length&&l$i.addRenderObject(this)},l$i.renderSubmit=function(){var l$i=l$$.mainContext,l$_=this._renderState;this._set3DRenderConfig(l$i),this._prepareSceneToRender(this._renderState);var l$R,l$r=0,l$b=0;if(l$X_.debugMode||l$d.debugMode)for(l$r=0,l$b=this._cameraPool.length;l$r<l$b;l$r++)l$R=this._cameraPool[l$r],l$X_._debugPhasorSprite.begin(1,l$R),l$R.activeInHierarchy&&l$R._renderCamera(l$i,l$_,this),l$X_._debugPhasorSprite.end();else for(l$r=0,l$b=this._cameraPool.length;l$r<l$b;l$r++)(l$R=this._cameraPool[l$r]).activeInHierarchy&&l$R._renderCamera(l$i,l$_,this);return this._set2DRenderConfig(l$i),1},l$i.onAsynLoaded=function(l$i,l$_,l$R){var l$r=l$_[0];if("Scene"!==l$r.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var l$b=l$_[1];l$N_._createNodeByJson(this,l$r,this,l$b),this.event("hierarchyloaded",[this]),this.__loaded=!0},l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),this.destroyed||(l$_.prototype.destroy.call(this,l$i),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,l$X.clearRes(this.url),this.loaded||l$X_._cancelLoadByUrl(this.url))},l$i.getRenderType=function(){return 0},l$i.releaseRender=function(){},l$i._addComponent=function(l$i){var l$_,l$R=this._componentsMap.indexOf(l$i);if(-1===l$R)l$_=[],this._componentsMap.push(l$i),this._typeComponentsIndices.push(l$_);else if(l$_=this._typeComponentsIndices[l$R],this._components[l$_[0]].isSingleton)throw new Error("无法单实例创建"+l$i+"组件，"+l$i+"组件已存在！");var l$r=l$b.getInstance(l$i);l$_.push(this._components.length),this._components.push(l$r);return l$r._initialize(this),l$r},l$i._removeComponent=function(l$i,l$_){var l$R=this._typeComponentsIndices[l$i],l$r=l$R[l$_],l$b=this._components[l$r];this._components.splice(l$r,1),l$R.splice(l$_,1),0===l$R.length&&(this._typeComponentsIndices.splice(l$i,1),this._componentsMap.splice(l$i,1));for(var l$z=0,l$L=this._componentsMap.length;l$z<l$L;l$z++)for(var l$w=(l$R=this._typeComponentsIndices[l$z]).length-1;0<=l$w;l$w--){var l$x=l$R[l$w];if(!(l$r<l$x))break;l$R[l$w]=--l$x}l$b._destroy()},l$i._getComponentByType=function(l$i,l$_){void 0===l$_&&(l$_=0);var l$R=this._componentsMap.indexOf(l$i);return-1===l$R?null:this._components[this._typeComponentsIndices[l$R][l$_]]},l$i._getComponentsByType=function(l$i,l$_){var l$R=this._componentsMap.indexOf(l$i);if(-1!==l$R){var l$r=this._typeComponentsIndices[l$R],l$b=l$r.length;l$_.length=l$b;for(var l$z=0;l$z<l$b;l$z++)l$_[l$z]=this._components[l$r[l$z]]}else l$_.length=0},l$i._getComponentByIndex=function(l$i){return this._components[l$i]},l$i._removeComponentByType=function(l$i,l$_){void 0===l$_&&(l$_=0);var l$R=this._componentsMap.indexOf(l$i);-1!==l$R&&this._removeComponent(l$R,l$_)},l$i._removeComponentsByType=function(l$i){var l$_=this._componentsMap.indexOf(l$i);if(-1!==l$_)for(var l$R=this._typeComponentsIndices[l$_],l$r=0,l$b=l$R.length;l$r<l$b;l$R.length<l$b?l$b--:l$r++)this._removeComponent(l$_,l$r)},l$i._removeAllComponent=function(){for(var l$i=0,l$_=this._componentsMap.length;l$i<l$_;this._componentsMap.length<l$_?l$_--:l$i++)this._removeComponentsByType(this._componentsMap[l$i])},l$i._updateComponents=function(l$i){for(var l$_=0,l$R=this._components.length;l$_<l$R;l$_++){var l$r=this._components[l$_];!l$r.started&&(l$r._start(l$i),l$r.started=!0),l$r.enable&&l$r._update(l$i)}},l$i._lateUpdateComponents=function(l$i){for(var l$_=0;l$_<this._components.length;l$_++){var l$R=this._components[l$_];!l$R.started&&(l$R._start(l$i),l$R.started=!0),l$R.enable&&l$R._lateUpdate(l$i)}},l$i._preRenderUpdateComponents=function(l$i){for(var l$_=0;l$_<this._components.length;l$_++){var l$R=this._components[l$_];!l$R.started&&(l$R._start(l$i),l$R.started=!0),l$R.enable&&l$R._preRenderUpdate(l$i)}},l$i._postRenderUpdateComponents=function(l$i){for(var l$_=0;l$_<this._components.length;l$_++){var l$R=this._components[l$_];!l$R.started&&(l$R._start(l$i),l$R.started=!0),l$R.enable&&l$R._postRenderUpdate(l$i)}},l$h(0,l$i,"_loaded",null,function(l$i){this.__loaded=l$i}),l$h(0,l$i,"fogColor",function(){return this._fogColor},function(l$i){this._fogColor=l$i,this._shaderValues.setValue(0,l$i.elements)}),l$h(0,l$i,"enableFog",function(){return this._enableFog},function(l$i){this._enableFog!==l$i&&((this._enableFog=l$i)?(this.addShaderDefine(l$Z_.SHADERDEFINE_FOG),this.removeShaderDefine(l$Z_.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(l$Z_.SHADERDEFINE_FOG))}),l$h(0,l$i,"url",function(){return this._url}),l$h(0,l$i,"loaded",function(){return this.__loaded}),l$h(0,l$i,"enableDepthFog",function(){return this._enableDepthFog},function(l$i){this._enableDepthFog!=l$i&&((this._enableDepthFog=l$i)?(this.addShaderDefine(l$Z_.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(l$Z_.SHADERDEFINE_FOG)):this.removeShaderDefine(l$Z_.SAHDERDEFINE_DEPTHFOG))}),l$h(0,l$i,"fogStart",function(){return this._fogStart},function(l$i){this._fogStart=l$i,this._shaderValues.setValue(1,l$i)}),l$h(0,l$i,"fogRange",function(){return this._fogRange},function(l$i){this._fogRange=l$i,this._shaderValues.setValue(2,l$i)}),l$h(0,l$i,"ambientColor",function(){return this._ambientColor},function(l$i){this._ambientColor=l$i,this._shaderValues.setValue(21,l$i.elements)}),l$h(0,l$i,"scene",function(){return this}),l$h(0,l$i,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),l$r._sortScenes=function(l$i,l$_){if(l$i.parent!==l$c.stage||l$_.parent!==l$c.stage)return l$i.parent!==l$c.stage&&l$_.parent!==l$c.stage?l$r._sortScenes(l$i.parent,l$_.parent):l$i.parent===l$c.stage?-1:1;var l$R=l$c.stage._childs;return l$R.indexOf(l$i)-l$R.indexOf(l$_)},l$r.load=function(l$i){return l$c.loader.create(l$i,null,null,l$r)},l$r.FOGCOLOR=0,l$r.FOGSTART=1,l$r.FOGRANGE=2,l$r.LIGHTDIRECTION=3,l$r.LIGHTDIRCOLOR=4,l$r.POINTLIGHTPOS=5,l$r.POINTLIGHTRANGE=6,l$r.POINTLIGHTATTENUATION=7,l$r.POINTLIGHTCOLOR=8,l$r.SPOTLIGHTPOS=9,l$r.SPOTLIGHTDIRECTION=10,l$r.SPOTLIGHTSPOT=11,l$r.SPOTLIGHTRANGE=12,l$r.SPOTLIGHTATTENUATION=13,l$r.SPOTLIGHTCOLOR=14,l$r.SHADOWDISTANCE=15,l$r.SHADOWLIGHTVIEWPROJECT=16,l$r.SHADOWMAPPCFOFFSET=17,l$r.SHADOWMAPTEXTURE1=18,l$r.SHADOWMAPTEXTURE2=19,l$r.SHADOWMAPTEXTURE3=20,l$r.AMBIENTCOLOR=21,l$r.TIME=22,l$r}(l$A),l$k_=function(l$i){function l$_(l$i){l$_.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new l$i_,this._shaderValues=new l$f_,this._colliders=[],this._id=++l$_._uniqueIDCounter,this._transform=new l$l_(this),this.name=l$i||"Sprite3D-"+l$_._nameNumberCounter++,this.layer=l$o.currentCreationLayer,this.active=!0}l$J(l$_,"laya.d3.core.Sprite3D",l$S_);var l$R=l$_.prototype;return l$c.imps(l$R,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),l$R._setUrl=function(l$i){this._url=l$i},l$R._getGroup=function(){return this._group},l$R._setGroup=function(l$i){this._group=l$i},l$R._addChild3D=function(l$i){l$i.transform.parent=this.transform,this._hierarchyAnimator&&(!l$i._hierarchyAnimator&&l$i._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(l$i,!0,[l$i.name])),this._scene&&(l$i._setBelongScene(this._scene),this._activeInHierarchy&&l$i._active&&l$i._activeHierarchy())},l$R._removeChild3D=function(l$i){l$i.transform.parent=null,this._scene&&(this._activeInHierarchy&&l$i._active&&l$i._inActiveHierarchy(),l$i._setUnBelongScene()),this._hierarchyAnimator&&(l$i._hierarchyAnimator==this._hierarchyAnimator&&l$i._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(l$i,!1,[l$i.name]))},l$R._parseBaseCustomProps=function(l$i){var l$_=this.transform.localPosition;l$i.translate?(l$_.fromArray(l$i.translate),l$_.x*=100,l$_.y*=100,l$_.z*=100):l$_.elements.fill(0),this.transform.localPosition=l$_;var l$R=this.transform.localRotation;l$i.rotation?l$R.fromArray(l$i.rotation):l$R.fromArray([0,0,0,-1]),this.transform.localRotation=l$R;var l$r=this.transform.localScale;l$i.scale?l$r.fromArray(l$i.scale):l$r.elements.fill(1),this.transform.localScale=l$r;var l$b=l$i.layer;null!=l$b&&(this.layer=l$o.getLayerByNumber(l$b))},l$R._parseCustomComponent=function(l$i,l$_,l$R){for(var l$r in l$R){var l$b=l$R[l$r];switch(l$r){case"Animator":var l$z=this.addComponent(Animator);if(l$b.avatarPath)l$z.avatar=l$X.getRes(l$_[l$b.avatarPath]);else{var l$L=l$b.avatar;if(l$L){l$z.avatar=l$X.getRes(l$_[l$L.path]);var l$w=l$L.linkSprites;l$w&&l$i.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[l$z,l$w])}}for(var l$x=l$b.clipPaths,l$P=l$x.length,l$B=0;l$B<l$P;l$B++)l$z.addClip(l$X.getRes(l$_[l$x[l$B]]));l$z.clip=l$X.getRes(l$_[l$x[0]]);var l$n=l$b.playOnWake;void 0!==l$n&&(l$z.playOnWake=l$n);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var l$f=this.addComponent(SphereCollider);l$f.isTrigger=l$b.isTrigger;var l$J=l$f.center;l$J.fromArray(l$b.center),l$f.center=l$J,l$f.radius=l$b.radius;break;case"BoxCollider":var l$h=this.addComponent(BoxCollider);l$h.isTrigger=l$b.isTrigger,l$h.center.fromArray(l$b.center);var l$M=l$h.size;l$M.fromArray(l$b.size),l$h.size=l$M;break;case"MeshCollider":this.addComponent(MeshCollider)}}},l$R._onRootNodeHierarchyLoaded=function(l$i,l$_){for(var l$R in l$_){for(var l$r=this,l$b=l$_[l$R],l$z=0,l$L=l$b.length;l$z<l$L;l$z++){var l$w=l$b[l$z];if(""===l$w)break;if(!(l$r=l$r.getChildByName(l$w)))break}l$r&&l$i.linkSprite3DToAvatarNode(l$R,l$r)}},l$R._setHierarchyAnimator=function(l$i,l$_){this._changeHierarchyAnimator(l$i);for(var l$R=0,l$r=this._childs.length;l$R<l$r;l$R++){var l$b=this._childs[l$R];l$b._hierarchyAnimator==l$_&&l$b._setHierarchyAnimator(l$i,l$_)}},l$R._clearHierarchyAnimator=function(l$i,l$_){this._changeHierarchyAnimator(l$_);for(var l$R=0,l$r=this._childs.length;l$R<l$r;l$R++){var l$b=this._childs[l$R];l$b._hierarchyAnimator==l$i&&l$b._clearHierarchyAnimator(l$i,l$_)}},l$R._getAnimatorToLinkSprite3D=function(l$i,l$_,l$R){var l$r=this.getComponentByType(Animator);if(l$r&&(l$r.avatar?l$r.avatar._version||l$i._setAnimatorToLinkAvatar(l$r,l$_):l$i._setAnimatorToLinkSprite3DNoAvatar(l$r,l$_,l$R)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){l$R.unshift(this._parent.name);var l$b=this._parent;l$b._hierarchyAnimator&&l$b._getAnimatorToLinkSprite3D(l$i,l$_,l$R)}},l$R._setAnimatorToLinkSprite3DNoAvatar=function(l$i,l$_,l$R){var l$r=0,l$b=0;for(l$r=0,l$b=l$i.getClipCount();l$r<l$b;l$r++)l$i._handleSpriteOwnersBySprite(l$r,l$_,l$R,this);for(l$r=0,l$b=this._childs.length;l$r<l$b;l$r++){var l$z=this._childs[l$r],l$L=l$R.length;l$R.push(l$z.name),l$z._setAnimatorToLinkSprite3DNoAvatar(l$i,l$_,l$R),l$R.splice(l$L,1)}},l$R._changeHierarchyAnimator=function(l$i){this._hierarchyAnimator=l$i},l$R._isLinkSpriteToAnimationNode=function(l$i,l$_,l$R){var l$r=l$i._avatarNodes.indexOf(l$_),l$b=l$i._cacheSpriteToNodesMap;if(l$R)this._transform.dummy=l$_.transform,l$i._cacheNodesToSpriteMap[l$r]=l$b.length,l$b.push(l$r);else{this._transform.dummy=null;var l$z=l$i._cacheNodesToSpriteMap[l$r];l$i._cacheNodesToSpriteMap[l$r]=null,l$b.splice(l$z,1)}},l$R._setBelongScene=function(l$i){this._scene=l$i;for(var l$_=0,l$R=this._childs.length;l$_<l$R;l$_++)this._childs[l$_]._setBelongScene(l$i)},l$R._setUnBelongScene=function(){this._scene=null;for(var l$i=0,l$_=this._childs.length;l$i<l$_;l$i++)this._childs[l$i]._setUnBelongScene()},l$R._activeHierarchy=function(){var l$i=0,l$_=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),l$i=0,l$_=this._colliders.length;l$i<l$_;l$i++)this._layer._addCollider(this._colliders[l$i]);for(this.event("activeinhierarchychanged",!0),l$i=0,l$_=this._childs.length;l$i<l$_;l$i++){var l$R=this._childs[l$i];l$R._active&&l$R._activeHierarchy()}},l$R._inActiveHierarchy=function(){var l$i=0,l$_=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),l$i=0,l$_=this._colliders.length;l$i<l$_;l$i++){var l$R=this._colliders[l$i];l$R._clearCollsionMap(),this._layer._removeCollider(l$R)}for(this.event("activeinhierarchychanged",!1),l$i=0,l$_=this._childs.length;l$i<l$_;l$i++){var l$r=this._childs[l$i];l$r._active&&l$r._inActiveHierarchy()}},l$R.addComponent=function(l$i){var l$_,l$R=this._componentsMap.indexOf(l$i);if(-1===l$R)l$_=[],this._componentsMap.push(l$i),this._typeComponentsIndices.push(l$_);else if(l$_=this._typeComponentsIndices[l$R],this._components[l$_[0]].isSingleton)throw new Error("无法单实例创建"+l$i+"组件，"+l$i+"组件已存在！");var l$r=l$b.getInstance(l$i);return l$_.push(this._components.length),this._components.push(l$r),l$r instanceof laya.d3.component.Script&&this._scripts.push(l$r),l$r._initialize(this),l$r},l$R._removeComponent=function(l$i,l$_){var l$R,l$r=0,l$b=this._typeComponentsIndices[l$i],l$z=l$b[l$_],l$L=this._components[l$z];for(l$L instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(l$L),1),l$b.splice(l$_,1),0===l$b.length&&(this._typeComponentsIndices.splice(l$i,1),this._componentsMap.splice(l$i,1)),l$r=0,l$R=this._componentsMap.length;l$r<l$R;l$r++)for(var l$w=(l$b=this._typeComponentsIndices[l$r]).length-1;0<=l$w;l$w--){var l$x=l$b[l$w];if(!(l$z<l$x))break;l$b[l$w]=--l$x}l$L._destroy()},l$R._clearSelfRenderObjects=function(){},l$R._addSelfRenderObjects=function(){},l$R._parseCustomProps=function(l$i,l$_,l$R,l$r){},l$R._updateChilds=function(l$i){var l$_=this._childs.length;if(0!==l$_)for(var l$R=0;l$R<l$_;++l$R)this._childs[l$R]._update(l$i)},l$R._getSortID=function(l$i,l$_){return 1e3*l$_.id+l$i._getVertexBuffer().vertexDeclaration.id},l$R._update=function(l$i){(l$i.owner=this)._activeInHierarchy&&(this._updateComponents(l$i),this._lateUpdateComponents(l$i),l$Z.spriteCount++,this._childs.length&&this._updateChilds(l$i))},l$R.getProjectionViewWorldMatrix=function(l$i){return l$i_.multiply(l$i,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},l$R.loadHierarchy=function(l$i){this.addChild(laya.d3.core.Sprite3D.load(l$i))},l$R.addChildAt=function(l$i,l$_){if(!(l$i instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!l$i||this.destroyed||l$i===this)return l$i;if(l$i.zOrder&&this._set$P("hasZorder",!0),0<=l$_&&l$_<=this._childs.length){if(l$i._parent===this){var l$R=this.getChildIndex(l$i);this._childs.splice(l$R,1),this._childs.splice(l$_,0,l$i),this.conchModel&&(this.conchModel.removeChild(l$i.conchModel),this.conchModel.addChildAt(l$i.conchModel,l$_)),this._childChanged()}else l$i.parent&&l$i.parent.removeChild(l$i),this._childs===l$P.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(l$_,0,l$i),this.conchModel&&this.conchModel.addChildAt(l$i.conchModel,l$_),(l$i.parent=this)._addChild3D(l$i);return l$i}throw new Error("appendChildAt:The index is out of bounds")},l$R.addChild=function(l$i){if(!(l$i instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!l$i||this.destroyed||l$i===this)return l$i;if(l$i.zOrder&&this._set$P("hasZorder",!0),l$i._parent===this){var l$_=this.getChildIndex(l$i);l$_!==this._childs.length-1&&(this._childs.splice(l$_,1),this._childs.push(l$i),this.conchModel&&(this.conchModel.removeChild(l$i.conchModel),this.conchModel.addChildAt(l$i.conchModel,this._childs.length-1)),this._childChanged())}else l$i.parent&&l$i.parent.removeChild(l$i),this._childs===l$P.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(l$i),this.conchModel&&this.conchModel.addChildAt(l$i.conchModel,this._childs.length-1),(l$i.parent=this)._childChanged(),this._addChild3D(l$i);return l$i},l$R.removeChildAt=function(l$i){var l$_=this.getChildAt(l$i);return l$_&&(this._removeChild3D(l$_),this._childs.splice(l$i,1),this.conchModel&&this.conchModel.removeChild(l$_.conchModel),l$_.parent=null),l$_},l$R.removeChildren=function(l$i,l$_){if(void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=2147483647),this._childs&&0<this._childs.length){var l$R=this._childs;if(0===l$i&&l$z<=l$_){var l$r=l$R;this._childs=l$P.ARRAY_EMPTY}else l$r=l$R.splice(l$i,l$_-l$i);for(var l$b=0,l$z=l$r.length;l$b<l$z;l$b++)this._removeChild3D(l$r[l$b]),l$r[l$b].parent=null,this.conchModel&&this.conchModel.removeChild(l$r[l$b].conchModel)}return this},l$R.onAsynLoaded=function(l$i,l$_,l$R){var l$r=l$_[0];if("Sprite3D"!==l$r.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var l$b=l$_[1];l$N_._createNodeByJson(this,l$r,this,l$b),this.event("hierarchyloaded",[this]),this.__loaded=!0},l$R.cloneTo=function(l$i){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var l$_=l$i;l$_.name=this.name,l$_._destroyed=this._destroyed,l$_.timer=this.timer,l$_._$P=this._$P,l$_.active=this._active;var l$R=l$_.transform.localPosition;this.transform.localPosition.cloneTo(l$R),l$_.transform.localPosition=l$R;var l$r=l$_.transform.localRotation;this.transform.localRotation.cloneTo(l$r),l$_.transform.localRotation=l$r;var l$b=l$_.transform.localScale;this.transform.localScale.cloneTo(l$b),l$_.transform.localScale=l$b,l$_.isStatic=this.isStatic;var l$z=0,l$L=0;for(l$z=0,l$L=this._componentsMap.length;l$z<l$L;l$z++){var l$w=l$_.addComponent(this._componentsMap[l$z]);this._components[l$z]._cloneTo(l$w)}for(l$z=0,l$L=this._childs.length;l$z<l$L;l$z++)l$_.addChild(this._childs[l$z].clone());var l$x=l$_.getComponentByType(Animator);if(l$x){var l$P=l$x._linkSpritesData;if(l$P)for(var l$B in l$P){for(var l$n=l$P[l$B],l$f=l$_,l$J=0,l$h=l$n.length;l$J<l$h&&(l$f=l$f.getChildByName(l$n[l$J]));l$J++);if(l$f){var l$M=l$x._avatarNodeMap[l$B];l$f._isLinkSpriteToAnimationNode(l$x,l$M,!0)}}}},l$R.clone=function(){var l$i=new this.constructor;return this.cloneTo(l$i),l$i},l$R.destroy=function(l$i){if(void 0===l$i&&(l$i=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,l$i);var l$_,l$R=0;for(l$R=0,l$_=this._components.length;l$R<l$_;l$R++)this._components[l$R]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,l$X.clearRes(this.url),this.loaded||l$X_._cancelLoadByUrl(this.url)}},l$R._handleSpriteToAvatar=function(l$i,l$_){l$i._avatarNodes;var l$R=l$i._avatarNodeMap[this.name];l$R&&l$R.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(l$i,l$R,l$_)},l$R._setAnimatorToLinkAvatar=function(l$i,l$_){this._handleSpriteToAvatar(l$i,l$_);for(var l$R=0,l$r=this._childs.length;l$R<l$r;l$R++){this._childs[l$R]._setAnimatorToLinkAvatar(l$i,l$_)}},l$h(0,l$R,"activeInHierarchy",function(){return this._activeInHierarchy}),l$h(0,l$R,"_loaded",null,function(l$i){this.__loaded=l$i}),l$h(0,l$R,"active",function(){return this._active},function(l$i){this._active!==l$i&&(this._active=l$i,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(l$i?this._activeHierarchy():this._inActiveHierarchy()))}),l$h(0,l$R,"componentsCount",function(){return this._components.length}),l$h(0,l$R,"loaded",function(){return this.__loaded}),l$h(0,l$R,"id",function(){return this._id}),l$h(0,l$R,"url",function(){return this._url}),l$h(0,l$R,"layer",function(){return this._layer},function(l$i){if(this._layer!==l$i){if(!l$i)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var l$_=0,l$R=this._colliders.length;if(this._layer)for(l$_=0;l$_<l$R;l$_++)this._layer._removeCollider(this._colliders[l$_]);for(l$_=0;l$_<l$R;l$_++)l$i._addCollider(this._colliders[l$_])}this._layer=l$i,this.event("layerchanged",l$i)}}),l$h(0,l$R,"scene",function(){return this._scene}),l$h(0,l$R,"transform",function(){return this._transform}),l$_.instantiate=function(l$i,l$_,l$R,l$r,l$b){void 0===l$R&&(l$R=!0);var l$z=l$i.clone();l$_&&l$_.addChild(l$z);var l$L=l$z.transform;if(l$R){var l$w=l$L.worldMatrix;l$i.transform.worldMatrix.cloneTo(l$w),l$L.worldMatrix=l$w}else l$r&&(l$L.position=l$r),l$b&&(l$L.rotation=l$b);return l$z},l$_.load=function(l$i){return l$c.loader.create(l$i,null,null,l$_)},l$_.WORLDMATRIX=0,l$_.MVPMATRIX=1,l$_._uniqueIDCounter=0,l$_._nameNumberCounter=0,l$_}(),l$K_=function(l$i){function l$B(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],l$B.__super.call(this),!l$i||!l$_)throw"Shader Error";this._id=++l$B._count,this._vs=l$i,this._ps=l$_,this._attributeMap=l$R,this._sceneUniformMap=l$r,this._cameraUniformMap=l$b,this._spriteUniformMap=l$z,this._materialUniformMap=l$L,this._renderElementUniformMap=l$w,this._precompile=l$x,this._define=l$P,this._precompile&&l$B.extCompileObj&&l$B.extCompileFunc?l$B.extCompileFunc.call(l$B.extCompileObj,l$i,l$_,l$P):this.recreateResource()}l$J(l$B,"laya.d3.shader.Shader3D",l$R);var l$_=l$B.prototype;return l$_.recreateResource=function(){l$u.now();this._compile(),this.completeCreate(),this.memorySize=0},l$_.disposeResource=function(){l$$.mainContext.deleteShader(this._vshader),l$$.mainContext.deleteShader(this._pshader),l$$.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},l$_._compile=function(){if(!l$$.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var l$i=[this._vs,this._ps],l$_=l$$.mainContext;if(this._program=l$_.createProgram(),this._vshader=l$B._createShader(l$_,l$i[0],35633),this._pshader=l$B._createShader(l$_,l$i[1],35632),l$_.attachShader(this._program,this._vshader),l$_.attachShader(this._program,this._pshader),l$_.linkProgram(this._program),!l$M.isConchApp&&l$Z_.debugMode&&!l$_.getProgramParameter(this._program,35714))throw l$_.getProgramInfoLog(this._program);var l$R,l$r=0,l$b=0,l$z=0;for(l$z=l$M.isConchApp?l$_.getProgramParameterEx(this._vs,this._ps,"",35721):l$_.getProgramParameter(this._program,35721),l$r=0;l$r<l$z;l$r++){var l$L=null;l$R={vartype:"attribute",ivartype:0,attrib:l$L=l$M.isConchApp?l$_.getActiveAttribEx(this._vs,this._ps,"",l$r):l$_.getActiveAttrib(this._program,l$r),location:l$_.getAttribLocation(this._program,l$L.name),name:l$L.name,type:l$L.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(l$R)}var l$w=0;for(l$w=l$M.isConchApp?l$_.getProgramParameterEx(this._vs,this._ps,"",35718):l$_.getProgramParameter(this._program,35718),l$r=0;l$r<l$w;l$r++){var l$x=null;l$x=l$M.isConchApp?l$_.getActiveUniformEx(this._vs,this._ps,"",l$r):l$_.getActiveUniform(this._program,l$r),0<(l$R={vartype:"uniform",ivartype:1,attrib:l$L,location:l$_.getUniformLocation(this._program,l$x.name),name:l$x.name,type:l$x.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(l$R.name=l$R.name.substr(0,l$R.name.length-3),l$R.isArray=!0,l$R.location=l$_.getUniformLocation(this._program,l$R.name)),this._uniformParams.push(l$R)}for(l$r=0,l$b=this._attributeParams.length;l$r<l$b;l$r++)(l$R=this._attributeParams[l$r]).indexOfParams=l$r,l$R.index=1,l$R.value=[l$R.location,null],l$R.codename=l$R.name,l$R.name=null!=this._attributeMap[l$R.codename]?this._attributeMap[l$R.codename]:l$R.codename,this._attributeParamsMap.push(l$R.name),this._attributeParamsMap.push(l$R),l$R._this=this,l$R.uploadedValue=[],l$R.fun=this._attribute;for(l$r=0,l$b=this._uniformParams.length;l$r<l$b;l$r++)switch((l$R=this._uniformParams[l$r]).indexOfParams=l$r,l$R.index=1,l$R.value=[l$R.location,null],l$R.codename=l$R.name,null!=this._sceneUniformMap[l$R.codename]?(l$R.name=this._sceneUniformMap[l$R.codename],this._sceneUniformParamsMap.push(l$R.name),this._sceneUniformParamsMap.push(l$R)):null!=this._cameraUniformMap[l$R.codename]?(l$R.name=this._cameraUniformMap[l$R.codename],this._cameraUniformParamsMap.push(l$R.name),this._cameraUniformParamsMap.push(l$R)):null!=this._spriteUniformMap[l$R.codename]?(l$R.name=this._spriteUniformMap[l$R.codename],this._spriteUniformParamsMap.push(l$R.name),this._spriteUniformParamsMap.push(l$R)):null!=this._materialUniformMap[l$R.codename]?(l$R.name=this._materialUniformMap[l$R.codename],this._materialUniformParamsMap.push(l$R.name),this._materialUniformParamsMap.push(l$R)):null!=this._renderElementUniformMap[l$R.codename]?(l$R.name=this._renderElementUniformMap[l$R.codename],this._renderElementUniformParamsMap.push(l$R.name),this._renderElementUniformParamsMap.push(l$R)):console.log("Shader:can't find uinform name:"+l$R.codename+" in shader file."),l$R._this=this,l$R.uploadedValue=[],l$R.type){case 5124:l$R.fun=l$R.isArray?this._uniform1iv:this._uniform1i;break;case 5126:l$R.fun=l$R.isArray?this._uniform1fv:this._uniform1f;break;case 35664:l$R.fun=l$R.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:l$R.fun=l$R.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:l$R.fun=l$R.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:l$R.fun=this._uniform_sampler2D;break;case 35680:l$R.fun=this._uniform_samplerCube;break;case 35676:l$R.fun=this._uniformMatrix4fv;break;case 35670:l$R.fun=this._uniform1i;break;case 35674:l$R.fun=this._uinformMatrix2fv;break;case 35675:l$R.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},l$_._attribute=function(l$i,l$_){var l$R=l$$.mainContext,l$r=l$w._enableAtributes,l$b=l$i.location;return l$r[l$b]||l$R.enableVertexAttribArray(l$b),l$R.vertexAttribPointer(l$b,l$_[0],l$_[1],l$_[2],l$_[3],l$_[4]),l$r[l$b]=l$w._bindVertexBuffer,1},l$_._uniform1f=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_?(l$$.mainContext.uniform1f(l$i.location,l$R[0]=l$_),1):0},l$_._uniform1fv=function(l$i,l$_){if(l$_.length<4){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]||l$R[2]!==l$_[2]||l$R[3]!==l$_[3]?(l$$.mainContext.uniform1fv(l$i.location,l$_),l$R[0]=l$_[0],l$R[1]=l$_[1],l$R[2]=l$_[2],l$R[3]=l$_[3],1):0}return l$$.mainContext.uniform1fv(l$i.location,l$_),1},l$_._uniform_vec2=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]?(l$$.mainContext.uniform2f(l$i.location,l$R[0]=l$_[0],l$R[1]=l$_[1]),1):0},l$_._uniform_vec2v=function(l$i,l$_){if(l$_.length<2){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]||l$R[2]!==l$_[2]||l$R[3]!==l$_[3]?(l$$.mainContext.uniform2fv(l$i.location,l$_),l$R[0]=l$_[0],l$R[1]=l$_[1],l$R[2]=l$_[2],l$R[3]=l$_[3],1):0}return l$$.mainContext.uniform2fv(l$i.location,l$_),1},l$_._uniform_vec3=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]||l$R[2]!==l$_[2]?(l$$.mainContext.uniform3f(l$i.location,l$R[0]=l$_[0],l$R[1]=l$_[1],l$R[2]=l$_[2]),1):0},l$_._uniform_vec3v=function(l$i,l$_){return l$$.mainContext.uniform3fv(l$i.location,l$_),1},l$_._uniform_vec4=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]||l$R[2]!==l$_[2]||l$R[3]!==l$_[3]?(l$$.mainContext.uniform4f(l$i.location,l$R[0]=l$_[0],l$R[1]=l$_[1],l$R[2]=l$_[2],l$R[3]=l$_[3]),1):0},l$_._uniform_vec4v=function(l$i,l$_){return l$$.mainContext.uniform4fv(l$i.location,l$_),1},l$_._uniformMatrix2fv=function(l$i,l$_){return l$$.mainContext.uniformMatrix2fv(l$i.location,!1,l$_),1},l$_._uniformMatrix3fv=function(l$i,l$_){return l$$.mainContext.uniformMatrix3fv(l$i.location,!1,l$_),1},l$_._uniformMatrix4fv=function(l$i,l$_){return l$$.mainContext.uniformMatrix4fv(l$i.location,!1,l$_),1},l$_._uinformMatrix2fv=function(l$i,l$_){return l$$.mainContext.uniformMatrix2fv(l$i.location,!1,l$_),1},l$_._uinformMatrix3fv=function(l$i,l$_){return l$$.mainContext.uniformMatrix3fv(l$i.location,!1,l$_),1},l$_._uniform1i=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_?(l$$.mainContext.uniform1i(l$i.location,l$R[0]=l$_),1):0},l$_._uniform1iv=function(l$i,l$_){return l$$.mainContext.uniform1iv(l$i.location,l$_),1},l$_._uniform_ivec2=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]?(l$$.mainContext.uniform2i(l$i.location,l$R[0]=l$_[0],l$R[1]=l$_[1]),1):0},l$_._uniform_ivec2v=function(l$i,l$_){return l$$.mainContext.uniform2iv(l$i.location,l$_),1},l$_._uniform_vec3i=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]||l$R[2]!==l$_[2]?(l$$.mainContext.uniform3i(l$i.location,l$R[0]=l$_[0],l$R[1]=l$_[1],l$R[2]=l$_[2]),1):0},l$_._uniform_vec3vi=function(l$i,l$_){return l$$.mainContext.uniform3iv(l$i.location,l$_),1},l$_._uniform_vec4i=function(l$i,l$_){var l$R=l$i.uploadedValue;return l$R[0]!==l$_[0]||l$R[1]!==l$_[1]||l$R[2]!==l$_[2]||l$R[3]!==l$_[3]?(l$$.mainContext.uniform4i(l$i.location,l$R[0]=l$_[0],l$R[1]=l$_[1],l$R[2]=l$_[2],l$R[3]=l$_[3]),1):0},l$_._uniform_vec4vi=function(l$i,l$_){return l$$.mainContext.uniform4iv(l$i.location,l$_),1},l$_._uniform_sampler2D=function(l$i,l$_){var l$R=l$_.source||l$_.defaulteTexture.source,l$r=l$$.mainContext,l$b=l$i.uploadedValue;if(null!=l$b[0])return l$r.activeTexture(l$B._TEXTURES[l$b[0]]),l$R&&l$G.bindTexture(l$r,3553,l$R),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return l$b[0]=this._curActTexIndex,l$r.uniform1i(l$i.location,this._curActTexIndex),l$r.activeTexture(l$B._TEXTURES[this._curActTexIndex]),l$R&&l$G.bindTexture(l$r,3553,l$R),this._curActTexIndex++,1},l$_._uniform_samplerCube=function(l$i,l$_){var l$R=l$_.source||l$_.defaulteTexture.source,l$r=l$$.mainContext,l$b=l$i.uploadedValue;if(null!=l$b[0])return l$r.activeTexture(l$B._TEXTURES[l$b[0]]),l$R?l$G.bindTexture(l$r,34067,l$R):l$G.bindTexture(l$r,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return l$b[0]=this._curActTexIndex,l$r.uniform1i(l$i.location,this._curActTexIndex),l$r.activeTexture(l$B._TEXTURES[this._curActTexIndex]),l$R?l$G.bindTexture(l$r,34067,l$R):l$G.bindTexture(l$r,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},l$_._noSetValue=function(l$i){console.log("no....:"+l$i.name)},l$_.bind=function(){return l$R.activeShader=this,(l$R.bindShader=this).activeResource(),l$G.UseProgram(this._program)},l$_.uploadAttributes=function(l$i,l$_){for(var l$R,l$r,l$b=0,l$z=0,l$L=this._attributeParamsMap.length;l$z<l$L;l$z+=2)l$r=this._attributeParamsMap[l$z+1],null!=(l$R=l$i[this._attributeParamsMap[l$z]])&&(l$_&&l$_[l$r.name]&&l$_[l$r.name].bind(),l$b+=l$r.fun.call(this,l$r,l$R));l$Z.shaderCall+=l$b},l$_.uploadAttributesX=function(l$i,l$_){for(var l$R,l$r,l$b=0,l$z=0,l$L=this._attributeParamsMap.length;l$z<l$L;l$z+=2)l$r=this._attributeParamsMap[l$z+1],null!=(l$R=l$i[this._attributeParamsMap[l$z]])&&(l$_._bind(),l$b+=l$r.fun.call(this,l$r,l$R));l$Z.shaderCall+=l$b},l$_.uploadSceneUniforms=function(l$i){for(var l$_,l$R,l$r=0,l$b=0,l$z=this._sceneUniformParamsMap.length;l$b<l$z;l$b+=2)l$R=this._sceneUniformParamsMap[l$b+1],null!=(l$_=l$i[this._sceneUniformParamsMap[l$b]])&&(l$r+=l$R.fun.call(this,l$R,l$_));l$Z.shaderCall+=l$r},l$_.uploadCameraUniforms=function(l$i){for(var l$_,l$R,l$r=0,l$b=0,l$z=this._cameraUniformParamsMap.length;l$b<l$z;l$b+=2)l$R=this._cameraUniformParamsMap[l$b+1],null!=(l$_=l$i[this._cameraUniformParamsMap[l$b]])&&(l$r+=l$R.fun.call(this,l$R,l$_));l$Z.shaderCall+=l$r},l$_.uploadSpriteUniforms=function(l$i){for(var l$_,l$R,l$r=0,l$b=0,l$z=this._spriteUniformParamsMap.length;l$b<l$z;l$b+=2)l$R=this._spriteUniformParamsMap[l$b+1],null!=(l$_=l$i[this._spriteUniformParamsMap[l$b]])&&(l$r+=l$R.fun.call(this,l$R,l$_));l$Z.shaderCall+=l$r},l$_.uploadMaterialUniforms=function(l$i){for(var l$_,l$R,l$r=0,l$b=0,l$z=this._materialUniformParamsMap.length;l$b<l$z;l$b+=2)l$R=this._materialUniformParamsMap[l$b+1],null!=(l$_=l$i[this._materialUniformParamsMap[l$b]])&&(l$r+=l$R.fun.call(this,l$R,l$_));l$Z.shaderCall+=l$r},l$_.uploadRenderElementUniforms=function(l$i){for(var l$_,l$R,l$r=0,l$b=0,l$z=this._renderElementUniformParamsMap.length;l$b<l$z;l$b+=2)l$R=this._renderElementUniformParamsMap[l$b+1],null!=(l$_=l$i[this._renderElementUniformParamsMap[l$b]])&&(l$r+=l$R.fun.call(this,l$R,l$_));l$Z.shaderCall+=l$r},l$B.create=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){return new l$B(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P)},l$B.addInclude=function(l$i,l$_){l$I.addInclude(l$i,l$_)},l$B._createShader=function(l$i,l$_,l$R){var l$r=l$i.createShader(l$R);if(l$i.shaderSource(l$r,l$_),l$i.compileShader(l$r),l$Z_.debugMode&&!l$i.getShaderParameter(l$r,35713))throw l$i.getShaderInfoLog(l$r);return l$r},l$B.PERIOD_RENDERELEMENT=0,l$B.PERIOD_MATERIAL=1,l$B.PERIOD_SPRITE=2,l$B.PERIOD_CAMERA=3,l$B.PERIOD_SCENE=4,l$B._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],l$B._count=0,l$B._preCompile=!1,l$B.extCompileFunc=null,l$B.extCompileObj=null,l$n(l$B,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new l$q}]),l$B}(),l$O_=function(l$w){function l$x(){this._transformUV=null,l$x.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new l$L_(.6,.6,.6)),this._setColor(10,new l$L_(1,1,1)),this._setColor(11,new l$w_(1,1,1,8)),this._setColor(12,new l$L_(1,1,1)),this._setColor(7,new l$w_(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new l$w_(1,1,0,0)),this.renderMode=1}l$J(l$x,"laya.d3.core.material.StandardMaterial",l$w);var l$i=l$x.prototype;return l$i.disableLight=function(){this._addDisablePublicShaderDefine(l$Z_.SHADERDEFINE_POINTLIGHT|l$Z_.SHADERDEFINE_SPOTLIGHT|l$Z_.SHADERDEFINE_DIRECTIONLIGHT)},l$i.disableFog=function(){this._addDisablePublicShaderDefine(l$Z_.SHADERDEFINE_FOG)},l$i.onAsynLoaded=function(l$i,l$_,l$R){var l$r=l$_[0];if(l$r.version)l$w.prototype.onAsynLoaded.call(this,l$i,l$_,l$R);else{var l$b=l$_[1],l$z=l$r.props;for(var l$L in l$z)this[l$L]=l$z[l$L];l$x._parseStandardMaterial(l$b,this,l$r),this._endLoaded()}},l$i.cloneTo=function(l$i){l$w.prototype.cloneTo.call(this,l$i);var l$_=l$i;this._transformUV&&(l$_._transformUV=this._transformUV.clone())},l$h(0,l$i,"ambientColor",function(){return this._getColor(9)},function(l$i){this._setColor(9,l$i)}),l$h(0,l$i,"ambientTexture",function(){return this._getTexture(5)},function(l$i){l$i?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,l$i)}),l$h(0,l$i,"renderMode",null,function(l$i){switch(l$i){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(l$x.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(l$i)}),l$h(0,l$i,"reflectColor",function(){return this._getColor(12)},function(l$i){this._setColor(12,l$i)}),l$h(0,l$i,"tilingOffset",function(){return this._getColor(15)},function(l$i){if(l$i){var l$_=l$i.elements;1!=l$_[0]||1!=l$_[1]||0!=l$_[2]||0!=l$_[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,l$i)}),l$h(0,l$i,"albedo",function(){return this._getColor(7)},function(l$i){this._setColor(7,l$i)}),l$h(0,l$i,"diffuseColor",function(){return this._getColor(10)},function(l$i){this._setColor(10,l$i)}),l$h(0,l$i,"albedoColor",function(){return this._getColor(7)},function(l$i){this._setColor(7,l$i)}),l$h(0,l$i,"specularColor",function(){return this._getColor(11)},function(l$i){this._setColor(11,l$i)}),l$h(0,l$i,"diffuseTexture",function(){return this._getTexture(1)},function(l$i){l$i?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,l$i)}),l$h(0,l$i,"normalTexture",function(){return this._getTexture(2)},function(l$i){l$i?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,l$i)}),l$h(0,l$i,"specularTexture",function(){return this._getTexture(3)},function(l$i){l$i?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,l$i)}),l$h(0,l$i,"emissiveTexture",function(){return this._getTexture(4)},function(l$i){l$i?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,l$i)}),l$h(0,l$i,"reflectTexture",function(){return this._getTexture(6)},function(l$i){l$i?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,l$i)}),l$h(0,l$i,"transformUV",function(){return this._transformUV},function(l$i){this._transformUV=l$i,this._setMatrix4x4(13,l$i.matrix),l$i?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,l$i.matrix.elements,0)}),l$x.__init__=function(){l$x.SHADERDEFINE_DIFFUSEMAP=l$x.shaderDefines.registerDefine("DIFFUSEMAP"),l$x.SHADERDEFINE_NORMALMAP=l$x.shaderDefines.registerDefine("NORMALMAP"),l$x.SHADERDEFINE_SPECULARMAP=l$x.shaderDefines.registerDefine("SPECULARMAP"),l$x.SHADERDEFINE_EMISSIVEMAP=l$x.shaderDefines.registerDefine("EMISSIVEMAP"),l$x.SHADERDEFINE_AMBIENTMAP=l$x.shaderDefines.registerDefine("AMBIENTMAP"),l$x.SHADERDEFINE_REFLECTMAP=l$x.shaderDefines.registerDefine("REFLECTMAP"),l$x.SHADERDEFINE_UVTRANSFORM=l$x.shaderDefines.registerDefine("UVTRANSFORM"),l$x.SHADERDEFINE_TILINGOFFSET=l$x.shaderDefines.registerDefine("TILINGOFFSET"),l$x.SHADERDEFINE_ADDTIVEFOG=l$x.shaderDefines.registerDefine("ADDTIVEFOG")},l$x.load=function(l$i){return l$c.loader.create(l$i,null,null,l$x)},l$x._parseStandardMaterial=function(l$i,l$_,l$R){var l$r=l$R.customProps,l$b=l$r.ambientColor;l$_.ambientColor=new l$L_(l$b[0],l$b[1],l$b[2]);var l$z=l$r.diffuseColor;l$_.diffuseColor=new l$L_(l$z[0],l$z[1],l$z[2]);var l$L=l$r.specularColor;l$_.specularColor=new l$w_(l$L[0],l$L[1],l$L[2],l$L[3]);var l$w=l$r.reflectColor;l$_.reflectColor=new l$L_(l$w[0],l$w[1],l$w[2]);var l$x=l$r.albedoColor;l$x&&(l$_.albedo=new l$w_(l$x[0],l$x[1],l$x[2],l$x[3]));var l$P=l$r.diffuseTexture.texture2D;l$P&&(l$_.diffuseTexture=l$X.getRes(l$i[l$P]));var l$B=l$r.normalTexture.texture2D;l$B&&(l$_.normalTexture=l$X.getRes(l$i[l$B]));var l$n=l$r.specularTexture.texture2D;l$n&&(l$_.specularTexture=l$X.getRes(l$i[l$n]));var l$f=l$r.emissiveTexture.texture2D;l$f&&(l$_.emissiveTexture=l$X.getRes(l$i[l$f]));var l$J=l$r.ambientTexture.texture2D;l$J&&(l$_.ambientTexture=l$X.getRes(l$i[l$J]));var l$h=l$r.reflectTexture.texture2D;l$h&&(l$_.reflectTexture=l$X.getRes(l$i[l$h]))},l$x.RENDERMODE_OPAQUE=1,l$x.RENDERMODE_OPAQUEDOUBLEFACE=2,l$x.RENDERMODE_CUTOUT=3,l$x.RENDERMODE_CUTOUTDOUBLEFACE=4,l$x.RENDERMODE_TRANSPARENT=13,l$x.RENDERMODE_TRANSPARENTDOUBLEFACE=14,l$x.RENDERMODE_ADDTIVE=15,l$x.RENDERMODE_ADDTIVEDOUBLEFACE=16,l$x.RENDERMODE_DEPTHREAD_TRANSPARENT=5,l$x.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,l$x.RENDERMODE_DEPTHREAD_ADDTIVE=7,l$x.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,l$x.RENDERMODE_NONDEPTH_TRANSPARENT=9,l$x.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,l$x.RENDERMODE_NONDEPTH_ADDTIVE=11,l$x.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,l$x.SHADERDEFINE_DIFFUSEMAP=0,l$x.SHADERDEFINE_NORMALMAP=0,l$x.SHADERDEFINE_SPECULARMAP=0,l$x.SHADERDEFINE_EMISSIVEMAP=0,l$x.SHADERDEFINE_AMBIENTMAP=0,l$x.SHADERDEFINE_REFLECTMAP=0,l$x.SHADERDEFINE_UVTRANSFORM=0,l$x.SHADERDEFINE_TILINGOFFSET=0,l$x.SHADERDEFINE_ADDTIVEFOG=0,l$x.DIFFUSETEXTURE=1,l$x.NORMALTEXTURE=2,l$x.SPECULARTEXTURE=3,l$x.EMISSIVETEXTURE=4,l$x.AMBIENTTEXTURE=5,l$x.REFLECTTEXTURE=6,l$x.ALBEDO=7,l$x.UVANIAGE=8,l$x.MATERIALAMBIENT=9,l$x.MATERIALDIFFUSE=10,l$x.MATERIALSPECULAR=11,l$x.MATERIALREFLECT=12,l$x.UVMATRIX=13,l$x.UVAGE=14,l$x.TILINGOFFSET=15,l$n(l$x,["defaultMaterial",function(){var l$i=new l$x;return l$i.lock=!0,this.defaultMaterial=l$i},"shaderDefines",function(){return this.shaderDefines=new l$B_(l$v_.shaderDefines)}]),l$x}(l$v_),l$E_=function(l$i){function l$L(l$i,l$_,l$R,l$r,l$b){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===l$R&&(l$R=35044),void 0===l$r&&(l$r=!1),l$L.__super.call(this),this._indexType=l$i,this._indexCount=l$_,this._bufferUsage=l$R,this._bufferType=34963,this._canRead=l$r;var l$z;if("ushort"==l$i)this._indexTypeByteCount=2;else{if("ubyte"!=l$i)throw new Error("unidentification index type.");this._indexTypeByteCount=1}l$z=this._indexTypeByteCount*l$_,this._byteLength=l$z,this._bind(),l$w._gl.bufferData(this._bufferType,l$z,this._bufferUsage),this.uri=l$b,l$r?("ushort"==l$i?this._buffer=new Uint16Array(l$_):"ubyte"==l$i&&(this._buffer=new Uint8Array(l$_)),this.memorySize=2*l$z):this.memorySize=l$z}l$J(l$L,"laya.d3.graphics.IndexBuffer3D",l$i);var l$_=l$L.prototype;return l$_.setData=function(l$i,l$_,l$R,l$r){void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=4294967295);var l$b=0;if("ushort"==this._indexType?(l$b=2,0===l$R&&4294967295===l$r||(l$i=new Uint16Array(l$i.buffer,l$R*l$b,l$r))):"ubyte"==this._indexType&&(l$b=1,0===l$R&&4294967295===l$r||(l$i=new Uint8Array(l$i.buffer,l$R*l$b,l$r))),this._bind(),l$w._gl.bufferSubData(this._bufferType,l$_*l$b,l$i),this._canRead)if(0!==l$_||0!==l$R||4294967295!==l$r){var l$z=this._buffer.length-l$_;l$z<l$r&&(l$r=l$z);for(var l$L=0;l$L<l$r;l$L++)this._buffer[l$_+l$L]=l$i[l$L]}else this._buffer=l$i},l$_.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},l$_.disposeResource=function(){l$i.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},l$h(0,l$_,"indexType",function(){return this._indexType}),l$h(0,l$_,"indexTypeByteCount",function(){return this._indexTypeByteCount}),l$h(0,l$_,"indexCount",function(){return this._indexCount}),l$h(0,l$_,"canRead",function(){return this._canRead}),l$L.INDEXTYPE_UBYTE="ubyte",l$L.INDEXTYPE_USHORT="ushort",l$L.create=function(l$i,l$_,l$R,l$r,l$b){return void 0===l$R&&(l$R=35044),void 0===l$r&&(l$r=!1),new l$L(l$i,l$_,l$R,l$r,l$b)},l$L}(l$w),l$s_=function(l$z){function l$L(l$i,l$_,l$R,l$r,l$b){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===l$r&&(l$r=!1),l$L.__super.call(this),this._vertexDeclaration=l$i,this._vertexCount=l$_,this._bufferUsage=l$R,this._bufferType=34962,this._canRead=l$r,this.uri=l$b,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*l$_,this._bind(),l$w._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),l$r&&(this._buffer=new Float32Array(this._byteLength/4))}l$J(l$L,"laya.d3.graphics.VertexBuffer3D",l$z);var l$i=l$L.prototype;return l$i.bindWithIndexBuffer=function(l$i){l$i&&l$i._bind(),this._bind()},l$i.setData=function(l$i,l$_,l$R,l$r){if(void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=4294967295),0===l$R&&4294967295===l$r||(l$i=new Float32Array(l$i.buffer,4*l$R,l$r)),this._bind(),l$w._gl.bufferSubData(this._bufferType,4*l$_,l$i),this._canRead)if(0!==l$_||0!==l$R||4294967295!==l$r){var l$b=this._buffer.length-l$_;l$b<l$r&&(l$r=l$b);for(var l$z=0;l$z<l$r;l$z++)this._buffer[l$_+l$z]=l$i[l$z]}else this._buffer=l$i},l$i.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},l$i.disposeResource=function(){for(var l$i=l$$.mainContext,l$_=this._vertexDeclaration.getVertexElements(),l$R=l$w._enableAtributes,l$r=0,l$b=l$_.length;l$r<l$b;l$r++)l$R[l$r]===this._glBuffer&&(l$i.disableVertexAttribArray(l$r),l$R[l$r]=null);l$z.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},l$h(0,l$i,"vertexDeclaration",function(){return this._vertexDeclaration}),l$h(0,l$i,"vertexCount",function(){return this._vertexCount}),l$h(0,l$i,"canRead",function(){return this._canRead}),l$L.create=function(l$i,l$_,l$R,l$r,l$b){return void 0===l$R&&(l$R=35044),void 0===l$r&&(l$r=!1),new l$L(l$i,l$_,l$R,l$r,l$b)},l$L}(l$w),l$Y_=function(l$i){function l$I(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,l$I.__super.call(this),this._type=3553}l$J(l$I,"laya.d3.resource.DataTexture2D",l$$_);var l$_=l$I.prototype;return l$_.genDebugMipmaps=function(){var l$i=[];return l$i.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),l$i.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),l$i.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),l$i.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),l$i.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),l$i.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),l$i.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),l$i.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),l$i.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),l$i.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),l$i},l$_._onTextureLoaded=function(l$i){},l$_._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var l$i=l$$.mainContext,l$_=this._source=l$i.createTexture(),l$R=this._width,l$r=this._height,l$b=l$G.curBindTexTarget,l$z=l$G.curBindTexValue,l$L=!1;if(l$G.bindTexture(l$i,this._type,l$_),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var l$w=0;l$i.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var l$x=0;l$x<this._mipmaps.length;l$x++){if(this._mipmaps[l$x].byteLength!=l$P*l$B*4)throw"mipmap size error  level:"+l$x;l$i.texSubImage2D(this._type,0,l$I.simLodRect[l$w++],l$I.simLodRect[l$w++],l$I.simLodRect[l$w++],l$I.simLodRect[l$w++],6408,5121,new Uint8Array(this._mipmaps[l$x]))}this.minFifter=9729,this.magFifter=9729}else{var l$P=this._width,l$B=this._height;for(l$w=0,l$i.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),l$x=0;l$x<this._mipmaps.length;l$x++){if(this._mipmaps[l$x].byteLength!=l$P*l$B*4)throw"mipmap size error  level:"+l$x;l$i.texImage2D(this._type,l$x,6408,l$P,l$B,0,6408,5121,new Uint8Array(this._mipmaps[l$x])),(l$P/=2)<1&&(l$P=1),(l$B/=2)<1&&(l$B=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&l$i.pixelStorei(l$i.UNPACK_ALIGNMENT,1),l$i.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var l$n=0,l$f=!1,l$J=!1;this._buffer.byteLength==4*l$R*l$r?(l$n=6408,l$f=!0):this._buffer.byteLength==3*l$R*l$r?(l$n=6407,l$J=!0):l$n=this._format,l$f||l$J?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),l$J&&l$i.pixelStorei(l$i.UNPACK_ALIGNMENT,1),l$i.texImage2D(this._type,0,l$n,l$R,l$r,0,l$n,5121,this._buffer)):l$i&&l$n==l$i.ALPHA?(l$i.texImage2D(3553,0,l$n,l$R,l$r,0,l$n,l$i.UNSIGNED_BYTE,this._buffer),l$L=!0):0!=l$n&&(l$i.compressedTexImage2D(3553,0,l$n,l$R,l$r,0,this._buffer),l$L=!0)}var l$h=this._minFifter,l$M=this._magFifter,l$N=0==this._wrapModeU?10497:33071,l$X=0==this._wrapModeV?10497:33071,l$t=l$e.isPOT(l$R,l$r);l$t?(this._mipmap||this._mipmaps?-1!==l$h||(l$h=9987):-1!==l$h||(l$h=9729),-1!==l$M||(l$M=9729),l$i.texParameteri(this._type,10241,l$h),l$i.texParameteri(this._type,10240,l$M),l$i.texParameteri(this._type,10242,l$N),l$i.texParameteri(this._type,10243,l$X),this._mipmap&&l$i.generateMipmap(this._type)):(-1!==l$h||(l$h=9729),-1!==l$M||(l$M=9729),l$i.texParameteri(this._type,10241,l$h),l$i.texParameteri(this._type,10240,l$M),l$i.texParameteri(this._type,10242,33071),l$i.texParameteri(this._type,10243,33071)),l$b&&l$z&&l$G.bindTexture(l$i,l$b,l$z),this.memorySize=l$L?this._buffer.length:l$t?l$R*l$r*4*(1+1/3):l$R*l$r*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},l$_.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},l$_.onAsynLoaded=function(l$i,l$_,l$R){var l$r;l$R&&(l$r=l$R[0].call(this,l$_)),l$r&&(this._width=l$r.width,this._height=l$r.height,this._buffer=l$r.data),this._src=l$i,this._size=new l$M_(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},l$_.getPixels=function(){return new Uint8Array(this._buffer)},l$_.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(l$$.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},l$h(0,l$_,"src",function(){return this._src}),l$I.create=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){if(void 0===l$r&&(l$r=9729),void 0===l$b&&(l$b=9729),void 0===l$z&&(l$z=!0),!l$i||l$i.byteLength<l$_*l$R*4)throw"DataTexture2D create error";var l$w=new l$I;return l$w.uri=l$L,l$w._buffer=l$i,l$w._width=l$_,l$w._height=l$R,l$w._mipmap=l$z,l$w._magFifter=l$r,l$w._minFifter=l$b,l$w._size=new l$M_(l$w._width,l$w._height),l$w._conchTexture?alert("怎么给runtime传递datatexture数据"):l$w.activeResource(),l$w},l$I.load=function(l$i,l$_,l$R,l$r,l$b){if(void 0===l$_&&(l$_=0),void 0===l$R&&(l$R=0),void 0===l$r&&(l$r=9729),void 0===l$b&&(l$b=9729),"mipmaps"===l$j.getFileExtension(l$i)){var l$z=l$c.loader.create(l$i,null,null,l$I,[function(l$i){this._mipmaps=[];var l$_=new Uint32Array(l$i);this._width=l$_[0];var l$R=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,l$R=1024),this._width!=l$R)throw"现在只支持512x256的环境贴图。当前的是"+l$_[0];this._height=l$_[1];for(var l$r=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,l$b=this._height,l$z=8;;){var l$L=l$r*l$b*4;if(l$z+l$L>l$i.byteLength)throw"load mipmaps data size error ";var l$w=new Uint8Array(l$i,l$z,l$L);if(this._mipmaps.push(l$w),l$z+=l$L,1==l$r&&1==l$b)break;(l$r/=2)<1&&(l$r=1),(l$b/=2)<1&&(l$b=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){l$z.simLodInfo=new Float32Array(40);for(var l$L=0;l$L<l$z.simLodInfo.length;)l$z.simLodInfo[l$L]=(l$I.simLodRect[l$L]+.5)/1024,l$L++,l$z.simLodInfo[l$L]=(l$I.simLodRect[l$L]+.5)/256,l$L++,l$z.simLodInfo[l$L]=Math.max(l$I.simLodRect[l$L]-1,.1)/1024,l$L++,l$z.simLodInfo[l$L]=Math.max(l$I.simLodRect[l$L]-1.5,.1)/256,l$L++}return l$z}if("number"==typeof l$_)return l$c.loader.create(l$i,null,null,l$I,[function(l$i){return this._width=l$_,this._height=l$R,this._buffer=l$i,null}]);if("function"==typeof l$_)return l$c.loader.create(l$i,null,null,l$I,[l$_]);throw new Error("unknown params.")},l$I.lodasatlas=!1,l$n(l$I,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),l$I}(),l$C_=function(l$i){function l$_(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,l$_.__super.call(this)}l$J(l$_,"laya.d3.resource.models.PrimitiveMesh",l$G_);var l$R=l$_.prototype;return l$c.imps(l$R,{"laya.d3.core.render.IRenderable":!0}),l$R._getVertexBuffer=function(l$i){return void 0===l$i&&(l$i=0),0===l$i?this._vertexBuffer:null},l$R._getVertexBuffers=function(){return null},l$R._getIndexBuffer=function(){return this._indexBuffer},l$R._getPositions=function(){var l$i,l$_=[],l$R=this._vertexBuffer.vertexDeclaration.getVertexElements(),l$r=0;for(l$r=0;l$r<l$R.length;l$r++){var l$b=l$R[l$r];if("vector3"===l$b.elementFormat&&0===l$b.elementUsage){l$i=l$b;break}}var l$z=this._vertexBuffer.getData();for(l$r=0;l$r<l$z.length;l$r+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var l$L=l$r+l$i.offset/4,l$w=new l$L_(l$z[l$L+0],l$z[l$L+1],l$z[l$L+2]);l$_.push(l$w)}return l$_},l$R.getRenderElement=function(l$i){return this},l$R.getRenderElementsCount=function(){return 1},l$R.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},l$R._beforeRender=function(l$i){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},l$R._render=function(l$i){l$$.mainContext.drawElements(4,this._numberIndices,5123,0),l$Z.drawCall++,l$Z.trianglesFaces+=this._numberIndices/3},l$h(0,l$R,"_vertexBufferCount",function(){return 1}),l$h(0,l$R,"triangleCount",function(){return this._indexBuffer.indexCount/3}),l$_}(),l$m_=function(l$i){function l$_(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,l$_.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}l$J(l$_,"laya.d3.resource.models.Mesh",l$G_);var l$R=l$_.prototype;return l$R._getPositions=function(){var l$i,l$_,l$R,l$r,l$b,l$z=[],l$L=0,l$w=0,l$x=0;if(0!==this._vertexBuffers.length){var l$P=this._vertexBuffers.length;for(l$L=0;l$L<l$P;l$L++){for(l$R=(l$i=this._vertexBuffers[l$L]).vertexDeclaration.getVertexElements(),l$w=0;l$w<l$R.length;l$w++)if("vector3"===(l$r=l$R[l$w]).elementFormat&&0===l$r.elementUsage){l$_=l$r;break}for(l$b=l$i.getData(),l$w=0;l$w<l$b.length;l$w+=l$i.vertexDeclaration.vertexStride/4)l$x=l$w+l$_.offset/4,l$z.push(new l$L_(l$b[l$x+0],l$b[l$x+1],l$b[l$x+2]))}}else{var l$B=this._subMeshes.length;for(l$L=0;l$L<l$B;l$L++){for(l$R=(l$i=this._subMeshes[l$L]._getVertexBuffer()).vertexDeclaration.getVertexElements(),l$w=0;l$w<l$R.length;l$w++)if("vector3"===(l$r=l$R[l$w]).elementFormat&&0===l$r.elementUsage){l$_=l$r;break}for(l$b=l$i.getData(),l$w=0;l$w<l$b.length;l$w+=l$i.vertexDeclaration.vertexStride/4)l$x=l$w+l$_.offset/4,l$z.push(new l$L_(l$b[l$x+0],l$b[l$x+1],l$b[l$x+2]))}}return l$z},l$R._setSubMeshes=function(l$i){this._subMeshes=l$i,this._subMeshCount=l$i.length;for(var l$_=0;l$_<this._subMeshCount;l$_++)l$i[l$_]._indexInMesh=l$_;this._positions=this._getPositions(),this._generateBoundingObject()},l$R.onAsynLoaded=function(l$i,l$_,l$R){var l$r=l$_[0],l$b=l$_[1];l$Fi.read(l$r,this,this._materials,this._subMeshes,l$b),this.completeCreate(),this._endLoaded()},l$R.getSubMesh=function(l$i){return this._subMeshes[l$i]},l$R.getSubMeshCount=function(){return this._subMeshes.length},l$R.getRenderElementsCount=function(){return this._subMeshes.length},l$R.getRenderElement=function(l$i){return this._subMeshes[l$i]},l$R.disposeResource=function(){for(var l$i=0;l$i<this._subMeshes.length;l$i++)this._subMeshes[l$i].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},l$h(0,l$R,"materials",function(){return this._materials.slice()}),l$h(0,l$R,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),l$_.load=function(l$i){return l$c.loader.create(l$i,null,null,l$_)},l$_}(),l$D_=(function(l$i){function l$P(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===l$R&&(l$R=6408),void 0===l$r&&(l$r=5121),void 0===l$b&&(l$b=33189),void 0===l$z&&(l$z=!1),void 0===l$L&&(l$L=!1),void 0===l$w&&(l$w=-1),void 0===l$x&&(l$x=-1),l$P.__super.call(this),this._type=3553,this._width=l$i,this._height=l$_,this._size=new l$M_(l$i,l$_),this._surfaceFormat=l$R,this._surfaceType=l$r,this._depthStencilFormat=l$b,l$M.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=l$z,this._repeat=l$L,this._minFifter=l$w,this._magFifter=l$x,this.activeResource(),this._alreadyResolved=!0}l$J(l$P,"laya.d3.resource.RenderTexture",l$$_);var l$_=l$P.prototype;l$_.recreateResource=function(){var l$i=l$$.mainContext;this._frameBuffer=l$i.createFramebuffer(),this._source=l$i.createTexture();var l$_=l$G.curBindTexTarget,l$R=l$G.curBindTexValue;l$G.bindTexture(l$i,this._type,this._source),l$i.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var l$r=this._minFifter,l$b=this._magFifter,l$z=this._repeat?10497:33071;if(l$e.isPOT(this._width,this._height)?(this._mipmap?-1!==l$r||(l$r=9987):-1!==l$r||(l$r=9729),-1!==l$b||(l$b=9729),l$i.texParameteri(this._type,10241,l$r),l$i.texParameteri(this._type,10240,l$b),l$i.texParameteri(this._type,10242,l$z),l$i.texParameteri(this._type,10243,l$z),this._mipmap&&l$i.generateMipmap(this._type)):(-1!==l$r||(l$r=9729),-1!==l$b||(l$b=9729),l$i.texParameteri(this._type,10241,l$r),l$i.texParameteri(this._type,10240,l$b),l$i.texParameteri(this._type,10242,33071),l$i.texParameteri(this._type,10243,33071)),l$_&&l$R&&l$G.bindTexture(l$i,l$_,l$R),l$i.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=l$i.createRenderbuffer(),l$i.bindRenderbuffer(36161,this._depthStencilBuffer),l$i.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),l$i.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:l$i.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:l$i.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:l$i.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}l$i.framebufferTexture2D(36160,36064,3553,this._source,0),l$i.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},l$_.start=function(){l$$.mainContext.bindFramebuffer(36160,this.frameBuffer),(l$P._currentRenderTarget=this)._alreadyResolved=!1},l$_.end=function(){l$$.mainContext.bindFramebuffer(36160,null),l$P._currentRenderTarget=null,this._alreadyResolved=!0},l$_.getData=function(l$i,l$_,l$R,l$r){var l$b=l$$.mainContext;if(l$b.bindFramebuffer(36160,this._frameBuffer),!(36053===l$b.checkFramebufferStatus(36160)))return l$b.bindFramebuffer(36160,null),null;var l$z=new Uint8Array(this._width*this._height*4);return l$b.readPixels(l$i,l$_,l$R,l$r,this._surfaceFormat,this._surfaceType,l$z),l$b.bindFramebuffer(36160,null),l$z},l$_.disposeResource=function(){if(this._frameBuffer){var l$i=l$$.mainContext;l$i.deleteTexture(this._source),l$i.deleteFramebuffer(this._frameBuffer),l$i.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},l$h(0,l$_,"surfaceFormat",function(){return this._surfaceFormat}),l$h(0,l$_,"surfaceType",function(){return this._surfaceType}),l$h(0,l$_,"depthStencilFormat",function(){return this._depthStencilFormat}),l$h(0,l$_,"source",function(){return this._alreadyResolved?l$c.superGet(l$$_,this,"source"):null}),l$h(0,l$_,"depthStencilBuffer",function(){return this._depthStencilBuffer}),l$h(0,l$_,"frameBuffer",function(){return this._frameBuffer}),l$P._currentRenderTarget=null}(),function(l$i){function l$_(l$i){this._color=null,this._pixels=null,l$_.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new l$M_(this.width,this.height),this._color=l$i,this._pixels=new Uint8Array([255*l$i.x,255*l$i.y,255*l$i.z,255*l$i.w]),this.uri="SolidColorTexture2D_"+this.id}l$J(l$_,"laya.d3.resource.SolidColorTexture2D",l$$_);var l$R=l$_.prototype;return l$R._createWebGlTexture=function(){var l$i=l$$.mainContext,l$_=this._source=l$i.createTexture(),l$R=this._width,l$r=this._height,l$b=l$G.curBindTexTarget,l$z=l$G.curBindTexValue;l$G.bindTexture(l$i,this._type,l$_),l$i.texImage2D(this._type,0,6408,l$R,l$r,0,6408,5121,this._pixels);var l$L=this._minFifter,l$w=this._magFifter,l$x=this._repeat?10497:33071,l$P=l$e.isPOT(l$R,l$r);l$P?(this._mipmap?-1!==l$L||(l$L=9987):-1!==l$L||(l$L=9729),-1!==l$w||(l$w=9729),l$i.texParameteri(this._type,10241,l$L),l$i.texParameteri(this._type,10240,l$w),l$i.texParameteri(this._type,10242,l$x),l$i.texParameteri(this._type,10243,l$x),this._mipmap&&l$i.generateMipmap(this._type)):(-1!==l$L||(l$L=9729),-1!==l$w||(l$w=9729),l$i.texParameteri(this._type,10241,l$L),l$i.texParameteri(this._type,10240,l$w),l$i.texParameteri(this._type,10242,33071),l$i.texParameteri(this._type,10243,33071)),l$b&&l$z&&l$G.bindTexture(l$i,l$b,l$z),this.memorySize=l$P?l$R*l$r*4*(1+1/3):l$R*l$r*4},l$R.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},l$R.disposeResource=function(){this._source&&(l$$.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},l$n(l$_,["magentaTexture",function(){var l$i=new l$_(new l$w_(1,0,1,1));return l$i.lock=!0,this.magentaTexture=l$i},"grayTexture",function(){var l$i=new l$_(new l$w_(.5,.5,.5,1));return l$i.lock=!0,this.grayTexture=l$i}]),l$_}()),l$U_=function(l$i){function l$b(l$i,l$_,l$R,l$r){this._canRead=!1,this._image=null,this._pixels=null,void 0===l$i&&(l$i=!1),void 0===l$_&&(l$_=!0),void 0===l$R&&(l$R=6408),void 0===l$r&&(l$r=!0),l$b.__super.call(this),this._type=3553,this._repeat=l$_,this._canRead=l$i,this._format=l$R,this._mipmap=l$r}l$J(l$b,"laya.d3.resource.Texture2D",l$$_);var l$_=l$b.prototype;return l$_._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var l$i=l$$.mainContext,l$_=this._source=l$i.createTexture(),l$R=this._width,l$r=this._height,l$b=l$G.curBindTexTarget,l$z=l$G.curBindTexValue;switch(l$G.bindTexture(l$i,this._type,l$_),this._format){case 6407:case 6408:this._canRead?l$i.texImage2D(this._type,0,this._format,l$R,l$r,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?l$i.texImage2D(this._type,0,this._image._format,l$R,l$r,0,this._image._format,5121,this._image.atlasSource):l$i.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case l$$.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:l$i.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var l$L=this._minFifter,l$w=this._magFifter,l$x=this._repeat?10497:33071,l$P=0==this._wrapModeU?10497:33071,l$B=0==this._wrapModeV?10497:33071,l$n=l$e.isPOT(l$R,l$r);l$n?(this._mipmap?-1!==l$L||(l$L=9987):-1!==l$L||(l$L=9729),-1!==l$w||(l$w=9729),l$i.texParameteri(this._type,10241,l$L),l$i.texParameteri(this._type,10240,l$w),l$i.texParameteri(this._type,10242,l$x),l$i.texParameteri(this._type,10243,l$x),l$i.texParameteri(this._type,10242,l$P),l$i.texParameteri(this._type,10243,l$B),this._mipmap&&l$i.generateMipmap(this._type)):(-1!==l$L||(l$L=9729),-1!==l$w||(l$w=9729),l$i.texParameteri(this._type,10241,l$L),l$i.texParameteri(this._type,10240,l$w),l$i.texParameteri(this._type,10242,33071),l$i.texParameteri(this._type,10243,33071)),l$b&&l$z&&l$G.bindTexture(l$i,l$b,l$z),this._image.onload=null,this._image=null,this.memorySize=l$n?l$R*l$r*4*(1+1/3):l$R*l$r*4},l$_.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},l$_.onAsynLoaded=function(l$i,l$_,l$R){if(l$R){var l$r=l$R[0];void 0!==l$r&&(this._canRead=l$r);var l$b=l$R[1];void 0!==l$b&&(this._repeat=l$b);var l$z=l$R[2];void 0!==l$z&&(this._format=l$z);var l$L=l$R[3];void 0!==l$L&&(this._mipmap=l$L);var l$w=l$R.wrapModeU;void 0!==l$w&&(this._wrapModeU=l$w);var l$x=l$R.wrapModeV;void 0!==l$x&&(this._wrapModeV=l$x)}switch(this._format){case 6407:case 6408:var l$P=(this._image=l$_).width,l$B=l$_.height;this._width=l$P,this._height=l$B,this._size=new l$M_(l$P,l$B),this._canRead&&(l$M.isConchApp?l$_ instanceof l$f.HTMLElement&&(this._pixels=new Uint8Array(l$_.getImageData(0,0,l$P,l$B))):(l$u.canvas.size(l$P,l$B),l$u.canvas.clear(),l$u.context.drawImage(l$_,0,0,l$P,l$B),this._pixels=new Uint8Array(l$u.context.getImageData(0,0,l$P,l$B).data.buffer)));break;case l$$.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var l$n=new l$l(l$_);l$n.readUTFBytes(4),l$n.readUTFBytes(2),l$n.getInt16();l$n.endian="bigEndian",this._width=l$n.getInt16(),this._height=l$n.getInt16(),this._size=new l$M_(this._width,this._height);l$n.getInt16(),l$n.getInt16();this._image=new Uint8Array(l$_,l$n.pos)}this.recreateResource(),this._endLoaded()},l$_.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},l$_.disposeResource=function(){this._source&&(l$$.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},l$h(0,l$_,"_src",function(){return this.url}),l$h(0,l$_,"src",function(){return this.url}),l$b.load=function(l$i){return l$c.loader.create(l$i,null,null,l$b)},l$b}(),l$g_=function(l$_){function l$R(l$i,l$_){l$R.__super.call(this),void 0===l$i&&(l$i=.3),void 0===l$_&&(l$_=1e3),this._tempVector3=new l$L_,this._position=new l$L_,this._up=new l$L_,this._forward=new l$L_,this._right=new l$L_,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=l$M_.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=l$i,this._farPlane=l$_,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),l$c.stage.on("resize",this,this._onScreenSizeChanged)}l$J(l$R,"laya.d3.core.BaseCamera",l$_);var l$i=l$R.prototype;return l$i._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var l$i=this.scene._cameraPool,l$_=l$i.length-1,l$R=0;l$R<l$_;l$R++)if(l$i[l$R].renderingOrder>l$i[l$_].renderingOrder){var l$r=l$i[l$R];l$i[l$R]=l$i[l$_],l$i[l$_]=l$r}},l$i._calculateProjectionMatrix=function(){},l$i._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},l$i._prepareCameraToRender=function(){l$o._currentCameraCullingMask=this.cullingMask;var l$i=this._shaderValues;l$i.setValue(0,this.transform.position.elements),l$i.setValue(5,this.forward.elements),l$i.setValue(6,this.up.elements)},l$i._prepareCameraViewProject=function(l$i,l$_){var l$R=this._shaderValues;l$R.setValue(1,l$i.elements),l$R.setValue(2,l$_.elements)},l$i._renderCamera=function(l$i,l$_,l$R){},l$i.addLayer=function(l$i){29!==l$i.number&&30!=l$i.number&&(this.cullingMask=this.cullingMask|l$i.mask)},l$i.removeLayer=function(l$i){29!==l$i.number&&30!=l$i.number&&(this.cullingMask=this.cullingMask&~l$i.mask)},l$i.addAllLayers=function(){this.cullingMask=2147483647},l$i.removeAllLayers=function(){this.cullingMask=0|l$o.getLayerByNumber(29).mask|l$o.getLayerByNumber(30).mask},l$i.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},l$i.moveForward=function(l$i){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=l$i,this.transform.translate(this._tempVector3)},l$i.moveRight=function(l$i){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=l$i,this.transform.translate(this._tempVector3)},l$i.moveVertical=function(l$i){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=l$i,this.transform.translate(this._tempVector3,!1)},l$i._addSelfRenderObjects=function(){var l$i=this.scene._cameraPool,l$_=l$i.length;if(0<l$_){for(var l$R=l$_-1;0<=l$R;l$R--)if(this.renderingOrder<=l$i[l$R].renderingOrder){l$i.splice(l$R+1,0,this);break}}else l$i.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},l$i._clearSelfRenderObjects=function(){var l$i=this.scene._cameraPool;l$i.splice(l$i.indexOf(this),1)},l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,l$c.stage.off("resize",this,this._onScreenSizeChanged),l$_.prototype.destroy.call(this,l$i)},l$h(0,l$i,"sky",function(){return this._sky},function(l$i){(this._sky=l$i)._ownerCamera=this}),l$h(0,l$i,"forward",function(){var l$i=this.transform.worldMatrix.elements,l$_=this._forward.elements;return l$_[0]=-l$i[8],l$_[1]=-l$i[9],l$_[2]=-l$i[10],this._forward}),l$h(0,l$i,"position",function(){var l$i=this.transform.worldMatrix.elements,l$_=this._position.elements;return l$_[0]=l$i[12],l$_[1]=l$i[13],l$_[2]=l$i[14],this._position}),l$h(0,l$i,"renderTarget",function(){return this._renderTarget},function(l$i){null!=(this._renderTarget=l$i)&&(this._renderTargetSize=l$i.size)}),l$h(0,l$i,"up",function(){var l$i=this.transform.worldMatrix.elements,l$_=this._up.elements;return l$_[0]=l$i[4],l$_[1]=l$i[5],l$_[2]=l$i[6],this._up}),l$h(0,l$i,"right",function(){var l$i=this.transform.worldMatrix.elements,l$_=this._right.elements;return l$_[0]=l$i[0],l$_[1]=l$i[1],l$_[2]=l$i[2],this._right}),l$h(0,l$i,"renderTargetSize",function(){return this._renderTargetSize},function(l$i){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=l$i,this._calculateProjectionMatrix()}),l$h(0,l$i,"fieldOfView",function(){return this._fieldOfView},function(l$i){this._fieldOfView=l$i,this._calculateProjectionMatrix()}),l$h(0,l$i,"nearPlane",function(){return this._nearPlane},function(l$i){this._nearPlane=l$i,this._calculateProjectionMatrix()}),l$h(0,l$i,"farPlane",function(){return this._farPlane},function(l$i){this._farPlane=l$i,this._calculateProjectionMatrix()}),l$h(0,l$i,"orthographic",function(){return this._orthographic},function(l$i){this._orthographic=l$i,this._calculateProjectionMatrix()}),l$h(0,l$i,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(l$i){this._orthographicVerticalSize=l$i,this._calculateProjectionMatrix()}),l$h(0,l$i,"renderingOrder",function(){return this._renderingOrder},function(l$i){this._renderingOrder=l$i,this._sortCamerasByRenderingOrder()}),l$R.CAMERAPOS=0,l$R.VIEWMATRIX=1,l$R.PROJECTMATRIX=2,l$R.VPMATRIX=3,l$R.VPMATRIX_NO_TRANSLATE=4,l$R.CAMERADIRECTION=5,l$R.CAMERAUP=6,l$R.ENVIRONMENTDIFFUSE=7,l$R.ENVIRONMENTSPECULAR=8,l$R.SIMLODINFO=9,l$R.DIFFUSEIRRADMATR=10,l$R.DIFFUSEIRRADMATG=11,l$R.DIFFUSEIRRADMATB=12,l$R.HDREXPOSURE=13,l$R.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",l$R.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",l$R.CLEARFLAG_SOLIDCOLOR=0,l$R.CLEARFLAG_SKY=1,l$R.CLEARFLAG_DEPTHONLY=2,l$R.CLEARFLAG_NONE=3,l$n(l$R,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new l$i_(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new l$i_},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new l$i_}]),l$R}(l$k_),l$V_=function(l$R){function l$_(l$i){this._render=null,this._geometryFilter=null,l$_.__super.call(this,l$i)}l$J(l$_,"laya.d3.core.RenderableSprite3D",l$R);var l$i=l$_.prototype;return l$i._addToInitStaticBatchManager=function(){},l$i._setBelongScene=function(l$i){l$R.prototype._setBelongScene.call(this,l$i),l$i._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},l$i._setUnBelongScene=function(){var l$i=this._scene._renderableSprite3Ds,l$_=l$i.indexOf(this);l$i.splice(l$_,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),l$R.prototype._setUnBelongScene.call(this)},l$i._update=function(l$i){(l$i.owner=this)._activeInHierarchy&&(this._updateComponents(l$i),this._render._updateOctreeNode(),this._lateUpdateComponents(l$i),l$Z.spriteCount++,this._childs.length&&this._updateChilds(l$i))},l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),l$R.prototype.destroy.call(this,l$i),this._render._destroy(),this._render=null},l$_.__init__=function(){l$_.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=l$_.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),l$_.SAHDERDEFINE_LIGHTMAP=l$_.shaderDefines.registerDefine("LIGHTMAP")},l$_.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,l$_.SAHDERDEFINE_LIGHTMAP=4,l$_.LIGHTMAPSCALEOFFSET=2,l$_.LIGHTMAP=3,l$n(l$_,["shaderDefines",function(){return this.shaderDefines=new l$B_}]),l$_}(l$k_),l$y_=(function(l$i){function l$r(l$i,l$_,l$R){this._long=NaN,this._width=NaN,this._height=NaN,void 0===l$i&&(l$i=1),void 0===l$_&&(l$_=1),void 0===l$R&&(l$R=1),l$r.__super.call(this),this._long=l$i,this._width=l$_,this._height=l$R,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}l$J(l$r,"laya.d3.resource.models.BoxMesh",l$C_);var l$_=l$r.prototype;l$_.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var l$i=l$$i.vertexDeclaration,l$_=(l$i.vertexStride,this._long/2),l$R=this._height/2,l$r=this._width/2,l$b=new Float32Array([-l$_,l$R,-l$r,0,1,0,0,0,l$_,l$R,-l$r,0,1,0,1,0,l$_,l$R,l$r,0,1,0,1,1,-l$_,l$R,l$r,0,1,0,0,1,-l$_,-l$R,-l$r,0,-1,0,0,1,l$_,-l$R,-l$r,0,-1,0,1,1,l$_,-l$R,l$r,0,-1,0,1,0,-l$_,-l$R,l$r,0,-1,0,0,0,-l$_,l$R,-l$r,-1,0,0,0,0,-l$_,l$R,l$r,-1,0,0,1,0,-l$_,-l$R,l$r,-1,0,0,1,1,-l$_,-l$R,-l$r,-1,0,0,0,1,l$_,l$R,-l$r,1,0,0,1,0,l$_,l$R,l$r,1,0,0,0,0,l$_,-l$R,l$r,1,0,0,0,1,l$_,-l$R,-l$r,1,0,0,1,1,-l$_,l$R,l$r,0,0,1,0,0,l$_,l$R,l$r,0,0,1,1,0,l$_,-l$R,l$r,0,0,1,1,1,-l$_,-l$R,l$r,0,0,1,0,1,-l$_,l$R,-l$r,0,0,-1,1,0,l$_,l$R,-l$r,0,0,-1,0,0,l$_,-l$R,-l$r,0,0,-1,0,1,-l$_,-l$R,-l$r,0,0,-1,1,1]),l$z=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new l$s_(l$i,this._numberVertices,35044,!0),this._indexBuffer=new l$E_("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(l$b),this._indexBuffer.setData(l$z),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},l$h(0,l$_,"long",function(){return this._long},function(l$i){this._long!==l$i&&(this._long=l$i,this.releaseResource(),this.activeResource())}),l$h(0,l$_,"width",function(){return this._width},function(l$i){this._width!==l$i&&(this._width=l$i,this.releaseResource(),this.activeResource())}),l$h(0,l$_,"height",function(){return this._height},function(l$i){this._height!==l$i&&(this._height=l$i,this.releaseResource(),this.activeResource())})}(),function(l$i){function l$b(l$i,l$_,l$R,l$r){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===l$i&&(l$i=10),void 0===l$_&&(l$_=10),void 0===l$R&&(l$R=10),void 0===l$r&&(l$r=10),l$b.__super.call(this),this._long=l$i,this._width=l$_,this._stacks=l$R,this._slices=l$r,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}l$J(l$b,"laya.d3.resource.models.PlaneMesh",l$C_);var l$_=l$b.prototype;l$_.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var l$i=new Uint16Array(this._numberIndices),l$_=l$$i.vertexDeclaration,l$R=l$_.vertexStride/4,l$r=new Float32Array(this._numberVertices*l$R),l$b=this._long/2,l$z=this._width/2,l$L=this._long/this._stacks,l$w=this._width/this._slices,l$x=0,l$P=0;l$P<=this._slices;l$P++)for(var l$B=0;l$B<=this._stacks;l$B++)l$r[l$x++]=l$B*l$L-l$b,l$r[l$x++]=0,l$r[l$x++]=l$P*l$w-l$z,l$r[l$x++]=0,l$r[l$x++]=1,l$r[l$x++]=0,l$r[l$x++]=1*l$B/this._stacks,l$r[l$x++]=1*l$P/this._slices;var l$n=0;for(l$P=0;l$P<this._slices;l$P++)for(l$B=0;l$B<this._stacks;l$B++)l$i[l$n++]=(l$P+1)*(this._stacks+1)+l$B,l$i[l$n++]=l$P*(this._stacks+1)+l$B,l$i[l$n++]=(l$P+1)*(this._stacks+1)+l$B+1,l$i[l$n++]=l$P*(this._stacks+1)+l$B,l$i[l$n++]=l$P*(this._stacks+1)+l$B+1,l$i[l$n++]=(l$P+1)*(this._stacks+1)+l$B+1;this._vertexBuffer=new l$s_(l$_,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new l$E_("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData(l$r),this._indexBuffer.setData(l$i),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},l$h(0,l$_,"long",function(){return this._long},function(l$i){this._long!==l$i&&(this._long=l$i,this.releaseResource(),this.activeResource())}),l$h(0,l$_,"width",function(){return this._width},function(l$i){this._width!==l$i&&(this._width=l$i,this.releaseResource(),this.activeResource())}),l$h(0,l$_,"stacks",function(){return this._stacks},function(l$i){this._stacks!==l$i&&(this._stacks=l$i,this.releaseResource(),this.activeResource())}),l$h(0,l$_,"slices",function(){return this._slices},function(l$i){this._slices!==l$i&&(this._slices=l$i,this.releaseResource(),this.activeResource())})}(),function(l$i){function l$L(l$i,l$_,l$R){void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=.3),void 0===l$R&&(l$R=1e3),this._viewMatrix=new l$i_,this._projectionMatrix=new l$i_,this._projectionViewMatrix=new l$i_,this._viewport=new l$x_(0,0,0,0),this._normalizedViewport=new l$x_(0,0,1,1),this._aspectRatio=l$i,this._boundFrustumUpdate=!0,this._boundFrustum=new l$Qi(l$i_.DEFAULT),l$L.__super.call(this,l$_,l$R),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}l$J(l$L,"laya.d3.core.Camera",l$g_);var l$_=l$L.prototype;return l$_._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},l$_._parseCustomProps=function(l$i,l$_,l$R,l$r){var l$b=l$R.clearColor;this.clearColor=new l$w_(l$b[0],l$b[1],l$b[2],l$b[3]);var l$z=l$R.viewport;this.normalizedViewport=new l$x_(l$z[0],l$z[1],l$z[2],l$z[3])},l$_._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var l$i=this.orthographicVerticalSize*this.aspectRatio*.5,l$_=.5*this.orthographicVerticalSize;l$i_.createOrthoOffCenterRH(-l$i,l$i,-l$_,l$_,this.nearPlane,this.farPlane,this._projectionMatrix)}else l$i_.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},l$_._update=function(l$i){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,l$i)},l$_._renderCamera=function(l$i,l$_,l$R){var l$r,l$b;l$R.parallelSplitShadowMaps[0]&&l$R._renderShadowMap(l$i,l$_,this),(l$_.camera=this)._prepareCameraToRender(),l$R._preRenderUpdateComponents(l$_),l$r=l$_._viewMatrix=this.viewMatrix;var l$z=this._renderTarget;l$z?(l$z.start(),l$i_.multiply(l$g_._invertYScaleMatrix,this._projectionMatrix,l$g_._invertYProjectionMatrix),l$i_.multiply(l$g_._invertYScaleMatrix,this.projectionViewMatrix,l$g_._invertYProjectionViewMatrix),l$b=l$_._projectionMatrix=l$g_._invertYProjectionMatrix,l$_._projectionViewMatrix=l$g_._invertYProjectionViewMatrix):(l$b=l$_._projectionMatrix=this._projectionMatrix,l$_._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(l$r,l$b),l$_._viewport=this.viewport,l$R._preRenderScene(l$i,l$_,this.boundFrustum),l$R._clear(l$i,l$_),l$R._renderScene(l$i,l$_),l$R._postRenderUpdateComponents(l$_),l$z&&l$z.end()},l$_.viewportPointToRay=function(l$i,l$_){l$h_.calculateCursorRay(l$i,this.viewport,this._projectionMatrix,this.viewMatrix,null,l$_)},l$_.normalizedViewportPointToRay=function(l$i,l$_){var l$R=l$L._tempVector20,l$r=this.viewport,l$b=l$i.elements,l$z=l$R.elements;l$z[0]=l$b[0]*l$r.width,l$z[1]=l$b[1]*l$r.height,l$h_.calculateCursorRay(l$R,this.viewport,this._projectionMatrix,this.viewMatrix,null,l$_)},l$_.worldToViewportPoint=function(l$i,l$_){l$i_.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(l$i,this._projectionViewMatrix,l$_);var l$R=l$_.elements;l$R[0]=l$R[0]/l$c.stage.clientScaleX,l$R[1]=l$R[1]/l$c.stage.clientScaleY},l$_.worldToNormalizedViewportPoint=function(l$i,l$_){l$i_.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(l$i,this._projectionViewMatrix,l$_);var l$R=l$_.elements;l$R[0]=l$R[0]/l$c.stage.clientScaleX,l$R[1]=l$R[1]/l$c.stage.clientScaleY},l$_.convertScreenCoordToOrthographicCoord=function(l$i,l$_){if(this._orthographic){var l$R=l$F.clientWidth,l$r=l$F.clientHeight,l$b=this.orthographicVerticalSize*this.aspectRatio/l$R,l$z=this.orthographicVerticalSize/l$r,l$L=l$i.elements,l$w=l$_.elements;return l$w[0]=(-l$R/2+l$L[0])*l$b,l$w[1]=(l$r/2-l$L[1])*l$z,l$w[2]=(this.nearPlane-this.farPlane)*(l$L[2]+1)/2-this.nearPlane,l$L_.transformCoordinate(l$_,this.transform.worldMatrix,l$_),!0}return!1},l$h(0,l$_,"projectionViewMatrix",function(){return l$i_.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),l$h(0,l$_,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var l$i=this.viewport;return l$i.width/l$i.height},function(l$i){if(l$i<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=l$i,this._calculateProjectionMatrix()}),l$h(0,l$_,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),l$h(0,l$_,"needViewport",function(){var l$i=this.normalizedViewport;return 0===l$i.x&&0===l$i.y&&1===l$i.width&&1===l$i.height}),l$h(0,l$_,"viewport",function(){if(this._viewportExpressedInClipSpace){var l$i=this._normalizedViewport,l$_=this.renderTargetSize,l$R=l$_.width,l$r=l$_.height;this._viewport.x=l$i.x*l$R,this._viewport.y=l$i.y*l$r,this._viewport.width=l$i.width*l$R,this._viewport.height=l$i.height*l$r}return this._viewport},function(l$i){if(null!=this.renderTarget&&(l$i.x<0||l$i.y<0||0==l$i.width||0==l$i.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=l$i,this._calculateProjectionMatrix()}),l$h(0,l$_,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var l$i=this._viewport,l$_=this.renderTargetSize,l$R=l$_.width,l$r=l$_.height;this._normalizedViewport.x=l$i.x/l$R,this._normalizedViewport.y=l$i.y/l$r,this._normalizedViewport.width=l$i.width/l$R,this._normalizedViewport.height=l$i.height/l$r}return this._normalizedViewport},function(l$i){l$i.x<0&&(l$i.x=0,console.warn("Camera: viewport.x must large than 0.0.")),l$i.y<0&&(l$i.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<l$i.x+l$i.width&&(l$i.width=1-l$i.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<l$i.y+l$i.height&&(l$i.height=1-l$i.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=l$i,this._calculateProjectionMatrix()}),l$h(0,l$_,"projectionMatrix",function(){return this._projectionMatrix},function(l$i){this._projectionMatrix=l$i,this._useUserProjectionMatrix=!0}),l$h(0,l$_,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),l$n(l$L,["_tempVector20",function(){return this._tempVector20=new l$z_}]),l$L}()),l$a_=function(l$R){function l$r(l$i,l$_){l$r.__super.call(this,l$_),this._geometryFilter=new l$u_(this),this._render=new l$o_(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),l$i&&(this._geometryFilter.sharedMesh=l$i)instanceof laya.d3.resource.models.Mesh&&(l$i.loaded?this._render.sharedMaterials=l$i.materials:l$i.once("loaded",this,this._applyMeshMaterials))}l$J(l$r,"laya.d3.core.MeshSprite3D",l$R);var l$i=l$r.prototype;return l$i._changeRenderObjectByMesh=function(l$i){var l$_=this._render._renderElements,l$R=l$_[l$i];l$R||(l$R=l$_[l$i]=new l$A_),l$R._render=this._render;var l$r=this._render.sharedMaterials[l$i];l$r||(l$r=l$O_.defaultMaterial);var l$b=this._geometryFilter.sharedMesh.getRenderElement(l$i);return l$R._mainSortID=this._getSortID(l$b,l$r),l$R._sprite3D=this,l$R.renderObj=l$b,l$R._material=l$r,l$R},l$i._changeRenderObjectByMaterial=function(l$i,l$_){var l$R=this._render._renderElements[l$i];l$_||(l$_=l$O_.defaultMaterial);var l$r=this._geometryFilter.sharedMesh.getRenderElement(l$i);return l$R._mainSortID=this._getSortID(l$r,l$_),l$R._sprite3D=this,l$R.renderObj=l$r,l$R._material=l$_,l$R},l$i._changeRenderObjectsByMesh=function(){var l$i=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=l$i;for(var l$_=0;l$_<l$i;l$_++)this._changeRenderObjectByMesh(l$_)},l$i._onMeshChanged=function(l$i){var l$_=l$i.sharedMesh;l$_.loaded?this._changeRenderObjectsByMesh():l$_.once("loaded",this,this._onMeshLoaded)},l$i._onMeshLoaded=function(l$i){l$i===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},l$i._onMaterialChanged=function(l$i,l$_,l$R){l$_<this._render._renderElements.length&&this._changeRenderObjectByMaterial(l$_,l$R)},l$i._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},l$i._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},l$i._parseCustomProps=function(l$i,l$_,l$R,l$r){var l$b=this.meshRender,l$z=l$R.lightmapIndex;null!=l$z&&(l$b.lightmapIndex=l$z);var l$L,l$w,l$x=l$R.lightmapScaleOffset;if(l$x&&(l$b.lightmapScaleOffset=new l$w_(l$x[0],l$x[1],l$x[2],l$x[3])),l$r.instanceParams)(l$L=l$r.instanceParams.loadPath)&&(l$w=l$X.getRes(l$_[l$L]),(this.meshFilter.sharedMesh=l$w).loaded?l$b.sharedMaterials=l$w.materials:l$w.once("loaded",this,this._applyMeshMaterials));else{(l$L=l$R.meshPath)&&(l$w=l$X.getRes(l$_[l$L]),this.meshFilter.sharedMesh=l$w);var l$P=l$R.materials;if(l$P){var l$B=l$b.sharedMaterials,l$n=l$P.length;l$B.length=l$n;for(var l$f=0;l$f<l$n;l$f++)l$B[l$f]=l$X.getRes(l$_[l$P[l$f].path]);l$b.sharedMaterials=l$B}}},l$i._applyMeshMaterials=function(l$i){for(var l$_=this._render.sharedMaterials,l$R=l$i.materials,l$r=0,l$b=l$R.length;l$r<l$b;l$r++)l$_[l$r]||(l$_[l$r]=l$R[l$r]);this._render.sharedMaterials=l$_},l$i._addToInitStaticBatchManager=function(){l$r._staticBatchManager._addInitBatchSprite(this)},l$i.cloneTo=function(l$i){var l$_=l$i;l$_._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var l$R=this._render,l$r=l$_._render;l$r.enable=l$R.enable,l$r.sharedMaterials=l$R.sharedMaterials,l$r.castShadow=l$R.castShadow;var l$b=l$R.lightmapScaleOffset;l$b&&(l$r.lightmapScaleOffset=l$b.clone()),l$r.lightmapIndex=l$R.lightmapIndex,l$r.receiveShadow=l$R.receiveShadow,l$r.sortingFudge=l$R.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,l$i)},l$i.destroy=function(l$i){if(void 0===l$i&&(l$i=!0),!this.destroyed){var l$_=this.meshFilter.sharedMesh;null!=l$_&&(l$_.loaded||l$_.off("loaded",this,this._applyMeshMaterials)),l$R.prototype.destroy.call(this,l$i),this._geometryFilter._destroy()}},l$h(0,l$i,"meshFilter",function(){return this._geometryFilter}),l$h(0,l$i,"meshRender",function(){return this._render}),l$r.__init__=function(){l$ri._staticBatchManagers.push(l$r._staticBatchManager)},l$r.load=function(l$i){return l$c.loader.create(l$i,null,null,l$r)},l$n(l$r,["_staticBatchManager",function(){return this._staticBatchManager=new l$q_}]),l$r}(l$V_)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(l$i,l$_){"use strict";for(var l$R in Object.defineProperty(l$_,"__esModule",{value:!0}),Laya){var l$r=Laya[l$R];l$r&&l$r.__isclass&&(l$_[l$R]=l$r)}}),function(l$i,l$_,l$bi){l$bi.un,l$bi.uns;var l$R=l$bi.static,l$r=l$bi.class,l$z=l$bi.getset,l$M=l$bi.__newvec,l$w=laya.maths.Bezier,l$n=laya.utils.Browser,l$$i=laya.utils.Byte,l$b=(laya.events.Event,laya.events.EventDispatcher),l$L=laya.display.Graphics,l$x=(laya.resource.HTMLCanvas,laya.utils.Handler),l$P=laya.net.Loader,l$f=laya.maths.MathUtil,l$Gi=laya.maths.Matrix,l$N=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),l$B=(laya.renders.RenderContext,laya.resource.Resource),l$J=laya.utils.RunDriver,l$zi=laya.display.Sprite,l$h=laya.utils.Stat,l$ui=laya.resource.Texture,l$X=(laya.net.URL,laya.utils.Utils),l$G=function(){function l$i(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return l$r(l$i,"laya.ani.AnimationContent"),l$i}(),l$u=function(){function l$i(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return l$r(l$i,"laya.ani.AnimationNodeContent"),l$i}(),l$I=function(){function l$i(){}return l$r(l$i,"laya.ani.AnimationParser01"),l$i.parse=function(l$i,l$_){var l$R=l$_.__getBuffer(),l$r=0,l$b=0,l$z=0,l$L=0,l$w=0,l$x=0,l$P=0,l$B=l$_.readUTFString();l$i._aniClassName=l$B;var l$n,l$f=l$_.readUTFString().split("\n"),l$J=l$_.getUint8(),l$h=l$_.getUint32(),l$M=l$_.getUint32();0<l$h&&(l$n=l$R.slice(l$h,l$M));var l$N=new l$$i(l$n);for(0<l$M&&(l$i._publicExtData=l$R.slice(l$M,l$R.byteLength)),l$i._useParent=!!l$_.getUint8(),l$i._anis.length=l$J,l$r=0;l$r<l$J;l$r++){var l$X=l$i._anis[l$r]=new l$G;l$X.nodes=new Array;var l$t=l$X.name=l$f[l$_.getUint16()];l$i._aniMap[l$t]=l$r,l$X.bone3DMap={},l$X.playTime=l$_.getFloat32(),l$X.playTime<=0&&console.error("播放时间不能为0  url="+l$i.url+" name="+l$X.name);var l$I=l$X.nodes.length=l$_.getUint8();for(l$b=l$X.totalKeyframeDatasLength=0;l$b<l$I;l$b++){var l$e=l$X.nodes[l$b]=new l$u;l$e.childs=[];var l$c=l$_.getInt16();0<=l$c&&(l$e.name=l$f[l$c],l$X.bone3DMap[l$e.name]=l$b),l$e.keyFrame=new Array,l$e.parentIndex=l$_.getInt16(),-1==l$e.parentIndex?l$e.parent=null:l$e.parent=l$X.nodes[l$e.parentIndex],l$e.lerpType=l$_.getUint8();var l$l=l$_.getUint32();l$N.pos=l$l;var l$A=l$e.keyframeWidth=l$N.getUint16();if(l$X.totalKeyframeDatasLength+=l$A,0===l$e.lerpType||1===l$e.lerpType)for(l$e.interpolationMethod=[],l$e.interpolationMethod.length=l$A,l$z=0;l$z<l$A;l$z++)l$e.interpolationMethod[l$z]=l$k.interpolation[l$N.getUint8()];null!=l$e.parent&&l$e.parent.childs.push(l$e);var l$Z=l$_.getUint16();0<l$Z&&(l$e.extenData=l$R.slice(l$_.pos,l$_.pos+l$Z),l$_.pos+=l$Z);var l$q,l$j=l$_.getUint16(),l$S=0;for(l$z=0,l$L=l$e.keyFrame.length=l$j;l$z<l$L;l$z++){if((l$q=l$e.keyFrame[l$z]=new l$o).duration=l$_.getFloat32(),l$q.startTime=l$S,2===l$e.lerpType){l$q.interpolationData=[];var l$v,l$$=l$_.getUint8();switch(l$v=l$_.getFloat32()){case 254:for(l$q.interpolationData.length=l$A,l$P=0;l$P<l$A;l$P++)l$q.interpolationData[l$P]=0;break;case 255:for(l$q.interpolationData.length=l$A,l$P=0;l$P<l$A;l$P++)l$q.interpolationData[l$P]=5;break;default:for(l$q.interpolationData.push(l$v),l$x=1;l$x<l$$;l$x++)l$q.interpolationData.push(l$_.getFloat32())}}for(l$q.data=new Float32Array(l$A),l$w=0;l$w<l$A;l$w++)l$q.data[l$w]=l$_.getFloat32(),-1e-8<l$q.data[l$w]&&l$q.data[l$w]<1e-8&&(l$q.data[l$w]=0);l$S+=l$q.duration}l$q.startTime=l$X.playTime,l$e.playTime=l$X.playTime,l$i._calculateKeyFrame(l$e,l$j,l$A)}}},l$i}(),l$e=function(){function l$c(){}return l$r(l$c,"laya.ani.AnimationParser02"),l$c.READ_DATA=function(){l$c._DATA.offset=l$c._reader.getUint32(),l$c._DATA.size=l$c._reader.getUint32()},l$c.READ_BLOCK=function(){for(var l$i=l$c._BLOCK.count=l$c._reader.getUint16(),l$_=l$c._BLOCK.blockStarts=[],l$R=l$c._BLOCK.blockLengths=[],l$r=0;l$r<l$i;l$r++)l$_.push(l$c._reader.getUint32()),l$R.push(l$c._reader.getUint32())},l$c.READ_STRINGS=function(){var l$i=l$c._reader.getUint32(),l$_=l$c._reader.getUint16(),l$R=l$c._reader.pos;l$c._reader.pos=l$i+l$c._DATA.offset;for(var l$r=0;l$r<l$_;l$r++)l$c._strings[l$r]=l$c._reader.readUTFString();l$c._reader.pos=l$R},l$c.parse=function(l$i,l$_){l$c._templet=l$i;(l$c._reader=l$_).__getBuffer();l$c.READ_DATA(),l$c.READ_BLOCK(),l$c.READ_STRINGS();for(var l$R=0,l$r=l$c._BLOCK.count;l$R<l$r;l$R++){var l$b=l$_.getUint16(),l$z=l$c._strings[l$b],l$L=l$c["READ_"+l$z];if(null==l$L)throw new Error("model file err,no this function:"+l$b+" "+l$z);l$L.call()}},l$c.READ_ANIMATIONS=function(){var l$i=l$c._reader,l$_=l$i.__getBuffer(),l$R=0,l$r=0,l$b=0,l$z=0,l$L=l$i.getUint16(),l$w=[];for(l$w.length=l$L,l$R=0;l$R<l$L;l$R++)l$w[l$R]=l$k.interpolation[l$i.getByte()];var l$x=l$i.getUint8();for(l$c._templet._anis.length=l$x,l$R=0;l$R<l$x;l$R++){var l$P=l$c._templet._anis[l$R]={};l$P.nodes=new Array;var l$B=l$P.name=l$c._strings[l$i.getUint16()];l$c._templet._aniMap[l$B]=l$R,l$P.bone3DMap={},l$P.playTime=l$i.getFloat32();var l$n=l$P.nodes.length=l$i.getInt16();for(l$r=l$P.totalKeyframeDatasLength=0;l$r<l$n;l$r++){var l$f=l$P.nodes[l$r]={};l$f.keyframeWidth=l$L,l$f.childs=[];var l$J=l$i.getUint16();0<=l$J&&(l$f.name=l$c._strings[l$J],l$P.bone3DMap[l$f.name]=l$r),l$f.keyFrame=new Array,l$f.parentIndex=l$i.getInt16(),-1==l$f.parentIndex?l$f.parent=null:l$f.parent=l$P.nodes[l$f.parentIndex],l$P.totalKeyframeDatasLength+=l$L,l$f.interpolationMethod=l$w,null!=l$f.parent&&l$f.parent.childs.push(l$f);var l$h=l$i.getUint16(),l$M=null,l$N=null;for(l$b=0,l$z=l$f.keyFrame.length=l$h;l$b<l$z;l$b++){(l$M=l$f.keyFrame[l$b]={}).startTime=l$i.getFloat32(),l$N&&(l$N.duration=l$M.startTime-l$N.startTime);var l$X=l$c._DATA.offset,l$t=l$i.getUint32(),l$I=4*l$L,l$e=l$_.slice(l$X+l$t,l$X+l$t+l$I);l$M.data=new Float32Array(l$e),l$N=l$M}l$M.duration=0,l$f.playTime=l$P.playTime,l$c._templet._calculateKeyFrame(l$f,l$h,l$L)}}},l$c._templet=null,l$c._reader=null,l$c._strings=[],l$R(l$c,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),l$c}(),l$oi=(function(){function l$i(){}l$r(l$i,"laya.ani.AnimationState"),l$i.stopped=0,l$i.paused=1,l$i.playing=2}(),function(){function l$b(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new l$Vi,this.resultMatrix=new l$Gi,this._children=[]}l$r(l$b,"laya.ani.bone.Bone");var l$i=l$b.prototype;return l$i.setTempMatrix=function(l$i){this._tempMatrix=l$i;var l$_,l$R=0;for(l$R=0,l$_=this._children.length;l$R<l$_;l$R++)this._children[l$R].setTempMatrix(this._tempMatrix)},l$i.update=function(l$i){var l$_;if(this.rotation=this.transform.skX,l$i)l$_=this.resultTransform.getMatrix(),l$Gi.mul(l$_,l$i,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)l$_=this.resultTransform.getMatrix(),l$Gi.mul(l$_,this.parentBone.resultMatrix,this.resultMatrix);else{var l$R=this.parentBone,l$r=NaN,l$b=NaN,l$z=NaN,l$L=this.parentBone.resultMatrix;l$_=this.resultTransform.getMatrix();var l$w=l$L.a*l$_.tx+l$L.c*l$_.ty+l$L.tx,l$x=l$L.b*l$_.tx+l$L.d*l$_.ty+l$L.ty,l$P=new l$Gi;this.inheritRotation?(l$r=Math.atan2(l$R.resultMatrix.b,l$R.resultMatrix.a),l$b=Math.cos(l$r),l$z=Math.sin(l$r),l$P.setTo(l$b,l$z,-l$z,l$b,0,0),l$Gi.mul(this._tempMatrix,l$P,l$Gi.TEMP),l$Gi.TEMP.copyTo(l$P),l$_=this.resultTransform.getMatrix(),l$Gi.mul(l$_,l$P,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,l$_=this.resultTransform.getMatrix(),l$Gi.TEMP.identity(),l$Gi.TEMP.d=this.d,l$Gi.mul(l$_,l$Gi.TEMP,this.resultMatrix)),this.resultMatrix.tx=l$w,this.resultMatrix.ty=l$x}else(l$_=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var l$B,l$n=0;for(l$n=0,l$B=this._children.length;l$n<l$B;l$n++)this._children[l$n].update()},l$i.updateChild=function(){var l$i,l$_=0;for(l$_=0,l$i=this._children.length;l$_<l$i;l$_++)this._children[l$_].update()},l$i.setRotation=function(l$i){this._sprite&&(this._sprite.rotation=180*l$i/Math.PI)},l$i.updateDraw=function(l$i,l$_){l$b.ShowBones&&!l$b.ShowBones[this.name]||(this._sprite||(this._sprite=new l$zi,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),l$bi.stage.addChild(this._sprite)),this._sprite.x=l$i+this.resultMatrix.tx,this._sprite.y=l$_+this.resultMatrix.ty);var l$R,l$r=0;for(l$r=0,l$R=this._children.length;l$r<l$R;l$r++)this._children[l$r].updateDraw(l$i,l$_)},l$i.addChild=function(l$i){this._children.push(l$i),l$i.parentBone=this},l$i.findBone=function(l$i){if(this.name==l$i)return this;var l$_,l$R,l$r=0;for(l$r=0,l$_=this._children.length;l$r<l$_;l$r++)if(l$R=this._children[l$r].findBone(l$i))return l$R;return null},l$i.localToWorld=function(l$i){var l$_=l$i[0],l$R=l$i[1];l$i[0]=l$_*this.resultMatrix.a+l$R*this.resultMatrix.c+this.resultMatrix.tx,l$i[1]=l$_*this.resultMatrix.b+l$R*this.resultMatrix.d+this.resultMatrix.ty},l$b.ShowBones={},l$b}()),l$pi=function(){function l$M(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}l$r(l$M,"laya.ani.bone.BoneSlot");var l$i=l$M.prototype;return l$i.showSlotData=function(l$i,l$_){void 0===l$_&&(l$_=!0),this.currSlotData=l$i,l$_&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},l$i.showDisplayByName=function(l$i){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(l$i))},l$i.replaceDisplayByName=function(l$i,l$_){if(this.currSlotData){var l$R;l$R=this.currSlotData.getDisplayByName(l$i);var l$r;l$r=this.currSlotData.getDisplayByName(l$_),this.replaceDisplayByIndex(l$R,l$r)}},l$i.replaceDisplayByIndex=function(l$i,l$_){this.currSlotData&&(this._replaceDic[l$i]=l$_,this.displayIndex==l$i&&this.showDisplayByIndex(l$i))},l$i.showDisplayByIndex=function(l$i){if(null!=this._replaceDic[l$i]&&(l$i=this._replaceDic[l$i]),this.currSlotData&&-1<l$i&&l$i<this.currSlotData.displayArr.length){if(this.displayIndex=l$i,this.currDisplayData=this.currSlotData.displayArr[l$i],this.currDisplayData){var l$_=this.currDisplayData.name;this.currTexture=this.templet.getTexture(l$_),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!l$N.isConchApp||l$N.isConchApp&&"0.9.15"<l$zi.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},l$i.replaceSkin=function(l$i){this._diyTexture=l$i,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},l$i.setParentMatrix=function(l$i){this._parentMatrix=l$i},l$i.draw=function(l$i,l$_,l$R,l$r){if(void 0===l$R&&(l$R=!1),void 0===l$r&&(l$r=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var l$b,l$z=this.currTexture;switch(this._diyTexture&&(l$z=this._diyTexture),this.currDisplayData.type){case 0:if(l$i){var l$L=this.getDisplayMatrix();if(this._parentMatrix){var l$w=!1;if(l$L){var l$x;if(l$Gi.mul(l$L,this._parentMatrix,l$Gi.TEMP),l$x=l$R?(null==this._resultMatrix&&(this._resultMatrix=new l$Gi),this._resultMatrix):new l$Gi,!l$N.isWebGL&&this.currDisplayData.uvs||l$N.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var l$P=l$M._tempMatrix;l$P.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(l$P.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(l$w=!0,l$P.rotate(-Math.PI/2)),l$Gi.mul(l$P,l$Gi.TEMP,l$x)}else l$Gi.TEMP.copyTo(l$x);l$w?l$i.drawTexture(l$z,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,l$x):l$i.drawTexture(l$z,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,l$x)}}}break;case 1:if(null==(l$b=l$R?(null==this._skinSprite&&(this._skinSprite=l$M.createSkinMesh()),this._skinSprite):l$M.createSkinMesh()))return;var l$B;if(null==this.currDisplayData.bones){var l$n,l$f=this.currDisplayData.weights;this.deformData&&(l$f=this.deformData),l$n=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=l$A.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=l$A.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=l$f;this.currDisplayData.triangles.length;l$B=this.currDisplayData.triangles,l$b.init2(l$z,null,l$B,this._mVerticleArr,l$n);var l$J,l$h=this.getDisplayMatrix();if(this._parentMatrix)if(l$h)l$Gi.mul(l$h,this._parentMatrix,l$Gi.TEMP),l$J=l$R?(null==this._resultMatrix&&(this._resultMatrix=new l$Gi),this._resultMatrix):new l$Gi,l$Gi.TEMP.copyTo(l$J),l$b.transform=l$J}else this.skinMesh(l$_,l$b,l$r);l$i.drawSkin(l$b);break;case 2:if(null==(l$b=l$R?(null==this._skinSprite&&(this._skinSprite=l$M.createSkinMesh()),this._skinSprite):l$M.createSkinMesh()))return;this.skinMesh(l$_,l$b,l$r),l$i.drawSkin(l$b)}}},l$i.skinMesh=function(l$i,l$_,l$R){var l$r,l$b=this.currTexture,l$z=this.currDisplayData.bones;l$r=this._diyTexture?(l$b=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=l$A.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=l$A.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var l$L,l$w,l$x=this.currDisplayData.weights,l$P=this.currDisplayData.triangles,l$B=0,l$n=0,l$f=0,l$J=NaN,l$h=NaN,l$M=0,l$N=0,l$X=[],l$t=0,l$I=0;if(this.deformData&&0<this.deformData.length){var l$e=0;for(l$t=0,l$I=l$z.length;l$t<l$I;){for(l$f=l$z[l$t++]+l$t,l$n=l$B=0;l$t<l$f;l$t++)l$w=l$i[l$z[l$t]],l$J=l$x[l$M]+this.deformData[l$e++],l$h=l$x[l$M+1]+this.deformData[l$e++],l$N=l$x[l$M+2],l$B+=(l$J*l$w.a+l$h*l$w.c+l$w.tx)*l$N,l$n+=(l$J*l$w.b+l$h*l$w.d+l$w.ty)*l$N,l$M+=3;l$X.push(l$B,l$n)}}else for(l$t=0,l$I=l$z.length;l$t<l$I;){for(l$f=l$z[l$t++]+l$t,l$n=l$B=0;l$t<l$f;l$t++)l$w=l$i[l$z[l$t]],l$J=l$x[l$M],l$h=l$x[l$M+1],l$N=l$x[l$M+2],l$B+=(l$J*l$w.a+l$h*l$w.c+l$w.tx)*l$N,l$n+=(l$J*l$w.b+l$h*l$w.d+l$w.ty)*l$N,l$M+=3;l$X.push(l$B,l$n)}this._mVerticleArr=l$X,l$L=l$P,l$_.init2(l$b,null,l$L,this._mVerticleArr,l$r)},l$i.drawBonePoint=function(l$i){l$i&&this._parentMatrix&&l$i.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},l$i.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},l$i.getMatrix=function(){return this._resultMatrix},l$i.copy=function(){var l$i=new l$M;return l$i.type="copy",l$i.name=this.name,l$i.attachmentName=this.attachmentName,l$i.srcDisplayIndex=this.srcDisplayIndex,l$i.parent=this.parent,l$i.displayIndex=this.displayIndex,l$i.templet=this.templet,l$i.currSlotData=this.currSlotData,l$i.currTexture=this.currTexture,l$i.currDisplayData=this.currDisplayData,l$i},l$M.createSkinMesh=function(){return l$N.isWebGL||l$N.isConchApp?l$J.skinAniSprite():(l$N.isWebGL,null)},l$R(l$M,["_tempMatrix",function(){return this._tempMatrix=new l$Gi}]),l$M}(),l$ki=function(){function l$i(){this.skinName=null,this.deformSlotDataList=[]}return l$r(l$i,"laya.ani.bone.DeformAniData"),l$i}(),l$Ki=function(){function l$i(){this.deformSlotDisplayList=[]}return l$r(l$i,"laya.ani.bone.DeformSlotData"),l$i}(),l$Oi=function(){function l$i(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}l$r(l$i,"laya.ani.bone.DeformSlotDisplayData");var l$_=l$i.prototype;return l$_.binarySearch1=function(l$i,l$_){var l$R=0,l$r=l$i.length-2;if(0==l$r)return 1;for(var l$b=l$r>>>1;;){if(l$i[Math.floor(l$b+1)]<=l$_?l$R=l$b+1:l$r=l$b,l$R==l$r)return l$R+1;l$b=l$R+l$r>>>1}return 0},l$_.apply=function(l$i,l$_,l$R){if(void 0===l$R&&(l$R=1),l$i+=.05,!(this.timeList.length<=0)){var l$r=0;if(!(l$i<this.timeList[0])){var l$b=this.vectices[0].length,l$z=[],l$L=this.binarySearch1(this.timeList,l$i);if(this.frameIndex=l$L,l$i>=this.timeList[this.timeList.length-1]){var l$w=this.vectices[this.vectices.length-1];if(l$R<1)for(l$r=0;l$r<l$b;l$r++)l$z[l$r]+=(l$w[l$r]-l$z[l$r])*l$R;else for(l$r=0;l$r<l$b;l$r++)l$z[l$r]=l$w[l$r];this.deformData=l$z}else{this.tweenKeyList[this.frameIndex];var l$x=this.vectices[this.frameIndex-1],l$P=this.vectices[this.frameIndex],l$B=this.timeList[this.frameIndex-1],l$n=this.timeList[this.frameIndex];l$R=this.tweenKeyList[l$L-1]?(l$i-l$B)/(l$n-l$B):0;var l$f=NaN;for(l$r=0;l$r<l$b;l$r++)l$f=l$x[l$r],l$z[l$r]=l$f+(l$P[l$r]-l$f)*l$R;this.deformData=l$z}}}},l$i}(),l$Ei=function(){function l$i(){this.time=NaN,this.drawOrder=[]}return l$r(l$i,"laya.ani.bone.DrawOrderData"),l$i}(),l$si=function(){function l$i(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return l$r(l$i,"laya.ani.bone.EventData"),l$i}(),l$t=function(){function l$ri(l$i,l$_){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=l$i,this._targetBone=l$_[l$i.targetBoneIndex],this.isSpine=l$i.isSpine,null==this._bones&&(this._bones=[]);for(var l$R=this._bones.length=0,l$r=l$i.boneIndexs.length;l$R<l$r;l$R++)this._bones.push(l$_[l$i.boneIndexs[l$R]]);this.name=l$i.name,this.mix=l$i.mix,this.bendDirection=l$i.bendDirection}l$r(l$ri,"laya.ani.bone.IkConstraint");var l$i=l$ri.prototype;return l$i.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},l$i._applyIk1=function(l$i,l$_,l$R,l$r){var l$b=l$i.parentBone,l$z=1/(l$b.resultMatrix.a*l$b.resultMatrix.d-l$b.resultMatrix.b*l$b.resultMatrix.c),l$L=l$_-l$b.resultMatrix.tx,l$w=l$R-l$b.resultMatrix.ty,l$x=(l$L*l$b.resultMatrix.d-l$w*l$b.resultMatrix.c)*l$z-l$i.transform.x,l$P=(l$w*l$b.resultMatrix.a-l$L*l$b.resultMatrix.b)*l$z-l$i.transform.y,l$B=Math.atan2(l$P,l$x)*l$ri.radDeg-0-l$i.transform.skX;l$i.transform.scX<0&&(l$B+=180),180<l$B?l$B-=360:l$B<-180&&(l$B+=360),l$i.transform.skX=l$i.transform.skY=l$i.transform.skX+l$B*l$r,l$i.update()},l$i.updatePos=function(l$i,l$_){this._sp&&this._sp.pos(l$i,l$_)},l$i._applyIk2=function(l$i,l$_,l$R,l$r,l$b,l$z){if(0!=l$z){var l$L=l$i.resultTransform.x,l$w=l$i.resultTransform.y,l$x=l$i.transform.scX,l$P=l$i.transform.scY,l$B=l$_.transform.scX,l$n=0,l$f=0,l$J=0;l$J=l$x<0?(l$x=-l$x,l$n=180,-1):(l$n=0,1),l$P<0&&(l$P=-l$P,l$J=-l$J),l$f=l$B<0?(l$B=-l$B,180):0;var l$h=l$_.resultTransform.x,l$M=NaN,l$N=NaN,l$X=NaN,l$t=l$i.resultMatrix.a,l$I=l$i.resultMatrix.c,l$e=l$i.resultMatrix.b,l$c=l$i.resultMatrix.d,l$l=Math.abs(l$x-l$P)<=1e-4;l$X=l$l?(l$N=l$t*l$h+l$I*(l$M=l$_.resultTransform.y)+l$i.resultMatrix.tx,l$e*l$h+l$c*l$M+l$i.resultMatrix.ty):(l$M=0,l$N=l$t*l$h+l$i.resultMatrix.tx,l$e*l$h+l$i.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new l$zi,l$bi.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(l$R,l$r,15,"#ffff00"),this._sp.graphics.drawCircle(l$N,l$X,15,"#ff00ff")),l$i.setRotation(Math.atan2(l$X-l$i.resultMatrix.ty,l$N-l$i.resultMatrix.tx));var l$A=l$i.parentBone;l$t=l$A.resultMatrix.a,l$I=l$A.resultMatrix.c,l$e=l$A.resultMatrix.b;var l$Z=1/(l$t*(l$c=l$A.resultMatrix.d)-l$I*l$e),l$q=l$R-l$A.resultMatrix.tx,l$j=l$r-l$A.resultMatrix.ty,l$S=(l$q*l$c-l$j*l$I)*l$Z-l$L,l$v=(l$j*l$t-l$q*l$e)*l$Z-l$w,l$$=((l$q=l$N-l$A.resultMatrix.tx)*l$c-(l$j=l$X-l$A.resultMatrix.ty)*l$I)*l$Z-l$L,l$G=(l$j*l$t-l$q*l$e)*l$Z-l$w,l$u=Math.sqrt(l$$*l$$+l$G*l$G),l$o=l$_.length*l$B,l$p=NaN,l$k=NaN;if(l$l){var l$K=(l$S*l$S+l$v*l$v-l$u*l$u-(l$o*=l$x)*l$o)/(2*l$u*l$o);l$K<-1?l$K=-1:1<l$K&&(l$K=1),l$k=Math.acos(l$K)*l$b,l$t=l$u+l$o*l$K,l$I=l$o*Math.sin(l$k),l$p=Math.atan2(l$v*l$t-l$S*l$I,l$S*l$t+l$v*l$I)}else{var l$O=(l$t=l$x*l$o)*l$t,l$E=(l$I=l$P*l$o)*l$I,l$s=l$S*l$S+l$v*l$v,l$Y=Math.atan2(l$v,l$S),l$C=-2*l$E*l$u,l$m=l$E-l$O;if(0<(l$c=l$C*l$C-4*l$m*(l$e=l$E*l$u*l$u+l$O*l$s-l$O*l$E))){var l$D=Math.sqrt(l$c);l$C<0&&(l$D=-l$D);var l$U=(l$D=-(l$C+l$D)/2)/l$m,l$g=l$e/l$D,l$V=Math.abs(l$U)<Math.abs(l$g)?l$U:l$g;l$V*l$V<=l$s&&(l$j=Math.sqrt(l$s-l$V*l$V)*l$b,l$p=l$Y-Math.atan2(l$j,l$V),l$k=Math.atan2(l$j/l$P,(l$V-l$u)/l$x))}var l$y=0,l$a=Number.MAX_VALUE,l$F=0,l$d=0,l$Q=0,l$H=0,l$W=0,l$T=0;l$H<(l$c=(l$q=l$u+l$t)*l$q)&&(l$Q=0,l$H=l$c,l$W=l$q),(l$c=(l$q=l$u-l$t)*l$q)<l$a&&(l$y=Math.PI,l$a=l$c,l$F=l$q);var l$ii=Math.acos(-l$t*l$u/(l$O-l$E));(l$c=(l$q=l$t*Math.cos(l$ii)+l$u)*l$q+(l$j=l$I*Math.sin(l$ii))*l$j)<l$a&&(l$y=l$ii,l$a=l$c,l$F=l$q,l$d=l$j),l$H<l$c&&(l$Q=l$ii,l$H=l$c,l$W=l$q,l$T=l$j),l$k=l$s<=(l$a+l$H)/2?(l$p=l$Y-Math.atan2(l$d*l$b,l$F),l$y*l$b):(l$p=l$Y-Math.atan2(l$T*l$b,l$W),l$Q*l$b)}var l$_i=Math.atan2(l$M,l$h)*l$J,l$Ri=l$i.resultTransform.skX;180<(l$p=(l$p-l$_i)*l$ri.radDeg+l$n-l$Ri)?l$p-=360:l$p<-180&&(l$p+=360),l$i.resultTransform.x=l$L,l$i.resultTransform.y=l$w,l$i.resultTransform.skX=l$i.resultTransform.skY=l$Ri+l$p*l$z,l$Ri=l$_.resultTransform.skX,180<(l$k=((l$k+l$_i)*l$ri.radDeg-0)*l$J+l$f-(l$Ri%=360))?l$k-=360:l$k<-180&&(l$k+=360),l$_.resultTransform.x=l$h,l$_.resultTransform.y=l$M,l$_.resultTransform.skX=l$_.resultTransform.skY=l$_.resultTransform.skY+l$k*l$z,l$i.update()}},l$i._applyIk3=function(l$i,l$_,l$R,l$r,l$b,l$z){if(0!=l$z){var l$L,l$w,l$x=l$_.resultMatrix.a*l$_.length,l$P=l$_.resultMatrix.b*l$_.length,l$B=l$x*l$x+l$P*l$P,l$n=Math.sqrt(l$B),l$f=l$i.resultMatrix.tx,l$J=l$i.resultMatrix.ty,l$h=l$_.resultMatrix.tx,l$M=l$_.resultMatrix.ty,l$N=l$h-l$f,l$X=l$M-l$J,l$t=l$N*l$N+l$X*l$X,l$I=Math.sqrt(l$t),l$e=(l$N=l$R-l$i.resultMatrix.tx)*l$N+(l$X=l$r-l$i.resultMatrix.ty)*l$X,l$c=Math.sqrt(l$e);if(l$n+l$I<=l$c||l$c+l$n<=l$I||l$c+l$I<=l$n){var l$l=NaN;l$h=l$f+(l$l=l$n+l$I<=l$c?1:-1)*(l$R-l$f)*l$I/l$c,l$M=l$J+l$l*(l$r-l$J)*l$I/l$c}else{var l$A=(l$t-l$B+l$e)/(2*l$e),l$Z=Math.sqrt(l$t-l$A*l$A*l$e)/l$c,l$q=l$f+l$N*l$A,l$j=l$J+l$X*l$A,l$S=-l$X*l$Z,l$v=l$N*l$Z;l$M=0<l$b?(l$h=l$q-l$S,l$j-l$v):(l$h=l$q+l$S,l$j+l$v)}l$L=l$h,l$w=l$M,this.isDebug&&(this._sp||(this._sp=new l$zi,l$bi.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(l$f,l$J,15,"#ff00ff"),this._sp.graphics.drawCircle(l$R,l$r,15,"#ffff00"),this._sp.graphics.drawCircle(l$L,l$w,15,"#ff00ff"));var l$$,l$G;l$$=Math.atan2(l$w-l$i.resultMatrix.ty,l$L-l$i.resultMatrix.tx),l$i.setRotation(l$$),(l$G=l$ri._tempMatrix).identity(),l$G.rotate(l$$),l$G.scale(l$i.resultMatrix.getScaleX(),l$i.resultMatrix.getScaleY()),l$G.translate(l$i.resultMatrix.tx,l$i.resultMatrix.ty),l$G.copyTo(l$i.resultMatrix),l$i.updateChild();var l$u,l$o;l$u=Math.atan2(l$r-l$w,l$R-l$L),l$_.setRotation(l$u),(l$o=l$ri._tempMatrix).identity(),l$o.rotate(l$u),l$o.scale(l$_.resultMatrix.getScaleX(),l$_.resultMatrix.getScaleY()),l$o.translate(l$L,l$w),l$G.copyTo(l$_.resultMatrix),l$_.updateChild()}},l$R(l$ri,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new l$Gi}]),l$ri}(),l$Yi=function(){function l$i(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return l$r(l$i,"laya.ani.bone.IkConstraintData"),l$i}(),l$c=function(){function l$o(l$i,l$_){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=l$i,this.position=l$i.position,this.spacing=l$i.spacing,this.rotateMix=l$i.rotateMix,this.translateMix=l$i.translateMix,this.bones=[];for(var l$R=this.data.bones,l$r=0,l$b=l$R.length;l$r<l$b;l$r++)this.bones.push(l$_[l$R[l$r]])}l$r(l$o,"laya.ani.bone.PathConstraint");var l$i=l$o.prototype;return l$i.apply=function(l$i,l$_){if(this.target){var l$R=this.translateMix,l$r=this.translateMix,l$b=0<l$r,l$z=this.data.spacingMode,l$L="length"==l$z,l$w=this.data.rotateMode,l$x="tangent"==l$w,l$P="chainScale"==l$w,l$B=[],l$n=this.bones.length,l$f=l$x?l$n:l$n+1,l$J=[];(this._spaces=l$J)[0]=this.position;var l$h=this.spacing;if(l$P||l$L)for(var l$M=0,l$N=l$f-1;l$M<l$N;){var l$X=this.bones[l$M],l$t=l$X.length,l$I=l$t*l$X.resultMatrix.a,l$e=l$t*l$X.resultMatrix.b;l$t=Math.sqrt(l$I*l$I+l$e*l$e),l$P&&(l$B[l$M]=l$t),l$J[++l$M]=l$L?Math.max(0,l$t+l$h):l$h}else for(l$M=1;l$M<l$f;l$M++)l$J[l$M]=l$h;var l$c=this.computeWorldPositions(this.target,l$i,l$_,l$f,l$x,"percent"==this.data.positionMode,"percent"==l$z);if(this._debugKey){for(l$M=0;l$M<l$c.length;l$M++)l$_.drawCircle(l$c[l$M++],l$c[l$M++],5,"#00ff00");var l$l=[];for(l$M=0;l$M<l$c.length;l$M++)l$l.push(l$c[l$M++],l$c[l$M++]);l$_.drawLines(0,0,l$l,"#ff0000")}var l$A=l$c[0],l$Z=l$c[1],l$q=this.data.offsetRotation,l$j="chain"==l$w&&0==l$q,l$S=NaN;for(l$M=0,l$S=3;l$M<l$n;l$M++,l$S+=3){(l$X=this.bones[l$M]).resultMatrix.tx+=(l$A-l$X.resultMatrix.tx)*l$R,l$X.resultMatrix.ty+=(l$Z-l$X.resultMatrix.ty)*l$R;var l$v=(l$I=l$c[l$S])-l$A,l$$=(l$e=l$c[l$S+1])-l$Z;if(l$P&&0!=(l$t=l$B[l$M])){var l$G=(Math.sqrt(l$v*l$v+l$$*l$$)/l$t-1)*l$r+1;l$X.resultMatrix.a*=l$G,l$X.resultMatrix.c*=l$G}if(l$A=l$I,l$Z=l$e,l$b){var l$u=l$X.resultMatrix.a,l$o=l$X.resultMatrix.c,l$p=l$X.resultMatrix.b,l$k=l$X.resultMatrix.d,l$K=NaN,l$O=NaN,l$E=NaN;l$K=l$x?l$c[l$S-1]:0==l$J[l$M+1]?l$c[l$S+2]:Math.atan2(l$$,l$v),l$K-=Math.atan2(l$p,l$u)-l$q/180*Math.PI,l$j&&(l$O=Math.cos(l$K),l$E=Math.sin(l$K),l$A+=((l$t=l$X.length)*(l$O*l$u-l$E*l$p)-l$v)*l$r,l$Z+=(l$t*(l$E*l$u+l$O*l$p)-l$$)*l$r),l$K>Math.PI?l$K-=2*Math.PI:l$K<-Math.PI&&(l$K+=2*Math.PI),l$K*=l$r,l$O=Math.cos(l$K),l$E=Math.sin(l$K),l$X.resultMatrix.a=l$O*l$u-l$E*l$p,l$X.resultMatrix.c=l$O*l$o-l$E*l$k,l$X.resultMatrix.b=l$E*l$u+l$O*l$p,l$X.resultMatrix.d=l$E*l$o+l$O*l$k}}}},l$i.computeWorldVertices2=function(l$i,l$_,l$R,l$r,l$b,l$z){var l$L,l$w,l$x=l$i.currDisplayData.bones,l$P=l$i.currDisplayData.weights,l$B=l$i.currDisplayData.triangles,l$n=0,l$f=0,l$J=0,l$h=0,l$M=0,l$N=0,l$X=0,l$t=0,l$I=0,l$e=0,l$c=0;if(null!=l$x){for(l$n=0;l$n<l$R;l$n+=2)l$f+=(l$h=l$x[l$f])+1,l$J+=l$h;var l$l=l$_;for(l$M=l$z,l$N=3*l$J;l$M<l$r;l$M+=2){for(l$t=l$X=0,l$h=l$x[l$f++],l$h+=l$f;l$f<l$h;l$f++,l$N+=3){l$L=l$l[l$x[l$f]].resultMatrix,l$I=l$P[l$N],l$e=l$P[l$N+1];var l$A=l$P[l$N+2];l$X+=(l$I*l$L.a+l$e*l$L.c+l$L.tx)*l$A,l$t+=(l$I*l$L.b+l$e*l$L.d+l$L.ty)*l$A}l$b[l$M]=l$X,l$b[l$M+1]=l$t}}else{var l$Z,l$q;if(l$B||(l$B=l$P),l$i.deformData&&(l$B=l$i.deformData),l$Z=l$i.parent,l$_)for(l$c=l$_.length,l$n=0;l$n<l$c;l$n++)if(l$_[l$n].name==l$Z){l$w=l$_[l$n];break}l$w&&(l$q=l$w.resultMatrix),l$q||(l$q=l$o._tempMt);var l$j=l$q.tx,l$S=l$q.ty,l$v=l$q.a,l$$=l$q.b,l$G=l$q.c,l$u=l$q.d;for(l$w&&(l$u*=l$w.d),l$f=l$R,l$M=l$z;l$M<l$r;l$f+=2,l$M+=2)l$I=l$B[l$f],l$e=l$B[l$f+1],l$b[l$M]=l$I*l$v+l$e*l$$+l$j,l$b[l$M+1]=-(l$I*l$G+l$e*l$u+l$S)}},l$i.computeWorldPositions=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L){l$i.currDisplayData.bones,l$i.currDisplayData.weights,l$i.currDisplayData.triangles;var l$w=[],l$x=0,l$P=l$i.currDisplayData.verLen,l$B=this.position,l$n=this._spaces,l$f=[],l$J=[],l$h=l$P/6,l$M=-1,l$N=NaN,l$X=0,l$t=0,l$I=NaN,l$e=NaN,l$c=NaN,l$l=NaN;if(l$h--,l$P-=4,this.computeWorldVertices2(l$i,l$_,2,l$P,l$w,0),this._debugKey)for(l$x=0;l$x<l$w.length;)l$R.drawCircle(l$w[l$x++],l$w[l$x++],10,"#ff0000");l$f=l$w,this._curves.length=l$h;var l$A=this._curves,l$Z=l$f[l$N=0],l$q=l$f[1],l$j=0,l$S=0,l$v=0,l$$=0,l$G=0,l$u=0,l$o=NaN,l$p=NaN,l$k=NaN,l$K=NaN,l$O=NaN,l$E=NaN,l$s=NaN,l$Y=NaN,l$C=0;for(l$x=0,l$C=2;l$x<l$h;l$x++,l$C+=6)l$j=l$f[l$C],l$S=l$f[l$C+1],l$v=l$f[l$C+2],l$$=l$f[l$C+3],l$O=2*(l$o=.1875*(l$Z-2*l$j+l$v))+(l$k=.09375*(3*(l$j-l$v)-l$Z+(l$G=l$f[l$C+4]))),l$E=2*(l$p=.1875*(l$q-2*l$S+l$$))+(l$K=.09375*(3*(l$S-l$$)-l$q+(l$u=l$f[l$C+5]))),l$s=.75*(l$j-l$Z)+l$o+.16666667*l$k,l$Y=.75*(l$S-l$q)+l$p+.16666667*l$K,l$N+=Math.sqrt(l$s*l$s+l$Y*l$Y),l$s+=l$O,l$Y+=l$E,l$O+=l$k,l$E+=l$K,l$N+=Math.sqrt(l$s*l$s+l$Y*l$Y),l$s+=l$O,l$Y+=l$E,l$N+=Math.sqrt(l$s*l$s+l$Y*l$Y),l$s+=l$O+l$k,l$Y+=l$E+l$K,l$N+=Math.sqrt(l$s*l$s+l$Y*l$Y),l$A[l$x]=l$N,l$Z=l$G,l$q=l$u;if(l$z&&(l$B*=l$N),l$L)for(l$x=0;l$x<l$r;l$x++)l$n[l$x]*=l$N;var l$m=this._segments,l$D=0,l$U=0;for(l$U=l$t=l$X=l$x=0;l$x<l$r;l$x++,l$X+=3)if((l$I=l$B+=l$e=l$n[l$x])<0)this.addBeforePosition(l$I,l$f,0,l$J,l$X);else if(l$N<l$I)this.addAfterPosition(l$I-l$N,l$f,l$P-4,l$J,l$X);else{for(;;l$t++)if(!((l$l=l$A[l$t])<l$I)){0==l$t?l$I/=l$l:l$I=(l$I-(l$c=l$A[l$t-1]))/(l$l-l$c);break}if(l$t!=l$M){var l$g=6*(l$M=l$t);for(l$Z=l$f[l$g],l$q=l$f[l$g+1],l$j=l$f[l$g+2],l$S=l$f[l$g+3],l$v=l$f[l$g+4],l$$=l$f[l$g+5],l$O=2*(l$o=.03*(l$Z-2*l$j+l$v))+(l$k=.006*(3*(l$j-l$v)-l$Z+(l$G=l$f[l$g+6]))),l$E=2*(l$p=.03*(l$q-2*l$S+l$$))+(l$K=.006*(3*(l$S-l$$)-l$q+(l$u=l$f[l$g+7]))),l$s=.3*(l$j-l$Z)+l$o+.16666667*l$k,l$Y=.3*(l$S-l$q)+l$p+.16666667*l$K,l$D=Math.sqrt(l$s*l$s+l$Y*l$Y),l$m[0]=l$D,l$g=1;l$g<8;l$g++)l$s+=l$O,l$Y+=l$E,l$O+=l$k,l$E+=l$K,l$D+=Math.sqrt(l$s*l$s+l$Y*l$Y),l$m[l$g]=l$D;l$s+=l$O,l$Y+=l$E,l$D+=Math.sqrt(l$s*l$s+l$Y*l$Y),l$m[8]=l$D,l$s+=l$O+l$k,l$Y+=l$E+l$K,l$D+=Math.sqrt(l$s*l$s+l$Y*l$Y),l$m[9]=l$D,l$U=0}for(l$I*=l$D;;l$U++)if(!((l$l=l$m[l$U])<l$I)){0==l$U?l$I/=l$l:l$I=l$U+(l$I-(l$c=l$m[l$U-1]))/(l$l-l$c);break}this.addCurvePosition(.1*l$I,l$Z,l$q,l$j,l$S,l$v,l$$,l$G,l$u,l$J,l$X,l$b||0<l$x&&0==l$e)}return l$J},l$i.addBeforePosition=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$_[l$R],l$L=l$_[l$R+1],l$w=l$_[l$R+2]-l$z,l$x=l$_[l$R+3]-l$L,l$P=Math.atan2(l$x,l$w);l$r[l$b]=l$z+l$i*Math.cos(l$P),l$r[l$b+1]=l$L+l$i*Math.sin(l$P),l$r[l$b+2]=l$P},l$i.addAfterPosition=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$_[l$R+2],l$L=l$_[l$R+3],l$w=l$z-l$_[l$R],l$x=l$L-l$_[l$R+1],l$P=Math.atan2(l$x,l$w);l$r[l$b]=l$z+l$i*Math.cos(l$P),l$r[l$b+1]=l$L+l$i*Math.sin(l$P),l$r[l$b+2]=l$P},l$i.addCurvePosition=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B,l$n){0==l$i&&(l$i=1e-4);var l$f=l$i*l$i,l$J=l$f*l$i,l$h=1-l$i,l$M=l$h*l$h,l$N=l$M*l$h,l$X=l$h*l$i,l$t=3*l$X,l$I=l$h*l$t,l$e=l$t*l$i,l$c=l$_*l$N+l$r*l$I+l$z*l$e+l$w*l$J,l$l=l$R*l$N+l$b*l$I+l$L*l$e+l$x*l$J;l$P[l$B]=l$c,l$P[l$B+1]=l$l,l$P[l$B+2]=l$n?Math.atan2(l$l-(l$R*l$M+l$b*l$X*2+l$L*l$f),l$c-(l$_*l$M+l$r*l$X*2+l$z*l$f)):0},l$o.NONE=-1,l$o.BEFORE=-2,l$o.AFTER=-3,l$R(l$o,["_tempMt",function(){return this._tempMt=new l$Gi}]),l$o}(),l$Ci=function(){function l$i(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return l$r(l$i,"laya.ani.bone.PathConstraintData"),l$i}(),l$mi=function(){function l$i(){this.name=null,this.slotArr=[]}return l$r(l$i,"laya.ani.bone.SkinData"),l$i}(),l$Di=function(){function l$i(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}l$r(l$i,"laya.ani.bone.SkinSlotDisplayData");var l$_=l$i.prototype;return l$_.createTexture=function(l$i){return this.texture||(this.texture=new l$ui(l$i.bitmap,this.uvs),l$i.bitmap.alphaTexture&&(this.texture.alphaTexture=new l$ui(l$i.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=l$i.height,this.texture.height=l$i.width,this.texture.offsetX=-l$i.offsetX,this.texture.offsetY=-l$i.offsetY,this.texture.sourceWidth=l$i.sourceHeight,this.texture.sourceHeight=l$i.sourceWidth):(this.texture.width=l$i.width,this.texture.height=l$i.height,this.texture.offsetX=-l$i.offsetX,this.texture.offsetY=-l$i.offsetY,this.texture.sourceWidth=l$i.sourceWidth,this.texture.sourceHeight=l$i.sourceHeight),l$N.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},l$_.destory=function(){this.texture&&this.texture.destroy()},l$i}(),l$Ui=function(){function l$i(){this.name=null,this.displayArr=[]}return l$r(l$i,"laya.ani.bone.SlotData"),l$i.prototype.getDisplayByName=function(l$i){for(var l$_=0,l$R=this.displayArr.length;l$_<l$R;l$_++)if(this.displayArr[l$_].attachmentName==l$i)return l$_;return-1},l$i}(),l$l=function(){function l$i(l$i,l$_){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=l$M(2,0),this._data=l$i,null==this._bones&&(this._bones=[]),this.target=l$_[l$i.targetIndex];var l$R,l$r=0;for(l$r=0,l$R=l$i.boneIndexs.length;l$r<l$R;l$r++)this._bones.push(l$_[l$i.boneIndexs[l$r]]);this.rotateMix=l$i.rotateMix,this.translateMix=l$i.translateMix,this.scaleMix=l$i.scaleMix,this.shearMix=l$i.shearMix}return l$r(l$i,"laya.ani.bone.TfConstraint"),l$i.prototype.apply=function(){for(var l$i,l$_=this.target.resultMatrix.a,l$R=this.target.resultMatrix.b,l$r=this.target.resultMatrix.c,l$b=this.target.resultMatrix.d,l$z=0,l$L=this._bones.length;l$z<l$L;l$z++){if(l$i=this._bones[l$z],0<this.rotateMix){var l$w=l$i.resultMatrix.a,l$x=l$i.resultMatrix.b,l$P=l$i.resultMatrix.c,l$B=l$i.resultMatrix.d,l$n=Math.atan2(l$r,l$_)-Math.atan2(l$P,l$w)+this._data.offsetRotation*Math.PI/180;l$n>Math.PI?l$n-=2*Math.PI:l$n<-Math.PI&&(l$n+=2*Math.PI),l$n*=this.rotateMix;var l$f=Math.cos(l$n),l$J=Math.sin(l$n);l$i.resultMatrix.a=l$f*l$w-l$J*l$P,l$i.resultMatrix.b=l$f*l$x-l$J*l$B,l$i.resultMatrix.c=l$J*l$w+l$f*l$P,l$i.resultMatrix.d=l$J*l$x+l$f*l$B}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),l$i.resultMatrix.tx+=(this._temp[0]-l$i.resultMatrix.tx)*this.translateMix,l$i.resultMatrix.ty+=(this._temp[1]-l$i.resultMatrix.ty)*this.translateMix,l$i.updateChild()),0<this.scaleMix){var l$h=Math.sqrt(l$i.resultMatrix.a*l$i.resultMatrix.a+l$i.resultMatrix.c*l$i.resultMatrix.c),l$M=Math.sqrt(l$_*l$_+l$r*l$r),l$N=1e-5<l$h?(l$h+(l$M-l$h+this._data.offsetScaleX)*this.scaleMix)/l$h:0;l$i.resultMatrix.a*=l$N,l$i.resultMatrix.c*=l$N,l$h=Math.sqrt(l$i.resultMatrix.b*l$i.resultMatrix.b+l$i.resultMatrix.d*l$i.resultMatrix.d),l$M=Math.sqrt(l$R*l$R+l$b*l$b),l$N=1e-5<l$h?(l$h+(l$M-l$h+this._data.offsetScaleY)*this.scaleMix)/l$h:0,l$i.resultMatrix.b*=l$N,l$i.resultMatrix.d*=l$N}if(0<this.shearMix){l$x=l$i.resultMatrix.b,l$B=l$i.resultMatrix.d;var l$X=Math.atan2(l$B,l$x);(l$n=Math.atan2(l$b,l$R)-Math.atan2(l$r,l$_)-(l$X-Math.atan2(l$i.resultMatrix.c,l$i.resultMatrix.a)))>Math.PI?l$n-=2*Math.PI:l$n<-Math.PI&&(l$n+=2*Math.PI),l$n=l$X+(l$n+this._data.offsetShearY*Math.PI/180)*this.shearMix,l$N=Math.sqrt(l$x*l$x+l$B*l$B),l$i.resultMatrix.b=Math.cos(l$n)*l$N,l$i.resultMatrix.d=Math.sin(l$n)*l$N}}},l$i}(),l$gi=function(){function l$i(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return l$r(l$i,"laya.ani.bone.TfConstraintData"),l$i}(),l$Vi=function(){function l$i(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}l$r(l$i,"laya.ani.bone.Transform");var l$_=l$i.prototype;return l$_.initData=function(l$i){null!=l$i.x&&(this.x=l$i.x),null!=l$i.y&&(this.y=l$i.y),null!=l$i.skX&&(this.skX=l$i.skX),null!=l$i.skY&&(this.skY=l$i.skY),null!=l$i.scX&&(this.scX=l$i.scX),null!=l$i.scY&&(this.scY=l$i.scY)},l$_.getMatrix=function(){var l$i;return(l$i=this.mMatrix?this.mMatrix:this.mMatrix=new l$Gi).identity(),l$i.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(l$i,this.skewX*Math.PI/180,this.skewY*Math.PI/180),l$i.rotate(this.skX*Math.PI/180),l$i.translate(this.x,this.y),l$i},l$_.skew=function(l$i,l$_,l$R){var l$r=Math.sin(l$R),l$b=Math.cos(l$R),l$z=Math.sin(l$_),l$L=Math.cos(l$_);return l$i.setTo(l$i.a*l$L-l$i.b*l$r,l$i.a*l$z+l$i.b*l$b,l$i.c*l$L-l$i.d*l$r,l$i.c*l$z+l$i.d*l$b,l$i.tx*l$L-l$i.ty*l$r,l$i.tx*l$z+l$i.ty*l$b),l$i},l$i}(),l$A=function(){function l$i(){}return l$r(l$i,"laya.ani.bone.UVTools"),l$i.getRelativeUV=function(l$i,l$_,l$R){var l$r=l$i[0],l$b=l$i[2]-l$i[0],l$z=l$i[1],l$L=l$i[5]-l$i[1];l$R||(l$R=[]),l$R.length=l$_.length;var l$w,l$x=0;l$w=l$R.length;var l$P=1/l$b,l$B=1/l$L;for(l$x=0;l$x<l$w;l$x+=2)l$R[l$x]=(l$_[l$x]-l$r)*l$P,l$R[l$x+1]=(l$_[l$x+1]-l$z)*l$B;return l$R},l$i.getAbsoluteUV=function(l$i,l$_,l$R){if(0==l$i[0]&&0==l$i[1]&&1==l$i[4]&&1==l$i[5])return l$R?(l$X.copyArray(l$R,l$_),l$R):l$_;var l$r=l$i[0],l$b=l$i[2]-l$i[0],l$z=l$i[1],l$L=l$i[5]-l$i[1];l$R||(l$R=[]),l$R.length=l$_.length;var l$w,l$x=0;for(l$w=l$R.length,l$x=0;l$x<l$w;l$x+=2)l$R[l$x]=l$_[l$x]*l$b+l$r,l$R[l$x+1]=l$_[l$x+1]*l$L+l$z;return l$R},l$i}(),l$o=function(){function l$i(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return l$r(l$i,"laya.ani.KeyFramesContent"),l$i}(),l$Z=function(){function l$B(){}return l$r(l$B,"laya.ani.math.BezierLerp"),l$B.getBezierRate=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$B._getBezierParamKey(l$_,l$R,l$r,l$b),l$L=100*l$z+l$i;if(l$B._bezierResultCache[l$L])return l$B._bezierResultCache[l$L];var l$w,l$x=l$B._getBezierPoints(l$_,l$R,l$r,l$b,l$z),l$P=0;for(l$w=l$x.length,l$P=0;l$P<l$w;l$P+=2)if(l$i<=l$x[l$P])return l$B._bezierResultCache[l$L]=l$x[l$P+1],l$x[l$P+1];return l$B._bezierResultCache[l$L]=1},l$B._getBezierParamKey=function(l$i,l$_,l$R,l$r){return 100*(100*(100*(100*l$i+l$_)+l$R)+l$r)},l$B._getBezierPoints=function(l$i,l$_,l$R,l$r,l$b){return l$B._bezierPointsCache[l$b]?l$B._bezierPointsCache[l$b]:(l$z=[0,0,l$i,l$_,l$R,l$r,1,1],l$L=(new l$w).getBezierPoints(l$z,100,3),l$B._bezierPointsCache[l$b]=l$L);var l$z,l$L},l$B._bezierResultCache={},l$B._bezierPointsCache={},l$B}(),l$q=function(l$i){function l$_(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,l$_.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}l$r(l$_,"laya.ani.AnimationPlayer",l$b);var l$R=l$_.prototype;return l$bi.imps(l$R,{"laya.resource.IDestroy":!0}),l$R._onTempletLoadedComputeFullKeyframeIndices=function(l$i,l$_,l$R){this._templet===l$R&&this._cachePlayRate===l$i&&this._cacheFrameRate===l$_&&this._computeFullKeyframeIndices()},l$R._computeFullKeyframeIndices=function(){for(var l$i=this._fullFrames=[],l$_=this._templet,l$R=this._cacheFrameRateInterval*this._cachePlayRate,l$r=0,l$b=l$_.getAnimationCount();l$r<l$b;l$r++){for(var l$z=[],l$L=0,l$w=l$_.getAnimation(l$r).nodes.length;l$L<l$w;l$L++){for(var l$x=l$_.getAnimation(l$r).nodes[l$L],l$P=Math.floor(l$x.playTime/l$R+.01),l$B=new Uint16Array(l$P+1),l$n=-1,l$f=0,l$J=l$x.keyFrame.length;l$f<l$J;l$f++){var l$h=l$x.keyFrame[l$f],l$M=l$h.startTime,l$N=l$M+l$h.duration+l$R;do{for(var l$X=Math.floor(l$M/l$R+.5),l$t=l$n+1;l$t<l$X;l$t++)l$B[l$t]=l$f;l$B[l$n=l$X]=l$f,l$M+=l$R}while(l$M<=l$N)}l$z.push(l$B)}l$i.push(l$z)}},l$R._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},l$R._calculatePlayDuration=function(){if(0!==this.state){var l$i=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=l$i),this._playEnd>l$i&&(this._playEnd=l$i),this._playDuration=this._playEnd-this._playStart}},l$R._setPlayParams=function(l$i,l$_){this._currentTime=l$i,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/l$_+.01),0),this._currentFrameTime=this._currentKeyframeIndex*l$_},l$R._setPlayParamsWhenStop=function(l$i,l$_){this._currentTime=l$i,this._currentKeyframeIndex=Math.max(Math.floor(l$i/l$_+.01),0),this._currentFrameTime=this._currentKeyframeIndex*l$_,this._currentAnimationClipIndex=-1},l$R._update=function(l$i){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var l$_=this._cacheFrameRateInterval*this._cachePlayRate,l$R=0;this._startUpdateLoopCount!==l$h.loopCount&&(l$R=l$i*this.playbackRate,this._elapsedPlaybackTime+=l$R);var l$r=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=l$r)return this._setPlayParamsWhenStop(l$r,l$_),void this.event("stopped");if(l$R+=this._currentTime,0<l$r)if(l$r<=l$R)do{if(l$R-=l$r,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(l$r,l$_),this._stopWhenCircleFinish=!1,void this.event("stopped");l$R<l$r&&(this._setPlayParams(l$R,l$_),this.event("complete"))}while(l$r<=l$R);else this._setPlayParams(l$R,l$_);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(l$r,l$_),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},l$R._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},l$R.play=function(l$i,l$_,l$R,l$r,l$b){if(void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=1),void 0===l$R&&(l$R=2147483647),void 0===l$r&&(l$r=0),void 0===l$b&&(l$b=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(l$R<0||l$r<0||l$b<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==l$b&&l$b<l$r)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=l$_,this._overallDuration=l$R,this._playStart=l$r,this._playEnd=l$b,this._paused=!1,this._currentAnimationClipIndex=l$i,this._currentKeyframeIndex=0,this._startUpdateLoopCount=l$h.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},l$R.playByFrame=function(l$i,l$_,l$R,l$r,l$b,l$z){void 0===l$i&&(l$i=0),void 0===l$_&&(l$_=1),void 0===l$R&&(l$R=2147483647),void 0===l$r&&(l$r=0),void 0===l$b&&(l$b=0),void 0===l$z&&(l$z=30);var l$L=1e3/l$z;this.play(l$i,l$_,l$R,l$r*l$L,l$b*l$L)},l$R.stop=function(l$i){void 0===l$i&&(l$i=!0),l$i?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},l$z(0,l$R,"playEnd",function(){return this._playEnd}),l$z(0,l$R,"templet",function(){return this._templet},function(l$i){0===!this.state&&this.stop(!0),this._templet!==l$i&&((this._templet=l$i).loaded?this._computeFullKeyframeIndices():l$i.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),l$z(0,l$R,"playStart",function(){return this._playStart}),l$z(0,l$R,"playDuration",function(){return this._playDuration}),l$z(0,l$R,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),l$z(0,l$R,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),l$z(0,l$R,"overallDuration",function(){return this._overallDuration}),l$z(0,l$R,"currentFrameTime",function(){return this._currentFrameTime}),l$z(0,l$R,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),l$z(0,l$R,"currentPlayTime",function(){return this._currentTime+this._playStart}),l$z(0,l$R,"cachePlayRate",function(){return this._cachePlayRate},function(l$i){this._cachePlayRate!==l$i&&(this._cachePlayRate=l$i,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[l$i,this._cacheFrameRate])))}),l$z(0,l$R,"cacheFrameRate",function(){return this._cacheFrameRate},function(l$i){this._cacheFrameRate!==l$i&&(this._cacheFrameRate=l$i,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,l$i])))}),l$z(0,l$R,"currentTime",null,function(l$i){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(l$i<this._playStart||l$i>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=l$h.loopCount;var l$_=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=l$i,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/l$_),0),this._currentFrameTime=this._currentKeyframeIndex*l$_}}),l$z(0,l$R,"paused",function(){return this._paused},function(l$i){(this._paused=l$i)&&this.event("paused")}),l$z(0,l$R,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),l$z(0,l$R,"destroyed",function(){return this._destroyed}),l$_}(),l$p=function(l$i){function l$_(){l$_.__super.call(this),l$N.isConchNode&&(this.drawSkin=function(l$i){l$i.transform||(l$i.transform=l$Gi.EMPTY),this._addCmd([l$i]),this.setSkinMesh&&this.setSkinMesh(l$i._ps,l$i.mVBData,l$i.mEleNum,0,l$i.mTexture,l$i.transform)})}return l$r(l$_,"laya.ani.GraphicsAni",l$L),l$_.prototype.drawSkin=function(l$i){var l$_=[l$i];this._saveToCmd(l$N._context._drawSkin,l$_)},l$_.create=function(){return l$_._caches.pop()||new l$_},l$_.recycle=function(l$i){l$i.clear(),l$_._caches.push(l$i)},l$_._caches=[],l$_}(),l$k=function(l$i){function l$t(){this._aniMap={},this.unfixedLastAniIndex=-1,l$t.__super.call(this),this._anis=new Array}l$r(l$t,"laya.ani.AnimationTemplet",l$B);var l$_=l$t.prototype;return l$_.parse=function(l$i){var l$_=new l$$i(l$i);this._aniVersion=l$_.readUTFString(),l$I.parse(this,l$_)},l$_._calculateKeyFrame=function(l$i,l$_,l$R){var l$r=l$i.keyFrame;l$r[l$_]=l$r[0];for(var l$b=0;l$b<l$_;l$b++){var l$z=l$r[l$b];l$z.nextData=0===l$z.duration?l$z.data:l$r[l$b+1].data}l$r.length--},l$_.onAsynLoaded=function(l$i,l$_,l$R){var l$r=new l$$i(l$_);switch(this._aniVersion=l$r.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":l$e.parse(this,l$r);break;default:l$I.parse(this,l$r)}this._endLoaded()},l$_.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},l$_.getAnimationCount=function(){return this._anis.length},l$_.getAnimation=function(l$i){return this._anis[l$i]},l$_.getAniDuration=function(l$i){return this._anis[l$i].playTime},l$_.getNodes=function(l$i){return this._anis[l$i].nodes},l$_.getNodeIndexWithName=function(l$i,l$_){return this._anis[l$i].bone3DMap[l$_]},l$_.getNodeCount=function(l$i){return this._anis[l$i].nodes.length},l$_.getTotalkeyframesLength=function(l$i){return this._anis[l$i].totalKeyframeDatasLength},l$_.getPublicExtData=function(){return this._publicExtData},l$_.getAnimationDataWithCache=function(l$i,l$_,l$R,l$r){var l$b=l$_[l$R];if(l$b){var l$z=l$b[l$i];return l$z?l$z[l$r]:null}return null},l$_.setAnimationDataWithCache=function(l$i,l$_,l$R,l$r,l$b){var l$z=l$_[l$R]||(l$_[l$R]={});(l$z[l$i]||(l$z[l$i]=[]))[l$r]=l$b},l$_.getOriginalData=function(l$i,l$_,l$R,l$r,l$b){for(var l$z=this._anis[l$i].nodes,l$L=0,l$w=0,l$x=l$z.length,l$P=0;l$w<l$x;l$w++){var l$B,l$n=l$z[l$w];l$B=l$n.keyFrame[l$R[l$w][l$r]],l$n.dataOffset=l$P;var l$f=l$b-l$B.startTime,l$J=l$n.lerpType;if(l$J)switch(l$J){case 0:case 1:for(l$L=0;l$L<l$n.keyframeWidth;)l$L+=l$n.interpolationMethod[l$L](l$n,l$L,l$_,l$P+l$L,l$B.data,l$f,null,l$B.duration,l$B.nextData);break;case 2:var l$h=l$B.interpolationData,l$M=l$h.length,l$N=0;for(l$L=0;l$L<l$M;){var l$X=l$h[l$L];switch(l$X){case 6:case 7:l$L+=l$t.interpolation[l$X](l$n,l$N,l$_,l$P+l$N,l$B.data,l$f,null,l$B.duration,l$B.nextData,l$h,l$L+1);break;default:l$L+=l$t.interpolation[l$X](l$n,l$N,l$_,l$P+l$N,l$B.data,l$f,null,l$B.duration,l$B.nextData)}l$N++}}else for(l$L=0;l$L<l$n.keyframeWidth;)l$L+=l$n.interpolationMethod[l$L](l$n,l$L,l$_,l$P+l$L,l$B.data,l$f,null,l$B.duration,l$B.nextData);l$P+=l$n.keyframeWidth}},l$_.getNodesCurrentFrameIndex=function(l$i,l$_){var l$R=this._anis[l$i].nodes;l$i!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(l$R.length),this.unfixedCurrentTimes=new Float32Array(l$R.length),this.unfixedLastAniIndex=l$i);for(var l$r=0,l$b=l$R.length;l$r<l$b;l$r++){var l$z=l$R[l$r];for(l$_<this.unfixedCurrentTimes[l$r]&&(this.unfixedCurrentFrameIndexes[l$r]=0),this.unfixedCurrentTimes[l$r]=l$_;this.unfixedCurrentFrameIndexes[l$r]<l$z.keyFrame.length&&!(l$z.keyFrame[this.unfixedCurrentFrameIndexes[l$r]].startTime>this.unfixedCurrentTimes[l$r]);)this.unfixedCurrentFrameIndexes[l$r]++;this.unfixedCurrentFrameIndexes[l$r]--}return this.unfixedCurrentFrameIndexes},l$_.getOriginalDataUnfixedRate=function(l$i,l$_,l$R){var l$r=this._anis[l$i].nodes;l$i!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(l$r.length),this.unfixedCurrentTimes=new Float32Array(l$r.length),this.unfixedKeyframes=l$M(l$r.length),this.unfixedLastAniIndex=l$i);for(var l$b=0,l$z=0,l$L=l$r.length,l$w=0;l$z<l$L;l$z++){var l$x=l$r[l$z];for(l$R<this.unfixedCurrentTimes[l$z]&&(this.unfixedCurrentFrameIndexes[l$z]=0),this.unfixedCurrentTimes[l$z]=l$R;this.unfixedCurrentFrameIndexes[l$z]<l$x.keyFrame.length&&!(l$x.keyFrame[this.unfixedCurrentFrameIndexes[l$z]].startTime>this.unfixedCurrentTimes[l$z]);)this.unfixedKeyframes[l$z]=l$x.keyFrame[this.unfixedCurrentFrameIndexes[l$z]],this.unfixedCurrentFrameIndexes[l$z]++;var l$P=this.unfixedKeyframes[l$z];l$x.dataOffset=l$w;var l$B=l$R-l$P.startTime;if(l$x.lerpType)switch(l$x.lerpType){case 0:case 1:for(l$b=0;l$b<l$x.keyframeWidth;)l$b+=l$x.interpolationMethod[l$b](l$x,l$b,l$_,l$w+l$b,l$P.data,l$B,null,l$P.duration,l$P.nextData);break;case 2:var l$n=l$P.interpolationData,l$f=l$n.length,l$J=0;for(l$b=0;l$b<l$f;){var l$h=l$n[l$b];switch(l$h){case 6:case 7:l$b+=l$t.interpolation[l$h](l$x,l$J,l$_,l$w+l$J,l$P.data,l$B,null,l$P.duration,l$P.nextData,l$n,l$b+1);break;default:l$b+=l$t.interpolation[l$h](l$x,l$J,l$_,l$w+l$J,l$P.data,l$B,null,l$P.duration,l$P.nextData)}l$J++}}else for(l$b=0;l$b<l$x.keyframeWidth;)l$b+=l$x.interpolationMethod[l$b](l$x,l$b,l$_,l$w+l$b,l$P.data,l$B,null,l$P.duration,l$P.nextData);l$w+=l$x.keyframeWidth}},l$t._LinearInterpolation_0=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){var l$B=0===l$w?0:l$z/l$w;return l$R[l$r]=(1-l$B)*l$b[l$_]+l$B*l$x[l$_],1},l$t._QuaternionInterpolation_1=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){var l$B=0===l$w?0:l$z/l$w;return l$f.slerpQuaternionArray(l$b,l$_,l$x,l$_,l$B,l$R,l$r),4},l$t._AngleInterpolation_2=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){return 0},l$t._RadiansInterpolation_3=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){return 0},l$t._Matrix4x4Interpolation_4=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){for(var l$B=0;l$B<16;l$B++,l$_++)l$R[l$r+l$B]=l$b[l$_]+l$z*l$L[l$_];return 16},l$t._NoInterpolation_5=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P){return l$R[l$r]=l$b[l$_],1},l$t._BezierInterpolation_6=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B){return void 0===l$B&&(l$B=0),l$R[l$r]=l$b[l$_]+(l$x[l$_]-l$b[l$_])*l$Z.getBezierRate(l$z/l$w,l$P[l$B],l$P[l$B+1],l$P[l$B+2],l$P[l$B+3]),5},l$t._BezierInterpolation_7=function(l$i,l$_,l$R,l$r,l$b,l$z,l$L,l$w,l$x,l$P,l$B){return void 0===l$B&&(l$B=0),l$R[l$r]=l$P[l$B+4]+l$P[l$B+5]*l$Z.getBezierRate((.001*l$z+l$P[l$B+6])/l$P[l$B+7],l$P[l$B],l$P[l$B+1],l$P[l$B+2],l$P[l$B+3]),9},l$t.load=function(l$i){return l$bi.loader.create(l$i,null,null,l$t)},l$t.interpolation=[l$t._LinearInterpolation_0,l$t._QuaternionInterpolation_1,l$t._AngleInterpolation_2,l$t._RadiansInterpolation_3,l$t._Matrix4x4Interpolation_4,l$t._NoInterpolation_5,l$t._BezierInterpolation_6,l$t._BezierInterpolation_7],l$t}(),l$j=function(l$_){function l$R(l$i,l$_){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,l$R.__super.call(this),void 0===l$_&&(l$_=0),l$i&&this.init(l$i,l$_)}l$r(l$R,"laya.ani.bone.Skeleton",l$_);var l$i=l$R.prototype;return l$i.init=function(l$i,l$_){void 0===l$_&&(l$_=0);var l$R,l$r,l$b,l$z=0,l$L=0;if(1==l$_)for(this._graphicsCache=[],l$z=0,l$L=l$i.getAnimationCount();l$z<l$L;l$z++)this._graphicsCache.push([]);if(this._yReverseMatrix=l$i.yReverseMatrix,this._aniMode=l$_,this._templet=l$i,this._player=new l$q,this._player.cacheFrameRate=l$i.rate,this._player.templet=l$i,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=l$i.mBoneArr,this._rootBone=l$i.mRootBone,this._aniSectionDic=l$i.aniSectionDic,0<l$i.ikArr.length)for(this._ikArr=[],l$z=0,l$L=l$i.ikArr.length;l$z<l$L;l$z++)this._ikArr.push(new l$t(l$i.ikArr[l$z],this._boneList));if(0<l$i.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),l$z=0,l$L=l$i.pathArr.length;l$z<l$L;l$z++)l$R=l$i.pathArr[l$z],l$r=new l$c(l$R,this._boneList),(l$b=this._boneSlotDic[l$R.name])&&((l$r=new l$c(l$R,this._boneList)).target=l$b),this._pathDic[l$R.name]=l$r;if(0<l$i.tfArr.length)for(this._tfArr=[],l$z=0,l$L=l$i.tfArr.length;l$z<l$L;l$z++)this._tfArr.push(new l$l(l$i.tfArr[l$z],this._boneList));if(0<l$i.skinDataArray.length){var l$w=this._templet.skinDataArray[this._skinIndex];this._skinName=l$w.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},l$i.load=function(l$i,l$_,l$R){},l$i._onLoaded=function(){},l$i._parseComplete=function(){var l$i=l$S.TEMPLET_DICTIONARY[this._aniPath];l$i&&(this.init(l$i,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},l$i._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},l$i._onPlay=function(){this.event("played")},l$i._onStop=function(){var l$i,l$_=this._templet.eventAniArr[this._aniClipIndex];if(l$_&&this._eventIndex<l$_.length)for(;this._eventIndex<l$_.length;this._eventIndex++)(l$i=l$_[this._eventIndex]).time>=this._player.playStart&&l$i.time<=this._player.playEnd&&this.event("label",l$i);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},l$i._onPause=function(){this.event("paused")},l$i._parseSrcBoneMatrix=function(){var l$i=0,l$_=0;for(l$_=this._templet.srcBoneMatrixArr.length,l$i=0;l$i<l$_;l$i++)this._boneMatrixArray.push(new l$Gi);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var l$R,l$r,l$b=this._templet.boneSlotArray;for(l$i=0,l$_=l$b.length;l$i<l$_;l$i++)l$R=l$b[l$i],null==(l$r=this._bindBoneBoneSlotDic[l$R.parent])&&(this._bindBoneBoneSlotDic[l$R.parent]=l$r=[]),this._boneSlotDic[l$R.name]=l$R=l$R.copy(),l$r.push(l$R),this._boneSlotArray.push(l$R)}},l$i._emitMissedEvents=function(l$i,l$_,l$R){void 0===l$R&&(l$R=0);var l$r=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(l$r){var l$b,l$z,l$L=0;for(l$b=l$r.length,l$L=l$R;l$L<l$b;l$L++)(l$z=l$r[l$L]).time>=this._player.playStart&&l$z.time<=this._player.playEnd&&this.event("label",l$z)}},l$i._update=function(l$i){if(void 0===l$i&&(l$i=!0),!(this._pause||l$i&&this._indexControl)){var l$_=this.timer.currTimer,l$R=this._player.currentKeyframeIndex,l$r=l$_-this._lastTime;if(l$i?this._player._update(l$r):l$R=-1,this._lastTime=l$_,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<l$r&&this._clipIndex==l$R&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var l$b;this._lastUpdateAniClipIndex=this._aniClipIndex,l$R>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var l$z,l$L=this._templet.eventAniArr[this._aniClipIndex];if(l$L&&this._eventIndex<l$L.length&&((l$b=l$L[this._eventIndex]).time>=this._player.playStart&&l$b.time<=this._player.playEnd?this._player.currentPlayTime>=l$b.time&&(this.event("label",l$b),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(l$z=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=l$z&&(this.graphics=l$z));var l$w=0,l$x=0;for(l$x=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,l$x-1)&&0<l$x;)l$x--;if(l$x<this._clipIndex)for(l$w=l$x;l$w<this._clipIndex;l$w++)this._createGraphics(l$w)}else if(1==this._aniMode){if(l$z=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=l$z&&(this.graphics=l$z));for(l$x=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,l$x-1)&&0<l$x;)l$x--;if(l$x<this._clipIndex)for(l$w=l$x;l$w<this._clipIndex;l$w++)this._createGraphics(l$w)}this._createGraphics()}}},l$i._createGraphics=function(l$i){void 0===l$i&&(l$i=-1),-1==l$i&&(l$i=this._clipIndex);var l$_,l$R,l$r=l$i*this._player.cacheFrameRateInterval,l$b=this._templet.drawOrderAniArr[this._aniClipIndex];if(l$b&&0<l$b.length)for(this._drawOrderIndex=0,l$_=l$b[this._drawOrderIndex];l$r>=l$_.time&&(this._drawOrder=l$_.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=l$b.length));)l$_=l$b[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=l$p.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=l$p.create(),l$R=this.graphics;var l$z=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],l$i,l$r);var l$L,l$w,l$x,l$P,l$B=this._aniSectionDic[this._aniClipIndex],l$n=0,l$f=0,l$J=0,l$h=0,l$M=0,l$N=this._templet.srcBoneMatrixArr.length;for(l$M=l$B[l$f=0];l$f<l$N;l$f++)l$P=this._boneList[l$f],l$x=this._templet.srcBoneMatrixArr[l$f],l$P.resultTransform.scX=l$x.scX*this._curOriginalData[l$n++],l$P.resultTransform.skX=l$x.skX+this._curOriginalData[l$n++],l$P.resultTransform.skY=l$x.skY+this._curOriginalData[l$n++],l$P.resultTransform.scY=l$x.scY*this._curOriginalData[l$n++],l$P.resultTransform.x=l$x.x+this._curOriginalData[l$n++],l$P.resultTransform.y=l$x.y+this._curOriginalData[l$n++],8===this._templet.tMatrixDataLen&&(l$P.resultTransform.skewX=l$x.skewX+this._curOriginalData[l$n++],l$P.resultTransform.skewY=l$x.skewY+this._curOriginalData[l$n++]);var l$X,l$t={},l$I={};for(l$M+=l$B[1];l$f<l$M;l$f++)l$t[(l$X=l$z[l$f]).name]=this._curOriginalData[l$n++],l$I[l$X.name]=this._curOriginalData[l$n++],this._curOriginalData[l$n++],this._curOriginalData[l$n++],this._curOriginalData[l$n++],this._curOriginalData[l$n++];var l$e,l$c,l$l={},l$A={};for(l$M+=l$B[2];l$f<l$M;l$f++)l$l[(l$X=l$z[l$f]).name]=this._curOriginalData[l$n++],l$A[l$X.name]=this._curOriginalData[l$n++],this._curOriginalData[l$n++],this._curOriginalData[l$n++],this._curOriginalData[l$n++],this._curOriginalData[l$n++];if(this._pathDic)for(l$M+=l$B[3];l$f<l$M;l$f++){if(l$X=l$z[l$f],l$e=this._pathDic[l$X.name])switch(new l$$i(l$X.extenData).getByte()){case 1:l$e.position=this._curOriginalData[l$n++];break;case 2:l$e.spacing=this._curOriginalData[l$n++];break;case 3:l$e.rotateMix=this._curOriginalData[l$n++],l$e.translateMix=this._curOriginalData[l$n++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(l$Gi.TEMP.identity()),this._ikArr)for(l$f=0,l$M=this._ikArr.length;l$f<l$M;l$f++)l$c=this._ikArr[l$f],l$l.hasOwnProperty(l$c.name)&&(l$c.bendDirection=l$l[l$c.name]),l$A.hasOwnProperty(l$c.name)&&(l$c.mix=l$A[l$c.name]),l$c.apply();if(this._pathDic)for(var l$Z in this._pathDic)(l$e=this._pathDic[l$Z]).apply(this._boneList,l$R);if(this._tfArr)for(l$f=0,l$h=this._tfArr.length;l$f<l$h;l$f++)this._tfArr[l$f].apply();for(l$f=0,l$h=this._boneList.length;l$f<l$h;l$f++)if(l$P=this._boneList[l$f],l$w=this._bindBoneBoneSlotDic[l$P.name],l$P.resultMatrix.copyTo(this._boneMatrixArray[l$f]),l$w)for(l$J=0,l$M=l$w.length;l$J<l$M;l$J++)(l$L=l$w[l$J])&&l$L.setParentMatrix(l$P.resultMatrix);var l$q,l$j,l$S,l$v,l$$={},l$G=this._templet.deformAniArr;if(l$G&&0<l$G.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,l$f=0,l$M=this._boneSlotArray.length;l$f<l$M;l$f++)(l$L=this._boneSlotArray[l$f]).deformData=null;var l$u,l$o=l$G[this._aniClipIndex];for(l$u in l$q=l$o.default,this._setDeform(l$q,l$$,this._boneSlotArray,l$r),l$o)"default"!=l$u&&l$u!=this._skinName&&(l$q=l$o[l$u],this._setDeform(l$q,l$$,this._boneSlotArray,l$r));l$q=l$o[this._skinName],this._setDeform(l$q,l$$,this._boneSlotArray,l$r)}if(this._drawOrder)for(l$f=0,l$M=this._drawOrder.length;l$f<l$M;l$f++)l$j=l$t[(l$L=this._boneSlotArray[this._drawOrder[l$f]]).name],l$S=l$I[l$L.name],isNaN(l$S)||(l$R.save(),l$R.alpha(l$S)),isNaN(l$j)||-2==l$j||(this._templet.attachmentNames?l$L.showDisplayByName(this._templet.attachmentNames[l$j]):l$L.showDisplayByIndex(l$j)),l$$[this._drawOrder[l$f]]?(l$v=l$$[this._drawOrder[l$f]],l$L.currDisplayData&&l$v[l$L.currDisplayData.attachmentName]?l$L.deformData=l$v[l$L.currDisplayData.attachmentName]:l$L.deformData=null):l$L.deformData=null,isNaN(l$S)?l$L.draw(l$R,this._boneMatrixArray,2==this._aniMode):l$L.draw(l$R,this._boneMatrixArray,2==this._aniMode,l$S),isNaN(l$S)||l$R.restore();else for(l$f=0,l$M=this._boneSlotArray.length;l$f<l$M;l$f++)l$j=l$t[(l$L=this._boneSlotArray[l$f]).name],l$S=l$I[l$L.name],isNaN(l$S)||(l$R.save(),l$R.alpha(l$S)),isNaN(l$j)||-2==l$j||(this._templet.attachmentNames?l$L.showDisplayByName(this._templet.attachmentNames[l$j]):l$L.showDisplayByIndex(l$j)),l$$[l$f]?(l$v=l$$[l$f],l$L.currDisplayData&&l$v[l$L.currDisplayData.attachmentName]?l$L.deformData=l$v[l$L.currDisplayData.attachmentName]:l$L.deformData=null):l$L.deformData=null,isNaN(l$S)?l$L.draw(l$R,this._boneMatrixArray,2==this._aniMode):l$L.draw(l$R,this._boneMatrixArray,2==this._aniMode,l$S),isNaN(l$S)||l$R.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,l$i,l$R):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,l$i,l$R)},l$i._setDeform=function(l$i,l$_,l$R,l$r){if(l$i){var l$b,l$z,l$L,l$w=0,l$x=0,l$P=0;if(l$i)for(l$w=0,l$x=l$i.deformSlotDataList.length;l$w<l$x;l$w++)for(l$b=l$i.deformSlotDataList[l$w],l$P=0;l$P<l$b.deformSlotDisplayList.length;l$P++)l$L=l$R[(l$z=l$b.deformSlotDisplayList[l$P]).slotIndex],l$z.apply(l$r,l$L),l$_[l$z.slotIndex]||(l$_[l$z.slotIndex]={}),l$_[l$z.slotIndex][l$z.attachment]=l$z.deformData}},l$i.getAnimNum=function(){return this._templet.getAnimationCount()},l$i.getAniNameByIndex=function(l$i){return this._templet.getAniNameByIndex(l$i)},l$i.getSlotByName=function(l$i){return this._boneSlotDic[l$i]},l$i.showSkinByName=function(l$i,l$_){void 0===l$_&&(l$_=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(l$i),l$_)},l$i.showSkinByIndex=function(l$i,l$_){void 0===l$_&&(l$_=!0);for(var l$R=0;l$R<this._boneSlotArray.length;l$R++)this._boneSlotArray[l$R].showSlotData(null,l$_);if(this._templet.showSkinByIndex(this._boneSlotDic,l$i,l$_)){var l$r=this._templet.skinDataArray[l$i];this._skinIndex=l$i,this._skinName=l$r.name}this._clearCache()},l$i.showSlotSkinByIndex=function(l$i,l$_){if(0!=this._aniMode){var l$R=this.getSlotByName(l$i);l$R&&l$R.showDisplayByIndex(l$_),this._clearCache()}},l$i.showSlotSkinByName=function(l$i,l$_){if(0!=this._aniMode){var l$R=this.getSlotByName(l$i);l$R&&l$R.showDisplayByName(l$_),this._clearCache()}},l$i.replaceSlotSkinName=function(l$i,l$_,l$R){if(0!=this._aniMode){var l$r=this.getSlotByName(l$i);l$r&&l$r.replaceDisplayByName(l$_,l$R),this._clearCache()}},l$i.replaceSlotSkinByIndex=function(l$i,l$_,l$R){if(0!=this._aniMode){var l$r=this.getSlotByName(l$i);l$r&&l$r.replaceDisplayByIndex(l$_,l$R),this._clearCache()}},l$i.setSlotSkin=function(l$i,l$_){if(0!=this._aniMode){var l$R=this.getSlotByName(l$i);l$R&&l$R.replaceSkin(l$_),this._clearCache()}},l$i._clearCache=function(){if(1==this._aniMode)for(var l$i=0,l$_=this._graphicsCache.length;l$i<l$_;l$i++){for(var l$R=0,l$r=this._graphicsCache[l$i].length;l$R<l$r;l$R++){var l$b=this._graphicsCache[l$i][l$R];l$b!=this.graphics&&l$p.recycle(l$b)}this._graphicsCache[l$i].length=0}},l$i.play=function(l$i,l$_,l$R,l$r,l$b,l$z){void 0===l$R&&(l$R=!0),void 0===l$r&&(l$r=0),void 0===l$b&&(l$b=0),void 0===l$z&&(l$z=!0),this._indexControl=!1;var l$L=-1,l$w=NaN;if(l$w=l$_?2147483647:0,"string"==typeof l$i)for(var l$x=0,l$P=this._templet.getAnimationCount();l$x<l$P;l$x++){var l$B=this._templet.getAnimation(l$x);if(l$B&&l$i==l$B.name){l$L=l$x;break}}else l$L=l$i;-1<l$L&&l$L<this.getAnimNum()&&(this._aniClipIndex=l$L,(l$R||this._pause||this._currAniIndex!=l$L)&&(this._currAniIndex=l$L,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(l$L)),this._drawOrder=null,this._eventIndex=0,this._player.play(l$L,this._player.playbackRate,l$w,l$r,l$b),l$z&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=l$n.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},l$i.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},l$i.playbackRate=function(l$i){this._player&&(this._player.playbackRate=l$i)},l$i.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},l$i.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=l$n.now(),this.timer.frameLoop(1,this,this._update,null,!0))},l$i._getGrahicsDataWithCache=function(l$i,l$_){return this._graphicsCache[l$i][l$_]},l$i._setGrahicsDataWithCache=function(l$i,l$_,l$R){this._graphicsCache[l$i][l$_]=l$R},l$i.destroy=function(l$i){void 0===l$i&&(l$i=!0),l$_.prototype.destroy.call(this,l$i),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},l$z(0,l$i,"url",function(){return this._aniPath},function(l$i){this.load(l$i)}),l$z(0,l$i,"index",function(){return this._index},function(l$i){this.player&&(this._index=l$i,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),l$z(0,l$i,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),l$z(0,l$i,"templet",function(){return this._templet}),l$z(0,l$i,"player",function(){return this._player}),l$R.useSimpleMeshInCanvas=!1,l$R}(l$zi),l$S=function(l$_){function l$b(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,l$b.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}l$r(l$b,"laya.ani.bone.Templet",l$_);var l$i=l$b.prototype;return l$i.getLoadList=function(){return this._loadList},l$i.loadAni=function(l$i){this._skBufferUrl=l$i,l$bi.loader.load(l$i,l$x.create(this,this.onComplete),null,"arraybuffer")},l$i.onComplete=function(l$i){if(this._isDestroyed)this.destroy();else{var l$_=l$P.getRes(this._skBufferUrl);l$_?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,l$_)):this.event("error","load failed:"+this._skBufferUrl)}},l$i.parseData=function(l$i,l$_,l$R){void 0===l$R&&(l$R=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=l$i,this._mainTexture&&l$N.isWebGL&&l$i.bitmap&&(l$i.bitmap.enableMerageInAtlas=!1),this._rate=l$R,this.parse(l$_)},l$i.buildArmature=function(l$i){return void 0===l$i&&(l$i=0),new l$j(this,l$i)},l$i.parse=function(l$i){l$_.prototype.parse.call(this,l$i),this._endLoaded(),this._aniVersion!=l$b.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+l$b.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},l$i._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var l$i=0;this._loadList=[];var l$_,l$R=new l$$i(this.getPublicExtData()),l$r=0,l$b=0,l$z=0,l$L=l$R.getInt32(),l$w=l$R.readUTFString(),l$x=l$w.split("\n");for(l$i=0;l$i<l$L;l$i++)l$_=this._path+l$x[2*l$i],l$w=l$x[2*l$i+1],l$R.getFloat32(),l$R.getFloat32(),l$r=l$R.getFloat32(),l$b=l$R.getFloat32(),l$z=l$R.getFloat32(),isNaN(l$z)?0:l$z,l$z=l$R.getFloat32(),isNaN(l$z)?0:l$z,l$z=l$R.getFloat32(),isNaN(l$z)?l$r:l$z,l$z=l$R.getFloat32(),isNaN(l$z)?l$b:l$z,-1==this._loadList.indexOf(l$_)&&this._loadList.push(l$_);this.event("inited",this)}},l$i._textureComplete=function(){for(var l$i,l$_,l$R=0,l$r=this._loadList.length;l$R<l$r;l$R++)l$_=this._loadList[l$R],l$i=this._textureDic[l$_]=l$P.getRes(l$_),l$N.isWebGL&&l$i&&l$i.bitmap&&(l$i.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},l$i._parsePublicExtData=function(){var l$i=0,l$_=0,l$R=0,l$r=0,l$b=0;for(l$i=0,l$b=this.getAnimationCount();l$i<l$b;l$i++)this._graphicsCache.push([]);var l$z;l$z="Dragon"!=this._aniClassName;var l$L,l$w,l$x=new l$$i(this.getPublicExtData()),l$P=0,l$B=0,l$n=0,l$f=0,l$J=0,l$h=0,l$M=0,l$N=0,l$X=0,l$t=l$x.getInt32(),l$I=l$x.readUTFString(),l$e=l$I.split("\n");for(l$i=0;l$i<l$t;l$i++){if(l$L=this._mainTexture,l$w=this._path+l$e[2*l$i],l$I=l$e[2*l$i+1],null==this._mainTexture&&(l$L=this._textureDic[l$w]),!l$L)return this.event("error",this),void(this.isParseFail=!0);l$P=l$x.getFloat32(),l$B=l$x.getFloat32(),l$n=l$x.getFloat32(),l$f=l$x.getFloat32(),l$X=l$x.getFloat32(),l$J=isNaN(l$X)?0:l$X,l$X=l$x.getFloat32(),l$h=isNaN(l$X)?0:l$X,l$X=l$x.getFloat32(),l$M=isNaN(l$X)?l$n:l$X,l$X=l$x.getFloat32(),l$N=isNaN(l$X)?l$f:l$X,this.subTextureDic[l$I]=l$ui.create(l$L,l$P,l$B,l$n,l$f,-l$J,-l$h,l$M,l$N),l$L.alphaTexture&&(this.subTextureDic[l$I].alphaTexture=l$ui.create(l$L.alphaTexture,l$P,l$B,l$n,l$f,-l$J,-l$h,l$M,l$N))}this._mainTexture=l$L;var l$c,l$l,l$A,l$Z,l$q,l$j=l$x.getUint16();for(l$i=0;l$i<l$j;l$i++)(l$c=[]).push(l$x.getUint16()),l$c.push(l$x.getUint16()),l$c.push(l$x.getUint16()),l$c.push(l$x.getUint16()),this.aniSectionDic[l$i]=l$c;var l$S,l$v=l$x.getInt16(),l$$={};for(l$i=0;l$i<l$v;l$i++)l$l=new l$oi,0==l$i?l$S=l$l:l$l.root=l$S,l$l.d=l$z?-1:1,l$Z=l$x.readUTFString(),l$q=l$x.readUTFString(),l$l.length=l$x.getFloat32(),1==l$x.getByte()&&(l$l.inheritRotation=!1),1==l$x.getByte()&&(l$l.inheritScale=!1),l$l.name=l$Z,l$q&&((l$A=l$$[l$q])?l$A.addChild(l$l):this.mRootBone=l$l),l$$[l$Z]=l$l,this.mBoneArr.push(l$l);this.tMatrixDataLen=l$x.getUint16();var l$G,l$u,l$o=l$x.getUint16(),l$p=Math.floor(l$o/this.tMatrixDataLen),l$k=this.srcBoneMatrixArr;for(l$i=0;l$i<l$p;l$i++)(l$G=new l$Vi).scX=l$x.getFloat32(),l$G.skX=l$x.getFloat32(),l$G.skY=l$x.getFloat32(),l$G.scY=l$x.getFloat32(),l$G.x=l$x.getFloat32(),l$G.y=l$x.getFloat32(),8===this.tMatrixDataLen&&(l$G.skewX=l$x.getFloat32(),l$G.skewY=l$x.getFloat32()),l$k.push(l$G),(l$l=this.mBoneArr[l$i]).transform=l$G;var l$K,l$O=l$x.getUint16(),l$E=0;for(l$i=0;l$i<l$O;l$i++){for(l$u=new l$Yi,l$E=l$x.getUint16(),l$_=0;l$_<l$E;l$_++)l$u.boneNames.push(l$x.readUTFString()),l$u.boneIndexs.push(l$x.getInt16());l$u.name=l$x.readUTFString(),l$u.targetBoneName=l$x.readUTFString(),l$u.targetBoneIndex=l$x.getInt16(),l$u.bendDirection=l$x.getFloat32(),l$u.mix=l$x.getFloat32(),l$u.isSpine=l$z,this.ikArr.push(l$u)}var l$s,l$Y=l$x.getUint16(),l$C=0;for(l$i=0;l$i<l$Y;l$i++){for(l$K=new l$gi,l$C=l$x.getUint16(),l$_=0;l$_<l$C;l$_++)l$K.boneIndexs.push(l$x.getInt16());l$K.name=l$x.getUTFString(),l$K.targetIndex=l$x.getInt16(),l$K.rotateMix=l$x.getFloat32(),l$K.translateMix=l$x.getFloat32(),l$K.scaleMix=l$x.getFloat32(),l$K.shearMix=l$x.getFloat32(),l$K.offsetRotation=l$x.getFloat32(),l$K.offsetX=l$x.getFloat32(),l$K.offsetY=l$x.getFloat32(),l$K.offsetScaleX=l$x.getFloat32(),l$K.offsetScaleY=l$x.getFloat32(),l$K.offsetShearY=l$x.getFloat32(),this.tfArr.push(l$K)}var l$m=l$x.getUint16(),l$D=0;for(l$i=0;l$i<l$m;l$i++){for((l$s=new l$Ci).name=l$x.readUTFString(),l$D=l$x.getUint16(),l$_=0;l$_<l$D;l$_++)l$s.bones.push(l$x.getInt16());l$s.target=l$x.readUTFString(),l$s.positionMode=l$x.readUTFString(),l$s.spacingMode=l$x.readUTFString(),l$s.rotateMode=l$x.readUTFString(),l$s.offsetRotation=l$x.getFloat32(),l$s.position=l$x.getFloat32(),l$s.spacing=l$x.getFloat32(),l$s.rotateMix=l$x.getFloat32(),l$s.translateMix=l$x.getFloat32(),this.pathArr.push(l$s)}var l$U,l$g,l$V,l$y,l$a,l$F=0,l$d=0,l$Q=0,l$H=NaN,l$W=0,l$T=l$x.getInt16();for(l$i=0;l$i<l$T;l$i++){var l$ii=l$x.getUint8(),l$_i={};this.deformAniArr.push(l$_i);for(var l$Ri=0;l$Ri<l$ii;l$Ri++)for((l$U=new l$ki).skinName=l$x.getUTFString(),l$_i[l$U.skinName]=l$U,l$F=l$x.getInt16(),l$_=0;l$_<l$F;l$_++)for(l$g=new l$Ki,l$U.deformSlotDataList.push(l$g),l$d=l$x.getInt16(),l$R=0;l$R<l$d;l$R++)for(l$V=new l$Oi,l$g.deformSlotDisplayList.push(l$V),l$V.slotIndex=l$x.getInt16(),l$V.attachment=l$x.getUTFString(),l$Q=l$x.getInt16(),l$r=0;l$r<l$Q;l$r++)for(1==l$x.getByte()?l$V.tweenKeyList.push(!0):l$V.tweenKeyList.push(!1),l$H=l$x.getFloat32(),l$V.timeList.push(l$H),l$y=[],l$V.vectices.push(l$y),l$W=l$x.getInt16(),l$b=0;l$b<l$W;l$b++)l$y.push(l$x.getFloat32())}var l$ri,l$bi,l$zi=l$x.getInt16(),l$Li=0,l$wi=0;for(l$i=0;l$i<l$zi;l$i++){for(l$Li=l$x.getInt16(),l$a=[],l$_=0;l$_<l$Li;l$_++){for((l$ri=new l$Ei).time=l$x.getFloat32(),l$wi=l$x.getInt16(),l$R=0;l$R<l$wi;l$R++)l$ri.drawOrder.push(l$x.getInt16());l$a.push(l$ri)}this.drawOrderAniArr.push(l$a)}var l$xi,l$Pi=l$x.getInt16(),l$Bi=0;for(l$i=0;l$i<l$Pi;l$i++){for(l$Bi=l$x.getInt16(),l$bi=[],l$_=0;l$_<l$Bi;l$_++)(l$xi=new l$si).name=l$x.getUTFString(),l$xi.intValue=l$x.getInt32(),l$xi.floatValue=l$x.getFloat32(),l$xi.stringValue=l$x.getUTFString(),l$xi.time=l$x.getFloat32(),l$bi.push(l$xi);this.eventAniArr.push(l$bi)}var l$ni=l$x.getInt16();if(0<l$ni)for(this.attachmentNames=[],l$i=0;l$i<l$ni;l$i++)this.attachmentNames.push(l$x.getUTFString());var l$fi,l$Ji,l$hi=l$x.getInt16();for(l$i=0;l$i<l$hi;l$i++)(l$fi=new l$pi).name=l$x.readUTFString(),l$fi.parent=l$x.readUTFString(),l$fi.attachmentName=l$x.readUTFString(),l$fi.srcDisplayIndex=l$fi.displayIndex=l$x.getInt16(),(l$fi.templet=this).boneSlotDic[l$fi.name]=l$fi,null==(l$Ji=this.bindBoneBoneSlotDic[l$fi.parent])&&(this.bindBoneBoneSlotDic[l$fi.parent]=l$Ji=[]),l$Ji.push(l$fi),this.boneSlotArray.push(l$fi);var l$Mi,l$Ni,l$Xi,l$ti=l$x.readUTFString().split("\n"),l$Ii=0,l$ei=l$x.getUint8(),l$ci=0,l$li=0,l$Ai=0,l$Zi=0,l$qi=0,l$ji=0,l$Si=0;for(l$i=0;l$i<l$ei;l$i++){for((l$Mi=new l$mi).name=l$ti[l$Ii++],l$ci=l$x.getUint8(),l$_=0;l$_<l$ci;l$_++){for((l$Ni=new l$Ui).name=l$ti[l$Ii++],l$fi=this.boneSlotDic[l$Ni.name],l$li=l$x.getUint8(),l$R=0;l$R<l$li;l$R++){if(l$Xi=new l$Di,this.skinSlotDisplayDataArr.push(l$Xi),l$Xi.name=l$ti[l$Ii++],l$Xi.attachmentName=l$ti[l$Ii++],l$Xi.transform=new l$Vi,l$Xi.transform.scX=l$x.getFloat32(),l$Xi.transform.skX=l$x.getFloat32(),l$Xi.transform.skY=l$x.getFloat32(),l$Xi.transform.scY=l$x.getFloat32(),l$Xi.transform.x=l$x.getFloat32(),l$Xi.transform.y=l$x.getFloat32(),l$Ni.displayArr.push(l$Xi),l$Xi.width=l$x.getFloat32(),l$Xi.height=l$x.getFloat32(),l$Xi.type=l$x.getUint8(),l$Xi.verLen=l$x.getUint16(),0<(l$v=l$x.getUint16()))for(l$Xi.bones=[],l$r=0;l$r<l$v;l$r++){var l$vi=l$x.getUint16();l$Xi.bones.push(l$vi)}if(0<(l$Ai=l$x.getUint16()))for(l$Xi.uvs=[],l$r=0;l$r<l$Ai;l$r++)l$Xi.uvs.push(l$x.getFloat32());if(0<(l$Zi=l$x.getUint16()))for(l$Xi.weights=[],l$r=0;l$r<l$Zi;l$r++)l$Xi.weights.push(l$x.getFloat32());if(0<(l$qi=l$x.getUint16()))for(l$Xi.triangles=[],l$r=0;l$r<l$qi;l$r++)l$Xi.triangles.push(l$x.getUint16());if(0<(l$ji=l$x.getUint16()))for(l$Xi.vertices=[],l$r=0;l$r<l$ji;l$r++)l$Xi.vertices.push(l$x.getFloat32());if(0<(l$Si=l$x.getUint16()))for(l$Xi.lengths=[],l$r=0;l$r<l$Si;l$r++)l$Xi.lengths.push(l$x.getFloat32())}l$Mi.slotArr.push(l$Ni)}this.skinDic[l$Mi.name]=l$Mi,this.skinDataArray.push(l$Mi)}1==l$x.getUint8()?(this.yReverseMatrix=new l$Gi(1,0,0,-1,0,0),l$S&&l$S.setTempMatrix(this.yReverseMatrix)):l$S&&l$S.setTempMatrix(new l$Gi),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},l$i.getTexture=function(l$i){var l$_=this.subTextureDic[l$i];return l$_||(l$_=this.subTextureDic[l$i.substr(0,l$i.length-1)]),null==l$_?this._mainTexture:l$_},l$i.showSkinByIndex=function(l$i,l$_,l$R){if(void 0===l$R&&(l$R=!0),l$_<0&&l$_>=this.skinDataArray.length)return!1;var l$r,l$b,l$z=0,l$L=0,l$w=this.skinDataArray[l$_];if(l$w){for(l$z=0,l$L=l$w.slotArr.length;l$z<l$L;l$z++)(l$b=l$w.slotArr[l$z])&&(l$r=l$i[l$b.name])&&(l$r.showSlotData(l$b,l$R),l$R&&"undefined"!=l$r.attachmentName&&"null"!=l$r.attachmentName?l$r.showDisplayByName(l$r.attachmentName):l$r.showDisplayByIndex(l$r.displayIndex));return!0}return!1},l$i.getSkinIndexByName=function(l$i){for(var l$_=0,l$R=this.skinDataArray.length;l$_<l$R;l$_++)if(this.skinDataArray[l$_].name==l$i)return l$_;return-1},l$i.getGrahicsDataWithCache=function(l$i,l$_){return this._graphicsCache[l$i][l$_]},l$i.setGrahicsDataWithCache=function(l$i,l$_,l$R){this._graphicsCache[l$i][l$_]=l$R},l$i.destroy=function(){var l$i;for(var l$_ in this._isDestroyed=!0,this.subTextureDic)(l$i=this.subTextureDic[l$_])&&l$i.destroy();for(l$_ in this._textureDic)(l$i=this._textureDic[l$_])&&l$i.destroy();for(var l$R=0,l$r=this.skinSlotDisplayDataArr.length;l$R<l$r;l$R++)this.skinSlotDisplayDataArr[l$R].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete l$b.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},l$i.getAniNameByIndex=function(l$i){var l$_=this.getAnimation(l$i);return l$_?l$_.name:null},l$z(0,l$i,"rate",function(){return this._rate},function(l$i){this._rate=l$i}),l$b.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",l$b.TEMPLET_DICTIONARY=null,l$b}(l$k)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(l$i,l$_){"use strict";for(var l$R in Object.defineProperty(l$_,"__esModule",{value:!0}),Laya){var l$r=Laya[l$R];l$r&&l$r.__isclass&&(l$_[l$R]=l$r)}});