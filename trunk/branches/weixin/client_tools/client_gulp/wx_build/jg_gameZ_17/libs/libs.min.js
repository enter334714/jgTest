var Laya=window.Laya=function($Lp,$Lr){var $Lg={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function($Lr,$Li){return 1==arguments.length?$Lg.__presubstr.call(this,$Lr):$Lg.__presubstr.call(this,$Lr,0<$Li?$Li:this.length+$Li)},__init:function($Lr){$Lr.forEach(function($Lr){$Lr.__init$&&$Lr.__init$()})},__isClass:function($Lr){return $Lr&&($Lr.__isclass||$Lr==Object||$Lr==String||$Lr==Array)},__newvec:function($Lr,$Li){var $Lt=[];$Lt.length=$Lr;for(var $L_=0;$L_<$Lr;$L_++)$Lt[$L_]=$Li;return $Lt},__extend:function($Lr,$Li){for(var $Lt in $Li)if($Li.hasOwnProperty($Lt)){var $L_=Object.getOwnPropertyDescriptor($Li,$Lt),$LA=$L_.get,$Lf=$L_.set;$LA||$Lf?$LA&&$Lf?Object.defineProperty($Lr,$Lt,$L_):($LA&&Object.defineProperty($Lr,$Lt,$LA),$Lf&&Object.defineProperty($Lr,$Lt,$Lf)):$Lr[$Lt]=$Li[$Lt]}function $LE(){$Lg.un(this,"constructor",$Lr)}$LE.prototype=$Li.prototype,$Lr.prototype=new $LE,$Lg.un($Lr.prototype,"__imps",$Lg.__copy({},$Li.prototype.__imps))},__copy:function($Lr,$Li){if(!$Li)return null;for(var $Lt in $Lr=$Lr||{},$Li)$Lr[$Lt]=$Li[$Lt];return $Lr},__package:function($Lr,$Li){if(!$Lg.__packages[$Lr]){$Lg.__packages[$Lr]=!0;var $Lt=$Lp,$L_=$Lr.split(".");if(1<$L_.length)for(var $LA=0,$Lf=$L_.length-1;$LA<$Lf;$LA++){var $LE=$Lt[$L_[$LA]];$Lt=$LE||($Lt[$L_[$LA]]={})}$Lt[$L_[$L_.length-1]]||($Lt[$L_[$L_.length-1]]=$Li||{})}},__hasOwnProperty:function($Lr,$Li){return $Li=$Li||this,Object.hasOwnProperty.call($Li,$Lr)||function $Lr($Li,$Lt){if(Object.hasOwnProperty.call($Lt.prototype,$Li))return!0;var $L_=$Lt.prototype.__super;return null==$L_?null:$Lr($Li,$L_)}($Lr,$Li.__class)},__typeof:function($Lr,$Li){if(!$Lr||!$Li)return!1;if($Li===String)return"string"==typeof $Lr;if($Li===Number)return"number"==typeof $Lr;if($Li.__interface__)$Li=$Li.__interface__;else if("string"!=typeof $Li)return $Lr instanceof $Li;return $Lr.__imps&&$Lr.__imps[$Li]||$Lr.__class==$Li},__as:function($Lr,$Li){return this.__typeof($Lr,$Li)?$Lr:null},__int:function($Lr){return $Lr?parseInt($Lr):0},interface:function($Lr,$Li){$Lg.__package($Lr,{});var $Lt=$Lg.__internals,$L_=$Lt[$Lr]=$Lt[$Lr]||{self:$Lr};if($Li){var $LA=$Li.split(",");$L_.extend=[];for(var $Lf=0;$Lf<$LA.length;$Lf++){var $LE=$LA[$Lf];$Lt[$LE]=$Lt[$LE]||{self:$LE},$L_.extend.push($Lt[$LE])}}var $LG=$Lp,$LN=$Lr.split(".");for($Lf=0;$Lf<$LN.length-1;$Lf++)$LG=$LG[$LN[$Lf]];$LG[$LN[$LN.length-1]]={__interface__:$Lr}},class:function($Lr,$Li,$Lt,$L_){if($Lt&&$Lg.__extend($Lr,$Lt),$Li)if($Lg.__package($Li,$Lr),$Lg.__classmap[$Li]=$Lr,0<$Li.indexOf(".")){if(0==$Li.indexOf("laya.")){var $LA=$Li.split(".");$L_=$L_||$LA[$LA.length-1],$Lg[$L_]&&console.log("Warning!,this class["+$L_+"] already exist:",$Lg[$L_]),$Lg[$L_]=$Lr}}else"Main"==$Li?$Lp.Main=$Lr:"MainWX"==$Li?$Lp.MainWX=$Lr:($Lg[$Li]&&console.log("Error!,this class["+$Li+"] already exist:",$Lg[$Li]),$Lg[$Li]=$Lr);var $Lf=$Lg.un,$LE=$Lr.prototype;$Lf($LE,"hasOwnProperty",$Lg.__hasOwnProperty),$Lf($LE,"__class",$Lr),$Lf($LE,"__super",$Lt),$Lf($LE,"__className",$Li),$Lf($Lr,"__super",$Lt),$Lf($Lr,"__className",$Li),$Lf($Lr,"__isclass",!0),$Lf($Lr,"super",function($Lr){this.__super.call($Lr)})},imps:function($Lr,$Li){if(!$Li)return null;var $LA=$Lr.__imps||$Lg.un($Lr,"__imps",{});function $Lf($Lr){var $Li,$Lt;if(($Li=$Lg.__internals[$Lr])&&($LA[$Lr]=!0,$Lt=$Li.extend))for(var $L_=0;$L_<$Lt.length;$L_++)$Lf($Lt[$L_].self)}for(var $Lt in $Li)$Lf($Lt)},superSet:function($Lr,$Li,$Lt,$L_){var $LA=$Lr.prototype["_$set_"+$Lt];$LA&&$LA.call($Li,$L_)},superGet:function($Lr,$Li,$Lt){var $L_=$Lr.prototype["_$get_"+$Lt];return $L_?$L_.call($Li):null},getset:function($Lr,$Li,$Lt,$L_,$LA){$Lr?($L_&&($Li["_$GET_"+$Lt]=$L_),$LA&&($Li["_$SET_"+$Lt]=$LA)):($L_&&$Lg.un($Li,"_$get_"+$Lt,$L_),$LA&&$Lg.un($Li,"_$set_"+$Lt,$LA)),$L_&&$LA?Object.defineProperty($Li,$Lt,{get:$L_,set:$LA,enumerable:!1,configurable:!0}):($L_&&Object.defineProperty($Li,$Lt,{get:$L_,enumerable:!1,configurable:!0}),$LA&&Object.defineProperty($Li,$Lt,{set:$LA,enumerable:!1,configurable:!0}))},static:function($Lt,$L_){for(var $LA=0,$Lr=$L_.length;$LA<$Lr;$LA+=2)if("length"==$L_[$LA])$Lt.length=$L_[$LA+1].call($Lt);else{function $Li(){var $Li=$L_[$LA],$Lr=$L_[$LA+1];Object.defineProperty($Lt,$Li,{get:function(){return delete this[$Li],this[$Li]=$Lr.call(this)},set:function($Lr){delete this[$Li],this[$Li]=$Lr},enumerable:!0,configurable:!0})}$Li()}},un:function($Lr,$Li,$Lt){return $Lt||($Lt=$Lr[$Li]),$Lg.__propun.value=$Lt,Object.defineProperty($Lr,$Li,$Lg.__propun),$Lt},uns:function($Li,$Lr){$Lr.forEach(function($Lr){$Lg.un($Li,$Lr)})}};return $Lp.console=$Lp.console||{log:function(){}},$Lp.trace=$Lp.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),$Lg}(window,document);!function($Lr,$Li,$Lt){$Lt.un,$Lt.uns,$Lt.static,$Lt.class,$Lt.getset,$Lt.__newvec}(window,document,Laya),function($LE,$Li,$Lw){$Lw.un,$Lw.uns;var $LN=$Lw.static,$Lg=$Lw.class,$LO=$Lw.getset;$Lw.__newvec;$Lw.interface("laya.runtime.IMarket"),$Lw.interface("laya.filters.IFilter"),$Lw.interface("laya.display.ILayout"),$Lw.interface("laya.resource.IDispose"),$Lw.interface("laya.runtime.IPlatform"),$Lw.interface("laya.resource.IDestroy"),$Lw.interface("laya.runtime.IConchNode"),$Lw.interface("laya.filters.IFilterAction"),$Lw.interface("laya.runtime.ICPlatformClass"),$Lw.interface("laya.resource.ICreateResource"),$Lw.interface("laya.runtime.IConchRenderObject"),$Lw.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var $Lk=function(){function $Lf(){}return $Lg($Lf,"laya.utils.RunDriver"),$Lf.FILTER_ACTIONS=[],$Lf.pixelRatio=-1,$Lf._charSizeTestDiv=null,$Lf.now=function(){return Date.now()},$Lf.getWindow=function(){return $LE},$Lf.getPixelRatio=function(){if($Lf.pixelRatio<0){var $Lr=$Lq.context,$Li=$Lr.backingStorePixelRatio||$Lr.webkitBackingStorePixelRatio||$Lr.mozBackingStorePixelRatio||$Lr.msBackingStorePixelRatio||$Lr.oBackingStorePixelRatio||$Lr.backingStorePixelRatio||1;($Lf.pixelRatio=($Lq.window.devicePixelRatio||1)/$Li)<1&&($Lf.pixelRatio=1)}return $Lf.pixelRatio},$Lf.getIncludeStr=function($Lr){return null},$Lf.createShaderCondition=function($Lr){var $Li="(function() {return "+$Lr+";})";return $Lw._runScript($Li)},$Lf.fontMap=[],$Lf.measureText=function($Lr,$Li){var $Lt=$Lf.hanzi.test($Lr);if($Lt&&$Lf.fontMap[$Li])return $Lf.fontMap[$Li];var $L_=$Lq.context;$L_.font=$Li;var $LA=$L_.measureText($Lr);return $LA||($LA={width:16,height:16}),$Lt&&($Lf.fontMap[$Li]=$LA),$LA},$Lf.getWebGLContext=function($Lr){},$Lf.beginFlush=function(){},$Lf.endFinish=function(){},$Lf.addToAtlas=null,$Lf.flashFlushImage=function($Lr){},$Lf.drawToCanvas=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=$Lnr.create("2D"),$LG=new $Lb($Lt,$L_,$LE);return $LV.renders[$Li]._fun($Lr,$LG,$LA,$Lf),$LE},$Lf.createParticleTemplate2D=null,$Lf.createGLTextur=null,$Lf.createWebGLContext2D=null,$Lf.changeWebGLSize=function($Lr,$Li){},$Lf.createRenderSprite=function($Lr,$Li){return new $LV($Lr,$Li)},$Lf.createFilterAction=function($Lr){return new $Ln},$Lf.createGraphics=function(){return new $LX},$Lf.clear=function($Lr){$LF._context.ctx.clear()},$Lf.cancelLoadByUrl=function($Lr){},$Lf.clearAtlas=function($Lr){},$Lf.isAtlas=function($Lr){return!1},$Lf.addTextureToAtlas=function($Lr){},$Lf.getTexturePixels=function($Lr,$Li,$Lt,$L_,$LA){return null},$Lf.skinAniSprite=function(){return null},$Lf.update3DLoop=function(){},$LN($Lf,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),$Lf}(),$L_=($LO(1,$Lw,"alertGlobalError",null,function($Lr){var $Lf=0;$Lq.window.onerror=$Lr?function($Lr,$Li,$Lt,$L_,$LA){$Lf++<5&&$LA&&alert($LA.stack||$LA)}:null}),$Lw.init=function($Lr,$Li,$Lt){for(var $L_=[],$LA=2,$Lf=arguments.length;$LA<$Lf;$LA++)$L_.push(arguments[$LA]);if(!$Lw._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=$Lw._arrayBufferSlice),$Lw._isinit=!0,$Lq.__init__(),$Lh.__init__(),$LX.__init__(),$Lw.timer=new $LW,$Lw.scaleTimer=new $LW,$Lw.loader=new $LNr,$LY.__init__(),$LA=0;for(var $LE=$L_.length;$LA<$LE;$LA++)$L_[$LA].enable&&$L_[$LA].enable();return $Lv.__init__(),$LG.__init__(),$LP.__init__(),$LT.beginCheck(),$Lw._currentStage=$Lw.stage=new $Lyr,$Lw.stage.conchModel&&$Lw.stage.conchModel.setRootNode(),$Lw._getUrlPath(),$Lw.render=new $LF(0,0),$Lw.stage.size($Lr,$Li),$LV.__init__(),$LR.__init__(),$Lc.instance.__init__($Lw.stage,$LF.canvas),$LDr.__init__(),$LU.autoStopMusic=!0,$Ld.__init__(),$LF.canvas}},$Lw._getUrlPath=function(){var $Lr=$Lq.window.location,$Li=$Lr.pathname;$Li=$Li&&":"==$Li.charAt(2)?$Li.substring(1):$Li,$LQ.rootPath=$LQ.basePath=$LQ.getPath("file:"==$Lr.protocol?$Li:$Lr.protocol+"//"+$Lr.host+$Lr.pathname)},$Lw._arrayBufferSlice=function($Lr,$Li){var $Lt=new Uint8Array(this,$Lr,$Li-$Lr),$L_=new Uint8Array($Lt.length);return $L_.set($Lt),$L_.buffer},$Lw._runScript=function($Lr){return $Lq.window[$Lw._evcode]($Lr)},$Lw.stage=null,$Lw.timer=null,$Lw.scaleTimer=null,$Lw.loader=null,$Lw.version="1.8.6",$Lw.render=null,$Lw._currentStage=null,$Lw._isinit=!1,$Lw.isDebug=!1,$Lw.MiniAdpter={init:function(){$LE.navigator&&$LE.navigator.userAgent&&-1<$LE.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},$LN($Lw,["conchMarket",function(){return this.conchMarket=$LE.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=$LE.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function $Lr(){}return $Lg($Lr,"Config"),$Lr.WebGLTextCacheCount=500,$Lr.atlasEnable=!1,$Lr.showCanvasMark=!1,$Lr.animationInterval=50,$Lr.isAntialias=!1,$Lr.isAlpha=!1,$Lr.premultipliedAlpha=!0,$Lr.isStencil=!0,$Lr.preserveDrawingBuffer=!1,$Lr}()),$Lp=function(){function $Lp(){this._events=null}$Lg($Lp,"laya.events.EventDispatcher");var $Lr=$Lp.prototype;return $Lr.hasListener=function($Lr){return!!(this._events&&this._events[$Lr])},$Lr.getListener=function($Lr){return this._events?this._events[$Lr]:null},$Lr.event=function($Lr,$Li){if(!this._events||!this._events[$Lr])return!1;var $Lt=this._events[$Lr];if($Lt.lock)$Lt.queue||($Lt.queue=[]),$Lt.queue.push($Li);else{var $L_;for($Lt.lock=!0,$Lt.cursor=$Lt.head;$Lt.cursor;)($L_=$Lt.cursor).recover?($Lt.head=$Lt.tail=$Lt.cursor=null,console.error("node is recover："+$L_.id)):($Lt.cursor=$L_.next,$L_.once&&$Lp.delNode($Lt,$L_),$L_.method&&(null!=$Li?$L_.args?$L_.method.apply($L_.caller,$L_.args.concat($Li)):$Li instanceof Array?$L_.method.apply($L_.caller,$Li):$L_.caller?$L_.method.call($L_.caller,$Li):$Lw.recordError("事件派发错误","node.caller:"+$L_.caller+"node.method:"+$L_.method+"data:"+$Li+"node.prev"+$L_.prev):$L_.method.apply($L_.caller,$L_.args)),$L_.once&&$Lp.recoverHandler($L_));$Lt.lock=!1,!$Lt.head&&this._events&&this._events[$Lr]==$Lt&&delete this._events[$Lr],$Lt.queue&&$Lt.queue.length&&this.event($Lr,$Lt.queue.shift())}return!0},$Lr.on=function($Lr,$Li,$Lt,$L_){return this._createListener($Lr,$Li,$Lt,$L_,!1)},$Lr.once=function($Lr,$Li,$Lt,$L_){return this._createListener($Lr,$Li,$Lt,$L_,!0)},$Lr._createListener=function($Lr,$Li,$Lt,$L_,$LA,$Lf){void 0===$Lf&&($Lf=!0),$Lf&&this.off($Lr,$Li,$Lt,$LA);var $LE=$Lp.createHandler($Li||this,$Lt,$L_,$LA);this._events||(this._events={});var $LG=this._events,$LN=$LG[$Lr];return $LN?$LN.tail?($LE.prev=$LN.tail,$LN.tail.next=$LE,$LN.tail=$LE):$LN.head=$LN.tail=$LE:$LG[$Lr]={head:$LE,tail:$LE,cursor:null,lock:!1},this},$Lr.off=function($Lr,$Li,$Lt,$L_){if(void 0===$L_&&($L_=!1),!this._events||!this._events[$Lr])return this;for(var $LA=this._events[$Lr],$Lf=$LA.head;$Lf;){if((!$Li||$Lf.caller===$Li)&&$Lf.method===$Lt&&(!$L_||$Lf.once)){$Lp.delNode($LA,$Lf),$LA.cursor==$Lf&&($LA.cursor=$Lf.next),$Lp.recoverHandler($Lf);break}$Lf=$Lf.next}return this},$Lr.offAll=function($Lr){var $Li=this._events;if(!$Li)return this;if($Lr)this._recoverHandlers($Li[$Lr]),delete $Li[$Lr];else{for(var $Lt in $Li)this._recoverHandlers($Li[$Lt]);this._events=null}return this},$Lr._recoverHandlers=function($Lr){if($Lr){for(var $Li=$Lr.head;$Li;){$Lp.delNode($Lr,$Li);var $Lt=$Li.next;$Lp.recoverHandler($Li),$Li=$Lt}$Lr.cursor=null}},$Lr.isMouseEvent=function($Lr){return $Lp.MOUSE_EVENTS[$Lr]},$Lp.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},$Lp.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},$Lp.delNode=function($Lr,$Li){$Li.prev?$Li.prev.next=$Li.next:$Lr.head=$Li.next,$Li.next?$Li.next.prev=$Li.prev:$Lr.tail=$Li.prev},$Lp.createHandler=function($Lr,$Li,$Lt,$L_){var $LA=500<$Lp._freeHandler.length?$Lp._freeHandler.shift():null;if($LA)if($LA.recover)$LA.recover=!1,$LA.caller=$Lr,$LA.method=$Li,$LA.args=$Lt,$LA.once=$L_;else{var $Lf="";try{arguments.propertyIsEnumerable.caller}catch($Lr){$Lf=$Lr.stack}var $LE=$LA.caller?($LA.caller.__proto__&&$LA.caller.__proto__.constructor&&$LA.caller.__proto__.constructor.name)+"|"+$LA.caller.__className+"|"+$LA.caller.name:"",$LG=$LA.method?$LA.method.name:"";$Lw.recordError("EventDispatcher重复创建","caller="+$LE+"  method="+$LG+"  stack="+$Lf),$LA={id:++$Lp._nodeCount,caller:$Lr,method:$Li,args:$Lt,once:$L_,recover:!1}}else $LA={id:++$Lp._nodeCount,caller:$Lr,method:$Li,args:$Lt,once:$L_,recover:!1};return $LA.prev=$LA.next=null,$LA},$Lp.recoverHandler=function($Lr){if($Lr.recover){if($Lp._errorCount<5){$Lp._errorCount++;var $Li="";try{arguments.propertyIsEnumerable.caller}catch($Lr){$Li=$Lr.stack}var $Lt=$Lr.caller?($Lr.caller.__proto__&&$Lr.caller.__proto__.constructor&&$Lr.caller.__proto__.constructor.name)+"|"+$Lr.caller.__className+"|"+$Lr.caller.name:"",$L_=$Lr.method?$Lr.method.name:"";$Lw.recordError("EventDispatcher重复回收","id="+$Lr.id+"  caller="+$Lt+"  method="+$L_+"  stack="+$Li)}$Lr.caller=$Lr.method=$Lr.args=$Lr.prev=null}else $Lr.recover=!0,$Lr.caller=$Lr.method=$Lr.args=$Lr.prev=$Lr.next=null,$Lp._freeHandler&&$Lp._freeHandler.length<3e3&&$Lp._freeHandler.push($Lr)},$Lp._freeHandler=[],$Lp._nodeCount=0,$Lp._errorCount=0,$Lp}(),$LC=function(){function $LA($Lr,$Li,$Lt,$L_){this.once=!1,void(this._id=0)===$L_&&($L_=!1),this.setTo($Lr,$Li,$Lt,$L_)}$Lg($LA,"laya.utils.Handler");var $Lr=$LA.prototype;return $Lr.setTo=function($Lr,$Li,$Lt,$L_){return this._id=$LA._gid++,this.caller=$Lr,this.method=$Li,this.args=$Lt,this.once=$L_,this},$Lr.run=function(){if(null==this.method)return null;var $Lr=this._id,$Li=this.method.apply(this.caller,this.args);return this._id===$Lr&&this.once&&this.recover(),$Li},$Lr.runWith=function($Lr){if(null==this.method)return null;var $Li=this._id;if(null==$Lr)var $Lt=this.method.apply(this.caller,this.args);else $Lt=this.args||$Lr.unshift?this.args?this.method.apply(this.caller,this.args.concat($Lr)):this.method.apply(this.caller,$Lr):this.method.call(this.caller,$Lr);return this._id===$Li&&this.once&&this.recover(),$Lt},$Lr.clear=function(){return this.caller=null,this.method=null,this.args=null,this},$Lr.recover=function(){0<this._id&&(this._id=0,this.clear())},$LA.create=function($Lr,$Li,$Lt,$L_){return void 0===$L_&&($L_=!0),new $LA($Lr,$Li,$Lt,$L_)},$LA._gid=1,$LA}(),$Ll=function(){function $Lr(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}$Lg($Lr,"laya.display.BitmapFont");var $Li=$Lr.prototype;return $Li.loadFont=function($Lr,$Li){this._path=$Lr,this._complete=$Li,$Lw.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],$LC.create(this,this.onLoaded))},$Li.onLoaded=function(){this.parseFont($LGr.getRes(this._path),$LGr.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},$Li.parseFont=function($Lr,$Li){if(null!=$Lr&&null!=$Li){this._texture=$Li;var $Lt=$Lr.getElementsByTagName("info");if(!$Lt[0].getAttributeNode)return this.parseFont2($Lr,$Li);this.fontSize=parseInt($Lt[0].getAttributeNode("size").nodeValue);var $L_,$LA=$Lt[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt($LA[0]),parseInt($LA[1]),parseInt($LA[2]),parseInt($LA[3])],$L_=$Lr.getElementsByTagName("char");var $Lf=0;for($Lf=0;$Lf<$L_.length;$Lf++){var $LE=$L_[$Lf],$LG=parseInt($LE.getAttributeNode("id").nodeValue),$LN=parseInt($LE.getAttributeNode("xoffset").nodeValue)/1,$Lp=parseInt($LE.getAttributeNode("yoffset").nodeValue)/1,$Lg=parseInt($LE.getAttributeNode("xadvance").nodeValue)/1,$LR=new $Ls;$LR.x=parseInt($LE.getAttributeNode("x").nodeValue),$LR.y=parseInt($LE.getAttributeNode("y").nodeValue),$LR.width=parseInt($LE.getAttributeNode("width").nodeValue),$LR.height=parseInt($LE.getAttributeNode("height").nodeValue);var $LX=$Lgr.create($Li,$LR.x,$LR.y,$LR.width,$LR.height,$LN,$Lp);this._maxWidth=Math.max(this._maxWidth,$Lg+this.letterSpacing),this._fontCharDic[$LG]=$LX,this._fontWidthMap[$LG]=$Lg}}},$Li.parseFont2=function($Lr,$Li){if(null!=$Lr&&null!=$Li){this._texture=$Li;var $Lt=$Lr.getElementsByTagName("info");this.fontSize=parseInt($Lt[0].attributes.size.nodeValue);var $L_=$Lt[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt($L_[0]),parseInt($L_[1]),parseInt($L_[2]),parseInt($L_[3])];var $LA=$Lr.getElementsByTagName("char"),$Lf=0;for($Lf=0;$Lf<$LA.length;$Lf++){var $LE=$LA[$Lf].attributes,$LG=parseInt($LE.id.nodeValue),$LN=parseInt($LE.xoffset.nodeValue)/1,$Lp=parseInt($LE.yoffset.nodeValue)/1,$Lg=parseInt($LE.xadvance.nodeValue)/1,$LR=new $Ls;$LR.x=parseInt($LE.x.nodeValue),$LR.y=parseInt($LE.y.nodeValue),$LR.width=parseInt($LE.width.nodeValue),$LR.height=parseInt($LE.height.nodeValue);var $LX=$Lgr.create($Li,$LR.x,$LR.y,$LR.width,$LR.height,$LN,$Lp);this._maxWidth=Math.max(this._maxWidth,$Lg+this.letterSpacing),this._fontCharDic[$LG]=$LX,this._fontWidthMap[$LG]=$Lg}}},$Li.getCharTexture=function($Lr){return this._fontCharDic[$Lr.charCodeAt(0)]},$Li.destroy=function(){if(this._texture){for(var $Lr in this._fontCharDic){var $Li=this._fontCharDic[$Lr];$Li&&$Li.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},$Li.setSpaceWidth=function($Lr){this._spaceWidth=$Lr},$Li.getCharWidth=function($Lr){var $Li=$Lr.charCodeAt(0);return this._fontWidthMap[$Li]?this._fontWidthMap[$Li]+this.letterSpacing:" "==$Lr?this._spaceWidth+this.letterSpacing:0},$Li.getTextWidth=function($Lr){for(var $Li=0,$Lt=0,$L_=$Lr.length;$Lt<$L_;$Lt++)$Li+=this.getCharWidth($Lr.charAt($Lt));return $Li},$Li.getMaxWidth=function(){return this._maxWidth},$Li.getMaxHeight=function(){return this.fontSize},$Li.drawText=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE,$LG=this.getTextWidth($Lr),$LN=0;"center"===$LA&&($LN=($Lf-$LG)/2),"right"===$LA&&($LN=$Lf-$LG);for(var $Lp=0,$Lg=0,$LR=$Lr.length;$Lg<$LR;$Lg++)($LE=this.getCharTexture($Lr.charAt($Lg)))&&($Li.graphics.drawTexture($LE,$Lt+$Lp+$LN,$L_),$Lp+=this.getCharWidth($Lr.charAt($Lg)))},$Lr}(),$LG=function(){function $Lt(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=$Lt._TF_EMPTY}$Lg($Lt,"laya.display.css.Style");var $Lr=$Lt.prototype;return $Lr.getTransform=function(){return this._tf},$Lr.setTransform=function($Lr){this._tf="none"!==$Lr&&$Lr?$Lr:$Lt._TF_EMPTY},$Lr.setTranslateX=function($Lr){this._tf===$Lt._TF_EMPTY&&(this._tf=new $LA),this._tf.translateX=$Lr},$Lr.setTranslateY=function($Lr){this._tf===$Lt._TF_EMPTY&&(this._tf=new $LA),this._tf.translateY=$Lr},$Lr.setScaleX=function($Lr){this._tf===$Lt._TF_EMPTY&&(this._tf=new $LA),this._tf.scaleX=$Lr},$Lr.setScale=function($Lr,$Li){this._tf===$Lt._TF_EMPTY&&(this._tf=new $LA),this._tf.scaleX=$Lr,this._tf.scaleY=$Li},$Lr.setScaleY=function($Lr){this._tf===$Lt._TF_EMPTY&&(this._tf=new $LA),this._tf.scaleY=$Lr},$Lr.setRotate=function($Lr){this._tf===$Lt._TF_EMPTY&&(this._tf=new $LA),this._tf.rotate=$Lr},$Lr.setSkewX=function($Lr){this._tf===$Lt._TF_EMPTY&&(this._tf=new $LA),this._tf.skewX=$Lr},$Lr.setSkewY=function($Lr){this._tf===$Lt._TF_EMPTY&&(this._tf=new $LA),this._tf.skewY=$Lr},$Lr.destroy=function(){this.scrollRect=null},$Lr.render=function($Lr,$Li,$Lt,$L_){},$Lr.getCSSStyle=function(){return $Lir.EMPTY},$Lr._enableLayout=function(){return!1},$LO(0,$Lr,"scaleX",function(){return this._tf.scaleX},function($Lr){this.setScaleX($Lr)}),$LO(0,$Lr,"transform",function(){return this.getTransform()},function($Lr){this.setTransform($Lr)}),$LO(0,$Lr,"translateX",function(){return this._tf.translateX},function($Lr){this.setTranslateX($Lr)}),$LO(0,$Lr,"translateY",function(){return this._tf.translateY},function($Lr){this.setTranslateY($Lr)}),$LO(0,$Lr,"scaleY",function(){return this._tf.scaleY},function($Lr){this.setScaleY($Lr)}),$LO(0,$Lr,"block",function(){return 0!=(1&this._type)}),$LO(0,$Lr,"skewY",function(){return this._tf.skewY},function($Lr){this.setSkewY($Lr)}),$LO(0,$Lr,"rotate",function(){return this._tf.rotate},function($Lr){this.setRotate($Lr)}),$LO(0,$Lr,"skewX",function(){return this._tf.skewX},function($Lr){this.setSkewX($Lr)}),$LO(0,$Lr,"paddingLeft",function(){return 0}),$LO(0,$Lr,"paddingTop",function(){return 0}),$LO(0,$Lr,"absolute",function(){return!0}),$Lt.__init__=function(){$Lt._TF_EMPTY=new $LA,$Lt.EMPTY=new $Lt},$Lt.EMPTY=null,$Lt._TF_EMPTY=null,$Lt}(),$Lv=function(){function $Li($Lr){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=$L$.create($Li.defaultColor),this.family=$Li.defaultFamily,this.stroke=$Li._STROKE,this.size=$Li.defaultSize,$Lr&&$Lr!==$Li.EMPTY&&$Lr.copyTo(this)}$Lg($Li,"laya.display.css.Font");var $Lr=$Li.prototype;return $Lr.set=function($Lr){this._text=null;for(var $Li=$Lr.split(" "),$Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++){var $LA=$Li[$Lt];switch($LA){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<$LA.indexOf("px")&&(this.size=parseInt($LA),this.family=$Li[$Lt+1],$Lt++)}},$Lr.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},$Lr.copyTo=function($Lr){$Lr._type=this._type,$Lr._text=this._text,$Lr._weight=this._weight,$Lr._color=this._color,$Lr.family=this.family,$Lr.stroke=this.stroke!=$Li._STROKE?this.stroke.slice():$Li._STROKE,$Lr.indent=this.indent,$Lr.size=this.size},$LO(0,$Lr,"password",function(){return 0!=(1024&this._type)},function($Lr){$Lr?this._type|=1024:this._type&=-1025}),$LO(0,$Lr,"color",function(){return this._color.strColor},function($Lr){this._color=$L$.create($Lr)}),$LO(0,$Lr,"italic",function(){return 0!=(512&this._type)},function($Lr){$Lr?this._type|=512:this._type&=-513}),$LO(0,$Lr,"bold",function(){return 0!=(2048&this._type)},function($Lr){$Lr?this._type|=2048:this._type&=-2049}),$LO(0,$Lr,"weight",function(){return""+this._weight},function($Lr){var $Li=0;switch($Lr){case"normal":break;case"bold":this.bold=!0,$Li=700;break;case"bolder":$Li=800;break;case"lighter":$Li=100;break;default:$Li=parseInt($Lr)}this._weight=$Li,this._text=null}),$LO(0,$Lr,"decoration",function(){return this._decoration?this._decoration.value:null},function($Lr){var $Li=$Lr.split(" ");switch(this._decoration||(this._decoration={}),$Li[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=$Li[0]}$Li[1]&&(this._decoration.color=$L$.create($Li)),this._decoration.value=$Lr}),$Li.__init__=function(){$Li.EMPTY=new $Li(null)},$Li.EMPTY=null,$Li.defaultColor="#000000",$Li.defaultSize=12,$Li.defaultFamily="Arial",$Li.defaultFont="12px Arial",$Li._STROKE=[0,"#000000"],$Li._ITALIC=512,$Li._PASSWORD=1024,$Li._BOLD=2048,$Li}(),$LA=function(){function $Lr(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return $Lg($Lr,"laya.display.css.TransformInfo"),$Lr}(),$LX=function(){function $LR(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,$LF.isConchNode){this._nativeObj=new $LE._conchGraphics,this.id=this._nativeObj.conchID}}$Lg($LR,"laya.display.Graphics");var $Lr=$LR.prototype;return $Lr.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},$Lr.clear=function($Lr){void 0===$Lr&&($Lr=!1);var $Li=0,$Lt=0;if($Lr){var $L_=this._one;if(this._cmds){for($Lt=this._cmds.length,$Li=0;$Li<$Lt;$Li++)!($L_=this._cmds[$Li])||$L_.callee!==$LF._context._drawTexture&&$L_.callee!==$LF._context._drawTextureWithTransform||($L_[0]=null,$LR._cache.push($L_));this._cmds.length=0}else $L_&&(!$L_||$L_.callee!==$LF._context._drawTexture&&$L_.callee!==$LF._context._drawTextureWithTransform||($L_[0]=null,$LR._cache.push($L_)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for($Li=0,$Lt=this._vectorgraphArray.length;$Li<$Lt;$Li++)$LS.getInstance().deleteShape(this._vectorgraphArray[$Li]);this._vectorgraphArray.length=0}},$Lr._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},$Lr._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new $Lt,this._graphicBounds._graphics=this)},$Lr._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},$Lr._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},$Lr.getBounds=function($Lr){return void 0===$Lr&&($Lr=!1),this._initGraphicBounds(),this._graphicBounds.getBounds($Lr)},$Lr.getBoundPoints=function($Lr){return void 0===$Lr&&($Lr=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints($Lr)},$Lr._addCmd=function($Lr){this._cmds=this._cmds||[],$Lr.callee=$Lr.shift(),this._cmds.push($Lr)},$Lr.setFilters=function($Lr){this._saveToCmd($LF._context._setFilters,$Lr)},$Lr.drawTexture=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){if(void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=0),void 0===$LA&&($LA=0),void 0===$LE&&($LE=1),!$Lr||$LE<.01)return null;$L_||($L_=$Lr.sourceWidth),$LA||($LA=$Lr.sourceHeight),$LE=$LE<0?0:1<$LE?1:$LE;var $LG,$LN=!$LF.isWebGL&&($Lq.onFirefox||$Lq.onEdge||$Lq.onIE||$Lq.onSafari)?.5:0,$Lp=$L_/$Lr.sourceWidth,$Lg=$LA/$Lr.sourceHeight;return $L_=$Lr.width*$Lp,$LA=$Lr.height*$Lg,$Lr.loaded&&($L_<=0||$LA<=0)?null:($Li+=$Lr.offsetX*$Lp,$Lt+=$Lr.offsetY*$Lg,this._sp&&(this._sp._renderType|=512),$Li-=$LN,$Lt-=$LN,$L_+=2*$LN,$LA+=2*$LN,$LR._cache.length?(($LG=$LR._cache.pop())[0]=$Lr,$LG[1]=$Li,$LG[2]=$Lt,$LG[3]=$L_,$LG[4]=$LA,$LG[5]=$Lf,$LG[6]=$LE):$LG=[$Lr,$Li,$Lt,$L_,$LA,$Lf,$LE],$LG.callee=$Lf||1!=$LE?$LF._context._drawTextureWithTransform:$LF._context._drawTexture,null!=this._one||$Lf||1!=$LE?this._saveToCmd($LG.callee,$LG):(this._one=$LG,this._render=this._renderOneImg),$Lr.loaded||$Lr.once("loaded",this,this._textureLoaded,[$Lr,$LG]),this._repaint(),$LG)},$Lr.cleanByTexture=function($Lr,$Li,$Lt,$L_,$LA){if(void 0===$L_&&($L_=0),void 0===$LA&&($LA=0),!$Lr)return this.clear();if(this._one&&this._render===this._renderOneImg){$L_||($L_=$Lr.sourceWidth),$LA||($LA=$Lr.sourceHeight);var $Lf=$L_/$Lr.sourceWidth,$LE=$LA/$Lr.sourceHeight;$L_=$Lr.width*$Lf,$LA=$Lr.height*$LE,$Li+=$Lr.offsetX*$Lf,$Lt+=$Lr.offsetY*$LE,this._one[0]=$Lr,this._one[1]=$Li,this._one[2]=$Lt,this._one[3]=$L_,this._one[4]=$LA,this._repaint()}else this.clear(),$Lr&&this.drawTexture($Lr,$Li,$Lt,$L_,$LA)},$Lr.drawTextures=function($Lr,$Li){$Lr&&this._saveToCmd($LF._context._drawTextures,[$Lr,$Li])},$Lr.fillTexture=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){if(void 0===$L_&&($L_=0),void 0===$LA&&($LA=0),void 0===$Lf&&($Lf="repeat"),$Lr){var $LG=[$Lr,$Li,$Lt,$L_,$LA,$Lf,$LE||$LH.EMPTY,{}];$Lr.loaded||$Lr.once("loaded",this,this._textureLoaded,[$Lr,$LG]),this._saveToCmd($LF._context._fillTexture,$LG)}},$Lr._textureLoaded=function($Lr,$Li){$Li[3]=$Li[3]||$Lr.width,$Li[4]=$Li[4]||$Lr.height,this._repaint()},$Lr.fillCircle=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){$Lt.bitmap.enableMerageInAtlas=!1;var $LG=new Float32Array(2*($LE+1)),$LN=new Float32Array(2*($LE+1)),$Lp=new Uint16Array(3*$LE),$Lg=2*Math.PI/$LE,$LR=0;$LG[0]=$L_,$LG[1]=$LA,$LN[0]=$L_/$Lt.width,$LN[1]=$LA/$Lt.height;for(var $LX=2,$Lv=0;$Lv<$LE;$Lv++){var $LO=$Lf*Math.cos($LR)+$L_,$Lc=$Lf*Math.sin($LR)+$LA;$LG[$LX]=$LO,$LG[$LX+1]=$Lc,$LN[$LX]=$LO/$Lt.width,$LN[$LX+1]=$Lc/$Lt.height,$LR+=$Lg,$LX+=2}for($Lv=$LX=0;$Lv<$LE;$Lv++)$Lp[$LX++]=0,$Lp[$LX++]=$Lv+1,$Lp[$LX++]=$LE+1<=$Lv+2?1:$Lv+2;this.drawTriangles($Lt,$Lr,$Li,$LG,$LN,$Lp)},$Lr.drawTriangles=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){void 0===$LG&&($LG=1),this._saveToCmd($LF._context.drawTriangles,[$Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp])},$Lr._saveToCmd=function($Lr,$Li){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=$Li,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push($Li)),$Li.callee=$Lr,this._repaint(),$Li},$Lr.clipRect=function($Lr,$Li,$Lt,$L_){this._saveToCmd($LF._context._clipRect,[$Lr,$Li,$Lt,$L_])},$Lr.fillText=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){void 0===$LE&&($LE=0),this._saveToCmd($LF._context._fillText,[$Lr,$Li,$Lt,$L_||$Lv.defaultFont,$LA,$Lf])},$Lr.fillBorderText=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){this._saveToCmd($LF._context._fillBorderText,[$Lr,$Li,$Lt,$L_||$Lv.defaultFont,$LA,$Lf,$LE,$LG])},$Lr.strokeText=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this._saveToCmd($LF._context._strokeText,[$Lr,$Li,$Lt,$L_||$Lv.defaultFont,$LA,$Lf,$LE])},$Lr.alpha=function($Lr){$Lr=$Lr<0?0:1<$Lr?1:$Lr,this._saveToCmd($LF._context._alpha,[$Lr])},$Lr.setAlpha=function($Lr){$Lr=$Lr<0?0:1<$Lr?1:$Lr,this._saveToCmd($LF._context._setAlpha,[$Lr])},$Lr.transform=function($Lr,$Li,$Lt){void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),this._saveToCmd($LF._context._transform,[$Lr,$Li,$Lt])},$Lr.rotate=function($Lr,$Li,$Lt){void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),this._saveToCmd($LF._context._rotate,[$Lr,$Li,$Lt])},$Lr.scale=function($Lr,$Li,$Lt,$L_){void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=0),this._saveToCmd($LF._context._scale,[$Lr,$Li,$Lt,$L_])},$Lr.translate=function($Lr,$Li){this._saveToCmd($LF._context._translate,[$Lr,$Li])},$Lr.save=function(){this._saveToCmd($LF._context._save,[])},$Lr.restore=function(){this._saveToCmd($LF._context._restore,[])},$Lr.replaceText=function($Lr){this._repaint();var $Li=this._cmds;if($Li){for(var $Lt=$Li.length-1;-1<$Lt;$Lt--)if(this._isTextCmd($Li[$Lt].callee))return $Li[$Lt][0].toUpperCase?$Li[$Lt][0]=$Lr:$Li[$Lt][0].setText($Lr),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=$Lr:this._one[0].setText($Lr),!0;return!1},$Lr._isTextCmd=function($Lr){return $Lr===$LF._context._fillText||$Lr===$LF._context._fillBorderText||$Lr===$LF._context._strokeText},$Lr.replaceTextColor=function($Lr){this._repaint();var $Li=this._cmds;if($Li)for(var $Lt=$Li.length-1;-1<$Lt;$Lt--)this._isTextCmd($Li[$Lt].callee)&&($Li[$Lt][4]=$Lr,$Li[$Lt][0].toUpperCase||($Li[$Lt][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=$Lr,this._one[0].toUpperCase||(this._one[0].changed=!0))},$Lr.loadImage=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=this;void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=0),void 0===$LA&&($LA=0);var $LG=$LGr.getRes($Lr);function $LN($Lr){$Lr&&($LE.drawTexture($Lr,$Li,$Lt,$L_,$LA),null!=$Lf&&$Lf.call($LE._sp,$Lr))}$LG?$LN($LG):$Lw.loader.load($Lr,$LC.create(null,$LN),null,"image")},$Lr._renderEmpty=function($Lr,$Li,$Lt,$L_){},$Lr._renderAll=function($Lr,$Li,$Lt,$L_){for(var $LA,$Lf=this._cmds,$LE=0,$LG=$Lf.length;$LE<$LG;$LE++)($LA=$Lf[$LE]).callee.call($Li,$Lt,$L_,$LA)},$Lr._renderOne=function($Lr,$Li,$Lt,$L_){this._one.callee.call($Li,$Lt,$L_,this._one)},$Lr._renderOneImg=function($Lr,$Li,$Lt,$L_){this._one.callee.call($Li,$Lt,$L_,this._one),2305!==$Lr._renderType&&($Lr._renderType|=1)},$Lr.drawLine=function($Lr,$Li,$Lt,$L_,$LA,$Lf){void 0===$Lf&&($Lf=1);var $LE=0;$LF.isWebGL&&($LE=$LS.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($LE));var $LG=$Lf%2==0?0:.5,$LN=[$Lr+$LG,$Li+$LG,$Lt+$LG,$L_+$LG,$LA,$Lf,$LE];this._saveToCmd($LF._context._drawLine,$LN)},$Lr.drawLines=function($Lr,$Li,$Lt,$L_,$LA){void 0===$LA&&($LA=1);var $Lf=0;if($Lt&&!($Lt.length<4)){$LF.isWebGL&&($Lf=$LS.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($Lf));var $LE=$LA%2==0?0:.5,$LG=[$Lr+$LE,$Li+$LE,$Lt,$L_,$LA,$Lf];this._saveToCmd($LF._context._drawLines,$LG)}},$Lr.drawCurves=function($Lr,$Li,$Lt,$L_,$LA){void 0===$LA&&($LA=1);var $Lf=[$Lr,$Li,$Lt,$L_,$LA];this._saveToCmd($LF._context._drawCurves,$Lf)},$Lr.drawRect=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){void 0===$LE&&($LE=1);var $LG=$Lf?$LE/2:0,$LN=$Lf?$LE:0,$Lp=[$Lr+$LG,$Li+$LG,$Lt-$LN,$L_-$LN,$LA,$Lf,$LE];this._saveToCmd($LF._context._drawRect,$Lp)},$Lr.drawCircle=function($Lr,$Li,$Lt,$L_,$LA,$Lf){void 0===$Lf&&($Lf=1);var $LE=$LA?$Lf/2:0,$LG=0;$LF.isWebGL&&($LG=$LS.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($LG));var $LN=[$Lr,$Li,$Lt-$LE,$L_,$LA,$Lf,$LG];this._saveToCmd($LF._context._drawCircle,$LN)},$Lr.drawPie=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){void 0===$LG&&($LG=1);var $LN=$LE?$LG/2:0,$Lp=$LE?$LG:0,$Lg=0;$LF.isWebGL&&($Lg=$LS.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($Lg));var $LR=[$Lr+$LN,$Li+$LN,$Lt-$Lp,$L_,$LA,$Lf,$LE,$LG,$Lg];$LR[3]=$LK.toRadian($L_),$LR[4]=$LK.toRadian($LA),this._saveToCmd($LF._context._drawPie,$LR)},$Lr.drawPoly=function($Lr,$Li,$Lt,$L_,$LA,$Lf){void 0===$Lf&&($Lf=1);var $LE=0,$LG=!1;$LF.isWebGL&&($LE=$LS.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($LE),$LG=!(6<$Lt.length));var $LN=$LA?$Lf%2==0?0:.5:0,$Lp=[$Lr+$LN,$Li+$LN,$Lt,$L_,$LA,$Lf,$LE,$LG];this._saveToCmd($LF._context._drawPoly,$Lp)},$Lr.drawPath=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=[$Lr,$Li,$Lt,$L_,$LA];this._saveToCmd($LF._context._drawPath,$Lf)},$LO(0,$Lr,"cmds",function(){return this._cmds},function($Lr){this._sp&&(this._sp._renderType|=512),this._cmds=$Lr,this._render=this._renderAll,this._repaint()}),$LR.__init__=function(){if($LF.isConchNode){for(var $Lr=laya.display.Graphics.prototype,$Li=$Lq.window.ConchGraphics.prototype,$Lt=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],$L_=0,$LA=$Lt.length;$L_<=$LA;$L_++){var $Lf=$Lt[$L_];$Lr[$Lf]=$Li[$Lf]}$Lr._saveToCmd=null,$Li.drawImageS&&($Lr.drawTextures=function($Lr,$Li){if($Lr&&$Lr.loaded&&$Lr.bitmap&&$Lr.source){var $Lt=$Lr.uv,$L_=$Lr.bitmap.width,$LA=$Lr.bitmap.height;this.drawImageS($Lr.bitmap.source,$Lt[0]*$L_,$Lt[1]*$LA,($Lt[2]-$Lt[0])*$L_,($Lt[5]-$Lt[3])*$LA,$Lr.offsetX,$Lr.offsetY,$Lr.width,$Lr.height,$Li)}}),$Lr.drawTexture=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){if(void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=0),void 0===$LA&&($LA=0),void 0===$LE&&($LE=1),$Lr)if($Lr.loaded){if($Lr.loaded&&$Lr.bitmap&&$Lr.source&&($L_||($L_=$Lr.sourceWidth),$LA||($LA=$Lr.sourceHeight),$LE=$LE<0?0:1<$LE?1:$LE,$L_=$L_-$Lr.sourceWidth+$Lr.width,$LA=$LA-$Lr.sourceHeight+$Lr.height,!($L_<=0||$LA<=0))){$Li+=$Lr.offsetX,$Lt+=$Lr.offsetY;var $LG=$Lr.uv,$LN=$Lr.bitmap.width,$Lp=$Lr.bitmap.height;$LG[4]<$LG[0]&&$LG[5]<$LG[1]?this.drawImageM($Lr.bitmap.source,$LG[4]*$LN,$LG[5]*$Lp,($LG[0]-$LG[4])*$LN,($LG[1]-$LG[5])*$Lp,$Li,$Lt,$L_,$LA,$Lf,$LE):this.drawImageM($Lr.bitmap.source,$LG[0]*$LN,$LG[1]*$Lp,($LG[2]-$LG[0])*$LN,($LG[5]-$LG[3])*$Lp,$Li,$Lt,$L_,$LA,$Lf,$LE),this._repaint()}}else $Lr.once("loaded",this,function(){this.drawTexture($Lr,$Li,$Lt,$L_,$LA,$Lf)})},$Lr.fillTexture=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){if(void 0===$L_&&($L_=0),void 0===$LA&&($LA=0),void 0===$Lf&&($Lf="repeat"),$Lr&&$Lr.loaded){var $LG,$LN=$LF._context.ctx,$Lp=$Lr.bitmap.width,$Lg=$Lr.bitmap.height,$LR=$Lr.uv;$LG=$Lr.uv!=$Lgr.DEF_UV?$LN.createPattern($Lr.bitmap.source,$Lf,$LR[0]*$Lp,$LR[1]*$Lg,($LR[2]-$LR[0])*$Lp,($LR[5]-$LR[3])*$Lg):$LN.createPattern($Lr.bitmap.source,$Lf);var $LX=0,$Lv=0;$LE&&($Li+=$LE.x%$Lr.width,$Lt+=$LE.y%$Lr.height,$LX-=$LE.x%$Lr.width,$Lv-=$LE.y%$Lr.height),this._fillImage($LG,$Li,$Lt,$LX,$Lv,$L_,$LA)}}}},$LR._cache=[],$LR}(),$Lt=function(){function $Ln(){this._cacheBoundsType=!1}$Lg($Ln,"laya.display.GraphicsBounds");var $Lr=$Ln.prototype;return $Lr.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},$Lr.reset=function(){this._temp&&(this._temp.length=0)},$Lr.getBounds=function($Lr){return void 0===$Lr&&($Lr=!1),(!this._bounds||!this._temp||this._temp.length<1||$Lr!=this._cacheBoundsType)&&(this._bounds=$Ls._getWrapRec(this.getBoundPoints($Lr),this._bounds)),this._cacheBoundsType=$Lr,this._bounds},$Lr.getBoundPoints=function($Lr){return void 0===$Lr&&($Lr=!1),(!this._temp||this._temp.length<1||$Lr!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints($Lr)),this._cacheBoundsType=$Lr,this._rstBoundPoints=$LK.copyArray(this._rstBoundPoints,this._temp)},$Lr._getCmdPoints=function($Lr){void 0===$Lr&&($Lr=!1);var $Li,$Lt,$L_=$LF._context,$LA=this._graphics.cmds;if(($Li=this._temp||(this._temp=[])).length=0,$LA||null==this._graphics._one||($Ln._tempCmds.length=0,$Ln._tempCmds.push(this._graphics._one),$LA=$Ln._tempCmds),!$LA)return $Li;($Lt=$Ln._tempMatrixArrays).length=0;var $Lf=$Ln._initMatrix;$Lf.identity();for(var $LE,$LG,$LN=$Ln._tempMatrix,$Lp=NaN,$Lg=NaN,$LR=NaN,$LX=NaN,$Lv=NaN,$LO=NaN,$Lc=0,$LB=$LA.length;$Lc<$LB;$Lc++)if(($LE=$LA[$Lc]).callee)switch($LE.callee){case $L_._save:case 7:$Lt.push($Lf),$Lf=$Lf.clone();break;case $L_._restore:case 8:$Lf=$Lt.pop();break;case $L_._scale:case 5:$LN.identity(),$LN.translate(-$LE[2],-$LE[3]),$LN.scale($LE[0],$LE[1]),$LN.translate($LE[2],$LE[3]),this._switchMatrix($Lf,$LN);break;case $L_._rotate:case 3:$LN.identity(),$LN.translate(-$LE[1],-$LE[2]),$LN.rotate($LE[0]),$LN.translate($LE[1],$LE[2]),this._switchMatrix($Lf,$LN);break;case $L_._translate:case 6:$LN.identity(),$LN.translate($LE[0],$LE[1]),this._switchMatrix($Lf,$LN);break;case $L_._transform:case 4:$LN.identity(),$LN.translate(-$LE[1],-$LE[2]),$LN.concat($LE[0]),$LN.translate($LE[1],$LE[2]),this._switchMatrix($Lf,$LN);break;case 16:case 24:$Ln._addPointArrToRst($Li,$Ls._getBoundPointS($LE[0],$LE[1],$LE[2],$LE[3]),$Lf);break;case 17:$Lf.copyTo($LN),$LN.concat($LE[4]),$Ln._addPointArrToRst($Li,$Ls._getBoundPointS($LE[0],$LE[1],$LE[2],$LE[3]),$LN);break;case $L_._drawTexture:$LG=$LE[0],$Lr?$LE[3]&&$LE[4]?$Ln._addPointArrToRst($Li,$Ls._getBoundPointS($LE[1],$LE[2],$LE[3],$LE[4]),$Lf):($LG=$LE[0],$Ln._addPointArrToRst($Li,$Ls._getBoundPointS($LE[1],$LE[2],$LG.width,$LG.height),$Lf)):($Lp=($LE[3]||$LG.sourceWidth)/$LG.width,$Lg=($LE[4]||$LG.sourceHeight)/$LG.height,$LR=$Lp*$LG.sourceWidth,$LX=$Lg*$LG.sourceHeight,$Lv=0<$LG.offsetX?$LG.offsetX:0,$LO=0<$LG.offsetY?$LG.offsetY:0,$Lv*=$Lp,$LO*=$Lg,$Ln._addPointArrToRst($Li,$Ls._getBoundPointS($LE[1]-$Lv,$LE[2]-$LO,$LR,$LX),$Lf));break;case $L_._fillTexture:$LE[3]&&$LE[4]?$Ln._addPointArrToRst($Li,$Ls._getBoundPointS($LE[1],$LE[2],$LE[3],$LE[4]),$Lf):($LG=$LE[0],$Ln._addPointArrToRst($Li,$Ls._getBoundPointS($LE[1],$LE[2],$LG.width,$LG.height),$Lf));break;case $L_._drawTextureWithTransform:var $Ly;$Ly=$LE[5]?($Lf.copyTo($LN),$LN.concat($LE[5]),$LN):$Lf,$Lr?$LE[3]&&$LE[4]?$Ln._addPointArrToRst($Li,$Ls._getBoundPointS($LE[1],$LE[2],$LE[3],$LE[4]),$Ly):($LG=$LE[0],$Ln._addPointArrToRst($Li,$Ls._getBoundPointS($LE[1],$LE[2],$LG.width,$LG.height),$Ly)):($LG=$LE[0],$Lp=($LE[3]||$LG.sourceWidth)/$LG.width,$Lg=($LE[4]||$LG.sourceHeight)/$LG.height,$LR=$Lp*$LG.sourceWidth,$LX=$Lg*$LG.sourceHeight,$Lv=0<$LG.offsetX?$LG.offsetX:0,$LO=0<$LG.offsetY?$LG.offsetY:0,$Lv*=$Lp,$LO*=$Lg,$Ln._addPointArrToRst($Li,$Ls._getBoundPointS($LE[1]-$Lv,$LE[2]-$LO,$LR,$LX),$Ly));break;case $L_._drawRect:case 13:$Ln._addPointArrToRst($Li,$Ls._getBoundPointS($LE[0],$LE[1],$LE[2],$LE[3]),$Lf);break;case $L_._drawCircle:case $L_._fillCircle:case 14:$Ln._addPointArrToRst($Li,$Ls._getBoundPointS($LE[0]-$LE[2],$LE[1]-$LE[2],$LE[2]+$LE[2],$LE[2]+$LE[2]),$Lf);break;case $L_._drawLine:case 20:$Ln._tempPoints.length=0;var $LC;$LC=.5*$LE[5],$LE[0]==$LE[2]?$Ln._tempPoints.push($LE[0]+$LC,$LE[1],$LE[2]+$LC,$LE[3],$LE[0]-$LC,$LE[1],$LE[2]-$LC,$LE[3]):$LE[1]==$LE[3]?$Ln._tempPoints.push($LE[0],$LE[1]+$LC,$LE[2],$LE[3]+$LC,$LE[0],$LE[1]-$LC,$LE[2],$LE[3]-$LC):$Ln._tempPoints.push($LE[0],$LE[1],$LE[2],$LE[3]),$Ln._addPointArrToRst($Li,$Ln._tempPoints,$Lf);break;case $L_._drawCurves:case 22:$Ln._addPointArrToRst($Li,$La.I.getBezierPoints($LE[2]),$Lf,$LE[0],$LE[1]);break;case $L_._drawPoly:case $L_._drawLines:case 18:$Ln._addPointArrToRst($Li,$LE[2],$Lf,$LE[0],$LE[1]);break;case $L_._drawPath:case 19:$Ln._addPointArrToRst($Li,this._getPathPoints($LE[2]),$Lf,$LE[0],$LE[1]);break;case $L_._drawPie:case 15:$Ln._addPointArrToRst($Li,this._getPiePoints($LE[0],$LE[1],$LE[2],$LE[3],$LE[4]),$Lf)}return 200<$Li.length?$Li=$LK.copyArray($Li,$Ls._getWrapRec($Li)._getBoundPoints()):8<$Li.length&&($Li=$LD.scanPList($Li)),$Li},$Lr._switchMatrix=function($Lr,$Li){$Li.concat($Lr),$Li.copyTo($Lr)},$Lr._getPiePoints=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Ln._tempPoints;$Ln._tempPoints.length=0,$Lf.push($Lr,$Li);var $LE=($LA-$L_)%(2*Math.PI)/10,$LG=NaN,$LN=$L_;for($LG=0;$LG<=10;$LG++)$Lf.push($Lr+$Lt*Math.cos($LN),$Li+$Lt*Math.sin($LN)),$LN+=$LE;return $Lf},$Lr._getPathPoints=function($Lr){var $Li,$Lt,$L_=0,$LA=$Ln._tempPoints;for($LA.length=0,$Li=$Lr.length,$L_=0;$L_<$Li;$L_++)1<($Lt=$Lr[$L_]).length&&($LA.push($Lt[1],$Lt[2]),3<$Lt.length&&$LA.push($Lt[3],$Lt[4]));return $LA},$Ln._addPointArrToRst=function($Lr,$Li,$Lt,$L_,$LA){void 0===$L_&&($L_=0),void 0===$LA&&($LA=0);var $Lf,$LE=0;for($Lf=$Li.length,$LE=0;$LE<$Lf;$LE+=2)$Ln._addPointToRst($Lr,$Li[$LE]+$L_,$Li[$LE+1]+$LA,$Lt)},$Ln._addPointToRst=function($Lr,$Li,$Lt,$L_){var $LA=$LH.TEMP;$LA.setTo($Li||0,$Lt||0),$L_.transformPoint($LA),$Lr.push($LA.x,$LA.y)},$Ln._tempPoints=[],$Ln._tempMatrixArrays=[],$Ln._tempCmds=[],$LN($Ln,["_tempMatrix",function(){return this._tempMatrix=new $Le},"_initMatrix",function(){return this._initMatrix=new $Le}]),$Ln}(),$Lf=function(){function $Lr(){}$Lg($Lr,"laya.events.Event");var $Li=$Lr.prototype;return $Li.setTo=function($Lr,$Li,$Lt){return this.type=$Lr,this.currentTarget=$Li,this.target=$Lt,this},$Li.stopPropagation=function(){this._stoped=!0},$LO(0,$Li,"stageY",function(){return $Lw.stage.mouseY}),$LO(0,$Li,"charCode",function(){return this.nativeEvent.charCode}),$LO(0,$Li,"touches",function(){var $Lr=this.nativeEvent.touches;if($Lr)for(var $Li=$Lw.stage,$Lt=0,$L_=$Lr.length;$Lt<$L_;$Lt++){var $LA=$Lr[$Lt],$Lf=$LH.TEMP;$Lf.setTo($LA.clientX,$LA.clientY),$Li._canvasTransform.invertTransformPoint($Lf),$Li.transform.invertTransformPoint($Lf),$LA.stageX=$Lf.x,$LA.stageY=$Lf.y}return $Lr}),$LO(0,$Li,"keyLocation",function(){return this.nativeEvent.keyLocation}),$LO(0,$Li,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),$LO(0,$Li,"altKey",function(){return this.nativeEvent.altKey}),$LO(0,$Li,"shiftKey",function(){return this.nativeEvent.shiftKey}),$LO(0,$Li,"stageX",function(){return $Lw.stage.mouseX}),$Lr.EMPTY=new $Lr,$Lr.MOUSE_DOWN="mousedown",$Lr.MOUSE_UP="mouseup",$Lr.CLICK="click",$Lr.RIGHT_MOUSE_DOWN="rightmousedown",$Lr.RIGHT_MOUSE_UP="rightmouseup",$Lr.RIGHT_CLICK="rightclick",$Lr.MOUSE_MOVE="mousemove",$Lr.MOUSE_OVER="mouseover",$Lr.MOUSE_OUT="mouseout",$Lr.MOUSE_WHEEL="mousewheel",$Lr.ROLL_OVER="mouseover",$Lr.ROLL_OUT="mouseout",$Lr.DOUBLE_CLICK="doubleclick",$Lr.CHANGE="change",$Lr.CHANGED="changed",$Lr.RESIZE="resize",$Lr.ADDED="added",$Lr.REMOVED="removed",$Lr.DISPLAY="display",$Lr.UNDISPLAY="undisplay",$Lr.ERROR="error",$Lr.COMPLETE="complete",$Lr.LOADED="loaded",$Lr.INITED="inited",$Lr.PROGRESS="progress",$Lr.INPUT="input",$Lr.RENDER="render",$Lr.OPEN="open",$Lr.MESSAGE="message",$Lr.CLOSE="close",$Lr.KEY_DOWN="keydown",$Lr.KEY_PRESS="keypress",$Lr.KEY_UP="keyup",$Lr.FRAME="enterframe",$Lr.DRAG_START="dragstart",$Lr.DRAG_MOVE="dragmove",$Lr.DRAG_END="dragend",$Lr.ENTER="enter",$Lr.SELECT="select",$Lr.BLUR="blur",$Lr.FOCUS="focus",$Lr.VISIBILITY_CHANGE="visibilitychange",$Lr.FOCUS_CHANGE="focuschange",$Lr.PLAYED="played",$Lr.PAUSED="paused",$Lr.STOPPED="stopped",$Lr.START="start",$Lr.END="end",$Lr.ENABLE_CHANGED="enablechanged",$Lr.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",$Lr.COMPONENT_ADDED="componentadded",$Lr.COMPONENT_REMOVED="componentremoved",$Lr.LAYER_CHANGED="layerchanged",$Lr.HIERARCHY_LOADED="hierarchyloaded",$Lr.RECOVERED="recovered",$Lr.RELEASED="released",$Lr.LINK="link",$Lr.LABEL="label",$Lr.FULL_SCREEN_CHANGE="fullscreenchange",$Lr.DEVICE_LOST="devicelost",$Lr.MESH_CHANGED="meshchanged",$Lr.MATERIAL_CHANGED="materialchanged",$Lr.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",$Lr.ANIMATION_CHANGED="animationchanged",$Lr.TRIGGER_ENTER="triggerenter",$Lr.TRIGGER_STAY="triggerstay",$Lr.TRIGGER_EXIT="triggerexit",$Lr.TRAIL_FILTER_CHANGE="trailfilterchange",$Lr.DOMINO_FILTER_CHANGE="dominofilterchange",$Lr}(),$LR=(function(){function $Lr(){}$Lg($Lr,"laya.events.Keyboard"),$Lr.NUMBER_0=48,$Lr.NUMBER_1=49,$Lr.NUMBER_2=50,$Lr.NUMBER_3=51,$Lr.NUMBER_4=52,$Lr.NUMBER_5=53,$Lr.NUMBER_6=54,$Lr.NUMBER_7=55,$Lr.NUMBER_8=56,$Lr.NUMBER_9=57,$Lr.A=65,$Lr.B=66,$Lr.C=67,$Lr.D=68,$Lr.E=69,$Lr.F=70,$Lr.G=71,$Lr.H=72,$Lr.I=73,$Lr.J=74,$Lr.K=75,$Lr.L=76,$Lr.M=77,$Lr.N=78,$Lr.O=79,$Lr.P=80,$Lr.Q=81,$Lr.R=82,$Lr.S=83,$Lr.T=84,$Lr.U=85,$Lr.V=86,$Lr.W=87,$Lr.X=88,$Lr.Y=89,$Lr.Z=90,$Lr.F1=112,$Lr.F2=113,$Lr.F3=114,$Lr.F4=115,$Lr.F5=116,$Lr.F6=117,$Lr.F7=118,$Lr.F8=119,$Lr.F9=120,$Lr.F10=121,$Lr.F11=122,$Lr.F12=123,$Lr.F13=124,$Lr.F14=125,$Lr.F15=126,$Lr.NUMPAD=21,$Lr.NUMPAD_0=96,$Lr.NUMPAD_1=97,$Lr.NUMPAD_2=98,$Lr.NUMPAD_3=99,$Lr.NUMPAD_4=100,$Lr.NUMPAD_5=101,$Lr.NUMPAD_6=102,$Lr.NUMPAD_7=103,$Lr.NUMPAD_8=104,$Lr.NUMPAD_9=105,$Lr.NUMPAD_ADD=107,$Lr.NUMPAD_DECIMAL=110,$Lr.NUMPAD_DIVIDE=111,$Lr.NUMPAD_ENTER=108,$Lr.NUMPAD_MULTIPLY=106,$Lr.NUMPAD_SUBTRACT=109,$Lr.SEMICOLON=186,$Lr.EQUAL=187,$Lr.COMMA=188,$Lr.MINUS=189,$Lr.PERIOD=190,$Lr.SLASH=191,$Lr.BACKQUOTE=192,$Lr.LEFTBRACKET=219,$Lr.BACKSLASH=220,$Lr.RIGHTBRACKET=221,$Lr.QUOTE=222,$Lr.ALTERNATE=18,$Lr.BACKSPACE=8,$Lr.CAPS_LOCK=20,$Lr.COMMAND=15,$Lr.CONTROL=17,$Lr.DELETE=46,$Lr.ENTER=13,$Lr.ESCAPE=27,$Lr.PAGE_UP=33,$Lr.PAGE_DOWN=34,$Lr.END=35,$Lr.HOME=36,$Lr.LEFT=37,$Lr.UP=38,$Lr.RIGHT=39,$Lr.DOWN=40,$Lr.SHIFT=16,$Lr.SPACE=32,$Lr.TAB=9,$Lr.INSERT=45}(),function(){function $LA(){}return $Lg($LA,"laya.events.KeyBoardManager"),$LA.__init__=function(){$LA._addEvent("keydown"),$LA._addEvent("keypress"),$LA._addEvent("keyup")},$LA._addEvent=function($Li){$Lq.document.addEventListener($Li,function($Lr){laya.events.KeyBoardManager._dispatch($Lr,$Li)},!0)},$LA._dispatch=function($Lr,$Li){if($LA.enabled){$LA._event._stoped=!1,$LA._event.nativeEvent=$Lr,$LA._event.keyCode=$Lr.keyCode||$Lr.which||$Lr.charCode,"keydown"===$Li?$LA._pressKeys[$LA._event.keyCode]=!0:"keyup"===$Li&&($LA._pressKeys[$LA._event.keyCode]=null);for(var $Lt=$Lw.stage.focus&&null!=$Lw.stage.focus.event&&$Lw.stage.focus.displayedInStage?$Lw.stage.focus:$Lw.stage,$L_=$Lt;$L_;)$L_.event($Li,$LA._event.setTo($Li,$L_,$Lt)),$L_=$L_.parent}},$LA.hasKeyDown=function($Lr){return $LA._pressKeys[$Lr]},$LA._pressKeys={},$LA.enabled=!0,$LN($LA,["_event",function(){return this._event=new $Lf}]),$LA}()),$Lc=(function(){function $Lr(){}$Lg($Lr,"laya.events.KeyLocation"),$Lr.STANDARD=0,$Lr.LEFT=1,$Lr.RIGHT=2,$Lr.NUM_PAD=3}(),function(){function $Lp(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=$Lq.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new $Lf,this._matrix=new $Le,this._point=new $LH,this._rect=new $Ls,this._prePoint=new $LH,this._curTouchID=NaN}$Lg($Lp,"laya.events.MouseManager");var $Lr=$Lp.prototype;return $Lr.__init__=function($Lr,$Li){var $Lt=this;this._stage=$Lr;var $L_=this,$LA=this._eventList;$Li.oncontextmenu=function($Lr){if($Lp.enabled)return!1},$Li.addEventListener("mousedown",function($Lr){$Lp.enabled&&($Lq.onIE||$Lr.preventDefault(),$LA.push($Lr),$L_.mouseDownTime=$Lq.now())}),$Li.addEventListener("mouseup",function($Lr){$Lp.enabled&&($Lr.preventDefault(),$LA.push($Lr),$L_.mouseDownTime=-$Lq.now())},!0),$Li.addEventListener("mousemove",function($Lr){if($Lp.enabled){$Lr.preventDefault();var $Li=$Lq.now();if($Li-$L_._lastMoveTimer<10)return;$L_._lastMoveTimer=$Li,$LA.push($Lr)}},!0),$Li.addEventListener("mouseout",function($Lr){$Lp.enabled&&$LA.push($Lr)}),$Li.addEventListener("mouseover",function($Lr){$Lp.enabled&&$LA.push($Lr)}),$Li.addEventListener("touchstart",function($Lr){$Lp.enabled&&($LA.push($Lr),$Lp._isFirstTouch||$LDr.isInputting||$Lr.preventDefault(),$L_.mouseDownTime=$Lq.now())}),$Li.addEventListener("touchend",function($Lr){$Lp.enabled?($Lp._isFirstTouch||$LDr.isInputting||$Lr.preventDefault(),$Lp._isFirstTouch=!1,$LA.push($Lr),$L_.mouseDownTime=-$Lq.now()):$Lt._curTouchID=NaN},!0),$Li.addEventListener("touchmove",function($Lr){$Lp.enabled&&($Lr.preventDefault(),$LA.push($Lr))},!0),$Li.addEventListener("touchcancel",function($Lr){$Lp.enabled?($Lr.preventDefault(),$LA.push($Lr)):$Lt._curTouchID=NaN},!0),$Li.addEventListener("mousewheel",function($Lr){$Lp.enabled&&$LA.push($Lr)}),$Li.addEventListener("DOMMouseScroll",function($Lr){$Lp.enabled&&$LA.push($Lr)})},$Lr.initEvent=function($Lr,$Li){var $Lt;this._event._stoped=!1,this._event.nativeEvent=$Li||$Lr,this._target=null,this._point.setTo($Lr.pageX||$Lr.clientX,$Lr.pageY||$Lr.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=$Lr.identifier||0,this._tTouchID=this._event.touchId,($Lt=$LB.I._event)._stoped=!1,$Lt.nativeEvent=this._event.nativeEvent,$Lt.touchId=this._event.touchId},$Lr.checkMouseWheel=function($Lr){this._event.delta=$Lr.wheelDelta?.025*$Lr.wheelDelta:-$Lr.detail;for(var $Li=$LB.I.getLastOvers(),$Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++){var $LA=$Li[$Lt];$LA.event("mousewheel",this._event.setTo("mousewheel",$LA,this._target))}},$Lr.onMouseMove=function($Lr){$LB.I.onMouseMove($Lr,this._tTouchID)},$Lr.onMouseDown=function($Lr){if($LDr.isInputting&&$Lw.stage.focus&&$Lw.stage.focus.focus&&!$Lw.stage.focus.contains(this._target)){var $Li=$Lw.stage.focus._tf||$Lw.stage.focus,$Lt=$Lr._tf||$Lr;$Lt instanceof laya.display.Input&&$Lt.multiline==$Li.multiline?$Li._focusOut():$Li.focus=!1}$LB.I.onMouseDown($Lr,this._tTouchID,this._isLeftMouse)},$Lr.onMouseUp=function($Lr){$LB.I.onMouseUp($Lr,this._tTouchID,this._isLeftMouse)},$Lr.check=function($Lr,$Li,$Lt,$L_){this._point.setTo($Li,$Lt),$Lr.fromParentPoint(this._point),$Li=this._point.x,$Lt=this._point.y;var $LA=$Lr.scrollRect;if($LA&&(this._rect.setTo($LA.x,$LA.y,$LA.width,$LA.height),!this._rect.contains($Li,$Lt)))return!1;if(!this.disableMouseEvent){if($Lr.hitTestPrior&&!$Lr.mouseThrough&&!this.hitTest($Lr,$Li,$Lt))return!1;for(var $Lf=$Lr._childs.length-1;-1<$Lf;$Lf--){var $LE=$Lr._childs[$Lf];if(!$LE.destroyed&&$LE.mouseEnabled&&$LE.visible&&this.check($LE,$Li,$Lt,$L_))return!0}}var $LG=!(!$Lr.hitTestPrior||$Lr.mouseThrough||this.disableMouseEvent)||this.hitTest($Lr,$Li,$Lt);return $LG?(this._target=$Lr,$L_.call(this,$Lr)):$L_===this.onMouseUp&&$Lr===this._stage&&(this._target=this._stage,$L_.call(this,this._target)),$LG},$Lr.hitTest=function($Lr,$Li,$Lt){var $L_=!1;if($Lr.scrollRect&&($Li-=$Lr.scrollRect.x,$Lt-=$Lr.scrollRect.y),$Lr.hitArea instanceof laya.utils.HitArea)return $Lr.hitArea.isHit($Li,$Lt);if(0<$Lr.width&&0<$Lr.height||$Lr.mouseThrough||$Lr.hitArea)if($Lr.mouseThrough)$L_=$Lr.getGraphicBounds().contains($Li,$Lt);else{var $LA=this._rect;$Lr.hitArea?$LA=$Lr.hitArea:$LA.setTo(0,0,$Lr.width,$Lr.height),$L_=$LA.contains($Li,$Lt)}return $L_},$Lr.runEvent=function(){var $Lr=this._eventList.length;if($Lr){this.mouseEventTime=$Lq.now();var $Li,$Lt=0,$L_=0,$LA=0;try{for(;$Lt<$Lr;){var $Lf=this._eventList[$Lt];switch("mousemove"!==$Lf.type&&(this._prePoint.x=this._prePoint.y=-1e6),$Lf.type){case"mousedown":this._touchIDs[0]=this._id++,$Lp._isTouchRespond?$Lp._isTouchRespond=!1:(this._isLeftMouse=0===$Lf.button,this.initEvent($Lf),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===$Lf.button,this.initEvent($Lf),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-$Lf.clientX)+Math.abs(this._prePoint.y-$Lf.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=$Lf.clientX,this._prePoint.y=$Lf.clientY,this.initEvent($Lf),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":$Lp._isTouchRespond=!0,this._isLeftMouse=!0;var $LE=$Lf.changedTouches;for($L_=0,$LA=$LE.length;$L_<$LA;$L_++)$Li=$LE[$L_],($Lp.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=$Li.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[$Li.identifier]=this._id++,this.initEvent($Li,$Lf),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":$Lp._isTouchRespond=!0,this._isLeftMouse=!0;var $LG=$Lf.changedTouches;for($L_=0,$LA=$LG.length;$L_<$LA;$L_++)if($Li=$LG[$L_],$Lp.multiTouchEnabled||$Li.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent($Li,$Lf);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var $LN=$Lf.changedTouches;for($L_=0,$LA=$LN.length;$L_<$LA;$L_++)$Li=$LN[$L_],($Lp.multiTouchEnabled||$Li.identifier==this._curTouchID)&&(this.initEvent($Li,$Lf),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel($Lf);break;case"mouseout":$LB.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}$Lt++}}catch($Lr){throw this._eventList.length=0,$Lr}this._eventList.length=0}},$Lp.enabled=!0,$Lp.multiTouchEnabled=!0,$Lp._isTouchRespond=!1,$Lp._isFirstTouch=!0,$LN($Lp,["instance",function(){return this.instance=new $Lp}]),$Lp}()),$LB=function(){function $LO(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new $Lf}$Lg($LO,"laya.events.TouchManager");var $Lr=$LO.prototype;return $Lr._clearTempArrs=function(){$LO._oldArr.length=0,$LO._newArr.length=0,$LO._tEleArr.length=0},$Lr.getTouchFromArr=function($Lr,$Li){var $Lt,$L_,$LA=0;for($Lt=$Li.length,$LA=0;$LA<$Lt;$LA++)if(($L_=$Li[$LA]).id==$Lr)return $L_;return null},$Lr.removeTouchFromArr=function($Lr,$Li){var $Lt=0;for($Lt=$Li.length-1;0<=$Lt;$Lt--)$Li[$Lt].id==$Lr&&$Li.splice($Lt,1)},$Lr.createTouchO=function($Lr,$Li){var $Lt;return($Lt=$LJ.getItem("TouchData")||{}).id=$Li,$Lt.tar=$Lr,$Lt},$Lr.onMouseDown=function($Lr,$Li,$Lt){var $L_,$LA,$Lf,$LE;(void 0===$Lt&&($Lt=!1),this.enable)&&($L_=this.getTouchFromArr($Li,this.preOvers),$Lf=this.getEles($Lr,null,$LO._tEleArr),$L_?$L_.tar=$Lr:($LA=this.createTouchO($Lr,$Li),this.preOvers.push($LA)),$Lq.onMobile&&this.sendEvents($Lf,"mouseover",$Li),$LE=$Lt?this.preDowns:this.preRightDowns,($L_=this.getTouchFromArr($Li,$LE))?$L_.tar=$Lr:($LA=this.createTouchO($Lr,$Li),$LE.push($LA)),this.sendEvents($Lf,$Lt?"mousedown":"rightmousedown",$Li),this._clearTempArrs())},$Lr.sendEvents=function($Lr,$Li,$Lt){void 0===$Lt&&($Lt=0);var $L_,$LA,$Lf,$LE=0;for($L_=$Lr.length,this._event._stoped=!1,$LA=$Lr[0],$LE=0;$LE<$L_;$LE++){if(($Lf=$Lr[$LE]).destroyed)return;if($Lf.event($Li,this._event.setTo($Li,$Lf,$LA)),this._event._stoped)break}},$Lr.getEles=function($Lr,$Li,$Lt){for($Lt?$Lt.length=0:$Lt=[];$Lr&&$Lr!=$Li;)$Lt.push($Lr),$Lr=$Lr.parent;return $Lt},$Lr.checkMouseOutAndOverOfMove=function($Lr,$Li,$Lt){if(void 0===$Lt&&($Lt=0),$Li!=$Lr){var $L_,$LA,$Lf=0,$LE=0;if($Li.contains($Lr))$LA=this.getEles($Lr,$Li,$LO._tEleArr),this.sendEvents($LA,"mouseover",$Lt);else if($Lr.contains($Li))$LA=this.getEles($Li,$Lr,$LO._tEleArr),this.sendEvents($LA,"mouseout",$Lt);else{var $LG,$LN;($LA=$LO._tEleArr).length=0,$LG=this.getEles($Li,null,$LO._oldArr),$LN=this.getEles($Lr,null,$LO._newArr),$LE=$LG.length;var $Lp=0;for($Lf=0;$Lf<$LE;$Lf++){if($L_=$LG[$Lf],0<=($Lp=$LN.indexOf($L_))){$LN.splice($Lp,$LN.length-$Lp);break}$LA.push($L_)}0<$LA.length&&this.sendEvents($LA,"mouseout",$Lt),0<$LN.length&&this.sendEvents($LN,"mouseover",$Lt)}}},$Lr.onMouseMove=function($Lr,$Li){var $Lt,$L_;this.enable&&(($Lt=this.getTouchFromArr($Li,this.preOvers))?(this.checkMouseOutAndOverOfMove($Lr,$Lt.tar),$Lt.tar=$Lr,$L_=this.getEles($Lr,null,$LO._tEleArr)):($L_=this.getEles($Lr,null,$LO._tEleArr),this.sendEvents($L_,"mouseover",$Li),this.preOvers.push(this.createTouchO($Lr,$Li))),this.sendEvents($L_,"mousemove",$Li),this._clearTempArrs())},$Lr.getLastOvers=function(){return($LO._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,$LO._tEleArr):($LO._tEleArr.push($Lw.stage),$LO._tEleArr)},$Lr.stageMouseOut=function(){var $Lr;$Lr=this.getLastOvers(),this.preOvers.length=0,this.sendEvents($Lr,"mouseout",0)},$Lr.onMouseUp=function($Lr,$Li,$Lt){if(void 0===$Lt&&($Lt=!1),this.enable){var $L_,$LA,$Lf,$LE,$LG,$LN,$Lp=0,$Lg=0,$LR=$Lq.onMobile;if($LA=this.getEles($Lr,null,$LO._tEleArr),this.sendEvents($LA,$Lt?"mouseup":"rightmouseup",$Li),$LN=$Lt?this.preDowns:this.preRightDowns,$L_=this.getTouchFromArr($Li,$LN)){var $LX,$Lv=$Lq.now();if($LX=$Lv-this._lastClickTime<300,this._lastClickTime=$Lv,$Lr==$L_.tar)$LG=$LA;else for($Lf=this.getEles($L_.tar,null,$LO._oldArr),($LG=$LO._newArr).length=0,$Lg=$Lf.length,$Lp=0;$Lp<$Lg;$Lp++)$LE=$Lf[$Lp],0<=$LA.indexOf($LE)&&$LG.push($LE);0<$LG.length&&this.sendEvents($LG,$Lt?"click":"rightclick",$Li),$Lt&&$LX&&this.sendEvents($LG,"doubleclick",$Li),this.removeTouchFromArr($Li,$LN),$L_.tar=null,$LJ.recover("TouchData",$L_)}else;($L_=this.getTouchFromArr($Li,this.preOvers))&&$LR&&(($LG=this.getEles($L_.tar,null,$LG))&&0<$LG.length&&this.sendEvents($LG,"mouseout",$Li),this.removeTouchFromArr($Li,this.preOvers),$L_.tar=null,$LJ.recover("TouchData",$L_)),this._clearTempArrs()}},$LO._oldArr=[],$LO._newArr=[],$LO._tEleArr=[],$LN($LO,["I",function(){return this.I=new $LO}]),$LO}(),$Ly=function(){function $Lr(){this._action=null}$Lg($Lr,"laya.filters.Filter");var $Li=$Lr.prototype;return $Lw.imps($Li,{"laya.filters.IFilter":!0}),$Li.callNative=function($Lr){},$LO(0,$Li,"type",function(){return-1}),$LO(0,$Li,"action",function(){return this._action}),$Lr.BLUR=16,$Lr.COLOR=32,$Lr.GLOW=8,$Lr._filterStart=null,$Lr._filterEnd=null,$Lr._EndTarget=null,$Lr._recycleScope=null,$Lr._filter=null,$Lr._useSrc=null,$Lr._endSrc=null,$Lr._useOut=null,$Lr._endOut=null,$Lr}(),$Ln=function(){function $Lr(){this.data=null}$Lg($Lr,"laya.filters.ColorFilterAction");var $Li=$Lr.prototype;return $Lw.imps($Li,{"laya.filters.IFilterAction":!0}),$Li.apply=function($Lr){var $Li=$Lr.ctx.ctx,$Lt=$Lr.ctx.ctx.canvas;if(0==$Lt.width||0==$Lt.height)return $Lt;for(var $L_,$LA=$Li.getImageData(0,0,$Lt.width,$Lt.height),$Lf=$LA.data,$LE=0,$LG=$Lf.length;$LE<$LG;$LE+=4)$L_=this.getColor($Lf[$LE],$Lf[$LE+1],$Lf[$LE+2],$Lf[$LE+3]),0!=$Lf[$LE+3]&&($Lf[$LE]=$L_[0],$Lf[$LE+1]=$L_[1],$Lf[$LE+2]=$L_[2],$Lf[$LE+3]=$L_[3]);return $Li.putImageData($LA,0,0),$Lr},$Li.getColor=function($Lr,$Li,$Lt,$L_){var $LA=[];if(this.data._mat&&this.data._alpha){var $Lf=this.data._mat,$LE=this.data._alpha;$LA[0]=$Lf[0]*$Lr+$Lf[1]*$Li+$Lf[2]*$Lt+$Lf[3]*$L_+$LE[0],$LA[1]=$Lf[4]*$Lr+$Lf[5]*$Li+$Lf[6]*$Lt+$Lf[7]*$L_+$LE[1],$LA[2]=$Lf[8]*$Lr+$Lf[9]*$Li+$Lf[10]*$Lt+$Lf[11]*$L_+$LE[2],$LA[3]=$Lf[12]*$Lr+$Lf[13]*$Li+$Lf[14]*$Lt+$Lf[15]*$L_+$LE[3]}return $LA},$Lr}(),$La=(function(){function $Lr(){}$Lg($Lr,"laya.maths.Arith"),$Lr.formatR=function($Lr){return $Lr>Math.PI&&($Lr-=2*Math.PI),$Lr<-Math.PI&&($Lr+=2*Math.PI),$Lr},$Lr.isPOT=function($Lr,$Li){return 0<$Lr&&0==($Lr&$Lr-1)&&0<$Li&&0==($Li&$Li-1)},$Lr.setMatToArray=function($Lr,$Li){$Lr.a,$Lr.b,$Lr.c,$Lr.d,$Lr.tx,$Lr.ty,$Li[0]=$Lr.a,$Li[1]=$Lr.b,$Li[4]=$Lr.c,$Li[5]=$Lr.d,$Li[12]=$Lr.tx,$Li[13]=$Lr.ty}}(),function(){function $Lr(){this._controlPoints=[new $LH,new $LH,new $LH],this._calFun=this.getPoint2}$Lg($Lr,"laya.maths.Bezier");var $Li=$Lr.prototype;return $Li._switchPoint=function($Lr,$Li){var $Lt=this._controlPoints.shift();$Lt.setTo($Lr,$Li),this._controlPoints.push($Lt)},$Li.getPoint2=function($Lr,$Li){var $Lt=this._controlPoints[0],$L_=this._controlPoints[1],$LA=this._controlPoints[2],$Lf=Math.pow(1-$Lr,2)*$Lt.x+2*$Lr*(1-$Lr)*$L_.x+Math.pow($Lr,2)*$LA.x,$LE=Math.pow(1-$Lr,2)*$Lt.y+2*$Lr*(1-$Lr)*$L_.y+Math.pow($Lr,2)*$LA.y;$Li.push($Lf,$LE)},$Li.getPoint3=function($Lr,$Li){var $Lt=this._controlPoints[0],$L_=this._controlPoints[1],$LA=this._controlPoints[2],$Lf=this._controlPoints[3],$LE=Math.pow(1-$Lr,3)*$Lt.x+3*$L_.x*$Lr*(1-$Lr)*(1-$Lr)+3*$LA.x*$Lr*$Lr*(1-$Lr)+$Lf.x*Math.pow($Lr,3),$LG=Math.pow(1-$Lr,3)*$Lt.y+3*$L_.y*$Lr*(1-$Lr)*(1-$Lr)+3*$LA.y*$Lr*$Lr*(1-$Lr)+$Lf.y*Math.pow($Lr,3);$Li.push($LE,$LG)},$Li.insertPoints=function($Lr,$Li){var $Lt,$L_=NaN;for($Lt=1/($Lr=0<$Lr?$Lr:5),$L_=0;$L_<=1;$L_+=$Lt)this._calFun($L_,$Li)},$Li.getBezierPoints=function($Lr,$Li,$Lt){void 0===$Li&&($Li=5),void 0===$Lt&&($Lt=2);var $L_,$LA,$Lf=0;if(($L_=$Lr.length)<2*($Lt+1))return[];switch($LA=[],$Lt){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=$Lt;)this._controlPoints.push(new $LH);for($Lf=0;$Lf<2*$Lt;$Lf+=2)this._switchPoint($Lr[$Lf],$Lr[$Lf+1]);for($Lf=2*$Lt;$Lf<$L_;$Lf+=2)this._switchPoint($Lr[$Lf],$Lr[$Lf+1]),$Lf/2%$Lt==0&&this.insertPoints($Li,$LA);return $LA},$LN($Lr,["I",function(){return this.I=new $Lr}]),$Lr}()),$LD=function(){function $Lp(){}return $Lg($Lp,"laya.maths.GrahamScan"),$Lp.multiply=function($Lr,$Li,$Lt){return($Lr.x-$Lt.x)*($Li.y-$Lt.y)-($Li.x-$Lt.x)*($Lr.y-$Lt.y)},$Lp.dis=function($Lr,$Li){return($Lr.x-$Li.x)*($Lr.x-$Li.x)+($Lr.y-$Li.y)*($Lr.y-$Li.y)},$Lp._getPoints=function($Lr,$Li,$Lt){for(void 0===$Li&&($Li=!1),$Lp._mPointList||($Lp._mPointList=[]);$Lp._mPointList.length<$Lr;)$Lp._mPointList.push(new $LH);return $Lt||($Lt=[]),$Lt.length=0,$Li?$Lp.getFrom($Lt,$Lp._mPointList,$Lr):$Lp.getFromR($Lt,$Lp._mPointList,$Lr),$Lt},$Lp.getFrom=function($Lr,$Li,$Lt){var $L_=0;for($L_=0;$L_<$Lt;$L_++)$Lr.push($Li[$L_]);return $Lr},$Lp.getFromR=function($Lr,$Li,$Lt){var $L_=0;for($L_=0;$L_<$Lt;$L_++)$Lr.push($Li.pop());return $Lr},$Lp.pListToPointList=function($Lr,$Li){void 0===$Li&&($Li=!1);var $Lt=0,$L_=$Lr.length/2,$LA=$Lp._getPoints($L_,$Li,$Lp._tempPointList);for($Lt=0;$Lt<$L_;$Lt++)$LA[$Lt].setTo($Lr[$Lt+$Lt],$Lr[$Lt+$Lt+1]);return $LA},$Lp.pointListToPlist=function($Lr){var $Li,$Lt=0,$L_=$Lr.length,$LA=$Lp._temPList;for($Lt=$LA.length=0;$Lt<$L_;$Lt++)$Li=$Lr[$Lt],$LA.push($Li.x,$Li.y);return $LA},$Lp.scanPList=function($Lr){return $LK.copyArray($Lr,$Lp.pointListToPlist($Lp.scan($Lp.pListToPointList($Lr,!0))))},$Lp.scan=function($Lr){var $Li,$Lt,$L_,$LA=0,$Lf=0,$LE=0,$LG=$Lr.length,$LN={};for(($Lt=$Lp._temArr).length=0,$LA=($LG=$Lr.length)-1;0<=$LA;$LA--)$L_=($Li=$Lr[$LA]).x+"_"+$Li.y,$LN.hasOwnProperty($L_)||($LN[$L_]=!0,$Lt.push($Li));for($LG=$Lt.length,$LK.copyArray($Lr,$Lt),$LA=1;$LA<$LG;$LA++)($Lr[$LA].y<$Lr[$LE].y||$Lr[$LA].y==$Lr[$LE].y&&$Lr[$LA].x<$Lr[$LE].x)&&($LE=$LA);for($Li=$Lr[0],$Lr[0]=$Lr[$LE],$Lr[$LE]=$Li,$LA=1;$LA<$LG-1;$LA++){for($Lf=($LE=$LA)+1;$Lf<$LG;$Lf++)(0<$Lp.multiply($Lr[$Lf],$Lr[$LE],$Lr[0])||0==$Lp.multiply($Lr[$Lf],$Lr[$LE],$Lr[0])&&$Lp.dis($Lr[0],$Lr[$Lf])<$Lp.dis($Lr[0],$Lr[$LE]))&&($LE=$Lf);$Li=$Lr[$LA],$Lr[$LA]=$Lr[$LE],$Lr[$LE]=$Li}if(($Lt=$Lp._temArr).length=0,$Lr.length<3)return $LK.copyArray($Lt,$Lr);for($Lt.push($Lr[0],$Lr[1],$Lr[2]),$LA=3;$LA<$LG;$LA++){for(;2<=$Lt.length&&0<=$Lp.multiply($Lr[$LA],$Lt[$Lt.length-1],$Lt[$Lt.length-2]);)$Lt.pop();$Lr[$LA]&&$Lt.push($Lr[$LA])}return $Lt},$Lp._mPointList=null,$Lp._tempPointList=[],$Lp._temPList=[],$Lp._temArr=[],$Lp}(),$Lu=function(){function $LA(){}return $Lg($LA,"laya.maths.MathUtil"),$LA.subtractVector3=function($Lr,$Li,$Lt){$Lt[0]=$Lr[0]-$Li[0],$Lt[1]=$Lr[1]-$Li[1],$Lt[2]=$Lr[2]-$Li[2]},$LA.lerp=function($Lr,$Li,$Lt){return $Lr*(1-$Lt)+$Li*$Lt},$LA.scaleVector3=function($Lr,$Li,$Lt){$Lt[0]=$Lr[0]*$Li,$Lt[1]=$Lr[1]*$Li,$Lt[2]=$Lr[2]*$Li},$LA.lerpVector3=function($Lr,$Li,$Lt,$L_){var $LA=$Lr[0],$Lf=$Lr[1],$LE=$Lr[2];$L_[0]=$LA+$Lt*($Li[0]-$LA),$L_[1]=$Lf+$Lt*($Li[1]-$Lf),$L_[2]=$LE+$Lt*($Li[2]-$LE)},$LA.lerpVector4=function($Lr,$Li,$Lt,$L_){var $LA=$Lr[0],$Lf=$Lr[1],$LE=$Lr[2],$LG=$Lr[3];$L_[0]=$LA+$Lt*($Li[0]-$LA),$L_[1]=$Lf+$Lt*($Li[1]-$Lf),$L_[2]=$LE+$Lt*($Li[2]-$LE),$L_[3]=$LG+$Lt*($Li[3]-$LG)},$LA.slerpQuaternionArray=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){var $LG,$LN,$Lp,$Lg,$LR,$LX=$Lr[$Li+0],$Lv=$Lr[$Li+1],$LO=$Lr[$Li+2],$Lc=$Lr[$Li+3],$LB=$Lt[$L_+0],$Ly=$Lt[$L_+1],$LC=$Lt[$L_+2],$Ln=$Lt[$L_+3];return($LN=$LX*$LB+$Lv*$Ly+$LO*$LC+$Lc*$Ln)<0&&($LN=-$LN,$LB=-$LB,$Ly=-$Ly,$LC=-$LC,$Ln=-$Ln),$LR=1e-6<1-$LN?($LG=Math.acos($LN),$Lp=Math.sin($LG),$Lg=Math.sin((1-$LA)*$LG)/$Lp,Math.sin($LA*$LG)/$Lp):($Lg=1-$LA,$LA),$Lf[$LE+0]=$Lg*$LX+$LR*$LB,$Lf[$LE+1]=$Lg*$Lv+$LR*$Ly,$Lf[$LE+2]=$Lg*$LO+$LR*$LC,$Lf[$LE+3]=$Lg*$Lc+$LR*$Ln,$Lf},$LA.getRotation=function($Lr,$Li,$Lt,$L_){return Math.atan2($L_-$Li,$Lt-$Lr)/Math.PI*180},$LA.sortBigFirst=function($Lr,$Li){return $Lr==$Li?0:$Lr<$Li?1:-1},$LA.sortSmallFirst=function($Lr,$Li){return $Lr==$Li?0:$Lr<$Li?-1:1},$LA.sortNumBigFirst=function($Lr,$Li){return parseFloat($Li)-parseFloat($Lr)},$LA.sortNumSmallFirst=function($Lr,$Li){return parseFloat($Lr)-parseFloat($Li)},$LA.sortByKey=function($Lt,$Lr,$Li){var $L_;return void 0===$Lr&&($Lr=!1),void 0===$Li&&($Li=!0),$L_=$Lr?$Li?$LA.sortNumBigFirst:$LA.sortBigFirst:$Li?$LA.sortNumSmallFirst:$LA.sortSmallFirst,function($Lr,$Li){return $L_($Lr[$Lt],$Li[$Lt])}},$LA}(),$Le=function(){function $Lt($Lr,$Li,$Lt,$L_,$LA,$Lf){this.inPool=!1,this.bTransform=!1,void 0===$Lr&&($Lr=1),void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=1),void 0===$LA&&($LA=0),void 0===$Lf&&($Lf=0),this.a=$Lr,this.b=$Li,this.c=$Lt,this.d=$L_,this.tx=$LA,this.ty=$Lf,this._checkTransform()}$Lg($Lt,"laya.maths.Matrix");var $Lr=$Lt.prototype;return $Lr.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},$Lr._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},$Lr.setTranslate=function($Lr,$Li){return this.tx=$Lr,this.ty=$Li,this},$Lr.translate=function($Lr,$Li){return this.tx+=$Lr,this.ty+=$Li,this},$Lr.scale=function($Lr,$Li){this.a*=$Lr,this.d*=$Li,this.c*=$Lr,this.b*=$Li,this.tx*=$Lr,this.ty*=$Li,this.bTransform=!0},$Lr.rotate=function($Lr){var $Li=Math.cos($Lr),$Lt=Math.sin($Lr),$L_=this.a,$LA=this.c,$Lf=this.tx;this.a=$L_*$Li-this.b*$Lt,this.b=$L_*$Lt+this.b*$Li,this.c=$LA*$Li-this.d*$Lt,this.d=$LA*$Lt+this.d*$Li,this.tx=$Lf*$Li-this.ty*$Lt,this.ty=$Lf*$Lt+this.ty*$Li,this.bTransform=!0},$Lr.skew=function($Lr,$Li){var $Lt=Math.tan($Lr),$L_=Math.tan($Li),$LA=this.a,$Lf=this.b;return this.a+=$L_*this.c,this.b+=$L_*this.d,this.c+=$Lt*$LA,this.d+=$Lt*$Lf,this},$Lr.invertTransformPoint=function($Lr){var $Li=this.a,$Lt=this.b,$L_=this.c,$LA=this.d,$Lf=this.tx,$LE=$Li*$LA-$Lt*$L_,$LG=$LA/$LE,$LN=-$Lt/$LE,$Lp=-$L_/$LE,$Lg=$Li/$LE,$LR=($L_*this.ty-$LA*$Lf)/$LE,$LX=-($Li*this.ty-$Lt*$Lf)/$LE;return $Lr.setTo($LG*$Lr.x+$Lp*$Lr.y+$LR,$LN*$Lr.x+$Lg*$Lr.y+$LX)},$Lr.transformPoint=function($Lr){return $Lr.setTo(this.a*$Lr.x+this.c*$Lr.y+this.tx,this.b*$Lr.x+this.d*$Lr.y+this.ty)},$Lr.transformPointN=function($Lr){return $Lr.setTo(this.a*$Lr.x+this.c*$Lr.y,this.b*$Lr.x+this.d*$Lr.y)},$Lr.transformPointArray=function($Lr,$Li){for(var $Lt=$Lr.length,$L_=0;$L_<$Lt;$L_+=2){var $LA=$Lr[$L_],$Lf=$Lr[$L_+1];$Li[$L_]=this.a*$LA+this.c*$Lf+this.tx,$Li[$L_+1]=this.b*$LA+this.d*$Lf+this.ty}return $Li},$Lr.transformPointArrayScale=function($Lr,$Li){for(var $Lt=$Lr.length,$L_=0;$L_<$Lt;$L_+=2){var $LA=$Lr[$L_],$Lf=$Lr[$L_+1];$Li[$L_]=this.a*$LA+this.c*$Lf,$Li[$L_+1]=this.b*$LA+this.d*$Lf}return $Li},$Lr.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},$Lr.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},$Lr.invert=function(){var $Lr=this.a,$Li=this.b,$Lt=this.c,$L_=this.d,$LA=this.tx,$Lf=$Lr*$L_-$Li*$Lt;return this.a=$L_/$Lf,this.b=-$Li/$Lf,this.c=-$Lt/$Lf,this.d=$Lr/$Lf,this.tx=($Lt*this.ty-$L_*$LA)/$Lf,this.ty=-($Lr*this.ty-$Li*$LA)/$Lf,this},$Lr.setTo=function($Lr,$Li,$Lt,$L_,$LA,$Lf){return this.a=$Lr,this.b=$Li,this.c=$Lt,this.d=$L_,this.tx=$LA,this.ty=$Lf,this},$Lr.concat=function($Lr){var $Li=this.a,$Lt=this.c,$L_=this.tx;return this.a=$Li*$Lr.a+this.b*$Lr.c,this.b=$Li*$Lr.b+this.b*$Lr.d,this.c=$Lt*$Lr.a+this.d*$Lr.c,this.d=$Lt*$Lr.b+this.d*$Lr.d,this.tx=$L_*$Lr.a+this.ty*$Lr.c+$Lr.tx,this.ty=$L_*$Lr.b+this.ty*$Lr.d+$Lr.ty,this},$Lr.scaleEx=function($Lr,$Li){var $Lt=this.a,$L_=this.b,$LA=this.c,$Lf=this.d;0!==$L_||0!==$LA?(this.a=$Lr*$Lt,this.b=$Lr*$L_,this.c=$Li*$LA):(this.a=$Lr*$Lt,this.b=0*$Lf,this.c=0*$Lt),this.d=$Li*$Lf,this.bTransform=!0},$Lr.rotateEx=function($Lr){var $Li=Math.cos($Lr),$Lt=Math.sin($Lr),$L_=this.a,$LA=this.b,$Lf=this.c,$LE=this.d;0!==$LA||0!==$Lf?(this.a=$Li*$L_+$Lt*$Lf,this.b=$Li*$LA+$Lt*$LE,this.c=-$Lt*$L_+$Li*$Lf,this.d=-$Lt*$LA+$Li*$LE):(this.a=$Li*$L_,this.b=$Lt*$LE,this.c=-$Lt*$L_,this.d=$Li*$LE),this.bTransform=!0},$Lr.clone=function(){var $Lr=$Lt.create();return $Lr.a=this.a,$Lr.b=this.b,$Lr.c=this.c,$Lr.d=this.d,$Lr.tx=this.tx,$Lr.ty=this.ty,$Lr.bTransform=this.bTransform,$Lr},$Lr.copyTo=function($Lr){return $Lr.a=this.a,$Lr.b=this.b,$Lr.c=this.c,$Lr.d=this.d,$Lr.tx=this.tx,$Lr.ty=this.ty,$Lr.bTransform=this.bTransform,$Lr},$Lr.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},$Lr.destroy=function(){if(!this.inPool){var $Lr=$Lt._cache;this.inPool=!0,$Lr._length||($Lr._length=0),($Lr[$Lr._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},$Lt.mul=function($Lr,$Li,$Lt){var $L_=$Lr.a,$LA=$Lr.b,$Lf=$Lr.c,$LE=$Lr.d,$LG=$Lr.tx,$LN=$Lr.ty,$Lp=$Li.a,$Lg=$Li.b,$LR=$Li.c,$LX=$Li.d,$Lv=$Li.tx,$LO=$Li.ty;return 0!==$Lg||0!==$LR?($Lt.a=$L_*$Lp+$LA*$LR,$Lt.b=$L_*$Lg+$LA*$LX,$Lt.c=$Lf*$Lp+$LE*$LR,$Lt.d=$Lf*$Lg+$LE*$LX,$Lt.tx=$Lp*$LG+$LR*$LN+$Lv,$Lt.ty=$Lg*$LG+$LX*$LN+$LO):($Lt.a=$L_*$Lp,$Lt.b=$LA*$LX,$Lt.c=$Lf*$Lp,$Lt.d=$LE*$LX,$Lt.tx=$Lp*$LG+$Lv,$Lt.ty=$LX*$LN+$LO),$Lt},$Lt.mul16=function($Lr,$Li,$Lt){var $L_=$Lr.a,$LA=$Lr.b,$Lf=$Lr.c,$LE=$Lr.d,$LG=$Lr.tx,$LN=$Lr.ty,$Lp=$Li.a,$Lg=$Li.b,$LR=$Li.c,$LX=$Li.d,$Lv=$Li.tx,$LO=$Li.ty;return 0!==$Lg||0!==$LR?($Lt[0]=$L_*$Lp+$LA*$LR,$Lt[1]=$L_*$Lg+$LA*$LX,$Lt[4]=$Lf*$Lp+$LE*$LR,$Lt[5]=$Lf*$Lg+$LE*$LX,$Lt[12]=$Lp*$LG+$LR*$LN+$Lv,$Lt[13]=$Lg*$LG+$LX*$LN+$LO):($Lt[0]=$L_*$Lp,$Lt[1]=$LA*$LX,$Lt[4]=$Lf*$Lp,$Lt[5]=$LE*$LX,$Lt[12]=$Lp*$LG+$Lv,$Lt[13]=$LX*$LN+$LO),$Lt},$Lt.mulPre=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){var $LN=$Lr.a,$Lp=$Lr.b,$Lg=$Lr.c,$LR=$Lr.d,$LX=$Lr.tx,$Lv=$Lr.ty;return 0!==$Lt||0!==$L_?($LG.a=$LN*$Li+$Lp*$L_,$LG.b=$LN*$Lt+$Lp*$LA,$LG.c=$Lg*$Li+$LR*$L_,$LG.d=$Lg*$Lt+$LR*$LA,$LG.tx=$Li*$LX+$L_*$Lv+$Lf,$LG.ty=$Lt*$LX+$LA*$Lv+$LE):($LG.a=$LN*$Li,$LG.b=$Lp*$LA,$LG.c=$Lg*$Li,$LG.d=$LR*$LA,$LG.tx=$Li*$LX+$Lf,$LG.ty=$LA*$Lv+$LE),$LG},$Lt.mulPos=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){var $LN=$Lr.a,$Lp=$Lr.b,$Lg=$Lr.c,$LR=$Lr.d,$LX=$Lr.tx,$Lv=$Lr.ty;return 0!==$Lp||0!==$Lg?($LG.a=$Li*$LN+$Lt*$Lg,$LG.b=$Li*$Lp+$Lt*$LR,$LG.c=$L_*$LN+$LA*$Lg,$LG.d=$L_*$Lp+$LA*$LR,$LG.tx=$LN*$Lf+$Lg*$LE+$LX,$LG.ty=$Lp*$Lf+$LR*$LE+$Lv):($LG.a=$Li*$LN,$LG.b=$Lt*$LR,$LG.c=$L_*$LN,$LG.d=$LA*$LR,$LG.tx=$LN*$Lf+$LX,$LG.ty=$LR*$LE+$Lv),$LG},$Lt.preMul=function($Lr,$Li,$Lt){var $L_=$Lr.a,$LA=$Lr.b,$Lf=$Lr.c,$LE=$Lr.d,$LG=$Li.a,$LN=$Li.b,$Lp=$Li.c,$Lg=$Li.d,$LR=$Li.tx,$LX=$Li.ty;return $Lt.a=$LG*$L_,$Lt.b=$Lt.c=0,$Lt.d=$Lg*$LE,$Lt.tx=$LR*$L_+$Lr.tx,$Lt.ty=$LX*$LE+$Lr.ty,0===$LN&&0===$Lp&&0===$LA&&0===$Lf||($Lt.a+=$LN*$Lf,$Lt.d+=$Lp*$LA,$Lt.b+=$LG*$LA+$LN*$LE,$Lt.c+=$Lp*$L_+$Lg*$Lf,$Lt.tx+=$LX*$Lf,$Lt.ty+=$LR*$LA),$Lt},$Lt.preMulXY=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.a,$Lf=$Lr.b,$LE=$Lr.c,$LG=$Lr.d;return $L_.a=$LA,$L_.b=$Lf,$L_.c=$LE,$L_.d=$LG,$L_.tx=$Li*$LA+$Lr.tx+$Lt*$LE,$L_.ty=$Lt*$LG+$Lr.ty+$Li*$Lf,$L_},$Lt.create=function(){var $Lr=$Lt._cache,$Li=$Lr._length?$Lr[--$Lr._length]:new $Lt;return $Li.inPool=!1,$Li},$Lt.EMPTY=new $Lt,$Lt.TEMP=new $Lt,$Lt._cache=[],$Lt}(),$LH=function(){function $Lr($Lr,$Li){void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),this.x=$Lr,this.y=$Li}$Lg($Lr,"laya.maths.Point");var $Li=$Lr.prototype;return $Li.setTo=function($Lr,$Li){return this.x=$Lr,this.y=$Li,this},$Li.distance=function($Lr,$Li){return Math.sqrt((this.x-$Lr)*(this.x-$Lr)+(this.y-$Li)*(this.y-$Li))},$Li.toString=function(){return this.x+","+this.y},$Li.normalize=function(){var $Lr=Math.sqrt(this.x*this.x+this.y*this.y);if(0<$Lr){var $Li=1/$Lr;this.x*=$Li,this.y*=$Li}},$Lr.TEMP=new $Lr,$Lr.EMPTY=new $Lr,$Lr}(),$Ls=function(){function $Lp($Lr,$Li,$Lt,$L_){void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=0),this.x=$Lr,this.y=$Li,this.width=$Lt,this.height=$L_}$Lg($Lp,"laya.maths.Rectangle");var $Lr=$Lp.prototype;return $Lr.setTo=function($Lr,$Li,$Lt,$L_){return this.x=$Lr,this.y=$Li,this.width=$Lt,this.height=$L_,this},$Lr.copyFrom=function($Lr){return this.x=$Lr.x,this.y=$Lr.y,this.width=$Lr.width,this.height=$Lr.height,this},$Lr.contains=function($Lr,$Li){return!(this.width<=0||this.height<=0)&&($Lr>=this.x&&$Lr<this.right&&$Li>=this.y&&$Li<this.bottom)},$Lr.intersects=function($Lr){return!($Lr.x>this.x+this.width||$Lr.x+$Lr.width<this.x||$Lr.y>this.y+this.height||$Lr.y+$Lr.height<this.y)},$Lr.intersection=function($Lr,$Li){return this.intersects($Lr)?($Li||($Li=new $Lp),$Li.x=Math.max(this.x,$Lr.x),$Li.y=Math.max(this.y,$Lr.y),$Li.width=Math.min(this.right,$Lr.right)-$Li.x,$Li.height=Math.min(this.bottom,$Lr.bottom)-$Li.y,$Li):null},$Lr.union=function($Lr,$Li){return $Li||($Li=new $Lp),this.clone($Li),$Lr.width<=0||$Lr.height<=0?$Li:($Li.addPoint($Lr.x,$Lr.y),$Li.addPoint($Lr.right,$Lr.bottom),this)},$Lr.clone=function($Lr){return $Lr||($Lr=new $Lp),$Lr.x=this.x,$Lr.y=this.y,$Lr.width=this.width,$Lr.height=this.height,$Lr},$Lr.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},$Lr.equals=function($Lr){return!(!$Lr||$Lr.x!==this.x||$Lr.y!==this.y||$Lr.width!==this.width||$Lr.height!==this.height)},$Lr.addPoint=function($Lr,$Li){return this.x>$Lr&&(this.width+=this.x-$Lr,this.x=$Lr),this.y>$Li&&(this.height+=this.y-$Li,this.y=$Li),this.width<$Lr-this.x&&(this.width=$Lr-this.x),this.height<$Li-this.y&&(this.height=$Li-this.y),this},$Lr._getBoundPoints=function(){var $Lr=$Lp._temB;return($Lr.length=0)==this.width||0==this.height||$Lr.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),$Lr},$Lr.isEmpty=function(){return this.width<=0||this.height<=0},$LO(0,$Lr,"right",function(){return this.x+this.width}),$LO(0,$Lr,"bottom",function(){return this.y+this.height}),$Lp._getBoundPointS=function($Lr,$Li,$Lt,$L_){var $LA=$Lp._temA;return($LA.length=0)==$Lt||0==$L_||$LA.push($Lr,$Li,$Lr+$Lt,$Li,$Lr,$Li+$L_,$Lr+$Lt,$Li+$L_),$LA},$Lp._getWrapRec=function($Lr,$Li){if(!$Lr||$Lr.length<1)return $Li?$Li.setTo(0,0,0,0):$Lp.TEMP.setTo(0,0,0,0);$Li=$Li||new $Lp;var $Lt,$L_,$LA,$Lf,$LE,$LG=$Lr.length,$LN=$LH.TEMP;for($LA=$LE=-($L_=$Lf=99999),$Lt=0;$Lt<$LG;$Lt+=2)$LN.x=$Lr[$Lt],$LN.y=$Lr[$Lt+1],$L_=$L_<$LN.x?$L_:$LN.x,$Lf=$Lf<$LN.y?$Lf:$LN.y,$LA=$LA>$LN.x?$LA:$LN.x,$LE=$LE>$LN.y?$LE:$LN.y;return $Li.setTo($L_,$Lf,$LA-$L_,$LE-$Lf)},$Lp.EMPTY=new $Lp,$Lp.TEMP=new $Lp,$Lp._temB=[],$Lp._temA=[],$Lp}(),$LU=function(){function $LN(){}return $Lg($LN,"laya.media.SoundManager"),$LO(1,$LN,"useAudioMusic",function(){return $LN._useAudioMusic},function($Lr){$LN._useAudioMusic=$Lr,$LN._musicClass=$Lr?$Ltr:null}),$LO(1,$LN,"autoStopMusic",function(){return $LN._autoStopMusic},function($Lr){$Lw.stage.off("blur",null,$LN._stageOnBlur),$Lw.stage.off("focus",null,$LN._stageOnFocus),$Lw.stage.off("visibilitychange",null,$LN._visibilityChange),($LN._autoStopMusic=$Lr)&&($Lw.stage.on("blur",null,$LN._stageOnBlur),$Lw.stage.on("focus",null,$LN._stageOnFocus),$Lw.stage.on("visibilitychange",null,$LN._visibilityChange))}),$LO(1,$LN,"muted",function(){return $LN._muted},function($Lr){$Lr!=$LN._muted&&($Lr&&$LN.stopAllSound(),$LN.musicMuted=$Lr,$LN._muted=$Lr)}),$LO(1,$LN,"musicMuted",function(){return $LN._musicMuted},function($Lr){$Lr!=$LN._musicMuted&&($Lr?($LN._tMusic&&$LN._musicChannel&&!$LN._musicChannel.isStopped?$LN._musicChannel.pause():$LN._musicChannel=null,$LN._musicMuted=$Lr):($LN._musicMuted=$Lr,$LN._tMusic&&$LN._musicChannel&&$LN._musicChannel.resume()))}),$LO(1,$LN,"soundMuted",function(){return $LN._soundMuted},function($Lr){$LN._soundMuted=$Lr}),$LN.addChannel=function($Lr){0<=$LN._channels.indexOf($Lr)||($LN._channels.push($Lr),$LN.autoReleaseSound&&0!=$LN._notUsedCount&&$LN._notUsedUrls[$Lr.url]&&(delete $LN._notUsedUrls[$Lr.url],0==--$LN._notUsedCount&&$Lw.timer.clear($LN,$LN.disposeSoundIfNotUsed)))},$LN.removeChannel=function($Lr){var $Li=$LN._channels,$Lt=$Li.indexOf($Lr);if(-1!=$Lt&&($Li.splice($Lt,1),$LN.autoReleaseSound)){var $L_=$Lr.url,$LA=$LN.defaultIntervals[$L_]||2e4;if(0<$LA){var $Lf=!0;for($Lt=$Li.length-1;0<=$Lt;$Lt--)if($Li[$Lt].url==$L_){$Lf=!1;break}$Lf&&($LN._notUsedUrls[$L_]=Date.now()+$LA,0==$LN._notUsedCount++&&$Lw.timer.loop(1e4,$LN,$LN.disposeSoundIfNotUsed))}}},$LN.disposeSoundIfNotUsed=function(){var $Lr=$LN._notUsedUrls;if(0!=$LN._notUsedCount){var $Li=Date.now();for(var $Lt in $Lr)$Li>=$Lr[$Lt]&&(delete $Lr[$Lt],--$LN._notUsedCount,$LN.destroySound($Lt));if(0!=$LN._notUsedCount)return}$Lw.timer.clear($LN,$LN.disposeSoundIfNotUsed)},$LN._visibilityChange=function(){$Lw.stage.isVisibility?$LN._stageOnFocus():$LN._stageOnBlur()},$LN._stageOnBlur=function(){$LN._isActive=!1,$LN._musicChannel&&($LN._musicChannel.isStopped||($LN._blurPaused=!0,$LN._musicChannel.pause())),$LN.stopAllSound(),$Lw.stage.once("mousedown",null,$LN._stageOnFocus)},$LN._recoverWebAudio=function(){$Lfr.ctx&&"running"!=$Lfr.ctx.state&&$Lfr.ctx.resume&&$Lfr.ctx.resume()},$LN._stageOnFocus=function(){if($LN._isActive=!0,$LN._recoverWebAudio(),$Lw.stage.off("mousedown",null,$LN._stageOnFocus),$LN._blurPaused){var $Lr=$LN._musicChannel;$Lr&&$LN._music&&$Lr.isStopped&&($LN._blurPaused=!1,$LN._music._disposed?$LN.playMusic($Lr.url,$Lr.loops,$Lr.startHandler,$Lr.completeHandler,$Lr.startTime):$Lr.audioBuffer?$Lr.resume():$LN._music.play($Lr.startTime,$Lr.loops,$Lr.startHandler,$Lr))}},$LN.playSound=function($Lr,$Li,$Lt,$L_,$LA,$Lf){if(void 0===$Li&&($Li=1),void 0===$Lf&&($Lf=0),!$Lr)return null;if($LN._muted)return null;if($LN._recoverWebAudio(),$Lr==$LN._tMusic){if($LN._musicMuted)return null}else{if(!$LN._isActive)return null;if($LN._soundMuted)return null}var $LE,$LG=$LN._pool[$Lr];return $LA||($LA=$LN._soundClass),$LG||(($LG=new $LA).load($Lr),$LN._pool[$Lr]=$LG),($LE=$LG.play($Lf,$Li,$Lt))?($Lr==$LN._tMusic&&($LN._music=$LG,$LN._isActive||($LN._blurPaused=!0,$LE.pause())),$LE.url=$Lr,$LE.volume=$Lr==$LN._tMusic?$LN.musicVolume:$LN.soundVolume,$LE.completeHandler=$L_,$LE):null},$LN.destroySound=function($Lr){var $Li=$LN._pool[$Lr];$Li&&(delete $LN._pool[$Lr],$Li.dispose())},$LN.playMusic=function($Lr,$Li,$Lt,$L_,$LA){return void 0===$Li&&($Li=0),void 0===$LA&&($LA=0),$LN._tMusic=$Lr,$LN._musicChannel&&$LN._musicChannel.stop(),$LN._musicChannel=$LN.playSound($Lr,$Li,$Lt,$L_,null,$LA)},$LN.stopSound=function($Lr){for(var $Li,$Lt=$LN._channels.length-1;0<=$Lt;$Lt--)($Li=$LN._channels[$Lt]).url==$Lr&&$Li.stop()},$LN.stopAll=function(){$LN._tMusic=null;var $Lr=0;for($Lr=$LN._channels.length-1;0<=$Lr;$Lr--)$LN._channels[$Lr].stop()},$LN.stopAllSound=function(){var $Lr,$Li=0;for($Li=$LN._channels.length-1;0<=$Li;$Li--)($Lr=$LN._channels[$Li]).url!=$LN._tMusic&&$Lr.stop()},$LN.stopMusic=function(){$LN._musicChannel&&$LN._musicChannel.stop(),$LN._tMusic=null},$LN.setSoundVolume=function($Lr,$Li){if($Li)$LN._setVolume($Li,$Lr);else{$LN.soundVolume=$Lr;var $Lt,$L_=0;for($L_=$LN._channels.length-1;0<=$L_;$L_--)($Lt=$LN._channels[$L_]).url!=$LN._tMusic&&($Lt.volume=$Lr)}},$LN.setMusicVolume=function($Lr){$LN.musicVolume=$Lr,$LN._setVolume($LN._tMusic,$Lr)},$LN._setVolume=function($Lr,$Li){for(var $Lt,$L_=$LN._channels.length-1;0<=$L_;$L_--)($Lt=$LN._channels[$L_]).url==$Lr&&($Lt.volume=$Li)},$LN.musicVolume=1,$LN.soundVolume=1,$LN.playbackRate=1,$LN._useAudioMusic=!0,$LN._muted=!1,$LN._soundMuted=!1,$LN._musicMuted=!1,$LN._tMusic=null,$LN._musicChannel=null,$LN._music=null,$LN._channels=[],$LN._autoStopMusic=!1,$LN._blurPaused=!1,$LN._isActive=!0,$LN._soundClass=null,$LN._musicClass=null,$LN.autoReleaseSound=!0,$LN._pool={},$LN.defaultIntervals={},$LN._notUsedUrls={},$LN._notUsedCount=0,$LN}(),$Ld=function(){var $Lr;function $Lt(){}return $Lg($Lt,"laya.net.LocalStorage"),$Lt.__init__=function(){$Lt._baseClass||($Lt._baseClass=$Lr).init(),$Lt.items=$Lt._baseClass.items,$Lt.support=$Lt._baseClass.support},$Lt.setItem=function($Lr,$Li){$Lt._baseClass.setItem($Lr,$Li)},$Lt.getItem=function($Lr){return $Lt._baseClass.getItem($Lr)},$Lt.setJSON=function($Lr,$Li){$Lt._baseClass.setJSON($Lr,$Li)},$Lt.getJSON=function($Lr){return $Lt._baseClass.getJSON($Lr)},$Lt.removeItem=function($Lr){$Lt._baseClass.removeItem($Lr)},$Lt.clear=function(){$Lt._baseClass.clear()},$Lt._baseClass=null,$Lt.items=null,$Lt.support=!1,$Lt.__init$=function(){$Lr=function(){function $Lt(){}return $Lg($Lt,""),$Lt.init=function(){try{$Lt.support=!0,$Lt.items=$LE.localStorage,$Lt.setItem("laya","1"),$Lt.removeItem("laya")}catch($Lr){$Lt.support=!1}$Lt.support||console.log("LocalStorage is not supprot or browser is private mode.")},$Lt.setItem=function($Lr,$Li){try{$Lt.support&&$Lt.items.setItem($Lr,$Li)}catch($Lr){console.warn("set localStorage failed",$Lr)}},$Lt.getItem=function($Lr){return $Lt.support?$Lt.items.getItem($Lr):null},$Lt.setJSON=function($Lr,$Li){try{$Lt.support&&$Lt.items.setItem($Lr,JSON.stringify($Li))}catch($Lr){console.warn("set localStorage failed",$Lr)}},$Lt.getJSON=function($Lr){return JSON.parse($Lt.support?$Lt.items.getItem($Lr):null)},$Lt.removeItem=function($Lr){$Lt.support&&$Lt.items.removeItem($Lr)},$Lt.clear=function(){$Lt.support&&$Lt.items.clear()},$Lt.items=null,$Lt.support=!1,$Lt}()},$Lt}(),$LL=(function(){function $L_(){}$Lg($L_,"laya.net.ResourceVersion"),$L_.enable=function($Lr,$Li,$Lt){void 0===$Lt&&($Lt=2),laya.net.ResourceVersion.type=$Lt,$Lw.loader.load($Lr,$LC.create(null,$L_.onManifestLoaded,[$Li]),null,"json"),$LQ.customFormat=$L_.addVersionPrefix},$L_.onManifestLoaded=function($Lr,$Li){$L_.manifest=$Li,$Lr.run(),$Li||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},$L_.addVersionPrefix=function($Lr){return $L_.manifest&&$L_.manifest[$Lr]?2==$L_.type?$L_.manifest[$Lr]:$L_.manifest[$Lr]+"/"+$Lr:$Lr},$L_.FOLDER_VERSION=1,$L_.FILENAME_VERSION=2,$L_.manifest=null,$L_.type=1}(),function(){function $Lr(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}$Lg($Lr,"laya.net.TTFLoader");var $Li=$Lr.prototype;return $Li.load=function($Lr){var $Li=(this._url=$Lr).split(".ttf")[0].split("/");this.fontName=$Li[$Li.length-1],$Lq.window.conch?this._loadConch():$Lq.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},$Li._loadConch=function(){this._http=new $LEr,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},$Li._onHttpLoaded=function($Lr){$Lq.window.conch.setFontFaceFromBuffer(this.fontName,$Lr),this._clearHttp(),this._complete()},$Li._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},$Li._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},$Li._complete=function(){$Lw.timer.clear(this,this._complete),$Lw.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},$Li._checkComplete=function(){$Lk.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},$Li._loadWithFontFace=function(){var $Lr=new $Lq.window.FontFace(this.fontName,"url('"+this._url+"')");$Lq.window.document.fonts.add($Lr);var $Li=this;$Lr.loaded.then(function(){$Li._complete()}),$Lr.load()},$Li._createDiv=function(){this._div=$Lq.createElement("div"),this._div.innerHTML="laya";var $Lr=this._div.style;$Lr.fontFamily=this.fontName,$Lr.position="absolute",$Lr.left="-100px",$Lr.top="-100px",$Lq.document.body.appendChild(this._div)},$Li._loadWithCSS=function(){var $Lr=this,$Li=$Lq.createElement("style");$Li.type="text/css",$Lq.document.body.appendChild($Li),$Li.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=$Lk.measureText("LayaTTFFont",this._fontTxt).width;var $Lt=this;$Li.onload=function(){$Lw.timer.once(1e4,$Lt,$Lr._complete)},$Lw.timer.loop(20,this,this._checkComplete),this._createDiv()},$Lr._testString="LayaTTFFont",$Lr}()),$LQ=function(){function $L_($Lr){this._url=null,this._path=null,this._url=$L_.formatURL($Lr),this._path=$L_.getPath($Lr)}$Lg($L_,"laya.net.URL");var $Lr=$L_.prototype;return $LO(0,$Lr,"path",function(){return this._path}),$LO(0,$Lr,"url",function(){return this._url}),$L_.formatURL=function($Lr,$Li){if(!$Lr)return"null path";if(0<$Lr.indexOf(":"))return $Lr;null!=$L_.customFormat&&($Lr=$L_.customFormat($Lr,$Li));var $Lt=$Lr.charAt(0);if("."===$Lt)return $L_.formatRelativePath(($Li||$L_.basePath)+$Lr);if("~"===$Lt)return $L_.rootPath+$Lr.substring(1);if("d"===$Lt){if(0===$Lr.indexOf("data:image"))return $Lr}else if("/"===$Lt)return $Lr;return($Li||$L_.basePath)+$Lr},$L_.formatRelativePath=function($Lr){for(var $Li=$Lr.split("/"),$Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++)".."==$Li[$Lt]&&($Li.splice($Lt-1,2),$Lt-=2);return $Li.join("/")},$L_.isAbsolute=function($Lr){return 0<$Lr.indexOf(":")||"/"==$Lr.charAt(0)},$L_.getPath=function($Lr){var $Li=$Lr.lastIndexOf("/");return 0<$Li?$Lr.substr(0,$Li+1):""},$L_.getFileName=function($Lr){var $Li=$Lr.lastIndexOf("/");return 0<$Li?$Lr.substr($Li+1):$Lr},$L_.version={},$L_.basePath="",$L_.rootPath="",$L_.customFormat=function($Lr){var $Li=$L_.version[$Lr];return!$LF.isConchApp&&$Li&&($Lr+="?v="+$Li),$Lr},$L_}(),$LF=function(){function $LA($Lr,$Li){this._timeId=0;var $Lt=$LA._mainCanvas.source.style;$Lt.position="absolute",$Lt.top=$Lt.left="0px",$Lt.background="#000000",$LA._mainCanvas.source.id="layaCanvas";var $L_=laya.renders.Render.isWebGL;$LA._mainCanvas.source.width=$Lr,$LA._mainCanvas.source.height=$Li,$L_&&$LA.WebGL.init($LA._mainCanvas,$Lr,$Li),$Lq.container.appendChild($LA._mainCanvas.source),($LA._context=new $Lb($Lr,$Li,$L_?null:$LA._mainCanvas)).ctx.setIsMainContext(),$Lq.window.requestAnimationFrame(function $Lr($Li){$Lq.window.requestAnimationFrame($Lr);$Lw.stage._loop()}),$Lw.stage.on("visibilitychange",this,this._onVisibilitychange)}$Lg($LA,"laya.renders.Render");var $Lr=$LA.prototype;return $Lr._onVisibilitychange=function(){$Lw.stage.isVisibility?0!=this._timeId&&$Lq.window.clearInterval(this._timeId):this._timeId=$Lq.window.setInterval(this._enterFrame,1e3)},$Lr._enterFrame=function($Lr){$Lw.stage._loop()},$LO(1,$LA,"context",function(){return $LA._context}),$LO(1,$LA,"canvas",function(){return $LA._mainCanvas.source}),$LA._context=null,$LA._mainCanvas=null,$LA.WebGL=null,$LA.isConchNode=!1,$LA.isConchApp=!1,$LA.isConchWebGL=!1,$LA.isWebGL=!1,$LA.is3DMode=!1,$LA.optimizeTextureMemory=function($Lr,$Li){return!0},$LA.__init$=function(){$LE.ConchRenderType=$LE.ConchRenderType||1,$LE.ConchRenderType|=$LE.conch?4:0,$LA.isConchNode=5==(5&$LE.ConchRenderType),$LA.isConchApp=4==(4&$LE.ConchRenderType),$LA.isConchWebGL=6==$LE.ConchRenderType},$LA}(),$Lb=function(){function $LE($Lr,$Li,$Lt){this.x=0,this.y=0,this._drawTexture=function($Lr,$Li,$Lt){$Lt[0].loaded&&this.ctx.drawTexture($Lt[0],$Lt[1],$Lt[2],$Lt[3],$Lt[4],$Lr,$Li)},this._fillTexture=function($Lr,$Li,$Lt){$Lt[0].loaded&&this.ctx.fillTexture($Lt[0],$Lt[1]+$Lr,$Lt[2]+$Li,$Lt[3],$Lt[4],$Lt[5],$Lt[6],$Lt[7])},this._drawTextureWithTransform=function($Lr,$Li,$Lt){$Lt[0].loaded&&this.ctx.drawTextureWithTransform($Lt[0],$Lt[1],$Lt[2],$Lt[3],$Lt[4],$Lt[5],$Lr,$Li,$Lt[6])},this._fillQuadrangle=function($Lr,$Li,$Lt){this.ctx.fillQuadrangle($Lt[0],$Lt[1],$Lt[2],$Lt[3],$Lt[4])},this._drawRect=function($Lr,$Li,$Lt){var $L_=this.ctx;null!=$Lt[4]&&($L_.fillStyle=$Lt[4],$L_.fillRect($Lr+$Lt[0],$Li+$Lt[1],$Lt[2],$Lt[3],null)),null!=$Lt[5]&&($L_.strokeStyle=$Lt[5],$L_.lineWidth=$Lt[6],$L_.strokeRect($Lr+$Lt[0],$Li+$Lt[1],$Lt[2],$Lt[3],$Lt[6]))},this._drawPie=function($Lr,$Li,$Lt){var $L_=this.ctx;$LF.isWebGL&&$L_.setPathId($Lt[8]),$L_.beginPath(),$LF.isWebGL?($L_.movePath($Lt[0]+$Lr,$Lt[1]+$Li),$L_.moveTo(0,0)):$L_.moveTo($Lr+$Lt[0],$Li+$Lt[1]),$L_.arc($Lr+$Lt[0],$Li+$Lt[1],$Lt[2],$Lt[3],$Lt[4]),$L_.closePath(),this._fillAndStroke($Lt[5],$Lt[6],$Lt[7],!0)},this._clipRect=function($Lr,$Li,$Lt){this.ctx.clipRect($Lr+$Lt[0],$Li+$Lt[1],$Lt[2],$Lt[3])},this._fillRect=function($Lr,$Li,$Lt){this.ctx.fillRect($Lr+$Lt[0],$Li+$Lt[1],$Lt[2],$Lt[3],$Lt[4])},this._drawCircle=function($Lr,$Li,$Lt){var $L_=this.ctx;$LF.isWebGL&&$L_.setPathId($Lt[6]),$LZ.drawCall++,$L_.beginPath(),$LF.isWebGL&&$L_.movePath($Lt[0]+$Lr,$Lt[1]+$Li),$L_.arc($Lt[0]+$Lr,$Lt[1]+$Li,$Lt[2],0,$LE.PI2),$L_.closePath(),this._fillAndStroke($Lt[3],$Lt[4],$Lt[5],!0)},this._fillCircle=function($Lr,$Li,$Lt){$LZ.drawCall++;var $L_=this.ctx;$L_.beginPath(),$L_.fillStyle=$Lt[3],$L_.arc($Lt[0]+$Lr,$Lt[1]+$Li,$Lt[2],0,$LE.PI2),$L_.fill()},this._setShader=function($Lr,$Li,$Lt){this.ctx.setShader($Lt[0])},this._drawLine=function($Lr,$Li,$Lt){var $L_=this.ctx;$LF.isWebGL&&$L_.setPathId($Lt[6]),$L_.beginPath(),$L_.strokeStyle=$Lt[4],$L_.lineWidth=$Lt[5],$LF.isWebGL?($L_.movePath($Lr,$Li),$L_.moveTo($Lt[0],$Lt[1]),$L_.lineTo($Lt[2],$Lt[3])):($L_.moveTo($Lr+$Lt[0],$Li+$Lt[1]),$L_.lineTo($Lr+$Lt[2],$Li+$Lt[3])),$L_.stroke()},this._drawLines=function($Lr,$Li,$Lt){var $L_=this.ctx;$LF.isWebGL&&$L_.setPathId($Lt[5]),$L_.beginPath(),$Lr+=$Lt[0],$Li+=$Lt[1],$LF.isWebGL&&$L_.movePath($Lr,$Li),$L_.strokeStyle=$Lt[3],$L_.lineWidth=$Lt[4];var $LA=$Lt[2],$Lf=2,$LE=$LA.length;if($LF.isWebGL)for($L_.moveTo($LA[0],$LA[1]);$Lf<$LE;)$L_.lineTo($LA[$Lf++],$LA[$Lf++]);else for($L_.moveTo($Lr+$LA[0],$Li+$LA[1]);$Lf<$LE;)$L_.lineTo($Lr+$LA[$Lf++],$Li+$LA[$Lf++]);$L_.stroke()},this._drawLinesWebGL=function($Lr,$Li,$Lt){this.ctx.drawLines($Lr+this.x+$Lt[0],$Li+this.y+$Lt[1],$Lt[2],$Lt[3],$Lt[4])},this._drawCurves=function($Lr,$Li,$Lt){this.ctx.drawCurves($Lr,$Li,$Lt)},this._draw=function($Lr,$Li,$Lt){$Lt[0].call(null,this,$Lr,$Li)},this._transformByMatrix=function($Lr,$Li,$Lt){this.ctx.transformByMatrix($Lt[0])},this._setTransform=function($Lr,$Li,$Lt){this.ctx.setTransform($Lt[0],$Lt[1],$Lt[2],$Lt[3],$Lt[4],$Lt[5])},this._setTransformByMatrix=function($Lr,$Li,$Lt){this.ctx.setTransformByMatrix($Lt[0])},this._save=function($Lr,$Li,$Lt){this.ctx.save()},this._restore=function($Lr,$Li,$Lt){this.ctx.restore()},this._translate=function($Lr,$Li,$Lt){this.ctx.translate($Lt[0],$Lt[1])},this._transform=function($Lr,$Li,$Lt){this.ctx.translate($Lt[1]+$Lr,$Lt[2]+$Li);var $L_=$Lt[0];this.ctx.transform($L_.a,$L_.b,$L_.c,$L_.d,$L_.tx,$L_.ty),this.ctx.translate(-$Lr-$Lt[1],-$Li-$Lt[2])},this._rotate=function($Lr,$Li,$Lt){this.ctx.translate($Lt[1]+$Lr,$Lt[2]+$Li),this.ctx.rotate($Lt[0]),this.ctx.translate(-$Lr-$Lt[1],-$Li-$Lt[2])},this._scale=function($Lr,$Li,$Lt){this.ctx.translate($Lt[2]+$Lr,$Lt[3]+$Li),this.ctx.scale($Lt[0],$Lt[1]),this.ctx.translate(-$Lr-$Lt[2],-$Li-$Lt[3])},this._alpha=function($Lr,$Li,$Lt){this.ctx.globalAlpha*=$Lt[0]},this._setAlpha=function($Lr,$Li,$Lt){this.ctx.globalAlpha=$Lt[0]},this._fillText=function($Lr,$Li,$Lt){this.ctx.fillText($Lt[0],$Lt[1]+$Lr,$Lt[2]+$Li,$Lt[3],$Lt[4],$Lt[5])},this._strokeText=function($Lr,$Li,$Lt){this.ctx.strokeText($Lt[0],$Lt[1]+$Lr,$Lt[2]+$Li,$Lt[3],$Lt[4],$Lt[5],$Lt[6])},this._fillBorderText=function($Lr,$Li,$Lt){this.ctx.fillBorderText($Lt[0],$Lt[1]+$Lr,$Lt[2]+$Li,$Lt[3],$Lt[4],$Lt[5],$Lt[6],$Lt[7])},this._blendMode=function($Lr,$Li,$Lt){this.ctx.globalCompositeOperation=$Lt[0]},this._beginClip=function($Lr,$Li,$Lt){this.ctx.beginClip&&this.ctx.beginClip($Lr+$Lt[0],$Li+$Lt[1],$Lt[2],$Lt[3])},this._setIBVB=function($Lr,$Li,$Lt){this.ctx.setIBVB($Lt[0]+$Lr,$Lt[1]+$Li,$Lt[2],$Lt[3],$Lt[4],$Lt[5],$Lt[6],$Lt[7])},this._fillTrangles=function($Lr,$Li,$Lt){this.ctx.fillTrangles($Lt[0],$Lt[1]+$Lr,$Lt[2]+$Li,$Lt[3],$Lt[4])},this._drawPath=function($Lr,$Li,$Lt){var $L_=this.ctx;$LF.isWebGL&&$L_.setPathId(-1),$L_.beginPath(),$Lr+=$Lt[0],$Li+=$Lt[1],$LF.isWebGL&&$L_.movePath($Lr,$Li);for(var $LA=$Lt[2],$Lf=0,$LE=$LA.length;$Lf<$LE;$Lf++){var $LG=$LA[$Lf];switch($LG[0]){case"moveTo":$LF.isWebGL?$L_.moveTo($LG[1],$LG[2]):$L_.moveTo($Lr+$LG[1],$Li+$LG[2]);break;case"lineTo":$LF.isWebGL?$L_.lineTo($LG[1],$LG[2]):$L_.lineTo($Lr+$LG[1],$Li+$LG[2]);break;case"arcTo":$LF.isWebGL?$L_.arcTo($LG[1],$LG[2],$LG[3],$LG[4],$LG[5]):$L_.arcTo($Lr+$LG[1],$Li+$LG[2],$Lr+$LG[3],$Li+$LG[4],$LG[5]);break;case"closePath":$L_.closePath()}}var $LN=$Lt[3];null!=$LN&&($L_.fillStyle=$LN.fillStyle,$L_.fill());var $Lp=$Lt[4];null!=$Lp&&($L_.strokeStyle=$Lp.strokeStyle,$L_.lineWidth=$Lp.lineWidth||1,$L_.lineJoin=$Lp.lineJoin,$L_.lineCap=$Lp.lineCap,$L_.miterLimit=$Lp.miterLimit,$L_.stroke())},this.drawPoly=function($Lr,$Li,$Lt){this.ctx.drawPoly($Lr+this.x+$Lt[0],$Li+this.y+$Lt[1],$Lt[2],$Lt[3],$Lt[4],$Lt[5],$Lt[6])},this._drawPoly=function($Lr,$Li,$Lt){var $L_=this.ctx,$LA=$Lt[2],$Lf=2,$LE=$LA.length;if($LF.isWebGL)for($L_.setPathId($Lt[6]),$L_.beginPath(),$Lr+=$Lt[0],$Li+=$Lt[1],$L_.movePath($Lr,$Li),$L_.moveTo($LA[0],$LA[1]);$Lf<$LE;)$L_.lineTo($LA[$Lf++],$LA[$Lf++]);else for($L_.beginPath(),$Lr+=$Lt[0],$Li+=$Lt[1],$L_.moveTo($Lr+$LA[0],$Li+$LA[1]);$Lf<$LE;)$L_.lineTo($Lr+$LA[$Lf++],$Li+$LA[$Lf++]);$L_.closePath(),this._fillAndStroke($Lt[3],$Lt[4],$Lt[5],$Lt[7])},this._drawSkin=function($Lr,$Li,$Lt){var $L_=$Lt[0];if($L_){var $LA=this.ctx;$L_.render($LA,$Lr,$Li)}},this._drawParticle=function($Lr,$Li,$Lt){this.ctx.drawParticle($Lr+this.x,$Li+this.y,$Lt[0])},this._setFilters=function($Lr,$Li,$Lt){this.ctx.setFilters($Lt)},$Lt?this.ctx=$Lt.getContext("2d"):($Lt=$Lnr.create("3D"),this.ctx=$Lk.createWebGLContext2D($Lt),$Lt._setContext(this.ctx)),$Lt.size($Lr,$Li),this.canvas=$Lt}$Lg($LE,"laya.renders.RenderContext");var $Lr=$LE.prototype;return $Lr.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},$Lr.drawTexture=function($Lr,$Li,$Lt,$L_,$LA){$Lr.loaded&&this.ctx.drawTexture($Lr,$Li,$Lt,$L_,$LA,this.x,this.y)},$Lr._drawTextures=function($Lr,$Li,$Lt){$Lt[0].loaded&&this.ctx.drawTextures($Lt[0],$Lt[1],$Lr+this.x,$Li+this.y)},$Lr.drawTextureWithTransform=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){$Lr.loaded&&this.ctx.drawTextureWithTransform($Lr,$Li,$Lt,$L_,$LA,$Lf,this.x,this.y,$LE)},$Lr.fillQuadrangle=function($Lr,$Li,$Lt,$L_,$LA){this.ctx.fillQuadrangle($Lr,$Li,$Lt,$L_,$LA)},$Lr.drawCanvas=function($Lr,$Li,$Lt,$L_,$LA){this.ctx.drawCanvas($Lr,$Li+this.x,$Lt+this.y,$L_,$LA)},$Lr.drawRect=function($Lr,$Li,$Lt,$L_,$LA,$Lf){void 0===$Lf&&($Lf=1);var $LE=this.ctx;$LE.strokeStyle=$LA,$LE.lineWidth=$Lf,$LE.strokeRect($Lr+this.x,$Li+this.y,$Lt,$L_,$Lf)},$Lr._fillAndStroke=function($Lr,$Li,$Lt,$L_){void 0===$L_&&($L_=!1);var $LA=this.ctx;null!=$Lr&&($LA.fillStyle=$Lr,$LF.isWebGL?$LA.fill($L_):$LA.fill()),null!=$Li&&0<$Lt&&($LA.strokeStyle=$Li,$LA.lineWidth=$Lt,$LA.stroke())},$Lr.clipRect=function($Lr,$Li,$Lt,$L_){this.ctx.clipRect($Lr+this.x,$Li+this.y,$Lt,$L_)},$Lr.fillRect=function($Lr,$Li,$Lt,$L_,$LA){this.ctx.fillRect($Lr+this.x,$Li+this.y,$Lt,$L_,$LA)},$Lr.drawCircle=function($Lr,$Li,$Lt,$L_,$LA){void 0===$LA&&($LA=1),$LZ.drawCall++;var $Lf=this.ctx;$Lf.beginPath(),$Lf.strokeStyle=$L_,$Lf.lineWidth=$LA,$Lf.arc($Lr+this.x,$Li+this.y,$Lt,0,$LE.PI2),$Lf.stroke()},$Lr.drawTriangles=function($Lr,$Li,$Lt){if($LF.isWebGL)this.ctx.drawTriangles($Lt[0],$Lr+$Lt[1],$Li+$Lt[2],$Lt[3],$Lt[4],$Lt[5],$Lt[6],$Lt[7],$Lt[8],$Lt[9]);else{var $L_=$Lt[5],$LA=0,$Lf=$L_.length,$LE=this.ctx;for($LA=0;$LA<$Lf;$LA+=3){var $LG=2*$L_[$LA],$LN=2*$L_[$LA+1],$Lp=2*$L_[$LA+2];$LE.drawTriangle($Lt[0],$Lt[3],$Lt[4],$LG,$LN,$Lp,$Lt[6],!0)}}},$Lr.fillCircle=function($Lr,$Li,$Lt,$L_){$LZ.drawCall++;var $LA=this.ctx;$LA.beginPath(),$LA.fillStyle=$L_,$LA.arc($Lr+this.x,$Li+this.y,$Lt,0,$LE.PI2),$LA.fill()},$Lr.setShader=function($Lr){this.ctx.setShader($Lr)},$Lr.drawLine=function($Lr,$Li,$Lt,$L_,$LA,$Lf){void 0===$Lf&&($Lf=1);var $LE=this.ctx;$LE.beginPath(),$LE.strokeStyle=$LA,$LE.lineWidth=$Lf,$LE.moveTo(this.x+$Lr,this.y+$Li),$LE.lineTo(this.x+$Lt,this.y+$L_),$LE.stroke()},$Lr.clear=function(){this.ctx.clear()},$Lr.transformByMatrix=function($Lr){this.ctx.transformByMatrix($Lr)},$Lr.setTransform=function($Lr,$Li,$Lt,$L_,$LA,$Lf){this.ctx.setTransform($Lr,$Li,$Lt,$L_,$LA,$Lf)},$Lr.setTransformByMatrix=function($Lr){this.ctx.setTransformByMatrix($Lr)},$Lr.save=function(){this.ctx.save()},$Lr.restore=function(){this.ctx.restore()},$Lr.translate=function($Lr,$Li){this.ctx.translate($Lr,$Li)},$Lr.transform=function($Lr,$Li,$Lt,$L_,$LA,$Lf){this.ctx.transform($Lr,$Li,$Lt,$L_,$LA,$Lf)},$Lr.rotate=function($Lr){this.ctx.rotate($Lr)},$Lr.scale=function($Lr,$Li){this.ctx.scale($Lr,$Li)},$Lr.alpha=function($Lr){this.ctx.globalAlpha*=$Lr},$Lr.setAlpha=function($Lr){this.ctx.globalAlpha=$Lr},$Lr.fillWords=function($Lr,$Li,$Lt,$L_,$LA,$Lf){void 0===$Lf&&($Lf=0),this.ctx.fillWords($Lr,$Li,$Lt,$L_,$LA,$Lf)},$Lr.fillBorderWords=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this.ctx.fillBorderWords($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE)},$Lr.fillText=function($Lr,$Li,$Lt,$L_,$LA,$Lf){this.ctx.fillText($Lr,$Li+this.x,$Lt+this.y,$L_,$LA,$Lf)},$Lr.strokeText=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this.ctx.strokeText($Lr,$Li+this.x,$Lt+this.y,$L_,$LA,$Lf,$LE)},$Lr.blendMode=function($Lr){this.ctx.globalCompositeOperation=$Lr},$Lr.flush=function(){this.ctx.flush&&this.ctx.flush()},$Lr.addRenderObject=function($Lr){this.ctx.addRenderObject($Lr)},$Lr.beginClip=function($Lr,$Li,$Lt,$L_){this.ctx.beginClip&&this.ctx.beginClip($Lr,$Li,$Lt,$L_)},$Lr.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},$Lr.fillTrangles=function($Lr,$Li,$Lt){this.ctx.fillTrangles($Lt[0],$Lt[1],$Lt[2],$Lt[3],4<$Lt.length?$Lt[4]:null)},$LE.PI2=2*Math.PI,$LE}(),$LV=function(){function $LE($Lr,$Li){switch(this._next=$Li||$LE.NORENDER,$Lr){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=$Ly._filter);case 69905:return void(this._fun=$LE._initRenderFun)}this.onCreate($Lr)}$Lg($LE,"laya.renders.RenderSprite");var $Lr=$LE.prototype;return $Lr.onCreate=function($Lr){},$Lr._style=function($Lr,$Li,$Lt,$L_){$Lr._style.render($Lr,$Li,$Lt,$L_);var $LA=this._next;$LA._fun.call($LA,$Lr,$Li,$Lt,$L_)},$Lr._no=function($Lr,$Li,$Lt,$L_){},$Lr._custom=function($Lr,$Li,$Lt,$L_){$Lr.customRender($Li,$Lt,$L_);var $LA=$Lr._style._tf;this._next._fun.call(this._next,$Lr,$Li,$Lt-$LA.translateX,$L_-$LA.translateY)},$Lr._clip=function($Lr,$Li,$Lt,$L_){var $LA=this._next;if($LA!=$LE.NORENDER){var $Lf=$Lr._style.scrollRect;$Li.ctx.save(),$Li.ctx.clipRect($Lt,$L_,$Lf.width,$Lf.height),$LA._fun.call($LA,$Lr,$Li,$Lt-$Lf.x,$L_-$Lf.y),$Li.ctx.restore()}},$Lr._blend=function($Lr,$Li,$Lt,$L_){var $LA=$Lr._style;$LA.blendMode&&($Li.ctx.globalCompositeOperation=$LA.blendMode);var $Lf=this._next;$Lf._fun.call($Lf,$Lr,$Li,$Lt,$L_),$Li.ctx.globalCompositeOperation="source-over"},$Lr._mask=function($Lr,$Li,$Lt,$L_){var $LA=this._next;$LA._fun.call($LA,$Lr,$Li,$Lt,$L_);var $Lf=$Lr.mask;$Lf&&($Li.ctx.globalCompositeOperation="destination-in",(0<$Lf.numChildren||!$Lf.graphics._isOnlyOne())&&($Lf.cacheAsBitmap=!0),$Lf.render($Li,$Lt-$Lr.pivotX,$L_-$Lr.pivotY)),$Li.ctx.globalCompositeOperation="source-over"},$Lr._graphics=function($Lr,$Li,$Lt,$L_){var $LA=$Lr._style._tf;$Lr._graphics&&$Lr._graphics._render($Lr,$Li,$Lt-$LA.translateX,$L_-$LA.translateY);var $Lf=this._next;$Lf._fun.call($Lf,$Lr,$Li,$Lt,$L_)},$Lr._image=function($Lr,$Li,$Lt,$L_){var $LA=$Lr._style;$Li.ctx.drawTexture2($Lt,$L_,$LA._tf.translateX,$LA._tf.translateY,$Lr.transform,$LA.alpha,$LA.blendMode,$Lr._graphics._one)},$Lr._image2=function($Lr,$Li,$Lt,$L_){var $LA=$Lr._style._tf;$Li.ctx.drawTexture2($Lt,$L_,$LA.translateX,$LA.translateY,$Lr.transform,1,null,$Lr._graphics._one)},$Lr._alpha=function($Lr,$Li,$Lt,$L_){var $LA;if(.01<($LA=$Lr._style.alpha)||$Lr._needRepaint()){var $Lf=$Li.ctx.globalAlpha;$Li.ctx.globalAlpha*=$LA;var $LE=this._next;$LE._fun.call($LE,$Lr,$Li,$Lt,$L_),$Li.ctx.globalAlpha=$Lf}},$Lr._transform=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.transform,$Lf=this._next;$LA&&$Lf!=$LE.NORENDER?($Li.save(),$Li.transform($LA.a,$LA.b,$LA.c,$LA.d,$LA.tx+$Lt,$LA.ty+$L_),$Lf._fun.call($Lf,$Lr,$Li,0,0),$Li.restore()):$Lf._fun.call($Lf,$Lr,$Li,$Lt,$L_)},$Lr._childs=function($Lr,$Li,$Lt,$L_){var $LA=$Lr._style,$Lf=$LA._tf;if($Lt=$Lt-$Lf.translateX+$LA.paddingLeft,$L_=$L_-$Lf.translateY+$LA.paddingTop,$LA._calculation){var $LE=$Lr._getWords();if($LE){var $LG=$LA;$LG&&($LG.stroke?$Li.fillBorderWords($LE,$Lt,$L_,$LG.font,$LG.color,$LG.strokeColor,$LG.stroke):$Li.fillWords($LE,$Lt,$L_,$LG.font,$LG.color,"none"!=$LG.textDecoration&&$LG.underLine?1:0))}}var $LN,$Lp=$Lr._childs,$Lg=$Lp.length;if($Lr.viewport||$Lr.optimizeScrollRect&&$Lr._style.scrollRect){var $LR=$Lr.viewport||$Lr._style.scrollRect,$LX=$LR.x,$Lv=$LR.y,$LO=$LR.right,$Lc=$LR.bottom,$LB=NaN,$Ly=NaN;for($LC=0;$LC<$Lg;++$LC)($LN=$Lp[$LC]).visible&&($LB=$LN._x)<$LO&&$LB+$LN.width>$LX&&($Ly=$LN._y)<$Lc&&$Ly+$LN.height>$Lv&&$LN.render($Li,$Lt,$L_)}else for(var $LC=0;$LC<$Lg;++$LC)($LN=$Lp[$LC])._style.visible&&$LN.render($Li,$Lt,$L_)},$Lr._canvas=function($Lr,$Li,$Lt,$L_){var $LA=$Lr._$P.cacheCanvas;if($LA){"bitmap"===$LA.type?$LZ.canvasBitmap++:$LZ.canvasNormal++;var $Lf=$LA.ctx;if($Lr._needRepaint()||!$Lf)this._canvas_repaint($Lr,$Li,$Lt,$L_);else{var $LE=$LA._cacheRec;$Li.drawCanvas($Lf.canvas,$Lt+$LE.x,$L_+$LE.y,$LE.width,$LE.height)}}else this._next._fun.call(this._next,$Lr,$Li,$Lt,$L_)},$Lr._canvas_repaint=function($Lr,$Li,$Lt,$L_){var $LA=$Lr._$P.cacheCanvas,$Lf=this._next;if($LA){var $LE,$LG,$LN,$Lp,$Lg=$LA.ctx,$LR=$Lr._needRepaint()||!$Lg,$LX=$LA.type;if("bitmap"===$LX?$LZ.canvasBitmap++:$LZ.canvasNormal++,$LR){var $Lv,$LO;$LA._cacheRec||($LA._cacheRec=new $Ls),$LF.isWebGL&&"bitmap"!==$LX?$LA._cacheRec.setTo(-$Lr.pivotX,-$Lr.pivotY,1,1):(($Lp=$Lr.getSelfBounds()).x=$Lp.x-$Lr.pivotX,$Lp.y=$Lp.y-$Lr.pivotY,$Lp.x=$Lp.x-16,$Lp.y=$Lp.y-16,$Lp.width=$Lp.width+32,$Lp.height=$Lp.height+32,$Lp.x=Math.floor($Lp.x+$Lt)-$Lt,$Lp.y=Math.floor($Lp.y+$L_)-$L_,$Lp.width=Math.floor($Lp.width),$Lp.height=Math.floor($Lp.height),$LA._cacheRec.copyFrom($Lp)),$Lp=$LA._cacheRec;var $Lc,$LB=$LF.isWebGL?1:$Lq.pixelRatio*$Lw.stage.clientScaleX,$Ly=$LF.isWebGL?1:$Lq.pixelRatio*$Lw.stage.clientScaleY;if(!$LF.isWebGL){var $LC,$Ln=1,$La=1;for($LC=$Lr;$LC&&$LC!=$Lw.stage;)$Ln*=$LC.scaleX,$La*=$LC.scaleY,$LC=$LC.parent;$LF.isWebGL?($Ln<1&&($LB*=$Ln),$La<1&&($Ly*=$La)):(1<$Ln&&($LB*=$Ln),1<$La&&($Ly*=$La))}if($Lr.scrollRect){var $LD=$Lr.scrollRect;$Lp.x-=$LD.x,$Lp.y-=$LD.y}if($Lv=$Lp.width*$LB,$LO=$Lp.height*$Ly,$LG=$Lp.x,$LN=$Lp.y,$LF.isWebGL&&"bitmap"===$LX&&(2048<$Lv||2048<$LO))return console.warn("cache bitmap size larger than 2048,cache ignored"),$LA.ctx&&($LJ.recover("RenderContext",$LA.ctx),$LA.ctx.canvas.size(0,0),$LA.ctx=null),void $Lf._fun.call($Lf,$Lr,$Li,$Lt,$L_);if($Lg||($Lg=$LA.ctx=$LJ.getItem("RenderContext")||new $Lb($Lv,$LO,$Lnr.create("AUTO"))),$Lg.ctx.sprite=$Lr,($LE=$Lg.canvas).clear(),($LE.width!=$Lv||$LE.height!=$LO)&&$LE.size($Lv,$LO),"bitmap"===$LX?$LE.context.asBitmap=!0:"normal"===$LX&&($LE.context.asBitmap=!1),1!=$LB||1!=$Ly){var $Lu=$Lg.ctx;$Lu.save(),$Lu.scale($LB,$Ly),!$LF.isConchWebGL&&$LF.isConchApp&&($Lc=$Lr._$P.cf)&&$Lu.setFilterMatrix&&$Lu.setFilterMatrix($Lc._mat,$Lc._alpha),$Lf._fun.call($Lf,$Lr,$Lg,-$LG,-$LN),$Lu.restore(),$LF.isConchApp&&!$LF.isConchWebGL||$Lr._applyFilters()}else $Lu=$Lg.ctx,!$LF.isConchWebGL&&$LF.isConchApp&&($Lc=$Lr._$P.cf)&&$Lu.setFilterMatrix&&$Lu.setFilterMatrix($Lc._mat,$Lc._alpha),$Lf._fun.call($Lf,$Lr,$Lg,-$LG,-$LN),$LF.isConchApp&&!$LF.isConchWebGL||$Lr._applyFilters();$Lr._$P.staticCache&&($LA.reCache=!1),$LZ.canvasReCache++}else $LG=($Lp=$LA._cacheRec).x,$LN=$Lp.y,$LE=$Lg.canvas;$Li.drawCanvas($LE,$Lt+$LG,$L_+$LN,$Lp.width,$Lp.height)}else $Lf._fun.call($Lf,$Lr,$Lg,$Lt,$L_)},$LE.__init__=function(){var $Lr,$Li,$Lt=0;for($Li=$Lk.createRenderSprite(69905,null),$Lr=$LE.renders.length=4096,$Lt=0;$Lt<$Lr;$Lt++)$LE.renders[$Lt]=$Li;$LE.renders[0]=$Lk.createRenderSprite(0,null),function($Lr,$Li){for(var $Lt=0,$L_=0;$L_<$Lr.length;$L_++)$Lt|=$Lr[$L_],$LE.renders[$Lt]=$Li}([1,512,4,2],new $LE(1,null)),$LE.renders[513]=$Lk.createRenderSprite(513,null),$LE.renders[517]=new $LE(517,null)},$LE._initRenderFun=function($Lr,$Li,$Lt,$L_){var $LA=$Lr._renderType;($LE.renders[$LA]=$LE._getTypeRender($LA))._fun($Lr,$Li,$Lt,$L_)},$LE._getTypeRender=function($Lr){for(var $Li=null,$Lt=2048;1<$Lt;)$Lt&$Lr&&($Li=$Lk.createRenderSprite($Lt,$Li)),$Lt>>=1;return $Li},$LE.IMAGE=1,$LE.ALPHA=2,$LE.TRANSFORM=4,$LE.BLEND=8,$LE.CANVAS=16,$LE.FILTERS=32,$LE.MASK=64,$LE.CLIP=128,$LE.STYLE=256,$LE.GRAPHICS=512,$LE.CUSTOM=1024,$LE.CHILDS=2048,$LE.INIT=69905,$LE.renders=[],$LE.NORENDER=new $LE(0,null),$LE}(),$Lh=function(){function $LG(){this._repaint=!1}$Lg($LG,"laya.resource.Context");var $Lr=$LG.prototype;return $Lr.replaceReset=function(){var $Lr,$Li,$Lt=0;for($Lr=$LG.replaceKeys.length,$Lt=0;$Lt<$Lr;$Lt++)$Li=$LG.replaceKeys[$Lt],this[$LG.newKeys[$Lt]]=this[$Li]},$Lr.replaceResotre=function(){this.__restore(),this.__reset()},$Lr.setIsMainContext=function(){},$Lr.drawTextures=function($Lr,$Li,$Lt,$L_){$LZ.drawCall+=$Li.length/2;for(var $LA=$Lr.width,$Lf=$Lr.height,$LE=0,$LG=$Li.length;$LE<$LG;$LE+=2)this.drawTexture($Lr,$Li[$LE],$Li[$LE+1],$LA,$Lf,$Lt,$L_)},$Lr.drawCanvas=function($Lr,$Li,$Lt,$L_,$LA){$LZ.drawCall++,this.drawImage($Lr.source,$Li,$Lt,$L_,$LA)},$Lr.fillRect=function($Lr,$Li,$Lt,$L_,$LA){$LZ.drawCall++,$LA&&(this.fillStyle=$LA),this.__fillRect($Lr,$Li,$Lt,$L_)},$Lr.fillText=function($Lr,$Li,$Lt,$L_,$LA,$Lf){$LZ.drawCall++,3<arguments.length&&null!=$L_&&(this.font=$L_,this.fillStyle=$LA,this.textAlign=$Lf,this.textBaseline="top"),this.__fillText($Lr,$Li,$Lt)},$Lr.fillBorderText=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){$LZ.drawCall++,this.font=$L_,this.fillStyle=$LA,this.textBaseline="top",this.strokeStyle=$Lf,this.lineWidth=$LE,this.textAlign=$LG,this.__strokeText($Lr,$Li,$Lt),this.__fillText($Lr,$Li,$Lt)},$Lr.strokeText=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){$LZ.drawCall++,3<arguments.length&&null!=$L_&&(this.font=$L_,this.strokeStyle=$LA,this.lineWidth=$Lf,this.textAlign=$LE,this.textBaseline="top"),this.__strokeText($Lr,$Li,$Lt)},$Lr.transformByMatrix=function($Lr){this.transform($Lr.a,$Lr.b,$Lr.c,$Lr.d,$Lr.tx,$Lr.ty)},$Lr.setTransformByMatrix=function($Lr){this.setTransform($Lr.a,$Lr.b,$Lr.c,$Lr.d,$Lr.tx,$Lr.ty)},$Lr.clipRect=function($Lr,$Li,$Lt,$L_){$LZ.drawCall++,this.beginPath(),this.rect($Lr,$Li,$Lt,$L_),this.clip()},$Lr.drawTexture=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){$LZ.drawCall++;var $LG=$Lr.uv,$LN=$Lr.bitmap.width,$Lp=$Lr.bitmap.height;this.drawImage($Lr.source,$LG[0]*$LN,$LG[1]*$Lp,($LG[2]-$LG[0])*$LN,($LG[5]-$LG[3])*$Lp,$Li+$Lf,$Lt+$LE,$L_,$LA)},$Lr.drawTextureWithTransform=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){$LZ.drawCall++;var $Lp=$Lr.uv,$Lg=$Lr.bitmap.width,$LR=$Lr.bitmap.height;this.save(),1!=$LN&&(this.globalAlpha*=$LN),$Lf?(this.transform($Lf.a,$Lf.b,$Lf.c,$Lf.d,$Lf.tx+$LE,$Lf.ty+$LG),this.drawImage($Lr.source,$Lp[0]*$Lg,$Lp[1]*$LR,($Lp[2]-$Lp[0])*$Lg,($Lp[5]-$Lp[3])*$LR,$Li,$Lt,$L_,$LA)):this.drawImage($Lr.source,$Lp[0]*$Lg,$Lp[1]*$LR,($Lp[2]-$Lp[0])*$Lg,($Lp[5]-$Lp[3])*$LR,$Li+$LE,$Lt+$LG,$L_,$LA),this.restore()},$Lr.drawTexture2=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){var $LN=$LG[0];if($LN.loaded&&$LN.bitmap&&$LN.source){$LZ.drawCall++;var $Lp=1!==$Lf;if($Lp){var $Lg=this.globalAlpha;this.globalAlpha*=$Lf}var $LR=$LN.uv,$LX=$LN.bitmap.width,$Lv=$LN.bitmap.height;$LA?(this.save(),this.transform($LA.a,$LA.b,$LA.c,$LA.d,$LA.tx+$Lr,$LA.ty+$Li),this.drawImage($LN.source,$LR[0]*$LX,$LR[1]*$Lv,($LR[2]-$LR[0])*$LX,($LR[5]-$LR[3])*$Lv,$LG[1]-$Lt,$LG[2]-$L_,$LG[3],$LG[4]),this.restore()):this.drawImage($LN.source,$LR[0]*$LX,$LR[1]*$Lv,($LR[2]-$LR[0])*$LX,($LR[5]-$LR[3])*$Lv,$LG[1]-$Lt+$Lr,$LG[2]-$L_+$Li,$LG[3],$LG[4]),$Lp&&(this.globalAlpha=$Lg)}},$Lr.fillTexture=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){if(!$LG.pat){if($Lr.uv!=$Lgr.DEF_UV){var $LN=new $Lnr("2D");$LN.getContext("2d"),$LN.size($Lr.width,$Lr.height),$LN.context.drawTexture($Lr,0,0,$Lr.width,$Lr.height,0,0),$Lr=new $Lgr($LN)}$LG.pat=this.createPattern($Lr.bitmap.source,$Lf)}var $Lp=$Li,$Lg=$Lt,$LR=0,$LX=0;$LE&&($Lp+=$LE.x%$Lr.width,$Lg+=$LE.y%$Lr.height,$LR-=$LE.x%$Lr.width,$LX-=$LE.y%$Lr.height),this.translate($Lp,$Lg),this.fillRect($LR,$LX,$L_,$LA,$LG.pat),this.translate(-$Lp,-$Lg)},$Lr.drawTriangle=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){var $LN=$Lr.bitmap,$Lp=$LN.source,$Lg=$Lr.width,$LR=$Lr.height,$LX=$LN.width,$Lv=$LN.height,$LO=$Lt[$L_]*$LX,$Lc=$Lt[$LA]*$LX,$LB=$Lt[$Lf]*$LX,$Ly=$Lt[$L_+1]*$Lv,$LC=$Lt[$LA+1]*$Lv,$Ln=$Lt[$Lf+1]*$Lv,$La=$Li[$L_],$LD=$Li[$LA],$Lu=$Li[$Lf],$Lw=$Li[$L_+1],$LH=$Li[$LA+1],$Ls=$Li[$Lf+1];if($LG){var $Ld=($La+$LD+$Lu)/3,$Ll=($Lw+$LH+$Ls)/3,$LU=$La-$Ld,$Lk=$Lw-$Ll,$Le=Math.sqrt($LU*$LU+$Lk*$Lk);$La=$Ld+$LU/$Le*($Le+1),$Lw=$Ll+$Lk/$Le*($Le+1),$Lk=$LH-$Ll,$LD=$Ld+($LU=$LD-$Ld)/($Le=Math.sqrt($LU*$LU+$Lk*$Lk))*($Le+1),$LH=$Ll+$Lk/$Le*($Le+1),$Lk=$Ls-$Ll,$Lu=$Ld+($LU=$Lu-$Ld)/($Le=Math.sqrt($LU*$LU+$Lk*$Lk))*($Le+1),$Ls=$Ll+$Lk/$Le*($Le+1)}this.save(),$LE&&this.transform($LE.a,$LE.b,$LE.c,$LE.d,$LE.tx,$LE.ty),this.beginPath(),this.moveTo($La,$Lw),this.lineTo($LD,$LH),this.lineTo($Lu,$Ls),this.closePath(),this.clip();var $LL=1/($LO*$LC+$Ly*$LB+$Lc*$Ln-$LC*$LB-$Ly*$Lc-$LO*$Ln),$LQ=$La*$LC+$Ly*$Lu+$LD*$Ln-$LC*$Lu-$Ly*$LD-$La*$Ln,$LF=$LO*$LD+$La*$LB+$Lc*$Lu-$LD*$LB-$La*$Lc-$LO*$Lu,$Lb=$LO*$LC*$Lu+$Ly*$LD*$LB+$La*$Lc*$Ln-$La*$LC*$LB-$Ly*$Lc*$Lu-$LO*$LD*$Ln,$LV=$Lw*$LC+$Ly*$Ls+$LH*$Ln-$LC*$Ls-$Ly*$LH-$Lw*$Ln,$Lh=$LO*$LH+$Lw*$LB+$Lc*$Ls-$LH*$LB-$Lw*$Lc-$LO*$Ls,$LP=$LO*$LC*$Ls+$Ly*$LH*$LB+$Lw*$Lc*$Ln-$Lw*$LC*$LB-$Ly*$Lc*$Ls-$LO*$LH*$Ln;this.transform($LQ*$LL,$LV*$LL,$LF*$LL,$Lh*$LL,$Lb*$LL,$LP*$LL),this.drawImage($Lp,$Lr.uv[0]*$LX,$Lr.uv[1]*$Lv,$Lg,$LR,$Lr.uv[0]*$LX,$Lr.uv[1]*$Lv,$Lg,$LR),this.restore()},$Lr.flush=function(){return 0},$Lr.fillWords=function($Lr,$Li,$Lt,$L_,$LA,$Lf){$L_&&(this.font=$L_),$LA&&(this.fillStyle=$LA);this.textBaseline="top",this.textAlign="left";for(var $LE=0,$LG=$Lr.length;$LE<$LG;$LE++){var $LN=$Lr[$LE];if(this.__fillText($LN.char,$LN.x+$Li,$LN.y+$Lt),1===$Lf){var $Lp=$LN.height,$Lg=.5*$LN.style.letterSpacing;$Lg||($Lg=0),this.beginPath(),this.strokeStyle=$LA,this.lineWidth=1,this.moveTo($Li+$LN.x-$Lg+.5,$Lt+$LN.y+$Lp+.5),this.lineTo($Li+$LN.x+$LN.width+$Lg+.5,$Lt+$LN.y+$Lp+.5),this.stroke()}}},$Lr.fillBorderWords=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){$L_&&(this.font=$L_),$LA&&(this.fillStyle=$LA),this.textBaseline="top",this.lineWidth=$LE,this.textAlign="left",this.strokeStyle=$Lf;for(var $LG=0,$LN=$Lr.length;$LG<$LN;$LG++){var $Lp=$Lr[$LG];this.__strokeText($Lp.char,$Lp.x+$Li,$Lp.y+$Lt),this.__fillText($Lp.char,$Lp.x+$Li,$Lp.y+$Lt)}},$Lr.destroy=function(){this.canvas.width=this.canvas.height=0},$Lr.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},$Lr.drawCurves=function($Lr,$Li,$Lt){this.beginPath(),this.strokeStyle=$Lt[3],this.lineWidth=$Lt[4];var $L_=$Lt[2];$Lr+=$Lt[0],$Li+=$Lt[1],this.moveTo($Lr+$L_[0],$Li+$L_[1]);for(var $LA=2,$Lf=$L_.length;$LA<$Lf;)this.quadraticCurveTo($Lr+$L_[$LA++],$Li+$L_[$LA++],$Lr+$L_[$LA++],$Li+$L_[$LA++]);this.stroke()},$LG.__init__=function($Li){var $Lt=laya.resource.Context.prototype;if(!($Li=$Li||CanvasRenderingContext2D.prototype).inited){$Li.inited=!0,$Li.__fillText=$Li.fillText,$Li.__fillRect=$Li.fillRect,$Li.__strokeText=$Li.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function($Lr){$Li[$Lr]=$Lt[$Lr]})}},$LG.replaceCanvasGetSet=function($Lr,$Li){var $Lt=Object.getOwnPropertyDescriptor($Lr,$Li);if(!$Lt||!$Lt.configurable)return!1;var $L_,$LA={};for($L_ in $Lt)"set"!=$L_&&($LA[$L_]=$Lt[$L_]);var $Lf=$Lt.set;return $LA.set=function($Lr){$Lf.call(this,$Lr);var $Li=this.getContext("2d");$Li&&"__reset"in $Li&&$Li.__reset()},Object.defineProperty($Lr,$Li,$LA),!0},$LG.replaceGetSet=function($Lr,$Li){var $Lt=Object.getOwnPropertyDescriptor($Lr,$Li);if(!$Lt||!$Lt.configurable)return!1;var $L_,$LA={};for($L_ in $Lt)"set"!=$L_&&($LA[$L_]=$Lt[$L_]);var $Lf=$Lt.set,$LE="___"+$Li+"__";return $LG.newKeys.push($LE),$LA.set=function($Lr){$Lr!=this[$LE]&&(this[$LE]=$Lr,$Lf.call(this,$Lr))},Object.defineProperty($Lr,$Li,$LA),!0},$LG._default=new $LG,$LG.newKeys=[],$LN($LG,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),$LG}(),$LP=function(){function $Lf($Lr){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++$Lf._uniqueIDCounter,this._name=$Lr||"Content Manager",$Lf._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,$Lf._resourceManagers.push(this),this._resources=[],this._records={}}$Lg($Lf,"laya.resource.ResourceManager");var $Lr=$Lf.prototype;return $Lw.imps($Lr,{"laya.resource.IDispose":!0}),$Lr.getResourceByIndex=function($Lr){return this._resources[$Lr]},$Lr.getResourcesLength=function(){return this._resources.length},$Lr.addResource=function($Lr){return $Lr.resourceManager&&$Lr.resourceManager.removeResource($Lr),-1===this._resources.indexOf($Lr)&&(($Lr._resourceManager=this)._resources.push($Lr),this.addRecord($Lr.uri,$Lr.__className,$Lr.memorySize),this.addSize($Lr.memorySize),!0)},$Lr.removeResource=function($Lr){var $Li=this._resources.indexOf($Lr);return-1!==$Li&&(this._resources.splice($Li,1),$Lr._resourceManager=null,this._memorySize-=$Lr.memorySize,this.addRecord($Lr.uri,$Lr.__className,-$Lr.memorySize),!0)},$Lr.unload=function(){for(var $Lr=this._resources.slice(0,this._resources.length),$Li=0;$Li<$Lr.length;$Li++){$Lr[$Li].destroy()}$Lr.length=0},$Lr.dispose=function(){if(this===$Lf._systemResourceManager)throw new Error("systemResourceManager不能被释放！");$Lf._resourceManagers.splice($Lf._resourceManagers.indexOf(this),1),$Lf._isResourceManagersSorted=!1;for(var $Lr=this._resources.slice(0,this._resources.length),$Li=0;$Li<$Lr.length;$Li++){var $Lt=$Lr[$Li];$Lt.resourceManager.removeResource($Lt),$Lt.destroy()}$Lr.length=0},$Lr.addSize=function($Lr){$Lr&&(this.autoRelease&&0<$Lr&&this._memorySize+$Lr>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=$Lr)},$Lr.addRecord=function($Lr,$Li,$Lt){DEBUG&&$Lt&&!$Lr&&console.error($Lr,$Li,$Lt)},$Lr.garbageCollection=function($Lr){var $Li=this._resources;($Li=$Li.slice()).sort(function($Lr,$Li){if(!$Lr||!$Li)throw new Error("a或b不能为空！");return $Lr.released&&$Li.released?0:$Lr.released?1:$Li.released?-1:$Lr._lastUseFrameCount-$Li._lastUseFrameCount});for(var $Lt=$LZ.loopCount,$L_=0,$LA=$Li.length;$L_<$LA;$L_++){var $Lf=$Li[$L_];if(!(1<$Lt-$Lf._lastUseFrameCount))return void(this._memorySize>=$Lr&&(this._isOverflow=!0));if($Lf.releaseResource(),this._memorySize<$Lr)return void(this._isOverflow=!1)}},$LO(0,$Lr,"id",function(){return this._id}),$LO(0,$Lr,"name",function(){return this._name},function($Lr){!$Lr&&""===$Lr||this._name===$Lr||(this._name=$Lr,$Lf._isResourceManagersSorted=!1)}),$LO(0,$Lr,"memorySize",function(){return this._memorySize}),$LO(0,$Lr,"records",function(){return this._records}),$LO(1,$Lf,"systemResourceManager",function(){return $Lf._systemResourceManager}),$Lf.__init__=function(){$Lf.currentResourceManager=$Lf.systemResourceManager},$Lf.getLoadedResourceManagerByIndex=function($Lr){return $Lf._resourceManagers[$Lr]},$Lf.getLoadedResourceManagersCount=function(){return $Lf._resourceManagers.length},$Lf.recreateContentManagers=function($Lr){void 0===$Lr&&($Lr=!1);for(var $Li=$Lf.currentResourceManager,$Lt=0;$Lt<$Lf._resourceManagers.length;$Lt++){$Lf.currentResourceManager=$Lf._resourceManagers[$Lt];for(var $L_=0;$L_<$Lf.currentResourceManager._resources.length;$L_++)$Lf.currentResourceManager._resources[$L_].releaseResource($Lr),$Lf.currentResourceManager._resources[$L_].activeResource($Lr)}$Lf.currentResourceManager=$Li},$Lf.releaseContentManagers=function($Lr){void 0===$Lr&&($Lr=!1);for(var $Li=$Lf.currentResourceManager,$Lt=0;$Lt<$Lf._resourceManagers.length;$Lt++){$Lf.currentResourceManager=$Lf._resourceManagers[$Lt];for(var $L_=0;$L_<$Lf.currentResourceManager._resources.length;$L_++){var $LA=$Lf.currentResourceManager._resources[$L_];!$LA.released&&$LA.releaseResource($Lr)}}$Lf.currentResourceManager=$Li},$Lf._uniqueIDCounter=0,$Lf._isResourceManagersSorted=!1,$Lf._resourceManagers=[],$LN($Lf,["_systemResourceManager",function(){return this._systemResourceManager=new $Lf("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=$Lf._systemResourceManager}]),$Lf}(),$Lq=(function(){function $Lr(){}$Lg($Lr,"laya.system.System"),$Lr.changeDefinition=function($Lr,$Li){$Lw[$Lr]=$Li;var $Lt=$Lr+"=classObj";$Lw._runScript($Lt)},$Lr.__init__=function(){$LF.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function $Lt(){}return $Lg($Lt,"laya.utils.Browser"),$LO(1,$Lt,"pixelRatio",function(){return $Lt.__init__(),-1<$Lt.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:$Lk.getPixelRatio()}),$LO(1,$Lt,"height",function(){return $Lt.__init__(),($Lw.stage&&$Lw.stage.canvasRotation?$Lt.clientWidth:$Lt.clientHeight)*$Lt.pixelRatio}),$LO(1,$Lt,"clientWidth",function(){return $Lt.__init__(),$Lt.window.innerWidth||$Lt.document.body.clientWidth}),$LO(1,$Lt,"window",function(){return $Lt.__init__(),$Lt._window}),$LO(1,$Lt,"clientHeight",function(){return $Lt.__init__(),$Lt.window.innerHeight||$Lt.document.body.clientHeight||$Lt.document.documentElement.clientHeight}),$LO(1,$Lt,"width",function(){return $Lt.__init__(),($Lw.stage&&$Lw.stage.canvasRotation?$Lt.clientHeight:$Lt.clientWidth)*$Lt.pixelRatio}),$LO(1,$Lt,"container",function(){return $Lt.__init__(),$Lt._container||(($Lt._container=$Lt.createElement("div")).id="layaContainer",$Lt.document.body.appendChild($Lt._container)),$Lt._container},function($Lr){$Lt._container=$Lr}),$LO(1,$Lt,"document",function(){return $Lt.__init__(),$Lt._document}),$Lt.__init__=function(){if(!$Lt._window){$Lt._window=$Lk.getWindow(),$Lt._document=$Lt.window.document,$Lt._window.addEventListener("message",function($Lr){laya.utils.Browser._onMessage($Lr)},!1),$Lt.document.__createElement=$Lt.document.createElement,$LE.requestAnimationFrame=$LE.requestAnimationFrame||$LE.webkitRequestAnimationFrame||$LE.mozRequestAnimationFrame||$LE.oRequestAnimationFrame||$LE.msRequestAnimationFrame||function($Lr){return $LE.setTimeout($Lr,1e3/60)};var $Lr=$LE.document.body.style;$Lr["-webkit-user-select"]="none",$Lr["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",$Lt.userAgent=$Lt.window.navigator.userAgent,$Lt.onIOS=!!($Lt.u=$Lt.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),$Lt.onMobile=-1<$Lt.u.indexOf("Mobile"),$Lt.onIPhone=-1<$Lt.u.indexOf("iPhone"),$Lt.onMac=-1<$Lt.u.indexOf("Mac OS X"),$Lt.onIPad=-1<$Lt.u.indexOf("iPad"),$Lt.onAndroid=-1<$Lt.u.indexOf("Android")||-1<$Lt.u.indexOf("Adr"),$Lt.onWP=-1<$Lt.u.indexOf("Windows Phone"),$Lt.onQQBrowser=-1<$Lt.u.indexOf("QQBrowser"),$Lt.onMQQBrowser=-1<$Lt.u.indexOf("MQQBrowser")||-1<$Lt.u.indexOf("Mobile")&&-1<$Lt.u.indexOf("QQ"),$Lt.onIE=!!$Lt.window.ActiveXObject||"ActiveXObject"in $Lt.window,$Lt.onWeiXin=-1<$Lt.u.indexOf("MicroMessenger"),$Lt.onPC=!$Lt.onMobile,$Lt.onSafari=-1<$Lt.u.indexOf("Safari"),$Lt.onFirefox=-1<$Lt.u.indexOf("Firefox"),$Lt.onEdge=-1<$Lt.u.indexOf("Edge"),$Lt.onMiniGame=-1<$Lt.u.indexOf("MiniGame"),$Lt.onLimixiu=-1<$Lt.u.indexOf("limixiu"),$Lt.httpProtocol="http:"==$Lt.window.location.protocol,$Lt.onMiniGame&&null==$Lt.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),$Lt.webAudioEnabled=!!($Lt.window.AudioContext||$Lt.window.webkitAudioContext||$Lt.window.mozAudioContext),$Lt.soundType=$Lt.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",$LAr=$Lt.webAudioEnabled?$Lfr:$Ltr,$Lt.webAudioEnabled&&$Lfr.initWebAudio(),$Ltr._initMusicAudio(),$Lt.enableTouch="ontouchstart"in $LE||$LE.DocumentTouch&&$Li instanceof DocumentTouch,$LE.focus(),$LU._soundClass=$LAr,$LU._musicClass=$Ltr,$LF._mainCanvas=$LF._mainCanvas||$Lnr.create("2D"),$Lt.canvas||($Lt.canvas=$Lnr.create("2D"),$Lt.context=$Lt.canvas.getContext("2d"))}},$Lt._onMessage=function($Lr){if($Lr.data&&"size"==$Lr.data.name){if($Lt.window.innerWidth=$Lr.data.width,$Lt.window.innerHeight=$Lr.data.height,$Lt.window.__innerHeight=$Lr.data.clientHeight,!$Lt.document.createEvent)return void console.warn("no document.createEvent");var $Li=$Lt.document.createEvent("HTMLEvents");return $Li.initEvent("resize",!1,!1),void $Lt.window.dispatchEvent($Li)}},$Lt.createElement=function($Lr){return $Lt.__init__(),$Lt.document.__createElement($Lr)},$Lt.getElementById=function($Lr){return $Lt.__init__(),$Lt.document.getElementById($Lr)},$Lt.removeElement=function($Lr){$Lr&&$Lr.parentNode&&$Lr.parentNode.removeChild($Lr)},$Lt.now=function(){return $Lk.now()},$Lt._window=null,$Lt._document=null,$Lt._container=null,$Lt.userAgent=null,$Lt.u=null,$Lt.onIOS=!1,$Lt.onMac=!1,$Lt.onMobile=!1,$Lt.onIPhone=!1,$Lt.onIPad=!1,$Lt.onAndroid=!1,$Lt.onWP=!1,$Lt.onQQBrowser=!1,$Lt.onMQQBrowser=!1,$Lt.onSafari=!1,$Lt.onFirefox=!1,$Lt.onEdge=!1,$Lt.onIE=!1,$Lt.onWeiXin=!1,$Lt.onMiniGame=!1,$Lt.onLimixiu=!1,$Lt.onPC=!1,$Lt.httpProtocol=!1,$Lt.webAudioEnabled=!1,$Lt.soundType=null,$Lt.enableTouch=!1,$Lt.canvas=null,$Lt.context=null,$Lt.__init$=function(){},$Lt}()),$Lm=function(){function $Li($Lr){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,$Lr?(this._u8d_=new Uint8Array($Lr),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}$Lg($Li,"laya.utils.Byte");var $Lr=$Li.prototype;return $Lr.___resizeBuffer=function($Li){try{var $Lr=new Uint8Array($Li);null!=this._u8d_&&(this._u8d_.length<=$Li?$Lr.set(this._u8d_):$Lr.set(this._u8d_.subarray(0,$Li))),this._u8d_=$Lr,this._d_=new DataView($Lr.buffer)}catch($Lr){throw"___resizeBuffer err:"+$Li}},$Lr.getString=function(){return this.rUTF(this.getUint16())},$Lr.getFloat32Array=function($Lr,$Li){var $Lt=$Lr+$Li;$Lt=$Lt>this._length?this._length:$Lt;var $L_=new Float32Array(this._d_.buffer.slice($Lr,$Lt));return this._pos_=$Lt,$L_},$Lr.getUint8Array=function($Lr,$Li){var $Lt=$Lr+$Li;$Lt=$Lt>this._length?this._length:$Lt;var $L_=new Uint8Array(this._d_.buffer.slice($Lr,$Lt));return this._pos_=$Lt,$L_},$Lr.getInt16Array=function($Lr,$Li){var $Lt=$Lr+$Li;$Lt=$Lt>this._length?this._length:$Lt;var $L_=new Int16Array(this._d_.buffer.slice($Lr,$Lt));return this._pos_=$Lt,$L_},$Lr.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var $Lr=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,$Lr},$Lr.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var $Lr=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,$Lr},$Lr.writeFloat32=function($Lr){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,$Lr,this._xd_),this._pos_+=4},$Lr.writeFloat64=function($Lr){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,$Lr,this._xd_),this._pos_+=8},$Lr.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var $Lr=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,$Lr},$Lr.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var $Lr=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,$Lr},$Lr.writeInt32=function($Lr){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,$Lr,this._xd_),this._pos_+=4},$Lr.writeUint32=function($Lr){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,$Lr,this._xd_),this._pos_+=4},$Lr.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var $Lr=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,$Lr},$Lr.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var $Lr=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,$Lr},$Lr.writeUint16=function($Lr){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,$Lr,this._xd_),this._pos_+=2},$Lr.writeInt16=function($Lr){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,$Lr,this._xd_),this._pos_+=2},$Lr.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},$Lr.writeUint8=function($Lr){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,$Lr),this._pos_++},$Lr._getUInt8=function($Lr){return this._d_.getUint8($Lr)},$Lr._getUint16=function($Lr){return this._d_.getUint16($Lr,this._xd_)},$Lr._getMatrix=function(){return new $Le(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},$Lr.rUTF=function($Lr){for(var $Li=[],$Lt=this._pos_+$Lr,$L_=0,$LA=0,$Lf=0,$LE=String.fromCharCode,$LG=this._u8d_;this._pos_<$Lt;)($L_=$LG[this._pos_++])<128?0!=$L_&&$Li.push($LE($L_)):$L_<224?$Li.push($LE((63&$L_)<<6|127&$LG[this._pos_++])):$L_<240?($LA=$LG[this._pos_++],$Li.push($LE((31&$L_)<<12|(127&$LA)<<6|127&$LG[this._pos_++]))):($LA=$LG[this._pos_++],$Lf=$LG[this._pos_++],$Li.push($LE((15&$L_)<<18|(127&$LA)<<12|$Lf<<6&127|127&$LG[this._pos_++]))),0;return $Li.join("")},$Lr.getCustomString=function($Lr){for(var $Li=[],$Lt=0,$L_=0,$LA=0,$Lf=String.fromCharCode,$LE=this._u8d_;0<$Lr;)if(($L_=$LE[this._pos_])<128)$Li.push($Lf($L_)),this._pos_++,$Lr--;else for($Lt=$L_-128,this._pos_++,$Lr-=$Lt;0<$Lt;)$L_=$LE[this._pos_++],$LA=$LE[this._pos_++],$Li.push($Lf($LA<<8|$L_)),$Lt--;return $Li.join("")},$Lr.clear=function(){this._pos_=0,this.length=0},$Lr.__getBuffer=function(){return this._d_.buffer},$Lr.writeUTFBytes=function($Lr){for(var $Li=0,$Lt=($Lr+="").length;$Li<$Lt;$Li++){var $L_=$Lr.charCodeAt($Li);$L_<=127?this.writeByte($L_):$L_<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|$L_>>6,128|63&$L_],this._pos_),this._pos_+=2):$L_<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|$L_>>12,128|$L_>>6&63,128|63&$L_],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|$L_>>18,128|$L_>>12&63,128|$L_>>6&63,128|63&$L_],this._pos_),this._pos_+=4)}},$Lr.writeUTFString=function($Lr){var $Li=this.pos;this.writeUint16(1),this.writeUTFBytes($Lr);var $Lt=this.pos-$Li-2;if(65536<=$Lt)throw"writeUTFString byte len more than 65536";this._d_.setUint16($Li,$Lt,this._xd_)},$Lr.readUTFString=function(){return this.readUTFBytes(this.getUint16())},$Lr.getUTFString=function(){return this.readUTFString()},$Lr.readUTFBytes=function($Lr){if(void 0===$Lr&&($Lr=-1),0==$Lr)return"";var $Li=this.bytesAvailable;if($Li<$Lr)throw"readUTFBytes error - Out of bounds";return $Lr=0<$Lr?$Lr:$Li,this.rUTF($Lr)},$Lr.getUTFBytes=function($Lr){return void 0===$Lr&&($Lr=-1),this.readUTFBytes($Lr)},$Lr.writeByte=function($Lr){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,$Lr),this._pos_+=1},$Lr.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},$Lr.getByte=function(){return this.readByte()},$Lr.ensureWrite=function($Lr){this._length<$Lr&&(this._length=$Lr),this._allocated_<$Lr&&(this.length=$Lr)},$Lr.writeArrayBuffer=function($Lr,$Li,$Lt){if(void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),$Li<0||$Lt<0)throw"writeArrayBuffer error - Out of bounds";0==$Lt&&($Lt=$Lr.byteLength-$Li),this.ensureWrite(this._pos_+$Lt);var $L_=new Uint8Array($Lr);this._u8d_.set($L_.subarray($Li,$Li+$Lt),this._pos_),this._pos_+=$Lt},$LO(0,$Lr,"buffer",function(){var $Lr=this._d_.buffer;return $Lr.byteLength==this.length?$Lr:$Lr.slice(0,this.length)}),$LO(0,$Lr,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function($Lr){this._xd_="littleEndian"==$Lr}),$LO(0,$Lr,"length",function(){return this._length},function($Lr){this._allocated_<$Lr?this.___resizeBuffer(this._allocated_=Math.floor(Math.max($Lr,2*this._allocated_))):this._allocated_>$Lr&&this.___resizeBuffer(this._allocated_=$Lr),this._length=$Lr}),$LO(0,$Lr,"pos",function(){return this._pos_},function($Lr){this._pos_=$Lr}),$LO(0,$Lr,"bytesAvailable",function(){return this._length-this._pos_}),$Li.getSystemEndian=function(){if(!$Li._sysEndian){var $Lr=new ArrayBuffer(2);new DataView($Lr).setInt16(0,256,!0),$Li._sysEndian=256===new Int16Array($Lr)[0]?"littleEndian":"bigEndian"}return $Li._sysEndian},$Li.BIG_ENDIAN="bigEndian",$Li.LITTLE_ENDIAN="littleEndian",$Li._sysEndian=null,$Li}(),$LT=function(){function $LA(){}return $Lg($LA,"laya.utils.CacheManager"),$LA.regCacheByFunction=function($Lr,$Li){var $Lt;$LA.unRegCacheByFunction($Lr,$Li),$Lt={tryDispose:$Lr,getCacheList:$Li},$LA._cacheList.push($Lt)},$LA.unRegCacheByFunction=function($Lr,$Li){var $Lt,$L_=0;for($Lt=$LA._cacheList.length,$L_=0;$L_<$Lt;$L_++)if($LA._cacheList[$L_].tryDispose==$Lr&&$LA._cacheList[$L_].getCacheList==$Li)return void $LA._cacheList.splice($L_,1)},$LA.forceDispose=function(){var $Lr=0,$Li=$LA._cacheList.length;for($Lr=0;$Lr<$Li;$Lr++)$LA._cacheList[$Lr].tryDispose(!0)},$LA.beginCheck=function($Lr){void 0===$Lr&&($Lr=15e3),$Lw.timer.loop($Lr,null,$LA._checkLoop)},$LA.stopCheck=function(){$Lw.timer.clear(null,$LA._checkLoop)},$LA._checkLoop=function(){var $Lr=$LA._cacheList;if(!($Lr.length<1)){var $Li,$Lt=$Lq.now(),$L_=0;for($Li=$L_=$Lr.length;0<$L_&&($Lr[$LA._index=++$LA._index%$Li].tryDispose(!1),!($Lq.now()-$Lt>$LA.loopTimeLimit));)$L_--}},$LA.loopTimeLimit=2,$LA._cacheList=[],$LA._index=0,$LA}(),$Lx=function(){function $Lv(){}return $Lg($Lv,"laya.utils.ClassUtils"),$Lv.regClass=function($Lr,$Li){$Lv._classMap[$Lr]=$Li},$Lv.getRegClass=function($Lr){return $Lv._classMap[$Lr]},$Lv.getInstance=function($Lr){var $Li=$Lv.getClass($Lr);return $Li?new $Li:(console.warn("[error] Undefined class:",$Lr),null)},$Lv.createByJson=function($Lr,$Li,$Lt,$L_,$LA){"string"==typeof $Lr&&($Lr=JSON.parse($Lr));var $Lf=$Lr.props;if(!$Li&&!($Li=$LA?$LA.runWith($Lr):$Lv.getInstance($Lf.runtime||$Lr.type)))return null;var $LE=$Lr.child;if($LE)for(var $LG=0,$LN=$LE.length;$LG<$LN;$LG++){var $Lp=$LE[$LG];if("render"!==$Lp.props.name&&"render"!==$Lp.props.renderType||!$Li._$set_itemRender)if("Graphic"==$Lp.type)$Lv.addGraphicsToSprite($Lp,$Li);else if($Lv.isDrawType($Lp.type))$Lv.addGraphicToSprite($Lp,$Li,!0);else{var $Lg=$Lv.createByJson($Lp,null,$Lt,$L_,$LA);"Script"==$Lp.type?$Lg.hasOwnProperty("owner")?$Lg.owner=$Li:$Lg.hasOwnProperty("target")&&($Lg.target=$Li):"mask"==$Lp.props.renderType?$Li.mask=$Lg:$Li.addChild($Lg)}else $Li.itemRender=$Lp}if($Lf)for(var $LR in $Lf){var $LX=$Lf[$LR];"var"===$LR&&$Lt?$Lt[$LX]=$Li:$LX instanceof Array&&"function"==typeof $Li[$LR]?$Li[$LR].apply($Li,$LX):$Li[$LR]=$LX}return $L_&&$Lr.customProps&&$L_.runWith([$Li,$Lr]),$Li.created&&$Li.created(),$Li},$Lv.addGraphicsToSprite=function($Lr,$Li){var $Lt;if(($Lt=$Lr.child)&&!($Lt.length<1)){var $L_;$L_=$Lv._getGraphicsFromSprite($Lr,$Li);var $LA=0,$Lf=0;$Lr.props&&($LA=$Lv._getObjVar($Lr.props,"x",0),$Lf=$Lv._getObjVar($Lr.props,"y",0)),0!=$LA&&0!=$Lf&&$L_.translate($LA,$Lf);var $LE,$LG=0;for($LE=$Lt.length,$LG=0;$LG<$LE;$LG++)$Lv._addGraphicToGraphics($Lt[$LG],$L_);0!=$LA&&0!=$Lf&&$L_.translate(-$LA,-$Lf)}},$Lv.addGraphicToSprite=function($Lr,$Li,$Lt){var $L_;void 0===$Lt&&($Lt=!1),$L_=$Lt?$Lv._getGraphicsFromSprite($Lr,$Li):$Li.graphics,$Lv._addGraphicToGraphics($Lr,$L_)},$Lv._getGraphicsFromSprite=function($Lr,$Li){var $Lt,$L_;if(!$Lr||!$Lr.props)return $Li.graphics;switch($L_=$Lr.props.renderType){case"hit":case"unHit":var $LA;$Li.hitArea||($Li.hitArea=new $Lz),($LA=$Li.hitArea)[$L_]||($LA[$L_]=new $LX),$Lt=$LA[$L_]}return $Lt||($Lt=$Li.graphics),$Lt},$Lv._getTransformData=function($Lr){var $Li;($Lr.hasOwnProperty("pivotX")||$Lr.hasOwnProperty("pivotY"))&&($Li=$Li||new $Le).translate(-$Lv._getObjVar($Lr,"pivotX",0),-$Lv._getObjVar($Lr,"pivotY",0));var $Lt=$Lv._getObjVar($Lr,"scaleX",1),$L_=$Lv._getObjVar($Lr,"scaleY",1),$LA=$Lv._getObjVar($Lr,"rotation",0);$Lv._getObjVar($Lr,"skewX",0),$Lv._getObjVar($Lr,"skewY",0);return 1==$Lt&&1==$L_&&0==$LA||(($Li=$Li||new $Le).scale($Lt,$L_),$Li.rotate(.0174532922222222*$LA)),$Li},$Lv._addGraphicToGraphics=function($Lr,$Li){var $Lt,$L_;if(($Lt=$Lr.props)&&($L_=$Lv.DrawTypeDic[$Lr.type])){var $LA,$Lf;$LA=$Li;var $LE=$Lv._getParams($Lt,$L_[1],$L_[2],$L_[3]);(($Lf=$Lv._tM)||1!=$Lv._alpha)&&($LA.save(),$Lf&&$LA.transform($Lf),1!=$Lv._alpha&&$LA.alpha($Lv._alpha)),$LA[$L_[0]].apply($LA,$LE),($Lf||1!=$Lv._alpha)&&$LA.restore()}},$Lv._adptLineData=function($Lr){return $Lr[2]=parseFloat($Lr[0])+parseFloat($Lr[2]),$Lr[3]=parseFloat($Lr[1])+parseFloat($Lr[3]),$Lr},$Lv._adptTextureData=function($Lr){return $Lr[0]=$LGr.getRes($Lr[0]),$Lr},$Lv._adptLinesData=function($Lr){return $Lr[2]=$Lv._getPointListByStr($Lr[2]),$Lr},$Lv.isDrawType=function($Lr){return"Image"!=$Lr&&$Lv.DrawTypeDic.hasOwnProperty($Lr)},$Lv._getParams=function($Lr,$Li,$Lt,$L_){var $LA;void 0===$Lt&&($Lt=0),($LA=$Lv._temParam).length=$Li.length;var $Lf,$LE,$LG=0;for($Lf=$Li.length,$LG=0;$LG<$Lf;$LG++)$LA[$LG]=$Lv._getObjVar($Lr,$Li[$LG][0],$Li[$LG][1]);return $Lv._alpha=$Lv._getObjVar($Lr,"alpha",1),$LE=$Lv._getTransformData($Lr),$Lv._tM=$LE?($Lt||($Lt=0),$LE.translate($LA[$Lt],$LA[$Lt+1]),$LA[$Lt]=$LA[$Lt+1]=0,$LE):null,$L_&&$Lv[$L_]&&($LA=$Lv[$L_]($LA)),$LA},$Lv._getPointListByStr=function($Lr){var $Li,$Lt,$L_=0;for($Lt=($Li=$Lr.split(",")).length,$L_=0;$L_<$Lt;$L_++)$Li[$L_]=parseFloat($Li[$L_]);return $Li},$Lv._getObjVar=function($Lr,$Li,$Lt){return $Lr.hasOwnProperty($Li)?$Lr[$Li]:$Lt},$Lv._temParam=[],$Lv._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},$Lv.getClass=function($Lr){var $Li=$Lv._classMap[$Lr]||$Lr;return"string"==typeof $Li?$Lw.__classmap[$Li]:$Li},$Lv._tM=null,$Lv._alpha=NaN,$LN($Lv,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),$Lv}(),$L$=function(){function $Lf($Lr){if(this._color=[],"string"==typeof $Lr){null===(this.strColor=$Lr)&&($Lr="#000000"),"#"==$Lr.charAt(0)&&($Lr=$Lr.substr(1));var $Li=$Lr.length;if(3==$Li||4==$Li){for(var $Lt="",$L_=0;$L_<$Li;$L_++)$Lt+=$Lr[$L_]+$Lr[$L_];$Lr=$Lt}var $LA=this.numColor=parseInt($Lr,16);if(8==$Lr.length)return void(this._color=[parseInt($Lr.substr(0,2),16)/255,((16711680&$LA)>>16)/255,((65280&$LA)>>8)/255,(255&$LA)/255])}else $LA=this.numColor=$Lr,this.strColor=$LK.toHexColor($LA);this._color=[((16711680&$LA)>>16)/255,((65280&$LA)>>8)/255,(255&$LA)/255,1],this._color.__id=++$Lf._COLODID}return $Lg($Lf,"laya.utils.Color"),$Lf._initDefault=function(){for(var $Lr in $Lf._DEFAULT={},$Lf._COLOR_MAP)$Lf._SAVE[$Lr]=$Lf._DEFAULT[$Lr]=new $Lf($Lf._COLOR_MAP[$Lr]);return $Lf._DEFAULT},$Lf._initSaveMap=function(){for(var $Lr in $Lf._SAVE_SIZE=0,$Lf._SAVE={},$Lf._DEFAULT)$Lf._SAVE[$Lr]=$Lf._DEFAULT[$Lr]},$Lf.create=function($Lr){var $Li=$Lf._SAVE[$Lr+""];return null!=$Li?$Li:($Lf._SAVE_SIZE<1e3||$Lf._initSaveMap(),$Lf._SAVE[$Lr+""]=new $Lf($Lr))},$Lf._SAVE={},$Lf._SAVE_SIZE=0,$Lf._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},$Lf._DEFAULT=$Lf._initDefault(),$Lf._COLODID=1,$Lf}(),$Lo=(function(){function $Lr(){this._values=[],this._keys=[]}$Lg($Lr,"laya.utils.Dictionary");var $Li=$Lr.prototype;$Li.set=function($Lr,$Li){var $Lt=this.indexOf($Lr);0<=$Lt?this._values[$Lt]=$Li:(this._keys.push($Lr),this._values.push($Li))},$Li.indexOf=function($Lr){var $Li=this._keys.indexOf($Lr);return 0<=$Li?$Li:($Lr="string"==typeof $Lr?Number($Lr):"number"==typeof $Lr?$Lr.toString():$Lr,this._keys.indexOf($Lr))},$Li.get=function($Lr){var $Li=this.indexOf($Lr);return $Li<0?null:this._values[$Li]},$Li.remove=function($Lr){var $Li=this.indexOf($Lr);return 0<=$Li&&(this._keys.splice($Li,1),this._values.splice($Li,1),!0)},$Li.clear=function(){this._values.length=0,this._keys.length=0},$LO(0,$Li,"values",function(){return this._values}),$LO(0,$Li,"keys",function(){return this._keys})}(),function(){function $Lr(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}$Lg($Lr,"laya.utils.Dragging");var $Li=$Lr.prototype;return $Li.start=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){void 0===$LG&&($LG=.92),this.clearTimer(),this.target=$Lr,this.area=$Li,this.hasInertia=$Lt,this.elasticDistance=$Li?$L_:0,this.elasticBackTime=$LA,this.data=$Lf,this._disableMouseEvent=$LE,this.ratio=$LG,1!=$Lr.globalScaleX||1!=$Lr.globalScaleY?this._parent=$Lr.parent:this._parent=$Lw.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,$Lw.stage.on("mouseup",this,this.onStageMouseUp),$Lw.stage.on("mouseout",this,this.onStageMouseUp),$Lw.timer.frameLoop(1,this,this.loop)},$Li.clearTimer=function(){$Lw.timer.clear(this,this.loop),$Lw.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},$Li.stop=function(){this._dragging&&($Lc.instance.disableMouseEvent=!1,$Lw.stage.off("mouseup",this,this.onStageMouseUp),$Lw.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},$Li.loop=function(){var $Lr=this._parent.getMousePoint(),$Li=$Lr.x,$Lt=$Lr.y,$L_=$Li-this._lastX,$LA=$Lt-this._lastY;if(this._clickOnly){if(!(1<Math.abs($L_*$Lw.stage._canvasTransform.getScaleX())||1<Math.abs($LA*$Lw.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),$Lc.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push($L_,$LA);0==$L_&&0==$LA||(this._lastX=$Li,this._lastY=$Lt,this.target.x+=$L_*this._elasticRateX,this.target.y+=$LA*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},$Li.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var $Lr=this.area.x-this.target.x;else $Lr=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-$Lr/this.elasticDistance),this.target.y<this.area.y)var $Li=this.area.y-this.target.y;else $Li=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-$Li/this.elasticDistance)}},$Li.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},$Li.onStageMouseUp=function($Lr){if($Lc.instance.disableMouseEvent=!1,$Lw.stage.off("mouseup",this,this.onStageMouseUp),$Lw.stage.off("mouseout",this,this.onStageMouseUp),$Lw.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var $Li=this._offsets.length,$Lt=Math.min($Li,6),$L_=this._offsets.length-$Lt,$LA=$Li-1;$L_<$LA;$LA--)this._offsetY+=this._offsets[$LA--],this._offsetX+=this._offsets[$LA];this._offsetX=this._offsetX/$Lt*2,this._offsetY=this._offsetY/$Lt*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),$Lw.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},$Li.checkElastic=function(){var $Lr=NaN,$Li=NaN;if(this.target.x<this.area.x?$Lr=this.area.x:this.target.x>this.area.x+this.area.width&&($Lr=this.area.x+this.area.width),this.target.y<this.area.y?$Li=this.area.y:this.target.y>this.area.y+this.area.height&&($Li=this.area.y+this.area.height),isNaN($Lr)&&isNaN($Li))this.clear();else{var $Lt={};isNaN($Lr)||($Lt.x=$Lr),isNaN($Li)||($Lt.y=$Li),this._tween=$LM.to(this.target,$Lt,this.elasticBackTime,$LI.sineOut,$LC.create(this,this.clear),0,!1,!1)}},$Li.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&($Lw.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},$Li.clear=function(){if(this.target){this.clearTimer();var $Lr=this.target;this.target=null,this._parent=null,$Lr.event("dragend",this.data)}},$Lr}()),$LI=function(){function $LG(){}return $Lg($LG,"laya.utils.Ease"),$LG.linearNone=function($Lr,$Li,$Lt,$L_){return $Lt*$Lr/$L_+$Li},$LG.linearIn=function($Lr,$Li,$Lt,$L_){return $Lt*$Lr/$L_+$Li},$LG.linearInOut=function($Lr,$Li,$Lt,$L_){return $Lt*$Lr/$L_+$Li},$LG.linearOut=function($Lr,$Li,$Lt,$L_){return $Lt*$Lr/$L_+$Li},$LG.bounceIn=function($Lr,$Li,$Lt,$L_){return $Lt-$LG.bounceOut($L_-$Lr,0,$Lt,$L_)+$Li},$LG.bounceInOut=function($Lr,$Li,$Lt,$L_){return $Lr<.5*$L_?.5*$LG.bounceIn(2*$Lr,0,$Lt,$L_)+$Li:.5*$LG.bounceOut(2*$Lr-$L_,0,$Lt,$L_)+.5*$Lt+$Li},$LG.bounceOut=function($Lr,$Li,$Lt,$L_){return($Lr/=$L_)<1/2.75?$Lt*(7.5625*$Lr*$Lr)+$Li:$Lr<2/2.75?$Lt*(7.5625*($Lr-=1.5/2.75)*$Lr+.75)+$Li:$Lr<2.5/2.75?$Lt*(7.5625*($Lr-=2.25/2.75)*$Lr+.9375)+$Li:$Lt*(7.5625*($Lr-=2.625/2.75)*$Lr+.984375)+$Li},$LG.backIn=function($Lr,$Li,$Lt,$L_,$LA){return void 0===$LA&&($LA=1.70158),$Lt*($Lr/=$L_)*$Lr*(($LA+1)*$Lr-$LA)+$Li},$LG.backInOut=function($Lr,$Li,$Lt,$L_,$LA){return void 0===$LA&&($LA=1.70158),($Lr/=.5*$L_)<1?.5*$Lt*($Lr*$Lr*((1+($LA*=1.525))*$Lr-$LA))+$Li:$Lt/2*(($Lr-=2)*$Lr*((1+($LA*=1.525))*$Lr+$LA)+2)+$Li},$LG.backOut=function($Lr,$Li,$Lt,$L_,$LA){return void 0===$LA&&($LA=1.70158),$Lt*(($Lr=$Lr/$L_-1)*$Lr*(($LA+1)*$Lr+$LA)+1)+$Li},$LG.elasticIn=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE;return void 0===$LA&&($LA=0),void 0===$Lf&&($Lf=0),0==$Lr?$Li:1==($Lr/=$L_)?$Li+$Lt:($Lf||($Lf=.3*$L_),$LE=!$LA||0<$Lt&&$LA<$Lt||$Lt<0&&$LA<-$Lt?($LA=$Lt,$Lf/4):$Lf/$LG.PI2*Math.asin($Lt/$LA),-$LA*Math.pow(2,10*($Lr-=1))*Math.sin(($Lr*$L_-$LE)*$LG.PI2/$Lf)+$Li)},$LG.elasticInOut=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE;return void 0===$LA&&($LA=0),void 0===$Lf&&($Lf=0),0==$Lr?$Li:2==($Lr/=.5*$L_)?$Li+$Lt:($Lf||($Lf=$L_*(.3*1.5)),$LE=!$LA||0<$Lt&&$LA<$Lt||$Lt<0&&$LA<-$Lt?($LA=$Lt,$Lf/4):$Lf/$LG.PI2*Math.asin($Lt/$LA),$Lr<1?$LA*Math.pow(2,10*($Lr-=1))*Math.sin(($Lr*$L_-$LE)*$LG.PI2/$Lf)*-.5+$Li:$LA*Math.pow(2,-10*($Lr-=1))*Math.sin(($Lr*$L_-$LE)*$LG.PI2/$Lf)*.5+$Lt+$Li)},$LG.elasticOut=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE;return void 0===$LA&&($LA=0),void 0===$Lf&&($Lf=0),0==$Lr?$Li:1==($Lr/=$L_)?$Li+$Lt:($Lf||($Lf=.3*$L_),$LE=!$LA||0<$Lt&&$LA<$Lt||$Lt<0&&$LA<-$Lt?($LA=$Lt,$Lf/4):$Lf/$LG.PI2*Math.asin($Lt/$LA),$LA*Math.pow(2,-10*$Lr)*Math.sin(($Lr*$L_-$LE)*$LG.PI2/$Lf)+$Lt+$Li)},$LG.strongIn=function($Lr,$Li,$Lt,$L_){return $Lt*($Lr/=$L_)*$Lr*$Lr*$Lr*$Lr+$Li},$LG.strongInOut=function($Lr,$Li,$Lt,$L_){return($Lr/=.5*$L_)<1?.5*$Lt*$Lr*$Lr*$Lr*$Lr*$Lr+$Li:.5*$Lt*(($Lr-=2)*$Lr*$Lr*$Lr*$Lr+2)+$Li},$LG.strongOut=function($Lr,$Li,$Lt,$L_){return $Lt*(($Lr=$Lr/$L_-1)*$Lr*$Lr*$Lr*$Lr+1)+$Li},$LG.sineInOut=function($Lr,$Li,$Lt,$L_){return.5*-$Lt*(Math.cos(Math.PI*$Lr/$L_)-1)+$Li},$LG.sineIn=function($Lr,$Li,$Lt,$L_){return-$Lt*Math.cos($Lr/$L_*$LG.HALF_PI)+$Lt+$Li},$LG.sineOut=function($Lr,$Li,$Lt,$L_){return $Lt*Math.sin($Lr/$L_*$LG.HALF_PI)+$Li},$LG.quintIn=function($Lr,$Li,$Lt,$L_){return $Lt*($Lr/=$L_)*$Lr*$Lr*$Lr*$Lr+$Li},$LG.quintInOut=function($Lr,$Li,$Lt,$L_){return($Lr/=.5*$L_)<1?.5*$Lt*$Lr*$Lr*$Lr*$Lr*$Lr+$Li:.5*$Lt*(($Lr-=2)*$Lr*$Lr*$Lr*$Lr+2)+$Li},$LG.quintOut=function($Lr,$Li,$Lt,$L_){return $Lt*(($Lr=$Lr/$L_-1)*$Lr*$Lr*$Lr*$Lr+1)+$Li},$LG.quartIn=function($Lr,$Li,$Lt,$L_){return $Lt*($Lr/=$L_)*$Lr*$Lr*$Lr+$Li},$LG.quartInOut=function($Lr,$Li,$Lt,$L_){return($Lr/=.5*$L_)<1?.5*$Lt*$Lr*$Lr*$Lr*$Lr+$Li:.5*-$Lt*(($Lr-=2)*$Lr*$Lr*$Lr-2)+$Li},$LG.quartOut=function($Lr,$Li,$Lt,$L_){return-$Lt*(($Lr=$Lr/$L_-1)*$Lr*$Lr*$Lr-1)+$Li},$LG.cubicIn=function($Lr,$Li,$Lt,$L_){return $Lt*($Lr/=$L_)*$Lr*$Lr+$Li},$LG.cubicInOut=function($Lr,$Li,$Lt,$L_){return($Lr/=.5*$L_)<1?.5*$Lt*$Lr*$Lr*$Lr+$Li:.5*$Lt*(($Lr-=2)*$Lr*$Lr+2)+$Li},$LG.cubicOut=function($Lr,$Li,$Lt,$L_){return $Lt*(($Lr=$Lr/$L_-1)*$Lr*$Lr+1)+$Li},$LG.quadIn=function($Lr,$Li,$Lt,$L_){return $Lt*($Lr/=$L_)*$Lr+$Li},$LG.quadInOut=function($Lr,$Li,$Lt,$L_){return($Lr/=.5*$L_)<1?.5*$Lt*$Lr*$Lr+$Li:.5*-$Lt*(--$Lr*($Lr-2)-1)+$Li},$LG.quadOut=function($Lr,$Li,$Lt,$L_){return-$Lt*($Lr/=$L_)*($Lr-2)+$Li},$LG.expoIn=function($Lr,$Li,$Lt,$L_){return 0==$Lr?$Li:$Lt*Math.pow(2,10*($Lr/$L_-1))+$Li-.001*$Lt},$LG.expoInOut=function($Lr,$Li,$Lt,$L_){return 0==$Lr?$Li:$Lr==$L_?$Li+$Lt:($Lr/=.5*$L_)<1?.5*$Lt*Math.pow(2,10*($Lr-1))+$Li:.5*$Lt*(2-Math.pow(2,-10*--$Lr))+$Li},$LG.expoOut=function($Lr,$Li,$Lt,$L_){return $Lr==$L_?$Li+$Lt:$Lt*(1-Math.pow(2,-10*$Lr/$L_))+$Li},$LG.circIn=function($Lr,$Li,$Lt,$L_){return-$Lt*(Math.sqrt(1-($Lr/=$L_)*$Lr)-1)+$Li},$LG.circInOut=function($Lr,$Li,$Lt,$L_){return($Lr/=.5*$L_)<1?.5*-$Lt*(Math.sqrt(1-$Lr*$Lr)-1)+$Li:.5*$Lt*(Math.sqrt(1-($Lr-=2)*$Lr)+1)+$Li},$LG.circOut=function($Lr,$Li,$Lt,$L_){return $Lt*Math.sqrt(1-($Lr=$Lr/$L_-1)*$Lr)+$Li},$LG.HALF_PI=.5*Math.PI,$LG.PI2=2*Math.PI,$LG}(),$Lz=function(){function $LR(){this._hit=null,this._unHit=null}$Lg($LR,"laya.utils.HitArea");var $Lr=$LR.prototype;return $Lr.isHit=function($Lr,$Li){return!!$LR.isHitGraphic($Lr,$Li,this.hit)&&!$LR.isHitGraphic($Lr,$Li,this.unHit)},$Lr.contains=function($Lr,$Li){return this.isHit($Lr,$Li)},$LO(0,$Lr,"hit",function(){return this._hit||(this._hit=new $LX),this._hit},function($Lr){this._hit=$Lr}),$LO(0,$Lr,"unHit",function(){return this._unHit||(this._unHit=new $LX),this._unHit},function($Lr){this._unHit=$Lr}),$LR.isHitGraphic=function($Lr,$Li,$Lt){if(!$Lt)return!1;var $L_;if(!($L_=$Lt.cmds)&&$Lt._one&&(($L_=$LR._cmds).length=1,$L_[0]=$Lt._one),!$L_)return!1;var $LA,$Lf,$LE=0;for($LA=$L_.length,$LE=0;$LE<$LA;$LE++)if($Lf=$L_[$LE]){var $LG=$LF._context;switch($Lf.callee){case $LG._translate:case 6:$Lr-=$Lf[0],$Li-=$Lf[1]}if($LR.isHitCmd($Lr,$Li,$Lf))return!0}return!1},$LR.isHitCmd=function($Lr,$Li,$Lt){if(!$Lt)return!1;var $L_=$LF._context,$LA=!1;switch($Lt.callee){case $L_._drawRect:case 13:$LR._rec.setTo($Lt[0],$Lt[1],$Lt[2],$Lt[3]),$LA=$LR._rec.contains($Lr,$Li);break;case $L_._drawCircle:case $L_._fillCircle:case 14:$LA=($Lr-=$Lt[0])*$Lr+($Li-=$Lt[1])*$Li<$Lt[2]*$Lt[2];break;case $L_._drawPoly:case 18:$Lr-=$Lt[0],$Li-=$Lt[1],$LA=$LR.ptInPolygon($Lr,$Li,$Lt[2])}return $LA},$LR.ptInPolygon=function($Lr,$Li,$Lt){var $L_;($L_=$LR._ptPoint).setTo($Lr,$Li);var $LA,$Lf=0,$LE=NaN,$LG=NaN,$LN=NaN,$Lp=NaN;$LA=$Lt.length;for(var $Lg=0;$Lg<$LA;$Lg+=2){if($LE=$Lt[$Lg],$LG=$Lt[$Lg+1],$LN=$Lt[($Lg+2)%$LA],$LG!=($Lp=$Lt[($Lg+3)%$LA]))if(!($L_.y<Math.min($LG,$Lp)))if(!($L_.y>=Math.max($LG,$Lp)))($L_.y-$LG)*($LN-$LE)/($Lp-$LG)+$LE>$L_.x&&$Lf++}return $Lf%2==1},$LR._cmds=[],$LN($LR,["_rec",function(){return this._rec=new $Ls},"_ptPoint",function(){return this._ptPoint=new $LH}]),$LR}(),$LJ=(function(){function $LA($Lr,$Li,$Lt,$L_){this.char=$Lr,this.charNum=$Lr.charCodeAt(0),this._x=this._y=0,this.width=$Li,this.height=$Lt,this.style=$L_,this.isWord=!$LA._isWordRegExp.test($Lr)}$Lg($LA,"laya.utils.HTMLChar");var $Lr=$LA.prototype;$Lw.imps($Lr,{"laya.display.ILayout":!0}),$Lr.setSprite=function($Lr){this._sprite=$Lr},$Lr.getSprite=function(){return this._sprite},$Lr._isChar=function(){return!0},$Lr._getCSSStyle=function(){return this.style},$LO(0,$Lr,"width",function(){return this._w},function($Lr){this._w=$Lr}),$LO(0,$Lr,"x",function(){return this._x},function($Lr){this._sprite&&(this._sprite.x=$Lr),this._x=$Lr}),$LO(0,$Lr,"y",function(){return this._y},function($Lr){this._sprite&&(this._sprite.y=$Lr),this._y=$Lr}),$LO(0,$Lr,"height",function(){return this._h},function($Lr){this._h=$Lr}),$LA._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function $Li(){}$Lg($Li,"laya.utils.Log"),$Li.enable=function(){$Li._logdiv||($Li._logdiv=$Lq.window.document.createElement("div"),$Lq.window.document.body.appendChild($Li._logdiv),$Li._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},$Li.toggle=function(){var $Lr=$Li._logdiv.style;"1px"==$Lr.width?$Lr.width=$Lr.height="50%":$Lr.width=$Lr.height="1px"},$Li.print=function($Lr){$Li._logdiv&&($Li.maxCount<=$Li._count&&$Li.clear(),$Li._count++,$Li._logdiv.innerText+=$Lr+"\n",$Li._logdiv.scrollTop=$Li._logdiv.scrollHeight)},$Li.clear=function(){$Li._logdiv.innerText="",$Li._count=0},$Li._logdiv=null,$Li._count=0,$Li.maxCount=20}(),function(){function $Li(){}$Lg($Li,"laya.utils.Mouse"),$LO(1,$Li,"cursor",function(){return $Li._style.cursor},function($Lr){$Li._style.cursor=$Lr}),$Li.hide=function(){"none"!=$Li.cursor&&($Li._preCursor=$Li.cursor,$Li.cursor="none")},$Li.show=function(){"none"==$Li.cursor&&($Li.cursor=$Li._preCursor?$Li._preCursor:"auto")},$Li._preCursor=null,$LN($Li,["_style",function(){return this._style=$Lq.document.body.style}])}(),function(){function $Lf(){}return $Lg($Lf,"laya.utils.Pool"),$Lf.getPoolBySign=function($Lr){return $Lf._poolDic[$Lr]||($Lf._poolDic[$Lr]=[])},$Lf.clearBySign=function($Lr){$Lf._poolDic[$Lr]&&($Lf._poolDic[$Lr].length=0)},$Lf.recover=function($Lr,$Li){$Li.__InPool||($Li.__InPool=!0,$Lf.getPoolBySign($Lr).push($Li))},$Lf.getItemByClass=function($Lr,$Li){var $Lt=$Lf.getPoolBySign($Lr),$L_=$Lt.length?$Lt.pop():new $Li;return $L_.__InPool=!1,$L_},$Lf.getItemByCreateFun=function($Lr,$Li,$Lt){var $L_=$Lf.getPoolBySign($Lr),$LA=$L_.length?$L_.pop():$Li.call($Lt);return $LA.__InPool=!1,$LA},$Lf.getItem=function($Lr){var $Li=$Lf.getPoolBySign($Lr),$Lt=$Li.length?$Li.pop():null;return $Lt&&($Lt.__InPool=!1),$Lt},$Lf._poolDic={},$Lf.InPoolSign="__InPool",$Lf}()),$LZ=function(){function $LN(){}return $Lg($LN,"laya.utils.Stat"),$LO(1,$LN,"onclick",null,function($Lr){$LN._sp&&$LN._sp.on("click",$LN._sp,$Lr),$LN._canvas&&($LN._canvas.source.onclick=$Lr,$LN._canvas.source.style.pointerEvents="")}),$LN.show=function($Lr,$Li,$Lt){if(void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),!$LF.isConchApp||$LF.isConchWebGL){if($LF.isConchWebGL||$Lq.onMiniGame||$Lq.onLimixiu||($LN._useCanvas=!0),$LN._show=!0,$LN._fpsData.length=60,$LN._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},$LN._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},$LN._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},$LN._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},$LF.isWebGL)if($LN._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},$LF.is3DMode){if($LN._view[0].title="FPS(3D)",$LN._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},$LN._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},$LN._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==$Lt){var $L_=8;$LN._view[$L_++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},$LN._view[$L_++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$LN._view[$L_++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},$LN._view[$L_++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$LN._view[$L_++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$LN._view[$L_++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$LN._view[$L_++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$LN._view[$L_++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},$LN._view[$L_++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==$Lt){$L_=8;$LN._view[$L_++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},$LN._view[$L_++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},$LN._view[$L_++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},$LN._view[$L_++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},$LN._view[$L_++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},$LN._view[$L_++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},$LN._view[$L_++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else $LN._view[0].title="FPS(WebGL)",$LN._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else $LN._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};$LN._useCanvas?$LN.createUIPre($Lr,$Li):$LN.createUI($Lr,$Li),$LN.enable()}else $Lq.window.conch.showFPS&&$Lq.window.conch.showFPS($Lr,$Li)},$LN.createUIPre=function($Lr,$Li){var $Lt=$Lq.pixelRatio;$LN._width=170*$Lt,$LN._vx=75*$Lt,$LN._height=$Lt*(12*$LN._view.length+3*$Lt)+4,$LN._fontSize=12*$Lt;for(var $L_=0;$L_<$LN._view.length;$L_++)$LN._view[$L_].x=4,$LN._view[$L_].y=$L_*$LN._fontSize+2*$Lt;$LN._canvas||(($LN._canvas=new $Lnr("2D")).size($LN._width,$LN._height),($LN._ctx=$LN._canvas.getContext("2d")).textBaseline="top",$LN._ctx.font=$LN._fontSize+"px Sans-serif",$LN._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+$Lr+"px;top:"+$Li+"px;width:"+$LN._width/$Lt+"px;height:"+$LN._height/$Lt+"px;"),$LN._first=!0,$LN.loop(),$LN._first=!1,$Lq.container.appendChild($LN._canvas.source)},$LN.createUI=function($Lr,$Li){var $Lt=$LN._sp,$L_=$Lq.pixelRatio;$Lt||($Lt=new $LRr,($LN._leftText=new $LBr).pos(5,5),$LN._leftText.color="#ffffff",$Lt.addChild($LN._leftText),($LN._txt=new $LBr).pos(80*$L_,5),$LN._txt.color="#ffffff",$Lt.addChild($LN._txt),$LN._sp=$Lt),$Lt.pos($Lr,$Li);for(var $LA="",$Lf=0;$Lf<$LN._view.length;$Lf++){$LA+=$LN._view[$Lf].title+"\n"}$LN._leftText.text=$LA;var $LE=170*$L_,$LG=$L_*(12*$LN._view.length+3*$L_)+4;$LN._txt.fontSize=$LN._fontSize*$L_,$LN._leftText.fontSize=$LN._fontSize*$L_,$Lt.size($LE,$LG),$Lt.graphics.clear(),$Lt.graphics.setAlpha(.5),$Lt.graphics.drawRect(0,0,$LE,$LG,"#999999"),$Lt.graphics.setAlpha(1),$LN.loop()},$LN.enable=function(){$Lw.timer.frameLoop(1,$LN,$LN.loop)},$LN.hide=function(){$LN._show=!1,$Lw.timer.clear($LN,$LN.loop),$LN._canvas&&$Lq.removeElement($LN._canvas.source)},$LN.clear=function(){$LN.trianglesFaces=$LN.drawCall=$LN.shaderCall=$LN.spriteCount=$LN.spriteRenderUseCacheCount=$LN.treeNodeCollision=$LN.treeSpriteCollision=$LN.canvasNormal=$LN.canvasBitmap=$LN.canvasReCache=0},$LN.loop=function(){$LN._count++;var $Lr=$Lq.now();if(!($Lr-$LN._timer<1e3)){var $Li=$LN._count;if($LN.FPS=Math.round(1e3*$Li/($Lr-$LN._timer)),$LN._show){$LN.trianglesFaces=Math.round($LN.trianglesFaces/$Li),$LN.spriteCount=$LN._useCanvas?($LN.drawCall=Math.round($LN.drawCall/$Li)-2,$LN.shaderCall=Math.round($LN.shaderCall/$Li),Math.round($LN.spriteCount/$Li)-1):($LN.drawCall=Math.round($LN.drawCall/$Li)-2,$LN.shaderCall=Math.round($LN.shaderCall/$Li)-4,Math.round($LN.spriteCount/$Li)-4),$LN.spriteRenderUseCacheCount=Math.round($LN.spriteRenderUseCacheCount/$Li),$LN.canvasNormal=Math.round($LN.canvasNormal/$Li),$LN.canvasBitmap=Math.round($LN.canvasBitmap/$Li),$LN.canvasReCache=Math.ceil($LN.canvasReCache/$Li),$LN.treeNodeCollision=Math.round($LN.treeNodeCollision/$Li),$LN.treeSpriteCollision=Math.round($LN.treeSpriteCollision/$Li);var $Lt=0<$LN.FPS?Math.floor(1e3/$LN.FPS).toString():" ";$LN._fpsStr=$LN.FPS+($LN.renderSlow?" slow":"")+" "+$Lt,$LN._spriteStr=$LN.spriteCount+($LN.spriteRenderUseCacheCount?"/"+$LN.spriteRenderUseCacheCount:""),$LN._canvasStr=$LN.canvasReCache+"/"+$LN.canvasNormal+"/"+$LN.canvasBitmap,$LN.currentMemorySize=$LP.systemResourceManager.memorySize,$LN._useCanvas?$LN.renderInfoPre():$LN.renderInfo(),$LN.clear()}$LN._count=0,$LN._timer=$Lr}},$LN.renderInfoPre=function(){if($LN._canvas){var $Lr=$LN._ctx;$Lr.clearRect($LN._first?0:$LN._vx,0,$LN._width,$LN._height);for(var $Li=$LF.WebGL.mainContext,$Lt=0;$Lt<$LN._view.length;$Lt++){var $L_=$LN._view[$Lt];$LN._first&&($Lr.fillStyle="white",$Lr.fillText($L_.title,$L_.x,$L_.y,null,null,null)),$Lr.fillStyle=$L_.color;var $LA=-1;if(($L_=$LN._view[$Lt]).varying){if($Li)switch($L_.varying){case 1:$LA=$Li.getParameter($Li[$L_.value]);break;case 2:$LA=$Li.getExtension($L_.value)}}else $LA=$LN[$L_.value];"M"==$L_.units&&($LA=Math.floor($LA/1048576*100)/100+" M"),"K"==$L_.units&&($LA=Math.floor($LA/1024*100)/100+" K"),"string"==$L_.units&&($LA=$LA.match(/\d+\.?\d/i)),$Lr.fillText($LA+"",$L_.x+$LN._vx,$L_.y,null,null,null)}}},$LN.renderInfo=function(){for(var $Lr="",$Li=$LF.WebGL.mainContext,$Lt=0;$Lt<$LN._view.length;$Lt++){var $L_=$LN._view[$Lt],$LA=-1;if($L_.varying){if($Li)switch($L_.varying){case 1:$LA=$Li.getParameter($Li[$L_.value]);break;case 2:$LA=$Li.getExtension($L_.value)}}else $LA=$LN[$L_.value];"M"==$L_.units&&($LA=Math.floor($LA/1048576*100)/100+" M"),"K"==$L_.units&&($LA=Math.floor($LA/1024*100)/100+" K"),"string"==$L_.units&&($LA=$LA.match(/\d+\.?\d/i)),$Lr+=$LA+"\n"}$LN._txt.text=$Lr},$LN.FPS=0,$LN.loopCount=0,$LN.shaderCall=0,$LN.drawCall=0,$LN.trianglesFaces=0,$LN.spriteCount=0,$LN.spriteRenderUseCacheCount=0,$LN.treeNodeCollision=0,$LN.treeSpriteCollision=0,$LN.canvasNormal=0,$LN.canvasBitmap=0,$LN.canvasReCache=0,$LN.renderSlow=!1,$LN.currentMemorySize=0,$LN._fpsStr=null,$LN._canvasStr=null,$LN._spriteStr=null,$LN._fpsData=[],$LN._timer=0,$LN._count=0,$LN._view=[],$LN._fontSize=12,$LN._txt=null,$LN._leftText=null,$LN._sp=null,$LN._show=!1,$LN._useCanvas=!1,$LN._canvas=null,$LN._ctx=null,$LN._first=!1,$LN._vx=NaN,$LN._width=0,$LN._height=100,$LN}(),$LW=(function(){function $Lr(){this._strsToID={},this._idToStrs=[],this._length=0}$Lg($Lr,"laya.utils.StringKey");var $Li=$Lr.prototype;$Li.add=function($Lr){var $Li=this._strsToID[$Lr];return null!=$Li?$Li:(this._idToStrs[this._length]=$Lr,this._strsToID[$Lr]=this._length++)},$Li.getID=function($Lr){var $Li=this._strsToID[$Lr];return null==$Li?-1:$Li},$Li.getName=function($Lr){var $Li=this._idToStrs[$Lr];return null==$Li?void 0:$Li}}(),function(){var $Lp;function $Lr(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}$Lg($Lr,"laya.utils.Timer");var $Li=$Lr.prototype;return $Li._init=function(){$Lw.timer&&$Lw.timer.frameLoop(1,this,this._update)},$Li._now=function(){return Date.now()},$Li._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var $Lr=this.currFrame=this.currFrame+this.scale,$Li=this._now();this._delta=($Li-this._lastTimer)*this.scale;var $Lt=this.currTimer=this.currTimer+this._delta;$Lw.isDebug&&6e4<Math.abs($Li-this._lastTimer)&&console.error("系统时间错误！"+($Li-this._lastTimer)),this._lastTimer=$Li;var $L_=this._handlers;for($LE=this._count=0,$LG=$L_.length;$LE<$LG;$LE++)if(null!==($LN=$L_[$LE]).method){var $LA=$LN.userFrame?$Lr:$Lt;if($LA>=$LN.exeTime)if($LN.repeat)if($LN.jumpFrame)for(;$LA>=$LN.exeTime;)$LN.exeTime+=$LN.delay,$LN.run(!1);else $LN.exeTime+=$LN.delay,$LN.run(!1),$LA>$LN.exeTime&&($LN.exeTime+=Math.ceil(($LA-$LN.exeTime)/$LN.delay)*$LN.delay);else $LN.run(!0)}else this._count++;(30<this._count||$Lr%200==0)&&this._clearHandlers();for(var $Lf=this._laters,$LE=0,$LG=$Lf.length-1;$LE<=$LG;$LE++){var $LN=$Lf[$LE];this._isIgnoreRecover($LN)||(null!==$LN.method&&(delete this._map[$LN.key],$LN.run(!1)),this._recoverHandler($LN)),$LE===$LG&&($LG=$Lf.length-1)}$Lf.length=0}},$Li._clearHandlers=function(){for(var $Lr=this._handlers,$Li=0,$Lt=$Lr.length;$Li<$Lt;$Li++){var $L_=$Lr[$Li];null!==$L_.method?this._temp.push($L_):this._isIgnoreRecover($L_)?this._temp.push($L_):this._recoverHandler($L_)}this._handlers=this._temp,this._temp=$Lr,this._temp.length=0},$Li._recoverHandler=function($Lr){this._map[$Lr.key]==$Lr&&delete this._map[$Lr.key],$Lr.recover()},$Li._create=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){if(!$Lt)return $LA.apply($L_,$Lf),null;if($LE){var $LN=this._getHandler($L_,$LA);if($LN)return $LN.repeat=$Li,$LN.userFrame=$Lr,$LN.delay=$Lt,$LN.ignoreRecover=$LG,$LN.caller=$L_,$LN.method=$LA,$LN.args=$Lf,$LN.exeTime=$Lt+($Lr?this.currFrame:this.currTimer+this._now()-this._lastTimer),$LN}return($LN=$Lp.create()).repeat=$Li,$LN.userFrame=$Lr,$LN.delay=$Lt,$LN.ignoreRecover=$LG,$LN.caller=$L_,$LN.method=$LA,$LN.args=$Lf,$LN.exeTime=$Lt+($Lr?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler($LN),this._handlers.push($LN),$LN},$Li._indexHandler=function($Lr){var $Li=$Lr.caller,$Lt=$Lr.method,$L_=$Li?$Li.$_GID||($Li.$_GID=$LK.getGID()):0,$LA=$Lt.$_TID||($Lt.$_TID=this._mid++);$Lr.key=$L_+"_"+$LA,this._map[$Lr.key]=$Lr},$Li.once=function($Lr,$Li,$Lt,$L_,$LA){void 0===$LA&&($LA=!0),this._create(!1,!1,$Lr,$Li,$Lt,$L_,$LA,!1)},$Li.loop=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){void 0===$LA&&($LA=!0),void 0===$Lf&&($Lf=!1),void 0===$LE&&($LE=!1);var $LG=this._create(!1,!0,$Lr,$Li,$Lt,$L_,$LA,$LE);$LG&&($LG.jumpFrame=$Lf)},$Li.frameOnce=function($Lr,$Li,$Lt,$L_,$LA){void 0===$LA&&($LA=!0),this._create(!0,!1,$Lr,$Li,$Lt,$L_,$LA,!1)},$Li.frameLoop=function($Lr,$Li,$Lt,$L_,$LA,$Lf){void 0===$LA&&($LA=!0),void 0===$Lf&&($Lf=!1),this._create(!0,!0,$Lr,$Li,$Lt,$L_,$LA,$Lf)},$Li.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+$Lp._freeCount},$Li.clear=function($Lr,$Li){var $Lt=this._getHandler($Lr,$Li);return!(!$Lt||this._isIgnoreRecover($Lt))&&(delete this._map[$Lt.key],$Lt.key=null,$Lt.clear(),!0)},$Li.clearAll=function($Lr){if($Lr)for(var $Li=0,$Lt=this._handlers.length;$Li<$Lt;$Li++){var $L_=this._handlers[$Li];$L_.caller===$Lr&&(this._isIgnoreRecover($L_)||(delete this._map[$L_.key],$L_.key=null,$L_.clear()))}},$Li._getHandler=function($Lr,$Li){var $Lt=$Lr?$Lr.$_GID||($Lr.$_GID=$LK.getGID()):0,$L_=$Li.$_TID||($Li.$_TID=this._mid++);return this._map[$Lt+"_"+$L_]},$Li._isIgnoreRecover=function($Lr){if($Lr.ignoreRecover||$Lr.caller&&"IgnoreRecover"==$Lr.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var $Li="";try{arguments.propertyIsEnumerable.caller}catch($Lr){$Li=$Lr.stack}$Lw.recordError("报错：核心定时器销毁忽略  "+$Li)}return!0}return!1},$Li.hasHandler=function($Lr,$Li){return this._map[$Lr.$_GID+"_"+$Li.$_TID]},$Li.callLater=function($Lr,$Li,$Lt){if(null==this._getHandler($Lr,$Li)){var $L_=$Lp.create();$L_.caller=$Lr,$L_.method=$Li,$L_.args=$Lt,this._indexHandler($L_),this._laters.push($L_)}},$Li.runCallLater=function($Lr,$Li){var $Lt=this._getHandler($Lr,$Li);$Lt&&null!=$Lt.method&&(this._isIgnoreRecover($Lt)||(delete this._map[$Lt.key],$Lt.run(!0)))},$Li.runTimer=function($Lr,$Li){this.runCallLater($Lr,$Li)},$LO(0,$Li,"delta",function(){return this._delta}),$Lr.__init$=function(){$Lp=function(){function $Li(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}$Lg($Li,"");var $Lr=$Li.prototype;return $Lr.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},$Lr.recover=function(){this.clear(),this.args=$Li._freeHandler,$Li._freeHandler=this,$Li._freeCount++},$Lr.run=function($Lr){var $Li=this.caller;if($Li&&$Li.destroyed)return this.clear();var $Lt=this.method,$L_=this.args;$Lr&&this.clear(),null!=$Lt&&($L_?$Lt.apply($Li,$L_):$Lt.call($Li))},$Li._freeHandler=null,$Li._freeCount=0,$Li.create=function(){var $Lr=$Li._freeHandler;return $Lr?($Li._freeHandler=$Lr.args,--$Li._freeCount,$Lr.args=null,$Lr):new $Li},$Li}()},$Lr}()),$LM=function(){function $LR(){this.gid=0}$Lg($LR,"laya.utils.Tween");var $Lr=$LR.prototype;return $Lr.to=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){return void 0===$Lf&&($Lf=0),void 0===$LE&&($LE=!1),this._create($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,!0,!1,!0)},$Lr.from=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){return void 0===$Lf&&($Lf=0),void 0===$LE&&($LE=!1),this._create($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,!1,!1,!0)},$Lr._create=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){if(!$Lr)throw new Error("Tween:target is null");this._target=$Lr,this._duration=$Lt,this._ease=$L_||$Li.ease||$LR.easeNone,this._complete=$LA||$Li.complete,this._delay=$Lf,this._props=[],this._usedTimer=0,this._startTimer=$Lq.now(),this._usedPool=$LN,this._delayParam=null,this.update=$Li.update;var $Lg=$Lr.$_GID||($Lr.$_GID=$LK.getGID());return $LR.tweenMap[$Lg]?($LE&&$LR.clearTween($Lr),$LR.tweenMap[$Lg].push(this)):$LR.tweenMap[$Lg]=[this],$Lp?$Lf<=0?this.firstStart($Lr,$Li,$LG):(this._delayParam=[$Lr,$Li,$LG],$Lw.scaleTimer.once($Lf,this,this.firstStart,this._delayParam)):this._initProps($Lr,$Li,$LG),this},$Lr.firstStart=function($Lr,$Li,$Lt){this._delayParam=null,$Lr.destroyed?this.clear():(this._initProps($Lr,$Li,$Lt),this._beginLoop())},$Lr._initProps=function($Lr,$Li,$Lt){for(var $L_ in $Li)if("number"==typeof $Lr[$L_]){var $LA=$Lt?$Lr[$L_]:$Li[$L_],$Lf=$Lt?$Li[$L_]:$Lr[$L_];this._props.push([$L_,$LA,$Lf-$LA]),$Lt||($Lr[$L_]=$LA)}},$Lr._beginLoop=function(){$Lw.scaleTimer.frameLoop(1,this,this._doEase)},$Lr._doEase=function(){this._updateEase($Lq.now())},$Lr._updateEase=function($Lr){var $Li=this._target;if($Li){if($Li.destroyed)return $LR.clearTween($Li);var $Lt=this._usedTimer=$Lr-this._startTimer-this._delay;if(!($Lt<0)){if($Lt>=this._duration)return this.complete();for(var $L_=0<$Lt?this._ease($Lt,0,1,this._duration):0,$LA=this._props,$Lf=0,$LE=$LA.length;$Lf<$LE;$Lf++){var $LG=$LA[$Lf];$Li[$LG[0]]=$LG[1]+$L_*$LG[2]}this.update&&this.update.run()}}},$Lr.complete=function(){if(this._target){$Lw.scaleTimer.runTimer(this,this.firstStart);for(var $Lr=this._target,$Li=this._props,$Lt=this._complete,$L_=0,$LA=$Li.length;$L_<$LA;$L_++){var $Lf=$Li[$L_];$Lr[$Lf[0]]=$Lf[1]+$Lf[2]}this.update&&this.update.run(),this.clear(),$Lt&&$Lt.run()}},$Lr.pause=function(){$Lw.scaleTimer.clear(this,this._beginLoop),$Lw.scaleTimer.clear(this,this._doEase),$Lw.scaleTimer.clear(this,this.firstStart);var $Lr;($Lr=$Lq.now()-this._startTimer-this._delay)<0&&(this._usedTimer=$Lr)},$Lr.setStartTime=function($Lr){this._startTimer=$Lr},$Lr.clear=function(){this._target&&(this._remove(),this._clear())},$Lr._clear=function(){this.pause(),$Lw.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,$LJ.recover("tween",this))},$Lr.recover=function(){this._usedPool=!0,this._clear()},$Lr._remove=function(){var $Lr=$LR.tweenMap[this._target.$_GID];if($Lr)for(var $Li=0,$Lt=$Lr.length;$Li<$Lt;$Li++)if($Lr[$Li]===this){$Lr.splice($Li,1);break}},$Lr.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=$Lq.now(),this._delayParam)$Lw.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var $Lr=this._props,$Li=0,$Lt=$Lr.length;$Li<$Lt;$Li++){var $L_=$Lr[$Li];this._target[$L_[0]]=$L_[1]}$Lw.scaleTimer.once(this._delay,this,this._beginLoop)}},$Lr.resume=function(){this._usedTimer>=this._duration||(this._startTimer=$Lq.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?$Lw.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},$LO(0,$Lr,"progress",null,function($Lr){var $Li=$Lr*this._duration;this._startTimer=$Lq.now()-this._delay-$Li}),$LR.to=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){return void 0===$Lf&&($Lf=0),void 0===$LE&&($LE=!1),void 0===$LG&&($LG=!0),$LJ.getItemByClass("tween",$LR)._create($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,!0,$LG,!0)},$LR.from=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){return void 0===$Lf&&($Lf=0),void 0===$LE&&($LE=!1),void 0===$LG&&($LG=!0),$LJ.getItemByClass("tween",$LR)._create($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,!1,$LG,!0)},$LR.clearAll=function($Lr){if($Lr&&$Lr.$_GID){var $Li=$LR.tweenMap[$Lr.$_GID];if($Li){for(var $Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++)$Li[$Lt]._clear();$Li.length=0}}},$LR.clear=function($Lr){$Lr.clear()},$LR.clearTween=function($Lr){$LR.clearAll($Lr)},$LR.easeNone=function($Lr,$Li,$Lt,$L_){return $Lt*$Lr/$L_+$Li},$LR.tweenMap={},$LR}(),$LK=function(){function $LG(){}return $Lg($LG,"laya.utils.Utils"),$LG.toRadian=function($Lr){return $Lr*$LG._pi2},$LG.toAngle=function($Lr){return $Lr*$LG._pi},$LG.toHexColor=function($Lr){if($Lr<0||isNaN($Lr))return null;for(var $Li=$Lr.toString(16);$Li.length<6;)$Li="0"+$Li;return"#"+$Li},$LG.getGID=function(){return $LG._gid++},$LG.concatArray=function($Lr,$Li){if(!$Li)return $Lr;if(!$Lr)return $Li;var $Lt=0,$L_=$Li.length;for($Lt=0;$Lt<$L_;$Lt++)$Lr.push($Li[$Lt]);return $Lr},$LG.clearArray=function($Lr){return $Lr&&($Lr.length=0),$Lr},$LG.copyArray=function($Lr,$Li){if($Lr||($Lr=[]),!$Li)return $Lr;$Lr.length=$Li.length;var $Lt=0,$L_=$Li.length;for($Lt=0;$Lt<$L_;$Lt++)$Lr[$Lt]=$Li[$Lt];return $Lr},$LG.getGlobalRecByPoints=function($Lr,$Li,$Lt,$L_,$LA){var $Lf,$LE;return $Lf=new $LH($Li,$Lt),$Lf=$Lr.localToGlobal($Lf),$LE=new $LH($L_,$LA),$LE=$Lr.localToGlobal($LE),$Ls._getWrapRec([$Lf.x,$Lf.y,$LE.x,$LE.y])},$LG.getGlobalPosAndScale=function($Lr){return $LG.getGlobalRecByPoints($Lr,0,0,1,1)},$LG.bind=function($Lr,$Li){return $Lr.bind($Li)},$LG.measureText=function($Lr,$Li){return $Lk.measureText($Lr,$Li)},$LG.contextMeasureText=function($Lr){var $Li=$Lq.context.measureText($Lr);return $Li||($Li={width:16,height:16}),$Li},$LG.updateOrder=function($Lr){if(!$Lr||$Lr.length<2)return!1;for(var $Li,$Lt=1,$L_=0,$LA=$Lr.length,$Lf=NaN;$Lt<$LA;){for($Li=$Lr[$L_=$Lt],$Lf=$Lr[$L_]._zOrder;-1<--$L_&&$Lr[$L_]._zOrder>$Lf;)$Lr[$L_+1]=$Lr[$L_];$Lr[$L_+1]=$Li,$Lt++}var $LE=$Li.parent.conchModel;if($LE)if(null!=$LE.updateZOrder)$LE.updateZOrder();else{for($Lt=0;$Lt<$LA;$Lt++)$LE.removeChild($Lr[$Lt].conchModel);for($Lt=0;$Lt<$LA;$Lt++)$LE.addChildAt($Lr[$Lt].conchModel,$Lt)}return!0},$LG.transPointList=function($Lr,$Li,$Lt){var $L_=0,$LA=$Lr.length;for($L_=0;$L_<$LA;$L_+=2)$Lr[$L_]+=$Li,$Lr[$L_+1]+=$Lt},$LG.parseInt=function($Lr,$Li){void 0===$Li&&($Li=0);var $Lt=$Lq.window.parseInt($Lr,$Li);return isNaN($Lt)?0:$Lt},$LG.getFileExtension=function($Lr){$LG._extReg.lastIndex=$Lr.lastIndexOf(".");var $Li=$LG._extReg.exec($Lr);return $Li&&1<$Li.length?$Li[1].toLowerCase():null},$LG.getTransformRelativeToWindow=function($Lr,$Li,$Lt){var $L_=$Lw.stage,$LA=laya.utils.Utils.getGlobalPosAndScale($Lr),$Lf=$L_._canvasTransform.clone(),$LE=$Lf.tx,$LG=$Lf.ty;$Lf.rotate(-Math.PI/180*$Lw.stage.canvasDegree),$Lf.scale($Lw.stage.clientScaleX,$Lw.stage.clientScaleY);var $LN=$Lw.stage.canvasDegree%180!=0,$Lp=NaN,$Lg=NaN;$LN?($Lp=$Lt+$LA.y,$Lg=$Li+$LA.x,$Lp*=$Lf.d,$Lg*=$Lf.a,90==$Lw.stage.canvasDegree?($Lp=$LE-$Lp,$Lg+=$LG):($Lp+=$LE,$Lg=$LG-$Lg)):($Lp=$Li+$LA.x,$Lg=$Lt+$LA.y,$Lp*=$Lf.a,$Lg*=$Lf.d,$Lp+=$LE,$Lg+=$LG);var $LR=NaN,$LX=NaN;return $LX=$LN?($LR=$Lf.d*$LA.height,$Lf.a*$LA.width):($LR=$Lf.a*$LA.width,$Lf.d*$LA.height),{x:$Lp,y:$Lg,scaleX:$LR,scaleY:$LX}},$LG.fitDOMElementInArea=function($Lr,$Li,$Lt,$L_,$LA,$Lf){$Lr._fitLayaAirInitialized||($Lr._fitLayaAirInitialized=!0,$Lr.style.transformOrigin=$Lr.style.webKittransformOrigin="left top",$Lr.style.position="absolute");var $LE=$LG.getTransformRelativeToWindow($Li,$Lt,$L_);$Lr.style.transform=$Lr.style.webkitTransform="scale("+$LE.scaleX+","+$LE.scaleY+") rotate("+$Lw.stage.canvasDegree+"deg)",$Lr.style.width=$LA+"px",$Lr.style.height=$Lf+"px",$Lr.style.left=$LE.x+"px",$Lr.style.top=$LE.y+"px"},$LG.isOkTextureList=function($Lr){if(!$Lr)return!1;var $Li,$Lt=0,$L_=$Lr.length;for($Lt=0;$Lt<$L_;$Lt++)if(!($Li=$Lr[$Lt])||!$Li.source)return!1;return!0},$LG.isOKCmdList=function($Lr){if(!$Lr)return!1;var $Li,$Lt,$L_=0,$LA=$Lr.length,$Lf=$LF._context;for($L_=0;$L_<$LA;$L_++)switch(($Li=$Lr[$L_]).callee){case $Lf._drawTexture:case $Lf._fillTexture:case $Lf._drawTextureWithTransform:if(!($Lt=$Li[0])||!$Lt.source)return!1}return!0},$LG._gid=1,$LG._pi=180/Math.PI,$LG._pi2=Math.PI/180,$LG._extReg=/\.(\w+)\??/g,$LG.parseXMLFromString=function($Lr){var $Li;if($Lr=$Lr.replace(/>\s+</g,"><"),-1<($Li=(new DOMParser).parseFromString($Lr,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error($Li.firstChild.firstChild.textContent);return $Li},$LG}(),$LS=function(){function $Lr(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],$LF.isWebGL&&$LT.regCacheByFunction($LK.bind(this.startDispose,this),$LK.bind(this.getCacheList,this))}$Lg($Lr,"laya.utils.VectorGraphManager");var $Li=$Lr.prototype;return $Li.getId=function(){return this._id++},$Li.addShape=function($Lr,$Li){this.shapeDic[$Lr]=$Li,this.useDic[$Lr]||(this.useDic[$Lr]=!0)},$Li.addLine=function($Lr,$Li){this.shapeLineDic[$Lr]=$Li,this.shapeLineDic[$Lr]||(this.shapeLineDic[$Lr]=!0)},$Li.getShape=function($Lr){this._checkKey&&null!=this.useDic[$Lr]&&(this.useDic[$Lr]=!0)},$Li.deleteShape=function($Lr){this.shapeDic[$Lr]&&(this.shapeDic[$Lr]=null,delete this.shapeDic[$Lr]),this.shapeLineDic[$Lr]&&(this.shapeLineDic[$Lr]=null,delete this.shapeLineDic[$Lr]),null!=this.useDic[$Lr]&&delete this.useDic[$Lr]},$Li.getCacheList=function(){var $Lr,$Li=[];for($Lr in this.shapeDic)$Li.push(this.shapeDic[$Lr]);for($Lr in this.shapeLineDic)$Li.push(this.shapeLineDic[$Lr]);return $Li},$Li.startDispose=function($Lr){var $Li;for($Li in this.useDic)this.useDic[$Li]=!1;this._checkKey=!0},$Li.endDispose=function(){if(this._checkKey){var $Lr;for($Lr in this.useDic)this.useDic[$Lr]||this.deleteShape($Lr);this._checkKey=!1}},$Lr.getInstance=function(){return $Lr.instance=$Lr.instance||new $Lr},$Lr.instance=null,$Lr}(),$LY=function(){function $L_(){this._obj=null,this._obj=$L_.supportWeakMap?new $Lq.window.WeakMap:{},$L_.supportWeakMap||$L_._maps.push(this)}$Lg($L_,"laya.utils.WeakObject");var $Lr=$L_.prototype;return $Lr.set=function($Lr,$Li){if(null!=$Lr)if($L_.supportWeakMap){var $Lt=$Lr;"string"!=typeof $Lr&&"number"!=typeof $Lr||($Lt=$L_._keys[$Lr])||($Lt=$L_._keys[$Lr]={k:$Lr}),this._obj.set($Lt,$Li)}else"string"==typeof $Lr||"number"==typeof $Lr?this._obj[$Lr]=$Li:($Lr.$_GID||($Lr.$_GID=$LK.getGID()),this._obj[$Lr.$_GID]=$Li)},$Lr.get=function($Lr){if(null==$Lr)return null;if($L_.supportWeakMap){var $Li="string"==typeof $Lr||"number"==typeof $Lr?$L_._keys[$Lr]:$Lr;return $Li?this._obj.get($Li):null}return"string"==typeof $Lr||"number"==typeof $Lr?this._obj[$Lr]:this._obj[$Lr.$_GID]},$Lr.del=function($Lr){if(null!=$Lr)if($L_.supportWeakMap){var $Li="string"==typeof $Lr||"number"==typeof $Lr?$L_._keys[$Lr]:$Lr;if(!$Li)return;this._obj.delete($Li)}else"string"==typeof $Lr||"number"==typeof $Lr?delete this._obj[$Lr]:delete this._obj[this._obj.$_GID]},$Lr.has=function($Lr){if(null==$Lr)return!1;if($L_.supportWeakMap){var $Li="string"==typeof $Lr||"number"==typeof $Lr?$L_._keys[$Lr]:$Lr;return this._obj.has($Li)}return"string"==typeof $Lr||"number"==typeof $Lr?null!=this._obj[$Lr]:null!=this._obj[this._obj.$_GID]},$L_.__init__=function(){($L_.supportWeakMap=null!=$Lq.window.WeakMap)||$Lw.timer.loop($L_.delInterval,null,$L_.clearCache)},$L_.clearCache=function(){for(var $Lr=0,$Li=$L_._maps.length;$Lr<$Li;$Lr++){$L_._maps[$Lr]._obj={}}},$L_.supportWeakMap=!1,$L_.delInterval=3e5,$L_._keys={},$L_._maps=[],$LN($L_,["I",function(){return this.I=new $L_}]),$L_}(),$Lj=function(){function $Lr(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}$Lg($Lr,"laya.utils.WordText");var $Li=$Lr.prototype;return $Li.setText=function($Lr){this.changed=!0,this._text=$Lr},$Li.toString=function(){return this._text},$Li.charCodeAt=function($Lr){return this._text?this._text.charCodeAt($Lr):NaN},$Li.charAt=function($Lr){return this._text?this._text.charAt($Lr):null},$LO(0,$Li,"length",function(){return this._text?this._text.length:0}),$Lr}(),$Lrr=function($Lr){function $LE(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,$LE.__super.call(this),this._childs=$LE.ARRAY_EMPTY,this._$P=$LE.PROP_EMPTY,this.timer=$Lw.scaleTimer,this.conchModel=$LF.isConchNode?this.createConchModel():null}$Lg($LE,"laya.display.Node",$Lp);var $Li=$LE.prototype;return $Li._setBit=function($Lr,$Li){1==$Lr&&(this._getBit($Lr)!=$Li&&this._updateDisplayedInstage());$Li?this._bits|=$Lr:this._bits&=~$Lr},$Li._getBit=function($Lr){return 0!=(this._bits&$Lr)},$Li._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},$Li._setUpNoticeType=function($Lr){var $Li=this;for($Li._setBit($Lr,!0),$Li=$Li.parent;$Li;){if($Li._getBit($Lr))return;$Li._setBit($Lr,!0),$Li=$Li.parent}},$Li.on=function($Lr,$Li,$Lt,$L_){return"display"!==$Lr&&"undisplay"!==$Lr||this._getBit(1)||this._setUpNoticeType(1),this._createListener($Lr,$Li,$Lt,$L_,!1)},$Li.once=function($Lr,$Li,$Lt,$L_){return"display"!==$Lr&&"undisplay"!==$Lr||this._getBit(1)||this._setUpNoticeType(1),this._createListener($Lr,$Li,$Lt,$L_,!0)},$Li.createConchModel=function(){return null},$Li.destroy=function($Lr){void 0===$Lr&&($Lr=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&($Lr?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},$Li.destroyChildren=function(){if(this._childs)for(var $Lr=this._childs.length-1;-1<$Lr;$Lr--)this._childs[$Lr].destroy(!0)},$Li.addChild=function($Lr){if(!$Lr||this.destroyed||$Lr===this)return $Lr;if($Lr.zOrder&&this._set$P("hasZorder",!0),$Lr._parent===this){var $Li=this.getChildIndex($Lr);$Li!==this._childs.length-1&&(this._childs.splice($Li,1),this._childs.push($Lr),this.conchModel&&(this.conchModel.removeChild($Lr.conchModel),this.conchModel.addChildAt($Lr.conchModel,this._childs.length-1)),this._childChanged())}else $Lr.parent&&$Lr.parent.removeChild($Lr),this._childs===$LE.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($Lr),this.conchModel&&this.conchModel.addChildAt($Lr.conchModel,this._childs.length-1),($Lr.parent=this)._childChanged();return $Lr},$Li.addChildren=function($Lr){for(var $Li=arguments,$Lt=0,$L_=$Li.length;$Lt<$L_;)this.addChild($Li[$Lt++])},$Li.addChildAt=function($Lr,$Li){if(!$Lr||this.destroyed||$Lr===this)return $Lr;if($Lr.zOrder&&this._set$P("hasZorder",!0),0<=$Li&&$Li<=this._childs.length){if($Lr._parent===this){var $Lt=this.getChildIndex($Lr);this._childs.splice($Lt,1),this._childs.splice($Li,0,$Lr),this.conchModel&&(this.conchModel.removeChild($Lr.conchModel),this.conchModel.addChildAt($Lr.conchModel,$Li)),this._childChanged()}else $Lr.parent&&$Lr.parent.removeChild($Lr),this._childs===$LE.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($Li,0,$Lr),this.conchModel&&this.conchModel.addChildAt($Lr.conchModel,$Li),$Lr.parent=this;return $Lr}throw new Error("appendChildAt:The index is out of bounds")},$Li.getChildIndex=function($Lr){return this._childs.indexOf($Lr)},$Li.getChildByName=function($Lr){var $Li=this._childs;if($Li)for(var $Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++){var $LA=$Li[$Lt];if($LA.name===$Lr)return $LA}return null},$Li._get$P=function($Lr){return this._$P[$Lr]},$Li._set$P=function($Lr,$Li){return this.destroyed||(this._$P===$LE.PROP_EMPTY&&(this._$P={}),this._$P[$Lr]=$Li),$Li},$Li.getChildAt=function($Lr){return this._childs[$Lr]},$Li.setChildIndex=function($Lr,$Li){var $Lt=this._childs;if($Li<0||$Li>=$Lt.length)throw new Error("setChildIndex:The index is out of bounds.");var $L_=this.getChildIndex($Lr);if($L_<0)throw new Error("setChildIndex:node is must child of this object.");return $Lt.splice($L_,1),$Lt.splice($Li,0,$Lr),this.conchModel&&(this.conchModel.removeChild($Lr.conchModel),this.conchModel.addChildAt($Lr.conchModel,$Li)),this._childChanged(),$Lr},$Li._childChanged=function($Lr){},$Li.removeChild=function($Lr){if(!this._childs)return $Lr;var $Li=this._childs.indexOf($Lr);return this.removeChildAt($Li)},$Li.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},$Li.removeChildByName=function($Lr){var $Li=this.getChildByName($Lr);return $Li&&this.removeChild($Li),$Li},$Li.removeChildAt=function($Lr){var $Li=this.getChildAt($Lr);if($Li){for(var $Lt=this._childs.length-1,$L_=$Lr;$L_<$Lt;++$L_)this._childs[$L_]=this._childs[$L_+1];this._childs.length=$Lt,this.conchModel&&this.conchModel.removeChild($Li.conchModel),$Li.parent=null}return $Li},$Li.removeChildren=function($Lr,$Li){if(void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=2147483647),this._childs&&0<this._childs.length){var $Lt=this._childs;if(0===$Lr&&$Lf<=$Li){var $L_=$Lt;this._childs=$LE.ARRAY_EMPTY}else $L_=$Lt.splice($Lr,$Li-$Lr);for(var $LA=0,$Lf=$L_.length;$LA<$Lf;$LA++)$L_[$LA].parent=null,this.conchModel&&this.conchModel.removeChild($L_[$LA].conchModel)}return this},$Li.replaceChild=function($Lr,$Li){var $Lt=this._childs.indexOf($Li);return-1<$Lt?(this._childs.splice($Lt,1,$Lr),this.conchModel&&(this.conchModel.removeChild($Li.conchModel),this.conchModel.addChildAt($Lr.conchModel,$Lt)),$Li.parent=null,$Lr.parent=this,$Lr):null},$Li._updateDisplayedInstage=function(){var $Lr;$Lr=this;var $Li=$Lw.stage;for(this._displayedInStage=!1;$Lr;){if($Lr._getBit(1)){this._displayedInStage=$Lr._displayedInStage;break}if($Lr==$Li||$Lr._displayedInStage){this._displayedInStage=!0;break}$Lr=$Lr.parent}},$Li._setDisplay=function($Lr){this._displayedInStage!==$Lr&&((this._displayedInStage=$Lr)?this.event("display"):this.event("undisplay"))},$Li._displayChild=function($Lr,$Li){var $Lt=$Lr._childs;if($Lt)for(var $L_=0;$L_<$Lt.length;$L_++){var $LA=$Lt[$L_];$LA&&$LA._getBit(1)&&(0<$LA._childs.length?this._displayChild($LA,$Li):$LA._setDisplay($Li))}$Lr._setDisplay($Li)},$Li.contains=function($Lr){if($Lr===this)return!0;for(;$Lr;){if($Lr.parent===this)return!0;$Lr=$Lr.parent}return!1},$Li.timerLoop=function($Lr,$Li,$Lt,$L_,$LA,$Lf){void 0===$LA&&($LA=!0),void 0===$Lf&&($Lf=!1),this.timer.loop($Lr,$Li,$Lt,$L_,$LA,$Lf)},$Li.timerOnce=function($Lr,$Li,$Lt,$L_,$LA){void 0===$LA&&($LA=!0),this.timer._create(!1,!1,$Lr,$Li,$Lt,$L_,$LA)},$Li.frameLoop=function($Lr,$Li,$Lt,$L_,$LA){void 0===$LA&&($LA=!0),this.timer._create(!0,!0,$Lr,$Li,$Lt,$L_,$LA)},$Li.frameOnce=function($Lr,$Li,$Lt,$L_,$LA){void 0===$LA&&($LA=!0),this.timer._create(!0,!1,$Lr,$Li,$Lt,$L_,$LA)},$Li.clearTimer=function($Lr,$Li){this.timer.clear($Lr,$Li)},$LO(0,$Li,"numChildren",function(){return this._childs.length}),$LO(0,$Li,"destroyed",function(){return this._destroyed}),$LO(0,$Li,"parent",function(){return this._parent},function($Lr){this._parent!==$Lr&&($Lr?(this._parent=$Lr,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),$Lr.displayedInStage&&this._displayChild(this,!0)),$Lr._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=$Lr))}),$LO(0,$Li,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),$LE.ARRAY_EMPTY=[],$LE.PROP_EMPTY={},$LE.NOTICE_DISPLAY=1,$LE.MOUSEENABLE=2,$LE}(),$Lir=function($Lr){function $LX($Lr){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,$LX.__super.call(this),this._padding=$LX._PADDING,this._spacing=$LX._SPACING,this._aligns=$LX._ALIGNS,this._font=$Lv.EMPTY,this._ower=$Lr}$Lg($LX,"laya.display.css.CSSStyle",$Lr);var $Li=$LX.prototype;return $Li.destroy=function(){this._ower=null,this._font=null,this._rect=null},$Li.inherit=function($Lr){this._font=$Lr._font,this._spacing=$Lr._spacing===$LX._SPACING?$LX._SPACING:$Lr._spacing.slice(),this.lineHeight=$Lr.lineHeight},$Li._widthAuto=function(){return 0!=(262144&this._type)},$Li.widthed=function($Lr){return 0!=(8&this._type)},$Li._calculation=function($Lr,$Li){if($Li.indexOf("%")<0)return!1;var $L_=this._ower,$LA=$L_.parent,$Lf=this._rect;function $LE($Lr,$Li,$Lt){return $Lr*$Lt[0]+$Li*$Lt[1]+$Lt[2]}function $Lt($Lr){var $Li=$LA.width,$Lt=$L_.width;$Lf.width&&($L_.width=$LE($Li,$Lt,$Lf.width)),$Lf.height&&($L_.height=$LE($Li,$Lt,$Lf.height)),$Lf.left&&($L_.x=$LE($Li,$Lt,$Lf.left)),$Lf.top&&($L_.y=$LE($Li,$Lt,$Lf.top))}null===$Lf&&($LA._getCSSStyle()._type|=524288,$LA.on("resize",this,$Lt),this._rect=$Lf={input:{}});var $LG=$Li.split(" ");return $LG[0]=parseFloat($LG[0])/100,1==$LG.length?$LG[1]=$LG[2]=0:($LG[1]=parseFloat($LG[1])/100,$LG[2]=parseFloat($LG[2])),$Lf[$Lr]=$LG,$Lf.input[$Lr]=$Li,$Lt(),!0},$Li.heighted=function($Lr){return 0!=(8192&this._type)},$Li.size=function($Lr,$Li){var $Lt=this._ower,$L_=!1;-1!==$Lr&&$Lr!=this._ower.width&&(this._type|=8,this._ower.width=$Lr,$L_=!0),-1!==$Li&&$Li!=this._ower.height&&(this._type|=8192,this._ower.height=$Li,$L_=!0),$L_&&($Lt._layoutLater(),524288&this._type&&$Lt.event("resize",this))},$Li._getAlign=function(){return this._aligns[0]},$Li._getValign=function(){return this._aligns[1]},$Li._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},$Li._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new $Lv(this._font))},$Li.render=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.width,$Lf=$Lr.height;$Lt-=$Lr.pivotX,$L_-=$Lr.pivotY,this._bgground&&null!=this._bgground.color&&$Li.ctx.fillRect($Lt,$L_,$LA,$Lf,this._bgground.color),this._border&&this._border.color&&$Li.drawRect($Lt,$L_,$LA,$Lf,this._border.color.strColor,this._border.size)},$Li.getCSSStyle=function(){return this},$Li.cssText=function($Lr){this.attrs($LX.parseOneCSS($Lr,";"))},$Li.attrs=function($Lr){if($Lr)for(var $Li=0,$Lt=$Lr.length;$Li<$Lt;$Li++){var $L_=$Lr[$Li];this[$L_[0]]=$L_[1]}},$Li.setTransform=function($Lr){"none"===$Lr?this._tf=$LG._TF_EMPTY:this.attrs($LX.parseOneCSS($Lr,","))},$Li.translate=function($Lr,$Li){this._tf===$LG._TF_EMPTY&&(this._tf=new $LA),this._tf.translateX=$Lr,this._tf.translateY=$Li},$Li.scale=function($Lr,$Li){this._tf===$LG._TF_EMPTY&&(this._tf=new $LA),this._tf.scaleX=$Lr,this._tf.scaleY=$Li},$Li._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},$LO(0,$Li,"block",$Lr.prototype._$get_block,function($Lr){$Lr?this._type|=1:this._type&=-2}),$LO(0,$Li,"valign",function(){return $LX._valigndef[this._aligns[1]]},function($Lr){this._aligns===$LX._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=$LX._valigndef[$Lr]}),$LO(0,$Li,"height",null,function($Lr){if(this._type|=8192,"string"==typeof $Lr){if(this._calculation("height",$Lr))return;$Lr=parseInt($Lr)}this.size(-1,$Lr)}),$LO(0,$Li,"width",null,function($Lr){if(this._type|=8,"string"==typeof $Lr){var $Li=$Lr.indexOf("auto");if(0<=$Li&&(this._type|=262144,$Lr=$Lr.substr(0,$Li)),this._calculation("width",$Lr))return;$Lr=parseInt($Lr)}this.size($Lr,-1)}),$LO(0,$Li,"fontWeight",function(){return this._font.weight},function($Lr){this._createFont().weight=$Lr}),$LO(0,$Li,"left",null,function($Lr){var $Li=this._ower;if("string"==typeof $Lr){if("center"===$Lr?$Lr="50% -50% 0":"right"===$Lr&&($Lr="100% -100% 0"),this._calculation("left",$Lr))return;$Lr=parseInt($Lr)}$Li.x=$Lr}),$LO(0,$Li,"_translate",null,function($Lr){this.translate($Lr[0],$Lr[1])}),$LO(0,$Li,"absolute",function(){return 0!=(4&this._type)}),$LO(0,$Li,"top",null,function($Lr){var $Li=this._ower;if("string"==typeof $Lr){if("middle"===$Lr?$Lr="50% -50% 0":"bottom"===$Lr&&($Lr="100% -100% 0"),this._calculation("top",$Lr))return;$Lr=parseInt($Lr)}$Li.y=$Lr}),$LO(0,$Li,"align",function(){return $LX._aligndef[this._aligns[0]]},function($Lr){this._aligns===$LX._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=$LX._aligndef[$Lr]}),$LO(0,$Li,"bold",function(){return this._font.bold},function($Lr){this._createFont().bold=$Lr}),$LO(0,$Li,"padding",function(){return this._padding},function($Lr){this._padding=$Lr}),$LO(0,$Li,"leading",function(){return this._spacing[1]},function($Lr){"string"==typeof $Lr&&($Lr=parseInt($Lr+"")),this._spacing===$LX._SPACING&&(this._spacing=[0,0]),this._spacing[1]=$Lr}),$LO(0,$Li,"lineElement",function(){return 0!=(65536&this._type)},function($Lr){$Lr?this._type|=65536:this._type&=-65537}),$LO(0,$Li,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function($Lr){this.lineElement=!1,"right"===$Lr?this._type|=32768:this._type&=-32769}),$LO(0,$Li,"textDecoration",function(){return this._font.decoration},function($Lr){this._createFont().decoration=$Lr}),$LO(0,$Li,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function($Lr){"nowrap"===$Lr&&(this._type|=131072),"none"===$Lr&&(this._type&=-131073)}),$LO(0,$Li,"background",null,function($Lr){$Lr?(this._bgground||(this._bgground={}),this._bgground.color=$Lr,this._ower.conchModel&&this._ower.conchModel.bgColor($Lr),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),$LO(0,$Li,"wordWrap",function(){return 0==(131072&this._type)},function($Lr){$Lr?this._type&=-131073:this._type|=131072}),$LO(0,$Li,"color",function(){return this._font.color},function($Lr){this._createFont().color=$Lr}),$LO(0,$Li,"password",function(){return this._font.password},function($Lr){this._createFont().password=$Lr}),$LO(0,$Li,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function($Lr){"none"===$Lr?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=$Lr),this._ower.conchModel&&this._ower.conchModel.bgColor($Lr),this._ower._renderType|=256}),$LO(0,$Li,"font",function(){return this._font.toString()},function($Lr){this._createFont().set($Lr)}),$LO(0,$Li,"weight",null,function($Lr){this._createFont().weight=$Lr}),$LO(0,$Li,"letterSpacing",function(){return this._spacing[0]},function($Lr){"string"==typeof $Lr&&($Lr=parseInt($Lr+"")),this._spacing===$LX._SPACING&&(this._spacing=[0,0]),this._spacing[0]=$Lr}),$LO(0,$Li,"fontSize",function(){return this._font.size},function($Lr){this._createFont().size=$Lr}),$LO(0,$Li,"italic",function(){return this._font.italic},function($Lr){this._createFont().italic=$Lr}),$LO(0,$Li,"fontFamily",function(){return this._font.family},function($Lr){this._createFont().family=$Lr}),$LO(0,$Li,"stroke",function(){return this._font.stroke[0]},function($Lr){this._createFont().stroke===$Lv._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=$Lr}),$LO(0,$Li,"strokeColor",function(){return this._font.stroke[1]},function($Lr){this._createFont().stroke===$Lv._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=$Lr}),$LO(0,$Li,"border",function(){return this._border?this._border.value:""},function($Lr){if("none"!=$Lr){this._border||(this._border={});var $Li=(this._border.value=$Lr).split(" ");if(this._border.color=$L$.create($Li[$Li.length-1]),1==$Li.length)return this._border.size=1,void(this._border.type="solid");var $Lt=0;0<$Li[0].indexOf("px")?(this._border.size=parseInt($Li[0]),$Lt++):this._border.size=1,this._border.type=$Li[$Lt],this._ower._renderType|=256}else this._border=null}),$LO(0,$Li,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function($Lr){$Lr?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==$Lr?null:$L$.create($Lr),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),$LO(0,$Li,"position",function(){return 4&this._type?"absolute":""},function($Lr){"absolute"==$Lr?this._type|=4:this._type&=-5}),$LO(0,$Li,"display",null,function($Lr){switch($Lr){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),$LO(0,$Li,"paddingLeft",function(){return this.padding[3]}),$LO(0,$Li,"paddingTop",function(){return this.padding[0]}),$LO(0,$Li,"_scale",null,function($Lr){this._ower.scale($Lr[0],$Lr[1])}),$LO(0,$Li,"_rotate",null,function($Lr){this._ower.rotation=$Lr}),$LX.parseOneCSS=function($Lr,$Li){for(var $Lt,$L_=[],$LA=$Lr.split($Li),$Lf=0,$LE=$LA.length;$Lf<$LE;$Lf++){var $LG=$LA[$Lf],$LN=$LG.indexOf(":"),$Lp=$LG.substr(0,$LN).replace(/^\s+|\s+$/g,"");if(0!=$Lp.length){var $Lg=$LG.substr($LN+1).replace(/^\s+|\s+$/g,""),$LR=[$Lp,$Lg];switch($Lp){case"italic":case"bold":$LR[1]="true"==$Lg;break;case"line-height":$LR[0]="lineHeight",$LR[1]=parseInt($Lg);break;case"font-size":$LR[0]="fontSize",$LR[1]=parseInt($Lg);break;case"padding":1<($Lt=$Lg.split(" ")).length||($Lt[1]=$Lt[2]=$Lt[3]=$Lt[0]),$LR[1]=[parseInt($Lt[0]),parseInt($Lt[1]),parseInt($Lt[2]),parseInt($Lt[3])];break;case"rotate":$LR[0]="_rotate",$LR[1]=parseFloat($Lg);break;case"scale":$Lt=$Lg.split(" "),$LR[0]="_scale",$LR[1]=[parseFloat($Lt[0]),parseFloat($Lt[1])];break;case"translate":$Lt=$Lg.split(" "),$LR[0]="_translate",$LR[1]=[parseInt($Lt[0]),parseInt($Lt[1])];break;default:($LR[0]=$LX._CSSTOVALUE[$Lp])||($LR[0]=$Lp)}$L_.push($LR)}}return $L_},$LX.parseCSS=function($Lr,$Li){for(var $Lt;null!=($Lt=$LX._parseCSSRegExp.exec($Lr));)$LX.styleSheets[$Lt[1]]=$LX.parseOneCSS($Lt[2],";")},$LX.EMPTY=new $LX(null),$LX._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},$LX._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),$LX._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},$LX._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},$LX.styleSheets={},$LX.ALIGN_CENTER=1,$LX.ALIGN_RIGHT=2,$LX.VALIGN_MIDDLE=1,$LX.VALIGN_BOTTOM=2,$LX._CSS_BLOCK=1,$LX._DISPLAY_NONE=2,$LX._ABSOLUTE=4,$LX._WIDTH_SET=8,$LX._PADDING=[0,0,0,0],$LX._RECT=[-1,-1,-1,-1],$LX._SPACING=[0,0],$LX._ALIGNS=[0,0,0],$LX.ADDLAYOUTED=512,$LX._NEWFONT=4096,$LX._HEIGHT_SET=8192,$LX._BACKGROUND_SET=16384,$LX._FLOAT_RIGHT=32768,$LX._LINE_ELEMENT=65536,$LX._NOWARP=131072,$LX._WIDTHAUTO=262144,$LX._LISTERRESZIE=524288,$LX}($LG),$Ltr=function($Lr){function $LE(){this.url=null,this.audio=null,this.loaded=!1,$LE.__super.call(this)}$Lg($LE,"laya.media.h5audio.AudioSound",$Lp);var $Li=$LE.prototype;return $Li.dispose=function(){var $Lr=$LE._audioCache[this.url];$Lr&&($Lr.src="",delete $LE._audioCache[this.url])},$Li.load=function($Lr){var $Li;if($Lr=$LQ.formatURL($Lr),(this.url=$Lr)==$LU._tMusic?($LE._initMusicAudio(),($Li=$LE._musicAudio).src!=$Lr&&($LE._audioCache[$Li.src]=null,$Li=null)):$Li=$LE._audioCache[$Lr],$Li&&2<=$Li.readyState)this.event("complete");else{$Li||($Li=$Lr==$LU._tMusic?($LE._initMusicAudio(),$LE._musicAudio):$Lq.createElement("audio"),($LE._audioCache[$Lr]=$Li).src=$Lr),$Li.addEventListener("canplaythrough",$L_),$Li.addEventListener("error",$LA);var $Lt=this;(this.audio=$Li).load?$Li.load():$LA()}function $L_(){$Lf(),$Lt.loaded=!0,$Lt.event("complete")}function $LA(){$Li.load=null,$Lf(),$Lt.event("error")}function $Lf(){$Li.removeEventListener("canplaythrough",$L_),$Li.removeEventListener("error",$LA)}},$Li.play=function($Lr,$Li,$Lt){if(void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),!this.url)return null;var $L_,$LA;if(!($L_=this.url==$LU._tMusic?$LE._musicAudio:$LE._audioCache[this.url]))return null;$LA=$LJ.getItem("audio:"+this.url),$LF.isConchApp?$LA||(($LA=$Lq.createElement("audio")).src=this.url):this.url==$LU._tMusic?($LE._initMusicAudio(),($LA=$LE._musicAudio).src=this.url):$LA=$LA||$L_.cloneNode(!0);var $Lf=new $LXr($LA);return $Lf.url=this.url,$Lf.loops=$Li,$Lf.startTime=$Lr,$Lf.startHandler=$Lt,$Lf.play(!1),$LU.addChannel($Lf),$Lf},$LO(0,$Li,"duration",function(){var $Lr;return($Lr=$LE._audioCache[this.url])?$Lr.duration:0}),$LE._initMusicAudio=function(){$LE._musicAudio||($LE._musicAudio||($LE._musicAudio=$Lq.createElement("audio")),$LF.isConchApp||$Lq.document.addEventListener("mousedown",$LE._makeMusicOK))},$LE._makeMusicOK=function(){$Lq.document.removeEventListener("mousedown",$LE._makeMusicOK),$LE._musicAudio.src?$LE._musicAudio.play():($LE._musicAudio.src="",$LE._musicAudio.load())},$LE._audioCache={},$LE._musicAudio=null,$LE}(),$L_r=function($Lr){function $Li(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,$Li.__super.call(this)}$Lg($Li,"laya.media.SoundChannel",$Lp);var $Lt=$Li.prototype;return $Lt.play=function(){},$Lt.stop=function(){},$Lt.pause=function(){},$Lt.resume=function(){},$Lt.__runComplete=function($Lr){$Lr&&$Lr.run()},$LO(0,$Lt,"volume",function(){return 1},function($Lr){}),$LO(0,$Lt,"position",function(){return 0}),$LO(0,$Lt,"duration",function(){return 0}),$Li}(),$LAr=function($Lr){function $Li(){$Li.__super.call(this)}$Lg($Li,"laya.media.Sound",$Lp);var $Lt=$Li.prototype;return $Lt.load=function($Lr){},$Lt.play=function($Lr,$Li,$Lt){return void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),null},$Lt.dispose=function(){},$LO(0,$Lt,"duration",function(){return 0}),$Li}(),$Lfr=function($Lr){function $LA(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,$LA.__super.call(this)}$Lg($LA,"laya.media.webaudio.WebAudioSound",$Lp);var $Li=$LA.prototype;return $Li.load=function($Lr){this.url=$Lr,this.audioBuffer=$LA._dataCache[$Lr],this.audioBuffer?this._loaded(this.audioBuffer):($LA.e.on("loaded:"+$Lr,this,this._loaded),$LA.e.on("err:"+$Lr,this,this._err),$LA.__loadingSound[$Lr]||($LA.__loadingSound[$Lr]=!0,$Lw.loader.load($Lr,$LC.create(this,this.onloaded),null,$LGr.BUFFER,4,!1,null,!0)))},$Li.onloaded=function($Lr){$Lr||this._err(),this._disposed?this._removeLoadEvents():(this.data=$Lr,$LA.buffs.push({buffer:this.data,url:this.url}),$LA.decode())},$Li._err=function(){if(this._removeLoadEvents(),$LA.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var $Lr,$Li,$Lt,$L_=0;for($Lr=($Li=this.__toPlays).length,$L_=0;$L_<$Lr;$L_++)($Lt=$Li[$L_])[3]&&!$Lt[3].isStopped&&$Lt[3].event("error");this.__toPlays.length=0}},$Li._loaded=function($Lr){this._removeLoadEvents(),this._disposed||(this.audioBuffer=$Lr,this.loaded=!0,this.event("complete"))},$Li._removeLoadEvents=function(){$LA.e.off("loaded:"+this.url,this,this._loaded),$LA.e.off("err:"+this.url,this,this._err)},$Li.__playAfterLoaded=function(){if(this.__toPlays){var $Lr,$Li,$Lt,$L_=0;for($Lr=($Li=this.__toPlays).length,$L_=0;$L_<$Lr;$L_++)($Lt=$Li[$L_])[3]&&!$Lt[3].isStopped&&this.play($Lt[0],$Lt[1],$Lt[2],$Lt[3]);this.__toPlays.length=0}},$Li.play=function($Lr,$Li,$Lt,$L_){return void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),$L_=$L_||new $Lvr,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([$Lr,$Li,$Lt,$L_]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),$L_.url=this.url,$L_.loops=$Li,$L_.audioBuffer=this.audioBuffer,$L_.startTime=$Lr,$L_.startHandler=$Lt,$L_.play(!1),$LU.addChannel($L_),$L_},$Li.dispose=function(){this._disposed=!0,delete $LA._dataCache[this.url],delete $LA.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},$LO(0,$Li,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$LA.decode=function(){if(!($LA.buffs.length<=0||$LA.isDecoding))if($LA.isDecoding=!0,($LA.tInfo=$LA.buffs.shift())&&$LA.tInfo.buffer&&$LA.tInfo.buffer.byteLength)try{$LA.ctx.decodeAudioData($LA.tInfo.buffer,$LA._done,$LA._fail)}catch($Lr){console.error("decodeAudioData error  byteLength:"+$LA.tInfo.buffer.byteLength+"  url:"+$LA.tInfo.url)}else $LA._fail()},$LA._done=function($Lr){$LA.e.event("loaded:"+$LA.tInfo.url,$Lr),$LA._dataCache[$LA.tInfo.url]=$Lr,$LA.isDecoding=!1,$LA.decode()},$LA._fail=function(){$LA.e.event("err:"+$LA.tInfo.url,null),$LA.isDecoding=!1,$LA.decode()},$LA._playEmptySound=function(){if(null!=$LA.ctx){if($LA._emptySource&&($LA._emptySource.stop(),$LA._emptySource.disconnect(0),!$Lvr._tryCleanFailed))try{$LA._emptySource.buffer=null}catch($Lr){$Lvr._tryCleanFailed=!0}var $Lr=$LA.ctx.createBufferSource();$Lr.buffer=$LA._miniBuffer,$Lr.connect($LA.ctx.destination),$Lr.start(0,0,0),$LA._emptySource=$Lr}},$LA._unlock=function(){$LA._unlocked||($LA._playEmptySound(),"running"==$LA.ctx.state?($Lq.document.removeEventListener("mousedown",$LA._unlock,!0),$Lq.document.removeEventListener("touchend",$LA._unlock,!0),$Lq.document.removeEventListener("touchstart",$LA._unlock,!0),$LA._unlocked=!0):"suspended"==$LA.ctx.state&&$LU._recoverWebAudio())},$LA.initWebAudio=function(){"running"!=$LA.ctx.state&&($LA._unlock(),$Lq.document.addEventListener("mousedown",$LA._unlock,!0),$Lq.document.addEventListener("touchend",$LA._unlock,!0),$Lq.document.addEventListener("touchstart",$LA._unlock,!0))},$LA._emptySource=null,$LA._dataCache={},$LA.buffs=[],$LA.isDecoding=!1,$LA._unlocked=!1,$LA.tInfo=null,$LA.__loadingSound={},$LN($LA,["window",function(){return this.window=$Lq.window},"webAudioEnabled",function(){return this.webAudioEnabled=$LA.window.AudioContext||$LA.window.webkitAudioContext||$LA.window.mozAudioContext},"ctx",function(){return this.ctx=$LA.webAudioEnabled?new($LA.window.AudioContext||$LA.window.webkitAudioContext||$LA.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=$LA.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new $Lp}]),$LA}(),$LEr=function($Lr){function $Li(){this._responseType=null,this._data=null,$Li.__super.call(this),this._http=new $Lq.window.XMLHttpRequest}$Lg($Li,"laya.net.HttpRequest",$Lp);var $Lt=$Li.prototype;return $Lt.send=function($Lr,$Li,$Lt,$L_,$LA){void 0===$Lt&&($Lt="get"),void 0===$L_&&($L_="text"),this._responseType=$L_,this._data=null;var $Lf=this,$LE=this._http;if($LE.open($Lt,$Lr,!0),$LA)for(var $LG=0;$LG<$LA.length;$LG++)$LE.setRequestHeader($LA[$LG++],$LA[$LG]);else $LF.isConchApp||($Li&&"string"!=typeof $Li?$LE.setRequestHeader("Content-Type","application/json"):$LE.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));$LE.responseType="arraybuffer"!==$L_?"text":"arraybuffer",$LE.onerror=function($Lr){$Lf._onError($Lr)},$LE.onabort=function($Lr){$Lf._onAbort($Lr)},$LE.onprogress=function($Lr){$Lf._onProgress($Lr)},$LE.onload=function($Lr){$Lf._onLoad($Lr)},$LE.send($Li)},$Lt._onProgress=function($Lr){$Lr&&$Lr.lengthComputable&&this.event("progress",$Lr.loaded/$Lr.total)},$Lt._onAbort=function($Lr){this.error("Request was aborted by user")},$Lt._onError=function($Lr){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},$Lt._onLoad=function($Lr){var $Li=this._http,$Lt=void 0!==$Li.status?$Li.status:200;200===$Lt||204===$Lt||0===$Lt?this.complete():this.error("["+$Li.status+"]"+$Li.statusText+":"+$Li.responseURL)},$Lt.error=function($Lr){this.clear(),this.event("error",$Lr)},$Lt.complete=function(){this.clear();var $Li=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=$LK.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch($Lr){$Li=!1,this.error($Lr.message)}$Li&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},$Lt.clear=function(){var $Lr=this._http;$Lr.onerror=$Lr.onabort=$Lr.onprogress=$Lr.onload=null},$LO(0,$Lt,"url",function(){return this._http.responseURL}),$LO(0,$Lt,"http",function(){return this._http}),$LO(0,$Lt,"data",function(){return this._data}),$Li}(),$LGr=function($Lr){function $Ld(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,$Ld.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}$Lg($Ld,"laya.net.Loader",$Lp);var $Li=$Ld.prototype;return $Li.load=function($Lr,$Li,$Lt,$L_,$LA){if($Lr&&""!=$Lr||console.error("Loader 加载的url不合法 "+$Lr),void 0===$Lt&&($Lt=!0),void 0===$LA&&($LA=!1),0===(this._url=$Lr).indexOf("data:image")?this._type=$Li="image":this._type=$Li||($Li=this.getTypeFromUrl($Lr)),this._cache=$Lt,this._data=null,!$LA&&$Ld.loadedMap[$Lr])return this._data=$Ld.loadedMap[$Lr],this.event("progress",1),void this.event("complete",this._data);if($L_&&$Ld.setGroup($Lr,$L_),null!=$Ld.parserMap[$Li])return this._customParse=!0,void($Ld.parserMap[$Li]instanceof laya.utils.Handler?$Ld.parserMap[$Li].runWith(this):$Ld.parserMap[$Li].call(null,this));if("image"===$Li||"htmlimage"===$Li||"nativeimage"===$Li)return this._loadImage($Lr);if("ttf"===$Li)return this._loadTTF($Lr);switch($Li){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:$Li}$Ld.preLoadedMap[$Lr]?this.onLoaded($Ld.preLoadedMap[$Lr]):$LE.resMgrLoad($Lr,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},$Li.getTypeFromUrl=function($Lr){var $Li=$LK.getFileExtension($Lr);return $Li?$Ld.typeMap[$Li]:(console.warn("Not recognize the resources suffix",$Lr),"text")},$Li._loadTTF=function($Lr){$Lr=$LQ.formatURL($Lr);var $Li=new $LL;$Li.complete=$LC.create(this,this.onLoaded),$Li.load($Lr)},$Li._loadImage=function($Lr){$LE.imgMgrLoad($Lr,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},$Li._loadImageComplete=function($Lr,$Li,$Lt){if(null!=$Lt)if($Lt instanceof ArrayBuffer){var $L_=new DataView($Lt),$LA=new laya.webgl.resource.WebGLImage(new Uint8Array($Lt,8),$Lr,0,!1,$L_.getUint32(0),$L_.getUint32(4));this.onLoaded($LA)}else if($Lt instanceof $Lgr)$Ld.imgMgrSet[$Lr]=$Li,$LE.imgMgrLock($Lr,$Ld.imgMgrSet[$Lr]),this._url=$Lr,this.complete($Lt);else{var $Lf=-1!=$Lr.indexOf(".png",$Lr.length-4)?6408:6407;$LA=new laya.webgl.resource.WebGLImage($Lt,$Lr,$Lf,!1,$Lt.width,$Lt.height);this.onLoaded($LA)}else this.event("error","Load image failed")},$Li.imageCancel=function($Lr,$Li,$Lt){$LE.imgMgrCancel($Lr,this._onImageCallback)},$Li._loadSound=function($Lr){var $Li=new $LU._soundClass,$Lt=this;function $L_(){$Li.offAll()}$Li.on("complete",this,function(){$L_(),$Lt.onLoaded($Li)}),$Li.on("error",this,function(){$L_(),$Li.dispose(),$Lt.event("error","Load sound failed")}),$Li.load($Lr)},$Li.onProgress=function($Lr){"atlas"===this._type?this.event("progress",.3*$Lr):this.event("progress",$Lr)},$Li.onError=function($Lr){this.event("error",$Lr)},$Li._loadedComplete=function($Lr,$Li,$Lt){if(null!=$Lt)switch(this._type){case"atlas":case"plf":case"json":var $L_=new $Lm($Lt);this.onLoaded(JSON.parse($L_.readUTFBytes()));break;case"font":$L_=new $Lm($Lt);this.onLoaded($LK.parseXMLFromString($L_.readUTFBytes()));break;default:this.onLoaded($Lt)}else this.event("error",$Lr)},$Li.onLoaded=function($Lr){var $Li=this._type;if("plf"==$Li)this.parsePLFData($Lr),this.complete($Lr);else if("image"===$Li){var $Lt=new $Lgr($Lr);$Lt.url=this._url,this.complete($Lt)}else if("sound"===$Li||"htmlimage"===$Li||"nativeimage"===$Li)this.complete($Lr);else if("atlas"===$Li){if(!$Lr.src&&!$Lr._setContext){if(!this._data){if((this._data=$Lr).meta&&$Lr.meta.image)for(var $L_=$Lr.meta.image.split(","),$LA=0<=this._url.indexOf("/")?"/":"\\",$Lf=this._url.lastIndexOf($LA),$LE=0<=$Lf?this._url.substr(0,$Lf+1):"",$LG=0,$LN=$L_.length;$LG<$LN;$LG++)$L_[$LG]=$LE+$L_[$LG];else $L_=[this._url.replace(".json",".png")];$L_.reverse(),$Lr.toLoads=$L_,$Lr.pics=[]}return this.event("progress",.3+1/$L_.length*.6),this._loadImage($L_.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push($Lr),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var $Lp=this._data.frames,$Lg=this._url.split("?")[0],$LR=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:$Lg.substring(0,$Lg.lastIndexOf("."))+"/",$LX=this._data.pics,$Lv=$LQ.formatURL(this._url),$LO=$Ld.atlasMap[$Lv]||($Ld.atlasMap[$Lv]=[]);$LO.dir=$LR;var $Lc=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var $LB in $Lc=parseFloat(this._data.meta.scale),$Lp){var $Ly,$LC=$Lp[$LB],$Ln=$LX[$LC.frame.idx?$LC.frame.idx:0],$La=$LQ.formatURL($LR+$LB);$Ln.scaleRate=$Lc,$Ly=$Lgr.create($Ln,$LC.frame.x,$LC.frame.y,$LC.frame.w,$LC.frame.h,$LC.spriteSourceSize.x,$LC.spriteSourceSize.y,$LC.sourceSize.w,$LC.sourceSize.h),$Ld.cacheRes($La,$Ly),$Ld.keepCache(this._url,$LR+$LB),$Ly.url=$La,$LO.push($La)}else for($LB in $Lp)$Ln=$LX[($LC=$Lp[$LB]).frame.idx?$LC.frame.idx:0],$La=$LQ.formatURL($LR+$LB),$Ld.cacheRes($La,$Lgr.create($Ln,$LC.frame.x,$LC.frame.y,$LC.frame.w,$LC.frame.h,$LC.spriteSourceSize.x,$LC.spriteSourceSize.y,$LC.sourceSize.w,$LC.sourceSize.h)),$Ld.loadedMap[$La].url=$La,$Ld.keepCache(this._url,$LR+$LB),$LO.push($La);delete this._data.pics,this.complete(this._data)}else if("font"==$Li){if(!$Lr.src)return this._data=$Lr,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var $LD=new $Ll;$LD.parseFont(this._data,$Lr);var $Lu=this._url.split(".fnt")[0].split("/"),$Lw=$Lu[$Lu.length-1];$LBr.registerBitmapFont($Lw,$LD),this._data=$LD,this.complete(this._data)}else if("pkm"==$Li){var $LH=$Lur.create($Lr,this._url),$Ls=new $Lgr($LH);$Ls.url=this._url,this.complete($Ls)}else this.complete($Lr)},$Li.parsePLFData=function($Lr){var $Li,$Lt,$L_;for($Li in $Lr)switch($L_=$Lr[$Li],$Li){case"json":case"text":for($Lt in $L_)$Ld.preLoadedMap[$LQ.formatURL($Lt)]=$L_[$Lt];break;default:for($Lt in $L_)$Ld.preLoadedMap[$LQ.formatURL($Lt)]=$L_[$Lt]}},$Li.complete=function($Lr){this._data=$Lr,this._customParse?this.event("loaded",$Lr instanceof Array?[$Lr]:$Lr):($Ld._loaders.push(this),$Ld._isWorking||$Ld.checkNext())},$Li.endLoad=function($Lr){$Lr&&(this._data=$Lr),this._cache&&$Ld.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},$LO(0,$Li,"url",function(){return this._url}),$LO(0,$Li,"data",function(){return this._data}),$LO(0,$Li,"cache",function(){return this._cache}),$LO(0,$Li,"type",function(){return this._type}),$Ld.checkNext=function(){$Ld._isWorking=!0;for(var $Lr=$Lq.now();$Ld._startIndex<$Ld._loaders.length;)if($Lq.now(),$Ld._loaders[$Ld._startIndex].endLoad(),$Ld._startIndex++,$Lq.now()-$Lr>$Ld.maxTimeOut)return console.warn("loader callback cost a long time:"+($Lq.now()-$Lr)+" url="+$Ld._loaders[$Ld._startIndex-1].url),void $Lw.timer.frameOnce(1,null,$Ld.checkNext);$Ld._loaders.length=0,$Ld._startIndex=0,$Ld._isWorking=!1},$Ld.clearRes=function($Lr,$Li){if(null!=$Lr){void 0===$Li&&($Li=!1),$Lr=$LQ.formatURL($Lr);var $Lt=$Ld.getAtlas($Lr);if($Lt){for(var $L_=0,$LA=$Lt.length;$L_<$LA;$L_++){var $Lf=$Lt[$L_],$LE=$Ld.getRes($Lf);delete $Ld.loadedMap[$Lf],$Ld.clearCache($Lr.substring($LQ.basePath.length),$Lf.substring($LQ.basePath.length)),$LE&&$LE.destroy($Li)}$Lt.length=0,delete $Ld.atlasMap[$Lr],delete $Ld.loadedMap[$Lr]}else{var $LG=$Ld.loadedMap[$Lr];$LG&&(delete $Ld.loadedMap[$Lr],$LG instanceof laya.resource.Texture&&$LG.bitmap&&$LG.destroy($Li))}}},$Ld.clearTextureRes=function($Lr){$Lr=$LQ.formatURL($Lr);var $Li=laya.net.Loader.getAtlas($Lr),$Lt=$Li&&0<$Li.length?laya.net.Loader.getRes($Li[0]):laya.net.Loader.getRes($Lr);$Lt&&$Lt.bitmap&&($LF.isConchApp&&!$LF.isConchWebGL?$Lt.bitmap.source.releaseTexture&&$Lt.bitmap.source.releaseTexture():null==$Lt.bitmap._atlaser&&$Lt.bitmap.releaseResource(!0))},$Ld.getRes=function($Lr){return $Ld.loadedMap[$LQ.formatURL($Lr)]},$Ld.getAtlas=function($Lr){return $Ld.atlasMap[$LQ.formatURL($Lr)]},$Ld.cacheRes=function($Lr,$Li){$Lr=$LQ.formatURL($Lr),null!=$Ld.loadedMap[$Lr]?console.warn("Resources already exist,is repeated loading:",$Lr):$Ld.loadedMap[$Lr]=$Li},$Ld.setGroup=function($Lr,$Li){$Ld.groupMap[$Li]||($Ld.groupMap[$Li]=[]),$Ld.groupMap[$Li].push($Lr)},$Ld.clearResByGroup=function($Lr){if($Ld.groupMap[$Lr]){var $Li=$Ld.groupMap[$Lr],$Lt=0,$L_=$Li.length;for($Lt=0;$Lt<$L_;$Lt++)$Ld.clearRes($Li[$Lt]);$Li.length=0}},$Ld.keepCache=function($Lr,$Li){if($Lr&&$Li){var $Lt=$Ld.cacheSet[$Li];$Lt?-1==$Lt.indexOf($Lr)&&$Lt.push($Lr):$Ld.cacheSet[$Li]=[$Lr]}},$Ld.clearCache=function($Lr,$Li){if($Lr&&$Li){var $Lt=$Ld.cacheSet[$Li];if($Lt){var $L_=$Lt.indexOf($Lr);if(-1!==$L_){var $LA=$Lt.length-1;0==$LA?(delete $Ld.cacheSet[$Li],0<$Ld.imgMgrSet[$Li]?$LE.imgMgrFree($Li,$Ld.imgMgrSet[$Li]):$Ld.clearRes($Li,!0)):($Lt[$L_]=$Lt[$LA],$Lt.length=$LA)}}}},$Ld.saveObject=function($Lr,$Li,$Lt){if($Li&&$Lr){var $L_=$Ld.objectSet[$Lr];$L_?(console.warn("Loader.saveObject: "+$Lr),$L_[0]=$Li,$L_[1]=$Lt):$Ld.objectSet[$Lr]=[$Li,$Lt,[]]}},$Ld.findObject=function($Lr){if($Lr){var $Li=$Ld.objectSet[$Lr];if($Li)return $Li[0]}return null},$Ld.keepObject=function($Lr,$Li){if($Lr&&$Li){var $Lt=$Ld.objectSet[$Li];$Lt&&-1===$Lt[2].indexOf($Lr)&&$Lt[2].push($Lr)}},$Ld.clearObject=function($Lr,$Li){if($Lr&&$Li){var $Lt=$Ld.objectSet[$Li];if($Lt){var $L_=$Lt[2],$LA=$L_.indexOf($Lr);if(-1!==$LA){var $Lf=$L_.length-1;0==$Lf?(delete $Ld.objectSet[$Li],$Lt[1]&&$Lt[1].call(null,$Lt[0])):($L_[$LA]=$L_[$Lf],$L_.length=$Lf)}}}},$Ld.TEXT="text",$Ld.JSON="json",$Ld.XML="xml",$Ld.BUFFER="arraybuffer",$Ld.IMAGE="image",$Ld.SOUND="sound",$Ld.ATLAS="atlas",$Ld.FONT="font",$Ld.TTF="ttf",$Ld.PLF="plf",$Ld.PKM="pkm",$Ld.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},$Ld.parserMap={},$Ld.groupMap={},$Ld.maxTimeOut=100,$Ld.loadedMap={},$Ld.preLoadedMap={},$Ld.atlasMap={},$Ld._loaders=[],$Ld._isWorking=!1,$Ld._startIndex=0,$Ld.imgCache={},$Ld.cacheSet={},$Ld.objectSet={},$Ld.imgMgrSet={},$Ld}(),$LNr=function($Lr){var $LX;function $Lv(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},$Lv.__super.call(this);for(var $Lr=0;$Lr<this._maxPriority;$Lr++)this._resInfos[$Lr]=[]}$Lg($Lv,"laya.net.LoaderManager",$Lp);var $Li=$Lv.prototype;return $Li.create=function($Lr,$Lt,$Li,$L_,$LA,$Lf,$LE,$LG){if(null==$Lf&&($Lf=2),null==$LE&&($LE=!0),$Lr instanceof Array){var $LN=$Lr,$Lp=$LN.length,$Lg=0;if($Li)var $LR=$LC.create($Li.caller,$Li.method,$Li.args,!1);for(var $LX=0;$LX<$Lp;$LX++){var $Lv=$LN[$LX];"string"==typeof $Lv&&($Lv=$LN[$LX]={url:$Lv}),$Lv.progress=0}for($LX=0;$LX<$Lp;$LX++){$Lv=$LN[$LX];var $LO=$Li?$LC.create(null,$Ly,[$Lv],!1):null,$Lc=$Li||$Lt?$LC.create(null,$LB,[$Lv]):null;this._create($Lv.url,$Lc,$LO,$Lv.clas||$L_,$Lv.params||$LA,null!=$Lv.priority&&0<=$Lv.priority?$Lv.priority:$Lf,$LE,$Lv.group||$LG)}function $LB($Lr,$Li){$Lg++,$Lr.progress=1,$Lg===$Lp&&$Lt&&$Lt.run()}function $Ly($Lr,$Li){$Lr.progress=$Li;for(var $Lt=0,$L_=0;$L_<$Lp;$L_++){$Lt+=$LN[$L_].progress}var $LA=$Lt/$Lp;$LR.runWith($LA)}return!0}return this._create($Lr,$Lt,$Li,$L_,$LA,$Lf,$LE,$LG)},$Li._create=function($Li,$Lt,$Lr,$L_,$LA,$Lf,$LE,$LG){$Li&&""!=$Li||console.error("加载的url不合法 "+$Li),null==$Lf&&($Lf=2),null==$LE&&($LE=!0);var $LN=$LQ.formatURL($Li),$Lp=this.getRes($LN);if($Lp)!$Lp.hasOwnProperty("loaded")||$Lp.loaded?($Lr&&$Lr.runWith(1),$Lt&&$Lt.run()):$Lt&&$Lw.loader._createListener($Li,$Lt.caller,$Lt.method,$Lt.args,!0,!1);else{var $Lg=$LK.getFileExtension($Li),$LR=$Lv.createMap[$Lg];if(!$LR)throw new Error("LoaderManager:unknown file("+$Li+") extension with: "+$Lg+".");$L_||($L_=$LR[0]);var $LX=$LR[1];if("atlas"==$Lg)this.load($Li,$Lt,$Lr,$LX,$Lf,$LE);else{$L_===$Lgr&&($LX="htmlimage"),($Lp=$L_?new $L_:null).hasOwnProperty("_loaded")&&($Lp._loaded=!1),$Lp._setUrl($Li),$LG&&$Lp._setGroup($LG),this._createLoad($Lp,$Li,$LC.create(null,function($Lr){$Lp&&!$Lp.destroyed&&$Lr&&$Lp.onAsynLoaded.call($Lp,$Li,$Lr,$LA),$Lt&&$Lt.run();$Lw.loader.event($Li)}),$Lr,$LX,$Lf,!1,$LG,!0),$LE&&this.cacheRes($LN,$Lp)}}return $Lp},$Li.load=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){$Lr&&""!=$Lr||console.error("加载的url不合法 "+$Lr);var $LN=this;if(null==$LA&&($LA=2),null==$Lf&&($Lf=!0),void 0===$LG&&($LG=!1),$Lr instanceof Array)return this._loadAssets($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE);var $Lp=$LGr.getRes($Lr);if(null!=$Lp)$Lw.timer.frameOnce(1,null,function(){$Lt&&$Lt.runWith(1),$Li&&$Li.runWith($Lp),$LN._loaderCount||$LN.event("complete")});else{var $Lg=$Lv._resMap[$Lr];$Lg?($Li&&$Lg._createListener("complete",$Li.caller,$Li.method,$Li.args,!1,!1),$Lt&&$Lg._createListener("progress",$Lt.caller,$Lt.method,$Lt.args,!1,!1)):(($Lg=this._infoPool.length?this._infoPool.pop():new $LX).url=$Lr,$Lg.clas=null,$Lg.type=$L_,$Lg.cache=$Lf,$Lg.group=$LE,$Lg.ignoreCache=$LG,$Lg.priority=$LA,$Li&&$Lg.on("complete",$Li.caller,$Li.method,$Li.args),$Lt&&$Lg.on("progress",$Lt.caller,$Lt.method,$Lt.args),$Lv._resMap[$Lr]=$Lg,$LA=$LA<this._maxPriority?0<=$LA?$LA:0:this._maxPriority-1,this._resInfos[$LA].push($Lg),this._next())}return this},$Li.cancel=function($Lr,$Li,$Lt){if($Lp=$Lv._resMap[$Lr]){$Li&&$Lp.off("complete",$Li.caller,$Li.method,!1),$Lt&&$Lp.off("progress",$Lt.caller,$Lt.method,!1);var $L_=$Lp.getListener("complete"),$LA=$Lp.getListener("progress");if(!($L_&&$L_.head||$LA&&$LA.head)){if($Lp.loader){var $Lf=$Lp.loader;$Lf.imageCancel($Lr),$Lf.offAll(),$Lf._data=null,$Lf._customParse=!1,$Lf._url=null,$Lf._class=null,$Lf._type=null,this._loaders.push($Lf),this._loaderCount--,delete this._loaderMap[$Lp.url]}for(var $LE=0;$LE<this._maxPriority;$LE++)for(var $LG=this._resInfos[$LE],$LN=$LG.length-1;-1<$LN;$LN--){var $Lp;($Lp=$LG[$LN])&&$Lp.url===$Lr&&($LG[$LN]=null,$Lp.destroy(),$Lp.offAll(),this._infoPool.push($Lp))}delete $Lv._resMap[$Lr],this._next()}}},$Li._createLoad=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){var $Lp=this;if(null==$Lf&&($Lf=2),null==$LE&&($LE=!0),void 0===$LN&&($LN=!1),$Li instanceof Array)return this._loadAssets($Li,$Lt,$L_,$LA,$Lf,$LE,$LG);var $Lg=$LGr.getRes($Li);if(null!=$Lg)$Lw.timer.frameOnce(1,null,function(){$L_&&$L_.runWith(1),$Lt&&$Lt.runWith($Lg),$Lp._loaderCount||$Lp.event("complete")});else{var $LR=$Lv._resMap[$Li];$LR?($Lt&&$LR._createListener("complete",$Lt.caller,$Lt.method,$Lt.args,!1,!1),$L_&&$LR._createListener("progress",$L_.caller,$L_.method,$L_.args,!1,!1)):(($LR=this._infoPool.length?this._infoPool.pop():new $LX).url=$Li,$LR.clas=$Lr,$LR.type=$LA,$LR.cache=$LE,$LR.group=$LG,$LR.ignoreCache=$LN,$LR.priority=$Lf,$Lt&&$LR.on("complete",$Lt.caller,$Lt.method,$Lt.args),$L_&&$LR.on("progress",$L_.caller,$L_.method,$L_.args),$Lv._resMap[$Li]=$LR,$Lf=$Lf<this._maxPriority?0<=$Lf?$Lf:0:this._maxPriority-1,this._resInfos[$Lf].push($LR),this._next())}return this},$Li._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var $Lr=0;$Lr<this._maxPriority;$Lr++)for(var $Li=this._resInfos[$Lr];0<$Li.length;){var $Lt=$Li.shift();if($Lt)return this._doLoad($Lt)}this._loaderCount||this.event("complete")}},$Li._doLoad=function($Li){var $Lt=this._loaders.length?this._loaders.pop():new $LGr;this._loaderCount++,(this._loaderMap[$Li.url]=$Lt).on("complete",null,$LA),$Lt.on("progress",null,function($Lr){$Li.event("progress",$Lr)}),$Lt.on("error",null,function($Lr){$LA(null)}),$Li.loader=$Lt;var $L_=this;function $LA($Lr){$Lt.offAll(),$Lt._data=null,$Lt._customParse=!1,$Lt._url=null,$Lt._class=null,$Lt._type=null,$L_._loaders.push($Lt),$L_._loaderCount--,delete $L_._loaderMap[$Li.url],$L_._endLoad($Li,$Lr instanceof Array?[$Lr]:$Lr),$L_._next()}$Lt._class=$Li.clas,1<=$Li.priority?($Lt.priority=$Li.priority,$Lt.realTime=!1):($Lt.priority=0,$Lt.realTime=!0),$Lt.load($Li.url,$Li.type,$Li.cache,$Li.group,$Li.ignoreCache)},$Li._endLoad=function($Lr,$Li){var $Lt=$Lr.url;if(null==$Li){var $L_=this._failRes[$Lt]||0;if($L_<this.retryNum)return console.warn("[warn]Retry to load:",$Lt),this._failRes[$Lt]=$L_+1,void $Lw.timer.once(this.retryDelay,this,this._addReTry,[$Lr],!1);console.warn("[error]Failed to load:",$Lt),this.event("error",$Lt)}this._failRes[$Lt]&&(this._failRes[$Lt]=0),delete $Lv._resMap[$Lt],$Lr.event("complete",$Li),$Lr.destroy(),$Lr.offAll(),this._infoPool.push($Lr)},$Li._addReTry=function($Lr){this._resInfos[this._maxPriority-1].push($Lr),this._next()},$Li.clearRes=function($Lr,$Li){void 0===$Li&&($Li=!1),$LGr.clearRes($Lr,$Li)},$Li.getRes=function($Lr){return $LGr.getRes($Lr)},$Li.cacheRes=function($Lr,$Li){$LGr.cacheRes($Lr,$Li)},$Li.clearTextureRes=function($Lr){$LGr.clearTextureRes($Lr)},$Li.setGroup=function($Lr,$Li){$LGr.setGroup($Lr,$Li)},$Li.clearResByGroup=function($Lr){$LGr.clearResByGroup($Lr)},$Li.clearUnLoaded=function(){for(var $Lr=0;$Lr<this._maxPriority;$Lr++){for(var $Li=this._resInfos[$Lr],$Lt=$Li.length-1;-1<$Lt;$Lt--){var $L_=$Li[$Lt];$L_&&($L_.destroy(),$L_.offAll(),this._infoPool.push($L_))}$Li.length=0}this._loaderCount=0,$Lv._resMap={}},$Li.cancelLoadByUrls=function($Lr){if($Lr)for(var $Li=0,$Lt=$Lr.length;$Li<$Lt;$Li++)this.cancelLoadByUrl($Lr[$Li])},$Li.cancelLoadByUrl=function($Lr){for(var $Li=0;$Li<this._maxPriority;$Li++)for(var $Lt=this._resInfos[$Li],$L_=$Lt.length-1;-1<$L_;$L_--){var $LA=$Lt[$L_];$LA&&$LA.url===$Lr&&($Lt[$L_]=null,$LA.destroy(),$LA.offAll(),this._infoPool.push($LA))}$Lv._resMap[$Lr]&&delete $Lv._resMap[$Lr]},$Li._loadAssets=function($Lr,$Lt,$LE,$Li,$L_,$LA,$Lf){null==$L_&&($L_=2),null==$LA&&($LA=!0);for(var $LG=$Lr.length,$LN=0,$Lp=0,$Lg=[],$LR=!0,$LX=0;$LX<$LG;$LX++){var $Lv=$Lr[$LX];if(!$Lv)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+$Lr);"string"==typeof $Lv&&($Lv={url:$Lv,type:$Li,size:1,priority:$L_}),$Lv.size||($Lv.size=1),$Lv.progress=0,$Lp+=$Lv.size,$Lg.push($Lv);var $LO=$LE?$LC.create(null,$Ly,[$Lv],!1):null,$Lc=$Lt||$LE?$LC.create(null,$LB,[$Lv]):null;this.load($Lv.url,$Lc,$LO,$Lv.type,null!=$Lv.priority&&0<=$Lv.priority?$Lv.priority:2,$LA,$Lv.group||$Lf)}function $LB($Lr,$Li){$LN++,$Lr.progress=1,$Li||($LR=!1),$LN===$LG&&$Lt&&$Lt.runWith($LR)}function $Ly($Lr,$Li){if(null!=$LE){$Lr.progress=$Li;for(var $Lt=0,$L_=0;$L_<$Lg.length;$L_++){var $LA=$Lg[$L_];$Lt+=$LA.size*$LA.progress}var $Lf=$Lt/$Lp;$LE.runWith($Lf)}}return this},$Lv.cacheRes=function($Lr,$Li){$LGr.cacheRes($Lr,$Li)},$Lv._resMap={},$LN($Lv,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),$Lv.__init$=function(){$LX=function($Lr){function $Li(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,$Li.__super.call(this)}return $Lg($Li,"",$Lp),$Li.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},$Li}()},$Lv}(),$Lpr=(function($Lr){function $LA($Lr){$LA.__super.call(this),$Lr||($Lr=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var $Li=0,$Lt=0,$L_=0;$L_<20;$L_++)$L_%5!=4?this._mat[$Li++]=$Lr[$L_]:this._alpha[$Lt++]=$Lr[$L_];this._action=$Lk.createFilterAction(32),this._action.data=this}$Lg($LA,"laya.filters.ColorFilter",$Ly);var $Li=$LA.prototype;$Lw.imps($Li,{"laya.filters.IFilter":!0}),$Li.callNative=function($Lr){$Lr._$P.cf=this;$Lr.conchModel&&$Lr.conchModel.setFilterMatrix&&$Lr.conchModel.setFilterMatrix(this._mat,this._alpha)},$LO(0,$Li,"type",function(){return 32}),$LO(0,$Li,"action",function(){return this._action})}(),function($Lr){function $L_($Lr,$Li,$Lt){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===$Li&&($Li=0),$L_.__super.call(this),this._byteClass=$Lt||$Lm,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,$Lr&&0<$Li&&$Li<65535&&this.connect($Lr,$Li)}$Lg($L_,"laya.net.Socket",$Lp);var $Li=$L_.prototype;$Li.connect=function($Lr,$Li){var $Lt="ws://"+$Lr+":"+$Li;$Lt="https:"==$Lq.window.location.protocol?"wss://"+$Lr+":"+$Li:"ws://"+$Lr+":"+$Li,this.connectByUrl($Lt)},$Li.connectByUrl=function($Lr){var $Li=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new $Lq.window.WebSocket($Lr,this.protocols):this._socket=new $Lq.window.WebSocket($Lr),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function($Lr){$Li._onOpen($Lr)},this._socket.onmessage=function($Lr){$Li._onMessage($Lr)},this._socket.onclose=function($Lr){$Li._onClose($Lr)},this._socket.onerror=function($Lr){$Li._onError($Lr)}},$Li.cleanSocket=function(){try{this._socket.close()}catch($Lr){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},$Li.close=function(){if(null!=this._socket)try{this._socket.close()}catch($Lr){}},$Li._onOpen=function($Lr){this._connected=!0,this.event("open",$Lr)},$Li._onMessage=function($Lr){if($Lr&&$Lr.data){var $Li=$Lr.data;if(this.disableInput&&$Li)this.event("message",$Li);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var $Lt=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,$Li&&("string"==typeof $Li?this._input.writeUTFBytes($Li):this._input.writeArrayBuffer($Li),this._addInputPosition=this._input.pos,this._input.pos=$Lt),this.event("message",$Li)}}},$Li._onClose=function($Lr){this._connected=!1,this.event("close",$Lr)},$Li._onError=function($Lr){this.event("error",$Lr)},$Li.send=function($Lr){this._socket.send($Lr)},$Li.flush=function(){if(this._output&&0<this._output.length){var $Li;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch($Lr){$Li=$Lr}this._output.endian=this.endian,this._output.clear(),$Li&&this.event("error",$Li)}},$LO(0,$Li,"input",function(){return this._input}),$LO(0,$Li,"output",function(){return this._output}),$LO(0,$Li,"connected",function(){return this._connected}),$LO(0,$Li,"endian",function(){return this._endian},function($Lr){this._endian=$Lr,null!=this._input&&(this._input.endian=$Lr),null!=this._output&&(this._output.endian=$Lr)}),$L_.LITTLE_ENDIAN="littleEndian",$L_.BIG_ENDIAN="bigEndian"}(),function($Lr){function $LG(){$LG.__super.call(this),this._$1__id=++$LG._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,($LG._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,$LP.currentResourceManager&&$LP.currentResourceManager.addResource(this)}$Lg($LG,"laya.resource.Resource",$Lp);var $Li=$LG.prototype;return $Lw.imps($Li,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),$Li._setUrl=function($Lr){var $Li;this._url!==$Lr&&(this._url&&(($Li=$LG._urlResourcesMap[this._url]).splice($Li.indexOf(this),1),0===$Li.length&&delete $LG._urlResourcesMap[this._url]),$Lr&&(($Li=$LG._urlResourcesMap[$Lr])||($LG._urlResourcesMap[$Lr]=$Li=[]),$Li.push(this)),this._url=$Lr)},$Li._getGroup=function(){return this._group},$Li._setGroup=function($Lr){var $Li;this._group!==$Lr&&(this._group&&(($Li=$LG._groupResourcesMap[this._group]).splice($Li.indexOf(this),1),0===$Li.length&&delete $LG._groupResourcesMap[this._group]),$Lr&&(($Li=$LG._groupResourcesMap[$Lr])||($LG._groupResourcesMap[$Lr]=$Li=[]),$Li.push(this)),this._group=$Lr)},$Li._addReference=function(){this._referenceCount++},$Li._removeReference=function(){this._referenceCount--},$Li._clearReference=function(){this._referenceCount=0},$Li._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},$Li.recreateResource=function(){this.completeCreate()},$Li.disposeResource=function(){},$Li.activeResource=function($Lr){void 0===$Lr&&($Lr=!1),this._lastUseFrameCount=$LZ.loopCount,!this._destroyed&&this.__loaded&&(this._released||$Lr)&&this.recreateResource()},$Li.releaseResource=function($Lr){return void 0===$Lr&&($Lr=!0),!(!$Lr&&this.lock)&&(!(this._released&&!$Lr)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},$Li.onAsynLoaded=function($Lr,$Li,$Lt){throw new Error("Resource: must override this function!")},$Li.destroy=function(){var $Lr;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete $LG._idResourcesMap[this.id],this._url&&(($Lr=$LG._urlResourcesMap[this._url])&&($Lr.splice($Lr.indexOf(this),1),0===$Lr.length&&delete $LG._urlResourcesMap[this.url]),$LGr.clearRes(this._url),this.__loaded||$Lk.cancelLoadByUrl(this._url)),this._group&&(($Lr=$LG._groupResourcesMap[this._group]).splice($Lr.indexOf(this),1),0===$Lr.length&&delete $LG._groupResourcesMap[this.url]))},$Li.completeCreate=function(){this._released=!1,this.event("recovered",this)},$Li.dispose=function(){this.destroy()},$LO(0,$Li,"memorySize",function(){return this._memorySize},function($Lr){var $Li=$Lr-this._memorySize;this._memorySize=$Lr,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,$Li),this.resourceManager&&this.resourceManager.addSize($Li)}),$LO(0,$Li,"_loaded",null,function($Lr){this.__loaded=$Lr}),$LO(0,$Li,"loaded",function(){return this.__loaded}),$LO(0,$Li,"id",function(){return this._$1__id}),$LO(0,$Li,"destroyed",function(){return this._destroyed}),$LO(0,$Li,"group",function(){return this._getGroup()},function($Lr){this._setGroup($Lr)}),$LO(0,$Li,"resourceManager",function(){return this._resourceManager}),$LO(0,$Li,"url",function(){return this._url}),$LO(0,$Li,"released",function(){return this._released}),$LO(0,$Li,"referenceCount",function(){return this._referenceCount}),$LG.getResourceByID=function($Lr){return $LG._idResourcesMap[$Lr]},$LG.getResourceByURL=function($Lr,$Li){return void 0===$Li&&($Li=0),null==$LG._urlResourcesMap[$Lr]?null:$LG._urlResourcesMap[$Lr][$Li]},$LG.getResourceCountByURL=function($Lr){return $LG._urlResourcesMap[$Lr].length},$LG.destroyUnusedResources=function($Lr){var $Li;if($Lr){var $Lt=$LG._groupResourcesMap[$Lr];if($Lt)for(var $L_=$Lt.slice(),$LA=0,$Lf=$L_.length;$LA<$Lf;$LA++)($Li=$L_[$LA]).lock||0!==$Li._referenceCount||$Li.destroy()}else for(var $LE in $LG._idResourcesMap)($Li=$LG._idResourcesMap[$LE]).lock||0!==$Li._referenceCount||$Li.destroy()},$LG._uniqueIDCounter=0,$LG._idResourcesMap={},$LG._urlResourcesMap={},$LG._groupResourcesMap={},$LG}()),$Lgr=function($Lr){function $Ld($Lr,$Li){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,$Ld.__super.call(this),$Lr&&null!=$Lr._addReference&&$Lr._addReference(),this.setTo($Lr,$Li)}$Lg($Ld,"laya.resource.Texture",$Lp);var $Li=$Ld.prototype;return $Li._setUrl=function($Lr){this.url=$Lr},$Li.setTo=function($Lr,$Li){if($Lr instanceof $LE.HTMLElement){var $Lt=$Lnr.create("2D",$Lr);this.bitmap=$Lt}else this.bitmap=$Lr;if(this.uv=$Li||$Ld.DEF_UV,$Lr){this._w=$Lr.width,this._h=$Lr.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var $L_=this;if(this._loaded)$Lk.addToAtlas&&$Lk.addToAtlas($L_);else{var $LA=$Lr;$LA instanceof laya.resource.HTMLImage&&$LA.image&&$LA.image.addEventListener("load",function($Lr){$Lk.addToAtlas&&$Lk.addToAtlas($L_)},!1)}}},$Li.active=function(){this.bitmap&&this.bitmap.activeResource()},$Li.destroy=function($Lr){if(void 0===$Lr&&($Lr=!1),this.alphaTexture&&(this.alphaTexture.destroy($Lr),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var $Li=this.bitmap;$Lr?($LF.isConchApp&&$Li.source&&$Li.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$Li.dispose(),$Li._clearReference()):($Li._removeReference(),0==$Li.referenceCount&&($LF.isConchApp&&$Li.source&&$Li.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$Li.dispose())),this.url&&this===$Lw.loader.getRes(this.url)&&$Lw.loader.clearRes(this.url,$Lr),this._loaded=!1}},$Li.load=function($Lr){var $Li=this;this._loaded=!1,$Lr=$LQ.customFormat($Lr);var $Lt=this.bitmap||(this.bitmap=$Lur.create($Lr));$Lt.uri=$Lr,$Lt&&$Lt._addReference();var $L_=this;$Lt.onload=function(){$Lt.onload=null,$L_._loaded=!0,$Li.sourceWidth=$Li._w=$Lt.width,$Li.sourceHeight=$Li._h=$Lt.height,$L_.event("loaded",this),$Lk.addToAtlas&&$Lk.addToAtlas($L_)}},$Li.addTextureToAtlas=function($Lr){$Lk.addTextureToAtlas(this)},$Li.getPixels=function($Lr,$Li,$Lt,$L_){if($LF.isConchApp){var $LA=this.bitmap;if($LA.source&&$LA.source.getImageData){var $Lf=$LA.source.getImageData($Lr,$Li,$Lt,$L_),$LE=new Uint8Array($Lf);return Array.from($LE)}return null}return $LF.isWebGL?$Lk.getTexturePixels(this,$Lr,$Li,$Lt,$L_):($Lq.canvas.size($Lt,$L_),$Lq.canvas.clear(),$Lq.context.drawTexture(this,-$Lr,-$Li,this.width,this.height,0,0),$Lq.context.getImageData(0,0,$Lt,$L_).data)},$Li.onAsynLoaded=function($Lr,$Li){if($Li){if("function"!=typeof $Li._addReference)throw new Error("bitmap._addReference is not a function. "+$Li.className+" "+typeof $Li._addReference+" "+$Li.constructor);$Li._addReference()}this.setTo($Li,this.uv),this._loaded&&this.event("loaded",this)},$LO(0,$Li,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),$LO(0,$Li,"loaded",function(){return this._loaded}),$LO(0,$Li,"released",function(){return!this.bitmap||this.bitmap.released}),$LO(0,$Li,"width",function(){return this._w?this._w:this.uv&&this.uv!==$Ld.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function($Lr){this._w=$Lr,this.sourceWidth||(this.sourceWidth=$Lr)}),$LO(0,$Li,"repeat",function(){return!$LF.isWebGL||!this.bitmap||this.bitmap.repeat},function($Lr){$Lr&&$LF.isWebGL&&this.bitmap&&(this.bitmap.repeat=$Lr)&&(this.bitmap.enableMerageInAtlas=!1)}),$LO(0,$Li,"height",function(){return this._h?this._h:this.uv&&this.uv!==$Ld.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function($Lr){this._h=$Lr,this.sourceHeight||(this.sourceHeight=$Lr)}),$LO(0,$Li,"isLinearSampling",function(){return!$LF.isWebGL||9728!=this.bitmap.minFifter},function($Lr){!$Lr&&$LF.isWebGL&&($Lr||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),$Ld.moveUV=function($Lr,$Li,$Lt){for(var $L_=0;$L_<8;$L_+=2)$Lt[$L_]+=$Lr,$Lt[$L_+1]+=$Li;return $Lt},$Ld.create=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){void 0===$Lf&&($Lf=0),void 0===$LE&&($LE=0),void 0===$LG&&($LG=0),void 0===$LN&&($LN=0);var $Lp=$Lr instanceof laya.resource.Texture,$Lg=$Lp?$Lr.uv:$Ld.DEF_UV,$LR=$Lp?$Lr.bitmap:$Lr,$LX=$Lk.isAtlas($LR);if($LX){var $Lv=$LR._atlaser,$LO=$Lr._atlasID;if(-1==$LO)throw new Error("create texture error");$LR=$Lv._inAtlasTextureBitmapValue[$LO],$Lg=$Lv._inAtlasTextureOriUVValue[$LO]}var $Lc=new $Ld($LR,null);$LR.width&&$Li+$L_>$LR.width&&($L_=$LR.width-$Li),$LR.height&&$Lt+$LA>$LR.height&&($LA=$LR.height-$Lt),$Lc.width=$L_,$Lc.height=$LA,$Lc.offsetX=$Lf,$Lc.offsetY=$LE,$Lc.sourceWidth=$LG||$L_,$Lc.sourceHeight=$LN||$LA;var $LB=1/$LR.width,$Ly=1/$LR.height;$Li*=$LB,$Lt*=$Ly,$L_*=$LB,$LA*=$Ly;var $LC=$Lc.uv[0],$Ln=$Lc.uv[1],$La=$Lc.uv[4],$LD=$Lc.uv[5],$Lu=$La-$LC,$Lw=$LD-$Ln,$LH=$Ld.moveUV($Lg[0],$Lg[1],[$Li,$Lt,$Li+$L_,$Lt,$Li+$L_,$Lt+$LA,$Li,$Lt+$LA]);$Lc.uv=[$LC+$LH[0]*$Lu,$Ln+$LH[1]*$Lw,$La-(1-$LH[2])*$Lu,$Ln+$LH[3]*$Lw,$La-(1-$LH[4])*$Lu,$LD-(1-$LH[5])*$Lw,$LC+$LH[6]*$Lu,$LD-(1-$LH[7])*$Lw],$LX&&$Lc.addTextureToAtlas();var $Ls=$LR.scaleRate;return $Ls&&1!=$Ls?($Lc.sourceWidth/=$Ls,$Lc.sourceHeight/=$Ls,$Lc.width/=$Ls,$Lc.height/=$Ls,$Lc.scaleRate=$Ls,$Lc.offsetX/=$Ls,$Lc.offsetY/=$Ls):$Lc.scaleRate=1,$Lc},$Ld.createFromTexture=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Lr.scaleRate;1!=$Lf&&($Li*=$Lf,$Lt*=$Lf,$L_*=$Lf,$LA*=$Lf);var $LE=$Ls.TEMP.setTo($Li-$Lr.offsetX,$Lt-$Lr.offsetY,$L_,$LA),$LG=$LE.intersection($Ld._rect1.setTo(0,0,$Lr.width,$Lr.height),$Ld._rect2);if(!$LG)return null;var $LN=$Ld.create($Lr,$LG.x,$LG.y,$LG.width,$LG.height,$LG.x-$LE.x,$LG.y-$LE.y,$L_,$LA);if($LN.bitmap&&$LN.bitmap._removeReference)return $LN.bitmap._removeReference(),$LN;var $Lp="bitmap:"+($LN.bitmap?$LN.bitmap.constructor?$LN.bitmap.constructor.name:$LN.bitmap.__className:"")+", url:"+($Lr.url+" | "+($LN.bitmap?$LN.bitmap.url:$Lr.url))+", x="+$Li+",y="+$Lt+",width="+$L_+",height="+$LA+", result="+($LG?$LG.x+","+$LG.y+","+$LG.width+","+$LG.height:"null")+", rect="+$LE.x+","+$LE.y+","+$LE.width+","+$LE.height;throw new Error("报错：bitmap._removeReference is not a function  "+$Lp)},$Ld.DEF_UV=[0,0,1,0,1,1,0,1],$Ld.INV_UV=[0,1,1,1,1,0,0,0],$Ld._rect1=new $Ls,$Ld._rect2=new $Ls,$Ld}(),$Lr=function($Lr){var $LG;function $Lf(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,$Lf.__super.call(this)}$Lg($Lf,"laya.utils.TimeLine",$Lp);var $Li=$Lf.prototype;return $Li.to=function($Lr,$Li,$Lt,$L_,$LA){return void 0===$LA&&($LA=0),this._create($Lr,$Li,$Lt,$L_,$LA,!0)},$Li.from=function($Lr,$Li,$Lt,$L_,$LA){return void 0===$LA&&($LA=0),this._create($Lr,$Li,$Lt,$L_,$LA,!1)},$Li._create=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=$LJ.getItemByClass("tweenData",$LG);return $LE.isTo=$Lf,$LE.type=0,$LE.target=$Lr,$LE.duration=$Lt,$LE.data=$Li,$LE.startTime=this._startTime+$LA,$LE.endTime=$LE.startTime+$LE.duration,$LE.ease=$L_,this._startTime=Math.max($LE.endTime,this._startTime),this._tweenDataList.push($LE),this._startTimeSort=!0,this._endTimeSort=!0,this},$Li.addLabel=function($Lr,$Li){var $Lt=$LJ.getItemByClass("tweenData",$LG);return $Lt.type=1,$Lt.data=$Lr,$Lt.endTime=$Lt.startTime=this._startTime+$Li,this._labelDic||(this._labelDic={}),this._labelDic[$Lr]=$Lt,this._tweenDataList.push($Lt),this},$Li.removeLabel=function($Lr){if(this._labelDic&&this._labelDic[$Lr]){var $Li=this._labelDic[$Lr];if($Li){var $Lt=this._tweenDataList.indexOf($Li);-1<$Lt&&this._tweenDataList.splice($Lt,1)}delete this._labelDic[$Lr]}},$Li.gotoTime=function($Lr){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var $Li,$Lt,$L_,$LA;for(var $Lf in this._firstTweenDic)if($Lt=this._firstTweenDic[$Lf])for(var $LE in $Lt)$Lt.diyTarget.hasOwnProperty($LE)&&($Lt.diyTarget[$LE]=$Lt[$LE]);for($Lf in this._tweenDic)($Li=this._tweenDic[$Lf]).clear(),delete this._tweenDic[$Lf];if(this._index=0,this._gidIndex=0,this._currTime=$Lr,this._lastTime=$Lq.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=$L_=this._tweenDataList.concat(),$L_.sort(function($Lr,$Li){return $Lr.endTime>$Li.endTime?1:$Lr.endTime<$Li.endTime?-1:0})}else $L_=this._endTweenDataList;for(var $LG=0,$LN=$L_.length;$LG<$LN;$LG++)if(0==($LA=$L_[$LG]).type){if(!($Lr>=$LA.endTime))break;this._index=Math.max(this._index,$LG+1);var $Lp=$LA.data;if($LA.isTo)for(var $Lg in $Lp)$LA.target[$Lg]=$Lp[$Lg]}for($LG=0,$LN=this._tweenDataList.length;$LG<$LN;$LG++)0==($LA=this._tweenDataList[$LG]).type&&$Lr>=$LA.startTime&&$Lr<$LA.endTime&&(this._index=Math.max(this._index,$LG+1),this._gidIndex++,($Li=$LJ.getItemByClass("tween",$LM))._create($LA.target,$LA.data,$LA.duration,$LA.ease,$LC.create(this,this._animComplete,[this._gidIndex]),0,!1,$LA.isTo,!0,!1),$Li.setStartTime(this._currTime-($Lr-$LA.startTime)),$Li._updateEase(this._currTime),$Li.gid=this._gidIndex,this._tweenDic[this._gidIndex]=$Li)}},$Li.gotoLabel=function($Lr){if(null!=this._labelDic){var $Li=this._labelDic[$Lr];$Li&&this.gotoTime($Li.startTime)}},$Li.pause=function(){$Lw.timer.clear(this,this._update)},$Li.resume=function(){this.play(this._currTime,this._loopKey)},$Li.play=function($Lr,$Li){if(void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function($Lr,$Li){return $Lr.startTime>$Li.startTime?1:$Lr.startTime<$Li.startTime?-1:0});for(var $Lt=0,$L_=this._tweenDataList.length;$Lt<$L_;$Lt++){var $LA=this._tweenDataList[$Lt];if(null!=$LA&&0==$LA.type){var $Lf=$LA.target,$LE=$Lf.$_GID||($Lf.$_GID=$LK.getGID()),$LG=null;for(var $LN in null==this._firstTweenDic[$LE]?(($LG={}).diyTarget=$Lf,this._firstTweenDic[$LE]=$LG):$LG=this._firstTweenDic[$LE],$LA.data)null==$LG[$LN]&&($LG[$LN]=$Lf[$LN])}}}"string"==typeof $Lr?this.gotoLabel($Lr):this.gotoTime($Lr),this._loopKey=$Li,this._lastTime=$Lq.now(),$Lw.timer.frameLoop(1,this,this._update)}},$Li._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var $Lr in this._tweenDic)($Li=this._tweenDic[$Lr]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var $Li,$Lt=$Lq.now(),$L_=$Lt-this._lastTime,$LA=this._currTime+=$L_*this.scale;for($Lr in this._lastTime=$Lt,this._tweenDic)($Li=this._tweenDic[$Lr])._updateEase($LA);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var $Lf=this._tweenDataList[this._index];$LA>=$Lf.startTime&&(this._index++,0==$Lf.type?(this._gidIndex++,($Li=$LJ.getItemByClass("tween",$LM))._create($Lf.target,$Lf.data,$Lf.duration,$Lf.ease,$LC.create(this,this._animComplete,[this._gidIndex]),0,!1,$Lf.isTo,!0,!1),$Li.setStartTime($LA),$Li.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=$Li)._updateEase($LA)):this.event("label",$Lf.data))}},$Li._animComplete=function($Lr){this._tweenDic[$Lr]&&delete this._tweenDic[$Lr]},$Li._complete=function(){this.event("complete")},$Li.reset=function(){var $Lr;if(this._labelDic)for($Lr in this._labelDic)delete this._labelDic[$Lr];for($Lr in this._tweenDic)this._tweenDic[$Lr].clear(),delete this._tweenDic[$Lr];for($Lr in this._firstTweenDic)delete this._firstTweenDic[$Lr];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var $Li,$Lt=0;for($Li=this._tweenDataList.length,$Lt=0;$Lt<$Li;$Lt++)this._tweenDataList[$Lt]&&this._tweenDataList[$Lt].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,$Lw.timer.clear(this,this._update)},$Li.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},$LO(0,$Li,"index",function(){return this._frameIndex},function($Lr){this._frameIndex=$Lr,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),$LO(0,$Li,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),$Lf.to=function($Lr,$Li,$Lt,$L_,$LA){return void 0===$LA&&($LA=0),(new $Lf).to($Lr,$Li,$Lt,$L_,$LA)},$Lf.from=function($Lr,$Li,$Lt,$L_,$LA){return void 0===$LA&&($LA=0),(new $Lf).from($Lr,$Li,$Lt,$L_,$LA)},$Lf.__init$=function(){$LG=function(){function $Lr(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return $Lg($Lr,""),$Lr.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,$LJ.recover("tweenData",this)},$Lr}()},$Lf}(),$LRr=function($LA){function $Lt(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,$Lt.__super.call(this),this._style=$LG.EMPTY}$Lg($Lt,"laya.display.Sprite",$LA);var $Lr=$Lt.prototype;return $Lw.imps($Lr,{"laya.display.ILayout":!0}),$Lr.createConchModel=function(){return new ConchNode},$Lr.destroy=function($Lr){if(void 0===$Lr&&($Lr=!0),this._releaseMem(),!this._destroyed){this.filters=null;var $Li=this.mask;$Li&&(this.mask=null,$Li.destroy($Lr))}$LA.prototype.destroy.call(this,$Lr),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},$Lr.updateZOrder=function(){$LK.updateOrder(this._childs)&&this.repaint()},$Lr.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},$Lr.setBounds=function($Lr){this._set$P("uBounds",$Lr)},$Lr.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new $Ls),$Ls._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},$Lr.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new $Ls),$Ls._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},$Lr._boundPointsToParent=function($Lr){void 0===$Lr&&($Lr=!1);var $Li=0,$Lt=0;this._style&&($Li=this._style._tf.translateX,$Lt=this._style._tf.translateY,$Lr=$Lr||0!==this._style._tf.rotate,this._style.scrollRect&&($Li+=this._style.scrollRect.x,$Lt+=this._style.scrollRect.y));var $L_=this._getBoundPointsM($Lr);if(!$L_||$L_.length<1)return $L_;if(8!=$L_.length&&($L_=$Lr?$LD.scanPList($L_):$Ls._getWrapRec($L_,$Ls.TEMP)._getBoundPoints()),!this.transform)return $LK.transPointList($L_,this._x-$Li,this._y-$Lt),$L_;var $LA=$LH.TEMP,$Lf=0,$LE=$L_.length;for($Lf=0;$Lf<$LE;$Lf+=2)$LA.x=$L_[$Lf],$LA.y=$L_[$Lf+1],this.toParentPoint($LA),$L_[$Lf]=$LA.x,$L_[$Lf+1]=$LA.y;return $L_},$Lr.getGraphicBounds=function($Lr){return void 0===$Lr&&($Lr=!1),this._graphics?this._graphics.getBounds($Lr):$Ls.TEMP.setTo(0,0,0,0)},$Lr._getBoundPointsM=function($Lr){if(void 0===$Lr&&($Lr=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var $Li=$LK.clearArray(this._$P.temBM),$Lt=$Ls.TEMP;return $Lt.copyFrom(this.scrollRect),$LK.concatArray($Li,$Lt._getBoundPoints()),$Li}for(var $L_,$LA,$Lf,$LE=this._graphics?this._graphics.getBoundPoints():$LK.clearArray(this._$P.temBM),$LG=0,$LN=($Lf=this._childs).length;$LG<$LN;$LG++)($L_=$Lf[$LG])instanceof laya.display.Sprite&&1==$L_.visible&&($LA=$L_._boundPointsToParent($Lr))&&($LE=$LE?$LK.concatArray($LE,$LA):$LA);return $LE},$Lr.getStyle=function(){return this._style===$LG.EMPTY&&(this._style=new $LG),this._style},$Lr.setStyle=function($Lr){this._style=$Lr},$Lr._adjustTransform=function(){this._tfChanged=!1;var $Lr,$Li=this._style._tf,$Lt=$Li.scaleX,$L_=$Li.scaleY;if($Li.rotate||1!==$Lt||1!==$L_||$Li.skewX||$Li.skewY){($Lr=this._transform||(this._transform=$Le.create())).bTransform=!0;var $LA=.0174532922222222*($Li.rotate-$Li.skewX),$Lf=.0174532922222222*($Li.rotate+$Li.skewY),$LE=Math.cos($Lf),$LG=Math.sin($Lf),$LN=Math.sin($LA),$Lp=Math.cos($LA);return $Lr.a=$Lt*$LE,$Lr.b=$Lt*$LG,$Lr.c=-$L_*$LN,$Lr.d=$L_*$Lp,$Lr.tx=$Lr.ty=0,$Lr}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,$Lr},$Lr.pos=function($Lr,$Li,$Lt){if(void 0===$Lt&&($Lt=!1),this._x!==$Lr||this._y!==$Li){if(this.destroyed)return this;if($Lt){this._x=$Lr,this._y=$Li,this.conchModel&&this.conchModel.pos(this._x,this._y);var $L_=this._parent;$L_&&0===$L_._repaint&&($L_._repaint=1,$L_.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=$Lr,this.y=$Li}return this},$Lr.pivot=function($Lr,$Li){return this.pivotX=$Lr,this.pivotY=$Li,this},$Lr.size=function($Lr,$Li){return this.width=$Lr,this.height=$Li,this},$Lr.scale=function($Lr,$Li,$Lt){void 0===$Lt&&($Lt=!1);var $L_=this.getStyle(),$LA=$L_._tf;if($LA.scaleX!=$Lr||$LA.scaleY!=$Li){if(this.destroyed)return this;if($Lt){$L_.setScale($Lr,$Li),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($Lr,$Li),this._renderType|=4;var $Lf=this._parent;$Lf&&0===$Lf._repaint&&($Lf._repaint=1,$Lf.parentRepaint())}else this.scaleX=$Lr,this.scaleY=$Li}return this},$Lr.skew=function($Lr,$Li){return this.skewX=$Lr,this.skewY=$Li,this},$Lr.render=function($Lr,$Li,$Lt){$LZ.spriteCount++,$LV.renders[this._renderType]._fun(this,$Lr,$Li+this._x,$Lt+this._y),this._repaint=0},$Lr.drawToCanvas=function($Lr,$Li,$Lt,$L_){if($LF.isConchNode){var $LA=$Lnr.create("2D");return new $Lb($Lr,$Li,$LA).ctx.setCanvasType(1),this.conchModel.drawToCanvas($LA.source,$Lt,$L_),$LA}return $Lk.drawToCanvas(this,this._renderType,$Lr,$Li,$Lt,$L_)},$Lr.customRender=function($Lr,$Li,$Lt){this._renderType|=1024},$Lr._applyFilters=function(){var $Lr;if(!$LF.isWebGL&&(($Lr=this._$P.filters)&&!($Lr.length<1)))for(var $Li=0,$Lt=$Lr.length;$Li<$Lt;$Li++)$Lr[$Li].action.apply(this._$P.cacheCanvas)},$Lr._isHaveGlowFilter=function(){var $Lr,$Li=0;if(this.filters)for($Li=0;$Li<this.filters.length;$Li++)if(8==this.filters[$Li].type)return!0;for($Li=0,$Lr=this._childs.length;$Li<$Lr;$Li++)if(this._childs[$Li]._isHaveGlowFilter())return!0;return!1},$Lr.localToGlobal=function($Lr,$Li){void 0===$Li&&($Li=!1),!0===$Li&&($Lr=new $LH($Lr.x,$Lr.y));for(var $Lt=this;$Lt&&$Lt!=$Lw.stage;)$Lr=$Lt.toParentPoint($Lr),$Lt=$Lt.parent;return $Lr},$Lr.globalToLocal=function($Lr,$Li){void 0===$Li&&($Li=!1),$Li&&($Lr=new $LH($Lr.x,$Lr.y));for(var $Lt=this,$L_=[];$Lt&&$Lt!=$Lw.stage;)$L_.push($Lt),$Lt=$Lt.parent;for(var $LA=$L_.length-1;0<=$LA;)$Lr=($Lt=$L_[$LA]).fromParentPoint($Lr),$LA--;return $Lr},$Lr.toParentPoint=function($Lr){if(!$Lr)return $Lr;$Lr.x-=this.pivotX,$Lr.y-=this.pivotY,this.transform&&this._transform.transformPoint($Lr),$Lr.x+=this._x,$Lr.y+=this._y;var $Li=this._style.scrollRect;return $Li&&($Lr.x-=$Li.x,$Lr.y-=$Li.y),$Lr},$Lr.fromParentPoint=function($Lr){if(!$Lr)return $Lr;$Lr.x-=this._x,$Lr.y-=this._y;var $Li=this._style.scrollRect;return $Li&&($Lr.x+=$Li.x,$Lr.y+=$Li.y),this.transform&&this._transform.invertTransformPoint($Lr),$Lr.x+=this.pivotX,$Lr.y+=this.pivotY,$Lr},$Lr.on=function($Lr,$Li,$Lt,$L_){return 1!==this._mouseEnableState&&this.isMouseEvent($Lr)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($Lr,$Li,$Lt,$L_,!1)):$LA.prototype.on.call(this,$Lr,$Li,$Lt,$L_)},$Lr.once=function($Lr,$Li,$Lt,$L_){return 1!==this._mouseEnableState&&this.isMouseEvent($Lr)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($Lr,$Li,$Lt,$L_,!0)):$LA.prototype.once.call(this,$Lr,$Li,$Lt,$L_)},$Lr._$2__onDisplay=function(){if(1!==this._mouseEnableState){var $Lr=this;for($Lr=$Lr.parent;$Lr&&1!==$Lr._mouseEnableState&&!$Lr._getBit(2);)$Lr.mouseEnabled=!0,$Lr._setBit(2,!0),$Lr=$Lr.parent}},$Lr.loadImage=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=this;return void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=0),void 0===$LA&&($LA=0),this.graphics.loadImage($Lr,$Li,$Lt,$L_,$LA,function($Lr){$LE.destroyed||($LE.size($Li+($L_||$Lr.width),$Lt+($LA||$Lr.height)),$LE.repaint(),$Lf&&$Lf.runWith($Lr))}),this},$Lr.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},$Lr._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},$Lr._childChanged=function($Lr){this._childs.length?this._renderType|=2048:this._renderType&=-2049,$Lr&&this._get$P("hasZorder")&&$Lw.timer.callLater(this,this.updateZOrder),this.repaint()},$Lr.parentRepaint=function(){var $Lr=this._parent;$Lr&&0===$Lr._repaint&&($Lr._repaint=1,$Lr.parentRepaint())},$Lr.startDrag=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){void 0===$Li&&($Li=!1),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=300),void 0===$Lf&&($Lf=!1),void 0===$LE&&($LE=.92),this._$P.dragging||this._set$P("dragging",new $Lo),this._$P.dragging.start(this,$Lr,$Li,$Lt,$L_,$LA,$Lf,$LE)},$Lr.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},$Lr._releaseMem=function(){if(this._$P){var $Lr=this._$P.cacheCanvas;$Lr&&$Lr.ctx&&($LJ.recover("RenderContext",$Lr.ctx),$Lr.ctx.canvas.size(0,0),$Lr.ctx=null);var $Li=this._$P._filterCache;$Li&&($Li.destroy(),$Li.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},$Lr._setDisplay=function($Lr){$Lr||this._releaseMem(),$LA.prototype._setDisplay.call(this,$Lr)},$Lr.hitTestPoint=function($Lr,$Li){var $Lt=this.globalToLocal($LH.TEMP.setTo($Lr,$Li));return $Lr=$Lt.x,$Li=$Lt.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?$Ls.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains($Lr,$Li)},$Lr.getMousePoint=function(){return this.globalToLocal($LH.TEMP.setTo($Lw.stage.mouseX,$Lw.stage.mouseY))},$Lr._getWords=function(){return null},$Lr._addChildsToLayout=function($Lr){var $Li=this._getWords();if(null==$Li&&0==this._childs.length)return!1;if($Li)for(var $Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++)$Lr.push($Li[$Lt]);$Lt=0;for(var $LA=this._childs.length;$Lt<$LA;++$Lt){var $Lf=this._childs[$Lt];$Lf._style._enableLayout()&&$Lf._addToLayout($Lr)}return!0},$Lr._addToLayout=function($Lr){this._style.absolute||(this._style.block?$Lr.push(this):this._addChildsToLayout($Lr)&&(this.x=this.y=0))},$Lr._isChar=function(){return!1},$Lr._getCSSStyle=function(){return this._style.getCSSStyle()},$Lr._setAttributes=function($Lr,$Li){switch($Lr){case"x":this.x=parseFloat($Li);break;case"y":this.y=parseFloat($Li);break;case"width":this.width=parseFloat($Li);break;case"height":this.height=parseFloat($Li);break;default:this[$Lr]=$Li}},$Lr._layoutLater=function(){this.parent&&this.parent._layoutLater()},$LO(0,$Lr,"optimizeScrollRect",function(){return this._optimizeScrollRect},function($Lr){this._optimizeScrollRect!=$Lr&&(this._optimizeScrollRect=$Lr,this.conchModel&&this.conchModel.optimizeScrollRect($Lr))}),$LO(0,$Lr,"customRenderEnable",null,function($Lr){if($Lr&&(this._renderType|=1024,$LF.isConchNode)){$Lt.CustomList.push(this);var $Li=new $Lnr("2d");$Li._setContext(new CanvasRenderingContext2D),this.customContext=new $Lb(0,0,$Li),$Li.context.setCanvasType&&$Li.context.setCanvasType(2),this.conchModel.custom($Li.context)}}),$LO(0,$Lr,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function($Lr){this.cacheAs=$Lr?this._$P.hasFilter?"none":"normal":"none"}),$LO(0,$Lr,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function($Lr){var $Li=this._$P.cacheCanvas;if($Lr!==($Li?$Li.type:"none")){if("none"!==$Lr)this._getBit(1)||this._setUpNoticeType(1),$Li||($Li=this._set$P("cacheCanvas",$LJ.getItemByClass("cacheCanvas",Object))),$Li.type=$Lr,$Li.reCache=!0,this._renderType|=16,"bitmap"==$Lr&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if($Li){var $Lt=$Li;$Lt&&$Lt.ctx&&($LJ.recover("RenderContext",$Lt.ctx),$Lt.ctx.canvas.size(0,0),$Lt.ctx=null),$LJ.recover("cacheCanvas",$Li)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),$LO(0,$Lr,"zOrder",function(){return this._zOrder},function($Lr){this._zOrder!=$Lr&&(this._zOrder=$Lr,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder($Lr),this._parent&&($Lr&&this._parent._set$P("hasZorder",!0),$Lw.timer.callLater(this._parent,this.updateZOrder)))}),$LO(0,$Lr,"rotation",function(){return this._style._tf.rotate},function($Lr){var $Li=this.getStyle();if($Li._tf.rotate!==$Lr){$Li.setRotate($Lr),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate($Lr),this._renderType|=4;var $Lt=this._parent;$Lt&&0===$Lt._repaint&&($Lt._repaint=1,$Lt.parentRepaint())}}),$LO(0,$Lr,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($Lr){this._width!==$Lr&&(this._width=$Lr,this.conchModel&&this.conchModel.size($Lr,this._height),this.repaint())}),$LO(0,$Lr,"x",function(){return this._x},function($Lr){if(this._x!==$Lr){if(this.destroyed)return;this._x=$Lr,this.conchModel&&this.conchModel.pos($Lr,this._y);var $Li=this._parent;$Li&&0===$Li._repaint&&($Li._repaint=1,$Li.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$LO(0,$Lr,"globalScaleY",function(){for(var $Lr=1,$Li=this;$Li&&$Li!==$Lw.stage;)$Lr*=$Li.scaleY,$Li=$Li.parent;return $Lr}),$LO(0,$Lr,"hitArea",function(){return this._$P.hitArea},function($Lr){this._set$P("hitArea",$Lr)}),$LO(0,$Lr,"staticCache",function(){return this._$P.staticCache},function($Lr){this._set$P("staticCache",$Lr),$Lr||this.reCache()}),$LO(0,$Lr,"texture",function(){return this._texture},function($Lr){this._texture!=$Lr&&(this._texture=$Lr,this.graphics.cleanByTexture($Lr,0,0))}),$LO(0,$Lr,"y",function(){return this._y},function($Lr){if(this._y!==$Lr){if(this.destroyed)return;this._y=$Lr,this.conchModel&&this.conchModel.pos(this._x,$Lr);var $Li=this._parent;$Li&&0===$Li._repaint&&($Li._repaint=1,$Li.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$LO(0,$Lr,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($Lr){this._height!==$Lr&&(this._height=$Lr,this.conchModel&&this.conchModel.size(this._width,$Lr),this.repaint())}),$LO(0,$Lr,"blendMode",function(){return this._style.blendMode},function($Lr){this.getStyle().blendMode=$Lr,this.conchModel&&this.conchModel.blendMode($Lr),$Lr&&"source-over"!=$Lr?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),$LO(0,$Lr,"scaleX",function(){return this._style._tf.scaleX},function($Lr){var $Li=this.getStyle();if($Li._tf.scaleX!==$Lr){$Li.setScaleX($Lr),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($Lr,$Li._tf.scaleY),this._renderType|=4;var $Lt=this._parent;$Lt&&0===$Lt._repaint&&($Lt._repaint=1,$Lt.parentRepaint())}}),$LO(0,$Lr,"scaleY",function(){return this._style._tf.scaleY},function($Lr){var $Li=this.getStyle();if($Li._tf.scaleY!==$Lr){$Li.setScaleY($Lr),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($Li._tf.scaleX,$Lr),this._renderType|=4;var $Lt=this._parent;$Lt&&0===$Lt._repaint&&($Lt._repaint=1,$Lt.parentRepaint())}}),$LO(0,$Lr,"stage",function(){return $Lw.stage}),$LO(0,$Lr,"skewX",function(){return this._style._tf.skewX},function($Lr){var $Li=this.getStyle();if($Li._tf.skewX!==$Lr){$Li.setSkewX($Lr),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($Lr,$Li._tf.skewY),this._renderType|=4;var $Lt=this._parent;$Lt&&0===$Lt._repaint&&($Lt._repaint=1,$Lt.parentRepaint())}}),$LO(0,$Lr,"scrollRect",function(){return this._style.scrollRect},function($Lr){this.getStyle().scrollRect=$Lr,this.repaint(),$Lr?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect($Lr.x,$Lr.y,$Lr.width,$Lr.height)):(this._renderType&=-129,this.conchModel&&($Lt.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),$LO(0,$Lr,"skewY",function(){return this._style._tf.skewY},function($Lr){var $Li=this.getStyle();if($Li._tf.skewY!==$Lr){$Li.setSkewY($Lr),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($Li._tf.skewX,$Lr),this._renderType|=4;var $Lt=this._parent;$Lt&&0===$Lt._repaint&&($Lt._repaint=1,$Lt.parentRepaint())}}),$LO(0,$Lr,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function($Lr){this._tfChanged=!1,(this._transform=$Lr)&&(this._x=$Lr.tx,this._y=$Lr.ty,$Lr.tx=$Lr.ty=0,this.conchModel&&this.conchModel.transform($Lr.a,$Lr.b,$Lr.c,$Lr.d,this._x,this._y)),$Lr?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),$LO(0,$Lr,"pivotX",function(){return this._style._tf.translateX},function($Lr){this.getStyle().setTranslateX($Lr),this.conchModel&&this.conchModel.pivot($Lr,this._style._tf.translateY),this.repaint()}),$LO(0,$Lr,"pivotY",function(){return this._style._tf.translateY},function($Lr){this.getStyle().setTranslateY($Lr),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,$Lr),this.repaint()}),$LO(0,$Lr,"alpha",function(){return this._style.alpha},function($Lr){this._style&&this._style.alpha!==$Lr&&($Lr=$Lr<0?0:1<$Lr?1:$Lr,this.getStyle().alpha=$Lr,this.conchModel&&this.conchModel.alpha($Lr),1!==$Lr?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),$LO(0,$Lr,"visible",function(){return this._style.visible},function($Lr){this._style&&this._style.visible!==$Lr&&(this.getStyle().visible=$Lr,this.conchModel&&this.conchModel.visible($Lr),this.parentRepaint())}),$LO(0,$Lr,"graphics",function(){return this._graphics||(this.graphics=$Lk.createGraphics())},function($Lr){this._graphics&&(this._graphics._sp=null),(this._graphics=$Lr)?(this._renderType&=-2,this._renderType|=512,($Lr._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&($Lt.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),$LO(0,$Lr,"filters",function(){return this._$P.filters},function($Lr){$Lr&&0===$Lr.length&&($Lr=null),this._$P.filters!=$Lr&&(this._set$P("filters",$Lr?$Lr.slice():null),$LF.isConchApp&&(this.conchModel&&($Lt.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),$LF.isWebGL&&($Lr&&$Lr.length?this._renderType|=32:this._renderType&=-33),$Lr&&0<$Lr.length?(this._getBit(1)||this._setUpNoticeType(1),$LF.isWebGL&&1==$Lr.length&&$Lr[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&($LF.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),$LO(0,$Lr,"parent",$LA.prototype._$get_parent,function($Lr){$Lw.superSet($Lrr,this,"parent",$Lr),$Lr&&this._getBit(2)&&this._$2__onDisplay()}),$LO(0,$Lr,"mask",function(){return this._$P._mask},function($Lr){$Lr&&this.mask&&this.mask._$P.maskParent||($Lr?(this.cacheAs="bitmap",this._set$P("_mask",$Lr),$Lr._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",$Lr),this.cacheAs="none"),this.conchModel&&this.conchModel.mask($Lr?$Lr.conchModel:null),this._renderType|=64,this.parentRepaint())}),$LO(0,$Lr,"mouseEnabled",function(){return 1<this._mouseEnableState},function($Lr){this._mouseEnableState=$Lr?2:1}),$LO(0,$Lr,"globalScaleX",function(){for(var $Lr=1,$Li=this;$Li&&$Li!==$Lw.stage;)$Lr*=$Li.scaleX,$Li=$Li.parent;return $Lr}),$LO(0,$Lr,"mouseX",function(){return this.getMousePoint().x}),$LO(0,$Lr,"mouseY",function(){return this.getMousePoint().y}),$Lt.fromImage=function($Lr){return(new $Lt).loadImage($Lr)},$Lt._cachePool=[],$Lt.CustomList=[],$LN($Lt,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=$LE.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),$Lt}($Lrr),$LXr=function($Lr){function $Li($Lr){this._audio=null,this._onEnd=null,this._resumePlay=null,$Li.__super.call(this),this._onEnd=$LK.bind(this.__onEnd,this),this._resumePlay=$LK.bind(this.__resumePlay,this),$Lr.addEventListener("ended",this._onEnd),this._audio=$Lr}$Lg($Li,"laya.media.h5audio.AudioSoundChannel",$L_r);var $Lt=$Li.prototype;return $Lt.__onEnd=function(){if(1==this.loops)return this.completeHandler&&($Lw.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$Lt.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,$Lq.container.appendChild(this._audio),this._audio.play()}catch($Lr){this.event("error")}},$Lt.play=function($Lr){this.isStopped=!1;try{this._audio.playbackRate=$LU.playbackRate,this._audio.currentTime=this.startTime}catch($Lr){return void this._audio.addEventListener("canplay",this._resumePlay)}$LU.addChannel(this),$Lq.container.appendChild(this._audio),!$Lr&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},$Lt.stop=function(){this.isStopped=!0,$LU.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&$LF.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),$Lq.onIE||this._audio!=$Ltr._musicAudio&&$LJ.recover("audio:"+this.url,this._audio),$Lq.removeElement(this._audio),this._audio=null)},$Lt.pause=function(){this.isStopped=!0,$LU.removeChannel(this),"pause"in this._audio&&this._audio.pause()},$Lt.resume=function(){this._audio&&(this.isStopped=!1,$LU.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},$LO(0,$Lt,"position",function(){return this._audio?this._audio.currentTime:0}),$LO(0,$Lt,"duration",function(){return this._audio?this._audio.duration:0}),$LO(0,$Lt,"volume",function(){return this._audio?this._audio.volume:1},function($Lr){this._audio&&(this._audio.volume=$Lr)}),$Li}(),$Lvr=function($Lr){function $Li(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=$Lfr.ctx,$Li.__super.call(this),this._onPlayEnd=$LK.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}$Lg($Li,"laya.media.webaudio.WebAudioSoundChannel",$L_r);var $Lt=$Li.prototype;return $Lt.play=function($Lr){if($LU.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var $Li=this.context,$Lt=this.gain,$L_=$Li.createBufferSource();(this.bufferSource=$L_).buffer=this.audioBuffer,$L_.connect($Lt),$Lt&&$Lt.disconnect(),$Lt.connect($Li.destination),$L_.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=$Lq.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&($L_.loop=!0),$L_.playbackRate.setTargetAtTime?$L_.playbackRate.setTargetAtTime($LU.playbackRate,this.context.currentTime,.1):$L_.playbackRate.value=$LU.playbackRate,$L_.start(0,this.startTime),!$Lr&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},$Lt.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&($Lw.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$Lt._clearBufferSource=function(){if(this.bufferSource){var $Lr=this.bufferSource;$Lr.stop?$Lr.stop(0):$Lr.noteOff(0),$Lr.disconnect(0),$Lr.onended=null,$Li._tryCleanFailed||this._tryClearBuffer($Lr),this.bufferSource=null}},$Lt._tryClearBuffer=function($Lr){try{$Lr.buffer=null}catch($Lr){$Li._tryCleanFailed=!0}},$Lt.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,$LU.removeChannel(this),this.startHandler=null,this.completeHandler=null},$Lt.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,$LU.removeChannel(this)},$Lt.resume=function(){this.startTime=this._pauseTime,this.play(!1)},$LO(0,$Lt,"position",function(){return this.bufferSource?($Lq.now()-this._startTime)/1e3+this.startTime:0}),$LO(0,$Lt,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$LO(0,$Lt,"volume",function(){return this._volume},function($Lr){this.isStopped||(this._volume=$Lr,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime($Lr,this.context.currentTime,.1):this.gain.gain.value=$Lr)}),$Li._tryCleanFailed=!1,$Li}(),$LOr=function($Lr){function $Li(){$Li.__super.call(this),this._w=0,this._h=0}$Lg($Li,"laya.resource.Bitmap",$Lpr);var $Lt=$Li.prototype;return $LO(0,$Lt,"width",function(){return this._w}),$LO(0,$Lt,"height",function(){return this._h}),$LO(0,$Lt,"source",function(){return this._source}),$Li}(),$Lcr=function($Li){function $Lr(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,$Lr.__super.call(this),this._interval=$L_.animationInterval,this._setUpNoticeType(1)}$Lg($Lr,"laya.display.AnimationPlayerBase",$Li);var $Lt=$Lr.prototype;return $Lt.play=function($Lr,$Li,$Lt,$L_){void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=!0),void 0===$Lt&&($Lt=""),void 0===$L_&&($L_=!0),this._isPlaying=!0,this.index="string"==typeof $Lr?this._getFrameByLabel($Lr):$Lr,this.loop=$Li,this._actionName=$Lt,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$Lt._getFrameByLabel=function($Lr){var $Li=0;for($Li=0;$Li<this._count;$Li++)if(this._labels[$Li]&&0<=this._labels[$Li].indexOf($Lr))return $Li;return 0},$Lt._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},$Lt._setControlNode=function($Lr){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=$Lr)&&$Lr!=this&&($Lr.on("display",this,this._checkResumePlaying),$Lr.on("undisplay",this,this._checkResumePlaying))},$Lt._setDisplay=function($Lr){$Li.prototype._setDisplay.call(this,$Lr),this._checkResumePlaying()},$Lt._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},$Lt.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},$Lt.addLabel=function($Lr,$Li){this._labels||(this._labels={}),this._labels[$Li]||(this._labels[$Li]=[]),this._labels[$Li].push($Lr)},$Lt.removeLabel=function($Lr){if($Lr){if(this._labels)for(var $Li in this._labels)this._removeLabelFromLabelList(this._labels[$Li],$Lr)}else this._labels=null},$Lt._removeLabelFromLabelList=function($Lr,$Li){if($Lr)for(var $Lt=$Lr.length-1;0<=$Lt;$Lt--)$Lr[$Lt]==$Li&&$Lr.splice($Lt,1)},$Lt.gotoAndStop=function($Lr){this.index="string"==typeof $Lr?this._getFrameByLabel($Lr):$Lr,this.stop()},$Lt._displayToIndex=function($Lr){},$Lt.clear=function(){this.stop(),this._labels=null},$LO(0,$Lt,"interval",function(){return this._interval},function($Lr){this._interval!=$Lr&&(this._frameRateChanged=!0,this._interval=$Lr,this._isPlaying&&0<$Lr&&this.timerLoop($Lr,this,this._frameLoop,null,!0,!0))}),$LO(0,$Lt,"isPlaying",function(){return this._isPlaying}),$LO(0,$Lt,"index",function(){return this._index},function($Lr){if(this._index=$Lr,this._displayToIndex($Lr),this._labels&&this._labels[$Lr])for(var $Li=this._labels[$Lr],$Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++)this.event("label",$Li[$Lt])}),$LO(0,$Lt,"count",function(){return this._count}),$Lr.WRAP_POSITIVE=0,$Lr.WRAP_REVERSE=1,$Lr.WRAP_PINGPONG=2,$Lr}($LRr),$LBr=function($Li){function $Lv(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,$Lv.__super.call(this),this.overflow=$Lv.VISIBLE,this._style=new $Lir(this),this._style.wordWrap=!1}$Lg($Lv,"laya.display.Text",$Li);var $Lr=$Lv.prototype;return $Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,$Lr),this._lines=null,this._words&&(this._words.length=0,this._words=null)},$Lr._getBoundPointsM=function($Lr){void 0===$Lr&&($Lr=!1);var $Li=$Ls.TEMP;return $Li.setTo(0,0,this.width,this.height),$Li._getBoundPoints()},$Lr.getGraphicBounds=function($Lr){void 0===$Lr&&($Lr=!1);var $Li=$Ls.TEMP;return $Li.setTo(0,0,this.width,this.height),$Li},$Lr._getCSSStyle=function(){return this._style},$Lr.lang=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg){if($Lr=$Lv.langPacks&&$Lv.langPacks[$Lr]?$Lv.langPacks[$Lr]:$Lr,arguments.length<2)this._text=$Lr;else{for(var $LR=0,$LX=arguments.length;$LR<$LX;$LR++)$Lr=$Lr.replace("{"+$LR+"}",arguments[$LR+1]);this._text=$Lr}},$Lr._isPassWordMode=function(){var $Lr=this._style.password;return"prompt"in this&&this.prompt==this._text&&($Lr=!1),$Lr},$Lr._getPassWordTxt=function($Lr){var $Li;$Li="";for(var $Lt=$Lr.length;0<$Lt;$Lt--)$Li+="●";return $Li},$Lr.renderText=function($Lr,$Li){var $Lt=this.graphics;$Lt.clear(!0);var $L_=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+($Lq.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);$Lq.context.font=$L_;var $LA=this.padding,$Lf=$LA[3],$LE="left",$LG=this._lines,$LN=this.leading+this._charSize.height,$Lp=this._currBitmapFont;$Lp&&($LN=this.leading+$Lp.getMaxHeight());var $Lg=$LA[0];if(!$Lp&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?($LE="right",$Lf=this._width-$LA[1]):"center"==this.align&&($LE="center",$Lf=.5*this._width+$LA[3]-$LA[1])),0<this._height){var $LR=this._textHeight>this._height?"top":this.valign;"middle"===$LR?$Lg=.5*(this._height-$Li*$LN)+$LA[0]-$LA[2]:"bottom"===$LR&&($Lg=this._height-$Li*$LN-$LA[2])}var $LX=this._style;if($Lp&&$Lp.autoScaleSize)var $Lv=$Lp.fontSize/this.fontSize;if(this._clipPoint)if($Lt.save(),$Lp&&$Lp.autoScaleSize){var $LO=0,$Lc=0;$LO=this._width?this._width-$LA[3]-$LA[1]:this._textWidth,$Lc=this._height?this._height-$LA[0]-$LA[2]:this._textHeight,$LO*=$Lv,$Lc*=$Lv,$Lt.clipRect($LA[3],$LA[0],$LO,$Lc)}else $Lt.clipRect($LA[3],$LA[0],this._width?this._width-$LA[3]-$LA[1]:this._textWidth,this._height?this._height-$LA[0]-$LA[2]:this._textHeight);var $LB=$LX.password;"prompt"in this&&this.prompt==this._text&&($LB=!1);for(var $Ly=0,$LC=0,$Ln=Math.min(this._lines.length,$Li+$Lr)||1,$La=$Lr;$La<$Ln;$La++){var $LD,$Lu=$LG[$La];if($LB){var $Lw=$Lu.length;$Lu="";for(var $LH=$Lw;0<$LH;$LH--)$Lu+="●"}if($Ly=$Lf-(this._clipPoint?this._clipPoint.x:0),$LC=$Lg+$LN*$La-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline($LE,$Ly,$LC,$La),$Lp){var $Ls=this.width;$Lp.autoScaleSize&&($Ls=this.width*$Lv),$Lp.drawText($Lu,this,$Ly,$LC,this.align,$Ls)}else $LF.isWebGL?(this._words||(this._words=[]),($LD=this._words.length>$La-$Lr?this._words[$La-$Lr]:new $Lj).setText($Lu)):$LD=$Lu,$LX.stroke?$Lt.fillBorderText($LD,$Ly,$LC,$L_,this.color,$LX.strokeColor,$LX.stroke,$LE):$Lt.fillText($LD,$Ly,$LC,$L_,this.color,$LE)}if($Lp&&$Lp.autoScaleSize){var $Ld=1/$Lv;this.scale($Ld,$Ld)}this._clipPoint&&$Lt.restore(),this._startX=$Lf,this._startY=$Lg},$Lr.drawUnderline=function($Lr,$Li,$Lt,$L_){var $LA=this._lineWidths[$L_];switch($Lr){case"center":$Li-=$LA/2;break;case"right":$Li-=$LA}$Lt+=this._charSize.height,this._graphics.drawLine($Li,$Lt,$Li+$LA,$Lt,this.underlineColor||this.color,1)},$Lr.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);$Lq.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new $LH(0,0)):this._clipPoint=null;var $Lr=this._lines.length;if(this.overflow!=$Lv.VISIBLE){var $Li=this.overflow==$Lv.HIDDEN?Math.floor:Math.ceil;$Lr=Math.min($Lr,$Li((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var $Lt=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText($Lt,$Lr),this.repaint()},$Lr.evalTextSize=function(){var $Lr,$Li=NaN;$Lr=Math.max.apply(this,this._lineWidths),$Li=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],$Lr==this._textWidth&&$Li==this._textHeight||(this._textWidth=$Lr,this._textHeight=$Li,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},$Lr.checkEnabledViewportOrNot=function(){return this.overflow==$Lv.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},$Lr.changeText=function($Lr){this._text!==$Lr&&(this.lang($Lr+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},$Lr.parseLines=function($Lr){var $Li=this.wordWrap||this.overflow==$Lv.HIDDEN;if($Li)var $Lt=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var $L_=$LK.contextMeasureText($Lv._testWord);$LF.isConchApp&&0===$L_.width&&0===$L_.height&&($L_=$LK.contextMeasureText("W")),this._charSize.width=$L_.width,this._charSize.height=$L_.height||this.fontSize}for(var $LA=$Lr.replace(/\r\n/g,"\n").split("\n"),$Lf=0,$LE=$LA.length;$Lf<$LE;$Lf++){var $LG=$LA[$Lf];$Li?this.parseLine($LG,$Lt):(this._lineWidths.push(this.getTextWidth($LG)),this._lines.push($LG))}},$Lr.parseLine=function($Lr,$Li){$Lq.context;var $Lt,$L_=this._lines,$LA=0,$Lf=NaN,$LE=NaN,$LG=0;if(($Lf=this.getTextWidth($Lr))<=$Li)return $L_.push($Lr),void this._lineWidths.push($Lf);$Lf=this._charSize.width,0==($LA=Math.floor($Li/$Lf))&&($LA=1),$LE=$Lf=this.getTextWidth($Lr.substring(0,$LA));for(var $LN=$LA,$Lp=$Lr.length;$LN<$Lp;$LN++)if($Li<($LE+=$Lf=this.getTextWidth($Lr.charAt($LN))))if(this.wordWrap){var $Lg=$Lr.substring($LG,$LN);if($Lg.charCodeAt($Lg.length-1)<255?($Lt=/(?:\w|-)+$/.exec($Lg))&&($LN=$Lt.index+$LG,0==$Lt.index?$LN+=$Lg.length:$Lg=$Lr.substring($LG,$LN)):$Lv.RightToLeft&&($Lt=/([\u0600-\u06FF])+$/.exec($Lg))&&($LN=$Lt.index+$LG,0==$Lt.index?$LN+=$Lg.length:$Lg=$Lr.substring($LG,$LN)),$L_.push($Lg),this._lineWidths.push($LE-$Lf),!(($LG=$LN)+$LA<$Lp)){$L_.push($Lr.substring($LG,$Lp)),this._lineWidths.push(this.getTextWidth($L_[$L_.length-1])),$LG=-1;break}$LN+=$LA,$LE=$Lf=this.getTextWidth($Lr.substring($LG,$LN)),$LN--}else if(this.overflow==$Lv.HIDDEN)return $L_.push($Lr.substring(0,$LN)),void this._lineWidths.push(this.getTextWidth($L_[$L_.length-1]));this.wordWrap&&-1!=$LG&&($L_.push($Lr.substring($LG,$Lp)),this._lineWidths.push(this.getTextWidth($L_[$L_.length-1])))},$Lr.getTextWidth=function($Lr){return this._currBitmapFont?this._currBitmapFont.getTextWidth($Lr):$LK.contextMeasureText($Lr).width},$Lr.getWordWrapWidth=function(){var $Lr=this.padding,$Li=NaN;return($Li=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&($Li=this.wordWrap?100:$Lq.width),$Li<=0&&($Li=100),$Li-$Lr[3]-$Lr[1]},$Lr.getCharPoint=function($Lr,$Li){this._isChanged&&$Lw.timer.runCallLater(this,this.typeset);for(var $Lt=0,$L_=this._lines,$LA=0,$Lf=0,$LE=$L_.length;$Lf<$LE;$Lf++){if($Lr<($Lt+=$L_[$Lf].length)){var $LG=$Lf;break}$LA=$Lt}var $LN=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;$Lq.context.font=$LN;var $Lp=this.getTextWidth(this._text.substring($LA,$Lr));return($Li||new $LH).setTo(this._startX+$Lp-(this._clipPoint?this._clipPoint.x:0),this._startY+$LG*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},$LO(0,$Lr,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function($Lr){$Lr!=this._width&&($Lw.superSet($LRr,this,"width",$Lr),this.isChanged=!0)}),$LO(0,$Lr,"textWidth",function(){return this._isChanged&&$Lw.timer.runCallLater(this,this.typeset),this._textWidth}),$LO(0,$Lr,"height",function(){return this._height?this._height:this.textHeight},function($Lr){$Lr!=this._height&&($Lw.superSet($LRr,this,"height",$Lr),this.isChanged=!0)}),$LO(0,$Lr,"textHeight",function(){return this._isChanged&&$Lw.timer.runCallLater(this,this.typeset),this._textHeight}),$LO(0,$Lr,"padding",function(){return this._getCSSStyle().padding},function($Lr){this._getCSSStyle().padding=$Lr,this.isChanged=!0}),$LO(0,$Lr,"bold",function(){return this._getCSSStyle().bold},function($Lr){this._getCSSStyle().bold=$Lr,this.isChanged=!0}),$LO(0,$Lr,"text",function(){return this._text||""},function($Lr){this._text!==$Lr&&(this.lang($Lr+""),this.isChanged=!0,this.event("change"))}),$LO(0,$Lr,"color",function(){return this._getCSSStyle().color},function($Lr){this._getCSSStyle().color!=$Lr&&(this._getCSSStyle().color=$Lr,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),$LO(0,$Lr,"font",function(){return this._getCSSStyle().fontFamily},function($Lr){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),$Lv._bitmapFonts&&$Lv._bitmapFonts[$Lr]&&(this._currBitmapFont=$Lv._bitmapFonts[$Lr]),this._getCSSStyle().fontFamily=$Lr,this.isChanged=!0}),$LO(0,$Lr,"fontSize",function(){return this._getCSSStyle().fontSize},function($Lr){this._getCSSStyle().fontSize=$Lr,this.isChanged=!0}),$LO(0,$Lr,"italic",function(){return this._getCSSStyle().italic},function($Lr){this._getCSSStyle().italic=$Lr,this.isChanged=!0}),$LO(0,$Lr,"align",function(){return this._getCSSStyle().align},function($Lr){this._getCSSStyle().align=$Lr,this.isChanged=!0}),$LO(0,$Lr,"valign",function(){return this._getCSSStyle().valign},function($Lr){this._getCSSStyle().valign=$Lr,this.isChanged=!0}),$LO(0,$Lr,"wordWrap",function(){return this._getCSSStyle().wordWrap},function($Lr){this._getCSSStyle().wordWrap=$Lr,this.isChanged=!0}),$LO(0,$Lr,"leading",function(){return this._getCSSStyle().leading},function($Lr){this._getCSSStyle().leading=$Lr,this.isChanged=!0}),$LO(0,$Lr,"bgColor",function(){return this._getCSSStyle().backgroundColor},function($Lr){this._getCSSStyle().backgroundColor=$Lr,this.isChanged=!0}),$LO(0,$Lr,"borderColor",function(){return this._getCSSStyle().borderColor},function($Lr){this._getCSSStyle().borderColor=$Lr,this.isChanged=!0}),$LO(0,$Lr,"stroke",function(){return this._getCSSStyle().stroke},function($Lr){this._getCSSStyle().stroke=$Lr,this.isChanged=!0}),$LO(0,$Lr,"strokeColor",function(){return this._getCSSStyle().strokeColor},function($Lr){this._getCSSStyle().strokeColor=$Lr,this.isChanged=!0}),$LO(0,$Lr,"isChanged",null,function($Lr){this._isChanged!==$Lr&&(this._isChanged=$Lr)&&$Lw.timer.callLater(this,this.typeset)}),$LO(0,$Lr,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function($Lr){if(!(this.overflow!=$Lv.SCROLL||this.textWidth<this._width)&&this._clipPoint){$Lr=$Lr<this.padding[3]?this.padding[3]:$Lr;var $Li=this._textWidth-this._width;$Lr=$Li<$Lr?$Li:$Lr;var $Lt=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=$Lr,this.renderText(this._lastVisibleLineIndex,$Lt)}}),$LO(0,$Lr,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function($Lr){if(!(this.overflow!=$Lv.SCROLL||this.textHeight<this._height)&&this._clipPoint){$Lr=$Lr<this.padding[0]?this.padding[0]:$Lr;var $Li=this._textHeight-this._height,$Lt=($Lr=$Li<$Lr?$Li:$Lr)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=$Lt;var $L_=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=$Lr,this.renderText($Lt,$L_)}}),$LO(0,$Lr,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),$LO(0,$Lr,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),$LO(0,$Lr,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),$LO(0,$Lr,"underlineColor",function(){return this._underlineColor},function($Lr){this._underlineColor=$Lr,this._isChanged=!0,this.typeset()}),$Lv.registerBitmapFont=function($Lr,$Li){$Lv._bitmapFonts||($Lv._bitmapFonts={}),$Lv._bitmapFonts[$Lr]=$Li},$Lv.unregisterBitmapFont=function($Lr,$Li){if(void 0===$Li&&($Li=!0),$Lv._bitmapFonts&&$Lv._bitmapFonts[$Lr]){var $Lt=$Lv._bitmapFonts[$Lr];$Li&&$Lt.destroy(),delete $Lv._bitmapFonts[$Lr]}},$Lv.setTextRightToLeft=function(){var $Lr;($Lr=$Lq.canvas.source.style).display="none",$Lr.position="absolute",$Lr.direction="rtl",$LF._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,$Lq.document.body.appendChild($Lq.canvas.source)},$Lv.supportFont=function($Lr){$Lq.context.font="10px sans-serif";var $Li=$LK.contextMeasureText("abcji").width;$Lq.context.font="10px "+$Lr;var $Lt=$LK.contextMeasureText("abcji").width;return console.log($Li,$Lt),$Li!==$Lt},$Lv._testWord="游",$Lv.langPacks=null,$Lv.VISIBLE="visible",$Lv.SCROLL="scroll",$Lv.HIDDEN="hidden",$Lv.CharacterCache=!0,$Lv.RightToLeft=!1,$Lv._bitmapFonts=null,$LN($Lv,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),$Lv}($LRr),$Lyr=function($LR){function $LE(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",$LE.__super.call(this),this.offset=new $LH,this._canvasTransform=new $Le,this._previousOrientation=$Lq.window.orientation;var $Li=this;this.transform=$Le.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var $Lr=$Lq.window,$Lt=this;$Lr.addEventListener("focus",function(){$Li._isFocused=!0,$Lt.event("focus"),$Lt.event("focuschange")}),$Lr.addEventListener("blur",function(){$Li._isFocused=!1,$Lt.event("blur"),$Lt.event("focuschange"),$Lt._isInputting()&&($LDr.inputElement.target.focus=!1)});var $L_="visibilityState",$LA="visibilitychange",$Lf=$Lr.document;void 0!==$Lf.hidden?($LA="visibilitychange",$L_="visibilityState"):void 0!==$Lf.mozHidden?($LA="mozvisibilitychange",$L_="mozVisibilityState"):void 0!==$Lf.msHidden?($LA="msvisibilitychange",$L_="msVisibilityState"):void 0!==$Lf.webkitHidden&&($LA="webkitvisibilitychange",$L_="webkitVisibilityState"),$Lr.document.addEventListener($LA,function(){"hidden"==$Lq.document[$L_]?$Lt._setStageVisible(!1):$Lt._setStageVisible(!0)}),$Lr.document.addEventListener("qbrowserVisibilityChange",function($Lr){$Lt._setStageVisible(!$Lr.hidden)}),$Lr.addEventListener("resize",function(){var $Lr=$Lq.window.orientation;null!=$Lr&&$Lr!=$Li._previousOrientation&&$Lt._isInputting()&&($LDr.inputElement.target.focus=!1),$Li._previousOrientation=$Lr,$Lt._isInputting()||$Lt._resetCanvas()}),$Lr.addEventListener("orientationchange",function($Lr){$Lt._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),$Lq.onMobile&&this.on("mousedown",this,this._onmouseMove)}$Lg($LE,"laya.display.Stage",$LR);var $Lr=$LE.prototype;return $Lr._setStageVisible=function($Lr){this._isVisibility!=$Lr&&(this._isVisibility=$Lr,this._isVisibility||this._isInputting()&&($LDr.inputElement.target.focus=!1),this.event("visibilitychange"))},$Lr._isInputting=function(){return $Lq.onMobile&&$LDr.isInputting},$Lr._changeCanvasSize=function(){this.setScreenSize($Lq.clientWidth*$Lq.pixelRatio,$Lq.clientHeight*$Lq.pixelRatio)},$Lr._resetCanvas=function(){if(this.screenAdaptationEnabled){var $Lr=$LF._mainCanvas;$Lr.source.style;$Lr.size(1,1),$Lw.timer.once(100,this,this._changeCanvasSize)}},$Lr.setScreenSize=function($Lr,$Li){var $Lt=!1;if("none"!==this._screenMode&&($Lt=($Lr/$Li<1?"vertical":"horizontal")!==this._screenMode)){var $L_=$Li;$Li=$Lr,$Lr=$L_}this.canvasRotation=$Lt;var $LA=$LF._mainCanvas,$Lf=$LA.source.style,$LE=this._canvasTransform.identity(),$LG=this._scaleMode,$LN=$Lr/this.designWidth,$Lp=$Li/this.designHeight,$Lg=this.designWidth,$LR=this.designHeight,$LX=$Lr,$Lv=$Li,$LO=$Lq.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,$LG){case"noscale":$LN=$Lp=1,$LX=this.designWidth,$Lv=this.designHeight;break;case"showall":$LN=$Lp=Math.min($LN,$Lp),$Lg=$LX=Math.round(this.designWidth*$LN),$LR=$Lv=Math.round(this.designHeight*$Lp);break;case"noborder":$LN=$Lp=Math.max($LN,$Lp),$LX=Math.round(this.designWidth*$LN),$Lv=Math.round(this.designHeight*$Lp);break;case"full":$LN=$Lp=1,this._width=$Lg=$Lr,this._height=$LR=$Li;break;case"fixedwidth":$Lp=$LN,this._height=$LR=Math.round($Li/$LN);break;case"fixedheight":$LN=$Lp,this._width=$Lg=Math.round($Lr/$Lp);break;case"fixedauto":$Lr/$Li<this.designWidth/this.designHeight?($Lp=$LN,this._height=$LR=Math.round($Li/$LN)):($LN=$Lp,this._width=$Lg=Math.round($Lr/$Lp))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,$Lg=$Lg+1&2147483646,$LR=$LR+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),$LN*=this.scaleX,$Lp*=this.scaleY,1===$LN&&1===$Lp?this.transform.identity():(this.transform.a=this._formatData($LN/($LX/$Lg)),this.transform.d=this._formatData($Lp/($Lv/$LR)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),$LA.size($Lg,$LR),$Lk.changeWebGLSize($Lg,$LR),$LE.scale($LX/$Lg/$LO,$Lv/$LR/$LO),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=($Lr-$LX)/$LO:this.offset.x=.5*($Lr-$LX)/$LO,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=($Li-$Lv)/$LO:this.offset.y=.5*($Li-$Lv)/$LO,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),$LE.translate(this.offset.x,this.offset.y),this.canvasDegree=0,$Lt&&("horizontal"===this._screenMode?($LE.rotate(Math.PI/2),$LE.translate($Li/$LO,0),this.canvasDegree=90):($LE.rotate(-Math.PI/2),$LE.translate(0,$Lr/$LO),this.canvasDegree=-90)),$LE.a=this._formatData($LE.a),$LE.d=this._formatData($LE.d),$LE.tx=this._formatData($LE.tx),$LE.ty=this._formatData($LE.ty),$Lf.transformOrigin=$Lf.webkitTransformOrigin=$Lf.msTransformOrigin=$Lf.mozTransformOrigin=$Lf.oTransformOrigin="0px 0px 0px",$Lf.transform=$Lf.webkitTransform=$Lf.msTransform=$Lf.mozTransform=$Lf.oTransform="matrix("+$LE.toString()+")",$LE.translate(parseInt($Lf.left)||0,parseInt($Lf.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},$Lr._formatData=function($Lr){return Math.abs($Lr)<1e-6?0:Math.abs(1-$Lr)<.001?0<$Lr?1:-1:$Lr},$Lr.getMousePoint=function(){return $LH.TEMP.setTo(this.mouseX,this.mouseY)},$Lr.repaint=function(){this._repaint=1},$Lr.parentRepaint=function(){},$Lr._loop=function(){return this.render($LF.context,0,0),!0},$Lr._onmouseMove=function($Lr){this._mouseMoveTime=$Lq.now()},$Lr.getTimeFromFrameStart=function(){return $Lq.now()-this._frameStartTime},$Lr.render=function($Lr,$Li,$Lt){if("sleep"===this._frameRate&&!$LF.isConchApp){var $L_=$Lq.now();if(!(1e3<=$L_-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&($LZ.loopCount++,$Lc.instance.runEvent(),$Lw.timer._update()));this._frameStartTime=$L_}if(this._renderCount++,$LF.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=$Lq.now();var $LA="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),$Lf=this._renderCount%2==0;if($LZ.renderSlow=!$LA,$LA||$Lf||$LF.isConchApp){var $LE;$LZ.loopCount++,$Lc.instance.runEvent(),$Lw.timer._update(),$Lk.update3DLoop();var $LG=0,$LN=0;if($LF.isConchNode)for($LG=0,$LN=this._scenes.length;$LG<$LN;$LG++)($LE=this._scenes[$LG])&&$LE._updateSceneConch();else for($LG=0,$LN=this._scenes.length;$LG<$LN;$LG++)($LE=this._scenes[$LG])&&$LE._updateScene();if($LF.isConchNode){var $Lp=$LRr.CustomList;for($LG=0,$LN=$Lp.length;$LG<$LN;$LG++){var $Lg=$Lp[$LG];$Lg.customRender($Lg.customContext,0,0)}return}}$LF.isConchNode||this.renderingEnabled&&($LA||!$Lf||$LF.isConchWebGL)&&($LF.isWebGL?$LF.WebGL.mainContext&&!$LF.WebGL.mainContext.isContextLost()&&($Lr.clear(),$LR.prototype.render.call(this,$Lr,$Li,$Lt),$LZ._show&&$LZ._sp&&$LZ._sp.render($Lr,$Li,$Lt),$Lk.clear(this._bgColor),$Lk.beginFlush(),$Lr.flush(),$Lk.endFinish(),$LS.instance&&$LS.getInstance().endDispose()):($Lk.clear(this._bgColor),$LR.prototype.render.call(this,$Lr,$Li,$Lt),$LZ._show&&$LZ._sp&&$LZ._sp.render($Lr,$Li,$Lt)))}else this._renderCount%5==0&&($LZ.loopCount++,$Lc.instance.runEvent(),$Lw.timer._update())},$Lr._requestFullscreen=function(){var $Lr=$Lq.document.documentElement;$Lr.requestFullscreen?$Lr.requestFullscreen():$Lr.mozRequestFullScreen?$Lr.mozRequestFullScreen():$Lr.webkitRequestFullscreen?$Lr.webkitRequestFullscreen():$Lr.msRequestFullscreen&&$Lr.msRequestFullscreen()},$Lr._fullScreenChanged=function(){$Lw.stage.event("fullscreenchange")},$Lr.exitFullscreen=function(){var $Lr=$Lq.document;$Lr.exitFullscreen?$Lr.exitFullscreen():$Lr.mozCancelFullScreen?$Lr.mozCancelFullScreen():$Lr.webkitExitFullscreen&&$Lr.webkitExitFullscreen()},$LO(0,$Lr,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),$LO(0,$Lr,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),$LO(0,$Lr,"frameRate",function(){return this._frameRate},function($Lr){if(this._frameRate=$Lr,$LF.isConchApp)switch(this._frameRate){case"slow":$Lq.window.conch&&$Lq.window.conchConfig.setSlowFrame&&$Lq.window.conchConfig.setSlowFrame(!0);break;case"fast":$Lq.window.conch&&$Lq.window.conchConfig.setSlowFrame&&$Lq.window.conchConfig.setSlowFrame(!1);break;case"mouse":$Lq.window.conch&&$Lq.window.conchConfig.setMouseFrame&&$Lq.window.conchConfig.setMouseFrame(2e3);break;case"sleep":$Lq.window.conch&&$Lq.window.conchConfig.setLimitFPS&&$Lq.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),$LO(0,$Lr,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),$LO(0,$Lr,"width",$LR.prototype._$get_width,function($Lr){this.designWidth=$Lr,$Lw.superSet($LRr,this,"width",$Lr),$Lw.timer.callLater(this,this._changeCanvasSize)}),$LO(0,$Lr,"alignH",function(){return this._alignH},function($Lr){this._alignH=$Lr,$Lw.timer.callLater(this,this._changeCanvasSize)}),$LO(0,$Lr,"isFocused",function(){return this._isFocused}),$LO(0,$Lr,"height",$LR.prototype._$get_height,function($Lr){this.designHeight=$Lr,$Lw.superSet($LRr,this,"height",$Lr),$Lw.timer.callLater(this,this._changeCanvasSize)}),$LO(0,$Lr,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||$Le.create()},$LR.prototype._$set_transform),$LO(0,$Lr,"isVisibility",function(){return this._isVisibility}),$LO(0,$Lr,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),$LO(0,$Lr,"scaleMode",function(){return this._scaleMode},function($Lr){this._scaleMode=$Lr,$Lw.timer.callLater(this,this._changeCanvasSize)}),$LO(0,$Lr,"alignV",function(){return this._alignV},function($Lr){this._alignV=$Lr,$Lw.timer.callLater(this,this._changeCanvasSize)}),$LO(0,$Lr,"bgColor",function(){return this._bgColor},function($Lr){this._bgColor=$Lr,this.conchModel&&this.conchModel.bgColor($Lr),$LF.isWebGL&&($Lr?$LE._wgColor=$L$.create($Lr)._color:$Lq.onMiniGame||($LE._wgColor=null)),$Lq.onLimixiu?$LE._wgColor=$L$.create($Lr)._color:$LF.canvas.style.background=$Lr||"none"}),$LO(0,$Lr,"mouseX",function(){return Math.round($Lc.instance.mouseX/this.clientScaleX)}),$LO(0,$Lr,"mouseY",function(){return Math.round($Lc.instance.mouseY/this.clientScaleY)}),$LO(0,$Lr,"screenMode",function(){return this._screenMode},function($Lr){this._screenMode=$Lr}),$LO(0,$Lr,"visible",$LR.prototype._$get_visible,function($Lr){this.visible!==$Lr&&($Lw.superSet($LRr,this,"visible",$Lr),$LF._mainCanvas.source.style.visibility=$Lr?"visible":"hidden")}),$LO(0,$Lr,"fullScreenEnabled",null,function($Lr){var $Li=$Lq.document,$Lt=$LF.canvas;$Lr?($Lt.addEventListener("mousedown",this._requestFullscreen),$Lt.addEventListener("touchstart",this._requestFullscreen),$Li.addEventListener("fullscreenchange",this._fullScreenChanged),$Li.addEventListener("mozfullscreenchange",this._fullScreenChanged),$Li.addEventListener("webkitfullscreenchange",this._fullScreenChanged),$Li.addEventListener("msfullscreenchange",this._fullScreenChanged)):($Lt.removeEventListener("mousedown",this._requestFullscreen),$Lt.removeEventListener("touchstart",this._requestFullscreen),$Li.removeEventListener("fullscreenchange",this._fullScreenChanged),$Li.removeEventListener("mozfullscreenchange",this._fullScreenChanged),$Li.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),$Li.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),$LE.SCALE_NOSCALE="noscale",$LE.SCALE_EXACTFIT="exactfit",$LE.SCALE_SHOWALL="showall",$LE.SCALE_NOBORDER="noborder",$LE.SCALE_FULL="full",$LE.SCALE_FIXED_WIDTH="fixedwidth",$LE.SCALE_FIXED_HEIGHT="fixedheight",$LE.SCALE_FIXED_AUTO="fixedauto",$LE.ALIGN_LEFT="left",$LE.ALIGN_RIGHT="right",$LE.ALIGN_CENTER="center",$LE.ALIGN_TOP="top",$LE.ALIGN_MIDDLE="middle",$LE.ALIGN_BOTTOM="bottom",$LE.SCREEN_NONE="none",$LE.SCREEN_HORIZONTAL="horizontal",$LE.SCREEN_VERTICAL="vertical",$LE.FRAME_FAST="fast",$LE.FRAME_SLOW="slow",$LE.FRAME_MOUSE="mouse",$LE.FRAME_SLEEP="sleep",$LE.FRAME_MOUSE_THREDHOLD=2e3,$LN($LE,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),$LE}($LRr),$LCr=(function($Lr){function $Li(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,$Li.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}$Lg($Li,"laya.media.SoundNode",$LRr);var $Lt=$Li.prototype;$Lt._onParentChange=function(){this.target=this.parent},$Lt.play=function($Lr,$Li){void 0===$Lr&&($Lr=1),isNaN($Lr)&&($Lr=1),this.url&&(this.stop(),this._channel=$LU.playSound(this.url,$Lr,null,$Li))},$Lt.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},$Lt._setPlayAction=function($Lr,$Li,$Lt,$L_){void 0===$L_&&($L_=!0),this[$Lt]&&$Lr&&($L_?$Lr.on($Li,this,this[$Lt]):$Lr.off($Li,this,this[$Lt]))},$Lt._setPlayActions=function($Lr,$Li,$Lt,$L_){if(void 0===$L_&&($L_=!0),$Lr&&$Li){var $LA,$Lf=$Li.split(","),$LE=0;for($LA=$Lf.length,$LE=0;$LE<$LA;$LE++)this._setPlayAction($Lr,$Lf[$LE],$Lt,$L_)}},$LO(0,$Lt,"playEvent",null,function($Lr){(this._playEvents=$Lr)&&this._tar&&this._setPlayActions(this._tar,$Lr,"play")}),$LO(0,$Lt,"target",null,function($Lr){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=$Lr,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),$LO(0,$Lt,"stopEvent",null,function($Lr){(this._stopEvents=$Lr)&&this._tar&&this._setPlayActions(this._tar,$Lr,"stop")})}(),function($Lr){function $Li(){this._src=null,this._onload=null,this._onerror=null,$Li.__super.call(this)}$Lg($Li,"laya.resource.FileBitmap",$LOr);var $Lt=$Li.prototype;return $LO(0,$Lt,"src",function(){return this._src},function($Lr){this._src=$Lr}),$LO(0,$Lt,"onload",null,function($Lr){}),$LO(0,$Lt,"onerror",null,function($Lr){}),$Li}()),$Lnr=function($Lr){function $Lt($Lr,$Li){this._is2D=!1,$Lt.__super.call(this);var $L_=this;if(this._source=this,"2D"===$Lr||"AUTO"===$Lr&&!$LF.isWebGL){this._is2D=!0,this._source=$Li||$Lq.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var $LA=this;$LA.getContext=function($Lr,$Li){if($L_._ctx)return $L_._ctx;var $Lt=$L_._ctx=$L_._source.getContext($Lr,$Li);return $Lt&&($Lt._canvas=$LA,$LF.isFlash||$Lq.onLimixiu||($Lt.size=function($Lr,$Li){})),$Lt}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}$Lg($Lt,"laya.resource.HTMLCanvas",$LOr);var $Li=$Lt.prototype;return $Li.clear=function(){this._ctx&&this._ctx.clear()},$Li.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$Li.release=function(){},$Li._setContext=function($Lr){this._ctx=$Lr},$Li.getContext=function($Lr,$Li){return this._ctx?this._ctx:this._ctx=$Lt._createContext(this)},$Li.getMemSize=function(){return 0},$Li.size=function($Lr,$Li){(this._w!=$Lr||this._h!=$Li||this._source&&(this._source.width!=$Lr||this._source.height!=$Li))&&(this._w=$Lr,this._h=$Li,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size($Lr,$Li),this._source&&(this._source.height=$Li,this._source.width=$Lr))},$Li.getCanvas=function(){return this._source},$Li.toBase64=function($Lr,$Li,$Lt){if(this._source)if($LF.isConchApp&&this._source.toBase64)this._source.toBase64($Lr,$Li,$Lt);else{var $L_=this._source.toDataURL($Lr,$Li);$Lt.call(this,$L_)}},$LO(0,$Li,"context",function(){return this._ctx}),$LO(0,$Li,"asBitmap",null,function($Lr){}),$Lt.create=function($Lr,$Li){return new $Lt($Lr,$Li)},$Lt.TYPE2D="2D",$Lt.TYPE3D="3D",$Lt.TYPEAUTO="AUTO",$Lt._createContext=null,$Lt}(),$Lar=(function($Lr){function $LN($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){throw $LN.__super.call(this),new Error("不允许new！")}$Lg($LN,"laya.resource.HTMLSubImage",$LOr),$LN.create=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){return void 0===$LG&&($LG=!1),new $LN($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG)}}(),function($Lr){function $LR(){this._frames=null,this._url=null,$LR.__super.call(this),this._setControlNode(this)}$Lg($LR,"laya.display.Animation",$Lr);var $Li=$LR.prototype;$Li.destroy=function($Lr){void 0===$Lr&&($Lr=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,$Lr),this._frames=null,this._labels=null},$Li.play=function($Lr,$Li,$Lt,$L_){void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=!0),void 0===$Lt&&($Lt=""),void 0===$L_&&($L_=!0),$Lt&&this._setFramesFromCache($Lt,$L_),this._isPlaying=!0,this.index="string"==typeof $Lr?this._getFrameByLabel($Lr):$Lr,this.loop=$Li,this._actionName=$Lt,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$Li._setFramesFromCache=function($Lr,$Li){var $Lt;return void 0===$Li&&($Li=!1),this._url&&($Lr=this._url+"#"+$Lr),$Lr&&$LR.framesMap[$Lr]?(($Lt=$LR.framesMap[$Lr])instanceof Array?(this._frames=$LR.framesMap[$Lr],this._count=this._frames.length):($Lt.nodeRoot&&($LR.framesMap[$Lr]=this._parseGraphicAnimationByData($Lt),$Lt=$LR.framesMap[$Lr]),this._frames=$Lt.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=$Lt.interval),this._labels=this._copyLabels($Lt.labels)),!0):($Li&&console.log("ani not found:",$Lr),!1)},$Li._copyLabels=function($Lr){if(!$Lr)return null;var $Li,$Lt;for($Lt in $Li={},$Lr)$Li[$Lt]=$LK.copyArray([],$Lr[$Lt]);return $Li},$Li._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&$Lr.prototype._frameLoop.call(this)},$Li._displayToIndex=function($Lr){this._frames&&(this.graphics=this._frames[$Lr])},$Li.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},$Li.loadImages=function($Lr,$Li){return void 0===$Li&&($Li=""),this._url="",this._setFramesFromCache($Li)||(this.frames=$LR.framesMap[$Li]?$LR.framesMap[$Li]:$LR.createFrames($Lr,$Li)),this},$Li.loadAtlas=function($Li,$Lt,$L_){void 0===$L_&&($L_=""),this._url="";var $LA=this;function $Lr($Lr){$Li===$Lr&&($LA.frames=$LR.framesMap[$L_]?$LR.framesMap[$L_]:$LR.createFrames($Li,$L_),$Lt&&$Lt.run())}return $LA._setFramesFromCache($L_)||($LGr.getAtlas($Li)?$Lr($Li):$Lw.loader.load($Li,$LC.create(null,$Lr,[$Li]),null,"atlas")),this},$Li.loadAnimation=function($Lr,$Li,$Lt){this._url=$Lr;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,$Li&&$Li.run()):!$Lt||$LGr.getAtlas($Lt)?this._loadAnimationData($Lr,$Li,$Lt):$Lw.loader.load($Lt,$LC.create(this,this._loadAnimationData,[$Lr,$Li,$Lt]),null,"atlas"),this},$Li._loadAnimationData=function($LG,$LN,$Lr){var $Lp=this;if(!$Lr||$LGr.getAtlas($Lr)){var $Lg=this;$LGr.getRes($LG)?$Li($LG):$Lw.loader.load($LG,$LC.create(null,$Li,[$LG]),null,"json"),$LGr.clearRes($LG)}else console.warn("atlas load fail:"+$Lr);function $Li($Lr){if($LGr.getRes($Lr)&&$LG===$Lr){var $Li;if($LR.framesMap[$LG+"#"])$Lg._setFramesFromCache($Lp._actionName,!0),$Lp.index=0,$Lp._checkResumePlaying();else{var $Lt=$Lg._parseGraphicAnimation($LGr.getRes($LG));if(!$Lt)return;var $L_,$LA=$Lt.animationList,$Lf=0,$LE=$LA.length;for($Lf=0;$Lf<$LE;$Lf++)$Li=$LA[$Lf],$LR.framesMap[$LG+"#"+$Li.name]=$Li,$L_||($L_=$Li);$L_&&($LR.framesMap[$LG+"#"]=$L_,$Lg._setFramesFromCache($Lp._actionName,!0),$Lp.index=0),$Lp._checkResumePlaying()}$LN&&$LN.run()}}},$Li._parseGraphicAnimation=function($Lr){return $Lwr.parseAnimationData($Lr)},$Li._parseGraphicAnimationByData=function($Lr){return $Lwr.parseAnimationByData($Lr)},$LO(0,$Li,"frames",function(){return this._frames},function($Lr){(this._frames=$Lr)&&(this._count=$Lr.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),$LO(0,$Li,"autoPlay",null,function($Lr){$Lr?this.play():this.stop()}),$LO(0,$Li,"source",null,function($Lr){-1<$Lr.indexOf(".ani")?this.loadAnimation($Lr):-1<$Lr.indexOf(".json")||-1<$Lr.indexOf("als")||-1<$Lr.indexOf("atlas")?this.loadAtlas($Lr):this.loadImages($Lr.split(","))}),$LO(0,$Li,"autoAnimation",null,function($Lr){this.play(0,!0,$Lr,!1)}),$LR.createFrames=function($Lr,$Li){var $Lt,$L_,$LA=0,$Lf=0;if("string"==typeof $Lr){var $LE=$LGr.getAtlas($Lr);if($LE&&$LE.length)for($Lt=[],$LA=0,$Lf=$LE.length;$LA<$Lf;$LA++)($L_=new $Lk.createGraphics).drawTexture($LGr.getRes($LE[$LA]),0,0),$Lt.push($L_)}else if($Lr instanceof Array)for($Lt=[],$LA=0,$Lf=$Lr.length;$LA<$Lf;$LA++)($L_=new $Lk.createGraphics).loadImage($Lr[$LA],0,0),$Lt.push($L_);return $Li&&($LR.framesMap[$Li]=$Lt),$Lt},$LR.clearCache=function($Lr){var $Li,$Lt=$LR.framesMap,$L_=$Lr+"#";for($Li in $Lt)$Li!==$Lr&&0!=$Li.indexOf($L_)||delete $LR.framesMap[$Li]},$LR.framesMap={}}($Lcr),function($Lr){function $Lf(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,$Lf.__super.call(this),null==$Lf._sortIndexFun&&($Lf._sortIndexFun=$Lu.sortByKey("index",!1,!0))}$Lg($Lf,"laya.display.FrameAnimation",$Lr);var $Li=$Lf.prototype;return $Li._setUp=function($Lr,$Li){this._labels=null,this._animationNewFrames=null,this._targetDic=$Lr,this._animationData=$Li,this.interval=1e3/$Li.frameRate,$Li.parsed?(this._count=$Li.count,this._labels=$Li.labels,this._animationNewFrames=$Li.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),$Li.parsed=!0,$Li.labels=this._labels,$Li.count=this._count,$Li.animationNewFrames=this._animationNewFrames},$Li.clear=function(){$Lr.prototype.clear.call(this),this._targetDic=null,this._animationData=null},$Li._displayToIndex=function($Lr){if(this._animationData){$Lr<0&&($Lr=0),$Lr>this._count&&($Lr=this._count);var $Li=this._animationData.nodes,$Lt=0,$L_=$Li.length;for($Lt=0;$Lt<$L_;$Lt++)this._displayNodeToFrame($Li[$Lt],$Lr)}},$Li._displayNodeToFrame=function($Lr,$Li,$Lt){$Lt||($Lt=this._targetDic);var $L_=$Lt[$Lr.target];if($L_){var $LA,$Lf,$LE,$LG=$Lr.frames,$LN=$Lr.keys,$Lp=0,$Lg=$LN.length;for($Lp=0;$Lp<$Lg;$Lp++)$LE=($Lf=$LG[$LA=$LN[$Lp]]).length>$Li?$Lf[$Li]:$Lf[$Lf.length-1],$L_[$LA]=$LE}},$Li._calculateDatas=function(){if(this._animationData){var $Lr,$Li=this._animationData.nodes,$Lt=0,$L_=$Li.length;for($Lt=this._count=0;$Lt<$L_;$Lt++)$Lr=$Li[$Lt],this._calculateNodeKeyFrames($Lr);this._count+=1}},$Li._calculateNodeKeyFrames=function($Lr){var $Li,$Lt,$L_=$Lr.keyframes,$LA=$Lr.target;for($Li in $Lr.frames||($Lr.frames={}),$Lr.keys?$Lr.keys.length=0:$Lr.keys=[],$Lr.initValues||($Lr.initValues={}),$L_)$Lt=$L_[$Li],$Lr.frames[$Li]||($Lr.frames[$Li]=[]),this._targetDic&&this._targetDic[$LA]&&($Lr.initValues[$Li]=this._targetDic[$LA][$Li]),$Lt.sort($Lf._sortIndexFun),$Lr.keys.push($Li),this._calculateNodePropFrames($Lt,$Lr.frames[$Li],$Li,$LA)},$Li.resetToInitState=function(){if(this._targetDic&&this._animationData){var $Lr,$Li,$Lt=this._animationData.nodes,$L_=0,$LA=$Lt.length;for($L_=0;$L_<$LA;$L_++)if($Li=($Lr=$Lt[$L_]).initValues){var $Lf,$LE=this._targetDic[$Lr.target];if($LE)for($Lf in $Li)$LE[$Lf]=$Li[$Lf]}}},$Li._calculateNodePropFrames=function($Lr,$Li,$Lt,$L_){var $LA=0,$Lf=$Lr.length-1;if(0<$Lf){for($Li.length=$Lr[$Lf].index+1,$LA=0;$LA<$Lf;$LA++)this._dealKeyFrame($Lr[$LA]),this._calculateFrameValues($Lr[$LA],$Lr[$LA+1],$Li);this._dealKeyFrame($Lr[$LA])}0==$Lf&&($Li[$Lr[0].index]=$Lr[0].value,this._animationNewFrames&&(this._animationNewFrames[$Lr[0].index]=!0))},$Li._dealKeyFrame=function($Lr){$Lr.label&&""!=$Lr.label&&this.addLabel($Lr.label,$Lr.index)},$Li._calculateFrameValues=function($Lr,$Li,$Lt){var $L_,$LA=0,$Lf=$Lr.index,$LE=$Li.index,$LG=$Lr.value,$LN=$Li.value-$Lr.value,$Lp=$LE-$Lf;if($LE>this._count&&(this._count=$LE),$Lr.tween)for(null==($L_=$LI[$Lr.tweenMethod])&&($L_=$LI.linearNone),$LA=$Lf;$LA<$LE;$LA++)$Lt[$LA]=$L_($LA-$Lf,$LG,$LN,$Lp),this._animationNewFrames&&(this._animationNewFrames[$LA]=!0);else for($LA=$Lf;$LA<$LE;$LA++)$Lt[$LA]=$LG;this._animationNewFrames&&(this._animationNewFrames[$Lr.index]=!0,this._animationNewFrames[$Li.index]=!0),$Lt[$Li.index]=$Li.value},$Lf._sortIndexFun=null,$Lf}($Lcr)),$LDr=function($Li){function $LA(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",$LA.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=$LBr.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}$Lg($LA,"laya.display.Input",$Li);var $Lr=$LA.prototype;return $Lr.setSelection=function($Lr,$Li){this.focus=!0,laya.display.Input.inputElement.selectionStart=$Lr,laya.display.Input.inputElement.selectionEnd=$Li},$Lr._onUnDisplay=function($Lr){this.focus=!1},$Lr._onMouseDown=function($Lr){this.focus=!0},$Lr._syncInputTransform=function(){var $Lr=this.nativeInput,$Li=$LK.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),$Lt=this._width-this.padding[1]-this.padding[3],$L_=this._height-this.padding[0]-this.padding[2];$LF.isConchApp?($Lr.setScale($Li.scaleX,$Li.scaleY),$Lr.setSize($Lt,$L_),$Lr.setPos($Li.x,$Li.y)):($LA.inputContainer.style.transform=$LA.inputContainer.style.webkitTransform="scale("+$Li.scaleX+","+$Li.scaleY+") rotate("+$Lw.stage.canvasDegree+"deg)",$Lr.style.width=$Lt+"px",$Lr.style.height=$L_+"px",$LA.inputContainer.style.left=$Li.x+"px",$LA.inputContainer.style.top=$Li.y+"px")},$Lr.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},$Lr._setInputMethod=function(){$LA.input.parentElement&&$LA.inputContainer.removeChild($LA.input),$LA.area.parentElement&&$LA.inputContainer.removeChild($LA.area),$LA.inputElement=this._multiline?$LA.area:$LA.input,$LA.inputContainer.appendChild($LA.inputElement),$LBr.RightToLeft&&($LA.inputElement.style.direction="rtl")},$Lr._focusIn=function(){laya.display.Input.isInputting=!0;var $Lr=this.nativeInput;this._focus=!0;var $Li=$Lr.style;$Li.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),$Lr.readOnly=!this._editable,$LF.isConchApp&&($Lr.setType(this._type),$Lr.setForbidEdit(!this._editable)),$Lr.maxLength=this._maxChars;this.padding;if($Lr.type=this._type,$Lr.value=this._content,$Lr.placeholder=this._prompt,$Lw.stage.off("keydown",this,this._onKeyDown),$Lw.stage.on("keydown",this,this._onKeyDown),($Lw.stage.focus=this).event("focus"),$Lq.onPC&&$Lr.focus(),!$Lq.onMiniGame){this._text;this._text=null}this.typeset(),$Lr.setColor(this._originColor),$Lr.setFontSize(this.fontSize),$Lr.setFontFace($Lq.onIPhone&&$LBr._fontFamilyMap[this.font]||this.font),$LF.isConchApp&&$Lr.setMultiAble&&$Lr.setMultiAble(this._multiline),$Li.lineHeight=this.leading+this.fontSize+"px",$Li.fontStyle=this.italic?"italic":"normal",$Li.fontWeight=this.bold?"bold":"normal",$Li.textAlign=this.align,$Li.padding="0 0",this._syncInputTransform(),!$LF.isConchApp&&$Lq.onPC&&$Lw.timer.frameLoop(1,this,this._syncInputTransform)},$Lr._setPromptColor=function(){($LA.promptStyleDOM=$Lq.getElementById("promptStyle"))||(($LA.promptStyleDOM=$Lq.createElement("style")).setAttribute("id","promptStyle"),$Lq.document.head.appendChild($LA.promptStyleDOM)),$LA.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},$Lr._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?($Lw.superSet($LBr,this,"text",this._content),$Lw.superSet($LBr,this,"color",this._originColor)):($Lw.superSet($LBr,this,"text",this._prompt),$Lw.superSet($LBr,this,"color",this._promptColor)),$Lw.stage.off("keydown",this,this._onKeyDown),$Lw.stage.focus=null,this.event("blur"),$LF.isConchApp&&this.nativeInput.blur(),$Lq.onPC&&$Lw.timer.clear(this,this._syncInputTransform)},$Lr._onKeyDown=function($Lr){13===$Lr.keyCode&&($Lq.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},$Lr.changeText=function($Lr){this._content=$Lr,this._focus?(this.nativeInput.value=$Lr||"",this.event("change")):$Li.prototype.changeText.call(this,$Lr)},$LO(0,$Lr,"color",$Li.prototype._$get_color,function($Lr){this._focus&&this.nativeInput.setColor($Lr),$Lw.superSet($LBr,this,"color",this._content?$Lr:this._promptColor),this._originColor=$Lr}),$LO(0,$Lr,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function($Lr){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),$LO(0,$Lr,"multiline",function(){return this._multiline},function($Lr){this._multiline=$Lr,this.valign=$Lr?"top":"middle"}),$LO(0,$Lr,"maxChars",function(){return this._maxChars},function($Lr){$Lr<=0&&($Lr=1e5),this._maxChars=$Lr}),$LO(0,$Lr,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function($Lr){$Lw.superSet($LBr,this,"color",this._originColor),$Lr+="",this._focus?(this.nativeInput.value=$Lr||"",this.event("change")):(this._multiline||($Lr=$Lr.replace(/\r?\n/g,"")),(this._content=$Lr)?$Lw.superSet($LBr,this,"text",$Lr):($Lw.superSet($LBr,this,"text",this._prompt),$Lw.superSet($LBr,this,"color",this.promptColor)))}),$LO(0,$Lr,"nativeInput",function(){return this._multiline?$LA.area:$LA.input}),$LO(0,$Lr,"prompt",function(){return this._prompt},function($Lr){!this._text&&$Lr&&$Lw.superSet($LBr,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?$Lw.superSet($LBr,this,"text",this._text==this._prompt?$Lr:this._text):$Lw.superSet($LBr,this,"text",$Lr),this._prompt=$LBr.langPacks&&$LBr.langPacks[$Lr]?$LBr.langPacks[$Lr]:$Lr}),$LO(0,$Lr,"focus",function(){return this._focus},function($Lr){var $Li=this.nativeInput;this._focus!==$Lr&&($Lr?($Li.target?$Li.target._focusOut():this._setInputMethod(),($Li.target=this)._focusIn()):($Li.target=null,this._focusOut(),$Lq.document.body.scrollTop=0,$Li.blur(),$LF.isConchApp?$Li.setPos(-1e4,-1e4):$LA.inputContainer.contains($Li)&&$LA.inputContainer.removeChild($Li)))}),$LO(0,$Lr,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function($Lr){$Lr?(-1<($Lr="[^"+$Lr+"]").indexOf("^^")&&($Lr=$Lr.replace("^^","")),this._restrictPattern=new RegExp($Lr,"g")):this._restrictPattern=null}),$LO(0,$Lr,"editable",function(){return this._editable},function($Lr){this._editable=$Lr,$LF.isConchApp&&$LA.input.setForbidEdit(!$Lr)}),$LO(0,$Lr,"promptColor",function(){return this._promptColor},function($Lr){this._promptColor=$Lr,this._content||$Lw.superSet($LBr,this,"color",$Lr)}),$LO(0,$Lr,"type",function(){return this._type},function($Lr){this._getCSSStyle().password="password"==$Lr,this._type=$Lr,$LF.isConchApp&&this.nativeInput.setType($Lr)}),$LO(0,$Lr,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function($Lr){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),$LO(0,$Lr,"asPassword",function(){return this._getCSSStyle().password},function($Lr){this._getCSSStyle().password=$Lr,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),$LA.__init__=function(){$LA._createInputElement(),$Lq.onMobile&&$LF.canvas.addEventListener($LA.IOS_IFRAME?$Lq.onMiniGame?"touchend":"click":"touchend",$LA._popupInputMethod)},$LA._popupInputMethod=function($Lr){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},$LA._createInputElement=function(){$LA._initInput($LA.area=$Lq.createElement("textarea")),$LA._initInput($LA.input=$Lq.createElement("input")),($LA.inputContainer=$Lq.createElement("div")).style.position="absolute",$LA.inputContainer.style.zIndex=1e5,$Lq.container.appendChild($LA.inputContainer),$LA.inputContainer.setPos=function($Lr,$Li){$LA.inputContainer.style.left=$Lr+"px",$LA.inputContainer.style.top=$Li+"px"}},$LA._initInput=function($Li){var $Lr=$Li.style;$Lr.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",$Lr.resize="none",$Lr.backgroundColor="transparent",$Lr.border="none",$Lr.outline="none",$Lr.zIndex=1,$Li.addEventListener("input",$LA._processInputting),$Li.addEventListener("mousemove",$LA._stopEvent),$Li.addEventListener("mousedown",$LA._stopEvent),$Li.addEventListener("touchmove",$LA._stopEvent),$Li.setFontFace=function($Lr){$Li.style.fontFamily=$Lr},$LF.isConchApp||($Li.setColor=function($Lr){$Li.style.color=$Lr},$Li.setFontSize=function($Lr){$Li.style.fontSize=$Lr+"px"})},$LA._processInputting=function($Lr){var $Li=laya.display.Input.inputElement.target;if($Li){var $Lt=laya.display.Input.inputElement.value;$Li._restrictPattern&&($Lt=$Lt.replace(/\u2006|\x27/g,""),$Li._restrictPattern.test($Lt)&&($Lt=$Lt.replace($Li._restrictPattern,""),laya.display.Input.inputElement.value=$Lt)),$Li._text=$Lt,$Li.event("input")}},$LA._stopEvent=function($Lr){"touchmove"==$Lr.type&&$Lr.preventDefault(),$Lr.stopPropagation&&$Lr.stopPropagation()},$LA.TYPE_TEXT="text",$LA.TYPE_PASSWORD="password",$LA.TYPE_EMAIL="email",$LA.TYPE_URL="url",$LA.TYPE_NUMBER="number",$LA.TYPE_RANGE="range",$LA.TYPE_DATE="date",$LA.TYPE_MONTH="month",$LA.TYPE_WEEK="week",$LA.TYPE_TIME="time",$LA.TYPE_DATE_TIME="datetime",$LA.TYPE_DATE_TIME_LOCAL="datetime-local",$LA.TYPE_SEARCH="search",$LA.input=null,$LA.area=null,$LA.inputElement=null,$LA.inputContainer=null,$LA.confirmButton=null,$LA.promptStyleDOM=null,$LA.inputHeight=45,$LA.isInputting=!1,$LA.stageMatrix=null,$LN($LA,["IOS_IFRAME",function(){return this.IOS_IFRAME=$Lq.onIOS&&$Lq.window.top!=$Lq.window.self}]),$LA}($LBr),$Lur=function($Lr){function $Lt($Lr,$Li){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,$Lt.__super.call(this),$Lr&&this._init_($Lr,$Li)}$Lg($Lt,"laya.resource.HTMLImage",$LCr);var $Li=$Lt.prototype;return $Li._init_=function($Lr,$Li){this._src=$Lr,this._source=new $Lq.window.Image,$Li&&($Li.onload&&(this.onload=$Li.onload),$Li.onerror&&(this.onerror=$Li.onerror),$Li.onCreate&&$Li.onCreate(this)),0!=$Lr.indexOf("data:image")&&(this._source.crossOrigin=""),$Lr&&(this._source.src=$Lr)},$Li.recreateResource=function(){var $Lr=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var $Li=this;this._source=new $Lq.window.Image,this._source.crossOrigin="",this._source.onload=function(){if($Li._needReleaseAgain)return $Li._needReleaseAgain=!1,$Li._source.onload=null,void($Li._source=null);$Li._source.onload=null,$Li.memorySize=$Lr._w*$Lr._h*4,$Li._recreateLock=!1,$Li.completeCreate()},this._source.src=this._src}},$Li.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},$Li.onresize=function(){this._w=this._source.width,this._h=this._source.height},$LO(0,$Li,"onload",null,function($Lr){var $Li=this;this._onload=$Lr,this._source&&(this._source.onload=null!=this._onload?function(){$Li.onresize(),$Li._onload()}:null)}),$LO(0,$Li,"onerror",null,function($Lr){var $Li=this;this._onerror=$Lr,this._source&&(this._source.onerror=null!=this._onerror?function(){$Li._onerror()}:null)}),$LO(0,$Li,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($Lr){this._enableMerageInAtlas=$Lr,$LF.isConchApp&&this._source&&(this._source.enableMerageInAtlas=$Lr)}),$Lt.create=function($Lr,$Li){return new $Lt($Lr,$Li)},$Lt}(),$Lwr=(function($Lf){function $Lr(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,$Lr.__super.call(this)}$Lg($Lr,"laya.display.EffectAnimation",$Lf);var $Li=$Lr.prototype;$Li._onOtherBegin=function($Lr){$Lr!=this&&this.stop()},$Li.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},$Li._onPlayAction=function(){this.play(0,!1)},$Li.play=function($Lr,$Li,$Lt,$L_){void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=!0),void 0===$Lt&&($Lt=""),void 0===$L_&&($L_=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,$Lr,$Li,$Lt,$L_))},$Li._recordInitData=function(){if(this._aniKeys){var $Lr,$Li,$Lt=0;for($Lr=this._aniKeys.length,$Lt=0;$Lt<$Lr;$Lt++)$Li=this._aniKeys[$Lt],this._initData[$Li]=this._target[$Li]}},$Li._displayToIndex=function($Lr){if(this._animationData){$Lr<0&&($Lr=0),$Lr>this._count&&($Lr=this._count);var $Li=this._animationData.nodes,$Lt=0,$L_=$Li.length;for($L_=1<$L_?1:$L_,$Lt=0;$Lt<$L_;$Lt++)this._displayNodeToFrame($Li[$Lt],$Lr)}},$Li._displayNodeToFrame=function($Lr,$Li,$Lt){if(this._target){var $L_;$L_=this._target;var $LA,$Lf,$LE,$LG,$LN=$Lr.frames,$Lp=$Lr.keys,$Lg=0,$LR=$Lp.length;$LG=$Lr.secondFrames;var $LX,$Lv,$LO,$Lc,$LB=0;for($Lg=0;$Lg<$LR;$Lg++)$Lf=$LN[$LA=$Lp[$Lg]],$LE=-1==($LB=$LG[$LA])?this._initData[$LA]:$Li<$LB?($LO=($Lv=$Lr.keyframes[$LA])[0]).tween?(null==($LX=$LI[$LO.tweenMethod])&&($LX=$LI.linearNone),$Lc=$Lv[1],$LX($Li,this._initData[$LA],$Lc.value-this._initData[$LA],$Lc.index)):this._initData[$LA]:$Lf.length>$Li?$Lf[$Li]:$Lf[$Lf.length-1],$L_[$LA]=$LE}},$Li._calculateNodeKeyFrames=function($Lr){$Lf.prototype._calculateNodeKeyFrames.call(this,$Lr);var $Li,$Lt,$L_,$LA=$Lr.keyframes;$Lr.target;for($Li in $L_={},$Lr.secondFrames=$L_,$LA)($Lt=$LA[$Li]).length<=1?$L_[$Li]=-1:$L_[$Li]=$Lt[1].index},$LO(0,$Li,"target",function(){return this._target},function($Lr){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=$Lr,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),$LO(0,$Li,"playEvent",null,function($Lr){(this._playEvents=$Lr)&&this.addEvent()}),$LO(0,$Li,"effectData",null,function($Lr){var $Li;$Lr&&(($Li=$Lr.animations)&&$Li[0]&&(this._setUp({},$Li[0]),$Li[0].nodes&&$Li[0].nodes[0]&&(this._aniKeys=$Li[0].nodes[0].keys)))}),$LO(0,$Li,"effectClass",null,function($Lr){var $Li,$Lt;(this._effectClass=$Lx.getClass($Lr),this._effectClass)&&(($Li=this._effectClass.uiView)&&($Lt=$Li.animations)&&$Lt[0]&&(this._setUp({},$Lt[0]),$Lt[0].nodes&&$Lt[0].nodes[0]&&(this._aniKeys=$Lt[0].nodes[0].keys)))}),$Lr.EffectAnimationBegin="effectanimationbegin"}($Lar),function($Li){var $Ll;function $LU(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,$LU.__super.call(this)}$Lg($LU,"laya.utils.GraphicAnimation",$Li);var $Lr=$LU.prototype;return $Lr._parseNodeList=function($Lr){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[$Lr.compId]=$Lr.props,$Lr.compId&&this._nodeList.push($Lr.compId);var $Li=$Lr.child;if($Li){var $Lt=0,$L_=$Li.length;for($Lt=0;$Lt<$L_;$Lt++)this._parseNodeList($Li[$Lt])}},$Lr._calGraphicData=function($Lr){var $Li;if(this._setUp(null,$Lr),this._createGraphicData(),this._nodeIDAniDic)for($Li in this._nodeIDAniDic)this._nodeIDAniDic[$Li]=null},$Lr._createGraphicData=function(){var $Lr,$Li=[],$Lt=0,$L_=this.count,$LA=this._animationNewFrames;for($LA||($LA=[]),$Lt=0;$Lt<$L_;$Lt++)!$LA[$Lt]&&$Lr||($Lr=this._createFrameGraphic($Lt)),$Li.push($Lr);this._gList=$Li},$Lr._createFrameGraphic=function($Lr){var $Li=$Lk.createGraphics();return $LU._rootMatrix||($LU._rootMatrix=new $Le),this._updateNodeGraphic(this._rootNode,$Lr,$LU._rootMatrix,$Li),$Li},$Lr._updateNodeGraphic=function($Lr,$Li,$Lt,$L_,$LA){var $Lf;void 0===$LA&&($LA=1);var $LE,$LG,$LN,$Lp=($Lf=this._nodeGDic[$Lr.compId]=this._getNodeGraphicData($Lr.compId,$Li,this._nodeGDic[$Lr.compId])).alpha*$LA;if(!($Lp<.01)&&($Lf.resultTransform||($Lf.resultTransform=$Le.create()),$LE=$Lf.resultTransform,$Le.mul($Lf.transform,$Lt,$LE),$Lf.skin&&($LG=this._getTextureByUrl($Lf.skin))&&($LE._checkTransform()?($L_.drawTexture($LG,0,0,$Lf.width,$Lf.height,$LE,$Lp),$Lf.resultTransform=null):$L_.drawTexture($LG,$LE.tx,$LE.ty,$Lf.width,$Lf.height,null,$Lp)),$LN=$Lr.child)){var $Lg,$LR=0;for($Lg=$LN.length,$LR=0;$LR<$Lg;$LR++)this._updateNodeGraphic($LN[$LR],$Li,$LE,$L_,$Lp)}},$Lr._updateNoChilds=function($Lr,$Li){if($Lr.skin){var $Lt=this._getTextureByUrl($Lr.skin);if($Lt){var $L_=$Lr.transform;$L_._checkTransform();!$L_.bTransform?$Li.drawTexture($Lt,$L_.tx,$L_.ty,$Lr.width,$Lr.height,null,$Lr.alpha):$Li.drawTexture($Lt,0,0,$Lr.width,$Lr.height,$L_.clone(),$Lr.alpha)}}},$Lr._updateNodeGraphic2=function($Lr,$Li,$Lt){var $L_;if($L_=this._nodeGDic[$Lr.compId]=this._getNodeGraphicData($Lr.compId,$Li,this._nodeGDic[$Lr.compId]),$Lr.child){var $LA=$L_.transform;$LA._checkTransform();var $Lf,$LE;$LE=($Lf=!$LA.bTransform)&&(0!=$LA.tx||0!=$LA.ty);var $LG,$LN,$Lp;if(($LG=$LA.bTransform||1!=$L_.alpha)&&$Lt.save(),1!=$L_.alpha&&$Lt.alpha($L_.alpha),$Lf?$LE&&$Lt.translate($LA.tx,$LA.ty):$Lt.transform($LA.clone()),$LN=$Lr.child,$L_.skin&&($Lp=this._getTextureByUrl($L_.skin))&&$Lt.drawTexture($Lp,0,0,$L_.width,$L_.height),$LN){var $Lg,$LR=0;for($Lg=$LN.length,$LR=0;$LR<$Lg;$LR++)this._updateNodeGraphic2($LN[$LR],$Li,$Lt)}$LG?$Lt.restore():$Lf?$LE&&$Lt.translate(-$LA.tx,-$LA.ty):$Lt.transform($LA.clone().invert())}else this._updateNoChilds($L_,$Lt)},$Lr._calculateNodeKeyFrames=function($Lr){$Li.prototype._calculateNodeKeyFrames.call(this,$Lr),this._nodeIDAniDic[$Lr.target]=$Lr},$Lr.getNodeDataByID=function($Lr){return this._nodeIDAniDic[$Lr]},$Lr._getParams=function($Lr,$Li,$Lt,$L_){var $LA=$LU._temParam;$LA.length=$Li.length;var $Lf=0,$LE=$Li.length;for($Lf=0;$Lf<$LE;$Lf++)$LA[$Lf]=this._getObjVar($Lr,$Li[$Lf][0],$Lt,$Li[$Lf][1],$L_);return $LA},$Lr._getObjVar=function($Lr,$Li,$Lt,$L_,$LA){if($Lr.hasOwnProperty($Li)){var $Lf=$Lr[$Li];if($Lt>=$Lf.length&&($Lt=$Lf.length-1),null!=$Lr[$Li][$Lt])return $Lr[$Li][$Lt]}return $LA.hasOwnProperty($Li)?$LA[$Li]:$L_},$Lr._getNodeGraphicData=function($Lr,$Li,$Lt){$Lt||($Lt=$Ll.create()),$Lt.transform?$Lt.transform.identity():$Lt.transform=$Le.create();var $L_=this.getNodeDataByID($Lr);if(!$L_)return $Lt;var $LA,$Lf,$LE=$L_.frames,$LG=this._getParams($LE,$LU._drawTextureCmd,$Li,this._nodeDefaultProps[$Lr]),$LN=$LG[0],$Lp=NaN,$Lg=NaN,$LR=$LG[5],$LX=$LG[6],$Lv=$LG[13],$LO=$LG[14],$Lc=$LG[7],$LB=$LG[8],$Ly=$LG[9],$LC=$LG[11],$Ln=$LG[12];$Lp=$LG[3],$Lg=$LG[4],0!=$Lp&&0!=$Lg||($LN=null),-1==$Lp&&($Lp=0),-1==$Lg&&($Lg=0),$Lt.skin=$LN,$Lt.width=$Lp,$Lt.height=$Lg,$LN&&(($LA=this._getTextureByUrl($LN))?($Lp||($Lp=$LA.sourceWidth),$Lg||($Lg=$LA.sourceHeight)):console.warn("lost skin:",$LN,",you may load pics first")),$Lt.alpha=$LG[10],$Lf=$Lt.transform,0!=$Lv&&($LR=$Lv*$Lp),0!=$LO&&($LX=$LO*$Lg),0==$LR&&0==$LX||$Lf.translate(-$LR,-$LX);var $La=null;if($Ly||1!==$Lc||1!==$LB||$LC||$Ln){($La=$LU._tempMt).identity(),$La.bTransform=!0;var $LD=.0174532922222222*($Ly-$LC),$Lu=.0174532922222222*($Ly+$Ln),$Lw=Math.cos($Lu),$LH=Math.sin($Lu),$Ls=Math.sin($LD),$Ld=Math.cos($LD);$La.a=$Lc*$Lw,$La.b=$Lc*$LH,$La.c=-$LB*$Ls,$La.d=$LB*$Ld,$La.tx=$La.ty=0}return $La&&($Lf=$Le.mul($Lf,$La,$Lf)),$Lf.translate($LG[1],$LG[2]),$Lt},$Lr._getTextureByUrl=function($Lr){return $LGr.getRes($Lr)},$Lr.setAniData=function($Lr,$Li){if($Lr.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$Lr,this._parseNodeList($Lr);var $Lt,$L_={},$LA=[],$Lf=$Lr.animations,$LE=0,$LG=$Lf.length;for($LE=0;$LE<$LG;$LE++)if($Lt=$Lf[$LE],this._labels=null,(!$Li||$Li==$Lt.name)&&$Lt){try{this._calGraphicData($Lt)}catch($Lr){console.warn("parse animation fail:"+$Lt.name+",empty animation created"),this._gList=[]}var $LN={};$LN.interval=1e3/$Lt.frameRate,$LN.frames=this._gList,$LN.labels=this._labels,$LN.name=$Lt.name,$LA.push($LN),$L_[$Lt.name]=$LN}this.animationList=$LA,this.animationDic=$L_}$LU._temParam.length=0},$Lr.parseByData=function($Lr){var $Li,$Lt;$Li=$Lr.nodeRoot,$Lt=$Lr.aniO,delete $Lr.nodeRoot,delete $Lr.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$Li,this._parseNodeList($Li),this._labels=null;try{this._calGraphicData($Lt)}catch($Lr){console.warn("parse animation fail:"+$Lt.name+",empty animation created"),this._gList=[]}var $L_=$Lr;return $L_.interval=1e3/$Lt.frameRate,$L_.frames=this._gList,$L_.labels=this._labels,$L_.name=$Lt.name,$L_},$Lr.setUpAniData=function($Lr){if($Lr.animations){var $Li,$Lt={},$L_=[],$LA=$Lr.animations,$Lf=0,$LE=$LA.length;for($Lf=0;$Lf<$LE;$Lf++)if($Li=$LA[$Lf]){var $LG={};$LG.name=$Li.name,$LG.aniO=$Li,$LG.nodeRoot=$Lr,$L_.push($LG),$Lt[$Li.name]=$LG}this.animationList=$L_,this.animationDic=$Lt}},$Lr._clear=function(){var $Lr,$Li;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for($Lr in this._nodeGDic)($Li=this._nodeGDic[$Lr])&&$Li.recover();this._nodeGDic=null},$LU.parseAnimationByData=function($Lr){var $Li;return $LU._I||($LU._I=new $LU),$Li=$LU._I.parseByData($Lr),$LU._I._clear(),$Li},$LU.parseAnimationData=function($Lr){var $Li;return $LU._I||($LU._I=new $LU),$LU._I.setUpAniData($Lr),($Li={}).animationList=$LU._I.animationList,$Li.animationDic=$LU._I.animationDic,$LU._I._clear(),$Li},$LU._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],$LU._temParam=[],$LU._I=null,$LU._rootMatrix=null,$LN($LU,["_tempMt",function(){return this._tempMt=new $Le}]),$LU.__init$=function(){$Ll=function(){function $Lr(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return $Lg($Lr,""),$Lr.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),$LJ.recover("GraphicNode",this)},$Lr.create=function(){return $LJ.getItemByClass("GraphicNode",$Lr)},$Lr}()},$LU}($Lar));$Lw.__init([$Lp,$LNr,$LF,$Lq,$LW,$Ld,$Lr,$Lwr])}(window,document,Laya),function($Lr,$Li,$Lt){$Lt.un,$Lt.uns,$Lt.static;var $L_=$Lt.class;$Lt.getset,$Lt.__newvec;new(function(){function $Lr(){}return $L_($Lr,"LayaMain"),$Lr}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($Lr,$Li){"use strict";for(var $Lt in Object.defineProperty($Li,"__esModule",{value:!0}),Laya){var $L_=Laya[$Lt];$L_&&$L_.__isclass&&($Li[$Lt]=$L_)}}),function($Lr,$Li,$Lu){$Lu.un,$Lu.uns;var $LE=$Lu.static,$LX=$Lu.class,$L_=$Lu.getset,$Lf=$Lu.__newvec,$Lg=laya.maths.Arith,$LR=laya.maths.Bezier,$Lt=laya.resource.Bitmap,$Lv=laya.utils.Browser,$LN=laya.utils.Byte,$LO=laya.utils.Color,$Lw=(laya.filters.ColorFilter,$Lu.Config),$LA=laya.resource.Context,$LH=(laya.events.Event,laya.filters.Filter),$LG=laya.display.Graphics,$Lp=laya.resource.HTMLCanvas,$Lc=(laya.utils.HTMLChar,laya.resource.HTMLImage),$LB=laya.resource.HTMLSubImage,$Ls=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),$Ld=laya.maths.Point,$Ll=laya.maths.Rectangle,$Ly=laya.renders.Render,$LC=(laya.renders.RenderContext,laya.renders.RenderSprite),$Ln=laya.resource.Resource,$La=laya.resource.ResourceManager,$LD=laya.utils.RunDriver,$LU=laya.display.Sprite,$Lk=laya.display.Stage,$Le=laya.utils.Stat,$LL=laya.utils.StringKey,$LQ=(laya.display.css.Style,laya.system.System),$LF=laya.display.Text,$Lb=laya.resource.Texture,$LV=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),$Lh=laya.utils.VectorGraphManager;laya.utils.WordText;$Lu.interface("laya.webgl.shapes.IShape"),$Lu.interface("laya.webgl.submit.ISubmit"),$Lu.interface("laya.webgl.text.ICharSegment"),$Lu.interface("laya.webgl.canvas.save.ISaveData"),$Lu.interface("laya.webgl.resource.IMergeAtlasBitmap"),$Lu.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var $LP=function(){function $Lr(){}$LX($Lr,"laya.filters.webgl.FilterActionGL");var $Li=$Lr.prototype;return $Lu.imps($Li,{"laya.filters.IFilterActionGL":!0}),$Li.setValue=function($Lr){},$Li.setValueMix=function($Lr){},$Li.apply3d=function($Lr,$Li,$Lt,$L_,$LA){return null},$Li.apply=function($Lr){return null},$L_(0,$Li,"typeMix",function(){return 0}),$Lr}(),$Lq=function(){function $Lr(){}return $LX($Lr,"laya.webgl.shader.ShaderValue"),$Lr}(),$Lm=function(){var $L_,$LA;function $Lr($Lr,$Li,$Lt){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new $LA,void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),this._cells=null,this._rowInfo=null,this._init($Lr,$Li),this._atlasID=$Lt}$LX($Lr,"laya.webgl.atlas.AtlasGrid");var $Li=$Lr.prototype;return $Li.getAltasID=function(){return this._atlasID},$Li.setAltasID=function($Lr){0<=$Lr&&(this._atlasID=$Lr)},$Li.addTex=function($Lr,$Li,$Lt){var $L_=this._get($Li,$Lt);return 0==$L_.ret||(this._fill($L_.x,$L_.y,$Li,$Lt,$Lr),this._texCount++),$L_},$Li._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},$Li._init=function($Lr,$Li){if(this._width=$Lr,this._height=$Li,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=$Lf(this._height);for(var $Lt=0;$Lt<this._height;$Lt++)this._rowInfo[$Lt]=new $L_;return this._clear(),!0},$Li._get=function($Lr,$Li){var $Lt=new $Lx;if($Lr>=this._failSize.width&&$Li>=this._failSize.height)return $Lt;for(var $L_=-1,$LA=-1,$Lf=this._width,$LE=this._height,$LG=this._cells,$LN=0;$LN<$LE;$LN++)if(!(this._rowInfo[$LN].spaceCount<$Lr))for(var $Lp=0;$Lp<$Lf;){var $Lg=3*($LN*$Lf+$Lp);if(0!=$LG[$Lg]||$LG[1+$Lg]<$Lr||$LG[2+$Lg]<$Li)$Lp+=$LG[1+$Lg];else{$L_=$Lp,$LA=$LN;for(var $LR=0;$LR<$Lr;$LR++)if($LG[3*$LR+$Lg+2]<$Li){$L_=-1;break}if(!($L_<0))return $Lt.ret=!0,$Lt.x=$L_,$Lt.y=$LA,$Lt;$Lp+=$LG[1+$Lg]}}return $Lt},$Li._fill=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=this._width,$LE=this._height;this._check($Lr+$Lt<=$Lf&&$Li+$L_<=$LE);for(var $LG=$Li;$LG<$L_+$Li;++$LG){this._check(this._rowInfo[$LG].spaceCount>=$Lt),this._rowInfo[$LG].spaceCount-=$Lt;for(var $LN=0;$LN<$Lt;$LN++){var $Lp=3*($Lr+$LG*$Lf+$LN);this._check(0==this._cells[$Lp]),this._cells[$Lp]=$LA,this._cells[1+$Lp]=$Lt,this._cells[2+$Lp]=$L_}}if(0<$Lr)for($LG=0;$LG<$L_;++$LG){var $Lg=0;for($LN=$Lr-1;0<=$LN&&0==this._cells[3*(($Li+$LG)*$Lf+$LN)];--$LN,++$Lg);for($LN=$Lg;0<$LN;--$LN)this._cells[3*(($Li+$LG)*$Lf+$Lr-$LN)+1]=$LN,this._check(0<$LN)}if(0<$Li)for($LN=$Lr;$LN<$Lr+$Lt;++$LN){for($Lg=0,$LG=$Li-1;0<=$LG&&0==this._cells[3*($LN+$LG*$Lf)];--$LG,$Lg++);for($LG=$Lg;0<$LG;--$LG)this._cells[3*($LN+($Li-$LG)*$Lf)+2]=$LG,this._check(0<$LG)}},$Li._check=function($Lr){0==$Lr&&console.log("xtexMerger 错误啦")},$Li._clear=function(){for(var $Lr=this._texCount=0;$Lr<this._height;$Lr++)this._rowInfo[$Lr].spaceCount=this._width;for(var $Li=0;$Li<this._height;$Li++)for(var $Lt=0;$Lt<this._width;$Lt++){var $L_=3*($Li*this._width+$Lt);this._cells[$L_]=0,this._cells[1+$L_]=this._width-$Lt,this._cells[2+$L_]=this._width-$Li}this._failSize.width=this._width+1,this._failSize.height=this._height+1},$Lr.__init$=function(){$L_=function(){function $Lr(){this.spaceCount=0}return $LX($Lr,""),$Lr}(),$LA=function(){function $Lr(){this.width=0,this.height=0}return $LX($Lr,""),$Lr}()},$Lr}(),$LT=function(){function $Ly($Lr,$Li,$Lt,$L_){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=$Lr,this._height=$Li,this._gridSize=$Lt,this._maxAtlaserCount=$L_,this._gridNumX=$Lr/$Lt,this._gridNumY=$Li/$Lt,this._curAtlasIndex=0,this._atlaserArray=[]}$LX($Ly,"laya.webgl.atlas.AtlasResourceManager");var $Lr=$Ly.prototype;return $Lr.setAtlasParam=function($Lr,$Li,$Lt,$L_){if(1==this._setAtlasParam)return $Ly._sid_=0,this._width=$Lr,this._height=$Li,this._gridSize=$Lt,this._maxAtlaserCount=$L_,this._gridNumX=$Lr/$Lt,this._gridNumY=$Li/$Lt,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},$Lr.pushData=function($Lr){var $Li,$Lt=$Lr.bitmap,$L_=-1,$LA=null,$Lf=0,$LE=0;for($Lf=0,$Li=this._atlaserArray.length;$Lf<$Li&&($LE=(this._curAtlasIndex+$Lf)%$Li,-1==($L_=($LA=this._atlaserArray[$LE]).findBitmapIsExist($Lt)));$Lf++);if(-1!=$L_){var $LG=$LA.InAtlasWebGLImagesOffsetValue[$L_];return $LO=$LG[0],$Lc=$LG[1],$LA.addToAtlas($Lr,$LO,$Lc),!0}this._setAtlasParam=!1;for(var $LN=Math.ceil(($Lr.bitmap.width+2)/this._gridSize),$Lp=Math.ceil(($Lr.bitmap.height+2)/this._gridSize),$Lg=!1,$LR=0;$LR<2;$LR++){var $LX=this._maxAtlaserCount;for($Lf=0;$Lf<$LX;$Lf++){$LE=(this._curAtlasIndex+$Lf)%$LX,this._atlaserArray.length-1>=$LE||this._atlaserArray.push(new $Llr(this._gridNumX,this._gridNumY,this._width,this._height,$Ly._sid_++));var $Lv=this._atlaserArray[$LE],$LO=0,$Lc=0,$LB=$Lv.addTex(1,$LN,$Lp);if($LB.ret){$LO=$LB.x*this._gridSize+1,$Lc=$LB.y*this._gridSize+1,$Lt.lock=!0,$Lv.addToAtlasTexture($Lt,$LO,$Lc),$Lv.addToAtlas($Lr,$LO,$Lc),$Lg=!0,this._curAtlasIndex=$LE;break}}if($Lg)break;this._atlaserArray.push(new $Llr(this._gridNumX,this._gridNumY,this._width,this._height,$Ly._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return $Lg||console.log(">>>AtlasManager pushData error"),$Lg},$Lr.addToAtlas=function($Lr){laya.webgl.atlas.AtlasResourceManager.instance.pushData($Lr)},$Lr.garbageCollection=function(){if(!0===this._needGC){for(var $Lr=this._atlaserArray.length-this._maxAtlaserCount,$Li=0;$Li<$Lr;$Li++)this._atlaserArray[$Li].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+$Lr),this._atlaserArray.splice(0,$Lr),this._needGC=!1}return!0},$Lr.freeAll=function(){for(var $Lr=0,$Li=this._atlaserArray.length;$Lr<$Li;$Lr++)this._atlaserArray[$Lr].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},$Lr.getAtlaserCount=function(){return this._atlaserArray.length},$Lr.getAtlaserByIndex=function($Lr){return this._atlaserArray[$Lr]},$L_(1,$Ly,"instance",function(){return $Ly._Instance||($Ly._Instance=new $Ly(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),$Ly._Instance}),$L_(1,$Ly,"enabled",function(){return $Lw.atlasEnable}),$L_(1,$Ly,"atlasLimitWidth",function(){return $Ly._atlasLimitWidth},function($Lr){$Ly._atlasLimitWidth=$Lr}),$L_(1,$Ly,"atlasLimitHeight",function(){return $Ly._atlasLimitHeight},function($Lr){$Ly._atlasLimitHeight=$Lr}),$Ly._enable=function(){$Lw.atlasEnable=!0},$Ly._disable=function(){$Lw.atlasEnable=!1},$Ly.__init__=function(){$Ly.atlasTextureWidth=2048,$Ly.atlasTextureHeight=2048,$Ly.maxTextureCount=6,$Ly.atlasLimitWidth=512,$Ly.atlasLimitHeight=512},$Ly._atlasLimitWidth=0,$Ly._atlasLimitHeight=0,$Ly.gridSize=16,$Ly.atlasTextureWidth=0,$Ly.atlasTextureHeight=0,$Ly.maxTextureCount=0,$Ly._atlasRestore=0,$Ly.BOARDER_TYPE_NO=0,$Ly.BOARDER_TYPE_RIGHT=1,$Ly.BOARDER_TYPE_LEFT=2,$Ly.BOARDER_TYPE_BOTTOM=4,$Ly.BOARDER_TYPE_TOP=8,$Ly.BOARDER_TYPE_ALL=15,$Ly._sid_=0,$Ly._Instance=null,$Ly}(),$Lx=function(){function $Lr(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return $LX($Lr,"laya.webgl.atlas.MergeFillInfo"),$Lr}(),$L$=function(){function $Li(){}return $LX($Li,"laya.webgl.canvas.BlendMode"),$Li._init_=function($Lr){$Li.fns=[$Li.BlendNormal,$Li.BlendAdd,$Li.BlendMultiply,$Li.BlendScreen,$Li.BlendOverlay,$Li.BlendLight,$Li.BlendMask,$Li.BlendDestinationOut],$Li.targetFns=[$Li.BlendNormalTarget,$Li.BlendAddTarget,$Li.BlendMultiplyTarget,$Li.BlendScreenTarget,$Li.BlendOverlayTarget,$Li.BlendLightTarget,$Li.BlendMask,$Li.BlendDestinationOut]},$Li.BlendNormal=function($Lr){$Lr.blendFunc(1,771)},$Li.BlendAdd=function($Lr){$Lr.blendFunc(1,772)},$Li.BlendMultiply=function($Lr){$Lr.blendFunc(774,771)},$Li.BlendScreen=function($Lr){$Lr.blendFunc(1,1)},$Li.BlendOverlay=function($Lr){$Lr.blendFunc(1,769)},$Li.BlendLight=function($Lr){$Lr.blendFunc(1,1)},$Li.BlendNormalTarget=function($Lr){$Lr.blendFunc(1,771)},$Li.BlendAddTarget=function($Lr){$Lr.blendFunc(1,772)},$Li.BlendMultiplyTarget=function($Lr){$Lr.blendFunc(774,771)},$Li.BlendScreenTarget=function($Lr){$Lr.blendFunc(1,1)},$Li.BlendOverlayTarget=function($Lr){$Lr.blendFunc(1,769)},$Li.BlendLightTarget=function($Lr){$Lr.blendFunc(1,1)},$Li.BlendMask=function($Lr){$Lr.blendFunc(0,770)},$Li.BlendDestinationOut=function($Lr){$Lr.blendFunc(0,0)},$Li.activeBlendFunction=null,$Li.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],$Li.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},$Li.NORMAL="normal",$Li.ADD="add",$Li.MULTIPLY="multiply",$Li.SCREEN="screen",$Li.LIGHT="light",$Li.OVERLAY="overlay",$Li.DESTINATIONOUT="destination-out",$Li.fns=[],$Li.targetFns=[],$Li}(),$Lo=function(){function $Lt($Lr){this._color=$LO.create("black"),this.setValue($Lr)}$LX($Lt,"laya.webgl.canvas.DrawStyle");var $Lr=$Lt.prototype;return $Lr.setValue=function($Lr){if($Lr){if("string"==typeof $Lr)return void(this._color=$LO.create($Lr));if($Lr instanceof laya.utils.Color)return void(this._color=$Lr)}},$Lr.reset=function(){this._color=$LO.create("black")},$Lr.equal=function($Lr){return"string"==typeof $Lr?this._color.strColor===$Lr:$Lr instanceof laya.utils.Color&&this._color.numColor===$Lr.numColor},$Lr.toColorStr=function(){return this._color.strColor},$Lt.create=function($Lr){var $Li;if($Lr&&("string"==typeof $Lr?$Li=$LO.create($Lr):$Lr instanceof laya.utils.Color&&($Li=$Lr),$Li))return $Li._drawStyle||($Li._drawStyle=new $Lt($Lr));return laya.webgl.canvas.DrawStyle.DEFAULT},$LE($Lt,["DEFAULT",function(){return this.DEFAULT=new $Lt("#000000")}]),$Lt}(),$LI=function(){function $Lr(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];$Lar.mainContext;this.ib=$LYr.create(35048),this.vb=$Ljr.create(5)}$LX($Lr,"laya.webgl.canvas.Path");var $Li=$Lr.prototype;return $Li.addPoint=function($Lr,$Li){this.tempArray.push($Lr,$Li)},$Li.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},$Li.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},$Li.polygon=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE;return this.geomatrys.push(this._curGeomatry=$LE=new $LLr($Lr,$Li,$Lt,$L_,$LA,$Lf)),$L_||($LE.fill=!1),null==$Lf&&($LE.borderWidth=0),$LE},$Li.setGeomtry=function($Lr){this.geomatrys.push(this._curGeomatry=$Lr)},$Li.drawLine=function($Lr,$Li,$Lt,$L_,$LA){var $Lf;return this.closePath?this.geomatrys.push(this._curGeomatry=$Lf=new $Ler($Lr,$Li,$Lt,$L_,$LA)):this.geomatrys.push(this._curGeomatry=$Lf=new $Lkr($Lr,$Li,$Lt,$L_,$LA)),$Lf.fill=!1,$Lf},$Li.update=function(){var $Lr=this.ib._byteLength,$Li=this.geomatrys.length;this.offset=$Lr;for(var $Lt=this.geoStart;$Lt<$Li;$Lt++)this.geomatrys[$Lt].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=$Li,this.count=(this.ib._byteLength-$Lr)/$Lcr.BYTES_PIDX},$Li.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},$Li.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},$Lr}(),$Lz=function(){function $LG(){}$LX($LG,"laya.webgl.canvas.save.SaveBase");var $Lr=$LG.prototype;return $Lu.imps($Lr,{"laya.webgl.canvas.save.ISaveData":!0}),$Lr.isSaveMark=function(){return!1},$Lr.restore=function($Lr){this._dataObj[this._valueName]=this._value,($LG._cache[$LG._cache._length++]=this)._newSubmit&&($Lr._curSubmit=$Lfr.RENDERBASE,$Lr._renderKey=0)},$LG._createArray=function(){var $Lr=[];return $Lr._length=0,$Lr},$LG._init=function(){var $Lr=$LG._namemap={};return $Lr[1]="ALPHA",$Lr[2]="fillStyle",$Lr[8]="font",$Lr[256]="lineWidth",$Lr[512]="strokeStyle",$Lr[8192]="_mergeID",$Lr[1024]=$Lr[2048]=$Lr[4096]=[],$Lr[16384]="textBaseline",$Lr[32768]="textAlign",$Lr[65536]="_nBlendType",$Lr[1048576]="shader",$Lr[2097152]="filters",$Lr},$LG.save=function($Lr,$Li,$Lt,$L_){if(($Lr._saveMark._saveuse&$Li)!==$Li){$Lr._saveMark._saveuse|=$Li;var $LA=$LG._cache,$Lf=0<$LA._length?$LA[--$LA._length]:new $LG;$Lf._value=$Lt[$Lf._valueName=$LG._namemap[$Li]],$Lf._dataObj=$Lt,$Lf._newSubmit=$L_;var $LE=$Lr._save;$LE[$LE._length++]=$Lf}},$LG._cache=laya.webgl.canvas.save.SaveBase._createArray(),$LG._namemap=$LG._init(),$LG}(),$LJ=function(){function $Lf(){this._clipRect=new $Ll}$LX($Lf,"laya.webgl.canvas.save.SaveClipRect");var $Lr=$Lf.prototype;return $Lu.imps($Lr,{"laya.webgl.canvas.save.ISaveData":!0}),$Lr.isSaveMark=function(){return!1},$Lr.restore=function($Lr){$Lr._clipRect=this._clipSaveRect,($Lf._cache[$Lf._cache._length++]=this)._submitScissor.submitLength=$Lr._submits._length-this._submitScissor.submitIndex,$Lr._curSubmit=$Lfr.RENDERBASE,$Lr._renderKey=0},$Lf.save=function($Lr,$Li){if(131072!=(131072&$Lr._saveMark._saveuse)){$Lr._saveMark._saveuse|=131072;var $Lt=$Lf._cache,$L_=0<$Lt._length?$Lt[--$Lt._length]:new $Lf;$L_._clipSaveRect=$Lr._clipRect,$Lr._clipRect=$L_._clipRect.copyFrom($Lr._clipRect),$L_._submitScissor=$Li;var $LA=$Lr._save;$LA[$LA._length++]=$L_}},$LE($Lf,["_cache",function(){return this._cache=$Lz._createArray()}]),$Lf}(),$LZ=function(){function $Lv(){this._contextX=0,this._contextY=0,this._clipRect=new $Ll,this._rect=new $Ll,this._matrix=new $Ls}$LX($Lv,"laya.webgl.canvas.save.SaveClipRectStencil");var $Lr=$Lv.prototype;return $Lu.imps($Lr,{"laya.webgl.canvas.save.ISaveData":!0}),$Lr.isSaveMark=function(){return!1},$Lr.restore=function($Lr){$Lgr.restore($Lr,this._rect,this._saveMatrix,this._contextX,this._contextY),$Lr._clipRect=this._clipSaveRect,$Lr._curMat=this._saveMatrix,$Lr._x=this._contextX,$Lr._y=this._contextY,$Lv._cache[$Lv._cache._length++]=this,$Lr._curSubmit=$Lfr.RENDERBASE},$Lv.save=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){if(262144!=(262144&$Lr._saveMark._saveuse)){$Lr._saveMark._saveuse|=262144;var $Lg=$Lv._cache,$LR=0<$Lg._length?$Lg[--$Lg._length]:new $Lv;$LR._clipSaveRect=$Lr._clipRect,$LR._clipRect.setTo($LE,$LG,$LN,$Lp),$Lr._clipRect=$LR._clipRect,$LR._rect.x=$Lt,$LR._rect.y=$L_,$LR._rect.width=$LA,$LR._rect.height=$Lf,$LR._contextX=$Lr._x,$LR._contextY=$Lr._y,$LR._saveMatrix=$Lr._curMat,$Lr._curMat.copyTo($LR._matrix),$Lr._curMat=$LR._matrix,$LR._submitStencil=$Li;var $LX=$Lr._save;$LX[$LX._length++]=$LR}},$LE($Lv,["_cache",function(){return this._cache=$Lz._createArray()}]),$Lv}(),$LW=function(){function $L_(){this._saveuse=0}$LX($L_,"laya.webgl.canvas.save.SaveMark");var $Lr=$L_.prototype;return $Lu.imps($Lr,{"laya.webgl.canvas.save.ISaveData":!0}),$Lr.isSaveMark=function(){return!0},$Lr.restore=function($Lr){$Lr._saveMark=this._preSaveMark,$L_._no[$L_._no._length++]=this},$L_.Create=function($Lr){var $Li=$L_._no,$Lt=0<$Li._length?$Li[--$Li._length]:new $L_;return $Lt._saveuse=0,$Lt._preSaveMark=$Lr._saveMark,$Lr._saveMark=$Lt},$LE($L_,["_no",function(){return this._no=$Lz._createArray()}]),$L_}(),$LM=function(){function $Lf(){this._matrix=new $Ls}$LX($Lf,"laya.webgl.canvas.save.SaveTransform");var $Lr=$Lf.prototype;return $Lu.imps($Lr,{"laya.webgl.canvas.save.ISaveData":!0}),$Lr.isSaveMark=function(){return!1},$Lr.restore=function($Lr){$Lr._curMat=this._savematrix,$Lf._no[$Lf._no._length++]=this},$Lf.save=function($Lr){var $Li=$Lr._saveMark;if(2048!=(2048&$Li._saveuse)){$Li._saveuse|=2048;var $Lt=$Lf._no,$L_=0<$Lt._length?$Lt[--$Lt._length]:new $Lf;$L_._savematrix=$Lr._curMat,$Lr._curMat=$Lr._curMat.copyTo($L_._matrix);var $LA=$Lr._save;$LA[$LA._length++]=$L_}},$LE($Lf,["_no",function(){return this._no=$Lz._createArray()}]),$Lf}(),$LK=function(){function $LA(){}$LX($LA,"laya.webgl.canvas.save.SaveTranslate");var $Lr=$LA.prototype;return $Lu.imps($Lr,{"laya.webgl.canvas.save.ISaveData":!0}),$Lr.isSaveMark=function(){return!1},$Lr.restore=function($Lr){$Lr._curMat;$Lr._x=this._x,$Lr._y=this._y,$LA._no[$LA._no._length++]=this},$LA.save=function($Lr){var $Li=$LA._no,$Lt=0<$Li._length?$Li[--$Li._length]:new $LA;$Lt._x=$Lr._x,$Lt._y=$Lr._y;var $L_=$Lr._save;$L_[$L_._length++]=$Lt},$LE($LA,["_no",function(){return this._no=$Lz._createArray()}]),$LA}(),$LS=function(){function $Lr(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new $Ll}$LX($Lr,"laya.webgl.resource.RenderTargetMAX");var $Li=$Lr.prototype;return $Li.setSP=function($Lr){this._sp=$Lr},$Li.size=function($Lr,$Li){var $Lt=this;this._width!==$Lr||this._height!==$Li?(this.repaint=!0,this._width=$Lr,this._height=$Li,this.target?this.target.size($Lr,$Li):this.target=$Lhr.create($Lr,$Li),this.target.hasListener("recovered")||this.target.on("recovered",this,function($Lr){$Lu.timer.callLater($Lt._sp,$Lt._sp.repaint)})):this.target.size($Lr,$Li)},$Li._flushToTarget=function($Lr,$Li){if(!$Li._destroy){var $Lt=$LCr.worldScissorTest,$L_=$LCr.worldClipRect;$LCr.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,$LCr.worldScissorTest=!1,$Lar.mainContext.disable(3089);var $LA=$LCr.worldAlpha,$Lf=$LCr.worldMatrix4,$LE=$LCr.worldMatrix,$LG=$LCr.worldFilters,$LN=$LCr.worldShaderDefines;if($LCr.worldMatrix=$Ls.EMPTY,$LCr.restoreTempArray(),$LCr.worldMatrix4=$LCr.TEMPMAT4_ARRAY,$LCr.worldAlpha=1,$LCr.worldFilters=null,$LCr.worldShaderDefines=null,$LVr.activeShader=null,$Li.start(),$Lw.showCanvasMark?$Li.clear(0,1,0,.3):$Li.clear(0,0,0,0),$Lr.flush(),$Li.end(),$LVr.activeShader=null,$LCr.worldAlpha=$LA,$LCr.worldMatrix4=$Lf,$LCr.worldMatrix=$LE,$LCr.worldFilters=$LG,$LCr.worldShaderDefines=$LN,$LCr.worldScissorTest=$Lt){var $Lp=$LCr.height-$L_.y-$L_.height;$Lar.mainContext.scissor($L_.x,$Lp,$L_.width,$L_.height),$Lar.mainContext.enable(3089)}$LCr.worldClipRect=$L_}},$Li.flush=function($Lr){this.repaint&&(this._flushToTarget($Lr,this.target),this.repaint=!1)},$Li.drawTo=function($Lr,$Li,$Lt,$L_,$LA){$Lr.drawTexture(this.target.getTexture(),$Li,$Lt,$L_,$LA,0,0)},$Li.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},$Lr}(),$LY=function(){function $Lr(){this.ALPHA=1,this.shaderType=0,this.defines=new $LUr}return $LX($Lr,"laya.webgl.shader.d2.Shader2D"),$Lr.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},$Lr.__init__=function(){var $Lr,$Li;$LWr.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),$LWr.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),$LWr.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),$LWr.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),$LWr.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),$LWr.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),$LWr.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),$LWr.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),$Lr="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$Li='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$LWr.preCompile2D(0,1,$Lr,$Li,null),$Lr="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",$Li='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',$LWr.preCompile2D(0,2,$Lr,$Li,null),$Lr="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",$Li="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",$LWr.preCompile2D(0,4,$Lr,$Li,null),$Lr="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$Li='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$LWr.preCompile2D(0,256,$Lr,$Li,null),$Lr="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",$Li="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",$LWr.preCompile2D(0,512,$Lr,$Li,null)},$Lr}(),$Lj=function(){function $Li($Lr,$Li,$Lt){this._value=0,this._name2int=$Lr,this._int2name=$Li,this._int2nameMap=$Lt}$LX($Li,"laya.webgl.shader.ShaderDefines");var $Lr=$Li.prototype;return $Lr.add=function($Lr){return"string"==typeof $Lr&&($Lr=this._name2int[$Lr]),this._value|=$Lr,this._value},$Lr.addInt=function($Lr){return this._value|=$Lr,this._value},$Lr.remove=function($Lr){return"string"==typeof $Lr&&($Lr=this._name2int[$Lr]),this._value&=~$Lr,this._value},$Lr.isDefine=function($Lr){return(this._value&$Lr)===$Lr},$Lr.getValue=function(){return this._value},$Lr.setValue=function($Lr){this._value=$Lr},$Lr.toNameDic=function(){var $Lr=this._int2nameMap[this._value];return $Lr||$Li._toText(this._value,this._int2name,this._int2nameMap)},$Li._reg=function($Lr,$Li,$Lt,$L_){$L_[$Lt[$Lr]=$Li]=$Lr},$Li._toText=function($Lr,$Li,$Lt){var $L_=$Lt[$Lr];if($L_)return $L_;for(var $LA={},$Lf=1,$LE=0;$LE<32&&!($Lr<($Lf=1<<$LE));$LE++)if($Lr&$Lf){var $LG=$Li[$Lf];$LG&&($LA[$LG]="")}return $Lt[$Lr]=$LA},$Li._toInt=function($Lr,$Li){for(var $Lt=$Lr.split("."),$L_=0,$LA=0,$Lf=$Lt.length;$LA<$Lf;$LA++){var $LE=$Li[$Lt[$LA]];if(!$LE)throw new Error("Defines to int err:"+$Lr+"/"+$Lt[$LA]);$L_|=$LE}return $L_},$Li}(),$Lrr=function(){function $LE(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new $Ls}$LX($LE,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var $Lr=$LE.prototype;return $Lr.init=function($Lr,$Li,$Lt){if($Li)this._vs=$Li;else{this._vs=[];var $L_=$Lr.width,$LA=$Lr.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push($L_,0,1,0,1,1,1,1),this._vs.push($L_,$LA,1,1,1,1,1,1),this._vs.push(0,$LA,0,1,1,1,1,1)}$Lt?this._ps=$Lt:($LE._defaultPS||($LE._defaultPS=[]).push(0,1,3,3,1,2),this._ps=$LE._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=$Lr},$Lr.init2=function($Lr,$Li,$Lt,$L_,$LA){this.transform&&(this.transform=null),$Lt?this._ps=$Lt:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=$L_,this._uvs=$LA,this.mEleNum=this._ps.length,this.mTexture=$Lr,($Ly.isConchNode||$Ly.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},$Lr._initMyData=function(){var $Lr=0,$Li=0,$Lt=4*this._verticles.length;this._vs=$LE._tempVS;var $L_=!1;if($Ly.isConchNode||$Ly.isConchApp?(this._vs.length=$Lt,$L_=!0):this._vs.length<$Lt&&(this._vs.length=$Lt,$L_=!0),$LE._tVSLen=$Lt,$L_)for(;$Lr<$Lt;)this._vs[$Lr]=this._verticles[$Li],this._vs[$Lr+1]=this._verticles[$Li+1],this._vs[$Lr+2]=this._uvs[$Li],this._vs[$Lr+3]=this._uvs[$Li+1],this._vs[$Lr+4]=1,this._vs[$Lr+5]=1,this._vs[$Lr+6]=1,this._vs[$Lr+7]=1,$Lr+=8,$Li+=2;else for(;$Lr<$Lt;)this._vs[$Lr]=this._verticles[$Li],this._vs[$Lr+1]=this._verticles[$Li+1],this._vs[$Lr+2]=this._uvs[$Li],this._vs[$Lr+3]=this._uvs[$Li+1],$Lr+=8,$Li+=2},$Lr.getData2=function($Lr,$Li,$Lt){var $L_;this.mVBBuffer=$Lr,this.mIBBuffer=$Li,this._initMyData(),$Lr.appendEx2(this._vs,Float32Array,$LE._tVSLen,4),this._indexStart=$Li._byteLength,($L_=$LE._tempIB).length<this._ps.length&&($L_.length=this._ps.length);for(var $LA=0,$Lf=this._ps.length;$LA<$Lf;$LA++)$L_[$LA]=this._ps[$LA]+$Lt;$Li.appendEx2($L_,Uint16Array,this._ps.length,2)},$Lr.getData=function($Lr,$Li,$Lt){if(this.mVBBuffer=$Lr,this.mIBBuffer=$Li,$Lr.append(this.mVBData),this._indexStart=$Li._byteLength,this.mIBData.start!=$Lt){for(var $L_=0,$LA=this._ps.length;$L_<$LA;$L_++)this.mIBData[$L_]=this._ps[$L_]+$Lt;this.mIBData.start=$Lt}$Li.append(this.mIBData)},$Lr.render=function($Lr,$Li,$Lt){if($Ly.isWebGL&&this.mTexture){$Lr._renderKey=0,$Lr._shader2D.glTexture=null,$Lir.getInstance().addSkinMesh(this);var $L_=$Lfr.createShape($Lr,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,$LHr.create(512,0));this.transform||(this.transform=$Ls.EMPTY),this.transform.translate($Li,$Lt),$Ls.mul(this.transform,$Lr._curMat,this._tempMatrix),this.transform.translate(-$Li,-$Lt);var $LA=$L_.shaderValue,$Lf=$LA.u_mmat2||$LCr.getMatrArray();$LCr.mat2MatArray(this._tempMatrix,$Lf),$LA.textureHost=this.mTexture,$LA.offsetX=0,$LA.offsetY=0,$LA.u_mmat2=$Lf,$LA.ALPHA=$Lr._shader2D.ALPHA,$Lr._submits[$Lr._submits._length++]=$L_}else $Ly.isConchApp&&this.mTexture&&(this.transform||(this.transform=$Ls.EMPTY),$Lr.setSkinMesh&&$Lr.setSkinMesh($Li,$Lt,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},$LE._tempVS=[],$LE._tempIB=[],$LE._defaultPS=null,$LE._tVSLen=0,$LE}(),$Lir=function(){function $Lr(){this.ib=null,this.vb=null;$Lar.mainContext;this.ib=$LYr.create(35048),this.vb=$Ljr.create(8)}$LX($Lr,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var $Li=$Lr.prototype;return $Li.addSkinMesh=function($Lr){$Lr.getData2(this.vb,this.ib,this.vb._byteLength/32)},$Li.reset=function(){this.vb.clear(),this.ib.clear()},$Lr.getInstance=function(){return $Lr.instance=$Lr.instance||new $Lr},$Lr.instance=null,$Lr}(),$Ltr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===$LN&&($LN=0),this.x=$Lr,this.y=$Li,this.width=$Lt,this.height=$L_,this.edges=$LA,this.color=$Lf,this.borderWidth=$LE,this.borderColor=$LG}$LX($Lr,"laya.webgl.shapes.BasePoly");var $Li=$Lr.prototype;return $Lu.imps($Li,{"laya.webgl.shapes.IShape":!0}),$Li.getData=function($Lr,$Li,$Lt){},$Li.rebuild=function($Lr){},$Li.setMatrix=function($Lr){},$Li.needUpdate=function($Lr){return!0},$Li.sector=function($Lr,$Li,$Lt){var $L_=this.x,$LA=this.y,$Lf=this.edges,$LE=(this.r1-this.r0)/$Lf,$LG=this.width,$LN=this.height,$Lp=this.color,$Lg=($Lp>>16&255)/255,$LR=($Lp>>8&255)/255,$LX=(255&$Lp)/255;$Lr.push($L_,$LA,$Lg,$LR,$LX);for(var $Lv=0;$Lv<$Lf+1;$Lv++)$Lr.push($L_+Math.sin($LE*$Lv+this.r0)*$LG,$LA+Math.cos($LE*$Lv+this.r0)*$LN),$Lr.push($Lg,$LR,$LX);for($Lv=0;$Lv<$Lf;$Lv++)$Li.push($Lt,$Lt+$Lv+1,$Lt+$Lv+2)},$Li.createLine2=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE,$LG,$LN,$Lp,$Lg,$LR,$LX,$Lv,$LO,$Lc,$LB,$Ly,$LC,$Ln,$La,$LD,$Lu,$Lw,$LH,$Ls,$Ld=$Lr.concat(),$Ll=$LA,$LU=this.borderColor,$Lk=($LU>>16&255)/255,$Le=($LU>>8&255)/255,$LL=(255&$LU)/255,$LQ=$Ld.length/2,$LF=$L_,$Lb=$Lt/2;$LN=$Ld[0],$Lp=$Ld[1],$Lc=$LN-($Lg=$Ld[2]),$LO=($LO=-($Lp-($LR=$Ld[3])))/($Ls=Math.sqrt($LO*$LO+$Lc*$Lc))*$Lb,$Lc=$Lc/$Ls*$Lb,$Ll.push($LN-$LO+this.x,$Lp-$Lc+this.y,$Lk,$Le,$LL,$LN+$LO+this.x,$Lp+$Lc+this.y,$Lk,$Le,$LL);for(var $LV=1;$LV<$LQ-1;$LV++)$LN=$Ld[2*($LV-1)],$Lp=$Ld[2*($LV-1)+1],$Lg=$Ld[2*$LV],$LR=$Ld[2*$LV+1],$LX=$Ld[2*($LV+1)],$Lv=$Ld[2*($LV+1)+1],$Lc=$LN-$Lg,$Ly=$Lg-$LX,$La=(-($LO=($LO=-($Lp-$LR))/($Ls=Math.sqrt($LO*$LO+$Lc*$Lc))*$Lb)+$LN)*(-($Lc=$Lc/$Ls*$Lb)+$LR)-(-$LO+$Lg)*(-$Lc+$Lp),$Lw=(-($LB=($LB=-($LR-$Lv))/($Ls=Math.sqrt($LB*$LB+$Ly*$Ly))*$Lb)+$LX)*(-($Ly=$Ly/$Ls*$Lb)+$LR)-(-$LB+$Lg)*(-$Ly+$Lv),$LH=($LC=-$Lc+$Lp-(-$Lc+$LR))*($Lu=-$LB+$Lg-(-$LB+$LX))-($LD=-$Ly+$Lv-(-$Ly+$LR))*($Ln=-$LO+$Lg-(-$LO+$LN)),Math.abs($LH)<.1?($LH+=10.1,$Ll.push($Lg-$LO+this.x,$LR-$Lc+this.y,$Lk,$Le,$LL,$Lg+$LO+this.x,$LR+$Lc+this.y,$Lk,$Le,$LL)):((($LE=($Ln*$Lw-$Lu*$La)/$LH)-$Lg)*($LE-$Lg)+(($LG=($LD*$La-$LC*$Lw)/$LH)-$LR)+($LG-$LR),$Ll.push($LE+this.x,$LG+this.y,$Lk,$Le,$LL,$Lg-($LE-$Lg)+this.x,$LR-($LG-$LR)+this.y,$Lk,$Le,$LL));$LN=$Ld[$Ld.length-4],$Lp=$Ld[$Ld.length-3],$Lc=$LN-($Lg=$Ld[$Ld.length-2]),$LO=($LO=-($Lp-($LR=$Ld[$Ld.length-1])))/($Ls=Math.sqrt($LO*$LO+$Lc*$Lc))*$Lb,$Lc=$Lc/$Ls*$Lb,$Ll.push($Lg-$LO+this.x,$LR-$Lc+this.y,$Lk,$Le,$LL,$Lg+$LO+this.x,$LR+$Lc+this.y,$Lk,$Le,$LL);var $Lh=$Lf;for($LV=1;$LV<$Lh;$LV++)$Li.push($LF+2*($LV-1),$LF+2*($LV-1)+1,$LF+2*$LV+1,$LF+2*$LV+1,$LF+2*$LV,$LF+2*($LV-1));return $Ll},$Li.createLine=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.concat(),$Lf=$Lr,$LE=this.borderColor,$LG=($LE>>16&255)/255,$LN=($LE>>8&255)/255,$Lp=(255&$LE)/255;$LA.splice(0,5);var $Lg,$LR,$LX,$Lv,$LO,$Lc,$LB,$Ly,$LC,$Ln,$La,$LD,$Lu,$Lw,$LH,$Ls,$Ld,$Ll,$LU,$Lk,$Le=$LA.length/5,$LL=$L_,$LQ=$Lt/2;$LX=$LA[0],$Lv=$LA[1],$Ln=$LX-($LO=$LA[5]),$LC=($LC=-($Lv-($Lc=$LA[6])))/($Lk=Math.sqrt($LC*$LC+$Ln*$Ln))*$LQ,$Ln=$Ln/$Lk*$LQ,$Lf.push($LX-$LC,$Lv-$Ln,$LG,$LN,$Lp,$LX+$LC,$Lv+$Ln,$LG,$LN,$Lp);for(var $LF=1;$LF<$Le-1;$LF++)$LX=$LA[5*($LF-1)],$Lv=$LA[5*($LF-1)+1],$LO=$LA[5*$LF],$Lc=$LA[5*$LF+1],$LB=$LA[5*($LF+1)],$Ly=$LA[5*($LF+1)+1],$Ln=$LX-$LO,$LD=$LO-$LB,$LH=(-($LC=($LC=-($Lv-$Lc))/($Lk=Math.sqrt($LC*$LC+$Ln*$Ln))*$LQ)+$LX)*(-($Ln=$Ln/$Lk*$LQ)+$Lc)-(-$LC+$LO)*(-$Ln+$Lv),$Ll=(-($La=($La=-($Lc-$Ly))/($Lk=Math.sqrt($La*$La+$LD*$LD))*$LQ)+$LB)*(-($LD=$LD/$Lk*$LQ)+$Lc)-(-$La+$LO)*(-$LD+$Ly),$LU=($Lu=-$Ln+$Lv-(-$Ln+$Lc))*($Ld=-$La+$LO-(-$La+$LB))-($Ls=-$LD+$Ly-(-$LD+$Lc))*($Lw=-$LC+$LO-(-$LC+$LX)),Math.abs($LU)<.1?($LU+=10.1,$Lf.push($LO-$LC,$Lc-$Ln,$LG,$LN,$Lp,$LO+$LC,$Lc+$Ln,$LG,$LN,$Lp)):((($Lg=($Lw*$Ll-$Ld*$LH)/$LU)-$LO)*($Lg-$LO)+(($LR=($Ls*$LH-$Lu*$Ll)/$LU)-$Lc)+($LR-$Lc),$Lf.push($Lg,$LR,$LG,$LN,$Lp,$LO-($Lg-$LO),$Lc-($LR-$Lc),$LG,$LN,$Lp));$LX=$LA[$LA.length-10],$Lv=$LA[$LA.length-9],$Ln=$LX-($LO=$LA[$LA.length-5]),$LC=($LC=-($Lv-($Lc=$LA[$LA.length-4])))/($Lk=Math.sqrt($LC*$LC+$Ln*$Ln))*$LQ,$Ln=$Ln/$Lk*$LQ,$Lf.push($LO-$LC,$Lc-$Ln,$LG,$LN,$Lp,$LO+$LC,$Lc+$Ln,$LG,$LN,$Lp);var $Lb=this.edges+1;for($LF=1;$LF<$Lb;$LF++)$Li.push($LL+2*($LF-1),$LL+2*($LF-1)+1,$LL+2*$LF+1,$LL+2*$LF+1,$LL+2*$LF,$LL+2*($LF-1));return $Lf},$Li.createLoopLine=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=$Lr.concat(),$LG=$LA||$Lr,$LN=this.borderColor,$Lp=($LN>>16&255)/255,$Lg=($LN>>8&255)/255,$LR=(255&$LN)/255;$LE.splice(0,5);var $LX=[$LE[0],$LE[1]],$Lv=[$LE[$LE.length-5],$LE[$LE.length-4]],$LO=$Lv[0]+.5*($LX[0]-$Lv[0]),$Lc=$Lv[1]+.5*($LX[1]-$Lv[1]);$LE.unshift($LO,$Lc,0,0,0),$LE.push($LO,$Lc,0,0,0);var $LB,$Ly,$LC,$Ln,$La,$LD,$Lu,$Lw,$LH,$Ls,$Ld,$Ll,$LU,$Lk,$Le,$LL,$LQ,$LF,$Lb,$LV,$Lh=$LE.length/5,$LP=$L_,$Lq=$Lt/2;$LC=$LE[0],$Ln=$LE[1],$Ls=$LC-($La=$LE[5]),$LH=($LH=-($Ln-($LD=$LE[6])))/($LV=Math.sqrt($LH*$LH+$Ls*$Ls))*$Lq,$Ls=$Ls/$LV*$Lq,$LG.push($LC-$LH,$Ln-$Ls,$Lp,$Lg,$LR,$LC+$LH,$Ln+$Ls,$Lp,$Lg,$LR);for(var $Lm=1;$Lm<$Lh-1;$Lm++)$LC=$LE[5*($Lm-1)],$Ln=$LE[5*($Lm-1)+1],$La=$LE[5*$Lm],$LD=$LE[5*$Lm+1],$Lu=$LE[5*($Lm+1)],$Lw=$LE[5*($Lm+1)+1],$Ls=$LC-$La,$Ll=$La-$Lu,$Le=(-($LH=($LH=-($Ln-$LD))/($LV=Math.sqrt($LH*$LH+$Ls*$Ls))*$Lq)+$LC)*(-($Ls=$Ls/$LV*$Lq)+$LD)-(-$LH+$La)*(-$Ls+$Ln),$LF=(-($Ld=($Ld=-($LD-$Lw))/($LV=Math.sqrt($Ld*$Ld+$Ll*$Ll))*$Lq)+$Lu)*(-($Ll=$Ll/$LV*$Lq)+$LD)-(-$Ld+$La)*(-$Ll+$Lw),$Lb=($LU=-$Ls+$Ln-(-$Ls+$LD))*($LQ=-$Ld+$La-(-$Ld+$Lu))-($LL=-$Ll+$Lw-(-$Ll+$LD))*($Lk=-$LH+$La-(-$LH+$LC)),Math.abs($Lb)<.1?($Lb+=10.1,$LG.push($La-$LH,$LD-$Ls,$Lp,$Lg,$LR,$La+$LH,$LD+$Ls,$Lp,$Lg,$LR)):((($LB=($Lk*$LF-$LQ*$Le)/$Lb)-$La)*($LB-$La)+(($Ly=($LL*$Le-$LU*$LF)/$Lb)-$LD)+($Ly-$LD),$LG.push($LB,$Ly,$Lp,$Lg,$LR,$La-($LB-$La),$LD-($Ly-$LD),$Lp,$Lg,$LR));$Lf&&($Li=$Lf);var $LT=this.edges+1;for($Lm=1;$Lm<$LT;$Lm++)$Li.push($LP+2*($Lm-1),$LP+2*($Lm-1)+1,$LP+2*$Lm+1,$LP+2*$Lm+1,$LP+2*$Lm,$LP+2*($Lm-1));return $Li.push($LP+2*($Lm-1),$LP+2*($Lm-1)+1,$LP+1,$LP+1,$LP,$LP+2*($Lm-1)),$LG},$Lr}(),$L_r=function(){function $Lc(){}return $LX($Lc,"laya.webgl.shapes.Earcut"),$Lc.earcut=function($Lr,$Li,$Lt){$Lt=$Lt||2;var $L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg=$Li&&$Li.length,$LR=$Lg?$Li[0]*$Lt:$Lr.length,$LX=$Lc.linkedList($Lr,0,$LR,$Lt,!0),$Lv=[];if(!$LX)return $Lv;if($Lg&&($LX=$Lc.eliminateHoles($Lr,$Li,$LX,$Lt)),$Lr.length>80*$Lt){$L_=$Lf=$Lr[0],$LA=$LE=$Lr[1];for(var $LO=$Lt;$LO<$LR;$LO+=$Lt)($LG=$Lr[$LO])<$L_&&($L_=$LG),($LN=$Lr[$LO+1])<$LA&&($LA=$LN),$Lf<$LG&&($Lf=$LG),$LE<$LN&&($LE=$LN);$Lp=0!==($Lp=Math.max($Lf-$L_,$LE-$LA))?1/$Lp:0}return $Lc.earcutLinked($LX,$Lv,$Lt,$L_,$LA,$Lp),$Lv},$Lc.linkedList=function($Lr,$Li,$Lt,$L_,$LA){var $Lf,$LE;if($LA===0<$Lc.signedArea($Lr,$Li,$Lt,$L_))for($Lf=$Li;$Lf<$Lt;$Lf+=$L_)$LE=$Lc.insertNode($Lf,$Lr[$Lf],$Lr[$Lf+1],$LE);else for($Lf=$Lt-$L_;$Li<=$Lf;$Lf-=$L_)$LE=$Lc.insertNode($Lf,$Lr[$Lf],$Lr[$Lf+1],$LE);return $LE&&$Lc.equals($LE,$LE.next)&&($Lc.removeNode($LE),$LE=$LE.next),$LE},$Lc.filterPoints=function($Lr,$Li){if(!$Lr)return $Lr;$Li||($Li=$Lr);var $Lt,$L_=$Lr;do{if($Lt=!1,$L_.steiner||!$Lc.equals($L_,$L_.next)&&0!==$Lc.area($L_.prev,$L_,$L_.next))$L_=$L_.next;else{if($Lc.removeNode($L_),($L_=$Li=$L_.prev)===$L_.next)break;$Lt=!0}}while($Lt||$L_!==$Li);return $Li},$Lc.earcutLinked=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){if($Lr){!$LE&&$Lf&&$Lc.indexCurve($Lr,$L_,$LA,$Lf);for(var $LG,$LN,$Lp=$Lr;$Lr.prev!==$Lr.next;)if($LG=$Lr.prev,$LN=$Lr.next,$Lf?$Lc.isEarHashed($Lr,$L_,$LA,$Lf):$Lc.isEar($Lr))$Li.push($LG.i/$Lt),$Li.push($Lr.i/$Lt),$Li.push($LN.i/$Lt),$Lc.removeNode($Lr),$Lr=$LN.next,$Lp=$LN.next;else if(($Lr=$LN)===$Lp){$LE?1===$LE?($Lr=$Lc.cureLocalIntersections($Lr,$Li,$Lt),$Lc.earcutLinked($Lr,$Li,$Lt,$L_,$LA,$Lf,2)):2===$LE&&$Lc.splitEarcut($Lr,$Li,$Lt,$L_,$LA,$Lf):$Lc.earcutLinked($Lc.filterPoints($Lr,null),$Li,$Lt,$L_,$LA,$Lf,1);break}}},$Lc.isEar=function($Lr){var $Li=$Lr.prev,$Lt=$Lr,$L_=$Lr.next;if(0<=$Lc.area($Li,$Lt,$L_))return!1;for(var $LA=$Lr.next.next;$LA!==$Lr.prev;){if($Lc.pointInTriangle($Li.x,$Li.y,$Lt.x,$Lt.y,$L_.x,$L_.y,$LA.x,$LA.y)&&0<=$Lc.area($LA.prev,$LA,$LA.next))return!1;$LA=$LA.next}return!0},$Lc.isEarHashed=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.prev,$Lf=$Lr,$LE=$Lr.next;if(0<=$Lc.area($LA,$Lf,$LE))return!1;for(var $LG=$LA.x<$Lf.x?$LA.x<$LE.x?$LA.x:$LE.x:$Lf.x<$LE.x?$Lf.x:$LE.x,$LN=$LA.y<$Lf.y?$LA.y<$LE.y?$LA.y:$LE.y:$Lf.y<$LE.y?$Lf.y:$LE.y,$Lp=$LA.x>$Lf.x?$LA.x>$LE.x?$LA.x:$LE.x:$Lf.x>$LE.x?$Lf.x:$LE.x,$Lg=$LA.y>$Lf.y?$LA.y>$LE.y?$LA.y:$LE.y:$Lf.y>$LE.y?$Lf.y:$LE.y,$LR=$Lc.zOrder($LG,$LN,$Li,$Lt,$L_),$LX=$Lc.zOrder($Lp,$Lg,$Li,$Lt,$L_),$Lv=$Lr.nextZ;$Lv&&$Lv.z<=$LX;){if($Lv!==$Lr.prev&&$Lv!==$Lr.next&&$Lc.pointInTriangle($LA.x,$LA.y,$Lf.x,$Lf.y,$LE.x,$LE.y,$Lv.x,$Lv.y)&&0<=$Lc.area($Lv.prev,$Lv,$Lv.next))return!1;$Lv=$Lv.nextZ}for($Lv=$Lr.prevZ;$Lv&&$Lv.z>=$LR;){if($Lv!==$Lr.prev&&$Lv!==$Lr.next&&$Lc.pointInTriangle($LA.x,$LA.y,$Lf.x,$Lf.y,$LE.x,$LE.y,$Lv.x,$Lv.y)&&0<=$Lc.area($Lv.prev,$Lv,$Lv.next))return!1;$Lv=$Lv.prevZ}return!0},$Lc.cureLocalIntersections=function($Lr,$Li,$Lt){var $L_=$Lr;do{var $LA=$L_.prev,$Lf=$L_.next.next;!$Lc.equals($LA,$Lf)&&$Lc.intersects($LA,$L_,$L_.next,$Lf)&&$Lc.locallyInside($LA,$Lf)&&$Lc.locallyInside($Lf,$LA)&&($Li.push($LA.i/$Lt),$Li.push($L_.i/$Lt),$Li.push($Lf.i/$Lt),$Lc.removeNode($L_),$Lc.removeNode($L_.next),$L_=$Lr=$Lf),$L_=$L_.next}while($L_!==$Lr);return $L_},$Lc.splitEarcut=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=$Lr;do{for(var $LG=$LE.next.next;$LG!==$LE.prev;){if($LE.i!==$LG.i&&$Lc.isValidDiagonal($LE,$LG)){var $LN=$Lc.splitPolygon($LE,$LG);return $LE=$Lc.filterPoints($LE,$LE.next),$LN=$Lc.filterPoints($LN,$LN.next),$Lc.earcutLinked($LE,$Li,$Lt,$L_,$LA,$Lf),void $Lc.earcutLinked($LN,$Li,$Lt,$L_,$LA,$Lf)}$LG=$LG.next}$LE=$LE.next}while($LE!==$Lr)},$Lc.eliminateHoles=function($Lr,$Li,$Lt,$L_){var $LA,$Lf,$LE,$LG,$LN,$Lp=[];for($LA=0,$Lf=$Li.length;$LA<$Lf;$LA++)$LE=$Li[$LA]*$L_,$LG=$LA<$Lf-1?$Li[$LA+1]*$L_:$Lr.length,($LN=$Lc.linkedList($Lr,$LE,$LG,$L_,!1))===$LN.next&&($LN.steiner=!0),$Lp.push($Lc.getLeftmost($LN));for($Lp.sort($Lc.compareX),$LA=0;$LA<$Lp.length;$LA++)$Lc.eliminateHole($Lp[$LA],$Lt),$Lt=$Lc.filterPoints($Lt,$Lt.next);return $Lt},$Lc.compareX=function($Lr,$Li){return $Lr.x-$Li.x},$Lc.eliminateHole=function($Lr,$Li){if($Li=$Lc.findHoleBridge($Lr,$Li)){var $Lt=$Lc.splitPolygon($Li,$Lr);$Lc.filterPoints($Lt,$Lt.next)}},$Lc.findHoleBridge=function($Lr,$Li){var $Lt,$L_=$Li,$LA=$Lr.x,$Lf=$Lr.y,$LE=-1/0;do{if($Lf<=$L_.y&&$Lf>=$L_.next.y&&$L_.next.y!==$L_.y){var $LG=$L_.x+($Lf-$L_.y)*($L_.next.x-$L_.x)/($L_.next.y-$L_.y);if($LG<=$LA&&$LE<$LG){if(($LE=$LG)===$LA){if($Lf===$L_.y)return $L_;if($Lf===$L_.next.y)return $L_.next}$Lt=$L_.x<$L_.next.x?$L_:$L_.next}}$L_=$L_.next}while($L_!==$Li);if(!$Lt)return null;if($LA===$LE)return $Lt.prev;var $LN,$Lp=$Lt,$Lg=$Lt.x,$LR=$Lt.y,$LX=1/0;for($L_=$Lt.next;$L_!==$Lp;)$LA>=$L_.x&&$L_.x>=$Lg&&$LA!==$L_.x&&$Lc.pointInTriangle($Lf<$LR?$LA:$LE,$Lf,$Lg,$LR,$Lf<$LR?$LE:$LA,$Lf,$L_.x,$L_.y)&&(($LN=Math.abs($Lf-$L_.y)/($LA-$L_.x))<$LX||$LN===$LX&&$L_.x>$Lt.x)&&$Lc.locallyInside($L_,$Lr)&&($Lt=$L_,$LX=$LN),$L_=$L_.next;return $Lt},$Lc.indexCurve=function($Lr,$Li,$Lt,$L_){for(var $LA=$Lr;null===$LA.z&&($LA.z=$Lc.zOrder($LA.x,$LA.y,$Li,$Lt,$L_)),$LA.prevZ=$LA.prev,$LA.nextZ=$LA.next,($LA=$LA.next)!==$Lr;);$LA.prevZ.nextZ=null,$LA.prevZ=null,$Lc.sortLinked($LA)},$Lc.sortLinked=function($Lr){var $Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp=1;do{for($Lt=$Lr,$Lf=$Lr=null,$LE=0;$Lt;){for($LE++,$L_=$Lt,$Li=$LG=0;$Li<$Lp&&($LG++,$L_=$L_.nextZ);$Li++);for($LN=$Lp;0<$LG||0<$LN&&$L_;)0!==$LG&&(0===$LN||!$L_||$Lt.z<=$L_.z)?($Lt=($LA=$Lt).nextZ,$LG--):($L_=($LA=$L_).nextZ,$LN--),$Lf?$Lf.nextZ=$LA:$Lr=$LA,$LA.prevZ=$Lf,$Lf=$LA;$Lt=$L_}$Lf.nextZ=null,$Lp*=2}while(1<$LE);return $Lr},$Lc.zOrder=function($Lr,$Li,$Lt,$L_,$LA){return($Lr=1431655765&(($Lr=858993459&(($Lr=252645135&(($Lr=16711935&(($Lr=32767*($Lr-$Lt)*$LA)|$Lr<<8))|$Lr<<4))|$Lr<<2))|$Lr<<1))|($Li=1431655765&(($Li=858993459&(($Li=252645135&(($Li=16711935&(($Li=32767*($Li-$L_)*$LA)|$Li<<8))|$Li<<4))|$Li<<2))|$Li<<1))<<1},$Lc.getLeftmost=function($Lr){for(var $Li=$Lr,$Lt=$Lr;$Li.x<$Lt.x&&($Lt=$Li),($Li=$Li.next)!==$Lr;);return $Lt},$Lc.pointInTriangle=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){return 0<=($LA-$LE)*($Li-$LG)-($Lr-$LE)*($Lf-$LG)&&0<=($Lr-$LE)*($L_-$LG)-($Lt-$LE)*($Li-$LG)&&0<=($Lt-$LE)*($Lf-$LG)-($LA-$LE)*($L_-$LG)},$Lc.isValidDiagonal=function($Lr,$Li){return $Lr.next.i!==$Li.i&&$Lr.prev.i!==$Li.i&&!$Lc.intersectsPolygon($Lr,$Li)&&$Lc.locallyInside($Lr,$Li)&&$Lc.locallyInside($Li,$Lr)&&$Lc.middleInside($Lr,$Li)},$Lc.area=function($Lr,$Li,$Lt){return($Li.y-$Lr.y)*($Lt.x-$Li.x)-($Li.x-$Lr.x)*($Lt.y-$Li.y)},$Lc.equals=function($Lr,$Li){return $Lr.x===$Li.x&&$Lr.y===$Li.y},$Lc.intersects=function($Lr,$Li,$Lt,$L_){return!!($Lc.equals($Lr,$Li)&&$Lc.equals($Lt,$L_)||$Lc.equals($Lr,$L_)&&$Lc.equals($Lt,$Li))||0<$Lc.area($Lr,$Li,$Lt)!=0<$Lc.area($Lr,$Li,$L_)&&0<$Lc.area($Lt,$L_,$Lr)!=0<$Lc.area($Lt,$L_,$Li)},$Lc.intersectsPolygon=function($Lr,$Li){var $Lt=$Lr;do{if($Lt.i!==$Lr.i&&$Lt.next.i!==$Lr.i&&$Lt.i!==$Li.i&&$Lt.next.i!==$Li.i&&$Lc.intersects($Lt,$Lt.next,$Lr,$Li))return!0;$Lt=$Lt.next}while($Lt!==$Lr);return!1},$Lc.locallyInside=function($Lr,$Li){return $Lc.area($Lr.prev,$Lr,$Lr.next)<0?0<=$Lc.area($Lr,$Li,$Lr.next)&&0<=$Lc.area($Lr,$Lr.prev,$Li):$Lc.area($Lr,$Li,$Lr.prev)<0||$Lc.area($Lr,$Lr.next,$Li)<0},$Lc.middleInside=function($Lr,$Li){for(var $Lt=$Lr,$L_=!1,$LA=($Lr.x+$Li.x)/2,$Lf=($Lr.y+$Li.y)/2;$Lt.y>$Lf!=$Lt.next.y>$Lf&&$Lt.next.y!==$Lt.y&&$LA<($Lt.next.x-$Lt.x)*($Lf-$Lt.y)/($Lt.next.y-$Lt.y)+$Lt.x&&($L_=!$L_),($Lt=$Lt.next)!==$Lr;);return $L_},$Lc.splitPolygon=function($Lr,$Li){var $Lt=new $LAr($Lr.i,$Lr.x,$Lr.y),$L_=new $LAr($Li.i,$Li.x,$Li.y),$LA=$Lr.next,$Lf=$Li.prev;return($Lr.next=$Li).prev=$Lr,($Lt.next=$LA).prev=$Lt,($L_.next=$Lt).prev=$L_,($Lf.next=$L_).prev=$Lf,$L_},$Lc.insertNode=function($Lr,$Li,$Lt,$L_){var $LA=new $LAr($Lr,$Li,$Lt);return $L_?($LA.next=$L_.next,($LA.prev=$L_).next.prev=$LA,$L_.next=$LA):($LA.prev=$LA).next=$LA,$LA},$Lc.removeNode=function($Lr){$Lr.next.prev=$Lr.prev,$Lr.prev.next=$Lr.next,$Lr.prevZ&&($Lr.prevZ.nextZ=$Lr.nextZ),$Lr.nextZ&&($Lr.nextZ.prevZ=$Lr.prevZ)},$Lc.signedArea=function($Lr,$Li,$Lt,$L_){for(var $LA=0,$Lf=$Li,$LE=$Lt-$L_;$Lf<$Lt;$Lf+=$L_)$LA+=($Lr[$LE]-$Lr[$Lf])*($Lr[$Lf+1]+$Lr[$LE+1]),$LE=$Lf;return $LA},$Lc}(),$LAr=function(){function $Lr($Lr,$Li,$Lt){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=$Lr,this.x=$Li,this.y=$Lt,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return $LX($Lr,"laya.webgl.shapes.EarcutNode"),$Lr}(),$Lfr=(function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this.lineWidth=$Lr,this.lineColor=$Li,this.lineAlpha=$Lt,this.fillColor=$L_,this.fillAlpha=$LA,this.shape=$LE,this.fill=$Lf}$LX($Lr,"laya.webgl.shapes.GeometryData");var $Li=$Lr.prototype;$Li.clone=function(){return new $Lr(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},$Li.getIndexData=function(){return null},$Li.getVertexData=function(){return null},$Li.destroy=function(){this.shape=null}}(),function(){function $Lr($Lr){if($Lr instanceof Float32Array)this.points=$Lr;else if($Lr instanceof Array){$Lr.length;this.points=new Float32Array($Lr)}}$LX($Lr,"laya.webgl.shapes.Vertex");var $Li=$Lr.prototype;$Lu.imps($Li,{"laya.webgl.shapes.IShape":!0}),$Li.getData=function($Lr,$Li,$Lt){},$Li.needUpdate=function($Lr){return!1},$Li.rebuild=function($Lr){},$Li.setMatrix=function($Lr){}}(),function(){function $LN($Lr){void 0===$Lr&&($Lr=1e4),this._renderType=$Lr}$LX($LN,"laya.webgl.submit.Submit");var $Lr=$LN.prototype;return $Lu.imps($Lr,{"laya.webgl.submit.ISubmit":!0}),$Lr.releaseRender=function(){var $Lr=$LN._cache;($Lr[$Lr._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$Lr.getRenderType=function(){return this._renderType},$Lr.renderSubmit=function(){if(0===this._numEle)return 1;var $Lr=this.shaderValue.textureHost;if($Lr){var $Li=$Lr.source;if(!$Lr.bitmap||!$Li)return 1;this.shaderValue.texture=$Li,$Lr.alphaTexture&&$Lr.alphaTexture.source&&(this.shaderValue.texture1=$Lr.alphaTexture.source)}this._vb.bind_upload(this._ib);var $Lt=$Lar.mainContext;return this.shaderValue.upload(),$L$.activeBlendFunction!==this._blendFn&&($Lt.enable(3042),this._blendFn($Lt),$L$.activeBlendFunction=this._blendFn),$Le.drawCall++,$Le.trianglesFaces+=this._numEle/3,$Lt.drawElements(4,this._numEle,5123,this._startIdx),1},$LN.__init__=function(){var $Lr=$LN.RENDERBASE=new $LN(-1);$Lr.shaderValue=new $LHr(0,0),$Lr.shaderValue.ALPHA=-1234},$LN.createSubmit=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$LN._cache._length?$LN._cache[--$LN._cache._length]:new $LN;null==$Lt&&(($Lt=$Lf._selfVb||($Lf._selfVb=$Ljr.create(-1))).clear(),$L_=0),$Lf._ib=$Li,$Lf._vb=$Lt,$Lf._startIdx=$L_*$Lcr.BYTES_PIDX,$Lf._numEle=0;var $LE=$Lr._nBlendType;$Lf._blendFn=$Lr._targets?$L$.targetFns[$LE]:$L$.fns[$LE],$Lf.shaderValue=$LA,$Lf.shaderValue.setValue($Lr._shader2D);var $LG=$Lr._shader2D.filters;return $LG&&$Lf.shaderValue.setFilters($LG),$Lf},$LN.createShape=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=$LN._cache._length?$LN._cache[--$LN._cache._length]:new $LN;$LE._ib=$Li,$LE._vb=$Lt,$LE._numEle=$L_,$LE._startIdx=$LA,$LE.shaderValue=$Lf,$LE.shaderValue.setValue($Lr._shader2D);var $LG=$Lr._nBlendType;return $LE._blendFn=$Lr._targets?$L$.targetFns[$LG]:$L$.fns[$LG],$LE},$LN.TYPE_2D=1e4,$LN.TYPE_CANVAS=10003,$LN.TYPE_CMDSETRT=10004,$LN.TYPE_CUSTOM=10005,$LN.TYPE_BLURRT=10006,$LN.TYPE_CMDDESTORYPRERT=10007,$LN.TYPE_DISABLESTENCIL=10008,$LN.TYPE_OTHERIBVB=10009,$LN.TYPE_PRIMITIVE=10010,$LN.TYPE_RT=10011,$LN.TYPE_BLUR_RT=10012,$LN.TYPE_TARGET=10013,$LN.TYPE_CHANGE_VALUE=10014,$LN.TYPE_SHAPE=10015,$LN.TYPE_TEXTURE=10016,$LN.TYPE_FILLTEXTURE=10017,$LN.RENDERBASE=null,$LN._cache=(($LN._cache=[])._length=0,$LN._cache),$LN}()),$LEr=function(){function $L_(){this.fun=null,this.args=null}$LX($L_,"laya.webgl.submit.SubmitCMD");var $Lr=$L_.prototype;return $Lu.imps($Lr,{"laya.webgl.submit.ISubmit":!0}),$Lr.renderSubmit=function(){return this.fun.apply(null,this.args),1},$Lr.getRenderType=function(){return 0},$Lr.releaseRender=function(){var $Lr=$L_._cache;$Lr[$Lr._length++]=this},$L_.create=function($Lr,$Li){var $Lt=$L_._cache._length?$L_._cache[--$L_._cache._length]:new $L_;return $Lt.fun=$Li,$Lt.args=$Lr,$Lt},$L_._cache=(($L_._cache=[])._length=0,$L_._cache),$L_}(),$LGr=function(){function $Li(){this.variables={}}$LX($Li,"laya.webgl.submit.SubmitCMDScope");var $Lr=$Li.prototype;return $Lr.getValue=function($Lr){return this.variables[$Lr]},$Lr.addValue=function($Lr,$Li){return this.variables[$Lr]=$Li},$Lr.setValue=function($Lr,$Li){return this.variables.hasOwnProperty($Lr)?this.variables[$Lr]=$Li:null},$Lr.clear=function(){for(var $Lr in this.variables)delete this.variables[$Lr]},$Lr.recycle=function(){this.clear(),$Li.POOL.push(this)},$Li.create=function(){var $Lr=$Li.POOL.pop();return $Lr||($Lr=new $Li),$Lr},$Li.POOL=[],$Li}(),$LNr=function(){function $LR(){this.offset=0,this.startIndex=0,this._mat=$Ls.create()}$LX($LR,"laya.webgl.submit.SubmitOtherIBVB");var $Lr=$LR.prototype;return $Lu.imps($Lr,{"laya.webgl.submit.ISubmit":!0}),$Lr.releaseRender=function(){var $Lr=$LR._cache;($Lr[$Lr._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$Lr.getRenderType=function(){return 10009},$Lr.renderSubmit=function(){var $Lr=this._shaderValue.textureHost;if($Lr){var $Li=$Lr.source;if(!$Lr.bitmap||!$Li)return 1;this._shaderValue.texture=$Li}this._vb.bind_upload(this._ib);var $Lt=$LCr.worldMatrix4,$L_=$Ls.TEMP;$Ls.mulPre(this._mat,$Lt[0],$Lt[1],$Lt[4],$Lt[5],$Lt[12],$Lt[13],$L_);var $LA=$LCr.worldMatrix4=$LR.tempMatrix4;$LA[0]=$L_.a,$LA[1]=$L_.b,$LA[4]=$L_.c,$LA[5]=$L_.d,$LA[12]=$L_.tx,$LA[13]=$L_.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var $Lf=$Lar.mainContext;return $L$.activeBlendFunction!==this._blendFn&&($Lf.enable(3042),this._blendFn($Lf),$L$.activeBlendFunction=this._blendFn),$Le.drawCall++,$Le.trianglesFaces+=this._numEle/3,$Lf.drawElements(4,this._numEle,5123,this.startIndex),$LCr.worldMatrix4=$Lt,$LVr.activeShader=null,1},$LR.create=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){void 0===$LN&&($LN=0);var $Lp=$LR._cache._length?$LR._cache[--$LR._cache._length]:new $LR;$Lp._ib=$Lt,$Lp._vb=$Li,$Lp._numEle=$L_,$Lp._shader=$LA,$Lp._shaderValue=$Lf;var $Lg=$Lr._nBlendType;switch($Lp._blendFn=$Lr._targets?$L$.targetFns[$Lg]:$L$.fns[$Lg],$LN){case 0:$Lp.offset=0,$Lp.startIndex=$LG/($Lcr.BYTES_PE*$Li.vertexStride)*1.5,$Lp.startIndex*=$Lcr.BYTES_PIDX;break;case 1:$Lp.startIndex=$LE,$Lp.offset=$LG}return $Lp},$LR._cache=(($LR._cache=[])._length=0,$LR._cache),$LR.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$LR}(),$Lpr=function(){function $Lt(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new $Ll,this.screenRect=new $Ll}$LX($Lt,"laya.webgl.submit.SubmitScissor");var $Lr=$Lt.prototype;return $Lu.imps($Lr,{"laya.webgl.submit.ISubmit":!0}),$Lr._scissor=function($Lr,$Li,$Lt,$L_){var $LA=$LCr.worldMatrix4,$Lf=$LA[0],$LE=$LA[5],$LG=$LA[12],$LN=$LA[13];if($L_*=$LE,($Lt*=$Lf)<1||$L_<1)return!1;var $Lp=($Lr=$Lr*$Lf+$LG)+$Lt,$Lg=($Li=$Li*$LE+$LN)+$L_;$Lr<0&&($Lt=$Lp-($Lr=0)),$Li<0&&($L_=$Lg-($Li=0));var $LR=$LCr.worldClipRect;if($Lr=Math.max($Lr,$LR.x),$Li=Math.max($Li,$LR.y),$Lt=Math.min($Lp,$LR.right)-$Lr,$L_=Math.min($Lg,$LR.bottom)-$Li,$Lt<1||$L_<1)return!1;var $LX=$LCr.worldScissorTest;return this.screenRect.copyFrom($LR),$LR.x=$Lr,$LR.y=$Li,$LR.width=$Lt,$LR.height=$L_,$LCr.worldScissorTest=!0,$Li=$LCr.height-$Li-$L_,$Lar.mainContext.scissor($Lr,$Li,$Lt,$L_),$Lar.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$LX?($Li=$LCr.height-this.screenRect.y-this.screenRect.height,$Lar.mainContext.scissor(this.screenRect.x,$Li,this.screenRect.width,this.screenRect.height),$Lar.mainContext.enable(3089)):($Lar.mainContext.disable(3089),$LCr.worldScissorTest=!1),$LR.copyFrom(this.screenRect),!0},$Lr._scissorWithTagart=function($Lr,$Li,$Lt,$L_){if($Lt<1||$L_<1)return!1;var $LA=$Lr+$Lt,$Lf=$Li+$L_;$Lr<0&&($Lt=$LA-($Lr=0)),$Li<0&&($L_=$Lf-($Li=0));var $LE=$LCr.worldClipRect;if($Lr=Math.max($Lr,$LE.x),$Li=Math.max($Li,$LE.y),$Lt=Math.min($LA,$LE.right)-$Lr,$L_=Math.min($Lf,$LE.bottom)-$Li,$Lt<1||$L_<1)return!1;var $LG=$LCr.worldScissorTest;return this.screenRect.copyFrom($LE),$LCr.worldScissorTest=!0,$LE.x=$Lr,$LE.y=$Li,$LE.width=$Lt,$LE.height=$L_,$Li=$LCr.height-$Li-$L_,$Lar.mainContext.scissor($Lr,$Li,$Lt,$L_),$Lar.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$LG?($Li=$LCr.height-this.screenRect.y-this.screenRect.height,$Lar.mainContext.scissor(this.screenRect.x,$Li,this.screenRect.width,this.screenRect.height),$Lar.mainContext.enable(3089)):($Lar.mainContext.disable(3089),$LCr.worldScissorTest=!1),$LE.copyFrom(this.screenRect),!0},$Lr.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},$Lr.getRenderType=function(){return 0},$Lr.releaseRender=function(){var $Lr=$Lt._cache;($Lr[$Lr._length++]=this).context=null},$Lt.create=function($Lr){var $Li=$Lt._cache._length?$Lt._cache[--$Lt._cache._length]:new $Lt;return $Li.context=$Lr,$Li},$Lt._cache=(($Lt._cache=[])._length=0,$Lt._cache),$Lt}(),$Lgr=function(){function $LN(){this.step=0,this.blendMode=null,this.level=0}$LX($LN,"laya.webgl.submit.SubmitStencil");var $Lr=$LN.prototype;return $Lu.imps($Lr,{"laya.webgl.submit.ISubmit":!0}),$Lr.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},$Lr.getRenderType=function(){return 0},$Lr.releaseRender=function(){var $Lr=$LN._cache;$Lr[$Lr._length++]=this},$Lr.do1=function(){var $Lr=$Lar.mainContext;$Lr.enable(2960),$Lr.clear(1024),$Lr.colorMask(!1,!1,!1,!1),$Lr.stencilFunc(514,this.level,255),$Lr.stencilOp(7680,7680,7682)},$Lr.do2=function(){var $Lr=$Lar.mainContext;$Lr.stencilFunc(514,this.level+1,255),$Lr.colorMask(!0,!0,!0,!0),$Lr.stencilOp(7680,7680,7680)},$Lr.do3=function(){var $Lr=$Lar.mainContext;$Lr.colorMask(!0,!0,!0,!0),$Lr.stencilOp(7680,7680,7680),$Lr.clear(1024),$Lr.disable(2960)},$Lr.do4=function(){var $Lr=$Lar.mainContext;0==this.level&&($Lr.enable(2960),$Lr.clear(1024)),$Lr.colorMask(!1,!1,!1,!1),$Lr.stencilFunc(519,0,255),$Lr.stencilOp(7680,7680,7682)},$Lr.do5=function(){var $Lr=$Lar.mainContext;$Lr.stencilFunc(514,this.level,255),$Lr.colorMask(!0,!0,!0,!0),$Lr.stencilOp(7680,7680,7680)},$Lr.do6=function(){var $Lr=$Lar.mainContext;$L$.targetFns[$L$.TOINT[this.blendMode]]($Lr)},$Lr.do7=function(){var $Lr=$Lar.mainContext;$Lr.colorMask(!1,!1,!1,!1),$Lr.stencilOp(7680,7680,7683)},$Lr.do8=function(){var $Lr=$Lar.mainContext;$Lr.colorMask(!0,!0,!0,!0),$Lr.stencilFunc(514,this.level,255),$Lr.stencilOp(7680,7680,7680)},$LN.restore=function($Lr,$Li,$Lt,$L_,$LA){var $Lf;if(($Lr._renderKey=0)<$LN._mask&&$LN._mask--,0==$LN._mask)$Lf=laya.webgl.submit.SubmitStencil.create(3),$Lr.addRenderObject($Lf),$Lr._curSubmit=$Lfr.RENDERBASE;else{$Lf=laya.webgl.submit.SubmitStencil.create(7),$Lr.addRenderObject($Lf);var $LE=$Lr._vb;$LE._byteLength;if($LBr.fillRectImgVb($LE,null,$Li.x,$Li.y,$Li.width,$Li.height,$Lb.DEF_UV,$Lt,$L_,$LA,0,0)){$Lr._shader2D.glTexture=null;var $LG=$Lr._curSubmit=$Lfr.createSubmit($Lr,$Lr._ib,$LE,($LE._byteLength-64)/32*3,$LHr.create(2,0));$LG.shaderValue.ALPHA=1,$Lr._submits[$Lr._submits._length++]=$LG,$Lr._curSubmit._numEle+=6,$Lr._curSubmit=$Lfr.RENDERBASE}else alert("clipRect calc stencil rect error");$Lf=laya.webgl.submit.SubmitStencil.create(8),$Lr.addRenderObject($Lf)}},$LN.restore2=function($Lr,$Li){var $Lt;($Lr._renderKey=0)<$LN._mask&&$LN._mask--,0==$LN._mask?($Lt=laya.webgl.submit.SubmitStencil.create(3),$Lr.addRenderObject($Lt),$Lr._curSubmit=$Lfr.RENDERBASE):($Lt=laya.webgl.submit.SubmitStencil.create(7),$Lr.addRenderObject($Lt),$Lr._submits[$Lr._submits._length++]=$Li,$Lt=laya.webgl.submit.SubmitStencil.create(8),$Lr.addRenderObject($Lt))},$LN.create=function($Lr){var $Li=$LN._cache._length?$LN._cache[--$LN._cache._length]:new $LN;return 5==($Li.step=$Lr)&&++$LN._mask,$Li.level=$LN._mask,$Li},$LN._cache=(($LN._cache=[])._length=0,$LN._cache),$LN._mask=0,$LN}(),$LRr=function(){function $LG(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}$LX($LG,"laya.webgl.submit.SubmitTarget");var $Lr=$LG.prototype;return $Lu.imps($Lr,{"laya.webgl.submit.ISubmit":!0}),$Lr.renderSubmit=function(){this._vb.bind_upload(this._ib);var $Lr=this.scope.getValue(this.proName);return $Lr&&(this.shaderValue.texture=$Lr.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[$Lr.width,$Lr.height]),this.shaderValue.upload(),this.blend(),$Le.drawCall++,$Le.trianglesFaces+=this._numEle/3,$Lar.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},$Lr.blend=function(){if($L$.activeBlendFunction!==$L$.fns[this.blendType]){var $Lr=$Lar.mainContext;$Lr.enable(3042),$L$.fns[this.blendType]($Lr),$L$.activeBlendFunction=$L$.fns[this.blendType]}},$Lr.getRenderType=function(){return 0},$Lr.releaseRender=function(){var $Lr=$LG._cache;($Lr[$Lr._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$LG.create=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=$LG._cache._length?$LG._cache[--$LG._cache._length]:new $LG;return $LE._ib=$Li,$LE._vb=$Lt,$LE.proName=$Lf,$LE._startIdx=$L_*$Lcr.BYTES_PIDX,$LE._numEle=0,$LE.blendType=$Lr._nBlendType,$LE.shaderValue=$LA,$LE.shaderValue.setValue($Lr._shader2D),$LE},$LG._cache=(($LG._cache=[])._length=0,$LG._cache),$LG}(),$LXr=function(){function $Lr(){this._sourceStr=null}$LX($Lr,"laya.webgl.text.CharSegment");var $Li=$Lr.prototype;return $Lu.imps($Li,{"laya.webgl.text.ICharSegment":!0}),$Li.textToSpit=function($Lr){this._sourceStr=$Lr},$Li.getChar=function($Lr){return this._sourceStr.charAt($Lr)},$Li.getCharCode=function($Lr){return this._sourceStr.charCodeAt($Lr)},$Li.length=function(){return this._sourceStr.length},$Lr}(),$Lvr=function(){var $Lr;function $Le(){}return $LX($Le,"laya.webgl.text.DrawText"),$Le.__init__=function(){$Le._charsTemp=new Array,$Le._drawValue=new $Lr,$Le._charSeg=new $LXr},$Le.customCharSeg=function($Lr){$Le._charSeg=$Lr},$Le.getChar=function($Lr,$Li,$Lt){var $L_=$Lzr.createOneChar($Lr,$Lt);return-1!=$Li&&($Le._charsCache[$Li]=$L_),$L_},$Le._drawSlow=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LR,$LX,$Lv,$LO){var $Lc,$LB,$Ly=$Le._drawValue.value($Lf,$LG,$LN,$Lp,$LX,$Lv,$LO),$LC=0,$Ln=0,$La=$Le._charsTemp,$LD=0,$Lu=NaN;if($L_)for($La.length=$L_.length,$LC=0,$Ln=$L_.length;$LC<$Ln;$LC++)($LB=$L_[$LC])&&($Lu=$LB.charNum+$Ly.txtID,$La[$LC]=$Lc=$Le._charsCache[$Lu]||$Le.getChar($LB.char,$Lu,$Ly),$Lc.active());else{var $Lw=$Lt instanceof laya.utils.WordText?$Lt.toString():$Lt;if($LF.CharacterCache){$Le._charSeg.textToSpit($Lw);var $LH=$Le._charSeg.length();for($LC=0,$Ln=$La.length=$LH;$LC<$Ln;$LC++)$Lu=$Le._charSeg.getCharCode($LC)+$Ly.txtID,$La[$LC]=$Lc=$Le._charsCache[$Lu]||$Le.getChar($Le._charSeg.getChar($LC),$Lu,$Ly),$Lc.active(),$LD+=$Lc.cw}else $La.length=0,($Lc=$Le.getChar($Lw,-1,$Ly)).active(),$LD+=$Lc.cw,$La[0]=$Lc}var $Ls=0;null!==$LE&&"left"!==$LE&&($Ls=-("center"==$LE?$LD/2:$LD));var $Ld,$Ll,$LU=NaN,$Lk=0;if($L_)for($LC=0,$Ln=$La.length;$LC<$Ln;$LC++)$Lc=$La[$LC],$LB=$L_[$LC],$Lc&&$LB&&!$Lc.isSpace&&($LU=$Lc.borderSize,$Ld=$Lc.texture,$Li._drawText($Ld,$Lg+$Ls+$LB.x*$LX-$LU,$LR+$LB.y*$Lv-$LU,$Ld.width,$Ld.height,$LA,0,0,0,0));else{for($LC=0,$Ln=$La.length;$LC<$Ln;$LC++)($Lc=$La[$LC])&&!$Lc.isSpace&&($LU=$Lc.borderSize,$Ld=$Lc.texture,$Li._drawText($Ld,$Lg+$Ls-$LU,$LR-$LU,$Ld.width,$Ld.height,$LA,0,0,0,0),$Lr&&(($Ll=$Lr[$Lk++])||($Ll=$Lr[$Lk-1]=[]),$Ll[0]=$Ld,$Ll[1]=$Ls-$LU,$Ll[2]=-$LU)),$Ls+=$Lc.cw;$Lr&&($Lr.length=$Lk)}},$Le._drawFast=function($Lr,$Li,$Lt,$L_,$LA){for(var $Lf,$LE,$LG=0,$LN=$Lr.length;$LG<$LN;$LG++)($Lf=($LE=$Lr[$LG])[0]).active(),$Li._drawText($Lf,$L_+$LE[1],$LA+$LE[2],$Lf.width,$Lf.height,$Lt,0,0,0,0)},$Le.drawText=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LR){if(void 0===$LR&&($LR=0),!($Li&&0===$Li.length||$Lt&&0===$Lt.length)){var $LX=$L_.a,$Lv=$L_.d;(0!==$L_.b||0!==$L_.c)&&($LX=$Lv=1);var $LO=1!==$LX||1!==$Lv;if($LO&&$Lu.stage.transform){var $Lc=$Lu.stage.transform;$LO=$Lc.a===$LX&&$Lc.d===$Lv}else $LO=!1;if($LO){var $LB=($L_=$L_.copyTo($Lwr._tmpMatrix)).tx,$Ly=$L_.ty;$L_.scale(1/$LX,1/$Lv),$L_._checkTransform(),$Lp*=$LX,$Lg*=$Lv,$Lp+=$LB-$L_.tx,$Lg+=$Ly-$L_.ty}else $LX=$Lv=1;if($Lt)$Le._drawSlow(null,$Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LX,$Lv,$LR);else{if(null===$Li.toUpperCase){var $LC=$LX+1e5*$Lv,$Ln=$Li;return void($Ln.changed||$Ln.id!==$LC?($Ln.id=$LC,$Ln.changed=!1,$Le._drawSlow($Ln.save,$Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LX,$Lv,$LR)):$Le._drawFast($Ln.save,$Lr,$L_,$Lp,$Lg))}var $La=$Li+$LA.toString()+$LE+$LG+$LN+$LX+$Lv+$Lf,$LD=$Le._textsCache[$La];$LF.CharacterCache?$LD?$Le._drawFast($LD,$Lr,$L_,$Lp,$Lg):($Le._textsCache.__length||($Le._textsCache.__length=0),$Le._textsCache.__length>$Lw.WebGLTextCacheCount&&(($Le._textsCache={}).__length=0,$Le._curPoolIndex=0),$Le._textCachesPool[$Le._curPoolIndex]?($LD=$Le._textsCache[$La]=$Le._textCachesPool[$Le._curPoolIndex]).length=0:$Le._textCachesPool[$Le._curPoolIndex]=$LD=$Le._textsCache[$La]=[],$Le._textsCache.__length++,$Le._curPoolIndex++,$Le._drawSlow($LD,$Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LX,$Lv,$LR)):$Le._drawSlow($LD,$Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LX,$Lv,$LR)}}},$Le._charsTemp=null,$Le._textCachesPool=[],$Le._curPoolIndex=0,$Le._charsCache={},$Le._textsCache={},$Le._drawValue=null,$Le.d=[],$Le._charSeg=null,$Le.__init$=function(){$Lr=function(){function $LN(){}return $LX($LN,""),$LN.prototype.value=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this.font=$Lr,this.fillColor=$Li,this.borderColor=$Lt,this.lineWidth=$L_,this.scaleX=$LA,this.scaleY=$Lf,this.underLine=$LE;var $LG=$Lr.toString()+$LA+$Lf+$L_+($Li?$Li.toLowerCase():" ")+($Lt?$Lt.toLowerCase():" ")+$LE;return this.txtID=$LN._keymap[$LG],this.txtID||(this.txtID=1e-7*++$LN._keymapCount,$LN._keymap[$LG]=this.txtID),this},$LN.clear=function(){$LN._keymap={},$LN._keymapCount=1},$LN._keymap={},$LN._keymapCount=1,$LN}()},$Le}(),$LOr=function(){function $LA($Lr){this._index=0,this._size=14,this._italic=-2,$LA._cache2=$LA._cache2||[],this.setFont($Lr||"14px Arial")}$LX($LA,"laya.webgl.text.FontInContext");var $Lr=$LA.prototype;return $Lr.setFont=function($Lr){var $Li=$LA._cache2[$Lr];if($Li)this._words=$Li[0],this._size=$Li[1];else{this._words=$Lr.split(" ");for(var $Lt=0,$L_=this._words.length;$Lt<$L_;$Lt++)if(0<this._words[$Lt].indexOf("px")){this._index=$Lt;break}this._size=parseInt(this._words[this._index]),$LA._cache2[$Lr]=[this._words,this._size]}this._text=null,this._italic=-2},$Lr.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},$Lr.hasType=function($Lr){for(var $Li=0,$Lt=this._words.length;$Li<$Lt;$Li++)if(this._words[$Li]===$Lr)return $Li;return-1},$Lr.removeType=function($Lr){for(var $Li=0,$Lt=this._words.length;$Li<$Lt;$Li++)if(this._words[$Li]===$Lr){this._words.splice($Li,1),this._index>$Li&&this._index--;break}this._text=null,this._italic=-2},$Lr.copyTo=function($Lr){return $Lr._text=this._text,$Lr._size=this._size,$Lr._index=this._index,$Lr._words=this._words.slice(),$Lr._italic=-2,$Lr},$Lr.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},$L_(0,$Lr,"size",function(){return this._size},function($Lr){this._size=$Lr,this._words[this._index]=$Lr+"px",this._text=null}),$LA.create=function($Lr){var $Li=$LA._cache[$Lr];return $Li||($Li=$LA._cache[$Lr]=new $LA($Lr))},$LA.EMPTY=new $LA,$LA._cache={},$LA._cache2=null,$LA}(),$Lcr=function(){function $Lr(){}return $LX($Lr,"laya.webgl.utils.CONST3D2D"),$Lr.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$Lr.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],$Lr.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],$Lr._TMPARRAY=[],$Lr._OFFSETX=0,$Lr._OFFSETY=0,$LE($Lr,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),$Lr}(),$LBr=function(){function $LO(){}return $LX($LO,"laya.webgl.utils.GlUtils"),$LO.make2DProjection=function($Lr,$Li,$Lt){return[2/$Lr,0,0,0,0,-2/$Li,0,0,0,0,2/$Lt,0,-1,1,0,1]},$LO.fillIBQuadrangle=function($Lr,$Li){if(65535/4<$Li)throw Error("IBQuadrangle count:"+$Li+" must<:"+Math.floor(65535/4));$Li=Math.floor($Li),$Lr._resizeBuffer(6*($Li+1)*2,!1),$Lr.byteLength=$Lr.bufferLength;for(var $Lt=$Lr.getUint16Array(),$L_=0,$LA=0;$LA<$Li;$LA++)$Lt[$L_++]=4*$LA,$Lt[$L_++]=4*$LA+2,$Lt[$L_++]=4*$LA+1,$Lt[$L_++]=4*$LA,$Lt[$L_++]=4*$LA+3,$Lt[$L_++]=4*$LA+2;return $Lr.setNeedUpload(),!0},$LO.expandIBQuadrangle=function($Lr,$Li){$Lr.bufferLength>=6*$Li*2||$LO.fillIBQuadrangle($Lr,$Li)},$LO.mathCeilPowerOfTwo=function($Lr){return $Lr--,$Lr|=$Lr>>1,$Lr|=$Lr>>2,$Lr|=$Lr>>4,$Lr|=$Lr>>8,$Lr|=$Lr>>16,++$Lr},$LO.fillQuadrangleImgVb=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){var $LN=16+($Lr._byteLength>>2);$Lr.byteLength=$LN<<2;var $Lp=$Lr.getFloat32Array();$Lp[($LN-=16)+2]=$LA[0],$Lp[$LN+3]=$LA[1],$Lp[$LN+6]=$LA[2],$Lp[$LN+7]=$LA[3],$Lp[$LN+10]=$LA[4],$Lp[$LN+11]=$LA[5],$Lp[$LN+14]=$LA[6],$Lp[$LN+15]=$LA[7];var $Lg=$Lf.a,$LR=$Lf.b,$LX=$Lf.c,$Lv=$Lf.d;if(1!==$Lg||0!==$LR||0!==$LX||1!==$Lv){$Lf.bTransform=!0;var $LO=$Lf.tx+$LE,$Lc=$Lf.ty+$LG;$Lp[$LN]=($L_[0]+$Li)*$Lg+($L_[1]+$Lt)*$LX+$LO,$Lp[$LN+1]=($L_[0]+$Li)*$LR+($L_[1]+$Lt)*$Lv+$Lc,$Lp[$LN+4]=($L_[2]+$Li)*$Lg+($L_[3]+$Lt)*$LX+$LO,$Lp[$LN+5]=($L_[2]+$Li)*$LR+($L_[3]+$Lt)*$Lv+$Lc,$Lp[$LN+8]=($L_[4]+$Li)*$Lg+($L_[5]+$Lt)*$LX+$LO,$Lp[$LN+9]=($L_[4]+$Li)*$LR+($L_[5]+$Lt)*$Lv+$Lc,$Lp[$LN+12]=($L_[6]+$Li)*$Lg+($L_[7]+$Lt)*$LX+$LO,$Lp[$LN+13]=($L_[6]+$Li)*$LR+($L_[7]+$Lt)*$Lv+$Lc}else $Lf.bTransform=!1,$Li+=$Lf.tx+$LE,$Lt+=$Lf.ty+$LG,$Lp[$LN]=$Li+$L_[0],$Lp[$LN+1]=$Lt+$L_[1],$Lp[$LN+4]=$Li+$L_[2],$Lp[$LN+5]=$Lt+$L_[3],$Lp[$LN+8]=$Li+$L_[4],$Lp[$LN+9]=$Lt+$L_[5],$Lp[$LN+12]=$Li+$L_[6],$Lp[$LN+13]=$Lt+$L_[7];return $Lr._upload=!0},$LO.fillTranglesVB=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){var $LG=($Lr._byteLength>>2)+$L_.length;$Lr.byteLength=$LG<<2;var $LN=$Lr.getFloat32Array();$LG-=$L_.length;for(var $Lp=$L_.length,$Lg=$LA.a,$LR=$LA.b,$LX=$LA.c,$Lv=$LA.d,$LO=0;$LO<$Lp;$LO+=4)if($LN[$LG+$LO+2]=$L_[$LO+2],$LN[$LG+$LO+3]=$L_[$LO+3],1!==$Lg||0!==$LR||0!==$LX||1!==$Lv){$LA.bTransform=!0;var $Lc=$LA.tx+$Lf,$LB=$LA.ty+$LE;$LN[$LG+$LO]=($L_[$LO]+$Li)*$Lg+($L_[$LO+1]+$Lt)*$LX+$Lc,$LN[$LG+$LO+1]=($L_[$LO]+$Li)*$LR+($L_[$LO+1]+$Lt)*$Lv+$LB}else $LA.bTransform=!1,$Li+=$LA.tx+$Lf,$Lt+=$LA.ty+$LE,$LN[$LG+$LO]=$Li+$L_[$LO],$LN[$LG+$LO+1]=$Lt+$L_[$LO+1];return $Lr._upload=!0},$LO.copyPreImgVb=function($Lr,$Li,$Lt){var $L_=$Lr._byteLength>>2;$Lr.byteLength=$L_+16<<2;for(var $LA=$Lr.getFloat32Array(),$Lf=0,$LE=$L_-16;$Lf<4;$Lf++)$LA[$L_]=$LA[$LE]+$Li,++$LE,$LA[++$L_]=$LA[$LE]+$Lt,++$LE,$LA[++$L_]=$LA[$LE],++$LE,$LA[++$L_]=$LA[$LE],++$L_,++$LE;$Lr._upload=!0},$LO.fillRectImgVb=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LR,$LX){void 0===$LX&&($LX=!1);var $Lv,$LO,$Lc,$LB,$Ly,$LC,$Ln,$La,$LD,$Lu,$Lw,$LH,$Ls,$Ld,$Ll,$LU,$Lk=1,$Le=$LG.a,$LL=$LG.b,$LQ=$LG.c,$LF=$LG.d,$Lb=$Li&&$Li.width<99999999;if(1!==$Le||0!==$LL||0!==$LQ||1!==$LF?($LG.bTransform=!0,0===$LL&&0===$LQ&&($Lk=23,$LD=$LA+$Lt,$Lu=$Lf+$L_,$Lv=$Le*$Lt+($Lw=$LG.tx+$LN),$Lc=$Le*$LD+$Lw,$LO=$LF*$L_+($LH=$LG.ty+$Lp),$LB=$LF*$Lu+$LH)):($Lk=23,$LG.bTransform=!1,$Lc=($Lv=$Lt+$LG.tx+$LN)+$LA,$LB=($LO=$L_+$LG.ty+$Lp)+$Lf),$Lb&&($Ly=$Li.x,$LC=$Li.y,$Ln=$Li.width+$Ly,$La=$Li.height+$LC),1!==$Lk){if(Math.min($Lv,$Lc)>=$Ln)return!1;if(Math.min($LO,$LB)>=$La)return!1;if(Math.max($Lc,$Lv)<=$Ly)return!1;if(Math.max($LB,$LO)<=$LC)return!1}var $LV=$Lr._byteLength>>2;$Lr.byteLength=16+$LV<<2;var $Lh=$Lr.getFloat32Array();switch($Lh[2+$LV]=$LE[0],$Lh[3+$LV]=$LE[1],$Lh[6+$LV]=$LE[2],$Lh[7+$LV]=$LE[3],$Lh[10+$LV]=$LE[4],$Lh[11+$LV]=$LE[5],$Lh[14+$LV]=$LE[6],$Lh[15+$LV]=$LE[7],$Lk){case 1:$Lw=$LG.tx+$LN,$LH=$LG.ty+$Lp;var $LP=$Le*$Lt,$Lq=$LQ*$L_,$Lm=$LF*$L_,$LT=$LL*$Lt,$Lx=$Le*($LD=$LA+$Lt),$L$=$LQ*($Lu=$Lf+$L_),$Lo=$LF*$Lu,$LI=$LL*$LD;$LX?($Ls=$LP+$Lq+$Lw,$Ll=Math.round($Ls)-$Ls,$Ld=$Lm+$LT+$LH,$LU=Math.round($Ld)-$Ld,$Lh[$LV]=$Ls+$Ll,$Lh[1+$LV]=$Ld+$LU,$Lh[4+$LV]=$Lx+$Lq+$Lw+$Ll,$Lh[5+$LV]=$Lm+$LI+$LH+$LU,$Lh[8+$LV]=$Lx+$L$+$Lw+$Ll,$Lh[9+$LV]=$Lo+$LI+$LH+$LU,$Lh[12+$LV]=$LP+$L$+$Lw+$Ll,$Lh[13+$LV]=$Lo+$LT+$LH+$LU):($Lh[$LV]=$LP+$Lq+$Lw,$Lh[1+$LV]=$Lm+$LT+$LH,$Lh[4+$LV]=$Lx+$Lq+$Lw,$Lh[5+$LV]=$Lm+$LI+$LH,$Lh[8+$LV]=$Lx+$L$+$Lw,$Lh[9+$LV]=$Lo+$LI+$LH,$Lh[12+$LV]=$LP+$L$+$Lw,$Lh[13+$LV]=$Lo+$LT+$LH);break;case 23:$LX?($Ls=$Lv+$Lg,$Ll=Math.round($Ls)-$Ls,$Ld=$LO,$LU=Math.round($Ld)-$Ld,$Lh[$LV]=$Ls+$Ll,$Lh[1+$LV]=$Ld+$LU,$Lh[4+$LV]=$Lc+$Lg+$Ll,$Lh[5+$LV]=$LO+$LU,$Lh[8+$LV]=$Lc+$Ll,$Lh[9+$LV]=$LB+$LU,$Lh[12+$LV]=$Lv+$Ll,$Lh[13+$LV]=$LB+$LU):($Lh[$LV]=$Lv+$Lg,$Lh[1+$LV]=$LO,$Lh[4+$LV]=$Lc+$Lg,$Lh[5+$LV]=$LO,$Lh[8+$LV]=$Lc,$Lh[9+$LV]=$LB,$Lh[12+$LV]=$Lv,$Lh[13+$LV]=$LB)}return $Lr._upload=!0},$LO.fillLineVb=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){var $LN=.5*$LE,$Lp=$LO._fillLineArray,$Lg=-($L_-$Lf),$LR=$Lt-$LA,$LX=Math.sqrt($Lg*$Lg+$LR*$LR);$Lg/=$LX,$LR/=$LX,$Lg*=$LN,$LR*=$LN,$Lp[0]=$Lt-$Lg,$Lp[1]=$L_-$LR,$Lp[4]=$Lt+$Lg,$Lp[5]=$L_+$LR,$Lp[8]=$LA+$Lg,$Lp[9]=$Lf+$LR,$Lp[12]=$LA-$Lg,$Lp[13]=$Lf-$LR,$LG&&$LG.transformPointArray($Lp,$Lp);var $Lv=16+($Lr._byteLength>>2);return $Lr.byteLength=$Lv<<2,$Lr.insertData($Lp,$Lv-16),!0},$LO._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$LO}(),$Lyr=(function(){function $LN(){}$LX($LN,"laya.webgl.utils.MatirxArray"),$LN.ArrayMul=function($Lr,$Li,$Lt){if($Lr)if($Li)for(var $L_=NaN,$LA=NaN,$Lf=NaN,$LE=NaN,$LG=0;$LG<4;$LG++)$L_=$Lr[$LG],$LA=$Lr[$LG+4],$Lf=$Lr[$LG+8],$LE=$Lr[$LG+12],$Lt[$LG]=$L_*$Li[0]+$LA*$Li[1]+$Lf*$Li[2]+$LE*$Li[3],$Lt[$LG+4]=$L_*$Li[4]+$LA*$Li[5]+$Lf*$Li[6]+$LE*$Li[7],$Lt[$LG+8]=$L_*$Li[8]+$LA*$Li[9]+$Lf*$Li[10]+$LE*$Li[11],$Lt[$LG+12]=$L_*$Li[12]+$LA*$Li[13]+$Lf*$Li[14]+$LE*$Li[15];else $LN.copyArray($Lr,$Lt);else $LN.copyArray($Li,$Lt)},$LN.copyArray=function($Lr,$Li){if($Lr&&$Li)for(var $Lt=0;$Lt<$Lr.length;$Lt++)$Li[$Lt]=$Lr[$Lt]}}(),function(){function $Li($Lr,$Li,$Lt){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=$Lr,this._vb=new $Ljr($Lr,35048),$Li&&this._vb._resizeBuffer($Li,!1),this._ib=new $LYr,$Lt&&this._ib._resizeBuffer($Lt,!1)}$LX($Li,"laya.webgl.utils.Mesh2D");var $Lr=$Li.prototype;return $Lr.cloneWithNewVB=function(){var $Lr=new $Li(this._stride,0,0);return $Lr._ib=this._ib,$Lr._quadNum=this._quadNum,$Lr._attribInfo=this._attribInfo,$Lr},$Lr.cloneWithNewVBIB=function(){var $Lr=new $Li(this._stride,0,0);return $Lr._attribInfo=this._attribInfo,$Lr},$Lr.getVBW=function(){return this._vb.setNeedUpload(),this._vb},$Lr.getVBR=function(){return this._vb},$Lr.getIBR=function(){return this._ib},$Lr.getIBW=function(){return this._ib.setNeedUpload(),this._ib},$Lr.createQuadIB=function($Lr){this._quadNum=$Lr,this._ib._resizeBuffer(6*$Lr*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var $Li=this._ib.getUint16Array(),$Lt=0,$L_=0,$LA=0;$LA<$Lr;$LA++)$Li[$Lt++]=$L_,$Li[$Lt++]=$L_+2,$Li[$Lt++]=$L_+1,$Li[$Lt++]=$L_,$Li[$Lt++]=$L_+3,$Li[$Lt++]=$L_+2,$L_+=4;this._ib.setNeedUpload()},$Lr.setAttributes=function($Lr){if(this._attribInfo=$Lr,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},$Lr.getEleNum=function(){return this._ib.getBuffer().byteLength/2},$Lr.releaseMesh=function(){},$Lr.destroy=function(){},$Lr.clearVB=function(){this._vb.clear()},$Li._gvaoid=0,$Li}()),$LCr=function(){function $LA(){}return $LX($LA,"laya.webgl.utils.RenderState2D"),$LA.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},$LA.mat2MatArray=function($Lr,$Li){var $Lt=$Lr,$L_=$Li;return $L_[0]=$Lt.a,$L_[1]=$Lt.b,$L_[2]=$LA.EMPTYMAT4_ARRAY[2],$L_[3]=$LA.EMPTYMAT4_ARRAY[3],$L_[4]=$Lt.c,$L_[5]=$Lt.d,$L_[6]=$LA.EMPTYMAT4_ARRAY[6],$L_[7]=$LA.EMPTYMAT4_ARRAY[7],$L_[8]=$LA.EMPTYMAT4_ARRAY[8],$L_[9]=$LA.EMPTYMAT4_ARRAY[9],$L_[10]=$LA.EMPTYMAT4_ARRAY[10],$L_[11]=$LA.EMPTYMAT4_ARRAY[11],$L_[12]=$Lt.tx,$L_[13]=$Lt.ty,$L_[14]=$LA.EMPTYMAT4_ARRAY[14],$L_[15]=$LA.EMPTYMAT4_ARRAY[15],$Li},$LA.restoreTempArray=function(){$LA.TEMPMAT4_ARRAY[0]=1,$LA.TEMPMAT4_ARRAY[1]=0,$LA.TEMPMAT4_ARRAY[4]=0,$LA.TEMPMAT4_ARRAY[5]=1,$LA.TEMPMAT4_ARRAY[12]=0,$LA.TEMPMAT4_ARRAY[13]=0},$LA.clear=function(){$LA.worldScissorTest=!1,$LA.worldShaderDefines=null,$LA.worldFilters=null,$LA.worldAlpha=1,$LA.worldClipRect.x=$LA.worldClipRect.y=0,$LA.worldClipRect.width=$LA.width,$LA.worldClipRect.height=$LA.height,$LA.curRenderTarget=null},$LA._MAXSIZE=99999999,$LA.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$LA.worldMatrix4=$LA.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$LA.worldAlpha=1,$LA.worldScissorTest=!1,$LA.worldFilters=null,$LA.worldShaderDefines=null,$LA.curRenderTarget=null,$LA.width=0,$LA.height=0,$LE($LA,["worldMatrix",function(){return this.worldMatrix=new $Ls},"worldClipRect",function(){return this.worldClipRect=new $Ll(0,0,99999999,99999999)}]),$LA}(),$Lnr=function(){var $LC,$Lt;function $Ln($Lr,$Li,$Lt,$L_,$LA){var $Lf=this;function $LE($Lr){var $Li=[],$Lt=new $LC($Li);return $Lf._compileToTree($Lt,$Lr.split("\n"),0,$Li,$LA),$Lt}var $LG=$Lv.now();this._VS=$LE($Li),this._PS=$LE($Lt),this._nameMap=$L_,2<$Lv.now()-$LG&&console.log("ShaderCompile use time:"+($Lv.now()-$LG)+"  size:"+$Li.length+"/"+$Lt.length)}$LX($Ln,"laya.webgl.utils.ShaderCompile");var $Lr=$Ln.prototype;return $Lr._compileToTree=function($Lr,$Li,$Lt,$L_,$LA){var $Lf,$LE,$LG,$LN,$Lp,$Lg,$LR,$LX=0,$Lv=0,$LO=0,$Lc=0;for($Lv=$Lt;$Lv<$Li.length;$Lv++)if(!(($LG=$Li[$Lv]).length<1)&&0!==($LX=$LG.indexOf("//"))){if(0<=$LX&&($LG=$LG.substr(0,$LX)),$Lf=$LR||new $LC($L_),$LR=null,$Lf.text=$LG,$Lf.noCompile=!0,0<=($LX=$LG.indexOf("#"))){for($LN="#",$Lc=$LX+1,$LO=$LG.length;$Lc<$LO;$Lc++){var $LB=$LG.charAt($Lc);if(" "===$LB||"\t"===$LB||"\r"===$LB||"\n"===$LB||"?"===$LB)break;$LN+=$LB}switch($Lf.name=$LN){case"#ifdef":case"#ifndef":if($Lf.src=$LG,$Lf.noCompile=null!=$LG.match(/[!&|()=<>]/),$Lf.noCompile?console.log("function():Boolean{return "+$LG.substr($LX+$Lf.name.length)+"}"):($Lg=$LG.replace(/^\s*/,"").split(/\s+/),$Lf.setCondition($Lg[1],"#ifdef"===$LN?1:2),$Lf.text="//"+$Lf.text),$Lf.setParent($Lr),$Lr=$Lf,$LA)for($Lg=$LG.substr($Lc).split($Ln._splitToWordExps3),$Lc=0;$Lc<$Lg.length;$Lc++)($LG=$Lg[$Lc]).length&&($LA[$LG]=!0);continue;case"#if":if($Lf.src=$LG,$Lf.noCompile=!0,$Lf.setParent($Lr),$Lr=$Lf,$LA)for($Lg=$LG.substr($Lc).split($Ln._splitToWordExps3),$Lc=0;$Lc<$Lg.length;$Lc++)($LG=$Lg[$Lc]).length&&"defined"!=$LG&&($LA[$LG]=!0);continue;case"#else":$Lf.src=$LG,$LE=($Lr=$Lr.parent).childs[$Lr.childs.length-1],$Lf.noCompile=$LE.noCompile,$Lf.noCompile||($Lf.condition=$LE.condition,$Lf.conditionType=1==$LE.conditionType?2:1,$Lf.text="//"+$Lf.text+" "+$LE.text+" "+$Lf.conditionType),$Lf.setParent($Lr),$Lr=$Lf;continue;case"#endif":$LE=($Lr=$Lr.parent).childs[$Lr.childs.length-1],$Lf.noCompile=$LE.noCompile,$Lf.noCompile||($Lf.text="//"+$Lf.text),$Lf.setParent($Lr);continue;case"#include":$Lg=$Ln.splitToWords($LG,null);var $Ly=$Ln.includes[$Lg[1]];if(!$Ly)throw"ShaderCompile error no this include file:"+$Lg[1];if(($LX=$Lg[0].indexOf("?"))<0){$Lf.setParent($Lr),$LG=$Ly.getWith("with"==$Lg[2]?$Lg[3]:null),this._compileToTree($Lf,$LG.split("\n"),0,$L_,$LA),$Lf.text="";continue}$Lf.setCondition($Lg[0].substr($LX+1),1),$Lf.text=$Ly.getWith("with"==$Lg[2]?$Lg[3]:null);break;case"#import":$Lp=($Lg=$Ln.splitToWords($LG,null))[1],$L_.push({node:$Lf,file:$Ln.includes[$Lp],ofs:$Lf.text.length});continue}}else{if(($LE=$Lr.childs[$Lr.childs.length-1])&&!$LE.name){0<$L_.length&&$Ln.splitToWords($LG,$LE),$LR=$Lf,$LE.text+="\n"+$LG;continue}0<$L_.length&&$Ln.splitToWords($LG,$Lf)}$Lf.setParent($Lr)}},$Lr.createShader=function($Lr,$Li,$Lt){var $L_={},$LA="";if($Lr)for(var $Lf in $Lr)$LA+="#define "+$Lf+"\n",$L_[$Lf]=!0;var $LE=this._VS.toscript($L_,[]),$LG=this._PS.toscript($L_,[]);return($Lt||$LWr.create)($LA+$LE.join("\n"),$LA+$LG.join("\n"),$Li,this._nameMap)},$Ln._parseOne=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE={type:$Ln.shaderParamsMap[$Lt[$L_+1]],name:$Lt[$L_+2],size:isNaN(parseInt($Lt[$L_+3]))?1:parseInt($Lt[$L_+3])};return $Lf&&("attribute"==$LA?$Lr.push($LE):$Li.push($LE)),":"==$Lt[$L_+3]&&($LE.type=$Lt[$L_+4],$L_+=2),$L_+=2},$Ln.addInclude=function($Lr,$Li){if(!$Li||0===$Li.length)throw new Error("add shader include file err:"+$Lr);if($Ln.includes[$Lr])throw new Error("add shader include file err, has add:"+$Lr);$Ln.includes[$Lr]=new $Lt($Li)},$Ln.preGetParams=function($Lr,$Li){var $Lt=[$Lr,$Li],$L_={},$LA=[],$Lf=[],$LE={},$LG=[];$L_.attributes=$LA,$L_.uniforms=$Lf,$L_.defines=$LE;for(var $LN=0,$Lp=0,$Lg=0;$Lg<2;$Lg++){$Lt[$Lg]=$Lt[$Lg].replace($Ln._removeAnnotation,"");var $LR,$LX=$Lt[$Lg].match($Ln._reg);for($LN=0,$Lp=$LX.length;$LN<$Lp;$LN++){var $Lv=$LX[$LN];if("attribute"==$Lv||"uniform"==$Lv)$LN=$Ln._parseOne($LA,$Lf,$LX,$LN,$Lv,!0);else{if("#define"==$Lv){$LG[$Lv=$LX[++$LN]]=1;continue}if("#ifdef"==$Lv){$LE[$LR=$LX[++$LN]]=$LE[$LR]||[];for($LN++;$LN<$Lp;$LN++)if("attribute"==($Lv=$LX[$LN])||"uniform"==$Lv)$LN=$Ln._parseOne($LA,$Lf,$LX,$LN,$Lv,$LG[$LR]);else if("#else"==$Lv)for($LN++;$LN<$Lp;$LN++)if("attribute"==($Lv=$LX[$LN])||"uniform"==$Lv)$LN=$Ln._parseOne($LA,$Lf,$LX,$LN,$Lv,!$LG[$LR]);else if("#endif"==$Lv)break}}}}return $L_},$Ln.splitToWords=function($Lr,$Li){for(var $Lt,$L_,$LA=[],$Lf=-1,$LE=0,$LG=$Lr.length;$LE<$LG;$LE++)if($Lt=$Lr.charAt($LE),0<=" \t=+-*/&%!<>()'\",;".indexOf($Lt)){if(0<=$Lf&&1<$LE-$Lf&&($L_=$Lr.substr($Lf,$LE-$Lf),$LA.push($L_)),'"'==$Lt||"'"==$Lt){var $LN=$Lr.indexOf($Lt,$LE+1);if($LN<0)throw"Sharder err:"+$Lr;$LA.push($Lr.substr($LE+1,$LN-$LE-1)),$LE=$LN,$Lf=-1;continue}"("==$Lt&&$Li&&0<$LA.length&&($L_=$LA[$LA.length-1]+";","vec4;main;".indexOf($L_)<0&&($Li.useFuns+=$L_)),$Lf=-1}else $Lf<0&&($Lf=$LE);return $Lf<$LG&&1<$LG-$Lf&&($L_=$Lr.substr($Lf,$LG-$Lf),$LA.push($L_)),$LA},$Ln.IFDEF_NO=0,$Ln.IFDEF_YES=1,$Ln.IFDEF_ELSE=2,$Ln.IFDEF_PARENT=3,$Ln._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),$Ln._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),$Ln._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),$Ln.includes={},$LE($Ln,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),$Ln.__init$=function(){$LC=function(){function $Lt($Lr){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=$Lr}$LX($Lt,"");var $Lr=$Lt.prototype;return $Lr.setParent=function($Lr){$Lr.childs.push(this),this.z=$Lr.z+1,this.parent=$Lr},$Lr.setCondition=function($Lr,$Li){$Lr&&(this.conditionType=$Li,$Lr=$Lr.replace(/(\s*$)/g,""),this.condition=function(){return this[$Lr]},this.condition.__condition=$Lr)},$Lr.toscript=function($Lr,$Li){return this._toscript($Lr,$Li,++$Lt.__id)},$Lr._toscript=function($L_,$LA,$Lf){if(this.childs.length<1&&!this.text)return $LA;$LA.length;if(this.condition){var $Lr=!!this.condition.call($L_);if(2===this.conditionType&&($Lr=!$Lr),!$Lr)return $LA}if(this.text&&$LA.push(this.text),0<this.childs.length&&this.childs.forEach(function($Lr,$Li,$Lt){$Lr._toscript($L_,$LA,$Lf)}),0<this.includefiles.length&&0<this.useFuns.length)for(var $Li,$Lt=0,$LE=this.includefiles.length;$Lt<$LE;$Lt++)this.includefiles[$Lt].curUseID!=$Lf&&0<($Li=this.includefiles[$Lt].file.getFunsScript(this.useFuns)).length&&(this.includefiles[$Lt].curUseID=$Lf,$LA[0]=$Li+$LA[0]);return $LA},$Lt.__id=1,$Lt}(),$Lt=function(){function $Lr($Lr){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=$Lr;for(var $Li=0,$Lt=0,$L_=0;!(($Li=$Lr.indexOf("#begin",$Li))<0);){for($L_=$Li+5;!(($L_=$Lr.indexOf("#end",$L_))<0)&&"i"===$Lr.charAt($L_+4);)$L_+=5;if($L_<0)throw"add include err,no #end:"+$Lr;$Lt=$Lr.indexOf("\n",$Li);var $LA=$Ln.splitToWords($Lr.substr($Li,$Lt-$Li),null);"code"==$LA[1]?this.codes[$LA[2]]=$Lr.substr($Lt+1,$L_-$Lt-1):"function"==$LA[1]&&($Lt=$Lr.indexOf("function",$Li),$Lt+="function".length,this.funs[$LA[3]]=$Lr.substr($Lt+1,$L_-$Lt-1),this.funnames+=$LA[3]+";"),$Li=$L_+1}}$LX($Lr,"");var $Li=$Lr.prototype;return $Li.getWith=function($Lr){var $Li=$Lr?this.codes[$Lr]:this.script;if(!$Li)throw"get with error:"+$Lr;return $Li},$Li.getFunsScript=function($Lr){var $Li="";for(var $Lt in this.funs)0<=$Lr.indexOf($Lt+";")&&($Li+=this.funs[$Lt]);return $Li},$Lr}()},$Ln}(),$Lar=function(){function $LE(){}return $LX($LE,"laya.webgl.WebGL"),$LE._uint8ArraySlice=function(){for(var $Lr=this.length,$Li=new Uint8Array(this.length),$Lt=0;$Lt<$Lr;$Lt++)$Li[$Lt]=this[$Lt];return $Li},$LE._float32ArraySlice=function(){for(var $Lr=this.length,$Li=new Float32Array(this.length),$Lt=0;$Lt<$Lr;$Lt++)$Li[$Lt]=this[$Lt];return $Li},$LE._uint16ArraySlice=function($Lr){var $Li,$Lt=arguments,$L_=0,$LA=0;if(0===$Lt.length)for($L_=this.length,$Li=new Uint16Array($L_),$LA=0;$LA<$L_;$LA++)$Li[$LA]=this[$LA];else if(2===$Lt.length){var $Lf=$Lt[0],$LE=$Lt[1];if($Lf<$LE)for($L_=$LE-$Lf,$Li=new Uint16Array($L_),$LA=$Lf;$LA<$LE;$LA++)$Li[$LA-$Lf]=this[$LA];else $Li=new Uint16Array(0)}return $Li},$LE.expandContext=function(){var $Lr=$LA.prototype,$Li=CanvasRenderingContext2D.prototype;$Li.fillTrangles=$Lr.fillTrangles,$LMr.__int__(null),$Li.setIBVB=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){void 0===$LN&&($LN=0),void 0===$Lp&&($Lp=0),null===$Lt&&(this._ib=this._ib||$LYr.QuadrangleIB,$Lt=this._ib,$LBr.expandIBQuadrangle($Lt,$L_._byteLength/64+8)),this._setIBVB($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp)},$Li.fillTrangles=function($Lr,$Li,$Lt,$L_,$LA){this._curMat=this._curMat||$Ls.create(),this._vb=this._vb||$Ljr.create(),this._ib||(this._ib=$LYr.create(),$LBr.fillIBQuadrangle(this._ib,$LE/4));var $Lf=this._vb,$LE=$L_.length>>4;$LBr.fillTranglesVB($Lf,$Li,$Lt,$L_,$LA||this._curMat,0,0),$LBr.expandIBQuadrangle(this._ib,$Lf._byteLength/64+8);var $LG=new $LHr(1,0);$LG.textureHost=$Lr;var $LN=new $LSr("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");$Lf._vertType=3,this._setIBVB($Li,$Lt,this._ib,$Lf,6*$LE,$LA,$LN,$LG,0,0)}},$LE.enable=function(){if($Lv.__init__(),$Ly.isConchApp&&!$Ly.isConchWebGL)return $LD.skinAniSprite=function(){return new $Lrr},$LE.expandContext(),!1;if($LD.getWebGLContext=function($Lr){for(var $Li,$Lt=["webgl","experimental-webgl","webkit-3d","moz-webgl"],$L_=0;$L_<$Lt.length;$L_++){try{$Li=$Lr.getContext($Lt[$L_],{stencil:$Lw.isStencil,alpha:$Lw.isAlpha,antialias:$Lw.isAntialias,premultipliedAlpha:$Lw.premultipliedAlpha,preserveDrawingBuffer:$Lw.preserveDrawingBuffer})}catch($Lr){}if($Li)return $Li}return null},null==($LE.mainContext=$LE.mainContext||$LD.getWebGLContext($Ly._mainCanvas)))return!1;if($Ly.isWebGL)return!0;$Lc.create=function($Lr,$Li){return new $Lri($Lr,$Li)},$LB.create=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){return new $LZr($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE)},$Ly.WebGL=$LE,$Ly.isWebGL=!0,$Lvr.__init__(),$LD.createRenderSprite=function($Lr,$Li){return new $Lsr($Lr,$Li)},$LD.createWebGLContext2D=function($Lr){return new $Lwr($Lr)},$LD.changeWebGLSize=function($Lr,$Li){laya.webgl.WebGL.onStageResize($Lr,$Li)},$LD.createGraphics=function(){return new $Lur};var $Lr=$LD.createFilterAction;return $LD.createFilterAction=$Lr||function($Lr){return new $Ldr},$LD.clear=function($Lr){$LCr.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var $Li=$Ly.context.ctx,$Lt=0==$Li._submits._length||$Lw.preserveDrawingBuffer?$LO.create($Lr)._color:$Lk._wgColor;$Lt&&$Li.clearBG($Lt[0],$Lt[1],$Lt[2],$Lt[3]),$LCr.clear()},$LD.addToAtlas=function($Lr,$Li){void 0===$Li&&($Li=!1);var $Lt=$Lr.bitmap;$Ly.optimizeTextureMemory($Lr.url,$Lr)?$Lu.__typeof($Lt,"laya.webgl.resource.IMergeAtlasBitmap")&&$Lt.allowMerageInAtlas&&$Lt.on("recovered",$Lr,$Lr.addTextureToAtlas):$Lt.enableMerageInAtlas=!1},$LD.isAtlas=function($Lr){return $Lr instanceof laya.webgl.atlas.AtlasWebGLCanvas},$LT._enable(),$LD.beginFlush=function(){for(var $Lr=$LT.instance,$Li=$Lr.getAtlaserCount(),$Lt=0;$Lt<$Li;$Lt++){var $L_=$Lr.getAtlaserByIndex($Lt).texture;$L_._flashCacheImageNeedFlush&&$LD.flashFlushImage($L_)}},$LD.drawToCanvas=function($Lr,$Li,$Lt,$L_,$LA,$Lf){($Lt<=0||$L_<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),$Lt|=0,$L_|=0,$LA|=0,$Lf|=0;var $LE=$Lhr.create($Lt,$L_,6408,5121,0,!1);$LE.start(),$LE.clear(0,0,0,0),$Ly.context.clear(),$LC.renders[$Li]._fun($Lr,$Ly.context,$LA,$LCr.height-$L_+$Lf),$Ly.context.flush(),$LE.end();var $LG=$LE.getData(0,0,$Lt,$L_);if($LE.recycle(),$LG.byteLength==$Lt*$L_*4){var $LN=new $LIr;$LN._canvas=$Lv.createElement("canvas"),$LN.size($Lt,$L_);var $Lp=$LN._canvas.getContext("2d");$Lv.canvas.size($Lt,$L_);var $Lg=$Lv.context,$LR=$Lg.createImageData($Lt,$L_);return $LR.data.set(new Uint8ClampedArray($LG.buffer)),$LN._imgData=$LR,$Lg.putImageData($LR,0,0),$Lp.save(),$Lp.translate(0,$L_),$Lp.scale(1,-1),$Lp.drawImage($Lv.canvas.source,0,0),$Lp.restore(),$LN}console.log("drawToCanvas error: w:"+$Lt+",h:"+$L_+",datalen:"+$LG.byteLength)},$LD.createFilterAction=function($Lr){var $Li;switch($Lr){case 32:$Li=new $Ldr}return $Li},$LD.addTextureToAtlas=function($Lr){$Lr._uvID++,$LT._atlasRestore++,$Lr.bitmap.enableMerageInAtlas&&$LT.instance.addToAtlas($Lr)},$LD.getTexturePixels=function($Lr,$Li,$Lt,$L_,$LA){$Ly.context.ctx.clear();var $Lf=new $LU;$Lf.graphics.drawTexture($Lr,-$Li,-$Lt);var $LE=$Lhr.create($L_,$LA);$LE.start(),$LE.clear(0,0,0,0),$Lf.render($Ly.context,0,0),$Ly.context.ctx.flush(),$LE.end();for(var $LG=$LE.getData(0,0,$L_,$LA),$LN=[],$Lp=0,$Lg=$LA-1;0<=$Lg;$Lg--)for(var $LR=0;$LR<$L_;$LR++)$Lp=4*($Lg*$L_+$LR),$LN.push($LG[$Lp]),$LN.push($LG[$Lp+1]),$LN.push($LG[$Lp+2]),$LN.push($LG[$Lp+3]);return $LN},$LD.skinAniSprite=function(){return new $Lrr},$Lp.create=function($Lr,$Li){var $Lt=new $LIr;return $Lt._imgData=$Li,$Lt.flipY=!1,$Lt},$LH._filterStart=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Lr.getValue("bounds"),$LE=$Lhr.create($Lf.width,$Lf.height);if($LE.start(),$LE.clear(0,0,0,0),$Lr.addValue("src",$LE),$Lr.addValue("ScissorTest",$LCr.worldScissorTest),$LCr.worldScissorTest){var $LG=new $Ll;$LG.copyFrom($Lt.ctx._clipRect),$Lr.addValue("clipRect",$LG),$LCr.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},$LH._filterEnd=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Lr.getValue("bounds");$Lr.getValue("src").end();var $LE=$Lhr.create($Lf.width,$Lf.height);$LE.start(),$LE.clear(0,0,0,0),$Lr.addValue("out",$LE),$Li._set$P("_filterCache",$LE),$Li._set$P("_isHaveGlowFilter",$Lr.getValue("_isHaveGlowFilter"))},$LH._EndTarget=function($Lr,$Li){if($Lr.getValue("src").recycle(),$Lr.getValue("out").end(),$Lr.getValue("ScissorTest")){$LCr.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),$Li.ctx.save();var $Lt=$Lr.getValue("clipRect");$Li.ctx.clipRect($Lt.x,$Lt.y,$Lt.width,$Lt.height)}},$LH._useSrc=function($Lr){var $Li=$Lr.getValue("out");$Li.end(),($Li=$Lr.getValue("src")).start(),$Li.clear(0,0,0,0)},$LH._endSrc=function($Lr){$Lr.getValue("src").end()},$LH._useOut=function($Lr){var $Li=$Lr.getValue("src");$Li.end(),($Li=$Lr.getValue("out")).start(),$Li.clear(0,0,0,0)},$LH._endOut=function($Lr){$Lr.getValue("out").end()},$LH._recycleScope=function($Lr){$Lr.recycle()},$LH._filter=function($Lr,$Li,$Lt,$L_){var $LA=this._next;if($LA){var $Lf,$LE,$LG=$Lr.filters,$LN=$LG.length;if(1==$LN&&32==$LG[0].type)return $Li.ctx.save(),$Li.ctx.setFilters([$LG[0]]),$LA._fun.call($LA,$Lr,$Li,$Lt,$L_),void $Li.ctx.restore();var $Lp=$LGr.create(),$Lg=$Ld.TEMP,$LR=$Li.ctx._getTransformMatrix(),$LX=$Ls.create();$LR.copyTo($LX);var $Lv=0,$LO=0,$Lc=!1,$LB=$Lr._$P._filterCache?$Lr._$P._filterCache:null;if(!$LB||$Lr._repaint){$Lc=$Lr._isHaveGlowFilter(),$Lp.addValue("_isHaveGlowFilter",$Lc),$Lc&&($Lv=50,$LO=25),($LE=new $Ll).copyFrom($Lr.getSelfBounds()),$LE.x+=$Lr.x,$LE.y+=$Lr.y,$LE.x-=$Lr.pivotX+4,$LE.y-=$Lr.pivotY+4;var $Ly=$LE.x,$LC=$LE.y;if($LE.width+=$Lv+8,$LE.height+=$Lv+8,$Lg.x=$LE.x*$LX.a+$LE.y*$LX.c,$Lg.y=$LE.y*$LX.d+$LE.x*$LX.b,$LE.x=$Lg.x,$LE.y=$Lg.y,$Lg.x=$LE.width*$LX.a+$LE.height*$LX.c,$Lg.y=$LE.height*$LX.d+$LE.width*$LX.b,$LE.width=$Lg.x,$LE.height=$Lg.y,$LE.width<=0||$LE.height<=0)return;$LB&&$LB.recycle(),$Lp.addValue("bounds",$LE);var $Ln=$LEr.create([$Lp,$Lr,$Li,0,0],$LH._filterStart);$Li.addRenderObject($Ln),$Li.ctx._renderKey=0,$Li.ctx._shader2D.glTexture=null;var $La=$Lr.x-$Ly+$LO,$LD=$Lr.y-$LC+$LO;$LA._fun.call($LA,$Lr,$Li,$La,$LD),$Ln=$LEr.create([$Lp,$Lr,$Li,0,0],$LH._filterEnd),$Li.addRenderObject($Ln);for(var $Lu=0;$Lu<$LN;$Lu++){0!=$Lu&&($Ln=$LEr.create([$Lp],$LH._useSrc),$Li.addRenderObject($Ln),$Lf=$LHr.create(1,0),$Ls.TEMP.identity(),$Li.ctx.drawTarget($Lp,0,0,$LE.width,$LE.height,$Ls.TEMP,"out",$Lf,null,$L$.TOINT.overlay),$Ln=$LEr.create([$Lp],$LH._useOut),$Li.addRenderObject($Ln)),$LG[$Lu].action.apply3d($Lp,$Lr,$Li,0,0)}$Ln=$LEr.create([$Lp,$Li],$LH._EndTarget),$Li.addRenderObject($Ln)}else{if(($Lc=!!$Lr._$P._isHaveGlowFilter&&$Lr._$P._isHaveGlowFilter)&&($Lv=50,$LO=25),($LE=$Lr.getBounds()).width<=0||$LE.height<=0)return;$LE.width+=$Lv,$LE.height+=$Lv,$Lg.x=$LE.x*$LX.a+$LE.y*$LX.c,$Lg.y=$LE.y*$LX.d+$LE.x*$LX.b,$LE.x=$Lg.x,$LE.y=$Lg.y,$Lg.x=$LE.width*$LX.a+$LE.height*$LX.c,$Lg.y=$LE.height*$LX.d+$LE.width*$LX.b,$LE.width=$Lg.x,$LE.height=$Lg.y,$Lp.addValue("out",$LB)}$Lt=$Lt-$LO-$Lr.x,$L_=$L_-$LO-$Lr.y,$Lg.setTo($Lt,$L_),$LX.transformPoint($Lg),$Lt=$Lg.x+$LE.x,$L_=$Lg.y+$LE.y,$Lf=$LHr.create(1,0),$Ls.TEMP.identity(),$Li.ctx.drawTarget($Lp,$Lt,$L_,$LE.width,$LE.height,$Ls.TEMP,"out",$Lf,null,$L$.TOINT.overlay),$Ln=$LEr.create([$Lp],$LH._recycleScope),$Li.addRenderObject($Ln),$LX.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=$LE._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=$LE._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=$LE._uint8ArraySlice),!0},$LE.onStageResize=function($Lr,$Li){null!=$LE.mainContext&&($LE.mainContext.viewport(0,0,$Lr,$Li),$LCr.width=$Lr,$LCr.height=$Li)},$LE.onInvalidGLRes=function(){$LT.instance.freeAll(),$La.releaseContentManagers(!0),$LE.doNodeRepaint($Lu.stage),$LE.mainContext.viewport(0,0,$LCr.width,$LCr.height),$Lu.stage.event("devicelost")},$LE.doNodeRepaint=function($Lr){0==$Lr.numChildren&&$Lr.repaint();for(var $Li=0;$Li<$Lr.numChildren;$Li++)$LE.doNodeRepaint($Lr.getChildAt($Li))},$LE.init=function($Lr,$Li,$Lt){$LE.mainCanvas=$Lr,$Lp._createContext=function($Lr){return new $Lwr($Lr)},$LIr._createContext=function($Lr){return new $Lwr($Lr)};var $L_=laya.webgl.WebGL.mainContext;if(null!=$L_.getShaderPrecisionFormat){var $LA=$L_.getShaderPrecisionFormat(35633,36338),$Lf=$L_.getShaderPrecisionFormat(35632,36338);$LE.shaderHighPrecision=!(!$LA.precision||!$Lf.precision)}else $LE.shaderHighPrecision=!1;if($LE.compressAstc=$L_.getExtension("WEBGL_compressed_texture_astc"),$LE.compressAtc=$L_.getExtension("WEBGL_compressed_texture_atc"),$LE.compressEtc=$L_.getExtension("WEBGL_compressed_texture_etc"),$LE.compressEtc1=$L_.getExtension("WEBGL_compressed_texture_etc1"),$LE.compressPvrtc=$L_.getExtension("WEBGL_compressed_texture_pvrtc"),$LE.compressS3tc=$L_.getExtension("WEBGL_compressed_texture_s3tc"),$LE.compressS3tc_srgb=$L_.getExtension("WEBGL_compressed_texture_s3tc_srgb"),$LE.compressAstc=$LE.compressAstc?$LE.compressAstc:{},$LE.compressAtc=$LE.compressAtc?$LE.compressAtc:{},$LE.compressEtc=$LE.compressEtc?$LE.compressEtc:{},$LE.compressEtc1=$LE.compressEtc1?$LE.compressEtc1:{},$LE.compressPvrtc=$LE.compressPvrtc?$LE.compressPvrtc:{},$LE.compressS3tc=$LE.compressS3tc?$LE.compressS3tc:{},$LE.compressS3tc_srgb=$LE.compressS3tc_srgb?$LE.compressS3tc_srgb:{},$L_.deleteTexture1=$L_.deleteTexture,$L_.deleteTexture=function($Lr){$Lr==$LDr.curBindTexValue&&($LDr.curBindTexValue=null),$L_.deleteTexture1($Lr)},$LE.onStageResize($Li,$Lt),null==$LE.mainContext)throw new Error("webGL getContext err!");$LQ.__init__(),$LT.__init__(),$LUr.__init__(),$Lfr.__init__(),$Lwr.__init__(),$LHr.__init__(),$LY.__init__(),$LMr.__int__($L_),$L$._init_($L_),$Ly.isConchApp&&conch.setOnInvalidGLRes($LE.onInvalidGLRes)},$LE.mainCanvas=null,$LE.antialias=!0,$LE.shaderHighPrecision=!1,$LE._bg_null=[0,0,0,0],$LE}(),$LDr=function(){function $L_(){}return $LX($L_,"laya.webgl.WebGLContext"),$L_.UseProgram=function($Lr){return $L_._useProgram!==$Lr&&($Lar.mainContext.useProgram($Lr),$L_._useProgram=$Lr,!0)},$L_.setDepthTest=function($Lr,$Li){$Li!==$L_._depthTest&&(($L_._depthTest=$Li)?$Lr.enable(2929):$Lr.disable(2929))},$L_.setDepthMask=function($Lr,$Li){$Li!==$L_._depthMask&&($L_._depthMask=$Li,$Lr.depthMask($Li))},$L_.setDepthFunc=function($Lr,$Li){$Li!==$L_._depthFunc&&($L_._depthFunc=$Li,$Lr.depthFunc($Li))},$L_.setBlend=function($Lr,$Li){$Li!==$L_._blend&&(($L_._blend=$Li)?$Lr.enable(3042):$Lr.disable(3042))},$L_.setBlendFunc=function($Lr,$Li,$Lt){($Li!==$L_._sFactor||$Lt!==$L_._dFactor)&&($L_._sFactor=$Li,$L_._dFactor=$Lt,$Lr.blendFunc($Li,$Lt))},$L_.setCullFace=function($Lr,$Li){$Li!==$L_._cullFace&&(($L_._cullFace=$Li)?$Lr.enable(2884):$Lr.disable(2884))},$L_.setFrontFace=function($Lr,$Li){$Li!==$L_._frontFace&&($L_._frontFace=$Li,$Lr.frontFace($Li))},$L_.bindTexture=function($Lr,$Li,$Lt){$Lr.bindTexture($Li,$Lt),$L_.curBindTexTarget=$Li,$L_.curBindTexValue=$Lt},$L_.DEPTH_BUFFER_BIT=256,$L_.STENCIL_BUFFER_BIT=1024,$L_.COLOR_BUFFER_BIT=16384,$L_.POINTS=0,$L_.LINES=1,$L_.LINE_LOOP=2,$L_.LINE_STRIP=3,$L_.TRIANGLES=4,$L_.TRIANGLE_STRIP=5,$L_.TRIANGLE_FAN=6,$L_.ZERO=0,$L_.ONE=1,$L_.SRC_COLOR=768,$L_.ONE_MINUS_SRC_COLOR=769,$L_.SRC_ALPHA=770,$L_.ONE_MINUS_SRC_ALPHA=771,$L_.DST_ALPHA=772,$L_.ONE_MINUS_DST_ALPHA=773,$L_.DST_COLOR=774,$L_.ONE_MINUS_DST_COLOR=775,$L_.SRC_ALPHA_SATURATE=776,$L_.FUNC_ADD=32774,$L_.BLEND_EQUATION=32777,$L_.BLEND_EQUATION_RGB=32777,$L_.BLEND_EQUATION_ALPHA=34877,$L_.FUNC_SUBTRACT=32778,$L_.FUNC_REVERSE_SUBTRACT=32779,$L_.BLEND_DST_RGB=32968,$L_.BLEND_SRC_RGB=32969,$L_.BLEND_DST_ALPHA=32970,$L_.BLEND_SRC_ALPHA=32971,$L_.CONSTANT_COLOR=32769,$L_.ONE_MINUS_CONSTANT_COLOR=32770,$L_.CONSTANT_ALPHA=32771,$L_.ONE_MINUS_CONSTANT_ALPHA=32772,$L_.BLEND_COLOR=32773,$L_.ARRAY_BUFFER=34962,$L_.ELEMENT_ARRAY_BUFFER=34963,$L_.ARRAY_BUFFER_BINDING=34964,$L_.ELEMENT_ARRAY_BUFFER_BINDING=34965,$L_.STREAM_DRAW=35040,$L_.STATIC_DRAW=35044,$L_.DYNAMIC_DRAW=35048,$L_.BUFFER_SIZE=34660,$L_.BUFFER_USAGE=34661,$L_.CURRENT_VERTEX_ATTRIB=34342,$L_.FRONT=1028,$L_.BACK=1029,$L_.CULL_FACE=2884,$L_.FRONT_AND_BACK=1032,$L_.BLEND=3042,$L_.DITHER=3024,$L_.STENCIL_TEST=2960,$L_.DEPTH_TEST=2929,$L_.SCISSOR_TEST=3089,$L_.POLYGON_OFFSET_FILL=32823,$L_.SAMPLE_ALPHA_TO_COVERAGE=32926,$L_.SAMPLE_COVERAGE=32928,$L_.NO_ERROR=0,$L_.INVALID_ENUM=1280,$L_.INVALID_VALUE=1281,$L_.INVALID_OPERATION=1282,$L_.OUT_OF_MEMORY=1285,$L_.CW=2304,$L_.CCW=2305,$L_.LINE_WIDTH=2849,$L_.ALIASED_POINT_SIZE_RANGE=33901,$L_.ALIASED_LINE_WIDTH_RANGE=33902,$L_.CULL_FACE_MODE=2885,$L_.FRONT_FACE=2886,$L_.DEPTH_RANGE=2928,$L_.DEPTH_WRITEMASK=2930,$L_.DEPTH_CLEAR_VALUE=2931,$L_.DEPTH_FUNC=2932,$L_.STENCIL_CLEAR_VALUE=2961,$L_.STENCIL_FUNC=2962,$L_.STENCIL_FAIL=2964,$L_.STENCIL_PASS_DEPTH_FAIL=2965,$L_.STENCIL_PASS_DEPTH_PASS=2966,$L_.STENCIL_REF=2967,$L_.STENCIL_VALUE_MASK=2963,$L_.STENCIL_WRITEMASK=2968,$L_.STENCIL_BACK_FUNC=34816,$L_.STENCIL_BACK_FAIL=34817,$L_.STENCIL_BACK_PASS_DEPTH_FAIL=34818,$L_.STENCIL_BACK_PASS_DEPTH_PASS=34819,$L_.STENCIL_BACK_REF=36003,$L_.STENCIL_BACK_VALUE_MASK=36004,$L_.STENCIL_BACK_WRITEMASK=36005,$L_.VIEWPORT=2978,$L_.SCISSOR_BOX=3088,$L_.COLOR_CLEAR_VALUE=3106,$L_.COLOR_WRITEMASK=3107,$L_.UNPACK_ALIGNMENT=3317,$L_.PACK_ALIGNMENT=3333,$L_.MAX_TEXTURE_SIZE=3379,$L_.MAX_VIEWPORT_DIMS=3386,$L_.SUBPIXEL_BITS=3408,$L_.RED_BITS=3410,$L_.GREEN_BITS=3411,$L_.BLUE_BITS=3412,$L_.ALPHA_BITS=3413,$L_.DEPTH_BITS=3414,$L_.STENCIL_BITS=3415,$L_.POLYGON_OFFSET_UNITS=10752,$L_.POLYGON_OFFSET_FACTOR=32824,$L_.TEXTURE_BINDING_2D=32873,$L_.SAMPLE_BUFFERS=32936,$L_.SAMPLES=32937,$L_.SAMPLE_COVERAGE_VALUE=32938,$L_.SAMPLE_COVERAGE_INVERT=32939,$L_.NUM_COMPRESSED_TEXTURE_FORMATS=34466,$L_.COMPRESSED_TEXTURE_FORMATS=34467,$L_.DONT_CARE=4352,$L_.FASTEST=4353,$L_.NICEST=4354,$L_.GENERATE_MIPMAP_HINT=33170,$L_.BYTE=5120,$L_.UNSIGNED_BYTE=5121,$L_.SHORT=5122,$L_.UNSIGNED_SHORT=5123,$L_.INT=5124,$L_.UNSIGNED_INT=5125,$L_.FLOAT=5126,$L_.DEPTH_COMPONENT=6402,$L_.ALPHA=6406,$L_.RGB=6407,$L_.RGBA=6408,$L_.LUMINANCE=6409,$L_.LUMINANCE_ALPHA=6410,$L_.UNSIGNED_SHORT_4_4_4_4=32819,$L_.UNSIGNED_SHORT_5_5_5_1=32820,$L_.UNSIGNED_SHORT_5_6_5=33635,$L_.FRAGMENT_SHADER=35632,$L_.VERTEX_SHADER=35633,$L_.MAX_VERTEX_ATTRIBS=34921,$L_.MAX_VERTEX_UNIFORM_VECTORS=36347,$L_.MAX_VARYING_VECTORS=36348,$L_.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,$L_.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,$L_.MAX_TEXTURE_IMAGE_UNITS=34930,$L_.MAX_FRAGMENT_UNIFORM_VECTORS=36349,$L_.SHADER_TYPE=35663,$L_.DELETE_STATUS=35712,$L_.LINK_STATUS=35714,$L_.VALIDATE_STATUS=35715,$L_.ATTACHED_SHADERS=35717,$L_.ACTIVE_UNIFORMS=35718,$L_.ACTIVE_ATTRIBUTES=35721,$L_.SHADING_LANGUAGE_VERSION=35724,$L_.CURRENT_PROGRAM=35725,$L_.NEVER=512,$L_.LESS=513,$L_.EQUAL=514,$L_.LEQUAL=515,$L_.GREATER=516,$L_.NOTEQUAL=517,$L_.GEQUAL=518,$L_.ALWAYS=519,$L_.KEEP=7680,$L_.REPLACE=7681,$L_.INCR=7682,$L_.DECR=7683,$L_.INVERT=5386,$L_.INCR_WRAP=34055,$L_.DECR_WRAP=34056,$L_.VENDOR=7936,$L_.RENDERER=7937,$L_.VERSION=7938,$L_.NEAREST=9728,$L_.LINEAR=9729,$L_.NEAREST_MIPMAP_NEAREST=9984,$L_.LINEAR_MIPMAP_NEAREST=9985,$L_.NEAREST_MIPMAP_LINEAR=9986,$L_.LINEAR_MIPMAP_LINEAR=9987,$L_.TEXTURE_MAG_FILTER=10240,$L_.TEXTURE_MIN_FILTER=10241,$L_.TEXTURE_WRAP_S=10242,$L_.TEXTURE_WRAP_T=10243,$L_.TEXTURE_2D=3553,$L_.TEXTURE=5890,$L_.TEXTURE_CUBE_MAP=34067,$L_.TEXTURE_BINDING_CUBE_MAP=34068,$L_.TEXTURE_CUBE_MAP_POSITIVE_X=34069,$L_.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,$L_.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,$L_.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,$L_.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,$L_.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,$L_.MAX_CUBE_MAP_TEXTURE_SIZE=34076,$L_.TEXTURE0=33984,$L_.TEXTURE1=33985,$L_.TEXTURE2=33986,$L_.TEXTURE3=33987,$L_.TEXTURE4=33988,$L_.TEXTURE5=33989,$L_.TEXTURE6=33990,$L_.TEXTURE7=33991,$L_.TEXTURE8=33992,$L_.TEXTURE9=33993,$L_.TEXTURE10=33994,$L_.TEXTURE11=33995,$L_.TEXTURE12=33996,$L_.TEXTURE13=33997,$L_.TEXTURE14=33998,$L_.TEXTURE15=33999,$L_.TEXTURE16=34e3,$L_.TEXTURE17=34001,$L_.TEXTURE18=34002,$L_.TEXTURE19=34003,$L_.TEXTURE20=34004,$L_.TEXTURE21=34005,$L_.TEXTURE22=34006,$L_.TEXTURE23=34007,$L_.TEXTURE24=34008,$L_.TEXTURE25=34009,$L_.TEXTURE26=34010,$L_.TEXTURE27=34011,$L_.TEXTURE28=34012,$L_.TEXTURE29=34013,$L_.TEXTURE30=34014,$L_.TEXTURE31=34015,$L_.ACTIVE_TEXTURE=34016,$L_.REPEAT=10497,$L_.CLAMP_TO_EDGE=33071,$L_.MIRRORED_REPEAT=33648,$L_.FLOAT_VEC2=35664,$L_.FLOAT_VEC3=35665,$L_.FLOAT_VEC4=35666,$L_.INT_VEC2=35667,$L_.INT_VEC3=35668,$L_.INT_VEC4=35669,$L_.BOOL=35670,$L_.BOOL_VEC2=35671,$L_.BOOL_VEC3=35672,$L_.BOOL_VEC4=35673,$L_.FLOAT_MAT2=35674,$L_.FLOAT_MAT3=35675,$L_.FLOAT_MAT4=35676,$L_.SAMPLER_2D=35678,$L_.SAMPLER_CUBE=35680,$L_.VERTEX_ATTRIB_ARRAY_ENABLED=34338,$L_.VERTEX_ATTRIB_ARRAY_SIZE=34339,$L_.VERTEX_ATTRIB_ARRAY_STRIDE=34340,$L_.VERTEX_ATTRIB_ARRAY_TYPE=34341,$L_.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,$L_.VERTEX_ATTRIB_ARRAY_POINTER=34373,$L_.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,$L_.COMPILE_STATUS=35713,$L_.LOW_FLOAT=36336,$L_.MEDIUM_FLOAT=36337,$L_.HIGH_FLOAT=36338,$L_.LOW_INT=36339,$L_.MEDIUM_INT=36340,$L_.HIGH_INT=36341,$L_.FRAMEBUFFER=36160,$L_.RENDERBUFFER=36161,$L_.RGBA4=32854,$L_.RGB5_A1=32855,$L_.RGB565=36194,$L_.DEPTH_COMPONENT16=33189,$L_.STENCIL_INDEX=6401,$L_.STENCIL_INDEX8=36168,$L_.DEPTH_STENCIL=34041,$L_.RENDERBUFFER_WIDTH=36162,$L_.RENDERBUFFER_HEIGHT=36163,$L_.RENDERBUFFER_INTERNAL_FORMAT=36164,$L_.RENDERBUFFER_RED_SIZE=36176,$L_.RENDERBUFFER_GREEN_SIZE=36177,$L_.RENDERBUFFER_BLUE_SIZE=36178,$L_.RENDERBUFFER_ALPHA_SIZE=36179,$L_.RENDERBUFFER_DEPTH_SIZE=36180,$L_.RENDERBUFFER_STENCIL_SIZE=36181,$L_.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,$L_.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,$L_.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,$L_.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,$L_.COLOR_ATTACHMENT0=36064,$L_.DEPTH_ATTACHMENT=36096,$L_.STENCIL_ATTACHMENT=36128,$L_.DEPTH_STENCIL_ATTACHMENT=33306,$L_.NONE=0,$L_.FRAMEBUFFER_COMPLETE=36053,$L_.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,$L_.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,$L_.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,$L_.FRAMEBUFFER_UNSUPPORTED=36061,$L_.FRAMEBUFFER_BINDING=36006,$L_.RENDERBUFFER_BINDING=36007,$L_.MAX_RENDERBUFFER_SIZE=34024,$L_.INVALID_FRAMEBUFFER_OPERATION=1286,$L_.UNPACK_FLIP_Y_WEBGL=37440,$L_.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,$L_.CONTEXT_LOST_WEBGL=37442,$L_.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,$L_.BROWSER_DEFAULT_WEBGL=37444,$L_._useProgram=null,$L_._depthTest=!0,$L_._depthMask=!0,$L_._blend=!1,$L_._cullFace=!1,$L_.curBindTexTarget=null,$L_.curBindTexValue=null,$LE($L_,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),$L_}(),$Lur=function($Lr){function $Li(){$Li.__super.call(this)}$LX($Li,"laya.webgl.display.GraphicsGL",$LG);var $Lt=$Li.prototype;return $Lt.setShader=function($Lr){this._saveToCmd($Ly.context._setShader,[$Lr])},$Lt.setIBVB=function($Lr,$Li,$Lt,$L_,$LA,$Lf){this._saveToCmd($Ly.context._setIBVB,[$Lr,$Li,$Lt,$L_,$LA,$Lf])},$Lt.drawParticle=function($Lr,$Li,$Lt){var $L_=$LD.createParticleTemplate2D($Lt);$L_.x=$Lr,$L_.y=$Li,this._saveToCmd($Ly.context._drawParticle,[$L_])},$Li}(),$Lwr=function($Lr){var $Lt;function $Lm($Lr){this._x=0,this._y=0,this._id=++$Lm._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,$Lm.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=$Lm.MAXCLIPRECT,this.mOutPoint,this._canvas=$Lr,this._canvas._addReference(),$Lm._contextcount++,$Ly.isFlash?(this._ib=$LYr.create(35044),$LBr.fillIBQuadrangle(this._ib,16)):this._ib=$LYr.QuadrangleIB,this.clear()}$LX($Lm,"laya.webgl.canvas.WebGLContext2D",$LA);var $Li=$Lm.prototype;return $Li.setIsMainContext=function(){this._isMain=!0},$Li.clearBG=function($Lr,$Li,$Lt,$L_){var $LA=$Lar.mainContext;$LA.clearColor($Lr,$Li,$Lt,$L_),$LA.clear(16384)},$Li._getSubmits=function(){return this._submits},$Li._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var $Lr=0,$Li=this._submits._length;$Lr<$Li;$Lr++)this._submits[$Lr].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},$Li.destroy=function(){--$Lm._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=$LYr.QuadrangleIB&&this._ib.releaseResource()},$Li.clear=function(){this._submits||(this._other=$Lt.DEFAULT,this._curMat=$Ls.create(),this._vb=$Ljr.create(-1),this._submits=[],this._save=[$LW.Create(this)],this._save.length=10,this._shader2D=new $LY,this._triangleMesh=$Lbr.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=$Lt.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=$Lm.MAXCLIPRECT,this._curSubmit=$Lfr.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=$Lo.DEFAULT;for(var $Lr=0,$Li=this._submits._length;$Lr<$Li;$Lr++)this._submits[$Lr].releaseRender(),this._submits[$Lr]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},$Li.size=function($Lr,$Li){if(this._width!=$Lr||this._height!=$Li)if(0==$Lr||0==$Li){0!=this._vb._byteLength&&(this._width=$Lr,this._height=$Li,this._vb.clear(),this._vb.upload());for(var $Lt=0,$L_=this._submits._length;$Lt<$L_;$Lt++)this._submits[$Lt].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=$Lr,this._height=$Li,this._targets&&this._targets.size($Lr,$Li),this._canvas.memorySize-=this._canvas.memorySize;0===$Lr&&0===$Li&&this._releaseMem()},$Li._getTransformMatrix=function(){return this._curMat},$Li.translate=function($Lr,$Li){0===$Lr&&0===$Li||($LK.save(this),this._curMat.bTransform&&($LM.save(this),this._curMat.transformPointN($Ld.TEMP.setTo($Lr,$Li)),$Lr=$Ld.TEMP.x,$Li=$Ld.TEMP.y),this._x+=$Lr,this._y+=$Li)},$Li.save=function(){this._save[this._save._length++]=$LW.Create(this)},$Li.restore=function(){var $Lr=this._save._length;if(!($Lr<1))for(var $Li=$Lr-1;0<=$Li;$Li--){var $Lt=this._save[$Li];if($Lt.restore(this),$Lt.isSaveMark())return void(this._save._length=$Li)}},$Li._fillText=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){void 0===$Lp&&($Lp=0);var $Lg=this._shader2D,$LR=this._curSubmit.shaderValue,$LX=$LA?$LOr.create($LA):this._other.font;if($LT.enabled)$Lg.ALPHA!==$LR.ALPHA&&($Lg.glTexture=null),$Lvr.drawText(this,$Lr,$Li,this._curMat,$LX,$LN||this._other.textAlign,$Lf,$LE,$LG,$Lt,$L_,$Lp);else{this._shader2D.defines.getValue();var $Lv=$Lf?$LO.create($Lf)._color:$Lg.colorAdd;$Lg.ALPHA===$LR.ALPHA&&$Lv===$Lg.colorAdd&&$LR.colorAdd===$Lg.colorAdd||($Lg.glTexture=null,$Lg.colorAdd=$Lv),$Lvr.drawText(this,$Lr,$Li,this._curMat,$LX,$LN||this._other.textAlign,$Lf,$LE,$LG,$Lt,$L_,$Lp)}},$Li.fillWords=function($Lr,$Li,$Lt,$L_,$LA,$Lf){this._fillText(null,$Lr,$Li,$Lt,$L_,$LA,null,-1,null,$Lf)},$Li.fillBorderWords=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this._fillBorderText(null,$Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,null)},$Li.fillText=function($Lr,$Li,$Lt,$L_,$LA,$Lf){this._fillText($Lr,null,$Li,$Lt,$L_,$LA,null,-1,$Lf)},$Li.strokeText=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this._fillText($Lr,null,$Li,$Lt,$L_,null,$LA,$Lf||1,$LE)},$Li.fillBorderText=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){this._fillBorderText($Lr,null,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG)},$Li._fillBorderText=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){if(!$LT.enabled)return this._fillText($Lr,$Li,$Lt,$L_,$LA,null,$LE,$LG||1,$LN),void this._fillText($Lr,$Li,$Lt,$L_,$LA,$Lf,null,-1,$LN);var $Lp=this._shader2D,$Lg=this._curSubmit.shaderValue;$Lp.ALPHA!==$Lg.ALPHA&&($Lp.glTexture=null);var $LR=$LA?($Lm._fontTemp.setFont($LA),$Lm._fontTemp):this._other.font;$Lvr.drawText(this,$Lr,$Li,this._curMat,$LR,$LN||this._other.textAlign,$Lf,$LE,$LG||1,$Lt,$L_,0)},$Li.fillRect=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=this._vb;if($LBr.fillRectImgVb($Lf,this._clipRect,$Lr,$Li,$Lt,$L_,$Lb.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $LE=this._shader2D.fillStyle;$LA&&(this._shader2D.fillStyle=$Lo.create($LA));var $LG=this._shader2D,$LN=this._curSubmit.shaderValue;if($LG.fillStyle!==$LN.fillStyle||$LG.ALPHA!==$LN.ALPHA){$LG.glTexture=null;var $Lp=this._curSubmit=$Lfr.createSubmit(this,this._ib,$Lf,($Lf._byteLength-64)/32*3,$LHr.create(2,0));$Lp.shaderValue.color=$LG.fillStyle._color._color,$Lp.shaderValue.ALPHA=$LG.ALPHA,this._submits[this._submits._length++]=$Lp}this._curSubmit._numEle+=6,this._shader2D.fillStyle=$LE}},$Li.fillTexture=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){if($Lr.loaded&&$Lr.bitmap&&$Lr.source){var $LN=this._vb,$Lp=$Lr.bitmap.width,$Lg=$Lr.bitmap.height,$LR=$Lr.uv,$LX=$LE.x%$Lr.width,$Lv=$LE.y%$Lr.height;if($Lp!=$LG.w||$Lg!=$LG.h){if(!$LG.w&&!$LG.h)switch($LG.oy=$LG.ox=0,$Lf){case"repeat":$LG.width=$L_,$LG.height=$LA;break;case"repeat-x":$LG.width=$L_,$Lv<0?$Lr.height+$Lv>$LA?$LG.height=$LA:$LG.height=$Lr.height+$Lv:($LG.oy=$Lv,$Lr.height+$Lv>$LA?$LG.height=$LA-$Lv:$LG.height=$Lr.height);break;case"repeat-y":$LX<0?$Lr.width+$LX>$L_?$LG.width=$L_:$LG.width=$Lr.width+$LX:($LG.ox=$LX,$Lr.width+$LX>$L_?$LG.width=$L_-$LX:$LG.width=$Lr.width),$LG.height=$LA;break;case"no-repeat":$LX<0?$Lr.width+$LX>$L_?$LG.width=$L_:$LG.width=$Lr.width+$LX:($LG.ox=$LX,$Lr.width+$LX>$L_?$LG.width=$L_-$LX:$LG.width=$Lr.width),$Lv<0?$Lr.height+$Lv>$LA?$LG.height=$LA:$LG.height=$Lr.height+$Lv:($LG.oy=$Lv,$Lr.height+$Lv>$LA?$LG.height=$LA-$Lv:$LG.height=$Lr.height);break;default:$LG.width=$L_,$LG.height=$LA}$LG.w=$Lp,$LG.h=$Lg,$LG.uv=[0,0,$LG.width/$Lp,0,$LG.width/$Lp,$LG.height/$Lg,0,$LG.height/$Lg]}if($Li+=$LG.ox,$Lt+=$LG.oy,$LX-=$LG.ox,$Lv-=$LG.oy,$LBr.fillRectImgVb($LN,this._clipRect,$Li,$Lt,$LG.width,$LG.height,$LG.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $LO=$LFr.create(this,this._ib,$LN,($LN._byteLength-64)/32*3,$LHr.create(256,0)),$Lc=(this._submits[this._submits._length++]=$LO).shaderValue;$Lc.textureHost=$Lr;var $LB=$LR[0]*$Lp,$Ly=$LR[1]*$Lg,$LC=($LR[2]-$LR[0])*$Lp,$Ln=($LR[5]-$LR[3])*$Lg,$La=-$LX/$Lp,$LD=-$Lv/$Lg;$Lc.u_TexRange[0]=$LB/$Lp,$Lc.u_TexRange[1]=$LC/$Lp,$Lc.u_TexRange[2]=$Ly/$Lg,$Lc.u_TexRange[3]=$Ln/$Lg,$Lc.u_offset[0]=$La,$Lc.u_offset[1]=$LD,$LT.enabled&&!this._isMain&&$LO.addTexture($Lr,($LN._byteLength>>2)-16),(this._curSubmit=$LO)._renderType=10017,$LO._numEle+=6}}else this.sprite&&$Lu.timer.callLater(this,this._repaintSprite)},$Li.setShader=function($Lr){$Lz.save(this,1048576,this._shader2D,!0),this._shader2D.shader=$Lr},$Li.setFilters=function($Lr){$Lz.save(this,2097152,this._shader2D,!0),this._shader2D.filters=$Lr,this._curSubmit=$Lfr.RENDERBASE,this._renderKey=0,this._drawCount++},$Li.drawTexture=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this._drawTextureM($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,null,1)},$Li.addTextureVb=function($Lr,$Li,$Lt){var $L_=this._curSubmit._vb||this._vb,$LA=$L_._byteLength>>2;$L_.byteLength=$LA+16<<2;for(var $Lf=$L_.getFloat32Array(),$LE=0;$LE<16;$LE+=4)$Lf[$LA++]=$Lr[$LE]+$Li,$Lf[$LA++]=$Lr[$LE+1]+$Lt,$Lf[$LA++]=$Lr[$LE+2],$Lf[$LA++]=$Lr[$LE+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),$L_._upload=!0},$Li.willDrawTexture=function($Lr,$Li){if(!($Lr.loaded&&$Lr.bitmap&&$Lr.source))return this.sprite&&$Lu.timer.callLater(this,this._repaintSprite),0;var $Lt=$Lr.bitmap,$L_=$Lt.id+this._shader2D.ALPHA*$Li+10016;if($L_==this._renderKey)return $L_;var $LA=this._shader2D,$Lf=$LA.ALPHA,$LE=this._curSubmit.shaderValue;$LA.ALPHA*=$Li,this._renderKey=$L_,this._drawCount++,$LA.glTexture=$Lt;var $LG=this._vb,$LN=null,$Lp=$LG._byteLength/32*3,$Lg=$LE.textureHost&&$LE.textureHost==$Lr&&$LE.textureHost.alphaTexture==$Lr.alphaTexture;return $LN=$LFr.create(this,this._ib,$LG,$Lp,$LHr.create(1,0)),(this._submits[this._submits._length++]=$LN).shaderValue.textureHost=$Lr,$LN._renderType=10016,$LN._preIsSameTextureShader=10016===this._curSubmit._renderType&&$LA.ALPHA===$LE.ALPHA&&$Lg,this._curSubmit=$LN,$LA.ALPHA=$Lf,$L_},$Li.drawTextures=function($Lr,$Li,$Lt,$L_){if($Lr.loaded&&$Lr.bitmap&&$Lr.source){var $LA=this._clipRect;if(this._clipRect=$Lm.MAXCLIPRECT,this._drawTextureM($Lr,$Li[0],$Li[1],$Lr.width,$Lr.height,$Lt,$L_,null,1)){if(this._clipRect=$LA,$Le.drawCall++,!($Li.length<4)){for(var $Lf=this._curSubmit._vb||this._vb,$LE=this._curMat.a,$LG=this._curMat.d,$LN=2,$Lp=$Li.length;$LN<$Lp;$LN+=2)$LBr.copyPreImgVb($Lf,($Li[$LN]-$Li[$LN-2])*$LE,($Li[$LN+1]-$Li[$LN-1])*$LG),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&$Lu.timer.callLater(this,this._repaintSprite)},$Li._drawTextureM=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){if(!$Lr.loaded||!$Lr.source)return this.sprite&&$Lu.timer.callLater(this,this._repaintSprite),!1;var $Lp=this._curSubmit._vb||this._vb,$Lg=$Lr.bitmap;$Li+=$Lf,$Lt+=$LE,this._drawCount++;var $LR=$Lg.id+this._shader2D.ALPHA*$LN+10016;if($LR!=this._renderKey){this._renderKey=$LR;var $LX=this._curSubmit.shaderValue,$Lv=this._shader2D,$LO=$Lv.ALPHA;$Lv.ALPHA*=$LN,$Lv.glTexture=$Lg;var $Lc=this._vb,$LB=null,$Ly=$Lc._byteLength/32*3,$LC=$LX.textureHost&&$LX.textureHost==$Lr&&$LX.textureHost.alphaTexture==$Lr.alphaTexture;$LB=$LFr.create(this,this._ib,$Lc,$Ly,$LHr.create(1,0)),(this._submits[this._submits._length++]=$LB).shaderValue.textureHost=$Lr,$LB._renderType=10016,$LB._preIsSameTextureShader=10016===this._curSubmit._renderType&&$Lv.ALPHA===$LX.ALPHA&&$LC,this._curSubmit=$LB,$Lp=this._curSubmit._vb||this._vb,$Lv.ALPHA=$LO}return!!$LBr.fillRectImgVb($Lp,this._clipRect,$Li,$Lt,$L_||$Lr.width,$LA||$Lr.height,$Lr.uv,$LG||this._curMat,this._x,this._y,0,0)&&($LT.enabled&&!this._isMain&&this._curSubmit.addTexture($Lr,($Lp._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},$Li._repaintSprite=function(){this.sprite&&this.sprite.repaint()},$Li._drawText=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){var $Lg=$Lr.bitmap;this._drawCount++;var $LR=$Lg.id+this._shader2D.ALPHA+10016;if($LR!=this._renderKey){this._renderKey=$LR;var $LX=this._curSubmit.shaderValue,$Lv=this._shader2D;$Lv.glTexture=$Lg;var $LO=this._vb,$Lc=null,$LB=$LO._byteLength/32*3,$Ly=$LX.textureHost&&$LX.textureHost==$Lr&&$LX.textureHost.alphaTexture==$Lr.alphaTexture;($Lc=$LT.enabled?$LFr.create(this,this._ib,$LO,$LB,$LHr.create(1,0)):$LFr.create(this,this._ib,$LO,$LB,$LKr.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&$Lv.ALPHA===$LX.ALPHA&&$Ly,(this._submits[this._submits._length++]=$Lc).shaderValue.textureHost=$Lr,$Lc._renderType=10016,this._curSubmit=$Lc}$Lr.active();var $LC=this._curSubmit._vb||this._vb;$LBr.fillRectImgVb($LC,this._clipRect,$Li+$LE,$Lt+$LG,$L_||$Lr.width,$LA||$Lr.height,$Lr.uv,$Lf||this._curMat,this._x,this._y,$LN,$Lp,!0)&&($LT.enabled&&!this._isMain&&this._curSubmit.addTexture($Lr,($LC._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},$Li.drawTextureWithTransform=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){if($Lf){var $Lp=this._curMat,$Lg=this._x,$LR=this._y;(0!==$LE||0!==$LG)&&(this._x=$LE*$Lp.a+$LG*$Lp.c,this._y=$LG*$Lp.d+$LE*$Lp.b),$Lf&&$Lp.bTransform?($Ls.mul($Lf,$Lp,$Lm._tmpMatrix),($Lf=$Lm._tmpMatrix)._checkTransform()):(this._x+=$Lp.tx,this._y+=$Lp.ty),this._drawTextureM($Lr,$Li,$Lt,$L_,$LA,0,0,$Lf,$LN),this._x=$Lg,this._y=$LR}else this._drawTextureM($Lr,$Li,$Lt,$L_,$LA,$LE,$LG,null,$LN)},$Li.fillQuadrangle=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=this._curSubmit,$LE=this._vb,$LG=this._shader2D,$LN=$Lf.shaderValue;if(this._renderKey=0,$Lr.bitmap){var $Lp=$Lr.bitmap;$LG.glTexture==$Lp&&$LG.ALPHA===$LN.ALPHA||($LG.glTexture=$Lp,($Lf=this._curSubmit=$Lfr.createSubmit(this,this._ib,$LE,$LE._byteLength/32*3,$LHr.create(1,0))).shaderValue.glTexture=$Lp,this._submits[this._submits._length++]=$Lf),$LBr.fillQuadrangleImgVb($LE,$Li,$Lt,$L_,$Lr.uv,$LA||this._curMat,this._x,this._y)}else $Lf.shaderValue.fillStyle&&$Lf.shaderValue.fillStyle.equal($Lr)&&$LG.ALPHA===$LN.ALPHA||($LG.glTexture=null,($Lf=this._curSubmit=$Lfr.createSubmit(this,this._ib,$LE,$LE._byteLength/32*3,$LHr.create(2,0))).shaderValue.defines.add(2),$Lf.shaderValue.fillStyle=$Lo.create($Lr),this._submits[this._submits._length++]=$Lf),$LBr.fillQuadrangleImgVb($LE,$Li,$Lt,$L_,$Lb.DEF_UV,$LA||this._curMat,this._x,this._y);$Lf._numEle+=6},$Li.drawTexture2=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){if(0!=$Lf){var $LN=this._curMat;if(this._x=$Lr*$LN.a+$Li*$LN.c,this._y=$Li*$LN.d+$Lr*$LN.b,$LA&&($LA=$LN.bTransform||$LA.bTransform?($Ls.mul($LA,$LN,$Lm._tmpMatrix),$Lm._tmpMatrix):(this._x+=$LA.tx+$LN.tx,this._y+=$LA.ty+$LN.ty,$Ls.EMPTY)),1!==$Lf||$LE){var $Lp=this._shader2D.ALPHA,$Lg=this._nBlendType;this._shader2D.ALPHA=$Lf,$LE&&(this._nBlendType=$L$.TOINT($LE)),this._drawTextureM($LG[0],$LG[1]-$Lt,$LG[2]-$L_,$LG[3],$LG[4],0,0,$LA,1),this._shader2D.ALPHA=$Lp,this._nBlendType=$Lg}else this._drawTextureM($LG[0],$LG[1]-$Lt,$LG[2]-$L_,$LG[3],$LG[4],0,0,$LA,1);this._x=this._y=0}},$Li.drawCanvas=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Lr.context;if(this._renderKey=0,$Lf._targets)this._submits[this._submits._length++]=$LQr.create($Lf,0,null),this._curSubmit=$Lfr.RENDERBASE,$Lf._targets.drawTo(this,$Li,$Lt,$L_,$LA);else{var $LE=this._submits[this._submits._length++]=$LQr.create($Lf,this._shader2D.ALPHA,this._shader2D.filters),$LG=$L_/$Lr.width,$LN=$LA/$Lr.height,$Lp=$LE._matrix;this._curMat.copyTo($Lp),1!=$LG&&1!=$LN&&$Lp.scale($LG,$LN);var $Lg=$Lp.tx,$LR=$Lp.ty;$Lp.tx=$Lp.ty=0,$Lp.transformPoint($Ld.TEMP.setTo($Li,$Lt)),$Lp.translate($Ld.TEMP.x+$Lg,$Ld.TEMP.y+$LR),this._curSubmit=$Lfr.RENDERBASE}$Lw.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=$Lf._targets?"yellow":"green",this.strokeRect($Li-1,$Lt-1,$L_+2,$LA+2,1),this.strokeRect($Li,$Lt,$L_,$LA,1),this.restore())},$Li.drawTarget=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){void 0===$Lp&&($Lp=-1);var $Lg=this._vb;if($LBr.fillRectImgVb($Lg,this._clipRect,$Li,$Lt,$L_,$LA,$LN||$Lb.DEF_UV,$Lf||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var $LR=this._curSubmit=$LRr.create(this,this._ib,$Lg,($Lg._byteLength-64)/32*3,$LG,$LE);$LR.blendType=-1==$Lp?this._nBlendType:$Lp,$LR.scope=$Lr,this._submits[this._submits._length++]=$LR,this._curSubmit._numEle+=6}},$Li.mixRGBandAlpha=function($Lr){return this._mixRGBandAlpha($Lr,this._shader2D.ALPHA)},$Li._mixRGBandAlpha=function($Lr,$Li){var $Lt=(4278190080&$Lr)>>>24;return 0!=$Lt?$Lt*=$Li:$Lt=255*$Li,16777215&$Lr|$Lt<<24},$Li.drawTriangles=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){if(!$Lr.loaded||!$Lr.source)return this.sprite&&$Lu.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;$Lr.bitmap;var $Lg=this._mixRGBandAlpha(4294967295,$LG),$LR=($L_.length,$Lf.length);this._renderKey=-1;var $LX=this._curSubmit=$LFr.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,$LHr.create(1,0));return $LX.shaderValue.textureHost=$Lr,$LX._renderType=10016,this._submits[this._submits._length++]=$LX,$LE?($Lm._tmpMatrix.a=$LE.a,$Lm._tmpMatrix.b=$LE.b,$Lm._tmpMatrix.c=$LE.c,$Lm._tmpMatrix.d=$LE.d,$Lm._tmpMatrix.tx=$LE.tx+$Li,$Lm._tmpMatrix.ty=$LE.ty+$Lt,$Ls.mul($Lm._tmpMatrix,this._curMat,$Lm._tmpMatrix)):($Lm._tmpMatrix.a=this._curMat.a,$Lm._tmpMatrix.b=this._curMat.b,$Lm._tmpMatrix.c=this._curMat.c,$Lm._tmpMatrix.d=this._curMat.d,$Lm._tmpMatrix.tx=this._curMat.tx+$Li,$Lm._tmpMatrix.ty=this._curMat.ty+$Lt),this._triangleMesh.addData($L_,$LA,$Lf,$Lm._tmpMatrix,$Lg,this),this._curSubmit._numEle+=$LR,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},$Li.transform=function($Lr,$Li,$Lt,$L_,$LA,$Lf){$LM.save(this),$Ls.mul($Ls.TEMP.setTo($Lr,$Li,$Lt,$L_,$LA,$Lf),this._curMat,this._curMat),this._curMat._checkTransform()},$Li.setTransformByMatrix=function($Lr){$Lr.copyTo(this._curMat)},$Li.transformByMatrix=function($Lr){$LM.save(this),$Ls.mul($Lr,this._curMat,this._curMat),this._curMat._checkTransform()},$Li.rotate=function($Lr){$LM.save(this),this._curMat.rotateEx($Lr)},$Li.scale=function($Lr,$Li){$LM.save(this),this._curMat.scaleEx($Lr,$Li)},$Li.clipRect=function($Lr,$Li,$Lt,$L_){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var $LA=$Lgr.create(4);this.addRenderObject($LA);var $Lf=this._vb,$LE=$Lf._byteLength>>2;if($LBr.fillRectImgVb($Lf,null,$Lr,$Li,$Lt,$L_,$Lb.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var $LG=this._curSubmit=$Lfr.createSubmit(this,this._ib,$Lf,($Lf._byteLength-64)/32*3,$LHr.create(2,0));$LG.shaderValue.ALPHA=1,this._submits[this._submits._length++]=$LG,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var $LN=$Lgr.create(5);this.addRenderObject($LN);var $Lp=$Lf.getFloat32Array(),$Lg=Math.min(Math.min(Math.min($Lp[0+$LE],$Lp[4+$LE]),$Lp[8+$LE]),$Lp[12+$LE]),$LR=Math.max(Math.max(Math.max($Lp[0+$LE],$Lp[4+$LE]),$Lp[8+$LE]),$Lp[12+$LE]),$LX=Math.min(Math.min(Math.min($Lp[1+$LE],$Lp[5+$LE]),$Lp[9+$LE]),$Lp[13+$LE]),$Lv=Math.max(Math.max(Math.max($Lp[1+$LE],$Lp[5+$LE]),$Lp[9+$LE]),$Lp[13+$LE]);$LZ.save(this,$LN,$Lr,$Li,$Lt,$L_,$Lg,$LX,$LR-$Lg,$Lv-$LX),this._curSubmit=$Lfr.RENDERBASE}else{$Lt*=this._curMat.a,$L_*=this._curMat.d;var $LO=$Ld.TEMP;this._curMat.transformPoint($LO.setTo($Lr,$Li)),$Lt<0&&($LO.x=$LO.x+$Lt,$Lt=-$Lt),$L_<0&&($LO.y=$LO.y+$L_,$L_=-$L_),this._renderKey=0;var $Lc=this._curSubmit=$Lpr.create(this);(this._submits[this._submits._length++]=$Lc).submitIndex=this._submits._length,$Lc.submitLength=9999999,$LJ.save(this,$Lc);var $LB=this._clipRect,$Ly=$LB.x,$LC=$LB.y,$Ln=$LO.x+$Lt,$La=$LO.y+$L_;$Ly<$LO.x&&($LB.x=$LO.x),$LC<$LO.y&&($LB.y=$LO.y),$LB.width=Math.min($Ln,$Ly+$LB.width)-$LB.x,$LB.height=Math.min($La,$LC+$LB.height)-$LB.y,this._shader2D.glTexture=null,$Lc.clipRect.copyFrom($LB),this._curSubmit=$Lfr.RENDERBASE}},$Li.setIBVB=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg){if(void 0===$LN&&($LN=0),void 0===$Lp&&($Lp=0),void 0===$Lg&&($Lg=0),null===$Lt){if($Ly.isFlash){var $LR=$L_;$LR._selfIB||($LR._selfIB=$LYr.create(35044)),$LR._selfIB.clear(),$Lt=$LR._selfIB}else $Lt=this._ib;$LBr.expandIBQuadrangle($Lt,$L_._byteLength/(4*$L_.vertexStride*4))}if(!$LG||!$LE)throw Error("setIBVB must input:shader shaderValues");var $LX=$LNr.create(this,$L_,$Lt,$LA,$LE,$LG,$LN,$Lp,$Lg);$Lf||($Lf=$Ls.EMPTY),$Lf.translate($Lr,$Li),$Ls.mul($Lf,this._curMat,$LX._mat),$Lf.translate(-$Lr,-$Li),this._submits[this._submits._length++]=$LX,this._curSubmit=$Lfr.RENDERBASE,this._renderKey=0},$Li.addRenderObject=function($Lr){this._submits[this._submits._length++]=$Lr},$Li.fillTrangles=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=this._curSubmit,$LE=this._vb,$LG=this._shader2D,$LN=$Lf.shaderValue,$Lp=$L_.length>>4,$Lg=$Lr.bitmap;this._renderKey=0,$LG.glTexture==$Lg&&$LG.ALPHA===$LN.ALPHA||(($Lf=this._curSubmit=$Lfr.createSubmit(this,this._ib,$LE,$LE._byteLength/32*3,$LHr.create(1,0))).shaderValue.textureHost=$Lr,this._submits[this._submits._length++]=$Lf),$LBr.fillTranglesVB($LE,$Li,$Lt,$L_,$LA||this._curMat,this._x,this._y),$Lf._numEle+=6*$Lp},$Li.submitElement=function($Lr,$Li){var $Lt=this._submits;for($Li<0&&($Li=$Lt._length);$Lr<$Li;)$Lr+=$Lt[$Lr].renderSubmit()},$Li.finish=function(){$Lar.mainContext.finish()},$Li.flush=function(){var $Lr=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if($Lr>this._ib.bufferLength/12&&$LBr.expandIBQuadrangle(this._ib,$Lr),!this._isMain&&$LT.enabled&&$LT._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=$LT._atlasRestore;for(var $Li=this._submits,$Lt=0,$L_=$Li._length;$Lt<$L_;$Lt++){var $LA=$Li[$Lt];10016===$LA.getRenderType()&&$LA.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),$Lir.instance&&$Lir.getInstance().reset();var $Lf;for($Lt=0,$Lf=this.meshlist.length;$Lt<$Lf;$Lt++){var $LE=this.meshlist[$Lt];$LE.canReuse?$LE.releaseMesh():$LE.destroy()}return this.meshlist.length=0,this._curSubmit=$Lfr.RENDERBASE,this._renderKey=0,this._triangleMesh=$Lbr.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},$Li.setPathId=function($Lr){if(this.mId=$Lr,-1!=this.mId){this.mHaveKey=!1;var $Li=$Lh.getInstance();$Li.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,$Li.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},$Li.movePath=function($Lr,$Li){var $Lt=$Lr,$L_=$Li;$Lr=this._curMat.a*$Lt+this._curMat.c*$L_+this._curMat.tx,$Li=this._curMat.b*$Lt+this._curMat.d*$L_+this._curMat.ty,this.mX+=$Lr,this.mY+=$Li},$Li.beginPath=function(){var $Lr=this._getPath();$Lr.tempArray.length=0,$Lr.closePath=!1,this.mX=0,this.mY=0},$Li.closePath=function(){this._path.closePath=!0},$Li.fill=function($Lr){void 0===$Lr&&($Lr=!1);var $Li=this._getPath();this.drawPoly(0,0,$Li.tempArray,this.fillStyle._color.numColor,0,0,$Lr)},$Li.stroke=function(){var $Lr=this._getPath();if(0<this.lineWidth){if(-1==this.mId)$Lr.drawLine(0,0,$Lr.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var $Li=$Lh.getInstance().shapeLineDic[this.mId];$Li.rebuild($Lr.tempArray),$Lr.setGeomtry($Li)}else $Lh.getInstance().addLine(this.mId,$Lr.drawLine(0,0,$Lr.tempArray,this.lineWidth,this.strokeStyle._color.numColor));$Lr.update();var $Lt=[this.mX,this.mY],$L_=$Lfr.createShape(this,$Lr.ib,$Lr.vb,$Lr.count,$Lr.offset,$LHr.create(4,0));$L_.shaderValue.ALPHA=this._shader2D.ALPHA,$L_.shaderValue.u_pos=$Lt,$L_.shaderValue.u_mmat2=$LCr.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=$L_,this._renderKey=-1}},$Li.line=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=this._curSubmit,$LG=this._vb;if($LBr.fillLineVb($LG,this._clipRect,$Lr,$Li,$Lt,$L_,$LA,$Lf)){this._renderKey=0;var $LN=this._shader2D,$Lp=$LE.shaderValue;$LN.strokeStyle===$Lp.strokeStyle&&$LN.ALPHA===$Lp.ALPHA||($LN.glTexture=null,($LE=this._curSubmit=$Lfr.createSubmit(this,this._ib,$LG,($LG._byteLength-64)/32*3,$LHr.create(2,0))).shaderValue.strokeStyle=$LN.strokeStyle,$LE.shaderValue.mainID=2,$LE.shaderValue.ALPHA=$LN.ALPHA,this._submits[this._submits._length++]=$LE),$LE._numEle+=6}},$Li.moveTo=function($Lr,$Li,$Lt){void 0===$Lt&&($Lt=!0);var $L_=this._getPath();if($Lt){var $LA=$Lr,$Lf=$Li;$Lr=this._curMat.a*$LA+this._curMat.c*$Lf,$Li=this._curMat.b*$LA+this._curMat.d*$Lf}$L_.addPoint($Lr,$Li)},$Li.lineTo=function($Lr,$Li,$Lt){void 0===$Lt&&($Lt=!0);var $L_=this._getPath();if($Lt){var $LA=$Lr,$Lf=$Li;$Lr=this._curMat.a*$LA+this._curMat.c*$Lf,$Li=this._curMat.b*$LA+this._curMat.d*$Lf}$L_.addPoint($Lr,$Li)},$Li.drawCurves=function($Lr,$Li,$Lt){this.setPathId(-1),this.beginPath(),this.strokeStyle=$Lt[3],this.lineWidth=$Lt[4];var $L_=$Lt[2];$Lr+=$Lt[0],$Li+=$Lt[1],this.movePath($Lr,$Li),this.moveTo($L_[0],$L_[1]);for(var $LA=2,$Lf=$L_.length;$LA<$Lf;)this.quadraticCurveTo($L_[$LA++],$L_[$LA++],$L_[$LA++],$L_[$LA++]);this.stroke()},$Li.arcTo=function($Lr,$Li,$Lt,$L_,$LA){if(-1==this.mId||!this.mHaveKey){var $Lf=0,$LE=0,$LG=0,$LN=this._getPath();this._curMat.copyTo($Lm._tmpMatrix),$Lm._tmpMatrix.tx=$Lm._tmpMatrix.ty=0,$Lm._tempPoint.setTo($LN.getEndPointX(),$LN.getEndPointY()),$Lm._tmpMatrix.invertTransformPoint($Lm._tempPoint);var $Lp=$Lm._tempPoint.x-$Lr,$Lg=$Lm._tempPoint.y-$Li,$LR=Math.sqrt($Lp*$Lp+$Lg*$Lg);if(!($LR<=1e-6)){var $LX=$Lp/$LR,$Lv=$Lg/$LR,$LO=$Lt-$Lr,$Lc=$L_-$Li,$LB=$LO*$LO+$Lc*$Lc,$Ly=Math.sqrt($LB);if(!($Ly<=1e-6)){var $LC=$LO/$Ly,$Ln=$Lc/$Ly,$La=$LX+$LC,$LD=$Lv+$Ln,$Lu=Math.sqrt($La*$La+$LD*$LD);if(!($Lu<=1e-6)){var $Lw=$La/$Lu,$LH=$LD/$Lu,$Ls=Math.acos($Lw*$LX+$LH*$Lv),$Ld=Math.PI/2-$Ls,$Ll=($LR=$LA/Math.tan($Ld))*$LX+$Lr,$LU=$LR*$Lv+$Li,$Lk=Math.sqrt($LR*$LR+$LA*$LA),$Le=$Lr+$Lw*$Lk,$LL=$Li+$LH*$Lk,$LQ=0,$LF=0;if(0<=$LX*$Ln-$Lv*$LC){var $Lb=2*$Ld/$Lm.SEGNUM;$LQ=Math.sin($Lb),$LF=Math.cos($Lb)}else $Lb=2*-$Ld/$Lm.SEGNUM,$LQ=Math.sin($Lb),$LF=Math.cos($Lb);$LE=this._curMat.a*$Ll+this._curMat.c*$LU,$LG=this._curMat.b*$Ll+this._curMat.d*$LU,$LE==this._path.getEndPointX()&&$LG==this._path.getEndPointY()||$LN.addPoint($LE,$LG);var $LV=$Ll-$Le,$Lh=$LU-$LL;for($Lf=0;$Lf<$Lm.SEGNUM;$Lf++){var $LP=$LV*$LF+$Lh*$LQ,$Lq=-$LV*$LQ+$Lh*$LF;$LE=$LP+$Le,$LG=$Lq+$LL,$Lr=this._curMat.a*$LE+this._curMat.c*$LG,$LG=$Li=this._curMat.b*$LE+this._curMat.d*$LG,($LE=$Lr)==this._path.getEndPointX()&&$LG==this._path.getEndPointY()||$LN.addPoint($LE,$LG),$LV=$LP,$Lh=$Lq}}}}}},$Li.arc=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){if(void 0===$Lf&&($Lf=!1),void 0===$LE&&($LE=!0),-1!=this.mId){var $LG=$Lh.getInstance().shapeDic[this.mId];if($LG&&this.mHaveKey&&!$LG.needUpdate(this._curMat))return;$Li=$Lr=0}var $LN,$Lp=0,$Lg=0,$LR=0,$LX=0,$Lv=0,$LO=0,$Lc=0;if($Lg=$LA-$L_,$Lf)if(Math.abs($Lg)>=2*Math.PI)$Lg=2*-Math.PI;else for(;0<$Lg;)$Lg-=2*Math.PI;else if(Math.abs($Lg)>=2*Math.PI)$Lg=2*Math.PI;else for(;$Lg<0;)$Lg+=2*Math.PI;$LN=$Lg/($Lc=$Lt<101?Math.max(10,$Lg*$Lt/5):$Lt<201?Math.max(10,$Lg*$Lt/20):Math.max(10,$Lg*$Lt/40))/2,$LR=Math.abs(4/3*(1-Math.cos($LN))/Math.sin($LN)),$Lf&&($LR=-$LR);var $LB=this._getPath(),$Ly=NaN,$LC=NaN;for($LO=0;$LO<=$Lc;$LO++)$Lp=$L_+$Lg*($LO/$Lc),$LX=$Lr+Math.cos($Lp)*$Lt,$Lv=$Li+Math.sin($Lp)*$Lt,$LE&&($Ly=$LX,$LC=$Lv,$LX=this._curMat.a*$Ly+this._curMat.c*$LC,$Lv=this._curMat.b*$Ly+this._curMat.d*$LC),$LX==this._path.getEndPointX()&&$Lv==this._path.getEndPointY()||$LB.addPoint($LX,$Lv);$LX=$Lr+Math.cos($LA)*$Lt,$Lv=$Li+Math.sin($LA)*$Lt,$LE&&($Ly=$LX,$LC=$Lv,$LX=this._curMat.a*$Ly+this._curMat.c*$LC,$Lv=this._curMat.b*$Ly+this._curMat.d*$LC),$LX==this._path.getEndPointX()&&$Lv==this._path.getEndPointY()||$LB.addPoint($LX,$Lv)},$Li.quadraticCurveTo=function($Lr,$Li,$Lt,$L_){var $LA=$LR.I,$Lf=$Lt,$LE=$L_;$Lt=this._curMat.a*$Lf+this._curMat.c*$LE,$L_=this._curMat.b*$Lf+this._curMat.d*$LE,$Lf=$Lr,$LE=$Li,$Lr=this._curMat.a*$Lf+this._curMat.c*$LE,$Li=this._curMat.b*$Lf+this._curMat.d*$LE;for(var $LG=$LA.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),$Lr,$Li,$Lt,$L_],30,2),$LN=0,$Lp=$LG.length/2;$LN<$Lp;$LN++)this.lineTo($LG[2*$LN],$LG[2*$LN+1],!1);this.lineTo($Lt,$L_,!1)},$Li.rect=function($Lr,$Li,$Lt,$L_){this._other=this._other.make(),this._other.path||(this._other.path=new $LI),this._other.path.rect($Lr,$Li,$Lt,$L_)},$Li.strokeRect=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=.5*$LA;this.line($Lr-$Lf,$Li,$Lr+$Lt+$Lf,$Li,$LA,this._curMat),this.line($Lr+$Lt,$Li,$Lr+$Lt,$Li+$L_,$LA,this._curMat),this.line($Lr,$Li,$Lr,$Li+$L_,$LA,this._curMat),this.line($Lr-$Lf,$Li+$L_,$Lr+$Lt+$Lf,$Li+$L_,$LA,this._curMat)},$Li.clip=function(){},$Li.drawPoly=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){void 0===$LE&&($LE=!1),this._renderKey=0,this._shader2D.glTexture=null;var $LG=this._getPath();if(-1==this.mId)$LG.polygon($Lr,$Li,$Lt,$L_,$LA||1,$Lf);else if(this.mHaveKey){var $LN=$Lh.getInstance().shapeDic[this.mId];$LN.setMatrix(this._curMat),$LN.rebuild($LG.tempArray),$LG.setGeomtry($LN)}else{var $Lp=$LG.polygon($Lr,$Li,$Lt,$L_,$LA||1,$Lf);$Lh.getInstance().addShape(this.mId,$Lp),$Lp.setMatrix(this._curMat)}$LG.update();var $Lg,$LR=[this.mX,this.mY];if(($Lg=$Lfr.createShape(this,$LG.ib,$LG.vb,$LG.count,$LG.offset,$LHr.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$Lg.shaderValue.u_pos=$LR,$Lg.shaderValue.u_mmat2=$LCr.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$Lg,0<$LA){if(this.mHaveLineKey){var $LX=$Lh.getInstance().shapeLineDic[this.mId];$LX.rebuild($LG.tempArray),$LG.setGeomtry($LX)}else $Lh.getInstance().addShape(this.mId,$LG.drawLine($Lr,$Li,$Lt,$LA,$Lf));$LG.update(),($Lg=$Lfr.createShape(this,$LG.ib,$LG.vb,$LG.count,$LG.offset,$LHr.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$Lg.shaderValue.u_mmat2=$LCr.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$Lg}},$Li.drawParticle=function($Lr,$Li,$Lt){$Lt.x=$Lr,$Lt.y=$Li,this._submits[this._submits._length++]=$Lt},$Li._getPath=function(){return this._path||(this._path=new $LI)},$L_(0,$Li,"globalCompositeOperation",function(){return $L$.NAMES[this._nBlendType]},function($Lr){var $Li=$L$.TOINT[$Lr];null==$Li||this._nBlendType===$Li||($Lz.save(this,65536,this,!0),this._curSubmit=$Lfr.RENDERBASE,this._renderKey=0,this._nBlendType=$Li)}),$L_(0,$Li,"strokeStyle",function(){return this._shader2D.strokeStyle},function($Lr){this._shader2D.strokeStyle.equal($Lr)||($Lz.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=$Lo.create($Lr))}),$L_(0,$Li,"globalAlpha",function(){return this._shader2D.ALPHA},function($Lr){($Lr=Math.floor(1e3*$Lr)/1e3)!=this._shader2D.ALPHA&&($Lz.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=$Lr)}),$L_(0,$Li,"asBitmap",null,function($Lr){if($Lr){if(this._targets||(this._targets=new $LS),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),$L_(0,$Li,"fillStyle",function(){return this._shader2D.fillStyle},function($Lr){this._shader2D.fillStyle.equal($Lr)||($Lz.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=$Lo.create($Lr))}),$L_(0,$Li,"textAlign",function(){return this._other.textAlign},function($Lr){this._other.textAlign===$Lr||(this._other=this._other.make(),$Lz.save(this,32768,this._other,!1),this._other.textAlign=$Lr)}),$L_(0,$Li,"lineWidth",function(){return this._other.lineWidth},function($Lr){this._other.lineWidth===$Lr||(this._other=this._other.make(),$Lz.save(this,256,this._other,!1),this._other.lineWidth=$Lr)}),$L_(0,$Li,"textBaseline",function(){return this._other.textBaseline},function($Lr){this._other.textBaseline===$Lr||(this._other=this._other.make(),$Lz.save(this,16384,this._other,!1),this._other.textBaseline=$Lr)}),$L_(0,$Li,"font",null,function($Lr){$Lr!=this._other.font.toString()&&(this._other=this._other.make(),$Lz.save(this,8,this._other,!1),this._other.font===$LOr.EMPTY?this._other.font=new $LOr($Lr):this._other.font.setFont($Lr))}),$Lm.__init__=function(){$Lt.DEFAULT=new $Lt},$Lm._tempPoint=new $Ld,$Lm._SUBMITVBSIZE=32e3,$Lm._MAXSIZE=99999999,$Lm._RECTVBSIZE=16,$Lm.MAXCLIPRECT=new $Ll(0,0,99999999,99999999),$Lm._COUNT=0,$Lm._tmpMatrix=new $Ls,$Lm.SEGNUM=32,$Lm._contextcount=0,$LE($Lm,["_fontTemp",function(){return this._fontTemp=new $LOr},"_drawStyleTemp",function(){return this._drawStyleTemp=new $Lo(null)}]),$Lm.__init$=function(){$Lt=function(){function $Lr(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=$LOr.EMPTY}$LX($Lr,"");var $Li=$Lr.prototype;return $Li.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=$LOr.EMPTY},$Li.make=function(){return this===$Lr.DEFAULT?new $Lr:this},$Lr.DEFAULT=null,$Lr}()},$Lm}(),$LHr=function($Lr){function $L_($Lr,$Li){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,$L_.__super.call(this),this.defines=new $LUr,this.position=$L_._POSITION,this.mainID=$Lr,this.subID=$Li,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=$Lr|$Li,this._inClassCache=$L_._cache[this._cacheID],0<$Lr&&!this._inClassCache&&(this._inClassCache=$L_._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}$LX($L_,"laya.webgl.shader.d2.value.Value2D",$Lq);var $Li=$L_.prototype;return $Li.setValue=function($Lr){},$Li.refresh=function(){var $Lr=this.size;return $Lr[0]=$LCr.width,$Lr[1]=$LCr.height,this.alpha=this.ALPHA*$LCr.worldAlpha,this.mmat=$LCr.worldMatrix4,this},$Li._ShaderWithCompile=function(){return $LWr.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,$LSr.create)},$Li._withWorldShaderDefines=function(){var $Lr=$LCr.worldShaderDefines,$Li=$LWr.sharders[this.mainID|this.defines._value|$Lr.getValue()];if(!$Li){var $Lt,$L_={};for($Lt in this.defines.toNameDic())$L_[$Lt]="";for($Lt in $Lr.toNameDic())$L_[$Lt]="";$Li=$LWr.withCompile2D(0,this.mainID,$L_,this.mainID|this.defines._value|$Lr.getValue(),$LSr.create)}var $LA=$LCr.worldFilters;if(!$LA)return $Li;for(var $Lf,$LE=$LA.length,$LG=0;$LG<$LE;$LG++)($Lf=$LA[$LG])&&$Lf.action.setValue(this);return $Li},$Li.upload=function(){var $Lr=$LCr;this.alpha=this.ALPHA*$Lr.worldAlpha,$LCr.worldMatrix4!==$LCr.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),$Lar.shaderHighPrecision&&this.defines.add(1024);var $Li,$Lt=$Lr.worldShaderDefines?this._withWorldShaderDefines():$LWr.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=$Lr.width,this.size[1]=$Lr.height,this.mmat=$Lr.worldMatrix4,$LVr.activeShader!==$Lt?$Lt._shaderValueWidth!==$Lr.width||$Lt._shaderValueHeight!==$Lr.height?($Lt._shaderValueWidth=$Lr.width,$Lt._shaderValueHeight=$Lr.height):$Li=$Lt._params2dQuick2||$Lt._make2dQuick2():$Lt._shaderValueWidth!==$Lr.width||$Lt._shaderValueHeight!==$Lr.height?($Lt._shaderValueWidth=$Lr.width,$Lt._shaderValueHeight=$Lr.height):$Li=$Lt._params2dQuick1||$Lt._make2dQuick1(),$Lt.upload(this,$Li)},$Li.setFilters=function($Lr){if(this.filters=$Lr)for(var $Li,$Lt=$Lr.length,$L_=0;$L_<$Lt;$L_++)($Li=$Lr[$L_])&&(this.defines.add($Li.type),$Li.action.setValue(this))},$Li.clear=function(){this.defines.setValue(this.subID)},$Li.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},$L_._initone=function($Lr,$Li){$L_._typeClass[$Lr]=$Li,$L_._cache[$Lr]=[],$L_._cache[$Lr]._length=0},$L_.__init__=function(){$L_._POSITION=[2,5126,!1,4*$Lcr.BYTES_PE,0],$L_._TEXCOORD=[2,5126,!1,4*$Lcr.BYTES_PE,2*$Lcr.BYTES_PE],$L_._initone(2,$Lmr),$L_._initone(4,$L$r),$L_._initone(256,$LTr),$L_._initone(512,$Lqr),$L_._initone(1,$Lxr),$L_._initone(65,$LKr),$L_._initone(9,$Lxr)},$L_.create=function($Lr,$Li){var $Lt=$L_._cache[$Lr|$Li];return $Lt._length?$Lt[--$Lt._length]:new $L_._typeClass[$Lr|$Li]($Li)},$L_._POSITION=null,$L_._TEXCOORD=null,$L_._cache=[],$L_._typeClass=[],$L_.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$L_}(),$Lsr=function($Lr){function $LB($Lr,$Li){$LB.__super.call(this,$Lr,$Li)}$LX($LB,"laya.webgl.utils.RenderSprite3D",$LC);var $Li=$LB.prototype;return $Li.onCreate=function($Lr){switch($Lr){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},$Li._mask=function($Lr,$Li,$Lt,$L_){var $LA,$Lf,$LE=this._next,$LG=$Lr.mask;if($LG){$Li.ctx.save();var $LN=$Li.ctx.globalCompositeOperation,$Lp=new $Ll;if($Lp.copyFrom($LG.getBounds()),$Lp.width=Math.round($Lp.width),$Lp.height=Math.round($Lp.height),$Lp.x=Math.round($Lp.x),$Lp.y=Math.round($Lp.y),0<$Lp.width&&0<$Lp.height){var $Lg=$Lr._style._tf,$LR=$LGr.create();$LR.addValue("bounds",$Lp),$LA=$LEr.create([$LR,$Li],laya.webgl.utils.RenderSprite3D.tmpTarget),$Li.addRenderObject($LA),$LG.render($Li,-$Lp.x,-$Lp.y),$LA=$LEr.create([$LR],laya.webgl.utils.RenderSprite3D.endTmpTarget),$Li.addRenderObject($LA),$Li.ctx.save(),$Li.clipRect($Lt-$Lg.translateX+$Lp.x,$L_-$Lg.translateY+$Lp.y,$Lp.width,$Lp.height),$LE._fun.call($LE,$Lr,$Li,$Lt,$L_),$Li.ctx.restore(),$Lf=$Lgr.create(6),$LN=$Li.ctx.globalCompositeOperation,$Lf.blendMode="mask",$Li.addRenderObject($Lf),$Ls.TEMP.identity();var $LX=$LHr.create(1,0),$Lv=$Lb.INV_UV,$LO=$Lp.width,$Lc=$Lp.height;($Lp.width<32||$Lp.height<32)&&(($Lv=$LB.tempUV)[0]=0,$Lv[1]=0,$Lv[2]=32<=$Lp.width?1:$Lp.width/32,$Lv[3]=0,$Lv[4]=32<=$Lp.width?1:$Lp.width/32,$Lv[5]=32<=$Lp.height?1:$Lp.height/32,$Lv[6]=0,$Lv[7]=32<=$Lp.height?1:$Lp.height/32,$Lp.width=32<=$Lp.width?$Lp.width:32,$Lp.height=32<=$Lp.height?$Lp.height:32,$Lv[1]*=-1,$Lv[3]*=-1,$Lv[5]*=-1,$Lv[7]*=-1,$Lv[1]+=1,$Lv[3]+=1,$Lv[5]+=1,$Lv[7]+=1),$Li.ctx.drawTarget($LR,$Lt+$Lp.x-$Lg.translateX,$L_+$Lp.y-$Lg.translateY,$LO,$Lc,$Ls.TEMP,"tmpTarget",$LX,$Lv,6),$LA=$LEr.create([$LR],laya.webgl.utils.RenderSprite3D.recycleTarget),$Li.addRenderObject($LA),($Lf=$Lgr.create(6)).blendMode=$LN,$Li.addRenderObject($Lf)}$Li.ctx.restore()}else $LE._fun.call($LE,$Lr,$Li,$Lt,$L_)},$Li._blend=function($Lr,$Li,$Lt,$L_){var $LA=$Lr._style,$Lf=this._next;$LA.blendMode?($Li.ctx.save(),$Li.ctx.globalCompositeOperation=$LA.blendMode,$Lf._fun.call($Lf,$Lr,$Li,$Lt,$L_),$Li.ctx.restore()):$Lf._fun.call($Lf,$Lr,$Li,$Lt,$L_)},$Li._transform=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.transform,$Lf=this._next;if($LA&&$Lf!=$LC.NORENDER){var $LE=$Li.ctx;$Lr._style;$LA.tx=$Lt,$LA.ty=$L_;var $LG=$LE._getTransformMatrix(),$LN=$LG.clone();$Ls.mul($LA,$LG,$LG),$LG._checkTransform(),$LA.tx=$LA.ty=0,$Lf._fun.call($Lf,$Lr,$Li,0,0),$LN.copyTo($LG),$LN.destroy()}else $Lf._fun.call($Lf,$Lr,$Li,$Lt,$L_)},$LB.tmpTarget=function($Lr,$Li){var $Lt=$Lr.getValue("bounds"),$L_=$Lhr.create($Lt.width,$Lt.height);$L_.start(),$L_.clear(0,0,0,0),$Lr.addValue("tmpTarget",$L_)},$LB.endTmpTarget=function($Lr){$Lr.getValue("tmpTarget").end()},$LB.recycleTarget=function($Lr){$Lr.getValue("tmpTarget").recycle(),$Lr.recycle()},$LE($LB,["tempUV",function(){return this.tempUV=new Array(8)}]),$LB}(),$Ldr=function($Lr){function $Li(){this.data=null,$Li.__super.call(this)}$LX($Li,"laya.filters.webgl.ColorFilterActionGL",$LP);var $Lt=$Li.prototype;return $Lu.imps($Lt,{"laya.filters.IFilterActionGL":!0}),$Lt.setValue=function($Lr){$Lr.colorMat=this.data._mat,$Lr.colorAlpha=this.data._alpha},$Lt.apply3d=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Lr.getValue("bounds"),$LE=$LHr.create(1,0);$LE.setFilters([this.data]);var $LG=$Ls.TEMP;$LG.identity(),$Lt.ctx.drawTarget($Lr,0,0,$Lf.width,$Lf.height,$LG,"src",$LE)},$Li}(),$Llr=function($Lr){function $Lf($Lr,$Li,$Lt,$L_,$LA){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,$Lf.__super.call(this,$Lr,$Li,$LA),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new $Lor,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=$Lt,this._atlasCanvas.height=$L_,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}$LX($Lf,"laya.webgl.atlas.Atlaser",$Lm);var $Li=$Lf.prototype;return $Li.computeUVinAtlasTexture=function($Lr,$Li,$Lt,$L_){var $LA=$LT.atlasTextureWidth,$Lf=$LT.atlasTextureHeight,$LE=$Lt/$LA,$LG=$L_/$Lf,$LN=($Lt+$Lr.bitmap.width)/$LA,$Lp=($L_+$Lr.bitmap.height)/$Lf,$Lg=$Lr.bitmap.width/$LA,$LR=$Lr.bitmap.height/$Lf;$Lr.uv=[$LE+$Li[0]*$Lg,$LG+$Li[1]*$LR,$LN-(1-$Li[2])*$Lg,$LG+$Li[3]*$LR,$LN-(1-$Li[4])*$Lg,$Lp-(1-$Li[5])*$LR,$LE+$Li[6]*$Lg,$Lp-(1-$Li[7])*$LR]},$Li.findBitmapIsExist=function($Lr){if($Lr instanceof laya.webgl.resource.WebGLImage){var $Li=$Lr,$Lt=$Li.url,$L_=this._InAtlasWebGLImagesKey[$Lt||$Li.id];if($L_)return $L_.offsetInfoID}return-1},$Li.addToAtlasTexture=function($Lr,$Li,$Lt){if($Lr instanceof laya.webgl.resource.WebGLImage){var $L_=$Lr,$LA=$L_.url;this._InAtlasWebGLImagesKey[$LA||$L_.id]={bitmap:$Lr,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([$Li,$Lt])}this._atlasCanvas.texSubImage2D($Li,$Lt,$Lr.atlasSource),$Lr.clearAtlasSource()},$Li.addToAtlas=function($Lr,$Li,$Lt){$Lr._atlasID=this._inAtlasTextureKey.length;var $L_=$Lr.uv.slice(),$LA=$Lr.bitmap;this._inAtlasTextureKey.push($Lr),this._inAtlasTextureOriUVValue.push($L_),this._inAtlasTextureBitmapValue.push($LA),this.computeUVinAtlasTexture($Lr,$L_,$Li,$Lt),$Lr.bitmap=this._atlasCanvas},$Li.clear=function(){for(var $Lr=0,$Li=this._inAtlasTextureKey.length;$Lr<$Li;$Lr++)this._inAtlasTextureKey[$Lr].bitmap=this._inAtlasTextureBitmapValue[$Lr],this._inAtlasTextureKey[$Lr].uv=this._inAtlasTextureOriUVValue[$Lr],this._inAtlasTextureKey[$Lr]._atlasID=-1,this._inAtlasTextureKey[$Lr].bitmap.lock=!1,this._inAtlasTextureKey[$Lr].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},$Li.dispose=function(){this.clear(),this._atlasCanvas.destroy()},$L_(0,$Li,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),$L_(0,$Li,"texture",function(){return this._atlasCanvas}),$L_(0,$Li,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),$Lf}(),$LUr=function($Lr){function $Lt(){$Lt.__super.call(this,$Lt.__name2int,$Lt.__int2name,$Lt.__int2nameMap)}return $LX($Lt,"laya.webgl.shader.d2.ShaderDefines2D",$Lj),$Lt.__init__=function(){$Lt.reg("TEXTURE2D",1),$Lt.reg("COLOR2D",2),$Lt.reg("PRIMITIVE",4),$Lt.reg("GLOW_FILTER",8),$Lt.reg("BLUR_FILTER",16),$Lt.reg("COLOR_FILTER",32),$Lt.reg("COLOR_ADD",64),$Lt.reg("WORLDMAT",128),$Lt.reg("FILLTEXTURE",256),$Lt.reg("FSHIGHPRECISION",1024),$Lt.reg("TXTALPHA",2048),$Lt.reg("TXTCOMPRESS",4096)},$Lt.reg=function($Lr,$Li){$Lj._reg($Lr,$Li,$Lt.__name2int,$Lt.__int2name)},$Lt.toText=function($Lr,$Li,$Lt){return $Lj._toText($Lr,$Li,$Lt)},$Lt.toInt=function($Lr){return $Lj._toInt($Lr,$Lt.__name2int)},$Lt.TEXTURE2D=1,$Lt.COLOR2D=2,$Lt.PRIMITIVE=4,$Lt.FILTERGLOW=8,$Lt.FILTERBLUR=16,$Lt.FILTERCOLOR=32,$Lt.COLORADD=64,$Lt.WORLDMAT=128,$Lt.FILLTEXTURE=256,$Lt.SKINMESH=512,$Lt.SHADERDEFINE_FSHIGHPRECISION=1024,$Lt.TXTALPHA=2048,$Lt.TXTCOMPRESS=4096,$Lt.__name2int={},$Lt.__int2name=[],$Lt.__int2nameMap=[],$Lt}(),$Lkr=(function($Lr){function $LG($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){$LG.__super.call(this,$Lr,$Li,$Lt,$L_,40,$LA,$Lf,$LE)}$LX($LG,"laya.webgl.shapes.Ellipse",$Ltr)}(),function($Lr){function $Lf($Lr,$Li,$Lt,$L_,$LA){this._points=[],this.rebuild($Lt),$Lf.__super.call(this,$Lr,$Li,0,0,0,$LA,$L_,$LA,0)}$LX($Lf,"laya.webgl.shapes.Line",$Ltr);var $Li=$Lf.prototype;return $Li.rebuild=function($Lr){var $Li=$Lr.length;$Li!=this._points.length&&(this.mUint16Array=new Uint16Array(6*($Li/2-1)),this.mFloat32Array=new Float32Array(5*$Li)),this._points.length=0;for(var $Lt=NaN,$L_=NaN,$LA=-1,$Lf=-1,$LE=$Lr.length/2,$LG=0;$LG<$LE;$LG++)$Lt=$Lr[2*$LG],$L_=$Lr[2*$LG+1],(.01<Math.abs($LA-$Lt)||.01<Math.abs($Lf-$L_))&&this._points.push($Lt,$L_),$LA=$Lt,$Lf=$L_},$Li.getData=function($Lr,$Li,$Lt){var $L_=[],$LA=[];0<this.borderWidth&&this.createLine2(this._points,$L_,this.borderWidth,$Lt,$LA,this._points.length/2),this.mUint16Array.set($L_,0),this.mFloat32Array.set($LA,0),$Lr.append(this.mUint16Array),$Li.append(this.mFloat32Array)},$Lf}()),$Ler=function($Lr){function $LR($Lr,$Li,$Lt,$L_,$LA){this._points=[];for(var $Lf=NaN,$LE=NaN,$LG=-1,$LN=-1,$Lp=$Lt.length/2-1,$Lg=0;$Lg<$Lp;$Lg++)$Lf=$Lt[2*$Lg],$LE=$Lt[2*$Lg+1],(.01<Math.abs($LG-$Lf)||.01<Math.abs($LN-$LE))&&this._points.push($Lf,$LE),$LG=$Lf,$LN=$LE;$Lf=$Lt[2*$Lp],$LE=$Lt[2*$Lp+1],$LG=this._points[0],$LN=this._points[1],(.01<Math.abs($LG-$Lf)||.01<Math.abs($LN-$LE))&&this._points.push($Lf,$LE),$LR.__super.call(this,$Lr,$Li,0,0,this._points.length/2,0,$L_,$LA)}$LX($LR,"laya.webgl.shapes.LoopLine",$Ltr);var $Li=$LR.prototype;return $Li.getData=function($Lr,$Li,$Lt){if(0<this.borderWidth){for(var $L_=this.color,$LA=($L_>>16&255)/255,$Lf=($L_>>8&255)/255,$LE=(255&$L_)/255,$LG=[],$LN=0,$Lp=0,$Lg=[],$LR=Math.floor(this._points.length/2),$LX=0;$LX<$LR;$LX++)$LN=this._points[2*$LX],$Lp=this._points[2*$LX+1],$LG.push(this.x+$LN,this.y+$Lp,$LA,$Lf,$LE);this.createLoopLine($LG,$Lg,this.borderWidth,$Lt+$LG.length/5),$Lr.append(new Uint16Array($Lg)),$Li.append(new Float32Array($LG))}},$Li.createLoopLine=function($Lr,$Li,$Lt,$L_,$LA,$Lf){$Lr.length;var $LE=$Lr.concat(),$LG=$LA||$Lr,$LN=this.borderColor,$Lp=($LN>>16&255)/255,$Lg=($LN>>8&255)/255,$LR=(255&$LN)/255,$LX=[$LE[0],$LE[1]],$Lv=[$LE[$LE.length-5],$LE[$LE.length-4]],$LO=$Lv[0]+.5*($LX[0]-$Lv[0]),$Lc=$Lv[1]+.5*($LX[1]-$Lv[1]);$LE.unshift($LO,$Lc,0,0,0),$LE.push($LO,$Lc,0,0,0);var $LB,$Ly,$LC,$Ln,$La,$LD,$Lu,$Lw,$LH,$Ls,$Ld,$Ll,$LU,$Lk,$Le,$LL,$LQ,$LF,$Lb,$LV,$Lh=$LE.length/5,$LP=$L_,$Lq=$Lt/2;$LC=$LE[0],$Ln=$LE[1],$Ls=$LC-($La=$LE[5]),$LH=($LH=-($Ln-($LD=$LE[6])))/($LV=Math.sqrt($LH*$LH+$Ls*$Ls))*$Lq,$Ls=$Ls/$LV*$Lq,$LG.push($LC-$LH,$Ln-$Ls,$Lp,$Lg,$LR,$LC+$LH,$Ln+$Ls,$Lp,$Lg,$LR);for(var $Lm=1;$Lm<$Lh-1;$Lm++)$LC=$LE[5*($Lm-1)],$Ln=$LE[5*($Lm-1)+1],$La=$LE[5*$Lm],$LD=$LE[5*$Lm+1],$Lu=$LE[5*($Lm+1)],$Lw=$LE[5*($Lm+1)+1],$Ls=$LC-$La,$Ll=$La-$Lu,$Le=(-($LH=($LH=-($Ln-$LD))/($LV=Math.sqrt($LH*$LH+$Ls*$Ls))*$Lq)+$LC)*(-($Ls=$Ls/$LV*$Lq)+$LD)-(-$LH+$La)*(-$Ls+$Ln),$LF=(-($Ld=($Ld=-($LD-$Lw))/($LV=Math.sqrt($Ld*$Ld+$Ll*$Ll))*$Lq)+$Lu)*(-($Ll=$Ll/$LV*$Lq)+$LD)-(-$Ld+$La)*(-$Ll+$Lw),$Lb=($LU=-$Ls+$Ln-(-$Ls+$LD))*($LQ=-$Ld+$La-(-$Ld+$Lu))-($LL=-$Ll+$Lw-(-$Ll+$LD))*($Lk=-$LH+$La-(-$LH+$LC)),Math.abs($Lb)<.1?($Lb+=10.1,$LG.push($La-$LH,$LD-$Ls,$Lp,$Lg,$LR,$La+$LH,$LD+$Ls,$Lp,$Lg,$LR)):((($LB=($Lk*$LF-$LQ*$Le)/$Lb)-$La)*($LB-$La)+(($Ly=($LL*$Le-$LU*$LF)/$Lb)-$LD)+($Ly-$LD),$LG.push($LB,$Ly,$Lp,$Lg,$LR,$La-($LB-$La),$LD-($Ly-$LD),$Lp,$Lg,$LR));$Lf&&($Li=$Lf);var $LT=this.edges+1;for($Lm=1;$Lm<$LT;$Lm++)$Li.push($LP+2*($Lm-1),$LP+2*($Lm-1)+1,$LP+2*$Lm+1,$LP+2*$Lm+1,$LP+2*$Lm,$LP+2*($Lm-1));return $Li.push($LP+2*($Lm-1),$LP+2*($Lm-1)+1,$LP+1,$LP+1,$LP,$LP+2*($Lm-1)),$LG},$LR}(),$LLr=function($Lr){function $LE($Lr,$Li,$Lt,$L_,$LA,$Lf){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=$Ls.create(),this._points=$Lt.slice(0,$Lt.length),$LE.__super.call(this,$Lr,$Li,0,0,this._points.length/2,$L_,$LA,$Lf)}$LX($LE,"laya.webgl.shapes.Polygon",$Ltr);var $Li=$LE.prototype;return $Li.rebuild=function($Lr){this._repaint||(this._points.length=0,this._points=this._points.concat($Lr))},$Li.setMatrix=function($Lr){$Lr.copyTo(this._mat)},$Li.needUpdate=function($Lr){return this._repaint=this._mat.a==$Lr.a&&this._mat.b==$Lr.b&&this._mat.c==$Lr.c&&this._mat.d==$Lr.d&&this._mat.tx==$Lr.tx&&this._mat.ty==$Lr.ty,!this._repaint},$Li.getData=function($Lr,$Li,$Lt){var $L_,$LA=0,$Lf=this._points,$LE=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=$Lt){for(this._start=$Lt,$L_=[],$LE=this.earcutTriangles.length,$LA=0;$LA<$LE;$LA++)$L_.push(this.earcutTriangles[$LA]+$Lt);this.mUint16Array=new Uint16Array($L_)}}else{this._start=$Lt,$L_=[];var $LG=[],$LN=[],$Lp=this.color,$Lg=($Lp>>16&255)/255,$LR=($Lp>>8&255)/255,$LX=(255&$Lp)/255;for($LE=Math.floor($Lf.length/2),$LA=0;$LA<$LE;$LA++)$LG.push(this.x+$Lf[2*$LA],this.y+$Lf[2*$LA+1],$Lg,$LR,$LX),$LN.push(this.x+$Lf[2*$LA],this.y+$Lf[2*$LA+1]);for(this.earcutTriangles=$L_r.earcut($LN,null,2),$LE=this.earcutTriangles.length,$LA=0;$LA<$LE;$LA++)$L_.push(this.earcutTriangles[$LA]+$Lt);this.mUint16Array=new Uint16Array($L_),this.mFloat32Array=new Float32Array($LG)}$Lr.append(this.mUint16Array),$Li.append(this.mFloat32Array)},$LE}(),$LQr=function($Lr){function $Lf(){this._matrix=new $Ls,this._matrix4=$Lcr.defaultMatrix4.concat(),$Lf.__super.call(this,1e4),this.shaderValue=new $LHr(0,0)}$LX($Lf,"laya.webgl.submit.SubmitCanvas",$Lfr);var $Li=$Lf.prototype;return $Li.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var $Lr=$LCr.worldAlpha,$Li=$LCr.worldMatrix4,$Lt=$LCr.worldMatrix,$L_=$LCr.worldFilters,$LA=$LCr.worldShaderDefines,$Lf=this.shaderValue,$LE=this._matrix,$LG=this._matrix4,$LN=$Ls.TEMP;return $Ls.mul($LE,$Lt,$LN),$LG[0]=$LN.a,$LG[1]=$LN.b,$LG[4]=$LN.c,$LG[5]=$LN.d,$LG[12]=$LN.tx,$LG[13]=$LN.ty,$LCr.worldMatrix=$LN.clone(),$LCr.worldMatrix4=$LG,$LCr.worldAlpha=$LCr.worldAlpha*$Lf.alpha,$Lf.filters&&$Lf.filters.length&&($LCr.worldFilters=$Lf.filters,$LCr.worldShaderDefines=$Lf.defines),this._ctx_src.flush(),$LCr.worldAlpha=$Lr,$LCr.worldMatrix4=$Li,$LCr.worldMatrix.destroy(),$LCr.worldMatrix=$Lt,$LCr.worldFilters=$L_,$LCr.worldShaderDefines=$LA,1},$Li.releaseRender=function(){var $Lr=$Lf._cache;this._ctx_src=null,$Lr[$Lr._length++]=this},$Li.getRenderType=function(){return 10003},$Lf.create=function($Lr,$Li,$Lt){var $L_=$Lf._cache._length?$Lf._cache[--$Lf._cache._length]:new $Lf;$L_._ctx_src=$Lr;var $LA=$L_.shaderValue;return $LA.alpha=$Li,$LA.defines.setValue(0),$Lt&&$Lt.length&&$LA.setFilters($Lt),$L_},$Lf._cache=(($Lf._cache=[])._length=0,$Lf._cache),$Lf}(),$LFr=function($Lr){function $Lp($Lr){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===$Lr&&($Lr=1e4),$Lp.__super.call(this,$Lr)}$LX($Lp,"laya.webgl.submit.SubmitTexture",$Lfr);var $Li=$Lp.prototype;return $Li.releaseRender=function(){var $Lr=$Lp._cache;($Lr[$Lr._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},$Li.addTexture=function($Lr,$Li){this._texsID[this._texs.length]=$Lr._uvID,this._texs.push($Lr),this._vbPos.push($Li)},$Li.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var $Lr=this.shaderValue.textureHost.bitmap;if(null!==$Lr)for(var $Li=this._vb.getFloat32Array(),$Lt=0,$L_=this._texs.length;$Lt<$L_;$Lt++){var $LA=this._texs[$Lt];$LA.active();var $Lf=$LA.uv;if(this._texsID[$Lt]!==$LA._uvID){this._texsID[$Lt]=$LA._uvID;var $LE=this._vbPos[$Lt];$Li[$LE+2]=$Lf[0],$Li[$LE+3]=$Lf[1],$Li[$LE+6]=$Lf[2],$Li[$LE+7]=$Lf[3],$Li[$LE+10]=$Lf[4],$Li[$LE+11]=$Lf[5],$Li[$LE+14]=$Lf[6],$Li[$LE+15]=$Lf[7],this._vb.setNeedUpload()}$LA.bitmap!==$Lr&&(this._isSameTexture=!1)}}},$Li.renderSubmit=function(){if(0===this._numEle)return $Lp._shaderSet=!1,1;var $Lr=this.shaderValue.textureHost;if($Lr){var $Li=$Lr.source;if(!$Lr.bitmap||!$Li)return $Lp._shaderSet=!1,1;this.shaderValue.texture=$Li,$Lr.alphaTexture&&$Lr.alphaTexture.source&&(this.shaderValue.texture1=$Lr.alphaTexture.source)}this._vb.bind_upload(this._ib);var $Lt=$Lar.mainContext;if($L$.activeBlendFunction!==this._blendFn&&($Lt.enable(3042),this._blendFn($Lt),$L$.activeBlendFunction=this._blendFn),$Le.drawCall++,$Le.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&$LVr.activeShader&&$Lp._shaderSet?($LVr.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&$LVr.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),$Lp._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var $L_=$Lr.bitmap,$LA=0,$Lf=$LVr.activeShader,$LE=0,$LG=this._texs.length;$LE<$LG;$LE++){var $LN=this._texs[$LE];$LN.bitmap===$L_&&$LE+1!==$LG||($Lf.uploadTexture2D($LN.source),$Lt.drawElements(4,6*($LE-$LA+1),5123,this._startIdx+6*$LA*$Lcr.BYTES_PIDX),$L_=$LN.bitmap,$LA=$LE)}else $Lt.drawElements(4,this._numEle,5123,this._startIdx);return 1},$Lp.create=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Lp._cache._length?$Lp._cache[--$Lp._cache._length]:new $Lp;null==$Lt&&(($Lt=$Lf._selfVb||($Lf._selfVb=$Ljr.create(-1))).clear(),$L_=0),$Lf._ib=$Li,$Lf._vb=$Lt,$Lf._startIdx=$L_*$Lcr.BYTES_PIDX,$Lf._numEle=0;var $LE=$Lr._nBlendType;$Lf._blendFn=$Lr._targets?$L$.targetFns[$LE]:$L$.fns[$LE],$Lf.shaderValue=$LA,$Lf.shaderValue.setValue($Lr._shader2D);var $LG=$Lr._shader2D.filters;return $LG&&$Lf.shaderValue.setFilters($LG),$Lf},$Lp._cache=(($Lp._cache=[])._length=0,$Lp._cache),$Lp._shaderSet=!0,$Lp}(),$Lbr=function($Lr){function $Ly(){$Ly.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}$LX($Ly,"laya.webgl.utils.MeshTexture",$Lyr);var $Li=$Ly.prototype;return $Li.addData=function($Lr,$Li,$Lt,$L_,$LA,$Lf){for(var $LE=$Lr.length/2,$LG=this._vb.needSize($LE*$Ly.const_stride)>>2,$LN=this._vb.getFloat32Array(),$Lp=0,$Lg=0;$Lg<$LE;$Lg++){var $LR=$Lr[$Lp],$LX=$Lr[$Lp+1],$Lv=$LR*$L_.a+$LX*$L_.c+$L_.tx,$LO=$LR*$L_.b+$LX*$L_.d+$L_.ty;$LN[$LG++]=$Lv,$LN[$LG++]=$LO,$LN[$LG++]=$Li[$Lp],$LN[$LG++]=$Li[$Lp+1],$Lp+=2}this._vb.setNeedUpload();var $Lc=this.vertNum;if(0<$Lc){($LE=$Lt.length)>$Ly.tmpIdx.length&&($Ly.tmpIdx=new Uint16Array($LE));for(var $LB=0;$LB<$LE;$LB++)$Ly.tmpIdx[$LB]=$Lt[$LB]+$Lc;this._ib.appendU16Array($Ly.tmpIdx,$Lt.length)}else this._ib.append($Lt);this._ib.setNeedUpload(),this.vertNum+=$LE,this.indexNum+=$Lt.length},$Li.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},$Li.destroy=function(){this._ib.destroy(),this._vb.destroy()},$Ly.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new $Ly},$Ly.const_stride=16,$Ly._POOL=[],$LE($Ly,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),$Ly}(),$LVr=function($Lr){function $Li(){$Li.__super.call(this),this.lock=!0}return $LX($Li,"laya.webgl.shader.BaseShader",$Ln),$Li.activeShader=null,$Li.bindShader=null,$Li}(),$Lhr=function($Li){function $Lg($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===$Lt&&($Lt=6408),void 0===$L_&&($L_=5121),void 0===$LA&&($LA=34041),void 0===$Lf&&($Lf=!1),void 0===$LE&&($LE=!1),void 0===$LG&&($LG=-1),void 0===$LN&&($LN=-1),this._type=1,this._w=$Lr,this._h=$Li,this._surfaceFormat=$Lt,this._surfaceType=$L_,this._depthStencilFormat=$LA,$Ly.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=$Lf,this._repeat=$LE,this._minFifter=$LG,this._magFifter=$LN,this._createWebGLRenderTarget(),this.bitmap.lock=!0,$Lg.__super.call(this,this.bitmap,$Lb.INV_UV)}$LX($Lg,"laya.webgl.resource.RenderTarget2D",$Li);var $Lr=$Lg.prototype;return $Lu.imps($Lr,{"laya.resource.IDispose":!0}),$Lr.getType=function(){return this._type},$Lr.getTexture=function(){return this},$Lr.size=function($Lr,$Li){this._w==$Lr&&this._h==$Li||(this._w=$Lr,this._h=$Li,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},$Lr.release=function(){this.destroy()},$Lr.recycle=function(){$Lg.POOL.push(this)},$Lr.start=function(){var $Lr=$Lar.mainContext;return this._preRenderTarget=$LCr.curRenderTarget,$LCr.curRenderTarget=this,$Lr.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&($Lr.viewport(0,0,this._w,this._h),this._svWidth=$LCr.width,this._svHeight=$LCr.height,$LCr.width=this._w,$LCr.height=this._h,$LVr.activeShader=null),this},$Lr.clear=function($Lr,$Li,$Lt,$L_){void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=1);var $LA=$Lar.mainContext;$LA.clearColor($Lr,$Li,$Lt,$L_);var $Lf=16384;switch(this._depthStencilFormat){case 33189:$Lf|=256;break;case 36168:$Lf|=1024;break;case 34041:$Lf|=256,$Lf|=1024}$LA.clear($Lf)},$Lr.end=function(){var $Lr=$Lar.mainContext;$Lr.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,$LCr.curRenderTarget=this._preRenderTarget,1==this._type?($Lr.viewport(0,0,this._svWidth,this._svHeight),$LCr.width=this._svWidth,$LCr.height=this._svHeight,$LVr.activeShader=null):$Lr.viewport(0,0,$Lu.stage.width,$Lu.stage.height)},$Lr.getData=function($Lr,$Li,$Lt,$L_){var $LA=$Lar.mainContext;if($LA.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===$LA.checkFramebufferStatus(36160)))return $LA.bindFramebuffer(36160,null),null;var $Lf=new Uint8Array(this._w*this._h*4);return $LA.readPixels($Lr,$Li,$Lt,$L_,this._surfaceFormat,this._surfaceType,$Lf),$LA.bindFramebuffer(36160,null),$Lf},$Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,$Li.prototype.destroy.call(this))},$Lr.dispose=function(){},$Lr._createWebGLRenderTarget=function(){this.bitmap=new $LJr(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function($Lr){this.event("recovered")})},$L_(0,$Lr,"surfaceFormat",function(){return this._surfaceFormat}),$L_(0,$Lr,"magFifter",function(){return this._magFifter}),$L_(0,$Lr,"surfaceType",function(){return this._surfaceType}),$L_(0,$Lr,"mipMap",function(){return this._mipMap}),$L_(0,$Lr,"depthStencilFormat",function(){return this._depthStencilFormat}),$L_(0,$Lr,"minFifter",function(){return this._minFifter}),$L_(0,$Lr,"source",function(){return this._alreadyResolved?$Lu.superGet($Lb,this,"source"):null}),$Lg.create=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){void 0===$Lt&&($Lt=6408),void 0===$L_&&($L_=5121),void 0===$LA&&($LA=34041),void 0===$Lf&&($Lf=!1),void 0===$LE&&($LE=!1),void 0===$LG&&($LG=-1),void 0===$LN&&($LN=-1);var $Lp=$Lg.POOL.pop();return $Lp||($Lp=new $Lg($Lr,$Li)),$Lp.bitmap&&$Lp._w==$Lr&&$Lp._h==$Li&&$Lp._surfaceFormat==$Lt&&$Lp._surfaceType==$L_&&$Lp._depthStencilFormat==$LA&&$Lp._mipMap==$Lf&&$Lp._repeat==$LE&&$Lp._minFifter==$LG&&$Lp._magFifter==$LN||($Lp._w=$Lr,$Lp._h=$Li,$Lp._surfaceFormat=$Lt,$Lp._surfaceType=$L_,$Lp._depthStencilFormat=$LA,$Ly.isConchWebGL&&34041===$Lp._depthStencilFormat&&($Lp._depthStencilFormat=33189),$Lp._mipMap=$Lf,$Lp._repeat=$LE,$Lp._minFifter=$LG,$Lp._magFifter=$LN,$Lp.release(),$Lp._createWebGLRenderTarget()),$Lp},$Lg.TYPE2D=1,$Lg.TYPE3D=2,$Lg.POOL=[],$Lg}($Lb),$LPr=function($Lr){function $Li(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,$Li.__super.call(this),$Li._gl=$Lar.mainContext}$LX($Li,"laya.webgl.utils.Buffer",$Ln);var $Lt=$Li.prototype;return $Lt._bind=function(){this.activeResource(),$Li._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&($Li._bindVertexBuffer=this._glBuffer),$Li._gl.bindBuffer(this._bufferType,$Li._bindActive[this._bufferType]=this._glBuffer),$LVr.activeShader=null)},$Lt.recreateResource=function(){this._glBuffer||(this._glBuffer=$Li._gl.createBuffer()),this.completeCreate()},$Lt.disposeResource=function(){this._glBuffer&&($Lar.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},$L_(0,$Lt,"bufferUsage",function(){return this._bufferUsage}),$Li._gl=null,$Li._bindActive={},$Li._bindVertexBuffer=null,$Li._enableAtributes=[],$Li}(),$Lqr=function($Lr){function $Lt($Lr){this.texcoord=null,this.offsetX=300,this.offsetY=0,$Lt.__super.call(this,512,0);var $Li=8*$Lcr.BYTES_PE;this.position=[2,5126,!1,$Li,0],this.texcoord=[2,5126,!1,$Li,2*$Lcr.BYTES_PE],this.color=[4,5126,!1,$Li,4*$Lcr.BYTES_PE]}return $LX($Lt,"laya.webgl.shader.d2.skinAnishader.SkinSV",$LHr),$Lt}(),$Lmr=function($Lr){function $Li($Lr){$Li.__super.call(this,2,0),this.color=[]}return $LX($Li,"laya.webgl.shader.d2.value.Color2dSV",$LHr),$Li.prototype.setValue=function($Lr){$Lr.fillStyle&&(this.color=$Lr.fillStyle._color._color),$Lr.strokeStyle&&(this.color=$Lr.strokeStyle._color._color)},$Li}(),$LTr=function($Lr){function $Li($Lr){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=$LHr._TEXCOORD,$Li.__super.call(this,256,0)}$LX($Li,"laya.webgl.shader.d2.value.FillTextureSV",$LHr);var $Lt=$Li.prototype;return $Lt.setValue=function($Lr){this.ALPHA=$Lr.ALPHA,$Lr.filters&&this.setFilters($Lr.filters)},$Lt.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$Li}(),$Lxr=function($Lr){function $Li($Lr){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=$LHr._TEXCOORD,void 0===$Lr&&($Lr=0),$Li.__super.call(this,1,$Lr)}$LX($Li,"laya.webgl.shader.d2.value.TextureSV",$LHr);var $Lt=$Li.prototype;return $Lt.setValue=function($Lr){this.ALPHA=$Lr.ALPHA,$Lr.filters&&this.setFilters($Lr.filters)},$Lt.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$Li}(),$L$r=function($Lr){function $Li($Lr){this.a_color=null,this.u_pos=[0,0],$Li.__super.call(this,4,0),this.position=[2,5126,!1,5*$Lcr.BYTES_PE,0],this.a_color=[3,5126,!1,5*$Lcr.BYTES_PE,2*$Lcr.BYTES_PE]}return $LX($Li,"laya.webgl.shader.d2.value.PrimitiveSV",$LHr),$Li}(),$Lor=function($Lr){function $Li(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,$Li.__super.call(this)}$LX($Li,"laya.webgl.atlas.AtlasWebGLCanvas",$Lr);var $Lt=$Li.prototype;return $Lt.recreateResource=function(){var $Lr=$Lar.mainContext,$Li=this._source=$Lr.createTexture(),$Lt=$LDr.curBindTexTarget,$L_=$LDr.curBindTexValue;$LDr.bindTexture($Lr,3553,$Li),$Lr.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),$Lr.texParameteri(3553,10241,9729),$Lr.texParameteri(3553,10240,9729),$Lr.texParameteri(3553,10242,33071),$Lr.texParameteri(3553,10243,33071),$Lt&&$L_&&$LDr.bindTexture($Lr,$Lt,$L_),this.memorySize=this._w*this._h*4,this.completeCreate()},$Lt.disposeResource=function(){this._source&&($Lar.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$Lt.texSubImage2D=function($Lr,$Li,$Lt){if($Ly.isFlash){this._flashCacheImage||(this._flashCacheImage=$Lc.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var $L_=$Lt.bitmapdata;this._flashCacheImage._image.copyPixels($L_,0,0,$L_.width,$L_.height,$Lr,$Li),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var $LA=$Lar.mainContext,$Lf=$LDr.curBindTexTarget,$LE=$LDr.curBindTexValue;$LDr.bindTexture($LA,3553,this._source),$LA.pixelStorei(37441,!0),0<=$Lr-1&&$LA.texSubImage2D(3553,0,$Lr-1,$Li,6408,5121,$Lt),$Lr+1<=this._w&&$LA.texSubImage2D(3553,0,$Lr+1,$Li,6408,5121,$Lt),0<=$Li-1&&$LA.texSubImage2D(3553,0,$Lr,$Li-1,6408,5121,$Lt),$Li+1<=this._h&&$LA.texSubImage2D(3553,0,$Lr,$Li+1,6408,5121,$Lt),$LA.texSubImage2D(3553,0,$Lr,$Li,6408,5121,$Lt),$LA.pixelStorei(37441,!1),$Lf&&$LE&&$LDr.bindTexture($LA,$Lf,$LE)}},$Lt.texSubImage2DPixel=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Lar.mainContext,$LE=$LDr.curBindTexTarget,$LG=$LDr.curBindTexValue;$LDr.bindTexture($Lf,3553,this._source);var $LN=new Uint8Array($LA.data);$Lf.pixelStorei(37441,!0),$Lf.texSubImage2D(3553,0,$Lr,$Li,$Lt,$L_,6408,5121,$LN),$Lf.pixelStorei(37441,!1),$LE&&$LG&&$LDr.bindTexture($Lf,$LE,$LG)},$L_(0,$Lt,"width",$Lr.prototype._$get_width,function($Lr){this._w=$Lr}),$L_(0,$Lt,"height",$Lr.prototype._$get_height,function($Lr){this._h=$Lr}),$Li}($Lt),$LIr=function($Lr){function $LA(){this.flipY=!0,this.alwaysChange=!1,$LA.__super.call(this)}$LX($LA,"laya.webgl.resource.WebGLCanvas",$Lt);var $Li=$LA.prototype;return $Li.getCanvas=function(){return this._canvas},$Li.clear=function(){this._ctx&&this._ctx.clear()},$Li.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$Li._setContext=function($Lr){this._ctx=$Lr},$Li.getContext=function($Lr,$Li){return this._ctx?this._ctx:this._ctx=$LA._createContext(this)},$Li.size=function($Lr,$Li){this._w==$Lr&&this._h==$Li||(this._w=$Lr,this._h=$Li,this._ctx&&this._ctx.size($Lr,$Li),this._canvas&&(this._canvas.height=$Li,this._canvas.width=$Lr))},$Li.activeResource=function($Lr){void 0===$Lr&&($Lr=!1),this._source||this.recreateResource()},$Li.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},$Li.disposeResource=function(){this._source&&!this.iscpuSource&&($Lar.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$Li.createWebGlTexture=function(){var $Lr=$Lar.mainContext;this._canvas;var $Li=this._source=$Lr.createTexture();this.iscpuSource=!1;var $Lt=$LDr.curBindTexTarget,$L_=$LDr.curBindTexValue;$LDr.bindTexture($Lr,3553,$Li),$Lr.pixelStorei(37440,this.flipY?1:0),$LA.premulAlpha&&$Lr.pixelStorei(37441,!0),$Lr.texImage2D(3553,0,6408,6408,5121,this._imgData),$LA.premulAlpha&&$Lr.pixelStorei(37441,!1),$Lr.texParameteri(3553,10240,9729),$Lr.texParameteri(3553,10241,9729),$Lr.texParameteri(3553,10242,33071),$Lr.texParameteri(3553,10243,33071),$Lr.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,$Lt&&$L_&&$LDr.bindTexture($Lr,$Lt,$L_)},$Li.reloadCanvasData=function(){var $Lr=$Lar.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var $Li=$LDr.curBindTexTarget,$Lt=$LDr.curBindTexValue;$LDr.bindTexture($Lr,3553,this._source),$LA.premulAlpha&&$Lr.pixelStorei(37441,!0),$Lr.texImage2D(3553,0,6408,6408,5121,this._imgData),$LA.premulAlpha&&$Lr.pixelStorei(37441,!1),$Lr.pixelStorei(37440,0),$Li&&$Lt&&$LDr.bindTexture($Lr,$Li,$Lt)},$Li.texSubImage2D=function($Lr,$Li,$Lt){var $L_=$Lar.mainContext,$LA=$LDr.curBindTexTarget,$Lf=$LDr.curBindTexValue;$LDr.bindTexture($L_,3553,this._source),$L_.pixelStorei(37441,!0),$L_.texSubImage2D(3553,0,$Li,$Lt,6408,5121,$Lr._source),$L_.pixelStorei(37441,!1),$LA&&$Lf&&$LDr.bindTexture($L_,$LA,$Lf)},$Li.toBase64=function($Lr,$Li,$Lt){var $L_=null;this._canvas&&($L_=this._canvas.toDataURL($Lr,$Li)),$Lt.call(this,$L_)},$L_(0,$Li,"context",function(){return this._ctx}),$L_(0,$Li,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),$L_(0,$Li,"asBitmap",null,function($Lr){this._ctx&&(this._ctx.asBitmap=$Lr)}),$LA._createContext=null,$LA.premulAlpha=!1,$LA}(),$Lzr=function($Lr){function $Lf($Lr,$Li){this.CborderSize=12,$Lf.__super.call(this),this.char=$Lr,this.isSpace=" "===$Lr,this.xs=$Li.scaleX,this.ys=$Li.scaleY,this.font=$Li.font.toString(),this.fontSize=$Li.font.size,this.fillColor=$Li.fillColor,this.borderColor=$Li.borderColor,this.lineWidth=$Li.lineWidth,this.underLine=$Li.underLine;var $Lt,$L_=$Ly.isConchApp;$L_?(($Lt=ConchTextCanvas)._source=ConchTextCanvas,$Lt._source.canvas=ConchTextCanvas):$Lt=$Lv.canvas.source,this.canvas=$Lt,this._enableMerageInAtlas=!0,this._ctx=$L_?$Lt:this.canvas.getContext("2d",void 0);var $LA=$LV.measureText(this.char,this.font);this.cw=$LA.width*this.xs,this.ch=($LA.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new $Lb(this)}$LX($Lf,"laya.webgl.resource.WebGLCharImage",$Lt);var $Li=$Lf.prototype;return $Lu.imps($Li,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$Li.active=function(){this.texture.active()},$Li.recreateResource=function(){var $Lr=$Ly.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),$Lr){var $Li=this.fontSize;1==this.xs&&1==this.ys||($Li=parseInt($Li*(this.xs>this.ys?this.xs:this.ys)+""));var $Lt="normal 100 "+this.font;$Lt=$Lt.replace($Lf._fontSizeReg,$Li),this.borderColor&&($Lt+=" 1 "+this.borderColor),this._ctx.font=$Lt,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,$LF.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var $L_=this._ctx.measureText(this.char);$L_||($L_={width:16});var $LA=$L_.width+1;this._ctx.lineTo($LA,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},$Li.onresize=function($Lr,$Li){this._w=$Lr,this._h=$Li,this._allowMerageInAtlas=!0},$Li.clearAtlasSource=function(){},$L_(0,$Li,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$L_(0,$Li,"atlasSource",function(){return this.canvas}),$L_(0,$Li,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($Lr){this._enableMerageInAtlas=$Lr}),$Lf.createOneChar=function($Lr,$Li){return new $Lf($Lr,$Li)},$Lf._fontSizeReg=new RegExp("\\d+(?=px)","g"),$Lf}(),$LJr=function($Lr){function $Lp($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){void 0===$Lt&&($Lt=6408),void 0===$L_&&($L_=5121),void 0===$LA&&($LA=34041),void 0===$Lf&&($Lf=!1),void 0===$LE&&($LE=!1),void 0===$LG&&($LG=-1),void 0===$LN&&($LN=1),$Lp.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=$Lr,this._h=$Li,this._surfaceFormat=$Lt,this._surfaceType=$L_,this._depthStencilFormat=$LA,this._mipMap=$Lf,this._repeat=$LE,this._minFifter=$LG,this._magFifter=$LN}$LX($Lp,"laya.webgl.resource.WebGLRenderTarget",$Lt);var $Li=$Lp.prototype;return $Li.recreateResource=function(){var $Lr=$Lar.mainContext;this._frameBuffer||(this._frameBuffer=$Lr.createFramebuffer()),this._source||(this._source=$Lr.createTexture());var $Li=$LDr.curBindTexTarget,$Lt=$LDr.curBindTexValue;$LDr.bindTexture($Lr,3553,this._source),$Lr.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var $L_=this._minFifter,$LA=this._magFifter,$Lf=this._repeat?10497:33071,$LE=$Lg.isPOT(this._w,this._h);if($LE?(this._mipMap?-1!==$L_||($L_=9987):-1!==$L_||($L_=9729),-1!==$LA||($LA=9729),$Lr.texParameteri(3553,10241,$L_),$Lr.texParameteri(3553,10240,$LA),$Lr.texParameteri(3553,10242,$Lf),$Lr.texParameteri(3553,10243,$Lf),this._mipMap&&$Lr.generateMipmap(3553)):(-1!==$L_||($L_=9729),-1!==$LA||($LA=9729),$Lr.texParameteri(3553,10241,$L_),$Lr.texParameteri(3553,10240,$LA),$Lr.texParameteri(3553,10242,33071),$Lr.texParameteri(3553,10243,33071)),$Lr.bindFramebuffer(36160,this._frameBuffer),$Lr.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=$Lr.createRenderbuffer()),$Lr.bindRenderbuffer(36161,this._depthStencilBuffer),$Lr.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:$Lr.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$Lr.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$Lr.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$Lr.bindFramebuffer(36160,null),$Li&&$Lt&&$LDr.bindTexture($Lr,$Li,$Lt),$Lr.bindRenderbuffer(36161,null),$LE&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},$Li.disposeResource=function(){this._frameBuffer&&($Lar.mainContext.deleteTexture(this._source),$Lar.mainContext.deleteFramebuffer(this._frameBuffer),$Lar.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null)},$L_(0,$Li,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$L_(0,$Li,"frameBuffer",function(){return this._frameBuffer}),$Lp}(),$LZr=function($Lr){function $LG($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this.offsetX=0,this.offsetY=0,$LG.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=$Lf,this.canvas=$Lr,this._ctx=$Lr.getContext("2d",void 0),this._w=$L_,this._h=$LA,this.offsetX=$Li,this.offsetY=$Lt,this.src=$LE,this._enableMerageInAtlas=!0,$LT.enabled&&this._w<$LT.atlasLimitWidth&&this._h<$LT.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}$LX($LG,"laya.webgl.resource.WebGLSubImage",$Lt);var $Li=$LG.prototype;return $Lu.imps($Li,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$Li.size=function($Lr,$Li){this._w=$Lr,this._h=$Li,this._ctx&&this._ctx.size($Lr,$Li),this.canvas&&(this.canvas.height=$Li,this.canvas.width=$Lr)},$Li.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},$Li.createWebGlTexture=function(){var $Lr=$Lar.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var $Li=this._source=$Lr.createTexture(),$Lt=$LDr.curBindTexTarget,$L_=$LDr.curBindTexValue;$LDr.bindTexture($Lr,3553,$Li),$Lr.pixelStorei(37441,!0),$Lr.texImage2D(3553,0,6408,6408,5121,this.canvas),$Lr.pixelStorei(37441,!1);var $LA=this.minFifter,$Lf=this.magFifter,$LE=this.repeat?10497:33071,$LG=$Lg.isPOT(this.width,this.height);$LG?(this.mipmap?-1!==$LA||($LA=9987):-1!==$LA||($LA=9729),-1!==$Lf||($Lf=9729),$Lr.texParameteri(3553,10240,$Lf),$Lr.texParameteri(3553,10241,$LA),$Lr.texParameteri(3553,10242,$LE),$Lr.texParameteri(3553,10243,$LE),this.mipmap&&$Lr.generateMipmap(3553)):(-1!==$LA||($LA=9729),-1!==$Lf||($Lf=9729),$Lr.texParameteri(3553,10241,$LA),$Lr.texParameteri(3553,10240,$Lf),$Lr.texParameteri(3553,10242,33071),$Lr.texParameteri(3553,10243,33071)),$Lt&&$L_&&$LDr.bindTexture($Lr,$Lt,$L_),this.canvas=null,$LG&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},$Li.disposeResource=function(){$LT.enabled&&this._allowMerageInAtlas||!this._source||($Lar.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$Li.clearAtlasSource=function(){},$L_(0,$Li,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$L_(0,$Li,"atlasSource",function(){return this.canvas}),$L_(0,$Li,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function($Lr){this._allowMerageInAtlas=$Lr}),$LG}(),$LWr=function($Lr){function $Lp($Lr,$Li,$Lt,$L_){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,$Lp.__super.call(this),!$Lr||!$Li)throw"Shader Error";this._id=++$Lp._count,this._vs=$Lr,this._ps=$Li,this._nameMap=$L_||{},null!=$Lt&&($Lp.sharders[$Lt]=this)}$LX($Lp,"laya.webgl.shader.Shader",$LVr);var $Li=$Lp.prototype;return $Li.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},$Li.disposeResource=function(){$Lar.mainContext.deleteShader(this._vshader),$Lar.mainContext.deleteShader(this._pshader),$Lar.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},$Li._compile=function(){if(!$Lar.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var $Lr=[this._vs,this._ps],$Li=$Lar.mainContext;if(this._program=$Li.createProgram(),this._vshader=$Lp._createShader($Li,$Lr[0],35633),this._pshader=$Lp._createShader($Li,$Lr[1],35632),$Li.attachShader(this._program,this._vshader),$Li.attachShader(this._program,this._pshader),$Li.linkProgram(this._program),!$Ly.isConchApp&&!$Li.getProgramParameter(this._program,35714))throw $Li.getProgramInfoLog(this._program);var $Lt,$L_,$LA=0,$Lf=0;for($Lf=$Ly.isConchApp?$Li.getProgramParameterEx(this._vs,this._ps,"",35721):$Li.getProgramParameter(this._program,35721),$LA=0;$LA<$Lf;$LA++){var $LE=null;$Lt={vartype:"attribute",glfun:null,ivartype:0,attrib:$LE=$Ly.isConchApp?$Li.getActiveAttribEx(this._vs,this._ps,"",$LA):$Li.getActiveAttrib(this._program,$LA),location:$Li.getAttribLocation(this._program,$LE.name),name:$LE.name,type:$LE.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push($Lt)}var $LG=0;for($LG=$Ly.isConchApp?$Li.getProgramParameterEx(this._vs,this._ps,"",35718):$Li.getProgramParameter(this._program,35718),$LA=0;$LA<$LG;$LA++){var $LN=null;$LN=$Ly.isConchApp?$Li.getActiveUniformEx(this._vs,this._ps,"",$LA):$Li.getActiveUniform(this._program,$LA),0<($Lt={vartype:"uniform",glfun:null,ivartype:1,attrib:$LE,location:$Li.getUniformLocation(this._program,$LN.name),name:$LN.name,type:$LN.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($Lt.name=$Lt.name.substr(0,$Lt.name.length-3),$Lt.isArray=!0,$Lt.location=$Li.getUniformLocation(this._program,$Lt.name)),this._params.push($Lt)}for($LA=0,$L_=this._params.length;$LA<$L_;$LA++)if(($Lt=this._params[$LA]).indexOfParams=$LA,$Lt.index=1,$Lt.value=[$Lt.location,null],$Lt.codename=$Lt.name,$Lt.name=this._nameMap[$Lt.codename]?this._nameMap[$Lt.codename]:$Lt.codename,(this._paramsMap[$Lt.name]=$Lt)._this=this,$Lt.uploadedValue=[],"attribute"!==$Lt.vartype)switch($Lt.type){case 5124:$Lt.fun=$Lt.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$Lt.fun=$Lt.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$Lt.fun=$Lt.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$Lt.fun=$Lt.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$Lt.fun=$Lt.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$Lt.fun=this._uniform_sampler2D;break;case 35680:$Lt.fun=this._uniform_samplerCube;break;case 35676:$Lt.glfun=$Li.uniformMatrix4fv,$Lt.fun=this._uniformMatrix4fv;break;case 35670:$Lt.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else $Lt.fun=this._attribute}},$Li.getUniform=function($Lr){return this._paramsMap[$Lr]},$Li._attribute=function($Lr,$Li){var $Lt=$Lar.mainContext,$L_=$LPr._enableAtributes,$LA=$Lr.location;return $L_[$LA]||$Lt.enableVertexAttribArray($LA),$Lt.vertexAttribPointer($LA,$Li[0],$Li[1],$Li[2],$Li[3],$Li[4]+this._offset),$L_[$LA]=$LPr._bindVertexBuffer,1},$Li._uniform1f=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li?($Lar.mainContext.uniform1f($Lr.location,$Lt[0]=$Li),1):0},$Li._uniform1fv=function($Lr,$Li){if($Li.length<4){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]||$Lt[2]!==$Li[2]||$Lt[3]!==$Li[3]?($Lar.mainContext.uniform1fv($Lr.location,$Li),$Lt[0]=$Li[0],$Lt[1]=$Li[1],$Lt[2]=$Li[2],$Lt[3]=$Li[3],1):0}return $Lar.mainContext.uniform1fv($Lr.location,$Li),1},$Li._uniform_vec2=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]?($Lar.mainContext.uniform2f($Lr.location,$Lt[0]=$Li[0],$Lt[1]=$Li[1]),1):0},$Li._uniform_vec2v=function($Lr,$Li){if($Li.length<2){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]||$Lt[2]!==$Li[2]||$Lt[3]!==$Li[3]?($Lar.mainContext.uniform2fv($Lr.location,$Li),$Lt[0]=$Li[0],$Lt[1]=$Li[1],$Lt[2]=$Li[2],$Lt[3]=$Li[3],1):0}return $Lar.mainContext.uniform2fv($Lr.location,$Li),1},$Li._uniform_vec3=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]||$Lt[2]!==$Li[2]?($Lar.mainContext.uniform3f($Lr.location,$Lt[0]=$Li[0],$Lt[1]=$Li[1],$Lt[2]=$Li[2]),1):0},$Li._uniform_vec3v=function($Lr,$Li){return $Lar.mainContext.uniform3fv($Lr.location,$Li),1},$Li._uniform_vec4=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]||$Lt[2]!==$Li[2]||$Lt[3]!==$Li[3]?($Lar.mainContext.uniform4f($Lr.location,$Lt[0]=$Li[0],$Lt[1]=$Li[1],$Lt[2]=$Li[2],$Lt[3]=$Li[3]),1):0},$Li._uniform_vec4v=function($Lr,$Li){return $Lar.mainContext.uniform4fv($Lr.location,$Li),1},$Li._uniformMatrix2fv=function($Lr,$Li){return $Lar.mainContext.uniformMatrix2fv($Lr.location,!1,$Li),1},$Li._uniformMatrix3fv=function($Lr,$Li){return $Lar.mainContext.uniformMatrix3fv($Lr.location,!1,$Li),1},$Li._uniformMatrix4fv=function($Lr,$Li){return $Lar.mainContext.uniformMatrix4fv($Lr.location,!1,$Li),1},$Li._uniform1i=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li?($Lar.mainContext.uniform1i($Lr.location,$Lt[0]=$Li),1):0},$Li._uniform1iv=function($Lr,$Li){return $Lar.mainContext.uniform1iv($Lr.location,$Li),1},$Li._uniform_ivec2=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]?($Lar.mainContext.uniform2i($Lr.location,$Lt[0]=$Li[0],$Lt[1]=$Li[1]),1):0},$Li._uniform_ivec2v=function($Lr,$Li){return $Lar.mainContext.uniform2iv($Lr.location,$Li),1},$Li._uniform_vec3i=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]||$Lt[2]!==$Li[2]?($Lar.mainContext.uniform3i($Lr.location,$Lt[0]=$Li[0],$Lt[1]=$Li[1],$Lt[2]=$Li[2]),1):0},$Li._uniform_vec3vi=function($Lr,$Li){return $Lar.mainContext.uniform3iv($Lr.location,$Li),1},$Li._uniform_vec4i=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]||$Lt[2]!==$Li[2]||$Lt[3]!==$Li[3]?($Lar.mainContext.uniform4i($Lr.location,$Lt[0]=$Li[0],$Lt[1]=$Li[1],$Lt[2]=$Li[2],$Lt[3]=$Li[3]),1):0},$Li._uniform_vec4vi=function($Lr,$Li){return $Lar.mainContext.uniform4iv($Lr.location,$Li),1},$Li._uniform_sampler2D=function($Lr,$Li){var $Lt=$Lar.mainContext,$L_=$Lr.uploadedValue;return null==$L_[0]?($L_[0]=this._curActTexIndex,$Lt.uniform1i($Lr.location,this._curActTexIndex),$Lt.activeTexture($Lp._TEXTURES[this._curActTexIndex]),$LDr.bindTexture($Lt,3553,$Li),this._curActTexIndex++,1):($Lt.activeTexture($Lp._TEXTURES[$L_[0]]),$LDr.bindTexture($Lt,3553,$Li),0)},$Li._uniform_samplerCube=function($Lr,$Li){var $Lt=$Lar.mainContext,$L_=$Lr.uploadedValue;return null==$L_[0]?($L_[0]=this._curActTexIndex,$Lt.uniform1i($Lr.location,this._curActTexIndex),$Lt.activeTexture($Lp._TEXTURES[this._curActTexIndex]),$LDr.bindTexture($Lt,34067,$Li),this._curActTexIndex++,1):($Lt.activeTexture($Lp._TEXTURES[$L_[0]]),$LDr.bindTexture($Lt,34067,$Li),0)},$Li._noSetValue=function($Lr){console.log("no....:"+$Lr.name)},$Li.uploadOne=function($Lr,$Li){this.activeResource(),$LDr.UseProgram(this._program);var $Lt=this._paramsMap[$Lr];$Lt.fun.call(this,$Lt,$Li)},$Li.uploadTexture2D=function($Lr){$Le.shaderCall++;var $Li=$Lar.mainContext;$Li.activeTexture(33984),$LDr.bindTexture($Li,3553,$Lr)},$Li.uploadTexture2D1=function($Lr){$Le.shaderCall++;var $Li=$Lar.mainContext;$Li.activeTexture(33985),$LDr.bindTexture($Li,3553,$Lr)},$Li.upload=function($Lr,$Li){$LVr.activeShader=$LVr.bindShader=this,this._lastUseFrameCount===$Le.loopCount||this.activeResource(),$LDr.UseProgram(this._program),this._reCompile?($Li=this._params,this._reCompile=!1):$Li=$Li||this._params;$Lar.mainContext;for(var $Lt,$L_,$LA=$Li.length,$Lf=0,$LE=0;$LE<$LA;$LE++)null!==($L_=$Lr[($Lt=$Li[$LE]).name])&&($Lf+=$Lt.fun.call(this,$Lt,$L_));$Le.shaderCall+=$Lf},$Li.uploadArray=function($Lr,$Li,$Lt){$LVr.activeShader=this,($LVr.bindShader=this).activeResource(),$LDr.UseProgram(this._program);this._params;for(var $L_,$LA,$Lf=0,$LE=$Li-2;0<=$LE;$LE-=2)($LA=this._paramsMap[$Lr[$LE]])&&null!=($L_=$Lr[$LE+1])&&($Lt&&$Lt[$LA.name]&&$Lt[$LA.name].bind(),$Lf+=$LA.fun.call(this,$LA,$L_));$Le.shaderCall+=$Lf},$Li.getParams=function(){return this._params},$Lp.getShader=function($Lr){return $Lp.sharders[$Lr]},$Lp.create=function($Lr,$Li,$Lt,$L_){return new $Lp($Lr,$Li,$Lt,$L_)},$Lp.withCompile=function($Lr,$Li,$Lt,$L_){if($Lt&&$Lp.sharders[$Lt])return $Lp.sharders[$Lt];var $LA=$Lp._preCompileShader[2e-4*$Lr];if(!$LA)throw new Error("withCompile shader err!"+$Lr);return $LA.createShader($Li,$Lt,$L_)},$Lp.withCompile2D=function($Lr,$Li,$Lt,$L_,$LA){if($L_&&$Lp.sharders[$L_])return $Lp.sharders[$L_];var $Lf=$Lp._preCompileShader[2e-4*$Lr+$Li];if(!$Lf)throw new Error("withCompile shader err!"+$Lr+" "+$Li);return $Lf.createShader($Lt,$L_,$LA)},$Lp.addInclude=function($Lr,$Li){$Lnr.addInclude($Lr,$Li)},$Lp.preCompile=function($Lr,$Li,$Lt,$L_){var $LA=2e-4*$Lr;$Lp._preCompileShader[$LA]=new $Lnr($LA,$Li,$Lt,$L_)},$Lp.preCompile2D=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=2e-4*$Lr+$Li;$Lp._preCompileShader[$Lf]=new $Lnr($Lf,$Lt,$L_,$LA)},$Lp._createShader=function($Lr,$Li,$Lt){var $L_=$Lr.createShader($Lt);return $Lr.shaderSource($L_,$Li),$Lr.compileShader($L_),$L_},$Lp._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],$Lp._count=0,$Lp._preCompileShader={},$Lp.SHADERNAME2ID=2e-4,$Lp.sharders=(($Lp.sharders=[]).length=32,$Lp.sharders),$LE($Lp,["nameKey",function(){return this.nameKey=new $LL}]),$Lp}(),$LMr=function($Lr){function $Li(){this._maxsize=0,this._upload=!0,this._uploadSize=0,$Li.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}$LX($Li,"laya.webgl.utils.Buffer2D",$Lr);var $Lt=$Li.prototype;return $Lt.needSize=function($Lr){var $Li=this._byteLength;if($Lr){var $Lt=this._byteLength+$Lr;$Lt<=this._buffer.byteLength||this._resizeBuffer($Lt<<1,!0),this._byteLength=$Lt}return $Li},$Lt._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),$Le.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$LPr._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$LPr._gl.bufferSubData(this._bufferType,0,this._buffer)},$Lt._bufferSubData=function($Lr,$Li,$Lt){if(void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),this._maxsize=Math.max(this._maxsize,this._byteLength),$Le.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$LPr._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$Li||$Lt){var $L_=this._buffer.slice($Li,$Lt);$LPr._gl.bufferSubData(this._bufferType,$Lr,$L_)}else $LPr._gl.bufferSubData(this._bufferType,$Lr,this._buffer)},$Lt._checkArrayUse=function(){},$Lt._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},$Lt._bind_subUpload=function($Lr,$Li,$Lt){return void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData($Lr,$Li,$Lt),!0)},$Lt._resizeBuffer=function($Lr,$Li){if($Lr<this._buffer.byteLength)return this;if(this.memorySize=$Lr,$Li&&this._buffer&&0<this._buffer.byteLength){var $Lt=new ArrayBuffer($Lr);new Uint8Array($Lt).set(new Uint8Array(this._buffer),0),this._buffer=$Lt}else this._buffer=new ArrayBuffer($Lr);return this._checkArrayUse(),this._upload=!0,this},$Lt.append=function($Lr){this._upload=!0;var $Li,$Lt;$Li=$Lr.byteLength,$Lr instanceof Uint8Array?(this._resizeBuffer(this._byteLength+$Li,!0),$Lt=new Uint8Array(this._buffer,this._byteLength)):$Lr instanceof Uint16Array?(this._resizeBuffer(this._byteLength+$Li,!0),$Lt=new Uint16Array(this._buffer,this._byteLength)):$Lr instanceof Float32Array&&(this._resizeBuffer(this._byteLength+$Li,!0),$Lt=new Float32Array(this._buffer,this._byteLength)),$Lt.set($Lr,0),this._byteLength+=$Li,this._checkArrayUse()},$Lt.appendU16Array=function($Lr,$Li){this._resizeBuffer(this._byteLength+2*$Li,!0);for(var $Lt=new Uint16Array(this._buffer,this._byteLength,$Li),$L_=0;$L_<$Li;$L_++)$Lt[$L_]=$Lr[$L_];this._byteLength+=2*$Li,this._checkArrayUse()},$Lt.appendEx=function($Lr,$Li){this._upload=!0;var $Lt;$Lt=$Lr.byteLength,this._resizeBuffer(this._byteLength+$Lt,!0),new $Li(this._buffer,this._byteLength).set($Lr,0),this._byteLength+=$Lt,this._checkArrayUse()},$Lt.appendEx2=function($Lr,$Li,$Lt,$L_){void 0===$L_&&($L_=1),this._upload=!0;var $LA,$Lf;$LA=$Lt*$L_,this._resizeBuffer(this._byteLength+$LA,!0),$Lf=new $Li(this._buffer,this._byteLength);var $LE=0;for($LE=0;$LE<$Lt;$LE++)$Lf[$LE]=$Lr[$LE];this._byteLength+=$LA,this._checkArrayUse()},$Lt.getBuffer=function(){return this._buffer},$Lt.setNeedUpload=function(){this._upload=!0},$Lt.getNeedUpload=function(){return this._upload},$Lt.upload=function(){var $Lr=this._bind_upload();return $LPr._gl.bindBuffer(this._bufferType,null),$LPr._bindActive[this._bufferType]=null,$LVr.activeShader=null,$Lr},$Lt.subUpload=function($Lr,$Li,$Lt){void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0);var $L_=this._bind_subUpload();return $LPr._gl.bindBuffer(this._bufferType,null),$LPr._bindActive[this._bufferType]=null,$LVr.activeShader=null,$L_},$Lt.disposeResource=function(){$Lr.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},$Lt.clear=function(){this._byteLength=0,this._upload=!0},$L_(0,$Lt,"bufferLength",function(){return this._buffer.byteLength}),$L_(0,$Lt,"byteLength",null,function($Lr){this._byteLength!==$Lr&&($Lr<=this._buffer.byteLength||this._resizeBuffer(2*$Lr+256,!0),this._byteLength=$Lr)}),$Li.__int__=function($Lr){$LYr.QuadrangleIB=$LYr.create(35044),$LBr.fillIBQuadrangle($LYr.QuadrangleIB,16)},$Li.FLOAT32=4,$Li.SHORT=2,$Li}($LPr),$LKr=(function($Li){function $Lt($Lr){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,$Lt.__super.call(this,9)}$LX($Lt,"laya.webgl.shader.d2.value.GlowSV",$Li);var $Lr=$Lt.prototype;$Lr.setValue=function($Lr){$Li.prototype.setValue.call(this,$Lr)},$Lr.clear=function(){$Li.prototype.clear.call(this)}}($Lxr),function($Lr){function $Li($Lr){$Li.__super.call(this,64),this.defines.add(64)}$LX($Li,"laya.webgl.shader.d2.value.TextSV",$Lr);var $Lt=$Li.prototype;return $Lt.release=function(){($Li.pool[$Li._length++]=this).clear()},$Lt.clear=function(){$Lr.prototype.clear.call(this)},$Li.create=function(){return $Li._length?$Li.pool[--$Li._length]:new $Li(null)},$Li.pool=[],$Li._length=0,$Li}($Lxr)),$LSr=function($Lr){function $LA($Lr,$Li,$Lt,$L_){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,$LA.__super.call(this,$Lr,$Li,$Lt,$L_)}$LX($LA,"laya.webgl.shader.d2.Shader2X",$Lr);var $Li=$LA.prototype;return $Li.upload2dQuick1=function($Lr){this.upload($Lr,this._params2dQuick1||this._make2dQuick1())},$Li._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var $Lr,$Li=this._params,$Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++)$Lr=$Li[$Lt],($Ly.isFlash||"size"!==$Lr.name&&"position"!==$Lr.name&&"texcoord"!==$Lr.name)&&this._params2dQuick1.push($Lr)}return this._params2dQuick1},$Li.disposeResource=function(){$Lr.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},$Li.upload2dQuick2=function($Lr){this.upload($Lr,this._params2dQuick2||this._make2dQuick2())},$Li._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var $Lr,$Li=this._params,$Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++)$Lr=$Li[$Lt],($Ly.isFlash||"size"!==$Lr.name)&&this._params2dQuick2.push($Lr)}return this._params2dQuick2},$LA.create=function($Lr,$Li,$Lt,$L_){return new $LA($Lr,$Li,$Lt,$L_)},$LA}($LWr),$LYr=function($Lr){function $Li($Lr){this._uint8Array=null,this._uint16Array=null,void 0===$Lr&&($Lr=35044),$Li.__super.call(this),this._bufferUsage=$Lr,this._bufferType=34963,$Ly.isFlash||(this._buffer=new ArrayBuffer(8))}$LX($Li,"laya.webgl.utils.IndexBuffer2D",$LMr);var $Lt=$Li.prototype;return $Lt._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},$Lt.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},$Lt.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},$Lt.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},$Li.QuadrangleIB=null,$Li.create=function($Lr){return void 0===$Lr&&($Lr=35044),new $Li($Lr)},$Li}(),$Ljr=function($Lr){function $Lt($Lr,$Li){this._floatArray32=null,this._vertexStride=0,$Lt.__super.call(this),this._vertexStride=$Lr,this._bufferUsage=$Li,this._bufferType=34962,$Ly.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}$LX($Lt,"laya.webgl.utils.VertexBuffer2D",$Lr);var $Li=$Lt.prototype;return $Li.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},$Li.bind=function($Lr){$Lr&&$Lr._bind(),this._bind()},$Li.insertData=function($Lr,$Li){this.getFloat32Array().set($Lr,$Li),this._upload=!0},$Li.bind_upload=function($Lr){$Lr._bind_upload()||$Lr._bind(),this._bind_upload()||this._bind()},$Li._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},$Li.disposeResource=function(){$Lr.prototype.disposeResource.call(this)},$Li.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},$L_(0,$Li,"vertexStride",function(){return this._vertexStride}),$Lt.create=function($Lr,$Li){return void 0===$Li&&($Li=35048),new $Lt($Lr,$Li)},$Lt}($LMr),$Lri=function($Lr){function $LG($Lr,$Li,$Lt,$L_,$LA,$Lf){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===$Lt&&($Lt=6408),void 0===$L_&&($L_=!0),$LG.__super.call(this,$Lr,$Li),$Lr){if(this._format=$Lt,this._mipmap=$L_,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof $Lr)this._url=$Lr,this._src=$Lr,this._image=new $Lv.window.Image,$Li&&($Li.onload&&(this.onload=$Li.onload),$Li.onerror&&(this.onerror=$Li.onerror),$Li.onCreate&&$Li.onCreate(this)),this._image.crossOrigin=$Lr&&0==$Lr.indexOf("data:")?null:"",$Lr&&(this._image.src=$Lr);else if($Lr instanceof ArrayBuffer){this._src=$Li,this._url=this._src;var $LE=new $LN($Lr);$LE.readUTFBytes(4),$LE.readUTFBytes(2),$LE.getInt16();$LE.endian="bigEndian",this._w=$LE.getInt16(),this._h=$LE.getInt16();$LE.getInt16(),$LE.getInt16();this._image=new Uint8Array($Lr,$LE.pos),this._format=$Lar.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,$LT.enabled&&this._w<$LT.atlasLimitWidth&&this._h<$LT.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!($Lr instanceof Uint8Array))return this._src=$Li,this._url=this._src,this._image=$Lr.source||$Lr,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=$Li,this._url=this._src,this._w=$LA,this._h=$Lf,this._image=$Lr,this._format=0===$Lt?$Lr.byteLength/($LA*$Lf)==4?6408:6407:$Lt}this._$5__enableMerageInAtlas=!0}}$LX($LG,"laya.webgl.resource.WebGLImage",$Lc);var $Li=$LG.prototype;return $Lu.imps($Li,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$Li._init_=function($Lr,$Li){},$Li._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $Lr=$Lar.mainContext,$Li=this._source=$Lr.createTexture(),$Lt=$LDr.curBindTexTarget,$L_=$LDr.curBindTexValue;$LDr.bindTexture($Lr,3553,$Li);var $LA=this.minFifter,$Lf=this.magFifter,$LE=this.repeat?10497:33071,$LG=$Lg.isPOT(this._w,this._h),$LN=!1;switch($LG?(this.mipmap?-1!==$LA||($LA=9987):-1!==$LA||($LA=9729),-1!==$Lf||($Lf=9729),$Lr.texParameteri(3553,10241,$LA),$Lr.texParameteri(3553,10240,$Lf),$Lr.texParameteri(3553,10242,$LE),$Lr.texParameteri(3553,10243,$LE),this.mipmap&&$Lr.generateMipmap(3553)):(-1!==$LA||($LA=9729),-1!==$Lf||($Lf=9729),$Lr.texParameteri(3553,10241,$LA),$Lr.texParameteri(3553,10240,$Lf),$Lr.texParameteri(3553,10242,33071),$Lr.texParameteri(3553,10243,33071)),$Lr.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&$Lr.pixelStorei($Lr.UNPACK_ALIGNMENT,1),$Lr.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&$Lr.pixelStorei($Lr.UNPACK_ALIGNMENT,1),$Lr.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:$LN=!0,$Lr.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case $Lar.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$LN=!0,$Lr.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}$Lr.pixelStorei(37441,!1),$Lt&&$L_&&$LDr.bindTexture($Lr,$Lt,$L_),this.uri||(this.uri=this._url),$LN?this.memorySize=this._image.length:$LG&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},$Li.recreateResource=function(){var $Lr=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var $Li=this;this._image=new $Lv.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if($Li._needReleaseAgain)return $Li._needReleaseAgain=!1,$Li._image.onload=null,void($Li._image=null);$Li._allowMerageInAtlas&&$Li._enableMerageInAtlas?($Lr.memorySize=0,$Lr._recreateLock=!1):$Li._createWebGlTexture(),$Li.completeCreate()},this._image.src=this._src}},$Li.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&$Lar.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},$Li.onresize=function(){this._w=this._image.width,this._h=this._image.height,$LT.enabled&&this._w<$LT.atlasLimitWidth&&this._h<$LT.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},$Li.clearAtlasSource=function(){this._image=null},$L_(0,$Li,"format",function(){return this._format}),$L_(0,$Li,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function($Lr){this._$5__enableMerageInAtlas=$Lr}),$L_(0,$Li,"mipmap",function(){return this._mipmap}),$L_(0,$Li,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$L_(0,$Li,"atlasSource",function(){return this._image}),$L_(0,$Li,"onload",null,function($Lr){var $Li=this;this._onload=$Lr,this._image&&(this._image.onload=null!=this._onload?function(){$Li.onresize(),$Li._onload()}:null)}),$L_(0,$Li,"onerror",null,function($Lr){var $Li=this;this._onerror=$Lr,this._image&&(this._image.onerror=null!=this._onerror?function(){$Li._onerror()}:null)}),$LG}();$Lu.__init([$Lvr,$Lm,$Lwr,$Lnr])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($Lr,$Li){"use strict";for(var $Lt in Object.defineProperty($Li,"__esModule",{value:!0}),Laya){var $L_=Laya[$Lt];$L_&&$L_.__isclass&&($Li[$Lt]=$L_)}}),function($Lf,$Lr,$L_){$L_.un,$L_.uns;var $LA=$L_.static,$LE=$L_.class,$LG=$L_.getset,$LN=($L_.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),$LO=laya.utils.ClassUtils,$LR=(laya.events.Event,laya.utils.HTMLChar),$Lp=laya.net.Loader,$Lg=(laya.display.Node,laya.maths.Rectangle),$LX=laya.renders.Render,$Lv=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),$Lc=laya.utils.Stat,$LV=laya.display.Text,$LB=laya.resource.Texture,$Ly=laya.net.URL,$LC=laya.utils.Utils,$Ln=function(){function $Lv(){}return $LE($Lv,"laya.html.utils.HTMLParse"),$Lv.parse=function($Lr,$Li,$Lt){$Li=($Li="<root>"+($Li=$Li.replace(/<br>/g,"<br/>"))+"</root>").replace($Lv.spacePattern,$Lv.char255);var $L_=$LC.parseXMLFromString($Li);$Lv._parseXML($Lr,$L_.childNodes[0].childNodes,$Lt)},$Lv._parseXML=function($Lr,$Li,$Lt,$L_){var $LA=0,$Lf=0;if($Li.join||$Li.item)for($LA=0,$Lf=$Li.length;$LA<$Lf;++$LA)$Lv._parseXML($Lr,$Li[$LA],$Lt,$L_);else{var $LE,$LG,$LN;if(3==$Li.nodeType)return void($Lr instanceof laya.html.dom.HTMLDivElement?(null==$Li.nodeName&&($Li.nodeName="#text"),$LG=$Li.nodeName.toLowerCase(),0<($LN=$Li.textContent.replace(/^\s+|\s+$/g,"")).length&&($LE=$LO.getInstance($LG))&&($Lr.addChild($LE),$LE.innerTEXT=$LN.replace($Lv.char255AndOneSpacePattern," "))):0<($LN=$Li.textContent.replace(/^\s+|\s+$/g,"")).length&&($Lr.innerTEXT=$LN.replace($Lv.char255AndOneSpacePattern," ")));if("#comment"==($LG=$Li.nodeName.toLowerCase()))return;if($LE=$LO.getInstance($LG)){($LE=$Lr.addChild($LE)).URI=$Lt,$LE.href=$L_;var $Lp=$Li.attributes;if($Lp&&0<$Lp.length)for($LA=0,$Lf=$Lp.length;$LA<$Lf;++$LA){var $Lg=$Lp[$LA],$LR=$Lg.nodeName,$LX=$Lg.value;$LE._setAttributes($LR,$LX)}$Lv._parseXML($LE,$Li.childNodes,$Lt,$LE.href)}else $Lv._parseXML($Lr,$Li.childNodes,$Lt,$L_)}},$Lv.char255=String.fromCharCode(255),$Lv.spacePattern=/&nbsp;|&#160;/g,$Lv.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),$Lv}(),$La=function(){function $Lb(){}return $LE($Lb,"laya.html.utils.Layout"),$Lb.later=function($Lr){null==$Lb._will&&($Lb._will=[],$L_.stage.frameLoop(1,null,function(){if(!($Lb._will.length<1)){for(var $Lr=0;$Lr<$Lb._will.length;$Lr++)laya.html.utils.Layout.layout($Lb._will[$Lr]);$Lb._will.length=0}})),$Lb._will.push($Lr)},$Lb.layout=function($Lr){if(!$Lr||!$Lr._style)return null;if(0==(512&$Lr._style._type))return null;$Lr.getStyle()._type&=-513;var $Li=$Lb._multiLineLayout($Lr);return $LX.isConchApp&&$Lr.layaoutCallNative&&$Lr.layaoutCallNative(),$Li},$Lb._multiLineLayout=function($Lr){if($LV.RightToLeft)return $Lb._multiLineLayout2($Lr);var $Li=new Array;$Lr._addChildsToLayout($Li);var $Lt,$L_,$LA,$Lf,$LE,$LG=0,$LN=$Li.length,$Lp=$Lr._getCSSStyle(),$Lg=$Lp.letterSpacing,$LR=$Lp.leading,$LX=$Lp.lineHeight,$Lv=$Lp._widthAuto()||!$Lp.wordWrap,$LO=$Lv?999999:$Lr.width,$Lc=($Lr.height,0),$LB=$Lp.italic?$Lp.fontSize/3:0,$Ly=$Lp._getAlign(),$LC=$Lp._getValign(),$Ln=0!==$LC||0!==$Ly||0!=$LX,$La=0,$LD=0,$Lu=0,$Lw=0,$LH=new Array,$Ls=$LH[0]=new $Lh,$Ld=!1,$Ll=!1;$Ls.h=0,$Lp.italic&&($LO-=$Lp.fontSize/3);var $LU=0,$Lk=!0;function $Le(){$Ls.y=$LD,$LD+=$Ls.h+$LR,0==$Ls.h&&($LD+=$LX),$Ls.mWidth=$LU,$LU=0,$Ls=new $Lh,$LH.push($Ls),$Ls.h=0,$Ld=!($Lk=!($La=0))}for($LG=0;$LG<$LN;$LG++)if(null!=($Lt=$Li[$LG]))if($Lk=!1,$Lt instanceof laya.html.dom.HTMLBrElement)$Le(),$Ls.y=$LD;else{if($Lt._isChar()){if(($Lf=$Lt).isWord)$Ld=$Ll||"\n"===$Lf.char,$Ls.wordStartIndex=$Ls.elements.length;else{if($Lu=$Lf.width+$Lf.style.letterSpacin,0<$LH.length&&$LO<$La+$Lu&&0<$Ls.wordStartIndex){var $LL;$LL=$Ls.elements.length-$Ls.wordStartIndex+1,$Ls.elements.length=$Ls.wordStartIndex,$LG-=$LL,$Le();continue}$Ld=!1,$LU+=$Lf.width}$Lu=$Lf.width+$Lg,$Lw=$Lf.height,$Ll=!1,($Ld=$Ld||$LO<$La+$Lu)&&$Le(),$Ls.minTextHeight=Math.min($Ls.minTextHeight,$Lt.height)}else $L_=$Lt._getCSSStyle(),$LE=$Lt,$LA=$L_.padding,0===$L_._getCssFloat()||($Ln=!0),$Ld=$Ll||$L_.lineElement,$Lu=$LE.width*$LE._style._tf.scaleX+$LA[1]+$LA[3]+$Lg,$Lw=$LE.height*$LE._style._tf.scaleY+$LA[0]+$LA[2],$Ll=$L_.lineElement,($Ld=$Ld||$LO<$La+$Lu&&$L_.wordWrap)&&$Le();$Ls.elements.push($Lt),$Ls.h=Math.max($Ls.h,$Lw),$Lt.x=$La,$Lt.y=$LD,$La+=$Lu,$Ls.w=$La-$Lg,$Ls.y=$LD,$Lc=Math.max($La+$LB,$Lc)}else $Lk||($La+=$Lb.DIV_ELEMENT_PADDING),$Ls.wordStartIndex=$Ls.elements.length;if($LD=$Ls.y+$Ls.h,$Ln){var $LQ=0,$LF=$LO;for($Lv&&0<$Lr.width&&($LF=$Lr.width),$LG=0,$LN=$LH.length;$LG<$LN;$LG++)$LH[$LG].updatePos(0,$LF,$LG,$LQ,$Ly,$LC,$LX),$LQ+=Math.max($LX,$LH[$LG].h+$LR);$LD=$LQ}return $Lv&&($Lr.width=$Lc),$LD>$Lr.height&&($Lr.height=$LD),[$Lc,$LD]},$Lb._multiLineLayout2=function($Lr){var $Li=new Array;$Lr._addChildsToLayout($Li);var $Lt,$L_,$LA,$Lf,$LE,$LG=0,$LN=$Li.length,$Lp=$Lr._getCSSStyle(),$Lg=$Lp.letterSpacing,$LR=$Lp.leading,$LX=$Lp.lineHeight,$Lv=$Lp._widthAuto()||!$Lp.wordWrap,$LO=$Lv?999999:$Lr.width,$Lc=($Lr.height,0),$LB=$Lp.italic?$Lp.fontSize/3:0,$Ly=2-$Lp._getAlign(),$LC=$Lp._getValign(),$Ln=0!==$LC||0!=$Ly||0!=$LX,$La=0,$LD=0,$Lu=0,$Lw=0,$LH=new Array,$Ls=$LH[0]=new $Lh,$Ld=!1,$Ll=!1;$Ls.h=0,$Lp.italic&&($LO-=$Lp.fontSize/3);var $LU=0,$Lk=!0;function $Le(){$Ls.y=$LD,$LD+=$Ls.h+$LR,0==$Ls.h&&($LD+=$LX),$Ls.mWidth=$LU,$LU=0,$Ls=new $Lh,$LH.push($Ls),$Ls.h=0,$Ld=!($Lk=!($La=0))}for($LG=0;$LG<$LN;$LG++)if(null!=($Lt=$Li[$LG]))if($Lk=!1,$Lt instanceof laya.html.dom.HTMLBrElement)$Le(),$Ls.y=$LD;else{if($Lt._isChar()){if(($Lf=$Lt).isWord)$Ld=$Ll||"\n"===$Lf.char,$Ls.wordStartIndex=$Ls.elements.length;else{if(0<$LH.length&&$LO<$La+$Lu&&0<$Ls.wordStartIndex){var $LL;$LL=$Ls.elements.length-$Ls.wordStartIndex+1,$Ls.elements.length=$Ls.wordStartIndex,$LG-=$LL,$Le();continue}$Ld=!1,$LU+=$Lf.width}$Lu=$Lf.width+$Lg,$Lw=$Lf.height,$Ll=!1,($Ld=$Ld||$LO<$La+$Lu)&&$Le(),$Ls.minTextHeight=Math.min($Ls.minTextHeight,$Lt.height)}else $L_=$Lt._getCSSStyle(),$LE=$Lt,$LA=$L_.padding,0===$L_._getCssFloat()||($Ln=!0),$Ld=$Ll||$L_.lineElement,$Lu=$LE.width*$LE._style._tf.scaleX+$LA[1]+$LA[3]+$Lg,$Lw=$LE.height*$LE._style._tf.scaleY+$LA[0]+$LA[2],$Ll=$L_.lineElement,($Ld=$Ld||$LO<$La+$Lu&&$L_.wordWrap)&&$Le();$Ls.elements.push($Lt),$Ls.h=Math.max($Ls.h,$Lw),$Lt.x=$La,$Lt.y=$LD,$La+=$Lu,$Ls.w=$La-$Lg,$Ls.y=$LD,$Lc=Math.max($La+$LB,$Lc)}else $Lk||($La+=$Lb.DIV_ELEMENT_PADDING),$Ls.wordStartIndex=$Ls.elements.length;if($LD=$Ls.y+$Ls.h,$Ln){var $LQ=0,$LF=$LO;for($LG=0,$LN=$LH.length;$LG<$LN;$LG++)$LH[$LG].updatePos(0,$LF,$LG,$LQ,$Ly,$LC,$LX),$LQ+=Math.max($LX,$LH[$LG].h+$LR);$LD=$LQ}for($Lv&&($Lr.width=$Lc),$LD>$Lr.height&&($Lr.height=$LD),$LG=0,$LN=$LH.length;$LG<$LN;$LG++)$LH[$LG].revertOrder($LO);return[$Lc,$LD]},$Lb._will=null,$Lb.DIV_ELEMENT_PADDING=0,$Lb}(),$Lh=function(){function $Lr(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}$LE($Lr,"laya.html.utils.LayoutLine");var $Li=$Lr.prototype;return $Li.updatePos=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){var $LG,$LN=0;0<this.elements.length&&($LN=($LG=this.elements[this.elements.length-1]).x+$LG.width-this.elements[0].x);var $Lp=0,$Lg=NaN;1===$LA&&($Lp=($Li-$LN)/2),2===$LA&&($Lp=$Li-$LN),0===$LE||0!=$Lf||($Lf=1);for(var $LR=0,$LX=this.elements.length;$LR<$LX;$LR++){var $Lv=($LG=this.elements[$LR])._getCSSStyle();switch(0!==$Lp&&($LG.x+=$Lp),$Lv._getValign()){case 0:$LG.y=$L_;break;case 1:var $LO=0;99999!=this.minTextHeight&&($LO=this.minTextHeight);var $Lc=($LO+$LE)/2;$Lc=Math.max($Lc,this.h),$Lg=(laya.html.dom.HTMLImageElement,$L_+$Lc-$LG.height),$LG.y=$Lg;break;case 2:$LG.y=$L_+($LE-$LG.height)}}},$Li.revertOrder=function($Lr){var $Li;if(0<this.elements.length){var $Lt,$L_=0;for($Lt=this.elements.length,$L_=0;$L_<$Lt;$L_++)($Li=this.elements[$L_]).x=$Lr-$Li.x-$Li.width}},$Lr}(),$LD=function($Lt){function $Li(){this.URI=null,this._href=null,$Li.__super.call(this),this._text=$Li._EMPTYTEXT,this.setStyle(new $LN(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}$LE($Li,"laya.html.dom.HTMLElement",$Lt);var $Lr=$Li.prototype;return $Lr.layaoutCallNative=function(){var $Lr=0;if(this._childs&&0<($Lr=this._childs.length))for(var $Li=0;$Li<$Lr;$Li++)this._childs[$Li].layaoutCallNative&&this._childs[$Li].layaoutCallNative();var $Lt=this._getWords();$Lt?laya.html.dom.HTMLElement.fillWords(this,$Lt,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},$Lr.appendChild=function($Lr){return this.addChild($Lr)},$Lr._getWords2=function(){var $Lr=this._text.text;if(!$Lr||0===$Lr.length)return null;var $Li,$Lt,$L_=0,$LA=0;if(this._text.drawWords)$Lt=this._text.drawWords;else{for($LA=($Li=$Lr.split(" ")).length-1,$Lt=[],$L_=0;$L_<$LA;$L_++)$Lt.push($Li[$L_]," ");0<=$LA&&$Lt.push($Li[$LA]),this._text.drawWords=$Lt}var $Lf,$LE=this._text.words;if($LE&&$LE.length===$Lt.length)return $LE;null===$LE&&(this._text.words=$LE=[]),$LE.length=$Lt.length;var $LG=this.style,$LN=$LG.font;for($L_=0,$LA=$Lt.length;$L_<$LA;$L_++){$Lf=$LC.measureText($Lt[$L_],$LN);var $Lp=$LE[$L_]=new $LR($Lt[$L_],$Lf.width,$Lf.height||$LG.fontSize,$LG);if(1<$Lp.char.length&&($Lp.charNum=$Lp.char),this.href){var $Lg=new $Lv;this.addChild($Lg),$Lp.setSprite($Lg)}}return $LE},$Lr._getWords=function(){if(!$LV.CharacterCache)return this._getWords2();var $Lr=this._text.text;if(!$Lr||0===$Lr.length)return null;var $Li,$Lt=this._text.words;if($Lt&&$Lt.length===$Lr.length)return $Lt;null===$Lt&&(this._text.words=$Lt=[]),$Lt.length=$Lr.length;for(var $L_=this.style,$LA=$L_.font,$Lf=0,$LE=$Lr.length;$Lf<$LE;$Lf++)if($Li=$LC.measureText($Lr.charAt($Lf),$LA)){var $LG=$Lt[$Lf]=new $LR($Lr.charAt($Lf),$Li.width,$Li.height||$L_.fontSize,$L_);if(this.href){var $LN=new $Lv;this.addChild($LN),$LG.setSprite($LN)}}else console.warn("_getWords size is null"+$Lr.charAt($Lf),$LA);return $Lt},$Lr.showLinkSprite=function(){var $Lr=this._text.words;if($Lr)for(var $Li,$Lt,$L_=[],$LA=0;$LA<$Lr.length;$LA++)$Lt=$Lr[$LA],($Li=new $Lv).graphics.drawRect(0,0,$Lt.width,$Lt.height,"#ff0000"),$Li.width=$Lt.width,$Li.height=$Lt.height,this.addChild($Li),$L_.push($Li)},$Lr._layoutLater=function(){var $Lr=this.style;512&$Lr._type||($Lr.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&$Lr.block?($La.later(this),$Lr._type|=512):this.parent&&this.parent._layoutLater())},$Lr._setAttributes=function($Lr,$Li){switch($Lr){case"style":return void this.style.cssText($Li);case"class":return void(this.className=$Li)}$Lt.prototype._setAttributes.call(this,$Lr,$Li)},$Lr.updateHref=function(){if(null!=this._href){var $Lr=this._getWords();if($Lr)for(var $Li,$Lt,$L_=0;$L_<$Lr.length;$L_++)($Lt=($Li=$Lr[$L_]).getSprite())&&($Lt.size($Li.width,$Li.height),$Lt.on("click",this,this.onLinkHandler))}},$Lr.onLinkHandler=function($Lr){switch($Lr.type){case"click":for(var $Li=this;$Li;)$Li.event("link",[this.href]),$Li=$Li.parent}},$Lr.formatURL=function($Lr){return this.URI?$Ly.formatURL($Lr,this.URI?this.URI.path:null):$Lr},$LG(0,$Lr,"href",function(){return this._href},function($Lr){null!=(this._href=$Lr)&&(this._getCSSStyle().underLine=1,this.updateHref())}),$LG(0,$Lr,"color",null,function($Lr){this.style.color=$Lr}),$LG(0,$Lr,"onClick",null,function($Lr){$L_._runScript("fn=function(event){"+$Lr+";}"),this.on("click",this,void 0)}),$LG(0,$Lr,"id",null,function($Lr){$Lu.document.setElementById($Lr,this)}),$LG(0,$Lr,"innerTEXT",function(){return this._text.text},function($Lr){this.text=$Lr}),$LG(0,$Lr,"style",function(){return this._style}),$LG(0,$Lr,"text",function(){return this._text.text},function($Lr){this._text==$Li._EMPTYTEXT?this._text={text:$Lr,words:null}:(this._text.text=$Lr,this._text.words&&(this._text.words.length=0)),$LX.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),$LG(0,$Lr,"parent",$Lt.prototype._$get_parent,function($Lr){if($Lr instanceof laya.html.dom.HTMLElement){var $Li=$Lr;this.URI||(this.URI=$Li.URI),this.style.inherit($Li.style)}$L_.superSet($Lv,this,"parent",$Lr)}),$LG(0,$Lr,"className",null,function($Lr){this.style.attrs($Lu.document.styleSheets["."+$Lr])}),$Li.fillWords=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){$Lr.graphics.clear();for(var $LG=0,$LN=$Li.length;$LG<$LN;$LG++){var $Lp=$Li[$LG];$Lr.graphics.fillText($Lp.char,$Lp.x+$Lt,$Lp.y+$L_,$LA,$Lf,"left",$LE)}},$Li._EMPTYTEXT={text:null,words:null},$Li}($Lv),$Li=(function($Lr){function $Li(){$Li.__super.call(this),this.style.lineElement=!0,this.style.block=!0}$LE($Li,"laya.html.dom.HTMLBrElement",$LD)}(),function($Lr){function $Li(){this.contextHeight=NaN,this.contextWidth=NaN,$Li.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}$LE($Li,"laya.html.dom.HTMLDivElement",$Lr);var $Lt=$Li.prototype;return $Lt.appendHTML=function($Lr){$Ln.parse(this,$Lr,this.URI),this.layout()},$Lt._addChildsToLayout=function($Li){var $Lr=this._getWords();if(null==$Lr&&0==this._childs.length)return!1;$Lr&&$Lr.forEach(function($Lr){$Li.push($Lr)});for(var $Lt=!0,$L_=0,$LA=this._childs.length;$L_<$LA;$L_++){var $Lf=this._childs[$L_];$Lt?$Lt=!1:$Li.push(null),$Lf._addToLayout($Li)}return!0},$Lt._addToLayout=function($Lr){this.layout()},$Lt.layout=function(){if(this.style){this.style._type|=512;var $Lr=$La.layout(this);if($Lr){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new $Lg);var $Li=this._$P.mHtmlBounds;$Li.x=$Li.y=0,$Li.width=this.contextWidth=$Lr[0],$Li.height=this.contextHeight=$Lr[1],this.setBounds($Li)}}},$LG(0,$Lt,"height",function(){return this._height?this._height:this.contextHeight},$Lr.prototype._$set_height),$LG(0,$Lt,"innerHTML",null,function($Lr){this.destroyChildren(),this.appendHTML($Lr)}),$LG(0,$Lt,"width",function(){return this._width?this._width:this.contextWidth},function($Lr){var $Li=!1;$Li=0===$Lr?$Lr!=this._width:$Lr!=this.width,$L_.superSet($LD,this,"width",$Lr),$Li&&this.layout()}),$Li}($LD)),$Lu=function($Lr){function $Li(){this.all=new Array,this.styleSheets=$LN.styleSheets,$Li.__super.call(this)}$LE($Li,"laya.html.dom.HTMLDocument",$LD);var $Lt=$Li.prototype;return $Lt.getElementById=function($Lr){return this.all[$Lr]},$Lt.setElementById=function($Lr,$Li){this.all[$Lr]=$Li},$LA($Li,["document",function(){return this.document=new $Li}]),$Li}();(function($Lr){function $Li(){this._tex=null,this._url=null,this._renderArgs=[],$Li.__super.call(this),this.style.block=!0}$LE($Li,"laya.html.dom.HTMLImageElement",$LD);var $Lt=$Li.prototype;$Lt._addToLayout=function($Lr){!this._style.absolute&&$Lr.push(this)},$Lt.render=function($Lr,$Li,$Lt){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||($Lc.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,$Lr.ctx.drawTexture2($Li,$Lt,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},$Lt.layaoutCallNative=function(){var $Lr=0;if(this._childs&&0<($Lr=this._childs.length))for(var $Li=0;$Li<$Lr;$Li++)this._childs[$Li].layaoutCallNative&&this._childs[$Li].layaoutCallNative()},$LG(0,$Lt,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($Lr){this._width!==$Lr&&(this._width=$Lr,this._style.width=$Lr,this.repaint())}),$LG(0,$Lt,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($Lr){this._height!==$Lr&&(this._height=$Lr,this._style.height=$Lr,this.repaint())}),$Lt.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),$Lp.clearCache(this,this._url),this._tex=null),$LD.prototype.destroy.call(this)},$Lt.onloaded=function(){var $Lr=this._style;$Lr&&!$Lr.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),$Lr&&!$Lr.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),$LX.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},$Lt._loadImageComplete=function($Lr,$Li,$Lt){if(!this._destroyed)if(null!=$Lt)if($Lt instanceof ArrayBuffer){var $L_=new DataView($Lt);new laya.webgl.resource.WebGLImage(new Uint8Array($Lt,8),$Lr,0,!1,$L_.getUint32(0),$L_.getUint32(4));this.onloaded()}else if($Lt instanceof $LB)$Lp.imgMgrSet[$Lr]=$Li,$Lf.imgMgrLock($Lr,$Lp.imgMgrSet[$Lr]),this._url=$Lr,this._tex=$Lt,$Lp.keepCache(this,$Lr),$Lp.cacheRes($Lr,this._tex),this.onloaded();else{var $LA=-1!=$Lr.indexOf(".png",$Lr.length-4)?6408:6407;new laya.webgl.resource.WebGLImage($Lt,$Lr,$LA,!1,$Lt.width,$Lt.height);this.onloaded()}else this.event("error","Load image failed")},$LG(0,$Lt,"src",null,function($Lr){($Lr=this.formatURL($Lr),this._url!=$Lr)&&(null!=this._tex&&($Lp.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=$Lr,(this._tex=$Lp.getRes($Lr))?($Lp.keepCache(this,$Lr),this.onloaded()):$Lf.imgMgrLoad($Lr,this._loadImageComplete.bind(this),2,!1))})})(),function($Lr){function $Li(){this.type=null,$Li.__super.call(this),this.visible=!1}$LE($Li,"laya.html.dom.HTMLLinkElement",$Lr);var $Lt=$Li.prototype;$Lt._onload=function($Lr){switch(this.type){case"text/css":$LN.parseCSS($Lr,this.URI)}},$LG(0,$Lt,"href",$Lr.prototype._$get_href,function($Lr){var $Li=this;$Lr=this.formatURL($Lr),this.URI=new $Ly($Lr);var $Lt=new $Lp;$Lt.once("complete",null,function($Lr){$Li._onload($Lr)}),$Lt.load($Lr,"text")}),$Li._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}($LD),function($Lr){function $Li(){$Li.__super.call(this),this.visible=!1}$LE($Li,"laya.html.dom.HTMLStyleElement",$Lr),$LG(0,$Li.prototype,"text",$Lr.prototype._$get_text,function($Lr){$LN.parseCSS($Lr,null)})}($LD),function($Lr){function $Li(){$Li.__super.call(this),this._getCSSStyle().valign="middle"}$LE($Li,"laya.html.dom.HTMLIframeElement",$Lr),$LG(0,$Li.prototype,"href",$Lr.prototype._$get_href,function($Lt){var $L_=this;$Lt=this.formatURL($Lt);var $Lr=new $Lp;$Lr.once("complete",null,function($Lr){var $Li=$L_.URI;$L_.URI=new $Ly($Lt),$L_.innerHTML=$Lr,!$Li||($L_.URI=$Li)}),$Lr.load($Lt,"text")})}($Li)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($Lr,$Li){"use strict";for(var $Lt in Object.defineProperty($Li,"__esModule",{value:!0}),Laya){var $L_=Laya[$Lt];$L_&&$L_.__isclass&&($Li[$Lt]=$L_)}}),function($LA,$Lr,$Lc){$Lc.un,$Lc.uns;var $L_=$Lc.static,$Lf=$Lc.class,$LE=$Lc.getset,$Lt=($Lc.__newvec,laya.display.Animation),$LB=(laya.utils.Browser,laya.utils.ClassUtils),$LG=laya.filters.ColorFilter,$LN=laya.utils.Ease,$Lp=laya.events.Event,$Lg=(laya.events.EventDispatcher,laya.display.css.Font),$LR=laya.display.FrameAnimation,$Li=laya.display.Graphics,$LX=laya.utils.Handler,$Lv=laya.display.Input,$LC=laya.net.Loader,$LO=(laya.display.Node,laya.maths.Point),$Ly=laya.maths.Rectangle,$Ln=laya.renders.Render,$La=laya.display.Sprite,$LD=laya.display.Text,$Lu=laya.resource.Texture,$Lw=laya.utils.Tween,$LH=laya.utils.Utils,$Ls=laya.utils.WeakObject;$Lc.interface("laya.ui.IItem"),$Lc.interface("laya.ui.ISelect"),$Lc.interface("laya.ui.IRender"),$Lc.interface("laya.ui.IComponent"),$Lc.interface("laya.ui.IBox","IComponent");var $Ld=function(){function $Lr(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return $Lf($Lr,"laya.ui.LayoutStyle"),$L_($Lr,["EMPTY",function(){return this.EMPTY=new $Lr}]),$Lr}(),$Ll=function(){function $Lr(){}return $Lf($Lr,"laya.ui.Styles"),$Lr.labelColor="#000000",$Lr.buttonStateNum=3,$Lr.scrollBarMinNum=15,$Lr.scrollBarDelayTime=500,$L_($Lr,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),$Lr}(),$LU=function(){function $LA(){}return $Lf($LA,"laya.ui.UIUtils"),$LA.fillArray=function($Lr,$Li,$Lt){var $L_=$Lr.concat();if($Li)for(var $LA=$Li.split(","),$Lf=0,$LE=Math.min($L_.length,$LA.length);$Lf<$LE;$Lf++){var $LG=$LA[$Lf];$L_[$Lf]="true"==$LG||"false"!=$LG&&$LG,null!=$Lt&&($L_[$Lf]=$Lt($LG))}return $L_},$LA.toColor=function($Lr){return $LH.toHexColor($Lr)},$LA.gray=function($Lr,$Li){void 0===$Li&&($Li=!0),$Li?$LA.addFilter($Lr,$LA.grayFilter):$LA.clearFilter($Lr,$LG)},$LA.addFilter=function($Lr,$Li){var $Lt=$Lr.filters||[];$Lt.push($Li),$Lr.filters=$Lt},$LA.clearFilter=function($Lr,$Li){var $Lt=$Lr.filters;if(null!=$Lt&&0<$Lt.length){for(var $L_=$Lt.length-1;-1<$L_;$L_--){var $LA=$Lt[$L_];$Lc.__typeof($LA,$Li)&&$Lt.splice($L_,1)}$Lr.filters=$Lt}},$LA._getReplaceStr=function($Lr){return $LA.escapeSequence[$Lr]},$LA.adptString=function($Lr){return $Lr.replace(/\\(\w)/g,$LA._getReplaceStr)},$LA.getBindFun=function($Lr){var $Li=$LA._funMap.get($Lr);if(null==$Li){var $Lt='"'+$Lr+'"',$L_="(function(data){if(data==null)return;with(data){try{\nreturn "+($Lt=$Lt.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";$Li=$Lc._runScript($L_),$LA._funMap.set($Lr,$Li)}return $Li},$L_($LA,["grayFilter",function(){return this.grayFilter=new $LG([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new $Ls}]),$LA}(),$Lk=function(){function $Lr(){}return $Lf($Lr,"UIConfig"),$Lr.touchScrollEnable=!0,$Lr.mouseWheelEnable=!0,$Lr.showButtons=!0,$Lr.popupBgColor="#000000",$Lr.popupBgAlpha=.5,$Lr.closeDialogOnSide=!0,$Lr}(),$Le=function($Lt){function $Ly(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,$Ly.__super.call(this),this._weakKeys=[]}$Lf($Ly,"laya.ui.AutoBitmap",$Lt);var $Lr=$Ly.prototype;return $Lr.destroy=function(){if($LC.clearObject(this,this._weakKey),this._weakKeys){for(var $Lr=0,$Li=this._weakKeys.length;$Lr<$Li;++$Lr)$LC.clearObject(this,this._weakKeys[$Lr]);this._weakKeys=null}$Lt.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},$Lr._setChanged=function(){this._isChanged||(this._isChanged=!0,$Lc.timer.callLater(this,this.changeSource))},$Lr.changeSource=function(){this._isChanged=!1;var $Lr=this._source;if($Lr&&$Lr.bitmap){var $Li=this.width,$Lt=this.height,$L_=this._sizeGrid,$LA=$Lr.sourceWidth,$Lf=$Lr.sourceHeight;if(!$L_||$LA===$Li&&$Lf===$Lt)this.cleanByTexture($Lr,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,$Li,$Lt);else{$LC.clearObject(this,this._weakKey),$Lr.$_GID||($Lr.$_GID=$LH.getGID());var $LE=$Lr.$_GID+"."+$Li+"."+$Lt+"."+$L_.join("."),$LG=$LC.findObject($LE);if($LH.isOKCmdList($LG))return this._weakKey=$LE,$LC.keepObject(this,this._weakKey),void(this.cmds=$LG);this.clear();var $LN,$Lp,$Lg=$L_[0],$LR=$L_[1],$LX=$L_[2],$Lv=$L_[3],$LO=$L_[4],$Lc=!1;if($Li==$LA&&($Lv=$LR=0),$Lt==$Lf&&($Lg=$LX=0),$Li<$Lv+$LR){var $LB=$Li;$Lc=!0,$Li=$Lv+$LR,this.save(),this.clipRect(0,0,$LB,$Lt)}$Lv&&$Lg&&($LN=$Ly.getTexture($Lr,0,0,$Lv,$Lg),$Lp=this._weakKeys[0],$LN?($Lp!=$LN.weakKey&&($LC.clearObject(this,$Lp),$LC.keepObject(this,$LN.weakKey),this._weakKeys[0]=$LN.weakKey),this.drawTexture($LN,0,0,$Lv,$Lg)):($LC.clearObject(this,$Lp),this._weakKeys[0]="")),$LR&&$Lg&&($LN=$Ly.getTexture($Lr,$LA-$LR,0,$LR,$Lg),$Lp=this._weakKeys[1],$LN?($Lp!=$LN.weakKey&&($LC.clearObject(this,$Lp),$LC.keepObject(this,$LN.weakKey),this._weakKeys[1]=$LN.weakKey),this.drawTexture($LN,$Li-$LR,0,$LR,$Lg)):($LC.clearObject(this,$Lp),this._weakKeys[1]="")),$Lv&&$LX&&($LN=$Ly.getTexture($Lr,0,$Lf-$LX,$Lv,$LX),$Lp=this._weakKeys[2],$LN?($Lp!=$LN.weakKey&&($LC.clearObject(this,$Lp),$LC.keepObject(this,$LN.weakKey),this._weakKeys[2]=$LN.weakKey),this.drawTexture($LN,0,$Lt-$LX,$Lv,$LX)):($LC.clearObject(this,$Lp),this._weakKeys[2]="")),$LR&&$LX&&($LN=$Ly.getTexture($Lr,$LA-$LR,$Lf-$LX,$LR,$LX),$Lp=this._weakKeys[3],$LN?($Lp!=$LN.weakKey&&($LC.clearObject(this,$Lp),$LC.keepObject(this,$LN.weakKey),this._weakKeys[3]=$LN.weakKey),this.drawTexture($LN,$Li-$LR,$Lt-$LX,$LR,$LX)):($LC.clearObject(this,$Lp),this._weakKeys[3]="")),$Lg&&($LN=$Ly.getTexture($Lr,$Lv,0,$LA-$Lv-$LR,$Lg),$Lp=this._weakKeys[4],$LN?($Lp!=$LN.weakKey&&($LC.clearObject(this,$Lp),$LC.keepObject(this,$LN.weakKey),this._weakKeys[4]=$LN.weakKey),this.drawBitmap($LO,$LN,$Lv,0,$Li-$Lv-$LR,$Lg)):($LC.clearObject(this,$Lp),this._weakKeys[4]="")),$LX&&($LN=$Ly.getTexture($Lr,$Lv,$Lf-$LX,$LA-$Lv-$LR,$LX),$Lp=this._weakKeys[5],$LN?($Lp!=$LN.weakKey&&($LC.clearObject(this,$Lp),$LC.keepObject(this,$LN.weakKey),this._weakKeys[5]=$LN.weakKey),this.drawBitmap($LO,$LN,$Lv,$Lt-$LX,$Li-$Lv-$LR,$LX)):($LC.clearObject(this,$Lp),this._weakKeys[5]="")),$Lv&&($LN=$Ly.getTexture($Lr,0,$Lg,$Lv,$Lf-$Lg-$LX),$Lp=this._weakKeys[6],$LN?($Lp!=$LN.weakKey&&($LC.clearObject(this,$Lp),$LC.keepObject(this,$LN.weakKey),this._weakKeys[6]=$LN.weakKey),this.drawBitmap($LO,$LN,0,$Lg,$Lv,$Lt-$Lg-$LX)):($LC.clearObject(this,$Lp),this._weakKeys[6]="")),$LR&&($LN=$Ly.getTexture($Lr,$LA-$LR,$Lg,$LR,$Lf-$Lg-$LX),$Lp=this._weakKeys[7],$LN?($Lp!=$LN.weakKey&&($LC.clearObject(this,$Lp),$LC.keepObject(this,$LN.weakKey),this._weakKeys[7]=$LN.weakKey),this.drawBitmap($LO,$LN,$Li-$LR,$Lg,$LR,$Lt-$Lg-$LX)):($LC.clearObject(this,$Lp),this._weakKeys[7]="")),$LN=$Ly.getTexture($Lr,$Lv,$Lg,$LA-$Lv-$LR,$Lf-$Lg-$LX),$Lp=this._weakKeys[8],$LN?($Lp!=$LN.weakKey&&($LC.clearObject(this,$Lp),$LC.keepObject(this,$LN.weakKey),this._weakKeys[8]=$LN.weakKey),this.drawBitmap($LO,$LN,$Lv,$Lg,$Li-$Lv-$LR,$Lt-$Lg-$LX)):($LC.clearObject(this,$Lp),this._weakKeys[8]=""),$Lc&&this.restore(),this.autoCacheCmd&&!$Ln.isConchApp&&($LC.saveObject($LE,this.cmds,null),this._weakKey=$LE,$LC.keepObject(this,this._weakKey))}this._repaint()}},$Lr.drawBitmap=function($Lr,$Li,$Lt,$L_,$LA,$Lf){void 0===$LA&&($LA=0),void 0===$Lf&&($Lf=0),$LA<.1||$Lf<.1||(!$Lr||$Li.width==$LA&&$Li.height==$Lf?this.drawTexture($Li,$Lt,$L_,$LA,$Lf):this.fillTexture($Li,$Lt,$L_,$LA,$Lf))},$Lr.clear=function($Lr){void 0===$Lr&&($Lr=!0),$Lt.prototype.clear.call(this,!1)},$LE(0,$Lr,"sizeGrid",function(){return this._sizeGrid},function($Lr){this._sizeGrid=$Lr,this._setChanged()}),$LE(0,$Lr,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function($Lr){this._width!=$Lr&&(this._width=$Lr,this._setChanged())}),$LE(0,$Lr,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function($Lr){this._height!=$Lr&&(this._height=$Lr,this._setChanged())}),$LE(0,$Lr,"source",function(){return this._source},function($Lr){$Lr?(this._source=$Lr,this._setChanged()):(this._source=null,this.clear())}),$Ly.getTexture=function($Lr,$Li,$Lt,$L_,$LA){$L_<=0&&($L_=1),$LA<=0&&($LA=1),$Lr.$_GID||($Lr.$_GID=$LH.getGID());var $Lf=$Lr.$_GID+"."+$Li+"."+$Lt+"."+$L_+"."+$LA,$LE=$LC.findObject($Lf);if((!$LE||!$LE.source)&&($LE=$Lu.createFromTexture($Lr,$Li,$Lt,$L_,$LA))){if($Lr.alphaTexture){var $LG=$Lr.width/$Lr.alphaTexture.width;$LE.alphaTexture=$Lu.createFromTexture($Lr.alphaTexture,$Li/$LG,$Lt/$LG,$L_/$LG,$LA/$LG)}$LC.saveObject($Lf,$LE),$LE.weakKey=$Lf}return $LE},$Ly}($Li),$LL=(function($Lr){function $Li(){$Li.__super.call(this)}$Lf($Li,"laya.ui.UIEvent",$Lp),$Li.SHOW_TIP="showtip",$Li.HIDE_TIP="hidetip"}(),function($Li){function $Lr(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,$Lr.__super.call(this),this._layout=$Ld.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}$Lf($Lr,"laya.ui.Component",$Li);var $Lt=$Lr.prototype;return $Lc.imps($Lt,{"laya.ui.IComponent":!0}),$Lt.destroy=function($Lr){void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,$Lr),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},$Lt.preinitialize=function(){},$Lt.createChildren=function(){},$Lt.initialize=function(){},$Lt.callLater=function($Lr,$Li){$Lc.timer.callLater(this,$Lr,$Li)},$Lt.runCallLater=function($Lr){$Lc.timer.runCallLater(this,$Lr)},$Lt.commitMeasure=function(){},$Lt.changeSize=function(){this.event("resize")},$Lt.getLayout=function(){return this._layout===$Ld.EMPTY&&(this._layout=new $Ld),this._layout},$Lt._setLayoutEnabled=function($Lr){this._layout&&this._layout.enable!=$Lr&&(this._layout.enable=$Lr,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},$Lt.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},$Lt.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},$Lt.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},$Lt.resetLayoutX=function(){var $Lr=this._layout;if(isNaN($Lr.anchorX)||(this.pivotX=$Lr.anchorX*this.width),this.layoutEnabled){var $Li=this.parent;$Li&&(isNaN($Lr.centerX)?isNaN($Lr.left)?isNaN($Lr.right)||(this.x=Math.round($Li.width-this.displayWidth-$Lr.right+this.pivotX*this.scaleX)):(this.x=Math.round($Lr.left+this.pivotX*this.scaleX),isNaN($Lr.right)||(this.width=($Li._width-$Lr.left-$Lr.right)/(this.scaleX||.01))):this.x=Math.round(.5*($Li.width-this.displayWidth)+$Lr.centerX+this.pivotX*this.scaleX))}},$Lt.resetLayoutY=function(){var $Lr=this._layout;if(isNaN($Lr.anchorY)||(this.pivotY=$Lr.anchorY*this.height),this.layoutEnabled){var $Li=this.parent;$Li&&(isNaN($Lr.centerY)?isNaN($Lr.top)?isNaN($Lr.bottom)||(this.y=Math.round($Li.height-this.displayHeight-$Lr.bottom+this.pivotY*this.scaleY)):(this.y=Math.round($Lr.top+this.pivotY*this.scaleY),isNaN($Lr.bottom)||(this.height=($Li._height-$Lr.top-$Lr.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*($Li.height-this.displayHeight)+$Lr.centerY+this.pivotY*this.scaleY))}},$Lt.onMouseOver=function($Lr){$Lc.stage.event("showtip",this._toolTip)},$Lt.onMouseOut=function($Lr){$Lc.stage.event("hidetip",this._toolTip)},$LE(0,$Lt,"displayWidth",function(){return this.width*this.scaleX}),$LE(0,$Lt,"width",function(){return this._width?this._width:this.measureWidth},function($Lr){this._width!=$Lr&&(this._width=$Lr,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),$LE(0,$Lt,"measureWidth",function(){var $Lr=0;this.commitMeasure();for(var $Li=this.numChildren-1;-1<$Li;$Li--){var $Lt=this.getChildAt($Li);$Lt.visible&&($Lr=Math.max($Lt.x+$Lt.width*$Lt.scaleX,$Lr))}return $Lr}),$LE(0,$Lt,"displayHeight",function(){return this.height*this.scaleY}),$LE(0,$Lt,"height",function(){return this._height?this._height:this.measureHeight},function($Lr){this._height!=$Lr&&(this._height=$Lr,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),$LE(0,$Lt,"dataSource",function(){return this._dataSource},function($Lr){for(var $Li in this._dataSource=$Lr,this._dataSource)this.hasOwnProperty($Li)&&"function"!=typeof this[$Li]&&(this[$Li]=this._dataSource[$Li])}),$LE(0,$Lt,"scaleY",$Li.prototype._$get_scaleY,function($Lr){$Lc.superGet($La,this,"scaleY")!=$Lr&&($Lc.superSet($La,this,"scaleY",$Lr),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),$LE(0,$Lt,"measureHeight",function(){var $Lr=0;this.commitMeasure();for(var $Li=this.numChildren-1;-1<$Li;$Li--){var $Lt=this.getChildAt($Li);$Lt.visible&&($Lr=Math.max($Lt.y+$Lt.height*$Lt.scaleY,$Lr))}return $Lr}),$LE(0,$Lt,"scaleX",$Li.prototype._$get_scaleX,function($Lr){$Lc.superGet($La,this,"scaleX")!=$Lr&&($Lc.superSet($La,this,"scaleX",$Lr),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),$LE(0,$Lt,"top",function(){return this._layout.top},function($Lr){$Lr!=this._layout.top&&(this.getLayout().top=$Lr,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$LE(0,$Lt,"bottom",function(){return this._layout.bottom},function($Lr){$Lr!=this._layout.bottom&&(this.getLayout().bottom=$Lr,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$LE(0,$Lt,"left",function(){return this._layout.left},function($Lr){$Lr!=this._layout.left&&(this.getLayout().left=$Lr,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$LE(0,$Lt,"right",function(){return this._layout.right},function($Lr){$Lr!=this._layout.right&&(this.getLayout().right=$Lr,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$LE(0,$Lt,"centerX",function(){return this._layout.centerX},function($Lr){$Lr!=this._layout.centerX&&(this.getLayout().centerX=$Lr,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$LE(0,$Lt,"centerY",function(){return this._layout.centerY},function($Lr){$Lr!=this._layout.centerY&&(this.getLayout().centerY=$Lr,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$LE(0,$Lt,"anchorX",function(){return this._layout.anchorX},function($Lr){$Lr!=this._layout.anchorX&&(this.getLayout().anchorX=$Lr,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$LE(0,$Lt,"anchorY",function(){return this._layout.anchorY},function($Lr){$Lr!=this._layout.anchorY&&(this.getLayout().anchorY=$Lr,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$LE(0,$Lt,"tag",function(){return this._tag},function($Lr){this._tag=$Lr}),$LE(0,$Lt,"toolTip",function(){return this._toolTip},function($Lr){this._toolTip!=$Lr&&(null!=(this._toolTip=$Lr)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),$LE(0,$Lt,"comXml",function(){return this._comXml},function($Lr){this._comXml=$Lr}),$LE(0,$Lt,"gray",function(){return this._gray},function($Lr){$Lr!==this._gray&&(this._gray=$Lr,$LU.gray(this,$Lr))}),$LE(0,$Lt,"disabled",function(){return this._disabled},function($Lr){$Lr!==this._disabled&&(this.gray=this._disabled=$Lr,this.mouseEnabled=!$Lr)}),$Lr}($La)),$LQ=function($Lr){function $Li(){this.lockLayer=null,this.popupEffect=function($Lr){$Lr.scale(1,1),$Lw.from($Lr,{x:$Lc.stage.width/2,y:$Lc.stage.height/2,scaleX:0,scaleY:0},300,$LN.backOut,$LX.create(this,this.doOpen,[$Lr]))},this.closeEffect=function($Lr,$Li){$Lw.to($Lr,{x:$Lc.stage.width/2,y:$Lc.stage.height/2,scaleX:0,scaleY:0},300,$LN.strongOut,$LX.create(this,this.doClose,[$Lr,$Li]))},$Li.__super.call(this),this.maskLayer=new $La,this.popupEffectHandler=$LX.create(this,this.popupEffect,null,!1),this.closeEffectHandler=$LX.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,$Lc.stage.addChild(this),$Lc.stage.on("resize",this,this._onResize),$Lk.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}$Lf($Li,"laya.ui.DialogManager",$La);var $Lt=$Li.prototype;return $Lt._closeOnSide=function(){var $Lr=this.getChildAt(this.numChildren-1);$Lr instanceof laya.ui.Dialog&&$Lr.close("side")},$Lt.setLockView=function($Lr){this.lockLayer||(this.lockLayer=new $LF,this.lockLayer.mouseEnabled=!0,this.lockLayer.size($Lc.stage.width,$Lc.stage.height)),this.lockLayer.removeChildren(),$Lr&&($Lr.centerX=$Lr.centerY=0,this.lockLayer.addChild($Lr))},$Lt._onResize=function($Lr){var $Li=this.maskLayer.width=$Lc.stage.width,$Lt=this.maskLayer.height=$Lc.stage.height;this.lockLayer&&this.lockLayer.size($Li,$Lt),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,$Li,$Lt,$Lk.popupBgColor),this.maskLayer.alpha=$Lk.popupBgAlpha;for(var $L_=this.numChildren-1;-1<$L_;$L_--){var $LA=this.getChildAt($L_);$LA.popupCenter&&this._centerDialog($LA)}},$Lt._centerDialog=function($Lr){$Lr.x=Math.round(($Lc.stage.width-$Lr.width>>1)+$Lr.pivotX),$Lr.y=Math.round(($Lc.stage.height-$Lr.height>>1)+$Lr.pivotY)},$Lt.open=function($Lr,$Li,$Lt){void 0===$Li&&($Li=!1),void 0===$Lt&&($Lt=!1),$Li&&this._closeAll(),$Lr.popupCenter&&this._centerDialog($Lr),this.addChild($Lr),($Lr.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),$Lt&&null!=$Lr.popupEffect?$Lr.popupEffect.runWith($Lr):this.doOpen($Lr),this.event("open")},$Lt.doOpen=function($Lr){$Lr.onOpened()},$Lt.lock=function($Lr){this.lockLayer&&($Lr?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},$Lt.close=function($Lr,$Li,$Lt){void 0===$Lt&&($Lt=!1),$Lt&&null!=$Lr.closeEffect?$Lr.closeEffect.runWith([$Lr,$Li]):this.doClose($Lr,$Li),this.event("close")},$Lt.doClose=function($Lr,$Li){$Lr.removeSelf(),$Lr.isModal&&this._checkMask(),$Lr.closeHandler&&$Lr.closeHandler.runWith($Li),$Lr.onClosed($Li)},$Lt.closeAll=function(){this._closeAll(),this.event("close")},$Lt._closeAll=function(){for(var $Lr=this.numChildren-1;-1<$Lr;$Lr--){var $Li=this.getChildAt($Lr);$Li&&null!=$Li.close&&this.doClose($Li)}},$Lt.getDialogsByGroup=function($Lr){for(var $Li=[],$Lt=this.numChildren-1;-1<$Lt;$Lt--){var $L_=this.getChildAt($Lt);$L_&&$L_.group===$Lr&&$Li.push($L_)}return $Li},$Lt.closeByGroup=function($Lr){for(var $Li=[],$Lt=this.numChildren-1;-1<$Lt;$Lt--){var $L_=this.getChildAt($Lt);$L_&&$L_.group===$Lr&&($L_.close(),$Li.push($L_))}return $Li},$Lt._checkMask=function(){this.maskLayer.removeSelf();for(var $Lr=this.numChildren-1;-1<$Lr;$Lr--){var $Li=this.getChildAt($Lr);if($Li&&$Li.isModal)return void this.addChildAt(this.maskLayer,$Lr)}},$Li}(),$LF=function($Lr){function $Li(){$Li.__super.call(this)}$Lf($Li,"laya.ui.Box",$Lr);var $Lt=$Li.prototype;return $Lc.imps($Lt,{"laya.ui.IBox":!0}),$LE(0,$Lt,"dataSource",$Lr.prototype._$get_dataSource,function($Lr){for(var $Li in this._dataSource=$Lr){var $Lt=this.getChildByName($Li);$Lt?$Lt.dataSource=$Lr[$Li]:this.hasOwnProperty($Li)&&"function"!=typeof this[$Li]&&(this[$Li]=$Lr[$Li])}}),$Li}($LL),$Lb=function($Li){function $Lt($Lr,$Li){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,$Lt.__super.call(this),this._labelColors=$Ll.buttonLabelColors,this._stateNum=$Ll.buttonStateNum,void 0===$Li&&($Li=""),this.skin=$Lr,this.label=$Li}$Lf($Lt,"laya.ui.Button",$Li);var $Lr=$Lt.prototype;return $Lc.imps($Lr,{"laya.ui.ISelect":!0}),$Lr.destroy=function($Lr){this.clearEvent(),$LC.clearCache(this,this._skin),$LC.clearObject(this,this._weakKey),void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,$Lr),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy($Lr),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},$Lr.clearEvent=function(){this._skin&&$LA.atalsNotify&&$LA.atalsNotify.off(this._skin,this,this._setBtnSource)},$Lr.createChildren=function(){this.graphics=this._bitmap=new $Le},$Lr.createText=function(){this._text||(this._text=new $LD,this._text.overflow=$LD.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},$Lr.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},$Lr.onMouse=function($Lr){if(!1!==this.toggle||!this._selected)return"click"===$Lr.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=$Lt.stateMap[$Lr.type]))},$Lr.changeClips=function(){var $Lr=$LC.getRes(this._skin);if($Lr)if(this._skin&&""!=this._skin){$LC.clearObject(this,this._weakKey);var $Li=$Lr.sourceWidth,$Lt=$Lr.sourceHeight/this._stateNum;$Lr.$_GID||($Lr.$_GID=$LH.getGID());var $L_=$Lr.$_GID+"-"+this._stateNum,$LA=$LC.findObject($L_);if($LH.isOkTextureList($LA)||($LA=null),$LA)this._weakKey=$L_,$LC.keepObject(this,this._weakKey),this._sources=$LA;else{if(this._sources=[],1===this._stateNum)this._sources.push($Lr);else for(var $Lf=0;$Lf<this._stateNum;$Lf++){var $LE=$Lu.createFromTexture($Lr,0,$Lt*$Lf,$Li,$Lt);if($Lr.alphaTexture){var $LG=$Lr.width/$Lr.alphaTexture.width;$LE.alphaTexture=$Lu.createFromTexture($Lr.alphaTexture,0/$LG,$Lt*$Lf/$LG,$Li/$LG,$Lt/$LG)}this._sources.push($LE)}$LC.saveObject($L_,this._sources),this._weakKey=$L_,$LC.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||$Li,this._bitmap.height=this._height||$Lt,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=$Li)}else console.warn("lose skin ",this._skin,this.name,this.__className)},$Lr.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var $Lr=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[$Lr]),this.label&&(this._text.color=this._labelColors[$Lr],this._strokeColors&&(this._text.strokeColor=this._strokeColors[$Lr]))},$Lr._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},$LE(0,$Lr,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function($Lr){this.createText(),this._text.strokeColor=$Lr}),$LE(0,$Lr,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),$LE(0,$Lr,"skin",function(){return this._skin},function($Lr){if(this._skin!=$Lr)if(this.clearEvent(),$LC.clearCache(this,this._skin),this._skin=$Lr,$LC.keepCache(this,this._skin),$LC.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var $Li=$LA.resAtalsObj&&$LA.resAtalsObj[this._skin];$Li?($LA.atalsNotify&&$LA.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=$Li.sourceW),0==this.height&&(this.height=$Li.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),$Lr._setBtnSource=function($Lr,$Li){$Lr===this._skin&&$Li&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},$LE(0,$Lr,"state",function(){return this._state},function($Lr){this._state!=$Lr&&(this._state=$Lr,this._setStateChanged())}),$LE(0,$Lr,"text",function(){return this.createText(),this._text}),$LE(0,$Lr,"stateNum",function(){return this._stateNum},function($Lr){"string"==typeof $Lr&&($Lr=parseInt($Lr)),this._stateNum!=$Lr&&(this._stateNum=$Lr<1?1:3<$Lr?3:$Lr,this.callLater(this.changeClips))}),$LE(0,$Lr,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function($Lr){this._strokeColors=$LU.fillArray($Ll.buttonLabelColors,$Lr,String),this._setStateChanged()}),$LE(0,$Lr,"labelColors",function(){return this._labelColors.join(",")},function($Lr){this._labelColors=$LU.fillArray($Ll.buttonLabelColors,$Lr,String),this._setStateChanged()}),$LE(0,$Lr,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),$LE(0,$Lr,"label",function(){return this._text?this._text.text:null},function($Lr){(this._text||$Lr)&&(this.createText(),this._text.text!=$Lr&&($Lr&&!this._text.parent&&this.addChild(this._text),this._text.text=($Lr+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),$LE(0,$Lr,"selected",function(){return this._selected},function($Lr){this._selected!=$Lr&&(this._selected=$Lr,this.state=this._selected?2:0,this.event("change"))}),$LE(0,$Lr,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function($Lr){this.createText(),this._text.padding=$LU.fillArray($Ll.labelPadding,$Lr,Number)}),$LE(0,$Lr,"labelSize",function(){return this.createText(),this._text.fontSize},function($Lr){this.createText(),this._text.fontSize=$Lr}),$LE(0,$Lr,"labelStroke",function(){return this.createText(),this._text.stroke},function($Lr){this.createText(),this._text.stroke=$Lr}),$LE(0,$Lr,"labelBold",function(){return this.createText(),this._text.bold},function($Lr){this.createText(),this._text.bold=$Lr}),$LE(0,$Lr,"labelFont",function(){return this.createText(),this._text.font},function($Lr){this.createText(),this._text.font=$Lr}),$LE(0,$Lr,"labelAlign",function(){return this.createText(),this._text.align},function($Lr){this.createText(),this._text.align=$Lr}),$LE(0,$Lr,"clickHandler",function(){return this._clickHandler},function($Lr){this._clickHandler=$Lr}),$LE(0,$Lr,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($Lr){this._bitmap.sizeGrid=$LU.fillArray($Ll.defaultSizeGrid,$Lr,Number)}),$LE(0,$Lr,"width",$Li.prototype._$get_width,function($Lr){$Lc.superSet($LL,this,"width",$Lr),this._autoSize&&(this._bitmap.width=$Lr,this._text&&(this._text.width=$Lr))}),$LE(0,$Lr,"height",$Li.prototype._$get_height,function($Lr){$Lc.superSet($LL,this,"height",$Lr),this._autoSize&&(this._bitmap.height=$Lr,this._text&&(this._text.height=$Lr))}),$LE(0,$Lr,"dataSource",$Li.prototype._$get_dataSource,function($Lr){"number"==typeof(this._dataSource=$Lr)||"string"==typeof $Lr?this.label=$Lr+"":$Lc.superSet($LL,this,"dataSource",$Lr)}),$LE(0,$Lr,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function($Lr){this._bitmap._offset=$Lr?$LU.fillArray([1,1],$Lr,Number):[]}),$L_($Lt,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),$Lt}($LL),$LV=function($Li){function $L_($Lr,$Li,$Lt){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,$L_.__super.call(this),void 0===$Li&&($Li=1),void 0===$Lt&&($Lt=1),this._clipX=$Li,this._clipY=$Lt,this.skin=$Lr}$Lf($L_,"laya.ui.Clip",$Li);var $Lr=$L_.prototype;return $Lr.destroy=function($Lr){this.clearEvent(),this.clearLoad(),$LC.clearCache(this,this._skin),$LC.clearObject(this,this._weakKey),void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},$Lr.dispose=function(){this.destroy(!0),$Lc.loader.clearRes(this._skin)},$Lr.createChildren=function(){this.graphics=this._bitmap=new $Le},$Lr._onDisplay=function($Lr){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},$Lr.changeClip=function(){if(this._clipChanged=!1,this._skin){var $Lr=$LC.getRes(this._skin);if($Lr)this.loadComplete(this._skin,$Lr);else{if($LA.resAtalsObj&&$LA.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=$LX.create(this,this.loadComplete,[this._skin]),this._progress=null,$Lc.loader.load(this._skin,this._complete,this._progress)}}},$Lr.loadComplete=function($Lr,$Li){if($Lr===this._skin&&$Li){$LC.clearObject(this,this._weakKey);var $Lt=this._clipWidth||Math.ceil($Li.sourceWidth/this._clipX),$L_=this._clipHeight||Math.ceil($Li.sourceHeight/this._clipY),$LA=this._skin+$Lt+$L_,$Lf=$LC.findObject($LA);if($LH.isOkTextureList($Lf)||($Lf=null),$Lf)this._weakKey=$LA,$LC.keepObject(this,this._weakKey),this._sources=$Lf;else{this._sources=[];for(var $LE=0;$LE<this._clipY;$LE++)for(var $LG=0;$LG<this._clipX;$LG++){var $LN=$Lu.createFromTexture($Li,$Lt*$LG,$L_*$LE,$Lt,$L_);if($Li.alphaTexture){var $Lp=$Li.width/$Li.alphaTexture.width;$LN.alphaTexture=$Lu.createFromTexture($Li.alphaTexture,$Lt*$LG/$Lp,$L_*$LE/$Lp,$Lt/$Lp,$L_/$Lp)}this._sources.push($LN)}$LC.saveObject($LA,this._sources),this._weakKey=$LA,$LC.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},$Lr.play=function($Lr,$Li){void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=-1),this._isPlaying=!0,this.index=$Lr,this._toIndex=$Li,this._index++,$Lc.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},$Lr._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},$Lr.stop=function(){this._isPlaying=!1,$Lc.timer.clear(this,this._loop),this.event("complete")},$Lr._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},$LE(0,$Lr,"interval",function(){return this._interval},function($Lr){this._interval!=$Lr&&(this._interval=$Lr,this._isPlaying&&this.play())}),$Lr.clearEvent=function(){this._skin&&$LA.atalsNotify&&$LA.atalsNotify.off(this._skin,this,this._setBtnSource)},$Lr.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$Lc.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$LE(0,$Lr,"skin",function(){return this._skin},function($Lr){if(this._skin!=$Lr)if(this.clearLoad(),this.clearEvent(),$LC.clearCache(this,this._skin),this._skin=$Lr){$LC.keepCache(this,this._skin);var $Li=$LC.getRes($Lr),$Lt=$LA.resAtalsObj&&$LA.resAtalsObj[this._skin];!$Li&&$Lt?$LA.atalsNotify&&$LA.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),$Lr._setBtnSource=function($Lr,$Li){$Lr===this._skin&&$Li&&(this.loadComplete($Lr,$Li),this.clearEvent())},$LE(0,$Lr,"sources",function(){return this._sources},function($Lr){this._sources=$Lr,this.index=this._index,this.event("loaded")}),$LE(0,$Lr,"clipX",function(){return this._clipX},function($Lr){this._clipX=$Lr||1,this._setClipChanged()}),$LE(0,$Lr,"clipY",function(){return this._clipY},function($Lr){this._clipY=$Lr||1,this._setClipChanged()}),$LE(0,$Lr,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),$LE(0,$Lr,"clipWidth",function(){return this._clipWidth},function($Lr){this._clipWidth=$Lr,this._setClipChanged()}),$LE(0,$Lr,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($Lr){this._bitmap.sizeGrid=$LU.fillArray($Ll.defaultSizeGrid,$Lr,Number)}),$LE(0,$Lr,"group",function(){return this._group},function($Lr){$Lr&&this._skin&&$LC.setGroup(this._skin,$Lr),this._group=$Lr}),$LE(0,$Lr,"clipHeight",function(){return this._clipHeight},function($Lr){this._clipHeight=$Lr,this._setClipChanged()}),$LE(0,$Lr,"width",$Li.prototype._$get_width,function($Lr){$Lc.superSet($LL,this,"width",$Lr),this._bitmap.width=$Lr}),$LE(0,$Lr,"height",$Li.prototype._$get_height,function($Lr){$Lc.superSet($LL,this,"height",$Lr),this._bitmap.height=$Lr}),$LE(0,$Lr,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),$LE(0,$Lr,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),$LE(0,$Lr,"index",function(){return this._index},function($Lr){this._index=$Lr,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[$Lr]),this.event("change")}),$LE(0,$Lr,"autoPlay",function(){return this._autoPlay},function($Lr){this._autoPlay!=$Lr&&((this._autoPlay=$Lr)?this.play():this.stop())}),$LE(0,$Lr,"isPlaying",function(){return this._isPlaying},function($Lr){this._isPlaying=$Lr}),$LE(0,$Lr,"dataSource",$Li.prototype._$get_dataSource,function($Lr){"number"==typeof(this._dataSource=$Lr)&&Math.floor($Lr)==$Lr||"string"==typeof $Lr?this.index=parseInt($Lr):$Lc.superSet($LL,this,"dataSource",$Lr)}),$LE(0,$Lr,"bitmap",function(){return this._bitmap}),$L_}($LL),$Lh=function($Li){function $Lr(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,$Lr.__super.call(this)}$Lf($Lr,"laya.ui.ColorPicker",$Li);var $Lt=$Lr.prototype;return $Lt.destroy=function($Lr){void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,$Lr),this._colorPanel&&this._colorPanel.destroy($Lr),this._colorButton&&this._colorButton.destroy($Lr),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},$Lt.createChildren=function(){this.addChild(this._colorButton=new $Lb),this._colorPanel=new $LF,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new $La),this._colorPanel.addChild(this._colorBlock=new $La),this._colorPanel.addChild(this._colorInput=new $Lv)},$Lt.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},$Lt.onPanelMouseDown=function($Lr){$Lr.stopPropagation()},$Lt.changePanel=function(){this._panelChanged=!1;var $Lr=this._colorPanel.graphics;$Lr.clear(),$Lr.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,($Lr=this._colorTiles.graphics).clear();for(var $Li=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],$Lt=0;$Lt<12;$Lt++)for(var $L_=0;$L_<20;$L_++){var $LA=0;$LA=0===$L_?$Li[$Lt]:1===$L_?0:51*(((3*$Lt+$L_/6)%3<<0)+3*($Lt/6<<0))<<16|$L_%6*51<<8|($Lt<<0)%6*51;var $Lf=$LU.toColor($LA);this._colors.push($Lf);var $LE=$L_*this._gridSize,$LG=$Lt*this._gridSize;$Lr.drawRect($LE,$LG,this._gridSize,this._gridSize,$Lf,"#000000")}},$Lt.onColorButtonClick=function($Lr){this._colorPanel.parent?this.close():this.open()},$Lt.open=function(){var $Lr=this.localToGlobal(new $LO),$Li=$Lr.x+this._colorPanel.width<=$Lc.stage.width?$Lr.x:$Lc.stage.width-this._colorPanel.width,$Lt=$Lr.y+this._colorButton.height;$Lt=$Lt+this._colorPanel.height<=$Lc.stage.height?$Lt:$Lr.y-this._colorPanel.height,this._colorPanel.pos($Li,$Lt),this._colorPanel.zOrder=1001,$Lc._currentStage.addChild(this._colorPanel),$Lc.stage.on("mousedown",this,this.removeColorBox)},$Lt.close=function(){$Lc.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},$Lt.removeColorBox=function($Lr){this.close()},$Lt.onColorFieldKeyDown=function($Lr){13==$Lr.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),$Lr.stopPropagation())},$Lt.onColorInputChange=function($Lr){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},$Lt.onColorTilesClick=function($Lr){this.selectedColor=this.getColorByMouse(),this.close()},$Lt.onColorTilesMouseMove=function($Lr){this._colorInput.focus=!1;var $Li=this.getColorByMouse();this._colorInput.text=$Li,this.drawBlock($Li)},$Lt.getColorByMouse=function(){var $Lr=this._colorTiles.getMousePoint(),$Li=Math.floor($Lr.x/this._gridSize),$Lt=Math.floor($Lr.y/this._gridSize);return this._colors[20*$Lt+$Li]},$Lt.drawBlock=function($Lr){var $Li=this._colorBlock.graphics;$Li.clear();var $Lt=$Lr||"#ffffff";$Li.drawRect(0,0,50,20,$Lt,this._borderColor),$Lr||$Li.drawLine(0,0,50,20,"#ff0000")},$Lt.changeColor=function(){var $Lr=this.graphics;$Lr.clear();var $Li=this._selectedColor||"#000000";$Lr.drawRect(0,0,this._colorButton.width,this._colorButton.height,$Li)},$Lt._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},$LE(0,$Lt,"inputBgColor",function(){return this._inputBgColor},function($Lr){this._inputBgColor=$Lr,this._setPanelChanged()}),$LE(0,$Lt,"selectedColor",function(){return this._selectedColor},function($Lr){this._selectedColor!=$Lr&&(this._selectedColor=this._colorInput.text=$Lr,this.drawBlock($Lr),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",$Lp.EMPTY.setTo("change",this,this)))}),$LE(0,$Lt,"skin",function(){return this._colorButton.skin},function($Lr){this._colorButton.skin=$Lr,this.changeColor()}),$LE(0,$Lt,"bgColor",function(){return this._bgColor},function($Lr){this._bgColor=$Lr,this._setPanelChanged()}),$LE(0,$Lt,"borderColor",function(){return this._borderColor},function($Lr){this._borderColor=$Lr,this._setPanelChanged()}),$LE(0,$Lt,"inputColor",function(){return this._inputColor},function($Lr){this._inputColor=$Lr,this._setPanelChanged()}),$Lr}($LL),$LP=function($Li){function $Lt($Lr,$Li){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,$Lt.__super.call(this),this._itemColors=$Ll.comboBoxItemColors,this.skin=$Lr,this.labels=$Li}$Lf($Lt,"laya.ui.ComboBox",$Li);var $Lr=$Lt.prototype;return $Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,$Lr),this._button&&this._button.destroy($Lr),this._list&&this._list.destroy($Lr),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},$Lr.createChildren=function(){this.addChild(this._button=new $Lb),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},$Lr._createList=function(){this._list=new $LZ,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},$Lr._setListEvent=function($Lr){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=$LX.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},$Lr.onListDown=function($Lr){$Lr.stopPropagation()},$Lr.onScrollBarDown=function($Lr){$Lr.stopPropagation()},$Lr.onButtonMouseDown=function($Lr){this.callLater(this.switchTo,[!this._isOpen])},$Lr.changeList=function(){this._listChanged=!1;var $Lr=this.width-2,$Li=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:$Lr,height:this._itemHeight,fontSize:this._itemSize,color:$Li}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},$Lr.onlistItemMouse=function($Lr,$Li){var $Lt=$Lr.type;if("mouseover"===$Lt||"mouseout"===$Lt){if(this._isCustomList)return;var $L_=this._list.getCell($Li);if(!$L_)return;var $LA=$L_.getChildByName("label");$LA&&("mouseover"===$Lt?($LA.bgColor=this._itemColors[0],$LA.color=this._itemColors[1]):($LA.bgColor=null,$LA.color=this._itemColors[2]))}else"click"===$Lt&&(this.selectedIndex=$Li,this.isOpen=!1)},$Lr.switchTo=function($Lr){this.isOpen=$Lr},$Lr.changeOpen=function(){this.isOpen=!this._isOpen},$Lr.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var $Lr=this._list.graphics;$Lr.clear(),$Lr.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var $Li=this._list.array||[],$Lt=$Li.length=0,$L_=this._labels.length;$Lt<$L_;$Lt++)$Li.push({label:this._labels[$Lt]});this._list.height=this._listHeight,this._list.array=$Li},$Lr.changeSelected=function(){this._button.label=this.selectedLabel},$Lr._onStageMouseWheel=function($Lr){this._list&&!this._list.contains($Lr.target)&&this.removeList(null)},$Lr.removeList=function($Lr){$Lc.stage.off("mousedown",this,this.removeList),$Lc.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},$LE(0,$Lr,"selectedIndex",function(){return this._selectedIndex},function($Lr){this._selectedIndex!=$Lr&&(this._selectedIndex=$Lr,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[$Lp.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),$LE(0,$Lr,"measureHeight",function(){return this._button.height}),$LE(0,$Lr,"skin",function(){return this._button.skin},function($Lr){this._button.skin!=$Lr&&(this._button.skin=$Lr,this._listChanged=!0)}),$LE(0,$Lr,"measureWidth",function(){return this._button.width}),$LE(0,$Lr,"width",$Li.prototype._$get_width,function($Lr){$Lc.superSet($LL,this,"width",$Lr),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),$LE(0,$Lr,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function($Lr){this.selectedIndex=this._labels.indexOf($Lr)}),$LE(0,$Lr,"labels",function(){return this._labels.join(",")},function($Lr){0<this._labels.length&&(this.selectedIndex=-1),$Lr?this._labels=$Lr.split(","):this._labels.length=0,this._itemChanged=!0}),$LE(0,$Lr,"height",$Li.prototype._$get_height,function($Lr){$Lc.superSet($LL,this,"height",$Lr),this._button.height=this._height}),$LE(0,$Lr,"selectHandler",function(){return this._selectHandler},function($Lr){this._selectHandler=$Lr}),$LE(0,$Lr,"visibleNum",function(){return this._visibleNum},function($Lr){this._visibleNum=$Lr,this._listChanged=!0}),$LE(0,$Lr,"labelBold",function(){return this._button.text.bold},function($Lr){this._button.text.bold=$Lr}),$LE(0,$Lr,"itemColors",function(){return String(this._itemColors)},function($Lr){this._itemColors=$LU.fillArray(this._itemColors,$Lr,String),this._listChanged=!0}),$LE(0,$Lr,"itemSize",function(){return this._itemSize},function($Lr){this._itemSize=$Lr,this._listChanged=!0}),$LE(0,$Lr,"scrollBar",function(){return this.list.scrollBar}),$LE(0,$Lr,"isOpen",function(){return this._isOpen},function($Lr){if(this._isOpen!=$Lr)if(this._isOpen=$Lr,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var $Li=this.localToGlobal($LO.TEMP.setTo(0,0)),$Lt=$Li.y+this._button.height;$Lt=$Lt+this._listHeight<=$Lc.stage.height?$Lt:$Li.y-this._listHeight,this._list.pos($Li.x,$Lt),this._list.zOrder=1001,$Lc._currentStage.addChild(this._list),$Lc.stage.once("mousedown",this,this.removeList),$Lc.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),$LE(0,$Lr,"scrollBarSkin",function(){return this._scrollBarSkin},function($Lr){this._scrollBarSkin=$Lr}),$LE(0,$Lr,"sizeGrid",function(){return this._button.sizeGrid},function($Lr){this._button.sizeGrid=$Lr}),$LE(0,$Lr,"button",function(){return this._button}),$LE(0,$Lr,"list",function(){return this._list||this._createList(),this._list},function($Lr){$Lr&&($Lr.removeSelf(),this._isCustomList=!0,this._list=$Lr,this._setListEvent($Lr),this._itemHeight=$Lr.getCell(0).height+$Lr.spaceY)}),$LE(0,$Lr,"dataSource",$Li.prototype._$get_dataSource,function($Lr){"number"==typeof(this._dataSource=$Lr)&&Math.floor($Lr)==$Lr||"string"==typeof $Lr?this.selectedIndex=parseInt($Lr):$Lr instanceof Array?this.labels=$Lr.join(","):$Lc.superSet($LL,this,"dataSource",$Lr)}),$LE(0,$Lr,"labelColors",function(){return this._button.labelColors},function($Lr){this._button.labelColors!=$Lr&&(this._button.labelColors=$Lr)}),$LE(0,$Lr,"labelPadding",function(){return this._button.text.padding.join(",")},function($Lr){this._button.text.padding=$LU.fillArray($Ll.labelPadding,$Lr,Number)}),$LE(0,$Lr,"labelSize",function(){return this._button.text.fontSize},function($Lr){this._button.text.fontSize=$Lr}),$LE(0,$Lr,"labelFont",function(){return this._button.text.font},function($Lr){this._button.text.font=$Lr}),$LE(0,$Lr,"stateNum",function(){return this._button.stateNum},function($Lr){this._button.stateNum=$Lr}),$Lt}($LL),$Lq=function($Li){function $Lt($Lr){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,$Lt.__super.call(this),this._showButtons=$Lk.showButtons,this._touchScrollEnable=$Lk.touchScrollEnable,this._mouseWheelEnable=$Lk.mouseWheelEnable,this.skin=$Lr,this.max=1}$Lf($Lt,"laya.ui.ScrollBar",$Li);var $Lr=$Lt.prototype;return $Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),this.stopScroll(),this.target=null,$Li.prototype.destroy.call(this,$Lr),this.upButton&&this.upButton.destroy($Lr),this.downButton&&this.downButton.destroy($Lr),this.slider&&this.slider.destroy($Lr),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},$Lr.createChildren=function(){this.addChild(this.slider=new $Lm),this.addChild(this.upButton=new $Lb),this.addChild(this.downButton=new $Lb)},$Lr.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},$Lr.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},$Lr.onButtonMouseDown=function($Lr){var $Li=$Lr.currentTarget===this.upButton;this.slide($Li),$Lc.timer.once($Ll.scrollBarDelayTime,this,this.startLoop,[$Li]),$Lc.stage.once("mouseup",this,this.onStageMouseUp)},$Lr.startLoop=function($Lr){$Lc.timer.frameLoop(1,this,this.slide,[$Lr])},$Lr.slide=function($Lr){$Lr?this.value-=this._scrollSize:this.value+=this._scrollSize},$Lr.onStageMouseUp=function($Lr){$Lc.timer.clear(this,this.startLoop),$Lc.timer.clear(this,this.slide)},$Lr.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},$Lr.changeSize=function(){$Li.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},$Lr.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},$Lr.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},$Lr.setScroll=function($Lr,$Li,$Lt){this.runCallLater(this.changeSize),this.slider.setSlider($Lr,$Li,$Lt),this.slider.bar.visible=0<$Li,!this._hide&&this.autoHide&&(this.visible=!1)},$Lr.onTargetMouseWheel=function($Lr){this.value-=$Lr.delta*this._scrollSize,this.target=this._target},$Lr.onTargetMouseDown=function($Lr){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $LO),this._lastPoint.setTo($Lc.stage.mouseX,$Lc.stage.mouseY),$Lc.timer.clear(this,this.tweenMove),$Lw.clearTween(this),$Lc.stage.once("mouseup",this,this.onStageMouseUp2),$Lc.stage.once("mouseout",this,this.onStageMouseUp2),$Lc.timer.frameLoop(1,this,this.loop)},$Lr.loop=function(){var $Lr=$Lc.stage.mouseY,$Li=$Lc.stage.mouseX;if(this._lastOffset=this.isVertical?$Lr-this._lastPoint.y:$Li-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?$Lc.stage._canvasTransform.getScaleY():$Lc.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=$Li,this._lastPoint.y=$Lr,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},$Lr.onStageMouseUp2=function($Lr){if($Lc.stage.off("mouseup",this,this.onStageMouseUp2),$Lc.stage.off("mouseout",this,this.onStageMouseUp2),$Lc.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?$Lw.to(this,{value:this.min},this.elasticBackTime,$LN.sineOut,$LX.create(this,this.elasticOver)):this._value>this.max&&$Lw.to(this,{value:this.max},this.elasticBackTime,$LN.sineOut,$LX.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?$Lc.stage.mouseY-this._lastPoint.y:$Lc.stage.mouseX-this._lastPoint.x);for(var $Li=0,$Lt=Math.min(this._offsets.length,3),$L_=0;$L_<$Lt;$L_++)$Li+=this._offsets[this._offsets.length-1-$L_];if(this._lastOffset=$Li/$Lt,($Li=Math.abs(this._lastOffset))<2)return void this.event("end");60<$Li&&(this._lastOffset=0<this._lastOffset?60:-60);var $LA=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));$Lc.timer.frameLoop(1,this,this.tweenMove,[$LA])}},$Lr.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&$Lw.to(this,{alpha:0},500),this.event("end")},$Lr.tweenMove=function($Lr){this._lastOffset*=this.rollRatio;var $Li=NaN;if(0<$Lr&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,$Li=.5*-(this.min-$Lr-this.value),this._lastOffset>$Li&&(this._lastOffset=$Li)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,$Li=.5*-(this.max+$Lr-this.value),this._lastOffset<$Li&&(this._lastOffset=$Li))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if($Lc.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?$Lw.to(this,{value:this.min},this.elasticBackTime,$LN.sineOut,$LX.create(this,this.elasticOver)):this._value>this.max?$Lw.to(this,{value:this.max},this.elasticBackTime,$LN.sineOut,$LX.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&$Lw.to(this,{alpha:0},500)}},$Lr.stopScroll=function(){this.onStageMouseUp2(null),$Lc.timer.clear(this,this.tweenMove),$Lw.clearTween(this)},$LE(0,$Lr,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),$LE(0,$Lr,"skin",function(){return this._skin},function($Lr){this._skin!=$Lr&&(this._skin=$Lr,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),$LE(0,$Lr,"max",function(){return this.slider.max},function($Lr){this.slider.max=$Lr}),$LE(0,$Lr,"showButtons",function(){return this._showButtons},function($Lr){this._showButtons=$Lr,this.callLater(this.changeScrollBar)}),$LE(0,$Lr,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),$LE(0,$Lr,"min",function(){return this.slider.min},function($Lr){this.slider.min=$Lr}),$LE(0,$Lr,"value",function(){return this._value},function($Lr){$Lr!==this._value&&(this._value=$Lr,this._isElastic||(this.slider._value!=$Lr&&(this.slider._value=$Lr,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),$LE(0,$Lr,"isVertical",function(){return this.slider.isVertical},function($Lr){this.slider.isVertical=$Lr}),$LE(0,$Lr,"sizeGrid",function(){return this.slider.sizeGrid},function($Lr){this.slider.sizeGrid=$Lr}),$LE(0,$Lr,"scrollSize",function(){return this._scrollSize},function($Lr){this._scrollSize=$Lr}),$LE(0,$Lr,"dataSource",$Li.prototype._$get_dataSource,function($Lr){"number"==typeof(this._dataSource=$Lr)||"string"==typeof $Lr?this.value=Number($Lr):$Lc.superSet($LL,this,"dataSource",$Lr)}),$LE(0,$Lr,"thumbPercent",function(){return this._thumbPercent},function($Lr){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),$Lr=1<=$Lr?.99:$Lr,this._thumbPercent=$Lr,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*$Lr,$Ll.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*$Lr,$Ll.scrollBarMinNum))}),$LE(0,$Lr,"target",function(){return this._target},function($Lr){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=$Lr)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),$LE(0,$Lr,"hide",function(){return this._hide},function($Lr){this._hide=$Lr,this.visible=!$Lr}),$LE(0,$Lr,"touchScrollEnable",function(){return this._touchScrollEnable},function($Lr){this._touchScrollEnable=$Lr,this.target=this._target}),$LE(0,$Lr,"mouseWheelEnable",function(){return this._mouseWheelEnable},function($Lr){this._mouseWheelEnable=$Lr,this.target=this._target}),$LE(0,$Lr,"tick",function(){return this.slider.tick},function($Lr){this.slider.tick=$Lr}),$Lt}($LL),$Lm=function($Li){function $Lt($Lr){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,$Lt.__super.call(this),this.skin=$Lr}$Lf($Lt,"laya.ui.Slider",$Li);var $Lr=$Lt.prototype;return $Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,$Lr),this._bg&&this._bg.destroy($Lr),this._bar&&this._bar.destroy($Lr),this._progress&&this._progress.destroy($Lr),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},$Lr.createChildren=function(){this.addChild(this._bg=new $LT),this.addChild(this._bar=new $Lb)},$Lr.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},$Lr.onBarMouseDown=function($Lr){this._globalSacle||(this._globalSacle=new $LO),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=$Lc.stage.mouseX,this._ty=$Lc.stage.mouseY,$Lc.stage.on("mousemove",this,this.mouseMove),$Lc.stage.once("mouseup",this,this.mouseUp),$Lc.stage.once("mouseout",this,this.mouseUp),this.showValueText()},$Lr.showValueText=function(){if(this.showLabel){var $Lr=laya.ui.Slider.label;this.addChild($Lr),$Lr.textField.changeText(this._value+""),this.isVertical?($Lr.x=this._bar.x+20,$Lr.y=.5*(this._bar.height-$Lr.height)+this._bar.y):($Lr.y=this._bar.y-20,$Lr.x=.5*(this._bar.width-$Lr.width)+this._bar.x)}},$Lr.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},$Lr.mouseUp=function($Lr){$Lc.stage.off("mousemove",this,this.mouseMove),$Lc.stage.off("mouseup",this,this.mouseUp),$Lc.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},$Lr.mouseMove=function($Lr){var $Li=this._value;this.isVertical?(this._bar.y+=($Lc.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=($Lc.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=$Lc.stage.mouseX,this._ty=$Lc.stage.mouseY;var $Lt=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$Lt)/$Lt,this._value!=$Li&&this.sendChangeEvent(),this.showValueText()},$Lr.sendChangeEvent=function($Lr){void 0===$Lr&&($Lr="change"),this.event($Lr),this.changeHandler&&this.changeHandler.runWith(this._value)},$Lr.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},$Lr.changeSize=function(){$Li.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},$Lr.setSlider=function($Lr,$Li,$Lt){this._value=-1,this._min=$Lr,this._max=$Lr<$Li?$Li:$Lr,this.value=$Lt<$Lr?$Lr:$Li<$Lt?$Li:$Lt},$Lr.changeValue=function(){var $Lr=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$Lr)/$Lr,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var $Li=this._max-this._min;0===$Li&&($Li=1),this.isVertical?(this._bar.y=(this._value-this._min)/$Li*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/$Li*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},$Lr.onBgMouseDown=function($Lr){var $Li=this._bg.getMousePoint();this.isVertical?this.value=$Li.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=$Li.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},$LE(0,$Lr,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),$LE(0,$Lr,"skin",function(){return this._skin},function($Lr){if(this._skin!=$Lr){this._skin=$Lr,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var $Li=this._skin.replace(".png","$progress.png");$LC.getRes($Li)&&(this._progress||(this.addChild(this._progress=new $LT),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=$Li),this.setBarPoint(),this.callLater(this.changeValue)}}),$LE(0,$Lr,"allowClickBack",function(){return this._allowClickBack},function($Lr){this._allowClickBack!=$Lr&&((this._allowClickBack=$Lr)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),$LE(0,$Lr,"max",function(){return this._max},function($Lr){this._max!=$Lr&&(this._max=$Lr,this.callLater(this.changeValue))}),$LE(0,$Lr,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),$LE(0,$Lr,"tick",function(){return this._tick},function($Lr){this._tick!=$Lr&&(this._tick=$Lr,this.callLater(this.changeValue))}),$LE(0,$Lr,"sizeGrid",function(){return this._bg.sizeGrid},function($Lr){this._bg.sizeGrid=$Lr,this._bar.sizeGrid=$Lr,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),$LE(0,$Lr,"min",function(){return this._min},function($Lr){this._min!=$Lr&&(this._min=$Lr,this.callLater(this.changeValue))}),$LE(0,$Lr,"value",function(){return this._value},function($Lr){if(this._value!=$Lr){var $Li=this._value;this._value=$Lr,this.changeValue(),this._value!=$Li&&this.sendChangeEvent()}}),$LE(0,$Lr,"dataSource",$Li.prototype._$get_dataSource,function($Lr){"number"==typeof(this._dataSource=$Lr)||"string"==typeof $Lr?this.value=Number($Lr):$Lc.superSet($LL,this,"dataSource",$Lr)}),$LE(0,$Lr,"bar",function(){return this._bar}),$L_($Lt,["label",function(){return this.label=new $Lx}]),$Lt}($LL),$LT=function($Li){function $Lt($Lr){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,$Lt.__super.call(this),this.skin=$Lr}$Lf($Lt,"laya.ui.Image",$Li);var $Lr=$Lt.prototype;return $Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,$LC.clearCache(this,this._skin)},$Lr.dispose=function(){this.destroy(!0),$LC.clearCache(this,this._skin),this.clearEvent()},$Lr.createChildren=function(){this.graphics=this._bitmap=new $Le},$Lr.setSource=function($Lr,$Li){$Lr===this._skin&&$Li&&(this.source=$Li,this.onCompResize(),this.clearEvent())},$Lr.clearEvent=function(){this._skin&&$LA.atalsNotify&&$LA.atalsNotify.off(this._skin,this,this.setSource)},$Lr.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$Lc.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$LE(0,$Lr,"source",function(){return this._bitmap.source},function($Lr){this._bitmap&&(this._bitmap.source=$Lr,this.event("loaded"),this.repaint())}),$LE(0,$Lr,"dataSource",$Li.prototype._$get_dataSource,function($Lr){"string"==typeof(this._dataSource=$Lr)?this.skin=$Lr:$Lc.superSet($LL,this,"dataSource",$Lr)}),$LE(0,$Lr,"measureHeight",function(){return this._bitmap.height}),$LE(0,$Lr,"skin",function(){return this._skin},function($Lr){if(this._skin!=$Lr)if($LC.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=$Lr){$LC.keepCache(this,this._skin);var $Li=$LC.getRes($Lr),$Lt=$LA.resAtalsObj&&$LA.resAtalsObj[this._skin];$Li?(this.source=$Li,this.onCompResize()):$Lt?($LA.atalsNotify&&$LA.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=$Lt.sourceW),0==this.height&&(this.height=$Lt.sourceH)):(this._complete=$LX.create(this,this.setSource,[this._skin]),this._progress=null,$Lc.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),$LE(0,$Lr,"group",function(){return this._group},function($Lr){$Lr&&this._skin&&$LC.setGroup(this._skin,$Lr),this._group=$Lr}),$LE(0,$Lr,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($Lr){this._bitmap.sizeGrid=$LU.fillArray($Ll.defaultSizeGrid,$Lr,Number)}),$LE(0,$Lr,"measureWidth",function(){return this._bitmap.width}),$LE(0,$Lr,"width",$Li.prototype._$get_width,function($Lr){$Lc.superSet($LL,this,"width",$Lr),this._bitmap.width=0==$Lr?1e-7:$Lr}),$LE(0,$Lr,"height",$Li.prototype._$get_height,function($Lr){$Lc.superSet($LL,this,"height",$Lr),this._bitmap.height=0==$Lr?1e-7:$Lr}),$Lt}($LL),$Lx=function($Li){function $Lt($Lr){this._tf=null,$Lt.__super.call(this),void 0===$Lr&&($Lr=""),$Lg.defaultColor=$Ll.labelColor,this.text=$Lr}$Lf($Lt,"laya.ui.Label",$Li);var $Lr=$Lt.prototype;return $Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,$Lr),this._tf=null},$Lr.createChildren=function(){this.addChild(this._tf=new $LD)},$Lr.changeText=function($Lr){this._tf.changeText($Lr)},$LE(0,$Lr,"padding",function(){return this._tf.padding.join(",")},function($Lr){this._tf.padding=$LU.fillArray($Ll.labelPadding,$Lr,Number)}),$LE(0,$Lr,"bold",function(){return this._tf.bold},function($Lr){this._tf.bold=$Lr}),$LE(0,$Lr,"align",function(){return this._tf.align},function($Lr){this._tf.align=$Lr}),$LE(0,$Lr,"text",function(){return this._tf.text},function($Lr){this._tf.text!=$Lr&&($Lr&&($Lr=$LU.adptString($Lr+"")),this._tf.text=$Lr,this.event("change"),this._width&&this._height||this.onCompResize())}),$LE(0,$Lr,"italic",function(){return this._tf.italic},function($Lr){this._tf.italic=$Lr}),$LE(0,$Lr,"wordWrap",function(){return this._tf.wordWrap},function($Lr){this._tf.wordWrap=$Lr}),$LE(0,$Lr,"font",function(){return this._tf.font},function($Lr){this._tf.font=$Lr}),$LE(0,$Lr,"dataSource",$Li.prototype._$get_dataSource,function($Lr){"number"==typeof(this._dataSource=$Lr)||"string"==typeof $Lr?this.text=$Lr+"":$Lc.superSet($LL,this,"dataSource",$Lr)}),$LE(0,$Lr,"color",function(){return this._tf.color},function($Lr){this._tf.color=$Lr}),$LE(0,$Lr,"valign",function(){return this._tf.valign},function($Lr){this._tf.valign=$Lr}),$LE(0,$Lr,"leading",function(){return this._tf.leading},function($Lr){this._tf.leading=$Lr}),$LE(0,$Lr,"fontSize",function(){return this._tf.fontSize},function($Lr){this._tf.fontSize=$Lr}),$LE(0,$Lr,"bgColor",function(){return this._tf.bgColor},function($Lr){this._tf.bgColor=$Lr}),$LE(0,$Lr,"borderColor",function(){return this._tf.borderColor},function($Lr){this._tf.borderColor=$Lr}),$LE(0,$Lr,"stroke",function(){return this._tf.stroke},function($Lr){this._tf.stroke=$Lr}),$LE(0,$Lr,"strokeColor",function(){return this._tf.strokeColor},function($Lr){this._tf.strokeColor=$Lr}),$LE(0,$Lr,"textField",function(){return this._tf}),$LE(0,$Lr,"measureWidth",function(){return this._tf.width}),$LE(0,$Lr,"measureHeight",function(){return this._tf.height}),$LE(0,$Lr,"width",function(){return this._width||this._tf.text?$Lc.superGet($LL,this,"width"):0},function($Lr){$Lc.superSet($LL,this,"width",$Lr),this._tf.width=$Lr}),$LE(0,$Lr,"height",function(){return this._height||this._tf.text?$Lc.superGet($LL,this,"height"):0},function($Lr){$Lc.superSet($LL,this,"height",$Lr),this._tf.height=$Lr}),$LE(0,$Lr,"overflow",function(){return this._tf.overflow},function($Lr){this._tf.overflow=$Lr}),$LE(0,$Lr,"underline",function(){return this._tf.underline},function($Lr){this._tf.underline=$Lr}),$LE(0,$Lr,"underlineColor",function(){return this._tf.underlineColor},function($Lr){this._tf.underlineColor=$Lr}),$Lt}($LL),$L$=function($Li){function $Lt($Lr){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,$Lt.__super.call(this),this.skin=$Lr}$Lf($Lt,"laya.ui.ProgressBar",$Li);var $Lr=$Lt.prototype;return $Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,$Lr),this._bg&&this._bg.destroy($Lr),this._bar&&this._bar.destroy($Lr),this._bg=this._bar=null,this.changeHandler=null},$Lr.createChildren=function(){this.addChild(this._bg=new $LT),this.addChild(this._bar=new $LT)},$Lr.changeValue=function(){if(this.sizeGrid){var $Lr=this.sizeGrid.split(","),$Li=Number($Lr[3]),$Lt=Number($Lr[1]),$L_=(this.width-$Li-$Lt)*this._value;this._bar.width=$Li+$Lt+$L_,this._bar.visible=this._bar.width>$Li+$Lt}else this._bar.width=this.width*this._value},$LE(0,$Lr,"measureHeight",function(){return this._bg.height}),$LE(0,$Lr,"skin",function(){return this._skin},function($Lr){this._skin!=$Lr&&(this._skin=$Lr,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),$LE(0,$Lr,"measureWidth",function(){return this._bg.width}),$LE(0,$Lr,"height",$Li.prototype._$get_height,function($Lr){$Lc.superSet($LL,this,"height",$Lr),this._bg.height=this._height,this._bar.height=this._height}),$LE(0,$Lr,"bar",function(){return this._bar}),$LE(0,$Lr,"value",function(){return this._value},function($Lr){this._value!=$Lr&&($Lr=1<$Lr?1:$Lr<0?0:$Lr,this._value=$Lr,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith($Lr))}),$LE(0,$Lr,"bg",function(){return this._bg}),$LE(0,$Lr,"sizeGrid",function(){return this._bg.sizeGrid},function($Lr){this._bg.sizeGrid=this._bar.sizeGrid=$Lr}),$LE(0,$Lr,"width",$Li.prototype._$get_width,function($Lr){$Lc.superSet($LL,this,"width",$Lr),this._bg.width=this._width,this.callLater(this.changeValue)}),$LE(0,$Lr,"dataSource",$Li.prototype._$get_dataSource,function($Lr){"number"==typeof(this._dataSource=$Lr)||"string"==typeof $Lr?this.value=Number($Lr):$Lc.superSet($LL,this,"dataSource",$Lr)}),$Lt}($LL),$Lo=(function($Lr){function $Lt(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,$Lt.__super.call(this),this._tipBox=new $LL,this._tipBox.addChild(this._tipText=new $LD),this._tipText.x=this._tipText.y=5,this._tipText.color=$Lt.tipTextColor,this._defaultTipHandler=this._showDefaultTip,$Lc.stage.on("showtip",this,this._onStageShowTip),$Lc.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}$Lf($Lt,"laya.ui.TipManager",$LL);var $Li=$Lt.prototype;$Li._onStageHideTip=function($Lr){$Lc.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},$Li._onStageShowTip=function($Lr){$Lc.timer.once($Lt.tipDelay,this,this._showTip,[$Lr],!0)},$Li._showTip=function($Lr){if("string"==typeof $Lr){var $Li=String($Lr);Boolean($Li)&&this._defaultTipHandler($Li)}else $Lr instanceof laya.utils.Handler?$Lr.run():"function"==typeof $Lr&&$Lr.apply();$Lc.stage.on("mousemove",this,this._onStageMouseMove),$Lc.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},$Li._onStageMouseDown=function($Lr){this.closeAll()},$Li._onStageMouseMove=function($Lr){this._showToStage(this,$Lt.offsetX,$Lt.offsetY)},$Li._showToStage=function($Lr,$Li,$Lt){void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0);var $L_=$Lr.getBounds();$Lr.x=$Lc.stage.mouseX+$Li,$Lr.y=$Lc.stage.mouseY+$Lt,$Lr.x+$L_.width>$Lc.stage.width&&($Lr.x-=$L_.width+$Li),$Lr.y+$L_.height>$Lc.stage.height&&($Lr.y-=$L_.height+$Lt)},$Li.closeAll=function(){$Lc.timer.clear(this,this._showTip),$Lc.stage.off("mousemove",this,this._onStageMouseMove),$Lc.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},$Li.showDislayTip=function($Lr){this.addChild($Lr),this._showToStage(this),$Lc._currentStage.addChild(this)},$Li._showDefaultTip=function($Lr){this._tipText.text=$Lr;var $Li=this._tipBox.graphics;$Li.clear(),$Li.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,$Lt.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),$Lc._currentStage.addChild(this)},$LE(0,$Li,"defaultTipHandler",function(){return this._defaultTipHandler},function($Lr){this._defaultTipHandler=$Lr}),$Lt.offsetX=10,$Lt.offsetY=15,$Lt.tipTextColor="#ffffff",$Lt.tipBackColor="#111111",$Lt.tipDelay=200}(),function($Lr){var $Lv;function $LO(){this._idMap=null,this._aniList=null,this._watchMap={},$LO.__super.call(this)}$Lf($LO,"laya.ui.View",$LF);var $Li=$LO.prototype;return $Li.createView=function($Lr){if($Lr.animations&&!this._idMap&&(this._idMap={}),$LO.createComp($Lr,this,this),$Lr.animations){var $Li,$Lt,$L_=[],$LA=$Lr.animations,$Lf=0,$LE=$LA.length;for($Lf=0;$Lf<$LE;$Lf++){switch($Li=new $LR,$Lt=$LA[$Lf],$Li._setUp(this._idMap,$Lt),(this[$Lt.name]=$Li)._setControlNode(this),$Lt.action){case 1:$Li.play(0,!1);break;case 2:$Li.play(0,!0)}$L_.push($Li)}this._aniList=$L_}0<this._width&&null==$Lr.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},$Li.onEvent=function($Lr,$Li){},$Li.loadUI=function($Lr){var $Li=$LO.uiMap[$Lr];$Li&&this.createView($Li)},$Li.destroy=function($Lr){void 0===$Lr&&($Lr=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,$Lr)},$Li.changeData=function($Lr){var $Li=this._watchMap[$Lr];if($Li){console.log("change",$Lr);for(var $Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++){$Li[$Lt].exe(this)}}},$LO._regs=function(){for(var $Lr in $LO.uiClassMap)$LB.regClass($Lr,$LO.uiClassMap[$Lr])},$LO.createComp=function($Lr,$Li,$Lt,$L_){if(!($Li=$Li||$LO.getCompInstance($Lr)))return console.warn("can not create:"+$Lr.type),null;var $LA=$Lr.child;if($LA)for(var $Lf=$Li instanceof laya.ui.List,$LE=0,$LG=$LA.length;$LE<$LG;$LE++){var $LN=$LA[$LE];if(!$Li.hasOwnProperty("itemRender")||"render"!=$LN.props.name&&"render"!==$LN.props.renderType)if("Graphic"==$LN.type)$LB.addGraphicsToSprite($LN,$Li);else if($LB.isDrawType($LN.type))$LB.addGraphicToSprite($LN,$Li,!0);else{if($Lf){var $Lp=[],$Lg=$LO.createComp($LN,null,$Lt,$Lp);$Lp.length&&($Lg._$bindData=$Lp)}else $Lg=$LO.createComp($LN,null,$Lt,$L_);"Script"==$LN.type?"owner"in $Lg?$Lg.owner=$Li:"target"in $Lg&&($Lg.target=$Li):"mask"==$LN.props.renderType||"mask"==$LN.props.name?$Li.mask=$Lg:$Lg instanceof laya.display.Sprite&&$Li.addChild($Lg)}else $Li.itemRender=$LN}var $LR=$Lr.props;for(var $LX in $LR){var $Lv=$LR[$LX];$LO.eventDic[$LX]?$Lv&&$Lt&&$Li.on($LX,$Lt,$Lt.onEvent,[$Lv]):$LO.setCompValue($Li,$LX,$Lv,$Lt,$L_)}return $Lc.__typeof($Li,"laya.ui.IItem")&&$Li.initItems(),$Lr.compId&&$Lt&&$Lt._idMap&&($Lt._idMap[$Lr.compId]=$Li),$Li},$LO.setCompValue=function($Lr,$Li,$Lt,$L_,$LA){if("string"==typeof $Lt&&-1<$Lt.indexOf("${")){if($LO._sheet||($LO._sheet=$LB.getClass("laya.data.Table")),!$LO._sheet)return void console.warn("Can not find class Sheet");if($LA)$LA.push($Lr,$Li,$Lt);else if($L_){-1==$Lt.indexOf("].")&&($Lt=$Lt.replace(".","[0]."));var $Lf,$LE,$LG=new $Lv($Lr,$Li,$Lt);$LG.exe($L_);for(var $LN=$Lt.replace(/\[.*?\]\./g,".");null!=($Lf=$LO._parseWatchData.exec($LN));){for(var $Lp=$Lf[1];null!=($LE=$LO._parseKeyWord.exec($Lp));){var $Lg=$LE[0],$LR=$L_._watchMap[$Lg]||($L_._watchMap[$Lg]=[]);$LR.push($LG),$LO._sheet.I.notifer.on($Lg,$L_,$L_.changeData,[$Lg])}($LR=$L_._watchMap[$Lp]||($L_._watchMap[$Lp]=[])).push($LG),$LO._sheet.I.notifer.on($Lp,$L_,$L_.changeData,[$Lp])}}}else if("var"===$Li&&$L_)$L_[$Lt]=$Lr;else if("onClick"==$Li){var $LX=$Lc._runScript("(function(){"+$Lt+"})");$Lr.on("click",$L_,$LX)}else $Lr[$Li]="true"===$Lt||"false"!==$Lt&&$Lt},$LO.getCompInstance=function($Lr){var $Li,$Lt=$Lr.props?$Lr.props.runtime:null;return $Li=$Lt?$LO.viewClassMap[$Lt]||$LO.uiClassMap[$Lt]||$Lc.__classmap[$Lt]:$LO.uiClassMap[$Lr.type],$Lr.props&&$Lr.props.hasOwnProperty("renderType")&&"instance"==$Lr.props.renderType?$Li.instance:$Li?new $Li:null},$LO.regComponent=function($Lr,$Li){$LO.uiClassMap[$Lr]=$Li,$LB.regClass($Lr,$Li)},$LO.regViewRuntime=function($Lr,$Li){$LO.viewClassMap[$Lr]=$Li},$LO.uiMap={},$LO.viewClassMap={},$LO._sheet=null,$L_($LO,["uiClassMap",function(){return this.uiClassMap={ViewStack:$Lrr,LinkButton:$Lb,TextArea:$Lpr,ColorPicker:$Lh,Box:$LF,Button:$Lb,CheckBox:$LI,Clip:$LV,ComboBox:$LP,Component:$LL,HScrollBar:$LW,HSlider:$LK,Image:$LT,Label:$Lx,List:$LZ,Panel:$LM,ProgressBar:$L$,Radio:$LY,RadioGroup:$LGr,ScrollBar:$Lq,Slider:$Lm,Tab:$LNr,TextInput:$Ltr,View:$LO,VScrollBar:$Lir,VSlider:$L_r,Tree:$Lj,HBox:$Lfr,VBox:$LEr,Sprite:$La,Animation:$Lt,Text:$LD,FontClip:$LJ}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),$LO.__init$=function(){$LO._regs(),$Lv=function(){function $Lr($Lr,$Li,$Lt){this.comp=null,this.prop=null,this.value=null,this.comp=$Lr,this.prop=$Li,this.value=$Lt}return $Lf($Lr,""),$Lr.prototype.exe=function($Lr){var $Li=$LU.getBindFun(this.value);this.comp[this.prop]=$Li.call(this,$Lr)},$Lr}()},$LO}()),$LI=function($Lr){function $Lt($Lr,$Li){void 0===$Li&&($Li=""),$Lt.__super.call(this,$Lr,$Li)}$Lf($Lt,"laya.ui.CheckBox",$Lr);var $Li=$Lt.prototype;return $Li.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},$Li.initialize=function(){$Lr.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},$LE(0,$Li,"dataSource",$Lr.prototype._$get_dataSource,function($Lr){"boolean"==typeof(this._dataSource=$Lr)?this.selected=$Lr:"string"==typeof $Lr?this.selected="true"===$Lr:$Lc.superSet($Lb,this,"dataSource",$Lr)}),$Lt}($Lb),$Lz=function($Lr){function $Li(){this._space=0,this._align="none",this._itemChanged=!1,$Li.__super.call(this)}$Lf($Li,"laya.ui.LayoutBox",$LF);var $Lt=$Li.prototype;return $Lt.addChild=function($Lr){return $Lr.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,$Lr)},$Lt.onResize=function($Lr){this._setItemChanged()},$Lt.addChildAt=function($Lr,$Li){return $Lr.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,$Lr,$Li)},$Lt.removeChild=function($Lr){return $Lr.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,$Lr)},$Lt.removeChildAt=function($Lr){return this.getChildAt($Lr).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,$Lr)},$Lt.refresh=function(){this._setItemChanged()},$Lt.changeItems=function(){this._itemChanged=!1},$Lt.sortItem=function($Lr){$Lr&&$Lr.sort(function($Lr,$Li){return $Lr.y-$Li.y})},$Lt._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},$LE(0,$Lt,"space",function(){return this._space},function($Lr){this._space=$Lr,this._setItemChanged()}),$LE(0,$Lt,"align",function(){return this._align},function($Lr){this._align=$Lr,this._setItemChanged()}),$Li}(),$LJ=function($Li){function $Lt($Lr,$Li){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,$Lt.__super.call(this),$Lr&&(this.skin=$Lr),$Li&&(this.sheet=$Li)}$Lf($Lt,"laya.ui.FontClip",$Li);var $Lr=$Lt.prototype;return $Lr.createChildren=function(){this._bitmap=new $Le,this.on("loaded",this,this._onClipLoaded)},$Lr._onClipLoaded=function(){this.callLater(this.changeValue)},$Lr.changeValue=function(){var $Lr;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),$Lr=this._sources[0]))){var $Li="horizontal"===this._direction;$Li?(this._wordsW=this._valueArr.length*($Lr.sourceWidth+this.spaceX),this._wordsH=$Lr.sourceHeight):(this._wordsW=$Lr.sourceWidth,this._wordsH=($Lr.sourceHeight+this.spaceY)*this._valueArr.length);var $Lt=0;if(this._width)switch(this._align){case"center":$Lt=.5*(this._width-this._wordsW);break;case"right":$Lt=this._width-this._wordsW;break;default:$Lt=0}for(var $L_=0,$LA=this._valueArr.length;$L_<$LA;$L_++){var $Lf=this._indexMap[this._valueArr.charAt($L_)];this.sources[$Lf]&&($Lr=this.sources[$Lf],$Li?this.graphics.drawTexture($Lr,$Lt+$L_*($Lr.sourceWidth+this.spaceX),0,$Lr.sourceWidth,$Lr.sourceHeight):this.graphics.drawTexture($Lr,0+$Lt,$L_*($Lr.sourceHeight+this.spaceY),$Lr.sourceWidth,$Lr.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},$Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),$Li.prototype.destroy.call(this,$Lr)},$LE(0,$Lr,"sheet",function(){return this._sheet},function($Lr){$Lr+="";var $Li=(this._sheet=$Lr).split(" ");this._clipX=String($Li[0]).length,this.clipY=$Li.length,this._indexMap={};for(var $Lt=0;$Lt<this._clipY;$Lt++)for(var $L_=$Li[$Lt].split(""),$LA=0,$Lf=$L_.length;$LA<$Lf;$LA++)this._indexMap[$L_[$LA]]=$Lt*this._clipX+$LA}),$LE(0,$Lr,"height",$Li.prototype._$get_height,function($Lr){$Lc.superSet($LV,this,"height",$Lr),this.callLater(this.changeValue)}),$LE(0,$Lr,"direction",function(){return this._direction},function($Lr){this._direction=$Lr,this.callLater(this.changeValue)}),$LE(0,$Lr,"value",function(){return this._valueArr?this._valueArr:""},function($Lr){$Lr+="",this._valueArr=$Lr,this.callLater(this.changeValue)}),$LE(0,$Lr,"width",$Li.prototype._$get_width,function($Lr){$Lc.superSet($LV,this,"width",$Lr),this.callLater(this.changeValue)}),$LE(0,$Lr,"spaceX",function(){return this._spaceX},function($Lr){this._spaceX=$Lr,"horizontal"===this._direction&&this.callLater(this.changeValue)}),$LE(0,$Lr,"spaceY",function(){return this._spaceY},function($Lr){this._spaceY=$Lr,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),$LE(0,$Lr,"align",function(){return this._align},function($Lr){this._align=$Lr,this.callLater(this.changeValue)}),$LE(0,$Lr,"measureWidth",function(){return this._wordsW}),$LE(0,$Lr,"measureHeight",function(){return this._wordsH}),$Lt}($LV),$LZ=function($Lr){function $Li(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new $LO,$Li.__super.call(this)}$Lf($Li,"laya.ui.List",$Lr);var $Lt=$Li.prototype;return $Lc.imps($Lt,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),$Lt.destroy=function($Lr){void 0===$Lr&&($Lr=!0),this._content&&this._content.destroy($Lr),this._scrollBar&&this._scrollBar.destroy($Lr),laya.ui.Component.prototype.destroy.call(this,$Lr),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},$Lt.createChildren=function(){this.addChild(this._content=new $LF)},$Lt.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$Lc.superGet($LF,this,"cacheAs")),$Lc.superSet($LF,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},$Lt.onScrollEnd=function(){$Lc.superSet($LF,this,"cacheAs",this._$P.cacheAs)},$Lt._removePreScrollBar=function(){var $Lr=this.removeChildByName("scrollBar");$Lr&&$Lr.destroy(!0)},$Lt.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var $Lr=this._getOneCell(),$Li=$Lr.width+this._spaceX||1,$Lt=$Lr.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/$Li):Math.ceil(this._width/$Li)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/$Lt):Math.round(this._height/$Lt));var $L_=this._width?this._width:$Li*this.repeatX-this._spaceX,$LA=this._height?this._height:$Lt*this.repeatY-this._spaceY;this._cellSize=this._isVertical?$Lt:$Li,this._cellOffset=this._isVertical?$Lt*Math.max(this._repeatY2,this._repeatY)-$LA-this._spaceY:$Li*Math.max(this._repeatX2,this._repeatX)-$L_-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=$LA:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=$L_),this.setContentSize($L_,$LA);var $Lf=this._isVertical?this.repeatX:this.repeatY,$LE=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,$Lf,$LE),this._createdLine=$LE,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},$Lt._getOneCell=function(){if(0===this._cells.length){var $Lr=this.createItem();if(this._offset.setTo($Lr.x,$Lr.y),this.cacheContent)return $Lr;this._cells.push($Lr)}return this._cells[0]},$Lt._createItems=function($Lr,$Li,$Lt){var $L_=this._content,$LA=this._getOneCell(),$Lf=$LA.width+this._spaceX,$LE=$LA.height+this._spaceY;if(this.cacheContent){var $LG=new $LF;$LG.cacheAsBitmap=!0,$LG.pos((this._isVertical?0:$Lr)*$Lf,(this._isVertical?$Lr:0)*$LE),this._content.addChild($LG),this._content.optimizeScrollRect=!0,$L_=$LG}else{for(var $LN=[],$Lp=this._cells.length-1;-1<$Lp;$Lp--){var $Lg=this._cells[$Lp];$Lg.removeSelf(),$LN.push($Lg)}this._cells.length=0}for(var $LR=$Lr;$LR<$Lt;$LR++)for(var $LX=0;$LX<$Li;$LX++)($LA=$LN&&$LN.length?$LN.pop():this.createItem()).x=(this._isVertical?$LX:$LR)*$Lf-$L_.x,$LA.y=(this._isVertical?$LR:$LX)*$LE-$L_.y,$LA.name="item"+($LR*$Li+$LX),$L_.addChild($LA),this.addCell($LA)},$Lt.createItem=function(){var $Lr=[];if("function"==typeof this._itemRender)var $Li=new this._itemRender;else $Li=$Lo.createComp(this._itemRender,null,null,$Lr);if(0==$Lr.length&&$Li._watchMap){var $Lt=$Li._watchMap;for(var $L_ in $Lt)for(var $LA=$Lt[$L_],$Lf=0;$Lf<$LA.length;$Lf++){var $LE=$LA[$Lf];$Lr.push($LE.comp,$LE.prop,$LE.value)}}return $Lr.length&&($Li._$bindData=$Lr),$Li},$Lt.addCell=function($Lr){$Lr.on("click",this,this.onCellMouse),$Lr.on("rightclick",this,this.onCellMouse),$Lr.on("mouseover",this,this.onCellMouse),$Lr.on("mouseout",this,this.onCellMouse),$Lr.on("mousedown",this,this.onCellMouse),$Lr.on("mouseup",this,this.onCellMouse),this._cells.push($Lr)},$Lt.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var $Lr=0,$Li=$Lr=0;$Li<1e4;$Li++){var $Lt=this.getChildByName("item"+$Li);if(!$Lt)break;this.addCell($Lt),$Lr++}this.repeatY=$Lr}},$Lt.setContentSize=function($Lr,$Li){this._content.width=$Lr,this._content.height=$Li,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new $Ly),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,$Lr,$Li),this._content.scrollRect=this._content.scrollRect),this.event("resize")},$Lt.onCellMouse=function($Lr){"mousedown"===$Lr.type&&(this._isMoved=!1);var $Li=$Lr.currentTarget,$Lt=this._startIndex+this._cells.indexOf($Li);$Lt<0||("click"===$Lr.type||"rightclick"===$Lr.type?this.selectEnable&&!this._isMoved?this.selectedIndex=$Lt:this.changeCellState($Li,!0,0):"mouseover"!==$Lr.type&&"mouseout"!==$Lr.type||this._selectedIndex===$Lt||this.changeCellState($Li,"mouseover"===$Lr.type,0),this.mouseHandler&&this.mouseHandler.runWith([$Lr,$Lt]))},$Lt.changeCellState=function($Lr,$Li,$Lt){var $L_=$Lr.getChildByName("selectBox");$L_&&(this.selectEnable=!0,$L_.visible=$Li,$L_.index=$Lt)},$Lt.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},$Lt.onScrollBarChange=function($Lr){this.runCallLater(this.changeCells);var $Li=this._scrollBar.value,$Lt=this._isVertical?this.repeatX:this.repeatY,$L_=this._isVertical?this.repeatY:this.repeatX,$LA=Math.floor($Li/this._cellSize);if(this.cacheContent)$LE=$L_+1,this._createdLine-$LA<$LE&&(this._createItems(this._createdLine,$Lt,this._createdLine+$LE),this.renderItems(this._createdLine*$Lt,0),this._createdLine+=$LE);else{var $Lf=$LA*$Lt,$LE=0;if($Lf>this._startIndex){$LE=$Lf-this._startIndex;var $LG=!0,$LN=this._startIndex+$Lt*($L_+1);this._isMoved=!0}else $Lf<this._startIndex&&($LE=this._startIndex-$Lf,$LG=!1,$LN=this._startIndex-1,this._isMoved=!0);for(var $Lp=0;$Lp<$LE;$Lp++){if($LG){var $Lg=this._cells.shift();this._cells[this._cells.length]=$Lg;var $LR=$LN+$Lp}else $Lg=this._cells.pop(),this._cells.unshift($Lg),$LR=$LN-$Lp;var $LX=Math.floor($LR/$Lt)*this._cellSize;this._isVertical?$Lg.y=$LX:$Lg.x=$LX,this.renderItem($Lg,$LR)}this._startIndex=$Lf,this.changeSelectStatus()}var $Lv=this._content.scrollRect;this._isVertical?($Lv.y=$Li-this._offset.y,$Lv.x=-this._offset.x):($Lv.y=-this._offset.y,$Lv.x=$Li-this._offset.x),this._content.scrollRect=$Lv},$Lt.posCell=function($Lr,$Li){if(this._scrollBar){var $Lt=this._isVertical?this.repeatX:this.repeatY,$L_=(this._isVertical?this.repeatY:this.repeatX,Math.floor($Li/$Lt)*this._cellSize);this._isVertical?$Lr.y=$L_:$Lr.x=$L_}},$Lt.changeSelectStatus=function(){for(var $Lr=0,$Li=this._cells.length;$Lr<$Li;$Lr++)this.changeCellState(this._cells[$Lr],this._selectedIndex===this._startIndex+$Lr,1)},$Lt.renderItems=function($Lr,$Li){void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0);for(var $Lt=$Lr,$L_=$Li||this._cells.length;$Lt<$L_;$Lt++)this.renderItem(this._cells[$Lt],this._startIndex+$Lt);this.changeSelectStatus()},$Lt.renderItem=function($Lr,$Li){this._array&&0<=$Li&&$Li<this._array.length?($Lr.visible=!0,$Lr._$bindData?($Lr._dataSource=this._array[$Li],this._bindData($Lr,this._array[$Li])):$Lr.dataSource=this._array[$Li],this.cacheContent||this.posCell($Lr,$Li),this.hasListener("render")&&this.event("render",[$Lr,$Li]),this.renderHandler&&this.renderHandler.runWith([$Lr,$Li])):($Lr.visible=!1,$Lr.dataSource=null)},$Lt._bindData=function($Lr,$Li){for(var $Lt=$Lr._$bindData,$L_=0,$LA=$Lt.length;$L_<$LA;$L_++){var $Lf=$Lt[$L_++],$LE=$Lt[$L_++],$LG=$Lt[$L_],$LN=$LU.getBindFun($LG);$Lf[$LE]=$LN.call(this,$Li)}},$Lt.refresh=function(){this.array=this._array},$Lt.getItem=function($Lr){return-1<$Lr&&$Lr<this._array.length?this._array[$Lr]:null},$Lt.changeItem=function($Lr,$Li){-1<$Lr&&$Lr<this._array.length&&(this._array[$Lr]=$Li,$Lr>=this._startIndex&&$Lr<this._startIndex+this._cells.length&&this.renderItem(this.getCell($Lr),$Lr))},$Lt.setItem=function($Lr,$Li){this.changeItem($Lr,$Li)},$Lt.addItem=function($Lr){this._array.push($Lr),this.array=this._array},$Lt.addItemAt=function($Lr,$Li){this._array.splice($Li,0,$Lr),this.array=this._array},$Lt.deleteItem=function($Lr){this._array.splice($Lr,1),this.array=this._array},$Lt.getCell=function($Lr){return this.runCallLater(this.changeCells),-1<$Lr&&this._cells?this._cells[($Lr-this._startIndex)%this._cells.length]:null},$Lt.scrollTo=function($Lr){if(this._scrollBar){var $Li=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor($Lr/$Li)*this._cellSize}else this.startIndex=$Lr},$Lt.tweenTo=function($Lr,$Li,$Lt){if(void 0===$Li&&($Li=200),this._scrollBar){var $L_=this._isVertical?this.repeatX:this.repeatY;$Lw.to(this._scrollBar,{value:Math.floor($Lr/$L_)*this._cellSize},$Li,null,$Lt,0,!0)}else this.startIndex=$Lr,$Lt&&$Lt.run()},$Lt._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},$Lt.commitMeasure=function(){this.runCallLater(this.changeCells)},$LE(0,$Lt,"cacheAs",$Lr.prototype._$get_cacheAs,function($Lr){$Lc.superSet($LF,this,"cacheAs",$Lr),this._scrollBar&&(this._$P.cacheAs=null,"none"!==$Lr?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),$LE(0,$Lt,"content",function(){return this._content}),$LE(0,$Lt,"height",$Lr.prototype._$get_height,function($Lr){$Lr!=this._height&&($Lc.superSet($LF,this,"height",$Lr),this._setCellChanged())}),$LE(0,$Lt,"itemRender",function(){return this._itemRender},function($Lr){if(this._itemRender!=$Lr){this._itemRender=$Lr;for(var $Li=this._cells.length-1;-1<$Li;$Li--)this._cells[$Li].destroy();this._cells.length=0,this._setCellChanged()}}),$LE(0,$Lt,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($Lr){this._removePreScrollBar();var $Li=new $Lir;$Li.name="scrollBar",$Li.right=0,$Lr&&" "!=$Lr&&($Li.skin=$Lr),this.scrollBar=$Li,this.addChild($Li),this._setCellChanged()}),$LE(0,$Lt,"page",function(){return this._page},function($Lr){this._page=$Lr,this._array&&(this._page=0<$Lr?$Lr:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),$LE(0,$Lt,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($Lr){this._removePreScrollBar();var $Li=new $LW;$Li.name="scrollBar",$Li.bottom=0,$Lr&&" "!=$Lr&&($Li.skin=$Lr),this.scrollBar=$Li,this.addChild($Li),this._setCellChanged()}),$LE(0,$Lt,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function($Lr){this._repeatX=$Lr,this._setCellChanged()}),$LE(0,$Lt,"scrollBar",function(){return this._scrollBar},function($Lr){this._scrollBar!=$Lr&&(this._scrollBar=$Lr)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),$LE(0,$Lt,"width",$Lr.prototype._$get_width,function($Lr){$Lr!=this._width&&($Lc.superSet($LF,this,"width",$Lr),this._setCellChanged())}),$LE(0,$Lt,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function($Lr){this._repeatY=$Lr,this._setCellChanged()}),$LE(0,$Lt,"spaceX",function(){return this._spaceX},function($Lr){this._spaceX=$Lr,this._setCellChanged()}),$LE(0,$Lt,"spaceY",function(){return this._spaceY},function($Lr){this._spaceY=$Lr,this._setCellChanged()}),$LE(0,$Lt,"selectedIndex",function(){return this._selectedIndex},function($Lr){this._selectedIndex!=$Lr&&(this._selectedIndex=$Lr,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith($Lr),this.startIndex=this._startIndex)}),$LE(0,$Lt,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function($Lr){this.selectedIndex=this._array.indexOf($Lr)}),$LE(0,$Lt,"length",function(){return this._array?this._array.length:0}),$LE(0,$Lt,"selection",function(){return this.getCell(this._selectedIndex)},function($Lr){this.selectedIndex=this._startIndex+this._cells.indexOf($Lr)}),$LE(0,$Lt,"startIndex",function(){return this._startIndex},function($Lr){this._startIndex=0<$Lr?$Lr:0,this.callLater(this.renderItems)}),$LE(0,$Lt,"array",function(){return this._array},function($Lr){this.runCallLater(this.changeCells),this._array=$Lr||[];var $Li=this._array.length;if(this.totalPage=Math.ceil($Li/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<$Li?this._selectedIndex:$Li-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var $Lt=this._isVertical?this.repeatX:this.repeatY,$L_=this._isVertical?this.repeatY:this.repeatX,$LA=Math.ceil($Li/$Lt);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=$L_/$LA,this._scrollBar.setScroll(0,($LA-$L_)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),$LE(0,$Lt,"dataSource",$Lr.prototype._$get_dataSource,function($Lr){"number"==typeof(this._dataSource=$Lr)&&Math.floor($Lr)==$Lr||"string"==typeof $Lr?this.selectedIndex=parseInt($Lr):$Lr instanceof Array?this.array=$Lr:$Lc.superSet($LF,this,"dataSource",$Lr)}),$LE(0,$Lt,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),$Li}($LF),$LW=function($Lr){function $Li(){$Li.__super.call(this)}return $Lf($Li,"laya.ui.HScrollBar",$Lr),$Li.prototype.initialize=function(){$Lr.prototype.initialize.call(this),this.slider.isVertical=!1},$Li}($Lq),$LM=function($Lr){function $Li(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,$Li.__super.call(this),this.width=this.height=100}$Lf($Li,"laya.ui.Panel",$Lr);var $Lt=$Li.prototype;return $Lt.destroy=function($Lr){void 0===$Lr&&($Lr=!0),laya.ui.Component.prototype.destroy.call(this,$Lr),this._content&&this._content.destroy($Lr),this._vScrollBar&&this._vScrollBar.destroy($Lr),this._hScrollBar&&this._hScrollBar.destroy($Lr),this._vScrollBar=null,this._hScrollBar=null,this._content=null},$Lt.destroyChildren=function(){this._content.destroyChildren()},$Lt.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new $LF)},$Lt.addChild=function($Lr){return $Lr.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild($Lr)},$Lt.onResize=function(){this._setScrollChanged()},$Lt.addChildAt=function($Lr,$Li){return $Lr.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt($Lr,$Li)},$Lt.removeChild=function($Lr){return $Lr.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild($Lr)},$Lt.removeChildAt=function($Lr){return this.getChildAt($Lr).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt($Lr)},$Lt.removeChildren=function($Lr,$Li){return void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=2147483647),this._content.removeChildren($Lr,$Li),this._setScrollChanged(),this},$Lt.getChildAt=function($Lr){return this._content.getChildAt($Lr)},$Lt.getChildByName=function($Lr){return this._content.getChildByName($Lr)},$Lt.getChildIndex=function($Lr){return this._content.getChildIndex($Lr)},$Lt.changeScroll=function(){this._scrollChanged=!1;var $Lr=this.contentWidth||1,$Li=this.contentHeight||1,$Lt=this._vScrollBar,$L_=this._hScrollBar,$LA=$Lt&&$Li>this._height,$Lf=$L_&&$Lr>this._width,$LE=$LA?this._width-$Lt.width:this._width,$LG=$Lf?this._height-$L_.height:this._height;$Lt&&($Lt.x=this._width-$Lt.width,$Lt.y=0,$Lt.height=this._height-($Lf?$L_.height:0),$Lt.scrollSize=Math.max(.033*this._height,1),$Lt.thumbPercent=$LG/$Li,$Lt.setScroll(0,$Li-$LG,$Lt.value)),$L_&&($L_.x=0,$L_.y=this._height-$L_.height,$L_.width=this._width-($LA?$Lt.width:0),$L_.scrollSize=Math.max(.033*this._width,1),$L_.thumbPercent=$LE/$Lr,$L_.setScroll(0,$Lr-$LE,$L_.value))},$Lt.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},$Lt.setContentSize=function($Lr,$Li){var $Lt=this._content;$Lt.width=$Lr,$Lt.height=$Li,$Lt.scrollRect||($Lt.scrollRect=new $Ly),$Lt.scrollRect.setTo(0,0,$Lr,$Li),$Lt.scrollRect=$Lt.scrollRect},$Lt.onScrollBarChange=function($Lr){var $Li=this._content.scrollRect;if($Li){var $Lt=Math.round($Lr.value);$Lr.isVertical?$Li.y=$Lt:$Li.x=$Lt,this._content.scrollRect=$Li}},$Lt.scrollTo=function($Lr,$Li){void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),this.vScrollBar&&(this.vScrollBar.value=$Li),this.hScrollBar&&(this.hScrollBar.value=$Lr)},$Lt.refresh=function(){this.changeScroll()},$Lt.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$Lc.superGet($LF,this,"cacheAs")),$Lc.superSet($LF,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},$Lt.onScrollEnd=function(){$Lc.superSet($LF,this,"cacheAs",this._$P.cacheAs)},$Lt._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},$LE(0,$Lt,"numChildren",function(){return this._content.numChildren}),$LE(0,$Lt,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($Lr){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new $LW),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=$Lr}),$LE(0,$Lt,"contentWidth",function(){for(var $Lr=0,$Li=this._content.numChildren-1;-1<$Li;$Li--){var $Lt=this._content.getChildAt($Li);$Lr=Math.max($Lt.x+$Lt.width*$Lt.scaleX,$Lr)}return $Lr}),$LE(0,$Lt,"contentHeight",function(){for(var $Lr=0,$Li=this._content.numChildren-1;-1<$Li;$Li--){var $Lt=this._content.getChildAt($Li);$Lr=Math.max($Lt.y+$Lt.height*$Lt.scaleY,$Lr)}return $Lr}),$LE(0,$Lt,"width",$Lr.prototype._$get_width,function($Lr){$Lc.superSet($LF,this,"width",$Lr),this._setScrollChanged()}),$LE(0,$Lt,"hScrollBar",function(){return this._hScrollBar}),$LE(0,$Lt,"content",function(){return this._content}),$LE(0,$Lt,"height",$Lr.prototype._$get_height,function($Lr){$Lc.superSet($LF,this,"height",$Lr),this._setScrollChanged()}),$LE(0,$Lt,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($Lr){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new $Lir),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=$Lr}),$LE(0,$Lt,"vScrollBar",function(){return this._vScrollBar}),$LE(0,$Lt,"cacheAs",$Lr.prototype._$get_cacheAs,function($Lr){$Lc.superSet($LF,this,"cacheAs",$Lr),this._$P.cacheAs=null,"none"!==$Lr?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),$Li}($LF),$LK=function($Lr){function $Li($Lr){$Li.__super.call(this,$Lr),this.isVertical=!1}return $Lf($Li,"laya.ui.HSlider",$Lm),$Li}(),$LS=function($Lr){function $Lt($Lr,$Li){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,$Lt.__super.call(this),this.skin=$Li,this.labels=$Lr}$Lf($Lt,"laya.ui.UIGroup",$Lr);var $Li=$Lt.prototype;return $Lc.imps($Li,{"laya.ui.IItem":!0}),$Li.preinitialize=function(){this.mouseEnabled=!0},$Li.destroy=function($Lr){void 0===$Lr&&($Lr=!0),laya.ui.Component.prototype.destroy.call(this,$Lr),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},$Li.addItem=function($Lr,$Li){void 0===$Li&&($Li=!0);var $Lt=$Lr,$L_=this._items.length;if($Lt.name="item"+$L_,this.addChild($Lt),this.initItems(),$Li&&0<$L_){var $LA=this._items[$L_-1];"horizontal"==this._direction?$Lt.x=$LA.x+$LA.width+this._space:$Lt.y=$LA.y+$LA.height+this._space}else $Li&&($Lt.x=0,$Lt.y=0);return $L_},$Li.delItem=function($Lr,$Li){void 0===$Li&&($Li=!0);var $Lt=this._items.indexOf($Lr);if(-1!=$Lt){var $L_=$Lr;this.removeChild($L_);for(var $LA=$Lt+1,$Lf=this._items.length;$LA<$Lf;$LA++){var $LE=this._items[$LA];$LE.name="item"+($LA-1),$Li&&("horizontal"==this._direction?$LE.x-=$L_.width+this._space:$LE.y-=$L_.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var $LG;$LG=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=$LG}}},$Li.initItems=function(){this._items||(this._items=[]);for(var $Lr=this._items.length=0;$Lr<1e4;$Lr++){var $Li=this.getChildByName("item"+$Lr);if(null==$Li)break;this._items.push($Li),$Li.selected=$Lr===this._selectedIndex,$Li.clickHandler=$LX.create(this,this.itemClick,[$Lr],!1)}},$Li.itemClick=function($Lr){this.selectedIndex=$Lr},$Li.setSelect=function($Lr,$Li){this._items&&-1<$Lr&&$Lr<this._items.length&&(this._items[$Lr].selected=$Li)},$Li.createItem=function($Lr,$Li){return null},$Li.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var $Lr=0,$Li=0,$Lt=this._items.length;$Li<$Lt;$Li++){var $L_=this._items[$Li];this._skin&&($L_.skin=this._skin),this._labelColors&&($L_.labelColors=this._labelColors),this._labelSize&&($L_.labelSize=this._labelSize),this._labelStroke&&($L_.labelStroke=this._labelStroke),this._labelStrokeColor&&($L_.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&($L_.strokeColors=this._strokeColors),this._labelBold&&($L_.labelBold=this._labelBold),this._labelPadding&&($L_.labelPadding=this._labelPadding),this._labelAlign&&($L_.labelAlign=this._labelAlign),this._stateNum&&($L_.stateNum=this._stateNum),this._labelFont&&($L_.labelFont=this._labelFont),"horizontal"===this._direction?($L_.y=0,$L_.x=$Lr,$Lr+=$L_.width+this._space):($L_.x=0,$L_.y=$Lr,$Lr+=$L_.height+this._space)}this.changeSize()},$Li.commitMeasure=function(){this.runCallLater(this.changeLabels)},$Li._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},$LE(0,$Li,"labelStrokeColor",function(){return this._labelStrokeColor},function($Lr){this._labelStrokeColor!=$Lr&&(this._labelStrokeColor=$Lr,this._setLabelChanged())}),$LE(0,$Li,"skin",function(){return this._skin},function($Lr){this._skin!=$Lr&&(this._skin=$Lr,this._setLabelChanged())}),$LE(0,$Li,"selectedIndex",function(){return this._selectedIndex},function($Lr){this._selectedIndex!=$Lr&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$Lr,this.setSelect($Lr,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),$LE(0,$Li,"labels",function(){return this._labels},function($Lr){if(this._labels!=$Lr){if(this._labels=$Lr,this.removeChildren(),this._setLabelChanged(),this._labels)for(var $Li=this._labels.split(","),$Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++){var $LA=this.createItem(this._skin,$Li[$Lt]);$LA.name="item"+$Lt,this.addChild($LA)}this.initItems()}}),$LE(0,$Li,"strokeColors",function(){return this._strokeColors},function($Lr){this._strokeColors!=$Lr&&(this._strokeColors=$Lr,this._setLabelChanged())}),$LE(0,$Li,"labelColors",function(){return this._labelColors},function($Lr){this._labelColors!=$Lr&&(this._labelColors=$Lr,this._setLabelChanged())}),$LE(0,$Li,"labelStroke",function(){return this._labelStroke},function($Lr){this._labelStroke!=$Lr&&(this._labelStroke=$Lr,this._setLabelChanged())}),$LE(0,$Li,"labelSize",function(){return this._labelSize},function($Lr){this._labelSize!=$Lr&&(this._labelSize=$Lr,this._setLabelChanged())}),$LE(0,$Li,"stateNum",function(){return this._stateNum},function($Lr){this._stateNum!=$Lr&&(this._stateNum=$Lr,this._setLabelChanged())}),$LE(0,$Li,"labelBold",function(){return this._labelBold},function($Lr){this._labelBold!=$Lr&&(this._labelBold=$Lr,this._setLabelChanged())}),$LE(0,$Li,"labelFont",function(){return this._labelFont},function($Lr){this._labelFont!=$Lr&&(this._labelFont=$Lr,this._setLabelChanged())}),$LE(0,$Li,"labelPadding",function(){return this._labelPadding},function($Lr){this._labelPadding!=$Lr&&(this._labelPadding=$Lr,this._setLabelChanged())}),$LE(0,$Li,"direction",function(){return this._direction},function($Lr){this._direction=$Lr,this._setLabelChanged()}),$LE(0,$Li,"space",function(){return this._space},function($Lr){this._space=$Lr,this._setLabelChanged()}),$LE(0,$Li,"items",function(){return this._items}),$LE(0,$Li,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($Lr){this.selectedIndex=this._items.indexOf($Lr)}),$LE(0,$Li,"dataSource",$Lr.prototype._$get_dataSource,function($Lr){"number"==typeof(this._dataSource=$Lr)&&Math.floor($Lr)==$Lr||"string"==typeof $Lr?this.selectedIndex=parseInt($Lr):$Lr instanceof Array?this.labels=$Lr.join(","):$Lc.superSet($LF,this,"dataSource",$Lr)}),$Lt}($LF),$LY=function($Li){function $Lt($Lr,$Li){this._value=null,void 0===$Li&&($Li=""),$Lt.__super.call(this,$Lr,$Li)}$Lf($Lt,"laya.ui.Radio",$Li);var $Lr=$Lt.prototype;return $Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,$Lr),this._value=null},$Lr.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},$Lr.initialize=function(){$Li.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},$Lr.onClick=function($Lr){this.selected=!0},$LE(0,$Lr,"value",function(){return null!=this._value?this._value:this.label},function($Lr){this._value=$Lr}),$Lt}($Lb),$Lj=function($Lr){function $Li(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,$Li.__super.call(this),this.width=this.height=200}$Lf($Li,"laya.ui.Tree",$Lr);var $Lt=$Li.prototype;return $Lc.imps($Lt,{"laya.ui.IRender":!0}),$Lt.destroy=function($Lr){void 0===$Lr&&($Lr=!0),laya.ui.Component.prototype.destroy.call(this,$Lr),this._list&&this._list.destroy($Lr),this._list=null,this._source=null,this._renderHandler=null},$Lt.createChildren=function(){this.addChild(this._list=new $LZ),this._list.renderHandler=$LX.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},$Lt.onListChange=function($Lr){this.event("change")},$Lt.getArray=function(){var $Lr,$Li=[];for(var $Lt in this._source)$Lr=this._source[$Lt],this.getParentOpenStatus($Lr)&&($Lr.x=this._spaceLeft*this.getDepth($Lr),$Li.push($Lr));return $Li},$Lt.getDepth=function($Lr,$Li){return void 0===$Li&&($Li=0),null==$Lr.nodeParent?$Li:this.getDepth($Lr.nodeParent,$Li+1)},$Lt.getParentOpenStatus=function($Lr){var $Li=$Lr.nodeParent;return null==$Li||!!$Li.isOpen&&(null==$Li.nodeParent||this.getParentOpenStatus($Li))},$Lt.renderItem=function($Lr,$Li){var $Lt=$Lr.dataSource;if($Lt){$Lr.left=$Lt.x;var $L_=$Lr.getChildByName("arrow");$L_&&($Lt.hasChild?($L_.visible=!0,$L_.index=$Lt.isOpen?1:0,$L_.tag=$Li,$L_.off("click",this,this.onArrowClick),$L_.on("click",this,this.onArrowClick)):$L_.visible=!1);var $LA=$Lr.getChildByName("folder");$LA&&(2==$LA.clipY?$LA.index=$Lt.isDirectory?0:1:$LA.index=$Lt.isDirectory?$Lt.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([$Lr,$Li])}},$Lt.onArrowClick=function($Lr){var $Li=$Lr.currentTarget.tag;this._list.array[$Li].isOpen=!this._list.array[$Li].isOpen,this.event("open"),this._list.array=this.getArray()},$Lt.setItemState=function($Lr,$Li){this._list.array[$Lr]&&(this._list.array[$Lr].isOpen=$Li,this._list.array=this.getArray())},$Lt.fresh=function(){this._list.array=this.getArray(),this.repaint()},$Lt.parseXml=function($Lr,$Li,$Lt,$L_){var $LA,$Lf=$Lr.childNodes,$LE=$Lf.length;if(!$L_){$LA={};var $LG,$LN=$Lr.attributes;for(var $Lp in $LN){var $Lg=($LG=$LN[$Lp]).nodeName,$LR=$LG.nodeValue;$LA[$Lg]="true"==$LR||"false"!=$LR&&$LR}$LA.nodeParent=$Lt,0<$LE&&($LA.isDirectory=!0),$LA.hasChild=0<$LE,$Li.push($LA)}for(var $LX=0;$LX<$LE;$LX++){var $Lv=$Lf[$LX];this.parseXml($Lv,$Li,$LA,!1)}},$Lt.parseOpenStatus=function($Lr,$Li){for(var $Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++){var $LA=$Li[$Lt];if($LA.isDirectory)for(var $Lf=0,$LE=$Lr.length;$Lf<$LE;$Lf++){var $LG=$Lr[$Lf];if($LG.isDirectory&&this.isSameParent($LG,$LA)&&$LA.label==$LG.label){$LA.isOpen=$LG.isOpen;break}}}},$Lt.isSameParent=function($Lr,$Li){return null==$Lr.nodeParent&&null==$Li.nodeParent||null!=$Lr.nodeParent&&null!=$Li.nodeParent&&($Lr.nodeParent.label==$Li.nodeParent.label&&this.isSameParent($Lr.nodeParent,$Li.nodeParent))},$Lt.filter=function($Lr){if(Boolean($Lr)){var $Li=[];this.getFilterSource(this._source,$Li,$Lr),this._list.array=$Li}else this._list.array=this.getArray()},$Lt.getFilterSource=function($Lr,$Li,$Lt){var $L_;for(var $LA in $Lt=$Lt.toLocaleLowerCase(),$Lr)!($L_=$Lr[$LA]).isDirectory&&-1<String($L_.label).toLowerCase().indexOf($Lt)&&($L_.x=0,$Li.push($L_)),$L_.child&&0<$L_.child.length&&this.getFilterSource($L_.child,$Li,$Lt)},$LE(0,$Lt,"spaceBottom",function(){return this._list.spaceY},function($Lr){this._list.spaceY=$Lr}),$LE(0,$Lt,"keepStatus",function(){return this._keepStatus},function($Lr){this._keepStatus=$Lr}),$LE(0,$Lt,"itemRender",function(){return this._list.itemRender},function($Lr){this._list.itemRender=$Lr}),$LE(0,$Lt,"array",function(){return this._list.array},function($Lr){this._keepStatus&&this._list.array&&$Lr&&this.parseOpenStatus(this._list.array,$Lr),this._source=$Lr,this._list.array=this.getArray()}),$LE(0,$Lt,"mouseHandler",function(){return this._list.mouseHandler},function($Lr){this._list.mouseHandler=$Lr}),$LE(0,$Lt,"dataSource",$Lr.prototype._$get_dataSource,function($Lr){this._dataSource=$Lr,$Lc.superSet($LF,this,"dataSource",$Lr)}),$LE(0,$Lt,"source",function(){return this._source}),$LE(0,$Lt,"scrollBar",function(){return this._list.scrollBar}),$LE(0,$Lt,"list",function(){return this._list}),$LE(0,$Lt,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function($Lr){this._list.vScrollBarSkin=$Lr}),$LE(0,$Lt,"renderHandler",function(){return this._renderHandler},function($Lr){this._renderHandler=$Lr}),$LE(0,$Lt,"selectedIndex",function(){return this._list.selectedIndex},function($Lr){this._list.selectedIndex=$Lr}),$LE(0,$Lt,"spaceLeft",function(){return this._spaceLeft},function($Lr){this._spaceLeft=$Lr}),$LE(0,$Lt,"selectedItem",function(){return this._list.selectedItem},function($Lr){this._list.selectedItem=$Lr}),$LE(0,$Lt,"width",$Lr.prototype._$get_width,function($Lr){$Lc.superSet($LF,this,"width",$Lr),this._list.width=$Lr}),$LE(0,$Lt,"height",$Lr.prototype._$get_height,function($Lr){$Lc.superSet($LF,this,"height",$Lr),this._list.height=$Lr}),$LE(0,$Lt,"xml",null,function($Lr){var $Li=[];this.parseXml($Lr.childNodes[0],$Li,null,!0),this.array=$Li}),$LE(0,$Lt,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),$Li}($LF),$Lrr=function($Lr){function $Li(){this._items=null,this._selectedIndex=0,$Li.__super.call(this),this._setIndexHandler=$LX.create(this,this.setIndex,null,!1)}$Lf($Li,"laya.ui.ViewStack",$Lr);var $Lt=$Li.prototype;return $Lc.imps($Lt,{"laya.ui.IItem":!0}),$Lt.setItems=function($Lr){this.removeChildren();for(var $Li=0,$Lt=0,$L_=$Lr.length;$Lt<$L_;$Lt++){var $LA=$Lr[$Lt];$LA&&($LA.name="item"+$Li,this.addChild($LA),$Li++)}this.initItems()},$Lt.addItem=function($Lr){$Lr.name="item"+this._items.length,this.addChild($Lr),this.initItems()},$Lt.initItems=function(){this._items=[];for(var $Lr=0;$Lr<1e4;$Lr++){var $Li=this.getChildByName("item"+$Lr);if(null==$Li)break;this._items.push($Li),$Li.visible=$Lr==this._selectedIndex}},$Lt.setSelect=function($Lr,$Li){this._items&&-1<$Lr&&$Lr<this._items.length&&(this._items[$Lr].visible=$Li)},$Lt.setIndex=function($Lr){this.selectedIndex=$Lr},$LE(0,$Lt,"dataSource",$Lr.prototype._$get_dataSource,function($Lr){if("number"==typeof(this._dataSource=$Lr)&&Math.floor($Lr)==$Lr||"string"==typeof $Lr)this.selectedIndex=parseInt($Lr);else for(var $Li in this._dataSource)this.hasOwnProperty($Li)&&(this[$Li]=this._dataSource[$Li])}),$LE(0,$Lt,"selectedIndex",function(){return this._selectedIndex},function($Lr){this._selectedIndex!=$Lr&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$Lr,this.setSelect(this._selectedIndex,!0))}),$LE(0,$Lt,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($Lr){this.selectedIndex=this._items.indexOf($Lr)}),$LE(0,$Lt,"items",function(){return this._items}),$LE(0,$Lt,"setIndexHandler",function(){return this._setIndexHandler},function($Lr){this._setIndexHandler=$Lr}),$Li}($LF),$Lir=function($Lr){function $Li(){$Li.__super.call(this)}return $Lf($Li,"laya.ui.VScrollBar",$Lq),$Li}(),$Ltr=function($Li){function $Lt($Lr){this._bg=null,this._skin=null,$Lt.__super.call(this),void 0===$Lr&&($Lr=""),this.text=$Lr,this.skin=this.skin}$Lf($Lt,"laya.ui.TextInput",$Li);var $Lr=$Lt.prototype;return $Lr.preinitialize=function(){this.mouseEnabled=!0},$Lr.destroy=function($Lr){$LC.clearCache(this,this._skin),void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,$Lr),this._bg&&this._bg.destroy(),this._bg=null},$Lr.createChildren=function(){this.addChild(this._tf=new $Lv),this._tf.padding=$Ll.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},$Lr._onFocus=function(){this.event("focus",this)},$Lr._onBlur=function(){this.event("blur",this)},$Lr._onInput=function(){this.event("input",this)},$Lr._onEnter=function(){this.event("enter",this)},$Lr.initialize=function(){this.width=128,this.height=22},$Lr.select=function(){this._tf.select()},$Lr.setSelection=function($Lr,$Li){this._tf.setSelection($Lr,$Li)},$LE(0,$Lr,"text",$Li.prototype._$get_text,function($Lr){this._tf.text!=$Lr&&($Lr+="",this._tf.text=$Lr,this.event("change"))}),$LE(0,$Lr,"bg",function(){return this._bg},function($Lr){this.graphics=this._bg=$Lr}),$LE(0,$Lr,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function($Lr){this._tf.inputElementYAdjuster=$Lr}),$LE(0,$Lr,"multiline",function(){return this._tf.multiline},function($Lr){this._tf.multiline=$Lr}),$LE(0,$Lr,"skin",function(){return this._skin},function($Lr){this._skin!=$Lr&&($LC.clearCache(this,this._skin),this._skin=$Lr,this._bg||(this.graphics=this._bg=new $Le),$LC.keepCache(this,this._skin),this._bg.source=$LC.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),$LE(0,$Lr,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function($Lr){this._bg||(this.graphics=this._bg=new $Le),this._bg.sizeGrid=$LU.fillArray($Ll.defaultSizeGrid,$Lr,Number)}),$LE(0,$Lr,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function($Lr){this._tf.inputElementXAdjuster=$Lr}),$LE(0,$Lr,"width",$Li.prototype._$get_width,function($Lr){$Lc.superSet($Lx,this,"width",$Lr),this._bg&&(this._bg.width=$Lr)}),$LE(0,$Lr,"height",$Li.prototype._$get_height,function($Lr){$Lc.superSet($Lx,this,"height",$Lr),this._bg&&(this._bg.height=$Lr)}),$LE(0,$Lr,"editable",function(){return this._tf.editable},function($Lr){this._tf.editable=$Lr}),$LE(0,$Lr,"restrict",function(){return this._tf.restrict},function($Lr){this._tf.restrict=$Lr}),$LE(0,$Lr,"prompt",function(){return this._tf.prompt},function($Lr){this._tf.prompt=$Lr}),$LE(0,$Lr,"promptColor",function(){return this._tf.promptColor},function($Lr){this._tf.promptColor=$Lr}),$LE(0,$Lr,"maxChars",function(){return this._tf.maxChars},function($Lr){this._tf.maxChars=$Lr}),$LE(0,$Lr,"focus",function(){return this._tf.focus},function($Lr){this._tf.focus=$Lr}),$LE(0,$Lr,"type",function(){return this._tf.type},function($Lr){this._tf.type=$Lr}),$LE(0,$Lr,"asPassword",function(){return this._tf.asPassword},function($Lr){this._tf.asPassword=$Lr}),$Lt}($Lx),$L_r=function($Lr){function $Li(){$Li.__super.call(this)}return $Lf($Li,"laya.ui.VSlider",$Lm),$Li}(),$LAr=function($Lr){function $L_(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,$L_.__super.call(this)}$Lf($L_,"laya.ui.Dialog",$Lr);var $Li=$L_.prototype;return $Li.initialize=function(){this.popupEffect=$L_.manager.popupEffectHandler,this.closeEffect=$L_.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},$Li._dealDragArea=function(){var $Lr=this.getChildByName("drag");$Lr&&(this.dragArea=$Lr.x+","+$Lr.y+","+$Lr.width+","+$Lr.height,$Lr.removeSelf())},$Li._onClick=function($Lr){var $Li=$Lr.target;if($Li)switch($Li.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close($Li.name)}},$Li.show=function($Lr,$Li){void 0===$Lr&&($Lr=!1),void 0===$Li&&($Li=!0),this._open(!1,$Lr,$Li)},$Li.popup=function($Lr,$Li){void 0===$Lr&&($Lr=!1),void 0===$Li&&($Li=!0),this._open(!0,$Lr,$Li)},$Li._open=function($Lr,$Li,$Lt){$L_.manager.lock(!1),this.isModal=$Lr,$L_.manager.open(this,$Li,$Lt)},$Li.onOpened=function(){},$Li.close=function($Lr,$Li){void 0===$Li&&($Li=!0),$L_.manager.close(this,$Lr,$Li)},$Li.onClosed=function($Lr){},$Li._onMouseDown=function($Lr){var $Li=this.getMousePoint();this._dragArea.contains($Li.x,$Li.y)?this.startDrag():this.stopDrag()},$LE(0,$Li,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function($Lr){if($Lr){var $Li=$LU.fillArray([0,0,0,0],$Lr,Number);this._dragArea=new $Ly($Li[0],$Li[1],$Li[2],$Li[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),$LE(0,$Li,"isPopup",function(){return null!=this.parent}),$LE(0,$Li,"zOrder",$Lr.prototype._$get_zOrder,function($Lr){$Lc.superSet($Lo,this,"zOrder",$Lr),$L_.manager._checkMask()}),$LE(1,$L_,"manager",function(){return $L_._manager=$L_._manager||new $LQ},function($Lr){$L_._manager=$Lr}),$L_.setLockView=function($Lr){$L_.manager.setLockView($Lr)},$L_.lock=function($Lr){$L_.manager.lock($Lr)},$L_.closeAll=function(){$L_.manager.closeAll()},$L_.getDialogsByGroup=function($Lr){return $L_.manager.getDialogsByGroup($Lr)},$L_.closeByGroup=function($Lr){return $L_.manager.closeByGroup($Lr)},$L_.CLOSE="close",$L_.CANCEL="cancel",$L_.SURE="sure",$L_.NO="no",$L_.OK="ok",$L_.YES="yes",$L_._manager=null,$L_}($Lo),$Lfr=function($Lr){function $Li(){$Li.__super.call(this)}$Lf($Li,"laya.ui.HBox",$Lr);var $Lt=$Li.prototype;return $Lt.sortItem=function($Lr){$Lr&&$Lr.sort(function($Lr,$Li){return $Lr.x-$Li.x})},$Lt.changeItems=function(){this._itemChanged=!1;for(var $Lr=[],$Li=0,$Lt=0,$L_=this.numChildren;$Lt<$L_;$Lt++){var $LA=this.getChildAt($Lt);$LA&&$LA.layoutEnabled&&($Lr.push($LA),$Li=this._height?this._height:Math.max($Li,$LA.height*$LA.scaleY))}this.sortItem($Lr);var $Lf=0;for($Lt=0,$L_=$Lr.length;$Lt<$L_;$Lt++)($LA=$Lr[$Lt]).x=$Lf,$Lf+=$LA.width*$LA.scaleX+this._space,"top"==this._align?$LA.y=0:"middle"==this._align?$LA.y=.5*($Li-$LA.height*$LA.scaleY):"bottom"==this._align&&($LA.y=$Li-$LA.height*$LA.scaleY);this.changeSize()},$LE(0,$Lt,"height",$Lr.prototype._$get_height,function($Lr){this._height!=$Lr&&($Lc.superSet($Lz,this,"height",$Lr),this.callLater(this.changeItems))}),$Li.NONE="none",$Li.TOP="top",$Li.MIDDLE="middle",$Li.BOTTOM="bottom",$Li}($Lz),$LEr=function($Lr){function $Li(){$Li.__super.call(this)}$Lf($Li,"laya.ui.VBox",$Lr);var $Lt=$Li.prototype;return $Lt.changeItems=function(){this._itemChanged=!1;for(var $Lr=[],$Li=0,$Lt=0,$L_=this.numChildren;$Lt<$L_;$Lt++){var $LA=this.getChildAt($Lt);$LA&&$LA.layoutEnabled&&($Lr.push($LA),$Li=this._width?this._width:Math.max($Li,$LA.width*$LA.scaleX))}this.sortItem($Lr);var $Lf=0;for($Lt=0,$L_=$Lr.length;$Lt<$L_;$Lt++)($LA=$Lr[$Lt]).y=$Lf,$Lf+=$LA.height*$LA.scaleY+this._space,"left"==this._align?$LA.x=0:"center"==this._align?$LA.x=.5*($Li-$LA.width*$LA.scaleX):"right"==this._align&&($LA.x=$Li-$LA.width*$LA.scaleX);this.changeSize()},$LE(0,$Lt,"width",$Lr.prototype._$get_width,function($Lr){this._width!=$Lr&&($Lc.superSet($Lz,this,"width",$Lr),this.callLater(this.changeItems))}),$Li.NONE="none",$Li.LEFT="left",$Li.CENTER="center",$Li.RIGHT="right",$Li}($Lz),$LGr=function($Lr){function $Li(){$Li.__super.call(this)}return $Lf($Li,"laya.ui.RadioGroup",$LS),$Li.prototype.createItem=function($Lr,$Li){return new $LY($Lr,$Li)},$Li}(),$LNr=function($Lr){function $Li(){$Li.__super.call(this)}return $Lf($Li,"laya.ui.Tab",$LS),$Li.prototype.createItem=function($Lr,$Li){return new $Lb($Lr,$Li)},$Li}(),$Lpr=function($Li){function $Lt($Lr){this._vScrollBar=null,this._hScrollBar=null,void 0===$Lr&&($Lr=""),$Lt.__super.call(this,$Lr)}$Lf($Lt,"laya.ui.TextArea",$Li);var $Lr=$Lt.prototype;return $Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,$Lr),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},$Lr.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},$Lr.onVBarChanged=function($Lr){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},$Lr.onHBarChanged=function($Lr){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},$Lr.changeScroll=function(){var $Lr=this._vScrollBar&&0<this._tf.maxScrollY,$Li=this._hScrollBar&&0<this._tf.maxScrollX,$Lt=$Lr?this._width-this._vScrollBar.width:this._width,$L_=$Li?this._height-this._hScrollBar.height:this._height,$LA=this._tf.padding||$Ll.labelPadding;this._tf.width=$Lt,this._tf.height=$L_,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-$LA[2],this._vScrollBar.y=$LA[1],this._vScrollBar.height=this._height-($Li?this._hScrollBar.height:0)-$LA[1]-$LA[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=$L_/Math.max(this._tf.textHeight,$L_),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=$Lr),this._hScrollBar&&(this._hScrollBar.x=$LA[0],this._hScrollBar.y=this._height-this._hScrollBar.height-$LA[3],this._hScrollBar.width=this._width-($Lr?this._vScrollBar.width:0)-$LA[0]-$LA[2],this._hScrollBar.scrollSize=Math.max(.033*$Lt,1),this._hScrollBar.thumbPercent=$Lt/Math.max(this._tf.textWidth,$Lt),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=$Li)},$Lr.scrollTo=function($Lr){this.commitMeasure(),this._tf.scrollY=$Lr},$LE(0,$Lr,"scrollY",function(){return this._tf.scrollY}),$LE(0,$Lr,"width",$Li.prototype._$get_width,function($Lr){$Lc.superSet($Ltr,this,"width",$Lr),this.callLater(this.changeScroll)}),$LE(0,$Lr,"hScrollBar",function(){return this._hScrollBar}),$LE(0,$Lr,"height",$Li.prototype._$get_height,function($Lr){$Lc.superSet($Ltr,this,"height",$Lr),this.callLater(this.changeScroll)}),$LE(0,$Lr,"maxScrollX",function(){return this._tf.maxScrollX}),$LE(0,$Lr,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($Lr){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new $Lir),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=$Lr}),$LE(0,$Lr,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($Lr){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new $LW),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=$Lr}),$LE(0,$Lr,"vScrollBar",function(){return this._vScrollBar}),$LE(0,$Lr,"maxScrollY",function(){return this._tf.maxScrollY}),$LE(0,$Lr,"scrollX",function(){return this._tf.scrollX}),$Lt}($Ltr);!function($Lr){function $Li(){this._uiView=null,this.isCloseOther=!1,$Li.__super.call(this)}$Lf($Li,"laya.ui.AsynDialog",$LAr);var $Lt=$Li.prototype;$Lt.createView=function($Lr){this._uiView=$Lr},$Lt._open=function($Lr,$Li,$Lt){this.isModal=$Lr,this.isCloseOther=$Li,$LAr.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},$Lt.onCreated=function(){this.createUI(),this.onOpen()},$Lt.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},$Lt.onOpen=function(){$LAr.manager.open(this,this.isCloseOther),$LAr.manager.lock(!1)},$Lt.close=function($Lr,$Li){void 0===$Li&&($Li=!0),$LAr.manager.close(this),this.onClose()},$Lt.onClose=function(){},$Lt.destroy=function($Lr){void 0===$Lr&&($Lr=!0),laya.ui.View.prototype.destroy.call(this,$Lr),this._uiView=null,this.onDestroy()},$Lt.onDestroy=function(){}}();$Lc.__init([$Lo])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($Lr,$Li){"use strict";for(var $Lt in Object.defineProperty($Li,"__esModule",{value:!0}),Laya){var $L_=Laya[$Lt];$L_&&$L_.__isclass&&($Li[$Lt]=$L_)}}),function($LX,$Lr,$LD){$LD.un,$LD.uns;var $LR=$LD.static,$Lv=$LD.class,$LO=$LD.getset,$L_=$LD.__newvec,$La=laya.maths.Arith,$LE=laya.webgl.atlas.AtlasResourceManager,$Lt=laya.webgl.shader.BaseShader,$LL=laya.utils.Browser,$LG=laya.webgl.utils.Buffer,$Lu=laya.utils.Byte,$LA=laya.utils.ClassUtils,$LN=$LD.Config,$Lf=(laya.events.Event,laya.events.EventDispatcher),$Ll=laya.utils.Handler,$Ly=laya.net.Loader,$Li=laya.net.LoaderManager,$Lp=(laya.maths.MathUtil,laya.display.Node),$Lc=laya.renders.Render,$Lg=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),$LB=laya.resource.Resource,$LC=laya.utils.RunDriver,$Ln=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),$Lw=laya.display.Sprite,$LH=laya.utils.Stat,$Ls=laya.utils.StringKey,$LU=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),$Ld=laya.utils.Utils,$Lk=laya.webgl.WebGL,$Le=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;$LD.interface("laya.d3.core.IClone"),$LD.interface("laya.d3.graphics.IVertex"),$LD.interface("laya.d3.core.render.IUpdate"),$LD.interface("laya.d3.core.scene.ITreeNode"),$LD.interface("laya.d3.core.render.IRenderable");(function(){function $Lb(){}$Lv($Lb,"laya.d3.animation.AnimationClipParser01"),$Lb.READ_DATA=function(){$Lb._DATA.offset=$Lb._reader.getUint32(),$Lb._DATA.size=$Lb._reader.getUint32()},$Lb.READ_BLOCK=function(){for(var $Lr=$Lb._BLOCK.count=$Lb._reader.getUint16(),$Li=$Lb._BLOCK.blockStarts=[],$Lt=$Lb._BLOCK.blockLengths=[],$L_=0;$L_<$Lr;$L_++)$Li.push($Lb._reader.getUint32()),$Lt.push($Lb._reader.getUint32())},$Lb.READ_STRINGS=function(){var $Lr=$Lb._reader.getUint32(),$Li=$Lb._reader.getUint16(),$Lt=$Lb._reader.pos;$Lb._reader.pos=$Lr+$Lb._DATA.offset;for(var $L_=0;$L_<$Li;$L_++)$Lb._strings[$L_]=$Lb._reader.readUTFString();$Lb._reader.pos=$Lt},$Lb.parse=function($Lr,$Li){$Lb._animationClip=$Lr;($Lb._reader=$Li).__getBuffer();$Lb.READ_DATA(),$Lb.READ_BLOCK(),$Lb.READ_STRINGS();for(var $Lt=0,$L_=$Lb._BLOCK.count;$Lt<$L_;$Lt++){var $LA=$Li.getUint16(),$Lf=$Lb._strings[$LA],$LE=$Lb["READ_"+$Lf];if(null==$LE)throw new Error("model file err,no this function:"+$LA+" "+$Lf);$LE.call()}},$Lb.READ_ANIMATIONS=function(){var $Lr,$Li=0,$Lt=0,$L_=$Lb._reader,$LA=$L_.__getBuffer(),$Lf=[],$LE=$L_.getUint8();for($Lf.length=$LE,$Li=0;$Li<$LE;$Li++)$Lf[$Li]=$L_.getUint16();var $LG=[],$LN=$L_.getUint16();for($LG.length=$LN,$Li=0;$Li<$LN;$Li++)$LG[$Li]=$L_.getFloat32();var $Lp=$Lb._animationClip;$Lp.name=$Lb._strings[$L_.getUint16()];var $Lg=$Lp._duration=$L_.getFloat32();$Lp.islooping=!!$L_.getByte(),$Lp._frameRate=$L_.getInt16();var $LR=$L_.getInt16(),$LX=$Lp._nodes=new Array;$LX.length=$LR,($Lp._publicClipDatas=[]).length=$LR;var $Lv=$Lp._nodesMap={},$LO=0,$Lc=0;for($Li=0;$Li<$LR;$Li++){$Lr=$LX[$Li]=new $L$;var $LB=$L_.getUint16(),$Ly=$Lr.path=[];for($Ly.length=$LB,$Lt=0;$Lt<$LB;$Lt++)$Ly[$Lt]=$Lb._strings[$L_.getUint16()];var $LC=$Ly.join("/"),$Ln=$Lv[$LC];$Ln||($Lv[$LC]=$Ln=[]),$Ln.push($Lr);var $La=$L_.getInt16();-1!==$La&&($Lr.componentType=$Lb._strings[$La]);var $LD=$LT._propertyIndexDic[$Lb._strings[$L_.getUint16()]];if(null==$LD)throw new Error("AnimationClipParser01:unknown property name.");var $Lu=$LD<4,$Lw=!$Lu||$Lu&&""===$Ly[0];($Lr._cacheProperty=$Lw)?$LO++:$Lc++,$Lr.propertyNameID=$LD;var $LH=$Lf[$L_.getUint8()];$Lr.keyFrameWidth=$LH/4;var $Ls=$Lr.keyFrames=[],$Ld=$Ls.length=$L_.getUint16(),$Ll=null,$LU=NaN;for($Lt=0;$Lt<$Ld;$Lt++){var $Lk=$Ls[$Lt]=new $Lx;$LU=$Lk.startTime=$LG[$L_.getUint16()];var $Le=$L_.pos;$Lk.inTangent=new Float32Array($LA.slice($Le,$Le+$LH)),$L_.pos+=$LH,$Le=$L_.pos,$Lk.outTangent=new Float32Array($LA.slice($Le,$Le+$LH)),$L_.pos+=$LH,$Le=$L_.pos,$Lk.data=new Float32Array($LA.slice($Le,$Le+$LH)),$L_.pos+=$LH,$Ll&&($Ll.next=$Lk,$Ll.duration=$LU-$Ll.startTime),$Ll=$Lk}$Lk.next=null,$Lk.duration=$Lg-$LU}var $LL=$Lp._nodeToCachePropertyMap=new Int32Array($LR),$LQ=$Lp._cachePropertyMap=new Int32Array($LO),$LF=$Lp._unCachePropertyMap=new Int32Array($Lc);for($LO=$Lc=0,$Li=0;$Li<$LR;$Li++)($Lr=$LX[$Li])._cacheProperty?($LL[$Li]=$LO,$LQ[$LO++]=$Li):$LF[$Lc++]=$Li},$Lb._animationClip=null,$Lb._reader=null,$Lb._strings=[],$LR($Lb,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function $Lq(){}$Lv($Lq,"laya.d3.animation.AnimationClipParser02"),$Lq.READ_DATA=function(){$Lq._DATA.offset=$Lq._reader.getUint32(),$Lq._DATA.size=$Lq._reader.getUint32()},$Lq.READ_BLOCK=function(){for(var $Lr=$Lq._BLOCK.count=$Lq._reader.getUint16(),$Li=$Lq._BLOCK.blockStarts=[],$Lt=$Lq._BLOCK.blockLengths=[],$L_=0;$L_<$Lr;$L_++)$Li.push($Lq._reader.getUint32()),$Lt.push($Lq._reader.getUint32())},$Lq.READ_STRINGS=function(){var $Lr=$Lq._reader.getUint32(),$Li=$Lq._reader.getUint16(),$Lt=$Lq._reader.pos;$Lq._reader.pos=$Lr+$Lq._DATA.offset;for(var $L_=0;$L_<$Li;$L_++)$Lq._strings[$L_]=$Lq._reader.readUTFString();$Lq._reader.pos=$Lt},$Lq.parse=function($Lr,$Li){$Lq._animationClip=$Lr;($Lq._reader=$Li).__getBuffer();$Lq.READ_DATA(),$Lq.READ_BLOCK(),$Lq.READ_STRINGS();for(var $Lt=0,$L_=$Lq._BLOCK.count;$Lt<$L_;$Lt++){var $LA=$Li.getUint16(),$Lf=$Lq._strings[$LA],$LE=$Lq["READ_"+$Lf];if(null==$LE)throw new Error("model file err,no this function:"+$LA+" "+$Lf);$LE.call()}},$Lq.READ_ANIMATIONS=function(){var $Lr,$Li=0,$Lt=0,$L_=$Lq._reader,$LA=$L_.__getBuffer(),$Lf=[],$LE=$L_.getUint8();for($Lf.length=$LE,$Li=0;$Li<$LE;$Li++)$Lf[$Li]=$L_.getUint16();var $LG=[],$LN=$L_.getUint16();for($LG.length=$LN,$Li=0;$Li<$LN;$Li++)$LG[$Li]=$L_.getFloat32();var $Lp=$Lq._animationClip;$Lp.name=$Lq._strings[$L_.getUint16()];var $Lg=$Lp._duration=$L_.getFloat32();$Lp.islooping=!!$L_.getByte(),$Lp._frameRate=$L_.getInt16();var $LR=$L_.getInt16(),$LX=$Lp._nodes=new Array;$LX.length=$LR,($Lp._publicClipDatas=[]).length=$LR;var $Lv=$Lp._nodesMap={},$LO=0,$Lc=0;for($Li=0;$Li<$LR;$Li++){$Lr=$LX[$Li]=new $L$;var $LB=$L_.getUint16(),$Ly=$Lr.path=[];for($Ly.length=$LB,$Lt=0;$Lt<$LB;$Lt++)$Ly[$Lt]=$Lq._strings[$L_.getUint16()];var $LC=$Ly.join("/"),$Ln=$Lv[$LC];$Ln||($Lv[$LC]=$Ln=[]),$Ln.push($Lr);var $La=$L_.getInt16();-1!==$La&&($Lr.componentType=$Lq._strings[$La]);var $LD=$LT._propertyIndexDic[$Lq._strings[$L_.getUint16()]];if(null==$LD)throw new Error("AnimationClipParser02:unknown property name.");var $Lu=$LD<4,$Lw=!$Lu||$Lu&&""===$Ly[0];($Lr._cacheProperty=$Lw)?$LO++:$Lc++,$Lr.propertyNameID=$LD;var $LH=$Lf[$L_.getUint8()];$Lr.keyFrameWidth=$LH/4;var $Ls=$Lr.keyFrames=[],$Ld=$Ls.length=$L_.getUint16(),$Ll=null,$LU=NaN;for($Lt=0;$Lt<$Ld;$Lt++){var $Lk=$Ls[$Lt]=new $Lx;$LU=$Lk.startTime=$LG[$L_.getUint16()];var $Le=$L_.pos;$Lk.inTangent=new Float32Array($LA.slice($Le,$Le+$LH)),$L_.pos+=$LH,$Le=$L_.pos,$Lk.outTangent=new Float32Array($LA.slice($Le,$Le+$LH)),$L_.pos+=$LH,$Le=$L_.pos,$Lk.data=new Float32Array($LA.slice($Le,$Le+$LH)),$L_.pos+=$LH,$Ll&&($Ll.next=$Lk,$Ll.duration=$LU-$Ll.startTime),$Ll=$Lk}$Lk.next=null,$Lk.duration=$Lg-$LU}var $LL=$L_.getUint16();for($Li=0;$Li<$LL;$Li++){var $LQ,$LF=new $Lm;$LF.time=$L_.getFloat32(),$LF.eventName=$Lq._strings[$L_.getUint16()];var $Lb=$L_.getUint16();for(0<$Lb&&($LF.params=$LQ=[]),$Lt=0;$Lt<$Lb;$Lt++){switch($L_.getByte()){case 0:$LQ.push(!!$L_.getByte());break;case 1:$LQ.push($L_.getInt32());break;case 2:$LQ.push($L_.getFloat32());break;case 3:$LQ.push($Lq._strings[$L_.getUint16()]);break;default:throw new Error("unknown type.")}}$Lp.addEvent($LF)}var $LV=$Lp._nodeToCachePropertyMap=new Int32Array($LR),$Lh=$Lp._cachePropertyMap=new Int32Array($LO),$LP=$Lp._unCachePropertyMap=new Int32Array($Lc);for($LO=$Lc=0,$Li=0;$Li<$LR;$Li++)($Lr=$LX[$Li])._cacheProperty?($LV[$Li]=$LO,$Lh[$LO++]=$Li):$LP[$Lc++]=$Li},$Lq._animationClip=null,$Lq._reader=null,$Lq._strings=[],$LR($Lq,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var $Lm=function(){function $Lr(){this.time=NaN,this.eventName=null,this.params=null}return $Lv($Lr,"laya.d3.animation.AnimationEvent"),$Lr}(),$LT=function(){function $L_(){this._childs=[],this.transform=new $LCi(this)}$Lv($L_,"laya.d3.animation.AnimationNode");var $Lr=$L_.prototype;return $LD.imps($Lr,{"laya.d3.core.IClone":!0}),$Lr.addChild=function($Lr){$Lr._parent=this,$Lr.transform.setParent(this.transform),this._childs.push($Lr)},$Lr.removeChild=function($Lr){var $Li=this._childs.indexOf($Lr);-1!==$Li&&this._childs.splice($Li,1)},$Lr.getChildByName=function($Lr){for(var $Li=0,$Lt=this._childs.length;$Li<$Lt;$Li++){var $L_=this._childs[$Li];if($L_.name===$Lr)return $L_}return null},$Lr.getChildByIndex=function($Lr){return this._childs[$Lr]},$Lr.getChildCount=function(){return this._childs.length},$Lr.cloneTo=function($Lr){var $Li=$Lr;$Li.name=this.name;for(var $Lt=0,$L_=this._childs.length;$Lt<$L_;$Lt++){var $LA=this._childs[$Lt],$Lf=$LA.clone();$Li.addChild($Lf);var $LE=$LA.transform,$LG=$Lf.transform;$LG.setLocalPosition($LE.getLocalPosition()),$LG.setLocalRotation($LE.getLocalRotation()),$LG.setLocalScale($LE.getLocalScale()),$LG._localRotationEuler=$LE._localRotationEuler,$LG._setWorldMatrixIgnoreUpdate($LE.getWorldMatrix())}},$Lr.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$L_.__init__=function(){$L_.registerAnimationNodeProperty("localPosition",$L_._getLocalPosition,$L_._setLocalPosition),$L_.registerAnimationNodeProperty("localRotation",$L_._getLocalRotation,$L_._setLocalRotation),$L_.registerAnimationNodeProperty("localScale",$L_._getLocalScale,$L_._setLocalScale),$L_.registerAnimationNodeProperty("localRotationEuler",$L_._getLocalRotationEuler,$L_._setLocalRotationEuler),$L_.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",$L_._getParticleRenderSharedMaterialTintColor,$L_._setParticleRenderSharedMaterialTintColor),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",$L_._getMeshRenderSharedMaterialTilingOffset,$L_._setMeshRenderSharedMaterialTilingOffset),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",$L_._getMeshRenderSharedMaterialAlbedo,$L_._setMeshRenderSharedMaterialAlbedo),$L_.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",$L_._getSkinnedMeshRenderSharedMaterialTilingOffset,$L_._setSkinnedMeshRenderSharedMaterialTilingOffset),$L_.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",$L_._getSkinnedMeshRenderSharedMaterialAlbedo,$L_._setSkinnedMeshRenderSharedMaterialAlbedo),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",$L_._getMeshRenderSharedMaterialAlbedo,$L_._setMeshRenderSharedMaterialAlbedo),$L_.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",$L_._getSkinnedMeshRenderSharedMaterialAlbedo,$L_._setSkinnedMeshRenderSharedMaterialAlbedo),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",$L_._getMeshRenderSharedMaterialIntensity,$L_._setMeshRenderSharedMaterialIntensity),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",$L_._getMeshRenderSharedMaterialAlpha,$L_._setMeshRenderSharedMaterialAlpha),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",$L_._getMeshRenderSharedMaterialAlphaColor,$L_._setMeshRenderSharedMaterialAlphaColor),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",$L_._getMeshRenderSharedMaterialBaseColor,$L_._setMeshRenderSharedMaterialBaseColor),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",$L_._getMeshRenderSharedMaterialDissolve,$L_._setMeshRenderSharedMaterialDissolve),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",$L_._getMeshRenderSharedMaterialDissolveSpeed,$L_._setMeshRenderSharedMaterialDissolveSpeed),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",$L_._getMeshRenderSharedMaterialMMultiplier,$L_._setMeshRenderSharedMaterialMMultiplier),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",$L_._getMeshRenderSharedMaterialBaseScrollSpeedX,$L_._setMeshRenderSharedMaterialBaseScrollSpeedX),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",$L_._getMeshRenderSharedMaterialBaseScrollSpeedY,$L_._setMeshRenderSharedMaterialBaseScrollSpeedY),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",$L_._getMeshRenderSharedMaterialSecondScrollSpeedX,$L_._setMeshRenderSharedMaterialSecondScrollSpeedX),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",$L_._getMeshRenderSharedMaterialSecondScrollSpeedY,$L_._setMeshRenderSharedMaterialSecondScrollSpeedY),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",$L_._getMeshRenderSharedMaterialDetailTilingOffset,$L_._setMeshRenderSharedMaterialDetailTilingOffset),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",$L_._getMeshRenderSharedMaterialDissolveTilingOffset,$L_._setMeshRenderSharedMaterialDissolveTilingOffset),$L_.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",$L_._getMeshRenderSharedMaterialMaskTilingOffset,$L_._setMeshRenderSharedMaterialMaskTilingOffset)},$L_.registerAnimationNodeProperty=function($Lr,$Li,$Lt){if($L_._propertyIndexDic[$Lr])throw new Error("AnimationNode: this propertyName has registered.");$L_._propertyIndexDic[$Lr]=$L_._propertyIDCounter,$L_._propertyGetFuncs[$L_._propertyIDCounter]=$Li,$L_._propertySetFuncs[$L_._propertyIDCounter]=$Lt,$L_._propertyIDCounter++},$L_._getLocalPosition=function($Lr,$Li){return $Lr?$Lr.transform.getLocalPosition():$Li._transform.localPosition.elements},$L_._setLocalPosition=function($Lr,$Li,$Lt){if($Lr)$Lr.transform.setLocalPosition($Lt);else{var $L_=$Li._transform,$LA=$L_.localPosition;$LA.elements=$Lt,$L_.localPosition=$LA}},$L_._getLocalRotation=function($Lr,$Li){return $Lr?$Lr.transform.getLocalRotation():$Li._transform.localRotation.elements},$L_._setLocalRotation=function($Lr,$Li,$Lt){if($Lr)$Lr.transform.setLocalRotation($Lt);else{var $L_=$Li._transform,$LA=$L_.localRotation;$LA.elements=$Lt,$L_.localRotation=$LA}},$L_._getLocalScale=function($Lr,$Li){return $Lr?$Lr.transform.getLocalScale():$Li._transform.localScale.elements},$L_._setLocalScale=function($Lr,$Li,$Lt){if($Lr)$Lr.transform.setLocalScale($Lt);else{var $L_=$Li._transform,$LA=$L_.localScale;$LA.elements=$Lt,$L_.localScale=$LA}},$L_._getLocalRotationEuler=function($Lr,$Li){return $Lr?$Lr.transform.getLocalRotationEuler():$Li._transform.localRotationEuler.elements},$L_._setLocalRotationEuler=function($Lr,$Li,$Lt){if($Lr)$Lr.transform.setLocalRotationEuler($Lt);else{var $L_=$Li._transform,$LA=$L_.localRotationEuler;$LA.elements=$Lt,$L_.localRotationEuler=$LA}},$L_._getMeshRenderSharedMaterialTilingOffset=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return $Li.meshRender.sharedMaterial.tilingOffset.elements},$L_._setMeshRenderSharedMaterialTilingOffset=function($Lr,$Li,$Lt){var $L_,$LA;if($Lr){var $Lf=$Lr.transform._entity;$Lf&&(($LA=($L_=$Lf.owner.meshRender.material).tilingOffset).elements=$Lt,$L_.tilingOffset=$LA)}else($LA=($L_=$Li.meshRender.material).tilingOffset).elements=$Lt,$L_.tilingOffset=$LA},$L_._getMeshRenderSharedMaterialAlbedo=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.albedoColor.elements:null}return $Li.meshRender.sharedMaterial.albedoColor.elements},$L_._setMeshRenderSharedMaterialAlbedo=function($Lr,$Li,$Lt){var $L_,$LA;if($Lr){var $Lf=$Lr.transform._entity;$Lf&&(($LA=($L_=$Lf.owner.meshRender.material).albedoColor).elements=$Lt,$L_.albedoColor=$LA)}else($LA=($L_=$Li.meshRender.material).albedoColor).elements=$Lt,$L_.albedoColor=$LA},$L_._getSkinnedMeshRenderSharedMaterialTilingOffset=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return $Li.skinnedMeshRender.sharedMaterial.tilingOffset.elements},$L_._setSkinnedMeshRenderSharedMaterialTilingOffset=function($Lr,$Li,$Lt){var $L_,$LA;if($Lr){var $Lf=$Lr.transform._entity;$Lf&&(($LA=($L_=$Lf.owner.skinnedMeshRender.material).tilingOffset).elements=$Lt,$L_.tilingOffset=$LA)}else($LA=($L_=$Li.skinnedMeshRender.material).tilingOffset).elements=$Lt,$L_.tilingOffset=$LA},$L_._getSkinnedMeshRenderSharedMaterialAlbedo=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return $Li.skinnedMeshRender.sharedMaterial.albedoColor.elements},$L_._setSkinnedMeshRenderSharedMaterialAlbedo=function($Lr,$Li,$Lt){var $L_,$LA;if($Lr){var $Lf=$Lr.transform._entity;$Lf&&(($LA=($L_=$Lf.owner.skinnedMeshRender.material).albedoColor).elements=$Lt,$L_.albedoColor=$LA)}else($LA=($L_=$Li.skinnedMeshRender.material).albedoColor).elements=$Lt,$L_.albedoColor=$LA},$L_._getParticleRenderSharedMaterialTintColor=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.particleRender.sharedMaterial.tintColor.elements:null}return $Li.particleRender.sharedMaterial.tintColor.elements},$L_._setParticleRenderSharedMaterialTintColor=function($Lr,$Li,$Lt){var $L_,$LA;if($Lr){var $Lf=$Lr.transform._entity;$Lf&&(($LA=($L_=$Lf.owner.particleRender.material).tintColor).elements=$Lt,$L_.tintColor=$LA)}else($LA=($L_=$Li.particleRender.material).tintColor).elements=$Lt,$L_.tintColor=$LA},$L_._getMeshRenderSharedMaterialAlphaColor=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.alphaColor.elements:null}return $Li.meshRender.sharedMaterial.alphaColor.elements},$L_._setMeshRenderSharedMaterialAlphaColor=function($Lr,$Li,$Lt){var $L_,$LA;if($Lr){var $Lf=$Lr.transform._entity;$Lf&&(($LA=($L_=$Lf.owner.meshRender.material).alphaColor).elements=$Lt,$L_.alphaColor=$LA)}else($LA=($L_=$Li.meshRender.material).alphaColor).elements=$Lt,$L_.alphaColor=$LA},$L_._getMeshRenderSharedMaterialBaseColor=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.baseColor.elements:null}return $Li.meshRender.sharedMaterial.baseColor.elements},$L_._setMeshRenderSharedMaterialBaseColor=function($Lr,$Li,$Lt){var $L_,$LA;if($Lr){var $Lf=$Lr.transform._entity;$Lf&&(($LA=($L_=$Lf.owner.meshRender.material).baseColor).elements=$Lt,$L_.baseColor=$LA)}else($LA=($L_=$Li.meshRender.material).baseColor).elements=$Lt,$L_.baseColor=$LA},$L_._getMeshRenderSharedMaterialDissolve=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.dissolve:0}return $Li.meshRender.sharedMaterial.dissolve},$L_._setMeshRenderSharedMaterialDissolve=function($Lr,$Li,$Lt){if($Lr){var $L_=$Lr.transform._entity;$L_&&($L_.owner.meshRender.material.dissolve=$Lt[0])}else $Li.meshRender.material.dissolve=$Lt[0]},$L_._getMeshRenderSharedMaterialDissolveSpeed=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.dissolveSpeed:0}return $Li.meshRender.sharedMaterial.dissolveSpeed},$L_._setMeshRenderSharedMaterialDissolveSpeed=function($Lr,$Li,$Lt){if($Lr){var $L_=$Lr.transform._entity;$L_&&($L_.owner.meshRender.material.dissolveSpeed=$Lt[0])}else $Li.meshRender.material.dissolveSpeed=$Lt[0]},$L_._getMeshRenderSharedMaterialMMultiplier=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.mMultiplier:0}return $Li.meshRender.sharedMaterial.mMultiplier},$L_._setMeshRenderSharedMaterialMMultiplier=function($Lr,$Li,$Lt){if($Lr){var $L_=$Lr.transform._entity;$L_&&($L_.owner.meshRender.material.mMultiplier=$Lt[0])}else $Li.meshRender.material.mMultiplier=$Lt[0]},$L_._getMeshRenderSharedMaterialBaseScrollSpeedX=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return $Li.meshRender.sharedMaterial.baseScrollSpeedX},$L_._setMeshRenderSharedMaterialBaseScrollSpeedX=function($Lr,$Li,$Lt){if($Lr){var $L_=$Lr.transform._entity;$L_&&($L_.owner.meshRender.material.baseScrollSpeedX=$Lt[0])}else $Li.meshRender.material.baseScrollSpeedX=$Lt[0]},$L_._getMeshRenderSharedMaterialBaseScrollSpeedY=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return $Li.meshRender.sharedMaterial.baseScrollSpeedY},$L_._setMeshRenderSharedMaterialBaseScrollSpeedY=function($Lr,$Li,$Lt){if($Lr){var $L_=$Lr.transform._entity;$L_&&($L_.owner.meshRender.material.baseScrollSpeedY=$Lt[0])}else $Li.meshRender.material.baseScrollSpeedY=$Lt[0]},$L_._getMeshRenderSharedMaterialSecondScrollSpeedX=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return $Li.meshRender.sharedMaterial.secondScrollSpeedX},$L_._setMeshRenderSharedMaterialSecondScrollSpeedX=function($Lr,$Li,$Lt){if($Lr){var $L_=$Lr.transform._entity;$L_&&($L_.owner.meshRender.material.secondScrollSpeedX=$Lt[0])}else $Li.meshRender.material.secondScrollSpeedX=$Lt[0]},$L_._getMeshRenderSharedMaterialSecondScrollSpeedY=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return $Li.meshRender.sharedMaterial.secondScrollSpeedY},$L_._setMeshRenderSharedMaterialSecondScrollSpeedY=function($Lr,$Li,$Lt){if($Lr){var $L_=$Lr.transform._entity;$L_&&($L_.owner.meshRender.material.secondScrollSpeedY=$Lt[0])}else $Li.meshRender.material.secondScrollSpeedY=$Lt[0]},$L_._getMeshRenderSharedMaterialAlpha=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.alpha:0}return $Li.meshRender.sharedMaterial.alpha},$L_._setMeshRenderSharedMaterialAlpha=function($Lr,$Li,$Lt){if($Lr){var $L_=$Lr.transform._entity;$L_&&($L_.owner.meshRender.material.alpha=$Lt[0])}else $Li.meshRender.material.alpha=$Lt[0]},$L_._getMeshRenderSharedMaterialIntensity=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.intensity:0}return $Li.meshRender.sharedMaterial.intensity},$L_._setMeshRenderSharedMaterialIntensity=function($Lr,$Li,$Lt){if($Lr){var $L_=$Lr.transform._entity;$L_&&($L_.owner.meshRender.material.intensity=$Lt[0])}else $Li.meshRender.material.intensity=$Lt[0]},$L_._getMeshRenderSharedMaterialDetailTilingOffset=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return $Li.meshRender.sharedMaterial.detailTilingOffset.elements},$L_._setMeshRenderSharedMaterialDetailTilingOffset=function($Lr,$Li,$Lt){var $L_,$LA;if($Lr){var $Lf=$Lr.transform._entity;$Lf&&(($LA=($L_=$Lf.owner.meshRender.material).detailTilingOffset).elements=$Lt,$L_.detailTilingOffset=$LA)}else($LA=($L_=$Li.meshRender.material).detailTilingOffset).elements=$Lt,$L_.detailTilingOffset=$LA},$L_._getMeshRenderSharedMaterialDissolveTilingOffset=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return $Li.meshRender.sharedMaterial.dissolveTilingOffset.elements},$L_._setMeshRenderSharedMaterialDissolveTilingOffset=function($Lr,$Li,$Lt){var $L_,$LA;if($Lr){var $Lf=$Lr.transform._entity;$Lf&&(($LA=($L_=$Lf.owner.meshRender.material).dissolveTilingOffset).elements=$Lt,$L_.dissolveTilingOffset=$LA)}else($LA=($L_=$Li.meshRender.material).dissolveTilingOffset).elements=$Lt,$L_.dissolveTilingOffset=$LA},$L_._getMeshRenderSharedMaterialMaskTilingOffset=function($Lr,$Li){if($Lr){var $Lt=$Lr.transform._entity;return $Lt?$Lt.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return $Li.meshRender.sharedMaterial.maskTilingOffset.elements},$L_._setMeshRenderSharedMaterialMaskTilingOffset=function($Lr,$Li,$Lt){var $L_,$LA;if($Lr){var $Lf=$Lr.transform._entity;$Lf&&(($LA=($L_=$Lf.owner.meshRender.material).maskTilingOffset).elements=$Lt,$L_.maskTilingOffset=$LA)}else($LA=($L_=$Li.meshRender.material).maskTilingOffset).elements=$Lt,$L_.maskTilingOffset=$LA},$L_._propertyIDCounter=0,$L_._propertyIndexDic={},$L_._propertySetFuncs=[],$L_._propertyGetFuncs=[],$L_}(),$Lx=function(){function $Lr(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return $Lv($Lr,"laya.d3.animation.Keyframe"),$Lr}(),$L$=function(){function $Lr(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return $Lv($Lr,"laya.d3.animation.KeyframeNode"),$Lr}(),$LQ=(function(){function $Lr(){this._tempVector30=new $LEi,this._tempVector31=new $LEi,this._tempVector32=new $LEi,this._a=new $LEi,this._b=new $LEi,this._c=new $LEi,this._d=new $LEi}$Lv($Lr,"laya.d3.core.glitter.SplineCurvePositionVelocity");var $Li=$Lr.prototype;$Li.Init=function($Lr,$Li,$Lt,$L_){$Lr.cloneTo(this._d),$Li.cloneTo(this._c),$LEi.scale($Lr,2,this._a),$LEi.scale($Lt,2,this._tempVector30),$LEi.subtract(this._a,this._tempVector30,this._a),$LEi.add(this._a,$Li,this._a),$LEi.add(this._a,$L_,this._a),$LEi.scale($Lt,3,this._b),$LEi.scale($Lr,3,this._tempVector30),$LEi.subtract(this._b,this._tempVector30,this._b),$LEi.subtract(this._b,$L_,this._b),$LEi.scale($Li,2,this._tempVector30),$LEi.subtract(this._b,this._tempVector30,this._b)},$Li.Slerp=function($Lr,$Li){$LEi.scale(this._a,$Lr*$Lr*$Lr,this._tempVector30),$LEi.scale(this._b,$Lr*$Lr,this._tempVector31),$LEi.scale(this._c,$Lr,this._tempVector32),$LEi.add(this._tempVector30,this._tempVector31,$Li),$LEi.add($Li,this._tempVector32,$Li),$LEi.add($Li,this._d,$Li)}}(),function(){function $Lh($Lr,$Li,$Lt,$L_){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=$Lr,this._h=$Li,this._minHeight=$Lt,this._maxHeight=$L_}$Lv($Lh,"laya.d3.core.HeightMap");var $Lr=$Lh.prototype;$Lr._inBounds=function($Lr,$Li){return 0<=$Lr&&$Lr<this._h&&0<=$Li&&$Li<this._w},$Lr.getHeight=function($Lr,$Li){return this._inBounds($Lr,$Li)?this._datas[$Lr][$Li]:NaN},$LO(0,$Lr,"width",function(){return this._w}),$LO(0,$Lr,"height",function(){return this._h}),$LO(0,$Lr,"maxHeight",function(){return this._maxHeight}),$LO(0,$Lr,"minHeight",function(){return this._minHeight}),$Lh.creatFromMesh=function($Lr,$Li,$Lt,$L_){for(var $LA=[],$Lf=[],$LE=$Lr.getSubMeshCount(),$LG=0;$LG<$LE;$LG++){for(var $LN=$Lr.getSubMesh($LG),$Lp=$LN._getVertexBuffer(),$Lg=$Lp.getData(),$LR=[],$LX=0;$LX<$Lg.length;$LX+=$Lp.vertexDeclaration.vertexStride/4){var $Lv=new $LEi($Lg[$LX+0],$Lg[$LX+1],$Lg[$LX+2]);$LR.push($Lv)}$LA.push($LR);var $LO=$LN._getIndexBuffer();$Lf.push($LO.getData())}var $Lc=$Lr.boundingBox,$LB=$Lc.min.x,$Ly=$Lc.min.z,$LC=$Lc.max.x,$Ln=$Lc.max.z,$La=$Lc.min.y,$LD=$Lc.max.y,$Lu=$LC-$LB,$Lw=$Ln-$Ly,$LH=$L_.elements[0]=$Lu/($Li-1),$Ls=$L_.elements[1]=$Lw/($Lt-1),$Ld=new $Lh($Li,$Lt,$La,$LD),$Ll=$Lh._tempRay,$LU=$Ll.direction.elements;$LU[0]=0,$LU[1]=-1,$LU[2]=0;var $Lk=$LD+.1;$Ll.origin.elements[1]=$Lk;for(var $Le=0;$Le<$Lt;$Le++){var $LL=$Ly+$Le*$Ls;$Ld._datas[$Le]=[];for(var $LQ=0;$LQ<$Li;$LQ++){var $LF=$LB+$LQ*$LH,$Lb=$Ll.origin.elements;$Lb[0]=$LF,$Lb[2]=$LL;var $LV=$Lh._getPosition($Ll,$LA,$Lf);$Ld._datas[$Le][$LQ]=$LV===Number.MAX_VALUE?NaN:$Lk-$LV}}return $Ld},$Lh.createFromImage=function($Lr,$Li,$Lt){for(var $L_=$Lr.width,$LA=$Lr.height,$Lf=new $Lh($L_,$LA,$Li,$Lt),$LE=($Lt-$Li)/254,$LG=$Lr.getPixels(),$LN=0,$Lp=0;$Lp<$LA;$Lp++)for(var $Lg=$Lf._datas[$Lp]=[],$LR=0;$LR<$L_;$LR++){var $LX=$LG[$LN++],$Lv=$LG[$LN++],$LO=$LG[$LN++],$Lc=$LG[$LN++];$Lg[$LR]=255==$LX&&255==$Lv&&255==$LO&&255==$Lc?NaN:($LX+$Lv+$LO)/3*$LE+$Li}return $Lf},$Lh._getPosition=function($Lr,$Li,$Lt){for(var $L_=Number.MAX_VALUE,$LA=0;$LA<$Li.length;$LA++)for(var $Lf=$Li[$LA],$LE=$Lt[$LA],$LG=0;$LG<$LE.length;$LG+=3){var $LN=$Lf[$LE[$LG+0]],$Lp=$Lf[$LE[$LG+1]],$Lg=$Lf[$LE[$LG+2]],$LR=$LOi.rayIntersectsTriangle($Lr,$LN,$Lp,$Lg);!isNaN($LR)&&$LR<$L_&&($L_=$LR)}return $L_},$LR($Lh,["_tempRay",function(){return this._tempRay=new $LAi(new $LEi,new $LEi)}])}(),function(){function $LA(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}$Lv($LA,"laya.d3.core.Layer");var $Lr=$LA.prototype;return $Lr._binarySearchIndex=function(){for(var $Lr=0,$Li=$LA._collsionTestList.length-1,$Lt=0;$Lr<=$Li;){$Lt=Math.floor(($Lr+$Li)/2);var $L_=$LA._collsionTestList[$Lt];if($L_==this._number)return $Lt;$L_>this._number?$Li=$Lt-1:$Lr=$Lt+1}return $Lr},$Lr._addCollider=function($Lr){0===this._colliders.length&&$LA._collsionTestList.splice(this._binarySearchIndex(),0,this._number),$Lr._isRigidbody?(this._colliders.unshift($Lr),this._nonRigidbodyOffset++):this._colliders.push($Lr)},$Lr._removeCollider=function($Lr){var $Li=this._colliders.indexOf($Lr);$Li<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice($Li,1),0===this._colliders.length&&$LA._collsionTestList.splice($LA._collsionTestList.indexOf(this._number),1)},$LO(0,$Lr,"number",function(){return this._number}),$LO(0,$Lr,"visible",function(){return this._visible},function($Lr){this._visible=$Lr,$LA._visibleLayers=$Lr?$LA._visibleLayers|this.mask:$LA._visibleLayers&~this.mask}),$LO(0,$Lr,"mask",function(){return this._mask}),$LO(1,$LA,"visibleLayers",function(){return $LA._visibleLayers},function($Lr){$LA._visibleLayers=$Lr;for(var $Li=0,$Lt=$LA._layerList.length;$Li<$Lt;$Li++){var $L_=$LA._layerList[$Li];$L_._visible=0!=($L_._mask&$LA._visibleLayers)}}),$LA.__init__=function(){$LA._layerList.length=31;for(var $Lr=0;$Lr<31;$Lr++){var $Li=new $LA;$LA._layerList[$Lr]=$Li,0===$Lr?($Li.name="Default Layer",$Li.visible=!0):($Li.name="Layer-"+$Lr,$Li.visible=!1),$Li._number=$Lr,$Li._mask=Math.pow(2,$Lr)}$LA.currentCreationLayer=$LA._layerList[0]},$LA.getLayerByNumber=function($Lr){if($Lr<0||30<$Lr)throw new Error("无法返回指定Layer，该number超出范围！");return $LA._layerList[$Lr]},$LA.getLayerByName=function($Lr){for(var $Li=0;$Li<31;$Li++)if($LA._layerList[$Li].name===$Lr)return $LA._layerList[$Li];throw new Error("无法返回指定Layer,该name不存在")},$LA.isVisible=function($Lr){return 0!=($Lr&$LA._currentCameraCullingMask&$LA._visibleLayers)},$LA._layerList=[],$LA._visibleLayers=2147483647,$LA._collsionTestList=[],$LA._currentCameraCullingMask=2147483647,$LA.maxCount=31,$LA.currentCreationLayer=null,$LA}()),$LF=(function(){function $Lr($Lr,$Li,$Lt){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=$Lr,this._minCount=$Li,this._maxCount=$Lt}$Lv($Lr,"laya.d3.core.particleShuriKen.module.Burst");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li.cloneTo=function($Lr){var $Li=$Lr;$Li._time=this._time,$Li._minCount=this._minCount,$Li._maxCount=this._maxCount},$Li.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Li,"time",function(){return this._time}),$LO(0,$Li,"minCount",function(){return this._minCount}),$LO(0,$Li,"maxCount",function(){return this._maxCount})}(),function(){function $Lr($Lr){this._color=null,this.enbale=!1,this._color=$Lr}$Lv($Lr,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var $Li=$Lr.prototype;$Li.cloneTo=function($Lr){var $Li=$Lr;this._color.cloneTo($Li._color),$Li.enbale=this.enbale},$Li.clone=function(){var $Lr;switch(this._color.type){case 0:$Lr=$LV.createByConstant(this._color.constant.clone());break;case 1:$Lr=$LV.createByGradient(this._color.gradient.clone());break;case 2:$Lr=$LV.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:$Lr=$LV.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var $Li=new this.constructor($Lr);return $Li.enbale=this.enbale,$Li},$LO(0,$Li,"color",function(){return this._color})}(),function(){function $Lr(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}$Lv($Lr,"laya.d3.core.particleShuriKen.module.Emission");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),$Li._destroy=function(){this._bursts=null,this._destroyed=!0},$Li.getBurstsCount=function(){return this._bursts.length},$Li.getBurstByIndex=function($Lr){return this._bursts[$Lr]},$Li.addBurst=function($Lr){var $Li=this._bursts.length;if(0<$Li)for(var $Lt=0;$Lt<$Li;$Lt++)this._bursts[$Lt].time>$Lr.time&&this._bursts.splice($Lt,0,$Lr);this._bursts.push($Lr)},$Li.removeBurst=function($Lr){var $Li=this._bursts.indexOf($Lr);-1!==$Li&&this._bursts.splice($Li,1)},$Li.removeBurstByIndex=function($Lr){this._bursts.splice($Lr,1)},$Li.clearBurst=function(){this._bursts.length=0},$Li.cloneTo=function($Lr){var $Li=$Lr,$Lt=$Li._bursts;$Lt.length=this._bursts.length;for(var $L_=0,$LA=this._bursts.length;$L_<$LA;$L_++){var $Lf=$Lt[$L_];$Lf?this._bursts[$L_].cloneTo($Lf):$Lt[$L_]=this._bursts[$L_].clone()}$Li._emissionRate=this._emissionRate,$Li.enbale=this.enbale},$Li.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Li,"destroyed",function(){return this._destroyed}),$LO(0,$Li,"emissionRate",function(){return this._emissionRate},function($Lr){if($Lr<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=$Lr})}(),function(){function $L_(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}$Lv($L_,"laya.d3.core.particleShuriKen.module.FrameOverTime");var $Lr=$L_.prototype;return $LD.imps($Lr,{"laya.d3.core.IClone":!0}),$Lr.cloneTo=function($Lr){var $Li=$Lr;$Li._type=this._type,$Li._constant=this._constant,this._overTime.cloneTo($Li._overTime),$Li._constantMin=this._constantMin,$Li._constantMax=this._constantMax,this._overTimeMin.cloneTo($Li._overTimeMin),this._overTimeMax.cloneTo($Li._overTimeMax)},$Lr.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Lr,"frameOverTimeData",function(){return this._overTime}),$LO(0,$Lr,"constant",function(){return this._constant}),$LO(0,$Lr,"type",function(){return this._type}),$LO(0,$Lr,"frameOverTimeDataMin",function(){return this._overTimeMin}),$LO(0,$Lr,"constantMin",function(){return this._constantMin}),$LO(0,$Lr,"frameOverTimeDataMax",function(){return this._overTimeMax}),$LO(0,$Lr,"constantMax",function(){return this._constantMax}),$L_.createByConstant=function($Lr){var $Li=new $L_;return $Li._type=0,$Li._constant=$Lr,$Li},$L_.createByOverTime=function($Lr){var $Li=new $L_;return $Li._type=1,$Li._overTime=$Lr,$Li},$L_.createByRandomTwoConstant=function($Lr,$Li){var $Lt=new $L_;return $Lt._type=2,$Lt._constantMin=$Lr,$Lt._constantMax=$Li,$Lt},$L_.createByRandomTwoOverTime=function($Lr,$Li){var $Lt=new $L_;return $Lt._type=3,$Lt._overTimeMin=$Lr,$Lt._overTimeMax=$Li,$Lt},$L_}()),$Lb=function(){function $Lp(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}$Lv($Lp,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var $Lr=$Lp.prototype;return $LD.imps($Lr,{"laya.d3.core.IClone":!0}),$Lr.cloneTo=function($Lr){var $Li=$Lr;$Li._type=this._type,$Li._separateAxes=this._separateAxes,$Li._constant=this._constant,this._constantSeparate.cloneTo($Li._constantSeparate),this._gradient.cloneTo($Li._gradient),this._gradientX.cloneTo($Li._gradientX),this._gradientY.cloneTo($Li._gradientY),this._gradientZ.cloneTo($Li._gradientZ),$Li._constantMin=this._constantMin,$Li._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($Li._constantMinSeparate),this._constantMaxSeparate.cloneTo($Li._constantMaxSeparate),this._gradientMin.cloneTo($Li._gradientMin),this._gradientMax.cloneTo($Li._gradientMax),this._gradientXMin.cloneTo($Li._gradientXMin),this._gradientXMax.cloneTo($Li._gradientXMax),this._gradientYMin.cloneTo($Li._gradientYMin),this._gradientYMax.cloneTo($Li._gradientYMax),this._gradientZMin.cloneTo($Li._gradientZMin),this._gradientZMax.cloneTo($Li._gradientZMax)},$Lr.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Lr,"gradientZ",function(){return this._gradientZ}),$LO(0,$Lr,"constant",function(){return this._constant}),$LO(0,$Lr,"gradient",function(){return this._gradient}),$LO(0,$Lr,"separateAxes",function(){return this._separateAxes}),$LO(0,$Lr,"type",function(){return this._type}),$LO(0,$Lr,"constantSeparate",function(){return this._constantSeparate}),$LO(0,$Lr,"gradientX",function(){return this._gradientX}),$LO(0,$Lr,"gradientY",function(){return this._gradientY}),$LO(0,$Lr,"gradientW",function(){return this._gradientW}),$LO(0,$Lr,"gradientMin",function(){return this._gradientMin}),$LO(0,$Lr,"constantMin",function(){return this._constantMin}),$LO(0,$Lr,"gradientMax",function(){return this._gradientMax}),$LO(0,$Lr,"constantMax",function(){return this._constantMax}),$LO(0,$Lr,"gradientWMin",function(){return this._gradientWMin}),$LO(0,$Lr,"constantMinSeparate",function(){return this._constantMinSeparate}),$LO(0,$Lr,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$LO(0,$Lr,"gradientXMin",function(){return this._gradientXMin}),$LO(0,$Lr,"gradientXMax",function(){return this._gradientXMax}),$LO(0,$Lr,"gradientWMax",function(){return this._gradientWMax}),$LO(0,$Lr,"gradientYMin",function(){return this._gradientYMin}),$LO(0,$Lr,"gradientYMax",function(){return this._gradientYMax}),$LO(0,$Lr,"gradientZMin",function(){return this._gradientZMin}),$LO(0,$Lr,"gradientZMax",function(){return this._gradientZMax}),$Lp.createByConstant=function($Lr){var $Li=new $Lp;return $Li._type=0,$Li._separateAxes=!1,$Li._constant=$Lr,$Li},$Lp.createByConstantSeparate=function($Lr){var $Li=new $Lp;return $Li._type=0,$Li._separateAxes=!0,$Li._constantSeparate=$Lr,$Li},$Lp.createByGradient=function($Lr){var $Li=new $Lp;return $Li._type=1,$Li._separateAxes=!1,$Li._gradient=$Lr,$Li},$Lp.createByGradientSeparate=function($Lr,$Li,$Lt,$L_){var $LA=new $Lp;return $LA._type=1,$LA._separateAxes=!0,$LA._gradientX=$Lr,$LA._gradientY=$Li,$LA._gradientZ=$Lt,$LA._gradientW=$L_,$LA},$Lp.createByRandomTwoConstant=function($Lr,$Li){var $Lt=new $Lp;return $Lt._type=2,$Lt._separateAxes=!1,$Lt._constantMin=$Lr,$Lt._constantMax=$Li,$Lt},$Lp.createByRandomTwoConstantSeparate=function($Lr,$Li){var $Lt=new $Lp;return $Lt._type=2,$Lt._separateAxes=!0,$Lt._constantMinSeparate=$Lr,$Lt._constantMaxSeparate=$Li,$Lt},$Lp.createByRandomTwoGradient=function($Lr,$Li){var $Lt=new $Lp;return $Lt._type=3,$Lt._separateAxes=!1,$Lt._gradientMin=$Lr,$Lt._gradientMax=$Li,$Lt},$Lp.createByRandomTwoGradientSeparate=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){var $LN=new $Lp;return $LN._type=3,$LN._separateAxes=!0,$LN._gradientXMin=$Lr,$LN._gradientXMax=$Li,$LN._gradientYMin=$Lt,$LN._gradientYMax=$L_,$LN._gradientZMin=$LA,$LN._gradientZMax=$Lf,$LN._gradientWMin=$LE,$LN._gradientWMax=$LG,$LN},$Lp}(),$LV=function(){function $L_(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}$Lv($L_,"laya.d3.core.particleShuriKen.module.GradientColor");var $Lr=$L_.prototype;return $LD.imps($Lr,{"laya.d3.core.IClone":!0}),$Lr.cloneTo=function($Lr){var $Li=$Lr;$Li._type=this._type,this._constant.cloneTo($Li._constant),this._constantMin.cloneTo($Li._constantMin),this._constantMax.cloneTo($Li._constantMax),this._gradient.cloneTo($Li._gradient),this._gradientMin.cloneTo($Li._gradientMin),this._gradientMax.cloneTo($Li._gradientMax)},$Lr.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Lr,"gradient",function(){return this._gradient}),$LO(0,$Lr,"constant",function(){return this._constant}),$LO(0,$Lr,"type",function(){return this._type}),$LO(0,$Lr,"gradientMin",function(){return this._gradientMin}),$LO(0,$Lr,"constantMin",function(){return this._constantMin}),$LO(0,$Lr,"gradientMax",function(){return this._gradientMax}),$LO(0,$Lr,"constantMax",function(){return this._constantMax}),$L_.createByConstant=function($Lr){var $Li=new $L_;return $Li._type=0,$Li._constant=$Lr,$Li},$L_.createByGradient=function($Lr){var $Li=new $L_;return $Li._type=1,$Li._gradient=$Lr,$Li},$L_.createByRandomTwoConstant=function($Lr,$Li){var $Lt=new $L_;return $Lt._type=2,$Lt._constantMin=$Lr,$Lt._constantMax=$Li,$Lt},$L_.createByRandomTwoGradient=function($Lr,$Li){var $Lt=new $L_;return $Lt._type=3,$Lt._gradientMin=$Lr,$Lt._gradientMax=$Li,$Lt},$L_}(),$Lh=(function(){function $Lr(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}$Lv($Lr,"laya.d3.core.particleShuriKen.module.GradientDataColor");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li.addAlpha=function($Lr,$Li){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==$Lr&&($Lr=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=$Lr,this._alphaElements[this._alphaCurrentLength++]=$Li):DEBUG},$Li.addRGB=function($Lr,$Li){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==$Lr&&($Lr=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=$Lr,this._rgbElements[this._rgbCurrentLength++]=$Li.x,this._rgbElements[this._rgbCurrentLength++]=$Li.y,this._rgbElements[this._rgbCurrentLength++]=$Li.z):DEBUG},$Li.cloneTo=function($Lr){var $Li=$Lr,$Lt=0,$L_=0;$Li._alphaCurrentLength=this._alphaCurrentLength;var $LA=$Li._alphaElements;for($LA.length=this._alphaElements.length,$Lt=0,$L_=this._alphaElements.length;$Lt<$L_;$Lt++)$LA[$Lt]=this._alphaElements[$Lt];$Li._rgbCurrentLength=this._rgbCurrentLength;var $Lf=$Li._rgbElements;for($Lf.length=this._rgbElements.length,$Lt=0,$L_=this._rgbElements.length;$Lt<$L_;$Lt++)$Lf[$Lt]=this._rgbElements[$Lt]},$Li.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Li,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),$LO(0,$Li,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function $Lr(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$Lv($Lr,"laya.d3.core.particleShuriKen.module.GradientDataInt");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li.add=function($Lr,$Li){this._currentLength<8?(6===this._currentLength&&1!==$Lr&&($Lr=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$Lr,this._elements[this._currentLength++]=$Li):console.log("Warning:data count must lessEqual than 4")},$Li.cloneTo=function($Lr){var $Li=$Lr;$Li._currentLength=this._currentLength;var $Lt=$Li._elements;$Lt.length=this._elements.length;for(var $L_=0,$LA=this._elements.length;$L_<$LA;$L_++)$Lt[$L_]=this._elements[$L_]},$Li.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Li,"gradientCount",function(){return this._currentLength/2})}(),function(){function $Lr(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$Lv($Lr,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li.add=function($Lr,$Li){this._currentLength<8?(6===this._currentLength&&1!==$Lr&&($Lr=1,DEBUG),this._elements[this._currentLength++]=$Lr,this._elements[this._currentLength++]=$Li):DEBUG},$Li.getKeyByIndex=function($Lr){return this._elements[2*$Lr]},$Li.getValueByIndex=function($Lr){return this._elements[2*$Lr+1]},$Li.getAverageValue=function(){for(var $Lr=0,$Li=this._currentLength-2;$Lr<$Li;$Lr+=2){this._elements[$Lr+1];this._elements[$Lr+3],this._elements[$Lr+2]-this._elements[$Lr]}return 0},$Li.cloneTo=function($Lr){var $Li=$Lr;$Li._currentLength=this._currentLength;var $Lt=$Li._elements;$Lt.length=this._elements.length;for(var $L_=0,$LA=this._elements.length;$L_<$LA;$L_++)$Lt[$L_]=this._elements[$L_]},$Li.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Li,"gradientCount",function(){return this._currentLength/2})}(),function(){function $Lr(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}$Lv($Lr,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li.add=function($Lr,$Li){this._currentLength<8?(6===this._currentLength&&1!==$Lr&&($Lr=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$Lr,this._elements[this._currentLength++]=$Li.x,this._elements[this._currentLength++]=$Li.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},$Li.cloneTo=function($Lr){var $Li=$Lr;$Li._currentLength=this._currentLength;var $Lt=$Li._elements;$Lt.length=this._elements.length;for(var $L_=0,$LA=this._elements.length;$L_<$LA;$L_++)$Lt[$L_]=this._elements[$L_]},$Li.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Li,"gradientCount",function(){return this._currentLength/3})}(),function(){function $LG(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$Lv($LG,"laya.d3.core.particleShuriKen.module.GradientSize");var $Lr=$LG.prototype;return $LD.imps($Lr,{"laya.d3.core.IClone":!0}),$Lr.getMaxSizeInGradient=function(){var $Lr=0,$Li=0,$Lt=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for($Lr=0,$Li=this._gradientX.gradientCount;$Lr<$Li;$Lr++)$Lt=Math.max($Lt,this._gradientX.getValueByIndex($Lr));for($Lr=0,$Li=this._gradientY.gradientCount;$Lr<$Li;$Lr++)$Lt=Math.max($Lt,this._gradientY.getValueByIndex($Lr))}else for($Lr=0,$Li=this._gradient.gradientCount;$Lr<$Li;$Lr++)$Lt=Math.max($Lt,this._gradient.getValueByIndex($Lr));break;case 1:$Lt=this._separateAxes?($Lt=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),$Lt=Math.max($Lt,this._constantMinSeparate.y),Math.max($Lt,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for($Lr=0,$Li=this._gradientXMin.gradientCount;$Lr<$Li;$Lr++)$Lt=Math.max($Lt,this._gradientXMin.getValueByIndex($Lr));for($Lr=0,$Li=this._gradientXMax.gradientCount;$Lr<$Li;$Lr++)$Lt=Math.max($Lt,this._gradientXMax.getValueByIndex($Lr));for($Lr=0,$Li=this._gradientYMin.gradientCount;$Lr<$Li;$Lr++)$Lt=Math.max($Lt,this._gradientYMin.getValueByIndex($Lr));for($Lr=0,$Li=this._gradientZMax.gradientCount;$Lr<$Li;$Lr++)$Lt=Math.max($Lt,this._gradientZMax.getValueByIndex($Lr))}else{for($Lr=0,$Li=this._gradientMin.gradientCount;$Lr<$Li;$Lr++)$Lt=Math.max($Lt,this._gradientMin.getValueByIndex($Lr));for($Lr=0,$Li=this._gradientMax.gradientCount;$Lr<$Li;$Lr++)$Lt=Math.max($Lt,this._gradientMax.getValueByIndex($Lr))}}return $Lt},$Lr.cloneTo=function($Lr){var $Li=$Lr;$Li._type=this._type,$Li._separateAxes=this._separateAxes,this._gradient.cloneTo($Li._gradient),this._gradientX.cloneTo($Li._gradientX),this._gradientY.cloneTo($Li._gradientY),this._gradientZ.cloneTo($Li._gradientZ),$Li._constantMin=this._constantMin,$Li._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($Li._constantMinSeparate),this._constantMaxSeparate.cloneTo($Li._constantMaxSeparate),this._gradientMin.cloneTo($Li._gradientMin),this._gradientMax.cloneTo($Li._gradientMax),this._gradientXMin.cloneTo($Li._gradientXMin),this._gradientXMax.cloneTo($Li._gradientXMax),this._gradientYMin.cloneTo($Li._gradientYMin),this._gradientYMax.cloneTo($Li._gradientYMax),this._gradientZMin.cloneTo($Li._gradientZMin),this._gradientZMax.cloneTo($Li._gradientZMax)},$Lr.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Lr,"gradientZ",function(){return this._gradientZ}),$LO(0,$Lr,"gradient",function(){return this._gradient}),$LO(0,$Lr,"separateAxes",function(){return this._separateAxes}),$LO(0,$Lr,"type",function(){return this._type}),$LO(0,$Lr,"gradientMin",function(){return this._gradientMin}),$LO(0,$Lr,"constantMin",function(){return this._constantMin}),$LO(0,$Lr,"gradientX",function(){return this._gradientX}),$LO(0,$Lr,"gradientY",function(){return this._gradientY}),$LO(0,$Lr,"gradientMax",function(){return this._gradientMax}),$LO(0,$Lr,"constantMax",function(){return this._constantMax}),$LO(0,$Lr,"constantMinSeparate",function(){return this._constantMinSeparate}),$LO(0,$Lr,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$LO(0,$Lr,"gradientXMin",function(){return this._gradientXMin}),$LO(0,$Lr,"gradientXMax",function(){return this._gradientXMax}),$LO(0,$Lr,"gradientYMin",function(){return this._gradientYMin}),$LO(0,$Lr,"gradientYMax",function(){return this._gradientYMax}),$LO(0,$Lr,"gradientZMin",function(){return this._gradientZMin}),$LO(0,$Lr,"gradientZMax",function(){return this._gradientZMax}),$LG.createByGradient=function($Lr){var $Li=new $LG;return $Li._type=0,$Li._separateAxes=!1,$Li._gradient=$Lr,$Li},$LG.createByGradientSeparate=function($Lr,$Li,$Lt){var $L_=new $LG;return $L_._type=0,$L_._separateAxes=!0,$L_._gradientX=$Lr,$L_._gradientY=$Li,$L_._gradientZ=$Lt,$L_},$LG.createByRandomTwoConstant=function($Lr,$Li){var $Lt=new $LG;return $Lt._type=1,$Lt._separateAxes=!1,$Lt._constantMin=$Lr,$Lt._constantMax=$Li,$Lt},$LG.createByRandomTwoConstantSeparate=function($Lr,$Li){var $Lt=new $LG;return $Lt._type=1,$Lt._separateAxes=!0,$Lt._constantMinSeparate=$Lr,$Lt._constantMaxSeparate=$Li,$Lt},$LG.createByRandomTwoGradient=function($Lr,$Li){var $Lt=new $LG;return $Lt._type=2,$Lt._separateAxes=!1,$Lt._gradientMin=$Lr,$Lt._gradientMax=$Li,$Lt},$LG.createByRandomTwoGradientSeparate=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=new $LG;return $LE._type=2,$LE._separateAxes=!0,$LE._gradientXMin=$Lr,$LE._gradientXMax=$Li,$LE._gradientYMin=$Lt,$LE._gradientYMax=$L_,$LE._gradientZMin=$LA,$LE._gradientZMax=$Lf,$LE},$LG}()),$LP=function(){function $LG(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$Lv($LG,"laya.d3.core.particleShuriKen.module.GradientVelocity");var $Lr=$LG.prototype;return $LD.imps($Lr,{"laya.d3.core.IClone":!0}),$Lr.cloneTo=function($Lr){var $Li=$Lr;$Li._type=this._type,this._constant.cloneTo($Li._constant),this._gradientX.cloneTo($Li._gradientX),this._gradientY.cloneTo($Li._gradientY),this._gradientZ.cloneTo($Li._gradientZ),this._constantMin.cloneTo($Li._constantMin),this._constantMax.cloneTo($Li._constantMax),this._gradientXMin.cloneTo($Li._gradientXMin),this._gradientXMax.cloneTo($Li._gradientXMax),this._gradientYMin.cloneTo($Li._gradientYMin),this._gradientYMax.cloneTo($Li._gradientYMax),this._gradientZMin.cloneTo($Li._gradientZMin),this._gradientZMax.cloneTo($Li._gradientZMax)},$Lr.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Lr,"gradientZ",function(){return this._gradientZ}),$LO(0,$Lr,"constant",function(){return this._constant}),$LO(0,$Lr,"type",function(){return this._type}),$LO(0,$Lr,"gradientXMax",function(){return this._gradientXMax}),$LO(0,$Lr,"constantMin",function(){return this._constantMin}),$LO(0,$Lr,"gradientX",function(){return this._gradientX}),$LO(0,$Lr,"gradientY",function(){return this._gradientY}),$LO(0,$Lr,"gradientXMin",function(){return this._gradientXMin}),$LO(0,$Lr,"constantMax",function(){return this._constantMax}),$LO(0,$Lr,"gradientYMin",function(){return this._gradientYMin}),$LO(0,$Lr,"gradientYMax",function(){return this._gradientYMax}),$LO(0,$Lr,"gradientZMin",function(){return this._gradientZMin}),$LO(0,$Lr,"gradientZMax",function(){return this._gradientZMax}),$LG.createByConstant=function($Lr){var $Li=new $LG;return $Li._type=0,$Li._constant=$Lr,$Li},$LG.createByGradient=function($Lr,$Li,$Lt){var $L_=new $LG;return $L_._type=1,$L_._gradientX=$Lr,$L_._gradientY=$Li,$L_._gradientZ=$Lt,$L_},$LG.createByRandomTwoConstant=function($Lr,$Li){var $Lt=new $LG;return $Lt._type=2,$Lt._constantMin=$Lr,$Lt._constantMax=$Li,$Lt},$LG.createByRandomTwoGradient=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=new $LG;return $LE._type=3,$LE._gradientXMin=$Lr,$LE._gradientXMax=$Li,$LE._gradientYMin=$Lt,$LE._gradientYMax=$L_,$LE._gradientZMin=$LA,$LE._gradientZMax=$Lf,$LE},$LG}(),$Lq=(function(){function $Lr($Lr){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=$Lr}$Lv($Lr,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li.cloneTo=function($Lr){var $Li=$Lr;this._angularVelocity.cloneTo($Li._angularVelocity),$Li.enbale=this.enbale},$Li.clone=function(){var $Lr;switch(this._angularVelocity.type){case 0:$Lr=this._angularVelocity.separateAxes?$Lb.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):$Lb.createByConstant(this._angularVelocity.constant);break;case 1:$Lr=this._angularVelocity.separateAxes?$Lb.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):$Lb.createByGradient(this._angularVelocity.gradient.clone());break;case 2:$Lr=this._angularVelocity.separateAxes?$Lb.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):$Lb.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:$Lr=this._angularVelocity.separateAxes?$Lb.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):$Lb.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var $Li=new this.constructor($Lr);return $Li.enbale=this.enbale,$Li},$LO(0,$Li,"angularVelocity",function(){return this._angularVelocity})}(),function(){function $Lr(){this.enable=!1,this.randomDirection=!1}$Lv($Lr,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li._getShapeBoundBox=function($Lr){throw new Error("BaseShape: must override it.")},$Li._getSpeedBoundBox=function($Lr){throw new Error("BaseShape: must override it.")},$Li.generatePositionAndDirection=function($Lr,$Li,$Lt,$L_){throw new Error("BaseShape: must override it.")},$Li._calculateProceduralBounds=function($Lr,$Li,$Lt){this._getShapeBoundBox($Lr);var $L_=$Lr.min,$LA=$Lr.max;$LEi.multiply($L_,$Li,$L_),$LEi.multiply($LA,$Li,$LA);var $Lf=new $LMr(new $LEi,new $LEi);this.randomDirection?($Lf.min=new $LEi(-1,-1,-1),$Lf.max=new $LEi(1,1,1)):this._getSpeedBoundBox($Lf);var $LE=new $LMr(new $LEi,new $LEi),$LG=$LE.min,$LN=$LE.max;$LEi.scale($Lf.min,$Lt.y,$LG),$LEi.scale($Lf.max,$Lt.y,$LN),$LEi.add($Lr.min,$LG,$LG),$LEi.add($Lr.max,$LN,$LN),$LEi.min($Lr.min,$LG,$Lr.min),$LEi.max($Lr.max,$LG,$Lr.max);var $Lp=new $LMr(new $LEi,new $LEi),$Lg=$Lp.min,$LR=$Lp.max;$LEi.scale($Lf.min,$Lt.x,$Lg),$LEi.scale($Lf.max,$Lt.x,$LR),$LEi.min($Lp.min,$LR,$LG),$LEi.max($Lp.min,$LR,$LN),$LEi.min($Lr.min,$LG,$Lr.min),$LEi.max($Lr.max,$LG,$Lr.max)},$Li.cloneTo=function($Lr){$Lr.enable=this.enable},$Li.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$Lr}()),$Lo=function(){function $Lf(){}return $Lv($Lf,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),$Lf._randomPointUnitArcCircle=function($Lr,$Li,$Lt){var $L_=$Li.elements,$LA=NaN;$LA=$Lt?$Lt.getFloat()*$Lr:Math.random()*$Lr,$L_[0]=Math.cos($LA),$L_[1]=Math.sin($LA)},$Lf._randomPointInsideUnitArcCircle=function($Lr,$Li,$Lt){var $L_=$Li.elements;$Lf._randomPointUnitArcCircle($Lr,$Li,$Lt);var $LA=NaN;$LA=$Lt?Math.pow($Lt.getFloat(),.5):Math.pow(Math.random(),.5),$L_[0]=$L_[0]*$LA,$L_[1]=$L_[1]*$LA},$Lf._randomPointUnitCircle=function($Lr,$Li){var $Lt=$Lr.elements,$L_=NaN;$L_=$Li?$Li.getFloat()*Math.PI*2:Math.random()*Math.PI*2,$Lt[0]=Math.cos($L_),$Lt[1]=Math.sin($L_)},$Lf._randomPointInsideUnitCircle=function($Lr,$Li){var $Lt=$Lr.elements;$Lf._randomPointUnitCircle($Lr);var $L_=NaN;$L_=$Li?Math.pow($Li.getFloat(),.5):Math.pow(Math.random(),.5),$Lt[0]=$Lt[0]*$L_,$Lt[1]=$Lt[1]*$L_},$Lf._randomPointUnitSphere=function($Lr,$Li){var $Lt=$Lr.elements,$L_=NaN,$LA=NaN;$LA=$Li?($L_=$Lt[2]=2*$Li.getFloat()-1,$Li.getFloat()*Math.PI*2):($L_=$Lt[2]=2*Math.random()-1,Math.random()*Math.PI*2);var $Lf=Math.sqrt(1-$L_*$L_);$Lt[0]=$Lf*Math.cos($LA),$Lt[1]=$Lf*Math.sin($LA)},$Lf._randomPointInsideUnitSphere=function($Lr,$Li){var $Lt=$Lr.elements;$Lf._randomPointUnitSphere($Lr);var $L_=NaN;$L_=$Li?Math.pow($Li.getFloat(),1/3):Math.pow(Math.random(),1/3),$Lt[0]=$Lt[0]*$L_,$Lt[1]=$Lt[1]*$L_,$Lt[2]=$Lt[2]*$L_},$Lf._randomPointInsideHalfUnitBox=function($Lr,$Li){var $Lt=$Lr.elements;$Li?($Lt[0]=$Li.getFloat()-.5,$Lt[1]=$Li.getFloat()-.5,$Lt[2]=$Li.getFloat()-.5):($Lt[0]=Math.random()-.5,$Lt[1]=Math.random()-.5,$Lt[2]=Math.random()-.5)},$Lf}(),$LI=(function(){function $Lr($Lr){this._size=null,this.enbale=!1,this._size=$Lr}$Lv($Lr,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li.cloneTo=function($Lr){var $Li=$Lr;this._size.cloneTo($Li._size),$Li.enbale=this.enbale},$Li.clone=function(){var $Lr;switch(this._size.type){case 0:$Lr=this._size.separateAxes?$Lh.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):$Lh.createByGradient(this._size.gradient.clone());break;case 1:$Lr=this._size.separateAxes?$Lh.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):$Lh.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:$Lr=this._size.separateAxes?$Lh.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):$Lh.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var $Li=new this.constructor($Lr);return $Li.enbale=this.enbale,$Li},$LO(0,$Li,"size",function(){return this._size})}(),function(){function $L_(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}$Lv($L_,"laya.d3.core.particleShuriKen.module.StartFrame");var $Lr=$L_.prototype;return $LD.imps($Lr,{"laya.d3.core.IClone":!0}),$Lr.cloneTo=function($Lr){var $Li=$Lr;$Li._type=this._type,$Li._constant=this._constant,$Li._constantMin=this._constantMin,$Li._constantMax=this._constantMax},$Lr.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Lr,"constant",function(){return this._constant}),$LO(0,$Lr,"type",function(){return this._type}),$LO(0,$Lr,"constantMin",function(){return this._constantMin}),$LO(0,$Lr,"constantMax",function(){return this._constantMax}),$L_.createByConstant=function($Lr){var $Li=new $L_;return $Li._type=0,$Li._constant=$Lr,$Li},$L_.createByRandomTwoConstant=function($Lr,$Li){var $Lt=new $L_;return $Lt._type=1,$Lt._constantMin=$Lr,$Lt._constantMax=$Li,$Lt},$L_}()),$Lz=(function(){function $Lr($Lr,$Li){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new $Lfi(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=$Lr,this._startFrame=$Li}$Lv($Lr,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li.cloneTo=function($Lr){var $Li=$Lr;this.tiles.cloneTo($Li.tiles),$Li.type=this.type,$Li.randomRow=this.randomRow,this._frame.cloneTo($Li._frame),this._startFrame.cloneTo($Li._startFrame),$Li.cycles=this.cycles,$Li.enableUVChannels=this.enableUVChannels,$Li.enable=this.enable},$Li.clone=function(){var $Lr,$Li;switch(this._frame.type){case 0:$Lr=$LF.createByConstant(this._frame.constant);break;case 1:$Lr=$LF.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:$Lr=$LF.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:$Lr=$LF.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:$Li=$LI.createByConstant(this._startFrame.constant);break;case 1:$Li=$LI.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var $Lt=new this.constructor($Lr,$Li);return this.tiles.cloneTo($Lt.tiles),$Lt.type=this.type,$Lt.randomRow=this.randomRow,$Lt.cycles=this.cycles,$Lt.enableUVChannels=this.enableUVChannels,$Lt.enable=this.enable,$Lt},$LO(0,$Li,"frame",function(){return this._frame}),$LO(0,$Li,"startFrame",function(){return this._startFrame})}(),function(){function $Lr($Lr){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=$Lr}$Lv($Lr,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li.cloneTo=function($Lr){var $Li=$Lr;this._velocity.cloneTo($Li._velocity),$Li.enbale=this.enbale,$Li.space=this.space},$Li.clone=function(){var $Lr;switch(this._velocity.type){case 0:$Lr=$LP.createByConstant(this._velocity.constant.clone());break;case 1:$Lr=$LP.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:$Lr=$LP.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:$Lr=$LP.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var $Li=new this.constructor($Lr);return $Li.enbale=this.enbale,$Li.space=this.space,$Li},$LO(0,$Li,"velocity",function(){return this._velocity})}(),function(){function $Lr(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new $LXi,this._vb=$Lqi.create($Lr._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=$LPi.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=$LVi.nameKey.getID("LINE"),this._shaderCompile=$LHi._preCompileShader[this._sharderNameID]}$Lv($Lr,"laya.d3.core.PhasorSpriter3D");var $Li=$Lr.prototype;return $Li.line=function($Lr,$Li,$Lt,$L_){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($Lr.x,$Lr.y,$Lr.z,$Li.x,$Li.y,$Li.z,$Li.w),this.addVertex($Lt.x,$Lt.y,$Lt.z,$L_.x,$L_.y,$L_.z,$L_.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},$Li.circle=function($Lr,$Li,$Lt,$L_,$LA,$Lf){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*$Li,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/$Li,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*$Lr,Math.cos(this._tempNumver0)*$Lr,0,$Lt,$L_,$LA,$Lf),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},$Li.plane=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=$L_/2,this._tempNumver1=$LA/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($Lr-this._tempNumver0,$Li+this._tempNumver1,$Lt,$Lf,$LE,$LG,$LN),this.addVertex($Lr+this._tempNumver0,$Li+this._tempNumver1,$Lt,$Lf,$LE,$LG,$LN),this.addVertex($Lr-this._tempNumver0,$Li-this._tempNumver1,$Lt,$Lf,$LE,$LG,$LN),this.addVertex($Lr+this._tempNumver0,$Li-this._tempNumver1,$Lt,$Lf,$LE,$LG,$LN),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},$Li.box=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=$L_/2,this._tempNumver1=$LA/2,this._tempNumver2=$Lf/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($Lr-this._tempNumver0,$Li+this._tempNumver1,$Lt+this._tempNumver2,$LE,$LG,$LN,$Lp),this.addVertex($Lr+this._tempNumver0,$Li+this._tempNumver1,$Lt+this._tempNumver2,$LE,$LG,$LN,$Lp),this.addVertex($Lr-this._tempNumver0,$Li-this._tempNumver1,$Lt+this._tempNumver2,$LE,$LG,$LN,$Lp),this.addVertex($Lr+this._tempNumver0,$Li-this._tempNumver1,$Lt+this._tempNumver2,$LE,$LG,$LN,$Lp),this.addVertex($Lr+this._tempNumver0,$Li+this._tempNumver1,$Lt-this._tempNumver2,$LE,$LG,$LN,$Lp),this.addVertex($Lr-this._tempNumver0,$Li+this._tempNumver1,$Lt-this._tempNumver2,$LE,$LG,$LN,$Lp),this.addVertex($Lr+this._tempNumver0,$Li-this._tempNumver1,$Lt-this._tempNumver2,$LE,$LG,$LN,$Lp),this.addVertex($Lr-this._tempNumver0,$Li-this._tempNumver1,$Lt-this._tempNumver2,$LE,$LG,$LN,$Lp),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},$Li.cone=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*$Lt+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*$Lt>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/$Lt,this.addVertexIndex(0,$Li,0,$L_,$LA,$Lf,$LE,this._tempUint0),this.addVertexIndex(0,0,0,$L_,$LA,$Lf,$LE,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<$Lt;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex($Lr*this._tempNumver2,0,$Lr*this._tempNumver3,$L_,$LA,$Lf,$LE,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==$Lt-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex($Lr*this._tempNumver2,0,$Lr*this._tempNumver3,$L_,$LA,$Lf,$LE,this._tempUint0+(this._tempInt0+$Lt)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==$Lt-1?this.addIndexes(this._tempUint1+$Lt+2):this.addIndexes(this._tempUint1+this._tempInt0+$Lt+1),this.addIndexes(this._tempUint1+this._tempInt0+$Lt),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},$Li.boundingBoxLine=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($Lr,$LA,$Lf,$LE,$LG,$LN,$Lp),this.addVertex($L_,$LA,$Lf,$LE,$LG,$LN,$Lp),this.addVertex($Lr,$Li,$Lf,$LE,$LG,$LN,$Lp),this.addVertex($L_,$Li,$Lf,$LE,$LG,$LN,$Lp),this.addVertex($L_,$LA,$Lt,$LE,$LG,$LN,$Lp),this.addVertex($Lr,$LA,$Lt,$LE,$LG,$LN,$Lp),this.addVertex($L_,$Li,$Lt,$LE,$LG,$LN,$Lp),this.addVertex($Lr,$Li,$Lt,$LE,$LG,$LN,$Lp),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},$Li.addVertex=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=$Lr,this._vbData[this._posInVBData+1]=$Li,this._vbData[this._posInVBData+2]=$Lt,this._vbData[this._posInVBData+3]=$L_,this._vbData[this._posInVBData+4]=$LA,this._vbData[this._posInVBData+5]=$Lf,this._vbData[this._posInVBData+6]=$LE,this._posInVBData+=this._floatSizePerVer,this},$Li.addVertexIndex=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){return this._hasBegun||this.addVertexIndexException(),this._vbData[$LG]=$Lr,this._vbData[$LG+1]=$Li,this._vbData[$LG+2]=$Lt,this._vbData[$LG+3]=$L_,this._vbData[$LG+4]=$LA,this._vbData[$LG+5]=$Lf,this._vbData[$LG+6]=$LE,($LG+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=$LG),this},$Li.addIndexes=function($Lr){var $Li=arguments;this._hasBegun||this.addVertexIndexException();for(var $Lt=0;$Lt<$Li.length;$Lt++)this._ibData[this._posInIBData]=$Li[$Lt],this._posInIBData++;return this},$Li.begin=function($Lr,$Li){return this._hasBegun&&this.beginException0(),1!==$Lr&&4!==$Lr&&this.beginException1(),this._primitiveType=$Lr,this._camera=$Li,this._hasBegun=!0,this},$Li.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},$Li.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes($Lr._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),$LH.drawCall++,$Lk.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},$Li.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},$Li.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},$Li.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},$Li.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},$Li.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},$Li.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(28,[new $LEr(0,"vector3",0),new $LEr(12,"vector4",1)])}]),$Lr}()),$LJ=function(){function $Lr(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++$Lr._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new $LXi}$Lv($Lr,"laya.d3.core.render.RenderElement");var $Li=$Lr.prototype;return $Li.getDynamicBatchBakedVertexs=function($Lr){for(var $Li=this._renderObj._getVertexBuffer($Lr),$Lt=$Li.getData().slice(),$L_=$Li.vertexDeclaration,$LA=$L_.getVertexElementByUsage(0).offset/4,$Lf=$L_.getVertexElementByUsage(3).offset/4,$LE=this._sprite3D.transform,$LG=$LE.worldMatrix,$LN=$LE.rotation,$Lp=$L_.vertexStride/4,$Lg=0,$LR=$Lt.length;$Lg<$LR;$Lg+=$Lp){var $LX=$Lg+$LA,$Lv=$Lg+$Lf;$LBi.transformVector3ArrayToVector3ArrayCoordinate($Lt,$LX,$LG,$Lt,$LX),$LBi.transformVector3ArrayByQuat($Lt,$Lv,$LN,$Lt,$Lv)}return $Lt},$Li.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},$Li._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},$LO(0,$Li,"id",function(){return this._id}),$LO(0,$Li,"renderObj",function(){return this._renderObj},function($Lr){this._renderObj!==$Lr&&(this._renderObj=$Lr)}),$Lr._uniqueIDCounter=0,$Lr}(),$LZ=function(){function $Li($Lr){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++$Li._uniqueIDCounter,this._needSort=!1,this._scene=$Lr,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}$Lv($Li,"laya.d3.core.render.RenderQueue");var $Lr=$Li.prototype;return $Lr._sortOpaqueFunc=function($Lr,$Li){if($Lr._render&&$Li._render){var $Lt=$Lr._material.renderQueue-$Li._material.renderQueue;return 0==$Lt?$Lr._render._distanceForSort-$Li._render._distanceForSort:$Lt}return 0},$Lr._sortAlphaFunc=function($Lr,$Li){if($Lr._render&&$Li._render){var $Lt=$Lr._material.renderQueue-$Li._material.renderQueue;return 0==$Lt?$Li._render._distanceForSort-$Lr._render._distanceForSort:$Lt}return 0},$Lr._begainRenderElement=function($Lr,$Li,$Lt){return!!$Li._beforeRender($Lr)},$Lr._sortAlpha=function($Lr){$Li._cameraPosition=$Lr,this._finalElements.sort(this._sortAlphaFunc)},$Lr._sortOpaque=function($Lr){$Li._cameraPosition=$Lr,this._finalElements.sort(this._sortOpaqueFunc)},$Lr._preRender=function($Lr){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},$Lr._render=function($Lr,$Li){for(var $Lt,$L_,$LA,$Lf,$LE,$LG,$LN=$LH.loopCount,$Lp=this._scene,$Lg=$Lr.camera,$LR=($Lg.id,!1),$LX=0,$Lv=this._finalElements.length;$LX<$Lv;$LX++){var $LO,$Lc,$LB,$Ly=this._finalElements[$LX];if(null!=$Ly._onPreRenderFunction&&$Ly._onPreRenderFunction.call($Ly._sprite3D,$Lr),0===$Ly._type){if($Lr.owner=$LB=$Ly._sprite3D,$Lr.renderElement=$Ly,$LB._preRenderUpdateComponents($Lr),$LO=$Ly.renderObj,$Lc=$Ly._material,this._begainRenderElement($Lr,$LO,$Lc)){if($Lt=$LO._getVertexBuffers(),!($LA=($L_=$LO._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[$L_.id]){this._errorRecord[$L_.id]=1;var $LC="vertexBuffer:"+("("+$L_._destroyed+","+$L_._released+","+$L_._referenceCount+","+$L_._buffer+")")+", material:"+($Lc?$Lc.__className+"("+$Lc._destroyed+","+$Lc._released+")":"null")+", owner:"+($LB?$LB.__className+"("+$LB._destroyed+","+$LB._activeInHierarchy+","+$LB._displayedInStage+")":"null")+", renderObj:"+($LO?$LO.__className+"("+$LO._destroyed+","+$LO._released+","+$LO._referenceCount+")":"")+", parent:, url:"+($LB?$LB.url:"")+", disposeStack:"+$L_.disposeStack;$LD.recordError("报错：unknown vertexDeclaration  "+$LC)}continue}if($LR=($Lf=$Lr._shader=$Lc._getShader($Lp._shaderDefineValue,$LA.shaderDefineValue,$LB._shaderDefineValue)).bind()||$LN!==$Lf._uploadLoopCount,$Lt){if($Lf._uploadVertexBuffer!==$Lt||$LR){for(var $Ln=0;$Ln<$Lt.length;$Ln++){var $La=$Lt[$Ln];$Lf.uploadAttributesX($La.vertexDeclaration.shaderValues.data,$La)}$Lf._uploadVertexBuffer=$Lt}}else($Lf._uploadVertexBuffer!==$L_||$LR)&&($Lf.uploadAttributes($LA.shaderValues.data,null),$Lf._uploadVertexBuffer=$L_);($Lf._uploadScene!==$Lp||$LR)&&($Lf.uploadSceneUniforms($Lp._shaderValues.data),$Lf._uploadScene=$Lp),($Lg!==$Lf._uploadCamera||$Lf._uploadSprite3D!==$LB||$LR)&&($Lf.uploadSpriteUniforms($LB._shaderValues.data),$Lf._uploadSprite3D=$LB),($Lg!==$Lf._uploadCamera||$LR)&&($Lf.uploadCameraUniforms($Lg._shaderValues.data),$Lf._uploadCamera=$Lg),($Lf._uploadMaterial!==$Lc||$LR)&&($Lc._upload(),$Lf._uploadMaterial=$Lc),$LE!==$Lc?($Lc._setRenderStateBlendDepth(),$Lc._setRenderStateFrontFace($Li,$LB.transform),$LE=$Lc,$LG=$LB):$LG!==$LB&&($Lc._setRenderStateFrontFace($Li,$LB.transform),$LG=$LB),$LO._render($Lr),$Lf._uploadLoopCount=$LN}$LB._postRenderUpdateComponents($Lr)}else if(2===$Ly._type){$Ly.renderObj;$Lr.owner=$LB=$Ly._sprite3D,$Lr.renderElement=$Ly,$Lr._batchIndexStart=$Ly._tempBatchIndexStart,$Lr._batchIndexEnd=$Ly._tempBatchIndexEnd,$LO=$Ly.renderObj,$Lc=$Ly._material,this._begainRenderElement($Lr,$LO,$Lc)&&($LA=($L_=$LO._getVertexBuffer(0)).vertexDeclaration,$LR=($Lf=$Lr._shader=$Lc._getShader($Lp._shaderDefineValue,$LA.shaderDefineValue,$LB._shaderDefineValue)).bind()||$LN!==$Lf._uploadLoopCount,($Lf._uploadVertexBuffer!==$L_||$LR)&&($Lf.uploadAttributes($LA.shaderValues.data,null),$Lf._uploadVertexBuffer=$L_),($Lf._uploadScene!==$Lp||$LR)&&($Lf.uploadSceneUniforms($Lp._shaderValues.data),$Lf._uploadScene=$Lp),($Lg!==$Lf._uploadCamera||$Lf._uploadSprite3D!==$LB||$LR)&&($Lf.uploadSpriteUniforms($LB._shaderValues.data),$Lf._uploadSprite3D=$LB),($Lg!==$Lf._uploadCamera||$LR)&&($Lf.uploadCameraUniforms($Lg._shaderValues.data),$Lf._uploadCamera=$Lg),($Lf._uploadMaterial!==$Lc||$LR)&&($Lc._upload(),$Lf._uploadMaterial=$Lc),$LE!==$Lc?($Lc._setRenderStateBlendDepth(),$Lc._setRenderStateFrontFace($Li,$LB.transform),$LE=$Lc,$LG=$LB):$LG!==$LB&&($Lc._setRenderStateFrontFace($Li,$LB.transform),$LG=$LB),$LO._render($Lr),$Lf._uploadLoopCount=$LN)}}},$Lr._renderShadow=function($Lr,$Li){for(var $Lt,$L_,$LA,$Lf,$LE,$LG=$LH.loopCount,$LN=this._scene,$Lp=$Lr.camera,$Lg=!1,$LR=0,$LX=this._finalElements.length;$LR<$LX;$LR++){var $Lv,$LO,$Lc,$LB=this._finalElements[$LR];0===$LB._type&&($Lr.owner=$Lc=$LB._sprite3D,$Li||$Lc._projectionViewWorldUpdateCamera===$Lp&&$Lc._projectionViewWorldUpdateLoopCount===$LH.loopCount||($Lc._render._renderUpdate($Lr._projectionViewMatrix),$Lc._projectionViewWorldUpdateLoopCount=$LH.loopCount,$Lc._projectionViewWorldUpdateCamera=$Lp),$Lr.renderElement=$LB,$Lc._preRenderUpdateComponents($Lr),$Lv=$LB.renderObj,$LO=$LB._material,this._begainRenderElement($Lr,$Lv,null)&&($L_=($Lt=$Lv._getVertexBuffer(0)).vertexDeclaration,$Lg=($LA=$Lr._shader=$LO._getShader($LN._shaderDefineValue,$L_.shaderDefineValue,$Lc._shaderDefineValue)).bind()||$LG!==$LA._uploadLoopCount,($LA._uploadVertexBuffer!==$Lt||$Lg)&&($LA.uploadAttributes($L_.shaderValues.data,null),$LA._uploadVertexBuffer=$Lt),($Lp!==$LA._uploadCamera||$LA._uploadSprite3D!==$Lc||$Lg)&&($LA.uploadSpriteUniforms($Lc._shaderValues.data),$LA._uploadSprite3D=$Lc),($Lp!==$LA._uploadCamera||$Lg)&&($LA.uploadCameraUniforms($Lp._shaderValues.data),$LA._uploadCamera=$Lp),($LA._uploadMaterial!==$LO||$Lg)&&($LO._upload(),$LA._uploadMaterial=$LO),$LA._uploadRenderElement,$Lf!==$LO?($LO._setRenderStateFrontFace(!1,$Lc.transform),$Lf=$LO,$LE=$Lc):$LE!==$Lc&&($LO._setRenderStateFrontFace(!1,$Lc.transform),$LE=$Lc),$Lv._render($Lr),$LA._uploadLoopCount=$LG),$Lc._postRenderUpdateComponents($Lr))}},$Lr._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},$Lr._addRenderElement=function($Lr){this._renderElements.push($Lr),this._needSort=!0},$Lr._addDynamicBatchElement=function($Lr){this._dynamicBatchCombineRenderElements.push($Lr)},$LO(0,$Lr,"id",function(){return this._id}),$Li._uniqueIDCounter=0,$Li._cameraPosition=null,$Li}(),$LW=function(){function $Lr(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return $Lv($Lr,"laya.d3.core.render.RenderState"),$Lr.clientWidth=0,$Lr.clientHeight=0,$Lr}(),$LM=function(){function $LE($Lr,$Li){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new $LSr(new $LEi,0),this._corners=[new $LEi,new $LEi,new $LEi,new $LEi,new $LEi,new $LEi,new $LEi,new $LEi],this._boundingBoxCenter=new $LEi,this._children=$L_(8),this._objects=[],this._tempBoundBoxCorners=[new $LEi,new $LEi,new $LEi,new $LEi,new $LEi,new $LEi,new $LEi,new $LEi],this._scene=$Lr,this._currentDepth=$Li}$Lv($LE,"laya.d3.core.scene.OctreeNode");var $Lr=$LE.prototype;return $LD.imps($Lr,{"laya.d3.core.scene.ITreeNode":!0}),$Lr.init=function($Lr,$Li){var $Lt=new $LEi,$L_=new $LEi;$LEi.scale($Li,-.5,$Lt),$LEi.scale($Li,.5,$L_),$LEi.add($Lt,$Lr,$Lt),$LEi.add($L_,$Lr,$L_),this.exactBox=new $LMr($Lt,$L_),this.relaxBox=new $LMr($Lt,$L_)},$Lr.addTreeNode=function($Lr){1===Collision.boxContainsBox(this._relaxBox,$Lr.boundingBox)?this.addNodeDown($Lr,0):this.addObject($Lr)},$Lr.addChild=function($Lr){var $Li=this._children[$Lr];if(null==$Li){$Li=new $LE(this._scene,this._currentDepth+1),(this._children[$Lr]=$Li)._parent=this,$LEi.subtract(this._exactBox.max,this._exactBox.min,$LE.tempSize),$LEi.multiply($LE.tempSize,$LE._octreeSplit[$Lr],$LE.tempCenter),$LEi.add(this._exactBox.min,$LE.tempCenter,$LE.tempCenter),$LEi.scale($LE.tempSize,.25,$LE.tempSize);var $Lt=new $LEi,$L_=new $LEi;$LEi.subtract($LE.tempCenter,$LE.tempSize,$Lt),$LEi.add($LE.tempCenter,$LE.tempSize,$L_),$Li.exactBox=new $LMr($Lt,$L_),$LEi.scale($LE.tempSize,$LE.relax,$LE.tempSize);var $LA=new $LEi,$Lf=new $LEi;$LEi.subtract($LE.tempCenter,$LE.tempSize,$LA),$LEi.add($LE.tempCenter,$LE.tempSize,$Lf),$Li.relaxBox=new $LMr($LA,$Lf)}return $Li},$Lr.addObject=function($Lr){($Lr._treeNode=this)._objects.push($Lr)},$Lr.removeObject=function($Lr){if($Lr._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var $Li=this._objects.indexOf($Lr);return-1!==$Li&&(this._objects.splice($Li,1),!0)},$Lr.clearObject=function(){this._objects.length=0},$Lr.addNodeUp=function($Lr,$Li){this._parent&&1!==Collision.boxContainsBox(this._exactBox,$Lr.boundingBox)?this._parent.addNodeUp($Lr,$Li-1):this.addNodeDown($Lr,$Li)},$Lr.addNodeDown=function($Lr,$Li){if($Li<this._scene.treeLevel){var $Lt=this.inChildIndex($Lr.boundingBoxCenter),$L_=this.addChild($Lt);1===Collision.boxContainsBox($L_._relaxBox,$Lr.boundingBox)?$L_.addNodeDown($Lr,++$Li):this.addObject($Lr)}else this.addObject($Lr)},$Lr.inChildIndex=function($Lr){return 4*($Lr.z<this._boundingBoxCenter.z?0:1)+2*($Lr.y<this._boundingBoxCenter.y?0:1)+($Lr.x<this._boundingBoxCenter.x?0:1)},$Lr.updateObject=function($Lr){1===Collision.boxContainsBox(this._relaxBox,$Lr.boundingBox)?(this.removeObject($Lr),$Lr._treeNode=null,this.addNodeDown($Lr,this._currentDepth)):this._parent&&(this.removeObject($Lr),$Lr._treeNode=null,this._parent.addNodeUp($Lr,this._currentDepth-1))},$Lr.cullingObjects=function($Lr,$Li,$Lt,$L_,$LA){var $Lf,$LE=0,$LG=0,$LN=0,$Lp=this._scene._dynamicBatchManager;for($LE=0,$Lf=this._objects.length;$LE<$Lf;$LE++){var $Lg=this._objects[$LE];if($LQ.isVisible($Lg._owner.layer.mask)&&$Lg.enable){if($Li&&($LH.treeSpriteCollision+=1,0===$Lr.containsBoundSphere($Lg.boundingSphere)))continue;$Lg._renderUpdate($LA),$Lg._distanceForSort=$LEi.distance($Lg.boundingSphere.center,$L_)+$Lg.sortingFudge;var $LR=$Lg._renderElements;for($LG=0,$LN=$LR.length;$LG<$LN;$LG++){var $LX=$LR[$LG],$Lv=$LX._staticBatch;if($Lv&&$Lv._material===$LX._material)$Lv._addBatchRenderElement($LX);else{var $LO=$LX.renderObj;$LO.triangleCount<10&&1===$LO._vertexBufferCount&&$LO._getIndexBuffer()&&$LX._material.renderQueue<2&&$LX._canDynamicBatch&&!$Lg._owner.isStatic?$Lp._addPrepareRenderElement($LX):this._scene.getRenderQueue($LX._material.renderQueue)._addRenderElement($LX)}}}}for($LE=0;$LE<8;$LE++){var $Lc=this._children[$LE];if(null!=$Lc){var $LB=$Li;if($Li){var $Ly=$Lr.containsBoundBox($Lc._relaxBox);if($LH.treeNodeCollision+=1,0===$Ly)continue;$LB=2===$Ly}$Lc.cullingObjects($Lr,$LB,$Lt,$L_,$LA)}}},$Lr.cullingShadowObjects=function($Lr,$Li,$Lt,$L_,$LA){var $Lf,$LE=0,$LG=0,$LN=0;this._scene._dynamicBatchManager;for($LE=0,$Lf=this._objects.length;$LE<$Lf;$LE++){var $Lp=this._objects[$LE];if($Lp.castShadow&&$LQ.isVisible($Lp._owner.layer.mask)&&$Lp.enable){if($Lt&&0===$Lr[0].containsBoundSphere($Lp.boundingSphere))continue;for(var $Lg=1,$LR=$Lr.length;$Lg<$LR;$Lg++){var $LX=$Li[$Lg-1];if(0!==$Lr[$Lg].containsBoundSphere($Lp.boundingSphere)){var $Lv=$Lp._renderElements;for($LG=0,$LN=$Lv.length;$LG<$LN;$LG++)$LX._addRenderElement($Lv[$LG])}}}}for($LE=0;$LE<8;$LE++){var $LO=this._children[$LE];if(null!=$LO){var $Lc=$Lt;if($Lt){var $LB=$Lr[0].containsBoundBox($LO._relaxBox);if(0===$LB)continue;$Lc=2===$LB}$LO.cullingShadowObjects($Lr,$Li,$Lc,$L_,$LA)}}},$Lr.cullingShadowObjectsOnePSSM=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE,$LG=$Li[0],$LN=0,$Lp=0,$Lg=0;for($LN=0,$LE=this._objects.length;$LN<$LE;$LN++){var $LR=this._objects[$LN];if($LR.castShadow&&$LQ.isVisible($LR._owner.layer.mask)&&$LR.enable){if($L_&&0===$Lr.containsBoundSphere($LR.boundingSphere))continue;$LR._renderUpdate($Lt);var $LX=$LR._renderElements;for($Lp=0,$Lg=$LX.length;$Lp<$Lg;$Lp++)$LG._addRenderElement($LX[$Lp])}}for($LN=0;$LN<8;$LN++){var $Lv=this._children[$LN];if(null!=$Lv){var $LO=$L_;if($L_){var $Lc=$Lr.containsBoundBox($Lv._relaxBox);if(0===$Lc)continue;$LO=2===$Lc}$Lv.cullingShadowObjectsOnePSSM($Lr,$Li,$Lt,$LO,$LA,$Lf)}}},$Lr.renderBoudingBox=function($Lr){this._renderBoudingBox($Lr);for(var $Li=0;$Li<8;++$Li){var $Lt=this._children[$Li];$Lt&&$Lt.renderBoudingBox($Lr)}},$Lr.buildAllChild=function($Lr){if($Lr<this._scene.treeLevel)for(var $Li=0;$Li<8;$Li++){this.addChild($Li).buildAllChild($Lr+1)}},$Lr._renderBoudingBox=function($Lr){},$LO(0,$Lr,"exactBox",function(){return this._exactBox},function($Lr){this._exactBox=$Lr,$LEi.add($Lr.min,$Lr.max,this._boundingBoxCenter),$LEi.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),$LO(0,$Lr,"relaxBox",function(){return this._relaxBox},function($Lr){(this._relaxBox=$Lr).getCorners(this._corners),$LSr.createfromPoints(this._corners,this._boundingSphere)}),$LE.debugMode=!1,$LE.relax=1.15,$LE.CHILDNUM=8,$LR($LE,["tempVector0",function(){return this.tempVector0=new $LEi},"tempSize",function(){return this.tempSize=new $LEi},"tempCenter",function(){return this.tempCenter=new $LEi},"_octreeSplit",function(){return this._octreeSplit=[new $LEi(.25,.25,.25),new $LEi(.75,.25,.25),new $LEi(.25,.75,.25),new $LEi(.75,.75,.25),new $LEi(.25,.25,.75),new $LEi(.75,.25,.75),new $LEi(.25,.75,.75),new $LEi(.75,.75,.75)]}]),$LE}(),$LK=(function(){function $Lr(){}$Lv($Lr,"laya.d3.core.scene.SceneManager")}(),function(){function $Lr($Lr,$Li,$Lt,$L_){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===$Lr&&($Lr=1),void 0===$Li&&($Li=1),void 0===$Lt&&($Lt=1),void 0===$L_&&($L_=1),this._r=$Lr,this._g=$Li,this._b=$Lt,this._a=$L_}return $Lv($Lr,"laya.d3.core.trail.module.Color",null,"Color$1"),$Lr.prototype.cloneTo=function($Lr){$Lr._r=this._r,$Lr._g=this._g,$Lr._b=this._b,$Lr._a=this._a},$LR($Lr,["RED",function(){return this.RED=new $Lr(1,0,0,1)},"GREEN",function(){return this.GREEN=new $Lr(0,1,0,1)},"BLUE",function(){return this.BLUE=new $Lr(0,0,1,1)},"CYAN",function(){return this.CYAN=new $Lr(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new $Lr(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new $Lr(1,0,1,1)},"GRAY",function(){return this.GRAY=new $Lr(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new $Lr(1,1,1,1)},"BLACK",function(){return this.BLACK=new $Lr(0,0,0,1)}]),$Lr}()),$LS=(function(){function $Lr(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}$Lv($Lr,"laya.d3.core.trail.module.Gradient");var $Li=$Lr.prototype;$Li.setKeys=function($Lr,$Li){var $Lt,$L_;this._colorKeys=$Lr;for(var $LA=this.index=0;$LA<$Lr.length;$LA++){var $Lf=($Lt=$Lr[$LA]).color;this._colorKeyData[this.index++]=$Lf._r,this._colorKeyData[this.index++]=$Lf._g,this._colorKeyData[this.index++]=$Lf._b,this._colorKeyData[this.index++]=$Lt.time}this._alphaKeys=$Li;for(var $LE=this.index=0;$LE<$Li.length;$LE++)$L_=$Li[$LE],this._alphaKeyData[this.index++]=$L_.alpha,this._alphaKeyData[this.index++]=$L_.time},$Li.cloneTo=function($Lr){var $Li=0,$Lt=0,$L_=this.colorKeys,$LA=[];for($Li=0,$Lt=$L_.length;$Li<$Lt;$Li++){var $Lf=new $LY;$L_[$Li].cloneTo($Lf),$LA.push($Lf)}var $LE=this.alphaKeys,$LG=[];for($Li=0,$Lt=$LE.length;$Li<$Lt;$Li++){var $LN=new $LS;$LE[$Li].cloneTo($LN),$LG.push($LN)}$Lr.setKeys($LA,$LG)},$LO(0,$Li,"mode",function(){return this._mode},function($Lr){this._mode=$Lr}),$LO(0,$Li,"colorKeys",function(){return this._colorKeys},function($Lr){this._colorKeys=$Lr;for(var $Li=this.index=0;$Li<$Lr.length;$Li++){var $Lt=$Lr[$Li],$L_=$Lt.color;this._colorKeyData[this.index++]=$L_._r,this._colorKeyData[this.index++]=$L_._g,this._colorKeyData[this.index++]=$L_._b,this._colorKeyData[this.index++]=$Lt.time}}),$LO(0,$Li,"alphaKeys",function(){return this._alphaKeys},function($Lr){this._alphaKeys=$Lr;for(var $Li=this.index=0;$Li<$Lr.length;$Li++){var $Lt=$Lr[$Li];this._alphaKeyData[this.index++]=$Lt.alpha,this._alphaKeyData[this.index++]=$Lt.time}})}(),function(){function $Lr($Lr,$Li){this._alpha=NaN,this._time=NaN,void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),this._alpha=$Lr,this._time=$Li}$Lv($Lr,"laya.d3.core.trail.module.GradientAlphaKey");var $Li=$Lr.prototype;return $Li.cloneTo=function($Lr){$Lr.alpha=this.alpha,$Lr.time=this.time},$LO(0,$Li,"alpha",function(){return this._alpha},function($Lr){this._alpha=$Lr}),$LO(0,$Li,"time",function(){return this._time},function($Lr){this._time=$Lr}),$Lr}()),$LY=function(){function $Lr($Lr,$Li){this._color=null,this._time=NaN,void 0===$Li&&($Li=0),this._color=$Lr||new $LK,this._time=$Li}$Lv($Lr,"laya.d3.core.trail.module.GradientColorKey");var $Li=$Lr.prototype;return $Li.cloneTo=function($Lr){this.color.cloneTo($Lr.color),$Lr.time=this.time},$LO(0,$Li,"color",function(){return this._color},function($Lr){this._color=$Lr}),$LO(0,$Li,"time",function(){return this._time},function($Lr){this._time=$Lr}),$Lr}(),$Lj=(function(){function $Lr(){}$Lv($Lr,"laya.d3.core.trail.module.GradientMode"),$Lr.Blend=0,$Lr.Fixed=1}(),function(){function $Lr(){}$Lv($Lr,"laya.d3.core.trail.module.TextureMode"),$Lr.Stretch=0,$Lr.Tile=1}(),function(){function $Lr(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}$Lv($Lr,"laya.d3.core.trail.module.TrailKeyFrame"),$Lr.prototype.cloneTo=function($Lr){$Lr.time=this.time,$Lr.inTangent=this.inTangent,$Lr.outTangent=this.outTangent,$Lr.value=this.value}}(),function(){function $Li($Lr){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new $LEi,this._curPosition=new $LEi,this._delVector3=new $LEi,this._lastFixedVertexPosition=new $LEi,this._pointAtoBVector3=new $LEi,this._pointA=new $LEi,this._pointB=new $LEi,this._owner=$Lr,this._id=$Li.renderElementCount++,0==this._id?$Lr._owner.transform.position.cloneTo(this._lastPosition):$Lr._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new $Lqi($Lj.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new $Lqi($Lj.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}$Lv($Li,"laya.d3.core.trail.TrailRenderElement");var $Lr=$Li.prototype;$LD.imps($Lr,{"laya.d3.core.render.IRenderable":!0}),$Lr._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},$Lr._addTrailByFirstPosition=function($Lr,$Li){$LEi.subtract($Li,$Lr,this._delVector3),$LEi.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$LEi.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$LEi.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition($Lr),$Lr.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},$Lr._addTrailByNextPosition=function($Lr){$LEi.subtract($Lr,this._lastFixedVertexPosition,this._delVector3),$LEi.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$LEi.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$LEi.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=$LEi.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=$LYr.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition($Lr),$Lr.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition($Lr),this._virtualVerticesCount=2)},$Lr._updateVerticesByPosition=function($Lr){this._pointe=$Lr.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},$Lr._updateVertexBuffer2=function(){var $Lr,$Li=0,$Lt=0,$L_=0;for($L_=0,$Lr=(this._verticesCount+this._virtualVerticesCount)/2;$L_<$Lr;$L_++)$Lt=0==this._owner.textureMode?(this._VerticesToTailLength[$L_]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[$L_],this._vertices2[$Li++]=1-$Lt,this._vertices2[$Li++]=1-$Lt;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},$Lr._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},$Lr._updateDisappear=function(){var $Lr,$Li=0;for($Li=this._curDisappearIndex,$Lr=(this._verticesCount+this._virtualVerticesCount)/2;$Li<$Lr;$Li++)this._owner._curtime-this._everyGroupVertexBirthTime[$Li]>=this._owner.time+$LYr.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},$Lr._beforeRender=function($Lr){return this._camera=$Lr.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),$LEi.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},$Lr._render=function($Lr){this._isDead||($Lk.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),$LH.drawCall++,$LH.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},$Lr._getVertexBuffer=function($Lr){return void 0===$Lr&&($Lr=0),0===$Lr?this._vertexBuffer1:1===$Lr?this._vertexBuffer2:null},$Lr._getVertexBuffers=function(){return this._vertexBuffers},$Lr._getIndexBuffer=function(){return null},$Lr.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},$Lr._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},$LO(0,$Lr,"_vertexBufferCount",function(){return this._vertexBuffers.length}),$LO(0,$Lr,"triangleCount",function(){return 0}),$Li.renderElementCount=0}(),function(){function $Lr(){}$Lv($Lr,"laya.d3.core.trail.VertexTrail");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration1}),$LO(1,$Lr,"vertexDeclaration1",function(){return $Lr._vertexDeclaration1}),$LO(1,$Lr,"vertexDeclaration2",function(){return $Lr._vertexDeclaration2}),$LR($Lr,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new $Lfr(32,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",41),new $LEr(24,"single",33),new $LEr(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new $Lfr(4,[new $LEr(0,"single",38)])}]),$Lr}()),$Lrr=function(){function $La($Lr){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=$Lr}$Lv($La,"laya.d3.graphics.DynamicBatch");var $Lr=$La.prototype;return $LD.imps($Lr,{"laya.d3.core.render.IRenderable":!0}),$Lr._getVertexBuffer=function($Lr){return void 0===$Lr&&($Lr=0),0===$Lr?this._vertexBuffer:null},$Lr._getIndexBuffer=function(){return this._indexBuffer},$Lr._getCombineRenderElementFromPool=function($Lr,$Li,$Lt){var $L_=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return $L_||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=$L_=new $LJ,$L_._sprite3D=new $LZi),$L_._sprite3D._render._renderUpdate($Lt),$L_},$Lr._getRenderElement=function($Lr,$Li,$Lt){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*$La.maxVertexCount),this._indexDatas=new Uint16Array($La.maxIndexCount),this._vertexBuffer=$Lqi.create(this._vertexDeclaration,$La.maxVertexCount,35048),this._indexBuffer=$LPi.create("ushort",$La.maxIndexCount,35048));for(var $L_=this._merageElements.length=0,$LA=0,$Lf=0,$LE=this._combineRenderElements.length;$Lf<$LE;$Lf++){var $LG=this._combineRenderElements[$Lf],$LN=$LG.getDynamicBatchBakedVertexs(0),$Lp=$LG.getBakedIndices(),$Lg=$LG._sprite3D.transform._isFrontFaceInvert,$LR=$L_/(this._vertexDeclaration.vertexStride/4),$LX=$LA,$Lv=$LX+$Lp.length;$LG._tempBatchIndexStart=$LX,$LG._tempBatchIndexEnd=$Lv,this._indexDatas.set($Lp,$LA);var $LO=0;if($Lg)for($LO=$LX;$LO<$Lv;$LO+=3){this._indexDatas[$LO]=$LR+this._indexDatas[$LO];var $Lc=this._indexDatas[$LO+1],$LB=this._indexDatas[$LO+2];this._indexDatas[$LO+1]=$LR+$LB,this._indexDatas[$LO+2]=$LR+$Lc}else for($LO=$LX;$LO<$Lv;$LO+=3)this._indexDatas[$LO]=$LR+this._indexDatas[$LO],this._indexDatas[$LO+1]=$LR+this._indexDatas[$LO+1],this._indexDatas[$LO+2]=$LR+this._indexDatas[$LO+2];$LA+=$Lp.length,this._vertexDatas.set($LN,$L_),$L_+=$LN.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),$Lf=this._combineRenderElementPoolIndex=0,$LE=this._materials.length;$Lf<$LE;$Lf++){var $Ly=this._getCombineRenderElementFromPool($Lr,$Li,$Lt);$Ly._type=2,$Ly._staticBatch=null;var $LC=($Ly.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[$Lf]]._tempBatchIndexStart,$Ln=$Lf+1===this._materialToRenderElementsOffsets.length?$LA:this._combineRenderElements[this._materialToRenderElementsOffsets[$Lf+1]]._tempBatchIndexStart;$Ly._tempBatchIndexStart=$LC,$Ly._tempBatchIndexEnd=$Ln,$Ly._material=this._materials[$Lf],this._merageElements.push($Ly)}},$Lr._addCombineRenderObjTest=function($Lr){var $Li=$Lr.renderObj,$Lt=this._currentCombineIndexCount+$Li._getIndexBuffer().indexCount,$L_=this._currentCombineVertexCount+$Li._getVertexBuffer().vertexCount;return!($La.maxVertexCount<$L_||$La.maxIndexCount<$Lt)},$Lr._addCombineRenderObj=function($Lr){var $Li=$Lr.renderObj;this._combineRenderElements.push($Lr),this._currentCombineIndexCount=this._currentCombineIndexCount+$Li._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$Li._getVertexBuffer().vertexCount},$Lr._addCombineMaterial=function($Lr){this._materials.push($Lr)},$Lr._addMaterialToRenderElementOffset=function($Lr){this._materialToRenderElementsOffsets.push($Lr)},$Lr._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},$Lr._addToRenderQueue=function($Lr,$Li,$Lt,$L_){this._getRenderElement($Li,$Lt,$L_);for(var $LA=0,$Lf=this._materials.length;$LA<$Lf;$LA++)$Lr.getRenderQueue(this._materials[$LA].renderQueue)._addDynamicBatchElement(this._merageElements[$LA])},$Lr._beforeRender=function($Lr){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$Lr._render=function($Lr){var $Li=$Lr._batchIndexEnd-$Lr._batchIndexStart;$Lk.mainContext.drawElements(4,$Li,5123,2*$Lr._batchIndexStart),$LH.drawCall++,$LH.trianglesFaces+=$Li/3},$Lr._getVertexBuffers=function(){return null},$LO(0,$Lr,"_vertexBufferCount",function(){return 1}),$LO(0,$Lr,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$LO(0,$Lr,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),$La.maxVertexCount=2e4,$La.maxIndexCount=4e4,$La.maxCombineTriangleCount=10,$La}(),$Lir=function(){function $La(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}$Lv($La,"laya.d3.graphics.DynamicBatchManager");var $Lr=$La.prototype;return $Lr.getDynamicBatch=function($Lr,$Li){var $Lt,$L_=$Lr.id.toString()+$Li;return this._dynamicBatches[$L_]?$Lt=this._dynamicBatches[$L_]:this._dynamicBatches[$L_]=$Lt=new $Lrr($Lr),$Lt},$Lr._garbageCollection=function(){for(var $Lr in this._dynamicBatches)0===this._dynamicBatches[$Lr].combineRenderElementsCount&&delete this._dynamicBatches[$Lr]},$Lr._addPrepareRenderElement=function($Lr){this._prepareDynamicBatchCombineElements.push($Lr)},$Lr._finishCombineDynamicBatch=function($Lr){var $Li,$Lt,$L_;this._prepareDynamicBatchCombineElements.sort($La._sortPrepareDynamicBatch);for(var $LA,$Lf,$LE,$LG,$LN,$Lp=-1,$Lg=!0,$LR=0,$LX=-1,$Lv=0,$LO=this._prepareDynamicBatchCombineElements.length;$Lv<$LO;$Lv++){var $Lc=($Lf=this._prepareDynamicBatchCombineElements[$Lv]).renderObj._getVertexBuffer(0).vertexDeclaration,$LB=$Lt!==$Lc;$LB&&($LR=0,$Lt=$Lc);var $Ly=$LR!==$Lp;if($Ly&&($Lp=$LR),($LB||$Ly)&&($LE=this.getDynamicBatch($Lc,$LR),$Li=null),$Lg)if($LE._addCombineRenderObjTest($Lf)){if($Li!==($LA=$Lf._material))$LG&&($Lr.getRenderQueue($LN._material.renderQueue)._addRenderElement($LN),$LN=$LG=null,$LX=-1),$LG=$LA,$LX=$LE.combineRenderElementsCount,$LN=$Lf,$Li=$LA;else if($LG){var $LC=$LN.renderObj,$Ln=$Lf.renderObj;$LC._getVertexBuffer().vertexCount+$Ln._getVertexBuffer().vertexCount>$Lrr.maxVertexCount||$LC._getIndexBuffer().indexCount+$Ln._getIndexBuffer().indexCount>$Lrr.maxIndexCount?($Lr.getRenderQueue($LN._material.renderQueue)._addRenderElement($LN),$LG=$LA,$LX=$LE.combineRenderElementsCount,$LN=$Lf):($LE._addCombineMaterial($LG),$LE._addMaterialToRenderElementOffset($LX),$LE._addCombineRenderObj($LN),$LN=$LG=null,$LX=-1,$LE._addCombineRenderObj($Lf))}else $LE._addCombineRenderObj($Lf);$Lg=!0}else $LG&&($Lr.getRenderQueue($LN._material.renderQueue)._addRenderElement($LN),$LN=$LG=null,$LX=-1),$LR++,$Lg=!1;else $L_=this._prepareDynamicBatchCombineElements[$Lv-1],$LE._addMaterialToRenderElementOffset($LE.combineRenderElementsCount),$Li=$L_._material,$LE._addCombineMaterial($Li),$LE._addCombineRenderObj($L_),$Lg=!0,$Li!==($LA=$Lf._material)?($LG=$LA,$LX=$LE.combineRenderElementsCount,$LN=$Lf):$LE._addCombineRenderObj($Lf),$Li=$LA}$LG&&($Lr.getRenderQueue($LN._material.renderQueue)._addRenderElement($LN),$LN=$LG=null,$LX=-1),this._prepareDynamicBatchCombineElements.length=0},$Lr._clearRenderElements=function(){for(var $Lr in this._dynamicBatches)this._dynamicBatches[$Lr]._clearRenderElements()},$Lr._addToRenderQueue=function($Lr,$Li,$Lt,$L_){for(var $LA in this._dynamicBatches){var $Lf=this._dynamicBatches[$LA];0<$Lf.combineRenderElementsCount&&$Lf._addToRenderQueue($Lr,$Li,$Lt,$L_)}},$Lr.dispose=function(){this._dynamicBatches=null},$La._sortPrepareDynamicBatch=function($Lr,$Li){return $Lr._mainSortID-$Li._mainSortID},$La}(),$Ltr=function(){function $Lr(){}return $Lv($Lr,"laya.d3.graphics.FrustumCulling"),$Lr.renderShadowObjectCulling=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=0,$LE=0,$LG=0,$LN=0;for($Lf=0,$LG=$Lt.length;$Lf<$LG;$Lf++){var $Lp=$Lt[$Lf];$Lp&&$Lp._clearRenderElements()}var $Lg,$LR,$LX,$Lv=$Lr._cullingRenders;if(1<$LA){for($Lf=0,$LG=$Lr._cullingRendersLength;$Lf<$LG;$Lf++)if(($Lg=$Lv[$Lf]).castShadow&&$LQ.isVisible($Lg._owner.layer.mask)&&$Lg.enable)for(var $LO=1,$Lc=$Li.length;$LO<$Lc;$LO++)if($LR=$Lt[$LO-1],0!==$Li[$LO].containsBoundSphere($Lg.boundingSphere))for($LE=0,$LN=($LX=$Lg._renderElements).length;$LE<$LN;$LE++)$LR._addRenderElement($LX[$LE])}else for($Lf=0,$LG=$Lr._cullingRendersLength;$Lf<$LG;$Lf++)if(($Lg=$Lv[$Lf]).castShadow&&$LQ.isVisible($Lg._owner.layer.mask)&&$Lg.enable&&0!==$Li[0].containsBoundSphere($Lg.boundingSphere))for($Lg._renderUpdate($L_),$LR=$Lt[0],$LE=0,$LN=($LX=$Lg._renderElements).length;$LE<$LN;$LE++)$LR._addRenderElement($LX[$LE])},$Lr.renderShadowObjectCullingOctree=function($Lr,$Li,$Lt,$L_,$LA){for(var $Lf=0,$LE=$Lt.length;$Lf<$LE;$Lf++){var $LG=$Lt[$Lf];$LG&&$LG._clearRenderElements()}1<$LA?$Lr.treeRoot.cullingShadowObjects($Li,$Lt,!0,0,$Lr):$Lr.treeRoot.cullingShadowObjectsOnePSSM($Li[0],$Lt,$L_,!0,0,$Lr)},$Lr.renderObjectCulling=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=0,$LG=0,$LN=0,$Lp=0,$Lg=$Li._quenes,$LR=$Li._dynamicBatchManager,$LX=$Li._cullingRenders;for($LE=0,$LG=$Lg.length;$LE<$LG;$LE++){var $Lv=$Lg[$LE];$Lv&&$Lv._clearRenderElements()}var $LO=$L_r._staticBatchManagers;for($LE=0,$LG=$LO.length;$LE<$LG;$LE++)$LO[$LE]._clearRenderElements();$LR._clearRenderElements();var $Lc=$Lt.transform.position;for($LE=0,$LG=$Li._cullingRendersLength;$LE<$LG;$LE++){var $LB=$LX[$LE];if($LQ.isVisible($LB._owner.layer.mask)&&$LB.enable&&0!==$Lr.containsBoundSphere($LB.boundingSphere)&&$LB._renderUpdate($Lf)){$LB._distanceForSort=$LEi.distance($LB.boundingSphere.center,$Lc)+$LB.sortingFudge;var $Ly=$LB._renderElements;for($LN=0,$Lp=$Ly.length;$LN<$Lp;$LN++){var $LC=$Ly[$LN],$Ln=$LC._staticBatch;if($Ln&&$Ln._material===$LC._material)$Ln._addBatchRenderElement($LC);else{var $La=$LC.renderObj;$La.triangleCount<10&&1===$La._vertexBufferCount&&$La._getIndexBuffer()&&$LC._material.renderQueue<2&&$LC._canDynamicBatch&&!$LB._owner.isStatic?$LR._addPrepareRenderElement($LC):$Li.getRenderQueue($LC._material.renderQueue)._addRenderElement($LC)}}}}for($LE=0,$LG=$LO.length;$LE<$LG;$LE++)$LO[$LE]._addToRenderQueue($Li,$L_,$LA,$Lf);$LR._finishCombineDynamicBatch($Li),$LR._addToRenderQueue($Li,$L_,$LA,$Lf)},$Lr.renderObjectCullingOctree=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=0,$LG=0,$LN=$Li._quenes,$Lp=$Li._dynamicBatchManager;for($LE=0,$LG=$LN.length;$LE<$LG;$LE++){var $Lg=$LN[$LE];$Lg&&$Lg._clearRenderElements()}var $LR=$L_r._staticBatchManagers;for($LE=0,$LG=$LR.length;$LE<$LG;$LE++)$LR[$LE]._clearRenderElements();for($Lp._clearRenderElements(),$Li._cullingRenders.length=0,$Li.treeRoot.cullingObjects($Lr,!0,0,$Lt.transform.position,$Lf),$LE=0,$LG=$LR.length;$LE<$LG;$LE++)$LR[$LE]._addToRenderQueue($Li,$L_,$LA,$Lf);$Lp._finishCombineDynamicBatch($Li),$Lp._addToRenderQueue($Li,$L_,$LA,$Lf)},$Lr.renderObjectCullingNoBoundFrustum=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=0,$LE=0,$LG=0,$LN=0,$Lp=$Lr._quenes,$Lg=$Lr._dynamicBatchManager,$LR=$Lr._cullingRenders;for($Lf=0,$LE=$Lp.length;$Lf<$LE;$Lf++){var $LX=$Lp[$Lf];$LX&&$LX._clearRenderElements()}var $Lv=$L_r._staticBatchManagers;for($Lf=0,$LE=$Lv.length;$Lf<$LE;$Lf++)$Lv[$Lf]._clearRenderElements();$Lg._clearRenderElements();var $LO=$Li.transform.position;for($Lf=0,$LE=$Lr._cullingRendersLength;$Lf<$LE;$Lf++){var $Lc=$LR[$Lf];if($LQ.isVisible($Lc._owner.layer.mask)&&$Lc.enable){$Lc._renderUpdate($LA),$Lc._distanceForSort=$LEi.distance($Lc.boundingSphere.center,$LO)+$Lc.sortingFudge;var $LB=$Lc._renderElements;for($LG=0,$LN=$LB.length;$LG<$LN;$LG++){var $Ly=$LB[$LG],$LC=$Ly._staticBatch;if($LC&&$LC._material===$Ly._material)$LC._addBatchRenderElement($Ly);else{var $Ln=$Ly.renderObj;$Ln.triangleCount<10&&1===$Ln._vertexBufferCount&&$Ln._getIndexBuffer()&&$Ly._material.renderQueue<2&&$Ly._canDynamicBatch&&!$Lc._owner.isStatic?$Lg._addPrepareRenderElement($Ly):$Lr.getRenderQueue($Ly._material.renderQueue)._addRenderElement($Ly)}}}}for($Lf=0,$LE=$Lv.length;$Lf<$LE;$Lf++)$Lv[$Lf]._addToRenderQueue($Lr,$Lt,$L_,$LA);$Lg._finishCombineDynamicBatch($Lr),$Lg._addToRenderQueue($Lr,$Lt,$L_,$LA)},$Lr}(),$L_r=function(){function $Lf(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}$Lv($Lf,"laya.d3.graphics.StaticBatchManager");var $Lr=$Lf.prototype;return $Lr._finishInit=function(){for(var $Lr in this._staticBatches)this._staticBatches[$Lr]._finishInit();this._initBatchRenderElements.length=0},$Lr._initStaticBatchs=function($Lr){throw new Error("StaticBatchManager:must override this function.")},$Lr._addInitBatchSprite=function($Lr){for(var $Li=$Lr._render._renderElements,$Lt=0,$L_=$Li.length;$Lt<$L_;$Lt++)this._initBatchRenderElements.push($Li[$Lt])},$Lr._clearRenderElements=function(){for(var $Lr in this._staticBatches)this._staticBatches[$Lr]._clearRenderElements()},$Lr._garbageCollection=function($Lr){var $Li=$Lr._staticBatch,$Lt=$Li._initBatchRenderElements,$L_=$Lt.indexOf($Lr);$Lt.splice($L_,1),0===$Lt.length&&($Li.dispose(),delete this._staticBatches[$Li._key])},$Lr._addToRenderQueue=function($Lr,$Li,$Lt,$L_){for(var $LA in this._staticBatches){var $Lf=this._staticBatches[$LA];0<$Lf._batchRenderElements.length&&$Lf._updateToRenderQueue($Lr,$L_)}},$Lr.dispose=function(){this._staticBatches=null},$Lf._addToStaticBatchQueue=function($Lr){$Lr instanceof laya.d3.core.RenderableSprite3D&&$Lr._addToInitStaticBatchManager();for(var $Li=0,$Lt=$Lr.numChildren;$Li<$Lt;$Li++)$Lf._addToStaticBatchQueue($Lr._childs[$Li])},$Lf.combine=function($Lr,$Li){var $Lt,$L_=0,$LA=0;if($Li)for($L_=0,$LA=$Li.length;$L_<$LA;$L_++){$Li[$L_]._addToInitStaticBatchManager()}else $Lr&&$Lf._addToStaticBatchQueue($Lr);for($L_=0,$LA=$Lf._staticBatchManagers.length;$L_<$LA;$L_++)($Lt=$Lf._staticBatchManagers[$L_])._initStaticBatchs($Lr),$Lt._finishInit()},$Lf._staticBatchManagers=[],$Lf}(),$LAr=function(){function $Lr($Lr,$Li,$Lt){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=$Lr,this._manager=$Li,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=$Lt}$Lv($Lr,"laya.d3.graphics.StaticBatch");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$Li._binarySearch=function($Lr){for(var $Li=0,$Lt=this._batchRenderElements.length-1,$L_=0;$Li<=$Lt;)$L_=Math.floor(($Li+$Lt)/2),this._compareBatchRenderElement(this._batchRenderElements[$L_],$Lr)?$Lt=$L_-1:$Li=$L_+1;return $Li},$Li._compareBatchRenderElement=function($Lr,$Li){throw new Error("StaticBatch:must override this function.")},$Li._getVertexDecLightMap=function($Lr){return $Lr===$LPr.vertexDeclaration?$LQr.vertexDeclaration:$Lr===$Lhr.vertexDeclaration?$LLr.vertexDeclaration:$Lr===$Lsr.vertexDeclaration?$Lar.vertexDeclaration:$Lr===$Lxr.vertexDeclaration?null:$Lr===$Lcr.vertexDeclaration?$LBr.vertexDeclaration:$Lr===$Lmr.vertexDeclaration?$Lbr.vertexDeclaration:$Lr===$Lkr.vertexDeclaration?$Ler.vertexDeclaration:$Lr===$Lqr.vertexDeclaration?$LFr.vertexDeclaration:$Lr===$Lhr.vertexDeclaration?$LLr.vertexDeclaration:$Lr===$Ldr.vertexDeclaration?$LDr.vertexDeclaration:$Lr===$Lxr.vertexDeclaration?null:$Lr===$Lcr.vertexDeclaration?$LBr.vertexDeclaration:$Lr===$LTr.vertexDeclaration?$LVr.vertexDeclaration:$Lr===$Lkr.vertexDeclaration?$Ler.vertexDeclaration:$Lr},$Li._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},$Li._addBatchRenderElement=function($Lr){this._batchRenderElements.splice(this._binarySearch($Lr),0,$Lr)},$Li._updateToRenderQueue=function($Lr,$Li){this._combineRenderElementPoolIndex=0,this._getRenderElement($Lr.getRenderQueue(this._material.renderQueue)._renderElements,$Lr,$Li)},$Li._getRenderElement=function($Lr,$Li,$Lt){throw new Error("StaticBatch:must override this function.")},$Li._finishInit=function(){throw new Error("StaticBatch:must override this function.")},$Li._clearRenderElements=function(){this._batchRenderElements.length=0},$Li.dispose=function(){},$Li._getVertexBuffer=function($Lr){return void 0===$Lr&&($Lr=0),null},$Li._getIndexBuffer=function(){return null},$Li._beforeRender=function($Lr){return!0},$Li._render=function($Lr){},$Li._getVertexBuffers=function(){return null},$LO(0,$Li,"_vertexBufferCount",function(){return 1}),$LO(0,$Li,"triangleCount",function(){return 0}),$Lr.combine=function($Lr){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),$L_r.combine($Lr)},$Lr.maxBatchVertexCount=65535,$Lr}(),$Lfr=function(){function $LE($Lr,$Li){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++$LE._uniqueIDCounter,this._id>$LE.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",$LE.maxVertexDeclaration);this._shaderValues=new $LXi,this._vertexElementsDic={},this._vertexStride=$Lr,this._vertexElements=$Li;for(var $Lt=0;$Lt<$Li.length;$Lt++){var $L_=$Li[$Lt],$LA=$L_.elementUsage;this._vertexElementsDic[$LA]=$L_;var $Lf=[$LE._getTypeSize($L_.elementFormat)/4,5126,!1,this._vertexStride,$L_.offset];switch(this._shaderValues.setValue($LA,$Lf),$LA){case 1:this._addShaderDefine($LHi.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine($LHi.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine($LHi.SHADERDEFINE_UV1)}}}$Lv($LE,"laya.d3.graphics.VertexDeclaration");var $Lr=$LE.prototype;return $Lr._addShaderDefine=function($Lr){this._shaderDefineValue|=$Lr},$Lr._removeShaderDefine=function($Lr){this._shaderDefineValue&=~$Lr},$Lr.getVertexElements=function(){return this._vertexElements.slice()},$Lr.getVertexElementByUsage=function($Lr){return this._vertexElementsDic[$Lr]},$Lr.unBinding=function(){},$LO(0,$Lr,"shaderDefineValue",function(){return this._shaderDefineValue}),$LO(0,$Lr,"id",function(){return this._id}),$LO(0,$Lr,"vertexStride",function(){return this._vertexStride}),$LO(0,$Lr,"shaderValues",function(){return this._shaderValues}),$LE._getTypeSize=function($Lr){switch($Lr){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},$LE.getVertexStride=function($Lr){for(var $Li=0,$Lt=0;$Lt<$Lr.Length;$Lt++){var $L_=$Lr[$Lt],$LA=$L_.offset+$LE._getTypeSize($L_.elementFormat);$Li<$LA&&($Li=$LA)}return $Li},$LE._maxVertexDeclarationBit=1e3,$LE._uniqueIDCounter=1,$LR($LE,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),$LE}(),$LEr=function(){function $Lr($Lr,$Li,$Lt){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=$Lr,this.elementFormat=$Li,this.elementUsage=$Lt}return $Lv($Lr,"laya.d3.graphics.VertexElement"),$Lr}(),$LGr=(function(){function $Lr(){}$Lv($Lr,"laya.d3.graphics.VertexElementFormat"),$Lr.Single="single",$Lr.Vector2="vector2",$Lr.Vector3="vector3",$Lr.Vector4="vector4",$Lr.Color="color",$Lr.Byte4="byte4",$Lr.Short2="short2",$Lr.Short4="short4",$Lr.NormalizedShort2="normalizedshort2",$Lr.NormalizedShort4="normalizedshort4",$Lr.HalfVector2="halfvector2",$Lr.HalfVector4="halfvector4"}(),function(){function $Lr(){}$Lv($Lr,"laya.d3.graphics.VertexElementUsage"),$Lr.POSITION0=0,$Lr.COLOR0=1,$Lr.TEXTURECOORDINATE0=2,$Lr.NORMAL0=3,$Lr.BINORMAL0=4,$Lr.TANGENT0=5,$Lr.BLENDINDICES0=6,$Lr.BLENDWEIGHT0=7,$Lr.DEPTH0=8,$Lr.FOG0=9,$Lr.POINTSIZE0=10,$Lr.SAMPLE0=11,$Lr.TESSELLATEFACTOR0=12,$Lr.COLOR1=13,$Lr.NEXTTEXTURECOORDINATE0=14,$Lr.TEXTURECOORDINATE1=15,$Lr.NEXTTEXTURECOORDINATE1=16,$Lr.CORNERTEXTURECOORDINATE0=17,$Lr.VELOCITY0=18,$Lr.STARTCOLOR0=19,$Lr.STARTSIZE=20,$Lr.AGEADDSCALE0=21,$Lr.STARTROTATION=22,$Lr.ENDCOLOR0=23,$Lr.STARTLIFETIME=24,$Lr.TIME0=33,$Lr.SHAPEPOSITIONSTARTLIFETIME=30,$Lr.DIRECTIONTIME=32,$Lr.SIZEROTATION0=27,$Lr.RADIUS0=28,$Lr.RADIAN0=29,$Lr.STARTSPEED=31,$Lr.RANDOM0=34,$Lr.RANDOM1=35,$Lr.SIMULATIONWORLDPOSTION=36,$Lr.SIMULATIONWORLDROTATION=37,$Lr.TEXTURECOORDINATE0X=38,$Lr.TEXTURECOORDINATE0X1=39,$Lr.TEXTURECOORDINATE0Y=40,$Lr.OFFSETVECTOR=41}(),function(){function $Lr($Lr,$Li,$Lt){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=$Lr,this._textureCoordinate0=$Li,this._time=$Lt}$Lv($Lr,"laya.d3.graphics.VertexGlitter");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate0}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"time",function(){return this._time}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(24,[new $LEr(0,"vector3",0),new $LEr(12,"vector2",2),new $LEr(20,"single",33)])}])}(),function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=$Lr,this._position=$Li,this._velocity=$Lt,this._startColor=$L_,this._endColor=$LA,this._sizeRotation=$Lf,this._radius=$LE,this._radian=$LG,this._ageAddScale=$LN,this._time=$Lp}$Lv($Lr,"laya.d3.graphics.VertexParticle");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"endColor",function(){return this._endColor}),$LO(0,$Li,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$LO(0,$Li,"sizeRotation",function(){return this._sizeRotation}),$LO(0,$Li,"velocity",function(){return this._velocity}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"startColor",function(){return this._startColor}),$LO(0,$Li,"radius",function(){return this._radius}),$LO(0,$Li,"radian",function(){return this._radian}),$LO(0,$Li,"ageAddScale",function(){return this._ageAddScale}),$LO(0,$Li,"time",function(){return this._time}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(116,[new $LEr(0,"vector4",17),new $LEr(16,"vector3",0),new $LEr(28,"vector3",18),new $LEr(40,"vector4",19),new $LEr(56,"vector4",23),new $LEr(72,"vector3",27),new $LEr(84,"vector2",28),new $LEr(92,"vector4",29),new $LEr(108,"single",24),new $LEr(112,"single",33)])}])}(),function(){function $Lr($Lr){this._position=null,this._position=$Lr}$Lv($Lr,"laya.d3.graphics.VertexPosition");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(12,[new $LEr(0,"vector3",0)])}]),$Lr}()),$LNr=function(){function $Lr($Lr,$Li){this._position=null,this._normal=null,this._position=$Lr,this._normal=$Li}$Lv($Lr,"laya.d3.graphics.VertexPositionNormal");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(24,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3)])}]),$Lr}(),$Lpr=function(){function $Lr($Lr,$Li,$Lt){this._position=null,this._normal=null,this._color=null,this._position=$Lr,this._normal=$Li,this._color=$Lt}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColor");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(40,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1)])}]),$Lr}(),$Lgr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._blendIndex=$L_,this._blendWeight=$LA}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorSkin");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(72,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector4",7),new $LEr(56,"vector4",6)])}]),$Lr}(),$LRr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._tangent=$L_,this._blendIndex=$LA,this._blendWeight=$Lf}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(88,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector4",7),new $LEr(56,"vector4",6),new $LEr(72,"vector4",5)])}]),$Lr}(),$LXr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._tangent=$L_,this._blendIndex=$LA,this._blendWeight=$Lf}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(84,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector4",7),new $LEr(56,"vector4",6),new $LEr(72,"vector3",5)])}]),$Lr}(),$Lvr=function(){function $Lr($Lr,$Li,$Lt,$L_){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._tangent=$L_}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorSTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(56,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector4",5)])}]),$Lr}(),$LOr=function(){function $Lr($Lr,$Li,$Lt,$L_){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._tangent=$L_}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(52,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector3",5)])}]),$Lr}(),$Lcr=function(){function $Lr($Lr,$Li,$Lt,$L_){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._textureCoordinate=$L_}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTexture");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(48,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector2",2)])}]),$Lr}(),$LBr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._textureCoordinate0=$L_,this._textureCoordinate1=$LA}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(56,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector2",2),new $LEr(48,"vector2",15)])}]),$Lr}(),$Lyr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._textureCoordinate0=$L_,this._textureCoordinate1=$LA,this._blendIndex=$Lf,this._blendWeight=$LE}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(88,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector2",2),new $LEr(48,"vector2",15),new $LEr(56,"vector4",7),new $LEr(72,"vector4",6)])}]),$Lr}(),$LCr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._textureCoordinate0=$L_,this._textureCoordinate1=$LA,this._tangent=$Lf,this._blendIndex=$LE,this._blendWeight=$LG}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(104,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector2",2),new $LEr(48,"vector2",15),new $LEr(56,"vector4",7),new $LEr(72,"vector4",6),new $LEr(88,"vector4",5)])}]),$Lr}(),$Lnr=function(){function $Lr(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$Li.VertexPositionNormalColorTexture0SkinTangent=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){this._position=$Lr,this._normal=$Li,this._color=$Lt,this._textureCoordinate0=$L_,this._textureCoordinate1=$LA,this._tangent=$Lf,this._blendIndex=$LE,this._blendWeight=$LG},$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(100,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector2",2),new $LEr(48,"vector2",15),new $LEr(56,"vector4",7),new $LEr(72,"vector4",6),new $LEr(88,"vector3",5)])}]),$Lr}(),$Lar=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._textureCoordinate0=$L_,this._textureCoordinate1=$LA,this._tangent=$Lf}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(72,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector2",2),new $LEr(48,"vector2",15),new $LEr(56,"vector4",5)])}]),$Lr}(),$LDr=function(){function $Lr(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$Li.VertexPositionNormalColorTexture0Tangent=function($Lr,$Li,$Lt,$L_,$LA,$Lf){this._position=$Lr,this._normal=$Li,this._color=$Lt,this._textureCoordinate0=$L_,this._textureCoordinate1=$LA,this._tangent=$Lf},$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(68,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector2",2),new $LEr(48,"vector2",15),new $LEr(56,"vector3",5)])}]),$Lr}(),$Lur=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._textureCoordinate=$L_,this._blendIndex=$LA,this._blendWeight=$Lf}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(80,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector2",2),new $LEr(48,"vector4",7),new $LEr(64,"vector4",6)])}]),$Lr}(),$Lwr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._textureCoordinate=$L_,this._tangent=$LA,this._blendIndex=$Lf,this._blendWeight=$LE}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(96,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector2",2),new $LEr(48,"vector4",7),new $LEr(64,"vector4",6),new $LEr(80,"vector4",5)])}]),$Lr}(),$LHr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._textureCoordinate=$L_,this._tangent=$LA,this._blendIndex=$Lf,this._blendWeight=$LE}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(92,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector2",2),new $LEr(48,"vector4",7),new $LEr(64,"vector4",6),new $LEr(80,"vector3",5)])}]),$Lr}(),$Lsr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._textureCoordinate=$L_,this._tangent=$LA}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(64,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector2",2),new $LEr(48,"vector4",5)])}]),$Lr}(),$Ldr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._color=$Lt,this._textureCoordinate=$L_,this._tangent=$LA}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"color",function(){return this._color}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(60,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",1),new $LEr(40,"vector2",2),new $LEr(48,"vector3",5)])}]),$Lr}(),$Llr=function(){function $Lr($Lr,$Li,$Lt){this._position=null,this._normal=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._tangent=$Lt}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalSTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(40,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector4",5)])}]),$Lr}(),$LUr=function(){function $Lr($Lr,$Li,$Lt){this._position=null,this._normal=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._tangent=$Lt}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(36,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector3",5)])}]),$Lr}(),$Lkr=function(){function $Lr($Lr,$Li,$Lt){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate=$Lt}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTexture");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(32,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2)])}]),$Lr}(),$Ler=function(){function $Lr($Lr,$Li,$Lt,$L_){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate0=$Lt,this._textureCoordinate1=$L_}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(40,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2),new $LEr(32,"vector2",15)])}]),$Lr}(),$LLr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate0=$Lt,this._textureCoordinate1=$L_,this._blendIndex=$LA,this._blendWeight=$Lf}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(72,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2),new $LEr(32,"vector2",15),new $LEr(40,"vector4",7),new $LEr(56,"vector4",6)])}]),$Lr}(),$LQr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate0=$Lt,this._textureCoordinate1=$L_,this._tangent=$LA,this._blendIndex=$Lf,this._blendWeight=$LE}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(88,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2),new $LEr(32,"vector2",15),new $LEr(40,"vector4",7),new $LEr(56,"vector4",6),new $LEr(72,"vector4",5)])}]),$Lr}(),$LFr=function(){function $Lr(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$Li.VertexPositionNormalTexture0SkinTangent=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){this._position=$Lr,this._normal=$Li,this._textureCoordinate0=$Lt,this._textureCoordinate1=$L_,this._tangent=$LA,this._blendIndex=$Lf,this._blendWeight=$LE},$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(84,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2),new $LEr(32,"vector2",15),new $LEr(40,"vector4",7),new $LEr(56,"vector4",6),new $LEr(72,"vector3",5)])}]),$Lr}(),$Lbr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate0=$Lt,this._textureCoordinate1=$L_,this._tangent=$LA}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(56,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2),new $LEr(32,"vector2",15),new $LEr(40,"vector4",5)])}]),$Lr}(),$LVr=function(){function $Lr(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$Li.VertexPositionNormalTexture0Tangent=function($Lr,$Li,$Lt,$L_,$LA){this._position=$Lr,this._normal=$Li,this._textureCoordinate0=$Lt,this._textureCoordinate1=$L_,this._tangent=$LA},$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(52,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2),new $LEr(32,"vector2",15),new $LEr(40,"vector3",5)])}]),$Lr}(),$Lhr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate=$Lt,this._blendIndex=$L_,this._blendWeight=$LA}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTextureSkin");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(64,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2),new $LEr(32,"vector4",7),new $LEr(48,"vector4",6)])}]),$Lr}(),$LPr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate=$Lt,this._tangent=$L_,this._blendIndex=$LA,this._blendWeight=$Lf}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(80,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2),new $LEr(32,"vector4",7),new $LEr(48,"vector4",6),new $LEr(64,"vector4",5)])}]),$Lr}(),$Lqr=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate=$Lt,this._tangent=$L_,this._blendIndex=$LA,this._blendWeight=$Lf}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(76,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2),new $LEr(32,"vector4",7),new $LEr(48,"vector4",6),new $LEr(64,"vector3",5)])}]),$Lr}(),$Lmr=function(){function $Lr($Lr,$Li,$Lt,$L_){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate=$Lt,this._tangent=$L_}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(48,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2),new $LEr(32,"vector4",5)])}]),$Lr}(),$LTr=function(){function $Lr($Lr,$Li,$Lt,$L_){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate=$Lt,this._tangent=$L_}$Lv($Lr,"laya.d3.graphics.VertexPositionNormalTextureTangent");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(44,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2),new $LEr(32,"vector3",5)])}]),$Lr}(),$Lxr=function(){function $Lr($Lr,$Li,$Lt){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate=$Lt}$Lv($Lr,"laya.d3.graphics.VertexPositionNTBTexture");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(56,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector3",5),new $LEr(36,"vector3",4),new $LEr(48,"vector2",2)])}]),$Lr}(),$L$r=function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate0=$L_,this._textureCoordinate1=$LA,this._tangent=$Lf,$Lt=$Lt,this._blendIndex=$LE,this._blendWeight=$LG}$Lv($Lr,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"tangent",function(){return this._tangent}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(0,$Li,"textureCoordinate1",function(){return this._textureCoordinate1}),$LO(0,$Li,"blendIndex",function(){return this._blendIndex}),$LO(0,$Li,"blendWeight",function(){return this._blendWeight}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(96,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector3",5),new $LEr(36,"vector3",4),new $LEr(48,"vector2",2),new $LEr(56,"vector2",15),new $LEr(64,"vector4",7),new $LEr(80,"vector4",6)])}]),$Lr}(),$Lor=function(){function $Lr($Lr,$Li,$Lt){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$Lr,this._normal=$Li,this._textureCoordinate=$Lt}$Lv($Lr,"laya.d3.graphics.VertexPositionNTBTextureSkin");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"textureCoordinate",function(){return this._textureCoordinate}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(88,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector3",5),new $LEr(36,"vector3",4),new $LEr(48,"vector2",2),new $LEr(56,"vector4",7),new $LEr(72,"vector4",6)])}]),$Lr}(),$LIr=(function(){function $Lr($Lr,$Li,$Lt,$L_){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=$Lr,this._normal=$Li,this._textureCoord0=$Lt,this._textureCoord1=$L_}$Lv($Lr,"laya.d3.graphics.VertexPositionTerrain");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"normal",function(){return this._normal}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"textureCoord0",function(){return this._textureCoord0}),$LO(0,$Li,"textureCoord1",function(){return this._textureCoord1}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(40,[new $LEr(0,"vector3",0),new $LEr(12,"vector3",3),new $LEr(24,"vector2",2),new $LEr(32,"vector2",15)])}])}(),function(){function $Lr($Lr,$Li){this._position=null,this._textureCoordinate0=null,this._position=$Lr,this._textureCoordinate0=$Li}$Lv($Lr,"laya.d3.graphics.VertexPositionTexture0");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"position",function(){return this._position}),$LO(0,$Li,"textureCoordinate0",function(){return this._textureCoordinate0}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(20,[new $LEr(0,"vector3",0),new $LEr(12,"vector2",2)])}]),$Lr}()),$Lzr=(function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LR,$LX,$Lv){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$Lr,this._positionStartLifeTime=$Li,this._velocity=$Lt,this._startColor=$L_,this._startSize=$LA,this._startRotation0=$Lf,this._startRotation1=$LE,this._startRotation2=$LG,this._startLifeTime=$LN,this._time=$Lp,this._startSpeed=$Lg,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$Lv}$Lv($Lr,"laya.d3.graphics.VertexShurikenParticleBillboard");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$LO(0,$Li,"random1",function(){return this._randoms1}),$LO(0,$Li,"startRotation2",function(){return this._startRotation2}),$LO(0,$Li,"positionStartLifeTime",function(){return this._positionStartLifeTime}),$LO(0,$Li,"velocity",function(){return this._velocity}),$LO(0,$Li,"random0",function(){return this._randoms0}),$LO(0,$Li,"startSize",function(){return this._startSize}),$LO(0,$Li,"startColor",function(){return this._startColor}),$LO(0,$Li,"startRotation0",function(){return this._startRotation0}),$LO(0,$Li,"startRotation1",function(){return this._startRotation1}),$LO(0,$Li,"startLifeTime",function(){return this._startLifeTime}),$LO(0,$Li,"time",function(){return this._time}),$LO(0,$Li,"startSpeed",function(){return this._startSpeed}),$LO(0,$Li,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(152,[new $LEr(0,"vector4",17),new $LEr(16,"vector4",30),new $LEr(32,"vector4",32),new $LEr(48,"vector4",19),new $LEr(64,"vector3",20),new $LEr(76,"vector3",22),new $LEr(88,"single",31),new $LEr(92,"vector4",34),new $LEr(108,"vector4",35),new $LEr(124,"vector3",36),new $LEr(136,"vector4",37)])}])}(),function(){function $Lr($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LR,$LX,$Lv){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$Lr,this._positionStartLifeTime=$Li,this._velocity=$Lt,this._startColor=$L_,this._startSize=$LA,this._startRotation0=$Lf,this._startRotation1=$LE,this._startRotation2=$LG,this._startLifeTime=$LN,this._time=$Lp,this._startSpeed=$Lg,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$Lv}$Lv($Lr,"laya.d3.graphics.VertexShurikenParticleMesh");var $Li=$Lr.prototype;$LD.imps($Li,{"laya.d3.graphics.IVertex":!0}),$LO(0,$Li,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$LO(0,$Li,"velocity",function(){return this._velocity}),$LO(0,$Li,"position",function(){return this._positionStartLifeTime}),$LO(0,$Li,"random0",function(){return this._randoms0}),$LO(0,$Li,"startSize",function(){return this._startSize}),$LO(0,$Li,"startColor",function(){return this._startColor}),$LO(0,$Li,"startRotation0",function(){return this._startRotation0}),$LO(0,$Li,"startRotation1",function(){return this._startRotation1}),$LO(0,$Li,"random1",function(){return this._randoms1}),$LO(0,$Li,"startRotation2",function(){return this._startRotation2}),$LO(0,$Li,"startLifeTime",function(){return this._startLifeTime}),$LO(0,$Li,"time",function(){return this._time}),$LO(0,$Li,"startSpeed",function(){return this._startSpeed}),$LO(0,$Li,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$LO(0,$Li,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LO(1,$Lr,"vertexDeclaration",function(){return $Lr._vertexDeclaration}),$LR($Lr,["_vertexDeclaration",function(){return this._vertexDeclaration=new $Lfr(172,[new $LEr(0,"vector3",0),new $LEr(12,"vector4",1),new $LEr(28,"vector2",2),new $LEr(36,"vector4",30),new $LEr(52,"vector4",32),new $LEr(68,"vector4",19),new $LEr(84,"vector3",20),new $LEr(96,"vector3",22),new $LEr(108,"single",31),new $LEr(112,"vector4",34),new $LEr(128,"vector4",35),new $LEr(144,"vector3",36),new $LEr(156,"vector4",37)])}])}(),function(){function $Ln($Lr,$Li,$Lt,$L_,$LA,$Lf){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=$Lt,this._materials=$L_,this._subMeshes=$LA,this._materialMap=$Lf,this._version=$Li,this._onLoaded($Lr)}$Lv($Ln,"laya.d3.loaders.LoadModelV01");var $Lr=$Ln.prototype;return $Lr._onLoaded=function($Lr){this._readData=$Lr,this.READ_BLOCK();for(var $Li=0;$Li<this._BLOCK.count;$Li++){var $Lt=this._readData.getUint16(),$L_=this._strings[$Lt],$LA=this["READ_"+$L_];if(null==$LA)throw new Error("model file err,no this function:"+$Lt+" "+$L_);if(!$LA.call(this))break}return this._mesh},$Lr.onError=function(){},$Lr._readString=function(){return this._strings[this._readData.getUint16()]},$Lr.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},$Lr.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},$Lr.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var $Lr=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var $Li=0;$Li<this._STRINGS.size;$Li++)this._strings[$Li]=this._readData.readUTFString();return this._readData.pos=$Lr,!0},$Lr.READ_MATERIAL=function(){var $Lr=this._readData.getUint16(),$Li=(this._readString(),this._readString());return this._materials[$Lr]="null"!==$Li?$Ly.getRes(this._materialMap[$Li]):new $LUi,!0},$Lr.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var $Lr,$Li=this._readData.__getBuffer(),$Lt=0,$L_=this._readData.getUint32(),$LA=this._readData.getUint32(),$Lf=(new Float32Array($Li.slice($L_+this._DATA.offset,$L_+this._DATA.offset+$LA)),this._readData.getUint32()),$LE=this._readData.getUint32(),$LG=new Float32Array($Li.slice($Lf+this._DATA.offset,$Lf+this._DATA.offset+$LE));for(this.mesh._inverseBindPoses=[],$Lt=0,$Lr=$LG.length;$Lt<$Lr;$Lt+=16){var $LN=new $Lri($LG[$Lt+0],$LG[$Lt+1],$LG[$Lt+2],$LG[$Lt+3],$LG[$Lt+4],$LG[$Lt+5],$LG[$Lt+6],$LG[$Lt+7],$LG[$Lt+8],$LG[$Lt+9],$LG[$Lt+10],$LG[$Lt+11],$LG[$Lt+12],$LG[$Lt+13],$LG[$Lt+14],$LG[$Lt+15]);this.mesh._inverseBindPoses.push($LN)}break;default:throw new Error("LoadModel:unknown version.")}return!0},$Lr.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var $Lr=this._readString();this._shaderAttributes=$Lr.match($Ln._attrReg);var $Li=this._readData.getUint32(),$Lt=this._readData.getUint32(),$L_=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),$LA=this._readData.getUint32(),$Lf=this._readData.getUint32(),$LE=this._readData.getUint32(),$LG=this._readData.__getBuffer(),$LN=new $Lpi(this._mesh),$Lp=this._getVertexDeclaration(),$Lg=$Lqi.create($Lp,$LA/$Lp.vertexStride,35044,!0),$LR=$L_+this._DATA.offset,$LX=$LG.slice($LR,$LR+$LA);$Lg.setData(new Float32Array($LX));for(var $Lv=($LN._vertexBuffer=$Lg).vertexDeclaration.getVertexElements(),$LO=0;$LO<$Lv.length;$LO++)$LN._bufferUsage[$Lv[$LO].elementUsage]=$Lg;var $Lc=$LPi.create("ushort",$Lt/2,35044,!0),$LB=$Li+this._DATA.offset,$Ly=$LG.slice($LB,$LB+$Lt);$Lc.setData(new Uint16Array($Ly)),$LN._indexBuffer=$Lc;var $LC=$LG.slice($Lf+this._DATA.offset,$Lf+this._DATA.offset+$LE);return $LN._boneIndicesList[0]=new Uint8Array($LC),this._subMeshes.push($LN),!0},$Lr.READ_DATAAREA=function(){return!1},$Lr._getVertexDeclaration=function(){for(var $Lr,$Li=!1,$Lt=!1,$L_=!1,$LA=!1,$Lf=!1,$LE=!1,$LG=!1,$LN=!1,$Lp=!1,$Lg=0;$Lg<this._shaderAttributes.length;$Lg+=8)switch(this._shaderAttributes[$Lg]){case"POSITION":$Li=!0;break;case"NORMAL":$Lt=!0;break;case"COLOR":$L_=!0;break;case"UV":$LA=!0;break;case"UV1":$Lf=!0;break;case"BLENDWEIGHT":$LG=!0;break;case"BLENDINDICES":$LN=!0;break;case"TANGENT":$LE=!0;break;case"BINORMAL":$Lp=!0}return $Li&&$Lt&&$L_&&$LA&&$Lf&&$LG&&$LN&&$LE?$Lr=$Lnr.vertexDeclaration:$Li&&$Lt&&$L_&&$LA&&$Lf&&$LG&&$LN?$Lr=$Lyr.vertexDeclaration:$Li&&$Lt&&$LA&&$Lf&&$LG&&$LN&&$LE?$Lr=$LFr.vertexDeclaration:$Li&&$Lt&&$LA&&$Lf&&$LG&&$LN?$Lr=$LLr.vertexDeclaration:$Li&&$Lt&&$L_&&$LA&&$LG&&$LN&&$LE?$Lr=$LHr.vertexDeclaration:$Li&&$Lt&&$L_&&$LA&&$LG&&$LN?$Lr=$Lur.vertexDeclaration:$Li&&$Lt&&$LE&&$Lp&&$LA&&$LG&&$LN?$Lr=$Lor.vertexDeclaration:$Li&&$Lt&&$LA&&$LG&&$LN&&$LE?$Lr=$Lqr.vertexDeclaration:$Li&&$Lt&&$LA&&$LG&&$LN?$Lr=$Lhr.vertexDeclaration:$Li&&$Lt&&$L_&&$LG&&$LN&&$LE?$Lr=$LXr.vertexDeclaration:$Li&&$Lt&&$L_&&$LG&&$LN?$Lr=$Lgr.vertexDeclaration:$Li&&$Lt&&$L_&&$LA&&$Lf&&$LE?$Lr=$LDr.vertexDeclaration:$Li&&$Lt&&$L_&&$LA&&$Lf?$Lr=$LBr.vertexDeclaration:$Li&&$Lt&&$LA&&$Lf&&$LE?$Lr=$LVr.vertexDeclaration:$Li&&$Lt&&$LA&&$Lf?$Lr=$Ler.vertexDeclaration:$Li&&$Lt&&$L_&&$LA&&$LE?$Lr=$Ldr.vertexDeclaration:$Li&&$Lt&&$LA&&$LE&&$Lp?$Lr=$Lxr.vertexDeclaration:$Li&&$Lt&&$L_&&$LA?$Lr=$Lcr.vertexDeclaration:$Li&&$Lt&&$LA&&$LE?$Lr=$LTr.vertexDeclaration:$Li&&$Lt&&$LA?$Lr=$Lkr.vertexDeclaration:$Li&&$Lt&&$L_&&$LE?$Lr=$LOr.vertexDeclaration:$Li&&$Lt&&$L_&&($Lr=$Lpr.vertexDeclaration),$Lr},$LO(0,$Lr,"mesh",function(){return this._mesh}),$Ln._attrReg=new RegExp("(\\w+)|([:,;])","g"),$Ln}()),$LJr=function(){function $Lw(){}return $Lv($Lw,"laya.d3.loaders.LoadModelV02"),$Lw.parse=function($Lr,$Li,$Lt,$L_,$LA,$Lf){$Lw._mesh=$Lt,$Lw._materials=$L_,$Lw._subMeshes=$LA,$Lw._materialMap=$Lf,$Lw._version=$Li,$Lw._readData=$Lr,$Lw.READ_DATA(),$Lw.READ_BLOCK(),$Lw.READ_STRINGS();for(var $LE=0,$LG=$Lw._BLOCK.count;$LE<$LG;$LE++){$Lw._readData.pos=$Lw._BLOCK.blockStarts[$LE];var $LN=$Lw._readData.getUint16(),$Lp=$Lw._strings[$LN],$Lg=$Lw["READ_"+$Lp];if(null==$Lg)throw new Error("model file err,no this function:"+$LN+" "+$Lp);$Lg.call()}$Lw._strings.length=0,$Lw._readData=null,$Lw._version=null,$Lw._mesh=null,$Lw._materials=null,$Lw._subMeshes=null,$Lw._materialMap=null},$Lw._readString=function(){return $Lw._strings[$Lw._readData.getUint16()]},$Lw.READ_DATA=function(){$Lw._DATA.offset=$Lw._readData.getUint32(),$Lw._DATA.size=$Lw._readData.getUint32()},$Lw.READ_BLOCK=function(){for(var $Lr=$Lw._BLOCK.count=$Lw._readData.getUint16(),$Li=$Lw._BLOCK.blockStarts=[],$Lt=$Lw._BLOCK.blockLengths=[],$L_=0;$L_<$Lr;$L_++)$Li.push($Lw._readData.getUint32()),$Lt.push($Lw._readData.getUint32())},$Lw.READ_STRINGS=function(){var $Lr=$Lw._readData.getUint32(),$Li=$Lw._readData.getUint16(),$Lt=$Lw._readData.pos;$Lw._readData.pos=$Lr+$Lw._DATA.offset;for(var $L_=0;$L_<$Li;$L_++)$Lw._strings[$L_]=$Lw._readData.readUTFString();$Lw._readData.pos=$Lt},$Lw.READ_MATERIAL=function(){$Lw._readString(),$Lw._readString();var $Lr=$Lw._readString();return""!==$Lr&&$Lw._materials.push($Ly.getRes($Lw._materialMap[$Lr])),!0},$Lw.READ_MESH=function(){$Lw._readString();var $Lr,$Li=$Lw._readData.__getBuffer(),$Lt=0,$L_=$Lw._readData.getInt16(),$LA=$Lw._DATA.offset;for($Lt=0;$Lt<$L_;$Lt++){var $Lf=$LA+$Lw._readData.getUint32(),$LE=$Lw._readData.getUint32(),$LG=new Float32Array($Li.slice($Lf,$Lf+$LE)),$LN=$Lw._readString().match($Lw._attrReg),$Lp=$Lw._getVertexDeclaration($LN),$Lg=$Lqi.create($Lp,4*$LG.length/$Lp.vertexStride,35044,!0);$Lg.setData($LG),$Lw._mesh._vertexBuffers.push($Lg)}var $LR=$LA+$Lw._readData.getUint32(),$LX=$Lw._readData.getUint32(),$Lv=new Uint16Array($Li.slice($LR,$LR+$LX)),$LO=$LPi.create("ushort",$LX/2,35044,!0);$LO.setData($Lv),$Lw._mesh._indexBuffer=$LO;var $Lc=$Lw._mesh._boneNames=[],$LB=$Lw._readData.getUint16();for($Lc.length=$LB,$Lt=0;$Lt<$LB;$Lt++)$Lc[$Lt]=$Lw._strings[$Lw._readData.getUint16()];var $Ly=$Lw._readData.getUint32(),$LC=$Lw._readData.getUint32(),$Ln=(new Float32Array($Li.slice($LA+$Ly,$LA+$Ly+$LC)),$Lw._readData.getUint32()),$La=$Lw._readData.getUint32(),$LD=new Float32Array($Li.slice($LA+$Ln,$LA+$Ln+$La));for($Lw._mesh._inverseBindPoses=[],$Lt=0,$Lr=$LD.length;$Lt<$Lr;$Lt+=16){var $Lu=new $Lri($LD[$Lt+0],$LD[$Lt+1],$LD[$Lt+2],$LD[$Lt+3],$LD[$Lt+4],$LD[$Lt+5],$LD[$Lt+6],$LD[$Lt+7],$LD[$Lt+8],$LD[$Lt+9],$LD[$Lt+10],$LD[$Lt+11],$LD[$Lt+12],$LD[$Lt+13],$LD[$Lt+14],$LD[$Lt+15]);$Lw._mesh._inverseBindPoses.push($Lu)}return $Lw._mesh._skinnedDatas=new Float32Array(16*$LD.length),!0},$Lw.READ_SUBMESH=function(){var $Lr=$Lw._readData.__getBuffer(),$Li=new $Lpi($Lw._mesh),$Lt=$Lw._readData.getInt16(),$L_=$Lw._readData.getUint32(),$LA=$Lw._readData.getUint32();$Li._vertexBuffer=$Lw._mesh._vertexBuffers[$Lt],$Li._vertexStart=$L_,$Li._vertexCount=$LA;var $Lf=$Lw._readData.getUint32(),$LE=$Lw._readData.getUint32(),$LG=$Lw._mesh._indexBuffer;$Li._indexBuffer=$LG,$Li._indexStart=$Lf,$Li._indexCount=$LE,$Li._indices=new Uint16Array($LG.getData().buffer,2*$Lf,$LE);var $LN=$Lw._DATA.offset,$Lp=$Li._subIndexBufferStart,$Lg=$Li._subIndexBufferCount,$LR=$Li._boneIndicesList,$LX=$Lw._readData.getUint16();$Lp.length=$LX,$Lg.length=$LX,$LR.length=$LX;for(var $Lv=0;$Lv<$LX;$Lv++){$Lp[$Lv]=$Lw._readData.getUint32(),$Lg[$Lv]=$Lw._readData.getUint32();var $LO=$Lw._readData.getUint32(),$Lc=$Lw._readData.getUint32();$Li._boneIndicesList[$Lv]=new Uint8Array($Lr.slice($LN+$LO,$LN+$LO+$Lc))}return $Lw._subMeshes.push($Li),!0},$Lw._getVertexDeclaration=function($Lr){for(var $Li,$Lt=!1,$L_=!1,$LA=!1,$Lf=!1,$LE=!1,$LG=!1,$LN=!1,$Lp=!1,$Lg=!1,$LR=0;$LR<$Lr.length;$LR++)switch($Lr[$LR]){case"POSITION":$Lt=!0;break;case"NORMAL":$L_=!0;break;case"COLOR":$LA=!0;break;case"UV":$Lf=!0;break;case"UV1":$LE=!0;break;case"BLENDWEIGHT":$LN=!0;break;case"BLENDINDICES":$Lp=!0;break;case"TANGENT":$LG=!0;break;case"BINORMAL":$Lg=!0}return $Lt&&$L_&&$LA&&$Lf&&$LE&&$LN&&$Lp&&$LG?$Li=$Lnr.vertexDeclaration:$Lt&&$L_&&$LA&&$Lf&&$LE&&$LN&&$Lp?$Li=$Lyr.vertexDeclaration:$Lt&&$L_&&$Lf&&$LE&&$LN&&$Lp&&$LG?$Li=$LFr.vertexDeclaration:$Lt&&$L_&&$Lf&&$LE&&$LN&&$Lp?$Li=$LLr.vertexDeclaration:$Lt&&$L_&&$LA&&$Lf&&$LN&&$Lp&&$LG?$Li=$LHr.vertexDeclaration:$Lt&&$L_&&$LA&&$Lf&&$LN&&$Lp?$Li=$Lur.vertexDeclaration:$Lt&&$L_&&$Lf&&$LN&&$Lp&&$LG?$Li=$Lqr.vertexDeclaration:$Lt&&$L_&&$Lf&&$LN&&$Lp?$Li=$Lhr.vertexDeclaration:$Lt&&$L_&&$LA&&$LN&&$Lp&&$LG?$Li=$LXr.vertexDeclaration:$Lt&&$L_&&$LA&&$LN&&$Lp?$Li=$Lgr.vertexDeclaration:$Lt&&$L_&&$LA&&$Lf&&$LE&&$LG?$Li=$LDr.vertexDeclaration:$Lt&&$L_&&$LA&&$Lf&&$LE?$Li=$LBr.vertexDeclaration:$Lt&&$L_&&$Lf&&$LE&&$LG?$Li=$LVr.vertexDeclaration:$Lt&&$L_&&$Lf&&$LE?$Li=$Ler.vertexDeclaration:$Lt&&$L_&&$LA&&$Lf&&$LG?$Li=$Ldr.vertexDeclaration:$Lt&&$L_&&$Lf&&$LG&&$Lg?$Li=$Lxr.vertexDeclaration:$Lt&&$L_&&$LA&&$Lf?$Li=$Lcr.vertexDeclaration:$Lt&&$L_&&$Lf&&$LG?$Li=$LTr.vertexDeclaration:$Lt&&$L_&&$Lf?$Li=$Lkr.vertexDeclaration:$Lt&&$L_&&$LA&&$LG?$Li=$LOr.vertexDeclaration:$Lt&&$L_&&$LA&&($Li=$Lpr.vertexDeclaration),$Li},$Lw._attrReg=new RegExp("(\\w+)|([:,;])","g"),$Lw._strings=[],$Lw._readData=null,$Lw._version=null,$Lw._mesh=null,$Lw._materials=null,$Lw._subMeshes=null,$Lw._materialMap=null,$LR($Lw,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$Lw}(),$LZr=function(){function $Lu(){}return $Lv($Lu,"laya.d3.loaders.LoadModelV03"),$Lu.parse=function($Lr,$Li,$Lt,$L_,$LA){$Lu._mesh=$Lt,$Lu._subMeshes=$L_,$Lu._materialMap=$LA,$Lu._version=$Li,$Lu._readData=$Lr,$Lu.READ_DATA(),$Lu.READ_BLOCK(),$Lu.READ_STRINGS();for(var $Lf=0,$LE=$Lu._BLOCK.count;$Lf<$LE;$Lf++){$Lu._readData.pos=$Lu._BLOCK.blockStarts[$Lf];var $LG=$Lu._readData.getUint16(),$LN=$Lu._strings[$LG],$Lp=$Lu["READ_"+$LN];if(null==$Lp)throw new Error("model file err,no this function:"+$LG+" "+$LN);$Lp.call()}$Lu._strings.length=0,$Lu._readData=null,$Lu._version=null,$Lu._mesh=null,$Lu._subMeshes=null,$Lu._materialMap=null},$Lu._readString=function(){return $Lu._strings[$Lu._readData.getUint16()]},$Lu.READ_DATA=function(){$Lu._DATA.offset=$Lu._readData.getUint32(),$Lu._DATA.size=$Lu._readData.getUint32()},$Lu.READ_BLOCK=function(){for(var $Lr=$Lu._BLOCK.count=$Lu._readData.getUint16(),$Li=$Lu._BLOCK.blockStarts=[],$Lt=$Lu._BLOCK.blockLengths=[],$L_=0;$L_<$Lr;$L_++)$Li.push($Lu._readData.getUint32()),$Lt.push($Lu._readData.getUint32())},$Lu.READ_STRINGS=function(){var $Lr=$Lu._readData.getUint32(),$Li=$Lu._readData.getUint16(),$Lt=$Lu._readData.pos;$Lu._readData.pos=$Lr+$Lu._DATA.offset;for(var $L_=0;$L_<$Li;$L_++)$Lu._strings[$L_]=$Lu._readData.readUTFString();$Lu._readData.pos=$Lt},$Lu.READ_MESH=function(){var $Lr,$Li=$Lu._readString(),$Lt=$Lu._readData.__getBuffer(),$L_=0,$LA=$Lu._readData.getInt16(),$Lf=$Lu._DATA.offset;for($L_=0;$L_<$LA;$L_++){var $LE,$LG=$Lf+$Lu._readData.getUint32(),$LN=$Lu._readData.getUint32(),$Lp=new Float32Array($Lt.slice($LG,$LG+$LN)),$Lg=$Lu._readString();switch($Lu._version){case"LAYAMODEL:03":$LE=$Lu._vertexDeclarationMap_Discard[$Lg];break;case"LAYAMODEL:0301":$LE=$Lu._vertexDeclarationMap[$Lg];break;default:throw new Error("LoadModelV03: unknown version.")}if(!$LE)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+$Lu._version+"  bufferAttribute="+$Lg+"  name="+$Li+"  url="+($Lu._mesh?$Lu._mesh.url:"null"));var $LR=$Lqi.create($LE,4*$Lp.length/$LE.vertexStride,35044,!0,$Lu._mesh._url+"_"+$L_);$LR.setData($Lp),$Lu._mesh._vertexBuffers.push($LR)}var $LX=$Lf+$Lu._readData.getUint32(),$Lv=$Lu._readData.getUint32(),$LO=new Uint16Array($Lt.slice($LX,$LX+$Lv)),$Lc=$LPi.create("ushort",$Lv/2,35044,!0,$Lu._mesh._url);$Lc.setData($LO),$Lu._mesh._indexBuffer=$Lc;var $LB=$Lu._mesh._boneNames=[],$Ly=$Lu._readData.getUint16();for($LB.length=$Ly,$L_=0;$L_<$Ly;$L_++)$LB[$L_]=$Lu._strings[$Lu._readData.getUint16()];$Lu._readData.pos+=8;var $LC=$Lu._readData.getUint32(),$Ln=$Lu._readData.getUint32(),$La=new Float32Array($Lt.slice($Lf+$LC,$Lf+$LC+$Ln));for($Lu._mesh._inverseBindPoses=[],$L_=0,$Lr=$La.length;$L_<$Lr;$L_+=16){var $LD=new $Lri($La[$L_+0],$La[$L_+1],$La[$L_+2],$La[$L_+3],$La[$L_+4],$La[$L_+5],$La[$L_+6],$La[$L_+7],$La[$L_+8],$La[$L_+9],$La[$L_+10],$La[$L_+11],$La[$L_+12],$La[$L_+13],$La[$L_+14],$La[$L_+15]);$Lu._mesh._inverseBindPoses.push($LD)}return $Lu._mesh._skinnedDatas=new Float32Array(16*$La.length),!0},$Lu.READ_SUBMESH=function(){var $Lr=$Lu._readData.__getBuffer(),$Li=new $Lpi($Lu._mesh),$Lt=$Lu._readData.getInt16(),$L_=$Lu._readData.getUint32(),$LA=$Lu._readData.getUint32();$Li._vertexBuffer=$Lu._mesh._vertexBuffers[$Lt],$Li._vertexStart=$L_,$Li._vertexCount=$LA;var $Lf=$Lu._readData.getUint32(),$LE=$Lu._readData.getUint32(),$LG=$Lu._mesh._indexBuffer;$Li._indexBuffer=$LG,$Li._indexStart=$Lf,$Li._indexCount=$LE,$Li._indices=new Uint16Array($LG.getData().buffer,2*$Lf,$LE);var $LN=$Lu._DATA.offset,$Lp=$Li._subIndexBufferStart,$Lg=$Li._subIndexBufferCount,$LR=$Li._boneIndicesList,$LX=$Lu._readData.getUint16();$Lp.length=$LX,$Lg.length=$LX,$LR.length=$LX;for(var $Lv=0;$Lv<$LX;$Lv++){$Lp[$Lv]=$Lu._readData.getUint32(),$Lg[$Lv]=$Lu._readData.getUint32();var $LO=$Lu._readData.getUint32(),$Lc=$Lu._readData.getUint32();$LR[$Lv]=new Uint8Array($Lr.slice($LN+$LO,$LN+$LO+$Lc))}return $Lu._subMeshes.push($Li),!0},$Lu._strings=[],$Lu._readData=null,$Lu._version=null,$Lu._mesh=null,$Lu._subMeshes=null,$Lu._materialMap=null,$LR($Lu,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$Lnr.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$Lyr.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$L$r.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$LFr.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$LLr.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$LHr.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$Lur.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$Lqr.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$Lhr.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$LXr.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$Lgr.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$LDr.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$LBr.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$LVr.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$Ler.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$Ldr.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$Lxr.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$Lcr.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$LTr.vertexDeclaration,"POSITION,NORMAL,UV":$Lkr.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$LOr.vertexDeclaration,"POSITION,NORMAL,COLOR":$Lpr.vertexDeclaration,"POSITION,NORMAL,TANGENT":$LUr.vertexDeclaration,"POSITION,NORMAL":$LNr.vertexDeclaration,"POSITION,UV":$LIr.vertexDeclaration,POSITION:$LGr.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$LCr.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$Lyr.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$L$r.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$LQr.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$LLr.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$Lwr.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$Lur.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$LPr.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$Lhr.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$LRr.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$Lgr.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$Lar.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$LBr.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$Lbr.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$Ler.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$Lsr.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$Lxr.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$Lcr.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$Lmr.vertexDeclaration,"POSITION,NORMAL,UV":$Lkr.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$Lvr.vertexDeclaration,"POSITION,NORMAL,COLOR":$Lpr.vertexDeclaration,"POSITION,NORMAL,TANGENT":$Llr.vertexDeclaration,"POSITION,NORMAL":$LNr.vertexDeclaration,"POSITION,UV":$LIr.vertexDeclaration,POSITION:$LGr.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$Lu}(),$LWr=function(){function $LG(){}return $Lv($LG,"laya.d3.loaders.MeshReader"),$LG.read=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=new $Lu($Lr);$Lf.pos=0;var $LE=$Lf.readUTFString();switch($LE){case"LAYAMODEL:01":case"LAYASKINANI:01":$LG._readVersion01($Lf,$LE,$Li,$Lt,$L_,$LA);break;case"LAYAMODEL:02":$LJr.parse($Lf,$LE,$Li,$Lt,$L_,$LA);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":$LZr.parse($Lf,$LE,$Li,$L_,$LA);break;default:throw new Error("MeshReader: unknown mesh version.")}$Li._setSubMeshes($L_)},$LG._readVersion01=function($Lr,$Li,$Lt,$L_,$LA,$Lf){new $Lzr($Lr,$Li,$Lt,$L_,$LA,$Lf)},$LG}(),$LMr=function(){function $Lr($Lr,$Li){this.min=null,this.max=null,this.min=$Lr,this.max=$Li}$Lv($Lr,"laya.d3.math.BoundBox");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li.getCorners=function($Lr){$Lr.length=8;var $Li=this.min.elements,$Lt=this.max.elements,$L_=$Li[0],$LA=$Li[1],$Lf=$Li[2],$LE=$Lt[0],$LG=$Lt[1],$LN=$Lt[2];$Lr[0]=new $LEi($L_,$LG,$LN),$Lr[1]=new $LEi($LE,$LG,$LN),$Lr[2]=new $LEi($LE,$LA,$LN),$Lr[3]=new $LEi($L_,$LA,$LN),$Lr[4]=new $LEi($L_,$LG,$Lf),$Lr[5]=new $LEi($LE,$LG,$Lf),$Lr[6]=new $LEi($LE,$LA,$Lf),$Lr[7]=new $LEi($L_,$LA,$Lf)},$Li.toDefault=function(){this.min.toDefault(),this.max.toDefault()},$Li.cloneTo=function($Lr){var $Li=$Lr;this.min.cloneTo($Li.min),this.max.cloneTo($Li.max)},$Li.clone=function(){var $Lr=new this.constructor(new $LEi,new $LEi);return this.cloneTo($Lr),$Lr},$Lr.createfromPoints=function($Lr,$Li){if(null==$Lr)throw new Error("points");var $Lt=$Li.min,$L_=$Li.max,$LA=$Lt.elements;$LA[0]=Number.MAX_VALUE,$LA[1]=Number.MAX_VALUE,$LA[2]=Number.MAX_VALUE;var $Lf=$L_.elements;$Lf[0]=-Number.MAX_VALUE,$Lf[1]=-Number.MAX_VALUE,$Lf[2]=-Number.MAX_VALUE;for(var $LE=0,$LG=$Lr.length;$LE<$LG;++$LE)$LEi.min($Lt,$Lr[$LE],$Lt),$LEi.max($L_,$Lr[$LE],$L_)},$Lr.merge=function($Lr,$Li,$Lt){$LEi.min($Lr.min,$Li.min,$Lt.min),$LEi.max($Lr.max,$Li.max,$Lt.max)},$Lr}(),$LKr=function(){function $Lp($Lr){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=$Lr,this._near=new $Lii(new $LEi),this._far=new $Lii(new $LEi),this._left=new $Lii(new $LEi),this._right=new $Lii(new $LEi),this._top=new $Lii(new $LEi),this._bottom=new $Lii(new $LEi),$Lp._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}$Lv($Lp,"laya.d3.math.BoundFrustum");var $Lr=$Lp.prototype;return $Lr.equalsBoundFrustum=function($Lr){return this._matrix.equalsOtherMatrix($Lr.matrix)},$Lr.equalsObj=function($Lr){if($Lr instanceof laya.d3.math.BoundFrustum){var $Li=$Lr;return this.equalsBoundFrustum($Li)}return!1},$Lr.getPlane=function($Lr){switch($Lr){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},$Lr.getCorners=function($Lr){$Lp._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo($Lr[0]),$Lp._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo($Lr[1]),$Lp._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo($Lr[2]),$Lp._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo($Lr[3]),$Lp._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo($Lr[4]),$Lp._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo($Lr[5]),$Lp._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo($Lr[6]),$Lp._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo($Lr[7])},$Lr.containsPoint=function($Lr){for(var $Li=$Lii.PlaneIntersectionType_Front,$Lt=$Lii.PlaneIntersectionType_Front,$L_=0;$L_<6;$L_++){switch($L_){case 0:$Lt=Collision.intersectsPlaneAndPoint(this._near,$Lr);break;case 1:$Lt=Collision.intersectsPlaneAndPoint(this._far,$Lr);break;case 2:$Lt=Collision.intersectsPlaneAndPoint(this._left,$Lr);break;case 3:$Lt=Collision.intersectsPlaneAndPoint(this._right,$Lr);break;case 4:$Lt=Collision.intersectsPlaneAndPoint(this._top,$Lr);break;case 5:$Lt=Collision.intersectsPlaneAndPoint(this._bottom,$Lr)}switch($Lt){case $Lii.PlaneIntersectionType_Back:return 0;case $Lii.PlaneIntersectionType_Intersecting:$Li=$Lii.PlaneIntersectionType_Intersecting}}switch($Li){case $Lii.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$Lr.containsBoundBox=function($Lr){for(var $Li,$Lt=$Lp._tempV30,$L_=$Lp._tempV31,$LA=1,$Lf=0;$Lf<6;$Lf++){if($Li=this.getPlane($Lf),this._getBoxToPlanePVertexNVertex($Lr,$Li.normal,$Lt,$L_),Collision.intersectsPlaneAndPoint($Li,$Lt)===$Lii.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint($Li,$L_)===$Lii.PlaneIntersectionType_Back&&($LA=2)}return $LA},$Lr.containsBoundSphere=function($Lr){for(var $Li=$Lii.PlaneIntersectionType_Front,$Lt=$Lii.PlaneIntersectionType_Front,$L_=0;$L_<6;$L_++){switch($L_){case 0:$Lt=Collision.intersectsPlaneAndSphere(this._near,$Lr);break;case 1:$Lt=Collision.intersectsPlaneAndSphere(this._far,$Lr);break;case 2:$Lt=Collision.intersectsPlaneAndSphere(this._left,$Lr);break;case 3:$Lt=Collision.intersectsPlaneAndSphere(this._right,$Lr);break;case 4:$Lt=Collision.intersectsPlaneAndSphere(this._top,$Lr);break;case 5:$Lt=Collision.intersectsPlaneAndSphere(this._bottom,$Lr)}switch($Lt){case $Lii.PlaneIntersectionType_Back:return 0;case $Lii.PlaneIntersectionType_Intersecting:$Li=$Lii.PlaneIntersectionType_Intersecting}}switch($Li){case $Lii.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$Lr._getBoxToPlanePVertexNVertex=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.min,$Lf=$LA.elements,$LE=$Lr.max,$LG=$LE.elements,$LN=$Li.elements,$Lp=$LN[0],$Lg=$LN[1],$LR=$LN[2];$LA.cloneTo($Lt);var $LX=$Lt.elements;0<=$Lp&&($LX[0]=$LG[0]),0<=$Lg&&($LX[1]=$LG[1]),0<=$LR&&($LX[2]=$LG[2]),$LE.cloneTo($L_);var $Lv=$L_.elements;0<=$Lp&&($Lv[0]=$Lf[0]),0<=$Lg&&($Lv[1]=$Lf[1]),0<=$LR&&($Lv[2]=$Lf[2])},$LO(0,$Lr,"top",function(){return this._top}),$LO(0,$Lr,"matrix",function(){return this._matrix},function($Lr){this._matrix=$Lr,$Lp._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),$LO(0,$Lr,"near",function(){return this._near}),$LO(0,$Lr,"far",function(){return this._far}),$LO(0,$Lr,"left",function(){return this._left}),$LO(0,$Lr,"right",function(){return this._right}),$LO(0,$Lr,"bottom",function(){return this._bottom}),$Lp._getPlanesFromMatrix=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){var $LG=$Lr.elements,$LN=$LG[0],$Lp=$LG[1],$Lg=$LG[2],$LR=$LG[3],$LX=$LG[4],$Lv=$LG[5],$LO=$LG[6],$Lc=$LG[7],$LB=$LG[8],$Ly=$LG[9],$LC=$LG[10],$Ln=$LG[11],$La=$LG[12],$LD=$LG[13],$Lu=$LG[14],$Lw=$LG[15],$LH=$Li.normal.elements;$LH[0]=$LR+$Lg,$LH[1]=$Lc+$LO,$LH[2]=$Ln+$LC,$Li.distance=$Lw+$Lu,$Li.normalize();var $Ls=$Lt.normal.elements;$Ls[0]=$LR-$Lg,$Ls[1]=$Lc-$LO,$Ls[2]=$Ln-$LC,$Lt.distance=$Lw-$Lu,$Lt.normalize();var $Ld=$L_.normal.elements;$Ld[0]=$LR+$LN,$Ld[1]=$Lc+$LX,$Ld[2]=$Ln+$LB,$L_.distance=$Lw+$La,$L_.normalize();var $Ll=$LA.normal.elements;$Ll[0]=$LR-$LN,$Ll[1]=$Lc-$LX,$Ll[2]=$Ln-$LB,$LA.distance=$Lw-$La,$LA.normalize();var $LU=$Lf.normal.elements;$LU[0]=$LR-$Lp,$LU[1]=$Lc-$Lv,$LU[2]=$Ln-$Ly,$Lf.distance=$Lw-$LD,$Lf.normalize();var $Lk=$LE.normal.elements;$Lk[0]=$LR+$Lp,$Lk[1]=$Lc+$Lv,$Lk[2]=$Ln+$Ly,$LE.distance=$Lw+$LD,$LE.normalize()},$Lp._get3PlaneInterPoint=function($Lr,$Li,$Lt){var $L_=$Lr.normal,$LA=$Li.normal,$Lf=$Lt.normal;$LEi.cross($LA,$Lf,$Lp._tempV30),$LEi.cross($Lf,$L_,$Lp._tempV31),$LEi.cross($L_,$LA,$Lp._tempV32);var $LE=$LEi.dot($L_,$Lp._tempV30),$LG=$LEi.dot($LA,$Lp._tempV31),$LN=$LEi.dot($Lf,$Lp._tempV32);return $LEi.scale($Lp._tempV30,-$Lr.distance/$LE,$Lp._tempV33),$LEi.scale($Lp._tempV31,-$Li.distance/$LG,$Lp._tempV34),$LEi.scale($Lp._tempV32,-$Lt.distance/$LN,$Lp._tempV35),$LEi.add($Lp._tempV33,$Lp._tempV34,$Lp._tempV36),$LEi.add($Lp._tempV35,$Lp._tempV36,$Lp._tempV37),$Lp._tempV37},$LR($Lp,["_tempV30",function(){return this._tempV30=new $LEi},"_tempV31",function(){return this._tempV31=new $LEi},"_tempV32",function(){return this._tempV32=new $LEi},"_tempV33",function(){return this._tempV33=new $LEi},"_tempV34",function(){return this._tempV34=new $LEi},"_tempV35",function(){return this._tempV35=new $LEi},"_tempV36",function(){return this._tempV36=new $LEi},"_tempV37",function(){return this._tempV37=new $LEi}]),$Lp}(),$LSr=function(){function $Lg($Lr,$Li){this.center=null,this.radius=NaN,this.center=$Lr,this.radius=$Li}$Lv($Lg,"laya.d3.math.BoundSphere");var $Lr=$Lg.prototype;return $LD.imps($Lr,{"laya.d3.core.IClone":!0}),$Lr.toDefault=function(){this.center.toDefault(),this.radius=0},$Lr.intersectsRayDistance=function($Lr){return Collision.intersectsRayAndSphereRD($Lr,this)},$Lr.intersectsRayPoint=function($Lr,$Li){return Collision.intersectsRayAndSphereRP($Lr,this,$Li)},$Lr.cloneTo=function($Lr){var $Li=$Lr;this.center.cloneTo($Li.center),$Li.radius=this.radius},$Lr.clone=function(){var $Lr=new this.constructor(new $LEi,new $LEi);return this.cloneTo($Lr),$Lr},$Lg.createFromSubPoints=function($Lr,$Li,$Lt,$L_){if(null==$Lr)throw new Error("points");if($Li<0||$Li>=$Lr.length)throw new Error("start"+$Li+"Must be in the range [0, "+($Lr.length-1)+"]");if($Lt<0||$Li+$Lt>$Lr.length)throw new Error("count"+$Lt+"Must be in the range <= "+$Lr.length+"}");var $LA=$Li+$Lt,$Lf=$Lg._tempVector3;$Lf.elements[0]=0,$Lf.elements[1]=0,$Lf.elements[2]=0;for(var $LE=$Li;$LE<$LA;++$LE)$LEi.add($Lr[$LE],$Lf,$Lf);var $LG=$L_.center;$LEi.scale($Lf,1/$Lt,$LG);var $LN=0;for($LE=$Li;$LE<$LA;++$LE){var $Lp=$LEi.distanceSquared($LG,$Lr[$LE]);$LN<$Lp&&($LN=$Lp)}$L_.radius=Math.sqrt($LN)},$Lg.createfromPoints=function($Lr,$Li){if(null==$Lr)throw new Error("points");$Lg.createFromSubPoints($Lr,0,$Lr.length,$Li)},$LR($Lg,["_tempVector3",function(){return this._tempVector3=new $LEi}]),$Lg}(),$LYr=(function(){function $Lr(){}$Lv($Lr,"laya.d3.math.ContainmentType"),$Lr.Disjoint=0,$Lr.Contains=1,$Lr.Intersects=2}(),function(){function $Lt(){}return $Lv($Lt,"laya.d3.math.MathUtils3D"),$Lt.isZero=function($Lr){return Math.abs($Lr)<$Lt.zeroTolerance},$Lt.nearEqual=function($Lr,$Li){return!!$Lt.isZero($Lr-$Li)},$Lt.fastInvSqrt=function($Lr){return $Lt.isZero($Lr)?$Lr:1/Math.sqrt($Lr)},$LR($Lt,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),$Lt}()),$Ljr=function(){function $LN(){var $Lr=this.elements=new Float32Array(9);$Lr[0]=1,$Lr[1]=0,$Lr[2]=0,$Lr[3]=0,$Lr[4]=1,$Lr[5]=0,$Lr[6]=0,$Lr[7]=0,$Lr[8]=1}$Lv($LN,"laya.d3.math.Matrix3x3");var $Lr=$LN.prototype;return $LD.imps($Lr,{"laya.d3.core.IClone":!0}),$Lr.determinant=function(){var $Lr=this.elements,$Li=$Lr[0],$Lt=$Lr[1],$L_=$Lr[2],$LA=$Lr[3],$Lf=$Lr[4],$LE=$Lr[5],$LG=$Lr[6],$LN=$Lr[7],$Lp=$Lr[8];return $Li*($Lp*$Lf-$LE*$LN)+$Lt*(-$Lp*$LA+$LE*$LG)+$L_*($LN*$LA-$Lf*$LG)},$Lr.translate=function($Lr,$Li){var $Lt=$Li.elements,$L_=this.elements,$LA=$Lr.elements,$Lf=$L_[0],$LE=$L_[1],$LG=$L_[2],$LN=$L_[3],$Lp=$L_[4],$Lg=$L_[5],$LR=$L_[6],$LX=$L_[7],$Lv=$L_[8],$LO=$LA[0],$Lc=$LA[1];$Lt[0]=$Lf,$Lt[1]=$LE,$Lt[2]=$LG,$Lt[3]=$LN,$Lt[4]=$Lp,$Lt[5]=$Lg,$Lt[6]=$LO*$Lf+$Lc*$LN+$LR,$Lt[7]=$LO*$LE+$Lc*$Lp+$LX,$Lt[8]=$LO*$LG+$Lc*$Lg+$Lv},$Lr.rotate=function($Lr,$Li){var $Lt=$Li.elements,$L_=this.elements,$LA=$L_[0],$Lf=$L_[1],$LE=$L_[2],$LG=$L_[3],$LN=$L_[4],$Lp=$L_[5],$Lg=$L_[6],$LR=$L_[7],$LX=$L_[8],$Lv=Math.sin($Lr),$LO=Math.cos($Lr);$Lt[0]=$LO*$LA+$Lv*$LG,$Lt[1]=$LO*$Lf+$Lv*$LN,$Lt[2]=$LO*$LE+$Lv*$Lp,$Lt[3]=$LO*$LG-$Lv*$LA,$Lt[4]=$LO*$LN-$Lv*$Lf,$Lt[5]=$LO*$Lp-$Lv*$LE,$Lt[6]=$Lg,$Lt[7]=$LR,$Lt[8]=$LX},$Lr.scale=function($Lr,$Li){var $Lt=$Li.elements,$L_=this.elements,$LA=$Lr.elements,$Lf=$LA[0],$LE=$LA[1];$Lt[0]=$Lf*$L_[0],$Lt[1]=$Lf*$L_[1],$Lt[2]=$Lf*$L_[2],$Lt[3]=$LE*$L_[3],$Lt[4]=$LE*$L_[4],$Lt[5]=$LE*$L_[5],$Lt[6]=$L_[6],$Lt[7]=$L_[7],$Lt[8]=$L_[8]},$Lr.invert=function($Lr){var $Li=$Lr.elements,$Lt=this.elements,$L_=$Lt[0],$LA=$Lt[1],$Lf=$Lt[2],$LE=$Lt[3],$LG=$Lt[4],$LN=$Lt[5],$Lp=$Lt[6],$Lg=$Lt[7],$LR=$Lt[8],$LX=$LR*$LG-$LN*$Lg,$Lv=-$LR*$LE+$LN*$Lp,$LO=$Lg*$LE-$LG*$Lp,$Lc=$L_*$LX+$LA*$Lv+$Lf*$LO;$Lc||($Lr=null),$Lc=1/$Lc,$Li[0]=$LX*$Lc,$Li[1]=(-$LR*$LA+$Lf*$Lg)*$Lc,$Li[2]=($LN*$LA-$Lf*$LG)*$Lc,$Li[3]=$Lv*$Lc,$Li[4]=($LR*$L_-$Lf*$Lp)*$Lc,$Li[5]=(-$LN*$L_+$Lf*$LE)*$Lc,$Li[6]=$LO*$Lc,$Li[7]=(-$Lg*$L_+$LA*$Lp)*$Lc,$Li[8]=($LG*$L_-$LA*$LE)*$Lc},$Lr.transpose=function($Lr){var $Li=$Lr.elements,$Lt=this.elements;if($Lr===this){var $L_=$Lt[1],$LA=$Lt[2],$Lf=$Lt[5];$Li[1]=$Lt[3],$Li[2]=$Lt[6],$Li[3]=$L_,$Li[5]=$Lt[7],$Li[6]=$LA,$Li[7]=$Lf}else $Li[0]=$Lt[0],$Li[1]=$Lt[3],$Li[2]=$Lt[6],$Li[3]=$Lt[1],$Li[4]=$Lt[4],$Li[5]=$Lt[7],$Li[6]=$Lt[2],$Li[7]=$Lt[5],$Li[8]=$Lt[8]},$Lr.identity=function(){var $Lr=this.elements;$Lr[0]=1,$Lr[1]=0,$Lr[2]=0,$Lr[3]=0,$Lr[4]=1,$Lr[5]=0,$Lr[6]=0,$Lr[7]=0,$Lr[8]=1},$Lr.cloneTo=function($Lr){var $Li,$Lt,$L_;if(($Lt=this.elements)!==($L_=$Lr.elements))for($Li=0;$Li<9;++$Li)$L_[$Li]=$Lt[$Li]},$Lr.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LN.createFromTranslation=function($Lr,$Li){$Li.elements;var $Lt=$Lr.elements;$Li[0]=1,$Li[1]=0,$Li[2]=0,$Li[3]=0,$Li[4]=1,$Li[5]=0,$Li[6]=$Lt[0],$Li[7]=$Lt[1],$Li[8]=1},$LN.createFromRotation=function($Lr,$Li){var $Lt=$Li.elements,$L_=Math.sin($Lr),$LA=Math.cos($Lr);$Lt[0]=$LA,$Lt[1]=$L_,$Lt[2]=0,$Lt[3]=-$L_,$Lt[4]=$LA,$Lt[5]=0,$Lt[6]=0,$Lt[7]=0,$Lt[8]=1},$LN.createFromScaling=function($Lr,$Li){var $Lt=$Li.elements,$L_=$Lr.elements;$Lt[0]=$L_[0],$Lt[1]=0,$Lt[2]=0,$Lt[3]=0,$Lt[4]=$L_[1],$Lt[5]=0,$Lt[6]=0,$Lt[7]=0,$Lt[8]=1},$LN.createFromMatrix4x4=function($Lr,$Li){$Li[0]=$Lr[0],$Li[1]=$Lr[1],$Li[2]=$Lr[2],$Li[3]=$Lr[4],$Li[4]=$Lr[5],$Li[5]=$Lr[6],$Li[6]=$Lr[8],$Li[7]=$Lr[9],$Li[8]=$Lr[10]},$LN.multiply=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements,$LE=$LA[0],$LG=$LA[1],$LN=$LA[2],$Lp=$LA[3],$Lg=$LA[4],$LR=$LA[5],$LX=$LA[6],$Lv=$LA[7],$LO=$LA[8],$Lc=$Lf[0],$LB=$Lf[1],$Ly=$Lf[2],$LC=$Lf[3],$Ln=$Lf[4],$La=$Lf[5],$LD=$Lf[6],$Lu=$Lf[7],$Lw=$Lf[8];$L_[0]=$Lc*$LE+$LB*$Lp+$Ly*$LX,$L_[1]=$Lc*$LG+$LB*$Lg+$Ly*$Lv,$L_[2]=$Lc*$LN+$LB*$LR+$Ly*$LO,$L_[3]=$LC*$LE+$Ln*$Lp+$La*$LX,$L_[4]=$LC*$LG+$Ln*$Lg+$La*$Lv,$L_[5]=$LC*$LN+$Ln*$LR+$La*$LO,$L_[6]=$LD*$LE+$Lu*$Lp+$Lw*$LX,$L_[7]=$LD*$LG+$Lu*$Lg+$Lw*$Lv,$L_[8]=$LD*$LN+$Lu*$LR+$Lw*$LO},$LN.lookAt=function($Lr,$Li,$Lt,$L_){$LEi.subtract($Lr,$Li,$LN._tempV30),$LEi.normalize($LN._tempV30,$LN._tempV30),$LEi.cross($Lt,$LN._tempV30,$LN._tempV31),$LEi.normalize($LN._tempV31,$LN._tempV31),$LEi.cross($LN._tempV30,$LN._tempV31,$LN._tempV32);var $LA=$LN._tempV30.elements,$Lf=$LN._tempV31.elements,$LE=$LN._tempV32.elements,$LG=$L_.elements;$LG[0]=$Lf[0],$LG[3]=$Lf[1],$LG[6]=$Lf[2],$LG[1]=$LE[0],$LG[4]=$LE[1],$LG[7]=$LE[2],$LG[2]=$LA[0],$LG[5]=$LA[1],$LG[8]=$LA[2]},$LN.DEFAULT=new $LN,$LR($LN,["_tempV30",function(){return this._tempV30=new $LEi},"_tempV31",function(){return this._tempV31=new $LEi},"_tempV32",function(){return this._tempV32=new $LEi}]),$LN}(),$Lri=function(){function $Ls($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LR,$LX,$Lv,$LO,$Lc){void 0===$Lr&&($Lr=1),void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=0),void 0===$LA&&($LA=0),void 0===$Lf&&($Lf=1),void 0===$LE&&($LE=0),void 0===$LG&&($LG=0),void 0===$LN&&($LN=0),void 0===$Lp&&($Lp=0),void 0===$Lg&&($Lg=1),void 0===$LR&&($LR=0),void 0===$LX&&($LX=0),void 0===$Lv&&($Lv=0),void 0===$LO&&($LO=0),void 0===$Lc&&($Lc=1);var $LB=this.elements=new Float32Array(16);$LB[0]=$Lr,$LB[1]=$Li,$LB[2]=$Lt,$LB[3]=$L_,$LB[4]=$LA,$LB[5]=$Lf,$LB[6]=$LE,$LB[7]=$LG,$LB[8]=$LN,$LB[9]=$Lp,$LB[10]=$Lg,$LB[11]=$LR,$LB[12]=$LX,$LB[13]=$Lv,$LB[14]=$LO,$LB[15]=$Lc}$Lv($Ls,"laya.d3.math.Matrix4x4");var $Lr=$Ls.prototype;return $LD.imps($Lr,{"laya.d3.core.IClone":!0}),$Lr.getElementByRowColumn=function($Lr,$Li){if($Lr<0||3<$Lr)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($Li<0||3<$Li)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*$Lr+$Li]},$Lr.setElementByRowColumn=function($Lr,$Li,$Lt){if($Lr<0||3<$Lr)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($Li<0||3<$Li)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*$Lr+$Li]=$Lt},$Lr.equalsOtherMatrix=function($Lr){var $Li=this.elements,$Lt=$Lr.elements;return $LYr.nearEqual($Li[0],$Lt[0])&&$LYr.nearEqual($Li[1],$Lt[1])&&$LYr.nearEqual($Li[2],$Lt[2])&&$LYr.nearEqual($Li[3],$Lt[3])&&$LYr.nearEqual($Li[4],$Lt[4])&&$LYr.nearEqual($Li[5],$Lt[5])&&$LYr.nearEqual($Li[6],$Lt[6])&&$LYr.nearEqual($Li[7],$Lt[7])&&$LYr.nearEqual($Li[8],$Lt[8])&&$LYr.nearEqual($Li[9],$Lt[9])&&$LYr.nearEqual($Li[10],$Lt[10])&&$LYr.nearEqual($Li[11],$Lt[11])&&$LYr.nearEqual($Li[12],$Lt[12])&&$LYr.nearEqual($Li[13],$Lt[13])&&$LYr.nearEqual($Li[14],$Lt[14])&&$LYr.nearEqual($Li[15],$Lt[15])},$Lr.decomposeTransRotScale=function($Lr,$Li,$Lt){var $L_=$Ls._tempMatrix4x4;return this.decomposeTransRotMatScale($Lr,$L_,$Lt)?($Lti.createFromMatrix4x4($L_,$Li),!0):($Li.identity(),!1)},$Lr.decomposeTransRotMatScale=function($Lr,$Li,$Lt){var $L_=this.elements,$LA=$Lr.elements,$Lf=$Li.elements,$LE=$Lt.elements;$LA[0]=$L_[12],$LA[1]=$L_[13],$LA[2]=$L_[14];var $LG=$L_[0],$LN=$L_[1],$Lp=$L_[2],$Lg=$L_[4],$LR=$L_[5],$LX=$L_[6],$Lv=$L_[8],$LO=$L_[9],$Lc=$L_[10],$LB=$LE[0]=Math.sqrt($LG*$LG+$LN*$LN+$Lp*$Lp),$Ly=$LE[1]=Math.sqrt($Lg*$Lg+$LR*$LR+$LX*$LX),$LC=$LE[2]=Math.sqrt($Lv*$Lv+$LO*$LO+$Lc*$Lc);if($LYr.isZero($LB)||$LYr.isZero($Ly)||$LYr.isZero($LC))return $Lf[1]=$Lf[2]=$Lf[3]=$Lf[4]=$Lf[6]=$Lf[7]=$Lf[8]=$Lf[9]=$Lf[11]=$Lf[12]=$Lf[13]=$Lf[14]=0,$Lf[0]=$Lf[5]=$Lf[10]=$Lf[15]=1,!1;var $Ln=$Ls._tempVector0,$La=$Ln.elements;$La[0]=$Lv/$LC,$La[1]=$LO/$LC,$La[2]=$Lc/$LC;var $LD=$Ls._tempVector1,$Lu=$LD.elements;$Lu[0]=$LG/$LB,$Lu[1]=$LN/$LB,$Lu[2]=$Lp/$LB;var $Lw=$Ls._tempVector2;$LEi.cross($Ln,$LD,$Lw);var $LH=$Ls._tempVector1;return $LEi.cross($Lw,$Ln,$LH),$Lf[3]=$Lf[7]=$Lf[11]=$Lf[12]=$Lf[13]=$Lf[14]=0,$Lf[15]=1,$Lf[0]=$LH.x,$Lf[1]=$LH.y,$Lf[2]=$LH.z,$Lf[4]=$Lw.x,$Lf[5]=$Lw.y,$Lf[6]=$Lw.z,$Lf[8]=$Ln.x,$Lf[9]=$Ln.y,$Lf[10]=$Ln.z,$Lf[0]*$LG+$Lf[1]*$LN+$Lf[2]*$Lp<0&&($LE[0]=-$LB),$Lf[4]*$Lg+$Lf[5]*$LR+$Lf[6]*$LX<0&&($LE[1]=-$Ly),$Lf[8]*$Lv+$Lf[9]*$LO+$Lf[10]*$Lc<0&&($LE[2]=-$LC),!0},$Lr.decomposeYawPitchRoll=function($Lr){var $Li=$Lr.elements,$Lt=Math.asin(-this.elements[9]);$Li[1]=$Lt,Math.cos($Lt)>$LYr.zeroTolerance?($Li[2]=Math.atan2(this.elements[1],this.elements[5]),$Li[0]=Math.atan2(this.elements[8],this.elements[10])):($Li[2]=Math.atan2(-this.elements[4],this.elements[0]),$Li[0]=0)},$Lr.normalize=function(){var $Lr=this.elements,$Li=$Lr[0],$Lt=$Lr[1],$L_=$Lr[2],$LA=Math.sqrt($Li*$Li+$Lt*$Lt+$L_*$L_);if(!$LA)return $Lr[0]=0,$Lr[1]=0,void($Lr[2]=0);1!=$LA&&($LA=1/$LA,$Lr[0]=$Li*$LA,$Lr[1]=$Lt*$LA,$Lr[2]=$L_*$LA)},$Lr.transpose=function(){var $Lr,$Li;return $Li=($Lr=this.elements)[1],$Lr[1]=$Lr[4],$Lr[4]=$Li,$Li=$Lr[2],$Lr[2]=$Lr[8],$Lr[8]=$Li,$Li=$Lr[3],$Lr[3]=$Lr[12],$Lr[12]=$Li,$Li=$Lr[6],$Lr[6]=$Lr[9],$Lr[9]=$Li,$Li=$Lr[7],$Lr[7]=$Lr[13],$Lr[13]=$Li,$Li=$Lr[11],$Lr[11]=$Lr[14],$Lr[14]=$Li,this},$Lr.invert=function($Lr){var $Li=this.elements,$Lt=$Lr.elements,$L_=$Li[0],$LA=$Li[1],$Lf=$Li[2],$LE=$Li[3],$LG=$Li[4],$LN=$Li[5],$Lp=$Li[6],$Lg=$Li[7],$LR=$Li[8],$LX=$Li[9],$Lv=$Li[10],$LO=$Li[11],$Lc=$Li[12],$LB=$Li[13],$Ly=$Li[14],$LC=$Li[15],$Ln=$L_*$LN-$LA*$LG,$La=$L_*$Lp-$Lf*$LG,$LD=$L_*$Lg-$LE*$LG,$Lu=$LA*$Lp-$Lf*$LN,$Lw=$LA*$Lg-$LE*$LN,$LH=$Lf*$Lg-$LE*$Lp,$Ls=$LR*$LB-$LX*$Lc,$Ld=$LR*$Ly-$Lv*$Lc,$Ll=$LR*$LC-$LO*$Lc,$LU=$LX*$Ly-$Lv*$LB,$Lk=$LX*$LC-$LO*$LB,$Le=$Lv*$LC-$LO*$Ly,$LL=$Ln*$Le-$La*$Lk+$LD*$LU+$Lu*$Ll-$Lw*$Ld+$LH*$Ls;0!==Math.abs($LL)&&($LL=1/$LL,$Lt[0]=($LN*$Le-$Lp*$Lk+$Lg*$LU)*$LL,$Lt[1]=($Lf*$Lk-$LA*$Le-$LE*$LU)*$LL,$Lt[2]=($LB*$LH-$Ly*$Lw+$LC*$Lu)*$LL,$Lt[3]=($Lv*$Lw-$LX*$LH-$LO*$Lu)*$LL,$Lt[4]=($Lp*$Ll-$LG*$Le-$Lg*$Ld)*$LL,$Lt[5]=($L_*$Le-$Lf*$Ll+$LE*$Ld)*$LL,$Lt[6]=($Ly*$LD-$Lc*$LH-$LC*$La)*$LL,$Lt[7]=($LR*$LH-$Lv*$LD+$LO*$La)*$LL,$Lt[8]=($LG*$Lk-$LN*$Ll+$Lg*$Ls)*$LL,$Lt[9]=($LA*$Ll-$L_*$Lk-$LE*$Ls)*$LL,$Lt[10]=($Lc*$Lw-$LB*$LD+$LC*$Ln)*$LL,$Lt[11]=($LX*$LD-$LR*$Lw-$LO*$Ln)*$LL,$Lt[12]=($LN*$Ld-$LG*$LU-$Lp*$Ls)*$LL,$Lt[13]=($L_*$LU-$LA*$Ld+$Lf*$Ls)*$LL,$Lt[14]=($LB*$La-$Lc*$Lu-$Ly*$Ln)*$LL,$Lt[15]=($LR*$Lu-$LX*$La+$Lv*$Ln)*$LL)},$Lr.identity=function(){var $Lr=this.elements;$Lr[1]=$Lr[2]=$Lr[3]=$Lr[4]=$Lr[6]=$Lr[7]=$Lr[8]=$Lr[9]=$Lr[11]=$Lr[12]=$Lr[13]=$Lr[14]=0,$Lr[0]=$Lr[5]=$Lr[10]=$Lr[15]=1},$Lr.cloneTo=function($Lr){var $Li,$Lt,$L_;if(($Lt=this.elements)!==($L_=$Lr.elements))for($Li=0;$Li<16;++$Li)$L_[$Li]=$Lt[$Li]},$Lr.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$Lr.getTranslationVector=function($Lr){var $Li=this.elements,$Lt=$Lr.elements;$Lt[0]=$Li[12],$Lt[1]=$Li[13],$Lt[2]=$Li[14]},$Lr.setTranslationVector=function($Lr){var $Li=this.elements,$Lt=$Lr.elements;$Li[12]=$Lt[0],$Li[13]=$Lt[1],$Li[14]=$Lt[2]},$Lr.getForward=function($Lr){var $Li=this.elements,$Lt=$Lr.elements;$Lt[0]=-$Li[8],$Lt[1]=-$Li[9],$Lt[2]=-$Li[10]},$Lr.setForward=function($Lr){var $Li=this.elements,$Lt=$Lr.elements;$Li[8]=-$Lt[0],$Li[9]=-$Lt[1],$Li[10]=-$Lt[2]},$Ls.createRotationX=function($Lr,$Li){var $Lt=$Li.elements,$L_=Math.sin($Lr),$LA=Math.cos($Lr);$Lt[1]=$Lt[2]=$Lt[3]=$Lt[4]=$Lt[7]=$Lt[8]=$Lt[11]=$Lt[12]=$Lt[13]=$Lt[14]=0,$Lt[0]=$Lt[15]=1,$Lt[5]=$Lt[10]=$LA,$Lt[6]=$L_,$Lt[9]=-$L_},$Ls.createRotationY=function($Lr,$Li){var $Lt=$Li.elements,$L_=Math.sin($Lr),$LA=Math.cos($Lr);$Lt[1]=$Lt[3]=$Lt[4]=$Lt[6]=$Lt[7]=$Lt[9]=$Lt[11]=$Lt[12]=$Lt[13]=$Lt[14]=0,$Lt[5]=$Lt[15]=1,$Lt[0]=$Lt[10]=$LA,$Lt[2]=-$L_,$Lt[8]=$L_},$Ls.createRotationZ=function($Lr,$Li){var $Lt=$Li.elements,$L_=Math.sin($Lr),$LA=Math.cos($Lr);$Lt[2]=$Lt[3]=$Lt[6]=$Lt[7]=$Lt[8]=$Lt[9]=$Lt[11]=$Lt[12]=$Lt[13]=$Lt[14]=0,$Lt[10]=$Lt[15]=1,$Lt[0]=$Lt[5]=$LA,$Lt[1]=$L_,$Lt[4]=-$L_},$Ls.createRotationYawPitchRoll=function($Lr,$Li,$Lt,$L_){$Lti.createFromYawPitchRoll($Lr,$Li,$Lt,$Ls._tempQuaternion),$Ls.createRotationQuaternion($Ls._tempQuaternion,$L_)},$Ls.createRotationAxis=function($Lr,$Li,$Lt){var $L_=$Lr.elements,$LA=$L_[0],$Lf=$L_[1],$LE=$L_[2],$LG=Math.cos($Li),$LN=Math.sin($Li),$Lp=$LA*$LA,$Lg=$Lf*$Lf,$LR=$LE*$LE,$LX=$LA*$Lf,$Lv=$LA*$LE,$LO=$Lf*$LE,$Lc=$Lt.elements;$Lc[3]=$Lc[7]=$Lc[11]=$Lc[12]=$Lc[13]=$Lc[14]=0,$Lc[15]=1,$Lc[0]=$Lp+$LG*(1-$Lp),$Lc[1]=$LX-$LG*$LX+$LN*$LE,$Lc[2]=$Lv-$LG*$Lv-$LN*$Lf,$Lc[4]=$LX-$LG*$LX-$LN*$LE,$Lc[5]=$Lg+$LG*(1-$Lg),$Lc[6]=$LO-$LG*$LO+$LN*$LA,$Lc[8]=$Lv-$LG*$Lv+$LN*$Lf,$Lc[9]=$LO-$LG*$LO-$LN*$LA,$Lc[10]=$LR+$LG*(1-$LR)},$Ls.createRotationQuaternion=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements,$LA=$Lt[0],$Lf=$Lt[1],$LE=$Lt[2],$LG=$Lt[3],$LN=$LA*$LA,$Lp=$Lf*$Lf,$Lg=$LE*$LE,$LR=$LA*$Lf,$LX=$LE*$LG,$Lv=$LE*$LA,$LO=$Lf*$LG,$Lc=$Lf*$LE,$LB=$LA*$LG;$L_[3]=$L_[7]=$L_[11]=$L_[12]=$L_[13]=$L_[14]=0,$L_[15]=1,$L_[0]=1-2*($Lp+$Lg),$L_[1]=2*($LR+$LX),$L_[2]=2*($Lv-$LO),$L_[4]=2*($LR-$LX),$L_[5]=1-2*($Lg+$LN),$L_[6]=2*($Lc+$LB),$L_[8]=2*($Lv+$LO),$L_[9]=2*($Lc-$LB),$L_[10]=1-2*($Lp+$LN)},$Ls.createTranslate=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements;$L_[4]=$L_[8]=$L_[1]=$L_[9]=$L_[2]=$L_[6]=$L_[3]=$L_[7]=$L_[11]=0,$L_[0]=$L_[5]=$L_[10]=$L_[15]=1,$L_[12]=$Lt[0],$L_[13]=$Lt[1],$L_[14]=$Lt[2]},$Ls.createScaling=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements;$L_[0]=$Lt[0],$L_[5]=$Lt[1],$L_[10]=$Lt[2],$L_[1]=$L_[4]=$L_[8]=$L_[12]=$L_[9]=$L_[13]=$L_[2]=$L_[6]=$L_[14]=$L_[3]=$L_[7]=$L_[11]=0,$L_[15]=1},$Ls.multiply=function($Lr,$Li,$Lt){var $L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg;for($LA=$Lt.elements,$Lf=$Lr.elements,$LA===($LE=$Li.elements)&&($LE=$LE.slice()),$L_=0;$L_<4;$L_++)$LG=$Lf[$L_],$LN=$Lf[$L_+4],$Lp=$Lf[$L_+8],$Lg=$Lf[$L_+12],$LA[$L_]=$LG*$LE[0]+$LN*$LE[1]+$Lp*$LE[2]+$Lg*$LE[3],$LA[$L_+4]=$LG*$LE[4]+$LN*$LE[5]+$Lp*$LE[6]+$Lg*$LE[7],$LA[$L_+8]=$LG*$LE[8]+$LN*$LE[9]+$Lp*$LE[10]+$Lg*$LE[11],$LA[$L_+12]=$LG*$LE[12]+$LN*$LE[13]+$Lp*$LE[14]+$Lg*$LE[15]},$Ls.createFromQuaternion=function($Lr,$Li){var $Lt=$Li.elements,$L_=$Lr.elements,$LA=$L_[0],$Lf=$L_[1],$LE=$L_[2],$LG=$L_[3],$LN=$LA+$LA,$Lp=$Lf+$Lf,$Lg=$LE+$LE,$LR=$LA*$LN,$LX=$Lf*$LN,$Lv=$Lf*$Lp,$LO=$LE*$LN,$Lc=$LE*$Lp,$LB=$LE*$Lg,$Ly=$LG*$LN,$LC=$LG*$Lp,$Ln=$LG*$Lg;$Lt[0]=1-$Lv-$LB,$Lt[1]=$LX+$Ln,$Lt[2]=$LO-$LC,$Lt[3]=0,$Lt[4]=$LX-$Ln,$Lt[5]=1-$LR-$LB,$Lt[6]=$Lc+$Ly,$Lt[7]=0,$Lt[8]=$LO+$LC,$Lt[9]=$Lc-$Ly,$Lt[10]=1-$LR-$Lv,$Lt[11]=0,$Lt[12]=0,$Lt[13]=0,$Lt[14]=0,$Lt[15]=1},$Ls.createAffineTransformation=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.elements,$Lf=$Li.elements,$LE=$Lt.elements,$LG=$L_.elements,$LN=$Lf[0],$Lp=$Lf[1],$Lg=$Lf[2],$LR=$Lf[3],$LX=$LN+$LN,$Lv=$Lp+$Lp,$LO=$Lg+$Lg,$Lc=$LN*$LX,$LB=$LN*$Lv,$Ly=$LN*$LO,$LC=$Lp*$Lv,$Ln=$Lp*$LO,$La=$Lg*$LO,$LD=$LR*$LX,$Lu=$LR*$Lv,$Lw=$LR*$LO,$LH=$LE[0],$Ls=$LE[1],$Ld=$LE[2];$LG[0]=(1-($LC+$La))*$LH,$LG[1]=($LB+$Lw)*$LH,$LG[2]=($Ly-$Lu)*$LH,$LG[3]=0,$LG[4]=($LB-$Lw)*$Ls,$LG[5]=(1-($Lc+$La))*$Ls,$LG[6]=($Ln+$LD)*$Ls,$LG[7]=0,$LG[8]=($Ly+$Lu)*$Ld,$LG[9]=($Ln-$LD)*$Ld,$LG[10]=(1-($Lc+$LC))*$Ld,$LG[11]=0,$LG[12]=$LA[0],$LG[13]=$LA[1],$LG[14]=$LA[2],$LG[15]=1},$Ls.createLookAt=function($Lr,$Li,$Lt,$L_){var $LA=$L_.elements,$Lf=$Ls._tempVector0,$LE=$Ls._tempVector1,$LG=$Ls._tempVector2;$LEi.subtract($Lr,$Li,$LG),$LEi.normalize($LG,$LG),$LEi.cross($Lt,$LG,$Lf),$LEi.normalize($Lf,$Lf),$LEi.cross($LG,$Lf,$LE),$L_.identity(),$LA[0]=$Lf.x,$LA[4]=$Lf.y,$LA[8]=$Lf.z,$LA[1]=$LE.x,$LA[5]=$LE.y,$LA[9]=$LE.z,$LA[2]=$LG.x,$LA[6]=$LG.y,$LA[10]=$LG.z,$LA[12]=-$LEi.dot($Lf,$Lr),$LA[13]=-$LEi.dot($LE,$Lr),$LA[14]=-$LEi.dot($LG,$Lr)},$Ls.createPerspective=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$LA.elements,$LE=1/Math.tan($Lr/2),$LG=1/($Lt-$L_);$Lf[0]=$LE/$Li,$Lf[5]=$LE,$Lf[10]=($L_+$Lt)*$LG,$Lf[11]=-1,$Lf[14]=2*$L_*$Lt*$LG,$Lf[1]=$Lf[2]=$Lf[3]=$Lf[4]=$Lf[6]=$Lf[7]=$Lf[8]=$Lf[9]=$Lf[12]=$Lf[13]=$Lf[15]=0},$Ls.createOrthoOffCenterRH=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){var $LG=$LE.elements,$LN=1/($Lr-$Li),$Lp=1/($Lt-$L_),$Lg=1/($LA-$Lf);$LG[1]=$LG[2]=$LG[3]=$LG[4]=$LG[6]=$LG[7]=$LG[8]=$LG[9]=$LG[11]=0,$LG[15]=1,$LG[0]=-2*$LN,$LG[5]=-2*$Lp,$LG[10]=2*$Lg,$LG[12]=($Lr+$Li)*$LN,$LG[13]=($L_+$Lt)*$Lp,$LG[14]=($Lf+$LA)*$Lg},$Ls.translation=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements;$L_[0]=$L_[5]=$L_[10]=$L_[15]=1,$L_[12]=$Lt[0],$L_[13]=$Lt[1],$L_[14]=$Lt[2]},$LR($Ls,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $Ls},"_tempVector0",function(){return this._tempVector0=new $LEi},"_tempVector1",function(){return this._tempVector1=new $LEi},"_tempVector2",function(){return this._tempVector2=new $LEi},"_tempQuaternion",function(){return this._tempQuaternion=new $Lti},"DEFAULT",function(){return this.DEFAULT=new $Ls},"ZERO",function(){return this.ZERO=new $Ls(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),$Ls}(),$Lii=(function(){function $Ln($Lr,$Li){this.extents=null,this.transformation=null,this.extents=$Lr,this.transformation=$Li}$Lv($Ln,"laya.d3.math.OrientedBoundBox");var $Lr=$Ln.prototype;$Lr.getCorners=function($Lr){var $Li=$Ln._tempV30.elements,$Lt=$Ln._tempV31.elements,$L_=$Ln._tempV32.elements,$LA=this.extents.elements;$Li[0]=$LA[0],$Li[1]=$Li[2]=0,$Lt[1]=$LA[1],$Lt[0]=$Lt[2]=0,$L_[2]=$LA[2],$L_[0]=$L_[1]=0,$LEi.TransformNormal($Ln._tempV30,this.transformation,$Ln._tempV30),$LEi.TransformNormal($Ln._tempV31,this.transformation,$Ln._tempV31),$LEi.TransformNormal($Ln._tempV32,this.transformation,$Ln._tempV32);var $Lf=$Ln._tempV33;this.transformation.getTranslationVector($Lf),$Lr.length=8,$LEi.add($Lf,$Ln._tempV30,$Ln._tempV34),$LEi.add($Ln._tempV34,$Ln._tempV31,$Ln._tempV34),$LEi.add($Ln._tempV34,$Ln._tempV32,$Lr[0]),$LEi.add($Lf,$Ln._tempV30,$Ln._tempV34),$LEi.add($Ln._tempV34,$Ln._tempV31,$Ln._tempV34),$LEi.subtract($Ln._tempV34,$Ln._tempV32,$Lr[1]),$LEi.subtract($Lf,$Ln._tempV30,$Ln._tempV34),$LEi.add($Ln._tempV34,$Ln._tempV31,$Ln._tempV34),$LEi.subtract($Ln._tempV34,$Ln._tempV32,$Lr[2]),$LEi.subtract($Lf,$Ln._tempV30,$Ln._tempV34),$LEi.add($Ln._tempV34,$Ln._tempV31,$Ln._tempV34),$LEi.add($Ln._tempV34,$Ln._tempV32,$Lr[3]),$LEi.add($Lf,$Ln._tempV30,$Ln._tempV34),$LEi.subtract($Ln._tempV34,$Ln._tempV31,$Ln._tempV34),$LEi.add($Ln._tempV34,$Ln._tempV32,$Lr[4]),$LEi.add($Lf,$Ln._tempV30,$Ln._tempV34),$LEi.subtract($Ln._tempV34,$Ln._tempV31,$Ln._tempV34),$LEi.subtract($Ln._tempV34,$Ln._tempV32,$Lr[5]),$LEi.subtract($Lf,$Ln._tempV30,$Ln._tempV34),$LEi.subtract($Ln._tempV34,$Ln._tempV31,$Ln._tempV34),$LEi.subtract($Ln._tempV34,$Ln._tempV32,$Lr[6]),$LEi.subtract($Lf,$Ln._tempV30,$Ln._tempV34),$LEi.subtract($Ln._tempV34,$Ln._tempV31,$Ln._tempV34),$LEi.add($Ln._tempV34,$Ln._tempV32,$Lr[7])},$Lr.transform=function($Lr){$Lri.multiply(this.transformation,$Lr,this.transformation)},$Lr.scale=function($Lr){$LEi.multiply(this.extents,$Lr,this.extents)},$Lr.translate=function($Lr){this.transformation.getTranslationVector($Ln._tempV30),$LEi.add($Ln._tempV30,$Lr,$Ln._tempV31),this.transformation.setTranslationVector($Ln._tempV31)},$Lr.Size=function($Lr){$LEi.scale(this.extents,2,$Lr)},$Lr.getSize=function($Lr){var $Li=this.extents.elements;$Ln._tempV30.x=$Li[0],$Ln._tempV31.y=$Li[1],$Ln._tempV32.z=$Li[2],$LEi.TransformNormal($Ln._tempV30,this.transformation,$Ln._tempV30),$LEi.TransformNormal($Ln._tempV31,this.transformation,$Ln._tempV31),$LEi.TransformNormal($Ln._tempV31,this.transformation,$Ln._tempV32);var $Lt=$Lr.elements;$Lt[0]=$LEi.scalarLength($Ln._tempV30),$Lt[1]=$LEi.scalarLength($Ln._tempV31),$Lt[2]=$LEi.scalarLength($Ln._tempV32)},$Lr.getSizeSquared=function($Lr){var $Li=this.extents.elements;$Ln._tempV30.x=$Li[0],$Ln._tempV31.y=$Li[1],$Ln._tempV32.z=$Li[2],$LEi.TransformNormal($Ln._tempV30,this.transformation,$Ln._tempV30),$LEi.TransformNormal($Ln._tempV31,this.transformation,$Ln._tempV31),$LEi.TransformNormal($Ln._tempV31,this.transformation,$Ln._tempV32);var $Lt=$Lr.elements;$Lt[0]=$LEi.scalarLengthSquared($Ln._tempV30),$Lt[1]=$LEi.scalarLengthSquared($Ln._tempV31),$Lt[2]=$LEi.scalarLengthSquared($Ln._tempV32)},$Lr.getCenter=function($Lr){this.transformation.getTranslationVector($Lr)},$Lr.containsPoint=function($Lr){var $Li=this.extents.elements,$Lt=$Li[0],$L_=$Li[1],$LA=$Li[2];this.transformation.invert($Ln._tempM0),$LEi.transformCoordinate($Lr,$Ln._tempM0,$Ln._tempV30);var $Lf=$Ln._tempV30.elements,$LE=Math.abs($Lf[0]),$LG=Math.abs($Lf[1]),$LN=Math.abs($Lf[2]);return $LYr.nearEqual($LE,$Lt)&&$LYr.nearEqual($LG,$L_)&&$LYr.nearEqual($LN,$LA)?2:$LE<$Lt&&$LG<$L_&&$LN<$LA?1:0},$Lr.containsPoints=function($Lr){var $Li=this.extents.elements,$Lt=$Li[0],$L_=$Li[1],$LA=$Li[2];this.transformation.invert($Ln._tempM0);for(var $Lf=!0,$LE=!1,$LG=0;$LG<$Lr.length;$LG++){$LEi.transformCoordinate($Lr[$LG],$Ln._tempM0,$Ln._tempV30);var $LN=$Ln._tempV30.elements,$Lp=Math.abs($LN[0]),$Lg=Math.abs($LN[1]),$LR=Math.abs($LN[2]);$LYr.nearEqual($Lp,$Lt)&&$LYr.nearEqual($Lg,$L_)&&$LYr.nearEqual($LR,$LA)&&($LE=!0),$Lp<$Lt&&$Lg<$L_&&$LR<$LA?$LE=!0:$Lf=!1}return $Lf?1:$LE?2:0},$Lr.containsSphere=function($Lr,$Li){void 0===$Li&&($Li=!1);var $Lt=this.extents.elements,$L_=$Lt[0],$LA=$Lt[1],$Lf=$Lt[2],$LE=$Lr.radius;this.transformation.invert($Ln._tempM0),$LEi.transformCoordinate($Lr.center,$Ln._tempM0,$Ln._tempV30);var $LG=NaN;if($LG=$Li?$LE:($LEi.scale($LEi.UnitX,$LE,$Ln._tempV31),$LEi.TransformNormal($Ln._tempV31,$Ln._tempM0,$Ln._tempV31),$LEi.scalarLength($Ln._tempV31)),$LEi.scale(this.extents,-1,$Ln._tempV32),$LEi.Clamp($Ln._tempV30,$Ln._tempV32,this.extents,$Ln._tempV33),$LG*$LG<$LEi.distanceSquared($Ln._tempV30,$Ln._tempV33))return 0;var $LN=$Ln._tempV30.elements,$Lp=$LN[0],$Lg=$LN[1],$LR=$LN[2],$LX=$Ln._tempV32.elements,$Lv=$LX[0],$LO=$LX[1],$Lc=$LX[2];return $Lv+$LG<=$Lp&&$Lp<=$L_-$LG&&$LG<$L_-$Lv&&$LO+$LG<=$Lg&&$Lg<=$LA-$LG&&$LG<$LA-$LO&&$Lc+$LG<=$LR&&$LR<=$Lf-$LG&&$LG<$Lf-$Lc?1:2},$Lr.containsOrientedBoundBox=function($Lr){var $Li=0,$Lt=0;$Lr.getCorners($Ln._corners);var $L_=this.containsPoints($Ln._corners);if(0!=$L_)return $L_;var $LA=this.extents.elements;$Lr.extents.cloneTo($Ln._tempV35);var $Lf=$Ln._tempV35.elements;$Ln._getRows(this.transformation,$Ln._rows1),$Ln._getRows($Lr.transformation,$Ln._rows2);var $LE=NaN;for($Li=0;$Li<4;$Li++)for($Lt=0;$Lt<4;$Lt++)3==$Li||3==$Lt?($Ln._tempM0.setElementByRowColumn($Li,$Lt,0),$Ln._tempM1.setElementByRowColumn($Li,$Lt,0)):($LE=$LEi.dot($Ln._rows1[$Li],$Ln._rows2[$Lt]),$Ln._tempM0.setElementByRowColumn($Li,$Lt,$LE),$Ln._tempM1.setElementByRowColumn($Li,$Lt,Math.abs($LE)));$Lr.getCenter($Ln._tempV34),this.getCenter($Ln._tempV36),$LEi.subtract($Ln._tempV34,$Ln._tempV36,$Ln._tempV30);var $LG=$Ln._tempV31.elements;$LG[0]=$LEi.dot($Ln._tempV30,$Ln._rows1[0]),$LG[1]=$LEi.dot($Ln._tempV30,$Ln._rows1[1]),$LG[2]=$LEi.dot($Ln._tempV30,$Ln._rows1[2]);var $LN=$Ln._tempV32.elements,$Lp=$Ln._tempV33.elements;for($Li=0;$Li<3;$Li++)if($LN[0]=$Ln._tempM1.getElementByRowColumn($Li,0),$LN[1]=$Ln._tempM1.getElementByRowColumn($Li,1),$LN[2]=$Ln._tempM1.getElementByRowColumn($Li,2),$LA[$Li]+$LEi.dot($Ln._tempV35,$Ln._tempV32)<Math.abs($LG[$Li]))return 0;for($Lt=0;$Lt<3;$Lt++)if($LN[0]=$Ln._tempM1.getElementByRowColumn(0,$Lt),$LN[1]=$Ln._tempM1.getElementByRowColumn(1,$Lt),$LN[2]=$Ln._tempM1.getElementByRowColumn(2,$Lt),$Lp[0]=$Ln._tempM0.getElementByRowColumn(0,$Lt),$Lp[1]=$Ln._tempM0.getElementByRowColumn(1,$Lt),$Lp[2]=$Ln._tempM0.getElementByRowColumn(2,$Lt),$LEi.dot(this.extents,$Ln._tempV32)+$Lf[$Lt]<Math.abs($LEi.dot($Ln._tempV31,$Ln._tempV33)))return 0;for($Li=0;$Li<3;$Li++)for($Lt=0;$Lt<3;$Lt++){var $Lg=($Li+1)%3,$LR=($Li+2)%3,$LX=($Lt+1)%3,$Lv=($Lt+2)%3;if($LA[$Lg]*$Ln._tempM1.getElementByRowColumn($LR,$Lt)+$LA[$LR]*$Ln._tempM1.getElementByRowColumn($Lg,$Lt)+($Lf[$LX]*$Ln._tempM1.getElementByRowColumn($Li,$Lv)+$Lf[$Lv]*$Ln._tempM1.getElementByRowColumn($Li,$LX))<Math.abs($LG[$LR]*$Ln._tempM0.getElementByRowColumn($Lg,$Lt)-$LG[$Lg]*$Ln._tempM0.getElementByRowColumn($LR,$Lt)))return 0}return 2},$Lr.containsLine=function($Lr,$Li){$Ln._corners[0]=$Lr,$Ln._corners[1]=$Li;var $Lt=this.containsPoints($Ln._corners);if(0!=$Lt)return $Lt;var $L_=this.extents.elements,$LA=$L_[0],$Lf=$L_[1],$LE=$L_[2];this.transformation.invert($Ln._tempM0),$LEi.transformCoordinate($Lr,$Ln._tempM0,$Ln._tempV30),$LEi.transformCoordinate($Li,$Ln._tempM0,$Ln._tempV31),$LEi.add($Ln._tempV30,$Ln._tempV31,$Ln._tempV32),$LEi.scale($Ln._tempV32,.5,$Ln._tempV32),$LEi.subtract($Ln._tempV30,$Ln._tempV32,$Ln._tempV33);var $LG=$Ln._tempV33.elements,$LN=$LG[0],$Lp=$LG[1],$Lg=$LG[2],$LR=$Ln._tempV34.elements,$LX=$LR[0]=Math.abs($LG[0]),$Lv=$LR[1]=Math.abs($LG[1]),$LO=$LR[2]=Math.abs($LG[2]),$Lc=$Ln._tempV32.elements,$LB=$Lc[0],$Ly=$Lc[1],$LC=$Lc[2];return Math.abs($LB)>$LA+$LX?0:Math.abs($Ly)>$Lf+$Lv?0:Math.abs($LC)>$LE+$LO?0:Math.abs($Ly*$Lg-$LC*$Lp)>$Lf*$LO+$LE*$Lv?0:Math.abs($LB*$Lg-$LC*$LN)>$LA*$LO+$LE*$LX?0:Math.abs($LB*$Lp-$Ly*$LN)>$LA*$Lv+$Lf*$LX?0:2},$Lr.containsBoundBox=function($Lr){var $Li=0,$Lt=0,$L_=$Lr.min,$LA=$Lr.max;$Lr.getCorners($Ln._corners);var $Lf=this.containsPoints($Ln._corners);if(0!=$Lf)return $Lf;$LEi.subtract($LA,$L_,$Ln._tempV30),$LEi.scale($Ln._tempV30,.5,$Ln._tempV30),$LEi.add($L_,$Ln._tempV30,$Ln._tempV30),$LEi.subtract($LA,$Ln._tempV30,$Ln._tempV31);var $LE=this.extents.elements,$LG=$Ln._tempV31.elements;$Ln._getRows(this.transformation,$Ln._rows1),this.transformation.invert($Ln._tempM0);for($Li=0;$Li<3;$Li++)for($Lt=0;$Lt<3;$Lt++)$Ln._tempM1.setElementByRowColumn($Li,$Lt,Math.abs($Ln._tempM0.getElementByRowColumn($Li,$Lt)));this.getCenter($Ln._tempV35),$LEi.subtract($Ln._tempV30,$Ln._tempV35,$Ln._tempV32);var $LN=$Ln._tempV31.elements;$LN[0]=$LEi.dot($Ln._tempV32,$Ln._rows1[0]),$LN[1]=$LEi.dot($Ln._tempV32,$Ln._rows1[1]),$LN[2]=$LEi.dot($Ln._tempV32,$Ln._rows1[2]);var $Lp=$Ln._tempV33.elements,$Lg=$Ln._tempV34.elements;for($Li=0;$Li<3;$Li++)if($Lp[0]=$Ln._tempM1.getElementByRowColumn($Li,0),$Lp[1]=$Ln._tempM1.getElementByRowColumn($Li,1),$Lp[2]=$Ln._tempM1.getElementByRowColumn($Li,2),$LE[$Li]+$LEi.dot($Ln._tempV31,$Ln._tempV33)<Math.abs($LN[$Li]))return 0;for($Lt=0;$Lt<3;$Lt++)if($Lp[0]=$Ln._tempM1.getElementByRowColumn(0,$Lt),$Lp[1]=$Ln._tempM1.getElementByRowColumn(1,$Lt),$Lp[2]=$Ln._tempM1.getElementByRowColumn(2,$Lt),$Lg[0]=$Ln._tempM0.getElementByRowColumn(0,$Lt),$Lg[1]=$Ln._tempM0.getElementByRowColumn(1,$Lt),$Lg[2]=$Ln._tempM0.getElementByRowColumn(2,$Lt),$LEi.dot(this.extents,$Ln._tempV33)+$LG[$Lt]<Math.abs($LEi.dot($Ln._tempV31,$Ln._tempV34)))return 0;for($Li=0;$Li<3;$Li++)for($Lt=0;$Lt<3;$Lt++){var $LR=($Li+1)%3,$LX=($Li+2)%3,$Lv=($Lt+1)%3,$LO=($Lt+2)%3;if($LE[$LR]*$Ln._tempM1.getElementByRowColumn($LX,$Lt)+$LE[$LX]*$Ln._tempM1.getElementByRowColumn($LR,$Lt)+($LG[$Lv]*$Ln._tempM1.getElementByRowColumn($Li,$LO)+$LG[$LO]*$Ln._tempM1.getElementByRowColumn($Li,$Lv))<Math.abs($LN[$LX]*$Ln._tempM0.getElementByRowColumn($LR,$Lt)-$LN[$LR]*$Ln._tempM0.getElementByRowColumn($LX,$Lt)))return 0}return 2},$Lr.intersectsRay=function($Lr,$Li){$LEi.scale(this.extents,-1,$Ln._tempV30),this.transformation.invert($Ln._tempM0),$LEi.TransformNormal($Lr.direction,$Ln._tempM0,$Ln._ray.direction),$LEi.transformCoordinate($Lr.origin,$Ln._tempM0,$Ln._ray.origin),$Ln._boxBound1.min=$Ln._tempV30,$Ln._boxBound1.max=this.extents;var $Lt=Collision.intersectsRayAndBoxRP($Ln._ray,$Ln._boxBound1,$Li);return-1!==$Lt&&$LEi.transformCoordinate($Li,this.transformation,$Li),$Lt},$Lr._getLocalCorners=function($Lr){$Lr.length=8;var $Li=this.extents.elements;$Ln._tempV30.x=$Li[0],$Ln._tempV31.y=$Li[1],$Ln._tempV32.z=$Li[2],$LEi.add($Ln._tempV30,$Ln._tempV31,$Ln._tempV33),$LEi.add($Ln._tempV33,$Ln._tempV32,$Lr[0]),$LEi.add($Ln._tempV30,$Ln._tempV31,$Ln._tempV33),$LEi.subtract($Ln._tempV33,$Ln._tempV32,$Lr[1]),$LEi.subtract($Ln._tempV31,$Ln._tempV30,$Ln._tempV33),$LEi.subtract($Ln._tempV33,$Ln._tempV30,$Lr[2]),$LEi.subtract($Ln._tempV31,$Ln._tempV30,$Ln._tempV33),$LEi.add($Ln._tempV33,$Ln._tempV32,$Lr[3]),$LEi.subtract($Ln._tempV30,$Ln._tempV31,$Ln._tempV33),$LEi.add($Ln._tempV33,$Ln._tempV32,$Lr[4]),$LEi.subtract($Ln._tempV30,$Ln._tempV31,$Ln._tempV33),$LEi.subtract($Ln._tempV33,$Ln._tempV32,$Lr[5]),$LEi.scale($Lr[0],-1,$Lr[6]),$LEi.subtract($Ln._tempV32,$Ln._tempV30,$Ln._tempV33),$LEi.subtract($Ln._tempV33,$Ln._tempV31,$Lr[7])},$Lr.equals=function($Lr){return this.extents==$Lr.extents&&this.transformation==$Lr.transformation},$Lr.cloneTo=function($Lr){var $Li=$Lr;this.extents.cloneTo($Li.extents),this.transformation.cloneTo($Li.transformation)},$Ln.createByBoundBox=function($Lr,$Li){var $Lt=$Lr.min,$L_=$Lr.max;$LEi.subtract($L_,$Lt,$Ln._tempV30),$LEi.scale($Ln._tempV30,.5,$Ln._tempV30),$LEi.add($Lt,$Ln._tempV30,$Ln._tempV31),$LEi.subtract($L_,$Ln._tempV31,$Ln._tempV32),$Lri.translation($Ln._tempV31,$Ln._tempM0);var $LA=$Ln._tempV32.clone(),$Lf=$Ln._tempM0.clone();$Li.extents=$LA,$Li.transformation=$Lf},$Ln.createByMinAndMaxVertex=function($Lr,$Li){return $LEi.subtract($Li,$Lr,$Ln._tempV30),$LEi.scale($Ln._tempV30,.5,$Ln._tempV30),$LEi.add($Lr,$Ln._tempV30,$Ln._tempV31),$LEi.subtract($Li,$Ln._tempV31,$Ln._tempV32),$Lri.translation($Ln._tempV31,$Ln._tempM0),new $Ln($Ln._tempV32,$Ln._tempM0)},$Ln._getRows=function($Lr,$Li){$Li.length=3;var $Lt=$Lr.elements,$L_=$Li[0].elements;$L_[0]=$Lt[0],$L_[1]=$Lt[1],$L_[2]=$Lt[2];var $LA=$Li[1].elements;$LA[0]=$Lt[4],$LA[1]=$Lt[5],$LA[2]=$Lt[6];var $Lf=$Li[2].elements;$Lf[0]=$Lt[8],$Lf[1]=$Lt[9],$Lf[2]=$Lt[10]},$Ln.getObbtoObbMatrix4x4=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.transformation,$Lf=$Li.transformation;if($Lt){$Ln._getRows($LA,$Ln._rows1),$Ln._getRows($Lf,$Ln._rows2);for(var $LE=0;$LE<3;$LE++)for(var $LG=0;$LG<3;$LG++)$L_.setElementByRowColumn($LE,$LG,$LEi.dot($Ln._rows2[$LE],$Ln._rows1[$LG]));$Li.getCenter($Ln._tempV30),$Lr.getCenter($Ln._tempV31),$LEi.subtract($Ln._tempV30,$Ln._tempV31,$Ln._tempV32);var $LN=$L_.elements;$LN[12]=$LEi.dot($Ln._tempV32,$Ln._rows1[0]),$LN[13]=$LEi.dot($Ln._tempV32,$Ln._rows1[1]),$LN[14]=$LEi.dot($Ln._tempV32,$Ln._rows1[2]),$LN[15]=1}else $LA.invert($Ln._tempM0),$Lri.multiply($Lf,$Ln._tempM0,$L_)},$Ln.merge=function($Lr,$Li,$Lt){var $L_=$Lr.extents,$LA=$Lr.transformation;$Ln.getObbtoObbMatrix4x4($Lr,$Li,$Lt,$Ln._tempM0),$Li._getLocalCorners($Ln._corners),$LEi.transformCoordinate($Ln._corners[0],$Ln._tempM0,$Ln._corners[0]),$LEi.transformCoordinate($Ln._corners[1],$Ln._tempM0,$Ln._corners[1]),$LEi.transformCoordinate($Ln._corners[2],$Ln._tempM0,$Ln._corners[2]),$LEi.transformCoordinate($Ln._corners[3],$Ln._tempM0,$Ln._corners[3]),$LEi.transformCoordinate($Ln._corners[4],$Ln._tempM0,$Ln._corners[4]),$LEi.transformCoordinate($Ln._corners[5],$Ln._tempM0,$Ln._corners[5]),$LEi.transformCoordinate($Ln._corners[6],$Ln._tempM0,$Ln._corners[6]),$LEi.transformCoordinate($Ln._corners[7],$Ln._tempM0,$Ln._corners[7]),$LEi.scale($L_,-1,$Ln._boxBound1.min),$L_.cloneTo($Ln._boxBound1.max),$LMr.createfromPoints($Ln._corners,$Ln._boxBound2),$LMr.merge($Ln._boxBound2,$Ln._boxBound1,$Ln._boxBound3);var $Lf=$Ln._boxBound3.min,$LE=$Ln._boxBound3.max;$LEi.subtract($LE,$Lf,$Ln._tempV30),$LEi.scale($Ln._tempV30,.5,$Ln._tempV30),$LEi.add($Lf,$Ln._tempV30,$Ln._tempV32),$LEi.subtract($LE,$Ln._tempV32,$L_),$LEi.transformCoordinate($Ln._tempV32,$LA,$Ln._tempV33)},$LR($Ln,["_tempV30",function(){return this._tempV30=new $LEi},"_tempV31",function(){return this._tempV31=new $LEi},"_tempV32",function(){return this._tempV32=new $LEi},"_tempV33",function(){return this._tempV33=new $LEi},"_tempV34",function(){return this._tempV34=new $LEi},"_tempV35",function(){return this._tempV35=new $LEi},"_tempV36",function(){return this._tempV36=new $LEi},"_tempM0",function(){return this._tempM0=new $Lri},"_tempM1",function(){return this._tempM1=new $Lri},"_corners",function(){return this._corners=[new $LEi,new $LEi,new $LEi,new $LEi,new $LEi,new $LEi,new $LEi,new $LEi]},"_rows1",function(){return this._rows1=[new $LEi,new $LEi,new $LEi]},"_rows2",function(){return this._rows2=[new $LEi,new $LEi,new $LEi]},"_ray",function(){return this._ray=new $LAi(new $LEi,new $LEi)},"_boxBound1",function(){return this._boxBound1=new $LMr(new $LEi,new $LEi)},"_boxBound2",function(){return this._boxBound2=new $LMr(new $LEi,new $LEi)},"_boxBound3",function(){return this._boxBound3=new $LMr(new $LEi,new $LEi)}])}(),function(){function $LD($Lr,$Li){this.normal=null,this.distance=NaN,void 0===$Li&&($Li=0),this.normal=$Lr,this.distance=$Li}return $Lv($LD,"laya.d3.math.Plane"),$LD.prototype.normalize=function(){var $Lr=this.normal.elements,$Li=$Lr[0],$Lt=$Lr[1],$L_=$Lr[2],$LA=1/Math.sqrt($Li*$Li+$Lt*$Lt+$L_*$L_);$Lr[0]=$Li*$LA,$Lr[1]=$Lt*$LA,$Lr[2]=$L_*$LA,this.distance*=$LA},$LD.createPlaneBy3P=function($Lr,$Li,$Lt){var $L_=$Lr.elements,$LA=$Li.elements,$Lf=$Lt.elements,$LE=$LA[0]-$L_[0],$LG=$LA[1]-$L_[1],$LN=$LA[2]-$L_[2],$Lp=$Lf[0]-$L_[0],$Lg=$Lf[1]-$L_[1],$LR=$Lf[2]-$L_[2],$LX=$LG*$LR-$LN*$Lg,$Lv=$LN*$Lp-$LE*$LR,$LO=$LE*$Lg-$LG*$Lp,$Lc=1/Math.sqrt($LX*$LX+$Lv*$Lv+$LO*$LO),$LB=$LX*$Lc,$Ly=$Lv*$Lc,$LC=$LO*$Lc,$Ln=$LD._TEMPVec3.elements;$Ln[0]=$LB,$Ln[1]=$Ly,$Ln[2]=$LC;var $La=-($LB*$L_[0]+$Ly*$L_[1]+$LC*$L_[2]);return new $LD($LD._TEMPVec3,$La)},$LD.PlaneIntersectionType_Back=0,$LD.PlaneIntersectionType_Front=1,$LD.PlaneIntersectionType_Intersecting=2,$LR($LD,["_TEMPVec3",function(){return this._TEMPVec3=new $LEi}]),$LD}()),$Lti=function(){function $LA($Lr,$Li,$Lt,$L_){this.elements=new Float32Array(4),void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=1),this.elements[0]=$Lr,this.elements[1]=$Li,this.elements[2]=$Lt,this.elements[3]=$L_}$Lv($LA,"laya.d3.math.Quaternion");var $Lr=$LA.prototype;return $LD.imps($Lr,{"laya.d3.core.IClone":!0}),$Lr.scaling=function($Lr,$Li){var $Lt=$Li.elements,$L_=this.elements;$Lt[0]=$L_[0]*$Lr,$Lt[1]=$L_[1]*$Lr,$Lt[2]=$L_[2]*$Lr,$Lt[3]=$L_[3]*$Lr},$Lr.normalize=function($Lr){var $Li=$Lr.elements,$Lt=this.elements,$L_=$Lt[0],$LA=$Lt[1],$Lf=$Lt[2],$LE=$Lt[3],$LG=$L_*$L_+$LA*$LA+$Lf*$Lf+$LE*$LE;0<$LG&&($LG=1/Math.sqrt($LG),$Li[0]=$L_*$LG,$Li[1]=$LA*$LG,$Li[2]=$Lf*$LG,$Li[3]=$LE*$LG)},$Lr.length=function(){var $Lr=this.elements,$Li=$Lr[0],$Lt=$Lr[1],$L_=$Lr[2],$LA=$Lr[3];return Math.sqrt($Li*$Li+$Lt*$Lt+$L_*$L_+$LA*$LA)},$Lr.rotateX=function($Lr,$Li){var $Lt=$Li.elements,$L_=this.elements;$Lr*=.5;var $LA=$L_[0],$Lf=$L_[1],$LE=$L_[2],$LG=$L_[3],$LN=Math.sin($Lr),$Lp=Math.cos($Lr);$Lt[0]=$LA*$Lp+$LG*$LN,$Lt[1]=$Lf*$Lp+$LE*$LN,$Lt[2]=$LE*$Lp-$Lf*$LN,$Lt[3]=$LG*$Lp-$LA*$LN},$Lr.rotateY=function($Lr,$Li){var $Lt=$Li.elements,$L_=this.elements;$Lr*=.5;var $LA=$L_[0],$Lf=$L_[1],$LE=$L_[2],$LG=$L_[3],$LN=Math.sin($Lr),$Lp=Math.cos($Lr);$Lt[0]=$LA*$Lp-$LE*$LN,$Lt[1]=$Lf*$Lp+$LG*$LN,$Lt[2]=$LE*$Lp+$LA*$LN,$Lt[3]=$LG*$Lp-$Lf*$LN},$Lr.rotateZ=function($Lr,$Li){var $Lt=$Li.elements,$L_=this.elements;$Lr*=.5;var $LA=$L_[0],$Lf=$L_[1],$LE=$L_[2],$LG=$L_[3],$LN=Math.sin($Lr),$Lp=Math.cos($Lr);$Lt[0]=$LA*$Lp+$Lf*$LN,$Lt[1]=$Lf*$Lp-$LA*$LN,$Lt[2]=$LE*$Lp+$LG*$LN,$Lt[3]=$LG*$Lp-$LE*$LN},$Lr.getYawPitchRoll=function($Lr){$LEi.transformQuat($LEi.ForwardRH,this,$LA.TEMPVector31),$LEi.transformQuat($LEi.Up,this,$LA.TEMPVector32);var $Li=$LA.TEMPVector32.elements;$LA.angleTo($LEi.ZERO,$LA.TEMPVector31,$LA.TEMPVector33);var $Lt=$LA.TEMPVector33.elements;$Lt[0]==Math.PI/2?($Lt[1]=$LA.arcTanAngle($Li[2],$Li[0]),$Lt[2]=0):$Lt[0]==-Math.PI/2?($Lt[1]=$LA.arcTanAngle(-$Li[2],-$Li[0]),$Lt[2]=0):($Lri.createRotationY(-$Lt[1],$LA.TEMPMatrix0),$Lri.createRotationX(-$Lt[0],$LA.TEMPMatrix1),$LEi.transformCoordinate($LA.TEMPVector32,$LA.TEMPMatrix0,$LA.TEMPVector32),$LEi.transformCoordinate($LA.TEMPVector32,$LA.TEMPMatrix1,$LA.TEMPVector32),$Lt[2]=$LA.arcTanAngle($Li[1],-$Li[0])),$Lt[1]<=-Math.PI&&($Lt[1]=Math.PI),$Lt[2]<=-Math.PI&&($Lt[2]=Math.PI),$Lt[1]>=Math.PI&&$Lt[2]>=Math.PI&&($Lt[1]=0,$Lt[2]=0,$Lt[0]=Math.PI-$Lt[0]);var $L_=$Lr.elements;$L_[0]=$Lt[1],$L_[1]=$Lt[0],$L_[2]=$Lt[2]},$Lr.invert=function($Lr){var $Li=$Lr.elements,$Lt=this.elements,$L_=$Lt[0],$LA=$Lt[1],$Lf=$Lt[2],$LE=$Lt[3],$LG=$L_*$L_+$LA*$LA+$Lf*$Lf+$LE*$LE,$LN=$LG?1/$LG:0;$Li[0]=-$L_*$LN,$Li[1]=-$LA*$LN,$Li[2]=-$Lf*$LN,$Li[3]=$LE*$LN},$Lr.identity=function(){var $Lr=this.elements;$Lr[0]=0,$Lr[1]=0,$Lr[2]=0,$Lr[3]=1},$Lr.fromArray=function($Lr,$Li){void 0===$Li&&($Li=0),this.elements[0]=$Lr[$Li+0],this.elements[1]=$Lr[$Li+1],this.elements[2]=$Lr[$Li+2],this.elements[3]=$Lr[$Li+3]},$Lr.cloneTo=function($Lr){var $Li,$Lt,$L_;if(($Lt=this.elements)!==($L_=$Lr.elements))for($Li=0;$Li<4;++$Li)$L_[$Li]=$Lt[$Li]},$Lr.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$Lr.equals=function($Lr){var $Li=this.elements,$Lt=$Lr.elements;return $LYr.nearEqual($Li[0],$Lt[0])&&$LYr.nearEqual($Li[1],$Lt[1])&&$LYr.nearEqual($Li[2],$Lt[2])&&$LYr.nearEqual($Li[3],$Lt[3])},$Lr.lengthSquared=function(){var $Lr=this.elements[0],$Li=this.elements[1],$Lt=this.elements[2],$L_=this.elements[3];return $Lr*$Lr+$Li*$Li+$Lt*$Lt+$L_*$L_},$LO(0,$Lr,"x",function(){return this.elements[0]}),$LO(0,$Lr,"y",function(){return this.elements[1]}),$LO(0,$Lr,"z",function(){return this.elements[2]}),$LO(0,$Lr,"w",function(){return this.elements[3]}),$LA.createFromYawPitchRoll=function($Lr,$Li,$Lt,$L_){var $LA=.5*$Lt,$Lf=.5*$Li,$LE=.5*$Lr,$LG=Math.sin($LA),$LN=Math.cos($LA),$Lp=Math.sin($Lf),$Lg=Math.cos($Lf),$LR=Math.sin($LE),$LX=Math.cos($LE),$Lv=$L_.elements;$Lv[0]=$LX*$Lp*$LN+$LR*$Lg*$LG,$Lv[1]=$LR*$Lg*$LN-$LX*$Lp*$LG,$Lv[2]=$LX*$Lg*$LG-$LR*$Lp*$LN,$Lv[3]=$LX*$Lg*$LN+$LR*$Lp*$LG},$LA.multiply=function($Lr,$Li,$Lt){var $L_=$Lr.elements,$LA=$Li.elements,$Lf=$Lt.elements,$LE=$L_[0],$LG=$L_[1],$LN=$L_[2],$Lp=$L_[3],$Lg=$LA[0],$LR=$LA[1],$LX=$LA[2],$Lv=$LA[3],$LO=$LG*$LX-$LN*$LR,$Lc=$LN*$Lg-$LE*$LX,$LB=$LE*$LR-$LG*$Lg,$Ly=$LE*$Lg+$LG*$LR+$LN*$LX;$Lf[0]=$LE*$Lv+$Lg*$Lp+$LO,$Lf[1]=$LG*$Lv+$LR*$Lp+$Lc,$Lf[2]=$LN*$Lv+$LX*$Lp+$LB,$Lf[3]=$Lp*$Lv-$Ly},$LA.arcTanAngle=function($Lr,$Li){return 0==$Lr?1==$Li?Math.PI/2:-Math.PI/2:0<$Lr?Math.atan($Li/$Lr):$Lr<0?0<$Li?Math.atan($Li/$Lr)+Math.PI:Math.atan($Li/$Lr)-Math.PI:0},$LA.angleTo=function($Lr,$Li,$Lt){$LEi.subtract($Li,$Lr,$LA.TEMPVector30),$LEi.normalize($LA.TEMPVector30,$LA.TEMPVector30),$Lt.elements[0]=Math.asin($LA.TEMPVector30.y),$Lt.elements[1]=$LA.arcTanAngle(-$LA.TEMPVector30.z,-$LA.TEMPVector30.x)},$LA.createFromAxisAngle=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements;$Li*=.5;var $Lf=Math.sin($Li);$L_[0]=$Lf*$LA[0],$L_[1]=$Lf*$LA[1],$L_[2]=$Lf*$LA[2],$L_[3]=Math.cos($Li)},$LA.createFromMatrix3x3=function($Lr,$Li){var $Lt,$L_=$Li.elements,$LA=$Lr.elements,$Lf=$LA[0]+$LA[4]+$LA[8];if(0<$Lf)$Lt=Math.sqrt($Lf+1),$L_[3]=.5*$Lt,$Lt=.5/$Lt,$L_[0]=($LA[5]-$LA[7])*$Lt,$L_[1]=($LA[6]-$LA[2])*$Lt,$L_[2]=($LA[1]-$LA[3])*$Lt;else{var $LE=0;$LA[4]>$LA[0]&&($LE=1),$LA[8]>$LA[3*$LE+$LE]&&($LE=2);var $LG=($LE+1)%3,$LN=($LE+2)%3;$Lt=Math.sqrt($LA[3*$LE+$LE]-$LA[3*$LG+$LG]-$LA[3*$LN+$LN]+1),$L_[$LE]=.5*$Lt,$Lt=.5/$Lt,$L_[3]=($LA[3*$LG+$LN]-$LA[3*$LN+$LG])*$Lt,$L_[$LG]=($LA[3*$LG+$LE]+$LA[3*$LE+$LG])*$Lt,$L_[$LN]=($LA[3*$LN+$LE]+$LA[3*$LE+$LN])*$Lt}},$LA.createFromMatrix4x4=function($Lr,$Li){var $Lt,$L_,$LA=$Lr.elements,$Lf=$Li.elements,$LE=$LA[0]+$LA[5]+$LA[10];0<$LE?($Lt=Math.sqrt($LE+1),$Lf[3]=.5*$Lt,$Lt=.5/$Lt,$Lf[0]=($LA[6]-$LA[9])*$Lt,$Lf[1]=($LA[8]-$LA[2])*$Lt,$Lf[2]=($LA[1]-$LA[4])*$Lt):$LA[0]>=$LA[5]&&$LA[0]>=$LA[10]?($L_=.5/($Lt=Math.sqrt(1+$LA[0]-$LA[5]-$LA[10])),$Lf[0]=.5*$Lt,$Lf[1]=($LA[1]+$LA[4])*$L_,$Lf[2]=($LA[2]+$LA[8])*$L_,$Lf[3]=($LA[6]-$LA[9])*$L_):$LA[5]>$LA[10]?($L_=.5/($Lt=Math.sqrt(1+$LA[5]-$LA[0]-$LA[10])),$Lf[0]=($LA[4]+$LA[1])*$L_,$Lf[1]=.5*$Lt,$Lf[2]=($LA[9]+$LA[6])*$L_,$Lf[3]=($LA[8]-$LA[2])*$L_):($L_=.5/($Lt=Math.sqrt(1+$LA[10]-$LA[0]-$LA[5])),$Lf[0]=($LA[8]+$LA[2])*$L_,$Lf[1]=($LA[9]+$LA[6])*$L_,$Lf[2]=.5*$Lt,$Lf[3]=($LA[1]-$LA[4])*$L_)},$LA.slerp=function($Lr,$Li,$Lt,$L_){var $LA,$Lf,$LE,$LG,$LN,$Lp=$Lr.elements,$Lg=$Li.elements,$LR=$L_.elements,$LX=$Lp[0],$Lv=$Lp[1],$LO=$Lp[2],$Lc=$Lp[3],$LB=$Lg[0],$Ly=$Lg[1],$LC=$Lg[2],$Ln=$Lg[3];return($Lf=$LX*$LB+$Lv*$Ly+$LO*$LC+$Lc*$Ln)<0&&($Lf=-$Lf,$LB=-$LB,$Ly=-$Ly,$LC=-$LC,$Ln=-$Ln),$LN=1e-6<1-$Lf?($LA=Math.acos($Lf),$LE=Math.sin($LA),$LG=Math.sin((1-$Lt)*$LA)/$LE,Math.sin($Lt*$LA)/$LE):($LG=1-$Lt,$Lt),$LR[0]=$LG*$LX+$LN*$LB,$LR[1]=$LG*$Lv+$LN*$Ly,$LR[2]=$LG*$LO+$LN*$LC,$LR[3]=$LG*$Lc+$LN*$Ln,$LR},$LA.lerp=function($Lr,$Li,$Lt,$L_){var $LA=$L_.elements,$Lf=$Lr.elements,$LE=$Li.elements,$LG=$Lf[0],$LN=$Lf[1],$Lp=$Lf[2],$Lg=$Lf[3];$LA[0]=$LG+$Lt*($LE[0]-$LG),$LA[1]=$LN+$Lt*($LE[1]-$LN),$LA[2]=$Lp+$Lt*($LE[2]-$Lp),$LA[3]=$Lg+$Lt*($LE[3]-$Lg)},$LA.add=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements;$L_[0]=$LA[0]+$Lf[0],$L_[1]=$LA[1]+$Lf[1],$L_[2]=$LA[2]+$Lf[2],$L_[3]=$LA[3]+$Lf[3]},$LA.dot=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements;return $Lt[0]*$L_[0]+$Lt[1]*$L_[1]+$Lt[2]*$L_[2]+$Lt[3]*$L_[3]},$LA.rotationLookAt=function($Lr,$Li,$Lt){$LA.lookAt($LEi.ZERO,$Lr,$Li,$Lt)},$LA.lookAt=function($Lr,$Li,$Lt,$L_){$Ljr.lookAt($Lr,$Li,$Lt,$LA._tempMatrix3x3),$LA.rotationMatrix($LA._tempMatrix3x3,$L_)},$LA.invert=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements,$LA=$Lr.lengthSquared();$LYr.isZero($LA)||($LA=1/$LA,$L_[0]=-$Lt[0]*$LA,$L_[1]=-$Lt[1]*$LA,$L_[2]=-$Lt[2]*$LA,$L_[3]=$Lt[3]*$LA)},$LA.rotationMatrix=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Lt[0],$LA=$Lt[1],$Lf=$Lt[2],$LE=$Lt[3],$LG=$Lt[4],$LN=$Lt[5],$Lp=$Lt[6],$Lg=$Lt[7],$LR=$Lt[8],$LX=$Li.elements,$Lv=NaN,$LO=NaN,$Lc=$L_+$LG+$LR;0<$Lc?($Lv=Math.sqrt($Lc+1),$LX[3]=.5*$Lv,$Lv=.5/$Lv,$LX[0]=($LN-$Lg)*$Lv,$LX[1]=($Lp-$Lf)*$Lv,$LX[2]=($LA-$LE)*$Lv):$LG<=$L_&&$LR<=$L_?($LO=.5/($Lv=Math.sqrt(1+$L_-$LG-$LR)),$LX[0]=.5*$Lv,$LX[1]=($LA+$LE)*$LO,$LX[2]=($Lf+$Lp)*$LO,$LX[3]=($LN-$Lg)*$LO):$LR<$LG?($LO=.5/($Lv=Math.sqrt(1+$LG-$L_-$LR)),$LX[0]=($LE+$LA)*$LO,$LX[1]=.5*$Lv,$LX[2]=($Lg+$LN)*$LO,$LX[3]=($Lp-$Lf)*$LO):($LO=.5/($Lv=Math.sqrt(1+$LR-$L_-$LG)),$LX[0]=($Lp+$Lf)*$LO,$LX[1]=($Lg+$LN)*$LO,$LX[2]=.5*$Lv,$LX[3]=($LA-$LE)*$LO)},$LA.DEFAULT=new $LA,$LR($LA,["TEMPVector30",function(){return this.TEMPVector30=new $LEi},"TEMPVector31",function(){return this.TEMPVector31=new $LEi},"TEMPVector32",function(){return this.TEMPVector32=new $LEi},"TEMPVector33",function(){return this.TEMPVector33=new $LEi},"TEMPMatrix0",function(){return this.TEMPMatrix0=new $Lri},"TEMPMatrix1",function(){return this.TEMPMatrix1=new $Lri},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new $Ljr},"NAN",function(){return this.NAN=new $LA(NaN,NaN,NaN,NaN)}]),$LA}(),$L_i=function(){function $Lr($Lr){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=$Lr,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}$Lv($Lr,"laya.d3.math.Rand");var $Li=$Lr.prototype;return $Li.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},$Li.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},$Li.getSignedFloat=function(){return 2*this.getFloat()-1},$LO(0,$Li,"seed",function(){return this.seeds[0]},function($Lr){this.seeds[0]=$Lr,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),$Lr.getFloatFromInt=function($Lr){return 1/8388607*(8388607&$Lr)},$Lr.getByteFromInt=function($Lr){return(8388607&$Lr)>>>15},$Lr}(),$LAi=(function(){function $LA($Lr){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!($Lr instanceof Array)||4!==$Lr.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|$Lr[0],this._state0L=0|$Lr[1],this._state1U=0|$Lr[2],this._state1L=0|$Lr[3]}$Lv($LA,"laya.d3.math.RandX");var $Lr=$LA.prototype;$Lr.randomint=function(){var $Lr=this._state0U,$Li=this._state0L,$Lt=this._state1U,$L_=this._state1L,$LA=($L_>>>0)+($Li>>>0),$Lf=$Lt+$Lr+($LA/2>>>31)>>>0,$LE=$LA>>>0,$LG=0,$LN=0;$LG=($Lr^=$LG=$Lr<<23|(-512&$Li)>>>9)^(this._state0U=$Lt),$LN=($Li^=$LN=$Li<<23)^(this._state0L=$L_);$LG^=$Lr>>>18,$LN^=$Li>>>18|(262143&$Lr)<<14;return $LG^=$Lt>>>5,$LN^=$L_>>>5|(31&$Lt)<<27,this._state1U=$LG,this._state1L=$LN,[$Lf,$LE]},$Lr.random=function(){var $Lr=this.randomint(),$Li=$Lr[0],$Lt=1023<<20|$Li>>>12,$L_=0|($Lr[1]>>>12|(4095&$Li)<<20);return $LA._CONVERTION_BUFFER.setUint32(0,$Lt,!1),$LA._CONVERTION_BUFFER.setUint32(4,$L_,!1),$L_i._CONVERTION_BUFFER.getFloat64(0,!1)-1},$LR($LA,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new $L_i([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function $Lr($Lr,$Li){this.origin=null,this.direction=null,this.origin=$Lr,this.direction=$Li}return $Lv($Lr,"laya.d3.math.Ray"),$Lr}()),$Lfi=function(){function $Lr($Lr,$Li){this.elements=new Float32Array(2),void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0);var $Lt=this.elements;$Lt[0]=$Lr,$Lt[1]=$Li}$Lv($Lr,"laya.d3.math.Vector2");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li.fromArray=function($Lr,$Li){void 0===$Li&&($Li=0),this.elements[0]=$Lr[$Li+0],this.elements[1]=$Lr[$Li+1]},$Li.cloneTo=function($Lr){var $Li=$Lr.elements,$Lt=this.elements;$Li[0]=$Lt[0],$Li[1]=$Lt[1]},$Li.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Li,"x",function(){return this.elements[0]},function($Lr){this.elements[0]=$Lr}),$LO(0,$Li,"y",function(){return this.elements[1]},function($Lr){this.elements[1]=$Lr}),$Lr.scale=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements;$L_[0]=$LA[0]*$Li,$L_[1]=$LA[1]*$Li},$LR($Lr,["ZERO",function(){return this.ZERO=new $Lr(0,0)},"ONE",function(){return this.ONE=new $Lr(1,1)}]),$Lr}(),$LEi=function(){function $Lg($Lr,$Li,$Lt){this.elements=new Float32Array(3),void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0);var $L_=this.elements;$L_[0]=$Lr,$L_[1]=$Li,$L_[2]=$Lt}$Lv($Lg,"laya.d3.math.Vector3");var $Lr=$Lg.prototype;return $LD.imps($Lr,{"laya.d3.core.IClone":!0}),$Lr.fromArray=function($Lr,$Li){void 0===$Li&&($Li=0),this.elements[0]=$Lr[$Li+0],this.elements[1]=$Lr[$Li+1],this.elements[2]=$Lr[$Li+2]},$Lr.cloneTo=function($Lr){var $Li=$Lr.elements,$Lt=this.elements;$Li[0]=$Lt[0],$Li[1]=$Lt[1],$Li[2]=$Lt[2]},$Lr.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$Lr.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},$Lr.reset=function($Lr,$Li,$Lt){this.elements[0]=$Lr,this.elements[1]=$Li,this.elements[2]=$Lt},$LO(0,$Lr,"x",function(){return this.elements[0]},function($Lr){this.elements[0]=$Lr}),$LO(0,$Lr,"y",function(){return this.elements[1]},function($Lr){this.elements[1]=$Lr}),$LO(0,$Lr,"z",function(){return this.elements[2]},function($Lr){this.elements[2]=$Lr}),$Lg.distanceSquared=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements,$LA=$Lt[0]-$L_[0],$Lf=$Lt[1]-$L_[1],$LE=$Lt[2]-$L_[2];return $LA*$LA+$Lf*$Lf+$LE*$LE},$Lg.distance=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements,$LA=$Lt[0]-$L_[0],$Lf=$Lt[1]-$L_[1],$LE=$Lt[2]-$L_[2];return Math.sqrt($LA*$LA+$Lf*$Lf+$LE*$LE)},$Lg.min=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements;$L_[0]=Math.min($LA[0],$Lf[0]),$L_[1]=Math.min($LA[1],$Lf[1]),$L_[2]=Math.min($LA[2],$Lf[2])},$Lg.max=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements;$L_[0]=Math.max($LA[0],$Lf[0]),$L_[1]=Math.max($LA[1],$Lf[1]),$L_[2]=Math.max($LA[2],$Lf[2])},$Lg.transformQuat=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements,$LE=$LA[0],$LG=$LA[1],$LN=$LA[2],$Lp=$Lf[0],$Lg=$Lf[1],$LR=$Lf[2],$LX=$Lf[3],$Lv=$LX*$LE+$Lg*$LN-$LR*$LG,$LO=$LX*$LG+$LR*$LE-$Lp*$LN,$Lc=$LX*$LN+$Lp*$LG-$Lg*$LE,$LB=-$Lp*$LE-$Lg*$LG-$LR*$LN;$L_[0]=$Lv*$LX+$LB*-$Lp+$LO*-$LR-$Lc*-$Lg,$L_[1]=$LO*$LX+$LB*-$Lg+$Lc*-$Lp-$Lv*-$LR,$L_[2]=$Lc*$LX+$LB*-$LR+$Lv*-$Lg-$LO*-$Lp},$Lg.scalarLength=function($Lr){var $Li=$Lr.elements,$Lt=$Li[0],$L_=$Li[1],$LA=$Li[2];return Math.sqrt($Lt*$Lt+$L_*$L_+$LA*$LA)},$Lg.scalarLengthSquared=function($Lr){var $Li=$Lr.elements,$Lt=$Li[0],$L_=$Li[1],$LA=$Li[2];return $Lt*$Lt+$L_*$L_+$LA*$LA},$Lg.normalize=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements,$LA=$Lt[0],$Lf=$Lt[1],$LE=$Lt[2],$LG=$LA*$LA+$Lf*$Lf+$LE*$LE;0<$LG&&($LG=1/Math.sqrt($LG),$L_[0]=$Lt[0]*$LG,$L_[1]=$Lt[1]*$LG,$L_[2]=$Lt[2]*$LG)},$Lg.multiply=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements;$L_[0]=$LA[0]*$Lf[0],$L_[1]=$LA[1]*$Lf[1],$L_[2]=$LA[2]*$Lf[2]},$Lg.scale=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements;$L_[0]=$LA[0]*$Li,$L_[1]=$LA[1]*$Li,$L_[2]=$LA[2]*$Li},$Lg.lerp=function($Lr,$Li,$Lt,$L_){var $LA=$L_.elements,$Lf=$Lr.elements,$LE=$Li.elements,$LG=$Lf[0],$LN=$Lf[1],$Lp=$Lf[2];$LA[0]=$LG+$Lt*($LE[0]-$LG),$LA[1]=$LN+$Lt*($LE[1]-$LN),$LA[2]=$Lp+$Lt*($LE[2]-$Lp)},$Lg.transformV3ToV3=function($Lr,$Li,$Lt){var $L_=$Lg._tempVector4;$Lg.transformV3ToV4($Lr,$Li,$L_);var $LA=$L_.elements,$Lf=$Lt.elements;$Lf[0]=$LA[0],$Lf[1]=$LA[1],$Lf[2]=$LA[2]},$Lg.transformV3ToV4=function($Lr,$Li,$Lt){var $L_=$Lr.elements,$LA=$L_[0],$Lf=$L_[1],$LE=$L_[2],$LG=$Li.elements,$LN=$Lt.elements;$LN[0]=$LA*$LG[0]+$Lf*$LG[4]+$LE*$LG[8]+$LG[12],$LN[1]=$LA*$LG[1]+$Lf*$LG[5]+$LE*$LG[9]+$LG[13],$LN[2]=$LA*$LG[2]+$Lf*$LG[6]+$LE*$LG[10]+$LG[14],$LN[3]=$LA*$LG[3]+$Lf*$LG[7]+$LE*$LG[11]+$LG[15]},$Lg.TransformNormal=function($Lr,$Li,$Lt){var $L_=$Lr.elements,$LA=$L_[0],$Lf=$L_[1],$LE=$L_[2],$LG=$Li.elements,$LN=$Lt.elements;$LN[0]=$LA*$LG[0]+$Lf*$LG[4]+$LE*$LG[8],$LN[1]=$LA*$LG[1]+$Lf*$LG[5]+$LE*$LG[9],$LN[2]=$LA*$LG[2]+$Lf*$LG[6]+$LE*$LG[10]},$Lg.transformCoordinate=function($Lr,$Li,$Lt){var $L_=$Lg._tempVector4.elements,$LA=$Lr.elements,$Lf=$LA[0],$LE=$LA[1],$LG=$LA[2],$LN=$Li.elements;$L_[0]=$Lf*$LN[0]+$LE*$LN[4]+$LG*$LN[8]+$LN[12],$L_[1]=$Lf*$LN[1]+$LE*$LN[5]+$LG*$LN[9]+$LN[13],$L_[2]=$Lf*$LN[2]+$LE*$LN[6]+$LG*$LN[10]+$LN[14],$L_[3]=1/($Lf*$LN[3]+$LE*$LN[7]+$LG*$LN[11]+$LN[15]);var $Lp=$Lt.elements;$Lp[0]=$L_[0]*$L_[3],$Lp[1]=$L_[1]*$L_[3],$Lp[2]=$L_[2]*$L_[3]},$Lg.Clamp=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.elements,$Lf=$LA[0],$LE=$LA[1],$LG=$LA[2],$LN=$Li.elements,$Lp=$LN[0],$Lg=$LN[1],$LR=$LN[2],$LX=$Lt.elements,$Lv=$LX[0],$LO=$LX[1],$Lc=$LX[2],$LB=$L_.elements;$Lf=($Lf=$Lv<$Lf?$Lv:$Lf)<$Lp?$Lp:$Lf,$LE=($LE=$LO<$LE?$LO:$LE)<$Lg?$Lg:$LE,$LG=($LG=$Lc<$LG?$Lc:$LG)<$LR?$LR:$LG,$LB[0]=$Lf,$LB[1]=$LE,$LB[2]=$LG},$Lg.add=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements;$L_[0]=$LA[0]+$Lf[0],$L_[1]=$LA[1]+$Lf[1],$L_[2]=$LA[2]+$Lf[2]},$Lg.subtract=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements;$L_[0]=$LA[0]-$Lf[0],$L_[1]=$LA[1]-$Lf[1],$L_[2]=$LA[2]-$Lf[2]},$Lg.cross=function($Lr,$Li,$Lt){var $L_=$Lr.elements,$LA=$Li.elements,$Lf=$Lt.elements,$LE=$L_[0],$LG=$L_[1],$LN=$L_[2],$Lp=$LA[0],$Lg=$LA[1],$LR=$LA[2];$Lf[0]=$LG*$LR-$LN*$Lg,$Lf[1]=$LN*$Lp-$LE*$LR,$Lf[2]=$LE*$Lg-$LG*$Lp},$Lg.dot=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements;return $Lt[0]*$L_[0]+$Lt[1]*$L_[1]+$Lt[2]*$L_[2]},$Lg.equals=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements;return $LYr.nearEqual(Math.abs($Lt[0]),Math.abs($L_[0]))&&$LYr.nearEqual(Math.abs($Lt[1]),Math.abs($L_[1]))&&$LYr.nearEqual(Math.abs($Lt[2]),Math.abs($L_[2]))},$Lg.ZERO=new $Lg(0,0,0),$Lg.ONE=new $Lg(1,1,1),$Lg.NegativeUnitX=new $Lg(-1,0,0),$Lg.UnitX=new $Lg(1,0,0),$Lg.UnitY=new $Lg(0,1,0),$Lg.UnitZ=new $Lg(0,0,1),$Lg.ForwardRH=new $Lg(0,0,-1),$Lg.ForwardLH=new $Lg(0,0,1),$Lg.Up=new $Lg(0,1,0),$Lg.NAN=new $Lg(NaN,NaN,NaN),$LR($Lg,["_tempVector4",function(){return this._tempVector4=new $LGi}]),$Lg}(),$LGi=function(){function $Lr($Lr,$Li,$Lt,$L_){this.elements=new Float32Array(4),void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=0);var $LA=this.elements;$LA[0]=$Lr,$LA[1]=$Li,$LA[2]=$Lt,$LA[3]=$L_}$Lv($Lr,"laya.d3.math.Vector4");var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li.fromArray=function($Lr,$Li){void 0===$Li&&($Li=0),this.elements[0]=$Lr[$Li+0],this.elements[1]=$Lr[$Li+1],this.elements[2]=$Lr[$Li+2],this.elements[3]=$Lr[$Li+3]},$Li.cloneTo=function($Lr){var $Li=$Lr.elements,$Lt=this.elements;$Li[0]=$Lt[0],$Li[1]=$Lt[1],$Li[2]=$Lt[2],$Li[3]=$Lt[3]},$Li.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$Li.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},$Li.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},$LO(0,$Li,"x",function(){return this.elements[0]},function($Lr){this.elements[0]=$Lr}),$LO(0,$Li,"y",function(){return this.elements[1]},function($Lr){this.elements[1]=$Lr}),$LO(0,$Li,"z",function(){return this.elements[2]},function($Lr){this.elements[2]=$Lr}),$LO(0,$Li,"w",function(){return this.elements[3]},function($Lr){this.elements[3]=$Lr}),$Lr.lerp=function($Lr,$Li,$Lt,$L_){var $LA=$L_.elements,$Lf=$Lr.elements,$LE=$Li.elements,$LG=$Lf[0],$LN=$Lf[1],$Lp=$Lf[2],$Lg=$Lf[3];$LA[0]=$LG+$Lt*($LE[0]-$LG),$LA[1]=$LN+$Lt*($LE[1]-$LN),$LA[2]=$Lp+$Lt*($LE[2]-$Lp),$LA[3]=$Lg+$Lt*($LE[3]-$Lg)},$Lr.transformByM4x4=function($Lr,$Li,$Lt){var $L_=$Lr.elements,$LA=$L_[0],$Lf=$L_[1],$LE=$L_[2],$LG=$L_[3],$LN=$Li.elements,$Lp=$Lt.elements;$Lp[0]=$LA*$LN[0]+$Lf*$LN[4]+$LE*$LN[8]+$LG*$LN[12],$Lp[1]=$LA*$LN[1]+$Lf*$LN[5]+$LE*$LN[9]+$LG*$LN[13],$Lp[2]=$LA*$LN[2]+$Lf*$LN[6]+$LE*$LN[10]+$LG*$LN[14],$Lp[3]=$LA*$LN[3]+$Lf*$LN[7]+$LE*$LN[11]+$LG*$LN[15]},$Lr.equals=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements;return $LYr.nearEqual(Math.abs($Lt[0]),Math.abs($L_[0]))&&$LYr.nearEqual(Math.abs($Lt[1]),Math.abs($L_[1]))&&$LYr.nearEqual(Math.abs($Lt[2]),Math.abs($L_[2]))&&$LYr.nearEqual(Math.abs($Lt[3]),Math.abs($L_[3]))},$Lr.normalize=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements,$LA=$Lr.length();0<$LA&&($L_[0]=$Lt[0]*$LA,$L_[1]=$Lt[1]*$LA,$L_[2]=$Lt[2]*$LA,$L_[3]=$Lt[3]*$LA)},$Lr.add=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements;$L_[0]=$LA[0]+$Lf[0],$L_[1]=$LA[1]+$Lf[1],$L_[2]=$LA[2]+$Lf[2],$L_[3]=$LA[3]+$Lf[3]},$Lr.subtract=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements;$L_[0]=$LA[0]-$Lf[0],$L_[1]=$LA[1]-$Lf[1],$L_[2]=$LA[2]-$Lf[2],$L_[3]=$LA[3]-$Lf[3]},$Lr.multiply=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements;$L_[0]=$LA[0]*$Lf[0],$L_[1]=$LA[1]*$Lf[1],$L_[2]=$LA[2]*$Lf[2],$L_[3]=$LA[3]*$Lf[3]},$Lr.scale=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements;$L_[0]=$LA[0]*$Li,$L_[1]=$LA[1]*$Li,$L_[2]=$LA[2]*$Li,$L_[3]=$LA[3]*$Li},$Lr.Clamp=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.elements,$Lf=$LA[0],$LE=$LA[1],$LG=$LA[2],$LN=$LA[3],$Lp=$Li.elements,$Lg=$Lp[0],$LR=$Lp[1],$LX=$Lp[2],$Lv=$Lp[3],$LO=$Lt.elements,$Lc=$LO[0],$LB=$LO[1],$Ly=$LO[2],$LC=$LO[3],$Ln=$L_.elements;$Lf=($Lf=$Lc<$Lf?$Lc:$Lf)<$Lg?$Lg:$Lf,$LE=($LE=$LB<$LE?$LB:$LE)<$LR?$LR:$LE,$LG=($LG=$Ly<$LG?$Ly:$LG)<$LX?$LX:$LG,$LN=($LN=$LC<$LN?$LC:$LN)<$Lv?$Lv:$LN,$Ln[0]=$Lf,$Ln[1]=$LE,$Ln[2]=$LG,$Ln[3]=$LN},$Lr.distanceSquared=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements,$LA=$Lt[0]-$L_[0],$Lf=$Lt[1]-$L_[1],$LE=$Lt[2]-$L_[2],$LG=$Lt[3]-$L_[3];return $LA*$LA+$Lf*$Lf+$LE*$LE+$LG*$LG},$Lr.distance=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements,$LA=$Lt[0]-$L_[0],$Lf=$Lt[1]-$L_[1],$LE=$Lt[2]-$L_[2],$LG=$Lt[3]-$L_[3];return Math.sqrt($LA*$LA+$Lf*$Lf+$LE*$LE+$LG*$LG)},$Lr.dot=function($Lr,$Li){var $Lt=$Lr.elements,$L_=$Li.elements;return $Lt[0]*$L_[0]+$Lt[1]*$L_[1]+$Lt[2]*$L_[2]+$Lt[3]*$L_[3]},$Lr.min=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements;$L_[0]=Math.min($LA[0],$Lf[0]),$L_[1]=Math.min($LA[1],$Lf[1]),$L_[2]=Math.min($LA[2],$Lf[2]),$L_[3]=Math.min($LA[3],$Lf[3])},$Lr.max=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li.elements;$L_[0]=Math.max($LA[0],$Lf[0]),$L_[1]=Math.max($LA[1],$Lf[1]),$L_[2]=Math.max($LA[2],$Lf[2]),$L_[3]=Math.max($LA[3],$Lf[3])},$LR($Lr,["ZERO",function(){return this.ZERO=new $Lr},"ONE",function(){return this.ONE=new $Lr(1,1,1,1)},"UnitX",function(){return this.UnitX=new $Lr(1,0,0,0)},"UnitY",function(){return this.UnitY=new $Lr(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new $Lr(0,0,1,0)},"UnitW",function(){return this.UnitW=new $Lr(0,0,0,1)}]),$Lr}(),$LNi=function(){function $Lf($Lr,$Li,$Lt,$L_){this.minDepth=0,this.maxDepth=1,this.x=$Lr,this.y=$Li,this.width=$Lt,this.height=$L_}$Lv($Lf,"laya.d3.math.Viewport");var $Lr=$Lf.prototype;return $Lr.project=function($Lr,$Li,$Lt){$LEi.transformV3ToV3($Lr,$Li,$Lt);var $L_=$Lr.elements,$LA=$Li.elements,$Lf=$Lt.elements,$LE=$L_[0]*$LA[3]+$L_[1]*$LA[7]+$L_[2]*$LA[11]+$LA[15];1!==$LE&&($Lf[0]=$Lf[0]/$LE,$Lf[1]=$Lf[1]/$LE,$Lf[2]=$Lf[2]/$LE),$Lf[0]=.5*($Lf[0]+1)*this.width+this.x,$Lf[1]=.5*(1-$Lf[1])*this.height+this.y,$Lf[2]=$Lf[2]*(this.maxDepth-this.minDepth)+this.minDepth},$Lr.unprojectFromMat=function($Lr,$Li,$Lt){var $L_=$Lr.elements,$LA=$Li.elements,$Lf=$Lt.elements;$Lf[0]=($L_[0]-this.x)/this.width*2-1,$Lf[1]=-(($L_[1]-this.y)/this.height*2-1);var $LE=(this.maxDepth-this.minDepth)/2;$Lf[2]=($L_[2]-this.minDepth-$LE)/$LE;var $LG=$Lf[0]*$LA[3]+$Lf[1]*$LA[7]+$Lf[2]*$LA[11]+$LA[15];$LEi.transformV3ToV3($Lt,$Li,$Lt),1!==$LG&&($Lf[0]=$Lf[0]/$LG,$Lf[1]=$Lf[1]/$LG,$Lf[2]=$Lf[2]/$LG)},$Lr.unprojectFromWVP=function($Lr,$Li,$Lt,$L_,$LA){$Lri.multiply($Li,$Lt,$Lf._tempMatrix4x4),$L_&&$Lri.multiply($Lf._tempMatrix4x4,$L_,$Lf._tempMatrix4x4),$Lf._tempMatrix4x4.invert($Lf._tempMatrix4x4),this.unprojectFromMat($Lr,$Lf._tempMatrix4x4,$LA)},$LR($Lf,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $Lri}]),$Lf}(),$Lpi=function(){function $LU($Lr){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=$Lr,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}$Lv($LU,"laya.d3.resource.models.SubMesh");var $Lr=$LU.prototype;return $LD.imps($Lr,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$Lr._getVertexBuffer=function($Lr){return void 0===$Lr&&($Lr=0),0===$Lr?this._vertexBuffer:null},$Lr._getIndexBuffer=function(){return this._indexBuffer},$Lr._getStaticBatchBakedVertexs=function($Lr,$Li){var $Lt,$L_,$LA=this._vertexBuffer,$Lf=$LA.vertexDeclaration,$LE=$Lf.getVertexElementByUsage(0).offset/4,$LG=$Lf.getVertexElementByUsage(3).offset/4,$LN=$Li.meshRender.lightmapScaleOffset,$Lp=0,$Lg=0,$LR=0,$LX=0,$Lv=0,$LO=0;if($LN)if($L_=$Lf.getVertexElementByUsage(15))$LR=$Lf.vertexStride/4,$Lt=0<this._vertexCount?$LA.getData().slice(this._vertexStart*$LR,(this._vertexStart+this._vertexCount)*$LR):$LA.getData().slice(),$LX=$L_.offset/4;else{$LR=($LO=$Lf.vertexStride/4)+2,$Lt=this._vertexCount?new Float32Array(this._vertexCount*($LA.vertexDeclaration.vertexStride/4+2)):new Float32Array($LA.vertexCount*($LA.vertexDeclaration.vertexStride/4+2)),$LX=($Lv=$Lf.getVertexElementByUsage(2).offset/4)+2;var $Lc=$LA.getData();for($Lp=0,$Lg=$Lc.length/$LO;$Lp<$Lg;$Lp++){var $LB=0;$LB=0<this._vertexCount?(this._vertexStart+$Lp)*$LO:$Lp*$LO;var $Ly=$Lp*$LR,$LC=0;for($LC=0;$LC<$LX;$LC++)$Lt[$Ly+$LC]=$Lc[$LB+$LC];for($LC=$LX;$LC<$LO;$LC++)$Lt[$Ly+$LC+2]=$Lc[$LB+$LC]}}else $LR=$Lf.vertexStride/4,$Lt=this._vertexCount?$LA.getData().slice(this._vertexStart*$LR,(this._vertexStart+this._vertexCount)*$LR):$LA.getData().slice();if($Lr){var $Ln=$Lr.worldMatrix,$La=$LU._tempMatrix4x40;$Ln.invert($La);var $LD=$LU._tempMatrix4x41,$Lu=$Li.transform.worldMatrix;$Lri.multiply($La,$Lu,$LD)}else $LD=$Li.transform.worldMatrix;var $Lw=$LU._tempQuaternion0;for($LD.decomposeTransRotScale($LU._tempVector30,$Lw,$LU._tempVector31),$Lp=0,$Lg=$Lt.length/$LR;$Lp<$Lg;$Lp++){var $LH=$Lp*$LR+$LE,$Ls=$Lp*$LR+$LG;if($LBi.transformVector3ArrayToVector3ArrayCoordinate($Lt,$LH,$LD,$Lt,$LH),$LBi.transformVector3ArrayByQuat($Lt,$Ls,$Lw,$Lt,$Ls),$LN){var $Ld=$Lp*$LR+$LX;if($L_)$LBi.transformLightingMapTexcoordByUV1Array($Lt,$Ld,$LN,$Lt,$Ld);else{var $Ll=$Lp*$LO+$Lv;$LBi.transformLightingMapTexcoordByUV0Array($Lc,$Ll,$LN,$Lt,$Ld)}}}return $Lt},$Lr._getVertexBuffers=function(){return null},$Lr._beforeRender=function($Lr){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$Lr._render=function($Lr){var $Li,$Lt=0,$L_=$Lr.renderElement;if(1<this._indexCount){var $LA=this._boneIndicesList.length;if(1<$LA){for(var $Lf=0;$Lf<$LA;$Lf++)($Li=$L_._skinAnimationDatas||this._skinAnimationDatas)&&($L_._shaderValue.setValue(0,$Li[$Lf]),$Lr._shader.uploadRenderElementUniforms($L_._shaderValue.data)),$Lk.mainContext.drawElements(4,this._subIndexBufferCount[$Lf],5123,2*this._subIndexBufferStart[$Lf]);$LH.drawCall+=$LA}else($Li=$L_._skinAnimationDatas||this._skinAnimationDatas)&&($L_._shaderValue.setValue(0,$Li[0]),$Lr._shader.uploadRenderElementUniforms($L_._shaderValue.data)),$Lk.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),$LH.drawCall++;$Lt=this._indexCount}else $Lt=this._indexBuffer.indexCount,($Li=$L_._skinAnimationDatas||this._skinAnimationDatas)&&($L_._shaderValue.setValue(0,$Li[0]),$Lr._shader.uploadRenderElementUniforms($L_._shaderValue.data)),$Lk.mainContext.drawElements(4,$Lt,5123,0),$LH.drawCall++;$LH.trianglesFaces+=$Lt/3},$Lr.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},$Lr.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},$LO(0,$Lr,"_vertexBufferCount",function(){return 1}),$LO(0,$Lr,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$LR($LU,["_tempVector30",function(){return this._tempVector30=new $LEi},"_tempVector31",function(){return this._tempVector31=new $LEi},"_tempQuaternion0",function(){return this._tempQuaternion0=new $Lti},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new $Lri},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new $Lri}]),$LU}(),$Lgi=function(){function $Lr($Lr){this.defineCounter=0,this.defines=null,$Lr?(this.defineCounter=$Lr.defineCounter,this.defines=$Lr.defines.slice()):(this.defineCounter=0,this.defines=[])}return $Lv($Lr,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),$Lr.prototype.registerDefine=function($Lr){var $Li=Math.pow(2,this.defineCounter++);return this.defines[$Li]=$Lr,$Li},$Lr}(),$LRi=function(){function $Lr(){}return $Lv($Lr,"laya.d3.shader.ShaderInit3D"),$Lr.__init__=function(){var $Lr,$Li;$LHi._globalRegDefine("HIGHPRECISION",$LHi.SHADERDEFINE_HIGHPRECISION),$LHi._globalRegDefine("FOG",$LHi.SHADERDEFINE_FOG),$LHi._globalRegDefine("DIRECTIONLIGHT",$LHi.SHADERDEFINE_DIRECTIONLIGHT),$LHi._globalRegDefine("POINTLIGHT",$LHi.SHADERDEFINE_POINTLIGHT),$LHi._globalRegDefine("SPOTLIGHT",$LHi.SHADERDEFINE_SPOTLIGHT),$LHi._globalRegDefine("UV",$LHi.SHADERDEFINE_UV0),$LHi._globalRegDefine("COLOR",$LHi.SHADERDEFINE_COLOR),$LHi._globalRegDefine("UV1",$LHi.SHADERDEFINE_UV1),$LHi._globalRegDefine("CASTSHADOW",$Lvi.SHADERDEFINE_CAST_SHADOW),$LHi._globalRegDefine("SHADOWMAP_PSSM1",$Lvi.SHADERDEFINE_SHADOW_PSSM1),$LHi._globalRegDefine("SHADOWMAP_PSSM2",$Lvi.SHADERDEFINE_SHADOW_PSSM2),$LHi._globalRegDefine("SHADOWMAP_PSSM3",$Lvi.SHADERDEFINE_SHADOW_PSSM3),$LHi._globalRegDefine("SHADOWMAP_PCF_NO",$Lvi.SHADERDEFINE_SHADOW_PCF_NO),$LHi._globalRegDefine("SHADOWMAP_PCF1",$Lvi.SHADERDEFINE_SHADOW_PCF1),$LHi._globalRegDefine("SHADOWMAP_PCF2",$Lvi.SHADERDEFINE_SHADOW_PCF2),$LHi._globalRegDefine("SHADOWMAP_PCF3",$Lvi.SHADERDEFINE_SHADOW_PCF3),$LHi._globalRegDefine("DEPTHFOG",$LHi.SAHDERDEFINE_DEPTHFOG),$LVi.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),$LVi.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),$Lr={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},$Li={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var $Lt=$LVi.nameKey.add("SIMPLE");shaderCompile=$LHi.add($Lt,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',$Lr,$Li),$Lhi.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),$Lhi.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),$Lhi.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),$Lhi.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),$Lhi.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),$Lhi.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),$Lhi.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),$Lhi.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),$Lhi.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},$Lr}(),$LXi=function(){function $Lr(){this._data=null,this._data=[]}$Lv($Lr,"laya.d3.shader.ValusArray");var $Li=$Lr.prototype;return $Li.setValue=function($Lr,$Li){this._data[$Lr]=$Li},$LO(0,$Li,"data",function(){return this._data}),$Lr}(),$Lvi=function(){function $Lr(){}return $Lr.SHADERDEFINE_RECEIVE_SHADOW=1,$Lr.SHADERDEFINE_CAST_SHADOW=512,$Lr.SHADERDEFINE_SHADOW_PSSM1=1024,$Lr.SHADERDEFINE_SHADOW_PSSM2=2048,$Lr.SHADERDEFINE_SHADOW_PSSM3=4096,$Lr.SHADERDEFINE_SHADOW_PCF_NO=8192,$Lr.SHADERDEFINE_SHADOW_PCF1=16384,$Lr.SHADERDEFINE_SHADOW_PCF2=32768,$Lr.SHADERDEFINE_SHADOW_PCF3=65536,$Lr.MAX_PSSM_COUNT=3,$Lr}(),$LOi=function(){function $LZ(){}return $Lv($LZ,"laya.d3.utils.Picker"),$LZ.calculateCursorRay=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=$Lr.elements[0],$LG=$Lr.elements[1],$LN=$LZ._tempVector30,$Lp=$LN.elements;$Lp[0]=$LE,$Lp[1]=$LG,$Lp[2]=$Li.minDepth;var $Lg=$LZ._tempVector31,$LR=$Lg.elements;$LR[0]=$LE,$LR[1]=$LG,$LR[2]=$Li.maxDepth;var $LX=$Lf.origin,$Lv=$LZ._tempVector32;$Li.unprojectFromWVP($LN,$Lt,$L_,$LA,$LX),$Li.unprojectFromWVP($Lg,$Lt,$L_,$LA,$Lv);var $LO=$Lf.direction.elements;$LO[0]=$Lv.x-$LX.x,$LO[1]=$Lv.y-$LX.y,$LO[2]=$Lv.z-$LX.z,$LEi.normalize($Lf.direction,$Lf.direction)},$LZ.rayIntersectsPositionsAndIndices=function($Lr,$Li,$Lt,$L_,$LA){for(var $Lf=$Lt.vertexStride/4,$LE=$Lt.getVertexElementByUsage(0).offset/4,$LG=Number.MAX_VALUE,$LN=-1,$Lp=-1,$Lg=-1,$LR=0;$LR<$L_.length;$LR+=3){var $LX=$LZ._tempVector35,$Lv=$LX.elements,$LO=$L_[$LR]*$Lf,$Lc=$LO+$LE;$Lv[0]=$Li[$Lc],$Lv[1]=$Li[1+$Lc],$Lv[2]=$Li[2+$Lc];var $LB=$LZ._tempVector36,$Ly=$LB.elements,$LC=$L_[$LR+1]*$Lf,$Ln=$LC+$LE;$Ly[0]=$Li[$Ln],$Ly[1]=$Li[1+$Ln],$Ly[2]=$Li[2+$Ln];var $La=$LZ._tempVector37,$LD=$La.elements,$Lu=$L_[$LR+2]*$Lf,$Lw=$Lu+$LE;$LD[0]=$Li[$Lw],$LD[1]=$Li[1+$Lw],$LD[2]=$Li[2+$Lw];var $LH=laya.d3.utils.Picker.rayIntersectsTriangle($Lr,$LX,$LB,$La);!isNaN($LH)&&$LH<$LG&&($LG=$LH,$LN=$LO,$Lp=$LC,$Lg=$Lu)}if($LG===Number.MAX_VALUE)return $LA.position.toDefault(),$LA.distance=Number.MAX_VALUE,$LA.trianglePositions[0].toDefault(),$LA.trianglePositions[1].toDefault(),$LA.trianglePositions[2].toDefault(),$LA.triangleNormals[0].toDefault(),$LA.triangleNormals[1].toDefault(),$LA.triangleNormals[2].toDefault(),!1;$LA.distance=$LG,$LEi.scale($Lr.direction,$LG,$LA.position),$LEi.add($Lr.origin,$LA.position,$LA.position);var $Ls=$LA.trianglePositions,$Ld=$Ls[0],$Ll=$Ls[1],$LU=$Ls[2],$Lk=$Ld.elements,$Le=$Ll.elements,$LL=$LU.elements,$LQ=$LN+$LE;$Lk[0]=$Li[$LQ],$Lk[1]=$Li[$LQ+1],$Lk[2]=$Li[$LQ+2];var $LF=$Lp+$LE;$Le[0]=$Li[$LF],$Le[1]=$Li[$LF+1],$Le[2]=$Li[$LF+2];var $Lb=$Lg+$LE;$LL[0]=$Li[$Lb],$LL[1]=$Li[$Lb+1],$LL[2]=$Li[$Lb+2];var $LV=$Lt.getVertexElementByUsage(3);if($LV){var $Lh=$LV.offset/4,$LP=$LA.triangleNormals,$Lq=$LP[0],$Lm=$LP[1],$LT=$LP[2],$Lx=$Lq.elements,$L$=$Lm.elements,$Lo=$LT.elements,$LI=$LN+$Lh;$Lx[0]=$Li[$LI],$Lx[1]=$Li[$LI+1],$Lx[2]=$Li[$LI+2];var $Lz=$Lp+$Lh;$L$[0]=$Li[$Lz],$L$[1]=$Li[$Lz+1],$L$[2]=$Li[$Lz+2];var $LJ=$Lg+$Lh;$Lo[0]=$Li[$LJ],$Lo[1]=$Li[$LJ+1],$Lo[2]=$Li[$LJ+2]}return!0},$LZ.rayIntersectsTriangle=function($Lr,$Li,$Lt,$L_){var $LA=$LZ._tempVector30,$Lf=$LZ._tempVector31;$LEi.subtract($Lt,$Li,$LA),$LEi.subtract($L_,$Li,$Lf);var $LE,$LG=$LZ._tempVector32;if($LEi.cross($Lr.direction,$Lf,$LG),($LE=$LEi.dot($LA,$LG))>-Number.MIN_VALUE&&$LE<Number.MIN_VALUE)return Number.NaN;var $LN,$Lp=1/$LE,$Lg=$LZ._tempVector33;if($LEi.subtract($Lr.origin,$Li,$Lg),$LN=$LEi.dot($Lg,$LG),($LN*=$Lp)<0||1<$LN)return Number.NaN;var $LR,$LX,$Lv=$LZ._tempVector34;return $LEi.cross($Lg,$LA,$Lv),$LR=$LEi.dot($Lr.direction,$Lv),($LR*=$Lp)<0||1<$LN+$LR?Number.NaN:($LX=$LEi.dot($Lf,$Lv),($LX*=$Lp)<0?Number.NaN:$LX)},$LR($LZ,["_tempVector30",function(){return this._tempVector30=new $LEi},"_tempVector31",function(){return this._tempVector31=new $LEi},"_tempVector32",function(){return this._tempVector32=new $LEi},"_tempVector33",function(){return this._tempVector33=new $LEi},"_tempVector34",function(){return this._tempVector34=new $LEi},"_tempVector35",function(){return this._tempVector35=new $LEi},"_tempVector36",function(){return this._tempVector36=new $LEi},"_tempVector37",function(){return this._tempVector37=new $LEi}]),$LZ}(),$Lci=(function(){function $Lr(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new $LEi,new $LEi,new $LEi],this.trianglePositions.length=3,this.triangleNormals=[new $LEi,new $LEi,new $LEi],this.triangleNormals.length=3,this.position=new $LEi}$Lv($Lr,"laya.d3.utils.RaycastHit"),$Lr.prototype.cloneTo=function($Lr){$Lr.distance=this.distance,this.trianglePositions[0].cloneTo($Lr.trianglePositions[0]),this.trianglePositions[1].cloneTo($Lr.trianglePositions[1]),this.trianglePositions[2].cloneTo($Lr.trianglePositions[2]),this.triangleNormals[0].cloneTo($Lr.triangleNormals[0]),this.triangleNormals[1].cloneTo($Lr.triangleNormals[1]),this.triangleNormals[2].cloneTo($Lr.triangleNormals[2]),this.position.cloneTo($Lr.position),$Lr.sprite3D=this.sprite3D}}(),function(){function $Lr($Lr,$Li){this._width=0,this._height=0,this._width=$Lr,this._height=$Li}$Lv($Lr,"laya.d3.utils.Size");var $Li=$Lr.prototype;return $LO(0,$Li,"width",function(){return-1===this._width?$LW.clientWidth:this._width}),$LO(0,$Li,"height",function(){return-1===this._height?$LW.clientHeight:this._height}),$LO(1,$Lr,"fullScreen",function(){return new $Lr(-1,-1)}),$Lr}()),$LBi=function(){function $LQ(){}return $Lv($LQ,"laya.d3.utils.Utils3D"),$LQ._rotationTransformScaleSkinAnimation=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LR){var $LX,$Lv,$LO,$Lc,$LB,$Ly=$LQ._tempArray16_0,$LC=$LQ._tempArray16_1,$Ln=$LQ._tempArray16_2,$La=$L_+$L_,$LD=$LA+$LA,$Lu=$Lf+$Lf,$Lw=$L_*$La,$LH=$LA*$La,$Ls=$LA*$LD,$Ld=$Lf*$La,$Ll=$Lf*$LD,$LU=$Lf*$Lu,$Lk=$LE*$La,$Le=$LE*$LD,$LL=$LE*$Lu;for($Ly[15]=1,$Ly[0]=1-$Ls-$LU,$Ly[1]=$LH+$LL,$Ly[2]=$Ld-$Le,$Ly[4]=$LH-$LL,$Ly[5]=1-$Lw-$LU,$Ly[6]=$Ll+$Lk,$Ly[8]=$Ld+$Le,$Ly[9]=$Ll-$Lk,$Ly[10]=1-$Lw-$Ls,$LC[15]=1,$LC[0]=$LG,$LC[5]=$LN,$LC[10]=$Lp,$LX=0;$LX<4;$LX++)$Lv=$Ly[$LX],$LO=$Ly[$LX+4],$Lc=$Ly[$LX+8],$LB=$Ly[$LX+12],$Ln[$LX]=$Lv,$Ln[$LX+4]=$LO,$Ln[$LX+8]=$Lc,$Ln[$LX+12]=$Lv*$Lr+$LO*$Li+$Lc*$Lt+$LB;for($LX=0;$LX<4;$LX++)$Lv=$Ln[$LX],$LO=$Ln[$LX+4],$Lc=$Ln[$LX+8],$LB=$Ln[$LX+12],$Lg[$LX+$LR]=$Lv*$LC[0]+$LO*$LC[1]+$Lc*$LC[2]+$LB*$LC[3],$Lg[$LX+$LR+4]=$Lv*$LC[4]+$LO*$LC[5]+$Lc*$LC[6]+$LB*$LC[7],$Lg[$LX+$LR+8]=$Lv*$LC[8]+$LO*$LC[9]+$Lc*$LC[10]+$LB*$LC[11],$Lg[$LX+$LR+12]=$Lv*$LC[12]+$LO*$LC[13]+$Lc*$LC[14]+$LB*$LC[15]},$LQ._createNodeByJson=function($Lr,$Li,$Lt,$L_){if(!$Lt)switch($Li.type){case"Sprite3D":$Lt=new $Lbi;break;case"MeshSprite3D":$Lt=new $LZi;break;case"SkinnedMeshSprite3D":$Lt=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":$Lt=new ShuriKenParticle3D;break;case"TrailSprite3D":$Lt=new TrailSprite3D;break;case"Terrain":$Lt=new Terrain;break;case"Camera":$Lt=new $LJi;break;case"DirectionLight":$Lt=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var $LA=$Li.props;if($LA)for(var $Lf in $LA)$Lt[$Lf]=$LA[$Lf];var $LE=$Li.customProps;$LE&&($Lt instanceof laya.d3.core.Sprite3D?($Lt._parseBaseCustomProps($LE),$Lt._parseCustomProps($Lr,$L_,$LE,$Li),$Lt._parseCustomComponent($Lr,$L_,$Li.components)):$Lt._parseCustomProps($Lr,$L_,$LE,$Li));var $LG=$Li.child;if($LG)for(var $LN=0,$Lp=$LG.length;$LN<$Lp;$LN++){var $Lg=$LQ._createNodeByJson($Lr,$LG[$LN],null,$L_);$Lt.addChild($Lg)}return $Lt},$LQ._computeBoneAndAnimationDatasByBindPoseMatrxix=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE,$LG,$LN=0,$Lp=0,$Lg=$Lr.length;for($LE=0;$LE<$Lg;$LN+=$Lr[$LE].keyframeWidth,$Lp+=16,$LE++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($Li[$LN+0],$Li[$LN+1],$Li[$LN+2],$Li[$LN+3],$Li[$LN+4],$Li[$LN+5],$Li[$LN+6],$Li[$LN+7],$Li[$LN+8],$Li[$LN+9],$L_,$Lp),0!=$LE&&($LG=16*$Lr[$LE].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($L_,$LG,$L_,$Lp,$L_,$Lp));var $LR=$Lt.length;for($LE=0;$LE<$LR;$LE++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($L_,16*$Lf[$LE],$Lt[$LE],$LA,16*$LE)},$LQ._computeAnimationDatasByArrayAndMatrixFast=function($Lr,$Li,$Lt,$L_){for(var $LA=0,$Lf=$Lr.length;$LA<$Lf;$LA++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($Li,16*$L_[$LA],$Lr[$LA],$Lt,16*$LA)},$LQ._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function($Lr,$Li,$Lt,$L_,$LA){var $Lf,$LE,$LG=0,$LN=0,$Lp=$Lr.length;for($Lf=0;$Lf<$Lp;$LG+=$Lr[$Lf].keyframeWidth,$LN+=16,$Lf++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($Li[$LG+7],$Li[$LG+8],$Li[$LG+9],$Li[$LG+3],$Li[$LG+4],$Li[$LG+5],$Li[$LG+6],$Li[$LG+0],$Li[$LG+1],$Li[$LG+2],$L_,$LN),0!=$Lf&&($LE=16*$Lr[$Lf].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($L_,$LE,$L_,$LN,$L_,$LN));var $Lg=$Lt.length;for($Lf=0;$Lf<$Lg;$Lf++){var $LR=16*$Lf;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($L_,$LR,$Lt[$Lf],$LA,$LR)}},$LQ._computeAnimationDatasByArrayAndMatrixFastOld=function($Lr,$Li,$Lt){for(var $L_=$Lr.length,$LA=0;$LA<$L_;$LA++){var $Lf=16*$LA;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($Li,$Lf,$Lr[$LA],$Lt,$Lf)}},$LQ._computeRootAnimationData=function($Lr,$Li,$Lt){for(var $L_=0,$LA=0,$Lf=0,$LE=$Lr.length;$L_<$LE;$LA+=$Lr[$L_].keyframeWidth,$Lf+=16,$L_++)laya.d3.utils.Utils3D.createAffineTransformationArray($Li[$LA+0],$Li[$LA+1],$Li[$LA+2],$Li[$LA+3],$Li[$LA+4],$Li[$LA+5],$Li[$LA+6],$Li[$LA+7],$Li[$LA+8],$Li[$LA+9],$Lt,$Lf)},$LQ.transformVector3ArrayByQuat=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Lt.elements,$LE=$Lr[$Li],$LG=$Lr[$Li+1],$LN=$Lr[$Li+2],$Lp=$Lf[0],$Lg=$Lf[1],$LR=$Lf[2],$LX=$Lf[3],$Lv=$LX*$LE+$Lg*$LN-$LR*$LG,$LO=$LX*$LG+$LR*$LE-$Lp*$LN,$Lc=$LX*$LN+$Lp*$LG-$Lg*$LE,$LB=-$Lp*$LE-$Lg*$LG-$LR*$LN;$L_[$LA]=$Lv*$LX+$LB*-$Lp+$LO*-$LR-$Lc*-$Lg,$L_[$LA+1]=$LO*$LX+$LB*-$Lg+$Lc*-$Lp-$Lv*-$LR,$L_[$LA+2]=$Lc*$LX+$LB*-$LR+$Lv*-$Lg-$LO*-$Lp},$LQ.mulMatrixByArray=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE,$LG,$LN,$Lp,$Lg;if($LA===$Lt){for($Lt=$LQ._tempArray16_3,$LE=0;$LE<16;++$LE)$Lt[$LE]=$LA[$Lf+$LE];$L_=0}for($LE=0;$LE<4;$LE++)$LG=$Lr[$Li+$LE],$LN=$Lr[$Li+$LE+4],$Lp=$Lr[$Li+$LE+8],$Lg=$Lr[$Li+$LE+12],$LA[$Lf+$LE]=$LG*$Lt[$L_+0]+$LN*$Lt[$L_+1]+$Lp*$Lt[$L_+2]+$Lg*$Lt[$L_+3],$LA[$Lf+$LE+4]=$LG*$Lt[$L_+4]+$LN*$Lt[$L_+5]+$Lp*$Lt[$L_+6]+$Lg*$Lt[$L_+7],$LA[$Lf+$LE+8]=$LG*$Lt[$L_+8]+$LN*$Lt[$L_+9]+$Lp*$Lt[$L_+10]+$Lg*$Lt[$L_+11],$LA[$Lf+$LE+12]=$LG*$Lt[$L_+12]+$LN*$Lt[$L_+13]+$Lp*$Lt[$L_+14]+$Lg*$Lt[$L_+15]},$LQ.mulMatrixByArrayFast=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE,$LG,$LN,$Lp,$Lg;for($LE=0;$LE<4;$LE++)$LG=$Lr[$Li+$LE],$LN=$Lr[$Li+$LE+4],$Lp=$Lr[$Li+$LE+8],$Lg=$Lr[$Li+$LE+12],$LA[$Lf+$LE]=$LG*$Lt[$L_+0]+$LN*$Lt[$L_+1]+$Lp*$Lt[$L_+2]+$Lg*$Lt[$L_+3],$LA[$Lf+$LE+4]=$LG*$Lt[$L_+4]+$LN*$Lt[$L_+5]+$Lp*$Lt[$L_+6]+$Lg*$Lt[$L_+7],$LA[$Lf+$LE+8]=$LG*$Lt[$L_+8]+$LN*$Lt[$L_+9]+$Lp*$Lt[$L_+10]+$Lg*$Lt[$L_+11],$LA[$Lf+$LE+12]=$LG*$Lt[$L_+12]+$LN*$Lt[$L_+13]+$Lp*$Lt[$L_+14]+$Lg*$Lt[$L_+15]},$LQ.mulMatrixByArrayAndMatrixFast=function($Lr,$Li,$Lt,$L_,$LA){var $Lf,$LE,$LG,$LN,$Lp,$Lg=$Lt.elements,$LR=$Lg[0],$LX=$Lg[1],$Lv=$Lg[2],$LO=$Lg[3],$Lc=$Lg[4],$LB=$Lg[5],$Ly=$Lg[6],$LC=$Lg[7],$Ln=$Lg[8],$La=$Lg[9],$LD=$Lg[10],$Lu=$Lg[11],$Lw=$Lg[12],$LH=$Lg[13],$Ls=$Lg[14],$Ld=$Lg[15],$Ll=$Li,$LU=$Li+4,$Lk=$Li+8,$Le=$Li+12,$LL=$LA,$LQ=$LA+4,$LF=$LA+8,$Lb=$LA+12;for($Lf=0;$Lf<4;$Lf++)$LE=$Lr[$Ll+$Lf],$LG=$Lr[$LU+$Lf],$LN=$Lr[$Lk+$Lf],$Lp=$Lr[$Le+$Lf],$L_[$LL+$Lf]=$LE*$LR+$LG*$LX+$LN*$Lv+$Lp*$LO,$L_[$LQ+$Lf]=$LE*$Lc+$LG*$LB+$LN*$Ly+$Lp*$LC,$L_[$LF+$Lf]=$LE*$Ln+$LG*$La+$LN*$LD+$Lp*$Lu,$L_[$Lb+$Lf]=$LE*$Lw+$LG*$LH+$LN*$Ls+$Lp*$Ld},$LQ.createAffineTransformationArray=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LR){var $LX=$L_+$L_,$Lv=$LA+$LA,$LO=$Lf+$Lf,$Lc=$L_*$LX,$LB=$L_*$Lv,$Ly=$L_*$LO,$LC=$LA*$Lv,$Ln=$LA*$LO,$La=$Lf*$LO,$LD=$LE*$LX,$Lu=$LE*$Lv,$Lw=$LE*$LO;$Lg[$LR+0]=(1-($LC+$La))*$LG,$Lg[$LR+1]=($LB+$Lw)*$LG,$Lg[$LR+2]=($Ly-$Lu)*$LG,$Lg[$LR+3]=0,$Lg[$LR+4]=($LB-$Lw)*$LN,$Lg[$LR+5]=(1-($Lc+$La))*$LN,$Lg[$LR+6]=($Ln+$LD)*$LN,$Lg[$LR+7]=0,$Lg[$LR+8]=($Ly+$Lu)*$Lp,$Lg[$LR+9]=($Ln-$LD)*$Lp,$Lg[$LR+10]=(1-($Lc+$LC))*$Lp,$Lg[$LR+11]=0,$Lg[$LR+12]=$Lr,$Lg[$LR+13]=$Li,$Lg[$LR+14]=$Lt,$Lg[$LR+15]=1},$LQ.transformVector3ArrayToVector3ArrayCoordinate=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$LQ._tempArray4_0,$LE=$Lr[$Li+0],$LG=$Lr[$Li+1],$LN=$Lr[$Li+2],$Lp=$Lt.elements;$Lf[0]=$LE*$Lp[0]+$LG*$Lp[4]+$LN*$Lp[8]+$Lp[12],$Lf[1]=$LE*$Lp[1]+$LG*$Lp[5]+$LN*$Lp[9]+$Lp[13],$Lf[2]=$LE*$Lp[2]+$LG*$Lp[6]+$LN*$Lp[10]+$Lp[14],$Lf[3]=1/($LE*$Lp[3]+$LG*$Lp[7]+$LN*$Lp[11]+$Lp[15]),$L_[$LA+0]=$Lf[0]*$Lf[3],$L_[$LA+1]=$Lf[1]*$Lf[3],$L_[$LA+2]=$Lf[2]*$Lf[3]},$LQ.transformLightingMapTexcoordByUV0Array=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Lt.elements;$L_[$LA+0]=$Lr[$Li+0]*$Lf[0]+$Lf[2],$L_[$LA+1]=($Lr[$Li+1]-1)*$Lf[1]+$Lf[3]},$LQ.transformLightingMapTexcoordByUV1Array=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Lt.elements;$L_[$LA+0]=$Lr[$Li+0]*$Lf[0]+$Lf[2],$L_[$LA+1]=1+$Lr[$Li+1]*$Lf[1]+$Lf[3]},$LQ.getURLVerion=function($Lr){var $Li=$Lr.indexOf("?");return 0<=$Li?$Lr.substr($Li):null},$LQ._quaternionCreateFromYawPitchRollArray=function($Lr,$Li,$Lt,$L_){var $LA=.5*$Lt,$Lf=.5*$Li,$LE=.5*$Lr,$LG=Math.sin($LA),$LN=Math.cos($LA),$Lp=Math.sin($Lf),$Lg=Math.cos($Lf),$LR=Math.sin($LE),$LX=Math.cos($LE);$L_[0]=$LX*$Lp*$LN+$LR*$Lg*$LG,$L_[1]=$LR*$Lg*$LN-$LX*$Lp*$LG,$L_[2]=$LX*$Lg*$LG-$LR*$Lp*$LN,$L_[3]=$LX*$Lg*$LN+$LR*$Lp*$LG},$LQ._createAffineTransformationArray=function($Lr,$Li,$Lt,$L_){var $LA=$Li[0],$Lf=$Li[1],$LE=$Li[2],$LG=$Li[3],$LN=$LA+$LA,$Lp=$Lf+$Lf,$Lg=$LE+$LE,$LR=$LA*$LN,$LX=$LA*$Lp,$Lv=$LA*$Lg,$LO=$Lf*$Lp,$Lc=$Lf*$Lg,$LB=$LE*$Lg,$Ly=$LG*$LN,$LC=$LG*$Lp,$Ln=$LG*$Lg,$La=$Lt[0],$LD=$Lt[1],$Lu=$Lt[2];$L_[0]=(1-($LO+$LB))*$La,$L_[1]=($LX+$Ln)*$La,$L_[2]=($Lv-$LC)*$La,$L_[3]=0,$L_[4]=($LX-$Ln)*$LD,$L_[5]=(1-($LR+$LB))*$LD,$L_[6]=($Lc+$Ly)*$LD,$L_[7]=0,$L_[8]=($Lv+$LC)*$Lu,$L_[9]=($Lc-$Ly)*$Lu,$L_[10]=(1-($LR+$LO))*$Lu,$L_[11]=0,$L_[12]=$Lr[0],$L_[13]=$Lr[1],$L_[14]=$Lr[2],$L_[15]=1},$LQ._mulMatrixArray=function($Lr,$Li,$Lt,$L_){var $LA,$Lf,$LE,$LG,$LN,$Lp=$Li.elements,$Lg=$Lp[0],$LR=$Lp[1],$LX=$Lp[2],$Lv=$Lp[3],$LO=$Lp[4],$Lc=$Lp[5],$LB=$Lp[6],$Ly=$Lp[7],$LC=$Lp[8],$Ln=$Lp[9],$La=$Lp[10],$LD=$Lp[11],$Lu=$Lp[12],$Lw=$Lp[13],$LH=$Lp[14],$Ls=$Lp[15],$Ld=$L_,$Ll=$L_+4,$LU=$L_+8,$Lk=$L_+12;for($LA=0;$LA<4;$LA++)$Lf=$Lr[$LA],$LE=$Lr[$LA+4],$LG=$Lr[$LA+8],$LN=$Lr[$LA+12],$Lt[$Ld+$LA]=$Lf*$Lg+$LE*$LR+$LG*$LX+$LN*$Lv,$Lt[$Ll+$LA]=$Lf*$LO+$LE*$Lc+$LG*$LB+$LN*$Ly,$Lt[$LU+$LA]=$Lf*$LC+$LE*$Ln+$LG*$La+$LN*$LD,$Lt[$Lk+$LA]=$Lf*$Lu+$LE*$Lw+$LG*$LH+$LN*$Ls},$LQ.getYawPitchRoll=function($Lr,$Li){$LQ.transformQuat($LEi.ForwardRH,$Lr,$Lti.TEMPVector31),$LQ.transformQuat($LEi.Up,$Lr,$Lti.TEMPVector32);var $Lt=$Lti.TEMPVector32.elements;$LQ.angleTo($LEi.ZERO,$Lti.TEMPVector31,$Lti.TEMPVector33);var $L_=$Lti.TEMPVector33.elements;$L_[0]==Math.PI/2?($L_[1]=$LQ.arcTanAngle($Lt[2],$Lt[0]),$L_[2]=0):$L_[0]==-Math.PI/2?($L_[1]=$LQ.arcTanAngle(-$Lt[2],-$Lt[0]),$L_[2]=0):($Lri.createRotationY(-$L_[1],$Lti.TEMPMatrix0),$Lri.createRotationX(-$L_[0],$Lti.TEMPMatrix1),$LEi.transformCoordinate($Lti.TEMPVector32,$Lti.TEMPMatrix0,$Lti.TEMPVector32),$LEi.transformCoordinate($Lti.TEMPVector32,$Lti.TEMPMatrix1,$Lti.TEMPVector32),$L_[2]=$LQ.arcTanAngle($Lt[1],-$Lt[0])),$L_[1]<=-Math.PI&&($L_[1]=Math.PI),$L_[2]<=-Math.PI&&($L_[2]=Math.PI),$L_[1]>=Math.PI&&$L_[2]>=Math.PI&&($L_[1]=0,$L_[2]=0,$L_[0]=Math.PI-$L_[0]),$Li[0]=$L_[1],$Li[1]=$L_[0],$Li[2]=$L_[2]},$LQ.arcTanAngle=function($Lr,$Li){return 0==$Lr?1==$Li?Math.PI/2:-Math.PI/2:0<$Lr?Math.atan($Li/$Lr):$Lr<0?0<$Li?Math.atan($Li/$Lr)+Math.PI:Math.atan($Li/$Lr)-Math.PI:0},$LQ.angleTo=function($Lr,$Li,$Lt){$LEi.subtract($Li,$Lr,$Lti.TEMPVector30),$LEi.normalize($Lti.TEMPVector30,$Lti.TEMPVector30),$Lt.elements[0]=Math.asin($Lti.TEMPVector30.y),$Lt.elements[1]=$LQ.arcTanAngle(-$Lti.TEMPVector30.z,-$Lti.TEMPVector30.x)},$LQ.transformQuat=function($Lr,$Li,$Lt){var $L_=$Lt.elements,$LA=$Lr.elements,$Lf=$Li,$LE=$LA[0],$LG=$LA[1],$LN=$LA[2],$Lp=$Lf[0],$Lg=$Lf[1],$LR=$Lf[2],$LX=$Lf[3],$Lv=$LX*$LE+$Lg*$LN-$LR*$LG,$LO=$LX*$LG+$LR*$LE-$Lp*$LN,$Lc=$LX*$LN+$Lp*$LG-$Lg*$LE,$LB=-$Lp*$LE-$Lg*$LG-$LR*$LN;$L_[0]=$Lv*$LX+$LB*-$Lp+$LO*-$LR-$Lc*-$Lg,$L_[1]=$LO*$LX+$LB*-$Lg+$Lc*-$Lp-$Lv*-$LR,$L_[2]=$Lc*$LX+$LB*-$LR+$Lv*-$Lg-$LO*-$Lp},$LQ.quaterionNormalize=function($Lr,$Li){var $Lt=$Lr[0],$L_=$Lr[1],$LA=$Lr[2],$Lf=$Lr[3],$LE=$Lt*$Lt+$L_*$L_+$LA*$LA+$Lf*$Lf;0<$LE&&($LE=1/Math.sqrt($LE),$Li[0]=$Lt*$LE,$Li[1]=$L_*$LE,$Li[2]=$LA*$LE,$Li[3]=$Lf*$LE)},$LQ.matrix4x4MultiplyFFF=function($Lr,$Li,$Lt){var $L_,$LA,$Lf,$LE,$LG;if($Lt===$Li)for($Li=new Float32Array(16),$L_=0;$L_<16;++$L_)$Li[$L_]=$Lt[$L_];for($L_=0;$L_<4;$L_++)$LA=$Lr[$L_],$Lf=$Lr[$L_+4],$LE=$Lr[$L_+8],$LG=$Lr[$L_+12],$Lt[$L_]=$LA*$Li[0]+$Lf*$Li[1]+$LE*$Li[2]+$LG*$Li[3],$Lt[$L_+4]=$LA*$Li[4]+$Lf*$Li[5]+$LE*$Li[6]+$LG*$Li[7],$Lt[$L_+8]=$LA*$Li[8]+$Lf*$Li[9]+$LE*$Li[10]+$LG*$Li[11],$Lt[$L_+12]=$LA*$Li[12]+$Lf*$Li[13]+$LE*$Li[14]+$LG*$Li[15]},$LQ.matrix4x4MultiplyMFM=function($Lr,$Li,$Lt){$LQ.matrix4x4MultiplyFFF($Lr.elements,$Li,$Lt.elements)},$LR($LQ,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new $LEi},"_tempVector3_1",function(){return this._tempVector3_1=new $LEi},"_tempVector3_2",function(){return this._tempVector3_2=new $LEi},"_tempVector3_3",function(){return this._tempVector3_3=new $LEi},"_tempVector3_4",function(){return this._tempVector3_4=new $LEi},"_tempVector3_5",function(){return this._tempVector3_5=new $LEi},"_tempVector3_6",function(){return this._tempVector3_6=new $LEi},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),$LQ}(),$Lyi=function(){function $Le(){}return $Lv($Le,"Laya3D"),$Le._cancelLoadByUrl=function($Lr){$LD.loader.cancelLoadByUrl($Lr),$Le._innerFirstLevelLoaderManager.cancelLoadByUrl($Lr),$Le._innerSecondLevelLoaderManager.cancelLoadByUrl($Lr),$Le._innerThirdLevelLoaderManager.cancelLoadByUrl($Lr),$Le._innerFourthLevelLoaderManager.cancelLoadByUrl($Lr)},$Le._changeWebGLSize=function($Lr,$Li){$Lk.onStageResize($Lr,$Li),$LW.clientWidth=$Lr,$LW.clientHeight=$Li},$Le.__init__=function(){var $Lr=$Li.createMap;$Lr.lh=[$Lbi,"SPRITE3DHIERARCHY"],$Lr.ls=[$LFi,"SPRITE3DHIERARCHY"],$Lr.lm=[$Lxi,"MESH"],$Lr.lmat=[$Lhi,"MATERIAL"],$Lr.jpg=[$Loi,"nativeimage"],$Lr.jpeg=[$Loi,"nativeimage"],$Lr.png=[$Loi,"nativeimage"],$Lr.pkm=[$Loi,"arraybuffer"],$Lr.raw=[$Lmi,"arraybuffer"],$Lr.mipmaps=[$Lmi,"arraybuffer"],$Ly.parserMap.SPRITE3DHIERARCHY=$Le._loadHierarchy,$Ly.parserMap.MESH=$Le._loadMesh,$Ly.parserMap.MATERIAL=$Le._loadMaterial,$Ly.parserMap.TEXTURECUBE=$Le._loadTextureCube,$Ly.parserMap.TERRAIN=$Le._loadTerrain,$Le._innerFirstLevelLoaderManager.on("error",null,$Le._eventLoadManagerError),$Le._innerSecondLevelLoaderManager.on("error",null,$Le._eventLoadManagerError),$Le._innerThirdLevelLoaderManager.on("error",null,$Le._eventLoadManagerError),$Le._innerFourthLevelLoaderManager.on("error",null,$Le._eventLoadManagerError)},$Le.READ_BLOCK=function(){return $Le._readData.pos+=4,!0},$Le.READ_DATA=function(){return $Le._DATA.offset=$Le._readData.getUint32(),$Le._DATA.size=$Le._readData.getUint32(),!0},$Le.READ_STRINGS=function(){var $Lr=[],$Li={offset:0,size:0};$Li.offset=$Le._readData.getUint16(),$Li.size=$Le._readData.getUint16();$Le._readData.pos;$Le._readData.pos=$Li.offset+$Le._DATA.offset;for(var $Lt=0;$Lt<$Li.size;$Lt++){var $L_=$Le._readData.readUTFString();-1===$L_.lastIndexOf(".lmat")&&-1===$L_.lastIndexOf(".lpbr")||$Lr.push($L_)}return $Lr},$Le.formatRelativePath=function($Lr,$Li){var $Lt;if("."===$Li.charAt(0)){for(var $L_=($Lr+$Li).split("/"),$LA=0,$Lf=$L_.length;$LA<$Lf;$LA++)if(".."==$L_[$LA]){var $LE=$LA-1;0<$LE&&".."!==$L_[$LE]&&($L_.splice($LE,2),$LA-=2)}$Lt=$L_.join("/")}else $Lt=$Lr+$Li;return null!=$LU.customFormat&&($Lt=$LU.customFormat($Lt,null)),$Lt},$Le._eventLoadManagerError=function($Lr){$LD.loader.event("error",$Lr)},$Le._addHierarchyInnerUrls=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE=$Le.formatRelativePath($L_,$LA);$Lt&&($LE+=$Lt),$Lr.push({url:$LE,clas:$Lf}),$Li[$LA]=$LE},$Le._getSprite3DHierarchyInnerUrls=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){var $LG,$LN=0,$Lp=0;switch($Lr.type){case"Scene":var $Lg=$Lr.customProps.lightmaps;for($LN=0,$Lp=$Lg.length;$LN<$Lp;$LN++){var $LR=$Lg[$LN].replace(".exr",".png");$Le._addHierarchyInnerUrls($L_,$LA,$Lf,$LE,$LR,$Loi)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var $LX;if($Lr.instanceParams)($LX=$Lr.instanceParams.loadPath)&&$Le._addHierarchyInnerUrls($Li,$LA,$Lf,$LE,$LX,$Lxi);else{($LX=($LG=$Lr.customProps).meshPath)&&$Le._addHierarchyInnerUrls($Li,$LA,$Lf,$LE,$LX,$Lxi);var $Lv=$LG.materials;if($Lv)for($LN=0,$Lp=$Lv.length;$LN<$Lp;$LN++){for(var $LO=$Lv[$LN],$Lc=$LO.type.split("."),$LB=$LL.window,$Ly=0,$LC=$Lc.length;$Ly<$LC;++$Ly){$LB=$LB[this.clasPaths[$Ly]]}if("function"!=typeof $LB)throw"_getSprite3DHierarchyInnerUrls 错误: "+$LO.type+" 不是类";$Le._addHierarchyInnerUrls($Lt,$LA,$Lf,$LE,$LO.path,$LB)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var $Ln=($LG=$Lr.customProps).meshPath;$Ln&&$Le._addHierarchyInnerUrls($Li,$LA,$Lf,$LE,$Ln,$Lxi);var $La=$LG.material;if($La){$Lc=$La.type.split("."),$LB=$LL.window;for($Ly=0,$LC=$Lc.length;$Ly<$LC;++$Ly){$LB=$LB[this.clasPaths[$Ly]]}$Le._addHierarchyInnerUrls($Lt,$LA,$Lf,$LE,$La.path,$LB)}else{var $LD=$LG.materialPath;if($LD)$Le._addHierarchyInnerUrls($Lt,$LA,$Lf,$LE,$LD,ShurikenParticleMaterial);else{var $Lu=$LG.texturePath;$Lu&&$Le._addHierarchyInnerUrls($L_,$LA,$Lf,$LE,$Lu,$Loi)}}break;case"Terrain":$Le._addHierarchyInnerUrls($L_,$LA,$Lf,$LE,$Lr.customProps.dataPath,TerrainRes)}var $Lw=$Lr.components;for(var $LH in $Lw){var $Ls=$Lw[$LH];switch($LH){case"Animator":var $Ld=$Ls.avatarPath;if($Ld)$Le._addHierarchyInnerUrls($L_,$LA,$Lf,$LE,$Ld,Avatar);else{var $Ll=$Ls.avatar;$Ll&&$Le._addHierarchyInnerUrls($L_,$LA,$Lf,$LE,$Ll.path,Avatar)}var $LU=$Ls.clipPaths;for($LN=0,$Lp=$LU.length;$LN<$Lp;$LN++)$Le._addHierarchyInnerUrls($L_,$LA,$Lf,$LE,$LU[$LN],AnimationClip)}}var $Lk=$Lr.child;for($LN=0,$Lp=$Lk.length;$LN<$Lp;$LN++)$Le._getSprite3DHierarchyInnerUrls($Lk[$LN],$Li,$Lt,$L_,$LA,$Lf,$LE)},$Le._loadHierarchy=function($Lr){$Lr.on("loaded",null,$Le._onHierarchylhLoaded,[$Lr,$Lr._class._getGroup()]),$Lr.load($Lr.url,"json",!1,null,!0)},$Le._onHierarchylhLoaded=function($Lr,$Li,$Lt){if($Lr._class.destroyed)$Lr.endLoad();else{var $L_=$Lr.url,$LA=$LBi.getURLVerion($L_),$Lf=$LU.getPath($L_),$LE=[],$LG=[],$LN=[],$Lp={};$Le._getSprite3DHierarchyInnerUrls($Lt,$LE,$LG,$LN,$Lp,$LA,$Lf);var $Lg=$LE.length+$LG.length+$LN.length,$LR=$Lg+1,$LX=1/$LR;if($Le._onProcessChange($Lr,0,$LX,1),0<$LN.length){var $Lv=$Lg/$LR,$LO=$Ll.create(null,$Le._onProcessChange,[$Lr,$LX,$Lv],!1);$Le._innerFourthLevelLoaderManager.create($LN,$Ll.create(null,$Le._onHierarchyInnerForthLevResouLoaded,[$Lr,$Li,$LO,$Lt,$Lp,$LE,$LG,$LX+$Lv*$LN.length,$Lv]),$LO,null,null,1,!0,$Li)}else $Le._onHierarchyInnerForthLevResouLoaded($Lr,$Li,null,$Lt,$Lp,$LE,$LG,$LX,$Lv)}},$Le._onHierarchyInnerForthLevResouLoaded=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){if($Lr._class.destroyed)$Lr.endLoad();else if($Lt&&$Lt.recover(),0<$LE.length){var $Lp=$Ll.create(null,$Le._onProcessChange,[$Lr,$LG,$LN],!1);$Le._innerSecondLevelLoaderManager.create($LE,$Ll.create(null,$Le._onHierarchyInnerSecondLevResouLoaded,[$Lr,$Li,$Lp,$L_,$LA,$Lf,$LG+$LN*$LE.length,$LN]),$Lt,null,null,1,!0,$Li)}else $Le._onHierarchyInnerSecondLevResouLoaded($Lr,$Li,null,$L_,$LA,$Lf,$LG,$LN)},$Le._onHierarchyInnerSecondLevResouLoaded=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG){if($Lr._class.destroyed)$Lr.endLoad();else if($Lt&&$Lt.recover(),0<$Lf.length){var $LN=$Ll.create(null,$Le._onProcessChange,[$Lr,$LE,$LG],!1);$Le._innerFirstLevelLoaderManager.create($Lf,$Ll.create(null,$Le._onHierarchyInnerFirstLevResouLoaded,[$Lr,$LN,$L_,$LA]),$Lt,null,null,1,!0,$Li)}else $Le._onHierarchyInnerFirstLevResouLoaded($Lr,null,$L_,$LA)},$Le._onHierarchyInnerFirstLevResouLoaded=function($Lr,$Li,$Lt,$L_){$Li&&$Li.recover(),$Lr.endLoad([$Lt,$L_])},$Le._loadTerrain=function($Lr){$Lr.on("loaded",null,$Le._onTerrainLtLoaded,[$Lr,$Lr._class._getGroup()]),$Lr.load($Lr.url,"json",!1,null,!0)},$Le._onTerrainLtLoaded=function($Lr,$Li,$Lt){if($Lr._class.destroyed)$Lr.endLoad();else{var $L_,$LA,$Lf=$Lr.url,$LE=$LBi.getURLVerion($Lf),$LG=$LU.getPath($Lf),$LN=[],$Lp={},$Lg=0,$LR=0,$LX=$Lt.heightData;$L_=$LX.url,$LA=$Le.formatRelativePath($LG,$L_),$LE&&($LA+=$LE),$L_=$Lp[$L_]=$LA;var $Lv=$Lt.detailTexture;for($Lg=0,$LR=$Lv.length;$Lg<$LR;$Lg++)$LN.push({url:$Lv[$Lg].diffuse});var $LO=$Lt.normalMap;for($Lg=0,$LR=$LO.length;$Lg<$LR;$Lg++)$LN.push({url:$LO[$Lg]});var $Lc=$Lt.alphaMap;for($Lg=0,$LR=$Lc.length;$Lg<$LR;$Lg++)$LN.push({url:$Lc[$Lg],params:[!1,!1,6408,!0]});for($Lg=0,$LR=$LN.length;$Lg<$LR;$Lg++){var $LB=$LN[$Lg].url;$LA=$Le.formatRelativePath($LG,$LB),$LE&&($LA+=$LE),$LN[$Lg].url=$LA,$Lp[$LB]=$LA}var $Ly=$LN.length,$LC=$Ly+2,$Ln=1/$LC;$Le._onProcessChange($Lr,0,$Ln,1);var $La={heightMapLoaded:!1,texturesLoaded:!1},$LD=$Ll.create(null,$Le._onProcessChange,[$Lr,$Ln,$Ln],!1);$Le._innerFourthLevelLoaderManager.create($L_,$Ll.create(null,$Le._onTerrainHeightMapLoaded,[$Lr,$LD,$Lt,$Lp,$La]),$LD,null,[$LX.numX,$LX.numZ,$LX.bitType,$LX.value],1,!0,$Li);var $Lu=$Ll.create(null,$Le._onProcessChange,[$Lr,2*$Ln,$Ly/$LC],!1);$Le._innerFourthLevelLoaderManager.create($LN,$Ll.create(null,$Le._onTerrainTexturesLoaded,[$Lr,$Lu,$Lt,$Lp,$La]),$Lu,null,null,1,!0,$Li)}},$Le._onTerrainHeightMapLoaded=function($Lr,$Li,$Lt,$L_,$LA){$LA.heightMapLoaded=!0,$LA.texturesLoaded&&($Lr.endLoad([$Lt,$L_]),$Li.recover())},$Le._onTerrainTexturesLoaded=function($Lr,$Li,$Lt,$L_,$LA){$LA.texturesLoaded=!0,$LA.heightMapLoaded&&($Lr.endLoad([$Lt,$L_]),$Li.recover())},$Le._loadMesh=function($Lr){$Lr.on("loaded",null,$Le._onMeshLmLoaded,[$Lr,$Lr._class._getGroup()]),$Lr.load($Lr.url,"arraybuffer",!1,null,!0)},$Le._onMeshLmLoaded=function($Lr,$Li,$Lt){if($Lr._class.destroyed)$Lr.endLoad();else{var $L_,$LA,$Lf,$LE=$Lr.url,$LG=$LBi.getURLVerion($LE),$LN=$LU.getPath($LE),$Lp={},$Lg=0,$LR=0;switch(($Le._readData=new $Lu($Lt)).pos=0,$Le._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var $LX=$Le._readData.getUint32();$Le._readData.pos=$Le._readData.pos+4,$LR=$Le._readData.getUint16(),$Le._readData.pos=$Le._readData.pos+8*$LR;var $Lv=$Le._readData.getUint32();for($LR=$Le._readData.getUint16(),$Le._readData.pos=$LX+$Lv,$L_=[],$Lg=0;$Lg<$LR;$Lg++){var $LO=$Le._readData.readUTFString();-1!==$LO.lastIndexOf(".lmat")&&$L_.push($LO)}break;default:for($Le.READ_BLOCK(),$Lg=0;$Lg<2;$Lg++){var $Lc=$Le._readData.getUint16(),$LB=$Le._strings[$Lc],$Ly=$Le["READ_"+$LB];if(null==$Ly)throw new Error("model file err,no this function:"+$Lc+" "+$LB);1===$Lg?$L_=$Ly.call():$Ly.call()}}for($Lg=0,$Lf=$L_.length;$Lg<$Lf;$Lg++){var $LC=$L_[$Lg];$LA=$Le.formatRelativePath($LN,$LC),$LG&&($LA+=$LG),$L_[$Lg]=$LA,$Lp[$LC]=$LA}if(0<$L_.length){$Le._onProcessChange($Lr,0,.5,1);var $Ln=$Ll.create(null,$Le._onProcessChange,[$Lr,.5,.5],!1);$Le._innerSecondLevelLoaderManager.create($L_,$Ll.create(null,$Le._onMeshMateialLoaded,[$Lr,$Ln,$Lt,$Lp]),$Ln,null,null,1,!0,$Li)}else $Lr.endLoad([$Lt,$Lp])}},$Le._onMeshMateialLoaded=function($Lr,$Li,$Lt,$L_){$Lr.endLoad([$Lt,$L_]),$Li.recover()},$Le._getMaterialTexturePath=function($Lr,$Li,$Lt){var $L_=$Lr.length-4;return $Lr.indexOf(".dds")!=$L_&&$Lr.indexOf(".tga")!=$L_&&$Lr.indexOf(".exr")!=$L_&&$Lr.indexOf(".DDS")!=$L_&&$Lr.indexOf(".TGA")!=$L_&&$Lr.indexOf(".EXR")!=$L_||($Lr=$Lr.substr(0,$L_)+".png"),$Lr=$Le.formatRelativePath($Lt,$Lr),$Li&&($Lr+=$Li),$Lr},$Le._loadMaterial=function($Lr){$Lr.on("loaded",null,$Le._onMaterilLmatLoaded,[$Lr,$Lr._class._getGroup()]),$Lr.load($Lr.url,"json",!1,null,!0)},$Le._onMaterilLmatLoaded=function($Lr,$Li,$Lt){if($Lr._class.destroyed)$Lr.endLoad();else{var $L_,$LA=$Lr.url,$Lf=$LBi.getURLVerion($LA),$LE=$LU.getPath($LA),$LG=[],$LN={},$Lp=$Lt.customProps,$Lg=$Lt.version;if($Lg)switch($Lg){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var $LR=$Lt.props.textures,$LX=0,$Lv=$LR.length;$LX<$Lv;$LX++){var $LO=$LR[$LX],$Lc=$LO.path;if($Lc){var $LB=$Lc.length-4;$Lc.indexOf(".exr")!=$LB&&$Lc.indexOf(".EXR")!=$LB||($Lc=$Lc.substr(0,$LB)+".png"),$L_=$Le.formatRelativePath($LE,$Lc),$Lf&&($L_+=$Lf),$LG.push({url:$L_,params:$LO.params}),$LN[$Lc]=$L_}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var $Ly=$Lp.diffuseTexture.texture2D;if($Ly&&($L_=$Le._getMaterialTexturePath($Ly,$Lf,$LE),$LG.push($L_),$LN[$Ly]=$L_),$Lp.normalTexture){var $LC=$Lp.normalTexture.texture2D;$LC&&($L_=$Le._getMaterialTexturePath($LC,$Lf,$LE),$LG.push($L_),$LN[$LC]=$L_)}if($Lp.specularTexture){var $Ln=$Lp.specularTexture.texture2D;$Ln&&($L_=$Le._getMaterialTexturePath($Ln,$Lf,$LE),$LG.push($L_),$LN[$Ln]=$L_)}if($Lp.emissiveTexture){var $La=$Lp.emissiveTexture.texture2D;$La&&($L_=$Le._getMaterialTexturePath($La,$Lf,$LE),$LG.push($L_),$LN[$La]=$L_)}if($Lp.ambientTexture){var $LD=$Lp.ambientTexture.texture2D;$LD&&($L_=$Le._getMaterialTexturePath($LD,$Lf,$LE),$LG.push($L_),$LN[$LD]=$L_)}if($Lp.reflectTexture){var $Lu=$Lp.reflectTexture.texture2D;$Lu&&($L_=$Le._getMaterialTexturePath($Lu,$Lf,$LE),$LG.push($L_),$LN[$Lu]=$L_)}}var $Lw=$LG.length,$LH=$Lw+1,$Ls=1/$LH;if($Le._onProcessChange($Lr,0,$Ls,1),0<$Lw){var $Ld=$Ll.create(null,$Le._onProcessChange,[$Lr,$Ls,$Lw/$LH],!1);$Le._innerFourthLevelLoaderManager.create($LG,$Ll.create(null,$Le._onMateialTexturesLoaded,[$Lr,$Ld,$Lt,$LN]),$Ld,$Loi,null,1,!0,$Li)}else $Le._onMateialTexturesLoaded($Lr,null,$Lt,null)}},$Le._onMateialTexturesLoaded=function($Lr,$Li,$Lt,$L_){$Lr.endLoad([$Lt,$L_]),$Li&&$Li.recover()},$Le._loadTextureCube=function($Lr){$Lr.on("loaded",null,$Le._onTextureCubeLtcLoaded,[$Lr]),$Lr.load($Lr.url,"json",!1,null,!0)},$Le._onTextureCubeLtcLoaded=function($Lr,$Li){if($Lr._class.destroyed)$Lr.endLoad();else{var $Lt=$LU.getPath($Lr.url),$L_=[$Le.formatRelativePath($Lt,$Li.px),$Le.formatRelativePath($Lt,$Li.nx),$Le.formatRelativePath($Lt,$Li.py),$Le.formatRelativePath($Lt,$Li.ny),$Le.formatRelativePath($Lt,$Li.pz),$Le.formatRelativePath($Lt,$Li.nz)];$Le._onProcessChange($Lr,0,1/7,1);var $LA=$Ll.create(null,$Le._onProcessChange,[$Lr,1/7,6/7],!1);$Le._innerFourthLevelLoaderManager.load($L_,$Ll.create(null,$Le._onTextureCubeImagesLoaded,[$Lr,$L_,$LA]),$LA,"nativeimage")}},$Le._onTextureCubeImagesLoaded=function($Lr,$Li,$Lt){var $L_=[];$L_.length=6;for(var $LA=0;$LA<6;$LA++){var $Lf=$Li[$LA];$L_[$LA]=$Ly.getRes($Lf),$Ly.clearRes($Lf)}$Lr.endLoad($L_),$Lt.recover()},$Le._onProcessChange=function($Lr,$Li,$Lt,$L_){($L_=$Li+$L_*$Lt)<1&&$Lr.event("progress",$L_)},$Le.init=function($Lr,$Li,$Lt,$L_,$LA,$Lf){if(void 0===$Lt&&($Lt=!1),void 0===$L_&&($L_=!1),void 0===$LA&&($LA=!0),void 0===$Lf&&($Lf=!0),$LC.update3DLoop=function(){},$LC.cancelLoadByUrl=function($Lr){$Le._cancelLoadByUrl($Lr)},$LN.isAntialias=$Lt,$LN.isAlpha=$L_,$LN.premultipliedAlpha=$LA,$LN.isStencil=$Lf,!$Lk.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");$LC.changeWebGLSize=$Le._changeWebGLSize,$Lc.is3DMode=!0,$LD.init($Lr,$Li),$LQ.__init__(),$LRi.__init__(),$LZi.__init__(),$LT.__init__(),$Le.__init__(),$LE.maxTextureCount=2,($Le.debugMode||$LM.debugMode)&&($Le._debugPhasorSprite=new $Lz)},$Le.HIERARCHY="SPRITE3DHIERARCHY",$Le.MESH="MESH",$Le.MATERIAL="MATERIAL",$Le.PBRMATERIAL="PBRMTL",$Le.TEXTURECUBE="TEXTURECUBE",$Le.TERRAIN="TERRAIN",$Le._readData=null,$Le._debugPhasorSprite=null,$Le.debugMode=!1,$LR($Le,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new $Li},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new $Li},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new $Li},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new $Li}]),$Le}(),$LCi=function($Lr){function $LA($Lr){$LA.__super.call(this),this._owner=$Lr,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}$Lv($LA,"laya.d3.animation.AnimationTransform3D",$Lf);var $Li=$LA.prototype;return $Li._getlocalMatrix=function(){return this._localUpdate&&($LBi._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},$Li._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var $Lr=0,$Li=this._childs.length;$Lr<$Li;$Lr++)this._childs[$Lr]._onWorldTransform()}},$Li._setWorldMatrixAndUpdate=function($Lr){if(this._worldMatrix=$Lr,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var $Li=this._getlocalMatrix(),$Lt=0;$Lt<16;++$Lt)this._worldMatrix[$Lt]=$Li[$Lt];else $LBi.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},$Li._setWorldMatrixNoUpdate=function($Lr){this._worldMatrix=$Lr},$Li._setWorldMatrixIgnoreUpdate=function($Lr){this._worldMatrix=$Lr,this._worldUpdate=!1},$Li.getLocalPosition=function(){return this._localPosition},$Li.setLocalPosition=function($Lr){if(this._parent)this._localPosition=$Lr,this._localUpdate=!0,this._onWorldTransform();else{var $Li=this._entity.owner._transform,$Lt=this._entity.localPosition,$L_=$Lt.elements;$L_[0]=$Lr[0],$L_[1]=$Lr[1],$L_[2]=$Lr[2],$Li.localPosition=$Lt}},$Li.getLocalRotation=function(){if(this._localQuaternionUpdate){var $Lr=this._localRotationEuler;$LBi._quaternionCreateFromYawPitchRollArray($Lr[1]/$LA._angleToRandin,$Lr[0]/$LA._angleToRandin,$Lr[2]/$LA._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},$Li.setLocalRotation=function($Lr){if(this._parent)this._localRotation=$Lr,$LBi.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $Li=this._entity.owner._transform,$Lt=this._entity.localRotation,$L_=$Lt.elements;$L_[0]=$Lr[0],$L_[1]=$Lr[1],$L_[2]=$Lr[2],$L_[3]=$Lr[3],$Li.localRotation=$Lt}},$Li.getLocalScale=function(){return this._localScale},$Li.setLocalScale=function($Lr){if(this._parent)this._localScale=$Lr,this._localUpdate=!0,this._onWorldTransform();else{var $Li=this._entity.owner._transform,$Lt=this._entity.localScale,$L_=$Lt.elements;$L_[0]=$Lr[0],$L_[1]=$Lr[1],$L_[2]=$Lr[2],$Li.localScale=$Lt}},$Li.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){$LBi.getYawPitchRoll(this._localRotation,$LA._tempVector3);var $Lr=$LA._tempVector3,$Li=this._localRotationEuler;$Li[0]=$Lr[1]*$LA._angleToRandin,$Li[1]=$Lr[0]*$LA._angleToRandin,$Li[2]=$Lr[2]*$LA._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},$Li.setLocalRotationEuler=function($Lr){if(this._parent)$LBi._quaternionCreateFromYawPitchRollArray($Lr[1]/$LA._angleToRandin,$Lr[0]/$LA._angleToRandin,$Lr[2]/$LA._angleToRandin,this._localRotation),this._localRotationEuler=$Lr,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $Li=this._entity.owner._transform,$Lt=this._entity.localRotationEuler,$L_=$Lt.elements;$L_[0]=$Lr[0],$L_[1]=$Lr[1],$L_[2]=$Lr[2],$Li.localRotationEuler=$Lt}},$Li.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)$LBi.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var $Lr=this._getlocalMatrix(),$Li=0;$Li<16;++$Li)this._worldMatrix[$Li]=$Lr[$Li];this._worldUpdate=!1}return this._worldMatrix},$Li.setParent=function($Lr){if(this._parent!==$Lr){if(this._parent){var $Li=this._parent._childs,$Lt=$Li.indexOf(this);$Li.splice($Lt,1)}$Lr&&($Lr._childs.push(this),$Lr&&this._onWorldTransform()),this._parent=$Lr}},$LR($LA,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$LA}(),$Lni=function($Lr){function $Li(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,$Li.__super.call(this),this._destroyed=!1,this._id=$Li._uniqueIDCounter,$Li._uniqueIDCounter++}$Lv($Li,"laya.d3.component.Component3D",$Lf);var $Lt=$Li.prototype;return $LD.imps($Lt,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),$Lt._initialize=function($Lr){this._owner=$Lr,this._enable=!0,this.started=!1,this._load($Lr)},$Lt._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},$Lt._load=function($Lr){},$Lt._start=function($Lr){},$Lt._update=function($Lr){},$Lt._lateUpdate=function($Lr){},$Lt._preRenderUpdate=function($Lr){},$Lt._postRenderUpdate=function($Lr){},$Lt._unload=function($Lr){this.offAll()},$Lt._cloneTo=function($Lr){},$LO(0,$Lt,"id",function(){return this._id}),$LO(0,$Lt,"destroyed",function(){return this._destroyed}),$LO(0,$Lt,"owner",function(){return this._owner}),$LO(0,$Lt,"enable",function(){return this._enable},function($Lr){this._enable!==$Lr&&(this._enable=$Lr,this.event("enablechanged",this._enable))}),$LO(0,$Lt,"isSingleton",function(){return $Li._isSingleton}),$Li._isSingleton=!0,$Li._uniqueIDCounter=1,$Li}(),$Lai=function($Lr){function $Li(){this._destroyed=!1,$Li.__super.call(this),this._destroyed=!1}$Lv($Li,"laya.d3.core.GeometryFilter",$Lf);var $Lt=$Li.prototype;return $LD.imps($Lt,{"laya.resource.IDestroy":!0}),$Lt._destroy=function(){this.offAll(),this._destroyed=!0},$LO(0,$Lt,"_isAsyncLoaded",function(){return!0}),$LO(0,$Lt,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),$LO(0,$Lt,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),$LO(0,$Lt,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),$LO(0,$Lt,"destroyed",function(){return this._destroyed}),$Li}(),$LDi=function($Lr){function $L_($Lr){$L_.__super.call(this),this._id=++$L_._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new $LMr(new $LEi,new $LEi),this._boundingBoxCenter=new $LEi,this._boundingSphere=new $LSr(new $LEi,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=$Lr,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}$Lv($L_,"laya.d3.core.render.BaseRender",$Lf);var $Li=$L_.prototype;return $LD.imps($Li,{"laya.resource.IDestroy":!0}),$Li._changeMaterialReference=function($Lr,$Li){$Lr&&$Lr._removeReference(),$Li._addReference()},$Li._getInstanceMaterial=function($Lr,$Li){var $Lt=new $Lr.constructor;return $Lr.cloneTo($Lt),$Lt.name=$Lt.name+"(Instance)",this._materialsInstance[$Li]=!0,this._changeMaterialReference(this._materials[$Li],$Lt),this._materials[$Li]=$Lt},$Li._setShaderValuelightMap=function($Lr){this._setShaderValueTexture(3,$Lr)},$Li._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},$Li._renderRenderableBoundBox=function(){var $Lr=$Lyi._debugPhasorSprite,$Li=this.boundingBox,$Lt=$L_._tempBoundBoxCorners;$Li.getCorners($Lt),$Lr.line($Lt[0],$L_._greenColor,$Lt[1],$L_._greenColor),$Lr.line($Lt[2],$L_._greenColor,$Lt[3],$L_._greenColor),$Lr.line($Lt[4],$L_._greenColor,$Lt[5],$L_._greenColor),$Lr.line($Lt[6],$L_._greenColor,$Lt[7],$L_._greenColor),$Lr.line($Lt[0],$L_._greenColor,$Lt[3],$L_._greenColor),$Lr.line($Lt[1],$L_._greenColor,$Lt[2],$L_._greenColor),$Lr.line($Lt[2],$L_._greenColor,$Lt[6],$L_._greenColor),$Lr.line($Lt[3],$L_._greenColor,$Lt[7],$L_._greenColor),$Lr.line($Lt[0],$L_._greenColor,$Lt[4],$L_._greenColor),$Lr.line($Lt[1],$L_._greenColor,$Lt[5],$L_._greenColor),$Lr.line($Lt[4],$L_._greenColor,$Lt[7],$L_._greenColor),$Lr.line($Lt[5],$L_._greenColor,$Lt[6],$L_._greenColor)},$Li._calculateBoundingSphere=function(){throw"BaseRender: must override it."},$Li._calculateBoundingBox=function(){throw"BaseRender: must override it."},$Li._setShaderValueTexture=function($Lr,$Li){this._owner._shaderValues.setValue($Lr,$Li)},$Li._setShaderValueMatrix4x4=function($Lr,$Li){this._owner._shaderValues.setValue($Lr,$Li?$Li.elements:null)},$Li._setShaderValueColor=function($Lr,$Li){this._owner._shaderValues.setValue($Lr,$Li?$Li.elements:null)},$Li._setShaderValueBuffer=function($Lr,$Li){this._owner._shaderValues.setValue($Lr,$Li)},$Li._setShaderValueInt=function($Lr,$Li){this._owner._shaderValues.setValue($Lr,$Li)},$Li._setShaderValueBool=function($Lr,$Li){this._owner._shaderValues.setValue($Lr,$Li)},$Li._setShaderValueNumber=function($Lr,$Li){this._owner._shaderValues.setValue($Lr,$Li)},$Li._setShaderValueVector2=function($Lr,$Li){this._owner._shaderValues.setValue($Lr,$Li?$Li.elements:null)},$Li._addShaderDefine=function($Lr){this._owner._shaderDefineValue|=$Lr},$Li._removeShaderDefine=function($Lr){this._owner._shaderDefineValue&=~$Lr},$Li._renderUpdate=function($Lr){return!0},$Li._applyLightMapParams=function(){if(0<=this._lightmapIndex){var $Lr=this._owner.scene;if($Lr){var $Li=$Lr.getlightmaps()[this._lightmapIndex];$Li?(this._addShaderDefine($Lzi.SAHDERDEFINE_LIGHTMAP),$Li.loaded?this._setShaderValuelightMap($Li):$Li.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine($Lzi.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($Lzi.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($Lzi.SAHDERDEFINE_LIGHTMAP)},$Li._updateOctreeNode=function(){var $Lr=this._treeNode;$Lr&&this._octreeNodeNeedChange&&($Lr.updateObject(this),this._octreeNodeNeedChange=!1)},$Li._destroy=function(){this.offAll();var $Lr=0,$Li=0;for($Lr=0,$Li=this._renderElements.length;$Lr<$Li;$Lr++)this._renderElements[$Lr]._destroy();for($Lr=0,$Li=this._materials.length;$Lr<$Li;$Lr++)this._materials[$Lr]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},$LO(0,$Li,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),$LO(0,$Li,"id",function(){return this._id}),$LO(0,$Li,"material",function(){var $Lr=this._materials[0];if($Lr&&!this._materialsInstance[0]){var $Li=this._getInstanceMaterial($Lr,0);this.event("materialchanged",[this,0,$Li])}return this._materials[0]},function($Lr){this.sharedMaterial=$Lr}),$LO(0,$Li,"sharedMaterial",function(){return this._materials[0]},function($Lr){var $Li=this._materials[0];$Li!==$Lr&&(this._materials[0]=$Lr,this._materialsInstance[0]=!1,this._changeMaterialReference($Li,$Lr),this.event("materialchanged",[this,0,$Lr]))}),$LO(0,$Li,"lightmapIndex",function(){return this._lightmapIndex},function($Lr){this._lightmapIndex=$Lr,this._applyLightMapParams()}),$LO(0,$Li,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function($Lr){this._lightmapScaleOffset=$Lr,this._setShaderValueColor(2,$Lr),this._addShaderDefine($Lzi.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),$LO(0,$Li,"enable",function(){return this._enable},function($Lr){this._enable=$Lr,this.event("enablechanged",[this,$Lr])}),$LO(0,$Li,"materials",function(){for(var $Lr=0,$Li=this._materials.length;$Lr<$Li;$Lr++)if(!this._materialsInstance[$Lr]){var $Lt=this._getInstanceMaterial(this._materials[$Lr],$Lr);this.event("materialchanged",[this,$Lr,$Lt])}return this._materials.slice()},function($Lr){this.sharedMaterials=$Lr}),$LO(0,$Li,"sharedMaterials",function(){return this._materials.slice()},function($Lr){if(!$Lr)throw new Error("MeshRender: shadredMaterials value can't be null.");var $Li=$Lr.length;this._materialsInstance.length=$Li;for(var $Lt=0;$Lt<$Li;$Lt++){var $L_=this._materials[$Lt];$L_!==$Lr[$Lt]&&(this._materialsInstance[$Lt]=!1,this._changeMaterialReference($L_,$Lr[$Lt]),this.event("materialchanged",[this,$Lt,$Lr[$Lt]]))}this._materials=$Lr}),$LO(0,$Li,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),$LO(0,$Li,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var $Lr=this.boundingBox;$LEi.add($Lr.min,$Lr.max,this._boundingBoxCenter),$LEi.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),$LO(0,$Li,"receiveShadow",function(){return this._receiveShadow},function($Lr){this._receiveShadow!==$Lr&&((this._receiveShadow=$Lr)?this._addShaderDefine($Lvi.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine($Lvi.SHADERDEFINE_RECEIVE_SHADOW))}),$LO(0,$Li,"destroyed",function(){return this._destroyed}),$L_._uniqueIDCounter=0,$LR($L_,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new $LEi,new $LEi,new $LEi,new $LEi,new $LEi,new $LEi,new $LEi,new $LEi]},"_greenColor",function(){return this._greenColor=new $LGi(0,1,0,1)}]),$L_}(),$Lui=function($Lr){function $LG($Lr){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,$LG.__super.call(this),this._localPosition=new $LEi,this._localRotation=new $Lti(0,0,0,1),this._localScale=new $LEi(1,1,1),this._localRotationEuler=new $LEi,this._localMatrix=new $Lri,this._position=new $LEi,this._rotation=new $Lti(0,0,0,1),this._scale=new $LEi(1,1,1),this._worldMatrix=new $Lri,this._forward=new $LEi,this._up=new $LEi,this._right=new $LEi,this._owner=$Lr,this._childs=[]}$Lv($LG,"laya.d3.core.Transform3D",$Lf);var $Li=$LG.prototype;return $Li._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)$Lri.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var $Lr=$LG._tempVector30;$LEi.multiply(this.pivot,this._localScale,$Lr);var $Li=$LG._tempVector31;$LEi.subtract($Lr,this.pivot,$Li);var $Lt=$LG._tempVector32,$L_=this.localRotation;$LEi.transformQuat($Lr,$L_,$Lt),$LEi.subtract($Lt,$Lr,$Lt);var $LA=$LG._tempVector33;$LEi.subtract(this._localPosition,$Li,$LA),$LEi.subtract($LA,$Lt,$LA),$Lri.createAffineTransformation($LA,$L_,this._localScale,this._localMatrix)}},$Li._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $Lr=0,$Li=this._childs.length;$Lr<$Li;$Lr++)this._childs[$Lr]._onWorldPositionRotationTransform()}},$Li._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $Lr=0,$Li=this._childs.length;$Lr<$Li;$Lr++)this._childs[$Lr]._onWorldPositionScaleTransform()}},$Li._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var $Lr=0,$Li=this._childs.length;$Lr<$Li;$Lr++)this._childs[$Lr]._onWorldPositionTransform()}},$Li._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $Lr=0,$Li=this._childs.length;$Lr<$Li;$Lr++)this._childs[$Lr]._onWorldPositionRotationTransform()}},$Li._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $Lr=0,$Li=this._childs.length;$Lr<$Li;$Lr++)this._childs[$Lr]._onWorldPositionScaleTransform()}},$Li._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $Lr=0,$Li=this._childs.length;$Lr<$Li;$Lr++)this._childs[$Lr]._onWorldTransform()}},$Li.translate=function($Lr,$Li){void 0===$Li&&($Li=!0),$Li?($Lri.createFromQuaternion(this.localRotation,$LG._tempMatrix0),$LEi.transformCoordinate($Lr,$LG._tempMatrix0,$LG._tempVector30),$LEi.add(this.localPosition,$LG._tempVector30,this._localPosition),this.localPosition=this._localPosition):($LEi.add(this.position,$Lr,this._position),this.position=this._position)},$Li.rotate=function($Lr,$Li,$Lt){var $L_;void 0===$Li&&($Li=!0),void 0===$Lt&&($Lt=!0),$L_=$Lt?$Lr:($LEi.scale($Lr,Math.PI/180,$LG._tempVector30),$LG._tempVector30),$Lti.createFromYawPitchRoll($L_.y,$L_.x,$L_.z,$LG._tempQuaternion0),$Li?($Lti.multiply(this._localRotation,$LG._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):($Lti.multiply($LG._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},$Li.lookAt=function($Lr,$Li,$Lt){void 0===$Lt&&($Lt=!1);var $L_,$LA=$Lr.elements;if($Lt){if($L_=this._localPosition.elements,Math.abs($L_[0]-$LA[0])<$LYr.zeroTolerance&&Math.abs($L_[1]-$LA[1])<$LYr.zeroTolerance&&Math.abs($L_[2]-$LA[2])<$LYr.zeroTolerance)return;$Lti.lookAt(this._localPosition,$Lr,$Li,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var $Lf=this.position;if($L_=$Lf.elements,Math.abs($L_[0]-$LA[0])<$LYr.zeroTolerance&&Math.abs($L_[1]-$LA[1])<$LYr.zeroTolerance&&Math.abs($L_[2]-$LA[2])<$LYr.zeroTolerance)return;$Lti.lookAt($Lf,$Lr,$Li,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},$LO(0,$Li,"_isFrontFaceInvert",function(){var $Lr=this.scale,$Li=$Lr.x<0;return $Lr.y<0&&($Li=!$Li),$Lr.z<0&&($Li=!$Li),$Li}),$LO(0,$Li,"owner",function(){return this._owner}),$LO(0,$Li,"localRotation",function(){if(this._localQuaternionUpdate){var $Lr=this._localRotationEuler.elements;$Lti.createFromYawPitchRoll($Lr[1]/$LG._angleToRandin,$Lr[0]/$LG._angleToRandin,$Lr[2]/$LG._angleToRandin,this._localRotation)}return this._localRotation},function($Lr){this._localRotation=$Lr,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$LO(0,$Li,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?$Lri.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function($Lr){null===this._parent?$Lr.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),$Lri.multiply(this._localMatrix,$Lr,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=$Lr,this._worldUpdate=!1}),$LO(0,$Li,"worldNeedUpdate",function(){return this._worldUpdate}),$LO(0,$Li,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function($Lr){this._localMatrix=$Lr,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),$LO(0,$Li,"dummy",function(){return this._dummy},function($Lr){this._dummy!==$Lr&&(this._dummy&&(this._dummy._entity=null),$Lr&&($Lr._entity=this),this._dummy=$Lr)}),$LO(0,$Li,"localPosition",function(){return this._localPosition},function($Lr){this._localPosition=$Lr,this._localUpdate=!0,this._onWorldPositionTransform()}),$LO(0,$Li,"position",function(){if(this._positionUpdate){if(null!=this._parent){var $Lr=this._parent.position;$LEi.multiply(this._localPosition,this._parent.scale,$LG._tempVector30),$LEi.transformQuat($LG._tempVector30,this._parent.rotation,$LG._tempVector30),$LEi.add($Lr,$LG._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function($Lr){if(null!=this._parent){$LEi.subtract($Lr,this._parent.position,this._localPosition);var $Li=this._parent.scale.elements,$Lt=$Li[0],$L_=$Li[1],$LA=$Li[2];if(1!==$Lt||1!==$L_||1!==$LA){var $Lf=$LG._tempVector30,$LE=$Lf.elements;$LE[0]=1/$Lt,$LE[1]=1/$L_,$LE[2]=1/$LA,$LEi.multiply(this._localPosition,$Lf,this._localPosition)}this._parent.rotation.invert($LG._tempQuaternion0),$LEi.transformQuat(this._localPosition,$LG._tempQuaternion0,this._localPosition)}else $Lr.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=$Lr,this._positionUpdate=!1}),$LO(0,$Li,"localScale",function(){return this._localScale},function($Lr){this._localScale=$Lr,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),$LO(0,$Li,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll($LG._tempVector30);var $Lr=$LG._tempVector30.elements,$Li=this._localRotationEuler.elements;$Li[0]=$Lr[1]*$LG._angleToRandin,$Li[1]=$Lr[0]*$LG._angleToRandin,$Li[2]=$Lr[2]*$LG._angleToRandin}return this._localRotationEuler},function($Lr){this._localRotationEuler=$Lr,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$LO(0,$Li,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?$Lti.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function($Lr){null!=this._parent?(this._parent.rotation.invert($LG._tempQuaternion0),$Lti.multiply($Lr,$LG._tempQuaternion0,this._localRotation)):$Lr.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=$Lr,this._rotationUpdate=!1}),$LO(0,$Li,"scale",function(){return this._scaleUpdate&&(null!==this._parent?$LEi.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function($Lr){if(null!==this._parent){var $Li=this._parent.scale.elements,$Lt=$LG._tempVector30.elements;$Lt[0]=1/$Li[0],$Lt[1]=1/$Li[1],$Lt[2]=1/$Li[2],$LEi.multiply($Lr,$LG._tempVector30,this._localScale)}else $Lr.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=$Lr,this._scaleUpdate=!1}),$LO(0,$Li,"rotationEuler",null,function($Lr){$Lti.createFromYawPitchRoll($Lr.y,$Lr.x,$Lr.z,this._rotation),this.rotation=this._rotation}),$LO(0,$Li,"forward",function(){var $Lr=this.worldMatrix.elements;return this._forward.elements[0]=-$Lr[8],this._forward.elements[1]=-$Lr[9],this._forward.elements[2]=-$Lr[10],this._forward}),$LO(0,$Li,"up",function(){var $Lr=this.worldMatrix.elements;return this._up.elements[0]=$Lr[4],this._up.elements[1]=$Lr[5],this._up.elements[2]=$Lr[6],this._up}),$LO(0,$Li,"right",function(){var $Lr=this.worldMatrix.elements;return this._right.elements[0]=$Lr[0],this._right.elements[1]=$Lr[1],this._right.elements[2]=$Lr[2],this._right}),$LO(0,$Li,"parent",function(){return this._parent},function($Lr){if(this._parent!==$Lr){if(this._parent){var $Li=this._parent._childs,$Lt=$Li.indexOf(this);$Li.splice($Lt,1)}$Lr&&($Lr._childs.push(this),$Lr&&this._onWorldTransform()),this._parent=$Lr}}),$LR($LG,["_tempVector30",function(){return this._tempVector30=new $LEi},"_tempVector31",function(){return this._tempVector31=new $LEi},"_tempVector32",function(){return this._tempVector32=new $LEi},"_tempVector33",function(){return this._tempVector33=new $LEi},"_tempQuaternion0",function(){return this._tempQuaternion0=new $Lti},"_tempMatrix0",function(){return this._tempMatrix0=new $Lri},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$LG}(),$Lwi=(function($Lr){function $Li(){this._rotation=0,this._matNeedUpdte=!1,$Li.__super.call(this),this._matrix=new $Lri,this._offset=new $Lfi,this._tiling=new $Lfi(1,1)}$Lv($Li,"laya.d3.core.TransformUV",$Lf);var $Lt=$Li.prototype;$LD.imps($Lt,{"laya.d3.core.IClone":!0}),$Lt._updateMatrix=function(){$Li._tempOffsetV3.elements[0]=this._offset.x,$Li._tempOffsetV3.elements[1]=this._offset.y,$Lti.createFromYawPitchRoll(0,0,this._rotation,$Li._tempRotationQua),$Li._tempTitlingV3.elements[0]=this._tiling.x,$Li._tempTitlingV3.elements[1]=this._tiling.y,$Lri.createAffineTransformation($Li._tempOffsetV3,$Li._tempRotationQua,$Li._tempTitlingV3,this._matrix)},$Lt.cloneTo=function($Lr){$Lr._matrix=this._matrix.clone(),$Lr._offset=this._offset.clone(),$Lr._rotation=this._rotation,$Lr._tiling=this._tiling.clone()},$Lt.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Lt,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),$LO(0,$Lt,"tiling",function(){return this._tiling},function($Lr){this._tiling=$Lr,this._matNeedUpdte=!0}),$LO(0,$Lt,"offset",function(){return this._offset},function($Lr){this._offset=$Lr,this._matNeedUpdte=!0}),$LO(0,$Lt,"rotation",function(){return this._rotation},function($Lr){this._rotation=$Lr,this._matNeedUpdte=!0}),$LR($Li,["_tempOffsetV3",function(){return this._tempOffsetV3=new $LEi(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new $Lti},"_tempTitlingV3",function(){return this._tempTitlingV3=new $LEi(1,1,1)}])}(),function($Lt){function $Lr(){this.x=NaN,this.y=NaN,this.z=NaN,$Lr.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}$Lv($Lr,"laya.d3.core.particleShuriKen.module.shape.BoxShape",$Lt);var $Li=$Lr.prototype;$Li._getShapeBoundBox=function($Lr){var $Li=$Lr.min.elements;$Li[0]=.5*-this.x,$Li[1]=.5*-this.y,$Li[2]=.5*-this.z;var $Lt=$Lr.max.elements;$Lt[0]=.5*this.x,$Lt[1]=.5*this.y,$Lt[2]=.5*this.z},$Li._getSpeedBoundBox=function($Lr){var $Li=$Lr.min.elements;$Li[0]=0,$Li[1]=0,$Li[2]=0;var $Lt=$Lr.max.elements;$Lt[0]=0,$Lt[1]=1,$Lt[2]=0},$Li.generatePositionAndDirection=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.elements,$Lf=$Li.elements;$Lt?($Lt.seed=$L_[16],$Lo._randomPointInsideHalfUnitBox($Lr,$Lt),$L_[16]=$Lt.seed):$Lo._randomPointInsideHalfUnitBox($Lr),$LA[0]=this.x*$LA[0],$LA[1]=this.y*$LA[1],$LA[2]=this.z*$LA[2],this.randomDirection?$Lt?($Lt.seed=$L_[17],$Lo._randomPointUnitSphere($Li,$Lt),$L_[17]=$Lt.seed):$Lo._randomPointUnitSphere($Li):($Lf[0]=0,$Lf[1]=0,$Lf[2]=1)},$Li.cloneTo=function($Lr){$Lt.prototype.cloneTo.call(this,$Lr);var $Li=$Lr;$Li.x=this.x,$Li.y=this.y,$Li.z=this.z,$Li.randomDirection=this.randomDirection}}($Lq),function($Lt){function $LE(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,$LE.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}$Lv($LE,"laya.d3.core.particleShuriKen.module.shape.CircleShape",$Lt);var $Lr=$LE.prototype;$Lr._getShapeBoundBox=function($Lr){var $Li=$Lr.min.elements;$Li[0]=$Li[2]=-this.radius,$Li[1]=0;var $Lt=$Lr.max.elements;$Lt[0]=$Lt[2]=this.radius,$Lt[1]=0},$Lr._getSpeedBoundBox=function($Lr){var $Li=$Lr.min.elements;$Li[0]=$Li[1]=-1,$Li[2]=0;var $Lt=$Lr.max.elements;$Lt[0]=$Lt[1]=1,$Lt[2]=0},$Lr.generatePositionAndDirection=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.elements,$Lf=$LE._tempPositionPoint.elements;$Lt?($Lt.seed=$L_[16],this.emitFromEdge?$Lo._randomPointUnitArcCircle(this.arc,$LE._tempPositionPoint,$Lt):$Lo._randomPointInsideUnitArcCircle(this.arc,$LE._tempPositionPoint,$Lt),$L_[16]=$Lt.seed):this.emitFromEdge?$Lo._randomPointUnitArcCircle(this.arc,$LE._tempPositionPoint):$Lo._randomPointInsideUnitArcCircle(this.arc,$LE._tempPositionPoint),$LA[0]=-$Lf[0],$LA[1]=$Lf[1],$LA[2]=0,$LEi.scale($Lr,this.radius,$Lr),this.randomDirection?$Lt?($Lt.seed=$L_[17],$Lo._randomPointUnitSphere($Li,$Lt),$L_[17]=$Lt.seed):$Lo._randomPointUnitSphere($Li):$Lr.cloneTo($Li)},$Lr.cloneTo=function($Lr){$Lt.prototype.cloneTo.call(this,$Lr);var $Li=$Lr;$Li.radius=this.radius,$Li.arc=this.arc,$Li.emitFromEdge=this.emitFromEdge,$Li.randomDirection=this.randomDirection},$LR($LE,["_tempPositionPoint",function(){return this._tempPositionPoint=new $Lfi}])}($Lq),function($Lt){function $LX(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,$LX.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}$Lv($LX,"laya.d3.core.particleShuriKen.module.shape.ConeShape",$Lt);var $Lr=$LX.prototype;$Lr._getShapeBoundBox=function($Lr){var $Li=this.radius+this.length*Math.sin(this.angle),$Lt=this.length*Math.cos(this.angle),$L_=$Lr.min.elements;$L_[0]=$L_[1]=-$Li,$L_[2]=0;var $LA=$Lr.max.elements;$LA[0]=$LA[1]=$Li,$LA[2]=$Lt},$Lr._getSpeedBoundBox=function($Lr){var $Li=Math.sin(this.angle),$Lt=$Lr.min.elements;$Lt[0]=$Lt[1]=-$Li,$Lt[2]=0;var $L_=$Lr.max.elements;$L_[0]=$Lt[1]=$Li,$L_[2]=1},$Lr.generatePositionAndDirection=function($Lr,$Li,$Lt,$L_){var $LA,$Lf=$Lr.elements,$LE=$Li.elements,$LG=$LX._tempPositionPoint.elements,$LN=NaN,$Lp=NaN,$Lg=Math.cos(this.angle),$LR=Math.sin(this.angle);switch(this.emitType){case 0:$Lt?($Lt.seed=$L_[16],$Lo._randomPointInsideUnitCircle($LX._tempPositionPoint,$Lt),$L_[16]=$Lt.seed):$Lo._randomPointInsideUnitCircle($LX._tempPositionPoint),$LN=$LG[0],$Lp=$LG[1],$Lf[0]=$LN*this.radius,$Lf[1]=$Lp*this.radius,$Lf[2]=0,this.randomDirection?($Lt?($Lt.seed=$L_[17],$Lo._randomPointInsideUnitCircle($LX._tempDirectionPoint,$Lt),$L_[17]=$Lt.seed):$Lo._randomPointInsideUnitCircle($LX._tempDirectionPoint),$LA=$LX._tempDirectionPoint.elements,$LE[0]=$LA[0]*$LR,$LE[1]=$LA[1]*$LR):($LE[0]=$LN*$LR,$LE[1]=$Lp*$LR),$LE[2]=$Lg;break;case 1:$Lt?($Lt.seed=$L_[16],$Lo._randomPointUnitCircle($LX._tempPositionPoint,$Lt),$L_[16]=$Lt.seed):$Lo._randomPointUnitCircle($LX._tempPositionPoint),$LN=$LG[0],$Lp=$LG[1],$Lf[0]=$LN*this.radius,$Lf[1]=$Lp*this.radius,$Lf[2]=0,this.randomDirection?($Lt?($Lt.seed=$L_[17],$Lo._randomPointInsideUnitCircle($LX._tempDirectionPoint,$Lt),$L_[17]=$Lt.seed):$Lo._randomPointInsideUnitCircle($LX._tempDirectionPoint),$LA=$LX._tempDirectionPoint.elements,$LE[0]=$LA[0]*$LR,$LE[1]=$LA[1]*$LR):($LE[0]=$LN*$LR,$LE[1]=$Lp*$LR),$LE[2]=$Lg;break;case 2:$Lt?($Lt.seed=$L_[16],$Lo._randomPointInsideUnitCircle($LX._tempPositionPoint,$Lt)):$Lo._randomPointInsideUnitCircle($LX._tempPositionPoint),$LN=$LG[0],$Lp=$LG[1],$Lf[0]=$LN*this.radius,$Lf[1]=$Lp*this.radius,$LE[$Lf[2]=0]=$LN*$LR,$LE[1]=$Lp*$LR,$LE[2]=$Lg,$LEi.normalize($Li,$Li),$Lt?($LEi.scale($Li,this.length*$Lt.getFloat(),$Li),$L_[16]=$Lt.seed):$LEi.scale($Li,this.length*Math.random(),$Li),$LEi.add($Lr,$Li,$Lr),this.randomDirection&&($Lt?($Lt.seed=$L_[17],$Lo._randomPointUnitSphere($Li,$Lt),$L_[17]=$Lt.seed):$Lo._randomPointUnitSphere($Li));break;case 3:$Lt?($Lt.seed=$L_[16],$Lo._randomPointUnitCircle($LX._tempPositionPoint,$Lt)):$Lo._randomPointUnitCircle($LX._tempPositionPoint),$LN=$LG[0],$Lp=$LG[1],$Lf[0]=$LN*this.radius,$Lf[1]=$Lp*this.radius,$LE[$Lf[2]=0]=$LN*$LR,$LE[1]=$Lp*$LR,$LE[2]=$Lg,$LEi.normalize($Li,$Li),$Lt?($LEi.scale($Li,this.length*$Lt.getFloat(),$Li),$L_[16]=$Lt.seed):$LEi.scale($Li,this.length*Math.random(),$Li),$LEi.add($Lr,$Li,$Lr),this.randomDirection&&($Lt?($Lt.seed=$L_[17],$Lo._randomPointUnitSphere($Li,$Lt),$L_[17]=$Lt.seed):$Lo._randomPointUnitSphere($Li));break;default:throw new Error("ConeShape:emitType is invalid.")}},$Lr.cloneTo=function($Lr){$Lt.prototype.cloneTo.call(this,$Lr);var $Li=$Lr;$Li.angle=this.angle,$Li.radius=this.radius,$Li.length=this.length,$Li.emitType=this.emitType,$Li.randomDirection=this.randomDirection},$LR($LX,["_tempPositionPoint",function(){return this._tempPositionPoint=new $Lfi},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new $Lfi}])}($Lq),function($Lt){function $Lr(){this.radius=NaN,this.emitFromShell=!1,$Lr.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$Lv($Lr,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",$Lt);var $Li=$Lr.prototype;$Li._getShapeBoundBox=function($Lr){var $Li=$Lr.min.elements;$Li[0]=$Li[1]=$Li[2]=-this.radius;var $Lt=$Lr.max.elements;$Lt[0]=$Lt[1]=this.radius,$Lt[2]=0},$Li._getSpeedBoundBox=function($Lr){var $Li=$Lr.min.elements;$Li[0]=$Li[1]=-1,$Li[2]=0;var $Lt=$Lr.max.elements;$Lt[0]=$Lt[1]=$Lt[2]=1},$Li.generatePositionAndDirection=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.elements;$Lt?($Lt.seed=$L_[16],this.emitFromShell?$Lo._randomPointUnitSphere($Lr,$Lt):$Lo._randomPointInsideUnitSphere($Lr,$Lt),$L_[16]=$Lt.seed):this.emitFromShell?$Lo._randomPointUnitSphere($Lr):$Lo._randomPointInsideUnitSphere($Lr),$LEi.scale($Lr,this.radius,$Lr);var $Lf=$LA[2];$Lf<0&&($LA[2]=-1*$Lf),this.randomDirection?$Lt?($Lt.seed=$L_[17],$Lo._randomPointUnitSphere($Li,$Lt),$L_[17]=$Lt.seed):$Lo._randomPointUnitSphere($Li):$Lr.cloneTo($Li)},$Li.cloneTo=function($Lr){$Lt.prototype.cloneTo.call(this,$Lr);var $Li=$Lr;$Li.radius=this.radius,$Li.emitFromShell=this.emitFromShell,$Li.randomDirection=this.randomDirection}}($Lq),function($Lt){function $Lr(){this.radius=NaN,this.emitFromShell=!1,$Lr.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$Lv($Lr,"laya.d3.core.particleShuriKen.module.shape.SphereShape",$Lt);var $Li=$Lr.prototype;$Li._getShapeBoundBox=function($Lr){var $Li=$Lr.min.elements;$Li[0]=$Li[1]=$Li[2]=-this.radius;var $Lt=$Lr.max.elements;$Lt[0]=$Lt[1]=$Lt[2]=this.radius},$Li._getSpeedBoundBox=function($Lr){var $Li=$Lr.min.elements;$Li[0]=$Li[1]=$Li[2]=-1;var $Lt=$Lr.max.elements;$Lt[0]=$Lt[1]=$Lt[2]=1},$Li.generatePositionAndDirection=function($Lr,$Li,$Lt,$L_){$Lt?($Lt.seed=$L_[16],this.emitFromShell?$Lo._randomPointUnitSphere($Lr,$Lt):$Lo._randomPointInsideUnitSphere($Lr,$Lt),$L_[16]=$Lt.seed):this.emitFromShell?$Lo._randomPointUnitSphere($Lr):$Lo._randomPointInsideUnitSphere($Lr),$LEi.scale($Lr,this.radius,$Lr),this.randomDirection?$Lt?($Lt.seed=$L_[17],$Lo._randomPointUnitSphere($Li,$Lt),$L_[17]=$Lt.seed):$Lo._randomPointUnitSphere($Li):$Lr.cloneTo($Li)},$Li.cloneTo=function($Lr){$Lt.prototype.cloneTo.call(this,$Lr);var $Li=$Lr;$Li.radius=this.radius,$Li.emitFromShell=this.emitFromShell,$Li.randomDirection=this.randomDirection}}($Lq),function($Lr){function $Li(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,$Li.__super.call(this)}return $Lv($Li,"laya.d3.core.render.SubMeshRenderElement",$LJ),$Li}()),$LHi=function($Lr){function $LB($Lr,$Li,$Lt,$L_,$LA,$Lf){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=$Lr,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[$Lvi.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[$Lzi.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[$Lzi.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[$LUi.SHADERDEFINE_ALPHATEST]="ALPHATEST";$LB.__super.call(this,$Lr,$Li,$Lt,null,{}),this._attributeMap=$L_;var $LE;for($LE in $LA){var $LG=$LA[$LE];switch($LG[1]){case 0:this._renderElementUniformMap[$LE]=$LG[0];break;case 1:this._materialUniformMap[$LE]=$LG[0];break;case 2:this._spriteUniformMap[$LE]=$LG[0];break;case 3:this._cameraUniformMap[$LE]=$LG[0];break;case 4:this._sceneUniformMap[$LE]=$LG[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}$Lv($LB,"laya.d3.shader.ShaderCompile3D",$Ln);var $Li=$LB.prototype;return $Li._definesToNameDic=function($Lr,$Li){for(var $Lt={},$L_=1,$LA=0;$LA<32&&!($Lr<($L_=1<<$LA));$LA++)if($Lr&$L_){var $Lf=$Li[$L_];$Lf&&($Lt[$Lf]="")}return $Lt},$Li.withCompile=function($Lr,$Li,$Lt,$L_){var $LA,$Lf,$LE;if($Lf=this.sharders[$Lr])if($LE=$Lf[$Li]){if($LA=$LE[$Lt])return $LA}else $LE=$Lf[$Li]=[];else $LE=($Lf=this.sharders[$Lr]=[])[$Li]=[];var $LG,$LN=this._definesToNameDic($Lr,$LB._globalInt2name),$Lp=this._definesToNameDic($Li,this._spriteInt2name),$Lg=this._definesToNameDic($Lt,this._materialInt2name),$LR={},$LX="";if($LN)for($LG in $LN)$LX+="#define "+$LG+"\n",$LR[$LG]=!0;if($Lp)for($LG in $Lp)$LX+="#define "+$LG+"\n",$LR[$LG]=!0;if($Lg)for($LG in $Lg)$LX+="#define "+$LG+"\n",$LR[$LG]=!0;var $Lv=$LVi.nameKey.getName(this._name)+" compile ("+$Lr+","+$Li+","+$Lt+")",$LO=this._VS.toscript($LR,[]),$Lc=this._PS.toscript($LR,[]);$LL.now();if($LA=$LVi.create($LX+$LO.join("\n"),$LX+$Lc.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,$L_,$Lv),$LE[$Lt]=$LA,laya.d3.shader.ShaderCompile3D.debugMode)$LL.now();return $LA},$Li.precompileShaderWithShaderDefine=function($Lr,$Li,$Lt){this.withCompile($Lr,$Li,$Lt,!0)},$Li.addMaterialDefines=function($Lr){var $Li=$Lr.defines;for(var $Lt in $Li){var $L_=$Li[$Lt],$LA=parseInt($Lt);this._materialInt2name[$LA]=$L_,this._materialName2Int[$L_]=$LA}},$Li.addSpriteDefines=function($Lr){var $Li=$Lr.defines;for(var $Lt in $Li){var $L_=$Li[$Lt],$LA=parseInt($Lt);this._spriteInt2name[$LA]=$L_,this._spriteName2Int[$L_]=$LA}},$Li.getMaterialDefineByName=function($Lr){return this._materialName2Int[$Lr]},$Li.registerMaterialDefine=function($Lr){var $Li=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[$Li]=$Lr,this._materialName2Int[$Lr]=$Li},$Li.registerSpriteDefine=function($Lr){var $Li=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[$Li]=$Lr,this._spriteName2Int[$Lr]=$Li},$LB._globalRegDefine=function($Lr,$Li){$LB._globalInt2name[$Li]=$Lr},$LB.add=function($Lr,$Li,$Lt,$L_,$LA){return laya.d3.shader.ShaderCompile3D._preCompileShader[$Lr]=new $LB($Lr,$Li,$Lt,$L_,$LA,$Ln.includes)},$LB.get=function($Lr){return laya.d3.shader.ShaderCompile3D._preCompileShader[$LVi.nameKey.getID($Lr)]},$LB._preCompileShader={},$LB._globalInt2name=[],$LB.debugMode=!1,$LB.SHADERDEFINE_HIGHPRECISION=1,$LB.SHADERDEFINE_FOG=4,$LB.SHADERDEFINE_DIRECTIONLIGHT=8,$LB.SHADERDEFINE_POINTLIGHT=16,$LB.SHADERDEFINE_SPOTLIGHT=32,$LB.SHADERDEFINE_UV0=64,$LB.SHADERDEFINE_COLOR=128,$LB.SHADERDEFINE_UV1=256,$LB.SAHDERDEFINE_DEPTHFOG=131072,$LB}(),$Lsi=function($Lr){function $LO(){$LO.__super.call(this)}$Lv($LO,"laya.d3.graphics.MeshSprite3DStaticBatchManager",$L_r);var $Li=$LO.prototype;return $Li._getStaticBatch=function($Lr,$Li,$Lt,$L_){var $LA,$Lf;return $Lf=$Lr?$Lr.id.toString()+$Lt.id.toString()+$Li.id.toString()+$L_.toString():$Lt.id.toString()+$Li.id.toString()+$L_.toString(),this._staticBatches[$Lf]?$LA=this._staticBatches[$Lf]:this._staticBatches[$Lf]=$LA=new $Ldi($Lf,this,$Lr,$Li,$Lt),$LA},$Li._initStaticBatchs=function($Lr){var $Li,$Lt;this._initBatchRenderElements.sort($LO._sortPrepareStaticBatch);for(var $L_,$LA=!1,$Lf=0,$LE=0,$LG=this._initBatchRenderElements.length;$LE<$LG;$LE++){var $LN,$Lp=this._initBatchRenderElements[$LE],$Lg=$Lp.renderObj._getVertexBuffer(0);$Lp._sprite3D;if($Lt===$Lg.vertexDeclaration&&$Li===$Lp._material)if($LA)$L_._addCombineBatchRenderObjTest($Lp)?($LN=$Lp._staticBatch)!==$L_&&($LN&&$LN._deleteCombineBatchRenderObj($Lp),$L_._addCombineBatchRenderObj($Lp)):($LA=!1,$Lf++);else{var $LR=this._initBatchRenderElements[$LE-1],$LX=$LR.renderObj,$Lv=$Lp.renderObj;$LA=!(65535<$LX._getVertexBuffer().vertexCount+$Lv._getVertexBuffer().vertexCount)&&($L_=this._getStaticBatch($Lr,$Lt,$Li,$Lf),($LN=$LR._staticBatch)!==$L_&&($LN&&$LN._deleteCombineBatchRenderObj($LR),$L_._addCombineBatchRenderObj($LR)),($LN=$Lp._staticBatch)!==$L_&&($LN&&$LN._deleteCombineBatchRenderObj($Lp),$L_._addCombineBatchRenderObj($Lp)),!0)}else $LA=!1,$Lf=0;$Li=$Lp._material,$Lt=$Lg.vertexDeclaration}},$LO._sortPrepareStaticBatch=function($Lr,$Li){var $Lt=$Lr._render,$L_=$Li._render,$LA=$Lt.lightmapIndex-$L_.lightmapIndex;if(0!=$LA)return $LA;var $Lf=$Lt.receiveShadow-$L_.receiveShadow;if(0!=$Lf)return $Lf;var $LE=$Lr._mainSortID-$Li._mainSortID;return 0==$LE?$Lr.renderObj.triangleCount-$Li.renderObj.triangleCount:$LE},$LO}(),$Ldi=function($Lr){function $Lf($Lr,$Li,$Lt,$L_,$LA){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,$Lf.__super.call(this,$Lr,$Li,$Lt),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=$L_,this._material=$LA}$Lv($Lf,"laya.d3.graphics.SubMeshStaticBatch",$LAr);var $Li=$Lf.prototype;return $Li._compareBatchRenderElement=function($Lr,$Li){return $Lr._batchIndexStart>$Li._batchIndexStart},$Li._addCombineBatchRenderObjTest=function($Lr){var $Li=$Lr.renderObj._vertexCount;return!(65535<(0<$Li?this._currentCombineVertexCount+$Li:this._currentCombineVertexCount+$Lr.renderObj._getVertexBuffer().vertexCount))},$Li._addCombineBatchRenderObj=function($Lr){var $Li=$Lr.renderObj,$Lt=$Li._vertexCount;this._initBatchRenderElements.push($Lr),$Lr._staticBatch=this,0<$Lt?(this._currentCombineIndexCount+=$Li._indexCount,this._currentCombineVertexCount+=$Lt):(this._currentCombineIndexCount=this._currentCombineIndexCount+$Li._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$Li._getVertexBuffer().vertexCount),this._needFinishCombine=!0},$Li._deleteCombineBatchRenderObj=function($Lr){var $Li=$Lr.renderObj,$Lt=this._initBatchRenderElements.indexOf($Lr);if(-1!==$Lt){this._initBatchRenderElements.splice($Lt,1),$Lr._staticBatch=null;var $L_=$Li._vertexCount;0<$L_?(this._currentCombineIndexCount=this._currentCombineIndexCount-$Li._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$L_):(this._currentCombineIndexCount=this._currentCombineIndexCount-$Li._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$Li._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},$Li._finishInit=function(){if(this._needFinishCombine){var $Lr=0,$Li=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var $Lt=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),$L_=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=$Lqi.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=$LPi.create("ushort",this._currentCombineIndexCount,35044);for(var $LA=0,$Lf=this._initBatchRenderElements.length;$LA<$Lf;$LA++){var $LE=this._initBatchRenderElements[$LA],$LG=$LE.renderObj,$LN=$LG._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,$LE._sprite3D),$Lp=$LG.getIndices(),$Lg=$LE._sprite3D.transform._isFrontFaceInvert,$LR=$Lr/(this._vertexDeclaration.vertexStride/4)-$LG._vertexStart,$LX=$Li,$Lv=$LX+$Lp.length;$LE._batchIndexStart=$LX,$LE._batchIndexEnd=$Lv,$L_.set($Lp,$Li);var $LO=0;if($Lg)for($LO=$LX;$LO<$Lv;$LO+=3){$L_[$LO]=$LR+$L_[$LO];var $Lc=$L_[$LO+1],$LB=$L_[$LO+2];$L_[$LO+1]=$LR+$LB,$L_[$LO+2]=$LR+$Lc}else for($LO=$LX;$LO<$Lv;$LO+=3)$L_[$LO]=$LR+$L_[$LO],$L_[$LO+1]=$LR+$L_[$LO+1],$L_[$LO+2]=$LR+$L_[$LO+2];$Li+=$Lp.length,$Lt.set($LN,$Lr),$Lr+=$LN.length}this._vertexBuffer.setData($Lt),this._indexBuffer.setData($L_),this._needFinishCombine=!1}},$Li._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new $Lwi)},$Li._getRenderElement=function($Lr,$Li,$Lt){for(var $L_,$LA,$Lf=this._batchRenderElements.length,$LE=!0,$LG=0;$LG<$Lf;$LG++){var $LN,$Lp,$Lg=($LA=this._batchRenderElements[$LG])._sprite3D._render;if(0!==$LG&&($LE=($LN=($L_=this._batchRenderElements[$LG-1])._sprite3D._render).lightmapIndex!==$Lg.lightmapIndex||$LN.receiveShadow!==$Lg.receiveShadow||$L_._batchIndexEnd!==$LA._batchIndexStart),$LE){($Lp=this._getCombineRenderElementFromPool()).renderObj=this,$Lp._material=this._material,$Lp._batchIndexStart=$LA._batchIndexStart,$Lp._batchIndexEnd=$LA._batchIndexEnd;var $LR=$Lg.lightmapIndex,$LX=$LR+1,$Lv=this._batchOwnerIndices[$LX];$Lv||($Lv=this._batchOwnerIndices[$LX]=[]);var $LO,$Lc=$Lv[$LA._render.receiveShadow?1:0];void 0===$Lc?($Lv[$Lg.receiveShadow?1:0]=this._batchOwners.length,($LO=new $LZi(null,"StaticBatchMeshSprite3D"))._scene=$Li,$LO._transform=this._rootOwner?this._rootOwner._transform:null,$LO._render.lightmapIndex=$LR,$LO._render.receiveShadow=$LA._render.receiveShadow,this._batchOwners.push($LO)):$LO=this._batchOwners[$Lc],$LO._render._renderUpdate($Lt),$Lp._sprite3D=$LO,$Lr.push($Lp)}else $Lp._batchIndexEnd=$LA._batchIndexEnd}},$Li._beforeRender=function($Lr){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$Li._render=function($Lr){var $Li=$Lr.renderElement,$Lt=$Li._batchIndexStart,$L_=$Li._batchIndexEnd-$Lt;$Lk.mainContext.drawElements(4,$L_,5123,2*$Lt),$LH.drawCall++,$LH.trianglesFaces+=$L_/3},$Li.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},$Li._getVertexBuffer=function($Lr){return void 0===$Lr&&($Lr=0),this._vertexBuffer},$Lf}(),$Lli=function($Lr){function $Li(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,$Li.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}$Lv($Li,"laya.d3.core.ComponentNode",$Lp);var $Lt=$Li.prototype;return $Lt.addComponent=function($Lr){var $Li,$Lt=this._componentsMap.indexOf($Lr);if(-1===$Lt)$Li=[],this._componentsMap.push($Lr),this._typeComponentsIndices.push($Li);else if($Li=this._typeComponentsIndices[$Lt],this._components[$Li[0]].isSingleton)throw new Error("无法单实例创建"+$Lr+"组件，"+$Lr+"组件已存在！");var $L_=$LA.getInstance($Lr);return $Li.push(this._components.length),this._components.push($L_),$L_ instanceof laya.d3.component.Script&&this._scripts.push($L_),$L_._initialize(this),$L_},$Lt._removeComponent=function($Lr,$Li){var $Lt=this._typeComponentsIndices[$Lr],$L_=$Lt[$Li],$LA=this._components[$L_];this._components.splice($L_,1),$LA instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($LA),1),$Lt.splice($Li,1),0===$Lt.length&&(this._typeComponentsIndices.splice($Lr,1),this._componentsMap.splice($Lr,1));for(var $Lf=0,$LE=this._componentsMap.length;$Lf<$LE;$Lf++)for(var $LG=($Lt=this._typeComponentsIndices[$Lf]).length-1;0<=$LG;$LG--){var $LN=$Lt[$LG];if(!($L_<$LN))break;$Lt[$LG]=--$LN}$LA._destroy()},$Lt.getComponentByType=function($Lr,$Li){void 0===$Li&&($Li=0);var $Lt=this._componentsMap.indexOf($Lr);return-1===$Lt?null:this._components[this._typeComponentsIndices[$Lt][$Li]]},$Lt.getComponentsByType=function($Lr,$Li){var $Lt=this._componentsMap.indexOf($Lr);if(-1!==$Lt){var $L_=this._typeComponentsIndices[$Lt],$LA=$L_.length;$Li.length=$LA;for(var $Lf=0;$Lf<$LA;$Lf++)$Li[$Lf]=this._components[$L_[$Lf]]}else $Li.length=0},$Lt.getComponentByIndex=function($Lr){return this._components[$Lr]},$Lt.removeComponentByType=function($Lr,$Li){void 0===$Li&&($Li=0);var $Lt=this._componentsMap.indexOf($Lr);-1!==$Lt&&this._removeComponent($Lt,$Li)},$Lt.removeComponentsByType=function($Lr){var $Li=this._componentsMap.indexOf($Lr);if(-1!==$Li)for(var $Lt=this._typeComponentsIndices[$Li],$L_=0,$LA=$Lt.length;$L_<$LA;$Lt.length<$LA?$LA--:$L_++)this._removeComponent($Li,$L_)},$Lt.removeAllComponent=function(){for(var $Lr=0,$Li=this._componentsMap.length;$Lr<$Li;this._componentsMap.length<$Li?$Li--:$Lr++)this.removeComponentsByType(this._componentsMap[$Lr])},$Lt._updateComponents=function($Lr){for(var $Li=0,$Lt=this._components.length;$Li<$Lt;$Li++){var $L_=this._components[$Li];!$L_.started&&($L_._start($Lr),$L_.started=!0),$L_.enable&&$L_._update($Lr)}},$Lt._lateUpdateComponents=function($Lr){for(var $Li=0;$Li<this._components.length;$Li++){var $Lt=this._components[$Li];!$Lt.started&&($Lt._start($Lr),$Lt.started=!0),$Lt.enable&&$Lt._lateUpdate($Lr)}},$Lt._preRenderUpdateComponents=function($Lr){for(var $Li=0;$Li<this._components.length;$Li++){var $Lt=this._components[$Li];!$Lt.started&&($Lt._start($Lr),$Lt.started=!0),$Lt.enable&&$Lt._preRenderUpdate($Lr)}},$Lt._postRenderUpdateComponents=function($Lr){for(var $Li=0;$Li<this._components.length;$Li++){var $Lt=this._components[$Li];!$Lt.started&&($Lt._start($Lr),$Lt.started=!0),$Lt.enable&&$Lt._postRenderUpdate($Lr)}},$Li}(),$LUi=function($L_){function $Lr(){$Lr.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new $LXi,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new $LGi(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}$Lv($Lr,"laya.d3.core.material.BaseMaterial",$L_);var $Li=$Lr.prototype;return $LD.imps($Li,{"laya.d3.core.IClone":!0}),$Li._addShaderDefine=function($Lr){this._shaderDefineValue|=$Lr},$Li._removeShaderDefine=function($Lr){this._shaderDefineValue&=~$Lr},$Li._addDisablePublicShaderDefine=function($Lr){this._disablePublicShaderDefine|=$Lr},$Li._removeDisablePublicShaderDefine=function($Lr){this._disablePublicShaderDefine&=~$Lr},$Li._setBuffer=function($Lr,$Li){this._shaderValues.setValue($Lr,$Li),this._values[$Lr]=$Li},$Li._getBuffer=function($Lr){return this._values[$Lr]},$Li._setMatrix4x4=function($Lr,$Li){this._shaderValues.setValue($Lr,$Li?$Li.elements:null),this._values[$Lr]=$Li},$Li._getMatrix4x4=function($Lr){return this._values[$Lr]},$Li._setInt=function($Lr,$Li){this._shaderValues.setValue($Lr,$Li),this._values[$Lr]=$Li},$Li._getInt=function($Lr){return this._values[$Lr]},$Li._setNumber=function($Lr,$Li){this._shaderValues.setValue($Lr,$Li),this._values[$Lr]=$Li},$Li._getNumber=function($Lr){return this._values[$Lr]},$Li._setBool=function($Lr,$Li){this._shaderValues.setValue($Lr,$Li),this._values[$Lr]=$Li},$Li._getBool=function($Lr){return this._values[$Lr]},$Li._setVector2=function($Lr,$Li){this._shaderValues.setValue($Lr,$Li?$Li.elements:null),this._values[$Lr]=$Li},$Li._getVector2=function($Lr){return this._values[$Lr]},$Li._setColor=function($Lr,$Li){this._shaderValues.setValue($Lr,$Li?$Li.elements:null),this._values[$Lr]=$Li},$Li._getColor=function($Lr){return this._values[$Lr]},$Li._setTexture=function($Lr,$Li){var $Lt=this._values[$Lr];this._values[$Lr]=$Li,this._shaderValues.setValue($Lr,$Li),0<this.referenceCount&&($Lt&&$Lt._removeReference(),$Li&&$Li._addReference())},$Li._getTexture=function($Lr){return this._values[$Lr]},$Li._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},$Li._getShader=function($Lr,$Li,$Lt){var $L_=($Lr|$Li)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile($L_,$Lt,this._shaderDefineValue),this._shader},$Li._setRenderStateBlendDepth=function(){var $Lr=$Lk.mainContext;switch($Le.setDepthMask($Lr,this.depthWrite),0===this.depthTest?$Le.setDepthTest($Lr,!1):($Le.setDepthTest($Lr,!0),$Le.setDepthFunc($Lr,this.depthTest)),this.blend){case 0:$Le.setBlend($Lr,!1);break;case 1:$Le.setBlend($Lr,!0),$Le.setBlendFunc($Lr,this.srcBlend,this.dstBlend);break;case 2:$Le.setBlend($Lr,!0)}},$Li._setRenderStateFrontFace=function($Lr,$Li){var $Lt=$Lk.mainContext,$L_=0;switch(this.cull){case 0:$Le.setCullFace($Lt,!1);break;case 1:$Le.setCullFace($Lt,!0),$L_=$Lr?$Li&&$Li._isFrontFaceInvert?2305:2304:$Li&&$Li._isFrontFaceInvert?2304:2305,$Le.setFrontFace($Lt,$L_);break;case 2:$Le.setCullFace($Lt,!0),$L_=$Lr?$Li&&$Li._isFrontFaceInvert?2304:2305:$Li&&$Li._isFrontFaceInvert?2305:2304,$Le.setFrontFace($Lt,$L_)}},$Li.onAsynLoaded=function($Lr,$Li,$Lt){var $L_=$Li[0],$LA=$Li[1];switch($L_.version){case"LAYAMATERIAL:01":var $Lf=0,$LE=0,$LG=$L_.props;for(var $LN in $LG)switch($LN){case"vectors":var $Lp=$LG[$LN];for($Lf=0,$LE=$Lp.length;$Lf<$LE;$Lf++){var $Lg=$Lp[$Lf],$LR=$Lg.value;switch($LR.length){case 2:this[$Lg.name]=new $Lfi($LR[0],$LR[1]);break;case 3:this[$Lg.name]=new $LEi($LR[0],$LR[1],$LR[2]);break;case 4:this[$Lg.name]=new $LGi($LR[0],$LR[1],$LR[2],$LR[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var $LX=$LG[$LN];for($Lf=0,$LE=$LX.length;$Lf<$LE;$Lf++){var $Lv=$LX[$Lf],$LO=$Lv.path;$LO&&(this[$Lv.name]=$Ly.getRes($LA[$LO]))}break;case"defines":var $Lc=$LG[$LN];for($Lf=0,$LE=$Lc.length;$Lf<$LE;$Lf++){var $LB=this._shaderCompile.getMaterialDefineByName($Lc[$Lf]);this._addShaderDefine($LB)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[$LN]=$LG[$LN];break;case"renderQueue":switch($LG[$LN]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[$LN]=$LG[$LN]}break;case"LAYAMATERIAL:02":for($LN in $LG=$L_.props)switch($LN){case"vectors":for($Lf=0,$LE=($Lp=$LG[$LN]).length;$Lf<$LE;$Lf++)switch(($LR=($Lg=$Lp[$Lf]).value).length){case 2:this[$Lg.name]=new $Lfi($LR[0],$LR[1]);break;case 3:this[$Lg.name]=new $LEi($LR[0],$LR[1],$LR[2]);break;case 4:this[$Lg.name]=new $LGi($LR[0],$LR[1],$LR[2],$LR[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for($Lf=0,$LE=($LX=$LG[$LN]).length;$Lf<$LE;$Lf++)($LO=($Lv=$LX[$Lf]).path)&&(this[$Lv.name]=$Ly.getRes($LA[$LO]));break;case"defines":for($Lf=0,$LE=($Lc=$LG[$LN]).length;$Lf<$LE;$Lf++)$LB=this._shaderCompile.getMaterialDefineByName($Lc[$Lf]),this._addShaderDefine($LB);break;default:this[$LN]=$LG[$LN]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},$Li._addReference=function(){$L_.prototype._addReference.call(this);for(var $Lr=0,$Li=this._values.length;$Lr<$Li;$Lr++){var $Lt=this._values[$Lr];$Lt&&$Lt instanceof laya.d3.resource.BaseTexture&&$Lt._addReference()}},$Li._removeReference=function(){$L_.prototype._removeReference.call(this);for(var $Lr=0,$Li=this._values.length;$Lr<$Li;$Lr++){var $Lt=this._values[$Lr];$Lt&&$Lt instanceof laya.d3.resource.BaseTexture&&$Lt._removeReference()}},$Li.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},$Li.setShaderName=function($Lr){var $Li=$LVi.nameKey.getID($Lr);if(-1===$Li)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=$LHi._preCompileShader[$Li]},$Li.cloneTo=function($Lr){var $Li=$Lr;$Li.name=this.name,$Li.cull=this.cull,$Li.blend=this.blend,$Li.srcBlend=this.srcBlend,$Li.dstBlend=this.dstBlend,$Li.srcBlendRGB=this.srcBlendRGB,$Li.dstBlendRGB=this.dstBlendRGB,$Li.srcBlendAlpha=this.srcBlendAlpha,$Li.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo($Li.blendConstColor),$Li.blendEquation=this.blendEquation,$Li.blendEquationRGB=this.blendEquationRGB,$Li.blendEquationAlpha=this.blendEquationAlpha,$Li.depthTest=this.depthTest,$Li.depthWrite=this.depthWrite,$Li.renderQueue=this.renderQueue,$Li._shader=this._shader,$Li._disablePublicShaderDefine=this._disablePublicShaderDefine,$Li._shaderDefineValue=this._shaderDefineValue;var $Lt,$L_=0,$LA=$Li._shaderValues;$Li._shaderValues.data.length=this._shaderValues.data.length;var $Lf=this._values.length,$LE=$Li._values;for($L_=0,$Lt=$LE.length=$Lf;$L_<$Lt;$L_++){var $LG=this._values[$L_];if($LG)if("number"==typeof $LG)$LE[$L_]=$LG,$LA.data[$L_]=$LG;else if("number"==typeof $LG&&Math.floor($LG)==$LG)$LE[$L_]=$LG,$LA.data[$L_]=$LG;else if("boolean"==typeof $LG)$LE[$L_]=$LG,$LA.data[$L_]=$LG;else if($LG instanceof laya.d3.math.Vector2){var $LN=$LE[$L_]||($LE[$L_]=new $Lfi);$LG.cloneTo($LN),$LA.data[$L_]=$LN.elements}else if($LG instanceof laya.d3.math.Vector3){var $Lp=$LE[$L_]||($LE[$L_]=new $LEi);$LG.cloneTo($Lp),$LA.data[$L_]=$Lp.elements}else if($LG instanceof laya.d3.math.Vector4){var $Lg=$LE[$L_]||($LE[$L_]=new $LGi);$LG.cloneTo($Lg),$LA.data[$L_]=$Lg.elements}else if($LG instanceof laya.d3.math.Matrix4x4){var $LR=$LE[$L_]||($LE[$L_]=new $Lri);$LG.cloneTo($LR),$LA.data[$L_]=$LR.elements}else $LG instanceof laya.d3.resource.BaseTexture&&($LE[$L_]=$LG,$LA.data[$L_]=$LG)}},$Li.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$LO(0,$Li,"alphaTestValue",function(){return this._getNumber(0)},function($Lr){this._setNumber(0,$Lr)}),$LO(0,$Li,"alphaTest",function(){return this._alphaTest},function($Lr){(this._alphaTest=$Lr)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),$Lr.__init__=function(){$Lr.SHADERDEFINE_ALPHATEST=$Lr.shaderDefines.registerDefine("ALPHATEST")},$Lr.RENDERQUEUE_OPAQUE=2e3,$Lr.RENDERQUEUE_ALPHATEST=2450,$Lr.RENDERQUEUE_TRANSPARENT=3e3,$Lr.CULL_NONE=0,$Lr.CULL_FRONT=1,$Lr.CULL_BACK=2,$Lr.BLEND_DISABLE=0,$Lr.BLEND_ENABLE_ALL=1,$Lr.BLEND_ENABLE_SEPERATE=2,$Lr.BLENDPARAM_ZERO=0,$Lr.BLENDPARAM_ONE=1,$Lr.BLENDPARAM_SRC_COLOR=768,$Lr.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,$Lr.BLENDPARAM_DST_COLOR=774,$Lr.BLENDPARAM_ONE_MINUS_DST_COLOR=775,$Lr.BLENDPARAM_SRC_ALPHA=770,$Lr.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,$Lr.BLENDPARAM_DST_ALPHA=772,$Lr.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,$Lr.BLENDPARAM_SRC_ALPHA_SATURATE=776,$Lr.BLENDEQUATION_ADD=0,$Lr.BLENDEQUATION_SUBTRACT=1,$Lr.BLENDEQUATION_REVERSE_SUBTRACT=2,$Lr.DEPTHTEST_OFF=0,$Lr.DEPTHTEST_NEVER=512,$Lr.DEPTHTEST_LESS=513,$Lr.DEPTHTEST_EQUAL=514,$Lr.DEPTHTEST_LEQUAL=515,$Lr.DEPTHTEST_GREATER=516,$Lr.DEPTHTEST_NOTEQUAL=517,$Lr.DEPTHTEST_GEQUAL=518,$Lr.DEPTHTEST_ALWAYS=519,$Lr.SHADERDEFINE_ALPHATEST=1,$Lr.ALPHATESTVALUE=0,$LR($Lr,["shaderDefines",function(){return this.shaderDefines=new $Lgi}]),$Lr}($LB),$Lki=function($Lr){function $Li(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,$Li.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}$Lv($Li,"laya.d3.resource.BaseTexture",$LB);var $Lt=$Li.prototype;return $LO(0,$Lt,"width",function(){return this._width}),$LO(0,$Lt,"repeat",function(){return this._repeat},function($Lr){if(this._repeat!==$Lr&&(this._repeat=$Lr,this._source)){var $Li=$Lk.mainContext;$Le.bindTexture($Li,this._type,this._source),$La.isPOT(this._width,this._height)&&this._repeat?($Li.texParameteri(this._type,10242,10497),$Li.texParameteri(this._type,10243,10497)):($Li.texParameteri(this._type,10242,33071),$Li.texParameteri(this._type,10243,33071))}}),$LO(0,$Lt,"height",function(){return this._height}),$LO(0,$Lt,"magFifter",function(){return this._magFifter},function($Lr){(this._magFifter=$Lr)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter($Lr)}),$LO(0,$Lt,"wrapModeV",function(){return this._wrapModeV}),$LO(0,$Lt,"size",function(){return this._size}),$LO(0,$Lt,"wrapModeU",function(){return this._wrapModeU}),$LO(0,$Lt,"mipmap",function(){return this._mipmap},function($Lr){this._mipmap=$Lr,this._mipmap!=$Lr&&this._conchTexture&&this._conchTexture.setMipMap($Lr)}),$LO(0,$Lt,"minFifter",function(){return this._minFifter},function($Lr){this._minFifter=$Lr,this._minFifter!=$Lr&&this._conchTexture&&this._conchTexture.setMinFifter($Lr)}),$LO(0,$Lt,"format",function(){return this._format}),$LO(0,$Lt,"source",function(){return this.activeResource(),this._source}),$LO(0,$Lt,"defaulteTexture",function(){return $L$i.grayTexture}),$Li.WARPMODE_REPEAT=0,$Li.WARPMODE_CLAMP=1,$Li}(),$Lei=function($Lr){function $Li(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,$Li.__super.call(this),this._boundingBoxCorners=$L_(8,null)}$Lv($Li,"laya.d3.resource.models.BaseMesh",$LB);var $Lt=$Li.prototype;return $Lt._getPositions=function(){throw new Error("未Override,请重载该属性！")},$Lt._generateBoundingObject=function(){this._boundingSphere=new $LSr(new $LEi,0),$LSr.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new $LMr(new $LEi,new $LEi),$LMr.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},$Lt.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},$Lt.getRenderElement=function($Lr){throw new Error("未Override,请重载该属性！")},$LO(0,$Lt,"subMeshCount",function(){return this._subMeshCount}),$LO(0,$Lt,"boundingBox",function(){return this._boundingBox}),$LO(0,$Lt,"boundingBoxCorners",function(){return this._boundingBoxCorners}),$LO(0,$Lt,"boundingSphere",function(){return this._boundingSphere}),$Li}(),$LLi=(function($Lr){function $Li(){$Li.__super.call(this)}$Lv($Li,"laya.d3.component.Script",$Lni);var $Lt=$Li.prototype;$Lt.onTriggerEnter=function($Lr){},$Lt.onTriggerExit=function($Lr){},$Lt.onTriggerStay=function($Lr){},$LO(0,$Lt,"isSingleton",function(){return $Li._isSingleton}),$Li._isSingleton=!1}(),function($Lr){function $Li($Lr){this._owner=null,this._sharedMesh=null,$Li.__super.call(this),this._owner=$Lr}$Lv($Li,"laya.d3.core.MeshFilter",$Lr);var $Lt=$Li.prototype;return $Lt._sharedMeshLoaded=function(){this.event("loaded")},$Lt._destroy=function(){$Lr.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},$LO(0,$Lt,"sharedMesh",function(){return this._sharedMesh},function($Lr){var $Li=this._sharedMesh;$Li&&$Li._removeReference(),(this._sharedMesh=$Lr)._addReference(),this.event("meshchanged",[this,$Li,$Lr]),$Lr.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),$LO(0,$Lt,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),$LO(0,$Lt,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),$LO(0,$Lt,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),$LO(0,$Lt,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),$Li}($Lai)),$LQi=function($Lr){function $Li($Lr){$Li.__super.call(this,$Lr),$Lr.meshFilter.on("meshchanged",this,this._onMeshChanged)}$Lv($Li,"laya.d3.core.MeshRender",$LDi);var $Lt=$Li.prototype;return $Lt._onMeshChanged=function($Lr,$Li,$Lt){$Lt.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:$Lt.once("loaded",this,this._onMeshLoaed)},$Lt._onMeshLoaed=function($Lr,$Li){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},$Lt._calculateBoundingSphereByInitSphere=function($Lr){var $Li=NaN,$Lt=this._owner.transform,$L_=$Lt.scale.elements,$LA=Math.abs($L_[0]),$Lf=Math.abs($L_[1]),$LE=Math.abs($L_[2]);$Li=$Lf<=$LA&&$LE<=$LA?$LA:$LE<=$Lf?$Lf:$LE,$LEi.transformCoordinate($Lr.center,$Lt.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=$Lr.radius*$Li},$Lt._calculateBoundBoxByInitCorners=function($Lr){for(var $Li=this._owner.transform.worldMatrix,$Lt=0;$Lt<8;$Lt++)$LEi.transformCoordinate($Lr[$Lt],$Li,$LDi._tempBoundBoxCorners[$Lt]);$LMr.createfromPoints($LDi._tempBoundBoxCorners,this._boundingBox)},$Lt._calculateBoundingSphere=function(){var $Lr=this._owner.meshFilter.sharedMesh;null==$Lr||null==$Lr.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere($Lr.boundingSphere)},$Lt._calculateBoundingBox=function(){var $Lr=this._owner.meshFilter.sharedMesh;null==$Lr||null==$Lr.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners($Lr.boundingBoxCorners)},$Lt._renderUpdate=function($Lr){var $Li=this._owner.transform;if($Li){this._setShaderValueMatrix4x4(0,$Li.worldMatrix);var $Lt=this._owner.getProjectionViewWorldMatrix($Lr);this._setShaderValueMatrix4x4(1,$Lt)}else this._setShaderValueMatrix4x4(0,$Lri.DEFAULT),this._setShaderValueMatrix4x4(1,$Lr);return $Lyi.debugMode&&this._renderRenderableBoundBox(),!0},$Li}(),$LFi=function($Li){function $L_(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,$L_.__super.call(this),this._renderState=new $LW,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new $LXi,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new $Lir,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new $LEi(.7,.7,.7),this.ambientColor=new $LEi(.212,.227,.259),$Lk.shaderHighPrecision&&this.addShaderDefine($LHi.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}$Lv($L_,"laya.d3.core.scene.Scene",$Li);var $Lr=$L_.prototype;return $LD.imps($Lr,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),$Lr._setUrl=function($Lr){this._url=$Lr},$Lr._getGroup=function(){return this._group},$Lr._setGroup=function($Lr){this._group=$Lr},$Lr._display=function(){$LD.stage._scenes.push(this),$LD.stage._scenes.sort($L_._sortScenes);for(var $Lr=0,$Li=this._childs.length;$Lr<$Li;$Lr++){var $Lt=this._childs[$Lr];$Lt.active&&$Lt._activeHierarchy()}},$Lr._unDisplay=function(){var $Lr=$LD.stage._scenes;$Lr.splice($Lr.indexOf(this),1);for(var $Li=0,$Lt=this._childs.length;$Li<$Lt;$Li++){var $L_=this._childs[$Li];$L_.active&&$L_._inActiveHierarchy()}},$Lr._addChild3D=function($Lr){$Lr.transform._onWorldTransform(),$Lr._setBelongScene(this),this.displayedInStage&&$Lr.active&&$Lr._activeHierarchy()},$Lr._removeChild3D=function($Lr){$Lr.transform.parent=null,this.displayedInStage&&$Lr.active&&$Lr._inActiveHierarchy(),$Lr._setUnBelongScene()},$Lr.initOctree=function($Lr,$Li,$Lt,$L_,$LA){void 0===$LA&&($LA=6),this.treeSize=new $LEi($Lr,$Li,$Lt),this.treeLevel=$LA,this.treeRoot=new $LM(this,0),this.treeRoot.init($L_,this.treeSize)},$Lr._prepareUpdateToRenderState=function($Lr,$Li){$Li.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,$Li.scene=this},$Lr._prepareSceneToRender=function($Lr){var $Li=this._lights.length;if(0<$Li)for(var $Lt=0,$L_=0;$L_<$Li&&!(this._lights[$L_]._prepareToScene($Lr)&&++$Lt>=this._enableLightCount);$L_++);},$Lr._updateChilds=function($Lr){for(var $Li=0,$Lt=this._childs.length;$Li<$Lt;++$Li)this._childs[$Li]._update($Lr)},$Lr._preRenderScene=function($Lr,$Li,$Lt){var $L_,$LA=$Li._viewMatrix,$Lf=$Li._projectionMatrix,$LE=$Li._projectionViewMatrix,$LG=0,$LN=$Li.camera;for($LN.useOcclusionCulling?this.treeRoot?$Ltr.renderObjectCullingOctree($Lt,this,$LN,$LA,$Lf,$LE):$Ltr.renderObjectCulling($Lt,this,$LN,$LA,$Lf,$LE):$Ltr.renderObjectCullingNoBoundFrustum(this,$LN,$LA,$Lf,$LE),$LG=0,$L_=this._quenes.length;$LG<$L_;$LG++)this._quenes[$LG]&&this._quenes[$LG]._preRender($Li)},$Lr._clear=function($Lr,$Li){var $Lt=$Li._viewport,$L_=$Li.camera,$LA=$Lt.x,$Lf=$L_.renderTargetSize.height-$Lt.y-$Lt.height,$LE=$Lt.width,$LG=$Lt.height;$Lr.viewport($LA,$Lf,$LE,$LG);var $LN=256,$Lp=$L_.renderTarget;switch($L_.clearFlag){case 0:var $Lg=$L_.clearColor;if($Lg){$Lr.enable(3089),$Lr.scissor($LA,$Lf,$LE,$LG);var $LR=$Lg.elements;$Lr.clearColor($LR[0],$LR[1],$LR[2],$LR[3]),$LN|=16384}if($Lp)switch($Lg||($LN=16384),$Lp.depthStencilFormat){case 33189:$LN|=256;break;case 36168:$LN|=1024;break;case 34041:$LN|=256,$LN|=1024}$Lr.clear($LN),$Lg&&$Lr.disable(3089);break;case 1:case 2:if($Lp)switch($LN=16384,$Lp.depthStencilFormat){case 33189:$LN|=256;break;case 36168:$LN|=1024;break;case 34041:$LN|=256,$LN|=1024}$Lr.clear($LN);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},$Lr._renderScene=function($Lr,$Li){var $Lt,$L_,$LA=$Li.camera,$Lf=0;for($Lf=0;$Lf<2;$Lf++)($L_=this._quenes[$Lf])&&($LA.renderTarget?$L_._render($Li,!0):$L_._render($Li,!1));if(1===$LA.clearFlag){var $LE=$LA.sky;$LE&&($Le.setCullFace($Lr,!1),$Le.setDepthFunc($Lr,515),$Le.setDepthMask($Lr,!1),$LE._render($Li),$Le.setDepthFunc($Lr,513),$Le.setDepthMask($Lr,!0))}for($Lf=2,$Lt=this._quenes.length;$Lf<$Lt;$Lf++)($L_=this._quenes[$Lf])&&($L_._sortAlpha($Li.camera.transform.position),$LA.renderTarget?$L_._render($Li,!0):$L_._render($Li,!1))},$Lr._set3DRenderConfig=function($Lr){$Lr.disable(3042),$Le._blend=!1,$Lr.blendFunc(770,771),$Le._sFactor=770,$Le._dFactor=771,$Lr.disable(2929),$Le._depthTest=!1,$Lr.enable(2884),$Le._cullFace=!0,$Lr.depthMask(1),$Le._depthMask=!0,$Lr.frontFace(2304),$Le._frontFace=2304},$Lr._set2DRenderConfig=function($Lr){$Le.setBlend($Lr,!0),$Le.setBlendFunc($Lr,1,771),$Le.setDepthTest($Lr,!1),$Le.setCullFace($Lr,!1),$Le.setDepthMask($Lr,!0),$Le.setFrontFace($Lr,2305),$Lr.viewport(0,0,$Lg.width,$Lg.height)},$Lr._parseCustomProps=function($Lr,$Li,$Lt,$L_){var $LA=$L_.customProps.lightmaps,$Lf=$LA.length,$LE=this._lightmaps;$LE.length=$Lf;for(var $LG=0;$LG<$Lf;$LG++)$LE[$LG]=$Ly.getRes($Li[$LA[$LG].replace(".exr",".png")]);this.setlightmaps($LE);var $LN=$L_.customProps.ambientColor;$LN&&(this.ambientColor=new $LEi($LN[0],$LN[1],$LN[2]));var $Lp=$L_.customProps.fogColor;$Lp&&(this.fogColor=new $LEi($Lp[0],$Lp[1],$Lp[2]))},$Lr._addLight=function($Lr){this._lights.indexOf($Lr)<0&&this._lights.push($Lr)},$Lr._removeLight=function($Lr){var $Li=this._lights.indexOf($Lr);0<=$Li&&this._lights.splice($Li,1)},$Lr._updateScene=function(){var $Lr=this._renderState;this._prepareUpdateToRenderState($Lk.mainContext,$Lr),this._updateComponents($Lr),this._updateChilds($Lr),this._lateUpdateComponents($Lr),this._time+=$Lr.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},$Lr._updateSceneConch=function(){var $Lr=this._renderState;this._prepareUpdateToRenderState($Lk.mainContext,$Lr),this._updateComponents($Lr),this._lateUpdateComponents($Lr),this._prepareSceneToRender($Lr);for(var $Li=0,$Lt=this._cameraPool.length;$Li<$Lt;$Li++){var $L_=this._cameraPool[$Li];($Lr.camera=$L_)._prepareCameraToRender()}},$Lr._preRenderShadow=function($Lr,$Li,$Lt,$L_,$LA){this.treeRoot?$Ltr.renderShadowObjectCullingOctree(this,$Li,$Lt,$L_,$LA):$Ltr.renderShadowObjectCulling(this,$Li,$Lt,$L_,$LA);for(var $Lf=0,$LE=$Lt.length;$Lf<$LE;$Lf++)$Lt[$Lf]&&$Lt[$Lf]._preRender($Lr)},$Lr._renderShadowMap=function($Lr,$Li,$Lt){var $L_=this.parallelSplitShadowMaps[0];$L_._calcAllLightCameraInfo($Lt);var $LA,$Lf,$LE,$LG=$L_.PSSMNum;if(this._preRenderShadow($Li,$L_._lightCulling,$L_._shadowQuenes,$L_._lightVPMatrix[0],$LG),this.addShaderDefine($Lvi.SHADERDEFINE_CAST_SHADOW),1<$LG)for(var $LN=0;$LN<$LG;$LN++)$LA=$L_.getRenderTarget($LN+1),$L_.beginRenderTarget($LN+1),$Lr.clearColor(1,1,1,1),$Lr.clear(16640),$Lr.viewport(0,0,$LA.width,$LA.height),$Li.camera=$LE=$L_.getLightCamera($LN),$LE._prepareCameraToRender(),$LE._prepareCameraViewProject($LE.viewMatrix,$LE.projectionMatrix),$Li._projectionViewMatrix=$L_._lightVPMatrix[$LN+1],($Lf=$L_._shadowQuenes[$LN])._preRender($Li),$Lf._renderShadow($Li,!1),$L_.endRenderTarget($LN+1);else $LA=$L_.getRenderTarget(1),$L_.beginRenderTarget(1),$Lr.clearColor(1,1,1,1),$Lr.clear(16640),$Lr.viewport(0,0,$LA.width,$LA.height),$Li.camera=$LE=$L_.getLightCamera(0),$LE._prepareCameraToRender(),$LE._prepareCameraViewProject($LE.viewMatrix,$LE.projectionMatrix),$Li._projectionViewMatrix=$L_._lightVPMatrix[0],($Lf=$L_._shadowQuenes[0])._preRender($Li),$Lf._renderShadow($Li,!0),$L_.endRenderTarget(1);this.removeShaderDefine($Lvi.SHADERDEFINE_CAST_SHADOW)},$Lr.addTreeNode=function($Lr){this.treeRoot.addTreeNode($Lr)},$Lr.removeTreeNode=function($Lr){this.treeSize&&$Lr._treeNode&&$Lr._treeNode.removeObject($Lr)},$Lr.setlightmaps=function($Lr){this._lightmaps=$Lr;for(var $Li=0,$Lt=this._renderableSprite3Ds.length;$Li<$Lt;$Li++)this._renderableSprite3Ds[$Li]._render._applyLightMapParams()},$Lr.getlightmaps=function(){return this._lightmaps},$Lr.addChildAt=function($Lr,$Li){if(!($Lr instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+($Lr&&$Lr.__className));if(!$Lr||this.destroyed||$Lr===this)return $Lr;if($Lr.zOrder&&this._set$P("hasZorder",!0),0<=$Li&&$Li<=this._childs.length){if($Lr._parent===this){var $Lt=this.getChildIndex($Lr);this._childs.splice($Lt,1),this._childs.splice($Li,0,$Lr),this.conchModel&&(this.conchModel.removeChild($Lr.conchModel),this.conchModel.addChildAt($Lr.conchModel,$Li)),this._childChanged()}else $Lr.parent&&$Lr.parent.removeChild($Lr),this._childs===$Lp.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($Li,0,$Lr),this.conchModel&&this.conchModel.addChildAt($Lr.conchModel,$Li),($Lr.parent=this)._addChild3D($Lr);return $Lr}throw new Error("appendChildAt:The index is out of bounds")},$Lr.addChild=function($Lr){if(!($Lr instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$Lr||this.destroyed||$Lr===this)return $Lr;if($Lr.zOrder&&this._set$P("hasZorder",!0),$Lr._parent===this){var $Li=this.getChildIndex($Lr);$Li!==this._childs.length-1&&(this._childs.splice($Li,1),this._childs.push($Lr),this.conchModel&&(this.conchModel.removeChild($Lr.conchModel),this.conchModel.addChildAt($Lr.conchModel,this._childs.length-1)),this._childChanged())}else $Lr.parent&&$Lr.parent.removeChild($Lr),this._childs===$Lp.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($Lr),this.conchModel&&this.conchModel.addChildAt($Lr.conchModel,this._childs.length-1),($Lr.parent=this)._childChanged(),this._addChild3D($Lr);return $Lr},$Lr.removeChildAt=function($Lr){var $Li=this.getChildAt($Lr);return $Li&&(this._removeChild3D($Li),this._childs.splice($Lr,1),this.conchModel&&this.conchModel.removeChild($Li.conchModel),$Li.parent=null),$Li},$Lr.removeChildren=function($Lr,$Li){if(void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=2147483647),this._childs&&0<this._childs.length){var $Lt=this._childs;if(0===$Lr&&$Lf<=$Li){var $L_=$Lt;this._childs=$Lp.ARRAY_EMPTY}else $L_=$Lt.splice($Lr,$Li-$Lr);for(var $LA=0,$Lf=$L_.length;$LA<$Lf;$LA++)this._removeChild3D($L_[$LA]),$L_[$LA].parent=null,this.conchModel&&this.conchModel.removeChild($L_[$LA].conchModel)}return this},$Lr.addFrustumCullingObject=function($Lr){this.treeRoot?this.addTreeNode($Lr):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push($Lr):this._cullingRenders[this._cullingRendersLength]=$Lr,$Lr._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},$Lr.removeFrustumCullingObject=function($Lr){if(this.treeRoot)this.removeTreeNode($Lr);else{this._cullingRendersLength--;var $Li=$Lr._indexInSceneFrustumCullingObjects;if($Li!==this._cullingRendersLength){var $Lt=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[$Li]=$Lt)._indexInSceneFrustumCullingObjects=$Li,$Lr._indexInSceneFrustumCullingObjects=-1}}},$Lr.getRenderQueue=function($Lr){return $Lr<3e3?this._quenes[1]||(this._quenes[1]=new $LZ(this)):this._quenes[2]||(this._quenes[2]=new $LZ(this))},$Lr.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new $LZ(this)},$Lr.addShaderDefine=function($Lr){this._shaderDefineValue|=$Lr},$Lr.removeShaderDefine=function($Lr){this._shaderDefineValue&=~$Lr},$Lr.addScript=function($Lr){return this._addComponent($Lr)},$Lr.getScriptByType=function($Lr,$Li){return void 0===$Li&&($Li=0),this._getComponentByType($Lr,$Li)},$Lr.getScriptsByType=function($Lr,$Li){this._getComponentsByType($Lr,$Li)},$Lr.getScriptByIndex=function($Lr){return this._getComponentByIndex($Lr)},$Lr.removeScriptByType=function($Lr,$Li){void 0===$Li&&($Li=0),this._removeComponentByType($Lr,$Li)},$Lr.removeScriptsByType=function($Lr){this._removeComponentByType($Lr)},$Lr.removeAllScript=function(){this._removeAllComponent()},$Lr.render=function($Lr,$Li,$Lt){($Lc._context.ctx._renderKey=0)<this._childs.length&&$Lr.addRenderObject(this)},$Lr.renderSubmit=function(){var $Lr=$Lk.mainContext,$Li=this._renderState;this._set3DRenderConfig($Lr),this._prepareSceneToRender(this._renderState);var $Lt,$L_=0,$LA=0;if($Lyi.debugMode||$LM.debugMode)for($L_=0,$LA=this._cameraPool.length;$L_<$LA;$L_++)$Lt=this._cameraPool[$L_],$Lyi._debugPhasorSprite.begin(1,$Lt),$Lt.activeInHierarchy&&$Lt._renderCamera($Lr,$Li,this),$Lyi._debugPhasorSprite.end();else for($L_=0,$LA=this._cameraPool.length;$L_<$LA;$L_++)($Lt=this._cameraPool[$L_]).activeInHierarchy&&$Lt._renderCamera($Lr,$Li,this);return this._set2DRenderConfig($Lr),1},$Lr.onAsynLoaded=function($Lr,$Li,$Lt){var $L_=$Li[0];if("Scene"!==$L_.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var $LA=$Li[1];$LBi._createNodeByJson(this,$L_,this,$LA),this.event("hierarchyloaded",[this]),this.__loaded=!0},$Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),this.destroyed||($Li.prototype.destroy.call(this,$Lr),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,$Ly.clearRes(this.url),this.loaded||$Lyi._cancelLoadByUrl(this.url))},$Lr.getRenderType=function(){return 0},$Lr.releaseRender=function(){},$Lr._addComponent=function($Lr){var $Li,$Lt=this._componentsMap.indexOf($Lr);if(-1===$Lt)$Li=[],this._componentsMap.push($Lr),this._typeComponentsIndices.push($Li);else if($Li=this._typeComponentsIndices[$Lt],this._components[$Li[0]].isSingleton)throw new Error("无法单实例创建"+$Lr+"组件，"+$Lr+"组件已存在！");var $L_=$LA.getInstance($Lr);$Li.push(this._components.length),this._components.push($L_);return $L_._initialize(this),$L_},$Lr._removeComponent=function($Lr,$Li){var $Lt=this._typeComponentsIndices[$Lr],$L_=$Lt[$Li],$LA=this._components[$L_];this._components.splice($L_,1),$Lt.splice($Li,1),0===$Lt.length&&(this._typeComponentsIndices.splice($Lr,1),this._componentsMap.splice($Lr,1));for(var $Lf=0,$LE=this._componentsMap.length;$Lf<$LE;$Lf++)for(var $LG=($Lt=this._typeComponentsIndices[$Lf]).length-1;0<=$LG;$LG--){var $LN=$Lt[$LG];if(!($L_<$LN))break;$Lt[$LG]=--$LN}$LA._destroy()},$Lr._getComponentByType=function($Lr,$Li){void 0===$Li&&($Li=0);var $Lt=this._componentsMap.indexOf($Lr);return-1===$Lt?null:this._components[this._typeComponentsIndices[$Lt][$Li]]},$Lr._getComponentsByType=function($Lr,$Li){var $Lt=this._componentsMap.indexOf($Lr);if(-1!==$Lt){var $L_=this._typeComponentsIndices[$Lt],$LA=$L_.length;$Li.length=$LA;for(var $Lf=0;$Lf<$LA;$Lf++)$Li[$Lf]=this._components[$L_[$Lf]]}else $Li.length=0},$Lr._getComponentByIndex=function($Lr){return this._components[$Lr]},$Lr._removeComponentByType=function($Lr,$Li){void 0===$Li&&($Li=0);var $Lt=this._componentsMap.indexOf($Lr);-1!==$Lt&&this._removeComponent($Lt,$Li)},$Lr._removeComponentsByType=function($Lr){var $Li=this._componentsMap.indexOf($Lr);if(-1!==$Li)for(var $Lt=this._typeComponentsIndices[$Li],$L_=0,$LA=$Lt.length;$L_<$LA;$Lt.length<$LA?$LA--:$L_++)this._removeComponent($Li,$L_)},$Lr._removeAllComponent=function(){for(var $Lr=0,$Li=this._componentsMap.length;$Lr<$Li;this._componentsMap.length<$Li?$Li--:$Lr++)this._removeComponentsByType(this._componentsMap[$Lr])},$Lr._updateComponents=function($Lr){for(var $Li=0,$Lt=this._components.length;$Li<$Lt;$Li++){var $L_=this._components[$Li];!$L_.started&&($L_._start($Lr),$L_.started=!0),$L_.enable&&$L_._update($Lr)}},$Lr._lateUpdateComponents=function($Lr){for(var $Li=0;$Li<this._components.length;$Li++){var $Lt=this._components[$Li];!$Lt.started&&($Lt._start($Lr),$Lt.started=!0),$Lt.enable&&$Lt._lateUpdate($Lr)}},$Lr._preRenderUpdateComponents=function($Lr){for(var $Li=0;$Li<this._components.length;$Li++){var $Lt=this._components[$Li];!$Lt.started&&($Lt._start($Lr),$Lt.started=!0),$Lt.enable&&$Lt._preRenderUpdate($Lr)}},$Lr._postRenderUpdateComponents=function($Lr){for(var $Li=0;$Li<this._components.length;$Li++){var $Lt=this._components[$Li];!$Lt.started&&($Lt._start($Lr),$Lt.started=!0),$Lt.enable&&$Lt._postRenderUpdate($Lr)}},$LO(0,$Lr,"_loaded",null,function($Lr){this.__loaded=$Lr}),$LO(0,$Lr,"fogColor",function(){return this._fogColor},function($Lr){this._fogColor=$Lr,this._shaderValues.setValue(0,$Lr.elements)}),$LO(0,$Lr,"enableFog",function(){return this._enableFog},function($Lr){this._enableFog!==$Lr&&((this._enableFog=$Lr)?(this.addShaderDefine($LHi.SHADERDEFINE_FOG),this.removeShaderDefine($LHi.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine($LHi.SHADERDEFINE_FOG))}),$LO(0,$Lr,"url",function(){return this._url}),$LO(0,$Lr,"loaded",function(){return this.__loaded}),$LO(0,$Lr,"enableDepthFog",function(){return this._enableDepthFog},function($Lr){this._enableDepthFog!=$Lr&&((this._enableDepthFog=$Lr)?(this.addShaderDefine($LHi.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine($LHi.SHADERDEFINE_FOG)):this.removeShaderDefine($LHi.SAHDERDEFINE_DEPTHFOG))}),$LO(0,$Lr,"fogStart",function(){return this._fogStart},function($Lr){this._fogStart=$Lr,this._shaderValues.setValue(1,$Lr)}),$LO(0,$Lr,"fogRange",function(){return this._fogRange},function($Lr){this._fogRange=$Lr,this._shaderValues.setValue(2,$Lr)}),$LO(0,$Lr,"ambientColor",function(){return this._ambientColor},function($Lr){this._ambientColor=$Lr,this._shaderValues.setValue(21,$Lr.elements)}),$LO(0,$Lr,"scene",function(){return this}),$LO(0,$Lr,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),$L_._sortScenes=function($Lr,$Li){if($Lr.parent!==$LD.stage||$Li.parent!==$LD.stage)return $Lr.parent!==$LD.stage&&$Li.parent!==$LD.stage?$L_._sortScenes($Lr.parent,$Li.parent):$Lr.parent===$LD.stage?-1:1;var $Lt=$LD.stage._childs;return $Lt.indexOf($Lr)-$Lt.indexOf($Li)},$L_.load=function($Lr){return $LD.loader.create($Lr,null,null,$L_)},$L_.FOGCOLOR=0,$L_.FOGSTART=1,$L_.FOGRANGE=2,$L_.LIGHTDIRECTION=3,$L_.LIGHTDIRCOLOR=4,$L_.POINTLIGHTPOS=5,$L_.POINTLIGHTRANGE=6,$L_.POINTLIGHTATTENUATION=7,$L_.POINTLIGHTCOLOR=8,$L_.SPOTLIGHTPOS=9,$L_.SPOTLIGHTDIRECTION=10,$L_.SPOTLIGHTSPOT=11,$L_.SPOTLIGHTRANGE=12,$L_.SPOTLIGHTATTENUATION=13,$L_.SPOTLIGHTCOLOR=14,$L_.SHADOWDISTANCE=15,$L_.SHADOWLIGHTVIEWPROJECT=16,$L_.SHADOWMAPPCFOFFSET=17,$L_.SHADOWMAPTEXTURE1=18,$L_.SHADOWMAPTEXTURE2=19,$L_.SHADOWMAPTEXTURE3=20,$L_.AMBIENTCOLOR=21,$L_.TIME=22,$L_}($Lw),$Lbi=function($Lr){function $Li($Lr){$Li.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new $Lri,this._shaderValues=new $LXi,this._colliders=[],this._id=++$Li._uniqueIDCounter,this._transform=new $Lui(this),this.name=$Lr||"Sprite3D-"+$Li._nameNumberCounter++,this.layer=$LQ.currentCreationLayer,this.active=!0}$Lv($Li,"laya.d3.core.Sprite3D",$Lli);var $Lt=$Li.prototype;return $LD.imps($Lt,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),$Lt._setUrl=function($Lr){this._url=$Lr},$Lt._getGroup=function(){return this._group},$Lt._setGroup=function($Lr){this._group=$Lr},$Lt._addChild3D=function($Lr){$Lr.transform.parent=this.transform,this._hierarchyAnimator&&(!$Lr._hierarchyAnimator&&$Lr._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($Lr,!0,[$Lr.name])),this._scene&&($Lr._setBelongScene(this._scene),this._activeInHierarchy&&$Lr._active&&$Lr._activeHierarchy())},$Lt._removeChild3D=function($Lr){$Lr.transform.parent=null,this._scene&&(this._activeInHierarchy&&$Lr._active&&$Lr._inActiveHierarchy(),$Lr._setUnBelongScene()),this._hierarchyAnimator&&($Lr._hierarchyAnimator==this._hierarchyAnimator&&$Lr._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($Lr,!1,[$Lr.name]))},$Lt._parseBaseCustomProps=function($Lr){var $Li=this.transform.localPosition;$Lr.translate?($Li.fromArray($Lr.translate),$Li.x*=100,$Li.y*=100,$Li.z*=100):$Li.elements.fill(0),this.transform.localPosition=$Li;var $Lt=this.transform.localRotation;$Lr.rotation?$Lt.fromArray($Lr.rotation):$Lt.fromArray([0,0,0,-1]),this.transform.localRotation=$Lt;var $L_=this.transform.localScale;$Lr.scale?$L_.fromArray($Lr.scale):$L_.elements.fill(1),this.transform.localScale=$L_;var $LA=$Lr.layer;null!=$LA&&(this.layer=$LQ.getLayerByNumber($LA))},$Lt._parseCustomComponent=function($Lr,$Li,$Lt){for(var $L_ in $Lt){var $LA=$Lt[$L_];switch($L_){case"Animator":var $Lf=this.addComponent(Animator);if($LA.avatarPath)$Lf.avatar=$Ly.getRes($Li[$LA.avatarPath]);else{var $LE=$LA.avatar;if($LE){$Lf.avatar=$Ly.getRes($Li[$LE.path]);var $LG=$LE.linkSprites;$LG&&$Lr.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[$Lf,$LG])}}for(var $LN=$LA.clipPaths,$Lp=$LN.length,$Lg=0;$Lg<$Lp;$Lg++)$Lf.addClip($Ly.getRes($Li[$LN[$Lg]]));$Lf.clip=$Ly.getRes($Li[$LN[0]]);var $LR=$LA.playOnWake;void 0!==$LR&&($Lf.playOnWake=$LR);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var $LX=this.addComponent(SphereCollider);$LX.isTrigger=$LA.isTrigger;var $Lv=$LX.center;$Lv.fromArray($LA.center),$LX.center=$Lv,$LX.radius=$LA.radius;break;case"BoxCollider":var $LO=this.addComponent(BoxCollider);$LO.isTrigger=$LA.isTrigger,$LO.center.fromArray($LA.center);var $Lc=$LO.size;$Lc.fromArray($LA.size),$LO.size=$Lc;break;case"MeshCollider":this.addComponent(MeshCollider)}}},$Lt._onRootNodeHierarchyLoaded=function($Lr,$Li){for(var $Lt in $Li){for(var $L_=this,$LA=$Li[$Lt],$Lf=0,$LE=$LA.length;$Lf<$LE;$Lf++){var $LG=$LA[$Lf];if(""===$LG)break;if(!($L_=$L_.getChildByName($LG)))break}$L_&&$Lr.linkSprite3DToAvatarNode($Lt,$L_)}},$Lt._setHierarchyAnimator=function($Lr,$Li){this._changeHierarchyAnimator($Lr);for(var $Lt=0,$L_=this._childs.length;$Lt<$L_;$Lt++){var $LA=this._childs[$Lt];$LA._hierarchyAnimator==$Li&&$LA._setHierarchyAnimator($Lr,$Li)}},$Lt._clearHierarchyAnimator=function($Lr,$Li){this._changeHierarchyAnimator($Li);for(var $Lt=0,$L_=this._childs.length;$Lt<$L_;$Lt++){var $LA=this._childs[$Lt];$LA._hierarchyAnimator==$Lr&&$LA._clearHierarchyAnimator($Lr,$Li)}},$Lt._getAnimatorToLinkSprite3D=function($Lr,$Li,$Lt){var $L_=this.getComponentByType(Animator);if($L_&&($L_.avatar?$L_.avatar._version||$Lr._setAnimatorToLinkAvatar($L_,$Li):$Lr._setAnimatorToLinkSprite3DNoAvatar($L_,$Li,$Lt)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){$Lt.unshift(this._parent.name);var $LA=this._parent;$LA._hierarchyAnimator&&$LA._getAnimatorToLinkSprite3D($Lr,$Li,$Lt)}},$Lt._setAnimatorToLinkSprite3DNoAvatar=function($Lr,$Li,$Lt){var $L_=0,$LA=0;for($L_=0,$LA=$Lr.getClipCount();$L_<$LA;$L_++)$Lr._handleSpriteOwnersBySprite($L_,$Li,$Lt,this);for($L_=0,$LA=this._childs.length;$L_<$LA;$L_++){var $Lf=this._childs[$L_],$LE=$Lt.length;$Lt.push($Lf.name),$Lf._setAnimatorToLinkSprite3DNoAvatar($Lr,$Li,$Lt),$Lt.splice($LE,1)}},$Lt._changeHierarchyAnimator=function($Lr){this._hierarchyAnimator=$Lr},$Lt._isLinkSpriteToAnimationNode=function($Lr,$Li,$Lt){var $L_=$Lr._avatarNodes.indexOf($Li),$LA=$Lr._cacheSpriteToNodesMap;if($Lt)this._transform.dummy=$Li.transform,$Lr._cacheNodesToSpriteMap[$L_]=$LA.length,$LA.push($L_);else{this._transform.dummy=null;var $Lf=$Lr._cacheNodesToSpriteMap[$L_];$Lr._cacheNodesToSpriteMap[$L_]=null,$LA.splice($Lf,1)}},$Lt._setBelongScene=function($Lr){this._scene=$Lr;for(var $Li=0,$Lt=this._childs.length;$Li<$Lt;$Li++)this._childs[$Li]._setBelongScene($Lr)},$Lt._setUnBelongScene=function(){this._scene=null;for(var $Lr=0,$Li=this._childs.length;$Lr<$Li;$Lr++)this._childs[$Lr]._setUnBelongScene()},$Lt._activeHierarchy=function(){var $Lr=0,$Li=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),$Lr=0,$Li=this._colliders.length;$Lr<$Li;$Lr++)this._layer._addCollider(this._colliders[$Lr]);for(this.event("activeinhierarchychanged",!0),$Lr=0,$Li=this._childs.length;$Lr<$Li;$Lr++){var $Lt=this._childs[$Lr];$Lt._active&&$Lt._activeHierarchy()}},$Lt._inActiveHierarchy=function(){var $Lr=0,$Li=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),$Lr=0,$Li=this._colliders.length;$Lr<$Li;$Lr++){var $Lt=this._colliders[$Lr];$Lt._clearCollsionMap(),this._layer._removeCollider($Lt)}for(this.event("activeinhierarchychanged",!1),$Lr=0,$Li=this._childs.length;$Lr<$Li;$Lr++){var $L_=this._childs[$Lr];$L_._active&&$L_._inActiveHierarchy()}},$Lt.addComponent=function($Lr){var $Li,$Lt=this._componentsMap.indexOf($Lr);if(-1===$Lt)$Li=[],this._componentsMap.push($Lr),this._typeComponentsIndices.push($Li);else if($Li=this._typeComponentsIndices[$Lt],this._components[$Li[0]].isSingleton)throw new Error("无法单实例创建"+$Lr+"组件，"+$Lr+"组件已存在！");var $L_=$LA.getInstance($Lr);return $Li.push(this._components.length),this._components.push($L_),$L_ instanceof laya.d3.component.Script&&this._scripts.push($L_),$L_._initialize(this),$L_},$Lt._removeComponent=function($Lr,$Li){var $Lt,$L_=0,$LA=this._typeComponentsIndices[$Lr],$Lf=$LA[$Li],$LE=this._components[$Lf];for($LE instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($LE),1),$LA.splice($Li,1),0===$LA.length&&(this._typeComponentsIndices.splice($Lr,1),this._componentsMap.splice($Lr,1)),$L_=0,$Lt=this._componentsMap.length;$L_<$Lt;$L_++)for(var $LG=($LA=this._typeComponentsIndices[$L_]).length-1;0<=$LG;$LG--){var $LN=$LA[$LG];if(!($Lf<$LN))break;$LA[$LG]=--$LN}$LE._destroy()},$Lt._clearSelfRenderObjects=function(){},$Lt._addSelfRenderObjects=function(){},$Lt._parseCustomProps=function($Lr,$Li,$Lt,$L_){},$Lt._updateChilds=function($Lr){var $Li=this._childs.length;if(0!==$Li)for(var $Lt=0;$Lt<$Li;++$Lt)this._childs[$Lt]._update($Lr)},$Lt._getSortID=function($Lr,$Li){return 1e3*$Li.id+$Lr._getVertexBuffer().vertexDeclaration.id},$Lt._update=function($Lr){($Lr.owner=this)._activeInHierarchy&&(this._updateComponents($Lr),this._lateUpdateComponents($Lr),$LH.spriteCount++,this._childs.length&&this._updateChilds($Lr))},$Lt.getProjectionViewWorldMatrix=function($Lr){return $Lri.multiply($Lr,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},$Lt.loadHierarchy=function($Lr){this.addChild(laya.d3.core.Sprite3D.load($Lr))},$Lt.addChildAt=function($Lr,$Li){if(!($Lr instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$Lr||this.destroyed||$Lr===this)return $Lr;if($Lr.zOrder&&this._set$P("hasZorder",!0),0<=$Li&&$Li<=this._childs.length){if($Lr._parent===this){var $Lt=this.getChildIndex($Lr);this._childs.splice($Lt,1),this._childs.splice($Li,0,$Lr),this.conchModel&&(this.conchModel.removeChild($Lr.conchModel),this.conchModel.addChildAt($Lr.conchModel,$Li)),this._childChanged()}else $Lr.parent&&$Lr.parent.removeChild($Lr),this._childs===$Lp.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($Li,0,$Lr),this.conchModel&&this.conchModel.addChildAt($Lr.conchModel,$Li),($Lr.parent=this)._addChild3D($Lr);return $Lr}throw new Error("appendChildAt:The index is out of bounds")},$Lt.addChild=function($Lr){if(!($Lr instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$Lr||this.destroyed||$Lr===this)return $Lr;if($Lr.zOrder&&this._set$P("hasZorder",!0),$Lr._parent===this){var $Li=this.getChildIndex($Lr);$Li!==this._childs.length-1&&(this._childs.splice($Li,1),this._childs.push($Lr),this.conchModel&&(this.conchModel.removeChild($Lr.conchModel),this.conchModel.addChildAt($Lr.conchModel,this._childs.length-1)),this._childChanged())}else $Lr.parent&&$Lr.parent.removeChild($Lr),this._childs===$Lp.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($Lr),this.conchModel&&this.conchModel.addChildAt($Lr.conchModel,this._childs.length-1),($Lr.parent=this)._childChanged(),this._addChild3D($Lr);return $Lr},$Lt.removeChildAt=function($Lr){var $Li=this.getChildAt($Lr);return $Li&&(this._removeChild3D($Li),this._childs.splice($Lr,1),this.conchModel&&this.conchModel.removeChild($Li.conchModel),$Li.parent=null),$Li},$Lt.removeChildren=function($Lr,$Li){if(void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=2147483647),this._childs&&0<this._childs.length){var $Lt=this._childs;if(0===$Lr&&$Lf<=$Li){var $L_=$Lt;this._childs=$Lp.ARRAY_EMPTY}else $L_=$Lt.splice($Lr,$Li-$Lr);for(var $LA=0,$Lf=$L_.length;$LA<$Lf;$LA++)this._removeChild3D($L_[$LA]),$L_[$LA].parent=null,this.conchModel&&this.conchModel.removeChild($L_[$LA].conchModel)}return this},$Lt.onAsynLoaded=function($Lr,$Li,$Lt){var $L_=$Li[0];if("Sprite3D"!==$L_.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var $LA=$Li[1];$LBi._createNodeByJson(this,$L_,this,$LA),this.event("hierarchyloaded",[this]),this.__loaded=!0},$Lt.cloneTo=function($Lr){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var $Li=$Lr;$Li.name=this.name,$Li._destroyed=this._destroyed,$Li.timer=this.timer,$Li._$P=this._$P,$Li.active=this._active;var $Lt=$Li.transform.localPosition;this.transform.localPosition.cloneTo($Lt),$Li.transform.localPosition=$Lt;var $L_=$Li.transform.localRotation;this.transform.localRotation.cloneTo($L_),$Li.transform.localRotation=$L_;var $LA=$Li.transform.localScale;this.transform.localScale.cloneTo($LA),$Li.transform.localScale=$LA,$Li.isStatic=this.isStatic;var $Lf=0,$LE=0;for($Lf=0,$LE=this._componentsMap.length;$Lf<$LE;$Lf++){var $LG=$Li.addComponent(this._componentsMap[$Lf]);this._components[$Lf]._cloneTo($LG)}for($Lf=0,$LE=this._childs.length;$Lf<$LE;$Lf++)$Li.addChild(this._childs[$Lf].clone());var $LN=$Li.getComponentByType(Animator);if($LN){var $Lp=$LN._linkSpritesData;if($Lp)for(var $Lg in $Lp){for(var $LR=$Lp[$Lg],$LX=$Li,$Lv=0,$LO=$LR.length;$Lv<$LO&&($LX=$LX.getChildByName($LR[$Lv]));$Lv++);if($LX){var $Lc=$LN._avatarNodeMap[$Lg];$LX._isLinkSpriteToAnimationNode($LN,$Lc,!0)}}}},$Lt.clone=function(){var $Lr=new this.constructor;return this.cloneTo($Lr),$Lr},$Lt.destroy=function($Lr){if(void 0===$Lr&&($Lr=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,$Lr);var $Li,$Lt=0;for($Lt=0,$Li=this._components.length;$Lt<$Li;$Lt++)this._components[$Lt]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,$Ly.clearRes(this.url),this.loaded||$Lyi._cancelLoadByUrl(this.url)}},$Lt._handleSpriteToAvatar=function($Lr,$Li){$Lr._avatarNodes;var $Lt=$Lr._avatarNodeMap[this.name];$Lt&&$Lt.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode($Lr,$Lt,$Li)},$Lt._setAnimatorToLinkAvatar=function($Lr,$Li){this._handleSpriteToAvatar($Lr,$Li);for(var $Lt=0,$L_=this._childs.length;$Lt<$L_;$Lt++){this._childs[$Lt]._setAnimatorToLinkAvatar($Lr,$Li)}},$LO(0,$Lt,"activeInHierarchy",function(){return this._activeInHierarchy}),$LO(0,$Lt,"_loaded",null,function($Lr){this.__loaded=$Lr}),$LO(0,$Lt,"active",function(){return this._active},function($Lr){this._active!==$Lr&&(this._active=$Lr,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&($Lr?this._activeHierarchy():this._inActiveHierarchy()))}),$LO(0,$Lt,"componentsCount",function(){return this._components.length}),$LO(0,$Lt,"loaded",function(){return this.__loaded}),$LO(0,$Lt,"id",function(){return this._id}),$LO(0,$Lt,"url",function(){return this._url}),$LO(0,$Lt,"layer",function(){return this._layer},function($Lr){if(this._layer!==$Lr){if(!$Lr)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var $Li=0,$Lt=this._colliders.length;if(this._layer)for($Li=0;$Li<$Lt;$Li++)this._layer._removeCollider(this._colliders[$Li]);for($Li=0;$Li<$Lt;$Li++)$Lr._addCollider(this._colliders[$Li])}this._layer=$Lr,this.event("layerchanged",$Lr)}}),$LO(0,$Lt,"scene",function(){return this._scene}),$LO(0,$Lt,"transform",function(){return this._transform}),$Li.instantiate=function($Lr,$Li,$Lt,$L_,$LA){void 0===$Lt&&($Lt=!0);var $Lf=$Lr.clone();$Li&&$Li.addChild($Lf);var $LE=$Lf.transform;if($Lt){var $LG=$LE.worldMatrix;$Lr.transform.worldMatrix.cloneTo($LG),$LE.worldMatrix=$LG}else $L_&&($LE.position=$L_),$LA&&($LE.rotation=$LA);return $Lf},$Li.load=function($Lr){return $LD.loader.create($Lr,null,null,$Li)},$Li.WORLDMATRIX=0,$Li.MVPMATRIX=1,$Li._uniqueIDCounter=0,$Li._nameNumberCounter=0,$Li}(),$LVi=function($Lr){function $Lg($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],$Lg.__super.call(this),!$Lr||!$Li)throw"Shader Error";this._id=++$Lg._count,this._vs=$Lr,this._ps=$Li,this._attributeMap=$Lt,this._sceneUniformMap=$L_,this._cameraUniformMap=$LA,this._spriteUniformMap=$Lf,this._materialUniformMap=$LE,this._renderElementUniformMap=$LG,this._precompile=$LN,this._define=$Lp,this._precompile&&$Lg.extCompileObj&&$Lg.extCompileFunc?$Lg.extCompileFunc.call($Lg.extCompileObj,$Lr,$Li,$Lp):this.recreateResource()}$Lv($Lg,"laya.d3.shader.Shader3D",$Lt);var $Li=$Lg.prototype;return $Li.recreateResource=function(){$LL.now();this._compile(),this.completeCreate(),this.memorySize=0},$Li.disposeResource=function(){$Lk.mainContext.deleteShader(this._vshader),$Lk.mainContext.deleteShader(this._pshader),$Lk.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},$Li._compile=function(){if(!$Lk.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var $Lr=[this._vs,this._ps],$Li=$Lk.mainContext;if(this._program=$Li.createProgram(),this._vshader=$Lg._createShader($Li,$Lr[0],35633),this._pshader=$Lg._createShader($Li,$Lr[1],35632),$Li.attachShader(this._program,this._vshader),$Li.attachShader(this._program,this._pshader),$Li.linkProgram(this._program),!$Lc.isConchApp&&$LHi.debugMode&&!$Li.getProgramParameter(this._program,35714))throw $Li.getProgramInfoLog(this._program);var $Lt,$L_=0,$LA=0,$Lf=0;for($Lf=$Lc.isConchApp?$Li.getProgramParameterEx(this._vs,this._ps,"",35721):$Li.getProgramParameter(this._program,35721),$L_=0;$L_<$Lf;$L_++){var $LE=null;$Lt={vartype:"attribute",ivartype:0,attrib:$LE=$Lc.isConchApp?$Li.getActiveAttribEx(this._vs,this._ps,"",$L_):$Li.getActiveAttrib(this._program,$L_),location:$Li.getAttribLocation(this._program,$LE.name),name:$LE.name,type:$LE.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push($Lt)}var $LG=0;for($LG=$Lc.isConchApp?$Li.getProgramParameterEx(this._vs,this._ps,"",35718):$Li.getProgramParameter(this._program,35718),$L_=0;$L_<$LG;$L_++){var $LN=null;$LN=$Lc.isConchApp?$Li.getActiveUniformEx(this._vs,this._ps,"",$L_):$Li.getActiveUniform(this._program,$L_),0<($Lt={vartype:"uniform",ivartype:1,attrib:$LE,location:$Li.getUniformLocation(this._program,$LN.name),name:$LN.name,type:$LN.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($Lt.name=$Lt.name.substr(0,$Lt.name.length-3),$Lt.isArray=!0,$Lt.location=$Li.getUniformLocation(this._program,$Lt.name)),this._uniformParams.push($Lt)}for($L_=0,$LA=this._attributeParams.length;$L_<$LA;$L_++)($Lt=this._attributeParams[$L_]).indexOfParams=$L_,$Lt.index=1,$Lt.value=[$Lt.location,null],$Lt.codename=$Lt.name,$Lt.name=null!=this._attributeMap[$Lt.codename]?this._attributeMap[$Lt.codename]:$Lt.codename,this._attributeParamsMap.push($Lt.name),this._attributeParamsMap.push($Lt),$Lt._this=this,$Lt.uploadedValue=[],$Lt.fun=this._attribute;for($L_=0,$LA=this._uniformParams.length;$L_<$LA;$L_++)switch(($Lt=this._uniformParams[$L_]).indexOfParams=$L_,$Lt.index=1,$Lt.value=[$Lt.location,null],$Lt.codename=$Lt.name,null!=this._sceneUniformMap[$Lt.codename]?($Lt.name=this._sceneUniformMap[$Lt.codename],this._sceneUniformParamsMap.push($Lt.name),this._sceneUniformParamsMap.push($Lt)):null!=this._cameraUniformMap[$Lt.codename]?($Lt.name=this._cameraUniformMap[$Lt.codename],this._cameraUniformParamsMap.push($Lt.name),this._cameraUniformParamsMap.push($Lt)):null!=this._spriteUniformMap[$Lt.codename]?($Lt.name=this._spriteUniformMap[$Lt.codename],this._spriteUniformParamsMap.push($Lt.name),this._spriteUniformParamsMap.push($Lt)):null!=this._materialUniformMap[$Lt.codename]?($Lt.name=this._materialUniformMap[$Lt.codename],this._materialUniformParamsMap.push($Lt.name),this._materialUniformParamsMap.push($Lt)):null!=this._renderElementUniformMap[$Lt.codename]?($Lt.name=this._renderElementUniformMap[$Lt.codename],this._renderElementUniformParamsMap.push($Lt.name),this._renderElementUniformParamsMap.push($Lt)):console.log("Shader:can't find uinform name:"+$Lt.codename+" in shader file."),$Lt._this=this,$Lt.uploadedValue=[],$Lt.type){case 5124:$Lt.fun=$Lt.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$Lt.fun=$Lt.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$Lt.fun=$Lt.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$Lt.fun=$Lt.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$Lt.fun=$Lt.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$Lt.fun=this._uniform_sampler2D;break;case 35680:$Lt.fun=this._uniform_samplerCube;break;case 35676:$Lt.fun=this._uniformMatrix4fv;break;case 35670:$Lt.fun=this._uniform1i;break;case 35674:$Lt.fun=this._uinformMatrix2fv;break;case 35675:$Lt.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},$Li._attribute=function($Lr,$Li){var $Lt=$Lk.mainContext,$L_=$LG._enableAtributes,$LA=$Lr.location;return $L_[$LA]||$Lt.enableVertexAttribArray($LA),$Lt.vertexAttribPointer($LA,$Li[0],$Li[1],$Li[2],$Li[3],$Li[4]),$L_[$LA]=$LG._bindVertexBuffer,1},$Li._uniform1f=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li?($Lk.mainContext.uniform1f($Lr.location,$Lt[0]=$Li),1):0},$Li._uniform1fv=function($Lr,$Li){if($Li.length<4){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]||$Lt[2]!==$Li[2]||$Lt[3]!==$Li[3]?($Lk.mainContext.uniform1fv($Lr.location,$Li),$Lt[0]=$Li[0],$Lt[1]=$Li[1],$Lt[2]=$Li[2],$Lt[3]=$Li[3],1):0}return $Lk.mainContext.uniform1fv($Lr.location,$Li),1},$Li._uniform_vec2=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]?($Lk.mainContext.uniform2f($Lr.location,$Lt[0]=$Li[0],$Lt[1]=$Li[1]),1):0},$Li._uniform_vec2v=function($Lr,$Li){if($Li.length<2){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]||$Lt[2]!==$Li[2]||$Lt[3]!==$Li[3]?($Lk.mainContext.uniform2fv($Lr.location,$Li),$Lt[0]=$Li[0],$Lt[1]=$Li[1],$Lt[2]=$Li[2],$Lt[3]=$Li[3],1):0}return $Lk.mainContext.uniform2fv($Lr.location,$Li),1},$Li._uniform_vec3=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]||$Lt[2]!==$Li[2]?($Lk.mainContext.uniform3f($Lr.location,$Lt[0]=$Li[0],$Lt[1]=$Li[1],$Lt[2]=$Li[2]),1):0},$Li._uniform_vec3v=function($Lr,$Li){return $Lk.mainContext.uniform3fv($Lr.location,$Li),1},$Li._uniform_vec4=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]||$Lt[2]!==$Li[2]||$Lt[3]!==$Li[3]?($Lk.mainContext.uniform4f($Lr.location,$Lt[0]=$Li[0],$Lt[1]=$Li[1],$Lt[2]=$Li[2],$Lt[3]=$Li[3]),1):0},$Li._uniform_vec4v=function($Lr,$Li){return $Lk.mainContext.uniform4fv($Lr.location,$Li),1},$Li._uniformMatrix2fv=function($Lr,$Li){return $Lk.mainContext.uniformMatrix2fv($Lr.location,!1,$Li),1},$Li._uniformMatrix3fv=function($Lr,$Li){return $Lk.mainContext.uniformMatrix3fv($Lr.location,!1,$Li),1},$Li._uniformMatrix4fv=function($Lr,$Li){return $Lk.mainContext.uniformMatrix4fv($Lr.location,!1,$Li),1},$Li._uinformMatrix2fv=function($Lr,$Li){return $Lk.mainContext.uniformMatrix2fv($Lr.location,!1,$Li),1},$Li._uinformMatrix3fv=function($Lr,$Li){return $Lk.mainContext.uniformMatrix3fv($Lr.location,!1,$Li),1},$Li._uniform1i=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li?($Lk.mainContext.uniform1i($Lr.location,$Lt[0]=$Li),1):0},$Li._uniform1iv=function($Lr,$Li){return $Lk.mainContext.uniform1iv($Lr.location,$Li),1},$Li._uniform_ivec2=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]?($Lk.mainContext.uniform2i($Lr.location,$Lt[0]=$Li[0],$Lt[1]=$Li[1]),1):0},$Li._uniform_ivec2v=function($Lr,$Li){return $Lk.mainContext.uniform2iv($Lr.location,$Li),1},$Li._uniform_vec3i=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]||$Lt[2]!==$Li[2]?($Lk.mainContext.uniform3i($Lr.location,$Lt[0]=$Li[0],$Lt[1]=$Li[1],$Lt[2]=$Li[2]),1):0},$Li._uniform_vec3vi=function($Lr,$Li){return $Lk.mainContext.uniform3iv($Lr.location,$Li),1},$Li._uniform_vec4i=function($Lr,$Li){var $Lt=$Lr.uploadedValue;return $Lt[0]!==$Li[0]||$Lt[1]!==$Li[1]||$Lt[2]!==$Li[2]||$Lt[3]!==$Li[3]?($Lk.mainContext.uniform4i($Lr.location,$Lt[0]=$Li[0],$Lt[1]=$Li[1],$Lt[2]=$Li[2],$Lt[3]=$Li[3]),1):0},$Li._uniform_vec4vi=function($Lr,$Li){return $Lk.mainContext.uniform4iv($Lr.location,$Li),1},$Li._uniform_sampler2D=function($Lr,$Li){var $Lt=$Li.source||$Li.defaulteTexture.source,$L_=$Lk.mainContext,$LA=$Lr.uploadedValue;if(null!=$LA[0])return $L_.activeTexture($Lg._TEXTURES[$LA[0]]),$Lt&&$Le.bindTexture($L_,3553,$Lt),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $LA[0]=this._curActTexIndex,$L_.uniform1i($Lr.location,this._curActTexIndex),$L_.activeTexture($Lg._TEXTURES[this._curActTexIndex]),$Lt&&$Le.bindTexture($L_,3553,$Lt),this._curActTexIndex++,1},$Li._uniform_samplerCube=function($Lr,$Li){var $Lt=$Li.source||$Li.defaulteTexture.source,$L_=$Lk.mainContext,$LA=$Lr.uploadedValue;if(null!=$LA[0])return $L_.activeTexture($Lg._TEXTURES[$LA[0]]),$Lt?$Le.bindTexture($L_,34067,$Lt):$Le.bindTexture($L_,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $LA[0]=this._curActTexIndex,$L_.uniform1i($Lr.location,this._curActTexIndex),$L_.activeTexture($Lg._TEXTURES[this._curActTexIndex]),$Lt?$Le.bindTexture($L_,34067,$Lt):$Le.bindTexture($L_,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},$Li._noSetValue=function($Lr){console.log("no....:"+$Lr.name)},$Li.bind=function(){return $Lt.activeShader=this,($Lt.bindShader=this).activeResource(),$Le.UseProgram(this._program)},$Li.uploadAttributes=function($Lr,$Li){for(var $Lt,$L_,$LA=0,$Lf=0,$LE=this._attributeParamsMap.length;$Lf<$LE;$Lf+=2)$L_=this._attributeParamsMap[$Lf+1],null!=($Lt=$Lr[this._attributeParamsMap[$Lf]])&&($Li&&$Li[$L_.name]&&$Li[$L_.name].bind(),$LA+=$L_.fun.call(this,$L_,$Lt));$LH.shaderCall+=$LA},$Li.uploadAttributesX=function($Lr,$Li){for(var $Lt,$L_,$LA=0,$Lf=0,$LE=this._attributeParamsMap.length;$Lf<$LE;$Lf+=2)$L_=this._attributeParamsMap[$Lf+1],null!=($Lt=$Lr[this._attributeParamsMap[$Lf]])&&($Li._bind(),$LA+=$L_.fun.call(this,$L_,$Lt));$LH.shaderCall+=$LA},$Li.uploadSceneUniforms=function($Lr){for(var $Li,$Lt,$L_=0,$LA=0,$Lf=this._sceneUniformParamsMap.length;$LA<$Lf;$LA+=2)$Lt=this._sceneUniformParamsMap[$LA+1],null!=($Li=$Lr[this._sceneUniformParamsMap[$LA]])&&($L_+=$Lt.fun.call(this,$Lt,$Li));$LH.shaderCall+=$L_},$Li.uploadCameraUniforms=function($Lr){for(var $Li,$Lt,$L_=0,$LA=0,$Lf=this._cameraUniformParamsMap.length;$LA<$Lf;$LA+=2)$Lt=this._cameraUniformParamsMap[$LA+1],null!=($Li=$Lr[this._cameraUniformParamsMap[$LA]])&&($L_+=$Lt.fun.call(this,$Lt,$Li));$LH.shaderCall+=$L_},$Li.uploadSpriteUniforms=function($Lr){for(var $Li,$Lt,$L_=0,$LA=0,$Lf=this._spriteUniformParamsMap.length;$LA<$Lf;$LA+=2)$Lt=this._spriteUniformParamsMap[$LA+1],null!=($Li=$Lr[this._spriteUniformParamsMap[$LA]])&&($L_+=$Lt.fun.call(this,$Lt,$Li));$LH.shaderCall+=$L_},$Li.uploadMaterialUniforms=function($Lr){for(var $Li,$Lt,$L_=0,$LA=0,$Lf=this._materialUniformParamsMap.length;$LA<$Lf;$LA+=2)$Lt=this._materialUniformParamsMap[$LA+1],null!=($Li=$Lr[this._materialUniformParamsMap[$LA]])&&($L_+=$Lt.fun.call(this,$Lt,$Li));$LH.shaderCall+=$L_},$Li.uploadRenderElementUniforms=function($Lr){for(var $Li,$Lt,$L_=0,$LA=0,$Lf=this._renderElementUniformParamsMap.length;$LA<$Lf;$LA+=2)$Lt=this._renderElementUniformParamsMap[$LA+1],null!=($Li=$Lr[this._renderElementUniformParamsMap[$LA]])&&($L_+=$Lt.fun.call(this,$Lt,$Li));$LH.shaderCall+=$L_},$Lg.create=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){return new $Lg($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp)},$Lg.addInclude=function($Lr,$Li){$Ln.addInclude($Lr,$Li)},$Lg._createShader=function($Lr,$Li,$Lt){var $L_=$Lr.createShader($Lt);if($Lr.shaderSource($L_,$Li),$Lr.compileShader($L_),$LHi.debugMode&&!$Lr.getShaderParameter($L_,35713))throw $Lr.getShaderInfoLog($L_);return $L_},$Lg.PERIOD_RENDERELEMENT=0,$Lg.PERIOD_MATERIAL=1,$Lg.PERIOD_SPRITE=2,$Lg.PERIOD_CAMERA=3,$Lg.PERIOD_SCENE=4,$Lg._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],$Lg._count=0,$Lg._preCompile=!1,$Lg.extCompileFunc=null,$Lg.extCompileObj=null,$LR($Lg,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new $Ls}]),$Lg}(),$Lhi=function($LG){function $LN(){this._transformUV=null,$LN.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new $LEi(.6,.6,.6)),this._setColor(10,new $LEi(1,1,1)),this._setColor(11,new $LGi(1,1,1,8)),this._setColor(12,new $LEi(1,1,1)),this._setColor(7,new $LGi(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new $LGi(1,1,0,0)),this.renderMode=1}$Lv($LN,"laya.d3.core.material.StandardMaterial",$LG);var $Lr=$LN.prototype;return $Lr.disableLight=function(){this._addDisablePublicShaderDefine($LHi.SHADERDEFINE_POINTLIGHT|$LHi.SHADERDEFINE_SPOTLIGHT|$LHi.SHADERDEFINE_DIRECTIONLIGHT)},$Lr.disableFog=function(){this._addDisablePublicShaderDefine($LHi.SHADERDEFINE_FOG)},$Lr.onAsynLoaded=function($Lr,$Li,$Lt){var $L_=$Li[0];if($L_.version)$LG.prototype.onAsynLoaded.call(this,$Lr,$Li,$Lt);else{var $LA=$Li[1],$Lf=$L_.props;for(var $LE in $Lf)this[$LE]=$Lf[$LE];$LN._parseStandardMaterial($LA,this,$L_),this._endLoaded()}},$Lr.cloneTo=function($Lr){$LG.prototype.cloneTo.call(this,$Lr);var $Li=$Lr;this._transformUV&&($Li._transformUV=this._transformUV.clone())},$LO(0,$Lr,"ambientColor",function(){return this._getColor(9)},function($Lr){this._setColor(9,$Lr)}),$LO(0,$Lr,"ambientTexture",function(){return this._getTexture(5)},function($Lr){$Lr?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,$Lr)}),$LO(0,$Lr,"renderMode",null,function($Lr){switch($Lr){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($LN.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode($Lr)}),$LO(0,$Lr,"reflectColor",function(){return this._getColor(12)},function($Lr){this._setColor(12,$Lr)}),$LO(0,$Lr,"tilingOffset",function(){return this._getColor(15)},function($Lr){if($Lr){var $Li=$Lr.elements;1!=$Li[0]||1!=$Li[1]||0!=$Li[2]||0!=$Li[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,$Lr)}),$LO(0,$Lr,"albedo",function(){return this._getColor(7)},function($Lr){this._setColor(7,$Lr)}),$LO(0,$Lr,"diffuseColor",function(){return this._getColor(10)},function($Lr){this._setColor(10,$Lr)}),$LO(0,$Lr,"albedoColor",function(){return this._getColor(7)},function($Lr){this._setColor(7,$Lr)}),$LO(0,$Lr,"specularColor",function(){return this._getColor(11)},function($Lr){this._setColor(11,$Lr)}),$LO(0,$Lr,"diffuseTexture",function(){return this._getTexture(1)},function($Lr){$Lr?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,$Lr)}),$LO(0,$Lr,"normalTexture",function(){return this._getTexture(2)},function($Lr){$Lr?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,$Lr)}),$LO(0,$Lr,"specularTexture",function(){return this._getTexture(3)},function($Lr){$Lr?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,$Lr)}),$LO(0,$Lr,"emissiveTexture",function(){return this._getTexture(4)},function($Lr){$Lr?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,$Lr)}),$LO(0,$Lr,"reflectTexture",function(){return this._getTexture(6)},function($Lr){$Lr?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,$Lr)}),$LO(0,$Lr,"transformUV",function(){return this._transformUV},function($Lr){this._transformUV=$Lr,this._setMatrix4x4(13,$Lr.matrix),$Lr?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,$Lr.matrix.elements,0)}),$LN.__init__=function(){$LN.SHADERDEFINE_DIFFUSEMAP=$LN.shaderDefines.registerDefine("DIFFUSEMAP"),$LN.SHADERDEFINE_NORMALMAP=$LN.shaderDefines.registerDefine("NORMALMAP"),$LN.SHADERDEFINE_SPECULARMAP=$LN.shaderDefines.registerDefine("SPECULARMAP"),$LN.SHADERDEFINE_EMISSIVEMAP=$LN.shaderDefines.registerDefine("EMISSIVEMAP"),$LN.SHADERDEFINE_AMBIENTMAP=$LN.shaderDefines.registerDefine("AMBIENTMAP"),$LN.SHADERDEFINE_REFLECTMAP=$LN.shaderDefines.registerDefine("REFLECTMAP"),$LN.SHADERDEFINE_UVTRANSFORM=$LN.shaderDefines.registerDefine("UVTRANSFORM"),$LN.SHADERDEFINE_TILINGOFFSET=$LN.shaderDefines.registerDefine("TILINGOFFSET"),$LN.SHADERDEFINE_ADDTIVEFOG=$LN.shaderDefines.registerDefine("ADDTIVEFOG")},$LN.load=function($Lr){return $LD.loader.create($Lr,null,null,$LN)},$LN._parseStandardMaterial=function($Lr,$Li,$Lt){var $L_=$Lt.customProps,$LA=$L_.ambientColor;$Li.ambientColor=new $LEi($LA[0],$LA[1],$LA[2]);var $Lf=$L_.diffuseColor;$Li.diffuseColor=new $LEi($Lf[0],$Lf[1],$Lf[2]);var $LE=$L_.specularColor;$Li.specularColor=new $LGi($LE[0],$LE[1],$LE[2],$LE[3]);var $LG=$L_.reflectColor;$Li.reflectColor=new $LEi($LG[0],$LG[1],$LG[2]);var $LN=$L_.albedoColor;$LN&&($Li.albedo=new $LGi($LN[0],$LN[1],$LN[2],$LN[3]));var $Lp=$L_.diffuseTexture.texture2D;$Lp&&($Li.diffuseTexture=$Ly.getRes($Lr[$Lp]));var $Lg=$L_.normalTexture.texture2D;$Lg&&($Li.normalTexture=$Ly.getRes($Lr[$Lg]));var $LR=$L_.specularTexture.texture2D;$LR&&($Li.specularTexture=$Ly.getRes($Lr[$LR]));var $LX=$L_.emissiveTexture.texture2D;$LX&&($Li.emissiveTexture=$Ly.getRes($Lr[$LX]));var $Lv=$L_.ambientTexture.texture2D;$Lv&&($Li.ambientTexture=$Ly.getRes($Lr[$Lv]));var $LO=$L_.reflectTexture.texture2D;$LO&&($Li.reflectTexture=$Ly.getRes($Lr[$LO]))},$LN.RENDERMODE_OPAQUE=1,$LN.RENDERMODE_OPAQUEDOUBLEFACE=2,$LN.RENDERMODE_CUTOUT=3,$LN.RENDERMODE_CUTOUTDOUBLEFACE=4,$LN.RENDERMODE_TRANSPARENT=13,$LN.RENDERMODE_TRANSPARENTDOUBLEFACE=14,$LN.RENDERMODE_ADDTIVE=15,$LN.RENDERMODE_ADDTIVEDOUBLEFACE=16,$LN.RENDERMODE_DEPTHREAD_TRANSPARENT=5,$LN.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,$LN.RENDERMODE_DEPTHREAD_ADDTIVE=7,$LN.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,$LN.RENDERMODE_NONDEPTH_TRANSPARENT=9,$LN.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,$LN.RENDERMODE_NONDEPTH_ADDTIVE=11,$LN.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,$LN.SHADERDEFINE_DIFFUSEMAP=0,$LN.SHADERDEFINE_NORMALMAP=0,$LN.SHADERDEFINE_SPECULARMAP=0,$LN.SHADERDEFINE_EMISSIVEMAP=0,$LN.SHADERDEFINE_AMBIENTMAP=0,$LN.SHADERDEFINE_REFLECTMAP=0,$LN.SHADERDEFINE_UVTRANSFORM=0,$LN.SHADERDEFINE_TILINGOFFSET=0,$LN.SHADERDEFINE_ADDTIVEFOG=0,$LN.DIFFUSETEXTURE=1,$LN.NORMALTEXTURE=2,$LN.SPECULARTEXTURE=3,$LN.EMISSIVETEXTURE=4,$LN.AMBIENTTEXTURE=5,$LN.REFLECTTEXTURE=6,$LN.ALBEDO=7,$LN.UVANIAGE=8,$LN.MATERIALAMBIENT=9,$LN.MATERIALDIFFUSE=10,$LN.MATERIALSPECULAR=11,$LN.MATERIALREFLECT=12,$LN.UVMATRIX=13,$LN.UVAGE=14,$LN.TILINGOFFSET=15,$LR($LN,["defaultMaterial",function(){var $Lr=new $LN;return $Lr.lock=!0,this.defaultMaterial=$Lr},"shaderDefines",function(){return this.shaderDefines=new $Lgi($LUi.shaderDefines)}]),$LN}($LUi),$LPi=function($Lr){function $LE($Lr,$Li,$Lt,$L_,$LA){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===$Lt&&($Lt=35044),void 0===$L_&&($L_=!1),$LE.__super.call(this),this._indexType=$Lr,this._indexCount=$Li,this._bufferUsage=$Lt,this._bufferType=34963,this._canRead=$L_;var $Lf;if("ushort"==$Lr)this._indexTypeByteCount=2;else{if("ubyte"!=$Lr)throw new Error("unidentification index type.");this._indexTypeByteCount=1}$Lf=this._indexTypeByteCount*$Li,this._byteLength=$Lf,this._bind(),$LG._gl.bufferData(this._bufferType,$Lf,this._bufferUsage),this.uri=$LA,$L_?("ushort"==$Lr?this._buffer=new Uint16Array($Li):"ubyte"==$Lr&&(this._buffer=new Uint8Array($Li)),this.memorySize=2*$Lf):this.memorySize=$Lf}$Lv($LE,"laya.d3.graphics.IndexBuffer3D",$Lr);var $Li=$LE.prototype;return $Li.setData=function($Lr,$Li,$Lt,$L_){void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=4294967295);var $LA=0;if("ushort"==this._indexType?($LA=2,0===$Lt&&4294967295===$L_||($Lr=new Uint16Array($Lr.buffer,$Lt*$LA,$L_))):"ubyte"==this._indexType&&($LA=1,0===$Lt&&4294967295===$L_||($Lr=new Uint8Array($Lr.buffer,$Lt*$LA,$L_))),this._bind(),$LG._gl.bufferSubData(this._bufferType,$Li*$LA,$Lr),this._canRead)if(0!==$Li||0!==$Lt||4294967295!==$L_){var $Lf=this._buffer.length-$Li;$Lf<$L_&&($L_=$Lf);for(var $LE=0;$LE<$L_;$LE++)this._buffer[$Li+$LE]=$Lr[$LE]}else this._buffer=$Lr},$Li.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$Li.disposeResource=function(){$Lr.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},$LO(0,$Li,"indexType",function(){return this._indexType}),$LO(0,$Li,"indexTypeByteCount",function(){return this._indexTypeByteCount}),$LO(0,$Li,"indexCount",function(){return this._indexCount}),$LO(0,$Li,"canRead",function(){return this._canRead}),$LE.INDEXTYPE_UBYTE="ubyte",$LE.INDEXTYPE_USHORT="ushort",$LE.create=function($Lr,$Li,$Lt,$L_,$LA){return void 0===$Lt&&($Lt=35044),void 0===$L_&&($L_=!1),new $LE($Lr,$Li,$Lt,$L_,$LA)},$LE}($LG),$Lqi=function($Lf){function $LE($Lr,$Li,$Lt,$L_,$LA){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===$L_&&($L_=!1),$LE.__super.call(this),this._vertexDeclaration=$Lr,this._vertexCount=$Li,this._bufferUsage=$Lt,this._bufferType=34962,this._canRead=$L_,this.uri=$LA,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*$Li,this._bind(),$LG._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),$L_&&(this._buffer=new Float32Array(this._byteLength/4))}$Lv($LE,"laya.d3.graphics.VertexBuffer3D",$Lf);var $Lr=$LE.prototype;return $Lr.bindWithIndexBuffer=function($Lr){$Lr&&$Lr._bind(),this._bind()},$Lr.setData=function($Lr,$Li,$Lt,$L_){if(void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=4294967295),0===$Lt&&4294967295===$L_||($Lr=new Float32Array($Lr.buffer,4*$Lt,$L_)),this._bind(),$LG._gl.bufferSubData(this._bufferType,4*$Li,$Lr),this._canRead)if(0!==$Li||0!==$Lt||4294967295!==$L_){var $LA=this._buffer.length-$Li;$LA<$L_&&($L_=$LA);for(var $Lf=0;$Lf<$L_;$Lf++)this._buffer[$Li+$Lf]=$Lr[$Lf]}else this._buffer=$Lr},$Lr.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$Lr.disposeResource=function(){for(var $Lr=$Lk.mainContext,$Li=this._vertexDeclaration.getVertexElements(),$Lt=$LG._enableAtributes,$L_=0,$LA=$Li.length;$L_<$LA;$L_++)$Lt[$L_]===this._glBuffer&&($Lr.disableVertexAttribArray($L_),$Lt[$L_]=null);$Lf.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},$LO(0,$Lr,"vertexDeclaration",function(){return this._vertexDeclaration}),$LO(0,$Lr,"vertexCount",function(){return this._vertexCount}),$LO(0,$Lr,"canRead",function(){return this._canRead}),$LE.create=function($Lr,$Li,$Lt,$L_,$LA){return void 0===$Lt&&($Lt=35044),void 0===$L_&&($L_=!1),new $LE($Lr,$Li,$Lt,$L_,$LA)},$LE}($LG),$Lmi=function($Lr){function $Ln(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,$Ln.__super.call(this),this._type=3553}$Lv($Ln,"laya.d3.resource.DataTexture2D",$Lki);var $Li=$Ln.prototype;return $Li.genDebugMipmaps=function(){var $Lr=[];return $Lr.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),$Lr.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),$Lr.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),$Lr.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),$Lr.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),$Lr.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),$Lr.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),$Lr.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),$Lr.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),$Lr.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),$Lr},$Li._onTextureLoaded=function($Lr){},$Li._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var $Lr=$Lk.mainContext,$Li=this._source=$Lr.createTexture(),$Lt=this._width,$L_=this._height,$LA=$Le.curBindTexTarget,$Lf=$Le.curBindTexValue,$LE=!1;if($Le.bindTexture($Lr,this._type,$Li),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var $LG=0;$Lr.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var $LN=0;$LN<this._mipmaps.length;$LN++){if(this._mipmaps[$LN].byteLength!=$Lp*$Lg*4)throw"mipmap size error  level:"+$LN;$Lr.texSubImage2D(this._type,0,$Ln.simLodRect[$LG++],$Ln.simLodRect[$LG++],$Ln.simLodRect[$LG++],$Ln.simLodRect[$LG++],6408,5121,new Uint8Array(this._mipmaps[$LN]))}this.minFifter=9729,this.magFifter=9729}else{var $Lp=this._width,$Lg=this._height;for($LG=0,$Lr.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),$LN=0;$LN<this._mipmaps.length;$LN++){if(this._mipmaps[$LN].byteLength!=$Lp*$Lg*4)throw"mipmap size error  level:"+$LN;$Lr.texImage2D(this._type,$LN,6408,$Lp,$Lg,0,6408,5121,new Uint8Array(this._mipmaps[$LN])),($Lp/=2)<1&&($Lp=1),($Lg/=2)<1&&($Lg=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&$Lr.pixelStorei($Lr.UNPACK_ALIGNMENT,1),$Lr.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var $LR=0,$LX=!1,$Lv=!1;this._buffer.byteLength==4*$Lt*$L_?($LR=6408,$LX=!0):this._buffer.byteLength==3*$Lt*$L_?($LR=6407,$Lv=!0):$LR=this._format,$LX||$Lv?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),$Lv&&$Lr.pixelStorei($Lr.UNPACK_ALIGNMENT,1),$Lr.texImage2D(this._type,0,$LR,$Lt,$L_,0,$LR,5121,this._buffer)):$Lr&&$LR==$Lr.ALPHA?($Lr.texImage2D(3553,0,$LR,$Lt,$L_,0,$LR,$Lr.UNSIGNED_BYTE,this._buffer),$LE=!0):0!=$LR&&($Lr.compressedTexImage2D(3553,0,$LR,$Lt,$L_,0,this._buffer),$LE=!0)}var $LO=this._minFifter,$Lc=this._magFifter,$LB=0==this._wrapModeU?10497:33071,$Ly=0==this._wrapModeV?10497:33071,$LC=$La.isPOT($Lt,$L_);$LC?(this._mipmap||this._mipmaps?-1!==$LO||($LO=9987):-1!==$LO||($LO=9729),-1!==$Lc||($Lc=9729),$Lr.texParameteri(this._type,10241,$LO),$Lr.texParameteri(this._type,10240,$Lc),$Lr.texParameteri(this._type,10242,$LB),$Lr.texParameteri(this._type,10243,$Ly),this._mipmap&&$Lr.generateMipmap(this._type)):(-1!==$LO||($LO=9729),-1!==$Lc||($Lc=9729),$Lr.texParameteri(this._type,10241,$LO),$Lr.texParameteri(this._type,10240,$Lc),$Lr.texParameteri(this._type,10242,33071),$Lr.texParameteri(this._type,10243,33071)),$LA&&$Lf&&$Le.bindTexture($Lr,$LA,$Lf),this.memorySize=$LE?this._buffer.length:$LC?$Lt*$L_*4*(1+1/3):$Lt*$L_*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},$Li.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},$Li.onAsynLoaded=function($Lr,$Li,$Lt){var $L_;$Lt&&($L_=$Lt[0].call(this,$Li)),$L_&&(this._width=$L_.width,this._height=$L_.height,this._buffer=$L_.data),this._src=$Lr,this._size=new $Lci(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},$Li.getPixels=function(){return new Uint8Array(this._buffer)},$Li.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&($Lk.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},$LO(0,$Li,"src",function(){return this._src}),$Ln.create=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){if(void 0===$L_&&($L_=9729),void 0===$LA&&($LA=9729),void 0===$Lf&&($Lf=!0),!$Lr||$Lr.byteLength<$Li*$Lt*4)throw"DataTexture2D create error";var $LG=new $Ln;return $LG.uri=$LE,$LG._buffer=$Lr,$LG._width=$Li,$LG._height=$Lt,$LG._mipmap=$Lf,$LG._magFifter=$L_,$LG._minFifter=$LA,$LG._size=new $Lci($LG._width,$LG._height),$LG._conchTexture?alert("怎么给runtime传递datatexture数据"):$LG.activeResource(),$LG},$Ln.load=function($Lr,$Li,$Lt,$L_,$LA){if(void 0===$Li&&($Li=0),void 0===$Lt&&($Lt=0),void 0===$L_&&($L_=9729),void 0===$LA&&($LA=9729),"mipmaps"===$Ld.getFileExtension($Lr)){var $Lf=$LD.loader.create($Lr,null,null,$Ln,[function($Lr){this._mipmaps=[];var $Li=new Uint32Array($Lr);this._width=$Li[0];var $Lt=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,$Lt=1024),this._width!=$Lt)throw"现在只支持512x256的环境贴图。当前的是"+$Li[0];this._height=$Li[1];for(var $L_=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,$LA=this._height,$Lf=8;;){var $LE=$L_*$LA*4;if($Lf+$LE>$Lr.byteLength)throw"load mipmaps data size error ";var $LG=new Uint8Array($Lr,$Lf,$LE);if(this._mipmaps.push($LG),$Lf+=$LE,1==$L_&&1==$LA)break;($L_/=2)<1&&($L_=1),($LA/=2)<1&&($LA=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){$Lf.simLodInfo=new Float32Array(40);for(var $LE=0;$LE<$Lf.simLodInfo.length;)$Lf.simLodInfo[$LE]=($Ln.simLodRect[$LE]+.5)/1024,$LE++,$Lf.simLodInfo[$LE]=($Ln.simLodRect[$LE]+.5)/256,$LE++,$Lf.simLodInfo[$LE]=Math.max($Ln.simLodRect[$LE]-1,.1)/1024,$LE++,$Lf.simLodInfo[$LE]=Math.max($Ln.simLodRect[$LE]-1.5,.1)/256,$LE++}return $Lf}if("number"==typeof $Li)return $LD.loader.create($Lr,null,null,$Ln,[function($Lr){return this._width=$Li,this._height=$Lt,this._buffer=$Lr,null}]);if("function"==typeof $Li)return $LD.loader.create($Lr,null,null,$Ln,[$Li]);throw new Error("unknown params.")},$Ln.lodasatlas=!1,$LR($Ln,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),$Ln}(),$LTi=function($Lr){function $Li(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,$Li.__super.call(this)}$Lv($Li,"laya.d3.resource.models.PrimitiveMesh",$Lei);var $Lt=$Li.prototype;return $LD.imps($Lt,{"laya.d3.core.render.IRenderable":!0}),$Lt._getVertexBuffer=function($Lr){return void 0===$Lr&&($Lr=0),0===$Lr?this._vertexBuffer:null},$Lt._getVertexBuffers=function(){return null},$Lt._getIndexBuffer=function(){return this._indexBuffer},$Lt._getPositions=function(){var $Lr,$Li=[],$Lt=this._vertexBuffer.vertexDeclaration.getVertexElements(),$L_=0;for($L_=0;$L_<$Lt.length;$L_++){var $LA=$Lt[$L_];if("vector3"===$LA.elementFormat&&0===$LA.elementUsage){$Lr=$LA;break}}var $Lf=this._vertexBuffer.getData();for($L_=0;$L_<$Lf.length;$L_+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var $LE=$L_+$Lr.offset/4,$LG=new $LEi($Lf[$LE+0],$Lf[$LE+1],$Lf[$LE+2]);$Li.push($LG)}return $Li},$Lt.getRenderElement=function($Lr){return this},$Lt.getRenderElementsCount=function(){return 1},$Lt.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},$Lt._beforeRender=function($Lr){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$Lt._render=function($Lr){$Lk.mainContext.drawElements(4,this._numberIndices,5123,0),$LH.drawCall++,$LH.trianglesFaces+=this._numberIndices/3},$LO(0,$Lt,"_vertexBufferCount",function(){return 1}),$LO(0,$Lt,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$Li}(),$Lxi=function($Lr){function $Li(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,$Li.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}$Lv($Li,"laya.d3.resource.models.Mesh",$Lei);var $Lt=$Li.prototype;return $Lt._getPositions=function(){var $Lr,$Li,$Lt,$L_,$LA,$Lf=[],$LE=0,$LG=0,$LN=0;if(0!==this._vertexBuffers.length){var $Lp=this._vertexBuffers.length;for($LE=0;$LE<$Lp;$LE++){for($Lt=($Lr=this._vertexBuffers[$LE]).vertexDeclaration.getVertexElements(),$LG=0;$LG<$Lt.length;$LG++)if("vector3"===($L_=$Lt[$LG]).elementFormat&&0===$L_.elementUsage){$Li=$L_;break}for($LA=$Lr.getData(),$LG=0;$LG<$LA.length;$LG+=$Lr.vertexDeclaration.vertexStride/4)$LN=$LG+$Li.offset/4,$Lf.push(new $LEi($LA[$LN+0],$LA[$LN+1],$LA[$LN+2]))}}else{var $Lg=this._subMeshes.length;for($LE=0;$LE<$Lg;$LE++){for($Lt=($Lr=this._subMeshes[$LE]._getVertexBuffer()).vertexDeclaration.getVertexElements(),$LG=0;$LG<$Lt.length;$LG++)if("vector3"===($L_=$Lt[$LG]).elementFormat&&0===$L_.elementUsage){$Li=$L_;break}for($LA=$Lr.getData(),$LG=0;$LG<$LA.length;$LG+=$Lr.vertexDeclaration.vertexStride/4)$LN=$LG+$Li.offset/4,$Lf.push(new $LEi($LA[$LN+0],$LA[$LN+1],$LA[$LN+2]))}}return $Lf},$Lt._setSubMeshes=function($Lr){this._subMeshes=$Lr,this._subMeshCount=$Lr.length;for(var $Li=0;$Li<this._subMeshCount;$Li++)$Lr[$Li]._indexInMesh=$Li;this._positions=this._getPositions(),this._generateBoundingObject()},$Lt.onAsynLoaded=function($Lr,$Li,$Lt){var $L_=$Li[0],$LA=$Li[1];$LWr.read($L_,this,this._materials,this._subMeshes,$LA),this.completeCreate(),this._endLoaded()},$Lt.getSubMesh=function($Lr){return this._subMeshes[$Lr]},$Lt.getSubMeshCount=function(){return this._subMeshes.length},$Lt.getRenderElementsCount=function(){return this._subMeshes.length},$Lt.getRenderElement=function($Lr){return this._subMeshes[$Lr]},$Lt.disposeResource=function(){for(var $Lr=0;$Lr<this._subMeshes.length;$Lr++)this._subMeshes[$Lr].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},$LO(0,$Lt,"materials",function(){return this._materials.slice()}),$LO(0,$Lt,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),$Li.load=function($Lr){return $LD.loader.create($Lr,null,null,$Li)},$Li}(),$L$i=(function($Lr){function $Lp($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===$Lt&&($Lt=6408),void 0===$L_&&($L_=5121),void 0===$LA&&($LA=33189),void 0===$Lf&&($Lf=!1),void 0===$LE&&($LE=!1),void 0===$LG&&($LG=-1),void 0===$LN&&($LN=-1),$Lp.__super.call(this),this._type=3553,this._width=$Lr,this._height=$Li,this._size=new $Lci($Lr,$Li),this._surfaceFormat=$Lt,this._surfaceType=$L_,this._depthStencilFormat=$LA,$Lc.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=$Lf,this._repeat=$LE,this._minFifter=$LG,this._magFifter=$LN,this.activeResource(),this._alreadyResolved=!0}$Lv($Lp,"laya.d3.resource.RenderTexture",$Lki);var $Li=$Lp.prototype;$Li.recreateResource=function(){var $Lr=$Lk.mainContext;this._frameBuffer=$Lr.createFramebuffer(),this._source=$Lr.createTexture();var $Li=$Le.curBindTexTarget,$Lt=$Le.curBindTexValue;$Le.bindTexture($Lr,this._type,this._source),$Lr.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var $L_=this._minFifter,$LA=this._magFifter,$Lf=this._repeat?10497:33071;if($La.isPOT(this._width,this._height)?(this._mipmap?-1!==$L_||($L_=9987):-1!==$L_||($L_=9729),-1!==$LA||($LA=9729),$Lr.texParameteri(this._type,10241,$L_),$Lr.texParameteri(this._type,10240,$LA),$Lr.texParameteri(this._type,10242,$Lf),$Lr.texParameteri(this._type,10243,$Lf),this._mipmap&&$Lr.generateMipmap(this._type)):(-1!==$L_||($L_=9729),-1!==$LA||($LA=9729),$Lr.texParameteri(this._type,10241,$L_),$Lr.texParameteri(this._type,10240,$LA),$Lr.texParameteri(this._type,10242,33071),$Lr.texParameteri(this._type,10243,33071)),$Li&&$Lt&&$Le.bindTexture($Lr,$Li,$Lt),$Lr.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=$Lr.createRenderbuffer(),$Lr.bindRenderbuffer(36161,this._depthStencilBuffer),$Lr.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),$Lr.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:$Lr.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$Lr.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$Lr.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$Lr.framebufferTexture2D(36160,36064,3553,this._source,0),$Lr.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},$Li.start=function(){$Lk.mainContext.bindFramebuffer(36160,this.frameBuffer),($Lp._currentRenderTarget=this)._alreadyResolved=!1},$Li.end=function(){$Lk.mainContext.bindFramebuffer(36160,null),$Lp._currentRenderTarget=null,this._alreadyResolved=!0},$Li.getData=function($Lr,$Li,$Lt,$L_){var $LA=$Lk.mainContext;if($LA.bindFramebuffer(36160,this._frameBuffer),!(36053===$LA.checkFramebufferStatus(36160)))return $LA.bindFramebuffer(36160,null),null;var $Lf=new Uint8Array(this._width*this._height*4);return $LA.readPixels($Lr,$Li,$Lt,$L_,this._surfaceFormat,this._surfaceType,$Lf),$LA.bindFramebuffer(36160,null),$Lf},$Li.disposeResource=function(){if(this._frameBuffer){var $Lr=$Lk.mainContext;$Lr.deleteTexture(this._source),$Lr.deleteFramebuffer(this._frameBuffer),$Lr.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},$LO(0,$Li,"surfaceFormat",function(){return this._surfaceFormat}),$LO(0,$Li,"surfaceType",function(){return this._surfaceType}),$LO(0,$Li,"depthStencilFormat",function(){return this._depthStencilFormat}),$LO(0,$Li,"source",function(){return this._alreadyResolved?$LD.superGet($Lki,this,"source"):null}),$LO(0,$Li,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$LO(0,$Li,"frameBuffer",function(){return this._frameBuffer}),$Lp._currentRenderTarget=null}(),function($Lr){function $Li($Lr){this._color=null,this._pixels=null,$Li.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new $Lci(this.width,this.height),this._color=$Lr,this._pixels=new Uint8Array([255*$Lr.x,255*$Lr.y,255*$Lr.z,255*$Lr.w]),this.uri="SolidColorTexture2D_"+this.id}$Lv($Li,"laya.d3.resource.SolidColorTexture2D",$Lki);var $Lt=$Li.prototype;return $Lt._createWebGlTexture=function(){var $Lr=$Lk.mainContext,$Li=this._source=$Lr.createTexture(),$Lt=this._width,$L_=this._height,$LA=$Le.curBindTexTarget,$Lf=$Le.curBindTexValue;$Le.bindTexture($Lr,this._type,$Li),$Lr.texImage2D(this._type,0,6408,$Lt,$L_,0,6408,5121,this._pixels);var $LE=this._minFifter,$LG=this._magFifter,$LN=this._repeat?10497:33071,$Lp=$La.isPOT($Lt,$L_);$Lp?(this._mipmap?-1!==$LE||($LE=9987):-1!==$LE||($LE=9729),-1!==$LG||($LG=9729),$Lr.texParameteri(this._type,10241,$LE),$Lr.texParameteri(this._type,10240,$LG),$Lr.texParameteri(this._type,10242,$LN),$Lr.texParameteri(this._type,10243,$LN),this._mipmap&&$Lr.generateMipmap(this._type)):(-1!==$LE||($LE=9729),-1!==$LG||($LG=9729),$Lr.texParameteri(this._type,10241,$LE),$Lr.texParameteri(this._type,10240,$LG),$Lr.texParameteri(this._type,10242,33071),$Lr.texParameteri(this._type,10243,33071)),$LA&&$Lf&&$Le.bindTexture($Lr,$LA,$Lf),this.memorySize=$Lp?$Lt*$L_*4*(1+1/3):$Lt*$L_*4},$Lt.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$Lt.disposeResource=function(){this._source&&($Lk.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$LR($Li,["magentaTexture",function(){var $Lr=new $Li(new $LGi(1,0,1,1));return $Lr.lock=!0,this.magentaTexture=$Lr},"grayTexture",function(){var $Lr=new $Li(new $LGi(.5,.5,.5,1));return $Lr.lock=!0,this.grayTexture=$Lr}]),$Li}()),$Loi=function($Lr){function $LA($Lr,$Li,$Lt,$L_){this._canRead=!1,this._image=null,this._pixels=null,void 0===$Lr&&($Lr=!1),void 0===$Li&&($Li=!0),void 0===$Lt&&($Lt=6408),void 0===$L_&&($L_=!0),$LA.__super.call(this),this._type=3553,this._repeat=$Li,this._canRead=$Lr,this._format=$Lt,this._mipmap=$L_}$Lv($LA,"laya.d3.resource.Texture2D",$Lki);var $Li=$LA.prototype;return $Li._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $Lr=$Lk.mainContext,$Li=this._source=$Lr.createTexture(),$Lt=this._width,$L_=this._height,$LA=$Le.curBindTexTarget,$Lf=$Le.curBindTexValue;switch($Le.bindTexture($Lr,this._type,$Li),this._format){case 6407:case 6408:this._canRead?$Lr.texImage2D(this._type,0,this._format,$Lt,$L_,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?$Lr.texImage2D(this._type,0,this._image._format,$Lt,$L_,0,this._image._format,5121,this._image.atlasSource):$Lr.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case $Lk.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$Lr.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var $LE=this._minFifter,$LG=this._magFifter,$LN=this._repeat?10497:33071,$Lp=0==this._wrapModeU?10497:33071,$Lg=0==this._wrapModeV?10497:33071,$LR=$La.isPOT($Lt,$L_);$LR?(this._mipmap?-1!==$LE||($LE=9987):-1!==$LE||($LE=9729),-1!==$LG||($LG=9729),$Lr.texParameteri(this._type,10241,$LE),$Lr.texParameteri(this._type,10240,$LG),$Lr.texParameteri(this._type,10242,$LN),$Lr.texParameteri(this._type,10243,$LN),$Lr.texParameteri(this._type,10242,$Lp),$Lr.texParameteri(this._type,10243,$Lg),this._mipmap&&$Lr.generateMipmap(this._type)):(-1!==$LE||($LE=9729),-1!==$LG||($LG=9729),$Lr.texParameteri(this._type,10241,$LE),$Lr.texParameteri(this._type,10240,$LG),$Lr.texParameteri(this._type,10242,33071),$Lr.texParameteri(this._type,10243,33071)),$LA&&$Lf&&$Le.bindTexture($Lr,$LA,$Lf),this._image.onload=null,this._image=null,this.memorySize=$LR?$Lt*$L_*4*(1+1/3):$Lt*$L_*4},$Li.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$Li.onAsynLoaded=function($Lr,$Li,$Lt){if($Lt){var $L_=$Lt[0];void 0!==$L_&&(this._canRead=$L_);var $LA=$Lt[1];void 0!==$LA&&(this._repeat=$LA);var $Lf=$Lt[2];void 0!==$Lf&&(this._format=$Lf);var $LE=$Lt[3];void 0!==$LE&&(this._mipmap=$LE);var $LG=$Lt.wrapModeU;void 0!==$LG&&(this._wrapModeU=$LG);var $LN=$Lt.wrapModeV;void 0!==$LN&&(this._wrapModeV=$LN)}switch(this._format){case 6407:case 6408:var $Lp=(this._image=$Li).width,$Lg=$Li.height;this._width=$Lp,this._height=$Lg,this._size=new $Lci($Lp,$Lg),this._canRead&&($Lc.isConchApp?$Li instanceof $LX.HTMLElement&&(this._pixels=new Uint8Array($Li.getImageData(0,0,$Lp,$Lg))):($LL.canvas.size($Lp,$Lg),$LL.canvas.clear(),$LL.context.drawImage($Li,0,0,$Lp,$Lg),this._pixels=new Uint8Array($LL.context.getImageData(0,0,$Lp,$Lg).data.buffer)));break;case $Lk.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var $LR=new $Lu($Li);$LR.readUTFBytes(4),$LR.readUTFBytes(2),$LR.getInt16();$LR.endian="bigEndian",this._width=$LR.getInt16(),this._height=$LR.getInt16(),this._size=new $Lci(this._width,this._height);$LR.getInt16(),$LR.getInt16();this._image=new Uint8Array($Li,$LR.pos)}this.recreateResource(),this._endLoaded()},$Li.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},$Li.disposeResource=function(){this._source&&($Lk.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},$LO(0,$Li,"_src",function(){return this.url}),$LO(0,$Li,"src",function(){return this.url}),$LA.load=function($Lr){return $LD.loader.create($Lr,null,null,$LA)},$LA}(),$LIi=function($Li){function $Lt($Lr,$Li){$Lt.__super.call(this),void 0===$Lr&&($Lr=.3),void 0===$Li&&($Li=1e3),this._tempVector3=new $LEi,this._position=new $LEi,this._up=new $LEi,this._forward=new $LEi,this._right=new $LEi,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=$Lci.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=$Lr,this._farPlane=$Li,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),$LD.stage.on("resize",this,this._onScreenSizeChanged)}$Lv($Lt,"laya.d3.core.BaseCamera",$Li);var $Lr=$Lt.prototype;return $Lr._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var $Lr=this.scene._cameraPool,$Li=$Lr.length-1,$Lt=0;$Lt<$Li;$Lt++)if($Lr[$Lt].renderingOrder>$Lr[$Li].renderingOrder){var $L_=$Lr[$Lt];$Lr[$Lt]=$Lr[$Li],$Lr[$Li]=$L_}},$Lr._calculateProjectionMatrix=function(){},$Lr._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},$Lr._prepareCameraToRender=function(){$LQ._currentCameraCullingMask=this.cullingMask;var $Lr=this._shaderValues;$Lr.setValue(0,this.transform.position.elements),$Lr.setValue(5,this.forward.elements),$Lr.setValue(6,this.up.elements)},$Lr._prepareCameraViewProject=function($Lr,$Li){var $Lt=this._shaderValues;$Lt.setValue(1,$Lr.elements),$Lt.setValue(2,$Li.elements)},$Lr._renderCamera=function($Lr,$Li,$Lt){},$Lr.addLayer=function($Lr){29!==$Lr.number&&30!=$Lr.number&&(this.cullingMask=this.cullingMask|$Lr.mask)},$Lr.removeLayer=function($Lr){29!==$Lr.number&&30!=$Lr.number&&(this.cullingMask=this.cullingMask&~$Lr.mask)},$Lr.addAllLayers=function(){this.cullingMask=2147483647},$Lr.removeAllLayers=function(){this.cullingMask=0|$LQ.getLayerByNumber(29).mask|$LQ.getLayerByNumber(30).mask},$Lr.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},$Lr.moveForward=function($Lr){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=$Lr,this.transform.translate(this._tempVector3)},$Lr.moveRight=function($Lr){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=$Lr,this.transform.translate(this._tempVector3)},$Lr.moveVertical=function($Lr){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=$Lr,this.transform.translate(this._tempVector3,!1)},$Lr._addSelfRenderObjects=function(){var $Lr=this.scene._cameraPool,$Li=$Lr.length;if(0<$Li){for(var $Lt=$Li-1;0<=$Lt;$Lt--)if(this.renderingOrder<=$Lr[$Lt].renderingOrder){$Lr.splice($Lt+1,0,this);break}}else $Lr.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},$Lr._clearSelfRenderObjects=function(){var $Lr=this.scene._cameraPool;$Lr.splice($Lr.indexOf(this),1)},$Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,$LD.stage.off("resize",this,this._onScreenSizeChanged),$Li.prototype.destroy.call(this,$Lr)},$LO(0,$Lr,"sky",function(){return this._sky},function($Lr){(this._sky=$Lr)._ownerCamera=this}),$LO(0,$Lr,"forward",function(){var $Lr=this.transform.worldMatrix.elements,$Li=this._forward.elements;return $Li[0]=-$Lr[8],$Li[1]=-$Lr[9],$Li[2]=-$Lr[10],this._forward}),$LO(0,$Lr,"position",function(){var $Lr=this.transform.worldMatrix.elements,$Li=this._position.elements;return $Li[0]=$Lr[12],$Li[1]=$Lr[13],$Li[2]=$Lr[14],this._position}),$LO(0,$Lr,"renderTarget",function(){return this._renderTarget},function($Lr){null!=(this._renderTarget=$Lr)&&(this._renderTargetSize=$Lr.size)}),$LO(0,$Lr,"up",function(){var $Lr=this.transform.worldMatrix.elements,$Li=this._up.elements;return $Li[0]=$Lr[4],$Li[1]=$Lr[5],$Li[2]=$Lr[6],this._up}),$LO(0,$Lr,"right",function(){var $Lr=this.transform.worldMatrix.elements,$Li=this._right.elements;return $Li[0]=$Lr[0],$Li[1]=$Lr[1],$Li[2]=$Lr[2],this._right}),$LO(0,$Lr,"renderTargetSize",function(){return this._renderTargetSize},function($Lr){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=$Lr,this._calculateProjectionMatrix()}),$LO(0,$Lr,"fieldOfView",function(){return this._fieldOfView},function($Lr){this._fieldOfView=$Lr,this._calculateProjectionMatrix()}),$LO(0,$Lr,"nearPlane",function(){return this._nearPlane},function($Lr){this._nearPlane=$Lr,this._calculateProjectionMatrix()}),$LO(0,$Lr,"farPlane",function(){return this._farPlane},function($Lr){this._farPlane=$Lr,this._calculateProjectionMatrix()}),$LO(0,$Lr,"orthographic",function(){return this._orthographic},function($Lr){this._orthographic=$Lr,this._calculateProjectionMatrix()}),$LO(0,$Lr,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function($Lr){this._orthographicVerticalSize=$Lr,this._calculateProjectionMatrix()}),$LO(0,$Lr,"renderingOrder",function(){return this._renderingOrder},function($Lr){this._renderingOrder=$Lr,this._sortCamerasByRenderingOrder()}),$Lt.CAMERAPOS=0,$Lt.VIEWMATRIX=1,$Lt.PROJECTMATRIX=2,$Lt.VPMATRIX=3,$Lt.VPMATRIX_NO_TRANSLATE=4,$Lt.CAMERADIRECTION=5,$Lt.CAMERAUP=6,$Lt.ENVIRONMENTDIFFUSE=7,$Lt.ENVIRONMENTSPECULAR=8,$Lt.SIMLODINFO=9,$Lt.DIFFUSEIRRADMATR=10,$Lt.DIFFUSEIRRADMATG=11,$Lt.DIFFUSEIRRADMATB=12,$Lt.HDREXPOSURE=13,$Lt.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",$Lt.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",$Lt.CLEARFLAG_SOLIDCOLOR=0,$Lt.CLEARFLAG_SKY=1,$Lt.CLEARFLAG_DEPTHONLY=2,$Lt.CLEARFLAG_NONE=3,$LR($Lt,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new $Lri(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new $Lri},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new $Lri}]),$Lt}($Lbi),$Lzi=function($Lt){function $Li($Lr){this._render=null,this._geometryFilter=null,$Li.__super.call(this,$Lr)}$Lv($Li,"laya.d3.core.RenderableSprite3D",$Lt);var $Lr=$Li.prototype;return $Lr._addToInitStaticBatchManager=function(){},$Lr._setBelongScene=function($Lr){$Lt.prototype._setBelongScene.call(this,$Lr),$Lr._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},$Lr._setUnBelongScene=function(){var $Lr=this._scene._renderableSprite3Ds,$Li=$Lr.indexOf(this);$Lr.splice($Li,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),$Lt.prototype._setUnBelongScene.call(this)},$Lr._update=function($Lr){($Lr.owner=this)._activeInHierarchy&&(this._updateComponents($Lr),this._render._updateOctreeNode(),this._lateUpdateComponents($Lr),$LH.spriteCount++,this._childs.length&&this._updateChilds($Lr))},$Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),$Lt.prototype.destroy.call(this,$Lr),this._render._destroy(),this._render=null},$Li.__init__=function(){$Li.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=$Li.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),$Li.SAHDERDEFINE_LIGHTMAP=$Li.shaderDefines.registerDefine("LIGHTMAP")},$Li.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,$Li.SAHDERDEFINE_LIGHTMAP=4,$Li.LIGHTMAPSCALEOFFSET=2,$Li.LIGHTMAP=3,$LR($Li,["shaderDefines",function(){return this.shaderDefines=new $Lgi}]),$Li}($Lbi),$LJi=(function($Lr){function $L_($Lr,$Li,$Lt){this._long=NaN,this._width=NaN,this._height=NaN,void 0===$Lr&&($Lr=1),void 0===$Li&&($Li=1),void 0===$Lt&&($Lt=1),$L_.__super.call(this),this._long=$Lr,this._width=$Li,this._height=$Lt,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$Lv($L_,"laya.d3.resource.models.BoxMesh",$LTi);var $Li=$L_.prototype;$Li.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var $Lr=$Lkr.vertexDeclaration,$Li=($Lr.vertexStride,this._long/2),$Lt=this._height/2,$L_=this._width/2,$LA=new Float32Array([-$Li,$Lt,-$L_,0,1,0,0,0,$Li,$Lt,-$L_,0,1,0,1,0,$Li,$Lt,$L_,0,1,0,1,1,-$Li,$Lt,$L_,0,1,0,0,1,-$Li,-$Lt,-$L_,0,-1,0,0,1,$Li,-$Lt,-$L_,0,-1,0,1,1,$Li,-$Lt,$L_,0,-1,0,1,0,-$Li,-$Lt,$L_,0,-1,0,0,0,-$Li,$Lt,-$L_,-1,0,0,0,0,-$Li,$Lt,$L_,-1,0,0,1,0,-$Li,-$Lt,$L_,-1,0,0,1,1,-$Li,-$Lt,-$L_,-1,0,0,0,1,$Li,$Lt,-$L_,1,0,0,1,0,$Li,$Lt,$L_,1,0,0,0,0,$Li,-$Lt,$L_,1,0,0,0,1,$Li,-$Lt,-$L_,1,0,0,1,1,-$Li,$Lt,$L_,0,0,1,0,0,$Li,$Lt,$L_,0,0,1,1,0,$Li,-$Lt,$L_,0,0,1,1,1,-$Li,-$Lt,$L_,0,0,1,0,1,-$Li,$Lt,-$L_,0,0,-1,1,0,$Li,$Lt,-$L_,0,0,-1,0,0,$Li,-$Lt,-$L_,0,0,-1,0,1,-$Li,-$Lt,-$L_,0,0,-1,1,1]),$Lf=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new $Lqi($Lr,this._numberVertices,35044,!0),this._indexBuffer=new $LPi("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData($LA),this._indexBuffer.setData($Lf),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$LO(0,$Li,"long",function(){return this._long},function($Lr){this._long!==$Lr&&(this._long=$Lr,this.releaseResource(),this.activeResource())}),$LO(0,$Li,"width",function(){return this._width},function($Lr){this._width!==$Lr&&(this._width=$Lr,this.releaseResource(),this.activeResource())}),$LO(0,$Li,"height",function(){return this._height},function($Lr){this._height!==$Lr&&(this._height=$Lr,this.releaseResource(),this.activeResource())})}(),function($Lr){function $LA($Lr,$Li,$Lt,$L_){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===$Lr&&($Lr=10),void 0===$Li&&($Li=10),void 0===$Lt&&($Lt=10),void 0===$L_&&($L_=10),$LA.__super.call(this),this._long=$Lr,this._width=$Li,this._stacks=$Lt,this._slices=$L_,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$Lv($LA,"laya.d3.resource.models.PlaneMesh",$LTi);var $Li=$LA.prototype;$Li.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var $Lr=new Uint16Array(this._numberIndices),$Li=$Lkr.vertexDeclaration,$Lt=$Li.vertexStride/4,$L_=new Float32Array(this._numberVertices*$Lt),$LA=this._long/2,$Lf=this._width/2,$LE=this._long/this._stacks,$LG=this._width/this._slices,$LN=0,$Lp=0;$Lp<=this._slices;$Lp++)for(var $Lg=0;$Lg<=this._stacks;$Lg++)$L_[$LN++]=$Lg*$LE-$LA,$L_[$LN++]=0,$L_[$LN++]=$Lp*$LG-$Lf,$L_[$LN++]=0,$L_[$LN++]=1,$L_[$LN++]=0,$L_[$LN++]=1*$Lg/this._stacks,$L_[$LN++]=1*$Lp/this._slices;var $LR=0;for($Lp=0;$Lp<this._slices;$Lp++)for($Lg=0;$Lg<this._stacks;$Lg++)$Lr[$LR++]=($Lp+1)*(this._stacks+1)+$Lg,$Lr[$LR++]=$Lp*(this._stacks+1)+$Lg,$Lr[$LR++]=($Lp+1)*(this._stacks+1)+$Lg+1,$Lr[$LR++]=$Lp*(this._stacks+1)+$Lg,$Lr[$LR++]=$Lp*(this._stacks+1)+$Lg+1,$Lr[$LR++]=($Lp+1)*(this._stacks+1)+$Lg+1;this._vertexBuffer=new $Lqi($Li,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new $LPi("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData($L_),this._indexBuffer.setData($Lr),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$LO(0,$Li,"long",function(){return this._long},function($Lr){this._long!==$Lr&&(this._long=$Lr,this.releaseResource(),this.activeResource())}),$LO(0,$Li,"width",function(){return this._width},function($Lr){this._width!==$Lr&&(this._width=$Lr,this.releaseResource(),this.activeResource())}),$LO(0,$Li,"stacks",function(){return this._stacks},function($Lr){this._stacks!==$Lr&&(this._stacks=$Lr,this.releaseResource(),this.activeResource())}),$LO(0,$Li,"slices",function(){return this._slices},function($Lr){this._slices!==$Lr&&(this._slices=$Lr,this.releaseResource(),this.activeResource())})}(),function($Lr){function $LE($Lr,$Li,$Lt){void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=.3),void 0===$Lt&&($Lt=1e3),this._viewMatrix=new $Lri,this._projectionMatrix=new $Lri,this._projectionViewMatrix=new $Lri,this._viewport=new $LNi(0,0,0,0),this._normalizedViewport=new $LNi(0,0,1,1),this._aspectRatio=$Lr,this._boundFrustumUpdate=!0,this._boundFrustum=new $LKr($Lri.DEFAULT),$LE.__super.call(this,$Li,$Lt),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}$Lv($LE,"laya.d3.core.Camera",$LIi);var $Li=$LE.prototype;return $Li._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},$Li._parseCustomProps=function($Lr,$Li,$Lt,$L_){var $LA=$Lt.clearColor;this.clearColor=new $LGi($LA[0],$LA[1],$LA[2],$LA[3]);var $Lf=$Lt.viewport;this.normalizedViewport=new $LNi($Lf[0],$Lf[1],$Lf[2],$Lf[3])},$Li._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var $Lr=this.orthographicVerticalSize*this.aspectRatio*.5,$Li=.5*this.orthographicVerticalSize;$Lri.createOrthoOffCenterRH(-$Lr,$Lr,-$Li,$Li,this.nearPlane,this.farPlane,this._projectionMatrix)}else $Lri.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},$Li._update=function($Lr){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,$Lr)},$Li._renderCamera=function($Lr,$Li,$Lt){var $L_,$LA;$Lt.parallelSplitShadowMaps[0]&&$Lt._renderShadowMap($Lr,$Li,this),($Li.camera=this)._prepareCameraToRender(),$Lt._preRenderUpdateComponents($Li),$L_=$Li._viewMatrix=this.viewMatrix;var $Lf=this._renderTarget;$Lf?($Lf.start(),$Lri.multiply($LIi._invertYScaleMatrix,this._projectionMatrix,$LIi._invertYProjectionMatrix),$Lri.multiply($LIi._invertYScaleMatrix,this.projectionViewMatrix,$LIi._invertYProjectionViewMatrix),$LA=$Li._projectionMatrix=$LIi._invertYProjectionMatrix,$Li._projectionViewMatrix=$LIi._invertYProjectionViewMatrix):($LA=$Li._projectionMatrix=this._projectionMatrix,$Li._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject($L_,$LA),$Li._viewport=this.viewport,$Lt._preRenderScene($Lr,$Li,this.boundFrustum),$Lt._clear($Lr,$Li),$Lt._renderScene($Lr,$Li),$Lt._postRenderUpdateComponents($Li),$Lf&&$Lf.end()},$Li.viewportPointToRay=function($Lr,$Li){$LOi.calculateCursorRay($Lr,this.viewport,this._projectionMatrix,this.viewMatrix,null,$Li)},$Li.normalizedViewportPointToRay=function($Lr,$Li){var $Lt=$LE._tempVector20,$L_=this.viewport,$LA=$Lr.elements,$Lf=$Lt.elements;$Lf[0]=$LA[0]*$L_.width,$Lf[1]=$LA[1]*$L_.height,$LOi.calculateCursorRay($Lt,this.viewport,this._projectionMatrix,this.viewMatrix,null,$Li)},$Li.worldToViewportPoint=function($Lr,$Li){$Lri.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project($Lr,this._projectionViewMatrix,$Li);var $Lt=$Li.elements;$Lt[0]=$Lt[0]/$LD.stage.clientScaleX,$Lt[1]=$Lt[1]/$LD.stage.clientScaleY},$Li.worldToNormalizedViewportPoint=function($Lr,$Li){$Lri.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project($Lr,this._projectionViewMatrix,$Li);var $Lt=$Li.elements;$Lt[0]=$Lt[0]/$LD.stage.clientScaleX,$Lt[1]=$Lt[1]/$LD.stage.clientScaleY},$Li.convertScreenCoordToOrthographicCoord=function($Lr,$Li){if(this._orthographic){var $Lt=$LW.clientWidth,$L_=$LW.clientHeight,$LA=this.orthographicVerticalSize*this.aspectRatio/$Lt,$Lf=this.orthographicVerticalSize/$L_,$LE=$Lr.elements,$LG=$Li.elements;return $LG[0]=(-$Lt/2+$LE[0])*$LA,$LG[1]=($L_/2-$LE[1])*$Lf,$LG[2]=(this.nearPlane-this.farPlane)*($LE[2]+1)/2-this.nearPlane,$LEi.transformCoordinate($Li,this.transform.worldMatrix,$Li),!0}return!1},$LO(0,$Li,"projectionViewMatrix",function(){return $Lri.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),$LO(0,$Li,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var $Lr=this.viewport;return $Lr.width/$Lr.height},function($Lr){if($Lr<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=$Lr,this._calculateProjectionMatrix()}),$LO(0,$Li,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),$LO(0,$Li,"needViewport",function(){var $Lr=this.normalizedViewport;return 0===$Lr.x&&0===$Lr.y&&1===$Lr.width&&1===$Lr.height}),$LO(0,$Li,"viewport",function(){if(this._viewportExpressedInClipSpace){var $Lr=this._normalizedViewport,$Li=this.renderTargetSize,$Lt=$Li.width,$L_=$Li.height;this._viewport.x=$Lr.x*$Lt,this._viewport.y=$Lr.y*$L_,this._viewport.width=$Lr.width*$Lt,this._viewport.height=$Lr.height*$L_}return this._viewport},function($Lr){if(null!=this.renderTarget&&($Lr.x<0||$Lr.y<0||0==$Lr.width||0==$Lr.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=$Lr,this._calculateProjectionMatrix()}),$LO(0,$Li,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var $Lr=this._viewport,$Li=this.renderTargetSize,$Lt=$Li.width,$L_=$Li.height;this._normalizedViewport.x=$Lr.x/$Lt,this._normalizedViewport.y=$Lr.y/$L_,this._normalizedViewport.width=$Lr.width/$Lt,this._normalizedViewport.height=$Lr.height/$L_}return this._normalizedViewport},function($Lr){$Lr.x<0&&($Lr.x=0,console.warn("Camera: viewport.x must large than 0.0.")),$Lr.y<0&&($Lr.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<$Lr.x+$Lr.width&&($Lr.width=1-$Lr.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<$Lr.y+$Lr.height&&($Lr.height=1-$Lr.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=$Lr,this._calculateProjectionMatrix()}),$LO(0,$Li,"projectionMatrix",function(){return this._projectionMatrix},function($Lr){this._projectionMatrix=$Lr,this._useUserProjectionMatrix=!0}),$LO(0,$Li,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),$LR($LE,["_tempVector20",function(){return this._tempVector20=new $Lfi}]),$LE}()),$LZi=function($Lt){function $L_($Lr,$Li){$L_.__super.call(this,$Li),this._geometryFilter=new $LLi(this),this._render=new $LQi(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),$Lr&&(this._geometryFilter.sharedMesh=$Lr)instanceof laya.d3.resource.models.Mesh&&($Lr.loaded?this._render.sharedMaterials=$Lr.materials:$Lr.once("loaded",this,this._applyMeshMaterials))}$Lv($L_,"laya.d3.core.MeshSprite3D",$Lt);var $Lr=$L_.prototype;return $Lr._changeRenderObjectByMesh=function($Lr){var $Li=this._render._renderElements,$Lt=$Li[$Lr];$Lt||($Lt=$Li[$Lr]=new $Lwi),$Lt._render=this._render;var $L_=this._render.sharedMaterials[$Lr];$L_||($L_=$Lhi.defaultMaterial);var $LA=this._geometryFilter.sharedMesh.getRenderElement($Lr);return $Lt._mainSortID=this._getSortID($LA,$L_),$Lt._sprite3D=this,$Lt.renderObj=$LA,$Lt._material=$L_,$Lt},$Lr._changeRenderObjectByMaterial=function($Lr,$Li){var $Lt=this._render._renderElements[$Lr];$Li||($Li=$Lhi.defaultMaterial);var $L_=this._geometryFilter.sharedMesh.getRenderElement($Lr);return $Lt._mainSortID=this._getSortID($L_,$Li),$Lt._sprite3D=this,$Lt.renderObj=$L_,$Lt._material=$Li,$Lt},$Lr._changeRenderObjectsByMesh=function(){var $Lr=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=$Lr;for(var $Li=0;$Li<$Lr;$Li++)this._changeRenderObjectByMesh($Li)},$Lr._onMeshChanged=function($Lr){var $Li=$Lr.sharedMesh;$Li.loaded?this._changeRenderObjectsByMesh():$Li.once("loaded",this,this._onMeshLoaded)},$Lr._onMeshLoaded=function($Lr){$Lr===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},$Lr._onMaterialChanged=function($Lr,$Li,$Lt){$Li<this._render._renderElements.length&&this._changeRenderObjectByMaterial($Li,$Lt)},$Lr._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},$Lr._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},$Lr._parseCustomProps=function($Lr,$Li,$Lt,$L_){var $LA=this.meshRender,$Lf=$Lt.lightmapIndex;null!=$Lf&&($LA.lightmapIndex=$Lf);var $LE,$LG,$LN=$Lt.lightmapScaleOffset;if($LN&&($LA.lightmapScaleOffset=new $LGi($LN[0],$LN[1],$LN[2],$LN[3])),$L_.instanceParams)($LE=$L_.instanceParams.loadPath)&&($LG=$Ly.getRes($Li[$LE]),(this.meshFilter.sharedMesh=$LG).loaded?$LA.sharedMaterials=$LG.materials:$LG.once("loaded",this,this._applyMeshMaterials));else{($LE=$Lt.meshPath)&&($LG=$Ly.getRes($Li[$LE]),this.meshFilter.sharedMesh=$LG);var $Lp=$Lt.materials;if($Lp){var $Lg=$LA.sharedMaterials,$LR=$Lp.length;$Lg.length=$LR;for(var $LX=0;$LX<$LR;$LX++)$Lg[$LX]=$Ly.getRes($Li[$Lp[$LX].path]);$LA.sharedMaterials=$Lg}}},$Lr._applyMeshMaterials=function($Lr){for(var $Li=this._render.sharedMaterials,$Lt=$Lr.materials,$L_=0,$LA=$Lt.length;$L_<$LA;$L_++)$Li[$L_]||($Li[$L_]=$Lt[$L_]);this._render.sharedMaterials=$Li},$Lr._addToInitStaticBatchManager=function(){$L_._staticBatchManager._addInitBatchSprite(this)},$Lr.cloneTo=function($Lr){var $Li=$Lr;$Li._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var $Lt=this._render,$L_=$Li._render;$L_.enable=$Lt.enable,$L_.sharedMaterials=$Lt.sharedMaterials,$L_.castShadow=$Lt.castShadow;var $LA=$Lt.lightmapScaleOffset;$LA&&($L_.lightmapScaleOffset=$LA.clone()),$L_.lightmapIndex=$Lt.lightmapIndex,$L_.receiveShadow=$Lt.receiveShadow,$L_.sortingFudge=$Lt.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,$Lr)},$Lr.destroy=function($Lr){if(void 0===$Lr&&($Lr=!0),!this.destroyed){var $Li=this.meshFilter.sharedMesh;null!=$Li&&($Li.loaded||$Li.off("loaded",this,this._applyMeshMaterials)),$Lt.prototype.destroy.call(this,$Lr),this._geometryFilter._destroy()}},$LO(0,$Lr,"meshFilter",function(){return this._geometryFilter}),$LO(0,$Lr,"meshRender",function(){return this._render}),$L_.__init__=function(){$L_r._staticBatchManagers.push($L_._staticBatchManager)},$L_.load=function($Lr){return $LD.loader.create($Lr,null,null,$L_)},$LR($L_,["_staticBatchManager",function(){return this._staticBatchManager=new $Lsi}]),$L_}($Lzi)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($Lr,$Li){"use strict";for(var $Lt in Object.defineProperty($Li,"__esModule",{value:!0}),Laya){var $L_=Laya[$Lt];$L_&&$L_.__isclass&&($Li[$Lt]=$L_)}}),function($Lr,$Li,$LAr){$LAr.un,$LAr.uns;var $Lt=$LAr.static,$L_=$LAr.class,$Lf=$LAr.getset,$Lc=$LAr.__newvec,$LG=laya.maths.Bezier,$LR=laya.utils.Browser,$Lkr=laya.utils.Byte,$LA=(laya.events.Event,laya.events.EventDispatcher),$LE=laya.display.Graphics,$LN=(laya.resource.HTMLCanvas,laya.utils.Handler),$Lp=laya.net.Loader,$LX=laya.maths.MathUtil,$Ler=laya.maths.Matrix,$LB=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),$Lg=(laya.renders.RenderContext,laya.resource.Resource),$Lv=laya.utils.RunDriver,$Lfr=laya.display.Sprite,$LO=laya.utils.Stat,$LLr=laya.resource.Texture,$Ly=(laya.net.URL,laya.utils.Utils),$Le=function(){function $Lr(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return $L_($Lr,"laya.ani.AnimationContent"),$Lr}(),$LL=function(){function $Lr(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return $L_($Lr,"laya.ani.AnimationNodeContent"),$Lr}(),$Ln=function(){function $Lr(){}return $L_($Lr,"laya.ani.AnimationParser01"),$Lr.parse=function($Lr,$Li){var $Lt=$Li.__getBuffer(),$L_=0,$LA=0,$Lf=0,$LE=0,$LG=0,$LN=0,$Lp=0,$Lg=$Li.readUTFString();$Lr._aniClassName=$Lg;var $LR,$LX=$Li.readUTFString().split("\n"),$Lv=$Li.getUint8(),$LO=$Li.getUint32(),$Lc=$Li.getUint32();0<$LO&&($LR=$Lt.slice($LO,$Lc));var $LB=new $Lkr($LR);for(0<$Lc&&($Lr._publicExtData=$Lt.slice($Lc,$Lt.byteLength)),$Lr._useParent=!!$Li.getUint8(),$Lr._anis.length=$Lv,$L_=0;$L_<$Lv;$L_++){var $Ly=$Lr._anis[$L_]=new $Le;$Ly.nodes=new Array;var $LC=$Ly.name=$LX[$Li.getUint16()];$Lr._aniMap[$LC]=$L_,$Ly.bone3DMap={},$Ly.playTime=$Li.getFloat32(),$Ly.playTime<=0&&console.error("播放时间不能为0  url="+$Lr.url+" name="+$Ly.name);var $Ln=$Ly.nodes.length=$Li.getUint8();for($LA=$Ly.totalKeyframeDatasLength=0;$LA<$Ln;$LA++){var $La=$Ly.nodes[$LA]=new $LL;$La.childs=[];var $LD=$Li.getInt16();0<=$LD&&($La.name=$LX[$LD],$Ly.bone3DMap[$La.name]=$LA),$La.keyFrame=new Array,$La.parentIndex=$Li.getInt16(),-1==$La.parentIndex?$La.parent=null:$La.parent=$Ly.nodes[$La.parentIndex],$La.lerpType=$Li.getUint8();var $Lu=$Li.getUint32();$LB.pos=$Lu;var $Lw=$La.keyframeWidth=$LB.getUint16();if($Ly.totalKeyframeDatasLength+=$Lw,0===$La.lerpType||1===$La.lerpType)for($La.interpolationMethod=[],$La.interpolationMethod.length=$Lw,$Lf=0;$Lf<$Lw;$Lf++)$La.interpolationMethod[$Lf]=$Lb.interpolation[$LB.getUint8()];null!=$La.parent&&$La.parent.childs.push($La);var $LH=$Li.getUint16();0<$LH&&($La.extenData=$Lt.slice($Li.pos,$Li.pos+$LH),$Li.pos+=$LH);var $Ls,$Ld=$Li.getUint16(),$Ll=0;for($Lf=0,$LE=$La.keyFrame.length=$Ld;$Lf<$LE;$Lf++){if(($Ls=$La.keyFrame[$Lf]=new $LQ).duration=$Li.getFloat32(),$Ls.startTime=$Ll,2===$La.lerpType){$Ls.interpolationData=[];var $LU,$Lk=$Li.getUint8();switch($LU=$Li.getFloat32()){case 254:for($Ls.interpolationData.length=$Lw,$Lp=0;$Lp<$Lw;$Lp++)$Ls.interpolationData[$Lp]=0;break;case 255:for($Ls.interpolationData.length=$Lw,$Lp=0;$Lp<$Lw;$Lp++)$Ls.interpolationData[$Lp]=5;break;default:for($Ls.interpolationData.push($LU),$LN=1;$LN<$Lk;$LN++)$Ls.interpolationData.push($Li.getFloat32())}}for($Ls.data=new Float32Array($Lw),$LG=0;$LG<$Lw;$LG++)$Ls.data[$LG]=$Li.getFloat32(),-1e-8<$Ls.data[$LG]&&$Ls.data[$LG]<1e-8&&($Ls.data[$LG]=0);$Ll+=$Ls.duration}$Ls.startTime=$Ly.playTime,$La.playTime=$Ly.playTime,$Lr._calculateKeyFrame($La,$Ld,$Lw)}}},$Lr}(),$La=function(){function $LD(){}return $L_($LD,"laya.ani.AnimationParser02"),$LD.READ_DATA=function(){$LD._DATA.offset=$LD._reader.getUint32(),$LD._DATA.size=$LD._reader.getUint32()},$LD.READ_BLOCK=function(){for(var $Lr=$LD._BLOCK.count=$LD._reader.getUint16(),$Li=$LD._BLOCK.blockStarts=[],$Lt=$LD._BLOCK.blockLengths=[],$L_=0;$L_<$Lr;$L_++)$Li.push($LD._reader.getUint32()),$Lt.push($LD._reader.getUint32())},$LD.READ_STRINGS=function(){var $Lr=$LD._reader.getUint32(),$Li=$LD._reader.getUint16(),$Lt=$LD._reader.pos;$LD._reader.pos=$Lr+$LD._DATA.offset;for(var $L_=0;$L_<$Li;$L_++)$LD._strings[$L_]=$LD._reader.readUTFString();$LD._reader.pos=$Lt},$LD.parse=function($Lr,$Li){$LD._templet=$Lr;($LD._reader=$Li).__getBuffer();$LD.READ_DATA(),$LD.READ_BLOCK(),$LD.READ_STRINGS();for(var $Lt=0,$L_=$LD._BLOCK.count;$Lt<$L_;$Lt++){var $LA=$Li.getUint16(),$Lf=$LD._strings[$LA],$LE=$LD["READ_"+$Lf];if(null==$LE)throw new Error("model file err,no this function:"+$LA+" "+$Lf);$LE.call()}},$LD.READ_ANIMATIONS=function(){var $Lr=$LD._reader,$Li=$Lr.__getBuffer(),$Lt=0,$L_=0,$LA=0,$Lf=0,$LE=$Lr.getUint16(),$LG=[];for($LG.length=$LE,$Lt=0;$Lt<$LE;$Lt++)$LG[$Lt]=$Lb.interpolation[$Lr.getByte()];var $LN=$Lr.getUint8();for($LD._templet._anis.length=$LN,$Lt=0;$Lt<$LN;$Lt++){var $Lp=$LD._templet._anis[$Lt]={};$Lp.nodes=new Array;var $Lg=$Lp.name=$LD._strings[$Lr.getUint16()];$LD._templet._aniMap[$Lg]=$Lt,$Lp.bone3DMap={},$Lp.playTime=$Lr.getFloat32();var $LR=$Lp.nodes.length=$Lr.getInt16();for($L_=$Lp.totalKeyframeDatasLength=0;$L_<$LR;$L_++){var $LX=$Lp.nodes[$L_]={};$LX.keyframeWidth=$LE,$LX.childs=[];var $Lv=$Lr.getUint16();0<=$Lv&&($LX.name=$LD._strings[$Lv],$Lp.bone3DMap[$LX.name]=$L_),$LX.keyFrame=new Array,$LX.parentIndex=$Lr.getInt16(),-1==$LX.parentIndex?$LX.parent=null:$LX.parent=$Lp.nodes[$LX.parentIndex],$Lp.totalKeyframeDatasLength+=$LE,$LX.interpolationMethod=$LG,null!=$LX.parent&&$LX.parent.childs.push($LX);var $LO=$Lr.getUint16(),$Lc=null,$LB=null;for($LA=0,$Lf=$LX.keyFrame.length=$LO;$LA<$Lf;$LA++){($Lc=$LX.keyFrame[$LA]={}).startTime=$Lr.getFloat32(),$LB&&($LB.duration=$Lc.startTime-$LB.startTime);var $Ly=$LD._DATA.offset,$LC=$Lr.getUint32(),$Ln=4*$LE,$La=$Li.slice($Ly+$LC,$Ly+$LC+$Ln);$Lc.data=new Float32Array($La),$LB=$Lc}$Lc.duration=0,$LX.playTime=$Lp.playTime,$LD._templet._calculateKeyFrame($LX,$LO,$LE)}}},$LD._templet=null,$LD._reader=null,$LD._strings=[],$Lt($LD,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$LD}(),$LQr=(function(){function $Lr(){}$L_($Lr,"laya.ani.AnimationState"),$Lr.stopped=0,$Lr.paused=1,$Lr.playing=2}(),function(){function $LA(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new $Lzr,this.resultMatrix=new $Ler,this._children=[]}$L_($LA,"laya.ani.bone.Bone");var $Lr=$LA.prototype;return $Lr.setTempMatrix=function($Lr){this._tempMatrix=$Lr;var $Li,$Lt=0;for($Lt=0,$Li=this._children.length;$Lt<$Li;$Lt++)this._children[$Lt].setTempMatrix(this._tempMatrix)},$Lr.update=function($Lr){var $Li;if(this.rotation=this.transform.skX,$Lr)$Li=this.resultTransform.getMatrix(),$Ler.mul($Li,$Lr,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)$Li=this.resultTransform.getMatrix(),$Ler.mul($Li,this.parentBone.resultMatrix,this.resultMatrix);else{var $Lt=this.parentBone,$L_=NaN,$LA=NaN,$Lf=NaN,$LE=this.parentBone.resultMatrix;$Li=this.resultTransform.getMatrix();var $LG=$LE.a*$Li.tx+$LE.c*$Li.ty+$LE.tx,$LN=$LE.b*$Li.tx+$LE.d*$Li.ty+$LE.ty,$Lp=new $Ler;this.inheritRotation?($L_=Math.atan2($Lt.resultMatrix.b,$Lt.resultMatrix.a),$LA=Math.cos($L_),$Lf=Math.sin($L_),$Lp.setTo($LA,$Lf,-$Lf,$LA,0,0),$Ler.mul(this._tempMatrix,$Lp,$Ler.TEMP),$Ler.TEMP.copyTo($Lp),$Li=this.resultTransform.getMatrix(),$Ler.mul($Li,$Lp,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,$Li=this.resultTransform.getMatrix(),$Ler.TEMP.identity(),$Ler.TEMP.d=this.d,$Ler.mul($Li,$Ler.TEMP,this.resultMatrix)),this.resultMatrix.tx=$LG,this.resultMatrix.ty=$LN}else($Li=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var $Lg,$LR=0;for($LR=0,$Lg=this._children.length;$LR<$Lg;$LR++)this._children[$LR].update()},$Lr.updateChild=function(){var $Lr,$Li=0;for($Li=0,$Lr=this._children.length;$Li<$Lr;$Li++)this._children[$Li].update()},$Lr.setRotation=function($Lr){this._sprite&&(this._sprite.rotation=180*$Lr/Math.PI)},$Lr.updateDraw=function($Lr,$Li){$LA.ShowBones&&!$LA.ShowBones[this.name]||(this._sprite||(this._sprite=new $Lfr,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),$LAr.stage.addChild(this._sprite)),this._sprite.x=$Lr+this.resultMatrix.tx,this._sprite.y=$Li+this.resultMatrix.ty);var $Lt,$L_=0;for($L_=0,$Lt=this._children.length;$L_<$Lt;$L_++)this._children[$L_].updateDraw($Lr,$Li)},$Lr.addChild=function($Lr){this._children.push($Lr),$Lr.parentBone=this},$Lr.findBone=function($Lr){if(this.name==$Lr)return this;var $Li,$Lt,$L_=0;for($L_=0,$Li=this._children.length;$L_<$Li;$L_++)if($Lt=this._children[$L_].findBone($Lr))return $Lt;return null},$Lr.localToWorld=function($Lr){var $Li=$Lr[0],$Lt=$Lr[1];$Lr[0]=$Li*this.resultMatrix.a+$Lt*this.resultMatrix.c+this.resultMatrix.tx,$Lr[1]=$Li*this.resultMatrix.b+$Lt*this.resultMatrix.d+this.resultMatrix.ty},$LA.ShowBones={},$LA}()),$LFr=function(){function $Lc(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}$L_($Lc,"laya.ani.bone.BoneSlot");var $Lr=$Lc.prototype;return $Lr.showSlotData=function($Lr,$Li){void 0===$Li&&($Li=!0),this.currSlotData=$Lr,$Li&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},$Lr.showDisplayByName=function($Lr){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName($Lr))},$Lr.replaceDisplayByName=function($Lr,$Li){if(this.currSlotData){var $Lt;$Lt=this.currSlotData.getDisplayByName($Lr);var $L_;$L_=this.currSlotData.getDisplayByName($Li),this.replaceDisplayByIndex($Lt,$L_)}},$Lr.replaceDisplayByIndex=function($Lr,$Li){this.currSlotData&&(this._replaceDic[$Lr]=$Li,this.displayIndex==$Lr&&this.showDisplayByIndex($Lr))},$Lr.showDisplayByIndex=function($Lr){if(null!=this._replaceDic[$Lr]&&($Lr=this._replaceDic[$Lr]),this.currSlotData&&-1<$Lr&&$Lr<this.currSlotData.displayArr.length){if(this.displayIndex=$Lr,this.currDisplayData=this.currSlotData.displayArr[$Lr],this.currDisplayData){var $Li=this.currDisplayData.name;this.currTexture=this.templet.getTexture($Li),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!$LB.isConchApp||$LB.isConchApp&&"0.9.15"<$Lfr.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},$Lr.replaceSkin=function($Lr){this._diyTexture=$Lr,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},$Lr.setParentMatrix=function($Lr){this._parentMatrix=$Lr},$Lr.draw=function($Lr,$Li,$Lt,$L_){if(void 0===$Lt&&($Lt=!1),void 0===$L_&&($L_=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var $LA,$Lf=this.currTexture;switch(this._diyTexture&&($Lf=this._diyTexture),this.currDisplayData.type){case 0:if($Lr){var $LE=this.getDisplayMatrix();if(this._parentMatrix){var $LG=!1;if($LE){var $LN;if($Ler.mul($LE,this._parentMatrix,$Ler.TEMP),$LN=$Lt?(null==this._resultMatrix&&(this._resultMatrix=new $Ler),this._resultMatrix):new $Ler,!$LB.isWebGL&&this.currDisplayData.uvs||$LB.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var $Lp=$Lc._tempMatrix;$Lp.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($Lp.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($LG=!0,$Lp.rotate(-Math.PI/2)),$Ler.mul($Lp,$Ler.TEMP,$LN)}else $Ler.TEMP.copyTo($LN);$LG?$Lr.drawTexture($Lf,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,$LN):$Lr.drawTexture($Lf,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,$LN)}}}break;case 1:if(null==($LA=$Lt?(null==this._skinSprite&&(this._skinSprite=$Lc.createSkinMesh()),this._skinSprite):$Lc.createSkinMesh()))return;var $Lg;if(null==this.currDisplayData.bones){var $LR,$LX=this.currDisplayData.weights;this.deformData&&($LX=this.deformData),$LR=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$Lw.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$Lw.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=$LX;this.currDisplayData.triangles.length;$Lg=this.currDisplayData.triangles,$LA.init2($Lf,null,$Lg,this._mVerticleArr,$LR);var $Lv,$LO=this.getDisplayMatrix();if(this._parentMatrix)if($LO)$Ler.mul($LO,this._parentMatrix,$Ler.TEMP),$Lv=$Lt?(null==this._resultMatrix&&(this._resultMatrix=new $Ler),this._resultMatrix):new $Ler,$Ler.TEMP.copyTo($Lv),$LA.transform=$Lv}else this.skinMesh($Li,$LA,$L_);$Lr.drawSkin($LA);break;case 2:if(null==($LA=$Lt?(null==this._skinSprite&&(this._skinSprite=$Lc.createSkinMesh()),this._skinSprite):$Lc.createSkinMesh()))return;this.skinMesh($Li,$LA,$L_),$Lr.drawSkin($LA)}}},$Lr.skinMesh=function($Lr,$Li,$Lt){var $L_,$LA=this.currTexture,$Lf=this.currDisplayData.bones;$L_=this._diyTexture?($LA=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$Lw.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$Lw.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var $LE,$LG,$LN=this.currDisplayData.weights,$Lp=this.currDisplayData.triangles,$Lg=0,$LR=0,$LX=0,$Lv=NaN,$LO=NaN,$Lc=0,$LB=0,$Ly=[],$LC=0,$Ln=0;if(this.deformData&&0<this.deformData.length){var $La=0;for($LC=0,$Ln=$Lf.length;$LC<$Ln;){for($LX=$Lf[$LC++]+$LC,$LR=$Lg=0;$LC<$LX;$LC++)$LG=$Lr[$Lf[$LC]],$Lv=$LN[$Lc]+this.deformData[$La++],$LO=$LN[$Lc+1]+this.deformData[$La++],$LB=$LN[$Lc+2],$Lg+=($Lv*$LG.a+$LO*$LG.c+$LG.tx)*$LB,$LR+=($Lv*$LG.b+$LO*$LG.d+$LG.ty)*$LB,$Lc+=3;$Ly.push($Lg,$LR)}}else for($LC=0,$Ln=$Lf.length;$LC<$Ln;){for($LX=$Lf[$LC++]+$LC,$LR=$Lg=0;$LC<$LX;$LC++)$LG=$Lr[$Lf[$LC]],$Lv=$LN[$Lc],$LO=$LN[$Lc+1],$LB=$LN[$Lc+2],$Lg+=($Lv*$LG.a+$LO*$LG.c+$LG.tx)*$LB,$LR+=($Lv*$LG.b+$LO*$LG.d+$LG.ty)*$LB,$Lc+=3;$Ly.push($Lg,$LR)}this._mVerticleArr=$Ly,$LE=$Lp,$Li.init2($LA,null,$LE,this._mVerticleArr,$L_)},$Lr.drawBonePoint=function($Lr){$Lr&&this._parentMatrix&&$Lr.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},$Lr.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},$Lr.getMatrix=function(){return this._resultMatrix},$Lr.copy=function(){var $Lr=new $Lc;return $Lr.type="copy",$Lr.name=this.name,$Lr.attachmentName=this.attachmentName,$Lr.srcDisplayIndex=this.srcDisplayIndex,$Lr.parent=this.parent,$Lr.displayIndex=this.displayIndex,$Lr.templet=this.templet,$Lr.currSlotData=this.currSlotData,$Lr.currTexture=this.currTexture,$Lr.currDisplayData=this.currDisplayData,$Lr},$Lc.createSkinMesh=function(){return $LB.isWebGL||$LB.isConchApp?$Lv.skinAniSprite():($LB.isWebGL,null)},$Lt($Lc,["_tempMatrix",function(){return this._tempMatrix=new $Ler}]),$Lc}(),$Lbr=function(){function $Lr(){this.skinName=null,this.deformSlotDataList=[]}return $L_($Lr,"laya.ani.bone.DeformAniData"),$Lr}(),$LVr=function(){function $Lr(){this.deformSlotDisplayList=[]}return $L_($Lr,"laya.ani.bone.DeformSlotData"),$Lr}(),$Lhr=function(){function $Lr(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}$L_($Lr,"laya.ani.bone.DeformSlotDisplayData");var $Li=$Lr.prototype;return $Li.binarySearch1=function($Lr,$Li){var $Lt=0,$L_=$Lr.length-2;if(0==$L_)return 1;for(var $LA=$L_>>>1;;){if($Lr[Math.floor($LA+1)]<=$Li?$Lt=$LA+1:$L_=$LA,$Lt==$L_)return $Lt+1;$LA=$Lt+$L_>>>1}return 0},$Li.apply=function($Lr,$Li,$Lt){if(void 0===$Lt&&($Lt=1),$Lr+=.05,!(this.timeList.length<=0)){var $L_=0;if(!($Lr<this.timeList[0])){var $LA=this.vectices[0].length,$Lf=[],$LE=this.binarySearch1(this.timeList,$Lr);if(this.frameIndex=$LE,$Lr>=this.timeList[this.timeList.length-1]){var $LG=this.vectices[this.vectices.length-1];if($Lt<1)for($L_=0;$L_<$LA;$L_++)$Lf[$L_]+=($LG[$L_]-$Lf[$L_])*$Lt;else for($L_=0;$L_<$LA;$L_++)$Lf[$L_]=$LG[$L_];this.deformData=$Lf}else{this.tweenKeyList[this.frameIndex];var $LN=this.vectices[this.frameIndex-1],$Lp=this.vectices[this.frameIndex],$Lg=this.timeList[this.frameIndex-1],$LR=this.timeList[this.frameIndex];$Lt=this.tweenKeyList[$LE-1]?($Lr-$Lg)/($LR-$Lg):0;var $LX=NaN;for($L_=0;$L_<$LA;$L_++)$LX=$LN[$L_],$Lf[$L_]=$LX+($Lp[$L_]-$LX)*$Lt;this.deformData=$Lf}}}},$Lr}(),$LPr=function(){function $Lr(){this.time=NaN,this.drawOrder=[]}return $L_($Lr,"laya.ani.bone.DrawOrderData"),$Lr}(),$Lqr=function(){function $Lr(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return $L_($Lr,"laya.ani.bone.EventData"),$Lr}(),$LC=function(){function $L_r($Lr,$Li){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=$Lr,this._targetBone=$Li[$Lr.targetBoneIndex],this.isSpine=$Lr.isSpine,null==this._bones&&(this._bones=[]);for(var $Lt=this._bones.length=0,$L_=$Lr.boneIndexs.length;$Lt<$L_;$Lt++)this._bones.push($Li[$Lr.boneIndexs[$Lt]]);this.name=$Lr.name,this.mix=$Lr.mix,this.bendDirection=$Lr.bendDirection}$L_($L_r,"laya.ani.bone.IkConstraint");var $Lr=$L_r.prototype;return $Lr.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},$Lr._applyIk1=function($Lr,$Li,$Lt,$L_){var $LA=$Lr.parentBone,$Lf=1/($LA.resultMatrix.a*$LA.resultMatrix.d-$LA.resultMatrix.b*$LA.resultMatrix.c),$LE=$Li-$LA.resultMatrix.tx,$LG=$Lt-$LA.resultMatrix.ty,$LN=($LE*$LA.resultMatrix.d-$LG*$LA.resultMatrix.c)*$Lf-$Lr.transform.x,$Lp=($LG*$LA.resultMatrix.a-$LE*$LA.resultMatrix.b)*$Lf-$Lr.transform.y,$Lg=Math.atan2($Lp,$LN)*$L_r.radDeg-0-$Lr.transform.skX;$Lr.transform.scX<0&&($Lg+=180),180<$Lg?$Lg-=360:$Lg<-180&&($Lg+=360),$Lr.transform.skX=$Lr.transform.skY=$Lr.transform.skX+$Lg*$L_,$Lr.update()},$Lr.updatePos=function($Lr,$Li){this._sp&&this._sp.pos($Lr,$Li)},$Lr._applyIk2=function($Lr,$Li,$Lt,$L_,$LA,$Lf){if(0!=$Lf){var $LE=$Lr.resultTransform.x,$LG=$Lr.resultTransform.y,$LN=$Lr.transform.scX,$Lp=$Lr.transform.scY,$Lg=$Li.transform.scX,$LR=0,$LX=0,$Lv=0;$Lv=$LN<0?($LN=-$LN,$LR=180,-1):($LR=0,1),$Lp<0&&($Lp=-$Lp,$Lv=-$Lv),$LX=$Lg<0?($Lg=-$Lg,180):0;var $LO=$Li.resultTransform.x,$Lc=NaN,$LB=NaN,$Ly=NaN,$LC=$Lr.resultMatrix.a,$Ln=$Lr.resultMatrix.c,$La=$Lr.resultMatrix.b,$LD=$Lr.resultMatrix.d,$Lu=Math.abs($LN-$Lp)<=1e-4;$Ly=$Lu?($LB=$LC*$LO+$Ln*($Lc=$Li.resultTransform.y)+$Lr.resultMatrix.tx,$La*$LO+$LD*$Lc+$Lr.resultMatrix.ty):($Lc=0,$LB=$LC*$LO+$Lr.resultMatrix.tx,$La*$LO+$Lr.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new $Lfr,$LAr.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($Lt,$L_,15,"#ffff00"),this._sp.graphics.drawCircle($LB,$Ly,15,"#ff00ff")),$Lr.setRotation(Math.atan2($Ly-$Lr.resultMatrix.ty,$LB-$Lr.resultMatrix.tx));var $Lw=$Lr.parentBone;$LC=$Lw.resultMatrix.a,$Ln=$Lw.resultMatrix.c,$La=$Lw.resultMatrix.b;var $LH=1/($LC*($LD=$Lw.resultMatrix.d)-$Ln*$La),$Ls=$Lt-$Lw.resultMatrix.tx,$Ld=$L_-$Lw.resultMatrix.ty,$Ll=($Ls*$LD-$Ld*$Ln)*$LH-$LE,$LU=($Ld*$LC-$Ls*$La)*$LH-$LG,$Lk=(($Ls=$LB-$Lw.resultMatrix.tx)*$LD-($Ld=$Ly-$Lw.resultMatrix.ty)*$Ln)*$LH-$LE,$Le=($Ld*$LC-$Ls*$La)*$LH-$LG,$LL=Math.sqrt($Lk*$Lk+$Le*$Le),$LQ=$Li.length*$Lg,$LF=NaN,$Lb=NaN;if($Lu){var $LV=($Ll*$Ll+$LU*$LU-$LL*$LL-($LQ*=$LN)*$LQ)/(2*$LL*$LQ);$LV<-1?$LV=-1:1<$LV&&($LV=1),$Lb=Math.acos($LV)*$LA,$LC=$LL+$LQ*$LV,$Ln=$LQ*Math.sin($Lb),$LF=Math.atan2($LU*$LC-$Ll*$Ln,$Ll*$LC+$LU*$Ln)}else{var $Lh=($LC=$LN*$LQ)*$LC,$LP=($Ln=$Lp*$LQ)*$Ln,$Lq=$Ll*$Ll+$LU*$LU,$Lm=Math.atan2($LU,$Ll),$LT=-2*$LP*$LL,$Lx=$LP-$Lh;if(0<($LD=$LT*$LT-4*$Lx*($La=$LP*$LL*$LL+$Lh*$Lq-$Lh*$LP))){var $L$=Math.sqrt($LD);$LT<0&&($L$=-$L$);var $Lo=($L$=-($LT+$L$)/2)/$Lx,$LI=$La/$L$,$Lz=Math.abs($Lo)<Math.abs($LI)?$Lo:$LI;$Lz*$Lz<=$Lq&&($Ld=Math.sqrt($Lq-$Lz*$Lz)*$LA,$LF=$Lm-Math.atan2($Ld,$Lz),$Lb=Math.atan2($Ld/$Lp,($Lz-$LL)/$LN))}var $LJ=0,$LZ=Number.MAX_VALUE,$LW=0,$LM=0,$LK=0,$LS=0,$LY=0,$Lj=0;$LS<($LD=($Ls=$LL+$LC)*$Ls)&&($LK=0,$LS=$LD,$LY=$Ls),($LD=($Ls=$LL-$LC)*$Ls)<$LZ&&($LJ=Math.PI,$LZ=$LD,$LW=$Ls);var $Lrr=Math.acos(-$LC*$LL/($Lh-$LP));($LD=($Ls=$LC*Math.cos($Lrr)+$LL)*$Ls+($Ld=$Ln*Math.sin($Lrr))*$Ld)<$LZ&&($LJ=$Lrr,$LZ=$LD,$LW=$Ls,$LM=$Ld),$LS<$LD&&($LK=$Lrr,$LS=$LD,$LY=$Ls,$Lj=$Ld),$Lb=$Lq<=($LZ+$LS)/2?($LF=$Lm-Math.atan2($LM*$LA,$LW),$LJ*$LA):($LF=$Lm-Math.atan2($Lj*$LA,$LY),$LK*$LA)}var $Lir=Math.atan2($Lc,$LO)*$Lv,$Ltr=$Lr.resultTransform.skX;180<($LF=($LF-$Lir)*$L_r.radDeg+$LR-$Ltr)?$LF-=360:$LF<-180&&($LF+=360),$Lr.resultTransform.x=$LE,$Lr.resultTransform.y=$LG,$Lr.resultTransform.skX=$Lr.resultTransform.skY=$Ltr+$LF*$Lf,$Ltr=$Li.resultTransform.skX,180<($Lb=(($Lb+$Lir)*$L_r.radDeg-0)*$Lv+$LX-($Ltr%=360))?$Lb-=360:$Lb<-180&&($Lb+=360),$Li.resultTransform.x=$LO,$Li.resultTransform.y=$Lc,$Li.resultTransform.skX=$Li.resultTransform.skY=$Li.resultTransform.skY+$Lb*$Lf,$Lr.update()}},$Lr._applyIk3=function($Lr,$Li,$Lt,$L_,$LA,$Lf){if(0!=$Lf){var $LE,$LG,$LN=$Li.resultMatrix.a*$Li.length,$Lp=$Li.resultMatrix.b*$Li.length,$Lg=$LN*$LN+$Lp*$Lp,$LR=Math.sqrt($Lg),$LX=$Lr.resultMatrix.tx,$Lv=$Lr.resultMatrix.ty,$LO=$Li.resultMatrix.tx,$Lc=$Li.resultMatrix.ty,$LB=$LO-$LX,$Ly=$Lc-$Lv,$LC=$LB*$LB+$Ly*$Ly,$Ln=Math.sqrt($LC),$La=($LB=$Lt-$Lr.resultMatrix.tx)*$LB+($Ly=$L_-$Lr.resultMatrix.ty)*$Ly,$LD=Math.sqrt($La);if($LR+$Ln<=$LD||$LD+$LR<=$Ln||$LD+$Ln<=$LR){var $Lu=NaN;$LO=$LX+($Lu=$LR+$Ln<=$LD?1:-1)*($Lt-$LX)*$Ln/$LD,$Lc=$Lv+$Lu*($L_-$Lv)*$Ln/$LD}else{var $Lw=($LC-$Lg+$La)/(2*$La),$LH=Math.sqrt($LC-$Lw*$Lw*$La)/$LD,$Ls=$LX+$LB*$Lw,$Ld=$Lv+$Ly*$Lw,$Ll=-$Ly*$LH,$LU=$LB*$LH;$Lc=0<$LA?($LO=$Ls-$Ll,$Ld-$LU):($LO=$Ls+$Ll,$Ld+$LU)}$LE=$LO,$LG=$Lc,this.isDebug&&(this._sp||(this._sp=new $Lfr,$LAr.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($LX,$Lv,15,"#ff00ff"),this._sp.graphics.drawCircle($Lt,$L_,15,"#ffff00"),this._sp.graphics.drawCircle($LE,$LG,15,"#ff00ff"));var $Lk,$Le;$Lk=Math.atan2($LG-$Lr.resultMatrix.ty,$LE-$Lr.resultMatrix.tx),$Lr.setRotation($Lk),($Le=$L_r._tempMatrix).identity(),$Le.rotate($Lk),$Le.scale($Lr.resultMatrix.getScaleX(),$Lr.resultMatrix.getScaleY()),$Le.translate($Lr.resultMatrix.tx,$Lr.resultMatrix.ty),$Le.copyTo($Lr.resultMatrix),$Lr.updateChild();var $LL,$LQ;$LL=Math.atan2($L_-$LG,$Lt-$LE),$Li.setRotation($LL),($LQ=$L_r._tempMatrix).identity(),$LQ.rotate($LL),$LQ.scale($Li.resultMatrix.getScaleX(),$Li.resultMatrix.getScaleY()),$LQ.translate($LE,$LG),$Le.copyTo($Li.resultMatrix),$Li.updateChild()}},$Lt($L_r,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new $Ler}]),$L_r}(),$Lmr=function(){function $Lr(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return $L_($Lr,"laya.ani.bone.IkConstraintData"),$Lr}(),$LD=function(){function $LQ($Lr,$Li){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=$Lr,this.position=$Lr.position,this.spacing=$Lr.spacing,this.rotateMix=$Lr.rotateMix,this.translateMix=$Lr.translateMix,this.bones=[];for(var $Lt=this.data.bones,$L_=0,$LA=$Lt.length;$L_<$LA;$L_++)this.bones.push($Li[$Lt[$L_]])}$L_($LQ,"laya.ani.bone.PathConstraint");var $Lr=$LQ.prototype;return $Lr.apply=function($Lr,$Li){if(this.target){var $Lt=this.translateMix,$L_=this.translateMix,$LA=0<$L_,$Lf=this.data.spacingMode,$LE="length"==$Lf,$LG=this.data.rotateMode,$LN="tangent"==$LG,$Lp="chainScale"==$LG,$Lg=[],$LR=this.bones.length,$LX=$LN?$LR:$LR+1,$Lv=[];(this._spaces=$Lv)[0]=this.position;var $LO=this.spacing;if($Lp||$LE)for(var $Lc=0,$LB=$LX-1;$Lc<$LB;){var $Ly=this.bones[$Lc],$LC=$Ly.length,$Ln=$LC*$Ly.resultMatrix.a,$La=$LC*$Ly.resultMatrix.b;$LC=Math.sqrt($Ln*$Ln+$La*$La),$Lp&&($Lg[$Lc]=$LC),$Lv[++$Lc]=$LE?Math.max(0,$LC+$LO):$LO}else for($Lc=1;$Lc<$LX;$Lc++)$Lv[$Lc]=$LO;var $LD=this.computeWorldPositions(this.target,$Lr,$Li,$LX,$LN,"percent"==this.data.positionMode,"percent"==$Lf);if(this._debugKey){for($Lc=0;$Lc<$LD.length;$Lc++)$Li.drawCircle($LD[$Lc++],$LD[$Lc++],5,"#00ff00");var $Lu=[];for($Lc=0;$Lc<$LD.length;$Lc++)$Lu.push($LD[$Lc++],$LD[$Lc++]);$Li.drawLines(0,0,$Lu,"#ff0000")}var $Lw=$LD[0],$LH=$LD[1],$Ls=this.data.offsetRotation,$Ld="chain"==$LG&&0==$Ls,$Ll=NaN;for($Lc=0,$Ll=3;$Lc<$LR;$Lc++,$Ll+=3){($Ly=this.bones[$Lc]).resultMatrix.tx+=($Lw-$Ly.resultMatrix.tx)*$Lt,$Ly.resultMatrix.ty+=($LH-$Ly.resultMatrix.ty)*$Lt;var $LU=($Ln=$LD[$Ll])-$Lw,$Lk=($La=$LD[$Ll+1])-$LH;if($Lp&&0!=($LC=$Lg[$Lc])){var $Le=(Math.sqrt($LU*$LU+$Lk*$Lk)/$LC-1)*$L_+1;$Ly.resultMatrix.a*=$Le,$Ly.resultMatrix.c*=$Le}if($Lw=$Ln,$LH=$La,$LA){var $LL=$Ly.resultMatrix.a,$LQ=$Ly.resultMatrix.c,$LF=$Ly.resultMatrix.b,$Lb=$Ly.resultMatrix.d,$LV=NaN,$Lh=NaN,$LP=NaN;$LV=$LN?$LD[$Ll-1]:0==$Lv[$Lc+1]?$LD[$Ll+2]:Math.atan2($Lk,$LU),$LV-=Math.atan2($LF,$LL)-$Ls/180*Math.PI,$Ld&&($Lh=Math.cos($LV),$LP=Math.sin($LV),$Lw+=(($LC=$Ly.length)*($Lh*$LL-$LP*$LF)-$LU)*$L_,$LH+=($LC*($LP*$LL+$Lh*$LF)-$Lk)*$L_),$LV>Math.PI?$LV-=2*Math.PI:$LV<-Math.PI&&($LV+=2*Math.PI),$LV*=$L_,$Lh=Math.cos($LV),$LP=Math.sin($LV),$Ly.resultMatrix.a=$Lh*$LL-$LP*$LF,$Ly.resultMatrix.c=$Lh*$LQ-$LP*$Lb,$Ly.resultMatrix.b=$LP*$LL+$Lh*$LF,$Ly.resultMatrix.d=$LP*$LQ+$Lh*$Lb}}}},$Lr.computeWorldVertices2=function($Lr,$Li,$Lt,$L_,$LA,$Lf){var $LE,$LG,$LN=$Lr.currDisplayData.bones,$Lp=$Lr.currDisplayData.weights,$Lg=$Lr.currDisplayData.triangles,$LR=0,$LX=0,$Lv=0,$LO=0,$Lc=0,$LB=0,$Ly=0,$LC=0,$Ln=0,$La=0,$LD=0;if(null!=$LN){for($LR=0;$LR<$Lt;$LR+=2)$LX+=($LO=$LN[$LX])+1,$Lv+=$LO;var $Lu=$Li;for($Lc=$Lf,$LB=3*$Lv;$Lc<$L_;$Lc+=2){for($LC=$Ly=0,$LO=$LN[$LX++],$LO+=$LX;$LX<$LO;$LX++,$LB+=3){$LE=$Lu[$LN[$LX]].resultMatrix,$Ln=$Lp[$LB],$La=$Lp[$LB+1];var $Lw=$Lp[$LB+2];$Ly+=($Ln*$LE.a+$La*$LE.c+$LE.tx)*$Lw,$LC+=($Ln*$LE.b+$La*$LE.d+$LE.ty)*$Lw}$LA[$Lc]=$Ly,$LA[$Lc+1]=$LC}}else{var $LH,$Ls;if($Lg||($Lg=$Lp),$Lr.deformData&&($Lg=$Lr.deformData),$LH=$Lr.parent,$Li)for($LD=$Li.length,$LR=0;$LR<$LD;$LR++)if($Li[$LR].name==$LH){$LG=$Li[$LR];break}$LG&&($Ls=$LG.resultMatrix),$Ls||($Ls=$LQ._tempMt);var $Ld=$Ls.tx,$Ll=$Ls.ty,$LU=$Ls.a,$Lk=$Ls.b,$Le=$Ls.c,$LL=$Ls.d;for($LG&&($LL*=$LG.d),$LX=$Lt,$Lc=$Lf;$Lc<$L_;$LX+=2,$Lc+=2)$Ln=$Lg[$LX],$La=$Lg[$LX+1],$LA[$Lc]=$Ln*$LU+$La*$Lk+$Ld,$LA[$Lc+1]=-($Ln*$Le+$La*$LL+$Ll)}},$Lr.computeWorldPositions=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE){$Lr.currDisplayData.bones,$Lr.currDisplayData.weights,$Lr.currDisplayData.triangles;var $LG=[],$LN=0,$Lp=$Lr.currDisplayData.verLen,$Lg=this.position,$LR=this._spaces,$LX=[],$Lv=[],$LO=$Lp/6,$Lc=-1,$LB=NaN,$Ly=0,$LC=0,$Ln=NaN,$La=NaN,$LD=NaN,$Lu=NaN;if($LO--,$Lp-=4,this.computeWorldVertices2($Lr,$Li,2,$Lp,$LG,0),this._debugKey)for($LN=0;$LN<$LG.length;)$Lt.drawCircle($LG[$LN++],$LG[$LN++],10,"#ff0000");$LX=$LG,this._curves.length=$LO;var $Lw=this._curves,$LH=$LX[$LB=0],$Ls=$LX[1],$Ld=0,$Ll=0,$LU=0,$Lk=0,$Le=0,$LL=0,$LQ=NaN,$LF=NaN,$Lb=NaN,$LV=NaN,$Lh=NaN,$LP=NaN,$Lq=NaN,$Lm=NaN,$LT=0;for($LN=0,$LT=2;$LN<$LO;$LN++,$LT+=6)$Ld=$LX[$LT],$Ll=$LX[$LT+1],$LU=$LX[$LT+2],$Lk=$LX[$LT+3],$Lh=2*($LQ=.1875*($LH-2*$Ld+$LU))+($Lb=.09375*(3*($Ld-$LU)-$LH+($Le=$LX[$LT+4]))),$LP=2*($LF=.1875*($Ls-2*$Ll+$Lk))+($LV=.09375*(3*($Ll-$Lk)-$Ls+($LL=$LX[$LT+5]))),$Lq=.75*($Ld-$LH)+$LQ+.16666667*$Lb,$Lm=.75*($Ll-$Ls)+$LF+.16666667*$LV,$LB+=Math.sqrt($Lq*$Lq+$Lm*$Lm),$Lq+=$Lh,$Lm+=$LP,$Lh+=$Lb,$LP+=$LV,$LB+=Math.sqrt($Lq*$Lq+$Lm*$Lm),$Lq+=$Lh,$Lm+=$LP,$LB+=Math.sqrt($Lq*$Lq+$Lm*$Lm),$Lq+=$Lh+$Lb,$Lm+=$LP+$LV,$LB+=Math.sqrt($Lq*$Lq+$Lm*$Lm),$Lw[$LN]=$LB,$LH=$Le,$Ls=$LL;if($Lf&&($Lg*=$LB),$LE)for($LN=0;$LN<$L_;$LN++)$LR[$LN]*=$LB;var $Lx=this._segments,$L$=0,$Lo=0;for($Lo=$LC=$Ly=$LN=0;$LN<$L_;$LN++,$Ly+=3)if(($Ln=$Lg+=$La=$LR[$LN])<0)this.addBeforePosition($Ln,$LX,0,$Lv,$Ly);else if($LB<$Ln)this.addAfterPosition($Ln-$LB,$LX,$Lp-4,$Lv,$Ly);else{for(;;$LC++)if(!(($Lu=$Lw[$LC])<$Ln)){0==$LC?$Ln/=$Lu:$Ln=($Ln-($LD=$Lw[$LC-1]))/($Lu-$LD);break}if($LC!=$Lc){var $LI=6*($Lc=$LC);for($LH=$LX[$LI],$Ls=$LX[$LI+1],$Ld=$LX[$LI+2],$Ll=$LX[$LI+3],$LU=$LX[$LI+4],$Lk=$LX[$LI+5],$Lh=2*($LQ=.03*($LH-2*$Ld+$LU))+($Lb=.006*(3*($Ld-$LU)-$LH+($Le=$LX[$LI+6]))),$LP=2*($LF=.03*($Ls-2*$Ll+$Lk))+($LV=.006*(3*($Ll-$Lk)-$Ls+($LL=$LX[$LI+7]))),$Lq=.3*($Ld-$LH)+$LQ+.16666667*$Lb,$Lm=.3*($Ll-$Ls)+$LF+.16666667*$LV,$L$=Math.sqrt($Lq*$Lq+$Lm*$Lm),$Lx[0]=$L$,$LI=1;$LI<8;$LI++)$Lq+=$Lh,$Lm+=$LP,$Lh+=$Lb,$LP+=$LV,$L$+=Math.sqrt($Lq*$Lq+$Lm*$Lm),$Lx[$LI]=$L$;$Lq+=$Lh,$Lm+=$LP,$L$+=Math.sqrt($Lq*$Lq+$Lm*$Lm),$Lx[8]=$L$,$Lq+=$Lh+$Lb,$Lm+=$LP+$LV,$L$+=Math.sqrt($Lq*$Lq+$Lm*$Lm),$Lx[9]=$L$,$Lo=0}for($Ln*=$L$;;$Lo++)if(!(($Lu=$Lx[$Lo])<$Ln)){0==$Lo?$Ln/=$Lu:$Ln=$Lo+($Ln-($LD=$Lx[$Lo-1]))/($Lu-$LD);break}this.addCurvePosition(.1*$Ln,$LH,$Ls,$Ld,$Ll,$LU,$Lk,$Le,$LL,$Lv,$Ly,$LA||0<$LN&&0==$La)}return $Lv},$Lr.addBeforePosition=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Li[$Lt],$LE=$Li[$Lt+1],$LG=$Li[$Lt+2]-$Lf,$LN=$Li[$Lt+3]-$LE,$Lp=Math.atan2($LN,$LG);$L_[$LA]=$Lf+$Lr*Math.cos($Lp),$L_[$LA+1]=$LE+$Lr*Math.sin($Lp),$L_[$LA+2]=$Lp},$Lr.addAfterPosition=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Li[$Lt+2],$LE=$Li[$Lt+3],$LG=$Lf-$Li[$Lt],$LN=$LE-$Li[$Lt+1],$Lp=Math.atan2($LN,$LG);$L_[$LA]=$Lf+$Lr*Math.cos($Lp),$L_[$LA+1]=$LE+$Lr*Math.sin($Lp),$L_[$LA+2]=$Lp},$Lr.addCurvePosition=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg,$LR){0==$Lr&&($Lr=1e-4);var $LX=$Lr*$Lr,$Lv=$LX*$Lr,$LO=1-$Lr,$Lc=$LO*$LO,$LB=$Lc*$LO,$Ly=$LO*$Lr,$LC=3*$Ly,$Ln=$LO*$LC,$La=$LC*$Lr,$LD=$Li*$LB+$L_*$Ln+$Lf*$La+$LG*$Lv,$Lu=$Lt*$LB+$LA*$Ln+$LE*$La+$LN*$Lv;$Lp[$Lg]=$LD,$Lp[$Lg+1]=$Lu,$Lp[$Lg+2]=$LR?Math.atan2($Lu-($Lt*$Lc+$LA*$Ly*2+$LE*$LX),$LD-($Li*$Lc+$L_*$Ly*2+$Lf*$LX)):0},$LQ.NONE=-1,$LQ.BEFORE=-2,$LQ.AFTER=-3,$Lt($LQ,["_tempMt",function(){return this._tempMt=new $Ler}]),$LQ}(),$LTr=function(){function $Lr(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return $L_($Lr,"laya.ani.bone.PathConstraintData"),$Lr}(),$Lxr=function(){function $Lr(){this.name=null,this.slotArr=[]}return $L_($Lr,"laya.ani.bone.SkinData"),$Lr}(),$L$r=function(){function $Lr(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}$L_($Lr,"laya.ani.bone.SkinSlotDisplayData");var $Li=$Lr.prototype;return $Li.createTexture=function($Lr){return this.texture||(this.texture=new $LLr($Lr.bitmap,this.uvs),$Lr.bitmap.alphaTexture&&(this.texture.alphaTexture=new $LLr($Lr.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=$Lr.height,this.texture.height=$Lr.width,this.texture.offsetX=-$Lr.offsetX,this.texture.offsetY=-$Lr.offsetY,this.texture.sourceWidth=$Lr.sourceHeight,this.texture.sourceHeight=$Lr.sourceWidth):(this.texture.width=$Lr.width,this.texture.height=$Lr.height,this.texture.offsetX=-$Lr.offsetX,this.texture.offsetY=-$Lr.offsetY,this.texture.sourceWidth=$Lr.sourceWidth,this.texture.sourceHeight=$Lr.sourceHeight),$LB.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},$Li.destory=function(){this.texture&&this.texture.destroy()},$Lr}(),$Lor=function(){function $Lr(){this.name=null,this.displayArr=[]}return $L_($Lr,"laya.ani.bone.SlotData"),$Lr.prototype.getDisplayByName=function($Lr){for(var $Li=0,$Lt=this.displayArr.length;$Li<$Lt;$Li++)if(this.displayArr[$Li].attachmentName==$Lr)return $Li;return-1},$Lr}(),$Lu=function(){function $Lr($Lr,$Li){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=$Lc(2,0),this._data=$Lr,null==this._bones&&(this._bones=[]),this.target=$Li[$Lr.targetIndex];var $Lt,$L_=0;for($L_=0,$Lt=$Lr.boneIndexs.length;$L_<$Lt;$L_++)this._bones.push($Li[$Lr.boneIndexs[$L_]]);this.rotateMix=$Lr.rotateMix,this.translateMix=$Lr.translateMix,this.scaleMix=$Lr.scaleMix,this.shearMix=$Lr.shearMix}return $L_($Lr,"laya.ani.bone.TfConstraint"),$Lr.prototype.apply=function(){for(var $Lr,$Li=this.target.resultMatrix.a,$Lt=this.target.resultMatrix.b,$L_=this.target.resultMatrix.c,$LA=this.target.resultMatrix.d,$Lf=0,$LE=this._bones.length;$Lf<$LE;$Lf++){if($Lr=this._bones[$Lf],0<this.rotateMix){var $LG=$Lr.resultMatrix.a,$LN=$Lr.resultMatrix.b,$Lp=$Lr.resultMatrix.c,$Lg=$Lr.resultMatrix.d,$LR=Math.atan2($L_,$Li)-Math.atan2($Lp,$LG)+this._data.offsetRotation*Math.PI/180;$LR>Math.PI?$LR-=2*Math.PI:$LR<-Math.PI&&($LR+=2*Math.PI),$LR*=this.rotateMix;var $LX=Math.cos($LR),$Lv=Math.sin($LR);$Lr.resultMatrix.a=$LX*$LG-$Lv*$Lp,$Lr.resultMatrix.b=$LX*$LN-$Lv*$Lg,$Lr.resultMatrix.c=$Lv*$LG+$LX*$Lp,$Lr.resultMatrix.d=$Lv*$LN+$LX*$Lg}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),$Lr.resultMatrix.tx+=(this._temp[0]-$Lr.resultMatrix.tx)*this.translateMix,$Lr.resultMatrix.ty+=(this._temp[1]-$Lr.resultMatrix.ty)*this.translateMix,$Lr.updateChild()),0<this.scaleMix){var $LO=Math.sqrt($Lr.resultMatrix.a*$Lr.resultMatrix.a+$Lr.resultMatrix.c*$Lr.resultMatrix.c),$Lc=Math.sqrt($Li*$Li+$L_*$L_),$LB=1e-5<$LO?($LO+($Lc-$LO+this._data.offsetScaleX)*this.scaleMix)/$LO:0;$Lr.resultMatrix.a*=$LB,$Lr.resultMatrix.c*=$LB,$LO=Math.sqrt($Lr.resultMatrix.b*$Lr.resultMatrix.b+$Lr.resultMatrix.d*$Lr.resultMatrix.d),$Lc=Math.sqrt($Lt*$Lt+$LA*$LA),$LB=1e-5<$LO?($LO+($Lc-$LO+this._data.offsetScaleY)*this.scaleMix)/$LO:0,$Lr.resultMatrix.b*=$LB,$Lr.resultMatrix.d*=$LB}if(0<this.shearMix){$LN=$Lr.resultMatrix.b,$Lg=$Lr.resultMatrix.d;var $Ly=Math.atan2($Lg,$LN);($LR=Math.atan2($LA,$Lt)-Math.atan2($L_,$Li)-($Ly-Math.atan2($Lr.resultMatrix.c,$Lr.resultMatrix.a)))>Math.PI?$LR-=2*Math.PI:$LR<-Math.PI&&($LR+=2*Math.PI),$LR=$Ly+($LR+this._data.offsetShearY*Math.PI/180)*this.shearMix,$LB=Math.sqrt($LN*$LN+$Lg*$Lg),$Lr.resultMatrix.b=Math.cos($LR)*$LB,$Lr.resultMatrix.d=Math.sin($LR)*$LB}}},$Lr}(),$LIr=function(){function $Lr(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return $L_($Lr,"laya.ani.bone.TfConstraintData"),$Lr}(),$Lzr=function(){function $Lr(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}$L_($Lr,"laya.ani.bone.Transform");var $Li=$Lr.prototype;return $Li.initData=function($Lr){null!=$Lr.x&&(this.x=$Lr.x),null!=$Lr.y&&(this.y=$Lr.y),null!=$Lr.skX&&(this.skX=$Lr.skX),null!=$Lr.skY&&(this.skY=$Lr.skY),null!=$Lr.scX&&(this.scX=$Lr.scX),null!=$Lr.scY&&(this.scY=$Lr.scY)},$Li.getMatrix=function(){var $Lr;return($Lr=this.mMatrix?this.mMatrix:this.mMatrix=new $Ler).identity(),$Lr.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew($Lr,this.skewX*Math.PI/180,this.skewY*Math.PI/180),$Lr.rotate(this.skX*Math.PI/180),$Lr.translate(this.x,this.y),$Lr},$Li.skew=function($Lr,$Li,$Lt){var $L_=Math.sin($Lt),$LA=Math.cos($Lt),$Lf=Math.sin($Li),$LE=Math.cos($Li);return $Lr.setTo($Lr.a*$LE-$Lr.b*$L_,$Lr.a*$Lf+$Lr.b*$LA,$Lr.c*$LE-$Lr.d*$L_,$Lr.c*$Lf+$Lr.d*$LA,$Lr.tx*$LE-$Lr.ty*$L_,$Lr.tx*$Lf+$Lr.ty*$LA),$Lr},$Lr}(),$Lw=function(){function $Lr(){}return $L_($Lr,"laya.ani.bone.UVTools"),$Lr.getRelativeUV=function($Lr,$Li,$Lt){var $L_=$Lr[0],$LA=$Lr[2]-$Lr[0],$Lf=$Lr[1],$LE=$Lr[5]-$Lr[1];$Lt||($Lt=[]),$Lt.length=$Li.length;var $LG,$LN=0;$LG=$Lt.length;var $Lp=1/$LA,$Lg=1/$LE;for($LN=0;$LN<$LG;$LN+=2)$Lt[$LN]=($Li[$LN]-$L_)*$Lp,$Lt[$LN+1]=($Li[$LN+1]-$Lf)*$Lg;return $Lt},$Lr.getAbsoluteUV=function($Lr,$Li,$Lt){if(0==$Lr[0]&&0==$Lr[1]&&1==$Lr[4]&&1==$Lr[5])return $Lt?($Ly.copyArray($Lt,$Li),$Lt):$Li;var $L_=$Lr[0],$LA=$Lr[2]-$Lr[0],$Lf=$Lr[1],$LE=$Lr[5]-$Lr[1];$Lt||($Lt=[]),$Lt.length=$Li.length;var $LG,$LN=0;for($LG=$Lt.length,$LN=0;$LN<$LG;$LN+=2)$Lt[$LN]=$Li[$LN]*$LA+$L_,$Lt[$LN+1]=$Li[$LN+1]*$LE+$Lf;return $Lt},$Lr}(),$LQ=function(){function $Lr(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return $L_($Lr,"laya.ani.KeyFramesContent"),$Lr}(),$LH=function(){function $Lg(){}return $L_($Lg,"laya.ani.math.BezierLerp"),$Lg.getBezierRate=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Lg._getBezierParamKey($Li,$Lt,$L_,$LA),$LE=100*$Lf+$Lr;if($Lg._bezierResultCache[$LE])return $Lg._bezierResultCache[$LE];var $LG,$LN=$Lg._getBezierPoints($Li,$Lt,$L_,$LA,$Lf),$Lp=0;for($LG=$LN.length,$Lp=0;$Lp<$LG;$Lp+=2)if($Lr<=$LN[$Lp])return $Lg._bezierResultCache[$LE]=$LN[$Lp+1],$LN[$Lp+1];return $Lg._bezierResultCache[$LE]=1},$Lg._getBezierParamKey=function($Lr,$Li,$Lt,$L_){return 100*(100*(100*(100*$Lr+$Li)+$Lt)+$L_)},$Lg._getBezierPoints=function($Lr,$Li,$Lt,$L_,$LA){return $Lg._bezierPointsCache[$LA]?$Lg._bezierPointsCache[$LA]:($Lf=[0,0,$Lr,$Li,$Lt,$L_,1,1],$LE=(new $LG).getBezierPoints($Lf,100,3),$Lg._bezierPointsCache[$LA]=$LE);var $Lf,$LE},$Lg._bezierResultCache={},$Lg._bezierPointsCache={},$Lg}(),$Ls=function($Lr){function $Li(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,$Li.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}$L_($Li,"laya.ani.AnimationPlayer",$LA);var $Lt=$Li.prototype;return $LAr.imps($Lt,{"laya.resource.IDestroy":!0}),$Lt._onTempletLoadedComputeFullKeyframeIndices=function($Lr,$Li,$Lt){this._templet===$Lt&&this._cachePlayRate===$Lr&&this._cacheFrameRate===$Li&&this._computeFullKeyframeIndices()},$Lt._computeFullKeyframeIndices=function(){for(var $Lr=this._fullFrames=[],$Li=this._templet,$Lt=this._cacheFrameRateInterval*this._cachePlayRate,$L_=0,$LA=$Li.getAnimationCount();$L_<$LA;$L_++){for(var $Lf=[],$LE=0,$LG=$Li.getAnimation($L_).nodes.length;$LE<$LG;$LE++){for(var $LN=$Li.getAnimation($L_).nodes[$LE],$Lp=Math.floor($LN.playTime/$Lt+.01),$Lg=new Uint16Array($Lp+1),$LR=-1,$LX=0,$Lv=$LN.keyFrame.length;$LX<$Lv;$LX++){var $LO=$LN.keyFrame[$LX],$Lc=$LO.startTime,$LB=$Lc+$LO.duration+$Lt;do{for(var $Ly=Math.floor($Lc/$Lt+.5),$LC=$LR+1;$LC<$Ly;$LC++)$Lg[$LC]=$LX;$Lg[$LR=$Ly]=$LX,$Lc+=$Lt}while($Lc<=$LB)}$Lf.push($Lg)}$Lr.push($Lf)}},$Lt._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},$Lt._calculatePlayDuration=function(){if(0!==this.state){var $Lr=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=$Lr),this._playEnd>$Lr&&(this._playEnd=$Lr),this._playDuration=this._playEnd-this._playStart}},$Lt._setPlayParams=function($Lr,$Li){this._currentTime=$Lr,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$Li+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$Li},$Lt._setPlayParamsWhenStop=function($Lr,$Li){this._currentTime=$Lr,this._currentKeyframeIndex=Math.max(Math.floor($Lr/$Li+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$Li,this._currentAnimationClipIndex=-1},$Lt._update=function($Lr){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var $Li=this._cacheFrameRateInterval*this._cachePlayRate,$Lt=0;this._startUpdateLoopCount!==$LO.loopCount&&($Lt=$Lr*this.playbackRate,this._elapsedPlaybackTime+=$Lt);var $L_=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=$L_)return this._setPlayParamsWhenStop($L_,$Li),void this.event("stopped");if($Lt+=this._currentTime,0<$L_)if($L_<=$Lt)do{if($Lt-=$L_,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($L_,$Li),this._stopWhenCircleFinish=!1,void this.event("stopped");$Lt<$L_&&(this._setPlayParams($Lt,$Li),this.event("complete"))}while($L_<=$Lt);else this._setPlayParams($Lt,$Li);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($L_,$Li),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},$Lt._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},$Lt.play=function($Lr,$Li,$Lt,$L_,$LA){if(void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=1),void 0===$Lt&&($Lt=2147483647),void 0===$L_&&($L_=0),void 0===$LA&&($LA=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if($Lt<0||$L_<0||$LA<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==$LA&&$LA<$L_)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=$Li,this._overallDuration=$Lt,this._playStart=$L_,this._playEnd=$LA,this._paused=!1,this._currentAnimationClipIndex=$Lr,this._currentKeyframeIndex=0,this._startUpdateLoopCount=$LO.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},$Lt.playByFrame=function($Lr,$Li,$Lt,$L_,$LA,$Lf){void 0===$Lr&&($Lr=0),void 0===$Li&&($Li=1),void 0===$Lt&&($Lt=2147483647),void 0===$L_&&($L_=0),void 0===$LA&&($LA=0),void 0===$Lf&&($Lf=30);var $LE=1e3/$Lf;this.play($Lr,$Li,$Lt,$L_*$LE,$LA*$LE)},$Lt.stop=function($Lr){void 0===$Lr&&($Lr=!0),$Lr?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},$Lf(0,$Lt,"playEnd",function(){return this._playEnd}),$Lf(0,$Lt,"templet",function(){return this._templet},function($Lr){0===!this.state&&this.stop(!0),this._templet!==$Lr&&((this._templet=$Lr).loaded?this._computeFullKeyframeIndices():$Lr.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),$Lf(0,$Lt,"playStart",function(){return this._playStart}),$Lf(0,$Lt,"playDuration",function(){return this._playDuration}),$Lf(0,$Lt,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),$Lf(0,$Lt,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),$Lf(0,$Lt,"overallDuration",function(){return this._overallDuration}),$Lf(0,$Lt,"currentFrameTime",function(){return this._currentFrameTime}),$Lf(0,$Lt,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),$Lf(0,$Lt,"currentPlayTime",function(){return this._currentTime+this._playStart}),$Lf(0,$Lt,"cachePlayRate",function(){return this._cachePlayRate},function($Lr){this._cachePlayRate!==$Lr&&(this._cachePlayRate=$Lr,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[$Lr,this._cacheFrameRate])))}),$Lf(0,$Lt,"cacheFrameRate",function(){return this._cacheFrameRate},function($Lr){this._cacheFrameRate!==$Lr&&(this._cacheFrameRate=$Lr,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,$Lr])))}),$Lf(0,$Lt,"currentTime",null,function($Lr){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if($Lr<this._playStart||$Lr>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=$LO.loopCount;var $Li=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=$Lr,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$Li),0),this._currentFrameTime=this._currentKeyframeIndex*$Li}}),$Lf(0,$Lt,"paused",function(){return this._paused},function($Lr){(this._paused=$Lr)&&this.event("paused")}),$Lf(0,$Lt,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),$Lf(0,$Lt,"destroyed",function(){return this._destroyed}),$Li}(),$LF=function($Lr){function $Li(){$Li.__super.call(this),$LB.isConchNode&&(this.drawSkin=function($Lr){$Lr.transform||($Lr.transform=$Ler.EMPTY),this._addCmd([$Lr]),this.setSkinMesh&&this.setSkinMesh($Lr._ps,$Lr.mVBData,$Lr.mEleNum,0,$Lr.mTexture,$Lr.transform)})}return $L_($Li,"laya.ani.GraphicsAni",$LE),$Li.prototype.drawSkin=function($Lr){var $Li=[$Lr];this._saveToCmd($LB._context._drawSkin,$Li)},$Li.create=function(){return $Li._caches.pop()||new $Li},$Li.recycle=function($Lr){$Lr.clear(),$Li._caches.push($Lr)},$Li._caches=[],$Li}(),$Lb=function($Lr){function $LC(){this._aniMap={},this.unfixedLastAniIndex=-1,$LC.__super.call(this),this._anis=new Array}$L_($LC,"laya.ani.AnimationTemplet",$Lg);var $Li=$LC.prototype;return $Li.parse=function($Lr){var $Li=new $Lkr($Lr);this._aniVersion=$Li.readUTFString(),$Ln.parse(this,$Li)},$Li._calculateKeyFrame=function($Lr,$Li,$Lt){var $L_=$Lr.keyFrame;$L_[$Li]=$L_[0];for(var $LA=0;$LA<$Li;$LA++){var $Lf=$L_[$LA];$Lf.nextData=0===$Lf.duration?$Lf.data:$L_[$LA+1].data}$L_.length--},$Li.onAsynLoaded=function($Lr,$Li,$Lt){var $L_=new $Lkr($Li);switch(this._aniVersion=$L_.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":$La.parse(this,$L_);break;default:$Ln.parse(this,$L_)}this._endLoaded()},$Li.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},$Li.getAnimationCount=function(){return this._anis.length},$Li.getAnimation=function($Lr){return this._anis[$Lr]},$Li.getAniDuration=function($Lr){return this._anis[$Lr].playTime},$Li.getNodes=function($Lr){return this._anis[$Lr].nodes},$Li.getNodeIndexWithName=function($Lr,$Li){return this._anis[$Lr].bone3DMap[$Li]},$Li.getNodeCount=function($Lr){return this._anis[$Lr].nodes.length},$Li.getTotalkeyframesLength=function($Lr){return this._anis[$Lr].totalKeyframeDatasLength},$Li.getPublicExtData=function(){return this._publicExtData},$Li.getAnimationDataWithCache=function($Lr,$Li,$Lt,$L_){var $LA=$Li[$Lt];if($LA){var $Lf=$LA[$Lr];return $Lf?$Lf[$L_]:null}return null},$Li.setAnimationDataWithCache=function($Lr,$Li,$Lt,$L_,$LA){var $Lf=$Li[$Lt]||($Li[$Lt]={});($Lf[$Lr]||($Lf[$Lr]=[]))[$L_]=$LA},$Li.getOriginalData=function($Lr,$Li,$Lt,$L_,$LA){for(var $Lf=this._anis[$Lr].nodes,$LE=0,$LG=0,$LN=$Lf.length,$Lp=0;$LG<$LN;$LG++){var $Lg,$LR=$Lf[$LG];$Lg=$LR.keyFrame[$Lt[$LG][$L_]],$LR.dataOffset=$Lp;var $LX=$LA-$Lg.startTime,$Lv=$LR.lerpType;if($Lv)switch($Lv){case 0:case 1:for($LE=0;$LE<$LR.keyframeWidth;)$LE+=$LR.interpolationMethod[$LE]($LR,$LE,$Li,$Lp+$LE,$Lg.data,$LX,null,$Lg.duration,$Lg.nextData);break;case 2:var $LO=$Lg.interpolationData,$Lc=$LO.length,$LB=0;for($LE=0;$LE<$Lc;){var $Ly=$LO[$LE];switch($Ly){case 6:case 7:$LE+=$LC.interpolation[$Ly]($LR,$LB,$Li,$Lp+$LB,$Lg.data,$LX,null,$Lg.duration,$Lg.nextData,$LO,$LE+1);break;default:$LE+=$LC.interpolation[$Ly]($LR,$LB,$Li,$Lp+$LB,$Lg.data,$LX,null,$Lg.duration,$Lg.nextData)}$LB++}}else for($LE=0;$LE<$LR.keyframeWidth;)$LE+=$LR.interpolationMethod[$LE]($LR,$LE,$Li,$Lp+$LE,$Lg.data,$LX,null,$Lg.duration,$Lg.nextData);$Lp+=$LR.keyframeWidth}},$Li.getNodesCurrentFrameIndex=function($Lr,$Li){var $Lt=this._anis[$Lr].nodes;$Lr!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($Lt.length),this.unfixedCurrentTimes=new Float32Array($Lt.length),this.unfixedLastAniIndex=$Lr);for(var $L_=0,$LA=$Lt.length;$L_<$LA;$L_++){var $Lf=$Lt[$L_];for($Li<this.unfixedCurrentTimes[$L_]&&(this.unfixedCurrentFrameIndexes[$L_]=0),this.unfixedCurrentTimes[$L_]=$Li;this.unfixedCurrentFrameIndexes[$L_]<$Lf.keyFrame.length&&!($Lf.keyFrame[this.unfixedCurrentFrameIndexes[$L_]].startTime>this.unfixedCurrentTimes[$L_]);)this.unfixedCurrentFrameIndexes[$L_]++;this.unfixedCurrentFrameIndexes[$L_]--}return this.unfixedCurrentFrameIndexes},$Li.getOriginalDataUnfixedRate=function($Lr,$Li,$Lt){var $L_=this._anis[$Lr].nodes;$Lr!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($L_.length),this.unfixedCurrentTimes=new Float32Array($L_.length),this.unfixedKeyframes=$Lc($L_.length),this.unfixedLastAniIndex=$Lr);for(var $LA=0,$Lf=0,$LE=$L_.length,$LG=0;$Lf<$LE;$Lf++){var $LN=$L_[$Lf];for($Lt<this.unfixedCurrentTimes[$Lf]&&(this.unfixedCurrentFrameIndexes[$Lf]=0),this.unfixedCurrentTimes[$Lf]=$Lt;this.unfixedCurrentFrameIndexes[$Lf]<$LN.keyFrame.length&&!($LN.keyFrame[this.unfixedCurrentFrameIndexes[$Lf]].startTime>this.unfixedCurrentTimes[$Lf]);)this.unfixedKeyframes[$Lf]=$LN.keyFrame[this.unfixedCurrentFrameIndexes[$Lf]],this.unfixedCurrentFrameIndexes[$Lf]++;var $Lp=this.unfixedKeyframes[$Lf];$LN.dataOffset=$LG;var $Lg=$Lt-$Lp.startTime;if($LN.lerpType)switch($LN.lerpType){case 0:case 1:for($LA=0;$LA<$LN.keyframeWidth;)$LA+=$LN.interpolationMethod[$LA]($LN,$LA,$Li,$LG+$LA,$Lp.data,$Lg,null,$Lp.duration,$Lp.nextData);break;case 2:var $LR=$Lp.interpolationData,$LX=$LR.length,$Lv=0;for($LA=0;$LA<$LX;){var $LO=$LR[$LA];switch($LO){case 6:case 7:$LA+=$LC.interpolation[$LO]($LN,$Lv,$Li,$LG+$Lv,$Lp.data,$Lg,null,$Lp.duration,$Lp.nextData,$LR,$LA+1);break;default:$LA+=$LC.interpolation[$LO]($LN,$Lv,$Li,$LG+$Lv,$Lp.data,$Lg,null,$Lp.duration,$Lp.nextData)}$Lv++}}else for($LA=0;$LA<$LN.keyframeWidth;)$LA+=$LN.interpolationMethod[$LA]($LN,$LA,$Li,$LG+$LA,$Lp.data,$Lg,null,$Lp.duration,$Lp.nextData);$LG+=$LN.keyframeWidth}},$LC._LinearInterpolation_0=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){var $Lg=0===$LG?0:$Lf/$LG;return $Lt[$L_]=(1-$Lg)*$LA[$Li]+$Lg*$LN[$Li],1},$LC._QuaternionInterpolation_1=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){var $Lg=0===$LG?0:$Lf/$LG;return $LX.slerpQuaternionArray($LA,$Li,$LN,$Li,$Lg,$Lt,$L_),4},$LC._AngleInterpolation_2=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){return 0},$LC._RadiansInterpolation_3=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){return 0},$LC._Matrix4x4Interpolation_4=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){for(var $Lg=0;$Lg<16;$Lg++,$Li++)$Lt[$L_+$Lg]=$LA[$Li]+$Lf*$LE[$Li];return 16},$LC._NoInterpolation_5=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp){return $Lt[$L_]=$LA[$Li],1},$LC._BezierInterpolation_6=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg){return void 0===$Lg&&($Lg=0),$Lt[$L_]=$LA[$Li]+($LN[$Li]-$LA[$Li])*$LH.getBezierRate($Lf/$LG,$Lp[$Lg],$Lp[$Lg+1],$Lp[$Lg+2],$Lp[$Lg+3]),5},$LC._BezierInterpolation_7=function($Lr,$Li,$Lt,$L_,$LA,$Lf,$LE,$LG,$LN,$Lp,$Lg){return void 0===$Lg&&($Lg=0),$Lt[$L_]=$Lp[$Lg+4]+$Lp[$Lg+5]*$LH.getBezierRate((.001*$Lf+$Lp[$Lg+6])/$Lp[$Lg+7],$Lp[$Lg],$Lp[$Lg+1],$Lp[$Lg+2],$Lp[$Lg+3]),9},$LC.load=function($Lr){return $LAr.loader.create($Lr,null,null,$LC)},$LC.interpolation=[$LC._LinearInterpolation_0,$LC._QuaternionInterpolation_1,$LC._AngleInterpolation_2,$LC._RadiansInterpolation_3,$LC._Matrix4x4Interpolation_4,$LC._NoInterpolation_5,$LC._BezierInterpolation_6,$LC._BezierInterpolation_7],$LC}(),$Ld=function($Li){function $Lt($Lr,$Li){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,$Lt.__super.call(this),void 0===$Li&&($Li=0),$Lr&&this.init($Lr,$Li)}$L_($Lt,"laya.ani.bone.Skeleton",$Li);var $Lr=$Lt.prototype;return $Lr.init=function($Lr,$Li){void 0===$Li&&($Li=0);var $Lt,$L_,$LA,$Lf=0,$LE=0;if(1==$Li)for(this._graphicsCache=[],$Lf=0,$LE=$Lr.getAnimationCount();$Lf<$LE;$Lf++)this._graphicsCache.push([]);if(this._yReverseMatrix=$Lr.yReverseMatrix,this._aniMode=$Li,this._templet=$Lr,this._player=new $Ls,this._player.cacheFrameRate=$Lr.rate,this._player.templet=$Lr,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=$Lr.mBoneArr,this._rootBone=$Lr.mRootBone,this._aniSectionDic=$Lr.aniSectionDic,0<$Lr.ikArr.length)for(this._ikArr=[],$Lf=0,$LE=$Lr.ikArr.length;$Lf<$LE;$Lf++)this._ikArr.push(new $LC($Lr.ikArr[$Lf],this._boneList));if(0<$Lr.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),$Lf=0,$LE=$Lr.pathArr.length;$Lf<$LE;$Lf++)$Lt=$Lr.pathArr[$Lf],$L_=new $LD($Lt,this._boneList),($LA=this._boneSlotDic[$Lt.name])&&(($L_=new $LD($Lt,this._boneList)).target=$LA),this._pathDic[$Lt.name]=$L_;if(0<$Lr.tfArr.length)for(this._tfArr=[],$Lf=0,$LE=$Lr.tfArr.length;$Lf<$LE;$Lf++)this._tfArr.push(new $Lu($Lr.tfArr[$Lf],this._boneList));if(0<$Lr.skinDataArray.length){var $LG=this._templet.skinDataArray[this._skinIndex];this._skinName=$LG.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},$Lr.load=function($Lr,$Li,$Lt){},$Lr._onLoaded=function(){},$Lr._parseComplete=function(){var $Lr=$Ll.TEMPLET_DICTIONARY[this._aniPath];$Lr&&(this.init($Lr,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},$Lr._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},$Lr._onPlay=function(){this.event("played")},$Lr._onStop=function(){var $Lr,$Li=this._templet.eventAniArr[this._aniClipIndex];if($Li&&this._eventIndex<$Li.length)for(;this._eventIndex<$Li.length;this._eventIndex++)($Lr=$Li[this._eventIndex]).time>=this._player.playStart&&$Lr.time<=this._player.playEnd&&this.event("label",$Lr);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},$Lr._onPause=function(){this.event("paused")},$Lr._parseSrcBoneMatrix=function(){var $Lr=0,$Li=0;for($Li=this._templet.srcBoneMatrixArr.length,$Lr=0;$Lr<$Li;$Lr++)this._boneMatrixArray.push(new $Ler);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var $Lt,$L_,$LA=this._templet.boneSlotArray;for($Lr=0,$Li=$LA.length;$Lr<$Li;$Lr++)$Lt=$LA[$Lr],null==($L_=this._bindBoneBoneSlotDic[$Lt.parent])&&(this._bindBoneBoneSlotDic[$Lt.parent]=$L_=[]),this._boneSlotDic[$Lt.name]=$Lt=$Lt.copy(),$L_.push($Lt),this._boneSlotArray.push($Lt)}},$Lr._emitMissedEvents=function($Lr,$Li,$Lt){void 0===$Lt&&($Lt=0);var $L_=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if($L_){var $LA,$Lf,$LE=0;for($LA=$L_.length,$LE=$Lt;$LE<$LA;$LE++)($Lf=$L_[$LE]).time>=this._player.playStart&&$Lf.time<=this._player.playEnd&&this.event("label",$Lf)}},$Lr._update=function($Lr){if(void 0===$Lr&&($Lr=!0),!(this._pause||$Lr&&this._indexControl)){var $Li=this.timer.currTimer,$Lt=this._player.currentKeyframeIndex,$L_=$Li-this._lastTime;if($Lr?this._player._update($L_):$Lt=-1,this._lastTime=$Li,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<$L_&&this._clipIndex==$Lt&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var $LA;this._lastUpdateAniClipIndex=this._aniClipIndex,$Lt>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var $Lf,$LE=this._templet.eventAniArr[this._aniClipIndex];if($LE&&this._eventIndex<$LE.length&&(($LA=$LE[this._eventIndex]).time>=this._player.playStart&&$LA.time<=this._player.playEnd?this._player.currentPlayTime>=$LA.time&&(this.event("label",$LA),this._eventIndex++):this._eventIndex++),0==this._aniMode){if($Lf=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$Lf&&(this.graphics=$Lf));var $LG=0,$LN=0;for($LN=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,$LN-1)&&0<$LN;)$LN--;if($LN<this._clipIndex)for($LG=$LN;$LG<this._clipIndex;$LG++)this._createGraphics($LG)}else if(1==this._aniMode){if($Lf=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$Lf&&(this.graphics=$Lf));for($LN=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,$LN-1)&&0<$LN;)$LN--;if($LN<this._clipIndex)for($LG=$LN;$LG<this._clipIndex;$LG++)this._createGraphics($LG)}this._createGraphics()}}},$Lr._createGraphics=function($Lr){void 0===$Lr&&($Lr=-1),-1==$Lr&&($Lr=this._clipIndex);var $Li,$Lt,$L_=$Lr*this._player.cacheFrameRateInterval,$LA=this._templet.drawOrderAniArr[this._aniClipIndex];if($LA&&0<$LA.length)for(this._drawOrderIndex=0,$Li=$LA[this._drawOrderIndex];$L_>=$Li.time&&(this._drawOrder=$Li.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=$LA.length));)$Li=$LA[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=$LF.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=$LF.create(),$Lt=this.graphics;var $Lf=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],$Lr,$L_);var $LE,$LG,$LN,$Lp,$Lg=this._aniSectionDic[this._aniClipIndex],$LR=0,$LX=0,$Lv=0,$LO=0,$Lc=0,$LB=this._templet.srcBoneMatrixArr.length;for($Lc=$Lg[$LX=0];$LX<$LB;$LX++)$Lp=this._boneList[$LX],$LN=this._templet.srcBoneMatrixArr[$LX],$Lp.resultTransform.scX=$LN.scX*this._curOriginalData[$LR++],$Lp.resultTransform.skX=$LN.skX+this._curOriginalData[$LR++],$Lp.resultTransform.skY=$LN.skY+this._curOriginalData[$LR++],$Lp.resultTransform.scY=$LN.scY*this._curOriginalData[$LR++],$Lp.resultTransform.x=$LN.x+this._curOriginalData[$LR++],$Lp.resultTransform.y=$LN.y+this._curOriginalData[$LR++],8===this._templet.tMatrixDataLen&&($Lp.resultTransform.skewX=$LN.skewX+this._curOriginalData[$LR++],$Lp.resultTransform.skewY=$LN.skewY+this._curOriginalData[$LR++]);var $Ly,$LC={},$Ln={};for($Lc+=$Lg[1];$LX<$Lc;$LX++)$LC[($Ly=$Lf[$LX]).name]=this._curOriginalData[$LR++],$Ln[$Ly.name]=this._curOriginalData[$LR++],this._curOriginalData[$LR++],this._curOriginalData[$LR++],this._curOriginalData[$LR++],this._curOriginalData[$LR++];var $La,$LD,$Lu={},$Lw={};for($Lc+=$Lg[2];$LX<$Lc;$LX++)$Lu[($Ly=$Lf[$LX]).name]=this._curOriginalData[$LR++],$Lw[$Ly.name]=this._curOriginalData[$LR++],this._curOriginalData[$LR++],this._curOriginalData[$LR++],this._curOriginalData[$LR++],this._curOriginalData[$LR++];if(this._pathDic)for($Lc+=$Lg[3];$LX<$Lc;$LX++){if($Ly=$Lf[$LX],$La=this._pathDic[$Ly.name])switch(new $Lkr($Ly.extenData).getByte()){case 1:$La.position=this._curOriginalData[$LR++];break;case 2:$La.spacing=this._curOriginalData[$LR++];break;case 3:$La.rotateMix=this._curOriginalData[$LR++],$La.translateMix=this._curOriginalData[$LR++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update($Ler.TEMP.identity()),this._ikArr)for($LX=0,$Lc=this._ikArr.length;$LX<$Lc;$LX++)$LD=this._ikArr[$LX],$Lu.hasOwnProperty($LD.name)&&($LD.bendDirection=$Lu[$LD.name]),$Lw.hasOwnProperty($LD.name)&&($LD.mix=$Lw[$LD.name]),$LD.apply();if(this._pathDic)for(var $LH in this._pathDic)($La=this._pathDic[$LH]).apply(this._boneList,$Lt);if(this._tfArr)for($LX=0,$LO=this._tfArr.length;$LX<$LO;$LX++)this._tfArr[$LX].apply();for($LX=0,$LO=this._boneList.length;$LX<$LO;$LX++)if($Lp=this._boneList[$LX],$LG=this._bindBoneBoneSlotDic[$Lp.name],$Lp.resultMatrix.copyTo(this._boneMatrixArray[$LX]),$LG)for($Lv=0,$Lc=$LG.length;$Lv<$Lc;$Lv++)($LE=$LG[$Lv])&&$LE.setParentMatrix($Lp.resultMatrix);var $Ls,$Ld,$Ll,$LU,$Lk={},$Le=this._templet.deformAniArr;if($Le&&0<$Le.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,$LX=0,$Lc=this._boneSlotArray.length;$LX<$Lc;$LX++)($LE=this._boneSlotArray[$LX]).deformData=null;var $LL,$LQ=$Le[this._aniClipIndex];for($LL in $Ls=$LQ.default,this._setDeform($Ls,$Lk,this._boneSlotArray,$L_),$LQ)"default"!=$LL&&$LL!=this._skinName&&($Ls=$LQ[$LL],this._setDeform($Ls,$Lk,this._boneSlotArray,$L_));$Ls=$LQ[this._skinName],this._setDeform($Ls,$Lk,this._boneSlotArray,$L_)}if(this._drawOrder)for($LX=0,$Lc=this._drawOrder.length;$LX<$Lc;$LX++)$Ld=$LC[($LE=this._boneSlotArray[this._drawOrder[$LX]]).name],$Ll=$Ln[$LE.name],isNaN($Ll)||($Lt.save(),$Lt.alpha($Ll)),isNaN($Ld)||-2==$Ld||(this._templet.attachmentNames?$LE.showDisplayByName(this._templet.attachmentNames[$Ld]):$LE.showDisplayByIndex($Ld)),$Lk[this._drawOrder[$LX]]?($LU=$Lk[this._drawOrder[$LX]],$LE.currDisplayData&&$LU[$LE.currDisplayData.attachmentName]?$LE.deformData=$LU[$LE.currDisplayData.attachmentName]:$LE.deformData=null):$LE.deformData=null,isNaN($Ll)?$LE.draw($Lt,this._boneMatrixArray,2==this._aniMode):$LE.draw($Lt,this._boneMatrixArray,2==this._aniMode,$Ll),isNaN($Ll)||$Lt.restore();else for($LX=0,$Lc=this._boneSlotArray.length;$LX<$Lc;$LX++)$Ld=$LC[($LE=this._boneSlotArray[$LX]).name],$Ll=$Ln[$LE.name],isNaN($Ll)||($Lt.save(),$Lt.alpha($Ll)),isNaN($Ld)||-2==$Ld||(this._templet.attachmentNames?$LE.showDisplayByName(this._templet.attachmentNames[$Ld]):$LE.showDisplayByIndex($Ld)),$Lk[$LX]?($LU=$Lk[$LX],$LE.currDisplayData&&$LU[$LE.currDisplayData.attachmentName]?$LE.deformData=$LU[$LE.currDisplayData.attachmentName]:$LE.deformData=null):$LE.deformData=null,isNaN($Ll)?$LE.draw($Lt,this._boneMatrixArray,2==this._aniMode):$LE.draw($Lt,this._boneMatrixArray,2==this._aniMode,$Ll),isNaN($Ll)||$Lt.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,$Lr,$Lt):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,$Lr,$Lt)},$Lr._setDeform=function($Lr,$Li,$Lt,$L_){if($Lr){var $LA,$Lf,$LE,$LG=0,$LN=0,$Lp=0;if($Lr)for($LG=0,$LN=$Lr.deformSlotDataList.length;$LG<$LN;$LG++)for($LA=$Lr.deformSlotDataList[$LG],$Lp=0;$Lp<$LA.deformSlotDisplayList.length;$Lp++)$LE=$Lt[($Lf=$LA.deformSlotDisplayList[$Lp]).slotIndex],$Lf.apply($L_,$LE),$Li[$Lf.slotIndex]||($Li[$Lf.slotIndex]={}),$Li[$Lf.slotIndex][$Lf.attachment]=$Lf.deformData}},$Lr.getAnimNum=function(){return this._templet.getAnimationCount()},$Lr.getAniNameByIndex=function($Lr){return this._templet.getAniNameByIndex($Lr)},$Lr.getSlotByName=function($Lr){return this._boneSlotDic[$Lr]},$Lr.showSkinByName=function($Lr,$Li){void 0===$Li&&($Li=!0),this.showSkinByIndex(this._templet.getSkinIndexByName($Lr),$Li)},$Lr.showSkinByIndex=function($Lr,$Li){void 0===$Li&&($Li=!0);for(var $Lt=0;$Lt<this._boneSlotArray.length;$Lt++)this._boneSlotArray[$Lt].showSlotData(null,$Li);if(this._templet.showSkinByIndex(this._boneSlotDic,$Lr,$Li)){var $L_=this._templet.skinDataArray[$Lr];this._skinIndex=$Lr,this._skinName=$L_.name}this._clearCache()},$Lr.showSlotSkinByIndex=function($Lr,$Li){if(0!=this._aniMode){var $Lt=this.getSlotByName($Lr);$Lt&&$Lt.showDisplayByIndex($Li),this._clearCache()}},$Lr.showSlotSkinByName=function($Lr,$Li){if(0!=this._aniMode){var $Lt=this.getSlotByName($Lr);$Lt&&$Lt.showDisplayByName($Li),this._clearCache()}},$Lr.replaceSlotSkinName=function($Lr,$Li,$Lt){if(0!=this._aniMode){var $L_=this.getSlotByName($Lr);$L_&&$L_.replaceDisplayByName($Li,$Lt),this._clearCache()}},$Lr.replaceSlotSkinByIndex=function($Lr,$Li,$Lt){if(0!=this._aniMode){var $L_=this.getSlotByName($Lr);$L_&&$L_.replaceDisplayByIndex($Li,$Lt),this._clearCache()}},$Lr.setSlotSkin=function($Lr,$Li){if(0!=this._aniMode){var $Lt=this.getSlotByName($Lr);$Lt&&$Lt.replaceSkin($Li),this._clearCache()}},$Lr._clearCache=function(){if(1==this._aniMode)for(var $Lr=0,$Li=this._graphicsCache.length;$Lr<$Li;$Lr++){for(var $Lt=0,$L_=this._graphicsCache[$Lr].length;$Lt<$L_;$Lt++){var $LA=this._graphicsCache[$Lr][$Lt];$LA!=this.graphics&&$LF.recycle($LA)}this._graphicsCache[$Lr].length=0}},$Lr.play=function($Lr,$Li,$Lt,$L_,$LA,$Lf){void 0===$Lt&&($Lt=!0),void 0===$L_&&($L_=0),void 0===$LA&&($LA=0),void 0===$Lf&&($Lf=!0),this._indexControl=!1;var $LE=-1,$LG=NaN;if($LG=$Li?2147483647:0,"string"==typeof $Lr)for(var $LN=0,$Lp=this._templet.getAnimationCount();$LN<$Lp;$LN++){var $Lg=this._templet.getAnimation($LN);if($Lg&&$Lr==$Lg.name){$LE=$LN;break}}else $LE=$Lr;-1<$LE&&$LE<this.getAnimNum()&&(this._aniClipIndex=$LE,($Lt||this._pause||this._currAniIndex!=$LE)&&(this._currAniIndex=$LE,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength($LE)),this._drawOrder=null,this._eventIndex=0,this._player.play($LE,this._player.playbackRate,$LG,$L_,$LA),$Lf&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=$LR.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},$Lr.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},$Lr.playbackRate=function($Lr){this._player&&(this._player.playbackRate=$Lr)},$Lr.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},$Lr.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=$LR.now(),this.timer.frameLoop(1,this,this._update,null,!0))},$Lr._getGrahicsDataWithCache=function($Lr,$Li){return this._graphicsCache[$Lr][$Li]},$Lr._setGrahicsDataWithCache=function($Lr,$Li,$Lt){this._graphicsCache[$Lr][$Li]=$Lt},$Lr.destroy=function($Lr){void 0===$Lr&&($Lr=!0),$Li.prototype.destroy.call(this,$Lr),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},$Lf(0,$Lr,"url",function(){return this._aniPath},function($Lr){this.load($Lr)}),$Lf(0,$Lr,"index",function(){return this._index},function($Lr){this.player&&(this._index=$Lr,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),$Lf(0,$Lr,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),$Lf(0,$Lr,"templet",function(){return this._templet}),$Lf(0,$Lr,"player",function(){return this._player}),$Lt.useSimpleMeshInCanvas=!1,$Lt}($Lfr),$Ll=function($Li){function $LA(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,$LA.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}$L_($LA,"laya.ani.bone.Templet",$Li);var $Lr=$LA.prototype;return $Lr.getLoadList=function(){return this._loadList},$Lr.loadAni=function($Lr){this._skBufferUrl=$Lr,$LAr.loader.load($Lr,$LN.create(this,this.onComplete),null,"arraybuffer")},$Lr.onComplete=function($Lr){if(this._isDestroyed)this.destroy();else{var $Li=$Lp.getRes(this._skBufferUrl);$Li?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,$Li)):this.event("error","load failed:"+this._skBufferUrl)}},$Lr.parseData=function($Lr,$Li,$Lt){void 0===$Lt&&($Lt=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=$Lr,this._mainTexture&&$LB.isWebGL&&$Lr.bitmap&&($Lr.bitmap.enableMerageInAtlas=!1),this._rate=$Lt,this.parse($Li)},$Lr.buildArmature=function($Lr){return void 0===$Lr&&($Lr=0),new $Ld(this,$Lr)},$Lr.parse=function($Lr){$Li.prototype.parse.call(this,$Lr),this._endLoaded(),this._aniVersion!=$LA.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+$LA.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},$Lr._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var $Lr=0;this._loadList=[];var $Li,$Lt=new $Lkr(this.getPublicExtData()),$L_=0,$LA=0,$Lf=0,$LE=$Lt.getInt32(),$LG=$Lt.readUTFString(),$LN=$LG.split("\n");for($Lr=0;$Lr<$LE;$Lr++)$Li=this._path+$LN[2*$Lr],$LG=$LN[2*$Lr+1],$Lt.getFloat32(),$Lt.getFloat32(),$L_=$Lt.getFloat32(),$LA=$Lt.getFloat32(),$Lf=$Lt.getFloat32(),isNaN($Lf)?0:$Lf,$Lf=$Lt.getFloat32(),isNaN($Lf)?0:$Lf,$Lf=$Lt.getFloat32(),isNaN($Lf)?$L_:$Lf,$Lf=$Lt.getFloat32(),isNaN($Lf)?$LA:$Lf,-1==this._loadList.indexOf($Li)&&this._loadList.push($Li);this.event("inited",this)}},$Lr._textureComplete=function(){for(var $Lr,$Li,$Lt=0,$L_=this._loadList.length;$Lt<$L_;$Lt++)$Li=this._loadList[$Lt],$Lr=this._textureDic[$Li]=$Lp.getRes($Li),$LB.isWebGL&&$Lr&&$Lr.bitmap&&($Lr.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},$Lr._parsePublicExtData=function(){var $Lr=0,$Li=0,$Lt=0,$L_=0,$LA=0;for($Lr=0,$LA=this.getAnimationCount();$Lr<$LA;$Lr++)this._graphicsCache.push([]);var $Lf;$Lf="Dragon"!=this._aniClassName;var $LE,$LG,$LN=new $Lkr(this.getPublicExtData()),$Lp=0,$Lg=0,$LR=0,$LX=0,$Lv=0,$LO=0,$Lc=0,$LB=0,$Ly=0,$LC=$LN.getInt32(),$Ln=$LN.readUTFString(),$La=$Ln.split("\n");for($Lr=0;$Lr<$LC;$Lr++){if($LE=this._mainTexture,$LG=this._path+$La[2*$Lr],$Ln=$La[2*$Lr+1],null==this._mainTexture&&($LE=this._textureDic[$LG]),!$LE)return this.event("error",this),void(this.isParseFail=!0);$Lp=$LN.getFloat32(),$Lg=$LN.getFloat32(),$LR=$LN.getFloat32(),$LX=$LN.getFloat32(),$Ly=$LN.getFloat32(),$Lv=isNaN($Ly)?0:$Ly,$Ly=$LN.getFloat32(),$LO=isNaN($Ly)?0:$Ly,$Ly=$LN.getFloat32(),$Lc=isNaN($Ly)?$LR:$Ly,$Ly=$LN.getFloat32(),$LB=isNaN($Ly)?$LX:$Ly,this.subTextureDic[$Ln]=$LLr.create($LE,$Lp,$Lg,$LR,$LX,-$Lv,-$LO,$Lc,$LB),$LE.alphaTexture&&(this.subTextureDic[$Ln].alphaTexture=$LLr.create($LE.alphaTexture,$Lp,$Lg,$LR,$LX,-$Lv,-$LO,$Lc,$LB))}this._mainTexture=$LE;var $LD,$Lu,$Lw,$LH,$Ls,$Ld=$LN.getUint16();for($Lr=0;$Lr<$Ld;$Lr++)($LD=[]).push($LN.getUint16()),$LD.push($LN.getUint16()),$LD.push($LN.getUint16()),$LD.push($LN.getUint16()),this.aniSectionDic[$Lr]=$LD;var $Ll,$LU=$LN.getInt16(),$Lk={};for($Lr=0;$Lr<$LU;$Lr++)$Lu=new $LQr,0==$Lr?$Ll=$Lu:$Lu.root=$Ll,$Lu.d=$Lf?-1:1,$LH=$LN.readUTFString(),$Ls=$LN.readUTFString(),$Lu.length=$LN.getFloat32(),1==$LN.getByte()&&($Lu.inheritRotation=!1),1==$LN.getByte()&&($Lu.inheritScale=!1),$Lu.name=$LH,$Ls&&(($Lw=$Lk[$Ls])?$Lw.addChild($Lu):this.mRootBone=$Lu),$Lk[$LH]=$Lu,this.mBoneArr.push($Lu);this.tMatrixDataLen=$LN.getUint16();var $Le,$LL,$LQ=$LN.getUint16(),$LF=Math.floor($LQ/this.tMatrixDataLen),$Lb=this.srcBoneMatrixArr;for($Lr=0;$Lr<$LF;$Lr++)($Le=new $Lzr).scX=$LN.getFloat32(),$Le.skX=$LN.getFloat32(),$Le.skY=$LN.getFloat32(),$Le.scY=$LN.getFloat32(),$Le.x=$LN.getFloat32(),$Le.y=$LN.getFloat32(),8===this.tMatrixDataLen&&($Le.skewX=$LN.getFloat32(),$Le.skewY=$LN.getFloat32()),$Lb.push($Le),($Lu=this.mBoneArr[$Lr]).transform=$Le;var $LV,$Lh=$LN.getUint16(),$LP=0;for($Lr=0;$Lr<$Lh;$Lr++){for($LL=new $Lmr,$LP=$LN.getUint16(),$Li=0;$Li<$LP;$Li++)$LL.boneNames.push($LN.readUTFString()),$LL.boneIndexs.push($LN.getInt16());$LL.name=$LN.readUTFString(),$LL.targetBoneName=$LN.readUTFString(),$LL.targetBoneIndex=$LN.getInt16(),$LL.bendDirection=$LN.getFloat32(),$LL.mix=$LN.getFloat32(),$LL.isSpine=$Lf,this.ikArr.push($LL)}var $Lq,$Lm=$LN.getUint16(),$LT=0;for($Lr=0;$Lr<$Lm;$Lr++){for($LV=new $LIr,$LT=$LN.getUint16(),$Li=0;$Li<$LT;$Li++)$LV.boneIndexs.push($LN.getInt16());$LV.name=$LN.getUTFString(),$LV.targetIndex=$LN.getInt16(),$LV.rotateMix=$LN.getFloat32(),$LV.translateMix=$LN.getFloat32(),$LV.scaleMix=$LN.getFloat32(),$LV.shearMix=$LN.getFloat32(),$LV.offsetRotation=$LN.getFloat32(),$LV.offsetX=$LN.getFloat32(),$LV.offsetY=$LN.getFloat32(),$LV.offsetScaleX=$LN.getFloat32(),$LV.offsetScaleY=$LN.getFloat32(),$LV.offsetShearY=$LN.getFloat32(),this.tfArr.push($LV)}var $Lx=$LN.getUint16(),$L$=0;for($Lr=0;$Lr<$Lx;$Lr++){for(($Lq=new $LTr).name=$LN.readUTFString(),$L$=$LN.getUint16(),$Li=0;$Li<$L$;$Li++)$Lq.bones.push($LN.getInt16());$Lq.target=$LN.readUTFString(),$Lq.positionMode=$LN.readUTFString(),$Lq.spacingMode=$LN.readUTFString(),$Lq.rotateMode=$LN.readUTFString(),$Lq.offsetRotation=$LN.getFloat32(),$Lq.position=$LN.getFloat32(),$Lq.spacing=$LN.getFloat32(),$Lq.rotateMix=$LN.getFloat32(),$Lq.translateMix=$LN.getFloat32(),this.pathArr.push($Lq)}var $Lo,$LI,$Lz,$LJ,$LZ,$LW=0,$LM=0,$LK=0,$LS=NaN,$LY=0,$Lj=$LN.getInt16();for($Lr=0;$Lr<$Lj;$Lr++){var $Lrr=$LN.getUint8(),$Lir={};this.deformAniArr.push($Lir);for(var $Ltr=0;$Ltr<$Lrr;$Ltr++)for(($Lo=new $Lbr).skinName=$LN.getUTFString(),$Lir[$Lo.skinName]=$Lo,$LW=$LN.getInt16(),$Li=0;$Li<$LW;$Li++)for($LI=new $LVr,$Lo.deformSlotDataList.push($LI),$LM=$LN.getInt16(),$Lt=0;$Lt<$LM;$Lt++)for($Lz=new $Lhr,$LI.deformSlotDisplayList.push($Lz),$Lz.slotIndex=$LN.getInt16(),$Lz.attachment=$LN.getUTFString(),$LK=$LN.getInt16(),$L_=0;$L_<$LK;$L_++)for(1==$LN.getByte()?$Lz.tweenKeyList.push(!0):$Lz.tweenKeyList.push(!1),$LS=$LN.getFloat32(),$Lz.timeList.push($LS),$LJ=[],$Lz.vectices.push($LJ),$LY=$LN.getInt16(),$LA=0;$LA<$LY;$LA++)$LJ.push($LN.getFloat32())}var $L_r,$LAr,$Lfr=$LN.getInt16(),$LEr=0,$LGr=0;for($Lr=0;$Lr<$Lfr;$Lr++){for($LEr=$LN.getInt16(),$LZ=[],$Li=0;$Li<$LEr;$Li++){for(($L_r=new $LPr).time=$LN.getFloat32(),$LGr=$LN.getInt16(),$Lt=0;$Lt<$LGr;$Lt++)$L_r.drawOrder.push($LN.getInt16());$LZ.push($L_r)}this.drawOrderAniArr.push($LZ)}var $LNr,$Lpr=$LN.getInt16(),$Lgr=0;for($Lr=0;$Lr<$Lpr;$Lr++){for($Lgr=$LN.getInt16(),$LAr=[],$Li=0;$Li<$Lgr;$Li++)($LNr=new $Lqr).name=$LN.getUTFString(),$LNr.intValue=$LN.getInt32(),$LNr.floatValue=$LN.getFloat32(),$LNr.stringValue=$LN.getUTFString(),$LNr.time=$LN.getFloat32(),$LAr.push($LNr);this.eventAniArr.push($LAr)}var $LRr=$LN.getInt16();if(0<$LRr)for(this.attachmentNames=[],$Lr=0;$Lr<$LRr;$Lr++)this.attachmentNames.push($LN.getUTFString());var $LXr,$Lvr,$LOr=$LN.getInt16();for($Lr=0;$Lr<$LOr;$Lr++)($LXr=new $LFr).name=$LN.readUTFString(),$LXr.parent=$LN.readUTFString(),$LXr.attachmentName=$LN.readUTFString(),$LXr.srcDisplayIndex=$LXr.displayIndex=$LN.getInt16(),($LXr.templet=this).boneSlotDic[$LXr.name]=$LXr,null==($Lvr=this.bindBoneBoneSlotDic[$LXr.parent])&&(this.bindBoneBoneSlotDic[$LXr.parent]=$Lvr=[]),$Lvr.push($LXr),this.boneSlotArray.push($LXr);var $Lcr,$LBr,$Lyr,$LCr=$LN.readUTFString().split("\n"),$Lnr=0,$Lar=$LN.getUint8(),$LDr=0,$Lur=0,$Lwr=0,$LHr=0,$Lsr=0,$Ldr=0,$Llr=0;for($Lr=0;$Lr<$Lar;$Lr++){for(($Lcr=new $Lxr).name=$LCr[$Lnr++],$LDr=$LN.getUint8(),$Li=0;$Li<$LDr;$Li++){for(($LBr=new $Lor).name=$LCr[$Lnr++],$LXr=this.boneSlotDic[$LBr.name],$Lur=$LN.getUint8(),$Lt=0;$Lt<$Lur;$Lt++){if($Lyr=new $L$r,this.skinSlotDisplayDataArr.push($Lyr),$Lyr.name=$LCr[$Lnr++],$Lyr.attachmentName=$LCr[$Lnr++],$Lyr.transform=new $Lzr,$Lyr.transform.scX=$LN.getFloat32(),$Lyr.transform.skX=$LN.getFloat32(),$Lyr.transform.skY=$LN.getFloat32(),$Lyr.transform.scY=$LN.getFloat32(),$Lyr.transform.x=$LN.getFloat32(),$Lyr.transform.y=$LN.getFloat32(),$LBr.displayArr.push($Lyr),$Lyr.width=$LN.getFloat32(),$Lyr.height=$LN.getFloat32(),$Lyr.type=$LN.getUint8(),$Lyr.verLen=$LN.getUint16(),0<($LU=$LN.getUint16()))for($Lyr.bones=[],$L_=0;$L_<$LU;$L_++){var $LUr=$LN.getUint16();$Lyr.bones.push($LUr)}if(0<($Lwr=$LN.getUint16()))for($Lyr.uvs=[],$L_=0;$L_<$Lwr;$L_++)$Lyr.uvs.push($LN.getFloat32());if(0<($LHr=$LN.getUint16()))for($Lyr.weights=[],$L_=0;$L_<$LHr;$L_++)$Lyr.weights.push($LN.getFloat32());if(0<($Lsr=$LN.getUint16()))for($Lyr.triangles=[],$L_=0;$L_<$Lsr;$L_++)$Lyr.triangles.push($LN.getUint16());if(0<($Ldr=$LN.getUint16()))for($Lyr.vertices=[],$L_=0;$L_<$Ldr;$L_++)$Lyr.vertices.push($LN.getFloat32());if(0<($Llr=$LN.getUint16()))for($Lyr.lengths=[],$L_=0;$L_<$Llr;$L_++)$Lyr.lengths.push($LN.getFloat32())}$Lcr.slotArr.push($LBr)}this.skinDic[$Lcr.name]=$Lcr,this.skinDataArray.push($Lcr)}1==$LN.getUint8()?(this.yReverseMatrix=new $Ler(1,0,0,-1,0,0),$Ll&&$Ll.setTempMatrix(this.yReverseMatrix)):$Ll&&$Ll.setTempMatrix(new $Ler),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},$Lr.getTexture=function($Lr){var $Li=this.subTextureDic[$Lr];return $Li||($Li=this.subTextureDic[$Lr.substr(0,$Lr.length-1)]),null==$Li?this._mainTexture:$Li},$Lr.showSkinByIndex=function($Lr,$Li,$Lt){if(void 0===$Lt&&($Lt=!0),$Li<0&&$Li>=this.skinDataArray.length)return!1;var $L_,$LA,$Lf=0,$LE=0,$LG=this.skinDataArray[$Li];if($LG){for($Lf=0,$LE=$LG.slotArr.length;$Lf<$LE;$Lf++)($LA=$LG.slotArr[$Lf])&&($L_=$Lr[$LA.name])&&($L_.showSlotData($LA,$Lt),$Lt&&"undefined"!=$L_.attachmentName&&"null"!=$L_.attachmentName?$L_.showDisplayByName($L_.attachmentName):$L_.showDisplayByIndex($L_.displayIndex));return!0}return!1},$Lr.getSkinIndexByName=function($Lr){for(var $Li=0,$Lt=this.skinDataArray.length;$Li<$Lt;$Li++)if(this.skinDataArray[$Li].name==$Lr)return $Li;return-1},$Lr.getGrahicsDataWithCache=function($Lr,$Li){return this._graphicsCache[$Lr][$Li]},$Lr.setGrahicsDataWithCache=function($Lr,$Li,$Lt){this._graphicsCache[$Lr][$Li]=$Lt},$Lr.destroy=function(){var $Lr;for(var $Li in this._isDestroyed=!0,this.subTextureDic)($Lr=this.subTextureDic[$Li])&&$Lr.destroy();for($Li in this._textureDic)($Lr=this._textureDic[$Li])&&$Lr.destroy();for(var $Lt=0,$L_=this.skinSlotDisplayDataArr.length;$Lt<$L_;$Lt++)this.skinSlotDisplayDataArr[$Lt].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete $LA.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},$Lr.getAniNameByIndex=function($Lr){var $Li=this.getAnimation($Lr);return $Li?$Li.name:null},$Lf(0,$Lr,"rate",function(){return this._rate},function($Lr){this._rate=$Lr}),$LA.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",$LA.TEMPLET_DICTIONARY=null,$LA}($Lb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($Lr,$Li){"use strict";for(var $Lt in Object.defineProperty($Li,"__esModule",{value:!0}),Laya){var $L_=Laya[$Lt];$L_&&$L_.__isclass&&($Li[$Lt]=$L_)}});