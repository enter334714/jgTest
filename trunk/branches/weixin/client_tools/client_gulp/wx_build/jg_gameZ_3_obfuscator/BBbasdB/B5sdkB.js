var D=wx.$b;import test from"../untils/ddtSDKPlat.js";var config={game_id:D[501797],game_pkg:D[501798],partner_label:D[501799],partner_id:D[501800],game_ver:D[501801],platId:1e3,gameId:272,channelVer:D[501802],mode:2,is_auth:!0};window.config=config;var b17P1ST=b171TSP();var HOST=D[501803];var b17P1TS=null;var b171STP=null;var partner_data={};function b171TSP(){var l={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(D[501804]);var t=this;var a;a=wx.getStorageSync(D[501805])?0:(a=t.uuid(16,32),wx.setStorageSync(D[501805],a),1),wx.getStorageSync(D[501806])||(o=t.uuid(16,32),wx.setStorageSync(D[501806],o));var o=wx.getLaunchOptionsSync();var n=o.scene||"";a&&o.query&&o.query.ad_code&&wx.setStorageSync(D[501807],o.query.ad_code),t.log(D[501808],{install:a,scene:n});ddtSDKPlat.init({platId:config.platId,gameId:config.gameId,channelVer:config.channelVer,mode:config.mode},function(e,r){switch(e){case D[501809]:console.log(D[501810],e,r);break;case D[501811]:console.log(D[501812],e,r);break;case D[501813]:console.log(D[501814],e,r),t.do_login(r);break;case D[501815]:console.log(D[501816],e,r),l[D[500698]]&&l[D[500698]](1,{errMsg:r.msg});break;case D[501817]:console.log(D[501818],e,r);break;case D[501819]:console.log(D[501820],e,r),l[D[500774]]&&l[D[500774]](1,{errMsg:r.errMsg})}},!0),wx.showShareMenu({withShareTicket:!0}),console.log(D[501821]+ddtSDKPlat.version);var i=o.query&&o.query.invite?o.query.invite:"";o=o.query&&o.query.invite_type?o.query.invite_type:"";i&&(b171STP={invite:i,invite_type:o,is_new:a,scene:n}),e&&this.checkGameVersion(e,function(e){r&&r(e)})},login:function(e,r){console.log(D[501822]),l[D[500698]]=typeof r==D[501005]?r:null},do_login:function(e){var t=this;partner_data={uid:e.uid,gameToken:e.gameToken,time:e.time,sign:e.sign};var r=t.getPublicData();if(r[D[501823]]=1,r[D[501824]]=JSON.stringify(partner_data),b171STP&&typeof b171STP==D[500903])for(var a in b171STP)r[a]=b171STP[a];wx.request({url:D[501825]+HOST+D[501826],method:D[500667],dataType:D[501252],header:{"content-type":D[500832]},data:r,success:function(e){if(console.log(D[501827]),console.log(e),200===e.statusCode){e=e.data;if(e.state){try{wx.setStorageSync(D[501828],e.data.sdk_token),wx.setStorageSync(D[501829],e.data.user_id),wx.setStorageSync(D[501830],e.data.username),e.data.ext&&wx.setStorageSync(D[501831],e.data.ext)}catch(e){}var r={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};l[D[500698]]&&l[D[500698]](0,r)}else l[D[500698]]&&l[D[500698]](1,{errMsg:e.msg});t.getShareInfo(D[501832],function(e){console.log(D[501833]),wx.onShareAppMessage(function(){return t.logStartShare(D[501832]),{title:e.title,imageUrl:e.img,query:e.query}})})}else l[D[500698]]&&l[D[500698]](1,{errMsg:D[501834]})}})},share:function(e){l[D[500792]]=typeof callback==D[501005]?callback:null;var r=e.type||D[500792];console.log(D[501835]+r);var t=this;this.getShareInfo(r,function(e){t.logStartShare(r),wx.shareAppMessage({title:e.title,imageUrl:e.img,query:e.query})})},logStartShare:function(e){var r=wx.getStorageSync(D[501828]);wx.request({url:D[501825]+HOST+D[501836],method:D[500667],dataType:D[501252],header:{"content-type":D[500832]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:b17P1TS?b17P1TS.server_id:"",role_id:b17P1TS?b17P1TS.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,t){console.log(D[501837]);wx.getStorageSync(D[501828]);wx.request({url:D[501825]+HOST+D[501838],method:D[500667],dataType:D[501252],header:{"content-type":D[500832]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(D[501839]),console.log(e),200==e.statusCode&&(r=e.data).state?t&&t(r.data):t&&t({develop:0})}})},getShareInfo:function(e,r){console.log(D[501840]);var t=wx.getStorageSync(D[501828]);wx.request({url:D[501825]+HOST+D[501841],method:D[500667],dataType:D[501252],header:{"content-type":D[500832]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,type:e,server_id:b17P1TS?b17P1TS.server_id:"",role_id:b17P1TS?b17P1TS.role_id:"",no_log:1},success:function(e){console.log(D[501842]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):l[D[500792]]&&l[D[500792]](1,{errMsg:D[501843]+e.msg}):l[D[500792]]&&l[D[500792]](1,{errMsg:D[501844]})}})},updateShare:function(e,r,t,a,o,n){console.log(D[501845]);var i=wx.getStorageSync(D[501828]);wx.request({url:D[501825]+HOST+D[501846],method:D[500667],dataType:D[501252],header:{"content-type":D[500832]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:r,is_new:t,role_id:a,sever_id:o,scene:n},success:function(e){console.log(D[501847]),console.log(e)}})},msgCheck:function(e,r){console.log(D[501848]);var t=wx.getStorageSync(D[501828]);wx.request({url:D[501825]+HOST+D[501849]+config.partner_id+"/"+config.game_pkg,method:D[500667],dataType:D[501252],header:{"content-type":D[500832]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,content:e,gameToken:partner_data.gameToken,uid:partner_data.uid,channelVer:config.channelVer,gameId:config.gameId,platId:config.platId},success:function(e){console.log(D[501850]),console.log(e),r&&r(e)}})},pay:function(e,r){this.startPay(e,r)},startPay:function(e,r){console.log(D[501851]),console.log(e);l[D[500774]]=typeof r==D[501005]?r:null;r=wx.getStorageSync(D[501828]);var t=wx.getStorageSync(D[501831]);var a;r||t?(a=wx.getSystemInfoSync(),e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:r,session_key:t,platform:a.platform},this.order_data=e,(r=this.getPublicData())[D[501853]]=JSON.stringify(e),r[D[501823]]=1,wx.request({url:D[501825]+HOST+D[501854],method:D[500667],dataType:D[501252],header:{"content-type":D[500832]},data:r,success:function(e){var r;console.log(D[501855]),console.log(e),200==e.statusCode?(e=e.data).state&&e.data.pay_data?(console.log(D[501856]+JSON.stringify(e.data.pay_data)),r={billNo:e.data.pay_data.billNo,amount:e.data.pay_data.amount,serverId:e.data.pay_data.serverId,roleId:e.data.pay_data.roleId,roleName:e.data.pay_data.roleName,roleLevel:e.data.pay_data.roleLevel,subject:e.data.pay_data.subject,productDesc:e.data.pay_data.productDesc,extraInfo:e.data.pay_data.extraInfo},ddtSDKPlat.pay(r)):l[D[500774]]&&l[D[500774]](1,{errMsg:e.errMsg}):l[D[500698]]&&l[D[500698]](1,{errMsg:D[501834]})}})):l[D[500774]]&&l[D[500774]](1,{errMsg:D[501852]})},logCreateRole:function(e){var r=wx.getStorageSync(D[501829]);var t=wx.getStorageSync(D[501830]);var a={};a[D[501857]]=r,a[D[501858]]=t,a[D[501859]]=e.roleid,a[D[501860]]=e.rolelevel,a[D[501861]]=e.rolename,a[D[500023]]=e.serverid,e.roleid&&e.serverid&&(b17P1TS={role_id:e.roleid,server_id:e.serverid}),this.log(D[500154],a);r={roleLevel:e.rolelevel+"",roleId:e.roleid+"",roleName:e.rolename,serverName:e.servername,serverId:e.serverid+""};ddtSDKPlat.submitData(D[501862],r)},logEnterGame:function(e,r){var t=wx.getStorageSync(D[501829]);var a=wx.getStorageSync(D[501830]);var o={};o[D[501857]]=t,o[D[501858]]=a,o[D[501859]]=e.roleid,o[D[501860]]=e.rolelevel,o[D[501861]]=e.rolename,o[D[500023]]=e.serverid,e.roleid&&e.serverid&&(b17P1TS={role_id:e.roleid,server_id:e.serverid}),this.log(D[501863],o);t={roleLevel:e.rolelevel,roleId:e.roleid,roleName:e.rolename,serverName:e.servername,serverId:e.serverid};ddtSDKPlat.submitData(D[501864],t),b171STP&&this.updateShare(b171STP.invite,b171STP.invite_type,b171STP.is_new,e.roleid,e.serverid,b171STP.scene)},logRoleUpLevel:function(e,r){var t=wx.getStorageSync(D[501829]);var a=wx.getStorageSync(D[501830]);this.log(D[501865],e);var o={};o[D[501857]]=t,o[D[501858]]=a,o[D[501859]]=e.roleid,o[D[501860]]=e.rolelevel,o[D[501861]]=e.rolename,o[D[500023]]=e.serverid,e.roleid&&e.serverid&&(b17P1TS={role_id:e.roleid,server_id:e.serverid,role_level:e.rolelevel,role_createtime:e.rolecreatetime});t={roleLevel:e.rolelevel,roleId:e.roleid,roleName:e.rolename,serverName:e.servername,serverId:e.serverid,rolecreatetime:e.rolecreatetime,vipLevel:"",power:"",roleSex:"",partyId:"",partyName:""};ddtSDKPlat.submitData(D[501866],t)},subscribeMessage:function(e,r){console.log(D[501867]+e),l[D[500803]]=typeof r==D[501005]?r:null,wx.requestSubscribeMessage({tmplIds:e,success(e){console.log(D[501868]),console.log(e),l[D[500803]]&&l[D[500803]](e)},fail(e){console.log(D[501869]),console.log(e),l[D[500803]]&&l[D[500803]](e)}})},weiduanHelper:function(){console.log(D[501870]),ddtSDKPlat.jump()},uuid:function(e,r){var t=D[501871].split("");var a,o=[];var n;if(e=e||t.length,r)for(a=0;a<r;a++)o[a]=t[0|Math.random()*e];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",a=0;a<36;a++)o[a]||(n=0|16*Math.random(),o[a]=t[19==a?3&n|8:n]);return o.join("")},getPublicData:function(){var e=wx.getSystemInfoSync();var r=wx.getStorageSync(D[501805]);var t=wx.getStorageSync(D[501806]);var a=wx.getStorageSync(D[501807]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:a,uuid:r,idfv:t,dname:e.model,mac:D[501872],net_type:0==e.wifiSignal?"4G":D[501873],os_ver:e.system,sdk_ver:e.version,game_ver:config.game_ver,device:e.platform==D[500110]?1:2}},log:function(e,r){var t=this.getPublicData();for(var a in r)t[a]=r[a];console.log(D[501874]+e),console.log(t),wx.request({url:D[501825]+HOST+D[501875]+e+D[501876]+encodeURIComponent(JSON.stringify(t))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()}}}function run(e,r,t){e in b17P1ST&&b17P1ST[e](r,t)}exports.init=function(e,r){run(D[500504],e,r)},exports.login=function(e){run(D[500698],"",e)},exports.pay=function(e,r){run(D[500774],e,r)},exports.openService=function(){run(D[500793])},exports.logCreateRole=function(e,r,t,a,o){run(D[500787],{serverid:e,servername:r,roleid:t,rolename:a,rolelevel:o})},exports.logEnterGame=function(e,r,t,a,o,n,i){run(D[500789],{serverid:e,servername:r,roleid:t,rolename:a,rolelevel:o,rolecreatetime:n},i)},exports.logRoleUpLevel=function(e,r,t,a,o,n,i){run(D[500791],{serverid:e,servername:r,roleid:t,rolename:a,rolelevel:o,rolecreatetime:n},i)},exports.share=function(e){run(D[500792],{type:e})},exports.subscribeMessage=function(e,r){run(D[500803],e,r)},exports.msgCheck=function(e,r){run(D[500648],e,r)},exports.downloadClient=function(){run(D[501877])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(D[501878])},exports.weiduanHelper=function(){run(D[500795])};