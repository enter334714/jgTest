var Laya=window.Laya=function(K$S,K$c){var K$n={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(K$c,K$P){return 1==arguments.length?K$n.__presubstr.call(this,K$c):K$n.__presubstr.call(this,K$c,0<K$P?K$P:this.length+K$P)},__init:function(K$c){K$c.forEach(function(K$c){K$c.__init$&&K$c.__init$()})},__isClass:function(K$c){return K$c&&(K$c.__isclass||K$c==Object||K$c==String||K$c==Array)},__newvec:function(K$c,K$P){var K$q=[];K$q.length=K$c;for(var K$_=0;K$_<K$c;K$_++)K$q[K$_]=K$P;return K$q},__extend:function(K$c,K$P){for(var K$q in K$P)if(K$P.hasOwnProperty(K$q)){var K$_=Object.getOwnPropertyDescriptor(K$P,K$q),K$E=K$_.get,K$b=K$_.set;K$E||K$b?K$E&&K$b?Object.defineProperty(K$c,K$q,K$_):(K$E&&Object.defineProperty(K$c,K$q,K$E),K$b&&Object.defineProperty(K$c,K$q,K$b)):K$c[K$q]=K$P[K$q]}function K$e(){K$n.un(this,"constructor",K$c)}K$e.prototype=K$P.prototype,K$c.prototype=new K$e,K$n.un(K$c.prototype,"__imps",K$n.__copy({},K$P.prototype.__imps))},__copy:function(K$c,K$P){if(!K$P)return null;for(var K$q in K$c=K$c||{},K$P)K$c[K$q]=K$P[K$q];return K$c},__package:function(K$c,K$P){if(!K$n.__packages[K$c]){K$n.__packages[K$c]=!0;var K$q=K$S,K$_=K$c.split(".");if(1<K$_.length)for(var K$E=0,K$b=K$_.length-1;K$E<K$b;K$E++){var K$e=K$q[K$_[K$E]];K$q=K$e||(K$q[K$_[K$E]]={})}K$q[K$_[K$_.length-1]]||(K$q[K$_[K$_.length-1]]=K$P||{})}},__hasOwnProperty:function(K$c,K$P){return K$P=K$P||this,Object.hasOwnProperty.call(K$P,K$c)||function K$c(K$P,K$q){if(Object.hasOwnProperty.call(K$q.prototype,K$P))return!0;var K$_=K$q.prototype.__super;return null==K$_?null:K$c(K$P,K$_)}(K$c,K$P.__class)},__typeof:function(K$c,K$P){if(!K$c||!K$P)return!1;if(K$P===String)return"string"==typeof K$c;if(K$P===Number)return"number"==typeof K$c;if(K$P.__interface__)K$P=K$P.__interface__;else if("string"!=typeof K$P)return K$c instanceof K$P;return K$c.__imps&&K$c.__imps[K$P]||K$c.__class==K$P},__as:function(K$c,K$P){return this.__typeof(K$c,K$P)?K$c:null},__int:function(K$c){return K$c?parseInt(K$c):0},interface:function(K$c,K$P){K$n.__package(K$c,{});var K$q=K$n.__internals,K$_=K$q[K$c]=K$q[K$c]||{self:K$c};if(K$P){var K$E=K$P.split(",");K$_.extend=[];for(var K$b=0;K$b<K$E.length;K$b++){var K$e=K$E[K$b];K$q[K$e]=K$q[K$e]||{self:K$e},K$_.extend.push(K$q[K$e])}}var K$h=K$S,K$Z=K$c.split(".");for(K$b=0;K$b<K$Z.length-1;K$b++)K$h=K$h[K$Z[K$b]];K$h[K$Z[K$Z.length-1]]={__interface__:K$c}},class:function(K$c,K$P,K$q,K$_){if(K$q&&K$n.__extend(K$c,K$q),K$P)if(K$n.__package(K$P,K$c),K$n.__classmap[K$P]=K$c,0<K$P.indexOf(".")){if(0==K$P.indexOf("laya.")){var K$E=K$P.split(".");K$_=K$_||K$E[K$E.length-1],K$n[K$_]&&console.log("Warning!,this class["+K$_+"] already exist:",K$n[K$_]),K$n[K$_]=K$c}}else"Main"==K$P?K$S.Main=K$c:"MainWX"==K$P?K$S.MainWX=K$c:(K$n[K$P]&&console.log("Error!,this class["+K$P+"] already exist:",K$n[K$P]),K$n[K$P]=K$c);var K$b=K$n.un,K$e=K$c.prototype;K$b(K$e,"hasOwnProperty",K$n.__hasOwnProperty),K$b(K$e,"__class",K$c),K$b(K$e,"__super",K$q),K$b(K$e,"__className",K$P),K$b(K$c,"__super",K$q),K$b(K$c,"__className",K$P),K$b(K$c,"__isclass",!0),K$b(K$c,"super",function(K$c){this.__super.call(K$c)})},imps:function(K$c,K$P){if(!K$P)return null;var K$E=K$c.__imps||K$n.un(K$c,"__imps",{});function K$b(K$c){var K$P,K$q;if((K$P=K$n.__internals[K$c])&&(K$E[K$c]=!0,K$q=K$P.extend))for(var K$_=0;K$_<K$q.length;K$_++)K$b(K$q[K$_].self)}for(var K$q in K$P)K$b(K$q)},superSet:function(K$c,K$P,K$q,K$_){var K$E=K$c.prototype["_$set_"+K$q];K$E&&K$E.call(K$P,K$_)},superGet:function(K$c,K$P,K$q){var K$_=K$c.prototype["_$get_"+K$q];return K$_?K$_.call(K$P):null},getset:function(K$c,K$P,K$q,K$_,K$E){K$c?(K$_&&(K$P["_$GET_"+K$q]=K$_),K$E&&(K$P["_$SET_"+K$q]=K$E)):(K$_&&K$n.un(K$P,"_$get_"+K$q,K$_),K$E&&K$n.un(K$P,"_$set_"+K$q,K$E)),K$_&&K$E?Object.defineProperty(K$P,K$q,{get:K$_,set:K$E,enumerable:!1,configurable:!0}):(K$_&&Object.defineProperty(K$P,K$q,{get:K$_,enumerable:!1,configurable:!0}),K$E&&Object.defineProperty(K$P,K$q,{set:K$E,enumerable:!1,configurable:!0}))},static:function(K$q,K$_){for(var K$E=0,K$c=K$_.length;K$E<K$c;K$E+=2)if("length"==K$_[K$E])K$q.length=K$_[K$E+1].call(K$q);else{function K$P(){var K$P=K$_[K$E],K$c=K$_[K$E+1];Object.defineProperty(K$q,K$P,{get:function(){return delete this[K$P],this[K$P]=K$c.call(this)},set:function(K$c){delete this[K$P],this[K$P]=K$c},enumerable:!0,configurable:!0})}K$P()}},un:function(K$c,K$P,K$q){return K$q||(K$q=K$c[K$P]),K$n.__propun.value=K$q,Object.defineProperty(K$c,K$P,K$n.__propun),K$q},uns:function(K$P,K$c){K$c.forEach(function(K$c){K$n.un(K$P,K$c)})}};return K$S.console=K$S.console||{log:function(){}},K$S.trace=K$S.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),K$n}(window,document);!function(K$c,K$P,K$q){K$q.un,K$q.uns,K$q.static,K$q.class,K$q.getset,K$q.__newvec}(window,document,Laya),function(K$e,K$P,K$H){K$H.un,K$H.uns;var K$Z=K$H.static,K$n=K$H.class,K$g=K$H.getset;K$H.__newvec;K$H.interface("laya.runtime.IMarket"),K$H.interface("laya.filters.IFilter"),K$H.interface("laya.display.ILayout"),K$H.interface("laya.resource.IDispose"),K$H.interface("laya.runtime.IPlatform"),K$H.interface("laya.resource.IDestroy"),K$H.interface("laya.runtime.IConchNode"),K$H.interface("laya.filters.IFilterAction"),K$H.interface("laya.runtime.ICPlatformClass"),K$H.interface("laya.resource.ICreateResource"),K$H.interface("laya.runtime.IConchRenderObject"),K$H.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var K$j=function(){function K$b(){}return K$n(K$b,"laya.utils.RunDriver"),K$b.FILTER_ACTIONS=[],K$b.pixelRatio=-1,K$b._charSizeTestDiv=null,K$b.now=function(){return Date.now()},K$b.getWindow=function(){return K$e},K$b.getPixelRatio=function(){if(K$b.pixelRatio<0){var K$c=K$s.context,K$P=K$c.backingStorePixelRatio||K$c.webkitBackingStorePixelRatio||K$c.mozBackingStorePixelRatio||K$c.msBackingStorePixelRatio||K$c.oBackingStorePixelRatio||K$c.backingStorePixelRatio||1;(K$b.pixelRatio=(K$s.window.devicePixelRatio||1)/K$P)<1&&(K$b.pixelRatio=1)}return K$b.pixelRatio},K$b.getIncludeStr=function(K$c){return null},K$b.createShaderCondition=function(K$c){var K$P="(function() {return "+K$c+";})";return K$H._runScript(K$P)},K$b.fontMap=[],K$b.measureText=function(K$c,K$P){var K$q=K$b.hanzi.test(K$c);if(K$q&&K$b.fontMap[K$P])return K$b.fontMap[K$P];var K$_=K$s.context;K$_.font=K$P;var K$E=K$_.measureText(K$c);return K$E||(K$E={width:16,height:16}),K$q&&(K$b.fontMap[K$P]=K$E),K$E},K$b.getWebGLContext=function(K$c){},K$b.beginFlush=function(){},K$b.endFinish=function(){},K$b.addToAtlas=null,K$b.flashFlushImage=function(K$c){},K$b.drawToCanvas=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=K$mc.create("2D"),K$h=new K$F(K$q,K$_,K$e);return K$o.renders[K$P]._fun(K$c,K$h,K$E,K$b),K$e},K$b.createParticleTemplate2D=null,K$b.createGLTextur=null,K$b.createWebGLContext2D=null,K$b.changeWebGLSize=function(K$c,K$P){},K$b.createRenderSprite=function(K$c,K$P){return new K$o(K$c,K$P)},K$b.createFilterAction=function(K$c){return new K$m},K$b.createGraphics=function(){return new K$x},K$b.clear=function(K$c){K$C._context.ctx.clear()},K$b.cancelLoadByUrl=function(K$c){},K$b.clearAtlas=function(K$c){},K$b.isAtlas=function(K$c){return!1},K$b.addTextureToAtlas=function(K$c){},K$b.getTexturePixels=function(K$c,K$P,K$q,K$_,K$E){return null},K$b.skinAniSprite=function(){return null},K$b.update3DLoop=function(){},K$Z(K$b,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),K$b}(),K$_=(K$g(1,K$H,"alertGlobalError",null,function(K$c){var K$b=0;K$s.window.onerror=K$c?function(K$c,K$P,K$q,K$_,K$E){K$b++<5&&K$E&&alert(K$E.stack||K$E)}:null}),K$H.init=function(K$c,K$P,K$q){for(var K$_=[],K$E=2,K$b=arguments.length;K$E<K$b;K$E++)K$_.push(arguments[K$E]);if(!K$H._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=K$H._arrayBufferSlice),K$H._isinit=!0,K$s.__init__(),K$a.__init__(),K$x.__init__(),K$H.timer=new K$t,K$H.scaleTimer=new K$t,K$H.loader=new K$Zc,K$K.__init__(),K$E=0;for(var K$e=K$_.length;K$E<K$e;K$E++)K$_[K$E].enable&&K$_[K$E].enable();return K$r.__init__(),K$h.__init__(),K$Y.__init__(),K$I.beginCheck(),K$H._currentStage=K$H.stage=new K$Oc,K$H.stage.conchModel&&K$H.stage.conchModel.setRootNode(),K$H._getUrlPath(),K$H.render=new K$C(0,0),K$H.stage.size(K$c,K$P),K$o.__init__(),K$k.__init__(),K$W.instance.__init__(K$H.stage,K$C.canvas),K$Dc.__init__(),K$J.autoStopMusic=!0,K$u.__init__(),K$C.canvas}},K$H._getUrlPath=function(){var K$c=K$s.window.location,K$P=K$c.pathname;K$P=K$P&&":"==K$P.charAt(2)?K$P.substring(1):K$P,K$$.rootPath=K$$.basePath=K$$.getPath("file:"==K$c.protocol?K$P:K$c.protocol+"//"+K$c.host+K$c.pathname)},K$H._arrayBufferSlice=function(K$c,K$P){var K$q=new Uint8Array(this,K$c,K$P-K$c),K$_=new Uint8Array(K$q.length);return K$_.set(K$q),K$_.buffer},K$H._runScript=function(K$c){return K$s.window[K$H._evcode](K$c)},K$H.stage=null,K$H.timer=null,K$H.scaleTimer=null,K$H.loader=null,K$H.version="1.8.6",K$H.render=null,K$H._currentStage=null,K$H._isinit=!1,K$H.isDebug=!1,K$H.MiniAdpter={init:function(){K$e.navigator&&K$e.navigator.userAgent&&-1<K$e.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},K$Z(K$H,["conchMarket",function(){return this.conchMarket=K$e.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=K$e.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function K$c(){}return K$n(K$c,"Config"),K$c.WebGLTextCacheCount=500,K$c.atlasEnable=!1,K$c.showCanvasMark=!1,K$c.animationInterval=50,K$c.isAntialias=!1,K$c.isAlpha=!1,K$c.premultipliedAlpha=!0,K$c.isStencil=!0,K$c.preserveDrawingBuffer=!1,K$c}()),K$S=function(){function K$S(){this._events=null}K$n(K$S,"laya.events.EventDispatcher");var K$c=K$S.prototype;return K$c.hasListener=function(K$c){return!!(this._events&&this._events[K$c])},K$c.getListener=function(K$c){return this._events?this._events[K$c]:null},K$c.event=function(K$c,K$P){if(!this._events||!this._events[K$c])return!1;var K$q=this._events[K$c];if(K$q.lock)K$q.queue||(K$q.queue=[]),K$q.queue.push(K$P);else{var K$_;for(K$q.lock=!0,K$q.cursor=K$q.head;K$q.cursor;)(K$_=K$q.cursor).recover?(K$q.head=K$q.tail=K$q.cursor=null,console.error("node is recover："+K$_.id)):(K$q.cursor=K$_.next,K$_.once&&K$S.delNode(K$q,K$_),K$_.method&&(null!=K$P?K$_.args?K$_.method.apply(K$_.caller,K$_.args.concat(K$P)):K$P instanceof Array?K$_.method.apply(K$_.caller,K$P):K$_.caller?K$_.method.call(K$_.caller,K$P):K$H.recordError("事件派发错误","node.caller:"+K$_.caller+"node.method:"+K$_.method+"data:"+K$P+"node.prev"+K$_.prev):K$_.method.apply(K$_.caller,K$_.args)),K$_.once&&K$S.recoverHandler(K$_));K$q.lock=!1,!K$q.head&&this._events&&this._events[K$c]==K$q&&delete this._events[K$c],K$q.queue&&K$q.queue.length&&this.event(K$c,K$q.queue.shift())}return!0},K$c.on=function(K$c,K$P,K$q,K$_){return this._createListener(K$c,K$P,K$q,K$_,!1)},K$c.once=function(K$c,K$P,K$q,K$_){return this._createListener(K$c,K$P,K$q,K$_,!0)},K$c._createListener=function(K$c,K$P,K$q,K$_,K$E,K$b){void 0===K$b&&(K$b=!0),K$b&&this.off(K$c,K$P,K$q,K$E);var K$e=K$S.createHandler(K$P||this,K$q,K$_,K$E);this._events||(this._events={});var K$h=this._events,K$Z=K$h[K$c];return K$Z?K$Z.tail?(K$e.prev=K$Z.tail,K$Z.tail.next=K$e,K$Z.tail=K$e):K$Z.head=K$Z.tail=K$e:K$h[K$c]={head:K$e,tail:K$e,cursor:null,lock:!1},this},K$c.off=function(K$c,K$P,K$q,K$_){if(void 0===K$_&&(K$_=!1),!this._events||!this._events[K$c])return this;for(var K$E=this._events[K$c],K$b=K$E.head;K$b;){if((!K$P||K$b.caller===K$P)&&K$b.method===K$q&&(!K$_||K$b.once)){K$S.delNode(K$E,K$b),K$E.cursor==K$b&&(K$E.cursor=K$b.next),K$S.recoverHandler(K$b);break}K$b=K$b.next}return this},K$c.offAll=function(K$c){var K$P=this._events;if(!K$P)return this;if(K$c)this._recoverHandlers(K$P[K$c]),delete K$P[K$c];else{for(var K$q in K$P)this._recoverHandlers(K$P[K$q]);this._events=null}return this},K$c._recoverHandlers=function(K$c){if(K$c){for(var K$P=K$c.head;K$P;){K$S.delNode(K$c,K$P);var K$q=K$P.next;K$S.recoverHandler(K$P),K$P=K$q}K$c.cursor=null}},K$c.isMouseEvent=function(K$c){return K$S.MOUSE_EVENTS[K$c]},K$S.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},K$S.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},K$S.delNode=function(K$c,K$P){K$P.prev?K$P.prev.next=K$P.next:K$c.head=K$P.next,K$P.next?K$P.next.prev=K$P.prev:K$c.tail=K$P.prev},K$S.createHandler=function(K$c,K$P,K$q,K$_){var K$E=500<K$S._freeHandler.length?K$S._freeHandler.shift():null;if(K$E)if(K$E.recover)K$E.recover=!1,K$E.caller=K$c,K$E.method=K$P,K$E.args=K$q,K$E.once=K$_;else{var K$b="";try{arguments.propertyIsEnumerable.caller}catch(K$c){K$b=K$c.stack}var K$e=K$E.caller?(K$E.caller.__proto__&&K$E.caller.__proto__.constructor&&K$E.caller.__proto__.constructor.name)+"|"+K$E.caller.__className+"|"+K$E.caller.name:"",K$h=K$E.method?K$E.method.name:"";K$H.recordError("EventDispatcher重复创建","caller="+K$e+"  method="+K$h+"  stack="+K$b),K$E={id:++K$S._nodeCount,caller:K$c,method:K$P,args:K$q,once:K$_,recover:!1}}else K$E={id:++K$S._nodeCount,caller:K$c,method:K$P,args:K$q,once:K$_,recover:!1};return K$E.prev=K$E.next=null,K$E},K$S.recoverHandler=function(K$c){if(K$c.recover){if(K$S._errorCount<5){K$S._errorCount++;var K$P="";try{arguments.propertyIsEnumerable.caller}catch(K$c){K$P=K$c.stack}var K$q=K$c.caller?(K$c.caller.__proto__&&K$c.caller.__proto__.constructor&&K$c.caller.__proto__.constructor.name)+"|"+K$c.caller.__className+"|"+K$c.caller.name:"",K$_=K$c.method?K$c.method.name:"";K$H.recordError("EventDispatcher重复回收","id="+K$c.id+"  caller="+K$q+"  method="+K$_+"  stack="+K$P)}K$c.caller=K$c.method=K$c.args=K$c.prev=null}else K$c.recover=!0,K$c.caller=K$c.method=K$c.args=K$c.prev=K$c.next=null,K$S._freeHandler&&K$S._freeHandler.length<3e3&&K$S._freeHandler.push(K$c)},K$S._freeHandler=[],K$S._nodeCount=0,K$S._errorCount=0,K$S}(),K$N=function(){function K$E(K$c,K$P,K$q,K$_){this.once=!1,void(this._id=0)===K$_&&(K$_=!1),this.setTo(K$c,K$P,K$q,K$_)}K$n(K$E,"laya.utils.Handler");var K$c=K$E.prototype;return K$c.setTo=function(K$c,K$P,K$q,K$_){return this._id=K$E._gid++,this.caller=K$c,this.method=K$P,this.args=K$q,this.once=K$_,this},K$c.run=function(){if(null==this.method)return null;var K$c=this._id,K$P=this.method.apply(this.caller,this.args);return this._id===K$c&&this.once&&this.recover(),K$P},K$c.runWith=function(K$c){if(null==this.method)return null;var K$P=this._id;if(null==K$c)var K$q=this.method.apply(this.caller,this.args);else K$q=this.args||K$c.unshift?this.args?this.method.apply(this.caller,this.args.concat(K$c)):this.method.apply(this.caller,K$c):this.method.call(this.caller,K$c);return this._id===K$P&&this.once&&this.recover(),K$q},K$c.clear=function(){return this.caller=null,this.method=null,this.args=null,this},K$c.recover=function(){0<this._id&&(this._id=0,this.clear())},K$E.create=function(K$c,K$P,K$q,K$_){return void 0===K$_&&(K$_=!0),new K$E(K$c,K$P,K$q,K$_)},K$E._gid=1,K$E}(),K$A=function(){function K$c(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}K$n(K$c,"laya.display.BitmapFont");var K$P=K$c.prototype;return K$P.loadFont=function(K$c,K$P){this._path=K$c,this._complete=K$P,K$H.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],K$N.create(this,this.onLoaded))},K$P.onLoaded=function(){this.parseFont(K$hc.getRes(this._path),K$hc.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},K$P.parseFont=function(K$c,K$P){if(null!=K$c&&null!=K$P){this._texture=K$P;var K$q=K$c.getElementsByTagName("info");if(!K$q[0].getAttributeNode)return this.parseFont2(K$c,K$P);this.fontSize=parseInt(K$q[0].getAttributeNode("size").nodeValue);var K$_,K$E=K$q[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(K$E[0]),parseInt(K$E[1]),parseInt(K$E[2]),parseInt(K$E[3])],K$_=K$c.getElementsByTagName("char");var K$b=0;for(K$b=0;K$b<K$_.length;K$b++){var K$e=K$_[K$b],K$h=parseInt(K$e.getAttributeNode("id").nodeValue),K$Z=parseInt(K$e.getAttributeNode("xoffset").nodeValue)/1,K$S=parseInt(K$e.getAttributeNode("yoffset").nodeValue)/1,K$n=parseInt(K$e.getAttributeNode("xadvance").nodeValue)/1,K$k=new K$d;K$k.x=parseInt(K$e.getAttributeNode("x").nodeValue),K$k.y=parseInt(K$e.getAttributeNode("y").nodeValue),K$k.width=parseInt(K$e.getAttributeNode("width").nodeValue),K$k.height=parseInt(K$e.getAttributeNode("height").nodeValue);var K$x=K$nc.create(K$P,K$k.x,K$k.y,K$k.width,K$k.height,K$Z,K$S);this._maxWidth=Math.max(this._maxWidth,K$n+this.letterSpacing),this._fontCharDic[K$h]=K$x,this._fontWidthMap[K$h]=K$n}}},K$P.parseFont2=function(K$c,K$P){if(null!=K$c&&null!=K$P){this._texture=K$P;var K$q=K$c.getElementsByTagName("info");this.fontSize=parseInt(K$q[0].attributes.size.nodeValue);var K$_=K$q[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(K$_[0]),parseInt(K$_[1]),parseInt(K$_[2]),parseInt(K$_[3])];var K$E=K$c.getElementsByTagName("char"),K$b=0;for(K$b=0;K$b<K$E.length;K$b++){var K$e=K$E[K$b].attributes,K$h=parseInt(K$e.id.nodeValue),K$Z=parseInt(K$e.xoffset.nodeValue)/1,K$S=parseInt(K$e.yoffset.nodeValue)/1,K$n=parseInt(K$e.xadvance.nodeValue)/1,K$k=new K$d;K$k.x=parseInt(K$e.x.nodeValue),K$k.y=parseInt(K$e.y.nodeValue),K$k.width=parseInt(K$e.width.nodeValue),K$k.height=parseInt(K$e.height.nodeValue);var K$x=K$nc.create(K$P,K$k.x,K$k.y,K$k.width,K$k.height,K$Z,K$S);this._maxWidth=Math.max(this._maxWidth,K$n+this.letterSpacing),this._fontCharDic[K$h]=K$x,this._fontWidthMap[K$h]=K$n}}},K$P.getCharTexture=function(K$c){return this._fontCharDic[K$c.charCodeAt(0)]},K$P.destroy=function(){if(this._texture){for(var K$c in this._fontCharDic){var K$P=this._fontCharDic[K$c];K$P&&K$P.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},K$P.setSpaceWidth=function(K$c){this._spaceWidth=K$c},K$P.getCharWidth=function(K$c){var K$P=K$c.charCodeAt(0);return this._fontWidthMap[K$P]?this._fontWidthMap[K$P]+this.letterSpacing:" "==K$c?this._spaceWidth+this.letterSpacing:0},K$P.getTextWidth=function(K$c){for(var K$P=0,K$q=0,K$_=K$c.length;K$q<K$_;K$q++)K$P+=this.getCharWidth(K$c.charAt(K$q));return K$P},K$P.getMaxWidth=function(){return this._maxWidth},K$P.getMaxHeight=function(){return this.fontSize},K$P.drawText=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e,K$h=this.getTextWidth(K$c),K$Z=0;"center"===K$E&&(K$Z=(K$b-K$h)/2),"right"===K$E&&(K$Z=K$b-K$h);for(var K$S=0,K$n=0,K$k=K$c.length;K$n<K$k;K$n++)(K$e=this.getCharTexture(K$c.charAt(K$n)))&&(K$P.graphics.drawTexture(K$e,K$q+K$S+K$Z,K$_),K$S+=this.getCharWidth(K$c.charAt(K$n)))},K$c}(),K$h=function(){function K$q(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=K$q._TF_EMPTY}K$n(K$q,"laya.display.css.Style");var K$c=K$q.prototype;return K$c.getTransform=function(){return this._tf},K$c.setTransform=function(K$c){this._tf="none"!==K$c&&K$c?K$c:K$q._TF_EMPTY},K$c.setTranslateX=function(K$c){this._tf===K$q._TF_EMPTY&&(this._tf=new K$E),this._tf.translateX=K$c},K$c.setTranslateY=function(K$c){this._tf===K$q._TF_EMPTY&&(this._tf=new K$E),this._tf.translateY=K$c},K$c.setScaleX=function(K$c){this._tf===K$q._TF_EMPTY&&(this._tf=new K$E),this._tf.scaleX=K$c},K$c.setScale=function(K$c,K$P){this._tf===K$q._TF_EMPTY&&(this._tf=new K$E),this._tf.scaleX=K$c,this._tf.scaleY=K$P},K$c.setScaleY=function(K$c){this._tf===K$q._TF_EMPTY&&(this._tf=new K$E),this._tf.scaleY=K$c},K$c.setRotate=function(K$c){this._tf===K$q._TF_EMPTY&&(this._tf=new K$E),this._tf.rotate=K$c},K$c.setSkewX=function(K$c){this._tf===K$q._TF_EMPTY&&(this._tf=new K$E),this._tf.skewX=K$c},K$c.setSkewY=function(K$c){this._tf===K$q._TF_EMPTY&&(this._tf=new K$E),this._tf.skewY=K$c},K$c.destroy=function(){this.scrollRect=null},K$c.render=function(K$c,K$P,K$q,K$_){},K$c.getCSSStyle=function(){return K$Pc.EMPTY},K$c._enableLayout=function(){return!1},K$g(0,K$c,"scaleX",function(){return this._tf.scaleX},function(K$c){this.setScaleX(K$c)}),K$g(0,K$c,"transform",function(){return this.getTransform()},function(K$c){this.setTransform(K$c)}),K$g(0,K$c,"translateX",function(){return this._tf.translateX},function(K$c){this.setTranslateX(K$c)}),K$g(0,K$c,"translateY",function(){return this._tf.translateY},function(K$c){this.setTranslateY(K$c)}),K$g(0,K$c,"scaleY",function(){return this._tf.scaleY},function(K$c){this.setScaleY(K$c)}),K$g(0,K$c,"block",function(){return 0!=(1&this._type)}),K$g(0,K$c,"skewY",function(){return this._tf.skewY},function(K$c){this.setSkewY(K$c)}),K$g(0,K$c,"rotate",function(){return this._tf.rotate},function(K$c){this.setRotate(K$c)}),K$g(0,K$c,"skewX",function(){return this._tf.skewX},function(K$c){this.setSkewX(K$c)}),K$g(0,K$c,"paddingLeft",function(){return 0}),K$g(0,K$c,"paddingTop",function(){return 0}),K$g(0,K$c,"absolute",function(){return!0}),K$q.__init__=function(){K$q._TF_EMPTY=new K$E,K$q.EMPTY=new K$q},K$q.EMPTY=null,K$q._TF_EMPTY=null,K$q}(),K$r=function(){function K$P(K$c){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=K$y.create(K$P.defaultColor),this.family=K$P.defaultFamily,this.stroke=K$P._STROKE,this.size=K$P.defaultSize,K$c&&K$c!==K$P.EMPTY&&K$c.copyTo(this)}K$n(K$P,"laya.display.css.Font");var K$c=K$P.prototype;return K$c.set=function(K$c){this._text=null;for(var K$P=K$c.split(" "),K$q=0,K$_=K$P.length;K$q<K$_;K$q++){var K$E=K$P[K$q];switch(K$E){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<K$E.indexOf("px")&&(this.size=parseInt(K$E),this.family=K$P[K$q+1],K$q++)}},K$c.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},K$c.copyTo=function(K$c){K$c._type=this._type,K$c._text=this._text,K$c._weight=this._weight,K$c._color=this._color,K$c.family=this.family,K$c.stroke=this.stroke!=K$P._STROKE?this.stroke.slice():K$P._STROKE,K$c.indent=this.indent,K$c.size=this.size},K$g(0,K$c,"password",function(){return 0!=(1024&this._type)},function(K$c){K$c?this._type|=1024:this._type&=-1025}),K$g(0,K$c,"color",function(){return this._color.strColor},function(K$c){this._color=K$y.create(K$c)}),K$g(0,K$c,"italic",function(){return 0!=(512&this._type)},function(K$c){K$c?this._type|=512:this._type&=-513}),K$g(0,K$c,"bold",function(){return 0!=(2048&this._type)},function(K$c){K$c?this._type|=2048:this._type&=-2049}),K$g(0,K$c,"weight",function(){return""+this._weight},function(K$c){var K$P=0;switch(K$c){case"normal":break;case"bold":this.bold=!0,K$P=700;break;case"bolder":K$P=800;break;case"lighter":K$P=100;break;default:K$P=parseInt(K$c)}this._weight=K$P,this._text=null}),K$g(0,K$c,"decoration",function(){return this._decoration?this._decoration.value:null},function(K$c){var K$P=K$c.split(" ");switch(this._decoration||(this._decoration={}),K$P[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=K$P[0]}K$P[1]&&(this._decoration.color=K$y.create(K$P)),this._decoration.value=K$c}),K$P.__init__=function(){K$P.EMPTY=new K$P(null)},K$P.EMPTY=null,K$P.defaultColor="#000000",K$P.defaultSize=12,K$P.defaultFamily="Arial",K$P.defaultFont="12px Arial",K$P._STROKE=[0,"#000000"],K$P._ITALIC=512,K$P._PASSWORD=1024,K$P._BOLD=2048,K$P}(),K$E=function(){function K$c(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return K$n(K$c,"laya.display.css.TransformInfo"),K$c}(),K$x=function(){function K$k(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,K$C.isConchNode){this._nativeObj=new K$e._conchGraphics,this.id=this._nativeObj.conchID}}K$n(K$k,"laya.display.Graphics");var K$c=K$k.prototype;return K$c.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},K$c.clear=function(K$c){void 0===K$c&&(K$c=!1);var K$P=0,K$q=0;if(K$c){var K$_=this._one;if(this._cmds){for(K$q=this._cmds.length,K$P=0;K$P<K$q;K$P++)!(K$_=this._cmds[K$P])||K$_.callee!==K$C._context._drawTexture&&K$_.callee!==K$C._context._drawTextureWithTransform||(K$_[0]=null,K$k._cache.push(K$_));this._cmds.length=0}else K$_&&(!K$_||K$_.callee!==K$C._context._drawTexture&&K$_.callee!==K$C._context._drawTextureWithTransform||(K$_[0]=null,K$k._cache.push(K$_)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(K$P=0,K$q=this._vectorgraphArray.length;K$P<K$q;K$P++)K$i.getInstance().deleteShape(this._vectorgraphArray[K$P]);this._vectorgraphArray.length=0}},K$c._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},K$c._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new K$q,this._graphicBounds._graphics=this)},K$c._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},K$c._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},K$c.getBounds=function(K$c){return void 0===K$c&&(K$c=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(K$c)},K$c.getBoundPoints=function(K$c){return void 0===K$c&&(K$c=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(K$c)},K$c._addCmd=function(K$c){this._cmds=this._cmds||[],K$c.callee=K$c.shift(),this._cmds.push(K$c)},K$c.setFilters=function(K$c){this._saveToCmd(K$C._context._setFilters,K$c)},K$c.drawTexture=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){if(void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=0),void 0===K$E&&(K$E=0),void 0===K$e&&(K$e=1),!K$c||K$e<.01)return null;K$_||(K$_=K$c.sourceWidth),K$E||(K$E=K$c.sourceHeight),K$e=K$e<0?0:1<K$e?1:K$e;var K$h,K$Z=!K$C.isWebGL&&(K$s.onFirefox||K$s.onEdge||K$s.onIE||K$s.onSafari)?.5:0,K$S=K$_/K$c.sourceWidth,K$n=K$E/K$c.sourceHeight;return K$_=K$c.width*K$S,K$E=K$c.height*K$n,K$c.loaded&&(K$_<=0||K$E<=0)?null:(K$P+=K$c.offsetX*K$S,K$q+=K$c.offsetY*K$n,this._sp&&(this._sp._renderType|=512),K$P-=K$Z,K$q-=K$Z,K$_+=2*K$Z,K$E+=2*K$Z,K$k._cache.length?((K$h=K$k._cache.pop())[0]=K$c,K$h[1]=K$P,K$h[2]=K$q,K$h[3]=K$_,K$h[4]=K$E,K$h[5]=K$b,K$h[6]=K$e):K$h=[K$c,K$P,K$q,K$_,K$E,K$b,K$e],K$h.callee=K$b||1!=K$e?K$C._context._drawTextureWithTransform:K$C._context._drawTexture,null!=this._one||K$b||1!=K$e?this._saveToCmd(K$h.callee,K$h):(this._one=K$h,this._render=this._renderOneImg),K$c.loaded||K$c.once("loaded",this,this._textureLoaded,[K$c,K$h]),this._repaint(),K$h)},K$c.cleanByTexture=function(K$c,K$P,K$q,K$_,K$E){if(void 0===K$_&&(K$_=0),void 0===K$E&&(K$E=0),!K$c)return this.clear();if(this._one&&this._render===this._renderOneImg){K$_||(K$_=K$c.sourceWidth),K$E||(K$E=K$c.sourceHeight);var K$b=K$_/K$c.sourceWidth,K$e=K$E/K$c.sourceHeight;K$_=K$c.width*K$b,K$E=K$c.height*K$e,K$P+=K$c.offsetX*K$b,K$q+=K$c.offsetY*K$e,this._one[0]=K$c,this._one[1]=K$P,this._one[2]=K$q,this._one[3]=K$_,this._one[4]=K$E,this._repaint()}else this.clear(),K$c&&this.drawTexture(K$c,K$P,K$q,K$_,K$E)},K$c.drawTextures=function(K$c,K$P){K$c&&this._saveToCmd(K$C._context._drawTextures,[K$c,K$P])},K$c.fillTexture=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){if(void 0===K$_&&(K$_=0),void 0===K$E&&(K$E=0),void 0===K$b&&(K$b="repeat"),K$c){var K$h=[K$c,K$P,K$q,K$_,K$E,K$b,K$e||K$Q.EMPTY,{}];K$c.loaded||K$c.once("loaded",this,this._textureLoaded,[K$c,K$h]),this._saveToCmd(K$C._context._fillTexture,K$h)}},K$c._textureLoaded=function(K$c,K$P){K$P[3]=K$P[3]||K$c.width,K$P[4]=K$P[4]||K$c.height,this._repaint()},K$c.fillCircle=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){K$q.bitmap.enableMerageInAtlas=!1;var K$h=new Float32Array(2*(K$e+1)),K$Z=new Float32Array(2*(K$e+1)),K$S=new Uint16Array(3*K$e),K$n=2*Math.PI/K$e,K$k=0;K$h[0]=K$_,K$h[1]=K$E,K$Z[0]=K$_/K$q.width,K$Z[1]=K$E/K$q.height;for(var K$x=2,K$r=0;K$r<K$e;K$r++){var K$g=K$b*Math.cos(K$k)+K$_,K$W=K$b*Math.sin(K$k)+K$E;K$h[K$x]=K$g,K$h[K$x+1]=K$W,K$Z[K$x]=K$g/K$q.width,K$Z[K$x+1]=K$W/K$q.height,K$k+=K$n,K$x+=2}for(K$r=K$x=0;K$r<K$e;K$r++)K$S[K$x++]=0,K$S[K$x++]=K$r+1,K$S[K$x++]=K$e+1<=K$r+2?1:K$r+2;this.drawTriangles(K$q,K$c,K$P,K$h,K$Z,K$S)},K$c.drawTriangles=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){void 0===K$h&&(K$h=1),this._saveToCmd(K$C._context.drawTriangles,[K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S])},K$c._saveToCmd=function(K$c,K$P){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=K$P,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(K$P)),K$P.callee=K$c,this._repaint(),K$P},K$c.clipRect=function(K$c,K$P,K$q,K$_){this._saveToCmd(K$C._context._clipRect,[K$c,K$P,K$q,K$_])},K$c.fillText=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){void 0===K$e&&(K$e=0),this._saveToCmd(K$C._context._fillText,[K$c,K$P,K$q,K$_||K$r.defaultFont,K$E,K$b])},K$c.fillBorderText=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){this._saveToCmd(K$C._context._fillBorderText,[K$c,K$P,K$q,K$_||K$r.defaultFont,K$E,K$b,K$e,K$h])},K$c.strokeText=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this._saveToCmd(K$C._context._strokeText,[K$c,K$P,K$q,K$_||K$r.defaultFont,K$E,K$b,K$e])},K$c.alpha=function(K$c){K$c=K$c<0?0:1<K$c?1:K$c,this._saveToCmd(K$C._context._alpha,[K$c])},K$c.setAlpha=function(K$c){K$c=K$c<0?0:1<K$c?1:K$c,this._saveToCmd(K$C._context._setAlpha,[K$c])},K$c.transform=function(K$c,K$P,K$q){void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),this._saveToCmd(K$C._context._transform,[K$c,K$P,K$q])},K$c.rotate=function(K$c,K$P,K$q){void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),this._saveToCmd(K$C._context._rotate,[K$c,K$P,K$q])},K$c.scale=function(K$c,K$P,K$q,K$_){void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=0),this._saveToCmd(K$C._context._scale,[K$c,K$P,K$q,K$_])},K$c.translate=function(K$c,K$P){this._saveToCmd(K$C._context._translate,[K$c,K$P])},K$c.save=function(){this._saveToCmd(K$C._context._save,[])},K$c.restore=function(){this._saveToCmd(K$C._context._restore,[])},K$c.replaceText=function(K$c){this._repaint();var K$P=this._cmds;if(K$P){for(var K$q=K$P.length-1;-1<K$q;K$q--)if(this._isTextCmd(K$P[K$q].callee))return K$P[K$q][0].toUpperCase?K$P[K$q][0]=K$c:K$P[K$q][0].setText(K$c),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=K$c:this._one[0].setText(K$c),!0;return!1},K$c._isTextCmd=function(K$c){return K$c===K$C._context._fillText||K$c===K$C._context._fillBorderText||K$c===K$C._context._strokeText},K$c.replaceTextColor=function(K$c){this._repaint();var K$P=this._cmds;if(K$P)for(var K$q=K$P.length-1;-1<K$q;K$q--)this._isTextCmd(K$P[K$q].callee)&&(K$P[K$q][4]=K$c,K$P[K$q][0].toUpperCase||(K$P[K$q][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=K$c,this._one[0].toUpperCase||(this._one[0].changed=!0))},K$c.loadImage=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=this;void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=0),void 0===K$E&&(K$E=0);var K$h=K$hc.getRes(K$c);function K$Z(K$c){K$c&&(K$e.drawTexture(K$c,K$P,K$q,K$_,K$E),null!=K$b&&K$b.call(K$e._sp,K$c))}K$h?K$Z(K$h):K$H.loader.load(K$c,K$N.create(null,K$Z),null,"image")},K$c._renderEmpty=function(K$c,K$P,K$q,K$_){},K$c._renderAll=function(K$c,K$P,K$q,K$_){for(var K$E,K$b=this._cmds,K$e=0,K$h=K$b.length;K$e<K$h;K$e++)(K$E=K$b[K$e]).callee.call(K$P,K$q,K$_,K$E)},K$c._renderOne=function(K$c,K$P,K$q,K$_){this._one.callee.call(K$P,K$q,K$_,this._one)},K$c._renderOneImg=function(K$c,K$P,K$q,K$_){this._one.callee.call(K$P,K$q,K$_,this._one),2305!==K$c._renderType&&(K$c._renderType|=1)},K$c.drawLine=function(K$c,K$P,K$q,K$_,K$E,K$b){void 0===K$b&&(K$b=1);var K$e=0;K$C.isWebGL&&(K$e=K$i.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(K$e));var K$h=K$b%2==0?0:.5,K$Z=[K$c+K$h,K$P+K$h,K$q+K$h,K$_+K$h,K$E,K$b,K$e];this._saveToCmd(K$C._context._drawLine,K$Z)},K$c.drawLines=function(K$c,K$P,K$q,K$_,K$E){void 0===K$E&&(K$E=1);var K$b=0;if(K$q&&!(K$q.length<4)){K$C.isWebGL&&(K$b=K$i.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(K$b));var K$e=K$E%2==0?0:.5,K$h=[K$c+K$e,K$P+K$e,K$q,K$_,K$E,K$b];this._saveToCmd(K$C._context._drawLines,K$h)}},K$c.drawCurves=function(K$c,K$P,K$q,K$_,K$E){void 0===K$E&&(K$E=1);var K$b=[K$c,K$P,K$q,K$_,K$E];this._saveToCmd(K$C._context._drawCurves,K$b)},K$c.drawRect=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){void 0===K$e&&(K$e=1);var K$h=K$b?K$e/2:0,K$Z=K$b?K$e:0,K$S=[K$c+K$h,K$P+K$h,K$q-K$Z,K$_-K$Z,K$E,K$b,K$e];this._saveToCmd(K$C._context._drawRect,K$S)},K$c.drawCircle=function(K$c,K$P,K$q,K$_,K$E,K$b){void 0===K$b&&(K$b=1);var K$e=K$E?K$b/2:0,K$h=0;K$C.isWebGL&&(K$h=K$i.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(K$h));var K$Z=[K$c,K$P,K$q-K$e,K$_,K$E,K$b,K$h];this._saveToCmd(K$C._context._drawCircle,K$Z)},K$c.drawPie=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){void 0===K$h&&(K$h=1);var K$Z=K$e?K$h/2:0,K$S=K$e?K$h:0,K$n=0;K$C.isWebGL&&(K$n=K$i.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(K$n));var K$k=[K$c+K$Z,K$P+K$Z,K$q-K$S,K$_,K$E,K$b,K$e,K$h,K$n];K$k[3]=K$p.toRadian(K$_),K$k[4]=K$p.toRadian(K$E),this._saveToCmd(K$C._context._drawPie,K$k)},K$c.drawPoly=function(K$c,K$P,K$q,K$_,K$E,K$b){void 0===K$b&&(K$b=1);var K$e=0,K$h=!1;K$C.isWebGL&&(K$e=K$i.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(K$e),K$h=!(6<K$q.length));var K$Z=K$E?K$b%2==0?0:.5:0,K$S=[K$c+K$Z,K$P+K$Z,K$q,K$_,K$E,K$b,K$e,K$h];this._saveToCmd(K$C._context._drawPoly,K$S)},K$c.drawPath=function(K$c,K$P,K$q,K$_,K$E){var K$b=[K$c,K$P,K$q,K$_,K$E];this._saveToCmd(K$C._context._drawPath,K$b)},K$g(0,K$c,"cmds",function(){return this._cmds},function(K$c){this._sp&&(this._sp._renderType|=512),this._cmds=K$c,this._render=this._renderAll,this._repaint()}),K$k.__init__=function(){if(K$C.isConchNode){for(var K$c=laya.display.Graphics.prototype,K$P=K$s.window.ConchGraphics.prototype,K$q=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],K$_=0,K$E=K$q.length;K$_<=K$E;K$_++){var K$b=K$q[K$_];K$c[K$b]=K$P[K$b]}K$c._saveToCmd=null,K$P.drawImageS&&(K$c.drawTextures=function(K$c,K$P){if(K$c&&K$c.loaded&&K$c.bitmap&&K$c.source){var K$q=K$c.uv,K$_=K$c.bitmap.width,K$E=K$c.bitmap.height;this.drawImageS(K$c.bitmap.source,K$q[0]*K$_,K$q[1]*K$E,(K$q[2]-K$q[0])*K$_,(K$q[5]-K$q[3])*K$E,K$c.offsetX,K$c.offsetY,K$c.width,K$c.height,K$P)}}),K$c.drawTexture=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){if(void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=0),void 0===K$E&&(K$E=0),void 0===K$e&&(K$e=1),K$c)if(K$c.loaded){if(K$c.loaded&&K$c.bitmap&&K$c.source&&(K$_||(K$_=K$c.sourceWidth),K$E||(K$E=K$c.sourceHeight),K$e=K$e<0?0:1<K$e?1:K$e,K$_=K$_-K$c.sourceWidth+K$c.width,K$E=K$E-K$c.sourceHeight+K$c.height,!(K$_<=0||K$E<=0))){K$P+=K$c.offsetX,K$q+=K$c.offsetY;var K$h=K$c.uv,K$Z=K$c.bitmap.width,K$S=K$c.bitmap.height;K$h[4]<K$h[0]&&K$h[5]<K$h[1]?this.drawImageM(K$c.bitmap.source,K$h[4]*K$Z,K$h[5]*K$S,(K$h[0]-K$h[4])*K$Z,(K$h[1]-K$h[5])*K$S,K$P,K$q,K$_,K$E,K$b,K$e):this.drawImageM(K$c.bitmap.source,K$h[0]*K$Z,K$h[1]*K$S,(K$h[2]-K$h[0])*K$Z,(K$h[5]-K$h[3])*K$S,K$P,K$q,K$_,K$E,K$b,K$e),this._repaint()}}else K$c.once("loaded",this,function(){this.drawTexture(K$c,K$P,K$q,K$_,K$E,K$b)})},K$c.fillTexture=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){if(void 0===K$_&&(K$_=0),void 0===K$E&&(K$E=0),void 0===K$b&&(K$b="repeat"),K$c&&K$c.loaded){var K$h,K$Z=K$C._context.ctx,K$S=K$c.bitmap.width,K$n=K$c.bitmap.height,K$k=K$c.uv;K$h=K$c.uv!=K$nc.DEF_UV?K$Z.createPattern(K$c.bitmap.source,K$b,K$k[0]*K$S,K$k[1]*K$n,(K$k[2]-K$k[0])*K$S,(K$k[5]-K$k[3])*K$n):K$Z.createPattern(K$c.bitmap.source,K$b);var K$x=0,K$r=0;K$e&&(K$P+=K$e.x%K$c.width,K$q+=K$e.y%K$c.height,K$x-=K$e.x%K$c.width,K$r-=K$e.y%K$c.height),this._fillImage(K$h,K$P,K$q,K$x,K$r,K$_,K$E)}}}},K$k._cache=[],K$k}(),K$q=function(){function K$m(){this._cacheBoundsType=!1}K$n(K$m,"laya.display.GraphicsBounds");var K$c=K$m.prototype;return K$c.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},K$c.reset=function(){this._temp&&(this._temp.length=0)},K$c.getBounds=function(K$c){return void 0===K$c&&(K$c=!1),(!this._bounds||!this._temp||this._temp.length<1||K$c!=this._cacheBoundsType)&&(this._bounds=K$d._getWrapRec(this.getBoundPoints(K$c),this._bounds)),this._cacheBoundsType=K$c,this._bounds},K$c.getBoundPoints=function(K$c){return void 0===K$c&&(K$c=!1),(!this._temp||this._temp.length<1||K$c!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(K$c)),this._cacheBoundsType=K$c,this._rstBoundPoints=K$p.copyArray(this._rstBoundPoints,this._temp)},K$c._getCmdPoints=function(K$c){void 0===K$c&&(K$c=!1);var K$P,K$q,K$_=K$C._context,K$E=this._graphics.cmds;if((K$P=this._temp||(this._temp=[])).length=0,K$E||null==this._graphics._one||(K$m._tempCmds.length=0,K$m._tempCmds.push(this._graphics._one),K$E=K$m._tempCmds),!K$E)return K$P;(K$q=K$m._tempMatrixArrays).length=0;var K$b=K$m._initMatrix;K$b.identity();for(var K$e,K$h,K$Z=K$m._tempMatrix,K$S=NaN,K$n=NaN,K$k=NaN,K$x=NaN,K$r=NaN,K$g=NaN,K$W=0,K$w=K$E.length;K$W<K$w;K$W++)if((K$e=K$E[K$W]).callee)switch(K$e.callee){case K$_._save:case 7:K$q.push(K$b),K$b=K$b.clone();break;case K$_._restore:case 8:K$b=K$q.pop();break;case K$_._scale:case 5:K$Z.identity(),K$Z.translate(-K$e[2],-K$e[3]),K$Z.scale(K$e[0],K$e[1]),K$Z.translate(K$e[2],K$e[3]),this._switchMatrix(K$b,K$Z);break;case K$_._rotate:case 3:K$Z.identity(),K$Z.translate(-K$e[1],-K$e[2]),K$Z.rotate(K$e[0]),K$Z.translate(K$e[1],K$e[2]),this._switchMatrix(K$b,K$Z);break;case K$_._translate:case 6:K$Z.identity(),K$Z.translate(K$e[0],K$e[1]),this._switchMatrix(K$b,K$Z);break;case K$_._transform:case 4:K$Z.identity(),K$Z.translate(-K$e[1],-K$e[2]),K$Z.concat(K$e[0]),K$Z.translate(K$e[1],K$e[2]),this._switchMatrix(K$b,K$Z);break;case 16:case 24:K$m._addPointArrToRst(K$P,K$d._getBoundPointS(K$e[0],K$e[1],K$e[2],K$e[3]),K$b);break;case 17:K$b.copyTo(K$Z),K$Z.concat(K$e[4]),K$m._addPointArrToRst(K$P,K$d._getBoundPointS(K$e[0],K$e[1],K$e[2],K$e[3]),K$Z);break;case K$_._drawTexture:K$h=K$e[0],K$c?K$e[3]&&K$e[4]?K$m._addPointArrToRst(K$P,K$d._getBoundPointS(K$e[1],K$e[2],K$e[3],K$e[4]),K$b):(K$h=K$e[0],K$m._addPointArrToRst(K$P,K$d._getBoundPointS(K$e[1],K$e[2],K$h.width,K$h.height),K$b)):(K$S=(K$e[3]||K$h.sourceWidth)/K$h.width,K$n=(K$e[4]||K$h.sourceHeight)/K$h.height,K$k=K$S*K$h.sourceWidth,K$x=K$n*K$h.sourceHeight,K$r=0<K$h.offsetX?K$h.offsetX:0,K$g=0<K$h.offsetY?K$h.offsetY:0,K$r*=K$S,K$g*=K$n,K$m._addPointArrToRst(K$P,K$d._getBoundPointS(K$e[1]-K$r,K$e[2]-K$g,K$k,K$x),K$b));break;case K$_._fillTexture:K$e[3]&&K$e[4]?K$m._addPointArrToRst(K$P,K$d._getBoundPointS(K$e[1],K$e[2],K$e[3],K$e[4]),K$b):(K$h=K$e[0],K$m._addPointArrToRst(K$P,K$d._getBoundPointS(K$e[1],K$e[2],K$h.width,K$h.height),K$b));break;case K$_._drawTextureWithTransform:var K$O;K$O=K$e[5]?(K$b.copyTo(K$Z),K$Z.concat(K$e[5]),K$Z):K$b,K$c?K$e[3]&&K$e[4]?K$m._addPointArrToRst(K$P,K$d._getBoundPointS(K$e[1],K$e[2],K$e[3],K$e[4]),K$O):(K$h=K$e[0],K$m._addPointArrToRst(K$P,K$d._getBoundPointS(K$e[1],K$e[2],K$h.width,K$h.height),K$O)):(K$h=K$e[0],K$S=(K$e[3]||K$h.sourceWidth)/K$h.width,K$n=(K$e[4]||K$h.sourceHeight)/K$h.height,K$k=K$S*K$h.sourceWidth,K$x=K$n*K$h.sourceHeight,K$r=0<K$h.offsetX?K$h.offsetX:0,K$g=0<K$h.offsetY?K$h.offsetY:0,K$r*=K$S,K$g*=K$n,K$m._addPointArrToRst(K$P,K$d._getBoundPointS(K$e[1]-K$r,K$e[2]-K$g,K$k,K$x),K$O));break;case K$_._drawRect:case 13:K$m._addPointArrToRst(K$P,K$d._getBoundPointS(K$e[0],K$e[1],K$e[2],K$e[3]),K$b);break;case K$_._drawCircle:case K$_._fillCircle:case 14:K$m._addPointArrToRst(K$P,K$d._getBoundPointS(K$e[0]-K$e[2],K$e[1]-K$e[2],K$e[2]+K$e[2],K$e[2]+K$e[2]),K$b);break;case K$_._drawLine:case 20:K$m._tempPoints.length=0;var K$N;K$N=.5*K$e[5],K$e[0]==K$e[2]?K$m._tempPoints.push(K$e[0]+K$N,K$e[1],K$e[2]+K$N,K$e[3],K$e[0]-K$N,K$e[1],K$e[2]-K$N,K$e[3]):K$e[1]==K$e[3]?K$m._tempPoints.push(K$e[0],K$e[1]+K$N,K$e[2],K$e[3]+K$N,K$e[0],K$e[1]-K$N,K$e[2],K$e[3]-K$N):K$m._tempPoints.push(K$e[0],K$e[1],K$e[2],K$e[3]),K$m._addPointArrToRst(K$P,K$m._tempPoints,K$b);break;case K$_._drawCurves:case 22:K$m._addPointArrToRst(K$P,K$T.I.getBezierPoints(K$e[2]),K$b,K$e[0],K$e[1]);break;case K$_._drawPoly:case K$_._drawLines:case 18:K$m._addPointArrToRst(K$P,K$e[2],K$b,K$e[0],K$e[1]);break;case K$_._drawPath:case 19:K$m._addPointArrToRst(K$P,this._getPathPoints(K$e[2]),K$b,K$e[0],K$e[1]);break;case K$_._drawPie:case 15:K$m._addPointArrToRst(K$P,this._getPiePoints(K$e[0],K$e[1],K$e[2],K$e[3],K$e[4]),K$b)}return 200<K$P.length?K$P=K$p.copyArray(K$P,K$d._getWrapRec(K$P)._getBoundPoints()):8<K$P.length&&(K$P=K$D.scanPList(K$P)),K$P},K$c._switchMatrix=function(K$c,K$P){K$P.concat(K$c),K$P.copyTo(K$c)},K$c._getPiePoints=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$m._tempPoints;K$m._tempPoints.length=0,K$b.push(K$c,K$P);var K$e=(K$E-K$_)%(2*Math.PI)/10,K$h=NaN,K$Z=K$_;for(K$h=0;K$h<=10;K$h++)K$b.push(K$c+K$q*Math.cos(K$Z),K$P+K$q*Math.sin(K$Z)),K$Z+=K$e;return K$b},K$c._getPathPoints=function(K$c){var K$P,K$q,K$_=0,K$E=K$m._tempPoints;for(K$E.length=0,K$P=K$c.length,K$_=0;K$_<K$P;K$_++)1<(K$q=K$c[K$_]).length&&(K$E.push(K$q[1],K$q[2]),3<K$q.length&&K$E.push(K$q[3],K$q[4]));return K$E},K$m._addPointArrToRst=function(K$c,K$P,K$q,K$_,K$E){void 0===K$_&&(K$_=0),void 0===K$E&&(K$E=0);var K$b,K$e=0;for(K$b=K$P.length,K$e=0;K$e<K$b;K$e+=2)K$m._addPointToRst(K$c,K$P[K$e]+K$_,K$P[K$e+1]+K$E,K$q)},K$m._addPointToRst=function(K$c,K$P,K$q,K$_){var K$E=K$Q.TEMP;K$E.setTo(K$P||0,K$q||0),K$_.transformPoint(K$E),K$c.push(K$E.x,K$E.y)},K$m._tempPoints=[],K$m._tempMatrixArrays=[],K$m._tempCmds=[],K$Z(K$m,["_tempMatrix",function(){return this._tempMatrix=new K$V},"_initMatrix",function(){return this._initMatrix=new K$V}]),K$m}(),K$b=function(){function K$c(){}K$n(K$c,"laya.events.Event");var K$P=K$c.prototype;return K$P.setTo=function(K$c,K$P,K$q){return this.type=K$c,this.currentTarget=K$P,this.target=K$q,this},K$P.stopPropagation=function(){this._stoped=!0},K$g(0,K$P,"stageY",function(){return K$H.stage.mouseY}),K$g(0,K$P,"charCode",function(){return this.nativeEvent.charCode}),K$g(0,K$P,"touches",function(){var K$c=this.nativeEvent.touches;if(K$c)for(var K$P=K$H.stage,K$q=0,K$_=K$c.length;K$q<K$_;K$q++){var K$E=K$c[K$q],K$b=K$Q.TEMP;K$b.setTo(K$E.clientX,K$E.clientY),K$P._canvasTransform.invertTransformPoint(K$b),K$P.transform.invertTransformPoint(K$b),K$E.stageX=K$b.x,K$E.stageY=K$b.y}return K$c}),K$g(0,K$P,"keyLocation",function(){return this.nativeEvent.keyLocation}),K$g(0,K$P,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),K$g(0,K$P,"altKey",function(){return this.nativeEvent.altKey}),K$g(0,K$P,"shiftKey",function(){return this.nativeEvent.shiftKey}),K$g(0,K$P,"stageX",function(){return K$H.stage.mouseX}),K$c.EMPTY=new K$c,K$c.MOUSE_DOWN="mousedown",K$c.MOUSE_UP="mouseup",K$c.CLICK="click",K$c.RIGHT_MOUSE_DOWN="rightmousedown",K$c.RIGHT_MOUSE_UP="rightmouseup",K$c.RIGHT_CLICK="rightclick",K$c.MOUSE_MOVE="mousemove",K$c.MOUSE_OVER="mouseover",K$c.MOUSE_OUT="mouseout",K$c.MOUSE_WHEEL="mousewheel",K$c.ROLL_OVER="mouseover",K$c.ROLL_OUT="mouseout",K$c.DOUBLE_CLICK="doubleclick",K$c.CHANGE="change",K$c.CHANGED="changed",K$c.RESIZE="resize",K$c.ADDED="added",K$c.REMOVED="removed",K$c.DISPLAY="display",K$c.UNDISPLAY="undisplay",K$c.ERROR="error",K$c.COMPLETE="complete",K$c.LOADED="loaded",K$c.INITED="inited",K$c.PROGRESS="progress",K$c.INPUT="input",K$c.RENDER="render",K$c.OPEN="open",K$c.MESSAGE="message",K$c.CLOSE="close",K$c.KEY_DOWN="keydown",K$c.KEY_PRESS="keypress",K$c.KEY_UP="keyup",K$c.FRAME="enterframe",K$c.DRAG_START="dragstart",K$c.DRAG_MOVE="dragmove",K$c.DRAG_END="dragend",K$c.ENTER="enter",K$c.SELECT="select",K$c.BLUR="blur",K$c.FOCUS="focus",K$c.VISIBILITY_CHANGE="visibilitychange",K$c.FOCUS_CHANGE="focuschange",K$c.PLAYED="played",K$c.PAUSED="paused",K$c.STOPPED="stopped",K$c.START="start",K$c.END="end",K$c.ENABLE_CHANGED="enablechanged",K$c.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",K$c.COMPONENT_ADDED="componentadded",K$c.COMPONENT_REMOVED="componentremoved",K$c.LAYER_CHANGED="layerchanged",K$c.HIERARCHY_LOADED="hierarchyloaded",K$c.RECOVERED="recovered",K$c.RELEASED="released",K$c.LINK="link",K$c.LABEL="label",K$c.FULL_SCREEN_CHANGE="fullscreenchange",K$c.DEVICE_LOST="devicelost",K$c.MESH_CHANGED="meshchanged",K$c.MATERIAL_CHANGED="materialchanged",K$c.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",K$c.ANIMATION_CHANGED="animationchanged",K$c.TRIGGER_ENTER="triggerenter",K$c.TRIGGER_STAY="triggerstay",K$c.TRIGGER_EXIT="triggerexit",K$c.TRAIL_FILTER_CHANGE="trailfilterchange",K$c.DOMINO_FILTER_CHANGE="dominofilterchange",K$c}(),K$k=(function(){function K$c(){}K$n(K$c,"laya.events.Keyboard"),K$c.NUMBER_0=48,K$c.NUMBER_1=49,K$c.NUMBER_2=50,K$c.NUMBER_3=51,K$c.NUMBER_4=52,K$c.NUMBER_5=53,K$c.NUMBER_6=54,K$c.NUMBER_7=55,K$c.NUMBER_8=56,K$c.NUMBER_9=57,K$c.A=65,K$c.B=66,K$c.C=67,K$c.D=68,K$c.E=69,K$c.F=70,K$c.G=71,K$c.H=72,K$c.I=73,K$c.J=74,K$c.K=75,K$c.L=76,K$c.M=77,K$c.N=78,K$c.O=79,K$c.P=80,K$c.Q=81,K$c.R=82,K$c.S=83,K$c.T=84,K$c.U=85,K$c.V=86,K$c.W=87,K$c.X=88,K$c.Y=89,K$c.Z=90,K$c.F1=112,K$c.F2=113,K$c.F3=114,K$c.F4=115,K$c.F5=116,K$c.F6=117,K$c.F7=118,K$c.F8=119,K$c.F9=120,K$c.F10=121,K$c.F11=122,K$c.F12=123,K$c.F13=124,K$c.F14=125,K$c.F15=126,K$c.NUMPAD=21,K$c.NUMPAD_0=96,K$c.NUMPAD_1=97,K$c.NUMPAD_2=98,K$c.NUMPAD_3=99,K$c.NUMPAD_4=100,K$c.NUMPAD_5=101,K$c.NUMPAD_6=102,K$c.NUMPAD_7=103,K$c.NUMPAD_8=104,K$c.NUMPAD_9=105,K$c.NUMPAD_ADD=107,K$c.NUMPAD_DECIMAL=110,K$c.NUMPAD_DIVIDE=111,K$c.NUMPAD_ENTER=108,K$c.NUMPAD_MULTIPLY=106,K$c.NUMPAD_SUBTRACT=109,K$c.SEMICOLON=186,K$c.EQUAL=187,K$c.COMMA=188,K$c.MINUS=189,K$c.PERIOD=190,K$c.SLASH=191,K$c.BACKQUOTE=192,K$c.LEFTBRACKET=219,K$c.BACKSLASH=220,K$c.RIGHTBRACKET=221,K$c.QUOTE=222,K$c.ALTERNATE=18,K$c.BACKSPACE=8,K$c.CAPS_LOCK=20,K$c.COMMAND=15,K$c.CONTROL=17,K$c.DELETE=46,K$c.ENTER=13,K$c.ESCAPE=27,K$c.PAGE_UP=33,K$c.PAGE_DOWN=34,K$c.END=35,K$c.HOME=36,K$c.LEFT=37,K$c.UP=38,K$c.RIGHT=39,K$c.DOWN=40,K$c.SHIFT=16,K$c.SPACE=32,K$c.TAB=9,K$c.INSERT=45}(),function(){function K$E(){}return K$n(K$E,"laya.events.KeyBoardManager"),K$E.__init__=function(){K$E._addEvent("keydown"),K$E._addEvent("keypress"),K$E._addEvent("keyup")},K$E._addEvent=function(K$P){K$s.document.addEventListener(K$P,function(K$c){laya.events.KeyBoardManager._dispatch(K$c,K$P)},!0)},K$E._dispatch=function(K$c,K$P){if(K$E.enabled){K$E._event._stoped=!1,K$E._event.nativeEvent=K$c,K$E._event.keyCode=K$c.keyCode||K$c.which||K$c.charCode,"keydown"===K$P?K$E._pressKeys[K$E._event.keyCode]=!0:"keyup"===K$P&&(K$E._pressKeys[K$E._event.keyCode]=null);for(var K$q=K$H.stage.focus&&null!=K$H.stage.focus.event&&K$H.stage.focus.displayedInStage?K$H.stage.focus:K$H.stage,K$_=K$q;K$_;)K$_.event(K$P,K$E._event.setTo(K$P,K$_,K$q)),K$_=K$_.parent}},K$E.hasKeyDown=function(K$c){return K$E._pressKeys[K$c]},K$E._pressKeys={},K$E.enabled=!0,K$Z(K$E,["_event",function(){return this._event=new K$b}]),K$E}()),K$W=(function(){function K$c(){}K$n(K$c,"laya.events.KeyLocation"),K$c.STANDARD=0,K$c.LEFT=1,K$c.RIGHT=2,K$c.NUM_PAD=3}(),function(){function K$S(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=K$s.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new K$b,this._matrix=new K$V,this._point=new K$Q,this._rect=new K$d,this._prePoint=new K$Q,this._curTouchID=NaN}K$n(K$S,"laya.events.MouseManager");var K$c=K$S.prototype;return K$c.__init__=function(K$c,K$P){var K$q=this;this._stage=K$c;var K$_=this,K$E=this._eventList;K$P.oncontextmenu=function(K$c){if(K$S.enabled)return!1},K$P.addEventListener("mousedown",function(K$c){K$S.enabled&&(K$s.onIE||K$c.preventDefault(),K$E.push(K$c),K$_.mouseDownTime=K$s.now())}),K$P.addEventListener("mouseup",function(K$c){K$S.enabled&&(K$c.preventDefault(),K$E.push(K$c),K$_.mouseDownTime=-K$s.now())},!0),K$P.addEventListener("mousemove",function(K$c){if(K$S.enabled){K$c.preventDefault();var K$P=K$s.now();if(K$P-K$_._lastMoveTimer<10)return;K$_._lastMoveTimer=K$P,K$E.push(K$c)}},!0),K$P.addEventListener("mouseout",function(K$c){K$S.enabled&&K$E.push(K$c)}),K$P.addEventListener("mouseover",function(K$c){K$S.enabled&&K$E.push(K$c)}),K$P.addEventListener("touchstart",function(K$c){K$S.enabled&&(K$E.push(K$c),K$S._isFirstTouch||K$Dc.isInputting||K$c.preventDefault(),K$_.mouseDownTime=K$s.now())}),K$P.addEventListener("touchend",function(K$c){K$S.enabled?(K$S._isFirstTouch||K$Dc.isInputting||K$c.preventDefault(),K$S._isFirstTouch=!1,K$E.push(K$c),K$_.mouseDownTime=-K$s.now()):K$q._curTouchID=NaN},!0),K$P.addEventListener("touchmove",function(K$c){K$S.enabled&&(K$c.preventDefault(),K$E.push(K$c))},!0),K$P.addEventListener("touchcancel",function(K$c){K$S.enabled?(K$c.preventDefault(),K$E.push(K$c)):K$q._curTouchID=NaN},!0),K$P.addEventListener("mousewheel",function(K$c){K$S.enabled&&K$E.push(K$c)}),K$P.addEventListener("DOMMouseScroll",function(K$c){K$S.enabled&&K$E.push(K$c)})},K$c.initEvent=function(K$c,K$P){var K$q;this._event._stoped=!1,this._event.nativeEvent=K$P||K$c,this._target=null,this._point.setTo(K$c.pageX||K$c.clientX,K$c.pageY||K$c.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=K$c.identifier||0,this._tTouchID=this._event.touchId,(K$q=K$w.I._event)._stoped=!1,K$q.nativeEvent=this._event.nativeEvent,K$q.touchId=this._event.touchId},K$c.checkMouseWheel=function(K$c){this._event.delta=K$c.wheelDelta?.025*K$c.wheelDelta:-K$c.detail;for(var K$P=K$w.I.getLastOvers(),K$q=0,K$_=K$P.length;K$q<K$_;K$q++){var K$E=K$P[K$q];K$E.event("mousewheel",this._event.setTo("mousewheel",K$E,this._target))}},K$c.onMouseMove=function(K$c){K$w.I.onMouseMove(K$c,this._tTouchID)},K$c.onMouseDown=function(K$c){if(K$Dc.isInputting&&K$H.stage.focus&&K$H.stage.focus.focus&&!K$H.stage.focus.contains(this._target)){var K$P=K$H.stage.focus._tf||K$H.stage.focus,K$q=K$c._tf||K$c;K$q instanceof laya.display.Input&&K$q.multiline==K$P.multiline?K$P._focusOut():K$P.focus=!1}K$w.I.onMouseDown(K$c,this._tTouchID,this._isLeftMouse)},K$c.onMouseUp=function(K$c){K$w.I.onMouseUp(K$c,this._tTouchID,this._isLeftMouse)},K$c.check=function(K$c,K$P,K$q,K$_){this._point.setTo(K$P,K$q),K$c.fromParentPoint(this._point),K$P=this._point.x,K$q=this._point.y;var K$E=K$c.scrollRect;if(K$E&&(this._rect.setTo(K$E.x,K$E.y,K$E.width,K$E.height),!this._rect.contains(K$P,K$q)))return!1;if(!this.disableMouseEvent){if(K$c.hitTestPrior&&!K$c.mouseThrough&&!this.hitTest(K$c,K$P,K$q))return!1;for(var K$b=K$c._childs.length-1;-1<K$b;K$b--){var K$e=K$c._childs[K$b];if(!K$e.destroyed&&K$e.mouseEnabled&&K$e.visible&&this.check(K$e,K$P,K$q,K$_))return!0}}var K$h=!(!K$c.hitTestPrior||K$c.mouseThrough||this.disableMouseEvent)||this.hitTest(K$c,K$P,K$q);return K$h?(this._target=K$c,K$_.call(this,K$c)):K$_===this.onMouseUp&&K$c===this._stage&&(this._target=this._stage,K$_.call(this,this._target)),K$h},K$c.hitTest=function(K$c,K$P,K$q){var K$_=!1;if(K$c.scrollRect&&(K$P-=K$c.scrollRect.x,K$q-=K$c.scrollRect.y),K$c.hitArea instanceof laya.utils.HitArea)return K$c.hitArea.isHit(K$P,K$q);if(0<K$c.width&&0<K$c.height||K$c.mouseThrough||K$c.hitArea)if(K$c.mouseThrough)K$_=K$c.getGraphicBounds().contains(K$P,K$q);else{var K$E=this._rect;K$c.hitArea?K$E=K$c.hitArea:K$E.setTo(0,0,K$c.width,K$c.height),K$_=K$E.contains(K$P,K$q)}return K$_},K$c.runEvent=function(){var K$c=this._eventList.length;if(K$c){this.mouseEventTime=K$s.now();var K$P,K$q=0,K$_=0,K$E=0;try{for(;K$q<K$c;){var K$b=this._eventList[K$q];switch("mousemove"!==K$b.type&&(this._prePoint.x=this._prePoint.y=-1e6),K$b.type){case"mousedown":this._touchIDs[0]=this._id++,K$S._isTouchRespond?K$S._isTouchRespond=!1:(this._isLeftMouse=0===K$b.button,this.initEvent(K$b),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===K$b.button,this.initEvent(K$b),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-K$b.clientX)+Math.abs(this._prePoint.y-K$b.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=K$b.clientX,this._prePoint.y=K$b.clientY,this.initEvent(K$b),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":K$S._isTouchRespond=!0,this._isLeftMouse=!0;var K$e=K$b.changedTouches;for(K$_=0,K$E=K$e.length;K$_<K$E;K$_++)K$P=K$e[K$_],(K$S.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=K$P.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[K$P.identifier]=this._id++,this.initEvent(K$P,K$b),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":K$S._isTouchRespond=!0,this._isLeftMouse=!0;var K$h=K$b.changedTouches;for(K$_=0,K$E=K$h.length;K$_<K$E;K$_++)if(K$P=K$h[K$_],K$S.multiTouchEnabled||K$P.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(K$P,K$b);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var K$Z=K$b.changedTouches;for(K$_=0,K$E=K$Z.length;K$_<K$E;K$_++)K$P=K$Z[K$_],(K$S.multiTouchEnabled||K$P.identifier==this._curTouchID)&&(this.initEvent(K$P,K$b),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(K$b);break;case"mouseout":K$w.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}K$q++}}catch(K$c){throw this._eventList.length=0,K$c}this._eventList.length=0}},K$S.enabled=!0,K$S.multiTouchEnabled=!0,K$S._isTouchRespond=!1,K$S._isFirstTouch=!0,K$Z(K$S,["instance",function(){return this.instance=new K$S}]),K$S}()),K$w=function(){function K$g(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new K$b}K$n(K$g,"laya.events.TouchManager");var K$c=K$g.prototype;return K$c._clearTempArrs=function(){K$g._oldArr.length=0,K$g._newArr.length=0,K$g._tEleArr.length=0},K$c.getTouchFromArr=function(K$c,K$P){var K$q,K$_,K$E=0;for(K$q=K$P.length,K$E=0;K$E<K$q;K$E++)if((K$_=K$P[K$E]).id==K$c)return K$_;return null},K$c.removeTouchFromArr=function(K$c,K$P){var K$q=0;for(K$q=K$P.length-1;0<=K$q;K$q--)K$P[K$q].id==K$c&&K$P.splice(K$q,1)},K$c.createTouchO=function(K$c,K$P){var K$q;return(K$q=K$f.getItem("TouchData")||{}).id=K$P,K$q.tar=K$c,K$q},K$c.onMouseDown=function(K$c,K$P,K$q){var K$_,K$E,K$b,K$e;(void 0===K$q&&(K$q=!1),this.enable)&&(K$_=this.getTouchFromArr(K$P,this.preOvers),K$b=this.getEles(K$c,null,K$g._tEleArr),K$_?K$_.tar=K$c:(K$E=this.createTouchO(K$c,K$P),this.preOvers.push(K$E)),K$s.onMobile&&this.sendEvents(K$b,"mouseover",K$P),K$e=K$q?this.preDowns:this.preRightDowns,(K$_=this.getTouchFromArr(K$P,K$e))?K$_.tar=K$c:(K$E=this.createTouchO(K$c,K$P),K$e.push(K$E)),this.sendEvents(K$b,K$q?"mousedown":"rightmousedown",K$P),this._clearTempArrs())},K$c.sendEvents=function(K$c,K$P,K$q){void 0===K$q&&(K$q=0);var K$_,K$E,K$b,K$e=0;for(K$_=K$c.length,this._event._stoped=!1,K$E=K$c[0],K$e=0;K$e<K$_;K$e++){if((K$b=K$c[K$e]).destroyed)return;if(K$b.event(K$P,this._event.setTo(K$P,K$b,K$E)),this._event._stoped)break}},K$c.getEles=function(K$c,K$P,K$q){for(K$q?K$q.length=0:K$q=[];K$c&&K$c!=K$P;)K$q.push(K$c),K$c=K$c.parent;return K$q},K$c.checkMouseOutAndOverOfMove=function(K$c,K$P,K$q){if(void 0===K$q&&(K$q=0),K$P!=K$c){var K$_,K$E,K$b=0,K$e=0;if(K$P.contains(K$c))K$E=this.getEles(K$c,K$P,K$g._tEleArr),this.sendEvents(K$E,"mouseover",K$q);else if(K$c.contains(K$P))K$E=this.getEles(K$P,K$c,K$g._tEleArr),this.sendEvents(K$E,"mouseout",K$q);else{var K$h,K$Z;(K$E=K$g._tEleArr).length=0,K$h=this.getEles(K$P,null,K$g._oldArr),K$Z=this.getEles(K$c,null,K$g._newArr),K$e=K$h.length;var K$S=0;for(K$b=0;K$b<K$e;K$b++){if(K$_=K$h[K$b],0<=(K$S=K$Z.indexOf(K$_))){K$Z.splice(K$S,K$Z.length-K$S);break}K$E.push(K$_)}0<K$E.length&&this.sendEvents(K$E,"mouseout",K$q),0<K$Z.length&&this.sendEvents(K$Z,"mouseover",K$q)}}},K$c.onMouseMove=function(K$c,K$P){var K$q,K$_;this.enable&&((K$q=this.getTouchFromArr(K$P,this.preOvers))?(this.checkMouseOutAndOverOfMove(K$c,K$q.tar),K$q.tar=K$c,K$_=this.getEles(K$c,null,K$g._tEleArr)):(K$_=this.getEles(K$c,null,K$g._tEleArr),this.sendEvents(K$_,"mouseover",K$P),this.preOvers.push(this.createTouchO(K$c,K$P))),this.sendEvents(K$_,"mousemove",K$P),this._clearTempArrs())},K$c.getLastOvers=function(){return(K$g._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,K$g._tEleArr):(K$g._tEleArr.push(K$H.stage),K$g._tEleArr)},K$c.stageMouseOut=function(){var K$c;K$c=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(K$c,"mouseout",0)},K$c.onMouseUp=function(K$c,K$P,K$q){if(void 0===K$q&&(K$q=!1),this.enable){var K$_,K$E,K$b,K$e,K$h,K$Z,K$S=0,K$n=0,K$k=K$s.onMobile;if(K$E=this.getEles(K$c,null,K$g._tEleArr),this.sendEvents(K$E,K$q?"mouseup":"rightmouseup",K$P),K$Z=K$q?this.preDowns:this.preRightDowns,K$_=this.getTouchFromArr(K$P,K$Z)){var K$x,K$r=K$s.now();if(K$x=K$r-this._lastClickTime<300,this._lastClickTime=K$r,K$c==K$_.tar)K$h=K$E;else for(K$b=this.getEles(K$_.tar,null,K$g._oldArr),(K$h=K$g._newArr).length=0,K$n=K$b.length,K$S=0;K$S<K$n;K$S++)K$e=K$b[K$S],0<=K$E.indexOf(K$e)&&K$h.push(K$e);0<K$h.length&&this.sendEvents(K$h,K$q?"click":"rightclick",K$P),K$q&&K$x&&this.sendEvents(K$h,"doubleclick",K$P),this.removeTouchFromArr(K$P,K$Z),K$_.tar=null,K$f.recover("TouchData",K$_)}else;(K$_=this.getTouchFromArr(K$P,this.preOvers))&&K$k&&((K$h=this.getEles(K$_.tar,null,K$h))&&0<K$h.length&&this.sendEvents(K$h,"mouseout",K$P),this.removeTouchFromArr(K$P,this.preOvers),K$_.tar=null,K$f.recover("TouchData",K$_)),this._clearTempArrs()}},K$g._oldArr=[],K$g._newArr=[],K$g._tEleArr=[],K$Z(K$g,["I",function(){return this.I=new K$g}]),K$g}(),K$O=function(){function K$c(){this._action=null}K$n(K$c,"laya.filters.Filter");var K$P=K$c.prototype;return K$H.imps(K$P,{"laya.filters.IFilter":!0}),K$P.callNative=function(K$c){},K$g(0,K$P,"type",function(){return-1}),K$g(0,K$P,"action",function(){return this._action}),K$c.BLUR=16,K$c.COLOR=32,K$c.GLOW=8,K$c._filterStart=null,K$c._filterEnd=null,K$c._EndTarget=null,K$c._recycleScope=null,K$c._filter=null,K$c._useSrc=null,K$c._endSrc=null,K$c._useOut=null,K$c._endOut=null,K$c}(),K$m=function(){function K$c(){this.data=null}K$n(K$c,"laya.filters.ColorFilterAction");var K$P=K$c.prototype;return K$H.imps(K$P,{"laya.filters.IFilterAction":!0}),K$P.apply=function(K$c){var K$P=K$c.ctx.ctx,K$q=K$c.ctx.ctx.canvas;if(0==K$q.width||0==K$q.height)return K$q;for(var K$_,K$E=K$P.getImageData(0,0,K$q.width,K$q.height),K$b=K$E.data,K$e=0,K$h=K$b.length;K$e<K$h;K$e+=4)K$_=this.getColor(K$b[K$e],K$b[K$e+1],K$b[K$e+2],K$b[K$e+3]),0!=K$b[K$e+3]&&(K$b[K$e]=K$_[0],K$b[K$e+1]=K$_[1],K$b[K$e+2]=K$_[2],K$b[K$e+3]=K$_[3]);return K$P.putImageData(K$E,0,0),K$c},K$P.getColor=function(K$c,K$P,K$q,K$_){var K$E=[];if(this.data._mat&&this.data._alpha){var K$b=this.data._mat,K$e=this.data._alpha;K$E[0]=K$b[0]*K$c+K$b[1]*K$P+K$b[2]*K$q+K$b[3]*K$_+K$e[0],K$E[1]=K$b[4]*K$c+K$b[5]*K$P+K$b[6]*K$q+K$b[7]*K$_+K$e[1],K$E[2]=K$b[8]*K$c+K$b[9]*K$P+K$b[10]*K$q+K$b[11]*K$_+K$e[2],K$E[3]=K$b[12]*K$c+K$b[13]*K$P+K$b[14]*K$q+K$b[15]*K$_+K$e[3]}return K$E},K$c}(),K$T=(function(){function K$c(){}K$n(K$c,"laya.maths.Arith"),K$c.formatR=function(K$c){return K$c>Math.PI&&(K$c-=2*Math.PI),K$c<-Math.PI&&(K$c+=2*Math.PI),K$c},K$c.isPOT=function(K$c,K$P){return 0<K$c&&0==(K$c&K$c-1)&&0<K$P&&0==(K$P&K$P-1)},K$c.setMatToArray=function(K$c,K$P){K$c.a,K$c.b,K$c.c,K$c.d,K$c.tx,K$c.ty,K$P[0]=K$c.a,K$P[1]=K$c.b,K$P[4]=K$c.c,K$P[5]=K$c.d,K$P[12]=K$c.tx,K$P[13]=K$c.ty}}(),function(){function K$c(){this._controlPoints=[new K$Q,new K$Q,new K$Q],this._calFun=this.getPoint2}K$n(K$c,"laya.maths.Bezier");var K$P=K$c.prototype;return K$P._switchPoint=function(K$c,K$P){var K$q=this._controlPoints.shift();K$q.setTo(K$c,K$P),this._controlPoints.push(K$q)},K$P.getPoint2=function(K$c,K$P){var K$q=this._controlPoints[0],K$_=this._controlPoints[1],K$E=this._controlPoints[2],K$b=Math.pow(1-K$c,2)*K$q.x+2*K$c*(1-K$c)*K$_.x+Math.pow(K$c,2)*K$E.x,K$e=Math.pow(1-K$c,2)*K$q.y+2*K$c*(1-K$c)*K$_.y+Math.pow(K$c,2)*K$E.y;K$P.push(K$b,K$e)},K$P.getPoint3=function(K$c,K$P){var K$q=this._controlPoints[0],K$_=this._controlPoints[1],K$E=this._controlPoints[2],K$b=this._controlPoints[3],K$e=Math.pow(1-K$c,3)*K$q.x+3*K$_.x*K$c*(1-K$c)*(1-K$c)+3*K$E.x*K$c*K$c*(1-K$c)+K$b.x*Math.pow(K$c,3),K$h=Math.pow(1-K$c,3)*K$q.y+3*K$_.y*K$c*(1-K$c)*(1-K$c)+3*K$E.y*K$c*K$c*(1-K$c)+K$b.y*Math.pow(K$c,3);K$P.push(K$e,K$h)},K$P.insertPoints=function(K$c,K$P){var K$q,K$_=NaN;for(K$q=1/(K$c=0<K$c?K$c:5),K$_=0;K$_<=1;K$_+=K$q)this._calFun(K$_,K$P)},K$P.getBezierPoints=function(K$c,K$P,K$q){void 0===K$P&&(K$P=5),void 0===K$q&&(K$q=2);var K$_,K$E,K$b=0;if((K$_=K$c.length)<2*(K$q+1))return[];switch(K$E=[],K$q){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=K$q;)this._controlPoints.push(new K$Q);for(K$b=0;K$b<2*K$q;K$b+=2)this._switchPoint(K$c[K$b],K$c[K$b+1]);for(K$b=2*K$q;K$b<K$_;K$b+=2)this._switchPoint(K$c[K$b],K$c[K$b+1]),K$b/2%K$q==0&&this.insertPoints(K$P,K$E);return K$E},K$Z(K$c,["I",function(){return this.I=new K$c}]),K$c}()),K$D=function(){function K$S(){}return K$n(K$S,"laya.maths.GrahamScan"),K$S.multiply=function(K$c,K$P,K$q){return(K$c.x-K$q.x)*(K$P.y-K$q.y)-(K$P.x-K$q.x)*(K$c.y-K$q.y)},K$S.dis=function(K$c,K$P){return(K$c.x-K$P.x)*(K$c.x-K$P.x)+(K$c.y-K$P.y)*(K$c.y-K$P.y)},K$S._getPoints=function(K$c,K$P,K$q){for(void 0===K$P&&(K$P=!1),K$S._mPointList||(K$S._mPointList=[]);K$S._mPointList.length<K$c;)K$S._mPointList.push(new K$Q);return K$q||(K$q=[]),K$q.length=0,K$P?K$S.getFrom(K$q,K$S._mPointList,K$c):K$S.getFromR(K$q,K$S._mPointList,K$c),K$q},K$S.getFrom=function(K$c,K$P,K$q){var K$_=0;for(K$_=0;K$_<K$q;K$_++)K$c.push(K$P[K$_]);return K$c},K$S.getFromR=function(K$c,K$P,K$q){var K$_=0;for(K$_=0;K$_<K$q;K$_++)K$c.push(K$P.pop());return K$c},K$S.pListToPointList=function(K$c,K$P){void 0===K$P&&(K$P=!1);var K$q=0,K$_=K$c.length/2,K$E=K$S._getPoints(K$_,K$P,K$S._tempPointList);for(K$q=0;K$q<K$_;K$q++)K$E[K$q].setTo(K$c[K$q+K$q],K$c[K$q+K$q+1]);return K$E},K$S.pointListToPlist=function(K$c){var K$P,K$q=0,K$_=K$c.length,K$E=K$S._temPList;for(K$q=K$E.length=0;K$q<K$_;K$q++)K$P=K$c[K$q],K$E.push(K$P.x,K$P.y);return K$E},K$S.scanPList=function(K$c){return K$p.copyArray(K$c,K$S.pointListToPlist(K$S.scan(K$S.pListToPointList(K$c,!0))))},K$S.scan=function(K$c){var K$P,K$q,K$_,K$E=0,K$b=0,K$e=0,K$h=K$c.length,K$Z={};for((K$q=K$S._temArr).length=0,K$E=(K$h=K$c.length)-1;0<=K$E;K$E--)K$_=(K$P=K$c[K$E]).x+"_"+K$P.y,K$Z.hasOwnProperty(K$_)||(K$Z[K$_]=!0,K$q.push(K$P));for(K$h=K$q.length,K$p.copyArray(K$c,K$q),K$E=1;K$E<K$h;K$E++)(K$c[K$E].y<K$c[K$e].y||K$c[K$E].y==K$c[K$e].y&&K$c[K$E].x<K$c[K$e].x)&&(K$e=K$E);for(K$P=K$c[0],K$c[0]=K$c[K$e],K$c[K$e]=K$P,K$E=1;K$E<K$h-1;K$E++){for(K$b=(K$e=K$E)+1;K$b<K$h;K$b++)(0<K$S.multiply(K$c[K$b],K$c[K$e],K$c[0])||0==K$S.multiply(K$c[K$b],K$c[K$e],K$c[0])&&K$S.dis(K$c[0],K$c[K$b])<K$S.dis(K$c[0],K$c[K$e]))&&(K$e=K$b);K$P=K$c[K$E],K$c[K$E]=K$c[K$e],K$c[K$e]=K$P}if((K$q=K$S._temArr).length=0,K$c.length<3)return K$p.copyArray(K$q,K$c);for(K$q.push(K$c[0],K$c[1],K$c[2]),K$E=3;K$E<K$h;K$E++){for(;2<=K$q.length&&0<=K$S.multiply(K$c[K$E],K$q[K$q.length-1],K$q[K$q.length-2]);)K$q.pop();K$c[K$E]&&K$q.push(K$c[K$E])}return K$q},K$S._mPointList=null,K$S._tempPointList=[],K$S._temPList=[],K$S._temArr=[],K$S}(),K$L=function(){function K$E(){}return K$n(K$E,"laya.maths.MathUtil"),K$E.subtractVector3=function(K$c,K$P,K$q){K$q[0]=K$c[0]-K$P[0],K$q[1]=K$c[1]-K$P[1],K$q[2]=K$c[2]-K$P[2]},K$E.lerp=function(K$c,K$P,K$q){return K$c*(1-K$q)+K$P*K$q},K$E.scaleVector3=function(K$c,K$P,K$q){K$q[0]=K$c[0]*K$P,K$q[1]=K$c[1]*K$P,K$q[2]=K$c[2]*K$P},K$E.lerpVector3=function(K$c,K$P,K$q,K$_){var K$E=K$c[0],K$b=K$c[1],K$e=K$c[2];K$_[0]=K$E+K$q*(K$P[0]-K$E),K$_[1]=K$b+K$q*(K$P[1]-K$b),K$_[2]=K$e+K$q*(K$P[2]-K$e)},K$E.lerpVector4=function(K$c,K$P,K$q,K$_){var K$E=K$c[0],K$b=K$c[1],K$e=K$c[2],K$h=K$c[3];K$_[0]=K$E+K$q*(K$P[0]-K$E),K$_[1]=K$b+K$q*(K$P[1]-K$b),K$_[2]=K$e+K$q*(K$P[2]-K$e),K$_[3]=K$h+K$q*(K$P[3]-K$h)},K$E.slerpQuaternionArray=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){var K$h,K$Z,K$S,K$n,K$k,K$x=K$c[K$P+0],K$r=K$c[K$P+1],K$g=K$c[K$P+2],K$W=K$c[K$P+3],K$w=K$q[K$_+0],K$O=K$q[K$_+1],K$N=K$q[K$_+2],K$m=K$q[K$_+3];return(K$Z=K$x*K$w+K$r*K$O+K$g*K$N+K$W*K$m)<0&&(K$Z=-K$Z,K$w=-K$w,K$O=-K$O,K$N=-K$N,K$m=-K$m),K$k=1e-6<1-K$Z?(K$h=Math.acos(K$Z),K$S=Math.sin(K$h),K$n=Math.sin((1-K$E)*K$h)/K$S,Math.sin(K$E*K$h)/K$S):(K$n=1-K$E,K$E),K$b[K$e+0]=K$n*K$x+K$k*K$w,K$b[K$e+1]=K$n*K$r+K$k*K$O,K$b[K$e+2]=K$n*K$g+K$k*K$N,K$b[K$e+3]=K$n*K$W+K$k*K$m,K$b},K$E.getRotation=function(K$c,K$P,K$q,K$_){return Math.atan2(K$_-K$P,K$q-K$c)/Math.PI*180},K$E.sortBigFirst=function(K$c,K$P){return K$c==K$P?0:K$c<K$P?1:-1},K$E.sortSmallFirst=function(K$c,K$P){return K$c==K$P?0:K$c<K$P?-1:1},K$E.sortNumBigFirst=function(K$c,K$P){return parseFloat(K$P)-parseFloat(K$c)},K$E.sortNumSmallFirst=function(K$c,K$P){return parseFloat(K$c)-parseFloat(K$P)},K$E.sortByKey=function(K$q,K$c,K$P){var K$_;return void 0===K$c&&(K$c=!1),void 0===K$P&&(K$P=!0),K$_=K$c?K$P?K$E.sortNumBigFirst:K$E.sortBigFirst:K$P?K$E.sortNumSmallFirst:K$E.sortSmallFirst,function(K$c,K$P){return K$_(K$c[K$q],K$P[K$q])}},K$E}(),K$V=function(){function K$q(K$c,K$P,K$q,K$_,K$E,K$b){this.inPool=!1,this.bTransform=!1,void 0===K$c&&(K$c=1),void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=1),void 0===K$E&&(K$E=0),void 0===K$b&&(K$b=0),this.a=K$c,this.b=K$P,this.c=K$q,this.d=K$_,this.tx=K$E,this.ty=K$b,this._checkTransform()}K$n(K$q,"laya.maths.Matrix");var K$c=K$q.prototype;return K$c.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},K$c._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},K$c.setTranslate=function(K$c,K$P){return this.tx=K$c,this.ty=K$P,this},K$c.translate=function(K$c,K$P){return this.tx+=K$c,this.ty+=K$P,this},K$c.scale=function(K$c,K$P){this.a*=K$c,this.d*=K$P,this.c*=K$c,this.b*=K$P,this.tx*=K$c,this.ty*=K$P,this.bTransform=!0},K$c.rotate=function(K$c){var K$P=Math.cos(K$c),K$q=Math.sin(K$c),K$_=this.a,K$E=this.c,K$b=this.tx;this.a=K$_*K$P-this.b*K$q,this.b=K$_*K$q+this.b*K$P,this.c=K$E*K$P-this.d*K$q,this.d=K$E*K$q+this.d*K$P,this.tx=K$b*K$P-this.ty*K$q,this.ty=K$b*K$q+this.ty*K$P,this.bTransform=!0},K$c.skew=function(K$c,K$P){var K$q=Math.tan(K$c),K$_=Math.tan(K$P),K$E=this.a,K$b=this.b;return this.a+=K$_*this.c,this.b+=K$_*this.d,this.c+=K$q*K$E,this.d+=K$q*K$b,this},K$c.invertTransformPoint=function(K$c){var K$P=this.a,K$q=this.b,K$_=this.c,K$E=this.d,K$b=this.tx,K$e=K$P*K$E-K$q*K$_,K$h=K$E/K$e,K$Z=-K$q/K$e,K$S=-K$_/K$e,K$n=K$P/K$e,K$k=(K$_*this.ty-K$E*K$b)/K$e,K$x=-(K$P*this.ty-K$q*K$b)/K$e;return K$c.setTo(K$h*K$c.x+K$S*K$c.y+K$k,K$Z*K$c.x+K$n*K$c.y+K$x)},K$c.transformPoint=function(K$c){return K$c.setTo(this.a*K$c.x+this.c*K$c.y+this.tx,this.b*K$c.x+this.d*K$c.y+this.ty)},K$c.transformPointN=function(K$c){return K$c.setTo(this.a*K$c.x+this.c*K$c.y,this.b*K$c.x+this.d*K$c.y)},K$c.transformPointArray=function(K$c,K$P){for(var K$q=K$c.length,K$_=0;K$_<K$q;K$_+=2){var K$E=K$c[K$_],K$b=K$c[K$_+1];K$P[K$_]=this.a*K$E+this.c*K$b+this.tx,K$P[K$_+1]=this.b*K$E+this.d*K$b+this.ty}return K$P},K$c.transformPointArrayScale=function(K$c,K$P){for(var K$q=K$c.length,K$_=0;K$_<K$q;K$_+=2){var K$E=K$c[K$_],K$b=K$c[K$_+1];K$P[K$_]=this.a*K$E+this.c*K$b,K$P[K$_+1]=this.b*K$E+this.d*K$b}return K$P},K$c.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},K$c.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},K$c.invert=function(){var K$c=this.a,K$P=this.b,K$q=this.c,K$_=this.d,K$E=this.tx,K$b=K$c*K$_-K$P*K$q;return this.a=K$_/K$b,this.b=-K$P/K$b,this.c=-K$q/K$b,this.d=K$c/K$b,this.tx=(K$q*this.ty-K$_*K$E)/K$b,this.ty=-(K$c*this.ty-K$P*K$E)/K$b,this},K$c.setTo=function(K$c,K$P,K$q,K$_,K$E,K$b){return this.a=K$c,this.b=K$P,this.c=K$q,this.d=K$_,this.tx=K$E,this.ty=K$b,this},K$c.concat=function(K$c){var K$P=this.a,K$q=this.c,K$_=this.tx;return this.a=K$P*K$c.a+this.b*K$c.c,this.b=K$P*K$c.b+this.b*K$c.d,this.c=K$q*K$c.a+this.d*K$c.c,this.d=K$q*K$c.b+this.d*K$c.d,this.tx=K$_*K$c.a+this.ty*K$c.c+K$c.tx,this.ty=K$_*K$c.b+this.ty*K$c.d+K$c.ty,this},K$c.scaleEx=function(K$c,K$P){var K$q=this.a,K$_=this.b,K$E=this.c,K$b=this.d;0!==K$_||0!==K$E?(this.a=K$c*K$q,this.b=K$c*K$_,this.c=K$P*K$E):(this.a=K$c*K$q,this.b=0*K$b,this.c=0*K$q),this.d=K$P*K$b,this.bTransform=!0},K$c.rotateEx=function(K$c){var K$P=Math.cos(K$c),K$q=Math.sin(K$c),K$_=this.a,K$E=this.b,K$b=this.c,K$e=this.d;0!==K$E||0!==K$b?(this.a=K$P*K$_+K$q*K$b,this.b=K$P*K$E+K$q*K$e,this.c=-K$q*K$_+K$P*K$b,this.d=-K$q*K$E+K$P*K$e):(this.a=K$P*K$_,this.b=K$q*K$e,this.c=-K$q*K$_,this.d=K$P*K$e),this.bTransform=!0},K$c.clone=function(){var K$c=K$q.create();return K$c.a=this.a,K$c.b=this.b,K$c.c=this.c,K$c.d=this.d,K$c.tx=this.tx,K$c.ty=this.ty,K$c.bTransform=this.bTransform,K$c},K$c.copyTo=function(K$c){return K$c.a=this.a,K$c.b=this.b,K$c.c=this.c,K$c.d=this.d,K$c.tx=this.tx,K$c.ty=this.ty,K$c.bTransform=this.bTransform,K$c},K$c.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},K$c.destroy=function(){if(!this.inPool){var K$c=K$q._cache;this.inPool=!0,K$c._length||(K$c._length=0),(K$c[K$c._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},K$q.mul=function(K$c,K$P,K$q){var K$_=K$c.a,K$E=K$c.b,K$b=K$c.c,K$e=K$c.d,K$h=K$c.tx,K$Z=K$c.ty,K$S=K$P.a,K$n=K$P.b,K$k=K$P.c,K$x=K$P.d,K$r=K$P.tx,K$g=K$P.ty;return 0!==K$n||0!==K$k?(K$q.a=K$_*K$S+K$E*K$k,K$q.b=K$_*K$n+K$E*K$x,K$q.c=K$b*K$S+K$e*K$k,K$q.d=K$b*K$n+K$e*K$x,K$q.tx=K$S*K$h+K$k*K$Z+K$r,K$q.ty=K$n*K$h+K$x*K$Z+K$g):(K$q.a=K$_*K$S,K$q.b=K$E*K$x,K$q.c=K$b*K$S,K$q.d=K$e*K$x,K$q.tx=K$S*K$h+K$r,K$q.ty=K$x*K$Z+K$g),K$q},K$q.mul16=function(K$c,K$P,K$q){var K$_=K$c.a,K$E=K$c.b,K$b=K$c.c,K$e=K$c.d,K$h=K$c.tx,K$Z=K$c.ty,K$S=K$P.a,K$n=K$P.b,K$k=K$P.c,K$x=K$P.d,K$r=K$P.tx,K$g=K$P.ty;return 0!==K$n||0!==K$k?(K$q[0]=K$_*K$S+K$E*K$k,K$q[1]=K$_*K$n+K$E*K$x,K$q[4]=K$b*K$S+K$e*K$k,K$q[5]=K$b*K$n+K$e*K$x,K$q[12]=K$S*K$h+K$k*K$Z+K$r,K$q[13]=K$n*K$h+K$x*K$Z+K$g):(K$q[0]=K$_*K$S,K$q[1]=K$E*K$x,K$q[4]=K$b*K$S,K$q[5]=K$e*K$x,K$q[12]=K$S*K$h+K$r,K$q[13]=K$x*K$Z+K$g),K$q},K$q.mulPre=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){var K$Z=K$c.a,K$S=K$c.b,K$n=K$c.c,K$k=K$c.d,K$x=K$c.tx,K$r=K$c.ty;return 0!==K$q||0!==K$_?(K$h.a=K$Z*K$P+K$S*K$_,K$h.b=K$Z*K$q+K$S*K$E,K$h.c=K$n*K$P+K$k*K$_,K$h.d=K$n*K$q+K$k*K$E,K$h.tx=K$P*K$x+K$_*K$r+K$b,K$h.ty=K$q*K$x+K$E*K$r+K$e):(K$h.a=K$Z*K$P,K$h.b=K$S*K$E,K$h.c=K$n*K$P,K$h.d=K$k*K$E,K$h.tx=K$P*K$x+K$b,K$h.ty=K$E*K$r+K$e),K$h},K$q.mulPos=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){var K$Z=K$c.a,K$S=K$c.b,K$n=K$c.c,K$k=K$c.d,K$x=K$c.tx,K$r=K$c.ty;return 0!==K$S||0!==K$n?(K$h.a=K$P*K$Z+K$q*K$n,K$h.b=K$P*K$S+K$q*K$k,K$h.c=K$_*K$Z+K$E*K$n,K$h.d=K$_*K$S+K$E*K$k,K$h.tx=K$Z*K$b+K$n*K$e+K$x,K$h.ty=K$S*K$b+K$k*K$e+K$r):(K$h.a=K$P*K$Z,K$h.b=K$q*K$k,K$h.c=K$_*K$Z,K$h.d=K$E*K$k,K$h.tx=K$Z*K$b+K$x,K$h.ty=K$k*K$e+K$r),K$h},K$q.preMul=function(K$c,K$P,K$q){var K$_=K$c.a,K$E=K$c.b,K$b=K$c.c,K$e=K$c.d,K$h=K$P.a,K$Z=K$P.b,K$S=K$P.c,K$n=K$P.d,K$k=K$P.tx,K$x=K$P.ty;return K$q.a=K$h*K$_,K$q.b=K$q.c=0,K$q.d=K$n*K$e,K$q.tx=K$k*K$_+K$c.tx,K$q.ty=K$x*K$e+K$c.ty,0===K$Z&&0===K$S&&0===K$E&&0===K$b||(K$q.a+=K$Z*K$b,K$q.d+=K$S*K$E,K$q.b+=K$h*K$E+K$Z*K$e,K$q.c+=K$S*K$_+K$n*K$b,K$q.tx+=K$x*K$b,K$q.ty+=K$k*K$E),K$q},K$q.preMulXY=function(K$c,K$P,K$q,K$_){var K$E=K$c.a,K$b=K$c.b,K$e=K$c.c,K$h=K$c.d;return K$_.a=K$E,K$_.b=K$b,K$_.c=K$e,K$_.d=K$h,K$_.tx=K$P*K$E+K$c.tx+K$q*K$e,K$_.ty=K$q*K$h+K$c.ty+K$P*K$b,K$_},K$q.create=function(){var K$c=K$q._cache,K$P=K$c._length?K$c[--K$c._length]:new K$q;return K$P.inPool=!1,K$P},K$q.EMPTY=new K$q,K$q.TEMP=new K$q,K$q._cache=[],K$q}(),K$Q=function(){function K$c(K$c,K$P){void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),this.x=K$c,this.y=K$P}K$n(K$c,"laya.maths.Point");var K$P=K$c.prototype;return K$P.setTo=function(K$c,K$P){return this.x=K$c,this.y=K$P,this},K$P.distance=function(K$c,K$P){return Math.sqrt((this.x-K$c)*(this.x-K$c)+(this.y-K$P)*(this.y-K$P))},K$P.toString=function(){return this.x+","+this.y},K$P.normalize=function(){var K$c=Math.sqrt(this.x*this.x+this.y*this.y);if(0<K$c){var K$P=1/K$c;this.x*=K$P,this.y*=K$P}},K$c.TEMP=new K$c,K$c.EMPTY=new K$c,K$c}(),K$d=function(){function K$S(K$c,K$P,K$q,K$_){void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=0),this.x=K$c,this.y=K$P,this.width=K$q,this.height=K$_}K$n(K$S,"laya.maths.Rectangle");var K$c=K$S.prototype;return K$c.setTo=function(K$c,K$P,K$q,K$_){return this.x=K$c,this.y=K$P,this.width=K$q,this.height=K$_,this},K$c.copyFrom=function(K$c){return this.x=K$c.x,this.y=K$c.y,this.width=K$c.width,this.height=K$c.height,this},K$c.contains=function(K$c,K$P){return!(this.width<=0||this.height<=0)&&(K$c>=this.x&&K$c<this.right&&K$P>=this.y&&K$P<this.bottom)},K$c.intersects=function(K$c){return!(K$c.x>this.x+this.width||K$c.x+K$c.width<this.x||K$c.y>this.y+this.height||K$c.y+K$c.height<this.y)},K$c.intersection=function(K$c,K$P){return this.intersects(K$c)?(K$P||(K$P=new K$S),K$P.x=Math.max(this.x,K$c.x),K$P.y=Math.max(this.y,K$c.y),K$P.width=Math.min(this.right,K$c.right)-K$P.x,K$P.height=Math.min(this.bottom,K$c.bottom)-K$P.y,K$P):null},K$c.union=function(K$c,K$P){return K$P||(K$P=new K$S),this.clone(K$P),K$c.width<=0||K$c.height<=0?K$P:(K$P.addPoint(K$c.x,K$c.y),K$P.addPoint(K$c.right,K$c.bottom),this)},K$c.clone=function(K$c){return K$c||(K$c=new K$S),K$c.x=this.x,K$c.y=this.y,K$c.width=this.width,K$c.height=this.height,K$c},K$c.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},K$c.equals=function(K$c){return!(!K$c||K$c.x!==this.x||K$c.y!==this.y||K$c.width!==this.width||K$c.height!==this.height)},K$c.addPoint=function(K$c,K$P){return this.x>K$c&&(this.width+=this.x-K$c,this.x=K$c),this.y>K$P&&(this.height+=this.y-K$P,this.y=K$P),this.width<K$c-this.x&&(this.width=K$c-this.x),this.height<K$P-this.y&&(this.height=K$P-this.y),this},K$c._getBoundPoints=function(){var K$c=K$S._temB;return(K$c.length=0)==this.width||0==this.height||K$c.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),K$c},K$c.isEmpty=function(){return this.width<=0||this.height<=0},K$g(0,K$c,"right",function(){return this.x+this.width}),K$g(0,K$c,"bottom",function(){return this.y+this.height}),K$S._getBoundPointS=function(K$c,K$P,K$q,K$_){var K$E=K$S._temA;return(K$E.length=0)==K$q||0==K$_||K$E.push(K$c,K$P,K$c+K$q,K$P,K$c,K$P+K$_,K$c+K$q,K$P+K$_),K$E},K$S._getWrapRec=function(K$c,K$P){if(!K$c||K$c.length<1)return K$P?K$P.setTo(0,0,0,0):K$S.TEMP.setTo(0,0,0,0);K$P=K$P||new K$S;var K$q,K$_,K$E,K$b,K$e,K$h=K$c.length,K$Z=K$Q.TEMP;for(K$E=K$e=-(K$_=K$b=99999),K$q=0;K$q<K$h;K$q+=2)K$Z.x=K$c[K$q],K$Z.y=K$c[K$q+1],K$_=K$_<K$Z.x?K$_:K$Z.x,K$b=K$b<K$Z.y?K$b:K$Z.y,K$E=K$E>K$Z.x?K$E:K$Z.x,K$e=K$e>K$Z.y?K$e:K$Z.y;return K$P.setTo(K$_,K$b,K$E-K$_,K$e-K$b)},K$S.EMPTY=new K$S,K$S.TEMP=new K$S,K$S._temB=[],K$S._temA=[],K$S}(),K$J=function(){function K$Z(){}return K$n(K$Z,"laya.media.SoundManager"),K$g(1,K$Z,"useAudioMusic",function(){return K$Z._useAudioMusic},function(K$c){K$Z._useAudioMusic=K$c,K$Z._musicClass=K$c?K$qc:null}),K$g(1,K$Z,"autoStopMusic",function(){return K$Z._autoStopMusic},function(K$c){K$H.stage.off("blur",null,K$Z._stageOnBlur),K$H.stage.off("focus",null,K$Z._stageOnFocus),K$H.stage.off("visibilitychange",null,K$Z._visibilityChange),(K$Z._autoStopMusic=K$c)&&(K$H.stage.on("blur",null,K$Z._stageOnBlur),K$H.stage.on("focus",null,K$Z._stageOnFocus),K$H.stage.on("visibilitychange",null,K$Z._visibilityChange))}),K$g(1,K$Z,"muted",function(){return K$Z._muted},function(K$c){K$c!=K$Z._muted&&(K$c&&K$Z.stopAllSound(),K$Z.musicMuted=K$c,K$Z._muted=K$c)}),K$g(1,K$Z,"musicMuted",function(){return K$Z._musicMuted},function(K$c){K$c!=K$Z._musicMuted&&(K$c?(K$Z._tMusic&&K$Z._musicChannel&&!K$Z._musicChannel.isStopped?K$Z._musicChannel.pause():K$Z._musicChannel=null,K$Z._musicMuted=K$c):(K$Z._musicMuted=K$c,K$Z._tMusic&&K$Z._musicChannel&&K$Z._musicChannel.resume()))}),K$g(1,K$Z,"soundMuted",function(){return K$Z._soundMuted},function(K$c){K$Z._soundMuted=K$c}),K$Z.addChannel=function(K$c){0<=K$Z._channels.indexOf(K$c)||(K$Z._channels.push(K$c),K$Z.autoReleaseSound&&0!=K$Z._notUsedCount&&K$Z._notUsedUrls[K$c.url]&&(delete K$Z._notUsedUrls[K$c.url],0==--K$Z._notUsedCount&&K$H.timer.clear(K$Z,K$Z.disposeSoundIfNotUsed)))},K$Z.removeChannel=function(K$c){var K$P=K$Z._channels,K$q=K$P.indexOf(K$c);if(-1!=K$q&&(K$P.splice(K$q,1),K$Z.autoReleaseSound)){var K$_=K$c.url,K$E=K$Z.defaultIntervals[K$_]||2e4;if(0<K$E){var K$b=!0;for(K$q=K$P.length-1;0<=K$q;K$q--)if(K$P[K$q].url==K$_){K$b=!1;break}K$b&&(K$Z._notUsedUrls[K$_]=Date.now()+K$E,0==K$Z._notUsedCount++&&K$H.timer.loop(1e4,K$Z,K$Z.disposeSoundIfNotUsed))}}},K$Z.disposeSoundIfNotUsed=function(){var K$c=K$Z._notUsedUrls;if(0!=K$Z._notUsedCount){var K$P=Date.now();for(var K$q in K$c)K$P>=K$c[K$q]&&(delete K$c[K$q],--K$Z._notUsedCount,K$Z.destroySound(K$q));if(0!=K$Z._notUsedCount)return}K$H.timer.clear(K$Z,K$Z.disposeSoundIfNotUsed)},K$Z._visibilityChange=function(){K$H.stage.isVisibility?K$Z._stageOnFocus():K$Z._stageOnBlur()},K$Z._stageOnBlur=function(){K$Z._isActive=!1,K$Z._musicChannel&&(K$Z._musicChannel.isStopped||(K$Z._blurPaused=!0,K$Z._musicChannel.pause())),K$Z.stopAllSound(),K$H.stage.once("mousedown",null,K$Z._stageOnFocus)},K$Z._recoverWebAudio=function(){K$bc.ctx&&"running"!=K$bc.ctx.state&&K$bc.ctx.resume&&K$bc.ctx.resume()},K$Z._stageOnFocus=function(){if(K$Z._isActive=!0,K$Z._recoverWebAudio(),K$H.stage.off("mousedown",null,K$Z._stageOnFocus),K$Z._blurPaused){var K$c=K$Z._musicChannel;K$c&&K$Z._music&&K$c.isStopped&&(K$Z._blurPaused=!1,K$Z._music._disposed?K$Z.playMusic(K$c.url,K$c.loops,K$c.startHandler,K$c.completeHandler,K$c.startTime):K$c.audioBuffer?K$c.resume():K$Z._music.play(K$c.startTime,K$c.loops,K$c.startHandler,K$c))}},K$Z.playSound=function(K$c,K$P,K$q,K$_,K$E,K$b){if(void 0===K$P&&(K$P=1),void 0===K$b&&(K$b=0),!K$c)return null;if(K$Z._muted)return null;if(K$Z._recoverWebAudio(),K$c==K$Z._tMusic){if(K$Z._musicMuted)return null}else{if(!K$Z._isActive)return null;if(K$Z._soundMuted)return null}var K$e,K$h=K$Z._pool[K$c];return K$E||(K$E=K$Z._soundClass),K$h||((K$h=new K$E).load(K$c),K$Z._pool[K$c]=K$h),(K$e=K$h.play(K$b,K$P,K$q))?(K$c==K$Z._tMusic&&(K$Z._music=K$h,K$Z._isActive||(K$Z._blurPaused=!0,K$e.pause())),K$e.url=K$c,K$e.volume=K$c==K$Z._tMusic?K$Z.musicVolume:K$Z.soundVolume,K$e.completeHandler=K$_,K$e):null},K$Z.destroySound=function(K$c){var K$P=K$Z._pool[K$c];K$P&&(delete K$Z._pool[K$c],K$P.dispose())},K$Z.playMusic=function(K$c,K$P,K$q,K$_,K$E){return void 0===K$P&&(K$P=0),void 0===K$E&&(K$E=0),K$Z._tMusic=K$c,K$Z._musicChannel&&K$Z._musicChannel.stop(),K$Z._musicChannel=K$Z.playSound(K$c,K$P,K$q,K$_,null,K$E)},K$Z.stopSound=function(K$c){for(var K$P,K$q=K$Z._channels.length-1;0<=K$q;K$q--)(K$P=K$Z._channels[K$q]).url==K$c&&K$P.stop()},K$Z.stopAll=function(){K$Z._tMusic=null;var K$c=0;for(K$c=K$Z._channels.length-1;0<=K$c;K$c--)K$Z._channels[K$c].stop()},K$Z.stopAllSound=function(){var K$c,K$P=0;for(K$P=K$Z._channels.length-1;0<=K$P;K$P--)(K$c=K$Z._channels[K$P]).url!=K$Z._tMusic&&K$c.stop()},K$Z.stopMusic=function(){K$Z._musicChannel&&K$Z._musicChannel.stop(),K$Z._tMusic=null},K$Z.setSoundVolume=function(K$c,K$P){if(K$P)K$Z._setVolume(K$P,K$c);else{K$Z.soundVolume=K$c;var K$q,K$_=0;for(K$_=K$Z._channels.length-1;0<=K$_;K$_--)(K$q=K$Z._channels[K$_]).url!=K$Z._tMusic&&(K$q.volume=K$c)}},K$Z.setMusicVolume=function(K$c){K$Z.musicVolume=K$c,K$Z._setVolume(K$Z._tMusic,K$c)},K$Z._setVolume=function(K$c,K$P){for(var K$q,K$_=K$Z._channels.length-1;0<=K$_;K$_--)(K$q=K$Z._channels[K$_]).url==K$c&&(K$q.volume=K$P)},K$Z.musicVolume=1,K$Z.soundVolume=1,K$Z.playbackRate=1,K$Z._useAudioMusic=!0,K$Z._muted=!1,K$Z._soundMuted=!1,K$Z._musicMuted=!1,K$Z._tMusic=null,K$Z._musicChannel=null,K$Z._music=null,K$Z._channels=[],K$Z._autoStopMusic=!1,K$Z._blurPaused=!1,K$Z._isActive=!0,K$Z._soundClass=null,K$Z._musicClass=null,K$Z.autoReleaseSound=!0,K$Z._pool={},K$Z.defaultIntervals={},K$Z._notUsedUrls={},K$Z._notUsedCount=0,K$Z}(),K$u=function(){var K$c;function K$q(){}return K$n(K$q,"laya.net.LocalStorage"),K$q.__init__=function(){K$q._baseClass||(K$q._baseClass=K$c).init(),K$q.items=K$q._baseClass.items,K$q.support=K$q._baseClass.support},K$q.setItem=function(K$c,K$P){K$q._baseClass.setItem(K$c,K$P)},K$q.getItem=function(K$c){return K$q._baseClass.getItem(K$c)},K$q.setJSON=function(K$c,K$P){K$q._baseClass.setJSON(K$c,K$P)},K$q.getJSON=function(K$c){return K$q._baseClass.getJSON(K$c)},K$q.removeItem=function(K$c){K$q._baseClass.removeItem(K$c)},K$q.clear=function(){K$q._baseClass.clear()},K$q._baseClass=null,K$q.items=null,K$q.support=!1,K$q.__init$=function(){K$c=function(){function K$q(){}return K$n(K$q,""),K$q.init=function(){try{K$q.support=!0,K$q.items=K$e.localStorage,K$q.setItem("laya","1"),K$q.removeItem("laya")}catch(K$c){K$q.support=!1}K$q.support||console.log("LocalStorage is not supprot or browser is private mode.")},K$q.setItem=function(K$c,K$P){try{K$q.support&&K$q.items.setItem(K$c,K$P)}catch(K$c){console.warn("set localStorage failed",K$c)}},K$q.getItem=function(K$c){return K$q.support?K$q.items.getItem(K$c):null},K$q.setJSON=function(K$c,K$P){try{K$q.support&&K$q.items.setItem(K$c,JSON.stringify(K$P))}catch(K$c){console.warn("set localStorage failed",K$c)}},K$q.getJSON=function(K$c){return JSON.parse(K$q.support?K$q.items.getItem(K$c):null)},K$q.removeItem=function(K$c){K$q.support&&K$q.items.removeItem(K$c)},K$q.clear=function(){K$q.support&&K$q.items.clear()},K$q.items=null,K$q.support=!1,K$q}()},K$q}(),K$R=(function(){function K$_(){}K$n(K$_,"laya.net.ResourceVersion"),K$_.enable=function(K$c,K$P,K$q){void 0===K$q&&(K$q=2),laya.net.ResourceVersion.type=K$q,K$H.loader.load(K$c,K$N.create(null,K$_.onManifestLoaded,[K$P]),null,"json"),K$$.customFormat=K$_.addVersionPrefix},K$_.onManifestLoaded=function(K$c,K$P){K$_.manifest=K$P,K$c.run(),K$P||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},K$_.addVersionPrefix=function(K$c){return K$_.manifest&&K$_.manifest[K$c]?2==K$_.type?K$_.manifest[K$c]:K$_.manifest[K$c]+"/"+K$c:K$c},K$_.FOLDER_VERSION=1,K$_.FILENAME_VERSION=2,K$_.manifest=null,K$_.type=1}(),function(){function K$c(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}K$n(K$c,"laya.net.TTFLoader");var K$P=K$c.prototype;return K$P.load=function(K$c){var K$P=(this._url=K$c).split(".ttf")[0].split("/");this.fontName=K$P[K$P.length-1],K$s.window.conch?this._loadConch():K$s.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},K$P._loadConch=function(){this._http=new K$ec,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},K$P._onHttpLoaded=function(K$c){K$s.window.conch.setFontFaceFromBuffer(this.fontName,K$c),this._clearHttp(),this._complete()},K$P._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},K$P._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},K$P._complete=function(){K$H.timer.clear(this,this._complete),K$H.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},K$P._checkComplete=function(){K$j.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},K$P._loadWithFontFace=function(){var K$c=new K$s.window.FontFace(this.fontName,"url('"+this._url+"')");K$s.window.document.fonts.add(K$c);var K$P=this;K$c.loaded.then(function(){K$P._complete()}),K$c.load()},K$P._createDiv=function(){this._div=K$s.createElement("div"),this._div.innerHTML="laya";var K$c=this._div.style;K$c.fontFamily=this.fontName,K$c.position="absolute",K$c.left="-100px",K$c.top="-100px",K$s.document.body.appendChild(this._div)},K$P._loadWithCSS=function(){var K$c=this,K$P=K$s.createElement("style");K$P.type="text/css",K$s.document.body.appendChild(K$P),K$P.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=K$j.measureText("LayaTTFFont",this._fontTxt).width;var K$q=this;K$P.onload=function(){K$H.timer.once(1e4,K$q,K$c._complete)},K$H.timer.loop(20,this,this._checkComplete),this._createDiv()},K$c._testString="LayaTTFFont",K$c}()),K$$=function(){function K$_(K$c){this._url=null,this._path=null,this._url=K$_.formatURL(K$c),this._path=K$_.getPath(K$c)}K$n(K$_,"laya.net.URL");var K$c=K$_.prototype;return K$g(0,K$c,"path",function(){return this._path}),K$g(0,K$c,"url",function(){return this._url}),K$_.formatURL=function(K$c,K$P){if(!K$c)return"null path";if(0<K$c.indexOf(":"))return K$c;null!=K$_.customFormat&&(K$c=K$_.customFormat(K$c,K$P));var K$q=K$c.charAt(0);if("."===K$q)return K$_.formatRelativePath((K$P||K$_.basePath)+K$c);if("~"===K$q)return K$_.rootPath+K$c.substring(1);if("d"===K$q){if(0===K$c.indexOf("data:image"))return K$c}else if("/"===K$q)return K$c;return(K$P||K$_.basePath)+K$c},K$_.formatRelativePath=function(K$c){for(var K$P=K$c.split("/"),K$q=0,K$_=K$P.length;K$q<K$_;K$q++)".."==K$P[K$q]&&(K$P.splice(K$q-1,2),K$q-=2);return K$P.join("/")},K$_.isAbsolute=function(K$c){return 0<K$c.indexOf(":")||"/"==K$c.charAt(0)},K$_.getPath=function(K$c){var K$P=K$c.lastIndexOf("/");return 0<K$P?K$c.substr(0,K$P+1):""},K$_.getFileName=function(K$c){var K$P=K$c.lastIndexOf("/");return 0<K$P?K$c.substr(K$P+1):K$c},K$_.version={},K$_.basePath="",K$_.rootPath="",K$_.customFormat=function(K$c){var K$P=K$_.version[K$c];return!K$C.isConchApp&&K$P&&(K$c+="?v="+K$P),K$c},K$_}(),K$C=function(){function K$E(K$c,K$P){this._timeId=0;var K$q=K$E._mainCanvas.source.style;K$q.position="absolute",K$q.top=K$q.left="0px",K$q.background="#000000",K$E._mainCanvas.source.id="layaCanvas";var K$_=laya.renders.Render.isWebGL;K$E._mainCanvas.source.width=K$c,K$E._mainCanvas.source.height=K$P,K$_&&K$E.WebGL.init(K$E._mainCanvas,K$c,K$P),K$s.container.appendChild(K$E._mainCanvas.source),(K$E._context=new K$F(K$c,K$P,K$_?null:K$E._mainCanvas)).ctx.setIsMainContext(),K$s.window.requestAnimationFrame(function K$c(K$P){K$s.window.requestAnimationFrame(K$c);K$H.stage._loop()}),K$H.stage.on("visibilitychange",this,this._onVisibilitychange)}K$n(K$E,"laya.renders.Render");var K$c=K$E.prototype;return K$c._onVisibilitychange=function(){K$H.stage.isVisibility?0!=this._timeId&&K$s.window.clearInterval(this._timeId):this._timeId=K$s.window.setInterval(this._enterFrame,1e3)},K$c._enterFrame=function(K$c){K$H.stage._loop()},K$g(1,K$E,"context",function(){return K$E._context}),K$g(1,K$E,"canvas",function(){return K$E._mainCanvas.source}),K$E._context=null,K$E._mainCanvas=null,K$E.WebGL=null,K$E.isConchNode=!1,K$E.isConchApp=!1,K$E.isConchWebGL=!1,K$E.isWebGL=!1,K$E.is3DMode=!1,K$E.optimizeTextureMemory=function(K$c,K$P){return!0},K$E.__init$=function(){K$e.ConchRenderType=K$e.ConchRenderType||1,K$e.ConchRenderType|=K$e.conch?4:0,K$E.isConchNode=5==(5&K$e.ConchRenderType),K$E.isConchApp=4==(4&K$e.ConchRenderType),K$E.isConchWebGL=6==K$e.ConchRenderType},K$E}(),K$F=function(){function K$e(K$c,K$P,K$q){this.x=0,this.y=0,this._drawTexture=function(K$c,K$P,K$q){K$q[0].loaded&&this.ctx.drawTexture(K$q[0],K$q[1],K$q[2],K$q[3],K$q[4],K$c,K$P)},this._fillTexture=function(K$c,K$P,K$q){K$q[0].loaded&&this.ctx.fillTexture(K$q[0],K$q[1]+K$c,K$q[2]+K$P,K$q[3],K$q[4],K$q[5],K$q[6],K$q[7])},this._drawTextureWithTransform=function(K$c,K$P,K$q){K$q[0].loaded&&this.ctx.drawTextureWithTransform(K$q[0],K$q[1],K$q[2],K$q[3],K$q[4],K$q[5],K$c,K$P,K$q[6])},this._fillQuadrangle=function(K$c,K$P,K$q){this.ctx.fillQuadrangle(K$q[0],K$q[1],K$q[2],K$q[3],K$q[4])},this._drawRect=function(K$c,K$P,K$q){var K$_=this.ctx;null!=K$q[4]&&(K$_.fillStyle=K$q[4],K$_.fillRect(K$c+K$q[0],K$P+K$q[1],K$q[2],K$q[3],null)),null!=K$q[5]&&(K$_.strokeStyle=K$q[5],K$_.lineWidth=K$q[6],K$_.strokeRect(K$c+K$q[0],K$P+K$q[1],K$q[2],K$q[3],K$q[6]))},this._drawPie=function(K$c,K$P,K$q){var K$_=this.ctx;K$C.isWebGL&&K$_.setPathId(K$q[8]),K$_.beginPath(),K$C.isWebGL?(K$_.movePath(K$q[0]+K$c,K$q[1]+K$P),K$_.moveTo(0,0)):K$_.moveTo(K$c+K$q[0],K$P+K$q[1]),K$_.arc(K$c+K$q[0],K$P+K$q[1],K$q[2],K$q[3],K$q[4]),K$_.closePath(),this._fillAndStroke(K$q[5],K$q[6],K$q[7],!0)},this._clipRect=function(K$c,K$P,K$q){this.ctx.clipRect(K$c+K$q[0],K$P+K$q[1],K$q[2],K$q[3])},this._fillRect=function(K$c,K$P,K$q){this.ctx.fillRect(K$c+K$q[0],K$P+K$q[1],K$q[2],K$q[3],K$q[4])},this._drawCircle=function(K$c,K$P,K$q){var K$_=this.ctx;K$C.isWebGL&&K$_.setPathId(K$q[6]),K$l.drawCall++,K$_.beginPath(),K$C.isWebGL&&K$_.movePath(K$q[0]+K$c,K$q[1]+K$P),K$_.arc(K$q[0]+K$c,K$q[1]+K$P,K$q[2],0,K$e.PI2),K$_.closePath(),this._fillAndStroke(K$q[3],K$q[4],K$q[5],!0)},this._fillCircle=function(K$c,K$P,K$q){K$l.drawCall++;var K$_=this.ctx;K$_.beginPath(),K$_.fillStyle=K$q[3],K$_.arc(K$q[0]+K$c,K$q[1]+K$P,K$q[2],0,K$e.PI2),K$_.fill()},this._setShader=function(K$c,K$P,K$q){this.ctx.setShader(K$q[0])},this._drawLine=function(K$c,K$P,K$q){var K$_=this.ctx;K$C.isWebGL&&K$_.setPathId(K$q[6]),K$_.beginPath(),K$_.strokeStyle=K$q[4],K$_.lineWidth=K$q[5],K$C.isWebGL?(K$_.movePath(K$c,K$P),K$_.moveTo(K$q[0],K$q[1]),K$_.lineTo(K$q[2],K$q[3])):(K$_.moveTo(K$c+K$q[0],K$P+K$q[1]),K$_.lineTo(K$c+K$q[2],K$P+K$q[3])),K$_.stroke()},this._drawLines=function(K$c,K$P,K$q){var K$_=this.ctx;K$C.isWebGL&&K$_.setPathId(K$q[5]),K$_.beginPath(),K$c+=K$q[0],K$P+=K$q[1],K$C.isWebGL&&K$_.movePath(K$c,K$P),K$_.strokeStyle=K$q[3],K$_.lineWidth=K$q[4];var K$E=K$q[2],K$b=2,K$e=K$E.length;if(K$C.isWebGL)for(K$_.moveTo(K$E[0],K$E[1]);K$b<K$e;)K$_.lineTo(K$E[K$b++],K$E[K$b++]);else for(K$_.moveTo(K$c+K$E[0],K$P+K$E[1]);K$b<K$e;)K$_.lineTo(K$c+K$E[K$b++],K$P+K$E[K$b++]);K$_.stroke()},this._drawLinesWebGL=function(K$c,K$P,K$q){this.ctx.drawLines(K$c+this.x+K$q[0],K$P+this.y+K$q[1],K$q[2],K$q[3],K$q[4])},this._drawCurves=function(K$c,K$P,K$q){this.ctx.drawCurves(K$c,K$P,K$q)},this._draw=function(K$c,K$P,K$q){K$q[0].call(null,this,K$c,K$P)},this._transformByMatrix=function(K$c,K$P,K$q){this.ctx.transformByMatrix(K$q[0])},this._setTransform=function(K$c,K$P,K$q){this.ctx.setTransform(K$q[0],K$q[1],K$q[2],K$q[3],K$q[4],K$q[5])},this._setTransformByMatrix=function(K$c,K$P,K$q){this.ctx.setTransformByMatrix(K$q[0])},this._save=function(K$c,K$P,K$q){this.ctx.save()},this._restore=function(K$c,K$P,K$q){this.ctx.restore()},this._translate=function(K$c,K$P,K$q){this.ctx.translate(K$q[0],K$q[1])},this._transform=function(K$c,K$P,K$q){this.ctx.translate(K$q[1]+K$c,K$q[2]+K$P);var K$_=K$q[0];this.ctx.transform(K$_.a,K$_.b,K$_.c,K$_.d,K$_.tx,K$_.ty),this.ctx.translate(-K$c-K$q[1],-K$P-K$q[2])},this._rotate=function(K$c,K$P,K$q){this.ctx.translate(K$q[1]+K$c,K$q[2]+K$P),this.ctx.rotate(K$q[0]),this.ctx.translate(-K$c-K$q[1],-K$P-K$q[2])},this._scale=function(K$c,K$P,K$q){this.ctx.translate(K$q[2]+K$c,K$q[3]+K$P),this.ctx.scale(K$q[0],K$q[1]),this.ctx.translate(-K$c-K$q[2],-K$P-K$q[3])},this._alpha=function(K$c,K$P,K$q){this.ctx.globalAlpha*=K$q[0]},this._setAlpha=function(K$c,K$P,K$q){this.ctx.globalAlpha=K$q[0]},this._fillText=function(K$c,K$P,K$q){this.ctx.fillText(K$q[0],K$q[1]+K$c,K$q[2]+K$P,K$q[3],K$q[4],K$q[5])},this._strokeText=function(K$c,K$P,K$q){this.ctx.strokeText(K$q[0],K$q[1]+K$c,K$q[2]+K$P,K$q[3],K$q[4],K$q[5],K$q[6])},this._fillBorderText=function(K$c,K$P,K$q){this.ctx.fillBorderText(K$q[0],K$q[1]+K$c,K$q[2]+K$P,K$q[3],K$q[4],K$q[5],K$q[6],K$q[7])},this._blendMode=function(K$c,K$P,K$q){this.ctx.globalCompositeOperation=K$q[0]},this._beginClip=function(K$c,K$P,K$q){this.ctx.beginClip&&this.ctx.beginClip(K$c+K$q[0],K$P+K$q[1],K$q[2],K$q[3])},this._setIBVB=function(K$c,K$P,K$q){this.ctx.setIBVB(K$q[0]+K$c,K$q[1]+K$P,K$q[2],K$q[3],K$q[4],K$q[5],K$q[6],K$q[7])},this._fillTrangles=function(K$c,K$P,K$q){this.ctx.fillTrangles(K$q[0],K$q[1]+K$c,K$q[2]+K$P,K$q[3],K$q[4])},this._drawPath=function(K$c,K$P,K$q){var K$_=this.ctx;K$C.isWebGL&&K$_.setPathId(-1),K$_.beginPath(),K$c+=K$q[0],K$P+=K$q[1],K$C.isWebGL&&K$_.movePath(K$c,K$P);for(var K$E=K$q[2],K$b=0,K$e=K$E.length;K$b<K$e;K$b++){var K$h=K$E[K$b];switch(K$h[0]){case"moveTo":K$C.isWebGL?K$_.moveTo(K$h[1],K$h[2]):K$_.moveTo(K$c+K$h[1],K$P+K$h[2]);break;case"lineTo":K$C.isWebGL?K$_.lineTo(K$h[1],K$h[2]):K$_.lineTo(K$c+K$h[1],K$P+K$h[2]);break;case"arcTo":K$C.isWebGL?K$_.arcTo(K$h[1],K$h[2],K$h[3],K$h[4],K$h[5]):K$_.arcTo(K$c+K$h[1],K$P+K$h[2],K$c+K$h[3],K$P+K$h[4],K$h[5]);break;case"closePath":K$_.closePath()}}var K$Z=K$q[3];null!=K$Z&&(K$_.fillStyle=K$Z.fillStyle,K$_.fill());var K$S=K$q[4];null!=K$S&&(K$_.strokeStyle=K$S.strokeStyle,K$_.lineWidth=K$S.lineWidth||1,K$_.lineJoin=K$S.lineJoin,K$_.lineCap=K$S.lineCap,K$_.miterLimit=K$S.miterLimit,K$_.stroke())},this.drawPoly=function(K$c,K$P,K$q){this.ctx.drawPoly(K$c+this.x+K$q[0],K$P+this.y+K$q[1],K$q[2],K$q[3],K$q[4],K$q[5],K$q[6])},this._drawPoly=function(K$c,K$P,K$q){var K$_=this.ctx,K$E=K$q[2],K$b=2,K$e=K$E.length;if(K$C.isWebGL)for(K$_.setPathId(K$q[6]),K$_.beginPath(),K$c+=K$q[0],K$P+=K$q[1],K$_.movePath(K$c,K$P),K$_.moveTo(K$E[0],K$E[1]);K$b<K$e;)K$_.lineTo(K$E[K$b++],K$E[K$b++]);else for(K$_.beginPath(),K$c+=K$q[0],K$P+=K$q[1],K$_.moveTo(K$c+K$E[0],K$P+K$E[1]);K$b<K$e;)K$_.lineTo(K$c+K$E[K$b++],K$P+K$E[K$b++]);K$_.closePath(),this._fillAndStroke(K$q[3],K$q[4],K$q[5],K$q[7])},this._drawSkin=function(K$c,K$P,K$q){var K$_=K$q[0];if(K$_){var K$E=this.ctx;K$_.render(K$E,K$c,K$P)}},this._drawParticle=function(K$c,K$P,K$q){this.ctx.drawParticle(K$c+this.x,K$P+this.y,K$q[0])},this._setFilters=function(K$c,K$P,K$q){this.ctx.setFilters(K$q)},K$q?this.ctx=K$q.getContext("2d"):(K$q=K$mc.create("3D"),this.ctx=K$j.createWebGLContext2D(K$q),K$q._setContext(this.ctx)),K$q.size(K$c,K$P),this.canvas=K$q}K$n(K$e,"laya.renders.RenderContext");var K$c=K$e.prototype;return K$c.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},K$c.drawTexture=function(K$c,K$P,K$q,K$_,K$E){K$c.loaded&&this.ctx.drawTexture(K$c,K$P,K$q,K$_,K$E,this.x,this.y)},K$c._drawTextures=function(K$c,K$P,K$q){K$q[0].loaded&&this.ctx.drawTextures(K$q[0],K$q[1],K$c+this.x,K$P+this.y)},K$c.drawTextureWithTransform=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){K$c.loaded&&this.ctx.drawTextureWithTransform(K$c,K$P,K$q,K$_,K$E,K$b,this.x,this.y,K$e)},K$c.fillQuadrangle=function(K$c,K$P,K$q,K$_,K$E){this.ctx.fillQuadrangle(K$c,K$P,K$q,K$_,K$E)},K$c.drawCanvas=function(K$c,K$P,K$q,K$_,K$E){this.ctx.drawCanvas(K$c,K$P+this.x,K$q+this.y,K$_,K$E)},K$c.drawRect=function(K$c,K$P,K$q,K$_,K$E,K$b){void 0===K$b&&(K$b=1);var K$e=this.ctx;K$e.strokeStyle=K$E,K$e.lineWidth=K$b,K$e.strokeRect(K$c+this.x,K$P+this.y,K$q,K$_,K$b)},K$c._fillAndStroke=function(K$c,K$P,K$q,K$_){void 0===K$_&&(K$_=!1);var K$E=this.ctx;null!=K$c&&(K$E.fillStyle=K$c,K$C.isWebGL?K$E.fill(K$_):K$E.fill()),null!=K$P&&0<K$q&&(K$E.strokeStyle=K$P,K$E.lineWidth=K$q,K$E.stroke())},K$c.clipRect=function(K$c,K$P,K$q,K$_){this.ctx.clipRect(K$c+this.x,K$P+this.y,K$q,K$_)},K$c.fillRect=function(K$c,K$P,K$q,K$_,K$E){this.ctx.fillRect(K$c+this.x,K$P+this.y,K$q,K$_,K$E)},K$c.drawCircle=function(K$c,K$P,K$q,K$_,K$E){void 0===K$E&&(K$E=1),K$l.drawCall++;var K$b=this.ctx;K$b.beginPath(),K$b.strokeStyle=K$_,K$b.lineWidth=K$E,K$b.arc(K$c+this.x,K$P+this.y,K$q,0,K$e.PI2),K$b.stroke()},K$c.drawTriangles=function(K$c,K$P,K$q){if(K$C.isWebGL)this.ctx.drawTriangles(K$q[0],K$c+K$q[1],K$P+K$q[2],K$q[3],K$q[4],K$q[5],K$q[6],K$q[7],K$q[8],K$q[9]);else{var K$_=K$q[5],K$E=0,K$b=K$_.length,K$e=this.ctx;for(K$E=0;K$E<K$b;K$E+=3){var K$h=2*K$_[K$E],K$Z=2*K$_[K$E+1],K$S=2*K$_[K$E+2];K$e.drawTriangle(K$q[0],K$q[3],K$q[4],K$h,K$Z,K$S,K$q[6],!0)}}},K$c.fillCircle=function(K$c,K$P,K$q,K$_){K$l.drawCall++;var K$E=this.ctx;K$E.beginPath(),K$E.fillStyle=K$_,K$E.arc(K$c+this.x,K$P+this.y,K$q,0,K$e.PI2),K$E.fill()},K$c.setShader=function(K$c){this.ctx.setShader(K$c)},K$c.drawLine=function(K$c,K$P,K$q,K$_,K$E,K$b){void 0===K$b&&(K$b=1);var K$e=this.ctx;K$e.beginPath(),K$e.strokeStyle=K$E,K$e.lineWidth=K$b,K$e.moveTo(this.x+K$c,this.y+K$P),K$e.lineTo(this.x+K$q,this.y+K$_),K$e.stroke()},K$c.clear=function(){this.ctx.clear()},K$c.transformByMatrix=function(K$c){this.ctx.transformByMatrix(K$c)},K$c.setTransform=function(K$c,K$P,K$q,K$_,K$E,K$b){this.ctx.setTransform(K$c,K$P,K$q,K$_,K$E,K$b)},K$c.setTransformByMatrix=function(K$c){this.ctx.setTransformByMatrix(K$c)},K$c.save=function(){this.ctx.save()},K$c.restore=function(){this.ctx.restore()},K$c.translate=function(K$c,K$P){this.ctx.translate(K$c,K$P)},K$c.transform=function(K$c,K$P,K$q,K$_,K$E,K$b){this.ctx.transform(K$c,K$P,K$q,K$_,K$E,K$b)},K$c.rotate=function(K$c){this.ctx.rotate(K$c)},K$c.scale=function(K$c,K$P){this.ctx.scale(K$c,K$P)},K$c.alpha=function(K$c){this.ctx.globalAlpha*=K$c},K$c.setAlpha=function(K$c){this.ctx.globalAlpha=K$c},K$c.fillWords=function(K$c,K$P,K$q,K$_,K$E,K$b){void 0===K$b&&(K$b=0),this.ctx.fillWords(K$c,K$P,K$q,K$_,K$E,K$b)},K$c.fillBorderWords=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this.ctx.fillBorderWords(K$c,K$P,K$q,K$_,K$E,K$b,K$e)},K$c.fillText=function(K$c,K$P,K$q,K$_,K$E,K$b){this.ctx.fillText(K$c,K$P+this.x,K$q+this.y,K$_,K$E,K$b)},K$c.strokeText=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this.ctx.strokeText(K$c,K$P+this.x,K$q+this.y,K$_,K$E,K$b,K$e)},K$c.blendMode=function(K$c){this.ctx.globalCompositeOperation=K$c},K$c.flush=function(){this.ctx.flush&&this.ctx.flush()},K$c.addRenderObject=function(K$c){this.ctx.addRenderObject(K$c)},K$c.beginClip=function(K$c,K$P,K$q,K$_){this.ctx.beginClip&&this.ctx.beginClip(K$c,K$P,K$q,K$_)},K$c.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},K$c.fillTrangles=function(K$c,K$P,K$q){this.ctx.fillTrangles(K$q[0],K$q[1],K$q[2],K$q[3],4<K$q.length?K$q[4]:null)},K$e.PI2=2*Math.PI,K$e}(),K$o=function(){function K$e(K$c,K$P){switch(this._next=K$P||K$e.NORENDER,K$c){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=K$O._filter);case 69905:return void(this._fun=K$e._initRenderFun)}this.onCreate(K$c)}K$n(K$e,"laya.renders.RenderSprite");var K$c=K$e.prototype;return K$c.onCreate=function(K$c){},K$c._style=function(K$c,K$P,K$q,K$_){K$c._style.render(K$c,K$P,K$q,K$_);var K$E=this._next;K$E._fun.call(K$E,K$c,K$P,K$q,K$_)},K$c._no=function(K$c,K$P,K$q,K$_){},K$c._custom=function(K$c,K$P,K$q,K$_){K$c.customRender(K$P,K$q,K$_);var K$E=K$c._style._tf;this._next._fun.call(this._next,K$c,K$P,K$q-K$E.translateX,K$_-K$E.translateY)},K$c._clip=function(K$c,K$P,K$q,K$_){var K$E=this._next;if(K$E!=K$e.NORENDER){var K$b=K$c._style.scrollRect;K$P.ctx.save(),K$P.ctx.clipRect(K$q,K$_,K$b.width,K$b.height),K$E._fun.call(K$E,K$c,K$P,K$q-K$b.x,K$_-K$b.y),K$P.ctx.restore()}},K$c._blend=function(K$c,K$P,K$q,K$_){var K$E=K$c._style;K$E.blendMode&&(K$P.ctx.globalCompositeOperation=K$E.blendMode);var K$b=this._next;K$b._fun.call(K$b,K$c,K$P,K$q,K$_),K$P.ctx.globalCompositeOperation="source-over"},K$c._mask=function(K$c,K$P,K$q,K$_){var K$E=this._next;K$E._fun.call(K$E,K$c,K$P,K$q,K$_);var K$b=K$c.mask;K$b&&(K$P.ctx.globalCompositeOperation="destination-in",(0<K$b.numChildren||!K$b.graphics._isOnlyOne())&&(K$b.cacheAsBitmap=!0),K$b.render(K$P,K$q-K$c.pivotX,K$_-K$c.pivotY)),K$P.ctx.globalCompositeOperation="source-over"},K$c._graphics=function(K$c,K$P,K$q,K$_){var K$E=K$c._style._tf;K$c._graphics&&K$c._graphics._render(K$c,K$P,K$q-K$E.translateX,K$_-K$E.translateY);var K$b=this._next;K$b._fun.call(K$b,K$c,K$P,K$q,K$_)},K$c._image=function(K$c,K$P,K$q,K$_){var K$E=K$c._style;K$P.ctx.drawTexture2(K$q,K$_,K$E._tf.translateX,K$E._tf.translateY,K$c.transform,K$E.alpha,K$E.blendMode,K$c._graphics._one)},K$c._image2=function(K$c,K$P,K$q,K$_){var K$E=K$c._style._tf;K$P.ctx.drawTexture2(K$q,K$_,K$E.translateX,K$E.translateY,K$c.transform,1,null,K$c._graphics._one)},K$c._alpha=function(K$c,K$P,K$q,K$_){var K$E;if(.01<(K$E=K$c._style.alpha)||K$c._needRepaint()){var K$b=K$P.ctx.globalAlpha;K$P.ctx.globalAlpha*=K$E;var K$e=this._next;K$e._fun.call(K$e,K$c,K$P,K$q,K$_),K$P.ctx.globalAlpha=K$b}},K$c._transform=function(K$c,K$P,K$q,K$_){var K$E=K$c.transform,K$b=this._next;K$E&&K$b!=K$e.NORENDER?(K$P.save(),K$P.transform(K$E.a,K$E.b,K$E.c,K$E.d,K$E.tx+K$q,K$E.ty+K$_),K$b._fun.call(K$b,K$c,K$P,0,0),K$P.restore()):K$b._fun.call(K$b,K$c,K$P,K$q,K$_)},K$c._childs=function(K$c,K$P,K$q,K$_){var K$E=K$c._style,K$b=K$E._tf;if(K$q=K$q-K$b.translateX+K$E.paddingLeft,K$_=K$_-K$b.translateY+K$E.paddingTop,K$E._calculation){var K$e=K$c._getWords();if(K$e){var K$h=K$E;K$h&&(K$h.stroke?K$P.fillBorderWords(K$e,K$q,K$_,K$h.font,K$h.color,K$h.strokeColor,K$h.stroke):K$P.fillWords(K$e,K$q,K$_,K$h.font,K$h.color,"none"!=K$h.textDecoration&&K$h.underLine?1:0))}}var K$Z,K$S=K$c._childs,K$n=K$S.length;if(K$c.viewport||K$c.optimizeScrollRect&&K$c._style.scrollRect){var K$k=K$c.viewport||K$c._style.scrollRect,K$x=K$k.x,K$r=K$k.y,K$g=K$k.right,K$W=K$k.bottom,K$w=NaN,K$O=NaN;for(K$N=0;K$N<K$n;++K$N)(K$Z=K$S[K$N]).visible&&(K$w=K$Z._x)<K$g&&K$w+K$Z.width>K$x&&(K$O=K$Z._y)<K$W&&K$O+K$Z.height>K$r&&K$Z.render(K$P,K$q,K$_)}else for(var K$N=0;K$N<K$n;++K$N)(K$Z=K$S[K$N])._style.visible&&K$Z.render(K$P,K$q,K$_)},K$c._canvas=function(K$c,K$P,K$q,K$_){var K$E=K$c._$P.cacheCanvas;if(K$E){"bitmap"===K$E.type?K$l.canvasBitmap++:K$l.canvasNormal++;var K$b=K$E.ctx;if(K$c._needRepaint()||!K$b)this._canvas_repaint(K$c,K$P,K$q,K$_);else{var K$e=K$E._cacheRec;K$P.drawCanvas(K$b.canvas,K$q+K$e.x,K$_+K$e.y,K$e.width,K$e.height)}}else this._next._fun.call(this._next,K$c,K$P,K$q,K$_)},K$c._canvas_repaint=function(K$c,K$P,K$q,K$_){var K$E=K$c._$P.cacheCanvas,K$b=this._next;if(K$E){var K$e,K$h,K$Z,K$S,K$n=K$E.ctx,K$k=K$c._needRepaint()||!K$n,K$x=K$E.type;if("bitmap"===K$x?K$l.canvasBitmap++:K$l.canvasNormal++,K$k){var K$r,K$g;K$E._cacheRec||(K$E._cacheRec=new K$d),K$C.isWebGL&&"bitmap"!==K$x?K$E._cacheRec.setTo(-K$c.pivotX,-K$c.pivotY,1,1):((K$S=K$c.getSelfBounds()).x=K$S.x-K$c.pivotX,K$S.y=K$S.y-K$c.pivotY,K$S.x=K$S.x-16,K$S.y=K$S.y-16,K$S.width=K$S.width+32,K$S.height=K$S.height+32,K$S.x=Math.floor(K$S.x+K$q)-K$q,K$S.y=Math.floor(K$S.y+K$_)-K$_,K$S.width=Math.floor(K$S.width),K$S.height=Math.floor(K$S.height),K$E._cacheRec.copyFrom(K$S)),K$S=K$E._cacheRec;var K$W,K$w=K$C.isWebGL?1:K$s.pixelRatio*K$H.stage.clientScaleX,K$O=K$C.isWebGL?1:K$s.pixelRatio*K$H.stage.clientScaleY;if(!K$C.isWebGL){var K$N,K$m=1,K$T=1;for(K$N=K$c;K$N&&K$N!=K$H.stage;)K$m*=K$N.scaleX,K$T*=K$N.scaleY,K$N=K$N.parent;K$C.isWebGL?(K$m<1&&(K$w*=K$m),K$T<1&&(K$O*=K$T)):(1<K$m&&(K$w*=K$m),1<K$T&&(K$O*=K$T))}if(K$c.scrollRect){var K$D=K$c.scrollRect;K$S.x-=K$D.x,K$S.y-=K$D.y}if(K$r=K$S.width*K$w,K$g=K$S.height*K$O,K$h=K$S.x,K$Z=K$S.y,K$C.isWebGL&&"bitmap"===K$x&&(2048<K$r||2048<K$g))return console.warn("cache bitmap size larger than 2048,cache ignored"),K$E.ctx&&(K$f.recover("RenderContext",K$E.ctx),K$E.ctx.canvas.size(0,0),K$E.ctx=null),void K$b._fun.call(K$b,K$c,K$P,K$q,K$_);if(K$n||(K$n=K$E.ctx=K$f.getItem("RenderContext")||new K$F(K$r,K$g,K$mc.create("AUTO"))),K$n.ctx.sprite=K$c,(K$e=K$n.canvas).clear(),(K$e.width!=K$r||K$e.height!=K$g)&&K$e.size(K$r,K$g),"bitmap"===K$x?K$e.context.asBitmap=!0:"normal"===K$x&&(K$e.context.asBitmap=!1),1!=K$w||1!=K$O){var K$L=K$n.ctx;K$L.save(),K$L.scale(K$w,K$O),!K$C.isConchWebGL&&K$C.isConchApp&&(K$W=K$c._$P.cf)&&K$L.setFilterMatrix&&K$L.setFilterMatrix(K$W._mat,K$W._alpha),K$b._fun.call(K$b,K$c,K$n,-K$h,-K$Z),K$L.restore(),K$C.isConchApp&&!K$C.isConchWebGL||K$c._applyFilters()}else K$L=K$n.ctx,!K$C.isConchWebGL&&K$C.isConchApp&&(K$W=K$c._$P.cf)&&K$L.setFilterMatrix&&K$L.setFilterMatrix(K$W._mat,K$W._alpha),K$b._fun.call(K$b,K$c,K$n,-K$h,-K$Z),K$C.isConchApp&&!K$C.isConchWebGL||K$c._applyFilters();K$c._$P.staticCache&&(K$E.reCache=!1),K$l.canvasReCache++}else K$h=(K$S=K$E._cacheRec).x,K$Z=K$S.y,K$e=K$n.canvas;K$P.drawCanvas(K$e,K$q+K$h,K$_+K$Z,K$S.width,K$S.height)}else K$b._fun.call(K$b,K$c,K$n,K$q,K$_)},K$e.__init__=function(){var K$c,K$P,K$q=0;for(K$P=K$j.createRenderSprite(69905,null),K$c=K$e.renders.length=4096,K$q=0;K$q<K$c;K$q++)K$e.renders[K$q]=K$P;K$e.renders[0]=K$j.createRenderSprite(0,null),function(K$c,K$P){for(var K$q=0,K$_=0;K$_<K$c.length;K$_++)K$q|=K$c[K$_],K$e.renders[K$q]=K$P}([1,512,4,2],new K$e(1,null)),K$e.renders[513]=K$j.createRenderSprite(513,null),K$e.renders[517]=new K$e(517,null)},K$e._initRenderFun=function(K$c,K$P,K$q,K$_){var K$E=K$c._renderType;(K$e.renders[K$E]=K$e._getTypeRender(K$E))._fun(K$c,K$P,K$q,K$_)},K$e._getTypeRender=function(K$c){for(var K$P=null,K$q=2048;1<K$q;)K$q&K$c&&(K$P=K$j.createRenderSprite(K$q,K$P)),K$q>>=1;return K$P},K$e.IMAGE=1,K$e.ALPHA=2,K$e.TRANSFORM=4,K$e.BLEND=8,K$e.CANVAS=16,K$e.FILTERS=32,K$e.MASK=64,K$e.CLIP=128,K$e.STYLE=256,K$e.GRAPHICS=512,K$e.CUSTOM=1024,K$e.CHILDS=2048,K$e.INIT=69905,K$e.renders=[],K$e.NORENDER=new K$e(0,null),K$e}(),K$a=function(){function K$h(){this._repaint=!1}K$n(K$h,"laya.resource.Context");var K$c=K$h.prototype;return K$c.replaceReset=function(){var K$c,K$P,K$q=0;for(K$c=K$h.replaceKeys.length,K$q=0;K$q<K$c;K$q++)K$P=K$h.replaceKeys[K$q],this[K$h.newKeys[K$q]]=this[K$P]},K$c.replaceResotre=function(){this.__restore(),this.__reset()},K$c.setIsMainContext=function(){},K$c.drawTextures=function(K$c,K$P,K$q,K$_){K$l.drawCall+=K$P.length/2;for(var K$E=K$c.width,K$b=K$c.height,K$e=0,K$h=K$P.length;K$e<K$h;K$e+=2)this.drawTexture(K$c,K$P[K$e],K$P[K$e+1],K$E,K$b,K$q,K$_)},K$c.drawCanvas=function(K$c,K$P,K$q,K$_,K$E){K$l.drawCall++,this.drawImage(K$c.source,K$P,K$q,K$_,K$E)},K$c.fillRect=function(K$c,K$P,K$q,K$_,K$E){K$l.drawCall++,K$E&&(this.fillStyle=K$E),this.__fillRect(K$c,K$P,K$q,K$_)},K$c.fillText=function(K$c,K$P,K$q,K$_,K$E,K$b){K$l.drawCall++,3<arguments.length&&null!=K$_&&(this.font=K$_,this.fillStyle=K$E,this.textAlign=K$b,this.textBaseline="top"),this.__fillText(K$c,K$P,K$q)},K$c.fillBorderText=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){K$l.drawCall++,this.font=K$_,this.fillStyle=K$E,this.textBaseline="top",this.strokeStyle=K$b,this.lineWidth=K$e,this.textAlign=K$h,this.__strokeText(K$c,K$P,K$q),this.__fillText(K$c,K$P,K$q)},K$c.strokeText=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){K$l.drawCall++,3<arguments.length&&null!=K$_&&(this.font=K$_,this.strokeStyle=K$E,this.lineWidth=K$b,this.textAlign=K$e,this.textBaseline="top"),this.__strokeText(K$c,K$P,K$q)},K$c.transformByMatrix=function(K$c){this.transform(K$c.a,K$c.b,K$c.c,K$c.d,K$c.tx,K$c.ty)},K$c.setTransformByMatrix=function(K$c){this.setTransform(K$c.a,K$c.b,K$c.c,K$c.d,K$c.tx,K$c.ty)},K$c.clipRect=function(K$c,K$P,K$q,K$_){K$l.drawCall++,this.beginPath(),this.rect(K$c,K$P,K$q,K$_),this.clip()},K$c.drawTexture=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){K$l.drawCall++;var K$h=K$c.uv,K$Z=K$c.bitmap.width,K$S=K$c.bitmap.height;this.drawImage(K$c.source,K$h[0]*K$Z,K$h[1]*K$S,(K$h[2]-K$h[0])*K$Z,(K$h[5]-K$h[3])*K$S,K$P+K$b,K$q+K$e,K$_,K$E)},K$c.drawTextureWithTransform=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){K$l.drawCall++;var K$S=K$c.uv,K$n=K$c.bitmap.width,K$k=K$c.bitmap.height;this.save(),1!=K$Z&&(this.globalAlpha*=K$Z),K$b?(this.transform(K$b.a,K$b.b,K$b.c,K$b.d,K$b.tx+K$e,K$b.ty+K$h),this.drawImage(K$c.source,K$S[0]*K$n,K$S[1]*K$k,(K$S[2]-K$S[0])*K$n,(K$S[5]-K$S[3])*K$k,K$P,K$q,K$_,K$E)):this.drawImage(K$c.source,K$S[0]*K$n,K$S[1]*K$k,(K$S[2]-K$S[0])*K$n,(K$S[5]-K$S[3])*K$k,K$P+K$e,K$q+K$h,K$_,K$E),this.restore()},K$c.drawTexture2=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){var K$Z=K$h[0];if(K$Z.loaded&&K$Z.bitmap&&K$Z.source){K$l.drawCall++;var K$S=1!==K$b;if(K$S){var K$n=this.globalAlpha;this.globalAlpha*=K$b}var K$k=K$Z.uv,K$x=K$Z.bitmap.width,K$r=K$Z.bitmap.height;K$E?(this.save(),this.transform(K$E.a,K$E.b,K$E.c,K$E.d,K$E.tx+K$c,K$E.ty+K$P),this.drawImage(K$Z.source,K$k[0]*K$x,K$k[1]*K$r,(K$k[2]-K$k[0])*K$x,(K$k[5]-K$k[3])*K$r,K$h[1]-K$q,K$h[2]-K$_,K$h[3],K$h[4]),this.restore()):this.drawImage(K$Z.source,K$k[0]*K$x,K$k[1]*K$r,(K$k[2]-K$k[0])*K$x,(K$k[5]-K$k[3])*K$r,K$h[1]-K$q+K$c,K$h[2]-K$_+K$P,K$h[3],K$h[4]),K$S&&(this.globalAlpha=K$n)}},K$c.fillTexture=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){if(!K$h.pat){if(K$c.uv!=K$nc.DEF_UV){var K$Z=new K$mc("2D");K$Z.getContext("2d"),K$Z.size(K$c.width,K$c.height),K$Z.context.drawTexture(K$c,0,0,K$c.width,K$c.height,0,0),K$c=new K$nc(K$Z)}K$h.pat=this.createPattern(K$c.bitmap.source,K$b)}var K$S=K$P,K$n=K$q,K$k=0,K$x=0;K$e&&(K$S+=K$e.x%K$c.width,K$n+=K$e.y%K$c.height,K$k-=K$e.x%K$c.width,K$x-=K$e.y%K$c.height),this.translate(K$S,K$n),this.fillRect(K$k,K$x,K$_,K$E,K$h.pat),this.translate(-K$S,-K$n)},K$c.drawTriangle=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){var K$Z=K$c.bitmap,K$S=K$Z.source,K$n=K$c.width,K$k=K$c.height,K$x=K$Z.width,K$r=K$Z.height,K$g=K$q[K$_]*K$x,K$W=K$q[K$E]*K$x,K$w=K$q[K$b]*K$x,K$O=K$q[K$_+1]*K$r,K$N=K$q[K$E+1]*K$r,K$m=K$q[K$b+1]*K$r,K$T=K$P[K$_],K$D=K$P[K$E],K$L=K$P[K$b],K$H=K$P[K$_+1],K$Q=K$P[K$E+1],K$d=K$P[K$b+1];if(K$h){var K$u=(K$T+K$D+K$L)/3,K$A=(K$H+K$Q+K$d)/3,K$J=K$T-K$u,K$j=K$H-K$A,K$V=Math.sqrt(K$J*K$J+K$j*K$j);K$T=K$u+K$J/K$V*(K$V+1),K$H=K$A+K$j/K$V*(K$V+1),K$j=K$Q-K$A,K$D=K$u+(K$J=K$D-K$u)/(K$V=Math.sqrt(K$J*K$J+K$j*K$j))*(K$V+1),K$Q=K$A+K$j/K$V*(K$V+1),K$j=K$d-K$A,K$L=K$u+(K$J=K$L-K$u)/(K$V=Math.sqrt(K$J*K$J+K$j*K$j))*(K$V+1),K$d=K$A+K$j/K$V*(K$V+1)}this.save(),K$e&&this.transform(K$e.a,K$e.b,K$e.c,K$e.d,K$e.tx,K$e.ty),this.beginPath(),this.moveTo(K$T,K$H),this.lineTo(K$D,K$Q),this.lineTo(K$L,K$d),this.closePath(),this.clip();var K$R=1/(K$g*K$N+K$O*K$w+K$W*K$m-K$N*K$w-K$O*K$W-K$g*K$m),K$$=K$T*K$N+K$O*K$L+K$D*K$m-K$N*K$L-K$O*K$D-K$T*K$m,K$C=K$g*K$D+K$T*K$w+K$W*K$L-K$D*K$w-K$T*K$W-K$g*K$L,K$F=K$g*K$N*K$L+K$O*K$D*K$w+K$T*K$W*K$m-K$T*K$N*K$w-K$O*K$W*K$L-K$g*K$D*K$m,K$o=K$H*K$N+K$O*K$d+K$Q*K$m-K$N*K$d-K$O*K$Q-K$H*K$m,K$a=K$g*K$Q+K$H*K$w+K$W*K$d-K$Q*K$w-K$H*K$W-K$g*K$d,K$Y=K$g*K$N*K$d+K$O*K$Q*K$w+K$H*K$W*K$m-K$H*K$N*K$w-K$O*K$W*K$d-K$g*K$Q*K$m;this.transform(K$$*K$R,K$o*K$R,K$C*K$R,K$a*K$R,K$F*K$R,K$Y*K$R),this.drawImage(K$S,K$c.uv[0]*K$x,K$c.uv[1]*K$r,K$n,K$k,K$c.uv[0]*K$x,K$c.uv[1]*K$r,K$n,K$k),this.restore()},K$c.flush=function(){return 0},K$c.fillWords=function(K$c,K$P,K$q,K$_,K$E,K$b){K$_&&(this.font=K$_),K$E&&(this.fillStyle=K$E);this.textBaseline="top",this.textAlign="left";for(var K$e=0,K$h=K$c.length;K$e<K$h;K$e++){var K$Z=K$c[K$e];if(this.__fillText(K$Z.char,K$Z.x+K$P,K$Z.y+K$q),1===K$b){var K$S=K$Z.height,K$n=.5*K$Z.style.letterSpacing;K$n||(K$n=0),this.beginPath(),this.strokeStyle=K$E,this.lineWidth=1,this.moveTo(K$P+K$Z.x-K$n+.5,K$q+K$Z.y+K$S+.5),this.lineTo(K$P+K$Z.x+K$Z.width+K$n+.5,K$q+K$Z.y+K$S+.5),this.stroke()}}},K$c.fillBorderWords=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){K$_&&(this.font=K$_),K$E&&(this.fillStyle=K$E),this.textBaseline="top",this.lineWidth=K$e,this.textAlign="left",this.strokeStyle=K$b;for(var K$h=0,K$Z=K$c.length;K$h<K$Z;K$h++){var K$S=K$c[K$h];this.__strokeText(K$S.char,K$S.x+K$P,K$S.y+K$q),this.__fillText(K$S.char,K$S.x+K$P,K$S.y+K$q)}},K$c.destroy=function(){this.canvas.width=this.canvas.height=0},K$c.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},K$c.drawCurves=function(K$c,K$P,K$q){this.beginPath(),this.strokeStyle=K$q[3],this.lineWidth=K$q[4];var K$_=K$q[2];K$c+=K$q[0],K$P+=K$q[1],this.moveTo(K$c+K$_[0],K$P+K$_[1]);for(var K$E=2,K$b=K$_.length;K$E<K$b;)this.quadraticCurveTo(K$c+K$_[K$E++],K$P+K$_[K$E++],K$c+K$_[K$E++],K$P+K$_[K$E++]);this.stroke()},K$h.__init__=function(K$P){var K$q=laya.resource.Context.prototype;if(!(K$P=K$P||CanvasRenderingContext2D.prototype).inited){K$P.inited=!0,K$P.__fillText=K$P.fillText,K$P.__fillRect=K$P.fillRect,K$P.__strokeText=K$P.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(K$c){K$P[K$c]=K$q[K$c]})}},K$h.replaceCanvasGetSet=function(K$c,K$P){var K$q=Object.getOwnPropertyDescriptor(K$c,K$P);if(!K$q||!K$q.configurable)return!1;var K$_,K$E={};for(K$_ in K$q)"set"!=K$_&&(K$E[K$_]=K$q[K$_]);var K$b=K$q.set;return K$E.set=function(K$c){K$b.call(this,K$c);var K$P=this.getContext("2d");K$P&&"__reset"in K$P&&K$P.__reset()},Object.defineProperty(K$c,K$P,K$E),!0},K$h.replaceGetSet=function(K$c,K$P){var K$q=Object.getOwnPropertyDescriptor(K$c,K$P);if(!K$q||!K$q.configurable)return!1;var K$_,K$E={};for(K$_ in K$q)"set"!=K$_&&(K$E[K$_]=K$q[K$_]);var K$b=K$q.set,K$e="___"+K$P+"__";return K$h.newKeys.push(K$e),K$E.set=function(K$c){K$c!=this[K$e]&&(this[K$e]=K$c,K$b.call(this,K$c))},Object.defineProperty(K$c,K$P,K$E),!0},K$h._default=new K$h,K$h.newKeys=[],K$Z(K$h,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),K$h}(),K$Y=function(){function K$b(K$c){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++K$b._uniqueIDCounter,this._name=K$c||"Content Manager",K$b._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,K$b._resourceManagers.push(this),this._resources=[],this._records={}}K$n(K$b,"laya.resource.ResourceManager");var K$c=K$b.prototype;return K$H.imps(K$c,{"laya.resource.IDispose":!0}),K$c.getResourceByIndex=function(K$c){return this._resources[K$c]},K$c.getResourcesLength=function(){return this._resources.length},K$c.addResource=function(K$c){return K$c.resourceManager&&K$c.resourceManager.removeResource(K$c),-1===this._resources.indexOf(K$c)&&((K$c._resourceManager=this)._resources.push(K$c),this.addRecord(K$c.uri,K$c.__className,K$c.memorySize),this.addSize(K$c.memorySize),!0)},K$c.removeResource=function(K$c){var K$P=this._resources.indexOf(K$c);return-1!==K$P&&(this._resources.splice(K$P,1),K$c._resourceManager=null,this._memorySize-=K$c.memorySize,this.addRecord(K$c.uri,K$c.__className,-K$c.memorySize),!0)},K$c.unload=function(){for(var K$c=this._resources.slice(0,this._resources.length),K$P=0;K$P<K$c.length;K$P++){K$c[K$P].destroy()}K$c.length=0},K$c.dispose=function(){if(this===K$b._systemResourceManager)throw new Error("systemResourceManager不能被释放！");K$b._resourceManagers.splice(K$b._resourceManagers.indexOf(this),1),K$b._isResourceManagersSorted=!1;for(var K$c=this._resources.slice(0,this._resources.length),K$P=0;K$P<K$c.length;K$P++){var K$q=K$c[K$P];K$q.resourceManager.removeResource(K$q),K$q.destroy()}K$c.length=0},K$c.addSize=function(K$c){K$c&&(this.autoRelease&&0<K$c&&this._memorySize+K$c>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=K$c)},K$c.addRecord=function(K$c,K$P,K$q){DEBUG&&K$q&&!K$c&&console.error(K$c,K$P,K$q),K$c&&(this._records.hasOwnProperty(K$P+"|"+K$c)||(this._records[K$P+"|"+K$c]=0),this._records[K$P+"|"+K$c]+=K$q,DEBUG&&this._records[K$P+"|"+K$c]<0&&console.error(K$c,K$P,this._records[K$P+"|"+K$c]))},K$c.garbageCollection=function(K$c){var K$P=this._resources;(K$P=K$P.slice()).sort(function(K$c,K$P){if(!K$c||!K$P)throw new Error("a或b不能为空！");return K$c.released&&K$P.released?0:K$c.released?1:K$P.released?-1:K$c._lastUseFrameCount-K$P._lastUseFrameCount});for(var K$q=K$l.loopCount,K$_=0,K$E=K$P.length;K$_<K$E;K$_++){var K$b=K$P[K$_];if(!(1<K$q-K$b._lastUseFrameCount))return void(this._memorySize>=K$c&&(this._isOverflow=!0));if(K$b.releaseResource(),this._memorySize<K$c)return void(this._isOverflow=!1)}},K$g(0,K$c,"id",function(){return this._id}),K$g(0,K$c,"name",function(){return this._name},function(K$c){!K$c&&""===K$c||this._name===K$c||(this._name=K$c,K$b._isResourceManagersSorted=!1)}),K$g(0,K$c,"memorySize",function(){return this._memorySize}),K$g(0,K$c,"records",function(){return this._records}),K$g(1,K$b,"systemResourceManager",function(){return K$b._systemResourceManager}),K$b.__init__=function(){K$b.currentResourceManager=K$b.systemResourceManager},K$b.getLoadedResourceManagerByIndex=function(K$c){return K$b._resourceManagers[K$c]},K$b.getLoadedResourceManagersCount=function(){return K$b._resourceManagers.length},K$b.recreateContentManagers=function(K$c){void 0===K$c&&(K$c=!1);for(var K$P=K$b.currentResourceManager,K$q=0;K$q<K$b._resourceManagers.length;K$q++){K$b.currentResourceManager=K$b._resourceManagers[K$q];for(var K$_=0;K$_<K$b.currentResourceManager._resources.length;K$_++)K$b.currentResourceManager._resources[K$_].releaseResource(K$c),K$b.currentResourceManager._resources[K$_].activeResource(K$c)}K$b.currentResourceManager=K$P},K$b.releaseContentManagers=function(K$c){void 0===K$c&&(K$c=!1);for(var K$P=K$b.currentResourceManager,K$q=0;K$q<K$b._resourceManagers.length;K$q++){K$b.currentResourceManager=K$b._resourceManagers[K$q];for(var K$_=0;K$_<K$b.currentResourceManager._resources.length;K$_++){var K$E=K$b.currentResourceManager._resources[K$_];!K$E.released&&K$E.releaseResource(K$c)}}K$b.currentResourceManager=K$P},K$b._uniqueIDCounter=0,K$b._isResourceManagersSorted=!1,K$b._resourceManagers=[],K$Z(K$b,["_systemResourceManager",function(){return this._systemResourceManager=new K$b("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=K$b._systemResourceManager}]),K$b}(),K$s=(function(){function K$c(){}K$n(K$c,"laya.system.System"),K$c.changeDefinition=function(K$c,K$P){K$H[K$c]=K$P;var K$q=K$c+"=classObj";K$H._runScript(K$q)},K$c.__init__=function(){K$C.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function K$q(){}return K$n(K$q,"laya.utils.Browser"),K$g(1,K$q,"pixelRatio",function(){return K$q.__init__(),-1<K$q.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:K$j.getPixelRatio()}),K$g(1,K$q,"height",function(){return K$q.__init__(),(K$H.stage&&K$H.stage.canvasRotation?K$q.clientWidth:K$q.clientHeight)*K$q.pixelRatio}),K$g(1,K$q,"clientWidth",function(){return K$q.__init__(),K$q.window.innerWidth||K$q.document.body.clientWidth}),K$g(1,K$q,"window",function(){return K$q.__init__(),K$q._window}),K$g(1,K$q,"clientHeight",function(){return K$q.__init__(),K$q.window.innerHeight||K$q.document.body.clientHeight||K$q.document.documentElement.clientHeight}),K$g(1,K$q,"width",function(){return K$q.__init__(),(K$H.stage&&K$H.stage.canvasRotation?K$q.clientHeight:K$q.clientWidth)*K$q.pixelRatio}),K$g(1,K$q,"container",function(){return K$q.__init__(),K$q._container||((K$q._container=K$q.createElement("div")).id="layaContainer",K$q.document.body.appendChild(K$q._container)),K$q._container},function(K$c){K$q._container=K$c}),K$g(1,K$q,"document",function(){return K$q.__init__(),K$q._document}),K$q.__init__=function(){if(!K$q._window){K$q._window=K$j.getWindow(),K$q._document=K$q.window.document,K$q._window.addEventListener("message",function(K$c){laya.utils.Browser._onMessage(K$c)},!1),K$q.document.__createElement=K$q.document.createElement,K$e.requestAnimationFrame=K$e.requestAnimationFrame||K$e.webkitRequestAnimationFrame||K$e.mozRequestAnimationFrame||K$e.oRequestAnimationFrame||K$e.msRequestAnimationFrame||function(K$c){return K$e.setTimeout(K$c,1e3/60)};var K$c=K$e.document.body.style;K$c["-webkit-user-select"]="none",K$c["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",K$q.userAgent=K$q.window.navigator.userAgent,K$q.onIOS=!!(K$q.u=K$q.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),K$q.onMobile=-1<K$q.u.indexOf("Mobile"),K$q.onIPhone=-1<K$q.u.indexOf("iPhone"),K$q.onMac=-1<K$q.u.indexOf("Mac OS X"),K$q.onIPad=-1<K$q.u.indexOf("iPad"),K$q.onAndroid=-1<K$q.u.indexOf("Android")||-1<K$q.u.indexOf("Adr"),K$q.onWP=-1<K$q.u.indexOf("Windows Phone"),K$q.onQQBrowser=-1<K$q.u.indexOf("QQBrowser"),K$q.onMQQBrowser=-1<K$q.u.indexOf("MQQBrowser")||-1<K$q.u.indexOf("Mobile")&&-1<K$q.u.indexOf("QQ"),K$q.onIE=!!K$q.window.ActiveXObject||"ActiveXObject"in K$q.window,K$q.onWeiXin=-1<K$q.u.indexOf("MicroMessenger"),K$q.onPC=!K$q.onMobile,K$q.onSafari=-1<K$q.u.indexOf("Safari"),K$q.onFirefox=-1<K$q.u.indexOf("Firefox"),K$q.onEdge=-1<K$q.u.indexOf("Edge"),K$q.onMiniGame=-1<K$q.u.indexOf("MiniGame"),K$q.onLimixiu=-1<K$q.u.indexOf("limixiu"),K$q.httpProtocol="http:"==K$q.window.location.protocol,K$q.onMiniGame&&null==K$q.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),K$q.webAudioEnabled=!!(K$q.window.AudioContext||K$q.window.webkitAudioContext||K$q.window.mozAudioContext),K$q.soundType=K$q.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",K$Ec=K$q.webAudioEnabled?K$bc:K$qc,K$q.webAudioEnabled&&K$bc.initWebAudio(),K$qc._initMusicAudio(),K$q.enableTouch="ontouchstart"in K$e||K$e.DocumentTouch&&K$P instanceof DocumentTouch,K$e.focus(),K$J._soundClass=K$Ec,K$J._musicClass=K$qc,K$C._mainCanvas=K$C._mainCanvas||K$mc.create("2D"),K$q.canvas||(K$q.canvas=K$mc.create("2D"),K$q.context=K$q.canvas.getContext("2d"))}},K$q._onMessage=function(K$c){if(K$c.data&&"size"==K$c.data.name){if(K$q.window.innerWidth=K$c.data.width,K$q.window.innerHeight=K$c.data.height,K$q.window.__innerHeight=K$c.data.clientHeight,!K$q.document.createEvent)return void console.warn("no document.createEvent");var K$P=K$q.document.createEvent("HTMLEvents");return K$P.initEvent("resize",!1,!1),void K$q.window.dispatchEvent(K$P)}},K$q.createElement=function(K$c){return K$q.__init__(),K$q.document.__createElement(K$c)},K$q.getElementById=function(K$c){return K$q.__init__(),K$q.document.getElementById(K$c)},K$q.removeElement=function(K$c){K$c&&K$c.parentNode&&K$c.parentNode.removeChild(K$c)},K$q.now=function(){return K$j.now()},K$q._window=null,K$q._document=null,K$q._container=null,K$q.userAgent=null,K$q.u=null,K$q.onIOS=!1,K$q.onMac=!1,K$q.onMobile=!1,K$q.onIPhone=!1,K$q.onIPad=!1,K$q.onAndroid=!1,K$q.onWP=!1,K$q.onQQBrowser=!1,K$q.onMQQBrowser=!1,K$q.onSafari=!1,K$q.onFirefox=!1,K$q.onEdge=!1,K$q.onIE=!1,K$q.onWeiXin=!1,K$q.onMiniGame=!1,K$q.onLimixiu=!1,K$q.onPC=!1,K$q.httpProtocol=!1,K$q.webAudioEnabled=!1,K$q.soundType=null,K$q.enableTouch=!1,K$q.canvas=null,K$q.context=null,K$q.__init$=function(){},K$q}()),K$U=function(){function K$P(K$c){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,K$c?(this._u8d_=new Uint8Array(K$c),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}K$n(K$P,"laya.utils.Byte");var K$c=K$P.prototype;return K$c.___resizeBuffer=function(K$P){try{var K$c=new Uint8Array(K$P);null!=this._u8d_&&(this._u8d_.length<=K$P?K$c.set(this._u8d_):K$c.set(this._u8d_.subarray(0,K$P))),this._u8d_=K$c,this._d_=new DataView(K$c.buffer)}catch(K$c){throw"___resizeBuffer err:"+K$P}},K$c.getString=function(){return this.rUTF(this.getUint16())},K$c.getFloat32Array=function(K$c,K$P){var K$q=K$c+K$P;K$q=K$q>this._length?this._length:K$q;var K$_=new Float32Array(this._d_.buffer.slice(K$c,K$q));return this._pos_=K$q,K$_},K$c.getUint8Array=function(K$c,K$P){var K$q=K$c+K$P;K$q=K$q>this._length?this._length:K$q;var K$_=new Uint8Array(this._d_.buffer.slice(K$c,K$q));return this._pos_=K$q,K$_},K$c.getInt16Array=function(K$c,K$P){var K$q=K$c+K$P;K$q=K$q>this._length?this._length:K$q;var K$_=new Int16Array(this._d_.buffer.slice(K$c,K$q));return this._pos_=K$q,K$_},K$c.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var K$c=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,K$c},K$c.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var K$c=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,K$c},K$c.writeFloat32=function(K$c){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,K$c,this._xd_),this._pos_+=4},K$c.writeFloat64=function(K$c){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,K$c,this._xd_),this._pos_+=8},K$c.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var K$c=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,K$c},K$c.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var K$c=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,K$c},K$c.writeInt32=function(K$c){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,K$c,this._xd_),this._pos_+=4},K$c.writeUint32=function(K$c){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,K$c,this._xd_),this._pos_+=4},K$c.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var K$c=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,K$c},K$c.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var K$c=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,K$c},K$c.writeUint16=function(K$c){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,K$c,this._xd_),this._pos_+=2},K$c.writeInt16=function(K$c){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,K$c,this._xd_),this._pos_+=2},K$c.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},K$c.writeUint8=function(K$c){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,K$c),this._pos_++},K$c._getUInt8=function(K$c){return this._d_.getUint8(K$c)},K$c._getUint16=function(K$c){return this._d_.getUint16(K$c,this._xd_)},K$c._getMatrix=function(){return new K$V(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},K$c.rUTF=function(K$c){for(var K$P=[],K$q=this._pos_+K$c,K$_=0,K$E=0,K$b=0,K$e=String.fromCharCode,K$h=this._u8d_;this._pos_<K$q;)(K$_=K$h[this._pos_++])<128?0!=K$_&&K$P.push(K$e(K$_)):K$_<224?K$P.push(K$e((63&K$_)<<6|127&K$h[this._pos_++])):K$_<240?(K$E=K$h[this._pos_++],K$P.push(K$e((31&K$_)<<12|(127&K$E)<<6|127&K$h[this._pos_++]))):(K$E=K$h[this._pos_++],K$b=K$h[this._pos_++],K$P.push(K$e((15&K$_)<<18|(127&K$E)<<12|K$b<<6&127|127&K$h[this._pos_++]))),0;return K$P.join("")},K$c.getCustomString=function(K$c){for(var K$P=[],K$q=0,K$_=0,K$E=0,K$b=String.fromCharCode,K$e=this._u8d_;0<K$c;)if((K$_=K$e[this._pos_])<128)K$P.push(K$b(K$_)),this._pos_++,K$c--;else for(K$q=K$_-128,this._pos_++,K$c-=K$q;0<K$q;)K$_=K$e[this._pos_++],K$E=K$e[this._pos_++],K$P.push(K$b(K$E<<8|K$_)),K$q--;return K$P.join("")},K$c.clear=function(){this._pos_=0,this.length=0},K$c.__getBuffer=function(){return this._d_.buffer},K$c.writeUTFBytes=function(K$c){for(var K$P=0,K$q=(K$c+="").length;K$P<K$q;K$P++){var K$_=K$c.charCodeAt(K$P);K$_<=127?this.writeByte(K$_):K$_<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|K$_>>6,128|63&K$_],this._pos_),this._pos_+=2):K$_<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|K$_>>12,128|K$_>>6&63,128|63&K$_],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|K$_>>18,128|K$_>>12&63,128|K$_>>6&63,128|63&K$_],this._pos_),this._pos_+=4)}},K$c.writeUTFString=function(K$c){var K$P=this.pos;this.writeUint16(1),this.writeUTFBytes(K$c);var K$q=this.pos-K$P-2;if(65536<=K$q)throw"writeUTFString byte len more than 65536";this._d_.setUint16(K$P,K$q,this._xd_)},K$c.readUTFString=function(){return this.readUTFBytes(this.getUint16())},K$c.getUTFString=function(){return this.readUTFString()},K$c.readUTFBytes=function(K$c){if(void 0===K$c&&(K$c=-1),0==K$c)return"";var K$P=this.bytesAvailable;if(K$P<K$c)throw"readUTFBytes error - Out of bounds";return K$c=0<K$c?K$c:K$P,this.rUTF(K$c)},K$c.getUTFBytes=function(K$c){return void 0===K$c&&(K$c=-1),this.readUTFBytes(K$c)},K$c.writeByte=function(K$c){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,K$c),this._pos_+=1},K$c.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},K$c.getByte=function(){return this.readByte()},K$c.ensureWrite=function(K$c){this._length<K$c&&(this._length=K$c),this._allocated_<K$c&&(this.length=K$c)},K$c.writeArrayBuffer=function(K$c,K$P,K$q){if(void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),K$P<0||K$q<0)throw"writeArrayBuffer error - Out of bounds";0==K$q&&(K$q=K$c.byteLength-K$P),this.ensureWrite(this._pos_+K$q);var K$_=new Uint8Array(K$c);this._u8d_.set(K$_.subarray(K$P,K$P+K$q),this._pos_),this._pos_+=K$q},K$g(0,K$c,"buffer",function(){var K$c=this._d_.buffer;return K$c.byteLength==this.length?K$c:K$c.slice(0,this.length)}),K$g(0,K$c,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(K$c){this._xd_="littleEndian"==K$c}),K$g(0,K$c,"length",function(){return this._length},function(K$c){this._allocated_<K$c?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(K$c,2*this._allocated_))):this._allocated_>K$c&&this.___resizeBuffer(this._allocated_=K$c),this._length=K$c}),K$g(0,K$c,"pos",function(){return this._pos_},function(K$c){this._pos_=K$c}),K$g(0,K$c,"bytesAvailable",function(){return this._length-this._pos_}),K$P.getSystemEndian=function(){if(!K$P._sysEndian){var K$c=new ArrayBuffer(2);new DataView(K$c).setInt16(0,256,!0),K$P._sysEndian=256===new Int16Array(K$c)[0]?"littleEndian":"bigEndian"}return K$P._sysEndian},K$P.BIG_ENDIAN="bigEndian",K$P.LITTLE_ENDIAN="littleEndian",K$P._sysEndian=null,K$P}(),K$I=function(){function K$E(){}return K$n(K$E,"laya.utils.CacheManager"),K$E.regCacheByFunction=function(K$c,K$P){var K$q;K$E.unRegCacheByFunction(K$c,K$P),K$q={tryDispose:K$c,getCacheList:K$P},K$E._cacheList.push(K$q)},K$E.unRegCacheByFunction=function(K$c,K$P){var K$q,K$_=0;for(K$q=K$E._cacheList.length,K$_=0;K$_<K$q;K$_++)if(K$E._cacheList[K$_].tryDispose==K$c&&K$E._cacheList[K$_].getCacheList==K$P)return void K$E._cacheList.splice(K$_,1)},K$E.forceDispose=function(){var K$c=0,K$P=K$E._cacheList.length;for(K$c=0;K$c<K$P;K$c++)K$E._cacheList[K$c].tryDispose(!0)},K$E.beginCheck=function(K$c){void 0===K$c&&(K$c=15e3),K$H.timer.loop(K$c,null,K$E._checkLoop)},K$E.stopCheck=function(){K$H.timer.clear(null,K$E._checkLoop)},K$E._checkLoop=function(){var K$c=K$E._cacheList;if(!(K$c.length<1)){var K$P,K$q=K$s.now(),K$_=0;for(K$P=K$_=K$c.length;0<K$_&&(K$c[K$E._index=++K$E._index%K$P].tryDispose(!1),!(K$s.now()-K$q>K$E.loopTimeLimit));)K$_--}},K$E.loopTimeLimit=2,K$E._cacheList=[],K$E._index=0,K$E}(),K$v=function(){function K$r(){}return K$n(K$r,"laya.utils.ClassUtils"),K$r.regClass=function(K$c,K$P){K$r._classMap[K$c]=K$P},K$r.getRegClass=function(K$c){return K$r._classMap[K$c]},K$r.getInstance=function(K$c){var K$P=K$r.getClass(K$c);return K$P?new K$P:(console.warn("[error] Undefined class:",K$c),null)},K$r.createByJson=function(K$c,K$P,K$q,K$_,K$E){"string"==typeof K$c&&(K$c=JSON.parse(K$c));var K$b=K$c.props;if(!K$P&&!(K$P=K$E?K$E.runWith(K$c):K$r.getInstance(K$b.runtime||K$c.type)))return null;var K$e=K$c.child;if(K$e)for(var K$h=0,K$Z=K$e.length;K$h<K$Z;K$h++){var K$S=K$e[K$h];if("render"!==K$S.props.name&&"render"!==K$S.props.renderType||!K$P._$set_itemRender)if("Graphic"==K$S.type)K$r.addGraphicsToSprite(K$S,K$P);else if(K$r.isDrawType(K$S.type))K$r.addGraphicToSprite(K$S,K$P,!0);else{var K$n=K$r.createByJson(K$S,null,K$q,K$_,K$E);"Script"==K$S.type?K$n.hasOwnProperty("owner")?K$n.owner=K$P:K$n.hasOwnProperty("target")&&(K$n.target=K$P):"mask"==K$S.props.renderType?K$P.mask=K$n:K$P.addChild(K$n)}else K$P.itemRender=K$S}if(K$b)for(var K$k in K$b){var K$x=K$b[K$k];"var"===K$k&&K$q?K$q[K$x]=K$P:K$x instanceof Array&&"function"==typeof K$P[K$k]?K$P[K$k].apply(K$P,K$x):K$P[K$k]=K$x}return K$_&&K$c.customProps&&K$_.runWith([K$P,K$c]),K$P.created&&K$P.created(),K$P},K$r.addGraphicsToSprite=function(K$c,K$P){var K$q;if((K$q=K$c.child)&&!(K$q.length<1)){var K$_;K$_=K$r._getGraphicsFromSprite(K$c,K$P);var K$E=0,K$b=0;K$c.props&&(K$E=K$r._getObjVar(K$c.props,"x",0),K$b=K$r._getObjVar(K$c.props,"y",0)),0!=K$E&&0!=K$b&&K$_.translate(K$E,K$b);var K$e,K$h=0;for(K$e=K$q.length,K$h=0;K$h<K$e;K$h++)K$r._addGraphicToGraphics(K$q[K$h],K$_);0!=K$E&&0!=K$b&&K$_.translate(-K$E,-K$b)}},K$r.addGraphicToSprite=function(K$c,K$P,K$q){var K$_;void 0===K$q&&(K$q=!1),K$_=K$q?K$r._getGraphicsFromSprite(K$c,K$P):K$P.graphics,K$r._addGraphicToGraphics(K$c,K$_)},K$r._getGraphicsFromSprite=function(K$c,K$P){var K$q,K$_;if(!K$c||!K$c.props)return K$P.graphics;switch(K$_=K$c.props.renderType){case"hit":case"unHit":var K$E;K$P.hitArea||(K$P.hitArea=new K$X),(K$E=K$P.hitArea)[K$_]||(K$E[K$_]=new K$x),K$q=K$E[K$_]}return K$q||(K$q=K$P.graphics),K$q},K$r._getTransformData=function(K$c){var K$P;(K$c.hasOwnProperty("pivotX")||K$c.hasOwnProperty("pivotY"))&&(K$P=K$P||new K$V).translate(-K$r._getObjVar(K$c,"pivotX",0),-K$r._getObjVar(K$c,"pivotY",0));var K$q=K$r._getObjVar(K$c,"scaleX",1),K$_=K$r._getObjVar(K$c,"scaleY",1),K$E=K$r._getObjVar(K$c,"rotation",0);K$r._getObjVar(K$c,"skewX",0),K$r._getObjVar(K$c,"skewY",0);return 1==K$q&&1==K$_&&0==K$E||((K$P=K$P||new K$V).scale(K$q,K$_),K$P.rotate(.0174532922222222*K$E)),K$P},K$r._addGraphicToGraphics=function(K$c,K$P){var K$q,K$_;if((K$q=K$c.props)&&(K$_=K$r.DrawTypeDic[K$c.type])){var K$E,K$b;K$E=K$P;var K$e=K$r._getParams(K$q,K$_[1],K$_[2],K$_[3]);((K$b=K$r._tM)||1!=K$r._alpha)&&(K$E.save(),K$b&&K$E.transform(K$b),1!=K$r._alpha&&K$E.alpha(K$r._alpha)),K$E[K$_[0]].apply(K$E,K$e),(K$b||1!=K$r._alpha)&&K$E.restore()}},K$r._adptLineData=function(K$c){return K$c[2]=parseFloat(K$c[0])+parseFloat(K$c[2]),K$c[3]=parseFloat(K$c[1])+parseFloat(K$c[3]),K$c},K$r._adptTextureData=function(K$c){return K$c[0]=K$hc.getRes(K$c[0]),K$c},K$r._adptLinesData=function(K$c){return K$c[2]=K$r._getPointListByStr(K$c[2]),K$c},K$r.isDrawType=function(K$c){return"Image"!=K$c&&K$r.DrawTypeDic.hasOwnProperty(K$c)},K$r._getParams=function(K$c,K$P,K$q,K$_){var K$E;void 0===K$q&&(K$q=0),(K$E=K$r._temParam).length=K$P.length;var K$b,K$e,K$h=0;for(K$b=K$P.length,K$h=0;K$h<K$b;K$h++)K$E[K$h]=K$r._getObjVar(K$c,K$P[K$h][0],K$P[K$h][1]);return K$r._alpha=K$r._getObjVar(K$c,"alpha",1),K$e=K$r._getTransformData(K$c),K$r._tM=K$e?(K$q||(K$q=0),K$e.translate(K$E[K$q],K$E[K$q+1]),K$E[K$q]=K$E[K$q+1]=0,K$e):null,K$_&&K$r[K$_]&&(K$E=K$r[K$_](K$E)),K$E},K$r._getPointListByStr=function(K$c){var K$P,K$q,K$_=0;for(K$q=(K$P=K$c.split(",")).length,K$_=0;K$_<K$q;K$_++)K$P[K$_]=parseFloat(K$P[K$_]);return K$P},K$r._getObjVar=function(K$c,K$P,K$q){return K$c.hasOwnProperty(K$P)?K$c[K$P]:K$q},K$r._temParam=[],K$r._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},K$r.getClass=function(K$c){var K$P=K$r._classMap[K$c]||K$c;return"string"==typeof K$P?K$H.__classmap[K$P]:K$P},K$r._tM=null,K$r._alpha=NaN,K$Z(K$r,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),K$r}(),K$y=function(){function K$b(K$c){if(this._color=[],"string"==typeof K$c){null===(this.strColor=K$c)&&(K$c="#000000"),"#"==K$c.charAt(0)&&(K$c=K$c.substr(1));var K$P=K$c.length;if(3==K$P||4==K$P){for(var K$q="",K$_=0;K$_<K$P;K$_++)K$q+=K$c[K$_]+K$c[K$_];K$c=K$q}var K$E=this.numColor=parseInt(K$c,16);if(8==K$c.length)return void(this._color=[parseInt(K$c.substr(0,2),16)/255,((16711680&K$E)>>16)/255,((65280&K$E)>>8)/255,(255&K$E)/255])}else K$E=this.numColor=K$c,this.strColor=K$p.toHexColor(K$E);this._color=[((16711680&K$E)>>16)/255,((65280&K$E)>>8)/255,(255&K$E)/255,1],this._color.__id=++K$b._COLODID}return K$n(K$b,"laya.utils.Color"),K$b._initDefault=function(){for(var K$c in K$b._DEFAULT={},K$b._COLOR_MAP)K$b._SAVE[K$c]=K$b._DEFAULT[K$c]=new K$b(K$b._COLOR_MAP[K$c]);return K$b._DEFAULT},K$b._initSaveMap=function(){for(var K$c in K$b._SAVE_SIZE=0,K$b._SAVE={},K$b._DEFAULT)K$b._SAVE[K$c]=K$b._DEFAULT[K$c]},K$b.create=function(K$c){var K$P=K$b._SAVE[K$c+""];return null!=K$P?K$P:(K$b._SAVE_SIZE<1e3||K$b._initSaveMap(),K$b._SAVE[K$c+""]=new K$b(K$c))},K$b._SAVE={},K$b._SAVE_SIZE=0,K$b._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},K$b._DEFAULT=K$b._initDefault(),K$b._COLODID=1,K$b}(),K$M=(function(){function K$c(){this._values=[],this._keys=[]}K$n(K$c,"laya.utils.Dictionary");var K$P=K$c.prototype;K$P.set=function(K$c,K$P){var K$q=this.indexOf(K$c);0<=K$q?this._values[K$q]=K$P:(this._keys.push(K$c),this._values.push(K$P))},K$P.indexOf=function(K$c){var K$P=this._keys.indexOf(K$c);return 0<=K$P?K$P:(K$c="string"==typeof K$c?Number(K$c):"number"==typeof K$c?K$c.toString():K$c,this._keys.indexOf(K$c))},K$P.get=function(K$c){var K$P=this.indexOf(K$c);return K$P<0?null:this._values[K$P]},K$P.remove=function(K$c){var K$P=this.indexOf(K$c);return 0<=K$P&&(this._keys.splice(K$P,1),this._values.splice(K$P,1),!0)},K$P.clear=function(){this._values.length=0,this._keys.length=0},K$g(0,K$P,"values",function(){return this._values}),K$g(0,K$P,"keys",function(){return this._keys})}(),function(){function K$c(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}K$n(K$c,"laya.utils.Dragging");var K$P=K$c.prototype;return K$P.start=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){void 0===K$h&&(K$h=.92),this.clearTimer(),this.target=K$c,this.area=K$P,this.hasInertia=K$q,this.elasticDistance=K$P?K$_:0,this.elasticBackTime=K$E,this.data=K$b,this._disableMouseEvent=K$e,this.ratio=K$h,1!=K$c.globalScaleX||1!=K$c.globalScaleY?this._parent=K$c.parent:this._parent=K$H.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,K$H.stage.on("mouseup",this,this.onStageMouseUp),K$H.stage.on("mouseout",this,this.onStageMouseUp),K$H.timer.frameLoop(1,this,this.loop)},K$P.clearTimer=function(){K$H.timer.clear(this,this.loop),K$H.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},K$P.stop=function(){this._dragging&&(K$W.instance.disableMouseEvent=!1,K$H.stage.off("mouseup",this,this.onStageMouseUp),K$H.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},K$P.loop=function(){var K$c=this._parent.getMousePoint(),K$P=K$c.x,K$q=K$c.y,K$_=K$P-this._lastX,K$E=K$q-this._lastY;if(this._clickOnly){if(!(1<Math.abs(K$_*K$H.stage._canvasTransform.getScaleX())||1<Math.abs(K$E*K$H.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),K$W.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(K$_,K$E);0==K$_&&0==K$E||(this._lastX=K$P,this._lastY=K$q,this.target.x+=K$_*this._elasticRateX,this.target.y+=K$E*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},K$P.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var K$c=this.area.x-this.target.x;else K$c=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-K$c/this.elasticDistance),this.target.y<this.area.y)var K$P=this.area.y-this.target.y;else K$P=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-K$P/this.elasticDistance)}},K$P.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},K$P.onStageMouseUp=function(K$c){if(K$W.instance.disableMouseEvent=!1,K$H.stage.off("mouseup",this,this.onStageMouseUp),K$H.stage.off("mouseout",this,this.onStageMouseUp),K$H.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var K$P=this._offsets.length,K$q=Math.min(K$P,6),K$_=this._offsets.length-K$q,K$E=K$P-1;K$_<K$E;K$E--)this._offsetY+=this._offsets[K$E--],this._offsetX+=this._offsets[K$E];this._offsetX=this._offsetX/K$q*2,this._offsetY=this._offsetY/K$q*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),K$H.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},K$P.checkElastic=function(){var K$c=NaN,K$P=NaN;if(this.target.x<this.area.x?K$c=this.area.x:this.target.x>this.area.x+this.area.width&&(K$c=this.area.x+this.area.width),this.target.y<this.area.y?K$P=this.area.y:this.target.y>this.area.y+this.area.height&&(K$P=this.area.y+this.area.height),isNaN(K$c)&&isNaN(K$P))this.clear();else{var K$q={};isNaN(K$c)||(K$q.x=K$c),isNaN(K$P)||(K$q.y=K$P),this._tween=K$B.to(this.target,K$q,this.elasticBackTime,K$z.sineOut,K$N.create(this,this.clear),0,!1,!1)}},K$P.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(K$H.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},K$P.clear=function(){if(this.target){this.clearTimer();var K$c=this.target;this.target=null,this._parent=null,K$c.event("dragend",this.data)}},K$c}()),K$z=function(){function K$h(){}return K$n(K$h,"laya.utils.Ease"),K$h.linearNone=function(K$c,K$P,K$q,K$_){return K$q*K$c/K$_+K$P},K$h.linearIn=function(K$c,K$P,K$q,K$_){return K$q*K$c/K$_+K$P},K$h.linearInOut=function(K$c,K$P,K$q,K$_){return K$q*K$c/K$_+K$P},K$h.linearOut=function(K$c,K$P,K$q,K$_){return K$q*K$c/K$_+K$P},K$h.bounceIn=function(K$c,K$P,K$q,K$_){return K$q-K$h.bounceOut(K$_-K$c,0,K$q,K$_)+K$P},K$h.bounceInOut=function(K$c,K$P,K$q,K$_){return K$c<.5*K$_?.5*K$h.bounceIn(2*K$c,0,K$q,K$_)+K$P:.5*K$h.bounceOut(2*K$c-K$_,0,K$q,K$_)+.5*K$q+K$P},K$h.bounceOut=function(K$c,K$P,K$q,K$_){return(K$c/=K$_)<1/2.75?K$q*(7.5625*K$c*K$c)+K$P:K$c<2/2.75?K$q*(7.5625*(K$c-=1.5/2.75)*K$c+.75)+K$P:K$c<2.5/2.75?K$q*(7.5625*(K$c-=2.25/2.75)*K$c+.9375)+K$P:K$q*(7.5625*(K$c-=2.625/2.75)*K$c+.984375)+K$P},K$h.backIn=function(K$c,K$P,K$q,K$_,K$E){return void 0===K$E&&(K$E=1.70158),K$q*(K$c/=K$_)*K$c*((K$E+1)*K$c-K$E)+K$P},K$h.backInOut=function(K$c,K$P,K$q,K$_,K$E){return void 0===K$E&&(K$E=1.70158),(K$c/=.5*K$_)<1?.5*K$q*(K$c*K$c*((1+(K$E*=1.525))*K$c-K$E))+K$P:K$q/2*((K$c-=2)*K$c*((1+(K$E*=1.525))*K$c+K$E)+2)+K$P},K$h.backOut=function(K$c,K$P,K$q,K$_,K$E){return void 0===K$E&&(K$E=1.70158),K$q*((K$c=K$c/K$_-1)*K$c*((K$E+1)*K$c+K$E)+1)+K$P},K$h.elasticIn=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e;return void 0===K$E&&(K$E=0),void 0===K$b&&(K$b=0),0==K$c?K$P:1==(K$c/=K$_)?K$P+K$q:(K$b||(K$b=.3*K$_),K$e=!K$E||0<K$q&&K$E<K$q||K$q<0&&K$E<-K$q?(K$E=K$q,K$b/4):K$b/K$h.PI2*Math.asin(K$q/K$E),-K$E*Math.pow(2,10*(K$c-=1))*Math.sin((K$c*K$_-K$e)*K$h.PI2/K$b)+K$P)},K$h.elasticInOut=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e;return void 0===K$E&&(K$E=0),void 0===K$b&&(K$b=0),0==K$c?K$P:2==(K$c/=.5*K$_)?K$P+K$q:(K$b||(K$b=K$_*(.3*1.5)),K$e=!K$E||0<K$q&&K$E<K$q||K$q<0&&K$E<-K$q?(K$E=K$q,K$b/4):K$b/K$h.PI2*Math.asin(K$q/K$E),K$c<1?K$E*Math.pow(2,10*(K$c-=1))*Math.sin((K$c*K$_-K$e)*K$h.PI2/K$b)*-.5+K$P:K$E*Math.pow(2,-10*(K$c-=1))*Math.sin((K$c*K$_-K$e)*K$h.PI2/K$b)*.5+K$q+K$P)},K$h.elasticOut=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e;return void 0===K$E&&(K$E=0),void 0===K$b&&(K$b=0),0==K$c?K$P:1==(K$c/=K$_)?K$P+K$q:(K$b||(K$b=.3*K$_),K$e=!K$E||0<K$q&&K$E<K$q||K$q<0&&K$E<-K$q?(K$E=K$q,K$b/4):K$b/K$h.PI2*Math.asin(K$q/K$E),K$E*Math.pow(2,-10*K$c)*Math.sin((K$c*K$_-K$e)*K$h.PI2/K$b)+K$q+K$P)},K$h.strongIn=function(K$c,K$P,K$q,K$_){return K$q*(K$c/=K$_)*K$c*K$c*K$c*K$c+K$P},K$h.strongInOut=function(K$c,K$P,K$q,K$_){return(K$c/=.5*K$_)<1?.5*K$q*K$c*K$c*K$c*K$c*K$c+K$P:.5*K$q*((K$c-=2)*K$c*K$c*K$c*K$c+2)+K$P},K$h.strongOut=function(K$c,K$P,K$q,K$_){return K$q*((K$c=K$c/K$_-1)*K$c*K$c*K$c*K$c+1)+K$P},K$h.sineInOut=function(K$c,K$P,K$q,K$_){return.5*-K$q*(Math.cos(Math.PI*K$c/K$_)-1)+K$P},K$h.sineIn=function(K$c,K$P,K$q,K$_){return-K$q*Math.cos(K$c/K$_*K$h.HALF_PI)+K$q+K$P},K$h.sineOut=function(K$c,K$P,K$q,K$_){return K$q*Math.sin(K$c/K$_*K$h.HALF_PI)+K$P},K$h.quintIn=function(K$c,K$P,K$q,K$_){return K$q*(K$c/=K$_)*K$c*K$c*K$c*K$c+K$P},K$h.quintInOut=function(K$c,K$P,K$q,K$_){return(K$c/=.5*K$_)<1?.5*K$q*K$c*K$c*K$c*K$c*K$c+K$P:.5*K$q*((K$c-=2)*K$c*K$c*K$c*K$c+2)+K$P},K$h.quintOut=function(K$c,K$P,K$q,K$_){return K$q*((K$c=K$c/K$_-1)*K$c*K$c*K$c*K$c+1)+K$P},K$h.quartIn=function(K$c,K$P,K$q,K$_){return K$q*(K$c/=K$_)*K$c*K$c*K$c+K$P},K$h.quartInOut=function(K$c,K$P,K$q,K$_){return(K$c/=.5*K$_)<1?.5*K$q*K$c*K$c*K$c*K$c+K$P:.5*-K$q*((K$c-=2)*K$c*K$c*K$c-2)+K$P},K$h.quartOut=function(K$c,K$P,K$q,K$_){return-K$q*((K$c=K$c/K$_-1)*K$c*K$c*K$c-1)+K$P},K$h.cubicIn=function(K$c,K$P,K$q,K$_){return K$q*(K$c/=K$_)*K$c*K$c+K$P},K$h.cubicInOut=function(K$c,K$P,K$q,K$_){return(K$c/=.5*K$_)<1?.5*K$q*K$c*K$c*K$c+K$P:.5*K$q*((K$c-=2)*K$c*K$c+2)+K$P},K$h.cubicOut=function(K$c,K$P,K$q,K$_){return K$q*((K$c=K$c/K$_-1)*K$c*K$c+1)+K$P},K$h.quadIn=function(K$c,K$P,K$q,K$_){return K$q*(K$c/=K$_)*K$c+K$P},K$h.quadInOut=function(K$c,K$P,K$q,K$_){return(K$c/=.5*K$_)<1?.5*K$q*K$c*K$c+K$P:.5*-K$q*(--K$c*(K$c-2)-1)+K$P},K$h.quadOut=function(K$c,K$P,K$q,K$_){return-K$q*(K$c/=K$_)*(K$c-2)+K$P},K$h.expoIn=function(K$c,K$P,K$q,K$_){return 0==K$c?K$P:K$q*Math.pow(2,10*(K$c/K$_-1))+K$P-.001*K$q},K$h.expoInOut=function(K$c,K$P,K$q,K$_){return 0==K$c?K$P:K$c==K$_?K$P+K$q:(K$c/=.5*K$_)<1?.5*K$q*Math.pow(2,10*(K$c-1))+K$P:.5*K$q*(2-Math.pow(2,-10*--K$c))+K$P},K$h.expoOut=function(K$c,K$P,K$q,K$_){return K$c==K$_?K$P+K$q:K$q*(1-Math.pow(2,-10*K$c/K$_))+K$P},K$h.circIn=function(K$c,K$P,K$q,K$_){return-K$q*(Math.sqrt(1-(K$c/=K$_)*K$c)-1)+K$P},K$h.circInOut=function(K$c,K$P,K$q,K$_){return(K$c/=.5*K$_)<1?.5*-K$q*(Math.sqrt(1-K$c*K$c)-1)+K$P:.5*K$q*(Math.sqrt(1-(K$c-=2)*K$c)+1)+K$P},K$h.circOut=function(K$c,K$P,K$q,K$_){return K$q*Math.sqrt(1-(K$c=K$c/K$_-1)*K$c)+K$P},K$h.HALF_PI=.5*Math.PI,K$h.PI2=2*Math.PI,K$h}(),K$X=function(){function K$k(){this._hit=null,this._unHit=null}K$n(K$k,"laya.utils.HitArea");var K$c=K$k.prototype;return K$c.isHit=function(K$c,K$P){return!!K$k.isHitGraphic(K$c,K$P,this.hit)&&!K$k.isHitGraphic(K$c,K$P,this.unHit)},K$c.contains=function(K$c,K$P){return this.isHit(K$c,K$P)},K$g(0,K$c,"hit",function(){return this._hit||(this._hit=new K$x),this._hit},function(K$c){this._hit=K$c}),K$g(0,K$c,"unHit",function(){return this._unHit||(this._unHit=new K$x),this._unHit},function(K$c){this._unHit=K$c}),K$k.isHitGraphic=function(K$c,K$P,K$q){if(!K$q)return!1;var K$_;if(!(K$_=K$q.cmds)&&K$q._one&&((K$_=K$k._cmds).length=1,K$_[0]=K$q._one),!K$_)return!1;var K$E,K$b,K$e=0;for(K$E=K$_.length,K$e=0;K$e<K$E;K$e++)if(K$b=K$_[K$e]){var K$h=K$C._context;switch(K$b.callee){case K$h._translate:case 6:K$c-=K$b[0],K$P-=K$b[1]}if(K$k.isHitCmd(K$c,K$P,K$b))return!0}return!1},K$k.isHitCmd=function(K$c,K$P,K$q){if(!K$q)return!1;var K$_=K$C._context,K$E=!1;switch(K$q.callee){case K$_._drawRect:case 13:K$k._rec.setTo(K$q[0],K$q[1],K$q[2],K$q[3]),K$E=K$k._rec.contains(K$c,K$P);break;case K$_._drawCircle:case K$_._fillCircle:case 14:K$E=(K$c-=K$q[0])*K$c+(K$P-=K$q[1])*K$P<K$q[2]*K$q[2];break;case K$_._drawPoly:case 18:K$c-=K$q[0],K$P-=K$q[1],K$E=K$k.ptInPolygon(K$c,K$P,K$q[2])}return K$E},K$k.ptInPolygon=function(K$c,K$P,K$q){var K$_;(K$_=K$k._ptPoint).setTo(K$c,K$P);var K$E,K$b=0,K$e=NaN,K$h=NaN,K$Z=NaN,K$S=NaN;K$E=K$q.length;for(var K$n=0;K$n<K$E;K$n+=2){if(K$e=K$q[K$n],K$h=K$q[K$n+1],K$Z=K$q[(K$n+2)%K$E],K$h!=(K$S=K$q[(K$n+3)%K$E]))if(!(K$_.y<Math.min(K$h,K$S)))if(!(K$_.y>=Math.max(K$h,K$S)))(K$_.y-K$h)*(K$Z-K$e)/(K$S-K$h)+K$e>K$_.x&&K$b++}return K$b%2==1},K$k._cmds=[],K$Z(K$k,["_rec",function(){return this._rec=new K$d},"_ptPoint",function(){return this._ptPoint=new K$Q}]),K$k}(),K$f=(function(){function K$E(K$c,K$P,K$q,K$_){this.char=K$c,this.charNum=K$c.charCodeAt(0),this._x=this._y=0,this.width=K$P,this.height=K$q,this.style=K$_,this.isWord=!K$E._isWordRegExp.test(K$c)}K$n(K$E,"laya.utils.HTMLChar");var K$c=K$E.prototype;K$H.imps(K$c,{"laya.display.ILayout":!0}),K$c.setSprite=function(K$c){this._sprite=K$c},K$c.getSprite=function(){return this._sprite},K$c._isChar=function(){return!0},K$c._getCSSStyle=function(){return this.style},K$g(0,K$c,"width",function(){return this._w},function(K$c){this._w=K$c}),K$g(0,K$c,"x",function(){return this._x},function(K$c){this._sprite&&(this._sprite.x=K$c),this._x=K$c}),K$g(0,K$c,"y",function(){return this._y},function(K$c){this._sprite&&(this._sprite.y=K$c),this._y=K$c}),K$g(0,K$c,"height",function(){return this._h},function(K$c){this._h=K$c}),K$E._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function K$P(){}K$n(K$P,"laya.utils.Log"),K$P.enable=function(){K$P._logdiv||(K$P._logdiv=K$s.window.document.createElement("div"),K$s.window.document.body.appendChild(K$P._logdiv),K$P._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},K$P.toggle=function(){var K$c=K$P._logdiv.style;"1px"==K$c.width?K$c.width=K$c.height="50%":K$c.width=K$c.height="1px"},K$P.print=function(K$c){K$P._logdiv&&(K$P.maxCount<=K$P._count&&K$P.clear(),K$P._count++,K$P._logdiv.innerText+=K$c+"\n",K$P._logdiv.scrollTop=K$P._logdiv.scrollHeight)},K$P.clear=function(){K$P._logdiv.innerText="",K$P._count=0},K$P._logdiv=null,K$P._count=0,K$P.maxCount=20}(),function(){function K$P(){}K$n(K$P,"laya.utils.Mouse"),K$g(1,K$P,"cursor",function(){return K$P._style.cursor},function(K$c){K$P._style.cursor=K$c}),K$P.hide=function(){"none"!=K$P.cursor&&(K$P._preCursor=K$P.cursor,K$P.cursor="none")},K$P.show=function(){"none"==K$P.cursor&&(K$P.cursor=K$P._preCursor?K$P._preCursor:"auto")},K$P._preCursor=null,K$Z(K$P,["_style",function(){return this._style=K$s.document.body.style}])}(),function(){function K$b(){}return K$n(K$b,"laya.utils.Pool"),K$b.getPoolBySign=function(K$c){return K$b._poolDic[K$c]||(K$b._poolDic[K$c]=[])},K$b.clearBySign=function(K$c){K$b._poolDic[K$c]&&(K$b._poolDic[K$c].length=0)},K$b.recover=function(K$c,K$P){K$P.__InPool||(K$P.__InPool=!0,K$b.getPoolBySign(K$c).push(K$P))},K$b.getItemByClass=function(K$c,K$P){var K$q=K$b.getPoolBySign(K$c),K$_=K$q.length?K$q.pop():new K$P;return K$_.__InPool=!1,K$_},K$b.getItemByCreateFun=function(K$c,K$P,K$q){var K$_=K$b.getPoolBySign(K$c),K$E=K$_.length?K$_.pop():K$P.call(K$q);return K$E.__InPool=!1,K$E},K$b.getItem=function(K$c){var K$P=K$b.getPoolBySign(K$c),K$q=K$P.length?K$P.pop():null;return K$q&&(K$q.__InPool=!1),K$q},K$b._poolDic={},K$b.InPoolSign="__InPool",K$b}()),K$l=function(){function K$Z(){}return K$n(K$Z,"laya.utils.Stat"),K$g(1,K$Z,"onclick",null,function(K$c){K$Z._sp&&K$Z._sp.on("click",K$Z._sp,K$c),K$Z._canvas&&(K$Z._canvas.source.onclick=K$c,K$Z._canvas.source.style.pointerEvents="")}),K$Z.show=function(K$c,K$P,K$q){if(void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),!K$C.isConchApp||K$C.isConchWebGL){if(K$C.isConchWebGL||K$s.onMiniGame||K$s.onLimixiu||(K$Z._useCanvas=!0),K$Z._show=!0,K$Z._fpsData.length=60,K$Z._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},K$Z._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},K$Z._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},K$Z._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},K$C.isWebGL)if(K$Z._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},K$C.is3DMode){if(K$Z._view[0].title="FPS(3D)",K$Z._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},K$Z._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},K$Z._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==K$q){var K$_=8;K$Z._view[K$_++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},K$Z._view[K$_++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},K$Z._view[K$_++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},K$Z._view[K$_++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},K$Z._view[K$_++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},K$Z._view[K$_++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},K$Z._view[K$_++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},K$Z._view[K$_++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},K$Z._view[K$_++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==K$q){K$_=8;K$Z._view[K$_++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},K$Z._view[K$_++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},K$Z._view[K$_++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},K$Z._view[K$_++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},K$Z._view[K$_++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},K$Z._view[K$_++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},K$Z._view[K$_++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else K$Z._view[0].title="FPS(WebGL)",K$Z._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else K$Z._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};K$Z._useCanvas?K$Z.createUIPre(K$c,K$P):K$Z.createUI(K$c,K$P),K$Z.enable()}else K$s.window.conch.showFPS&&K$s.window.conch.showFPS(K$c,K$P)},K$Z.createUIPre=function(K$c,K$P){var K$q=K$s.pixelRatio;K$Z._width=170*K$q,K$Z._vx=75*K$q,K$Z._height=K$q*(12*K$Z._view.length+3*K$q)+4,K$Z._fontSize=12*K$q;for(var K$_=0;K$_<K$Z._view.length;K$_++)K$Z._view[K$_].x=4,K$Z._view[K$_].y=K$_*K$Z._fontSize+2*K$q;K$Z._canvas||((K$Z._canvas=new K$mc("2D")).size(K$Z._width,K$Z._height),(K$Z._ctx=K$Z._canvas.getContext("2d")).textBaseline="top",K$Z._ctx.font=K$Z._fontSize+"px Sans-serif",K$Z._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+K$c+"px;top:"+K$P+"px;width:"+K$Z._width/K$q+"px;height:"+K$Z._height/K$q+"px;"),K$Z._first=!0,K$Z.loop(),K$Z._first=!1,K$s.container.appendChild(K$Z._canvas.source)},K$Z.createUI=function(K$c,K$P){var K$q=K$Z._sp,K$_=K$s.pixelRatio;K$q||(K$q=new K$kc,(K$Z._leftText=new K$wc).pos(5,5),K$Z._leftText.color="#ffffff",K$q.addChild(K$Z._leftText),(K$Z._txt=new K$wc).pos(80*K$_,5),K$Z._txt.color="#ffffff",K$q.addChild(K$Z._txt),K$Z._sp=K$q),K$q.pos(K$c,K$P);for(var K$E="",K$b=0;K$b<K$Z._view.length;K$b++){K$E+=K$Z._view[K$b].title+"\n"}K$Z._leftText.text=K$E;var K$e=170*K$_,K$h=K$_*(12*K$Z._view.length+3*K$_)+4;K$Z._txt.fontSize=K$Z._fontSize*K$_,K$Z._leftText.fontSize=K$Z._fontSize*K$_,K$q.size(K$e,K$h),K$q.graphics.clear(),K$q.graphics.setAlpha(.5),K$q.graphics.drawRect(0,0,K$e,K$h,"#999999"),K$q.graphics.setAlpha(1),K$Z.loop()},K$Z.enable=function(){K$H.timer.frameLoop(1,K$Z,K$Z.loop)},K$Z.hide=function(){K$Z._show=!1,K$H.timer.clear(K$Z,K$Z.loop),K$Z._canvas&&K$s.removeElement(K$Z._canvas.source)},K$Z.clear=function(){K$Z.trianglesFaces=K$Z.drawCall=K$Z.shaderCall=K$Z.spriteCount=K$Z.spriteRenderUseCacheCount=K$Z.treeNodeCollision=K$Z.treeSpriteCollision=K$Z.canvasNormal=K$Z.canvasBitmap=K$Z.canvasReCache=0},K$Z.loop=function(){K$Z._count++;var K$c=K$s.now();if(!(K$c-K$Z._timer<1e3)){var K$P=K$Z._count;if(K$Z.FPS=Math.round(1e3*K$P/(K$c-K$Z._timer)),K$Z._show){K$Z.trianglesFaces=Math.round(K$Z.trianglesFaces/K$P),K$Z.spriteCount=K$Z._useCanvas?(K$Z.drawCall=Math.round(K$Z.drawCall/K$P)-2,K$Z.shaderCall=Math.round(K$Z.shaderCall/K$P),Math.round(K$Z.spriteCount/K$P)-1):(K$Z.drawCall=Math.round(K$Z.drawCall/K$P)-2,K$Z.shaderCall=Math.round(K$Z.shaderCall/K$P)-4,Math.round(K$Z.spriteCount/K$P)-4),K$Z.spriteRenderUseCacheCount=Math.round(K$Z.spriteRenderUseCacheCount/K$P),K$Z.canvasNormal=Math.round(K$Z.canvasNormal/K$P),K$Z.canvasBitmap=Math.round(K$Z.canvasBitmap/K$P),K$Z.canvasReCache=Math.ceil(K$Z.canvasReCache/K$P),K$Z.treeNodeCollision=Math.round(K$Z.treeNodeCollision/K$P),K$Z.treeSpriteCollision=Math.round(K$Z.treeSpriteCollision/K$P);var K$q=0<K$Z.FPS?Math.floor(1e3/K$Z.FPS).toString():" ";K$Z._fpsStr=K$Z.FPS+(K$Z.renderSlow?" slow":"")+" "+K$q,K$Z._spriteStr=K$Z.spriteCount+(K$Z.spriteRenderUseCacheCount?"/"+K$Z.spriteRenderUseCacheCount:""),K$Z._canvasStr=K$Z.canvasReCache+"/"+K$Z.canvasNormal+"/"+K$Z.canvasBitmap,K$Z.currentMemorySize=K$Y.systemResourceManager.memorySize,K$Z._useCanvas?K$Z.renderInfoPre():K$Z.renderInfo(),K$Z.clear()}K$Z._count=0,K$Z._timer=K$c}},K$Z.renderInfoPre=function(){if(K$Z._canvas){var K$c=K$Z._ctx;K$c.clearRect(K$Z._first?0:K$Z._vx,0,K$Z._width,K$Z._height);for(var K$P=K$C.WebGL.mainContext,K$q=0;K$q<K$Z._view.length;K$q++){var K$_=K$Z._view[K$q];K$Z._first&&(K$c.fillStyle="white",K$c.fillText(K$_.title,K$_.x,K$_.y,null,null,null)),K$c.fillStyle=K$_.color;var K$E=-1;if((K$_=K$Z._view[K$q]).varying){if(K$P)switch(K$_.varying){case 1:K$E=K$P.getParameter(K$P[K$_.value]);break;case 2:K$E=K$P.getExtension(K$_.value)}}else K$E=K$Z[K$_.value];"M"==K$_.units&&(K$E=Math.floor(K$E/1048576*100)/100+" M"),"K"==K$_.units&&(K$E=Math.floor(K$E/1024*100)/100+" K"),"string"==K$_.units&&(K$E=K$E.match(/\d+\.?\d/i)),K$c.fillText(K$E+"",K$_.x+K$Z._vx,K$_.y,null,null,null)}}},K$Z.renderInfo=function(){for(var K$c="",K$P=K$C.WebGL.mainContext,K$q=0;K$q<K$Z._view.length;K$q++){var K$_=K$Z._view[K$q],K$E=-1;if(K$_.varying){if(K$P)switch(K$_.varying){case 1:K$E=K$P.getParameter(K$P[K$_.value]);break;case 2:K$E=K$P.getExtension(K$_.value)}}else K$E=K$Z[K$_.value];"M"==K$_.units&&(K$E=Math.floor(K$E/1048576*100)/100+" M"),"K"==K$_.units&&(K$E=Math.floor(K$E/1024*100)/100+" K"),"string"==K$_.units&&(K$E=K$E.match(/\d+\.?\d/i)),K$c+=K$E+"\n"}K$Z._txt.text=K$c},K$Z.FPS=0,K$Z.loopCount=0,K$Z.shaderCall=0,K$Z.drawCall=0,K$Z.trianglesFaces=0,K$Z.spriteCount=0,K$Z.spriteRenderUseCacheCount=0,K$Z.treeNodeCollision=0,K$Z.treeSpriteCollision=0,K$Z.canvasNormal=0,K$Z.canvasBitmap=0,K$Z.canvasReCache=0,K$Z.renderSlow=!1,K$Z.currentMemorySize=0,K$Z._fpsStr=null,K$Z._canvasStr=null,K$Z._spriteStr=null,K$Z._fpsData=[],K$Z._timer=0,K$Z._count=0,K$Z._view=[],K$Z._fontSize=12,K$Z._txt=null,K$Z._leftText=null,K$Z._sp=null,K$Z._show=!1,K$Z._useCanvas=!1,K$Z._canvas=null,K$Z._ctx=null,K$Z._first=!1,K$Z._vx=NaN,K$Z._width=0,K$Z._height=100,K$Z}(),K$t=(function(){function K$c(){this._strsToID={},this._idToStrs=[],this._length=0}K$n(K$c,"laya.utils.StringKey");var K$P=K$c.prototype;K$P.add=function(K$c){var K$P=this._strsToID[K$c];return null!=K$P?K$P:(this._idToStrs[this._length]=K$c,this._strsToID[K$c]=this._length++)},K$P.getID=function(K$c){var K$P=this._strsToID[K$c];return null==K$P?-1:K$P},K$P.getName=function(K$c){var K$P=this._idToStrs[K$c];return null==K$P?void 0:K$P}}(),function(){var K$S;function K$c(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}K$n(K$c,"laya.utils.Timer");var K$P=K$c.prototype;return K$P._init=function(){K$H.timer&&K$H.timer.frameLoop(1,this,this._update)},K$P._now=function(){return Date.now()},K$P._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var K$c=this.currFrame=this.currFrame+this.scale,K$P=this._now();this._delta=(K$P-this._lastTimer)*this.scale;var K$q=this.currTimer=this.currTimer+this._delta;K$H.isDebug&&6e4<Math.abs(K$P-this._lastTimer)&&console.error("系统时间错误！"+(K$P-this._lastTimer)),this._lastTimer=K$P;var K$_=this._handlers;for(K$e=this._count=0,K$h=K$_.length;K$e<K$h;K$e++)if(null!==(K$Z=K$_[K$e]).method){var K$E=K$Z.userFrame?K$c:K$q;if(K$E>=K$Z.exeTime)if(K$Z.repeat)if(K$Z.jumpFrame)for(;K$E>=K$Z.exeTime;)K$Z.exeTime+=K$Z.delay,K$Z.run(!1);else K$Z.exeTime+=K$Z.delay,K$Z.run(!1),K$E>K$Z.exeTime&&(K$Z.exeTime+=Math.ceil((K$E-K$Z.exeTime)/K$Z.delay)*K$Z.delay);else K$Z.run(!0)}else this._count++;(30<this._count||K$c%200==0)&&this._clearHandlers();for(var K$b=this._laters,K$e=0,K$h=K$b.length-1;K$e<=K$h;K$e++){var K$Z=K$b[K$e];this._isIgnoreRecover(K$Z)||(null!==K$Z.method&&(delete this._map[K$Z.key],K$Z.run(!1)),this._recoverHandler(K$Z)),K$e===K$h&&(K$h=K$b.length-1)}K$b.length=0}},K$P._clearHandlers=function(){for(var K$c=this._handlers,K$P=0,K$q=K$c.length;K$P<K$q;K$P++){var K$_=K$c[K$P];null!==K$_.method?this._temp.push(K$_):this._isIgnoreRecover(K$_)?this._temp.push(K$_):this._recoverHandler(K$_)}this._handlers=this._temp,this._temp=K$c,this._temp.length=0},K$P._recoverHandler=function(K$c){this._map[K$c.key]==K$c&&delete this._map[K$c.key],K$c.recover()},K$P._create=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){if(!K$q)return K$E.apply(K$_,K$b),null;if(K$e){var K$Z=this._getHandler(K$_,K$E);if(K$Z)return K$Z.repeat=K$P,K$Z.userFrame=K$c,K$Z.delay=K$q,K$Z.ignoreRecover=K$h,K$Z.caller=K$_,K$Z.method=K$E,K$Z.args=K$b,K$Z.exeTime=K$q+(K$c?this.currFrame:this.currTimer+this._now()-this._lastTimer),K$Z}return(K$Z=K$S.create()).repeat=K$P,K$Z.userFrame=K$c,K$Z.delay=K$q,K$Z.ignoreRecover=K$h,K$Z.caller=K$_,K$Z.method=K$E,K$Z.args=K$b,K$Z.exeTime=K$q+(K$c?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(K$Z),this._handlers.push(K$Z),K$Z},K$P._indexHandler=function(K$c){var K$P=K$c.caller,K$q=K$c.method,K$_=K$P?K$P.$_GID||(K$P.$_GID=K$p.getGID()):0,K$E=K$q.$_TID||(K$q.$_TID=this._mid++);K$c.key=K$_+"_"+K$E,this._map[K$c.key]=K$c},K$P.once=function(K$c,K$P,K$q,K$_,K$E){void 0===K$E&&(K$E=!0),this._create(!1,!1,K$c,K$P,K$q,K$_,K$E,!1)},K$P.loop=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){void 0===K$E&&(K$E=!0),void 0===K$b&&(K$b=!1),void 0===K$e&&(K$e=!1);var K$h=this._create(!1,!0,K$c,K$P,K$q,K$_,K$E,K$e);K$h&&(K$h.jumpFrame=K$b)},K$P.frameOnce=function(K$c,K$P,K$q,K$_,K$E){void 0===K$E&&(K$E=!0),this._create(!0,!1,K$c,K$P,K$q,K$_,K$E,!1)},K$P.frameLoop=function(K$c,K$P,K$q,K$_,K$E,K$b){void 0===K$E&&(K$E=!0),void 0===K$b&&(K$b=!1),this._create(!0,!0,K$c,K$P,K$q,K$_,K$E,K$b)},K$P.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+K$S._freeCount},K$P.clear=function(K$c,K$P){var K$q=this._getHandler(K$c,K$P);return!(!K$q||this._isIgnoreRecover(K$q))&&(delete this._map[K$q.key],K$q.key=null,K$q.clear(),!0)},K$P.clearAll=function(K$c){if(K$c)for(var K$P=0,K$q=this._handlers.length;K$P<K$q;K$P++){var K$_=this._handlers[K$P];K$_.caller===K$c&&(this._isIgnoreRecover(K$_)||(delete this._map[K$_.key],K$_.key=null,K$_.clear()))}},K$P._getHandler=function(K$c,K$P){var K$q=K$c?K$c.$_GID||(K$c.$_GID=K$p.getGID()):0,K$_=K$P.$_TID||(K$P.$_TID=this._mid++);return this._map[K$q+"_"+K$_]},K$P._isIgnoreRecover=function(K$c){if(K$c.ignoreRecover||K$c.caller&&"IgnoreRecover"==K$c.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var K$P="";try{arguments.propertyIsEnumerable.caller}catch(K$c){K$P=K$c.stack}K$H.recordError("报错：核心定时器销毁忽略  "+K$P)}return!0}return!1},K$P.hasHandler=function(K$c,K$P){return this._map[K$c.$_GID+"_"+K$P.$_TID]},K$P.callLater=function(K$c,K$P,K$q){if(null==this._getHandler(K$c,K$P)){var K$_=K$S.create();K$_.caller=K$c,K$_.method=K$P,K$_.args=K$q,this._indexHandler(K$_),this._laters.push(K$_)}},K$P.runCallLater=function(K$c,K$P){var K$q=this._getHandler(K$c,K$P);K$q&&null!=K$q.method&&(this._isIgnoreRecover(K$q)||(delete this._map[K$q.key],K$q.run(!0)))},K$P.runTimer=function(K$c,K$P){this.runCallLater(K$c,K$P)},K$g(0,K$P,"delta",function(){return this._delta}),K$c.__init$=function(){K$S=function(){function K$P(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}K$n(K$P,"");var K$c=K$P.prototype;return K$c.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},K$c.recover=function(){this.clear(),this.args=K$P._freeHandler,K$P._freeHandler=this,K$P._freeCount++},K$c.run=function(K$c){var K$P=this.caller;if(K$P&&K$P.destroyed)return this.clear();var K$q=this.method,K$_=this.args;K$c&&this.clear(),null!=K$q&&(K$_?K$q.apply(K$P,K$_):K$q.call(K$P))},K$P._freeHandler=null,K$P._freeCount=0,K$P.create=function(){var K$c=K$P._freeHandler;return K$c?(K$P._freeHandler=K$c.args,--K$P._freeCount,K$c.args=null,K$c):new K$P},K$P}()},K$c}()),K$B=function(){function K$k(){this.gid=0}K$n(K$k,"laya.utils.Tween");var K$c=K$k.prototype;return K$c.to=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){return void 0===K$b&&(K$b=0),void 0===K$e&&(K$e=!1),this._create(K$c,K$P,K$q,K$_,K$E,K$b,K$e,!0,!1,!0)},K$c.from=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){return void 0===K$b&&(K$b=0),void 0===K$e&&(K$e=!1),this._create(K$c,K$P,K$q,K$_,K$E,K$b,K$e,!1,!1,!0)},K$c._create=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){if(!K$c)throw new Error("Tween:target is null");this._target=K$c,this._duration=K$q,this._ease=K$_||K$P.ease||K$k.easeNone,this._complete=K$E||K$P.complete,this._delay=K$b,this._props=[],this._usedTimer=0,this._startTimer=K$s.now(),this._usedPool=K$Z,this._delayParam=null,this.update=K$P.update;var K$n=K$c.$_GID||(K$c.$_GID=K$p.getGID());return K$k.tweenMap[K$n]?(K$e&&K$k.clearTween(K$c),K$k.tweenMap[K$n].push(this)):K$k.tweenMap[K$n]=[this],K$S?K$b<=0?this.firstStart(K$c,K$P,K$h):(this._delayParam=[K$c,K$P,K$h],K$H.scaleTimer.once(K$b,this,this.firstStart,this._delayParam)):this._initProps(K$c,K$P,K$h),this},K$c.firstStart=function(K$c,K$P,K$q){this._delayParam=null,K$c.destroyed?this.clear():(this._initProps(K$c,K$P,K$q),this._beginLoop())},K$c._initProps=function(K$c,K$P,K$q){for(var K$_ in K$P)if("number"==typeof K$c[K$_]){var K$E=K$q?K$c[K$_]:K$P[K$_],K$b=K$q?K$P[K$_]:K$c[K$_];this._props.push([K$_,K$E,K$b-K$E]),K$q||(K$c[K$_]=K$E)}},K$c._beginLoop=function(){K$H.scaleTimer.frameLoop(1,this,this._doEase)},K$c._doEase=function(){this._updateEase(K$s.now())},K$c._updateEase=function(K$c){var K$P=this._target;if(K$P){if(K$P.destroyed)return K$k.clearTween(K$P);var K$q=this._usedTimer=K$c-this._startTimer-this._delay;if(!(K$q<0)){if(K$q>=this._duration)return this.complete();for(var K$_=0<K$q?this._ease(K$q,0,1,this._duration):0,K$E=this._props,K$b=0,K$e=K$E.length;K$b<K$e;K$b++){var K$h=K$E[K$b];K$P[K$h[0]]=K$h[1]+K$_*K$h[2]}this.update&&this.update.run()}}},K$c.complete=function(){if(this._target){K$H.scaleTimer.runTimer(this,this.firstStart);for(var K$c=this._target,K$P=this._props,K$q=this._complete,K$_=0,K$E=K$P.length;K$_<K$E;K$_++){var K$b=K$P[K$_];K$c[K$b[0]]=K$b[1]+K$b[2]}this.update&&this.update.run(),this.clear(),K$q&&K$q.run()}},K$c.pause=function(){K$H.scaleTimer.clear(this,this._beginLoop),K$H.scaleTimer.clear(this,this._doEase),K$H.scaleTimer.clear(this,this.firstStart);var K$c;(K$c=K$s.now()-this._startTimer-this._delay)<0&&(this._usedTimer=K$c)},K$c.setStartTime=function(K$c){this._startTimer=K$c},K$c.clear=function(){this._target&&(this._remove(),this._clear())},K$c._clear=function(){this.pause(),K$H.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,K$f.recover("tween",this))},K$c.recover=function(){this._usedPool=!0,this._clear()},K$c._remove=function(){var K$c=K$k.tweenMap[this._target.$_GID];if(K$c)for(var K$P=0,K$q=K$c.length;K$P<K$q;K$P++)if(K$c[K$P]===this){K$c.splice(K$P,1);break}},K$c.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=K$s.now(),this._delayParam)K$H.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var K$c=this._props,K$P=0,K$q=K$c.length;K$P<K$q;K$P++){var K$_=K$c[K$P];this._target[K$_[0]]=K$_[1]}K$H.scaleTimer.once(this._delay,this,this._beginLoop)}},K$c.resume=function(){this._usedTimer>=this._duration||(this._startTimer=K$s.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?K$H.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},K$g(0,K$c,"progress",null,function(K$c){var K$P=K$c*this._duration;this._startTimer=K$s.now()-this._delay-K$P}),K$k.to=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){return void 0===K$b&&(K$b=0),void 0===K$e&&(K$e=!1),void 0===K$h&&(K$h=!0),K$f.getItemByClass("tween",K$k)._create(K$c,K$P,K$q,K$_,K$E,K$b,K$e,!0,K$h,!0)},K$k.from=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){return void 0===K$b&&(K$b=0),void 0===K$e&&(K$e=!1),void 0===K$h&&(K$h=!0),K$f.getItemByClass("tween",K$k)._create(K$c,K$P,K$q,K$_,K$E,K$b,K$e,!1,K$h,!0)},K$k.clearAll=function(K$c){if(K$c&&K$c.$_GID){var K$P=K$k.tweenMap[K$c.$_GID];if(K$P){for(var K$q=0,K$_=K$P.length;K$q<K$_;K$q++)K$P[K$q]._clear();K$P.length=0}}},K$k.clear=function(K$c){K$c.clear()},K$k.clearTween=function(K$c){K$k.clearAll(K$c)},K$k.easeNone=function(K$c,K$P,K$q,K$_){return K$q*K$c/K$_+K$P},K$k.tweenMap={},K$k}(),K$p=function(){function K$h(){}return K$n(K$h,"laya.utils.Utils"),K$h.toRadian=function(K$c){return K$c*K$h._pi2},K$h.toAngle=function(K$c){return K$c*K$h._pi},K$h.toHexColor=function(K$c){if(K$c<0||isNaN(K$c))return null;for(var K$P=K$c.toString(16);K$P.length<6;)K$P="0"+K$P;return"#"+K$P},K$h.getGID=function(){return K$h._gid++},K$h.concatArray=function(K$c,K$P){if(!K$P)return K$c;if(!K$c)return K$P;var K$q=0,K$_=K$P.length;for(K$q=0;K$q<K$_;K$q++)K$c.push(K$P[K$q]);return K$c},K$h.clearArray=function(K$c){return K$c&&(K$c.length=0),K$c},K$h.copyArray=function(K$c,K$P){if(K$c||(K$c=[]),!K$P)return K$c;K$c.length=K$P.length;var K$q=0,K$_=K$P.length;for(K$q=0;K$q<K$_;K$q++)K$c[K$q]=K$P[K$q];return K$c},K$h.getGlobalRecByPoints=function(K$c,K$P,K$q,K$_,K$E){var K$b,K$e;return K$b=new K$Q(K$P,K$q),K$b=K$c.localToGlobal(K$b),K$e=new K$Q(K$_,K$E),K$e=K$c.localToGlobal(K$e),K$d._getWrapRec([K$b.x,K$b.y,K$e.x,K$e.y])},K$h.getGlobalPosAndScale=function(K$c){return K$h.getGlobalRecByPoints(K$c,0,0,1,1)},K$h.bind=function(K$c,K$P){return K$c.bind(K$P)},K$h.measureText=function(K$c,K$P){return K$j.measureText(K$c,K$P)},K$h.contextMeasureText=function(K$c){var K$P=K$s.context.measureText(K$c);return K$P||(K$P={width:16,height:16}),K$P},K$h.updateOrder=function(K$c){if(!K$c||K$c.length<2)return!1;for(var K$P,K$q=1,K$_=0,K$E=K$c.length,K$b=NaN;K$q<K$E;){for(K$P=K$c[K$_=K$q],K$b=K$c[K$_]._zOrder;-1<--K$_&&K$c[K$_]._zOrder>K$b;)K$c[K$_+1]=K$c[K$_];K$c[K$_+1]=K$P,K$q++}var K$e=K$P.parent.conchModel;if(K$e)if(null!=K$e.updateZOrder)K$e.updateZOrder();else{for(K$q=0;K$q<K$E;K$q++)K$e.removeChild(K$c[K$q].conchModel);for(K$q=0;K$q<K$E;K$q++)K$e.addChildAt(K$c[K$q].conchModel,K$q)}return!0},K$h.transPointList=function(K$c,K$P,K$q){var K$_=0,K$E=K$c.length;for(K$_=0;K$_<K$E;K$_+=2)K$c[K$_]+=K$P,K$c[K$_+1]+=K$q},K$h.parseInt=function(K$c,K$P){void 0===K$P&&(K$P=0);var K$q=K$s.window.parseInt(K$c,K$P);return isNaN(K$q)?0:K$q},K$h.getFileExtension=function(K$c){K$h._extReg.lastIndex=K$c.lastIndexOf(".");var K$P=K$h._extReg.exec(K$c);return K$P&&1<K$P.length?K$P[1].toLowerCase():null},K$h.getTransformRelativeToWindow=function(K$c,K$P,K$q){var K$_=K$H.stage,K$E=laya.utils.Utils.getGlobalPosAndScale(K$c),K$b=K$_._canvasTransform.clone(),K$e=K$b.tx,K$h=K$b.ty;K$b.rotate(-Math.PI/180*K$H.stage.canvasDegree),K$b.scale(K$H.stage.clientScaleX,K$H.stage.clientScaleY);var K$Z=K$H.stage.canvasDegree%180!=0,K$S=NaN,K$n=NaN;K$Z?(K$S=K$q+K$E.y,K$n=K$P+K$E.x,K$S*=K$b.d,K$n*=K$b.a,90==K$H.stage.canvasDegree?(K$S=K$e-K$S,K$n+=K$h):(K$S+=K$e,K$n=K$h-K$n)):(K$S=K$P+K$E.x,K$n=K$q+K$E.y,K$S*=K$b.a,K$n*=K$b.d,K$S+=K$e,K$n+=K$h);var K$k=NaN,K$x=NaN;return K$x=K$Z?(K$k=K$b.d*K$E.height,K$b.a*K$E.width):(K$k=K$b.a*K$E.width,K$b.d*K$E.height),{x:K$S,y:K$n,scaleX:K$k,scaleY:K$x}},K$h.fitDOMElementInArea=function(K$c,K$P,K$q,K$_,K$E,K$b){K$c._fitLayaAirInitialized||(K$c._fitLayaAirInitialized=!0,K$c.style.transformOrigin=K$c.style.webKittransformOrigin="left top",K$c.style.position="absolute");var K$e=K$h.getTransformRelativeToWindow(K$P,K$q,K$_);K$c.style.transform=K$c.style.webkitTransform="scale("+K$e.scaleX+","+K$e.scaleY+") rotate("+K$H.stage.canvasDegree+"deg)",K$c.style.width=K$E+"px",K$c.style.height=K$b+"px",K$c.style.left=K$e.x+"px",K$c.style.top=K$e.y+"px"},K$h.isOkTextureList=function(K$c){if(!K$c)return!1;var K$P,K$q=0,K$_=K$c.length;for(K$q=0;K$q<K$_;K$q++)if(!(K$P=K$c[K$q])||!K$P.source)return!1;return!0},K$h.isOKCmdList=function(K$c){if(!K$c)return!1;var K$P,K$q,K$_=0,K$E=K$c.length,K$b=K$C._context;for(K$_=0;K$_<K$E;K$_++)switch((K$P=K$c[K$_]).callee){case K$b._drawTexture:case K$b._fillTexture:case K$b._drawTextureWithTransform:if(!(K$q=K$P[0])||!K$q.source)return!1}return!0},K$h._gid=1,K$h._pi=180/Math.PI,K$h._pi2=Math.PI/180,K$h._extReg=/\.(\w+)\??/g,K$h.parseXMLFromString=function(K$c){var K$P;if(K$c=K$c.replace(/>\s+</g,"><"),-1<(K$P=(new DOMParser).parseFromString(K$c,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(K$P.firstChild.firstChild.textContent);return K$P},K$h}(),K$i=function(){function K$c(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],K$C.isWebGL&&K$I.regCacheByFunction(K$p.bind(this.startDispose,this),K$p.bind(this.getCacheList,this))}K$n(K$c,"laya.utils.VectorGraphManager");var K$P=K$c.prototype;return K$P.getId=function(){return this._id++},K$P.addShape=function(K$c,K$P){this.shapeDic[K$c]=K$P,this.useDic[K$c]||(this.useDic[K$c]=!0)},K$P.addLine=function(K$c,K$P){this.shapeLineDic[K$c]=K$P,this.shapeLineDic[K$c]||(this.shapeLineDic[K$c]=!0)},K$P.getShape=function(K$c){this._checkKey&&null!=this.useDic[K$c]&&(this.useDic[K$c]=!0)},K$P.deleteShape=function(K$c){this.shapeDic[K$c]&&(this.shapeDic[K$c]=null,delete this.shapeDic[K$c]),this.shapeLineDic[K$c]&&(this.shapeLineDic[K$c]=null,delete this.shapeLineDic[K$c]),null!=this.useDic[K$c]&&delete this.useDic[K$c]},K$P.getCacheList=function(){var K$c,K$P=[];for(K$c in this.shapeDic)K$P.push(this.shapeDic[K$c]);for(K$c in this.shapeLineDic)K$P.push(this.shapeLineDic[K$c]);return K$P},K$P.startDispose=function(K$c){var K$P;for(K$P in this.useDic)this.useDic[K$P]=!1;this._checkKey=!0},K$P.endDispose=function(){if(this._checkKey){var K$c;for(K$c in this.useDic)this.useDic[K$c]||this.deleteShape(K$c);this._checkKey=!1}},K$c.getInstance=function(){return K$c.instance=K$c.instance||new K$c},K$c.instance=null,K$c}(),K$K=function(){function K$_(){this._obj=null,this._obj=K$_.supportWeakMap?new K$s.window.WeakMap:{},K$_.supportWeakMap||K$_._maps.push(this)}K$n(K$_,"laya.utils.WeakObject");var K$c=K$_.prototype;return K$c.set=function(K$c,K$P){if(null!=K$c)if(K$_.supportWeakMap){var K$q=K$c;"string"!=typeof K$c&&"number"!=typeof K$c||(K$q=K$_._keys[K$c])||(K$q=K$_._keys[K$c]={k:K$c}),this._obj.set(K$q,K$P)}else"string"==typeof K$c||"number"==typeof K$c?this._obj[K$c]=K$P:(K$c.$_GID||(K$c.$_GID=K$p.getGID()),this._obj[K$c.$_GID]=K$P)},K$c.get=function(K$c){if(null==K$c)return null;if(K$_.supportWeakMap){var K$P="string"==typeof K$c||"number"==typeof K$c?K$_._keys[K$c]:K$c;return K$P?this._obj.get(K$P):null}return"string"==typeof K$c||"number"==typeof K$c?this._obj[K$c]:this._obj[K$c.$_GID]},K$c.del=function(K$c){if(null!=K$c)if(K$_.supportWeakMap){var K$P="string"==typeof K$c||"number"==typeof K$c?K$_._keys[K$c]:K$c;if(!K$P)return;this._obj.delete(K$P)}else"string"==typeof K$c||"number"==typeof K$c?delete this._obj[K$c]:delete this._obj[this._obj.$_GID]},K$c.has=function(K$c){if(null==K$c)return!1;if(K$_.supportWeakMap){var K$P="string"==typeof K$c||"number"==typeof K$c?K$_._keys[K$c]:K$c;return this._obj.has(K$P)}return"string"==typeof K$c||"number"==typeof K$c?null!=this._obj[K$c]:null!=this._obj[this._obj.$_GID]},K$_.__init__=function(){(K$_.supportWeakMap=null!=K$s.window.WeakMap)||K$H.timer.loop(K$_.delInterval,null,K$_.clearCache)},K$_.clearCache=function(){for(var K$c=0,K$P=K$_._maps.length;K$c<K$P;K$c++){K$_._maps[K$c]._obj={}}},K$_.supportWeakMap=!1,K$_.delInterval=3e5,K$_._keys={},K$_._maps=[],K$Z(K$_,["I",function(){return this.I=new K$_}]),K$_}(),K$G=function(){function K$c(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}K$n(K$c,"laya.utils.WordText");var K$P=K$c.prototype;return K$P.setText=function(K$c){this.changed=!0,this._text=K$c},K$P.toString=function(){return this._text},K$P.charCodeAt=function(K$c){return this._text?this._text.charCodeAt(K$c):NaN},K$P.charAt=function(K$c){return this._text?this._text.charAt(K$c):null},K$g(0,K$P,"length",function(){return this._text?this._text.length:0}),K$c}(),K$cc=function(K$c){function K$e(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,K$e.__super.call(this),this._childs=K$e.ARRAY_EMPTY,this._$P=K$e.PROP_EMPTY,this.timer=K$H.scaleTimer,this.conchModel=K$C.isConchNode?this.createConchModel():null}K$n(K$e,"laya.display.Node",K$S);var K$P=K$e.prototype;return K$P._setBit=function(K$c,K$P){1==K$c&&(this._getBit(K$c)!=K$P&&this._updateDisplayedInstage());K$P?this._bits|=K$c:this._bits&=~K$c},K$P._getBit=function(K$c){return 0!=(this._bits&K$c)},K$P._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},K$P._setUpNoticeType=function(K$c){var K$P=this;for(K$P._setBit(K$c,!0),K$P=K$P.parent;K$P;){if(K$P._getBit(K$c))return;K$P._setBit(K$c,!0),K$P=K$P.parent}},K$P.on=function(K$c,K$P,K$q,K$_){return"display"!==K$c&&"undisplay"!==K$c||this._getBit(1)||this._setUpNoticeType(1),this._createListener(K$c,K$P,K$q,K$_,!1)},K$P.once=function(K$c,K$P,K$q,K$_){return"display"!==K$c&&"undisplay"!==K$c||this._getBit(1)||this._setUpNoticeType(1),this._createListener(K$c,K$P,K$q,K$_,!0)},K$P.createConchModel=function(){return null},K$P.destroy=function(K$c){void 0===K$c&&(K$c=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(K$c?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},K$P.destroyChildren=function(){if(this._childs)for(var K$c=this._childs.length-1;-1<K$c;K$c--)this._childs[K$c].destroy(!0)},K$P.addChild=function(K$c){if(!K$c||this.destroyed||K$c===this)return K$c;if(K$c.zOrder&&this._set$P("hasZorder",!0),K$c._parent===this){var K$P=this.getChildIndex(K$c);K$P!==this._childs.length-1&&(this._childs.splice(K$P,1),this._childs.push(K$c),this.conchModel&&(this.conchModel.removeChild(K$c.conchModel),this.conchModel.addChildAt(K$c.conchModel,this._childs.length-1)),this._childChanged())}else K$c.parent&&K$c.parent.removeChild(K$c),this._childs===K$e.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(K$c),this.conchModel&&this.conchModel.addChildAt(K$c.conchModel,this._childs.length-1),(K$c.parent=this)._childChanged();return K$c},K$P.addChildren=function(K$c){for(var K$P=arguments,K$q=0,K$_=K$P.length;K$q<K$_;)this.addChild(K$P[K$q++])},K$P.addChildAt=function(K$c,K$P){if(!K$c||this.destroyed||K$c===this)return K$c;if(K$c.zOrder&&this._set$P("hasZorder",!0),0<=K$P&&K$P<=this._childs.length){if(K$c._parent===this){var K$q=this.getChildIndex(K$c);this._childs.splice(K$q,1),this._childs.splice(K$P,0,K$c),this.conchModel&&(this.conchModel.removeChild(K$c.conchModel),this.conchModel.addChildAt(K$c.conchModel,K$P)),this._childChanged()}else K$c.parent&&K$c.parent.removeChild(K$c),this._childs===K$e.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(K$P,0,K$c),this.conchModel&&this.conchModel.addChildAt(K$c.conchModel,K$P),K$c.parent=this;return K$c}throw new Error("appendChildAt:The index is out of bounds")},K$P.getChildIndex=function(K$c){return this._childs.indexOf(K$c)},K$P.getChildByName=function(K$c){var K$P=this._childs;if(K$P)for(var K$q=0,K$_=K$P.length;K$q<K$_;K$q++){var K$E=K$P[K$q];if(K$E.name===K$c)return K$E}return null},K$P._get$P=function(K$c){return this._$P[K$c]},K$P._set$P=function(K$c,K$P){return this.destroyed||(this._$P===K$e.PROP_EMPTY&&(this._$P={}),this._$P[K$c]=K$P),K$P},K$P.getChildAt=function(K$c){return this._childs[K$c]},K$P.setChildIndex=function(K$c,K$P){var K$q=this._childs;if(K$P<0||K$P>=K$q.length)throw new Error("setChildIndex:The index is out of bounds.");var K$_=this.getChildIndex(K$c);if(K$_<0)throw new Error("setChildIndex:node is must child of this object.");return K$q.splice(K$_,1),K$q.splice(K$P,0,K$c),this.conchModel&&(this.conchModel.removeChild(K$c.conchModel),this.conchModel.addChildAt(K$c.conchModel,K$P)),this._childChanged(),K$c},K$P._childChanged=function(K$c){},K$P.removeChild=function(K$c){if(!this._childs)return K$c;var K$P=this._childs.indexOf(K$c);return this.removeChildAt(K$P)},K$P.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},K$P.removeChildByName=function(K$c){var K$P=this.getChildByName(K$c);return K$P&&this.removeChild(K$P),K$P},K$P.removeChildAt=function(K$c){var K$P=this.getChildAt(K$c);if(K$P){for(var K$q=this._childs.length-1,K$_=K$c;K$_<K$q;++K$_)this._childs[K$_]=this._childs[K$_+1];this._childs.length=K$q,this.conchModel&&this.conchModel.removeChild(K$P.conchModel),K$P.parent=null}return K$P},K$P.removeChildren=function(K$c,K$P){if(void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=2147483647),this._childs&&0<this._childs.length){var K$q=this._childs;if(0===K$c&&K$b<=K$P){var K$_=K$q;this._childs=K$e.ARRAY_EMPTY}else K$_=K$q.splice(K$c,K$P-K$c);for(var K$E=0,K$b=K$_.length;K$E<K$b;K$E++)K$_[K$E].parent=null,this.conchModel&&this.conchModel.removeChild(K$_[K$E].conchModel)}return this},K$P.replaceChild=function(K$c,K$P){var K$q=this._childs.indexOf(K$P);return-1<K$q?(this._childs.splice(K$q,1,K$c),this.conchModel&&(this.conchModel.removeChild(K$P.conchModel),this.conchModel.addChildAt(K$c.conchModel,K$q)),K$P.parent=null,K$c.parent=this,K$c):null},K$P._updateDisplayedInstage=function(){var K$c;K$c=this;var K$P=K$H.stage;for(this._displayedInStage=!1;K$c;){if(K$c._getBit(1)){this._displayedInStage=K$c._displayedInStage;break}if(K$c==K$P||K$c._displayedInStage){this._displayedInStage=!0;break}K$c=K$c.parent}},K$P._setDisplay=function(K$c){this._displayedInStage!==K$c&&((this._displayedInStage=K$c)?this.event("display"):this.event("undisplay"))},K$P._displayChild=function(K$c,K$P){var K$q=K$c._childs;if(K$q)for(var K$_=0;K$_<K$q.length;K$_++){var K$E=K$q[K$_];K$E&&K$E._getBit(1)&&(0<K$E._childs.length?this._displayChild(K$E,K$P):K$E._setDisplay(K$P))}K$c._setDisplay(K$P)},K$P.contains=function(K$c){if(K$c===this)return!0;for(;K$c;){if(K$c.parent===this)return!0;K$c=K$c.parent}return!1},K$P.timerLoop=function(K$c,K$P,K$q,K$_,K$E,K$b){void 0===K$E&&(K$E=!0),void 0===K$b&&(K$b=!1),this.timer.loop(K$c,K$P,K$q,K$_,K$E,K$b)},K$P.timerOnce=function(K$c,K$P,K$q,K$_,K$E){void 0===K$E&&(K$E=!0),this.timer._create(!1,!1,K$c,K$P,K$q,K$_,K$E)},K$P.frameLoop=function(K$c,K$P,K$q,K$_,K$E){void 0===K$E&&(K$E=!0),this.timer._create(!0,!0,K$c,K$P,K$q,K$_,K$E)},K$P.frameOnce=function(K$c,K$P,K$q,K$_,K$E){void 0===K$E&&(K$E=!0),this.timer._create(!0,!1,K$c,K$P,K$q,K$_,K$E)},K$P.clearTimer=function(K$c,K$P){this.timer.clear(K$c,K$P)},K$g(0,K$P,"numChildren",function(){return this._childs.length}),K$g(0,K$P,"destroyed",function(){return this._destroyed}),K$g(0,K$P,"parent",function(){return this._parent},function(K$c){this._parent!==K$c&&(K$c?(this._parent=K$c,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),K$c.displayedInStage&&this._displayChild(this,!0)),K$c._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=K$c))}),K$g(0,K$P,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),K$e.ARRAY_EMPTY=[],K$e.PROP_EMPTY={},K$e.NOTICE_DISPLAY=1,K$e.MOUSEENABLE=2,K$e}(),K$Pc=function(K$c){function K$x(K$c){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,K$x.__super.call(this),this._padding=K$x._PADDING,this._spacing=K$x._SPACING,this._aligns=K$x._ALIGNS,this._font=K$r.EMPTY,this._ower=K$c}K$n(K$x,"laya.display.css.CSSStyle",K$c);var K$P=K$x.prototype;return K$P.destroy=function(){this._ower=null,this._font=null,this._rect=null},K$P.inherit=function(K$c){this._font=K$c._font,this._spacing=K$c._spacing===K$x._SPACING?K$x._SPACING:K$c._spacing.slice(),this.lineHeight=K$c.lineHeight},K$P._widthAuto=function(){return 0!=(262144&this._type)},K$P.widthed=function(K$c){return 0!=(8&this._type)},K$P._calculation=function(K$c,K$P){if(K$P.indexOf("%")<0)return!1;var K$_=this._ower,K$E=K$_.parent,K$b=this._rect;function K$e(K$c,K$P,K$q){return K$c*K$q[0]+K$P*K$q[1]+K$q[2]}function K$q(K$c){var K$P=K$E.width,K$q=K$_.width;K$b.width&&(K$_.width=K$e(K$P,K$q,K$b.width)),K$b.height&&(K$_.height=K$e(K$P,K$q,K$b.height)),K$b.left&&(K$_.x=K$e(K$P,K$q,K$b.left)),K$b.top&&(K$_.y=K$e(K$P,K$q,K$b.top))}null===K$b&&(K$E._getCSSStyle()._type|=524288,K$E.on("resize",this,K$q),this._rect=K$b={input:{}});var K$h=K$P.split(" ");return K$h[0]=parseFloat(K$h[0])/100,1==K$h.length?K$h[1]=K$h[2]=0:(K$h[1]=parseFloat(K$h[1])/100,K$h[2]=parseFloat(K$h[2])),K$b[K$c]=K$h,K$b.input[K$c]=K$P,K$q(),!0},K$P.heighted=function(K$c){return 0!=(8192&this._type)},K$P.size=function(K$c,K$P){var K$q=this._ower,K$_=!1;-1!==K$c&&K$c!=this._ower.width&&(this._type|=8,this._ower.width=K$c,K$_=!0),-1!==K$P&&K$P!=this._ower.height&&(this._type|=8192,this._ower.height=K$P,K$_=!0),K$_&&(K$q._layoutLater(),524288&this._type&&K$q.event("resize",this))},K$P._getAlign=function(){return this._aligns[0]},K$P._getValign=function(){return this._aligns[1]},K$P._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},K$P._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new K$r(this._font))},K$P.render=function(K$c,K$P,K$q,K$_){var K$E=K$c.width,K$b=K$c.height;K$q-=K$c.pivotX,K$_-=K$c.pivotY,this._bgground&&null!=this._bgground.color&&K$P.ctx.fillRect(K$q,K$_,K$E,K$b,this._bgground.color),this._border&&this._border.color&&K$P.drawRect(K$q,K$_,K$E,K$b,this._border.color.strColor,this._border.size)},K$P.getCSSStyle=function(){return this},K$P.cssText=function(K$c){this.attrs(K$x.parseOneCSS(K$c,";"))},K$P.attrs=function(K$c){if(K$c)for(var K$P=0,K$q=K$c.length;K$P<K$q;K$P++){var K$_=K$c[K$P];this[K$_[0]]=K$_[1]}},K$P.setTransform=function(K$c){"none"===K$c?this._tf=K$h._TF_EMPTY:this.attrs(K$x.parseOneCSS(K$c,","))},K$P.translate=function(K$c,K$P){this._tf===K$h._TF_EMPTY&&(this._tf=new K$E),this._tf.translateX=K$c,this._tf.translateY=K$P},K$P.scale=function(K$c,K$P){this._tf===K$h._TF_EMPTY&&(this._tf=new K$E),this._tf.scaleX=K$c,this._tf.scaleY=K$P},K$P._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},K$g(0,K$P,"block",K$c.prototype._$get_block,function(K$c){K$c?this._type|=1:this._type&=-2}),K$g(0,K$P,"valign",function(){return K$x._valigndef[this._aligns[1]]},function(K$c){this._aligns===K$x._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=K$x._valigndef[K$c]}),K$g(0,K$P,"height",null,function(K$c){if(this._type|=8192,"string"==typeof K$c){if(this._calculation("height",K$c))return;K$c=parseInt(K$c)}this.size(-1,K$c)}),K$g(0,K$P,"width",null,function(K$c){if(this._type|=8,"string"==typeof K$c){var K$P=K$c.indexOf("auto");if(0<=K$P&&(this._type|=262144,K$c=K$c.substr(0,K$P)),this._calculation("width",K$c))return;K$c=parseInt(K$c)}this.size(K$c,-1)}),K$g(0,K$P,"fontWeight",function(){return this._font.weight},function(K$c){this._createFont().weight=K$c}),K$g(0,K$P,"left",null,function(K$c){var K$P=this._ower;if("string"==typeof K$c){if("center"===K$c?K$c="50% -50% 0":"right"===K$c&&(K$c="100% -100% 0"),this._calculation("left",K$c))return;K$c=parseInt(K$c)}K$P.x=K$c}),K$g(0,K$P,"_translate",null,function(K$c){this.translate(K$c[0],K$c[1])}),K$g(0,K$P,"absolute",function(){return 0!=(4&this._type)}),K$g(0,K$P,"top",null,function(K$c){var K$P=this._ower;if("string"==typeof K$c){if("middle"===K$c?K$c="50% -50% 0":"bottom"===K$c&&(K$c="100% -100% 0"),this._calculation("top",K$c))return;K$c=parseInt(K$c)}K$P.y=K$c}),K$g(0,K$P,"align",function(){return K$x._aligndef[this._aligns[0]]},function(K$c){this._aligns===K$x._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=K$x._aligndef[K$c]}),K$g(0,K$P,"bold",function(){return this._font.bold},function(K$c){this._createFont().bold=K$c}),K$g(0,K$P,"padding",function(){return this._padding},function(K$c){this._padding=K$c}),K$g(0,K$P,"leading",function(){return this._spacing[1]},function(K$c){"string"==typeof K$c&&(K$c=parseInt(K$c+"")),this._spacing===K$x._SPACING&&(this._spacing=[0,0]),this._spacing[1]=K$c}),K$g(0,K$P,"lineElement",function(){return 0!=(65536&this._type)},function(K$c){K$c?this._type|=65536:this._type&=-65537}),K$g(0,K$P,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(K$c){this.lineElement=!1,"right"===K$c?this._type|=32768:this._type&=-32769}),K$g(0,K$P,"textDecoration",function(){return this._font.decoration},function(K$c){this._createFont().decoration=K$c}),K$g(0,K$P,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(K$c){"nowrap"===K$c&&(this._type|=131072),"none"===K$c&&(this._type&=-131073)}),K$g(0,K$P,"background",null,function(K$c){K$c?(this._bgground||(this._bgground={}),this._bgground.color=K$c,this._ower.conchModel&&this._ower.conchModel.bgColor(K$c),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),K$g(0,K$P,"wordWrap",function(){return 0==(131072&this._type)},function(K$c){K$c?this._type&=-131073:this._type|=131072}),K$g(0,K$P,"color",function(){return this._font.color},function(K$c){this._createFont().color=K$c}),K$g(0,K$P,"password",function(){return this._font.password},function(K$c){this._createFont().password=K$c}),K$g(0,K$P,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(K$c){"none"===K$c?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=K$c),this._ower.conchModel&&this._ower.conchModel.bgColor(K$c),this._ower._renderType|=256}),K$g(0,K$P,"font",function(){return this._font.toString()},function(K$c){this._createFont().set(K$c)}),K$g(0,K$P,"weight",null,function(K$c){this._createFont().weight=K$c}),K$g(0,K$P,"letterSpacing",function(){return this._spacing[0]},function(K$c){"string"==typeof K$c&&(K$c=parseInt(K$c+"")),this._spacing===K$x._SPACING&&(this._spacing=[0,0]),this._spacing[0]=K$c}),K$g(0,K$P,"fontSize",function(){return this._font.size},function(K$c){this._createFont().size=K$c}),K$g(0,K$P,"italic",function(){return this._font.italic},function(K$c){this._createFont().italic=K$c}),K$g(0,K$P,"fontFamily",function(){return this._font.family},function(K$c){this._createFont().family=K$c}),K$g(0,K$P,"stroke",function(){return this._font.stroke[0]},function(K$c){this._createFont().stroke===K$r._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=K$c}),K$g(0,K$P,"strokeColor",function(){return this._font.stroke[1]},function(K$c){this._createFont().stroke===K$r._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=K$c}),K$g(0,K$P,"border",function(){return this._border?this._border.value:""},function(K$c){if("none"!=K$c){this._border||(this._border={});var K$P=(this._border.value=K$c).split(" ");if(this._border.color=K$y.create(K$P[K$P.length-1]),1==K$P.length)return this._border.size=1,void(this._border.type="solid");var K$q=0;0<K$P[0].indexOf("px")?(this._border.size=parseInt(K$P[0]),K$q++):this._border.size=1,this._border.type=K$P[K$q],this._ower._renderType|=256}else this._border=null}),K$g(0,K$P,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(K$c){K$c?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==K$c?null:K$y.create(K$c),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),K$g(0,K$P,"position",function(){return 4&this._type?"absolute":""},function(K$c){"absolute"==K$c?this._type|=4:this._type&=-5}),K$g(0,K$P,"display",null,function(K$c){switch(K$c){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),K$g(0,K$P,"paddingLeft",function(){return this.padding[3]}),K$g(0,K$P,"paddingTop",function(){return this.padding[0]}),K$g(0,K$P,"_scale",null,function(K$c){this._ower.scale(K$c[0],K$c[1])}),K$g(0,K$P,"_rotate",null,function(K$c){this._ower.rotation=K$c}),K$x.parseOneCSS=function(K$c,K$P){for(var K$q,K$_=[],K$E=K$c.split(K$P),K$b=0,K$e=K$E.length;K$b<K$e;K$b++){var K$h=K$E[K$b],K$Z=K$h.indexOf(":"),K$S=K$h.substr(0,K$Z).replace(/^\s+|\s+$/g,"");if(0!=K$S.length){var K$n=K$h.substr(K$Z+1).replace(/^\s+|\s+$/g,""),K$k=[K$S,K$n];switch(K$S){case"italic":case"bold":K$k[1]="true"==K$n;break;case"line-height":K$k[0]="lineHeight",K$k[1]=parseInt(K$n);break;case"font-size":K$k[0]="fontSize",K$k[1]=parseInt(K$n);break;case"padding":1<(K$q=K$n.split(" ")).length||(K$q[1]=K$q[2]=K$q[3]=K$q[0]),K$k[1]=[parseInt(K$q[0]),parseInt(K$q[1]),parseInt(K$q[2]),parseInt(K$q[3])];break;case"rotate":K$k[0]="_rotate",K$k[1]=parseFloat(K$n);break;case"scale":K$q=K$n.split(" "),K$k[0]="_scale",K$k[1]=[parseFloat(K$q[0]),parseFloat(K$q[1])];break;case"translate":K$q=K$n.split(" "),K$k[0]="_translate",K$k[1]=[parseInt(K$q[0]),parseInt(K$q[1])];break;default:(K$k[0]=K$x._CSSTOVALUE[K$S])||(K$k[0]=K$S)}K$_.push(K$k)}}return K$_},K$x.parseCSS=function(K$c,K$P){for(var K$q;null!=(K$q=K$x._parseCSSRegExp.exec(K$c));)K$x.styleSheets[K$q[1]]=K$x.parseOneCSS(K$q[2],";")},K$x.EMPTY=new K$x(null),K$x._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},K$x._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),K$x._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},K$x._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},K$x.styleSheets={},K$x.ALIGN_CENTER=1,K$x.ALIGN_RIGHT=2,K$x.VALIGN_MIDDLE=1,K$x.VALIGN_BOTTOM=2,K$x._CSS_BLOCK=1,K$x._DISPLAY_NONE=2,K$x._ABSOLUTE=4,K$x._WIDTH_SET=8,K$x._PADDING=[0,0,0,0],K$x._RECT=[-1,-1,-1,-1],K$x._SPACING=[0,0],K$x._ALIGNS=[0,0,0],K$x.ADDLAYOUTED=512,K$x._NEWFONT=4096,K$x._HEIGHT_SET=8192,K$x._BACKGROUND_SET=16384,K$x._FLOAT_RIGHT=32768,K$x._LINE_ELEMENT=65536,K$x._NOWARP=131072,K$x._WIDTHAUTO=262144,K$x._LISTERRESZIE=524288,K$x}(K$h),K$qc=function(K$c){function K$e(){this.url=null,this.audio=null,this.loaded=!1,K$e.__super.call(this)}K$n(K$e,"laya.media.h5audio.AudioSound",K$S);var K$P=K$e.prototype;return K$P.dispose=function(){var K$c=K$e._audioCache[this.url];K$c&&(K$c.src="",delete K$e._audioCache[this.url])},K$P.load=function(K$c){var K$P;if(K$c=K$$.formatURL(K$c),(this.url=K$c)==K$J._tMusic?(K$e._initMusicAudio(),(K$P=K$e._musicAudio).src!=K$c&&(K$e._audioCache[K$P.src]=null,K$P=null)):K$P=K$e._audioCache[K$c],K$P&&2<=K$P.readyState)this.event("complete");else{K$P||(K$P=K$c==K$J._tMusic?(K$e._initMusicAudio(),K$e._musicAudio):K$s.createElement("audio"),(K$e._audioCache[K$c]=K$P).src=K$c),K$P.addEventListener("canplaythrough",K$_),K$P.addEventListener("error",K$E);var K$q=this;(this.audio=K$P).load?K$P.load():K$E()}function K$_(){K$b(),K$q.loaded=!0,K$q.event("complete")}function K$E(){K$P.load=null,K$b(),K$q.event("error")}function K$b(){K$P.removeEventListener("canplaythrough",K$_),K$P.removeEventListener("error",K$E)}},K$P.play=function(K$c,K$P,K$q){if(void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),!this.url)return null;var K$_,K$E;if(!(K$_=this.url==K$J._tMusic?K$e._musicAudio:K$e._audioCache[this.url]))return null;K$E=K$f.getItem("audio:"+this.url),K$C.isConchApp?K$E||((K$E=K$s.createElement("audio")).src=this.url):this.url==K$J._tMusic?(K$e._initMusicAudio(),(K$E=K$e._musicAudio).src=this.url):K$E=K$E||K$_.cloneNode(!0);var K$b=new K$xc(K$E);return K$b.url=this.url,K$b.loops=K$P,K$b.startTime=K$c,K$b.startHandler=K$q,K$b.play(!1),K$J.addChannel(K$b),K$b},K$g(0,K$P,"duration",function(){var K$c;return(K$c=K$e._audioCache[this.url])?K$c.duration:0}),K$e._initMusicAudio=function(){K$e._musicAudio||(K$e._musicAudio||(K$e._musicAudio=K$s.createElement("audio")),K$C.isConchApp||K$s.document.addEventListener("mousedown",K$e._makeMusicOK))},K$e._makeMusicOK=function(){K$s.document.removeEventListener("mousedown",K$e._makeMusicOK),K$e._musicAudio.src?K$e._musicAudio.play():(K$e._musicAudio.src="",K$e._musicAudio.load())},K$e._audioCache={},K$e._musicAudio=null,K$e}(),K$_c=function(K$c){function K$P(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,K$P.__super.call(this)}K$n(K$P,"laya.media.SoundChannel",K$S);var K$q=K$P.prototype;return K$q.play=function(){},K$q.stop=function(){},K$q.pause=function(){},K$q.resume=function(){},K$q.__runComplete=function(K$c){K$c&&K$c.run()},K$g(0,K$q,"volume",function(){return 1},function(K$c){}),K$g(0,K$q,"position",function(){return 0}),K$g(0,K$q,"duration",function(){return 0}),K$P}(),K$Ec=function(K$c){function K$P(){K$P.__super.call(this)}K$n(K$P,"laya.media.Sound",K$S);var K$q=K$P.prototype;return K$q.load=function(K$c){},K$q.play=function(K$c,K$P,K$q){return void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),null},K$q.dispose=function(){},K$g(0,K$q,"duration",function(){return 0}),K$P}(),K$bc=function(K$c){function K$E(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,K$E.__super.call(this)}K$n(K$E,"laya.media.webaudio.WebAudioSound",K$S);var K$P=K$E.prototype;return K$P.load=function(K$c){this.url=K$c,this.audioBuffer=K$E._dataCache[K$c],this.audioBuffer?this._loaded(this.audioBuffer):(K$E.e.on("loaded:"+K$c,this,this._loaded),K$E.e.on("err:"+K$c,this,this._err),K$E.__loadingSound[K$c]||(K$E.__loadingSound[K$c]=!0,K$H.loader.load(K$c,K$N.create(this,this.onloaded),null,K$hc.BUFFER,4,!1,null,!0)))},K$P.onloaded=function(K$c){K$c||this._err(),this._disposed?this._removeLoadEvents():(this.data=K$c,K$E.buffs.push({buffer:this.data,url:this.url}),K$E.decode())},K$P._err=function(){if(this._removeLoadEvents(),K$E.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var K$c,K$P,K$q,K$_=0;for(K$c=(K$P=this.__toPlays).length,K$_=0;K$_<K$c;K$_++)(K$q=K$P[K$_])[3]&&!K$q[3].isStopped&&K$q[3].event("error");this.__toPlays.length=0}},K$P._loaded=function(K$c){this._removeLoadEvents(),this._disposed||(this.audioBuffer=K$c,this.loaded=!0,this.event("complete"))},K$P._removeLoadEvents=function(){K$E.e.off("loaded:"+this.url,this,this._loaded),K$E.e.off("err:"+this.url,this,this._err)},K$P.__playAfterLoaded=function(){if(this.__toPlays){var K$c,K$P,K$q,K$_=0;for(K$c=(K$P=this.__toPlays).length,K$_=0;K$_<K$c;K$_++)(K$q=K$P[K$_])[3]&&!K$q[3].isStopped&&this.play(K$q[0],K$q[1],K$q[2],K$q[3]);this.__toPlays.length=0}},K$P.play=function(K$c,K$P,K$q,K$_){return void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),K$_=K$_||new K$rc,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([K$c,K$P,K$q,K$_]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),K$_.url=this.url,K$_.loops=K$P,K$_.audioBuffer=this.audioBuffer,K$_.startTime=K$c,K$_.startHandler=K$q,K$_.play(!1),K$J.addChannel(K$_),K$_},K$P.dispose=function(){this._disposed=!0,delete K$E._dataCache[this.url],delete K$E.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},K$g(0,K$P,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),K$E.decode=function(){if(!(K$E.buffs.length<=0||K$E.isDecoding))if(K$E.isDecoding=!0,(K$E.tInfo=K$E.buffs.shift())&&K$E.tInfo.buffer&&K$E.tInfo.buffer.byteLength)try{K$E.ctx.decodeAudioData(K$E.tInfo.buffer,K$E._done,K$E._fail)}catch(K$c){console.error("decodeAudioData error  byteLength:"+K$E.tInfo.buffer.byteLength+"  url:"+K$E.tInfo.url)}else K$E._fail()},K$E._done=function(K$c){K$E.e.event("loaded:"+K$E.tInfo.url,K$c),K$E._dataCache[K$E.tInfo.url]=K$c,K$E.isDecoding=!1,K$E.decode()},K$E._fail=function(){K$E.e.event("err:"+K$E.tInfo.url,null),K$E.isDecoding=!1,K$E.decode()},K$E._playEmptySound=function(){if(null!=K$E.ctx){if(K$E._emptySource&&(K$E._emptySource.stop(),K$E._emptySource.disconnect(0),!K$rc._tryCleanFailed))try{K$E._emptySource.buffer=null}catch(K$c){K$rc._tryCleanFailed=!0}var K$c=K$E.ctx.createBufferSource();K$c.buffer=K$E._miniBuffer,K$c.connect(K$E.ctx.destination),K$c.start(0,0,0),K$E._emptySource=K$c}},K$E._unlock=function(){K$E._unlocked||(K$E._playEmptySound(),"running"==K$E.ctx.state?(K$s.document.removeEventListener("mousedown",K$E._unlock,!0),K$s.document.removeEventListener("touchend",K$E._unlock,!0),K$s.document.removeEventListener("touchstart",K$E._unlock,!0),K$E._unlocked=!0):"suspended"==K$E.ctx.state&&K$J._recoverWebAudio())},K$E.initWebAudio=function(){"running"!=K$E.ctx.state&&(K$E._unlock(),K$s.document.addEventListener("mousedown",K$E._unlock,!0),K$s.document.addEventListener("touchend",K$E._unlock,!0),K$s.document.addEventListener("touchstart",K$E._unlock,!0))},K$E._emptySource=null,K$E._dataCache={},K$E.buffs=[],K$E.isDecoding=!1,K$E._unlocked=!1,K$E.tInfo=null,K$E.__loadingSound={},K$Z(K$E,["window",function(){return this.window=K$s.window},"webAudioEnabled",function(){return this.webAudioEnabled=K$E.window.AudioContext||K$E.window.webkitAudioContext||K$E.window.mozAudioContext},"ctx",function(){return this.ctx=K$E.webAudioEnabled?new(K$E.window.AudioContext||K$E.window.webkitAudioContext||K$E.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=K$E.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new K$S}]),K$E}(),K$ec=function(K$c){function K$P(){this._responseType=null,this._data=null,K$P.__super.call(this),this._http=new K$s.window.XMLHttpRequest}K$n(K$P,"laya.net.HttpRequest",K$S);var K$q=K$P.prototype;return K$q.send=function(K$c,K$P,K$q,K$_,K$E){void 0===K$q&&(K$q="get"),void 0===K$_&&(K$_="text"),this._responseType=K$_,this._data=null;var K$b=this,K$e=this._http;if(K$e.open(K$q,K$c,!0),K$E)for(var K$h=0;K$h<K$E.length;K$h++)K$e.setRequestHeader(K$E[K$h++],K$E[K$h]);else K$C.isConchApp||(K$P&&"string"!=typeof K$P?K$e.setRequestHeader("Content-Type","application/json"):K$e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));K$e.responseType="arraybuffer"!==K$_?"text":"arraybuffer",K$e.onerror=function(K$c){K$b._onError(K$c)},K$e.onabort=function(K$c){K$b._onAbort(K$c)},K$e.onprogress=function(K$c){K$b._onProgress(K$c)},K$e.onload=function(K$c){K$b._onLoad(K$c)},K$e.send(K$P)},K$q._onProgress=function(K$c){K$c&&K$c.lengthComputable&&this.event("progress",K$c.loaded/K$c.total)},K$q._onAbort=function(K$c){this.error("Request was aborted by user")},K$q._onError=function(K$c){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},K$q._onLoad=function(K$c){var K$P=this._http,K$q=void 0!==K$P.status?K$P.status:200;200===K$q||204===K$q||0===K$q?this.complete():this.error("["+K$P.status+"]"+K$P.statusText+":"+K$P.responseURL)},K$q.error=function(K$c){this.clear(),this.event("error",K$c)},K$q.complete=function(){this.clear();var K$P=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=K$p.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(K$c){K$P=!1,this.error(K$c.message)}K$P&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},K$q.clear=function(){var K$c=this._http;K$c.onerror=K$c.onabort=K$c.onprogress=K$c.onload=null},K$g(0,K$q,"url",function(){return this._http.responseURL}),K$g(0,K$q,"http",function(){return this._http}),K$g(0,K$q,"data",function(){return this._data}),K$P}(),K$hc=function(K$c){function K$u(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,K$u.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}K$n(K$u,"laya.net.Loader",K$S);var K$P=K$u.prototype;return K$P.load=function(K$c,K$P,K$q,K$_,K$E){if(K$c&&""!=K$c||console.error("Loader 加载的url不合法 "+K$c),void 0===K$q&&(K$q=!0),void 0===K$E&&(K$E=!1),0===(this._url=K$c).indexOf("data:image")?this._type=K$P="image":this._type=K$P||(K$P=this.getTypeFromUrl(K$c)),this._cache=K$q,this._data=null,!K$E&&K$u.loadedMap[K$c])return this._data=K$u.loadedMap[K$c],this.event("progress",1),void this.event("complete",this._data);if(K$_&&K$u.setGroup(K$c,K$_),null!=K$u.parserMap[K$P])return this._customParse=!0,void(K$u.parserMap[K$P]instanceof laya.utils.Handler?K$u.parserMap[K$P].runWith(this):K$u.parserMap[K$P].call(null,this));if("image"===K$P||"htmlimage"===K$P||"nativeimage"===K$P)return this._loadImage(K$c);if("ttf"===K$P)return this._loadTTF(K$c);switch(K$P){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:K$P}K$u.preLoadedMap[K$c]?this.onLoaded(K$u.preLoadedMap[K$c]):K$e.resMgrLoad(K$c,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},K$P.getTypeFromUrl=function(K$c){var K$P=K$p.getFileExtension(K$c);return K$P?K$u.typeMap[K$P]:(console.warn("Not recognize the resources suffix",K$c),"text")},K$P._loadTTF=function(K$c){K$c=K$$.formatURL(K$c);var K$P=new K$R;K$P.complete=K$N.create(this,this.onLoaded),K$P.load(K$c)},K$P._loadImage=function(K$c){K$e.imgMgrLoad(K$c,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},K$P._loadImageComplete=function(K$c,K$P,K$q){if(null!=K$q)if(K$q instanceof ArrayBuffer){var K$_=new DataView(K$q),K$E=new laya.webgl.resource.WebGLImage(new Uint8Array(K$q,8),K$c,0,!1,K$_.getUint32(0),K$_.getUint32(4));this.onLoaded(K$E)}else if(K$q instanceof K$nc)K$u.imgMgrSet[K$c]=K$P,K$e.imgMgrLock(K$c,K$u.imgMgrSet[K$c]),this._url=K$c,this.complete(K$q);else{var K$b=-1!=K$c.indexOf(".png",K$c.length-4)?6408:6407;K$E=new laya.webgl.resource.WebGLImage(K$q,K$c,K$b,!1,K$q.width,K$q.height);this.onLoaded(K$E)}else this.event("error","Load image failed")},K$P.imageCancel=function(K$c,K$P,K$q){K$e.imgMgrCancel(K$c,this._onImageCallback)},K$P._loadSound=function(K$c){var K$P=new K$J._soundClass,K$q=this;function K$_(){K$P.offAll()}K$P.on("complete",this,function(){K$_(),K$q.onLoaded(K$P)}),K$P.on("error",this,function(){K$_(),K$P.dispose(),K$q.event("error","Load sound failed")}),K$P.load(K$c)},K$P.onProgress=function(K$c){"atlas"===this._type?this.event("progress",.3*K$c):this.event("progress",K$c)},K$P.onError=function(K$c){this.event("error",K$c)},K$P._loadedComplete=function(K$c,K$P,K$q){if(null!=K$q)switch(this._type){case"atlas":case"plf":case"json":var K$_=new K$U(K$q);this.onLoaded(JSON.parse(K$_.readUTFBytes()));break;case"font":K$_=new K$U(K$q);this.onLoaded(K$p.parseXMLFromString(K$_.readUTFBytes()));break;default:this.onLoaded(K$q)}else this.event("error",K$c)},K$P.onLoaded=function(K$c){var K$P=this._type;if("plf"==K$P)this.parsePLFData(K$c),this.complete(K$c);else if("image"===K$P){var K$q=new K$nc(K$c);K$q.url=this._url,this.complete(K$q)}else if("sound"===K$P||"htmlimage"===K$P||"nativeimage"===K$P)this.complete(K$c);else if("atlas"===K$P){if(!K$c.src&&!K$c._setContext){if(!this._data){if((this._data=K$c).meta&&K$c.meta.image)for(var K$_=K$c.meta.image.split(","),K$E=0<=this._url.indexOf("/")?"/":"\\",K$b=this._url.lastIndexOf(K$E),K$e=0<=K$b?this._url.substr(0,K$b+1):"",K$h=0,K$Z=K$_.length;K$h<K$Z;K$h++)K$_[K$h]=K$e+K$_[K$h];else K$_=[this._url.replace(".json",".png")];K$_.reverse(),K$c.toLoads=K$_,K$c.pics=[]}return this.event("progress",.3+1/K$_.length*.6),this._loadImage(K$_.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(K$c),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var K$S=this._data.frames,K$n=this._url.split("?")[0],K$k=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:K$n.substring(0,K$n.lastIndexOf("."))+"/",K$x=this._data.pics,K$r=K$$.formatURL(this._url),K$g=K$u.atlasMap[K$r]||(K$u.atlasMap[K$r]=[]);K$g.dir=K$k;var K$W=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var K$w in K$W=parseFloat(this._data.meta.scale),K$S){var K$O,K$N=K$S[K$w],K$m=K$x[K$N.frame.idx?K$N.frame.idx:0],K$T=K$$.formatURL(K$k+K$w);K$m.scaleRate=K$W,K$O=K$nc.create(K$m,K$N.frame.x,K$N.frame.y,K$N.frame.w,K$N.frame.h,K$N.spriteSourceSize.x,K$N.spriteSourceSize.y,K$N.sourceSize.w,K$N.sourceSize.h),K$u.cacheRes(K$T,K$O),K$u.keepCache(this._url,K$k+K$w),K$O.url=K$T,K$g.push(K$T)}else for(K$w in K$S)K$m=K$x[(K$N=K$S[K$w]).frame.idx?K$N.frame.idx:0],K$T=K$$.formatURL(K$k+K$w),K$u.cacheRes(K$T,K$nc.create(K$m,K$N.frame.x,K$N.frame.y,K$N.frame.w,K$N.frame.h,K$N.spriteSourceSize.x,K$N.spriteSourceSize.y,K$N.sourceSize.w,K$N.sourceSize.h)),K$u.loadedMap[K$T].url=K$T,K$u.keepCache(this._url,K$k+K$w),K$g.push(K$T);delete this._data.pics,this.complete(this._data)}else if("font"==K$P){if(!K$c.src)return this._data=K$c,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var K$D=new K$A;K$D.parseFont(this._data,K$c);var K$L=this._url.split(".fnt")[0].split("/"),K$H=K$L[K$L.length-1];K$wc.registerBitmapFont(K$H,K$D),this._data=K$D,this.complete(this._data)}else if("pkm"==K$P){var K$Q=K$Lc.create(K$c,this._url),K$d=new K$nc(K$Q);K$d.url=this._url,this.complete(K$d)}else this.complete(K$c)},K$P.parsePLFData=function(K$c){var K$P,K$q,K$_;for(K$P in K$c)switch(K$_=K$c[K$P],K$P){case"json":case"text":for(K$q in K$_)K$u.preLoadedMap[K$$.formatURL(K$q)]=K$_[K$q];break;default:for(K$q in K$_)K$u.preLoadedMap[K$$.formatURL(K$q)]=K$_[K$q]}},K$P.complete=function(K$c){this._data=K$c,this._customParse?this.event("loaded",K$c instanceof Array?[K$c]:K$c):(K$u._loaders.push(this),K$u._isWorking||K$u.checkNext())},K$P.endLoad=function(K$c){K$c&&(this._data=K$c),this._cache&&K$u.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},K$g(0,K$P,"url",function(){return this._url}),K$g(0,K$P,"data",function(){return this._data}),K$g(0,K$P,"cache",function(){return this._cache}),K$g(0,K$P,"type",function(){return this._type}),K$u.checkNext=function(){K$u._isWorking=!0;for(var K$c=K$s.now();K$u._startIndex<K$u._loaders.length;)if(K$s.now(),K$u._loaders[K$u._startIndex].endLoad(),K$u._startIndex++,K$s.now()-K$c>K$u.maxTimeOut)return console.warn("loader callback cost a long time:"+(K$s.now()-K$c)+" url="+K$u._loaders[K$u._startIndex-1].url),void K$H.timer.frameOnce(1,null,K$u.checkNext);K$u._loaders.length=0,K$u._startIndex=0,K$u._isWorking=!1},K$u.clearRes=function(K$c,K$P){if(null!=K$c){void 0===K$P&&(K$P=!1),K$c=K$$.formatURL(K$c);var K$q=K$u.getAtlas(K$c);if(K$q){for(var K$_=0,K$E=K$q.length;K$_<K$E;K$_++){var K$b=K$q[K$_],K$e=K$u.getRes(K$b);delete K$u.loadedMap[K$b],K$u.clearCache(K$c.substring(K$$.basePath.length),K$b.substring(K$$.basePath.length)),K$e&&K$e.destroy(K$P)}K$q.length=0,delete K$u.atlasMap[K$c],delete K$u.loadedMap[K$c]}else{var K$h=K$u.loadedMap[K$c];K$h&&(delete K$u.loadedMap[K$c],K$h instanceof laya.resource.Texture&&K$h.bitmap&&K$h.destroy(K$P))}}},K$u.clearTextureRes=function(K$c){K$c=K$$.formatURL(K$c);var K$P=laya.net.Loader.getAtlas(K$c),K$q=K$P&&0<K$P.length?laya.net.Loader.getRes(K$P[0]):laya.net.Loader.getRes(K$c);K$q&&K$q.bitmap&&(K$C.isConchApp&&!K$C.isConchWebGL?K$q.bitmap.source.releaseTexture&&K$q.bitmap.source.releaseTexture():null==K$q.bitmap._atlaser&&K$q.bitmap.releaseResource(!0))},K$u.getRes=function(K$c){return K$u.loadedMap[K$$.formatURL(K$c)]},K$u.getAtlas=function(K$c){return K$u.atlasMap[K$$.formatURL(K$c)]},K$u.cacheRes=function(K$c,K$P){K$c=K$$.formatURL(K$c),null!=K$u.loadedMap[K$c]?console.warn("Resources already exist,is repeated loading:",K$c):K$u.loadedMap[K$c]=K$P},K$u.setGroup=function(K$c,K$P){K$u.groupMap[K$P]||(K$u.groupMap[K$P]=[]),K$u.groupMap[K$P].push(K$c)},K$u.clearResByGroup=function(K$c){if(K$u.groupMap[K$c]){var K$P=K$u.groupMap[K$c],K$q=0,K$_=K$P.length;for(K$q=0;K$q<K$_;K$q++)K$u.clearRes(K$P[K$q]);K$P.length=0}},K$u.keepCache=function(K$c,K$P){if(K$c&&K$P){var K$q=K$u.cacheSet[K$P];K$q?-1==K$q.indexOf(K$c)&&K$q.push(K$c):K$u.cacheSet[K$P]=[K$c]}},K$u.clearCache=function(K$c,K$P){if(K$c&&K$P){var K$q=K$u.cacheSet[K$P];if(K$q){var K$_=K$q.indexOf(K$c);if(-1!==K$_){var K$E=K$q.length-1;0==K$E?(delete K$u.cacheSet[K$P],0<K$u.imgMgrSet[K$P]?K$e.imgMgrFree(K$P,K$u.imgMgrSet[K$P]):K$u.clearRes(K$P,!0)):(K$q[K$_]=K$q[K$E],K$q.length=K$E)}}}},K$u.saveObject=function(K$c,K$P,K$q){if(K$P&&K$c){var K$_=K$u.objectSet[K$c];K$_?(console.warn("Loader.saveObject: "+K$c),K$_[0]=K$P,K$_[1]=K$q):K$u.objectSet[K$c]=[K$P,K$q,[]]}},K$u.findObject=function(K$c){if(K$c){var K$P=K$u.objectSet[K$c];if(K$P)return K$P[0]}return null},K$u.keepObject=function(K$c,K$P){if(K$c&&K$P){var K$q=K$u.objectSet[K$P];K$q&&-1===K$q[2].indexOf(K$c)&&K$q[2].push(K$c)}},K$u.clearObject=function(K$c,K$P){if(K$c&&K$P){var K$q=K$u.objectSet[K$P];if(K$q){var K$_=K$q[2],K$E=K$_.indexOf(K$c);if(-1!==K$E){var K$b=K$_.length-1;0==K$b?(delete K$u.objectSet[K$P],K$q[1]&&K$q[1].call(null,K$q[0])):(K$_[K$E]=K$_[K$b],K$_.length=K$b)}}}},K$u.TEXT="text",K$u.JSON="json",K$u.XML="xml",K$u.BUFFER="arraybuffer",K$u.IMAGE="image",K$u.SOUND="sound",K$u.ATLAS="atlas",K$u.FONT="font",K$u.TTF="ttf",K$u.PLF="plf",K$u.PKM="pkm",K$u.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},K$u.parserMap={},K$u.groupMap={},K$u.maxTimeOut=100,K$u.loadedMap={},K$u.preLoadedMap={},K$u.atlasMap={},K$u._loaders=[],K$u._isWorking=!1,K$u._startIndex=0,K$u.imgCache={},K$u.cacheSet={},K$u.objectSet={},K$u.imgMgrSet={},K$u}(),K$Zc=function(K$c){var K$x;function K$r(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},K$r.__super.call(this);for(var K$c=0;K$c<this._maxPriority;K$c++)this._resInfos[K$c]=[]}K$n(K$r,"laya.net.LoaderManager",K$S);var K$P=K$r.prototype;return K$P.create=function(K$c,K$q,K$P,K$_,K$E,K$b,K$e,K$h){if(null==K$b&&(K$b=2),null==K$e&&(K$e=!0),K$c instanceof Array){var K$Z=K$c,K$S=K$Z.length,K$n=0;if(K$P)var K$k=K$N.create(K$P.caller,K$P.method,K$P.args,!1);for(var K$x=0;K$x<K$S;K$x++){var K$r=K$Z[K$x];"string"==typeof K$r&&(K$r=K$Z[K$x]={url:K$r}),K$r.progress=0}for(K$x=0;K$x<K$S;K$x++){K$r=K$Z[K$x];var K$g=K$P?K$N.create(null,K$O,[K$r],!1):null,K$W=K$P||K$q?K$N.create(null,K$w,[K$r]):null;this._create(K$r.url,K$W,K$g,K$r.clas||K$_,K$r.params||K$E,null!=K$r.priority&&0<=K$r.priority?K$r.priority:K$b,K$e,K$r.group||K$h)}function K$w(K$c,K$P){K$n++,K$c.progress=1,K$n===K$S&&K$q&&K$q.run()}function K$O(K$c,K$P){K$c.progress=K$P;for(var K$q=0,K$_=0;K$_<K$S;K$_++){K$q+=K$Z[K$_].progress}var K$E=K$q/K$S;K$k.runWith(K$E)}return!0}return this._create(K$c,K$q,K$P,K$_,K$E,K$b,K$e,K$h)},K$P._create=function(K$P,K$q,K$c,K$_,K$E,K$b,K$e,K$h){K$P&&""!=K$P||console.error("加载的url不合法 "+K$P),null==K$b&&(K$b=2),null==K$e&&(K$e=!0);var K$Z=K$$.formatURL(K$P),K$S=this.getRes(K$Z);if(K$S)!K$S.hasOwnProperty("loaded")||K$S.loaded?(K$c&&K$c.runWith(1),K$q&&K$q.run()):K$q&&K$H.loader._createListener(K$P,K$q.caller,K$q.method,K$q.args,!0,!1);else{var K$n=K$p.getFileExtension(K$P),K$k=K$r.createMap[K$n];if(!K$k)throw new Error("LoaderManager:unknown file("+K$P+") extension with: "+K$n+".");K$_||(K$_=K$k[0]);var K$x=K$k[1];if("atlas"==K$n)this.load(K$P,K$q,K$c,K$x,K$b,K$e);else{K$_===K$nc&&(K$x="htmlimage"),(K$S=K$_?new K$_:null).hasOwnProperty("_loaded")&&(K$S._loaded=!1),K$S._setUrl(K$P),K$h&&K$S._setGroup(K$h),this._createLoad(K$S,K$P,K$N.create(null,function(K$c){K$S&&!K$S.destroyed&&K$c&&K$S.onAsynLoaded.call(K$S,K$P,K$c,K$E),K$q&&K$q.run();K$H.loader.event(K$P)}),K$c,K$x,K$b,!1,K$h,!0),K$e&&this.cacheRes(K$Z,K$S)}}return K$S},K$P.load=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){K$c&&""!=K$c||console.error("加载的url不合法 "+K$c);var K$Z=this;if(null==K$E&&(K$E=2),null==K$b&&(K$b=!0),void 0===K$h&&(K$h=!1),K$c instanceof Array)return this._loadAssets(K$c,K$P,K$q,K$_,K$E,K$b,K$e);var K$S=K$hc.getRes(K$c);if(null!=K$S)K$H.timer.frameOnce(1,null,function(){K$q&&K$q.runWith(1),K$P&&K$P.runWith(K$S),K$Z._loaderCount||K$Z.event("complete")});else{var K$n=K$r._resMap[K$c];K$n?(K$P&&K$n._createListener("complete",K$P.caller,K$P.method,K$P.args,!1,!1),K$q&&K$n._createListener("progress",K$q.caller,K$q.method,K$q.args,!1,!1)):((K$n=this._infoPool.length?this._infoPool.pop():new K$x).url=K$c,K$n.clas=null,K$n.type=K$_,K$n.cache=K$b,K$n.group=K$e,K$n.ignoreCache=K$h,K$n.priority=K$E,K$P&&K$n.on("complete",K$P.caller,K$P.method,K$P.args),K$q&&K$n.on("progress",K$q.caller,K$q.method,K$q.args),K$r._resMap[K$c]=K$n,K$E=K$E<this._maxPriority?0<=K$E?K$E:0:this._maxPriority-1,this._resInfos[K$E].push(K$n),this._next())}return this},K$P.cancel=function(K$c,K$P,K$q){if(K$S=K$r._resMap[K$c]){K$P&&K$S.off("complete",K$P.caller,K$P.method,!1),K$q&&K$S.off("progress",K$q.caller,K$q.method,!1);var K$_=K$S.getListener("complete"),K$E=K$S.getListener("progress");if(!(K$_&&K$_.head||K$E&&K$E.head)){if(K$S.loader){var K$b=K$S.loader;K$b.imageCancel(K$c),K$b.offAll(),K$b._data=null,K$b._customParse=!1,K$b._url=null,K$b._class=null,K$b._type=null,this._loaders.push(K$b),this._loaderCount--,delete this._loaderMap[K$S.url]}for(var K$e=0;K$e<this._maxPriority;K$e++)for(var K$h=this._resInfos[K$e],K$Z=K$h.length-1;-1<K$Z;K$Z--){var K$S;(K$S=K$h[K$Z])&&K$S.url===K$c&&(K$h[K$Z]=null,K$S.destroy(),K$S.offAll(),this._infoPool.push(K$S))}delete K$r._resMap[K$c],this._next()}}},K$P._createLoad=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){var K$S=this;if(null==K$b&&(K$b=2),null==K$e&&(K$e=!0),void 0===K$Z&&(K$Z=!1),K$P instanceof Array)return this._loadAssets(K$P,K$q,K$_,K$E,K$b,K$e,K$h);var K$n=K$hc.getRes(K$P);if(null!=K$n)K$H.timer.frameOnce(1,null,function(){K$_&&K$_.runWith(1),K$q&&K$q.runWith(K$n),K$S._loaderCount||K$S.event("complete")});else{var K$k=K$r._resMap[K$P];K$k?(K$q&&K$k._createListener("complete",K$q.caller,K$q.method,K$q.args,!1,!1),K$_&&K$k._createListener("progress",K$_.caller,K$_.method,K$_.args,!1,!1)):((K$k=this._infoPool.length?this._infoPool.pop():new K$x).url=K$P,K$k.clas=K$c,K$k.type=K$E,K$k.cache=K$e,K$k.group=K$h,K$k.ignoreCache=K$Z,K$k.priority=K$b,K$q&&K$k.on("complete",K$q.caller,K$q.method,K$q.args),K$_&&K$k.on("progress",K$_.caller,K$_.method,K$_.args),K$r._resMap[K$P]=K$k,K$b=K$b<this._maxPriority?0<=K$b?K$b:0:this._maxPriority-1,this._resInfos[K$b].push(K$k),this._next())}return this},K$P._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var K$c=0;K$c<this._maxPriority;K$c++)for(var K$P=this._resInfos[K$c];0<K$P.length;){var K$q=K$P.shift();if(K$q)return this._doLoad(K$q)}this._loaderCount||this.event("complete")}},K$P._doLoad=function(K$P){var K$q=this._loaders.length?this._loaders.pop():new K$hc;this._loaderCount++,(this._loaderMap[K$P.url]=K$q).on("complete",null,K$E),K$q.on("progress",null,function(K$c){K$P.event("progress",K$c)}),K$q.on("error",null,function(K$c){K$E(null)}),K$P.loader=K$q;var K$_=this;function K$E(K$c){K$q.offAll(),K$q._data=null,K$q._customParse=!1,K$q._url=null,K$q._class=null,K$q._type=null,K$_._loaders.push(K$q),K$_._loaderCount--,delete K$_._loaderMap[K$P.url],K$_._endLoad(K$P,K$c instanceof Array?[K$c]:K$c),K$_._next()}K$q._class=K$P.clas,1<=K$P.priority?(K$q.priority=K$P.priority,K$q.realTime=!1):(K$q.priority=0,K$q.realTime=!0),K$q.load(K$P.url,K$P.type,K$P.cache,K$P.group,K$P.ignoreCache)},K$P._endLoad=function(K$c,K$P){var K$q=K$c.url;if(null==K$P){var K$_=this._failRes[K$q]||0;if(K$_<this.retryNum)return console.warn("[warn]Retry to load:",K$q),this._failRes[K$q]=K$_+1,void K$H.timer.once(this.retryDelay,this,this._addReTry,[K$c],!1);console.warn("[error]Failed to load:",K$q),this.event("error",K$q)}this._failRes[K$q]&&(this._failRes[K$q]=0),delete K$r._resMap[K$q],K$c.event("complete",K$P),K$c.destroy(),K$c.offAll(),this._infoPool.push(K$c)},K$P._addReTry=function(K$c){this._resInfos[this._maxPriority-1].push(K$c),this._next()},K$P.clearRes=function(K$c,K$P){void 0===K$P&&(K$P=!1),K$hc.clearRes(K$c,K$P)},K$P.getRes=function(K$c){return K$hc.getRes(K$c)},K$P.cacheRes=function(K$c,K$P){K$hc.cacheRes(K$c,K$P)},K$P.clearTextureRes=function(K$c){K$hc.clearTextureRes(K$c)},K$P.setGroup=function(K$c,K$P){K$hc.setGroup(K$c,K$P)},K$P.clearResByGroup=function(K$c){K$hc.clearResByGroup(K$c)},K$P.clearUnLoaded=function(){for(var K$c=0;K$c<this._maxPriority;K$c++){for(var K$P=this._resInfos[K$c],K$q=K$P.length-1;-1<K$q;K$q--){var K$_=K$P[K$q];K$_&&(K$_.destroy(),K$_.offAll(),this._infoPool.push(K$_))}K$P.length=0}this._loaderCount=0,K$r._resMap={}},K$P.cancelLoadByUrls=function(K$c){if(K$c)for(var K$P=0,K$q=K$c.length;K$P<K$q;K$P++)this.cancelLoadByUrl(K$c[K$P])},K$P.cancelLoadByUrl=function(K$c){for(var K$P=0;K$P<this._maxPriority;K$P++)for(var K$q=this._resInfos[K$P],K$_=K$q.length-1;-1<K$_;K$_--){var K$E=K$q[K$_];K$E&&K$E.url===K$c&&(K$q[K$_]=null,K$E.destroy(),K$E.offAll(),this._infoPool.push(K$E))}K$r._resMap[K$c]&&delete K$r._resMap[K$c]},K$P._loadAssets=function(K$c,K$q,K$e,K$P,K$_,K$E,K$b){null==K$_&&(K$_=2),null==K$E&&(K$E=!0);for(var K$h=K$c.length,K$Z=0,K$S=0,K$n=[],K$k=!0,K$x=0;K$x<K$h;K$x++){var K$r=K$c[K$x];if(!K$r)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+K$c);"string"==typeof K$r&&(K$r={url:K$r,type:K$P,size:1,priority:K$_}),K$r.size||(K$r.size=1),K$r.progress=0,K$S+=K$r.size,K$n.push(K$r);var K$g=K$e?K$N.create(null,K$O,[K$r],!1):null,K$W=K$q||K$e?K$N.create(null,K$w,[K$r]):null;this.load(K$r.url,K$W,K$g,K$r.type,null!=K$r.priority&&0<=K$r.priority?K$r.priority:2,K$E,K$r.group||K$b)}function K$w(K$c,K$P){K$Z++,K$c.progress=1,K$P||(K$k=!1),K$Z===K$h&&K$q&&K$q.runWith(K$k)}function K$O(K$c,K$P){if(null!=K$e){K$c.progress=K$P;for(var K$q=0,K$_=0;K$_<K$n.length;K$_++){var K$E=K$n[K$_];K$q+=K$E.size*K$E.progress}var K$b=K$q/K$S;K$e.runWith(K$b)}}return this},K$r.cacheRes=function(K$c,K$P){K$hc.cacheRes(K$c,K$P)},K$r._resMap={},K$Z(K$r,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),K$r.__init$=function(){K$x=function(K$c){function K$P(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,K$P.__super.call(this)}return K$n(K$P,"",K$S),K$P.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},K$P}()},K$r}(),K$Sc=(function(K$c){function K$E(K$c){K$E.__super.call(this),K$c||(K$c=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var K$P=0,K$q=0,K$_=0;K$_<20;K$_++)K$_%5!=4?this._mat[K$P++]=K$c[K$_]:this._alpha[K$q++]=K$c[K$_];this._action=K$j.createFilterAction(32),this._action.data=this}K$n(K$E,"laya.filters.ColorFilter",K$O);var K$P=K$E.prototype;K$H.imps(K$P,{"laya.filters.IFilter":!0}),K$P.callNative=function(K$c){K$c._$P.cf=this;K$c.conchModel&&K$c.conchModel.setFilterMatrix&&K$c.conchModel.setFilterMatrix(this._mat,this._alpha)},K$g(0,K$P,"type",function(){return 32}),K$g(0,K$P,"action",function(){return this._action})}(),function(K$c){function K$_(K$c,K$P,K$q){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===K$P&&(K$P=0),K$_.__super.call(this),this._byteClass=K$q||K$U,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,K$c&&0<K$P&&K$P<65535&&this.connect(K$c,K$P)}K$n(K$_,"laya.net.Socket",K$S);var K$P=K$_.prototype;K$P.connect=function(K$c,K$P){var K$q="ws://"+K$c+":"+K$P;K$q="https:"==K$s.window.location.protocol?"wss://"+K$c+":"+K$P:"ws://"+K$c+":"+K$P,this.connectByUrl(K$q)},K$P.connectByUrl=function(K$c){var K$P=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new K$s.window.WebSocket(K$c,this.protocols):this._socket=new K$s.window.WebSocket(K$c),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(K$c){K$P._onOpen(K$c)},this._socket.onmessage=function(K$c){K$P._onMessage(K$c)},this._socket.onclose=function(K$c){K$P._onClose(K$c)},this._socket.onerror=function(K$c){K$P._onError(K$c)}},K$P.cleanSocket=function(){try{this._socket.close()}catch(K$c){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},K$P.close=function(){if(null!=this._socket)try{this._socket.close()}catch(K$c){}},K$P._onOpen=function(K$c){this._connected=!0,this.event("open",K$c)},K$P._onMessage=function(K$c){if(K$c&&K$c.data){var K$P=K$c.data;if(this.disableInput&&K$P)this.event("message",K$P);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var K$q=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,K$P&&("string"==typeof K$P?this._input.writeUTFBytes(K$P):this._input.writeArrayBuffer(K$P),this._addInputPosition=this._input.pos,this._input.pos=K$q),this.event("message",K$P)}}},K$P._onClose=function(K$c){this._connected=!1,this.event("close",K$c)},K$P._onError=function(K$c){this.event("error",K$c)},K$P.send=function(K$c){this._socket.send(K$c)},K$P.flush=function(){if(this._output&&0<this._output.length){var K$P;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(K$c){K$P=K$c}this._output.endian=this.endian,this._output.clear(),K$P&&this.event("error",K$P)}},K$g(0,K$P,"input",function(){return this._input}),K$g(0,K$P,"output",function(){return this._output}),K$g(0,K$P,"connected",function(){return this._connected}),K$g(0,K$P,"endian",function(){return this._endian},function(K$c){this._endian=K$c,null!=this._input&&(this._input.endian=K$c),null!=this._output&&(this._output.endian=K$c)}),K$_.LITTLE_ENDIAN="littleEndian",K$_.BIG_ENDIAN="bigEndian"}(),function(K$c){function K$h(){K$h.__super.call(this),this._$1__id=++K$h._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(K$h._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,K$Y.currentResourceManager&&K$Y.currentResourceManager.addResource(this)}K$n(K$h,"laya.resource.Resource",K$S);var K$P=K$h.prototype;return K$H.imps(K$P,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),K$P._setUrl=function(K$c){var K$P;this._url!==K$c&&(this._url&&((K$P=K$h._urlResourcesMap[this._url]).splice(K$P.indexOf(this),1),0===K$P.length&&delete K$h._urlResourcesMap[this._url]),K$c&&((K$P=K$h._urlResourcesMap[K$c])||(K$h._urlResourcesMap[K$c]=K$P=[]),K$P.push(this)),this._url=K$c)},K$P._getGroup=function(){return this._group},K$P._setGroup=function(K$c){var K$P;this._group!==K$c&&(this._group&&((K$P=K$h._groupResourcesMap[this._group]).splice(K$P.indexOf(this),1),0===K$P.length&&delete K$h._groupResourcesMap[this._group]),K$c&&((K$P=K$h._groupResourcesMap[K$c])||(K$h._groupResourcesMap[K$c]=K$P=[]),K$P.push(this)),this._group=K$c)},K$P._addReference=function(){this._referenceCount++},K$P._removeReference=function(){this._referenceCount--},K$P._clearReference=function(){this._referenceCount=0},K$P._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},K$P.recreateResource=function(){this.completeCreate()},K$P.disposeResource=function(){},K$P.activeResource=function(K$c){void 0===K$c&&(K$c=!1),this._lastUseFrameCount=K$l.loopCount,!this._destroyed&&this.__loaded&&(this._released||K$c)&&this.recreateResource()},K$P.releaseResource=function(K$c){return void 0===K$c&&(K$c=!0),!(!K$c&&this.lock)&&(!(this._released&&!K$c)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},K$P.onAsynLoaded=function(K$c,K$P,K$q){throw new Error("Resource: must override this function!")},K$P.destroy=function(){var K$c;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete K$h._idResourcesMap[this.id],this._url&&((K$c=K$h._urlResourcesMap[this._url])&&(K$c.splice(K$c.indexOf(this),1),0===K$c.length&&delete K$h._urlResourcesMap[this.url]),K$hc.clearRes(this._url),this.__loaded||K$j.cancelLoadByUrl(this._url)),this._group&&((K$c=K$h._groupResourcesMap[this._group]).splice(K$c.indexOf(this),1),0===K$c.length&&delete K$h._groupResourcesMap[this.url]))},K$P.completeCreate=function(){this._released=!1,this.event("recovered",this)},K$P.dispose=function(){this.destroy()},K$g(0,K$P,"memorySize",function(){return this._memorySize},function(K$c){var K$P=K$c-this._memorySize;this._memorySize=K$c,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,K$P),this.resourceManager&&this.resourceManager.addSize(K$P)}),K$g(0,K$P,"_loaded",null,function(K$c){this.__loaded=K$c}),K$g(0,K$P,"loaded",function(){return this.__loaded}),K$g(0,K$P,"id",function(){return this._$1__id}),K$g(0,K$P,"destroyed",function(){return this._destroyed}),K$g(0,K$P,"group",function(){return this._getGroup()},function(K$c){this._setGroup(K$c)}),K$g(0,K$P,"resourceManager",function(){return this._resourceManager}),K$g(0,K$P,"url",function(){return this._url}),K$g(0,K$P,"released",function(){return this._released}),K$g(0,K$P,"referenceCount",function(){return this._referenceCount}),K$h.getResourceByID=function(K$c){return K$h._idResourcesMap[K$c]},K$h.getResourceByURL=function(K$c,K$P){return void 0===K$P&&(K$P=0),null==K$h._urlResourcesMap[K$c]?null:K$h._urlResourcesMap[K$c][K$P]},K$h.getResourceCountByURL=function(K$c){return K$h._urlResourcesMap[K$c].length},K$h.destroyUnusedResources=function(K$c){var K$P;if(K$c){var K$q=K$h._groupResourcesMap[K$c];if(K$q)for(var K$_=K$q.slice(),K$E=0,K$b=K$_.length;K$E<K$b;K$E++)(K$P=K$_[K$E]).lock||0!==K$P._referenceCount||K$P.destroy()}else for(var K$e in K$h._idResourcesMap)(K$P=K$h._idResourcesMap[K$e]).lock||0!==K$P._referenceCount||K$P.destroy()},K$h._uniqueIDCounter=0,K$h._idResourcesMap={},K$h._urlResourcesMap={},K$h._groupResourcesMap={},K$h}()),K$nc=function(K$c){function K$u(K$c,K$P){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,K$u.__super.call(this),K$c&&null!=K$c._addReference&&K$c._addReference(),this.setTo(K$c,K$P)}K$n(K$u,"laya.resource.Texture",K$S);var K$P=K$u.prototype;return K$P._setUrl=function(K$c){this.url=K$c},K$P.setTo=function(K$c,K$P){if(K$c instanceof K$e.HTMLElement){var K$q=K$mc.create("2D",K$c);this.bitmap=K$q}else this.bitmap=K$c;if(this.uv=K$P||K$u.DEF_UV,K$c){this._w=K$c.width,this._h=K$c.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var K$_=this;if(this._loaded)K$j.addToAtlas&&K$j.addToAtlas(K$_);else{var K$E=K$c;K$E instanceof laya.resource.HTMLImage&&K$E.image&&K$E.image.addEventListener("load",function(K$c){K$j.addToAtlas&&K$j.addToAtlas(K$_)},!1)}}},K$P.active=function(){this.bitmap&&this.bitmap.activeResource()},K$P.destroy=function(K$c){if(void 0===K$c&&(K$c=!1),this.alphaTexture&&(this.alphaTexture.destroy(K$c),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var K$P=this.bitmap;K$c?(K$C.isConchApp&&K$P.source&&K$P.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,K$P.dispose(),K$P._clearReference()):(K$P._removeReference(),0==K$P.referenceCount&&(K$C.isConchApp&&K$P.source&&K$P.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,K$P.dispose())),this.url&&this===K$H.loader.getRes(this.url)&&K$H.loader.clearRes(this.url,K$c),this._loaded=!1}},K$P.load=function(K$c){var K$P=this;this._loaded=!1,K$c=K$$.customFormat(K$c);var K$q=this.bitmap||(this.bitmap=K$Lc.create(K$c));K$q.uri=K$c,K$q&&K$q._addReference();var K$_=this;K$q.onload=function(){K$q.onload=null,K$_._loaded=!0,K$P.sourceWidth=K$P._w=K$q.width,K$P.sourceHeight=K$P._h=K$q.height,K$_.event("loaded",this),K$j.addToAtlas&&K$j.addToAtlas(K$_)}},K$P.addTextureToAtlas=function(K$c){K$j.addTextureToAtlas(this)},K$P.getPixels=function(K$c,K$P,K$q,K$_){if(K$C.isConchApp){var K$E=this.bitmap;if(K$E.source&&K$E.source.getImageData){var K$b=K$E.source.getImageData(K$c,K$P,K$q,K$_),K$e=new Uint8Array(K$b);return Array.from(K$e)}return null}return K$C.isWebGL?K$j.getTexturePixels(this,K$c,K$P,K$q,K$_):(K$s.canvas.size(K$q,K$_),K$s.canvas.clear(),K$s.context.drawTexture(this,-K$c,-K$P,this.width,this.height,0,0),K$s.context.getImageData(0,0,K$q,K$_).data)},K$P.onAsynLoaded=function(K$c,K$P){if(K$P){if("function"!=typeof K$P._addReference)throw new Error("bitmap._addReference is not a function. "+K$P.className+" "+typeof K$P._addReference+" "+K$P.constructor);K$P._addReference()}this.setTo(K$P,this.uv),this._loaded&&this.event("loaded",this)},K$g(0,K$P,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),K$g(0,K$P,"loaded",function(){return this._loaded}),K$g(0,K$P,"released",function(){return!this.bitmap||this.bitmap.released}),K$g(0,K$P,"width",function(){return this._w?this._w:this.uv&&this.uv!==K$u.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(K$c){this._w=K$c,this.sourceWidth||(this.sourceWidth=K$c)}),K$g(0,K$P,"repeat",function(){return!K$C.isWebGL||!this.bitmap||this.bitmap.repeat},function(K$c){K$c&&K$C.isWebGL&&this.bitmap&&(this.bitmap.repeat=K$c)&&(this.bitmap.enableMerageInAtlas=!1)}),K$g(0,K$P,"height",function(){return this._h?this._h:this.uv&&this.uv!==K$u.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(K$c){this._h=K$c,this.sourceHeight||(this.sourceHeight=K$c)}),K$g(0,K$P,"isLinearSampling",function(){return!K$C.isWebGL||9728!=this.bitmap.minFifter},function(K$c){!K$c&&K$C.isWebGL&&(K$c||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),K$u.moveUV=function(K$c,K$P,K$q){for(var K$_=0;K$_<8;K$_+=2)K$q[K$_]+=K$c,K$q[K$_+1]+=K$P;return K$q},K$u.create=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){void 0===K$b&&(K$b=0),void 0===K$e&&(K$e=0),void 0===K$h&&(K$h=0),void 0===K$Z&&(K$Z=0);var K$S=K$c instanceof laya.resource.Texture,K$n=K$S?K$c.uv:K$u.DEF_UV,K$k=K$S?K$c.bitmap:K$c,K$x=K$j.isAtlas(K$k);if(K$x){var K$r=K$k._atlaser,K$g=K$c._atlasID;if(-1==K$g)throw new Error("create texture error");K$k=K$r._inAtlasTextureBitmapValue[K$g],K$n=K$r._inAtlasTextureOriUVValue[K$g]}var K$W=new K$u(K$k,null);K$k.width&&K$P+K$_>K$k.width&&(K$_=K$k.width-K$P),K$k.height&&K$q+K$E>K$k.height&&(K$E=K$k.height-K$q),K$W.width=K$_,K$W.height=K$E,K$W.offsetX=K$b,K$W.offsetY=K$e,K$W.sourceWidth=K$h||K$_,K$W.sourceHeight=K$Z||K$E;var K$w=1/K$k.width,K$O=1/K$k.height;K$P*=K$w,K$q*=K$O,K$_*=K$w,K$E*=K$O;var K$N=K$W.uv[0],K$m=K$W.uv[1],K$T=K$W.uv[4],K$D=K$W.uv[5],K$L=K$T-K$N,K$H=K$D-K$m,K$Q=K$u.moveUV(K$n[0],K$n[1],[K$P,K$q,K$P+K$_,K$q,K$P+K$_,K$q+K$E,K$P,K$q+K$E]);K$W.uv=[K$N+K$Q[0]*K$L,K$m+K$Q[1]*K$H,K$T-(1-K$Q[2])*K$L,K$m+K$Q[3]*K$H,K$T-(1-K$Q[4])*K$L,K$D-(1-K$Q[5])*K$H,K$N+K$Q[6]*K$L,K$D-(1-K$Q[7])*K$H],K$x&&K$W.addTextureToAtlas();var K$d=K$k.scaleRate;return K$d&&1!=K$d?(K$W.sourceWidth/=K$d,K$W.sourceHeight/=K$d,K$W.width/=K$d,K$W.height/=K$d,K$W.scaleRate=K$d,K$W.offsetX/=K$d,K$W.offsetY/=K$d):K$W.scaleRate=1,K$W},K$u.createFromTexture=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$c.scaleRate;1!=K$b&&(K$P*=K$b,K$q*=K$b,K$_*=K$b,K$E*=K$b);var K$e=K$d.TEMP.setTo(K$P-K$c.offsetX,K$q-K$c.offsetY,K$_,K$E),K$h=K$e.intersection(K$u._rect1.setTo(0,0,K$c.width,K$c.height),K$u._rect2);if(!K$h)return null;var K$Z=K$u.create(K$c,K$h.x,K$h.y,K$h.width,K$h.height,K$h.x-K$e.x,K$h.y-K$e.y,K$_,K$E);if(K$Z.bitmap&&K$Z.bitmap._removeReference)return K$Z.bitmap._removeReference(),K$Z;var K$S="bitmap:"+(K$Z.bitmap?K$Z.bitmap.constructor?K$Z.bitmap.constructor.name:K$Z.bitmap.__className:"")+", url:"+(K$c.url+" | "+(K$Z.bitmap?K$Z.bitmap.url:K$c.url))+", x="+K$P+",y="+K$q+",width="+K$_+",height="+K$E+", result="+(K$h?K$h.x+","+K$h.y+","+K$h.width+","+K$h.height:"null")+", rect="+K$e.x+","+K$e.y+","+K$e.width+","+K$e.height;throw new Error("报错：bitmap._removeReference is not a function  "+K$S)},K$u.DEF_UV=[0,0,1,0,1,1,0,1],K$u.INV_UV=[0,1,1,1,1,0,0,0],K$u._rect1=new K$d,K$u._rect2=new K$d,K$u}(),K$c=function(K$c){var K$h;function K$b(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,K$b.__super.call(this)}K$n(K$b,"laya.utils.TimeLine",K$S);var K$P=K$b.prototype;return K$P.to=function(K$c,K$P,K$q,K$_,K$E){return void 0===K$E&&(K$E=0),this._create(K$c,K$P,K$q,K$_,K$E,!0)},K$P.from=function(K$c,K$P,K$q,K$_,K$E){return void 0===K$E&&(K$E=0),this._create(K$c,K$P,K$q,K$_,K$E,!1)},K$P._create=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=K$f.getItemByClass("tweenData",K$h);return K$e.isTo=K$b,K$e.type=0,K$e.target=K$c,K$e.duration=K$q,K$e.data=K$P,K$e.startTime=this._startTime+K$E,K$e.endTime=K$e.startTime+K$e.duration,K$e.ease=K$_,this._startTime=Math.max(K$e.endTime,this._startTime),this._tweenDataList.push(K$e),this._startTimeSort=!0,this._endTimeSort=!0,this},K$P.addLabel=function(K$c,K$P){var K$q=K$f.getItemByClass("tweenData",K$h);return K$q.type=1,K$q.data=K$c,K$q.endTime=K$q.startTime=this._startTime+K$P,this._labelDic||(this._labelDic={}),this._labelDic[K$c]=K$q,this._tweenDataList.push(K$q),this},K$P.removeLabel=function(K$c){if(this._labelDic&&this._labelDic[K$c]){var K$P=this._labelDic[K$c];if(K$P){var K$q=this._tweenDataList.indexOf(K$P);-1<K$q&&this._tweenDataList.splice(K$q,1)}delete this._labelDic[K$c]}},K$P.gotoTime=function(K$c){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var K$P,K$q,K$_,K$E;for(var K$b in this._firstTweenDic)if(K$q=this._firstTweenDic[K$b])for(var K$e in K$q)K$q.diyTarget.hasOwnProperty(K$e)&&(K$q.diyTarget[K$e]=K$q[K$e]);for(K$b in this._tweenDic)(K$P=this._tweenDic[K$b]).clear(),delete this._tweenDic[K$b];if(this._index=0,this._gidIndex=0,this._currTime=K$c,this._lastTime=K$s.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=K$_=this._tweenDataList.concat(),K$_.sort(function(K$c,K$P){return K$c.endTime>K$P.endTime?1:K$c.endTime<K$P.endTime?-1:0})}else K$_=this._endTweenDataList;for(var K$h=0,K$Z=K$_.length;K$h<K$Z;K$h++)if(0==(K$E=K$_[K$h]).type){if(!(K$c>=K$E.endTime))break;this._index=Math.max(this._index,K$h+1);var K$S=K$E.data;if(K$E.isTo)for(var K$n in K$S)K$E.target[K$n]=K$S[K$n]}for(K$h=0,K$Z=this._tweenDataList.length;K$h<K$Z;K$h++)0==(K$E=this._tweenDataList[K$h]).type&&K$c>=K$E.startTime&&K$c<K$E.endTime&&(this._index=Math.max(this._index,K$h+1),this._gidIndex++,(K$P=K$f.getItemByClass("tween",K$B))._create(K$E.target,K$E.data,K$E.duration,K$E.ease,K$N.create(this,this._animComplete,[this._gidIndex]),0,!1,K$E.isTo,!0,!1),K$P.setStartTime(this._currTime-(K$c-K$E.startTime)),K$P._updateEase(this._currTime),K$P.gid=this._gidIndex,this._tweenDic[this._gidIndex]=K$P)}},K$P.gotoLabel=function(K$c){if(null!=this._labelDic){var K$P=this._labelDic[K$c];K$P&&this.gotoTime(K$P.startTime)}},K$P.pause=function(){K$H.timer.clear(this,this._update)},K$P.resume=function(){this.play(this._currTime,this._loopKey)},K$P.play=function(K$c,K$P){if(void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(K$c,K$P){return K$c.startTime>K$P.startTime?1:K$c.startTime<K$P.startTime?-1:0});for(var K$q=0,K$_=this._tweenDataList.length;K$q<K$_;K$q++){var K$E=this._tweenDataList[K$q];if(null!=K$E&&0==K$E.type){var K$b=K$E.target,K$e=K$b.$_GID||(K$b.$_GID=K$p.getGID()),K$h=null;for(var K$Z in null==this._firstTweenDic[K$e]?((K$h={}).diyTarget=K$b,this._firstTweenDic[K$e]=K$h):K$h=this._firstTweenDic[K$e],K$E.data)null==K$h[K$Z]&&(K$h[K$Z]=K$b[K$Z])}}}"string"==typeof K$c?this.gotoLabel(K$c):this.gotoTime(K$c),this._loopKey=K$P,this._lastTime=K$s.now(),K$H.timer.frameLoop(1,this,this._update)}},K$P._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var K$c in this._tweenDic)(K$P=this._tweenDic[K$c]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var K$P,K$q=K$s.now(),K$_=K$q-this._lastTime,K$E=this._currTime+=K$_*this.scale;for(K$c in this._lastTime=K$q,this._tweenDic)(K$P=this._tweenDic[K$c])._updateEase(K$E);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var K$b=this._tweenDataList[this._index];K$E>=K$b.startTime&&(this._index++,0==K$b.type?(this._gidIndex++,(K$P=K$f.getItemByClass("tween",K$B))._create(K$b.target,K$b.data,K$b.duration,K$b.ease,K$N.create(this,this._animComplete,[this._gidIndex]),0,!1,K$b.isTo,!0,!1),K$P.setStartTime(K$E),K$P.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=K$P)._updateEase(K$E)):this.event("label",K$b.data))}},K$P._animComplete=function(K$c){this._tweenDic[K$c]&&delete this._tweenDic[K$c]},K$P._complete=function(){this.event("complete")},K$P.reset=function(){var K$c;if(this._labelDic)for(K$c in this._labelDic)delete this._labelDic[K$c];for(K$c in this._tweenDic)this._tweenDic[K$c].clear(),delete this._tweenDic[K$c];for(K$c in this._firstTweenDic)delete this._firstTweenDic[K$c];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var K$P,K$q=0;for(K$P=this._tweenDataList.length,K$q=0;K$q<K$P;K$q++)this._tweenDataList[K$q]&&this._tweenDataList[K$q].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,K$H.timer.clear(this,this._update)},K$P.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},K$g(0,K$P,"index",function(){return this._frameIndex},function(K$c){this._frameIndex=K$c,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),K$g(0,K$P,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),K$b.to=function(K$c,K$P,K$q,K$_,K$E){return void 0===K$E&&(K$E=0),(new K$b).to(K$c,K$P,K$q,K$_,K$E)},K$b.from=function(K$c,K$P,K$q,K$_,K$E){return void 0===K$E&&(K$E=0),(new K$b).from(K$c,K$P,K$q,K$_,K$E)},K$b.__init$=function(){K$h=function(){function K$c(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return K$n(K$c,""),K$c.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,K$f.recover("tweenData",this)},K$c}()},K$b}(),K$kc=function(K$E){function K$q(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,K$q.__super.call(this),this._style=K$h.EMPTY}K$n(K$q,"laya.display.Sprite",K$E);var K$c=K$q.prototype;return K$H.imps(K$c,{"laya.display.ILayout":!0}),K$c.createConchModel=function(){return new ConchNode},K$c.destroy=function(K$c){if(void 0===K$c&&(K$c=!0),this._releaseMem(),!this._destroyed){this.filters=null;var K$P=this.mask;K$P&&(this.mask=null,K$P.destroy(K$c))}K$E.prototype.destroy.call(this,K$c),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},K$c.updateZOrder=function(){K$p.updateOrder(this._childs)&&this.repaint()},K$c.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},K$c.setBounds=function(K$c){this._set$P("uBounds",K$c)},K$c.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new K$d),K$d._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},K$c.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new K$d),K$d._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},K$c._boundPointsToParent=function(K$c){void 0===K$c&&(K$c=!1);var K$P=0,K$q=0;this._style&&(K$P=this._style._tf.translateX,K$q=this._style._tf.translateY,K$c=K$c||0!==this._style._tf.rotate,this._style.scrollRect&&(K$P+=this._style.scrollRect.x,K$q+=this._style.scrollRect.y));var K$_=this._getBoundPointsM(K$c);if(!K$_||K$_.length<1)return K$_;if(8!=K$_.length&&(K$_=K$c?K$D.scanPList(K$_):K$d._getWrapRec(K$_,K$d.TEMP)._getBoundPoints()),!this.transform)return K$p.transPointList(K$_,this._x-K$P,this._y-K$q),K$_;var K$E=K$Q.TEMP,K$b=0,K$e=K$_.length;for(K$b=0;K$b<K$e;K$b+=2)K$E.x=K$_[K$b],K$E.y=K$_[K$b+1],this.toParentPoint(K$E),K$_[K$b]=K$E.x,K$_[K$b+1]=K$E.y;return K$_},K$c.getGraphicBounds=function(K$c){return void 0===K$c&&(K$c=!1),this._graphics?this._graphics.getBounds(K$c):K$d.TEMP.setTo(0,0,0,0)},K$c._getBoundPointsM=function(K$c){if(void 0===K$c&&(K$c=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var K$P=K$p.clearArray(this._$P.temBM),K$q=K$d.TEMP;return K$q.copyFrom(this.scrollRect),K$p.concatArray(K$P,K$q._getBoundPoints()),K$P}for(var K$_,K$E,K$b,K$e=this._graphics?this._graphics.getBoundPoints():K$p.clearArray(this._$P.temBM),K$h=0,K$Z=(K$b=this._childs).length;K$h<K$Z;K$h++)(K$_=K$b[K$h])instanceof laya.display.Sprite&&1==K$_.visible&&(K$E=K$_._boundPointsToParent(K$c))&&(K$e=K$e?K$p.concatArray(K$e,K$E):K$E);return K$e},K$c.getStyle=function(){return this._style===K$h.EMPTY&&(this._style=new K$h),this._style},K$c.setStyle=function(K$c){this._style=K$c},K$c._adjustTransform=function(){this._tfChanged=!1;var K$c,K$P=this._style._tf,K$q=K$P.scaleX,K$_=K$P.scaleY;if(K$P.rotate||1!==K$q||1!==K$_||K$P.skewX||K$P.skewY){(K$c=this._transform||(this._transform=K$V.create())).bTransform=!0;var K$E=.0174532922222222*(K$P.rotate-K$P.skewX),K$b=.0174532922222222*(K$P.rotate+K$P.skewY),K$e=Math.cos(K$b),K$h=Math.sin(K$b),K$Z=Math.sin(K$E),K$S=Math.cos(K$E);return K$c.a=K$q*K$e,K$c.b=K$q*K$h,K$c.c=-K$_*K$Z,K$c.d=K$_*K$S,K$c.tx=K$c.ty=0,K$c}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,K$c},K$c.pos=function(K$c,K$P,K$q){if(void 0===K$q&&(K$q=!1),this._x!==K$c||this._y!==K$P){if(this.destroyed)return this;if(K$q){this._x=K$c,this._y=K$P,this.conchModel&&this.conchModel.pos(this._x,this._y);var K$_=this._parent;K$_&&0===K$_._repaint&&(K$_._repaint=1,K$_.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=K$c,this.y=K$P}return this},K$c.pivot=function(K$c,K$P){return this.pivotX=K$c,this.pivotY=K$P,this},K$c.size=function(K$c,K$P){return this.width=K$c,this.height=K$P,this},K$c.scale=function(K$c,K$P,K$q){void 0===K$q&&(K$q=!1);var K$_=this.getStyle(),K$E=K$_._tf;if(K$E.scaleX!=K$c||K$E.scaleY!=K$P){if(this.destroyed)return this;if(K$q){K$_.setScale(K$c,K$P),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(K$c,K$P),this._renderType|=4;var K$b=this._parent;K$b&&0===K$b._repaint&&(K$b._repaint=1,K$b.parentRepaint())}else this.scaleX=K$c,this.scaleY=K$P}return this},K$c.skew=function(K$c,K$P){return this.skewX=K$c,this.skewY=K$P,this},K$c.render=function(K$c,K$P,K$q){K$l.spriteCount++,K$o.renders[this._renderType]._fun(this,K$c,K$P+this._x,K$q+this._y),this._repaint=0},K$c.drawToCanvas=function(K$c,K$P,K$q,K$_){if(K$C.isConchNode){var K$E=K$mc.create("2D");return new K$F(K$c,K$P,K$E).ctx.setCanvasType(1),this.conchModel.drawToCanvas(K$E.source,K$q,K$_),K$E}return K$j.drawToCanvas(this,this._renderType,K$c,K$P,K$q,K$_)},K$c.customRender=function(K$c,K$P,K$q){this._renderType|=1024},K$c._applyFilters=function(){var K$c;if(!K$C.isWebGL&&((K$c=this._$P.filters)&&!(K$c.length<1)))for(var K$P=0,K$q=K$c.length;K$P<K$q;K$P++)K$c[K$P].action.apply(this._$P.cacheCanvas)},K$c._isHaveGlowFilter=function(){var K$c,K$P=0;if(this.filters)for(K$P=0;K$P<this.filters.length;K$P++)if(8==this.filters[K$P].type)return!0;for(K$P=0,K$c=this._childs.length;K$P<K$c;K$P++)if(this._childs[K$P]._isHaveGlowFilter())return!0;return!1},K$c.localToGlobal=function(K$c,K$P){void 0===K$P&&(K$P=!1),!0===K$P&&(K$c=new K$Q(K$c.x,K$c.y));for(var K$q=this;K$q&&K$q!=K$H.stage;)K$c=K$q.toParentPoint(K$c),K$q=K$q.parent;return K$c},K$c.globalToLocal=function(K$c,K$P){void 0===K$P&&(K$P=!1),K$P&&(K$c=new K$Q(K$c.x,K$c.y));for(var K$q=this,K$_=[];K$q&&K$q!=K$H.stage;)K$_.push(K$q),K$q=K$q.parent;for(var K$E=K$_.length-1;0<=K$E;)K$c=(K$q=K$_[K$E]).fromParentPoint(K$c),K$E--;return K$c},K$c.toParentPoint=function(K$c){if(!K$c)return K$c;K$c.x-=this.pivotX,K$c.y-=this.pivotY,this.transform&&this._transform.transformPoint(K$c),K$c.x+=this._x,K$c.y+=this._y;var K$P=this._style.scrollRect;return K$P&&(K$c.x-=K$P.x,K$c.y-=K$P.y),K$c},K$c.fromParentPoint=function(K$c){if(!K$c)return K$c;K$c.x-=this._x,K$c.y-=this._y;var K$P=this._style.scrollRect;return K$P&&(K$c.x+=K$P.x,K$c.y+=K$P.y),this.transform&&this._transform.invertTransformPoint(K$c),K$c.x+=this.pivotX,K$c.y+=this.pivotY,K$c},K$c.on=function(K$c,K$P,K$q,K$_){return 1!==this._mouseEnableState&&this.isMouseEvent(K$c)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(K$c,K$P,K$q,K$_,!1)):K$E.prototype.on.call(this,K$c,K$P,K$q,K$_)},K$c.once=function(K$c,K$P,K$q,K$_){return 1!==this._mouseEnableState&&this.isMouseEvent(K$c)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(K$c,K$P,K$q,K$_,!0)):K$E.prototype.once.call(this,K$c,K$P,K$q,K$_)},K$c._$2__onDisplay=function(){if(1!==this._mouseEnableState){var K$c=this;for(K$c=K$c.parent;K$c&&1!==K$c._mouseEnableState&&!K$c._getBit(2);)K$c.mouseEnabled=!0,K$c._setBit(2,!0),K$c=K$c.parent}},K$c.loadImage=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=this;return void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=0),void 0===K$E&&(K$E=0),this.graphics.loadImage(K$c,K$P,K$q,K$_,K$E,function(K$c){K$e.destroyed||(K$e.size(K$P+(K$_||K$c.width),K$q+(K$E||K$c.height)),K$e.repaint(),K$b&&K$b.runWith(K$c))}),this},K$c.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},K$c._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},K$c._childChanged=function(K$c){this._childs.length?this._renderType|=2048:this._renderType&=-2049,K$c&&this._get$P("hasZorder")&&K$H.timer.callLater(this,this.updateZOrder),this.repaint()},K$c.parentRepaint=function(){var K$c=this._parent;K$c&&0===K$c._repaint&&(K$c._repaint=1,K$c.parentRepaint())},K$c.startDrag=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){void 0===K$P&&(K$P=!1),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=300),void 0===K$b&&(K$b=!1),void 0===K$e&&(K$e=.92),this._$P.dragging||this._set$P("dragging",new K$M),this._$P.dragging.start(this,K$c,K$P,K$q,K$_,K$E,K$b,K$e)},K$c.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},K$c._releaseMem=function(){if(this._$P){var K$c=this._$P.cacheCanvas;K$c&&K$c.ctx&&(K$f.recover("RenderContext",K$c.ctx),K$c.ctx.canvas.size(0,0),K$c.ctx=null);var K$P=this._$P._filterCache;K$P&&(K$P.destroy(),K$P.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},K$c._setDisplay=function(K$c){K$c||this._releaseMem(),K$E.prototype._setDisplay.call(this,K$c)},K$c.hitTestPoint=function(K$c,K$P){var K$q=this.globalToLocal(K$Q.TEMP.setTo(K$c,K$P));return K$c=K$q.x,K$P=K$q.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?K$d.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(K$c,K$P)},K$c.getMousePoint=function(){return this.globalToLocal(K$Q.TEMP.setTo(K$H.stage.mouseX,K$H.stage.mouseY))},K$c._getWords=function(){return null},K$c._addChildsToLayout=function(K$c){var K$P=this._getWords();if(null==K$P&&0==this._childs.length)return!1;if(K$P)for(var K$q=0,K$_=K$P.length;K$q<K$_;K$q++)K$c.push(K$P[K$q]);K$q=0;for(var K$E=this._childs.length;K$q<K$E;++K$q){var K$b=this._childs[K$q];K$b._style._enableLayout()&&K$b._addToLayout(K$c)}return!0},K$c._addToLayout=function(K$c){this._style.absolute||(this._style.block?K$c.push(this):this._addChildsToLayout(K$c)&&(this.x=this.y=0))},K$c._isChar=function(){return!1},K$c._getCSSStyle=function(){return this._style.getCSSStyle()},K$c._setAttributes=function(K$c,K$P){switch(K$c){case"x":this.x=parseFloat(K$P);break;case"y":this.y=parseFloat(K$P);break;case"width":this.width=parseFloat(K$P);break;case"height":this.height=parseFloat(K$P);break;default:this[K$c]=K$P}},K$c._layoutLater=function(){this.parent&&this.parent._layoutLater()},K$g(0,K$c,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(K$c){this._optimizeScrollRect!=K$c&&(this._optimizeScrollRect=K$c,this.conchModel&&this.conchModel.optimizeScrollRect(K$c))}),K$g(0,K$c,"customRenderEnable",null,function(K$c){if(K$c&&(this._renderType|=1024,K$C.isConchNode)){K$q.CustomList.push(this);var K$P=new K$mc("2d");K$P._setContext(new CanvasRenderingContext2D),this.customContext=new K$F(0,0,K$P),K$P.context.setCanvasType&&K$P.context.setCanvasType(2),this.conchModel.custom(K$P.context)}}),K$g(0,K$c,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(K$c){this.cacheAs=K$c?this._$P.hasFilter?"none":"normal":"none"}),K$g(0,K$c,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(K$c){var K$P=this._$P.cacheCanvas;if(K$c!==(K$P?K$P.type:"none")){if("none"!==K$c)this._getBit(1)||this._setUpNoticeType(1),K$P||(K$P=this._set$P("cacheCanvas",K$f.getItemByClass("cacheCanvas",Object))),K$P.type=K$c,K$P.reCache=!0,this._renderType|=16,"bitmap"==K$c&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(K$P){var K$q=K$P;K$q&&K$q.ctx&&(K$f.recover("RenderContext",K$q.ctx),K$q.ctx.canvas.size(0,0),K$q.ctx=null),K$f.recover("cacheCanvas",K$P)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),K$g(0,K$c,"zOrder",function(){return this._zOrder},function(K$c){this._zOrder!=K$c&&(this._zOrder=K$c,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(K$c),this._parent&&(K$c&&this._parent._set$P("hasZorder",!0),K$H.timer.callLater(this._parent,this.updateZOrder)))}),K$g(0,K$c,"rotation",function(){return this._style._tf.rotate},function(K$c){var K$P=this.getStyle();if(K$P._tf.rotate!==K$c){K$P.setRotate(K$c),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(K$c),this._renderType|=4;var K$q=this._parent;K$q&&0===K$q._repaint&&(K$q._repaint=1,K$q.parentRepaint())}}),K$g(0,K$c,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(K$c){this._width!==K$c&&(this._width=K$c,this.conchModel&&this.conchModel.size(K$c,this._height),this.repaint())}),K$g(0,K$c,"x",function(){return this._x},function(K$c){if(this._x!==K$c){if(this.destroyed)return;this._x=K$c,this.conchModel&&this.conchModel.pos(K$c,this._y);var K$P=this._parent;K$P&&0===K$P._repaint&&(K$P._repaint=1,K$P.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),K$g(0,K$c,"globalScaleY",function(){for(var K$c=1,K$P=this;K$P&&K$P!==K$H.stage;)K$c*=K$P.scaleY,K$P=K$P.parent;return K$c}),K$g(0,K$c,"hitArea",function(){return this._$P.hitArea},function(K$c){this._set$P("hitArea",K$c)}),K$g(0,K$c,"staticCache",function(){return this._$P.staticCache},function(K$c){this._set$P("staticCache",K$c),K$c||this.reCache()}),K$g(0,K$c,"texture",function(){return this._texture},function(K$c){this._texture!=K$c&&(this._texture=K$c,this.graphics.cleanByTexture(K$c,0,0))}),K$g(0,K$c,"y",function(){return this._y},function(K$c){if(this._y!==K$c){if(this.destroyed)return;this._y=K$c,this.conchModel&&this.conchModel.pos(this._x,K$c);var K$P=this._parent;K$P&&0===K$P._repaint&&(K$P._repaint=1,K$P.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),K$g(0,K$c,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(K$c){this._height!==K$c&&(this._height=K$c,this.conchModel&&this.conchModel.size(this._width,K$c),this.repaint())}),K$g(0,K$c,"blendMode",function(){return this._style.blendMode},function(K$c){this.getStyle().blendMode=K$c,this.conchModel&&this.conchModel.blendMode(K$c),K$c&&"source-over"!=K$c?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),K$g(0,K$c,"scaleX",function(){return this._style._tf.scaleX},function(K$c){var K$P=this.getStyle();if(K$P._tf.scaleX!==K$c){K$P.setScaleX(K$c),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(K$c,K$P._tf.scaleY),this._renderType|=4;var K$q=this._parent;K$q&&0===K$q._repaint&&(K$q._repaint=1,K$q.parentRepaint())}}),K$g(0,K$c,"scaleY",function(){return this._style._tf.scaleY},function(K$c){var K$P=this.getStyle();if(K$P._tf.scaleY!==K$c){K$P.setScaleY(K$c),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(K$P._tf.scaleX,K$c),this._renderType|=4;var K$q=this._parent;K$q&&0===K$q._repaint&&(K$q._repaint=1,K$q.parentRepaint())}}),K$g(0,K$c,"stage",function(){return K$H.stage}),K$g(0,K$c,"skewX",function(){return this._style._tf.skewX},function(K$c){var K$P=this.getStyle();if(K$P._tf.skewX!==K$c){K$P.setSkewX(K$c),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(K$c,K$P._tf.skewY),this._renderType|=4;var K$q=this._parent;K$q&&0===K$q._repaint&&(K$q._repaint=1,K$q.parentRepaint())}}),K$g(0,K$c,"scrollRect",function(){return this._style.scrollRect},function(K$c){this.getStyle().scrollRect=K$c,this.repaint(),K$c?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(K$c.x,K$c.y,K$c.width,K$c.height)):(this._renderType&=-129,this.conchModel&&(K$q.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),K$g(0,K$c,"skewY",function(){return this._style._tf.skewY},function(K$c){var K$P=this.getStyle();if(K$P._tf.skewY!==K$c){K$P.setSkewY(K$c),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(K$P._tf.skewX,K$c),this._renderType|=4;var K$q=this._parent;K$q&&0===K$q._repaint&&(K$q._repaint=1,K$q.parentRepaint())}}),K$g(0,K$c,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(K$c){this._tfChanged=!1,(this._transform=K$c)&&(this._x=K$c.tx,this._y=K$c.ty,K$c.tx=K$c.ty=0,this.conchModel&&this.conchModel.transform(K$c.a,K$c.b,K$c.c,K$c.d,this._x,this._y)),K$c?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),K$g(0,K$c,"pivotX",function(){return this._style._tf.translateX},function(K$c){this.getStyle().setTranslateX(K$c),this.conchModel&&this.conchModel.pivot(K$c,this._style._tf.translateY),this.repaint()}),K$g(0,K$c,"pivotY",function(){return this._style._tf.translateY},function(K$c){this.getStyle().setTranslateY(K$c),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,K$c),this.repaint()}),K$g(0,K$c,"alpha",function(){return this._style.alpha},function(K$c){this._style&&this._style.alpha!==K$c&&(K$c=K$c<0?0:1<K$c?1:K$c,this.getStyle().alpha=K$c,this.conchModel&&this.conchModel.alpha(K$c),1!==K$c?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),K$g(0,K$c,"visible",function(){return this._style.visible},function(K$c){this._style&&this._style.visible!==K$c&&(this.getStyle().visible=K$c,this.conchModel&&this.conchModel.visible(K$c),this.parentRepaint())}),K$g(0,K$c,"graphics",function(){return this._graphics||(this.graphics=K$j.createGraphics())},function(K$c){this._graphics&&(this._graphics._sp=null),(this._graphics=K$c)?(this._renderType&=-2,this._renderType|=512,(K$c._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(K$q.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),K$g(0,K$c,"filters",function(){return this._$P.filters},function(K$c){K$c&&0===K$c.length&&(K$c=null),this._$P.filters!=K$c&&(this._set$P("filters",K$c?K$c.slice():null),K$C.isConchApp&&(this.conchModel&&(K$q.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),K$C.isWebGL&&(K$c&&K$c.length?this._renderType|=32:this._renderType&=-33),K$c&&0<K$c.length?(this._getBit(1)||this._setUpNoticeType(1),K$C.isWebGL&&1==K$c.length&&K$c[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(K$C.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),K$g(0,K$c,"parent",K$E.prototype._$get_parent,function(K$c){K$H.superSet(K$cc,this,"parent",K$c),K$c&&this._getBit(2)&&this._$2__onDisplay()}),K$g(0,K$c,"mask",function(){return this._$P._mask},function(K$c){K$c&&this.mask&&this.mask._$P.maskParent||(K$c?(this.cacheAs="bitmap",this._set$P("_mask",K$c),K$c._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",K$c),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(K$c?K$c.conchModel:null),this._renderType|=64,this.parentRepaint())}),K$g(0,K$c,"mouseEnabled",function(){return 1<this._mouseEnableState},function(K$c){this._mouseEnableState=K$c?2:1}),K$g(0,K$c,"globalScaleX",function(){for(var K$c=1,K$P=this;K$P&&K$P!==K$H.stage;)K$c*=K$P.scaleX,K$P=K$P.parent;return K$c}),K$g(0,K$c,"mouseX",function(){return this.getMousePoint().x}),K$g(0,K$c,"mouseY",function(){return this.getMousePoint().y}),K$q.fromImage=function(K$c){return(new K$q).loadImage(K$c)},K$q._cachePool=[],K$q.CustomList=[],K$Z(K$q,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=K$e.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),K$q}(K$cc),K$xc=function(K$c){function K$P(K$c){this._audio=null,this._onEnd=null,this._resumePlay=null,K$P.__super.call(this),this._onEnd=K$p.bind(this.__onEnd,this),this._resumePlay=K$p.bind(this.__resumePlay,this),K$c.addEventListener("ended",this._onEnd),this._audio=K$c}K$n(K$P,"laya.media.h5audio.AudioSoundChannel",K$_c);var K$q=K$P.prototype;return K$q.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(K$H.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},K$q.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,K$s.container.appendChild(this._audio),this._audio.play()}catch(K$c){this.event("error")}},K$q.play=function(K$c){this.isStopped=!1;try{this._audio.playbackRate=K$J.playbackRate,this._audio.currentTime=this.startTime}catch(K$c){return void this._audio.addEventListener("canplay",this._resumePlay)}K$J.addChannel(this),K$s.container.appendChild(this._audio),!K$c&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},K$q.stop=function(){this.isStopped=!0,K$J.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&K$C.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),K$s.onIE||this._audio!=K$qc._musicAudio&&K$f.recover("audio:"+this.url,this._audio),K$s.removeElement(this._audio),this._audio=null)},K$q.pause=function(){this.isStopped=!0,K$J.removeChannel(this),"pause"in this._audio&&this._audio.pause()},K$q.resume=function(){this._audio&&(this.isStopped=!1,K$J.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},K$g(0,K$q,"position",function(){return this._audio?this._audio.currentTime:0}),K$g(0,K$q,"duration",function(){return this._audio?this._audio.duration:0}),K$g(0,K$q,"volume",function(){return this._audio?this._audio.volume:1},function(K$c){this._audio&&(this._audio.volume=K$c)}),K$P}(),K$rc=function(K$c){function K$P(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=K$bc.ctx,K$P.__super.call(this),this._onPlayEnd=K$p.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}K$n(K$P,"laya.media.webaudio.WebAudioSoundChannel",K$_c);var K$q=K$P.prototype;return K$q.play=function(K$c){if(K$J.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var K$P=this.context,K$q=this.gain,K$_=K$P.createBufferSource();(this.bufferSource=K$_).buffer=this.audioBuffer,K$_.connect(K$q),K$q&&K$q.disconnect(),K$q.connect(K$P.destination),K$_.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=K$s.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(K$_.loop=!0),K$_.playbackRate.setTargetAtTime?K$_.playbackRate.setTargetAtTime(K$J.playbackRate,this.context.currentTime,.1):K$_.playbackRate.value=K$J.playbackRate,K$_.start(0,this.startTime),!K$c&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},K$q.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(K$H.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},K$q._clearBufferSource=function(){if(this.bufferSource){var K$c=this.bufferSource;K$c.stop?K$c.stop(0):K$c.noteOff(0),K$c.disconnect(0),K$c.onended=null,K$P._tryCleanFailed||this._tryClearBuffer(K$c),this.bufferSource=null}},K$q._tryClearBuffer=function(K$c){try{K$c.buffer=null}catch(K$c){K$P._tryCleanFailed=!0}},K$q.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,K$J.removeChannel(this),this.startHandler=null,this.completeHandler=null},K$q.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,K$J.removeChannel(this)},K$q.resume=function(){this.startTime=this._pauseTime,this.play(!1)},K$g(0,K$q,"position",function(){return this.bufferSource?(K$s.now()-this._startTime)/1e3+this.startTime:0}),K$g(0,K$q,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),K$g(0,K$q,"volume",function(){return this._volume},function(K$c){this.isStopped||(this._volume=K$c,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(K$c,this.context.currentTime,.1):this.gain.gain.value=K$c)}),K$P._tryCleanFailed=!1,K$P}(),K$gc=function(K$c){function K$P(){K$P.__super.call(this),this._w=0,this._h=0}K$n(K$P,"laya.resource.Bitmap",K$Sc);var K$q=K$P.prototype;return K$g(0,K$q,"width",function(){return this._w}),K$g(0,K$q,"height",function(){return this._h}),K$g(0,K$q,"source",function(){return this._source}),K$P}(),K$Wc=function(K$P){function K$c(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,K$c.__super.call(this),this._interval=K$_.animationInterval,this._setUpNoticeType(1)}K$n(K$c,"laya.display.AnimationPlayerBase",K$P);var K$q=K$c.prototype;return K$q.play=function(K$c,K$P,K$q,K$_){void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=!0),void 0===K$q&&(K$q=""),void 0===K$_&&(K$_=!0),this._isPlaying=!0,this.index="string"==typeof K$c?this._getFrameByLabel(K$c):K$c,this.loop=K$P,this._actionName=K$q,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},K$q._getFrameByLabel=function(K$c){var K$P=0;for(K$P=0;K$P<this._count;K$P++)if(this._labels[K$P]&&0<=this._labels[K$P].indexOf(K$c))return K$P;return 0},K$q._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},K$q._setControlNode=function(K$c){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=K$c)&&K$c!=this&&(K$c.on("display",this,this._checkResumePlaying),K$c.on("undisplay",this,this._checkResumePlaying))},K$q._setDisplay=function(K$c){K$P.prototype._setDisplay.call(this,K$c),this._checkResumePlaying()},K$q._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},K$q.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},K$q.addLabel=function(K$c,K$P){this._labels||(this._labels={}),this._labels[K$P]||(this._labels[K$P]=[]),this._labels[K$P].push(K$c)},K$q.removeLabel=function(K$c){if(K$c){if(this._labels)for(var K$P in this._labels)this._removeLabelFromLabelList(this._labels[K$P],K$c)}else this._labels=null},K$q._removeLabelFromLabelList=function(K$c,K$P){if(K$c)for(var K$q=K$c.length-1;0<=K$q;K$q--)K$c[K$q]==K$P&&K$c.splice(K$q,1)},K$q.gotoAndStop=function(K$c){this.index="string"==typeof K$c?this._getFrameByLabel(K$c):K$c,this.stop()},K$q._displayToIndex=function(K$c){},K$q.clear=function(){this.stop(),this._labels=null},K$g(0,K$q,"interval",function(){return this._interval},function(K$c){this._interval!=K$c&&(this._frameRateChanged=!0,this._interval=K$c,this._isPlaying&&0<K$c&&this.timerLoop(K$c,this,this._frameLoop,null,!0,!0))}),K$g(0,K$q,"isPlaying",function(){return this._isPlaying}),K$g(0,K$q,"index",function(){return this._index},function(K$c){if(this._index=K$c,this._displayToIndex(K$c),this._labels&&this._labels[K$c])for(var K$P=this._labels[K$c],K$q=0,K$_=K$P.length;K$q<K$_;K$q++)this.event("label",K$P[K$q])}),K$g(0,K$q,"count",function(){return this._count}),K$c.WRAP_POSITIVE=0,K$c.WRAP_REVERSE=1,K$c.WRAP_PINGPONG=2,K$c}(K$kc),K$wc=function(K$P){function K$r(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,K$r.__super.call(this),this.overflow=K$r.VISIBLE,this._style=new K$Pc(this),this._style.wordWrap=!1}K$n(K$r,"laya.display.Text",K$P);var K$c=K$r.prototype;return K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,K$c),this._lines=null,this._words&&(this._words.length=0,this._words=null)},K$c._getBoundPointsM=function(K$c){void 0===K$c&&(K$c=!1);var K$P=K$d.TEMP;return K$P.setTo(0,0,this.width,this.height),K$P._getBoundPoints()},K$c.getGraphicBounds=function(K$c){void 0===K$c&&(K$c=!1);var K$P=K$d.TEMP;return K$P.setTo(0,0,this.width,this.height),K$P},K$c._getCSSStyle=function(){return this._style},K$c.lang=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n){if(K$c=K$r.langPacks&&K$r.langPacks[K$c]?K$r.langPacks[K$c]:K$c,arguments.length<2)this._text=K$c;else{for(var K$k=0,K$x=arguments.length;K$k<K$x;K$k++)K$c=K$c.replace("{"+K$k+"}",arguments[K$k+1]);this._text=K$c}},K$c._isPassWordMode=function(){var K$c=this._style.password;return"prompt"in this&&this.prompt==this._text&&(K$c=!1),K$c},K$c._getPassWordTxt=function(K$c){var K$P;K$P="";for(var K$q=K$c.length;0<K$q;K$q--)K$P+="●";return K$P},K$c.renderText=function(K$c,K$P){var K$q=this.graphics;K$q.clear(!0);var K$_=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(K$s.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);K$s.context.font=K$_;var K$E=this.padding,K$b=K$E[3],K$e="left",K$h=this._lines,K$Z=this.leading+this._charSize.height,K$S=this._currBitmapFont;K$S&&(K$Z=this.leading+K$S.getMaxHeight());var K$n=K$E[0];if(!K$S&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(K$e="right",K$b=this._width-K$E[1]):"center"==this.align&&(K$e="center",K$b=.5*this._width+K$E[3]-K$E[1])),0<this._height){var K$k=this._textHeight>this._height?"top":this.valign;"middle"===K$k?K$n=.5*(this._height-K$P*K$Z)+K$E[0]-K$E[2]:"bottom"===K$k&&(K$n=this._height-K$P*K$Z-K$E[2])}var K$x=this._style;if(K$S&&K$S.autoScaleSize)var K$r=K$S.fontSize/this.fontSize;if(this._clipPoint)if(K$q.save(),K$S&&K$S.autoScaleSize){var K$g=0,K$W=0;K$g=this._width?this._width-K$E[3]-K$E[1]:this._textWidth,K$W=this._height?this._height-K$E[0]-K$E[2]:this._textHeight,K$g*=K$r,K$W*=K$r,K$q.clipRect(K$E[3],K$E[0],K$g,K$W)}else K$q.clipRect(K$E[3],K$E[0],this._width?this._width-K$E[3]-K$E[1]:this._textWidth,this._height?this._height-K$E[0]-K$E[2]:this._textHeight);var K$w=K$x.password;"prompt"in this&&this.prompt==this._text&&(K$w=!1);for(var K$O=0,K$N=0,K$m=Math.min(this._lines.length,K$P+K$c)||1,K$T=K$c;K$T<K$m;K$T++){var K$D,K$L=K$h[K$T];if(K$w){var K$H=K$L.length;K$L="";for(var K$Q=K$H;0<K$Q;K$Q--)K$L+="●"}if(K$O=K$b-(this._clipPoint?this._clipPoint.x:0),K$N=K$n+K$Z*K$T-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(K$e,K$O,K$N,K$T),K$S){var K$d=this.width;K$S.autoScaleSize&&(K$d=this.width*K$r),K$S.drawText(K$L,this,K$O,K$N,this.align,K$d)}else K$C.isWebGL?(this._words||(this._words=[]),(K$D=this._words.length>K$T-K$c?this._words[K$T-K$c]:new K$G).setText(K$L)):K$D=K$L,K$x.stroke?K$q.fillBorderText(K$D,K$O,K$N,K$_,this.color,K$x.strokeColor,K$x.stroke,K$e):K$q.fillText(K$D,K$O,K$N,K$_,this.color,K$e)}if(K$S&&K$S.autoScaleSize){var K$u=1/K$r;this.scale(K$u,K$u)}this._clipPoint&&K$q.restore(),this._startX=K$b,this._startY=K$n},K$c.drawUnderline=function(K$c,K$P,K$q,K$_){var K$E=this._lineWidths[K$_];switch(K$c){case"center":K$P-=K$E/2;break;case"right":K$P-=K$E}K$q+=this._charSize.height,this._graphics.drawLine(K$P,K$q,K$P+K$E,K$q,this.underlineColor||this.color,1)},K$c.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);K$s.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new K$Q(0,0)):this._clipPoint=null;var K$c=this._lines.length;if(this.overflow!=K$r.VISIBLE){var K$P=this.overflow==K$r.HIDDEN?Math.floor:Math.ceil;K$c=Math.min(K$c,K$P((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var K$q=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(K$q,K$c),this.repaint()},K$c.evalTextSize=function(){var K$c,K$P=NaN;K$c=Math.max.apply(this,this._lineWidths),K$P=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],K$c==this._textWidth&&K$P==this._textHeight||(this._textWidth=K$c,this._textHeight=K$P,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},K$c.checkEnabledViewportOrNot=function(){return this.overflow==K$r.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},K$c.changeText=function(K$c){this._text!==K$c&&(this.lang(K$c+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},K$c.parseLines=function(K$c){var K$P=this.wordWrap||this.overflow==K$r.HIDDEN;if(K$P)var K$q=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var K$_=K$p.contextMeasureText(K$r._testWord);K$C.isConchApp&&0===K$_.width&&0===K$_.height&&(K$_=K$p.contextMeasureText("W")),this._charSize.width=K$_.width,this._charSize.height=K$_.height||this.fontSize}for(var K$E=K$c.replace(/\r\n/g,"\n").split("\n"),K$b=0,K$e=K$E.length;K$b<K$e;K$b++){var K$h=K$E[K$b];K$P?this.parseLine(K$h,K$q):(this._lineWidths.push(this.getTextWidth(K$h)),this._lines.push(K$h))}},K$c.parseLine=function(K$c,K$P){K$s.context;var K$q,K$_=this._lines,K$E=0,K$b=NaN,K$e=NaN,K$h=0;if((K$b=this.getTextWidth(K$c))<=K$P)return K$_.push(K$c),void this._lineWidths.push(K$b);K$b=this._charSize.width,0==(K$E=Math.floor(K$P/K$b))&&(K$E=1),K$e=K$b=this.getTextWidth(K$c.substring(0,K$E));for(var K$Z=K$E,K$S=K$c.length;K$Z<K$S;K$Z++)if(K$P<(K$e+=K$b=this.getTextWidth(K$c.charAt(K$Z))))if(this.wordWrap){var K$n=K$c.substring(K$h,K$Z);if(K$n.charCodeAt(K$n.length-1)<255?(K$q=/(?:\w|-)+$/.exec(K$n))&&(K$Z=K$q.index+K$h,0==K$q.index?K$Z+=K$n.length:K$n=K$c.substring(K$h,K$Z)):K$r.RightToLeft&&(K$q=/([\u0600-\u06FF])+$/.exec(K$n))&&(K$Z=K$q.index+K$h,0==K$q.index?K$Z+=K$n.length:K$n=K$c.substring(K$h,K$Z)),K$_.push(K$n),this._lineWidths.push(K$e-K$b),!((K$h=K$Z)+K$E<K$S)){K$_.push(K$c.substring(K$h,K$S)),this._lineWidths.push(this.getTextWidth(K$_[K$_.length-1])),K$h=-1;break}K$Z+=K$E,K$e=K$b=this.getTextWidth(K$c.substring(K$h,K$Z)),K$Z--}else if(this.overflow==K$r.HIDDEN)return K$_.push(K$c.substring(0,K$Z)),void this._lineWidths.push(this.getTextWidth(K$_[K$_.length-1]));this.wordWrap&&-1!=K$h&&(K$_.push(K$c.substring(K$h,K$S)),this._lineWidths.push(this.getTextWidth(K$_[K$_.length-1])))},K$c.getTextWidth=function(K$c){return this._currBitmapFont?this._currBitmapFont.getTextWidth(K$c):K$p.contextMeasureText(K$c).width},K$c.getWordWrapWidth=function(){var K$c=this.padding,K$P=NaN;return(K$P=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(K$P=this.wordWrap?100:K$s.width),K$P<=0&&(K$P=100),K$P-K$c[3]-K$c[1]},K$c.getCharPoint=function(K$c,K$P){this._isChanged&&K$H.timer.runCallLater(this,this.typeset);for(var K$q=0,K$_=this._lines,K$E=0,K$b=0,K$e=K$_.length;K$b<K$e;K$b++){if(K$c<(K$q+=K$_[K$b].length)){var K$h=K$b;break}K$E=K$q}var K$Z=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;K$s.context.font=K$Z;var K$S=this.getTextWidth(this._text.substring(K$E,K$c));return(K$P||new K$Q).setTo(this._startX+K$S-(this._clipPoint?this._clipPoint.x:0),this._startY+K$h*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},K$g(0,K$c,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(K$c){K$c!=this._width&&(K$H.superSet(K$kc,this,"width",K$c),this.isChanged=!0)}),K$g(0,K$c,"textWidth",function(){return this._isChanged&&K$H.timer.runCallLater(this,this.typeset),this._textWidth}),K$g(0,K$c,"height",function(){return this._height?this._height:this.textHeight},function(K$c){K$c!=this._height&&(K$H.superSet(K$kc,this,"height",K$c),this.isChanged=!0)}),K$g(0,K$c,"textHeight",function(){return this._isChanged&&K$H.timer.runCallLater(this,this.typeset),this._textHeight}),K$g(0,K$c,"padding",function(){return this._getCSSStyle().padding},function(K$c){this._getCSSStyle().padding=K$c,this.isChanged=!0}),K$g(0,K$c,"bold",function(){return this._getCSSStyle().bold},function(K$c){this._getCSSStyle().bold=K$c,this.isChanged=!0}),K$g(0,K$c,"text",function(){return this._text||""},function(K$c){this._text!==K$c&&(this.lang(K$c+""),this.isChanged=!0,this.event("change"))}),K$g(0,K$c,"color",function(){return this._getCSSStyle().color},function(K$c){this._getCSSStyle().color!=K$c&&(this._getCSSStyle().color=K$c,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),K$g(0,K$c,"font",function(){return this._getCSSStyle().fontFamily},function(K$c){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),K$r._bitmapFonts&&K$r._bitmapFonts[K$c]&&(this._currBitmapFont=K$r._bitmapFonts[K$c]),this._getCSSStyle().fontFamily=K$c,this.isChanged=!0}),K$g(0,K$c,"fontSize",function(){return this._getCSSStyle().fontSize},function(K$c){this._getCSSStyle().fontSize=K$c,this.isChanged=!0}),K$g(0,K$c,"italic",function(){return this._getCSSStyle().italic},function(K$c){this._getCSSStyle().italic=K$c,this.isChanged=!0}),K$g(0,K$c,"align",function(){return this._getCSSStyle().align},function(K$c){this._getCSSStyle().align=K$c,this.isChanged=!0}),K$g(0,K$c,"valign",function(){return this._getCSSStyle().valign},function(K$c){this._getCSSStyle().valign=K$c,this.isChanged=!0}),K$g(0,K$c,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(K$c){this._getCSSStyle().wordWrap=K$c,this.isChanged=!0}),K$g(0,K$c,"leading",function(){return this._getCSSStyle().leading},function(K$c){this._getCSSStyle().leading=K$c,this.isChanged=!0}),K$g(0,K$c,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(K$c){this._getCSSStyle().backgroundColor=K$c,this.isChanged=!0}),K$g(0,K$c,"borderColor",function(){return this._getCSSStyle().borderColor},function(K$c){this._getCSSStyle().borderColor=K$c,this.isChanged=!0}),K$g(0,K$c,"stroke",function(){return this._getCSSStyle().stroke},function(K$c){this._getCSSStyle().stroke=K$c,this.isChanged=!0}),K$g(0,K$c,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(K$c){this._getCSSStyle().strokeColor=K$c,this.isChanged=!0}),K$g(0,K$c,"isChanged",null,function(K$c){this._isChanged!==K$c&&(this._isChanged=K$c)&&K$H.timer.callLater(this,this.typeset)}),K$g(0,K$c,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(K$c){if(!(this.overflow!=K$r.SCROLL||this.textWidth<this._width)&&this._clipPoint){K$c=K$c<this.padding[3]?this.padding[3]:K$c;var K$P=this._textWidth-this._width;K$c=K$P<K$c?K$P:K$c;var K$q=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=K$c,this.renderText(this._lastVisibleLineIndex,K$q)}}),K$g(0,K$c,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(K$c){if(!(this.overflow!=K$r.SCROLL||this.textHeight<this._height)&&this._clipPoint){K$c=K$c<this.padding[0]?this.padding[0]:K$c;var K$P=this._textHeight-this._height,K$q=(K$c=K$P<K$c?K$P:K$c)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=K$q;var K$_=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=K$c,this.renderText(K$q,K$_)}}),K$g(0,K$c,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),K$g(0,K$c,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),K$g(0,K$c,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),K$g(0,K$c,"underlineColor",function(){return this._underlineColor},function(K$c){this._underlineColor=K$c,this._isChanged=!0,this.typeset()}),K$r.registerBitmapFont=function(K$c,K$P){K$r._bitmapFonts||(K$r._bitmapFonts={}),K$r._bitmapFonts[K$c]=K$P},K$r.unregisterBitmapFont=function(K$c,K$P){if(void 0===K$P&&(K$P=!0),K$r._bitmapFonts&&K$r._bitmapFonts[K$c]){var K$q=K$r._bitmapFonts[K$c];K$P&&K$q.destroy(),delete K$r._bitmapFonts[K$c]}},K$r.setTextRightToLeft=function(){var K$c;(K$c=K$s.canvas.source.style).display="none",K$c.position="absolute",K$c.direction="rtl",K$C._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,K$s.document.body.appendChild(K$s.canvas.source)},K$r.supportFont=function(K$c){K$s.context.font="10px sans-serif";var K$P=K$p.contextMeasureText("abcji").width;K$s.context.font="10px "+K$c;var K$q=K$p.contextMeasureText("abcji").width;return console.log(K$P,K$q),K$P!==K$q},K$r._testWord="游",K$r.langPacks=null,K$r.VISIBLE="visible",K$r.SCROLL="scroll",K$r.HIDDEN="hidden",K$r.CharacterCache=!0,K$r.RightToLeft=!1,K$r._bitmapFonts=null,K$Z(K$r,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),K$r}(K$kc),K$Oc=function(K$k){function K$e(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",K$e.__super.call(this),this.offset=new K$Q,this._canvasTransform=new K$V,this._previousOrientation=K$s.window.orientation;var K$P=this;this.transform=K$V.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var K$c=K$s.window,K$q=this;K$c.addEventListener("focus",function(){K$P._isFocused=!0,K$q.event("focus"),K$q.event("focuschange")}),K$c.addEventListener("blur",function(){K$P._isFocused=!1,K$q.event("blur"),K$q.event("focuschange"),K$q._isInputting()&&(K$Dc.inputElement.target.focus=!1)});var K$_="visibilityState",K$E="visibilitychange",K$b=K$c.document;void 0!==K$b.hidden?(K$E="visibilitychange",K$_="visibilityState"):void 0!==K$b.mozHidden?(K$E="mozvisibilitychange",K$_="mozVisibilityState"):void 0!==K$b.msHidden?(K$E="msvisibilitychange",K$_="msVisibilityState"):void 0!==K$b.webkitHidden&&(K$E="webkitvisibilitychange",K$_="webkitVisibilityState"),K$c.document.addEventListener(K$E,function(){"hidden"==K$s.document[K$_]?K$q._setStageVisible(!1):K$q._setStageVisible(!0)}),K$c.document.addEventListener("qbrowserVisibilityChange",function(K$c){K$q._setStageVisible(!K$c.hidden)}),K$c.addEventListener("resize",function(){var K$c=K$s.window.orientation;null!=K$c&&K$c!=K$P._previousOrientation&&K$q._isInputting()&&(K$Dc.inputElement.target.focus=!1),K$P._previousOrientation=K$c,K$q._isInputting()||K$q._resetCanvas()}),K$c.addEventListener("orientationchange",function(K$c){K$q._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),K$s.onMobile&&this.on("mousedown",this,this._onmouseMove)}K$n(K$e,"laya.display.Stage",K$k);var K$c=K$e.prototype;return K$c._setStageVisible=function(K$c){this._isVisibility!=K$c&&(this._isVisibility=K$c,this._isVisibility||this._isInputting()&&(K$Dc.inputElement.target.focus=!1),this.event("visibilitychange"))},K$c._isInputting=function(){return K$s.onMobile&&K$Dc.isInputting},K$c._changeCanvasSize=function(){this.setScreenSize(K$s.clientWidth*K$s.pixelRatio,K$s.clientHeight*K$s.pixelRatio)},K$c._resetCanvas=function(){if(this.screenAdaptationEnabled){var K$c=K$C._mainCanvas;K$c.source.style;K$c.size(1,1),K$H.timer.once(100,this,this._changeCanvasSize)}},K$c.setScreenSize=function(K$c,K$P){var K$q=!1;if("none"!==this._screenMode&&(K$q=(K$c/K$P<1?"vertical":"horizontal")!==this._screenMode)){var K$_=K$P;K$P=K$c,K$c=K$_}this.canvasRotation=K$q;var K$E=K$C._mainCanvas,K$b=K$E.source.style,K$e=this._canvasTransform.identity(),K$h=this._scaleMode,K$Z=K$c/this.designWidth,K$S=K$P/this.designHeight,K$n=this.designWidth,K$k=this.designHeight,K$x=K$c,K$r=K$P,K$g=K$s.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,K$h){case"noscale":K$Z=K$S=1,K$x=this.designWidth,K$r=this.designHeight;break;case"showall":K$Z=K$S=Math.min(K$Z,K$S),K$n=K$x=Math.round(this.designWidth*K$Z),K$k=K$r=Math.round(this.designHeight*K$S);break;case"noborder":K$Z=K$S=Math.max(K$Z,K$S),K$x=Math.round(this.designWidth*K$Z),K$r=Math.round(this.designHeight*K$S);break;case"full":K$Z=K$S=1,this._width=K$n=K$c,this._height=K$k=K$P;break;case"fixedwidth":K$S=K$Z,this._height=K$k=Math.round(K$P/K$Z);break;case"fixedheight":K$Z=K$S,this._width=K$n=Math.round(K$c/K$S);break;case"fixedauto":K$c/K$P<this.designWidth/this.designHeight?(K$S=K$Z,this._height=K$k=Math.round(K$P/K$Z)):(K$Z=K$S,this._width=K$n=Math.round(K$c/K$S))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,K$n=K$n+1&2147483646,K$k=K$k+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),K$Z*=this.scaleX,K$S*=this.scaleY,1===K$Z&&1===K$S?this.transform.identity():(this.transform.a=this._formatData(K$Z/(K$x/K$n)),this.transform.d=this._formatData(K$S/(K$r/K$k)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),K$E.size(K$n,K$k),K$j.changeWebGLSize(K$n,K$k),K$e.scale(K$x/K$n/K$g,K$r/K$k/K$g),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(K$c-K$x)/K$g:this.offset.x=.5*(K$c-K$x)/K$g,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(K$P-K$r)/K$g:this.offset.y=.5*(K$P-K$r)/K$g,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),K$e.translate(this.offset.x,this.offset.y),this.canvasDegree=0,K$q&&("horizontal"===this._screenMode?(K$e.rotate(Math.PI/2),K$e.translate(K$P/K$g,0),this.canvasDegree=90):(K$e.rotate(-Math.PI/2),K$e.translate(0,K$c/K$g),this.canvasDegree=-90)),K$e.a=this._formatData(K$e.a),K$e.d=this._formatData(K$e.d),K$e.tx=this._formatData(K$e.tx),K$e.ty=this._formatData(K$e.ty),K$b.transformOrigin=K$b.webkitTransformOrigin=K$b.msTransformOrigin=K$b.mozTransformOrigin=K$b.oTransformOrigin="0px 0px 0px",K$b.transform=K$b.webkitTransform=K$b.msTransform=K$b.mozTransform=K$b.oTransform="matrix("+K$e.toString()+")",K$e.translate(parseInt(K$b.left)||0,parseInt(K$b.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},K$c._formatData=function(K$c){return Math.abs(K$c)<1e-6?0:Math.abs(1-K$c)<.001?0<K$c?1:-1:K$c},K$c.getMousePoint=function(){return K$Q.TEMP.setTo(this.mouseX,this.mouseY)},K$c.repaint=function(){this._repaint=1},K$c.parentRepaint=function(){},K$c._loop=function(){return this.render(K$C.context,0,0),!0},K$c._onmouseMove=function(K$c){this._mouseMoveTime=K$s.now()},K$c.getTimeFromFrameStart=function(){return K$s.now()-this._frameStartTime},K$c.render=function(K$c,K$P,K$q){if("sleep"===this._frameRate&&!K$C.isConchApp){var K$_=K$s.now();if(!(1e3<=K$_-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(K$l.loopCount++,K$W.instance.runEvent(),K$H.timer._update()));this._frameStartTime=K$_}if(this._renderCount++,K$C.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=K$s.now();var K$E="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),K$b=this._renderCount%2==0;if(K$l.renderSlow=!K$E,K$E||K$b||K$C.isConchApp){var K$e;K$l.loopCount++,K$W.instance.runEvent(),K$H.timer._update(),K$j.update3DLoop();var K$h=0,K$Z=0;if(K$C.isConchNode)for(K$h=0,K$Z=this._scenes.length;K$h<K$Z;K$h++)(K$e=this._scenes[K$h])&&K$e._updateSceneConch();else for(K$h=0,K$Z=this._scenes.length;K$h<K$Z;K$h++)(K$e=this._scenes[K$h])&&K$e._updateScene();if(K$C.isConchNode){var K$S=K$kc.CustomList;for(K$h=0,K$Z=K$S.length;K$h<K$Z;K$h++){var K$n=K$S[K$h];K$n.customRender(K$n.customContext,0,0)}return}}K$C.isConchNode||this.renderingEnabled&&(K$E||!K$b||K$C.isConchWebGL)&&(K$C.isWebGL?K$C.WebGL.mainContext&&!K$C.WebGL.mainContext.isContextLost()&&(K$c.clear(),K$k.prototype.render.call(this,K$c,K$P,K$q),K$l._show&&K$l._sp&&K$l._sp.render(K$c,K$P,K$q),K$j.clear(this._bgColor),K$j.beginFlush(),K$c.flush(),K$j.endFinish(),K$i.instance&&K$i.getInstance().endDispose()):(K$j.clear(this._bgColor),K$k.prototype.render.call(this,K$c,K$P,K$q),K$l._show&&K$l._sp&&K$l._sp.render(K$c,K$P,K$q)))}else this._renderCount%5==0&&(K$l.loopCount++,K$W.instance.runEvent(),K$H.timer._update())},K$c._requestFullscreen=function(){var K$c=K$s.document.documentElement;K$c.requestFullscreen?K$c.requestFullscreen():K$c.mozRequestFullScreen?K$c.mozRequestFullScreen():K$c.webkitRequestFullscreen?K$c.webkitRequestFullscreen():K$c.msRequestFullscreen&&K$c.msRequestFullscreen()},K$c._fullScreenChanged=function(){K$H.stage.event("fullscreenchange")},K$c.exitFullscreen=function(){var K$c=K$s.document;K$c.exitFullscreen?K$c.exitFullscreen():K$c.mozCancelFullScreen?K$c.mozCancelFullScreen():K$c.webkitExitFullscreen&&K$c.webkitExitFullscreen()},K$g(0,K$c,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),K$g(0,K$c,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),K$g(0,K$c,"frameRate",function(){return this._frameRate},function(K$c){if(this._frameRate=K$c,K$C.isConchApp)switch(this._frameRate){case"slow":K$s.window.conch&&K$s.window.conchConfig.setSlowFrame&&K$s.window.conchConfig.setSlowFrame(!0);break;case"fast":K$s.window.conch&&K$s.window.conchConfig.setSlowFrame&&K$s.window.conchConfig.setSlowFrame(!1);break;case"mouse":K$s.window.conch&&K$s.window.conchConfig.setMouseFrame&&K$s.window.conchConfig.setMouseFrame(2e3);break;case"sleep":K$s.window.conch&&K$s.window.conchConfig.setLimitFPS&&K$s.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),K$g(0,K$c,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),K$g(0,K$c,"width",K$k.prototype._$get_width,function(K$c){this.designWidth=K$c,K$H.superSet(K$kc,this,"width",K$c),K$H.timer.callLater(this,this._changeCanvasSize)}),K$g(0,K$c,"alignH",function(){return this._alignH},function(K$c){this._alignH=K$c,K$H.timer.callLater(this,this._changeCanvasSize)}),K$g(0,K$c,"isFocused",function(){return this._isFocused}),K$g(0,K$c,"height",K$k.prototype._$get_height,function(K$c){this.designHeight=K$c,K$H.superSet(K$kc,this,"height",K$c),K$H.timer.callLater(this,this._changeCanvasSize)}),K$g(0,K$c,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||K$V.create()},K$k.prototype._$set_transform),K$g(0,K$c,"isVisibility",function(){return this._isVisibility}),K$g(0,K$c,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),K$g(0,K$c,"scaleMode",function(){return this._scaleMode},function(K$c){this._scaleMode=K$c,K$H.timer.callLater(this,this._changeCanvasSize)}),K$g(0,K$c,"alignV",function(){return this._alignV},function(K$c){this._alignV=K$c,K$H.timer.callLater(this,this._changeCanvasSize)}),K$g(0,K$c,"bgColor",function(){return this._bgColor},function(K$c){this._bgColor=K$c,this.conchModel&&this.conchModel.bgColor(K$c),K$C.isWebGL&&(K$c?K$e._wgColor=K$y.create(K$c)._color:K$s.onMiniGame||(K$e._wgColor=null)),K$s.onLimixiu?K$e._wgColor=K$y.create(K$c)._color:K$C.canvas.style.background=K$c||"none"}),K$g(0,K$c,"mouseX",function(){return Math.round(K$W.instance.mouseX/this.clientScaleX)}),K$g(0,K$c,"mouseY",function(){return Math.round(K$W.instance.mouseY/this.clientScaleY)}),K$g(0,K$c,"screenMode",function(){return this._screenMode},function(K$c){this._screenMode=K$c}),K$g(0,K$c,"visible",K$k.prototype._$get_visible,function(K$c){this.visible!==K$c&&(K$H.superSet(K$kc,this,"visible",K$c),K$C._mainCanvas.source.style.visibility=K$c?"visible":"hidden")}),K$g(0,K$c,"fullScreenEnabled",null,function(K$c){var K$P=K$s.document,K$q=K$C.canvas;K$c?(K$q.addEventListener("mousedown",this._requestFullscreen),K$q.addEventListener("touchstart",this._requestFullscreen),K$P.addEventListener("fullscreenchange",this._fullScreenChanged),K$P.addEventListener("mozfullscreenchange",this._fullScreenChanged),K$P.addEventListener("webkitfullscreenchange",this._fullScreenChanged),K$P.addEventListener("msfullscreenchange",this._fullScreenChanged)):(K$q.removeEventListener("mousedown",this._requestFullscreen),K$q.removeEventListener("touchstart",this._requestFullscreen),K$P.removeEventListener("fullscreenchange",this._fullScreenChanged),K$P.removeEventListener("mozfullscreenchange",this._fullScreenChanged),K$P.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),K$P.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),K$e.SCALE_NOSCALE="noscale",K$e.SCALE_EXACTFIT="exactfit",K$e.SCALE_SHOWALL="showall",K$e.SCALE_NOBORDER="noborder",K$e.SCALE_FULL="full",K$e.SCALE_FIXED_WIDTH="fixedwidth",K$e.SCALE_FIXED_HEIGHT="fixedheight",K$e.SCALE_FIXED_AUTO="fixedauto",K$e.ALIGN_LEFT="left",K$e.ALIGN_RIGHT="right",K$e.ALIGN_CENTER="center",K$e.ALIGN_TOP="top",K$e.ALIGN_MIDDLE="middle",K$e.ALIGN_BOTTOM="bottom",K$e.SCREEN_NONE="none",K$e.SCREEN_HORIZONTAL="horizontal",K$e.SCREEN_VERTICAL="vertical",K$e.FRAME_FAST="fast",K$e.FRAME_SLOW="slow",K$e.FRAME_MOUSE="mouse",K$e.FRAME_SLEEP="sleep",K$e.FRAME_MOUSE_THREDHOLD=2e3,K$Z(K$e,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),K$e}(K$kc),K$Nc=(function(K$c){function K$P(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,K$P.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}K$n(K$P,"laya.media.SoundNode",K$kc);var K$q=K$P.prototype;K$q._onParentChange=function(){this.target=this.parent},K$q.play=function(K$c,K$P){void 0===K$c&&(K$c=1),isNaN(K$c)&&(K$c=1),this.url&&(this.stop(),this._channel=K$J.playSound(this.url,K$c,null,K$P))},K$q.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},K$q._setPlayAction=function(K$c,K$P,K$q,K$_){void 0===K$_&&(K$_=!0),this[K$q]&&K$c&&(K$_?K$c.on(K$P,this,this[K$q]):K$c.off(K$P,this,this[K$q]))},K$q._setPlayActions=function(K$c,K$P,K$q,K$_){if(void 0===K$_&&(K$_=!0),K$c&&K$P){var K$E,K$b=K$P.split(","),K$e=0;for(K$E=K$b.length,K$e=0;K$e<K$E;K$e++)this._setPlayAction(K$c,K$b[K$e],K$q,K$_)}},K$g(0,K$q,"playEvent",null,function(K$c){(this._playEvents=K$c)&&this._tar&&this._setPlayActions(this._tar,K$c,"play")}),K$g(0,K$q,"target",null,function(K$c){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=K$c,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),K$g(0,K$q,"stopEvent",null,function(K$c){(this._stopEvents=K$c)&&this._tar&&this._setPlayActions(this._tar,K$c,"stop")})}(),function(K$c){function K$P(){this._src=null,this._onload=null,this._onerror=null,K$P.__super.call(this)}K$n(K$P,"laya.resource.FileBitmap",K$gc);var K$q=K$P.prototype;return K$g(0,K$q,"src",function(){return this._src},function(K$c){this._src=K$c}),K$g(0,K$q,"onload",null,function(K$c){}),K$g(0,K$q,"onerror",null,function(K$c){}),K$P}()),K$mc=function(K$c){function K$q(K$c,K$P){this._is2D=!1,K$q.__super.call(this);var K$_=this;if(this._source=this,"2D"===K$c||"AUTO"===K$c&&!K$C.isWebGL){this._is2D=!0,this._source=K$P||K$s.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var K$E=this;K$E.getContext=function(K$c,K$P){if(K$_._ctx)return K$_._ctx;var K$q=K$_._ctx=K$_._source.getContext(K$c,K$P);return K$q&&(K$q._canvas=K$E,K$C.isFlash||K$s.onLimixiu||(K$q.size=function(K$c,K$P){})),K$q}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}K$n(K$q,"laya.resource.HTMLCanvas",K$gc);var K$P=K$q.prototype;return K$P.clear=function(){this._ctx&&this._ctx.clear()},K$P.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},K$P.release=function(){},K$P._setContext=function(K$c){this._ctx=K$c},K$P.getContext=function(K$c,K$P){return this._ctx?this._ctx:this._ctx=K$q._createContext(this)},K$P.getMemSize=function(){return 0},K$P.size=function(K$c,K$P){(this._w!=K$c||this._h!=K$P||this._source&&(this._source.width!=K$c||this._source.height!=K$P))&&(this._w=K$c,this._h=K$P,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(K$c,K$P),this._source&&(this._source.height=K$P,this._source.width=K$c))},K$P.getCanvas=function(){return this._source},K$P.toBase64=function(K$c,K$P,K$q){if(this._source)if(K$C.isConchApp&&this._source.toBase64)this._source.toBase64(K$c,K$P,K$q);else{var K$_=this._source.toDataURL(K$c,K$P);K$q.call(this,K$_)}},K$g(0,K$P,"context",function(){return this._ctx}),K$g(0,K$P,"asBitmap",null,function(K$c){}),K$q.create=function(K$c,K$P){return new K$q(K$c,K$P)},K$q.TYPE2D="2D",K$q.TYPE3D="3D",K$q.TYPEAUTO="AUTO",K$q._createContext=null,K$q}(),K$Tc=(function(K$c){function K$Z(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){throw K$Z.__super.call(this),new Error("不允许new！")}K$n(K$Z,"laya.resource.HTMLSubImage",K$gc),K$Z.create=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){return void 0===K$h&&(K$h=!1),new K$Z(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h)}}(),function(K$c){function K$k(){this._frames=null,this._url=null,K$k.__super.call(this),this._setControlNode(this)}K$n(K$k,"laya.display.Animation",K$c);var K$P=K$k.prototype;K$P.destroy=function(K$c){void 0===K$c&&(K$c=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,K$c),this._frames=null,this._labels=null},K$P.play=function(K$c,K$P,K$q,K$_){void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=!0),void 0===K$q&&(K$q=""),void 0===K$_&&(K$_=!0),K$q&&this._setFramesFromCache(K$q,K$_),this._isPlaying=!0,this.index="string"==typeof K$c?this._getFrameByLabel(K$c):K$c,this.loop=K$P,this._actionName=K$q,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},K$P._setFramesFromCache=function(K$c,K$P){var K$q;return void 0===K$P&&(K$P=!1),this._url&&(K$c=this._url+"#"+K$c),K$c&&K$k.framesMap[K$c]?((K$q=K$k.framesMap[K$c])instanceof Array?(this._frames=K$k.framesMap[K$c],this._count=this._frames.length):(K$q.nodeRoot&&(K$k.framesMap[K$c]=this._parseGraphicAnimationByData(K$q),K$q=K$k.framesMap[K$c]),this._frames=K$q.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=K$q.interval),this._labels=this._copyLabels(K$q.labels)),!0):(K$P&&console.log("ani not found:",K$c),!1)},K$P._copyLabels=function(K$c){if(!K$c)return null;var K$P,K$q;for(K$q in K$P={},K$c)K$P[K$q]=K$p.copyArray([],K$c[K$q]);return K$P},K$P._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&K$c.prototype._frameLoop.call(this)},K$P._displayToIndex=function(K$c){this._frames&&(this.graphics=this._frames[K$c])},K$P.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},K$P.loadImages=function(K$c,K$P){return void 0===K$P&&(K$P=""),this._url="",this._setFramesFromCache(K$P)||(this.frames=K$k.framesMap[K$P]?K$k.framesMap[K$P]:K$k.createFrames(K$c,K$P)),this},K$P.loadAtlas=function(K$P,K$q,K$_){void 0===K$_&&(K$_=""),this._url="";var K$E=this;function K$c(K$c){K$P===K$c&&(K$E.frames=K$k.framesMap[K$_]?K$k.framesMap[K$_]:K$k.createFrames(K$P,K$_),K$q&&K$q.run())}return K$E._setFramesFromCache(K$_)||(K$hc.getAtlas(K$P)?K$c(K$P):K$H.loader.load(K$P,K$N.create(null,K$c,[K$P]),null,"atlas")),this},K$P.loadAnimation=function(K$c,K$P,K$q){this._url=K$c;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,K$P&&K$P.run()):!K$q||K$hc.getAtlas(K$q)?this._loadAnimationData(K$c,K$P,K$q):K$H.loader.load(K$q,K$N.create(this,this._loadAnimationData,[K$c,K$P,K$q]),null,"atlas"),this},K$P._loadAnimationData=function(K$h,K$Z,K$c){var K$S=this;if(!K$c||K$hc.getAtlas(K$c)){var K$n=this;K$hc.getRes(K$h)?K$P(K$h):K$H.loader.load(K$h,K$N.create(null,K$P,[K$h]),null,"json"),K$hc.clearRes(K$h)}else console.warn("atlas load fail:"+K$c);function K$P(K$c){if(K$hc.getRes(K$c)&&K$h===K$c){var K$P;if(K$k.framesMap[K$h+"#"])K$n._setFramesFromCache(K$S._actionName,!0),K$S.index=0,K$S._checkResumePlaying();else{var K$q=K$n._parseGraphicAnimation(K$hc.getRes(K$h));if(!K$q)return;var K$_,K$E=K$q.animationList,K$b=0,K$e=K$E.length;for(K$b=0;K$b<K$e;K$b++)K$P=K$E[K$b],K$k.framesMap[K$h+"#"+K$P.name]=K$P,K$_||(K$_=K$P);K$_&&(K$k.framesMap[K$h+"#"]=K$_,K$n._setFramesFromCache(K$S._actionName,!0),K$S.index=0),K$S._checkResumePlaying()}K$Z&&K$Z.run()}}},K$P._parseGraphicAnimation=function(K$c){return K$Hc.parseAnimationData(K$c)},K$P._parseGraphicAnimationByData=function(K$c){return K$Hc.parseAnimationByData(K$c)},K$g(0,K$P,"frames",function(){return this._frames},function(K$c){(this._frames=K$c)&&(this._count=K$c.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),K$g(0,K$P,"autoPlay",null,function(K$c){K$c?this.play():this.stop()}),K$g(0,K$P,"source",null,function(K$c){-1<K$c.indexOf(".ani")?this.loadAnimation(K$c):-1<K$c.indexOf(".json")||-1<K$c.indexOf("als")||-1<K$c.indexOf("atlas")?this.loadAtlas(K$c):this.loadImages(K$c.split(","))}),K$g(0,K$P,"autoAnimation",null,function(K$c){this.play(0,!0,K$c,!1)}),K$k.createFrames=function(K$c,K$P){var K$q,K$_,K$E=0,K$b=0;if("string"==typeof K$c){var K$e=K$hc.getAtlas(K$c);if(K$e&&K$e.length)for(K$q=[],K$E=0,K$b=K$e.length;K$E<K$b;K$E++)(K$_=new K$j.createGraphics).drawTexture(K$hc.getRes(K$e[K$E]),0,0),K$q.push(K$_)}else if(K$c instanceof Array)for(K$q=[],K$E=0,K$b=K$c.length;K$E<K$b;K$E++)(K$_=new K$j.createGraphics).loadImage(K$c[K$E],0,0),K$q.push(K$_);return K$P&&(K$k.framesMap[K$P]=K$q),K$q},K$k.clearCache=function(K$c){var K$P,K$q=K$k.framesMap,K$_=K$c+"#";for(K$P in K$q)K$P!==K$c&&0!=K$P.indexOf(K$_)||delete K$k.framesMap[K$P]},K$k.framesMap={}}(K$Wc),function(K$c){function K$b(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,K$b.__super.call(this),null==K$b._sortIndexFun&&(K$b._sortIndexFun=K$L.sortByKey("index",!1,!0))}K$n(K$b,"laya.display.FrameAnimation",K$c);var K$P=K$b.prototype;return K$P._setUp=function(K$c,K$P){this._labels=null,this._animationNewFrames=null,this._targetDic=K$c,this._animationData=K$P,this.interval=1e3/K$P.frameRate,K$P.parsed?(this._count=K$P.count,this._labels=K$P.labels,this._animationNewFrames=K$P.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),K$P.parsed=!0,K$P.labels=this._labels,K$P.count=this._count,K$P.animationNewFrames=this._animationNewFrames},K$P.clear=function(){K$c.prototype.clear.call(this),this._targetDic=null,this._animationData=null},K$P._displayToIndex=function(K$c){if(this._animationData){K$c<0&&(K$c=0),K$c>this._count&&(K$c=this._count);var K$P=this._animationData.nodes,K$q=0,K$_=K$P.length;for(K$q=0;K$q<K$_;K$q++)this._displayNodeToFrame(K$P[K$q],K$c)}},K$P._displayNodeToFrame=function(K$c,K$P,K$q){K$q||(K$q=this._targetDic);var K$_=K$q[K$c.target];if(K$_){var K$E,K$b,K$e,K$h=K$c.frames,K$Z=K$c.keys,K$S=0,K$n=K$Z.length;for(K$S=0;K$S<K$n;K$S++)K$e=(K$b=K$h[K$E=K$Z[K$S]]).length>K$P?K$b[K$P]:K$b[K$b.length-1],K$_[K$E]=K$e}},K$P._calculateDatas=function(){if(this._animationData){var K$c,K$P=this._animationData.nodes,K$q=0,K$_=K$P.length;for(K$q=this._count=0;K$q<K$_;K$q++)K$c=K$P[K$q],this._calculateNodeKeyFrames(K$c);this._count+=1}},K$P._calculateNodeKeyFrames=function(K$c){var K$P,K$q,K$_=K$c.keyframes,K$E=K$c.target;for(K$P in K$c.frames||(K$c.frames={}),K$c.keys?K$c.keys.length=0:K$c.keys=[],K$c.initValues||(K$c.initValues={}),K$_)K$q=K$_[K$P],K$c.frames[K$P]||(K$c.frames[K$P]=[]),this._targetDic&&this._targetDic[K$E]&&(K$c.initValues[K$P]=this._targetDic[K$E][K$P]),K$q.sort(K$b._sortIndexFun),K$c.keys.push(K$P),this._calculateNodePropFrames(K$q,K$c.frames[K$P],K$P,K$E)},K$P.resetToInitState=function(){if(this._targetDic&&this._animationData){var K$c,K$P,K$q=this._animationData.nodes,K$_=0,K$E=K$q.length;for(K$_=0;K$_<K$E;K$_++)if(K$P=(K$c=K$q[K$_]).initValues){var K$b,K$e=this._targetDic[K$c.target];if(K$e)for(K$b in K$P)K$e[K$b]=K$P[K$b]}}},K$P._calculateNodePropFrames=function(K$c,K$P,K$q,K$_){var K$E=0,K$b=K$c.length-1;if(0<K$b){for(K$P.length=K$c[K$b].index+1,K$E=0;K$E<K$b;K$E++)this._dealKeyFrame(K$c[K$E]),this._calculateFrameValues(K$c[K$E],K$c[K$E+1],K$P);this._dealKeyFrame(K$c[K$E])}0==K$b&&(K$P[K$c[0].index]=K$c[0].value,this._animationNewFrames&&(this._animationNewFrames[K$c[0].index]=!0))},K$P._dealKeyFrame=function(K$c){K$c.label&&""!=K$c.label&&this.addLabel(K$c.label,K$c.index)},K$P._calculateFrameValues=function(K$c,K$P,K$q){var K$_,K$E=0,K$b=K$c.index,K$e=K$P.index,K$h=K$c.value,K$Z=K$P.value-K$c.value,K$S=K$e-K$b;if(K$e>this._count&&(this._count=K$e),K$c.tween)for(null==(K$_=K$z[K$c.tweenMethod])&&(K$_=K$z.linearNone),K$E=K$b;K$E<K$e;K$E++)K$q[K$E]=K$_(K$E-K$b,K$h,K$Z,K$S),this._animationNewFrames&&(this._animationNewFrames[K$E]=!0);else for(K$E=K$b;K$E<K$e;K$E++)K$q[K$E]=K$h;this._animationNewFrames&&(this._animationNewFrames[K$c.index]=!0,this._animationNewFrames[K$P.index]=!0),K$q[K$P.index]=K$P.value},K$b._sortIndexFun=null,K$b}(K$Wc)),K$Dc=function(K$P){function K$E(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",K$E.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=K$wc.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}K$n(K$E,"laya.display.Input",K$P);var K$c=K$E.prototype;return K$c.setSelection=function(K$c,K$P){this.focus=!0,laya.display.Input.inputElement.selectionStart=K$c,laya.display.Input.inputElement.selectionEnd=K$P},K$c._onUnDisplay=function(K$c){this.focus=!1},K$c._onMouseDown=function(K$c){this.focus=!0},K$c._syncInputTransform=function(){var K$c=this.nativeInput,K$P=K$p.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),K$q=this._width-this.padding[1]-this.padding[3],K$_=this._height-this.padding[0]-this.padding[2];K$C.isConchApp?(K$c.setScale(K$P.scaleX,K$P.scaleY),K$c.setSize(K$q,K$_),K$c.setPos(K$P.x,K$P.y)):(K$E.inputContainer.style.transform=K$E.inputContainer.style.webkitTransform="scale("+K$P.scaleX+","+K$P.scaleY+") rotate("+K$H.stage.canvasDegree+"deg)",K$c.style.width=K$q+"px",K$c.style.height=K$_+"px",K$E.inputContainer.style.left=K$P.x+"px",K$E.inputContainer.style.top=K$P.y+"px")},K$c.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},K$c._setInputMethod=function(){K$E.input.parentElement&&K$E.inputContainer.removeChild(K$E.input),K$E.area.parentElement&&K$E.inputContainer.removeChild(K$E.area),K$E.inputElement=this._multiline?K$E.area:K$E.input,K$E.inputContainer.appendChild(K$E.inputElement),K$wc.RightToLeft&&(K$E.inputElement.style.direction="rtl")},K$c._focusIn=function(){laya.display.Input.isInputting=!0;var K$c=this.nativeInput;this._focus=!0;var K$P=K$c.style;K$P.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),K$c.readOnly=!this._editable,K$C.isConchApp&&(K$c.setType(this._type),K$c.setForbidEdit(!this._editable)),K$c.maxLength=this._maxChars;this.padding;if(K$c.type=this._type,K$c.value=this._content,K$c.placeholder=this._prompt,K$H.stage.off("keydown",this,this._onKeyDown),K$H.stage.on("keydown",this,this._onKeyDown),(K$H.stage.focus=this).event("focus"),K$s.onPC&&K$c.focus(),!K$s.onMiniGame){this._text;this._text=null}this.typeset(),K$c.setColor(this._originColor),K$c.setFontSize(this.fontSize),K$c.setFontFace(K$s.onIPhone&&K$wc._fontFamilyMap[this.font]||this.font),K$C.isConchApp&&K$c.setMultiAble&&K$c.setMultiAble(this._multiline),K$P.lineHeight=this.leading+this.fontSize+"px",K$P.fontStyle=this.italic?"italic":"normal",K$P.fontWeight=this.bold?"bold":"normal",K$P.textAlign=this.align,K$P.padding="0 0",this._syncInputTransform(),!K$C.isConchApp&&K$s.onPC&&K$H.timer.frameLoop(1,this,this._syncInputTransform)},K$c._setPromptColor=function(){(K$E.promptStyleDOM=K$s.getElementById("promptStyle"))||((K$E.promptStyleDOM=K$s.createElement("style")).setAttribute("id","promptStyle"),K$s.document.head.appendChild(K$E.promptStyleDOM)),K$E.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},K$c._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(K$H.superSet(K$wc,this,"text",this._content),K$H.superSet(K$wc,this,"color",this._originColor)):(K$H.superSet(K$wc,this,"text",this._prompt),K$H.superSet(K$wc,this,"color",this._promptColor)),K$H.stage.off("keydown",this,this._onKeyDown),K$H.stage.focus=null,this.event("blur"),K$C.isConchApp&&this.nativeInput.blur(),K$s.onPC&&K$H.timer.clear(this,this._syncInputTransform)},K$c._onKeyDown=function(K$c){13===K$c.keyCode&&(K$s.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},K$c.changeText=function(K$c){this._content=K$c,this._focus?(this.nativeInput.value=K$c||"",this.event("change")):K$P.prototype.changeText.call(this,K$c)},K$g(0,K$c,"color",K$P.prototype._$get_color,function(K$c){this._focus&&this.nativeInput.setColor(K$c),K$H.superSet(K$wc,this,"color",this._content?K$c:this._promptColor),this._originColor=K$c}),K$g(0,K$c,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(K$c){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),K$g(0,K$c,"multiline",function(){return this._multiline},function(K$c){this._multiline=K$c,this.valign=K$c?"top":"middle"}),K$g(0,K$c,"maxChars",function(){return this._maxChars},function(K$c){K$c<=0&&(K$c=1e5),this._maxChars=K$c}),K$g(0,K$c,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(K$c){K$H.superSet(K$wc,this,"color",this._originColor),K$c+="",this._focus?(this.nativeInput.value=K$c||"",this.event("change")):(this._multiline||(K$c=K$c.replace(/\r?\n/g,"")),(this._content=K$c)?K$H.superSet(K$wc,this,"text",K$c):(K$H.superSet(K$wc,this,"text",this._prompt),K$H.superSet(K$wc,this,"color",this.promptColor)))}),K$g(0,K$c,"nativeInput",function(){return this._multiline?K$E.area:K$E.input}),K$g(0,K$c,"prompt",function(){return this._prompt},function(K$c){!this._text&&K$c&&K$H.superSet(K$wc,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?K$H.superSet(K$wc,this,"text",this._text==this._prompt?K$c:this._text):K$H.superSet(K$wc,this,"text",K$c),this._prompt=K$wc.langPacks&&K$wc.langPacks[K$c]?K$wc.langPacks[K$c]:K$c}),K$g(0,K$c,"focus",function(){return this._focus},function(K$c){var K$P=this.nativeInput;this._focus!==K$c&&(K$c?(K$P.target?K$P.target._focusOut():this._setInputMethod(),(K$P.target=this)._focusIn()):(K$P.target=null,this._focusOut(),K$s.document.body.scrollTop=0,K$P.blur(),K$C.isConchApp?K$P.setPos(-1e4,-1e4):K$E.inputContainer.contains(K$P)&&K$E.inputContainer.removeChild(K$P)))}),K$g(0,K$c,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(K$c){K$c?(-1<(K$c="[^"+K$c+"]").indexOf("^^")&&(K$c=K$c.replace("^^","")),this._restrictPattern=new RegExp(K$c,"g")):this._restrictPattern=null}),K$g(0,K$c,"editable",function(){return this._editable},function(K$c){this._editable=K$c,K$C.isConchApp&&K$E.input.setForbidEdit(!K$c)}),K$g(0,K$c,"promptColor",function(){return this._promptColor},function(K$c){this._promptColor=K$c,this._content||K$H.superSet(K$wc,this,"color",K$c)}),K$g(0,K$c,"type",function(){return this._type},function(K$c){this._getCSSStyle().password="password"==K$c,this._type=K$c,K$C.isConchApp&&this.nativeInput.setType(K$c)}),K$g(0,K$c,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(K$c){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),K$g(0,K$c,"asPassword",function(){return this._getCSSStyle().password},function(K$c){this._getCSSStyle().password=K$c,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),K$E.__init__=function(){K$E._createInputElement(),K$s.onMobile&&K$C.canvas.addEventListener(K$E.IOS_IFRAME?K$s.onMiniGame?"touchend":"click":"touchend",K$E._popupInputMethod)},K$E._popupInputMethod=function(K$c){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},K$E._createInputElement=function(){K$E._initInput(K$E.area=K$s.createElement("textarea")),K$E._initInput(K$E.input=K$s.createElement("input")),(K$E.inputContainer=K$s.createElement("div")).style.position="absolute",K$E.inputContainer.style.zIndex=1e5,K$s.container.appendChild(K$E.inputContainer),K$E.inputContainer.setPos=function(K$c,K$P){K$E.inputContainer.style.left=K$c+"px",K$E.inputContainer.style.top=K$P+"px"}},K$E._initInput=function(K$P){var K$c=K$P.style;K$c.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",K$c.resize="none",K$c.backgroundColor="transparent",K$c.border="none",K$c.outline="none",K$c.zIndex=1,K$P.addEventListener("input",K$E._processInputting),K$P.addEventListener("mousemove",K$E._stopEvent),K$P.addEventListener("mousedown",K$E._stopEvent),K$P.addEventListener("touchmove",K$E._stopEvent),K$P.setFontFace=function(K$c){K$P.style.fontFamily=K$c},K$C.isConchApp||(K$P.setColor=function(K$c){K$P.style.color=K$c},K$P.setFontSize=function(K$c){K$P.style.fontSize=K$c+"px"})},K$E._processInputting=function(K$c){var K$P=laya.display.Input.inputElement.target;if(K$P){var K$q=laya.display.Input.inputElement.value;K$P._restrictPattern&&(K$q=K$q.replace(/\u2006|\x27/g,""),K$P._restrictPattern.test(K$q)&&(K$q=K$q.replace(K$P._restrictPattern,""),laya.display.Input.inputElement.value=K$q)),K$P._text=K$q,K$P.event("input")}},K$E._stopEvent=function(K$c){"touchmove"==K$c.type&&K$c.preventDefault(),K$c.stopPropagation&&K$c.stopPropagation()},K$E.TYPE_TEXT="text",K$E.TYPE_PASSWORD="password",K$E.TYPE_EMAIL="email",K$E.TYPE_URL="url",K$E.TYPE_NUMBER="number",K$E.TYPE_RANGE="range",K$E.TYPE_DATE="date",K$E.TYPE_MONTH="month",K$E.TYPE_WEEK="week",K$E.TYPE_TIME="time",K$E.TYPE_DATE_TIME="datetime",K$E.TYPE_DATE_TIME_LOCAL="datetime-local",K$E.TYPE_SEARCH="search",K$E.input=null,K$E.area=null,K$E.inputElement=null,K$E.inputContainer=null,K$E.confirmButton=null,K$E.promptStyleDOM=null,K$E.inputHeight=45,K$E.isInputting=!1,K$E.stageMatrix=null,K$Z(K$E,["IOS_IFRAME",function(){return this.IOS_IFRAME=K$s.onIOS&&K$s.window.top!=K$s.window.self}]),K$E}(K$wc),K$Lc=function(K$c){function K$q(K$c,K$P){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,K$q.__super.call(this),K$c&&this._init_(K$c,K$P)}K$n(K$q,"laya.resource.HTMLImage",K$Nc);var K$P=K$q.prototype;return K$P._init_=function(K$c,K$P){this._src=K$c,this._source=new K$s.window.Image,K$P&&(K$P.onload&&(this.onload=K$P.onload),K$P.onerror&&(this.onerror=K$P.onerror),K$P.onCreate&&K$P.onCreate(this)),0!=K$c.indexOf("data:image")&&(this._source.crossOrigin=""),K$c&&(this._source.src=K$c)},K$P.recreateResource=function(){var K$c=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var K$P=this;this._source=new K$s.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(K$P._needReleaseAgain)return K$P._needReleaseAgain=!1,K$P._source.onload=null,void(K$P._source=null);K$P._source.onload=null,K$P.memorySize=K$c._w*K$c._h*4,K$P._recreateLock=!1,K$P.completeCreate()},this._source.src=this._src}},K$P.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},K$P.onresize=function(){this._w=this._source.width,this._h=this._source.height},K$g(0,K$P,"onload",null,function(K$c){var K$P=this;this._onload=K$c,this._source&&(this._source.onload=null!=this._onload?function(){K$P.onresize(),K$P._onload()}:null)}),K$g(0,K$P,"onerror",null,function(K$c){var K$P=this;this._onerror=K$c,this._source&&(this._source.onerror=null!=this._onerror?function(){K$P._onerror()}:null)}),K$g(0,K$P,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(K$c){this._enableMerageInAtlas=K$c,K$C.isConchApp&&this._source&&(this._source.enableMerageInAtlas=K$c)}),K$q.create=function(K$c,K$P){return new K$q(K$c,K$P)},K$q}(),K$Hc=(function(K$b){function K$c(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,K$c.__super.call(this)}K$n(K$c,"laya.display.EffectAnimation",K$b);var K$P=K$c.prototype;K$P._onOtherBegin=function(K$c){K$c!=this&&this.stop()},K$P.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},K$P._onPlayAction=function(){this.play(0,!1)},K$P.play=function(K$c,K$P,K$q,K$_){void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=!0),void 0===K$q&&(K$q=""),void 0===K$_&&(K$_=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,K$c,K$P,K$q,K$_))},K$P._recordInitData=function(){if(this._aniKeys){var K$c,K$P,K$q=0;for(K$c=this._aniKeys.length,K$q=0;K$q<K$c;K$q++)K$P=this._aniKeys[K$q],this._initData[K$P]=this._target[K$P]}},K$P._displayToIndex=function(K$c){if(this._animationData){K$c<0&&(K$c=0),K$c>this._count&&(K$c=this._count);var K$P=this._animationData.nodes,K$q=0,K$_=K$P.length;for(K$_=1<K$_?1:K$_,K$q=0;K$q<K$_;K$q++)this._displayNodeToFrame(K$P[K$q],K$c)}},K$P._displayNodeToFrame=function(K$c,K$P,K$q){if(this._target){var K$_;K$_=this._target;var K$E,K$b,K$e,K$h,K$Z=K$c.frames,K$S=K$c.keys,K$n=0,K$k=K$S.length;K$h=K$c.secondFrames;var K$x,K$r,K$g,K$W,K$w=0;for(K$n=0;K$n<K$k;K$n++)K$b=K$Z[K$E=K$S[K$n]],K$e=-1==(K$w=K$h[K$E])?this._initData[K$E]:K$P<K$w?(K$g=(K$r=K$c.keyframes[K$E])[0]).tween?(null==(K$x=K$z[K$g.tweenMethod])&&(K$x=K$z.linearNone),K$W=K$r[1],K$x(K$P,this._initData[K$E],K$W.value-this._initData[K$E],K$W.index)):this._initData[K$E]:K$b.length>K$P?K$b[K$P]:K$b[K$b.length-1],K$_[K$E]=K$e}},K$P._calculateNodeKeyFrames=function(K$c){K$b.prototype._calculateNodeKeyFrames.call(this,K$c);var K$P,K$q,K$_,K$E=K$c.keyframes;K$c.target;for(K$P in K$_={},K$c.secondFrames=K$_,K$E)(K$q=K$E[K$P]).length<=1?K$_[K$P]=-1:K$_[K$P]=K$q[1].index},K$g(0,K$P,"target",function(){return this._target},function(K$c){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=K$c,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),K$g(0,K$P,"playEvent",null,function(K$c){(this._playEvents=K$c)&&this.addEvent()}),K$g(0,K$P,"effectData",null,function(K$c){var K$P;K$c&&((K$P=K$c.animations)&&K$P[0]&&(this._setUp({},K$P[0]),K$P[0].nodes&&K$P[0].nodes[0]&&(this._aniKeys=K$P[0].nodes[0].keys)))}),K$g(0,K$P,"effectClass",null,function(K$c){var K$P,K$q;(this._effectClass=K$v.getClass(K$c),this._effectClass)&&((K$P=this._effectClass.uiView)&&(K$q=K$P.animations)&&K$q[0]&&(this._setUp({},K$q[0]),K$q[0].nodes&&K$q[0].nodes[0]&&(this._aniKeys=K$q[0].nodes[0].keys)))}),K$c.EffectAnimationBegin="effectanimationbegin"}(K$Tc),function(K$P){var K$A;function K$J(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,K$J.__super.call(this)}K$n(K$J,"laya.utils.GraphicAnimation",K$P);var K$c=K$J.prototype;return K$c._parseNodeList=function(K$c){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[K$c.compId]=K$c.props,K$c.compId&&this._nodeList.push(K$c.compId);var K$P=K$c.child;if(K$P){var K$q=0,K$_=K$P.length;for(K$q=0;K$q<K$_;K$q++)this._parseNodeList(K$P[K$q])}},K$c._calGraphicData=function(K$c){var K$P;if(this._setUp(null,K$c),this._createGraphicData(),this._nodeIDAniDic)for(K$P in this._nodeIDAniDic)this._nodeIDAniDic[K$P]=null},K$c._createGraphicData=function(){var K$c,K$P=[],K$q=0,K$_=this.count,K$E=this._animationNewFrames;for(K$E||(K$E=[]),K$q=0;K$q<K$_;K$q++)!K$E[K$q]&&K$c||(K$c=this._createFrameGraphic(K$q)),K$P.push(K$c);this._gList=K$P},K$c._createFrameGraphic=function(K$c){var K$P=K$j.createGraphics();return K$J._rootMatrix||(K$J._rootMatrix=new K$V),this._updateNodeGraphic(this._rootNode,K$c,K$J._rootMatrix,K$P),K$P},K$c._updateNodeGraphic=function(K$c,K$P,K$q,K$_,K$E){var K$b;void 0===K$E&&(K$E=1);var K$e,K$h,K$Z,K$S=(K$b=this._nodeGDic[K$c.compId]=this._getNodeGraphicData(K$c.compId,K$P,this._nodeGDic[K$c.compId])).alpha*K$E;if(!(K$S<.01)&&(K$b.resultTransform||(K$b.resultTransform=K$V.create()),K$e=K$b.resultTransform,K$V.mul(K$b.transform,K$q,K$e),K$b.skin&&(K$h=this._getTextureByUrl(K$b.skin))&&(K$e._checkTransform()?(K$_.drawTexture(K$h,0,0,K$b.width,K$b.height,K$e,K$S),K$b.resultTransform=null):K$_.drawTexture(K$h,K$e.tx,K$e.ty,K$b.width,K$b.height,null,K$S)),K$Z=K$c.child)){var K$n,K$k=0;for(K$n=K$Z.length,K$k=0;K$k<K$n;K$k++)this._updateNodeGraphic(K$Z[K$k],K$P,K$e,K$_,K$S)}},K$c._updateNoChilds=function(K$c,K$P){if(K$c.skin){var K$q=this._getTextureByUrl(K$c.skin);if(K$q){var K$_=K$c.transform;K$_._checkTransform();!K$_.bTransform?K$P.drawTexture(K$q,K$_.tx,K$_.ty,K$c.width,K$c.height,null,K$c.alpha):K$P.drawTexture(K$q,0,0,K$c.width,K$c.height,K$_.clone(),K$c.alpha)}}},K$c._updateNodeGraphic2=function(K$c,K$P,K$q){var K$_;if(K$_=this._nodeGDic[K$c.compId]=this._getNodeGraphicData(K$c.compId,K$P,this._nodeGDic[K$c.compId]),K$c.child){var K$E=K$_.transform;K$E._checkTransform();var K$b,K$e;K$e=(K$b=!K$E.bTransform)&&(0!=K$E.tx||0!=K$E.ty);var K$h,K$Z,K$S;if((K$h=K$E.bTransform||1!=K$_.alpha)&&K$q.save(),1!=K$_.alpha&&K$q.alpha(K$_.alpha),K$b?K$e&&K$q.translate(K$E.tx,K$E.ty):K$q.transform(K$E.clone()),K$Z=K$c.child,K$_.skin&&(K$S=this._getTextureByUrl(K$_.skin))&&K$q.drawTexture(K$S,0,0,K$_.width,K$_.height),K$Z){var K$n,K$k=0;for(K$n=K$Z.length,K$k=0;K$k<K$n;K$k++)this._updateNodeGraphic2(K$Z[K$k],K$P,K$q)}K$h?K$q.restore():K$b?K$e&&K$q.translate(-K$E.tx,-K$E.ty):K$q.transform(K$E.clone().invert())}else this._updateNoChilds(K$_,K$q)},K$c._calculateNodeKeyFrames=function(K$c){K$P.prototype._calculateNodeKeyFrames.call(this,K$c),this._nodeIDAniDic[K$c.target]=K$c},K$c.getNodeDataByID=function(K$c){return this._nodeIDAniDic[K$c]},K$c._getParams=function(K$c,K$P,K$q,K$_){var K$E=K$J._temParam;K$E.length=K$P.length;var K$b=0,K$e=K$P.length;for(K$b=0;K$b<K$e;K$b++)K$E[K$b]=this._getObjVar(K$c,K$P[K$b][0],K$q,K$P[K$b][1],K$_);return K$E},K$c._getObjVar=function(K$c,K$P,K$q,K$_,K$E){if(K$c.hasOwnProperty(K$P)){var K$b=K$c[K$P];if(K$q>=K$b.length&&(K$q=K$b.length-1),null!=K$c[K$P][K$q])return K$c[K$P][K$q]}return K$E.hasOwnProperty(K$P)?K$E[K$P]:K$_},K$c._getNodeGraphicData=function(K$c,K$P,K$q){K$q||(K$q=K$A.create()),K$q.transform?K$q.transform.identity():K$q.transform=K$V.create();var K$_=this.getNodeDataByID(K$c);if(!K$_)return K$q;var K$E,K$b,K$e=K$_.frames,K$h=this._getParams(K$e,K$J._drawTextureCmd,K$P,this._nodeDefaultProps[K$c]),K$Z=K$h[0],K$S=NaN,K$n=NaN,K$k=K$h[5],K$x=K$h[6],K$r=K$h[13],K$g=K$h[14],K$W=K$h[7],K$w=K$h[8],K$O=K$h[9],K$N=K$h[11],K$m=K$h[12];K$S=K$h[3],K$n=K$h[4],0!=K$S&&0!=K$n||(K$Z=null),-1==K$S&&(K$S=0),-1==K$n&&(K$n=0),K$q.skin=K$Z,K$q.width=K$S,K$q.height=K$n,K$Z&&((K$E=this._getTextureByUrl(K$Z))?(K$S||(K$S=K$E.sourceWidth),K$n||(K$n=K$E.sourceHeight)):console.warn("lost skin:",K$Z,",you may load pics first")),K$q.alpha=K$h[10],K$b=K$q.transform,0!=K$r&&(K$k=K$r*K$S),0!=K$g&&(K$x=K$g*K$n),0==K$k&&0==K$x||K$b.translate(-K$k,-K$x);var K$T=null;if(K$O||1!==K$W||1!==K$w||K$N||K$m){(K$T=K$J._tempMt).identity(),K$T.bTransform=!0;var K$D=.0174532922222222*(K$O-K$N),K$L=.0174532922222222*(K$O+K$m),K$H=Math.cos(K$L),K$Q=Math.sin(K$L),K$d=Math.sin(K$D),K$u=Math.cos(K$D);K$T.a=K$W*K$H,K$T.b=K$W*K$Q,K$T.c=-K$w*K$d,K$T.d=K$w*K$u,K$T.tx=K$T.ty=0}return K$T&&(K$b=K$V.mul(K$b,K$T,K$b)),K$b.translate(K$h[1],K$h[2]),K$q},K$c._getTextureByUrl=function(K$c){return K$hc.getRes(K$c)},K$c.setAniData=function(K$c,K$P){if(K$c.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=K$c,this._parseNodeList(K$c);var K$q,K$_={},K$E=[],K$b=K$c.animations,K$e=0,K$h=K$b.length;for(K$e=0;K$e<K$h;K$e++)if(K$q=K$b[K$e],this._labels=null,(!K$P||K$P==K$q.name)&&K$q){try{this._calGraphicData(K$q)}catch(K$c){console.warn("parse animation fail:"+K$q.name+",empty animation created"),this._gList=[]}var K$Z={};K$Z.interval=1e3/K$q.frameRate,K$Z.frames=this._gList,K$Z.labels=this._labels,K$Z.name=K$q.name,K$E.push(K$Z),K$_[K$q.name]=K$Z}this.animationList=K$E,this.animationDic=K$_}K$J._temParam.length=0},K$c.parseByData=function(K$c){var K$P,K$q;K$P=K$c.nodeRoot,K$q=K$c.aniO,delete K$c.nodeRoot,delete K$c.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=K$P,this._parseNodeList(K$P),this._labels=null;try{this._calGraphicData(K$q)}catch(K$c){console.warn("parse animation fail:"+K$q.name+",empty animation created"),this._gList=[]}var K$_=K$c;return K$_.interval=1e3/K$q.frameRate,K$_.frames=this._gList,K$_.labels=this._labels,K$_.name=K$q.name,K$_},K$c.setUpAniData=function(K$c){if(K$c.animations){var K$P,K$q={},K$_=[],K$E=K$c.animations,K$b=0,K$e=K$E.length;for(K$b=0;K$b<K$e;K$b++)if(K$P=K$E[K$b]){var K$h={};K$h.name=K$P.name,K$h.aniO=K$P,K$h.nodeRoot=K$c,K$_.push(K$h),K$q[K$P.name]=K$h}this.animationList=K$_,this.animationDic=K$q}},K$c._clear=function(){var K$c,K$P;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(K$c in this._nodeGDic)(K$P=this._nodeGDic[K$c])&&K$P.recover();this._nodeGDic=null},K$J.parseAnimationByData=function(K$c){var K$P;return K$J._I||(K$J._I=new K$J),K$P=K$J._I.parseByData(K$c),K$J._I._clear(),K$P},K$J.parseAnimationData=function(K$c){var K$P;return K$J._I||(K$J._I=new K$J),K$J._I.setUpAniData(K$c),(K$P={}).animationList=K$J._I.animationList,K$P.animationDic=K$J._I.animationDic,K$J._I._clear(),K$P},K$J._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],K$J._temParam=[],K$J._I=null,K$J._rootMatrix=null,K$Z(K$J,["_tempMt",function(){return this._tempMt=new K$V}]),K$J.__init$=function(){K$A=function(){function K$c(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return K$n(K$c,""),K$c.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),K$f.recover("GraphicNode",this)},K$c.create=function(){return K$f.getItemByClass("GraphicNode",K$c)},K$c}()},K$J}(K$Tc));K$H.__init([K$S,K$Zc,K$C,K$s,K$t,K$u,K$c,K$Hc])}(window,document,Laya),function(K$c,K$P,K$q){K$q.un,K$q.uns,K$q.static;var K$_=K$q.class;K$q.getset,K$q.__newvec;new(function(){function K$c(){}return K$_(K$c,"LayaMain"),K$c}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(K$c,K$P){"use strict";for(var K$q in Object.defineProperty(K$P,"__esModule",{value:!0}),Laya){var K$_=Laya[K$q];K$_&&K$_.__isclass&&(K$P[K$q]=K$_)}}),function(K$c,K$P,K$L){K$L.un,K$L.uns;var K$e=K$L.static,K$x=K$L.class,K$_=K$L.getset,K$b=K$L.__newvec,K$n=laya.maths.Arith,K$k=laya.maths.Bezier,K$q=laya.resource.Bitmap,K$r=laya.utils.Browser,K$Z=laya.utils.Byte,K$g=laya.utils.Color,K$H=(laya.filters.ColorFilter,K$L.Config),K$E=laya.resource.Context,K$Q=(laya.events.Event,laya.filters.Filter),K$h=laya.display.Graphics,K$S=laya.resource.HTMLCanvas,K$W=(laya.utils.HTMLChar,laya.resource.HTMLImage),K$w=laya.resource.HTMLSubImage,K$d=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),K$u=laya.maths.Point,K$A=laya.maths.Rectangle,K$O=laya.renders.Render,K$N=(laya.renders.RenderContext,laya.renders.RenderSprite),K$m=laya.resource.Resource,K$T=laya.resource.ResourceManager,K$D=laya.utils.RunDriver,K$J=laya.display.Sprite,K$j=laya.display.Stage,K$V=laya.utils.Stat,K$R=laya.utils.StringKey,K$$=(laya.display.css.Style,laya.system.System),K$C=laya.display.Text,K$F=laya.resource.Texture,K$o=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),K$a=laya.utils.VectorGraphManager;laya.utils.WordText;K$L.interface("laya.webgl.shapes.IShape"),K$L.interface("laya.webgl.submit.ISubmit"),K$L.interface("laya.webgl.text.ICharSegment"),K$L.interface("laya.webgl.canvas.save.ISaveData"),K$L.interface("laya.webgl.resource.IMergeAtlasBitmap"),K$L.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var K$Y=function(){function K$c(){}K$x(K$c,"laya.filters.webgl.FilterActionGL");var K$P=K$c.prototype;return K$L.imps(K$P,{"laya.filters.IFilterActionGL":!0}),K$P.setValue=function(K$c){},K$P.setValueMix=function(K$c){},K$P.apply3d=function(K$c,K$P,K$q,K$_,K$E){return null},K$P.apply=function(K$c){return null},K$_(0,K$P,"typeMix",function(){return 0}),K$c}(),K$s=function(){function K$c(){}return K$x(K$c,"laya.webgl.shader.ShaderValue"),K$c}(),K$U=function(){var K$_,K$E;function K$c(K$c,K$P,K$q){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new K$E,void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),this._cells=null,this._rowInfo=null,this._init(K$c,K$P),this._atlasID=K$q}K$x(K$c,"laya.webgl.atlas.AtlasGrid");var K$P=K$c.prototype;return K$P.getAltasID=function(){return this._atlasID},K$P.setAltasID=function(K$c){0<=K$c&&(this._atlasID=K$c)},K$P.addTex=function(K$c,K$P,K$q){var K$_=this._get(K$P,K$q);return 0==K$_.ret||(this._fill(K$_.x,K$_.y,K$P,K$q,K$c),this._texCount++),K$_},K$P._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},K$P._init=function(K$c,K$P){if(this._width=K$c,this._height=K$P,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=K$b(this._height);for(var K$q=0;K$q<this._height;K$q++)this._rowInfo[K$q]=new K$_;return this._clear(),!0},K$P._get=function(K$c,K$P){var K$q=new K$v;if(K$c>=this._failSize.width&&K$P>=this._failSize.height)return K$q;for(var K$_=-1,K$E=-1,K$b=this._width,K$e=this._height,K$h=this._cells,K$Z=0;K$Z<K$e;K$Z++)if(!(this._rowInfo[K$Z].spaceCount<K$c))for(var K$S=0;K$S<K$b;){var K$n=3*(K$Z*K$b+K$S);if(0!=K$h[K$n]||K$h[1+K$n]<K$c||K$h[2+K$n]<K$P)K$S+=K$h[1+K$n];else{K$_=K$S,K$E=K$Z;for(var K$k=0;K$k<K$c;K$k++)if(K$h[3*K$k+K$n+2]<K$P){K$_=-1;break}if(!(K$_<0))return K$q.ret=!0,K$q.x=K$_,K$q.y=K$E,K$q;K$S+=K$h[1+K$n]}}return K$q},K$P._fill=function(K$c,K$P,K$q,K$_,K$E){var K$b=this._width,K$e=this._height;this._check(K$c+K$q<=K$b&&K$P+K$_<=K$e);for(var K$h=K$P;K$h<K$_+K$P;++K$h){this._check(this._rowInfo[K$h].spaceCount>=K$q),this._rowInfo[K$h].spaceCount-=K$q;for(var K$Z=0;K$Z<K$q;K$Z++){var K$S=3*(K$c+K$h*K$b+K$Z);this._check(0==this._cells[K$S]),this._cells[K$S]=K$E,this._cells[1+K$S]=K$q,this._cells[2+K$S]=K$_}}if(0<K$c)for(K$h=0;K$h<K$_;++K$h){var K$n=0;for(K$Z=K$c-1;0<=K$Z&&0==this._cells[3*((K$P+K$h)*K$b+K$Z)];--K$Z,++K$n);for(K$Z=K$n;0<K$Z;--K$Z)this._cells[3*((K$P+K$h)*K$b+K$c-K$Z)+1]=K$Z,this._check(0<K$Z)}if(0<K$P)for(K$Z=K$c;K$Z<K$c+K$q;++K$Z){for(K$n=0,K$h=K$P-1;0<=K$h&&0==this._cells[3*(K$Z+K$h*K$b)];--K$h,K$n++);for(K$h=K$n;0<K$h;--K$h)this._cells[3*(K$Z+(K$P-K$h)*K$b)+2]=K$h,this._check(0<K$h)}},K$P._check=function(K$c){0==K$c&&console.log("xtexMerger 错误啦")},K$P._clear=function(){for(var K$c=this._texCount=0;K$c<this._height;K$c++)this._rowInfo[K$c].spaceCount=this._width;for(var K$P=0;K$P<this._height;K$P++)for(var K$q=0;K$q<this._width;K$q++){var K$_=3*(K$P*this._width+K$q);this._cells[K$_]=0,this._cells[1+K$_]=this._width-K$q,this._cells[2+K$_]=this._width-K$P}this._failSize.width=this._width+1,this._failSize.height=this._height+1},K$c.__init$=function(){K$_=function(){function K$c(){this.spaceCount=0}return K$x(K$c,""),K$c}(),K$E=function(){function K$c(){this.width=0,this.height=0}return K$x(K$c,""),K$c}()},K$c}(),K$I=function(){function K$O(K$c,K$P,K$q,K$_){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=K$c,this._height=K$P,this._gridSize=K$q,this._maxAtlaserCount=K$_,this._gridNumX=K$c/K$q,this._gridNumY=K$P/K$q,this._curAtlasIndex=0,this._atlaserArray=[]}K$x(K$O,"laya.webgl.atlas.AtlasResourceManager");var K$c=K$O.prototype;return K$c.setAtlasParam=function(K$c,K$P,K$q,K$_){if(1==this._setAtlasParam)return K$O._sid_=0,this._width=K$c,this._height=K$P,this._gridSize=K$q,this._maxAtlaserCount=K$_,this._gridNumX=K$c/K$q,this._gridNumY=K$P/K$q,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},K$c.pushData=function(K$c){var K$P,K$q=K$c.bitmap,K$_=-1,K$E=null,K$b=0,K$e=0;for(K$b=0,K$P=this._atlaserArray.length;K$b<K$P&&(K$e=(this._curAtlasIndex+K$b)%K$P,-1==(K$_=(K$E=this._atlaserArray[K$e]).findBitmapIsExist(K$q)));K$b++);if(-1!=K$_){var K$h=K$E.InAtlasWebGLImagesOffsetValue[K$_];return K$g=K$h[0],K$W=K$h[1],K$E.addToAtlas(K$c,K$g,K$W),!0}this._setAtlasParam=!1;for(var K$Z=Math.ceil((K$c.bitmap.width+2)/this._gridSize),K$S=Math.ceil((K$c.bitmap.height+2)/this._gridSize),K$n=!1,K$k=0;K$k<2;K$k++){var K$x=this._maxAtlaserCount;for(K$b=0;K$b<K$x;K$b++){K$e=(this._curAtlasIndex+K$b)%K$x,this._atlaserArray.length-1>=K$e||this._atlaserArray.push(new K$Ac(this._gridNumX,this._gridNumY,this._width,this._height,K$O._sid_++));var K$r=this._atlaserArray[K$e],K$g=0,K$W=0,K$w=K$r.addTex(1,K$Z,K$S);if(K$w.ret){K$g=K$w.x*this._gridSize+1,K$W=K$w.y*this._gridSize+1,K$q.lock=!0,K$r.addToAtlasTexture(K$q,K$g,K$W),K$r.addToAtlas(K$c,K$g,K$W),K$n=!0,this._curAtlasIndex=K$e;break}}if(K$n)break;this._atlaserArray.push(new K$Ac(this._gridNumX,this._gridNumY,this._width,this._height,K$O._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return K$n||console.log(">>>AtlasManager pushData error"),K$n},K$c.addToAtlas=function(K$c){laya.webgl.atlas.AtlasResourceManager.instance.pushData(K$c)},K$c.garbageCollection=function(){if(!0===this._needGC){for(var K$c=this._atlaserArray.length-this._maxAtlaserCount,K$P=0;K$P<K$c;K$P++)this._atlaserArray[K$P].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+K$c),this._atlaserArray.splice(0,K$c),this._needGC=!1}return!0},K$c.freeAll=function(){for(var K$c=0,K$P=this._atlaserArray.length;K$c<K$P;K$c++)this._atlaserArray[K$c].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},K$c.getAtlaserCount=function(){return this._atlaserArray.length},K$c.getAtlaserByIndex=function(K$c){return this._atlaserArray[K$c]},K$_(1,K$O,"instance",function(){return K$O._Instance||(K$O._Instance=new K$O(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),K$O._Instance}),K$_(1,K$O,"enabled",function(){return K$H.atlasEnable}),K$_(1,K$O,"atlasLimitWidth",function(){return K$O._atlasLimitWidth},function(K$c){K$O._atlasLimitWidth=K$c}),K$_(1,K$O,"atlasLimitHeight",function(){return K$O._atlasLimitHeight},function(K$c){K$O._atlasLimitHeight=K$c}),K$O._enable=function(){K$H.atlasEnable=!0},K$O._disable=function(){K$H.atlasEnable=!1},K$O.__init__=function(){K$O.atlasTextureWidth=2048,K$O.atlasTextureHeight=2048,K$O.maxTextureCount=6,K$O.atlasLimitWidth=512,K$O.atlasLimitHeight=512},K$O._atlasLimitWidth=0,K$O._atlasLimitHeight=0,K$O.gridSize=16,K$O.atlasTextureWidth=0,K$O.atlasTextureHeight=0,K$O.maxTextureCount=0,K$O._atlasRestore=0,K$O.BOARDER_TYPE_NO=0,K$O.BOARDER_TYPE_RIGHT=1,K$O.BOARDER_TYPE_LEFT=2,K$O.BOARDER_TYPE_BOTTOM=4,K$O.BOARDER_TYPE_TOP=8,K$O.BOARDER_TYPE_ALL=15,K$O._sid_=0,K$O._Instance=null,K$O}(),K$v=function(){function K$c(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return K$x(K$c,"laya.webgl.atlas.MergeFillInfo"),K$c}(),K$y=function(){function K$P(){}return K$x(K$P,"laya.webgl.canvas.BlendMode"),K$P._init_=function(K$c){K$P.fns=[K$P.BlendNormal,K$P.BlendAdd,K$P.BlendMultiply,K$P.BlendScreen,K$P.BlendOverlay,K$P.BlendLight,K$P.BlendMask,K$P.BlendDestinationOut],K$P.targetFns=[K$P.BlendNormalTarget,K$P.BlendAddTarget,K$P.BlendMultiplyTarget,K$P.BlendScreenTarget,K$P.BlendOverlayTarget,K$P.BlendLightTarget,K$P.BlendMask,K$P.BlendDestinationOut]},K$P.BlendNormal=function(K$c){K$c.blendFunc(1,771)},K$P.BlendAdd=function(K$c){K$c.blendFunc(1,772)},K$P.BlendMultiply=function(K$c){K$c.blendFunc(774,771)},K$P.BlendScreen=function(K$c){K$c.blendFunc(1,1)},K$P.BlendOverlay=function(K$c){K$c.blendFunc(1,769)},K$P.BlendLight=function(K$c){K$c.blendFunc(1,1)},K$P.BlendNormalTarget=function(K$c){K$c.blendFunc(1,771)},K$P.BlendAddTarget=function(K$c){K$c.blendFunc(1,772)},K$P.BlendMultiplyTarget=function(K$c){K$c.blendFunc(774,771)},K$P.BlendScreenTarget=function(K$c){K$c.blendFunc(1,1)},K$P.BlendOverlayTarget=function(K$c){K$c.blendFunc(1,769)},K$P.BlendLightTarget=function(K$c){K$c.blendFunc(1,1)},K$P.BlendMask=function(K$c){K$c.blendFunc(0,770)},K$P.BlendDestinationOut=function(K$c){K$c.blendFunc(0,0)},K$P.activeBlendFunction=null,K$P.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],K$P.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},K$P.NORMAL="normal",K$P.ADD="add",K$P.MULTIPLY="multiply",K$P.SCREEN="screen",K$P.LIGHT="light",K$P.OVERLAY="overlay",K$P.DESTINATIONOUT="destination-out",K$P.fns=[],K$P.targetFns=[],K$P}(),K$M=function(){function K$q(K$c){this._color=K$g.create("black"),this.setValue(K$c)}K$x(K$q,"laya.webgl.canvas.DrawStyle");var K$c=K$q.prototype;return K$c.setValue=function(K$c){if(K$c){if("string"==typeof K$c)return void(this._color=K$g.create(K$c));if(K$c instanceof laya.utils.Color)return void(this._color=K$c)}},K$c.reset=function(){this._color=K$g.create("black")},K$c.equal=function(K$c){return"string"==typeof K$c?this._color.strColor===K$c:K$c instanceof laya.utils.Color&&this._color.numColor===K$c.numColor},K$c.toColorStr=function(){return this._color.strColor},K$q.create=function(K$c){var K$P;if(K$c&&("string"==typeof K$c?K$P=K$g.create(K$c):K$c instanceof laya.utils.Color&&(K$P=K$c),K$P))return K$P._drawStyle||(K$P._drawStyle=new K$q(K$c));return laya.webgl.canvas.DrawStyle.DEFAULT},K$e(K$q,["DEFAULT",function(){return this.DEFAULT=new K$q("#000000")}]),K$q}(),K$z=function(){function K$c(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];K$Tc.mainContext;this.ib=K$Kc.create(35048),this.vb=K$Gc.create(5)}K$x(K$c,"laya.webgl.canvas.Path");var K$P=K$c.prototype;return K$P.addPoint=function(K$c,K$P){this.tempArray.push(K$c,K$P)},K$P.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},K$P.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},K$P.polygon=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e;return this.geomatrys.push(this._curGeomatry=K$e=new K$Rc(K$c,K$P,K$q,K$_,K$E,K$b)),K$_||(K$e.fill=!1),null==K$b&&(K$e.borderWidth=0),K$e},K$P.setGeomtry=function(K$c){this.geomatrys.push(this._curGeomatry=K$c)},K$P.drawLine=function(K$c,K$P,K$q,K$_,K$E){var K$b;return this.closePath?this.geomatrys.push(this._curGeomatry=K$b=new K$Vc(K$c,K$P,K$q,K$_,K$E)):this.geomatrys.push(this._curGeomatry=K$b=new K$jc(K$c,K$P,K$q,K$_,K$E)),K$b.fill=!1,K$b},K$P.update=function(){var K$c=this.ib._byteLength,K$P=this.geomatrys.length;this.offset=K$c;for(var K$q=this.geoStart;K$q<K$P;K$q++)this.geomatrys[K$q].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=K$P,this.count=(this.ib._byteLength-K$c)/K$Wc.BYTES_PIDX},K$P.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},K$P.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},K$c}(),K$X=function(){function K$h(){}K$x(K$h,"laya.webgl.canvas.save.SaveBase");var K$c=K$h.prototype;return K$L.imps(K$c,{"laya.webgl.canvas.save.ISaveData":!0}),K$c.isSaveMark=function(){return!1},K$c.restore=function(K$c){this._dataObj[this._valueName]=this._value,(K$h._cache[K$h._cache._length++]=this)._newSubmit&&(K$c._curSubmit=K$bc.RENDERBASE,K$c._renderKey=0)},K$h._createArray=function(){var K$c=[];return K$c._length=0,K$c},K$h._init=function(){var K$c=K$h._namemap={};return K$c[1]="ALPHA",K$c[2]="fillStyle",K$c[8]="font",K$c[256]="lineWidth",K$c[512]="strokeStyle",K$c[8192]="_mergeID",K$c[1024]=K$c[2048]=K$c[4096]=[],K$c[16384]="textBaseline",K$c[32768]="textAlign",K$c[65536]="_nBlendType",K$c[1048576]="shader",K$c[2097152]="filters",K$c},K$h.save=function(K$c,K$P,K$q,K$_){if((K$c._saveMark._saveuse&K$P)!==K$P){K$c._saveMark._saveuse|=K$P;var K$E=K$h._cache,K$b=0<K$E._length?K$E[--K$E._length]:new K$h;K$b._value=K$q[K$b._valueName=K$h._namemap[K$P]],K$b._dataObj=K$q,K$b._newSubmit=K$_;var K$e=K$c._save;K$e[K$e._length++]=K$b}},K$h._cache=laya.webgl.canvas.save.SaveBase._createArray(),K$h._namemap=K$h._init(),K$h}(),K$f=function(){function K$b(){this._clipRect=new K$A}K$x(K$b,"laya.webgl.canvas.save.SaveClipRect");var K$c=K$b.prototype;return K$L.imps(K$c,{"laya.webgl.canvas.save.ISaveData":!0}),K$c.isSaveMark=function(){return!1},K$c.restore=function(K$c){K$c._clipRect=this._clipSaveRect,(K$b._cache[K$b._cache._length++]=this)._submitScissor.submitLength=K$c._submits._length-this._submitScissor.submitIndex,K$c._curSubmit=K$bc.RENDERBASE,K$c._renderKey=0},K$b.save=function(K$c,K$P){if(131072!=(131072&K$c._saveMark._saveuse)){K$c._saveMark._saveuse|=131072;var K$q=K$b._cache,K$_=0<K$q._length?K$q[--K$q._length]:new K$b;K$_._clipSaveRect=K$c._clipRect,K$c._clipRect=K$_._clipRect.copyFrom(K$c._clipRect),K$_._submitScissor=K$P;var K$E=K$c._save;K$E[K$E._length++]=K$_}},K$e(K$b,["_cache",function(){return this._cache=K$X._createArray()}]),K$b}(),K$l=function(){function K$r(){this._contextX=0,this._contextY=0,this._clipRect=new K$A,this._rect=new K$A,this._matrix=new K$d}K$x(K$r,"laya.webgl.canvas.save.SaveClipRectStencil");var K$c=K$r.prototype;return K$L.imps(K$c,{"laya.webgl.canvas.save.ISaveData":!0}),K$c.isSaveMark=function(){return!1},K$c.restore=function(K$c){K$nc.restore(K$c,this._rect,this._saveMatrix,this._contextX,this._contextY),K$c._clipRect=this._clipSaveRect,K$c._curMat=this._saveMatrix,K$c._x=this._contextX,K$c._y=this._contextY,K$r._cache[K$r._cache._length++]=this,K$c._curSubmit=K$bc.RENDERBASE},K$r.save=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){if(262144!=(262144&K$c._saveMark._saveuse)){K$c._saveMark._saveuse|=262144;var K$n=K$r._cache,K$k=0<K$n._length?K$n[--K$n._length]:new K$r;K$k._clipSaveRect=K$c._clipRect,K$k._clipRect.setTo(K$e,K$h,K$Z,K$S),K$c._clipRect=K$k._clipRect,K$k._rect.x=K$q,K$k._rect.y=K$_,K$k._rect.width=K$E,K$k._rect.height=K$b,K$k._contextX=K$c._x,K$k._contextY=K$c._y,K$k._saveMatrix=K$c._curMat,K$c._curMat.copyTo(K$k._matrix),K$c._curMat=K$k._matrix,K$k._submitStencil=K$P;var K$x=K$c._save;K$x[K$x._length++]=K$k}},K$e(K$r,["_cache",function(){return this._cache=K$X._createArray()}]),K$r}(),K$t=function(){function K$_(){this._saveuse=0}K$x(K$_,"laya.webgl.canvas.save.SaveMark");var K$c=K$_.prototype;return K$L.imps(K$c,{"laya.webgl.canvas.save.ISaveData":!0}),K$c.isSaveMark=function(){return!0},K$c.restore=function(K$c){K$c._saveMark=this._preSaveMark,K$_._no[K$_._no._length++]=this},K$_.Create=function(K$c){var K$P=K$_._no,K$q=0<K$P._length?K$P[--K$P._length]:new K$_;return K$q._saveuse=0,K$q._preSaveMark=K$c._saveMark,K$c._saveMark=K$q},K$e(K$_,["_no",function(){return this._no=K$X._createArray()}]),K$_}(),K$B=function(){function K$b(){this._matrix=new K$d}K$x(K$b,"laya.webgl.canvas.save.SaveTransform");var K$c=K$b.prototype;return K$L.imps(K$c,{"laya.webgl.canvas.save.ISaveData":!0}),K$c.isSaveMark=function(){return!1},K$c.restore=function(K$c){K$c._curMat=this._savematrix,K$b._no[K$b._no._length++]=this},K$b.save=function(K$c){var K$P=K$c._saveMark;if(2048!=(2048&K$P._saveuse)){K$P._saveuse|=2048;var K$q=K$b._no,K$_=0<K$q._length?K$q[--K$q._length]:new K$b;K$_._savematrix=K$c._curMat,K$c._curMat=K$c._curMat.copyTo(K$_._matrix);var K$E=K$c._save;K$E[K$E._length++]=K$_}},K$e(K$b,["_no",function(){return this._no=K$X._createArray()}]),K$b}(),K$p=function(){function K$E(){}K$x(K$E,"laya.webgl.canvas.save.SaveTranslate");var K$c=K$E.prototype;return K$L.imps(K$c,{"laya.webgl.canvas.save.ISaveData":!0}),K$c.isSaveMark=function(){return!1},K$c.restore=function(K$c){K$c._curMat;K$c._x=this._x,K$c._y=this._y,K$E._no[K$E._no._length++]=this},K$E.save=function(K$c){var K$P=K$E._no,K$q=0<K$P._length?K$P[--K$P._length]:new K$E;K$q._x=K$c._x,K$q._y=K$c._y;var K$_=K$c._save;K$_[K$_._length++]=K$q},K$e(K$E,["_no",function(){return this._no=K$X._createArray()}]),K$E}(),K$i=function(){function K$c(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new K$A}K$x(K$c,"laya.webgl.resource.RenderTargetMAX");var K$P=K$c.prototype;return K$P.setSP=function(K$c){this._sp=K$c},K$P.size=function(K$c,K$P){var K$q=this;this._width!==K$c||this._height!==K$P?(this.repaint=!0,this._width=K$c,this._height=K$P,this.target?this.target.size(K$c,K$P):this.target=K$ac.create(K$c,K$P),this.target.hasListener("recovered")||this.target.on("recovered",this,function(K$c){K$L.timer.callLater(K$q._sp,K$q._sp.repaint)})):this.target.size(K$c,K$P)},K$P._flushToTarget=function(K$c,K$P){if(!K$P._destroy){var K$q=K$Nc.worldScissorTest,K$_=K$Nc.worldClipRect;K$Nc.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,K$Nc.worldScissorTest=!1,K$Tc.mainContext.disable(3089);var K$E=K$Nc.worldAlpha,K$b=K$Nc.worldMatrix4,K$e=K$Nc.worldMatrix,K$h=K$Nc.worldFilters,K$Z=K$Nc.worldShaderDefines;if(K$Nc.worldMatrix=K$d.EMPTY,K$Nc.restoreTempArray(),K$Nc.worldMatrix4=K$Nc.TEMPMAT4_ARRAY,K$Nc.worldAlpha=1,K$Nc.worldFilters=null,K$Nc.worldShaderDefines=null,K$oc.activeShader=null,K$P.start(),K$H.showCanvasMark?K$P.clear(0,1,0,.3):K$P.clear(0,0,0,0),K$c.flush(),K$P.end(),K$oc.activeShader=null,K$Nc.worldAlpha=K$E,K$Nc.worldMatrix4=K$b,K$Nc.worldMatrix=K$e,K$Nc.worldFilters=K$h,K$Nc.worldShaderDefines=K$Z,K$Nc.worldScissorTest=K$q){var K$S=K$Nc.height-K$_.y-K$_.height;K$Tc.mainContext.scissor(K$_.x,K$S,K$_.width,K$_.height),K$Tc.mainContext.enable(3089)}K$Nc.worldClipRect=K$_}},K$P.flush=function(K$c){this.repaint&&(this._flushToTarget(K$c,this.target),this.repaint=!1)},K$P.drawTo=function(K$c,K$P,K$q,K$_,K$E){K$c.drawTexture(this.target.getTexture(),K$P,K$q,K$_,K$E,0,0)},K$P.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},K$c}(),K$K=function(){function K$c(){this.ALPHA=1,this.shaderType=0,this.defines=new K$Jc}return K$x(K$c,"laya.webgl.shader.d2.Shader2D"),K$c.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},K$c.__init__=function(){var K$c,K$P;K$tc.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),K$tc.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),K$tc.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),K$tc.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),K$tc.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),K$tc.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),K$tc.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),K$tc.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),K$c="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",K$P='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',K$tc.preCompile2D(0,1,K$c,K$P,null),K$c="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",K$P='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',K$tc.preCompile2D(0,2,K$c,K$P,null),K$c="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",K$P="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",K$tc.preCompile2D(0,4,K$c,K$P,null),K$c="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",K$P='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',K$tc.preCompile2D(0,256,K$c,K$P,null),K$c="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",K$P="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",K$tc.preCompile2D(0,512,K$c,K$P,null)},K$c}(),K$G=function(){function K$P(K$c,K$P,K$q){this._value=0,this._name2int=K$c,this._int2name=K$P,this._int2nameMap=K$q}K$x(K$P,"laya.webgl.shader.ShaderDefines");var K$c=K$P.prototype;return K$c.add=function(K$c){return"string"==typeof K$c&&(K$c=this._name2int[K$c]),this._value|=K$c,this._value},K$c.addInt=function(K$c){return this._value|=K$c,this._value},K$c.remove=function(K$c){return"string"==typeof K$c&&(K$c=this._name2int[K$c]),this._value&=~K$c,this._value},K$c.isDefine=function(K$c){return(this._value&K$c)===K$c},K$c.getValue=function(){return this._value},K$c.setValue=function(K$c){this._value=K$c},K$c.toNameDic=function(){var K$c=this._int2nameMap[this._value];return K$c||K$P._toText(this._value,this._int2name,this._int2nameMap)},K$P._reg=function(K$c,K$P,K$q,K$_){K$_[K$q[K$c]=K$P]=K$c},K$P._toText=function(K$c,K$P,K$q){var K$_=K$q[K$c];if(K$_)return K$_;for(var K$E={},K$b=1,K$e=0;K$e<32&&!(K$c<(K$b=1<<K$e));K$e++)if(K$c&K$b){var K$h=K$P[K$b];K$h&&(K$E[K$h]="")}return K$q[K$c]=K$E},K$P._toInt=function(K$c,K$P){for(var K$q=K$c.split("."),K$_=0,K$E=0,K$b=K$q.length;K$E<K$b;K$E++){var K$e=K$P[K$q[K$E]];if(!K$e)throw new Error("Defines to int err:"+K$c+"/"+K$q[K$E]);K$_|=K$e}return K$_},K$P}(),K$cc=function(){function K$e(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new K$d}K$x(K$e,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var K$c=K$e.prototype;return K$c.init=function(K$c,K$P,K$q){if(K$P)this._vs=K$P;else{this._vs=[];var K$_=K$c.width,K$E=K$c.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(K$_,0,1,0,1,1,1,1),this._vs.push(K$_,K$E,1,1,1,1,1,1),this._vs.push(0,K$E,0,1,1,1,1,1)}K$q?this._ps=K$q:(K$e._defaultPS||(K$e._defaultPS=[]).push(0,1,3,3,1,2),this._ps=K$e._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=K$c},K$c.init2=function(K$c,K$P,K$q,K$_,K$E){this.transform&&(this.transform=null),K$q?this._ps=K$q:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=K$_,this._uvs=K$E,this.mEleNum=this._ps.length,this.mTexture=K$c,(K$O.isConchNode||K$O.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},K$c._initMyData=function(){var K$c=0,K$P=0,K$q=4*this._verticles.length;this._vs=K$e._tempVS;var K$_=!1;if(K$O.isConchNode||K$O.isConchApp?(this._vs.length=K$q,K$_=!0):this._vs.length<K$q&&(this._vs.length=K$q,K$_=!0),K$e._tVSLen=K$q,K$_)for(;K$c<K$q;)this._vs[K$c]=this._verticles[K$P],this._vs[K$c+1]=this._verticles[K$P+1],this._vs[K$c+2]=this._uvs[K$P],this._vs[K$c+3]=this._uvs[K$P+1],this._vs[K$c+4]=1,this._vs[K$c+5]=1,this._vs[K$c+6]=1,this._vs[K$c+7]=1,K$c+=8,K$P+=2;else for(;K$c<K$q;)this._vs[K$c]=this._verticles[K$P],this._vs[K$c+1]=this._verticles[K$P+1],this._vs[K$c+2]=this._uvs[K$P],this._vs[K$c+3]=this._uvs[K$P+1],K$c+=8,K$P+=2},K$c.getData2=function(K$c,K$P,K$q){var K$_;this.mVBBuffer=K$c,this.mIBBuffer=K$P,this._initMyData(),K$c.appendEx2(this._vs,Float32Array,K$e._tVSLen,4),this._indexStart=K$P._byteLength,(K$_=K$e._tempIB).length<this._ps.length&&(K$_.length=this._ps.length);for(var K$E=0,K$b=this._ps.length;K$E<K$b;K$E++)K$_[K$E]=this._ps[K$E]+K$q;K$P.appendEx2(K$_,Uint16Array,this._ps.length,2)},K$c.getData=function(K$c,K$P,K$q){if(this.mVBBuffer=K$c,this.mIBBuffer=K$P,K$c.append(this.mVBData),this._indexStart=K$P._byteLength,this.mIBData.start!=K$q){for(var K$_=0,K$E=this._ps.length;K$_<K$E;K$_++)this.mIBData[K$_]=this._ps[K$_]+K$q;this.mIBData.start=K$q}K$P.append(this.mIBData)},K$c.render=function(K$c,K$P,K$q){if(K$O.isWebGL&&this.mTexture){K$c._renderKey=0,K$c._shader2D.glTexture=null,K$Pc.getInstance().addSkinMesh(this);var K$_=K$bc.createShape(K$c,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,K$Qc.create(512,0));this.transform||(this.transform=K$d.EMPTY),this.transform.translate(K$P,K$q),K$d.mul(this.transform,K$c._curMat,this._tempMatrix),this.transform.translate(-K$P,-K$q);var K$E=K$_.shaderValue,K$b=K$E.u_mmat2||K$Nc.getMatrArray();K$Nc.mat2MatArray(this._tempMatrix,K$b),K$E.textureHost=this.mTexture,K$E.offsetX=0,K$E.offsetY=0,K$E.u_mmat2=K$b,K$E.ALPHA=K$c._shader2D.ALPHA,K$c._submits[K$c._submits._length++]=K$_}else K$O.isConchApp&&this.mTexture&&(this.transform||(this.transform=K$d.EMPTY),K$c.setSkinMesh&&K$c.setSkinMesh(K$P,K$q,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},K$e._tempVS=[],K$e._tempIB=[],K$e._defaultPS=null,K$e._tVSLen=0,K$e}(),K$Pc=function(){function K$c(){this.ib=null,this.vb=null;K$Tc.mainContext;this.ib=K$Kc.create(35048),this.vb=K$Gc.create(8)}K$x(K$c,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var K$P=K$c.prototype;return K$P.addSkinMesh=function(K$c){K$c.getData2(this.vb,this.ib,this.vb._byteLength/32)},K$P.reset=function(){this.vb.clear(),this.ib.clear()},K$c.getInstance=function(){return K$c.instance=K$c.instance||new K$c},K$c.instance=null,K$c}(),K$qc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===K$Z&&(K$Z=0),this.x=K$c,this.y=K$P,this.width=K$q,this.height=K$_,this.edges=K$E,this.color=K$b,this.borderWidth=K$e,this.borderColor=K$h}K$x(K$c,"laya.webgl.shapes.BasePoly");var K$P=K$c.prototype;return K$L.imps(K$P,{"laya.webgl.shapes.IShape":!0}),K$P.getData=function(K$c,K$P,K$q){},K$P.rebuild=function(K$c){},K$P.setMatrix=function(K$c){},K$P.needUpdate=function(K$c){return!0},K$P.sector=function(K$c,K$P,K$q){var K$_=this.x,K$E=this.y,K$b=this.edges,K$e=(this.r1-this.r0)/K$b,K$h=this.width,K$Z=this.height,K$S=this.color,K$n=(K$S>>16&255)/255,K$k=(K$S>>8&255)/255,K$x=(255&K$S)/255;K$c.push(K$_,K$E,K$n,K$k,K$x);for(var K$r=0;K$r<K$b+1;K$r++)K$c.push(K$_+Math.sin(K$e*K$r+this.r0)*K$h,K$E+Math.cos(K$e*K$r+this.r0)*K$Z),K$c.push(K$n,K$k,K$x);for(K$r=0;K$r<K$b;K$r++)K$P.push(K$q,K$q+K$r+1,K$q+K$r+2)},K$P.createLine2=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e,K$h,K$Z,K$S,K$n,K$k,K$x,K$r,K$g,K$W,K$w,K$O,K$N,K$m,K$T,K$D,K$L,K$H,K$Q,K$d,K$u=K$c.concat(),K$A=K$E,K$J=this.borderColor,K$j=(K$J>>16&255)/255,K$V=(K$J>>8&255)/255,K$R=(255&K$J)/255,K$$=K$u.length/2,K$C=K$_,K$F=K$q/2;K$Z=K$u[0],K$S=K$u[1],K$W=K$Z-(K$n=K$u[2]),K$g=(K$g=-(K$S-(K$k=K$u[3])))/(K$d=Math.sqrt(K$g*K$g+K$W*K$W))*K$F,K$W=K$W/K$d*K$F,K$A.push(K$Z-K$g+this.x,K$S-K$W+this.y,K$j,K$V,K$R,K$Z+K$g+this.x,K$S+K$W+this.y,K$j,K$V,K$R);for(var K$o=1;K$o<K$$-1;K$o++)K$Z=K$u[2*(K$o-1)],K$S=K$u[2*(K$o-1)+1],K$n=K$u[2*K$o],K$k=K$u[2*K$o+1],K$x=K$u[2*(K$o+1)],K$r=K$u[2*(K$o+1)+1],K$W=K$Z-K$n,K$O=K$n-K$x,K$T=(-(K$g=(K$g=-(K$S-K$k))/(K$d=Math.sqrt(K$g*K$g+K$W*K$W))*K$F)+K$Z)*(-(K$W=K$W/K$d*K$F)+K$k)-(-K$g+K$n)*(-K$W+K$S),K$H=(-(K$w=(K$w=-(K$k-K$r))/(K$d=Math.sqrt(K$w*K$w+K$O*K$O))*K$F)+K$x)*(-(K$O=K$O/K$d*K$F)+K$k)-(-K$w+K$n)*(-K$O+K$r),K$Q=(K$N=-K$W+K$S-(-K$W+K$k))*(K$L=-K$w+K$n-(-K$w+K$x))-(K$D=-K$O+K$r-(-K$O+K$k))*(K$m=-K$g+K$n-(-K$g+K$Z)),Math.abs(K$Q)<.1?(K$Q+=10.1,K$A.push(K$n-K$g+this.x,K$k-K$W+this.y,K$j,K$V,K$R,K$n+K$g+this.x,K$k+K$W+this.y,K$j,K$V,K$R)):(((K$e=(K$m*K$H-K$L*K$T)/K$Q)-K$n)*(K$e-K$n)+((K$h=(K$D*K$T-K$N*K$H)/K$Q)-K$k)+(K$h-K$k),K$A.push(K$e+this.x,K$h+this.y,K$j,K$V,K$R,K$n-(K$e-K$n)+this.x,K$k-(K$h-K$k)+this.y,K$j,K$V,K$R));K$Z=K$u[K$u.length-4],K$S=K$u[K$u.length-3],K$W=K$Z-(K$n=K$u[K$u.length-2]),K$g=(K$g=-(K$S-(K$k=K$u[K$u.length-1])))/(K$d=Math.sqrt(K$g*K$g+K$W*K$W))*K$F,K$W=K$W/K$d*K$F,K$A.push(K$n-K$g+this.x,K$k-K$W+this.y,K$j,K$V,K$R,K$n+K$g+this.x,K$k+K$W+this.y,K$j,K$V,K$R);var K$a=K$b;for(K$o=1;K$o<K$a;K$o++)K$P.push(K$C+2*(K$o-1),K$C+2*(K$o-1)+1,K$C+2*K$o+1,K$C+2*K$o+1,K$C+2*K$o,K$C+2*(K$o-1));return K$A},K$P.createLine=function(K$c,K$P,K$q,K$_){var K$E=K$c.concat(),K$b=K$c,K$e=this.borderColor,K$h=(K$e>>16&255)/255,K$Z=(K$e>>8&255)/255,K$S=(255&K$e)/255;K$E.splice(0,5);var K$n,K$k,K$x,K$r,K$g,K$W,K$w,K$O,K$N,K$m,K$T,K$D,K$L,K$H,K$Q,K$d,K$u,K$A,K$J,K$j,K$V=K$E.length/5,K$R=K$_,K$$=K$q/2;K$x=K$E[0],K$r=K$E[1],K$m=K$x-(K$g=K$E[5]),K$N=(K$N=-(K$r-(K$W=K$E[6])))/(K$j=Math.sqrt(K$N*K$N+K$m*K$m))*K$$,K$m=K$m/K$j*K$$,K$b.push(K$x-K$N,K$r-K$m,K$h,K$Z,K$S,K$x+K$N,K$r+K$m,K$h,K$Z,K$S);for(var K$C=1;K$C<K$V-1;K$C++)K$x=K$E[5*(K$C-1)],K$r=K$E[5*(K$C-1)+1],K$g=K$E[5*K$C],K$W=K$E[5*K$C+1],K$w=K$E[5*(K$C+1)],K$O=K$E[5*(K$C+1)+1],K$m=K$x-K$g,K$D=K$g-K$w,K$Q=(-(K$N=(K$N=-(K$r-K$W))/(K$j=Math.sqrt(K$N*K$N+K$m*K$m))*K$$)+K$x)*(-(K$m=K$m/K$j*K$$)+K$W)-(-K$N+K$g)*(-K$m+K$r),K$A=(-(K$T=(K$T=-(K$W-K$O))/(K$j=Math.sqrt(K$T*K$T+K$D*K$D))*K$$)+K$w)*(-(K$D=K$D/K$j*K$$)+K$W)-(-K$T+K$g)*(-K$D+K$O),K$J=(K$L=-K$m+K$r-(-K$m+K$W))*(K$u=-K$T+K$g-(-K$T+K$w))-(K$d=-K$D+K$O-(-K$D+K$W))*(K$H=-K$N+K$g-(-K$N+K$x)),Math.abs(K$J)<.1?(K$J+=10.1,K$b.push(K$g-K$N,K$W-K$m,K$h,K$Z,K$S,K$g+K$N,K$W+K$m,K$h,K$Z,K$S)):(((K$n=(K$H*K$A-K$u*K$Q)/K$J)-K$g)*(K$n-K$g)+((K$k=(K$d*K$Q-K$L*K$A)/K$J)-K$W)+(K$k-K$W),K$b.push(K$n,K$k,K$h,K$Z,K$S,K$g-(K$n-K$g),K$W-(K$k-K$W),K$h,K$Z,K$S));K$x=K$E[K$E.length-10],K$r=K$E[K$E.length-9],K$m=K$x-(K$g=K$E[K$E.length-5]),K$N=(K$N=-(K$r-(K$W=K$E[K$E.length-4])))/(K$j=Math.sqrt(K$N*K$N+K$m*K$m))*K$$,K$m=K$m/K$j*K$$,K$b.push(K$g-K$N,K$W-K$m,K$h,K$Z,K$S,K$g+K$N,K$W+K$m,K$h,K$Z,K$S);var K$F=this.edges+1;for(K$C=1;K$C<K$F;K$C++)K$P.push(K$R+2*(K$C-1),K$R+2*(K$C-1)+1,K$R+2*K$C+1,K$R+2*K$C+1,K$R+2*K$C,K$R+2*(K$C-1));return K$b},K$P.createLoopLine=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=K$c.concat(),K$h=K$E||K$c,K$Z=this.borderColor,K$S=(K$Z>>16&255)/255,K$n=(K$Z>>8&255)/255,K$k=(255&K$Z)/255;K$e.splice(0,5);var K$x=[K$e[0],K$e[1]],K$r=[K$e[K$e.length-5],K$e[K$e.length-4]],K$g=K$r[0]+.5*(K$x[0]-K$r[0]),K$W=K$r[1]+.5*(K$x[1]-K$r[1]);K$e.unshift(K$g,K$W,0,0,0),K$e.push(K$g,K$W,0,0,0);var K$w,K$O,K$N,K$m,K$T,K$D,K$L,K$H,K$Q,K$d,K$u,K$A,K$J,K$j,K$V,K$R,K$$,K$C,K$F,K$o,K$a=K$e.length/5,K$Y=K$_,K$s=K$q/2;K$N=K$e[0],K$m=K$e[1],K$d=K$N-(K$T=K$e[5]),K$Q=(K$Q=-(K$m-(K$D=K$e[6])))/(K$o=Math.sqrt(K$Q*K$Q+K$d*K$d))*K$s,K$d=K$d/K$o*K$s,K$h.push(K$N-K$Q,K$m-K$d,K$S,K$n,K$k,K$N+K$Q,K$m+K$d,K$S,K$n,K$k);for(var K$U=1;K$U<K$a-1;K$U++)K$N=K$e[5*(K$U-1)],K$m=K$e[5*(K$U-1)+1],K$T=K$e[5*K$U],K$D=K$e[5*K$U+1],K$L=K$e[5*(K$U+1)],K$H=K$e[5*(K$U+1)+1],K$d=K$N-K$T,K$A=K$T-K$L,K$V=(-(K$Q=(K$Q=-(K$m-K$D))/(K$o=Math.sqrt(K$Q*K$Q+K$d*K$d))*K$s)+K$N)*(-(K$d=K$d/K$o*K$s)+K$D)-(-K$Q+K$T)*(-K$d+K$m),K$C=(-(K$u=(K$u=-(K$D-K$H))/(K$o=Math.sqrt(K$u*K$u+K$A*K$A))*K$s)+K$L)*(-(K$A=K$A/K$o*K$s)+K$D)-(-K$u+K$T)*(-K$A+K$H),K$F=(K$J=-K$d+K$m-(-K$d+K$D))*(K$$=-K$u+K$T-(-K$u+K$L))-(K$R=-K$A+K$H-(-K$A+K$D))*(K$j=-K$Q+K$T-(-K$Q+K$N)),Math.abs(K$F)<.1?(K$F+=10.1,K$h.push(K$T-K$Q,K$D-K$d,K$S,K$n,K$k,K$T+K$Q,K$D+K$d,K$S,K$n,K$k)):(((K$w=(K$j*K$C-K$$*K$V)/K$F)-K$T)*(K$w-K$T)+((K$O=(K$R*K$V-K$J*K$C)/K$F)-K$D)+(K$O-K$D),K$h.push(K$w,K$O,K$S,K$n,K$k,K$T-(K$w-K$T),K$D-(K$O-K$D),K$S,K$n,K$k));K$b&&(K$P=K$b);var K$I=this.edges+1;for(K$U=1;K$U<K$I;K$U++)K$P.push(K$Y+2*(K$U-1),K$Y+2*(K$U-1)+1,K$Y+2*K$U+1,K$Y+2*K$U+1,K$Y+2*K$U,K$Y+2*(K$U-1));return K$P.push(K$Y+2*(K$U-1),K$Y+2*(K$U-1)+1,K$Y+1,K$Y+1,K$Y,K$Y+2*(K$U-1)),K$h},K$c}(),K$_c=function(){function K$W(){}return K$x(K$W,"laya.webgl.shapes.Earcut"),K$W.earcut=function(K$c,K$P,K$q){K$q=K$q||2;var K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n=K$P&&K$P.length,K$k=K$n?K$P[0]*K$q:K$c.length,K$x=K$W.linkedList(K$c,0,K$k,K$q,!0),K$r=[];if(!K$x)return K$r;if(K$n&&(K$x=K$W.eliminateHoles(K$c,K$P,K$x,K$q)),K$c.length>80*K$q){K$_=K$b=K$c[0],K$E=K$e=K$c[1];for(var K$g=K$q;K$g<K$k;K$g+=K$q)(K$h=K$c[K$g])<K$_&&(K$_=K$h),(K$Z=K$c[K$g+1])<K$E&&(K$E=K$Z),K$b<K$h&&(K$b=K$h),K$e<K$Z&&(K$e=K$Z);K$S=0!==(K$S=Math.max(K$b-K$_,K$e-K$E))?1/K$S:0}return K$W.earcutLinked(K$x,K$r,K$q,K$_,K$E,K$S),K$r},K$W.linkedList=function(K$c,K$P,K$q,K$_,K$E){var K$b,K$e;if(K$E===0<K$W.signedArea(K$c,K$P,K$q,K$_))for(K$b=K$P;K$b<K$q;K$b+=K$_)K$e=K$W.insertNode(K$b,K$c[K$b],K$c[K$b+1],K$e);else for(K$b=K$q-K$_;K$P<=K$b;K$b-=K$_)K$e=K$W.insertNode(K$b,K$c[K$b],K$c[K$b+1],K$e);return K$e&&K$W.equals(K$e,K$e.next)&&(K$W.removeNode(K$e),K$e=K$e.next),K$e},K$W.filterPoints=function(K$c,K$P){if(!K$c)return K$c;K$P||(K$P=K$c);var K$q,K$_=K$c;do{if(K$q=!1,K$_.steiner||!K$W.equals(K$_,K$_.next)&&0!==K$W.area(K$_.prev,K$_,K$_.next))K$_=K$_.next;else{if(K$W.removeNode(K$_),(K$_=K$P=K$_.prev)===K$_.next)break;K$q=!0}}while(K$q||K$_!==K$P);return K$P},K$W.earcutLinked=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){if(K$c){!K$e&&K$b&&K$W.indexCurve(K$c,K$_,K$E,K$b);for(var K$h,K$Z,K$S=K$c;K$c.prev!==K$c.next;)if(K$h=K$c.prev,K$Z=K$c.next,K$b?K$W.isEarHashed(K$c,K$_,K$E,K$b):K$W.isEar(K$c))K$P.push(K$h.i/K$q),K$P.push(K$c.i/K$q),K$P.push(K$Z.i/K$q),K$W.removeNode(K$c),K$c=K$Z.next,K$S=K$Z.next;else if((K$c=K$Z)===K$S){K$e?1===K$e?(K$c=K$W.cureLocalIntersections(K$c,K$P,K$q),K$W.earcutLinked(K$c,K$P,K$q,K$_,K$E,K$b,2)):2===K$e&&K$W.splitEarcut(K$c,K$P,K$q,K$_,K$E,K$b):K$W.earcutLinked(K$W.filterPoints(K$c,null),K$P,K$q,K$_,K$E,K$b,1);break}}},K$W.isEar=function(K$c){var K$P=K$c.prev,K$q=K$c,K$_=K$c.next;if(0<=K$W.area(K$P,K$q,K$_))return!1;for(var K$E=K$c.next.next;K$E!==K$c.prev;){if(K$W.pointInTriangle(K$P.x,K$P.y,K$q.x,K$q.y,K$_.x,K$_.y,K$E.x,K$E.y)&&0<=K$W.area(K$E.prev,K$E,K$E.next))return!1;K$E=K$E.next}return!0},K$W.isEarHashed=function(K$c,K$P,K$q,K$_){var K$E=K$c.prev,K$b=K$c,K$e=K$c.next;if(0<=K$W.area(K$E,K$b,K$e))return!1;for(var K$h=K$E.x<K$b.x?K$E.x<K$e.x?K$E.x:K$e.x:K$b.x<K$e.x?K$b.x:K$e.x,K$Z=K$E.y<K$b.y?K$E.y<K$e.y?K$E.y:K$e.y:K$b.y<K$e.y?K$b.y:K$e.y,K$S=K$E.x>K$b.x?K$E.x>K$e.x?K$E.x:K$e.x:K$b.x>K$e.x?K$b.x:K$e.x,K$n=K$E.y>K$b.y?K$E.y>K$e.y?K$E.y:K$e.y:K$b.y>K$e.y?K$b.y:K$e.y,K$k=K$W.zOrder(K$h,K$Z,K$P,K$q,K$_),K$x=K$W.zOrder(K$S,K$n,K$P,K$q,K$_),K$r=K$c.nextZ;K$r&&K$r.z<=K$x;){if(K$r!==K$c.prev&&K$r!==K$c.next&&K$W.pointInTriangle(K$E.x,K$E.y,K$b.x,K$b.y,K$e.x,K$e.y,K$r.x,K$r.y)&&0<=K$W.area(K$r.prev,K$r,K$r.next))return!1;K$r=K$r.nextZ}for(K$r=K$c.prevZ;K$r&&K$r.z>=K$k;){if(K$r!==K$c.prev&&K$r!==K$c.next&&K$W.pointInTriangle(K$E.x,K$E.y,K$b.x,K$b.y,K$e.x,K$e.y,K$r.x,K$r.y)&&0<=K$W.area(K$r.prev,K$r,K$r.next))return!1;K$r=K$r.prevZ}return!0},K$W.cureLocalIntersections=function(K$c,K$P,K$q){var K$_=K$c;do{var K$E=K$_.prev,K$b=K$_.next.next;!K$W.equals(K$E,K$b)&&K$W.intersects(K$E,K$_,K$_.next,K$b)&&K$W.locallyInside(K$E,K$b)&&K$W.locallyInside(K$b,K$E)&&(K$P.push(K$E.i/K$q),K$P.push(K$_.i/K$q),K$P.push(K$b.i/K$q),K$W.removeNode(K$_),K$W.removeNode(K$_.next),K$_=K$c=K$b),K$_=K$_.next}while(K$_!==K$c);return K$_},K$W.splitEarcut=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=K$c;do{for(var K$h=K$e.next.next;K$h!==K$e.prev;){if(K$e.i!==K$h.i&&K$W.isValidDiagonal(K$e,K$h)){var K$Z=K$W.splitPolygon(K$e,K$h);return K$e=K$W.filterPoints(K$e,K$e.next),K$Z=K$W.filterPoints(K$Z,K$Z.next),K$W.earcutLinked(K$e,K$P,K$q,K$_,K$E,K$b),void K$W.earcutLinked(K$Z,K$P,K$q,K$_,K$E,K$b)}K$h=K$h.next}K$e=K$e.next}while(K$e!==K$c)},K$W.eliminateHoles=function(K$c,K$P,K$q,K$_){var K$E,K$b,K$e,K$h,K$Z,K$S=[];for(K$E=0,K$b=K$P.length;K$E<K$b;K$E++)K$e=K$P[K$E]*K$_,K$h=K$E<K$b-1?K$P[K$E+1]*K$_:K$c.length,(K$Z=K$W.linkedList(K$c,K$e,K$h,K$_,!1))===K$Z.next&&(K$Z.steiner=!0),K$S.push(K$W.getLeftmost(K$Z));for(K$S.sort(K$W.compareX),K$E=0;K$E<K$S.length;K$E++)K$W.eliminateHole(K$S[K$E],K$q),K$q=K$W.filterPoints(K$q,K$q.next);return K$q},K$W.compareX=function(K$c,K$P){return K$c.x-K$P.x},K$W.eliminateHole=function(K$c,K$P){if(K$P=K$W.findHoleBridge(K$c,K$P)){var K$q=K$W.splitPolygon(K$P,K$c);K$W.filterPoints(K$q,K$q.next)}},K$W.findHoleBridge=function(K$c,K$P){var K$q,K$_=K$P,K$E=K$c.x,K$b=K$c.y,K$e=-1/0;do{if(K$b<=K$_.y&&K$b>=K$_.next.y&&K$_.next.y!==K$_.y){var K$h=K$_.x+(K$b-K$_.y)*(K$_.next.x-K$_.x)/(K$_.next.y-K$_.y);if(K$h<=K$E&&K$e<K$h){if((K$e=K$h)===K$E){if(K$b===K$_.y)return K$_;if(K$b===K$_.next.y)return K$_.next}K$q=K$_.x<K$_.next.x?K$_:K$_.next}}K$_=K$_.next}while(K$_!==K$P);if(!K$q)return null;if(K$E===K$e)return K$q.prev;var K$Z,K$S=K$q,K$n=K$q.x,K$k=K$q.y,K$x=1/0;for(K$_=K$q.next;K$_!==K$S;)K$E>=K$_.x&&K$_.x>=K$n&&K$E!==K$_.x&&K$W.pointInTriangle(K$b<K$k?K$E:K$e,K$b,K$n,K$k,K$b<K$k?K$e:K$E,K$b,K$_.x,K$_.y)&&((K$Z=Math.abs(K$b-K$_.y)/(K$E-K$_.x))<K$x||K$Z===K$x&&K$_.x>K$q.x)&&K$W.locallyInside(K$_,K$c)&&(K$q=K$_,K$x=K$Z),K$_=K$_.next;return K$q},K$W.indexCurve=function(K$c,K$P,K$q,K$_){for(var K$E=K$c;null===K$E.z&&(K$E.z=K$W.zOrder(K$E.x,K$E.y,K$P,K$q,K$_)),K$E.prevZ=K$E.prev,K$E.nextZ=K$E.next,(K$E=K$E.next)!==K$c;);K$E.prevZ.nextZ=null,K$E.prevZ=null,K$W.sortLinked(K$E)},K$W.sortLinked=function(K$c){var K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S=1;do{for(K$q=K$c,K$b=K$c=null,K$e=0;K$q;){for(K$e++,K$_=K$q,K$P=K$h=0;K$P<K$S&&(K$h++,K$_=K$_.nextZ);K$P++);for(K$Z=K$S;0<K$h||0<K$Z&&K$_;)0!==K$h&&(0===K$Z||!K$_||K$q.z<=K$_.z)?(K$q=(K$E=K$q).nextZ,K$h--):(K$_=(K$E=K$_).nextZ,K$Z--),K$b?K$b.nextZ=K$E:K$c=K$E,K$E.prevZ=K$b,K$b=K$E;K$q=K$_}K$b.nextZ=null,K$S*=2}while(1<K$e);return K$c},K$W.zOrder=function(K$c,K$P,K$q,K$_,K$E){return(K$c=1431655765&((K$c=858993459&((K$c=252645135&((K$c=16711935&((K$c=32767*(K$c-K$q)*K$E)|K$c<<8))|K$c<<4))|K$c<<2))|K$c<<1))|(K$P=1431655765&((K$P=858993459&((K$P=252645135&((K$P=16711935&((K$P=32767*(K$P-K$_)*K$E)|K$P<<8))|K$P<<4))|K$P<<2))|K$P<<1))<<1},K$W.getLeftmost=function(K$c){for(var K$P=K$c,K$q=K$c;K$P.x<K$q.x&&(K$q=K$P),(K$P=K$P.next)!==K$c;);return K$q},K$W.pointInTriangle=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){return 0<=(K$E-K$e)*(K$P-K$h)-(K$c-K$e)*(K$b-K$h)&&0<=(K$c-K$e)*(K$_-K$h)-(K$q-K$e)*(K$P-K$h)&&0<=(K$q-K$e)*(K$b-K$h)-(K$E-K$e)*(K$_-K$h)},K$W.isValidDiagonal=function(K$c,K$P){return K$c.next.i!==K$P.i&&K$c.prev.i!==K$P.i&&!K$W.intersectsPolygon(K$c,K$P)&&K$W.locallyInside(K$c,K$P)&&K$W.locallyInside(K$P,K$c)&&K$W.middleInside(K$c,K$P)},K$W.area=function(K$c,K$P,K$q){return(K$P.y-K$c.y)*(K$q.x-K$P.x)-(K$P.x-K$c.x)*(K$q.y-K$P.y)},K$W.equals=function(K$c,K$P){return K$c.x===K$P.x&&K$c.y===K$P.y},K$W.intersects=function(K$c,K$P,K$q,K$_){return!!(K$W.equals(K$c,K$P)&&K$W.equals(K$q,K$_)||K$W.equals(K$c,K$_)&&K$W.equals(K$q,K$P))||0<K$W.area(K$c,K$P,K$q)!=0<K$W.area(K$c,K$P,K$_)&&0<K$W.area(K$q,K$_,K$c)!=0<K$W.area(K$q,K$_,K$P)},K$W.intersectsPolygon=function(K$c,K$P){var K$q=K$c;do{if(K$q.i!==K$c.i&&K$q.next.i!==K$c.i&&K$q.i!==K$P.i&&K$q.next.i!==K$P.i&&K$W.intersects(K$q,K$q.next,K$c,K$P))return!0;K$q=K$q.next}while(K$q!==K$c);return!1},K$W.locallyInside=function(K$c,K$P){return K$W.area(K$c.prev,K$c,K$c.next)<0?0<=K$W.area(K$c,K$P,K$c.next)&&0<=K$W.area(K$c,K$c.prev,K$P):K$W.area(K$c,K$P,K$c.prev)<0||K$W.area(K$c,K$c.next,K$P)<0},K$W.middleInside=function(K$c,K$P){for(var K$q=K$c,K$_=!1,K$E=(K$c.x+K$P.x)/2,K$b=(K$c.y+K$P.y)/2;K$q.y>K$b!=K$q.next.y>K$b&&K$q.next.y!==K$q.y&&K$E<(K$q.next.x-K$q.x)*(K$b-K$q.y)/(K$q.next.y-K$q.y)+K$q.x&&(K$_=!K$_),(K$q=K$q.next)!==K$c;);return K$_},K$W.splitPolygon=function(K$c,K$P){var K$q=new K$Ec(K$c.i,K$c.x,K$c.y),K$_=new K$Ec(K$P.i,K$P.x,K$P.y),K$E=K$c.next,K$b=K$P.prev;return(K$c.next=K$P).prev=K$c,(K$q.next=K$E).prev=K$q,(K$_.next=K$q).prev=K$_,(K$b.next=K$_).prev=K$b,K$_},K$W.insertNode=function(K$c,K$P,K$q,K$_){var K$E=new K$Ec(K$c,K$P,K$q);return K$_?(K$E.next=K$_.next,(K$E.prev=K$_).next.prev=K$E,K$_.next=K$E):(K$E.prev=K$E).next=K$E,K$E},K$W.removeNode=function(K$c){K$c.next.prev=K$c.prev,K$c.prev.next=K$c.next,K$c.prevZ&&(K$c.prevZ.nextZ=K$c.nextZ),K$c.nextZ&&(K$c.nextZ.prevZ=K$c.prevZ)},K$W.signedArea=function(K$c,K$P,K$q,K$_){for(var K$E=0,K$b=K$P,K$e=K$q-K$_;K$b<K$q;K$b+=K$_)K$E+=(K$c[K$e]-K$c[K$b])*(K$c[K$b+1]+K$c[K$e+1]),K$e=K$b;return K$E},K$W}(),K$Ec=function(){function K$c(K$c,K$P,K$q){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=K$c,this.x=K$P,this.y=K$q,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return K$x(K$c,"laya.webgl.shapes.EarcutNode"),K$c}(),K$bc=(function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this.lineWidth=K$c,this.lineColor=K$P,this.lineAlpha=K$q,this.fillColor=K$_,this.fillAlpha=K$E,this.shape=K$e,this.fill=K$b}K$x(K$c,"laya.webgl.shapes.GeometryData");var K$P=K$c.prototype;K$P.clone=function(){return new K$c(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},K$P.getIndexData=function(){return null},K$P.getVertexData=function(){return null},K$P.destroy=function(){this.shape=null}}(),function(){function K$c(K$c){if(K$c instanceof Float32Array)this.points=K$c;else if(K$c instanceof Array){K$c.length;this.points=new Float32Array(K$c)}}K$x(K$c,"laya.webgl.shapes.Vertex");var K$P=K$c.prototype;K$L.imps(K$P,{"laya.webgl.shapes.IShape":!0}),K$P.getData=function(K$c,K$P,K$q){},K$P.needUpdate=function(K$c){return!1},K$P.rebuild=function(K$c){},K$P.setMatrix=function(K$c){}}(),function(){function K$Z(K$c){void 0===K$c&&(K$c=1e4),this._renderType=K$c}K$x(K$Z,"laya.webgl.submit.Submit");var K$c=K$Z.prototype;return K$L.imps(K$c,{"laya.webgl.submit.ISubmit":!0}),K$c.releaseRender=function(){var K$c=K$Z._cache;(K$c[K$c._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},K$c.getRenderType=function(){return this._renderType},K$c.renderSubmit=function(){if(0===this._numEle)return 1;var K$c=this.shaderValue.textureHost;if(K$c){var K$P=K$c.source;if(!K$c.bitmap||!K$P)return 1;this.shaderValue.texture=K$P,K$c.alphaTexture&&K$c.alphaTexture.source&&(this.shaderValue.texture1=K$c.alphaTexture.source)}this._vb.bind_upload(this._ib);var K$q=K$Tc.mainContext;return this.shaderValue.upload(),K$y.activeBlendFunction!==this._blendFn&&(K$q.enable(3042),this._blendFn(K$q),K$y.activeBlendFunction=this._blendFn),K$V.drawCall++,K$V.trianglesFaces+=this._numEle/3,K$q.drawElements(4,this._numEle,5123,this._startIdx),1},K$Z.__init__=function(){var K$c=K$Z.RENDERBASE=new K$Z(-1);K$c.shaderValue=new K$Qc(0,0),K$c.shaderValue.ALPHA=-1234},K$Z.createSubmit=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$Z._cache._length?K$Z._cache[--K$Z._cache._length]:new K$Z;null==K$q&&((K$q=K$b._selfVb||(K$b._selfVb=K$Gc.create(-1))).clear(),K$_=0),K$b._ib=K$P,K$b._vb=K$q,K$b._startIdx=K$_*K$Wc.BYTES_PIDX,K$b._numEle=0;var K$e=K$c._nBlendType;K$b._blendFn=K$c._targets?K$y.targetFns[K$e]:K$y.fns[K$e],K$b.shaderValue=K$E,K$b.shaderValue.setValue(K$c._shader2D);var K$h=K$c._shader2D.filters;return K$h&&K$b.shaderValue.setFilters(K$h),K$b},K$Z.createShape=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=K$Z._cache._length?K$Z._cache[--K$Z._cache._length]:new K$Z;K$e._ib=K$P,K$e._vb=K$q,K$e._numEle=K$_,K$e._startIdx=K$E,K$e.shaderValue=K$b,K$e.shaderValue.setValue(K$c._shader2D);var K$h=K$c._nBlendType;return K$e._blendFn=K$c._targets?K$y.targetFns[K$h]:K$y.fns[K$h],K$e},K$Z.TYPE_2D=1e4,K$Z.TYPE_CANVAS=10003,K$Z.TYPE_CMDSETRT=10004,K$Z.TYPE_CUSTOM=10005,K$Z.TYPE_BLURRT=10006,K$Z.TYPE_CMDDESTORYPRERT=10007,K$Z.TYPE_DISABLESTENCIL=10008,K$Z.TYPE_OTHERIBVB=10009,K$Z.TYPE_PRIMITIVE=10010,K$Z.TYPE_RT=10011,K$Z.TYPE_BLUR_RT=10012,K$Z.TYPE_TARGET=10013,K$Z.TYPE_CHANGE_VALUE=10014,K$Z.TYPE_SHAPE=10015,K$Z.TYPE_TEXTURE=10016,K$Z.TYPE_FILLTEXTURE=10017,K$Z.RENDERBASE=null,K$Z._cache=((K$Z._cache=[])._length=0,K$Z._cache),K$Z}()),K$ec=function(){function K$_(){this.fun=null,this.args=null}K$x(K$_,"laya.webgl.submit.SubmitCMD");var K$c=K$_.prototype;return K$L.imps(K$c,{"laya.webgl.submit.ISubmit":!0}),K$c.renderSubmit=function(){return this.fun.apply(null,this.args),1},K$c.getRenderType=function(){return 0},K$c.releaseRender=function(){var K$c=K$_._cache;K$c[K$c._length++]=this},K$_.create=function(K$c,K$P){var K$q=K$_._cache._length?K$_._cache[--K$_._cache._length]:new K$_;return K$q.fun=K$P,K$q.args=K$c,K$q},K$_._cache=((K$_._cache=[])._length=0,K$_._cache),K$_}(),K$hc=function(){function K$P(){this.variables={}}K$x(K$P,"laya.webgl.submit.SubmitCMDScope");var K$c=K$P.prototype;return K$c.getValue=function(K$c){return this.variables[K$c]},K$c.addValue=function(K$c,K$P){return this.variables[K$c]=K$P},K$c.setValue=function(K$c,K$P){return this.variables.hasOwnProperty(K$c)?this.variables[K$c]=K$P:null},K$c.clear=function(){for(var K$c in this.variables)delete this.variables[K$c]},K$c.recycle=function(){this.clear(),K$P.POOL.push(this)},K$P.create=function(){var K$c=K$P.POOL.pop();return K$c||(K$c=new K$P),K$c},K$P.POOL=[],K$P}(),K$Zc=function(){function K$k(){this.offset=0,this.startIndex=0,this._mat=K$d.create()}K$x(K$k,"laya.webgl.submit.SubmitOtherIBVB");var K$c=K$k.prototype;return K$L.imps(K$c,{"laya.webgl.submit.ISubmit":!0}),K$c.releaseRender=function(){var K$c=K$k._cache;(K$c[K$c._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},K$c.getRenderType=function(){return 10009},K$c.renderSubmit=function(){var K$c=this._shaderValue.textureHost;if(K$c){var K$P=K$c.source;if(!K$c.bitmap||!K$P)return 1;this._shaderValue.texture=K$P}this._vb.bind_upload(this._ib);var K$q=K$Nc.worldMatrix4,K$_=K$d.TEMP;K$d.mulPre(this._mat,K$q[0],K$q[1],K$q[4],K$q[5],K$q[12],K$q[13],K$_);var K$E=K$Nc.worldMatrix4=K$k.tempMatrix4;K$E[0]=K$_.a,K$E[1]=K$_.b,K$E[4]=K$_.c,K$E[5]=K$_.d,K$E[12]=K$_.tx,K$E[13]=K$_.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var K$b=K$Tc.mainContext;return K$y.activeBlendFunction!==this._blendFn&&(K$b.enable(3042),this._blendFn(K$b),K$y.activeBlendFunction=this._blendFn),K$V.drawCall++,K$V.trianglesFaces+=this._numEle/3,K$b.drawElements(4,this._numEle,5123,this.startIndex),K$Nc.worldMatrix4=K$q,K$oc.activeShader=null,1},K$k.create=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){void 0===K$Z&&(K$Z=0);var K$S=K$k._cache._length?K$k._cache[--K$k._cache._length]:new K$k;K$S._ib=K$q,K$S._vb=K$P,K$S._numEle=K$_,K$S._shader=K$E,K$S._shaderValue=K$b;var K$n=K$c._nBlendType;switch(K$S._blendFn=K$c._targets?K$y.targetFns[K$n]:K$y.fns[K$n],K$Z){case 0:K$S.offset=0,K$S.startIndex=K$h/(K$Wc.BYTES_PE*K$P.vertexStride)*1.5,K$S.startIndex*=K$Wc.BYTES_PIDX;break;case 1:K$S.startIndex=K$e,K$S.offset=K$h}return K$S},K$k._cache=((K$k._cache=[])._length=0,K$k._cache),K$k.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],K$k}(),K$Sc=function(){function K$q(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new K$A,this.screenRect=new K$A}K$x(K$q,"laya.webgl.submit.SubmitScissor");var K$c=K$q.prototype;return K$L.imps(K$c,{"laya.webgl.submit.ISubmit":!0}),K$c._scissor=function(K$c,K$P,K$q,K$_){var K$E=K$Nc.worldMatrix4,K$b=K$E[0],K$e=K$E[5],K$h=K$E[12],K$Z=K$E[13];if(K$_*=K$e,(K$q*=K$b)<1||K$_<1)return!1;var K$S=(K$c=K$c*K$b+K$h)+K$q,K$n=(K$P=K$P*K$e+K$Z)+K$_;K$c<0&&(K$q=K$S-(K$c=0)),K$P<0&&(K$_=K$n-(K$P=0));var K$k=K$Nc.worldClipRect;if(K$c=Math.max(K$c,K$k.x),K$P=Math.max(K$P,K$k.y),K$q=Math.min(K$S,K$k.right)-K$c,K$_=Math.min(K$n,K$k.bottom)-K$P,K$q<1||K$_<1)return!1;var K$x=K$Nc.worldScissorTest;return this.screenRect.copyFrom(K$k),K$k.x=K$c,K$k.y=K$P,K$k.width=K$q,K$k.height=K$_,K$Nc.worldScissorTest=!0,K$P=K$Nc.height-K$P-K$_,K$Tc.mainContext.scissor(K$c,K$P,K$q,K$_),K$Tc.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),K$x?(K$P=K$Nc.height-this.screenRect.y-this.screenRect.height,K$Tc.mainContext.scissor(this.screenRect.x,K$P,this.screenRect.width,this.screenRect.height),K$Tc.mainContext.enable(3089)):(K$Tc.mainContext.disable(3089),K$Nc.worldScissorTest=!1),K$k.copyFrom(this.screenRect),!0},K$c._scissorWithTagart=function(K$c,K$P,K$q,K$_){if(K$q<1||K$_<1)return!1;var K$E=K$c+K$q,K$b=K$P+K$_;K$c<0&&(K$q=K$E-(K$c=0)),K$P<0&&(K$_=K$b-(K$P=0));var K$e=K$Nc.worldClipRect;if(K$c=Math.max(K$c,K$e.x),K$P=Math.max(K$P,K$e.y),K$q=Math.min(K$E,K$e.right)-K$c,K$_=Math.min(K$b,K$e.bottom)-K$P,K$q<1||K$_<1)return!1;var K$h=K$Nc.worldScissorTest;return this.screenRect.copyFrom(K$e),K$Nc.worldScissorTest=!0,K$e.x=K$c,K$e.y=K$P,K$e.width=K$q,K$e.height=K$_,K$P=K$Nc.height-K$P-K$_,K$Tc.mainContext.scissor(K$c,K$P,K$q,K$_),K$Tc.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),K$h?(K$P=K$Nc.height-this.screenRect.y-this.screenRect.height,K$Tc.mainContext.scissor(this.screenRect.x,K$P,this.screenRect.width,this.screenRect.height),K$Tc.mainContext.enable(3089)):(K$Tc.mainContext.disable(3089),K$Nc.worldScissorTest=!1),K$e.copyFrom(this.screenRect),!0},K$c.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},K$c.getRenderType=function(){return 0},K$c.releaseRender=function(){var K$c=K$q._cache;(K$c[K$c._length++]=this).context=null},K$q.create=function(K$c){var K$P=K$q._cache._length?K$q._cache[--K$q._cache._length]:new K$q;return K$P.context=K$c,K$P},K$q._cache=((K$q._cache=[])._length=0,K$q._cache),K$q}(),K$nc=function(){function K$Z(){this.step=0,this.blendMode=null,this.level=0}K$x(K$Z,"laya.webgl.submit.SubmitStencil");var K$c=K$Z.prototype;return K$L.imps(K$c,{"laya.webgl.submit.ISubmit":!0}),K$c.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},K$c.getRenderType=function(){return 0},K$c.releaseRender=function(){var K$c=K$Z._cache;K$c[K$c._length++]=this},K$c.do1=function(){var K$c=K$Tc.mainContext;K$c.enable(2960),K$c.clear(1024),K$c.colorMask(!1,!1,!1,!1),K$c.stencilFunc(514,this.level,255),K$c.stencilOp(7680,7680,7682)},K$c.do2=function(){var K$c=K$Tc.mainContext;K$c.stencilFunc(514,this.level+1,255),K$c.colorMask(!0,!0,!0,!0),K$c.stencilOp(7680,7680,7680)},K$c.do3=function(){var K$c=K$Tc.mainContext;K$c.colorMask(!0,!0,!0,!0),K$c.stencilOp(7680,7680,7680),K$c.clear(1024),K$c.disable(2960)},K$c.do4=function(){var K$c=K$Tc.mainContext;0==this.level&&(K$c.enable(2960),K$c.clear(1024)),K$c.colorMask(!1,!1,!1,!1),K$c.stencilFunc(519,0,255),K$c.stencilOp(7680,7680,7682)},K$c.do5=function(){var K$c=K$Tc.mainContext;K$c.stencilFunc(514,this.level,255),K$c.colorMask(!0,!0,!0,!0),K$c.stencilOp(7680,7680,7680)},K$c.do6=function(){var K$c=K$Tc.mainContext;K$y.targetFns[K$y.TOINT[this.blendMode]](K$c)},K$c.do7=function(){var K$c=K$Tc.mainContext;K$c.colorMask(!1,!1,!1,!1),K$c.stencilOp(7680,7680,7683)},K$c.do8=function(){var K$c=K$Tc.mainContext;K$c.colorMask(!0,!0,!0,!0),K$c.stencilFunc(514,this.level,255),K$c.stencilOp(7680,7680,7680)},K$Z.restore=function(K$c,K$P,K$q,K$_,K$E){var K$b;if((K$c._renderKey=0)<K$Z._mask&&K$Z._mask--,0==K$Z._mask)K$b=laya.webgl.submit.SubmitStencil.create(3),K$c.addRenderObject(K$b),K$c._curSubmit=K$bc.RENDERBASE;else{K$b=laya.webgl.submit.SubmitStencil.create(7),K$c.addRenderObject(K$b);var K$e=K$c._vb;K$e._byteLength;if(K$wc.fillRectImgVb(K$e,null,K$P.x,K$P.y,K$P.width,K$P.height,K$F.DEF_UV,K$q,K$_,K$E,0,0)){K$c._shader2D.glTexture=null;var K$h=K$c._curSubmit=K$bc.createSubmit(K$c,K$c._ib,K$e,(K$e._byteLength-64)/32*3,K$Qc.create(2,0));K$h.shaderValue.ALPHA=1,K$c._submits[K$c._submits._length++]=K$h,K$c._curSubmit._numEle+=6,K$c._curSubmit=K$bc.RENDERBASE}else alert("clipRect calc stencil rect error");K$b=laya.webgl.submit.SubmitStencil.create(8),K$c.addRenderObject(K$b)}},K$Z.restore2=function(K$c,K$P){var K$q;(K$c._renderKey=0)<K$Z._mask&&K$Z._mask--,0==K$Z._mask?(K$q=laya.webgl.submit.SubmitStencil.create(3),K$c.addRenderObject(K$q),K$c._curSubmit=K$bc.RENDERBASE):(K$q=laya.webgl.submit.SubmitStencil.create(7),K$c.addRenderObject(K$q),K$c._submits[K$c._submits._length++]=K$P,K$q=laya.webgl.submit.SubmitStencil.create(8),K$c.addRenderObject(K$q))},K$Z.create=function(K$c){var K$P=K$Z._cache._length?K$Z._cache[--K$Z._cache._length]:new K$Z;return 5==(K$P.step=K$c)&&++K$Z._mask,K$P.level=K$Z._mask,K$P},K$Z._cache=((K$Z._cache=[])._length=0,K$Z._cache),K$Z._mask=0,K$Z}(),K$kc=function(){function K$h(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}K$x(K$h,"laya.webgl.submit.SubmitTarget");var K$c=K$h.prototype;return K$L.imps(K$c,{"laya.webgl.submit.ISubmit":!0}),K$c.renderSubmit=function(){this._vb.bind_upload(this._ib);var K$c=this.scope.getValue(this.proName);return K$c&&(this.shaderValue.texture=K$c.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[K$c.width,K$c.height]),this.shaderValue.upload(),this.blend(),K$V.drawCall++,K$V.trianglesFaces+=this._numEle/3,K$Tc.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},K$c.blend=function(){if(K$y.activeBlendFunction!==K$y.fns[this.blendType]){var K$c=K$Tc.mainContext;K$c.enable(3042),K$y.fns[this.blendType](K$c),K$y.activeBlendFunction=K$y.fns[this.blendType]}},K$c.getRenderType=function(){return 0},K$c.releaseRender=function(){var K$c=K$h._cache;(K$c[K$c._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},K$h.create=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=K$h._cache._length?K$h._cache[--K$h._cache._length]:new K$h;return K$e._ib=K$P,K$e._vb=K$q,K$e.proName=K$b,K$e._startIdx=K$_*K$Wc.BYTES_PIDX,K$e._numEle=0,K$e.blendType=K$c._nBlendType,K$e.shaderValue=K$E,K$e.shaderValue.setValue(K$c._shader2D),K$e},K$h._cache=((K$h._cache=[])._length=0,K$h._cache),K$h}(),K$xc=function(){function K$c(){this._sourceStr=null}K$x(K$c,"laya.webgl.text.CharSegment");var K$P=K$c.prototype;return K$L.imps(K$P,{"laya.webgl.text.ICharSegment":!0}),K$P.textToSpit=function(K$c){this._sourceStr=K$c},K$P.getChar=function(K$c){return this._sourceStr.charAt(K$c)},K$P.getCharCode=function(K$c){return this._sourceStr.charCodeAt(K$c)},K$P.length=function(){return this._sourceStr.length},K$c}(),K$rc=function(){var K$c;function K$V(){}return K$x(K$V,"laya.webgl.text.DrawText"),K$V.__init__=function(){K$V._charsTemp=new Array,K$V._drawValue=new K$c,K$V._charSeg=new K$xc},K$V.customCharSeg=function(K$c){K$V._charSeg=K$c},K$V.getChar=function(K$c,K$P,K$q){var K$_=K$Xc.createOneChar(K$c,K$q);return-1!=K$P&&(K$V._charsCache[K$P]=K$_),K$_},K$V._drawSlow=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$k,K$x,K$r,K$g){var K$W,K$w,K$O=K$V._drawValue.value(K$b,K$h,K$Z,K$S,K$x,K$r,K$g),K$N=0,K$m=0,K$T=K$V._charsTemp,K$D=0,K$L=NaN;if(K$_)for(K$T.length=K$_.length,K$N=0,K$m=K$_.length;K$N<K$m;K$N++)(K$w=K$_[K$N])&&(K$L=K$w.charNum+K$O.txtID,K$T[K$N]=K$W=K$V._charsCache[K$L]||K$V.getChar(K$w.char,K$L,K$O),K$W.active());else{var K$H=K$q instanceof laya.utils.WordText?K$q.toString():K$q;if(K$C.CharacterCache){K$V._charSeg.textToSpit(K$H);var K$Q=K$V._charSeg.length();for(K$N=0,K$m=K$T.length=K$Q;K$N<K$m;K$N++)K$L=K$V._charSeg.getCharCode(K$N)+K$O.txtID,K$T[K$N]=K$W=K$V._charsCache[K$L]||K$V.getChar(K$V._charSeg.getChar(K$N),K$L,K$O),K$W.active(),K$D+=K$W.cw}else K$T.length=0,(K$W=K$V.getChar(K$H,-1,K$O)).active(),K$D+=K$W.cw,K$T[0]=K$W}var K$d=0;null!==K$e&&"left"!==K$e&&(K$d=-("center"==K$e?K$D/2:K$D));var K$u,K$A,K$J=NaN,K$j=0;if(K$_)for(K$N=0,K$m=K$T.length;K$N<K$m;K$N++)K$W=K$T[K$N],K$w=K$_[K$N],K$W&&K$w&&!K$W.isSpace&&(K$J=K$W.borderSize,K$u=K$W.texture,K$P._drawText(K$u,K$n+K$d+K$w.x*K$x-K$J,K$k+K$w.y*K$r-K$J,K$u.width,K$u.height,K$E,0,0,0,0));else{for(K$N=0,K$m=K$T.length;K$N<K$m;K$N++)(K$W=K$T[K$N])&&!K$W.isSpace&&(K$J=K$W.borderSize,K$u=K$W.texture,K$P._drawText(K$u,K$n+K$d-K$J,K$k-K$J,K$u.width,K$u.height,K$E,0,0,0,0),K$c&&((K$A=K$c[K$j++])||(K$A=K$c[K$j-1]=[]),K$A[0]=K$u,K$A[1]=K$d-K$J,K$A[2]=-K$J)),K$d+=K$W.cw;K$c&&(K$c.length=K$j)}},K$V._drawFast=function(K$c,K$P,K$q,K$_,K$E){for(var K$b,K$e,K$h=0,K$Z=K$c.length;K$h<K$Z;K$h++)(K$b=(K$e=K$c[K$h])[0]).active(),K$P._drawText(K$b,K$_+K$e[1],K$E+K$e[2],K$b.width,K$b.height,K$q,0,0,0,0)},K$V.drawText=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$k){if(void 0===K$k&&(K$k=0),!(K$P&&0===K$P.length||K$q&&0===K$q.length)){var K$x=K$_.a,K$r=K$_.d;(0!==K$_.b||0!==K$_.c)&&(K$x=K$r=1);var K$g=1!==K$x||1!==K$r;if(K$g&&K$L.stage.transform){var K$W=K$L.stage.transform;K$g=K$W.a===K$x&&K$W.d===K$r}else K$g=!1;if(K$g){var K$w=(K$_=K$_.copyTo(K$Hc._tmpMatrix)).tx,K$O=K$_.ty;K$_.scale(1/K$x,1/K$r),K$_._checkTransform(),K$S*=K$x,K$n*=K$r,K$S+=K$w-K$_.tx,K$n+=K$O-K$_.ty}else K$x=K$r=1;if(K$q)K$V._drawSlow(null,K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$x,K$r,K$k);else{if(null===K$P.toUpperCase){var K$N=K$x+1e5*K$r,K$m=K$P;return void(K$m.changed||K$m.id!==K$N?(K$m.id=K$N,K$m.changed=!1,K$V._drawSlow(K$m.save,K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$x,K$r,K$k)):K$V._drawFast(K$m.save,K$c,K$_,K$S,K$n))}var K$T=K$P+K$E.toString()+K$e+K$h+K$Z+K$x+K$r+K$b,K$D=K$V._textsCache[K$T];K$C.CharacterCache?K$D?K$V._drawFast(K$D,K$c,K$_,K$S,K$n):(K$V._textsCache.__length||(K$V._textsCache.__length=0),K$V._textsCache.__length>K$H.WebGLTextCacheCount&&((K$V._textsCache={}).__length=0,K$V._curPoolIndex=0),K$V._textCachesPool[K$V._curPoolIndex]?(K$D=K$V._textsCache[K$T]=K$V._textCachesPool[K$V._curPoolIndex]).length=0:K$V._textCachesPool[K$V._curPoolIndex]=K$D=K$V._textsCache[K$T]=[],K$V._textsCache.__length++,K$V._curPoolIndex++,K$V._drawSlow(K$D,K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$x,K$r,K$k)):K$V._drawSlow(K$D,K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$x,K$r,K$k)}}},K$V._charsTemp=null,K$V._textCachesPool=[],K$V._curPoolIndex=0,K$V._charsCache={},K$V._textsCache={},K$V._drawValue=null,K$V.d=[],K$V._charSeg=null,K$V.__init$=function(){K$c=function(){function K$Z(){}return K$x(K$Z,""),K$Z.prototype.value=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this.font=K$c,this.fillColor=K$P,this.borderColor=K$q,this.lineWidth=K$_,this.scaleX=K$E,this.scaleY=K$b,this.underLine=K$e;var K$h=K$c.toString()+K$E+K$b+K$_+(K$P?K$P.toLowerCase():" ")+(K$q?K$q.toLowerCase():" ")+K$e;return this.txtID=K$Z._keymap[K$h],this.txtID||(this.txtID=1e-7*++K$Z._keymapCount,K$Z._keymap[K$h]=this.txtID),this},K$Z.clear=function(){K$Z._keymap={},K$Z._keymapCount=1},K$Z._keymap={},K$Z._keymapCount=1,K$Z}()},K$V}(),K$gc=function(){function K$E(K$c){this._index=0,this._size=14,this._italic=-2,K$E._cache2=K$E._cache2||[],this.setFont(K$c||"14px Arial")}K$x(K$E,"laya.webgl.text.FontInContext");var K$c=K$E.prototype;return K$c.setFont=function(K$c){var K$P=K$E._cache2[K$c];if(K$P)this._words=K$P[0],this._size=K$P[1];else{this._words=K$c.split(" ");for(var K$q=0,K$_=this._words.length;K$q<K$_;K$q++)if(0<this._words[K$q].indexOf("px")){this._index=K$q;break}this._size=parseInt(this._words[this._index]),K$E._cache2[K$c]=[this._words,this._size]}this._text=null,this._italic=-2},K$c.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},K$c.hasType=function(K$c){for(var K$P=0,K$q=this._words.length;K$P<K$q;K$P++)if(this._words[K$P]===K$c)return K$P;return-1},K$c.removeType=function(K$c){for(var K$P=0,K$q=this._words.length;K$P<K$q;K$P++)if(this._words[K$P]===K$c){this._words.splice(K$P,1),this._index>K$P&&this._index--;break}this._text=null,this._italic=-2},K$c.copyTo=function(K$c){return K$c._text=this._text,K$c._size=this._size,K$c._index=this._index,K$c._words=this._words.slice(),K$c._italic=-2,K$c},K$c.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},K$_(0,K$c,"size",function(){return this._size},function(K$c){this._size=K$c,this._words[this._index]=K$c+"px",this._text=null}),K$E.create=function(K$c){var K$P=K$E._cache[K$c];return K$P||(K$P=K$E._cache[K$c]=new K$E(K$c))},K$E.EMPTY=new K$E,K$E._cache={},K$E._cache2=null,K$E}(),K$Wc=function(){function K$c(){}return K$x(K$c,"laya.webgl.utils.CONST3D2D"),K$c.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],K$c.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],K$c.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],K$c._TMPARRAY=[],K$c._OFFSETX=0,K$c._OFFSETY=0,K$e(K$c,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),K$c}(),K$wc=function(){function K$g(){}return K$x(K$g,"laya.webgl.utils.GlUtils"),K$g.make2DProjection=function(K$c,K$P,K$q){return[2/K$c,0,0,0,0,-2/K$P,0,0,0,0,2/K$q,0,-1,1,0,1]},K$g.fillIBQuadrangle=function(K$c,K$P){if(65535/4<K$P)throw Error("IBQuadrangle count:"+K$P+" must<:"+Math.floor(65535/4));K$P=Math.floor(K$P),K$c._resizeBuffer(6*(K$P+1)*2,!1),K$c.byteLength=K$c.bufferLength;for(var K$q=K$c.getUint16Array(),K$_=0,K$E=0;K$E<K$P;K$E++)K$q[K$_++]=4*K$E,K$q[K$_++]=4*K$E+2,K$q[K$_++]=4*K$E+1,K$q[K$_++]=4*K$E,K$q[K$_++]=4*K$E+3,K$q[K$_++]=4*K$E+2;return K$c.setNeedUpload(),!0},K$g.expandIBQuadrangle=function(K$c,K$P){K$c.bufferLength>=6*K$P*2||K$g.fillIBQuadrangle(K$c,K$P)},K$g.mathCeilPowerOfTwo=function(K$c){return K$c--,K$c|=K$c>>1,K$c|=K$c>>2,K$c|=K$c>>4,K$c|=K$c>>8,K$c|=K$c>>16,++K$c},K$g.fillQuadrangleImgVb=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){var K$Z=16+(K$c._byteLength>>2);K$c.byteLength=K$Z<<2;var K$S=K$c.getFloat32Array();K$S[(K$Z-=16)+2]=K$E[0],K$S[K$Z+3]=K$E[1],K$S[K$Z+6]=K$E[2],K$S[K$Z+7]=K$E[3],K$S[K$Z+10]=K$E[4],K$S[K$Z+11]=K$E[5],K$S[K$Z+14]=K$E[6],K$S[K$Z+15]=K$E[7];var K$n=K$b.a,K$k=K$b.b,K$x=K$b.c,K$r=K$b.d;if(1!==K$n||0!==K$k||0!==K$x||1!==K$r){K$b.bTransform=!0;var K$g=K$b.tx+K$e,K$W=K$b.ty+K$h;K$S[K$Z]=(K$_[0]+K$P)*K$n+(K$_[1]+K$q)*K$x+K$g,K$S[K$Z+1]=(K$_[0]+K$P)*K$k+(K$_[1]+K$q)*K$r+K$W,K$S[K$Z+4]=(K$_[2]+K$P)*K$n+(K$_[3]+K$q)*K$x+K$g,K$S[K$Z+5]=(K$_[2]+K$P)*K$k+(K$_[3]+K$q)*K$r+K$W,K$S[K$Z+8]=(K$_[4]+K$P)*K$n+(K$_[5]+K$q)*K$x+K$g,K$S[K$Z+9]=(K$_[4]+K$P)*K$k+(K$_[5]+K$q)*K$r+K$W,K$S[K$Z+12]=(K$_[6]+K$P)*K$n+(K$_[7]+K$q)*K$x+K$g,K$S[K$Z+13]=(K$_[6]+K$P)*K$k+(K$_[7]+K$q)*K$r+K$W}else K$b.bTransform=!1,K$P+=K$b.tx+K$e,K$q+=K$b.ty+K$h,K$S[K$Z]=K$P+K$_[0],K$S[K$Z+1]=K$q+K$_[1],K$S[K$Z+4]=K$P+K$_[2],K$S[K$Z+5]=K$q+K$_[3],K$S[K$Z+8]=K$P+K$_[4],K$S[K$Z+9]=K$q+K$_[5],K$S[K$Z+12]=K$P+K$_[6],K$S[K$Z+13]=K$q+K$_[7];return K$c._upload=!0},K$g.fillTranglesVB=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){var K$h=(K$c._byteLength>>2)+K$_.length;K$c.byteLength=K$h<<2;var K$Z=K$c.getFloat32Array();K$h-=K$_.length;for(var K$S=K$_.length,K$n=K$E.a,K$k=K$E.b,K$x=K$E.c,K$r=K$E.d,K$g=0;K$g<K$S;K$g+=4)if(K$Z[K$h+K$g+2]=K$_[K$g+2],K$Z[K$h+K$g+3]=K$_[K$g+3],1!==K$n||0!==K$k||0!==K$x||1!==K$r){K$E.bTransform=!0;var K$W=K$E.tx+K$b,K$w=K$E.ty+K$e;K$Z[K$h+K$g]=(K$_[K$g]+K$P)*K$n+(K$_[K$g+1]+K$q)*K$x+K$W,K$Z[K$h+K$g+1]=(K$_[K$g]+K$P)*K$k+(K$_[K$g+1]+K$q)*K$r+K$w}else K$E.bTransform=!1,K$P+=K$E.tx+K$b,K$q+=K$E.ty+K$e,K$Z[K$h+K$g]=K$P+K$_[K$g],K$Z[K$h+K$g+1]=K$q+K$_[K$g+1];return K$c._upload=!0},K$g.copyPreImgVb=function(K$c,K$P,K$q){var K$_=K$c._byteLength>>2;K$c.byteLength=K$_+16<<2;for(var K$E=K$c.getFloat32Array(),K$b=0,K$e=K$_-16;K$b<4;K$b++)K$E[K$_]=K$E[K$e]+K$P,++K$e,K$E[++K$_]=K$E[K$e]+K$q,++K$e,K$E[++K$_]=K$E[K$e],++K$e,K$E[++K$_]=K$E[K$e],++K$_,++K$e;K$c._upload=!0},K$g.fillRectImgVb=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$k,K$x){void 0===K$x&&(K$x=!1);var K$r,K$g,K$W,K$w,K$O,K$N,K$m,K$T,K$D,K$L,K$H,K$Q,K$d,K$u,K$A,K$J,K$j=1,K$V=K$h.a,K$R=K$h.b,K$$=K$h.c,K$C=K$h.d,K$F=K$P&&K$P.width<99999999;if(1!==K$V||0!==K$R||0!==K$$||1!==K$C?(K$h.bTransform=!0,0===K$R&&0===K$$&&(K$j=23,K$D=K$E+K$q,K$L=K$b+K$_,K$r=K$V*K$q+(K$H=K$h.tx+K$Z),K$W=K$V*K$D+K$H,K$g=K$C*K$_+(K$Q=K$h.ty+K$S),K$w=K$C*K$L+K$Q)):(K$j=23,K$h.bTransform=!1,K$W=(K$r=K$q+K$h.tx+K$Z)+K$E,K$w=(K$g=K$_+K$h.ty+K$S)+K$b),K$F&&(K$O=K$P.x,K$N=K$P.y,K$m=K$P.width+K$O,K$T=K$P.height+K$N),1!==K$j){if(Math.min(K$r,K$W)>=K$m)return!1;if(Math.min(K$g,K$w)>=K$T)return!1;if(Math.max(K$W,K$r)<=K$O)return!1;if(Math.max(K$w,K$g)<=K$N)return!1}var K$o=K$c._byteLength>>2;K$c.byteLength=16+K$o<<2;var K$a=K$c.getFloat32Array();switch(K$a[2+K$o]=K$e[0],K$a[3+K$o]=K$e[1],K$a[6+K$o]=K$e[2],K$a[7+K$o]=K$e[3],K$a[10+K$o]=K$e[4],K$a[11+K$o]=K$e[5],K$a[14+K$o]=K$e[6],K$a[15+K$o]=K$e[7],K$j){case 1:K$H=K$h.tx+K$Z,K$Q=K$h.ty+K$S;var K$Y=K$V*K$q,K$s=K$$*K$_,K$U=K$C*K$_,K$I=K$R*K$q,K$v=K$V*(K$D=K$E+K$q),K$y=K$$*(K$L=K$b+K$_),K$M=K$C*K$L,K$z=K$R*K$D;K$x?(K$d=K$Y+K$s+K$H,K$A=Math.round(K$d)-K$d,K$u=K$U+K$I+K$Q,K$J=Math.round(K$u)-K$u,K$a[K$o]=K$d+K$A,K$a[1+K$o]=K$u+K$J,K$a[4+K$o]=K$v+K$s+K$H+K$A,K$a[5+K$o]=K$U+K$z+K$Q+K$J,K$a[8+K$o]=K$v+K$y+K$H+K$A,K$a[9+K$o]=K$M+K$z+K$Q+K$J,K$a[12+K$o]=K$Y+K$y+K$H+K$A,K$a[13+K$o]=K$M+K$I+K$Q+K$J):(K$a[K$o]=K$Y+K$s+K$H,K$a[1+K$o]=K$U+K$I+K$Q,K$a[4+K$o]=K$v+K$s+K$H,K$a[5+K$o]=K$U+K$z+K$Q,K$a[8+K$o]=K$v+K$y+K$H,K$a[9+K$o]=K$M+K$z+K$Q,K$a[12+K$o]=K$Y+K$y+K$H,K$a[13+K$o]=K$M+K$I+K$Q);break;case 23:K$x?(K$d=K$r+K$n,K$A=Math.round(K$d)-K$d,K$u=K$g,K$J=Math.round(K$u)-K$u,K$a[K$o]=K$d+K$A,K$a[1+K$o]=K$u+K$J,K$a[4+K$o]=K$W+K$n+K$A,K$a[5+K$o]=K$g+K$J,K$a[8+K$o]=K$W+K$A,K$a[9+K$o]=K$w+K$J,K$a[12+K$o]=K$r+K$A,K$a[13+K$o]=K$w+K$J):(K$a[K$o]=K$r+K$n,K$a[1+K$o]=K$g,K$a[4+K$o]=K$W+K$n,K$a[5+K$o]=K$g,K$a[8+K$o]=K$W,K$a[9+K$o]=K$w,K$a[12+K$o]=K$r,K$a[13+K$o]=K$w)}return K$c._upload=!0},K$g.fillLineVb=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){var K$Z=.5*K$e,K$S=K$g._fillLineArray,K$n=-(K$_-K$b),K$k=K$q-K$E,K$x=Math.sqrt(K$n*K$n+K$k*K$k);K$n/=K$x,K$k/=K$x,K$n*=K$Z,K$k*=K$Z,K$S[0]=K$q-K$n,K$S[1]=K$_-K$k,K$S[4]=K$q+K$n,K$S[5]=K$_+K$k,K$S[8]=K$E+K$n,K$S[9]=K$b+K$k,K$S[12]=K$E-K$n,K$S[13]=K$b-K$k,K$h&&K$h.transformPointArray(K$S,K$S);var K$r=16+(K$c._byteLength>>2);return K$c.byteLength=K$r<<2,K$c.insertData(K$S,K$r-16),!0},K$g._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],K$g}(),K$Oc=(function(){function K$Z(){}K$x(K$Z,"laya.webgl.utils.MatirxArray"),K$Z.ArrayMul=function(K$c,K$P,K$q){if(K$c)if(K$P)for(var K$_=NaN,K$E=NaN,K$b=NaN,K$e=NaN,K$h=0;K$h<4;K$h++)K$_=K$c[K$h],K$E=K$c[K$h+4],K$b=K$c[K$h+8],K$e=K$c[K$h+12],K$q[K$h]=K$_*K$P[0]+K$E*K$P[1]+K$b*K$P[2]+K$e*K$P[3],K$q[K$h+4]=K$_*K$P[4]+K$E*K$P[5]+K$b*K$P[6]+K$e*K$P[7],K$q[K$h+8]=K$_*K$P[8]+K$E*K$P[9]+K$b*K$P[10]+K$e*K$P[11],K$q[K$h+12]=K$_*K$P[12]+K$E*K$P[13]+K$b*K$P[14]+K$e*K$P[15];else K$Z.copyArray(K$c,K$q);else K$Z.copyArray(K$P,K$q)},K$Z.copyArray=function(K$c,K$P){if(K$c&&K$P)for(var K$q=0;K$q<K$c.length;K$q++)K$P[K$q]=K$c[K$q]}}(),function(){function K$P(K$c,K$P,K$q){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=K$c,this._vb=new K$Gc(K$c,35048),K$P&&this._vb._resizeBuffer(K$P,!1),this._ib=new K$Kc,K$q&&this._ib._resizeBuffer(K$q,!1)}K$x(K$P,"laya.webgl.utils.Mesh2D");var K$c=K$P.prototype;return K$c.cloneWithNewVB=function(){var K$c=new K$P(this._stride,0,0);return K$c._ib=this._ib,K$c._quadNum=this._quadNum,K$c._attribInfo=this._attribInfo,K$c},K$c.cloneWithNewVBIB=function(){var K$c=new K$P(this._stride,0,0);return K$c._attribInfo=this._attribInfo,K$c},K$c.getVBW=function(){return this._vb.setNeedUpload(),this._vb},K$c.getVBR=function(){return this._vb},K$c.getIBR=function(){return this._ib},K$c.getIBW=function(){return this._ib.setNeedUpload(),this._ib},K$c.createQuadIB=function(K$c){this._quadNum=K$c,this._ib._resizeBuffer(6*K$c*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var K$P=this._ib.getUint16Array(),K$q=0,K$_=0,K$E=0;K$E<K$c;K$E++)K$P[K$q++]=K$_,K$P[K$q++]=K$_+2,K$P[K$q++]=K$_+1,K$P[K$q++]=K$_,K$P[K$q++]=K$_+3,K$P[K$q++]=K$_+2,K$_+=4;this._ib.setNeedUpload()},K$c.setAttributes=function(K$c){if(this._attribInfo=K$c,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},K$c.getEleNum=function(){return this._ib.getBuffer().byteLength/2},K$c.releaseMesh=function(){},K$c.destroy=function(){},K$c.clearVB=function(){this._vb.clear()},K$P._gvaoid=0,K$P}()),K$Nc=function(){function K$E(){}return K$x(K$E,"laya.webgl.utils.RenderState2D"),K$E.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},K$E.mat2MatArray=function(K$c,K$P){var K$q=K$c,K$_=K$P;return K$_[0]=K$q.a,K$_[1]=K$q.b,K$_[2]=K$E.EMPTYMAT4_ARRAY[2],K$_[3]=K$E.EMPTYMAT4_ARRAY[3],K$_[4]=K$q.c,K$_[5]=K$q.d,K$_[6]=K$E.EMPTYMAT4_ARRAY[6],K$_[7]=K$E.EMPTYMAT4_ARRAY[7],K$_[8]=K$E.EMPTYMAT4_ARRAY[8],K$_[9]=K$E.EMPTYMAT4_ARRAY[9],K$_[10]=K$E.EMPTYMAT4_ARRAY[10],K$_[11]=K$E.EMPTYMAT4_ARRAY[11],K$_[12]=K$q.tx,K$_[13]=K$q.ty,K$_[14]=K$E.EMPTYMAT4_ARRAY[14],K$_[15]=K$E.EMPTYMAT4_ARRAY[15],K$P},K$E.restoreTempArray=function(){K$E.TEMPMAT4_ARRAY[0]=1,K$E.TEMPMAT4_ARRAY[1]=0,K$E.TEMPMAT4_ARRAY[4]=0,K$E.TEMPMAT4_ARRAY[5]=1,K$E.TEMPMAT4_ARRAY[12]=0,K$E.TEMPMAT4_ARRAY[13]=0},K$E.clear=function(){K$E.worldScissorTest=!1,K$E.worldShaderDefines=null,K$E.worldFilters=null,K$E.worldAlpha=1,K$E.worldClipRect.x=K$E.worldClipRect.y=0,K$E.worldClipRect.width=K$E.width,K$E.worldClipRect.height=K$E.height,K$E.curRenderTarget=null},K$E._MAXSIZE=99999999,K$E.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],K$E.worldMatrix4=K$E.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],K$E.worldAlpha=1,K$E.worldScissorTest=!1,K$E.worldFilters=null,K$E.worldShaderDefines=null,K$E.curRenderTarget=null,K$E.width=0,K$E.height=0,K$e(K$E,["worldMatrix",function(){return this.worldMatrix=new K$d},"worldClipRect",function(){return this.worldClipRect=new K$A(0,0,99999999,99999999)}]),K$E}(),K$mc=function(){var K$N,K$q;function K$m(K$c,K$P,K$q,K$_,K$E){var K$b=this;function K$e(K$c){var K$P=[],K$q=new K$N(K$P);return K$b._compileToTree(K$q,K$c.split("\n"),0,K$P,K$E),K$q}var K$h=K$r.now();this._VS=K$e(K$P),this._PS=K$e(K$q),this._nameMap=K$_,2<K$r.now()-K$h&&console.log("ShaderCompile use time:"+(K$r.now()-K$h)+"  size:"+K$P.length+"/"+K$q.length)}K$x(K$m,"laya.webgl.utils.ShaderCompile");var K$c=K$m.prototype;return K$c._compileToTree=function(K$c,K$P,K$q,K$_,K$E){var K$b,K$e,K$h,K$Z,K$S,K$n,K$k,K$x=0,K$r=0,K$g=0,K$W=0;for(K$r=K$q;K$r<K$P.length;K$r++)if(!((K$h=K$P[K$r]).length<1)&&0!==(K$x=K$h.indexOf("//"))){if(0<=K$x&&(K$h=K$h.substr(0,K$x)),K$b=K$k||new K$N(K$_),K$k=null,K$b.text=K$h,K$b.noCompile=!0,0<=(K$x=K$h.indexOf("#"))){for(K$Z="#",K$W=K$x+1,K$g=K$h.length;K$W<K$g;K$W++){var K$w=K$h.charAt(K$W);if(" "===K$w||"\t"===K$w||"\r"===K$w||"\n"===K$w||"?"===K$w)break;K$Z+=K$w}switch(K$b.name=K$Z){case"#ifdef":case"#ifndef":if(K$b.src=K$h,K$b.noCompile=null!=K$h.match(/[!&|()=<>]/),K$b.noCompile?console.log("function():Boolean{return "+K$h.substr(K$x+K$b.name.length)+"}"):(K$n=K$h.replace(/^\s*/,"").split(/\s+/),K$b.setCondition(K$n[1],"#ifdef"===K$Z?1:2),K$b.text="//"+K$b.text),K$b.setParent(K$c),K$c=K$b,K$E)for(K$n=K$h.substr(K$W).split(K$m._splitToWordExps3),K$W=0;K$W<K$n.length;K$W++)(K$h=K$n[K$W]).length&&(K$E[K$h]=!0);continue;case"#if":if(K$b.src=K$h,K$b.noCompile=!0,K$b.setParent(K$c),K$c=K$b,K$E)for(K$n=K$h.substr(K$W).split(K$m._splitToWordExps3),K$W=0;K$W<K$n.length;K$W++)(K$h=K$n[K$W]).length&&"defined"!=K$h&&(K$E[K$h]=!0);continue;case"#else":K$b.src=K$h,K$e=(K$c=K$c.parent).childs[K$c.childs.length-1],K$b.noCompile=K$e.noCompile,K$b.noCompile||(K$b.condition=K$e.condition,K$b.conditionType=1==K$e.conditionType?2:1,K$b.text="//"+K$b.text+" "+K$e.text+" "+K$b.conditionType),K$b.setParent(K$c),K$c=K$b;continue;case"#endif":K$e=(K$c=K$c.parent).childs[K$c.childs.length-1],K$b.noCompile=K$e.noCompile,K$b.noCompile||(K$b.text="//"+K$b.text),K$b.setParent(K$c);continue;case"#include":K$n=K$m.splitToWords(K$h,null);var K$O=K$m.includes[K$n[1]];if(!K$O)throw"ShaderCompile error no this include file:"+K$n[1];if((K$x=K$n[0].indexOf("?"))<0){K$b.setParent(K$c),K$h=K$O.getWith("with"==K$n[2]?K$n[3]:null),this._compileToTree(K$b,K$h.split("\n"),0,K$_,K$E),K$b.text="";continue}K$b.setCondition(K$n[0].substr(K$x+1),1),K$b.text=K$O.getWith("with"==K$n[2]?K$n[3]:null);break;case"#import":K$S=(K$n=K$m.splitToWords(K$h,null))[1],K$_.push({node:K$b,file:K$m.includes[K$S],ofs:K$b.text.length});continue}}else{if((K$e=K$c.childs[K$c.childs.length-1])&&!K$e.name){0<K$_.length&&K$m.splitToWords(K$h,K$e),K$k=K$b,K$e.text+="\n"+K$h;continue}0<K$_.length&&K$m.splitToWords(K$h,K$b)}K$b.setParent(K$c)}},K$c.createShader=function(K$c,K$P,K$q){var K$_={},K$E="";if(K$c)for(var K$b in K$c)K$E+="#define "+K$b+"\n",K$_[K$b]=!0;var K$e=this._VS.toscript(K$_,[]),K$h=this._PS.toscript(K$_,[]);return(K$q||K$tc.create)(K$E+K$e.join("\n"),K$E+K$h.join("\n"),K$P,this._nameMap)},K$m._parseOne=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e={type:K$m.shaderParamsMap[K$q[K$_+1]],name:K$q[K$_+2],size:isNaN(parseInt(K$q[K$_+3]))?1:parseInt(K$q[K$_+3])};return K$b&&("attribute"==K$E?K$c.push(K$e):K$P.push(K$e)),":"==K$q[K$_+3]&&(K$e.type=K$q[K$_+4],K$_+=2),K$_+=2},K$m.addInclude=function(K$c,K$P){if(!K$P||0===K$P.length)throw new Error("add shader include file err:"+K$c);if(K$m.includes[K$c])throw new Error("add shader include file err, has add:"+K$c);K$m.includes[K$c]=new K$q(K$P)},K$m.preGetParams=function(K$c,K$P){var K$q=[K$c,K$P],K$_={},K$E=[],K$b=[],K$e={},K$h=[];K$_.attributes=K$E,K$_.uniforms=K$b,K$_.defines=K$e;for(var K$Z=0,K$S=0,K$n=0;K$n<2;K$n++){K$q[K$n]=K$q[K$n].replace(K$m._removeAnnotation,"");var K$k,K$x=K$q[K$n].match(K$m._reg);for(K$Z=0,K$S=K$x.length;K$Z<K$S;K$Z++){var K$r=K$x[K$Z];if("attribute"==K$r||"uniform"==K$r)K$Z=K$m._parseOne(K$E,K$b,K$x,K$Z,K$r,!0);else{if("#define"==K$r){K$h[K$r=K$x[++K$Z]]=1;continue}if("#ifdef"==K$r){K$e[K$k=K$x[++K$Z]]=K$e[K$k]||[];for(K$Z++;K$Z<K$S;K$Z++)if("attribute"==(K$r=K$x[K$Z])||"uniform"==K$r)K$Z=K$m._parseOne(K$E,K$b,K$x,K$Z,K$r,K$h[K$k]);else if("#else"==K$r)for(K$Z++;K$Z<K$S;K$Z++)if("attribute"==(K$r=K$x[K$Z])||"uniform"==K$r)K$Z=K$m._parseOne(K$E,K$b,K$x,K$Z,K$r,!K$h[K$k]);else if("#endif"==K$r)break}}}}return K$_},K$m.splitToWords=function(K$c,K$P){for(var K$q,K$_,K$E=[],K$b=-1,K$e=0,K$h=K$c.length;K$e<K$h;K$e++)if(K$q=K$c.charAt(K$e),0<=" \t=+-*/&%!<>()'\",;".indexOf(K$q)){if(0<=K$b&&1<K$e-K$b&&(K$_=K$c.substr(K$b,K$e-K$b),K$E.push(K$_)),'"'==K$q||"'"==K$q){var K$Z=K$c.indexOf(K$q,K$e+1);if(K$Z<0)throw"Sharder err:"+K$c;K$E.push(K$c.substr(K$e+1,K$Z-K$e-1)),K$e=K$Z,K$b=-1;continue}"("==K$q&&K$P&&0<K$E.length&&(K$_=K$E[K$E.length-1]+";","vec4;main;".indexOf(K$_)<0&&(K$P.useFuns+=K$_)),K$b=-1}else K$b<0&&(K$b=K$e);return K$b<K$h&&1<K$h-K$b&&(K$_=K$c.substr(K$b,K$h-K$b),K$E.push(K$_)),K$E},K$m.IFDEF_NO=0,K$m.IFDEF_YES=1,K$m.IFDEF_ELSE=2,K$m.IFDEF_PARENT=3,K$m._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),K$m._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),K$m._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),K$m.includes={},K$e(K$m,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),K$m.__init$=function(){K$N=function(){function K$q(K$c){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=K$c}K$x(K$q,"");var K$c=K$q.prototype;return K$c.setParent=function(K$c){K$c.childs.push(this),this.z=K$c.z+1,this.parent=K$c},K$c.setCondition=function(K$c,K$P){K$c&&(this.conditionType=K$P,K$c=K$c.replace(/(\s*$)/g,""),this.condition=function(){return this[K$c]},this.condition.__condition=K$c)},K$c.toscript=function(K$c,K$P){return this._toscript(K$c,K$P,++K$q.__id)},K$c._toscript=function(K$_,K$E,K$b){if(this.childs.length<1&&!this.text)return K$E;K$E.length;if(this.condition){var K$c=!!this.condition.call(K$_);if(2===this.conditionType&&(K$c=!K$c),!K$c)return K$E}if(this.text&&K$E.push(this.text),0<this.childs.length&&this.childs.forEach(function(K$c,K$P,K$q){K$c._toscript(K$_,K$E,K$b)}),0<this.includefiles.length&&0<this.useFuns.length)for(var K$P,K$q=0,K$e=this.includefiles.length;K$q<K$e;K$q++)this.includefiles[K$q].curUseID!=K$b&&0<(K$P=this.includefiles[K$q].file.getFunsScript(this.useFuns)).length&&(this.includefiles[K$q].curUseID=K$b,K$E[0]=K$P+K$E[0]);return K$E},K$q.__id=1,K$q}(),K$q=function(){function K$c(K$c){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=K$c;for(var K$P=0,K$q=0,K$_=0;!((K$P=K$c.indexOf("#begin",K$P))<0);){for(K$_=K$P+5;!((K$_=K$c.indexOf("#end",K$_))<0)&&"i"===K$c.charAt(K$_+4);)K$_+=5;if(K$_<0)throw"add include err,no #end:"+K$c;K$q=K$c.indexOf("\n",K$P);var K$E=K$m.splitToWords(K$c.substr(K$P,K$q-K$P),null);"code"==K$E[1]?this.codes[K$E[2]]=K$c.substr(K$q+1,K$_-K$q-1):"function"==K$E[1]&&(K$q=K$c.indexOf("function",K$P),K$q+="function".length,this.funs[K$E[3]]=K$c.substr(K$q+1,K$_-K$q-1),this.funnames+=K$E[3]+";"),K$P=K$_+1}}K$x(K$c,"");var K$P=K$c.prototype;return K$P.getWith=function(K$c){var K$P=K$c?this.codes[K$c]:this.script;if(!K$P)throw"get with error:"+K$c;return K$P},K$P.getFunsScript=function(K$c){var K$P="";for(var K$q in this.funs)0<=K$c.indexOf(K$q+";")&&(K$P+=this.funs[K$q]);return K$P},K$c}()},K$m}(),K$Tc=function(){function K$e(){}return K$x(K$e,"laya.webgl.WebGL"),K$e._uint8ArraySlice=function(){for(var K$c=this.length,K$P=new Uint8Array(this.length),K$q=0;K$q<K$c;K$q++)K$P[K$q]=this[K$q];return K$P},K$e._float32ArraySlice=function(){for(var K$c=this.length,K$P=new Float32Array(this.length),K$q=0;K$q<K$c;K$q++)K$P[K$q]=this[K$q];return K$P},K$e._uint16ArraySlice=function(K$c){var K$P,K$q=arguments,K$_=0,K$E=0;if(0===K$q.length)for(K$_=this.length,K$P=new Uint16Array(K$_),K$E=0;K$E<K$_;K$E++)K$P[K$E]=this[K$E];else if(2===K$q.length){var K$b=K$q[0],K$e=K$q[1];if(K$b<K$e)for(K$_=K$e-K$b,K$P=new Uint16Array(K$_),K$E=K$b;K$E<K$e;K$E++)K$P[K$E-K$b]=this[K$E];else K$P=new Uint16Array(0)}return K$P},K$e.expandContext=function(){var K$c=K$E.prototype,K$P=CanvasRenderingContext2D.prototype;K$P.fillTrangles=K$c.fillTrangles,K$Bc.__int__(null),K$P.setIBVB=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){void 0===K$Z&&(K$Z=0),void 0===K$S&&(K$S=0),null===K$q&&(this._ib=this._ib||K$Kc.QuadrangleIB,K$q=this._ib,K$wc.expandIBQuadrangle(K$q,K$_._byteLength/64+8)),this._setIBVB(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S)},K$P.fillTrangles=function(K$c,K$P,K$q,K$_,K$E){this._curMat=this._curMat||K$d.create(),this._vb=this._vb||K$Gc.create(),this._ib||(this._ib=K$Kc.create(),K$wc.fillIBQuadrangle(this._ib,K$e/4));var K$b=this._vb,K$e=K$_.length>>4;K$wc.fillTranglesVB(K$b,K$P,K$q,K$_,K$E||this._curMat,0,0),K$wc.expandIBQuadrangle(this._ib,K$b._byteLength/64+8);var K$h=new K$Qc(1,0);K$h.textureHost=K$c;var K$Z=new K$ic("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");K$b._vertType=3,this._setIBVB(K$P,K$q,this._ib,K$b,6*K$e,K$E,K$Z,K$h,0,0)}},K$e.enable=function(){if(K$r.__init__(),K$O.isConchApp&&!K$O.isConchWebGL)return K$D.skinAniSprite=function(){return new K$cc},K$e.expandContext(),!1;if(K$D.getWebGLContext=function(K$c){for(var K$P,K$q=["webgl","experimental-webgl","webkit-3d","moz-webgl"],K$_=0;K$_<K$q.length;K$_++){try{K$P=K$c.getContext(K$q[K$_],{stencil:K$H.isStencil,alpha:K$H.isAlpha,antialias:K$H.isAntialias,premultipliedAlpha:K$H.premultipliedAlpha,preserveDrawingBuffer:K$H.preserveDrawingBuffer})}catch(K$c){}if(K$P)return K$P}return null},null==(K$e.mainContext=K$e.mainContext||K$D.getWebGLContext(K$O._mainCanvas)))return!1;if(K$O.isWebGL)return!0;K$W.create=function(K$c,K$P){return new K$cP(K$c,K$P)},K$w.create=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){return new K$lc(K$c,K$P,K$q,K$_,K$E,K$b,K$e)},K$O.WebGL=K$e,K$O.isWebGL=!0,K$rc.__init__(),K$D.createRenderSprite=function(K$c,K$P){return new K$dc(K$c,K$P)},K$D.createWebGLContext2D=function(K$c){return new K$Hc(K$c)},K$D.changeWebGLSize=function(K$c,K$P){laya.webgl.WebGL.onStageResize(K$c,K$P)},K$D.createGraphics=function(){return new K$Lc};var K$c=K$D.createFilterAction;return K$D.createFilterAction=K$c||function(K$c){return new K$uc},K$D.clear=function(K$c){K$Nc.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var K$P=K$O.context.ctx,K$q=0==K$P._submits._length||K$H.preserveDrawingBuffer?K$g.create(K$c)._color:K$j._wgColor;K$q&&K$P.clearBG(K$q[0],K$q[1],K$q[2],K$q[3]),K$Nc.clear()},K$D.addToAtlas=function(K$c,K$P){void 0===K$P&&(K$P=!1);var K$q=K$c.bitmap;K$O.optimizeTextureMemory(K$c.url,K$c)?K$L.__typeof(K$q,"laya.webgl.resource.IMergeAtlasBitmap")&&K$q.allowMerageInAtlas&&K$q.on("recovered",K$c,K$c.addTextureToAtlas):K$q.enableMerageInAtlas=!1},K$D.isAtlas=function(K$c){return K$c instanceof laya.webgl.atlas.AtlasWebGLCanvas},K$I._enable(),K$D.beginFlush=function(){for(var K$c=K$I.instance,K$P=K$c.getAtlaserCount(),K$q=0;K$q<K$P;K$q++){var K$_=K$c.getAtlaserByIndex(K$q).texture;K$_._flashCacheImageNeedFlush&&K$D.flashFlushImage(K$_)}},K$D.drawToCanvas=function(K$c,K$P,K$q,K$_,K$E,K$b){(K$q<=0||K$_<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),K$q|=0,K$_|=0,K$E|=0,K$b|=0;var K$e=K$ac.create(K$q,K$_,6408,5121,0,!1);K$e.start(),K$e.clear(0,0,0,0),K$O.context.clear(),K$N.renders[K$P]._fun(K$c,K$O.context,K$E,K$Nc.height-K$_+K$b),K$O.context.flush(),K$e.end();var K$h=K$e.getData(0,0,K$q,K$_);if(K$e.recycle(),K$h.byteLength==K$q*K$_*4){var K$Z=new K$zc;K$Z._canvas=K$r.createElement("canvas"),K$Z.size(K$q,K$_);var K$S=K$Z._canvas.getContext("2d");K$r.canvas.size(K$q,K$_);var K$n=K$r.context,K$k=K$n.createImageData(K$q,K$_);return K$k.data.set(new Uint8ClampedArray(K$h.buffer)),K$Z._imgData=K$k,K$n.putImageData(K$k,0,0),K$S.save(),K$S.translate(0,K$_),K$S.scale(1,-1),K$S.drawImage(K$r.canvas.source,0,0),K$S.restore(),K$Z}console.log("drawToCanvas error: w:"+K$q+",h:"+K$_+",datalen:"+K$h.byteLength)},K$D.createFilterAction=function(K$c){var K$P;switch(K$c){case 32:K$P=new K$uc}return K$P},K$D.addTextureToAtlas=function(K$c){K$c._uvID++,K$I._atlasRestore++,K$c.bitmap.enableMerageInAtlas&&K$I.instance.addToAtlas(K$c)},K$D.getTexturePixels=function(K$c,K$P,K$q,K$_,K$E){K$O.context.ctx.clear();var K$b=new K$J;K$b.graphics.drawTexture(K$c,-K$P,-K$q);var K$e=K$ac.create(K$_,K$E);K$e.start(),K$e.clear(0,0,0,0),K$b.render(K$O.context,0,0),K$O.context.ctx.flush(),K$e.end();for(var K$h=K$e.getData(0,0,K$_,K$E),K$Z=[],K$S=0,K$n=K$E-1;0<=K$n;K$n--)for(var K$k=0;K$k<K$_;K$k++)K$S=4*(K$n*K$_+K$k),K$Z.push(K$h[K$S]),K$Z.push(K$h[K$S+1]),K$Z.push(K$h[K$S+2]),K$Z.push(K$h[K$S+3]);return K$Z},K$D.skinAniSprite=function(){return new K$cc},K$S.create=function(K$c,K$P){var K$q=new K$zc;return K$q._imgData=K$P,K$q.flipY=!1,K$q},K$Q._filterStart=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$c.getValue("bounds"),K$e=K$ac.create(K$b.width,K$b.height);if(K$e.start(),K$e.clear(0,0,0,0),K$c.addValue("src",K$e),K$c.addValue("ScissorTest",K$Nc.worldScissorTest),K$Nc.worldScissorTest){var K$h=new K$A;K$h.copyFrom(K$q.ctx._clipRect),K$c.addValue("clipRect",K$h),K$Nc.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},K$Q._filterEnd=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$c.getValue("bounds");K$c.getValue("src").end();var K$e=K$ac.create(K$b.width,K$b.height);K$e.start(),K$e.clear(0,0,0,0),K$c.addValue("out",K$e),K$P._set$P("_filterCache",K$e),K$P._set$P("_isHaveGlowFilter",K$c.getValue("_isHaveGlowFilter"))},K$Q._EndTarget=function(K$c,K$P){if(K$c.getValue("src").recycle(),K$c.getValue("out").end(),K$c.getValue("ScissorTest")){K$Nc.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),K$P.ctx.save();var K$q=K$c.getValue("clipRect");K$P.ctx.clipRect(K$q.x,K$q.y,K$q.width,K$q.height)}},K$Q._useSrc=function(K$c){var K$P=K$c.getValue("out");K$P.end(),(K$P=K$c.getValue("src")).start(),K$P.clear(0,0,0,0)},K$Q._endSrc=function(K$c){K$c.getValue("src").end()},K$Q._useOut=function(K$c){var K$P=K$c.getValue("src");K$P.end(),(K$P=K$c.getValue("out")).start(),K$P.clear(0,0,0,0)},K$Q._endOut=function(K$c){K$c.getValue("out").end()},K$Q._recycleScope=function(K$c){K$c.recycle()},K$Q._filter=function(K$c,K$P,K$q,K$_){var K$E=this._next;if(K$E){var K$b,K$e,K$h=K$c.filters,K$Z=K$h.length;if(1==K$Z&&32==K$h[0].type)return K$P.ctx.save(),K$P.ctx.setFilters([K$h[0]]),K$E._fun.call(K$E,K$c,K$P,K$q,K$_),void K$P.ctx.restore();var K$S=K$hc.create(),K$n=K$u.TEMP,K$k=K$P.ctx._getTransformMatrix(),K$x=K$d.create();K$k.copyTo(K$x);var K$r=0,K$g=0,K$W=!1,K$w=K$c._$P._filterCache?K$c._$P._filterCache:null;if(!K$w||K$c._repaint){K$W=K$c._isHaveGlowFilter(),K$S.addValue("_isHaveGlowFilter",K$W),K$W&&(K$r=50,K$g=25),(K$e=new K$A).copyFrom(K$c.getSelfBounds()),K$e.x+=K$c.x,K$e.y+=K$c.y,K$e.x-=K$c.pivotX+4,K$e.y-=K$c.pivotY+4;var K$O=K$e.x,K$N=K$e.y;if(K$e.width+=K$r+8,K$e.height+=K$r+8,K$n.x=K$e.x*K$x.a+K$e.y*K$x.c,K$n.y=K$e.y*K$x.d+K$e.x*K$x.b,K$e.x=K$n.x,K$e.y=K$n.y,K$n.x=K$e.width*K$x.a+K$e.height*K$x.c,K$n.y=K$e.height*K$x.d+K$e.width*K$x.b,K$e.width=K$n.x,K$e.height=K$n.y,K$e.width<=0||K$e.height<=0)return;K$w&&K$w.recycle(),K$S.addValue("bounds",K$e);var K$m=K$ec.create([K$S,K$c,K$P,0,0],K$Q._filterStart);K$P.addRenderObject(K$m),K$P.ctx._renderKey=0,K$P.ctx._shader2D.glTexture=null;var K$T=K$c.x-K$O+K$g,K$D=K$c.y-K$N+K$g;K$E._fun.call(K$E,K$c,K$P,K$T,K$D),K$m=K$ec.create([K$S,K$c,K$P,0,0],K$Q._filterEnd),K$P.addRenderObject(K$m);for(var K$L=0;K$L<K$Z;K$L++){0!=K$L&&(K$m=K$ec.create([K$S],K$Q._useSrc),K$P.addRenderObject(K$m),K$b=K$Qc.create(1,0),K$d.TEMP.identity(),K$P.ctx.drawTarget(K$S,0,0,K$e.width,K$e.height,K$d.TEMP,"out",K$b,null,K$y.TOINT.overlay),K$m=K$ec.create([K$S],K$Q._useOut),K$P.addRenderObject(K$m)),K$h[K$L].action.apply3d(K$S,K$c,K$P,0,0)}K$m=K$ec.create([K$S,K$P],K$Q._EndTarget),K$P.addRenderObject(K$m)}else{if((K$W=!!K$c._$P._isHaveGlowFilter&&K$c._$P._isHaveGlowFilter)&&(K$r=50,K$g=25),(K$e=K$c.getBounds()).width<=0||K$e.height<=0)return;K$e.width+=K$r,K$e.height+=K$r,K$n.x=K$e.x*K$x.a+K$e.y*K$x.c,K$n.y=K$e.y*K$x.d+K$e.x*K$x.b,K$e.x=K$n.x,K$e.y=K$n.y,K$n.x=K$e.width*K$x.a+K$e.height*K$x.c,K$n.y=K$e.height*K$x.d+K$e.width*K$x.b,K$e.width=K$n.x,K$e.height=K$n.y,K$S.addValue("out",K$w)}K$q=K$q-K$g-K$c.x,K$_=K$_-K$g-K$c.y,K$n.setTo(K$q,K$_),K$x.transformPoint(K$n),K$q=K$n.x+K$e.x,K$_=K$n.y+K$e.y,K$b=K$Qc.create(1,0),K$d.TEMP.identity(),K$P.ctx.drawTarget(K$S,K$q,K$_,K$e.width,K$e.height,K$d.TEMP,"out",K$b,null,K$y.TOINT.overlay),K$m=K$ec.create([K$S],K$Q._recycleScope),K$P.addRenderObject(K$m),K$x.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=K$e._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=K$e._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=K$e._uint8ArraySlice),!0},K$e.onStageResize=function(K$c,K$P){null!=K$e.mainContext&&(K$e.mainContext.viewport(0,0,K$c,K$P),K$Nc.width=K$c,K$Nc.height=K$P)},K$e.onInvalidGLRes=function(){K$I.instance.freeAll(),K$T.releaseContentManagers(!0),K$e.doNodeRepaint(K$L.stage),K$e.mainContext.viewport(0,0,K$Nc.width,K$Nc.height),K$L.stage.event("devicelost")},K$e.doNodeRepaint=function(K$c){0==K$c.numChildren&&K$c.repaint();for(var K$P=0;K$P<K$c.numChildren;K$P++)K$e.doNodeRepaint(K$c.getChildAt(K$P))},K$e.init=function(K$c,K$P,K$q){K$e.mainCanvas=K$c,K$S._createContext=function(K$c){return new K$Hc(K$c)},K$zc._createContext=function(K$c){return new K$Hc(K$c)};var K$_=laya.webgl.WebGL.mainContext;if(null!=K$_.getShaderPrecisionFormat){var K$E=K$_.getShaderPrecisionFormat(35633,36338),K$b=K$_.getShaderPrecisionFormat(35632,36338);K$e.shaderHighPrecision=!(!K$E.precision||!K$b.precision)}else K$e.shaderHighPrecision=!1;if(K$e.compressAstc=K$_.getExtension("WEBGL_compressed_texture_astc"),K$e.compressAtc=K$_.getExtension("WEBGL_compressed_texture_atc"),K$e.compressEtc=K$_.getExtension("WEBGL_compressed_texture_etc"),K$e.compressEtc1=K$_.getExtension("WEBGL_compressed_texture_etc1"),K$e.compressPvrtc=K$_.getExtension("WEBGL_compressed_texture_pvrtc"),K$e.compressS3tc=K$_.getExtension("WEBGL_compressed_texture_s3tc"),K$e.compressS3tc_srgb=K$_.getExtension("WEBGL_compressed_texture_s3tc_srgb"),K$e.compressAstc=K$e.compressAstc?K$e.compressAstc:{},K$e.compressAtc=K$e.compressAtc?K$e.compressAtc:{},K$e.compressEtc=K$e.compressEtc?K$e.compressEtc:{},K$e.compressEtc1=K$e.compressEtc1?K$e.compressEtc1:{},K$e.compressPvrtc=K$e.compressPvrtc?K$e.compressPvrtc:{},K$e.compressS3tc=K$e.compressS3tc?K$e.compressS3tc:{},K$e.compressS3tc_srgb=K$e.compressS3tc_srgb?K$e.compressS3tc_srgb:{},K$_.deleteTexture1=K$_.deleteTexture,K$_.deleteTexture=function(K$c){K$c==K$Dc.curBindTexValue&&(K$Dc.curBindTexValue=null),K$_.deleteTexture1(K$c)},K$e.onStageResize(K$P,K$q),null==K$e.mainContext)throw new Error("webGL getContext err!");K$$.__init__(),K$I.__init__(),K$Jc.__init__(),K$bc.__init__(),K$Hc.__init__(),K$Qc.__init__(),K$K.__init__(),K$Bc.__int__(K$_),K$y._init_(K$_),K$O.isConchApp&&conch.setOnInvalidGLRes(K$e.onInvalidGLRes)},K$e.mainCanvas=null,K$e.antialias=!0,K$e.shaderHighPrecision=!1,K$e._bg_null=[0,0,0,0],K$e}(),K$Dc=function(){function K$_(){}return K$x(K$_,"laya.webgl.WebGLContext"),K$_.UseProgram=function(K$c){return K$_._useProgram!==K$c&&(K$Tc.mainContext.useProgram(K$c),K$_._useProgram=K$c,!0)},K$_.setDepthTest=function(K$c,K$P){K$P!==K$_._depthTest&&((K$_._depthTest=K$P)?K$c.enable(2929):K$c.disable(2929))},K$_.setDepthMask=function(K$c,K$P){K$P!==K$_._depthMask&&(K$_._depthMask=K$P,K$c.depthMask(K$P))},K$_.setDepthFunc=function(K$c,K$P){K$P!==K$_._depthFunc&&(K$_._depthFunc=K$P,K$c.depthFunc(K$P))},K$_.setBlend=function(K$c,K$P){K$P!==K$_._blend&&((K$_._blend=K$P)?K$c.enable(3042):K$c.disable(3042))},K$_.setBlendFunc=function(K$c,K$P,K$q){(K$P!==K$_._sFactor||K$q!==K$_._dFactor)&&(K$_._sFactor=K$P,K$_._dFactor=K$q,K$c.blendFunc(K$P,K$q))},K$_.setCullFace=function(K$c,K$P){K$P!==K$_._cullFace&&((K$_._cullFace=K$P)?K$c.enable(2884):K$c.disable(2884))},K$_.setFrontFace=function(K$c,K$P){K$P!==K$_._frontFace&&(K$_._frontFace=K$P,K$c.frontFace(K$P))},K$_.bindTexture=function(K$c,K$P,K$q){K$c.bindTexture(K$P,K$q),K$_.curBindTexTarget=K$P,K$_.curBindTexValue=K$q},K$_.DEPTH_BUFFER_BIT=256,K$_.STENCIL_BUFFER_BIT=1024,K$_.COLOR_BUFFER_BIT=16384,K$_.POINTS=0,K$_.LINES=1,K$_.LINE_LOOP=2,K$_.LINE_STRIP=3,K$_.TRIANGLES=4,K$_.TRIANGLE_STRIP=5,K$_.TRIANGLE_FAN=6,K$_.ZERO=0,K$_.ONE=1,K$_.SRC_COLOR=768,K$_.ONE_MINUS_SRC_COLOR=769,K$_.SRC_ALPHA=770,K$_.ONE_MINUS_SRC_ALPHA=771,K$_.DST_ALPHA=772,K$_.ONE_MINUS_DST_ALPHA=773,K$_.DST_COLOR=774,K$_.ONE_MINUS_DST_COLOR=775,K$_.SRC_ALPHA_SATURATE=776,K$_.FUNC_ADD=32774,K$_.BLEND_EQUATION=32777,K$_.BLEND_EQUATION_RGB=32777,K$_.BLEND_EQUATION_ALPHA=34877,K$_.FUNC_SUBTRACT=32778,K$_.FUNC_REVERSE_SUBTRACT=32779,K$_.BLEND_DST_RGB=32968,K$_.BLEND_SRC_RGB=32969,K$_.BLEND_DST_ALPHA=32970,K$_.BLEND_SRC_ALPHA=32971,K$_.CONSTANT_COLOR=32769,K$_.ONE_MINUS_CONSTANT_COLOR=32770,K$_.CONSTANT_ALPHA=32771,K$_.ONE_MINUS_CONSTANT_ALPHA=32772,K$_.BLEND_COLOR=32773,K$_.ARRAY_BUFFER=34962,K$_.ELEMENT_ARRAY_BUFFER=34963,K$_.ARRAY_BUFFER_BINDING=34964,K$_.ELEMENT_ARRAY_BUFFER_BINDING=34965,K$_.STREAM_DRAW=35040,K$_.STATIC_DRAW=35044,K$_.DYNAMIC_DRAW=35048,K$_.BUFFER_SIZE=34660,K$_.BUFFER_USAGE=34661,K$_.CURRENT_VERTEX_ATTRIB=34342,K$_.FRONT=1028,K$_.BACK=1029,K$_.CULL_FACE=2884,K$_.FRONT_AND_BACK=1032,K$_.BLEND=3042,K$_.DITHER=3024,K$_.STENCIL_TEST=2960,K$_.DEPTH_TEST=2929,K$_.SCISSOR_TEST=3089,K$_.POLYGON_OFFSET_FILL=32823,K$_.SAMPLE_ALPHA_TO_COVERAGE=32926,K$_.SAMPLE_COVERAGE=32928,K$_.NO_ERROR=0,K$_.INVALID_ENUM=1280,K$_.INVALID_VALUE=1281,K$_.INVALID_OPERATION=1282,K$_.OUT_OF_MEMORY=1285,K$_.CW=2304,K$_.CCW=2305,K$_.LINE_WIDTH=2849,K$_.ALIASED_POINT_SIZE_RANGE=33901,K$_.ALIASED_LINE_WIDTH_RANGE=33902,K$_.CULL_FACE_MODE=2885,K$_.FRONT_FACE=2886,K$_.DEPTH_RANGE=2928,K$_.DEPTH_WRITEMASK=2930,K$_.DEPTH_CLEAR_VALUE=2931,K$_.DEPTH_FUNC=2932,K$_.STENCIL_CLEAR_VALUE=2961,K$_.STENCIL_FUNC=2962,K$_.STENCIL_FAIL=2964,K$_.STENCIL_PASS_DEPTH_FAIL=2965,K$_.STENCIL_PASS_DEPTH_PASS=2966,K$_.STENCIL_REF=2967,K$_.STENCIL_VALUE_MASK=2963,K$_.STENCIL_WRITEMASK=2968,K$_.STENCIL_BACK_FUNC=34816,K$_.STENCIL_BACK_FAIL=34817,K$_.STENCIL_BACK_PASS_DEPTH_FAIL=34818,K$_.STENCIL_BACK_PASS_DEPTH_PASS=34819,K$_.STENCIL_BACK_REF=36003,K$_.STENCIL_BACK_VALUE_MASK=36004,K$_.STENCIL_BACK_WRITEMASK=36005,K$_.VIEWPORT=2978,K$_.SCISSOR_BOX=3088,K$_.COLOR_CLEAR_VALUE=3106,K$_.COLOR_WRITEMASK=3107,K$_.UNPACK_ALIGNMENT=3317,K$_.PACK_ALIGNMENT=3333,K$_.MAX_TEXTURE_SIZE=3379,K$_.MAX_VIEWPORT_DIMS=3386,K$_.SUBPIXEL_BITS=3408,K$_.RED_BITS=3410,K$_.GREEN_BITS=3411,K$_.BLUE_BITS=3412,K$_.ALPHA_BITS=3413,K$_.DEPTH_BITS=3414,K$_.STENCIL_BITS=3415,K$_.POLYGON_OFFSET_UNITS=10752,K$_.POLYGON_OFFSET_FACTOR=32824,K$_.TEXTURE_BINDING_2D=32873,K$_.SAMPLE_BUFFERS=32936,K$_.SAMPLES=32937,K$_.SAMPLE_COVERAGE_VALUE=32938,K$_.SAMPLE_COVERAGE_INVERT=32939,K$_.NUM_COMPRESSED_TEXTURE_FORMATS=34466,K$_.COMPRESSED_TEXTURE_FORMATS=34467,K$_.DONT_CARE=4352,K$_.FASTEST=4353,K$_.NICEST=4354,K$_.GENERATE_MIPMAP_HINT=33170,K$_.BYTE=5120,K$_.UNSIGNED_BYTE=5121,K$_.SHORT=5122,K$_.UNSIGNED_SHORT=5123,K$_.INT=5124,K$_.UNSIGNED_INT=5125,K$_.FLOAT=5126,K$_.DEPTH_COMPONENT=6402,K$_.ALPHA=6406,K$_.RGB=6407,K$_.RGBA=6408,K$_.LUMINANCE=6409,K$_.LUMINANCE_ALPHA=6410,K$_.UNSIGNED_SHORT_4_4_4_4=32819,K$_.UNSIGNED_SHORT_5_5_5_1=32820,K$_.UNSIGNED_SHORT_5_6_5=33635,K$_.FRAGMENT_SHADER=35632,K$_.VERTEX_SHADER=35633,K$_.MAX_VERTEX_ATTRIBS=34921,K$_.MAX_VERTEX_UNIFORM_VECTORS=36347,K$_.MAX_VARYING_VECTORS=36348,K$_.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,K$_.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,K$_.MAX_TEXTURE_IMAGE_UNITS=34930,K$_.MAX_FRAGMENT_UNIFORM_VECTORS=36349,K$_.SHADER_TYPE=35663,K$_.DELETE_STATUS=35712,K$_.LINK_STATUS=35714,K$_.VALIDATE_STATUS=35715,K$_.ATTACHED_SHADERS=35717,K$_.ACTIVE_UNIFORMS=35718,K$_.ACTIVE_ATTRIBUTES=35721,K$_.SHADING_LANGUAGE_VERSION=35724,K$_.CURRENT_PROGRAM=35725,K$_.NEVER=512,K$_.LESS=513,K$_.EQUAL=514,K$_.LEQUAL=515,K$_.GREATER=516,K$_.NOTEQUAL=517,K$_.GEQUAL=518,K$_.ALWAYS=519,K$_.KEEP=7680,K$_.REPLACE=7681,K$_.INCR=7682,K$_.DECR=7683,K$_.INVERT=5386,K$_.INCR_WRAP=34055,K$_.DECR_WRAP=34056,K$_.VENDOR=7936,K$_.RENDERER=7937,K$_.VERSION=7938,K$_.NEAREST=9728,K$_.LINEAR=9729,K$_.NEAREST_MIPMAP_NEAREST=9984,K$_.LINEAR_MIPMAP_NEAREST=9985,K$_.NEAREST_MIPMAP_LINEAR=9986,K$_.LINEAR_MIPMAP_LINEAR=9987,K$_.TEXTURE_MAG_FILTER=10240,K$_.TEXTURE_MIN_FILTER=10241,K$_.TEXTURE_WRAP_S=10242,K$_.TEXTURE_WRAP_T=10243,K$_.TEXTURE_2D=3553,K$_.TEXTURE=5890,K$_.TEXTURE_CUBE_MAP=34067,K$_.TEXTURE_BINDING_CUBE_MAP=34068,K$_.TEXTURE_CUBE_MAP_POSITIVE_X=34069,K$_.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,K$_.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,K$_.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,K$_.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,K$_.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,K$_.MAX_CUBE_MAP_TEXTURE_SIZE=34076,K$_.TEXTURE0=33984,K$_.TEXTURE1=33985,K$_.TEXTURE2=33986,K$_.TEXTURE3=33987,K$_.TEXTURE4=33988,K$_.TEXTURE5=33989,K$_.TEXTURE6=33990,K$_.TEXTURE7=33991,K$_.TEXTURE8=33992,K$_.TEXTURE9=33993,K$_.TEXTURE10=33994,K$_.TEXTURE11=33995,K$_.TEXTURE12=33996,K$_.TEXTURE13=33997,K$_.TEXTURE14=33998,K$_.TEXTURE15=33999,K$_.TEXTURE16=34e3,K$_.TEXTURE17=34001,K$_.TEXTURE18=34002,K$_.TEXTURE19=34003,K$_.TEXTURE20=34004,K$_.TEXTURE21=34005,K$_.TEXTURE22=34006,K$_.TEXTURE23=34007,K$_.TEXTURE24=34008,K$_.TEXTURE25=34009,K$_.TEXTURE26=34010,K$_.TEXTURE27=34011,K$_.TEXTURE28=34012,K$_.TEXTURE29=34013,K$_.TEXTURE30=34014,K$_.TEXTURE31=34015,K$_.ACTIVE_TEXTURE=34016,K$_.REPEAT=10497,K$_.CLAMP_TO_EDGE=33071,K$_.MIRRORED_REPEAT=33648,K$_.FLOAT_VEC2=35664,K$_.FLOAT_VEC3=35665,K$_.FLOAT_VEC4=35666,K$_.INT_VEC2=35667,K$_.INT_VEC3=35668,K$_.INT_VEC4=35669,K$_.BOOL=35670,K$_.BOOL_VEC2=35671,K$_.BOOL_VEC3=35672,K$_.BOOL_VEC4=35673,K$_.FLOAT_MAT2=35674,K$_.FLOAT_MAT3=35675,K$_.FLOAT_MAT4=35676,K$_.SAMPLER_2D=35678,K$_.SAMPLER_CUBE=35680,K$_.VERTEX_ATTRIB_ARRAY_ENABLED=34338,K$_.VERTEX_ATTRIB_ARRAY_SIZE=34339,K$_.VERTEX_ATTRIB_ARRAY_STRIDE=34340,K$_.VERTEX_ATTRIB_ARRAY_TYPE=34341,K$_.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,K$_.VERTEX_ATTRIB_ARRAY_POINTER=34373,K$_.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,K$_.COMPILE_STATUS=35713,K$_.LOW_FLOAT=36336,K$_.MEDIUM_FLOAT=36337,K$_.HIGH_FLOAT=36338,K$_.LOW_INT=36339,K$_.MEDIUM_INT=36340,K$_.HIGH_INT=36341,K$_.FRAMEBUFFER=36160,K$_.RENDERBUFFER=36161,K$_.RGBA4=32854,K$_.RGB5_A1=32855,K$_.RGB565=36194,K$_.DEPTH_COMPONENT16=33189,K$_.STENCIL_INDEX=6401,K$_.STENCIL_INDEX8=36168,K$_.DEPTH_STENCIL=34041,K$_.RENDERBUFFER_WIDTH=36162,K$_.RENDERBUFFER_HEIGHT=36163,K$_.RENDERBUFFER_INTERNAL_FORMAT=36164,K$_.RENDERBUFFER_RED_SIZE=36176,K$_.RENDERBUFFER_GREEN_SIZE=36177,K$_.RENDERBUFFER_BLUE_SIZE=36178,K$_.RENDERBUFFER_ALPHA_SIZE=36179,K$_.RENDERBUFFER_DEPTH_SIZE=36180,K$_.RENDERBUFFER_STENCIL_SIZE=36181,K$_.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,K$_.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,K$_.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,K$_.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,K$_.COLOR_ATTACHMENT0=36064,K$_.DEPTH_ATTACHMENT=36096,K$_.STENCIL_ATTACHMENT=36128,K$_.DEPTH_STENCIL_ATTACHMENT=33306,K$_.NONE=0,K$_.FRAMEBUFFER_COMPLETE=36053,K$_.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,K$_.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,K$_.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,K$_.FRAMEBUFFER_UNSUPPORTED=36061,K$_.FRAMEBUFFER_BINDING=36006,K$_.RENDERBUFFER_BINDING=36007,K$_.MAX_RENDERBUFFER_SIZE=34024,K$_.INVALID_FRAMEBUFFER_OPERATION=1286,K$_.UNPACK_FLIP_Y_WEBGL=37440,K$_.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,K$_.CONTEXT_LOST_WEBGL=37442,K$_.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,K$_.BROWSER_DEFAULT_WEBGL=37444,K$_._useProgram=null,K$_._depthTest=!0,K$_._depthMask=!0,K$_._blend=!1,K$_._cullFace=!1,K$_.curBindTexTarget=null,K$_.curBindTexValue=null,K$e(K$_,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),K$_}(),K$Lc=function(K$c){function K$P(){K$P.__super.call(this)}K$x(K$P,"laya.webgl.display.GraphicsGL",K$h);var K$q=K$P.prototype;return K$q.setShader=function(K$c){this._saveToCmd(K$O.context._setShader,[K$c])},K$q.setIBVB=function(K$c,K$P,K$q,K$_,K$E,K$b){this._saveToCmd(K$O.context._setIBVB,[K$c,K$P,K$q,K$_,K$E,K$b])},K$q.drawParticle=function(K$c,K$P,K$q){var K$_=K$D.createParticleTemplate2D(K$q);K$_.x=K$c,K$_.y=K$P,this._saveToCmd(K$O.context._drawParticle,[K$_])},K$P}(),K$Hc=function(K$c){var K$q;function K$U(K$c){this._x=0,this._y=0,this._id=++K$U._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,K$U.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=K$U.MAXCLIPRECT,this.mOutPoint,this._canvas=K$c,this._canvas._addReference(),K$U._contextcount++,K$O.isFlash?(this._ib=K$Kc.create(35044),K$wc.fillIBQuadrangle(this._ib,16)):this._ib=K$Kc.QuadrangleIB,this.clear()}K$x(K$U,"laya.webgl.canvas.WebGLContext2D",K$E);var K$P=K$U.prototype;return K$P.setIsMainContext=function(){this._isMain=!0},K$P.clearBG=function(K$c,K$P,K$q,K$_){var K$E=K$Tc.mainContext;K$E.clearColor(K$c,K$P,K$q,K$_),K$E.clear(16384)},K$P._getSubmits=function(){return this._submits},K$P._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var K$c=0,K$P=this._submits._length;K$c<K$P;K$c++)this._submits[K$c].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},K$P.destroy=function(){--K$U._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=K$Kc.QuadrangleIB&&this._ib.releaseResource()},K$P.clear=function(){this._submits||(this._other=K$q.DEFAULT,this._curMat=K$d.create(),this._vb=K$Gc.create(-1),this._submits=[],this._save=[K$t.Create(this)],this._save.length=10,this._shader2D=new K$K,this._triangleMesh=K$Fc.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=K$q.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=K$U.MAXCLIPRECT,this._curSubmit=K$bc.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=K$M.DEFAULT;for(var K$c=0,K$P=this._submits._length;K$c<K$P;K$c++)this._submits[K$c].releaseRender(),this._submits[K$c]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},K$P.size=function(K$c,K$P){if(this._width!=K$c||this._height!=K$P)if(0==K$c||0==K$P){0!=this._vb._byteLength&&(this._width=K$c,this._height=K$P,this._vb.clear(),this._vb.upload());for(var K$q=0,K$_=this._submits._length;K$q<K$_;K$q++)this._submits[K$q].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=K$c,this._height=K$P,this._targets&&this._targets.size(K$c,K$P),this._canvas.memorySize-=this._canvas.memorySize;0===K$c&&0===K$P&&this._releaseMem()},K$P._getTransformMatrix=function(){return this._curMat},K$P.translate=function(K$c,K$P){0===K$c&&0===K$P||(K$p.save(this),this._curMat.bTransform&&(K$B.save(this),this._curMat.transformPointN(K$u.TEMP.setTo(K$c,K$P)),K$c=K$u.TEMP.x,K$P=K$u.TEMP.y),this._x+=K$c,this._y+=K$P)},K$P.save=function(){this._save[this._save._length++]=K$t.Create(this)},K$P.restore=function(){var K$c=this._save._length;if(!(K$c<1))for(var K$P=K$c-1;0<=K$P;K$P--){var K$q=this._save[K$P];if(K$q.restore(this),K$q.isSaveMark())return void(this._save._length=K$P)}},K$P._fillText=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){void 0===K$S&&(K$S=0);var K$n=this._shader2D,K$k=this._curSubmit.shaderValue,K$x=K$E?K$gc.create(K$E):this._other.font;if(K$I.enabled)K$n.ALPHA!==K$k.ALPHA&&(K$n.glTexture=null),K$rc.drawText(this,K$c,K$P,this._curMat,K$x,K$Z||this._other.textAlign,K$b,K$e,K$h,K$q,K$_,K$S);else{this._shader2D.defines.getValue();var K$r=K$b?K$g.create(K$b)._color:K$n.colorAdd;K$n.ALPHA===K$k.ALPHA&&K$r===K$n.colorAdd&&K$k.colorAdd===K$n.colorAdd||(K$n.glTexture=null,K$n.colorAdd=K$r),K$rc.drawText(this,K$c,K$P,this._curMat,K$x,K$Z||this._other.textAlign,K$b,K$e,K$h,K$q,K$_,K$S)}},K$P.fillWords=function(K$c,K$P,K$q,K$_,K$E,K$b){this._fillText(null,K$c,K$P,K$q,K$_,K$E,null,-1,null,K$b)},K$P.fillBorderWords=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this._fillBorderText(null,K$c,K$P,K$q,K$_,K$E,K$b,K$e,null)},K$P.fillText=function(K$c,K$P,K$q,K$_,K$E,K$b){this._fillText(K$c,null,K$P,K$q,K$_,K$E,null,-1,K$b)},K$P.strokeText=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this._fillText(K$c,null,K$P,K$q,K$_,null,K$E,K$b||1,K$e)},K$P.fillBorderText=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){this._fillBorderText(K$c,null,K$P,K$q,K$_,K$E,K$b,K$e,K$h)},K$P._fillBorderText=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){if(!K$I.enabled)return this._fillText(K$c,K$P,K$q,K$_,K$E,null,K$e,K$h||1,K$Z),void this._fillText(K$c,K$P,K$q,K$_,K$E,K$b,null,-1,K$Z);var K$S=this._shader2D,K$n=this._curSubmit.shaderValue;K$S.ALPHA!==K$n.ALPHA&&(K$S.glTexture=null);var K$k=K$E?(K$U._fontTemp.setFont(K$E),K$U._fontTemp):this._other.font;K$rc.drawText(this,K$c,K$P,this._curMat,K$k,K$Z||this._other.textAlign,K$b,K$e,K$h||1,K$q,K$_,0)},K$P.fillRect=function(K$c,K$P,K$q,K$_,K$E){var K$b=this._vb;if(K$wc.fillRectImgVb(K$b,this._clipRect,K$c,K$P,K$q,K$_,K$F.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var K$e=this._shader2D.fillStyle;K$E&&(this._shader2D.fillStyle=K$M.create(K$E));var K$h=this._shader2D,K$Z=this._curSubmit.shaderValue;if(K$h.fillStyle!==K$Z.fillStyle||K$h.ALPHA!==K$Z.ALPHA){K$h.glTexture=null;var K$S=this._curSubmit=K$bc.createSubmit(this,this._ib,K$b,(K$b._byteLength-64)/32*3,K$Qc.create(2,0));K$S.shaderValue.color=K$h.fillStyle._color._color,K$S.shaderValue.ALPHA=K$h.ALPHA,this._submits[this._submits._length++]=K$S}this._curSubmit._numEle+=6,this._shader2D.fillStyle=K$e}},K$P.fillTexture=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){if(K$c.loaded&&K$c.bitmap&&K$c.source){var K$Z=this._vb,K$S=K$c.bitmap.width,K$n=K$c.bitmap.height,K$k=K$c.uv,K$x=K$e.x%K$c.width,K$r=K$e.y%K$c.height;if(K$S!=K$h.w||K$n!=K$h.h){if(!K$h.w&&!K$h.h)switch(K$h.oy=K$h.ox=0,K$b){case"repeat":K$h.width=K$_,K$h.height=K$E;break;case"repeat-x":K$h.width=K$_,K$r<0?K$c.height+K$r>K$E?K$h.height=K$E:K$h.height=K$c.height+K$r:(K$h.oy=K$r,K$c.height+K$r>K$E?K$h.height=K$E-K$r:K$h.height=K$c.height);break;case"repeat-y":K$x<0?K$c.width+K$x>K$_?K$h.width=K$_:K$h.width=K$c.width+K$x:(K$h.ox=K$x,K$c.width+K$x>K$_?K$h.width=K$_-K$x:K$h.width=K$c.width),K$h.height=K$E;break;case"no-repeat":K$x<0?K$c.width+K$x>K$_?K$h.width=K$_:K$h.width=K$c.width+K$x:(K$h.ox=K$x,K$c.width+K$x>K$_?K$h.width=K$_-K$x:K$h.width=K$c.width),K$r<0?K$c.height+K$r>K$E?K$h.height=K$E:K$h.height=K$c.height+K$r:(K$h.oy=K$r,K$c.height+K$r>K$E?K$h.height=K$E-K$r:K$h.height=K$c.height);break;default:K$h.width=K$_,K$h.height=K$E}K$h.w=K$S,K$h.h=K$n,K$h.uv=[0,0,K$h.width/K$S,0,K$h.width/K$S,K$h.height/K$n,0,K$h.height/K$n]}if(K$P+=K$h.ox,K$q+=K$h.oy,K$x-=K$h.ox,K$r-=K$h.oy,K$wc.fillRectImgVb(K$Z,this._clipRect,K$P,K$q,K$h.width,K$h.height,K$h.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var K$g=K$Cc.create(this,this._ib,K$Z,(K$Z._byteLength-64)/32*3,K$Qc.create(256,0)),K$W=(this._submits[this._submits._length++]=K$g).shaderValue;K$W.textureHost=K$c;var K$w=K$k[0]*K$S,K$O=K$k[1]*K$n,K$N=(K$k[2]-K$k[0])*K$S,K$m=(K$k[5]-K$k[3])*K$n,K$T=-K$x/K$S,K$D=-K$r/K$n;K$W.u_TexRange[0]=K$w/K$S,K$W.u_TexRange[1]=K$N/K$S,K$W.u_TexRange[2]=K$O/K$n,K$W.u_TexRange[3]=K$m/K$n,K$W.u_offset[0]=K$T,K$W.u_offset[1]=K$D,K$I.enabled&&!this._isMain&&K$g.addTexture(K$c,(K$Z._byteLength>>2)-16),(this._curSubmit=K$g)._renderType=10017,K$g._numEle+=6}}else this.sprite&&K$L.timer.callLater(this,this._repaintSprite)},K$P.setShader=function(K$c){K$X.save(this,1048576,this._shader2D,!0),this._shader2D.shader=K$c},K$P.setFilters=function(K$c){K$X.save(this,2097152,this._shader2D,!0),this._shader2D.filters=K$c,this._curSubmit=K$bc.RENDERBASE,this._renderKey=0,this._drawCount++},K$P.drawTexture=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this._drawTextureM(K$c,K$P,K$q,K$_,K$E,K$b,K$e,null,1)},K$P.addTextureVb=function(K$c,K$P,K$q){var K$_=this._curSubmit._vb||this._vb,K$E=K$_._byteLength>>2;K$_.byteLength=K$E+16<<2;for(var K$b=K$_.getFloat32Array(),K$e=0;K$e<16;K$e+=4)K$b[K$E++]=K$c[K$e]+K$P,K$b[K$E++]=K$c[K$e+1]+K$q,K$b[K$E++]=K$c[K$e+2],K$b[K$E++]=K$c[K$e+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),K$_._upload=!0},K$P.willDrawTexture=function(K$c,K$P){if(!(K$c.loaded&&K$c.bitmap&&K$c.source))return this.sprite&&K$L.timer.callLater(this,this._repaintSprite),0;var K$q=K$c.bitmap,K$_=K$q.id+this._shader2D.ALPHA*K$P+10016;if(K$_==this._renderKey)return K$_;var K$E=this._shader2D,K$b=K$E.ALPHA,K$e=this._curSubmit.shaderValue;K$E.ALPHA*=K$P,this._renderKey=K$_,this._drawCount++,K$E.glTexture=K$q;var K$h=this._vb,K$Z=null,K$S=K$h._byteLength/32*3,K$n=K$e.textureHost&&K$e.textureHost==K$c&&K$e.textureHost.alphaTexture==K$c.alphaTexture;return K$Z=K$Cc.create(this,this._ib,K$h,K$S,K$Qc.create(1,0)),(this._submits[this._submits._length++]=K$Z).shaderValue.textureHost=K$c,K$Z._renderType=10016,K$Z._preIsSameTextureShader=10016===this._curSubmit._renderType&&K$E.ALPHA===K$e.ALPHA&&K$n,this._curSubmit=K$Z,K$E.ALPHA=K$b,K$_},K$P.drawTextures=function(K$c,K$P,K$q,K$_){if(K$c.loaded&&K$c.bitmap&&K$c.source){var K$E=this._clipRect;if(this._clipRect=K$U.MAXCLIPRECT,this._drawTextureM(K$c,K$P[0],K$P[1],K$c.width,K$c.height,K$q,K$_,null,1)){if(this._clipRect=K$E,K$V.drawCall++,!(K$P.length<4)){for(var K$b=this._curSubmit._vb||this._vb,K$e=this._curMat.a,K$h=this._curMat.d,K$Z=2,K$S=K$P.length;K$Z<K$S;K$Z+=2)K$wc.copyPreImgVb(K$b,(K$P[K$Z]-K$P[K$Z-2])*K$e,(K$P[K$Z+1]-K$P[K$Z-1])*K$h),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&K$L.timer.callLater(this,this._repaintSprite)},K$P._drawTextureM=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){if(!K$c.loaded||!K$c.source)return this.sprite&&K$L.timer.callLater(this,this._repaintSprite),!1;var K$S=this._curSubmit._vb||this._vb,K$n=K$c.bitmap;K$P+=K$b,K$q+=K$e,this._drawCount++;var K$k=K$n.id+this._shader2D.ALPHA*K$Z+10016;if(K$k!=this._renderKey){this._renderKey=K$k;var K$x=this._curSubmit.shaderValue,K$r=this._shader2D,K$g=K$r.ALPHA;K$r.ALPHA*=K$Z,K$r.glTexture=K$n;var K$W=this._vb,K$w=null,K$O=K$W._byteLength/32*3,K$N=K$x.textureHost&&K$x.textureHost==K$c&&K$x.textureHost.alphaTexture==K$c.alphaTexture;K$w=K$Cc.create(this,this._ib,K$W,K$O,K$Qc.create(1,0)),(this._submits[this._submits._length++]=K$w).shaderValue.textureHost=K$c,K$w._renderType=10016,K$w._preIsSameTextureShader=10016===this._curSubmit._renderType&&K$r.ALPHA===K$x.ALPHA&&K$N,this._curSubmit=K$w,K$S=this._curSubmit._vb||this._vb,K$r.ALPHA=K$g}return!!K$wc.fillRectImgVb(K$S,this._clipRect,K$P,K$q,K$_||K$c.width,K$E||K$c.height,K$c.uv,K$h||this._curMat,this._x,this._y,0,0)&&(K$I.enabled&&!this._isMain&&this._curSubmit.addTexture(K$c,(K$S._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},K$P._repaintSprite=function(){this.sprite&&this.sprite.repaint()},K$P._drawText=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){var K$n=K$c.bitmap;this._drawCount++;var K$k=K$n.id+this._shader2D.ALPHA+10016;if(K$k!=this._renderKey){this._renderKey=K$k;var K$x=this._curSubmit.shaderValue,K$r=this._shader2D;K$r.glTexture=K$n;var K$g=this._vb,K$W=null,K$w=K$g._byteLength/32*3,K$O=K$x.textureHost&&K$x.textureHost==K$c&&K$x.textureHost.alphaTexture==K$c.alphaTexture;(K$W=K$I.enabled?K$Cc.create(this,this._ib,K$g,K$w,K$Qc.create(1,0)):K$Cc.create(this,this._ib,K$g,K$w,K$pc.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&K$r.ALPHA===K$x.ALPHA&&K$O,(this._submits[this._submits._length++]=K$W).shaderValue.textureHost=K$c,K$W._renderType=10016,this._curSubmit=K$W}K$c.active();var K$N=this._curSubmit._vb||this._vb;K$wc.fillRectImgVb(K$N,this._clipRect,K$P+K$e,K$q+K$h,K$_||K$c.width,K$E||K$c.height,K$c.uv,K$b||this._curMat,this._x,this._y,K$Z,K$S,!0)&&(K$I.enabled&&!this._isMain&&this._curSubmit.addTexture(K$c,(K$N._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},K$P.drawTextureWithTransform=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){if(K$b){var K$S=this._curMat,K$n=this._x,K$k=this._y;(0!==K$e||0!==K$h)&&(this._x=K$e*K$S.a+K$h*K$S.c,this._y=K$h*K$S.d+K$e*K$S.b),K$b&&K$S.bTransform?(K$d.mul(K$b,K$S,K$U._tmpMatrix),(K$b=K$U._tmpMatrix)._checkTransform()):(this._x+=K$S.tx,this._y+=K$S.ty),this._drawTextureM(K$c,K$P,K$q,K$_,K$E,0,0,K$b,K$Z),this._x=K$n,this._y=K$k}else this._drawTextureM(K$c,K$P,K$q,K$_,K$E,K$e,K$h,null,K$Z)},K$P.fillQuadrangle=function(K$c,K$P,K$q,K$_,K$E){var K$b=this._curSubmit,K$e=this._vb,K$h=this._shader2D,K$Z=K$b.shaderValue;if(this._renderKey=0,K$c.bitmap){var K$S=K$c.bitmap;K$h.glTexture==K$S&&K$h.ALPHA===K$Z.ALPHA||(K$h.glTexture=K$S,(K$b=this._curSubmit=K$bc.createSubmit(this,this._ib,K$e,K$e._byteLength/32*3,K$Qc.create(1,0))).shaderValue.glTexture=K$S,this._submits[this._submits._length++]=K$b),K$wc.fillQuadrangleImgVb(K$e,K$P,K$q,K$_,K$c.uv,K$E||this._curMat,this._x,this._y)}else K$b.shaderValue.fillStyle&&K$b.shaderValue.fillStyle.equal(K$c)&&K$h.ALPHA===K$Z.ALPHA||(K$h.glTexture=null,(K$b=this._curSubmit=K$bc.createSubmit(this,this._ib,K$e,K$e._byteLength/32*3,K$Qc.create(2,0))).shaderValue.defines.add(2),K$b.shaderValue.fillStyle=K$M.create(K$c),this._submits[this._submits._length++]=K$b),K$wc.fillQuadrangleImgVb(K$e,K$P,K$q,K$_,K$F.DEF_UV,K$E||this._curMat,this._x,this._y);K$b._numEle+=6},K$P.drawTexture2=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){if(0!=K$b){var K$Z=this._curMat;if(this._x=K$c*K$Z.a+K$P*K$Z.c,this._y=K$P*K$Z.d+K$c*K$Z.b,K$E&&(K$E=K$Z.bTransform||K$E.bTransform?(K$d.mul(K$E,K$Z,K$U._tmpMatrix),K$U._tmpMatrix):(this._x+=K$E.tx+K$Z.tx,this._y+=K$E.ty+K$Z.ty,K$d.EMPTY)),1!==K$b||K$e){var K$S=this._shader2D.ALPHA,K$n=this._nBlendType;this._shader2D.ALPHA=K$b,K$e&&(this._nBlendType=K$y.TOINT(K$e)),this._drawTextureM(K$h[0],K$h[1]-K$q,K$h[2]-K$_,K$h[3],K$h[4],0,0,K$E,1),this._shader2D.ALPHA=K$S,this._nBlendType=K$n}else this._drawTextureM(K$h[0],K$h[1]-K$q,K$h[2]-K$_,K$h[3],K$h[4],0,0,K$E,1);this._x=this._y=0}},K$P.drawCanvas=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$c.context;if(this._renderKey=0,K$b._targets)this._submits[this._submits._length++]=K$$c.create(K$b,0,null),this._curSubmit=K$bc.RENDERBASE,K$b._targets.drawTo(this,K$P,K$q,K$_,K$E);else{var K$e=this._submits[this._submits._length++]=K$$c.create(K$b,this._shader2D.ALPHA,this._shader2D.filters),K$h=K$_/K$c.width,K$Z=K$E/K$c.height,K$S=K$e._matrix;this._curMat.copyTo(K$S),1!=K$h&&1!=K$Z&&K$S.scale(K$h,K$Z);var K$n=K$S.tx,K$k=K$S.ty;K$S.tx=K$S.ty=0,K$S.transformPoint(K$u.TEMP.setTo(K$P,K$q)),K$S.translate(K$u.TEMP.x+K$n,K$u.TEMP.y+K$k),this._curSubmit=K$bc.RENDERBASE}K$H.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=K$b._targets?"yellow":"green",this.strokeRect(K$P-1,K$q-1,K$_+2,K$E+2,1),this.strokeRect(K$P,K$q,K$_,K$E,1),this.restore())},K$P.drawTarget=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){void 0===K$S&&(K$S=-1);var K$n=this._vb;if(K$wc.fillRectImgVb(K$n,this._clipRect,K$P,K$q,K$_,K$E,K$Z||K$F.DEF_UV,K$b||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var K$k=this._curSubmit=K$kc.create(this,this._ib,K$n,(K$n._byteLength-64)/32*3,K$h,K$e);K$k.blendType=-1==K$S?this._nBlendType:K$S,K$k.scope=K$c,this._submits[this._submits._length++]=K$k,this._curSubmit._numEle+=6}},K$P.mixRGBandAlpha=function(K$c){return this._mixRGBandAlpha(K$c,this._shader2D.ALPHA)},K$P._mixRGBandAlpha=function(K$c,K$P){var K$q=(4278190080&K$c)>>>24;return 0!=K$q?K$q*=K$P:K$q=255*K$P,16777215&K$c|K$q<<24},K$P.drawTriangles=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){if(!K$c.loaded||!K$c.source)return this.sprite&&K$L.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;K$c.bitmap;var K$n=this._mixRGBandAlpha(4294967295,K$h),K$k=(K$_.length,K$b.length);this._renderKey=-1;var K$x=this._curSubmit=K$Cc.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,K$Qc.create(1,0));return K$x.shaderValue.textureHost=K$c,K$x._renderType=10016,this._submits[this._submits._length++]=K$x,K$e?(K$U._tmpMatrix.a=K$e.a,K$U._tmpMatrix.b=K$e.b,K$U._tmpMatrix.c=K$e.c,K$U._tmpMatrix.d=K$e.d,K$U._tmpMatrix.tx=K$e.tx+K$P,K$U._tmpMatrix.ty=K$e.ty+K$q,K$d.mul(K$U._tmpMatrix,this._curMat,K$U._tmpMatrix)):(K$U._tmpMatrix.a=this._curMat.a,K$U._tmpMatrix.b=this._curMat.b,K$U._tmpMatrix.c=this._curMat.c,K$U._tmpMatrix.d=this._curMat.d,K$U._tmpMatrix.tx=this._curMat.tx+K$P,K$U._tmpMatrix.ty=this._curMat.ty+K$q),this._triangleMesh.addData(K$_,K$E,K$b,K$U._tmpMatrix,K$n,this),this._curSubmit._numEle+=K$k,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},K$P.transform=function(K$c,K$P,K$q,K$_,K$E,K$b){K$B.save(this),K$d.mul(K$d.TEMP.setTo(K$c,K$P,K$q,K$_,K$E,K$b),this._curMat,this._curMat),this._curMat._checkTransform()},K$P.setTransformByMatrix=function(K$c){K$c.copyTo(this._curMat)},K$P.transformByMatrix=function(K$c){K$B.save(this),K$d.mul(K$c,this._curMat,this._curMat),this._curMat._checkTransform()},K$P.rotate=function(K$c){K$B.save(this),this._curMat.rotateEx(K$c)},K$P.scale=function(K$c,K$P){K$B.save(this),this._curMat.scaleEx(K$c,K$P)},K$P.clipRect=function(K$c,K$P,K$q,K$_){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var K$E=K$nc.create(4);this.addRenderObject(K$E);var K$b=this._vb,K$e=K$b._byteLength>>2;if(K$wc.fillRectImgVb(K$b,null,K$c,K$P,K$q,K$_,K$F.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var K$h=this._curSubmit=K$bc.createSubmit(this,this._ib,K$b,(K$b._byteLength-64)/32*3,K$Qc.create(2,0));K$h.shaderValue.ALPHA=1,this._submits[this._submits._length++]=K$h,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var K$Z=K$nc.create(5);this.addRenderObject(K$Z);var K$S=K$b.getFloat32Array(),K$n=Math.min(Math.min(Math.min(K$S[0+K$e],K$S[4+K$e]),K$S[8+K$e]),K$S[12+K$e]),K$k=Math.max(Math.max(Math.max(K$S[0+K$e],K$S[4+K$e]),K$S[8+K$e]),K$S[12+K$e]),K$x=Math.min(Math.min(Math.min(K$S[1+K$e],K$S[5+K$e]),K$S[9+K$e]),K$S[13+K$e]),K$r=Math.max(Math.max(Math.max(K$S[1+K$e],K$S[5+K$e]),K$S[9+K$e]),K$S[13+K$e]);K$l.save(this,K$Z,K$c,K$P,K$q,K$_,K$n,K$x,K$k-K$n,K$r-K$x),this._curSubmit=K$bc.RENDERBASE}else{K$q*=this._curMat.a,K$_*=this._curMat.d;var K$g=K$u.TEMP;this._curMat.transformPoint(K$g.setTo(K$c,K$P)),K$q<0&&(K$g.x=K$g.x+K$q,K$q=-K$q),K$_<0&&(K$g.y=K$g.y+K$_,K$_=-K$_),this._renderKey=0;var K$W=this._curSubmit=K$Sc.create(this);(this._submits[this._submits._length++]=K$W).submitIndex=this._submits._length,K$W.submitLength=9999999,K$f.save(this,K$W);var K$w=this._clipRect,K$O=K$w.x,K$N=K$w.y,K$m=K$g.x+K$q,K$T=K$g.y+K$_;K$O<K$g.x&&(K$w.x=K$g.x),K$N<K$g.y&&(K$w.y=K$g.y),K$w.width=Math.min(K$m,K$O+K$w.width)-K$w.x,K$w.height=Math.min(K$T,K$N+K$w.height)-K$w.y,this._shader2D.glTexture=null,K$W.clipRect.copyFrom(K$w),this._curSubmit=K$bc.RENDERBASE}},K$P.setIBVB=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n){if(void 0===K$Z&&(K$Z=0),void 0===K$S&&(K$S=0),void 0===K$n&&(K$n=0),null===K$q){if(K$O.isFlash){var K$k=K$_;K$k._selfIB||(K$k._selfIB=K$Kc.create(35044)),K$k._selfIB.clear(),K$q=K$k._selfIB}else K$q=this._ib;K$wc.expandIBQuadrangle(K$q,K$_._byteLength/(4*K$_.vertexStride*4))}if(!K$h||!K$e)throw Error("setIBVB must input:shader shaderValues");var K$x=K$Zc.create(this,K$_,K$q,K$E,K$e,K$h,K$Z,K$S,K$n);K$b||(K$b=K$d.EMPTY),K$b.translate(K$c,K$P),K$d.mul(K$b,this._curMat,K$x._mat),K$b.translate(-K$c,-K$P),this._submits[this._submits._length++]=K$x,this._curSubmit=K$bc.RENDERBASE,this._renderKey=0},K$P.addRenderObject=function(K$c){this._submits[this._submits._length++]=K$c},K$P.fillTrangles=function(K$c,K$P,K$q,K$_,K$E){var K$b=this._curSubmit,K$e=this._vb,K$h=this._shader2D,K$Z=K$b.shaderValue,K$S=K$_.length>>4,K$n=K$c.bitmap;this._renderKey=0,K$h.glTexture==K$n&&K$h.ALPHA===K$Z.ALPHA||((K$b=this._curSubmit=K$bc.createSubmit(this,this._ib,K$e,K$e._byteLength/32*3,K$Qc.create(1,0))).shaderValue.textureHost=K$c,this._submits[this._submits._length++]=K$b),K$wc.fillTranglesVB(K$e,K$P,K$q,K$_,K$E||this._curMat,this._x,this._y),K$b._numEle+=6*K$S},K$P.submitElement=function(K$c,K$P){var K$q=this._submits;for(K$P<0&&(K$P=K$q._length);K$c<K$P;)K$c+=K$q[K$c].renderSubmit()},K$P.finish=function(){K$Tc.mainContext.finish()},K$P.flush=function(){var K$c=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(K$c>this._ib.bufferLength/12&&K$wc.expandIBQuadrangle(this._ib,K$c),!this._isMain&&K$I.enabled&&K$I._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=K$I._atlasRestore;for(var K$P=this._submits,K$q=0,K$_=K$P._length;K$q<K$_;K$q++){var K$E=K$P[K$q];10016===K$E.getRenderType()&&K$E.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),K$Pc.instance&&K$Pc.getInstance().reset();var K$b;for(K$q=0,K$b=this.meshlist.length;K$q<K$b;K$q++){var K$e=this.meshlist[K$q];K$e.canReuse?K$e.releaseMesh():K$e.destroy()}return this.meshlist.length=0,this._curSubmit=K$bc.RENDERBASE,this._renderKey=0,this._triangleMesh=K$Fc.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},K$P.setPathId=function(K$c){if(this.mId=K$c,-1!=this.mId){this.mHaveKey=!1;var K$P=K$a.getInstance();K$P.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,K$P.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},K$P.movePath=function(K$c,K$P){var K$q=K$c,K$_=K$P;K$c=this._curMat.a*K$q+this._curMat.c*K$_+this._curMat.tx,K$P=this._curMat.b*K$q+this._curMat.d*K$_+this._curMat.ty,this.mX+=K$c,this.mY+=K$P},K$P.beginPath=function(){var K$c=this._getPath();K$c.tempArray.length=0,K$c.closePath=!1,this.mX=0,this.mY=0},K$P.closePath=function(){this._path.closePath=!0},K$P.fill=function(K$c){void 0===K$c&&(K$c=!1);var K$P=this._getPath();this.drawPoly(0,0,K$P.tempArray,this.fillStyle._color.numColor,0,0,K$c)},K$P.stroke=function(){var K$c=this._getPath();if(0<this.lineWidth){if(-1==this.mId)K$c.drawLine(0,0,K$c.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var K$P=K$a.getInstance().shapeLineDic[this.mId];K$P.rebuild(K$c.tempArray),K$c.setGeomtry(K$P)}else K$a.getInstance().addLine(this.mId,K$c.drawLine(0,0,K$c.tempArray,this.lineWidth,this.strokeStyle._color.numColor));K$c.update();var K$q=[this.mX,this.mY],K$_=K$bc.createShape(this,K$c.ib,K$c.vb,K$c.count,K$c.offset,K$Qc.create(4,0));K$_.shaderValue.ALPHA=this._shader2D.ALPHA,K$_.shaderValue.u_pos=K$q,K$_.shaderValue.u_mmat2=K$Nc.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=K$_,this._renderKey=-1}},K$P.line=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=this._curSubmit,K$h=this._vb;if(K$wc.fillLineVb(K$h,this._clipRect,K$c,K$P,K$q,K$_,K$E,K$b)){this._renderKey=0;var K$Z=this._shader2D,K$S=K$e.shaderValue;K$Z.strokeStyle===K$S.strokeStyle&&K$Z.ALPHA===K$S.ALPHA||(K$Z.glTexture=null,(K$e=this._curSubmit=K$bc.createSubmit(this,this._ib,K$h,(K$h._byteLength-64)/32*3,K$Qc.create(2,0))).shaderValue.strokeStyle=K$Z.strokeStyle,K$e.shaderValue.mainID=2,K$e.shaderValue.ALPHA=K$Z.ALPHA,this._submits[this._submits._length++]=K$e),K$e._numEle+=6}},K$P.moveTo=function(K$c,K$P,K$q){void 0===K$q&&(K$q=!0);var K$_=this._getPath();if(K$q){var K$E=K$c,K$b=K$P;K$c=this._curMat.a*K$E+this._curMat.c*K$b,K$P=this._curMat.b*K$E+this._curMat.d*K$b}K$_.addPoint(K$c,K$P)},K$P.lineTo=function(K$c,K$P,K$q){void 0===K$q&&(K$q=!0);var K$_=this._getPath();if(K$q){var K$E=K$c,K$b=K$P;K$c=this._curMat.a*K$E+this._curMat.c*K$b,K$P=this._curMat.b*K$E+this._curMat.d*K$b}K$_.addPoint(K$c,K$P)},K$P.drawCurves=function(K$c,K$P,K$q){this.setPathId(-1),this.beginPath(),this.strokeStyle=K$q[3],this.lineWidth=K$q[4];var K$_=K$q[2];K$c+=K$q[0],K$P+=K$q[1],this.movePath(K$c,K$P),this.moveTo(K$_[0],K$_[1]);for(var K$E=2,K$b=K$_.length;K$E<K$b;)this.quadraticCurveTo(K$_[K$E++],K$_[K$E++],K$_[K$E++],K$_[K$E++]);this.stroke()},K$P.arcTo=function(K$c,K$P,K$q,K$_,K$E){if(-1==this.mId||!this.mHaveKey){var K$b=0,K$e=0,K$h=0,K$Z=this._getPath();this._curMat.copyTo(K$U._tmpMatrix),K$U._tmpMatrix.tx=K$U._tmpMatrix.ty=0,K$U._tempPoint.setTo(K$Z.getEndPointX(),K$Z.getEndPointY()),K$U._tmpMatrix.invertTransformPoint(K$U._tempPoint);var K$S=K$U._tempPoint.x-K$c,K$n=K$U._tempPoint.y-K$P,K$k=Math.sqrt(K$S*K$S+K$n*K$n);if(!(K$k<=1e-6)){var K$x=K$S/K$k,K$r=K$n/K$k,K$g=K$q-K$c,K$W=K$_-K$P,K$w=K$g*K$g+K$W*K$W,K$O=Math.sqrt(K$w);if(!(K$O<=1e-6)){var K$N=K$g/K$O,K$m=K$W/K$O,K$T=K$x+K$N,K$D=K$r+K$m,K$L=Math.sqrt(K$T*K$T+K$D*K$D);if(!(K$L<=1e-6)){var K$H=K$T/K$L,K$Q=K$D/K$L,K$d=Math.acos(K$H*K$x+K$Q*K$r),K$u=Math.PI/2-K$d,K$A=(K$k=K$E/Math.tan(K$u))*K$x+K$c,K$J=K$k*K$r+K$P,K$j=Math.sqrt(K$k*K$k+K$E*K$E),K$V=K$c+K$H*K$j,K$R=K$P+K$Q*K$j,K$$=0,K$C=0;if(0<=K$x*K$m-K$r*K$N){var K$F=2*K$u/K$U.SEGNUM;K$$=Math.sin(K$F),K$C=Math.cos(K$F)}else K$F=2*-K$u/K$U.SEGNUM,K$$=Math.sin(K$F),K$C=Math.cos(K$F);K$e=this._curMat.a*K$A+this._curMat.c*K$J,K$h=this._curMat.b*K$A+this._curMat.d*K$J,K$e==this._path.getEndPointX()&&K$h==this._path.getEndPointY()||K$Z.addPoint(K$e,K$h);var K$o=K$A-K$V,K$a=K$J-K$R;for(K$b=0;K$b<K$U.SEGNUM;K$b++){var K$Y=K$o*K$C+K$a*K$$,K$s=-K$o*K$$+K$a*K$C;K$e=K$Y+K$V,K$h=K$s+K$R,K$c=this._curMat.a*K$e+this._curMat.c*K$h,K$h=K$P=this._curMat.b*K$e+this._curMat.d*K$h,(K$e=K$c)==this._path.getEndPointX()&&K$h==this._path.getEndPointY()||K$Z.addPoint(K$e,K$h),K$o=K$Y,K$a=K$s}}}}}},K$P.arc=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){if(void 0===K$b&&(K$b=!1),void 0===K$e&&(K$e=!0),-1!=this.mId){var K$h=K$a.getInstance().shapeDic[this.mId];if(K$h&&this.mHaveKey&&!K$h.needUpdate(this._curMat))return;K$P=K$c=0}var K$Z,K$S=0,K$n=0,K$k=0,K$x=0,K$r=0,K$g=0,K$W=0;if(K$n=K$E-K$_,K$b)if(Math.abs(K$n)>=2*Math.PI)K$n=2*-Math.PI;else for(;0<K$n;)K$n-=2*Math.PI;else if(Math.abs(K$n)>=2*Math.PI)K$n=2*Math.PI;else for(;K$n<0;)K$n+=2*Math.PI;K$Z=K$n/(K$W=K$q<101?Math.max(10,K$n*K$q/5):K$q<201?Math.max(10,K$n*K$q/20):Math.max(10,K$n*K$q/40))/2,K$k=Math.abs(4/3*(1-Math.cos(K$Z))/Math.sin(K$Z)),K$b&&(K$k=-K$k);var K$w=this._getPath(),K$O=NaN,K$N=NaN;for(K$g=0;K$g<=K$W;K$g++)K$S=K$_+K$n*(K$g/K$W),K$x=K$c+Math.cos(K$S)*K$q,K$r=K$P+Math.sin(K$S)*K$q,K$e&&(K$O=K$x,K$N=K$r,K$x=this._curMat.a*K$O+this._curMat.c*K$N,K$r=this._curMat.b*K$O+this._curMat.d*K$N),K$x==this._path.getEndPointX()&&K$r==this._path.getEndPointY()||K$w.addPoint(K$x,K$r);K$x=K$c+Math.cos(K$E)*K$q,K$r=K$P+Math.sin(K$E)*K$q,K$e&&(K$O=K$x,K$N=K$r,K$x=this._curMat.a*K$O+this._curMat.c*K$N,K$r=this._curMat.b*K$O+this._curMat.d*K$N),K$x==this._path.getEndPointX()&&K$r==this._path.getEndPointY()||K$w.addPoint(K$x,K$r)},K$P.quadraticCurveTo=function(K$c,K$P,K$q,K$_){var K$E=K$k.I,K$b=K$q,K$e=K$_;K$q=this._curMat.a*K$b+this._curMat.c*K$e,K$_=this._curMat.b*K$b+this._curMat.d*K$e,K$b=K$c,K$e=K$P,K$c=this._curMat.a*K$b+this._curMat.c*K$e,K$P=this._curMat.b*K$b+this._curMat.d*K$e;for(var K$h=K$E.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),K$c,K$P,K$q,K$_],30,2),K$Z=0,K$S=K$h.length/2;K$Z<K$S;K$Z++)this.lineTo(K$h[2*K$Z],K$h[2*K$Z+1],!1);this.lineTo(K$q,K$_,!1)},K$P.rect=function(K$c,K$P,K$q,K$_){this._other=this._other.make(),this._other.path||(this._other.path=new K$z),this._other.path.rect(K$c,K$P,K$q,K$_)},K$P.strokeRect=function(K$c,K$P,K$q,K$_,K$E){var K$b=.5*K$E;this.line(K$c-K$b,K$P,K$c+K$q+K$b,K$P,K$E,this._curMat),this.line(K$c+K$q,K$P,K$c+K$q,K$P+K$_,K$E,this._curMat),this.line(K$c,K$P,K$c,K$P+K$_,K$E,this._curMat),this.line(K$c-K$b,K$P+K$_,K$c+K$q+K$b,K$P+K$_,K$E,this._curMat)},K$P.clip=function(){},K$P.drawPoly=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){void 0===K$e&&(K$e=!1),this._renderKey=0,this._shader2D.glTexture=null;var K$h=this._getPath();if(-1==this.mId)K$h.polygon(K$c,K$P,K$q,K$_,K$E||1,K$b);else if(this.mHaveKey){var K$Z=K$a.getInstance().shapeDic[this.mId];K$Z.setMatrix(this._curMat),K$Z.rebuild(K$h.tempArray),K$h.setGeomtry(K$Z)}else{var K$S=K$h.polygon(K$c,K$P,K$q,K$_,K$E||1,K$b);K$a.getInstance().addShape(this.mId,K$S),K$S.setMatrix(this._curMat)}K$h.update();var K$n,K$k=[this.mX,this.mY];if((K$n=K$bc.createShape(this,K$h.ib,K$h.vb,K$h.count,K$h.offset,K$Qc.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,K$n.shaderValue.u_pos=K$k,K$n.shaderValue.u_mmat2=K$Nc.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=K$n,0<K$E){if(this.mHaveLineKey){var K$x=K$a.getInstance().shapeLineDic[this.mId];K$x.rebuild(K$h.tempArray),K$h.setGeomtry(K$x)}else K$a.getInstance().addShape(this.mId,K$h.drawLine(K$c,K$P,K$q,K$E,K$b));K$h.update(),(K$n=K$bc.createShape(this,K$h.ib,K$h.vb,K$h.count,K$h.offset,K$Qc.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,K$n.shaderValue.u_mmat2=K$Nc.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=K$n}},K$P.drawParticle=function(K$c,K$P,K$q){K$q.x=K$c,K$q.y=K$P,this._submits[this._submits._length++]=K$q},K$P._getPath=function(){return this._path||(this._path=new K$z)},K$_(0,K$P,"globalCompositeOperation",function(){return K$y.NAMES[this._nBlendType]},function(K$c){var K$P=K$y.TOINT[K$c];null==K$P||this._nBlendType===K$P||(K$X.save(this,65536,this,!0),this._curSubmit=K$bc.RENDERBASE,this._renderKey=0,this._nBlendType=K$P)}),K$_(0,K$P,"strokeStyle",function(){return this._shader2D.strokeStyle},function(K$c){this._shader2D.strokeStyle.equal(K$c)||(K$X.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=K$M.create(K$c))}),K$_(0,K$P,"globalAlpha",function(){return this._shader2D.ALPHA},function(K$c){(K$c=Math.floor(1e3*K$c)/1e3)!=this._shader2D.ALPHA&&(K$X.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=K$c)}),K$_(0,K$P,"asBitmap",null,function(K$c){if(K$c){if(this._targets||(this._targets=new K$i),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),K$_(0,K$P,"fillStyle",function(){return this._shader2D.fillStyle},function(K$c){this._shader2D.fillStyle.equal(K$c)||(K$X.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=K$M.create(K$c))}),K$_(0,K$P,"textAlign",function(){return this._other.textAlign},function(K$c){this._other.textAlign===K$c||(this._other=this._other.make(),K$X.save(this,32768,this._other,!1),this._other.textAlign=K$c)}),K$_(0,K$P,"lineWidth",function(){return this._other.lineWidth},function(K$c){this._other.lineWidth===K$c||(this._other=this._other.make(),K$X.save(this,256,this._other,!1),this._other.lineWidth=K$c)}),K$_(0,K$P,"textBaseline",function(){return this._other.textBaseline},function(K$c){this._other.textBaseline===K$c||(this._other=this._other.make(),K$X.save(this,16384,this._other,!1),this._other.textBaseline=K$c)}),K$_(0,K$P,"font",null,function(K$c){K$c!=this._other.font.toString()&&(this._other=this._other.make(),K$X.save(this,8,this._other,!1),this._other.font===K$gc.EMPTY?this._other.font=new K$gc(K$c):this._other.font.setFont(K$c))}),K$U.__init__=function(){K$q.DEFAULT=new K$q},K$U._tempPoint=new K$u,K$U._SUBMITVBSIZE=32e3,K$U._MAXSIZE=99999999,K$U._RECTVBSIZE=16,K$U.MAXCLIPRECT=new K$A(0,0,99999999,99999999),K$U._COUNT=0,K$U._tmpMatrix=new K$d,K$U.SEGNUM=32,K$U._contextcount=0,K$e(K$U,["_fontTemp",function(){return this._fontTemp=new K$gc},"_drawStyleTemp",function(){return this._drawStyleTemp=new K$M(null)}]),K$U.__init$=function(){K$q=function(){function K$c(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=K$gc.EMPTY}K$x(K$c,"");var K$P=K$c.prototype;return K$P.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=K$gc.EMPTY},K$P.make=function(){return this===K$c.DEFAULT?new K$c:this},K$c.DEFAULT=null,K$c}()},K$U}(),K$Qc=function(K$c){function K$_(K$c,K$P){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,K$_.__super.call(this),this.defines=new K$Jc,this.position=K$_._POSITION,this.mainID=K$c,this.subID=K$P,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=K$c|K$P,this._inClassCache=K$_._cache[this._cacheID],0<K$c&&!this._inClassCache&&(this._inClassCache=K$_._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}K$x(K$_,"laya.webgl.shader.d2.value.Value2D",K$s);var K$P=K$_.prototype;return K$P.setValue=function(K$c){},K$P.refresh=function(){var K$c=this.size;return K$c[0]=K$Nc.width,K$c[1]=K$Nc.height,this.alpha=this.ALPHA*K$Nc.worldAlpha,this.mmat=K$Nc.worldMatrix4,this},K$P._ShaderWithCompile=function(){return K$tc.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,K$ic.create)},K$P._withWorldShaderDefines=function(){var K$c=K$Nc.worldShaderDefines,K$P=K$tc.sharders[this.mainID|this.defines._value|K$c.getValue()];if(!K$P){var K$q,K$_={};for(K$q in this.defines.toNameDic())K$_[K$q]="";for(K$q in K$c.toNameDic())K$_[K$q]="";K$P=K$tc.withCompile2D(0,this.mainID,K$_,this.mainID|this.defines._value|K$c.getValue(),K$ic.create)}var K$E=K$Nc.worldFilters;if(!K$E)return K$P;for(var K$b,K$e=K$E.length,K$h=0;K$h<K$e;K$h++)(K$b=K$E[K$h])&&K$b.action.setValue(this);return K$P},K$P.upload=function(){var K$c=K$Nc;this.alpha=this.ALPHA*K$c.worldAlpha,K$Nc.worldMatrix4!==K$Nc.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),K$Tc.shaderHighPrecision&&this.defines.add(1024);var K$P,K$q=K$c.worldShaderDefines?this._withWorldShaderDefines():K$tc.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=K$c.width,this.size[1]=K$c.height,this.mmat=K$c.worldMatrix4,K$oc.activeShader!==K$q?K$q._shaderValueWidth!==K$c.width||K$q._shaderValueHeight!==K$c.height?(K$q._shaderValueWidth=K$c.width,K$q._shaderValueHeight=K$c.height):K$P=K$q._params2dQuick2||K$q._make2dQuick2():K$q._shaderValueWidth!==K$c.width||K$q._shaderValueHeight!==K$c.height?(K$q._shaderValueWidth=K$c.width,K$q._shaderValueHeight=K$c.height):K$P=K$q._params2dQuick1||K$q._make2dQuick1(),K$q.upload(this,K$P)},K$P.setFilters=function(K$c){if(this.filters=K$c)for(var K$P,K$q=K$c.length,K$_=0;K$_<K$q;K$_++)(K$P=K$c[K$_])&&(this.defines.add(K$P.type),K$P.action.setValue(this))},K$P.clear=function(){this.defines.setValue(this.subID)},K$P.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},K$_._initone=function(K$c,K$P){K$_._typeClass[K$c]=K$P,K$_._cache[K$c]=[],K$_._cache[K$c]._length=0},K$_.__init__=function(){K$_._POSITION=[2,5126,!1,4*K$Wc.BYTES_PE,0],K$_._TEXCOORD=[2,5126,!1,4*K$Wc.BYTES_PE,2*K$Wc.BYTES_PE],K$_._initone(2,K$Uc),K$_._initone(4,K$yc),K$_._initone(256,K$Ic),K$_._initone(512,K$sc),K$_._initone(1,K$vc),K$_._initone(65,K$pc),K$_._initone(9,K$vc)},K$_.create=function(K$c,K$P){var K$q=K$_._cache[K$c|K$P];return K$q._length?K$q[--K$q._length]:new K$_._typeClass[K$c|K$P](K$P)},K$_._POSITION=null,K$_._TEXCOORD=null,K$_._cache=[],K$_._typeClass=[],K$_.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],K$_}(),K$dc=function(K$c){function K$w(K$c,K$P){K$w.__super.call(this,K$c,K$P)}K$x(K$w,"laya.webgl.utils.RenderSprite3D",K$N);var K$P=K$w.prototype;return K$P.onCreate=function(K$c){switch(K$c){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},K$P._mask=function(K$c,K$P,K$q,K$_){var K$E,K$b,K$e=this._next,K$h=K$c.mask;if(K$h){K$P.ctx.save();var K$Z=K$P.ctx.globalCompositeOperation,K$S=new K$A;if(K$S.copyFrom(K$h.getBounds()),K$S.width=Math.round(K$S.width),K$S.height=Math.round(K$S.height),K$S.x=Math.round(K$S.x),K$S.y=Math.round(K$S.y),0<K$S.width&&0<K$S.height){var K$n=K$c._style._tf,K$k=K$hc.create();K$k.addValue("bounds",K$S),K$E=K$ec.create([K$k,K$P],laya.webgl.utils.RenderSprite3D.tmpTarget),K$P.addRenderObject(K$E),K$h.render(K$P,-K$S.x,-K$S.y),K$E=K$ec.create([K$k],laya.webgl.utils.RenderSprite3D.endTmpTarget),K$P.addRenderObject(K$E),K$P.ctx.save(),K$P.clipRect(K$q-K$n.translateX+K$S.x,K$_-K$n.translateY+K$S.y,K$S.width,K$S.height),K$e._fun.call(K$e,K$c,K$P,K$q,K$_),K$P.ctx.restore(),K$b=K$nc.create(6),K$Z=K$P.ctx.globalCompositeOperation,K$b.blendMode="mask",K$P.addRenderObject(K$b),K$d.TEMP.identity();var K$x=K$Qc.create(1,0),K$r=K$F.INV_UV,K$g=K$S.width,K$W=K$S.height;(K$S.width<32||K$S.height<32)&&((K$r=K$w.tempUV)[0]=0,K$r[1]=0,K$r[2]=32<=K$S.width?1:K$S.width/32,K$r[3]=0,K$r[4]=32<=K$S.width?1:K$S.width/32,K$r[5]=32<=K$S.height?1:K$S.height/32,K$r[6]=0,K$r[7]=32<=K$S.height?1:K$S.height/32,K$S.width=32<=K$S.width?K$S.width:32,K$S.height=32<=K$S.height?K$S.height:32,K$r[1]*=-1,K$r[3]*=-1,K$r[5]*=-1,K$r[7]*=-1,K$r[1]+=1,K$r[3]+=1,K$r[5]+=1,K$r[7]+=1),K$P.ctx.drawTarget(K$k,K$q+K$S.x-K$n.translateX,K$_+K$S.y-K$n.translateY,K$g,K$W,K$d.TEMP,"tmpTarget",K$x,K$r,6),K$E=K$ec.create([K$k],laya.webgl.utils.RenderSprite3D.recycleTarget),K$P.addRenderObject(K$E),(K$b=K$nc.create(6)).blendMode=K$Z,K$P.addRenderObject(K$b)}K$P.ctx.restore()}else K$e._fun.call(K$e,K$c,K$P,K$q,K$_)},K$P._blend=function(K$c,K$P,K$q,K$_){var K$E=K$c._style,K$b=this._next;K$E.blendMode?(K$P.ctx.save(),K$P.ctx.globalCompositeOperation=K$E.blendMode,K$b._fun.call(K$b,K$c,K$P,K$q,K$_),K$P.ctx.restore()):K$b._fun.call(K$b,K$c,K$P,K$q,K$_)},K$P._transform=function(K$c,K$P,K$q,K$_){var K$E=K$c.transform,K$b=this._next;if(K$E&&K$b!=K$N.NORENDER){var K$e=K$P.ctx;K$c._style;K$E.tx=K$q,K$E.ty=K$_;var K$h=K$e._getTransformMatrix(),K$Z=K$h.clone();K$d.mul(K$E,K$h,K$h),K$h._checkTransform(),K$E.tx=K$E.ty=0,K$b._fun.call(K$b,K$c,K$P,0,0),K$Z.copyTo(K$h),K$Z.destroy()}else K$b._fun.call(K$b,K$c,K$P,K$q,K$_)},K$w.tmpTarget=function(K$c,K$P){var K$q=K$c.getValue("bounds"),K$_=K$ac.create(K$q.width,K$q.height);K$_.start(),K$_.clear(0,0,0,0),K$c.addValue("tmpTarget",K$_)},K$w.endTmpTarget=function(K$c){K$c.getValue("tmpTarget").end()},K$w.recycleTarget=function(K$c){K$c.getValue("tmpTarget").recycle(),K$c.recycle()},K$e(K$w,["tempUV",function(){return this.tempUV=new Array(8)}]),K$w}(),K$uc=function(K$c){function K$P(){this.data=null,K$P.__super.call(this)}K$x(K$P,"laya.filters.webgl.ColorFilterActionGL",K$Y);var K$q=K$P.prototype;return K$L.imps(K$q,{"laya.filters.IFilterActionGL":!0}),K$q.setValue=function(K$c){K$c.colorMat=this.data._mat,K$c.colorAlpha=this.data._alpha},K$q.apply3d=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$c.getValue("bounds"),K$e=K$Qc.create(1,0);K$e.setFilters([this.data]);var K$h=K$d.TEMP;K$h.identity(),K$q.ctx.drawTarget(K$c,0,0,K$b.width,K$b.height,K$h,"src",K$e)},K$P}(),K$Ac=function(K$c){function K$b(K$c,K$P,K$q,K$_,K$E){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,K$b.__super.call(this,K$c,K$P,K$E),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new K$Mc,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=K$q,this._atlasCanvas.height=K$_,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}K$x(K$b,"laya.webgl.atlas.Atlaser",K$U);var K$P=K$b.prototype;return K$P.computeUVinAtlasTexture=function(K$c,K$P,K$q,K$_){var K$E=K$I.atlasTextureWidth,K$b=K$I.atlasTextureHeight,K$e=K$q/K$E,K$h=K$_/K$b,K$Z=(K$q+K$c.bitmap.width)/K$E,K$S=(K$_+K$c.bitmap.height)/K$b,K$n=K$c.bitmap.width/K$E,K$k=K$c.bitmap.height/K$b;K$c.uv=[K$e+K$P[0]*K$n,K$h+K$P[1]*K$k,K$Z-(1-K$P[2])*K$n,K$h+K$P[3]*K$k,K$Z-(1-K$P[4])*K$n,K$S-(1-K$P[5])*K$k,K$e+K$P[6]*K$n,K$S-(1-K$P[7])*K$k]},K$P.findBitmapIsExist=function(K$c){if(K$c instanceof laya.webgl.resource.WebGLImage){var K$P=K$c,K$q=K$P.url,K$_=this._InAtlasWebGLImagesKey[K$q||K$P.id];if(K$_)return K$_.offsetInfoID}return-1},K$P.addToAtlasTexture=function(K$c,K$P,K$q){if(K$c instanceof laya.webgl.resource.WebGLImage){var K$_=K$c,K$E=K$_.url;this._InAtlasWebGLImagesKey[K$E||K$_.id]={bitmap:K$c,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([K$P,K$q])}this._atlasCanvas.texSubImage2D(K$P,K$q,K$c.atlasSource),K$c.clearAtlasSource()},K$P.addToAtlas=function(K$c,K$P,K$q){K$c._atlasID=this._inAtlasTextureKey.length;var K$_=K$c.uv.slice(),K$E=K$c.bitmap;this._inAtlasTextureKey.push(K$c),this._inAtlasTextureOriUVValue.push(K$_),this._inAtlasTextureBitmapValue.push(K$E),this.computeUVinAtlasTexture(K$c,K$_,K$P,K$q),K$c.bitmap=this._atlasCanvas},K$P.clear=function(){for(var K$c=0,K$P=this._inAtlasTextureKey.length;K$c<K$P;K$c++)this._inAtlasTextureKey[K$c].bitmap=this._inAtlasTextureBitmapValue[K$c],this._inAtlasTextureKey[K$c].uv=this._inAtlasTextureOriUVValue[K$c],this._inAtlasTextureKey[K$c]._atlasID=-1,this._inAtlasTextureKey[K$c].bitmap.lock=!1,this._inAtlasTextureKey[K$c].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},K$P.dispose=function(){this.clear(),this._atlasCanvas.destroy()},K$_(0,K$P,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),K$_(0,K$P,"texture",function(){return this._atlasCanvas}),K$_(0,K$P,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),K$b}(),K$Jc=function(K$c){function K$q(){K$q.__super.call(this,K$q.__name2int,K$q.__int2name,K$q.__int2nameMap)}return K$x(K$q,"laya.webgl.shader.d2.ShaderDefines2D",K$G),K$q.__init__=function(){K$q.reg("TEXTURE2D",1),K$q.reg("COLOR2D",2),K$q.reg("PRIMITIVE",4),K$q.reg("GLOW_FILTER",8),K$q.reg("BLUR_FILTER",16),K$q.reg("COLOR_FILTER",32),K$q.reg("COLOR_ADD",64),K$q.reg("WORLDMAT",128),K$q.reg("FILLTEXTURE",256),K$q.reg("FSHIGHPRECISION",1024),K$q.reg("TXTALPHA",2048),K$q.reg("TXTCOMPRESS",4096)},K$q.reg=function(K$c,K$P){K$G._reg(K$c,K$P,K$q.__name2int,K$q.__int2name)},K$q.toText=function(K$c,K$P,K$q){return K$G._toText(K$c,K$P,K$q)},K$q.toInt=function(K$c){return K$G._toInt(K$c,K$q.__name2int)},K$q.TEXTURE2D=1,K$q.COLOR2D=2,K$q.PRIMITIVE=4,K$q.FILTERGLOW=8,K$q.FILTERBLUR=16,K$q.FILTERCOLOR=32,K$q.COLORADD=64,K$q.WORLDMAT=128,K$q.FILLTEXTURE=256,K$q.SKINMESH=512,K$q.SHADERDEFINE_FSHIGHPRECISION=1024,K$q.TXTALPHA=2048,K$q.TXTCOMPRESS=4096,K$q.__name2int={},K$q.__int2name=[],K$q.__int2nameMap=[],K$q}(),K$jc=(function(K$c){function K$h(K$c,K$P,K$q,K$_,K$E,K$b,K$e){K$h.__super.call(this,K$c,K$P,K$q,K$_,40,K$E,K$b,K$e)}K$x(K$h,"laya.webgl.shapes.Ellipse",K$qc)}(),function(K$c){function K$b(K$c,K$P,K$q,K$_,K$E){this._points=[],this.rebuild(K$q),K$b.__super.call(this,K$c,K$P,0,0,0,K$E,K$_,K$E,0)}K$x(K$b,"laya.webgl.shapes.Line",K$qc);var K$P=K$b.prototype;return K$P.rebuild=function(K$c){var K$P=K$c.length;K$P!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(K$P/2-1)),this.mFloat32Array=new Float32Array(5*K$P)),this._points.length=0;for(var K$q=NaN,K$_=NaN,K$E=-1,K$b=-1,K$e=K$c.length/2,K$h=0;K$h<K$e;K$h++)K$q=K$c[2*K$h],K$_=K$c[2*K$h+1],(.01<Math.abs(K$E-K$q)||.01<Math.abs(K$b-K$_))&&this._points.push(K$q,K$_),K$E=K$q,K$b=K$_},K$P.getData=function(K$c,K$P,K$q){var K$_=[],K$E=[];0<this.borderWidth&&this.createLine2(this._points,K$_,this.borderWidth,K$q,K$E,this._points.length/2),this.mUint16Array.set(K$_,0),this.mFloat32Array.set(K$E,0),K$c.append(this.mUint16Array),K$P.append(this.mFloat32Array)},K$b}()),K$Vc=function(K$c){function K$k(K$c,K$P,K$q,K$_,K$E){this._points=[];for(var K$b=NaN,K$e=NaN,K$h=-1,K$Z=-1,K$S=K$q.length/2-1,K$n=0;K$n<K$S;K$n++)K$b=K$q[2*K$n],K$e=K$q[2*K$n+1],(.01<Math.abs(K$h-K$b)||.01<Math.abs(K$Z-K$e))&&this._points.push(K$b,K$e),K$h=K$b,K$Z=K$e;K$b=K$q[2*K$S],K$e=K$q[2*K$S+1],K$h=this._points[0],K$Z=this._points[1],(.01<Math.abs(K$h-K$b)||.01<Math.abs(K$Z-K$e))&&this._points.push(K$b,K$e),K$k.__super.call(this,K$c,K$P,0,0,this._points.length/2,0,K$_,K$E)}K$x(K$k,"laya.webgl.shapes.LoopLine",K$qc);var K$P=K$k.prototype;return K$P.getData=function(K$c,K$P,K$q){if(0<this.borderWidth){for(var K$_=this.color,K$E=(K$_>>16&255)/255,K$b=(K$_>>8&255)/255,K$e=(255&K$_)/255,K$h=[],K$Z=0,K$S=0,K$n=[],K$k=Math.floor(this._points.length/2),K$x=0;K$x<K$k;K$x++)K$Z=this._points[2*K$x],K$S=this._points[2*K$x+1],K$h.push(this.x+K$Z,this.y+K$S,K$E,K$b,K$e);this.createLoopLine(K$h,K$n,this.borderWidth,K$q+K$h.length/5),K$c.append(new Uint16Array(K$n)),K$P.append(new Float32Array(K$h))}},K$P.createLoopLine=function(K$c,K$P,K$q,K$_,K$E,K$b){K$c.length;var K$e=K$c.concat(),K$h=K$E||K$c,K$Z=this.borderColor,K$S=(K$Z>>16&255)/255,K$n=(K$Z>>8&255)/255,K$k=(255&K$Z)/255,K$x=[K$e[0],K$e[1]],K$r=[K$e[K$e.length-5],K$e[K$e.length-4]],K$g=K$r[0]+.5*(K$x[0]-K$r[0]),K$W=K$r[1]+.5*(K$x[1]-K$r[1]);K$e.unshift(K$g,K$W,0,0,0),K$e.push(K$g,K$W,0,0,0);var K$w,K$O,K$N,K$m,K$T,K$D,K$L,K$H,K$Q,K$d,K$u,K$A,K$J,K$j,K$V,K$R,K$$,K$C,K$F,K$o,K$a=K$e.length/5,K$Y=K$_,K$s=K$q/2;K$N=K$e[0],K$m=K$e[1],K$d=K$N-(K$T=K$e[5]),K$Q=(K$Q=-(K$m-(K$D=K$e[6])))/(K$o=Math.sqrt(K$Q*K$Q+K$d*K$d))*K$s,K$d=K$d/K$o*K$s,K$h.push(K$N-K$Q,K$m-K$d,K$S,K$n,K$k,K$N+K$Q,K$m+K$d,K$S,K$n,K$k);for(var K$U=1;K$U<K$a-1;K$U++)K$N=K$e[5*(K$U-1)],K$m=K$e[5*(K$U-1)+1],K$T=K$e[5*K$U],K$D=K$e[5*K$U+1],K$L=K$e[5*(K$U+1)],K$H=K$e[5*(K$U+1)+1],K$d=K$N-K$T,K$A=K$T-K$L,K$V=(-(K$Q=(K$Q=-(K$m-K$D))/(K$o=Math.sqrt(K$Q*K$Q+K$d*K$d))*K$s)+K$N)*(-(K$d=K$d/K$o*K$s)+K$D)-(-K$Q+K$T)*(-K$d+K$m),K$C=(-(K$u=(K$u=-(K$D-K$H))/(K$o=Math.sqrt(K$u*K$u+K$A*K$A))*K$s)+K$L)*(-(K$A=K$A/K$o*K$s)+K$D)-(-K$u+K$T)*(-K$A+K$H),K$F=(K$J=-K$d+K$m-(-K$d+K$D))*(K$$=-K$u+K$T-(-K$u+K$L))-(K$R=-K$A+K$H-(-K$A+K$D))*(K$j=-K$Q+K$T-(-K$Q+K$N)),Math.abs(K$F)<.1?(K$F+=10.1,K$h.push(K$T-K$Q,K$D-K$d,K$S,K$n,K$k,K$T+K$Q,K$D+K$d,K$S,K$n,K$k)):(((K$w=(K$j*K$C-K$$*K$V)/K$F)-K$T)*(K$w-K$T)+((K$O=(K$R*K$V-K$J*K$C)/K$F)-K$D)+(K$O-K$D),K$h.push(K$w,K$O,K$S,K$n,K$k,K$T-(K$w-K$T),K$D-(K$O-K$D),K$S,K$n,K$k));K$b&&(K$P=K$b);var K$I=this.edges+1;for(K$U=1;K$U<K$I;K$U++)K$P.push(K$Y+2*(K$U-1),K$Y+2*(K$U-1)+1,K$Y+2*K$U+1,K$Y+2*K$U+1,K$Y+2*K$U,K$Y+2*(K$U-1));return K$P.push(K$Y+2*(K$U-1),K$Y+2*(K$U-1)+1,K$Y+1,K$Y+1,K$Y,K$Y+2*(K$U-1)),K$h},K$k}(),K$Rc=function(K$c){function K$e(K$c,K$P,K$q,K$_,K$E,K$b){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=K$d.create(),this._points=K$q.slice(0,K$q.length),K$e.__super.call(this,K$c,K$P,0,0,this._points.length/2,K$_,K$E,K$b)}K$x(K$e,"laya.webgl.shapes.Polygon",K$qc);var K$P=K$e.prototype;return K$P.rebuild=function(K$c){this._repaint||(this._points.length=0,this._points=this._points.concat(K$c))},K$P.setMatrix=function(K$c){K$c.copyTo(this._mat)},K$P.needUpdate=function(K$c){return this._repaint=this._mat.a==K$c.a&&this._mat.b==K$c.b&&this._mat.c==K$c.c&&this._mat.d==K$c.d&&this._mat.tx==K$c.tx&&this._mat.ty==K$c.ty,!this._repaint},K$P.getData=function(K$c,K$P,K$q){var K$_,K$E=0,K$b=this._points,K$e=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=K$q){for(this._start=K$q,K$_=[],K$e=this.earcutTriangles.length,K$E=0;K$E<K$e;K$E++)K$_.push(this.earcutTriangles[K$E]+K$q);this.mUint16Array=new Uint16Array(K$_)}}else{this._start=K$q,K$_=[];var K$h=[],K$Z=[],K$S=this.color,K$n=(K$S>>16&255)/255,K$k=(K$S>>8&255)/255,K$x=(255&K$S)/255;for(K$e=Math.floor(K$b.length/2),K$E=0;K$E<K$e;K$E++)K$h.push(this.x+K$b[2*K$E],this.y+K$b[2*K$E+1],K$n,K$k,K$x),K$Z.push(this.x+K$b[2*K$E],this.y+K$b[2*K$E+1]);for(this.earcutTriangles=K$_c.earcut(K$Z,null,2),K$e=this.earcutTriangles.length,K$E=0;K$E<K$e;K$E++)K$_.push(this.earcutTriangles[K$E]+K$q);this.mUint16Array=new Uint16Array(K$_),this.mFloat32Array=new Float32Array(K$h)}K$c.append(this.mUint16Array),K$P.append(this.mFloat32Array)},K$e}(),K$$c=function(K$c){function K$b(){this._matrix=new K$d,this._matrix4=K$Wc.defaultMatrix4.concat(),K$b.__super.call(this,1e4),this.shaderValue=new K$Qc(0,0)}K$x(K$b,"laya.webgl.submit.SubmitCanvas",K$bc);var K$P=K$b.prototype;return K$P.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var K$c=K$Nc.worldAlpha,K$P=K$Nc.worldMatrix4,K$q=K$Nc.worldMatrix,K$_=K$Nc.worldFilters,K$E=K$Nc.worldShaderDefines,K$b=this.shaderValue,K$e=this._matrix,K$h=this._matrix4,K$Z=K$d.TEMP;return K$d.mul(K$e,K$q,K$Z),K$h[0]=K$Z.a,K$h[1]=K$Z.b,K$h[4]=K$Z.c,K$h[5]=K$Z.d,K$h[12]=K$Z.tx,K$h[13]=K$Z.ty,K$Nc.worldMatrix=K$Z.clone(),K$Nc.worldMatrix4=K$h,K$Nc.worldAlpha=K$Nc.worldAlpha*K$b.alpha,K$b.filters&&K$b.filters.length&&(K$Nc.worldFilters=K$b.filters,K$Nc.worldShaderDefines=K$b.defines),this._ctx_src.flush(),K$Nc.worldAlpha=K$c,K$Nc.worldMatrix4=K$P,K$Nc.worldMatrix.destroy(),K$Nc.worldMatrix=K$q,K$Nc.worldFilters=K$_,K$Nc.worldShaderDefines=K$E,1},K$P.releaseRender=function(){var K$c=K$b._cache;this._ctx_src=null,K$c[K$c._length++]=this},K$P.getRenderType=function(){return 10003},K$b.create=function(K$c,K$P,K$q){var K$_=K$b._cache._length?K$b._cache[--K$b._cache._length]:new K$b;K$_._ctx_src=K$c;var K$E=K$_.shaderValue;return K$E.alpha=K$P,K$E.defines.setValue(0),K$q&&K$q.length&&K$E.setFilters(K$q),K$_},K$b._cache=((K$b._cache=[])._length=0,K$b._cache),K$b}(),K$Cc=function(K$c){function K$S(K$c){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===K$c&&(K$c=1e4),K$S.__super.call(this,K$c)}K$x(K$S,"laya.webgl.submit.SubmitTexture",K$bc);var K$P=K$S.prototype;return K$P.releaseRender=function(){var K$c=K$S._cache;(K$c[K$c._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},K$P.addTexture=function(K$c,K$P){this._texsID[this._texs.length]=K$c._uvID,this._texs.push(K$c),this._vbPos.push(K$P)},K$P.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var K$c=this.shaderValue.textureHost.bitmap;if(null!==K$c)for(var K$P=this._vb.getFloat32Array(),K$q=0,K$_=this._texs.length;K$q<K$_;K$q++){var K$E=this._texs[K$q];K$E.active();var K$b=K$E.uv;if(this._texsID[K$q]!==K$E._uvID){this._texsID[K$q]=K$E._uvID;var K$e=this._vbPos[K$q];K$P[K$e+2]=K$b[0],K$P[K$e+3]=K$b[1],K$P[K$e+6]=K$b[2],K$P[K$e+7]=K$b[3],K$P[K$e+10]=K$b[4],K$P[K$e+11]=K$b[5],K$P[K$e+14]=K$b[6],K$P[K$e+15]=K$b[7],this._vb.setNeedUpload()}K$E.bitmap!==K$c&&(this._isSameTexture=!1)}}},K$P.renderSubmit=function(){if(0===this._numEle)return K$S._shaderSet=!1,1;var K$c=this.shaderValue.textureHost;if(K$c){var K$P=K$c.source;if(!K$c.bitmap||!K$P)return K$S._shaderSet=!1,1;this.shaderValue.texture=K$P,K$c.alphaTexture&&K$c.alphaTexture.source&&(this.shaderValue.texture1=K$c.alphaTexture.source)}this._vb.bind_upload(this._ib);var K$q=K$Tc.mainContext;if(K$y.activeBlendFunction!==this._blendFn&&(K$q.enable(3042),this._blendFn(K$q),K$y.activeBlendFunction=this._blendFn),K$V.drawCall++,K$V.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&K$oc.activeShader&&K$S._shaderSet?(K$oc.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&K$oc.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),K$S._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var K$_=K$c.bitmap,K$E=0,K$b=K$oc.activeShader,K$e=0,K$h=this._texs.length;K$e<K$h;K$e++){var K$Z=this._texs[K$e];K$Z.bitmap===K$_&&K$e+1!==K$h||(K$b.uploadTexture2D(K$Z.source),K$q.drawElements(4,6*(K$e-K$E+1),5123,this._startIdx+6*K$E*K$Wc.BYTES_PIDX),K$_=K$Z.bitmap,K$E=K$e)}else K$q.drawElements(4,this._numEle,5123,this._startIdx);return 1},K$S.create=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$S._cache._length?K$S._cache[--K$S._cache._length]:new K$S;null==K$q&&((K$q=K$b._selfVb||(K$b._selfVb=K$Gc.create(-1))).clear(),K$_=0),K$b._ib=K$P,K$b._vb=K$q,K$b._startIdx=K$_*K$Wc.BYTES_PIDX,K$b._numEle=0;var K$e=K$c._nBlendType;K$b._blendFn=K$c._targets?K$y.targetFns[K$e]:K$y.fns[K$e],K$b.shaderValue=K$E,K$b.shaderValue.setValue(K$c._shader2D);var K$h=K$c._shader2D.filters;return K$h&&K$b.shaderValue.setFilters(K$h),K$b},K$S._cache=((K$S._cache=[])._length=0,K$S._cache),K$S._shaderSet=!0,K$S}(),K$Fc=function(K$c){function K$O(){K$O.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}K$x(K$O,"laya.webgl.utils.MeshTexture",K$Oc);var K$P=K$O.prototype;return K$P.addData=function(K$c,K$P,K$q,K$_,K$E,K$b){for(var K$e=K$c.length/2,K$h=this._vb.needSize(K$e*K$O.const_stride)>>2,K$Z=this._vb.getFloat32Array(),K$S=0,K$n=0;K$n<K$e;K$n++){var K$k=K$c[K$S],K$x=K$c[K$S+1],K$r=K$k*K$_.a+K$x*K$_.c+K$_.tx,K$g=K$k*K$_.b+K$x*K$_.d+K$_.ty;K$Z[K$h++]=K$r,K$Z[K$h++]=K$g,K$Z[K$h++]=K$P[K$S],K$Z[K$h++]=K$P[K$S+1],K$S+=2}this._vb.setNeedUpload();var K$W=this.vertNum;if(0<K$W){(K$e=K$q.length)>K$O.tmpIdx.length&&(K$O.tmpIdx=new Uint16Array(K$e));for(var K$w=0;K$w<K$e;K$w++)K$O.tmpIdx[K$w]=K$q[K$w]+K$W;this._ib.appendU16Array(K$O.tmpIdx,K$q.length)}else this._ib.append(K$q);this._ib.setNeedUpload(),this.vertNum+=K$e,this.indexNum+=K$q.length},K$P.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},K$P.destroy=function(){this._ib.destroy(),this._vb.destroy()},K$O.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new K$O},K$O.const_stride=16,K$O._POOL=[],K$e(K$O,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),K$O}(),K$oc=function(K$c){function K$P(){K$P.__super.call(this),this.lock=!0}return K$x(K$P,"laya.webgl.shader.BaseShader",K$m),K$P.activeShader=null,K$P.bindShader=null,K$P}(),K$ac=function(K$P){function K$n(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===K$q&&(K$q=6408),void 0===K$_&&(K$_=5121),void 0===K$E&&(K$E=34041),void 0===K$b&&(K$b=!1),void 0===K$e&&(K$e=!1),void 0===K$h&&(K$h=-1),void 0===K$Z&&(K$Z=-1),this._type=1,this._w=K$c,this._h=K$P,this._surfaceFormat=K$q,this._surfaceType=K$_,this._depthStencilFormat=K$E,K$O.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=K$b,this._repeat=K$e,this._minFifter=K$h,this._magFifter=K$Z,this._createWebGLRenderTarget(),this.bitmap.lock=!0,K$n.__super.call(this,this.bitmap,K$F.INV_UV)}K$x(K$n,"laya.webgl.resource.RenderTarget2D",K$P);var K$c=K$n.prototype;return K$L.imps(K$c,{"laya.resource.IDispose":!0}),K$c.getType=function(){return this._type},K$c.getTexture=function(){return this},K$c.size=function(K$c,K$P){this._w==K$c&&this._h==K$P||(this._w=K$c,this._h=K$P,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},K$c.release=function(){this.destroy()},K$c.recycle=function(){K$n.POOL.push(this)},K$c.start=function(){var K$c=K$Tc.mainContext;return this._preRenderTarget=K$Nc.curRenderTarget,K$Nc.curRenderTarget=this,K$c.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(K$c.viewport(0,0,this._w,this._h),this._svWidth=K$Nc.width,this._svHeight=K$Nc.height,K$Nc.width=this._w,K$Nc.height=this._h,K$oc.activeShader=null),this},K$c.clear=function(K$c,K$P,K$q,K$_){void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=1);var K$E=K$Tc.mainContext;K$E.clearColor(K$c,K$P,K$q,K$_);var K$b=16384;switch(this._depthStencilFormat){case 33189:K$b|=256;break;case 36168:K$b|=1024;break;case 34041:K$b|=256,K$b|=1024}K$E.clear(K$b)},K$c.end=function(){var K$c=K$Tc.mainContext;K$c.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,K$Nc.curRenderTarget=this._preRenderTarget,1==this._type?(K$c.viewport(0,0,this._svWidth,this._svHeight),K$Nc.width=this._svWidth,K$Nc.height=this._svHeight,K$oc.activeShader=null):K$c.viewport(0,0,K$L.stage.width,K$L.stage.height)},K$c.getData=function(K$c,K$P,K$q,K$_){var K$E=K$Tc.mainContext;if(K$E.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===K$E.checkFramebufferStatus(36160)))return K$E.bindFramebuffer(36160,null),null;var K$b=new Uint8Array(this._w*this._h*4);return K$E.readPixels(K$c,K$P,K$q,K$_,this._surfaceFormat,this._surfaceType,K$b),K$E.bindFramebuffer(36160,null),K$b},K$c.destroy=function(K$c){void 0===K$c&&(K$c=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,K$P.prototype.destroy.call(this))},K$c.dispose=function(){},K$c._createWebGLRenderTarget=function(){this.bitmap=new K$fc(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(K$c){this.event("recovered")})},K$_(0,K$c,"surfaceFormat",function(){return this._surfaceFormat}),K$_(0,K$c,"magFifter",function(){return this._magFifter}),K$_(0,K$c,"surfaceType",function(){return this._surfaceType}),K$_(0,K$c,"mipMap",function(){return this._mipMap}),K$_(0,K$c,"depthStencilFormat",function(){return this._depthStencilFormat}),K$_(0,K$c,"minFifter",function(){return this._minFifter}),K$_(0,K$c,"source",function(){return this._alreadyResolved?K$L.superGet(K$F,this,"source"):null}),K$n.create=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){void 0===K$q&&(K$q=6408),void 0===K$_&&(K$_=5121),void 0===K$E&&(K$E=34041),void 0===K$b&&(K$b=!1),void 0===K$e&&(K$e=!1),void 0===K$h&&(K$h=-1),void 0===K$Z&&(K$Z=-1);var K$S=K$n.POOL.pop();return K$S||(K$S=new K$n(K$c,K$P)),K$S.bitmap&&K$S._w==K$c&&K$S._h==K$P&&K$S._surfaceFormat==K$q&&K$S._surfaceType==K$_&&K$S._depthStencilFormat==K$E&&K$S._mipMap==K$b&&K$S._repeat==K$e&&K$S._minFifter==K$h&&K$S._magFifter==K$Z||(K$S._w=K$c,K$S._h=K$P,K$S._surfaceFormat=K$q,K$S._surfaceType=K$_,K$S._depthStencilFormat=K$E,K$O.isConchWebGL&&34041===K$S._depthStencilFormat&&(K$S._depthStencilFormat=33189),K$S._mipMap=K$b,K$S._repeat=K$e,K$S._minFifter=K$h,K$S._magFifter=K$Z,K$S.release(),K$S._createWebGLRenderTarget()),K$S},K$n.TYPE2D=1,K$n.TYPE3D=2,K$n.POOL=[],K$n}(K$F),K$Yc=function(K$c){function K$P(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,K$P.__super.call(this),K$P._gl=K$Tc.mainContext}K$x(K$P,"laya.webgl.utils.Buffer",K$m);var K$q=K$P.prototype;return K$q._bind=function(){this.activeResource(),K$P._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(K$P._bindVertexBuffer=this._glBuffer),K$P._gl.bindBuffer(this._bufferType,K$P._bindActive[this._bufferType]=this._glBuffer),K$oc.activeShader=null)},K$q.recreateResource=function(){this._glBuffer||(this._glBuffer=K$P._gl.createBuffer()),this.completeCreate()},K$q.disposeResource=function(){this._glBuffer&&(K$Tc.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},K$_(0,K$q,"bufferUsage",function(){return this._bufferUsage}),K$P._gl=null,K$P._bindActive={},K$P._bindVertexBuffer=null,K$P._enableAtributes=[],K$P}(),K$sc=function(K$c){function K$q(K$c){this.texcoord=null,this.offsetX=300,this.offsetY=0,K$q.__super.call(this,512,0);var K$P=8*K$Wc.BYTES_PE;this.position=[2,5126,!1,K$P,0],this.texcoord=[2,5126,!1,K$P,2*K$Wc.BYTES_PE],this.color=[4,5126,!1,K$P,4*K$Wc.BYTES_PE]}return K$x(K$q,"laya.webgl.shader.d2.skinAnishader.SkinSV",K$Qc),K$q}(),K$Uc=function(K$c){function K$P(K$c){K$P.__super.call(this,2,0),this.color=[]}return K$x(K$P,"laya.webgl.shader.d2.value.Color2dSV",K$Qc),K$P.prototype.setValue=function(K$c){K$c.fillStyle&&(this.color=K$c.fillStyle._color._color),K$c.strokeStyle&&(this.color=K$c.strokeStyle._color._color)},K$P}(),K$Ic=function(K$c){function K$P(K$c){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=K$Qc._TEXCOORD,K$P.__super.call(this,256,0)}K$x(K$P,"laya.webgl.shader.d2.value.FillTextureSV",K$Qc);var K$q=K$P.prototype;return K$q.setValue=function(K$c){this.ALPHA=K$c.ALPHA,K$c.filters&&this.setFilters(K$c.filters)},K$q.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},K$P}(),K$vc=function(K$c){function K$P(K$c){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=K$Qc._TEXCOORD,void 0===K$c&&(K$c=0),K$P.__super.call(this,1,K$c)}K$x(K$P,"laya.webgl.shader.d2.value.TextureSV",K$Qc);var K$q=K$P.prototype;return K$q.setValue=function(K$c){this.ALPHA=K$c.ALPHA,K$c.filters&&this.setFilters(K$c.filters)},K$q.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},K$P}(),K$yc=function(K$c){function K$P(K$c){this.a_color=null,this.u_pos=[0,0],K$P.__super.call(this,4,0),this.position=[2,5126,!1,5*K$Wc.BYTES_PE,0],this.a_color=[3,5126,!1,5*K$Wc.BYTES_PE,2*K$Wc.BYTES_PE]}return K$x(K$P,"laya.webgl.shader.d2.value.PrimitiveSV",K$Qc),K$P}(),K$Mc=function(K$c){function K$P(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,K$P.__super.call(this)}K$x(K$P,"laya.webgl.atlas.AtlasWebGLCanvas",K$c);var K$q=K$P.prototype;return K$q.recreateResource=function(){var K$c=K$Tc.mainContext,K$P=this._source=K$c.createTexture(),K$q=K$Dc.curBindTexTarget,K$_=K$Dc.curBindTexValue;K$Dc.bindTexture(K$c,3553,K$P),K$c.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),K$c.texParameteri(3553,10241,9729),K$c.texParameteri(3553,10240,9729),K$c.texParameteri(3553,10242,33071),K$c.texParameteri(3553,10243,33071),K$q&&K$_&&K$Dc.bindTexture(K$c,K$q,K$_),this.memorySize=this._w*this._h*4,this.completeCreate()},K$q.disposeResource=function(){this._source&&(K$Tc.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},K$q.texSubImage2D=function(K$c,K$P,K$q){if(K$O.isFlash){this._flashCacheImage||(this._flashCacheImage=K$W.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var K$_=K$q.bitmapdata;this._flashCacheImage._image.copyPixels(K$_,0,0,K$_.width,K$_.height,K$c,K$P),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var K$E=K$Tc.mainContext,K$b=K$Dc.curBindTexTarget,K$e=K$Dc.curBindTexValue;K$Dc.bindTexture(K$E,3553,this._source),K$E.pixelStorei(37441,!0),0<=K$c-1&&K$E.texSubImage2D(3553,0,K$c-1,K$P,6408,5121,K$q),K$c+1<=this._w&&K$E.texSubImage2D(3553,0,K$c+1,K$P,6408,5121,K$q),0<=K$P-1&&K$E.texSubImage2D(3553,0,K$c,K$P-1,6408,5121,K$q),K$P+1<=this._h&&K$E.texSubImage2D(3553,0,K$c,K$P+1,6408,5121,K$q),K$E.texSubImage2D(3553,0,K$c,K$P,6408,5121,K$q),K$E.pixelStorei(37441,!1),K$b&&K$e&&K$Dc.bindTexture(K$E,K$b,K$e)}},K$q.texSubImage2DPixel=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$Tc.mainContext,K$e=K$Dc.curBindTexTarget,K$h=K$Dc.curBindTexValue;K$Dc.bindTexture(K$b,3553,this._source);var K$Z=new Uint8Array(K$E.data);K$b.pixelStorei(37441,!0),K$b.texSubImage2D(3553,0,K$c,K$P,K$q,K$_,6408,5121,K$Z),K$b.pixelStorei(37441,!1),K$e&&K$h&&K$Dc.bindTexture(K$b,K$e,K$h)},K$_(0,K$q,"width",K$c.prototype._$get_width,function(K$c){this._w=K$c}),K$_(0,K$q,"height",K$c.prototype._$get_height,function(K$c){this._h=K$c}),K$P}(K$q),K$zc=function(K$c){function K$E(){this.flipY=!0,this.alwaysChange=!1,K$E.__super.call(this)}K$x(K$E,"laya.webgl.resource.WebGLCanvas",K$q);var K$P=K$E.prototype;return K$P.getCanvas=function(){return this._canvas},K$P.clear=function(){this._ctx&&this._ctx.clear()},K$P.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},K$P._setContext=function(K$c){this._ctx=K$c},K$P.getContext=function(K$c,K$P){return this._ctx?this._ctx:this._ctx=K$E._createContext(this)},K$P.size=function(K$c,K$P){this._w==K$c&&this._h==K$P||(this._w=K$c,this._h=K$P,this._ctx&&this._ctx.size(K$c,K$P),this._canvas&&(this._canvas.height=K$P,this._canvas.width=K$c))},K$P.activeResource=function(K$c){void 0===K$c&&(K$c=!1),this._source||this.recreateResource()},K$P.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},K$P.disposeResource=function(){this._source&&!this.iscpuSource&&(K$Tc.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},K$P.createWebGlTexture=function(){var K$c=K$Tc.mainContext;this._canvas;var K$P=this._source=K$c.createTexture();this.iscpuSource=!1;var K$q=K$Dc.curBindTexTarget,K$_=K$Dc.curBindTexValue;K$Dc.bindTexture(K$c,3553,K$P),K$c.pixelStorei(37440,this.flipY?1:0),K$E.premulAlpha&&K$c.pixelStorei(37441,!0),K$c.texImage2D(3553,0,6408,6408,5121,this._imgData),K$E.premulAlpha&&K$c.pixelStorei(37441,!1),K$c.texParameteri(3553,10240,9729),K$c.texParameteri(3553,10241,9729),K$c.texParameteri(3553,10242,33071),K$c.texParameteri(3553,10243,33071),K$c.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,K$q&&K$_&&K$Dc.bindTexture(K$c,K$q,K$_)},K$P.reloadCanvasData=function(){var K$c=K$Tc.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var K$P=K$Dc.curBindTexTarget,K$q=K$Dc.curBindTexValue;K$Dc.bindTexture(K$c,3553,this._source),K$E.premulAlpha&&K$c.pixelStorei(37441,!0),K$c.texImage2D(3553,0,6408,6408,5121,this._imgData),K$E.premulAlpha&&K$c.pixelStorei(37441,!1),K$c.pixelStorei(37440,0),K$P&&K$q&&K$Dc.bindTexture(K$c,K$P,K$q)},K$P.texSubImage2D=function(K$c,K$P,K$q){var K$_=K$Tc.mainContext,K$E=K$Dc.curBindTexTarget,K$b=K$Dc.curBindTexValue;K$Dc.bindTexture(K$_,3553,this._source),K$_.pixelStorei(37441,!0),K$_.texSubImage2D(3553,0,K$P,K$q,6408,5121,K$c._source),K$_.pixelStorei(37441,!1),K$E&&K$b&&K$Dc.bindTexture(K$_,K$E,K$b)},K$P.toBase64=function(K$c,K$P,K$q){var K$_=null;this._canvas&&(K$_=this._canvas.toDataURL(K$c,K$P)),K$q.call(this,K$_)},K$_(0,K$P,"context",function(){return this._ctx}),K$_(0,K$P,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),K$_(0,K$P,"asBitmap",null,function(K$c){this._ctx&&(this._ctx.asBitmap=K$c)}),K$E._createContext=null,K$E.premulAlpha=!1,K$E}(),K$Xc=function(K$c){function K$b(K$c,K$P){this.CborderSize=12,K$b.__super.call(this),this.char=K$c,this.isSpace=" "===K$c,this.xs=K$P.scaleX,this.ys=K$P.scaleY,this.font=K$P.font.toString(),this.fontSize=K$P.font.size,this.fillColor=K$P.fillColor,this.borderColor=K$P.borderColor,this.lineWidth=K$P.lineWidth,this.underLine=K$P.underLine;var K$q,K$_=K$O.isConchApp;K$_?((K$q=ConchTextCanvas)._source=ConchTextCanvas,K$q._source.canvas=ConchTextCanvas):K$q=K$r.canvas.source,this.canvas=K$q,this._enableMerageInAtlas=!0,this._ctx=K$_?K$q:this.canvas.getContext("2d",void 0);var K$E=K$o.measureText(this.char,this.font);this.cw=K$E.width*this.xs,this.ch=(K$E.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new K$F(this)}K$x(K$b,"laya.webgl.resource.WebGLCharImage",K$q);var K$P=K$b.prototype;return K$L.imps(K$P,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),K$P.active=function(){this.texture.active()},K$P.recreateResource=function(){var K$c=K$O.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),K$c){var K$P=this.fontSize;1==this.xs&&1==this.ys||(K$P=parseInt(K$P*(this.xs>this.ys?this.xs:this.ys)+""));var K$q="normal 100 "+this.font;K$q=K$q.replace(K$b._fontSizeReg,K$P),this.borderColor&&(K$q+=" 1 "+this.borderColor),this._ctx.font=K$q,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,K$C.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var K$_=this._ctx.measureText(this.char);K$_||(K$_={width:16});var K$E=K$_.width+1;this._ctx.lineTo(K$E,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},K$P.onresize=function(K$c,K$P){this._w=K$c,this._h=K$P,this._allowMerageInAtlas=!0},K$P.clearAtlasSource=function(){},K$_(0,K$P,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),K$_(0,K$P,"atlasSource",function(){return this.canvas}),K$_(0,K$P,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(K$c){this._enableMerageInAtlas=K$c}),K$b.createOneChar=function(K$c,K$P){return new K$b(K$c,K$P)},K$b._fontSizeReg=new RegExp("\\d+(?=px)","g"),K$b}(),K$fc=function(K$c){function K$S(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){void 0===K$q&&(K$q=6408),void 0===K$_&&(K$_=5121),void 0===K$E&&(K$E=34041),void 0===K$b&&(K$b=!1),void 0===K$e&&(K$e=!1),void 0===K$h&&(K$h=-1),void 0===K$Z&&(K$Z=1),K$S.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=K$c,this._h=K$P,this._surfaceFormat=K$q,this._surfaceType=K$_,this._depthStencilFormat=K$E,this._mipMap=K$b,this._repeat=K$e,this._minFifter=K$h,this._magFifter=K$Z}K$x(K$S,"laya.webgl.resource.WebGLRenderTarget",K$q);var K$P=K$S.prototype;return K$P.recreateResource=function(){var K$c=K$Tc.mainContext;this._frameBuffer||(this._frameBuffer=K$c.createFramebuffer()),this._source||(this._source=K$c.createTexture());var K$P=K$Dc.curBindTexTarget,K$q=K$Dc.curBindTexValue;K$Dc.bindTexture(K$c,3553,this._source),K$c.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var K$_=this._minFifter,K$E=this._magFifter,K$b=this._repeat?10497:33071,K$e=K$n.isPOT(this._w,this._h);if(K$e?(this._mipMap?-1!==K$_||(K$_=9987):-1!==K$_||(K$_=9729),-1!==K$E||(K$E=9729),K$c.texParameteri(3553,10241,K$_),K$c.texParameteri(3553,10240,K$E),K$c.texParameteri(3553,10242,K$b),K$c.texParameteri(3553,10243,K$b),this._mipMap&&K$c.generateMipmap(3553)):(-1!==K$_||(K$_=9729),-1!==K$E||(K$E=9729),K$c.texParameteri(3553,10241,K$_),K$c.texParameteri(3553,10240,K$E),K$c.texParameteri(3553,10242,33071),K$c.texParameteri(3553,10243,33071)),K$c.bindFramebuffer(36160,this._frameBuffer),K$c.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=K$c.createRenderbuffer()),K$c.bindRenderbuffer(36161,this._depthStencilBuffer),K$c.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:K$c.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:K$c.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:K$c.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}K$c.bindFramebuffer(36160,null),K$P&&K$q&&K$Dc.bindTexture(K$c,K$P,K$q),K$c.bindRenderbuffer(36161,null),K$e&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},K$P.disposeResource=function(){this._frameBuffer&&(K$Tc.mainContext.deleteTexture(this._source),K$Tc.mainContext.deleteFramebuffer(this._frameBuffer),K$Tc.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},K$_(0,K$P,"depthStencilBuffer",function(){return this._depthStencilBuffer}),K$_(0,K$P,"frameBuffer",function(){return this._frameBuffer}),K$S}(),K$lc=function(K$c){function K$h(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this.offsetX=0,this.offsetY=0,K$h.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=K$b,this.canvas=K$c,this._ctx=K$c.getContext("2d",void 0),this._w=K$_,this._h=K$E,this.offsetX=K$P,this.offsetY=K$q,this.src=K$e,this._enableMerageInAtlas=!0,K$I.enabled&&this._w<K$I.atlasLimitWidth&&this._h<K$I.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}K$x(K$h,"laya.webgl.resource.WebGLSubImage",K$q);var K$P=K$h.prototype;return K$L.imps(K$P,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),K$P.size=function(K$c,K$P){this._w=K$c,this._h=K$P,this._ctx&&this._ctx.size(K$c,K$P),this.canvas&&(this.canvas.height=K$P,this.canvas.width=K$c)},K$P.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},K$P.createWebGlTexture=function(){var K$c=K$Tc.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var K$P=this._source=K$c.createTexture(),K$q=K$Dc.curBindTexTarget,K$_=K$Dc.curBindTexValue;K$Dc.bindTexture(K$c,3553,K$P),K$c.pixelStorei(37441,!0),K$c.texImage2D(3553,0,6408,6408,5121,this.canvas),K$c.pixelStorei(37441,!1);var K$E=this.minFifter,K$b=this.magFifter,K$e=this.repeat?10497:33071,K$h=K$n.isPOT(this.width,this.height);K$h?(this.mipmap?-1!==K$E||(K$E=9987):-1!==K$E||(K$E=9729),-1!==K$b||(K$b=9729),K$c.texParameteri(3553,10240,K$b),K$c.texParameteri(3553,10241,K$E),K$c.texParameteri(3553,10242,K$e),K$c.texParameteri(3553,10243,K$e),this.mipmap&&K$c.generateMipmap(3553)):(-1!==K$E||(K$E=9729),-1!==K$b||(K$b=9729),K$c.texParameteri(3553,10241,K$E),K$c.texParameteri(3553,10240,K$b),K$c.texParameteri(3553,10242,33071),K$c.texParameteri(3553,10243,33071)),K$q&&K$_&&K$Dc.bindTexture(K$c,K$q,K$_),this.canvas=null,K$h&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},K$P.disposeResource=function(){K$I.enabled&&this._allowMerageInAtlas||!this._source||(K$Tc.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},K$P.clearAtlasSource=function(){},K$_(0,K$P,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),K$_(0,K$P,"atlasSource",function(){return this.canvas}),K$_(0,K$P,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(K$c){this._allowMerageInAtlas=K$c}),K$h}(),K$tc=function(K$c){function K$S(K$c,K$P,K$q,K$_){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,K$S.__super.call(this),!K$c||!K$P)throw"Shader Error";this._id=++K$S._count,this._vs=K$c,this._ps=K$P,this._nameMap=K$_||{},null!=K$q&&(K$S.sharders[K$q]=this)}K$x(K$S,"laya.webgl.shader.Shader",K$oc);var K$P=K$S.prototype;return K$P.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},K$P.disposeResource=function(){K$Tc.mainContext.deleteShader(this._vshader),K$Tc.mainContext.deleteShader(this._pshader),K$Tc.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},K$P._compile=function(){if(!K$Tc.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var K$c=[this._vs,this._ps],K$P=K$Tc.mainContext;if(this._program=K$P.createProgram(),this._vshader=K$S._createShader(K$P,K$c[0],35633),this._pshader=K$S._createShader(K$P,K$c[1],35632),K$P.attachShader(this._program,this._vshader),K$P.attachShader(this._program,this._pshader),K$P.linkProgram(this._program),!K$O.isConchApp&&!K$P.getProgramParameter(this._program,35714))throw K$P.getProgramInfoLog(this._program);var K$q,K$_,K$E=0,K$b=0;for(K$b=K$O.isConchApp?K$P.getProgramParameterEx(this._vs,this._ps,"",35721):K$P.getProgramParameter(this._program,35721),K$E=0;K$E<K$b;K$E++){var K$e=null;K$q={vartype:"attribute",glfun:null,ivartype:0,attrib:K$e=K$O.isConchApp?K$P.getActiveAttribEx(this._vs,this._ps,"",K$E):K$P.getActiveAttrib(this._program,K$E),location:K$P.getAttribLocation(this._program,K$e.name),name:K$e.name,type:K$e.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(K$q)}var K$h=0;for(K$h=K$O.isConchApp?K$P.getProgramParameterEx(this._vs,this._ps,"",35718):K$P.getProgramParameter(this._program,35718),K$E=0;K$E<K$h;K$E++){var K$Z=null;K$Z=K$O.isConchApp?K$P.getActiveUniformEx(this._vs,this._ps,"",K$E):K$P.getActiveUniform(this._program,K$E),0<(K$q={vartype:"uniform",glfun:null,ivartype:1,attrib:K$e,location:K$P.getUniformLocation(this._program,K$Z.name),name:K$Z.name,type:K$Z.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(K$q.name=K$q.name.substr(0,K$q.name.length-3),K$q.isArray=!0,K$q.location=K$P.getUniformLocation(this._program,K$q.name)),this._params.push(K$q)}for(K$E=0,K$_=this._params.length;K$E<K$_;K$E++)if((K$q=this._params[K$E]).indexOfParams=K$E,K$q.index=1,K$q.value=[K$q.location,null],K$q.codename=K$q.name,K$q.name=this._nameMap[K$q.codename]?this._nameMap[K$q.codename]:K$q.codename,(this._paramsMap[K$q.name]=K$q)._this=this,K$q.uploadedValue=[],"attribute"!==K$q.vartype)switch(K$q.type){case 5124:K$q.fun=K$q.isArray?this._uniform1iv:this._uniform1i;break;case 5126:K$q.fun=K$q.isArray?this._uniform1fv:this._uniform1f;break;case 35664:K$q.fun=K$q.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:K$q.fun=K$q.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:K$q.fun=K$q.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:K$q.fun=this._uniform_sampler2D;break;case 35680:K$q.fun=this._uniform_samplerCube;break;case 35676:K$q.glfun=K$P.uniformMatrix4fv,K$q.fun=this._uniformMatrix4fv;break;case 35670:K$q.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else K$q.fun=this._attribute}},K$P.getUniform=function(K$c){return this._paramsMap[K$c]},K$P._attribute=function(K$c,K$P){var K$q=K$Tc.mainContext,K$_=K$Yc._enableAtributes,K$E=K$c.location;return K$_[K$E]||K$q.enableVertexAttribArray(K$E),K$q.vertexAttribPointer(K$E,K$P[0],K$P[1],K$P[2],K$P[3],K$P[4]+this._offset),K$_[K$E]=K$Yc._bindVertexBuffer,1},K$P._uniform1f=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P?(K$Tc.mainContext.uniform1f(K$c.location,K$q[0]=K$P),1):0},K$P._uniform1fv=function(K$c,K$P){if(K$P.length<4){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]||K$q[2]!==K$P[2]||K$q[3]!==K$P[3]?(K$Tc.mainContext.uniform1fv(K$c.location,K$P),K$q[0]=K$P[0],K$q[1]=K$P[1],K$q[2]=K$P[2],K$q[3]=K$P[3],1):0}return K$Tc.mainContext.uniform1fv(K$c.location,K$P),1},K$P._uniform_vec2=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]?(K$Tc.mainContext.uniform2f(K$c.location,K$q[0]=K$P[0],K$q[1]=K$P[1]),1):0},K$P._uniform_vec2v=function(K$c,K$P){if(K$P.length<2){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]||K$q[2]!==K$P[2]||K$q[3]!==K$P[3]?(K$Tc.mainContext.uniform2fv(K$c.location,K$P),K$q[0]=K$P[0],K$q[1]=K$P[1],K$q[2]=K$P[2],K$q[3]=K$P[3],1):0}return K$Tc.mainContext.uniform2fv(K$c.location,K$P),1},K$P._uniform_vec3=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]||K$q[2]!==K$P[2]?(K$Tc.mainContext.uniform3f(K$c.location,K$q[0]=K$P[0],K$q[1]=K$P[1],K$q[2]=K$P[2]),1):0},K$P._uniform_vec3v=function(K$c,K$P){return K$Tc.mainContext.uniform3fv(K$c.location,K$P),1},K$P._uniform_vec4=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]||K$q[2]!==K$P[2]||K$q[3]!==K$P[3]?(K$Tc.mainContext.uniform4f(K$c.location,K$q[0]=K$P[0],K$q[1]=K$P[1],K$q[2]=K$P[2],K$q[3]=K$P[3]),1):0},K$P._uniform_vec4v=function(K$c,K$P){return K$Tc.mainContext.uniform4fv(K$c.location,K$P),1},K$P._uniformMatrix2fv=function(K$c,K$P){return K$Tc.mainContext.uniformMatrix2fv(K$c.location,!1,K$P),1},K$P._uniformMatrix3fv=function(K$c,K$P){return K$Tc.mainContext.uniformMatrix3fv(K$c.location,!1,K$P),1},K$P._uniformMatrix4fv=function(K$c,K$P){return K$Tc.mainContext.uniformMatrix4fv(K$c.location,!1,K$P),1},K$P._uniform1i=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P?(K$Tc.mainContext.uniform1i(K$c.location,K$q[0]=K$P),1):0},K$P._uniform1iv=function(K$c,K$P){return K$Tc.mainContext.uniform1iv(K$c.location,K$P),1},K$P._uniform_ivec2=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]?(K$Tc.mainContext.uniform2i(K$c.location,K$q[0]=K$P[0],K$q[1]=K$P[1]),1):0},K$P._uniform_ivec2v=function(K$c,K$P){return K$Tc.mainContext.uniform2iv(K$c.location,K$P),1},K$P._uniform_vec3i=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]||K$q[2]!==K$P[2]?(K$Tc.mainContext.uniform3i(K$c.location,K$q[0]=K$P[0],K$q[1]=K$P[1],K$q[2]=K$P[2]),1):0},K$P._uniform_vec3vi=function(K$c,K$P){return K$Tc.mainContext.uniform3iv(K$c.location,K$P),1},K$P._uniform_vec4i=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]||K$q[2]!==K$P[2]||K$q[3]!==K$P[3]?(K$Tc.mainContext.uniform4i(K$c.location,K$q[0]=K$P[0],K$q[1]=K$P[1],K$q[2]=K$P[2],K$q[3]=K$P[3]),1):0},K$P._uniform_vec4vi=function(K$c,K$P){return K$Tc.mainContext.uniform4iv(K$c.location,K$P),1},K$P._uniform_sampler2D=function(K$c,K$P){var K$q=K$Tc.mainContext,K$_=K$c.uploadedValue;return null==K$_[0]?(K$_[0]=this._curActTexIndex,K$q.uniform1i(K$c.location,this._curActTexIndex),K$q.activeTexture(K$S._TEXTURES[this._curActTexIndex]),K$Dc.bindTexture(K$q,3553,K$P),this._curActTexIndex++,1):(K$q.activeTexture(K$S._TEXTURES[K$_[0]]),K$Dc.bindTexture(K$q,3553,K$P),0)},K$P._uniform_samplerCube=function(K$c,K$P){var K$q=K$Tc.mainContext,K$_=K$c.uploadedValue;return null==K$_[0]?(K$_[0]=this._curActTexIndex,K$q.uniform1i(K$c.location,this._curActTexIndex),K$q.activeTexture(K$S._TEXTURES[this._curActTexIndex]),K$Dc.bindTexture(K$q,34067,K$P),this._curActTexIndex++,1):(K$q.activeTexture(K$S._TEXTURES[K$_[0]]),K$Dc.bindTexture(K$q,34067,K$P),0)},K$P._noSetValue=function(K$c){console.log("no....:"+K$c.name)},K$P.uploadOne=function(K$c,K$P){this.activeResource(),K$Dc.UseProgram(this._program);var K$q=this._paramsMap[K$c];K$q.fun.call(this,K$q,K$P)},K$P.uploadTexture2D=function(K$c){K$V.shaderCall++;var K$P=K$Tc.mainContext;K$P.activeTexture(33984),K$Dc.bindTexture(K$P,3553,K$c)},K$P.uploadTexture2D1=function(K$c){K$V.shaderCall++;var K$P=K$Tc.mainContext;K$P.activeTexture(33985),K$Dc.bindTexture(K$P,3553,K$c)},K$P.upload=function(K$c,K$P){K$oc.activeShader=K$oc.bindShader=this,this._lastUseFrameCount===K$V.loopCount||this.activeResource(),K$Dc.UseProgram(this._program),this._reCompile?(K$P=this._params,this._reCompile=!1):K$P=K$P||this._params;K$Tc.mainContext;for(var K$q,K$_,K$E=K$P.length,K$b=0,K$e=0;K$e<K$E;K$e++)null!==(K$_=K$c[(K$q=K$P[K$e]).name])&&(K$b+=K$q.fun.call(this,K$q,K$_));K$V.shaderCall+=K$b},K$P.uploadArray=function(K$c,K$P,K$q){K$oc.activeShader=this,(K$oc.bindShader=this).activeResource(),K$Dc.UseProgram(this._program);this._params;for(var K$_,K$E,K$b=0,K$e=K$P-2;0<=K$e;K$e-=2)(K$E=this._paramsMap[K$c[K$e]])&&null!=(K$_=K$c[K$e+1])&&(K$q&&K$q[K$E.name]&&K$q[K$E.name].bind(),K$b+=K$E.fun.call(this,K$E,K$_));K$V.shaderCall+=K$b},K$P.getParams=function(){return this._params},K$S.getShader=function(K$c){return K$S.sharders[K$c]},K$S.create=function(K$c,K$P,K$q,K$_){return new K$S(K$c,K$P,K$q,K$_)},K$S.withCompile=function(K$c,K$P,K$q,K$_){if(K$q&&K$S.sharders[K$q])return K$S.sharders[K$q];var K$E=K$S._preCompileShader[2e-4*K$c];if(!K$E)throw new Error("withCompile shader err!"+K$c);return K$E.createShader(K$P,K$q,K$_)},K$S.withCompile2D=function(K$c,K$P,K$q,K$_,K$E){if(K$_&&K$S.sharders[K$_])return K$S.sharders[K$_];var K$b=K$S._preCompileShader[2e-4*K$c+K$P];if(!K$b)throw new Error("withCompile shader err!"+K$c+" "+K$P);return K$b.createShader(K$q,K$_,K$E)},K$S.addInclude=function(K$c,K$P){K$mc.addInclude(K$c,K$P)},K$S.preCompile=function(K$c,K$P,K$q,K$_){var K$E=2e-4*K$c;K$S._preCompileShader[K$E]=new K$mc(K$E,K$P,K$q,K$_)},K$S.preCompile2D=function(K$c,K$P,K$q,K$_,K$E){var K$b=2e-4*K$c+K$P;K$S._preCompileShader[K$b]=new K$mc(K$b,K$q,K$_,K$E)},K$S._createShader=function(K$c,K$P,K$q){var K$_=K$c.createShader(K$q);return K$c.shaderSource(K$_,K$P),K$c.compileShader(K$_),K$_},K$S._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],K$S._count=0,K$S._preCompileShader={},K$S.SHADERNAME2ID=2e-4,K$S.sharders=((K$S.sharders=[]).length=32,K$S.sharders),K$e(K$S,["nameKey",function(){return this.nameKey=new K$R}]),K$S}(),K$Bc=function(K$c){function K$P(){this._maxsize=0,this._upload=!0,this._uploadSize=0,K$P.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}K$x(K$P,"laya.webgl.utils.Buffer2D",K$c);var K$q=K$P.prototype;return K$q.needSize=function(K$c){var K$P=this._byteLength;if(K$c){var K$q=this._byteLength+K$c;K$q<=this._buffer.byteLength||this._resizeBuffer(K$q<<1,!0),this._byteLength=K$q}return K$P},K$q._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),K$V.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,K$Yc._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),K$Yc._gl.bufferSubData(this._bufferType,0,this._buffer)},K$q._bufferSubData=function(K$c,K$P,K$q){if(void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),this._maxsize=Math.max(this._maxsize,this._byteLength),K$V.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,K$Yc._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),K$P||K$q){var K$_=this._buffer.slice(K$P,K$q);K$Yc._gl.bufferSubData(this._bufferType,K$c,K$_)}else K$Yc._gl.bufferSubData(this._bufferType,K$c,this._buffer)},K$q._checkArrayUse=function(){},K$q._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},K$q._bind_subUpload=function(K$c,K$P,K$q){return void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(K$c,K$P,K$q),!0)},K$q._resizeBuffer=function(K$c,K$P){if(K$c<this._buffer.byteLength)return this;if(this.memorySize=K$c,K$P&&this._buffer&&0<this._buffer.byteLength){var K$q=new ArrayBuffer(K$c);new Uint8Array(K$q).set(new Uint8Array(this._buffer),0),this._buffer=K$q}else this._buffer=new ArrayBuffer(K$c);return this._checkArrayUse(),this._upload=!0,this},K$q.append=function(K$c){this._upload=!0;var K$P,K$q;K$P=K$c.byteLength,K$c instanceof Uint8Array?(this._resizeBuffer(this._byteLength+K$P,!0),K$q=new Uint8Array(this._buffer,this._byteLength)):K$c instanceof Uint16Array?(this._resizeBuffer(this._byteLength+K$P,!0),K$q=new Uint16Array(this._buffer,this._byteLength)):K$c instanceof Float32Array&&(this._resizeBuffer(this._byteLength+K$P,!0),K$q=new Float32Array(this._buffer,this._byteLength)),K$q.set(K$c,0),this._byteLength+=K$P,this._checkArrayUse()},K$q.appendU16Array=function(K$c,K$P){this._resizeBuffer(this._byteLength+2*K$P,!0);for(var K$q=new Uint16Array(this._buffer,this._byteLength,K$P),K$_=0;K$_<K$P;K$_++)K$q[K$_]=K$c[K$_];this._byteLength+=2*K$P,this._checkArrayUse()},K$q.appendEx=function(K$c,K$P){this._upload=!0;var K$q;K$q=K$c.byteLength,this._resizeBuffer(this._byteLength+K$q,!0),new K$P(this._buffer,this._byteLength).set(K$c,0),this._byteLength+=K$q,this._checkArrayUse()},K$q.appendEx2=function(K$c,K$P,K$q,K$_){void 0===K$_&&(K$_=1),this._upload=!0;var K$E,K$b;K$E=K$q*K$_,this._resizeBuffer(this._byteLength+K$E,!0),K$b=new K$P(this._buffer,this._byteLength);var K$e=0;for(K$e=0;K$e<K$q;K$e++)K$b[K$e]=K$c[K$e];this._byteLength+=K$E,this._checkArrayUse()},K$q.getBuffer=function(){return this._buffer},K$q.setNeedUpload=function(){this._upload=!0},K$q.getNeedUpload=function(){return this._upload},K$q.upload=function(){var K$c=this._bind_upload();return K$Yc._gl.bindBuffer(this._bufferType,null),K$Yc._bindActive[this._bufferType]=null,K$oc.activeShader=null,K$c},K$q.subUpload=function(K$c,K$P,K$q){void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0);var K$_=this._bind_subUpload();return K$Yc._gl.bindBuffer(this._bufferType,null),K$Yc._bindActive[this._bufferType]=null,K$oc.activeShader=null,K$_},K$q.disposeResource=function(){K$c.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},K$q.clear=function(){this._byteLength=0,this._upload=!0},K$_(0,K$q,"bufferLength",function(){return this._buffer.byteLength}),K$_(0,K$q,"byteLength",null,function(K$c){this._byteLength!==K$c&&(K$c<=this._buffer.byteLength||this._resizeBuffer(2*K$c+256,!0),this._byteLength=K$c)}),K$P.__int__=function(K$c){K$Kc.QuadrangleIB=K$Kc.create(35044),K$wc.fillIBQuadrangle(K$Kc.QuadrangleIB,16)},K$P.FLOAT32=4,K$P.SHORT=2,K$P}(K$Yc),K$pc=(function(K$P){function K$q(K$c){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,K$q.__super.call(this,9)}K$x(K$q,"laya.webgl.shader.d2.value.GlowSV",K$P);var K$c=K$q.prototype;K$c.setValue=function(K$c){K$P.prototype.setValue.call(this,K$c)},K$c.clear=function(){K$P.prototype.clear.call(this)}}(K$vc),function(K$c){function K$P(K$c){K$P.__super.call(this,64),this.defines.add(64)}K$x(K$P,"laya.webgl.shader.d2.value.TextSV",K$c);var K$q=K$P.prototype;return K$q.release=function(){(K$P.pool[K$P._length++]=this).clear()},K$q.clear=function(){K$c.prototype.clear.call(this)},K$P.create=function(){return K$P._length?K$P.pool[--K$P._length]:new K$P(null)},K$P.pool=[],K$P._length=0,K$P}(K$vc)),K$ic=function(K$c){function K$E(K$c,K$P,K$q,K$_){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,K$E.__super.call(this,K$c,K$P,K$q,K$_)}K$x(K$E,"laya.webgl.shader.d2.Shader2X",K$c);var K$P=K$E.prototype;return K$P.upload2dQuick1=function(K$c){this.upload(K$c,this._params2dQuick1||this._make2dQuick1())},K$P._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var K$c,K$P=this._params,K$q=0,K$_=K$P.length;K$q<K$_;K$q++)K$c=K$P[K$q],(K$O.isFlash||"size"!==K$c.name&&"position"!==K$c.name&&"texcoord"!==K$c.name)&&this._params2dQuick1.push(K$c)}return this._params2dQuick1},K$P.disposeResource=function(){K$c.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},K$P.upload2dQuick2=function(K$c){this.upload(K$c,this._params2dQuick2||this._make2dQuick2())},K$P._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var K$c,K$P=this._params,K$q=0,K$_=K$P.length;K$q<K$_;K$q++)K$c=K$P[K$q],(K$O.isFlash||"size"!==K$c.name)&&this._params2dQuick2.push(K$c)}return this._params2dQuick2},K$E.create=function(K$c,K$P,K$q,K$_){return new K$E(K$c,K$P,K$q,K$_)},K$E}(K$tc),K$Kc=function(K$c){function K$P(K$c){this._uint8Array=null,this._uint16Array=null,void 0===K$c&&(K$c=35044),K$P.__super.call(this),this._bufferUsage=K$c,this._bufferType=34963,K$O.isFlash||(this._buffer=new ArrayBuffer(8))}K$x(K$P,"laya.webgl.utils.IndexBuffer2D",K$Bc);var K$q=K$P.prototype;return K$q._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},K$q.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},K$q.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},K$q.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},K$P.QuadrangleIB=null,K$P.create=function(K$c){return void 0===K$c&&(K$c=35044),new K$P(K$c)},K$P}(),K$Gc=function(K$c){function K$q(K$c,K$P){this._floatArray32=null,this._vertexStride=0,K$q.__super.call(this),this._vertexStride=K$c,this._bufferUsage=K$P,this._bufferType=34962,K$O.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}K$x(K$q,"laya.webgl.utils.VertexBuffer2D",K$c);var K$P=K$q.prototype;return K$P.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},K$P.bind=function(K$c){K$c&&K$c._bind(),this._bind()},K$P.insertData=function(K$c,K$P){this.getFloat32Array().set(K$c,K$P),this._upload=!0},K$P.bind_upload=function(K$c){K$c._bind_upload()||K$c._bind(),this._bind_upload()||this._bind()},K$P._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},K$P.disposeResource=function(){K$c.prototype.disposeResource.call(this)},K$P.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},K$_(0,K$P,"vertexStride",function(){return this._vertexStride}),K$q.create=function(K$c,K$P){return void 0===K$P&&(K$P=35048),new K$q(K$c,K$P)},K$q}(K$Bc),K$cP=function(K$c){function K$h(K$c,K$P,K$q,K$_,K$E,K$b){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===K$q&&(K$q=6408),void 0===K$_&&(K$_=!0),K$h.__super.call(this,K$c,K$P),K$c){if(this._format=K$q,this._mipmap=K$_,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof K$c)this._url=K$c,this._src=K$c,this._image=new K$r.window.Image,K$P&&(K$P.onload&&(this.onload=K$P.onload),K$P.onerror&&(this.onerror=K$P.onerror),K$P.onCreate&&K$P.onCreate(this)),this._image.crossOrigin=K$c&&0==K$c.indexOf("data:")?null:"",K$c&&(this._image.src=K$c);else if(K$c instanceof ArrayBuffer){this._src=K$P,this._url=this._src;var K$e=new K$Z(K$c);K$e.readUTFBytes(4),K$e.readUTFBytes(2),K$e.getInt16();K$e.endian="bigEndian",this._w=K$e.getInt16(),this._h=K$e.getInt16();K$e.getInt16(),K$e.getInt16();this._image=new Uint8Array(K$c,K$e.pos),this._format=K$Tc.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,K$I.enabled&&this._w<K$I.atlasLimitWidth&&this._h<K$I.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(K$c instanceof Uint8Array))return this._src=K$P,this._url=this._src,this._image=K$c.source||K$c,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=K$P,this._url=this._src,this._w=K$E,this._h=K$b,this._image=K$c,this._format=0===K$q?K$c.byteLength/(K$E*K$b)==4?6408:6407:K$q}this._$5__enableMerageInAtlas=!0}}K$x(K$h,"laya.webgl.resource.WebGLImage",K$W);var K$P=K$h.prototype;return K$L.imps(K$P,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),K$P._init_=function(K$c,K$P){},K$P._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var K$c=K$Tc.mainContext,K$P=this._source=K$c.createTexture(),K$q=K$Dc.curBindTexTarget,K$_=K$Dc.curBindTexValue;K$Dc.bindTexture(K$c,3553,K$P);var K$E=this.minFifter,K$b=this.magFifter,K$e=this.repeat?10497:33071,K$h=K$n.isPOT(this._w,this._h),K$Z=!1;switch(K$h?(this.mipmap?-1!==K$E||(K$E=9987):-1!==K$E||(K$E=9729),-1!==K$b||(K$b=9729),K$c.texParameteri(3553,10241,K$E),K$c.texParameteri(3553,10240,K$b),K$c.texParameteri(3553,10242,K$e),K$c.texParameteri(3553,10243,K$e),this.mipmap&&K$c.generateMipmap(3553)):(-1!==K$E||(K$E=9729),-1!==K$b||(K$b=9729),K$c.texParameteri(3553,10241,K$E),K$c.texParameteri(3553,10240,K$b),K$c.texParameteri(3553,10242,33071),K$c.texParameteri(3553,10243,33071)),K$c.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&K$c.pixelStorei(K$c.UNPACK_ALIGNMENT,1),K$c.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&K$c.pixelStorei(K$c.UNPACK_ALIGNMENT,1),K$c.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:K$Z=!0,K$c.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case K$Tc.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:K$Z=!0,K$c.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}K$c.pixelStorei(37441,!1),K$q&&K$_&&K$Dc.bindTexture(K$c,K$q,K$_),this.uri||(this.uri=this._url),K$Z?this.memorySize=this._image.length:K$h&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},K$P.recreateResource=function(){var K$c=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var K$P=this;this._image=new K$r.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(K$P._needReleaseAgain)return K$P._needReleaseAgain=!1,K$P._image.onload=null,void(K$P._image=null);K$P._allowMerageInAtlas&&K$P._enableMerageInAtlas?(K$c.memorySize=0,K$c._recreateLock=!1):K$P._createWebGlTexture(),K$P.completeCreate()},this._image.src=this._src}},K$P.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&K$Tc.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},K$P.onresize=function(){this._w=this._image.width,this._h=this._image.height,K$I.enabled&&this._w<K$I.atlasLimitWidth&&this._h<K$I.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},K$P.clearAtlasSource=function(){this._image=null},K$_(0,K$P,"format",function(){return this._format}),K$_(0,K$P,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(K$c){this._$5__enableMerageInAtlas=K$c}),K$_(0,K$P,"mipmap",function(){return this._mipmap}),K$_(0,K$P,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),K$_(0,K$P,"atlasSource",function(){return this._image}),K$_(0,K$P,"onload",null,function(K$c){var K$P=this;this._onload=K$c,this._image&&(this._image.onload=null!=this._onload?function(){K$P.onresize(),K$P._onload()}:null)}),K$_(0,K$P,"onerror",null,function(K$c){var K$P=this;this._onerror=K$c,this._image&&(this._image.onerror=null!=this._onerror?function(){K$P._onerror()}:null)}),K$h}();K$L.__init([K$rc,K$U,K$Hc,K$mc])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(K$c,K$P){"use strict";for(var K$q in Object.defineProperty(K$P,"__esModule",{value:!0}),Laya){var K$_=Laya[K$q];K$_&&K$_.__isclass&&(K$P[K$q]=K$_)}}),function(K$b,K$c,K$_){K$_.un,K$_.uns;var K$E=K$_.static,K$e=K$_.class,K$h=K$_.getset,K$Z=(K$_.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),K$g=laya.utils.ClassUtils,K$k=(laya.events.Event,laya.utils.HTMLChar),K$S=laya.net.Loader,K$n=(laya.display.Node,laya.maths.Rectangle),K$x=laya.renders.Render,K$r=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),K$W=laya.utils.Stat,K$o=laya.display.Text,K$w=laya.resource.Texture,K$O=laya.net.URL,K$N=laya.utils.Utils,K$m=function(){function K$r(){}return K$e(K$r,"laya.html.utils.HTMLParse"),K$r.parse=function(K$c,K$P,K$q){K$P=(K$P="<root>"+(K$P=K$P.replace(/<br>/g,"<br/>"))+"</root>").replace(K$r.spacePattern,K$r.char255);var K$_=K$N.parseXMLFromString(K$P);K$r._parseXML(K$c,K$_.childNodes[0].childNodes,K$q)},K$r._parseXML=function(K$c,K$P,K$q,K$_){var K$E=0,K$b=0;if(K$P.join||K$P.item)for(K$E=0,K$b=K$P.length;K$E<K$b;++K$E)K$r._parseXML(K$c,K$P[K$E],K$q,K$_);else{var K$e,K$h,K$Z;if(3==K$P.nodeType)return void(K$c instanceof laya.html.dom.HTMLDivElement?(null==K$P.nodeName&&(K$P.nodeName="#text"),K$h=K$P.nodeName.toLowerCase(),0<(K$Z=K$P.textContent.replace(/^\s+|\s+$/g,"")).length&&(K$e=K$g.getInstance(K$h))&&(K$c.addChild(K$e),K$e.innerTEXT=K$Z.replace(K$r.char255AndOneSpacePattern," "))):0<(K$Z=K$P.textContent.replace(/^\s+|\s+$/g,"")).length&&(K$c.innerTEXT=K$Z.replace(K$r.char255AndOneSpacePattern," ")));if("#comment"==(K$h=K$P.nodeName.toLowerCase()))return;if(K$e=K$g.getInstance(K$h)){(K$e=K$c.addChild(K$e)).URI=K$q,K$e.href=K$_;var K$S=K$P.attributes;if(K$S&&0<K$S.length)for(K$E=0,K$b=K$S.length;K$E<K$b;++K$E){var K$n=K$S[K$E],K$k=K$n.nodeName,K$x=K$n.value;K$e._setAttributes(K$k,K$x)}K$r._parseXML(K$e,K$P.childNodes,K$q,K$e.href)}else K$r._parseXML(K$c,K$P.childNodes,K$q,K$_)}},K$r.char255=String.fromCharCode(255),K$r.spacePattern=/&nbsp;|&#160;/g,K$r.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),K$r}(),K$T=function(){function K$F(){}return K$e(K$F,"laya.html.utils.Layout"),K$F.later=function(K$c){null==K$F._will&&(K$F._will=[],K$_.stage.frameLoop(1,null,function(){if(!(K$F._will.length<1)){for(var K$c=0;K$c<K$F._will.length;K$c++)laya.html.utils.Layout.layout(K$F._will[K$c]);K$F._will.length=0}})),K$F._will.push(K$c)},K$F.layout=function(K$c){if(!K$c||!K$c._style)return null;if(0==(512&K$c._style._type))return null;K$c.getStyle()._type&=-513;var K$P=K$F._multiLineLayout(K$c);return K$x.isConchApp&&K$c.layaoutCallNative&&K$c.layaoutCallNative(),K$P},K$F._multiLineLayout=function(K$c){if(K$o.RightToLeft)return K$F._multiLineLayout2(K$c);var K$P=new Array;K$c._addChildsToLayout(K$P);var K$q,K$_,K$E,K$b,K$e,K$h=0,K$Z=K$P.length,K$S=K$c._getCSSStyle(),K$n=K$S.letterSpacing,K$k=K$S.leading,K$x=K$S.lineHeight,K$r=K$S._widthAuto()||!K$S.wordWrap,K$g=K$r?999999:K$c.width,K$W=(K$c.height,0),K$w=K$S.italic?K$S.fontSize/3:0,K$O=K$S._getAlign(),K$N=K$S._getValign(),K$m=0!==K$N||0!==K$O||0!=K$x,K$T=0,K$D=0,K$L=0,K$H=0,K$Q=new Array,K$d=K$Q[0]=new K$a,K$u=!1,K$A=!1;K$d.h=0,K$S.italic&&(K$g-=K$S.fontSize/3);var K$J=0,K$j=!0;function K$V(){K$d.y=K$D,K$D+=K$d.h+K$k,0==K$d.h&&(K$D+=K$x),K$d.mWidth=K$J,K$J=0,K$d=new K$a,K$Q.push(K$d),K$d.h=0,K$u=!(K$j=!(K$T=0))}for(K$h=0;K$h<K$Z;K$h++)if(null!=(K$q=K$P[K$h]))if(K$j=!1,K$q instanceof laya.html.dom.HTMLBrElement)K$V(),K$d.y=K$D;else{if(K$q._isChar()){if((K$b=K$q).isWord)K$u=K$A||"\n"===K$b.char,K$d.wordStartIndex=K$d.elements.length;else{if(K$L=K$b.width+K$b.style.letterSpacin,0<K$Q.length&&K$g<K$T+K$L&&0<K$d.wordStartIndex){var K$R;K$R=K$d.elements.length-K$d.wordStartIndex+1,K$d.elements.length=K$d.wordStartIndex,K$h-=K$R,K$V();continue}K$u=!1,K$J+=K$b.width}K$L=K$b.width+K$n,K$H=K$b.height,K$A=!1,(K$u=K$u||K$g<K$T+K$L)&&K$V(),K$d.minTextHeight=Math.min(K$d.minTextHeight,K$q.height)}else K$_=K$q._getCSSStyle(),K$e=K$q,K$E=K$_.padding,0===K$_._getCssFloat()||(K$m=!0),K$u=K$A||K$_.lineElement,K$L=K$e.width*K$e._style._tf.scaleX+K$E[1]+K$E[3]+K$n,K$H=K$e.height*K$e._style._tf.scaleY+K$E[0]+K$E[2],K$A=K$_.lineElement,(K$u=K$u||K$g<K$T+K$L&&K$_.wordWrap)&&K$V();K$d.elements.push(K$q),K$d.h=Math.max(K$d.h,K$H),K$q.x=K$T,K$q.y=K$D,K$T+=K$L,K$d.w=K$T-K$n,K$d.y=K$D,K$W=Math.max(K$T+K$w,K$W)}else K$j||(K$T+=K$F.DIV_ELEMENT_PADDING),K$d.wordStartIndex=K$d.elements.length;if(K$D=K$d.y+K$d.h,K$m){var K$$=0,K$C=K$g;for(K$r&&0<K$c.width&&(K$C=K$c.width),K$h=0,K$Z=K$Q.length;K$h<K$Z;K$h++)K$Q[K$h].updatePos(0,K$C,K$h,K$$,K$O,K$N,K$x),K$$+=Math.max(K$x,K$Q[K$h].h+K$k);K$D=K$$}return K$r&&(K$c.width=K$W),K$D>K$c.height&&(K$c.height=K$D),[K$W,K$D]},K$F._multiLineLayout2=function(K$c){var K$P=new Array;K$c._addChildsToLayout(K$P);var K$q,K$_,K$E,K$b,K$e,K$h=0,K$Z=K$P.length,K$S=K$c._getCSSStyle(),K$n=K$S.letterSpacing,K$k=K$S.leading,K$x=K$S.lineHeight,K$r=K$S._widthAuto()||!K$S.wordWrap,K$g=K$r?999999:K$c.width,K$W=(K$c.height,0),K$w=K$S.italic?K$S.fontSize/3:0,K$O=2-K$S._getAlign(),K$N=K$S._getValign(),K$m=0!==K$N||0!=K$O||0!=K$x,K$T=0,K$D=0,K$L=0,K$H=0,K$Q=new Array,K$d=K$Q[0]=new K$a,K$u=!1,K$A=!1;K$d.h=0,K$S.italic&&(K$g-=K$S.fontSize/3);var K$J=0,K$j=!0;function K$V(){K$d.y=K$D,K$D+=K$d.h+K$k,0==K$d.h&&(K$D+=K$x),K$d.mWidth=K$J,K$J=0,K$d=new K$a,K$Q.push(K$d),K$d.h=0,K$u=!(K$j=!(K$T=0))}for(K$h=0;K$h<K$Z;K$h++)if(null!=(K$q=K$P[K$h]))if(K$j=!1,K$q instanceof laya.html.dom.HTMLBrElement)K$V(),K$d.y=K$D;else{if(K$q._isChar()){if((K$b=K$q).isWord)K$u=K$A||"\n"===K$b.char,K$d.wordStartIndex=K$d.elements.length;else{if(0<K$Q.length&&K$g<K$T+K$L&&0<K$d.wordStartIndex){var K$R;K$R=K$d.elements.length-K$d.wordStartIndex+1,K$d.elements.length=K$d.wordStartIndex,K$h-=K$R,K$V();continue}K$u=!1,K$J+=K$b.width}K$L=K$b.width+K$n,K$H=K$b.height,K$A=!1,(K$u=K$u||K$g<K$T+K$L)&&K$V(),K$d.minTextHeight=Math.min(K$d.minTextHeight,K$q.height)}else K$_=K$q._getCSSStyle(),K$e=K$q,K$E=K$_.padding,0===K$_._getCssFloat()||(K$m=!0),K$u=K$A||K$_.lineElement,K$L=K$e.width*K$e._style._tf.scaleX+K$E[1]+K$E[3]+K$n,K$H=K$e.height*K$e._style._tf.scaleY+K$E[0]+K$E[2],K$A=K$_.lineElement,(K$u=K$u||K$g<K$T+K$L&&K$_.wordWrap)&&K$V();K$d.elements.push(K$q),K$d.h=Math.max(K$d.h,K$H),K$q.x=K$T,K$q.y=K$D,K$T+=K$L,K$d.w=K$T-K$n,K$d.y=K$D,K$W=Math.max(K$T+K$w,K$W)}else K$j||(K$T+=K$F.DIV_ELEMENT_PADDING),K$d.wordStartIndex=K$d.elements.length;if(K$D=K$d.y+K$d.h,K$m){var K$$=0,K$C=K$g;for(K$h=0,K$Z=K$Q.length;K$h<K$Z;K$h++)K$Q[K$h].updatePos(0,K$C,K$h,K$$,K$O,K$N,K$x),K$$+=Math.max(K$x,K$Q[K$h].h+K$k);K$D=K$$}for(K$r&&(K$c.width=K$W),K$D>K$c.height&&(K$c.height=K$D),K$h=0,K$Z=K$Q.length;K$h<K$Z;K$h++)K$Q[K$h].revertOrder(K$g);return[K$W,K$D]},K$F._will=null,K$F.DIV_ELEMENT_PADDING=0,K$F}(),K$a=function(){function K$c(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}K$e(K$c,"laya.html.utils.LayoutLine");var K$P=K$c.prototype;return K$P.updatePos=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){var K$h,K$Z=0;0<this.elements.length&&(K$Z=(K$h=this.elements[this.elements.length-1]).x+K$h.width-this.elements[0].x);var K$S=0,K$n=NaN;1===K$E&&(K$S=(K$P-K$Z)/2),2===K$E&&(K$S=K$P-K$Z),0===K$e||0!=K$b||(K$b=1);for(var K$k=0,K$x=this.elements.length;K$k<K$x;K$k++){var K$r=(K$h=this.elements[K$k])._getCSSStyle();switch(0!==K$S&&(K$h.x+=K$S),K$r._getValign()){case 0:K$h.y=K$_;break;case 1:var K$g=0;99999!=this.minTextHeight&&(K$g=this.minTextHeight);var K$W=(K$g+K$e)/2;K$W=Math.max(K$W,this.h),K$n=(laya.html.dom.HTMLImageElement,K$_+K$W-K$h.height),K$h.y=K$n;break;case 2:K$h.y=K$_+(K$e-K$h.height)}}},K$P.revertOrder=function(K$c){var K$P;if(0<this.elements.length){var K$q,K$_=0;for(K$q=this.elements.length,K$_=0;K$_<K$q;K$_++)(K$P=this.elements[K$_]).x=K$c-K$P.x-K$P.width}},K$c}(),K$D=function(K$q){function K$P(){this.URI=null,this._href=null,K$P.__super.call(this),this._text=K$P._EMPTYTEXT,this.setStyle(new K$Z(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}K$e(K$P,"laya.html.dom.HTMLElement",K$q);var K$c=K$P.prototype;return K$c.layaoutCallNative=function(){var K$c=0;if(this._childs&&0<(K$c=this._childs.length))for(var K$P=0;K$P<K$c;K$P++)this._childs[K$P].layaoutCallNative&&this._childs[K$P].layaoutCallNative();var K$q=this._getWords();K$q?laya.html.dom.HTMLElement.fillWords(this,K$q,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},K$c.appendChild=function(K$c){return this.addChild(K$c)},K$c._getWords2=function(){var K$c=this._text.text;if(!K$c||0===K$c.length)return null;var K$P,K$q,K$_=0,K$E=0;if(this._text.drawWords)K$q=this._text.drawWords;else{for(K$E=(K$P=K$c.split(" ")).length-1,K$q=[],K$_=0;K$_<K$E;K$_++)K$q.push(K$P[K$_]," ");0<=K$E&&K$q.push(K$P[K$E]),this._text.drawWords=K$q}var K$b,K$e=this._text.words;if(K$e&&K$e.length===K$q.length)return K$e;null===K$e&&(this._text.words=K$e=[]),K$e.length=K$q.length;var K$h=this.style,K$Z=K$h.font;for(K$_=0,K$E=K$q.length;K$_<K$E;K$_++){K$b=K$N.measureText(K$q[K$_],K$Z);var K$S=K$e[K$_]=new K$k(K$q[K$_],K$b.width,K$b.height||K$h.fontSize,K$h);if(1<K$S.char.length&&(K$S.charNum=K$S.char),this.href){var K$n=new K$r;this.addChild(K$n),K$S.setSprite(K$n)}}return K$e},K$c._getWords=function(){if(!K$o.CharacterCache)return this._getWords2();var K$c=this._text.text;if(!K$c||0===K$c.length)return null;var K$P,K$q=this._text.words;if(K$q&&K$q.length===K$c.length)return K$q;null===K$q&&(this._text.words=K$q=[]),K$q.length=K$c.length;for(var K$_=this.style,K$E=K$_.font,K$b=0,K$e=K$c.length;K$b<K$e;K$b++)if(K$P=K$N.measureText(K$c.charAt(K$b),K$E)){var K$h=K$q[K$b]=new K$k(K$c.charAt(K$b),K$P.width,K$P.height||K$_.fontSize,K$_);if(this.href){var K$Z=new K$r;this.addChild(K$Z),K$h.setSprite(K$Z)}}else console.warn("_getWords size is null"+K$c.charAt(K$b),K$E);return K$q},K$c.showLinkSprite=function(){var K$c=this._text.words;if(K$c)for(var K$P,K$q,K$_=[],K$E=0;K$E<K$c.length;K$E++)K$q=K$c[K$E],(K$P=new K$r).graphics.drawRect(0,0,K$q.width,K$q.height,"#ff0000"),K$P.width=K$q.width,K$P.height=K$q.height,this.addChild(K$P),K$_.push(K$P)},K$c._layoutLater=function(){var K$c=this.style;512&K$c._type||(K$c.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&K$c.block?(K$T.later(this),K$c._type|=512):this.parent&&this.parent._layoutLater())},K$c._setAttributes=function(K$c,K$P){switch(K$c){case"style":return void this.style.cssText(K$P);case"class":return void(this.className=K$P)}K$q.prototype._setAttributes.call(this,K$c,K$P)},K$c.updateHref=function(){if(null!=this._href){var K$c=this._getWords();if(K$c)for(var K$P,K$q,K$_=0;K$_<K$c.length;K$_++)(K$q=(K$P=K$c[K$_]).getSprite())&&(K$q.size(K$P.width,K$P.height),K$q.on("click",this,this.onLinkHandler))}},K$c.onLinkHandler=function(K$c){switch(K$c.type){case"click":for(var K$P=this;K$P;)K$P.event("link",[this.href]),K$P=K$P.parent}},K$c.formatURL=function(K$c){return this.URI?K$O.formatURL(K$c,this.URI?this.URI.path:null):K$c},K$h(0,K$c,"href",function(){return this._href},function(K$c){null!=(this._href=K$c)&&(this._getCSSStyle().underLine=1,this.updateHref())}),K$h(0,K$c,"color",null,function(K$c){this.style.color=K$c}),K$h(0,K$c,"onClick",null,function(K$c){K$_._runScript("fn=function(event){"+K$c+";}"),this.on("click",this,void 0)}),K$h(0,K$c,"id",null,function(K$c){K$L.document.setElementById(K$c,this)}),K$h(0,K$c,"innerTEXT",function(){return this._text.text},function(K$c){this.text=K$c}),K$h(0,K$c,"style",function(){return this._style}),K$h(0,K$c,"text",function(){return this._text.text},function(K$c){this._text==K$P._EMPTYTEXT?this._text={text:K$c,words:null}:(this._text.text=K$c,this._text.words&&(this._text.words.length=0)),K$x.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),K$h(0,K$c,"parent",K$q.prototype._$get_parent,function(K$c){if(K$c instanceof laya.html.dom.HTMLElement){var K$P=K$c;this.URI||(this.URI=K$P.URI),this.style.inherit(K$P.style)}K$_.superSet(K$r,this,"parent",K$c)}),K$h(0,K$c,"className",null,function(K$c){this.style.attrs(K$L.document.styleSheets["."+K$c])}),K$P.fillWords=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){K$c.graphics.clear();for(var K$h=0,K$Z=K$P.length;K$h<K$Z;K$h++){var K$S=K$P[K$h];K$c.graphics.fillText(K$S.char,K$S.x+K$q,K$S.y+K$_,K$E,K$b,"left",K$e)}},K$P._EMPTYTEXT={text:null,words:null},K$P}(K$r),K$P=(function(K$c){function K$P(){K$P.__super.call(this),this.style.lineElement=!0,this.style.block=!0}K$e(K$P,"laya.html.dom.HTMLBrElement",K$D)}(),function(K$c){function K$P(){this.contextHeight=NaN,this.contextWidth=NaN,K$P.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}K$e(K$P,"laya.html.dom.HTMLDivElement",K$c);var K$q=K$P.prototype;return K$q.appendHTML=function(K$c){K$m.parse(this,K$c,this.URI),this.layout()},K$q._addChildsToLayout=function(K$P){var K$c=this._getWords();if(null==K$c&&0==this._childs.length)return!1;K$c&&K$c.forEach(function(K$c){K$P.push(K$c)});for(var K$q=!0,K$_=0,K$E=this._childs.length;K$_<K$E;K$_++){var K$b=this._childs[K$_];K$q?K$q=!1:K$P.push(null),K$b._addToLayout(K$P)}return!0},K$q._addToLayout=function(K$c){this.layout()},K$q.layout=function(){if(this.style){this.style._type|=512;var K$c=K$T.layout(this);if(K$c){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new K$n);var K$P=this._$P.mHtmlBounds;K$P.x=K$P.y=0,K$P.width=this.contextWidth=K$c[0],K$P.height=this.contextHeight=K$c[1],this.setBounds(K$P)}}},K$h(0,K$q,"height",function(){return this._height?this._height:this.contextHeight},K$c.prototype._$set_height),K$h(0,K$q,"innerHTML",null,function(K$c){this.destroyChildren(),this.appendHTML(K$c)}),K$h(0,K$q,"width",function(){return this._width?this._width:this.contextWidth},function(K$c){var K$P=!1;K$P=0===K$c?K$c!=this._width:K$c!=this.width,K$_.superSet(K$D,this,"width",K$c),K$P&&this.layout()}),K$P}(K$D)),K$L=function(K$c){function K$P(){this.all=new Array,this.styleSheets=K$Z.styleSheets,K$P.__super.call(this)}K$e(K$P,"laya.html.dom.HTMLDocument",K$D);var K$q=K$P.prototype;return K$q.getElementById=function(K$c){return this.all[K$c]},K$q.setElementById=function(K$c,K$P){this.all[K$c]=K$P},K$E(K$P,["document",function(){return this.document=new K$P}]),K$P}();(function(K$c){function K$P(){this._tex=null,this._url=null,this._renderArgs=[],K$P.__super.call(this),this.style.block=!0}K$e(K$P,"laya.html.dom.HTMLImageElement",K$D);var K$q=K$P.prototype;K$q._addToLayout=function(K$c){!this._style.absolute&&K$c.push(this)},K$q.render=function(K$c,K$P,K$q){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(K$W.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,K$c.ctx.drawTexture2(K$P,K$q,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},K$q.layaoutCallNative=function(){var K$c=0;if(this._childs&&0<(K$c=this._childs.length))for(var K$P=0;K$P<K$c;K$P++)this._childs[K$P].layaoutCallNative&&this._childs[K$P].layaoutCallNative()},K$h(0,K$q,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(K$c){this._width!==K$c&&(this._width=K$c,this._style.width=K$c,this.repaint())}),K$h(0,K$q,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(K$c){this._height!==K$c&&(this._height=K$c,this._style.height=K$c,this.repaint())}),K$q.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),K$S.clearCache(this,this._url),this._tex=null),K$D.prototype.destroy.call(this)},K$q.onloaded=function(){var K$c=this._style;K$c&&!K$c.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),K$c&&!K$c.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),K$x.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},K$q._loadImageComplete=function(K$c,K$P,K$q){if(!this._destroyed)if(null!=K$q)if(K$q instanceof ArrayBuffer){var K$_=new DataView(K$q);new laya.webgl.resource.WebGLImage(new Uint8Array(K$q,8),K$c,0,!1,K$_.getUint32(0),K$_.getUint32(4));this.onloaded()}else if(K$q instanceof K$w)K$S.imgMgrSet[K$c]=K$P,K$b.imgMgrLock(K$c,K$S.imgMgrSet[K$c]),this._url=K$c,this._tex=K$q,K$S.keepCache(this,K$c),K$S.cacheRes(K$c,this._tex),this.onloaded();else{var K$E=-1!=K$c.indexOf(".png",K$c.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(K$q,K$c,K$E,!1,K$q.width,K$q.height);this.onloaded()}else this.event("error","Load image failed")},K$h(0,K$q,"src",null,function(K$c){(K$c=this.formatURL(K$c),this._url!=K$c)&&(null!=this._tex&&(K$S.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=K$c,(this._tex=K$S.getRes(K$c))?(K$S.keepCache(this,K$c),this.onloaded()):K$b.imgMgrLoad(K$c,this._loadImageComplete.bind(this),2,!1))})})(),function(K$c){function K$P(){this.type=null,K$P.__super.call(this),this.visible=!1}K$e(K$P,"laya.html.dom.HTMLLinkElement",K$c);var K$q=K$P.prototype;K$q._onload=function(K$c){switch(this.type){case"text/css":K$Z.parseCSS(K$c,this.URI)}},K$h(0,K$q,"href",K$c.prototype._$get_href,function(K$c){var K$P=this;K$c=this.formatURL(K$c),this.URI=new K$O(K$c);var K$q=new K$S;K$q.once("complete",null,function(K$c){K$P._onload(K$c)}),K$q.load(K$c,"text")}),K$P._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(K$D),function(K$c){function K$P(){K$P.__super.call(this),this.visible=!1}K$e(K$P,"laya.html.dom.HTMLStyleElement",K$c),K$h(0,K$P.prototype,"text",K$c.prototype._$get_text,function(K$c){K$Z.parseCSS(K$c,null)})}(K$D),function(K$c){function K$P(){K$P.__super.call(this),this._getCSSStyle().valign="middle"}K$e(K$P,"laya.html.dom.HTMLIframeElement",K$c),K$h(0,K$P.prototype,"href",K$c.prototype._$get_href,function(K$q){var K$_=this;K$q=this.formatURL(K$q);var K$c=new K$S;K$c.once("complete",null,function(K$c){var K$P=K$_.URI;K$_.URI=new K$O(K$q),K$_.innerHTML=K$c,!K$P||(K$_.URI=K$P)}),K$c.load(K$q,"text")})}(K$P)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(K$c,K$P){"use strict";for(var K$q in Object.defineProperty(K$P,"__esModule",{value:!0}),Laya){var K$_=Laya[K$q];K$_&&K$_.__isclass&&(K$P[K$q]=K$_)}}),function(K$E,K$c,K$W){K$W.un,K$W.uns;var K$_=K$W.static,K$b=K$W.class,K$e=K$W.getset,K$q=(K$W.__newvec,laya.display.Animation),K$w=(laya.utils.Browser,laya.utils.ClassUtils),K$h=laya.filters.ColorFilter,K$Z=laya.utils.Ease,K$S=laya.events.Event,K$n=(laya.events.EventDispatcher,laya.display.css.Font),K$k=laya.display.FrameAnimation,K$P=laya.display.Graphics,K$x=laya.utils.Handler,K$r=laya.display.Input,K$N=laya.net.Loader,K$g=(laya.display.Node,laya.maths.Point),K$O=laya.maths.Rectangle,K$m=laya.renders.Render,K$T=laya.display.Sprite,K$D=laya.display.Text,K$L=laya.resource.Texture,K$H=laya.utils.Tween,K$Q=laya.utils.Utils,K$d=laya.utils.WeakObject;K$W.interface("laya.ui.IItem"),K$W.interface("laya.ui.ISelect"),K$W.interface("laya.ui.IRender"),K$W.interface("laya.ui.IComponent"),K$W.interface("laya.ui.IBox","IComponent");var K$u=function(){function K$c(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return K$b(K$c,"laya.ui.LayoutStyle"),K$_(K$c,["EMPTY",function(){return this.EMPTY=new K$c}]),K$c}(),K$A=function(){function K$c(){}return K$b(K$c,"laya.ui.Styles"),K$c.labelColor="#000000",K$c.buttonStateNum=3,K$c.scrollBarMinNum=15,K$c.scrollBarDelayTime=500,K$_(K$c,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),K$c}(),K$J=function(){function K$E(){}return K$b(K$E,"laya.ui.UIUtils"),K$E.fillArray=function(K$c,K$P,K$q){var K$_=K$c.concat();if(K$P)for(var K$E=K$P.split(","),K$b=0,K$e=Math.min(K$_.length,K$E.length);K$b<K$e;K$b++){var K$h=K$E[K$b];K$_[K$b]="true"==K$h||"false"!=K$h&&K$h,null!=K$q&&(K$_[K$b]=K$q(K$h))}return K$_},K$E.toColor=function(K$c){return K$Q.toHexColor(K$c)},K$E.gray=function(K$c,K$P){void 0===K$P&&(K$P=!0),K$P?K$E.addFilter(K$c,K$E.grayFilter):K$E.clearFilter(K$c,K$h)},K$E.addFilter=function(K$c,K$P){var K$q=K$c.filters||[];K$q.push(K$P),K$c.filters=K$q},K$E.clearFilter=function(K$c,K$P){var K$q=K$c.filters;if(null!=K$q&&0<K$q.length){for(var K$_=K$q.length-1;-1<K$_;K$_--){var K$E=K$q[K$_];K$W.__typeof(K$E,K$P)&&K$q.splice(K$_,1)}K$c.filters=K$q}},K$E._getReplaceStr=function(K$c){return K$E.escapeSequence[K$c]},K$E.adptString=function(K$c){return K$c.replace(/\\(\w)/g,K$E._getReplaceStr)},K$E.getBindFun=function(K$c){var K$P=K$E._funMap.get(K$c);if(null==K$P){var K$q='"'+K$c+'"',K$_="(function(data){if(data==null)return;with(data){try{\nreturn "+(K$q=K$q.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";K$P=K$W._runScript(K$_),K$E._funMap.set(K$c,K$P)}return K$P},K$_(K$E,["grayFilter",function(){return this.grayFilter=new K$h([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new K$d}]),K$E}(),K$j=function(){function K$c(){}return K$b(K$c,"UIConfig"),K$c.touchScrollEnable=!0,K$c.mouseWheelEnable=!0,K$c.showButtons=!0,K$c.popupBgColor="#000000",K$c.popupBgAlpha=.5,K$c.closeDialogOnSide=!0,K$c}(),K$V=function(K$q){function K$O(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,K$O.__super.call(this),this._weakKeys=[]}K$b(K$O,"laya.ui.AutoBitmap",K$q);var K$c=K$O.prototype;return K$c.destroy=function(){if(K$N.clearObject(this,this._weakKey),this._weakKeys){for(var K$c=0,K$P=this._weakKeys.length;K$c<K$P;++K$c)K$N.clearObject(this,this._weakKeys[K$c]);this._weakKeys=null}K$q.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},K$c._setChanged=function(){this._isChanged||(this._isChanged=!0,K$W.timer.callLater(this,this.changeSource))},K$c.changeSource=function(){this._isChanged=!1;var K$c=this._source;if(K$c&&K$c.bitmap){var K$P=this.width,K$q=this.height,K$_=this._sizeGrid,K$E=K$c.sourceWidth,K$b=K$c.sourceHeight;if(!K$_||K$E===K$P&&K$b===K$q)this.cleanByTexture(K$c,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,K$P,K$q);else{K$N.clearObject(this,this._weakKey),K$c.$_GID||(K$c.$_GID=K$Q.getGID());var K$e=K$c.$_GID+"."+K$P+"."+K$q+"."+K$_.join("."),K$h=K$N.findObject(K$e);if(K$Q.isOKCmdList(K$h))return this._weakKey=K$e,K$N.keepObject(this,this._weakKey),void(this.cmds=K$h);this.clear();var K$Z,K$S,K$n=K$_[0],K$k=K$_[1],K$x=K$_[2],K$r=K$_[3],K$g=K$_[4],K$W=!1;if(K$P==K$E&&(K$r=K$k=0),K$q==K$b&&(K$n=K$x=0),K$P<K$r+K$k){var K$w=K$P;K$W=!0,K$P=K$r+K$k,this.save(),this.clipRect(0,0,K$w,K$q)}K$r&&K$n&&(K$Z=K$O.getTexture(K$c,0,0,K$r,K$n),K$S=this._weakKeys[0],K$Z?(K$S!=K$Z.weakKey&&(K$N.clearObject(this,K$S),K$N.keepObject(this,K$Z.weakKey),this._weakKeys[0]=K$Z.weakKey),this.drawTexture(K$Z,0,0,K$r,K$n)):(K$N.clearObject(this,K$S),this._weakKeys[0]="")),K$k&&K$n&&(K$Z=K$O.getTexture(K$c,K$E-K$k,0,K$k,K$n),K$S=this._weakKeys[1],K$Z?(K$S!=K$Z.weakKey&&(K$N.clearObject(this,K$S),K$N.keepObject(this,K$Z.weakKey),this._weakKeys[1]=K$Z.weakKey),this.drawTexture(K$Z,K$P-K$k,0,K$k,K$n)):(K$N.clearObject(this,K$S),this._weakKeys[1]="")),K$r&&K$x&&(K$Z=K$O.getTexture(K$c,0,K$b-K$x,K$r,K$x),K$S=this._weakKeys[2],K$Z?(K$S!=K$Z.weakKey&&(K$N.clearObject(this,K$S),K$N.keepObject(this,K$Z.weakKey),this._weakKeys[2]=K$Z.weakKey),this.drawTexture(K$Z,0,K$q-K$x,K$r,K$x)):(K$N.clearObject(this,K$S),this._weakKeys[2]="")),K$k&&K$x&&(K$Z=K$O.getTexture(K$c,K$E-K$k,K$b-K$x,K$k,K$x),K$S=this._weakKeys[3],K$Z?(K$S!=K$Z.weakKey&&(K$N.clearObject(this,K$S),K$N.keepObject(this,K$Z.weakKey),this._weakKeys[3]=K$Z.weakKey),this.drawTexture(K$Z,K$P-K$k,K$q-K$x,K$k,K$x)):(K$N.clearObject(this,K$S),this._weakKeys[3]="")),K$n&&(K$Z=K$O.getTexture(K$c,K$r,0,K$E-K$r-K$k,K$n),K$S=this._weakKeys[4],K$Z?(K$S!=K$Z.weakKey&&(K$N.clearObject(this,K$S),K$N.keepObject(this,K$Z.weakKey),this._weakKeys[4]=K$Z.weakKey),this.drawBitmap(K$g,K$Z,K$r,0,K$P-K$r-K$k,K$n)):(K$N.clearObject(this,K$S),this._weakKeys[4]="")),K$x&&(K$Z=K$O.getTexture(K$c,K$r,K$b-K$x,K$E-K$r-K$k,K$x),K$S=this._weakKeys[5],K$Z?(K$S!=K$Z.weakKey&&(K$N.clearObject(this,K$S),K$N.keepObject(this,K$Z.weakKey),this._weakKeys[5]=K$Z.weakKey),this.drawBitmap(K$g,K$Z,K$r,K$q-K$x,K$P-K$r-K$k,K$x)):(K$N.clearObject(this,K$S),this._weakKeys[5]="")),K$r&&(K$Z=K$O.getTexture(K$c,0,K$n,K$r,K$b-K$n-K$x),K$S=this._weakKeys[6],K$Z?(K$S!=K$Z.weakKey&&(K$N.clearObject(this,K$S),K$N.keepObject(this,K$Z.weakKey),this._weakKeys[6]=K$Z.weakKey),this.drawBitmap(K$g,K$Z,0,K$n,K$r,K$q-K$n-K$x)):(K$N.clearObject(this,K$S),this._weakKeys[6]="")),K$k&&(K$Z=K$O.getTexture(K$c,K$E-K$k,K$n,K$k,K$b-K$n-K$x),K$S=this._weakKeys[7],K$Z?(K$S!=K$Z.weakKey&&(K$N.clearObject(this,K$S),K$N.keepObject(this,K$Z.weakKey),this._weakKeys[7]=K$Z.weakKey),this.drawBitmap(K$g,K$Z,K$P-K$k,K$n,K$k,K$q-K$n-K$x)):(K$N.clearObject(this,K$S),this._weakKeys[7]="")),K$Z=K$O.getTexture(K$c,K$r,K$n,K$E-K$r-K$k,K$b-K$n-K$x),K$S=this._weakKeys[8],K$Z?(K$S!=K$Z.weakKey&&(K$N.clearObject(this,K$S),K$N.keepObject(this,K$Z.weakKey),this._weakKeys[8]=K$Z.weakKey),this.drawBitmap(K$g,K$Z,K$r,K$n,K$P-K$r-K$k,K$q-K$n-K$x)):(K$N.clearObject(this,K$S),this._weakKeys[8]=""),K$W&&this.restore(),this.autoCacheCmd&&!K$m.isConchApp&&(K$N.saveObject(K$e,this.cmds,null),this._weakKey=K$e,K$N.keepObject(this,this._weakKey))}this._repaint()}},K$c.drawBitmap=function(K$c,K$P,K$q,K$_,K$E,K$b){void 0===K$E&&(K$E=0),void 0===K$b&&(K$b=0),K$E<.1||K$b<.1||(!K$c||K$P.width==K$E&&K$P.height==K$b?this.drawTexture(K$P,K$q,K$_,K$E,K$b):this.fillTexture(K$P,K$q,K$_,K$E,K$b))},K$c.clear=function(K$c){void 0===K$c&&(K$c=!0),K$q.prototype.clear.call(this,!1)},K$e(0,K$c,"sizeGrid",function(){return this._sizeGrid},function(K$c){this._sizeGrid=K$c,this._setChanged()}),K$e(0,K$c,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(K$c){this._width!=K$c&&(this._width=K$c,this._setChanged())}),K$e(0,K$c,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(K$c){this._height!=K$c&&(this._height=K$c,this._setChanged())}),K$e(0,K$c,"source",function(){return this._source},function(K$c){K$c?(this._source=K$c,this._setChanged()):(this._source=null,this.clear())}),K$O.getTexture=function(K$c,K$P,K$q,K$_,K$E){K$_<=0&&(K$_=1),K$E<=0&&(K$E=1),K$c.$_GID||(K$c.$_GID=K$Q.getGID());var K$b=K$c.$_GID+"."+K$P+"."+K$q+"."+K$_+"."+K$E,K$e=K$N.findObject(K$b);if((!K$e||!K$e.source)&&(K$e=K$L.createFromTexture(K$c,K$P,K$q,K$_,K$E))){if(K$c.alphaTexture){var K$h=K$c.width/K$c.alphaTexture.width;K$e.alphaTexture=K$L.createFromTexture(K$c.alphaTexture,K$P/K$h,K$q/K$h,K$_/K$h,K$E/K$h)}K$N.saveObject(K$b,K$e),K$e.weakKey=K$b}return K$e},K$O}(K$P),K$R=(function(K$c){function K$P(){K$P.__super.call(this)}K$b(K$P,"laya.ui.UIEvent",K$S),K$P.SHOW_TIP="showtip",K$P.HIDE_TIP="hidetip"}(),function(K$P){function K$c(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,K$c.__super.call(this),this._layout=K$u.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}K$b(K$c,"laya.ui.Component",K$P);var K$q=K$c.prototype;return K$W.imps(K$q,{"laya.ui.IComponent":!0}),K$q.destroy=function(K$c){void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,K$c),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},K$q.preinitialize=function(){},K$q.createChildren=function(){},K$q.initialize=function(){},K$q.callLater=function(K$c,K$P){K$W.timer.callLater(this,K$c,K$P)},K$q.runCallLater=function(K$c){K$W.timer.runCallLater(this,K$c)},K$q.commitMeasure=function(){},K$q.changeSize=function(){this.event("resize")},K$q.getLayout=function(){return this._layout===K$u.EMPTY&&(this._layout=new K$u),this._layout},K$q._setLayoutEnabled=function(K$c){this._layout&&this._layout.enable!=K$c&&(this._layout.enable=K$c,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},K$q.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},K$q.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},K$q.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},K$q.resetLayoutX=function(){var K$c=this._layout;if(isNaN(K$c.anchorX)||(this.pivotX=K$c.anchorX*this.width),this.layoutEnabled){var K$P=this.parent;K$P&&(isNaN(K$c.centerX)?isNaN(K$c.left)?isNaN(K$c.right)||(this.x=Math.round(K$P.width-this.displayWidth-K$c.right+this.pivotX*this.scaleX)):(this.x=Math.round(K$c.left+this.pivotX*this.scaleX),isNaN(K$c.right)||(this.width=(K$P._width-K$c.left-K$c.right)/(this.scaleX||.01))):this.x=Math.round(.5*(K$P.width-this.displayWidth)+K$c.centerX+this.pivotX*this.scaleX))}},K$q.resetLayoutY=function(){var K$c=this._layout;if(isNaN(K$c.anchorY)||(this.pivotY=K$c.anchorY*this.height),this.layoutEnabled){var K$P=this.parent;K$P&&(isNaN(K$c.centerY)?isNaN(K$c.top)?isNaN(K$c.bottom)||(this.y=Math.round(K$P.height-this.displayHeight-K$c.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(K$c.top+this.pivotY*this.scaleY),isNaN(K$c.bottom)||(this.height=(K$P._height-K$c.top-K$c.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(K$P.height-this.displayHeight)+K$c.centerY+this.pivotY*this.scaleY))}},K$q.onMouseOver=function(K$c){K$W.stage.event("showtip",this._toolTip)},K$q.onMouseOut=function(K$c){K$W.stage.event("hidetip",this._toolTip)},K$e(0,K$q,"displayWidth",function(){return this.width*this.scaleX}),K$e(0,K$q,"width",function(){return this._width?this._width:this.measureWidth},function(K$c){this._width!=K$c&&(this._width=K$c,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),K$e(0,K$q,"measureWidth",function(){var K$c=0;this.commitMeasure();for(var K$P=this.numChildren-1;-1<K$P;K$P--){var K$q=this.getChildAt(K$P);K$q.visible&&(K$c=Math.max(K$q.x+K$q.width*K$q.scaleX,K$c))}return K$c}),K$e(0,K$q,"displayHeight",function(){return this.height*this.scaleY}),K$e(0,K$q,"height",function(){return this._height?this._height:this.measureHeight},function(K$c){this._height!=K$c&&(this._height=K$c,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),K$e(0,K$q,"dataSource",function(){return this._dataSource},function(K$c){for(var K$P in this._dataSource=K$c,this._dataSource)this.hasOwnProperty(K$P)&&"function"!=typeof this[K$P]&&(this[K$P]=this._dataSource[K$P])}),K$e(0,K$q,"scaleY",K$P.prototype._$get_scaleY,function(K$c){K$W.superGet(K$T,this,"scaleY")!=K$c&&(K$W.superSet(K$T,this,"scaleY",K$c),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),K$e(0,K$q,"measureHeight",function(){var K$c=0;this.commitMeasure();for(var K$P=this.numChildren-1;-1<K$P;K$P--){var K$q=this.getChildAt(K$P);K$q.visible&&(K$c=Math.max(K$q.y+K$q.height*K$q.scaleY,K$c))}return K$c}),K$e(0,K$q,"scaleX",K$P.prototype._$get_scaleX,function(K$c){K$W.superGet(K$T,this,"scaleX")!=K$c&&(K$W.superSet(K$T,this,"scaleX",K$c),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),K$e(0,K$q,"top",function(){return this._layout.top},function(K$c){K$c!=this._layout.top&&(this.getLayout().top=K$c,this._setLayoutEnabled(!0)),this.resetLayoutY()}),K$e(0,K$q,"bottom",function(){return this._layout.bottom},function(K$c){K$c!=this._layout.bottom&&(this.getLayout().bottom=K$c,this._setLayoutEnabled(!0)),this.resetLayoutY()}),K$e(0,K$q,"left",function(){return this._layout.left},function(K$c){K$c!=this._layout.left&&(this.getLayout().left=K$c,this._setLayoutEnabled(!0)),this.resetLayoutX()}),K$e(0,K$q,"right",function(){return this._layout.right},function(K$c){K$c!=this._layout.right&&(this.getLayout().right=K$c,this._setLayoutEnabled(!0)),this.resetLayoutX()}),K$e(0,K$q,"centerX",function(){return this._layout.centerX},function(K$c){K$c!=this._layout.centerX&&(this.getLayout().centerX=K$c,this._setLayoutEnabled(!0)),this.resetLayoutX()}),K$e(0,K$q,"centerY",function(){return this._layout.centerY},function(K$c){K$c!=this._layout.centerY&&(this.getLayout().centerY=K$c,this._setLayoutEnabled(!0)),this.resetLayoutY()}),K$e(0,K$q,"anchorX",function(){return this._layout.anchorX},function(K$c){K$c!=this._layout.anchorX&&(this.getLayout().anchorX=K$c,this._setLayoutEnabled(!0)),this.resetLayoutX()}),K$e(0,K$q,"anchorY",function(){return this._layout.anchorY},function(K$c){K$c!=this._layout.anchorY&&(this.getLayout().anchorY=K$c,this._setLayoutEnabled(!0)),this.resetLayoutY()}),K$e(0,K$q,"tag",function(){return this._tag},function(K$c){this._tag=K$c}),K$e(0,K$q,"toolTip",function(){return this._toolTip},function(K$c){this._toolTip!=K$c&&(null!=(this._toolTip=K$c)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),K$e(0,K$q,"comXml",function(){return this._comXml},function(K$c){this._comXml=K$c}),K$e(0,K$q,"gray",function(){return this._gray},function(K$c){K$c!==this._gray&&(this._gray=K$c,K$J.gray(this,K$c))}),K$e(0,K$q,"disabled",function(){return this._disabled},function(K$c){K$c!==this._disabled&&(this.gray=this._disabled=K$c,this.mouseEnabled=!K$c)}),K$c}(K$T)),K$$=function(K$c){function K$P(){this.lockLayer=null,this.popupEffect=function(K$c){K$c.scale(1,1),K$H.from(K$c,{x:K$W.stage.width/2,y:K$W.stage.height/2,scaleX:0,scaleY:0},300,K$Z.backOut,K$x.create(this,this.doOpen,[K$c]))},this.closeEffect=function(K$c,K$P){K$H.to(K$c,{x:K$W.stage.width/2,y:K$W.stage.height/2,scaleX:0,scaleY:0},300,K$Z.strongOut,K$x.create(this,this.doClose,[K$c,K$P]))},K$P.__super.call(this),this.maskLayer=new K$T,this.popupEffectHandler=K$x.create(this,this.popupEffect,null,!1),this.closeEffectHandler=K$x.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,K$W.stage.addChild(this),K$W.stage.on("resize",this,this._onResize),K$j.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}K$b(K$P,"laya.ui.DialogManager",K$T);var K$q=K$P.prototype;return K$q._closeOnSide=function(){var K$c=this.getChildAt(this.numChildren-1);K$c instanceof laya.ui.Dialog&&K$c.close("side")},K$q.setLockView=function(K$c){this.lockLayer||(this.lockLayer=new K$C,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(K$W.stage.width,K$W.stage.height)),this.lockLayer.removeChildren(),K$c&&(K$c.centerX=K$c.centerY=0,this.lockLayer.addChild(K$c))},K$q._onResize=function(K$c){var K$P=this.maskLayer.width=K$W.stage.width,K$q=this.maskLayer.height=K$W.stage.height;this.lockLayer&&this.lockLayer.size(K$P,K$q),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,K$P,K$q,K$j.popupBgColor),this.maskLayer.alpha=K$j.popupBgAlpha;for(var K$_=this.numChildren-1;-1<K$_;K$_--){var K$E=this.getChildAt(K$_);K$E.popupCenter&&this._centerDialog(K$E)}},K$q._centerDialog=function(K$c){K$c.x=Math.round((K$W.stage.width-K$c.width>>1)+K$c.pivotX),K$c.y=Math.round((K$W.stage.height-K$c.height>>1)+K$c.pivotY)},K$q.open=function(K$c,K$P,K$q){void 0===K$P&&(K$P=!1),void 0===K$q&&(K$q=!1),K$P&&this._closeAll(),K$c.popupCenter&&this._centerDialog(K$c),this.addChild(K$c),(K$c.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),K$q&&null!=K$c.popupEffect?K$c.popupEffect.runWith(K$c):this.doOpen(K$c),this.event("open")},K$q.doOpen=function(K$c){K$c.onOpened()},K$q.lock=function(K$c){this.lockLayer&&(K$c?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},K$q.close=function(K$c,K$P,K$q){void 0===K$q&&(K$q=!1),K$q&&null!=K$c.closeEffect?K$c.closeEffect.runWith([K$c,K$P]):this.doClose(K$c,K$P),this.event("close")},K$q.doClose=function(K$c,K$P){K$c.removeSelf(),K$c.isModal&&this._checkMask(),K$c.closeHandler&&K$c.closeHandler.runWith(K$P),K$c.onClosed(K$P)},K$q.closeAll=function(){this._closeAll(),this.event("close")},K$q._closeAll=function(){for(var K$c=this.numChildren-1;-1<K$c;K$c--){var K$P=this.getChildAt(K$c);K$P&&null!=K$P.close&&this.doClose(K$P)}},K$q.getDialogsByGroup=function(K$c){for(var K$P=[],K$q=this.numChildren-1;-1<K$q;K$q--){var K$_=this.getChildAt(K$q);K$_&&K$_.group===K$c&&K$P.push(K$_)}return K$P},K$q.closeByGroup=function(K$c){for(var K$P=[],K$q=this.numChildren-1;-1<K$q;K$q--){var K$_=this.getChildAt(K$q);K$_&&K$_.group===K$c&&(K$_.close(),K$P.push(K$_))}return K$P},K$q._checkMask=function(){this.maskLayer.removeSelf();for(var K$c=this.numChildren-1;-1<K$c;K$c--){var K$P=this.getChildAt(K$c);if(K$P&&K$P.isModal)return void this.addChildAt(this.maskLayer,K$c)}},K$P}(),K$C=function(K$c){function K$P(){K$P.__super.call(this)}K$b(K$P,"laya.ui.Box",K$c);var K$q=K$P.prototype;return K$W.imps(K$q,{"laya.ui.IBox":!0}),K$e(0,K$q,"dataSource",K$c.prototype._$get_dataSource,function(K$c){for(var K$P in this._dataSource=K$c){var K$q=this.getChildByName(K$P);K$q?K$q.dataSource=K$c[K$P]:this.hasOwnProperty(K$P)&&"function"!=typeof this[K$P]&&(this[K$P]=K$c[K$P])}}),K$P}(K$R),K$F=function(K$P){function K$q(K$c,K$P){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,K$q.__super.call(this),this._labelColors=K$A.buttonLabelColors,this._stateNum=K$A.buttonStateNum,void 0===K$P&&(K$P=""),this.skin=K$c,this.label=K$P}K$b(K$q,"laya.ui.Button",K$P);var K$c=K$q.prototype;return K$W.imps(K$c,{"laya.ui.ISelect":!0}),K$c.destroy=function(K$c){this.clearEvent(),K$N.clearCache(this,this._skin),K$N.clearObject(this,this._weakKey),void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,K$c),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(K$c),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},K$c.clearEvent=function(){this._skin&&K$E.atalsNotify&&K$E.atalsNotify.off(this._skin,this,this._setBtnSource)},K$c.createChildren=function(){this.graphics=this._bitmap=new K$V},K$c.createText=function(){this._text||(this._text=new K$D,this._text.overflow=K$D.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},K$c.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},K$c.onMouse=function(K$c){if(!1!==this.toggle||!this._selected)return"click"===K$c.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=K$q.stateMap[K$c.type]))},K$c.changeClips=function(){var K$c=K$N.getRes(this._skin);if(K$c)if(this._skin&&""!=this._skin){K$N.clearObject(this,this._weakKey);var K$P=K$c.sourceWidth,K$q=K$c.sourceHeight/this._stateNum;K$c.$_GID||(K$c.$_GID=K$Q.getGID());var K$_=K$c.$_GID+"-"+this._stateNum,K$E=K$N.findObject(K$_);if(K$Q.isOkTextureList(K$E)||(K$E=null),K$E)this._weakKey=K$_,K$N.keepObject(this,this._weakKey),this._sources=K$E;else{if(this._sources=[],1===this._stateNum)this._sources.push(K$c);else for(var K$b=0;K$b<this._stateNum;K$b++){var K$e=K$L.createFromTexture(K$c,0,K$q*K$b,K$P,K$q);if(K$c.alphaTexture){var K$h=K$c.width/K$c.alphaTexture.width;K$e.alphaTexture=K$L.createFromTexture(K$c.alphaTexture,0/K$h,K$q*K$b/K$h,K$P/K$h,K$q/K$h)}this._sources.push(K$e)}K$N.saveObject(K$_,this._sources),this._weakKey=K$_,K$N.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||K$P,this._bitmap.height=this._height||K$q,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=K$P)}else console.warn("lose skin ",this._skin,this.name,this.__className)},K$c.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var K$c=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[K$c]),this.label&&(this._text.color=this._labelColors[K$c],this._strokeColors&&(this._text.strokeColor=this._strokeColors[K$c]))},K$c._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},K$e(0,K$c,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(K$c){this.createText(),this._text.strokeColor=K$c}),K$e(0,K$c,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),K$e(0,K$c,"skin",function(){return this._skin},function(K$c){if(this._skin!=K$c)if(this.clearEvent(),K$N.clearCache(this,this._skin),this._skin=K$c,K$N.keepCache(this,this._skin),K$N.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var K$P=K$E.resAtalsObj&&K$E.resAtalsObj[this._skin];K$P?(K$E.atalsNotify&&K$E.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=K$P.sourceW),0==this.height&&(this.height=K$P.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),K$c._setBtnSource=function(K$c,K$P){K$c===this._skin&&K$P&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},K$e(0,K$c,"state",function(){return this._state},function(K$c){this._state!=K$c&&(this._state=K$c,this._setStateChanged())}),K$e(0,K$c,"text",function(){return this.createText(),this._text}),K$e(0,K$c,"stateNum",function(){return this._stateNum},function(K$c){"string"==typeof K$c&&(K$c=parseInt(K$c)),this._stateNum!=K$c&&(this._stateNum=K$c<1?1:3<K$c?3:K$c,this.callLater(this.changeClips))}),K$e(0,K$c,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(K$c){this._strokeColors=K$J.fillArray(K$A.buttonLabelColors,K$c,String),this._setStateChanged()}),K$e(0,K$c,"labelColors",function(){return this._labelColors.join(",")},function(K$c){this._labelColors=K$J.fillArray(K$A.buttonLabelColors,K$c,String),this._setStateChanged()}),K$e(0,K$c,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),K$e(0,K$c,"label",function(){return this._text?this._text.text:null},function(K$c){(this._text||K$c)&&(this.createText(),this._text.text!=K$c&&(K$c&&!this._text.parent&&this.addChild(this._text),this._text.text=(K$c+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),K$e(0,K$c,"selected",function(){return this._selected},function(K$c){this._selected!=K$c&&(this._selected=K$c,this.state=this._selected?2:0,this.event("change"))}),K$e(0,K$c,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(K$c){this.createText(),this._text.padding=K$J.fillArray(K$A.labelPadding,K$c,Number)}),K$e(0,K$c,"labelSize",function(){return this.createText(),this._text.fontSize},function(K$c){this.createText(),this._text.fontSize=K$c}),K$e(0,K$c,"labelStroke",function(){return this.createText(),this._text.stroke},function(K$c){this.createText(),this._text.stroke=K$c}),K$e(0,K$c,"labelBold",function(){return this.createText(),this._text.bold},function(K$c){this.createText(),this._text.bold=K$c}),K$e(0,K$c,"labelFont",function(){return this.createText(),this._text.font},function(K$c){this.createText(),this._text.font=K$c}),K$e(0,K$c,"labelAlign",function(){return this.createText(),this._text.align},function(K$c){this.createText(),this._text.align=K$c}),K$e(0,K$c,"clickHandler",function(){return this._clickHandler},function(K$c){this._clickHandler=K$c}),K$e(0,K$c,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(K$c){this._bitmap.sizeGrid=K$J.fillArray(K$A.defaultSizeGrid,K$c,Number)}),K$e(0,K$c,"width",K$P.prototype._$get_width,function(K$c){K$W.superSet(K$R,this,"width",K$c),this._autoSize&&(this._bitmap.width=K$c,this._text&&(this._text.width=K$c))}),K$e(0,K$c,"height",K$P.prototype._$get_height,function(K$c){K$W.superSet(K$R,this,"height",K$c),this._autoSize&&(this._bitmap.height=K$c,this._text&&(this._text.height=K$c))}),K$e(0,K$c,"dataSource",K$P.prototype._$get_dataSource,function(K$c){"number"==typeof(this._dataSource=K$c)||"string"==typeof K$c?this.label=K$c+"":K$W.superSet(K$R,this,"dataSource",K$c)}),K$e(0,K$c,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(K$c){this._bitmap._offset=K$c?K$J.fillArray([1,1],K$c,Number):[]}),K$_(K$q,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),K$q}(K$R),K$o=function(K$P){function K$_(K$c,K$P,K$q){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,K$_.__super.call(this),void 0===K$P&&(K$P=1),void 0===K$q&&(K$q=1),this._clipX=K$P,this._clipY=K$q,this.skin=K$c}K$b(K$_,"laya.ui.Clip",K$P);var K$c=K$_.prototype;return K$c.destroy=function(K$c){this.clearEvent(),this.clearLoad(),K$N.clearCache(this,this._skin),K$N.clearObject(this,this._weakKey),void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},K$c.dispose=function(){this.destroy(!0),K$W.loader.clearRes(this._skin)},K$c.createChildren=function(){this.graphics=this._bitmap=new K$V},K$c._onDisplay=function(K$c){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},K$c.changeClip=function(){if(this._clipChanged=!1,this._skin){var K$c=K$N.getRes(this._skin);if(K$c)this.loadComplete(this._skin,K$c);else{if(K$E.resAtalsObj&&K$E.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=K$x.create(this,this.loadComplete,[this._skin]),this._progress=null,K$W.loader.load(this._skin,this._complete,this._progress)}}},K$c.loadComplete=function(K$c,K$P){if(K$c===this._skin&&K$P){K$N.clearObject(this,this._weakKey);var K$q=this._clipWidth||Math.ceil(K$P.sourceWidth/this._clipX),K$_=this._clipHeight||Math.ceil(K$P.sourceHeight/this._clipY),K$E=this._skin+K$q+K$_,K$b=K$N.findObject(K$E);if(K$Q.isOkTextureList(K$b)||(K$b=null),K$b)this._weakKey=K$E,K$N.keepObject(this,this._weakKey),this._sources=K$b;else{this._sources=[];for(var K$e=0;K$e<this._clipY;K$e++)for(var K$h=0;K$h<this._clipX;K$h++){var K$Z=K$L.createFromTexture(K$P,K$q*K$h,K$_*K$e,K$q,K$_);if(K$P.alphaTexture){var K$S=K$P.width/K$P.alphaTexture.width;K$Z.alphaTexture=K$L.createFromTexture(K$P.alphaTexture,K$q*K$h/K$S,K$_*K$e/K$S,K$q/K$S,K$_/K$S)}this._sources.push(K$Z)}K$N.saveObject(K$E,this._sources),this._weakKey=K$E,K$N.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},K$c.play=function(K$c,K$P){void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=-1),this._isPlaying=!0,this.index=K$c,this._toIndex=K$P,this._index++,K$W.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},K$c._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},K$c.stop=function(){this._isPlaying=!1,K$W.timer.clear(this,this._loop),this.event("complete")},K$c._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},K$e(0,K$c,"interval",function(){return this._interval},function(K$c){this._interval!=K$c&&(this._interval=K$c,this._isPlaying&&this.play())}),K$c.clearEvent=function(){this._skin&&K$E.atalsNotify&&K$E.atalsNotify.off(this._skin,this,this._setBtnSource)},K$c.clearLoad=function(){this._skin&&((this._complete||this._progress)&&K$W.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},K$e(0,K$c,"skin",function(){return this._skin},function(K$c){if(this._skin!=K$c)if(this.clearLoad(),this.clearEvent(),K$N.clearCache(this,this._skin),this._skin=K$c){K$N.keepCache(this,this._skin);var K$P=K$N.getRes(K$c),K$q=K$E.resAtalsObj&&K$E.resAtalsObj[this._skin];!K$P&&K$q?K$E.atalsNotify&&K$E.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),K$c._setBtnSource=function(K$c,K$P){K$c===this._skin&&K$P&&(this.loadComplete(K$c,K$P),this.clearEvent())},K$e(0,K$c,"sources",function(){return this._sources},function(K$c){this._sources=K$c,this.index=this._index,this.event("loaded")}),K$e(0,K$c,"clipX",function(){return this._clipX},function(K$c){this._clipX=K$c||1,this._setClipChanged()}),K$e(0,K$c,"clipY",function(){return this._clipY},function(K$c){this._clipY=K$c||1,this._setClipChanged()}),K$e(0,K$c,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),K$e(0,K$c,"clipWidth",function(){return this._clipWidth},function(K$c){this._clipWidth=K$c,this._setClipChanged()}),K$e(0,K$c,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(K$c){this._bitmap.sizeGrid=K$J.fillArray(K$A.defaultSizeGrid,K$c,Number)}),K$e(0,K$c,"group",function(){return this._group},function(K$c){K$c&&this._skin&&K$N.setGroup(this._skin,K$c),this._group=K$c}),K$e(0,K$c,"clipHeight",function(){return this._clipHeight},function(K$c){this._clipHeight=K$c,this._setClipChanged()}),K$e(0,K$c,"width",K$P.prototype._$get_width,function(K$c){K$W.superSet(K$R,this,"width",K$c),this._bitmap.width=K$c}),K$e(0,K$c,"height",K$P.prototype._$get_height,function(K$c){K$W.superSet(K$R,this,"height",K$c),this._bitmap.height=K$c}),K$e(0,K$c,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),K$e(0,K$c,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),K$e(0,K$c,"index",function(){return this._index},function(K$c){this._index=K$c,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[K$c]),this.event("change")}),K$e(0,K$c,"autoPlay",function(){return this._autoPlay},function(K$c){this._autoPlay!=K$c&&((this._autoPlay=K$c)?this.play():this.stop())}),K$e(0,K$c,"isPlaying",function(){return this._isPlaying},function(K$c){this._isPlaying=K$c}),K$e(0,K$c,"dataSource",K$P.prototype._$get_dataSource,function(K$c){"number"==typeof(this._dataSource=K$c)&&Math.floor(K$c)==K$c||"string"==typeof K$c?this.index=parseInt(K$c):K$W.superSet(K$R,this,"dataSource",K$c)}),K$e(0,K$c,"bitmap",function(){return this._bitmap}),K$_}(K$R),K$a=function(K$P){function K$c(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,K$c.__super.call(this)}K$b(K$c,"laya.ui.ColorPicker",K$P);var K$q=K$c.prototype;return K$q.destroy=function(K$c){void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,K$c),this._colorPanel&&this._colorPanel.destroy(K$c),this._colorButton&&this._colorButton.destroy(K$c),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},K$q.createChildren=function(){this.addChild(this._colorButton=new K$F),this._colorPanel=new K$C,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new K$T),this._colorPanel.addChild(this._colorBlock=new K$T),this._colorPanel.addChild(this._colorInput=new K$r)},K$q.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},K$q.onPanelMouseDown=function(K$c){K$c.stopPropagation()},K$q.changePanel=function(){this._panelChanged=!1;var K$c=this._colorPanel.graphics;K$c.clear(),K$c.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(K$c=this._colorTiles.graphics).clear();for(var K$P=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],K$q=0;K$q<12;K$q++)for(var K$_=0;K$_<20;K$_++){var K$E=0;K$E=0===K$_?K$P[K$q]:1===K$_?0:51*(((3*K$q+K$_/6)%3<<0)+3*(K$q/6<<0))<<16|K$_%6*51<<8|(K$q<<0)%6*51;var K$b=K$J.toColor(K$E);this._colors.push(K$b);var K$e=K$_*this._gridSize,K$h=K$q*this._gridSize;K$c.drawRect(K$e,K$h,this._gridSize,this._gridSize,K$b,"#000000")}},K$q.onColorButtonClick=function(K$c){this._colorPanel.parent?this.close():this.open()},K$q.open=function(){var K$c=this.localToGlobal(new K$g),K$P=K$c.x+this._colorPanel.width<=K$W.stage.width?K$c.x:K$W.stage.width-this._colorPanel.width,K$q=K$c.y+this._colorButton.height;K$q=K$q+this._colorPanel.height<=K$W.stage.height?K$q:K$c.y-this._colorPanel.height,this._colorPanel.pos(K$P,K$q),this._colorPanel.zOrder=1001,K$W._currentStage.addChild(this._colorPanel),K$W.stage.on("mousedown",this,this.removeColorBox)},K$q.close=function(){K$W.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},K$q.removeColorBox=function(K$c){this.close()},K$q.onColorFieldKeyDown=function(K$c){13==K$c.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),K$c.stopPropagation())},K$q.onColorInputChange=function(K$c){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},K$q.onColorTilesClick=function(K$c){this.selectedColor=this.getColorByMouse(),this.close()},K$q.onColorTilesMouseMove=function(K$c){this._colorInput.focus=!1;var K$P=this.getColorByMouse();this._colorInput.text=K$P,this.drawBlock(K$P)},K$q.getColorByMouse=function(){var K$c=this._colorTiles.getMousePoint(),K$P=Math.floor(K$c.x/this._gridSize),K$q=Math.floor(K$c.y/this._gridSize);return this._colors[20*K$q+K$P]},K$q.drawBlock=function(K$c){var K$P=this._colorBlock.graphics;K$P.clear();var K$q=K$c||"#ffffff";K$P.drawRect(0,0,50,20,K$q,this._borderColor),K$c||K$P.drawLine(0,0,50,20,"#ff0000")},K$q.changeColor=function(){var K$c=this.graphics;K$c.clear();var K$P=this._selectedColor||"#000000";K$c.drawRect(0,0,this._colorButton.width,this._colorButton.height,K$P)},K$q._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},K$e(0,K$q,"inputBgColor",function(){return this._inputBgColor},function(K$c){this._inputBgColor=K$c,this._setPanelChanged()}),K$e(0,K$q,"selectedColor",function(){return this._selectedColor},function(K$c){this._selectedColor!=K$c&&(this._selectedColor=this._colorInput.text=K$c,this.drawBlock(K$c),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",K$S.EMPTY.setTo("change",this,this)))}),K$e(0,K$q,"skin",function(){return this._colorButton.skin},function(K$c){this._colorButton.skin=K$c,this.changeColor()}),K$e(0,K$q,"bgColor",function(){return this._bgColor},function(K$c){this._bgColor=K$c,this._setPanelChanged()}),K$e(0,K$q,"borderColor",function(){return this._borderColor},function(K$c){this._borderColor=K$c,this._setPanelChanged()}),K$e(0,K$q,"inputColor",function(){return this._inputColor},function(K$c){this._inputColor=K$c,this._setPanelChanged()}),K$c}(K$R),K$Y=function(K$P){function K$q(K$c,K$P){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,K$q.__super.call(this),this._itemColors=K$A.comboBoxItemColors,this.skin=K$c,this.labels=K$P}K$b(K$q,"laya.ui.ComboBox",K$P);var K$c=K$q.prototype;return K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,K$c),this._button&&this._button.destroy(K$c),this._list&&this._list.destroy(K$c),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},K$c.createChildren=function(){this.addChild(this._button=new K$F),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},K$c._createList=function(){this._list=new K$l,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},K$c._setListEvent=function(K$c){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=K$x.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},K$c.onListDown=function(K$c){K$c.stopPropagation()},K$c.onScrollBarDown=function(K$c){K$c.stopPropagation()},K$c.onButtonMouseDown=function(K$c){this.callLater(this.switchTo,[!this._isOpen])},K$c.changeList=function(){this._listChanged=!1;var K$c=this.width-2,K$P=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:K$c,height:this._itemHeight,fontSize:this._itemSize,color:K$P}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},K$c.onlistItemMouse=function(K$c,K$P){var K$q=K$c.type;if("mouseover"===K$q||"mouseout"===K$q){if(this._isCustomList)return;var K$_=this._list.getCell(K$P);if(!K$_)return;var K$E=K$_.getChildByName("label");K$E&&("mouseover"===K$q?(K$E.bgColor=this._itemColors[0],K$E.color=this._itemColors[1]):(K$E.bgColor=null,K$E.color=this._itemColors[2]))}else"click"===K$q&&(this.selectedIndex=K$P,this.isOpen=!1)},K$c.switchTo=function(K$c){this.isOpen=K$c},K$c.changeOpen=function(){this.isOpen=!this._isOpen},K$c.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var K$c=this._list.graphics;K$c.clear(),K$c.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var K$P=this._list.array||[],K$q=K$P.length=0,K$_=this._labels.length;K$q<K$_;K$q++)K$P.push({label:this._labels[K$q]});this._list.height=this._listHeight,this._list.array=K$P},K$c.changeSelected=function(){this._button.label=this.selectedLabel},K$c._onStageMouseWheel=function(K$c){this._list&&!this._list.contains(K$c.target)&&this.removeList(null)},K$c.removeList=function(K$c){K$W.stage.off("mousedown",this,this.removeList),K$W.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},K$e(0,K$c,"selectedIndex",function(){return this._selectedIndex},function(K$c){this._selectedIndex!=K$c&&(this._selectedIndex=K$c,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[K$S.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),K$e(0,K$c,"measureHeight",function(){return this._button.height}),K$e(0,K$c,"skin",function(){return this._button.skin},function(K$c){this._button.skin!=K$c&&(this._button.skin=K$c,this._listChanged=!0)}),K$e(0,K$c,"measureWidth",function(){return this._button.width}),K$e(0,K$c,"width",K$P.prototype._$get_width,function(K$c){K$W.superSet(K$R,this,"width",K$c),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),K$e(0,K$c,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(K$c){this.selectedIndex=this._labels.indexOf(K$c)}),K$e(0,K$c,"labels",function(){return this._labels.join(",")},function(K$c){0<this._labels.length&&(this.selectedIndex=-1),K$c?this._labels=K$c.split(","):this._labels.length=0,this._itemChanged=!0}),K$e(0,K$c,"height",K$P.prototype._$get_height,function(K$c){K$W.superSet(K$R,this,"height",K$c),this._button.height=this._height}),K$e(0,K$c,"selectHandler",function(){return this._selectHandler},function(K$c){this._selectHandler=K$c}),K$e(0,K$c,"visibleNum",function(){return this._visibleNum},function(K$c){this._visibleNum=K$c,this._listChanged=!0}),K$e(0,K$c,"labelBold",function(){return this._button.text.bold},function(K$c){this._button.text.bold=K$c}),K$e(0,K$c,"itemColors",function(){return String(this._itemColors)},function(K$c){this._itemColors=K$J.fillArray(this._itemColors,K$c,String),this._listChanged=!0}),K$e(0,K$c,"itemSize",function(){return this._itemSize},function(K$c){this._itemSize=K$c,this._listChanged=!0}),K$e(0,K$c,"scrollBar",function(){return this.list.scrollBar}),K$e(0,K$c,"isOpen",function(){return this._isOpen},function(K$c){if(this._isOpen!=K$c)if(this._isOpen=K$c,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var K$P=this.localToGlobal(K$g.TEMP.setTo(0,0)),K$q=K$P.y+this._button.height;K$q=K$q+this._listHeight<=K$W.stage.height?K$q:K$P.y-this._listHeight,this._list.pos(K$P.x,K$q),this._list.zOrder=1001,K$W._currentStage.addChild(this._list),K$W.stage.once("mousedown",this,this.removeList),K$W.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),K$e(0,K$c,"scrollBarSkin",function(){return this._scrollBarSkin},function(K$c){this._scrollBarSkin=K$c}),K$e(0,K$c,"sizeGrid",function(){return this._button.sizeGrid},function(K$c){this._button.sizeGrid=K$c}),K$e(0,K$c,"button",function(){return this._button}),K$e(0,K$c,"list",function(){return this._list||this._createList(),this._list},function(K$c){K$c&&(K$c.removeSelf(),this._isCustomList=!0,this._list=K$c,this._setListEvent(K$c),this._itemHeight=K$c.getCell(0).height+K$c.spaceY)}),K$e(0,K$c,"dataSource",K$P.prototype._$get_dataSource,function(K$c){"number"==typeof(this._dataSource=K$c)&&Math.floor(K$c)==K$c||"string"==typeof K$c?this.selectedIndex=parseInt(K$c):K$c instanceof Array?this.labels=K$c.join(","):K$W.superSet(K$R,this,"dataSource",K$c)}),K$e(0,K$c,"labelColors",function(){return this._button.labelColors},function(K$c){this._button.labelColors!=K$c&&(this._button.labelColors=K$c)}),K$e(0,K$c,"labelPadding",function(){return this._button.text.padding.join(",")},function(K$c){this._button.text.padding=K$J.fillArray(K$A.labelPadding,K$c,Number)}),K$e(0,K$c,"labelSize",function(){return this._button.text.fontSize},function(K$c){this._button.text.fontSize=K$c}),K$e(0,K$c,"labelFont",function(){return this._button.text.font},function(K$c){this._button.text.font=K$c}),K$e(0,K$c,"stateNum",function(){return this._button.stateNum},function(K$c){this._button.stateNum=K$c}),K$q}(K$R),K$s=function(K$P){function K$q(K$c){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,K$q.__super.call(this),this._showButtons=K$j.showButtons,this._touchScrollEnable=K$j.touchScrollEnable,this._mouseWheelEnable=K$j.mouseWheelEnable,this.skin=K$c,this.max=1}K$b(K$q,"laya.ui.ScrollBar",K$P);var K$c=K$q.prototype;return K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),this.stopScroll(),this.target=null,K$P.prototype.destroy.call(this,K$c),this.upButton&&this.upButton.destroy(K$c),this.downButton&&this.downButton.destroy(K$c),this.slider&&this.slider.destroy(K$c),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},K$c.createChildren=function(){this.addChild(this.slider=new K$U),this.addChild(this.upButton=new K$F),this.addChild(this.downButton=new K$F)},K$c.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},K$c.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},K$c.onButtonMouseDown=function(K$c){var K$P=K$c.currentTarget===this.upButton;this.slide(K$P),K$W.timer.once(K$A.scrollBarDelayTime,this,this.startLoop,[K$P]),K$W.stage.once("mouseup",this,this.onStageMouseUp)},K$c.startLoop=function(K$c){K$W.timer.frameLoop(1,this,this.slide,[K$c])},K$c.slide=function(K$c){K$c?this.value-=this._scrollSize:this.value+=this._scrollSize},K$c.onStageMouseUp=function(K$c){K$W.timer.clear(this,this.startLoop),K$W.timer.clear(this,this.slide)},K$c.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},K$c.changeSize=function(){K$P.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},K$c.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},K$c.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},K$c.setScroll=function(K$c,K$P,K$q){this.runCallLater(this.changeSize),this.slider.setSlider(K$c,K$P,K$q),this.slider.bar.visible=0<K$P,!this._hide&&this.autoHide&&(this.visible=!1)},K$c.onTargetMouseWheel=function(K$c){this.value-=K$c.delta*this._scrollSize,this.target=this._target},K$c.onTargetMouseDown=function(K$c){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new K$g),this._lastPoint.setTo(K$W.stage.mouseX,K$W.stage.mouseY),K$W.timer.clear(this,this.tweenMove),K$H.clearTween(this),K$W.stage.once("mouseup",this,this.onStageMouseUp2),K$W.stage.once("mouseout",this,this.onStageMouseUp2),K$W.timer.frameLoop(1,this,this.loop)},K$c.loop=function(){var K$c=K$W.stage.mouseY,K$P=K$W.stage.mouseX;if(this._lastOffset=this.isVertical?K$c-this._lastPoint.y:K$P-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?K$W.stage._canvasTransform.getScaleY():K$W.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=K$P,this._lastPoint.y=K$c,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},K$c.onStageMouseUp2=function(K$c){if(K$W.stage.off("mouseup",this,this.onStageMouseUp2),K$W.stage.off("mouseout",this,this.onStageMouseUp2),K$W.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?K$H.to(this,{value:this.min},this.elasticBackTime,K$Z.sineOut,K$x.create(this,this.elasticOver)):this._value>this.max&&K$H.to(this,{value:this.max},this.elasticBackTime,K$Z.sineOut,K$x.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?K$W.stage.mouseY-this._lastPoint.y:K$W.stage.mouseX-this._lastPoint.x);for(var K$P=0,K$q=Math.min(this._offsets.length,3),K$_=0;K$_<K$q;K$_++)K$P+=this._offsets[this._offsets.length-1-K$_];if(this._lastOffset=K$P/K$q,(K$P=Math.abs(this._lastOffset))<2)return void this.event("end");60<K$P&&(this._lastOffset=0<this._lastOffset?60:-60);var K$E=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));K$W.timer.frameLoop(1,this,this.tweenMove,[K$E])}},K$c.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&K$H.to(this,{alpha:0},500),this.event("end")},K$c.tweenMove=function(K$c){this._lastOffset*=this.rollRatio;var K$P=NaN;if(0<K$c&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,K$P=.5*-(this.min-K$c-this.value),this._lastOffset>K$P&&(this._lastOffset=K$P)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,K$P=.5*-(this.max+K$c-this.value),this._lastOffset<K$P&&(this._lastOffset=K$P))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(K$W.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?K$H.to(this,{value:this.min},this.elasticBackTime,K$Z.sineOut,K$x.create(this,this.elasticOver)):this._value>this.max?K$H.to(this,{value:this.max},this.elasticBackTime,K$Z.sineOut,K$x.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&K$H.to(this,{alpha:0},500)}},K$c.stopScroll=function(){this.onStageMouseUp2(null),K$W.timer.clear(this,this.tweenMove),K$H.clearTween(this)},K$e(0,K$c,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),K$e(0,K$c,"skin",function(){return this._skin},function(K$c){this._skin!=K$c&&(this._skin=K$c,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),K$e(0,K$c,"max",function(){return this.slider.max},function(K$c){this.slider.max=K$c}),K$e(0,K$c,"showButtons",function(){return this._showButtons},function(K$c){this._showButtons=K$c,this.callLater(this.changeScrollBar)}),K$e(0,K$c,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),K$e(0,K$c,"min",function(){return this.slider.min},function(K$c){this.slider.min=K$c}),K$e(0,K$c,"value",function(){return this._value},function(K$c){K$c!==this._value&&(this._value=K$c,this._isElastic||(this.slider._value!=K$c&&(this.slider._value=K$c,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),K$e(0,K$c,"isVertical",function(){return this.slider.isVertical},function(K$c){this.slider.isVertical=K$c}),K$e(0,K$c,"sizeGrid",function(){return this.slider.sizeGrid},function(K$c){this.slider.sizeGrid=K$c}),K$e(0,K$c,"scrollSize",function(){return this._scrollSize},function(K$c){this._scrollSize=K$c}),K$e(0,K$c,"dataSource",K$P.prototype._$get_dataSource,function(K$c){"number"==typeof(this._dataSource=K$c)||"string"==typeof K$c?this.value=Number(K$c):K$W.superSet(K$R,this,"dataSource",K$c)}),K$e(0,K$c,"thumbPercent",function(){return this._thumbPercent},function(K$c){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),K$c=1<=K$c?.99:K$c,this._thumbPercent=K$c,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*K$c,K$A.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*K$c,K$A.scrollBarMinNum))}),K$e(0,K$c,"target",function(){return this._target},function(K$c){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=K$c)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),K$e(0,K$c,"hide",function(){return this._hide},function(K$c){this._hide=K$c,this.visible=!K$c}),K$e(0,K$c,"touchScrollEnable",function(){return this._touchScrollEnable},function(K$c){this._touchScrollEnable=K$c,this.target=this._target}),K$e(0,K$c,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(K$c){this._mouseWheelEnable=K$c,this.target=this._target}),K$e(0,K$c,"tick",function(){return this.slider.tick},function(K$c){this.slider.tick=K$c}),K$q}(K$R),K$U=function(K$P){function K$q(K$c){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,K$q.__super.call(this),this.skin=K$c}K$b(K$q,"laya.ui.Slider",K$P);var K$c=K$q.prototype;return K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,K$c),this._bg&&this._bg.destroy(K$c),this._bar&&this._bar.destroy(K$c),this._progress&&this._progress.destroy(K$c),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},K$c.createChildren=function(){this.addChild(this._bg=new K$I),this.addChild(this._bar=new K$F)},K$c.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},K$c.onBarMouseDown=function(K$c){this._globalSacle||(this._globalSacle=new K$g),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=K$W.stage.mouseX,this._ty=K$W.stage.mouseY,K$W.stage.on("mousemove",this,this.mouseMove),K$W.stage.once("mouseup",this,this.mouseUp),K$W.stage.once("mouseout",this,this.mouseUp),this.showValueText()},K$c.showValueText=function(){if(this.showLabel){var K$c=laya.ui.Slider.label;this.addChild(K$c),K$c.textField.changeText(this._value+""),this.isVertical?(K$c.x=this._bar.x+20,K$c.y=.5*(this._bar.height-K$c.height)+this._bar.y):(K$c.y=this._bar.y-20,K$c.x=.5*(this._bar.width-K$c.width)+this._bar.x)}},K$c.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},K$c.mouseUp=function(K$c){K$W.stage.off("mousemove",this,this.mouseMove),K$W.stage.off("mouseup",this,this.mouseUp),K$W.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},K$c.mouseMove=function(K$c){var K$P=this._value;this.isVertical?(this._bar.y+=(K$W.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(K$W.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=K$W.stage.mouseX,this._ty=K$W.stage.mouseY;var K$q=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*K$q)/K$q,this._value!=K$P&&this.sendChangeEvent(),this.showValueText()},K$c.sendChangeEvent=function(K$c){void 0===K$c&&(K$c="change"),this.event(K$c),this.changeHandler&&this.changeHandler.runWith(this._value)},K$c.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},K$c.changeSize=function(){K$P.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},K$c.setSlider=function(K$c,K$P,K$q){this._value=-1,this._min=K$c,this._max=K$c<K$P?K$P:K$c,this.value=K$q<K$c?K$c:K$P<K$q?K$P:K$q},K$c.changeValue=function(){var K$c=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*K$c)/K$c,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var K$P=this._max-this._min;0===K$P&&(K$P=1),this.isVertical?(this._bar.y=(this._value-this._min)/K$P*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/K$P*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},K$c.onBgMouseDown=function(K$c){var K$P=this._bg.getMousePoint();this.isVertical?this.value=K$P.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=K$P.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},K$e(0,K$c,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),K$e(0,K$c,"skin",function(){return this._skin},function(K$c){if(this._skin!=K$c){this._skin=K$c,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var K$P=this._skin.replace(".png","$progress.png");K$N.getRes(K$P)&&(this._progress||(this.addChild(this._progress=new K$I),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=K$P),this.setBarPoint(),this.callLater(this.changeValue)}}),K$e(0,K$c,"allowClickBack",function(){return this._allowClickBack},function(K$c){this._allowClickBack!=K$c&&((this._allowClickBack=K$c)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),K$e(0,K$c,"max",function(){return this._max},function(K$c){this._max!=K$c&&(this._max=K$c,this.callLater(this.changeValue))}),K$e(0,K$c,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),K$e(0,K$c,"tick",function(){return this._tick},function(K$c){this._tick!=K$c&&(this._tick=K$c,this.callLater(this.changeValue))}),K$e(0,K$c,"sizeGrid",function(){return this._bg.sizeGrid},function(K$c){this._bg.sizeGrid=K$c,this._bar.sizeGrid=K$c,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),K$e(0,K$c,"min",function(){return this._min},function(K$c){this._min!=K$c&&(this._min=K$c,this.callLater(this.changeValue))}),K$e(0,K$c,"value",function(){return this._value},function(K$c){if(this._value!=K$c){var K$P=this._value;this._value=K$c,this.changeValue(),this._value!=K$P&&this.sendChangeEvent()}}),K$e(0,K$c,"dataSource",K$P.prototype._$get_dataSource,function(K$c){"number"==typeof(this._dataSource=K$c)||"string"==typeof K$c?this.value=Number(K$c):K$W.superSet(K$R,this,"dataSource",K$c)}),K$e(0,K$c,"bar",function(){return this._bar}),K$_(K$q,["label",function(){return this.label=new K$v}]),K$q}(K$R),K$I=function(K$P){function K$q(K$c){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,K$q.__super.call(this),this.skin=K$c}K$b(K$q,"laya.ui.Image",K$P);var K$c=K$q.prototype;return K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,K$N.clearCache(this,this._skin)},K$c.dispose=function(){this.destroy(!0),K$N.clearCache(this,this._skin),this.clearEvent()},K$c.createChildren=function(){this.graphics=this._bitmap=new K$V},K$c.setSource=function(K$c,K$P){K$c===this._skin&&K$P&&(this.source=K$P,this.onCompResize(),this.clearEvent())},K$c.clearEvent=function(){this._skin&&K$E.atalsNotify&&K$E.atalsNotify.off(this._skin,this,this.setSource)},K$c.clearLoad=function(){this._skin&&((this._complete||this._progress)&&K$W.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},K$e(0,K$c,"source",function(){return this._bitmap.source},function(K$c){this._bitmap&&(this._bitmap.source=K$c,this.event("loaded"),this.repaint())}),K$e(0,K$c,"dataSource",K$P.prototype._$get_dataSource,function(K$c){"string"==typeof(this._dataSource=K$c)?this.skin=K$c:K$W.superSet(K$R,this,"dataSource",K$c)}),K$e(0,K$c,"measureHeight",function(){return this._bitmap.height}),K$e(0,K$c,"skin",function(){return this._skin},function(K$c){if(this._skin!=K$c)if(K$N.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=K$c){K$N.keepCache(this,this._skin);var K$P=K$N.getRes(K$c),K$q=K$E.resAtalsObj&&K$E.resAtalsObj[this._skin];K$P?(this.source=K$P,this.onCompResize()):K$q?(K$E.atalsNotify&&K$E.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=K$q.sourceW),0==this.height&&(this.height=K$q.sourceH)):(this._complete=K$x.create(this,this.setSource,[this._skin]),this._progress=null,K$W.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),K$e(0,K$c,"group",function(){return this._group},function(K$c){K$c&&this._skin&&K$N.setGroup(this._skin,K$c),this._group=K$c}),K$e(0,K$c,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(K$c){this._bitmap.sizeGrid=K$J.fillArray(K$A.defaultSizeGrid,K$c,Number)}),K$e(0,K$c,"measureWidth",function(){return this._bitmap.width}),K$e(0,K$c,"width",K$P.prototype._$get_width,function(K$c){K$W.superSet(K$R,this,"width",K$c),this._bitmap.width=0==K$c?1e-7:K$c}),K$e(0,K$c,"height",K$P.prototype._$get_height,function(K$c){K$W.superSet(K$R,this,"height",K$c),this._bitmap.height=0==K$c?1e-7:K$c}),K$q}(K$R),K$v=function(K$P){function K$q(K$c){this._tf=null,K$q.__super.call(this),void 0===K$c&&(K$c=""),K$n.defaultColor=K$A.labelColor,this.text=K$c}K$b(K$q,"laya.ui.Label",K$P);var K$c=K$q.prototype;return K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,K$c),this._tf=null},K$c.createChildren=function(){this.addChild(this._tf=new K$D)},K$c.changeText=function(K$c){this._tf.changeText(K$c)},K$e(0,K$c,"padding",function(){return this._tf.padding.join(",")},function(K$c){this._tf.padding=K$J.fillArray(K$A.labelPadding,K$c,Number)}),K$e(0,K$c,"bold",function(){return this._tf.bold},function(K$c){this._tf.bold=K$c}),K$e(0,K$c,"align",function(){return this._tf.align},function(K$c){this._tf.align=K$c}),K$e(0,K$c,"text",function(){return this._tf.text},function(K$c){this._tf.text!=K$c&&(K$c&&(K$c=K$J.adptString(K$c+"")),this._tf.text=K$c,this.event("change"),this._width&&this._height||this.onCompResize())}),K$e(0,K$c,"italic",function(){return this._tf.italic},function(K$c){this._tf.italic=K$c}),K$e(0,K$c,"wordWrap",function(){return this._tf.wordWrap},function(K$c){this._tf.wordWrap=K$c}),K$e(0,K$c,"font",function(){return this._tf.font},function(K$c){this._tf.font=K$c}),K$e(0,K$c,"dataSource",K$P.prototype._$get_dataSource,function(K$c){"number"==typeof(this._dataSource=K$c)||"string"==typeof K$c?this.text=K$c+"":K$W.superSet(K$R,this,"dataSource",K$c)}),K$e(0,K$c,"color",function(){return this._tf.color},function(K$c){this._tf.color=K$c}),K$e(0,K$c,"valign",function(){return this._tf.valign},function(K$c){this._tf.valign=K$c}),K$e(0,K$c,"leading",function(){return this._tf.leading},function(K$c){this._tf.leading=K$c}),K$e(0,K$c,"fontSize",function(){return this._tf.fontSize},function(K$c){this._tf.fontSize=K$c}),K$e(0,K$c,"bgColor",function(){return this._tf.bgColor},function(K$c){this._tf.bgColor=K$c}),K$e(0,K$c,"borderColor",function(){return this._tf.borderColor},function(K$c){this._tf.borderColor=K$c}),K$e(0,K$c,"stroke",function(){return this._tf.stroke},function(K$c){this._tf.stroke=K$c}),K$e(0,K$c,"strokeColor",function(){return this._tf.strokeColor},function(K$c){this._tf.strokeColor=K$c}),K$e(0,K$c,"textField",function(){return this._tf}),K$e(0,K$c,"measureWidth",function(){return this._tf.width}),K$e(0,K$c,"measureHeight",function(){return this._tf.height}),K$e(0,K$c,"width",function(){return this._width||this._tf.text?K$W.superGet(K$R,this,"width"):0},function(K$c){K$W.superSet(K$R,this,"width",K$c),this._tf.width=K$c}),K$e(0,K$c,"height",function(){return this._height||this._tf.text?K$W.superGet(K$R,this,"height"):0},function(K$c){K$W.superSet(K$R,this,"height",K$c),this._tf.height=K$c}),K$e(0,K$c,"overflow",function(){return this._tf.overflow},function(K$c){this._tf.overflow=K$c}),K$e(0,K$c,"underline",function(){return this._tf.underline},function(K$c){this._tf.underline=K$c}),K$e(0,K$c,"underlineColor",function(){return this._tf.underlineColor},function(K$c){this._tf.underlineColor=K$c}),K$q}(K$R),K$y=function(K$P){function K$q(K$c){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,K$q.__super.call(this),this.skin=K$c}K$b(K$q,"laya.ui.ProgressBar",K$P);var K$c=K$q.prototype;return K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,K$c),this._bg&&this._bg.destroy(K$c),this._bar&&this._bar.destroy(K$c),this._bg=this._bar=null,this.changeHandler=null},K$c.createChildren=function(){this.addChild(this._bg=new K$I),this.addChild(this._bar=new K$I)},K$c.changeValue=function(){if(this.sizeGrid){var K$c=this.sizeGrid.split(","),K$P=Number(K$c[3]),K$q=Number(K$c[1]),K$_=(this.width-K$P-K$q)*this._value;this._bar.width=K$P+K$q+K$_,this._bar.visible=this._bar.width>K$P+K$q}else this._bar.width=this.width*this._value},K$e(0,K$c,"measureHeight",function(){return this._bg.height}),K$e(0,K$c,"skin",function(){return this._skin},function(K$c){this._skin!=K$c&&(this._skin=K$c,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),K$e(0,K$c,"measureWidth",function(){return this._bg.width}),K$e(0,K$c,"height",K$P.prototype._$get_height,function(K$c){K$W.superSet(K$R,this,"height",K$c),this._bg.height=this._height,this._bar.height=this._height}),K$e(0,K$c,"bar",function(){return this._bar}),K$e(0,K$c,"value",function(){return this._value},function(K$c){this._value!=K$c&&(K$c=1<K$c?1:K$c<0?0:K$c,this._value=K$c,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(K$c))}),K$e(0,K$c,"bg",function(){return this._bg}),K$e(0,K$c,"sizeGrid",function(){return this._bg.sizeGrid},function(K$c){this._bg.sizeGrid=this._bar.sizeGrid=K$c}),K$e(0,K$c,"width",K$P.prototype._$get_width,function(K$c){K$W.superSet(K$R,this,"width",K$c),this._bg.width=this._width,this.callLater(this.changeValue)}),K$e(0,K$c,"dataSource",K$P.prototype._$get_dataSource,function(K$c){"number"==typeof(this._dataSource=K$c)||"string"==typeof K$c?this.value=Number(K$c):K$W.superSet(K$R,this,"dataSource",K$c)}),K$q}(K$R),K$M=(function(K$c){function K$q(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,K$q.__super.call(this),this._tipBox=new K$R,this._tipBox.addChild(this._tipText=new K$D),this._tipText.x=this._tipText.y=5,this._tipText.color=K$q.tipTextColor,this._defaultTipHandler=this._showDefaultTip,K$W.stage.on("showtip",this,this._onStageShowTip),K$W.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}K$b(K$q,"laya.ui.TipManager",K$R);var K$P=K$q.prototype;K$P._onStageHideTip=function(K$c){K$W.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},K$P._onStageShowTip=function(K$c){K$W.timer.once(K$q.tipDelay,this,this._showTip,[K$c],!0)},K$P._showTip=function(K$c){if("string"==typeof K$c){var K$P=String(K$c);Boolean(K$P)&&this._defaultTipHandler(K$P)}else K$c instanceof laya.utils.Handler?K$c.run():"function"==typeof K$c&&K$c.apply();K$W.stage.on("mousemove",this,this._onStageMouseMove),K$W.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},K$P._onStageMouseDown=function(K$c){this.closeAll()},K$P._onStageMouseMove=function(K$c){this._showToStage(this,K$q.offsetX,K$q.offsetY)},K$P._showToStage=function(K$c,K$P,K$q){void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0);var K$_=K$c.getBounds();K$c.x=K$W.stage.mouseX+K$P,K$c.y=K$W.stage.mouseY+K$q,K$c.x+K$_.width>K$W.stage.width&&(K$c.x-=K$_.width+K$P),K$c.y+K$_.height>K$W.stage.height&&(K$c.y-=K$_.height+K$q)},K$P.closeAll=function(){K$W.timer.clear(this,this._showTip),K$W.stage.off("mousemove",this,this._onStageMouseMove),K$W.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},K$P.showDislayTip=function(K$c){this.addChild(K$c),this._showToStage(this),K$W._currentStage.addChild(this)},K$P._showDefaultTip=function(K$c){this._tipText.text=K$c;var K$P=this._tipBox.graphics;K$P.clear(),K$P.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,K$q.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),K$W._currentStage.addChild(this)},K$e(0,K$P,"defaultTipHandler",function(){return this._defaultTipHandler},function(K$c){this._defaultTipHandler=K$c}),K$q.offsetX=10,K$q.offsetY=15,K$q.tipTextColor="#ffffff",K$q.tipBackColor="#111111",K$q.tipDelay=200}(),function(K$c){var K$r;function K$g(){this._idMap=null,this._aniList=null,this._watchMap={},K$g.__super.call(this)}K$b(K$g,"laya.ui.View",K$C);var K$P=K$g.prototype;return K$P.createView=function(K$c){if(K$c.animations&&!this._idMap&&(this._idMap={}),K$g.createComp(K$c,this,this),K$c.animations){var K$P,K$q,K$_=[],K$E=K$c.animations,K$b=0,K$e=K$E.length;for(K$b=0;K$b<K$e;K$b++){switch(K$P=new K$k,K$q=K$E[K$b],K$P._setUp(this._idMap,K$q),(this[K$q.name]=K$P)._setControlNode(this),K$q.action){case 1:K$P.play(0,!1);break;case 2:K$P.play(0,!0)}K$_.push(K$P)}this._aniList=K$_}0<this._width&&null==K$c.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},K$P.onEvent=function(K$c,K$P){},K$P.loadUI=function(K$c){var K$P=K$g.uiMap[K$c];K$P&&this.createView(K$P)},K$P.destroy=function(K$c){void 0===K$c&&(K$c=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,K$c)},K$P.changeData=function(K$c){var K$P=this._watchMap[K$c];if(K$P){console.log("change",K$c);for(var K$q=0,K$_=K$P.length;K$q<K$_;K$q++){K$P[K$q].exe(this)}}},K$g._regs=function(){for(var K$c in K$g.uiClassMap)K$w.regClass(K$c,K$g.uiClassMap[K$c])},K$g.createComp=function(K$c,K$P,K$q,K$_){if(!(K$P=K$P||K$g.getCompInstance(K$c)))return console.warn("can not create:"+K$c.type),null;var K$E=K$c.child;if(K$E)for(var K$b=K$P instanceof laya.ui.List,K$e=0,K$h=K$E.length;K$e<K$h;K$e++){var K$Z=K$E[K$e];if(!K$P.hasOwnProperty("itemRender")||"render"!=K$Z.props.name&&"render"!==K$Z.props.renderType)if("Graphic"==K$Z.type)K$w.addGraphicsToSprite(K$Z,K$P);else if(K$w.isDrawType(K$Z.type))K$w.addGraphicToSprite(K$Z,K$P,!0);else{if(K$b){var K$S=[],K$n=K$g.createComp(K$Z,null,K$q,K$S);K$S.length&&(K$n._$bindData=K$S)}else K$n=K$g.createComp(K$Z,null,K$q,K$_);"Script"==K$Z.type?"owner"in K$n?K$n.owner=K$P:"target"in K$n&&(K$n.target=K$P):"mask"==K$Z.props.renderType||"mask"==K$Z.props.name?K$P.mask=K$n:K$n instanceof laya.display.Sprite&&K$P.addChild(K$n)}else K$P.itemRender=K$Z}var K$k=K$c.props;for(var K$x in K$k){var K$r=K$k[K$x];K$g.eventDic[K$x]?K$r&&K$q&&K$P.on(K$x,K$q,K$q.onEvent,[K$r]):K$g.setCompValue(K$P,K$x,K$r,K$q,K$_)}return K$W.__typeof(K$P,"laya.ui.IItem")&&K$P.initItems(),K$c.compId&&K$q&&K$q._idMap&&(K$q._idMap[K$c.compId]=K$P),K$P},K$g.setCompValue=function(K$c,K$P,K$q,K$_,K$E){if("string"==typeof K$q&&-1<K$q.indexOf("${")){if(K$g._sheet||(K$g._sheet=K$w.getClass("laya.data.Table")),!K$g._sheet)return void console.warn("Can not find class Sheet");if(K$E)K$E.push(K$c,K$P,K$q);else if(K$_){-1==K$q.indexOf("].")&&(K$q=K$q.replace(".","[0]."));var K$b,K$e,K$h=new K$r(K$c,K$P,K$q);K$h.exe(K$_);for(var K$Z=K$q.replace(/\[.*?\]\./g,".");null!=(K$b=K$g._parseWatchData.exec(K$Z));){for(var K$S=K$b[1];null!=(K$e=K$g._parseKeyWord.exec(K$S));){var K$n=K$e[0],K$k=K$_._watchMap[K$n]||(K$_._watchMap[K$n]=[]);K$k.push(K$h),K$g._sheet.I.notifer.on(K$n,K$_,K$_.changeData,[K$n])}(K$k=K$_._watchMap[K$S]||(K$_._watchMap[K$S]=[])).push(K$h),K$g._sheet.I.notifer.on(K$S,K$_,K$_.changeData,[K$S])}}}else if("var"===K$P&&K$_)K$_[K$q]=K$c;else if("onClick"==K$P){var K$x=K$W._runScript("(function(){"+K$q+"})");K$c.on("click",K$_,K$x)}else K$c[K$P]="true"===K$q||"false"!==K$q&&K$q},K$g.getCompInstance=function(K$c){var K$P,K$q=K$c.props?K$c.props.runtime:null;return K$P=K$q?K$g.viewClassMap[K$q]||K$g.uiClassMap[K$q]||K$W.__classmap[K$q]:K$g.uiClassMap[K$c.type],K$c.props&&K$c.props.hasOwnProperty("renderType")&&"instance"==K$c.props.renderType?K$P.instance:K$P?new K$P:null},K$g.regComponent=function(K$c,K$P){K$g.uiClassMap[K$c]=K$P,K$w.regClass(K$c,K$P)},K$g.regViewRuntime=function(K$c,K$P){K$g.viewClassMap[K$c]=K$P},K$g.uiMap={},K$g.viewClassMap={},K$g._sheet=null,K$_(K$g,["uiClassMap",function(){return this.uiClassMap={ViewStack:K$cc,LinkButton:K$F,TextArea:K$Sc,ColorPicker:K$a,Box:K$C,Button:K$F,CheckBox:K$z,Clip:K$o,ComboBox:K$Y,Component:K$R,HScrollBar:K$t,HSlider:K$p,Image:K$I,Label:K$v,List:K$l,Panel:K$B,ProgressBar:K$y,Radio:K$K,RadioGroup:K$hc,ScrollBar:K$s,Slider:K$U,Tab:K$Zc,TextInput:K$qc,View:K$g,VScrollBar:K$Pc,VSlider:K$_c,Tree:K$G,HBox:K$bc,VBox:K$ec,Sprite:K$T,Animation:K$q,Text:K$D,FontClip:K$f}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),K$g.__init$=function(){K$g._regs(),K$r=function(){function K$c(K$c,K$P,K$q){this.comp=null,this.prop=null,this.value=null,this.comp=K$c,this.prop=K$P,this.value=K$q}return K$b(K$c,""),K$c.prototype.exe=function(K$c){var K$P=K$J.getBindFun(this.value);this.comp[this.prop]=K$P.call(this,K$c)},K$c}()},K$g}()),K$z=function(K$c){function K$q(K$c,K$P){void 0===K$P&&(K$P=""),K$q.__super.call(this,K$c,K$P)}K$b(K$q,"laya.ui.CheckBox",K$c);var K$P=K$q.prototype;return K$P.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},K$P.initialize=function(){K$c.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},K$e(0,K$P,"dataSource",K$c.prototype._$get_dataSource,function(K$c){"boolean"==typeof(this._dataSource=K$c)?this.selected=K$c:"string"==typeof K$c?this.selected="true"===K$c:K$W.superSet(K$F,this,"dataSource",K$c)}),K$q}(K$F),K$X=function(K$c){function K$P(){this._space=0,this._align="none",this._itemChanged=!1,K$P.__super.call(this)}K$b(K$P,"laya.ui.LayoutBox",K$C);var K$q=K$P.prototype;return K$q.addChild=function(K$c){return K$c.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,K$c)},K$q.onResize=function(K$c){this._setItemChanged()},K$q.addChildAt=function(K$c,K$P){return K$c.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,K$c,K$P)},K$q.removeChild=function(K$c){return K$c.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,K$c)},K$q.removeChildAt=function(K$c){return this.getChildAt(K$c).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,K$c)},K$q.refresh=function(){this._setItemChanged()},K$q.changeItems=function(){this._itemChanged=!1},K$q.sortItem=function(K$c){K$c&&K$c.sort(function(K$c,K$P){return K$c.y-K$P.y})},K$q._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},K$e(0,K$q,"space",function(){return this._space},function(K$c){this._space=K$c,this._setItemChanged()}),K$e(0,K$q,"align",function(){return this._align},function(K$c){this._align=K$c,this._setItemChanged()}),K$P}(),K$f=function(K$P){function K$q(K$c,K$P){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,K$q.__super.call(this),K$c&&(this.skin=K$c),K$P&&(this.sheet=K$P)}K$b(K$q,"laya.ui.FontClip",K$P);var K$c=K$q.prototype;return K$c.createChildren=function(){this._bitmap=new K$V,this.on("loaded",this,this._onClipLoaded)},K$c._onClipLoaded=function(){this.callLater(this.changeValue)},K$c.changeValue=function(){var K$c;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),K$c=this._sources[0]))){var K$P="horizontal"===this._direction;K$P?(this._wordsW=this._valueArr.length*(K$c.sourceWidth+this.spaceX),this._wordsH=K$c.sourceHeight):(this._wordsW=K$c.sourceWidth,this._wordsH=(K$c.sourceHeight+this.spaceY)*this._valueArr.length);var K$q=0;if(this._width)switch(this._align){case"center":K$q=.5*(this._width-this._wordsW);break;case"right":K$q=this._width-this._wordsW;break;default:K$q=0}for(var K$_=0,K$E=this._valueArr.length;K$_<K$E;K$_++){var K$b=this._indexMap[this._valueArr.charAt(K$_)];this.sources[K$b]&&(K$c=this.sources[K$b],K$P?this.graphics.drawTexture(K$c,K$q+K$_*(K$c.sourceWidth+this.spaceX),0,K$c.sourceWidth,K$c.sourceHeight):this.graphics.drawTexture(K$c,0+K$q,K$_*(K$c.sourceHeight+this.spaceY),K$c.sourceWidth,K$c.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),K$P.prototype.destroy.call(this,K$c)},K$e(0,K$c,"sheet",function(){return this._sheet},function(K$c){K$c+="";var K$P=(this._sheet=K$c).split(" ");this._clipX=String(K$P[0]).length,this.clipY=K$P.length,this._indexMap={};for(var K$q=0;K$q<this._clipY;K$q++)for(var K$_=K$P[K$q].split(""),K$E=0,K$b=K$_.length;K$E<K$b;K$E++)this._indexMap[K$_[K$E]]=K$q*this._clipX+K$E}),K$e(0,K$c,"height",K$P.prototype._$get_height,function(K$c){K$W.superSet(K$o,this,"height",K$c),this.callLater(this.changeValue)}),K$e(0,K$c,"direction",function(){return this._direction},function(K$c){this._direction=K$c,this.callLater(this.changeValue)}),K$e(0,K$c,"value",function(){return this._valueArr?this._valueArr:""},function(K$c){K$c+="",this._valueArr=K$c,this.callLater(this.changeValue)}),K$e(0,K$c,"width",K$P.prototype._$get_width,function(K$c){K$W.superSet(K$o,this,"width",K$c),this.callLater(this.changeValue)}),K$e(0,K$c,"spaceX",function(){return this._spaceX},function(K$c){this._spaceX=K$c,"horizontal"===this._direction&&this.callLater(this.changeValue)}),K$e(0,K$c,"spaceY",function(){return this._spaceY},function(K$c){this._spaceY=K$c,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),K$e(0,K$c,"align",function(){return this._align},function(K$c){this._align=K$c,this.callLater(this.changeValue)}),K$e(0,K$c,"measureWidth",function(){return this._wordsW}),K$e(0,K$c,"measureHeight",function(){return this._wordsH}),K$q}(K$o),K$l=function(K$c){function K$P(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new K$g,K$P.__super.call(this)}K$b(K$P,"laya.ui.List",K$c);var K$q=K$P.prototype;return K$W.imps(K$q,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),K$q.destroy=function(K$c){void 0===K$c&&(K$c=!0),this._content&&this._content.destroy(K$c),this._scrollBar&&this._scrollBar.destroy(K$c),laya.ui.Component.prototype.destroy.call(this,K$c),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},K$q.createChildren=function(){this.addChild(this._content=new K$C)},K$q.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=K$W.superGet(K$C,this,"cacheAs")),K$W.superSet(K$C,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},K$q.onScrollEnd=function(){K$W.superSet(K$C,this,"cacheAs",this._$P.cacheAs)},K$q._removePreScrollBar=function(){var K$c=this.removeChildByName("scrollBar");K$c&&K$c.destroy(!0)},K$q.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var K$c=this._getOneCell(),K$P=K$c.width+this._spaceX||1,K$q=K$c.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/K$P):Math.ceil(this._width/K$P)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/K$q):Math.round(this._height/K$q));var K$_=this._width?this._width:K$P*this.repeatX-this._spaceX,K$E=this._height?this._height:K$q*this.repeatY-this._spaceY;this._cellSize=this._isVertical?K$q:K$P,this._cellOffset=this._isVertical?K$q*Math.max(this._repeatY2,this._repeatY)-K$E-this._spaceY:K$P*Math.max(this._repeatX2,this._repeatX)-K$_-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=K$E:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=K$_),this.setContentSize(K$_,K$E);var K$b=this._isVertical?this.repeatX:this.repeatY,K$e=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,K$b,K$e),this._createdLine=K$e,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},K$q._getOneCell=function(){if(0===this._cells.length){var K$c=this.createItem();if(this._offset.setTo(K$c.x,K$c.y),this.cacheContent)return K$c;this._cells.push(K$c)}return this._cells[0]},K$q._createItems=function(K$c,K$P,K$q){var K$_=this._content,K$E=this._getOneCell(),K$b=K$E.width+this._spaceX,K$e=K$E.height+this._spaceY;if(this.cacheContent){var K$h=new K$C;K$h.cacheAsBitmap=!0,K$h.pos((this._isVertical?0:K$c)*K$b,(this._isVertical?K$c:0)*K$e),this._content.addChild(K$h),this._content.optimizeScrollRect=!0,K$_=K$h}else{for(var K$Z=[],K$S=this._cells.length-1;-1<K$S;K$S--){var K$n=this._cells[K$S];K$n.removeSelf(),K$Z.push(K$n)}this._cells.length=0}for(var K$k=K$c;K$k<K$q;K$k++)for(var K$x=0;K$x<K$P;K$x++)(K$E=K$Z&&K$Z.length?K$Z.pop():this.createItem()).x=(this._isVertical?K$x:K$k)*K$b-K$_.x,K$E.y=(this._isVertical?K$k:K$x)*K$e-K$_.y,K$E.name="item"+(K$k*K$P+K$x),K$_.addChild(K$E),this.addCell(K$E)},K$q.createItem=function(){var K$c=[];if("function"==typeof this._itemRender)var K$P=new this._itemRender;else K$P=K$M.createComp(this._itemRender,null,null,K$c);if(0==K$c.length&&K$P._watchMap){var K$q=K$P._watchMap;for(var K$_ in K$q)for(var K$E=K$q[K$_],K$b=0;K$b<K$E.length;K$b++){var K$e=K$E[K$b];K$c.push(K$e.comp,K$e.prop,K$e.value)}}return K$c.length&&(K$P._$bindData=K$c),K$P},K$q.addCell=function(K$c){K$c.on("click",this,this.onCellMouse),K$c.on("rightclick",this,this.onCellMouse),K$c.on("mouseover",this,this.onCellMouse),K$c.on("mouseout",this,this.onCellMouse),K$c.on("mousedown",this,this.onCellMouse),K$c.on("mouseup",this,this.onCellMouse),this._cells.push(K$c)},K$q.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var K$c=0,K$P=K$c=0;K$P<1e4;K$P++){var K$q=this.getChildByName("item"+K$P);if(!K$q)break;this.addCell(K$q),K$c++}this.repeatY=K$c}},K$q.setContentSize=function(K$c,K$P){this._content.width=K$c,this._content.height=K$P,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new K$O),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,K$c,K$P),this._content.scrollRect=this._content.scrollRect),this.event("resize")},K$q.onCellMouse=function(K$c){"mousedown"===K$c.type&&(this._isMoved=!1);var K$P=K$c.currentTarget,K$q=this._startIndex+this._cells.indexOf(K$P);K$q<0||("click"===K$c.type||"rightclick"===K$c.type?this.selectEnable&&!this._isMoved?this.selectedIndex=K$q:this.changeCellState(K$P,!0,0):"mouseover"!==K$c.type&&"mouseout"!==K$c.type||this._selectedIndex===K$q||this.changeCellState(K$P,"mouseover"===K$c.type,0),this.mouseHandler&&this.mouseHandler.runWith([K$c,K$q]))},K$q.changeCellState=function(K$c,K$P,K$q){var K$_=K$c.getChildByName("selectBox");K$_&&(this.selectEnable=!0,K$_.visible=K$P,K$_.index=K$q)},K$q.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},K$q.onScrollBarChange=function(K$c){this.runCallLater(this.changeCells);var K$P=this._scrollBar.value,K$q=this._isVertical?this.repeatX:this.repeatY,K$_=this._isVertical?this.repeatY:this.repeatX,K$E=Math.floor(K$P/this._cellSize);if(this.cacheContent)K$e=K$_+1,this._createdLine-K$E<K$e&&(this._createItems(this._createdLine,K$q,this._createdLine+K$e),this.renderItems(this._createdLine*K$q,0),this._createdLine+=K$e);else{var K$b=K$E*K$q,K$e=0;if(K$b>this._startIndex){K$e=K$b-this._startIndex;var K$h=!0,K$Z=this._startIndex+K$q*(K$_+1);this._isMoved=!0}else K$b<this._startIndex&&(K$e=this._startIndex-K$b,K$h=!1,K$Z=this._startIndex-1,this._isMoved=!0);for(var K$S=0;K$S<K$e;K$S++){if(K$h){var K$n=this._cells.shift();this._cells[this._cells.length]=K$n;var K$k=K$Z+K$S}else K$n=this._cells.pop(),this._cells.unshift(K$n),K$k=K$Z-K$S;var K$x=Math.floor(K$k/K$q)*this._cellSize;this._isVertical?K$n.y=K$x:K$n.x=K$x,this.renderItem(K$n,K$k)}this._startIndex=K$b,this.changeSelectStatus()}var K$r=this._content.scrollRect;this._isVertical?(K$r.y=K$P-this._offset.y,K$r.x=-this._offset.x):(K$r.y=-this._offset.y,K$r.x=K$P-this._offset.x),this._content.scrollRect=K$r},K$q.posCell=function(K$c,K$P){if(this._scrollBar){var K$q=this._isVertical?this.repeatX:this.repeatY,K$_=(this._isVertical?this.repeatY:this.repeatX,Math.floor(K$P/K$q)*this._cellSize);this._isVertical?K$c.y=K$_:K$c.x=K$_}},K$q.changeSelectStatus=function(){for(var K$c=0,K$P=this._cells.length;K$c<K$P;K$c++)this.changeCellState(this._cells[K$c],this._selectedIndex===this._startIndex+K$c,1)},K$q.renderItems=function(K$c,K$P){void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0);for(var K$q=K$c,K$_=K$P||this._cells.length;K$q<K$_;K$q++)this.renderItem(this._cells[K$q],this._startIndex+K$q);this.changeSelectStatus()},K$q.renderItem=function(K$c,K$P){this._array&&0<=K$P&&K$P<this._array.length?(K$c.visible=!0,K$c._$bindData?(K$c._dataSource=this._array[K$P],this._bindData(K$c,this._array[K$P])):K$c.dataSource=this._array[K$P],this.cacheContent||this.posCell(K$c,K$P),this.hasListener("render")&&this.event("render",[K$c,K$P]),this.renderHandler&&this.renderHandler.runWith([K$c,K$P])):(K$c.visible=!1,K$c.dataSource=null)},K$q._bindData=function(K$c,K$P){for(var K$q=K$c._$bindData,K$_=0,K$E=K$q.length;K$_<K$E;K$_++){var K$b=K$q[K$_++],K$e=K$q[K$_++],K$h=K$q[K$_],K$Z=K$J.getBindFun(K$h);K$b[K$e]=K$Z.call(this,K$P)}},K$q.refresh=function(){this.array=this._array},K$q.getItem=function(K$c){return-1<K$c&&K$c<this._array.length?this._array[K$c]:null},K$q.changeItem=function(K$c,K$P){-1<K$c&&K$c<this._array.length&&(this._array[K$c]=K$P,K$c>=this._startIndex&&K$c<this._startIndex+this._cells.length&&this.renderItem(this.getCell(K$c),K$c))},K$q.setItem=function(K$c,K$P){this.changeItem(K$c,K$P)},K$q.addItem=function(K$c){this._array.push(K$c),this.array=this._array},K$q.addItemAt=function(K$c,K$P){this._array.splice(K$P,0,K$c),this.array=this._array},K$q.deleteItem=function(K$c){this._array.splice(K$c,1),this.array=this._array},K$q.getCell=function(K$c){return this.runCallLater(this.changeCells),-1<K$c&&this._cells?this._cells[(K$c-this._startIndex)%this._cells.length]:null},K$q.scrollTo=function(K$c){if(this._scrollBar){var K$P=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(K$c/K$P)*this._cellSize}else this.startIndex=K$c},K$q.tweenTo=function(K$c,K$P,K$q){if(void 0===K$P&&(K$P=200),this._scrollBar){var K$_=this._isVertical?this.repeatX:this.repeatY;K$H.to(this._scrollBar,{value:Math.floor(K$c/K$_)*this._cellSize},K$P,null,K$q,0,!0)}else this.startIndex=K$c,K$q&&K$q.run()},K$q._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},K$q.commitMeasure=function(){this.runCallLater(this.changeCells)},K$e(0,K$q,"cacheAs",K$c.prototype._$get_cacheAs,function(K$c){K$W.superSet(K$C,this,"cacheAs",K$c),this._scrollBar&&(this._$P.cacheAs=null,"none"!==K$c?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),K$e(0,K$q,"content",function(){return this._content}),K$e(0,K$q,"height",K$c.prototype._$get_height,function(K$c){K$c!=this._height&&(K$W.superSet(K$C,this,"height",K$c),this._setCellChanged())}),K$e(0,K$q,"itemRender",function(){return this._itemRender},function(K$c){if(this._itemRender!=K$c){this._itemRender=K$c;for(var K$P=this._cells.length-1;-1<K$P;K$P--)this._cells[K$P].destroy();this._cells.length=0,this._setCellChanged()}}),K$e(0,K$q,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(K$c){this._removePreScrollBar();var K$P=new K$Pc;K$P.name="scrollBar",K$P.right=0,K$c&&" "!=K$c&&(K$P.skin=K$c),this.scrollBar=K$P,this.addChild(K$P),this._setCellChanged()}),K$e(0,K$q,"page",function(){return this._page},function(K$c){this._page=K$c,this._array&&(this._page=0<K$c?K$c:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),K$e(0,K$q,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(K$c){this._removePreScrollBar();var K$P=new K$t;K$P.name="scrollBar",K$P.bottom=0,K$c&&" "!=K$c&&(K$P.skin=K$c),this.scrollBar=K$P,this.addChild(K$P),this._setCellChanged()}),K$e(0,K$q,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(K$c){this._repeatX=K$c,this._setCellChanged()}),K$e(0,K$q,"scrollBar",function(){return this._scrollBar},function(K$c){this._scrollBar!=K$c&&(this._scrollBar=K$c)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),K$e(0,K$q,"width",K$c.prototype._$get_width,function(K$c){K$c!=this._width&&(K$W.superSet(K$C,this,"width",K$c),this._setCellChanged())}),K$e(0,K$q,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(K$c){this._repeatY=K$c,this._setCellChanged()}),K$e(0,K$q,"spaceX",function(){return this._spaceX},function(K$c){this._spaceX=K$c,this._setCellChanged()}),K$e(0,K$q,"spaceY",function(){return this._spaceY},function(K$c){this._spaceY=K$c,this._setCellChanged()}),K$e(0,K$q,"selectedIndex",function(){return this._selectedIndex},function(K$c){this._selectedIndex!=K$c&&(this._selectedIndex=K$c,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(K$c),this.startIndex=this._startIndex)}),K$e(0,K$q,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(K$c){this.selectedIndex=this._array.indexOf(K$c)}),K$e(0,K$q,"length",function(){return this._array?this._array.length:0}),K$e(0,K$q,"selection",function(){return this.getCell(this._selectedIndex)},function(K$c){this.selectedIndex=this._startIndex+this._cells.indexOf(K$c)}),K$e(0,K$q,"startIndex",function(){return this._startIndex},function(K$c){this._startIndex=0<K$c?K$c:0,this.callLater(this.renderItems)}),K$e(0,K$q,"array",function(){return this._array},function(K$c){this.runCallLater(this.changeCells),this._array=K$c||[];var K$P=this._array.length;if(this.totalPage=Math.ceil(K$P/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<K$P?this._selectedIndex:K$P-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var K$q=this._isVertical?this.repeatX:this.repeatY,K$_=this._isVertical?this.repeatY:this.repeatX,K$E=Math.ceil(K$P/K$q);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=K$_/K$E,this._scrollBar.setScroll(0,(K$E-K$_)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),K$e(0,K$q,"dataSource",K$c.prototype._$get_dataSource,function(K$c){"number"==typeof(this._dataSource=K$c)&&Math.floor(K$c)==K$c||"string"==typeof K$c?this.selectedIndex=parseInt(K$c):K$c instanceof Array?this.array=K$c:K$W.superSet(K$C,this,"dataSource",K$c)}),K$e(0,K$q,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),K$P}(K$C),K$t=function(K$c){function K$P(){K$P.__super.call(this)}return K$b(K$P,"laya.ui.HScrollBar",K$c),K$P.prototype.initialize=function(){K$c.prototype.initialize.call(this),this.slider.isVertical=!1},K$P}(K$s),K$B=function(K$c){function K$P(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,K$P.__super.call(this),this.width=this.height=100}K$b(K$P,"laya.ui.Panel",K$c);var K$q=K$P.prototype;return K$q.destroy=function(K$c){void 0===K$c&&(K$c=!0),laya.ui.Component.prototype.destroy.call(this,K$c),this._content&&this._content.destroy(K$c),this._vScrollBar&&this._vScrollBar.destroy(K$c),this._hScrollBar&&this._hScrollBar.destroy(K$c),this._vScrollBar=null,this._hScrollBar=null,this._content=null},K$q.destroyChildren=function(){this._content.destroyChildren()},K$q.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new K$C)},K$q.addChild=function(K$c){return K$c.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(K$c)},K$q.onResize=function(){this._setScrollChanged()},K$q.addChildAt=function(K$c,K$P){return K$c.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(K$c,K$P)},K$q.removeChild=function(K$c){return K$c.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(K$c)},K$q.removeChildAt=function(K$c){return this.getChildAt(K$c).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(K$c)},K$q.removeChildren=function(K$c,K$P){return void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=2147483647),this._content.removeChildren(K$c,K$P),this._setScrollChanged(),this},K$q.getChildAt=function(K$c){return this._content.getChildAt(K$c)},K$q.getChildByName=function(K$c){return this._content.getChildByName(K$c)},K$q.getChildIndex=function(K$c){return this._content.getChildIndex(K$c)},K$q.changeScroll=function(){this._scrollChanged=!1;var K$c=this.contentWidth||1,K$P=this.contentHeight||1,K$q=this._vScrollBar,K$_=this._hScrollBar,K$E=K$q&&K$P>this._height,K$b=K$_&&K$c>this._width,K$e=K$E?this._width-K$q.width:this._width,K$h=K$b?this._height-K$_.height:this._height;K$q&&(K$q.x=this._width-K$q.width,K$q.y=0,K$q.height=this._height-(K$b?K$_.height:0),K$q.scrollSize=Math.max(.033*this._height,1),K$q.thumbPercent=K$h/K$P,K$q.setScroll(0,K$P-K$h,K$q.value)),K$_&&(K$_.x=0,K$_.y=this._height-K$_.height,K$_.width=this._width-(K$E?K$q.width:0),K$_.scrollSize=Math.max(.033*this._width,1),K$_.thumbPercent=K$e/K$c,K$_.setScroll(0,K$c-K$e,K$_.value))},K$q.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},K$q.setContentSize=function(K$c,K$P){var K$q=this._content;K$q.width=K$c,K$q.height=K$P,K$q.scrollRect||(K$q.scrollRect=new K$O),K$q.scrollRect.setTo(0,0,K$c,K$P),K$q.scrollRect=K$q.scrollRect},K$q.onScrollBarChange=function(K$c){var K$P=this._content.scrollRect;if(K$P){var K$q=Math.round(K$c.value);K$c.isVertical?K$P.y=K$q:K$P.x=K$q,this._content.scrollRect=K$P}},K$q.scrollTo=function(K$c,K$P){void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),this.vScrollBar&&(this.vScrollBar.value=K$P),this.hScrollBar&&(this.hScrollBar.value=K$c)},K$q.refresh=function(){this.changeScroll()},K$q.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=K$W.superGet(K$C,this,"cacheAs")),K$W.superSet(K$C,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},K$q.onScrollEnd=function(){K$W.superSet(K$C,this,"cacheAs",this._$P.cacheAs)},K$q._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},K$e(0,K$q,"numChildren",function(){return this._content.numChildren}),K$e(0,K$q,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(K$c){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new K$t),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=K$c}),K$e(0,K$q,"contentWidth",function(){for(var K$c=0,K$P=this._content.numChildren-1;-1<K$P;K$P--){var K$q=this._content.getChildAt(K$P);K$c=Math.max(K$q.x+K$q.width*K$q.scaleX,K$c)}return K$c}),K$e(0,K$q,"contentHeight",function(){for(var K$c=0,K$P=this._content.numChildren-1;-1<K$P;K$P--){var K$q=this._content.getChildAt(K$P);K$c=Math.max(K$q.y+K$q.height*K$q.scaleY,K$c)}return K$c}),K$e(0,K$q,"width",K$c.prototype._$get_width,function(K$c){K$W.superSet(K$C,this,"width",K$c),this._setScrollChanged()}),K$e(0,K$q,"hScrollBar",function(){return this._hScrollBar}),K$e(0,K$q,"content",function(){return this._content}),K$e(0,K$q,"height",K$c.prototype._$get_height,function(K$c){K$W.superSet(K$C,this,"height",K$c),this._setScrollChanged()}),K$e(0,K$q,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(K$c){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new K$Pc),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=K$c}),K$e(0,K$q,"vScrollBar",function(){return this._vScrollBar}),K$e(0,K$q,"cacheAs",K$c.prototype._$get_cacheAs,function(K$c){K$W.superSet(K$C,this,"cacheAs",K$c),this._$P.cacheAs=null,"none"!==K$c?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),K$P}(K$C),K$p=function(K$c){function K$P(K$c){K$P.__super.call(this,K$c),this.isVertical=!1}return K$b(K$P,"laya.ui.HSlider",K$U),K$P}(),K$i=function(K$c){function K$q(K$c,K$P){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,K$q.__super.call(this),this.skin=K$P,this.labels=K$c}K$b(K$q,"laya.ui.UIGroup",K$c);var K$P=K$q.prototype;return K$W.imps(K$P,{"laya.ui.IItem":!0}),K$P.preinitialize=function(){this.mouseEnabled=!0},K$P.destroy=function(K$c){void 0===K$c&&(K$c=!0),laya.ui.Component.prototype.destroy.call(this,K$c),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},K$P.addItem=function(K$c,K$P){void 0===K$P&&(K$P=!0);var K$q=K$c,K$_=this._items.length;if(K$q.name="item"+K$_,this.addChild(K$q),this.initItems(),K$P&&0<K$_){var K$E=this._items[K$_-1];"horizontal"==this._direction?K$q.x=K$E.x+K$E.width+this._space:K$q.y=K$E.y+K$E.height+this._space}else K$P&&(K$q.x=0,K$q.y=0);return K$_},K$P.delItem=function(K$c,K$P){void 0===K$P&&(K$P=!0);var K$q=this._items.indexOf(K$c);if(-1!=K$q){var K$_=K$c;this.removeChild(K$_);for(var K$E=K$q+1,K$b=this._items.length;K$E<K$b;K$E++){var K$e=this._items[K$E];K$e.name="item"+(K$E-1),K$P&&("horizontal"==this._direction?K$e.x-=K$_.width+this._space:K$e.y-=K$_.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var K$h;K$h=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=K$h}}},K$P.initItems=function(){this._items||(this._items=[]);for(var K$c=this._items.length=0;K$c<1e4;K$c++){var K$P=this.getChildByName("item"+K$c);if(null==K$P)break;this._items.push(K$P),K$P.selected=K$c===this._selectedIndex,K$P.clickHandler=K$x.create(this,this.itemClick,[K$c],!1)}},K$P.itemClick=function(K$c){this.selectedIndex=K$c},K$P.setSelect=function(K$c,K$P){this._items&&-1<K$c&&K$c<this._items.length&&(this._items[K$c].selected=K$P)},K$P.createItem=function(K$c,K$P){return null},K$P.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var K$c=0,K$P=0,K$q=this._items.length;K$P<K$q;K$P++){var K$_=this._items[K$P];this._skin&&(K$_.skin=this._skin),this._labelColors&&(K$_.labelColors=this._labelColors),this._labelSize&&(K$_.labelSize=this._labelSize),this._labelStroke&&(K$_.labelStroke=this._labelStroke),this._labelStrokeColor&&(K$_.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(K$_.strokeColors=this._strokeColors),this._labelBold&&(K$_.labelBold=this._labelBold),this._labelPadding&&(K$_.labelPadding=this._labelPadding),this._labelAlign&&(K$_.labelAlign=this._labelAlign),this._stateNum&&(K$_.stateNum=this._stateNum),this._labelFont&&(K$_.labelFont=this._labelFont),"horizontal"===this._direction?(K$_.y=0,K$_.x=K$c,K$c+=K$_.width+this._space):(K$_.x=0,K$_.y=K$c,K$c+=K$_.height+this._space)}this.changeSize()},K$P.commitMeasure=function(){this.runCallLater(this.changeLabels)},K$P._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},K$e(0,K$P,"labelStrokeColor",function(){return this._labelStrokeColor},function(K$c){this._labelStrokeColor!=K$c&&(this._labelStrokeColor=K$c,this._setLabelChanged())}),K$e(0,K$P,"skin",function(){return this._skin},function(K$c){this._skin!=K$c&&(this._skin=K$c,this._setLabelChanged())}),K$e(0,K$P,"selectedIndex",function(){return this._selectedIndex},function(K$c){this._selectedIndex!=K$c&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=K$c,this.setSelect(K$c,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),K$e(0,K$P,"labels",function(){return this._labels},function(K$c){if(this._labels!=K$c){if(this._labels=K$c,this.removeChildren(),this._setLabelChanged(),this._labels)for(var K$P=this._labels.split(","),K$q=0,K$_=K$P.length;K$q<K$_;K$q++){var K$E=this.createItem(this._skin,K$P[K$q]);K$E.name="item"+K$q,this.addChild(K$E)}this.initItems()}}),K$e(0,K$P,"strokeColors",function(){return this._strokeColors},function(K$c){this._strokeColors!=K$c&&(this._strokeColors=K$c,this._setLabelChanged())}),K$e(0,K$P,"labelColors",function(){return this._labelColors},function(K$c){this._labelColors!=K$c&&(this._labelColors=K$c,this._setLabelChanged())}),K$e(0,K$P,"labelStroke",function(){return this._labelStroke},function(K$c){this._labelStroke!=K$c&&(this._labelStroke=K$c,this._setLabelChanged())}),K$e(0,K$P,"labelSize",function(){return this._labelSize},function(K$c){this._labelSize!=K$c&&(this._labelSize=K$c,this._setLabelChanged())}),K$e(0,K$P,"stateNum",function(){return this._stateNum},function(K$c){this._stateNum!=K$c&&(this._stateNum=K$c,this._setLabelChanged())}),K$e(0,K$P,"labelBold",function(){return this._labelBold},function(K$c){this._labelBold!=K$c&&(this._labelBold=K$c,this._setLabelChanged())}),K$e(0,K$P,"labelFont",function(){return this._labelFont},function(K$c){this._labelFont!=K$c&&(this._labelFont=K$c,this._setLabelChanged())}),K$e(0,K$P,"labelPadding",function(){return this._labelPadding},function(K$c){this._labelPadding!=K$c&&(this._labelPadding=K$c,this._setLabelChanged())}),K$e(0,K$P,"direction",function(){return this._direction},function(K$c){this._direction=K$c,this._setLabelChanged()}),K$e(0,K$P,"space",function(){return this._space},function(K$c){this._space=K$c,this._setLabelChanged()}),K$e(0,K$P,"items",function(){return this._items}),K$e(0,K$P,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(K$c){this.selectedIndex=this._items.indexOf(K$c)}),K$e(0,K$P,"dataSource",K$c.prototype._$get_dataSource,function(K$c){"number"==typeof(this._dataSource=K$c)&&Math.floor(K$c)==K$c||"string"==typeof K$c?this.selectedIndex=parseInt(K$c):K$c instanceof Array?this.labels=K$c.join(","):K$W.superSet(K$C,this,"dataSource",K$c)}),K$q}(K$C),K$K=function(K$P){function K$q(K$c,K$P){this._value=null,void 0===K$P&&(K$P=""),K$q.__super.call(this,K$c,K$P)}K$b(K$q,"laya.ui.Radio",K$P);var K$c=K$q.prototype;return K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,K$c),this._value=null},K$c.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},K$c.initialize=function(){K$P.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},K$c.onClick=function(K$c){this.selected=!0},K$e(0,K$c,"value",function(){return null!=this._value?this._value:this.label},function(K$c){this._value=K$c}),K$q}(K$F),K$G=function(K$c){function K$P(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,K$P.__super.call(this),this.width=this.height=200}K$b(K$P,"laya.ui.Tree",K$c);var K$q=K$P.prototype;return K$W.imps(K$q,{"laya.ui.IRender":!0}),K$q.destroy=function(K$c){void 0===K$c&&(K$c=!0),laya.ui.Component.prototype.destroy.call(this,K$c),this._list&&this._list.destroy(K$c),this._list=null,this._source=null,this._renderHandler=null},K$q.createChildren=function(){this.addChild(this._list=new K$l),this._list.renderHandler=K$x.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},K$q.onListChange=function(K$c){this.event("change")},K$q.getArray=function(){var K$c,K$P=[];for(var K$q in this._source)K$c=this._source[K$q],this.getParentOpenStatus(K$c)&&(K$c.x=this._spaceLeft*this.getDepth(K$c),K$P.push(K$c));return K$P},K$q.getDepth=function(K$c,K$P){return void 0===K$P&&(K$P=0),null==K$c.nodeParent?K$P:this.getDepth(K$c.nodeParent,K$P+1)},K$q.getParentOpenStatus=function(K$c){var K$P=K$c.nodeParent;return null==K$P||!!K$P.isOpen&&(null==K$P.nodeParent||this.getParentOpenStatus(K$P))},K$q.renderItem=function(K$c,K$P){var K$q=K$c.dataSource;if(K$q){K$c.left=K$q.x;var K$_=K$c.getChildByName("arrow");K$_&&(K$q.hasChild?(K$_.visible=!0,K$_.index=K$q.isOpen?1:0,K$_.tag=K$P,K$_.off("click",this,this.onArrowClick),K$_.on("click",this,this.onArrowClick)):K$_.visible=!1);var K$E=K$c.getChildByName("folder");K$E&&(2==K$E.clipY?K$E.index=K$q.isDirectory?0:1:K$E.index=K$q.isDirectory?K$q.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([K$c,K$P])}},K$q.onArrowClick=function(K$c){var K$P=K$c.currentTarget.tag;this._list.array[K$P].isOpen=!this._list.array[K$P].isOpen,this.event("open"),this._list.array=this.getArray()},K$q.setItemState=function(K$c,K$P){this._list.array[K$c]&&(this._list.array[K$c].isOpen=K$P,this._list.array=this.getArray())},K$q.fresh=function(){this._list.array=this.getArray(),this.repaint()},K$q.parseXml=function(K$c,K$P,K$q,K$_){var K$E,K$b=K$c.childNodes,K$e=K$b.length;if(!K$_){K$E={};var K$h,K$Z=K$c.attributes;for(var K$S in K$Z){var K$n=(K$h=K$Z[K$S]).nodeName,K$k=K$h.nodeValue;K$E[K$n]="true"==K$k||"false"!=K$k&&K$k}K$E.nodeParent=K$q,0<K$e&&(K$E.isDirectory=!0),K$E.hasChild=0<K$e,K$P.push(K$E)}for(var K$x=0;K$x<K$e;K$x++){var K$r=K$b[K$x];this.parseXml(K$r,K$P,K$E,!1)}},K$q.parseOpenStatus=function(K$c,K$P){for(var K$q=0,K$_=K$P.length;K$q<K$_;K$q++){var K$E=K$P[K$q];if(K$E.isDirectory)for(var K$b=0,K$e=K$c.length;K$b<K$e;K$b++){var K$h=K$c[K$b];if(K$h.isDirectory&&this.isSameParent(K$h,K$E)&&K$E.label==K$h.label){K$E.isOpen=K$h.isOpen;break}}}},K$q.isSameParent=function(K$c,K$P){return null==K$c.nodeParent&&null==K$P.nodeParent||null!=K$c.nodeParent&&null!=K$P.nodeParent&&(K$c.nodeParent.label==K$P.nodeParent.label&&this.isSameParent(K$c.nodeParent,K$P.nodeParent))},K$q.filter=function(K$c){if(Boolean(K$c)){var K$P=[];this.getFilterSource(this._source,K$P,K$c),this._list.array=K$P}else this._list.array=this.getArray()},K$q.getFilterSource=function(K$c,K$P,K$q){var K$_;for(var K$E in K$q=K$q.toLocaleLowerCase(),K$c)!(K$_=K$c[K$E]).isDirectory&&-1<String(K$_.label).toLowerCase().indexOf(K$q)&&(K$_.x=0,K$P.push(K$_)),K$_.child&&0<K$_.child.length&&this.getFilterSource(K$_.child,K$P,K$q)},K$e(0,K$q,"spaceBottom",function(){return this._list.spaceY},function(K$c){this._list.spaceY=K$c}),K$e(0,K$q,"keepStatus",function(){return this._keepStatus},function(K$c){this._keepStatus=K$c}),K$e(0,K$q,"itemRender",function(){return this._list.itemRender},function(K$c){this._list.itemRender=K$c}),K$e(0,K$q,"array",function(){return this._list.array},function(K$c){this._keepStatus&&this._list.array&&K$c&&this.parseOpenStatus(this._list.array,K$c),this._source=K$c,this._list.array=this.getArray()}),K$e(0,K$q,"mouseHandler",function(){return this._list.mouseHandler},function(K$c){this._list.mouseHandler=K$c}),K$e(0,K$q,"dataSource",K$c.prototype._$get_dataSource,function(K$c){this._dataSource=K$c,K$W.superSet(K$C,this,"dataSource",K$c)}),K$e(0,K$q,"source",function(){return this._source}),K$e(0,K$q,"scrollBar",function(){return this._list.scrollBar}),K$e(0,K$q,"list",function(){return this._list}),K$e(0,K$q,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(K$c){this._list.vScrollBarSkin=K$c}),K$e(0,K$q,"renderHandler",function(){return this._renderHandler},function(K$c){this._renderHandler=K$c}),K$e(0,K$q,"selectedIndex",function(){return this._list.selectedIndex},function(K$c){this._list.selectedIndex=K$c}),K$e(0,K$q,"spaceLeft",function(){return this._spaceLeft},function(K$c){this._spaceLeft=K$c}),K$e(0,K$q,"selectedItem",function(){return this._list.selectedItem},function(K$c){this._list.selectedItem=K$c}),K$e(0,K$q,"width",K$c.prototype._$get_width,function(K$c){K$W.superSet(K$C,this,"width",K$c),this._list.width=K$c}),K$e(0,K$q,"height",K$c.prototype._$get_height,function(K$c){K$W.superSet(K$C,this,"height",K$c),this._list.height=K$c}),K$e(0,K$q,"xml",null,function(K$c){var K$P=[];this.parseXml(K$c.childNodes[0],K$P,null,!0),this.array=K$P}),K$e(0,K$q,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),K$P}(K$C),K$cc=function(K$c){function K$P(){this._items=null,this._selectedIndex=0,K$P.__super.call(this),this._setIndexHandler=K$x.create(this,this.setIndex,null,!1)}K$b(K$P,"laya.ui.ViewStack",K$c);var K$q=K$P.prototype;return K$W.imps(K$q,{"laya.ui.IItem":!0}),K$q.setItems=function(K$c){this.removeChildren();for(var K$P=0,K$q=0,K$_=K$c.length;K$q<K$_;K$q++){var K$E=K$c[K$q];K$E&&(K$E.name="item"+K$P,this.addChild(K$E),K$P++)}this.initItems()},K$q.addItem=function(K$c){K$c.name="item"+this._items.length,this.addChild(K$c),this.initItems()},K$q.initItems=function(){this._items=[];for(var K$c=0;K$c<1e4;K$c++){var K$P=this.getChildByName("item"+K$c);if(null==K$P)break;this._items.push(K$P),K$P.visible=K$c==this._selectedIndex}},K$q.setSelect=function(K$c,K$P){this._items&&-1<K$c&&K$c<this._items.length&&(this._items[K$c].visible=K$P)},K$q.setIndex=function(K$c){this.selectedIndex=K$c},K$e(0,K$q,"dataSource",K$c.prototype._$get_dataSource,function(K$c){if("number"==typeof(this._dataSource=K$c)&&Math.floor(K$c)==K$c||"string"==typeof K$c)this.selectedIndex=parseInt(K$c);else for(var K$P in this._dataSource)this.hasOwnProperty(K$P)&&(this[K$P]=this._dataSource[K$P])}),K$e(0,K$q,"selectedIndex",function(){return this._selectedIndex},function(K$c){this._selectedIndex!=K$c&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=K$c,this.setSelect(this._selectedIndex,!0))}),K$e(0,K$q,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(K$c){this.selectedIndex=this._items.indexOf(K$c)}),K$e(0,K$q,"items",function(){return this._items}),K$e(0,K$q,"setIndexHandler",function(){return this._setIndexHandler},function(K$c){this._setIndexHandler=K$c}),K$P}(K$C),K$Pc=function(K$c){function K$P(){K$P.__super.call(this)}return K$b(K$P,"laya.ui.VScrollBar",K$s),K$P}(),K$qc=function(K$P){function K$q(K$c){this._bg=null,this._skin=null,K$q.__super.call(this),void 0===K$c&&(K$c=""),this.text=K$c,this.skin=this.skin}K$b(K$q,"laya.ui.TextInput",K$P);var K$c=K$q.prototype;return K$c.preinitialize=function(){this.mouseEnabled=!0},K$c.destroy=function(K$c){K$N.clearCache(this,this._skin),void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,K$c),this._bg&&this._bg.destroy(),this._bg=null},K$c.createChildren=function(){this.addChild(this._tf=new K$r),this._tf.padding=K$A.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},K$c._onFocus=function(){this.event("focus",this)},K$c._onBlur=function(){this.event("blur",this)},K$c._onInput=function(){this.event("input",this)},K$c._onEnter=function(){this.event("enter",this)},K$c.initialize=function(){this.width=128,this.height=22},K$c.select=function(){this._tf.select()},K$c.setSelection=function(K$c,K$P){this._tf.setSelection(K$c,K$P)},K$e(0,K$c,"text",K$P.prototype._$get_text,function(K$c){this._tf.text!=K$c&&(K$c+="",this._tf.text=K$c,this.event("change"))}),K$e(0,K$c,"bg",function(){return this._bg},function(K$c){this.graphics=this._bg=K$c}),K$e(0,K$c,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(K$c){this._tf.inputElementYAdjuster=K$c}),K$e(0,K$c,"multiline",function(){return this._tf.multiline},function(K$c){this._tf.multiline=K$c}),K$e(0,K$c,"skin",function(){return this._skin},function(K$c){this._skin!=K$c&&(K$N.clearCache(this,this._skin),this._skin=K$c,this._bg||(this.graphics=this._bg=new K$V),K$N.keepCache(this,this._skin),this._bg.source=K$N.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),K$e(0,K$c,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(K$c){this._bg||(this.graphics=this._bg=new K$V),this._bg.sizeGrid=K$J.fillArray(K$A.defaultSizeGrid,K$c,Number)}),K$e(0,K$c,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(K$c){this._tf.inputElementXAdjuster=K$c}),K$e(0,K$c,"width",K$P.prototype._$get_width,function(K$c){K$W.superSet(K$v,this,"width",K$c),this._bg&&(this._bg.width=K$c)}),K$e(0,K$c,"height",K$P.prototype._$get_height,function(K$c){K$W.superSet(K$v,this,"height",K$c),this._bg&&(this._bg.height=K$c)}),K$e(0,K$c,"editable",function(){return this._tf.editable},function(K$c){this._tf.editable=K$c}),K$e(0,K$c,"restrict",function(){return this._tf.restrict},function(K$c){this._tf.restrict=K$c}),K$e(0,K$c,"prompt",function(){return this._tf.prompt},function(K$c){this._tf.prompt=K$c}),K$e(0,K$c,"promptColor",function(){return this._tf.promptColor},function(K$c){this._tf.promptColor=K$c}),K$e(0,K$c,"maxChars",function(){return this._tf.maxChars},function(K$c){this._tf.maxChars=K$c}),K$e(0,K$c,"focus",function(){return this._tf.focus},function(K$c){this._tf.focus=K$c}),K$e(0,K$c,"type",function(){return this._tf.type},function(K$c){this._tf.type=K$c}),K$e(0,K$c,"asPassword",function(){return this._tf.asPassword},function(K$c){this._tf.asPassword=K$c}),K$q}(K$v),K$_c=function(K$c){function K$P(){K$P.__super.call(this)}return K$b(K$P,"laya.ui.VSlider",K$U),K$P}(),K$Ec=function(K$c){function K$_(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,K$_.__super.call(this)}K$b(K$_,"laya.ui.Dialog",K$c);var K$P=K$_.prototype;return K$P.initialize=function(){this.popupEffect=K$_.manager.popupEffectHandler,this.closeEffect=K$_.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},K$P._dealDragArea=function(){var K$c=this.getChildByName("drag");K$c&&(this.dragArea=K$c.x+","+K$c.y+","+K$c.width+","+K$c.height,K$c.removeSelf())},K$P._onClick=function(K$c){var K$P=K$c.target;if(K$P)switch(K$P.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(K$P.name)}},K$P.show=function(K$c,K$P){void 0===K$c&&(K$c=!1),void 0===K$P&&(K$P=!0),this._open(!1,K$c,K$P)},K$P.popup=function(K$c,K$P){void 0===K$c&&(K$c=!1),void 0===K$P&&(K$P=!0),this._open(!0,K$c,K$P)},K$P._open=function(K$c,K$P,K$q){K$_.manager.lock(!1),this.isModal=K$c,K$_.manager.open(this,K$P,K$q)},K$P.onOpened=function(){},K$P.close=function(K$c,K$P){void 0===K$P&&(K$P=!0),K$_.manager.close(this,K$c,K$P)},K$P.onClosed=function(K$c){},K$P._onMouseDown=function(K$c){var K$P=this.getMousePoint();this._dragArea.contains(K$P.x,K$P.y)?this.startDrag():this.stopDrag()},K$e(0,K$P,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(K$c){if(K$c){var K$P=K$J.fillArray([0,0,0,0],K$c,Number);this._dragArea=new K$O(K$P[0],K$P[1],K$P[2],K$P[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),K$e(0,K$P,"isPopup",function(){return null!=this.parent}),K$e(0,K$P,"zOrder",K$c.prototype._$get_zOrder,function(K$c){K$W.superSet(K$M,this,"zOrder",K$c),K$_.manager._checkMask()}),K$e(1,K$_,"manager",function(){return K$_._manager=K$_._manager||new K$$},function(K$c){K$_._manager=K$c}),K$_.setLockView=function(K$c){K$_.manager.setLockView(K$c)},K$_.lock=function(K$c){K$_.manager.lock(K$c)},K$_.closeAll=function(){K$_.manager.closeAll()},K$_.getDialogsByGroup=function(K$c){return K$_.manager.getDialogsByGroup(K$c)},K$_.closeByGroup=function(K$c){return K$_.manager.closeByGroup(K$c)},K$_.CLOSE="close",K$_.CANCEL="cancel",K$_.SURE="sure",K$_.NO="no",K$_.OK="ok",K$_.YES="yes",K$_._manager=null,K$_}(K$M),K$bc=function(K$c){function K$P(){K$P.__super.call(this)}K$b(K$P,"laya.ui.HBox",K$c);var K$q=K$P.prototype;return K$q.sortItem=function(K$c){K$c&&K$c.sort(function(K$c,K$P){return K$c.x-K$P.x})},K$q.changeItems=function(){this._itemChanged=!1;for(var K$c=[],K$P=0,K$q=0,K$_=this.numChildren;K$q<K$_;K$q++){var K$E=this.getChildAt(K$q);K$E&&K$E.layoutEnabled&&(K$c.push(K$E),K$P=this._height?this._height:Math.max(K$P,K$E.height*K$E.scaleY))}this.sortItem(K$c);var K$b=0;for(K$q=0,K$_=K$c.length;K$q<K$_;K$q++)(K$E=K$c[K$q]).x=K$b,K$b+=K$E.width*K$E.scaleX+this._space,"top"==this._align?K$E.y=0:"middle"==this._align?K$E.y=.5*(K$P-K$E.height*K$E.scaleY):"bottom"==this._align&&(K$E.y=K$P-K$E.height*K$E.scaleY);this.changeSize()},K$e(0,K$q,"height",K$c.prototype._$get_height,function(K$c){this._height!=K$c&&(K$W.superSet(K$X,this,"height",K$c),this.callLater(this.changeItems))}),K$P.NONE="none",K$P.TOP="top",K$P.MIDDLE="middle",K$P.BOTTOM="bottom",K$P}(K$X),K$ec=function(K$c){function K$P(){K$P.__super.call(this)}K$b(K$P,"laya.ui.VBox",K$c);var K$q=K$P.prototype;return K$q.changeItems=function(){this._itemChanged=!1;for(var K$c=[],K$P=0,K$q=0,K$_=this.numChildren;K$q<K$_;K$q++){var K$E=this.getChildAt(K$q);K$E&&K$E.layoutEnabled&&(K$c.push(K$E),K$P=this._width?this._width:Math.max(K$P,K$E.width*K$E.scaleX))}this.sortItem(K$c);var K$b=0;for(K$q=0,K$_=K$c.length;K$q<K$_;K$q++)(K$E=K$c[K$q]).y=K$b,K$b+=K$E.height*K$E.scaleY+this._space,"left"==this._align?K$E.x=0:"center"==this._align?K$E.x=.5*(K$P-K$E.width*K$E.scaleX):"right"==this._align&&(K$E.x=K$P-K$E.width*K$E.scaleX);this.changeSize()},K$e(0,K$q,"width",K$c.prototype._$get_width,function(K$c){this._width!=K$c&&(K$W.superSet(K$X,this,"width",K$c),this.callLater(this.changeItems))}),K$P.NONE="none",K$P.LEFT="left",K$P.CENTER="center",K$P.RIGHT="right",K$P}(K$X),K$hc=function(K$c){function K$P(){K$P.__super.call(this)}return K$b(K$P,"laya.ui.RadioGroup",K$i),K$P.prototype.createItem=function(K$c,K$P){return new K$K(K$c,K$P)},K$P}(),K$Zc=function(K$c){function K$P(){K$P.__super.call(this)}return K$b(K$P,"laya.ui.Tab",K$i),K$P.prototype.createItem=function(K$c,K$P){return new K$F(K$c,K$P)},K$P}(),K$Sc=function(K$P){function K$q(K$c){this._vScrollBar=null,this._hScrollBar=null,void 0===K$c&&(K$c=""),K$q.__super.call(this,K$c)}K$b(K$q,"laya.ui.TextArea",K$P);var K$c=K$q.prototype;return K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,K$c),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},K$c.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},K$c.onVBarChanged=function(K$c){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},K$c.onHBarChanged=function(K$c){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},K$c.changeScroll=function(){var K$c=this._vScrollBar&&0<this._tf.maxScrollY,K$P=this._hScrollBar&&0<this._tf.maxScrollX,K$q=K$c?this._width-this._vScrollBar.width:this._width,K$_=K$P?this._height-this._hScrollBar.height:this._height,K$E=this._tf.padding||K$A.labelPadding;this._tf.width=K$q,this._tf.height=K$_,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-K$E[2],this._vScrollBar.y=K$E[1],this._vScrollBar.height=this._height-(K$P?this._hScrollBar.height:0)-K$E[1]-K$E[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=K$_/Math.max(this._tf.textHeight,K$_),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=K$c),this._hScrollBar&&(this._hScrollBar.x=K$E[0],this._hScrollBar.y=this._height-this._hScrollBar.height-K$E[3],this._hScrollBar.width=this._width-(K$c?this._vScrollBar.width:0)-K$E[0]-K$E[2],this._hScrollBar.scrollSize=Math.max(.033*K$q,1),this._hScrollBar.thumbPercent=K$q/Math.max(this._tf.textWidth,K$q),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=K$P)},K$c.scrollTo=function(K$c){this.commitMeasure(),this._tf.scrollY=K$c},K$e(0,K$c,"scrollY",function(){return this._tf.scrollY}),K$e(0,K$c,"width",K$P.prototype._$get_width,function(K$c){K$W.superSet(K$qc,this,"width",K$c),this.callLater(this.changeScroll)}),K$e(0,K$c,"hScrollBar",function(){return this._hScrollBar}),K$e(0,K$c,"height",K$P.prototype._$get_height,function(K$c){K$W.superSet(K$qc,this,"height",K$c),this.callLater(this.changeScroll)}),K$e(0,K$c,"maxScrollX",function(){return this._tf.maxScrollX}),K$e(0,K$c,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(K$c){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new K$Pc),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=K$c}),K$e(0,K$c,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(K$c){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new K$t),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=K$c}),K$e(0,K$c,"vScrollBar",function(){return this._vScrollBar}),K$e(0,K$c,"maxScrollY",function(){return this._tf.maxScrollY}),K$e(0,K$c,"scrollX",function(){return this._tf.scrollX}),K$q}(K$qc);!function(K$c){function K$P(){this._uiView=null,this.isCloseOther=!1,K$P.__super.call(this)}K$b(K$P,"laya.ui.AsynDialog",K$Ec);var K$q=K$P.prototype;K$q.createView=function(K$c){this._uiView=K$c},K$q._open=function(K$c,K$P,K$q){this.isModal=K$c,this.isCloseOther=K$P,K$Ec.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},K$q.onCreated=function(){this.createUI(),this.onOpen()},K$q.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},K$q.onOpen=function(){K$Ec.manager.open(this,this.isCloseOther),K$Ec.manager.lock(!1)},K$q.close=function(K$c,K$P){void 0===K$P&&(K$P=!0),K$Ec.manager.close(this),this.onClose()},K$q.onClose=function(){},K$q.destroy=function(K$c){void 0===K$c&&(K$c=!0),laya.ui.View.prototype.destroy.call(this,K$c),this._uiView=null,this.onDestroy()},K$q.onDestroy=function(){}}();K$W.__init([K$M])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(K$c,K$P){"use strict";for(var K$q in Object.defineProperty(K$P,"__esModule",{value:!0}),Laya){var K$_=Laya[K$q];K$_&&K$_.__isclass&&(K$P[K$q]=K$_)}}),function(K$x,K$c,K$D){K$D.un,K$D.uns;var K$k=K$D.static,K$r=K$D.class,K$g=K$D.getset,K$_=K$D.__newvec,K$T=laya.maths.Arith,K$e=laya.webgl.atlas.AtlasResourceManager,K$q=laya.webgl.shader.BaseShader,K$R=laya.utils.Browser,K$h=laya.webgl.utils.Buffer,K$L=laya.utils.Byte,K$E=laya.utils.ClassUtils,K$Z=K$D.Config,K$b=(laya.events.Event,laya.events.EventDispatcher),K$A=laya.utils.Handler,K$O=laya.net.Loader,K$P=laya.net.LoaderManager,K$S=(laya.maths.MathUtil,laya.display.Node),K$W=laya.renders.Render,K$n=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),K$w=laya.resource.Resource,K$N=laya.utils.RunDriver,K$m=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),K$H=laya.display.Sprite,K$Q=laya.utils.Stat,K$d=laya.utils.StringKey,K$J=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),K$u=laya.utils.Utils,K$j=laya.webgl.WebGL,K$V=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;K$D.interface("laya.d3.core.IClone"),K$D.interface("laya.d3.graphics.IVertex"),K$D.interface("laya.d3.core.render.IUpdate"),K$D.interface("laya.d3.core.scene.ITreeNode"),K$D.interface("laya.d3.core.render.IRenderable");(function(){function K$F(){}K$r(K$F,"laya.d3.animation.AnimationClipParser01"),K$F.READ_DATA=function(){K$F._DATA.offset=K$F._reader.getUint32(),K$F._DATA.size=K$F._reader.getUint32()},K$F.READ_BLOCK=function(){for(var K$c=K$F._BLOCK.count=K$F._reader.getUint16(),K$P=K$F._BLOCK.blockStarts=[],K$q=K$F._BLOCK.blockLengths=[],K$_=0;K$_<K$c;K$_++)K$P.push(K$F._reader.getUint32()),K$q.push(K$F._reader.getUint32())},K$F.READ_STRINGS=function(){var K$c=K$F._reader.getUint32(),K$P=K$F._reader.getUint16(),K$q=K$F._reader.pos;K$F._reader.pos=K$c+K$F._DATA.offset;for(var K$_=0;K$_<K$P;K$_++)K$F._strings[K$_]=K$F._reader.readUTFString();K$F._reader.pos=K$q},K$F.parse=function(K$c,K$P){K$F._animationClip=K$c;(K$F._reader=K$P).__getBuffer();K$F.READ_DATA(),K$F.READ_BLOCK(),K$F.READ_STRINGS();for(var K$q=0,K$_=K$F._BLOCK.count;K$q<K$_;K$q++){var K$E=K$P.getUint16(),K$b=K$F._strings[K$E],K$e=K$F["READ_"+K$b];if(null==K$e)throw new Error("model file err,no this function:"+K$E+" "+K$b);K$e.call()}},K$F.READ_ANIMATIONS=function(){var K$c,K$P=0,K$q=0,K$_=K$F._reader,K$E=K$_.__getBuffer(),K$b=[],K$e=K$_.getUint8();for(K$b.length=K$e,K$P=0;K$P<K$e;K$P++)K$b[K$P]=K$_.getUint16();var K$h=[],K$Z=K$_.getUint16();for(K$h.length=K$Z,K$P=0;K$P<K$Z;K$P++)K$h[K$P]=K$_.getFloat32();var K$S=K$F._animationClip;K$S.name=K$F._strings[K$_.getUint16()];var K$n=K$S._duration=K$_.getFloat32();K$S.islooping=!!K$_.getByte(),K$S._frameRate=K$_.getInt16();var K$k=K$_.getInt16(),K$x=K$S._nodes=new Array;K$x.length=K$k,(K$S._publicClipDatas=[]).length=K$k;var K$r=K$S._nodesMap={},K$g=0,K$W=0;for(K$P=0;K$P<K$k;K$P++){K$c=K$x[K$P]=new K$y;var K$w=K$_.getUint16(),K$O=K$c.path=[];for(K$O.length=K$w,K$q=0;K$q<K$w;K$q++)K$O[K$q]=K$F._strings[K$_.getUint16()];var K$N=K$O.join("/"),K$m=K$r[K$N];K$m||(K$r[K$N]=K$m=[]),K$m.push(K$c);var K$T=K$_.getInt16();-1!==K$T&&(K$c.componentType=K$F._strings[K$T]);var K$D=K$I._propertyIndexDic[K$F._strings[K$_.getUint16()]];if(null==K$D)throw new Error("AnimationClipParser01:unknown property name.");var K$L=K$D<4,K$H=!K$L||K$L&&""===K$O[0];(K$c._cacheProperty=K$H)?K$g++:K$W++,K$c.propertyNameID=K$D;var K$Q=K$b[K$_.getUint8()];K$c.keyFrameWidth=K$Q/4;var K$d=K$c.keyFrames=[],K$u=K$d.length=K$_.getUint16(),K$A=null,K$J=NaN;for(K$q=0;K$q<K$u;K$q++){var K$j=K$d[K$q]=new K$v;K$J=K$j.startTime=K$h[K$_.getUint16()];var K$V=K$_.pos;K$j.inTangent=new Float32Array(K$E.slice(K$V,K$V+K$Q)),K$_.pos+=K$Q,K$V=K$_.pos,K$j.outTangent=new Float32Array(K$E.slice(K$V,K$V+K$Q)),K$_.pos+=K$Q,K$V=K$_.pos,K$j.data=new Float32Array(K$E.slice(K$V,K$V+K$Q)),K$_.pos+=K$Q,K$A&&(K$A.next=K$j,K$A.duration=K$J-K$A.startTime),K$A=K$j}K$j.next=null,K$j.duration=K$n-K$J}var K$R=K$S._nodeToCachePropertyMap=new Int32Array(K$k),K$$=K$S._cachePropertyMap=new Int32Array(K$g),K$C=K$S._unCachePropertyMap=new Int32Array(K$W);for(K$g=K$W=0,K$P=0;K$P<K$k;K$P++)(K$c=K$x[K$P])._cacheProperty?(K$R[K$P]=K$g,K$$[K$g++]=K$P):K$C[K$W++]=K$P},K$F._animationClip=null,K$F._reader=null,K$F._strings=[],K$k(K$F,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function K$s(){}K$r(K$s,"laya.d3.animation.AnimationClipParser02"),K$s.READ_DATA=function(){K$s._DATA.offset=K$s._reader.getUint32(),K$s._DATA.size=K$s._reader.getUint32()},K$s.READ_BLOCK=function(){for(var K$c=K$s._BLOCK.count=K$s._reader.getUint16(),K$P=K$s._BLOCK.blockStarts=[],K$q=K$s._BLOCK.blockLengths=[],K$_=0;K$_<K$c;K$_++)K$P.push(K$s._reader.getUint32()),K$q.push(K$s._reader.getUint32())},K$s.READ_STRINGS=function(){var K$c=K$s._reader.getUint32(),K$P=K$s._reader.getUint16(),K$q=K$s._reader.pos;K$s._reader.pos=K$c+K$s._DATA.offset;for(var K$_=0;K$_<K$P;K$_++)K$s._strings[K$_]=K$s._reader.readUTFString();K$s._reader.pos=K$q},K$s.parse=function(K$c,K$P){K$s._animationClip=K$c;(K$s._reader=K$P).__getBuffer();K$s.READ_DATA(),K$s.READ_BLOCK(),K$s.READ_STRINGS();for(var K$q=0,K$_=K$s._BLOCK.count;K$q<K$_;K$q++){var K$E=K$P.getUint16(),K$b=K$s._strings[K$E],K$e=K$s["READ_"+K$b];if(null==K$e)throw new Error("model file err,no this function:"+K$E+" "+K$b);K$e.call()}},K$s.READ_ANIMATIONS=function(){var K$c,K$P=0,K$q=0,K$_=K$s._reader,K$E=K$_.__getBuffer(),K$b=[],K$e=K$_.getUint8();for(K$b.length=K$e,K$P=0;K$P<K$e;K$P++)K$b[K$P]=K$_.getUint16();var K$h=[],K$Z=K$_.getUint16();for(K$h.length=K$Z,K$P=0;K$P<K$Z;K$P++)K$h[K$P]=K$_.getFloat32();var K$S=K$s._animationClip;K$S.name=K$s._strings[K$_.getUint16()];var K$n=K$S._duration=K$_.getFloat32();K$S.islooping=!!K$_.getByte(),K$S._frameRate=K$_.getInt16();var K$k=K$_.getInt16(),K$x=K$S._nodes=new Array;K$x.length=K$k,(K$S._publicClipDatas=[]).length=K$k;var K$r=K$S._nodesMap={},K$g=0,K$W=0;for(K$P=0;K$P<K$k;K$P++){K$c=K$x[K$P]=new K$y;var K$w=K$_.getUint16(),K$O=K$c.path=[];for(K$O.length=K$w,K$q=0;K$q<K$w;K$q++)K$O[K$q]=K$s._strings[K$_.getUint16()];var K$N=K$O.join("/"),K$m=K$r[K$N];K$m||(K$r[K$N]=K$m=[]),K$m.push(K$c);var K$T=K$_.getInt16();-1!==K$T&&(K$c.componentType=K$s._strings[K$T]);var K$D=K$I._propertyIndexDic[K$s._strings[K$_.getUint16()]];if(null==K$D)throw new Error("AnimationClipParser02:unknown property name.");var K$L=K$D<4,K$H=!K$L||K$L&&""===K$O[0];(K$c._cacheProperty=K$H)?K$g++:K$W++,K$c.propertyNameID=K$D;var K$Q=K$b[K$_.getUint8()];K$c.keyFrameWidth=K$Q/4;var K$d=K$c.keyFrames=[],K$u=K$d.length=K$_.getUint16(),K$A=null,K$J=NaN;for(K$q=0;K$q<K$u;K$q++){var K$j=K$d[K$q]=new K$v;K$J=K$j.startTime=K$h[K$_.getUint16()];var K$V=K$_.pos;K$j.inTangent=new Float32Array(K$E.slice(K$V,K$V+K$Q)),K$_.pos+=K$Q,K$V=K$_.pos,K$j.outTangent=new Float32Array(K$E.slice(K$V,K$V+K$Q)),K$_.pos+=K$Q,K$V=K$_.pos,K$j.data=new Float32Array(K$E.slice(K$V,K$V+K$Q)),K$_.pos+=K$Q,K$A&&(K$A.next=K$j,K$A.duration=K$J-K$A.startTime),K$A=K$j}K$j.next=null,K$j.duration=K$n-K$J}var K$R=K$_.getUint16();for(K$P=0;K$P<K$R;K$P++){var K$$,K$C=new K$U;K$C.time=K$_.getFloat32(),K$C.eventName=K$s._strings[K$_.getUint16()];var K$F=K$_.getUint16();for(0<K$F&&(K$C.params=K$$=[]),K$q=0;K$q<K$F;K$q++){switch(K$_.getByte()){case 0:K$$.push(!!K$_.getByte());break;case 1:K$$.push(K$_.getInt32());break;case 2:K$$.push(K$_.getFloat32());break;case 3:K$$.push(K$s._strings[K$_.getUint16()]);break;default:throw new Error("unknown type.")}}K$S.addEvent(K$C)}var K$o=K$S._nodeToCachePropertyMap=new Int32Array(K$k),K$a=K$S._cachePropertyMap=new Int32Array(K$g),K$Y=K$S._unCachePropertyMap=new Int32Array(K$W);for(K$g=K$W=0,K$P=0;K$P<K$k;K$P++)(K$c=K$x[K$P])._cacheProperty?(K$o[K$P]=K$g,K$a[K$g++]=K$P):K$Y[K$W++]=K$P},K$s._animationClip=null,K$s._reader=null,K$s._strings=[],K$k(K$s,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var K$U=function(){function K$c(){this.time=NaN,this.eventName=null,this.params=null}return K$r(K$c,"laya.d3.animation.AnimationEvent"),K$c}(),K$I=function(){function K$_(){this._childs=[],this.transform=new K$NP(this)}K$r(K$_,"laya.d3.animation.AnimationNode");var K$c=K$_.prototype;return K$D.imps(K$c,{"laya.d3.core.IClone":!0}),K$c.addChild=function(K$c){K$c._parent=this,K$c.transform.setParent(this.transform),this._childs.push(K$c)},K$c.removeChild=function(K$c){var K$P=this._childs.indexOf(K$c);-1!==K$P&&this._childs.splice(K$P,1)},K$c.getChildByName=function(K$c){for(var K$P=0,K$q=this._childs.length;K$P<K$q;K$P++){var K$_=this._childs[K$P];if(K$_.name===K$c)return K$_}return null},K$c.getChildByIndex=function(K$c){return this._childs[K$c]},K$c.getChildCount=function(){return this._childs.length},K$c.cloneTo=function(K$c){var K$P=K$c;K$P.name=this.name;for(var K$q=0,K$_=this._childs.length;K$q<K$_;K$q++){var K$E=this._childs[K$q],K$b=K$E.clone();K$P.addChild(K$b);var K$e=K$E.transform,K$h=K$b.transform;K$h.setLocalPosition(K$e.getLocalPosition()),K$h.setLocalRotation(K$e.getLocalRotation()),K$h.setLocalScale(K$e.getLocalScale()),K$h._localRotationEuler=K$e._localRotationEuler,K$h._setWorldMatrixIgnoreUpdate(K$e.getWorldMatrix())}},K$c.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$_.__init__=function(){K$_.registerAnimationNodeProperty("localPosition",K$_._getLocalPosition,K$_._setLocalPosition),K$_.registerAnimationNodeProperty("localRotation",K$_._getLocalRotation,K$_._setLocalRotation),K$_.registerAnimationNodeProperty("localScale",K$_._getLocalScale,K$_._setLocalScale),K$_.registerAnimationNodeProperty("localRotationEuler",K$_._getLocalRotationEuler,K$_._setLocalRotationEuler),K$_.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",K$_._getParticleRenderSharedMaterialTintColor,K$_._setParticleRenderSharedMaterialTintColor),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",K$_._getMeshRenderSharedMaterialTilingOffset,K$_._setMeshRenderSharedMaterialTilingOffset),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",K$_._getMeshRenderSharedMaterialAlbedo,K$_._setMeshRenderSharedMaterialAlbedo),K$_.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",K$_._getSkinnedMeshRenderSharedMaterialTilingOffset,K$_._setSkinnedMeshRenderSharedMaterialTilingOffset),K$_.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",K$_._getSkinnedMeshRenderSharedMaterialAlbedo,K$_._setSkinnedMeshRenderSharedMaterialAlbedo),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",K$_._getMeshRenderSharedMaterialAlbedo,K$_._setMeshRenderSharedMaterialAlbedo),K$_.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",K$_._getSkinnedMeshRenderSharedMaterialAlbedo,K$_._setSkinnedMeshRenderSharedMaterialAlbedo),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",K$_._getMeshRenderSharedMaterialIntensity,K$_._setMeshRenderSharedMaterialIntensity),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",K$_._getMeshRenderSharedMaterialAlpha,K$_._setMeshRenderSharedMaterialAlpha),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",K$_._getMeshRenderSharedMaterialAlphaColor,K$_._setMeshRenderSharedMaterialAlphaColor),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",K$_._getMeshRenderSharedMaterialBaseColor,K$_._setMeshRenderSharedMaterialBaseColor),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",K$_._getMeshRenderSharedMaterialDissolve,K$_._setMeshRenderSharedMaterialDissolve),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",K$_._getMeshRenderSharedMaterialDissolveSpeed,K$_._setMeshRenderSharedMaterialDissolveSpeed),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",K$_._getMeshRenderSharedMaterialMMultiplier,K$_._setMeshRenderSharedMaterialMMultiplier),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",K$_._getMeshRenderSharedMaterialBaseScrollSpeedX,K$_._setMeshRenderSharedMaterialBaseScrollSpeedX),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",K$_._getMeshRenderSharedMaterialBaseScrollSpeedY,K$_._setMeshRenderSharedMaterialBaseScrollSpeedY),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",K$_._getMeshRenderSharedMaterialSecondScrollSpeedX,K$_._setMeshRenderSharedMaterialSecondScrollSpeedX),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",K$_._getMeshRenderSharedMaterialSecondScrollSpeedY,K$_._setMeshRenderSharedMaterialSecondScrollSpeedY),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",K$_._getMeshRenderSharedMaterialDetailTilingOffset,K$_._setMeshRenderSharedMaterialDetailTilingOffset),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",K$_._getMeshRenderSharedMaterialDissolveTilingOffset,K$_._setMeshRenderSharedMaterialDissolveTilingOffset),K$_.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",K$_._getMeshRenderSharedMaterialMaskTilingOffset,K$_._setMeshRenderSharedMaterialMaskTilingOffset)},K$_.registerAnimationNodeProperty=function(K$c,K$P,K$q){if(K$_._propertyIndexDic[K$c])throw new Error("AnimationNode: this propertyName has registered.");K$_._propertyIndexDic[K$c]=K$_._propertyIDCounter,K$_._propertyGetFuncs[K$_._propertyIDCounter]=K$P,K$_._propertySetFuncs[K$_._propertyIDCounter]=K$q,K$_._propertyIDCounter++},K$_._getLocalPosition=function(K$c,K$P){return K$c?K$c.transform.getLocalPosition():K$P._transform.localPosition.elements},K$_._setLocalPosition=function(K$c,K$P,K$q){if(K$c)K$c.transform.setLocalPosition(K$q);else{var K$_=K$P._transform,K$E=K$_.localPosition;K$E.elements=K$q,K$_.localPosition=K$E}},K$_._getLocalRotation=function(K$c,K$P){return K$c?K$c.transform.getLocalRotation():K$P._transform.localRotation.elements},K$_._setLocalRotation=function(K$c,K$P,K$q){if(K$c)K$c.transform.setLocalRotation(K$q);else{var K$_=K$P._transform,K$E=K$_.localRotation;K$E.elements=K$q,K$_.localRotation=K$E}},K$_._getLocalScale=function(K$c,K$P){return K$c?K$c.transform.getLocalScale():K$P._transform.localScale.elements},K$_._setLocalScale=function(K$c,K$P,K$q){if(K$c)K$c.transform.setLocalScale(K$q);else{var K$_=K$P._transform,K$E=K$_.localScale;K$E.elements=K$q,K$_.localScale=K$E}},K$_._getLocalRotationEuler=function(K$c,K$P){return K$c?K$c.transform.getLocalRotationEuler():K$P._transform.localRotationEuler.elements},K$_._setLocalRotationEuler=function(K$c,K$P,K$q){if(K$c)K$c.transform.setLocalRotationEuler(K$q);else{var K$_=K$P._transform,K$E=K$_.localRotationEuler;K$E.elements=K$q,K$_.localRotationEuler=K$E}},K$_._getMeshRenderSharedMaterialTilingOffset=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return K$P.meshRender.sharedMaterial.tilingOffset.elements},K$_._setMeshRenderSharedMaterialTilingOffset=function(K$c,K$P,K$q){var K$_,K$E;if(K$c){var K$b=K$c.transform._entity;K$b&&((K$E=(K$_=K$b.owner.meshRender.material).tilingOffset).elements=K$q,K$_.tilingOffset=K$E)}else(K$E=(K$_=K$P.meshRender.material).tilingOffset).elements=K$q,K$_.tilingOffset=K$E},K$_._getMeshRenderSharedMaterialAlbedo=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.albedoColor.elements:null}return K$P.meshRender.sharedMaterial.albedoColor.elements},K$_._setMeshRenderSharedMaterialAlbedo=function(K$c,K$P,K$q){var K$_,K$E;if(K$c){var K$b=K$c.transform._entity;K$b&&((K$E=(K$_=K$b.owner.meshRender.material).albedoColor).elements=K$q,K$_.albedoColor=K$E)}else(K$E=(K$_=K$P.meshRender.material).albedoColor).elements=K$q,K$_.albedoColor=K$E},K$_._getSkinnedMeshRenderSharedMaterialTilingOffset=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return K$P.skinnedMeshRender.sharedMaterial.tilingOffset.elements},K$_._setSkinnedMeshRenderSharedMaterialTilingOffset=function(K$c,K$P,K$q){var K$_,K$E;if(K$c){var K$b=K$c.transform._entity;K$b&&((K$E=(K$_=K$b.owner.skinnedMeshRender.material).tilingOffset).elements=K$q,K$_.tilingOffset=K$E)}else(K$E=(K$_=K$P.skinnedMeshRender.material).tilingOffset).elements=K$q,K$_.tilingOffset=K$E},K$_._getSkinnedMeshRenderSharedMaterialAlbedo=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return K$P.skinnedMeshRender.sharedMaterial.albedoColor.elements},K$_._setSkinnedMeshRenderSharedMaterialAlbedo=function(K$c,K$P,K$q){var K$_,K$E;if(K$c){var K$b=K$c.transform._entity;K$b&&((K$E=(K$_=K$b.owner.skinnedMeshRender.material).albedoColor).elements=K$q,K$_.albedoColor=K$E)}else(K$E=(K$_=K$P.skinnedMeshRender.material).albedoColor).elements=K$q,K$_.albedoColor=K$E},K$_._getParticleRenderSharedMaterialTintColor=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.particleRender.sharedMaterial.tintColor.elements:null}return K$P.particleRender.sharedMaterial.tintColor.elements},K$_._setParticleRenderSharedMaterialTintColor=function(K$c,K$P,K$q){var K$_,K$E;if(K$c){var K$b=K$c.transform._entity;K$b&&((K$E=(K$_=K$b.owner.particleRender.material).tintColor).elements=K$q,K$_.tintColor=K$E)}else(K$E=(K$_=K$P.particleRender.material).tintColor).elements=K$q,K$_.tintColor=K$E},K$_._getMeshRenderSharedMaterialAlphaColor=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.alphaColor.elements:null}return K$P.meshRender.sharedMaterial.alphaColor.elements},K$_._setMeshRenderSharedMaterialAlphaColor=function(K$c,K$P,K$q){var K$_,K$E;if(K$c){var K$b=K$c.transform._entity;K$b&&((K$E=(K$_=K$b.owner.meshRender.material).alphaColor).elements=K$q,K$_.alphaColor=K$E)}else(K$E=(K$_=K$P.meshRender.material).alphaColor).elements=K$q,K$_.alphaColor=K$E},K$_._getMeshRenderSharedMaterialBaseColor=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.baseColor.elements:null}return K$P.meshRender.sharedMaterial.baseColor.elements},K$_._setMeshRenderSharedMaterialBaseColor=function(K$c,K$P,K$q){var K$_,K$E;if(K$c){var K$b=K$c.transform._entity;K$b&&((K$E=(K$_=K$b.owner.meshRender.material).baseColor).elements=K$q,K$_.baseColor=K$E)}else(K$E=(K$_=K$P.meshRender.material).baseColor).elements=K$q,K$_.baseColor=K$E},K$_._getMeshRenderSharedMaterialDissolve=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.dissolve:0}return K$P.meshRender.sharedMaterial.dissolve},K$_._setMeshRenderSharedMaterialDissolve=function(K$c,K$P,K$q){if(K$c){var K$_=K$c.transform._entity;K$_&&(K$_.owner.meshRender.material.dissolve=K$q[0])}else K$P.meshRender.material.dissolve=K$q[0]},K$_._getMeshRenderSharedMaterialDissolveSpeed=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.dissolveSpeed:0}return K$P.meshRender.sharedMaterial.dissolveSpeed},K$_._setMeshRenderSharedMaterialDissolveSpeed=function(K$c,K$P,K$q){if(K$c){var K$_=K$c.transform._entity;K$_&&(K$_.owner.meshRender.material.dissolveSpeed=K$q[0])}else K$P.meshRender.material.dissolveSpeed=K$q[0]},K$_._getMeshRenderSharedMaterialMMultiplier=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.mMultiplier:0}return K$P.meshRender.sharedMaterial.mMultiplier},K$_._setMeshRenderSharedMaterialMMultiplier=function(K$c,K$P,K$q){if(K$c){var K$_=K$c.transform._entity;K$_&&(K$_.owner.meshRender.material.mMultiplier=K$q[0])}else K$P.meshRender.material.mMultiplier=K$q[0]},K$_._getMeshRenderSharedMaterialBaseScrollSpeedX=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return K$P.meshRender.sharedMaterial.baseScrollSpeedX},K$_._setMeshRenderSharedMaterialBaseScrollSpeedX=function(K$c,K$P,K$q){if(K$c){var K$_=K$c.transform._entity;K$_&&(K$_.owner.meshRender.material.baseScrollSpeedX=K$q[0])}else K$P.meshRender.material.baseScrollSpeedX=K$q[0]},K$_._getMeshRenderSharedMaterialBaseScrollSpeedY=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return K$P.meshRender.sharedMaterial.baseScrollSpeedY},K$_._setMeshRenderSharedMaterialBaseScrollSpeedY=function(K$c,K$P,K$q){if(K$c){var K$_=K$c.transform._entity;K$_&&(K$_.owner.meshRender.material.baseScrollSpeedY=K$q[0])}else K$P.meshRender.material.baseScrollSpeedY=K$q[0]},K$_._getMeshRenderSharedMaterialSecondScrollSpeedX=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return K$P.meshRender.sharedMaterial.secondScrollSpeedX},K$_._setMeshRenderSharedMaterialSecondScrollSpeedX=function(K$c,K$P,K$q){if(K$c){var K$_=K$c.transform._entity;K$_&&(K$_.owner.meshRender.material.secondScrollSpeedX=K$q[0])}else K$P.meshRender.material.secondScrollSpeedX=K$q[0]},K$_._getMeshRenderSharedMaterialSecondScrollSpeedY=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return K$P.meshRender.sharedMaterial.secondScrollSpeedY},K$_._setMeshRenderSharedMaterialSecondScrollSpeedY=function(K$c,K$P,K$q){if(K$c){var K$_=K$c.transform._entity;K$_&&(K$_.owner.meshRender.material.secondScrollSpeedY=K$q[0])}else K$P.meshRender.material.secondScrollSpeedY=K$q[0]},K$_._getMeshRenderSharedMaterialAlpha=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.alpha:0}return K$P.meshRender.sharedMaterial.alpha},K$_._setMeshRenderSharedMaterialAlpha=function(K$c,K$P,K$q){if(K$c){var K$_=K$c.transform._entity;K$_&&(K$_.owner.meshRender.material.alpha=K$q[0])}else K$P.meshRender.material.alpha=K$q[0]},K$_._getMeshRenderSharedMaterialIntensity=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.intensity:0}return K$P.meshRender.sharedMaterial.intensity},K$_._setMeshRenderSharedMaterialIntensity=function(K$c,K$P,K$q){if(K$c){var K$_=K$c.transform._entity;K$_&&(K$_.owner.meshRender.material.intensity=K$q[0])}else K$P.meshRender.material.intensity=K$q[0]},K$_._getMeshRenderSharedMaterialDetailTilingOffset=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return K$P.meshRender.sharedMaterial.detailTilingOffset.elements},K$_._setMeshRenderSharedMaterialDetailTilingOffset=function(K$c,K$P,K$q){var K$_,K$E;if(K$c){var K$b=K$c.transform._entity;K$b&&((K$E=(K$_=K$b.owner.meshRender.material).detailTilingOffset).elements=K$q,K$_.detailTilingOffset=K$E)}else(K$E=(K$_=K$P.meshRender.material).detailTilingOffset).elements=K$q,K$_.detailTilingOffset=K$E},K$_._getMeshRenderSharedMaterialDissolveTilingOffset=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return K$P.meshRender.sharedMaterial.dissolveTilingOffset.elements},K$_._setMeshRenderSharedMaterialDissolveTilingOffset=function(K$c,K$P,K$q){var K$_,K$E;if(K$c){var K$b=K$c.transform._entity;K$b&&((K$E=(K$_=K$b.owner.meshRender.material).dissolveTilingOffset).elements=K$q,K$_.dissolveTilingOffset=K$E)}else(K$E=(K$_=K$P.meshRender.material).dissolveTilingOffset).elements=K$q,K$_.dissolveTilingOffset=K$E},K$_._getMeshRenderSharedMaterialMaskTilingOffset=function(K$c,K$P){if(K$c){var K$q=K$c.transform._entity;return K$q?K$q.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return K$P.meshRender.sharedMaterial.maskTilingOffset.elements},K$_._setMeshRenderSharedMaterialMaskTilingOffset=function(K$c,K$P,K$q){var K$_,K$E;if(K$c){var K$b=K$c.transform._entity;K$b&&((K$E=(K$_=K$b.owner.meshRender.material).maskTilingOffset).elements=K$q,K$_.maskTilingOffset=K$E)}else(K$E=(K$_=K$P.meshRender.material).maskTilingOffset).elements=K$q,K$_.maskTilingOffset=K$E},K$_._propertyIDCounter=0,K$_._propertyIndexDic={},K$_._propertySetFuncs=[],K$_._propertyGetFuncs=[],K$_}(),K$v=function(){function K$c(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return K$r(K$c,"laya.d3.animation.Keyframe"),K$c}(),K$y=function(){function K$c(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return K$r(K$c,"laya.d3.animation.KeyframeNode"),K$c}(),K$$=(function(){function K$c(){this._tempVector30=new K$eP,this._tempVector31=new K$eP,this._tempVector32=new K$eP,this._a=new K$eP,this._b=new K$eP,this._c=new K$eP,this._d=new K$eP}K$r(K$c,"laya.d3.core.glitter.SplineCurvePositionVelocity");var K$P=K$c.prototype;K$P.Init=function(K$c,K$P,K$q,K$_){K$c.cloneTo(this._d),K$P.cloneTo(this._c),K$eP.scale(K$c,2,this._a),K$eP.scale(K$q,2,this._tempVector30),K$eP.subtract(this._a,this._tempVector30,this._a),K$eP.add(this._a,K$P,this._a),K$eP.add(this._a,K$_,this._a),K$eP.scale(K$q,3,this._b),K$eP.scale(K$c,3,this._tempVector30),K$eP.subtract(this._b,this._tempVector30,this._b),K$eP.subtract(this._b,K$_,this._b),K$eP.scale(K$P,2,this._tempVector30),K$eP.subtract(this._b,this._tempVector30,this._b)},K$P.Slerp=function(K$c,K$P){K$eP.scale(this._a,K$c*K$c*K$c,this._tempVector30),K$eP.scale(this._b,K$c*K$c,this._tempVector31),K$eP.scale(this._c,K$c,this._tempVector32),K$eP.add(this._tempVector30,this._tempVector31,K$P),K$eP.add(K$P,this._tempVector32,K$P),K$eP.add(K$P,this._d,K$P)}}(),function(){function K$a(K$c,K$P,K$q,K$_){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=K$c,this._h=K$P,this._minHeight=K$q,this._maxHeight=K$_}K$r(K$a,"laya.d3.core.HeightMap");var K$c=K$a.prototype;K$c._inBounds=function(K$c,K$P){return 0<=K$c&&K$c<this._h&&0<=K$P&&K$P<this._w},K$c.getHeight=function(K$c,K$P){return this._inBounds(K$c,K$P)?this._datas[K$c][K$P]:NaN},K$g(0,K$c,"width",function(){return this._w}),K$g(0,K$c,"height",function(){return this._h}),K$g(0,K$c,"maxHeight",function(){return this._maxHeight}),K$g(0,K$c,"minHeight",function(){return this._minHeight}),K$a.creatFromMesh=function(K$c,K$P,K$q,K$_){for(var K$E=[],K$b=[],K$e=K$c.getSubMeshCount(),K$h=0;K$h<K$e;K$h++){for(var K$Z=K$c.getSubMesh(K$h),K$S=K$Z._getVertexBuffer(),K$n=K$S.getData(),K$k=[],K$x=0;K$x<K$n.length;K$x+=K$S.vertexDeclaration.vertexStride/4){var K$r=new K$eP(K$n[K$x+0],K$n[K$x+1],K$n[K$x+2]);K$k.push(K$r)}K$E.push(K$k);var K$g=K$Z._getIndexBuffer();K$b.push(K$g.getData())}var K$W=K$c.boundingBox,K$w=K$W.min.x,K$O=K$W.min.z,K$N=K$W.max.x,K$m=K$W.max.z,K$T=K$W.min.y,K$D=K$W.max.y,K$L=K$N-K$w,K$H=K$m-K$O,K$Q=K$_.elements[0]=K$L/(K$P-1),K$d=K$_.elements[1]=K$H/(K$q-1),K$u=new K$a(K$P,K$q,K$T,K$D),K$A=K$a._tempRay,K$J=K$A.direction.elements;K$J[0]=0,K$J[1]=-1,K$J[2]=0;var K$j=K$D+.1;K$A.origin.elements[1]=K$j;for(var K$V=0;K$V<K$q;K$V++){var K$R=K$O+K$V*K$d;K$u._datas[K$V]=[];for(var K$$=0;K$$<K$P;K$$++){var K$C=K$w+K$$*K$Q,K$F=K$A.origin.elements;K$F[0]=K$C,K$F[2]=K$R;var K$o=K$a._getPosition(K$A,K$E,K$b);K$u._datas[K$V][K$$]=K$o===Number.MAX_VALUE?NaN:K$j-K$o}}return K$u},K$a.createFromImage=function(K$c,K$P,K$q){for(var K$_=K$c.width,K$E=K$c.height,K$b=new K$a(K$_,K$E,K$P,K$q),K$e=(K$q-K$P)/254,K$h=K$c.getPixels(),K$Z=0,K$S=0;K$S<K$E;K$S++)for(var K$n=K$b._datas[K$S]=[],K$k=0;K$k<K$_;K$k++){var K$x=K$h[K$Z++],K$r=K$h[K$Z++],K$g=K$h[K$Z++],K$W=K$h[K$Z++];K$n[K$k]=255==K$x&&255==K$r&&255==K$g&&255==K$W?NaN:(K$x+K$r+K$g)/3*K$e+K$P}return K$b},K$a._getPosition=function(K$c,K$P,K$q){for(var K$_=Number.MAX_VALUE,K$E=0;K$E<K$P.length;K$E++)for(var K$b=K$P[K$E],K$e=K$q[K$E],K$h=0;K$h<K$e.length;K$h+=3){var K$Z=K$b[K$e[K$h+0]],K$S=K$b[K$e[K$h+1]],K$n=K$b[K$e[K$h+2]],K$k=K$gP.rayIntersectsTriangle(K$c,K$Z,K$S,K$n);!isNaN(K$k)&&K$k<K$_&&(K$_=K$k)}return K$_},K$k(K$a,["_tempRay",function(){return this._tempRay=new K$EP(new K$eP,new K$eP)}])}(),function(){function K$E(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}K$r(K$E,"laya.d3.core.Layer");var K$c=K$E.prototype;return K$c._binarySearchIndex=function(){for(var K$c=0,K$P=K$E._collsionTestList.length-1,K$q=0;K$c<=K$P;){K$q=Math.floor((K$c+K$P)/2);var K$_=K$E._collsionTestList[K$q];if(K$_==this._number)return K$q;K$_>this._number?K$P=K$q-1:K$c=K$q+1}return K$c},K$c._addCollider=function(K$c){0===this._colliders.length&&K$E._collsionTestList.splice(this._binarySearchIndex(),0,this._number),K$c._isRigidbody?(this._colliders.unshift(K$c),this._nonRigidbodyOffset++):this._colliders.push(K$c)},K$c._removeCollider=function(K$c){var K$P=this._colliders.indexOf(K$c);K$P<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(K$P,1),0===this._colliders.length&&K$E._collsionTestList.splice(K$E._collsionTestList.indexOf(this._number),1)},K$g(0,K$c,"number",function(){return this._number}),K$g(0,K$c,"visible",function(){return this._visible},function(K$c){this._visible=K$c,K$E._visibleLayers=K$c?K$E._visibleLayers|this.mask:K$E._visibleLayers&~this.mask}),K$g(0,K$c,"mask",function(){return this._mask}),K$g(1,K$E,"visibleLayers",function(){return K$E._visibleLayers},function(K$c){K$E._visibleLayers=K$c;for(var K$P=0,K$q=K$E._layerList.length;K$P<K$q;K$P++){var K$_=K$E._layerList[K$P];K$_._visible=0!=(K$_._mask&K$E._visibleLayers)}}),K$E.__init__=function(){K$E._layerList.length=31;for(var K$c=0;K$c<31;K$c++){var K$P=new K$E;K$E._layerList[K$c]=K$P,0===K$c?(K$P.name="Default Layer",K$P.visible=!0):(K$P.name="Layer-"+K$c,K$P.visible=!1),K$P._number=K$c,K$P._mask=Math.pow(2,K$c)}K$E.currentCreationLayer=K$E._layerList[0]},K$E.getLayerByNumber=function(K$c){if(K$c<0||30<K$c)throw new Error("无法返回指定Layer，该number超出范围！");return K$E._layerList[K$c]},K$E.getLayerByName=function(K$c){for(var K$P=0;K$P<31;K$P++)if(K$E._layerList[K$P].name===K$c)return K$E._layerList[K$P];throw new Error("无法返回指定Layer,该name不存在")},K$E.isVisible=function(K$c){return 0!=(K$c&K$E._currentCameraCullingMask&K$E._visibleLayers)},K$E._layerList=[],K$E._visibleLayers=2147483647,K$E._collsionTestList=[],K$E._currentCameraCullingMask=2147483647,K$E.maxCount=31,K$E.currentCreationLayer=null,K$E}()),K$C=(function(){function K$c(K$c,K$P,K$q){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=K$c,this._minCount=K$P,this._maxCount=K$q}K$r(K$c,"laya.d3.core.particleShuriKen.module.Burst");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P.cloneTo=function(K$c){var K$P=K$c;K$P._time=this._time,K$P._minCount=this._minCount,K$P._maxCount=this._maxCount},K$P.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$P,"time",function(){return this._time}),K$g(0,K$P,"minCount",function(){return this._minCount}),K$g(0,K$P,"maxCount",function(){return this._maxCount})}(),function(){function K$c(K$c){this._color=null,this.enbale=!1,this._color=K$c}K$r(K$c,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var K$P=K$c.prototype;K$P.cloneTo=function(K$c){var K$P=K$c;this._color.cloneTo(K$P._color),K$P.enbale=this.enbale},K$P.clone=function(){var K$c;switch(this._color.type){case 0:K$c=K$o.createByConstant(this._color.constant.clone());break;case 1:K$c=K$o.createByGradient(this._color.gradient.clone());break;case 2:K$c=K$o.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:K$c=K$o.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var K$P=new this.constructor(K$c);return K$P.enbale=this.enbale,K$P},K$g(0,K$P,"color",function(){return this._color})}(),function(){function K$c(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}K$r(K$c,"laya.d3.core.particleShuriKen.module.Emission");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),K$P._destroy=function(){this._bursts=null,this._destroyed=!0},K$P.getBurstsCount=function(){return this._bursts.length},K$P.getBurstByIndex=function(K$c){return this._bursts[K$c]},K$P.addBurst=function(K$c){var K$P=this._bursts.length;if(0<K$P)for(var K$q=0;K$q<K$P;K$q++)this._bursts[K$q].time>K$c.time&&this._bursts.splice(K$q,0,K$c);this._bursts.push(K$c)},K$P.removeBurst=function(K$c){var K$P=this._bursts.indexOf(K$c);-1!==K$P&&this._bursts.splice(K$P,1)},K$P.removeBurstByIndex=function(K$c){this._bursts.splice(K$c,1)},K$P.clearBurst=function(){this._bursts.length=0},K$P.cloneTo=function(K$c){var K$P=K$c,K$q=K$P._bursts;K$q.length=this._bursts.length;for(var K$_=0,K$E=this._bursts.length;K$_<K$E;K$_++){var K$b=K$q[K$_];K$b?this._bursts[K$_].cloneTo(K$b):K$q[K$_]=this._bursts[K$_].clone()}K$P._emissionRate=this._emissionRate,K$P.enbale=this.enbale},K$P.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$P,"destroyed",function(){return this._destroyed}),K$g(0,K$P,"emissionRate",function(){return this._emissionRate},function(K$c){if(K$c<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=K$c})}(),function(){function K$_(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}K$r(K$_,"laya.d3.core.particleShuriKen.module.FrameOverTime");var K$c=K$_.prototype;return K$D.imps(K$c,{"laya.d3.core.IClone":!0}),K$c.cloneTo=function(K$c){var K$P=K$c;K$P._type=this._type,K$P._constant=this._constant,this._overTime.cloneTo(K$P._overTime),K$P._constantMin=this._constantMin,K$P._constantMax=this._constantMax,this._overTimeMin.cloneTo(K$P._overTimeMin),this._overTimeMax.cloneTo(K$P._overTimeMax)},K$c.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$c,"frameOverTimeData",function(){return this._overTime}),K$g(0,K$c,"constant",function(){return this._constant}),K$g(0,K$c,"type",function(){return this._type}),K$g(0,K$c,"frameOverTimeDataMin",function(){return this._overTimeMin}),K$g(0,K$c,"constantMin",function(){return this._constantMin}),K$g(0,K$c,"frameOverTimeDataMax",function(){return this._overTimeMax}),K$g(0,K$c,"constantMax",function(){return this._constantMax}),K$_.createByConstant=function(K$c){var K$P=new K$_;return K$P._type=0,K$P._constant=K$c,K$P},K$_.createByOverTime=function(K$c){var K$P=new K$_;return K$P._type=1,K$P._overTime=K$c,K$P},K$_.createByRandomTwoConstant=function(K$c,K$P){var K$q=new K$_;return K$q._type=2,K$q._constantMin=K$c,K$q._constantMax=K$P,K$q},K$_.createByRandomTwoOverTime=function(K$c,K$P){var K$q=new K$_;return K$q._type=3,K$q._overTimeMin=K$c,K$q._overTimeMax=K$P,K$q},K$_}()),K$F=function(){function K$S(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}K$r(K$S,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var K$c=K$S.prototype;return K$D.imps(K$c,{"laya.d3.core.IClone":!0}),K$c.cloneTo=function(K$c){var K$P=K$c;K$P._type=this._type,K$P._separateAxes=this._separateAxes,K$P._constant=this._constant,this._constantSeparate.cloneTo(K$P._constantSeparate),this._gradient.cloneTo(K$P._gradient),this._gradientX.cloneTo(K$P._gradientX),this._gradientY.cloneTo(K$P._gradientY),this._gradientZ.cloneTo(K$P._gradientZ),K$P._constantMin=this._constantMin,K$P._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(K$P._constantMinSeparate),this._constantMaxSeparate.cloneTo(K$P._constantMaxSeparate),this._gradientMin.cloneTo(K$P._gradientMin),this._gradientMax.cloneTo(K$P._gradientMax),this._gradientXMin.cloneTo(K$P._gradientXMin),this._gradientXMax.cloneTo(K$P._gradientXMax),this._gradientYMin.cloneTo(K$P._gradientYMin),this._gradientYMax.cloneTo(K$P._gradientYMax),this._gradientZMin.cloneTo(K$P._gradientZMin),this._gradientZMax.cloneTo(K$P._gradientZMax)},K$c.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$c,"gradientZ",function(){return this._gradientZ}),K$g(0,K$c,"constant",function(){return this._constant}),K$g(0,K$c,"gradient",function(){return this._gradient}),K$g(0,K$c,"separateAxes",function(){return this._separateAxes}),K$g(0,K$c,"type",function(){return this._type}),K$g(0,K$c,"constantSeparate",function(){return this._constantSeparate}),K$g(0,K$c,"gradientX",function(){return this._gradientX}),K$g(0,K$c,"gradientY",function(){return this._gradientY}),K$g(0,K$c,"gradientW",function(){return this._gradientW}),K$g(0,K$c,"gradientMin",function(){return this._gradientMin}),K$g(0,K$c,"constantMin",function(){return this._constantMin}),K$g(0,K$c,"gradientMax",function(){return this._gradientMax}),K$g(0,K$c,"constantMax",function(){return this._constantMax}),K$g(0,K$c,"gradientWMin",function(){return this._gradientWMin}),K$g(0,K$c,"constantMinSeparate",function(){return this._constantMinSeparate}),K$g(0,K$c,"constantMaxSeparate",function(){return this._constantMaxSeparate}),K$g(0,K$c,"gradientXMin",function(){return this._gradientXMin}),K$g(0,K$c,"gradientXMax",function(){return this._gradientXMax}),K$g(0,K$c,"gradientWMax",function(){return this._gradientWMax}),K$g(0,K$c,"gradientYMin",function(){return this._gradientYMin}),K$g(0,K$c,"gradientYMax",function(){return this._gradientYMax}),K$g(0,K$c,"gradientZMin",function(){return this._gradientZMin}),K$g(0,K$c,"gradientZMax",function(){return this._gradientZMax}),K$S.createByConstant=function(K$c){var K$P=new K$S;return K$P._type=0,K$P._separateAxes=!1,K$P._constant=K$c,K$P},K$S.createByConstantSeparate=function(K$c){var K$P=new K$S;return K$P._type=0,K$P._separateAxes=!0,K$P._constantSeparate=K$c,K$P},K$S.createByGradient=function(K$c){var K$P=new K$S;return K$P._type=1,K$P._separateAxes=!1,K$P._gradient=K$c,K$P},K$S.createByGradientSeparate=function(K$c,K$P,K$q,K$_){var K$E=new K$S;return K$E._type=1,K$E._separateAxes=!0,K$E._gradientX=K$c,K$E._gradientY=K$P,K$E._gradientZ=K$q,K$E._gradientW=K$_,K$E},K$S.createByRandomTwoConstant=function(K$c,K$P){var K$q=new K$S;return K$q._type=2,K$q._separateAxes=!1,K$q._constantMin=K$c,K$q._constantMax=K$P,K$q},K$S.createByRandomTwoConstantSeparate=function(K$c,K$P){var K$q=new K$S;return K$q._type=2,K$q._separateAxes=!0,K$q._constantMinSeparate=K$c,K$q._constantMaxSeparate=K$P,K$q},K$S.createByRandomTwoGradient=function(K$c,K$P){var K$q=new K$S;return K$q._type=3,K$q._separateAxes=!1,K$q._gradientMin=K$c,K$q._gradientMax=K$P,K$q},K$S.createByRandomTwoGradientSeparate=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){var K$Z=new K$S;return K$Z._type=3,K$Z._separateAxes=!0,K$Z._gradientXMin=K$c,K$Z._gradientXMax=K$P,K$Z._gradientYMin=K$q,K$Z._gradientYMax=K$_,K$Z._gradientZMin=K$E,K$Z._gradientZMax=K$b,K$Z._gradientWMin=K$e,K$Z._gradientWMax=K$h,K$Z},K$S}(),K$o=function(){function K$_(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}K$r(K$_,"laya.d3.core.particleShuriKen.module.GradientColor");var K$c=K$_.prototype;return K$D.imps(K$c,{"laya.d3.core.IClone":!0}),K$c.cloneTo=function(K$c){var K$P=K$c;K$P._type=this._type,this._constant.cloneTo(K$P._constant),this._constantMin.cloneTo(K$P._constantMin),this._constantMax.cloneTo(K$P._constantMax),this._gradient.cloneTo(K$P._gradient),this._gradientMin.cloneTo(K$P._gradientMin),this._gradientMax.cloneTo(K$P._gradientMax)},K$c.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$c,"gradient",function(){return this._gradient}),K$g(0,K$c,"constant",function(){return this._constant}),K$g(0,K$c,"type",function(){return this._type}),K$g(0,K$c,"gradientMin",function(){return this._gradientMin}),K$g(0,K$c,"constantMin",function(){return this._constantMin}),K$g(0,K$c,"gradientMax",function(){return this._gradientMax}),K$g(0,K$c,"constantMax",function(){return this._constantMax}),K$_.createByConstant=function(K$c){var K$P=new K$_;return K$P._type=0,K$P._constant=K$c,K$P},K$_.createByGradient=function(K$c){var K$P=new K$_;return K$P._type=1,K$P._gradient=K$c,K$P},K$_.createByRandomTwoConstant=function(K$c,K$P){var K$q=new K$_;return K$q._type=2,K$q._constantMin=K$c,K$q._constantMax=K$P,K$q},K$_.createByRandomTwoGradient=function(K$c,K$P){var K$q=new K$_;return K$q._type=3,K$q._gradientMin=K$c,K$q._gradientMax=K$P,K$q},K$_}(),K$a=(function(){function K$c(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}K$r(K$c,"laya.d3.core.particleShuriKen.module.GradientDataColor");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P.addAlpha=function(K$c,K$P){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==K$c&&(K$c=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=K$c,this._alphaElements[this._alphaCurrentLength++]=K$P):DEBUG},K$P.addRGB=function(K$c,K$P){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==K$c&&(K$c=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=K$c,this._rgbElements[this._rgbCurrentLength++]=K$P.x,this._rgbElements[this._rgbCurrentLength++]=K$P.y,this._rgbElements[this._rgbCurrentLength++]=K$P.z):DEBUG},K$P.cloneTo=function(K$c){var K$P=K$c,K$q=0,K$_=0;K$P._alphaCurrentLength=this._alphaCurrentLength;var K$E=K$P._alphaElements;for(K$E.length=this._alphaElements.length,K$q=0,K$_=this._alphaElements.length;K$q<K$_;K$q++)K$E[K$q]=this._alphaElements[K$q];K$P._rgbCurrentLength=this._rgbCurrentLength;var K$b=K$P._rgbElements;for(K$b.length=this._rgbElements.length,K$q=0,K$_=this._rgbElements.length;K$q<K$_;K$q++)K$b[K$q]=this._rgbElements[K$q]},K$P.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$P,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),K$g(0,K$P,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function K$c(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}K$r(K$c,"laya.d3.core.particleShuriKen.module.GradientDataInt");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P.add=function(K$c,K$P){this._currentLength<8?(6===this._currentLength&&1!==K$c&&(K$c=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=K$c,this._elements[this._currentLength++]=K$P):console.log("Warning:data count must lessEqual than 4")},K$P.cloneTo=function(K$c){var K$P=K$c;K$P._currentLength=this._currentLength;var K$q=K$P._elements;K$q.length=this._elements.length;for(var K$_=0,K$E=this._elements.length;K$_<K$E;K$_++)K$q[K$_]=this._elements[K$_]},K$P.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$P,"gradientCount",function(){return this._currentLength/2})}(),function(){function K$c(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}K$r(K$c,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P.add=function(K$c,K$P){this._currentLength<8?(6===this._currentLength&&1!==K$c&&(K$c=1,DEBUG),this._elements[this._currentLength++]=K$c,this._elements[this._currentLength++]=K$P):DEBUG},K$P.getKeyByIndex=function(K$c){return this._elements[2*K$c]},K$P.getValueByIndex=function(K$c){return this._elements[2*K$c+1]},K$P.getAverageValue=function(){for(var K$c=0,K$P=this._currentLength-2;K$c<K$P;K$c+=2){this._elements[K$c+1];this._elements[K$c+3],this._elements[K$c+2]-this._elements[K$c]}return 0},K$P.cloneTo=function(K$c){var K$P=K$c;K$P._currentLength=this._currentLength;var K$q=K$P._elements;K$q.length=this._elements.length;for(var K$_=0,K$E=this._elements.length;K$_<K$E;K$_++)K$q[K$_]=this._elements[K$_]},K$P.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$P,"gradientCount",function(){return this._currentLength/2})}(),function(){function K$c(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}K$r(K$c,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P.add=function(K$c,K$P){this._currentLength<8?(6===this._currentLength&&1!==K$c&&(K$c=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=K$c,this._elements[this._currentLength++]=K$P.x,this._elements[this._currentLength++]=K$P.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},K$P.cloneTo=function(K$c){var K$P=K$c;K$P._currentLength=this._currentLength;var K$q=K$P._elements;K$q.length=this._elements.length;for(var K$_=0,K$E=this._elements.length;K$_<K$E;K$_++)K$q[K$_]=this._elements[K$_]},K$P.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$P,"gradientCount",function(){return this._currentLength/3})}(),function(){function K$h(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}K$r(K$h,"laya.d3.core.particleShuriKen.module.GradientSize");var K$c=K$h.prototype;return K$D.imps(K$c,{"laya.d3.core.IClone":!0}),K$c.getMaxSizeInGradient=function(){var K$c=0,K$P=0,K$q=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(K$c=0,K$P=this._gradientX.gradientCount;K$c<K$P;K$c++)K$q=Math.max(K$q,this._gradientX.getValueByIndex(K$c));for(K$c=0,K$P=this._gradientY.gradientCount;K$c<K$P;K$c++)K$q=Math.max(K$q,this._gradientY.getValueByIndex(K$c))}else for(K$c=0,K$P=this._gradient.gradientCount;K$c<K$P;K$c++)K$q=Math.max(K$q,this._gradient.getValueByIndex(K$c));break;case 1:K$q=this._separateAxes?(K$q=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),K$q=Math.max(K$q,this._constantMinSeparate.y),Math.max(K$q,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(K$c=0,K$P=this._gradientXMin.gradientCount;K$c<K$P;K$c++)K$q=Math.max(K$q,this._gradientXMin.getValueByIndex(K$c));for(K$c=0,K$P=this._gradientXMax.gradientCount;K$c<K$P;K$c++)K$q=Math.max(K$q,this._gradientXMax.getValueByIndex(K$c));for(K$c=0,K$P=this._gradientYMin.gradientCount;K$c<K$P;K$c++)K$q=Math.max(K$q,this._gradientYMin.getValueByIndex(K$c));for(K$c=0,K$P=this._gradientZMax.gradientCount;K$c<K$P;K$c++)K$q=Math.max(K$q,this._gradientZMax.getValueByIndex(K$c))}else{for(K$c=0,K$P=this._gradientMin.gradientCount;K$c<K$P;K$c++)K$q=Math.max(K$q,this._gradientMin.getValueByIndex(K$c));for(K$c=0,K$P=this._gradientMax.gradientCount;K$c<K$P;K$c++)K$q=Math.max(K$q,this._gradientMax.getValueByIndex(K$c))}}return K$q},K$c.cloneTo=function(K$c){var K$P=K$c;K$P._type=this._type,K$P._separateAxes=this._separateAxes,this._gradient.cloneTo(K$P._gradient),this._gradientX.cloneTo(K$P._gradientX),this._gradientY.cloneTo(K$P._gradientY),this._gradientZ.cloneTo(K$P._gradientZ),K$P._constantMin=this._constantMin,K$P._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(K$P._constantMinSeparate),this._constantMaxSeparate.cloneTo(K$P._constantMaxSeparate),this._gradientMin.cloneTo(K$P._gradientMin),this._gradientMax.cloneTo(K$P._gradientMax),this._gradientXMin.cloneTo(K$P._gradientXMin),this._gradientXMax.cloneTo(K$P._gradientXMax),this._gradientYMin.cloneTo(K$P._gradientYMin),this._gradientYMax.cloneTo(K$P._gradientYMax),this._gradientZMin.cloneTo(K$P._gradientZMin),this._gradientZMax.cloneTo(K$P._gradientZMax)},K$c.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$c,"gradientZ",function(){return this._gradientZ}),K$g(0,K$c,"gradient",function(){return this._gradient}),K$g(0,K$c,"separateAxes",function(){return this._separateAxes}),K$g(0,K$c,"type",function(){return this._type}),K$g(0,K$c,"gradientMin",function(){return this._gradientMin}),K$g(0,K$c,"constantMin",function(){return this._constantMin}),K$g(0,K$c,"gradientX",function(){return this._gradientX}),K$g(0,K$c,"gradientY",function(){return this._gradientY}),K$g(0,K$c,"gradientMax",function(){return this._gradientMax}),K$g(0,K$c,"constantMax",function(){return this._constantMax}),K$g(0,K$c,"constantMinSeparate",function(){return this._constantMinSeparate}),K$g(0,K$c,"constantMaxSeparate",function(){return this._constantMaxSeparate}),K$g(0,K$c,"gradientXMin",function(){return this._gradientXMin}),K$g(0,K$c,"gradientXMax",function(){return this._gradientXMax}),K$g(0,K$c,"gradientYMin",function(){return this._gradientYMin}),K$g(0,K$c,"gradientYMax",function(){return this._gradientYMax}),K$g(0,K$c,"gradientZMin",function(){return this._gradientZMin}),K$g(0,K$c,"gradientZMax",function(){return this._gradientZMax}),K$h.createByGradient=function(K$c){var K$P=new K$h;return K$P._type=0,K$P._separateAxes=!1,K$P._gradient=K$c,K$P},K$h.createByGradientSeparate=function(K$c,K$P,K$q){var K$_=new K$h;return K$_._type=0,K$_._separateAxes=!0,K$_._gradientX=K$c,K$_._gradientY=K$P,K$_._gradientZ=K$q,K$_},K$h.createByRandomTwoConstant=function(K$c,K$P){var K$q=new K$h;return K$q._type=1,K$q._separateAxes=!1,K$q._constantMin=K$c,K$q._constantMax=K$P,K$q},K$h.createByRandomTwoConstantSeparate=function(K$c,K$P){var K$q=new K$h;return K$q._type=1,K$q._separateAxes=!0,K$q._constantMinSeparate=K$c,K$q._constantMaxSeparate=K$P,K$q},K$h.createByRandomTwoGradient=function(K$c,K$P){var K$q=new K$h;return K$q._type=2,K$q._separateAxes=!1,K$q._gradientMin=K$c,K$q._gradientMax=K$P,K$q},K$h.createByRandomTwoGradientSeparate=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=new K$h;return K$e._type=2,K$e._separateAxes=!0,K$e._gradientXMin=K$c,K$e._gradientXMax=K$P,K$e._gradientYMin=K$q,K$e._gradientYMax=K$_,K$e._gradientZMin=K$E,K$e._gradientZMax=K$b,K$e},K$h}()),K$Y=function(){function K$h(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}K$r(K$h,"laya.d3.core.particleShuriKen.module.GradientVelocity");var K$c=K$h.prototype;return K$D.imps(K$c,{"laya.d3.core.IClone":!0}),K$c.cloneTo=function(K$c){var K$P=K$c;K$P._type=this._type,this._constant.cloneTo(K$P._constant),this._gradientX.cloneTo(K$P._gradientX),this._gradientY.cloneTo(K$P._gradientY),this._gradientZ.cloneTo(K$P._gradientZ),this._constantMin.cloneTo(K$P._constantMin),this._constantMax.cloneTo(K$P._constantMax),this._gradientXMin.cloneTo(K$P._gradientXMin),this._gradientXMax.cloneTo(K$P._gradientXMax),this._gradientYMin.cloneTo(K$P._gradientYMin),this._gradientYMax.cloneTo(K$P._gradientYMax),this._gradientZMin.cloneTo(K$P._gradientZMin),this._gradientZMax.cloneTo(K$P._gradientZMax)},K$c.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$c,"gradientZ",function(){return this._gradientZ}),K$g(0,K$c,"constant",function(){return this._constant}),K$g(0,K$c,"type",function(){return this._type}),K$g(0,K$c,"gradientXMax",function(){return this._gradientXMax}),K$g(0,K$c,"constantMin",function(){return this._constantMin}),K$g(0,K$c,"gradientX",function(){return this._gradientX}),K$g(0,K$c,"gradientY",function(){return this._gradientY}),K$g(0,K$c,"gradientXMin",function(){return this._gradientXMin}),K$g(0,K$c,"constantMax",function(){return this._constantMax}),K$g(0,K$c,"gradientYMin",function(){return this._gradientYMin}),K$g(0,K$c,"gradientYMax",function(){return this._gradientYMax}),K$g(0,K$c,"gradientZMin",function(){return this._gradientZMin}),K$g(0,K$c,"gradientZMax",function(){return this._gradientZMax}),K$h.createByConstant=function(K$c){var K$P=new K$h;return K$P._type=0,K$P._constant=K$c,K$P},K$h.createByGradient=function(K$c,K$P,K$q){var K$_=new K$h;return K$_._type=1,K$_._gradientX=K$c,K$_._gradientY=K$P,K$_._gradientZ=K$q,K$_},K$h.createByRandomTwoConstant=function(K$c,K$P){var K$q=new K$h;return K$q._type=2,K$q._constantMin=K$c,K$q._constantMax=K$P,K$q},K$h.createByRandomTwoGradient=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=new K$h;return K$e._type=3,K$e._gradientXMin=K$c,K$e._gradientXMax=K$P,K$e._gradientYMin=K$q,K$e._gradientYMax=K$_,K$e._gradientZMin=K$E,K$e._gradientZMax=K$b,K$e},K$h}(),K$s=(function(){function K$c(K$c){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=K$c}K$r(K$c,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P.cloneTo=function(K$c){var K$P=K$c;this._angularVelocity.cloneTo(K$P._angularVelocity),K$P.enbale=this.enbale},K$P.clone=function(){var K$c;switch(this._angularVelocity.type){case 0:K$c=this._angularVelocity.separateAxes?K$F.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):K$F.createByConstant(this._angularVelocity.constant);break;case 1:K$c=this._angularVelocity.separateAxes?K$F.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):K$F.createByGradient(this._angularVelocity.gradient.clone());break;case 2:K$c=this._angularVelocity.separateAxes?K$F.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):K$F.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:K$c=this._angularVelocity.separateAxes?K$F.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):K$F.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var K$P=new this.constructor(K$c);return K$P.enbale=this.enbale,K$P},K$g(0,K$P,"angularVelocity",function(){return this._angularVelocity})}(),function(){function K$c(){this.enable=!1,this.randomDirection=!1}K$r(K$c,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P._getShapeBoundBox=function(K$c){throw new Error("BaseShape: must override it.")},K$P._getSpeedBoundBox=function(K$c){throw new Error("BaseShape: must override it.")},K$P.generatePositionAndDirection=function(K$c,K$P,K$q,K$_){throw new Error("BaseShape: must override it.")},K$P._calculateProceduralBounds=function(K$c,K$P,K$q){this._getShapeBoundBox(K$c);var K$_=K$c.min,K$E=K$c.max;K$eP.multiply(K$_,K$P,K$_),K$eP.multiply(K$E,K$P,K$E);var K$b=new K$Bc(new K$eP,new K$eP);this.randomDirection?(K$b.min=new K$eP(-1,-1,-1),K$b.max=new K$eP(1,1,1)):this._getSpeedBoundBox(K$b);var K$e=new K$Bc(new K$eP,new K$eP),K$h=K$e.min,K$Z=K$e.max;K$eP.scale(K$b.min,K$q.y,K$h),K$eP.scale(K$b.max,K$q.y,K$Z),K$eP.add(K$c.min,K$h,K$h),K$eP.add(K$c.max,K$Z,K$Z),K$eP.min(K$c.min,K$h,K$c.min),K$eP.max(K$c.max,K$h,K$c.max);var K$S=new K$Bc(new K$eP,new K$eP),K$n=K$S.min,K$k=K$S.max;K$eP.scale(K$b.min,K$q.x,K$n),K$eP.scale(K$b.max,K$q.x,K$k),K$eP.min(K$S.min,K$k,K$h),K$eP.max(K$S.min,K$k,K$Z),K$eP.min(K$c.min,K$h,K$c.min),K$eP.max(K$c.max,K$h,K$c.max)},K$P.cloneTo=function(K$c){K$c.enable=this.enable},K$P.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$c}()),K$M=function(){function K$b(){}return K$r(K$b,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),K$b._randomPointUnitArcCircle=function(K$c,K$P,K$q){var K$_=K$P.elements,K$E=NaN;K$E=K$q?K$q.getFloat()*K$c:Math.random()*K$c,K$_[0]=Math.cos(K$E),K$_[1]=Math.sin(K$E)},K$b._randomPointInsideUnitArcCircle=function(K$c,K$P,K$q){var K$_=K$P.elements;K$b._randomPointUnitArcCircle(K$c,K$P,K$q);var K$E=NaN;K$E=K$q?Math.pow(K$q.getFloat(),.5):Math.pow(Math.random(),.5),K$_[0]=K$_[0]*K$E,K$_[1]=K$_[1]*K$E},K$b._randomPointUnitCircle=function(K$c,K$P){var K$q=K$c.elements,K$_=NaN;K$_=K$P?K$P.getFloat()*Math.PI*2:Math.random()*Math.PI*2,K$q[0]=Math.cos(K$_),K$q[1]=Math.sin(K$_)},K$b._randomPointInsideUnitCircle=function(K$c,K$P){var K$q=K$c.elements;K$b._randomPointUnitCircle(K$c);var K$_=NaN;K$_=K$P?Math.pow(K$P.getFloat(),.5):Math.pow(Math.random(),.5),K$q[0]=K$q[0]*K$_,K$q[1]=K$q[1]*K$_},K$b._randomPointUnitSphere=function(K$c,K$P){var K$q=K$c.elements,K$_=NaN,K$E=NaN;K$E=K$P?(K$_=K$q[2]=2*K$P.getFloat()-1,K$P.getFloat()*Math.PI*2):(K$_=K$q[2]=2*Math.random()-1,Math.random()*Math.PI*2);var K$b=Math.sqrt(1-K$_*K$_);K$q[0]=K$b*Math.cos(K$E),K$q[1]=K$b*Math.sin(K$E)},K$b._randomPointInsideUnitSphere=function(K$c,K$P){var K$q=K$c.elements;K$b._randomPointUnitSphere(K$c);var K$_=NaN;K$_=K$P?Math.pow(K$P.getFloat(),1/3):Math.pow(Math.random(),1/3),K$q[0]=K$q[0]*K$_,K$q[1]=K$q[1]*K$_,K$q[2]=K$q[2]*K$_},K$b._randomPointInsideHalfUnitBox=function(K$c,K$P){var K$q=K$c.elements;K$P?(K$q[0]=K$P.getFloat()-.5,K$q[1]=K$P.getFloat()-.5,K$q[2]=K$P.getFloat()-.5):(K$q[0]=Math.random()-.5,K$q[1]=Math.random()-.5,K$q[2]=Math.random()-.5)},K$b}(),K$z=(function(){function K$c(K$c){this._size=null,this.enbale=!1,this._size=K$c}K$r(K$c,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P.cloneTo=function(K$c){var K$P=K$c;this._size.cloneTo(K$P._size),K$P.enbale=this.enbale},K$P.clone=function(){var K$c;switch(this._size.type){case 0:K$c=this._size.separateAxes?K$a.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):K$a.createByGradient(this._size.gradient.clone());break;case 1:K$c=this._size.separateAxes?K$a.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):K$a.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:K$c=this._size.separateAxes?K$a.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):K$a.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var K$P=new this.constructor(K$c);return K$P.enbale=this.enbale,K$P},K$g(0,K$P,"size",function(){return this._size})}(),function(){function K$_(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}K$r(K$_,"laya.d3.core.particleShuriKen.module.StartFrame");var K$c=K$_.prototype;return K$D.imps(K$c,{"laya.d3.core.IClone":!0}),K$c.cloneTo=function(K$c){var K$P=K$c;K$P._type=this._type,K$P._constant=this._constant,K$P._constantMin=this._constantMin,K$P._constantMax=this._constantMax},K$c.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$c,"constant",function(){return this._constant}),K$g(0,K$c,"type",function(){return this._type}),K$g(0,K$c,"constantMin",function(){return this._constantMin}),K$g(0,K$c,"constantMax",function(){return this._constantMax}),K$_.createByConstant=function(K$c){var K$P=new K$_;return K$P._type=0,K$P._constant=K$c,K$P},K$_.createByRandomTwoConstant=function(K$c,K$P){var K$q=new K$_;return K$q._type=1,K$q._constantMin=K$c,K$q._constantMax=K$P,K$q},K$_}()),K$X=(function(){function K$c(K$c,K$P){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new K$bP(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=K$c,this._startFrame=K$P}K$r(K$c,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P.cloneTo=function(K$c){var K$P=K$c;this.tiles.cloneTo(K$P.tiles),K$P.type=this.type,K$P.randomRow=this.randomRow,this._frame.cloneTo(K$P._frame),this._startFrame.cloneTo(K$P._startFrame),K$P.cycles=this.cycles,K$P.enableUVChannels=this.enableUVChannels,K$P.enable=this.enable},K$P.clone=function(){var K$c,K$P;switch(this._frame.type){case 0:K$c=K$C.createByConstant(this._frame.constant);break;case 1:K$c=K$C.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:K$c=K$C.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:K$c=K$C.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:K$P=K$z.createByConstant(this._startFrame.constant);break;case 1:K$P=K$z.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var K$q=new this.constructor(K$c,K$P);return this.tiles.cloneTo(K$q.tiles),K$q.type=this.type,K$q.randomRow=this.randomRow,K$q.cycles=this.cycles,K$q.enableUVChannels=this.enableUVChannels,K$q.enable=this.enable,K$q},K$g(0,K$P,"frame",function(){return this._frame}),K$g(0,K$P,"startFrame",function(){return this._startFrame})}(),function(){function K$c(K$c){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=K$c}K$r(K$c,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P.cloneTo=function(K$c){var K$P=K$c;this._velocity.cloneTo(K$P._velocity),K$P.enbale=this.enbale,K$P.space=this.space},K$P.clone=function(){var K$c;switch(this._velocity.type){case 0:K$c=K$Y.createByConstant(this._velocity.constant.clone());break;case 1:K$c=K$Y.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:K$c=K$Y.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:K$c=K$Y.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var K$P=new this.constructor(K$c);return K$P.enbale=this.enbale,K$P.space=this.space,K$P},K$g(0,K$P,"velocity",function(){return this._velocity})}(),function(){function K$c(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new K$xP,this._vb=K$sP.create(K$c._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=K$YP.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=K$oP.nameKey.getID("LINE"),this._shaderCompile=K$QP._preCompileShader[this._sharderNameID]}K$r(K$c,"laya.d3.core.PhasorSpriter3D");var K$P=K$c.prototype;return K$P.line=function(K$c,K$P,K$q,K$_){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(K$c.x,K$c.y,K$c.z,K$P.x,K$P.y,K$P.z,K$P.w),this.addVertex(K$q.x,K$q.y,K$q.z,K$_.x,K$_.y,K$_.z,K$_.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},K$P.circle=function(K$c,K$P,K$q,K$_,K$E,K$b){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*K$P,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/K$P,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*K$c,Math.cos(this._tempNumver0)*K$c,0,K$q,K$_,K$E,K$b),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},K$P.plane=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=K$_/2,this._tempNumver1=K$E/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(K$c-this._tempNumver0,K$P+this._tempNumver1,K$q,K$b,K$e,K$h,K$Z),this.addVertex(K$c+this._tempNumver0,K$P+this._tempNumver1,K$q,K$b,K$e,K$h,K$Z),this.addVertex(K$c-this._tempNumver0,K$P-this._tempNumver1,K$q,K$b,K$e,K$h,K$Z),this.addVertex(K$c+this._tempNumver0,K$P-this._tempNumver1,K$q,K$b,K$e,K$h,K$Z),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},K$P.box=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=K$_/2,this._tempNumver1=K$E/2,this._tempNumver2=K$b/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(K$c-this._tempNumver0,K$P+this._tempNumver1,K$q+this._tempNumver2,K$e,K$h,K$Z,K$S),this.addVertex(K$c+this._tempNumver0,K$P+this._tempNumver1,K$q+this._tempNumver2,K$e,K$h,K$Z,K$S),this.addVertex(K$c-this._tempNumver0,K$P-this._tempNumver1,K$q+this._tempNumver2,K$e,K$h,K$Z,K$S),this.addVertex(K$c+this._tempNumver0,K$P-this._tempNumver1,K$q+this._tempNumver2,K$e,K$h,K$Z,K$S),this.addVertex(K$c+this._tempNumver0,K$P+this._tempNumver1,K$q-this._tempNumver2,K$e,K$h,K$Z,K$S),this.addVertex(K$c-this._tempNumver0,K$P+this._tempNumver1,K$q-this._tempNumver2,K$e,K$h,K$Z,K$S),this.addVertex(K$c+this._tempNumver0,K$P-this._tempNumver1,K$q-this._tempNumver2,K$e,K$h,K$Z,K$S),this.addVertex(K$c-this._tempNumver0,K$P-this._tempNumver1,K$q-this._tempNumver2,K$e,K$h,K$Z,K$S),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},K$P.cone=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*K$q+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*K$q>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/K$q,this.addVertexIndex(0,K$P,0,K$_,K$E,K$b,K$e,this._tempUint0),this.addVertexIndex(0,0,0,K$_,K$E,K$b,K$e,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<K$q;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(K$c*this._tempNumver2,0,K$c*this._tempNumver3,K$_,K$E,K$b,K$e,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==K$q-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(K$c*this._tempNumver2,0,K$c*this._tempNumver3,K$_,K$E,K$b,K$e,this._tempUint0+(this._tempInt0+K$q)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==K$q-1?this.addIndexes(this._tempUint1+K$q+2):this.addIndexes(this._tempUint1+this._tempInt0+K$q+1),this.addIndexes(this._tempUint1+this._tempInt0+K$q),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},K$P.boundingBoxLine=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(K$c,K$E,K$b,K$e,K$h,K$Z,K$S),this.addVertex(K$_,K$E,K$b,K$e,K$h,K$Z,K$S),this.addVertex(K$c,K$P,K$b,K$e,K$h,K$Z,K$S),this.addVertex(K$_,K$P,K$b,K$e,K$h,K$Z,K$S),this.addVertex(K$_,K$E,K$q,K$e,K$h,K$Z,K$S),this.addVertex(K$c,K$E,K$q,K$e,K$h,K$Z,K$S),this.addVertex(K$_,K$P,K$q,K$e,K$h,K$Z,K$S),this.addVertex(K$c,K$P,K$q,K$e,K$h,K$Z,K$S),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},K$P.addVertex=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=K$c,this._vbData[this._posInVBData+1]=K$P,this._vbData[this._posInVBData+2]=K$q,this._vbData[this._posInVBData+3]=K$_,this._vbData[this._posInVBData+4]=K$E,this._vbData[this._posInVBData+5]=K$b,this._vbData[this._posInVBData+6]=K$e,this._posInVBData+=this._floatSizePerVer,this},K$P.addVertexIndex=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){return this._hasBegun||this.addVertexIndexException(),this._vbData[K$h]=K$c,this._vbData[K$h+1]=K$P,this._vbData[K$h+2]=K$q,this._vbData[K$h+3]=K$_,this._vbData[K$h+4]=K$E,this._vbData[K$h+5]=K$b,this._vbData[K$h+6]=K$e,(K$h+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=K$h),this},K$P.addIndexes=function(K$c){var K$P=arguments;this._hasBegun||this.addVertexIndexException();for(var K$q=0;K$q<K$P.length;K$q++)this._ibData[this._posInIBData]=K$P[K$q],this._posInIBData++;return this},K$P.begin=function(K$c,K$P){return this._hasBegun&&this.beginException0(),1!==K$c&&4!==K$c&&this.beginException1(),this._primitiveType=K$c,this._camera=K$P,this._hasBegun=!0,this},K$P.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},K$P.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(K$c._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),K$Q.drawCall++,K$j.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},K$P.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},K$P.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},K$P.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},K$P.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},K$P.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},K$P.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(28,[new K$ec(0,"vector3",0),new K$ec(12,"vector4",1)])}]),K$c}()),K$f=function(){function K$c(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++K$c._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new K$xP}K$r(K$c,"laya.d3.core.render.RenderElement");var K$P=K$c.prototype;return K$P.getDynamicBatchBakedVertexs=function(K$c){for(var K$P=this._renderObj._getVertexBuffer(K$c),K$q=K$P.getData().slice(),K$_=K$P.vertexDeclaration,K$E=K$_.getVertexElementByUsage(0).offset/4,K$b=K$_.getVertexElementByUsage(3).offset/4,K$e=this._sprite3D.transform,K$h=K$e.worldMatrix,K$Z=K$e.rotation,K$S=K$_.vertexStride/4,K$n=0,K$k=K$q.length;K$n<K$k;K$n+=K$S){var K$x=K$n+K$E,K$r=K$n+K$b;K$wP.transformVector3ArrayToVector3ArrayCoordinate(K$q,K$x,K$h,K$q,K$x),K$wP.transformVector3ArrayByQuat(K$q,K$r,K$Z,K$q,K$r)}return K$q},K$P.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},K$P._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},K$g(0,K$P,"id",function(){return this._id}),K$g(0,K$P,"renderObj",function(){return this._renderObj},function(K$c){this._renderObj!==K$c&&(this._renderObj=K$c)}),K$c._uniqueIDCounter=0,K$c}(),K$l=function(){function K$P(K$c){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++K$P._uniqueIDCounter,this._needSort=!1,this._scene=K$c,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}K$r(K$P,"laya.d3.core.render.RenderQueue");var K$c=K$P.prototype;return K$c._sortOpaqueFunc=function(K$c,K$P){if(K$c._render&&K$P._render){var K$q=K$c._material.renderQueue-K$P._material.renderQueue;return 0==K$q?K$c._render._distanceForSort-K$P._render._distanceForSort:K$q}return 0},K$c._sortAlphaFunc=function(K$c,K$P){if(K$c._render&&K$P._render){var K$q=K$c._material.renderQueue-K$P._material.renderQueue;return 0==K$q?K$P._render._distanceForSort-K$c._render._distanceForSort:K$q}return 0},K$c._begainRenderElement=function(K$c,K$P,K$q){return!!K$P._beforeRender(K$c)},K$c._sortAlpha=function(K$c){K$P._cameraPosition=K$c,this._finalElements.sort(this._sortAlphaFunc)},K$c._sortOpaque=function(K$c){K$P._cameraPosition=K$c,this._finalElements.sort(this._sortOpaqueFunc)},K$c._preRender=function(K$c){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},K$c._render=function(K$c,K$P){for(var K$q,K$_,K$E,K$b,K$e,K$h,K$Z=K$Q.loopCount,K$S=this._scene,K$n=K$c.camera,K$k=(K$n.id,!1),K$x=0,K$r=this._finalElements.length;K$x<K$r;K$x++){var K$g,K$W,K$w,K$O=this._finalElements[K$x];if(null!=K$O._onPreRenderFunction&&K$O._onPreRenderFunction.call(K$O._sprite3D,K$c),0===K$O._type){if(K$c.owner=K$w=K$O._sprite3D,K$c.renderElement=K$O,K$w._preRenderUpdateComponents(K$c),K$g=K$O.renderObj,K$W=K$O._material,this._begainRenderElement(K$c,K$g,K$W)){if(K$q=K$g._getVertexBuffers(),!(K$E=(K$_=K$g._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[K$_.id]){this._errorRecord[K$_.id]=1;var K$N="vertexBuffer:"+("("+K$_._destroyed+","+K$_._released+","+K$_._referenceCount+","+K$_._buffer+")")+", material:"+(K$W?K$W.__className+"("+K$W._destroyed+","+K$W._released+")":"null")+", owner:"+(K$w?K$w.__className+"("+K$w._destroyed+","+K$w._activeInHierarchy+","+K$w._displayedInStage+")":"null")+", renderObj:"+(K$g?K$g.__className+"("+K$g._destroyed+","+K$g._released+","+K$g._referenceCount+")":"")+", parent:, url:"+(K$w?K$w.url:"")+", disposeStack:"+K$_.disposeStack;K$D.recordError("报错：unknown vertexDeclaration  "+K$N)}continue}if(K$k=(K$b=K$c._shader=K$W._getShader(K$S._shaderDefineValue,K$E.shaderDefineValue,K$w._shaderDefineValue)).bind()||K$Z!==K$b._uploadLoopCount,K$q){if(K$b._uploadVertexBuffer!==K$q||K$k){for(var K$m=0;K$m<K$q.length;K$m++){var K$T=K$q[K$m];K$b.uploadAttributesX(K$T.vertexDeclaration.shaderValues.data,K$T)}K$b._uploadVertexBuffer=K$q}}else(K$b._uploadVertexBuffer!==K$_||K$k)&&(K$b.uploadAttributes(K$E.shaderValues.data,null),K$b._uploadVertexBuffer=K$_);(K$b._uploadScene!==K$S||K$k)&&(K$b.uploadSceneUniforms(K$S._shaderValues.data),K$b._uploadScene=K$S),(K$n!==K$b._uploadCamera||K$b._uploadSprite3D!==K$w||K$k)&&(K$b.uploadSpriteUniforms(K$w._shaderValues.data),K$b._uploadSprite3D=K$w),(K$n!==K$b._uploadCamera||K$k)&&(K$b.uploadCameraUniforms(K$n._shaderValues.data),K$b._uploadCamera=K$n),(K$b._uploadMaterial!==K$W||K$k)&&(K$W._upload(),K$b._uploadMaterial=K$W),K$e!==K$W?(K$W._setRenderStateBlendDepth(),K$W._setRenderStateFrontFace(K$P,K$w.transform),K$e=K$W,K$h=K$w):K$h!==K$w&&(K$W._setRenderStateFrontFace(K$P,K$w.transform),K$h=K$w),K$g._render(K$c),K$b._uploadLoopCount=K$Z}K$w._postRenderUpdateComponents(K$c)}else if(2===K$O._type){K$O.renderObj;K$c.owner=K$w=K$O._sprite3D,K$c.renderElement=K$O,K$c._batchIndexStart=K$O._tempBatchIndexStart,K$c._batchIndexEnd=K$O._tempBatchIndexEnd,K$g=K$O.renderObj,K$W=K$O._material,this._begainRenderElement(K$c,K$g,K$W)&&(K$E=(K$_=K$g._getVertexBuffer(0)).vertexDeclaration,K$k=(K$b=K$c._shader=K$W._getShader(K$S._shaderDefineValue,K$E.shaderDefineValue,K$w._shaderDefineValue)).bind()||K$Z!==K$b._uploadLoopCount,(K$b._uploadVertexBuffer!==K$_||K$k)&&(K$b.uploadAttributes(K$E.shaderValues.data,null),K$b._uploadVertexBuffer=K$_),(K$b._uploadScene!==K$S||K$k)&&(K$b.uploadSceneUniforms(K$S._shaderValues.data),K$b._uploadScene=K$S),(K$n!==K$b._uploadCamera||K$b._uploadSprite3D!==K$w||K$k)&&(K$b.uploadSpriteUniforms(K$w._shaderValues.data),K$b._uploadSprite3D=K$w),(K$n!==K$b._uploadCamera||K$k)&&(K$b.uploadCameraUniforms(K$n._shaderValues.data),K$b._uploadCamera=K$n),(K$b._uploadMaterial!==K$W||K$k)&&(K$W._upload(),K$b._uploadMaterial=K$W),K$e!==K$W?(K$W._setRenderStateBlendDepth(),K$W._setRenderStateFrontFace(K$P,K$w.transform),K$e=K$W,K$h=K$w):K$h!==K$w&&(K$W._setRenderStateFrontFace(K$P,K$w.transform),K$h=K$w),K$g._render(K$c),K$b._uploadLoopCount=K$Z)}}},K$c._renderShadow=function(K$c,K$P){for(var K$q,K$_,K$E,K$b,K$e,K$h=K$Q.loopCount,K$Z=this._scene,K$S=K$c.camera,K$n=!1,K$k=0,K$x=this._finalElements.length;K$k<K$x;K$k++){var K$r,K$g,K$W,K$w=this._finalElements[K$k];0===K$w._type&&(K$c.owner=K$W=K$w._sprite3D,K$P||K$W._projectionViewWorldUpdateCamera===K$S&&K$W._projectionViewWorldUpdateLoopCount===K$Q.loopCount||(K$W._render._renderUpdate(K$c._projectionViewMatrix),K$W._projectionViewWorldUpdateLoopCount=K$Q.loopCount,K$W._projectionViewWorldUpdateCamera=K$S),K$c.renderElement=K$w,K$W._preRenderUpdateComponents(K$c),K$r=K$w.renderObj,K$g=K$w._material,this._begainRenderElement(K$c,K$r,null)&&(K$_=(K$q=K$r._getVertexBuffer(0)).vertexDeclaration,K$n=(K$E=K$c._shader=K$g._getShader(K$Z._shaderDefineValue,K$_.shaderDefineValue,K$W._shaderDefineValue)).bind()||K$h!==K$E._uploadLoopCount,(K$E._uploadVertexBuffer!==K$q||K$n)&&(K$E.uploadAttributes(K$_.shaderValues.data,null),K$E._uploadVertexBuffer=K$q),(K$S!==K$E._uploadCamera||K$E._uploadSprite3D!==K$W||K$n)&&(K$E.uploadSpriteUniforms(K$W._shaderValues.data),K$E._uploadSprite3D=K$W),(K$S!==K$E._uploadCamera||K$n)&&(K$E.uploadCameraUniforms(K$S._shaderValues.data),K$E._uploadCamera=K$S),(K$E._uploadMaterial!==K$g||K$n)&&(K$g._upload(),K$E._uploadMaterial=K$g),K$E._uploadRenderElement,K$b!==K$g?(K$g._setRenderStateFrontFace(!1,K$W.transform),K$b=K$g,K$e=K$W):K$e!==K$W&&(K$g._setRenderStateFrontFace(!1,K$W.transform),K$e=K$W),K$r._render(K$c),K$E._uploadLoopCount=K$h),K$W._postRenderUpdateComponents(K$c))}},K$c._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},K$c._addRenderElement=function(K$c){this._renderElements.push(K$c),this._needSort=!0},K$c._addDynamicBatchElement=function(K$c){this._dynamicBatchCombineRenderElements.push(K$c)},K$g(0,K$c,"id",function(){return this._id}),K$P._uniqueIDCounter=0,K$P._cameraPosition=null,K$P}(),K$t=function(){function K$c(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return K$r(K$c,"laya.d3.core.render.RenderState"),K$c.clientWidth=0,K$c.clientHeight=0,K$c}(),K$B=function(){function K$e(K$c,K$P){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new K$ic(new K$eP,0),this._corners=[new K$eP,new K$eP,new K$eP,new K$eP,new K$eP,new K$eP,new K$eP,new K$eP],this._boundingBoxCenter=new K$eP,this._children=K$_(8),this._objects=[],this._tempBoundBoxCorners=[new K$eP,new K$eP,new K$eP,new K$eP,new K$eP,new K$eP,new K$eP,new K$eP],this._scene=K$c,this._currentDepth=K$P}K$r(K$e,"laya.d3.core.scene.OctreeNode");var K$c=K$e.prototype;return K$D.imps(K$c,{"laya.d3.core.scene.ITreeNode":!0}),K$c.init=function(K$c,K$P){var K$q=new K$eP,K$_=new K$eP;K$eP.scale(K$P,-.5,K$q),K$eP.scale(K$P,.5,K$_),K$eP.add(K$q,K$c,K$q),K$eP.add(K$_,K$c,K$_),this.exactBox=new K$Bc(K$q,K$_),this.relaxBox=new K$Bc(K$q,K$_)},K$c.addTreeNode=function(K$c){1===Collision.boxContainsBox(this._relaxBox,K$c.boundingBox)?this.addNodeDown(K$c,0):this.addObject(K$c)},K$c.addChild=function(K$c){var K$P=this._children[K$c];if(null==K$P){K$P=new K$e(this._scene,this._currentDepth+1),(this._children[K$c]=K$P)._parent=this,K$eP.subtract(this._exactBox.max,this._exactBox.min,K$e.tempSize),K$eP.multiply(K$e.tempSize,K$e._octreeSplit[K$c],K$e.tempCenter),K$eP.add(this._exactBox.min,K$e.tempCenter,K$e.tempCenter),K$eP.scale(K$e.tempSize,.25,K$e.tempSize);var K$q=new K$eP,K$_=new K$eP;K$eP.subtract(K$e.tempCenter,K$e.tempSize,K$q),K$eP.add(K$e.tempCenter,K$e.tempSize,K$_),K$P.exactBox=new K$Bc(K$q,K$_),K$eP.scale(K$e.tempSize,K$e.relax,K$e.tempSize);var K$E=new K$eP,K$b=new K$eP;K$eP.subtract(K$e.tempCenter,K$e.tempSize,K$E),K$eP.add(K$e.tempCenter,K$e.tempSize,K$b),K$P.relaxBox=new K$Bc(K$E,K$b)}return K$P},K$c.addObject=function(K$c){(K$c._treeNode=this)._objects.push(K$c)},K$c.removeObject=function(K$c){if(K$c._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var K$P=this._objects.indexOf(K$c);return-1!==K$P&&(this._objects.splice(K$P,1),!0)},K$c.clearObject=function(){this._objects.length=0},K$c.addNodeUp=function(K$c,K$P){this._parent&&1!==Collision.boxContainsBox(this._exactBox,K$c.boundingBox)?this._parent.addNodeUp(K$c,K$P-1):this.addNodeDown(K$c,K$P)},K$c.addNodeDown=function(K$c,K$P){if(K$P<this._scene.treeLevel){var K$q=this.inChildIndex(K$c.boundingBoxCenter),K$_=this.addChild(K$q);1===Collision.boxContainsBox(K$_._relaxBox,K$c.boundingBox)?K$_.addNodeDown(K$c,++K$P):this.addObject(K$c)}else this.addObject(K$c)},K$c.inChildIndex=function(K$c){return 4*(K$c.z<this._boundingBoxCenter.z?0:1)+2*(K$c.y<this._boundingBoxCenter.y?0:1)+(K$c.x<this._boundingBoxCenter.x?0:1)},K$c.updateObject=function(K$c){1===Collision.boxContainsBox(this._relaxBox,K$c.boundingBox)?(this.removeObject(K$c),K$c._treeNode=null,this.addNodeDown(K$c,this._currentDepth)):this._parent&&(this.removeObject(K$c),K$c._treeNode=null,this._parent.addNodeUp(K$c,this._currentDepth-1))},K$c.cullingObjects=function(K$c,K$P,K$q,K$_,K$E){var K$b,K$e=0,K$h=0,K$Z=0,K$S=this._scene._dynamicBatchManager;for(K$e=0,K$b=this._objects.length;K$e<K$b;K$e++){var K$n=this._objects[K$e];if(K$$.isVisible(K$n._owner.layer.mask)&&K$n.enable){if(K$P&&(K$Q.treeSpriteCollision+=1,0===K$c.containsBoundSphere(K$n.boundingSphere)))continue;K$n._renderUpdate(K$E),K$n._distanceForSort=K$eP.distance(K$n.boundingSphere.center,K$_)+K$n.sortingFudge;var K$k=K$n._renderElements;for(K$h=0,K$Z=K$k.length;K$h<K$Z;K$h++){var K$x=K$k[K$h],K$r=K$x._staticBatch;if(K$r&&K$r._material===K$x._material)K$r._addBatchRenderElement(K$x);else{var K$g=K$x.renderObj;K$g.triangleCount<10&&1===K$g._vertexBufferCount&&K$g._getIndexBuffer()&&K$x._material.renderQueue<2&&K$x._canDynamicBatch&&!K$n._owner.isStatic?K$S._addPrepareRenderElement(K$x):this._scene.getRenderQueue(K$x._material.renderQueue)._addRenderElement(K$x)}}}}for(K$e=0;K$e<8;K$e++){var K$W=this._children[K$e];if(null!=K$W){var K$w=K$P;if(K$P){var K$O=K$c.containsBoundBox(K$W._relaxBox);if(K$Q.treeNodeCollision+=1,0===K$O)continue;K$w=2===K$O}K$W.cullingObjects(K$c,K$w,K$q,K$_,K$E)}}},K$c.cullingShadowObjects=function(K$c,K$P,K$q,K$_,K$E){var K$b,K$e=0,K$h=0,K$Z=0;this._scene._dynamicBatchManager;for(K$e=0,K$b=this._objects.length;K$e<K$b;K$e++){var K$S=this._objects[K$e];if(K$S.castShadow&&K$$.isVisible(K$S._owner.layer.mask)&&K$S.enable){if(K$q&&0===K$c[0].containsBoundSphere(K$S.boundingSphere))continue;for(var K$n=1,K$k=K$c.length;K$n<K$k;K$n++){var K$x=K$P[K$n-1];if(0!==K$c[K$n].containsBoundSphere(K$S.boundingSphere)){var K$r=K$S._renderElements;for(K$h=0,K$Z=K$r.length;K$h<K$Z;K$h++)K$x._addRenderElement(K$r[K$h])}}}}for(K$e=0;K$e<8;K$e++){var K$g=this._children[K$e];if(null!=K$g){var K$W=K$q;if(K$q){var K$w=K$c[0].containsBoundBox(K$g._relaxBox);if(0===K$w)continue;K$W=2===K$w}K$g.cullingShadowObjects(K$c,K$P,K$W,K$_,K$E)}}},K$c.cullingShadowObjectsOnePSSM=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e,K$h=K$P[0],K$Z=0,K$S=0,K$n=0;for(K$Z=0,K$e=this._objects.length;K$Z<K$e;K$Z++){var K$k=this._objects[K$Z];if(K$k.castShadow&&K$$.isVisible(K$k._owner.layer.mask)&&K$k.enable){if(K$_&&0===K$c.containsBoundSphere(K$k.boundingSphere))continue;K$k._renderUpdate(K$q);var K$x=K$k._renderElements;for(K$S=0,K$n=K$x.length;K$S<K$n;K$S++)K$h._addRenderElement(K$x[K$S])}}for(K$Z=0;K$Z<8;K$Z++){var K$r=this._children[K$Z];if(null!=K$r){var K$g=K$_;if(K$_){var K$W=K$c.containsBoundBox(K$r._relaxBox);if(0===K$W)continue;K$g=2===K$W}K$r.cullingShadowObjectsOnePSSM(K$c,K$P,K$q,K$g,K$E,K$b)}}},K$c.renderBoudingBox=function(K$c){this._renderBoudingBox(K$c);for(var K$P=0;K$P<8;++K$P){var K$q=this._children[K$P];K$q&&K$q.renderBoudingBox(K$c)}},K$c.buildAllChild=function(K$c){if(K$c<this._scene.treeLevel)for(var K$P=0;K$P<8;K$P++){this.addChild(K$P).buildAllChild(K$c+1)}},K$c._renderBoudingBox=function(K$c){},K$g(0,K$c,"exactBox",function(){return this._exactBox},function(K$c){this._exactBox=K$c,K$eP.add(K$c.min,K$c.max,this._boundingBoxCenter),K$eP.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),K$g(0,K$c,"relaxBox",function(){return this._relaxBox},function(K$c){(this._relaxBox=K$c).getCorners(this._corners),K$ic.createfromPoints(this._corners,this._boundingSphere)}),K$e.debugMode=!1,K$e.relax=1.15,K$e.CHILDNUM=8,K$k(K$e,["tempVector0",function(){return this.tempVector0=new K$eP},"tempSize",function(){return this.tempSize=new K$eP},"tempCenter",function(){return this.tempCenter=new K$eP},"_octreeSplit",function(){return this._octreeSplit=[new K$eP(.25,.25,.25),new K$eP(.75,.25,.25),new K$eP(.25,.75,.25),new K$eP(.75,.75,.25),new K$eP(.25,.25,.75),new K$eP(.75,.25,.75),new K$eP(.25,.75,.75),new K$eP(.75,.75,.75)]}]),K$e}(),K$p=(function(){function K$c(){}K$r(K$c,"laya.d3.core.scene.SceneManager")}(),function(){function K$c(K$c,K$P,K$q,K$_){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===K$c&&(K$c=1),void 0===K$P&&(K$P=1),void 0===K$q&&(K$q=1),void 0===K$_&&(K$_=1),this._r=K$c,this._g=K$P,this._b=K$q,this._a=K$_}return K$r(K$c,"laya.d3.core.trail.module.Color",null,"Color$1"),K$c.prototype.cloneTo=function(K$c){K$c._r=this._r,K$c._g=this._g,K$c._b=this._b,K$c._a=this._a},K$k(K$c,["RED",function(){return this.RED=new K$c(1,0,0,1)},"GREEN",function(){return this.GREEN=new K$c(0,1,0,1)},"BLUE",function(){return this.BLUE=new K$c(0,0,1,1)},"CYAN",function(){return this.CYAN=new K$c(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new K$c(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new K$c(1,0,1,1)},"GRAY",function(){return this.GRAY=new K$c(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new K$c(1,1,1,1)},"BLACK",function(){return this.BLACK=new K$c(0,0,0,1)}]),K$c}()),K$i=(function(){function K$c(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}K$r(K$c,"laya.d3.core.trail.module.Gradient");var K$P=K$c.prototype;K$P.setKeys=function(K$c,K$P){var K$q,K$_;this._colorKeys=K$c;for(var K$E=this.index=0;K$E<K$c.length;K$E++){var K$b=(K$q=K$c[K$E]).color;this._colorKeyData[this.index++]=K$b._r,this._colorKeyData[this.index++]=K$b._g,this._colorKeyData[this.index++]=K$b._b,this._colorKeyData[this.index++]=K$q.time}this._alphaKeys=K$P;for(var K$e=this.index=0;K$e<K$P.length;K$e++)K$_=K$P[K$e],this._alphaKeyData[this.index++]=K$_.alpha,this._alphaKeyData[this.index++]=K$_.time},K$P.cloneTo=function(K$c){var K$P=0,K$q=0,K$_=this.colorKeys,K$E=[];for(K$P=0,K$q=K$_.length;K$P<K$q;K$P++){var K$b=new K$K;K$_[K$P].cloneTo(K$b),K$E.push(K$b)}var K$e=this.alphaKeys,K$h=[];for(K$P=0,K$q=K$e.length;K$P<K$q;K$P++){var K$Z=new K$i;K$e[K$P].cloneTo(K$Z),K$h.push(K$Z)}K$c.setKeys(K$E,K$h)},K$g(0,K$P,"mode",function(){return this._mode},function(K$c){this._mode=K$c}),K$g(0,K$P,"colorKeys",function(){return this._colorKeys},function(K$c){this._colorKeys=K$c;for(var K$P=this.index=0;K$P<K$c.length;K$P++){var K$q=K$c[K$P],K$_=K$q.color;this._colorKeyData[this.index++]=K$_._r,this._colorKeyData[this.index++]=K$_._g,this._colorKeyData[this.index++]=K$_._b,this._colorKeyData[this.index++]=K$q.time}}),K$g(0,K$P,"alphaKeys",function(){return this._alphaKeys},function(K$c){this._alphaKeys=K$c;for(var K$P=this.index=0;K$P<K$c.length;K$P++){var K$q=K$c[K$P];this._alphaKeyData[this.index++]=K$q.alpha,this._alphaKeyData[this.index++]=K$q.time}})}(),function(){function K$c(K$c,K$P){this._alpha=NaN,this._time=NaN,void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),this._alpha=K$c,this._time=K$P}K$r(K$c,"laya.d3.core.trail.module.GradientAlphaKey");var K$P=K$c.prototype;return K$P.cloneTo=function(K$c){K$c.alpha=this.alpha,K$c.time=this.time},K$g(0,K$P,"alpha",function(){return this._alpha},function(K$c){this._alpha=K$c}),K$g(0,K$P,"time",function(){return this._time},function(K$c){this._time=K$c}),K$c}()),K$K=function(){function K$c(K$c,K$P){this._color=null,this._time=NaN,void 0===K$P&&(K$P=0),this._color=K$c||new K$p,this._time=K$P}K$r(K$c,"laya.d3.core.trail.module.GradientColorKey");var K$P=K$c.prototype;return K$P.cloneTo=function(K$c){this.color.cloneTo(K$c.color),K$c.time=this.time},K$g(0,K$P,"color",function(){return this._color},function(K$c){this._color=K$c}),K$g(0,K$P,"time",function(){return this._time},function(K$c){this._time=K$c}),K$c}(),K$G=(function(){function K$c(){}K$r(K$c,"laya.d3.core.trail.module.GradientMode"),K$c.Blend=0,K$c.Fixed=1}(),function(){function K$c(){}K$r(K$c,"laya.d3.core.trail.module.TextureMode"),K$c.Stretch=0,K$c.Tile=1}(),function(){function K$c(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}K$r(K$c,"laya.d3.core.trail.module.TrailKeyFrame"),K$c.prototype.cloneTo=function(K$c){K$c.time=this.time,K$c.inTangent=this.inTangent,K$c.outTangent=this.outTangent,K$c.value=this.value}}(),function(){function K$P(K$c){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new K$eP,this._curPosition=new K$eP,this._delVector3=new K$eP,this._lastFixedVertexPosition=new K$eP,this._pointAtoBVector3=new K$eP,this._pointA=new K$eP,this._pointB=new K$eP,this._owner=K$c,this._id=K$P.renderElementCount++,0==this._id?K$c._owner.transform.position.cloneTo(this._lastPosition):K$c._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new K$sP(K$G.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new K$sP(K$G.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}K$r(K$P,"laya.d3.core.trail.TrailRenderElement");var K$c=K$P.prototype;K$D.imps(K$c,{"laya.d3.core.render.IRenderable":!0}),K$c._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},K$c._addTrailByFirstPosition=function(K$c,K$P){K$eP.subtract(K$P,K$c,this._delVector3),K$eP.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),K$eP.normalize(this._pointAtoBVector3,this._pointAtoBVector3),K$eP.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(K$c),K$c.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},K$c._addTrailByNextPosition=function(K$c){K$eP.subtract(K$c,this._lastFixedVertexPosition,this._delVector3),K$eP.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),K$eP.normalize(this._pointAtoBVector3,this._pointAtoBVector3),K$eP.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=K$eP.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=K$Kc.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(K$c),K$c.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(K$c),this._virtualVerticesCount=2)},K$c._updateVerticesByPosition=function(K$c){this._pointe=K$c.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},K$c._updateVertexBuffer2=function(){var K$c,K$P=0,K$q=0,K$_=0;for(K$_=0,K$c=(this._verticesCount+this._virtualVerticesCount)/2;K$_<K$c;K$_++)K$q=0==this._owner.textureMode?(this._VerticesToTailLength[K$_]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[K$_],this._vertices2[K$P++]=1-K$q,this._vertices2[K$P++]=1-K$q;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},K$c._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},K$c._updateDisappear=function(){var K$c,K$P=0;for(K$P=this._curDisappearIndex,K$c=(this._verticesCount+this._virtualVerticesCount)/2;K$P<K$c;K$P++)this._owner._curtime-this._everyGroupVertexBirthTime[K$P]>=this._owner.time+K$Kc.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},K$c._beforeRender=function(K$c){return this._camera=K$c.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),K$eP.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},K$c._render=function(K$c){this._isDead||(K$j.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),K$Q.drawCall++,K$Q.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},K$c._getVertexBuffer=function(K$c){return void 0===K$c&&(K$c=0),0===K$c?this._vertexBuffer1:1===K$c?this._vertexBuffer2:null},K$c._getVertexBuffers=function(){return this._vertexBuffers},K$c._getIndexBuffer=function(){return null},K$c.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},K$c._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},K$g(0,K$c,"_vertexBufferCount",function(){return this._vertexBuffers.length}),K$g(0,K$c,"triangleCount",function(){return 0}),K$P.renderElementCount=0}(),function(){function K$c(){}K$r(K$c,"laya.d3.core.trail.VertexTrail");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration1}),K$g(1,K$c,"vertexDeclaration1",function(){return K$c._vertexDeclaration1}),K$g(1,K$c,"vertexDeclaration2",function(){return K$c._vertexDeclaration2}),K$k(K$c,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new K$bc(32,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",41),new K$ec(24,"single",33),new K$ec(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new K$bc(4,[new K$ec(0,"single",38)])}]),K$c}()),K$cc=function(){function K$T(K$c){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=K$c}K$r(K$T,"laya.d3.graphics.DynamicBatch");var K$c=K$T.prototype;return K$D.imps(K$c,{"laya.d3.core.render.IRenderable":!0}),K$c._getVertexBuffer=function(K$c){return void 0===K$c&&(K$c=0),0===K$c?this._vertexBuffer:null},K$c._getIndexBuffer=function(){return this._indexBuffer},K$c._getCombineRenderElementFromPool=function(K$c,K$P,K$q){var K$_=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return K$_||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=K$_=new K$f,K$_._sprite3D=new K$lP),K$_._sprite3D._render._renderUpdate(K$q),K$_},K$c._getRenderElement=function(K$c,K$P,K$q){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*K$T.maxVertexCount),this._indexDatas=new Uint16Array(K$T.maxIndexCount),this._vertexBuffer=K$sP.create(this._vertexDeclaration,K$T.maxVertexCount,35048),this._indexBuffer=K$YP.create("ushort",K$T.maxIndexCount,35048));for(var K$_=this._merageElements.length=0,K$E=0,K$b=0,K$e=this._combineRenderElements.length;K$b<K$e;K$b++){var K$h=this._combineRenderElements[K$b],K$Z=K$h.getDynamicBatchBakedVertexs(0),K$S=K$h.getBakedIndices(),K$n=K$h._sprite3D.transform._isFrontFaceInvert,K$k=K$_/(this._vertexDeclaration.vertexStride/4),K$x=K$E,K$r=K$x+K$S.length;K$h._tempBatchIndexStart=K$x,K$h._tempBatchIndexEnd=K$r,this._indexDatas.set(K$S,K$E);var K$g=0;if(K$n)for(K$g=K$x;K$g<K$r;K$g+=3){this._indexDatas[K$g]=K$k+this._indexDatas[K$g];var K$W=this._indexDatas[K$g+1],K$w=this._indexDatas[K$g+2];this._indexDatas[K$g+1]=K$k+K$w,this._indexDatas[K$g+2]=K$k+K$W}else for(K$g=K$x;K$g<K$r;K$g+=3)this._indexDatas[K$g]=K$k+this._indexDatas[K$g],this._indexDatas[K$g+1]=K$k+this._indexDatas[K$g+1],this._indexDatas[K$g+2]=K$k+this._indexDatas[K$g+2];K$E+=K$S.length,this._vertexDatas.set(K$Z,K$_),K$_+=K$Z.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),K$b=this._combineRenderElementPoolIndex=0,K$e=this._materials.length;K$b<K$e;K$b++){var K$O=this._getCombineRenderElementFromPool(K$c,K$P,K$q);K$O._type=2,K$O._staticBatch=null;var K$N=(K$O.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[K$b]]._tempBatchIndexStart,K$m=K$b+1===this._materialToRenderElementsOffsets.length?K$E:this._combineRenderElements[this._materialToRenderElementsOffsets[K$b+1]]._tempBatchIndexStart;K$O._tempBatchIndexStart=K$N,K$O._tempBatchIndexEnd=K$m,K$O._material=this._materials[K$b],this._merageElements.push(K$O)}},K$c._addCombineRenderObjTest=function(K$c){var K$P=K$c.renderObj,K$q=this._currentCombineIndexCount+K$P._getIndexBuffer().indexCount,K$_=this._currentCombineVertexCount+K$P._getVertexBuffer().vertexCount;return!(K$T.maxVertexCount<K$_||K$T.maxIndexCount<K$q)},K$c._addCombineRenderObj=function(K$c){var K$P=K$c.renderObj;this._combineRenderElements.push(K$c),this._currentCombineIndexCount=this._currentCombineIndexCount+K$P._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+K$P._getVertexBuffer().vertexCount},K$c._addCombineMaterial=function(K$c){this._materials.push(K$c)},K$c._addMaterialToRenderElementOffset=function(K$c){this._materialToRenderElementsOffsets.push(K$c)},K$c._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},K$c._addToRenderQueue=function(K$c,K$P,K$q,K$_){this._getRenderElement(K$P,K$q,K$_);for(var K$E=0,K$b=this._materials.length;K$E<K$b;K$E++)K$c.getRenderQueue(this._materials[K$E].renderQueue)._addDynamicBatchElement(this._merageElements[K$E])},K$c._beforeRender=function(K$c){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},K$c._render=function(K$c){var K$P=K$c._batchIndexEnd-K$c._batchIndexStart;K$j.mainContext.drawElements(4,K$P,5123,2*K$c._batchIndexStart),K$Q.drawCall++,K$Q.trianglesFaces+=K$P/3},K$c._getVertexBuffers=function(){return null},K$g(0,K$c,"_vertexBufferCount",function(){return 1}),K$g(0,K$c,"triangleCount",function(){return this._indexBuffer.indexCount/3}),K$g(0,K$c,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),K$T.maxVertexCount=2e4,K$T.maxIndexCount=4e4,K$T.maxCombineTriangleCount=10,K$T}(),K$Pc=function(){function K$T(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}K$r(K$T,"laya.d3.graphics.DynamicBatchManager");var K$c=K$T.prototype;return K$c.getDynamicBatch=function(K$c,K$P){var K$q,K$_=K$c.id.toString()+K$P;return this._dynamicBatches[K$_]?K$q=this._dynamicBatches[K$_]:this._dynamicBatches[K$_]=K$q=new K$cc(K$c),K$q},K$c._garbageCollection=function(){for(var K$c in this._dynamicBatches)0===this._dynamicBatches[K$c].combineRenderElementsCount&&delete this._dynamicBatches[K$c]},K$c._addPrepareRenderElement=function(K$c){this._prepareDynamicBatchCombineElements.push(K$c)},K$c._finishCombineDynamicBatch=function(K$c){var K$P,K$q,K$_;this._prepareDynamicBatchCombineElements.sort(K$T._sortPrepareDynamicBatch);for(var K$E,K$b,K$e,K$h,K$Z,K$S=-1,K$n=!0,K$k=0,K$x=-1,K$r=0,K$g=this._prepareDynamicBatchCombineElements.length;K$r<K$g;K$r++){var K$W=(K$b=this._prepareDynamicBatchCombineElements[K$r]).renderObj._getVertexBuffer(0).vertexDeclaration,K$w=K$q!==K$W;K$w&&(K$k=0,K$q=K$W);var K$O=K$k!==K$S;if(K$O&&(K$S=K$k),(K$w||K$O)&&(K$e=this.getDynamicBatch(K$W,K$k),K$P=null),K$n)if(K$e._addCombineRenderObjTest(K$b)){if(K$P!==(K$E=K$b._material))K$h&&(K$c.getRenderQueue(K$Z._material.renderQueue)._addRenderElement(K$Z),K$Z=K$h=null,K$x=-1),K$h=K$E,K$x=K$e.combineRenderElementsCount,K$Z=K$b,K$P=K$E;else if(K$h){var K$N=K$Z.renderObj,K$m=K$b.renderObj;K$N._getVertexBuffer().vertexCount+K$m._getVertexBuffer().vertexCount>K$cc.maxVertexCount||K$N._getIndexBuffer().indexCount+K$m._getIndexBuffer().indexCount>K$cc.maxIndexCount?(K$c.getRenderQueue(K$Z._material.renderQueue)._addRenderElement(K$Z),K$h=K$E,K$x=K$e.combineRenderElementsCount,K$Z=K$b):(K$e._addCombineMaterial(K$h),K$e._addMaterialToRenderElementOffset(K$x),K$e._addCombineRenderObj(K$Z),K$Z=K$h=null,K$x=-1,K$e._addCombineRenderObj(K$b))}else K$e._addCombineRenderObj(K$b);K$n=!0}else K$h&&(K$c.getRenderQueue(K$Z._material.renderQueue)._addRenderElement(K$Z),K$Z=K$h=null,K$x=-1),K$k++,K$n=!1;else K$_=this._prepareDynamicBatchCombineElements[K$r-1],K$e._addMaterialToRenderElementOffset(K$e.combineRenderElementsCount),K$P=K$_._material,K$e._addCombineMaterial(K$P),K$e._addCombineRenderObj(K$_),K$n=!0,K$P!==(K$E=K$b._material)?(K$h=K$E,K$x=K$e.combineRenderElementsCount,K$Z=K$b):K$e._addCombineRenderObj(K$b),K$P=K$E}K$h&&(K$c.getRenderQueue(K$Z._material.renderQueue)._addRenderElement(K$Z),K$Z=K$h=null,K$x=-1),this._prepareDynamicBatchCombineElements.length=0},K$c._clearRenderElements=function(){for(var K$c in this._dynamicBatches)this._dynamicBatches[K$c]._clearRenderElements()},K$c._addToRenderQueue=function(K$c,K$P,K$q,K$_){for(var K$E in this._dynamicBatches){var K$b=this._dynamicBatches[K$E];0<K$b.combineRenderElementsCount&&K$b._addToRenderQueue(K$c,K$P,K$q,K$_)}},K$c.dispose=function(){this._dynamicBatches=null},K$T._sortPrepareDynamicBatch=function(K$c,K$P){return K$c._mainSortID-K$P._mainSortID},K$T}(),K$qc=function(){function K$c(){}return K$r(K$c,"laya.d3.graphics.FrustumCulling"),K$c.renderShadowObjectCulling=function(K$c,K$P,K$q,K$_,K$E){var K$b=0,K$e=0,K$h=0,K$Z=0;for(K$b=0,K$h=K$q.length;K$b<K$h;K$b++){var K$S=K$q[K$b];K$S&&K$S._clearRenderElements()}var K$n,K$k,K$x,K$r=K$c._cullingRenders;if(1<K$E){for(K$b=0,K$h=K$c._cullingRendersLength;K$b<K$h;K$b++)if((K$n=K$r[K$b]).castShadow&&K$$.isVisible(K$n._owner.layer.mask)&&K$n.enable)for(var K$g=1,K$W=K$P.length;K$g<K$W;K$g++)if(K$k=K$q[K$g-1],0!==K$P[K$g].containsBoundSphere(K$n.boundingSphere))for(K$e=0,K$Z=(K$x=K$n._renderElements).length;K$e<K$Z;K$e++)K$k._addRenderElement(K$x[K$e])}else for(K$b=0,K$h=K$c._cullingRendersLength;K$b<K$h;K$b++)if((K$n=K$r[K$b]).castShadow&&K$$.isVisible(K$n._owner.layer.mask)&&K$n.enable&&0!==K$P[0].containsBoundSphere(K$n.boundingSphere))for(K$n._renderUpdate(K$_),K$k=K$q[0],K$e=0,K$Z=(K$x=K$n._renderElements).length;K$e<K$Z;K$e++)K$k._addRenderElement(K$x[K$e])},K$c.renderShadowObjectCullingOctree=function(K$c,K$P,K$q,K$_,K$E){for(var K$b=0,K$e=K$q.length;K$b<K$e;K$b++){var K$h=K$q[K$b];K$h&&K$h._clearRenderElements()}1<K$E?K$c.treeRoot.cullingShadowObjects(K$P,K$q,!0,0,K$c):K$c.treeRoot.cullingShadowObjectsOnePSSM(K$P[0],K$q,K$_,!0,0,K$c)},K$c.renderObjectCulling=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=0,K$h=0,K$Z=0,K$S=0,K$n=K$P._quenes,K$k=K$P._dynamicBatchManager,K$x=K$P._cullingRenders;for(K$e=0,K$h=K$n.length;K$e<K$h;K$e++){var K$r=K$n[K$e];K$r&&K$r._clearRenderElements()}var K$g=K$_c._staticBatchManagers;for(K$e=0,K$h=K$g.length;K$e<K$h;K$e++)K$g[K$e]._clearRenderElements();K$k._clearRenderElements();var K$W=K$q.transform.position;for(K$e=0,K$h=K$P._cullingRendersLength;K$e<K$h;K$e++){var K$w=K$x[K$e];if(K$$.isVisible(K$w._owner.layer.mask)&&K$w.enable&&0!==K$c.containsBoundSphere(K$w.boundingSphere)&&K$w._renderUpdate(K$b)){K$w._distanceForSort=K$eP.distance(K$w.boundingSphere.center,K$W)+K$w.sortingFudge;var K$O=K$w._renderElements;for(K$Z=0,K$S=K$O.length;K$Z<K$S;K$Z++){var K$N=K$O[K$Z],K$m=K$N._staticBatch;if(K$m&&K$m._material===K$N._material)K$m._addBatchRenderElement(K$N);else{var K$T=K$N.renderObj;K$T.triangleCount<10&&1===K$T._vertexBufferCount&&K$T._getIndexBuffer()&&K$N._material.renderQueue<2&&K$N._canDynamicBatch&&!K$w._owner.isStatic?K$k._addPrepareRenderElement(K$N):K$P.getRenderQueue(K$N._material.renderQueue)._addRenderElement(K$N)}}}}for(K$e=0,K$h=K$g.length;K$e<K$h;K$e++)K$g[K$e]._addToRenderQueue(K$P,K$_,K$E,K$b);K$k._finishCombineDynamicBatch(K$P),K$k._addToRenderQueue(K$P,K$_,K$E,K$b)},K$c.renderObjectCullingOctree=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=0,K$h=0,K$Z=K$P._quenes,K$S=K$P._dynamicBatchManager;for(K$e=0,K$h=K$Z.length;K$e<K$h;K$e++){var K$n=K$Z[K$e];K$n&&K$n._clearRenderElements()}var K$k=K$_c._staticBatchManagers;for(K$e=0,K$h=K$k.length;K$e<K$h;K$e++)K$k[K$e]._clearRenderElements();for(K$S._clearRenderElements(),K$P._cullingRenders.length=0,K$P.treeRoot.cullingObjects(K$c,!0,0,K$q.transform.position,K$b),K$e=0,K$h=K$k.length;K$e<K$h;K$e++)K$k[K$e]._addToRenderQueue(K$P,K$_,K$E,K$b);K$S._finishCombineDynamicBatch(K$P),K$S._addToRenderQueue(K$P,K$_,K$E,K$b)},K$c.renderObjectCullingNoBoundFrustum=function(K$c,K$P,K$q,K$_,K$E){var K$b=0,K$e=0,K$h=0,K$Z=0,K$S=K$c._quenes,K$n=K$c._dynamicBatchManager,K$k=K$c._cullingRenders;for(K$b=0,K$e=K$S.length;K$b<K$e;K$b++){var K$x=K$S[K$b];K$x&&K$x._clearRenderElements()}var K$r=K$_c._staticBatchManagers;for(K$b=0,K$e=K$r.length;K$b<K$e;K$b++)K$r[K$b]._clearRenderElements();K$n._clearRenderElements();var K$g=K$P.transform.position;for(K$b=0,K$e=K$c._cullingRendersLength;K$b<K$e;K$b++){var K$W=K$k[K$b];if(K$$.isVisible(K$W._owner.layer.mask)&&K$W.enable){K$W._renderUpdate(K$E),K$W._distanceForSort=K$eP.distance(K$W.boundingSphere.center,K$g)+K$W.sortingFudge;var K$w=K$W._renderElements;for(K$h=0,K$Z=K$w.length;K$h<K$Z;K$h++){var K$O=K$w[K$h],K$N=K$O._staticBatch;if(K$N&&K$N._material===K$O._material)K$N._addBatchRenderElement(K$O);else{var K$m=K$O.renderObj;K$m.triangleCount<10&&1===K$m._vertexBufferCount&&K$m._getIndexBuffer()&&K$O._material.renderQueue<2&&K$O._canDynamicBatch&&!K$W._owner.isStatic?K$n._addPrepareRenderElement(K$O):K$c.getRenderQueue(K$O._material.renderQueue)._addRenderElement(K$O)}}}}for(K$b=0,K$e=K$r.length;K$b<K$e;K$b++)K$r[K$b]._addToRenderQueue(K$c,K$q,K$_,K$E);K$n._finishCombineDynamicBatch(K$c),K$n._addToRenderQueue(K$c,K$q,K$_,K$E)},K$c}(),K$_c=function(){function K$b(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}K$r(K$b,"laya.d3.graphics.StaticBatchManager");var K$c=K$b.prototype;return K$c._finishInit=function(){for(var K$c in this._staticBatches)this._staticBatches[K$c]._finishInit();this._initBatchRenderElements.length=0},K$c._initStaticBatchs=function(K$c){throw new Error("StaticBatchManager:must override this function.")},K$c._addInitBatchSprite=function(K$c){for(var K$P=K$c._render._renderElements,K$q=0,K$_=K$P.length;K$q<K$_;K$q++)this._initBatchRenderElements.push(K$P[K$q])},K$c._clearRenderElements=function(){for(var K$c in this._staticBatches)this._staticBatches[K$c]._clearRenderElements()},K$c._garbageCollection=function(K$c){var K$P=K$c._staticBatch,K$q=K$P._initBatchRenderElements,K$_=K$q.indexOf(K$c);K$q.splice(K$_,1),0===K$q.length&&(K$P.dispose(),delete this._staticBatches[K$P._key])},K$c._addToRenderQueue=function(K$c,K$P,K$q,K$_){for(var K$E in this._staticBatches){var K$b=this._staticBatches[K$E];0<K$b._batchRenderElements.length&&K$b._updateToRenderQueue(K$c,K$_)}},K$c.dispose=function(){this._staticBatches=null},K$b._addToStaticBatchQueue=function(K$c){K$c instanceof laya.d3.core.RenderableSprite3D&&K$c._addToInitStaticBatchManager();for(var K$P=0,K$q=K$c.numChildren;K$P<K$q;K$P++)K$b._addToStaticBatchQueue(K$c._childs[K$P])},K$b.combine=function(K$c,K$P){var K$q,K$_=0,K$E=0;if(K$P)for(K$_=0,K$E=K$P.length;K$_<K$E;K$_++){K$P[K$_]._addToInitStaticBatchManager()}else K$c&&K$b._addToStaticBatchQueue(K$c);for(K$_=0,K$E=K$b._staticBatchManagers.length;K$_<K$E;K$_++)(K$q=K$b._staticBatchManagers[K$_])._initStaticBatchs(K$c),K$q._finishInit()},K$b._staticBatchManagers=[],K$b}(),K$Ec=function(){function K$c(K$c,K$P,K$q){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=K$c,this._manager=K$P,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=K$q}K$r(K$c,"laya.d3.graphics.StaticBatch");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),K$P._binarySearch=function(K$c){for(var K$P=0,K$q=this._batchRenderElements.length-1,K$_=0;K$P<=K$q;)K$_=Math.floor((K$P+K$q)/2),this._compareBatchRenderElement(this._batchRenderElements[K$_],K$c)?K$q=K$_-1:K$P=K$_+1;return K$P},K$P._compareBatchRenderElement=function(K$c,K$P){throw new Error("StaticBatch:must override this function.")},K$P._getVertexDecLightMap=function(K$c){return K$c===K$Yc.vertexDeclaration?K$$c.vertexDeclaration:K$c===K$ac.vertexDeclaration?K$Rc.vertexDeclaration:K$c===K$dc.vertexDeclaration?K$Tc.vertexDeclaration:K$c===K$vc.vertexDeclaration?null:K$c===K$Wc.vertexDeclaration?K$wc.vertexDeclaration:K$c===K$Uc.vertexDeclaration?K$Fc.vertexDeclaration:K$c===K$jc.vertexDeclaration?K$Vc.vertexDeclaration:K$c===K$sc.vertexDeclaration?K$Cc.vertexDeclaration:K$c===K$ac.vertexDeclaration?K$Rc.vertexDeclaration:K$c===K$uc.vertexDeclaration?K$Dc.vertexDeclaration:K$c===K$vc.vertexDeclaration?null:K$c===K$Wc.vertexDeclaration?K$wc.vertexDeclaration:K$c===K$Ic.vertexDeclaration?K$oc.vertexDeclaration:K$c===K$jc.vertexDeclaration?K$Vc.vertexDeclaration:K$c},K$P._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},K$P._addBatchRenderElement=function(K$c){this._batchRenderElements.splice(this._binarySearch(K$c),0,K$c)},K$P._updateToRenderQueue=function(K$c,K$P){this._combineRenderElementPoolIndex=0,this._getRenderElement(K$c.getRenderQueue(this._material.renderQueue)._renderElements,K$c,K$P)},K$P._getRenderElement=function(K$c,K$P,K$q){throw new Error("StaticBatch:must override this function.")},K$P._finishInit=function(){throw new Error("StaticBatch:must override this function.")},K$P._clearRenderElements=function(){this._batchRenderElements.length=0},K$P.dispose=function(){},K$P._getVertexBuffer=function(K$c){return void 0===K$c&&(K$c=0),null},K$P._getIndexBuffer=function(){return null},K$P._beforeRender=function(K$c){return!0},K$P._render=function(K$c){},K$P._getVertexBuffers=function(){return null},K$g(0,K$P,"_vertexBufferCount",function(){return 1}),K$g(0,K$P,"triangleCount",function(){return 0}),K$c.combine=function(K$c){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),K$_c.combine(K$c)},K$c.maxBatchVertexCount=65535,K$c}(),K$bc=function(){function K$e(K$c,K$P){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++K$e._uniqueIDCounter,this._id>K$e.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",K$e.maxVertexDeclaration);this._shaderValues=new K$xP,this._vertexElementsDic={},this._vertexStride=K$c,this._vertexElements=K$P;for(var K$q=0;K$q<K$P.length;K$q++){var K$_=K$P[K$q],K$E=K$_.elementUsage;this._vertexElementsDic[K$E]=K$_;var K$b=[K$e._getTypeSize(K$_.elementFormat)/4,5126,!1,this._vertexStride,K$_.offset];switch(this._shaderValues.setValue(K$E,K$b),K$E){case 1:this._addShaderDefine(K$QP.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(K$QP.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(K$QP.SHADERDEFINE_UV1)}}}K$r(K$e,"laya.d3.graphics.VertexDeclaration");var K$c=K$e.prototype;return K$c._addShaderDefine=function(K$c){this._shaderDefineValue|=K$c},K$c._removeShaderDefine=function(K$c){this._shaderDefineValue&=~K$c},K$c.getVertexElements=function(){return this._vertexElements.slice()},K$c.getVertexElementByUsage=function(K$c){return this._vertexElementsDic[K$c]},K$c.unBinding=function(){},K$g(0,K$c,"shaderDefineValue",function(){return this._shaderDefineValue}),K$g(0,K$c,"id",function(){return this._id}),K$g(0,K$c,"vertexStride",function(){return this._vertexStride}),K$g(0,K$c,"shaderValues",function(){return this._shaderValues}),K$e._getTypeSize=function(K$c){switch(K$c){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},K$e.getVertexStride=function(K$c){for(var K$P=0,K$q=0;K$q<K$c.Length;K$q++){var K$_=K$c[K$q],K$E=K$_.offset+K$e._getTypeSize(K$_.elementFormat);K$P<K$E&&(K$P=K$E)}return K$P},K$e._maxVertexDeclarationBit=1e3,K$e._uniqueIDCounter=1,K$k(K$e,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),K$e}(),K$ec=function(){function K$c(K$c,K$P,K$q){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=K$c,this.elementFormat=K$P,this.elementUsage=K$q}return K$r(K$c,"laya.d3.graphics.VertexElement"),K$c}(),K$hc=(function(){function K$c(){}K$r(K$c,"laya.d3.graphics.VertexElementFormat"),K$c.Single="single",K$c.Vector2="vector2",K$c.Vector3="vector3",K$c.Vector4="vector4",K$c.Color="color",K$c.Byte4="byte4",K$c.Short2="short2",K$c.Short4="short4",K$c.NormalizedShort2="normalizedshort2",K$c.NormalizedShort4="normalizedshort4",K$c.HalfVector2="halfvector2",K$c.HalfVector4="halfvector4"}(),function(){function K$c(){}K$r(K$c,"laya.d3.graphics.VertexElementUsage"),K$c.POSITION0=0,K$c.COLOR0=1,K$c.TEXTURECOORDINATE0=2,K$c.NORMAL0=3,K$c.BINORMAL0=4,K$c.TANGENT0=5,K$c.BLENDINDICES0=6,K$c.BLENDWEIGHT0=7,K$c.DEPTH0=8,K$c.FOG0=9,K$c.POINTSIZE0=10,K$c.SAMPLE0=11,K$c.TESSELLATEFACTOR0=12,K$c.COLOR1=13,K$c.NEXTTEXTURECOORDINATE0=14,K$c.TEXTURECOORDINATE1=15,K$c.NEXTTEXTURECOORDINATE1=16,K$c.CORNERTEXTURECOORDINATE0=17,K$c.VELOCITY0=18,K$c.STARTCOLOR0=19,K$c.STARTSIZE=20,K$c.AGEADDSCALE0=21,K$c.STARTROTATION=22,K$c.ENDCOLOR0=23,K$c.STARTLIFETIME=24,K$c.TIME0=33,K$c.SHAPEPOSITIONSTARTLIFETIME=30,K$c.DIRECTIONTIME=32,K$c.SIZEROTATION0=27,K$c.RADIUS0=28,K$c.RADIAN0=29,K$c.STARTSPEED=31,K$c.RANDOM0=34,K$c.RANDOM1=35,K$c.SIMULATIONWORLDPOSTION=36,K$c.SIMULATIONWORLDROTATION=37,K$c.TEXTURECOORDINATE0X=38,K$c.TEXTURECOORDINATE0X1=39,K$c.TEXTURECOORDINATE0Y=40,K$c.OFFSETVECTOR=41}(),function(){function K$c(K$c,K$P,K$q){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=K$c,this._textureCoordinate0=K$P,this._time=K$q}K$r(K$c,"laya.d3.graphics.VertexGlitter");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate0}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"time",function(){return this._time}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(24,[new K$ec(0,"vector3",0),new K$ec(12,"vector2",2),new K$ec(20,"single",33)])}])}(),function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=K$c,this._position=K$P,this._velocity=K$q,this._startColor=K$_,this._endColor=K$E,this._sizeRotation=K$b,this._radius=K$e,this._radian=K$h,this._ageAddScale=K$Z,this._time=K$S}K$r(K$c,"laya.d3.graphics.VertexParticle");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"endColor",function(){return this._endColor}),K$g(0,K$P,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),K$g(0,K$P,"sizeRotation",function(){return this._sizeRotation}),K$g(0,K$P,"velocity",function(){return this._velocity}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"startColor",function(){return this._startColor}),K$g(0,K$P,"radius",function(){return this._radius}),K$g(0,K$P,"radian",function(){return this._radian}),K$g(0,K$P,"ageAddScale",function(){return this._ageAddScale}),K$g(0,K$P,"time",function(){return this._time}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(116,[new K$ec(0,"vector4",17),new K$ec(16,"vector3",0),new K$ec(28,"vector3",18),new K$ec(40,"vector4",19),new K$ec(56,"vector4",23),new K$ec(72,"vector3",27),new K$ec(84,"vector2",28),new K$ec(92,"vector4",29),new K$ec(108,"single",24),new K$ec(112,"single",33)])}])}(),function(){function K$c(K$c){this._position=null,this._position=K$c}K$r(K$c,"laya.d3.graphics.VertexPosition");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(12,[new K$ec(0,"vector3",0)])}]),K$c}()),K$Zc=function(){function K$c(K$c,K$P){this._position=null,this._normal=null,this._position=K$c,this._normal=K$P}K$r(K$c,"laya.d3.graphics.VertexPositionNormal");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(24,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3)])}]),K$c}(),K$Sc=function(){function K$c(K$c,K$P,K$q){this._position=null,this._normal=null,this._color=null,this._position=K$c,this._normal=K$P,this._color=K$q}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColor");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(40,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1)])}]),K$c}(),K$nc=function(){function K$c(K$c,K$P,K$q,K$_,K$E){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._blendIndex=K$_,this._blendWeight=K$E}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorSkin");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(72,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector4",7),new K$ec(56,"vector4",6)])}]),K$c}(),K$kc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._tangent=K$_,this._blendIndex=K$E,this._blendWeight=K$b}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(88,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector4",7),new K$ec(56,"vector4",6),new K$ec(72,"vector4",5)])}]),K$c}(),K$xc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._tangent=K$_,this._blendIndex=K$E,this._blendWeight=K$b}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(84,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector4",7),new K$ec(56,"vector4",6),new K$ec(72,"vector3",5)])}]),K$c}(),K$rc=function(){function K$c(K$c,K$P,K$q,K$_){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._tangent=K$_}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorSTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(56,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector4",5)])}]),K$c}(),K$gc=function(){function K$c(K$c,K$P,K$q,K$_){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._tangent=K$_}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(52,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector3",5)])}]),K$c}(),K$Wc=function(){function K$c(K$c,K$P,K$q,K$_){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._textureCoordinate=K$_}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTexture");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(48,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector2",2)])}]),K$c}(),K$wc=function(){function K$c(K$c,K$P,K$q,K$_,K$E){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._textureCoordinate0=K$_,this._textureCoordinate1=K$E}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(56,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector2",2),new K$ec(48,"vector2",15)])}]),K$c}(),K$Oc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._textureCoordinate0=K$_,this._textureCoordinate1=K$E,this._blendIndex=K$b,this._blendWeight=K$e}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(88,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector2",2),new K$ec(48,"vector2",15),new K$ec(56,"vector4",7),new K$ec(72,"vector4",6)])}]),K$c}(),K$Nc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._textureCoordinate0=K$_,this._textureCoordinate1=K$E,this._tangent=K$b,this._blendIndex=K$e,this._blendWeight=K$h}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(104,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector2",2),new K$ec(48,"vector2",15),new K$ec(56,"vector4",7),new K$ec(72,"vector4",6),new K$ec(88,"vector4",5)])}]),K$c}(),K$mc=function(){function K$c(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$P.VertexPositionNormalColorTexture0SkinTangent=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){this._position=K$c,this._normal=K$P,this._color=K$q,this._textureCoordinate0=K$_,this._textureCoordinate1=K$E,this._tangent=K$b,this._blendIndex=K$e,this._blendWeight=K$h},K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(100,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector2",2),new K$ec(48,"vector2",15),new K$ec(56,"vector4",7),new K$ec(72,"vector4",6),new K$ec(88,"vector3",5)])}]),K$c}(),K$Tc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._textureCoordinate0=K$_,this._textureCoordinate1=K$E,this._tangent=K$b}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(72,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector2",2),new K$ec(48,"vector2",15),new K$ec(56,"vector4",5)])}]),K$c}(),K$Dc=function(){function K$c(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$P.VertexPositionNormalColorTexture0Tangent=function(K$c,K$P,K$q,K$_,K$E,K$b){this._position=K$c,this._normal=K$P,this._color=K$q,this._textureCoordinate0=K$_,this._textureCoordinate1=K$E,this._tangent=K$b},K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(68,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector2",2),new K$ec(48,"vector2",15),new K$ec(56,"vector3",5)])}]),K$c}(),K$Lc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._textureCoordinate=K$_,this._blendIndex=K$E,this._blendWeight=K$b}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(80,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector2",2),new K$ec(48,"vector4",7),new K$ec(64,"vector4",6)])}]),K$c}(),K$Hc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._textureCoordinate=K$_,this._tangent=K$E,this._blendIndex=K$b,this._blendWeight=K$e}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(96,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector2",2),new K$ec(48,"vector4",7),new K$ec(64,"vector4",6),new K$ec(80,"vector4",5)])}]),K$c}(),K$Qc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._textureCoordinate=K$_,this._tangent=K$E,this._blendIndex=K$b,this._blendWeight=K$e}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(92,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector2",2),new K$ec(48,"vector4",7),new K$ec(64,"vector4",6),new K$ec(80,"vector3",5)])}]),K$c}(),K$dc=function(){function K$c(K$c,K$P,K$q,K$_,K$E){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._textureCoordinate=K$_,this._tangent=K$E}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(64,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector2",2),new K$ec(48,"vector4",5)])}]),K$c}(),K$uc=function(){function K$c(K$c,K$P,K$q,K$_,K$E){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._color=K$q,this._textureCoordinate=K$_,this._tangent=K$E}K$r(K$c,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"color",function(){return this._color}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(60,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",1),new K$ec(40,"vector2",2),new K$ec(48,"vector3",5)])}]),K$c}(),K$Ac=function(){function K$c(K$c,K$P,K$q){this._position=null,this._normal=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._tangent=K$q}K$r(K$c,"laya.d3.graphics.VertexPositionNormalSTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(40,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector4",5)])}]),K$c}(),K$Jc=function(){function K$c(K$c,K$P,K$q){this._position=null,this._normal=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._tangent=K$q}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(36,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector3",5)])}]),K$c}(),K$jc=function(){function K$c(K$c,K$P,K$q){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=K$c,this._normal=K$P,this._textureCoordinate=K$q}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTexture");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(32,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2)])}]),K$c}(),K$Vc=function(){function K$c(K$c,K$P,K$q,K$_){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=K$c,this._normal=K$P,this._textureCoordinate0=K$q,this._textureCoordinate1=K$_}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(40,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2),new K$ec(32,"vector2",15)])}]),K$c}(),K$Rc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=K$c,this._normal=K$P,this._textureCoordinate0=K$q,this._textureCoordinate1=K$_,this._blendIndex=K$E,this._blendWeight=K$b}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(72,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2),new K$ec(32,"vector2",15),new K$ec(40,"vector4",7),new K$ec(56,"vector4",6)])}]),K$c}(),K$$c=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._textureCoordinate0=K$q,this._textureCoordinate1=K$_,this._tangent=K$E,this._blendIndex=K$b,this._blendWeight=K$e}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(88,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2),new K$ec(32,"vector2",15),new K$ec(40,"vector4",7),new K$ec(56,"vector4",6),new K$ec(72,"vector4",5)])}]),K$c}(),K$Cc=function(){function K$c(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$P.VertexPositionNormalTexture0SkinTangent=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){this._position=K$c,this._normal=K$P,this._textureCoordinate0=K$q,this._textureCoordinate1=K$_,this._tangent=K$E,this._blendIndex=K$b,this._blendWeight=K$e},K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(84,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2),new K$ec(32,"vector2",15),new K$ec(40,"vector4",7),new K$ec(56,"vector4",6),new K$ec(72,"vector3",5)])}]),K$c}(),K$Fc=function(){function K$c(K$c,K$P,K$q,K$_,K$E){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._textureCoordinate0=K$q,this._textureCoordinate1=K$_,this._tangent=K$E}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(56,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2),new K$ec(32,"vector2",15),new K$ec(40,"vector4",5)])}]),K$c}(),K$oc=function(){function K$c(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$P.VertexPositionNormalTexture0Tangent=function(K$c,K$P,K$q,K$_,K$E){this._position=K$c,this._normal=K$P,this._textureCoordinate0=K$q,this._textureCoordinate1=K$_,this._tangent=K$E},K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(52,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2),new K$ec(32,"vector2",15),new K$ec(40,"vector3",5)])}]),K$c}(),K$ac=function(){function K$c(K$c,K$P,K$q,K$_,K$E){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=K$c,this._normal=K$P,this._textureCoordinate=K$q,this._blendIndex=K$_,this._blendWeight=K$E}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTextureSkin");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(64,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2),new K$ec(32,"vector4",7),new K$ec(48,"vector4",6)])}]),K$c}(),K$Yc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._textureCoordinate=K$q,this._tangent=K$_,this._blendIndex=K$E,this._blendWeight=K$b}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(80,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2),new K$ec(32,"vector4",7),new K$ec(48,"vector4",6),new K$ec(64,"vector4",5)])}]),K$c}(),K$sc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._textureCoordinate=K$q,this._tangent=K$_,this._blendIndex=K$E,this._blendWeight=K$b}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(76,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2),new K$ec(32,"vector4",7),new K$ec(48,"vector4",6),new K$ec(64,"vector3",5)])}]),K$c}(),K$Uc=function(){function K$c(K$c,K$P,K$q,K$_){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._textureCoordinate=K$q,this._tangent=K$_}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(48,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2),new K$ec(32,"vector4",5)])}]),K$c}(),K$Ic=function(){function K$c(K$c,K$P,K$q,K$_){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=K$c,this._normal=K$P,this._textureCoordinate=K$q,this._tangent=K$_}K$r(K$c,"laya.d3.graphics.VertexPositionNormalTextureTangent");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(44,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2),new K$ec(32,"vector3",5)])}]),K$c}(),K$vc=function(){function K$c(K$c,K$P,K$q){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=K$c,this._normal=K$P,this._textureCoordinate=K$q}K$r(K$c,"laya.d3.graphics.VertexPositionNTBTexture");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(56,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector3",5),new K$ec(36,"vector3",4),new K$ec(48,"vector2",2)])}]),K$c}(),K$yc=function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=K$c,this._normal=K$P,this._textureCoordinate0=K$_,this._textureCoordinate1=K$E,this._tangent=K$b,K$q=K$q,this._blendIndex=K$e,this._blendWeight=K$h}K$r(K$c,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"tangent",function(){return this._tangent}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(0,K$P,"textureCoordinate1",function(){return this._textureCoordinate1}),K$g(0,K$P,"blendIndex",function(){return this._blendIndex}),K$g(0,K$P,"blendWeight",function(){return this._blendWeight}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(96,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector3",5),new K$ec(36,"vector3",4),new K$ec(48,"vector2",2),new K$ec(56,"vector2",15),new K$ec(64,"vector4",7),new K$ec(80,"vector4",6)])}]),K$c}(),K$Mc=function(){function K$c(K$c,K$P,K$q){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=K$c,this._normal=K$P,this._textureCoordinate=K$q}K$r(K$c,"laya.d3.graphics.VertexPositionNTBTextureSkin");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"textureCoordinate",function(){return this._textureCoordinate}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(88,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector3",5),new K$ec(36,"vector3",4),new K$ec(48,"vector2",2),new K$ec(56,"vector4",7),new K$ec(72,"vector4",6)])}]),K$c}(),K$zc=(function(){function K$c(K$c,K$P,K$q,K$_){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=K$c,this._normal=K$P,this._textureCoord0=K$q,this._textureCoord1=K$_}K$r(K$c,"laya.d3.graphics.VertexPositionTerrain");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"normal",function(){return this._normal}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"textureCoord0",function(){return this._textureCoord0}),K$g(0,K$P,"textureCoord1",function(){return this._textureCoord1}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(40,[new K$ec(0,"vector3",0),new K$ec(12,"vector3",3),new K$ec(24,"vector2",2),new K$ec(32,"vector2",15)])}])}(),function(){function K$c(K$c,K$P){this._position=null,this._textureCoordinate0=null,this._position=K$c,this._textureCoordinate0=K$P}K$r(K$c,"laya.d3.graphics.VertexPositionTexture0");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"position",function(){return this._position}),K$g(0,K$P,"textureCoordinate0",function(){return this._textureCoordinate0}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(20,[new K$ec(0,"vector3",0),new K$ec(12,"vector2",2)])}]),K$c}()),K$Xc=(function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$k,K$x,K$r){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=K$c,this._positionStartLifeTime=K$P,this._velocity=K$q,this._startColor=K$_,this._startSize=K$E,this._startRotation0=K$b,this._startRotation1=K$e,this._startRotation2=K$h,this._startLifeTime=K$Z,this._time=K$S,this._startSpeed=K$n,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=K$r}K$r(K$c,"laya.d3.graphics.VertexShurikenParticleBillboard");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),K$g(0,K$P,"random1",function(){return this._randoms1}),K$g(0,K$P,"startRotation2",function(){return this._startRotation2}),K$g(0,K$P,"positionStartLifeTime",function(){return this._positionStartLifeTime}),K$g(0,K$P,"velocity",function(){return this._velocity}),K$g(0,K$P,"random0",function(){return this._randoms0}),K$g(0,K$P,"startSize",function(){return this._startSize}),K$g(0,K$P,"startColor",function(){return this._startColor}),K$g(0,K$P,"startRotation0",function(){return this._startRotation0}),K$g(0,K$P,"startRotation1",function(){return this._startRotation1}),K$g(0,K$P,"startLifeTime",function(){return this._startLifeTime}),K$g(0,K$P,"time",function(){return this._time}),K$g(0,K$P,"startSpeed",function(){return this._startSpeed}),K$g(0,K$P,"simulationWorldPostion",function(){return this._simulationWorldPostion}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(152,[new K$ec(0,"vector4",17),new K$ec(16,"vector4",30),new K$ec(32,"vector4",32),new K$ec(48,"vector4",19),new K$ec(64,"vector3",20),new K$ec(76,"vector3",22),new K$ec(88,"single",31),new K$ec(92,"vector4",34),new K$ec(108,"vector4",35),new K$ec(124,"vector3",36),new K$ec(136,"vector4",37)])}])}(),function(){function K$c(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$k,K$x,K$r){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=K$c,this._positionStartLifeTime=K$P,this._velocity=K$q,this._startColor=K$_,this._startSize=K$E,this._startRotation0=K$b,this._startRotation1=K$e,this._startRotation2=K$h,this._startLifeTime=K$Z,this._time=K$S,this._startSpeed=K$n,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=K$r}K$r(K$c,"laya.d3.graphics.VertexShurikenParticleMesh");var K$P=K$c.prototype;K$D.imps(K$P,{"laya.d3.graphics.IVertex":!0}),K$g(0,K$P,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),K$g(0,K$P,"velocity",function(){return this._velocity}),K$g(0,K$P,"position",function(){return this._positionStartLifeTime}),K$g(0,K$P,"random0",function(){return this._randoms0}),K$g(0,K$P,"startSize",function(){return this._startSize}),K$g(0,K$P,"startColor",function(){return this._startColor}),K$g(0,K$P,"startRotation0",function(){return this._startRotation0}),K$g(0,K$P,"startRotation1",function(){return this._startRotation1}),K$g(0,K$P,"random1",function(){return this._randoms1}),K$g(0,K$P,"startRotation2",function(){return this._startRotation2}),K$g(0,K$P,"startLifeTime",function(){return this._startLifeTime}),K$g(0,K$P,"time",function(){return this._time}),K$g(0,K$P,"startSpeed",function(){return this._startSpeed}),K$g(0,K$P,"simulationWorldPostion",function(){return this._simulationWorldPostion}),K$g(0,K$P,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$g(1,K$c,"vertexDeclaration",function(){return K$c._vertexDeclaration}),K$k(K$c,["_vertexDeclaration",function(){return this._vertexDeclaration=new K$bc(172,[new K$ec(0,"vector3",0),new K$ec(12,"vector4",1),new K$ec(28,"vector2",2),new K$ec(36,"vector4",30),new K$ec(52,"vector4",32),new K$ec(68,"vector4",19),new K$ec(84,"vector3",20),new K$ec(96,"vector3",22),new K$ec(108,"single",31),new K$ec(112,"vector4",34),new K$ec(128,"vector4",35),new K$ec(144,"vector3",36),new K$ec(156,"vector4",37)])}])}(),function(){function K$m(K$c,K$P,K$q,K$_,K$E,K$b){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=K$q,this._materials=K$_,this._subMeshes=K$E,this._materialMap=K$b,this._version=K$P,this._onLoaded(K$c)}K$r(K$m,"laya.d3.loaders.LoadModelV01");var K$c=K$m.prototype;return K$c._onLoaded=function(K$c){this._readData=K$c,this.READ_BLOCK();for(var K$P=0;K$P<this._BLOCK.count;K$P++){var K$q=this._readData.getUint16(),K$_=this._strings[K$q],K$E=this["READ_"+K$_];if(null==K$E)throw new Error("model file err,no this function:"+K$q+" "+K$_);if(!K$E.call(this))break}return this._mesh},K$c.onError=function(){},K$c._readString=function(){return this._strings[this._readData.getUint16()]},K$c.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},K$c.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},K$c.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var K$c=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var K$P=0;K$P<this._STRINGS.size;K$P++)this._strings[K$P]=this._readData.readUTFString();return this._readData.pos=K$c,!0},K$c.READ_MATERIAL=function(){var K$c=this._readData.getUint16(),K$P=(this._readString(),this._readString());return this._materials[K$c]="null"!==K$P?K$O.getRes(this._materialMap[K$P]):new K$JP,!0},K$c.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var K$c,K$P=this._readData.__getBuffer(),K$q=0,K$_=this._readData.getUint32(),K$E=this._readData.getUint32(),K$b=(new Float32Array(K$P.slice(K$_+this._DATA.offset,K$_+this._DATA.offset+K$E)),this._readData.getUint32()),K$e=this._readData.getUint32(),K$h=new Float32Array(K$P.slice(K$b+this._DATA.offset,K$b+this._DATA.offset+K$e));for(this.mesh._inverseBindPoses=[],K$q=0,K$c=K$h.length;K$q<K$c;K$q+=16){var K$Z=new K$cP(K$h[K$q+0],K$h[K$q+1],K$h[K$q+2],K$h[K$q+3],K$h[K$q+4],K$h[K$q+5],K$h[K$q+6],K$h[K$q+7],K$h[K$q+8],K$h[K$q+9],K$h[K$q+10],K$h[K$q+11],K$h[K$q+12],K$h[K$q+13],K$h[K$q+14],K$h[K$q+15]);this.mesh._inverseBindPoses.push(K$Z)}break;default:throw new Error("LoadModel:unknown version.")}return!0},K$c.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var K$c=this._readString();this._shaderAttributes=K$c.match(K$m._attrReg);var K$P=this._readData.getUint32(),K$q=this._readData.getUint32(),K$_=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),K$E=this._readData.getUint32(),K$b=this._readData.getUint32(),K$e=this._readData.getUint32(),K$h=this._readData.__getBuffer(),K$Z=new K$SP(this._mesh),K$S=this._getVertexDeclaration(),K$n=K$sP.create(K$S,K$E/K$S.vertexStride,35044,!0),K$k=K$_+this._DATA.offset,K$x=K$h.slice(K$k,K$k+K$E);K$n.setData(new Float32Array(K$x));for(var K$r=(K$Z._vertexBuffer=K$n).vertexDeclaration.getVertexElements(),K$g=0;K$g<K$r.length;K$g++)K$Z._bufferUsage[K$r[K$g].elementUsage]=K$n;var K$W=K$YP.create("ushort",K$q/2,35044,!0),K$w=K$P+this._DATA.offset,K$O=K$h.slice(K$w,K$w+K$q);K$W.setData(new Uint16Array(K$O)),K$Z._indexBuffer=K$W;var K$N=K$h.slice(K$b+this._DATA.offset,K$b+this._DATA.offset+K$e);return K$Z._boneIndicesList[0]=new Uint8Array(K$N),this._subMeshes.push(K$Z),!0},K$c.READ_DATAAREA=function(){return!1},K$c._getVertexDeclaration=function(){for(var K$c,K$P=!1,K$q=!1,K$_=!1,K$E=!1,K$b=!1,K$e=!1,K$h=!1,K$Z=!1,K$S=!1,K$n=0;K$n<this._shaderAttributes.length;K$n+=8)switch(this._shaderAttributes[K$n]){case"POSITION":K$P=!0;break;case"NORMAL":K$q=!0;break;case"COLOR":K$_=!0;break;case"UV":K$E=!0;break;case"UV1":K$b=!0;break;case"BLENDWEIGHT":K$h=!0;break;case"BLENDINDICES":K$Z=!0;break;case"TANGENT":K$e=!0;break;case"BINORMAL":K$S=!0}return K$P&&K$q&&K$_&&K$E&&K$b&&K$h&&K$Z&&K$e?K$c=K$mc.vertexDeclaration:K$P&&K$q&&K$_&&K$E&&K$b&&K$h&&K$Z?K$c=K$Oc.vertexDeclaration:K$P&&K$q&&K$E&&K$b&&K$h&&K$Z&&K$e?K$c=K$Cc.vertexDeclaration:K$P&&K$q&&K$E&&K$b&&K$h&&K$Z?K$c=K$Rc.vertexDeclaration:K$P&&K$q&&K$_&&K$E&&K$h&&K$Z&&K$e?K$c=K$Qc.vertexDeclaration:K$P&&K$q&&K$_&&K$E&&K$h&&K$Z?K$c=K$Lc.vertexDeclaration:K$P&&K$q&&K$e&&K$S&&K$E&&K$h&&K$Z?K$c=K$Mc.vertexDeclaration:K$P&&K$q&&K$E&&K$h&&K$Z&&K$e?K$c=K$sc.vertexDeclaration:K$P&&K$q&&K$E&&K$h&&K$Z?K$c=K$ac.vertexDeclaration:K$P&&K$q&&K$_&&K$h&&K$Z&&K$e?K$c=K$xc.vertexDeclaration:K$P&&K$q&&K$_&&K$h&&K$Z?K$c=K$nc.vertexDeclaration:K$P&&K$q&&K$_&&K$E&&K$b&&K$e?K$c=K$Dc.vertexDeclaration:K$P&&K$q&&K$_&&K$E&&K$b?K$c=K$wc.vertexDeclaration:K$P&&K$q&&K$E&&K$b&&K$e?K$c=K$oc.vertexDeclaration:K$P&&K$q&&K$E&&K$b?K$c=K$Vc.vertexDeclaration:K$P&&K$q&&K$_&&K$E&&K$e?K$c=K$uc.vertexDeclaration:K$P&&K$q&&K$E&&K$e&&K$S?K$c=K$vc.vertexDeclaration:K$P&&K$q&&K$_&&K$E?K$c=K$Wc.vertexDeclaration:K$P&&K$q&&K$E&&K$e?K$c=K$Ic.vertexDeclaration:K$P&&K$q&&K$E?K$c=K$jc.vertexDeclaration:K$P&&K$q&&K$_&&K$e?K$c=K$gc.vertexDeclaration:K$P&&K$q&&K$_&&(K$c=K$Sc.vertexDeclaration),K$c},K$g(0,K$c,"mesh",function(){return this._mesh}),K$m._attrReg=new RegExp("(\\w+)|([:,;])","g"),K$m}()),K$fc=function(){function K$H(){}return K$r(K$H,"laya.d3.loaders.LoadModelV02"),K$H.parse=function(K$c,K$P,K$q,K$_,K$E,K$b){K$H._mesh=K$q,K$H._materials=K$_,K$H._subMeshes=K$E,K$H._materialMap=K$b,K$H._version=K$P,K$H._readData=K$c,K$H.READ_DATA(),K$H.READ_BLOCK(),K$H.READ_STRINGS();for(var K$e=0,K$h=K$H._BLOCK.count;K$e<K$h;K$e++){K$H._readData.pos=K$H._BLOCK.blockStarts[K$e];var K$Z=K$H._readData.getUint16(),K$S=K$H._strings[K$Z],K$n=K$H["READ_"+K$S];if(null==K$n)throw new Error("model file err,no this function:"+K$Z+" "+K$S);K$n.call()}K$H._strings.length=0,K$H._readData=null,K$H._version=null,K$H._mesh=null,K$H._materials=null,K$H._subMeshes=null,K$H._materialMap=null},K$H._readString=function(){return K$H._strings[K$H._readData.getUint16()]},K$H.READ_DATA=function(){K$H._DATA.offset=K$H._readData.getUint32(),K$H._DATA.size=K$H._readData.getUint32()},K$H.READ_BLOCK=function(){for(var K$c=K$H._BLOCK.count=K$H._readData.getUint16(),K$P=K$H._BLOCK.blockStarts=[],K$q=K$H._BLOCK.blockLengths=[],K$_=0;K$_<K$c;K$_++)K$P.push(K$H._readData.getUint32()),K$q.push(K$H._readData.getUint32())},K$H.READ_STRINGS=function(){var K$c=K$H._readData.getUint32(),K$P=K$H._readData.getUint16(),K$q=K$H._readData.pos;K$H._readData.pos=K$c+K$H._DATA.offset;for(var K$_=0;K$_<K$P;K$_++)K$H._strings[K$_]=K$H._readData.readUTFString();K$H._readData.pos=K$q},K$H.READ_MATERIAL=function(){K$H._readString(),K$H._readString();var K$c=K$H._readString();return""!==K$c&&K$H._materials.push(K$O.getRes(K$H._materialMap[K$c])),!0},K$H.READ_MESH=function(){K$H._readString();var K$c,K$P=K$H._readData.__getBuffer(),K$q=0,K$_=K$H._readData.getInt16(),K$E=K$H._DATA.offset;for(K$q=0;K$q<K$_;K$q++){var K$b=K$E+K$H._readData.getUint32(),K$e=K$H._readData.getUint32(),K$h=new Float32Array(K$P.slice(K$b,K$b+K$e)),K$Z=K$H._readString().match(K$H._attrReg),K$S=K$H._getVertexDeclaration(K$Z),K$n=K$sP.create(K$S,4*K$h.length/K$S.vertexStride,35044,!0);K$n.setData(K$h),K$H._mesh._vertexBuffers.push(K$n)}var K$k=K$E+K$H._readData.getUint32(),K$x=K$H._readData.getUint32(),K$r=new Uint16Array(K$P.slice(K$k,K$k+K$x)),K$g=K$YP.create("ushort",K$x/2,35044,!0);K$g.setData(K$r),K$H._mesh._indexBuffer=K$g;var K$W=K$H._mesh._boneNames=[],K$w=K$H._readData.getUint16();for(K$W.length=K$w,K$q=0;K$q<K$w;K$q++)K$W[K$q]=K$H._strings[K$H._readData.getUint16()];var K$O=K$H._readData.getUint32(),K$N=K$H._readData.getUint32(),K$m=(new Float32Array(K$P.slice(K$E+K$O,K$E+K$O+K$N)),K$H._readData.getUint32()),K$T=K$H._readData.getUint32(),K$D=new Float32Array(K$P.slice(K$E+K$m,K$E+K$m+K$T));for(K$H._mesh._inverseBindPoses=[],K$q=0,K$c=K$D.length;K$q<K$c;K$q+=16){var K$L=new K$cP(K$D[K$q+0],K$D[K$q+1],K$D[K$q+2],K$D[K$q+3],K$D[K$q+4],K$D[K$q+5],K$D[K$q+6],K$D[K$q+7],K$D[K$q+8],K$D[K$q+9],K$D[K$q+10],K$D[K$q+11],K$D[K$q+12],K$D[K$q+13],K$D[K$q+14],K$D[K$q+15]);K$H._mesh._inverseBindPoses.push(K$L)}return K$H._mesh._skinnedDatas=new Float32Array(16*K$D.length),!0},K$H.READ_SUBMESH=function(){var K$c=K$H._readData.__getBuffer(),K$P=new K$SP(K$H._mesh),K$q=K$H._readData.getInt16(),K$_=K$H._readData.getUint32(),K$E=K$H._readData.getUint32();K$P._vertexBuffer=K$H._mesh._vertexBuffers[K$q],K$P._vertexStart=K$_,K$P._vertexCount=K$E;var K$b=K$H._readData.getUint32(),K$e=K$H._readData.getUint32(),K$h=K$H._mesh._indexBuffer;K$P._indexBuffer=K$h,K$P._indexStart=K$b,K$P._indexCount=K$e,K$P._indices=new Uint16Array(K$h.getData().buffer,2*K$b,K$e);var K$Z=K$H._DATA.offset,K$S=K$P._subIndexBufferStart,K$n=K$P._subIndexBufferCount,K$k=K$P._boneIndicesList,K$x=K$H._readData.getUint16();K$S.length=K$x,K$n.length=K$x,K$k.length=K$x;for(var K$r=0;K$r<K$x;K$r++){K$S[K$r]=K$H._readData.getUint32(),K$n[K$r]=K$H._readData.getUint32();var K$g=K$H._readData.getUint32(),K$W=K$H._readData.getUint32();K$P._boneIndicesList[K$r]=new Uint8Array(K$c.slice(K$Z+K$g,K$Z+K$g+K$W))}return K$H._subMeshes.push(K$P),!0},K$H._getVertexDeclaration=function(K$c){for(var K$P,K$q=!1,K$_=!1,K$E=!1,K$b=!1,K$e=!1,K$h=!1,K$Z=!1,K$S=!1,K$n=!1,K$k=0;K$k<K$c.length;K$k++)switch(K$c[K$k]){case"POSITION":K$q=!0;break;case"NORMAL":K$_=!0;break;case"COLOR":K$E=!0;break;case"UV":K$b=!0;break;case"UV1":K$e=!0;break;case"BLENDWEIGHT":K$Z=!0;break;case"BLENDINDICES":K$S=!0;break;case"TANGENT":K$h=!0;break;case"BINORMAL":K$n=!0}return K$q&&K$_&&K$E&&K$b&&K$e&&K$Z&&K$S&&K$h?K$P=K$mc.vertexDeclaration:K$q&&K$_&&K$E&&K$b&&K$e&&K$Z&&K$S?K$P=K$Oc.vertexDeclaration:K$q&&K$_&&K$b&&K$e&&K$Z&&K$S&&K$h?K$P=K$Cc.vertexDeclaration:K$q&&K$_&&K$b&&K$e&&K$Z&&K$S?K$P=K$Rc.vertexDeclaration:K$q&&K$_&&K$E&&K$b&&K$Z&&K$S&&K$h?K$P=K$Qc.vertexDeclaration:K$q&&K$_&&K$E&&K$b&&K$Z&&K$S?K$P=K$Lc.vertexDeclaration:K$q&&K$_&&K$b&&K$Z&&K$S&&K$h?K$P=K$sc.vertexDeclaration:K$q&&K$_&&K$b&&K$Z&&K$S?K$P=K$ac.vertexDeclaration:K$q&&K$_&&K$E&&K$Z&&K$S&&K$h?K$P=K$xc.vertexDeclaration:K$q&&K$_&&K$E&&K$Z&&K$S?K$P=K$nc.vertexDeclaration:K$q&&K$_&&K$E&&K$b&&K$e&&K$h?K$P=K$Dc.vertexDeclaration:K$q&&K$_&&K$E&&K$b&&K$e?K$P=K$wc.vertexDeclaration:K$q&&K$_&&K$b&&K$e&&K$h?K$P=K$oc.vertexDeclaration:K$q&&K$_&&K$b&&K$e?K$P=K$Vc.vertexDeclaration:K$q&&K$_&&K$E&&K$b&&K$h?K$P=K$uc.vertexDeclaration:K$q&&K$_&&K$b&&K$h&&K$n?K$P=K$vc.vertexDeclaration:K$q&&K$_&&K$E&&K$b?K$P=K$Wc.vertexDeclaration:K$q&&K$_&&K$b&&K$h?K$P=K$Ic.vertexDeclaration:K$q&&K$_&&K$b?K$P=K$jc.vertexDeclaration:K$q&&K$_&&K$E&&K$h?K$P=K$gc.vertexDeclaration:K$q&&K$_&&K$E&&(K$P=K$Sc.vertexDeclaration),K$P},K$H._attrReg=new RegExp("(\\w+)|([:,;])","g"),K$H._strings=[],K$H._readData=null,K$H._version=null,K$H._mesh=null,K$H._materials=null,K$H._subMeshes=null,K$H._materialMap=null,K$k(K$H,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),K$H}(),K$lc=function(){function K$L(){}return K$r(K$L,"laya.d3.loaders.LoadModelV03"),K$L.parse=function(K$c,K$P,K$q,K$_,K$E){K$L._mesh=K$q,K$L._subMeshes=K$_,K$L._materialMap=K$E,K$L._version=K$P,K$L._readData=K$c,K$L.READ_DATA(),K$L.READ_BLOCK(),K$L.READ_STRINGS();for(var K$b=0,K$e=K$L._BLOCK.count;K$b<K$e;K$b++){K$L._readData.pos=K$L._BLOCK.blockStarts[K$b];var K$h=K$L._readData.getUint16(),K$Z=K$L._strings[K$h],K$S=K$L["READ_"+K$Z];if(null==K$S)throw new Error("model file err,no this function:"+K$h+" "+K$Z);K$S.call()}K$L._strings.length=0,K$L._readData=null,K$L._version=null,K$L._mesh=null,K$L._subMeshes=null,K$L._materialMap=null},K$L._readString=function(){return K$L._strings[K$L._readData.getUint16()]},K$L.READ_DATA=function(){K$L._DATA.offset=K$L._readData.getUint32(),K$L._DATA.size=K$L._readData.getUint32()},K$L.READ_BLOCK=function(){for(var K$c=K$L._BLOCK.count=K$L._readData.getUint16(),K$P=K$L._BLOCK.blockStarts=[],K$q=K$L._BLOCK.blockLengths=[],K$_=0;K$_<K$c;K$_++)K$P.push(K$L._readData.getUint32()),K$q.push(K$L._readData.getUint32())},K$L.READ_STRINGS=function(){var K$c=K$L._readData.getUint32(),K$P=K$L._readData.getUint16(),K$q=K$L._readData.pos;K$L._readData.pos=K$c+K$L._DATA.offset;for(var K$_=0;K$_<K$P;K$_++)K$L._strings[K$_]=K$L._readData.readUTFString();K$L._readData.pos=K$q},K$L.READ_MESH=function(){var K$c,K$P=K$L._readString(),K$q=K$L._readData.__getBuffer(),K$_=0,K$E=K$L._readData.getInt16(),K$b=K$L._DATA.offset;for(K$_=0;K$_<K$E;K$_++){var K$e,K$h=K$b+K$L._readData.getUint32(),K$Z=K$L._readData.getUint32(),K$S=new Float32Array(K$q.slice(K$h,K$h+K$Z)),K$n=K$L._readString();switch(K$L._version){case"LAYAMODEL:03":K$e=K$L._vertexDeclarationMap_Discard[K$n];break;case"LAYAMODEL:0301":K$e=K$L._vertexDeclarationMap[K$n];break;default:throw new Error("LoadModelV03: unknown version.")}if(!K$e)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+K$L._version+"  bufferAttribute="+K$n+"  name="+K$P+"  url="+(K$L._mesh?K$L._mesh.url:"null"));var K$k=K$sP.create(K$e,4*K$S.length/K$e.vertexStride,35044,!0,K$L._mesh._url+"_"+K$_);K$k.setData(K$S),K$L._mesh._vertexBuffers.push(K$k)}var K$x=K$b+K$L._readData.getUint32(),K$r=K$L._readData.getUint32(),K$g=new Uint16Array(K$q.slice(K$x,K$x+K$r)),K$W=K$YP.create("ushort",K$r/2,35044,!0,K$L._mesh._url);K$W.setData(K$g),K$L._mesh._indexBuffer=K$W;var K$w=K$L._mesh._boneNames=[],K$O=K$L._readData.getUint16();for(K$w.length=K$O,K$_=0;K$_<K$O;K$_++)K$w[K$_]=K$L._strings[K$L._readData.getUint16()];K$L._readData.pos+=8;var K$N=K$L._readData.getUint32(),K$m=K$L._readData.getUint32(),K$T=new Float32Array(K$q.slice(K$b+K$N,K$b+K$N+K$m));for(K$L._mesh._inverseBindPoses=[],K$_=0,K$c=K$T.length;K$_<K$c;K$_+=16){var K$D=new K$cP(K$T[K$_+0],K$T[K$_+1],K$T[K$_+2],K$T[K$_+3],K$T[K$_+4],K$T[K$_+5],K$T[K$_+6],K$T[K$_+7],K$T[K$_+8],K$T[K$_+9],K$T[K$_+10],K$T[K$_+11],K$T[K$_+12],K$T[K$_+13],K$T[K$_+14],K$T[K$_+15]);K$L._mesh._inverseBindPoses.push(K$D)}return K$L._mesh._skinnedDatas=new Float32Array(16*K$T.length),!0},K$L.READ_SUBMESH=function(){var K$c=K$L._readData.__getBuffer(),K$P=new K$SP(K$L._mesh),K$q=K$L._readData.getInt16(),K$_=K$L._readData.getUint32(),K$E=K$L._readData.getUint32();K$P._vertexBuffer=K$L._mesh._vertexBuffers[K$q],K$P._vertexStart=K$_,K$P._vertexCount=K$E;var K$b=K$L._readData.getUint32(),K$e=K$L._readData.getUint32(),K$h=K$L._mesh._indexBuffer;K$P._indexBuffer=K$h,K$P._indexStart=K$b,K$P._indexCount=K$e,K$P._indices=new Uint16Array(K$h.getData().buffer,2*K$b,K$e);var K$Z=K$L._DATA.offset,K$S=K$P._subIndexBufferStart,K$n=K$P._subIndexBufferCount,K$k=K$P._boneIndicesList,K$x=K$L._readData.getUint16();K$S.length=K$x,K$n.length=K$x,K$k.length=K$x;for(var K$r=0;K$r<K$x;K$r++){K$S[K$r]=K$L._readData.getUint32(),K$n[K$r]=K$L._readData.getUint32();var K$g=K$L._readData.getUint32(),K$W=K$L._readData.getUint32();K$k[K$r]=new Uint8Array(K$c.slice(K$Z+K$g,K$Z+K$g+K$W))}return K$L._subMeshes.push(K$P),!0},K$L._strings=[],K$L._readData=null,K$L._version=null,K$L._mesh=null,K$L._subMeshes=null,K$L._materialMap=null,K$k(K$L,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":K$mc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":K$Oc.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":K$yc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":K$Cc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":K$Rc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":K$Qc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":K$Lc.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":K$sc.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":K$ac.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":K$xc.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":K$nc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":K$Dc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":K$wc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":K$oc.vertexDeclaration,"POSITION,NORMAL,UV,UV1":K$Vc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":K$uc.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":K$vc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":K$Wc.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":K$Ic.vertexDeclaration,"POSITION,NORMAL,UV":K$jc.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":K$gc.vertexDeclaration,"POSITION,NORMAL,COLOR":K$Sc.vertexDeclaration,"POSITION,NORMAL,TANGENT":K$Jc.vertexDeclaration,"POSITION,NORMAL":K$Zc.vertexDeclaration,"POSITION,UV":K$zc.vertexDeclaration,POSITION:K$hc.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":K$Nc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":K$Oc.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":K$yc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":K$$c.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":K$Rc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":K$Hc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":K$Lc.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":K$Yc.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":K$ac.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":K$kc.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":K$nc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":K$Tc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":K$wc.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":K$Fc.vertexDeclaration,"POSITION,NORMAL,UV,UV1":K$Vc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":K$dc.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":K$vc.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":K$Wc.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":K$Uc.vertexDeclaration,"POSITION,NORMAL,UV":K$jc.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":K$rc.vertexDeclaration,"POSITION,NORMAL,COLOR":K$Sc.vertexDeclaration,"POSITION,NORMAL,TANGENT":K$Ac.vertexDeclaration,"POSITION,NORMAL":K$Zc.vertexDeclaration,"POSITION,UV":K$zc.vertexDeclaration,POSITION:K$hc.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),K$L}(),K$tc=function(){function K$h(){}return K$r(K$h,"laya.d3.loaders.MeshReader"),K$h.read=function(K$c,K$P,K$q,K$_,K$E){var K$b=new K$L(K$c);K$b.pos=0;var K$e=K$b.readUTFString();switch(K$e){case"LAYAMODEL:01":case"LAYASKINANI:01":K$h._readVersion01(K$b,K$e,K$P,K$q,K$_,K$E);break;case"LAYAMODEL:02":K$fc.parse(K$b,K$e,K$P,K$q,K$_,K$E);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":K$lc.parse(K$b,K$e,K$P,K$_,K$E);break;default:throw new Error("MeshReader: unknown mesh version.")}K$P._setSubMeshes(K$_)},K$h._readVersion01=function(K$c,K$P,K$q,K$_,K$E,K$b){new K$Xc(K$c,K$P,K$q,K$_,K$E,K$b)},K$h}(),K$Bc=function(){function K$c(K$c,K$P){this.min=null,this.max=null,this.min=K$c,this.max=K$P}K$r(K$c,"laya.d3.math.BoundBox");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P.getCorners=function(K$c){K$c.length=8;var K$P=this.min.elements,K$q=this.max.elements,K$_=K$P[0],K$E=K$P[1],K$b=K$P[2],K$e=K$q[0],K$h=K$q[1],K$Z=K$q[2];K$c[0]=new K$eP(K$_,K$h,K$Z),K$c[1]=new K$eP(K$e,K$h,K$Z),K$c[2]=new K$eP(K$e,K$E,K$Z),K$c[3]=new K$eP(K$_,K$E,K$Z),K$c[4]=new K$eP(K$_,K$h,K$b),K$c[5]=new K$eP(K$e,K$h,K$b),K$c[6]=new K$eP(K$e,K$E,K$b),K$c[7]=new K$eP(K$_,K$E,K$b)},K$P.toDefault=function(){this.min.toDefault(),this.max.toDefault()},K$P.cloneTo=function(K$c){var K$P=K$c;this.min.cloneTo(K$P.min),this.max.cloneTo(K$P.max)},K$P.clone=function(){var K$c=new this.constructor(new K$eP,new K$eP);return this.cloneTo(K$c),K$c},K$c.createfromPoints=function(K$c,K$P){if(null==K$c)throw new Error("points");var K$q=K$P.min,K$_=K$P.max,K$E=K$q.elements;K$E[0]=Number.MAX_VALUE,K$E[1]=Number.MAX_VALUE,K$E[2]=Number.MAX_VALUE;var K$b=K$_.elements;K$b[0]=-Number.MAX_VALUE,K$b[1]=-Number.MAX_VALUE,K$b[2]=-Number.MAX_VALUE;for(var K$e=0,K$h=K$c.length;K$e<K$h;++K$e)K$eP.min(K$q,K$c[K$e],K$q),K$eP.max(K$_,K$c[K$e],K$_)},K$c.merge=function(K$c,K$P,K$q){K$eP.min(K$c.min,K$P.min,K$q.min),K$eP.max(K$c.max,K$P.max,K$q.max)},K$c}(),K$pc=function(){function K$S(K$c){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=K$c,this._near=new K$PP(new K$eP),this._far=new K$PP(new K$eP),this._left=new K$PP(new K$eP),this._right=new K$PP(new K$eP),this._top=new K$PP(new K$eP),this._bottom=new K$PP(new K$eP),K$S._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}K$r(K$S,"laya.d3.math.BoundFrustum");var K$c=K$S.prototype;return K$c.equalsBoundFrustum=function(K$c){return this._matrix.equalsOtherMatrix(K$c.matrix)},K$c.equalsObj=function(K$c){if(K$c instanceof laya.d3.math.BoundFrustum){var K$P=K$c;return this.equalsBoundFrustum(K$P)}return!1},K$c.getPlane=function(K$c){switch(K$c){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},K$c.getCorners=function(K$c){K$S._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(K$c[0]),K$S._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(K$c[1]),K$S._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(K$c[2]),K$S._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(K$c[3]),K$S._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(K$c[4]),K$S._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(K$c[5]),K$S._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(K$c[6]),K$S._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(K$c[7])},K$c.containsPoint=function(K$c){for(var K$P=K$PP.PlaneIntersectionType_Front,K$q=K$PP.PlaneIntersectionType_Front,K$_=0;K$_<6;K$_++){switch(K$_){case 0:K$q=Collision.intersectsPlaneAndPoint(this._near,K$c);break;case 1:K$q=Collision.intersectsPlaneAndPoint(this._far,K$c);break;case 2:K$q=Collision.intersectsPlaneAndPoint(this._left,K$c);break;case 3:K$q=Collision.intersectsPlaneAndPoint(this._right,K$c);break;case 4:K$q=Collision.intersectsPlaneAndPoint(this._top,K$c);break;case 5:K$q=Collision.intersectsPlaneAndPoint(this._bottom,K$c)}switch(K$q){case K$PP.PlaneIntersectionType_Back:return 0;case K$PP.PlaneIntersectionType_Intersecting:K$P=K$PP.PlaneIntersectionType_Intersecting}}switch(K$P){case K$PP.PlaneIntersectionType_Intersecting:return 2;default:return 1}},K$c.containsBoundBox=function(K$c){for(var K$P,K$q=K$S._tempV30,K$_=K$S._tempV31,K$E=1,K$b=0;K$b<6;K$b++){if(K$P=this.getPlane(K$b),this._getBoxToPlanePVertexNVertex(K$c,K$P.normal,K$q,K$_),Collision.intersectsPlaneAndPoint(K$P,K$q)===K$PP.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(K$P,K$_)===K$PP.PlaneIntersectionType_Back&&(K$E=2)}return K$E},K$c.containsBoundSphere=function(K$c){for(var K$P=K$PP.PlaneIntersectionType_Front,K$q=K$PP.PlaneIntersectionType_Front,K$_=0;K$_<6;K$_++){switch(K$_){case 0:K$q=Collision.intersectsPlaneAndSphere(this._near,K$c);break;case 1:K$q=Collision.intersectsPlaneAndSphere(this._far,K$c);break;case 2:K$q=Collision.intersectsPlaneAndSphere(this._left,K$c);break;case 3:K$q=Collision.intersectsPlaneAndSphere(this._right,K$c);break;case 4:K$q=Collision.intersectsPlaneAndSphere(this._top,K$c);break;case 5:K$q=Collision.intersectsPlaneAndSphere(this._bottom,K$c)}switch(K$q){case K$PP.PlaneIntersectionType_Back:return 0;case K$PP.PlaneIntersectionType_Intersecting:K$P=K$PP.PlaneIntersectionType_Intersecting}}switch(K$P){case K$PP.PlaneIntersectionType_Intersecting:return 2;default:return 1}},K$c._getBoxToPlanePVertexNVertex=function(K$c,K$P,K$q,K$_){var K$E=K$c.min,K$b=K$E.elements,K$e=K$c.max,K$h=K$e.elements,K$Z=K$P.elements,K$S=K$Z[0],K$n=K$Z[1],K$k=K$Z[2];K$E.cloneTo(K$q);var K$x=K$q.elements;0<=K$S&&(K$x[0]=K$h[0]),0<=K$n&&(K$x[1]=K$h[1]),0<=K$k&&(K$x[2]=K$h[2]),K$e.cloneTo(K$_);var K$r=K$_.elements;0<=K$S&&(K$r[0]=K$b[0]),0<=K$n&&(K$r[1]=K$b[1]),0<=K$k&&(K$r[2]=K$b[2])},K$g(0,K$c,"top",function(){return this._top}),K$g(0,K$c,"matrix",function(){return this._matrix},function(K$c){this._matrix=K$c,K$S._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),K$g(0,K$c,"near",function(){return this._near}),K$g(0,K$c,"far",function(){return this._far}),K$g(0,K$c,"left",function(){return this._left}),K$g(0,K$c,"right",function(){return this._right}),K$g(0,K$c,"bottom",function(){return this._bottom}),K$S._getPlanesFromMatrix=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){var K$h=K$c.elements,K$Z=K$h[0],K$S=K$h[1],K$n=K$h[2],K$k=K$h[3],K$x=K$h[4],K$r=K$h[5],K$g=K$h[6],K$W=K$h[7],K$w=K$h[8],K$O=K$h[9],K$N=K$h[10],K$m=K$h[11],K$T=K$h[12],K$D=K$h[13],K$L=K$h[14],K$H=K$h[15],K$Q=K$P.normal.elements;K$Q[0]=K$k+K$n,K$Q[1]=K$W+K$g,K$Q[2]=K$m+K$N,K$P.distance=K$H+K$L,K$P.normalize();var K$d=K$q.normal.elements;K$d[0]=K$k-K$n,K$d[1]=K$W-K$g,K$d[2]=K$m-K$N,K$q.distance=K$H-K$L,K$q.normalize();var K$u=K$_.normal.elements;K$u[0]=K$k+K$Z,K$u[1]=K$W+K$x,K$u[2]=K$m+K$w,K$_.distance=K$H+K$T,K$_.normalize();var K$A=K$E.normal.elements;K$A[0]=K$k-K$Z,K$A[1]=K$W-K$x,K$A[2]=K$m-K$w,K$E.distance=K$H-K$T,K$E.normalize();var K$J=K$b.normal.elements;K$J[0]=K$k-K$S,K$J[1]=K$W-K$r,K$J[2]=K$m-K$O,K$b.distance=K$H-K$D,K$b.normalize();var K$j=K$e.normal.elements;K$j[0]=K$k+K$S,K$j[1]=K$W+K$r,K$j[2]=K$m+K$O,K$e.distance=K$H+K$D,K$e.normalize()},K$S._get3PlaneInterPoint=function(K$c,K$P,K$q){var K$_=K$c.normal,K$E=K$P.normal,K$b=K$q.normal;K$eP.cross(K$E,K$b,K$S._tempV30),K$eP.cross(K$b,K$_,K$S._tempV31),K$eP.cross(K$_,K$E,K$S._tempV32);var K$e=K$eP.dot(K$_,K$S._tempV30),K$h=K$eP.dot(K$E,K$S._tempV31),K$Z=K$eP.dot(K$b,K$S._tempV32);return K$eP.scale(K$S._tempV30,-K$c.distance/K$e,K$S._tempV33),K$eP.scale(K$S._tempV31,-K$P.distance/K$h,K$S._tempV34),K$eP.scale(K$S._tempV32,-K$q.distance/K$Z,K$S._tempV35),K$eP.add(K$S._tempV33,K$S._tempV34,K$S._tempV36),K$eP.add(K$S._tempV35,K$S._tempV36,K$S._tempV37),K$S._tempV37},K$k(K$S,["_tempV30",function(){return this._tempV30=new K$eP},"_tempV31",function(){return this._tempV31=new K$eP},"_tempV32",function(){return this._tempV32=new K$eP},"_tempV33",function(){return this._tempV33=new K$eP},"_tempV34",function(){return this._tempV34=new K$eP},"_tempV35",function(){return this._tempV35=new K$eP},"_tempV36",function(){return this._tempV36=new K$eP},"_tempV37",function(){return this._tempV37=new K$eP}]),K$S}(),K$ic=function(){function K$n(K$c,K$P){this.center=null,this.radius=NaN,this.center=K$c,this.radius=K$P}K$r(K$n,"laya.d3.math.BoundSphere");var K$c=K$n.prototype;return K$D.imps(K$c,{"laya.d3.core.IClone":!0}),K$c.toDefault=function(){this.center.toDefault(),this.radius=0},K$c.intersectsRayDistance=function(K$c){return Collision.intersectsRayAndSphereRD(K$c,this)},K$c.intersectsRayPoint=function(K$c,K$P){return Collision.intersectsRayAndSphereRP(K$c,this,K$P)},K$c.cloneTo=function(K$c){var K$P=K$c;this.center.cloneTo(K$P.center),K$P.radius=this.radius},K$c.clone=function(){var K$c=new this.constructor(new K$eP,new K$eP);return this.cloneTo(K$c),K$c},K$n.createFromSubPoints=function(K$c,K$P,K$q,K$_){if(null==K$c)throw new Error("points");if(K$P<0||K$P>=K$c.length)throw new Error("start"+K$P+"Must be in the range [0, "+(K$c.length-1)+"]");if(K$q<0||K$P+K$q>K$c.length)throw new Error("count"+K$q+"Must be in the range <= "+K$c.length+"}");var K$E=K$P+K$q,K$b=K$n._tempVector3;K$b.elements[0]=0,K$b.elements[1]=0,K$b.elements[2]=0;for(var K$e=K$P;K$e<K$E;++K$e)K$eP.add(K$c[K$e],K$b,K$b);var K$h=K$_.center;K$eP.scale(K$b,1/K$q,K$h);var K$Z=0;for(K$e=K$P;K$e<K$E;++K$e){var K$S=K$eP.distanceSquared(K$h,K$c[K$e]);K$Z<K$S&&(K$Z=K$S)}K$_.radius=Math.sqrt(K$Z)},K$n.createfromPoints=function(K$c,K$P){if(null==K$c)throw new Error("points");K$n.createFromSubPoints(K$c,0,K$c.length,K$P)},K$k(K$n,["_tempVector3",function(){return this._tempVector3=new K$eP}]),K$n}(),K$Kc=(function(){function K$c(){}K$r(K$c,"laya.d3.math.ContainmentType"),K$c.Disjoint=0,K$c.Contains=1,K$c.Intersects=2}(),function(){function K$q(){}return K$r(K$q,"laya.d3.math.MathUtils3D"),K$q.isZero=function(K$c){return Math.abs(K$c)<K$q.zeroTolerance},K$q.nearEqual=function(K$c,K$P){return!!K$q.isZero(K$c-K$P)},K$q.fastInvSqrt=function(K$c){return K$q.isZero(K$c)?K$c:1/Math.sqrt(K$c)},K$k(K$q,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),K$q}()),K$Gc=function(){function K$Z(){var K$c=this.elements=new Float32Array(9);K$c[0]=1,K$c[1]=0,K$c[2]=0,K$c[3]=0,K$c[4]=1,K$c[5]=0,K$c[6]=0,K$c[7]=0,K$c[8]=1}K$r(K$Z,"laya.d3.math.Matrix3x3");var K$c=K$Z.prototype;return K$D.imps(K$c,{"laya.d3.core.IClone":!0}),K$c.determinant=function(){var K$c=this.elements,K$P=K$c[0],K$q=K$c[1],K$_=K$c[2],K$E=K$c[3],K$b=K$c[4],K$e=K$c[5],K$h=K$c[6],K$Z=K$c[7],K$S=K$c[8];return K$P*(K$S*K$b-K$e*K$Z)+K$q*(-K$S*K$E+K$e*K$h)+K$_*(K$Z*K$E-K$b*K$h)},K$c.translate=function(K$c,K$P){var K$q=K$P.elements,K$_=this.elements,K$E=K$c.elements,K$b=K$_[0],K$e=K$_[1],K$h=K$_[2],K$Z=K$_[3],K$S=K$_[4],K$n=K$_[5],K$k=K$_[6],K$x=K$_[7],K$r=K$_[8],K$g=K$E[0],K$W=K$E[1];K$q[0]=K$b,K$q[1]=K$e,K$q[2]=K$h,K$q[3]=K$Z,K$q[4]=K$S,K$q[5]=K$n,K$q[6]=K$g*K$b+K$W*K$Z+K$k,K$q[7]=K$g*K$e+K$W*K$S+K$x,K$q[8]=K$g*K$h+K$W*K$n+K$r},K$c.rotate=function(K$c,K$P){var K$q=K$P.elements,K$_=this.elements,K$E=K$_[0],K$b=K$_[1],K$e=K$_[2],K$h=K$_[3],K$Z=K$_[4],K$S=K$_[5],K$n=K$_[6],K$k=K$_[7],K$x=K$_[8],K$r=Math.sin(K$c),K$g=Math.cos(K$c);K$q[0]=K$g*K$E+K$r*K$h,K$q[1]=K$g*K$b+K$r*K$Z,K$q[2]=K$g*K$e+K$r*K$S,K$q[3]=K$g*K$h-K$r*K$E,K$q[4]=K$g*K$Z-K$r*K$b,K$q[5]=K$g*K$S-K$r*K$e,K$q[6]=K$n,K$q[7]=K$k,K$q[8]=K$x},K$c.scale=function(K$c,K$P){var K$q=K$P.elements,K$_=this.elements,K$E=K$c.elements,K$b=K$E[0],K$e=K$E[1];K$q[0]=K$b*K$_[0],K$q[1]=K$b*K$_[1],K$q[2]=K$b*K$_[2],K$q[3]=K$e*K$_[3],K$q[4]=K$e*K$_[4],K$q[5]=K$e*K$_[5],K$q[6]=K$_[6],K$q[7]=K$_[7],K$q[8]=K$_[8]},K$c.invert=function(K$c){var K$P=K$c.elements,K$q=this.elements,K$_=K$q[0],K$E=K$q[1],K$b=K$q[2],K$e=K$q[3],K$h=K$q[4],K$Z=K$q[5],K$S=K$q[6],K$n=K$q[7],K$k=K$q[8],K$x=K$k*K$h-K$Z*K$n,K$r=-K$k*K$e+K$Z*K$S,K$g=K$n*K$e-K$h*K$S,K$W=K$_*K$x+K$E*K$r+K$b*K$g;K$W||(K$c=null),K$W=1/K$W,K$P[0]=K$x*K$W,K$P[1]=(-K$k*K$E+K$b*K$n)*K$W,K$P[2]=(K$Z*K$E-K$b*K$h)*K$W,K$P[3]=K$r*K$W,K$P[4]=(K$k*K$_-K$b*K$S)*K$W,K$P[5]=(-K$Z*K$_+K$b*K$e)*K$W,K$P[6]=K$g*K$W,K$P[7]=(-K$n*K$_+K$E*K$S)*K$W,K$P[8]=(K$h*K$_-K$E*K$e)*K$W},K$c.transpose=function(K$c){var K$P=K$c.elements,K$q=this.elements;if(K$c===this){var K$_=K$q[1],K$E=K$q[2],K$b=K$q[5];K$P[1]=K$q[3],K$P[2]=K$q[6],K$P[3]=K$_,K$P[5]=K$q[7],K$P[6]=K$E,K$P[7]=K$b}else K$P[0]=K$q[0],K$P[1]=K$q[3],K$P[2]=K$q[6],K$P[3]=K$q[1],K$P[4]=K$q[4],K$P[5]=K$q[7],K$P[6]=K$q[2],K$P[7]=K$q[5],K$P[8]=K$q[8]},K$c.identity=function(){var K$c=this.elements;K$c[0]=1,K$c[1]=0,K$c[2]=0,K$c[3]=0,K$c[4]=1,K$c[5]=0,K$c[6]=0,K$c[7]=0,K$c[8]=1},K$c.cloneTo=function(K$c){var K$P,K$q,K$_;if((K$q=this.elements)!==(K$_=K$c.elements))for(K$P=0;K$P<9;++K$P)K$_[K$P]=K$q[K$P]},K$c.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$Z.createFromTranslation=function(K$c,K$P){K$P.elements;var K$q=K$c.elements;K$P[0]=1,K$P[1]=0,K$P[2]=0,K$P[3]=0,K$P[4]=1,K$P[5]=0,K$P[6]=K$q[0],K$P[7]=K$q[1],K$P[8]=1},K$Z.createFromRotation=function(K$c,K$P){var K$q=K$P.elements,K$_=Math.sin(K$c),K$E=Math.cos(K$c);K$q[0]=K$E,K$q[1]=K$_,K$q[2]=0,K$q[3]=-K$_,K$q[4]=K$E,K$q[5]=0,K$q[6]=0,K$q[7]=0,K$q[8]=1},K$Z.createFromScaling=function(K$c,K$P){var K$q=K$P.elements,K$_=K$c.elements;K$q[0]=K$_[0],K$q[1]=0,K$q[2]=0,K$q[3]=0,K$q[4]=K$_[1],K$q[5]=0,K$q[6]=0,K$q[7]=0,K$q[8]=1},K$Z.createFromMatrix4x4=function(K$c,K$P){K$P[0]=K$c[0],K$P[1]=K$c[1],K$P[2]=K$c[2],K$P[3]=K$c[4],K$P[4]=K$c[5],K$P[5]=K$c[6],K$P[6]=K$c[8],K$P[7]=K$c[9],K$P[8]=K$c[10]},K$Z.multiply=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements,K$e=K$E[0],K$h=K$E[1],K$Z=K$E[2],K$S=K$E[3],K$n=K$E[4],K$k=K$E[5],K$x=K$E[6],K$r=K$E[7],K$g=K$E[8],K$W=K$b[0],K$w=K$b[1],K$O=K$b[2],K$N=K$b[3],K$m=K$b[4],K$T=K$b[5],K$D=K$b[6],K$L=K$b[7],K$H=K$b[8];K$_[0]=K$W*K$e+K$w*K$S+K$O*K$x,K$_[1]=K$W*K$h+K$w*K$n+K$O*K$r,K$_[2]=K$W*K$Z+K$w*K$k+K$O*K$g,K$_[3]=K$N*K$e+K$m*K$S+K$T*K$x,K$_[4]=K$N*K$h+K$m*K$n+K$T*K$r,K$_[5]=K$N*K$Z+K$m*K$k+K$T*K$g,K$_[6]=K$D*K$e+K$L*K$S+K$H*K$x,K$_[7]=K$D*K$h+K$L*K$n+K$H*K$r,K$_[8]=K$D*K$Z+K$L*K$k+K$H*K$g},K$Z.lookAt=function(K$c,K$P,K$q,K$_){K$eP.subtract(K$c,K$P,K$Z._tempV30),K$eP.normalize(K$Z._tempV30,K$Z._tempV30),K$eP.cross(K$q,K$Z._tempV30,K$Z._tempV31),K$eP.normalize(K$Z._tempV31,K$Z._tempV31),K$eP.cross(K$Z._tempV30,K$Z._tempV31,K$Z._tempV32);var K$E=K$Z._tempV30.elements,K$b=K$Z._tempV31.elements,K$e=K$Z._tempV32.elements,K$h=K$_.elements;K$h[0]=K$b[0],K$h[3]=K$b[1],K$h[6]=K$b[2],K$h[1]=K$e[0],K$h[4]=K$e[1],K$h[7]=K$e[2],K$h[2]=K$E[0],K$h[5]=K$E[1],K$h[8]=K$E[2]},K$Z.DEFAULT=new K$Z,K$k(K$Z,["_tempV30",function(){return this._tempV30=new K$eP},"_tempV31",function(){return this._tempV31=new K$eP},"_tempV32",function(){return this._tempV32=new K$eP}]),K$Z}(),K$cP=function(){function K$d(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$k,K$x,K$r,K$g,K$W){void 0===K$c&&(K$c=1),void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=0),void 0===K$E&&(K$E=0),void 0===K$b&&(K$b=1),void 0===K$e&&(K$e=0),void 0===K$h&&(K$h=0),void 0===K$Z&&(K$Z=0),void 0===K$S&&(K$S=0),void 0===K$n&&(K$n=1),void 0===K$k&&(K$k=0),void 0===K$x&&(K$x=0),void 0===K$r&&(K$r=0),void 0===K$g&&(K$g=0),void 0===K$W&&(K$W=1);var K$w=this.elements=new Float32Array(16);K$w[0]=K$c,K$w[1]=K$P,K$w[2]=K$q,K$w[3]=K$_,K$w[4]=K$E,K$w[5]=K$b,K$w[6]=K$e,K$w[7]=K$h,K$w[8]=K$Z,K$w[9]=K$S,K$w[10]=K$n,K$w[11]=K$k,K$w[12]=K$x,K$w[13]=K$r,K$w[14]=K$g,K$w[15]=K$W}K$r(K$d,"laya.d3.math.Matrix4x4");var K$c=K$d.prototype;return K$D.imps(K$c,{"laya.d3.core.IClone":!0}),K$c.getElementByRowColumn=function(K$c,K$P){if(K$c<0||3<K$c)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(K$P<0||3<K$P)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*K$c+K$P]},K$c.setElementByRowColumn=function(K$c,K$P,K$q){if(K$c<0||3<K$c)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(K$P<0||3<K$P)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*K$c+K$P]=K$q},K$c.equalsOtherMatrix=function(K$c){var K$P=this.elements,K$q=K$c.elements;return K$Kc.nearEqual(K$P[0],K$q[0])&&K$Kc.nearEqual(K$P[1],K$q[1])&&K$Kc.nearEqual(K$P[2],K$q[2])&&K$Kc.nearEqual(K$P[3],K$q[3])&&K$Kc.nearEqual(K$P[4],K$q[4])&&K$Kc.nearEqual(K$P[5],K$q[5])&&K$Kc.nearEqual(K$P[6],K$q[6])&&K$Kc.nearEqual(K$P[7],K$q[7])&&K$Kc.nearEqual(K$P[8],K$q[8])&&K$Kc.nearEqual(K$P[9],K$q[9])&&K$Kc.nearEqual(K$P[10],K$q[10])&&K$Kc.nearEqual(K$P[11],K$q[11])&&K$Kc.nearEqual(K$P[12],K$q[12])&&K$Kc.nearEqual(K$P[13],K$q[13])&&K$Kc.nearEqual(K$P[14],K$q[14])&&K$Kc.nearEqual(K$P[15],K$q[15])},K$c.decomposeTransRotScale=function(K$c,K$P,K$q){var K$_=K$d._tempMatrix4x4;return this.decomposeTransRotMatScale(K$c,K$_,K$q)?(K$qP.createFromMatrix4x4(K$_,K$P),!0):(K$P.identity(),!1)},K$c.decomposeTransRotMatScale=function(K$c,K$P,K$q){var K$_=this.elements,K$E=K$c.elements,K$b=K$P.elements,K$e=K$q.elements;K$E[0]=K$_[12],K$E[1]=K$_[13],K$E[2]=K$_[14];var K$h=K$_[0],K$Z=K$_[1],K$S=K$_[2],K$n=K$_[4],K$k=K$_[5],K$x=K$_[6],K$r=K$_[8],K$g=K$_[9],K$W=K$_[10],K$w=K$e[0]=Math.sqrt(K$h*K$h+K$Z*K$Z+K$S*K$S),K$O=K$e[1]=Math.sqrt(K$n*K$n+K$k*K$k+K$x*K$x),K$N=K$e[2]=Math.sqrt(K$r*K$r+K$g*K$g+K$W*K$W);if(K$Kc.isZero(K$w)||K$Kc.isZero(K$O)||K$Kc.isZero(K$N))return K$b[1]=K$b[2]=K$b[3]=K$b[4]=K$b[6]=K$b[7]=K$b[8]=K$b[9]=K$b[11]=K$b[12]=K$b[13]=K$b[14]=0,K$b[0]=K$b[5]=K$b[10]=K$b[15]=1,!1;var K$m=K$d._tempVector0,K$T=K$m.elements;K$T[0]=K$r/K$N,K$T[1]=K$g/K$N,K$T[2]=K$W/K$N;var K$D=K$d._tempVector1,K$L=K$D.elements;K$L[0]=K$h/K$w,K$L[1]=K$Z/K$w,K$L[2]=K$S/K$w;var K$H=K$d._tempVector2;K$eP.cross(K$m,K$D,K$H);var K$Q=K$d._tempVector1;return K$eP.cross(K$H,K$m,K$Q),K$b[3]=K$b[7]=K$b[11]=K$b[12]=K$b[13]=K$b[14]=0,K$b[15]=1,K$b[0]=K$Q.x,K$b[1]=K$Q.y,K$b[2]=K$Q.z,K$b[4]=K$H.x,K$b[5]=K$H.y,K$b[6]=K$H.z,K$b[8]=K$m.x,K$b[9]=K$m.y,K$b[10]=K$m.z,K$b[0]*K$h+K$b[1]*K$Z+K$b[2]*K$S<0&&(K$e[0]=-K$w),K$b[4]*K$n+K$b[5]*K$k+K$b[6]*K$x<0&&(K$e[1]=-K$O),K$b[8]*K$r+K$b[9]*K$g+K$b[10]*K$W<0&&(K$e[2]=-K$N),!0},K$c.decomposeYawPitchRoll=function(K$c){var K$P=K$c.elements,K$q=Math.asin(-this.elements[9]);K$P[1]=K$q,Math.cos(K$q)>K$Kc.zeroTolerance?(K$P[2]=Math.atan2(this.elements[1],this.elements[5]),K$P[0]=Math.atan2(this.elements[8],this.elements[10])):(K$P[2]=Math.atan2(-this.elements[4],this.elements[0]),K$P[0]=0)},K$c.normalize=function(){var K$c=this.elements,K$P=K$c[0],K$q=K$c[1],K$_=K$c[2],K$E=Math.sqrt(K$P*K$P+K$q*K$q+K$_*K$_);if(!K$E)return K$c[0]=0,K$c[1]=0,void(K$c[2]=0);1!=K$E&&(K$E=1/K$E,K$c[0]=K$P*K$E,K$c[1]=K$q*K$E,K$c[2]=K$_*K$E)},K$c.transpose=function(){var K$c,K$P;return K$P=(K$c=this.elements)[1],K$c[1]=K$c[4],K$c[4]=K$P,K$P=K$c[2],K$c[2]=K$c[8],K$c[8]=K$P,K$P=K$c[3],K$c[3]=K$c[12],K$c[12]=K$P,K$P=K$c[6],K$c[6]=K$c[9],K$c[9]=K$P,K$P=K$c[7],K$c[7]=K$c[13],K$c[13]=K$P,K$P=K$c[11],K$c[11]=K$c[14],K$c[14]=K$P,this},K$c.invert=function(K$c){var K$P=this.elements,K$q=K$c.elements,K$_=K$P[0],K$E=K$P[1],K$b=K$P[2],K$e=K$P[3],K$h=K$P[4],K$Z=K$P[5],K$S=K$P[6],K$n=K$P[7],K$k=K$P[8],K$x=K$P[9],K$r=K$P[10],K$g=K$P[11],K$W=K$P[12],K$w=K$P[13],K$O=K$P[14],K$N=K$P[15],K$m=K$_*K$Z-K$E*K$h,K$T=K$_*K$S-K$b*K$h,K$D=K$_*K$n-K$e*K$h,K$L=K$E*K$S-K$b*K$Z,K$H=K$E*K$n-K$e*K$Z,K$Q=K$b*K$n-K$e*K$S,K$d=K$k*K$w-K$x*K$W,K$u=K$k*K$O-K$r*K$W,K$A=K$k*K$N-K$g*K$W,K$J=K$x*K$O-K$r*K$w,K$j=K$x*K$N-K$g*K$w,K$V=K$r*K$N-K$g*K$O,K$R=K$m*K$V-K$T*K$j+K$D*K$J+K$L*K$A-K$H*K$u+K$Q*K$d;0!==Math.abs(K$R)&&(K$R=1/K$R,K$q[0]=(K$Z*K$V-K$S*K$j+K$n*K$J)*K$R,K$q[1]=(K$b*K$j-K$E*K$V-K$e*K$J)*K$R,K$q[2]=(K$w*K$Q-K$O*K$H+K$N*K$L)*K$R,K$q[3]=(K$r*K$H-K$x*K$Q-K$g*K$L)*K$R,K$q[4]=(K$S*K$A-K$h*K$V-K$n*K$u)*K$R,K$q[5]=(K$_*K$V-K$b*K$A+K$e*K$u)*K$R,K$q[6]=(K$O*K$D-K$W*K$Q-K$N*K$T)*K$R,K$q[7]=(K$k*K$Q-K$r*K$D+K$g*K$T)*K$R,K$q[8]=(K$h*K$j-K$Z*K$A+K$n*K$d)*K$R,K$q[9]=(K$E*K$A-K$_*K$j-K$e*K$d)*K$R,K$q[10]=(K$W*K$H-K$w*K$D+K$N*K$m)*K$R,K$q[11]=(K$x*K$D-K$k*K$H-K$g*K$m)*K$R,K$q[12]=(K$Z*K$u-K$h*K$J-K$S*K$d)*K$R,K$q[13]=(K$_*K$J-K$E*K$u+K$b*K$d)*K$R,K$q[14]=(K$w*K$T-K$W*K$L-K$O*K$m)*K$R,K$q[15]=(K$k*K$L-K$x*K$T+K$r*K$m)*K$R)},K$c.identity=function(){var K$c=this.elements;K$c[1]=K$c[2]=K$c[3]=K$c[4]=K$c[6]=K$c[7]=K$c[8]=K$c[9]=K$c[11]=K$c[12]=K$c[13]=K$c[14]=0,K$c[0]=K$c[5]=K$c[10]=K$c[15]=1},K$c.cloneTo=function(K$c){var K$P,K$q,K$_;if((K$q=this.elements)!==(K$_=K$c.elements))for(K$P=0;K$P<16;++K$P)K$_[K$P]=K$q[K$P]},K$c.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$c.getTranslationVector=function(K$c){var K$P=this.elements,K$q=K$c.elements;K$q[0]=K$P[12],K$q[1]=K$P[13],K$q[2]=K$P[14]},K$c.setTranslationVector=function(K$c){var K$P=this.elements,K$q=K$c.elements;K$P[12]=K$q[0],K$P[13]=K$q[1],K$P[14]=K$q[2]},K$c.getForward=function(K$c){var K$P=this.elements,K$q=K$c.elements;K$q[0]=-K$P[8],K$q[1]=-K$P[9],K$q[2]=-K$P[10]},K$c.setForward=function(K$c){var K$P=this.elements,K$q=K$c.elements;K$P[8]=-K$q[0],K$P[9]=-K$q[1],K$P[10]=-K$q[2]},K$d.createRotationX=function(K$c,K$P){var K$q=K$P.elements,K$_=Math.sin(K$c),K$E=Math.cos(K$c);K$q[1]=K$q[2]=K$q[3]=K$q[4]=K$q[7]=K$q[8]=K$q[11]=K$q[12]=K$q[13]=K$q[14]=0,K$q[0]=K$q[15]=1,K$q[5]=K$q[10]=K$E,K$q[6]=K$_,K$q[9]=-K$_},K$d.createRotationY=function(K$c,K$P){var K$q=K$P.elements,K$_=Math.sin(K$c),K$E=Math.cos(K$c);K$q[1]=K$q[3]=K$q[4]=K$q[6]=K$q[7]=K$q[9]=K$q[11]=K$q[12]=K$q[13]=K$q[14]=0,K$q[5]=K$q[15]=1,K$q[0]=K$q[10]=K$E,K$q[2]=-K$_,K$q[8]=K$_},K$d.createRotationZ=function(K$c,K$P){var K$q=K$P.elements,K$_=Math.sin(K$c),K$E=Math.cos(K$c);K$q[2]=K$q[3]=K$q[6]=K$q[7]=K$q[8]=K$q[9]=K$q[11]=K$q[12]=K$q[13]=K$q[14]=0,K$q[10]=K$q[15]=1,K$q[0]=K$q[5]=K$E,K$q[1]=K$_,K$q[4]=-K$_},K$d.createRotationYawPitchRoll=function(K$c,K$P,K$q,K$_){K$qP.createFromYawPitchRoll(K$c,K$P,K$q,K$d._tempQuaternion),K$d.createRotationQuaternion(K$d._tempQuaternion,K$_)},K$d.createRotationAxis=function(K$c,K$P,K$q){var K$_=K$c.elements,K$E=K$_[0],K$b=K$_[1],K$e=K$_[2],K$h=Math.cos(K$P),K$Z=Math.sin(K$P),K$S=K$E*K$E,K$n=K$b*K$b,K$k=K$e*K$e,K$x=K$E*K$b,K$r=K$E*K$e,K$g=K$b*K$e,K$W=K$q.elements;K$W[3]=K$W[7]=K$W[11]=K$W[12]=K$W[13]=K$W[14]=0,K$W[15]=1,K$W[0]=K$S+K$h*(1-K$S),K$W[1]=K$x-K$h*K$x+K$Z*K$e,K$W[2]=K$r-K$h*K$r-K$Z*K$b,K$W[4]=K$x-K$h*K$x-K$Z*K$e,K$W[5]=K$n+K$h*(1-K$n),K$W[6]=K$g-K$h*K$g+K$Z*K$E,K$W[8]=K$r-K$h*K$r+K$Z*K$b,K$W[9]=K$g-K$h*K$g-K$Z*K$E,K$W[10]=K$k+K$h*(1-K$k)},K$d.createRotationQuaternion=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements,K$E=K$q[0],K$b=K$q[1],K$e=K$q[2],K$h=K$q[3],K$Z=K$E*K$E,K$S=K$b*K$b,K$n=K$e*K$e,K$k=K$E*K$b,K$x=K$e*K$h,K$r=K$e*K$E,K$g=K$b*K$h,K$W=K$b*K$e,K$w=K$E*K$h;K$_[3]=K$_[7]=K$_[11]=K$_[12]=K$_[13]=K$_[14]=0,K$_[15]=1,K$_[0]=1-2*(K$S+K$n),K$_[1]=2*(K$k+K$x),K$_[2]=2*(K$r-K$g),K$_[4]=2*(K$k-K$x),K$_[5]=1-2*(K$n+K$Z),K$_[6]=2*(K$W+K$w),K$_[8]=2*(K$r+K$g),K$_[9]=2*(K$W-K$w),K$_[10]=1-2*(K$S+K$Z)},K$d.createTranslate=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements;K$_[4]=K$_[8]=K$_[1]=K$_[9]=K$_[2]=K$_[6]=K$_[3]=K$_[7]=K$_[11]=0,K$_[0]=K$_[5]=K$_[10]=K$_[15]=1,K$_[12]=K$q[0],K$_[13]=K$q[1],K$_[14]=K$q[2]},K$d.createScaling=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements;K$_[0]=K$q[0],K$_[5]=K$q[1],K$_[10]=K$q[2],K$_[1]=K$_[4]=K$_[8]=K$_[12]=K$_[9]=K$_[13]=K$_[2]=K$_[6]=K$_[14]=K$_[3]=K$_[7]=K$_[11]=0,K$_[15]=1},K$d.multiply=function(K$c,K$P,K$q){var K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n;for(K$E=K$q.elements,K$b=K$c.elements,K$E===(K$e=K$P.elements)&&(K$e=K$e.slice()),K$_=0;K$_<4;K$_++)K$h=K$b[K$_],K$Z=K$b[K$_+4],K$S=K$b[K$_+8],K$n=K$b[K$_+12],K$E[K$_]=K$h*K$e[0]+K$Z*K$e[1]+K$S*K$e[2]+K$n*K$e[3],K$E[K$_+4]=K$h*K$e[4]+K$Z*K$e[5]+K$S*K$e[6]+K$n*K$e[7],K$E[K$_+8]=K$h*K$e[8]+K$Z*K$e[9]+K$S*K$e[10]+K$n*K$e[11],K$E[K$_+12]=K$h*K$e[12]+K$Z*K$e[13]+K$S*K$e[14]+K$n*K$e[15]},K$d.createFromQuaternion=function(K$c,K$P){var K$q=K$P.elements,K$_=K$c.elements,K$E=K$_[0],K$b=K$_[1],K$e=K$_[2],K$h=K$_[3],K$Z=K$E+K$E,K$S=K$b+K$b,K$n=K$e+K$e,K$k=K$E*K$Z,K$x=K$b*K$Z,K$r=K$b*K$S,K$g=K$e*K$Z,K$W=K$e*K$S,K$w=K$e*K$n,K$O=K$h*K$Z,K$N=K$h*K$S,K$m=K$h*K$n;K$q[0]=1-K$r-K$w,K$q[1]=K$x+K$m,K$q[2]=K$g-K$N,K$q[3]=0,K$q[4]=K$x-K$m,K$q[5]=1-K$k-K$w,K$q[6]=K$W+K$O,K$q[7]=0,K$q[8]=K$g+K$N,K$q[9]=K$W-K$O,K$q[10]=1-K$k-K$r,K$q[11]=0,K$q[12]=0,K$q[13]=0,K$q[14]=0,K$q[15]=1},K$d.createAffineTransformation=function(K$c,K$P,K$q,K$_){var K$E=K$c.elements,K$b=K$P.elements,K$e=K$q.elements,K$h=K$_.elements,K$Z=K$b[0],K$S=K$b[1],K$n=K$b[2],K$k=K$b[3],K$x=K$Z+K$Z,K$r=K$S+K$S,K$g=K$n+K$n,K$W=K$Z*K$x,K$w=K$Z*K$r,K$O=K$Z*K$g,K$N=K$S*K$r,K$m=K$S*K$g,K$T=K$n*K$g,K$D=K$k*K$x,K$L=K$k*K$r,K$H=K$k*K$g,K$Q=K$e[0],K$d=K$e[1],K$u=K$e[2];K$h[0]=(1-(K$N+K$T))*K$Q,K$h[1]=(K$w+K$H)*K$Q,K$h[2]=(K$O-K$L)*K$Q,K$h[3]=0,K$h[4]=(K$w-K$H)*K$d,K$h[5]=(1-(K$W+K$T))*K$d,K$h[6]=(K$m+K$D)*K$d,K$h[7]=0,K$h[8]=(K$O+K$L)*K$u,K$h[9]=(K$m-K$D)*K$u,K$h[10]=(1-(K$W+K$N))*K$u,K$h[11]=0,K$h[12]=K$E[0],K$h[13]=K$E[1],K$h[14]=K$E[2],K$h[15]=1},K$d.createLookAt=function(K$c,K$P,K$q,K$_){var K$E=K$_.elements,K$b=K$d._tempVector0,K$e=K$d._tempVector1,K$h=K$d._tempVector2;K$eP.subtract(K$c,K$P,K$h),K$eP.normalize(K$h,K$h),K$eP.cross(K$q,K$h,K$b),K$eP.normalize(K$b,K$b),K$eP.cross(K$h,K$b,K$e),K$_.identity(),K$E[0]=K$b.x,K$E[4]=K$b.y,K$E[8]=K$b.z,K$E[1]=K$e.x,K$E[5]=K$e.y,K$E[9]=K$e.z,K$E[2]=K$h.x,K$E[6]=K$h.y,K$E[10]=K$h.z,K$E[12]=-K$eP.dot(K$b,K$c),K$E[13]=-K$eP.dot(K$e,K$c),K$E[14]=-K$eP.dot(K$h,K$c)},K$d.createPerspective=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$E.elements,K$e=1/Math.tan(K$c/2),K$h=1/(K$q-K$_);K$b[0]=K$e/K$P,K$b[5]=K$e,K$b[10]=(K$_+K$q)*K$h,K$b[11]=-1,K$b[14]=2*K$_*K$q*K$h,K$b[1]=K$b[2]=K$b[3]=K$b[4]=K$b[6]=K$b[7]=K$b[8]=K$b[9]=K$b[12]=K$b[13]=K$b[15]=0},K$d.createOrthoOffCenterRH=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){var K$h=K$e.elements,K$Z=1/(K$c-K$P),K$S=1/(K$q-K$_),K$n=1/(K$E-K$b);K$h[1]=K$h[2]=K$h[3]=K$h[4]=K$h[6]=K$h[7]=K$h[8]=K$h[9]=K$h[11]=0,K$h[15]=1,K$h[0]=-2*K$Z,K$h[5]=-2*K$S,K$h[10]=2*K$n,K$h[12]=(K$c+K$P)*K$Z,K$h[13]=(K$_+K$q)*K$S,K$h[14]=(K$b+K$E)*K$n},K$d.translation=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements;K$_[0]=K$_[5]=K$_[10]=K$_[15]=1,K$_[12]=K$q[0],K$_[13]=K$q[1],K$_[14]=K$q[2]},K$k(K$d,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new K$d},"_tempVector0",function(){return this._tempVector0=new K$eP},"_tempVector1",function(){return this._tempVector1=new K$eP},"_tempVector2",function(){return this._tempVector2=new K$eP},"_tempQuaternion",function(){return this._tempQuaternion=new K$qP},"DEFAULT",function(){return this.DEFAULT=new K$d},"ZERO",function(){return this.ZERO=new K$d(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),K$d}(),K$PP=(function(){function K$m(K$c,K$P){this.extents=null,this.transformation=null,this.extents=K$c,this.transformation=K$P}K$r(K$m,"laya.d3.math.OrientedBoundBox");var K$c=K$m.prototype;K$c.getCorners=function(K$c){var K$P=K$m._tempV30.elements,K$q=K$m._tempV31.elements,K$_=K$m._tempV32.elements,K$E=this.extents.elements;K$P[0]=K$E[0],K$P[1]=K$P[2]=0,K$q[1]=K$E[1],K$q[0]=K$q[2]=0,K$_[2]=K$E[2],K$_[0]=K$_[1]=0,K$eP.TransformNormal(K$m._tempV30,this.transformation,K$m._tempV30),K$eP.TransformNormal(K$m._tempV31,this.transformation,K$m._tempV31),K$eP.TransformNormal(K$m._tempV32,this.transformation,K$m._tempV32);var K$b=K$m._tempV33;this.transformation.getTranslationVector(K$b),K$c.length=8,K$eP.add(K$b,K$m._tempV30,K$m._tempV34),K$eP.add(K$m._tempV34,K$m._tempV31,K$m._tempV34),K$eP.add(K$m._tempV34,K$m._tempV32,K$c[0]),K$eP.add(K$b,K$m._tempV30,K$m._tempV34),K$eP.add(K$m._tempV34,K$m._tempV31,K$m._tempV34),K$eP.subtract(K$m._tempV34,K$m._tempV32,K$c[1]),K$eP.subtract(K$b,K$m._tempV30,K$m._tempV34),K$eP.add(K$m._tempV34,K$m._tempV31,K$m._tempV34),K$eP.subtract(K$m._tempV34,K$m._tempV32,K$c[2]),K$eP.subtract(K$b,K$m._tempV30,K$m._tempV34),K$eP.add(K$m._tempV34,K$m._tempV31,K$m._tempV34),K$eP.add(K$m._tempV34,K$m._tempV32,K$c[3]),K$eP.add(K$b,K$m._tempV30,K$m._tempV34),K$eP.subtract(K$m._tempV34,K$m._tempV31,K$m._tempV34),K$eP.add(K$m._tempV34,K$m._tempV32,K$c[4]),K$eP.add(K$b,K$m._tempV30,K$m._tempV34),K$eP.subtract(K$m._tempV34,K$m._tempV31,K$m._tempV34),K$eP.subtract(K$m._tempV34,K$m._tempV32,K$c[5]),K$eP.subtract(K$b,K$m._tempV30,K$m._tempV34),K$eP.subtract(K$m._tempV34,K$m._tempV31,K$m._tempV34),K$eP.subtract(K$m._tempV34,K$m._tempV32,K$c[6]),K$eP.subtract(K$b,K$m._tempV30,K$m._tempV34),K$eP.subtract(K$m._tempV34,K$m._tempV31,K$m._tempV34),K$eP.add(K$m._tempV34,K$m._tempV32,K$c[7])},K$c.transform=function(K$c){K$cP.multiply(this.transformation,K$c,this.transformation)},K$c.scale=function(K$c){K$eP.multiply(this.extents,K$c,this.extents)},K$c.translate=function(K$c){this.transformation.getTranslationVector(K$m._tempV30),K$eP.add(K$m._tempV30,K$c,K$m._tempV31),this.transformation.setTranslationVector(K$m._tempV31)},K$c.Size=function(K$c){K$eP.scale(this.extents,2,K$c)},K$c.getSize=function(K$c){var K$P=this.extents.elements;K$m._tempV30.x=K$P[0],K$m._tempV31.y=K$P[1],K$m._tempV32.z=K$P[2],K$eP.TransformNormal(K$m._tempV30,this.transformation,K$m._tempV30),K$eP.TransformNormal(K$m._tempV31,this.transformation,K$m._tempV31),K$eP.TransformNormal(K$m._tempV31,this.transformation,K$m._tempV32);var K$q=K$c.elements;K$q[0]=K$eP.scalarLength(K$m._tempV30),K$q[1]=K$eP.scalarLength(K$m._tempV31),K$q[2]=K$eP.scalarLength(K$m._tempV32)},K$c.getSizeSquared=function(K$c){var K$P=this.extents.elements;K$m._tempV30.x=K$P[0],K$m._tempV31.y=K$P[1],K$m._tempV32.z=K$P[2],K$eP.TransformNormal(K$m._tempV30,this.transformation,K$m._tempV30),K$eP.TransformNormal(K$m._tempV31,this.transformation,K$m._tempV31),K$eP.TransformNormal(K$m._tempV31,this.transformation,K$m._tempV32);var K$q=K$c.elements;K$q[0]=K$eP.scalarLengthSquared(K$m._tempV30),K$q[1]=K$eP.scalarLengthSquared(K$m._tempV31),K$q[2]=K$eP.scalarLengthSquared(K$m._tempV32)},K$c.getCenter=function(K$c){this.transformation.getTranslationVector(K$c)},K$c.containsPoint=function(K$c){var K$P=this.extents.elements,K$q=K$P[0],K$_=K$P[1],K$E=K$P[2];this.transformation.invert(K$m._tempM0),K$eP.transformCoordinate(K$c,K$m._tempM0,K$m._tempV30);var K$b=K$m._tempV30.elements,K$e=Math.abs(K$b[0]),K$h=Math.abs(K$b[1]),K$Z=Math.abs(K$b[2]);return K$Kc.nearEqual(K$e,K$q)&&K$Kc.nearEqual(K$h,K$_)&&K$Kc.nearEqual(K$Z,K$E)?2:K$e<K$q&&K$h<K$_&&K$Z<K$E?1:0},K$c.containsPoints=function(K$c){var K$P=this.extents.elements,K$q=K$P[0],K$_=K$P[1],K$E=K$P[2];this.transformation.invert(K$m._tempM0);for(var K$b=!0,K$e=!1,K$h=0;K$h<K$c.length;K$h++){K$eP.transformCoordinate(K$c[K$h],K$m._tempM0,K$m._tempV30);var K$Z=K$m._tempV30.elements,K$S=Math.abs(K$Z[0]),K$n=Math.abs(K$Z[1]),K$k=Math.abs(K$Z[2]);K$Kc.nearEqual(K$S,K$q)&&K$Kc.nearEqual(K$n,K$_)&&K$Kc.nearEqual(K$k,K$E)&&(K$e=!0),K$S<K$q&&K$n<K$_&&K$k<K$E?K$e=!0:K$b=!1}return K$b?1:K$e?2:0},K$c.containsSphere=function(K$c,K$P){void 0===K$P&&(K$P=!1);var K$q=this.extents.elements,K$_=K$q[0],K$E=K$q[1],K$b=K$q[2],K$e=K$c.radius;this.transformation.invert(K$m._tempM0),K$eP.transformCoordinate(K$c.center,K$m._tempM0,K$m._tempV30);var K$h=NaN;if(K$h=K$P?K$e:(K$eP.scale(K$eP.UnitX,K$e,K$m._tempV31),K$eP.TransformNormal(K$m._tempV31,K$m._tempM0,K$m._tempV31),K$eP.scalarLength(K$m._tempV31)),K$eP.scale(this.extents,-1,K$m._tempV32),K$eP.Clamp(K$m._tempV30,K$m._tempV32,this.extents,K$m._tempV33),K$h*K$h<K$eP.distanceSquared(K$m._tempV30,K$m._tempV33))return 0;var K$Z=K$m._tempV30.elements,K$S=K$Z[0],K$n=K$Z[1],K$k=K$Z[2],K$x=K$m._tempV32.elements,K$r=K$x[0],K$g=K$x[1],K$W=K$x[2];return K$r+K$h<=K$S&&K$S<=K$_-K$h&&K$h<K$_-K$r&&K$g+K$h<=K$n&&K$n<=K$E-K$h&&K$h<K$E-K$g&&K$W+K$h<=K$k&&K$k<=K$b-K$h&&K$h<K$b-K$W?1:2},K$c.containsOrientedBoundBox=function(K$c){var K$P=0,K$q=0;K$c.getCorners(K$m._corners);var K$_=this.containsPoints(K$m._corners);if(0!=K$_)return K$_;var K$E=this.extents.elements;K$c.extents.cloneTo(K$m._tempV35);var K$b=K$m._tempV35.elements;K$m._getRows(this.transformation,K$m._rows1),K$m._getRows(K$c.transformation,K$m._rows2);var K$e=NaN;for(K$P=0;K$P<4;K$P++)for(K$q=0;K$q<4;K$q++)3==K$P||3==K$q?(K$m._tempM0.setElementByRowColumn(K$P,K$q,0),K$m._tempM1.setElementByRowColumn(K$P,K$q,0)):(K$e=K$eP.dot(K$m._rows1[K$P],K$m._rows2[K$q]),K$m._tempM0.setElementByRowColumn(K$P,K$q,K$e),K$m._tempM1.setElementByRowColumn(K$P,K$q,Math.abs(K$e)));K$c.getCenter(K$m._tempV34),this.getCenter(K$m._tempV36),K$eP.subtract(K$m._tempV34,K$m._tempV36,K$m._tempV30);var K$h=K$m._tempV31.elements;K$h[0]=K$eP.dot(K$m._tempV30,K$m._rows1[0]),K$h[1]=K$eP.dot(K$m._tempV30,K$m._rows1[1]),K$h[2]=K$eP.dot(K$m._tempV30,K$m._rows1[2]);var K$Z=K$m._tempV32.elements,K$S=K$m._tempV33.elements;for(K$P=0;K$P<3;K$P++)if(K$Z[0]=K$m._tempM1.getElementByRowColumn(K$P,0),K$Z[1]=K$m._tempM1.getElementByRowColumn(K$P,1),K$Z[2]=K$m._tempM1.getElementByRowColumn(K$P,2),K$E[K$P]+K$eP.dot(K$m._tempV35,K$m._tempV32)<Math.abs(K$h[K$P]))return 0;for(K$q=0;K$q<3;K$q++)if(K$Z[0]=K$m._tempM1.getElementByRowColumn(0,K$q),K$Z[1]=K$m._tempM1.getElementByRowColumn(1,K$q),K$Z[2]=K$m._tempM1.getElementByRowColumn(2,K$q),K$S[0]=K$m._tempM0.getElementByRowColumn(0,K$q),K$S[1]=K$m._tempM0.getElementByRowColumn(1,K$q),K$S[2]=K$m._tempM0.getElementByRowColumn(2,K$q),K$eP.dot(this.extents,K$m._tempV32)+K$b[K$q]<Math.abs(K$eP.dot(K$m._tempV31,K$m._tempV33)))return 0;for(K$P=0;K$P<3;K$P++)for(K$q=0;K$q<3;K$q++){var K$n=(K$P+1)%3,K$k=(K$P+2)%3,K$x=(K$q+1)%3,K$r=(K$q+2)%3;if(K$E[K$n]*K$m._tempM1.getElementByRowColumn(K$k,K$q)+K$E[K$k]*K$m._tempM1.getElementByRowColumn(K$n,K$q)+(K$b[K$x]*K$m._tempM1.getElementByRowColumn(K$P,K$r)+K$b[K$r]*K$m._tempM1.getElementByRowColumn(K$P,K$x))<Math.abs(K$h[K$k]*K$m._tempM0.getElementByRowColumn(K$n,K$q)-K$h[K$n]*K$m._tempM0.getElementByRowColumn(K$k,K$q)))return 0}return 2},K$c.containsLine=function(K$c,K$P){K$m._corners[0]=K$c,K$m._corners[1]=K$P;var K$q=this.containsPoints(K$m._corners);if(0!=K$q)return K$q;var K$_=this.extents.elements,K$E=K$_[0],K$b=K$_[1],K$e=K$_[2];this.transformation.invert(K$m._tempM0),K$eP.transformCoordinate(K$c,K$m._tempM0,K$m._tempV30),K$eP.transformCoordinate(K$P,K$m._tempM0,K$m._tempV31),K$eP.add(K$m._tempV30,K$m._tempV31,K$m._tempV32),K$eP.scale(K$m._tempV32,.5,K$m._tempV32),K$eP.subtract(K$m._tempV30,K$m._tempV32,K$m._tempV33);var K$h=K$m._tempV33.elements,K$Z=K$h[0],K$S=K$h[1],K$n=K$h[2],K$k=K$m._tempV34.elements,K$x=K$k[0]=Math.abs(K$h[0]),K$r=K$k[1]=Math.abs(K$h[1]),K$g=K$k[2]=Math.abs(K$h[2]),K$W=K$m._tempV32.elements,K$w=K$W[0],K$O=K$W[1],K$N=K$W[2];return Math.abs(K$w)>K$E+K$x?0:Math.abs(K$O)>K$b+K$r?0:Math.abs(K$N)>K$e+K$g?0:Math.abs(K$O*K$n-K$N*K$S)>K$b*K$g+K$e*K$r?0:Math.abs(K$w*K$n-K$N*K$Z)>K$E*K$g+K$e*K$x?0:Math.abs(K$w*K$S-K$O*K$Z)>K$E*K$r+K$b*K$x?0:2},K$c.containsBoundBox=function(K$c){var K$P=0,K$q=0,K$_=K$c.min,K$E=K$c.max;K$c.getCorners(K$m._corners);var K$b=this.containsPoints(K$m._corners);if(0!=K$b)return K$b;K$eP.subtract(K$E,K$_,K$m._tempV30),K$eP.scale(K$m._tempV30,.5,K$m._tempV30),K$eP.add(K$_,K$m._tempV30,K$m._tempV30),K$eP.subtract(K$E,K$m._tempV30,K$m._tempV31);var K$e=this.extents.elements,K$h=K$m._tempV31.elements;K$m._getRows(this.transformation,K$m._rows1),this.transformation.invert(K$m._tempM0);for(K$P=0;K$P<3;K$P++)for(K$q=0;K$q<3;K$q++)K$m._tempM1.setElementByRowColumn(K$P,K$q,Math.abs(K$m._tempM0.getElementByRowColumn(K$P,K$q)));this.getCenter(K$m._tempV35),K$eP.subtract(K$m._tempV30,K$m._tempV35,K$m._tempV32);var K$Z=K$m._tempV31.elements;K$Z[0]=K$eP.dot(K$m._tempV32,K$m._rows1[0]),K$Z[1]=K$eP.dot(K$m._tempV32,K$m._rows1[1]),K$Z[2]=K$eP.dot(K$m._tempV32,K$m._rows1[2]);var K$S=K$m._tempV33.elements,K$n=K$m._tempV34.elements;for(K$P=0;K$P<3;K$P++)if(K$S[0]=K$m._tempM1.getElementByRowColumn(K$P,0),K$S[1]=K$m._tempM1.getElementByRowColumn(K$P,1),K$S[2]=K$m._tempM1.getElementByRowColumn(K$P,2),K$e[K$P]+K$eP.dot(K$m._tempV31,K$m._tempV33)<Math.abs(K$Z[K$P]))return 0;for(K$q=0;K$q<3;K$q++)if(K$S[0]=K$m._tempM1.getElementByRowColumn(0,K$q),K$S[1]=K$m._tempM1.getElementByRowColumn(1,K$q),K$S[2]=K$m._tempM1.getElementByRowColumn(2,K$q),K$n[0]=K$m._tempM0.getElementByRowColumn(0,K$q),K$n[1]=K$m._tempM0.getElementByRowColumn(1,K$q),K$n[2]=K$m._tempM0.getElementByRowColumn(2,K$q),K$eP.dot(this.extents,K$m._tempV33)+K$h[K$q]<Math.abs(K$eP.dot(K$m._tempV31,K$m._tempV34)))return 0;for(K$P=0;K$P<3;K$P++)for(K$q=0;K$q<3;K$q++){var K$k=(K$P+1)%3,K$x=(K$P+2)%3,K$r=(K$q+1)%3,K$g=(K$q+2)%3;if(K$e[K$k]*K$m._tempM1.getElementByRowColumn(K$x,K$q)+K$e[K$x]*K$m._tempM1.getElementByRowColumn(K$k,K$q)+(K$h[K$r]*K$m._tempM1.getElementByRowColumn(K$P,K$g)+K$h[K$g]*K$m._tempM1.getElementByRowColumn(K$P,K$r))<Math.abs(K$Z[K$x]*K$m._tempM0.getElementByRowColumn(K$k,K$q)-K$Z[K$k]*K$m._tempM0.getElementByRowColumn(K$x,K$q)))return 0}return 2},K$c.intersectsRay=function(K$c,K$P){K$eP.scale(this.extents,-1,K$m._tempV30),this.transformation.invert(K$m._tempM0),K$eP.TransformNormal(K$c.direction,K$m._tempM0,K$m._ray.direction),K$eP.transformCoordinate(K$c.origin,K$m._tempM0,K$m._ray.origin),K$m._boxBound1.min=K$m._tempV30,K$m._boxBound1.max=this.extents;var K$q=Collision.intersectsRayAndBoxRP(K$m._ray,K$m._boxBound1,K$P);return-1!==K$q&&K$eP.transformCoordinate(K$P,this.transformation,K$P),K$q},K$c._getLocalCorners=function(K$c){K$c.length=8;var K$P=this.extents.elements;K$m._tempV30.x=K$P[0],K$m._tempV31.y=K$P[1],K$m._tempV32.z=K$P[2],K$eP.add(K$m._tempV30,K$m._tempV31,K$m._tempV33),K$eP.add(K$m._tempV33,K$m._tempV32,K$c[0]),K$eP.add(K$m._tempV30,K$m._tempV31,K$m._tempV33),K$eP.subtract(K$m._tempV33,K$m._tempV32,K$c[1]),K$eP.subtract(K$m._tempV31,K$m._tempV30,K$m._tempV33),K$eP.subtract(K$m._tempV33,K$m._tempV30,K$c[2]),K$eP.subtract(K$m._tempV31,K$m._tempV30,K$m._tempV33),K$eP.add(K$m._tempV33,K$m._tempV32,K$c[3]),K$eP.subtract(K$m._tempV30,K$m._tempV31,K$m._tempV33),K$eP.add(K$m._tempV33,K$m._tempV32,K$c[4]),K$eP.subtract(K$m._tempV30,K$m._tempV31,K$m._tempV33),K$eP.subtract(K$m._tempV33,K$m._tempV32,K$c[5]),K$eP.scale(K$c[0],-1,K$c[6]),K$eP.subtract(K$m._tempV32,K$m._tempV30,K$m._tempV33),K$eP.subtract(K$m._tempV33,K$m._tempV31,K$c[7])},K$c.equals=function(K$c){return this.extents==K$c.extents&&this.transformation==K$c.transformation},K$c.cloneTo=function(K$c){var K$P=K$c;this.extents.cloneTo(K$P.extents),this.transformation.cloneTo(K$P.transformation)},K$m.createByBoundBox=function(K$c,K$P){var K$q=K$c.min,K$_=K$c.max;K$eP.subtract(K$_,K$q,K$m._tempV30),K$eP.scale(K$m._tempV30,.5,K$m._tempV30),K$eP.add(K$q,K$m._tempV30,K$m._tempV31),K$eP.subtract(K$_,K$m._tempV31,K$m._tempV32),K$cP.translation(K$m._tempV31,K$m._tempM0);var K$E=K$m._tempV32.clone(),K$b=K$m._tempM0.clone();K$P.extents=K$E,K$P.transformation=K$b},K$m.createByMinAndMaxVertex=function(K$c,K$P){return K$eP.subtract(K$P,K$c,K$m._tempV30),K$eP.scale(K$m._tempV30,.5,K$m._tempV30),K$eP.add(K$c,K$m._tempV30,K$m._tempV31),K$eP.subtract(K$P,K$m._tempV31,K$m._tempV32),K$cP.translation(K$m._tempV31,K$m._tempM0),new K$m(K$m._tempV32,K$m._tempM0)},K$m._getRows=function(K$c,K$P){K$P.length=3;var K$q=K$c.elements,K$_=K$P[0].elements;K$_[0]=K$q[0],K$_[1]=K$q[1],K$_[2]=K$q[2];var K$E=K$P[1].elements;K$E[0]=K$q[4],K$E[1]=K$q[5],K$E[2]=K$q[6];var K$b=K$P[2].elements;K$b[0]=K$q[8],K$b[1]=K$q[9],K$b[2]=K$q[10]},K$m.getObbtoObbMatrix4x4=function(K$c,K$P,K$q,K$_){var K$E=K$c.transformation,K$b=K$P.transformation;if(K$q){K$m._getRows(K$E,K$m._rows1),K$m._getRows(K$b,K$m._rows2);for(var K$e=0;K$e<3;K$e++)for(var K$h=0;K$h<3;K$h++)K$_.setElementByRowColumn(K$e,K$h,K$eP.dot(K$m._rows2[K$e],K$m._rows1[K$h]));K$P.getCenter(K$m._tempV30),K$c.getCenter(K$m._tempV31),K$eP.subtract(K$m._tempV30,K$m._tempV31,K$m._tempV32);var K$Z=K$_.elements;K$Z[12]=K$eP.dot(K$m._tempV32,K$m._rows1[0]),K$Z[13]=K$eP.dot(K$m._tempV32,K$m._rows1[1]),K$Z[14]=K$eP.dot(K$m._tempV32,K$m._rows1[2]),K$Z[15]=1}else K$E.invert(K$m._tempM0),K$cP.multiply(K$b,K$m._tempM0,K$_)},K$m.merge=function(K$c,K$P,K$q){var K$_=K$c.extents,K$E=K$c.transformation;K$m.getObbtoObbMatrix4x4(K$c,K$P,K$q,K$m._tempM0),K$P._getLocalCorners(K$m._corners),K$eP.transformCoordinate(K$m._corners[0],K$m._tempM0,K$m._corners[0]),K$eP.transformCoordinate(K$m._corners[1],K$m._tempM0,K$m._corners[1]),K$eP.transformCoordinate(K$m._corners[2],K$m._tempM0,K$m._corners[2]),K$eP.transformCoordinate(K$m._corners[3],K$m._tempM0,K$m._corners[3]),K$eP.transformCoordinate(K$m._corners[4],K$m._tempM0,K$m._corners[4]),K$eP.transformCoordinate(K$m._corners[5],K$m._tempM0,K$m._corners[5]),K$eP.transformCoordinate(K$m._corners[6],K$m._tempM0,K$m._corners[6]),K$eP.transformCoordinate(K$m._corners[7],K$m._tempM0,K$m._corners[7]),K$eP.scale(K$_,-1,K$m._boxBound1.min),K$_.cloneTo(K$m._boxBound1.max),K$Bc.createfromPoints(K$m._corners,K$m._boxBound2),K$Bc.merge(K$m._boxBound2,K$m._boxBound1,K$m._boxBound3);var K$b=K$m._boxBound3.min,K$e=K$m._boxBound3.max;K$eP.subtract(K$e,K$b,K$m._tempV30),K$eP.scale(K$m._tempV30,.5,K$m._tempV30),K$eP.add(K$b,K$m._tempV30,K$m._tempV32),K$eP.subtract(K$e,K$m._tempV32,K$_),K$eP.transformCoordinate(K$m._tempV32,K$E,K$m._tempV33)},K$k(K$m,["_tempV30",function(){return this._tempV30=new K$eP},"_tempV31",function(){return this._tempV31=new K$eP},"_tempV32",function(){return this._tempV32=new K$eP},"_tempV33",function(){return this._tempV33=new K$eP},"_tempV34",function(){return this._tempV34=new K$eP},"_tempV35",function(){return this._tempV35=new K$eP},"_tempV36",function(){return this._tempV36=new K$eP},"_tempM0",function(){return this._tempM0=new K$cP},"_tempM1",function(){return this._tempM1=new K$cP},"_corners",function(){return this._corners=[new K$eP,new K$eP,new K$eP,new K$eP,new K$eP,new K$eP,new K$eP,new K$eP]},"_rows1",function(){return this._rows1=[new K$eP,new K$eP,new K$eP]},"_rows2",function(){return this._rows2=[new K$eP,new K$eP,new K$eP]},"_ray",function(){return this._ray=new K$EP(new K$eP,new K$eP)},"_boxBound1",function(){return this._boxBound1=new K$Bc(new K$eP,new K$eP)},"_boxBound2",function(){return this._boxBound2=new K$Bc(new K$eP,new K$eP)},"_boxBound3",function(){return this._boxBound3=new K$Bc(new K$eP,new K$eP)}])}(),function(){function K$D(K$c,K$P){this.normal=null,this.distance=NaN,void 0===K$P&&(K$P=0),this.normal=K$c,this.distance=K$P}return K$r(K$D,"laya.d3.math.Plane"),K$D.prototype.normalize=function(){var K$c=this.normal.elements,K$P=K$c[0],K$q=K$c[1],K$_=K$c[2],K$E=1/Math.sqrt(K$P*K$P+K$q*K$q+K$_*K$_);K$c[0]=K$P*K$E,K$c[1]=K$q*K$E,K$c[2]=K$_*K$E,this.distance*=K$E},K$D.createPlaneBy3P=function(K$c,K$P,K$q){var K$_=K$c.elements,K$E=K$P.elements,K$b=K$q.elements,K$e=K$E[0]-K$_[0],K$h=K$E[1]-K$_[1],K$Z=K$E[2]-K$_[2],K$S=K$b[0]-K$_[0],K$n=K$b[1]-K$_[1],K$k=K$b[2]-K$_[2],K$x=K$h*K$k-K$Z*K$n,K$r=K$Z*K$S-K$e*K$k,K$g=K$e*K$n-K$h*K$S,K$W=1/Math.sqrt(K$x*K$x+K$r*K$r+K$g*K$g),K$w=K$x*K$W,K$O=K$r*K$W,K$N=K$g*K$W,K$m=K$D._TEMPVec3.elements;K$m[0]=K$w,K$m[1]=K$O,K$m[2]=K$N;var K$T=-(K$w*K$_[0]+K$O*K$_[1]+K$N*K$_[2]);return new K$D(K$D._TEMPVec3,K$T)},K$D.PlaneIntersectionType_Back=0,K$D.PlaneIntersectionType_Front=1,K$D.PlaneIntersectionType_Intersecting=2,K$k(K$D,["_TEMPVec3",function(){return this._TEMPVec3=new K$eP}]),K$D}()),K$qP=function(){function K$E(K$c,K$P,K$q,K$_){this.elements=new Float32Array(4),void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=1),this.elements[0]=K$c,this.elements[1]=K$P,this.elements[2]=K$q,this.elements[3]=K$_}K$r(K$E,"laya.d3.math.Quaternion");var K$c=K$E.prototype;return K$D.imps(K$c,{"laya.d3.core.IClone":!0}),K$c.scaling=function(K$c,K$P){var K$q=K$P.elements,K$_=this.elements;K$q[0]=K$_[0]*K$c,K$q[1]=K$_[1]*K$c,K$q[2]=K$_[2]*K$c,K$q[3]=K$_[3]*K$c},K$c.normalize=function(K$c){var K$P=K$c.elements,K$q=this.elements,K$_=K$q[0],K$E=K$q[1],K$b=K$q[2],K$e=K$q[3],K$h=K$_*K$_+K$E*K$E+K$b*K$b+K$e*K$e;0<K$h&&(K$h=1/Math.sqrt(K$h),K$P[0]=K$_*K$h,K$P[1]=K$E*K$h,K$P[2]=K$b*K$h,K$P[3]=K$e*K$h)},K$c.length=function(){var K$c=this.elements,K$P=K$c[0],K$q=K$c[1],K$_=K$c[2],K$E=K$c[3];return Math.sqrt(K$P*K$P+K$q*K$q+K$_*K$_+K$E*K$E)},K$c.rotateX=function(K$c,K$P){var K$q=K$P.elements,K$_=this.elements;K$c*=.5;var K$E=K$_[0],K$b=K$_[1],K$e=K$_[2],K$h=K$_[3],K$Z=Math.sin(K$c),K$S=Math.cos(K$c);K$q[0]=K$E*K$S+K$h*K$Z,K$q[1]=K$b*K$S+K$e*K$Z,K$q[2]=K$e*K$S-K$b*K$Z,K$q[3]=K$h*K$S-K$E*K$Z},K$c.rotateY=function(K$c,K$P){var K$q=K$P.elements,K$_=this.elements;K$c*=.5;var K$E=K$_[0],K$b=K$_[1],K$e=K$_[2],K$h=K$_[3],K$Z=Math.sin(K$c),K$S=Math.cos(K$c);K$q[0]=K$E*K$S-K$e*K$Z,K$q[1]=K$b*K$S+K$h*K$Z,K$q[2]=K$e*K$S+K$E*K$Z,K$q[3]=K$h*K$S-K$b*K$Z},K$c.rotateZ=function(K$c,K$P){var K$q=K$P.elements,K$_=this.elements;K$c*=.5;var K$E=K$_[0],K$b=K$_[1],K$e=K$_[2],K$h=K$_[3],K$Z=Math.sin(K$c),K$S=Math.cos(K$c);K$q[0]=K$E*K$S+K$b*K$Z,K$q[1]=K$b*K$S-K$E*K$Z,K$q[2]=K$e*K$S+K$h*K$Z,K$q[3]=K$h*K$S-K$e*K$Z},K$c.getYawPitchRoll=function(K$c){K$eP.transformQuat(K$eP.ForwardRH,this,K$E.TEMPVector31),K$eP.transformQuat(K$eP.Up,this,K$E.TEMPVector32);var K$P=K$E.TEMPVector32.elements;K$E.angleTo(K$eP.ZERO,K$E.TEMPVector31,K$E.TEMPVector33);var K$q=K$E.TEMPVector33.elements;K$q[0]==Math.PI/2?(K$q[1]=K$E.arcTanAngle(K$P[2],K$P[0]),K$q[2]=0):K$q[0]==-Math.PI/2?(K$q[1]=K$E.arcTanAngle(-K$P[2],-K$P[0]),K$q[2]=0):(K$cP.createRotationY(-K$q[1],K$E.TEMPMatrix0),K$cP.createRotationX(-K$q[0],K$E.TEMPMatrix1),K$eP.transformCoordinate(K$E.TEMPVector32,K$E.TEMPMatrix0,K$E.TEMPVector32),K$eP.transformCoordinate(K$E.TEMPVector32,K$E.TEMPMatrix1,K$E.TEMPVector32),K$q[2]=K$E.arcTanAngle(K$P[1],-K$P[0])),K$q[1]<=-Math.PI&&(K$q[1]=Math.PI),K$q[2]<=-Math.PI&&(K$q[2]=Math.PI),K$q[1]>=Math.PI&&K$q[2]>=Math.PI&&(K$q[1]=0,K$q[2]=0,K$q[0]=Math.PI-K$q[0]);var K$_=K$c.elements;K$_[0]=K$q[1],K$_[1]=K$q[0],K$_[2]=K$q[2]},K$c.invert=function(K$c){var K$P=K$c.elements,K$q=this.elements,K$_=K$q[0],K$E=K$q[1],K$b=K$q[2],K$e=K$q[3],K$h=K$_*K$_+K$E*K$E+K$b*K$b+K$e*K$e,K$Z=K$h?1/K$h:0;K$P[0]=-K$_*K$Z,K$P[1]=-K$E*K$Z,K$P[2]=-K$b*K$Z,K$P[3]=K$e*K$Z},K$c.identity=function(){var K$c=this.elements;K$c[0]=0,K$c[1]=0,K$c[2]=0,K$c[3]=1},K$c.fromArray=function(K$c,K$P){void 0===K$P&&(K$P=0),this.elements[0]=K$c[K$P+0],this.elements[1]=K$c[K$P+1],this.elements[2]=K$c[K$P+2],this.elements[3]=K$c[K$P+3]},K$c.cloneTo=function(K$c){var K$P,K$q,K$_;if((K$q=this.elements)!==(K$_=K$c.elements))for(K$P=0;K$P<4;++K$P)K$_[K$P]=K$q[K$P]},K$c.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$c.equals=function(K$c){var K$P=this.elements,K$q=K$c.elements;return K$Kc.nearEqual(K$P[0],K$q[0])&&K$Kc.nearEqual(K$P[1],K$q[1])&&K$Kc.nearEqual(K$P[2],K$q[2])&&K$Kc.nearEqual(K$P[3],K$q[3])},K$c.lengthSquared=function(){var K$c=this.elements[0],K$P=this.elements[1],K$q=this.elements[2],K$_=this.elements[3];return K$c*K$c+K$P*K$P+K$q*K$q+K$_*K$_},K$g(0,K$c,"x",function(){return this.elements[0]}),K$g(0,K$c,"y",function(){return this.elements[1]}),K$g(0,K$c,"z",function(){return this.elements[2]}),K$g(0,K$c,"w",function(){return this.elements[3]}),K$E.createFromYawPitchRoll=function(K$c,K$P,K$q,K$_){var K$E=.5*K$q,K$b=.5*K$P,K$e=.5*K$c,K$h=Math.sin(K$E),K$Z=Math.cos(K$E),K$S=Math.sin(K$b),K$n=Math.cos(K$b),K$k=Math.sin(K$e),K$x=Math.cos(K$e),K$r=K$_.elements;K$r[0]=K$x*K$S*K$Z+K$k*K$n*K$h,K$r[1]=K$k*K$n*K$Z-K$x*K$S*K$h,K$r[2]=K$x*K$n*K$h-K$k*K$S*K$Z,K$r[3]=K$x*K$n*K$Z+K$k*K$S*K$h},K$E.multiply=function(K$c,K$P,K$q){var K$_=K$c.elements,K$E=K$P.elements,K$b=K$q.elements,K$e=K$_[0],K$h=K$_[1],K$Z=K$_[2],K$S=K$_[3],K$n=K$E[0],K$k=K$E[1],K$x=K$E[2],K$r=K$E[3],K$g=K$h*K$x-K$Z*K$k,K$W=K$Z*K$n-K$e*K$x,K$w=K$e*K$k-K$h*K$n,K$O=K$e*K$n+K$h*K$k+K$Z*K$x;K$b[0]=K$e*K$r+K$n*K$S+K$g,K$b[1]=K$h*K$r+K$k*K$S+K$W,K$b[2]=K$Z*K$r+K$x*K$S+K$w,K$b[3]=K$S*K$r-K$O},K$E.arcTanAngle=function(K$c,K$P){return 0==K$c?1==K$P?Math.PI/2:-Math.PI/2:0<K$c?Math.atan(K$P/K$c):K$c<0?0<K$P?Math.atan(K$P/K$c)+Math.PI:Math.atan(K$P/K$c)-Math.PI:0},K$E.angleTo=function(K$c,K$P,K$q){K$eP.subtract(K$P,K$c,K$E.TEMPVector30),K$eP.normalize(K$E.TEMPVector30,K$E.TEMPVector30),K$q.elements[0]=Math.asin(K$E.TEMPVector30.y),K$q.elements[1]=K$E.arcTanAngle(-K$E.TEMPVector30.z,-K$E.TEMPVector30.x)},K$E.createFromAxisAngle=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements;K$P*=.5;var K$b=Math.sin(K$P);K$_[0]=K$b*K$E[0],K$_[1]=K$b*K$E[1],K$_[2]=K$b*K$E[2],K$_[3]=Math.cos(K$P)},K$E.createFromMatrix3x3=function(K$c,K$P){var K$q,K$_=K$P.elements,K$E=K$c.elements,K$b=K$E[0]+K$E[4]+K$E[8];if(0<K$b)K$q=Math.sqrt(K$b+1),K$_[3]=.5*K$q,K$q=.5/K$q,K$_[0]=(K$E[5]-K$E[7])*K$q,K$_[1]=(K$E[6]-K$E[2])*K$q,K$_[2]=(K$E[1]-K$E[3])*K$q;else{var K$e=0;K$E[4]>K$E[0]&&(K$e=1),K$E[8]>K$E[3*K$e+K$e]&&(K$e=2);var K$h=(K$e+1)%3,K$Z=(K$e+2)%3;K$q=Math.sqrt(K$E[3*K$e+K$e]-K$E[3*K$h+K$h]-K$E[3*K$Z+K$Z]+1),K$_[K$e]=.5*K$q,K$q=.5/K$q,K$_[3]=(K$E[3*K$h+K$Z]-K$E[3*K$Z+K$h])*K$q,K$_[K$h]=(K$E[3*K$h+K$e]+K$E[3*K$e+K$h])*K$q,K$_[K$Z]=(K$E[3*K$Z+K$e]+K$E[3*K$e+K$Z])*K$q}},K$E.createFromMatrix4x4=function(K$c,K$P){var K$q,K$_,K$E=K$c.elements,K$b=K$P.elements,K$e=K$E[0]+K$E[5]+K$E[10];0<K$e?(K$q=Math.sqrt(K$e+1),K$b[3]=.5*K$q,K$q=.5/K$q,K$b[0]=(K$E[6]-K$E[9])*K$q,K$b[1]=(K$E[8]-K$E[2])*K$q,K$b[2]=(K$E[1]-K$E[4])*K$q):K$E[0]>=K$E[5]&&K$E[0]>=K$E[10]?(K$_=.5/(K$q=Math.sqrt(1+K$E[0]-K$E[5]-K$E[10])),K$b[0]=.5*K$q,K$b[1]=(K$E[1]+K$E[4])*K$_,K$b[2]=(K$E[2]+K$E[8])*K$_,K$b[3]=(K$E[6]-K$E[9])*K$_):K$E[5]>K$E[10]?(K$_=.5/(K$q=Math.sqrt(1+K$E[5]-K$E[0]-K$E[10])),K$b[0]=(K$E[4]+K$E[1])*K$_,K$b[1]=.5*K$q,K$b[2]=(K$E[9]+K$E[6])*K$_,K$b[3]=(K$E[8]-K$E[2])*K$_):(K$_=.5/(K$q=Math.sqrt(1+K$E[10]-K$E[0]-K$E[5])),K$b[0]=(K$E[8]+K$E[2])*K$_,K$b[1]=(K$E[9]+K$E[6])*K$_,K$b[2]=.5*K$q,K$b[3]=(K$E[1]-K$E[4])*K$_)},K$E.slerp=function(K$c,K$P,K$q,K$_){var K$E,K$b,K$e,K$h,K$Z,K$S=K$c.elements,K$n=K$P.elements,K$k=K$_.elements,K$x=K$S[0],K$r=K$S[1],K$g=K$S[2],K$W=K$S[3],K$w=K$n[0],K$O=K$n[1],K$N=K$n[2],K$m=K$n[3];return(K$b=K$x*K$w+K$r*K$O+K$g*K$N+K$W*K$m)<0&&(K$b=-K$b,K$w=-K$w,K$O=-K$O,K$N=-K$N,K$m=-K$m),K$Z=1e-6<1-K$b?(K$E=Math.acos(K$b),K$e=Math.sin(K$E),K$h=Math.sin((1-K$q)*K$E)/K$e,Math.sin(K$q*K$E)/K$e):(K$h=1-K$q,K$q),K$k[0]=K$h*K$x+K$Z*K$w,K$k[1]=K$h*K$r+K$Z*K$O,K$k[2]=K$h*K$g+K$Z*K$N,K$k[3]=K$h*K$W+K$Z*K$m,K$k},K$E.lerp=function(K$c,K$P,K$q,K$_){var K$E=K$_.elements,K$b=K$c.elements,K$e=K$P.elements,K$h=K$b[0],K$Z=K$b[1],K$S=K$b[2],K$n=K$b[3];K$E[0]=K$h+K$q*(K$e[0]-K$h),K$E[1]=K$Z+K$q*(K$e[1]-K$Z),K$E[2]=K$S+K$q*(K$e[2]-K$S),K$E[3]=K$n+K$q*(K$e[3]-K$n)},K$E.add=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements;K$_[0]=K$E[0]+K$b[0],K$_[1]=K$E[1]+K$b[1],K$_[2]=K$E[2]+K$b[2],K$_[3]=K$E[3]+K$b[3]},K$E.dot=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements;return K$q[0]*K$_[0]+K$q[1]*K$_[1]+K$q[2]*K$_[2]+K$q[3]*K$_[3]},K$E.rotationLookAt=function(K$c,K$P,K$q){K$E.lookAt(K$eP.ZERO,K$c,K$P,K$q)},K$E.lookAt=function(K$c,K$P,K$q,K$_){K$Gc.lookAt(K$c,K$P,K$q,K$E._tempMatrix3x3),K$E.rotationMatrix(K$E._tempMatrix3x3,K$_)},K$E.invert=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements,K$E=K$c.lengthSquared();K$Kc.isZero(K$E)||(K$E=1/K$E,K$_[0]=-K$q[0]*K$E,K$_[1]=-K$q[1]*K$E,K$_[2]=-K$q[2]*K$E,K$_[3]=K$q[3]*K$E)},K$E.rotationMatrix=function(K$c,K$P){var K$q=K$c.elements,K$_=K$q[0],K$E=K$q[1],K$b=K$q[2],K$e=K$q[3],K$h=K$q[4],K$Z=K$q[5],K$S=K$q[6],K$n=K$q[7],K$k=K$q[8],K$x=K$P.elements,K$r=NaN,K$g=NaN,K$W=K$_+K$h+K$k;0<K$W?(K$r=Math.sqrt(K$W+1),K$x[3]=.5*K$r,K$r=.5/K$r,K$x[0]=(K$Z-K$n)*K$r,K$x[1]=(K$S-K$b)*K$r,K$x[2]=(K$E-K$e)*K$r):K$h<=K$_&&K$k<=K$_?(K$g=.5/(K$r=Math.sqrt(1+K$_-K$h-K$k)),K$x[0]=.5*K$r,K$x[1]=(K$E+K$e)*K$g,K$x[2]=(K$b+K$S)*K$g,K$x[3]=(K$Z-K$n)*K$g):K$k<K$h?(K$g=.5/(K$r=Math.sqrt(1+K$h-K$_-K$k)),K$x[0]=(K$e+K$E)*K$g,K$x[1]=.5*K$r,K$x[2]=(K$n+K$Z)*K$g,K$x[3]=(K$S-K$b)*K$g):(K$g=.5/(K$r=Math.sqrt(1+K$k-K$_-K$h)),K$x[0]=(K$S+K$b)*K$g,K$x[1]=(K$n+K$Z)*K$g,K$x[2]=.5*K$r,K$x[3]=(K$E-K$e)*K$g)},K$E.DEFAULT=new K$E,K$k(K$E,["TEMPVector30",function(){return this.TEMPVector30=new K$eP},"TEMPVector31",function(){return this.TEMPVector31=new K$eP},"TEMPVector32",function(){return this.TEMPVector32=new K$eP},"TEMPVector33",function(){return this.TEMPVector33=new K$eP},"TEMPMatrix0",function(){return this.TEMPMatrix0=new K$cP},"TEMPMatrix1",function(){return this.TEMPMatrix1=new K$cP},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new K$Gc},"NAN",function(){return this.NAN=new K$E(NaN,NaN,NaN,NaN)}]),K$E}(),K$_P=function(){function K$c(K$c){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=K$c,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}K$r(K$c,"laya.d3.math.Rand");var K$P=K$c.prototype;return K$P.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},K$P.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},K$P.getSignedFloat=function(){return 2*this.getFloat()-1},K$g(0,K$P,"seed",function(){return this.seeds[0]},function(K$c){this.seeds[0]=K$c,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),K$c.getFloatFromInt=function(K$c){return 1/8388607*(8388607&K$c)},K$c.getByteFromInt=function(K$c){return(8388607&K$c)>>>15},K$c}(),K$EP=(function(){function K$E(K$c){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(K$c instanceof Array)||4!==K$c.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|K$c[0],this._state0L=0|K$c[1],this._state1U=0|K$c[2],this._state1L=0|K$c[3]}K$r(K$E,"laya.d3.math.RandX");var K$c=K$E.prototype;K$c.randomint=function(){var K$c=this._state0U,K$P=this._state0L,K$q=this._state1U,K$_=this._state1L,K$E=(K$_>>>0)+(K$P>>>0),K$b=K$q+K$c+(K$E/2>>>31)>>>0,K$e=K$E>>>0,K$h=0,K$Z=0;K$h=(K$c^=K$h=K$c<<23|(-512&K$P)>>>9)^(this._state0U=K$q),K$Z=(K$P^=K$Z=K$P<<23)^(this._state0L=K$_);K$h^=K$c>>>18,K$Z^=K$P>>>18|(262143&K$c)<<14;return K$h^=K$q>>>5,K$Z^=K$_>>>5|(31&K$q)<<27,this._state1U=K$h,this._state1L=K$Z,[K$b,K$e]},K$c.random=function(){var K$c=this.randomint(),K$P=K$c[0],K$q=1023<<20|K$P>>>12,K$_=0|(K$c[1]>>>12|(4095&K$P)<<20);return K$E._CONVERTION_BUFFER.setUint32(0,K$q,!1),K$E._CONVERTION_BUFFER.setUint32(4,K$_,!1),K$_P._CONVERTION_BUFFER.getFloat64(0,!1)-1},K$k(K$E,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new K$_P([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function K$c(K$c,K$P){this.origin=null,this.direction=null,this.origin=K$c,this.direction=K$P}return K$r(K$c,"laya.d3.math.Ray"),K$c}()),K$bP=function(){function K$c(K$c,K$P){this.elements=new Float32Array(2),void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0);var K$q=this.elements;K$q[0]=K$c,K$q[1]=K$P}K$r(K$c,"laya.d3.math.Vector2");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P.fromArray=function(K$c,K$P){void 0===K$P&&(K$P=0),this.elements[0]=K$c[K$P+0],this.elements[1]=K$c[K$P+1]},K$P.cloneTo=function(K$c){var K$P=K$c.elements,K$q=this.elements;K$P[0]=K$q[0],K$P[1]=K$q[1]},K$P.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$P,"x",function(){return this.elements[0]},function(K$c){this.elements[0]=K$c}),K$g(0,K$P,"y",function(){return this.elements[1]},function(K$c){this.elements[1]=K$c}),K$c.scale=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements;K$_[0]=K$E[0]*K$P,K$_[1]=K$E[1]*K$P},K$k(K$c,["ZERO",function(){return this.ZERO=new K$c(0,0)},"ONE",function(){return this.ONE=new K$c(1,1)}]),K$c}(),K$eP=function(){function K$n(K$c,K$P,K$q){this.elements=new Float32Array(3),void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0);var K$_=this.elements;K$_[0]=K$c,K$_[1]=K$P,K$_[2]=K$q}K$r(K$n,"laya.d3.math.Vector3");var K$c=K$n.prototype;return K$D.imps(K$c,{"laya.d3.core.IClone":!0}),K$c.fromArray=function(K$c,K$P){void 0===K$P&&(K$P=0),this.elements[0]=K$c[K$P+0],this.elements[1]=K$c[K$P+1],this.elements[2]=K$c[K$P+2]},K$c.cloneTo=function(K$c){var K$P=K$c.elements,K$q=this.elements;K$P[0]=K$q[0],K$P[1]=K$q[1],K$P[2]=K$q[2]},K$c.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$c.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},K$c.reset=function(K$c,K$P,K$q){this.elements[0]=K$c,this.elements[1]=K$P,this.elements[2]=K$q},K$g(0,K$c,"x",function(){return this.elements[0]},function(K$c){this.elements[0]=K$c}),K$g(0,K$c,"y",function(){return this.elements[1]},function(K$c){this.elements[1]=K$c}),K$g(0,K$c,"z",function(){return this.elements[2]},function(K$c){this.elements[2]=K$c}),K$n.distanceSquared=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements,K$E=K$q[0]-K$_[0],K$b=K$q[1]-K$_[1],K$e=K$q[2]-K$_[2];return K$E*K$E+K$b*K$b+K$e*K$e},K$n.distance=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements,K$E=K$q[0]-K$_[0],K$b=K$q[1]-K$_[1],K$e=K$q[2]-K$_[2];return Math.sqrt(K$E*K$E+K$b*K$b+K$e*K$e)},K$n.min=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements;K$_[0]=Math.min(K$E[0],K$b[0]),K$_[1]=Math.min(K$E[1],K$b[1]),K$_[2]=Math.min(K$E[2],K$b[2])},K$n.max=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements;K$_[0]=Math.max(K$E[0],K$b[0]),K$_[1]=Math.max(K$E[1],K$b[1]),K$_[2]=Math.max(K$E[2],K$b[2])},K$n.transformQuat=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements,K$e=K$E[0],K$h=K$E[1],K$Z=K$E[2],K$S=K$b[0],K$n=K$b[1],K$k=K$b[2],K$x=K$b[3],K$r=K$x*K$e+K$n*K$Z-K$k*K$h,K$g=K$x*K$h+K$k*K$e-K$S*K$Z,K$W=K$x*K$Z+K$S*K$h-K$n*K$e,K$w=-K$S*K$e-K$n*K$h-K$k*K$Z;K$_[0]=K$r*K$x+K$w*-K$S+K$g*-K$k-K$W*-K$n,K$_[1]=K$g*K$x+K$w*-K$n+K$W*-K$S-K$r*-K$k,K$_[2]=K$W*K$x+K$w*-K$k+K$r*-K$n-K$g*-K$S},K$n.scalarLength=function(K$c){var K$P=K$c.elements,K$q=K$P[0],K$_=K$P[1],K$E=K$P[2];return Math.sqrt(K$q*K$q+K$_*K$_+K$E*K$E)},K$n.scalarLengthSquared=function(K$c){var K$P=K$c.elements,K$q=K$P[0],K$_=K$P[1],K$E=K$P[2];return K$q*K$q+K$_*K$_+K$E*K$E},K$n.normalize=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements,K$E=K$q[0],K$b=K$q[1],K$e=K$q[2],K$h=K$E*K$E+K$b*K$b+K$e*K$e;0<K$h&&(K$h=1/Math.sqrt(K$h),K$_[0]=K$q[0]*K$h,K$_[1]=K$q[1]*K$h,K$_[2]=K$q[2]*K$h)},K$n.multiply=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements;K$_[0]=K$E[0]*K$b[0],K$_[1]=K$E[1]*K$b[1],K$_[2]=K$E[2]*K$b[2]},K$n.scale=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements;K$_[0]=K$E[0]*K$P,K$_[1]=K$E[1]*K$P,K$_[2]=K$E[2]*K$P},K$n.lerp=function(K$c,K$P,K$q,K$_){var K$E=K$_.elements,K$b=K$c.elements,K$e=K$P.elements,K$h=K$b[0],K$Z=K$b[1],K$S=K$b[2];K$E[0]=K$h+K$q*(K$e[0]-K$h),K$E[1]=K$Z+K$q*(K$e[1]-K$Z),K$E[2]=K$S+K$q*(K$e[2]-K$S)},K$n.transformV3ToV3=function(K$c,K$P,K$q){var K$_=K$n._tempVector4;K$n.transformV3ToV4(K$c,K$P,K$_);var K$E=K$_.elements,K$b=K$q.elements;K$b[0]=K$E[0],K$b[1]=K$E[1],K$b[2]=K$E[2]},K$n.transformV3ToV4=function(K$c,K$P,K$q){var K$_=K$c.elements,K$E=K$_[0],K$b=K$_[1],K$e=K$_[2],K$h=K$P.elements,K$Z=K$q.elements;K$Z[0]=K$E*K$h[0]+K$b*K$h[4]+K$e*K$h[8]+K$h[12],K$Z[1]=K$E*K$h[1]+K$b*K$h[5]+K$e*K$h[9]+K$h[13],K$Z[2]=K$E*K$h[2]+K$b*K$h[6]+K$e*K$h[10]+K$h[14],K$Z[3]=K$E*K$h[3]+K$b*K$h[7]+K$e*K$h[11]+K$h[15]},K$n.TransformNormal=function(K$c,K$P,K$q){var K$_=K$c.elements,K$E=K$_[0],K$b=K$_[1],K$e=K$_[2],K$h=K$P.elements,K$Z=K$q.elements;K$Z[0]=K$E*K$h[0]+K$b*K$h[4]+K$e*K$h[8],K$Z[1]=K$E*K$h[1]+K$b*K$h[5]+K$e*K$h[9],K$Z[2]=K$E*K$h[2]+K$b*K$h[6]+K$e*K$h[10]},K$n.transformCoordinate=function(K$c,K$P,K$q){var K$_=K$n._tempVector4.elements,K$E=K$c.elements,K$b=K$E[0],K$e=K$E[1],K$h=K$E[2],K$Z=K$P.elements;K$_[0]=K$b*K$Z[0]+K$e*K$Z[4]+K$h*K$Z[8]+K$Z[12],K$_[1]=K$b*K$Z[1]+K$e*K$Z[5]+K$h*K$Z[9]+K$Z[13],K$_[2]=K$b*K$Z[2]+K$e*K$Z[6]+K$h*K$Z[10]+K$Z[14],K$_[3]=1/(K$b*K$Z[3]+K$e*K$Z[7]+K$h*K$Z[11]+K$Z[15]);var K$S=K$q.elements;K$S[0]=K$_[0]*K$_[3],K$S[1]=K$_[1]*K$_[3],K$S[2]=K$_[2]*K$_[3]},K$n.Clamp=function(K$c,K$P,K$q,K$_){var K$E=K$c.elements,K$b=K$E[0],K$e=K$E[1],K$h=K$E[2],K$Z=K$P.elements,K$S=K$Z[0],K$n=K$Z[1],K$k=K$Z[2],K$x=K$q.elements,K$r=K$x[0],K$g=K$x[1],K$W=K$x[2],K$w=K$_.elements;K$b=(K$b=K$r<K$b?K$r:K$b)<K$S?K$S:K$b,K$e=(K$e=K$g<K$e?K$g:K$e)<K$n?K$n:K$e,K$h=(K$h=K$W<K$h?K$W:K$h)<K$k?K$k:K$h,K$w[0]=K$b,K$w[1]=K$e,K$w[2]=K$h},K$n.add=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements;K$_[0]=K$E[0]+K$b[0],K$_[1]=K$E[1]+K$b[1],K$_[2]=K$E[2]+K$b[2]},K$n.subtract=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements;K$_[0]=K$E[0]-K$b[0],K$_[1]=K$E[1]-K$b[1],K$_[2]=K$E[2]-K$b[2]},K$n.cross=function(K$c,K$P,K$q){var K$_=K$c.elements,K$E=K$P.elements,K$b=K$q.elements,K$e=K$_[0],K$h=K$_[1],K$Z=K$_[2],K$S=K$E[0],K$n=K$E[1],K$k=K$E[2];K$b[0]=K$h*K$k-K$Z*K$n,K$b[1]=K$Z*K$S-K$e*K$k,K$b[2]=K$e*K$n-K$h*K$S},K$n.dot=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements;return K$q[0]*K$_[0]+K$q[1]*K$_[1]+K$q[2]*K$_[2]},K$n.equals=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements;return K$Kc.nearEqual(Math.abs(K$q[0]),Math.abs(K$_[0]))&&K$Kc.nearEqual(Math.abs(K$q[1]),Math.abs(K$_[1]))&&K$Kc.nearEqual(Math.abs(K$q[2]),Math.abs(K$_[2]))},K$n.ZERO=new K$n(0,0,0),K$n.ONE=new K$n(1,1,1),K$n.NegativeUnitX=new K$n(-1,0,0),K$n.UnitX=new K$n(1,0,0),K$n.UnitY=new K$n(0,1,0),K$n.UnitZ=new K$n(0,0,1),K$n.ForwardRH=new K$n(0,0,-1),K$n.ForwardLH=new K$n(0,0,1),K$n.Up=new K$n(0,1,0),K$n.NAN=new K$n(NaN,NaN,NaN),K$k(K$n,["_tempVector4",function(){return this._tempVector4=new K$hP}]),K$n}(),K$hP=function(){function K$c(K$c,K$P,K$q,K$_){this.elements=new Float32Array(4),void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=0);var K$E=this.elements;K$E[0]=K$c,K$E[1]=K$P,K$E[2]=K$q,K$E[3]=K$_}K$r(K$c,"laya.d3.math.Vector4");var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P.fromArray=function(K$c,K$P){void 0===K$P&&(K$P=0),this.elements[0]=K$c[K$P+0],this.elements[1]=K$c[K$P+1],this.elements[2]=K$c[K$P+2],this.elements[3]=K$c[K$P+3]},K$P.cloneTo=function(K$c){var K$P=K$c.elements,K$q=this.elements;K$P[0]=K$q[0],K$P[1]=K$q[1],K$P[2]=K$q[2],K$P[3]=K$q[3]},K$P.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$P.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},K$P.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},K$g(0,K$P,"x",function(){return this.elements[0]},function(K$c){this.elements[0]=K$c}),K$g(0,K$P,"y",function(){return this.elements[1]},function(K$c){this.elements[1]=K$c}),K$g(0,K$P,"z",function(){return this.elements[2]},function(K$c){this.elements[2]=K$c}),K$g(0,K$P,"w",function(){return this.elements[3]},function(K$c){this.elements[3]=K$c}),K$c.lerp=function(K$c,K$P,K$q,K$_){var K$E=K$_.elements,K$b=K$c.elements,K$e=K$P.elements,K$h=K$b[0],K$Z=K$b[1],K$S=K$b[2],K$n=K$b[3];K$E[0]=K$h+K$q*(K$e[0]-K$h),K$E[1]=K$Z+K$q*(K$e[1]-K$Z),K$E[2]=K$S+K$q*(K$e[2]-K$S),K$E[3]=K$n+K$q*(K$e[3]-K$n)},K$c.transformByM4x4=function(K$c,K$P,K$q){var K$_=K$c.elements,K$E=K$_[0],K$b=K$_[1],K$e=K$_[2],K$h=K$_[3],K$Z=K$P.elements,K$S=K$q.elements;K$S[0]=K$E*K$Z[0]+K$b*K$Z[4]+K$e*K$Z[8]+K$h*K$Z[12],K$S[1]=K$E*K$Z[1]+K$b*K$Z[5]+K$e*K$Z[9]+K$h*K$Z[13],K$S[2]=K$E*K$Z[2]+K$b*K$Z[6]+K$e*K$Z[10]+K$h*K$Z[14],K$S[3]=K$E*K$Z[3]+K$b*K$Z[7]+K$e*K$Z[11]+K$h*K$Z[15]},K$c.equals=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements;return K$Kc.nearEqual(Math.abs(K$q[0]),Math.abs(K$_[0]))&&K$Kc.nearEqual(Math.abs(K$q[1]),Math.abs(K$_[1]))&&K$Kc.nearEqual(Math.abs(K$q[2]),Math.abs(K$_[2]))&&K$Kc.nearEqual(Math.abs(K$q[3]),Math.abs(K$_[3]))},K$c.normalize=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements,K$E=K$c.length();0<K$E&&(K$_[0]=K$q[0]*K$E,K$_[1]=K$q[1]*K$E,K$_[2]=K$q[2]*K$E,K$_[3]=K$q[3]*K$E)},K$c.add=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements;K$_[0]=K$E[0]+K$b[0],K$_[1]=K$E[1]+K$b[1],K$_[2]=K$E[2]+K$b[2],K$_[3]=K$E[3]+K$b[3]},K$c.subtract=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements;K$_[0]=K$E[0]-K$b[0],K$_[1]=K$E[1]-K$b[1],K$_[2]=K$E[2]-K$b[2],K$_[3]=K$E[3]-K$b[3]},K$c.multiply=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements;K$_[0]=K$E[0]*K$b[0],K$_[1]=K$E[1]*K$b[1],K$_[2]=K$E[2]*K$b[2],K$_[3]=K$E[3]*K$b[3]},K$c.scale=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements;K$_[0]=K$E[0]*K$P,K$_[1]=K$E[1]*K$P,K$_[2]=K$E[2]*K$P,K$_[3]=K$E[3]*K$P},K$c.Clamp=function(K$c,K$P,K$q,K$_){var K$E=K$c.elements,K$b=K$E[0],K$e=K$E[1],K$h=K$E[2],K$Z=K$E[3],K$S=K$P.elements,K$n=K$S[0],K$k=K$S[1],K$x=K$S[2],K$r=K$S[3],K$g=K$q.elements,K$W=K$g[0],K$w=K$g[1],K$O=K$g[2],K$N=K$g[3],K$m=K$_.elements;K$b=(K$b=K$W<K$b?K$W:K$b)<K$n?K$n:K$b,K$e=(K$e=K$w<K$e?K$w:K$e)<K$k?K$k:K$e,K$h=(K$h=K$O<K$h?K$O:K$h)<K$x?K$x:K$h,K$Z=(K$Z=K$N<K$Z?K$N:K$Z)<K$r?K$r:K$Z,K$m[0]=K$b,K$m[1]=K$e,K$m[2]=K$h,K$m[3]=K$Z},K$c.distanceSquared=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements,K$E=K$q[0]-K$_[0],K$b=K$q[1]-K$_[1],K$e=K$q[2]-K$_[2],K$h=K$q[3]-K$_[3];return K$E*K$E+K$b*K$b+K$e*K$e+K$h*K$h},K$c.distance=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements,K$E=K$q[0]-K$_[0],K$b=K$q[1]-K$_[1],K$e=K$q[2]-K$_[2],K$h=K$q[3]-K$_[3];return Math.sqrt(K$E*K$E+K$b*K$b+K$e*K$e+K$h*K$h)},K$c.dot=function(K$c,K$P){var K$q=K$c.elements,K$_=K$P.elements;return K$q[0]*K$_[0]+K$q[1]*K$_[1]+K$q[2]*K$_[2]+K$q[3]*K$_[3]},K$c.min=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements;K$_[0]=Math.min(K$E[0],K$b[0]),K$_[1]=Math.min(K$E[1],K$b[1]),K$_[2]=Math.min(K$E[2],K$b[2]),K$_[3]=Math.min(K$E[3],K$b[3])},K$c.max=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P.elements;K$_[0]=Math.max(K$E[0],K$b[0]),K$_[1]=Math.max(K$E[1],K$b[1]),K$_[2]=Math.max(K$E[2],K$b[2]),K$_[3]=Math.max(K$E[3],K$b[3])},K$k(K$c,["ZERO",function(){return this.ZERO=new K$c},"ONE",function(){return this.ONE=new K$c(1,1,1,1)},"UnitX",function(){return this.UnitX=new K$c(1,0,0,0)},"UnitY",function(){return this.UnitY=new K$c(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new K$c(0,0,1,0)},"UnitW",function(){return this.UnitW=new K$c(0,0,0,1)}]),K$c}(),K$ZP=function(){function K$b(K$c,K$P,K$q,K$_){this.minDepth=0,this.maxDepth=1,this.x=K$c,this.y=K$P,this.width=K$q,this.height=K$_}K$r(K$b,"laya.d3.math.Viewport");var K$c=K$b.prototype;return K$c.project=function(K$c,K$P,K$q){K$eP.transformV3ToV3(K$c,K$P,K$q);var K$_=K$c.elements,K$E=K$P.elements,K$b=K$q.elements,K$e=K$_[0]*K$E[3]+K$_[1]*K$E[7]+K$_[2]*K$E[11]+K$E[15];1!==K$e&&(K$b[0]=K$b[0]/K$e,K$b[1]=K$b[1]/K$e,K$b[2]=K$b[2]/K$e),K$b[0]=.5*(K$b[0]+1)*this.width+this.x,K$b[1]=.5*(1-K$b[1])*this.height+this.y,K$b[2]=K$b[2]*(this.maxDepth-this.minDepth)+this.minDepth},K$c.unprojectFromMat=function(K$c,K$P,K$q){var K$_=K$c.elements,K$E=K$P.elements,K$b=K$q.elements;K$b[0]=(K$_[0]-this.x)/this.width*2-1,K$b[1]=-((K$_[1]-this.y)/this.height*2-1);var K$e=(this.maxDepth-this.minDepth)/2;K$b[2]=(K$_[2]-this.minDepth-K$e)/K$e;var K$h=K$b[0]*K$E[3]+K$b[1]*K$E[7]+K$b[2]*K$E[11]+K$E[15];K$eP.transformV3ToV3(K$q,K$P,K$q),1!==K$h&&(K$b[0]=K$b[0]/K$h,K$b[1]=K$b[1]/K$h,K$b[2]=K$b[2]/K$h)},K$c.unprojectFromWVP=function(K$c,K$P,K$q,K$_,K$E){K$cP.multiply(K$P,K$q,K$b._tempMatrix4x4),K$_&&K$cP.multiply(K$b._tempMatrix4x4,K$_,K$b._tempMatrix4x4),K$b._tempMatrix4x4.invert(K$b._tempMatrix4x4),this.unprojectFromMat(K$c,K$b._tempMatrix4x4,K$E)},K$k(K$b,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new K$cP}]),K$b}(),K$SP=function(){function K$J(K$c){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=K$c,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}K$r(K$J,"laya.d3.resource.models.SubMesh");var K$c=K$J.prototype;return K$D.imps(K$c,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),K$c._getVertexBuffer=function(K$c){return void 0===K$c&&(K$c=0),0===K$c?this._vertexBuffer:null},K$c._getIndexBuffer=function(){return this._indexBuffer},K$c._getStaticBatchBakedVertexs=function(K$c,K$P){var K$q,K$_,K$E=this._vertexBuffer,K$b=K$E.vertexDeclaration,K$e=K$b.getVertexElementByUsage(0).offset/4,K$h=K$b.getVertexElementByUsage(3).offset/4,K$Z=K$P.meshRender.lightmapScaleOffset,K$S=0,K$n=0,K$k=0,K$x=0,K$r=0,K$g=0;if(K$Z)if(K$_=K$b.getVertexElementByUsage(15))K$k=K$b.vertexStride/4,K$q=0<this._vertexCount?K$E.getData().slice(this._vertexStart*K$k,(this._vertexStart+this._vertexCount)*K$k):K$E.getData().slice(),K$x=K$_.offset/4;else{K$k=(K$g=K$b.vertexStride/4)+2,K$q=this._vertexCount?new Float32Array(this._vertexCount*(K$E.vertexDeclaration.vertexStride/4+2)):new Float32Array(K$E.vertexCount*(K$E.vertexDeclaration.vertexStride/4+2)),K$x=(K$r=K$b.getVertexElementByUsage(2).offset/4)+2;var K$W=K$E.getData();for(K$S=0,K$n=K$W.length/K$g;K$S<K$n;K$S++){var K$w=0;K$w=0<this._vertexCount?(this._vertexStart+K$S)*K$g:K$S*K$g;var K$O=K$S*K$k,K$N=0;for(K$N=0;K$N<K$x;K$N++)K$q[K$O+K$N]=K$W[K$w+K$N];for(K$N=K$x;K$N<K$g;K$N++)K$q[K$O+K$N+2]=K$W[K$w+K$N]}}else K$k=K$b.vertexStride/4,K$q=this._vertexCount?K$E.getData().slice(this._vertexStart*K$k,(this._vertexStart+this._vertexCount)*K$k):K$E.getData().slice();if(K$c){var K$m=K$c.worldMatrix,K$T=K$J._tempMatrix4x40;K$m.invert(K$T);var K$D=K$J._tempMatrix4x41,K$L=K$P.transform.worldMatrix;K$cP.multiply(K$T,K$L,K$D)}else K$D=K$P.transform.worldMatrix;var K$H=K$J._tempQuaternion0;for(K$D.decomposeTransRotScale(K$J._tempVector30,K$H,K$J._tempVector31),K$S=0,K$n=K$q.length/K$k;K$S<K$n;K$S++){var K$Q=K$S*K$k+K$e,K$d=K$S*K$k+K$h;if(K$wP.transformVector3ArrayToVector3ArrayCoordinate(K$q,K$Q,K$D,K$q,K$Q),K$wP.transformVector3ArrayByQuat(K$q,K$d,K$H,K$q,K$d),K$Z){var K$u=K$S*K$k+K$x;if(K$_)K$wP.transformLightingMapTexcoordByUV1Array(K$q,K$u,K$Z,K$q,K$u);else{var K$A=K$S*K$g+K$r;K$wP.transformLightingMapTexcoordByUV0Array(K$W,K$A,K$Z,K$q,K$u)}}}return K$q},K$c._getVertexBuffers=function(){return null},K$c._beforeRender=function(K$c){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},K$c._render=function(K$c){var K$P,K$q=0,K$_=K$c.renderElement;if(1<this._indexCount){var K$E=this._boneIndicesList.length;if(1<K$E){for(var K$b=0;K$b<K$E;K$b++)(K$P=K$_._skinAnimationDatas||this._skinAnimationDatas)&&(K$_._shaderValue.setValue(0,K$P[K$b]),K$c._shader.uploadRenderElementUniforms(K$_._shaderValue.data)),K$j.mainContext.drawElements(4,this._subIndexBufferCount[K$b],5123,2*this._subIndexBufferStart[K$b]);K$Q.drawCall+=K$E}else(K$P=K$_._skinAnimationDatas||this._skinAnimationDatas)&&(K$_._shaderValue.setValue(0,K$P[0]),K$c._shader.uploadRenderElementUniforms(K$_._shaderValue.data)),K$j.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),K$Q.drawCall++;K$q=this._indexCount}else K$q=this._indexBuffer.indexCount,(K$P=K$_._skinAnimationDatas||this._skinAnimationDatas)&&(K$_._shaderValue.setValue(0,K$P[0]),K$c._shader.uploadRenderElementUniforms(K$_._shaderValue.data)),K$j.mainContext.drawElements(4,K$q,5123,0),K$Q.drawCall++;K$Q.trianglesFaces+=K$q/3},K$c.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},K$c.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},K$g(0,K$c,"_vertexBufferCount",function(){return 1}),K$g(0,K$c,"triangleCount",function(){return this._indexBuffer.indexCount/3}),K$k(K$J,["_tempVector30",function(){return this._tempVector30=new K$eP},"_tempVector31",function(){return this._tempVector31=new K$eP},"_tempQuaternion0",function(){return this._tempQuaternion0=new K$qP},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new K$cP},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new K$cP}]),K$J}(),K$nP=function(){function K$c(K$c){this.defineCounter=0,this.defines=null,K$c?(this.defineCounter=K$c.defineCounter,this.defines=K$c.defines.slice()):(this.defineCounter=0,this.defines=[])}return K$r(K$c,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),K$c.prototype.registerDefine=function(K$c){var K$P=Math.pow(2,this.defineCounter++);return this.defines[K$P]=K$c,K$P},K$c}(),K$kP=function(){function K$c(){}return K$r(K$c,"laya.d3.shader.ShaderInit3D"),K$c.__init__=function(){var K$c,K$P;K$QP._globalRegDefine("HIGHPRECISION",K$QP.SHADERDEFINE_HIGHPRECISION),K$QP._globalRegDefine("FOG",K$QP.SHADERDEFINE_FOG),K$QP._globalRegDefine("DIRECTIONLIGHT",K$QP.SHADERDEFINE_DIRECTIONLIGHT),K$QP._globalRegDefine("POINTLIGHT",K$QP.SHADERDEFINE_POINTLIGHT),K$QP._globalRegDefine("SPOTLIGHT",K$QP.SHADERDEFINE_SPOTLIGHT),K$QP._globalRegDefine("UV",K$QP.SHADERDEFINE_UV0),K$QP._globalRegDefine("COLOR",K$QP.SHADERDEFINE_COLOR),K$QP._globalRegDefine("UV1",K$QP.SHADERDEFINE_UV1),K$QP._globalRegDefine("CASTSHADOW",K$rP.SHADERDEFINE_CAST_SHADOW),K$QP._globalRegDefine("SHADOWMAP_PSSM1",K$rP.SHADERDEFINE_SHADOW_PSSM1),K$QP._globalRegDefine("SHADOWMAP_PSSM2",K$rP.SHADERDEFINE_SHADOW_PSSM2),K$QP._globalRegDefine("SHADOWMAP_PSSM3",K$rP.SHADERDEFINE_SHADOW_PSSM3),K$QP._globalRegDefine("SHADOWMAP_PCF_NO",K$rP.SHADERDEFINE_SHADOW_PCF_NO),K$QP._globalRegDefine("SHADOWMAP_PCF1",K$rP.SHADERDEFINE_SHADOW_PCF1),K$QP._globalRegDefine("SHADOWMAP_PCF2",K$rP.SHADERDEFINE_SHADOW_PCF2),K$QP._globalRegDefine("SHADOWMAP_PCF3",K$rP.SHADERDEFINE_SHADOW_PCF3),K$QP._globalRegDefine("DEPTHFOG",K$QP.SAHDERDEFINE_DEPTHFOG),K$oP.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),K$oP.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),K$c={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},K$P={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var K$q=K$oP.nameKey.add("SIMPLE");shaderCompile=K$QP.add(K$q,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',K$c,K$P),K$aP.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),K$aP.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),K$aP.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),K$aP.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),K$aP.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),K$aP.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),K$aP.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),K$aP.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),K$aP.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},K$c}(),K$xP=function(){function K$c(){this._data=null,this._data=[]}K$r(K$c,"laya.d3.shader.ValusArray");var K$P=K$c.prototype;return K$P.setValue=function(K$c,K$P){this._data[K$c]=K$P},K$g(0,K$P,"data",function(){return this._data}),K$c}(),K$rP=function(){function K$c(){}return K$c.SHADERDEFINE_RECEIVE_SHADOW=1,K$c.SHADERDEFINE_CAST_SHADOW=512,K$c.SHADERDEFINE_SHADOW_PSSM1=1024,K$c.SHADERDEFINE_SHADOW_PSSM2=2048,K$c.SHADERDEFINE_SHADOW_PSSM3=4096,K$c.SHADERDEFINE_SHADOW_PCF_NO=8192,K$c.SHADERDEFINE_SHADOW_PCF1=16384,K$c.SHADERDEFINE_SHADOW_PCF2=32768,K$c.SHADERDEFINE_SHADOW_PCF3=65536,K$c.MAX_PSSM_COUNT=3,K$c}(),K$gP=function(){function K$l(){}return K$r(K$l,"laya.d3.utils.Picker"),K$l.calculateCursorRay=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=K$c.elements[0],K$h=K$c.elements[1],K$Z=K$l._tempVector30,K$S=K$Z.elements;K$S[0]=K$e,K$S[1]=K$h,K$S[2]=K$P.minDepth;var K$n=K$l._tempVector31,K$k=K$n.elements;K$k[0]=K$e,K$k[1]=K$h,K$k[2]=K$P.maxDepth;var K$x=K$b.origin,K$r=K$l._tempVector32;K$P.unprojectFromWVP(K$Z,K$q,K$_,K$E,K$x),K$P.unprojectFromWVP(K$n,K$q,K$_,K$E,K$r);var K$g=K$b.direction.elements;K$g[0]=K$r.x-K$x.x,K$g[1]=K$r.y-K$x.y,K$g[2]=K$r.z-K$x.z,K$eP.normalize(K$b.direction,K$b.direction)},K$l.rayIntersectsPositionsAndIndices=function(K$c,K$P,K$q,K$_,K$E){for(var K$b=K$q.vertexStride/4,K$e=K$q.getVertexElementByUsage(0).offset/4,K$h=Number.MAX_VALUE,K$Z=-1,K$S=-1,K$n=-1,K$k=0;K$k<K$_.length;K$k+=3){var K$x=K$l._tempVector35,K$r=K$x.elements,K$g=K$_[K$k]*K$b,K$W=K$g+K$e;K$r[0]=K$P[K$W],K$r[1]=K$P[1+K$W],K$r[2]=K$P[2+K$W];var K$w=K$l._tempVector36,K$O=K$w.elements,K$N=K$_[K$k+1]*K$b,K$m=K$N+K$e;K$O[0]=K$P[K$m],K$O[1]=K$P[1+K$m],K$O[2]=K$P[2+K$m];var K$T=K$l._tempVector37,K$D=K$T.elements,K$L=K$_[K$k+2]*K$b,K$H=K$L+K$e;K$D[0]=K$P[K$H],K$D[1]=K$P[1+K$H],K$D[2]=K$P[2+K$H];var K$Q=laya.d3.utils.Picker.rayIntersectsTriangle(K$c,K$x,K$w,K$T);!isNaN(K$Q)&&K$Q<K$h&&(K$h=K$Q,K$Z=K$g,K$S=K$N,K$n=K$L)}if(K$h===Number.MAX_VALUE)return K$E.position.toDefault(),K$E.distance=Number.MAX_VALUE,K$E.trianglePositions[0].toDefault(),K$E.trianglePositions[1].toDefault(),K$E.trianglePositions[2].toDefault(),K$E.triangleNormals[0].toDefault(),K$E.triangleNormals[1].toDefault(),K$E.triangleNormals[2].toDefault(),!1;K$E.distance=K$h,K$eP.scale(K$c.direction,K$h,K$E.position),K$eP.add(K$c.origin,K$E.position,K$E.position);var K$d=K$E.trianglePositions,K$u=K$d[0],K$A=K$d[1],K$J=K$d[2],K$j=K$u.elements,K$V=K$A.elements,K$R=K$J.elements,K$$=K$Z+K$e;K$j[0]=K$P[K$$],K$j[1]=K$P[K$$+1],K$j[2]=K$P[K$$+2];var K$C=K$S+K$e;K$V[0]=K$P[K$C],K$V[1]=K$P[K$C+1],K$V[2]=K$P[K$C+2];var K$F=K$n+K$e;K$R[0]=K$P[K$F],K$R[1]=K$P[K$F+1],K$R[2]=K$P[K$F+2];var K$o=K$q.getVertexElementByUsage(3);if(K$o){var K$a=K$o.offset/4,K$Y=K$E.triangleNormals,K$s=K$Y[0],K$U=K$Y[1],K$I=K$Y[2],K$v=K$s.elements,K$y=K$U.elements,K$M=K$I.elements,K$z=K$Z+K$a;K$v[0]=K$P[K$z],K$v[1]=K$P[K$z+1],K$v[2]=K$P[K$z+2];var K$X=K$S+K$a;K$y[0]=K$P[K$X],K$y[1]=K$P[K$X+1],K$y[2]=K$P[K$X+2];var K$f=K$n+K$a;K$M[0]=K$P[K$f],K$M[1]=K$P[K$f+1],K$M[2]=K$P[K$f+2]}return!0},K$l.rayIntersectsTriangle=function(K$c,K$P,K$q,K$_){var K$E=K$l._tempVector30,K$b=K$l._tempVector31;K$eP.subtract(K$q,K$P,K$E),K$eP.subtract(K$_,K$P,K$b);var K$e,K$h=K$l._tempVector32;if(K$eP.cross(K$c.direction,K$b,K$h),(K$e=K$eP.dot(K$E,K$h))>-Number.MIN_VALUE&&K$e<Number.MIN_VALUE)return Number.NaN;var K$Z,K$S=1/K$e,K$n=K$l._tempVector33;if(K$eP.subtract(K$c.origin,K$P,K$n),K$Z=K$eP.dot(K$n,K$h),(K$Z*=K$S)<0||1<K$Z)return Number.NaN;var K$k,K$x,K$r=K$l._tempVector34;return K$eP.cross(K$n,K$E,K$r),K$k=K$eP.dot(K$c.direction,K$r),(K$k*=K$S)<0||1<K$Z+K$k?Number.NaN:(K$x=K$eP.dot(K$b,K$r),(K$x*=K$S)<0?Number.NaN:K$x)},K$k(K$l,["_tempVector30",function(){return this._tempVector30=new K$eP},"_tempVector31",function(){return this._tempVector31=new K$eP},"_tempVector32",function(){return this._tempVector32=new K$eP},"_tempVector33",function(){return this._tempVector33=new K$eP},"_tempVector34",function(){return this._tempVector34=new K$eP},"_tempVector35",function(){return this._tempVector35=new K$eP},"_tempVector36",function(){return this._tempVector36=new K$eP},"_tempVector37",function(){return this._tempVector37=new K$eP}]),K$l}(),K$WP=(function(){function K$c(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new K$eP,new K$eP,new K$eP],this.trianglePositions.length=3,this.triangleNormals=[new K$eP,new K$eP,new K$eP],this.triangleNormals.length=3,this.position=new K$eP}K$r(K$c,"laya.d3.utils.RaycastHit"),K$c.prototype.cloneTo=function(K$c){K$c.distance=this.distance,this.trianglePositions[0].cloneTo(K$c.trianglePositions[0]),this.trianglePositions[1].cloneTo(K$c.trianglePositions[1]),this.trianglePositions[2].cloneTo(K$c.trianglePositions[2]),this.triangleNormals[0].cloneTo(K$c.triangleNormals[0]),this.triangleNormals[1].cloneTo(K$c.triangleNormals[1]),this.triangleNormals[2].cloneTo(K$c.triangleNormals[2]),this.position.cloneTo(K$c.position),K$c.sprite3D=this.sprite3D}}(),function(){function K$c(K$c,K$P){this._width=0,this._height=0,this._width=K$c,this._height=K$P}K$r(K$c,"laya.d3.utils.Size");var K$P=K$c.prototype;return K$g(0,K$P,"width",function(){return-1===this._width?K$t.clientWidth:this._width}),K$g(0,K$P,"height",function(){return-1===this._height?K$t.clientHeight:this._height}),K$g(1,K$c,"fullScreen",function(){return new K$c(-1,-1)}),K$c}()),K$wP=function(){function K$$(){}return K$r(K$$,"laya.d3.utils.Utils3D"),K$$._rotationTransformScaleSkinAnimation=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$k){var K$x,K$r,K$g,K$W,K$w,K$O=K$$._tempArray16_0,K$N=K$$._tempArray16_1,K$m=K$$._tempArray16_2,K$T=K$_+K$_,K$D=K$E+K$E,K$L=K$b+K$b,K$H=K$_*K$T,K$Q=K$E*K$T,K$d=K$E*K$D,K$u=K$b*K$T,K$A=K$b*K$D,K$J=K$b*K$L,K$j=K$e*K$T,K$V=K$e*K$D,K$R=K$e*K$L;for(K$O[15]=1,K$O[0]=1-K$d-K$J,K$O[1]=K$Q+K$R,K$O[2]=K$u-K$V,K$O[4]=K$Q-K$R,K$O[5]=1-K$H-K$J,K$O[6]=K$A+K$j,K$O[8]=K$u+K$V,K$O[9]=K$A-K$j,K$O[10]=1-K$H-K$d,K$N[15]=1,K$N[0]=K$h,K$N[5]=K$Z,K$N[10]=K$S,K$x=0;K$x<4;K$x++)K$r=K$O[K$x],K$g=K$O[K$x+4],K$W=K$O[K$x+8],K$w=K$O[K$x+12],K$m[K$x]=K$r,K$m[K$x+4]=K$g,K$m[K$x+8]=K$W,K$m[K$x+12]=K$r*K$c+K$g*K$P+K$W*K$q+K$w;for(K$x=0;K$x<4;K$x++)K$r=K$m[K$x],K$g=K$m[K$x+4],K$W=K$m[K$x+8],K$w=K$m[K$x+12],K$n[K$x+K$k]=K$r*K$N[0]+K$g*K$N[1]+K$W*K$N[2]+K$w*K$N[3],K$n[K$x+K$k+4]=K$r*K$N[4]+K$g*K$N[5]+K$W*K$N[6]+K$w*K$N[7],K$n[K$x+K$k+8]=K$r*K$N[8]+K$g*K$N[9]+K$W*K$N[10]+K$w*K$N[11],K$n[K$x+K$k+12]=K$r*K$N[12]+K$g*K$N[13]+K$W*K$N[14]+K$w*K$N[15]},K$$._createNodeByJson=function(K$c,K$P,K$q,K$_){if(!K$q)switch(K$P.type){case"Sprite3D":K$q=new K$FP;break;case"MeshSprite3D":K$q=new K$lP;break;case"SkinnedMeshSprite3D":K$q=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":K$q=new ShuriKenParticle3D;break;case"TrailSprite3D":K$q=new TrailSprite3D;break;case"Terrain":K$q=new Terrain;break;case"Camera":K$q=new K$fP;break;case"DirectionLight":K$q=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var K$E=K$P.props;if(K$E)for(var K$b in K$E)K$q[K$b]=K$E[K$b];var K$e=K$P.customProps;K$e&&(K$q instanceof laya.d3.core.Sprite3D?(K$q._parseBaseCustomProps(K$e),K$q._parseCustomProps(K$c,K$_,K$e,K$P),K$q._parseCustomComponent(K$c,K$_,K$P.components)):K$q._parseCustomProps(K$c,K$_,K$e,K$P));var K$h=K$P.child;if(K$h)for(var K$Z=0,K$S=K$h.length;K$Z<K$S;K$Z++){var K$n=K$$._createNodeByJson(K$c,K$h[K$Z],null,K$_);K$q.addChild(K$n)}return K$q},K$$._computeBoneAndAnimationDatasByBindPoseMatrxix=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e,K$h,K$Z=0,K$S=0,K$n=K$c.length;for(K$e=0;K$e<K$n;K$Z+=K$c[K$e].keyframeWidth,K$S+=16,K$e++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(K$P[K$Z+0],K$P[K$Z+1],K$P[K$Z+2],K$P[K$Z+3],K$P[K$Z+4],K$P[K$Z+5],K$P[K$Z+6],K$P[K$Z+7],K$P[K$Z+8],K$P[K$Z+9],K$_,K$S),0!=K$e&&(K$h=16*K$c[K$e].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(K$_,K$h,K$_,K$S,K$_,K$S));var K$k=K$q.length;for(K$e=0;K$e<K$k;K$e++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(K$_,16*K$b[K$e],K$q[K$e],K$E,16*K$e)},K$$._computeAnimationDatasByArrayAndMatrixFast=function(K$c,K$P,K$q,K$_){for(var K$E=0,K$b=K$c.length;K$E<K$b;K$E++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(K$P,16*K$_[K$E],K$c[K$E],K$q,16*K$E)},K$$._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(K$c,K$P,K$q,K$_,K$E){var K$b,K$e,K$h=0,K$Z=0,K$S=K$c.length;for(K$b=0;K$b<K$S;K$h+=K$c[K$b].keyframeWidth,K$Z+=16,K$b++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(K$P[K$h+7],K$P[K$h+8],K$P[K$h+9],K$P[K$h+3],K$P[K$h+4],K$P[K$h+5],K$P[K$h+6],K$P[K$h+0],K$P[K$h+1],K$P[K$h+2],K$_,K$Z),0!=K$b&&(K$e=16*K$c[K$b].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(K$_,K$e,K$_,K$Z,K$_,K$Z));var K$n=K$q.length;for(K$b=0;K$b<K$n;K$b++){var K$k=16*K$b;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(K$_,K$k,K$q[K$b],K$E,K$k)}},K$$._computeAnimationDatasByArrayAndMatrixFastOld=function(K$c,K$P,K$q){for(var K$_=K$c.length,K$E=0;K$E<K$_;K$E++){var K$b=16*K$E;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(K$P,K$b,K$c[K$E],K$q,K$b)}},K$$._computeRootAnimationData=function(K$c,K$P,K$q){for(var K$_=0,K$E=0,K$b=0,K$e=K$c.length;K$_<K$e;K$E+=K$c[K$_].keyframeWidth,K$b+=16,K$_++)laya.d3.utils.Utils3D.createAffineTransformationArray(K$P[K$E+0],K$P[K$E+1],K$P[K$E+2],K$P[K$E+3],K$P[K$E+4],K$P[K$E+5],K$P[K$E+6],K$P[K$E+7],K$P[K$E+8],K$P[K$E+9],K$q,K$b)},K$$.transformVector3ArrayByQuat=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$q.elements,K$e=K$c[K$P],K$h=K$c[K$P+1],K$Z=K$c[K$P+2],K$S=K$b[0],K$n=K$b[1],K$k=K$b[2],K$x=K$b[3],K$r=K$x*K$e+K$n*K$Z-K$k*K$h,K$g=K$x*K$h+K$k*K$e-K$S*K$Z,K$W=K$x*K$Z+K$S*K$h-K$n*K$e,K$w=-K$S*K$e-K$n*K$h-K$k*K$Z;K$_[K$E]=K$r*K$x+K$w*-K$S+K$g*-K$k-K$W*-K$n,K$_[K$E+1]=K$g*K$x+K$w*-K$n+K$W*-K$S-K$r*-K$k,K$_[K$E+2]=K$W*K$x+K$w*-K$k+K$r*-K$n-K$g*-K$S},K$$.mulMatrixByArray=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e,K$h,K$Z,K$S,K$n;if(K$E===K$q){for(K$q=K$$._tempArray16_3,K$e=0;K$e<16;++K$e)K$q[K$e]=K$E[K$b+K$e];K$_=0}for(K$e=0;K$e<4;K$e++)K$h=K$c[K$P+K$e],K$Z=K$c[K$P+K$e+4],K$S=K$c[K$P+K$e+8],K$n=K$c[K$P+K$e+12],K$E[K$b+K$e]=K$h*K$q[K$_+0]+K$Z*K$q[K$_+1]+K$S*K$q[K$_+2]+K$n*K$q[K$_+3],K$E[K$b+K$e+4]=K$h*K$q[K$_+4]+K$Z*K$q[K$_+5]+K$S*K$q[K$_+6]+K$n*K$q[K$_+7],K$E[K$b+K$e+8]=K$h*K$q[K$_+8]+K$Z*K$q[K$_+9]+K$S*K$q[K$_+10]+K$n*K$q[K$_+11],K$E[K$b+K$e+12]=K$h*K$q[K$_+12]+K$Z*K$q[K$_+13]+K$S*K$q[K$_+14]+K$n*K$q[K$_+15]},K$$.mulMatrixByArrayFast=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e,K$h,K$Z,K$S,K$n;for(K$e=0;K$e<4;K$e++)K$h=K$c[K$P+K$e],K$Z=K$c[K$P+K$e+4],K$S=K$c[K$P+K$e+8],K$n=K$c[K$P+K$e+12],K$E[K$b+K$e]=K$h*K$q[K$_+0]+K$Z*K$q[K$_+1]+K$S*K$q[K$_+2]+K$n*K$q[K$_+3],K$E[K$b+K$e+4]=K$h*K$q[K$_+4]+K$Z*K$q[K$_+5]+K$S*K$q[K$_+6]+K$n*K$q[K$_+7],K$E[K$b+K$e+8]=K$h*K$q[K$_+8]+K$Z*K$q[K$_+9]+K$S*K$q[K$_+10]+K$n*K$q[K$_+11],K$E[K$b+K$e+12]=K$h*K$q[K$_+12]+K$Z*K$q[K$_+13]+K$S*K$q[K$_+14]+K$n*K$q[K$_+15]},K$$.mulMatrixByArrayAndMatrixFast=function(K$c,K$P,K$q,K$_,K$E){var K$b,K$e,K$h,K$Z,K$S,K$n=K$q.elements,K$k=K$n[0],K$x=K$n[1],K$r=K$n[2],K$g=K$n[3],K$W=K$n[4],K$w=K$n[5],K$O=K$n[6],K$N=K$n[7],K$m=K$n[8],K$T=K$n[9],K$D=K$n[10],K$L=K$n[11],K$H=K$n[12],K$Q=K$n[13],K$d=K$n[14],K$u=K$n[15],K$A=K$P,K$J=K$P+4,K$j=K$P+8,K$V=K$P+12,K$R=K$E,K$$=K$E+4,K$C=K$E+8,K$F=K$E+12;for(K$b=0;K$b<4;K$b++)K$e=K$c[K$A+K$b],K$h=K$c[K$J+K$b],K$Z=K$c[K$j+K$b],K$S=K$c[K$V+K$b],K$_[K$R+K$b]=K$e*K$k+K$h*K$x+K$Z*K$r+K$S*K$g,K$_[K$$+K$b]=K$e*K$W+K$h*K$w+K$Z*K$O+K$S*K$N,K$_[K$C+K$b]=K$e*K$m+K$h*K$T+K$Z*K$D+K$S*K$L,K$_[K$F+K$b]=K$e*K$H+K$h*K$Q+K$Z*K$d+K$S*K$u},K$$.createAffineTransformationArray=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$k){var K$x=K$_+K$_,K$r=K$E+K$E,K$g=K$b+K$b,K$W=K$_*K$x,K$w=K$_*K$r,K$O=K$_*K$g,K$N=K$E*K$r,K$m=K$E*K$g,K$T=K$b*K$g,K$D=K$e*K$x,K$L=K$e*K$r,K$H=K$e*K$g;K$n[K$k+0]=(1-(K$N+K$T))*K$h,K$n[K$k+1]=(K$w+K$H)*K$h,K$n[K$k+2]=(K$O-K$L)*K$h,K$n[K$k+3]=0,K$n[K$k+4]=(K$w-K$H)*K$Z,K$n[K$k+5]=(1-(K$W+K$T))*K$Z,K$n[K$k+6]=(K$m+K$D)*K$Z,K$n[K$k+7]=0,K$n[K$k+8]=(K$O+K$L)*K$S,K$n[K$k+9]=(K$m-K$D)*K$S,K$n[K$k+10]=(1-(K$W+K$N))*K$S,K$n[K$k+11]=0,K$n[K$k+12]=K$c,K$n[K$k+13]=K$P,K$n[K$k+14]=K$q,K$n[K$k+15]=1},K$$.transformVector3ArrayToVector3ArrayCoordinate=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$$._tempArray4_0,K$e=K$c[K$P+0],K$h=K$c[K$P+1],K$Z=K$c[K$P+2],K$S=K$q.elements;K$b[0]=K$e*K$S[0]+K$h*K$S[4]+K$Z*K$S[8]+K$S[12],K$b[1]=K$e*K$S[1]+K$h*K$S[5]+K$Z*K$S[9]+K$S[13],K$b[2]=K$e*K$S[2]+K$h*K$S[6]+K$Z*K$S[10]+K$S[14],K$b[3]=1/(K$e*K$S[3]+K$h*K$S[7]+K$Z*K$S[11]+K$S[15]),K$_[K$E+0]=K$b[0]*K$b[3],K$_[K$E+1]=K$b[1]*K$b[3],K$_[K$E+2]=K$b[2]*K$b[3]},K$$.transformLightingMapTexcoordByUV0Array=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$q.elements;K$_[K$E+0]=K$c[K$P+0]*K$b[0]+K$b[2],K$_[K$E+1]=(K$c[K$P+1]-1)*K$b[1]+K$b[3]},K$$.transformLightingMapTexcoordByUV1Array=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$q.elements;K$_[K$E+0]=K$c[K$P+0]*K$b[0]+K$b[2],K$_[K$E+1]=1+K$c[K$P+1]*K$b[1]+K$b[3]},K$$.getURLVerion=function(K$c){var K$P=K$c.indexOf("?");return 0<=K$P?K$c.substr(K$P):null},K$$._quaternionCreateFromYawPitchRollArray=function(K$c,K$P,K$q,K$_){var K$E=.5*K$q,K$b=.5*K$P,K$e=.5*K$c,K$h=Math.sin(K$E),K$Z=Math.cos(K$E),K$S=Math.sin(K$b),K$n=Math.cos(K$b),K$k=Math.sin(K$e),K$x=Math.cos(K$e);K$_[0]=K$x*K$S*K$Z+K$k*K$n*K$h,K$_[1]=K$k*K$n*K$Z-K$x*K$S*K$h,K$_[2]=K$x*K$n*K$h-K$k*K$S*K$Z,K$_[3]=K$x*K$n*K$Z+K$k*K$S*K$h},K$$._createAffineTransformationArray=function(K$c,K$P,K$q,K$_){var K$E=K$P[0],K$b=K$P[1],K$e=K$P[2],K$h=K$P[3],K$Z=K$E+K$E,K$S=K$b+K$b,K$n=K$e+K$e,K$k=K$E*K$Z,K$x=K$E*K$S,K$r=K$E*K$n,K$g=K$b*K$S,K$W=K$b*K$n,K$w=K$e*K$n,K$O=K$h*K$Z,K$N=K$h*K$S,K$m=K$h*K$n,K$T=K$q[0],K$D=K$q[1],K$L=K$q[2];K$_[0]=(1-(K$g+K$w))*K$T,K$_[1]=(K$x+K$m)*K$T,K$_[2]=(K$r-K$N)*K$T,K$_[3]=0,K$_[4]=(K$x-K$m)*K$D,K$_[5]=(1-(K$k+K$w))*K$D,K$_[6]=(K$W+K$O)*K$D,K$_[7]=0,K$_[8]=(K$r+K$N)*K$L,K$_[9]=(K$W-K$O)*K$L,K$_[10]=(1-(K$k+K$g))*K$L,K$_[11]=0,K$_[12]=K$c[0],K$_[13]=K$c[1],K$_[14]=K$c[2],K$_[15]=1},K$$._mulMatrixArray=function(K$c,K$P,K$q,K$_){var K$E,K$b,K$e,K$h,K$Z,K$S=K$P.elements,K$n=K$S[0],K$k=K$S[1],K$x=K$S[2],K$r=K$S[3],K$g=K$S[4],K$W=K$S[5],K$w=K$S[6],K$O=K$S[7],K$N=K$S[8],K$m=K$S[9],K$T=K$S[10],K$D=K$S[11],K$L=K$S[12],K$H=K$S[13],K$Q=K$S[14],K$d=K$S[15],K$u=K$_,K$A=K$_+4,K$J=K$_+8,K$j=K$_+12;for(K$E=0;K$E<4;K$E++)K$b=K$c[K$E],K$e=K$c[K$E+4],K$h=K$c[K$E+8],K$Z=K$c[K$E+12],K$q[K$u+K$E]=K$b*K$n+K$e*K$k+K$h*K$x+K$Z*K$r,K$q[K$A+K$E]=K$b*K$g+K$e*K$W+K$h*K$w+K$Z*K$O,K$q[K$J+K$E]=K$b*K$N+K$e*K$m+K$h*K$T+K$Z*K$D,K$q[K$j+K$E]=K$b*K$L+K$e*K$H+K$h*K$Q+K$Z*K$d},K$$.getYawPitchRoll=function(K$c,K$P){K$$.transformQuat(K$eP.ForwardRH,K$c,K$qP.TEMPVector31),K$$.transformQuat(K$eP.Up,K$c,K$qP.TEMPVector32);var K$q=K$qP.TEMPVector32.elements;K$$.angleTo(K$eP.ZERO,K$qP.TEMPVector31,K$qP.TEMPVector33);var K$_=K$qP.TEMPVector33.elements;K$_[0]==Math.PI/2?(K$_[1]=K$$.arcTanAngle(K$q[2],K$q[0]),K$_[2]=0):K$_[0]==-Math.PI/2?(K$_[1]=K$$.arcTanAngle(-K$q[2],-K$q[0]),K$_[2]=0):(K$cP.createRotationY(-K$_[1],K$qP.TEMPMatrix0),K$cP.createRotationX(-K$_[0],K$qP.TEMPMatrix1),K$eP.transformCoordinate(K$qP.TEMPVector32,K$qP.TEMPMatrix0,K$qP.TEMPVector32),K$eP.transformCoordinate(K$qP.TEMPVector32,K$qP.TEMPMatrix1,K$qP.TEMPVector32),K$_[2]=K$$.arcTanAngle(K$q[1],-K$q[0])),K$_[1]<=-Math.PI&&(K$_[1]=Math.PI),K$_[2]<=-Math.PI&&(K$_[2]=Math.PI),K$_[1]>=Math.PI&&K$_[2]>=Math.PI&&(K$_[1]=0,K$_[2]=0,K$_[0]=Math.PI-K$_[0]),K$P[0]=K$_[1],K$P[1]=K$_[0],K$P[2]=K$_[2]},K$$.arcTanAngle=function(K$c,K$P){return 0==K$c?1==K$P?Math.PI/2:-Math.PI/2:0<K$c?Math.atan(K$P/K$c):K$c<0?0<K$P?Math.atan(K$P/K$c)+Math.PI:Math.atan(K$P/K$c)-Math.PI:0},K$$.angleTo=function(K$c,K$P,K$q){K$eP.subtract(K$P,K$c,K$qP.TEMPVector30),K$eP.normalize(K$qP.TEMPVector30,K$qP.TEMPVector30),K$q.elements[0]=Math.asin(K$qP.TEMPVector30.y),K$q.elements[1]=K$$.arcTanAngle(-K$qP.TEMPVector30.z,-K$qP.TEMPVector30.x)},K$$.transformQuat=function(K$c,K$P,K$q){var K$_=K$q.elements,K$E=K$c.elements,K$b=K$P,K$e=K$E[0],K$h=K$E[1],K$Z=K$E[2],K$S=K$b[0],K$n=K$b[1],K$k=K$b[2],K$x=K$b[3],K$r=K$x*K$e+K$n*K$Z-K$k*K$h,K$g=K$x*K$h+K$k*K$e-K$S*K$Z,K$W=K$x*K$Z+K$S*K$h-K$n*K$e,K$w=-K$S*K$e-K$n*K$h-K$k*K$Z;K$_[0]=K$r*K$x+K$w*-K$S+K$g*-K$k-K$W*-K$n,K$_[1]=K$g*K$x+K$w*-K$n+K$W*-K$S-K$r*-K$k,K$_[2]=K$W*K$x+K$w*-K$k+K$r*-K$n-K$g*-K$S},K$$.quaterionNormalize=function(K$c,K$P){var K$q=K$c[0],K$_=K$c[1],K$E=K$c[2],K$b=K$c[3],K$e=K$q*K$q+K$_*K$_+K$E*K$E+K$b*K$b;0<K$e&&(K$e=1/Math.sqrt(K$e),K$P[0]=K$q*K$e,K$P[1]=K$_*K$e,K$P[2]=K$E*K$e,K$P[3]=K$b*K$e)},K$$.matrix4x4MultiplyFFF=function(K$c,K$P,K$q){var K$_,K$E,K$b,K$e,K$h;if(K$q===K$P)for(K$P=new Float32Array(16),K$_=0;K$_<16;++K$_)K$P[K$_]=K$q[K$_];for(K$_=0;K$_<4;K$_++)K$E=K$c[K$_],K$b=K$c[K$_+4],K$e=K$c[K$_+8],K$h=K$c[K$_+12],K$q[K$_]=K$E*K$P[0]+K$b*K$P[1]+K$e*K$P[2]+K$h*K$P[3],K$q[K$_+4]=K$E*K$P[4]+K$b*K$P[5]+K$e*K$P[6]+K$h*K$P[7],K$q[K$_+8]=K$E*K$P[8]+K$b*K$P[9]+K$e*K$P[10]+K$h*K$P[11],K$q[K$_+12]=K$E*K$P[12]+K$b*K$P[13]+K$e*K$P[14]+K$h*K$P[15]},K$$.matrix4x4MultiplyMFM=function(K$c,K$P,K$q){K$$.matrix4x4MultiplyFFF(K$c.elements,K$P,K$q.elements)},K$k(K$$,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new K$eP},"_tempVector3_1",function(){return this._tempVector3_1=new K$eP},"_tempVector3_2",function(){return this._tempVector3_2=new K$eP},"_tempVector3_3",function(){return this._tempVector3_3=new K$eP},"_tempVector3_4",function(){return this._tempVector3_4=new K$eP},"_tempVector3_5",function(){return this._tempVector3_5=new K$eP},"_tempVector3_6",function(){return this._tempVector3_6=new K$eP},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),K$$}(),K$OP=function(){function K$V(){}return K$r(K$V,"Laya3D"),K$V._cancelLoadByUrl=function(K$c){K$D.loader.cancelLoadByUrl(K$c),K$V._innerFirstLevelLoaderManager.cancelLoadByUrl(K$c),K$V._innerSecondLevelLoaderManager.cancelLoadByUrl(K$c),K$V._innerThirdLevelLoaderManager.cancelLoadByUrl(K$c),K$V._innerFourthLevelLoaderManager.cancelLoadByUrl(K$c)},K$V._changeWebGLSize=function(K$c,K$P){K$j.onStageResize(K$c,K$P),K$t.clientWidth=K$c,K$t.clientHeight=K$P},K$V.__init__=function(){var K$c=K$P.createMap;K$c.lh=[K$FP,"SPRITE3DHIERARCHY"],K$c.ls=[K$CP,"SPRITE3DHIERARCHY"],K$c.lm=[K$vP,"MESH"],K$c.lmat=[K$aP,"MATERIAL"],K$c.jpg=[K$MP,"nativeimage"],K$c.jpeg=[K$MP,"nativeimage"],K$c.png=[K$MP,"nativeimage"],K$c.pkm=[K$MP,"arraybuffer"],K$c.raw=[K$UP,"arraybuffer"],K$c.mipmaps=[K$UP,"arraybuffer"],K$O.parserMap.SPRITE3DHIERARCHY=K$V._loadHierarchy,K$O.parserMap.MESH=K$V._loadMesh,K$O.parserMap.MATERIAL=K$V._loadMaterial,K$O.parserMap.TEXTURECUBE=K$V._loadTextureCube,K$O.parserMap.TERRAIN=K$V._loadTerrain,K$V._innerFirstLevelLoaderManager.on("error",null,K$V._eventLoadManagerError),K$V._innerSecondLevelLoaderManager.on("error",null,K$V._eventLoadManagerError),K$V._innerThirdLevelLoaderManager.on("error",null,K$V._eventLoadManagerError),K$V._innerFourthLevelLoaderManager.on("error",null,K$V._eventLoadManagerError)},K$V.READ_BLOCK=function(){return K$V._readData.pos+=4,!0},K$V.READ_DATA=function(){return K$V._DATA.offset=K$V._readData.getUint32(),K$V._DATA.size=K$V._readData.getUint32(),!0},K$V.READ_STRINGS=function(){var K$c=[],K$P={offset:0,size:0};K$P.offset=K$V._readData.getUint16(),K$P.size=K$V._readData.getUint16();K$V._readData.pos;K$V._readData.pos=K$P.offset+K$V._DATA.offset;for(var K$q=0;K$q<K$P.size;K$q++){var K$_=K$V._readData.readUTFString();-1===K$_.lastIndexOf(".lmat")&&-1===K$_.lastIndexOf(".lpbr")||K$c.push(K$_)}return K$c},K$V.formatRelativePath=function(K$c,K$P){var K$q;if("."===K$P.charAt(0)){for(var K$_=(K$c+K$P).split("/"),K$E=0,K$b=K$_.length;K$E<K$b;K$E++)if(".."==K$_[K$E]){var K$e=K$E-1;0<K$e&&".."!==K$_[K$e]&&(K$_.splice(K$e,2),K$E-=2)}K$q=K$_.join("/")}else K$q=K$c+K$P;return null!=K$J.customFormat&&(K$q=K$J.customFormat(K$q,null)),K$q},K$V._eventLoadManagerError=function(K$c){K$D.loader.event("error",K$c)},K$V._addHierarchyInnerUrls=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e=K$V.formatRelativePath(K$_,K$E);K$q&&(K$e+=K$q),K$c.push({url:K$e,clas:K$b}),K$P[K$E]=K$e},K$V._getSprite3DHierarchyInnerUrls=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){var K$h,K$Z=0,K$S=0;switch(K$c.type){case"Scene":var K$n=K$c.customProps.lightmaps;for(K$Z=0,K$S=K$n.length;K$Z<K$S;K$Z++){var K$k=K$n[K$Z].replace(".exr",".png");K$V._addHierarchyInnerUrls(K$_,K$E,K$b,K$e,K$k,K$MP)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var K$x;if(K$c.instanceParams)(K$x=K$c.instanceParams.loadPath)&&K$V._addHierarchyInnerUrls(K$P,K$E,K$b,K$e,K$x,K$vP);else{(K$x=(K$h=K$c.customProps).meshPath)&&K$V._addHierarchyInnerUrls(K$P,K$E,K$b,K$e,K$x,K$vP);var K$r=K$h.materials;if(K$r)for(K$Z=0,K$S=K$r.length;K$Z<K$S;K$Z++){for(var K$g=K$r[K$Z],K$W=K$g.type.split("."),K$w=K$R.window,K$O=0,K$N=K$W.length;K$O<K$N;++K$O){K$w=K$w[this.clasPaths[K$O]]}if("function"!=typeof K$w)throw"_getSprite3DHierarchyInnerUrls 错误: "+K$g.type+" 不是类";K$V._addHierarchyInnerUrls(K$q,K$E,K$b,K$e,K$g.path,K$w)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var K$m=(K$h=K$c.customProps).meshPath;K$m&&K$V._addHierarchyInnerUrls(K$P,K$E,K$b,K$e,K$m,K$vP);var K$T=K$h.material;if(K$T){K$W=K$T.type.split("."),K$w=K$R.window;for(K$O=0,K$N=K$W.length;K$O<K$N;++K$O){K$w=K$w[this.clasPaths[K$O]]}K$V._addHierarchyInnerUrls(K$q,K$E,K$b,K$e,K$T.path,K$w)}else{var K$D=K$h.materialPath;if(K$D)K$V._addHierarchyInnerUrls(K$q,K$E,K$b,K$e,K$D,ShurikenParticleMaterial);else{var K$L=K$h.texturePath;K$L&&K$V._addHierarchyInnerUrls(K$_,K$E,K$b,K$e,K$L,K$MP)}}break;case"Terrain":K$V._addHierarchyInnerUrls(K$_,K$E,K$b,K$e,K$c.customProps.dataPath,TerrainRes)}var K$H=K$c.components;for(var K$Q in K$H){var K$d=K$H[K$Q];switch(K$Q){case"Animator":var K$u=K$d.avatarPath;if(K$u)K$V._addHierarchyInnerUrls(K$_,K$E,K$b,K$e,K$u,Avatar);else{var K$A=K$d.avatar;K$A&&K$V._addHierarchyInnerUrls(K$_,K$E,K$b,K$e,K$A.path,Avatar)}var K$J=K$d.clipPaths;for(K$Z=0,K$S=K$J.length;K$Z<K$S;K$Z++)K$V._addHierarchyInnerUrls(K$_,K$E,K$b,K$e,K$J[K$Z],AnimationClip)}}var K$j=K$c.child;for(K$Z=0,K$S=K$j.length;K$Z<K$S;K$Z++)K$V._getSprite3DHierarchyInnerUrls(K$j[K$Z],K$P,K$q,K$_,K$E,K$b,K$e)},K$V._loadHierarchy=function(K$c){K$c.on("loaded",null,K$V._onHierarchylhLoaded,[K$c,K$c._class._getGroup()]),K$c.load(K$c.url,"json",!1,null,!0)},K$V._onHierarchylhLoaded=function(K$c,K$P,K$q){if(K$c._class.destroyed)K$c.endLoad();else{var K$_=K$c.url,K$E=K$wP.getURLVerion(K$_),K$b=K$J.getPath(K$_),K$e=[],K$h=[],K$Z=[],K$S={};K$V._getSprite3DHierarchyInnerUrls(K$q,K$e,K$h,K$Z,K$S,K$E,K$b);var K$n=K$e.length+K$h.length+K$Z.length,K$k=K$n+1,K$x=1/K$k;if(K$V._onProcessChange(K$c,0,K$x,1),0<K$Z.length){var K$r=K$n/K$k,K$g=K$A.create(null,K$V._onProcessChange,[K$c,K$x,K$r],!1);K$V._innerFourthLevelLoaderManager.create(K$Z,K$A.create(null,K$V._onHierarchyInnerForthLevResouLoaded,[K$c,K$P,K$g,K$q,K$S,K$e,K$h,K$x+K$r*K$Z.length,K$r]),K$g,null,null,1,!0,K$P)}else K$V._onHierarchyInnerForthLevResouLoaded(K$c,K$P,null,K$q,K$S,K$e,K$h,K$x,K$r)}},K$V._onHierarchyInnerForthLevResouLoaded=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){if(K$c._class.destroyed)K$c.endLoad();else if(K$q&&K$q.recover(),0<K$e.length){var K$S=K$A.create(null,K$V._onProcessChange,[K$c,K$h,K$Z],!1);K$V._innerSecondLevelLoaderManager.create(K$e,K$A.create(null,K$V._onHierarchyInnerSecondLevResouLoaded,[K$c,K$P,K$S,K$_,K$E,K$b,K$h+K$Z*K$e.length,K$Z]),K$q,null,null,1,!0,K$P)}else K$V._onHierarchyInnerSecondLevResouLoaded(K$c,K$P,null,K$_,K$E,K$b,K$h,K$Z)},K$V._onHierarchyInnerSecondLevResouLoaded=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h){if(K$c._class.destroyed)K$c.endLoad();else if(K$q&&K$q.recover(),0<K$b.length){var K$Z=K$A.create(null,K$V._onProcessChange,[K$c,K$e,K$h],!1);K$V._innerFirstLevelLoaderManager.create(K$b,K$A.create(null,K$V._onHierarchyInnerFirstLevResouLoaded,[K$c,K$Z,K$_,K$E]),K$q,null,null,1,!0,K$P)}else K$V._onHierarchyInnerFirstLevResouLoaded(K$c,null,K$_,K$E)},K$V._onHierarchyInnerFirstLevResouLoaded=function(K$c,K$P,K$q,K$_){K$P&&K$P.recover(),K$c.endLoad([K$q,K$_])},K$V._loadTerrain=function(K$c){K$c.on("loaded",null,K$V._onTerrainLtLoaded,[K$c,K$c._class._getGroup()]),K$c.load(K$c.url,"json",!1,null,!0)},K$V._onTerrainLtLoaded=function(K$c,K$P,K$q){if(K$c._class.destroyed)K$c.endLoad();else{var K$_,K$E,K$b=K$c.url,K$e=K$wP.getURLVerion(K$b),K$h=K$J.getPath(K$b),K$Z=[],K$S={},K$n=0,K$k=0,K$x=K$q.heightData;K$_=K$x.url,K$E=K$V.formatRelativePath(K$h,K$_),K$e&&(K$E+=K$e),K$_=K$S[K$_]=K$E;var K$r=K$q.detailTexture;for(K$n=0,K$k=K$r.length;K$n<K$k;K$n++)K$Z.push({url:K$r[K$n].diffuse});var K$g=K$q.normalMap;for(K$n=0,K$k=K$g.length;K$n<K$k;K$n++)K$Z.push({url:K$g[K$n]});var K$W=K$q.alphaMap;for(K$n=0,K$k=K$W.length;K$n<K$k;K$n++)K$Z.push({url:K$W[K$n],params:[!1,!1,6408,!0]});for(K$n=0,K$k=K$Z.length;K$n<K$k;K$n++){var K$w=K$Z[K$n].url;K$E=K$V.formatRelativePath(K$h,K$w),K$e&&(K$E+=K$e),K$Z[K$n].url=K$E,K$S[K$w]=K$E}var K$O=K$Z.length,K$N=K$O+2,K$m=1/K$N;K$V._onProcessChange(K$c,0,K$m,1);var K$T={heightMapLoaded:!1,texturesLoaded:!1},K$D=K$A.create(null,K$V._onProcessChange,[K$c,K$m,K$m],!1);K$V._innerFourthLevelLoaderManager.create(K$_,K$A.create(null,K$V._onTerrainHeightMapLoaded,[K$c,K$D,K$q,K$S,K$T]),K$D,null,[K$x.numX,K$x.numZ,K$x.bitType,K$x.value],1,!0,K$P);var K$L=K$A.create(null,K$V._onProcessChange,[K$c,2*K$m,K$O/K$N],!1);K$V._innerFourthLevelLoaderManager.create(K$Z,K$A.create(null,K$V._onTerrainTexturesLoaded,[K$c,K$L,K$q,K$S,K$T]),K$L,null,null,1,!0,K$P)}},K$V._onTerrainHeightMapLoaded=function(K$c,K$P,K$q,K$_,K$E){K$E.heightMapLoaded=!0,K$E.texturesLoaded&&(K$c.endLoad([K$q,K$_]),K$P.recover())},K$V._onTerrainTexturesLoaded=function(K$c,K$P,K$q,K$_,K$E){K$E.texturesLoaded=!0,K$E.heightMapLoaded&&(K$c.endLoad([K$q,K$_]),K$P.recover())},K$V._loadMesh=function(K$c){K$c.on("loaded",null,K$V._onMeshLmLoaded,[K$c,K$c._class._getGroup()]),K$c.load(K$c.url,"arraybuffer",!1,null,!0)},K$V._onMeshLmLoaded=function(K$c,K$P,K$q){if(K$c._class.destroyed)K$c.endLoad();else{var K$_,K$E,K$b,K$e=K$c.url,K$h=K$wP.getURLVerion(K$e),K$Z=K$J.getPath(K$e),K$S={},K$n=0,K$k=0;switch((K$V._readData=new K$L(K$q)).pos=0,K$V._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var K$x=K$V._readData.getUint32();K$V._readData.pos=K$V._readData.pos+4,K$k=K$V._readData.getUint16(),K$V._readData.pos=K$V._readData.pos+8*K$k;var K$r=K$V._readData.getUint32();for(K$k=K$V._readData.getUint16(),K$V._readData.pos=K$x+K$r,K$_=[],K$n=0;K$n<K$k;K$n++){var K$g=K$V._readData.readUTFString();-1!==K$g.lastIndexOf(".lmat")&&K$_.push(K$g)}break;default:for(K$V.READ_BLOCK(),K$n=0;K$n<2;K$n++){var K$W=K$V._readData.getUint16(),K$w=K$V._strings[K$W],K$O=K$V["READ_"+K$w];if(null==K$O)throw new Error("model file err,no this function:"+K$W+" "+K$w);1===K$n?K$_=K$O.call():K$O.call()}}for(K$n=0,K$b=K$_.length;K$n<K$b;K$n++){var K$N=K$_[K$n];K$E=K$V.formatRelativePath(K$Z,K$N),K$h&&(K$E+=K$h),K$_[K$n]=K$E,K$S[K$N]=K$E}if(0<K$_.length){K$V._onProcessChange(K$c,0,.5,1);var K$m=K$A.create(null,K$V._onProcessChange,[K$c,.5,.5],!1);K$V._innerSecondLevelLoaderManager.create(K$_,K$A.create(null,K$V._onMeshMateialLoaded,[K$c,K$m,K$q,K$S]),K$m,null,null,1,!0,K$P)}else K$c.endLoad([K$q,K$S])}},K$V._onMeshMateialLoaded=function(K$c,K$P,K$q,K$_){K$c.endLoad([K$q,K$_]),K$P.recover()},K$V._getMaterialTexturePath=function(K$c,K$P,K$q){var K$_=K$c.length-4;return K$c.indexOf(".dds")!=K$_&&K$c.indexOf(".tga")!=K$_&&K$c.indexOf(".exr")!=K$_&&K$c.indexOf(".DDS")!=K$_&&K$c.indexOf(".TGA")!=K$_&&K$c.indexOf(".EXR")!=K$_||(K$c=K$c.substr(0,K$_)+".png"),K$c=K$V.formatRelativePath(K$q,K$c),K$P&&(K$c+=K$P),K$c},K$V._loadMaterial=function(K$c){K$c.on("loaded",null,K$V._onMaterilLmatLoaded,[K$c,K$c._class._getGroup()]),K$c.load(K$c.url,"json",!1,null,!0)},K$V._onMaterilLmatLoaded=function(K$c,K$P,K$q){if(K$c._class.destroyed)K$c.endLoad();else{var K$_,K$E=K$c.url,K$b=K$wP.getURLVerion(K$E),K$e=K$J.getPath(K$E),K$h=[],K$Z={},K$S=K$q.customProps,K$n=K$q.version;if(K$n)switch(K$n){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var K$k=K$q.props.textures,K$x=0,K$r=K$k.length;K$x<K$r;K$x++){var K$g=K$k[K$x],K$W=K$g.path;if(K$W){var K$w=K$W.length-4;K$W.indexOf(".exr")!=K$w&&K$W.indexOf(".EXR")!=K$w||(K$W=K$W.substr(0,K$w)+".png"),K$_=K$V.formatRelativePath(K$e,K$W),K$b&&(K$_+=K$b),K$h.push({url:K$_,params:K$g.params}),K$Z[K$W]=K$_}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var K$O=K$S.diffuseTexture.texture2D;if(K$O&&(K$_=K$V._getMaterialTexturePath(K$O,K$b,K$e),K$h.push(K$_),K$Z[K$O]=K$_),K$S.normalTexture){var K$N=K$S.normalTexture.texture2D;K$N&&(K$_=K$V._getMaterialTexturePath(K$N,K$b,K$e),K$h.push(K$_),K$Z[K$N]=K$_)}if(K$S.specularTexture){var K$m=K$S.specularTexture.texture2D;K$m&&(K$_=K$V._getMaterialTexturePath(K$m,K$b,K$e),K$h.push(K$_),K$Z[K$m]=K$_)}if(K$S.emissiveTexture){var K$T=K$S.emissiveTexture.texture2D;K$T&&(K$_=K$V._getMaterialTexturePath(K$T,K$b,K$e),K$h.push(K$_),K$Z[K$T]=K$_)}if(K$S.ambientTexture){var K$D=K$S.ambientTexture.texture2D;K$D&&(K$_=K$V._getMaterialTexturePath(K$D,K$b,K$e),K$h.push(K$_),K$Z[K$D]=K$_)}if(K$S.reflectTexture){var K$L=K$S.reflectTexture.texture2D;K$L&&(K$_=K$V._getMaterialTexturePath(K$L,K$b,K$e),K$h.push(K$_),K$Z[K$L]=K$_)}}var K$H=K$h.length,K$Q=K$H+1,K$d=1/K$Q;if(K$V._onProcessChange(K$c,0,K$d,1),0<K$H){var K$u=K$A.create(null,K$V._onProcessChange,[K$c,K$d,K$H/K$Q],!1);K$V._innerFourthLevelLoaderManager.create(K$h,K$A.create(null,K$V._onMateialTexturesLoaded,[K$c,K$u,K$q,K$Z]),K$u,K$MP,null,1,!0,K$P)}else K$V._onMateialTexturesLoaded(K$c,null,K$q,null)}},K$V._onMateialTexturesLoaded=function(K$c,K$P,K$q,K$_){K$c.endLoad([K$q,K$_]),K$P&&K$P.recover()},K$V._loadTextureCube=function(K$c){K$c.on("loaded",null,K$V._onTextureCubeLtcLoaded,[K$c]),K$c.load(K$c.url,"json",!1,null,!0)},K$V._onTextureCubeLtcLoaded=function(K$c,K$P){if(K$c._class.destroyed)K$c.endLoad();else{var K$q=K$J.getPath(K$c.url),K$_=[K$V.formatRelativePath(K$q,K$P.px),K$V.formatRelativePath(K$q,K$P.nx),K$V.formatRelativePath(K$q,K$P.py),K$V.formatRelativePath(K$q,K$P.ny),K$V.formatRelativePath(K$q,K$P.pz),K$V.formatRelativePath(K$q,K$P.nz)];K$V._onProcessChange(K$c,0,1/7,1);var K$E=K$A.create(null,K$V._onProcessChange,[K$c,1/7,6/7],!1);K$V._innerFourthLevelLoaderManager.load(K$_,K$A.create(null,K$V._onTextureCubeImagesLoaded,[K$c,K$_,K$E]),K$E,"nativeimage")}},K$V._onTextureCubeImagesLoaded=function(K$c,K$P,K$q){var K$_=[];K$_.length=6;for(var K$E=0;K$E<6;K$E++){var K$b=K$P[K$E];K$_[K$E]=K$O.getRes(K$b),K$O.clearRes(K$b)}K$c.endLoad(K$_),K$q.recover()},K$V._onProcessChange=function(K$c,K$P,K$q,K$_){(K$_=K$P+K$_*K$q)<1&&K$c.event("progress",K$_)},K$V.init=function(K$c,K$P,K$q,K$_,K$E,K$b){if(void 0===K$q&&(K$q=!1),void 0===K$_&&(K$_=!1),void 0===K$E&&(K$E=!0),void 0===K$b&&(K$b=!0),K$N.update3DLoop=function(){},K$N.cancelLoadByUrl=function(K$c){K$V._cancelLoadByUrl(K$c)},K$Z.isAntialias=K$q,K$Z.isAlpha=K$_,K$Z.premultipliedAlpha=K$E,K$Z.isStencil=K$b,!K$j.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");K$N.changeWebGLSize=K$V._changeWebGLSize,K$W.is3DMode=!0,K$D.init(K$c,K$P),K$$.__init__(),K$kP.__init__(),K$lP.__init__(),K$I.__init__(),K$V.__init__(),K$e.maxTextureCount=2,(K$V.debugMode||K$B.debugMode)&&(K$V._debugPhasorSprite=new K$X)},K$V.HIERARCHY="SPRITE3DHIERARCHY",K$V.MESH="MESH",K$V.MATERIAL="MATERIAL",K$V.PBRMATERIAL="PBRMTL",K$V.TEXTURECUBE="TEXTURECUBE",K$V.TERRAIN="TERRAIN",K$V._readData=null,K$V._debugPhasorSprite=null,K$V.debugMode=!1,K$k(K$V,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new K$P},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new K$P},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new K$P},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new K$P}]),K$V}(),K$NP=function(K$c){function K$E(K$c){K$E.__super.call(this),this._owner=K$c,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}K$r(K$E,"laya.d3.animation.AnimationTransform3D",K$b);var K$P=K$E.prototype;return K$P._getlocalMatrix=function(){return this._localUpdate&&(K$wP._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},K$P._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var K$c=0,K$P=this._childs.length;K$c<K$P;K$c++)this._childs[K$c]._onWorldTransform()}},K$P._setWorldMatrixAndUpdate=function(K$c){if(this._worldMatrix=K$c,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var K$P=this._getlocalMatrix(),K$q=0;K$q<16;++K$q)this._worldMatrix[K$q]=K$P[K$q];else K$wP.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},K$P._setWorldMatrixNoUpdate=function(K$c){this._worldMatrix=K$c},K$P._setWorldMatrixIgnoreUpdate=function(K$c){this._worldMatrix=K$c,this._worldUpdate=!1},K$P.getLocalPosition=function(){return this._localPosition},K$P.setLocalPosition=function(K$c){if(this._parent)this._localPosition=K$c,this._localUpdate=!0,this._onWorldTransform();else{var K$P=this._entity.owner._transform,K$q=this._entity.localPosition,K$_=K$q.elements;K$_[0]=K$c[0],K$_[1]=K$c[1],K$_[2]=K$c[2],K$P.localPosition=K$q}},K$P.getLocalRotation=function(){if(this._localQuaternionUpdate){var K$c=this._localRotationEuler;K$wP._quaternionCreateFromYawPitchRollArray(K$c[1]/K$E._angleToRandin,K$c[0]/K$E._angleToRandin,K$c[2]/K$E._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},K$P.setLocalRotation=function(K$c){if(this._parent)this._localRotation=K$c,K$wP.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var K$P=this._entity.owner._transform,K$q=this._entity.localRotation,K$_=K$q.elements;K$_[0]=K$c[0],K$_[1]=K$c[1],K$_[2]=K$c[2],K$_[3]=K$c[3],K$P.localRotation=K$q}},K$P.getLocalScale=function(){return this._localScale},K$P.setLocalScale=function(K$c){if(this._parent)this._localScale=K$c,this._localUpdate=!0,this._onWorldTransform();else{var K$P=this._entity.owner._transform,K$q=this._entity.localScale,K$_=K$q.elements;K$_[0]=K$c[0],K$_[1]=K$c[1],K$_[2]=K$c[2],K$P.localScale=K$q}},K$P.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){K$wP.getYawPitchRoll(this._localRotation,K$E._tempVector3);var K$c=K$E._tempVector3,K$P=this._localRotationEuler;K$P[0]=K$c[1]*K$E._angleToRandin,K$P[1]=K$c[0]*K$E._angleToRandin,K$P[2]=K$c[2]*K$E._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},K$P.setLocalRotationEuler=function(K$c){if(this._parent)K$wP._quaternionCreateFromYawPitchRollArray(K$c[1]/K$E._angleToRandin,K$c[0]/K$E._angleToRandin,K$c[2]/K$E._angleToRandin,this._localRotation),this._localRotationEuler=K$c,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var K$P=this._entity.owner._transform,K$q=this._entity.localRotationEuler,K$_=K$q.elements;K$_[0]=K$c[0],K$_[1]=K$c[1],K$_[2]=K$c[2],K$P.localRotationEuler=K$q}},K$P.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)K$wP.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var K$c=this._getlocalMatrix(),K$P=0;K$P<16;++K$P)this._worldMatrix[K$P]=K$c[K$P];this._worldUpdate=!1}return this._worldMatrix},K$P.setParent=function(K$c){if(this._parent!==K$c){if(this._parent){var K$P=this._parent._childs,K$q=K$P.indexOf(this);K$P.splice(K$q,1)}K$c&&(K$c._childs.push(this),K$c&&this._onWorldTransform()),this._parent=K$c}},K$k(K$E,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),K$E}(),K$mP=function(K$c){function K$P(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,K$P.__super.call(this),this._destroyed=!1,this._id=K$P._uniqueIDCounter,K$P._uniqueIDCounter++}K$r(K$P,"laya.d3.component.Component3D",K$b);var K$q=K$P.prototype;return K$D.imps(K$q,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),K$q._initialize=function(K$c){this._owner=K$c,this._enable=!0,this.started=!1,this._load(K$c)},K$q._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},K$q._load=function(K$c){},K$q._start=function(K$c){},K$q._update=function(K$c){},K$q._lateUpdate=function(K$c){},K$q._preRenderUpdate=function(K$c){},K$q._postRenderUpdate=function(K$c){},K$q._unload=function(K$c){this.offAll()},K$q._cloneTo=function(K$c){},K$g(0,K$q,"id",function(){return this._id}),K$g(0,K$q,"destroyed",function(){return this._destroyed}),K$g(0,K$q,"owner",function(){return this._owner}),K$g(0,K$q,"enable",function(){return this._enable},function(K$c){this._enable!==K$c&&(this._enable=K$c,this.event("enablechanged",this._enable))}),K$g(0,K$q,"isSingleton",function(){return K$P._isSingleton}),K$P._isSingleton=!0,K$P._uniqueIDCounter=1,K$P}(),K$TP=function(K$c){function K$P(){this._destroyed=!1,K$P.__super.call(this),this._destroyed=!1}K$r(K$P,"laya.d3.core.GeometryFilter",K$b);var K$q=K$P.prototype;return K$D.imps(K$q,{"laya.resource.IDestroy":!0}),K$q._destroy=function(){this.offAll(),this._destroyed=!0},K$g(0,K$q,"_isAsyncLoaded",function(){return!0}),K$g(0,K$q,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),K$g(0,K$q,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),K$g(0,K$q,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),K$g(0,K$q,"destroyed",function(){return this._destroyed}),K$P}(),K$DP=function(K$c){function K$_(K$c){K$_.__super.call(this),this._id=++K$_._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new K$Bc(new K$eP,new K$eP),this._boundingBoxCenter=new K$eP,this._boundingSphere=new K$ic(new K$eP,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=K$c,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}K$r(K$_,"laya.d3.core.render.BaseRender",K$b);var K$P=K$_.prototype;return K$D.imps(K$P,{"laya.resource.IDestroy":!0}),K$P._changeMaterialReference=function(K$c,K$P){K$c&&K$c._removeReference(),K$P._addReference()},K$P._getInstanceMaterial=function(K$c,K$P){var K$q=new K$c.constructor;return K$c.cloneTo(K$q),K$q.name=K$q.name+"(Instance)",this._materialsInstance[K$P]=!0,this._changeMaterialReference(this._materials[K$P],K$q),this._materials[K$P]=K$q},K$P._setShaderValuelightMap=function(K$c){this._setShaderValueTexture(3,K$c)},K$P._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},K$P._renderRenderableBoundBox=function(){var K$c=K$OP._debugPhasorSprite,K$P=this.boundingBox,K$q=K$_._tempBoundBoxCorners;K$P.getCorners(K$q),K$c.line(K$q[0],K$_._greenColor,K$q[1],K$_._greenColor),K$c.line(K$q[2],K$_._greenColor,K$q[3],K$_._greenColor),K$c.line(K$q[4],K$_._greenColor,K$q[5],K$_._greenColor),K$c.line(K$q[6],K$_._greenColor,K$q[7],K$_._greenColor),K$c.line(K$q[0],K$_._greenColor,K$q[3],K$_._greenColor),K$c.line(K$q[1],K$_._greenColor,K$q[2],K$_._greenColor),K$c.line(K$q[2],K$_._greenColor,K$q[6],K$_._greenColor),K$c.line(K$q[3],K$_._greenColor,K$q[7],K$_._greenColor),K$c.line(K$q[0],K$_._greenColor,K$q[4],K$_._greenColor),K$c.line(K$q[1],K$_._greenColor,K$q[5],K$_._greenColor),K$c.line(K$q[4],K$_._greenColor,K$q[7],K$_._greenColor),K$c.line(K$q[5],K$_._greenColor,K$q[6],K$_._greenColor)},K$P._calculateBoundingSphere=function(){throw"BaseRender: must override it."},K$P._calculateBoundingBox=function(){throw"BaseRender: must override it."},K$P._setShaderValueTexture=function(K$c,K$P){this._owner._shaderValues.setValue(K$c,K$P)},K$P._setShaderValueMatrix4x4=function(K$c,K$P){this._owner._shaderValues.setValue(K$c,K$P?K$P.elements:null)},K$P._setShaderValueColor=function(K$c,K$P){this._owner._shaderValues.setValue(K$c,K$P?K$P.elements:null)},K$P._setShaderValueBuffer=function(K$c,K$P){this._owner._shaderValues.setValue(K$c,K$P)},K$P._setShaderValueInt=function(K$c,K$P){this._owner._shaderValues.setValue(K$c,K$P)},K$P._setShaderValueBool=function(K$c,K$P){this._owner._shaderValues.setValue(K$c,K$P)},K$P._setShaderValueNumber=function(K$c,K$P){this._owner._shaderValues.setValue(K$c,K$P)},K$P._setShaderValueVector2=function(K$c,K$P){this._owner._shaderValues.setValue(K$c,K$P?K$P.elements:null)},K$P._addShaderDefine=function(K$c){this._owner._shaderDefineValue|=K$c},K$P._removeShaderDefine=function(K$c){this._owner._shaderDefineValue&=~K$c},K$P._renderUpdate=function(K$c){return!0},K$P._applyLightMapParams=function(){if(0<=this._lightmapIndex){var K$c=this._owner.scene;if(K$c){var K$P=K$c.getlightmaps()[this._lightmapIndex];K$P?(this._addShaderDefine(K$XP.SAHDERDEFINE_LIGHTMAP),K$P.loaded?this._setShaderValuelightMap(K$P):K$P.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(K$XP.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(K$XP.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(K$XP.SAHDERDEFINE_LIGHTMAP)},K$P._updateOctreeNode=function(){var K$c=this._treeNode;K$c&&this._octreeNodeNeedChange&&(K$c.updateObject(this),this._octreeNodeNeedChange=!1)},K$P._destroy=function(){this.offAll();var K$c=0,K$P=0;for(K$c=0,K$P=this._renderElements.length;K$c<K$P;K$c++)this._renderElements[K$c]._destroy();for(K$c=0,K$P=this._materials.length;K$c<K$P;K$c++)this._materials[K$c]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},K$g(0,K$P,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),K$g(0,K$P,"id",function(){return this._id}),K$g(0,K$P,"material",function(){var K$c=this._materials[0];if(K$c&&!this._materialsInstance[0]){var K$P=this._getInstanceMaterial(K$c,0);this.event("materialchanged",[this,0,K$P])}return this._materials[0]},function(K$c){this.sharedMaterial=K$c}),K$g(0,K$P,"sharedMaterial",function(){return this._materials[0]},function(K$c){var K$P=this._materials[0];K$P!==K$c&&(this._materials[0]=K$c,this._materialsInstance[0]=!1,this._changeMaterialReference(K$P,K$c),this.event("materialchanged",[this,0,K$c]))}),K$g(0,K$P,"lightmapIndex",function(){return this._lightmapIndex},function(K$c){this._lightmapIndex=K$c,this._applyLightMapParams()}),K$g(0,K$P,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(K$c){this._lightmapScaleOffset=K$c,this._setShaderValueColor(2,K$c),this._addShaderDefine(K$XP.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),K$g(0,K$P,"enable",function(){return this._enable},function(K$c){this._enable=K$c,this.event("enablechanged",[this,K$c])}),K$g(0,K$P,"materials",function(){for(var K$c=0,K$P=this._materials.length;K$c<K$P;K$c++)if(!this._materialsInstance[K$c]){var K$q=this._getInstanceMaterial(this._materials[K$c],K$c);this.event("materialchanged",[this,K$c,K$q])}return this._materials.slice()},function(K$c){this.sharedMaterials=K$c}),K$g(0,K$P,"sharedMaterials",function(){return this._materials.slice()},function(K$c){if(!K$c)throw new Error("MeshRender: shadredMaterials value can't be null.");var K$P=K$c.length;this._materialsInstance.length=K$P;for(var K$q=0;K$q<K$P;K$q++){var K$_=this._materials[K$q];K$_!==K$c[K$q]&&(this._materialsInstance[K$q]=!1,this._changeMaterialReference(K$_,K$c[K$q]),this.event("materialchanged",[this,K$q,K$c[K$q]]))}this._materials=K$c}),K$g(0,K$P,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),K$g(0,K$P,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var K$c=this.boundingBox;K$eP.add(K$c.min,K$c.max,this._boundingBoxCenter),K$eP.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),K$g(0,K$P,"receiveShadow",function(){return this._receiveShadow},function(K$c){this._receiveShadow!==K$c&&((this._receiveShadow=K$c)?this._addShaderDefine(K$rP.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(K$rP.SHADERDEFINE_RECEIVE_SHADOW))}),K$g(0,K$P,"destroyed",function(){return this._destroyed}),K$_._uniqueIDCounter=0,K$k(K$_,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new K$eP,new K$eP,new K$eP,new K$eP,new K$eP,new K$eP,new K$eP,new K$eP]},"_greenColor",function(){return this._greenColor=new K$hP(0,1,0,1)}]),K$_}(),K$LP=function(K$c){function K$h(K$c){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,K$h.__super.call(this),this._localPosition=new K$eP,this._localRotation=new K$qP(0,0,0,1),this._localScale=new K$eP(1,1,1),this._localRotationEuler=new K$eP,this._localMatrix=new K$cP,this._position=new K$eP,this._rotation=new K$qP(0,0,0,1),this._scale=new K$eP(1,1,1),this._worldMatrix=new K$cP,this._forward=new K$eP,this._up=new K$eP,this._right=new K$eP,this._owner=K$c,this._childs=[]}K$r(K$h,"laya.d3.core.Transform3D",K$b);var K$P=K$h.prototype;return K$P._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)K$cP.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var K$c=K$h._tempVector30;K$eP.multiply(this.pivot,this._localScale,K$c);var K$P=K$h._tempVector31;K$eP.subtract(K$c,this.pivot,K$P);var K$q=K$h._tempVector32,K$_=this.localRotation;K$eP.transformQuat(K$c,K$_,K$q),K$eP.subtract(K$q,K$c,K$q);var K$E=K$h._tempVector33;K$eP.subtract(this._localPosition,K$P,K$E),K$eP.subtract(K$E,K$q,K$E),K$cP.createAffineTransformation(K$E,K$_,this._localScale,this._localMatrix)}},K$P._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var K$c=0,K$P=this._childs.length;K$c<K$P;K$c++)this._childs[K$c]._onWorldPositionRotationTransform()}},K$P._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var K$c=0,K$P=this._childs.length;K$c<K$P;K$c++)this._childs[K$c]._onWorldPositionScaleTransform()}},K$P._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var K$c=0,K$P=this._childs.length;K$c<K$P;K$c++)this._childs[K$c]._onWorldPositionTransform()}},K$P._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var K$c=0,K$P=this._childs.length;K$c<K$P;K$c++)this._childs[K$c]._onWorldPositionRotationTransform()}},K$P._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var K$c=0,K$P=this._childs.length;K$c<K$P;K$c++)this._childs[K$c]._onWorldPositionScaleTransform()}},K$P._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var K$c=0,K$P=this._childs.length;K$c<K$P;K$c++)this._childs[K$c]._onWorldTransform()}},K$P.translate=function(K$c,K$P){void 0===K$P&&(K$P=!0),K$P?(K$cP.createFromQuaternion(this.localRotation,K$h._tempMatrix0),K$eP.transformCoordinate(K$c,K$h._tempMatrix0,K$h._tempVector30),K$eP.add(this.localPosition,K$h._tempVector30,this._localPosition),this.localPosition=this._localPosition):(K$eP.add(this.position,K$c,this._position),this.position=this._position)},K$P.rotate=function(K$c,K$P,K$q){var K$_;void 0===K$P&&(K$P=!0),void 0===K$q&&(K$q=!0),K$_=K$q?K$c:(K$eP.scale(K$c,Math.PI/180,K$h._tempVector30),K$h._tempVector30),K$qP.createFromYawPitchRoll(K$_.y,K$_.x,K$_.z,K$h._tempQuaternion0),K$P?(K$qP.multiply(this._localRotation,K$h._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(K$qP.multiply(K$h._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},K$P.lookAt=function(K$c,K$P,K$q){void 0===K$q&&(K$q=!1);var K$_,K$E=K$c.elements;if(K$q){if(K$_=this._localPosition.elements,Math.abs(K$_[0]-K$E[0])<K$Kc.zeroTolerance&&Math.abs(K$_[1]-K$E[1])<K$Kc.zeroTolerance&&Math.abs(K$_[2]-K$E[2])<K$Kc.zeroTolerance)return;K$qP.lookAt(this._localPosition,K$c,K$P,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var K$b=this.position;if(K$_=K$b.elements,Math.abs(K$_[0]-K$E[0])<K$Kc.zeroTolerance&&Math.abs(K$_[1]-K$E[1])<K$Kc.zeroTolerance&&Math.abs(K$_[2]-K$E[2])<K$Kc.zeroTolerance)return;K$qP.lookAt(K$b,K$c,K$P,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},K$g(0,K$P,"_isFrontFaceInvert",function(){var K$c=this.scale,K$P=K$c.x<0;return K$c.y<0&&(K$P=!K$P),K$c.z<0&&(K$P=!K$P),K$P}),K$g(0,K$P,"owner",function(){return this._owner}),K$g(0,K$P,"localRotation",function(){if(this._localQuaternionUpdate){var K$c=this._localRotationEuler.elements;K$qP.createFromYawPitchRoll(K$c[1]/K$h._angleToRandin,K$c[0]/K$h._angleToRandin,K$c[2]/K$h._angleToRandin,this._localRotation)}return this._localRotation},function(K$c){this._localRotation=K$c,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),K$g(0,K$P,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?K$cP.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(K$c){null===this._parent?K$c.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),K$cP.multiply(this._localMatrix,K$c,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=K$c,this._worldUpdate=!1}),K$g(0,K$P,"worldNeedUpdate",function(){return this._worldUpdate}),K$g(0,K$P,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(K$c){this._localMatrix=K$c,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),K$g(0,K$P,"dummy",function(){return this._dummy},function(K$c){this._dummy!==K$c&&(this._dummy&&(this._dummy._entity=null),K$c&&(K$c._entity=this),this._dummy=K$c)}),K$g(0,K$P,"localPosition",function(){return this._localPosition},function(K$c){this._localPosition=K$c,this._localUpdate=!0,this._onWorldPositionTransform()}),K$g(0,K$P,"position",function(){if(this._positionUpdate){if(null!=this._parent){var K$c=this._parent.position;K$eP.multiply(this._localPosition,this._parent.scale,K$h._tempVector30),K$eP.transformQuat(K$h._tempVector30,this._parent.rotation,K$h._tempVector30),K$eP.add(K$c,K$h._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(K$c){if(null!=this._parent){K$eP.subtract(K$c,this._parent.position,this._localPosition);var K$P=this._parent.scale.elements,K$q=K$P[0],K$_=K$P[1],K$E=K$P[2];if(1!==K$q||1!==K$_||1!==K$E){var K$b=K$h._tempVector30,K$e=K$b.elements;K$e[0]=1/K$q,K$e[1]=1/K$_,K$e[2]=1/K$E,K$eP.multiply(this._localPosition,K$b,this._localPosition)}this._parent.rotation.invert(K$h._tempQuaternion0),K$eP.transformQuat(this._localPosition,K$h._tempQuaternion0,this._localPosition)}else K$c.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=K$c,this._positionUpdate=!1}),K$g(0,K$P,"localScale",function(){return this._localScale},function(K$c){this._localScale=K$c,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),K$g(0,K$P,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(K$h._tempVector30);var K$c=K$h._tempVector30.elements,K$P=this._localRotationEuler.elements;K$P[0]=K$c[1]*K$h._angleToRandin,K$P[1]=K$c[0]*K$h._angleToRandin,K$P[2]=K$c[2]*K$h._angleToRandin}return this._localRotationEuler},function(K$c){this._localRotationEuler=K$c,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),K$g(0,K$P,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?K$qP.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(K$c){null!=this._parent?(this._parent.rotation.invert(K$h._tempQuaternion0),K$qP.multiply(K$c,K$h._tempQuaternion0,this._localRotation)):K$c.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=K$c,this._rotationUpdate=!1}),K$g(0,K$P,"scale",function(){return this._scaleUpdate&&(null!==this._parent?K$eP.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(K$c){if(null!==this._parent){var K$P=this._parent.scale.elements,K$q=K$h._tempVector30.elements;K$q[0]=1/K$P[0],K$q[1]=1/K$P[1],K$q[2]=1/K$P[2],K$eP.multiply(K$c,K$h._tempVector30,this._localScale)}else K$c.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=K$c,this._scaleUpdate=!1}),K$g(0,K$P,"rotationEuler",null,function(K$c){K$qP.createFromYawPitchRoll(K$c.y,K$c.x,K$c.z,this._rotation),this.rotation=this._rotation}),K$g(0,K$P,"forward",function(){var K$c=this.worldMatrix.elements;return this._forward.elements[0]=-K$c[8],this._forward.elements[1]=-K$c[9],this._forward.elements[2]=-K$c[10],this._forward}),K$g(0,K$P,"up",function(){var K$c=this.worldMatrix.elements;return this._up.elements[0]=K$c[4],this._up.elements[1]=K$c[5],this._up.elements[2]=K$c[6],this._up}),K$g(0,K$P,"right",function(){var K$c=this.worldMatrix.elements;return this._right.elements[0]=K$c[0],this._right.elements[1]=K$c[1],this._right.elements[2]=K$c[2],this._right}),K$g(0,K$P,"parent",function(){return this._parent},function(K$c){if(this._parent!==K$c){if(this._parent){var K$P=this._parent._childs,K$q=K$P.indexOf(this);K$P.splice(K$q,1)}K$c&&(K$c._childs.push(this),K$c&&this._onWorldTransform()),this._parent=K$c}}),K$k(K$h,["_tempVector30",function(){return this._tempVector30=new K$eP},"_tempVector31",function(){return this._tempVector31=new K$eP},"_tempVector32",function(){return this._tempVector32=new K$eP},"_tempVector33",function(){return this._tempVector33=new K$eP},"_tempQuaternion0",function(){return this._tempQuaternion0=new K$qP},"_tempMatrix0",function(){return this._tempMatrix0=new K$cP},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),K$h}(),K$HP=(function(K$c){function K$P(){this._rotation=0,this._matNeedUpdte=!1,K$P.__super.call(this),this._matrix=new K$cP,this._offset=new K$bP,this._tiling=new K$bP(1,1)}K$r(K$P,"laya.d3.core.TransformUV",K$b);var K$q=K$P.prototype;K$D.imps(K$q,{"laya.d3.core.IClone":!0}),K$q._updateMatrix=function(){K$P._tempOffsetV3.elements[0]=this._offset.x,K$P._tempOffsetV3.elements[1]=this._offset.y,K$qP.createFromYawPitchRoll(0,0,this._rotation,K$P._tempRotationQua),K$P._tempTitlingV3.elements[0]=this._tiling.x,K$P._tempTitlingV3.elements[1]=this._tiling.y,K$cP.createAffineTransformation(K$P._tempOffsetV3,K$P._tempRotationQua,K$P._tempTitlingV3,this._matrix)},K$q.cloneTo=function(K$c){K$c._matrix=this._matrix.clone(),K$c._offset=this._offset.clone(),K$c._rotation=this._rotation,K$c._tiling=this._tiling.clone()},K$q.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$q,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),K$g(0,K$q,"tiling",function(){return this._tiling},function(K$c){this._tiling=K$c,this._matNeedUpdte=!0}),K$g(0,K$q,"offset",function(){return this._offset},function(K$c){this._offset=K$c,this._matNeedUpdte=!0}),K$g(0,K$q,"rotation",function(){return this._rotation},function(K$c){this._rotation=K$c,this._matNeedUpdte=!0}),K$k(K$P,["_tempOffsetV3",function(){return this._tempOffsetV3=new K$eP(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new K$qP},"_tempTitlingV3",function(){return this._tempTitlingV3=new K$eP(1,1,1)}])}(),function(K$q){function K$c(){this.x=NaN,this.y=NaN,this.z=NaN,K$c.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}K$r(K$c,"laya.d3.core.particleShuriKen.module.shape.BoxShape",K$q);var K$P=K$c.prototype;K$P._getShapeBoundBox=function(K$c){var K$P=K$c.min.elements;K$P[0]=.5*-this.x,K$P[1]=.5*-this.y,K$P[2]=.5*-this.z;var K$q=K$c.max.elements;K$q[0]=.5*this.x,K$q[1]=.5*this.y,K$q[2]=.5*this.z},K$P._getSpeedBoundBox=function(K$c){var K$P=K$c.min.elements;K$P[0]=0,K$P[1]=0,K$P[2]=0;var K$q=K$c.max.elements;K$q[0]=0,K$q[1]=1,K$q[2]=0},K$P.generatePositionAndDirection=function(K$c,K$P,K$q,K$_){var K$E=K$c.elements,K$b=K$P.elements;K$q?(K$q.seed=K$_[16],K$M._randomPointInsideHalfUnitBox(K$c,K$q),K$_[16]=K$q.seed):K$M._randomPointInsideHalfUnitBox(K$c),K$E[0]=this.x*K$E[0],K$E[1]=this.y*K$E[1],K$E[2]=this.z*K$E[2],this.randomDirection?K$q?(K$q.seed=K$_[17],K$M._randomPointUnitSphere(K$P,K$q),K$_[17]=K$q.seed):K$M._randomPointUnitSphere(K$P):(K$b[0]=0,K$b[1]=0,K$b[2]=1)},K$P.cloneTo=function(K$c){K$q.prototype.cloneTo.call(this,K$c);var K$P=K$c;K$P.x=this.x,K$P.y=this.y,K$P.z=this.z,K$P.randomDirection=this.randomDirection}}(K$s),function(K$q){function K$e(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,K$e.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}K$r(K$e,"laya.d3.core.particleShuriKen.module.shape.CircleShape",K$q);var K$c=K$e.prototype;K$c._getShapeBoundBox=function(K$c){var K$P=K$c.min.elements;K$P[0]=K$P[2]=-this.radius,K$P[1]=0;var K$q=K$c.max.elements;K$q[0]=K$q[2]=this.radius,K$q[1]=0},K$c._getSpeedBoundBox=function(K$c){var K$P=K$c.min.elements;K$P[0]=K$P[1]=-1,K$P[2]=0;var K$q=K$c.max.elements;K$q[0]=K$q[1]=1,K$q[2]=0},K$c.generatePositionAndDirection=function(K$c,K$P,K$q,K$_){var K$E=K$c.elements,K$b=K$e._tempPositionPoint.elements;K$q?(K$q.seed=K$_[16],this.emitFromEdge?K$M._randomPointUnitArcCircle(this.arc,K$e._tempPositionPoint,K$q):K$M._randomPointInsideUnitArcCircle(this.arc,K$e._tempPositionPoint,K$q),K$_[16]=K$q.seed):this.emitFromEdge?K$M._randomPointUnitArcCircle(this.arc,K$e._tempPositionPoint):K$M._randomPointInsideUnitArcCircle(this.arc,K$e._tempPositionPoint),K$E[0]=-K$b[0],K$E[1]=K$b[1],K$E[2]=0,K$eP.scale(K$c,this.radius,K$c),this.randomDirection?K$q?(K$q.seed=K$_[17],K$M._randomPointUnitSphere(K$P,K$q),K$_[17]=K$q.seed):K$M._randomPointUnitSphere(K$P):K$c.cloneTo(K$P)},K$c.cloneTo=function(K$c){K$q.prototype.cloneTo.call(this,K$c);var K$P=K$c;K$P.radius=this.radius,K$P.arc=this.arc,K$P.emitFromEdge=this.emitFromEdge,K$P.randomDirection=this.randomDirection},K$k(K$e,["_tempPositionPoint",function(){return this._tempPositionPoint=new K$bP}])}(K$s),function(K$q){function K$x(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,K$x.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}K$r(K$x,"laya.d3.core.particleShuriKen.module.shape.ConeShape",K$q);var K$c=K$x.prototype;K$c._getShapeBoundBox=function(K$c){var K$P=this.radius+this.length*Math.sin(this.angle),K$q=this.length*Math.cos(this.angle),K$_=K$c.min.elements;K$_[0]=K$_[1]=-K$P,K$_[2]=0;var K$E=K$c.max.elements;K$E[0]=K$E[1]=K$P,K$E[2]=K$q},K$c._getSpeedBoundBox=function(K$c){var K$P=Math.sin(this.angle),K$q=K$c.min.elements;K$q[0]=K$q[1]=-K$P,K$q[2]=0;var K$_=K$c.max.elements;K$_[0]=K$q[1]=K$P,K$_[2]=1},K$c.generatePositionAndDirection=function(K$c,K$P,K$q,K$_){var K$E,K$b=K$c.elements,K$e=K$P.elements,K$h=K$x._tempPositionPoint.elements,K$Z=NaN,K$S=NaN,K$n=Math.cos(this.angle),K$k=Math.sin(this.angle);switch(this.emitType){case 0:K$q?(K$q.seed=K$_[16],K$M._randomPointInsideUnitCircle(K$x._tempPositionPoint,K$q),K$_[16]=K$q.seed):K$M._randomPointInsideUnitCircle(K$x._tempPositionPoint),K$Z=K$h[0],K$S=K$h[1],K$b[0]=K$Z*this.radius,K$b[1]=K$S*this.radius,K$b[2]=0,this.randomDirection?(K$q?(K$q.seed=K$_[17],K$M._randomPointInsideUnitCircle(K$x._tempDirectionPoint,K$q),K$_[17]=K$q.seed):K$M._randomPointInsideUnitCircle(K$x._tempDirectionPoint),K$E=K$x._tempDirectionPoint.elements,K$e[0]=K$E[0]*K$k,K$e[1]=K$E[1]*K$k):(K$e[0]=K$Z*K$k,K$e[1]=K$S*K$k),K$e[2]=K$n;break;case 1:K$q?(K$q.seed=K$_[16],K$M._randomPointUnitCircle(K$x._tempPositionPoint,K$q),K$_[16]=K$q.seed):K$M._randomPointUnitCircle(K$x._tempPositionPoint),K$Z=K$h[0],K$S=K$h[1],K$b[0]=K$Z*this.radius,K$b[1]=K$S*this.radius,K$b[2]=0,this.randomDirection?(K$q?(K$q.seed=K$_[17],K$M._randomPointInsideUnitCircle(K$x._tempDirectionPoint,K$q),K$_[17]=K$q.seed):K$M._randomPointInsideUnitCircle(K$x._tempDirectionPoint),K$E=K$x._tempDirectionPoint.elements,K$e[0]=K$E[0]*K$k,K$e[1]=K$E[1]*K$k):(K$e[0]=K$Z*K$k,K$e[1]=K$S*K$k),K$e[2]=K$n;break;case 2:K$q?(K$q.seed=K$_[16],K$M._randomPointInsideUnitCircle(K$x._tempPositionPoint,K$q)):K$M._randomPointInsideUnitCircle(K$x._tempPositionPoint),K$Z=K$h[0],K$S=K$h[1],K$b[0]=K$Z*this.radius,K$b[1]=K$S*this.radius,K$e[K$b[2]=0]=K$Z*K$k,K$e[1]=K$S*K$k,K$e[2]=K$n,K$eP.normalize(K$P,K$P),K$q?(K$eP.scale(K$P,this.length*K$q.getFloat(),K$P),K$_[16]=K$q.seed):K$eP.scale(K$P,this.length*Math.random(),K$P),K$eP.add(K$c,K$P,K$c),this.randomDirection&&(K$q?(K$q.seed=K$_[17],K$M._randomPointUnitSphere(K$P,K$q),K$_[17]=K$q.seed):K$M._randomPointUnitSphere(K$P));break;case 3:K$q?(K$q.seed=K$_[16],K$M._randomPointUnitCircle(K$x._tempPositionPoint,K$q)):K$M._randomPointUnitCircle(K$x._tempPositionPoint),K$Z=K$h[0],K$S=K$h[1],K$b[0]=K$Z*this.radius,K$b[1]=K$S*this.radius,K$e[K$b[2]=0]=K$Z*K$k,K$e[1]=K$S*K$k,K$e[2]=K$n,K$eP.normalize(K$P,K$P),K$q?(K$eP.scale(K$P,this.length*K$q.getFloat(),K$P),K$_[16]=K$q.seed):K$eP.scale(K$P,this.length*Math.random(),K$P),K$eP.add(K$c,K$P,K$c),this.randomDirection&&(K$q?(K$q.seed=K$_[17],K$M._randomPointUnitSphere(K$P,K$q),K$_[17]=K$q.seed):K$M._randomPointUnitSphere(K$P));break;default:throw new Error("ConeShape:emitType is invalid.")}},K$c.cloneTo=function(K$c){K$q.prototype.cloneTo.call(this,K$c);var K$P=K$c;K$P.angle=this.angle,K$P.radius=this.radius,K$P.length=this.length,K$P.emitType=this.emitType,K$P.randomDirection=this.randomDirection},K$k(K$x,["_tempPositionPoint",function(){return this._tempPositionPoint=new K$bP},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new K$bP}])}(K$s),function(K$q){function K$c(){this.radius=NaN,this.emitFromShell=!1,K$c.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}K$r(K$c,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",K$q);var K$P=K$c.prototype;K$P._getShapeBoundBox=function(K$c){var K$P=K$c.min.elements;K$P[0]=K$P[1]=K$P[2]=-this.radius;var K$q=K$c.max.elements;K$q[0]=K$q[1]=this.radius,K$q[2]=0},K$P._getSpeedBoundBox=function(K$c){var K$P=K$c.min.elements;K$P[0]=K$P[1]=-1,K$P[2]=0;var K$q=K$c.max.elements;K$q[0]=K$q[1]=K$q[2]=1},K$P.generatePositionAndDirection=function(K$c,K$P,K$q,K$_){var K$E=K$c.elements;K$q?(K$q.seed=K$_[16],this.emitFromShell?K$M._randomPointUnitSphere(K$c,K$q):K$M._randomPointInsideUnitSphere(K$c,K$q),K$_[16]=K$q.seed):this.emitFromShell?K$M._randomPointUnitSphere(K$c):K$M._randomPointInsideUnitSphere(K$c),K$eP.scale(K$c,this.radius,K$c);var K$b=K$E[2];K$b<0&&(K$E[2]=-1*K$b),this.randomDirection?K$q?(K$q.seed=K$_[17],K$M._randomPointUnitSphere(K$P,K$q),K$_[17]=K$q.seed):K$M._randomPointUnitSphere(K$P):K$c.cloneTo(K$P)},K$P.cloneTo=function(K$c){K$q.prototype.cloneTo.call(this,K$c);var K$P=K$c;K$P.radius=this.radius,K$P.emitFromShell=this.emitFromShell,K$P.randomDirection=this.randomDirection}}(K$s),function(K$q){function K$c(){this.radius=NaN,this.emitFromShell=!1,K$c.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}K$r(K$c,"laya.d3.core.particleShuriKen.module.shape.SphereShape",K$q);var K$P=K$c.prototype;K$P._getShapeBoundBox=function(K$c){var K$P=K$c.min.elements;K$P[0]=K$P[1]=K$P[2]=-this.radius;var K$q=K$c.max.elements;K$q[0]=K$q[1]=K$q[2]=this.radius},K$P._getSpeedBoundBox=function(K$c){var K$P=K$c.min.elements;K$P[0]=K$P[1]=K$P[2]=-1;var K$q=K$c.max.elements;K$q[0]=K$q[1]=K$q[2]=1},K$P.generatePositionAndDirection=function(K$c,K$P,K$q,K$_){K$q?(K$q.seed=K$_[16],this.emitFromShell?K$M._randomPointUnitSphere(K$c,K$q):K$M._randomPointInsideUnitSphere(K$c,K$q),K$_[16]=K$q.seed):this.emitFromShell?K$M._randomPointUnitSphere(K$c):K$M._randomPointInsideUnitSphere(K$c),K$eP.scale(K$c,this.radius,K$c),this.randomDirection?K$q?(K$q.seed=K$_[17],K$M._randomPointUnitSphere(K$P,K$q),K$_[17]=K$q.seed):K$M._randomPointUnitSphere(K$P):K$c.cloneTo(K$P)},K$P.cloneTo=function(K$c){K$q.prototype.cloneTo.call(this,K$c);var K$P=K$c;K$P.radius=this.radius,K$P.emitFromShell=this.emitFromShell,K$P.randomDirection=this.randomDirection}}(K$s),function(K$c){function K$P(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,K$P.__super.call(this)}return K$r(K$P,"laya.d3.core.render.SubMeshRenderElement",K$f),K$P}()),K$QP=function(K$c){function K$w(K$c,K$P,K$q,K$_,K$E,K$b){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=K$c,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[K$rP.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[K$XP.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[K$XP.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[K$JP.SHADERDEFINE_ALPHATEST]="ALPHATEST";K$w.__super.call(this,K$c,K$P,K$q,null,{}),this._attributeMap=K$_;var K$e;for(K$e in K$E){var K$h=K$E[K$e];switch(K$h[1]){case 0:this._renderElementUniformMap[K$e]=K$h[0];break;case 1:this._materialUniformMap[K$e]=K$h[0];break;case 2:this._spriteUniformMap[K$e]=K$h[0];break;case 3:this._cameraUniformMap[K$e]=K$h[0];break;case 4:this._sceneUniformMap[K$e]=K$h[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}K$r(K$w,"laya.d3.shader.ShaderCompile3D",K$m);var K$P=K$w.prototype;return K$P._definesToNameDic=function(K$c,K$P){for(var K$q={},K$_=1,K$E=0;K$E<32&&!(K$c<(K$_=1<<K$E));K$E++)if(K$c&K$_){var K$b=K$P[K$_];K$b&&(K$q[K$b]="")}return K$q},K$P.withCompile=function(K$c,K$P,K$q,K$_){var K$E,K$b,K$e;if(K$b=this.sharders[K$c])if(K$e=K$b[K$P]){if(K$E=K$e[K$q])return K$E}else K$e=K$b[K$P]=[];else K$e=(K$b=this.sharders[K$c]=[])[K$P]=[];var K$h,K$Z=this._definesToNameDic(K$c,K$w._globalInt2name),K$S=this._definesToNameDic(K$P,this._spriteInt2name),K$n=this._definesToNameDic(K$q,this._materialInt2name),K$k={},K$x="";if(K$Z)for(K$h in K$Z)K$x+="#define "+K$h+"\n",K$k[K$h]=!0;if(K$S)for(K$h in K$S)K$x+="#define "+K$h+"\n",K$k[K$h]=!0;if(K$n)for(K$h in K$n)K$x+="#define "+K$h+"\n",K$k[K$h]=!0;var K$r=K$oP.nameKey.getName(this._name)+" compile ("+K$c+","+K$P+","+K$q+")",K$g=this._VS.toscript(K$k,[]),K$W=this._PS.toscript(K$k,[]);K$R.now();if(K$E=K$oP.create(K$x+K$g.join("\n"),K$x+K$W.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,K$_,K$r),K$e[K$q]=K$E,laya.d3.shader.ShaderCompile3D.debugMode)K$R.now();return K$E},K$P.precompileShaderWithShaderDefine=function(K$c,K$P,K$q){this.withCompile(K$c,K$P,K$q,!0)},K$P.addMaterialDefines=function(K$c){var K$P=K$c.defines;for(var K$q in K$P){var K$_=K$P[K$q],K$E=parseInt(K$q);this._materialInt2name[K$E]=K$_,this._materialName2Int[K$_]=K$E}},K$P.addSpriteDefines=function(K$c){var K$P=K$c.defines;for(var K$q in K$P){var K$_=K$P[K$q],K$E=parseInt(K$q);this._spriteInt2name[K$E]=K$_,this._spriteName2Int[K$_]=K$E}},K$P.getMaterialDefineByName=function(K$c){return this._materialName2Int[K$c]},K$P.registerMaterialDefine=function(K$c){var K$P=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[K$P]=K$c,this._materialName2Int[K$c]=K$P},K$P.registerSpriteDefine=function(K$c){var K$P=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[K$P]=K$c,this._spriteName2Int[K$c]=K$P},K$w._globalRegDefine=function(K$c,K$P){K$w._globalInt2name[K$P]=K$c},K$w.add=function(K$c,K$P,K$q,K$_,K$E){return laya.d3.shader.ShaderCompile3D._preCompileShader[K$c]=new K$w(K$c,K$P,K$q,K$_,K$E,K$m.includes)},K$w.get=function(K$c){return laya.d3.shader.ShaderCompile3D._preCompileShader[K$oP.nameKey.getID(K$c)]},K$w._preCompileShader={},K$w._globalInt2name=[],K$w.debugMode=!1,K$w.SHADERDEFINE_HIGHPRECISION=1,K$w.SHADERDEFINE_FOG=4,K$w.SHADERDEFINE_DIRECTIONLIGHT=8,K$w.SHADERDEFINE_POINTLIGHT=16,K$w.SHADERDEFINE_SPOTLIGHT=32,K$w.SHADERDEFINE_UV0=64,K$w.SHADERDEFINE_COLOR=128,K$w.SHADERDEFINE_UV1=256,K$w.SAHDERDEFINE_DEPTHFOG=131072,K$w}(),K$dP=function(K$c){function K$g(){K$g.__super.call(this)}K$r(K$g,"laya.d3.graphics.MeshSprite3DStaticBatchManager",K$_c);var K$P=K$g.prototype;return K$P._getStaticBatch=function(K$c,K$P,K$q,K$_){var K$E,K$b;return K$b=K$c?K$c.id.toString()+K$q.id.toString()+K$P.id.toString()+K$_.toString():K$q.id.toString()+K$P.id.toString()+K$_.toString(),this._staticBatches[K$b]?K$E=this._staticBatches[K$b]:this._staticBatches[K$b]=K$E=new K$uP(K$b,this,K$c,K$P,K$q),K$E},K$P._initStaticBatchs=function(K$c){var K$P,K$q;this._initBatchRenderElements.sort(K$g._sortPrepareStaticBatch);for(var K$_,K$E=!1,K$b=0,K$e=0,K$h=this._initBatchRenderElements.length;K$e<K$h;K$e++){var K$Z,K$S=this._initBatchRenderElements[K$e],K$n=K$S.renderObj._getVertexBuffer(0);K$S._sprite3D;if(K$q===K$n.vertexDeclaration&&K$P===K$S._material)if(K$E)K$_._addCombineBatchRenderObjTest(K$S)?(K$Z=K$S._staticBatch)!==K$_&&(K$Z&&K$Z._deleteCombineBatchRenderObj(K$S),K$_._addCombineBatchRenderObj(K$S)):(K$E=!1,K$b++);else{var K$k=this._initBatchRenderElements[K$e-1],K$x=K$k.renderObj,K$r=K$S.renderObj;K$E=!(65535<K$x._getVertexBuffer().vertexCount+K$r._getVertexBuffer().vertexCount)&&(K$_=this._getStaticBatch(K$c,K$q,K$P,K$b),(K$Z=K$k._staticBatch)!==K$_&&(K$Z&&K$Z._deleteCombineBatchRenderObj(K$k),K$_._addCombineBatchRenderObj(K$k)),(K$Z=K$S._staticBatch)!==K$_&&(K$Z&&K$Z._deleteCombineBatchRenderObj(K$S),K$_._addCombineBatchRenderObj(K$S)),!0)}else K$E=!1,K$b=0;K$P=K$S._material,K$q=K$n.vertexDeclaration}},K$g._sortPrepareStaticBatch=function(K$c,K$P){var K$q=K$c._render,K$_=K$P._render,K$E=K$q.lightmapIndex-K$_.lightmapIndex;if(0!=K$E)return K$E;var K$b=K$q.receiveShadow-K$_.receiveShadow;if(0!=K$b)return K$b;var K$e=K$c._mainSortID-K$P._mainSortID;return 0==K$e?K$c.renderObj.triangleCount-K$P.renderObj.triangleCount:K$e},K$g}(),K$uP=function(K$c){function K$b(K$c,K$P,K$q,K$_,K$E){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,K$b.__super.call(this,K$c,K$P,K$q),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=K$_,this._material=K$E}K$r(K$b,"laya.d3.graphics.SubMeshStaticBatch",K$Ec);var K$P=K$b.prototype;return K$P._compareBatchRenderElement=function(K$c,K$P){return K$c._batchIndexStart>K$P._batchIndexStart},K$P._addCombineBatchRenderObjTest=function(K$c){var K$P=K$c.renderObj._vertexCount;return!(65535<(0<K$P?this._currentCombineVertexCount+K$P:this._currentCombineVertexCount+K$c.renderObj._getVertexBuffer().vertexCount))},K$P._addCombineBatchRenderObj=function(K$c){var K$P=K$c.renderObj,K$q=K$P._vertexCount;this._initBatchRenderElements.push(K$c),K$c._staticBatch=this,0<K$q?(this._currentCombineIndexCount+=K$P._indexCount,this._currentCombineVertexCount+=K$q):(this._currentCombineIndexCount=this._currentCombineIndexCount+K$P._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+K$P._getVertexBuffer().vertexCount),this._needFinishCombine=!0},K$P._deleteCombineBatchRenderObj=function(K$c){var K$P=K$c.renderObj,K$q=this._initBatchRenderElements.indexOf(K$c);if(-1!==K$q){this._initBatchRenderElements.splice(K$q,1),K$c._staticBatch=null;var K$_=K$P._vertexCount;0<K$_?(this._currentCombineIndexCount=this._currentCombineIndexCount-K$P._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-K$_):(this._currentCombineIndexCount=this._currentCombineIndexCount-K$P._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-K$P._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},K$P._finishInit=function(){if(this._needFinishCombine){var K$c=0,K$P=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var K$q=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),K$_=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=K$sP.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=K$YP.create("ushort",this._currentCombineIndexCount,35044);for(var K$E=0,K$b=this._initBatchRenderElements.length;K$E<K$b;K$E++){var K$e=this._initBatchRenderElements[K$E],K$h=K$e.renderObj,K$Z=K$h._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,K$e._sprite3D),K$S=K$h.getIndices(),K$n=K$e._sprite3D.transform._isFrontFaceInvert,K$k=K$c/(this._vertexDeclaration.vertexStride/4)-K$h._vertexStart,K$x=K$P,K$r=K$x+K$S.length;K$e._batchIndexStart=K$x,K$e._batchIndexEnd=K$r,K$_.set(K$S,K$P);var K$g=0;if(K$n)for(K$g=K$x;K$g<K$r;K$g+=3){K$_[K$g]=K$k+K$_[K$g];var K$W=K$_[K$g+1],K$w=K$_[K$g+2];K$_[K$g+1]=K$k+K$w,K$_[K$g+2]=K$k+K$W}else for(K$g=K$x;K$g<K$r;K$g+=3)K$_[K$g]=K$k+K$_[K$g],K$_[K$g+1]=K$k+K$_[K$g+1],K$_[K$g+2]=K$k+K$_[K$g+2];K$P+=K$S.length,K$q.set(K$Z,K$c),K$c+=K$Z.length}this._vertexBuffer.setData(K$q),this._indexBuffer.setData(K$_),this._needFinishCombine=!1}},K$P._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new K$HP)},K$P._getRenderElement=function(K$c,K$P,K$q){for(var K$_,K$E,K$b=this._batchRenderElements.length,K$e=!0,K$h=0;K$h<K$b;K$h++){var K$Z,K$S,K$n=(K$E=this._batchRenderElements[K$h])._sprite3D._render;if(0!==K$h&&(K$e=(K$Z=(K$_=this._batchRenderElements[K$h-1])._sprite3D._render).lightmapIndex!==K$n.lightmapIndex||K$Z.receiveShadow!==K$n.receiveShadow||K$_._batchIndexEnd!==K$E._batchIndexStart),K$e){(K$S=this._getCombineRenderElementFromPool()).renderObj=this,K$S._material=this._material,K$S._batchIndexStart=K$E._batchIndexStart,K$S._batchIndexEnd=K$E._batchIndexEnd;var K$k=K$n.lightmapIndex,K$x=K$k+1,K$r=this._batchOwnerIndices[K$x];K$r||(K$r=this._batchOwnerIndices[K$x]=[]);var K$g,K$W=K$r[K$E._render.receiveShadow?1:0];void 0===K$W?(K$r[K$n.receiveShadow?1:0]=this._batchOwners.length,(K$g=new K$lP(null,"StaticBatchMeshSprite3D"))._scene=K$P,K$g._transform=this._rootOwner?this._rootOwner._transform:null,K$g._render.lightmapIndex=K$k,K$g._render.receiveShadow=K$E._render.receiveShadow,this._batchOwners.push(K$g)):K$g=this._batchOwners[K$W],K$g._render._renderUpdate(K$q),K$S._sprite3D=K$g,K$c.push(K$S)}else K$S._batchIndexEnd=K$E._batchIndexEnd}},K$P._beforeRender=function(K$c){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},K$P._render=function(K$c){var K$P=K$c.renderElement,K$q=K$P._batchIndexStart,K$_=K$P._batchIndexEnd-K$q;K$j.mainContext.drawElements(4,K$_,5123,2*K$q),K$Q.drawCall++,K$Q.trianglesFaces+=K$_/3},K$P.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},K$P._getVertexBuffer=function(K$c){return void 0===K$c&&(K$c=0),this._vertexBuffer},K$b}(),K$AP=function(K$c){function K$P(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,K$P.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}K$r(K$P,"laya.d3.core.ComponentNode",K$S);var K$q=K$P.prototype;return K$q.addComponent=function(K$c){var K$P,K$q=this._componentsMap.indexOf(K$c);if(-1===K$q)K$P=[],this._componentsMap.push(K$c),this._typeComponentsIndices.push(K$P);else if(K$P=this._typeComponentsIndices[K$q],this._components[K$P[0]].isSingleton)throw new Error("无法单实例创建"+K$c+"组件，"+K$c+"组件已存在！");var K$_=K$E.getInstance(K$c);return K$P.push(this._components.length),this._components.push(K$_),K$_ instanceof laya.d3.component.Script&&this._scripts.push(K$_),K$_._initialize(this),K$_},K$q._removeComponent=function(K$c,K$P){var K$q=this._typeComponentsIndices[K$c],K$_=K$q[K$P],K$E=this._components[K$_];this._components.splice(K$_,1),K$E instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(K$E),1),K$q.splice(K$P,1),0===K$q.length&&(this._typeComponentsIndices.splice(K$c,1),this._componentsMap.splice(K$c,1));for(var K$b=0,K$e=this._componentsMap.length;K$b<K$e;K$b++)for(var K$h=(K$q=this._typeComponentsIndices[K$b]).length-1;0<=K$h;K$h--){var K$Z=K$q[K$h];if(!(K$_<K$Z))break;K$q[K$h]=--K$Z}K$E._destroy()},K$q.getComponentByType=function(K$c,K$P){void 0===K$P&&(K$P=0);var K$q=this._componentsMap.indexOf(K$c);return-1===K$q?null:this._components[this._typeComponentsIndices[K$q][K$P]]},K$q.getComponentsByType=function(K$c,K$P){var K$q=this._componentsMap.indexOf(K$c);if(-1!==K$q){var K$_=this._typeComponentsIndices[K$q],K$E=K$_.length;K$P.length=K$E;for(var K$b=0;K$b<K$E;K$b++)K$P[K$b]=this._components[K$_[K$b]]}else K$P.length=0},K$q.getComponentByIndex=function(K$c){return this._components[K$c]},K$q.removeComponentByType=function(K$c,K$P){void 0===K$P&&(K$P=0);var K$q=this._componentsMap.indexOf(K$c);-1!==K$q&&this._removeComponent(K$q,K$P)},K$q.removeComponentsByType=function(K$c){var K$P=this._componentsMap.indexOf(K$c);if(-1!==K$P)for(var K$q=this._typeComponentsIndices[K$P],K$_=0,K$E=K$q.length;K$_<K$E;K$q.length<K$E?K$E--:K$_++)this._removeComponent(K$P,K$_)},K$q.removeAllComponent=function(){for(var K$c=0,K$P=this._componentsMap.length;K$c<K$P;this._componentsMap.length<K$P?K$P--:K$c++)this.removeComponentsByType(this._componentsMap[K$c])},K$q._updateComponents=function(K$c){for(var K$P=0,K$q=this._components.length;K$P<K$q;K$P++){var K$_=this._components[K$P];!K$_.started&&(K$_._start(K$c),K$_.started=!0),K$_.enable&&K$_._update(K$c)}},K$q._lateUpdateComponents=function(K$c){for(var K$P=0;K$P<this._components.length;K$P++){var K$q=this._components[K$P];!K$q.started&&(K$q._start(K$c),K$q.started=!0),K$q.enable&&K$q._lateUpdate(K$c)}},K$q._preRenderUpdateComponents=function(K$c){for(var K$P=0;K$P<this._components.length;K$P++){var K$q=this._components[K$P];!K$q.started&&(K$q._start(K$c),K$q.started=!0),K$q.enable&&K$q._preRenderUpdate(K$c)}},K$q._postRenderUpdateComponents=function(K$c){for(var K$P=0;K$P<this._components.length;K$P++){var K$q=this._components[K$P];!K$q.started&&(K$q._start(K$c),K$q.started=!0),K$q.enable&&K$q._postRenderUpdate(K$c)}},K$P}(),K$JP=function(K$_){function K$c(){K$c.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new K$xP,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new K$hP(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}K$r(K$c,"laya.d3.core.material.BaseMaterial",K$_);var K$P=K$c.prototype;return K$D.imps(K$P,{"laya.d3.core.IClone":!0}),K$P._addShaderDefine=function(K$c){this._shaderDefineValue|=K$c},K$P._removeShaderDefine=function(K$c){this._shaderDefineValue&=~K$c},K$P._addDisablePublicShaderDefine=function(K$c){this._disablePublicShaderDefine|=K$c},K$P._removeDisablePublicShaderDefine=function(K$c){this._disablePublicShaderDefine&=~K$c},K$P._setBuffer=function(K$c,K$P){this._shaderValues.setValue(K$c,K$P),this._values[K$c]=K$P},K$P._getBuffer=function(K$c){return this._values[K$c]},K$P._setMatrix4x4=function(K$c,K$P){this._shaderValues.setValue(K$c,K$P?K$P.elements:null),this._values[K$c]=K$P},K$P._getMatrix4x4=function(K$c){return this._values[K$c]},K$P._setInt=function(K$c,K$P){this._shaderValues.setValue(K$c,K$P),this._values[K$c]=K$P},K$P._getInt=function(K$c){return this._values[K$c]},K$P._setNumber=function(K$c,K$P){this._shaderValues.setValue(K$c,K$P),this._values[K$c]=K$P},K$P._getNumber=function(K$c){return this._values[K$c]},K$P._setBool=function(K$c,K$P){this._shaderValues.setValue(K$c,K$P),this._values[K$c]=K$P},K$P._getBool=function(K$c){return this._values[K$c]},K$P._setVector2=function(K$c,K$P){this._shaderValues.setValue(K$c,K$P?K$P.elements:null),this._values[K$c]=K$P},K$P._getVector2=function(K$c){return this._values[K$c]},K$P._setColor=function(K$c,K$P){this._shaderValues.setValue(K$c,K$P?K$P.elements:null),this._values[K$c]=K$P},K$P._getColor=function(K$c){return this._values[K$c]},K$P._setTexture=function(K$c,K$P){var K$q=this._values[K$c];this._values[K$c]=K$P,this._shaderValues.setValue(K$c,K$P),0<this.referenceCount&&(K$q&&K$q._removeReference(),K$P&&K$P._addReference())},K$P._getTexture=function(K$c){return this._values[K$c]},K$P._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},K$P._getShader=function(K$c,K$P,K$q){var K$_=(K$c|K$P)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(K$_,K$q,this._shaderDefineValue),this._shader},K$P._setRenderStateBlendDepth=function(){var K$c=K$j.mainContext;switch(K$V.setDepthMask(K$c,this.depthWrite),0===this.depthTest?K$V.setDepthTest(K$c,!1):(K$V.setDepthTest(K$c,!0),K$V.setDepthFunc(K$c,this.depthTest)),this.blend){case 0:K$V.setBlend(K$c,!1);break;case 1:K$V.setBlend(K$c,!0),K$V.setBlendFunc(K$c,this.srcBlend,this.dstBlend);break;case 2:K$V.setBlend(K$c,!0)}},K$P._setRenderStateFrontFace=function(K$c,K$P){var K$q=K$j.mainContext,K$_=0;switch(this.cull){case 0:K$V.setCullFace(K$q,!1);break;case 1:K$V.setCullFace(K$q,!0),K$_=K$c?K$P&&K$P._isFrontFaceInvert?2305:2304:K$P&&K$P._isFrontFaceInvert?2304:2305,K$V.setFrontFace(K$q,K$_);break;case 2:K$V.setCullFace(K$q,!0),K$_=K$c?K$P&&K$P._isFrontFaceInvert?2304:2305:K$P&&K$P._isFrontFaceInvert?2305:2304,K$V.setFrontFace(K$q,K$_)}},K$P.onAsynLoaded=function(K$c,K$P,K$q){var K$_=K$P[0],K$E=K$P[1];switch(K$_.version){case"LAYAMATERIAL:01":var K$b=0,K$e=0,K$h=K$_.props;for(var K$Z in K$h)switch(K$Z){case"vectors":var K$S=K$h[K$Z];for(K$b=0,K$e=K$S.length;K$b<K$e;K$b++){var K$n=K$S[K$b],K$k=K$n.value;switch(K$k.length){case 2:this[K$n.name]=new K$bP(K$k[0],K$k[1]);break;case 3:this[K$n.name]=new K$eP(K$k[0],K$k[1],K$k[2]);break;case 4:this[K$n.name]=new K$hP(K$k[0],K$k[1],K$k[2],K$k[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var K$x=K$h[K$Z];for(K$b=0,K$e=K$x.length;K$b<K$e;K$b++){var K$r=K$x[K$b],K$g=K$r.path;K$g&&(this[K$r.name]=K$O.getRes(K$E[K$g]))}break;case"defines":var K$W=K$h[K$Z];for(K$b=0,K$e=K$W.length;K$b<K$e;K$b++){var K$w=this._shaderCompile.getMaterialDefineByName(K$W[K$b]);this._addShaderDefine(K$w)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[K$Z]=K$h[K$Z];break;case"renderQueue":switch(K$h[K$Z]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[K$Z]=K$h[K$Z]}break;case"LAYAMATERIAL:02":for(K$Z in K$h=K$_.props)switch(K$Z){case"vectors":for(K$b=0,K$e=(K$S=K$h[K$Z]).length;K$b<K$e;K$b++)switch((K$k=(K$n=K$S[K$b]).value).length){case 2:this[K$n.name]=new K$bP(K$k[0],K$k[1]);break;case 3:this[K$n.name]=new K$eP(K$k[0],K$k[1],K$k[2]);break;case 4:this[K$n.name]=new K$hP(K$k[0],K$k[1],K$k[2],K$k[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(K$b=0,K$e=(K$x=K$h[K$Z]).length;K$b<K$e;K$b++)(K$g=(K$r=K$x[K$b]).path)&&(this[K$r.name]=K$O.getRes(K$E[K$g]));break;case"defines":for(K$b=0,K$e=(K$W=K$h[K$Z]).length;K$b<K$e;K$b++)K$w=this._shaderCompile.getMaterialDefineByName(K$W[K$b]),this._addShaderDefine(K$w);break;default:this[K$Z]=K$h[K$Z]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},K$P._addReference=function(){K$_.prototype._addReference.call(this);for(var K$c=0,K$P=this._values.length;K$c<K$P;K$c++){var K$q=this._values[K$c];K$q&&K$q instanceof laya.d3.resource.BaseTexture&&K$q._addReference()}},K$P._removeReference=function(){K$_.prototype._removeReference.call(this);for(var K$c=0,K$P=this._values.length;K$c<K$P;K$c++){var K$q=this._values[K$c];K$q&&K$q instanceof laya.d3.resource.BaseTexture&&K$q._removeReference()}},K$P.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},K$P.setShaderName=function(K$c){var K$P=K$oP.nameKey.getID(K$c);if(-1===K$P)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=K$QP._preCompileShader[K$P]},K$P.cloneTo=function(K$c){var K$P=K$c;K$P.name=this.name,K$P.cull=this.cull,K$P.blend=this.blend,K$P.srcBlend=this.srcBlend,K$P.dstBlend=this.dstBlend,K$P.srcBlendRGB=this.srcBlendRGB,K$P.dstBlendRGB=this.dstBlendRGB,K$P.srcBlendAlpha=this.srcBlendAlpha,K$P.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(K$P.blendConstColor),K$P.blendEquation=this.blendEquation,K$P.blendEquationRGB=this.blendEquationRGB,K$P.blendEquationAlpha=this.blendEquationAlpha,K$P.depthTest=this.depthTest,K$P.depthWrite=this.depthWrite,K$P.renderQueue=this.renderQueue,K$P._shader=this._shader,K$P._disablePublicShaderDefine=this._disablePublicShaderDefine,K$P._shaderDefineValue=this._shaderDefineValue;var K$q,K$_=0,K$E=K$P._shaderValues;K$P._shaderValues.data.length=this._shaderValues.data.length;var K$b=this._values.length,K$e=K$P._values;for(K$_=0,K$q=K$e.length=K$b;K$_<K$q;K$_++){var K$h=this._values[K$_];if(K$h)if("number"==typeof K$h)K$e[K$_]=K$h,K$E.data[K$_]=K$h;else if("number"==typeof K$h&&Math.floor(K$h)==K$h)K$e[K$_]=K$h,K$E.data[K$_]=K$h;else if("boolean"==typeof K$h)K$e[K$_]=K$h,K$E.data[K$_]=K$h;else if(K$h instanceof laya.d3.math.Vector2){var K$Z=K$e[K$_]||(K$e[K$_]=new K$bP);K$h.cloneTo(K$Z),K$E.data[K$_]=K$Z.elements}else if(K$h instanceof laya.d3.math.Vector3){var K$S=K$e[K$_]||(K$e[K$_]=new K$eP);K$h.cloneTo(K$S),K$E.data[K$_]=K$S.elements}else if(K$h instanceof laya.d3.math.Vector4){var K$n=K$e[K$_]||(K$e[K$_]=new K$hP);K$h.cloneTo(K$n),K$E.data[K$_]=K$n.elements}else if(K$h instanceof laya.d3.math.Matrix4x4){var K$k=K$e[K$_]||(K$e[K$_]=new K$cP);K$h.cloneTo(K$k),K$E.data[K$_]=K$k.elements}else K$h instanceof laya.d3.resource.BaseTexture&&(K$e[K$_]=K$h,K$E.data[K$_]=K$h)}},K$P.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$g(0,K$P,"alphaTestValue",function(){return this._getNumber(0)},function(K$c){this._setNumber(0,K$c)}),K$g(0,K$P,"alphaTest",function(){return this._alphaTest},function(K$c){(this._alphaTest=K$c)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),K$c.__init__=function(){K$c.SHADERDEFINE_ALPHATEST=K$c.shaderDefines.registerDefine("ALPHATEST")},K$c.RENDERQUEUE_OPAQUE=2e3,K$c.RENDERQUEUE_ALPHATEST=2450,K$c.RENDERQUEUE_TRANSPARENT=3e3,K$c.CULL_NONE=0,K$c.CULL_FRONT=1,K$c.CULL_BACK=2,K$c.BLEND_DISABLE=0,K$c.BLEND_ENABLE_ALL=1,K$c.BLEND_ENABLE_SEPERATE=2,K$c.BLENDPARAM_ZERO=0,K$c.BLENDPARAM_ONE=1,K$c.BLENDPARAM_SRC_COLOR=768,K$c.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,K$c.BLENDPARAM_DST_COLOR=774,K$c.BLENDPARAM_ONE_MINUS_DST_COLOR=775,K$c.BLENDPARAM_SRC_ALPHA=770,K$c.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,K$c.BLENDPARAM_DST_ALPHA=772,K$c.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,K$c.BLENDPARAM_SRC_ALPHA_SATURATE=776,K$c.BLENDEQUATION_ADD=0,K$c.BLENDEQUATION_SUBTRACT=1,K$c.BLENDEQUATION_REVERSE_SUBTRACT=2,K$c.DEPTHTEST_OFF=0,K$c.DEPTHTEST_NEVER=512,K$c.DEPTHTEST_LESS=513,K$c.DEPTHTEST_EQUAL=514,K$c.DEPTHTEST_LEQUAL=515,K$c.DEPTHTEST_GREATER=516,K$c.DEPTHTEST_NOTEQUAL=517,K$c.DEPTHTEST_GEQUAL=518,K$c.DEPTHTEST_ALWAYS=519,K$c.SHADERDEFINE_ALPHATEST=1,K$c.ALPHATESTVALUE=0,K$k(K$c,["shaderDefines",function(){return this.shaderDefines=new K$nP}]),K$c}(K$w),K$jP=function(K$c){function K$P(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,K$P.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}K$r(K$P,"laya.d3.resource.BaseTexture",K$w);var K$q=K$P.prototype;return K$g(0,K$q,"width",function(){return this._width}),K$g(0,K$q,"repeat",function(){return this._repeat},function(K$c){if(this._repeat!==K$c&&(this._repeat=K$c,this._source)){var K$P=K$j.mainContext;K$V.bindTexture(K$P,this._type,this._source),K$T.isPOT(this._width,this._height)&&this._repeat?(K$P.texParameteri(this._type,10242,10497),K$P.texParameteri(this._type,10243,10497)):(K$P.texParameteri(this._type,10242,33071),K$P.texParameteri(this._type,10243,33071))}}),K$g(0,K$q,"height",function(){return this._height}),K$g(0,K$q,"magFifter",function(){return this._magFifter},function(K$c){(this._magFifter=K$c)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(K$c)}),K$g(0,K$q,"wrapModeV",function(){return this._wrapModeV}),K$g(0,K$q,"size",function(){return this._size}),K$g(0,K$q,"wrapModeU",function(){return this._wrapModeU}),K$g(0,K$q,"mipmap",function(){return this._mipmap},function(K$c){this._mipmap=K$c,this._mipmap!=K$c&&this._conchTexture&&this._conchTexture.setMipMap(K$c)}),K$g(0,K$q,"minFifter",function(){return this._minFifter},function(K$c){this._minFifter=K$c,this._minFifter!=K$c&&this._conchTexture&&this._conchTexture.setMinFifter(K$c)}),K$g(0,K$q,"format",function(){return this._format}),K$g(0,K$q,"source",function(){return this.activeResource(),this._source}),K$g(0,K$q,"defaulteTexture",function(){return K$yP.grayTexture}),K$P.WARPMODE_REPEAT=0,K$P.WARPMODE_CLAMP=1,K$P}(),K$VP=function(K$c){function K$P(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,K$P.__super.call(this),this._boundingBoxCorners=K$_(8,null)}K$r(K$P,"laya.d3.resource.models.BaseMesh",K$w);var K$q=K$P.prototype;return K$q._getPositions=function(){throw new Error("未Override,请重载该属性！")},K$q._generateBoundingObject=function(){this._boundingSphere=new K$ic(new K$eP,0),K$ic.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new K$Bc(new K$eP,new K$eP),K$Bc.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},K$q.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},K$q.getRenderElement=function(K$c){throw new Error("未Override,请重载该属性！")},K$g(0,K$q,"subMeshCount",function(){return this._subMeshCount}),K$g(0,K$q,"boundingBox",function(){return this._boundingBox}),K$g(0,K$q,"boundingBoxCorners",function(){return this._boundingBoxCorners}),K$g(0,K$q,"boundingSphere",function(){return this._boundingSphere}),K$P}(),K$RP=(function(K$c){function K$P(){K$P.__super.call(this)}K$r(K$P,"laya.d3.component.Script",K$mP);var K$q=K$P.prototype;K$q.onTriggerEnter=function(K$c){},K$q.onTriggerExit=function(K$c){},K$q.onTriggerStay=function(K$c){},K$g(0,K$q,"isSingleton",function(){return K$P._isSingleton}),K$P._isSingleton=!1}(),function(K$c){function K$P(K$c){this._owner=null,this._sharedMesh=null,K$P.__super.call(this),this._owner=K$c}K$r(K$P,"laya.d3.core.MeshFilter",K$c);var K$q=K$P.prototype;return K$q._sharedMeshLoaded=function(){this.event("loaded")},K$q._destroy=function(){K$c.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},K$g(0,K$q,"sharedMesh",function(){return this._sharedMesh},function(K$c){var K$P=this._sharedMesh;K$P&&K$P._removeReference(),(this._sharedMesh=K$c)._addReference(),this.event("meshchanged",[this,K$P,K$c]),K$c.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),K$g(0,K$q,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),K$g(0,K$q,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),K$g(0,K$q,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),K$g(0,K$q,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),K$P}(K$TP)),K$$P=function(K$c){function K$P(K$c){K$P.__super.call(this,K$c),K$c.meshFilter.on("meshchanged",this,this._onMeshChanged)}K$r(K$P,"laya.d3.core.MeshRender",K$DP);var K$q=K$P.prototype;return K$q._onMeshChanged=function(K$c,K$P,K$q){K$q.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:K$q.once("loaded",this,this._onMeshLoaed)},K$q._onMeshLoaed=function(K$c,K$P){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},K$q._calculateBoundingSphereByInitSphere=function(K$c){var K$P=NaN,K$q=this._owner.transform,K$_=K$q.scale.elements,K$E=Math.abs(K$_[0]),K$b=Math.abs(K$_[1]),K$e=Math.abs(K$_[2]);K$P=K$b<=K$E&&K$e<=K$E?K$E:K$e<=K$b?K$b:K$e,K$eP.transformCoordinate(K$c.center,K$q.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=K$c.radius*K$P},K$q._calculateBoundBoxByInitCorners=function(K$c){for(var K$P=this._owner.transform.worldMatrix,K$q=0;K$q<8;K$q++)K$eP.transformCoordinate(K$c[K$q],K$P,K$DP._tempBoundBoxCorners[K$q]);K$Bc.createfromPoints(K$DP._tempBoundBoxCorners,this._boundingBox)},K$q._calculateBoundingSphere=function(){var K$c=this._owner.meshFilter.sharedMesh;null==K$c||null==K$c.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(K$c.boundingSphere)},K$q._calculateBoundingBox=function(){var K$c=this._owner.meshFilter.sharedMesh;null==K$c||null==K$c.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(K$c.boundingBoxCorners)},K$q._renderUpdate=function(K$c){var K$P=this._owner.transform;if(K$P){this._setShaderValueMatrix4x4(0,K$P.worldMatrix);var K$q=this._owner.getProjectionViewWorldMatrix(K$c);this._setShaderValueMatrix4x4(1,K$q)}else this._setShaderValueMatrix4x4(0,K$cP.DEFAULT),this._setShaderValueMatrix4x4(1,K$c);return K$OP.debugMode&&this._renderRenderableBoundBox(),!0},K$P}(),K$CP=function(K$P){function K$_(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,K$_.__super.call(this),this._renderState=new K$t,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new K$xP,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new K$Pc,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new K$eP(.7,.7,.7),this.ambientColor=new K$eP(.212,.227,.259),K$j.shaderHighPrecision&&this.addShaderDefine(K$QP.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}K$r(K$_,"laya.d3.core.scene.Scene",K$P);var K$c=K$_.prototype;return K$D.imps(K$c,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),K$c._setUrl=function(K$c){this._url=K$c},K$c._getGroup=function(){return this._group},K$c._setGroup=function(K$c){this._group=K$c},K$c._display=function(){K$D.stage._scenes.push(this),K$D.stage._scenes.sort(K$_._sortScenes);for(var K$c=0,K$P=this._childs.length;K$c<K$P;K$c++){var K$q=this._childs[K$c];K$q.active&&K$q._activeHierarchy()}},K$c._unDisplay=function(){var K$c=K$D.stage._scenes;K$c.splice(K$c.indexOf(this),1);for(var K$P=0,K$q=this._childs.length;K$P<K$q;K$P++){var K$_=this._childs[K$P];K$_.active&&K$_._inActiveHierarchy()}},K$c._addChild3D=function(K$c){K$c.transform._onWorldTransform(),K$c._setBelongScene(this),this.displayedInStage&&K$c.active&&K$c._activeHierarchy()},K$c._removeChild3D=function(K$c){K$c.transform.parent=null,this.displayedInStage&&K$c.active&&K$c._inActiveHierarchy(),K$c._setUnBelongScene()},K$c.initOctree=function(K$c,K$P,K$q,K$_,K$E){void 0===K$E&&(K$E=6),this.treeSize=new K$eP(K$c,K$P,K$q),this.treeLevel=K$E,this.treeRoot=new K$B(this,0),this.treeRoot.init(K$_,this.treeSize)},K$c._prepareUpdateToRenderState=function(K$c,K$P){K$P.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,K$P.scene=this},K$c._prepareSceneToRender=function(K$c){var K$P=this._lights.length;if(0<K$P)for(var K$q=0,K$_=0;K$_<K$P&&!(this._lights[K$_]._prepareToScene(K$c)&&++K$q>=this._enableLightCount);K$_++);},K$c._updateChilds=function(K$c){for(var K$P=0,K$q=this._childs.length;K$P<K$q;++K$P)this._childs[K$P]._update(K$c)},K$c._preRenderScene=function(K$c,K$P,K$q){var K$_,K$E=K$P._viewMatrix,K$b=K$P._projectionMatrix,K$e=K$P._projectionViewMatrix,K$h=0,K$Z=K$P.camera;for(K$Z.useOcclusionCulling?this.treeRoot?K$qc.renderObjectCullingOctree(K$q,this,K$Z,K$E,K$b,K$e):K$qc.renderObjectCulling(K$q,this,K$Z,K$E,K$b,K$e):K$qc.renderObjectCullingNoBoundFrustum(this,K$Z,K$E,K$b,K$e),K$h=0,K$_=this._quenes.length;K$h<K$_;K$h++)this._quenes[K$h]&&this._quenes[K$h]._preRender(K$P)},K$c._clear=function(K$c,K$P){var K$q=K$P._viewport,K$_=K$P.camera,K$E=K$q.x,K$b=K$_.renderTargetSize.height-K$q.y-K$q.height,K$e=K$q.width,K$h=K$q.height;K$c.viewport(K$E,K$b,K$e,K$h);var K$Z=256,K$S=K$_.renderTarget;switch(K$_.clearFlag){case 0:var K$n=K$_.clearColor;if(K$n){K$c.enable(3089),K$c.scissor(K$E,K$b,K$e,K$h);var K$k=K$n.elements;K$c.clearColor(K$k[0],K$k[1],K$k[2],K$k[3]),K$Z|=16384}if(K$S)switch(K$n||(K$Z=16384),K$S.depthStencilFormat){case 33189:K$Z|=256;break;case 36168:K$Z|=1024;break;case 34041:K$Z|=256,K$Z|=1024}K$c.clear(K$Z),K$n&&K$c.disable(3089);break;case 1:case 2:if(K$S)switch(K$Z=16384,K$S.depthStencilFormat){case 33189:K$Z|=256;break;case 36168:K$Z|=1024;break;case 34041:K$Z|=256,K$Z|=1024}K$c.clear(K$Z);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},K$c._renderScene=function(K$c,K$P){var K$q,K$_,K$E=K$P.camera,K$b=0;for(K$b=0;K$b<2;K$b++)(K$_=this._quenes[K$b])&&(K$E.renderTarget?K$_._render(K$P,!0):K$_._render(K$P,!1));if(1===K$E.clearFlag){var K$e=K$E.sky;K$e&&(K$V.setCullFace(K$c,!1),K$V.setDepthFunc(K$c,515),K$V.setDepthMask(K$c,!1),K$e._render(K$P),K$V.setDepthFunc(K$c,513),K$V.setDepthMask(K$c,!0))}for(K$b=2,K$q=this._quenes.length;K$b<K$q;K$b++)(K$_=this._quenes[K$b])&&(K$_._sortAlpha(K$P.camera.transform.position),K$E.renderTarget?K$_._render(K$P,!0):K$_._render(K$P,!1))},K$c._set3DRenderConfig=function(K$c){K$c.disable(3042),K$V._blend=!1,K$c.blendFunc(770,771),K$V._sFactor=770,K$V._dFactor=771,K$c.disable(2929),K$V._depthTest=!1,K$c.enable(2884),K$V._cullFace=!0,K$c.depthMask(1),K$V._depthMask=!0,K$c.frontFace(2304),K$V._frontFace=2304},K$c._set2DRenderConfig=function(K$c){K$V.setBlend(K$c,!0),K$V.setBlendFunc(K$c,1,771),K$V.setDepthTest(K$c,!1),K$V.setCullFace(K$c,!1),K$V.setDepthMask(K$c,!0),K$V.setFrontFace(K$c,2305),K$c.viewport(0,0,K$n.width,K$n.height)},K$c._parseCustomProps=function(K$c,K$P,K$q,K$_){var K$E=K$_.customProps.lightmaps,K$b=K$E.length,K$e=this._lightmaps;K$e.length=K$b;for(var K$h=0;K$h<K$b;K$h++)K$e[K$h]=K$O.getRes(K$P[K$E[K$h].replace(".exr",".png")]);this.setlightmaps(K$e);var K$Z=K$_.customProps.ambientColor;K$Z&&(this.ambientColor=new K$eP(K$Z[0],K$Z[1],K$Z[2]));var K$S=K$_.customProps.fogColor;K$S&&(this.fogColor=new K$eP(K$S[0],K$S[1],K$S[2]))},K$c._addLight=function(K$c){this._lights.indexOf(K$c)<0&&this._lights.push(K$c)},K$c._removeLight=function(K$c){var K$P=this._lights.indexOf(K$c);0<=K$P&&this._lights.splice(K$P,1)},K$c._updateScene=function(){var K$c=this._renderState;this._prepareUpdateToRenderState(K$j.mainContext,K$c),this._updateComponents(K$c),this._updateChilds(K$c),this._lateUpdateComponents(K$c),this._time+=K$c.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},K$c._updateSceneConch=function(){var K$c=this._renderState;this._prepareUpdateToRenderState(K$j.mainContext,K$c),this._updateComponents(K$c),this._lateUpdateComponents(K$c),this._prepareSceneToRender(K$c);for(var K$P=0,K$q=this._cameraPool.length;K$P<K$q;K$P++){var K$_=this._cameraPool[K$P];(K$c.camera=K$_)._prepareCameraToRender()}},K$c._preRenderShadow=function(K$c,K$P,K$q,K$_,K$E){this.treeRoot?K$qc.renderShadowObjectCullingOctree(this,K$P,K$q,K$_,K$E):K$qc.renderShadowObjectCulling(this,K$P,K$q,K$_,K$E);for(var K$b=0,K$e=K$q.length;K$b<K$e;K$b++)K$q[K$b]&&K$q[K$b]._preRender(K$c)},K$c._renderShadowMap=function(K$c,K$P,K$q){var K$_=this.parallelSplitShadowMaps[0];K$_._calcAllLightCameraInfo(K$q);var K$E,K$b,K$e,K$h=K$_.PSSMNum;if(this._preRenderShadow(K$P,K$_._lightCulling,K$_._shadowQuenes,K$_._lightVPMatrix[0],K$h),this.addShaderDefine(K$rP.SHADERDEFINE_CAST_SHADOW),1<K$h)for(var K$Z=0;K$Z<K$h;K$Z++)K$E=K$_.getRenderTarget(K$Z+1),K$_.beginRenderTarget(K$Z+1),K$c.clearColor(1,1,1,1),K$c.clear(16640),K$c.viewport(0,0,K$E.width,K$E.height),K$P.camera=K$e=K$_.getLightCamera(K$Z),K$e._prepareCameraToRender(),K$e._prepareCameraViewProject(K$e.viewMatrix,K$e.projectionMatrix),K$P._projectionViewMatrix=K$_._lightVPMatrix[K$Z+1],(K$b=K$_._shadowQuenes[K$Z])._preRender(K$P),K$b._renderShadow(K$P,!1),K$_.endRenderTarget(K$Z+1);else K$E=K$_.getRenderTarget(1),K$_.beginRenderTarget(1),K$c.clearColor(1,1,1,1),K$c.clear(16640),K$c.viewport(0,0,K$E.width,K$E.height),K$P.camera=K$e=K$_.getLightCamera(0),K$e._prepareCameraToRender(),K$e._prepareCameraViewProject(K$e.viewMatrix,K$e.projectionMatrix),K$P._projectionViewMatrix=K$_._lightVPMatrix[0],(K$b=K$_._shadowQuenes[0])._preRender(K$P),K$b._renderShadow(K$P,!0),K$_.endRenderTarget(1);this.removeShaderDefine(K$rP.SHADERDEFINE_CAST_SHADOW)},K$c.addTreeNode=function(K$c){this.treeRoot.addTreeNode(K$c)},K$c.removeTreeNode=function(K$c){this.treeSize&&K$c._treeNode&&K$c._treeNode.removeObject(K$c)},K$c.setlightmaps=function(K$c){this._lightmaps=K$c;for(var K$P=0,K$q=this._renderableSprite3Ds.length;K$P<K$q;K$P++)this._renderableSprite3Ds[K$P]._render._applyLightMapParams()},K$c.getlightmaps=function(){return this._lightmaps},K$c.addChildAt=function(K$c,K$P){if(!(K$c instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(K$c&&K$c.__className));if(!K$c||this.destroyed||K$c===this)return K$c;if(K$c.zOrder&&this._set$P("hasZorder",!0),0<=K$P&&K$P<=this._childs.length){if(K$c._parent===this){var K$q=this.getChildIndex(K$c);this._childs.splice(K$q,1),this._childs.splice(K$P,0,K$c),this.conchModel&&(this.conchModel.removeChild(K$c.conchModel),this.conchModel.addChildAt(K$c.conchModel,K$P)),this._childChanged()}else K$c.parent&&K$c.parent.removeChild(K$c),this._childs===K$S.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(K$P,0,K$c),this.conchModel&&this.conchModel.addChildAt(K$c.conchModel,K$P),(K$c.parent=this)._addChild3D(K$c);return K$c}throw new Error("appendChildAt:The index is out of bounds")},K$c.addChild=function(K$c){if(!(K$c instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!K$c||this.destroyed||K$c===this)return K$c;if(K$c.zOrder&&this._set$P("hasZorder",!0),K$c._parent===this){var K$P=this.getChildIndex(K$c);K$P!==this._childs.length-1&&(this._childs.splice(K$P,1),this._childs.push(K$c),this.conchModel&&(this.conchModel.removeChild(K$c.conchModel),this.conchModel.addChildAt(K$c.conchModel,this._childs.length-1)),this._childChanged())}else K$c.parent&&K$c.parent.removeChild(K$c),this._childs===K$S.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(K$c),this.conchModel&&this.conchModel.addChildAt(K$c.conchModel,this._childs.length-1),(K$c.parent=this)._childChanged(),this._addChild3D(K$c);return K$c},K$c.removeChildAt=function(K$c){var K$P=this.getChildAt(K$c);return K$P&&(this._removeChild3D(K$P),this._childs.splice(K$c,1),this.conchModel&&this.conchModel.removeChild(K$P.conchModel),K$P.parent=null),K$P},K$c.removeChildren=function(K$c,K$P){if(void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=2147483647),this._childs&&0<this._childs.length){var K$q=this._childs;if(0===K$c&&K$b<=K$P){var K$_=K$q;this._childs=K$S.ARRAY_EMPTY}else K$_=K$q.splice(K$c,K$P-K$c);for(var K$E=0,K$b=K$_.length;K$E<K$b;K$E++)this._removeChild3D(K$_[K$E]),K$_[K$E].parent=null,this.conchModel&&this.conchModel.removeChild(K$_[K$E].conchModel)}return this},K$c.addFrustumCullingObject=function(K$c){this.treeRoot?this.addTreeNode(K$c):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(K$c):this._cullingRenders[this._cullingRendersLength]=K$c,K$c._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},K$c.removeFrustumCullingObject=function(K$c){if(this.treeRoot)this.removeTreeNode(K$c);else{this._cullingRendersLength--;var K$P=K$c._indexInSceneFrustumCullingObjects;if(K$P!==this._cullingRendersLength){var K$q=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[K$P]=K$q)._indexInSceneFrustumCullingObjects=K$P,K$c._indexInSceneFrustumCullingObjects=-1}}},K$c.getRenderQueue=function(K$c){return K$c<3e3?this._quenes[1]||(this._quenes[1]=new K$l(this)):this._quenes[2]||(this._quenes[2]=new K$l(this))},K$c.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new K$l(this)},K$c.addShaderDefine=function(K$c){this._shaderDefineValue|=K$c},K$c.removeShaderDefine=function(K$c){this._shaderDefineValue&=~K$c},K$c.addScript=function(K$c){return this._addComponent(K$c)},K$c.getScriptByType=function(K$c,K$P){return void 0===K$P&&(K$P=0),this._getComponentByType(K$c,K$P)},K$c.getScriptsByType=function(K$c,K$P){this._getComponentsByType(K$c,K$P)},K$c.getScriptByIndex=function(K$c){return this._getComponentByIndex(K$c)},K$c.removeScriptByType=function(K$c,K$P){void 0===K$P&&(K$P=0),this._removeComponentByType(K$c,K$P)},K$c.removeScriptsByType=function(K$c){this._removeComponentByType(K$c)},K$c.removeAllScript=function(){this._removeAllComponent()},K$c.render=function(K$c,K$P,K$q){(K$W._context.ctx._renderKey=0)<this._childs.length&&K$c.addRenderObject(this)},K$c.renderSubmit=function(){var K$c=K$j.mainContext,K$P=this._renderState;this._set3DRenderConfig(K$c),this._prepareSceneToRender(this._renderState);var K$q,K$_=0,K$E=0;if(K$OP.debugMode||K$B.debugMode)for(K$_=0,K$E=this._cameraPool.length;K$_<K$E;K$_++)K$q=this._cameraPool[K$_],K$OP._debugPhasorSprite.begin(1,K$q),K$q.activeInHierarchy&&K$q._renderCamera(K$c,K$P,this),K$OP._debugPhasorSprite.end();else for(K$_=0,K$E=this._cameraPool.length;K$_<K$E;K$_++)(K$q=this._cameraPool[K$_]).activeInHierarchy&&K$q._renderCamera(K$c,K$P,this);return this._set2DRenderConfig(K$c),1},K$c.onAsynLoaded=function(K$c,K$P,K$q){var K$_=K$P[0];if("Scene"!==K$_.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var K$E=K$P[1];K$wP._createNodeByJson(this,K$_,this,K$E),this.event("hierarchyloaded",[this]),this.__loaded=!0},K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),this.destroyed||(K$P.prototype.destroy.call(this,K$c),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,K$O.clearRes(this.url),this.loaded||K$OP._cancelLoadByUrl(this.url))},K$c.getRenderType=function(){return 0},K$c.releaseRender=function(){},K$c._addComponent=function(K$c){var K$P,K$q=this._componentsMap.indexOf(K$c);if(-1===K$q)K$P=[],this._componentsMap.push(K$c),this._typeComponentsIndices.push(K$P);else if(K$P=this._typeComponentsIndices[K$q],this._components[K$P[0]].isSingleton)throw new Error("无法单实例创建"+K$c+"组件，"+K$c+"组件已存在！");var K$_=K$E.getInstance(K$c);K$P.push(this._components.length),this._components.push(K$_);return K$_._initialize(this),K$_},K$c._removeComponent=function(K$c,K$P){var K$q=this._typeComponentsIndices[K$c],K$_=K$q[K$P],K$E=this._components[K$_];this._components.splice(K$_,1),K$q.splice(K$P,1),0===K$q.length&&(this._typeComponentsIndices.splice(K$c,1),this._componentsMap.splice(K$c,1));for(var K$b=0,K$e=this._componentsMap.length;K$b<K$e;K$b++)for(var K$h=(K$q=this._typeComponentsIndices[K$b]).length-1;0<=K$h;K$h--){var K$Z=K$q[K$h];if(!(K$_<K$Z))break;K$q[K$h]=--K$Z}K$E._destroy()},K$c._getComponentByType=function(K$c,K$P){void 0===K$P&&(K$P=0);var K$q=this._componentsMap.indexOf(K$c);return-1===K$q?null:this._components[this._typeComponentsIndices[K$q][K$P]]},K$c._getComponentsByType=function(K$c,K$P){var K$q=this._componentsMap.indexOf(K$c);if(-1!==K$q){var K$_=this._typeComponentsIndices[K$q],K$E=K$_.length;K$P.length=K$E;for(var K$b=0;K$b<K$E;K$b++)K$P[K$b]=this._components[K$_[K$b]]}else K$P.length=0},K$c._getComponentByIndex=function(K$c){return this._components[K$c]},K$c._removeComponentByType=function(K$c,K$P){void 0===K$P&&(K$P=0);var K$q=this._componentsMap.indexOf(K$c);-1!==K$q&&this._removeComponent(K$q,K$P)},K$c._removeComponentsByType=function(K$c){var K$P=this._componentsMap.indexOf(K$c);if(-1!==K$P)for(var K$q=this._typeComponentsIndices[K$P],K$_=0,K$E=K$q.length;K$_<K$E;K$q.length<K$E?K$E--:K$_++)this._removeComponent(K$P,K$_)},K$c._removeAllComponent=function(){for(var K$c=0,K$P=this._componentsMap.length;K$c<K$P;this._componentsMap.length<K$P?K$P--:K$c++)this._removeComponentsByType(this._componentsMap[K$c])},K$c._updateComponents=function(K$c){for(var K$P=0,K$q=this._components.length;K$P<K$q;K$P++){var K$_=this._components[K$P];!K$_.started&&(K$_._start(K$c),K$_.started=!0),K$_.enable&&K$_._update(K$c)}},K$c._lateUpdateComponents=function(K$c){for(var K$P=0;K$P<this._components.length;K$P++){var K$q=this._components[K$P];!K$q.started&&(K$q._start(K$c),K$q.started=!0),K$q.enable&&K$q._lateUpdate(K$c)}},K$c._preRenderUpdateComponents=function(K$c){for(var K$P=0;K$P<this._components.length;K$P++){var K$q=this._components[K$P];!K$q.started&&(K$q._start(K$c),K$q.started=!0),K$q.enable&&K$q._preRenderUpdate(K$c)}},K$c._postRenderUpdateComponents=function(K$c){for(var K$P=0;K$P<this._components.length;K$P++){var K$q=this._components[K$P];!K$q.started&&(K$q._start(K$c),K$q.started=!0),K$q.enable&&K$q._postRenderUpdate(K$c)}},K$g(0,K$c,"_loaded",null,function(K$c){this.__loaded=K$c}),K$g(0,K$c,"fogColor",function(){return this._fogColor},function(K$c){this._fogColor=K$c,this._shaderValues.setValue(0,K$c.elements)}),K$g(0,K$c,"enableFog",function(){return this._enableFog},function(K$c){this._enableFog!==K$c&&((this._enableFog=K$c)?(this.addShaderDefine(K$QP.SHADERDEFINE_FOG),this.removeShaderDefine(K$QP.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(K$QP.SHADERDEFINE_FOG))}),K$g(0,K$c,"url",function(){return this._url}),K$g(0,K$c,"loaded",function(){return this.__loaded}),K$g(0,K$c,"enableDepthFog",function(){return this._enableDepthFog},function(K$c){this._enableDepthFog!=K$c&&((this._enableDepthFog=K$c)?(this.addShaderDefine(K$QP.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(K$QP.SHADERDEFINE_FOG)):this.removeShaderDefine(K$QP.SAHDERDEFINE_DEPTHFOG))}),K$g(0,K$c,"fogStart",function(){return this._fogStart},function(K$c){this._fogStart=K$c,this._shaderValues.setValue(1,K$c)}),K$g(0,K$c,"fogRange",function(){return this._fogRange},function(K$c){this._fogRange=K$c,this._shaderValues.setValue(2,K$c)}),K$g(0,K$c,"ambientColor",function(){return this._ambientColor},function(K$c){this._ambientColor=K$c,this._shaderValues.setValue(21,K$c.elements)}),K$g(0,K$c,"scene",function(){return this}),K$g(0,K$c,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),K$_._sortScenes=function(K$c,K$P){if(K$c.parent!==K$D.stage||K$P.parent!==K$D.stage)return K$c.parent!==K$D.stage&&K$P.parent!==K$D.stage?K$_._sortScenes(K$c.parent,K$P.parent):K$c.parent===K$D.stage?-1:1;var K$q=K$D.stage._childs;return K$q.indexOf(K$c)-K$q.indexOf(K$P)},K$_.load=function(K$c){return K$D.loader.create(K$c,null,null,K$_)},K$_.FOGCOLOR=0,K$_.FOGSTART=1,K$_.FOGRANGE=2,K$_.LIGHTDIRECTION=3,K$_.LIGHTDIRCOLOR=4,K$_.POINTLIGHTPOS=5,K$_.POINTLIGHTRANGE=6,K$_.POINTLIGHTATTENUATION=7,K$_.POINTLIGHTCOLOR=8,K$_.SPOTLIGHTPOS=9,K$_.SPOTLIGHTDIRECTION=10,K$_.SPOTLIGHTSPOT=11,K$_.SPOTLIGHTRANGE=12,K$_.SPOTLIGHTATTENUATION=13,K$_.SPOTLIGHTCOLOR=14,K$_.SHADOWDISTANCE=15,K$_.SHADOWLIGHTVIEWPROJECT=16,K$_.SHADOWMAPPCFOFFSET=17,K$_.SHADOWMAPTEXTURE1=18,K$_.SHADOWMAPTEXTURE2=19,K$_.SHADOWMAPTEXTURE3=20,K$_.AMBIENTCOLOR=21,K$_.TIME=22,K$_}(K$H),K$FP=function(K$c){function K$P(K$c){K$P.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new K$cP,this._shaderValues=new K$xP,this._colliders=[],this._id=++K$P._uniqueIDCounter,this._transform=new K$LP(this),this.name=K$c||"Sprite3D-"+K$P._nameNumberCounter++,this.layer=K$$.currentCreationLayer,this.active=!0}K$r(K$P,"laya.d3.core.Sprite3D",K$AP);var K$q=K$P.prototype;return K$D.imps(K$q,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),K$q._setUrl=function(K$c){this._url=K$c},K$q._getGroup=function(){return this._group},K$q._setGroup=function(K$c){this._group=K$c},K$q._addChild3D=function(K$c){K$c.transform.parent=this.transform,this._hierarchyAnimator&&(!K$c._hierarchyAnimator&&K$c._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(K$c,!0,[K$c.name])),this._scene&&(K$c._setBelongScene(this._scene),this._activeInHierarchy&&K$c._active&&K$c._activeHierarchy())},K$q._removeChild3D=function(K$c){K$c.transform.parent=null,this._scene&&(this._activeInHierarchy&&K$c._active&&K$c._inActiveHierarchy(),K$c._setUnBelongScene()),this._hierarchyAnimator&&(K$c._hierarchyAnimator==this._hierarchyAnimator&&K$c._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(K$c,!1,[K$c.name]))},K$q._parseBaseCustomProps=function(K$c){var K$P=this.transform.localPosition;K$c.translate?(K$P.fromArray(K$c.translate),K$P.x*=100,K$P.y*=100,K$P.z*=100):K$P.elements.fill(0),this.transform.localPosition=K$P;var K$q=this.transform.localRotation;K$c.rotation?K$q.fromArray(K$c.rotation):K$q.fromArray([0,0,0,-1]),this.transform.localRotation=K$q;var K$_=this.transform.localScale;K$c.scale?K$_.fromArray(K$c.scale):K$_.elements.fill(1),this.transform.localScale=K$_;var K$E=K$c.layer;null!=K$E&&(this.layer=K$$.getLayerByNumber(K$E))},K$q._parseCustomComponent=function(K$c,K$P,K$q){for(var K$_ in K$q){var K$E=K$q[K$_];switch(K$_){case"Animator":var K$b=this.addComponent(Animator);if(K$E.avatarPath)K$b.avatar=K$O.getRes(K$P[K$E.avatarPath]);else{var K$e=K$E.avatar;if(K$e){K$b.avatar=K$O.getRes(K$P[K$e.path]);var K$h=K$e.linkSprites;K$h&&K$c.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[K$b,K$h])}}for(var K$Z=K$E.clipPaths,K$S=K$Z.length,K$n=0;K$n<K$S;K$n++)K$b.addClip(K$O.getRes(K$P[K$Z[K$n]]));K$b.clip=K$O.getRes(K$P[K$Z[0]]);var K$k=K$E.playOnWake;void 0!==K$k&&(K$b.playOnWake=K$k);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var K$x=this.addComponent(SphereCollider);K$x.isTrigger=K$E.isTrigger;var K$r=K$x.center;K$r.fromArray(K$E.center),K$x.center=K$r,K$x.radius=K$E.radius;break;case"BoxCollider":var K$g=this.addComponent(BoxCollider);K$g.isTrigger=K$E.isTrigger,K$g.center.fromArray(K$E.center);var K$W=K$g.size;K$W.fromArray(K$E.size),K$g.size=K$W;break;case"MeshCollider":this.addComponent(MeshCollider)}}},K$q._onRootNodeHierarchyLoaded=function(K$c,K$P){for(var K$q in K$P){for(var K$_=this,K$E=K$P[K$q],K$b=0,K$e=K$E.length;K$b<K$e;K$b++){var K$h=K$E[K$b];if(""===K$h)break;if(!(K$_=K$_.getChildByName(K$h)))break}K$_&&K$c.linkSprite3DToAvatarNode(K$q,K$_)}},K$q._setHierarchyAnimator=function(K$c,K$P){this._changeHierarchyAnimator(K$c);for(var K$q=0,K$_=this._childs.length;K$q<K$_;K$q++){var K$E=this._childs[K$q];K$E._hierarchyAnimator==K$P&&K$E._setHierarchyAnimator(K$c,K$P)}},K$q._clearHierarchyAnimator=function(K$c,K$P){this._changeHierarchyAnimator(K$P);for(var K$q=0,K$_=this._childs.length;K$q<K$_;K$q++){var K$E=this._childs[K$q];K$E._hierarchyAnimator==K$c&&K$E._clearHierarchyAnimator(K$c,K$P)}},K$q._getAnimatorToLinkSprite3D=function(K$c,K$P,K$q){var K$_=this.getComponentByType(Animator);if(K$_&&(K$_.avatar?K$_.avatar._version||K$c._setAnimatorToLinkAvatar(K$_,K$P):K$c._setAnimatorToLinkSprite3DNoAvatar(K$_,K$P,K$q)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){K$q.unshift(this._parent.name);var K$E=this._parent;K$E._hierarchyAnimator&&K$E._getAnimatorToLinkSprite3D(K$c,K$P,K$q)}},K$q._setAnimatorToLinkSprite3DNoAvatar=function(K$c,K$P,K$q){var K$_=0,K$E=0;for(K$_=0,K$E=K$c.getClipCount();K$_<K$E;K$_++)K$c._handleSpriteOwnersBySprite(K$_,K$P,K$q,this);for(K$_=0,K$E=this._childs.length;K$_<K$E;K$_++){var K$b=this._childs[K$_],K$e=K$q.length;K$q.push(K$b.name),K$b._setAnimatorToLinkSprite3DNoAvatar(K$c,K$P,K$q),K$q.splice(K$e,1)}},K$q._changeHierarchyAnimator=function(K$c){this._hierarchyAnimator=K$c},K$q._isLinkSpriteToAnimationNode=function(K$c,K$P,K$q){var K$_=K$c._avatarNodes.indexOf(K$P),K$E=K$c._cacheSpriteToNodesMap;if(K$q)this._transform.dummy=K$P.transform,K$c._cacheNodesToSpriteMap[K$_]=K$E.length,K$E.push(K$_);else{this._transform.dummy=null;var K$b=K$c._cacheNodesToSpriteMap[K$_];K$c._cacheNodesToSpriteMap[K$_]=null,K$E.splice(K$b,1)}},K$q._setBelongScene=function(K$c){this._scene=K$c;for(var K$P=0,K$q=this._childs.length;K$P<K$q;K$P++)this._childs[K$P]._setBelongScene(K$c)},K$q._setUnBelongScene=function(){this._scene=null;for(var K$c=0,K$P=this._childs.length;K$c<K$P;K$c++)this._childs[K$c]._setUnBelongScene()},K$q._activeHierarchy=function(){var K$c=0,K$P=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),K$c=0,K$P=this._colliders.length;K$c<K$P;K$c++)this._layer._addCollider(this._colliders[K$c]);for(this.event("activeinhierarchychanged",!0),K$c=0,K$P=this._childs.length;K$c<K$P;K$c++){var K$q=this._childs[K$c];K$q._active&&K$q._activeHierarchy()}},K$q._inActiveHierarchy=function(){var K$c=0,K$P=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),K$c=0,K$P=this._colliders.length;K$c<K$P;K$c++){var K$q=this._colliders[K$c];K$q._clearCollsionMap(),this._layer._removeCollider(K$q)}for(this.event("activeinhierarchychanged",!1),K$c=0,K$P=this._childs.length;K$c<K$P;K$c++){var K$_=this._childs[K$c];K$_._active&&K$_._inActiveHierarchy()}},K$q.addComponent=function(K$c){var K$P,K$q=this._componentsMap.indexOf(K$c);if(-1===K$q)K$P=[],this._componentsMap.push(K$c),this._typeComponentsIndices.push(K$P);else if(K$P=this._typeComponentsIndices[K$q],this._components[K$P[0]].isSingleton)throw new Error("无法单实例创建"+K$c+"组件，"+K$c+"组件已存在！");var K$_=K$E.getInstance(K$c);return K$P.push(this._components.length),this._components.push(K$_),K$_ instanceof laya.d3.component.Script&&this._scripts.push(K$_),K$_._initialize(this),K$_},K$q._removeComponent=function(K$c,K$P){var K$q,K$_=0,K$E=this._typeComponentsIndices[K$c],K$b=K$E[K$P],K$e=this._components[K$b];for(K$e instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(K$e),1),K$E.splice(K$P,1),0===K$E.length&&(this._typeComponentsIndices.splice(K$c,1),this._componentsMap.splice(K$c,1)),K$_=0,K$q=this._componentsMap.length;K$_<K$q;K$_++)for(var K$h=(K$E=this._typeComponentsIndices[K$_]).length-1;0<=K$h;K$h--){var K$Z=K$E[K$h];if(!(K$b<K$Z))break;K$E[K$h]=--K$Z}K$e._destroy()},K$q._clearSelfRenderObjects=function(){},K$q._addSelfRenderObjects=function(){},K$q._parseCustomProps=function(K$c,K$P,K$q,K$_){},K$q._updateChilds=function(K$c){var K$P=this._childs.length;if(0!==K$P)for(var K$q=0;K$q<K$P;++K$q)this._childs[K$q]._update(K$c)},K$q._getSortID=function(K$c,K$P){return 1e3*K$P.id+K$c._getVertexBuffer().vertexDeclaration.id},K$q._update=function(K$c){(K$c.owner=this)._activeInHierarchy&&(this._updateComponents(K$c),this._lateUpdateComponents(K$c),K$Q.spriteCount++,this._childs.length&&this._updateChilds(K$c))},K$q.getProjectionViewWorldMatrix=function(K$c){return K$cP.multiply(K$c,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},K$q.loadHierarchy=function(K$c){this.addChild(laya.d3.core.Sprite3D.load(K$c))},K$q.addChildAt=function(K$c,K$P){if(!(K$c instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!K$c||this.destroyed||K$c===this)return K$c;if(K$c.zOrder&&this._set$P("hasZorder",!0),0<=K$P&&K$P<=this._childs.length){if(K$c._parent===this){var K$q=this.getChildIndex(K$c);this._childs.splice(K$q,1),this._childs.splice(K$P,0,K$c),this.conchModel&&(this.conchModel.removeChild(K$c.conchModel),this.conchModel.addChildAt(K$c.conchModel,K$P)),this._childChanged()}else K$c.parent&&K$c.parent.removeChild(K$c),this._childs===K$S.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(K$P,0,K$c),this.conchModel&&this.conchModel.addChildAt(K$c.conchModel,K$P),(K$c.parent=this)._addChild3D(K$c);return K$c}throw new Error("appendChildAt:The index is out of bounds")},K$q.addChild=function(K$c){if(!(K$c instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!K$c||this.destroyed||K$c===this)return K$c;if(K$c.zOrder&&this._set$P("hasZorder",!0),K$c._parent===this){var K$P=this.getChildIndex(K$c);K$P!==this._childs.length-1&&(this._childs.splice(K$P,1),this._childs.push(K$c),this.conchModel&&(this.conchModel.removeChild(K$c.conchModel),this.conchModel.addChildAt(K$c.conchModel,this._childs.length-1)),this._childChanged())}else K$c.parent&&K$c.parent.removeChild(K$c),this._childs===K$S.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(K$c),this.conchModel&&this.conchModel.addChildAt(K$c.conchModel,this._childs.length-1),(K$c.parent=this)._childChanged(),this._addChild3D(K$c);return K$c},K$q.removeChildAt=function(K$c){var K$P=this.getChildAt(K$c);return K$P&&(this._removeChild3D(K$P),this._childs.splice(K$c,1),this.conchModel&&this.conchModel.removeChild(K$P.conchModel),K$P.parent=null),K$P},K$q.removeChildren=function(K$c,K$P){if(void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=2147483647),this._childs&&0<this._childs.length){var K$q=this._childs;if(0===K$c&&K$b<=K$P){var K$_=K$q;this._childs=K$S.ARRAY_EMPTY}else K$_=K$q.splice(K$c,K$P-K$c);for(var K$E=0,K$b=K$_.length;K$E<K$b;K$E++)this._removeChild3D(K$_[K$E]),K$_[K$E].parent=null,this.conchModel&&this.conchModel.removeChild(K$_[K$E].conchModel)}return this},K$q.onAsynLoaded=function(K$c,K$P,K$q){var K$_=K$P[0];if("Sprite3D"!==K$_.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var K$E=K$P[1];K$wP._createNodeByJson(this,K$_,this,K$E),this.event("hierarchyloaded",[this]),this.__loaded=!0},K$q.cloneTo=function(K$c){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var K$P=K$c;K$P.name=this.name,K$P._destroyed=this._destroyed,K$P.timer=this.timer,K$P._$P=this._$P,K$P.active=this._active;var K$q=K$P.transform.localPosition;this.transform.localPosition.cloneTo(K$q),K$P.transform.localPosition=K$q;var K$_=K$P.transform.localRotation;this.transform.localRotation.cloneTo(K$_),K$P.transform.localRotation=K$_;var K$E=K$P.transform.localScale;this.transform.localScale.cloneTo(K$E),K$P.transform.localScale=K$E,K$P.isStatic=this.isStatic;var K$b=0,K$e=0;for(K$b=0,K$e=this._componentsMap.length;K$b<K$e;K$b++){var K$h=K$P.addComponent(this._componentsMap[K$b]);this._components[K$b]._cloneTo(K$h)}for(K$b=0,K$e=this._childs.length;K$b<K$e;K$b++)K$P.addChild(this._childs[K$b].clone());var K$Z=K$P.getComponentByType(Animator);if(K$Z){var K$S=K$Z._linkSpritesData;if(K$S)for(var K$n in K$S){for(var K$k=K$S[K$n],K$x=K$P,K$r=0,K$g=K$k.length;K$r<K$g&&(K$x=K$x.getChildByName(K$k[K$r]));K$r++);if(K$x){var K$W=K$Z._avatarNodeMap[K$n];K$x._isLinkSpriteToAnimationNode(K$Z,K$W,!0)}}}},K$q.clone=function(){var K$c=new this.constructor;return this.cloneTo(K$c),K$c},K$q.destroy=function(K$c){if(void 0===K$c&&(K$c=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,K$c);var K$P,K$q=0;for(K$q=0,K$P=this._components.length;K$q<K$P;K$q++)this._components[K$q]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,K$O.clearRes(this.url),this.loaded||K$OP._cancelLoadByUrl(this.url)}},K$q._handleSpriteToAvatar=function(K$c,K$P){K$c._avatarNodes;var K$q=K$c._avatarNodeMap[this.name];K$q&&K$q.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(K$c,K$q,K$P)},K$q._setAnimatorToLinkAvatar=function(K$c,K$P){this._handleSpriteToAvatar(K$c,K$P);for(var K$q=0,K$_=this._childs.length;K$q<K$_;K$q++){this._childs[K$q]._setAnimatorToLinkAvatar(K$c,K$P)}},K$g(0,K$q,"activeInHierarchy",function(){return this._activeInHierarchy}),K$g(0,K$q,"_loaded",null,function(K$c){this.__loaded=K$c}),K$g(0,K$q,"active",function(){return this._active},function(K$c){this._active!==K$c&&(this._active=K$c,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(K$c?this._activeHierarchy():this._inActiveHierarchy()))}),K$g(0,K$q,"componentsCount",function(){return this._components.length}),K$g(0,K$q,"loaded",function(){return this.__loaded}),K$g(0,K$q,"id",function(){return this._id}),K$g(0,K$q,"url",function(){return this._url}),K$g(0,K$q,"layer",function(){return this._layer},function(K$c){if(this._layer!==K$c){if(!K$c)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var K$P=0,K$q=this._colliders.length;if(this._layer)for(K$P=0;K$P<K$q;K$P++)this._layer._removeCollider(this._colliders[K$P]);for(K$P=0;K$P<K$q;K$P++)K$c._addCollider(this._colliders[K$P])}this._layer=K$c,this.event("layerchanged",K$c)}}),K$g(0,K$q,"scene",function(){return this._scene}),K$g(0,K$q,"transform",function(){return this._transform}),K$P.instantiate=function(K$c,K$P,K$q,K$_,K$E){void 0===K$q&&(K$q=!0);var K$b=K$c.clone();K$P&&K$P.addChild(K$b);var K$e=K$b.transform;if(K$q){var K$h=K$e.worldMatrix;K$c.transform.worldMatrix.cloneTo(K$h),K$e.worldMatrix=K$h}else K$_&&(K$e.position=K$_),K$E&&(K$e.rotation=K$E);return K$b},K$P.load=function(K$c){return K$D.loader.create(K$c,null,null,K$P)},K$P.WORLDMATRIX=0,K$P.MVPMATRIX=1,K$P._uniqueIDCounter=0,K$P._nameNumberCounter=0,K$P}(),K$oP=function(K$c){function K$n(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],K$n.__super.call(this),!K$c||!K$P)throw"Shader Error";this._id=++K$n._count,this._vs=K$c,this._ps=K$P,this._attributeMap=K$q,this._sceneUniformMap=K$_,this._cameraUniformMap=K$E,this._spriteUniformMap=K$b,this._materialUniformMap=K$e,this._renderElementUniformMap=K$h,this._precompile=K$Z,this._define=K$S,this._precompile&&K$n.extCompileObj&&K$n.extCompileFunc?K$n.extCompileFunc.call(K$n.extCompileObj,K$c,K$P,K$S):this.recreateResource()}K$r(K$n,"laya.d3.shader.Shader3D",K$q);var K$P=K$n.prototype;return K$P.recreateResource=function(){K$R.now();this._compile(),this.completeCreate(),this.memorySize=0},K$P.disposeResource=function(){K$j.mainContext.deleteShader(this._vshader),K$j.mainContext.deleteShader(this._pshader),K$j.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},K$P._compile=function(){if(!K$j.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var K$c=[this._vs,this._ps],K$P=K$j.mainContext;if(this._program=K$P.createProgram(),this._vshader=K$n._createShader(K$P,K$c[0],35633),this._pshader=K$n._createShader(K$P,K$c[1],35632),K$P.attachShader(this._program,this._vshader),K$P.attachShader(this._program,this._pshader),K$P.linkProgram(this._program),!K$W.isConchApp&&K$QP.debugMode&&!K$P.getProgramParameter(this._program,35714))throw K$P.getProgramInfoLog(this._program);var K$q,K$_=0,K$E=0,K$b=0;for(K$b=K$W.isConchApp?K$P.getProgramParameterEx(this._vs,this._ps,"",35721):K$P.getProgramParameter(this._program,35721),K$_=0;K$_<K$b;K$_++){var K$e=null;K$q={vartype:"attribute",ivartype:0,attrib:K$e=K$W.isConchApp?K$P.getActiveAttribEx(this._vs,this._ps,"",K$_):K$P.getActiveAttrib(this._program,K$_),location:K$P.getAttribLocation(this._program,K$e.name),name:K$e.name,type:K$e.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(K$q)}var K$h=0;for(K$h=K$W.isConchApp?K$P.getProgramParameterEx(this._vs,this._ps,"",35718):K$P.getProgramParameter(this._program,35718),K$_=0;K$_<K$h;K$_++){var K$Z=null;K$Z=K$W.isConchApp?K$P.getActiveUniformEx(this._vs,this._ps,"",K$_):K$P.getActiveUniform(this._program,K$_),0<(K$q={vartype:"uniform",ivartype:1,attrib:K$e,location:K$P.getUniformLocation(this._program,K$Z.name),name:K$Z.name,type:K$Z.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(K$q.name=K$q.name.substr(0,K$q.name.length-3),K$q.isArray=!0,K$q.location=K$P.getUniformLocation(this._program,K$q.name)),this._uniformParams.push(K$q)}for(K$_=0,K$E=this._attributeParams.length;K$_<K$E;K$_++)(K$q=this._attributeParams[K$_]).indexOfParams=K$_,K$q.index=1,K$q.value=[K$q.location,null],K$q.codename=K$q.name,K$q.name=null!=this._attributeMap[K$q.codename]?this._attributeMap[K$q.codename]:K$q.codename,this._attributeParamsMap.push(K$q.name),this._attributeParamsMap.push(K$q),K$q._this=this,K$q.uploadedValue=[],K$q.fun=this._attribute;for(K$_=0,K$E=this._uniformParams.length;K$_<K$E;K$_++)switch((K$q=this._uniformParams[K$_]).indexOfParams=K$_,K$q.index=1,K$q.value=[K$q.location,null],K$q.codename=K$q.name,null!=this._sceneUniformMap[K$q.codename]?(K$q.name=this._sceneUniformMap[K$q.codename],this._sceneUniformParamsMap.push(K$q.name),this._sceneUniformParamsMap.push(K$q)):null!=this._cameraUniformMap[K$q.codename]?(K$q.name=this._cameraUniformMap[K$q.codename],this._cameraUniformParamsMap.push(K$q.name),this._cameraUniformParamsMap.push(K$q)):null!=this._spriteUniformMap[K$q.codename]?(K$q.name=this._spriteUniformMap[K$q.codename],this._spriteUniformParamsMap.push(K$q.name),this._spriteUniformParamsMap.push(K$q)):null!=this._materialUniformMap[K$q.codename]?(K$q.name=this._materialUniformMap[K$q.codename],this._materialUniformParamsMap.push(K$q.name),this._materialUniformParamsMap.push(K$q)):null!=this._renderElementUniformMap[K$q.codename]?(K$q.name=this._renderElementUniformMap[K$q.codename],this._renderElementUniformParamsMap.push(K$q.name),this._renderElementUniformParamsMap.push(K$q)):console.log("Shader:can't find uinform name:"+K$q.codename+" in shader file."),K$q._this=this,K$q.uploadedValue=[],K$q.type){case 5124:K$q.fun=K$q.isArray?this._uniform1iv:this._uniform1i;break;case 5126:K$q.fun=K$q.isArray?this._uniform1fv:this._uniform1f;break;case 35664:K$q.fun=K$q.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:K$q.fun=K$q.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:K$q.fun=K$q.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:K$q.fun=this._uniform_sampler2D;break;case 35680:K$q.fun=this._uniform_samplerCube;break;case 35676:K$q.fun=this._uniformMatrix4fv;break;case 35670:K$q.fun=this._uniform1i;break;case 35674:K$q.fun=this._uinformMatrix2fv;break;case 35675:K$q.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},K$P._attribute=function(K$c,K$P){var K$q=K$j.mainContext,K$_=K$h._enableAtributes,K$E=K$c.location;return K$_[K$E]||K$q.enableVertexAttribArray(K$E),K$q.vertexAttribPointer(K$E,K$P[0],K$P[1],K$P[2],K$P[3],K$P[4]),K$_[K$E]=K$h._bindVertexBuffer,1},K$P._uniform1f=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P?(K$j.mainContext.uniform1f(K$c.location,K$q[0]=K$P),1):0},K$P._uniform1fv=function(K$c,K$P){if(K$P.length<4){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]||K$q[2]!==K$P[2]||K$q[3]!==K$P[3]?(K$j.mainContext.uniform1fv(K$c.location,K$P),K$q[0]=K$P[0],K$q[1]=K$P[1],K$q[2]=K$P[2],K$q[3]=K$P[3],1):0}return K$j.mainContext.uniform1fv(K$c.location,K$P),1},K$P._uniform_vec2=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]?(K$j.mainContext.uniform2f(K$c.location,K$q[0]=K$P[0],K$q[1]=K$P[1]),1):0},K$P._uniform_vec2v=function(K$c,K$P){if(K$P.length<2){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]||K$q[2]!==K$P[2]||K$q[3]!==K$P[3]?(K$j.mainContext.uniform2fv(K$c.location,K$P),K$q[0]=K$P[0],K$q[1]=K$P[1],K$q[2]=K$P[2],K$q[3]=K$P[3],1):0}return K$j.mainContext.uniform2fv(K$c.location,K$P),1},K$P._uniform_vec3=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]||K$q[2]!==K$P[2]?(K$j.mainContext.uniform3f(K$c.location,K$q[0]=K$P[0],K$q[1]=K$P[1],K$q[2]=K$P[2]),1):0},K$P._uniform_vec3v=function(K$c,K$P){return K$j.mainContext.uniform3fv(K$c.location,K$P),1},K$P._uniform_vec4=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]||K$q[2]!==K$P[2]||K$q[3]!==K$P[3]?(K$j.mainContext.uniform4f(K$c.location,K$q[0]=K$P[0],K$q[1]=K$P[1],K$q[2]=K$P[2],K$q[3]=K$P[3]),1):0},K$P._uniform_vec4v=function(K$c,K$P){return K$j.mainContext.uniform4fv(K$c.location,K$P),1},K$P._uniformMatrix2fv=function(K$c,K$P){return K$j.mainContext.uniformMatrix2fv(K$c.location,!1,K$P),1},K$P._uniformMatrix3fv=function(K$c,K$P){return K$j.mainContext.uniformMatrix3fv(K$c.location,!1,K$P),1},K$P._uniformMatrix4fv=function(K$c,K$P){return K$j.mainContext.uniformMatrix4fv(K$c.location,!1,K$P),1},K$P._uinformMatrix2fv=function(K$c,K$P){return K$j.mainContext.uniformMatrix2fv(K$c.location,!1,K$P),1},K$P._uinformMatrix3fv=function(K$c,K$P){return K$j.mainContext.uniformMatrix3fv(K$c.location,!1,K$P),1},K$P._uniform1i=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P?(K$j.mainContext.uniform1i(K$c.location,K$q[0]=K$P),1):0},K$P._uniform1iv=function(K$c,K$P){return K$j.mainContext.uniform1iv(K$c.location,K$P),1},K$P._uniform_ivec2=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]?(K$j.mainContext.uniform2i(K$c.location,K$q[0]=K$P[0],K$q[1]=K$P[1]),1):0},K$P._uniform_ivec2v=function(K$c,K$P){return K$j.mainContext.uniform2iv(K$c.location,K$P),1},K$P._uniform_vec3i=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]||K$q[2]!==K$P[2]?(K$j.mainContext.uniform3i(K$c.location,K$q[0]=K$P[0],K$q[1]=K$P[1],K$q[2]=K$P[2]),1):0},K$P._uniform_vec3vi=function(K$c,K$P){return K$j.mainContext.uniform3iv(K$c.location,K$P),1},K$P._uniform_vec4i=function(K$c,K$P){var K$q=K$c.uploadedValue;return K$q[0]!==K$P[0]||K$q[1]!==K$P[1]||K$q[2]!==K$P[2]||K$q[3]!==K$P[3]?(K$j.mainContext.uniform4i(K$c.location,K$q[0]=K$P[0],K$q[1]=K$P[1],K$q[2]=K$P[2],K$q[3]=K$P[3]),1):0},K$P._uniform_vec4vi=function(K$c,K$P){return K$j.mainContext.uniform4iv(K$c.location,K$P),1},K$P._uniform_sampler2D=function(K$c,K$P){var K$q=K$P.source||K$P.defaulteTexture.source,K$_=K$j.mainContext,K$E=K$c.uploadedValue;if(null!=K$E[0])return K$_.activeTexture(K$n._TEXTURES[K$E[0]]),K$q&&K$V.bindTexture(K$_,3553,K$q),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return K$E[0]=this._curActTexIndex,K$_.uniform1i(K$c.location,this._curActTexIndex),K$_.activeTexture(K$n._TEXTURES[this._curActTexIndex]),K$q&&K$V.bindTexture(K$_,3553,K$q),this._curActTexIndex++,1},K$P._uniform_samplerCube=function(K$c,K$P){var K$q=K$P.source||K$P.defaulteTexture.source,K$_=K$j.mainContext,K$E=K$c.uploadedValue;if(null!=K$E[0])return K$_.activeTexture(K$n._TEXTURES[K$E[0]]),K$q?K$V.bindTexture(K$_,34067,K$q):K$V.bindTexture(K$_,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return K$E[0]=this._curActTexIndex,K$_.uniform1i(K$c.location,this._curActTexIndex),K$_.activeTexture(K$n._TEXTURES[this._curActTexIndex]),K$q?K$V.bindTexture(K$_,34067,K$q):K$V.bindTexture(K$_,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},K$P._noSetValue=function(K$c){console.log("no....:"+K$c.name)},K$P.bind=function(){return K$q.activeShader=this,(K$q.bindShader=this).activeResource(),K$V.UseProgram(this._program)},K$P.uploadAttributes=function(K$c,K$P){for(var K$q,K$_,K$E=0,K$b=0,K$e=this._attributeParamsMap.length;K$b<K$e;K$b+=2)K$_=this._attributeParamsMap[K$b+1],null!=(K$q=K$c[this._attributeParamsMap[K$b]])&&(K$P&&K$P[K$_.name]&&K$P[K$_.name].bind(),K$E+=K$_.fun.call(this,K$_,K$q));K$Q.shaderCall+=K$E},K$P.uploadAttributesX=function(K$c,K$P){for(var K$q,K$_,K$E=0,K$b=0,K$e=this._attributeParamsMap.length;K$b<K$e;K$b+=2)K$_=this._attributeParamsMap[K$b+1],null!=(K$q=K$c[this._attributeParamsMap[K$b]])&&(K$P._bind(),K$E+=K$_.fun.call(this,K$_,K$q));K$Q.shaderCall+=K$E},K$P.uploadSceneUniforms=function(K$c){for(var K$P,K$q,K$_=0,K$E=0,K$b=this._sceneUniformParamsMap.length;K$E<K$b;K$E+=2)K$q=this._sceneUniformParamsMap[K$E+1],null!=(K$P=K$c[this._sceneUniformParamsMap[K$E]])&&(K$_+=K$q.fun.call(this,K$q,K$P));K$Q.shaderCall+=K$_},K$P.uploadCameraUniforms=function(K$c){for(var K$P,K$q,K$_=0,K$E=0,K$b=this._cameraUniformParamsMap.length;K$E<K$b;K$E+=2)K$q=this._cameraUniformParamsMap[K$E+1],null!=(K$P=K$c[this._cameraUniformParamsMap[K$E]])&&(K$_+=K$q.fun.call(this,K$q,K$P));K$Q.shaderCall+=K$_},K$P.uploadSpriteUniforms=function(K$c){for(var K$P,K$q,K$_=0,K$E=0,K$b=this._spriteUniformParamsMap.length;K$E<K$b;K$E+=2)K$q=this._spriteUniformParamsMap[K$E+1],null!=(K$P=K$c[this._spriteUniformParamsMap[K$E]])&&(K$_+=K$q.fun.call(this,K$q,K$P));K$Q.shaderCall+=K$_},K$P.uploadMaterialUniforms=function(K$c){for(var K$P,K$q,K$_=0,K$E=0,K$b=this._materialUniformParamsMap.length;K$E<K$b;K$E+=2)K$q=this._materialUniformParamsMap[K$E+1],null!=(K$P=K$c[this._materialUniformParamsMap[K$E]])&&(K$_+=K$q.fun.call(this,K$q,K$P));K$Q.shaderCall+=K$_},K$P.uploadRenderElementUniforms=function(K$c){for(var K$P,K$q,K$_=0,K$E=0,K$b=this._renderElementUniformParamsMap.length;K$E<K$b;K$E+=2)K$q=this._renderElementUniformParamsMap[K$E+1],null!=(K$P=K$c[this._renderElementUniformParamsMap[K$E]])&&(K$_+=K$q.fun.call(this,K$q,K$P));K$Q.shaderCall+=K$_},K$n.create=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){return new K$n(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S)},K$n.addInclude=function(K$c,K$P){K$m.addInclude(K$c,K$P)},K$n._createShader=function(K$c,K$P,K$q){var K$_=K$c.createShader(K$q);if(K$c.shaderSource(K$_,K$P),K$c.compileShader(K$_),K$QP.debugMode&&!K$c.getShaderParameter(K$_,35713))throw K$c.getShaderInfoLog(K$_);return K$_},K$n.PERIOD_RENDERELEMENT=0,K$n.PERIOD_MATERIAL=1,K$n.PERIOD_SPRITE=2,K$n.PERIOD_CAMERA=3,K$n.PERIOD_SCENE=4,K$n._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],K$n._count=0,K$n._preCompile=!1,K$n.extCompileFunc=null,K$n.extCompileObj=null,K$k(K$n,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new K$d}]),K$n}(),K$aP=function(K$h){function K$Z(){this._transformUV=null,K$Z.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new K$eP(.6,.6,.6)),this._setColor(10,new K$eP(1,1,1)),this._setColor(11,new K$hP(1,1,1,8)),this._setColor(12,new K$eP(1,1,1)),this._setColor(7,new K$hP(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new K$hP(1,1,0,0)),this.renderMode=1}K$r(K$Z,"laya.d3.core.material.StandardMaterial",K$h);var K$c=K$Z.prototype;return K$c.disableLight=function(){this._addDisablePublicShaderDefine(K$QP.SHADERDEFINE_POINTLIGHT|K$QP.SHADERDEFINE_SPOTLIGHT|K$QP.SHADERDEFINE_DIRECTIONLIGHT)},K$c.disableFog=function(){this._addDisablePublicShaderDefine(K$QP.SHADERDEFINE_FOG)},K$c.onAsynLoaded=function(K$c,K$P,K$q){var K$_=K$P[0];if(K$_.version)K$h.prototype.onAsynLoaded.call(this,K$c,K$P,K$q);else{var K$E=K$P[1],K$b=K$_.props;for(var K$e in K$b)this[K$e]=K$b[K$e];K$Z._parseStandardMaterial(K$E,this,K$_),this._endLoaded()}},K$c.cloneTo=function(K$c){K$h.prototype.cloneTo.call(this,K$c);var K$P=K$c;this._transformUV&&(K$P._transformUV=this._transformUV.clone())},K$g(0,K$c,"ambientColor",function(){return this._getColor(9)},function(K$c){this._setColor(9,K$c)}),K$g(0,K$c,"ambientTexture",function(){return this._getTexture(5)},function(K$c){K$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,K$c)}),K$g(0,K$c,"renderMode",null,function(K$c){switch(K$c){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(K$Z.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(K$c)}),K$g(0,K$c,"reflectColor",function(){return this._getColor(12)},function(K$c){this._setColor(12,K$c)}),K$g(0,K$c,"tilingOffset",function(){return this._getColor(15)},function(K$c){if(K$c){var K$P=K$c.elements;1!=K$P[0]||1!=K$P[1]||0!=K$P[2]||0!=K$P[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,K$c)}),K$g(0,K$c,"albedo",function(){return this._getColor(7)},function(K$c){this._setColor(7,K$c)}),K$g(0,K$c,"diffuseColor",function(){return this._getColor(10)},function(K$c){this._setColor(10,K$c)}),K$g(0,K$c,"albedoColor",function(){return this._getColor(7)},function(K$c){this._setColor(7,K$c)}),K$g(0,K$c,"specularColor",function(){return this._getColor(11)},function(K$c){this._setColor(11,K$c)}),K$g(0,K$c,"diffuseTexture",function(){return this._getTexture(1)},function(K$c){K$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,K$c)}),K$g(0,K$c,"normalTexture",function(){return this._getTexture(2)},function(K$c){K$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,K$c)}),K$g(0,K$c,"specularTexture",function(){return this._getTexture(3)},function(K$c){K$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,K$c)}),K$g(0,K$c,"emissiveTexture",function(){return this._getTexture(4)},function(K$c){K$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,K$c)}),K$g(0,K$c,"reflectTexture",function(){return this._getTexture(6)},function(K$c){K$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,K$c)}),K$g(0,K$c,"transformUV",function(){return this._transformUV},function(K$c){this._transformUV=K$c,this._setMatrix4x4(13,K$c.matrix),K$c?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,K$c.matrix.elements,0)}),K$Z.__init__=function(){K$Z.SHADERDEFINE_DIFFUSEMAP=K$Z.shaderDefines.registerDefine("DIFFUSEMAP"),K$Z.SHADERDEFINE_NORMALMAP=K$Z.shaderDefines.registerDefine("NORMALMAP"),K$Z.SHADERDEFINE_SPECULARMAP=K$Z.shaderDefines.registerDefine("SPECULARMAP"),K$Z.SHADERDEFINE_EMISSIVEMAP=K$Z.shaderDefines.registerDefine("EMISSIVEMAP"),K$Z.SHADERDEFINE_AMBIENTMAP=K$Z.shaderDefines.registerDefine("AMBIENTMAP"),K$Z.SHADERDEFINE_REFLECTMAP=K$Z.shaderDefines.registerDefine("REFLECTMAP"),K$Z.SHADERDEFINE_UVTRANSFORM=K$Z.shaderDefines.registerDefine("UVTRANSFORM"),K$Z.SHADERDEFINE_TILINGOFFSET=K$Z.shaderDefines.registerDefine("TILINGOFFSET"),K$Z.SHADERDEFINE_ADDTIVEFOG=K$Z.shaderDefines.registerDefine("ADDTIVEFOG")},K$Z.load=function(K$c){return K$D.loader.create(K$c,null,null,K$Z)},K$Z._parseStandardMaterial=function(K$c,K$P,K$q){var K$_=K$q.customProps,K$E=K$_.ambientColor;K$P.ambientColor=new K$eP(K$E[0],K$E[1],K$E[2]);var K$b=K$_.diffuseColor;K$P.diffuseColor=new K$eP(K$b[0],K$b[1],K$b[2]);var K$e=K$_.specularColor;K$P.specularColor=new K$hP(K$e[0],K$e[1],K$e[2],K$e[3]);var K$h=K$_.reflectColor;K$P.reflectColor=new K$eP(K$h[0],K$h[1],K$h[2]);var K$Z=K$_.albedoColor;K$Z&&(K$P.albedo=new K$hP(K$Z[0],K$Z[1],K$Z[2],K$Z[3]));var K$S=K$_.diffuseTexture.texture2D;K$S&&(K$P.diffuseTexture=K$O.getRes(K$c[K$S]));var K$n=K$_.normalTexture.texture2D;K$n&&(K$P.normalTexture=K$O.getRes(K$c[K$n]));var K$k=K$_.specularTexture.texture2D;K$k&&(K$P.specularTexture=K$O.getRes(K$c[K$k]));var K$x=K$_.emissiveTexture.texture2D;K$x&&(K$P.emissiveTexture=K$O.getRes(K$c[K$x]));var K$r=K$_.ambientTexture.texture2D;K$r&&(K$P.ambientTexture=K$O.getRes(K$c[K$r]));var K$g=K$_.reflectTexture.texture2D;K$g&&(K$P.reflectTexture=K$O.getRes(K$c[K$g]))},K$Z.RENDERMODE_OPAQUE=1,K$Z.RENDERMODE_OPAQUEDOUBLEFACE=2,K$Z.RENDERMODE_CUTOUT=3,K$Z.RENDERMODE_CUTOUTDOUBLEFACE=4,K$Z.RENDERMODE_TRANSPARENT=13,K$Z.RENDERMODE_TRANSPARENTDOUBLEFACE=14,K$Z.RENDERMODE_ADDTIVE=15,K$Z.RENDERMODE_ADDTIVEDOUBLEFACE=16,K$Z.RENDERMODE_DEPTHREAD_TRANSPARENT=5,K$Z.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,K$Z.RENDERMODE_DEPTHREAD_ADDTIVE=7,K$Z.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,K$Z.RENDERMODE_NONDEPTH_TRANSPARENT=9,K$Z.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,K$Z.RENDERMODE_NONDEPTH_ADDTIVE=11,K$Z.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,K$Z.SHADERDEFINE_DIFFUSEMAP=0,K$Z.SHADERDEFINE_NORMALMAP=0,K$Z.SHADERDEFINE_SPECULARMAP=0,K$Z.SHADERDEFINE_EMISSIVEMAP=0,K$Z.SHADERDEFINE_AMBIENTMAP=0,K$Z.SHADERDEFINE_REFLECTMAP=0,K$Z.SHADERDEFINE_UVTRANSFORM=0,K$Z.SHADERDEFINE_TILINGOFFSET=0,K$Z.SHADERDEFINE_ADDTIVEFOG=0,K$Z.DIFFUSETEXTURE=1,K$Z.NORMALTEXTURE=2,K$Z.SPECULARTEXTURE=3,K$Z.EMISSIVETEXTURE=4,K$Z.AMBIENTTEXTURE=5,K$Z.REFLECTTEXTURE=6,K$Z.ALBEDO=7,K$Z.UVANIAGE=8,K$Z.MATERIALAMBIENT=9,K$Z.MATERIALDIFFUSE=10,K$Z.MATERIALSPECULAR=11,K$Z.MATERIALREFLECT=12,K$Z.UVMATRIX=13,K$Z.UVAGE=14,K$Z.TILINGOFFSET=15,K$k(K$Z,["defaultMaterial",function(){var K$c=new K$Z;return K$c.lock=!0,this.defaultMaterial=K$c},"shaderDefines",function(){return this.shaderDefines=new K$nP(K$JP.shaderDefines)}]),K$Z}(K$JP),K$YP=function(K$c){function K$e(K$c,K$P,K$q,K$_,K$E){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===K$q&&(K$q=35044),void 0===K$_&&(K$_=!1),K$e.__super.call(this),this._indexType=K$c,this._indexCount=K$P,this._bufferUsage=K$q,this._bufferType=34963,this._canRead=K$_;var K$b;if("ushort"==K$c)this._indexTypeByteCount=2;else{if("ubyte"!=K$c)throw new Error("unidentification index type.");this._indexTypeByteCount=1}K$b=this._indexTypeByteCount*K$P,this._byteLength=K$b,this._bind(),K$h._gl.bufferData(this._bufferType,K$b,this._bufferUsage),this.uri=K$E,K$_?("ushort"==K$c?this._buffer=new Uint16Array(K$P):"ubyte"==K$c&&(this._buffer=new Uint8Array(K$P)),this.memorySize=2*K$b):this.memorySize=K$b}K$r(K$e,"laya.d3.graphics.IndexBuffer3D",K$c);var K$P=K$e.prototype;return K$P.setData=function(K$c,K$P,K$q,K$_){void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=4294967295);var K$E=0;if("ushort"==this._indexType?(K$E=2,0===K$q&&4294967295===K$_||(K$c=new Uint16Array(K$c.buffer,K$q*K$E,K$_))):"ubyte"==this._indexType&&(K$E=1,0===K$q&&4294967295===K$_||(K$c=new Uint8Array(K$c.buffer,K$q*K$E,K$_))),this._bind(),K$h._gl.bufferSubData(this._bufferType,K$P*K$E,K$c),this._canRead)if(0!==K$P||0!==K$q||4294967295!==K$_){var K$b=this._buffer.length-K$P;K$b<K$_&&(K$_=K$b);for(var K$e=0;K$e<K$_;K$e++)this._buffer[K$P+K$e]=K$c[K$e]}else this._buffer=K$c},K$P.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},K$P.disposeResource=function(){K$c.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},K$g(0,K$P,"indexType",function(){return this._indexType}),K$g(0,K$P,"indexTypeByteCount",function(){return this._indexTypeByteCount}),K$g(0,K$P,"indexCount",function(){return this._indexCount}),K$g(0,K$P,"canRead",function(){return this._canRead}),K$e.INDEXTYPE_UBYTE="ubyte",K$e.INDEXTYPE_USHORT="ushort",K$e.create=function(K$c,K$P,K$q,K$_,K$E){return void 0===K$q&&(K$q=35044),void 0===K$_&&(K$_=!1),new K$e(K$c,K$P,K$q,K$_,K$E)},K$e}(K$h),K$sP=function(K$b){function K$e(K$c,K$P,K$q,K$_,K$E){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===K$_&&(K$_=!1),K$e.__super.call(this),this._vertexDeclaration=K$c,this._vertexCount=K$P,this._bufferUsage=K$q,this._bufferType=34962,this._canRead=K$_,this.uri=K$E,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*K$P,this._bind(),K$h._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),K$_&&(this._buffer=new Float32Array(this._byteLength/4))}K$r(K$e,"laya.d3.graphics.VertexBuffer3D",K$b);var K$c=K$e.prototype;return K$c.bindWithIndexBuffer=function(K$c){K$c&&K$c._bind(),this._bind()},K$c.setData=function(K$c,K$P,K$q,K$_){if(void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=4294967295),0===K$q&&4294967295===K$_||(K$c=new Float32Array(K$c.buffer,4*K$q,K$_)),this._bind(),K$h._gl.bufferSubData(this._bufferType,4*K$P,K$c),this._canRead)if(0!==K$P||0!==K$q||4294967295!==K$_){var K$E=this._buffer.length-K$P;K$E<K$_&&(K$_=K$E);for(var K$b=0;K$b<K$_;K$b++)this._buffer[K$P+K$b]=K$c[K$b]}else this._buffer=K$c},K$c.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},K$c.disposeResource=function(){for(var K$c=K$j.mainContext,K$P=this._vertexDeclaration.getVertexElements(),K$q=K$h._enableAtributes,K$_=0,K$E=K$P.length;K$_<K$E;K$_++)K$q[K$_]===this._glBuffer&&(K$c.disableVertexAttribArray(K$_),K$q[K$_]=null);K$b.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},K$g(0,K$c,"vertexDeclaration",function(){return this._vertexDeclaration}),K$g(0,K$c,"vertexCount",function(){return this._vertexCount}),K$g(0,K$c,"canRead",function(){return this._canRead}),K$e.create=function(K$c,K$P,K$q,K$_,K$E){return void 0===K$q&&(K$q=35044),void 0===K$_&&(K$_=!1),new K$e(K$c,K$P,K$q,K$_,K$E)},K$e}(K$h),K$UP=function(K$c){function K$m(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,K$m.__super.call(this),this._type=3553}K$r(K$m,"laya.d3.resource.DataTexture2D",K$jP);var K$P=K$m.prototype;return K$P.genDebugMipmaps=function(){var K$c=[];return K$c.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),K$c.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),K$c.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),K$c.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),K$c.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),K$c.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),K$c.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),K$c.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),K$c.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),K$c.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),K$c},K$P._onTextureLoaded=function(K$c){},K$P._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var K$c=K$j.mainContext,K$P=this._source=K$c.createTexture(),K$q=this._width,K$_=this._height,K$E=K$V.curBindTexTarget,K$b=K$V.curBindTexValue,K$e=!1;if(K$V.bindTexture(K$c,this._type,K$P),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var K$h=0;K$c.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var K$Z=0;K$Z<this._mipmaps.length;K$Z++){if(this._mipmaps[K$Z].byteLength!=K$S*K$n*4)throw"mipmap size error  level:"+K$Z;K$c.texSubImage2D(this._type,0,K$m.simLodRect[K$h++],K$m.simLodRect[K$h++],K$m.simLodRect[K$h++],K$m.simLodRect[K$h++],6408,5121,new Uint8Array(this._mipmaps[K$Z]))}this.minFifter=9729,this.magFifter=9729}else{var K$S=this._width,K$n=this._height;for(K$h=0,K$c.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),K$Z=0;K$Z<this._mipmaps.length;K$Z++){if(this._mipmaps[K$Z].byteLength!=K$S*K$n*4)throw"mipmap size error  level:"+K$Z;K$c.texImage2D(this._type,K$Z,6408,K$S,K$n,0,6408,5121,new Uint8Array(this._mipmaps[K$Z])),(K$S/=2)<1&&(K$S=1),(K$n/=2)<1&&(K$n=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&K$c.pixelStorei(K$c.UNPACK_ALIGNMENT,1),K$c.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var K$k=0,K$x=!1,K$r=!1;this._buffer.byteLength==4*K$q*K$_?(K$k=6408,K$x=!0):this._buffer.byteLength==3*K$q*K$_?(K$k=6407,K$r=!0):K$k=this._format,K$x||K$r?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),K$r&&K$c.pixelStorei(K$c.UNPACK_ALIGNMENT,1),K$c.texImage2D(this._type,0,K$k,K$q,K$_,0,K$k,5121,this._buffer)):K$c&&K$k==K$c.ALPHA?(K$c.texImage2D(3553,0,K$k,K$q,K$_,0,K$k,K$c.UNSIGNED_BYTE,this._buffer),K$e=!0):0!=K$k&&(K$c.compressedTexImage2D(3553,0,K$k,K$q,K$_,0,this._buffer),K$e=!0)}var K$g=this._minFifter,K$W=this._magFifter,K$w=0==this._wrapModeU?10497:33071,K$O=0==this._wrapModeV?10497:33071,K$N=K$T.isPOT(K$q,K$_);K$N?(this._mipmap||this._mipmaps?-1!==K$g||(K$g=9987):-1!==K$g||(K$g=9729),-1!==K$W||(K$W=9729),K$c.texParameteri(this._type,10241,K$g),K$c.texParameteri(this._type,10240,K$W),K$c.texParameteri(this._type,10242,K$w),K$c.texParameteri(this._type,10243,K$O),this._mipmap&&K$c.generateMipmap(this._type)):(-1!==K$g||(K$g=9729),-1!==K$W||(K$W=9729),K$c.texParameteri(this._type,10241,K$g),K$c.texParameteri(this._type,10240,K$W),K$c.texParameteri(this._type,10242,33071),K$c.texParameteri(this._type,10243,33071)),K$E&&K$b&&K$V.bindTexture(K$c,K$E,K$b),this.memorySize=K$e?this._buffer.length:K$N?K$q*K$_*4*(1+1/3):K$q*K$_*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},K$P.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},K$P.onAsynLoaded=function(K$c,K$P,K$q){var K$_;K$q&&(K$_=K$q[0].call(this,K$P)),K$_&&(this._width=K$_.width,this._height=K$_.height,this._buffer=K$_.data),this._src=K$c,this._size=new K$WP(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},K$P.getPixels=function(){return new Uint8Array(this._buffer)},K$P.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(K$j.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},K$g(0,K$P,"src",function(){return this._src}),K$m.create=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){if(void 0===K$_&&(K$_=9729),void 0===K$E&&(K$E=9729),void 0===K$b&&(K$b=!0),!K$c||K$c.byteLength<K$P*K$q*4)throw"DataTexture2D create error";var K$h=new K$m;return K$h.uri=K$e,K$h._buffer=K$c,K$h._width=K$P,K$h._height=K$q,K$h._mipmap=K$b,K$h._magFifter=K$_,K$h._minFifter=K$E,K$h._size=new K$WP(K$h._width,K$h._height),K$h._conchTexture?alert("怎么给runtime传递datatexture数据"):K$h.activeResource(),K$h},K$m.load=function(K$c,K$P,K$q,K$_,K$E){if(void 0===K$P&&(K$P=0),void 0===K$q&&(K$q=0),void 0===K$_&&(K$_=9729),void 0===K$E&&(K$E=9729),"mipmaps"===K$u.getFileExtension(K$c)){var K$b=K$D.loader.create(K$c,null,null,K$m,[function(K$c){this._mipmaps=[];var K$P=new Uint32Array(K$c);this._width=K$P[0];var K$q=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,K$q=1024),this._width!=K$q)throw"现在只支持512x256的环境贴图。当前的是"+K$P[0];this._height=K$P[1];for(var K$_=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,K$E=this._height,K$b=8;;){var K$e=K$_*K$E*4;if(K$b+K$e>K$c.byteLength)throw"load mipmaps data size error ";var K$h=new Uint8Array(K$c,K$b,K$e);if(this._mipmaps.push(K$h),K$b+=K$e,1==K$_&&1==K$E)break;(K$_/=2)<1&&(K$_=1),(K$E/=2)<1&&(K$E=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){K$b.simLodInfo=new Float32Array(40);for(var K$e=0;K$e<K$b.simLodInfo.length;)K$b.simLodInfo[K$e]=(K$m.simLodRect[K$e]+.5)/1024,K$e++,K$b.simLodInfo[K$e]=(K$m.simLodRect[K$e]+.5)/256,K$e++,K$b.simLodInfo[K$e]=Math.max(K$m.simLodRect[K$e]-1,.1)/1024,K$e++,K$b.simLodInfo[K$e]=Math.max(K$m.simLodRect[K$e]-1.5,.1)/256,K$e++}return K$b}if("number"==typeof K$P)return K$D.loader.create(K$c,null,null,K$m,[function(K$c){return this._width=K$P,this._height=K$q,this._buffer=K$c,null}]);if("function"==typeof K$P)return K$D.loader.create(K$c,null,null,K$m,[K$P]);throw new Error("unknown params.")},K$m.lodasatlas=!1,K$k(K$m,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),K$m}(),K$IP=function(K$c){function K$P(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,K$P.__super.call(this)}K$r(K$P,"laya.d3.resource.models.PrimitiveMesh",K$VP);var K$q=K$P.prototype;return K$D.imps(K$q,{"laya.d3.core.render.IRenderable":!0}),K$q._getVertexBuffer=function(K$c){return void 0===K$c&&(K$c=0),0===K$c?this._vertexBuffer:null},K$q._getVertexBuffers=function(){return null},K$q._getIndexBuffer=function(){return this._indexBuffer},K$q._getPositions=function(){var K$c,K$P=[],K$q=this._vertexBuffer.vertexDeclaration.getVertexElements(),K$_=0;for(K$_=0;K$_<K$q.length;K$_++){var K$E=K$q[K$_];if("vector3"===K$E.elementFormat&&0===K$E.elementUsage){K$c=K$E;break}}var K$b=this._vertexBuffer.getData();for(K$_=0;K$_<K$b.length;K$_+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var K$e=K$_+K$c.offset/4,K$h=new K$eP(K$b[K$e+0],K$b[K$e+1],K$b[K$e+2]);K$P.push(K$h)}return K$P},K$q.getRenderElement=function(K$c){return this},K$q.getRenderElementsCount=function(){return 1},K$q.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},K$q._beforeRender=function(K$c){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},K$q._render=function(K$c){K$j.mainContext.drawElements(4,this._numberIndices,5123,0),K$Q.drawCall++,K$Q.trianglesFaces+=this._numberIndices/3},K$g(0,K$q,"_vertexBufferCount",function(){return 1}),K$g(0,K$q,"triangleCount",function(){return this._indexBuffer.indexCount/3}),K$P}(),K$vP=function(K$c){function K$P(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,K$P.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}K$r(K$P,"laya.d3.resource.models.Mesh",K$VP);var K$q=K$P.prototype;return K$q._getPositions=function(){var K$c,K$P,K$q,K$_,K$E,K$b=[],K$e=0,K$h=0,K$Z=0;if(0!==this._vertexBuffers.length){var K$S=this._vertexBuffers.length;for(K$e=0;K$e<K$S;K$e++){for(K$q=(K$c=this._vertexBuffers[K$e]).vertexDeclaration.getVertexElements(),K$h=0;K$h<K$q.length;K$h++)if("vector3"===(K$_=K$q[K$h]).elementFormat&&0===K$_.elementUsage){K$P=K$_;break}for(K$E=K$c.getData(),K$h=0;K$h<K$E.length;K$h+=K$c.vertexDeclaration.vertexStride/4)K$Z=K$h+K$P.offset/4,K$b.push(new K$eP(K$E[K$Z+0],K$E[K$Z+1],K$E[K$Z+2]))}}else{var K$n=this._subMeshes.length;for(K$e=0;K$e<K$n;K$e++){for(K$q=(K$c=this._subMeshes[K$e]._getVertexBuffer()).vertexDeclaration.getVertexElements(),K$h=0;K$h<K$q.length;K$h++)if("vector3"===(K$_=K$q[K$h]).elementFormat&&0===K$_.elementUsage){K$P=K$_;break}for(K$E=K$c.getData(),K$h=0;K$h<K$E.length;K$h+=K$c.vertexDeclaration.vertexStride/4)K$Z=K$h+K$P.offset/4,K$b.push(new K$eP(K$E[K$Z+0],K$E[K$Z+1],K$E[K$Z+2]))}}return K$b},K$q._setSubMeshes=function(K$c){this._subMeshes=K$c,this._subMeshCount=K$c.length;for(var K$P=0;K$P<this._subMeshCount;K$P++)K$c[K$P]._indexInMesh=K$P;this._positions=this._getPositions(),this._generateBoundingObject()},K$q.onAsynLoaded=function(K$c,K$P,K$q){var K$_=K$P[0],K$E=K$P[1];K$tc.read(K$_,this,this._materials,this._subMeshes,K$E),this.completeCreate(),this._endLoaded()},K$q.getSubMesh=function(K$c){return this._subMeshes[K$c]},K$q.getSubMeshCount=function(){return this._subMeshes.length},K$q.getRenderElementsCount=function(){return this._subMeshes.length},K$q.getRenderElement=function(K$c){return this._subMeshes[K$c]},K$q.disposeResource=function(){for(var K$c=0;K$c<this._subMeshes.length;K$c++)this._subMeshes[K$c].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},K$g(0,K$q,"materials",function(){return this._materials.slice()}),K$g(0,K$q,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),K$P.load=function(K$c){return K$D.loader.create(K$c,null,null,K$P)},K$P}(),K$yP=(function(K$c){function K$S(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===K$q&&(K$q=6408),void 0===K$_&&(K$_=5121),void 0===K$E&&(K$E=33189),void 0===K$b&&(K$b=!1),void 0===K$e&&(K$e=!1),void 0===K$h&&(K$h=-1),void 0===K$Z&&(K$Z=-1),K$S.__super.call(this),this._type=3553,this._width=K$c,this._height=K$P,this._size=new K$WP(K$c,K$P),this._surfaceFormat=K$q,this._surfaceType=K$_,this._depthStencilFormat=K$E,K$W.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=K$b,this._repeat=K$e,this._minFifter=K$h,this._magFifter=K$Z,this.activeResource(),this._alreadyResolved=!0}K$r(K$S,"laya.d3.resource.RenderTexture",K$jP);var K$P=K$S.prototype;K$P.recreateResource=function(){var K$c=K$j.mainContext;this._frameBuffer=K$c.createFramebuffer(),this._source=K$c.createTexture();var K$P=K$V.curBindTexTarget,K$q=K$V.curBindTexValue;K$V.bindTexture(K$c,this._type,this._source),K$c.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var K$_=this._minFifter,K$E=this._magFifter,K$b=this._repeat?10497:33071;if(K$T.isPOT(this._width,this._height)?(this._mipmap?-1!==K$_||(K$_=9987):-1!==K$_||(K$_=9729),-1!==K$E||(K$E=9729),K$c.texParameteri(this._type,10241,K$_),K$c.texParameteri(this._type,10240,K$E),K$c.texParameteri(this._type,10242,K$b),K$c.texParameteri(this._type,10243,K$b),this._mipmap&&K$c.generateMipmap(this._type)):(-1!==K$_||(K$_=9729),-1!==K$E||(K$E=9729),K$c.texParameteri(this._type,10241,K$_),K$c.texParameteri(this._type,10240,K$E),K$c.texParameteri(this._type,10242,33071),K$c.texParameteri(this._type,10243,33071)),K$P&&K$q&&K$V.bindTexture(K$c,K$P,K$q),K$c.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=K$c.createRenderbuffer(),K$c.bindRenderbuffer(36161,this._depthStencilBuffer),K$c.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),K$c.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:K$c.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:K$c.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:K$c.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}K$c.framebufferTexture2D(36160,36064,3553,this._source,0),K$c.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},K$P.start=function(){K$j.mainContext.bindFramebuffer(36160,this.frameBuffer),(K$S._currentRenderTarget=this)._alreadyResolved=!1},K$P.end=function(){K$j.mainContext.bindFramebuffer(36160,null),K$S._currentRenderTarget=null,this._alreadyResolved=!0},K$P.getData=function(K$c,K$P,K$q,K$_){var K$E=K$j.mainContext;if(K$E.bindFramebuffer(36160,this._frameBuffer),!(36053===K$E.checkFramebufferStatus(36160)))return K$E.bindFramebuffer(36160,null),null;var K$b=new Uint8Array(this._width*this._height*4);return K$E.readPixels(K$c,K$P,K$q,K$_,this._surfaceFormat,this._surfaceType,K$b),K$E.bindFramebuffer(36160,null),K$b},K$P.disposeResource=function(){if(this._frameBuffer){var K$c=K$j.mainContext;K$c.deleteTexture(this._source),K$c.deleteFramebuffer(this._frameBuffer),K$c.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},K$g(0,K$P,"surfaceFormat",function(){return this._surfaceFormat}),K$g(0,K$P,"surfaceType",function(){return this._surfaceType}),K$g(0,K$P,"depthStencilFormat",function(){return this._depthStencilFormat}),K$g(0,K$P,"source",function(){return this._alreadyResolved?K$D.superGet(K$jP,this,"source"):null}),K$g(0,K$P,"depthStencilBuffer",function(){return this._depthStencilBuffer}),K$g(0,K$P,"frameBuffer",function(){return this._frameBuffer}),K$S._currentRenderTarget=null}(),function(K$c){function K$P(K$c){this._color=null,this._pixels=null,K$P.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new K$WP(this.width,this.height),this._color=K$c,this._pixels=new Uint8Array([255*K$c.x,255*K$c.y,255*K$c.z,255*K$c.w]),this.uri="SolidColorTexture2D_"+this.id}K$r(K$P,"laya.d3.resource.SolidColorTexture2D",K$jP);var K$q=K$P.prototype;return K$q._createWebGlTexture=function(){var K$c=K$j.mainContext,K$P=this._source=K$c.createTexture(),K$q=this._width,K$_=this._height,K$E=K$V.curBindTexTarget,K$b=K$V.curBindTexValue;K$V.bindTexture(K$c,this._type,K$P),K$c.texImage2D(this._type,0,6408,K$q,K$_,0,6408,5121,this._pixels);var K$e=this._minFifter,K$h=this._magFifter,K$Z=this._repeat?10497:33071,K$S=K$T.isPOT(K$q,K$_);K$S?(this._mipmap?-1!==K$e||(K$e=9987):-1!==K$e||(K$e=9729),-1!==K$h||(K$h=9729),K$c.texParameteri(this._type,10241,K$e),K$c.texParameteri(this._type,10240,K$h),K$c.texParameteri(this._type,10242,K$Z),K$c.texParameteri(this._type,10243,K$Z),this._mipmap&&K$c.generateMipmap(this._type)):(-1!==K$e||(K$e=9729),-1!==K$h||(K$h=9729),K$c.texParameteri(this._type,10241,K$e),K$c.texParameteri(this._type,10240,K$h),K$c.texParameteri(this._type,10242,33071),K$c.texParameteri(this._type,10243,33071)),K$E&&K$b&&K$V.bindTexture(K$c,K$E,K$b),this.memorySize=K$S?K$q*K$_*4*(1+1/3):K$q*K$_*4},K$q.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},K$q.disposeResource=function(){this._source&&(K$j.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},K$k(K$P,["magentaTexture",function(){var K$c=new K$P(new K$hP(1,0,1,1));return K$c.lock=!0,this.magentaTexture=K$c},"grayTexture",function(){var K$c=new K$P(new K$hP(.5,.5,.5,1));return K$c.lock=!0,this.grayTexture=K$c}]),K$P}()),K$MP=function(K$c){function K$E(K$c,K$P,K$q,K$_){this._canRead=!1,this._image=null,this._pixels=null,void 0===K$c&&(K$c=!1),void 0===K$P&&(K$P=!0),void 0===K$q&&(K$q=6408),void 0===K$_&&(K$_=!0),K$E.__super.call(this),this._type=3553,this._repeat=K$P,this._canRead=K$c,this._format=K$q,this._mipmap=K$_}K$r(K$E,"laya.d3.resource.Texture2D",K$jP);var K$P=K$E.prototype;return K$P._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var K$c=K$j.mainContext,K$P=this._source=K$c.createTexture(),K$q=this._width,K$_=this._height,K$E=K$V.curBindTexTarget,K$b=K$V.curBindTexValue;switch(K$V.bindTexture(K$c,this._type,K$P),this._format){case 6407:case 6408:this._canRead?K$c.texImage2D(this._type,0,this._format,K$q,K$_,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?K$c.texImage2D(this._type,0,this._image._format,K$q,K$_,0,this._image._format,5121,this._image.atlasSource):K$c.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case K$j.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:K$c.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var K$e=this._minFifter,K$h=this._magFifter,K$Z=this._repeat?10497:33071,K$S=0==this._wrapModeU?10497:33071,K$n=0==this._wrapModeV?10497:33071,K$k=K$T.isPOT(K$q,K$_);K$k?(this._mipmap?-1!==K$e||(K$e=9987):-1!==K$e||(K$e=9729),-1!==K$h||(K$h=9729),K$c.texParameteri(this._type,10241,K$e),K$c.texParameteri(this._type,10240,K$h),K$c.texParameteri(this._type,10242,K$Z),K$c.texParameteri(this._type,10243,K$Z),K$c.texParameteri(this._type,10242,K$S),K$c.texParameteri(this._type,10243,K$n),this._mipmap&&K$c.generateMipmap(this._type)):(-1!==K$e||(K$e=9729),-1!==K$h||(K$h=9729),K$c.texParameteri(this._type,10241,K$e),K$c.texParameteri(this._type,10240,K$h),K$c.texParameteri(this._type,10242,33071),K$c.texParameteri(this._type,10243,33071)),K$E&&K$b&&K$V.bindTexture(K$c,K$E,K$b),this._image.onload=null,this._image=null,this.memorySize=K$k?K$q*K$_*4*(1+1/3):K$q*K$_*4},K$P.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},K$P.onAsynLoaded=function(K$c,K$P,K$q){if(K$q){var K$_=K$q[0];void 0!==K$_&&(this._canRead=K$_);var K$E=K$q[1];void 0!==K$E&&(this._repeat=K$E);var K$b=K$q[2];void 0!==K$b&&(this._format=K$b);var K$e=K$q[3];void 0!==K$e&&(this._mipmap=K$e);var K$h=K$q.wrapModeU;void 0!==K$h&&(this._wrapModeU=K$h);var K$Z=K$q.wrapModeV;void 0!==K$Z&&(this._wrapModeV=K$Z)}switch(this._format){case 6407:case 6408:var K$S=(this._image=K$P).width,K$n=K$P.height;this._width=K$S,this._height=K$n,this._size=new K$WP(K$S,K$n),this._canRead&&(K$W.isConchApp?K$P instanceof K$x.HTMLElement&&(this._pixels=new Uint8Array(K$P.getImageData(0,0,K$S,K$n))):(K$R.canvas.size(K$S,K$n),K$R.canvas.clear(),K$R.context.drawImage(K$P,0,0,K$S,K$n),this._pixels=new Uint8Array(K$R.context.getImageData(0,0,K$S,K$n).data.buffer)));break;case K$j.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var K$k=new K$L(K$P);K$k.readUTFBytes(4),K$k.readUTFBytes(2),K$k.getInt16();K$k.endian="bigEndian",this._width=K$k.getInt16(),this._height=K$k.getInt16(),this._size=new K$WP(this._width,this._height);K$k.getInt16(),K$k.getInt16();this._image=new Uint8Array(K$P,K$k.pos)}this.recreateResource(),this._endLoaded()},K$P.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},K$P.disposeResource=function(){this._source&&(K$j.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},K$g(0,K$P,"_src",function(){return this.url}),K$g(0,K$P,"src",function(){return this.url}),K$E.load=function(K$c){return K$D.loader.create(K$c,null,null,K$E)},K$E}(),K$zP=function(K$P){function K$q(K$c,K$P){K$q.__super.call(this),void 0===K$c&&(K$c=.3),void 0===K$P&&(K$P=1e3),this._tempVector3=new K$eP,this._position=new K$eP,this._up=new K$eP,this._forward=new K$eP,this._right=new K$eP,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=K$WP.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=K$c,this._farPlane=K$P,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),K$D.stage.on("resize",this,this._onScreenSizeChanged)}K$r(K$q,"laya.d3.core.BaseCamera",K$P);var K$c=K$q.prototype;return K$c._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var K$c=this.scene._cameraPool,K$P=K$c.length-1,K$q=0;K$q<K$P;K$q++)if(K$c[K$q].renderingOrder>K$c[K$P].renderingOrder){var K$_=K$c[K$q];K$c[K$q]=K$c[K$P],K$c[K$P]=K$_}},K$c._calculateProjectionMatrix=function(){},K$c._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},K$c._prepareCameraToRender=function(){K$$._currentCameraCullingMask=this.cullingMask;var K$c=this._shaderValues;K$c.setValue(0,this.transform.position.elements),K$c.setValue(5,this.forward.elements),K$c.setValue(6,this.up.elements)},K$c._prepareCameraViewProject=function(K$c,K$P){var K$q=this._shaderValues;K$q.setValue(1,K$c.elements),K$q.setValue(2,K$P.elements)},K$c._renderCamera=function(K$c,K$P,K$q){},K$c.addLayer=function(K$c){29!==K$c.number&&30!=K$c.number&&(this.cullingMask=this.cullingMask|K$c.mask)},K$c.removeLayer=function(K$c){29!==K$c.number&&30!=K$c.number&&(this.cullingMask=this.cullingMask&~K$c.mask)},K$c.addAllLayers=function(){this.cullingMask=2147483647},K$c.removeAllLayers=function(){this.cullingMask=0|K$$.getLayerByNumber(29).mask|K$$.getLayerByNumber(30).mask},K$c.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},K$c.moveForward=function(K$c){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=K$c,this.transform.translate(this._tempVector3)},K$c.moveRight=function(K$c){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=K$c,this.transform.translate(this._tempVector3)},K$c.moveVertical=function(K$c){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=K$c,this.transform.translate(this._tempVector3,!1)},K$c._addSelfRenderObjects=function(){var K$c=this.scene._cameraPool,K$P=K$c.length;if(0<K$P){for(var K$q=K$P-1;0<=K$q;K$q--)if(this.renderingOrder<=K$c[K$q].renderingOrder){K$c.splice(K$q+1,0,this);break}}else K$c.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},K$c._clearSelfRenderObjects=function(){var K$c=this.scene._cameraPool;K$c.splice(K$c.indexOf(this),1)},K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,K$D.stage.off("resize",this,this._onScreenSizeChanged),K$P.prototype.destroy.call(this,K$c)},K$g(0,K$c,"sky",function(){return this._sky},function(K$c){(this._sky=K$c)._ownerCamera=this}),K$g(0,K$c,"forward",function(){var K$c=this.transform.worldMatrix.elements,K$P=this._forward.elements;return K$P[0]=-K$c[8],K$P[1]=-K$c[9],K$P[2]=-K$c[10],this._forward}),K$g(0,K$c,"position",function(){var K$c=this.transform.worldMatrix.elements,K$P=this._position.elements;return K$P[0]=K$c[12],K$P[1]=K$c[13],K$P[2]=K$c[14],this._position}),K$g(0,K$c,"renderTarget",function(){return this._renderTarget},function(K$c){null!=(this._renderTarget=K$c)&&(this._renderTargetSize=K$c.size)}),K$g(0,K$c,"up",function(){var K$c=this.transform.worldMatrix.elements,K$P=this._up.elements;return K$P[0]=K$c[4],K$P[1]=K$c[5],K$P[2]=K$c[6],this._up}),K$g(0,K$c,"right",function(){var K$c=this.transform.worldMatrix.elements,K$P=this._right.elements;return K$P[0]=K$c[0],K$P[1]=K$c[1],K$P[2]=K$c[2],this._right}),K$g(0,K$c,"renderTargetSize",function(){return this._renderTargetSize},function(K$c){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=K$c,this._calculateProjectionMatrix()}),K$g(0,K$c,"fieldOfView",function(){return this._fieldOfView},function(K$c){this._fieldOfView=K$c,this._calculateProjectionMatrix()}),K$g(0,K$c,"nearPlane",function(){return this._nearPlane},function(K$c){this._nearPlane=K$c,this._calculateProjectionMatrix()}),K$g(0,K$c,"farPlane",function(){return this._farPlane},function(K$c){this._farPlane=K$c,this._calculateProjectionMatrix()}),K$g(0,K$c,"orthographic",function(){return this._orthographic},function(K$c){this._orthographic=K$c,this._calculateProjectionMatrix()}),K$g(0,K$c,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(K$c){this._orthographicVerticalSize=K$c,this._calculateProjectionMatrix()}),K$g(0,K$c,"renderingOrder",function(){return this._renderingOrder},function(K$c){this._renderingOrder=K$c,this._sortCamerasByRenderingOrder()}),K$q.CAMERAPOS=0,K$q.VIEWMATRIX=1,K$q.PROJECTMATRIX=2,K$q.VPMATRIX=3,K$q.VPMATRIX_NO_TRANSLATE=4,K$q.CAMERADIRECTION=5,K$q.CAMERAUP=6,K$q.ENVIRONMENTDIFFUSE=7,K$q.ENVIRONMENTSPECULAR=8,K$q.SIMLODINFO=9,K$q.DIFFUSEIRRADMATR=10,K$q.DIFFUSEIRRADMATG=11,K$q.DIFFUSEIRRADMATB=12,K$q.HDREXPOSURE=13,K$q.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",K$q.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",K$q.CLEARFLAG_SOLIDCOLOR=0,K$q.CLEARFLAG_SKY=1,K$q.CLEARFLAG_DEPTHONLY=2,K$q.CLEARFLAG_NONE=3,K$k(K$q,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new K$cP(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new K$cP},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new K$cP}]),K$q}(K$FP),K$XP=function(K$q){function K$P(K$c){this._render=null,this._geometryFilter=null,K$P.__super.call(this,K$c)}K$r(K$P,"laya.d3.core.RenderableSprite3D",K$q);var K$c=K$P.prototype;return K$c._addToInitStaticBatchManager=function(){},K$c._setBelongScene=function(K$c){K$q.prototype._setBelongScene.call(this,K$c),K$c._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},K$c._setUnBelongScene=function(){var K$c=this._scene._renderableSprite3Ds,K$P=K$c.indexOf(this);K$c.splice(K$P,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),K$q.prototype._setUnBelongScene.call(this)},K$c._update=function(K$c){(K$c.owner=this)._activeInHierarchy&&(this._updateComponents(K$c),this._render._updateOctreeNode(),this._lateUpdateComponents(K$c),K$Q.spriteCount++,this._childs.length&&this._updateChilds(K$c))},K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),K$q.prototype.destroy.call(this,K$c),this._render._destroy(),this._render=null},K$P.__init__=function(){K$P.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=K$P.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),K$P.SAHDERDEFINE_LIGHTMAP=K$P.shaderDefines.registerDefine("LIGHTMAP")},K$P.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,K$P.SAHDERDEFINE_LIGHTMAP=4,K$P.LIGHTMAPSCALEOFFSET=2,K$P.LIGHTMAP=3,K$k(K$P,["shaderDefines",function(){return this.shaderDefines=new K$nP}]),K$P}(K$FP),K$fP=(function(K$c){function K$_(K$c,K$P,K$q){this._long=NaN,this._width=NaN,this._height=NaN,void 0===K$c&&(K$c=1),void 0===K$P&&(K$P=1),void 0===K$q&&(K$q=1),K$_.__super.call(this),this._long=K$c,this._width=K$P,this._height=K$q,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}K$r(K$_,"laya.d3.resource.models.BoxMesh",K$IP);var K$P=K$_.prototype;K$P.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var K$c=K$jc.vertexDeclaration,K$P=(K$c.vertexStride,this._long/2),K$q=this._height/2,K$_=this._width/2,K$E=new Float32Array([-K$P,K$q,-K$_,0,1,0,0,0,K$P,K$q,-K$_,0,1,0,1,0,K$P,K$q,K$_,0,1,0,1,1,-K$P,K$q,K$_,0,1,0,0,1,-K$P,-K$q,-K$_,0,-1,0,0,1,K$P,-K$q,-K$_,0,-1,0,1,1,K$P,-K$q,K$_,0,-1,0,1,0,-K$P,-K$q,K$_,0,-1,0,0,0,-K$P,K$q,-K$_,-1,0,0,0,0,-K$P,K$q,K$_,-1,0,0,1,0,-K$P,-K$q,K$_,-1,0,0,1,1,-K$P,-K$q,-K$_,-1,0,0,0,1,K$P,K$q,-K$_,1,0,0,1,0,K$P,K$q,K$_,1,0,0,0,0,K$P,-K$q,K$_,1,0,0,0,1,K$P,-K$q,-K$_,1,0,0,1,1,-K$P,K$q,K$_,0,0,1,0,0,K$P,K$q,K$_,0,0,1,1,0,K$P,-K$q,K$_,0,0,1,1,1,-K$P,-K$q,K$_,0,0,1,0,1,-K$P,K$q,-K$_,0,0,-1,1,0,K$P,K$q,-K$_,0,0,-1,0,0,K$P,-K$q,-K$_,0,0,-1,0,1,-K$P,-K$q,-K$_,0,0,-1,1,1]),K$b=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new K$sP(K$c,this._numberVertices,35044,!0),this._indexBuffer=new K$YP("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(K$E),this._indexBuffer.setData(K$b),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},K$g(0,K$P,"long",function(){return this._long},function(K$c){this._long!==K$c&&(this._long=K$c,this.releaseResource(),this.activeResource())}),K$g(0,K$P,"width",function(){return this._width},function(K$c){this._width!==K$c&&(this._width=K$c,this.releaseResource(),this.activeResource())}),K$g(0,K$P,"height",function(){return this._height},function(K$c){this._height!==K$c&&(this._height=K$c,this.releaseResource(),this.activeResource())})}(),function(K$c){function K$E(K$c,K$P,K$q,K$_){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===K$c&&(K$c=10),void 0===K$P&&(K$P=10),void 0===K$q&&(K$q=10),void 0===K$_&&(K$_=10),K$E.__super.call(this),this._long=K$c,this._width=K$P,this._stacks=K$q,this._slices=K$_,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}K$r(K$E,"laya.d3.resource.models.PlaneMesh",K$IP);var K$P=K$E.prototype;K$P.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var K$c=new Uint16Array(this._numberIndices),K$P=K$jc.vertexDeclaration,K$q=K$P.vertexStride/4,K$_=new Float32Array(this._numberVertices*K$q),K$E=this._long/2,K$b=this._width/2,K$e=this._long/this._stacks,K$h=this._width/this._slices,K$Z=0,K$S=0;K$S<=this._slices;K$S++)for(var K$n=0;K$n<=this._stacks;K$n++)K$_[K$Z++]=K$n*K$e-K$E,K$_[K$Z++]=0,K$_[K$Z++]=K$S*K$h-K$b,K$_[K$Z++]=0,K$_[K$Z++]=1,K$_[K$Z++]=0,K$_[K$Z++]=1*K$n/this._stacks,K$_[K$Z++]=1*K$S/this._slices;var K$k=0;for(K$S=0;K$S<this._slices;K$S++)for(K$n=0;K$n<this._stacks;K$n++)K$c[K$k++]=(K$S+1)*(this._stacks+1)+K$n,K$c[K$k++]=K$S*(this._stacks+1)+K$n,K$c[K$k++]=(K$S+1)*(this._stacks+1)+K$n+1,K$c[K$k++]=K$S*(this._stacks+1)+K$n,K$c[K$k++]=K$S*(this._stacks+1)+K$n+1,K$c[K$k++]=(K$S+1)*(this._stacks+1)+K$n+1;this._vertexBuffer=new K$sP(K$P,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new K$YP("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData(K$_),this._indexBuffer.setData(K$c),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},K$g(0,K$P,"long",function(){return this._long},function(K$c){this._long!==K$c&&(this._long=K$c,this.releaseResource(),this.activeResource())}),K$g(0,K$P,"width",function(){return this._width},function(K$c){this._width!==K$c&&(this._width=K$c,this.releaseResource(),this.activeResource())}),K$g(0,K$P,"stacks",function(){return this._stacks},function(K$c){this._stacks!==K$c&&(this._stacks=K$c,this.releaseResource(),this.activeResource())}),K$g(0,K$P,"slices",function(){return this._slices},function(K$c){this._slices!==K$c&&(this._slices=K$c,this.releaseResource(),this.activeResource())})}(),function(K$c){function K$e(K$c,K$P,K$q){void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=.3),void 0===K$q&&(K$q=1e3),this._viewMatrix=new K$cP,this._projectionMatrix=new K$cP,this._projectionViewMatrix=new K$cP,this._viewport=new K$ZP(0,0,0,0),this._normalizedViewport=new K$ZP(0,0,1,1),this._aspectRatio=K$c,this._boundFrustumUpdate=!0,this._boundFrustum=new K$pc(K$cP.DEFAULT),K$e.__super.call(this,K$P,K$q),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}K$r(K$e,"laya.d3.core.Camera",K$zP);var K$P=K$e.prototype;return K$P._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},K$P._parseCustomProps=function(K$c,K$P,K$q,K$_){var K$E=K$q.clearColor;this.clearColor=new K$hP(K$E[0],K$E[1],K$E[2],K$E[3]);var K$b=K$q.viewport;this.normalizedViewport=new K$ZP(K$b[0],K$b[1],K$b[2],K$b[3])},K$P._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var K$c=this.orthographicVerticalSize*this.aspectRatio*.5,K$P=.5*this.orthographicVerticalSize;K$cP.createOrthoOffCenterRH(-K$c,K$c,-K$P,K$P,this.nearPlane,this.farPlane,this._projectionMatrix)}else K$cP.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},K$P._update=function(K$c){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,K$c)},K$P._renderCamera=function(K$c,K$P,K$q){var K$_,K$E;K$q.parallelSplitShadowMaps[0]&&K$q._renderShadowMap(K$c,K$P,this),(K$P.camera=this)._prepareCameraToRender(),K$q._preRenderUpdateComponents(K$P),K$_=K$P._viewMatrix=this.viewMatrix;var K$b=this._renderTarget;K$b?(K$b.start(),K$cP.multiply(K$zP._invertYScaleMatrix,this._projectionMatrix,K$zP._invertYProjectionMatrix),K$cP.multiply(K$zP._invertYScaleMatrix,this.projectionViewMatrix,K$zP._invertYProjectionViewMatrix),K$E=K$P._projectionMatrix=K$zP._invertYProjectionMatrix,K$P._projectionViewMatrix=K$zP._invertYProjectionViewMatrix):(K$E=K$P._projectionMatrix=this._projectionMatrix,K$P._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(K$_,K$E),K$P._viewport=this.viewport,K$q._preRenderScene(K$c,K$P,this.boundFrustum),K$q._clear(K$c,K$P),K$q._renderScene(K$c,K$P),K$q._postRenderUpdateComponents(K$P),K$b&&K$b.end()},K$P.viewportPointToRay=function(K$c,K$P){K$gP.calculateCursorRay(K$c,this.viewport,this._projectionMatrix,this.viewMatrix,null,K$P)},K$P.normalizedViewportPointToRay=function(K$c,K$P){var K$q=K$e._tempVector20,K$_=this.viewport,K$E=K$c.elements,K$b=K$q.elements;K$b[0]=K$E[0]*K$_.width,K$b[1]=K$E[1]*K$_.height,K$gP.calculateCursorRay(K$q,this.viewport,this._projectionMatrix,this.viewMatrix,null,K$P)},K$P.worldToViewportPoint=function(K$c,K$P){K$cP.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(K$c,this._projectionViewMatrix,K$P);var K$q=K$P.elements;K$q[0]=K$q[0]/K$D.stage.clientScaleX,K$q[1]=K$q[1]/K$D.stage.clientScaleY},K$P.worldToNormalizedViewportPoint=function(K$c,K$P){K$cP.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(K$c,this._projectionViewMatrix,K$P);var K$q=K$P.elements;K$q[0]=K$q[0]/K$D.stage.clientScaleX,K$q[1]=K$q[1]/K$D.stage.clientScaleY},K$P.convertScreenCoordToOrthographicCoord=function(K$c,K$P){if(this._orthographic){var K$q=K$t.clientWidth,K$_=K$t.clientHeight,K$E=this.orthographicVerticalSize*this.aspectRatio/K$q,K$b=this.orthographicVerticalSize/K$_,K$e=K$c.elements,K$h=K$P.elements;return K$h[0]=(-K$q/2+K$e[0])*K$E,K$h[1]=(K$_/2-K$e[1])*K$b,K$h[2]=(this.nearPlane-this.farPlane)*(K$e[2]+1)/2-this.nearPlane,K$eP.transformCoordinate(K$P,this.transform.worldMatrix,K$P),!0}return!1},K$g(0,K$P,"projectionViewMatrix",function(){return K$cP.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),K$g(0,K$P,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var K$c=this.viewport;return K$c.width/K$c.height},function(K$c){if(K$c<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=K$c,this._calculateProjectionMatrix()}),K$g(0,K$P,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),K$g(0,K$P,"needViewport",function(){var K$c=this.normalizedViewport;return 0===K$c.x&&0===K$c.y&&1===K$c.width&&1===K$c.height}),K$g(0,K$P,"viewport",function(){if(this._viewportExpressedInClipSpace){var K$c=this._normalizedViewport,K$P=this.renderTargetSize,K$q=K$P.width,K$_=K$P.height;this._viewport.x=K$c.x*K$q,this._viewport.y=K$c.y*K$_,this._viewport.width=K$c.width*K$q,this._viewport.height=K$c.height*K$_}return this._viewport},function(K$c){if(null!=this.renderTarget&&(K$c.x<0||K$c.y<0||0==K$c.width||0==K$c.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=K$c,this._calculateProjectionMatrix()}),K$g(0,K$P,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var K$c=this._viewport,K$P=this.renderTargetSize,K$q=K$P.width,K$_=K$P.height;this._normalizedViewport.x=K$c.x/K$q,this._normalizedViewport.y=K$c.y/K$_,this._normalizedViewport.width=K$c.width/K$q,this._normalizedViewport.height=K$c.height/K$_}return this._normalizedViewport},function(K$c){K$c.x<0&&(K$c.x=0,console.warn("Camera: viewport.x must large than 0.0.")),K$c.y<0&&(K$c.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<K$c.x+K$c.width&&(K$c.width=1-K$c.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<K$c.y+K$c.height&&(K$c.height=1-K$c.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=K$c,this._calculateProjectionMatrix()}),K$g(0,K$P,"projectionMatrix",function(){return this._projectionMatrix},function(K$c){this._projectionMatrix=K$c,this._useUserProjectionMatrix=!0}),K$g(0,K$P,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),K$k(K$e,["_tempVector20",function(){return this._tempVector20=new K$bP}]),K$e}()),K$lP=function(K$q){function K$_(K$c,K$P){K$_.__super.call(this,K$P),this._geometryFilter=new K$RP(this),this._render=new K$$P(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),K$c&&(this._geometryFilter.sharedMesh=K$c)instanceof laya.d3.resource.models.Mesh&&(K$c.loaded?this._render.sharedMaterials=K$c.materials:K$c.once("loaded",this,this._applyMeshMaterials))}K$r(K$_,"laya.d3.core.MeshSprite3D",K$q);var K$c=K$_.prototype;return K$c._changeRenderObjectByMesh=function(K$c){var K$P=this._render._renderElements,K$q=K$P[K$c];K$q||(K$q=K$P[K$c]=new K$HP),K$q._render=this._render;var K$_=this._render.sharedMaterials[K$c];K$_||(K$_=K$aP.defaultMaterial);var K$E=this._geometryFilter.sharedMesh.getRenderElement(K$c);return K$q._mainSortID=this._getSortID(K$E,K$_),K$q._sprite3D=this,K$q.renderObj=K$E,K$q._material=K$_,K$q},K$c._changeRenderObjectByMaterial=function(K$c,K$P){var K$q=this._render._renderElements[K$c];K$P||(K$P=K$aP.defaultMaterial);var K$_=this._geometryFilter.sharedMesh.getRenderElement(K$c);return K$q._mainSortID=this._getSortID(K$_,K$P),K$q._sprite3D=this,K$q.renderObj=K$_,K$q._material=K$P,K$q},K$c._changeRenderObjectsByMesh=function(){var K$c=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=K$c;for(var K$P=0;K$P<K$c;K$P++)this._changeRenderObjectByMesh(K$P)},K$c._onMeshChanged=function(K$c){var K$P=K$c.sharedMesh;K$P.loaded?this._changeRenderObjectsByMesh():K$P.once("loaded",this,this._onMeshLoaded)},K$c._onMeshLoaded=function(K$c){K$c===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},K$c._onMaterialChanged=function(K$c,K$P,K$q){K$P<this._render._renderElements.length&&this._changeRenderObjectByMaterial(K$P,K$q)},K$c._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},K$c._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},K$c._parseCustomProps=function(K$c,K$P,K$q,K$_){var K$E=this.meshRender,K$b=K$q.lightmapIndex;null!=K$b&&(K$E.lightmapIndex=K$b);var K$e,K$h,K$Z=K$q.lightmapScaleOffset;if(K$Z&&(K$E.lightmapScaleOffset=new K$hP(K$Z[0],K$Z[1],K$Z[2],K$Z[3])),K$_.instanceParams)(K$e=K$_.instanceParams.loadPath)&&(K$h=K$O.getRes(K$P[K$e]),(this.meshFilter.sharedMesh=K$h).loaded?K$E.sharedMaterials=K$h.materials:K$h.once("loaded",this,this._applyMeshMaterials));else{(K$e=K$q.meshPath)&&(K$h=K$O.getRes(K$P[K$e]),this.meshFilter.sharedMesh=K$h);var K$S=K$q.materials;if(K$S){var K$n=K$E.sharedMaterials,K$k=K$S.length;K$n.length=K$k;for(var K$x=0;K$x<K$k;K$x++)K$n[K$x]=K$O.getRes(K$P[K$S[K$x].path]);K$E.sharedMaterials=K$n}}},K$c._applyMeshMaterials=function(K$c){for(var K$P=this._render.sharedMaterials,K$q=K$c.materials,K$_=0,K$E=K$q.length;K$_<K$E;K$_++)K$P[K$_]||(K$P[K$_]=K$q[K$_]);this._render.sharedMaterials=K$P},K$c._addToInitStaticBatchManager=function(){K$_._staticBatchManager._addInitBatchSprite(this)},K$c.cloneTo=function(K$c){var K$P=K$c;K$P._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var K$q=this._render,K$_=K$P._render;K$_.enable=K$q.enable,K$_.sharedMaterials=K$q.sharedMaterials,K$_.castShadow=K$q.castShadow;var K$E=K$q.lightmapScaleOffset;K$E&&(K$_.lightmapScaleOffset=K$E.clone()),K$_.lightmapIndex=K$q.lightmapIndex,K$_.receiveShadow=K$q.receiveShadow,K$_.sortingFudge=K$q.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,K$c)},K$c.destroy=function(K$c){if(void 0===K$c&&(K$c=!0),!this.destroyed){var K$P=this.meshFilter.sharedMesh;null!=K$P&&(K$P.loaded||K$P.off("loaded",this,this._applyMeshMaterials)),K$q.prototype.destroy.call(this,K$c),this._geometryFilter._destroy()}},K$g(0,K$c,"meshFilter",function(){return this._geometryFilter}),K$g(0,K$c,"meshRender",function(){return this._render}),K$_.__init__=function(){K$_c._staticBatchManagers.push(K$_._staticBatchManager)},K$_.load=function(K$c){return K$D.loader.create(K$c,null,null,K$_)},K$k(K$_,["_staticBatchManager",function(){return this._staticBatchManager=new K$dP}]),K$_}(K$XP)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(K$c,K$P){"use strict";for(var K$q in Object.defineProperty(K$P,"__esModule",{value:!0}),Laya){var K$_=Laya[K$q];K$_&&K$_.__isclass&&(K$P[K$q]=K$_)}}),function(K$c,K$P,K$Ec){K$Ec.un,K$Ec.uns;var K$q=K$Ec.static,K$_=K$Ec.class,K$b=K$Ec.getset,K$W=K$Ec.__newvec,K$h=laya.maths.Bezier,K$k=laya.utils.Browser,K$jc=laya.utils.Byte,K$E=(laya.events.Event,laya.events.EventDispatcher),K$e=laya.display.Graphics,K$Z=(laya.resource.HTMLCanvas,laya.utils.Handler),K$S=laya.net.Loader,K$x=laya.maths.MathUtil,K$Vc=laya.maths.Matrix,K$w=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),K$n=(laya.renders.RenderContext,laya.resource.Resource),K$r=laya.utils.RunDriver,K$bc=laya.display.Sprite,K$g=laya.utils.Stat,K$Rc=laya.resource.Texture,K$O=(laya.net.URL,laya.utils.Utils),K$V=function(){function K$c(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return K$_(K$c,"laya.ani.AnimationContent"),K$c}(),K$R=function(){function K$c(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return K$_(K$c,"laya.ani.AnimationNodeContent"),K$c}(),K$m=function(){function K$c(){}return K$_(K$c,"laya.ani.AnimationParser01"),K$c.parse=function(K$c,K$P){var K$q=K$P.__getBuffer(),K$_=0,K$E=0,K$b=0,K$e=0,K$h=0,K$Z=0,K$S=0,K$n=K$P.readUTFString();K$c._aniClassName=K$n;var K$k,K$x=K$P.readUTFString().split("\n"),K$r=K$P.getUint8(),K$g=K$P.getUint32(),K$W=K$P.getUint32();0<K$g&&(K$k=K$q.slice(K$g,K$W));var K$w=new K$jc(K$k);for(0<K$W&&(K$c._publicExtData=K$q.slice(K$W,K$q.byteLength)),K$c._useParent=!!K$P.getUint8(),K$c._anis.length=K$r,K$_=0;K$_<K$r;K$_++){var K$O=K$c._anis[K$_]=new K$V;K$O.nodes=new Array;var K$N=K$O.name=K$x[K$P.getUint16()];K$c._aniMap[K$N]=K$_,K$O.bone3DMap={},K$O.playTime=K$P.getFloat32(),K$O.playTime<=0&&console.error("播放时间不能为0  url="+K$c.url+" name="+K$O.name);var K$m=K$O.nodes.length=K$P.getUint8();for(K$E=K$O.totalKeyframeDatasLength=0;K$E<K$m;K$E++){var K$T=K$O.nodes[K$E]=new K$R;K$T.childs=[];var K$D=K$P.getInt16();0<=K$D&&(K$T.name=K$x[K$D],K$O.bone3DMap[K$T.name]=K$E),K$T.keyFrame=new Array,K$T.parentIndex=K$P.getInt16(),-1==K$T.parentIndex?K$T.parent=null:K$T.parent=K$O.nodes[K$T.parentIndex],K$T.lerpType=K$P.getUint8();var K$L=K$P.getUint32();K$w.pos=K$L;var K$H=K$T.keyframeWidth=K$w.getUint16();if(K$O.totalKeyframeDatasLength+=K$H,0===K$T.lerpType||1===K$T.lerpType)for(K$T.interpolationMethod=[],K$T.interpolationMethod.length=K$H,K$b=0;K$b<K$H;K$b++)K$T.interpolationMethod[K$b]=K$F.interpolation[K$w.getUint8()];null!=K$T.parent&&K$T.parent.childs.push(K$T);var K$Q=K$P.getUint16();0<K$Q&&(K$T.extenData=K$q.slice(K$P.pos,K$P.pos+K$Q),K$P.pos+=K$Q);var K$d,K$u=K$P.getUint16(),K$A=0;for(K$b=0,K$e=K$T.keyFrame.length=K$u;K$b<K$e;K$b++){if((K$d=K$T.keyFrame[K$b]=new K$$).duration=K$P.getFloat32(),K$d.startTime=K$A,2===K$T.lerpType){K$d.interpolationData=[];var K$J,K$j=K$P.getUint8();switch(K$J=K$P.getFloat32()){case 254:for(K$d.interpolationData.length=K$H,K$S=0;K$S<K$H;K$S++)K$d.interpolationData[K$S]=0;break;case 255:for(K$d.interpolationData.length=K$H,K$S=0;K$S<K$H;K$S++)K$d.interpolationData[K$S]=5;break;default:for(K$d.interpolationData.push(K$J),K$Z=1;K$Z<K$j;K$Z++)K$d.interpolationData.push(K$P.getFloat32())}}for(K$d.data=new Float32Array(K$H),K$h=0;K$h<K$H;K$h++)K$d.data[K$h]=K$P.getFloat32(),-1e-8<K$d.data[K$h]&&K$d.data[K$h]<1e-8&&(K$d.data[K$h]=0);K$A+=K$d.duration}K$d.startTime=K$O.playTime,K$T.playTime=K$O.playTime,K$c._calculateKeyFrame(K$T,K$u,K$H)}}},K$c}(),K$T=function(){function K$D(){}return K$_(K$D,"laya.ani.AnimationParser02"),K$D.READ_DATA=function(){K$D._DATA.offset=K$D._reader.getUint32(),K$D._DATA.size=K$D._reader.getUint32()},K$D.READ_BLOCK=function(){for(var K$c=K$D._BLOCK.count=K$D._reader.getUint16(),K$P=K$D._BLOCK.blockStarts=[],K$q=K$D._BLOCK.blockLengths=[],K$_=0;K$_<K$c;K$_++)K$P.push(K$D._reader.getUint32()),K$q.push(K$D._reader.getUint32())},K$D.READ_STRINGS=function(){var K$c=K$D._reader.getUint32(),K$P=K$D._reader.getUint16(),K$q=K$D._reader.pos;K$D._reader.pos=K$c+K$D._DATA.offset;for(var K$_=0;K$_<K$P;K$_++)K$D._strings[K$_]=K$D._reader.readUTFString();K$D._reader.pos=K$q},K$D.parse=function(K$c,K$P){K$D._templet=K$c;(K$D._reader=K$P).__getBuffer();K$D.READ_DATA(),K$D.READ_BLOCK(),K$D.READ_STRINGS();for(var K$q=0,K$_=K$D._BLOCK.count;K$q<K$_;K$q++){var K$E=K$P.getUint16(),K$b=K$D._strings[K$E],K$e=K$D["READ_"+K$b];if(null==K$e)throw new Error("model file err,no this function:"+K$E+" "+K$b);K$e.call()}},K$D.READ_ANIMATIONS=function(){var K$c=K$D._reader,K$P=K$c.__getBuffer(),K$q=0,K$_=0,K$E=0,K$b=0,K$e=K$c.getUint16(),K$h=[];for(K$h.length=K$e,K$q=0;K$q<K$e;K$q++)K$h[K$q]=K$F.interpolation[K$c.getByte()];var K$Z=K$c.getUint8();for(K$D._templet._anis.length=K$Z,K$q=0;K$q<K$Z;K$q++){var K$S=K$D._templet._anis[K$q]={};K$S.nodes=new Array;var K$n=K$S.name=K$D._strings[K$c.getUint16()];K$D._templet._aniMap[K$n]=K$q,K$S.bone3DMap={},K$S.playTime=K$c.getFloat32();var K$k=K$S.nodes.length=K$c.getInt16();for(K$_=K$S.totalKeyframeDatasLength=0;K$_<K$k;K$_++){var K$x=K$S.nodes[K$_]={};K$x.keyframeWidth=K$e,K$x.childs=[];var K$r=K$c.getUint16();0<=K$r&&(K$x.name=K$D._strings[K$r],K$S.bone3DMap[K$x.name]=K$_),K$x.keyFrame=new Array,K$x.parentIndex=K$c.getInt16(),-1==K$x.parentIndex?K$x.parent=null:K$x.parent=K$S.nodes[K$x.parentIndex],K$S.totalKeyframeDatasLength+=K$e,K$x.interpolationMethod=K$h,null!=K$x.parent&&K$x.parent.childs.push(K$x);var K$g=K$c.getUint16(),K$W=null,K$w=null;for(K$E=0,K$b=K$x.keyFrame.length=K$g;K$E<K$b;K$E++){(K$W=K$x.keyFrame[K$E]={}).startTime=K$c.getFloat32(),K$w&&(K$w.duration=K$W.startTime-K$w.startTime);var K$O=K$D._DATA.offset,K$N=K$c.getUint32(),K$m=4*K$e,K$T=K$P.slice(K$O+K$N,K$O+K$N+K$m);K$W.data=new Float32Array(K$T),K$w=K$W}K$W.duration=0,K$x.playTime=K$S.playTime,K$D._templet._calculateKeyFrame(K$x,K$g,K$e)}}},K$D._templet=null,K$D._reader=null,K$D._strings=[],K$q(K$D,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),K$D}(),K$$c=(function(){function K$c(){}K$_(K$c,"laya.ani.AnimationState"),K$c.stopped=0,K$c.paused=1,K$c.playing=2}(),function(){function K$E(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new K$Xc,this.resultMatrix=new K$Vc,this._children=[]}K$_(K$E,"laya.ani.bone.Bone");var K$c=K$E.prototype;return K$c.setTempMatrix=function(K$c){this._tempMatrix=K$c;var K$P,K$q=0;for(K$q=0,K$P=this._children.length;K$q<K$P;K$q++)this._children[K$q].setTempMatrix(this._tempMatrix)},K$c.update=function(K$c){var K$P;if(this.rotation=this.transform.skX,K$c)K$P=this.resultTransform.getMatrix(),K$Vc.mul(K$P,K$c,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)K$P=this.resultTransform.getMatrix(),K$Vc.mul(K$P,this.parentBone.resultMatrix,this.resultMatrix);else{var K$q=this.parentBone,K$_=NaN,K$E=NaN,K$b=NaN,K$e=this.parentBone.resultMatrix;K$P=this.resultTransform.getMatrix();var K$h=K$e.a*K$P.tx+K$e.c*K$P.ty+K$e.tx,K$Z=K$e.b*K$P.tx+K$e.d*K$P.ty+K$e.ty,K$S=new K$Vc;this.inheritRotation?(K$_=Math.atan2(K$q.resultMatrix.b,K$q.resultMatrix.a),K$E=Math.cos(K$_),K$b=Math.sin(K$_),K$S.setTo(K$E,K$b,-K$b,K$E,0,0),K$Vc.mul(this._tempMatrix,K$S,K$Vc.TEMP),K$Vc.TEMP.copyTo(K$S),K$P=this.resultTransform.getMatrix(),K$Vc.mul(K$P,K$S,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,K$P=this.resultTransform.getMatrix(),K$Vc.TEMP.identity(),K$Vc.TEMP.d=this.d,K$Vc.mul(K$P,K$Vc.TEMP,this.resultMatrix)),this.resultMatrix.tx=K$h,this.resultMatrix.ty=K$Z}else(K$P=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var K$n,K$k=0;for(K$k=0,K$n=this._children.length;K$k<K$n;K$k++)this._children[K$k].update()},K$c.updateChild=function(){var K$c,K$P=0;for(K$P=0,K$c=this._children.length;K$P<K$c;K$P++)this._children[K$P].update()},K$c.setRotation=function(K$c){this._sprite&&(this._sprite.rotation=180*K$c/Math.PI)},K$c.updateDraw=function(K$c,K$P){K$E.ShowBones&&!K$E.ShowBones[this.name]||(this._sprite||(this._sprite=new K$bc,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),K$Ec.stage.addChild(this._sprite)),this._sprite.x=K$c+this.resultMatrix.tx,this._sprite.y=K$P+this.resultMatrix.ty);var K$q,K$_=0;for(K$_=0,K$q=this._children.length;K$_<K$q;K$_++)this._children[K$_].updateDraw(K$c,K$P)},K$c.addChild=function(K$c){this._children.push(K$c),K$c.parentBone=this},K$c.findBone=function(K$c){if(this.name==K$c)return this;var K$P,K$q,K$_=0;for(K$_=0,K$P=this._children.length;K$_<K$P;K$_++)if(K$q=this._children[K$_].findBone(K$c))return K$q;return null},K$c.localToWorld=function(K$c){var K$P=K$c[0],K$q=K$c[1];K$c[0]=K$P*this.resultMatrix.a+K$q*this.resultMatrix.c+this.resultMatrix.tx,K$c[1]=K$P*this.resultMatrix.b+K$q*this.resultMatrix.d+this.resultMatrix.ty},K$E.ShowBones={},K$E}()),K$Cc=function(){function K$W(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}K$_(K$W,"laya.ani.bone.BoneSlot");var K$c=K$W.prototype;return K$c.showSlotData=function(K$c,K$P){void 0===K$P&&(K$P=!0),this.currSlotData=K$c,K$P&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},K$c.showDisplayByName=function(K$c){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(K$c))},K$c.replaceDisplayByName=function(K$c,K$P){if(this.currSlotData){var K$q;K$q=this.currSlotData.getDisplayByName(K$c);var K$_;K$_=this.currSlotData.getDisplayByName(K$P),this.replaceDisplayByIndex(K$q,K$_)}},K$c.replaceDisplayByIndex=function(K$c,K$P){this.currSlotData&&(this._replaceDic[K$c]=K$P,this.displayIndex==K$c&&this.showDisplayByIndex(K$c))},K$c.showDisplayByIndex=function(K$c){if(null!=this._replaceDic[K$c]&&(K$c=this._replaceDic[K$c]),this.currSlotData&&-1<K$c&&K$c<this.currSlotData.displayArr.length){if(this.displayIndex=K$c,this.currDisplayData=this.currSlotData.displayArr[K$c],this.currDisplayData){var K$P=this.currDisplayData.name;this.currTexture=this.templet.getTexture(K$P),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!K$w.isConchApp||K$w.isConchApp&&"0.9.15"<K$bc.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},K$c.replaceSkin=function(K$c){this._diyTexture=K$c,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},K$c.setParentMatrix=function(K$c){this._parentMatrix=K$c},K$c.draw=function(K$c,K$P,K$q,K$_){if(void 0===K$q&&(K$q=!1),void 0===K$_&&(K$_=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var K$E,K$b=this.currTexture;switch(this._diyTexture&&(K$b=this._diyTexture),this.currDisplayData.type){case 0:if(K$c){var K$e=this.getDisplayMatrix();if(this._parentMatrix){var K$h=!1;if(K$e){var K$Z;if(K$Vc.mul(K$e,this._parentMatrix,K$Vc.TEMP),K$Z=K$q?(null==this._resultMatrix&&(this._resultMatrix=new K$Vc),this._resultMatrix):new K$Vc,!K$w.isWebGL&&this.currDisplayData.uvs||K$w.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var K$S=K$W._tempMatrix;K$S.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(K$S.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(K$h=!0,K$S.rotate(-Math.PI/2)),K$Vc.mul(K$S,K$Vc.TEMP,K$Z)}else K$Vc.TEMP.copyTo(K$Z);K$h?K$c.drawTexture(K$b,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,K$Z):K$c.drawTexture(K$b,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,K$Z)}}}break;case 1:if(null==(K$E=K$q?(null==this._skinSprite&&(this._skinSprite=K$W.createSkinMesh()),this._skinSprite):K$W.createSkinMesh()))return;var K$n;if(null==this.currDisplayData.bones){var K$k,K$x=this.currDisplayData.weights;this.deformData&&(K$x=this.deformData),K$k=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=K$H.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=K$H.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=K$x;this.currDisplayData.triangles.length;K$n=this.currDisplayData.triangles,K$E.init2(K$b,null,K$n,this._mVerticleArr,K$k);var K$r,K$g=this.getDisplayMatrix();if(this._parentMatrix)if(K$g)K$Vc.mul(K$g,this._parentMatrix,K$Vc.TEMP),K$r=K$q?(null==this._resultMatrix&&(this._resultMatrix=new K$Vc),this._resultMatrix):new K$Vc,K$Vc.TEMP.copyTo(K$r),K$E.transform=K$r}else this.skinMesh(K$P,K$E,K$_);K$c.drawSkin(K$E);break;case 2:if(null==(K$E=K$q?(null==this._skinSprite&&(this._skinSprite=K$W.createSkinMesh()),this._skinSprite):K$W.createSkinMesh()))return;this.skinMesh(K$P,K$E,K$_),K$c.drawSkin(K$E)}}},K$c.skinMesh=function(K$c,K$P,K$q){var K$_,K$E=this.currTexture,K$b=this.currDisplayData.bones;K$_=this._diyTexture?(K$E=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=K$H.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=K$H.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var K$e,K$h,K$Z=this.currDisplayData.weights,K$S=this.currDisplayData.triangles,K$n=0,K$k=0,K$x=0,K$r=NaN,K$g=NaN,K$W=0,K$w=0,K$O=[],K$N=0,K$m=0;if(this.deformData&&0<this.deformData.length){var K$T=0;for(K$N=0,K$m=K$b.length;K$N<K$m;){for(K$x=K$b[K$N++]+K$N,K$k=K$n=0;K$N<K$x;K$N++)K$h=K$c[K$b[K$N]],K$r=K$Z[K$W]+this.deformData[K$T++],K$g=K$Z[K$W+1]+this.deformData[K$T++],K$w=K$Z[K$W+2],K$n+=(K$r*K$h.a+K$g*K$h.c+K$h.tx)*K$w,K$k+=(K$r*K$h.b+K$g*K$h.d+K$h.ty)*K$w,K$W+=3;K$O.push(K$n,K$k)}}else for(K$N=0,K$m=K$b.length;K$N<K$m;){for(K$x=K$b[K$N++]+K$N,K$k=K$n=0;K$N<K$x;K$N++)K$h=K$c[K$b[K$N]],K$r=K$Z[K$W],K$g=K$Z[K$W+1],K$w=K$Z[K$W+2],K$n+=(K$r*K$h.a+K$g*K$h.c+K$h.tx)*K$w,K$k+=(K$r*K$h.b+K$g*K$h.d+K$h.ty)*K$w,K$W+=3;K$O.push(K$n,K$k)}this._mVerticleArr=K$O,K$e=K$S,K$P.init2(K$E,null,K$e,this._mVerticleArr,K$_)},K$c.drawBonePoint=function(K$c){K$c&&this._parentMatrix&&K$c.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},K$c.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},K$c.getMatrix=function(){return this._resultMatrix},K$c.copy=function(){var K$c=new K$W;return K$c.type="copy",K$c.name=this.name,K$c.attachmentName=this.attachmentName,K$c.srcDisplayIndex=this.srcDisplayIndex,K$c.parent=this.parent,K$c.displayIndex=this.displayIndex,K$c.templet=this.templet,K$c.currSlotData=this.currSlotData,K$c.currTexture=this.currTexture,K$c.currDisplayData=this.currDisplayData,K$c},K$W.createSkinMesh=function(){return K$w.isWebGL||K$w.isConchApp?K$r.skinAniSprite():(K$w.isWebGL,null)},K$q(K$W,["_tempMatrix",function(){return this._tempMatrix=new K$Vc}]),K$W}(),K$Fc=function(){function K$c(){this.skinName=null,this.deformSlotDataList=[]}return K$_(K$c,"laya.ani.bone.DeformAniData"),K$c}(),K$oc=function(){function K$c(){this.deformSlotDisplayList=[]}return K$_(K$c,"laya.ani.bone.DeformSlotData"),K$c}(),K$ac=function(){function K$c(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}K$_(K$c,"laya.ani.bone.DeformSlotDisplayData");var K$P=K$c.prototype;return K$P.binarySearch1=function(K$c,K$P){var K$q=0,K$_=K$c.length-2;if(0==K$_)return 1;for(var K$E=K$_>>>1;;){if(K$c[Math.floor(K$E+1)]<=K$P?K$q=K$E+1:K$_=K$E,K$q==K$_)return K$q+1;K$E=K$q+K$_>>>1}return 0},K$P.apply=function(K$c,K$P,K$q){if(void 0===K$q&&(K$q=1),K$c+=.05,!(this.timeList.length<=0)){var K$_=0;if(!(K$c<this.timeList[0])){var K$E=this.vectices[0].length,K$b=[],K$e=this.binarySearch1(this.timeList,K$c);if(this.frameIndex=K$e,K$c>=this.timeList[this.timeList.length-1]){var K$h=this.vectices[this.vectices.length-1];if(K$q<1)for(K$_=0;K$_<K$E;K$_++)K$b[K$_]+=(K$h[K$_]-K$b[K$_])*K$q;else for(K$_=0;K$_<K$E;K$_++)K$b[K$_]=K$h[K$_];this.deformData=K$b}else{this.tweenKeyList[this.frameIndex];var K$Z=this.vectices[this.frameIndex-1],K$S=this.vectices[this.frameIndex],K$n=this.timeList[this.frameIndex-1],K$k=this.timeList[this.frameIndex];K$q=this.tweenKeyList[K$e-1]?(K$c-K$n)/(K$k-K$n):0;var K$x=NaN;for(K$_=0;K$_<K$E;K$_++)K$x=K$Z[K$_],K$b[K$_]=K$x+(K$S[K$_]-K$x)*K$q;this.deformData=K$b}}}},K$c}(),K$Yc=function(){function K$c(){this.time=NaN,this.drawOrder=[]}return K$_(K$c,"laya.ani.bone.DrawOrderData"),K$c}(),K$sc=function(){function K$c(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return K$_(K$c,"laya.ani.bone.EventData"),K$c}(),K$N=function(){function K$_c(K$c,K$P){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=K$c,this._targetBone=K$P[K$c.targetBoneIndex],this.isSpine=K$c.isSpine,null==this._bones&&(this._bones=[]);for(var K$q=this._bones.length=0,K$_=K$c.boneIndexs.length;K$q<K$_;K$q++)this._bones.push(K$P[K$c.boneIndexs[K$q]]);this.name=K$c.name,this.mix=K$c.mix,this.bendDirection=K$c.bendDirection}K$_(K$_c,"laya.ani.bone.IkConstraint");var K$c=K$_c.prototype;return K$c.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},K$c._applyIk1=function(K$c,K$P,K$q,K$_){var K$E=K$c.parentBone,K$b=1/(K$E.resultMatrix.a*K$E.resultMatrix.d-K$E.resultMatrix.b*K$E.resultMatrix.c),K$e=K$P-K$E.resultMatrix.tx,K$h=K$q-K$E.resultMatrix.ty,K$Z=(K$e*K$E.resultMatrix.d-K$h*K$E.resultMatrix.c)*K$b-K$c.transform.x,K$S=(K$h*K$E.resultMatrix.a-K$e*K$E.resultMatrix.b)*K$b-K$c.transform.y,K$n=Math.atan2(K$S,K$Z)*K$_c.radDeg-0-K$c.transform.skX;K$c.transform.scX<0&&(K$n+=180),180<K$n?K$n-=360:K$n<-180&&(K$n+=360),K$c.transform.skX=K$c.transform.skY=K$c.transform.skX+K$n*K$_,K$c.update()},K$c.updatePos=function(K$c,K$P){this._sp&&this._sp.pos(K$c,K$P)},K$c._applyIk2=function(K$c,K$P,K$q,K$_,K$E,K$b){if(0!=K$b){var K$e=K$c.resultTransform.x,K$h=K$c.resultTransform.y,K$Z=K$c.transform.scX,K$S=K$c.transform.scY,K$n=K$P.transform.scX,K$k=0,K$x=0,K$r=0;K$r=K$Z<0?(K$Z=-K$Z,K$k=180,-1):(K$k=0,1),K$S<0&&(K$S=-K$S,K$r=-K$r),K$x=K$n<0?(K$n=-K$n,180):0;var K$g=K$P.resultTransform.x,K$W=NaN,K$w=NaN,K$O=NaN,K$N=K$c.resultMatrix.a,K$m=K$c.resultMatrix.c,K$T=K$c.resultMatrix.b,K$D=K$c.resultMatrix.d,K$L=Math.abs(K$Z-K$S)<=1e-4;K$O=K$L?(K$w=K$N*K$g+K$m*(K$W=K$P.resultTransform.y)+K$c.resultMatrix.tx,K$T*K$g+K$D*K$W+K$c.resultMatrix.ty):(K$W=0,K$w=K$N*K$g+K$c.resultMatrix.tx,K$T*K$g+K$c.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new K$bc,K$Ec.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(K$q,K$_,15,"#ffff00"),this._sp.graphics.drawCircle(K$w,K$O,15,"#ff00ff")),K$c.setRotation(Math.atan2(K$O-K$c.resultMatrix.ty,K$w-K$c.resultMatrix.tx));var K$H=K$c.parentBone;K$N=K$H.resultMatrix.a,K$m=K$H.resultMatrix.c,K$T=K$H.resultMatrix.b;var K$Q=1/(K$N*(K$D=K$H.resultMatrix.d)-K$m*K$T),K$d=K$q-K$H.resultMatrix.tx,K$u=K$_-K$H.resultMatrix.ty,K$A=(K$d*K$D-K$u*K$m)*K$Q-K$e,K$J=(K$u*K$N-K$d*K$T)*K$Q-K$h,K$j=((K$d=K$w-K$H.resultMatrix.tx)*K$D-(K$u=K$O-K$H.resultMatrix.ty)*K$m)*K$Q-K$e,K$V=(K$u*K$N-K$d*K$T)*K$Q-K$h,K$R=Math.sqrt(K$j*K$j+K$V*K$V),K$$=K$P.length*K$n,K$C=NaN,K$F=NaN;if(K$L){var K$o=(K$A*K$A+K$J*K$J-K$R*K$R-(K$$*=K$Z)*K$$)/(2*K$R*K$$);K$o<-1?K$o=-1:1<K$o&&(K$o=1),K$F=Math.acos(K$o)*K$E,K$N=K$R+K$$*K$o,K$m=K$$*Math.sin(K$F),K$C=Math.atan2(K$J*K$N-K$A*K$m,K$A*K$N+K$J*K$m)}else{var K$a=(K$N=K$Z*K$$)*K$N,K$Y=(K$m=K$S*K$$)*K$m,K$s=K$A*K$A+K$J*K$J,K$U=Math.atan2(K$J,K$A),K$I=-2*K$Y*K$R,K$v=K$Y-K$a;if(0<(K$D=K$I*K$I-4*K$v*(K$T=K$Y*K$R*K$R+K$a*K$s-K$a*K$Y))){var K$y=Math.sqrt(K$D);K$I<0&&(K$y=-K$y);var K$M=(K$y=-(K$I+K$y)/2)/K$v,K$z=K$T/K$y,K$X=Math.abs(K$M)<Math.abs(K$z)?K$M:K$z;K$X*K$X<=K$s&&(K$u=Math.sqrt(K$s-K$X*K$X)*K$E,K$C=K$U-Math.atan2(K$u,K$X),K$F=Math.atan2(K$u/K$S,(K$X-K$R)/K$Z))}var K$f=0,K$l=Number.MAX_VALUE,K$t=0,K$B=0,K$p=0,K$i=0,K$K=0,K$G=0;K$i<(K$D=(K$d=K$R+K$N)*K$d)&&(K$p=0,K$i=K$D,K$K=K$d),(K$D=(K$d=K$R-K$N)*K$d)<K$l&&(K$f=Math.PI,K$l=K$D,K$t=K$d);var K$cc=Math.acos(-K$N*K$R/(K$a-K$Y));(K$D=(K$d=K$N*Math.cos(K$cc)+K$R)*K$d+(K$u=K$m*Math.sin(K$cc))*K$u)<K$l&&(K$f=K$cc,K$l=K$D,K$t=K$d,K$B=K$u),K$i<K$D&&(K$p=K$cc,K$i=K$D,K$K=K$d,K$G=K$u),K$F=K$s<=(K$l+K$i)/2?(K$C=K$U-Math.atan2(K$B*K$E,K$t),K$f*K$E):(K$C=K$U-Math.atan2(K$G*K$E,K$K),K$p*K$E)}var K$Pc=Math.atan2(K$W,K$g)*K$r,K$qc=K$c.resultTransform.skX;180<(K$C=(K$C-K$Pc)*K$_c.radDeg+K$k-K$qc)?K$C-=360:K$C<-180&&(K$C+=360),K$c.resultTransform.x=K$e,K$c.resultTransform.y=K$h,K$c.resultTransform.skX=K$c.resultTransform.skY=K$qc+K$C*K$b,K$qc=K$P.resultTransform.skX,180<(K$F=((K$F+K$Pc)*K$_c.radDeg-0)*K$r+K$x-(K$qc%=360))?K$F-=360:K$F<-180&&(K$F+=360),K$P.resultTransform.x=K$g,K$P.resultTransform.y=K$W,K$P.resultTransform.skX=K$P.resultTransform.skY=K$P.resultTransform.skY+K$F*K$b,K$c.update()}},K$c._applyIk3=function(K$c,K$P,K$q,K$_,K$E,K$b){if(0!=K$b){var K$e,K$h,K$Z=K$P.resultMatrix.a*K$P.length,K$S=K$P.resultMatrix.b*K$P.length,K$n=K$Z*K$Z+K$S*K$S,K$k=Math.sqrt(K$n),K$x=K$c.resultMatrix.tx,K$r=K$c.resultMatrix.ty,K$g=K$P.resultMatrix.tx,K$W=K$P.resultMatrix.ty,K$w=K$g-K$x,K$O=K$W-K$r,K$N=K$w*K$w+K$O*K$O,K$m=Math.sqrt(K$N),K$T=(K$w=K$q-K$c.resultMatrix.tx)*K$w+(K$O=K$_-K$c.resultMatrix.ty)*K$O,K$D=Math.sqrt(K$T);if(K$k+K$m<=K$D||K$D+K$k<=K$m||K$D+K$m<=K$k){var K$L=NaN;K$g=K$x+(K$L=K$k+K$m<=K$D?1:-1)*(K$q-K$x)*K$m/K$D,K$W=K$r+K$L*(K$_-K$r)*K$m/K$D}else{var K$H=(K$N-K$n+K$T)/(2*K$T),K$Q=Math.sqrt(K$N-K$H*K$H*K$T)/K$D,K$d=K$x+K$w*K$H,K$u=K$r+K$O*K$H,K$A=-K$O*K$Q,K$J=K$w*K$Q;K$W=0<K$E?(K$g=K$d-K$A,K$u-K$J):(K$g=K$d+K$A,K$u+K$J)}K$e=K$g,K$h=K$W,this.isDebug&&(this._sp||(this._sp=new K$bc,K$Ec.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(K$x,K$r,15,"#ff00ff"),this._sp.graphics.drawCircle(K$q,K$_,15,"#ffff00"),this._sp.graphics.drawCircle(K$e,K$h,15,"#ff00ff"));var K$j,K$V;K$j=Math.atan2(K$h-K$c.resultMatrix.ty,K$e-K$c.resultMatrix.tx),K$c.setRotation(K$j),(K$V=K$_c._tempMatrix).identity(),K$V.rotate(K$j),K$V.scale(K$c.resultMatrix.getScaleX(),K$c.resultMatrix.getScaleY()),K$V.translate(K$c.resultMatrix.tx,K$c.resultMatrix.ty),K$V.copyTo(K$c.resultMatrix),K$c.updateChild();var K$R,K$$;K$R=Math.atan2(K$_-K$h,K$q-K$e),K$P.setRotation(K$R),(K$$=K$_c._tempMatrix).identity(),K$$.rotate(K$R),K$$.scale(K$P.resultMatrix.getScaleX(),K$P.resultMatrix.getScaleY()),K$$.translate(K$e,K$h),K$V.copyTo(K$P.resultMatrix),K$P.updateChild()}},K$q(K$_c,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new K$Vc}]),K$_c}(),K$Uc=function(){function K$c(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return K$_(K$c,"laya.ani.bone.IkConstraintData"),K$c}(),K$D=function(){function K$$(K$c,K$P){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=K$c,this.position=K$c.position,this.spacing=K$c.spacing,this.rotateMix=K$c.rotateMix,this.translateMix=K$c.translateMix,this.bones=[];for(var K$q=this.data.bones,K$_=0,K$E=K$q.length;K$_<K$E;K$_++)this.bones.push(K$P[K$q[K$_]])}K$_(K$$,"laya.ani.bone.PathConstraint");var K$c=K$$.prototype;return K$c.apply=function(K$c,K$P){if(this.target){var K$q=this.translateMix,K$_=this.translateMix,K$E=0<K$_,K$b=this.data.spacingMode,K$e="length"==K$b,K$h=this.data.rotateMode,K$Z="tangent"==K$h,K$S="chainScale"==K$h,K$n=[],K$k=this.bones.length,K$x=K$Z?K$k:K$k+1,K$r=[];(this._spaces=K$r)[0]=this.position;var K$g=this.spacing;if(K$S||K$e)for(var K$W=0,K$w=K$x-1;K$W<K$w;){var K$O=this.bones[K$W],K$N=K$O.length,K$m=K$N*K$O.resultMatrix.a,K$T=K$N*K$O.resultMatrix.b;K$N=Math.sqrt(K$m*K$m+K$T*K$T),K$S&&(K$n[K$W]=K$N),K$r[++K$W]=K$e?Math.max(0,K$N+K$g):K$g}else for(K$W=1;K$W<K$x;K$W++)K$r[K$W]=K$g;var K$D=this.computeWorldPositions(this.target,K$c,K$P,K$x,K$Z,"percent"==this.data.positionMode,"percent"==K$b);if(this._debugKey){for(K$W=0;K$W<K$D.length;K$W++)K$P.drawCircle(K$D[K$W++],K$D[K$W++],5,"#00ff00");var K$L=[];for(K$W=0;K$W<K$D.length;K$W++)K$L.push(K$D[K$W++],K$D[K$W++]);K$P.drawLines(0,0,K$L,"#ff0000")}var K$H=K$D[0],K$Q=K$D[1],K$d=this.data.offsetRotation,K$u="chain"==K$h&&0==K$d,K$A=NaN;for(K$W=0,K$A=3;K$W<K$k;K$W++,K$A+=3){(K$O=this.bones[K$W]).resultMatrix.tx+=(K$H-K$O.resultMatrix.tx)*K$q,K$O.resultMatrix.ty+=(K$Q-K$O.resultMatrix.ty)*K$q;var K$J=(K$m=K$D[K$A])-K$H,K$j=(K$T=K$D[K$A+1])-K$Q;if(K$S&&0!=(K$N=K$n[K$W])){var K$V=(Math.sqrt(K$J*K$J+K$j*K$j)/K$N-1)*K$_+1;K$O.resultMatrix.a*=K$V,K$O.resultMatrix.c*=K$V}if(K$H=K$m,K$Q=K$T,K$E){var K$R=K$O.resultMatrix.a,K$$=K$O.resultMatrix.c,K$C=K$O.resultMatrix.b,K$F=K$O.resultMatrix.d,K$o=NaN,K$a=NaN,K$Y=NaN;K$o=K$Z?K$D[K$A-1]:0==K$r[K$W+1]?K$D[K$A+2]:Math.atan2(K$j,K$J),K$o-=Math.atan2(K$C,K$R)-K$d/180*Math.PI,K$u&&(K$a=Math.cos(K$o),K$Y=Math.sin(K$o),K$H+=((K$N=K$O.length)*(K$a*K$R-K$Y*K$C)-K$J)*K$_,K$Q+=(K$N*(K$Y*K$R+K$a*K$C)-K$j)*K$_),K$o>Math.PI?K$o-=2*Math.PI:K$o<-Math.PI&&(K$o+=2*Math.PI),K$o*=K$_,K$a=Math.cos(K$o),K$Y=Math.sin(K$o),K$O.resultMatrix.a=K$a*K$R-K$Y*K$C,K$O.resultMatrix.c=K$a*K$$-K$Y*K$F,K$O.resultMatrix.b=K$Y*K$R+K$a*K$C,K$O.resultMatrix.d=K$Y*K$$+K$a*K$F}}}},K$c.computeWorldVertices2=function(K$c,K$P,K$q,K$_,K$E,K$b){var K$e,K$h,K$Z=K$c.currDisplayData.bones,K$S=K$c.currDisplayData.weights,K$n=K$c.currDisplayData.triangles,K$k=0,K$x=0,K$r=0,K$g=0,K$W=0,K$w=0,K$O=0,K$N=0,K$m=0,K$T=0,K$D=0;if(null!=K$Z){for(K$k=0;K$k<K$q;K$k+=2)K$x+=(K$g=K$Z[K$x])+1,K$r+=K$g;var K$L=K$P;for(K$W=K$b,K$w=3*K$r;K$W<K$_;K$W+=2){for(K$N=K$O=0,K$g=K$Z[K$x++],K$g+=K$x;K$x<K$g;K$x++,K$w+=3){K$e=K$L[K$Z[K$x]].resultMatrix,K$m=K$S[K$w],K$T=K$S[K$w+1];var K$H=K$S[K$w+2];K$O+=(K$m*K$e.a+K$T*K$e.c+K$e.tx)*K$H,K$N+=(K$m*K$e.b+K$T*K$e.d+K$e.ty)*K$H}K$E[K$W]=K$O,K$E[K$W+1]=K$N}}else{var K$Q,K$d;if(K$n||(K$n=K$S),K$c.deformData&&(K$n=K$c.deformData),K$Q=K$c.parent,K$P)for(K$D=K$P.length,K$k=0;K$k<K$D;K$k++)if(K$P[K$k].name==K$Q){K$h=K$P[K$k];break}K$h&&(K$d=K$h.resultMatrix),K$d||(K$d=K$$._tempMt);var K$u=K$d.tx,K$A=K$d.ty,K$J=K$d.a,K$j=K$d.b,K$V=K$d.c,K$R=K$d.d;for(K$h&&(K$R*=K$h.d),K$x=K$q,K$W=K$b;K$W<K$_;K$x+=2,K$W+=2)K$m=K$n[K$x],K$T=K$n[K$x+1],K$E[K$W]=K$m*K$J+K$T*K$j+K$u,K$E[K$W+1]=-(K$m*K$V+K$T*K$R+K$A)}},K$c.computeWorldPositions=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e){K$c.currDisplayData.bones,K$c.currDisplayData.weights,K$c.currDisplayData.triangles;var K$h=[],K$Z=0,K$S=K$c.currDisplayData.verLen,K$n=this.position,K$k=this._spaces,K$x=[],K$r=[],K$g=K$S/6,K$W=-1,K$w=NaN,K$O=0,K$N=0,K$m=NaN,K$T=NaN,K$D=NaN,K$L=NaN;if(K$g--,K$S-=4,this.computeWorldVertices2(K$c,K$P,2,K$S,K$h,0),this._debugKey)for(K$Z=0;K$Z<K$h.length;)K$q.drawCircle(K$h[K$Z++],K$h[K$Z++],10,"#ff0000");K$x=K$h,this._curves.length=K$g;var K$H=this._curves,K$Q=K$x[K$w=0],K$d=K$x[1],K$u=0,K$A=0,K$J=0,K$j=0,K$V=0,K$R=0,K$$=NaN,K$C=NaN,K$F=NaN,K$o=NaN,K$a=NaN,K$Y=NaN,K$s=NaN,K$U=NaN,K$I=0;for(K$Z=0,K$I=2;K$Z<K$g;K$Z++,K$I+=6)K$u=K$x[K$I],K$A=K$x[K$I+1],K$J=K$x[K$I+2],K$j=K$x[K$I+3],K$a=2*(K$$=.1875*(K$Q-2*K$u+K$J))+(K$F=.09375*(3*(K$u-K$J)-K$Q+(K$V=K$x[K$I+4]))),K$Y=2*(K$C=.1875*(K$d-2*K$A+K$j))+(K$o=.09375*(3*(K$A-K$j)-K$d+(K$R=K$x[K$I+5]))),K$s=.75*(K$u-K$Q)+K$$+.16666667*K$F,K$U=.75*(K$A-K$d)+K$C+.16666667*K$o,K$w+=Math.sqrt(K$s*K$s+K$U*K$U),K$s+=K$a,K$U+=K$Y,K$a+=K$F,K$Y+=K$o,K$w+=Math.sqrt(K$s*K$s+K$U*K$U),K$s+=K$a,K$U+=K$Y,K$w+=Math.sqrt(K$s*K$s+K$U*K$U),K$s+=K$a+K$F,K$U+=K$Y+K$o,K$w+=Math.sqrt(K$s*K$s+K$U*K$U),K$H[K$Z]=K$w,K$Q=K$V,K$d=K$R;if(K$b&&(K$n*=K$w),K$e)for(K$Z=0;K$Z<K$_;K$Z++)K$k[K$Z]*=K$w;var K$v=this._segments,K$y=0,K$M=0;for(K$M=K$N=K$O=K$Z=0;K$Z<K$_;K$Z++,K$O+=3)if((K$m=K$n+=K$T=K$k[K$Z])<0)this.addBeforePosition(K$m,K$x,0,K$r,K$O);else if(K$w<K$m)this.addAfterPosition(K$m-K$w,K$x,K$S-4,K$r,K$O);else{for(;;K$N++)if(!((K$L=K$H[K$N])<K$m)){0==K$N?K$m/=K$L:K$m=(K$m-(K$D=K$H[K$N-1]))/(K$L-K$D);break}if(K$N!=K$W){var K$z=6*(K$W=K$N);for(K$Q=K$x[K$z],K$d=K$x[K$z+1],K$u=K$x[K$z+2],K$A=K$x[K$z+3],K$J=K$x[K$z+4],K$j=K$x[K$z+5],K$a=2*(K$$=.03*(K$Q-2*K$u+K$J))+(K$F=.006*(3*(K$u-K$J)-K$Q+(K$V=K$x[K$z+6]))),K$Y=2*(K$C=.03*(K$d-2*K$A+K$j))+(K$o=.006*(3*(K$A-K$j)-K$d+(K$R=K$x[K$z+7]))),K$s=.3*(K$u-K$Q)+K$$+.16666667*K$F,K$U=.3*(K$A-K$d)+K$C+.16666667*K$o,K$y=Math.sqrt(K$s*K$s+K$U*K$U),K$v[0]=K$y,K$z=1;K$z<8;K$z++)K$s+=K$a,K$U+=K$Y,K$a+=K$F,K$Y+=K$o,K$y+=Math.sqrt(K$s*K$s+K$U*K$U),K$v[K$z]=K$y;K$s+=K$a,K$U+=K$Y,K$y+=Math.sqrt(K$s*K$s+K$U*K$U),K$v[8]=K$y,K$s+=K$a+K$F,K$U+=K$Y+K$o,K$y+=Math.sqrt(K$s*K$s+K$U*K$U),K$v[9]=K$y,K$M=0}for(K$m*=K$y;;K$M++)if(!((K$L=K$v[K$M])<K$m)){0==K$M?K$m/=K$L:K$m=K$M+(K$m-(K$D=K$v[K$M-1]))/(K$L-K$D);break}this.addCurvePosition(.1*K$m,K$Q,K$d,K$u,K$A,K$J,K$j,K$V,K$R,K$r,K$O,K$E||0<K$Z&&0==K$T)}return K$r},K$c.addBeforePosition=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$P[K$q],K$e=K$P[K$q+1],K$h=K$P[K$q+2]-K$b,K$Z=K$P[K$q+3]-K$e,K$S=Math.atan2(K$Z,K$h);K$_[K$E]=K$b+K$c*Math.cos(K$S),K$_[K$E+1]=K$e+K$c*Math.sin(K$S),K$_[K$E+2]=K$S},K$c.addAfterPosition=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$P[K$q+2],K$e=K$P[K$q+3],K$h=K$b-K$P[K$q],K$Z=K$e-K$P[K$q+1],K$S=Math.atan2(K$Z,K$h);K$_[K$E]=K$b+K$c*Math.cos(K$S),K$_[K$E+1]=K$e+K$c*Math.sin(K$S),K$_[K$E+2]=K$S},K$c.addCurvePosition=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n,K$k){0==K$c&&(K$c=1e-4);var K$x=K$c*K$c,K$r=K$x*K$c,K$g=1-K$c,K$W=K$g*K$g,K$w=K$W*K$g,K$O=K$g*K$c,K$N=3*K$O,K$m=K$g*K$N,K$T=K$N*K$c,K$D=K$P*K$w+K$_*K$m+K$b*K$T+K$h*K$r,K$L=K$q*K$w+K$E*K$m+K$e*K$T+K$Z*K$r;K$S[K$n]=K$D,K$S[K$n+1]=K$L,K$S[K$n+2]=K$k?Math.atan2(K$L-(K$q*K$W+K$E*K$O*2+K$e*K$x),K$D-(K$P*K$W+K$_*K$O*2+K$b*K$x)):0},K$$.NONE=-1,K$$.BEFORE=-2,K$$.AFTER=-3,K$q(K$$,["_tempMt",function(){return this._tempMt=new K$Vc}]),K$$}(),K$Ic=function(){function K$c(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return K$_(K$c,"laya.ani.bone.PathConstraintData"),K$c}(),K$vc=function(){function K$c(){this.name=null,this.slotArr=[]}return K$_(K$c,"laya.ani.bone.SkinData"),K$c}(),K$yc=function(){function K$c(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}K$_(K$c,"laya.ani.bone.SkinSlotDisplayData");var K$P=K$c.prototype;return K$P.createTexture=function(K$c){return this.texture||(this.texture=new K$Rc(K$c.bitmap,this.uvs),K$c.bitmap.alphaTexture&&(this.texture.alphaTexture=new K$Rc(K$c.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=K$c.height,this.texture.height=K$c.width,this.texture.offsetX=-K$c.offsetX,this.texture.offsetY=-K$c.offsetY,this.texture.sourceWidth=K$c.sourceHeight,this.texture.sourceHeight=K$c.sourceWidth):(this.texture.width=K$c.width,this.texture.height=K$c.height,this.texture.offsetX=-K$c.offsetX,this.texture.offsetY=-K$c.offsetY,this.texture.sourceWidth=K$c.sourceWidth,this.texture.sourceHeight=K$c.sourceHeight),K$w.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},K$P.destory=function(){this.texture&&this.texture.destroy()},K$c}(),K$Mc=function(){function K$c(){this.name=null,this.displayArr=[]}return K$_(K$c,"laya.ani.bone.SlotData"),K$c.prototype.getDisplayByName=function(K$c){for(var K$P=0,K$q=this.displayArr.length;K$P<K$q;K$P++)if(this.displayArr[K$P].attachmentName==K$c)return K$P;return-1},K$c}(),K$L=function(){function K$c(K$c,K$P){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=K$W(2,0),this._data=K$c,null==this._bones&&(this._bones=[]),this.target=K$P[K$c.targetIndex];var K$q,K$_=0;for(K$_=0,K$q=K$c.boneIndexs.length;K$_<K$q;K$_++)this._bones.push(K$P[K$c.boneIndexs[K$_]]);this.rotateMix=K$c.rotateMix,this.translateMix=K$c.translateMix,this.scaleMix=K$c.scaleMix,this.shearMix=K$c.shearMix}return K$_(K$c,"laya.ani.bone.TfConstraint"),K$c.prototype.apply=function(){for(var K$c,K$P=this.target.resultMatrix.a,K$q=this.target.resultMatrix.b,K$_=this.target.resultMatrix.c,K$E=this.target.resultMatrix.d,K$b=0,K$e=this._bones.length;K$b<K$e;K$b++){if(K$c=this._bones[K$b],0<this.rotateMix){var K$h=K$c.resultMatrix.a,K$Z=K$c.resultMatrix.b,K$S=K$c.resultMatrix.c,K$n=K$c.resultMatrix.d,K$k=Math.atan2(K$_,K$P)-Math.atan2(K$S,K$h)+this._data.offsetRotation*Math.PI/180;K$k>Math.PI?K$k-=2*Math.PI:K$k<-Math.PI&&(K$k+=2*Math.PI),K$k*=this.rotateMix;var K$x=Math.cos(K$k),K$r=Math.sin(K$k);K$c.resultMatrix.a=K$x*K$h-K$r*K$S,K$c.resultMatrix.b=K$x*K$Z-K$r*K$n,K$c.resultMatrix.c=K$r*K$h+K$x*K$S,K$c.resultMatrix.d=K$r*K$Z+K$x*K$n}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),K$c.resultMatrix.tx+=(this._temp[0]-K$c.resultMatrix.tx)*this.translateMix,K$c.resultMatrix.ty+=(this._temp[1]-K$c.resultMatrix.ty)*this.translateMix,K$c.updateChild()),0<this.scaleMix){var K$g=Math.sqrt(K$c.resultMatrix.a*K$c.resultMatrix.a+K$c.resultMatrix.c*K$c.resultMatrix.c),K$W=Math.sqrt(K$P*K$P+K$_*K$_),K$w=1e-5<K$g?(K$g+(K$W-K$g+this._data.offsetScaleX)*this.scaleMix)/K$g:0;K$c.resultMatrix.a*=K$w,K$c.resultMatrix.c*=K$w,K$g=Math.sqrt(K$c.resultMatrix.b*K$c.resultMatrix.b+K$c.resultMatrix.d*K$c.resultMatrix.d),K$W=Math.sqrt(K$q*K$q+K$E*K$E),K$w=1e-5<K$g?(K$g+(K$W-K$g+this._data.offsetScaleY)*this.scaleMix)/K$g:0,K$c.resultMatrix.b*=K$w,K$c.resultMatrix.d*=K$w}if(0<this.shearMix){K$Z=K$c.resultMatrix.b,K$n=K$c.resultMatrix.d;var K$O=Math.atan2(K$n,K$Z);(K$k=Math.atan2(K$E,K$q)-Math.atan2(K$_,K$P)-(K$O-Math.atan2(K$c.resultMatrix.c,K$c.resultMatrix.a)))>Math.PI?K$k-=2*Math.PI:K$k<-Math.PI&&(K$k+=2*Math.PI),K$k=K$O+(K$k+this._data.offsetShearY*Math.PI/180)*this.shearMix,K$w=Math.sqrt(K$Z*K$Z+K$n*K$n),K$c.resultMatrix.b=Math.cos(K$k)*K$w,K$c.resultMatrix.d=Math.sin(K$k)*K$w}}},K$c}(),K$zc=function(){function K$c(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return K$_(K$c,"laya.ani.bone.TfConstraintData"),K$c}(),K$Xc=function(){function K$c(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}K$_(K$c,"laya.ani.bone.Transform");var K$P=K$c.prototype;return K$P.initData=function(K$c){null!=K$c.x&&(this.x=K$c.x),null!=K$c.y&&(this.y=K$c.y),null!=K$c.skX&&(this.skX=K$c.skX),null!=K$c.skY&&(this.skY=K$c.skY),null!=K$c.scX&&(this.scX=K$c.scX),null!=K$c.scY&&(this.scY=K$c.scY)},K$P.getMatrix=function(){var K$c;return(K$c=this.mMatrix?this.mMatrix:this.mMatrix=new K$Vc).identity(),K$c.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(K$c,this.skewX*Math.PI/180,this.skewY*Math.PI/180),K$c.rotate(this.skX*Math.PI/180),K$c.translate(this.x,this.y),K$c},K$P.skew=function(K$c,K$P,K$q){var K$_=Math.sin(K$q),K$E=Math.cos(K$q),K$b=Math.sin(K$P),K$e=Math.cos(K$P);return K$c.setTo(K$c.a*K$e-K$c.b*K$_,K$c.a*K$b+K$c.b*K$E,K$c.c*K$e-K$c.d*K$_,K$c.c*K$b+K$c.d*K$E,K$c.tx*K$e-K$c.ty*K$_,K$c.tx*K$b+K$c.ty*K$E),K$c},K$c}(),K$H=function(){function K$c(){}return K$_(K$c,"laya.ani.bone.UVTools"),K$c.getRelativeUV=function(K$c,K$P,K$q){var K$_=K$c[0],K$E=K$c[2]-K$c[0],K$b=K$c[1],K$e=K$c[5]-K$c[1];K$q||(K$q=[]),K$q.length=K$P.length;var K$h,K$Z=0;K$h=K$q.length;var K$S=1/K$E,K$n=1/K$e;for(K$Z=0;K$Z<K$h;K$Z+=2)K$q[K$Z]=(K$P[K$Z]-K$_)*K$S,K$q[K$Z+1]=(K$P[K$Z+1]-K$b)*K$n;return K$q},K$c.getAbsoluteUV=function(K$c,K$P,K$q){if(0==K$c[0]&&0==K$c[1]&&1==K$c[4]&&1==K$c[5])return K$q?(K$O.copyArray(K$q,K$P),K$q):K$P;var K$_=K$c[0],K$E=K$c[2]-K$c[0],K$b=K$c[1],K$e=K$c[5]-K$c[1];K$q||(K$q=[]),K$q.length=K$P.length;var K$h,K$Z=0;for(K$h=K$q.length,K$Z=0;K$Z<K$h;K$Z+=2)K$q[K$Z]=K$P[K$Z]*K$E+K$_,K$q[K$Z+1]=K$P[K$Z+1]*K$e+K$b;return K$q},K$c}(),K$$=function(){function K$c(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return K$_(K$c,"laya.ani.KeyFramesContent"),K$c}(),K$Q=function(){function K$n(){}return K$_(K$n,"laya.ani.math.BezierLerp"),K$n.getBezierRate=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$n._getBezierParamKey(K$P,K$q,K$_,K$E),K$e=100*K$b+K$c;if(K$n._bezierResultCache[K$e])return K$n._bezierResultCache[K$e];var K$h,K$Z=K$n._getBezierPoints(K$P,K$q,K$_,K$E,K$b),K$S=0;for(K$h=K$Z.length,K$S=0;K$S<K$h;K$S+=2)if(K$c<=K$Z[K$S])return K$n._bezierResultCache[K$e]=K$Z[K$S+1],K$Z[K$S+1];return K$n._bezierResultCache[K$e]=1},K$n._getBezierParamKey=function(K$c,K$P,K$q,K$_){return 100*(100*(100*(100*K$c+K$P)+K$q)+K$_)},K$n._getBezierPoints=function(K$c,K$P,K$q,K$_,K$E){return K$n._bezierPointsCache[K$E]?K$n._bezierPointsCache[K$E]:(K$b=[0,0,K$c,K$P,K$q,K$_,1,1],K$e=(new K$h).getBezierPoints(K$b,100,3),K$n._bezierPointsCache[K$E]=K$e);var K$b,K$e},K$n._bezierResultCache={},K$n._bezierPointsCache={},K$n}(),K$d=function(K$c){function K$P(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,K$P.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}K$_(K$P,"laya.ani.AnimationPlayer",K$E);var K$q=K$P.prototype;return K$Ec.imps(K$q,{"laya.resource.IDestroy":!0}),K$q._onTempletLoadedComputeFullKeyframeIndices=function(K$c,K$P,K$q){this._templet===K$q&&this._cachePlayRate===K$c&&this._cacheFrameRate===K$P&&this._computeFullKeyframeIndices()},K$q._computeFullKeyframeIndices=function(){for(var K$c=this._fullFrames=[],K$P=this._templet,K$q=this._cacheFrameRateInterval*this._cachePlayRate,K$_=0,K$E=K$P.getAnimationCount();K$_<K$E;K$_++){for(var K$b=[],K$e=0,K$h=K$P.getAnimation(K$_).nodes.length;K$e<K$h;K$e++){for(var K$Z=K$P.getAnimation(K$_).nodes[K$e],K$S=Math.floor(K$Z.playTime/K$q+.01),K$n=new Uint16Array(K$S+1),K$k=-1,K$x=0,K$r=K$Z.keyFrame.length;K$x<K$r;K$x++){var K$g=K$Z.keyFrame[K$x],K$W=K$g.startTime,K$w=K$W+K$g.duration+K$q;do{for(var K$O=Math.floor(K$W/K$q+.5),K$N=K$k+1;K$N<K$O;K$N++)K$n[K$N]=K$x;K$n[K$k=K$O]=K$x,K$W+=K$q}while(K$W<=K$w)}K$b.push(K$n)}K$c.push(K$b)}},K$q._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},K$q._calculatePlayDuration=function(){if(0!==this.state){var K$c=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=K$c),this._playEnd>K$c&&(this._playEnd=K$c),this._playDuration=this._playEnd-this._playStart}},K$q._setPlayParams=function(K$c,K$P){this._currentTime=K$c,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/K$P+.01),0),this._currentFrameTime=this._currentKeyframeIndex*K$P},K$q._setPlayParamsWhenStop=function(K$c,K$P){this._currentTime=K$c,this._currentKeyframeIndex=Math.max(Math.floor(K$c/K$P+.01),0),this._currentFrameTime=this._currentKeyframeIndex*K$P,this._currentAnimationClipIndex=-1},K$q._update=function(K$c){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var K$P=this._cacheFrameRateInterval*this._cachePlayRate,K$q=0;this._startUpdateLoopCount!==K$g.loopCount&&(K$q=K$c*this.playbackRate,this._elapsedPlaybackTime+=K$q);var K$_=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=K$_)return this._setPlayParamsWhenStop(K$_,K$P),void this.event("stopped");if(K$q+=this._currentTime,0<K$_)if(K$_<=K$q)do{if(K$q-=K$_,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(K$_,K$P),this._stopWhenCircleFinish=!1,void this.event("stopped");K$q<K$_&&(this._setPlayParams(K$q,K$P),this.event("complete"))}while(K$_<=K$q);else this._setPlayParams(K$q,K$P);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(K$_,K$P),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},K$q._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},K$q.play=function(K$c,K$P,K$q,K$_,K$E){if(void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=1),void 0===K$q&&(K$q=2147483647),void 0===K$_&&(K$_=0),void 0===K$E&&(K$E=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(K$q<0||K$_<0||K$E<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==K$E&&K$E<K$_)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=K$P,this._overallDuration=K$q,this._playStart=K$_,this._playEnd=K$E,this._paused=!1,this._currentAnimationClipIndex=K$c,this._currentKeyframeIndex=0,this._startUpdateLoopCount=K$g.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},K$q.playByFrame=function(K$c,K$P,K$q,K$_,K$E,K$b){void 0===K$c&&(K$c=0),void 0===K$P&&(K$P=1),void 0===K$q&&(K$q=2147483647),void 0===K$_&&(K$_=0),void 0===K$E&&(K$E=0),void 0===K$b&&(K$b=30);var K$e=1e3/K$b;this.play(K$c,K$P,K$q,K$_*K$e,K$E*K$e)},K$q.stop=function(K$c){void 0===K$c&&(K$c=!0),K$c?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},K$b(0,K$q,"playEnd",function(){return this._playEnd}),K$b(0,K$q,"templet",function(){return this._templet},function(K$c){0===!this.state&&this.stop(!0),this._templet!==K$c&&((this._templet=K$c).loaded?this._computeFullKeyframeIndices():K$c.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),K$b(0,K$q,"playStart",function(){return this._playStart}),K$b(0,K$q,"playDuration",function(){return this._playDuration}),K$b(0,K$q,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),K$b(0,K$q,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),K$b(0,K$q,"overallDuration",function(){return this._overallDuration}),K$b(0,K$q,"currentFrameTime",function(){return this._currentFrameTime}),K$b(0,K$q,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),K$b(0,K$q,"currentPlayTime",function(){return this._currentTime+this._playStart}),K$b(0,K$q,"cachePlayRate",function(){return this._cachePlayRate},function(K$c){this._cachePlayRate!==K$c&&(this._cachePlayRate=K$c,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[K$c,this._cacheFrameRate])))}),K$b(0,K$q,"cacheFrameRate",function(){return this._cacheFrameRate},function(K$c){this._cacheFrameRate!==K$c&&(this._cacheFrameRate=K$c,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,K$c])))}),K$b(0,K$q,"currentTime",null,function(K$c){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(K$c<this._playStart||K$c>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=K$g.loopCount;var K$P=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=K$c,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/K$P),0),this._currentFrameTime=this._currentKeyframeIndex*K$P}}),K$b(0,K$q,"paused",function(){return this._paused},function(K$c){(this._paused=K$c)&&this.event("paused")}),K$b(0,K$q,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),K$b(0,K$q,"destroyed",function(){return this._destroyed}),K$P}(),K$C=function(K$c){function K$P(){K$P.__super.call(this),K$w.isConchNode&&(this.drawSkin=function(K$c){K$c.transform||(K$c.transform=K$Vc.EMPTY),this._addCmd([K$c]),this.setSkinMesh&&this.setSkinMesh(K$c._ps,K$c.mVBData,K$c.mEleNum,0,K$c.mTexture,K$c.transform)})}return K$_(K$P,"laya.ani.GraphicsAni",K$e),K$P.prototype.drawSkin=function(K$c){var K$P=[K$c];this._saveToCmd(K$w._context._drawSkin,K$P)},K$P.create=function(){return K$P._caches.pop()||new K$P},K$P.recycle=function(K$c){K$c.clear(),K$P._caches.push(K$c)},K$P._caches=[],K$P}(),K$F=function(K$c){function K$N(){this._aniMap={},this.unfixedLastAniIndex=-1,K$N.__super.call(this),this._anis=new Array}K$_(K$N,"laya.ani.AnimationTemplet",K$n);var K$P=K$N.prototype;return K$P.parse=function(K$c){var K$P=new K$jc(K$c);this._aniVersion=K$P.readUTFString(),K$m.parse(this,K$P)},K$P._calculateKeyFrame=function(K$c,K$P,K$q){var K$_=K$c.keyFrame;K$_[K$P]=K$_[0];for(var K$E=0;K$E<K$P;K$E++){var K$b=K$_[K$E];K$b.nextData=0===K$b.duration?K$b.data:K$_[K$E+1].data}K$_.length--},K$P.onAsynLoaded=function(K$c,K$P,K$q){var K$_=new K$jc(K$P);switch(this._aniVersion=K$_.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":K$T.parse(this,K$_);break;default:K$m.parse(this,K$_)}this._endLoaded()},K$P.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},K$P.getAnimationCount=function(){return this._anis.length},K$P.getAnimation=function(K$c){return this._anis[K$c]},K$P.getAniDuration=function(K$c){return this._anis[K$c].playTime},K$P.getNodes=function(K$c){return this._anis[K$c].nodes},K$P.getNodeIndexWithName=function(K$c,K$P){return this._anis[K$c].bone3DMap[K$P]},K$P.getNodeCount=function(K$c){return this._anis[K$c].nodes.length},K$P.getTotalkeyframesLength=function(K$c){return this._anis[K$c].totalKeyframeDatasLength},K$P.getPublicExtData=function(){return this._publicExtData},K$P.getAnimationDataWithCache=function(K$c,K$P,K$q,K$_){var K$E=K$P[K$q];if(K$E){var K$b=K$E[K$c];return K$b?K$b[K$_]:null}return null},K$P.setAnimationDataWithCache=function(K$c,K$P,K$q,K$_,K$E){var K$b=K$P[K$q]||(K$P[K$q]={});(K$b[K$c]||(K$b[K$c]=[]))[K$_]=K$E},K$P.getOriginalData=function(K$c,K$P,K$q,K$_,K$E){for(var K$b=this._anis[K$c].nodes,K$e=0,K$h=0,K$Z=K$b.length,K$S=0;K$h<K$Z;K$h++){var K$n,K$k=K$b[K$h];K$n=K$k.keyFrame[K$q[K$h][K$_]],K$k.dataOffset=K$S;var K$x=K$E-K$n.startTime,K$r=K$k.lerpType;if(K$r)switch(K$r){case 0:case 1:for(K$e=0;K$e<K$k.keyframeWidth;)K$e+=K$k.interpolationMethod[K$e](K$k,K$e,K$P,K$S+K$e,K$n.data,K$x,null,K$n.duration,K$n.nextData);break;case 2:var K$g=K$n.interpolationData,K$W=K$g.length,K$w=0;for(K$e=0;K$e<K$W;){var K$O=K$g[K$e];switch(K$O){case 6:case 7:K$e+=K$N.interpolation[K$O](K$k,K$w,K$P,K$S+K$w,K$n.data,K$x,null,K$n.duration,K$n.nextData,K$g,K$e+1);break;default:K$e+=K$N.interpolation[K$O](K$k,K$w,K$P,K$S+K$w,K$n.data,K$x,null,K$n.duration,K$n.nextData)}K$w++}}else for(K$e=0;K$e<K$k.keyframeWidth;)K$e+=K$k.interpolationMethod[K$e](K$k,K$e,K$P,K$S+K$e,K$n.data,K$x,null,K$n.duration,K$n.nextData);K$S+=K$k.keyframeWidth}},K$P.getNodesCurrentFrameIndex=function(K$c,K$P){var K$q=this._anis[K$c].nodes;K$c!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(K$q.length),this.unfixedCurrentTimes=new Float32Array(K$q.length),this.unfixedLastAniIndex=K$c);for(var K$_=0,K$E=K$q.length;K$_<K$E;K$_++){var K$b=K$q[K$_];for(K$P<this.unfixedCurrentTimes[K$_]&&(this.unfixedCurrentFrameIndexes[K$_]=0),this.unfixedCurrentTimes[K$_]=K$P;this.unfixedCurrentFrameIndexes[K$_]<K$b.keyFrame.length&&!(K$b.keyFrame[this.unfixedCurrentFrameIndexes[K$_]].startTime>this.unfixedCurrentTimes[K$_]);)this.unfixedCurrentFrameIndexes[K$_]++;this.unfixedCurrentFrameIndexes[K$_]--}return this.unfixedCurrentFrameIndexes},K$P.getOriginalDataUnfixedRate=function(K$c,K$P,K$q){var K$_=this._anis[K$c].nodes;K$c!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(K$_.length),this.unfixedCurrentTimes=new Float32Array(K$_.length),this.unfixedKeyframes=K$W(K$_.length),this.unfixedLastAniIndex=K$c);for(var K$E=0,K$b=0,K$e=K$_.length,K$h=0;K$b<K$e;K$b++){var K$Z=K$_[K$b];for(K$q<this.unfixedCurrentTimes[K$b]&&(this.unfixedCurrentFrameIndexes[K$b]=0),this.unfixedCurrentTimes[K$b]=K$q;this.unfixedCurrentFrameIndexes[K$b]<K$Z.keyFrame.length&&!(K$Z.keyFrame[this.unfixedCurrentFrameIndexes[K$b]].startTime>this.unfixedCurrentTimes[K$b]);)this.unfixedKeyframes[K$b]=K$Z.keyFrame[this.unfixedCurrentFrameIndexes[K$b]],this.unfixedCurrentFrameIndexes[K$b]++;var K$S=this.unfixedKeyframes[K$b];K$Z.dataOffset=K$h;var K$n=K$q-K$S.startTime;if(K$Z.lerpType)switch(K$Z.lerpType){case 0:case 1:for(K$E=0;K$E<K$Z.keyframeWidth;)K$E+=K$Z.interpolationMethod[K$E](K$Z,K$E,K$P,K$h+K$E,K$S.data,K$n,null,K$S.duration,K$S.nextData);break;case 2:var K$k=K$S.interpolationData,K$x=K$k.length,K$r=0;for(K$E=0;K$E<K$x;){var K$g=K$k[K$E];switch(K$g){case 6:case 7:K$E+=K$N.interpolation[K$g](K$Z,K$r,K$P,K$h+K$r,K$S.data,K$n,null,K$S.duration,K$S.nextData,K$k,K$E+1);break;default:K$E+=K$N.interpolation[K$g](K$Z,K$r,K$P,K$h+K$r,K$S.data,K$n,null,K$S.duration,K$S.nextData)}K$r++}}else for(K$E=0;K$E<K$Z.keyframeWidth;)K$E+=K$Z.interpolationMethod[K$E](K$Z,K$E,K$P,K$h+K$E,K$S.data,K$n,null,K$S.duration,K$S.nextData);K$h+=K$Z.keyframeWidth}},K$N._LinearInterpolation_0=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){var K$n=0===K$h?0:K$b/K$h;return K$q[K$_]=(1-K$n)*K$E[K$P]+K$n*K$Z[K$P],1},K$N._QuaternionInterpolation_1=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){var K$n=0===K$h?0:K$b/K$h;return K$x.slerpQuaternionArray(K$E,K$P,K$Z,K$P,K$n,K$q,K$_),4},K$N._AngleInterpolation_2=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){return 0},K$N._RadiansInterpolation_3=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){return 0},K$N._Matrix4x4Interpolation_4=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){for(var K$n=0;K$n<16;K$n++,K$P++)K$q[K$_+K$n]=K$E[K$P]+K$b*K$e[K$P];return 16},K$N._NoInterpolation_5=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S){return K$q[K$_]=K$E[K$P],1},K$N._BezierInterpolation_6=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n){return void 0===K$n&&(K$n=0),K$q[K$_]=K$E[K$P]+(K$Z[K$P]-K$E[K$P])*K$Q.getBezierRate(K$b/K$h,K$S[K$n],K$S[K$n+1],K$S[K$n+2],K$S[K$n+3]),5},K$N._BezierInterpolation_7=function(K$c,K$P,K$q,K$_,K$E,K$b,K$e,K$h,K$Z,K$S,K$n){return void 0===K$n&&(K$n=0),K$q[K$_]=K$S[K$n+4]+K$S[K$n+5]*K$Q.getBezierRate((.001*K$b+K$S[K$n+6])/K$S[K$n+7],K$S[K$n],K$S[K$n+1],K$S[K$n+2],K$S[K$n+3]),9},K$N.load=function(K$c){return K$Ec.loader.create(K$c,null,null,K$N)},K$N.interpolation=[K$N._LinearInterpolation_0,K$N._QuaternionInterpolation_1,K$N._AngleInterpolation_2,K$N._RadiansInterpolation_3,K$N._Matrix4x4Interpolation_4,K$N._NoInterpolation_5,K$N._BezierInterpolation_6,K$N._BezierInterpolation_7],K$N}(),K$u=function(K$P){function K$q(K$c,K$P){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,K$q.__super.call(this),void 0===K$P&&(K$P=0),K$c&&this.init(K$c,K$P)}K$_(K$q,"laya.ani.bone.Skeleton",K$P);var K$c=K$q.prototype;return K$c.init=function(K$c,K$P){void 0===K$P&&(K$P=0);var K$q,K$_,K$E,K$b=0,K$e=0;if(1==K$P)for(this._graphicsCache=[],K$b=0,K$e=K$c.getAnimationCount();K$b<K$e;K$b++)this._graphicsCache.push([]);if(this._yReverseMatrix=K$c.yReverseMatrix,this._aniMode=K$P,this._templet=K$c,this._player=new K$d,this._player.cacheFrameRate=K$c.rate,this._player.templet=K$c,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=K$c.mBoneArr,this._rootBone=K$c.mRootBone,this._aniSectionDic=K$c.aniSectionDic,0<K$c.ikArr.length)for(this._ikArr=[],K$b=0,K$e=K$c.ikArr.length;K$b<K$e;K$b++)this._ikArr.push(new K$N(K$c.ikArr[K$b],this._boneList));if(0<K$c.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),K$b=0,K$e=K$c.pathArr.length;K$b<K$e;K$b++)K$q=K$c.pathArr[K$b],K$_=new K$D(K$q,this._boneList),(K$E=this._boneSlotDic[K$q.name])&&((K$_=new K$D(K$q,this._boneList)).target=K$E),this._pathDic[K$q.name]=K$_;if(0<K$c.tfArr.length)for(this._tfArr=[],K$b=0,K$e=K$c.tfArr.length;K$b<K$e;K$b++)this._tfArr.push(new K$L(K$c.tfArr[K$b],this._boneList));if(0<K$c.skinDataArray.length){var K$h=this._templet.skinDataArray[this._skinIndex];this._skinName=K$h.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},K$c.load=function(K$c,K$P,K$q){},K$c._onLoaded=function(){},K$c._parseComplete=function(){var K$c=K$A.TEMPLET_DICTIONARY[this._aniPath];K$c&&(this.init(K$c,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},K$c._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},K$c._onPlay=function(){this.event("played")},K$c._onStop=function(){var K$c,K$P=this._templet.eventAniArr[this._aniClipIndex];if(K$P&&this._eventIndex<K$P.length)for(;this._eventIndex<K$P.length;this._eventIndex++)(K$c=K$P[this._eventIndex]).time>=this._player.playStart&&K$c.time<=this._player.playEnd&&this.event("label",K$c);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},K$c._onPause=function(){this.event("paused")},K$c._parseSrcBoneMatrix=function(){var K$c=0,K$P=0;for(K$P=this._templet.srcBoneMatrixArr.length,K$c=0;K$c<K$P;K$c++)this._boneMatrixArray.push(new K$Vc);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var K$q,K$_,K$E=this._templet.boneSlotArray;for(K$c=0,K$P=K$E.length;K$c<K$P;K$c++)K$q=K$E[K$c],null==(K$_=this._bindBoneBoneSlotDic[K$q.parent])&&(this._bindBoneBoneSlotDic[K$q.parent]=K$_=[]),this._boneSlotDic[K$q.name]=K$q=K$q.copy(),K$_.push(K$q),this._boneSlotArray.push(K$q)}},K$c._emitMissedEvents=function(K$c,K$P,K$q){void 0===K$q&&(K$q=0);var K$_=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(K$_){var K$E,K$b,K$e=0;for(K$E=K$_.length,K$e=K$q;K$e<K$E;K$e++)(K$b=K$_[K$e]).time>=this._player.playStart&&K$b.time<=this._player.playEnd&&this.event("label",K$b)}},K$c._update=function(K$c){if(void 0===K$c&&(K$c=!0),!(this._pause||K$c&&this._indexControl)){var K$P=this.timer.currTimer,K$q=this._player.currentKeyframeIndex,K$_=K$P-this._lastTime;if(K$c?this._player._update(K$_):K$q=-1,this._lastTime=K$P,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<K$_&&this._clipIndex==K$q&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var K$E;this._lastUpdateAniClipIndex=this._aniClipIndex,K$q>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var K$b,K$e=this._templet.eventAniArr[this._aniClipIndex];if(K$e&&this._eventIndex<K$e.length&&((K$E=K$e[this._eventIndex]).time>=this._player.playStart&&K$E.time<=this._player.playEnd?this._player.currentPlayTime>=K$E.time&&(this.event("label",K$E),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(K$b=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=K$b&&(this.graphics=K$b));var K$h=0,K$Z=0;for(K$Z=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,K$Z-1)&&0<K$Z;)K$Z--;if(K$Z<this._clipIndex)for(K$h=K$Z;K$h<this._clipIndex;K$h++)this._createGraphics(K$h)}else if(1==this._aniMode){if(K$b=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=K$b&&(this.graphics=K$b));for(K$Z=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,K$Z-1)&&0<K$Z;)K$Z--;if(K$Z<this._clipIndex)for(K$h=K$Z;K$h<this._clipIndex;K$h++)this._createGraphics(K$h)}this._createGraphics()}}},K$c._createGraphics=function(K$c){void 0===K$c&&(K$c=-1),-1==K$c&&(K$c=this._clipIndex);var K$P,K$q,K$_=K$c*this._player.cacheFrameRateInterval,K$E=this._templet.drawOrderAniArr[this._aniClipIndex];if(K$E&&0<K$E.length)for(this._drawOrderIndex=0,K$P=K$E[this._drawOrderIndex];K$_>=K$P.time&&(this._drawOrder=K$P.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=K$E.length));)K$P=K$E[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=K$C.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=K$C.create(),K$q=this.graphics;var K$b=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],K$c,K$_);var K$e,K$h,K$Z,K$S,K$n=this._aniSectionDic[this._aniClipIndex],K$k=0,K$x=0,K$r=0,K$g=0,K$W=0,K$w=this._templet.srcBoneMatrixArr.length;for(K$W=K$n[K$x=0];K$x<K$w;K$x++)K$S=this._boneList[K$x],K$Z=this._templet.srcBoneMatrixArr[K$x],K$S.resultTransform.scX=K$Z.scX*this._curOriginalData[K$k++],K$S.resultTransform.skX=K$Z.skX+this._curOriginalData[K$k++],K$S.resultTransform.skY=K$Z.skY+this._curOriginalData[K$k++],K$S.resultTransform.scY=K$Z.scY*this._curOriginalData[K$k++],K$S.resultTransform.x=K$Z.x+this._curOriginalData[K$k++],K$S.resultTransform.y=K$Z.y+this._curOriginalData[K$k++],8===this._templet.tMatrixDataLen&&(K$S.resultTransform.skewX=K$Z.skewX+this._curOriginalData[K$k++],K$S.resultTransform.skewY=K$Z.skewY+this._curOriginalData[K$k++]);var K$O,K$N={},K$m={};for(K$W+=K$n[1];K$x<K$W;K$x++)K$N[(K$O=K$b[K$x]).name]=this._curOriginalData[K$k++],K$m[K$O.name]=this._curOriginalData[K$k++],this._curOriginalData[K$k++],this._curOriginalData[K$k++],this._curOriginalData[K$k++],this._curOriginalData[K$k++];var K$T,K$D,K$L={},K$H={};for(K$W+=K$n[2];K$x<K$W;K$x++)K$L[(K$O=K$b[K$x]).name]=this._curOriginalData[K$k++],K$H[K$O.name]=this._curOriginalData[K$k++],this._curOriginalData[K$k++],this._curOriginalData[K$k++],this._curOriginalData[K$k++],this._curOriginalData[K$k++];if(this._pathDic)for(K$W+=K$n[3];K$x<K$W;K$x++){if(K$O=K$b[K$x],K$T=this._pathDic[K$O.name])switch(new K$jc(K$O.extenData).getByte()){case 1:K$T.position=this._curOriginalData[K$k++];break;case 2:K$T.spacing=this._curOriginalData[K$k++];break;case 3:K$T.rotateMix=this._curOriginalData[K$k++],K$T.translateMix=this._curOriginalData[K$k++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(K$Vc.TEMP.identity()),this._ikArr)for(K$x=0,K$W=this._ikArr.length;K$x<K$W;K$x++)K$D=this._ikArr[K$x],K$L.hasOwnProperty(K$D.name)&&(K$D.bendDirection=K$L[K$D.name]),K$H.hasOwnProperty(K$D.name)&&(K$D.mix=K$H[K$D.name]),K$D.apply();if(this._pathDic)for(var K$Q in this._pathDic)(K$T=this._pathDic[K$Q]).apply(this._boneList,K$q);if(this._tfArr)for(K$x=0,K$g=this._tfArr.length;K$x<K$g;K$x++)this._tfArr[K$x].apply();for(K$x=0,K$g=this._boneList.length;K$x<K$g;K$x++)if(K$S=this._boneList[K$x],K$h=this._bindBoneBoneSlotDic[K$S.name],K$S.resultMatrix.copyTo(this._boneMatrixArray[K$x]),K$h)for(K$r=0,K$W=K$h.length;K$r<K$W;K$r++)(K$e=K$h[K$r])&&K$e.setParentMatrix(K$S.resultMatrix);var K$d,K$u,K$A,K$J,K$j={},K$V=this._templet.deformAniArr;if(K$V&&0<K$V.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,K$x=0,K$W=this._boneSlotArray.length;K$x<K$W;K$x++)(K$e=this._boneSlotArray[K$x]).deformData=null;var K$R,K$$=K$V[this._aniClipIndex];for(K$R in K$d=K$$.default,this._setDeform(K$d,K$j,this._boneSlotArray,K$_),K$$)"default"!=K$R&&K$R!=this._skinName&&(K$d=K$$[K$R],this._setDeform(K$d,K$j,this._boneSlotArray,K$_));K$d=K$$[this._skinName],this._setDeform(K$d,K$j,this._boneSlotArray,K$_)}if(this._drawOrder)for(K$x=0,K$W=this._drawOrder.length;K$x<K$W;K$x++)K$u=K$N[(K$e=this._boneSlotArray[this._drawOrder[K$x]]).name],K$A=K$m[K$e.name],isNaN(K$A)||(K$q.save(),K$q.alpha(K$A)),isNaN(K$u)||-2==K$u||(this._templet.attachmentNames?K$e.showDisplayByName(this._templet.attachmentNames[K$u]):K$e.showDisplayByIndex(K$u)),K$j[this._drawOrder[K$x]]?(K$J=K$j[this._drawOrder[K$x]],K$e.currDisplayData&&K$J[K$e.currDisplayData.attachmentName]?K$e.deformData=K$J[K$e.currDisplayData.attachmentName]:K$e.deformData=null):K$e.deformData=null,isNaN(K$A)?K$e.draw(K$q,this._boneMatrixArray,2==this._aniMode):K$e.draw(K$q,this._boneMatrixArray,2==this._aniMode,K$A),isNaN(K$A)||K$q.restore();else for(K$x=0,K$W=this._boneSlotArray.length;K$x<K$W;K$x++)K$u=K$N[(K$e=this._boneSlotArray[K$x]).name],K$A=K$m[K$e.name],isNaN(K$A)||(K$q.save(),K$q.alpha(K$A)),isNaN(K$u)||-2==K$u||(this._templet.attachmentNames?K$e.showDisplayByName(this._templet.attachmentNames[K$u]):K$e.showDisplayByIndex(K$u)),K$j[K$x]?(K$J=K$j[K$x],K$e.currDisplayData&&K$J[K$e.currDisplayData.attachmentName]?K$e.deformData=K$J[K$e.currDisplayData.attachmentName]:K$e.deformData=null):K$e.deformData=null,isNaN(K$A)?K$e.draw(K$q,this._boneMatrixArray,2==this._aniMode):K$e.draw(K$q,this._boneMatrixArray,2==this._aniMode,K$A),isNaN(K$A)||K$q.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,K$c,K$q):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,K$c,K$q)},K$c._setDeform=function(K$c,K$P,K$q,K$_){if(K$c){var K$E,K$b,K$e,K$h=0,K$Z=0,K$S=0;if(K$c)for(K$h=0,K$Z=K$c.deformSlotDataList.length;K$h<K$Z;K$h++)for(K$E=K$c.deformSlotDataList[K$h],K$S=0;K$S<K$E.deformSlotDisplayList.length;K$S++)K$e=K$q[(K$b=K$E.deformSlotDisplayList[K$S]).slotIndex],K$b.apply(K$_,K$e),K$P[K$b.slotIndex]||(K$P[K$b.slotIndex]={}),K$P[K$b.slotIndex][K$b.attachment]=K$b.deformData}},K$c.getAnimNum=function(){return this._templet.getAnimationCount()},K$c.getAniNameByIndex=function(K$c){return this._templet.getAniNameByIndex(K$c)},K$c.getSlotByName=function(K$c){return this._boneSlotDic[K$c]},K$c.showSkinByName=function(K$c,K$P){void 0===K$P&&(K$P=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(K$c),K$P)},K$c.showSkinByIndex=function(K$c,K$P){void 0===K$P&&(K$P=!0);for(var K$q=0;K$q<this._boneSlotArray.length;K$q++)this._boneSlotArray[K$q].showSlotData(null,K$P);if(this._templet.showSkinByIndex(this._boneSlotDic,K$c,K$P)){var K$_=this._templet.skinDataArray[K$c];this._skinIndex=K$c,this._skinName=K$_.name}this._clearCache()},K$c.showSlotSkinByIndex=function(K$c,K$P){if(0!=this._aniMode){var K$q=this.getSlotByName(K$c);K$q&&K$q.showDisplayByIndex(K$P),this._clearCache()}},K$c.showSlotSkinByName=function(K$c,K$P){if(0!=this._aniMode){var K$q=this.getSlotByName(K$c);K$q&&K$q.showDisplayByName(K$P),this._clearCache()}},K$c.replaceSlotSkinName=function(K$c,K$P,K$q){if(0!=this._aniMode){var K$_=this.getSlotByName(K$c);K$_&&K$_.replaceDisplayByName(K$P,K$q),this._clearCache()}},K$c.replaceSlotSkinByIndex=function(K$c,K$P,K$q){if(0!=this._aniMode){var K$_=this.getSlotByName(K$c);K$_&&K$_.replaceDisplayByIndex(K$P,K$q),this._clearCache()}},K$c.setSlotSkin=function(K$c,K$P){if(0!=this._aniMode){var K$q=this.getSlotByName(K$c);K$q&&K$q.replaceSkin(K$P),this._clearCache()}},K$c._clearCache=function(){if(1==this._aniMode)for(var K$c=0,K$P=this._graphicsCache.length;K$c<K$P;K$c++){for(var K$q=0,K$_=this._graphicsCache[K$c].length;K$q<K$_;K$q++){var K$E=this._graphicsCache[K$c][K$q];K$E!=this.graphics&&K$C.recycle(K$E)}this._graphicsCache[K$c].length=0}},K$c.play=function(K$c,K$P,K$q,K$_,K$E,K$b){void 0===K$q&&(K$q=!0),void 0===K$_&&(K$_=0),void 0===K$E&&(K$E=0),void 0===K$b&&(K$b=!0),this._indexControl=!1;var K$e=-1,K$h=NaN;if(K$h=K$P?2147483647:0,"string"==typeof K$c)for(var K$Z=0,K$S=this._templet.getAnimationCount();K$Z<K$S;K$Z++){var K$n=this._templet.getAnimation(K$Z);if(K$n&&K$c==K$n.name){K$e=K$Z;break}}else K$e=K$c;-1<K$e&&K$e<this.getAnimNum()&&(this._aniClipIndex=K$e,(K$q||this._pause||this._currAniIndex!=K$e)&&(this._currAniIndex=K$e,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(K$e)),this._drawOrder=null,this._eventIndex=0,this._player.play(K$e,this._player.playbackRate,K$h,K$_,K$E),K$b&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=K$k.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},K$c.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},K$c.playbackRate=function(K$c){this._player&&(this._player.playbackRate=K$c)},K$c.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},K$c.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=K$k.now(),this.timer.frameLoop(1,this,this._update,null,!0))},K$c._getGrahicsDataWithCache=function(K$c,K$P){return this._graphicsCache[K$c][K$P]},K$c._setGrahicsDataWithCache=function(K$c,K$P,K$q){this._graphicsCache[K$c][K$P]=K$q},K$c.destroy=function(K$c){void 0===K$c&&(K$c=!0),K$P.prototype.destroy.call(this,K$c),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},K$b(0,K$c,"url",function(){return this._aniPath},function(K$c){this.load(K$c)}),K$b(0,K$c,"index",function(){return this._index},function(K$c){this.player&&(this._index=K$c,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),K$b(0,K$c,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),K$b(0,K$c,"templet",function(){return this._templet}),K$b(0,K$c,"player",function(){return this._player}),K$q.useSimpleMeshInCanvas=!1,K$q}(K$bc),K$A=function(K$P){function K$E(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,K$E.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}K$_(K$E,"laya.ani.bone.Templet",K$P);var K$c=K$E.prototype;return K$c.getLoadList=function(){return this._loadList},K$c.loadAni=function(K$c){this._skBufferUrl=K$c,K$Ec.loader.load(K$c,K$Z.create(this,this.onComplete),null,"arraybuffer")},K$c.onComplete=function(K$c){if(this._isDestroyed)this.destroy();else{var K$P=K$S.getRes(this._skBufferUrl);K$P?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,K$P)):this.event("error","load failed:"+this._skBufferUrl)}},K$c.parseData=function(K$c,K$P,K$q){void 0===K$q&&(K$q=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=K$c,this._mainTexture&&K$w.isWebGL&&K$c.bitmap&&(K$c.bitmap.enableMerageInAtlas=!1),this._rate=K$q,this.parse(K$P)},K$c.buildArmature=function(K$c){return void 0===K$c&&(K$c=0),new K$u(this,K$c)},K$c.parse=function(K$c){K$P.prototype.parse.call(this,K$c),this._endLoaded(),this._aniVersion!=K$E.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+K$E.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},K$c._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var K$c=0;this._loadList=[];var K$P,K$q=new K$jc(this.getPublicExtData()),K$_=0,K$E=0,K$b=0,K$e=K$q.getInt32(),K$h=K$q.readUTFString(),K$Z=K$h.split("\n");for(K$c=0;K$c<K$e;K$c++)K$P=this._path+K$Z[2*K$c],K$h=K$Z[2*K$c+1],K$q.getFloat32(),K$q.getFloat32(),K$_=K$q.getFloat32(),K$E=K$q.getFloat32(),K$b=K$q.getFloat32(),isNaN(K$b)?0:K$b,K$b=K$q.getFloat32(),isNaN(K$b)?0:K$b,K$b=K$q.getFloat32(),isNaN(K$b)?K$_:K$b,K$b=K$q.getFloat32(),isNaN(K$b)?K$E:K$b,-1==this._loadList.indexOf(K$P)&&this._loadList.push(K$P);this.event("inited",this)}},K$c._textureComplete=function(){for(var K$c,K$P,K$q=0,K$_=this._loadList.length;K$q<K$_;K$q++)K$P=this._loadList[K$q],K$c=this._textureDic[K$P]=K$S.getRes(K$P),K$w.isWebGL&&K$c&&K$c.bitmap&&(K$c.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},K$c._parsePublicExtData=function(){var K$c=0,K$P=0,K$q=0,K$_=0,K$E=0;for(K$c=0,K$E=this.getAnimationCount();K$c<K$E;K$c++)this._graphicsCache.push([]);var K$b;K$b="Dragon"!=this._aniClassName;var K$e,K$h,K$Z=new K$jc(this.getPublicExtData()),K$S=0,K$n=0,K$k=0,K$x=0,K$r=0,K$g=0,K$W=0,K$w=0,K$O=0,K$N=K$Z.getInt32(),K$m=K$Z.readUTFString(),K$T=K$m.split("\n");for(K$c=0;K$c<K$N;K$c++){if(K$e=this._mainTexture,K$h=this._path+K$T[2*K$c],K$m=K$T[2*K$c+1],null==this._mainTexture&&(K$e=this._textureDic[K$h]),!K$e)return this.event("error",this),void(this.isParseFail=!0);K$S=K$Z.getFloat32(),K$n=K$Z.getFloat32(),K$k=K$Z.getFloat32(),K$x=K$Z.getFloat32(),K$O=K$Z.getFloat32(),K$r=isNaN(K$O)?0:K$O,K$O=K$Z.getFloat32(),K$g=isNaN(K$O)?0:K$O,K$O=K$Z.getFloat32(),K$W=isNaN(K$O)?K$k:K$O,K$O=K$Z.getFloat32(),K$w=isNaN(K$O)?K$x:K$O,this.subTextureDic[K$m]=K$Rc.create(K$e,K$S,K$n,K$k,K$x,-K$r,-K$g,K$W,K$w),K$e.alphaTexture&&(this.subTextureDic[K$m].alphaTexture=K$Rc.create(K$e.alphaTexture,K$S,K$n,K$k,K$x,-K$r,-K$g,K$W,K$w))}this._mainTexture=K$e;var K$D,K$L,K$H,K$Q,K$d,K$u=K$Z.getUint16();for(K$c=0;K$c<K$u;K$c++)(K$D=[]).push(K$Z.getUint16()),K$D.push(K$Z.getUint16()),K$D.push(K$Z.getUint16()),K$D.push(K$Z.getUint16()),this.aniSectionDic[K$c]=K$D;var K$A,K$J=K$Z.getInt16(),K$j={};for(K$c=0;K$c<K$J;K$c++)K$L=new K$$c,0==K$c?K$A=K$L:K$L.root=K$A,K$L.d=K$b?-1:1,K$Q=K$Z.readUTFString(),K$d=K$Z.readUTFString(),K$L.length=K$Z.getFloat32(),1==K$Z.getByte()&&(K$L.inheritRotation=!1),1==K$Z.getByte()&&(K$L.inheritScale=!1),K$L.name=K$Q,K$d&&((K$H=K$j[K$d])?K$H.addChild(K$L):this.mRootBone=K$L),K$j[K$Q]=K$L,this.mBoneArr.push(K$L);this.tMatrixDataLen=K$Z.getUint16();var K$V,K$R,K$$=K$Z.getUint16(),K$C=Math.floor(K$$/this.tMatrixDataLen),K$F=this.srcBoneMatrixArr;for(K$c=0;K$c<K$C;K$c++)(K$V=new K$Xc).scX=K$Z.getFloat32(),K$V.skX=K$Z.getFloat32(),K$V.skY=K$Z.getFloat32(),K$V.scY=K$Z.getFloat32(),K$V.x=K$Z.getFloat32(),K$V.y=K$Z.getFloat32(),8===this.tMatrixDataLen&&(K$V.skewX=K$Z.getFloat32(),K$V.skewY=K$Z.getFloat32()),K$F.push(K$V),(K$L=this.mBoneArr[K$c]).transform=K$V;var K$o,K$a=K$Z.getUint16(),K$Y=0;for(K$c=0;K$c<K$a;K$c++){for(K$R=new K$Uc,K$Y=K$Z.getUint16(),K$P=0;K$P<K$Y;K$P++)K$R.boneNames.push(K$Z.readUTFString()),K$R.boneIndexs.push(K$Z.getInt16());K$R.name=K$Z.readUTFString(),K$R.targetBoneName=K$Z.readUTFString(),K$R.targetBoneIndex=K$Z.getInt16(),K$R.bendDirection=K$Z.getFloat32(),K$R.mix=K$Z.getFloat32(),K$R.isSpine=K$b,this.ikArr.push(K$R)}var K$s,K$U=K$Z.getUint16(),K$I=0;for(K$c=0;K$c<K$U;K$c++){for(K$o=new K$zc,K$I=K$Z.getUint16(),K$P=0;K$P<K$I;K$P++)K$o.boneIndexs.push(K$Z.getInt16());K$o.name=K$Z.getUTFString(),K$o.targetIndex=K$Z.getInt16(),K$o.rotateMix=K$Z.getFloat32(),K$o.translateMix=K$Z.getFloat32(),K$o.scaleMix=K$Z.getFloat32(),K$o.shearMix=K$Z.getFloat32(),K$o.offsetRotation=K$Z.getFloat32(),K$o.offsetX=K$Z.getFloat32(),K$o.offsetY=K$Z.getFloat32(),K$o.offsetScaleX=K$Z.getFloat32(),K$o.offsetScaleY=K$Z.getFloat32(),K$o.offsetShearY=K$Z.getFloat32(),this.tfArr.push(K$o)}var K$v=K$Z.getUint16(),K$y=0;for(K$c=0;K$c<K$v;K$c++){for((K$s=new K$Ic).name=K$Z.readUTFString(),K$y=K$Z.getUint16(),K$P=0;K$P<K$y;K$P++)K$s.bones.push(K$Z.getInt16());K$s.target=K$Z.readUTFString(),K$s.positionMode=K$Z.readUTFString(),K$s.spacingMode=K$Z.readUTFString(),K$s.rotateMode=K$Z.readUTFString(),K$s.offsetRotation=K$Z.getFloat32(),K$s.position=K$Z.getFloat32(),K$s.spacing=K$Z.getFloat32(),K$s.rotateMix=K$Z.getFloat32(),K$s.translateMix=K$Z.getFloat32(),this.pathArr.push(K$s)}var K$M,K$z,K$X,K$f,K$l,K$t=0,K$B=0,K$p=0,K$i=NaN,K$K=0,K$G=K$Z.getInt16();for(K$c=0;K$c<K$G;K$c++){var K$cc=K$Z.getUint8(),K$Pc={};this.deformAniArr.push(K$Pc);for(var K$qc=0;K$qc<K$cc;K$qc++)for((K$M=new K$Fc).skinName=K$Z.getUTFString(),K$Pc[K$M.skinName]=K$M,K$t=K$Z.getInt16(),K$P=0;K$P<K$t;K$P++)for(K$z=new K$oc,K$M.deformSlotDataList.push(K$z),K$B=K$Z.getInt16(),K$q=0;K$q<K$B;K$q++)for(K$X=new K$ac,K$z.deformSlotDisplayList.push(K$X),K$X.slotIndex=K$Z.getInt16(),K$X.attachment=K$Z.getUTFString(),K$p=K$Z.getInt16(),K$_=0;K$_<K$p;K$_++)for(1==K$Z.getByte()?K$X.tweenKeyList.push(!0):K$X.tweenKeyList.push(!1),K$i=K$Z.getFloat32(),K$X.timeList.push(K$i),K$f=[],K$X.vectices.push(K$f),K$K=K$Z.getInt16(),K$E=0;K$E<K$K;K$E++)K$f.push(K$Z.getFloat32())}var K$_c,K$Ec,K$bc=K$Z.getInt16(),K$ec=0,K$hc=0;for(K$c=0;K$c<K$bc;K$c++){for(K$ec=K$Z.getInt16(),K$l=[],K$P=0;K$P<K$ec;K$P++){for((K$_c=new K$Yc).time=K$Z.getFloat32(),K$hc=K$Z.getInt16(),K$q=0;K$q<K$hc;K$q++)K$_c.drawOrder.push(K$Z.getInt16());K$l.push(K$_c)}this.drawOrderAniArr.push(K$l)}var K$Zc,K$Sc=K$Z.getInt16(),K$nc=0;for(K$c=0;K$c<K$Sc;K$c++){for(K$nc=K$Z.getInt16(),K$Ec=[],K$P=0;K$P<K$nc;K$P++)(K$Zc=new K$sc).name=K$Z.getUTFString(),K$Zc.intValue=K$Z.getInt32(),K$Zc.floatValue=K$Z.getFloat32(),K$Zc.stringValue=K$Z.getUTFString(),K$Zc.time=K$Z.getFloat32(),K$Ec.push(K$Zc);this.eventAniArr.push(K$Ec)}var K$kc=K$Z.getInt16();if(0<K$kc)for(this.attachmentNames=[],K$c=0;K$c<K$kc;K$c++)this.attachmentNames.push(K$Z.getUTFString());var K$xc,K$rc,K$gc=K$Z.getInt16();for(K$c=0;K$c<K$gc;K$c++)(K$xc=new K$Cc).name=K$Z.readUTFString(),K$xc.parent=K$Z.readUTFString(),K$xc.attachmentName=K$Z.readUTFString(),K$xc.srcDisplayIndex=K$xc.displayIndex=K$Z.getInt16(),(K$xc.templet=this).boneSlotDic[K$xc.name]=K$xc,null==(K$rc=this.bindBoneBoneSlotDic[K$xc.parent])&&(this.bindBoneBoneSlotDic[K$xc.parent]=K$rc=[]),K$rc.push(K$xc),this.boneSlotArray.push(K$xc);var K$Wc,K$wc,K$Oc,K$Nc=K$Z.readUTFString().split("\n"),K$mc=0,K$Tc=K$Z.getUint8(),K$Dc=0,K$Lc=0,K$Hc=0,K$Qc=0,K$dc=0,K$uc=0,K$Ac=0;for(K$c=0;K$c<K$Tc;K$c++){for((K$Wc=new K$vc).name=K$Nc[K$mc++],K$Dc=K$Z.getUint8(),K$P=0;K$P<K$Dc;K$P++){for((K$wc=new K$Mc).name=K$Nc[K$mc++],K$xc=this.boneSlotDic[K$wc.name],K$Lc=K$Z.getUint8(),K$q=0;K$q<K$Lc;K$q++){if(K$Oc=new K$yc,this.skinSlotDisplayDataArr.push(K$Oc),K$Oc.name=K$Nc[K$mc++],K$Oc.attachmentName=K$Nc[K$mc++],K$Oc.transform=new K$Xc,K$Oc.transform.scX=K$Z.getFloat32(),K$Oc.transform.skX=K$Z.getFloat32(),K$Oc.transform.skY=K$Z.getFloat32(),K$Oc.transform.scY=K$Z.getFloat32(),K$Oc.transform.x=K$Z.getFloat32(),K$Oc.transform.y=K$Z.getFloat32(),K$wc.displayArr.push(K$Oc),K$Oc.width=K$Z.getFloat32(),K$Oc.height=K$Z.getFloat32(),K$Oc.type=K$Z.getUint8(),K$Oc.verLen=K$Z.getUint16(),0<(K$J=K$Z.getUint16()))for(K$Oc.bones=[],K$_=0;K$_<K$J;K$_++){var K$Jc=K$Z.getUint16();K$Oc.bones.push(K$Jc)}if(0<(K$Hc=K$Z.getUint16()))for(K$Oc.uvs=[],K$_=0;K$_<K$Hc;K$_++)K$Oc.uvs.push(K$Z.getFloat32());if(0<(K$Qc=K$Z.getUint16()))for(K$Oc.weights=[],K$_=0;K$_<K$Qc;K$_++)K$Oc.weights.push(K$Z.getFloat32());if(0<(K$dc=K$Z.getUint16()))for(K$Oc.triangles=[],K$_=0;K$_<K$dc;K$_++)K$Oc.triangles.push(K$Z.getUint16());if(0<(K$uc=K$Z.getUint16()))for(K$Oc.vertices=[],K$_=0;K$_<K$uc;K$_++)K$Oc.vertices.push(K$Z.getFloat32());if(0<(K$Ac=K$Z.getUint16()))for(K$Oc.lengths=[],K$_=0;K$_<K$Ac;K$_++)K$Oc.lengths.push(K$Z.getFloat32())}K$Wc.slotArr.push(K$wc)}this.skinDic[K$Wc.name]=K$Wc,this.skinDataArray.push(K$Wc)}1==K$Z.getUint8()?(this.yReverseMatrix=new K$Vc(1,0,0,-1,0,0),K$A&&K$A.setTempMatrix(this.yReverseMatrix)):K$A&&K$A.setTempMatrix(new K$Vc),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},K$c.getTexture=function(K$c){var K$P=this.subTextureDic[K$c];return K$P||(K$P=this.subTextureDic[K$c.substr(0,K$c.length-1)]),null==K$P?this._mainTexture:K$P},K$c.showSkinByIndex=function(K$c,K$P,K$q){if(void 0===K$q&&(K$q=!0),K$P<0&&K$P>=this.skinDataArray.length)return!1;var K$_,K$E,K$b=0,K$e=0,K$h=this.skinDataArray[K$P];if(K$h){for(K$b=0,K$e=K$h.slotArr.length;K$b<K$e;K$b++)(K$E=K$h.slotArr[K$b])&&(K$_=K$c[K$E.name])&&(K$_.showSlotData(K$E,K$q),K$q&&"undefined"!=K$_.attachmentName&&"null"!=K$_.attachmentName?K$_.showDisplayByName(K$_.attachmentName):K$_.showDisplayByIndex(K$_.displayIndex));return!0}return!1},K$c.getSkinIndexByName=function(K$c){for(var K$P=0,K$q=this.skinDataArray.length;K$P<K$q;K$P++)if(this.skinDataArray[K$P].name==K$c)return K$P;return-1},K$c.getGrahicsDataWithCache=function(K$c,K$P){return this._graphicsCache[K$c][K$P]},K$c.setGrahicsDataWithCache=function(K$c,K$P,K$q){this._graphicsCache[K$c][K$P]=K$q},K$c.destroy=function(){var K$c;for(var K$P in this._isDestroyed=!0,this.subTextureDic)(K$c=this.subTextureDic[K$P])&&K$c.destroy();for(K$P in this._textureDic)(K$c=this._textureDic[K$P])&&K$c.destroy();for(var K$q=0,K$_=this.skinSlotDisplayDataArr.length;K$q<K$_;K$q++)this.skinSlotDisplayDataArr[K$q].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete K$E.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},K$c.getAniNameByIndex=function(K$c){var K$P=this.getAnimation(K$c);return K$P?K$P.name:null},K$b(0,K$c,"rate",function(){return this._rate},function(K$c){this._rate=K$c}),K$E.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",K$E.TEMPLET_DICTIONARY=null,K$E}(K$F)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(K$c,K$P){"use strict";for(var K$q in Object.defineProperty(K$P,"__esModule",{value:!0}),Laya){var K$_=Laya[K$q];K$_&&K$_.__isclass&&(K$P[K$q]=K$_)}});