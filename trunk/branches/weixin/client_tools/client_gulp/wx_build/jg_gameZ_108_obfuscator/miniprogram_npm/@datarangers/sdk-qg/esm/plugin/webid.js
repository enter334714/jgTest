function t(t){let e=0,n=0;const i=(t+="").length;for(let f=0;f<i;f++)e=31*e+t.charCodeAt(n++),(e>0x7fffffffffff||e<-0x800000000000)&&(e&=0xffffffffffff);return e<0&&(e+=0x7ffffffffffff),e}function e(t){var e;if(!t.option.get("enable_custom_webid"))return null===(e=t.adapter._log)||void 0===e?void 0:e.warn("需要开启enable_custom_webid"),!1;return!0}function n(t,e){0!==t.indexOf(encodeURIComponent("https://"))&&0!==t.indexOf(encodeURIComponent("http://"))||(t=(t=>{let e=t;try{e=decodeURIComponent(t)}catch(t){}return e})(t));const n=/([^?#]+)(\?[^#]*)?(#.*)?/.exec(t),i=n[1]||"",f=n[2]||"",o=n[3]||"",r=f?(t=>{const e={};return t&&t.split("&").forEach((t=>{if(t){const n=t.split("=");n[0]&&(e[n[0]]=n[1]||"")}})),e})(f.substring(1)):{};return r.Web_ID=e,t=i+((t,e)=>{let n=t;if(e){const t=[];Object.keys(e).forEach((n=>{t.push(`${n}=${e[n]}`)})),t.length>0&&(n+=`?${t.join("&")}`)}return n})("",r)+o,t}class i{static init(f){f.prototype.setWebId=function(n){if(null==n||!e(this))return;const i=t(`${n}`);this.config({web_id:`${i}`})},f.prototype.setWebIDviaUnionID=function(n){if(!n||!e(this))return;const i=t(String(n).trim());this.config({web_id:`${i}`,wechat_unionid:n})},f.prototype.setWebIDviaOpenID=function(n){if(!n||!e(this))return;const i=t(String(n).trim());this.config({web_id:`${i}`,wechat_openid:n})},f.prototype.createWebViewUrl=function(t){if(!t||!this.ready)return t;const e=this.env.get(i.key);if(!e)return t;return n(t,e)},f.prototype.createWebViewUrlAsync=function(t){if(!t)return Promise.resolve(t);return this.ready?Promise.resolve(this.process(t,this.env.get(i.key))):new Promise((e=>{this.on(this.types.Ready,(()=>{e(n(t,this.env.get(i.key)))}))}))}}apply(t,e){}}i.pluginName="official:webid",i.key="web_id";export{i as default};
