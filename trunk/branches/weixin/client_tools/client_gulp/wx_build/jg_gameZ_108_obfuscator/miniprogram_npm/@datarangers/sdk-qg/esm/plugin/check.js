class e{apply(e,s){this.sdk=e,this.options=s;const{types:a}=this.sdk;this.sdk.on(a.Check,(({type:e,value:s})=>{var a;if("event"===e){const e=s;if("applog_trace"===e.event)return;const i=0===(null===(a=e.event)||void 0===a?void 0:a.indexOf("__profile_"));i||this.check("name",e.event),this.sdk.isObject(e.params)&&Object.keys(e.params).forEach((s=>{this.check(i?"profile":"param",s,e.params[s])}))}else if("config"===e){const e=s;this.sdk.isObject(e)&&Object.keys(e).forEach((s=>{if("evtParams"===s){const{evtParams:s}=e;this.sdk.isObject(s)&&Object.keys(s).forEach((e=>{this.check("header",e,s[e])}))}else this.check("header",s,e[s])}))}}))}check(e,s,a){const i=e=>/^[a-zA-Z0-9][a-z0-9A-Z_ .-]{0,255}$/.test(e);switch(e){case"name":i(String(s))||this.warn(`event name ${s} illegal`);break;case"param":case"header":case"profile":{const t="param"===e?"event params":"header"===e?"config":"profile";"profile"!==s&&["$inactive","$inline","$target_uuid_list","$source_uuid","$is_spider","$source_id","$is_first_time"].includes(s)||i(String(s))||this.warn(`${t} name ${s} illegal`),"string"!=typeof a||(e=>String(e).length<=1024)(a)||this.warn(`the value ${a} length more than 1024 in ${t} ${s}`);break}}}warn(e){var s,a;null===(a=null===(s=this.sdk.adapter._log)||void 0===s?void 0:s.warn)||void 0===a?void 0:a.call(s,e)}}e.pluginName="official:check";export{e as default};
