var Laya=window.Laya=function(VR,Vn){var VX={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(Vn,Va){return 1==arguments.length?VX.__presubstr.call(this,Vn):VX.__presubstr.call(this,Vn,0<Va?Va:this.length+Va)},__init:function(Vn){Vn.forEach(function(Vn){Vn.__init$&&Vn.__init$()})},__isClass:function(Vn){return Vn&&(Vn.__isclass||Vn==Object||Vn==String||Vn==Array)},__newvec:function(Vn,Va){var VU=[];VU.length=Vn;for(var Vx=0;Vx<Vn;Vx++)VU[Vx]=Va;return VU},__extend:function(Vn,Va){for(var VU in Va)if(Va.hasOwnProperty(VU)){var Vx=Object.getOwnPropertyDescriptor(Va,VU),VD=Vx.get,Vp=Vx.set;VD||Vp?VD&&Vp?Object.defineProperty(Vn,VU,Vx):(VD&&Object.defineProperty(Vn,VU,VD),Vp&&Object.defineProperty(Vn,VU,Vp)):Vn[VU]=Va[VU]}function VQ(){VX.un(this,"constructor",Vn)}VQ.prototype=Va.prototype,Vn.prototype=new VQ,VX.un(Vn.prototype,"__imps",VX.__copy({},Va.prototype.__imps))},__copy:function(Vn,Va){if(!Va)return null;for(var VU in Vn=Vn||{},Va)Vn[VU]=Va[VU];return Vn},__package:function(Vn,Va){if(!VX.__packages[Vn]){VX.__packages[Vn]=!0;var VU=VR,Vx=Vn.split(".");if(1<Vx.length)for(var VD=0,Vp=Vx.length-1;VD<Vp;VD++){var VQ=VU[Vx[VD]];VU=VQ||(VU[Vx[VD]]={})}VU[Vx[Vx.length-1]]||(VU[Vx[Vx.length-1]]=Va||{})}},__hasOwnProperty:function(Vn,Va){return Va=Va||this,Object.hasOwnProperty.call(Va,Vn)||function Vn(Va,VU){if(Object.hasOwnProperty.call(VU.prototype,Va))return!0;var Vx=VU.prototype.__super;return null==Vx?null:Vn(Va,Vx)}(Vn,Va.__class)},__typeof:function(Vn,Va){if(!Vn||!Va)return!1;if(Va===String)return"string"==typeof Vn;if(Va===Number)return"number"==typeof Vn;if(Va.__interface__)Va=Va.__interface__;else if("string"!=typeof Va)return Vn instanceof Va;return Vn.__imps&&Vn.__imps[Va]||Vn.__class==Va},__as:function(Vn,Va){return this.__typeof(Vn,Va)?Vn:null},__int:function(Vn){return Vn?parseInt(Vn):0},interface:function(Vn,Va){VX.__package(Vn,{});var VU=VX.__internals,Vx=VU[Vn]=VU[Vn]||{self:Vn};if(Va){var VD=Va.split(",");Vx.extend=[];for(var Vp=0;Vp<VD.length;Vp++){var VQ=VD[Vp];VU[VQ]=VU[VQ]||{self:VQ},Vx.extend.push(VU[VQ])}}var VV=VR,Vy=Vn.split(".");for(Vp=0;Vp<Vy.length-1;Vp++)VV=VV[Vy[Vp]];VV[Vy[Vy.length-1]]={__interface__:Vn}},class:function(Vn,Va,VU,Vx){if(VU&&VX.__extend(Vn,VU),Va)if(VX.__package(Va,Vn),VX.__classmap[Va]=Vn,0<Va.indexOf(".")){if(0==Va.indexOf("laya.")){var VD=Va.split(".");Vx=Vx||VD[VD.length-1],VX[Vx]&&console.log("Warning!,this class["+Vx+"] already exist:",VX[Vx]),VX[Vx]=Vn}}else"Main"==Va?VR.Main=Vn:"MainWX"==Va?VR.MainWX=Vn:(VX[Va]&&console.log("Error!,this class["+Va+"] already exist:",VX[Va]),VX[Va]=Vn);var Vp=VX.un,VQ=Vn.prototype;Vp(VQ,"hasOwnProperty",VX.__hasOwnProperty),Vp(VQ,"__class",Vn),Vp(VQ,"__super",VU),Vp(VQ,"__className",Va),Vp(Vn,"__super",VU),Vp(Vn,"__className",Va),Vp(Vn,"__isclass",!0),Vp(Vn,"super",function(Vn){this.__super.call(Vn)})},imps:function(Vn,Va){if(!Va)return null;var VD=Vn.__imps||VX.un(Vn,"__imps",{});function Vp(Vn){var Va,VU;if((Va=VX.__internals[Vn])&&(VD[Vn]=!0,VU=Va.extend))for(var Vx=0;Vx<VU.length;Vx++)Vp(VU[Vx].self)}for(var VU in Va)Vp(VU)},superSet:function(Vn,Va,VU,Vx){var VD=Vn.prototype["_$set_"+VU];VD&&VD.call(Va,Vx)},superGet:function(Vn,Va,VU){var Vx=Vn.prototype["_$get_"+VU];return Vx?Vx.call(Va):null},getset:function(Vn,Va,VU,Vx,VD){Vn?(Vx&&(Va["_$GET_"+VU]=Vx),VD&&(Va["_$SET_"+VU]=VD)):(Vx&&VX.un(Va,"_$get_"+VU,Vx),VD&&VX.un(Va,"_$set_"+VU,VD)),Vx&&VD?Object.defineProperty(Va,VU,{get:Vx,set:VD,enumerable:!1,configurable:!0}):(Vx&&Object.defineProperty(Va,VU,{get:Vx,enumerable:!1,configurable:!0}),VD&&Object.defineProperty(Va,VU,{set:VD,enumerable:!1,configurable:!0}))},static:function(VU,Vx){for(var VD=0,Vn=Vx.length;VD<Vn;VD+=2)if("length"==Vx[VD])VU.length=Vx[VD+1].call(VU);else{function Va(){var Va=Vx[VD],Vn=Vx[VD+1];Object.defineProperty(VU,Va,{get:function(){return delete this[Va],this[Va]=Vn.call(this)},set:function(Vn){delete this[Va],this[Va]=Vn},enumerable:!0,configurable:!0})}Va()}},un:function(Vn,Va,VU){return VU||(VU=Vn[Va]),VX.__propun.value=VU,Object.defineProperty(Vn,Va,VX.__propun),VU},uns:function(Va,Vn){Vn.forEach(function(Vn){VX.un(Va,Vn)})}};return VR.console=VR.console||{log:function(){}},VR.trace=VR.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),VX}(window,document);!function(Vn,Va,VU){VU.un,VU.uns,VU.static,VU.class,VU.getset,VU.__newvec}(window,document,Laya),function(VQ,Va,Vk){Vk.un,Vk.uns;var Vy=Vk.static,Vm=Vk.class,VX=Vk.getset;Vk.__newvec;Vk.interface("laya.runtime.IMarket"),Vk.interface("laya.filters.IFilter"),Vk.interface("laya.display.ILayout"),Vk.interface("laya.resource.IDispose"),Vk.interface("laya.runtime.IPlatform"),Vk.interface("laya.resource.IDestroy"),Vk.interface("laya.runtime.IConchNode"),Vk.interface("laya.filters.IFilterAction"),Vk.interface("laya.runtime.ICPlatformClass"),Vk.interface("laya.resource.ICreateResource"),Vk.interface("laya.runtime.IConchRenderObject"),Vk.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var Vu=function(){function Vp(){}return Vm(Vp,"laya.utils.RunDriver"),Vp.FILTER_ACTIONS=[],Vp.pixelRatio=-1,Vp._charSizeTestDiv=null,Vp.now=function(){return Date.now()},Vp.getWindow=function(){return VQ},Vp.getPixelRatio=function(){if(Vp.pixelRatio<0){var Vn=Vf.context,Va=Vn.backingStorePixelRatio||Vn.webkitBackingStorePixelRatio||Vn.mozBackingStorePixelRatio||Vn.msBackingStorePixelRatio||Vn.oBackingStorePixelRatio||Vn.backingStorePixelRatio||1;(Vp.pixelRatio=(Vf.window.devicePixelRatio||1)/Va)<1&&(Vp.pixelRatio=1)}return Vp.pixelRatio},Vp.getIncludeStr=function(Vn){return null},Vp.createShaderCondition=function(Vn){var Va="(function() {return "+Vn+";})";return Vk._runScript(Va)},Vp.fontMap=[],Vp.measureText=function(Vn,Va){var VU=Vp.hanzi.test(Vn);if(VU&&Vp.fontMap[Va])return Vp.fontMap[Va];var Vx=Vf.context;Vx.font=Va;var VD=Vx.measureText(Vn);return VD||(VD={width:16,height:16}),VU&&(Vp.fontMap[Va]=VD),VD},Vp.getWebGLContext=function(Vn){},Vp.beginFlush=function(){},Vp.endFinish=function(){},Vp.addToAtlas=null,Vp.flashFlushImage=function(Vn){},Vp.drawToCanvas=function(Vn,Va,VU,Vx,VD,Vp){var VQ=VTn.create("2D"),VV=new Vv(VU,Vx,VQ);return Vl.renders[Va]._fun(Vn,VV,VD,Vp),VQ},Vp.createParticleTemplate2D=null,Vp.createGLTextur=null,Vp.createWebGLContext2D=null,Vp.changeWebGLSize=function(Vn,Va){},Vp.createRenderSprite=function(Vn,Va){return new Vl(Vn,Va)},Vp.createFilterAction=function(Vn){return new VT},Vp.createGraphics=function(){return new Vi},Vp.clear=function(Vn){VI._context.ctx.clear()},Vp.cancelLoadByUrl=function(Vn){},Vp.clearAtlas=function(Vn){},Vp.isAtlas=function(Vn){return!1},Vp.addTextureToAtlas=function(Vn){},Vp.getTexturePixels=function(Vn,Va,VU,Vx,VD){return null},Vp.skinAniSprite=function(){return null},Vp.update3DLoop=function(){},Vy(Vp,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),Vp}(),Vx=(VX(1,Vk,"alertGlobalError",null,function(Vn){var Vp=0;Vf.window.onerror=Vn?function(Vn,Va,VU,Vx,VD){Vp++<5&&VD&&alert(VD.stack||VD)}:null}),Vk.init=function(Vn,Va,VU){for(var Vx=[],VD=2,Vp=arguments.length;VD<Vp;VD++)Vx.push(arguments[VD]);if(!Vk._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=Vk._arrayBufferSlice),Vk._isinit=!0,Vf.__init__(),Vj.__init__(),Vi.__init__(),Vk.timer=new Vs,Vk.scaleTimer=new Vs,Vk.loader=new Vyn,VJ.__init__(),VD=0;for(var VQ=Vx.length;VD<VQ;VD++)Vx[VD].enable&&Vx[VD].enable();return Vq.__init__(),VV.__init__(),Vh.__init__(),Vg.beginCheck(),Vk._currentStage=Vk.stage=new VPn,Vk.stage.conchModel&&Vk.stage.conchModel.setRootNode(),Vk._getUrlPath(),Vk.render=new VI(0,0),Vk.stage.size(Vn,Va),Vl.__init__(),Vz.__init__(),VE.instance.__init__(Vk.stage,VI.canvas),VYn.__init__(),VZ.autoStopMusic=!0,V$.__init__(),VI.canvas}},Vk._getUrlPath=function(){var Vn=Vf.window.location,Va=Vn.pathname;Va=Va&&":"==Va.charAt(2)?Va.substring(1):Va,VG.rootPath=VG.basePath=VG.getPath("file:"==Vn.protocol?Va:Vn.protocol+"//"+Vn.host+Vn.pathname)},Vk._arrayBufferSlice=function(Vn,Va){var VU=new Uint8Array(this,Vn,Va-Vn),Vx=new Uint8Array(VU.length);return Vx.set(VU),Vx.buffer},Vk._runScript=function(Vn){return Vf.window[Vk._evcode](Vn)},Vk.stage=null,Vk.timer=null,Vk.scaleTimer=null,Vk.loader=null,Vk.version="1.8.6",Vk.render=null,Vk._currentStage=null,Vk._isinit=!1,Vk.isDebug=!1,Vk.MiniAdpter={init:function(){VQ.navigator&&VQ.navigator.userAgent&&-1<VQ.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},Vy(Vk,["conchMarket",function(){return this.conchMarket=VQ.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=VQ.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function Vn(){}return Vm(Vn,"Config"),Vn.WebGLTextCacheCount=500,Vn.atlasEnable=!1,Vn.showCanvasMark=!1,Vn.animationInterval=50,Vn.isAntialias=!1,Vn.isAlpha=!1,Vn.premultipliedAlpha=!0,Vn.isStencil=!0,Vn.preserveDrawingBuffer=!1,Vn}()),VR=function(){function VR(){this._events=null}Vm(VR,"laya.events.EventDispatcher");var Vn=VR.prototype;return Vn.hasListener=function(Vn){return!!(this._events&&this._events[Vn])},Vn.getListener=function(Vn){return this._events?this._events[Vn]:null},Vn.event=function(Vn,Va){if(!this._events||!this._events[Vn])return!1;var VU=this._events[Vn];if(VU.lock)VU.queue||(VU.queue=[]),VU.queue.push(Va);else{var Vx;for(VU.lock=!0,VU.cursor=VU.head;VU.cursor;)(Vx=VU.cursor).recover?(VU.head=VU.tail=VU.cursor=null,console.error("node is recover："+Vx.id)):(VU.cursor=Vx.next,Vx.once&&VR.delNode(VU,Vx),Vx.method&&(null!=Va?Vx.args?Vx.method.apply(Vx.caller,Vx.args.concat(Va)):Va instanceof Array?Vx.method.apply(Vx.caller,Va):Vx.caller?Vx.method.call(Vx.caller,Va):Vk.recordError("事件派发错误","node.caller:"+Vx.caller+"node.method:"+Vx.method+"data:"+Va+"node.prev"+Vx.prev):Vx.method.apply(Vx.caller,Vx.args)),Vx.once&&VR.recoverHandler(Vx));VU.lock=!1,!VU.head&&this._events&&this._events[Vn]==VU&&delete this._events[Vn],VU.queue&&VU.queue.length&&this.event(Vn,VU.queue.shift())}return!0},Vn.on=function(Vn,Va,VU,Vx){return this._createListener(Vn,Va,VU,Vx,!1)},Vn.once=function(Vn,Va,VU,Vx){return this._createListener(Vn,Va,VU,Vx,!0)},Vn._createListener=function(Vn,Va,VU,Vx,VD,Vp){void 0===Vp&&(Vp=!0),Vp&&this.off(Vn,Va,VU,VD);var VQ=VR.createHandler(Va||this,VU,Vx,VD);this._events||(this._events={});var VV=this._events,Vy=VV[Vn];return Vy?Vy.tail?(VQ.prev=Vy.tail,Vy.tail.next=VQ,Vy.tail=VQ):Vy.head=Vy.tail=VQ:VV[Vn]={head:VQ,tail:VQ,cursor:null,lock:!1},this},Vn.off=function(Vn,Va,VU,Vx){if(void 0===Vx&&(Vx=!1),!this._events||!this._events[Vn])return this;for(var VD=this._events[Vn],Vp=VD.head;Vp;){if((!Va||Vp.caller===Va)&&Vp.method===VU&&(!Vx||Vp.once)){VR.delNode(VD,Vp),VD.cursor==Vp&&(VD.cursor=Vp.next),VR.recoverHandler(Vp);break}Vp=Vp.next}return this},Vn.offAll=function(Vn){var Va=this._events;if(!Va)return this;if(Vn)this._recoverHandlers(Va[Vn]),delete Va[Vn];else{for(var VU in Va)this._recoverHandlers(Va[VU]);this._events=null}return this},Vn._recoverHandlers=function(Vn){if(Vn){for(var Va=Vn.head;Va;){VR.delNode(Vn,Va);var VU=Va.next;VR.recoverHandler(Va),Va=VU}Vn.cursor=null}},Vn.isMouseEvent=function(Vn){return VR.MOUSE_EVENTS[Vn]},VR.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},VR.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},VR.delNode=function(Vn,Va){Va.prev?Va.prev.next=Va.next:Vn.head=Va.next,Va.next?Va.next.prev=Va.prev:Vn.tail=Va.prev},VR.createHandler=function(Vn,Va,VU,Vx){var VD=500<VR._freeHandler.length?VR._freeHandler.shift():null;if(VD)if(VD.recover)VD.recover=!1,VD.caller=Vn,VD.method=Va,VD.args=VU,VD.once=Vx;else{var Vp="";try{arguments.propertyIsEnumerable.caller}catch(Vn){Vp=Vn.stack}var VQ=VD.caller?(VD.caller.__proto__&&VD.caller.__proto__.constructor&&VD.caller.__proto__.constructor.name)+"|"+VD.caller.__className+"|"+VD.caller.name:"",VV=VD.method?VD.method.name:"";Vk.recordError("EventDispatcher重复创建","caller="+VQ+"  method="+VV+"  stack="+Vp),VD={id:++VR._nodeCount,caller:Vn,method:Va,args:VU,once:Vx,recover:!1}}else VD={id:++VR._nodeCount,caller:Vn,method:Va,args:VU,once:Vx,recover:!1};return VD.prev=VD.next=null,VD},VR.recoverHandler=function(Vn){if(Vn.recover){if(VR._errorCount<5){VR._errorCount++;var Va="";try{arguments.propertyIsEnumerable.caller}catch(Vn){Va=Vn.stack}var VU=Vn.caller?(Vn.caller.__proto__&&Vn.caller.__proto__.constructor&&Vn.caller.__proto__.constructor.name)+"|"+Vn.caller.__className+"|"+Vn.caller.name:"",Vx=Vn.method?Vn.method.name:"";Vk.recordError("EventDispatcher重复回收","id="+Vn.id+"  caller="+VU+"  method="+Vx+"  stack="+Va)}Vn.caller=Vn.method=Vn.args=Vn.prev=null}else Vn.recover=!0,Vn.caller=Vn.method=Vn.args=Vn.prev=Vn.next=null,VR._freeHandler&&VR._freeHandler.length<3e3&&VR._freeHandler.push(Vn)},VR._freeHandler=[],VR._nodeCount=0,VR._errorCount=0,VR}(),VA=function(){function VD(Vn,Va,VU,Vx){this.once=!1,void(this._id=0)===Vx&&(Vx=!1),this.setTo(Vn,Va,VU,Vx)}Vm(VD,"laya.utils.Handler");var Vn=VD.prototype;return Vn.setTo=function(Vn,Va,VU,Vx){return this._id=VD._gid++,this.caller=Vn,this.method=Va,this.args=VU,this.once=Vx,this},Vn.run=function(){if(null==this.method)return null;var Vn=this._id,Va=this.method.apply(this.caller,this.args);return this._id===Vn&&this.once&&this.recover(),Va},Vn.runWith=function(Vn){if(null==this.method)return null;var Va=this._id;if(null==Vn)var VU=this.method.apply(this.caller,this.args);else VU=this.args||Vn.unshift?this.args?this.method.apply(this.caller,this.args.concat(Vn)):this.method.apply(this.caller,Vn):this.method.call(this.caller,Vn);return this._id===Va&&this.once&&this.recover(),VU},Vn.clear=function(){return this.caller=null,this.method=null,this.args=null,this},Vn.recover=function(){0<this._id&&(this._id=0,this.clear())},VD.create=function(Vn,Va,VU,Vx){return void 0===Vx&&(Vx=!0),new VD(Vn,Va,VU,Vx)},VD._gid=1,VD}(),VM=function(){function Vn(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}Vm(Vn,"laya.display.BitmapFont");var Va=Vn.prototype;return Va.loadFont=function(Vn,Va){this._path=Vn,this._complete=Va,Vk.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],VA.create(this,this.onLoaded))},Va.onLoaded=function(){this.parseFont(VVn.getRes(this._path),VVn.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},Va.parseFont=function(Vn,Va){if(null!=Vn&&null!=Va){this._texture=Va;var VU=Vn.getElementsByTagName("info");if(!VU[0].getAttributeNode)return this.parseFont2(Vn,Va);this.fontSize=parseInt(VU[0].getAttributeNode("size").nodeValue);var Vx,VD=VU[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(VD[0]),parseInt(VD[1]),parseInt(VD[2]),parseInt(VD[3])],Vx=Vn.getElementsByTagName("char");var Vp=0;for(Vp=0;Vp<Vx.length;Vp++){var VQ=Vx[Vp],VV=parseInt(VQ.getAttributeNode("id").nodeValue),Vy=parseInt(VQ.getAttributeNode("xoffset").nodeValue)/1,VR=parseInt(VQ.getAttributeNode("yoffset").nodeValue)/1,VX=parseInt(VQ.getAttributeNode("xadvance").nodeValue)/1,Vz=new V_;Vz.x=parseInt(VQ.getAttributeNode("x").nodeValue),Vz.y=parseInt(VQ.getAttributeNode("y").nodeValue),Vz.width=parseInt(VQ.getAttributeNode("width").nodeValue),Vz.height=parseInt(VQ.getAttributeNode("height").nodeValue);var Vi=VXn.create(Va,Vz.x,Vz.y,Vz.width,Vz.height,Vy,VR);this._maxWidth=Math.max(this._maxWidth,VX+this.letterSpacing),this._fontCharDic[VV]=Vi,this._fontWidthMap[VV]=VX}}},Va.parseFont2=function(Vn,Va){if(null!=Vn&&null!=Va){this._texture=Va;var VU=Vn.getElementsByTagName("info");this.fontSize=parseInt(VU[0].attributes.size.nodeValue);var Vx=VU[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(Vx[0]),parseInt(Vx[1]),parseInt(Vx[2]),parseInt(Vx[3])];var VD=Vn.getElementsByTagName("char"),Vp=0;for(Vp=0;Vp<VD.length;Vp++){var VQ=VD[Vp].attributes,VV=parseInt(VQ.id.nodeValue),Vy=parseInt(VQ.xoffset.nodeValue)/1,VR=parseInt(VQ.yoffset.nodeValue)/1,VX=parseInt(VQ.xadvance.nodeValue)/1,Vz=new V_;Vz.x=parseInt(VQ.x.nodeValue),Vz.y=parseInt(VQ.y.nodeValue),Vz.width=parseInt(VQ.width.nodeValue),Vz.height=parseInt(VQ.height.nodeValue);var Vi=VXn.create(Va,Vz.x,Vz.y,Vz.width,Vz.height,Vy,VR);this._maxWidth=Math.max(this._maxWidth,VX+this.letterSpacing),this._fontCharDic[VV]=Vi,this._fontWidthMap[VV]=VX}}},Va.getCharTexture=function(Vn){return this._fontCharDic[Vn.charCodeAt(0)]},Va.destroy=function(){if(this._texture){for(var Vn in this._fontCharDic){var Va=this._fontCharDic[Vn];Va&&Va.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},Va.setSpaceWidth=function(Vn){this._spaceWidth=Vn},Va.getCharWidth=function(Vn){var Va=Vn.charCodeAt(0);return this._fontWidthMap[Va]?this._fontWidthMap[Va]+this.letterSpacing:" "==Vn?this._spaceWidth+this.letterSpacing:0},Va.getTextWidth=function(Vn){for(var Va=0,VU=0,Vx=Vn.length;VU<Vx;VU++)Va+=this.getCharWidth(Vn.charAt(VU));return Va},Va.getMaxWidth=function(){return this._maxWidth},Va.getMaxHeight=function(){return this.fontSize},Va.drawText=function(Vn,Va,VU,Vx,VD,Vp){var VQ,VV=this.getTextWidth(Vn),Vy=0;"center"===VD&&(Vy=(Vp-VV)/2),"right"===VD&&(Vy=Vp-VV);for(var VR=0,VX=0,Vz=Vn.length;VX<Vz;VX++)(VQ=this.getCharTexture(Vn.charAt(VX)))&&(Va.graphics.drawTexture(VQ,VU+VR+Vy,Vx),VR+=this.getCharWidth(Vn.charAt(VX)))},Vn}(),VV=function(){function VU(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=VU._TF_EMPTY}Vm(VU,"laya.display.css.Style");var Vn=VU.prototype;return Vn.getTransform=function(){return this._tf},Vn.setTransform=function(Vn){this._tf="none"!==Vn&&Vn?Vn:VU._TF_EMPTY},Vn.setTranslateX=function(Vn){this._tf===VU._TF_EMPTY&&(this._tf=new VD),this._tf.translateX=Vn},Vn.setTranslateY=function(Vn){this._tf===VU._TF_EMPTY&&(this._tf=new VD),this._tf.translateY=Vn},Vn.setScaleX=function(Vn){this._tf===VU._TF_EMPTY&&(this._tf=new VD),this._tf.scaleX=Vn},Vn.setScale=function(Vn,Va){this._tf===VU._TF_EMPTY&&(this._tf=new VD),this._tf.scaleX=Vn,this._tf.scaleY=Va},Vn.setScaleY=function(Vn){this._tf===VU._TF_EMPTY&&(this._tf=new VD),this._tf.scaleY=Vn},Vn.setRotate=function(Vn){this._tf===VU._TF_EMPTY&&(this._tf=new VD),this._tf.rotate=Vn},Vn.setSkewX=function(Vn){this._tf===VU._TF_EMPTY&&(this._tf=new VD),this._tf.skewX=Vn},Vn.setSkewY=function(Vn){this._tf===VU._TF_EMPTY&&(this._tf=new VD),this._tf.skewY=Vn},Vn.destroy=function(){this.scrollRect=null},Vn.render=function(Vn,Va,VU,Vx){},Vn.getCSSStyle=function(){return Van.EMPTY},Vn._enableLayout=function(){return!1},VX(0,Vn,"scaleX",function(){return this._tf.scaleX},function(Vn){this.setScaleX(Vn)}),VX(0,Vn,"transform",function(){return this.getTransform()},function(Vn){this.setTransform(Vn)}),VX(0,Vn,"translateX",function(){return this._tf.translateX},function(Vn){this.setTranslateX(Vn)}),VX(0,Vn,"translateY",function(){return this._tf.translateY},function(Vn){this.setTranslateY(Vn)}),VX(0,Vn,"scaleY",function(){return this._tf.scaleY},function(Vn){this.setScaleY(Vn)}),VX(0,Vn,"block",function(){return 0!=(1&this._type)}),VX(0,Vn,"skewY",function(){return this._tf.skewY},function(Vn){this.setSkewY(Vn)}),VX(0,Vn,"rotate",function(){return this._tf.rotate},function(Vn){this.setRotate(Vn)}),VX(0,Vn,"skewX",function(){return this._tf.skewX},function(Vn){this.setSkewX(Vn)}),VX(0,Vn,"paddingLeft",function(){return 0}),VX(0,Vn,"paddingTop",function(){return 0}),VX(0,Vn,"absolute",function(){return!0}),VU.__init__=function(){VU._TF_EMPTY=new VD,VU.EMPTY=new VU},VU.EMPTY=null,VU._TF_EMPTY=null,VU}(),Vq=function(){function Va(Vn){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=VB.create(Va.defaultColor),this.family=Va.defaultFamily,this.stroke=Va._STROKE,this.size=Va.defaultSize,Vn&&Vn!==Va.EMPTY&&Vn.copyTo(this)}Vm(Va,"laya.display.css.Font");var Vn=Va.prototype;return Vn.set=function(Vn){this._text=null;for(var Va=Vn.split(" "),VU=0,Vx=Va.length;VU<Vx;VU++){var VD=Va[VU];switch(VD){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<VD.indexOf("px")&&(this.size=parseInt(VD),this.family=Va[VU+1],VU++)}},Vn.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},Vn.copyTo=function(Vn){Vn._type=this._type,Vn._text=this._text,Vn._weight=this._weight,Vn._color=this._color,Vn.family=this.family,Vn.stroke=this.stroke!=Va._STROKE?this.stroke.slice():Va._STROKE,Vn.indent=this.indent,Vn.size=this.size},VX(0,Vn,"password",function(){return 0!=(1024&this._type)},function(Vn){Vn?this._type|=1024:this._type&=-1025}),VX(0,Vn,"color",function(){return this._color.strColor},function(Vn){this._color=VB.create(Vn)}),VX(0,Vn,"italic",function(){return 0!=(512&this._type)},function(Vn){Vn?this._type|=512:this._type&=-513}),VX(0,Vn,"bold",function(){return 0!=(2048&this._type)},function(Vn){Vn?this._type|=2048:this._type&=-2049}),VX(0,Vn,"weight",function(){return""+this._weight},function(Vn){var Va=0;switch(Vn){case"normal":break;case"bold":this.bold=!0,Va=700;break;case"bolder":Va=800;break;case"lighter":Va=100;break;default:Va=parseInt(Vn)}this._weight=Va,this._text=null}),VX(0,Vn,"decoration",function(){return this._decoration?this._decoration.value:null},function(Vn){var Va=Vn.split(" ");switch(this._decoration||(this._decoration={}),Va[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=Va[0]}Va[1]&&(this._decoration.color=VB.create(Va)),this._decoration.value=Vn}),Va.__init__=function(){Va.EMPTY=new Va(null)},Va.EMPTY=null,Va.defaultColor="#000000",Va.defaultSize=12,Va.defaultFamily="Arial",Va.defaultFont="12px Arial",Va._STROKE=[0,"#000000"],Va._ITALIC=512,Va._PASSWORD=1024,Va._BOLD=2048,Va}(),VD=function(){function Vn(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return Vm(Vn,"laya.display.css.TransformInfo"),Vn}(),Vi=function(){function Vz(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,VI.isConchNode){this._nativeObj=new VQ._conchGraphics,this.id=this._nativeObj.conchID}}Vm(Vz,"laya.display.Graphics");var Vn=Vz.prototype;return Vn.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},Vn.clear=function(Vn){void 0===Vn&&(Vn=!1);var Va=0,VU=0;if(Vn){var Vx=this._one;if(this._cmds){for(VU=this._cmds.length,Va=0;Va<VU;Va++)!(Vx=this._cmds[Va])||Vx.callee!==VI._context._drawTexture&&Vx.callee!==VI._context._drawTextureWithTransform||(Vx[0]=null,Vz._cache.push(Vx));this._cmds.length=0}else Vx&&(!Vx||Vx.callee!==VI._context._drawTexture&&Vx.callee!==VI._context._drawTextureWithTransform||(Vx[0]=null,Vz._cache.push(Vx)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(Va=0,VU=this._vectorgraphArray.length;Va<VU;Va++)Vr.getInstance().deleteShape(this._vectorgraphArray[Va]);this._vectorgraphArray.length=0}},Vn._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},Vn._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new VU,this._graphicBounds._graphics=this)},Vn._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},Vn._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},Vn.getBounds=function(Vn){return void 0===Vn&&(Vn=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(Vn)},Vn.getBoundPoints=function(Vn){return void 0===Vn&&(Vn=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(Vn)},Vn._addCmd=function(Vn){this._cmds=this._cmds||[],Vn.callee=Vn.shift(),this._cmds.push(Vn)},Vn.setFilters=function(Vn){this._saveToCmd(VI._context._setFilters,Vn)},Vn.drawTexture=function(Vn,Va,VU,Vx,VD,Vp,VQ){if(void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=0),void 0===VD&&(VD=0),void 0===VQ&&(VQ=1),!Vn||VQ<.01)return null;Vx||(Vx=Vn.sourceWidth),VD||(VD=Vn.sourceHeight),VQ=VQ<0?0:1<VQ?1:VQ;var VV,Vy=!VI.isWebGL&&(Vf.onFirefox||Vf.onEdge||Vf.onIE||Vf.onSafari)?.5:0,VR=Vx/Vn.sourceWidth,VX=VD/Vn.sourceHeight;return Vx=Vn.width*VR,VD=Vn.height*VX,Vn.loaded&&(Vx<=0||VD<=0)?null:(Va+=Vn.offsetX*VR,VU+=Vn.offsetY*VX,this._sp&&(this._sp._renderType|=512),Va-=Vy,VU-=Vy,Vx+=2*Vy,VD+=2*Vy,Vz._cache.length?((VV=Vz._cache.pop())[0]=Vn,VV[1]=Va,VV[2]=VU,VV[3]=Vx,VV[4]=VD,VV[5]=Vp,VV[6]=VQ):VV=[Vn,Va,VU,Vx,VD,Vp,VQ],VV.callee=Vp||1!=VQ?VI._context._drawTextureWithTransform:VI._context._drawTexture,null!=this._one||Vp||1!=VQ?this._saveToCmd(VV.callee,VV):(this._one=VV,this._render=this._renderOneImg),Vn.loaded||Vn.once("loaded",this,this._textureLoaded,[Vn,VV]),this._repaint(),VV)},Vn.cleanByTexture=function(Vn,Va,VU,Vx,VD){if(void 0===Vx&&(Vx=0),void 0===VD&&(VD=0),!Vn)return this.clear();if(this._one&&this._render===this._renderOneImg){Vx||(Vx=Vn.sourceWidth),VD||(VD=Vn.sourceHeight);var Vp=Vx/Vn.sourceWidth,VQ=VD/Vn.sourceHeight;Vx=Vn.width*Vp,VD=Vn.height*VQ,Va+=Vn.offsetX*Vp,VU+=Vn.offsetY*VQ,this._one[0]=Vn,this._one[1]=Va,this._one[2]=VU,this._one[3]=Vx,this._one[4]=VD,this._repaint()}else this.clear(),Vn&&this.drawTexture(Vn,Va,VU,Vx,VD)},Vn.drawTextures=function(Vn,Va){Vn&&this._saveToCmd(VI._context._drawTextures,[Vn,Va])},Vn.fillTexture=function(Vn,Va,VU,Vx,VD,Vp,VQ){if(void 0===Vx&&(Vx=0),void 0===VD&&(VD=0),void 0===Vp&&(Vp="repeat"),Vn){var VV=[Vn,Va,VU,Vx,VD,Vp,VQ||VN.EMPTY,{}];Vn.loaded||Vn.once("loaded",this,this._textureLoaded,[Vn,VV]),this._saveToCmd(VI._context._fillTexture,VV)}},Vn._textureLoaded=function(Vn,Va){Va[3]=Va[3]||Vn.width,Va[4]=Va[4]||Vn.height,this._repaint()},Vn.fillCircle=function(Vn,Va,VU,Vx,VD,Vp,VQ){VU.bitmap.enableMerageInAtlas=!1;var VV=new Float32Array(2*(VQ+1)),Vy=new Float32Array(2*(VQ+1)),VR=new Uint16Array(3*VQ),VX=2*Math.PI/VQ,Vz=0;VV[0]=Vx,VV[1]=VD,Vy[0]=Vx/VU.width,Vy[1]=VD/VU.height;for(var Vi=2,Vq=0;Vq<VQ;Vq++){var VE=Vp*Math.cos(Vz)+Vx,Vm=Vp*Math.sin(Vz)+VD;VV[Vi]=VE,VV[Vi+1]=Vm,Vy[Vi]=VE/VU.width,Vy[Vi+1]=Vm/VU.height,Vz+=VX,Vi+=2}for(Vq=Vi=0;Vq<VQ;Vq++)VR[Vi++]=0,VR[Vi++]=Vq+1,VR[Vi++]=VQ+1<=Vq+2?1:Vq+2;this.drawTriangles(VU,Vn,Va,VV,Vy,VR)},Vn.drawTriangles=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){void 0===VV&&(VV=1),this._saveToCmd(VI._context.drawTriangles,[Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR])},Vn._saveToCmd=function(Vn,Va){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=Va,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(Va)),Va.callee=Vn,this._repaint(),Va},Vn.clipRect=function(Vn,Va,VU,Vx){this._saveToCmd(VI._context._clipRect,[Vn,Va,VU,Vx])},Vn.fillText=function(Vn,Va,VU,Vx,VD,Vp,VQ){void 0===VQ&&(VQ=0),this._saveToCmd(VI._context._fillText,[Vn,Va,VU,Vx||Vq.defaultFont,VD,Vp])},Vn.fillBorderText=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){this._saveToCmd(VI._context._fillBorderText,[Vn,Va,VU,Vx||Vq.defaultFont,VD,Vp,VQ,VV])},Vn.strokeText=function(Vn,Va,VU,Vx,VD,Vp,VQ){this._saveToCmd(VI._context._strokeText,[Vn,Va,VU,Vx||Vq.defaultFont,VD,Vp,VQ])},Vn.alpha=function(Vn){Vn=Vn<0?0:1<Vn?1:Vn,this._saveToCmd(VI._context._alpha,[Vn])},Vn.setAlpha=function(Vn){Vn=Vn<0?0:1<Vn?1:Vn,this._saveToCmd(VI._context._setAlpha,[Vn])},Vn.transform=function(Vn,Va,VU){void 0===Va&&(Va=0),void 0===VU&&(VU=0),this._saveToCmd(VI._context._transform,[Vn,Va,VU])},Vn.rotate=function(Vn,Va,VU){void 0===Va&&(Va=0),void 0===VU&&(VU=0),this._saveToCmd(VI._context._rotate,[Vn,Va,VU])},Vn.scale=function(Vn,Va,VU,Vx){void 0===VU&&(VU=0),void 0===Vx&&(Vx=0),this._saveToCmd(VI._context._scale,[Vn,Va,VU,Vx])},Vn.translate=function(Vn,Va){this._saveToCmd(VI._context._translate,[Vn,Va])},Vn.save=function(){this._saveToCmd(VI._context._save,[])},Vn.restore=function(){this._saveToCmd(VI._context._restore,[])},Vn.replaceText=function(Vn){this._repaint();var Va=this._cmds;if(Va){for(var VU=Va.length-1;-1<VU;VU--)if(this._isTextCmd(Va[VU].callee))return Va[VU][0].toUpperCase?Va[VU][0]=Vn:Va[VU][0].setText(Vn),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=Vn:this._one[0].setText(Vn),!0;return!1},Vn._isTextCmd=function(Vn){return Vn===VI._context._fillText||Vn===VI._context._fillBorderText||Vn===VI._context._strokeText},Vn.replaceTextColor=function(Vn){this._repaint();var Va=this._cmds;if(Va)for(var VU=Va.length-1;-1<VU;VU--)this._isTextCmd(Va[VU].callee)&&(Va[VU][4]=Vn,Va[VU][0].toUpperCase||(Va[VU][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=Vn,this._one[0].toUpperCase||(this._one[0].changed=!0))},Vn.loadImage=function(Vn,Va,VU,Vx,VD,Vp){var VQ=this;void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=0),void 0===VD&&(VD=0);var VV=VVn.getRes(Vn);function Vy(Vn){Vn&&(VQ.drawTexture(Vn,Va,VU,Vx,VD),null!=Vp&&Vp.call(VQ._sp,Vn))}VV?Vy(VV):Vk.loader.load(Vn,VA.create(null,Vy),null,"image")},Vn._renderEmpty=function(Vn,Va,VU,Vx){},Vn._renderAll=function(Vn,Va,VU,Vx){for(var VD,Vp=this._cmds,VQ=0,VV=Vp.length;VQ<VV;VQ++)(VD=Vp[VQ]).callee.call(Va,VU,Vx,VD)},Vn._renderOne=function(Vn,Va,VU,Vx){this._one.callee.call(Va,VU,Vx,this._one)},Vn._renderOneImg=function(Vn,Va,VU,Vx){this._one.callee.call(Va,VU,Vx,this._one),2305!==Vn._renderType&&(Vn._renderType|=1)},Vn.drawLine=function(Vn,Va,VU,Vx,VD,Vp){void 0===Vp&&(Vp=1);var VQ=0;VI.isWebGL&&(VQ=Vr.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(VQ));var VV=Vp%2==0?0:.5,Vy=[Vn+VV,Va+VV,VU+VV,Vx+VV,VD,Vp,VQ];this._saveToCmd(VI._context._drawLine,Vy)},Vn.drawLines=function(Vn,Va,VU,Vx,VD){void 0===VD&&(VD=1);var Vp=0;if(VU&&!(VU.length<4)){VI.isWebGL&&(Vp=Vr.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Vp));var VQ=VD%2==0?0:.5,VV=[Vn+VQ,Va+VQ,VU,Vx,VD,Vp];this._saveToCmd(VI._context._drawLines,VV)}},Vn.drawCurves=function(Vn,Va,VU,Vx,VD){void 0===VD&&(VD=1);var Vp=[Vn,Va,VU,Vx,VD];this._saveToCmd(VI._context._drawCurves,Vp)},Vn.drawRect=function(Vn,Va,VU,Vx,VD,Vp,VQ){void 0===VQ&&(VQ=1);var VV=Vp?VQ/2:0,Vy=Vp?VQ:0,VR=[Vn+VV,Va+VV,VU-Vy,Vx-Vy,VD,Vp,VQ];this._saveToCmd(VI._context._drawRect,VR)},Vn.drawCircle=function(Vn,Va,VU,Vx,VD,Vp){void 0===Vp&&(Vp=1);var VQ=VD?Vp/2:0,VV=0;VI.isWebGL&&(VV=Vr.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(VV));var Vy=[Vn,Va,VU-VQ,Vx,VD,Vp,VV];this._saveToCmd(VI._context._drawCircle,Vy)},Vn.drawPie=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){void 0===VV&&(VV=1);var Vy=VQ?VV/2:0,VR=VQ?VV:0,VX=0;VI.isWebGL&&(VX=Vr.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(VX));var Vz=[Vn+Vy,Va+Vy,VU-VR,Vx,VD,Vp,VQ,VV,VX];Vz[3]=Vt.toRadian(Vx),Vz[4]=Vt.toRadian(VD),this._saveToCmd(VI._context._drawPie,Vz)},Vn.drawPoly=function(Vn,Va,VU,Vx,VD,Vp){void 0===Vp&&(Vp=1);var VQ=0,VV=!1;VI.isWebGL&&(VQ=Vr.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(VQ),VV=!(6<VU.length));var Vy=VD?Vp%2==0?0:.5:0,VR=[Vn+Vy,Va+Vy,VU,Vx,VD,Vp,VQ,VV];this._saveToCmd(VI._context._drawPoly,VR)},Vn.drawPath=function(Vn,Va,VU,Vx,VD){var Vp=[Vn,Va,VU,Vx,VD];this._saveToCmd(VI._context._drawPath,Vp)},VX(0,Vn,"cmds",function(){return this._cmds},function(Vn){this._sp&&(this._sp._renderType|=512),this._cmds=Vn,this._render=this._renderAll,this._repaint()}),Vz.__init__=function(){if(VI.isConchNode){for(var Vn=laya.display.Graphics.prototype,Va=Vf.window.ConchGraphics.prototype,VU=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],Vx=0,VD=VU.length;Vx<=VD;Vx++){var Vp=VU[Vx];Vn[Vp]=Va[Vp]}Vn._saveToCmd=null,Va.drawImageS&&(Vn.drawTextures=function(Vn,Va){if(Vn&&Vn.loaded&&Vn.bitmap&&Vn.source){var VU=Vn.uv,Vx=Vn.bitmap.width,VD=Vn.bitmap.height;this.drawImageS(Vn.bitmap.source,VU[0]*Vx,VU[1]*VD,(VU[2]-VU[0])*Vx,(VU[5]-VU[3])*VD,Vn.offsetX,Vn.offsetY,Vn.width,Vn.height,Va)}}),Vn.drawTexture=function(Vn,Va,VU,Vx,VD,Vp,VQ){if(void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=0),void 0===VD&&(VD=0),void 0===VQ&&(VQ=1),Vn)if(Vn.loaded){if(Vn.loaded&&Vn.bitmap&&Vn.source&&(Vx||(Vx=Vn.sourceWidth),VD||(VD=Vn.sourceHeight),VQ=VQ<0?0:1<VQ?1:VQ,Vx=Vx-Vn.sourceWidth+Vn.width,VD=VD-Vn.sourceHeight+Vn.height,!(Vx<=0||VD<=0))){Va+=Vn.offsetX,VU+=Vn.offsetY;var VV=Vn.uv,Vy=Vn.bitmap.width,VR=Vn.bitmap.height;VV[4]<VV[0]&&VV[5]<VV[1]?this.drawImageM(Vn.bitmap.source,VV[4]*Vy,VV[5]*VR,(VV[0]-VV[4])*Vy,(VV[1]-VV[5])*VR,Va,VU,Vx,VD,Vp,VQ):this.drawImageM(Vn.bitmap.source,VV[0]*Vy,VV[1]*VR,(VV[2]-VV[0])*Vy,(VV[5]-VV[3])*VR,Va,VU,Vx,VD,Vp,VQ),this._repaint()}}else Vn.once("loaded",this,function(){this.drawTexture(Vn,Va,VU,Vx,VD,Vp)})},Vn.fillTexture=function(Vn,Va,VU,Vx,VD,Vp,VQ){if(void 0===Vx&&(Vx=0),void 0===VD&&(VD=0),void 0===Vp&&(Vp="repeat"),Vn&&Vn.loaded){var VV,Vy=VI._context.ctx,VR=Vn.bitmap.width,VX=Vn.bitmap.height,Vz=Vn.uv;VV=Vn.uv!=VXn.DEF_UV?Vy.createPattern(Vn.bitmap.source,Vp,Vz[0]*VR,Vz[1]*VX,(Vz[2]-Vz[0])*VR,(Vz[5]-Vz[3])*VX):Vy.createPattern(Vn.bitmap.source,Vp);var Vi=0,Vq=0;VQ&&(Va+=VQ.x%Vn.width,VU+=VQ.y%Vn.height,Vi-=VQ.x%Vn.width,Vq-=VQ.y%Vn.height),this._fillImage(VV,Va,VU,Vi,Vq,Vx,VD)}}}},Vz._cache=[],Vz}(),VU=function(){function VT(){this._cacheBoundsType=!1}Vm(VT,"laya.display.GraphicsBounds");var Vn=VT.prototype;return Vn.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},Vn.reset=function(){this._temp&&(this._temp.length=0)},Vn.getBounds=function(Vn){return void 0===Vn&&(Vn=!1),(!this._bounds||!this._temp||this._temp.length<1||Vn!=this._cacheBoundsType)&&(this._bounds=V_._getWrapRec(this.getBoundPoints(Vn),this._bounds)),this._cacheBoundsType=Vn,this._bounds},Vn.getBoundPoints=function(Vn){return void 0===Vn&&(Vn=!1),(!this._temp||this._temp.length<1||Vn!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(Vn)),this._cacheBoundsType=Vn,this._rstBoundPoints=Vt.copyArray(this._rstBoundPoints,this._temp)},Vn._getCmdPoints=function(Vn){void 0===Vn&&(Vn=!1);var Va,VU,Vx=VI._context,VD=this._graphics.cmds;if((Va=this._temp||(this._temp=[])).length=0,VD||null==this._graphics._one||(VT._tempCmds.length=0,VT._tempCmds.push(this._graphics._one),VD=VT._tempCmds),!VD)return Va;(VU=VT._tempMatrixArrays).length=0;var Vp=VT._initMatrix;Vp.identity();for(var VQ,VV,Vy=VT._tempMatrix,VR=NaN,VX=NaN,Vz=NaN,Vi=NaN,Vq=NaN,VE=NaN,Vm=0,Vb=VD.length;Vm<Vb;Vm++)if((VQ=VD[Vm]).callee)switch(VQ.callee){case Vx._save:case 7:VU.push(Vp),Vp=Vp.clone();break;case Vx._restore:case 8:Vp=VU.pop();break;case Vx._scale:case 5:Vy.identity(),Vy.translate(-VQ[2],-VQ[3]),Vy.scale(VQ[0],VQ[1]),Vy.translate(VQ[2],VQ[3]),this._switchMatrix(Vp,Vy);break;case Vx._rotate:case 3:Vy.identity(),Vy.translate(-VQ[1],-VQ[2]),Vy.rotate(VQ[0]),Vy.translate(VQ[1],VQ[2]),this._switchMatrix(Vp,Vy);break;case Vx._translate:case 6:Vy.identity(),Vy.translate(VQ[0],VQ[1]),this._switchMatrix(Vp,Vy);break;case Vx._transform:case 4:Vy.identity(),Vy.translate(-VQ[1],-VQ[2]),Vy.concat(VQ[0]),Vy.translate(VQ[1],VQ[2]),this._switchMatrix(Vp,Vy);break;case 16:case 24:VT._addPointArrToRst(Va,V_._getBoundPointS(VQ[0],VQ[1],VQ[2],VQ[3]),Vp);break;case 17:Vp.copyTo(Vy),Vy.concat(VQ[4]),VT._addPointArrToRst(Va,V_._getBoundPointS(VQ[0],VQ[1],VQ[2],VQ[3]),Vy);break;case Vx._drawTexture:VV=VQ[0],Vn?VQ[3]&&VQ[4]?VT._addPointArrToRst(Va,V_._getBoundPointS(VQ[1],VQ[2],VQ[3],VQ[4]),Vp):(VV=VQ[0],VT._addPointArrToRst(Va,V_._getBoundPointS(VQ[1],VQ[2],VV.width,VV.height),Vp)):(VR=(VQ[3]||VV.sourceWidth)/VV.width,VX=(VQ[4]||VV.sourceHeight)/VV.height,Vz=VR*VV.sourceWidth,Vi=VX*VV.sourceHeight,Vq=0<VV.offsetX?VV.offsetX:0,VE=0<VV.offsetY?VV.offsetY:0,Vq*=VR,VE*=VX,VT._addPointArrToRst(Va,V_._getBoundPointS(VQ[1]-Vq,VQ[2]-VE,Vz,Vi),Vp));break;case Vx._fillTexture:VQ[3]&&VQ[4]?VT._addPointArrToRst(Va,V_._getBoundPointS(VQ[1],VQ[2],VQ[3],VQ[4]),Vp):(VV=VQ[0],VT._addPointArrToRst(Va,V_._getBoundPointS(VQ[1],VQ[2],VV.width,VV.height),Vp));break;case Vx._drawTextureWithTransform:var VP;VP=VQ[5]?(Vp.copyTo(Vy),Vy.concat(VQ[5]),Vy):Vp,Vn?VQ[3]&&VQ[4]?VT._addPointArrToRst(Va,V_._getBoundPointS(VQ[1],VQ[2],VQ[3],VQ[4]),VP):(VV=VQ[0],VT._addPointArrToRst(Va,V_._getBoundPointS(VQ[1],VQ[2],VV.width,VV.height),VP)):(VV=VQ[0],VR=(VQ[3]||VV.sourceWidth)/VV.width,VX=(VQ[4]||VV.sourceHeight)/VV.height,Vz=VR*VV.sourceWidth,Vi=VX*VV.sourceHeight,Vq=0<VV.offsetX?VV.offsetX:0,VE=0<VV.offsetY?VV.offsetY:0,Vq*=VR,VE*=VX,VT._addPointArrToRst(Va,V_._getBoundPointS(VQ[1]-Vq,VQ[2]-VE,Vz,Vi),VP));break;case Vx._drawRect:case 13:VT._addPointArrToRst(Va,V_._getBoundPointS(VQ[0],VQ[1],VQ[2],VQ[3]),Vp);break;case Vx._drawCircle:case Vx._fillCircle:case 14:VT._addPointArrToRst(Va,V_._getBoundPointS(VQ[0]-VQ[2],VQ[1]-VQ[2],VQ[2]+VQ[2],VQ[2]+VQ[2]),Vp);break;case Vx._drawLine:case 20:VT._tempPoints.length=0;var VA;VA=.5*VQ[5],VQ[0]==VQ[2]?VT._tempPoints.push(VQ[0]+VA,VQ[1],VQ[2]+VA,VQ[3],VQ[0]-VA,VQ[1],VQ[2]-VA,VQ[3]):VQ[1]==VQ[3]?VT._tempPoints.push(VQ[0],VQ[1]+VA,VQ[2],VQ[3]+VA,VQ[0],VQ[1]-VA,VQ[2],VQ[3]-VA):VT._tempPoints.push(VQ[0],VQ[1],VQ[2],VQ[3]),VT._addPointArrToRst(Va,VT._tempPoints,Vp);break;case Vx._drawCurves:case 22:VT._addPointArrToRst(Va,VK.I.getBezierPoints(VQ[2]),Vp,VQ[0],VQ[1]);break;case Vx._drawPoly:case Vx._drawLines:case 18:VT._addPointArrToRst(Va,VQ[2],Vp,VQ[0],VQ[1]);break;case Vx._drawPath:case 19:VT._addPointArrToRst(Va,this._getPathPoints(VQ[2]),Vp,VQ[0],VQ[1]);break;case Vx._drawPie:case 15:VT._addPointArrToRst(Va,this._getPiePoints(VQ[0],VQ[1],VQ[2],VQ[3],VQ[4]),Vp)}return 200<Va.length?Va=Vt.copyArray(Va,V_._getWrapRec(Va)._getBoundPoints()):8<Va.length&&(Va=VY.scanPList(Va)),Va},Vn._switchMatrix=function(Vn,Va){Va.concat(Vn),Va.copyTo(Vn)},Vn._getPiePoints=function(Vn,Va,VU,Vx,VD){var Vp=VT._tempPoints;VT._tempPoints.length=0,Vp.push(Vn,Va);var VQ=(VD-Vx)%(2*Math.PI)/10,VV=NaN,Vy=Vx;for(VV=0;VV<=10;VV++)Vp.push(Vn+VU*Math.cos(Vy),Va+VU*Math.sin(Vy)),Vy+=VQ;return Vp},Vn._getPathPoints=function(Vn){var Va,VU,Vx=0,VD=VT._tempPoints;for(VD.length=0,Va=Vn.length,Vx=0;Vx<Va;Vx++)1<(VU=Vn[Vx]).length&&(VD.push(VU[1],VU[2]),3<VU.length&&VD.push(VU[3],VU[4]));return VD},VT._addPointArrToRst=function(Vn,Va,VU,Vx,VD){void 0===Vx&&(Vx=0),void 0===VD&&(VD=0);var Vp,VQ=0;for(Vp=Va.length,VQ=0;VQ<Vp;VQ+=2)VT._addPointToRst(Vn,Va[VQ]+Vx,Va[VQ+1]+VD,VU)},VT._addPointToRst=function(Vn,Va,VU,Vx){var VD=VN.TEMP;VD.setTo(Va||0,VU||0),Vx.transformPoint(VD),Vn.push(VD.x,VD.y)},VT._tempPoints=[],VT._tempMatrixArrays=[],VT._tempCmds=[],Vy(VT,["_tempMatrix",function(){return this._tempMatrix=new Vc},"_initMatrix",function(){return this._initMatrix=new Vc}]),VT}(),Vp=function(){function Vn(){}Vm(Vn,"laya.events.Event");var Va=Vn.prototype;return Va.setTo=function(Vn,Va,VU){return this.type=Vn,this.currentTarget=Va,this.target=VU,this},Va.stopPropagation=function(){this._stoped=!0},VX(0,Va,"stageY",function(){return Vk.stage.mouseY}),VX(0,Va,"charCode",function(){return this.nativeEvent.charCode}),VX(0,Va,"touches",function(){var Vn=this.nativeEvent.touches;if(Vn)for(var Va=Vk.stage,VU=0,Vx=Vn.length;VU<Vx;VU++){var VD=Vn[VU],Vp=VN.TEMP;Vp.setTo(VD.clientX,VD.clientY),Va._canvasTransform.invertTransformPoint(Vp),Va.transform.invertTransformPoint(Vp),VD.stageX=Vp.x,VD.stageY=Vp.y}return Vn}),VX(0,Va,"keyLocation",function(){return this.nativeEvent.keyLocation}),VX(0,Va,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),VX(0,Va,"altKey",function(){return this.nativeEvent.altKey}),VX(0,Va,"shiftKey",function(){return this.nativeEvent.shiftKey}),VX(0,Va,"stageX",function(){return Vk.stage.mouseX}),Vn.EMPTY=new Vn,Vn.MOUSE_DOWN="mousedown",Vn.MOUSE_UP="mouseup",Vn.CLICK="click",Vn.RIGHT_MOUSE_DOWN="rightmousedown",Vn.RIGHT_MOUSE_UP="rightmouseup",Vn.RIGHT_CLICK="rightclick",Vn.MOUSE_MOVE="mousemove",Vn.MOUSE_OVER="mouseover",Vn.MOUSE_OUT="mouseout",Vn.MOUSE_WHEEL="mousewheel",Vn.ROLL_OVER="mouseover",Vn.ROLL_OUT="mouseout",Vn.DOUBLE_CLICK="doubleclick",Vn.CHANGE="change",Vn.CHANGED="changed",Vn.RESIZE="resize",Vn.ADDED="added",Vn.REMOVED="removed",Vn.DISPLAY="display",Vn.UNDISPLAY="undisplay",Vn.ERROR="error",Vn.COMPLETE="complete",Vn.LOADED="loaded",Vn.INITED="inited",Vn.PROGRESS="progress",Vn.INPUT="input",Vn.RENDER="render",Vn.OPEN="open",Vn.MESSAGE="message",Vn.CLOSE="close",Vn.KEY_DOWN="keydown",Vn.KEY_PRESS="keypress",Vn.KEY_UP="keyup",Vn.FRAME="enterframe",Vn.DRAG_START="dragstart",Vn.DRAG_MOVE="dragmove",Vn.DRAG_END="dragend",Vn.ENTER="enter",Vn.SELECT="select",Vn.BLUR="blur",Vn.FOCUS="focus",Vn.VISIBILITY_CHANGE="visibilitychange",Vn.FOCUS_CHANGE="focuschange",Vn.PLAYED="played",Vn.PAUSED="paused",Vn.STOPPED="stopped",Vn.START="start",Vn.END="end",Vn.ENABLE_CHANGED="enablechanged",Vn.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",Vn.COMPONENT_ADDED="componentadded",Vn.COMPONENT_REMOVED="componentremoved",Vn.LAYER_CHANGED="layerchanged",Vn.HIERARCHY_LOADED="hierarchyloaded",Vn.RECOVERED="recovered",Vn.RELEASED="released",Vn.LINK="link",Vn.LABEL="label",Vn.FULL_SCREEN_CHANGE="fullscreenchange",Vn.DEVICE_LOST="devicelost",Vn.MESH_CHANGED="meshchanged",Vn.MATERIAL_CHANGED="materialchanged",Vn.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",Vn.ANIMATION_CHANGED="animationchanged",Vn.TRIGGER_ENTER="triggerenter",Vn.TRIGGER_STAY="triggerstay",Vn.TRIGGER_EXIT="triggerexit",Vn.TRAIL_FILTER_CHANGE="trailfilterchange",Vn.DOMINO_FILTER_CHANGE="dominofilterchange",Vn}(),Vz=(function(){function Vn(){}Vm(Vn,"laya.events.Keyboard"),Vn.NUMBER_0=48,Vn.NUMBER_1=49,Vn.NUMBER_2=50,Vn.NUMBER_3=51,Vn.NUMBER_4=52,Vn.NUMBER_5=53,Vn.NUMBER_6=54,Vn.NUMBER_7=55,Vn.NUMBER_8=56,Vn.NUMBER_9=57,Vn.A=65,Vn.B=66,Vn.C=67,Vn.D=68,Vn.E=69,Vn.F=70,Vn.G=71,Vn.H=72,Vn.I=73,Vn.J=74,Vn.K=75,Vn.L=76,Vn.M=77,Vn.N=78,Vn.O=79,Vn.P=80,Vn.Q=81,Vn.R=82,Vn.S=83,Vn.T=84,Vn.U=85,Vn.V=86,Vn.W=87,Vn.X=88,Vn.Y=89,Vn.Z=90,Vn.F1=112,Vn.F2=113,Vn.F3=114,Vn.F4=115,Vn.F5=116,Vn.F6=117,Vn.F7=118,Vn.F8=119,Vn.F9=120,Vn.F10=121,Vn.F11=122,Vn.F12=123,Vn.F13=124,Vn.F14=125,Vn.F15=126,Vn.NUMPAD=21,Vn.NUMPAD_0=96,Vn.NUMPAD_1=97,Vn.NUMPAD_2=98,Vn.NUMPAD_3=99,Vn.NUMPAD_4=100,Vn.NUMPAD_5=101,Vn.NUMPAD_6=102,Vn.NUMPAD_7=103,Vn.NUMPAD_8=104,Vn.NUMPAD_9=105,Vn.NUMPAD_ADD=107,Vn.NUMPAD_DECIMAL=110,Vn.NUMPAD_DIVIDE=111,Vn.NUMPAD_ENTER=108,Vn.NUMPAD_MULTIPLY=106,Vn.NUMPAD_SUBTRACT=109,Vn.SEMICOLON=186,Vn.EQUAL=187,Vn.COMMA=188,Vn.MINUS=189,Vn.PERIOD=190,Vn.SLASH=191,Vn.BACKQUOTE=192,Vn.LEFTBRACKET=219,Vn.BACKSLASH=220,Vn.RIGHTBRACKET=221,Vn.QUOTE=222,Vn.ALTERNATE=18,Vn.BACKSPACE=8,Vn.CAPS_LOCK=20,Vn.COMMAND=15,Vn.CONTROL=17,Vn.DELETE=46,Vn.ENTER=13,Vn.ESCAPE=27,Vn.PAGE_UP=33,Vn.PAGE_DOWN=34,Vn.END=35,Vn.HOME=36,Vn.LEFT=37,Vn.UP=38,Vn.RIGHT=39,Vn.DOWN=40,Vn.SHIFT=16,Vn.SPACE=32,Vn.TAB=9,Vn.INSERT=45}(),function(){function VD(){}return Vm(VD,"laya.events.KeyBoardManager"),VD.__init__=function(){VD._addEvent("keydown"),VD._addEvent("keypress"),VD._addEvent("keyup")},VD._addEvent=function(Va){Vf.document.addEventListener(Va,function(Vn){laya.events.KeyBoardManager._dispatch(Vn,Va)},!0)},VD._dispatch=function(Vn,Va){if(VD.enabled){VD._event._stoped=!1,VD._event.nativeEvent=Vn,VD._event.keyCode=Vn.keyCode||Vn.which||Vn.charCode,"keydown"===Va?VD._pressKeys[VD._event.keyCode]=!0:"keyup"===Va&&(VD._pressKeys[VD._event.keyCode]=null);for(var VU=Vk.stage.focus&&null!=Vk.stage.focus.event&&Vk.stage.focus.displayedInStage?Vk.stage.focus:Vk.stage,Vx=VU;Vx;)Vx.event(Va,VD._event.setTo(Va,Vx,VU)),Vx=Vx.parent}},VD.hasKeyDown=function(Vn){return VD._pressKeys[Vn]},VD._pressKeys={},VD.enabled=!0,Vy(VD,["_event",function(){return this._event=new Vp}]),VD}()),VE=(function(){function Vn(){}Vm(Vn,"laya.events.KeyLocation"),Vn.STANDARD=0,Vn.LEFT=1,Vn.RIGHT=2,Vn.NUM_PAD=3}(),function(){function VX(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=Vf.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new Vp,this._matrix=new Vc,this._point=new VN,this._rect=new V_,this._prePoint=new VN,this._curTouchID=NaN}Vm(VX,"laya.events.MouseManager");var Vn=VX.prototype;return Vn.__init__=function(Vn,Va){var VU=this;this._stage=Vn;var Vx=this,VD=this._eventList;Va.oncontextmenu=function(Vn){if(VX.enabled)return!1},Va.addEventListener("mousedown",function(Vn){VX.enabled&&(Vf.onIE||Vn.preventDefault(),VD.push(Vn),Vx.mouseDownTime=Vf.now())}),Va.addEventListener("mouseup",function(Vn){VX.enabled&&(Vn.preventDefault(),VD.push(Vn),Vx.mouseDownTime=-Vf.now())},!0),Va.addEventListener("mousemove",function(Vn){if(VX.enabled){Vn.preventDefault();var Va=Vf.now();if(Va-Vx._lastMoveTimer<10)return;Vx._lastMoveTimer=Va,VD.push(Vn)}},!0),Va.addEventListener("mouseout",function(Vn){VX.enabled&&VD.push(Vn)}),Va.addEventListener("mouseover",function(Vn){VX.enabled&&VD.push(Vn)}),Va.addEventListener("touchstart",function(Vn){VX.enabled&&(VD.push(Vn),VX._isFirstTouch||VYn.isInputting||Vn.preventDefault(),Vx.mouseDownTime=Vf.now())}),Va.addEventListener("touchend",function(Vn){VX.enabled?(VX._isFirstTouch||VYn.isInputting||Vn.preventDefault(),VX._isFirstTouch=!1,VD.push(Vn),Vx.mouseDownTime=-Vf.now()):VU._curTouchID=NaN},!0),Va.addEventListener("touchmove",function(Vn){VX.enabled&&(Vn.preventDefault(),VD.push(Vn))},!0),Va.addEventListener("touchcancel",function(Vn){VX.enabled?(Vn.preventDefault(),VD.push(Vn)):VU._curTouchID=NaN},!0),Va.addEventListener("mousewheel",function(Vn){VX.enabled&&VD.push(Vn)}),Va.addEventListener("DOMMouseScroll",function(Vn){VX.enabled&&VD.push(Vn)})},Vn.initEvent=function(Vn,Va){var VU;this._event._stoped=!1,this._event.nativeEvent=Va||Vn,this._target=null,this._point.setTo(Vn.pageX||Vn.clientX,Vn.pageY||Vn.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=Vn.identifier||0,this._tTouchID=this._event.touchId,(VU=Vb.I._event)._stoped=!1,VU.nativeEvent=this._event.nativeEvent,VU.touchId=this._event.touchId},Vn.checkMouseWheel=function(Vn){this._event.delta=Vn.wheelDelta?.025*Vn.wheelDelta:-Vn.detail;for(var Va=Vb.I.getLastOvers(),VU=0,Vx=Va.length;VU<Vx;VU++){var VD=Va[VU];VD.event("mousewheel",this._event.setTo("mousewheel",VD,this._target))}},Vn.onMouseMove=function(Vn){Vb.I.onMouseMove(Vn,this._tTouchID)},Vn.onMouseDown=function(Vn){if(VYn.isInputting&&Vk.stage.focus&&Vk.stage.focus.focus&&!Vk.stage.focus.contains(this._target)){var Va=Vk.stage.focus._tf||Vk.stage.focus,VU=Vn._tf||Vn;VU instanceof laya.display.Input&&VU.multiline==Va.multiline?Va._focusOut():Va.focus=!1}Vb.I.onMouseDown(Vn,this._tTouchID,this._isLeftMouse)},Vn.onMouseUp=function(Vn){Vb.I.onMouseUp(Vn,this._tTouchID,this._isLeftMouse)},Vn.check=function(Vn,Va,VU,Vx){this._point.setTo(Va,VU),Vn.fromParentPoint(this._point),Va=this._point.x,VU=this._point.y;var VD=Vn.scrollRect;if(VD&&(this._rect.setTo(VD.x,VD.y,VD.width,VD.height),!this._rect.contains(Va,VU)))return!1;if(!this.disableMouseEvent){if(Vn.hitTestPrior&&!Vn.mouseThrough&&!this.hitTest(Vn,Va,VU))return!1;for(var Vp=Vn._childs.length-1;-1<Vp;Vp--){var VQ=Vn._childs[Vp];if(!VQ.destroyed&&VQ.mouseEnabled&&VQ.visible&&this.check(VQ,Va,VU,Vx))return!0}}var VV=!(!Vn.hitTestPrior||Vn.mouseThrough||this.disableMouseEvent)||this.hitTest(Vn,Va,VU);return VV?(this._target=Vn,Vx.call(this,Vn)):Vx===this.onMouseUp&&Vn===this._stage&&(this._target=this._stage,Vx.call(this,this._target)),VV},Vn.hitTest=function(Vn,Va,VU){var Vx=!1;if(Vn.scrollRect&&(Va-=Vn.scrollRect.x,VU-=Vn.scrollRect.y),Vn.hitArea instanceof laya.utils.HitArea)return Vn.hitArea.isHit(Va,VU);if(0<Vn.width&&0<Vn.height||Vn.mouseThrough||Vn.hitArea)if(Vn.mouseThrough)Vx=Vn.getGraphicBounds().contains(Va,VU);else{var VD=this._rect;Vn.hitArea?VD=Vn.hitArea:VD.setTo(0,0,Vn.width,Vn.height),Vx=VD.contains(Va,VU)}return Vx},Vn.runEvent=function(){var Vn=this._eventList.length;if(Vn){var Va=this;Va.mouseEventTime=Vf.now();var VU,Vx=0,VD=0,Vp=0;try{for(;Vx<Vn;){var VQ=this._eventList[Vx];switch("mousemove"!==VQ.type&&(this._prePoint.x=this._prePoint.y=-1e6),VQ.type){case"mousedown":this._touchIDs[0]=this._id++,VX._isTouchRespond?VX._isTouchRespond=!1:(Va._isLeftMouse=0===VQ.button,Va.initEvent(VQ),Va.check(Va._stage,Va.mouseX,Va.mouseY,Va.onMouseDown));break;case"mouseup":Va._isLeftMouse=0===VQ.button,Va.initEvent(VQ),Va.check(Va._stage,Va.mouseX,Va.mouseY,Va.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-VQ.clientX)+Math.abs(this._prePoint.y-VQ.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=VQ.clientX,this._prePoint.y=VQ.clientY,Va.initEvent(VQ),Va.check(Va._stage,Va.mouseX,Va.mouseY,Va.onMouseMove));break;case"touchstart":VX._isTouchRespond=!0,Va._isLeftMouse=!0;var VV=VQ.changedTouches;for(VD=0,Vp=VV.length;VD<Vp;VD++)VU=VV[VD],(VX.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=VU.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[VU.identifier]=this._id++,Va.initEvent(VU,VQ),Va.check(Va._stage,Va.mouseX,Va.mouseY,Va.onMouseDown));break;case"touchend":case"touchcancel":VX._isTouchRespond=!0,Va._isLeftMouse=!0;var Vy=VQ.changedTouches;for(VD=0,Vp=Vy.length;VD<Vp;VD++)if(VU=Vy[VD],VX.multiTouchEnabled||VU.identifier==this._curTouchID){this._curTouchID=NaN,Va.initEvent(VU,VQ);Va.check(Va._stage,Va.mouseX,Va.mouseY,Va.onMouseUp)||Va.onMouseUp(null)}break;case"touchmove":var VR=VQ.changedTouches;for(VD=0,Vp=VR.length;VD<Vp;VD++)VU=VR[VD],(VX.multiTouchEnabled||VU.identifier==this._curTouchID)&&(Va.initEvent(VU,VQ),Va.check(Va._stage,Va.mouseX,Va.mouseY,Va.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":Va.checkMouseWheel(VQ);break;case"mouseout":Vb.I.stageMouseOut();break;case"mouseover":Va._stage.event("mouseover",Va._event.setTo("mouseover",Va._stage,Va._stage))}Vx++}}catch(Vn){throw this._eventList.length=0,Vn}this._eventList.length=0}},VX.enabled=!0,VX.multiTouchEnabled=!0,VX._isTouchRespond=!1,VX._isFirstTouch=!0,Vy(VX,["instance",function(){return this.instance=new VX}]),VX}()),Vb=function(){function VE(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new Vp}Vm(VE,"laya.events.TouchManager");var Vn=VE.prototype;return Vn._clearTempArrs=function(){VE._oldArr.length=0,VE._newArr.length=0,VE._tEleArr.length=0},Vn.getTouchFromArr=function(Vn,Va){var VU,Vx,VD=0;for(VU=Va.length,VD=0;VD<VU;VD++)if((Vx=Va[VD]).id==Vn)return Vx;return null},Vn.removeTouchFromArr=function(Vn,Va){var VU=0;for(VU=Va.length-1;0<=VU;VU--)Va[VU].id==Vn&&Va.splice(VU,1)},Vn.createTouchO=function(Vn,Va){var VU;return(VU=VS.getItem("TouchData")||{}).id=Va,VU.tar=Vn,VU},Vn.onMouseDown=function(Vn,Va,VU){var Vx,VD,Vp,VQ;(void 0===VU&&(VU=!1),this.enable)&&(Vx=this.getTouchFromArr(Va,this.preOvers),Vp=this.getEles(Vn,null,VE._tEleArr),Vx?Vx.tar=Vn:(VD=this.createTouchO(Vn,Va),this.preOvers.push(VD)),Vf.onMobile&&this.sendEvents(Vp,"mouseover",Va),VQ=VU?this.preDowns:this.preRightDowns,(Vx=this.getTouchFromArr(Va,VQ))?Vx.tar=Vn:(VD=this.createTouchO(Vn,Va),VQ.push(VD)),this.sendEvents(Vp,VU?"mousedown":"rightmousedown",Va),this._clearTempArrs())},Vn.sendEvents=function(Vn,Va,VU){void 0===VU&&(VU=0);var Vx,VD,Vp,VQ=0;for(Vx=Vn.length,this._event._stoped=!1,VD=Vn[0],VQ=0;VQ<Vx;VQ++){if((Vp=Vn[VQ]).destroyed)return;if(Vp.event(Va,this._event.setTo(Va,Vp,VD)),this._event._stoped)break}},Vn.getEles=function(Vn,Va,VU){for(VU?VU.length=0:VU=[];Vn&&Vn!=Va;)VU.push(Vn),Vn=Vn.parent;return VU},Vn.checkMouseOutAndOverOfMove=function(Vn,Va,VU){if(void 0===VU&&(VU=0),Va!=Vn){var Vx,VD,Vp=0,VQ=0;if(Va.contains(Vn))VD=this.getEles(Vn,Va,VE._tEleArr),this.sendEvents(VD,"mouseover",VU);else if(Vn.contains(Va))VD=this.getEles(Va,Vn,VE._tEleArr),this.sendEvents(VD,"mouseout",VU);else{var VV,Vy;(VD=VE._tEleArr).length=0,VV=this.getEles(Va,null,VE._oldArr),Vy=this.getEles(Vn,null,VE._newArr),VQ=VV.length;var VR=0;for(Vp=0;Vp<VQ;Vp++){if(Vx=VV[Vp],0<=(VR=Vy.indexOf(Vx))){Vy.splice(VR,Vy.length-VR);break}VD.push(Vx)}0<VD.length&&this.sendEvents(VD,"mouseout",VU),0<Vy.length&&this.sendEvents(Vy,"mouseover",VU)}}},Vn.onMouseMove=function(Vn,Va){var VU,Vx;this.enable&&((VU=this.getTouchFromArr(Va,this.preOvers))?(this.checkMouseOutAndOverOfMove(Vn,VU.tar),VU.tar=Vn,Vx=this.getEles(Vn,null,VE._tEleArr)):(Vx=this.getEles(Vn,null,VE._tEleArr),this.sendEvents(Vx,"mouseover",Va),this.preOvers.push(this.createTouchO(Vn,Va))),this.sendEvents(Vx,"mousemove",Va),this._clearTempArrs())},Vn.getLastOvers=function(){return(VE._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,VE._tEleArr):(VE._tEleArr.push(Vk.stage),VE._tEleArr)},Vn.stageMouseOut=function(){var Vn;Vn=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(Vn,"mouseout",0)},Vn.onMouseUp=function(Vn,Va,VU){if(void 0===VU&&(VU=!1),this.enable){var Vx,VD,Vp,VQ,VV,Vy,VR=0,VX=0,Vz=Vf.onMobile;if(VD=this.getEles(Vn,null,VE._tEleArr),this.sendEvents(VD,VU?"mouseup":"rightmouseup",Va),Vy=VU?this.preDowns:this.preRightDowns,Vx=this.getTouchFromArr(Va,Vy)){var Vi,Vq=Vf.now();if(Vi=Vq-this._lastClickTime<300,this._lastClickTime=Vq,Vn==Vx.tar)VV=VD;else for(Vp=this.getEles(Vx.tar,null,VE._oldArr),(VV=VE._newArr).length=0,VX=Vp.length,VR=0;VR<VX;VR++)VQ=Vp[VR],0<=VD.indexOf(VQ)&&VV.push(VQ);0<VV.length&&this.sendEvents(VV,VU?"click":"rightclick",Va),VU&&Vi&&this.sendEvents(VV,"doubleclick",Va),this.removeTouchFromArr(Va,Vy),Vx.tar=null,VS.recover("TouchData",Vx)}else;(Vx=this.getTouchFromArr(Va,this.preOvers))&&Vz&&((VV=this.getEles(Vx.tar,null,VV))&&0<VV.length&&this.sendEvents(VV,"mouseout",Va),this.removeTouchFromArr(Va,this.preOvers),Vx.tar=null,VS.recover("TouchData",Vx)),this._clearTempArrs()}},VE._oldArr=[],VE._newArr=[],VE._tEleArr=[],Vy(VE,["I",function(){return this.I=new VE}]),VE}(),VP=function(){function Vn(){this._action=null}Vm(Vn,"laya.filters.Filter");var Va=Vn.prototype;return Vk.imps(Va,{"laya.filters.IFilter":!0}),Va.callNative=function(Vn){},VX(0,Va,"type",function(){return-1}),VX(0,Va,"action",function(){return this._action}),Vn.BLUR=16,Vn.COLOR=32,Vn.GLOW=8,Vn._filterStart=null,Vn._filterEnd=null,Vn._EndTarget=null,Vn._recycleScope=null,Vn._filter=null,Vn._useSrc=null,Vn._endSrc=null,Vn._useOut=null,Vn._endOut=null,Vn}(),VT=function(){function Vn(){this.data=null}Vm(Vn,"laya.filters.ColorFilterAction");var Va=Vn.prototype;return Vk.imps(Va,{"laya.filters.IFilterAction":!0}),Va.apply=function(Vn){var Va=Vn.ctx.ctx,VU=Vn.ctx.ctx.canvas;if(0==VU.width||0==VU.height)return VU;for(var Vx,VD=Va.getImageData(0,0,VU.width,VU.height),Vp=VD.data,VQ=0,VV=Vp.length;VQ<VV;VQ+=4)Vx=this.getColor(Vp[VQ],Vp[VQ+1],Vp[VQ+2],Vp[VQ+3]),0!=Vp[VQ+3]&&(Vp[VQ]=Vx[0],Vp[VQ+1]=Vx[1],Vp[VQ+2]=Vx[2],Vp[VQ+3]=Vx[3]);return Va.putImageData(VD,0,0),Vn},Va.getColor=function(Vn,Va,VU,Vx){var VD=[];if(this.data._mat&&this.data._alpha){var Vp=this.data._mat,VQ=this.data._alpha;VD[0]=Vp[0]*Vn+Vp[1]*Va+Vp[2]*VU+Vp[3]*Vx+VQ[0],VD[1]=Vp[4]*Vn+Vp[5]*Va+Vp[6]*VU+Vp[7]*Vx+VQ[1],VD[2]=Vp[8]*Vn+Vp[9]*Va+Vp[10]*VU+Vp[11]*Vx+VQ[2],VD[3]=Vp[12]*Vn+Vp[13]*Va+Vp[14]*VU+Vp[15]*Vx+VQ[3]}return VD},Vn}(),VK=(function(){function Vn(){}Vm(Vn,"laya.maths.Arith"),Vn.formatR=function(Vn){return Vn>Math.PI&&(Vn-=2*Math.PI),Vn<-Math.PI&&(Vn+=2*Math.PI),Vn},Vn.isPOT=function(Vn,Va){return 0<Vn&&0==(Vn&Vn-1)&&0<Va&&0==(Va&Va-1)},Vn.setMatToArray=function(Vn,Va){Vn.a,Vn.b,Vn.c,Vn.d,Vn.tx,Vn.ty,Va[0]=Vn.a,Va[1]=Vn.b,Va[4]=Vn.c,Va[5]=Vn.d,Va[12]=Vn.tx,Va[13]=Vn.ty}}(),function(){function Vn(){this._controlPoints=[new VN,new VN,new VN],this._calFun=this.getPoint2}Vm(Vn,"laya.maths.Bezier");var Va=Vn.prototype;return Va._switchPoint=function(Vn,Va){var VU=this._controlPoints.shift();VU.setTo(Vn,Va),this._controlPoints.push(VU)},Va.getPoint2=function(Vn,Va){var VU=this._controlPoints[0],Vx=this._controlPoints[1],VD=this._controlPoints[2],Vp=Math.pow(1-Vn,2)*VU.x+2*Vn*(1-Vn)*Vx.x+Math.pow(Vn,2)*VD.x,VQ=Math.pow(1-Vn,2)*VU.y+2*Vn*(1-Vn)*Vx.y+Math.pow(Vn,2)*VD.y;Va.push(Vp,VQ)},Va.getPoint3=function(Vn,Va){var VU=this._controlPoints[0],Vx=this._controlPoints[1],VD=this._controlPoints[2],Vp=this._controlPoints[3],VQ=Math.pow(1-Vn,3)*VU.x+3*Vx.x*Vn*(1-Vn)*(1-Vn)+3*VD.x*Vn*Vn*(1-Vn)+Vp.x*Math.pow(Vn,3),VV=Math.pow(1-Vn,3)*VU.y+3*Vx.y*Vn*(1-Vn)*(1-Vn)+3*VD.y*Vn*Vn*(1-Vn)+Vp.y*Math.pow(Vn,3);Va.push(VQ,VV)},Va.insertPoints=function(Vn,Va){var VU,Vx=NaN;for(VU=1/(Vn=0<Vn?Vn:5),Vx=0;Vx<=1;Vx+=VU)this._calFun(Vx,Va)},Va.getBezierPoints=function(Vn,Va,VU){void 0===Va&&(Va=5),void 0===VU&&(VU=2);var Vx,VD,Vp=0;if((Vx=Vn.length)<2*(VU+1))return[];switch(VD=[],VU){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=VU;)this._controlPoints.push(new VN);for(Vp=0;Vp<2*VU;Vp+=2)this._switchPoint(Vn[Vp],Vn[Vp+1]);for(Vp=2*VU;Vp<Vx;Vp+=2)this._switchPoint(Vn[Vp],Vn[Vp+1]),Vp/2%VU==0&&this.insertPoints(Va,VD);return VD},Vy(Vn,["I",function(){return this.I=new Vn}]),Vn}()),VY=function(){function VR(){}return Vm(VR,"laya.maths.GrahamScan"),VR.multiply=function(Vn,Va,VU){return(Vn.x-VU.x)*(Va.y-VU.y)-(Va.x-VU.x)*(Vn.y-VU.y)},VR.dis=function(Vn,Va){return(Vn.x-Va.x)*(Vn.x-Va.x)+(Vn.y-Va.y)*(Vn.y-Va.y)},VR._getPoints=function(Vn,Va,VU){for(void 0===Va&&(Va=!1),VR._mPointList||(VR._mPointList=[]);VR._mPointList.length<Vn;)VR._mPointList.push(new VN);return VU||(VU=[]),VU.length=0,Va?VR.getFrom(VU,VR._mPointList,Vn):VR.getFromR(VU,VR._mPointList,Vn),VU},VR.getFrom=function(Vn,Va,VU){var Vx=0;for(Vx=0;Vx<VU;Vx++)Vn.push(Va[Vx]);return Vn},VR.getFromR=function(Vn,Va,VU){var Vx=0;for(Vx=0;Vx<VU;Vx++)Vn.push(Va.pop());return Vn},VR.pListToPointList=function(Vn,Va){void 0===Va&&(Va=!1);var VU=0,Vx=Vn.length/2,VD=VR._getPoints(Vx,Va,VR._tempPointList);for(VU=0;VU<Vx;VU++)VD[VU].setTo(Vn[VU+VU],Vn[VU+VU+1]);return VD},VR.pointListToPlist=function(Vn){var Va,VU=0,Vx=Vn.length,VD=VR._temPList;for(VU=VD.length=0;VU<Vx;VU++)Va=Vn[VU],VD.push(Va.x,Va.y);return VD},VR.scanPList=function(Vn){return Vt.copyArray(Vn,VR.pointListToPlist(VR.scan(VR.pListToPointList(Vn,!0))))},VR.scan=function(Vn){var Va,VU,Vx,VD=0,Vp=0,VQ=0,VV=Vn.length,Vy={};for((VU=VR._temArr).length=0,VD=(VV=Vn.length)-1;0<=VD;VD--)Vx=(Va=Vn[VD]).x+"_"+Va.y,Vy.hasOwnProperty(Vx)||(Vy[Vx]=!0,VU.push(Va));for(VV=VU.length,Vt.copyArray(Vn,VU),VD=1;VD<VV;VD++)(Vn[VD].y<Vn[VQ].y||Vn[VD].y==Vn[VQ].y&&Vn[VD].x<Vn[VQ].x)&&(VQ=VD);for(Va=Vn[0],Vn[0]=Vn[VQ],Vn[VQ]=Va,VD=1;VD<VV-1;VD++){for(Vp=(VQ=VD)+1;Vp<VV;Vp++)(0<VR.multiply(Vn[Vp],Vn[VQ],Vn[0])||0==VR.multiply(Vn[Vp],Vn[VQ],Vn[0])&&VR.dis(Vn[0],Vn[Vp])<VR.dis(Vn[0],Vn[VQ]))&&(VQ=Vp);Va=Vn[VD],Vn[VD]=Vn[VQ],Vn[VQ]=Va}if((VU=VR._temArr).length=0,Vn.length<3)return Vt.copyArray(VU,Vn);for(VU.push(Vn[0],Vn[1],Vn[2]),VD=3;VD<VV;VD++){for(;2<=VU.length&&0<=VR.multiply(Vn[VD],VU[VU.length-1],VU[VU.length-2]);)VU.pop();Vn[VD]&&VU.push(Vn[VD])}return VU},VR._mPointList=null,VR._tempPointList=[],VR._temPList=[],VR._temArr=[],VR}(),VW=function(){function VD(){}return Vm(VD,"laya.maths.MathUtil"),VD.subtractVector3=function(Vn,Va,VU){VU[0]=Vn[0]-Va[0],VU[1]=Vn[1]-Va[1],VU[2]=Vn[2]-Va[2]},VD.lerp=function(Vn,Va,VU){return Vn*(1-VU)+Va*VU},VD.scaleVector3=function(Vn,Va,VU){VU[0]=Vn[0]*Va,VU[1]=Vn[1]*Va,VU[2]=Vn[2]*Va},VD.lerpVector3=function(Vn,Va,VU,Vx){var VD=Vn[0],Vp=Vn[1],VQ=Vn[2];Vx[0]=VD+VU*(Va[0]-VD),Vx[1]=Vp+VU*(Va[1]-Vp),Vx[2]=VQ+VU*(Va[2]-VQ)},VD.lerpVector4=function(Vn,Va,VU,Vx){var VD=Vn[0],Vp=Vn[1],VQ=Vn[2],VV=Vn[3];Vx[0]=VD+VU*(Va[0]-VD),Vx[1]=Vp+VU*(Va[1]-Vp),Vx[2]=VQ+VU*(Va[2]-VQ),Vx[3]=VV+VU*(Va[3]-VV)},VD.slerpQuaternionArray=function(Vn,Va,VU,Vx,VD,Vp,VQ){var VV,Vy,VR,VX,Vz,Vi=Vn[Va+0],Vq=Vn[Va+1],VE=Vn[Va+2],Vm=Vn[Va+3],Vb=VU[Vx+0],VP=VU[Vx+1],VA=VU[Vx+2],VT=VU[Vx+3];return(Vy=Vi*Vb+Vq*VP+VE*VA+Vm*VT)<0&&(Vy=-Vy,Vb=-Vb,VP=-VP,VA=-VA,VT=-VT),Vz=1e-6<1-Vy?(VV=Math.acos(Vy),VR=Math.sin(VV),VX=Math.sin((1-VD)*VV)/VR,Math.sin(VD*VV)/VR):(VX=1-VD,VD),Vp[VQ+0]=VX*Vi+Vz*Vb,Vp[VQ+1]=VX*Vq+Vz*VP,Vp[VQ+2]=VX*VE+Vz*VA,Vp[VQ+3]=VX*Vm+Vz*VT,Vp},VD.getRotation=function(Vn,Va,VU,Vx){return Math.atan2(Vx-Va,VU-Vn)/Math.PI*180},VD.sortBigFirst=function(Vn,Va){return Vn==Va?0:Vn<Va?1:-1},VD.sortSmallFirst=function(Vn,Va){return Vn==Va?0:Vn<Va?-1:1},VD.sortNumBigFirst=function(Vn,Va){return parseFloat(Va)-parseFloat(Vn)},VD.sortNumSmallFirst=function(Vn,Va){return parseFloat(Vn)-parseFloat(Va)},VD.sortByKey=function(VU,Vn,Va){var Vx;return void 0===Vn&&(Vn=!1),void 0===Va&&(Va=!0),Vx=Vn?Va?VD.sortNumBigFirst:VD.sortBigFirst:Va?VD.sortNumSmallFirst:VD.sortSmallFirst,function(Vn,Va){return Vx(Vn[VU],Va[VU])}},VD}(),Vc=function(){function VU(Vn,Va,VU,Vx,VD,Vp){this.inPool=!1,this.bTransform=!1,void 0===Vn&&(Vn=1),void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=1),void 0===VD&&(VD=0),void 0===Vp&&(Vp=0),this.a=Vn,this.b=Va,this.c=VU,this.d=Vx,this.tx=VD,this.ty=Vp,this._checkTransform()}Vm(VU,"laya.maths.Matrix");var Vn=VU.prototype;return Vn.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},Vn._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},Vn.setTranslate=function(Vn,Va){return this.tx=Vn,this.ty=Va,this},Vn.translate=function(Vn,Va){return this.tx+=Vn,this.ty+=Va,this},Vn.scale=function(Vn,Va){this.a*=Vn,this.d*=Va,this.c*=Vn,this.b*=Va,this.tx*=Vn,this.ty*=Va,this.bTransform=!0},Vn.rotate=function(Vn){var Va=Math.cos(Vn),VU=Math.sin(Vn),Vx=this.a,VD=this.c,Vp=this.tx;this.a=Vx*Va-this.b*VU,this.b=Vx*VU+this.b*Va,this.c=VD*Va-this.d*VU,this.d=VD*VU+this.d*Va,this.tx=Vp*Va-this.ty*VU,this.ty=Vp*VU+this.ty*Va,this.bTransform=!0},Vn.skew=function(Vn,Va){var VU=Math.tan(Vn),Vx=Math.tan(Va),VD=this.a,Vp=this.b;return this.a+=Vx*this.c,this.b+=Vx*this.d,this.c+=VU*VD,this.d+=VU*Vp,this},Vn.invertTransformPoint=function(Vn){var Va=this.a,VU=this.b,Vx=this.c,VD=this.d,Vp=this.tx,VQ=Va*VD-VU*Vx,VV=VD/VQ,Vy=-VU/VQ,VR=-Vx/VQ,VX=Va/VQ,Vz=(Vx*this.ty-VD*Vp)/VQ,Vi=-(Va*this.ty-VU*Vp)/VQ;return Vn.setTo(VV*Vn.x+VR*Vn.y+Vz,Vy*Vn.x+VX*Vn.y+Vi)},Vn.transformPoint=function(Vn){return Vn.setTo(this.a*Vn.x+this.c*Vn.y+this.tx,this.b*Vn.x+this.d*Vn.y+this.ty)},Vn.transformPointN=function(Vn){return Vn.setTo(this.a*Vn.x+this.c*Vn.y,this.b*Vn.x+this.d*Vn.y)},Vn.transformPointArray=function(Vn,Va){for(var VU=Vn.length,Vx=0;Vx<VU;Vx+=2){var VD=Vn[Vx],Vp=Vn[Vx+1];Va[Vx]=this.a*VD+this.c*Vp+this.tx,Va[Vx+1]=this.b*VD+this.d*Vp+this.ty}return Va},Vn.transformPointArrayScale=function(Vn,Va){for(var VU=Vn.length,Vx=0;Vx<VU;Vx+=2){var VD=Vn[Vx],Vp=Vn[Vx+1];Va[Vx]=this.a*VD+this.c*Vp,Va[Vx+1]=this.b*VD+this.d*Vp}return Va},Vn.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},Vn.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},Vn.invert=function(){var Vn=this.a,Va=this.b,VU=this.c,Vx=this.d,VD=this.tx,Vp=Vn*Vx-Va*VU;return this.a=Vx/Vp,this.b=-Va/Vp,this.c=-VU/Vp,this.d=Vn/Vp,this.tx=(VU*this.ty-Vx*VD)/Vp,this.ty=-(Vn*this.ty-Va*VD)/Vp,this},Vn.setTo=function(Vn,Va,VU,Vx,VD,Vp){return this.a=Vn,this.b=Va,this.c=VU,this.d=Vx,this.tx=VD,this.ty=Vp,this},Vn.concat=function(Vn){var Va=this.a,VU=this.c,Vx=this.tx;return this.a=Va*Vn.a+this.b*Vn.c,this.b=Va*Vn.b+this.b*Vn.d,this.c=VU*Vn.a+this.d*Vn.c,this.d=VU*Vn.b+this.d*Vn.d,this.tx=Vx*Vn.a+this.ty*Vn.c+Vn.tx,this.ty=Vx*Vn.b+this.ty*Vn.d+Vn.ty,this},Vn.scaleEx=function(Vn,Va){var VU=this.a,Vx=this.b,VD=this.c,Vp=this.d;0!==Vx||0!==VD?(this.a=Vn*VU,this.b=Vn*Vx,this.c=Va*VD):(this.a=Vn*VU,this.b=0*Vp,this.c=0*VU),this.d=Va*Vp,this.bTransform=!0},Vn.rotateEx=function(Vn){var Va=Math.cos(Vn),VU=Math.sin(Vn),Vx=this.a,VD=this.b,Vp=this.c,VQ=this.d;0!==VD||0!==Vp?(this.a=Va*Vx+VU*Vp,this.b=Va*VD+VU*VQ,this.c=-VU*Vx+Va*Vp,this.d=-VU*VD+Va*VQ):(this.a=Va*Vx,this.b=VU*VQ,this.c=-VU*Vx,this.d=Va*VQ),this.bTransform=!0},Vn.clone=function(){var Vn=VU.create();return Vn.a=this.a,Vn.b=this.b,Vn.c=this.c,Vn.d=this.d,Vn.tx=this.tx,Vn.ty=this.ty,Vn.bTransform=this.bTransform,Vn},Vn.copyTo=function(Vn){return Vn.a=this.a,Vn.b=this.b,Vn.c=this.c,Vn.d=this.d,Vn.tx=this.tx,Vn.ty=this.ty,Vn.bTransform=this.bTransform,Vn},Vn.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},Vn.destroy=function(){if(!this.inPool){var Vn=VU._cache;this.inPool=!0,Vn._length||(Vn._length=0),(Vn[Vn._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},VU.mul=function(Vn,Va,VU){var Vx=Vn.a,VD=Vn.b,Vp=Vn.c,VQ=Vn.d,VV=Vn.tx,Vy=Vn.ty,VR=Va.a,VX=Va.b,Vz=Va.c,Vi=Va.d,Vq=Va.tx,VE=Va.ty;return 0!==VX||0!==Vz?(VU.a=Vx*VR+VD*Vz,VU.b=Vx*VX+VD*Vi,VU.c=Vp*VR+VQ*Vz,VU.d=Vp*VX+VQ*Vi,VU.tx=VR*VV+Vz*Vy+Vq,VU.ty=VX*VV+Vi*Vy+VE):(VU.a=Vx*VR,VU.b=VD*Vi,VU.c=Vp*VR,VU.d=VQ*Vi,VU.tx=VR*VV+Vq,VU.ty=Vi*Vy+VE),VU},VU.mul16=function(Vn,Va,VU){var Vx=Vn.a,VD=Vn.b,Vp=Vn.c,VQ=Vn.d,VV=Vn.tx,Vy=Vn.ty,VR=Va.a,VX=Va.b,Vz=Va.c,Vi=Va.d,Vq=Va.tx,VE=Va.ty;return 0!==VX||0!==Vz?(VU[0]=Vx*VR+VD*Vz,VU[1]=Vx*VX+VD*Vi,VU[4]=Vp*VR+VQ*Vz,VU[5]=Vp*VX+VQ*Vi,VU[12]=VR*VV+Vz*Vy+Vq,VU[13]=VX*VV+Vi*Vy+VE):(VU[0]=Vx*VR,VU[1]=VD*Vi,VU[4]=Vp*VR,VU[5]=VQ*Vi,VU[12]=VR*VV+Vq,VU[13]=Vi*Vy+VE),VU},VU.mulPre=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){var Vy=Vn.a,VR=Vn.b,VX=Vn.c,Vz=Vn.d,Vi=Vn.tx,Vq=Vn.ty;return 0!==VU||0!==Vx?(VV.a=Vy*Va+VR*Vx,VV.b=Vy*VU+VR*VD,VV.c=VX*Va+Vz*Vx,VV.d=VX*VU+Vz*VD,VV.tx=Va*Vi+Vx*Vq+Vp,VV.ty=VU*Vi+VD*Vq+VQ):(VV.a=Vy*Va,VV.b=VR*VD,VV.c=VX*Va,VV.d=Vz*VD,VV.tx=Va*Vi+Vp,VV.ty=VD*Vq+VQ),VV},VU.mulPos=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){var Vy=Vn.a,VR=Vn.b,VX=Vn.c,Vz=Vn.d,Vi=Vn.tx,Vq=Vn.ty;return 0!==VR||0!==VX?(VV.a=Va*Vy+VU*VX,VV.b=Va*VR+VU*Vz,VV.c=Vx*Vy+VD*VX,VV.d=Vx*VR+VD*Vz,VV.tx=Vy*Vp+VX*VQ+Vi,VV.ty=VR*Vp+Vz*VQ+Vq):(VV.a=Va*Vy,VV.b=VU*Vz,VV.c=Vx*Vy,VV.d=VD*Vz,VV.tx=Vy*Vp+Vi,VV.ty=Vz*VQ+Vq),VV},VU.preMul=function(Vn,Va,VU){var Vx=Vn.a,VD=Vn.b,Vp=Vn.c,VQ=Vn.d,VV=Va.a,Vy=Va.b,VR=Va.c,VX=Va.d,Vz=Va.tx,Vi=Va.ty;return VU.a=VV*Vx,VU.b=VU.c=0,VU.d=VX*VQ,VU.tx=Vz*Vx+Vn.tx,VU.ty=Vi*VQ+Vn.ty,0===Vy&&0===VR&&0===VD&&0===Vp||(VU.a+=Vy*Vp,VU.d+=VR*VD,VU.b+=VV*VD+Vy*VQ,VU.c+=VR*Vx+VX*Vp,VU.tx+=Vi*Vp,VU.ty+=Vz*VD),VU},VU.preMulXY=function(Vn,Va,VU,Vx){var VD=Vn.a,Vp=Vn.b,VQ=Vn.c,VV=Vn.d;return Vx.a=VD,Vx.b=Vp,Vx.c=VQ,Vx.d=VV,Vx.tx=Va*VD+Vn.tx+VU*VQ,Vx.ty=VU*VV+Vn.ty+Va*Vp,Vx},VU.create=function(){var Vn=VU._cache,Va=Vn._length?Vn[--Vn._length]:new VU;return Va.inPool=!1,Va},VU.EMPTY=new VU,VU.TEMP=new VU,VU._cache=[],VU}(),VN=function(){function Vn(Vn,Va){void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),this.x=Vn,this.y=Va}Vm(Vn,"laya.maths.Point");var Va=Vn.prototype;return Va.setTo=function(Vn,Va){return this.x=Vn,this.y=Va,this},Va.distance=function(Vn,Va){return Math.sqrt((this.x-Vn)*(this.x-Vn)+(this.y-Va)*(this.y-Va))},Va.toString=function(){return this.x+","+this.y},Va.normalize=function(){var Vn=Math.sqrt(this.x*this.x+this.y*this.y);if(0<Vn){var Va=1/Vn;this.x*=Va,this.y*=Va}},Vn.TEMP=new Vn,Vn.EMPTY=new Vn,Vn}(),V_=function(){function VR(Vn,Va,VU,Vx){void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=0),this.x=Vn,this.y=Va,this.width=VU,this.height=Vx}Vm(VR,"laya.maths.Rectangle");var Vn=VR.prototype;return Vn.setTo=function(Vn,Va,VU,Vx){return this.x=Vn,this.y=Va,this.width=VU,this.height=Vx,this},Vn.copyFrom=function(Vn){return this.x=Vn.x,this.y=Vn.y,this.width=Vn.width,this.height=Vn.height,this},Vn.contains=function(Vn,Va){return!(this.width<=0||this.height<=0)&&(Vn>=this.x&&Vn<this.right&&Va>=this.y&&Va<this.bottom)},Vn.intersects=function(Vn){return!(Vn.x>this.x+this.width||Vn.x+Vn.width<this.x||Vn.y>this.y+this.height||Vn.y+Vn.height<this.y)},Vn.intersection=function(Vn,Va){return this.intersects(Vn)?(Va||(Va=new VR),Va.x=Math.max(this.x,Vn.x),Va.y=Math.max(this.y,Vn.y),Va.width=Math.min(this.right,Vn.right)-Va.x,Va.height=Math.min(this.bottom,Vn.bottom)-Va.y,Va):null},Vn.union=function(Vn,Va){return Va||(Va=new VR),this.clone(Va),Vn.width<=0||Vn.height<=0?Va:(Va.addPoint(Vn.x,Vn.y),Va.addPoint(Vn.right,Vn.bottom),this)},Vn.clone=function(Vn){return Vn||(Vn=new VR),Vn.x=this.x,Vn.y=this.y,Vn.width=this.width,Vn.height=this.height,Vn},Vn.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},Vn.equals=function(Vn){return!(!Vn||Vn.x!==this.x||Vn.y!==this.y||Vn.width!==this.width||Vn.height!==this.height)},Vn.addPoint=function(Vn,Va){return this.x>Vn&&(this.width+=this.x-Vn,this.x=Vn),this.y>Va&&(this.height+=this.y-Va,this.y=Va),this.width<Vn-this.x&&(this.width=Vn-this.x),this.height<Va-this.y&&(this.height=Va-this.y),this},Vn._getBoundPoints=function(){var Vn=VR._temB;return(Vn.length=0)==this.width||0==this.height||Vn.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),Vn},Vn.isEmpty=function(){return this.width<=0||this.height<=0},VX(0,Vn,"right",function(){return this.x+this.width}),VX(0,Vn,"bottom",function(){return this.y+this.height}),VR._getBoundPointS=function(Vn,Va,VU,Vx){var VD=VR._temA;return(VD.length=0)==VU||0==Vx||VD.push(Vn,Va,Vn+VU,Va,Vn,Va+Vx,Vn+VU,Va+Vx),VD},VR._getWrapRec=function(Vn,Va){if(!Vn||Vn.length<1)return Va?Va.setTo(0,0,0,0):VR.TEMP.setTo(0,0,0,0);Va=Va||new VR;var VU,Vx,VD,Vp,VQ,VV=Vn.length,Vy=VN.TEMP;for(VD=VQ=-(Vx=Vp=99999),VU=0;VU<VV;VU+=2)Vy.x=Vn[VU],Vy.y=Vn[VU+1],Vx=Vx<Vy.x?Vx:Vy.x,Vp=Vp<Vy.y?Vp:Vy.y,VD=VD>Vy.x?VD:Vy.x,VQ=VQ>Vy.y?VQ:Vy.y;return Va.setTo(Vx,Vp,VD-Vx,VQ-Vp)},VR.EMPTY=new VR,VR.TEMP=new VR,VR._temB=[],VR._temA=[],VR}(),VZ=function(){function Vy(){}return Vm(Vy,"laya.media.SoundManager"),VX(1,Vy,"useAudioMusic",function(){return Vy._useAudioMusic},function(Vn){Vy._useAudioMusic=Vn,Vy._musicClass=Vn?VUn:null}),VX(1,Vy,"autoStopMusic",function(){return Vy._autoStopMusic},function(Vn){Vk.stage.off("blur",null,Vy._stageOnBlur),Vk.stage.off("focus",null,Vy._stageOnFocus),Vk.stage.off("visibilitychange",null,Vy._visibilityChange),(Vy._autoStopMusic=Vn)&&(Vk.stage.on("blur",null,Vy._stageOnBlur),Vk.stage.on("focus",null,Vy._stageOnFocus),Vk.stage.on("visibilitychange",null,Vy._visibilityChange))}),VX(1,Vy,"muted",function(){return Vy._muted},function(Vn){Vn!=Vy._muted&&(Vn&&Vy.stopAllSound(),Vy.musicMuted=Vn,Vy._muted=Vn)}),VX(1,Vy,"musicMuted",function(){return Vy._musicMuted},function(Vn){Vn!=Vy._musicMuted&&(Vn?(Vy._tMusic&&Vy._musicChannel&&!Vy._musicChannel.isStopped?Vy._musicChannel.pause():Vy._musicChannel=null,Vy._musicMuted=Vn):(Vy._musicMuted=Vn,Vy._tMusic&&Vy._musicChannel&&Vy._musicChannel.resume()))}),VX(1,Vy,"soundMuted",function(){return Vy._soundMuted},function(Vn){Vy._soundMuted=Vn}),Vy.addChannel=function(Vn){0<=Vy._channels.indexOf(Vn)||(Vy._channels.push(Vn),Vy.autoReleaseSound&&0!=Vy._notUsedCount&&Vy._notUsedUrls[Vn.url]&&(delete Vy._notUsedUrls[Vn.url],0==--Vy._notUsedCount&&Vk.timer.clear(Vy,Vy.disposeSoundIfNotUsed)))},Vy.removeChannel=function(Vn){var Va=Vy._channels,VU=Va.indexOf(Vn);if(-1!=VU&&(Va.splice(VU,1),Vy.autoReleaseSound)){var Vx=Vn.url,VD=Vy.defaultIntervals[Vx]||2e4;if(0<VD){var Vp=!0;for(VU=Va.length-1;0<=VU;VU--)if(Va[VU].url==Vx){Vp=!1;break}Vp&&(Vy._notUsedUrls[Vx]=Date.now()+VD,0==Vy._notUsedCount++&&Vk.timer.loop(1e4,Vy,Vy.disposeSoundIfNotUsed))}}},Vy.disposeSoundIfNotUsed=function(){var Vn=Vy._notUsedUrls;if(0!=Vy._notUsedCount){var Va=Date.now();for(var VU in Vn)Va>=Vn[VU]&&(delete Vn[VU],--Vy._notUsedCount,Vy.destroySound(VU));if(0!=Vy._notUsedCount)return}Vk.timer.clear(Vy,Vy.disposeSoundIfNotUsed)},Vy._visibilityChange=function(){Vk.stage.isVisibility?Vy._stageOnFocus():Vy._stageOnBlur()},Vy._stageOnBlur=function(){Vy._isActive=!1,Vy._musicChannel&&(Vy._musicChannel.isStopped||(Vy._blurPaused=!0,Vy._musicChannel.pause())),Vy.stopAllSound(),Vk.stage.once("mousedown",null,Vy._stageOnFocus)},Vy._recoverWebAudio=function(){Vpn.ctx&&"running"!=Vpn.ctx.state&&Vpn.ctx.resume&&Vpn.ctx.resume()},Vy._stageOnFocus=function(){if(Vy._isActive=!0,Vy._recoverWebAudio(),Vk.stage.off("mousedown",null,Vy._stageOnFocus),Vy._blurPaused){var Vn=Vy._musicChannel;Vn&&Vy._music&&Vn.isStopped&&(Vy._blurPaused=!1,Vy._music._disposed?Vy.playMusic(Vn.url,Vn.loops,Vn.startHandler,Vn.completeHandler,Vn.startTime):Vn.audioBuffer?Vn.resume():Vy._music.play(Vn.startTime,Vn.loops,Vn.startHandler,Vn))}},Vy.playSound=function(Vn,Va,VU,Vx,VD,Vp){if(void 0===Va&&(Va=1),void 0===Vp&&(Vp=0),!Vn)return null;if(Vy._muted)return null;if(Vy._recoverWebAudio(),Vn==Vy._tMusic){if(Vy._musicMuted)return null}else{if(!Vy._isActive)return null;if(Vy._soundMuted)return null}var VQ,VV=Vy._pool[Vn];return VD||(VD=Vy._soundClass),VV||((VV=new VD).load(Vn),Vy._pool[Vn]=VV),(VQ=VV.play(Vp,Va,VU))?(Vn==Vy._tMusic&&(Vy._music=VV,Vy._isActive||(Vy._blurPaused=!0,VQ.pause())),VQ.url=Vn,VQ.volume=Vn==Vy._tMusic?Vy.musicVolume:Vy.soundVolume,VQ.completeHandler=Vx,VQ):null},Vy.destroySound=function(Vn){var Va=Vy._pool[Vn];Va&&(delete Vy._pool[Vn],Va.dispose())},Vy.playMusic=function(Vn,Va,VU,Vx,VD){return void 0===Va&&(Va=0),void 0===VD&&(VD=0),Vy._tMusic=Vn,Vy._musicChannel&&Vy._musicChannel.stop(),Vy._musicChannel=Vy.playSound(Vn,Va,VU,Vx,null,VD)},Vy.stopSound=function(Vn){for(var Va,VU=Vy._channels.length-1;0<=VU;VU--)(Va=Vy._channels[VU]).url==Vn&&Va.stop()},Vy.stopAll=function(){Vy._tMusic=null;var Vn=0;for(Vn=Vy._channels.length-1;0<=Vn;Vn--)Vy._channels[Vn].stop()},Vy.stopAllSound=function(){var Vn,Va=0;for(Va=Vy._channels.length-1;0<=Va;Va--)(Vn=Vy._channels[Va]).url!=Vy._tMusic&&Vn.stop()},Vy.stopMusic=function(){Vy._musicChannel&&Vy._musicChannel.stop(),Vy._tMusic=null},Vy.setSoundVolume=function(Vn,Va){if(Va)Vy._setVolume(Va,Vn);else{Vy.soundVolume=Vn;var VU,Vx=0;for(Vx=Vy._channels.length-1;0<=Vx;Vx--)(VU=Vy._channels[Vx]).url!=Vy._tMusic&&(VU.volume=Vn)}},Vy.setMusicVolume=function(Vn){Vy.musicVolume=Vn,Vy._setVolume(Vy._tMusic,Vn)},Vy._setVolume=function(Vn,Va){for(var VU,Vx=Vy._channels.length-1;0<=Vx;Vx--)(VU=Vy._channels[Vx]).url==Vn&&(VU.volume=Va)},Vy.musicVolume=1,Vy.soundVolume=1,Vy.playbackRate=1,Vy._useAudioMusic=!0,Vy._muted=!1,Vy._soundMuted=!1,Vy._musicMuted=!1,Vy._tMusic=null,Vy._musicChannel=null,Vy._music=null,Vy._channels=[],Vy._autoStopMusic=!1,Vy._blurPaused=!1,Vy._isActive=!0,Vy._soundClass=null,Vy._musicClass=null,Vy.autoReleaseSound=!0,Vy._pool={},Vy.defaultIntervals={},Vy._notUsedUrls={},Vy._notUsedCount=0,Vy}(),V$=function(){var Vn;function VU(){}return Vm(VU,"laya.net.LocalStorage"),VU.__init__=function(){VU._baseClass||(VU._baseClass=Vn).init(),VU.items=VU._baseClass.items,VU.support=VU._baseClass.support},VU.setItem=function(Vn,Va){VU._baseClass.setItem(Vn,Va)},VU.getItem=function(Vn){return VU._baseClass.getItem(Vn)},VU.setJSON=function(Vn,Va){VU._baseClass.setJSON(Vn,Va)},VU.getJSON=function(Vn){return VU._baseClass.getJSON(Vn)},VU.removeItem=function(Vn){VU._baseClass.removeItem(Vn)},VU.clear=function(){VU._baseClass.clear()},VU._baseClass=null,VU.items=null,VU.support=!1,VU.__init$=function(){Vn=function(){function VU(){}return Vm(VU,""),VU.init=function(){try{VU.support=!0,VU.items=VQ.localStorage,VU.setItem("laya","1"),VU.removeItem("laya")}catch(Vn){VU.support=!1}VU.support||console.log("LocalStorage is not supprot or browser is private mode.")},VU.setItem=function(Vn,Va){try{VU.support&&VU.items.setItem(Vn,Va)}catch(Vn){console.warn("set localStorage failed",Vn)}},VU.getItem=function(Vn){return VU.support?VU.items.getItem(Vn):null},VU.setJSON=function(Vn,Va){try{VU.support&&VU.items.setItem(Vn,JSON.stringify(Va))}catch(Vn){console.warn("set localStorage failed",Vn)}},VU.getJSON=function(Vn){return JSON.parse(VU.support?VU.items.getItem(Vn):null)},VU.removeItem=function(Vn){VU.support&&VU.items.removeItem(Vn)},VU.clear=function(){VU.support&&VU.items.clear()},VU.items=null,VU.support=!1,VU}()},VU}(),VH=(function(){function Vx(){}Vm(Vx,"laya.net.ResourceVersion"),Vx.enable=function(Vn,Va,VU){void 0===VU&&(VU=2),laya.net.ResourceVersion.type=VU,Vk.loader.load(Vn,VA.create(null,Vx.onManifestLoaded,[Va]),null,"json"),VG.customFormat=Vx.addVersionPrefix},Vx.onManifestLoaded=function(Vn,Va){Vx.manifest=Va,Vn.run(),Va||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},Vx.addVersionPrefix=function(Vn){return Vx.manifest&&Vx.manifest[Vn]?2==Vx.type?Vx.manifest[Vn]:Vx.manifest[Vn]+"/"+Vn:Vn},Vx.FOLDER_VERSION=1,Vx.FILENAME_VERSION=2,Vx.manifest=null,Vx.type=1}(),function(){function Vn(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}Vm(Vn,"laya.net.TTFLoader");var Va=Vn.prototype;return Va.load=function(Vn){var Va=(this._url=Vn).split(".ttf")[0].split("/");this.fontName=Va[Va.length-1],Vf.window.conch?this._loadConch():Vf.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},Va._loadConch=function(){this._http=new VQn,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},Va._onHttpLoaded=function(Vn){Vf.window.conch.setFontFaceFromBuffer(this.fontName,Vn),this._clearHttp(),this._complete()},Va._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},Va._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},Va._complete=function(){Vk.timer.clear(this,this._complete),Vk.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},Va._checkComplete=function(){Vu.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},Va._loadWithFontFace=function(){var Vn=new Vf.window.FontFace(this.fontName,"url('"+this._url+"')");Vf.window.document.fonts.add(Vn);var Va=this;Vn.loaded.then(function(){Va._complete()}),Vn.load()},Va._createDiv=function(){this._div=Vf.createElement("div"),this._div.innerHTML="laya";var Vn=this._div.style;Vn.fontFamily=this.fontName,Vn.position="absolute",Vn.left="-100px",Vn.top="-100px",Vf.document.body.appendChild(this._div)},Va._loadWithCSS=function(){var Vn=this,Va=Vf.createElement("style");Va.type="text/css",Vf.document.body.appendChild(Va),Va.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=Vu.measureText("LayaTTFFont",this._fontTxt).width;var VU=this;Va.onload=function(){Vk.timer.once(1e4,VU,Vn._complete)},Vk.timer.loop(20,this,this._checkComplete),this._createDiv()},Vn._testString="LayaTTFFont",Vn}()),VG=function(){function Vx(Vn){this._url=null,this._path=null,this._url=Vx.formatURL(Vn),this._path=Vx.getPath(Vn)}Vm(Vx,"laya.net.URL");var Vn=Vx.prototype;return VX(0,Vn,"path",function(){return this._path}),VX(0,Vn,"url",function(){return this._url}),Vx.formatURL=function(Vn,Va){if(!Vn)return"null path";if(0<Vn.indexOf(":"))return Vn;null!=Vx.customFormat&&(Vn=Vx.customFormat(Vn,Va));var VU=Vn.charAt(0);if("."===VU)return Vx.formatRelativePath((Va||Vx.basePath)+Vn);if("~"===VU)return Vx.rootPath+Vn.substring(1);if("d"===VU){if(0===Vn.indexOf("data:image"))return Vn}else if("/"===VU)return Vn;return(Va||Vx.basePath)+Vn},Vx.formatRelativePath=function(Vn){for(var Va=Vn.split("/"),VU=0,Vx=Va.length;VU<Vx;VU++)".."==Va[VU]&&(Va.splice(VU-1,2),VU-=2);return Va.join("/")},Vx.isAbsolute=function(Vn){return 0<Vn.indexOf(":")||"/"==Vn.charAt(0)},Vx.getPath=function(Vn){var Va=Vn.lastIndexOf("/");return 0<Va?Vn.substr(0,Va+1):""},Vx.getFileName=function(Vn){var Va=Vn.lastIndexOf("/");return 0<Va?Vn.substr(Va+1):Vn},Vx.version={},Vx.basePath="",Vx.rootPath="",Vx.customFormat=function(Vn){var Va=Vx.version[Vn];return!VI.isConchApp&&Va&&(Vn+="?v="+Va),Vn},Vx}(),VI=function(){function VD(Vn,Va){this._timeId=0;var VU=VD._mainCanvas.source.style;VU.position="absolute",VU.top=VU.left="0px",VU.background="#000000",VD._mainCanvas.source.id="layaCanvas";var Vx=laya.renders.Render.isWebGL;VD._mainCanvas.source.width=Vn,VD._mainCanvas.source.height=Va,Vx&&VD.WebGL.init(VD._mainCanvas,Vn,Va),Vf.container.appendChild(VD._mainCanvas.source),(VD._context=new Vv(Vn,Va,Vx?null:VD._mainCanvas)).ctx.setIsMainContext(),Vf.window.requestAnimationFrame(function Vn(Va){Vf.window.requestAnimationFrame(Vn);Vk.stage._loop()}),Vk.stage.on("visibilitychange",this,this._onVisibilitychange)}Vm(VD,"laya.renders.Render");var Vn=VD.prototype;return Vn._onVisibilitychange=function(){Vk.stage.isVisibility?0!=this._timeId&&Vf.window.clearInterval(this._timeId):this._timeId=Vf.window.setInterval(this._enterFrame,1e3)},Vn._enterFrame=function(Vn){Vk.stage._loop()},VX(1,VD,"context",function(){return VD._context}),VX(1,VD,"canvas",function(){return VD._mainCanvas.source}),VD._context=null,VD._mainCanvas=null,VD.WebGL=null,VD.isConchNode=!1,VD.isConchApp=!1,VD.isConchWebGL=!1,VD.isWebGL=!1,VD.is3DMode=!1,VD.optimizeTextureMemory=function(Vn,Va){return!0},VD.__init$=function(){VQ.ConchRenderType=VQ.ConchRenderType||1,VQ.ConchRenderType|=VQ.conch?4:0,VD.isConchNode=5==(5&VQ.ConchRenderType),VD.isConchApp=4==(4&VQ.ConchRenderType),VD.isConchWebGL=6==VQ.ConchRenderType},VD}(),Vv=function(){function VQ(Vn,Va,VU){this.x=0,this.y=0,this._drawTexture=function(Vn,Va,VU){VU[0].loaded&&this.ctx.drawTexture(VU[0],VU[1],VU[2],VU[3],VU[4],Vn,Va)},this._fillTexture=function(Vn,Va,VU){VU[0].loaded&&this.ctx.fillTexture(VU[0],VU[1]+Vn,VU[2]+Va,VU[3],VU[4],VU[5],VU[6],VU[7])},this._drawTextureWithTransform=function(Vn,Va,VU){VU[0].loaded&&this.ctx.drawTextureWithTransform(VU[0],VU[1],VU[2],VU[3],VU[4],VU[5],Vn,Va,VU[6])},this._fillQuadrangle=function(Vn,Va,VU){this.ctx.fillQuadrangle(VU[0],VU[1],VU[2],VU[3],VU[4])},this._drawRect=function(Vn,Va,VU){var Vx=this.ctx;null!=VU[4]&&(Vx.fillStyle=VU[4],Vx.fillRect(Vn+VU[0],Va+VU[1],VU[2],VU[3],null)),null!=VU[5]&&(Vx.strokeStyle=VU[5],Vx.lineWidth=VU[6],Vx.strokeRect(Vn+VU[0],Va+VU[1],VU[2],VU[3],VU[6]))},this._drawPie=function(Vn,Va,VU){var Vx=this.ctx;VI.isWebGL&&Vx.setPathId(VU[8]),Vx.beginPath(),VI.isWebGL?(Vx.movePath(VU[0]+Vn,VU[1]+Va),Vx.moveTo(0,0)):Vx.moveTo(Vn+VU[0],Va+VU[1]),Vx.arc(Vn+VU[0],Va+VU[1],VU[2],VU[3],VU[4]),Vx.closePath(),this._fillAndStroke(VU[5],VU[6],VU[7],!0)},this._clipRect=function(Vn,Va,VU){this.ctx.clipRect(Vn+VU[0],Va+VU[1],VU[2],VU[3])},this._fillRect=function(Vn,Va,VU){this.ctx.fillRect(Vn+VU[0],Va+VU[1],VU[2],VU[3],VU[4])},this._drawCircle=function(Vn,Va,VU){var Vx=this.ctx;VI.isWebGL&&Vx.setPathId(VU[6]),Vw.drawCall++,Vx.beginPath(),VI.isWebGL&&Vx.movePath(VU[0]+Vn,VU[1]+Va),Vx.arc(VU[0]+Vn,VU[1]+Va,VU[2],0,VQ.PI2),Vx.closePath(),this._fillAndStroke(VU[3],VU[4],VU[5],!0)},this._fillCircle=function(Vn,Va,VU){Vw.drawCall++;var Vx=this.ctx;Vx.beginPath(),Vx.fillStyle=VU[3],Vx.arc(VU[0]+Vn,VU[1]+Va,VU[2],0,VQ.PI2),Vx.fill()},this._setShader=function(Vn,Va,VU){this.ctx.setShader(VU[0])},this._drawLine=function(Vn,Va,VU){var Vx=this.ctx;VI.isWebGL&&Vx.setPathId(VU[6]),Vx.beginPath(),Vx.strokeStyle=VU[4],Vx.lineWidth=VU[5],VI.isWebGL?(Vx.movePath(Vn,Va),Vx.moveTo(VU[0],VU[1]),Vx.lineTo(VU[2],VU[3])):(Vx.moveTo(Vn+VU[0],Va+VU[1]),Vx.lineTo(Vn+VU[2],Va+VU[3])),Vx.stroke()},this._drawLines=function(Vn,Va,VU){var Vx=this.ctx;VI.isWebGL&&Vx.setPathId(VU[5]),Vx.beginPath(),Vn+=VU[0],Va+=VU[1],VI.isWebGL&&Vx.movePath(Vn,Va),Vx.strokeStyle=VU[3],Vx.lineWidth=VU[4];var VD=VU[2],Vp=2,VQ=VD.length;if(VI.isWebGL)for(Vx.moveTo(VD[0],VD[1]);Vp<VQ;)Vx.lineTo(VD[Vp++],VD[Vp++]);else for(Vx.moveTo(Vn+VD[0],Va+VD[1]);Vp<VQ;)Vx.lineTo(Vn+VD[Vp++],Va+VD[Vp++]);Vx.stroke()},this._drawLinesWebGL=function(Vn,Va,VU){this.ctx.drawLines(Vn+this.x+VU[0],Va+this.y+VU[1],VU[2],VU[3],VU[4])},this._drawCurves=function(Vn,Va,VU){this.ctx.drawCurves(Vn,Va,VU)},this._draw=function(Vn,Va,VU){VU[0].call(null,this,Vn,Va)},this._transformByMatrix=function(Vn,Va,VU){this.ctx.transformByMatrix(VU[0])},this._setTransform=function(Vn,Va,VU){this.ctx.setTransform(VU[0],VU[1],VU[2],VU[3],VU[4],VU[5])},this._setTransformByMatrix=function(Vn,Va,VU){this.ctx.setTransformByMatrix(VU[0])},this._save=function(Vn,Va,VU){this.ctx.save()},this._restore=function(Vn,Va,VU){this.ctx.restore()},this._translate=function(Vn,Va,VU){this.ctx.translate(VU[0],VU[1])},this._transform=function(Vn,Va,VU){this.ctx.translate(VU[1]+Vn,VU[2]+Va);var Vx=VU[0];this.ctx.transform(Vx.a,Vx.b,Vx.c,Vx.d,Vx.tx,Vx.ty),this.ctx.translate(-Vn-VU[1],-Va-VU[2])},this._rotate=function(Vn,Va,VU){this.ctx.translate(VU[1]+Vn,VU[2]+Va),this.ctx.rotate(VU[0]),this.ctx.translate(-Vn-VU[1],-Va-VU[2])},this._scale=function(Vn,Va,VU){this.ctx.translate(VU[2]+Vn,VU[3]+Va),this.ctx.scale(VU[0],VU[1]),this.ctx.translate(-Vn-VU[2],-Va-VU[3])},this._alpha=function(Vn,Va,VU){this.ctx.globalAlpha*=VU[0]},this._setAlpha=function(Vn,Va,VU){this.ctx.globalAlpha=VU[0]},this._fillText=function(Vn,Va,VU){this.ctx.fillText(VU[0],VU[1]+Vn,VU[2]+Va,VU[3],VU[4],VU[5])},this._strokeText=function(Vn,Va,VU){this.ctx.strokeText(VU[0],VU[1]+Vn,VU[2]+Va,VU[3],VU[4],VU[5],VU[6])},this._fillBorderText=function(Vn,Va,VU){this.ctx.fillBorderText(VU[0],VU[1]+Vn,VU[2]+Va,VU[3],VU[4],VU[5],VU[6],VU[7])},this._blendMode=function(Vn,Va,VU){this.ctx.globalCompositeOperation=VU[0]},this._beginClip=function(Vn,Va,VU){this.ctx.beginClip&&this.ctx.beginClip(Vn+VU[0],Va+VU[1],VU[2],VU[3])},this._setIBVB=function(Vn,Va,VU){this.ctx.setIBVB(VU[0]+Vn,VU[1]+Va,VU[2],VU[3],VU[4],VU[5],VU[6],VU[7])},this._fillTrangles=function(Vn,Va,VU){this.ctx.fillTrangles(VU[0],VU[1]+Vn,VU[2]+Va,VU[3],VU[4])},this._drawPath=function(Vn,Va,VU){var Vx=this.ctx;VI.isWebGL&&Vx.setPathId(-1),Vx.beginPath(),Vn+=VU[0],Va+=VU[1],VI.isWebGL&&Vx.movePath(Vn,Va);for(var VD=VU[2],Vp=0,VQ=VD.length;Vp<VQ;Vp++){var VV=VD[Vp];switch(VV[0]){case"moveTo":VI.isWebGL?Vx.moveTo(VV[1],VV[2]):Vx.moveTo(Vn+VV[1],Va+VV[2]);break;case"lineTo":VI.isWebGL?Vx.lineTo(VV[1],VV[2]):Vx.lineTo(Vn+VV[1],Va+VV[2]);break;case"arcTo":VI.isWebGL?Vx.arcTo(VV[1],VV[2],VV[3],VV[4],VV[5]):Vx.arcTo(Vn+VV[1],Va+VV[2],Vn+VV[3],Va+VV[4],VV[5]);break;case"closePath":Vx.closePath()}}var Vy=VU[3];null!=Vy&&(Vx.fillStyle=Vy.fillStyle,Vx.fill());var VR=VU[4];null!=VR&&(Vx.strokeStyle=VR.strokeStyle,Vx.lineWidth=VR.lineWidth||1,Vx.lineJoin=VR.lineJoin,Vx.lineCap=VR.lineCap,Vx.miterLimit=VR.miterLimit,Vx.stroke())},this.drawPoly=function(Vn,Va,VU){this.ctx.drawPoly(Vn+this.x+VU[0],Va+this.y+VU[1],VU[2],VU[3],VU[4],VU[5],VU[6])},this._drawPoly=function(Vn,Va,VU){var Vx=this.ctx,VD=VU[2],Vp=2,VQ=VD.length;if(VI.isWebGL)for(Vx.setPathId(VU[6]),Vx.beginPath(),Vn+=VU[0],Va+=VU[1],Vx.movePath(Vn,Va),Vx.moveTo(VD[0],VD[1]);Vp<VQ;)Vx.lineTo(VD[Vp++],VD[Vp++]);else for(Vx.beginPath(),Vn+=VU[0],Va+=VU[1],Vx.moveTo(Vn+VD[0],Va+VD[1]);Vp<VQ;)Vx.lineTo(Vn+VD[Vp++],Va+VD[Vp++]);Vx.closePath(),this._fillAndStroke(VU[3],VU[4],VU[5],VU[7])},this._drawSkin=function(Vn,Va,VU){var Vx=VU[0];if(Vx){var VD=this.ctx;Vx.render(VD,Vn,Va)}},this._drawParticle=function(Vn,Va,VU){this.ctx.drawParticle(Vn+this.x,Va+this.y,VU[0])},this._setFilters=function(Vn,Va,VU){this.ctx.setFilters(VU)},VU?this.ctx=VU.getContext("2d"):(VU=VTn.create("3D"),this.ctx=Vu.createWebGLContext2D(VU),VU._setContext(this.ctx)),VU.size(Vn,Va),this.canvas=VU}Vm(VQ,"laya.renders.RenderContext");var Vn=VQ.prototype;return Vn.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},Vn.drawTexture=function(Vn,Va,VU,Vx,VD){Vn.loaded&&this.ctx.drawTexture(Vn,Va,VU,Vx,VD,this.x,this.y)},Vn._drawTextures=function(Vn,Va,VU){VU[0].loaded&&this.ctx.drawTextures(VU[0],VU[1],Vn+this.x,Va+this.y)},Vn.drawTextureWithTransform=function(Vn,Va,VU,Vx,VD,Vp,VQ){Vn.loaded&&this.ctx.drawTextureWithTransform(Vn,Va,VU,Vx,VD,Vp,this.x,this.y,VQ)},Vn.fillQuadrangle=function(Vn,Va,VU,Vx,VD){this.ctx.fillQuadrangle(Vn,Va,VU,Vx,VD)},Vn.drawCanvas=function(Vn,Va,VU,Vx,VD){this.ctx.drawCanvas(Vn,Va+this.x,VU+this.y,Vx,VD)},Vn.drawRect=function(Vn,Va,VU,Vx,VD,Vp){void 0===Vp&&(Vp=1);var VQ=this.ctx;VQ.strokeStyle=VD,VQ.lineWidth=Vp,VQ.strokeRect(Vn+this.x,Va+this.y,VU,Vx,Vp)},Vn._fillAndStroke=function(Vn,Va,VU,Vx){void 0===Vx&&(Vx=!1);var VD=this.ctx;null!=Vn&&(VD.fillStyle=Vn,VI.isWebGL?VD.fill(Vx):VD.fill()),null!=Va&&0<VU&&(VD.strokeStyle=Va,VD.lineWidth=VU,VD.stroke())},Vn.clipRect=function(Vn,Va,VU,Vx){this.ctx.clipRect(Vn+this.x,Va+this.y,VU,Vx)},Vn.fillRect=function(Vn,Va,VU,Vx,VD){this.ctx.fillRect(Vn+this.x,Va+this.y,VU,Vx,VD)},Vn.drawCircle=function(Vn,Va,VU,Vx,VD){void 0===VD&&(VD=1),Vw.drawCall++;var Vp=this.ctx;Vp.beginPath(),Vp.strokeStyle=Vx,Vp.lineWidth=VD,Vp.arc(Vn+this.x,Va+this.y,VU,0,VQ.PI2),Vp.stroke()},Vn.drawTriangles=function(Vn,Va,VU){if(VI.isWebGL)this.ctx.drawTriangles(VU[0],Vn+VU[1],Va+VU[2],VU[3],VU[4],VU[5],VU[6],VU[7],VU[8],VU[9]);else{var Vx=VU[5],VD=0,Vp=Vx.length,VQ=this.ctx;for(VD=0;VD<Vp;VD+=3){var VV=2*Vx[VD],Vy=2*Vx[VD+1],VR=2*Vx[VD+2];VQ.drawTriangle(VU[0],VU[3],VU[4],VV,Vy,VR,VU[6],!0)}}},Vn.fillCircle=function(Vn,Va,VU,Vx){Vw.drawCall++;var VD=this.ctx;VD.beginPath(),VD.fillStyle=Vx,VD.arc(Vn+this.x,Va+this.y,VU,0,VQ.PI2),VD.fill()},Vn.setShader=function(Vn){this.ctx.setShader(Vn)},Vn.drawLine=function(Vn,Va,VU,Vx,VD,Vp){void 0===Vp&&(Vp=1);var VQ=this.ctx;VQ.beginPath(),VQ.strokeStyle=VD,VQ.lineWidth=Vp,VQ.moveTo(this.x+Vn,this.y+Va),VQ.lineTo(this.x+VU,this.y+Vx),VQ.stroke()},Vn.clear=function(){this.ctx.clear()},Vn.transformByMatrix=function(Vn){this.ctx.transformByMatrix(Vn)},Vn.setTransform=function(Vn,Va,VU,Vx,VD,Vp){this.ctx.setTransform(Vn,Va,VU,Vx,VD,Vp)},Vn.setTransformByMatrix=function(Vn){this.ctx.setTransformByMatrix(Vn)},Vn.save=function(){this.ctx.save()},Vn.restore=function(){this.ctx.restore()},Vn.translate=function(Vn,Va){this.ctx.translate(Vn,Va)},Vn.transform=function(Vn,Va,VU,Vx,VD,Vp){this.ctx.transform(Vn,Va,VU,Vx,VD,Vp)},Vn.rotate=function(Vn){this.ctx.rotate(Vn)},Vn.scale=function(Vn,Va){this.ctx.scale(Vn,Va)},Vn.alpha=function(Vn){this.ctx.globalAlpha*=Vn},Vn.setAlpha=function(Vn){this.ctx.globalAlpha=Vn},Vn.fillWords=function(Vn,Va,VU,Vx,VD,Vp){void 0===Vp&&(Vp=0),this.ctx.fillWords(Vn,Va,VU,Vx,VD,Vp)},Vn.fillBorderWords=function(Vn,Va,VU,Vx,VD,Vp,VQ){this.ctx.fillBorderWords(Vn,Va,VU,Vx,VD,Vp,VQ)},Vn.fillText=function(Vn,Va,VU,Vx,VD,Vp){this.ctx.fillText(Vn,Va+this.x,VU+this.y,Vx,VD,Vp)},Vn.strokeText=function(Vn,Va,VU,Vx,VD,Vp,VQ){this.ctx.strokeText(Vn,Va+this.x,VU+this.y,Vx,VD,Vp,VQ)},Vn.blendMode=function(Vn){this.ctx.globalCompositeOperation=Vn},Vn.flush=function(){this.ctx.flush&&this.ctx.flush()},Vn.addRenderObject=function(Vn){this.ctx.addRenderObject(Vn)},Vn.beginClip=function(Vn,Va,VU,Vx){this.ctx.beginClip&&this.ctx.beginClip(Vn,Va,VU,Vx)},Vn.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},Vn.fillTrangles=function(Vn,Va,VU){this.ctx.fillTrangles(VU[0],VU[1],VU[2],VU[3],4<VU.length?VU[4]:null)},VQ.PI2=2*Math.PI,VQ}(),Vl=function(){function VQ(Vn,Va){switch(this._next=Va||VQ.NORENDER,Vn){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=VP._filter);case 69905:return void(this._fun=VQ._initRenderFun)}this.onCreate(Vn)}Vm(VQ,"laya.renders.RenderSprite");var Vn=VQ.prototype;return Vn.onCreate=function(Vn){},Vn._style=function(Vn,Va,VU,Vx){Vn._style.render(Vn,Va,VU,Vx);var VD=this._next;VD._fun.call(VD,Vn,Va,VU,Vx)},Vn._no=function(Vn,Va,VU,Vx){},Vn._custom=function(Vn,Va,VU,Vx){Vn.customRender(Va,VU,Vx);var VD=Vn._style._tf;this._next._fun.call(this._next,Vn,Va,VU-VD.translateX,Vx-VD.translateY)},Vn._clip=function(Vn,Va,VU,Vx){var VD=this._next;if(VD!=VQ.NORENDER){var Vp=Vn._style.scrollRect;Va.ctx.save(),Va.ctx.clipRect(VU,Vx,Vp.width,Vp.height),VD._fun.call(VD,Vn,Va,VU-Vp.x,Vx-Vp.y),Va.ctx.restore()}},Vn._blend=function(Vn,Va,VU,Vx){var VD=Vn._style;VD.blendMode&&(Va.ctx.globalCompositeOperation=VD.blendMode);var Vp=this._next;Vp._fun.call(Vp,Vn,Va,VU,Vx),Va.ctx.globalCompositeOperation="source-over"},Vn._mask=function(Vn,Va,VU,Vx){var VD=this._next;VD._fun.call(VD,Vn,Va,VU,Vx);var Vp=Vn.mask;Vp&&(Va.ctx.globalCompositeOperation="destination-in",(0<Vp.numChildren||!Vp.graphics._isOnlyOne())&&(Vp.cacheAsBitmap=!0),Vp.render(Va,VU-Vn.pivotX,Vx-Vn.pivotY)),Va.ctx.globalCompositeOperation="source-over"},Vn._graphics=function(Vn,Va,VU,Vx){var VD=Vn._style._tf;Vn._graphics&&Vn._graphics._render(Vn,Va,VU-VD.translateX,Vx-VD.translateY);var Vp=this._next;Vp._fun.call(Vp,Vn,Va,VU,Vx)},Vn._image=function(Vn,Va,VU,Vx){var VD=Vn._style;Va.ctx.drawTexture2(VU,Vx,VD._tf.translateX,VD._tf.translateY,Vn.transform,VD.alpha,VD.blendMode,Vn._graphics._one)},Vn._image2=function(Vn,Va,VU,Vx){var VD=Vn._style._tf;Va.ctx.drawTexture2(VU,Vx,VD.translateX,VD.translateY,Vn.transform,1,null,Vn._graphics._one)},Vn._alpha=function(Vn,Va,VU,Vx){var VD;if(.01<(VD=Vn._style.alpha)||Vn._needRepaint()){var Vp=Va.ctx.globalAlpha;Va.ctx.globalAlpha*=VD;var VQ=this._next;VQ._fun.call(VQ,Vn,Va,VU,Vx),Va.ctx.globalAlpha=Vp}},Vn._transform=function(Vn,Va,VU,Vx){var VD=Vn.transform,Vp=this._next;VD&&Vp!=VQ.NORENDER?(Va.save(),Va.transform(VD.a,VD.b,VD.c,VD.d,VD.tx+VU,VD.ty+Vx),Vp._fun.call(Vp,Vn,Va,0,0),Va.restore()):Vp._fun.call(Vp,Vn,Va,VU,Vx)},Vn._childs=function(Vn,Va,VU,Vx){var VD=Vn._style,Vp=VD._tf;if(VU=VU-Vp.translateX+VD.paddingLeft,Vx=Vx-Vp.translateY+VD.paddingTop,VD._calculation){var VQ=Vn._getWords();if(VQ){var VV=VD;VV&&(VV.stroke?Va.fillBorderWords(VQ,VU,Vx,VV.font,VV.color,VV.strokeColor,VV.stroke):Va.fillWords(VQ,VU,Vx,VV.font,VV.color,"none"!=VV.textDecoration&&VV.underLine?1:0))}}var Vy,VR=Vn._childs,VX=VR.length;if(Vn.viewport||Vn.optimizeScrollRect&&Vn._style.scrollRect){var Vz=Vn.viewport||Vn._style.scrollRect,Vi=Vz.x,Vq=Vz.y,VE=Vz.right,Vm=Vz.bottom,Vb=NaN,VP=NaN;for(VA=0;VA<VX;++VA)(Vy=VR[VA]).visible&&(Vb=Vy._x)<VE&&Vb+Vy.width>Vi&&(VP=Vy._y)<Vm&&VP+Vy.height>Vq&&Vy.render(Va,VU,Vx)}else for(var VA=0;VA<VX;++VA)(Vy=VR[VA])._style.visible&&Vy.render(Va,VU,Vx)},Vn._canvas=function(Vn,Va,VU,Vx){var VD=Vn._$P.cacheCanvas;if(VD){"bitmap"===VD.type?Vw.canvasBitmap++:Vw.canvasNormal++;var Vp=VD.ctx;if(Vn._needRepaint()||!Vp)this._canvas_repaint(Vn,Va,VU,Vx);else{var VQ=VD._cacheRec;Va.drawCanvas(Vp.canvas,VU+VQ.x,Vx+VQ.y,VQ.width,VQ.height)}}else this._next._fun.call(this._next,Vn,Va,VU,Vx)},Vn._canvas_repaint=function(Vn,Va,VU,Vx){var VD=Vn._$P.cacheCanvas,Vp=this._next;if(VD){var VQ,VV,Vy,VR,VX=VD.ctx,Vz=Vn._needRepaint()||!VX,Vi=VD.type;if("bitmap"===Vi?Vw.canvasBitmap++:Vw.canvasNormal++,Vz){var Vq,VE;VD._cacheRec||(VD._cacheRec=new V_),VI.isWebGL&&"bitmap"!==Vi?VD._cacheRec.setTo(-Vn.pivotX,-Vn.pivotY,1,1):((VR=Vn.getSelfBounds()).x=VR.x-Vn.pivotX,VR.y=VR.y-Vn.pivotY,VR.x=VR.x-16,VR.y=VR.y-16,VR.width=VR.width+32,VR.height=VR.height+32,VR.x=Math.floor(VR.x+VU)-VU,VR.y=Math.floor(VR.y+Vx)-Vx,VR.width=Math.floor(VR.width),VR.height=Math.floor(VR.height),VD._cacheRec.copyFrom(VR)),VR=VD._cacheRec;var Vm,Vb=VI.isWebGL?1:Vf.pixelRatio*Vk.stage.clientScaleX,VP=VI.isWebGL?1:Vf.pixelRatio*Vk.stage.clientScaleY;if(!VI.isWebGL){var VA,VT=1,VK=1;for(VA=Vn;VA&&VA!=Vk.stage;)VT*=VA.scaleX,VK*=VA.scaleY,VA=VA.parent;VI.isWebGL?(VT<1&&(Vb*=VT),VK<1&&(VP*=VK)):(1<VT&&(Vb*=VT),1<VK&&(VP*=VK))}if(Vn.scrollRect){var VY=Vn.scrollRect;VR.x-=VY.x,VR.y-=VY.y}if(Vq=VR.width*Vb,VE=VR.height*VP,VV=VR.x,Vy=VR.y,VI.isWebGL&&"bitmap"===Vi&&(2048<Vq||2048<VE))return console.warn("cache bitmap size larger than 2048,cache ignored"),VD.ctx&&(VS.recover("RenderContext",VD.ctx),VD.ctx.canvas.size(0,0),VD.ctx=null),void Vp._fun.call(Vp,Vn,Va,VU,Vx);if(VX||(VX=VD.ctx=VS.getItem("RenderContext")||new Vv(Vq,VE,VTn.create("AUTO"))),VX.ctx.sprite=Vn,(VQ=VX.canvas).clear(),(VQ.width!=Vq||VQ.height!=VE)&&VQ.size(Vq,VE),"bitmap"===Vi?VQ.context.asBitmap=!0:"normal"===Vi&&(VQ.context.asBitmap=!1),1!=Vb||1!=VP){var VW=VX.ctx;VW.save(),VW.scale(Vb,VP),!VI.isConchWebGL&&VI.isConchApp&&(Vm=Vn._$P.cf)&&VW.setFilterMatrix&&VW.setFilterMatrix(Vm._mat,Vm._alpha),Vp._fun.call(Vp,Vn,VX,-VV,-Vy),VW.restore(),VI.isConchApp&&!VI.isConchWebGL||Vn._applyFilters()}else VW=VX.ctx,!VI.isConchWebGL&&VI.isConchApp&&(Vm=Vn._$P.cf)&&VW.setFilterMatrix&&VW.setFilterMatrix(Vm._mat,Vm._alpha),Vp._fun.call(Vp,Vn,VX,-VV,-Vy),VI.isConchApp&&!VI.isConchWebGL||Vn._applyFilters();Vn._$P.staticCache&&(VD.reCache=!1),Vw.canvasReCache++}else VV=(VR=VD._cacheRec).x,Vy=VR.y,VQ=VX.canvas;Va.drawCanvas(VQ,VU+VV,Vx+Vy,VR.width,VR.height)}else Vp._fun.call(Vp,Vn,VX,VU,Vx)},VQ.__init__=function(){var Vn,Va,VU=0;for(Va=Vu.createRenderSprite(69905,null),Vn=VQ.renders.length=4096,VU=0;VU<Vn;VU++)VQ.renders[VU]=Va;VQ.renders[0]=Vu.createRenderSprite(0,null),function(Vn,Va){for(var VU=0,Vx=0;Vx<Vn.length;Vx++)VU|=Vn[Vx],VQ.renders[VU]=Va}([1,512,4,2],new VQ(1,null)),VQ.renders[513]=Vu.createRenderSprite(513,null),VQ.renders[517]=new VQ(517,null)},VQ._initRenderFun=function(Vn,Va,VU,Vx){var VD=Vn._renderType;(VQ.renders[VD]=VQ._getTypeRender(VD))._fun(Vn,Va,VU,Vx)},VQ._getTypeRender=function(Vn){for(var Va=null,VU=2048;1<VU;)VU&Vn&&(Va=Vu.createRenderSprite(VU,Va)),VU>>=1;return Va},VQ.IMAGE=1,VQ.ALPHA=2,VQ.TRANSFORM=4,VQ.BLEND=8,VQ.CANVAS=16,VQ.FILTERS=32,VQ.MASK=64,VQ.CLIP=128,VQ.STYLE=256,VQ.GRAPHICS=512,VQ.CUSTOM=1024,VQ.CHILDS=2048,VQ.INIT=69905,VQ.renders=[],VQ.NORENDER=new VQ(0,null),VQ}(),Vj=function(){function VV(){this._repaint=!1}Vm(VV,"laya.resource.Context");var Vn=VV.prototype;return Vn.replaceReset=function(){var Vn,Va,VU=0;for(Vn=VV.replaceKeys.length,VU=0;VU<Vn;VU++)Va=VV.replaceKeys[VU],this[VV.newKeys[VU]]=this[Va]},Vn.replaceResotre=function(){this.__restore(),this.__reset()},Vn.setIsMainContext=function(){},Vn.drawTextures=function(Vn,Va,VU,Vx){Vw.drawCall+=Va.length/2;for(var VD=Vn.width,Vp=Vn.height,VQ=0,VV=Va.length;VQ<VV;VQ+=2)this.drawTexture(Vn,Va[VQ],Va[VQ+1],VD,Vp,VU,Vx)},Vn.drawCanvas=function(Vn,Va,VU,Vx,VD){Vw.drawCall++,this.drawImage(Vn.source,Va,VU,Vx,VD)},Vn.fillRect=function(Vn,Va,VU,Vx,VD){Vw.drawCall++,VD&&(this.fillStyle=VD),this.__fillRect(Vn,Va,VU,Vx)},Vn.fillText=function(Vn,Va,VU,Vx,VD,Vp){Vw.drawCall++,3<arguments.length&&null!=Vx&&(this.font=Vx,this.fillStyle=VD,this.textAlign=Vp,this.textBaseline="top"),this.__fillText(Vn,Va,VU)},Vn.fillBorderText=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){Vw.drawCall++,this.font=Vx,this.fillStyle=VD,this.textBaseline="top",this.strokeStyle=Vp,this.lineWidth=VQ,this.textAlign=VV,this.__strokeText(Vn,Va,VU),this.__fillText(Vn,Va,VU)},Vn.strokeText=function(Vn,Va,VU,Vx,VD,Vp,VQ){Vw.drawCall++,3<arguments.length&&null!=Vx&&(this.font=Vx,this.strokeStyle=VD,this.lineWidth=Vp,this.textAlign=VQ,this.textBaseline="top"),this.__strokeText(Vn,Va,VU)},Vn.transformByMatrix=function(Vn){this.transform(Vn.a,Vn.b,Vn.c,Vn.d,Vn.tx,Vn.ty)},Vn.setTransformByMatrix=function(Vn){this.setTransform(Vn.a,Vn.b,Vn.c,Vn.d,Vn.tx,Vn.ty)},Vn.clipRect=function(Vn,Va,VU,Vx){Vw.drawCall++,this.beginPath(),this.rect(Vn,Va,VU,Vx),this.clip()},Vn.drawTexture=function(Vn,Va,VU,Vx,VD,Vp,VQ){Vw.drawCall++;var VV=Vn.uv,Vy=Vn.bitmap.width,VR=Vn.bitmap.height;this.drawImage(Vn.source,VV[0]*Vy,VV[1]*VR,(VV[2]-VV[0])*Vy,(VV[5]-VV[3])*VR,Va+Vp,VU+VQ,Vx,VD)},Vn.drawTextureWithTransform=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){Vw.drawCall++;var VR=Vn.uv,VX=Vn.bitmap.width,Vz=Vn.bitmap.height;this.save(),1!=Vy&&(this.globalAlpha*=Vy),Vp?(this.transform(Vp.a,Vp.b,Vp.c,Vp.d,Vp.tx+VQ,Vp.ty+VV),this.drawImage(Vn.source,VR[0]*VX,VR[1]*Vz,(VR[2]-VR[0])*VX,(VR[5]-VR[3])*Vz,Va,VU,Vx,VD)):this.drawImage(Vn.source,VR[0]*VX,VR[1]*Vz,(VR[2]-VR[0])*VX,(VR[5]-VR[3])*Vz,Va+VQ,VU+VV,Vx,VD),this.restore()},Vn.drawTexture2=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){var Vy=VV[0];if(Vy.loaded&&Vy.bitmap&&Vy.source){Vw.drawCall++;var VR=1!==Vp;if(VR){var VX=this.globalAlpha;this.globalAlpha*=Vp}var Vz=Vy.uv,Vi=Vy.bitmap.width,Vq=Vy.bitmap.height;VD?(this.save(),this.transform(VD.a,VD.b,VD.c,VD.d,VD.tx+Vn,VD.ty+Va),this.drawImage(Vy.source,Vz[0]*Vi,Vz[1]*Vq,(Vz[2]-Vz[0])*Vi,(Vz[5]-Vz[3])*Vq,VV[1]-VU,VV[2]-Vx,VV[3],VV[4]),this.restore()):this.drawImage(Vy.source,Vz[0]*Vi,Vz[1]*Vq,(Vz[2]-Vz[0])*Vi,(Vz[5]-Vz[3])*Vq,VV[1]-VU+Vn,VV[2]-Vx+Va,VV[3],VV[4]),VR&&(this.globalAlpha=VX)}},Vn.fillTexture=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){if(!VV.pat){if(Vn.uv!=VXn.DEF_UV){var Vy=new VTn("2D");Vy.getContext("2d"),Vy.size(Vn.width,Vn.height),Vy.context.drawTexture(Vn,0,0,Vn.width,Vn.height,0,0),Vn=new VXn(Vy)}VV.pat=this.createPattern(Vn.bitmap.source,Vp)}var VR=Va,VX=VU,Vz=0,Vi=0;VQ&&(VR+=VQ.x%Vn.width,VX+=VQ.y%Vn.height,Vz-=VQ.x%Vn.width,Vi-=VQ.y%Vn.height),this.translate(VR,VX),this.fillRect(Vz,Vi,Vx,VD,VV.pat),this.translate(-VR,-VX)},Vn.drawTriangle=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){var Vy=Vn.bitmap,VR=Vy.source,VX=Vn.width,Vz=Vn.height,Vi=Vy.width,Vq=Vy.height,VE=VU[Vx]*Vi,Vm=VU[VD]*Vi,Vb=VU[Vp]*Vi,VP=VU[Vx+1]*Vq,VA=VU[VD+1]*Vq,VT=VU[Vp+1]*Vq,VK=Va[Vx],VY=Va[VD],VW=Va[Vp],Vk=Va[Vx+1],VN=Va[VD+1],V_=Va[Vp+1];if(VV){var V$=(VK+VY+VW)/3,VM=(Vk+VN+V_)/3,VZ=VK-V$,Vu=Vk-VM,Vc=Math.sqrt(VZ*VZ+Vu*Vu);VK=V$+VZ/Vc*(Vc+1),Vk=VM+Vu/Vc*(Vc+1),Vu=VN-VM,VY=V$+(VZ=VY-V$)/(Vc=Math.sqrt(VZ*VZ+Vu*Vu))*(Vc+1),VN=VM+Vu/Vc*(Vc+1),Vu=V_-VM,VW=V$+(VZ=VW-V$)/(Vc=Math.sqrt(VZ*VZ+Vu*Vu))*(Vc+1),V_=VM+Vu/Vc*(Vc+1)}this.save(),VQ&&this.transform(VQ.a,VQ.b,VQ.c,VQ.d,VQ.tx,VQ.ty),this.beginPath(),this.moveTo(VK,Vk),this.lineTo(VY,VN),this.lineTo(VW,V_),this.closePath(),this.clip();var VH=1/(VE*VA+VP*Vb+Vm*VT-VA*Vb-VP*Vm-VE*VT),VG=VK*VA+VP*VW+VY*VT-VA*VW-VP*VY-VK*VT,VI=VE*VY+VK*Vb+Vm*VW-VY*Vb-VK*Vm-VE*VW,Vv=VE*VA*VW+VP*VY*Vb+VK*Vm*VT-VK*VA*Vb-VP*Vm*VW-VE*VY*VT,Vl=Vk*VA+VP*V_+VN*VT-VA*V_-VP*VN-Vk*VT,Vj=VE*VN+Vk*Vb+Vm*V_-VN*Vb-Vk*Vm-VE*V_,Vh=VE*VA*V_+VP*VN*Vb+Vk*Vm*VT-Vk*VA*Vb-VP*Vm*V_-VE*VN*VT;this.transform(VG*VH,Vl*VH,VI*VH,Vj*VH,Vv*VH,Vh*VH),this.drawImage(VR,Vn.uv[0]*Vi,Vn.uv[1]*Vq,VX,Vz,Vn.uv[0]*Vi,Vn.uv[1]*Vq,VX,Vz),this.restore()},Vn.flush=function(){return 0},Vn.fillWords=function(Vn,Va,VU,Vx,VD,Vp){Vx&&(this.font=Vx),VD&&(this.fillStyle=VD);this.textBaseline="top",this.textAlign="left";for(var VQ=0,VV=Vn.length;VQ<VV;VQ++){var Vy=Vn[VQ];if(this.__fillText(Vy.char,Vy.x+Va,Vy.y+VU),1===Vp){var VR=Vy.height,VX=.5*Vy.style.letterSpacing;VX||(VX=0),this.beginPath(),this.strokeStyle=VD,this.lineWidth=1,this.moveTo(Va+Vy.x-VX+.5,VU+Vy.y+VR+.5),this.lineTo(Va+Vy.x+Vy.width+VX+.5,VU+Vy.y+VR+.5),this.stroke()}}},Vn.fillBorderWords=function(Vn,Va,VU,Vx,VD,Vp,VQ){Vx&&(this.font=Vx),VD&&(this.fillStyle=VD),this.textBaseline="top",this.lineWidth=VQ,this.textAlign="left",this.strokeStyle=Vp;for(var VV=0,Vy=Vn.length;VV<Vy;VV++){var VR=Vn[VV];this.__strokeText(VR.char,VR.x+Va,VR.y+VU),this.__fillText(VR.char,VR.x+Va,VR.y+VU)}},Vn.destroy=function(){this.canvas.width=this.canvas.height=0},Vn.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},Vn.drawCurves=function(Vn,Va,VU){this.beginPath(),this.strokeStyle=VU[3],this.lineWidth=VU[4];var Vx=VU[2];Vn+=VU[0],Va+=VU[1],this.moveTo(Vn+Vx[0],Va+Vx[1]);for(var VD=2,Vp=Vx.length;VD<Vp;)this.quadraticCurveTo(Vn+Vx[VD++],Va+Vx[VD++],Vn+Vx[VD++],Va+Vx[VD++]);this.stroke()},VV.__init__=function(Va){var VU=laya.resource.Context.prototype;if(!(Va=Va||CanvasRenderingContext2D.prototype).inited){Va.inited=!0,Va.__fillText=Va.fillText,Va.__fillRect=Va.fillRect,Va.__strokeText=Va.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(Vn){Va[Vn]=VU[Vn]})}},VV.replaceCanvasGetSet=function(Vn,Va){var VU=Object.getOwnPropertyDescriptor(Vn,Va);if(!VU||!VU.configurable)return!1;var Vx,VD={};for(Vx in VU)"set"!=Vx&&(VD[Vx]=VU[Vx]);var Vp=VU.set;return VD.set=function(Vn){Vp.call(this,Vn);var Va=this.getContext("2d");Va&&"__reset"in Va&&Va.__reset()},Object.defineProperty(Vn,Va,VD),!0},VV.replaceGetSet=function(Vn,Va){var VU=Object.getOwnPropertyDescriptor(Vn,Va);if(!VU||!VU.configurable)return!1;var Vx,VD={};for(Vx in VU)"set"!=Vx&&(VD[Vx]=VU[Vx]);var Vp=VU.set,VQ="___"+Va+"__";return VV.newKeys.push(VQ),VD.set=function(Vn){Vn!=this[VQ]&&(this[VQ]=Vn,Vp.call(this,Vn))},Object.defineProperty(Vn,Va,VD),!0},VV._default=new VV,VV.newKeys=[],Vy(VV,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),VV}(),Vh=function(){function Vp(Vn){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++Vp._uniqueIDCounter,this._name=Vn||"Content Manager",Vp._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,Vp._resourceManagers.push(this),this._resources=[],this._records={}}Vm(Vp,"laya.resource.ResourceManager");var Vn=Vp.prototype;return Vk.imps(Vn,{"laya.resource.IDispose":!0}),Vn.getResourceByIndex=function(Vn){return this._resources[Vn]},Vn.getResourcesLength=function(){return this._resources.length},Vn.addResource=function(Vn){return Vn.resourceManager&&Vn.resourceManager.removeResource(Vn),-1===this._resources.indexOf(Vn)&&((Vn._resourceManager=this)._resources.push(Vn),this.addRecord(Vn.uri,Vn.__className,Vn.memorySize),this.addSize(Vn.memorySize),!0)},Vn.removeResource=function(Vn){var Va=this._resources.indexOf(Vn);return-1!==Va&&(this._resources.splice(Va,1),Vn._resourceManager=null,this._memorySize-=Vn.memorySize,this.addRecord(Vn.uri,Vn.__className,-Vn.memorySize),!0)},Vn.unload=function(){for(var Vn=this._resources.slice(0,this._resources.length),Va=0;Va<Vn.length;Va++){Vn[Va].destroy()}Vn.length=0},Vn.dispose=function(){if(this===Vp._systemResourceManager)throw new Error("systemResourceManager不能被释放！");Vp._resourceManagers.splice(Vp._resourceManagers.indexOf(this),1),Vp._isResourceManagersSorted=!1;for(var Vn=this._resources.slice(0,this._resources.length),Va=0;Va<Vn.length;Va++){var VU=Vn[Va];VU.resourceManager.removeResource(VU),VU.destroy()}Vn.length=0},Vn.addSize=function(Vn){Vn&&(this.autoRelease&&0<Vn&&this._memorySize+Vn>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=Vn)},Vn.addRecord=function(Vn,Va,VU){DEBUG&&VU&&!Vn&&console.error(Vn,Va,VU)},Vn.garbageCollection=function(Vn){var Va=this._resources;(Va=Va.slice()).sort(function(Vn,Va){if(!Vn||!Va)throw new Error("a或b不能为空！");return Vn.released&&Va.released?0:Vn.released?1:Va.released?-1:Vn._lastUseFrameCount-Va._lastUseFrameCount});for(var VU=Vw.loopCount,Vx=0,VD=Va.length;Vx<VD;Vx++){var Vp=Va[Vx];if(!(1<VU-Vp._lastUseFrameCount))return void(this._memorySize>=Vn&&(this._isOverflow=!0));if(Vp.releaseResource(),this._memorySize<Vn)return void(this._isOverflow=!1)}},VX(0,Vn,"id",function(){return this._id}),VX(0,Vn,"name",function(){return this._name},function(Vn){!Vn&&""===Vn||this._name===Vn||(this._name=Vn,Vp._isResourceManagersSorted=!1)}),VX(0,Vn,"memorySize",function(){return this._memorySize}),VX(0,Vn,"records",function(){return this._records}),VX(1,Vp,"systemResourceManager",function(){return Vp._systemResourceManager}),Vp.__init__=function(){Vp.currentResourceManager=Vp.systemResourceManager},Vp.getLoadedResourceManagerByIndex=function(Vn){return Vp._resourceManagers[Vn]},Vp.getLoadedResourceManagersCount=function(){return Vp._resourceManagers.length},Vp.recreateContentManagers=function(Vn){void 0===Vn&&(Vn=!1);for(var Va=Vp.currentResourceManager,VU=0;VU<Vp._resourceManagers.length;VU++){Vp.currentResourceManager=Vp._resourceManagers[VU];for(var Vx=0;Vx<Vp.currentResourceManager._resources.length;Vx++)Vp.currentResourceManager._resources[Vx].releaseResource(Vn),Vp.currentResourceManager._resources[Vx].activeResource(Vn)}Vp.currentResourceManager=Va},Vp.releaseContentManagers=function(Vn){void 0===Vn&&(Vn=!1);for(var Va=Vp.currentResourceManager,VU=0;VU<Vp._resourceManagers.length;VU++){Vp.currentResourceManager=Vp._resourceManagers[VU];for(var Vx=0;Vx<Vp.currentResourceManager._resources.length;Vx++){var VD=Vp.currentResourceManager._resources[Vx];!VD.released&&VD.releaseResource(Vn)}}Vp.currentResourceManager=Va},Vp._uniqueIDCounter=0,Vp._isResourceManagersSorted=!1,Vp._resourceManagers=[],Vy(Vp,["_systemResourceManager",function(){return this._systemResourceManager=new Vp("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=Vp._systemResourceManager}]),Vp}(),Vf=(function(){function Vn(){}Vm(Vn,"laya.system.System"),Vn.changeDefinition=function(Vn,Va){Vk[Vn]=Va;var VU=Vn+"=classObj";Vk._runScript(VU)},Vn.__init__=function(){VI.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function VU(){}return Vm(VU,"laya.utils.Browser"),VX(1,VU,"pixelRatio",function(){return VU.__init__(),-1<VU.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:Vu.getPixelRatio()}),VX(1,VU,"height",function(){return VU.__init__(),(Vk.stage&&Vk.stage.canvasRotation?VU.clientWidth:VU.clientHeight)*VU.pixelRatio}),VX(1,VU,"clientWidth",function(){return VU.__init__(),VU.window.innerWidth||VU.document.body.clientWidth}),VX(1,VU,"window",function(){return VU.__init__(),VU._window}),VX(1,VU,"clientHeight",function(){return VU.__init__(),VU.window.innerHeight||VU.document.body.clientHeight||VU.document.documentElement.clientHeight}),VX(1,VU,"width",function(){return VU.__init__(),(Vk.stage&&Vk.stage.canvasRotation?VU.clientHeight:VU.clientWidth)*VU.pixelRatio}),VX(1,VU,"container",function(){return VU.__init__(),VU._container||((VU._container=VU.createElement("div")).id="layaContainer",VU.document.body.appendChild(VU._container)),VU._container},function(Vn){VU._container=Vn}),VX(1,VU,"document",function(){return VU.__init__(),VU._document}),VU.__init__=function(){if(!VU._window){VU._window=Vu.getWindow(),VU._document=VU.window.document,VU._window.addEventListener("message",function(Vn){laya.utils.Browser._onMessage(Vn)},!1),VU.document.__createElement=VU.document.createElement,VQ.requestAnimationFrame=VQ.requestAnimationFrame||VQ.webkitRequestAnimationFrame||VQ.mozRequestAnimationFrame||VQ.oRequestAnimationFrame||VQ.msRequestAnimationFrame||function(Vn){return VQ.setTimeout(Vn,1e3/60)};var Vn=VQ.document.body.style;Vn["-webkit-user-select"]="none",Vn["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",VU.userAgent=VU.window.navigator.userAgent,VU.onIOS=!!(VU.u=VU.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),VU.onMobile=-1<VU.u.indexOf("Mobile"),VU.onIPhone=-1<VU.u.indexOf("iPhone"),VU.onMac=-1<VU.u.indexOf("Mac OS X"),VU.onIPad=-1<VU.u.indexOf("iPad"),VU.onAndroid=-1<VU.u.indexOf("Android")||-1<VU.u.indexOf("Adr"),VU.onWP=-1<VU.u.indexOf("Windows Phone"),VU.onQQBrowser=-1<VU.u.indexOf("QQBrowser"),VU.onMQQBrowser=-1<VU.u.indexOf("MQQBrowser")||-1<VU.u.indexOf("Mobile")&&-1<VU.u.indexOf("QQ"),VU.onIE=!!VU.window.ActiveXObject||"ActiveXObject"in VU.window,VU.onWeiXin=-1<VU.u.indexOf("MicroMessenger"),VU.onPC=!VU.onMobile,VU.onSafari=-1<VU.u.indexOf("Safari"),VU.onFirefox=-1<VU.u.indexOf("Firefox"),VU.onEdge=-1<VU.u.indexOf("Edge"),VU.onMiniGame=-1<VU.u.indexOf("MiniGame"),VU.onLimixiu=-1<VU.u.indexOf("limixiu"),VU.httpProtocol="http:"==VU.window.location.protocol,VU.onMiniGame&&null==VU.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),VU.webAudioEnabled=!!(VU.window.AudioContext||VU.window.webkitAudioContext||VU.window.mozAudioContext),VU.soundType=VU.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",VDn=VU.webAudioEnabled?Vpn:VUn,VU.webAudioEnabled&&Vpn.initWebAudio(),VUn._initMusicAudio(),VU.enableTouch="ontouchstart"in VQ||VQ.DocumentTouch&&Va instanceof DocumentTouch,VQ.focus(),VZ._soundClass=VDn,VZ._musicClass=VUn,VI._mainCanvas=VI._mainCanvas||VTn.create("2D"),VU.canvas||(VU.canvas=VTn.create("2D"),VU.context=VU.canvas.getContext("2d"))}},VU._onMessage=function(Vn){if(Vn.data&&"size"==Vn.data.name){if(VU.window.innerWidth=Vn.data.width,VU.window.innerHeight=Vn.data.height,VU.window.__innerHeight=Vn.data.clientHeight,!VU.document.createEvent)return void console.warn("no document.createEvent");var Va=VU.document.createEvent("HTMLEvents");return Va.initEvent("resize",!1,!1),void VU.window.dispatchEvent(Va)}},VU.createElement=function(Vn){return VU.__init__(),VU.document.__createElement(Vn)},VU.getElementById=function(Vn){return VU.__init__(),VU.document.getElementById(Vn)},VU.removeElement=function(Vn){Vn&&Vn.parentNode&&Vn.parentNode.removeChild(Vn)},VU.now=function(){return Vu.now()},VU._window=null,VU._document=null,VU._container=null,VU.userAgent=null,VU.u=null,VU.onIOS=!1,VU.onMac=!1,VU.onMobile=!1,VU.onIPhone=!1,VU.onIPad=!1,VU.onAndroid=!1,VU.onWP=!1,VU.onQQBrowser=!1,VU.onMQQBrowser=!1,VU.onSafari=!1,VU.onFirefox=!1,VU.onEdge=!1,VU.onIE=!1,VU.onWeiXin=!1,VU.onMiniGame=!1,VU.onLimixiu=!1,VU.onPC=!1,VU.httpProtocol=!1,VU.webAudioEnabled=!1,VU.soundType=null,VU.enableTouch=!1,VU.canvas=null,VU.context=null,VU.__init$=function(){},VU}()),VF=function(){function Va(Vn){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,Vn?(this._u8d_=new Uint8Array(Vn),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}Vm(Va,"laya.utils.Byte");var Vn=Va.prototype;return Vn.___resizeBuffer=function(Va){try{var Vn=new Uint8Array(Va);null!=this._u8d_&&(this._u8d_.length<=Va?Vn.set(this._u8d_):Vn.set(this._u8d_.subarray(0,Va))),this._u8d_=Vn,this._d_=new DataView(Vn.buffer)}catch(Vn){throw"___resizeBuffer err:"+Va}},Vn.getString=function(){return this.rUTF(this.getUint16())},Vn.getFloat32Array=function(Vn,Va){var VU=Vn+Va;VU=VU>this._length?this._length:VU;var Vx=new Float32Array(this._d_.buffer.slice(Vn,VU));return this._pos_=VU,Vx},Vn.getUint8Array=function(Vn,Va){var VU=Vn+Va;VU=VU>this._length?this._length:VU;var Vx=new Uint8Array(this._d_.buffer.slice(Vn,VU));return this._pos_=VU,Vx},Vn.getInt16Array=function(Vn,Va){var VU=Vn+Va;VU=VU>this._length?this._length:VU;var Vx=new Int16Array(this._d_.buffer.slice(Vn,VU));return this._pos_=VU,Vx},Vn.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var Vn=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,Vn},Vn.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var Vn=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,Vn},Vn.writeFloat32=function(Vn){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,Vn,this._xd_),this._pos_+=4},Vn.writeFloat64=function(Vn){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,Vn,this._xd_),this._pos_+=8},Vn.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var Vn=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,Vn},Vn.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var Vn=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,Vn},Vn.writeInt32=function(Vn){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,Vn,this._xd_),this._pos_+=4},Vn.writeUint32=function(Vn){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,Vn,this._xd_),this._pos_+=4},Vn.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var Vn=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,Vn},Vn.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var Vn=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,Vn},Vn.writeUint16=function(Vn){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,Vn,this._xd_),this._pos_+=2},Vn.writeInt16=function(Vn){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,Vn,this._xd_),this._pos_+=2},Vn.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},Vn.writeUint8=function(Vn){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,Vn),this._pos_++},Vn._getUInt8=function(Vn){return this._d_.getUint8(Vn)},Vn._getUint16=function(Vn){return this._d_.getUint16(Vn,this._xd_)},Vn._getMatrix=function(){return new Vc(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},Vn.rUTF=function(Vn){for(var Va=[],VU=this._pos_+Vn,Vx=0,VD=0,Vp=0,VQ=String.fromCharCode,VV=this._u8d_;this._pos_<VU;)(Vx=VV[this._pos_++])<128?0!=Vx&&Va.push(VQ(Vx)):Vx<224?Va.push(VQ((63&Vx)<<6|127&VV[this._pos_++])):Vx<240?(VD=VV[this._pos_++],Va.push(VQ((31&Vx)<<12|(127&VD)<<6|127&VV[this._pos_++]))):(VD=VV[this._pos_++],Vp=VV[this._pos_++],Va.push(VQ((15&Vx)<<18|(127&VD)<<12|Vp<<6&127|127&VV[this._pos_++]))),0;return Va.join("")},Vn.getCustomString=function(Vn){for(var Va=[],VU=0,Vx=0,VD=0,Vp=String.fromCharCode,VQ=this._u8d_;0<Vn;)if((Vx=VQ[this._pos_])<128)Va.push(Vp(Vx)),this._pos_++,Vn--;else for(VU=Vx-128,this._pos_++,Vn-=VU;0<VU;)Vx=VQ[this._pos_++],VD=VQ[this._pos_++],Va.push(Vp(VD<<8|Vx)),VU--;return Va.join("")},Vn.clear=function(){this._pos_=0,this.length=0},Vn.__getBuffer=function(){return this._d_.buffer},Vn.writeUTFBytes=function(Vn){for(var Va=0,VU=(Vn+="").length;Va<VU;Va++){var Vx=Vn.charCodeAt(Va);Vx<=127?this.writeByte(Vx):Vx<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|Vx>>6,128|63&Vx],this._pos_),this._pos_+=2):Vx<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|Vx>>12,128|Vx>>6&63,128|63&Vx],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|Vx>>18,128|Vx>>12&63,128|Vx>>6&63,128|63&Vx],this._pos_),this._pos_+=4)}},Vn.writeUTFString=function(Vn){var Va=this.pos;this.writeUint16(1),this.writeUTFBytes(Vn);var VU=this.pos-Va-2;if(65536<=VU)throw"writeUTFString byte len more than 65536";this._d_.setUint16(Va,VU,this._xd_)},Vn.readUTFString=function(){return this.readUTFBytes(this.getUint16())},Vn.getUTFString=function(){return this.readUTFString()},Vn.readUTFBytes=function(Vn){if(void 0===Vn&&(Vn=-1),0==Vn)return"";var Va=this.bytesAvailable;if(Va<Vn)throw"readUTFBytes error - Out of bounds";return Vn=0<Vn?Vn:Va,this.rUTF(Vn)},Vn.getUTFBytes=function(Vn){return void 0===Vn&&(Vn=-1),this.readUTFBytes(Vn)},Vn.writeByte=function(Vn){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,Vn),this._pos_+=1},Vn.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},Vn.getByte=function(){return this.readByte()},Vn.ensureWrite=function(Vn){this._length<Vn&&(this._length=Vn),this._allocated_<Vn&&(this.length=Vn)},Vn.writeArrayBuffer=function(Vn,Va,VU){if(void 0===Va&&(Va=0),void 0===VU&&(VU=0),Va<0||VU<0)throw"writeArrayBuffer error - Out of bounds";0==VU&&(VU=Vn.byteLength-Va),this.ensureWrite(this._pos_+VU);var Vx=new Uint8Array(Vn);this._u8d_.set(Vx.subarray(Va,Va+VU),this._pos_),this._pos_+=VU},VX(0,Vn,"buffer",function(){var Vn=this._d_.buffer;return Vn.byteLength==this.length?Vn:Vn.slice(0,this.length)}),VX(0,Vn,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(Vn){this._xd_="littleEndian"==Vn}),VX(0,Vn,"length",function(){return this._length},function(Vn){this._allocated_<Vn?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(Vn,2*this._allocated_))):this._allocated_>Vn&&this.___resizeBuffer(this._allocated_=Vn),this._length=Vn}),VX(0,Vn,"pos",function(){return this._pos_},function(Vn){this._pos_=Vn}),VX(0,Vn,"bytesAvailable",function(){return this._length-this._pos_}),Va.getSystemEndian=function(){if(!Va._sysEndian){var Vn=new ArrayBuffer(2);new DataView(Vn).setInt16(0,256,!0),Va._sysEndian=256===new Int16Array(Vn)[0]?"littleEndian":"bigEndian"}return Va._sysEndian},Va.BIG_ENDIAN="bigEndian",Va.LITTLE_ENDIAN="littleEndian",Va._sysEndian=null,Va}(),Vg=function(){function VD(){}return Vm(VD,"laya.utils.CacheManager"),VD.regCacheByFunction=function(Vn,Va){var VU;VD.unRegCacheByFunction(Vn,Va),VU={tryDispose:Vn,getCacheList:Va},VD._cacheList.push(VU)},VD.unRegCacheByFunction=function(Vn,Va){var VU,Vx=0;for(VU=VD._cacheList.length,Vx=0;Vx<VU;Vx++)if(VD._cacheList[Vx].tryDispose==Vn&&VD._cacheList[Vx].getCacheList==Va)return void VD._cacheList.splice(Vx,1)},VD.forceDispose=function(){var Vn=0,Va=VD._cacheList.length;for(Vn=0;Vn<Va;Vn++)VD._cacheList[Vn].tryDispose(!0)},VD.beginCheck=function(Vn){void 0===Vn&&(Vn=15e3),Vk.timer.loop(Vn,null,VD._checkLoop)},VD.stopCheck=function(){Vk.timer.clear(null,VD._checkLoop)},VD._checkLoop=function(){var Vn=VD._cacheList;if(!(Vn.length<1)){var Va,VU=Vf.now(),Vx=0;for(Va=Vx=Vn.length;0<Vx&&(Vn[VD._index=++VD._index%Va].tryDispose(!1),!(Vf.now()-VU>VD.loopTimeLimit));)Vx--}},VD.loopTimeLimit=2,VD._cacheList=[],VD._index=0,VD}(),Vo=function(){function Vq(){}return Vm(Vq,"laya.utils.ClassUtils"),Vq.regClass=function(Vn,Va){Vq._classMap[Vn]=Va},Vq.getRegClass=function(Vn){return Vq._classMap[Vn]},Vq.getInstance=function(Vn){var Va=Vq.getClass(Vn);return Va?new Va:(console.warn("[error] Undefined class:",Vn),null)},Vq.createByJson=function(Vn,Va,VU,Vx,VD){"string"==typeof Vn&&(Vn=JSON.parse(Vn));var Vp=Vn.props;if(!Va&&!(Va=VD?VD.runWith(Vn):Vq.getInstance(Vp.runtime||Vn.type)))return null;var VQ=Vn.child;if(VQ)for(var VV=0,Vy=VQ.length;VV<Vy;VV++){var VR=VQ[VV];if("render"!==VR.props.name&&"render"!==VR.props.renderType||!Va._$set_itemRender)if("Graphic"==VR.type)Vq.addGraphicsToSprite(VR,Va);else if(Vq.isDrawType(VR.type))Vq.addGraphicToSprite(VR,Va,!0);else{var VX=Vq.createByJson(VR,null,VU,Vx,VD);"Script"==VR.type?VX.hasOwnProperty("owner")?VX.owner=Va:VX.hasOwnProperty("target")&&(VX.target=Va):"mask"==VR.props.renderType?Va.mask=VX:Va.addChild(VX)}else Va.itemRender=VR}if(Vp)for(var Vz in Vp){var Vi=Vp[Vz];"var"===Vz&&VU?VU[Vi]=Va:Vi instanceof Array&&"function"==typeof Va[Vz]?Va[Vz].apply(Va,Vi):Va[Vz]=Vi}return Vx&&Vn.customProps&&Vx.runWith([Va,Vn]),Va.created&&Va.created(),Va},Vq.addGraphicsToSprite=function(Vn,Va){var VU;if((VU=Vn.child)&&!(VU.length<1)){var Vx;Vx=Vq._getGraphicsFromSprite(Vn,Va);var VD=0,Vp=0;Vn.props&&(VD=Vq._getObjVar(Vn.props,"x",0),Vp=Vq._getObjVar(Vn.props,"y",0)),0!=VD&&0!=Vp&&Vx.translate(VD,Vp);var VQ,VV=0;for(VQ=VU.length,VV=0;VV<VQ;VV++)Vq._addGraphicToGraphics(VU[VV],Vx);0!=VD&&0!=Vp&&Vx.translate(-VD,-Vp)}},Vq.addGraphicToSprite=function(Vn,Va,VU){var Vx;void 0===VU&&(VU=!1),Vx=VU?Vq._getGraphicsFromSprite(Vn,Va):Va.graphics,Vq._addGraphicToGraphics(Vn,Vx)},Vq._getGraphicsFromSprite=function(Vn,Va){var VU,Vx;if(!Vn||!Vn.props)return Va.graphics;switch(Vx=Vn.props.renderType){case"hit":case"unHit":var VD;Va.hitArea||(Va.hitArea=new Vd),(VD=Va.hitArea)[Vx]||(VD[Vx]=new Vi),VU=VD[Vx]}return VU||(VU=Va.graphics),VU},Vq._getTransformData=function(Vn){var Va;(Vn.hasOwnProperty("pivotX")||Vn.hasOwnProperty("pivotY"))&&(Va=Va||new Vc).translate(-Vq._getObjVar(Vn,"pivotX",0),-Vq._getObjVar(Vn,"pivotY",0));var VU=Vq._getObjVar(Vn,"scaleX",1),Vx=Vq._getObjVar(Vn,"scaleY",1),VD=Vq._getObjVar(Vn,"rotation",0);Vq._getObjVar(Vn,"skewX",0),Vq._getObjVar(Vn,"skewY",0);return 1==VU&&1==Vx&&0==VD||((Va=Va||new Vc).scale(VU,Vx),Va.rotate(.0174532922222222*VD)),Va},Vq._addGraphicToGraphics=function(Vn,Va){var VU,Vx;if((VU=Vn.props)&&(Vx=Vq.DrawTypeDic[Vn.type])){var VD,Vp;VD=Va;var VQ=Vq._getParams(VU,Vx[1],Vx[2],Vx[3]);((Vp=Vq._tM)||1!=Vq._alpha)&&(VD.save(),Vp&&VD.transform(Vp),1!=Vq._alpha&&VD.alpha(Vq._alpha)),VD[Vx[0]].apply(VD,VQ),(Vp||1!=Vq._alpha)&&VD.restore()}},Vq._adptLineData=function(Vn){return Vn[2]=parseFloat(Vn[0])+parseFloat(Vn[2]),Vn[3]=parseFloat(Vn[1])+parseFloat(Vn[3]),Vn},Vq._adptTextureData=function(Vn){return Vn[0]=VVn.getRes(Vn[0]),Vn},Vq._adptLinesData=function(Vn){return Vn[2]=Vq._getPointListByStr(Vn[2]),Vn},Vq.isDrawType=function(Vn){return"Image"!=Vn&&Vq.DrawTypeDic.hasOwnProperty(Vn)},Vq._getParams=function(Vn,Va,VU,Vx){var VD;void 0===VU&&(VU=0),(VD=Vq._temParam).length=Va.length;var Vp,VQ,VV=0;for(Vp=Va.length,VV=0;VV<Vp;VV++)VD[VV]=Vq._getObjVar(Vn,Va[VV][0],Va[VV][1]);return Vq._alpha=Vq._getObjVar(Vn,"alpha",1),VQ=Vq._getTransformData(Vn),Vq._tM=VQ?(VU||(VU=0),VQ.translate(VD[VU],VD[VU+1]),VD[VU]=VD[VU+1]=0,VQ):null,Vx&&Vq[Vx]&&(VD=Vq[Vx](VD)),VD},Vq._getPointListByStr=function(Vn){var Va,VU,Vx=0;for(VU=(Va=Vn.split(",")).length,Vx=0;Vx<VU;Vx++)Va[Vx]=parseFloat(Va[Vx]);return Va},Vq._getObjVar=function(Vn,Va,VU){return Vn.hasOwnProperty(Va)?Vn[Va]:VU},Vq._temParam=[],Vq._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},Vq.getClass=function(Vn){var Va=Vq._classMap[Vn]||Vn;return"string"==typeof Va?Vk.__classmap[Va]:Va},Vq._tM=null,Vq._alpha=NaN,Vy(Vq,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),Vq}(),VB=function(){function Vp(Vn){if(this._color=[],"string"==typeof Vn){null===(this.strColor=Vn)&&(Vn="#000000"),"#"==Vn.charAt(0)&&(Vn=Vn.substr(1));var Va=Vn.length;if(3==Va||4==Va){for(var VU="",Vx=0;Vx<Va;Vx++)VU+=Vn[Vx]+Vn[Vx];Vn=VU}var VD=this.numColor=parseInt(Vn,16);if(8==Vn.length)return void(this._color=[parseInt(Vn.substr(0,2),16)/255,((16711680&VD)>>16)/255,((65280&VD)>>8)/255,(255&VD)/255])}else VD=this.numColor=Vn,this.strColor=Vt.toHexColor(VD);this._color=[((16711680&VD)>>16)/255,((65280&VD)>>8)/255,(255&VD)/255,1],this._color.__id=++Vp._COLODID}return Vm(Vp,"laya.utils.Color"),Vp._initDefault=function(){for(var Vn in Vp._DEFAULT={},Vp._COLOR_MAP)Vp._SAVE[Vn]=Vp._DEFAULT[Vn]=new Vp(Vp._COLOR_MAP[Vn]);return Vp._DEFAULT},Vp._initSaveMap=function(){for(var Vn in Vp._SAVE_SIZE=0,Vp._SAVE={},Vp._DEFAULT)Vp._SAVE[Vn]=Vp._DEFAULT[Vn]},Vp.create=function(Vn){var Va=Vp._SAVE[Vn+""];return null!=Va?Va:(Vp._SAVE_SIZE<1e3||Vp._initSaveMap(),Vp._SAVE[Vn+""]=new Vp(Vn))},Vp._SAVE={},Vp._SAVE_SIZE=0,Vp._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},Vp._DEFAULT=Vp._initDefault(),Vp._COLODID=1,Vp}(),VO=(function(){function Vn(){this._values=[],this._keys=[]}Vm(Vn,"laya.utils.Dictionary");var Va=Vn.prototype;Va.set=function(Vn,Va){var VU=this.indexOf(Vn);0<=VU?this._values[VU]=Va:(this._keys.push(Vn),this._values.push(Va))},Va.indexOf=function(Vn){var Va=this._keys.indexOf(Vn);return 0<=Va?Va:(Vn="string"==typeof Vn?Number(Vn):"number"==typeof Vn?Vn.toString():Vn,this._keys.indexOf(Vn))},Va.get=function(Vn){var Va=this.indexOf(Vn);return Va<0?null:this._values[Va]},Va.remove=function(Vn){var Va=this.indexOf(Vn);return 0<=Va&&(this._keys.splice(Va,1),this._values.splice(Va,1),!0)},Va.clear=function(){this._values.length=0,this._keys.length=0},VX(0,Va,"values",function(){return this._values}),VX(0,Va,"keys",function(){return this._keys})}(),function(){function Vn(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}Vm(Vn,"laya.utils.Dragging");var Va=Vn.prototype;return Va.start=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){void 0===VV&&(VV=.92),this.clearTimer(),this.target=Vn,this.area=Va,this.hasInertia=VU,this.elasticDistance=Va?Vx:0,this.elasticBackTime=VD,this.data=Vp,this._disableMouseEvent=VQ,this.ratio=VV,1!=Vn.globalScaleX||1!=Vn.globalScaleY?this._parent=Vn.parent:this._parent=Vk.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,Vk.stage.on("mouseup",this,this.onStageMouseUp),Vk.stage.on("mouseout",this,this.onStageMouseUp),Vk.timer.frameLoop(1,this,this.loop)},Va.clearTimer=function(){Vk.timer.clear(this,this.loop),Vk.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},Va.stop=function(){this._dragging&&(VE.instance.disableMouseEvent=!1,Vk.stage.off("mouseup",this,this.onStageMouseUp),Vk.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},Va.loop=function(){var Vn=this._parent.getMousePoint(),Va=Vn.x,VU=Vn.y,Vx=Va-this._lastX,VD=VU-this._lastY;if(this._clickOnly){if(!(1<Math.abs(Vx*Vk.stage._canvasTransform.getScaleX())||1<Math.abs(VD*Vk.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),VE.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(Vx,VD);0==Vx&&0==VD||(this._lastX=Va,this._lastY=VU,this.target.x+=Vx*this._elasticRateX,this.target.y+=VD*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},Va.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var Vn=this.area.x-this.target.x;else Vn=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-Vn/this.elasticDistance),this.target.y<this.area.y)var Va=this.area.y-this.target.y;else Va=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-Va/this.elasticDistance)}},Va.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},Va.onStageMouseUp=function(Vn){if(VE.instance.disableMouseEvent=!1,Vk.stage.off("mouseup",this,this.onStageMouseUp),Vk.stage.off("mouseout",this,this.onStageMouseUp),Vk.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var Va=this._offsets.length,VU=Math.min(Va,6),Vx=this._offsets.length-VU,VD=Va-1;Vx<VD;VD--)this._offsetY+=this._offsets[VD--],this._offsetX+=this._offsets[VD];this._offsetX=this._offsetX/VU*2,this._offsetY=this._offsetY/VU*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),Vk.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},Va.checkElastic=function(){var Vn=NaN,Va=NaN;if(this.target.x<this.area.x?Vn=this.area.x:this.target.x>this.area.x+this.area.width&&(Vn=this.area.x+this.area.width),this.target.y<this.area.y?Va=this.area.y:this.target.y>this.area.y+this.area.height&&(Va=this.area.y+this.area.height),isNaN(Vn)&&isNaN(Va))this.clear();else{var VU={};isNaN(Vn)||(VU.x=Vn),isNaN(Va)||(VU.y=Va),this._tween=VC.to(this.target,VU,this.elasticBackTime,VL.sineOut,VA.create(this,this.clear),0,!1,!1)}},Va.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(Vk.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},Va.clear=function(){if(this.target){this.clearTimer();var Vn=this.target;this.target=null,this._parent=null,Vn.event("dragend",this.data)}},Vn}()),VL=function(){function VV(){}return Vm(VV,"laya.utils.Ease"),VV.linearNone=function(Vn,Va,VU,Vx){return VU*Vn/Vx+Va},VV.linearIn=function(Vn,Va,VU,Vx){return VU*Vn/Vx+Va},VV.linearInOut=function(Vn,Va,VU,Vx){return VU*Vn/Vx+Va},VV.linearOut=function(Vn,Va,VU,Vx){return VU*Vn/Vx+Va},VV.bounceIn=function(Vn,Va,VU,Vx){return VU-VV.bounceOut(Vx-Vn,0,VU,Vx)+Va},VV.bounceInOut=function(Vn,Va,VU,Vx){return Vn<.5*Vx?.5*VV.bounceIn(2*Vn,0,VU,Vx)+Va:.5*VV.bounceOut(2*Vn-Vx,0,VU,Vx)+.5*VU+Va},VV.bounceOut=function(Vn,Va,VU,Vx){return(Vn/=Vx)<1/2.75?VU*(7.5625*Vn*Vn)+Va:Vn<2/2.75?VU*(7.5625*(Vn-=1.5/2.75)*Vn+.75)+Va:Vn<2.5/2.75?VU*(7.5625*(Vn-=2.25/2.75)*Vn+.9375)+Va:VU*(7.5625*(Vn-=2.625/2.75)*Vn+.984375)+Va},VV.backIn=function(Vn,Va,VU,Vx,VD){return void 0===VD&&(VD=1.70158),VU*(Vn/=Vx)*Vn*((VD+1)*Vn-VD)+Va},VV.backInOut=function(Vn,Va,VU,Vx,VD){return void 0===VD&&(VD=1.70158),(Vn/=.5*Vx)<1?.5*VU*(Vn*Vn*((1+(VD*=1.525))*Vn-VD))+Va:VU/2*((Vn-=2)*Vn*((1+(VD*=1.525))*Vn+VD)+2)+Va},VV.backOut=function(Vn,Va,VU,Vx,VD){return void 0===VD&&(VD=1.70158),VU*((Vn=Vn/Vx-1)*Vn*((VD+1)*Vn+VD)+1)+Va},VV.elasticIn=function(Vn,Va,VU,Vx,VD,Vp){var VQ;return void 0===VD&&(VD=0),void 0===Vp&&(Vp=0),0==Vn?Va:1==(Vn/=Vx)?Va+VU:(Vp||(Vp=.3*Vx),VQ=!VD||0<VU&&VD<VU||VU<0&&VD<-VU?(VD=VU,Vp/4):Vp/VV.PI2*Math.asin(VU/VD),-VD*Math.pow(2,10*(Vn-=1))*Math.sin((Vn*Vx-VQ)*VV.PI2/Vp)+Va)},VV.elasticInOut=function(Vn,Va,VU,Vx,VD,Vp){var VQ;return void 0===VD&&(VD=0),void 0===Vp&&(Vp=0),0==Vn?Va:2==(Vn/=.5*Vx)?Va+VU:(Vp||(Vp=Vx*(.3*1.5)),VQ=!VD||0<VU&&VD<VU||VU<0&&VD<-VU?(VD=VU,Vp/4):Vp/VV.PI2*Math.asin(VU/VD),Vn<1?VD*Math.pow(2,10*(Vn-=1))*Math.sin((Vn*Vx-VQ)*VV.PI2/Vp)*-.5+Va:VD*Math.pow(2,-10*(Vn-=1))*Math.sin((Vn*Vx-VQ)*VV.PI2/Vp)*.5+VU+Va)},VV.elasticOut=function(Vn,Va,VU,Vx,VD,Vp){var VQ;return void 0===VD&&(VD=0),void 0===Vp&&(Vp=0),0==Vn?Va:1==(Vn/=Vx)?Va+VU:(Vp||(Vp=.3*Vx),VQ=!VD||0<VU&&VD<VU||VU<0&&VD<-VU?(VD=VU,Vp/4):Vp/VV.PI2*Math.asin(VU/VD),VD*Math.pow(2,-10*Vn)*Math.sin((Vn*Vx-VQ)*VV.PI2/Vp)+VU+Va)},VV.strongIn=function(Vn,Va,VU,Vx){return VU*(Vn/=Vx)*Vn*Vn*Vn*Vn+Va},VV.strongInOut=function(Vn,Va,VU,Vx){return(Vn/=.5*Vx)<1?.5*VU*Vn*Vn*Vn*Vn*Vn+Va:.5*VU*((Vn-=2)*Vn*Vn*Vn*Vn+2)+Va},VV.strongOut=function(Vn,Va,VU,Vx){return VU*((Vn=Vn/Vx-1)*Vn*Vn*Vn*Vn+1)+Va},VV.sineInOut=function(Vn,Va,VU,Vx){return.5*-VU*(Math.cos(Math.PI*Vn/Vx)-1)+Va},VV.sineIn=function(Vn,Va,VU,Vx){return-VU*Math.cos(Vn/Vx*VV.HALF_PI)+VU+Va},VV.sineOut=function(Vn,Va,VU,Vx){return VU*Math.sin(Vn/Vx*VV.HALF_PI)+Va},VV.quintIn=function(Vn,Va,VU,Vx){return VU*(Vn/=Vx)*Vn*Vn*Vn*Vn+Va},VV.quintInOut=function(Vn,Va,VU,Vx){return(Vn/=.5*Vx)<1?.5*VU*Vn*Vn*Vn*Vn*Vn+Va:.5*VU*((Vn-=2)*Vn*Vn*Vn*Vn+2)+Va},VV.quintOut=function(Vn,Va,VU,Vx){return VU*((Vn=Vn/Vx-1)*Vn*Vn*Vn*Vn+1)+Va},VV.quartIn=function(Vn,Va,VU,Vx){return VU*(Vn/=Vx)*Vn*Vn*Vn+Va},VV.quartInOut=function(Vn,Va,VU,Vx){return(Vn/=.5*Vx)<1?.5*VU*Vn*Vn*Vn*Vn+Va:.5*-VU*((Vn-=2)*Vn*Vn*Vn-2)+Va},VV.quartOut=function(Vn,Va,VU,Vx){return-VU*((Vn=Vn/Vx-1)*Vn*Vn*Vn-1)+Va},VV.cubicIn=function(Vn,Va,VU,Vx){return VU*(Vn/=Vx)*Vn*Vn+Va},VV.cubicInOut=function(Vn,Va,VU,Vx){return(Vn/=.5*Vx)<1?.5*VU*Vn*Vn*Vn+Va:.5*VU*((Vn-=2)*Vn*Vn+2)+Va},VV.cubicOut=function(Vn,Va,VU,Vx){return VU*((Vn=Vn/Vx-1)*Vn*Vn+1)+Va},VV.quadIn=function(Vn,Va,VU,Vx){return VU*(Vn/=Vx)*Vn+Va},VV.quadInOut=function(Vn,Va,VU,Vx){return(Vn/=.5*Vx)<1?.5*VU*Vn*Vn+Va:.5*-VU*(--Vn*(Vn-2)-1)+Va},VV.quadOut=function(Vn,Va,VU,Vx){return-VU*(Vn/=Vx)*(Vn-2)+Va},VV.expoIn=function(Vn,Va,VU,Vx){return 0==Vn?Va:VU*Math.pow(2,10*(Vn/Vx-1))+Va-.001*VU},VV.expoInOut=function(Vn,Va,VU,Vx){return 0==Vn?Va:Vn==Vx?Va+VU:(Vn/=.5*Vx)<1?.5*VU*Math.pow(2,10*(Vn-1))+Va:.5*VU*(2-Math.pow(2,-10*--Vn))+Va},VV.expoOut=function(Vn,Va,VU,Vx){return Vn==Vx?Va+VU:VU*(1-Math.pow(2,-10*Vn/Vx))+Va},VV.circIn=function(Vn,Va,VU,Vx){return-VU*(Math.sqrt(1-(Vn/=Vx)*Vn)-1)+Va},VV.circInOut=function(Vn,Va,VU,Vx){return(Vn/=.5*Vx)<1?.5*-VU*(Math.sqrt(1-Vn*Vn)-1)+Va:.5*VU*(Math.sqrt(1-(Vn-=2)*Vn)+1)+Va},VV.circOut=function(Vn,Va,VU,Vx){return VU*Math.sqrt(1-(Vn=Vn/Vx-1)*Vn)+Va},VV.HALF_PI=.5*Math.PI,VV.PI2=2*Math.PI,VV}(),Vd=function(){function Vz(){this._hit=null,this._unHit=null}Vm(Vz,"laya.utils.HitArea");var Vn=Vz.prototype;return Vn.isHit=function(Vn,Va){return!!Vz.isHitGraphic(Vn,Va,this.hit)&&!Vz.isHitGraphic(Vn,Va,this.unHit)},Vn.contains=function(Vn,Va){return this.isHit(Vn,Va)},VX(0,Vn,"hit",function(){return this._hit||(this._hit=new Vi),this._hit},function(Vn){this._hit=Vn}),VX(0,Vn,"unHit",function(){return this._unHit||(this._unHit=new Vi),this._unHit},function(Vn){this._unHit=Vn}),Vz.isHitGraphic=function(Vn,Va,VU){if(!VU)return!1;var Vx;if(!(Vx=VU.cmds)&&VU._one&&((Vx=Vz._cmds).length=1,Vx[0]=VU._one),!Vx)return!1;var VD,Vp,VQ=0;for(VD=Vx.length,VQ=0;VQ<VD;VQ++)if(Vp=Vx[VQ]){var VV=VI._context;switch(Vp.callee){case VV._translate:case 6:Vn-=Vp[0],Va-=Vp[1]}if(Vz.isHitCmd(Vn,Va,Vp))return!0}return!1},Vz.isHitCmd=function(Vn,Va,VU){if(!VU)return!1;var Vx=VI._context,VD=!1;switch(VU.callee){case Vx._drawRect:case 13:Vz._rec.setTo(VU[0],VU[1],VU[2],VU[3]),VD=Vz._rec.contains(Vn,Va);break;case Vx._drawCircle:case Vx._fillCircle:case 14:VD=(Vn-=VU[0])*Vn+(Va-=VU[1])*Va<VU[2]*VU[2];break;case Vx._drawPoly:case 18:Vn-=VU[0],Va-=VU[1],VD=Vz.ptInPolygon(Vn,Va,VU[2])}return VD},Vz.ptInPolygon=function(Vn,Va,VU){var Vx;(Vx=Vz._ptPoint).setTo(Vn,Va);var VD,Vp=0,VQ=NaN,VV=NaN,Vy=NaN,VR=NaN;VD=VU.length;for(var VX=0;VX<VD;VX+=2){if(VQ=VU[VX],VV=VU[VX+1],Vy=VU[(VX+2)%VD],VV!=(VR=VU[(VX+3)%VD]))if(!(Vx.y<Math.min(VV,VR)))if(!(Vx.y>=Math.max(VV,VR)))(Vx.y-VV)*(Vy-VQ)/(VR-VV)+VQ>Vx.x&&Vp++}return Vp%2==1},Vz._cmds=[],Vy(Vz,["_rec",function(){return this._rec=new V_},"_ptPoint",function(){return this._ptPoint=new VN}]),Vz}(),VS=(function(){function VD(Vn,Va,VU,Vx){this.char=Vn,this.charNum=Vn.charCodeAt(0),this._x=this._y=0,this.width=Va,this.height=VU,this.style=Vx,this.isWord=!VD._isWordRegExp.test(Vn)}Vm(VD,"laya.utils.HTMLChar");var Vn=VD.prototype;Vk.imps(Vn,{"laya.display.ILayout":!0}),Vn.setSprite=function(Vn){this._sprite=Vn},Vn.getSprite=function(){return this._sprite},Vn._isChar=function(){return!0},Vn._getCSSStyle=function(){return this.style},VX(0,Vn,"width",function(){return this._w},function(Vn){this._w=Vn}),VX(0,Vn,"x",function(){return this._x},function(Vn){this._sprite&&(this._sprite.x=Vn),this._x=Vn}),VX(0,Vn,"y",function(){return this._y},function(Vn){this._sprite&&(this._sprite.y=Vn),this._y=Vn}),VX(0,Vn,"height",function(){return this._h},function(Vn){this._h=Vn}),VD._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function Va(){}Vm(Va,"laya.utils.Log"),Va.enable=function(){Va._logdiv||(Va._logdiv=Vf.window.document.createElement("div"),Vf.window.document.body.appendChild(Va._logdiv),Va._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},Va.toggle=function(){var Vn=Va._logdiv.style;"1px"==Vn.width?Vn.width=Vn.height="50%":Vn.width=Vn.height="1px"},Va.print=function(Vn){Va._logdiv&&(Va.maxCount<=Va._count&&Va.clear(),Va._count++,Va._logdiv.innerText+=Vn+"\n",Va._logdiv.scrollTop=Va._logdiv.scrollHeight)},Va.clear=function(){Va._logdiv.innerText="",Va._count=0},Va._logdiv=null,Va._count=0,Va.maxCount=20}(),function(){function Va(){}Vm(Va,"laya.utils.Mouse"),VX(1,Va,"cursor",function(){return Va._style.cursor},function(Vn){Va._style.cursor=Vn}),Va.hide=function(){"none"!=Va.cursor&&(Va._preCursor=Va.cursor,Va.cursor="none")},Va.show=function(){"none"==Va.cursor&&(Va.cursor=Va._preCursor?Va._preCursor:"auto")},Va._preCursor=null,Vy(Va,["_style",function(){return this._style=Vf.document.body.style}])}(),function(){function Vp(){}return Vm(Vp,"laya.utils.Pool"),Vp.getPoolBySign=function(Vn){return Vp._poolDic[Vn]||(Vp._poolDic[Vn]=[])},Vp.clearBySign=function(Vn){Vp._poolDic[Vn]&&(Vp._poolDic[Vn].length=0)},Vp.recover=function(Vn,Va){Va.__InPool||(Va.__InPool=!0,Vp.getPoolBySign(Vn).push(Va))},Vp.getItemByClass=function(Vn,Va){var VU=Vp.getPoolBySign(Vn),Vx=VU.length?VU.pop():new Va;return Vx.__InPool=!1,Vx},Vp.getItemByCreateFun=function(Vn,Va,VU){var Vx=Vp.getPoolBySign(Vn),VD=Vx.length?Vx.pop():Va.call(VU);return VD.__InPool=!1,VD},Vp.getItem=function(Vn){var Va=Vp.getPoolBySign(Vn),VU=Va.length?Va.pop():null;return VU&&(VU.__InPool=!1),VU},Vp._poolDic={},Vp.InPoolSign="__InPool",Vp}()),Vw=function(){function Vy(){}return Vm(Vy,"laya.utils.Stat"),VX(1,Vy,"onclick",null,function(Vn){Vy._sp&&Vy._sp.on("click",Vy._sp,Vn),Vy._canvas&&(Vy._canvas.source.onclick=Vn,Vy._canvas.source.style.pointerEvents="")}),Vy.show=function(Vn,Va,VU){if(void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),void 0===VU&&(VU=0),!VI.isConchApp||VI.isConchWebGL){if(VI.isConchWebGL||Vf.onMiniGame||Vf.onLimixiu||(Vy._useCanvas=!0),Vy._show=!0,Vy._fpsData.length=60,Vy._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},Vy._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},Vy._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},Vy._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},VI.isWebGL)if(Vy._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},VI.is3DMode){if(Vy._view[0].title="FPS(3D)",Vy._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},Vy._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},Vy._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==VU){var Vx=8;Vy._view[Vx++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},Vy._view[Vx++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},Vy._view[Vx++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},Vy._view[Vx++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Vy._view[Vx++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Vy._view[Vx++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Vy._view[Vx++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},Vy._view[Vx++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},Vy._view[Vx++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==VU){Vx=8;Vy._view[Vx++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},Vy._view[Vx++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},Vy._view[Vx++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},Vy._view[Vx++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},Vy._view[Vx++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},Vy._view[Vx++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},Vy._view[Vx++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else Vy._view[0].title="FPS(WebGL)",Vy._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else Vy._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};Vy._useCanvas?Vy.createUIPre(Vn,Va):Vy.createUI(Vn,Va),Vy.enable()}else Vf.window.conch.showFPS&&Vf.window.conch.showFPS(Vn,Va)},Vy.createUIPre=function(Vn,Va){var VU=Vf.pixelRatio;Vy._width=170*VU,Vy._vx=75*VU,Vy._height=VU*(12*Vy._view.length+3*VU)+4,Vy._fontSize=12*VU;for(var Vx=0;Vx<Vy._view.length;Vx++)Vy._view[Vx].x=4,Vy._view[Vx].y=Vx*Vy._fontSize+2*VU;Vy._canvas||((Vy._canvas=new VTn("2D")).size(Vy._width,Vy._height),(Vy._ctx=Vy._canvas.getContext("2d")).textBaseline="top",Vy._ctx.font=Vy._fontSize+"px Sans-serif",Vy._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+Vn+"px;top:"+Va+"px;width:"+Vy._width/VU+"px;height:"+Vy._height/VU+"px;"),Vy._first=!0,Vy.loop(),Vy._first=!1,Vf.container.appendChild(Vy._canvas.source)},Vy.createUI=function(Vn,Va){var VU=Vy._sp,Vx=Vf.pixelRatio;VU||(VU=new Vzn,(Vy._leftText=new Vbn).pos(5,5),Vy._leftText.color="#ffffff",VU.addChild(Vy._leftText),(Vy._txt=new Vbn).pos(80*Vx,5),Vy._txt.color="#ffffff",VU.addChild(Vy._txt),Vy._sp=VU),VU.pos(Vn,Va);for(var VD="",Vp=0;Vp<Vy._view.length;Vp++){VD+=Vy._view[Vp].title+"\n"}Vy._leftText.text=VD;var VQ=170*Vx,VV=Vx*(12*Vy._view.length+3*Vx)+4;Vy._txt.fontSize=Vy._fontSize*Vx,Vy._leftText.fontSize=Vy._fontSize*Vx,VU.size(VQ,VV),VU.graphics.clear(),VU.graphics.setAlpha(.5),VU.graphics.drawRect(0,0,VQ,VV,"#999999"),VU.graphics.setAlpha(1),Vy.loop()},Vy.enable=function(){Vk.timer.frameLoop(1,Vy,Vy.loop)},Vy.hide=function(){Vy._show=!1,Vk.timer.clear(Vy,Vy.loop),Vy._canvas&&Vf.removeElement(Vy._canvas.source)},Vy.clear=function(){Vy.trianglesFaces=Vy.drawCall=Vy.shaderCall=Vy.spriteCount=Vy.spriteRenderUseCacheCount=Vy.treeNodeCollision=Vy.treeSpriteCollision=Vy.canvasNormal=Vy.canvasBitmap=Vy.canvasReCache=0},Vy.loop=function(){Vy._count++;var Vn=Vf.now();if(!(Vn-Vy._timer<1e3)){var Va=Vy._count;if(Vy.FPS=Math.round(1e3*Va/(Vn-Vy._timer)),Vy._show){Vy.trianglesFaces=Math.round(Vy.trianglesFaces/Va),Vy.spriteCount=Vy._useCanvas?(Vy.drawCall=Math.round(Vy.drawCall/Va)-2,Vy.shaderCall=Math.round(Vy.shaderCall/Va),Math.round(Vy.spriteCount/Va)-1):(Vy.drawCall=Math.round(Vy.drawCall/Va)-2,Vy.shaderCall=Math.round(Vy.shaderCall/Va)-4,Math.round(Vy.spriteCount/Va)-4),Vy.spriteRenderUseCacheCount=Math.round(Vy.spriteRenderUseCacheCount/Va),Vy.canvasNormal=Math.round(Vy.canvasNormal/Va),Vy.canvasBitmap=Math.round(Vy.canvasBitmap/Va),Vy.canvasReCache=Math.ceil(Vy.canvasReCache/Va),Vy.treeNodeCollision=Math.round(Vy.treeNodeCollision/Va),Vy.treeSpriteCollision=Math.round(Vy.treeSpriteCollision/Va);var VU=0<Vy.FPS?Math.floor(1e3/Vy.FPS).toString():" ";Vy._fpsStr=Vy.FPS+(Vy.renderSlow?" slow":"")+" "+VU,Vy._spriteStr=Vy.spriteCount+(Vy.spriteRenderUseCacheCount?"/"+Vy.spriteRenderUseCacheCount:""),Vy._canvasStr=Vy.canvasReCache+"/"+Vy.canvasNormal+"/"+Vy.canvasBitmap,Vy.currentMemorySize=Vh.systemResourceManager.memorySize,Vy._useCanvas?Vy.renderInfoPre():Vy.renderInfo(),Vy.clear()}Vy._count=0,Vy._timer=Vn}},Vy.renderInfoPre=function(){if(Vy._canvas){var Vn=Vy._ctx;Vn.clearRect(Vy._first?0:Vy._vx,0,Vy._width,Vy._height);for(var Va=VI.WebGL.mainContext,VU=0;VU<Vy._view.length;VU++){var Vx=Vy._view[VU];Vy._first&&(Vn.fillStyle="white",Vn.fillText(Vx.title,Vx.x,Vx.y,null,null,null)),Vn.fillStyle=Vx.color;var VD=-1;if((Vx=Vy._view[VU]).varying){if(Va)switch(Vx.varying){case 1:VD=Va.getParameter(Va[Vx.value]);break;case 2:VD=Va.getExtension(Vx.value)}}else VD=Vy[Vx.value];"M"==Vx.units&&(VD=Math.floor(VD/1048576*100)/100+" M"),"K"==Vx.units&&(VD=Math.floor(VD/1024*100)/100+" K"),"string"==Vx.units&&(VD=VD.match(/\d+\.?\d/i)),Vn.fillText(VD+"",Vx.x+Vy._vx,Vx.y,null,null,null)}}},Vy.renderInfo=function(){for(var Vn="",Va=VI.WebGL.mainContext,VU=0;VU<Vy._view.length;VU++){var Vx=Vy._view[VU],VD=-1;if(Vx.varying){if(Va)switch(Vx.varying){case 1:VD=Va.getParameter(Va[Vx.value]);break;case 2:VD=Va.getExtension(Vx.value)}}else VD=Vy[Vx.value];"M"==Vx.units&&(VD=Math.floor(VD/1048576*100)/100+" M"),"K"==Vx.units&&(VD=Math.floor(VD/1024*100)/100+" K"),"string"==Vx.units&&(VD=VD.match(/\d+\.?\d/i)),Vn+=VD+"\n"}Vy._txt.text=Vn},Vy.FPS=0,Vy.loopCount=0,Vy.shaderCall=0,Vy.drawCall=0,Vy.trianglesFaces=0,Vy.spriteCount=0,Vy.spriteRenderUseCacheCount=0,Vy.treeNodeCollision=0,Vy.treeSpriteCollision=0,Vy.canvasNormal=0,Vy.canvasBitmap=0,Vy.canvasReCache=0,Vy.renderSlow=!1,Vy.currentMemorySize=0,Vy._fpsStr=null,Vy._canvasStr=null,Vy._spriteStr=null,Vy._fpsData=[],Vy._timer=0,Vy._count=0,Vy._view=[],Vy._fontSize=12,Vy._txt=null,Vy._leftText=null,Vy._sp=null,Vy._show=!1,Vy._useCanvas=!1,Vy._canvas=null,Vy._ctx=null,Vy._first=!1,Vy._vx=NaN,Vy._width=0,Vy._height=100,Vy}(),Vs=(function(){function Vn(){this._strsToID={},this._idToStrs=[],this._length=0}Vm(Vn,"laya.utils.StringKey");var Va=Vn.prototype;Va.add=function(Vn){var Va=this._strsToID[Vn];return null!=Va?Va:(this._idToStrs[this._length]=Vn,this._strsToID[Vn]=this._length++)},Va.getID=function(Vn){var Va=this._strsToID[Vn];return null==Va?-1:Va},Va.getName=function(Vn){var Va=this._idToStrs[Vn];return null==Va?void 0:Va}}(),function(){var VR;function Vn(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}Vm(Vn,"laya.utils.Timer");var Va=Vn.prototype;return Va._init=function(){Vk.timer&&Vk.timer.frameLoop(1,this,this._update)},Va._now=function(){return Date.now()},Va._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var Vn=this.currFrame=this.currFrame+this.scale,Va=this._now();this._delta=(Va-this._lastTimer)*this.scale;var VU=this.currTimer=this.currTimer+this._delta;Vk.isDebug&&6e4<Math.abs(Va-this._lastTimer)&&console.error("系统时间错误！"+(Va-this._lastTimer)),this._lastTimer=Va;var Vx=this._handlers;for(VQ=this._count=0,VV=Vx.length;VQ<VV;VQ++)if(null!==(Vy=Vx[VQ]).method){var VD=Vy.userFrame?Vn:VU;if(VD>=Vy.exeTime)if(Vy.repeat)if(Vy.jumpFrame)for(;VD>=Vy.exeTime;)Vy.exeTime+=Vy.delay,Vy.run(!1);else Vy.exeTime+=Vy.delay,Vy.run(!1),VD>Vy.exeTime&&(Vy.exeTime+=Math.ceil((VD-Vy.exeTime)/Vy.delay)*Vy.delay);else Vy.run(!0)}else this._count++;(30<this._count||Vn%200==0)&&this._clearHandlers();for(var Vp=this._laters,VQ=0,VV=Vp.length-1;VQ<=VV;VQ++){var Vy=Vp[VQ];this._isIgnoreRecover(Vy)||(null!==Vy.method&&(delete this._map[Vy.key],Vy.run(!1)),this._recoverHandler(Vy)),VQ===VV&&(VV=Vp.length-1)}Vp.length=0}},Va._clearHandlers=function(){for(var Vn=this._handlers,Va=0,VU=Vn.length;Va<VU;Va++){var Vx=Vn[Va];null!==Vx.method?this._temp.push(Vx):this._isIgnoreRecover(Vx)?this._temp.push(Vx):this._recoverHandler(Vx)}this._handlers=this._temp,this._temp=Vn,this._temp.length=0},Va._recoverHandler=function(Vn){this._map[Vn.key]==Vn&&delete this._map[Vn.key],Vn.recover()},Va._create=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){if(!VU)return VD.apply(Vx,Vp),null;if(VQ){var Vy=this._getHandler(Vx,VD);if(Vy)return Vy.repeat=Va,Vy.userFrame=Vn,Vy.delay=VU,Vy.ignoreRecover=VV,Vy.caller=Vx,Vy.method=VD,Vy.args=Vp,Vy.exeTime=VU+(Vn?this.currFrame:this.currTimer+this._now()-this._lastTimer),Vy}return(Vy=VR.create()).repeat=Va,Vy.userFrame=Vn,Vy.delay=VU,Vy.ignoreRecover=VV,Vy.caller=Vx,Vy.method=VD,Vy.args=Vp,Vy.exeTime=VU+(Vn?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(Vy),this._handlers.push(Vy),Vy},Va._indexHandler=function(Vn){var Va=Vn.caller,VU=Vn.method,Vx=Va?Va.$_GID||(Va.$_GID=Vt.getGID()):0,VD=VU.$_TID||(VU.$_TID=this._mid++);Vn.key=Vx+"_"+VD,this._map[Vn.key]=Vn},Va.once=function(Vn,Va,VU,Vx,VD){void 0===VD&&(VD=!0),this._create(!1,!1,Vn,Va,VU,Vx,VD,!1)},Va.loop=function(Vn,Va,VU,Vx,VD,Vp,VQ){void 0===VD&&(VD=!0),void 0===Vp&&(Vp=!1),void 0===VQ&&(VQ=!1);var VV=this._create(!1,!0,Vn,Va,VU,Vx,VD,VQ);VV&&(VV.jumpFrame=Vp)},Va.frameOnce=function(Vn,Va,VU,Vx,VD){void 0===VD&&(VD=!0),this._create(!0,!1,Vn,Va,VU,Vx,VD,!1)},Va.frameLoop=function(Vn,Va,VU,Vx,VD,Vp){void 0===VD&&(VD=!0),void 0===Vp&&(Vp=!1),this._create(!0,!0,Vn,Va,VU,Vx,VD,Vp)},Va.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+VR._freeCount},Va.clear=function(Vn,Va){var VU=this._getHandler(Vn,Va);return!(!VU||this._isIgnoreRecover(VU))&&(delete this._map[VU.key],VU.key=null,VU.clear(),!0)},Va.clearAll=function(Vn){if(Vn)for(var Va=0,VU=this._handlers.length;Va<VU;Va++){var Vx=this._handlers[Va];Vx.caller===Vn&&(this._isIgnoreRecover(Vx)||(delete this._map[Vx.key],Vx.key=null,Vx.clear()))}},Va._getHandler=function(Vn,Va){var VU=Vn?Vn.$_GID||(Vn.$_GID=Vt.getGID()):0,Vx=Va.$_TID||(Va.$_TID=this._mid++);return this._map[VU+"_"+Vx]},Va._isIgnoreRecover=function(Vn){if(Vn.ignoreRecover||Vn.caller&&"IgnoreRecover"==Vn.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var Va="";try{arguments.propertyIsEnumerable.caller}catch(Vn){Va=Vn.stack}Vk.recordError("报错：核心定时器销毁忽略  "+Va)}return!0}return!1},Va.hasHandler=function(Vn,Va){return this._map[Vn.$_GID+"_"+Va.$_TID]},Va.callLater=function(Vn,Va,VU){if(null==this._getHandler(Vn,Va)){var Vx=VR.create();Vx.caller=Vn,Vx.method=Va,Vx.args=VU,this._indexHandler(Vx),this._laters.push(Vx)}},Va.runCallLater=function(Vn,Va){var VU=this._getHandler(Vn,Va);VU&&null!=VU.method&&(this._isIgnoreRecover(VU)||(delete this._map[VU.key],VU.run(!0)))},Va.runTimer=function(Vn,Va){this.runCallLater(Vn,Va)},VX(0,Va,"delta",function(){return this._delta}),Vn.__init$=function(){VR=function(){function Va(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}Vm(Va,"");var Vn=Va.prototype;return Vn.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},Vn.recover=function(){this.clear(),this.args=Va._freeHandler,Va._freeHandler=this,Va._freeCount++},Vn.run=function(Vn){var Va=this.caller;if(Va&&Va.destroyed)return this.clear();var VU=this.method,Vx=this.args;Vn&&this.clear(),null!=VU&&(Vx?VU.apply(Va,Vx):VU.call(Va))},Va._freeHandler=null,Va._freeCount=0,Va.create=function(){var Vn=Va._freeHandler;return Vn?(Va._freeHandler=Vn.args,--Va._freeCount,Vn.args=null,Vn):new Va},Va}()},Vn}()),VC=function(){function Vz(){this.gid=0}Vm(Vz,"laya.utils.Tween");var Vn=Vz.prototype;return Vn.to=function(Vn,Va,VU,Vx,VD,Vp,VQ){return void 0===Vp&&(Vp=0),void 0===VQ&&(VQ=!1),this._create(Vn,Va,VU,Vx,VD,Vp,VQ,!0,!1,!0)},Vn.from=function(Vn,Va,VU,Vx,VD,Vp,VQ){return void 0===Vp&&(Vp=0),void 0===VQ&&(VQ=!1),this._create(Vn,Va,VU,Vx,VD,Vp,VQ,!1,!1,!0)},Vn._create=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){if(!Vn)throw new Error("Tween:target is null");this._target=Vn,this._duration=VU,this._ease=Vx||Va.ease||Vz.easeNone,this._complete=VD||Va.complete,this._delay=Vp,this._props=[],this._usedTimer=0,this._startTimer=Vf.now(),this._usedPool=Vy,this._delayParam=null,this.update=Va.update;var VX=Vn.$_GID||(Vn.$_GID=Vt.getGID());return Vz.tweenMap[VX]?(VQ&&Vz.clearTween(Vn),Vz.tweenMap[VX].push(this)):Vz.tweenMap[VX]=[this],VR?Vp<=0?this.firstStart(Vn,Va,VV):(this._delayParam=[Vn,Va,VV],Vk.scaleTimer.once(Vp,this,this.firstStart,this._delayParam)):this._initProps(Vn,Va,VV),this},Vn.firstStart=function(Vn,Va,VU){this._delayParam=null,Vn.destroyed?this.clear():(this._initProps(Vn,Va,VU),this._beginLoop())},Vn._initProps=function(Vn,Va,VU){for(var Vx in Va)if("number"==typeof Vn[Vx]){var VD=VU?Vn[Vx]:Va[Vx],Vp=VU?Va[Vx]:Vn[Vx];this._props.push([Vx,VD,Vp-VD]),VU||(Vn[Vx]=VD)}},Vn._beginLoop=function(){Vk.scaleTimer.frameLoop(1,this,this._doEase)},Vn._doEase=function(){this._updateEase(Vf.now())},Vn._updateEase=function(Vn){var Va=this._target;if(Va){if(Va.destroyed)return Vz.clearTween(Va);var VU=this._usedTimer=Vn-this._startTimer-this._delay;if(!(VU<0)){if(VU>=this._duration)return this.complete();for(var Vx=0<VU?this._ease(VU,0,1,this._duration):0,VD=this._props,Vp=0,VQ=VD.length;Vp<VQ;Vp++){var VV=VD[Vp];Va[VV[0]]=VV[1]+Vx*VV[2]}this.update&&this.update.run()}}},Vn.complete=function(){if(this._target){Vk.scaleTimer.runTimer(this,this.firstStart);for(var Vn=this._target,Va=this._props,VU=this._complete,Vx=0,VD=Va.length;Vx<VD;Vx++){var Vp=Va[Vx];Vn[Vp[0]]=Vp[1]+Vp[2]}this.update&&this.update.run(),this.clear(),VU&&VU.run()}},Vn.pause=function(){Vk.scaleTimer.clear(this,this._beginLoop),Vk.scaleTimer.clear(this,this._doEase),Vk.scaleTimer.clear(this,this.firstStart);var Vn;(Vn=Vf.now()-this._startTimer-this._delay)<0&&(this._usedTimer=Vn)},Vn.setStartTime=function(Vn){this._startTimer=Vn},Vn.clear=function(){this._target&&(this._remove(),this._clear())},Vn._clear=function(){this.pause(),Vk.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,VS.recover("tween",this))},Vn.recover=function(){this._usedPool=!0,this._clear()},Vn._remove=function(){var Vn=Vz.tweenMap[this._target.$_GID];if(Vn)for(var Va=0,VU=Vn.length;Va<VU;Va++)if(Vn[Va]===this){Vn.splice(Va,1);break}},Vn.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=Vf.now(),this._delayParam)Vk.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var Vn=this._props,Va=0,VU=Vn.length;Va<VU;Va++){var Vx=Vn[Va];this._target[Vx[0]]=Vx[1]}Vk.scaleTimer.once(this._delay,this,this._beginLoop)}},Vn.resume=function(){this._usedTimer>=this._duration||(this._startTimer=Vf.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?Vk.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},VX(0,Vn,"progress",null,function(Vn){var Va=Vn*this._duration;this._startTimer=Vf.now()-this._delay-Va}),Vz.to=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){return void 0===Vp&&(Vp=0),void 0===VQ&&(VQ=!1),void 0===VV&&(VV=!0),VS.getItemByClass("tween",Vz)._create(Vn,Va,VU,Vx,VD,Vp,VQ,!0,VV,!0)},Vz.from=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){return void 0===Vp&&(Vp=0),void 0===VQ&&(VQ=!1),void 0===VV&&(VV=!0),VS.getItemByClass("tween",Vz)._create(Vn,Va,VU,Vx,VD,Vp,VQ,!1,VV,!0)},Vz.clearAll=function(Vn){if(Vn&&Vn.$_GID){var Va=Vz.tweenMap[Vn.$_GID];if(Va){for(var VU=0,Vx=Va.length;VU<Vx;VU++)Va[VU]._clear();Va.length=0}}},Vz.clear=function(Vn){Vn.clear()},Vz.clearTween=function(Vn){Vz.clearAll(Vn)},Vz.easeNone=function(Vn,Va,VU,Vx){return VU*Vn/Vx+Va},Vz.tweenMap={},Vz}(),Vt=function(){function VV(){}return Vm(VV,"laya.utils.Utils"),VV.toRadian=function(Vn){return Vn*VV._pi2},VV.toAngle=function(Vn){return Vn*VV._pi},VV.toHexColor=function(Vn){if(Vn<0||isNaN(Vn))return null;for(var Va=Vn.toString(16);Va.length<6;)Va="0"+Va;return"#"+Va},VV.getGID=function(){return VV._gid++},VV.concatArray=function(Vn,Va){if(!Va)return Vn;if(!Vn)return Va;var VU=0,Vx=Va.length;for(VU=0;VU<Vx;VU++)Vn.push(Va[VU]);return Vn},VV.clearArray=function(Vn){return Vn&&(Vn.length=0),Vn},VV.copyArray=function(Vn,Va){if(Vn||(Vn=[]),!Va)return Vn;Vn.length=Va.length;var VU=0,Vx=Va.length;for(VU=0;VU<Vx;VU++)Vn[VU]=Va[VU];return Vn},VV.getGlobalRecByPoints=function(Vn,Va,VU,Vx,VD){var Vp,VQ;return Vp=new VN(Va,VU),Vp=Vn.localToGlobal(Vp),VQ=new VN(Vx,VD),VQ=Vn.localToGlobal(VQ),V_._getWrapRec([Vp.x,Vp.y,VQ.x,VQ.y])},VV.getGlobalPosAndScale=function(Vn){return VV.getGlobalRecByPoints(Vn,0,0,1,1)},VV.bind=function(Vn,Va){return Vn.bind(Va)},VV.measureText=function(Vn,Va){return Vu.measureText(Vn,Va)},VV.contextMeasureText=function(Vn){var Va=Vf.context.measureText(Vn);return Va||(Va={width:16,height:16}),Va},VV.updateOrder=function(Vn){if(!Vn||Vn.length<2)return!1;for(var Va,VU=1,Vx=0,VD=Vn.length,Vp=NaN;VU<VD;){for(Va=Vn[Vx=VU],Vp=Vn[Vx]._zOrder;-1<--Vx&&Vn[Vx]._zOrder>Vp;)Vn[Vx+1]=Vn[Vx];Vn[Vx+1]=Va,VU++}var VQ=Va.parent.conchModel;if(VQ)if(null!=VQ.updateZOrder)VQ.updateZOrder();else{for(VU=0;VU<VD;VU++)VQ.removeChild(Vn[VU].conchModel);for(VU=0;VU<VD;VU++)VQ.addChildAt(Vn[VU].conchModel,VU)}return!0},VV.transPointList=function(Vn,Va,VU){var Vx=0,VD=Vn.length;for(Vx=0;Vx<VD;Vx+=2)Vn[Vx]+=Va,Vn[Vx+1]+=VU},VV.parseInt=function(Vn,Va){void 0===Va&&(Va=0);var VU=Vf.window.parseInt(Vn,Va);return isNaN(VU)?0:VU},VV.getFileExtension=function(Vn){VV._extReg.lastIndex=Vn.lastIndexOf(".");var Va=VV._extReg.exec(Vn);return Va&&1<Va.length?Va[1].toLowerCase():null},VV.getTransformRelativeToWindow=function(Vn,Va,VU){var Vx=Vk.stage,VD=laya.utils.Utils.getGlobalPosAndScale(Vn),Vp=Vx._canvasTransform.clone(),VQ=Vp.tx,VV=Vp.ty;Vp.rotate(-Math.PI/180*Vk.stage.canvasDegree),Vp.scale(Vk.stage.clientScaleX,Vk.stage.clientScaleY);var Vy=Vk.stage.canvasDegree%180!=0,VR=NaN,VX=NaN;Vy?(VR=VU+VD.y,VX=Va+VD.x,VR*=Vp.d,VX*=Vp.a,90==Vk.stage.canvasDegree?(VR=VQ-VR,VX+=VV):(VR+=VQ,VX=VV-VX)):(VR=Va+VD.x,VX=VU+VD.y,VR*=Vp.a,VX*=Vp.d,VR+=VQ,VX+=VV);var Vz=NaN,Vi=NaN;return Vi=Vy?(Vz=Vp.d*VD.height,Vp.a*VD.width):(Vz=Vp.a*VD.width,Vp.d*VD.height),{x:VR,y:VX,scaleX:Vz,scaleY:Vi}},VV.fitDOMElementInArea=function(Vn,Va,VU,Vx,VD,Vp){Vn._fitLayaAirInitialized||(Vn._fitLayaAirInitialized=!0,Vn.style.transformOrigin=Vn.style.webKittransformOrigin="left top",Vn.style.position="absolute");var VQ=VV.getTransformRelativeToWindow(Va,VU,Vx);Vn.style.transform=Vn.style.webkitTransform="scale("+VQ.scaleX+","+VQ.scaleY+") rotate("+Vk.stage.canvasDegree+"deg)",Vn.style.width=VD+"px",Vn.style.height=Vp+"px",Vn.style.left=VQ.x+"px",Vn.style.top=VQ.y+"px"},VV.isOkTextureList=function(Vn){if(!Vn)return!1;var Va,VU=0,Vx=Vn.length;for(VU=0;VU<Vx;VU++)if(!(Va=Vn[VU])||!Va.source)return!1;return!0},VV.isOKCmdList=function(Vn){if(!Vn)return!1;var Va,VU,Vx=0,VD=Vn.length,Vp=VI._context;for(Vx=0;Vx<VD;Vx++)switch((Va=Vn[Vx]).callee){case Vp._drawTexture:case Vp._fillTexture:case Vp._drawTextureWithTransform:if(!(VU=Va[0])||!VU.source)return!1}return!0},VV._gid=1,VV._pi=180/Math.PI,VV._pi2=Math.PI/180,VV._extReg=/\.(\w+)\??/g,VV.parseXMLFromString=function(Vn){var Va;if(Vn=Vn.replace(/>\s+</g,"><"),-1<(Va=(new DOMParser).parseFromString(Vn,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(Va.firstChild.firstChild.textContent);return Va},VV}(),Vr=function(){function Vn(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],VI.isWebGL&&Vg.regCacheByFunction(Vt.bind(this.startDispose,this),Vt.bind(this.getCacheList,this))}Vm(Vn,"laya.utils.VectorGraphManager");var Va=Vn.prototype;return Va.getId=function(){return this._id++},Va.addShape=function(Vn,Va){this.shapeDic[Vn]=Va,this.useDic[Vn]||(this.useDic[Vn]=!0)},Va.addLine=function(Vn,Va){this.shapeLineDic[Vn]=Va,this.shapeLineDic[Vn]||(this.shapeLineDic[Vn]=!0)},Va.getShape=function(Vn){this._checkKey&&null!=this.useDic[Vn]&&(this.useDic[Vn]=!0)},Va.deleteShape=function(Vn){this.shapeDic[Vn]&&(this.shapeDic[Vn]=null,delete this.shapeDic[Vn]),this.shapeLineDic[Vn]&&(this.shapeLineDic[Vn]=null,delete this.shapeLineDic[Vn]),null!=this.useDic[Vn]&&delete this.useDic[Vn]},Va.getCacheList=function(){var Vn,Va=[];for(Vn in this.shapeDic)Va.push(this.shapeDic[Vn]);for(Vn in this.shapeLineDic)Va.push(this.shapeLineDic[Vn]);return Va},Va.startDispose=function(Vn){var Va;for(Va in this.useDic)this.useDic[Va]=!1;this._checkKey=!0},Va.endDispose=function(){if(this._checkKey){var Vn;for(Vn in this.useDic)this.useDic[Vn]||this.deleteShape(Vn);this._checkKey=!1}},Vn.getInstance=function(){return Vn.instance=Vn.instance||new Vn},Vn.instance=null,Vn}(),VJ=function(){function Vx(){this._obj=null,this._obj=Vx.supportWeakMap?new Vf.window.WeakMap:{},Vx.supportWeakMap||Vx._maps.push(this)}Vm(Vx,"laya.utils.WeakObject");var Vn=Vx.prototype;return Vn.set=function(Vn,Va){if(null!=Vn)if(Vx.supportWeakMap){var VU=Vn;"string"!=typeof Vn&&"number"!=typeof Vn||(VU=Vx._keys[Vn])||(VU=Vx._keys[Vn]={k:Vn}),this._obj.set(VU,Va)}else"string"==typeof Vn||"number"==typeof Vn?this._obj[Vn]=Va:(Vn.$_GID||(Vn.$_GID=Vt.getGID()),this._obj[Vn.$_GID]=Va)},Vn.get=function(Vn){if(null==Vn)return null;if(Vx.supportWeakMap){var Va="string"==typeof Vn||"number"==typeof Vn?Vx._keys[Vn]:Vn;return Va?this._obj.get(Va):null}return"string"==typeof Vn||"number"==typeof Vn?this._obj[Vn]:this._obj[Vn.$_GID]},Vn.del=function(Vn){if(null!=Vn)if(Vx.supportWeakMap){var Va="string"==typeof Vn||"number"==typeof Vn?Vx._keys[Vn]:Vn;if(!Va)return;this._obj.delete(Va)}else"string"==typeof Vn||"number"==typeof Vn?delete this._obj[Vn]:delete this._obj[this._obj.$_GID]},Vn.has=function(Vn){if(null==Vn)return!1;if(Vx.supportWeakMap){var Va="string"==typeof Vn||"number"==typeof Vn?Vx._keys[Vn]:Vn;return this._obj.has(Va)}return"string"==typeof Vn||"number"==typeof Vn?null!=this._obj[Vn]:null!=this._obj[this._obj.$_GID]},Vx.__init__=function(){(Vx.supportWeakMap=null!=Vf.window.WeakMap)||Vk.timer.loop(Vx.delInterval,null,Vx.clearCache)},Vx.clearCache=function(){for(var Vn=0,Va=Vx._maps.length;Vn<Va;Vn++){Vx._maps[Vn]._obj={}}},Vx.supportWeakMap=!1,Vx.delInterval=3e5,Vx._keys={},Vx._maps=[],Vy(Vx,["I",function(){return this.I=new Vx}]),Vx}(),Ve=function(){function Vn(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}Vm(Vn,"laya.utils.WordText");var Va=Vn.prototype;return Va.setText=function(Vn){this.changed=!0,this._text=Vn},Va.toString=function(){return this._text},Va.charCodeAt=function(Vn){return this._text?this._text.charCodeAt(Vn):NaN},Va.charAt=function(Vn){return this._text?this._text.charAt(Vn):null},VX(0,Va,"length",function(){return this._text?this._text.length:0}),Vn}(),Vnn=function(Vn){function VQ(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,VQ.__super.call(this),this._childs=VQ.ARRAY_EMPTY,this._$P=VQ.PROP_EMPTY,this.timer=Vk.scaleTimer,this.conchModel=VI.isConchNode?this.createConchModel():null}Vm(VQ,"laya.display.Node",VR);var Va=VQ.prototype;return Va._setBit=function(Vn,Va){1==Vn&&(this._getBit(Vn)!=Va&&this._updateDisplayedInstage());Va?this._bits|=Vn:this._bits&=~Vn},Va._getBit=function(Vn){return 0!=(this._bits&Vn)},Va._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},Va._setUpNoticeType=function(Vn){var Va=this;for(Va._setBit(Vn,!0),Va=Va.parent;Va;){if(Va._getBit(Vn))return;Va._setBit(Vn,!0),Va=Va.parent}},Va.on=function(Vn,Va,VU,Vx){return"display"!==Vn&&"undisplay"!==Vn||this._getBit(1)||this._setUpNoticeType(1),this._createListener(Vn,Va,VU,Vx,!1)},Va.once=function(Vn,Va,VU,Vx){return"display"!==Vn&&"undisplay"!==Vn||this._getBit(1)||this._setUpNoticeType(1),this._createListener(Vn,Va,VU,Vx,!0)},Va.createConchModel=function(){return null},Va.destroy=function(Vn){void 0===Vn&&(Vn=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(Vn?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},Va.destroyChildren=function(){if(this._childs)for(var Vn=this._childs.length-1;-1<Vn;Vn--)this._childs[Vn].destroy(!0)},Va.addChild=function(Vn){if(!Vn||this.destroyed||Vn===this)return Vn;if(Vn.zOrder&&this._set$P("hasZorder",!0),Vn._parent===this){var Va=this.getChildIndex(Vn);Va!==this._childs.length-1&&(this._childs.splice(Va,1),this._childs.push(Vn),this.conchModel&&(this.conchModel.removeChild(Vn.conchModel),this.conchModel.addChildAt(Vn.conchModel,this._childs.length-1)),this._childChanged())}else Vn.parent&&Vn.parent.removeChild(Vn),this._childs===VQ.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Vn),this.conchModel&&this.conchModel.addChildAt(Vn.conchModel,this._childs.length-1),(Vn.parent=this)._childChanged();return Vn},Va.addChildren=function(Vn){for(var Va=arguments,VU=0,Vx=Va.length;VU<Vx;)this.addChild(Va[VU++])},Va.addChildAt=function(Vn,Va){if(!Vn||this.destroyed||Vn===this)return Vn;if(Vn.zOrder&&this._set$P("hasZorder",!0),0<=Va&&Va<=this._childs.length){if(Vn._parent===this){var VU=this.getChildIndex(Vn);this._childs.splice(VU,1),this._childs.splice(Va,0,Vn),this.conchModel&&(this.conchModel.removeChild(Vn.conchModel),this.conchModel.addChildAt(Vn.conchModel,Va)),this._childChanged()}else Vn.parent&&Vn.parent.removeChild(Vn),this._childs===VQ.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Va,0,Vn),this.conchModel&&this.conchModel.addChildAt(Vn.conchModel,Va),Vn.parent=this;return Vn}throw new Error("appendChildAt:The index is out of bounds")},Va.getChildIndex=function(Vn){return this._childs.indexOf(Vn)},Va.getChildByName=function(Vn){var Va=this._childs;if(Va)for(var VU=0,Vx=Va.length;VU<Vx;VU++){var VD=Va[VU];if(VD.name===Vn)return VD}return null},Va._get$P=function(Vn){return this._$P[Vn]},Va._set$P=function(Vn,Va){return this.destroyed||(this._$P===VQ.PROP_EMPTY&&(this._$P={}),this._$P[Vn]=Va),Va},Va.getChildAt=function(Vn){return this._childs[Vn]},Va.setChildIndex=function(Vn,Va){var VU=this._childs;if(Va<0||Va>=VU.length)throw new Error("setChildIndex:The index is out of bounds.");var Vx=this.getChildIndex(Vn);if(Vx<0)throw new Error("setChildIndex:node is must child of this object.");return VU.splice(Vx,1),VU.splice(Va,0,Vn),this.conchModel&&(this.conchModel.removeChild(Vn.conchModel),this.conchModel.addChildAt(Vn.conchModel,Va)),this._childChanged(),Vn},Va._childChanged=function(Vn){},Va.removeChild=function(Vn){if(!this._childs)return Vn;var Va=this._childs.indexOf(Vn);return this.removeChildAt(Va)},Va.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},Va.removeChildByName=function(Vn){var Va=this.getChildByName(Vn);return Va&&this.removeChild(Va),Va},Va.removeChildAt=function(Vn){var Va=this.getChildAt(Vn);if(Va){for(var VU=this._childs.length-1,Vx=Vn;Vx<VU;++Vx)this._childs[Vx]=this._childs[Vx+1];this._childs.length=VU,this.conchModel&&this.conchModel.removeChild(Va.conchModel),Va.parent=null}return Va},Va.removeChildren=function(Vn,Va){if(void 0===Vn&&(Vn=0),void 0===Va&&(Va=2147483647),this._childs&&0<this._childs.length){var VU=this._childs;if(0===Vn&&Vp<=Va){var Vx=VU;this._childs=VQ.ARRAY_EMPTY}else Vx=VU.splice(Vn,Va-Vn);for(var VD=0,Vp=Vx.length;VD<Vp;VD++)Vx[VD].parent=null,this.conchModel&&this.conchModel.removeChild(Vx[VD].conchModel)}return this},Va.replaceChild=function(Vn,Va){var VU=this._childs.indexOf(Va);return-1<VU?(this._childs.splice(VU,1,Vn),this.conchModel&&(this.conchModel.removeChild(Va.conchModel),this.conchModel.addChildAt(Vn.conchModel,VU)),Va.parent=null,Vn.parent=this,Vn):null},Va._updateDisplayedInstage=function(){var Vn;Vn=this;var Va=Vk.stage;for(this._displayedInStage=!1;Vn;){if(Vn._getBit(1)){this._displayedInStage=Vn._displayedInStage;break}if(Vn==Va||Vn._displayedInStage){this._displayedInStage=!0;break}Vn=Vn.parent}},Va._setDisplay=function(Vn){this._displayedInStage!==Vn&&((this._displayedInStage=Vn)?this.event("display"):this.event("undisplay"))},Va._displayChild=function(Vn,Va){var VU=Vn._childs;if(VU)for(var Vx=0;Vx<VU.length;Vx++){var VD=VU[Vx];VD&&VD._getBit(1)&&(0<VD._childs.length?this._displayChild(VD,Va):VD._setDisplay(Va))}Vn._setDisplay(Va)},Va.contains=function(Vn){if(Vn===this)return!0;for(;Vn;){if(Vn.parent===this)return!0;Vn=Vn.parent}return!1},Va.timerLoop=function(Vn,Va,VU,Vx,VD,Vp){void 0===VD&&(VD=!0),void 0===Vp&&(Vp=!1),this.timer.loop(Vn,Va,VU,Vx,VD,Vp)},Va.timerOnce=function(Vn,Va,VU,Vx,VD){void 0===VD&&(VD=!0),this.timer._create(!1,!1,Vn,Va,VU,Vx,VD)},Va.frameLoop=function(Vn,Va,VU,Vx,VD){void 0===VD&&(VD=!0),this.timer._create(!0,!0,Vn,Va,VU,Vx,VD)},Va.frameOnce=function(Vn,Va,VU,Vx,VD){void 0===VD&&(VD=!0),this.timer._create(!0,!1,Vn,Va,VU,Vx,VD)},Va.clearTimer=function(Vn,Va){this.timer.clear(Vn,Va)},VX(0,Va,"numChildren",function(){return this._childs.length}),VX(0,Va,"destroyed",function(){return this._destroyed}),VX(0,Va,"parent",function(){return this._parent},function(Vn){this._parent!==Vn&&(Vn?(this._parent=Vn,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),Vn.displayedInStage&&this._displayChild(this,!0)),Vn._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=Vn))}),VX(0,Va,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),VQ.ARRAY_EMPTY=[],VQ.PROP_EMPTY={},VQ.NOTICE_DISPLAY=1,VQ.MOUSEENABLE=2,VQ}(),Van=function(Vn){function Vi(Vn){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,Vi.__super.call(this),this._padding=Vi._PADDING,this._spacing=Vi._SPACING,this._aligns=Vi._ALIGNS,this._font=Vq.EMPTY,this._ower=Vn}Vm(Vi,"laya.display.css.CSSStyle",Vn);var Va=Vi.prototype;return Va.destroy=function(){this._ower=null,this._font=null,this._rect=null},Va.inherit=function(Vn){this._font=Vn._font,this._spacing=Vn._spacing===Vi._SPACING?Vi._SPACING:Vn._spacing.slice(),this.lineHeight=Vn.lineHeight},Va._widthAuto=function(){return 0!=(262144&this._type)},Va.widthed=function(Vn){return 0!=(8&this._type)},Va._calculation=function(Vn,Va){if(Va.indexOf("%")<0)return!1;var Vx=this._ower,VD=Vx.parent,Vp=this._rect;function VQ(Vn,Va,VU){return Vn*VU[0]+Va*VU[1]+VU[2]}function VU(Vn){var Va=VD.width,VU=Vx.width;Vp.width&&(Vx.width=VQ(Va,VU,Vp.width)),Vp.height&&(Vx.height=VQ(Va,VU,Vp.height)),Vp.left&&(Vx.x=VQ(Va,VU,Vp.left)),Vp.top&&(Vx.y=VQ(Va,VU,Vp.top))}null===Vp&&(VD._getCSSStyle()._type|=524288,VD.on("resize",this,VU),this._rect=Vp={input:{}});var VV=Va.split(" ");return VV[0]=parseFloat(VV[0])/100,1==VV.length?VV[1]=VV[2]=0:(VV[1]=parseFloat(VV[1])/100,VV[2]=parseFloat(VV[2])),Vp[Vn]=VV,Vp.input[Vn]=Va,VU(),!0},Va.heighted=function(Vn){return 0!=(8192&this._type)},Va.size=function(Vn,Va){var VU=this._ower,Vx=!1;-1!==Vn&&Vn!=this._ower.width&&(this._type|=8,this._ower.width=Vn,Vx=!0),-1!==Va&&Va!=this._ower.height&&(this._type|=8192,this._ower.height=Va,Vx=!0),Vx&&(VU._layoutLater(),524288&this._type&&VU.event("resize",this))},Va._getAlign=function(){return this._aligns[0]},Va._getValign=function(){return this._aligns[1]},Va._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},Va._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new Vq(this._font))},Va.render=function(Vn,Va,VU,Vx){var VD=Vn.width,Vp=Vn.height;VU-=Vn.pivotX,Vx-=Vn.pivotY,this._bgground&&null!=this._bgground.color&&Va.ctx.fillRect(VU,Vx,VD,Vp,this._bgground.color),this._border&&this._border.color&&Va.drawRect(VU,Vx,VD,Vp,this._border.color.strColor,this._border.size)},Va.getCSSStyle=function(){return this},Va.cssText=function(Vn){this.attrs(Vi.parseOneCSS(Vn,";"))},Va.attrs=function(Vn){if(Vn)for(var Va=0,VU=Vn.length;Va<VU;Va++){var Vx=Vn[Va];this[Vx[0]]=Vx[1]}},Va.setTransform=function(Vn){"none"===Vn?this._tf=VV._TF_EMPTY:this.attrs(Vi.parseOneCSS(Vn,","))},Va.translate=function(Vn,Va){this._tf===VV._TF_EMPTY&&(this._tf=new VD),this._tf.translateX=Vn,this._tf.translateY=Va},Va.scale=function(Vn,Va){this._tf===VV._TF_EMPTY&&(this._tf=new VD),this._tf.scaleX=Vn,this._tf.scaleY=Va},Va._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},VX(0,Va,"block",Vn.prototype._$get_block,function(Vn){Vn?this._type|=1:this._type&=-2}),VX(0,Va,"valign",function(){return Vi._valigndef[this._aligns[1]]},function(Vn){this._aligns===Vi._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=Vi._valigndef[Vn]}),VX(0,Va,"height",null,function(Vn){if(this._type|=8192,"string"==typeof Vn){if(this._calculation("height",Vn))return;Vn=parseInt(Vn)}this.size(-1,Vn)}),VX(0,Va,"width",null,function(Vn){if(this._type|=8,"string"==typeof Vn){var Va=Vn.indexOf("auto");if(0<=Va&&(this._type|=262144,Vn=Vn.substr(0,Va)),this._calculation("width",Vn))return;Vn=parseInt(Vn)}this.size(Vn,-1)}),VX(0,Va,"fontWeight",function(){return this._font.weight},function(Vn){this._createFont().weight=Vn}),VX(0,Va,"left",null,function(Vn){var Va=this._ower;if("string"==typeof Vn){if("center"===Vn?Vn="50% -50% 0":"right"===Vn&&(Vn="100% -100% 0"),this._calculation("left",Vn))return;Vn=parseInt(Vn)}Va.x=Vn}),VX(0,Va,"_translate",null,function(Vn){this.translate(Vn[0],Vn[1])}),VX(0,Va,"absolute",function(){return 0!=(4&this._type)}),VX(0,Va,"top",null,function(Vn){var Va=this._ower;if("string"==typeof Vn){if("middle"===Vn?Vn="50% -50% 0":"bottom"===Vn&&(Vn="100% -100% 0"),this._calculation("top",Vn))return;Vn=parseInt(Vn)}Va.y=Vn}),VX(0,Va,"align",function(){return Vi._aligndef[this._aligns[0]]},function(Vn){this._aligns===Vi._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=Vi._aligndef[Vn]}),VX(0,Va,"bold",function(){return this._font.bold},function(Vn){this._createFont().bold=Vn}),VX(0,Va,"padding",function(){return this._padding},function(Vn){this._padding=Vn}),VX(0,Va,"leading",function(){return this._spacing[1]},function(Vn){"string"==typeof Vn&&(Vn=parseInt(Vn+"")),this._spacing===Vi._SPACING&&(this._spacing=[0,0]),this._spacing[1]=Vn}),VX(0,Va,"lineElement",function(){return 0!=(65536&this._type)},function(Vn){Vn?this._type|=65536:this._type&=-65537}),VX(0,Va,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(Vn){this.lineElement=!1,"right"===Vn?this._type|=32768:this._type&=-32769}),VX(0,Va,"textDecoration",function(){return this._font.decoration},function(Vn){this._createFont().decoration=Vn}),VX(0,Va,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(Vn){"nowrap"===Vn&&(this._type|=131072),"none"===Vn&&(this._type&=-131073)}),VX(0,Va,"background",null,function(Vn){Vn?(this._bgground||(this._bgground={}),this._bgground.color=Vn,this._ower.conchModel&&this._ower.conchModel.bgColor(Vn),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),VX(0,Va,"wordWrap",function(){return 0==(131072&this._type)},function(Vn){Vn?this._type&=-131073:this._type|=131072}),VX(0,Va,"color",function(){return this._font.color},function(Vn){this._createFont().color=Vn}),VX(0,Va,"password",function(){return this._font.password},function(Vn){this._createFont().password=Vn}),VX(0,Va,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(Vn){"none"===Vn?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=Vn),this._ower.conchModel&&this._ower.conchModel.bgColor(Vn),this._ower._renderType|=256}),VX(0,Va,"font",function(){return this._font.toString()},function(Vn){this._createFont().set(Vn)}),VX(0,Va,"weight",null,function(Vn){this._createFont().weight=Vn}),VX(0,Va,"letterSpacing",function(){return this._spacing[0]},function(Vn){"string"==typeof Vn&&(Vn=parseInt(Vn+"")),this._spacing===Vi._SPACING&&(this._spacing=[0,0]),this._spacing[0]=Vn}),VX(0,Va,"fontSize",function(){return this._font.size},function(Vn){this._createFont().size=Vn}),VX(0,Va,"italic",function(){return this._font.italic},function(Vn){this._createFont().italic=Vn}),VX(0,Va,"fontFamily",function(){return this._font.family},function(Vn){this._createFont().family=Vn}),VX(0,Va,"stroke",function(){return this._font.stroke[0]},function(Vn){this._createFont().stroke===Vq._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=Vn}),VX(0,Va,"strokeColor",function(){return this._font.stroke[1]},function(Vn){this._createFont().stroke===Vq._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=Vn}),VX(0,Va,"border",function(){return this._border?this._border.value:""},function(Vn){if("none"!=Vn){this._border||(this._border={});var Va=(this._border.value=Vn).split(" ");if(this._border.color=VB.create(Va[Va.length-1]),1==Va.length)return this._border.size=1,void(this._border.type="solid");var VU=0;0<Va[0].indexOf("px")?(this._border.size=parseInt(Va[0]),VU++):this._border.size=1,this._border.type=Va[VU],this._ower._renderType|=256}else this._border=null}),VX(0,Va,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(Vn){Vn?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==Vn?null:VB.create(Vn),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),VX(0,Va,"position",function(){return 4&this._type?"absolute":""},function(Vn){"absolute"==Vn?this._type|=4:this._type&=-5}),VX(0,Va,"display",null,function(Vn){switch(Vn){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),VX(0,Va,"paddingLeft",function(){return this.padding[3]}),VX(0,Va,"paddingTop",function(){return this.padding[0]}),VX(0,Va,"_scale",null,function(Vn){this._ower.scale(Vn[0],Vn[1])}),VX(0,Va,"_rotate",null,function(Vn){this._ower.rotation=Vn}),Vi.parseOneCSS=function(Vn,Va){for(var VU,Vx=[],VD=Vn.split(Va),Vp=0,VQ=VD.length;Vp<VQ;Vp++){var VV=VD[Vp],Vy=VV.indexOf(":"),VR=VV.substr(0,Vy).replace(/^\s+|\s+$/g,"");if(0!=VR.length){var VX=VV.substr(Vy+1).replace(/^\s+|\s+$/g,""),Vz=[VR,VX];switch(VR){case"italic":case"bold":Vz[1]="true"==VX;break;case"line-height":Vz[0]="lineHeight",Vz[1]=parseInt(VX);break;case"font-size":Vz[0]="fontSize",Vz[1]=parseInt(VX);break;case"padding":1<(VU=VX.split(" ")).length||(VU[1]=VU[2]=VU[3]=VU[0]),Vz[1]=[parseInt(VU[0]),parseInt(VU[1]),parseInt(VU[2]),parseInt(VU[3])];break;case"rotate":Vz[0]="_rotate",Vz[1]=parseFloat(VX);break;case"scale":VU=VX.split(" "),Vz[0]="_scale",Vz[1]=[parseFloat(VU[0]),parseFloat(VU[1])];break;case"translate":VU=VX.split(" "),Vz[0]="_translate",Vz[1]=[parseInt(VU[0]),parseInt(VU[1])];break;default:(Vz[0]=Vi._CSSTOVALUE[VR])||(Vz[0]=VR)}Vx.push(Vz)}}return Vx},Vi.parseCSS=function(Vn,Va){for(var VU;null!=(VU=Vi._parseCSSRegExp.exec(Vn));)Vi.styleSheets[VU[1]]=Vi.parseOneCSS(VU[2],";")},Vi.EMPTY=new Vi(null),Vi._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},Vi._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),Vi._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},Vi._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},Vi.styleSheets={},Vi.ALIGN_CENTER=1,Vi.ALIGN_RIGHT=2,Vi.VALIGN_MIDDLE=1,Vi.VALIGN_BOTTOM=2,Vi._CSS_BLOCK=1,Vi._DISPLAY_NONE=2,Vi._ABSOLUTE=4,Vi._WIDTH_SET=8,Vi._PADDING=[0,0,0,0],Vi._RECT=[-1,-1,-1,-1],Vi._SPACING=[0,0],Vi._ALIGNS=[0,0,0],Vi.ADDLAYOUTED=512,Vi._NEWFONT=4096,Vi._HEIGHT_SET=8192,Vi._BACKGROUND_SET=16384,Vi._FLOAT_RIGHT=32768,Vi._LINE_ELEMENT=65536,Vi._NOWARP=131072,Vi._WIDTHAUTO=262144,Vi._LISTERRESZIE=524288,Vi}(VV),VUn=function(Vn){function VQ(){this.url=null,this.audio=null,this.loaded=!1,VQ.__super.call(this)}Vm(VQ,"laya.media.h5audio.AudioSound",VR);var Va=VQ.prototype;return Va.dispose=function(){var Vn=VQ._audioCache[this.url];Vn&&(Vn.src="",delete VQ._audioCache[this.url])},Va.load=function(Vn){var Va;if(Vn=VG.formatURL(Vn),(this.url=Vn)==VZ._tMusic?(VQ._initMusicAudio(),(Va=VQ._musicAudio).src!=Vn&&(VQ._audioCache[Va.src]=null,Va=null)):Va=VQ._audioCache[Vn],Va&&2<=Va.readyState)this.event("complete");else{Va||(Va=Vn==VZ._tMusic?(VQ._initMusicAudio(),VQ._musicAudio):Vf.createElement("audio"),(VQ._audioCache[Vn]=Va).src=Vn),Va.addEventListener("canplaythrough",Vx),Va.addEventListener("error",VD);var VU=this;(this.audio=Va).load?Va.load():VD()}function Vx(){Vp(),VU.loaded=!0,VU.event("complete")}function VD(){Va.load=null,Vp(),VU.event("error")}function Vp(){Va.removeEventListener("canplaythrough",Vx),Va.removeEventListener("error",VD)}},Va.play=function(Vn,Va,VU){if(void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),!this.url)return null;var Vx,VD;if(!(Vx=this.url==VZ._tMusic?VQ._musicAudio:VQ._audioCache[this.url]))return null;VD=VS.getItem("audio:"+this.url),VI.isConchApp?VD||((VD=Vf.createElement("audio")).src=this.url):this.url==VZ._tMusic?(VQ._initMusicAudio(),(VD=VQ._musicAudio).src=this.url):VD=VD||Vx.cloneNode(!0);var Vp=new Vin(VD);return Vp.url=this.url,Vp.loops=Va,Vp.startTime=Vn,Vp.startHandler=VU,Vp.play(!1),VZ.addChannel(Vp),Vp},VX(0,Va,"duration",function(){var Vn;return(Vn=VQ._audioCache[this.url])?Vn.duration:0}),VQ._initMusicAudio=function(){VQ._musicAudio||(VQ._musicAudio||(VQ._musicAudio=Vf.createElement("audio")),VI.isConchApp||Vf.document.addEventListener("mousedown",VQ._makeMusicOK))},VQ._makeMusicOK=function(){Vf.document.removeEventListener("mousedown",VQ._makeMusicOK),VQ._musicAudio.src?VQ._musicAudio.play():(VQ._musicAudio.src="",VQ._musicAudio.load())},VQ._audioCache={},VQ._musicAudio=null,VQ}(),Vxn=function(Vn){function Va(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,Va.__super.call(this)}Vm(Va,"laya.media.SoundChannel",VR);var VU=Va.prototype;return VU.play=function(){},VU.stop=function(){},VU.pause=function(){},VU.resume=function(){},VU.__runComplete=function(Vn){Vn&&Vn.run()},VX(0,VU,"volume",function(){return 1},function(Vn){}),VX(0,VU,"position",function(){return 0}),VX(0,VU,"duration",function(){return 0}),Va}(),VDn=function(Vn){function Va(){Va.__super.call(this)}Vm(Va,"laya.media.Sound",VR);var VU=Va.prototype;return VU.load=function(Vn){},VU.play=function(Vn,Va,VU){return void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),null},VU.dispose=function(){},VX(0,VU,"duration",function(){return 0}),Va}(),Vpn=function(Vn){function VD(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,VD.__super.call(this)}Vm(VD,"laya.media.webaudio.WebAudioSound",VR);var Va=VD.prototype;return Va.load=function(Vn){this.url=Vn,this.audioBuffer=VD._dataCache[Vn],this.audioBuffer?this._loaded(this.audioBuffer):(VD.e.on("loaded:"+Vn,this,this._loaded),VD.e.on("err:"+Vn,this,this._err),VD.__loadingSound[Vn]||(VD.__loadingSound[Vn]=!0,Vk.loader.load(Vn,VA.create(this,this.onloaded),null,VVn.BUFFER,4,!1,null,!0)))},Va.onloaded=function(Vn){Vn||this._err(),this._disposed?this._removeLoadEvents():(this.data=Vn,VD.buffs.push({buffer:this.data,url:this.url}),VD.decode())},Va._err=function(){if(this._removeLoadEvents(),VD.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var Vn,Va,VU,Vx=0;for(Vn=(Va=this.__toPlays).length,Vx=0;Vx<Vn;Vx++)(VU=Va[Vx])[3]&&!VU[3].isStopped&&VU[3].event("error");this.__toPlays.length=0}},Va._loaded=function(Vn){this._removeLoadEvents(),this._disposed||(this.audioBuffer=Vn,this.loaded=!0,this.event("complete"))},Va._removeLoadEvents=function(){VD.e.off("loaded:"+this.url,this,this._loaded),VD.e.off("err:"+this.url,this,this._err)},Va.__playAfterLoaded=function(){if(this.__toPlays){var Vn,Va,VU,Vx=0;for(Vn=(Va=this.__toPlays).length,Vx=0;Vx<Vn;Vx++)(VU=Va[Vx])[3]&&!VU[3].isStopped&&this.play(VU[0],VU[1],VU[2],VU[3]);this.__toPlays.length=0}},Va.play=function(Vn,Va,VU,Vx){return void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),Vx=Vx||new Vqn,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([Vn,Va,VU,Vx]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),Vx.url=this.url,Vx.loops=Va,Vx.audioBuffer=this.audioBuffer,Vx.startTime=Vn,Vx.startHandler=VU,Vx.play(!1),VZ.addChannel(Vx),Vx},Va.dispose=function(){this._disposed=!0,delete VD._dataCache[this.url],delete VD.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},VX(0,Va,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),VD.decode=function(){if(!(VD.buffs.length<=0||VD.isDecoding))if(VD.isDecoding=!0,(VD.tInfo=VD.buffs.shift())&&VD.tInfo.buffer&&VD.tInfo.buffer.byteLength)try{VD.ctx.decodeAudioData(VD.tInfo.buffer,VD._done,VD._fail)}catch(Vn){console.error("decodeAudioData error  byteLength:"+VD.tInfo.buffer.byteLength+"  url:"+VD.tInfo.url)}else VD._fail()},VD._done=function(Vn){VD.e.event("loaded:"+VD.tInfo.url,Vn),VD._dataCache[VD.tInfo.url]=Vn,VD.isDecoding=!1,VD.decode()},VD._fail=function(){VD.e.event("err:"+VD.tInfo.url,null),VD.isDecoding=!1,VD.decode()},VD._playEmptySound=function(){if(null!=VD.ctx){if(VD._emptySource&&(VD._emptySource.stop(),VD._emptySource.disconnect(0),!Vqn._tryCleanFailed))try{VD._emptySource.buffer=null}catch(Vn){Vqn._tryCleanFailed=!0}var Vn=VD.ctx.createBufferSource();Vn.buffer=VD._miniBuffer,Vn.connect(VD.ctx.destination),Vn.start(0,0,0),VD._emptySource=Vn}},VD._unlock=function(){VD._unlocked||(VD._playEmptySound(),"running"==VD.ctx.state?(Vf.document.removeEventListener("mousedown",VD._unlock,!0),Vf.document.removeEventListener("touchend",VD._unlock,!0),Vf.document.removeEventListener("touchstart",VD._unlock,!0),VD._unlocked=!0):"suspended"==VD.ctx.state&&VZ._recoverWebAudio())},VD.initWebAudio=function(){"running"!=VD.ctx.state&&(VD._unlock(),Vf.document.addEventListener("mousedown",VD._unlock,!0),Vf.document.addEventListener("touchend",VD._unlock,!0),Vf.document.addEventListener("touchstart",VD._unlock,!0))},VD._emptySource=null,VD._dataCache={},VD.buffs=[],VD.isDecoding=!1,VD._unlocked=!1,VD.tInfo=null,VD.__loadingSound={},Vy(VD,["window",function(){return this.window=Vf.window},"webAudioEnabled",function(){return this.webAudioEnabled=VD.window.AudioContext||VD.window.webkitAudioContext||VD.window.mozAudioContext},"ctx",function(){return this.ctx=VD.webAudioEnabled?new(VD.window.AudioContext||VD.window.webkitAudioContext||VD.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=VD.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new VR}]),VD}(),VQn=function(Vn){function Va(){this._responseType=null,this._data=null,Va.__super.call(this),this._http=new Vf.window.XMLHttpRequest}Vm(Va,"laya.net.HttpRequest",VR);var VU=Va.prototype;return VU.send=function(Vn,Va,VU,Vx,VD){void 0===VU&&(VU="get"),void 0===Vx&&(Vx="text"),this._responseType=Vx,this._data=null;var Vp=this,VQ=this._http;if(VQ.open(VU,Vn,!0),VD)for(var VV=0;VV<VD.length;VV++)VQ.setRequestHeader(VD[VV++],VD[VV]);else VI.isConchApp||(Va&&"string"!=typeof Va?VQ.setRequestHeader("Content-Type","application/json"):VQ.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));VQ.responseType="arraybuffer"!==Vx?"text":"arraybuffer",VQ.onerror=function(Vn){Vp._onError(Vn)},VQ.onabort=function(Vn){Vp._onAbort(Vn)},VQ.onprogress=function(Vn){Vp._onProgress(Vn)},VQ.onload=function(Vn){Vp._onLoad(Vn)},VQ.send(Va)},VU._onProgress=function(Vn){Vn&&Vn.lengthComputable&&this.event("progress",Vn.loaded/Vn.total)},VU._onAbort=function(Vn){this.error("Request was aborted by user")},VU._onError=function(Vn){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},VU._onLoad=function(Vn){var Va=this._http,VU=void 0!==Va.status?Va.status:200;200===VU||204===VU||0===VU?this.complete():this.error("["+Va.status+"]"+Va.statusText+":"+Va.responseURL)},VU.error=function(Vn){this.clear(),this.event("error",Vn)},VU.complete=function(){this.clear();var Va=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=Vt.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(Vn){Va=!1,this.error(Vn.message)}Va&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},VU.clear=function(){var Vn=this._http;Vn.onerror=Vn.onabort=Vn.onprogress=Vn.onload=null},VX(0,VU,"url",function(){return this._http.responseURL}),VX(0,VU,"http",function(){return this._http}),VX(0,VU,"data",function(){return this._data}),Va}(),VVn=function(Vn){function V$(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,V$.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1,this._base64=!1}Vm(V$,"laya.net.Loader",VR);var Va=V$.prototype;return Va.load=function(Vn,Va,VU,Vx,VD){if(Vn&&""!=Vn||console.error("Loader 加载的url不合法 "+Vn),void 0===VU&&(VU=!0),void 0===VD&&(VD=!1),this._url=Vn,this._base64=!1,0===Vn.indexOf("data:image")?(this._base64=!0,this._type=Va="image"):this._type=Va||(Va=this.getTypeFromUrl(Vn)),this._cache=VU,this._data=null,!VD&&V$.loadedMap[Vn])return this._data=V$.loadedMap[Vn],this.event("progress",1),void this.event("complete",this._data);if(Vx&&V$.setGroup(Vn,Vx),null!=V$.parserMap[Va])return this._customParse=!0,void(V$.parserMap[Va]instanceof laya.utils.Handler?V$.parserMap[Va].runWith(this):V$.parserMap[Va].call(null,this));if("image"===Va||"htmlimage"===Va||"nativeimage"===Va)return this._loadImage(Vn);if("ttf"===Va)return this._loadTTF(Vn);switch(Va){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:Va}V$.preLoadedMap[Vn]?this.onLoaded(V$.preLoadedMap[Vn]):VQ.resMgrLoad(Vn,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},Va.getTypeFromUrl=function(Vn){var Va=Vt.getFileExtension(Vn);return Va?V$.typeMap[Va]:(console.warn("Not recognize the resources suffix",Vn),"text")},Va._loadTTF=function(Vn){Vn=VG.formatURL(Vn);var Va=new VH;Va.complete=VA.create(this,this.onLoaded),Va.load(Vn)},Va._loadBase64Image=function(Va){Va=VG.formatURL(Va);var VU,Vn=this;function Vx(){VU.onload=null,VU.onerror=null,delete V$.imgCache[Va]}function VD(){Vx(),Vn.onLoaded(VU)}function Vp(){Vx(),Vn.event("error","Load image failed")}"nativeimage"===this._type?((VU=new Vf.window.Image).crossOrigin="",VU.onload=VD,VU.onerror=Vp,VU.src=Va,V$.imgCache[Va]=VU):new VWn.create(Va,{onload:VD,onerror:Vp,onCreate:function(Vn){VU=Vn,V$.imgCache[Va]=Vn}})},Va._loadImage=function(Vn){this._base64?this._loadBase64Image(Vn):VQ.imgMgrLoad(Vn,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},Va._loadImageComplete=function(Vn,Va,VU){if(null!=VU)if(VU instanceof ArrayBuffer){var Vx=new DataView(VU),VD=new laya.webgl.resource.WebGLImage(new Uint8Array(VU,8),Vn,0,!1,Vx.getUint32(0),Vx.getUint32(4));this.onLoaded(VD)}else if(VU instanceof VXn)V$.imgMgrSet[Vn]=Va,VQ.imgMgrLock(Vn,V$.imgMgrSet[Vn]),this._url=Vn,this.complete(VU);else{var Vp=-1!=Vn.indexOf(".png",Vn.length-4)?6408:6407;VD=new laya.webgl.resource.WebGLImage(VU,Vn,Vp,!1,VU.width,VU.height);this.onLoaded(VD)}else this.event("error","Load image failed")},Va.imageCancel=function(Vn,Va,VU){VQ.imgMgrCancel&&VQ.imgMgrCancel(Vn,this._onImageCallback)},Va._loadSound=function(Vn){var Va=new VZ._soundClass,VU=this;function Vx(){Va.offAll()}Va.on("complete",this,function(){Vx(),VU.onLoaded(Va)}),Va.on("error",this,function(){Vx(),Va.dispose(),VU.event("error","Load sound failed")}),Va.load(Vn)},Va.onProgress=function(Vn){"atlas"===this._type?this.event("progress",.3*Vn):this.event("progress",Vn)},Va.onError=function(Vn){this.event("error",Vn)},Va._loadedComplete=function(Vn,Va,VU){if(null!=VU)switch(this._type){case"atlas":case"plf":case"json":var Vx=new VF(VU);this.onLoaded(JSON.parse(Vx.readUTFBytes()));break;case"font":Vx=new VF(VU);this.onLoaded(Vt.parseXMLFromString(Vx.readUTFBytes()));break;default:this.onLoaded(VU)}else this.event("error",Vn)},Va.onLoaded=function(Vn){var Va=this._type;if("plf"==Va)this.parsePLFData(Vn),this.complete(Vn);else if("image"===Va){var VU=new VXn(Vn);VU.url=this._url,this.complete(VU)}else if("sound"===Va||"htmlimage"===Va||"nativeimage"===Va)this.complete(Vn);else if("atlas"===Va){if(!Vn.src&&!Vn._setContext){if(!this._data){if((this._data=Vn).meta&&Vn.meta.image)for(var Vx=Vn.meta.image.split(","),VD=0<=this._url.indexOf("/")?"/":"\\",Vp=this._url.lastIndexOf(VD),VQ=0<=Vp?this._url.substr(0,Vp+1):"",VV=0,Vy=Vx.length;VV<Vy;VV++)Vx[VV]=VQ+Vx[VV];else Vx=[this._url.replace(".json",".png")];Vx.reverse(),Vn.toLoads=Vx,Vn.pics=[]}return this.event("progress",.3+1/Vx.length*.6),this._loadImage(Vx.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(Vn),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var VR=this._data.frames,VX=this._url.split("?")[0],Vz=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:VX.substring(0,VX.lastIndexOf("."))+"/",Vi=this._data.pics,Vq=VG.formatURL(this._url),VE=V$.atlasMap[Vq]||(V$.atlasMap[Vq]=[]);VE.dir=Vz;var Vm=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var Vb in Vm=parseFloat(this._data.meta.scale),VR){var VP,VA=VR[Vb],VT=Vi[VA.frame.idx?VA.frame.idx:0],VK=VG.formatURL(Vz+Vb);VT.scaleRate=Vm,VP=VXn.create(VT,VA.frame.x,VA.frame.y,VA.frame.w,VA.frame.h,VA.spriteSourceSize.x,VA.spriteSourceSize.y,VA.sourceSize.w,VA.sourceSize.h),V$.cacheRes(VK,VP),V$.keepCache(this._url,Vz+Vb),VP.url=VK,VE.push(VK)}else for(Vb in VR)VT=Vi[(VA=VR[Vb]).frame.idx?VA.frame.idx:0],VK=VG.formatURL(Vz+Vb),V$.cacheRes(VK,VXn.create(VT,VA.frame.x,VA.frame.y,VA.frame.w,VA.frame.h,VA.spriteSourceSize.x,VA.spriteSourceSize.y,VA.sourceSize.w,VA.sourceSize.h)),V$.loadedMap[VK].url=VK,V$.keepCache(this._url,Vz+Vb),VE.push(VK);delete this._data.pics,this.complete(this._data)}else if("font"==Va){if(!Vn.src)return this._data=Vn,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var VY=new VM;VY.parseFont(this._data,Vn);var VW=this._url.split(".fnt")[0].split("/"),Vk=VW[VW.length-1];Vbn.registerBitmapFont(Vk,VY),this._data=VY,this.complete(this._data)}else if("pkm"==Va){var VN=VWn.create(Vn,this._url),V_=new VXn(VN);V_.url=this._url,this.complete(V_)}else this.complete(Vn)},Va.parsePLFData=function(Vn){var Va,VU,Vx;for(Va in Vn)switch(Vx=Vn[Va],Va){case"json":case"text":for(VU in Vx)V$.preLoadedMap[VG.formatURL(VU)]=Vx[VU];break;default:for(VU in Vx)V$.preLoadedMap[VG.formatURL(VU)]=Vx[VU]}},Va.complete=function(Vn){this._data=Vn,this._customParse?this.event("loaded",Vn instanceof Array?[Vn]:Vn):(V$._loaders.push(this),V$._isWorking||V$.checkNext())},Va.endLoad=function(Vn){Vn&&(this._data=Vn),this._cache&&V$.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},VX(0,Va,"url",function(){return this._url}),VX(0,Va,"data",function(){return this._data}),VX(0,Va,"cache",function(){return this._cache}),VX(0,Va,"type",function(){return this._type}),V$.checkNext=function(){V$._isWorking=!0;for(var Vn=Vf.now();V$._startIndex<V$._loaders.length;)if(Vf.now(),V$._loaders[V$._startIndex].endLoad(),V$._startIndex++,Vf.now()-Vn>V$.maxTimeOut)return console.warn("loader callback cost a long time:"+(Vf.now()-Vn)+" url="+V$._loaders[V$._startIndex-1].url),void Vk.timer.frameOnce(1,null,V$.checkNext);V$._loaders.length=0,V$._startIndex=0,V$._isWorking=!1},V$.clearRes=function(Vn,Va){if(null!=Vn){void 0===Va&&(Va=!1),Vn=VG.formatURL(Vn);var VU=V$.getAtlas(Vn);if(VU){for(var Vx=0,VD=VU.length;Vx<VD;Vx++){var Vp=VU[Vx],VQ=V$.getRes(Vp);delete V$.loadedMap[Vp],V$.clearCache(Vn.substring(VG.basePath.length),Vp.substring(VG.basePath.length)),VQ&&VQ.destroy(Va)}VU.length=0,delete V$.atlasMap[Vn],delete V$.loadedMap[Vn]}else{var VV=V$.loadedMap[Vn];VV&&(delete V$.loadedMap[Vn],VV instanceof laya.resource.Texture&&VV.bitmap&&VV.destroy(Va))}}},V$.clearTextureRes=function(Vn){Vn=VG.formatURL(Vn);var Va=laya.net.Loader.getAtlas(Vn),VU=Va&&0<Va.length?laya.net.Loader.getRes(Va[0]):laya.net.Loader.getRes(Vn);VU&&VU.bitmap&&(VI.isConchApp&&!VI.isConchWebGL?VU.bitmap.source.releaseTexture&&VU.bitmap.source.releaseTexture():null==VU.bitmap._atlaser&&VU.bitmap.releaseResource(!0))},V$.getRes=function(Vn){return V$.loadedMap[VG.formatURL(Vn)]},V$.getAtlas=function(Vn){return V$.atlasMap[VG.formatURL(Vn)]},V$.cacheRes=function(Vn,Va){Vn=VG.formatURL(Vn),null!=V$.loadedMap[Vn]?console.warn("Resources already exist,is repeated loading:",Vn):V$.loadedMap[Vn]=Va},V$.setGroup=function(Vn,Va){V$.groupMap[Va]||(V$.groupMap[Va]=[]),V$.groupMap[Va].push(Vn)},V$.clearResByGroup=function(Vn){if(V$.groupMap[Vn]){var Va=V$.groupMap[Vn],VU=0,Vx=Va.length;for(VU=0;VU<Vx;VU++)V$.clearRes(Va[VU]);Va.length=0}},V$.keepCache=function(Vn,Va){if(Vn&&Va){var VU=V$.cacheSet[Va];VU?-1==VU.indexOf(Vn)&&VU.push(Vn):V$.cacheSet[Va]=[Vn]}},V$.clearCache=function(Vn,Va){if(Vn&&Va){var VU=V$.cacheSet[Va];if(VU){var Vx=VU.indexOf(Vn);if(-1!==Vx){var VD=VU.length-1;0==VD?(delete V$.cacheSet[Va],0<V$.imgMgrSet[Va]?VQ.imgMgrFree(Va,V$.imgMgrSet[Va]):V$.clearRes(Va,!0)):(VU[Vx]=VU[VD],VU.length=VD)}}}},V$.saveObject=function(Vn,Va,VU){if(Va&&Vn){var Vx=V$.objectSet[Vn];Vx?(console.warn("Loader.saveObject: "+Vn),Vx[0]=Va,Vx[1]=VU):V$.objectSet[Vn]=[Va,VU,[]]}},V$.findObject=function(Vn){if(Vn){var Va=V$.objectSet[Vn];if(Va)return Va[0]}return null},V$.keepObject=function(Vn,Va){if(Vn&&Va){var VU=V$.objectSet[Va];VU&&-1===VU[2].indexOf(Vn)&&VU[2].push(Vn)}},V$.clearObject=function(Vn,Va){if(Vn&&Va){var VU=V$.objectSet[Va];if(VU){var Vx=VU[2],VD=Vx.indexOf(Vn);if(-1!==VD){var Vp=Vx.length-1;0==Vp?(delete V$.objectSet[Va],VU[1]&&VU[1].call(null,VU[0])):(Vx[VD]=Vx[Vp],Vx.length=Vp)}}}},V$.TEXT="text",V$.JSON="json",V$.XML="xml",V$.BUFFER="arraybuffer",V$.IMAGE="image",V$.SOUND="sound",V$.ATLAS="atlas",V$.FONT="font",V$.TTF="ttf",V$.PLF="plf",V$.PKM="pkm",V$.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},V$.parserMap={},V$.groupMap={},V$.maxTimeOut=100,V$.loadedMap={},V$.preLoadedMap={},V$.atlasMap={},V$._loaders=[],V$._isWorking=!1,V$._startIndex=0,V$.imgCache={},V$.cacheSet={},V$.objectSet={},V$.imgMgrSet={},V$}(),Vyn=function(Vn){var Vi;function Vq(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},Vq.__super.call(this);for(var Vn=0;Vn<this._maxPriority;Vn++)this._resInfos[Vn]=[]}Vm(Vq,"laya.net.LoaderManager",VR);var Va=Vq.prototype;return Va.create=function(Vn,VU,Va,Vx,VD,Vp,VQ,VV){if(null==Vp&&(Vp=2),null==VQ&&(VQ=!0),Vn instanceof Array){var Vy=Vn,VR=Vy.length,VX=0;if(Va)var Vz=VA.create(Va.caller,Va.method,Va.args,!1);for(var Vi=0;Vi<VR;Vi++){var Vq=Vy[Vi];"string"==typeof Vq&&(Vq=Vy[Vi]={url:Vq}),Vq.progress=0}for(Vi=0;Vi<VR;Vi++){Vq=Vy[Vi];var VE=Va?VA.create(null,VP,[Vq],!1):null,Vm=Va||VU?VA.create(null,Vb,[Vq]):null;this._create(Vq.url,Vm,VE,Vq.clas||Vx,Vq.params||VD,null!=Vq.priority&&0<=Vq.priority?Vq.priority:Vp,VQ,Vq.group||VV)}function Vb(Vn,Va){VX++,Vn.progress=1,VX===VR&&VU&&VU.run()}function VP(Vn,Va){Vn.progress=Va;for(var VU=0,Vx=0;Vx<VR;Vx++){VU+=Vy[Vx].progress}var VD=VU/VR;Vz.runWith(VD)}return!0}return this._create(Vn,VU,Va,Vx,VD,Vp,VQ,VV)},Va._create=function(Va,VU,Vn,Vx,VD,Vp,VQ,VV){Va&&""!=Va||console.error("加载的url不合法 "+Va),null==Vp&&(Vp=2),null==VQ&&(VQ=!0);var Vy=VG.formatURL(Va),VR=this.getRes(Vy);if(VR)!VR.hasOwnProperty("loaded")||VR.loaded?(Vn&&Vn.runWith(1),VU&&VU.run()):VU&&Vk.loader._createListener(Va,VU.caller,VU.method,VU.args,!0,!1);else{var VX=Vt.getFileExtension(Va),Vz=Vq.createMap[VX];if(!Vz)throw new Error("LoaderManager:unknown file("+Va+") extension with: "+VX+".");Vx||(Vx=Vz[0]);var Vi=Vz[1];if("atlas"==VX)this.load(Va,VU,Vn,Vi,Vp,VQ);else{Vx===VXn&&(Vi="htmlimage"),(VR=Vx?new Vx:null).hasOwnProperty("_loaded")&&(VR._loaded=!1),VR._setUrl(Va),VV&&VR._setGroup(VV),this._createLoad(VR,Va,VA.create(null,function(Vn){VR&&!VR.destroyed&&Vn&&VR.onAsynLoaded.call(VR,Va,Vn,VD),VU&&VU.run();Vk.loader.event(Va)}),Vn,Vi,Vp,!1,VV,!0),VQ&&this.cacheRes(Vy,VR)}}return VR},Va.load=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){Vn&&""!=Vn||console.error("加载的url不合法 "+Vn);var Vy=this;if(null==VD&&(VD=2),null==Vp&&(Vp=!0),void 0===VV&&(VV=!1),Vn instanceof Array)return this._loadAssets(Vn,Va,VU,Vx,VD,Vp,VQ);var VR=VVn.getRes(Vn);if(null!=VR)Vk.timer.frameOnce(1,null,function(){VU&&VU.runWith(1),Va&&Va.runWith(VR),Vy._loaderCount||Vy.event("complete")});else{var VX=Vq._resMap[Vn];VX?(Va&&VX._createListener("complete",Va.caller,Va.method,Va.args,!1,!1),VU&&VX._createListener("progress",VU.caller,VU.method,VU.args,!1,!1)):((VX=this._infoPool.length?this._infoPool.pop():new Vi).url=Vn,VX.clas=null,VX.type=Vx,VX.cache=Vp,VX.group=VQ,VX.ignoreCache=VV,VX.priority=VD,Va&&VX.on("complete",Va.caller,Va.method,Va.args),VU&&VX.on("progress",VU.caller,VU.method,VU.args),Vq._resMap[Vn]=VX,VD=VD<this._maxPriority?0<=VD?VD:0:this._maxPriority-1,this._resInfos[VD].push(VX),this._next())}return this},Va.cancel=function(Vn,Va,VU){if(VR=Vq._resMap[Vn]){Va&&VR.off("complete",Va.caller,Va.method,!1),VU&&VR.off("progress",VU.caller,VU.method,!1);var Vx=VR.getListener("complete"),VD=VR.getListener("progress");if(!(Vx&&Vx.head||VD&&VD.head)){if(VR.loader){var Vp=VR.loader;Vp.imageCancel(Vn),Vp.offAll(),Vp._data=null,Vp._customParse=!1,Vp._url=null,Vp._class=null,Vp._type=null,this._loaders.push(Vp),this._loaderCount--,delete this._loaderMap[VR.url]}for(var VQ=0;VQ<this._maxPriority;VQ++)for(var VV=this._resInfos[VQ],Vy=VV.length-1;-1<Vy;Vy--){var VR;(VR=VV[Vy])&&VR.url===Vn&&(VV[Vy]=null,VR.destroy(),VR.offAll(),this._infoPool.push(VR))}delete Vq._resMap[Vn],this._next()}}},Va._createLoad=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){var VR=this;if(null==Vp&&(Vp=2),null==VQ&&(VQ=!0),void 0===Vy&&(Vy=!1),Va instanceof Array)return this._loadAssets(Va,VU,Vx,VD,Vp,VQ,VV);var VX=VVn.getRes(Va);if(null!=VX)Vk.timer.frameOnce(1,null,function(){Vx&&Vx.runWith(1),VU&&VU.runWith(VX),VR._loaderCount||VR.event("complete")});else{var Vz=Vq._resMap[Va];Vz?(VU&&Vz._createListener("complete",VU.caller,VU.method,VU.args,!1,!1),Vx&&Vz._createListener("progress",Vx.caller,Vx.method,Vx.args,!1,!1)):((Vz=this._infoPool.length?this._infoPool.pop():new Vi).url=Va,Vz.clas=Vn,Vz.type=VD,Vz.cache=VQ,Vz.group=VV,Vz.ignoreCache=Vy,Vz.priority=Vp,VU&&Vz.on("complete",VU.caller,VU.method,VU.args),Vx&&Vz.on("progress",Vx.caller,Vx.method,Vx.args),Vq._resMap[Va]=Vz,Vp=Vp<this._maxPriority?0<=Vp?Vp:0:this._maxPriority-1,this._resInfos[Vp].push(Vz),this._next())}return this},Va._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var Vn=0;Vn<this._maxPriority;Vn++)for(var Va=this._resInfos[Vn];0<Va.length;){var VU=Va.shift();if(VU)return this._doLoad(VU)}this._loaderCount||this.event("complete")}},Va._doLoad=function(Va){var VU=this._loaders.length?this._loaders.pop():new VVn;this._loaderCount++,(this._loaderMap[Va.url]=VU).on("complete",null,VD),VU.on("progress",null,function(Vn){Va.event("progress",Vn)}),VU.on("error",null,function(Vn){VD(null)}),Va.loader=VU;var Vx=this;function VD(Vn){VU.offAll(),VU._data=null,VU._customParse=!1,VU._url=null,VU._class=null,VU._type=null,Vx._loaders.push(VU),Vx._loaderCount--,delete Vx._loaderMap[Va.url],Vx._endLoad(Va,Vn instanceof Array?[Vn]:Vn),Vx._next()}VU._class=Va.clas,1<=Va.priority?(VU.priority=Va.priority,VU.realTime=!1):(VU.priority=0,VU.realTime=!0),VU.load(Va.url,Va.type,Va.cache,Va.group,Va.ignoreCache)},Va._endLoad=function(Vn,Va){var VU=Vn.url;if(null==Va){var Vx=this._failRes[VU]||0;if(Vx<this.retryNum)return console.warn("[warn]Retry to load:",VU),this._failRes[VU]=Vx+1,void Vk.timer.once(this.retryDelay,this,this._addReTry,[Vn],!1);console.warn("[error]Failed to load:",VU),this.event("error",VU)}this._failRes[VU]&&(this._failRes[VU]=0),delete Vq._resMap[VU],Vn.event("complete",Va),Vn.destroy(),Vn.offAll(),this._infoPool.push(Vn)},Va._addReTry=function(Vn){this._resInfos[this._maxPriority-1].push(Vn),this._next()},Va.clearRes=function(Vn,Va){void 0===Va&&(Va=!1),VVn.clearRes(Vn,Va)},Va.getRes=function(Vn){return VVn.getRes(Vn)},Va.cacheRes=function(Vn,Va){VVn.cacheRes(Vn,Va)},Va.clearTextureRes=function(Vn){VVn.clearTextureRes(Vn)},Va.setGroup=function(Vn,Va){VVn.setGroup(Vn,Va)},Va.clearResByGroup=function(Vn){VVn.clearResByGroup(Vn)},Va.clearUnLoaded=function(){for(var Vn=0;Vn<this._maxPriority;Vn++){for(var Va=this._resInfos[Vn],VU=Va.length-1;-1<VU;VU--){var Vx=Va[VU];Vx&&(Vx.destroy(),Vx.offAll(),this._infoPool.push(Vx))}Va.length=0}this._loaderCount=0,Vq._resMap={}},Va.cancelLoadByUrls=function(Vn){if(Vn)for(var Va=0,VU=Vn.length;Va<VU;Va++)this.cancelLoadByUrl(Vn[Va])},Va.cancelLoadByUrl=function(Vn){for(var Va=0;Va<this._maxPriority;Va++)for(var VU=this._resInfos[Va],Vx=VU.length-1;-1<Vx;Vx--){var VD=VU[Vx];VD&&VD.url===Vn&&(VU[Vx]=null,VD.destroy(),VD.offAll(),this._infoPool.push(VD))}Vq._resMap[Vn]&&delete Vq._resMap[Vn]},Va._loadAssets=function(Vn,VU,VQ,Va,Vx,VD,Vp){null==Vx&&(Vx=2),null==VD&&(VD=!0);for(var VV=Vn.length,Vy=0,VR=0,VX=[],Vz=!0,Vi=0;Vi<VV;Vi++){var Vq=Vn[Vi];if(!Vq)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+Vn);"string"==typeof Vq&&(Vq={url:Vq,type:Va,size:1,priority:Vx}),Vq.size||(Vq.size=1),Vq.progress=0,VR+=Vq.size,VX.push(Vq);var VE=VQ?VA.create(null,VP,[Vq],!1):null,Vm=VU||VQ?VA.create(null,Vb,[Vq]):null;this.load(Vq.url,Vm,VE,Vq.type,null!=Vq.priority&&0<=Vq.priority?Vq.priority:2,VD,Vq.group||Vp)}function Vb(Vn,Va){Vy++,Vn.progress=1,Va||(Vz=!1),Vy===VV&&VU&&VU.runWith(Vz)}function VP(Vn,Va){if(null!=VQ){Vn.progress=Va;for(var VU=0,Vx=0;Vx<VX.length;Vx++){var VD=VX[Vx];VU+=VD.size*VD.progress}var Vp=VU/VR;VQ.runWith(Vp)}}return this},Vq.cacheRes=function(Vn,Va){VVn.cacheRes(Vn,Va)},Vq._resMap={},Vy(Vq,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),Vq.__init$=function(){Vi=function(Vn){function Va(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,Va.__super.call(this)}return Vm(Va,"",VR),Va.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},Va}()},Vq}(),VRn=(function(Vn){function VD(Vn){VD.__super.call(this),Vn||(Vn=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var Va=0,VU=0,Vx=0;Vx<20;Vx++)Vx%5!=4?this._mat[Va++]=Vn[Vx]:this._alpha[VU++]=Vn[Vx];this._action=Vu.createFilterAction(32),this._action.data=this}Vm(VD,"laya.filters.ColorFilter",VP);var Va=VD.prototype;Vk.imps(Va,{"laya.filters.IFilter":!0}),Va.callNative=function(Vn){Vn._$P.cf=this;Vn.conchModel&&Vn.conchModel.setFilterMatrix&&Vn.conchModel.setFilterMatrix(this._mat,this._alpha)},VX(0,Va,"type",function(){return 32}),VX(0,Va,"action",function(){return this._action})}(),function(Vn){function Vx(Vn,Va,VU){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===Va&&(Va=0),Vx.__super.call(this),this._byteClass=VU||VF,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,Vn&&0<Va&&Va<65535&&this.connect(Vn,Va)}Vm(Vx,"laya.net.Socket",VR);var Va=Vx.prototype;Va.connect=function(Vn,Va){var VU="ws://"+Vn+":"+Va;VU="https:"==Vf.window.location.protocol?"wss://"+Vn+":"+Va:"ws://"+Vn+":"+Va,this.connectByUrl(VU)},Va.connectByUrl=function(Vn){var Va=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new Vf.window.WebSocket(Vn,this.protocols):this._socket=new Vf.window.WebSocket(Vn),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(Vn){Va._onOpen(Vn)},this._socket.onmessage=function(Vn){Va._onMessage(Vn)},this._socket.onclose=function(Vn){Va._onClose(Vn)},this._socket.onerror=function(Vn){Va._onError(Vn)}},Va.cleanSocket=function(){try{this._socket.close()}catch(Vn){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},Va.close=function(){if(null!=this._socket)try{this._socket.close()}catch(Vn){}},Va._onOpen=function(Vn){this._connected=!0,this.event("open",Vn)},Va._onMessage=function(Vn){if(Vn&&Vn.data){var Va=Vn.data;if(this.disableInput&&Va)this.event("message",Va);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var VU=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,Va&&("string"==typeof Va?this._input.writeUTFBytes(Va):this._input.writeArrayBuffer(Va),this._addInputPosition=this._input.pos,this._input.pos=VU),this.event("message",Va)}}},Va._onClose=function(Vn){this._connected=!1,this.event("close",Vn)},Va._onError=function(Vn){this.event("error",Vn)},Va.send=function(Vn){this._socket.send(Vn)},Va.flush=function(){if(this._output&&0<this._output.length){var Va;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(Vn){Va=Vn}this._output.endian=this.endian,this._output.clear(),Va&&this.event("error",Va)}},VX(0,Va,"input",function(){return this._input}),VX(0,Va,"output",function(){return this._output}),VX(0,Va,"connected",function(){return this._connected}),VX(0,Va,"endian",function(){return this._endian},function(Vn){this._endian=Vn,null!=this._input&&(this._input.endian=Vn),null!=this._output&&(this._output.endian=Vn)}),Vx.LITTLE_ENDIAN="littleEndian",Vx.BIG_ENDIAN="bigEndian"}(),function(Vn){function VV(){VV.__super.call(this),this._$1__id=++VV._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(VV._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,Vh.currentResourceManager&&Vh.currentResourceManager.addResource(this)}Vm(VV,"laya.resource.Resource",VR);var Va=VV.prototype;return Vk.imps(Va,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),Va._setUrl=function(Vn){var Va;this._url!==Vn&&(this._url&&((Va=VV._urlResourcesMap[this._url]).splice(Va.indexOf(this),1),0===Va.length&&delete VV._urlResourcesMap[this._url]),Vn&&((Va=VV._urlResourcesMap[Vn])||(VV._urlResourcesMap[Vn]=Va=[]),Va.push(this)),this._url=Vn)},Va._getGroup=function(){return this._group},Va._setGroup=function(Vn){var Va;this._group!==Vn&&(this._group&&((Va=VV._groupResourcesMap[this._group]).splice(Va.indexOf(this),1),0===Va.length&&delete VV._groupResourcesMap[this._group]),Vn&&((Va=VV._groupResourcesMap[Vn])||(VV._groupResourcesMap[Vn]=Va=[]),Va.push(this)),this._group=Vn)},Va._addReference=function(){this._referenceCount++},Va._removeReference=function(){this._referenceCount--},Va._clearReference=function(){this._referenceCount=0},Va._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},Va.recreateResource=function(){this.completeCreate()},Va.disposeResource=function(){},Va.activeResource=function(Vn){void 0===Vn&&(Vn=!1),this._lastUseFrameCount=Vw.loopCount,!this._destroyed&&this.__loaded&&(this._released||Vn)&&this.recreateResource()},Va.releaseResource=function(Vn){return void 0===Vn&&(Vn=!0),!(!Vn&&this.lock)&&(!(this._released&&!Vn)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},Va.onAsynLoaded=function(Vn,Va,VU){throw new Error("Resource: must override this function!")},Va.destroy=function(){var Vn;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete VV._idResourcesMap[this.id],this._url&&((Vn=VV._urlResourcesMap[this._url])&&(Vn.splice(Vn.indexOf(this),1),0===Vn.length&&delete VV._urlResourcesMap[this.url]),VVn.clearRes(this._url),this.__loaded||Vu.cancelLoadByUrl(this._url)),this._group&&((Vn=VV._groupResourcesMap[this._group]).splice(Vn.indexOf(this),1),0===Vn.length&&delete VV._groupResourcesMap[this.url]))},Va.completeCreate=function(){this._released=!1,this.event("recovered",this)},Va.dispose=function(){this.destroy()},VX(0,Va,"memorySize",function(){return this._memorySize},function(Vn){var Va=Vn-this._memorySize;this._memorySize=Vn,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,Va),this.resourceManager&&this.resourceManager.addSize(Va)}),VX(0,Va,"_loaded",null,function(Vn){this.__loaded=Vn}),VX(0,Va,"loaded",function(){return this.__loaded}),VX(0,Va,"id",function(){return this._$1__id}),VX(0,Va,"destroyed",function(){return this._destroyed}),VX(0,Va,"group",function(){return this._getGroup()},function(Vn){this._setGroup(Vn)}),VX(0,Va,"resourceManager",function(){return this._resourceManager}),VX(0,Va,"url",function(){return this._url}),VX(0,Va,"released",function(){return this._released}),VX(0,Va,"referenceCount",function(){return this._referenceCount}),VV.getResourceByID=function(Vn){return VV._idResourcesMap[Vn]},VV.getResourceByURL=function(Vn,Va){return void 0===Va&&(Va=0),null==VV._urlResourcesMap[Vn]?null:VV._urlResourcesMap[Vn][Va]},VV.getResourceCountByURL=function(Vn){return VV._urlResourcesMap[Vn].length},VV.destroyUnusedResources=function(Vn){var Va;if(Vn){var VU=VV._groupResourcesMap[Vn];if(VU)for(var Vx=VU.slice(),VD=0,Vp=Vx.length;VD<Vp;VD++)(Va=Vx[VD]).lock||0!==Va._referenceCount||Va.destroy()}else for(var VQ in VV._idResourcesMap)(Va=VV._idResourcesMap[VQ]).lock||0!==Va._referenceCount||Va.destroy()},VV._uniqueIDCounter=0,VV._idResourcesMap={},VV._urlResourcesMap={},VV._groupResourcesMap={},VV}()),VXn=function(Vn){function V$(Vn,Va){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,V$.__super.call(this),Vn&&null!=Vn._addReference&&Vn._addReference(),this.setTo(Vn,Va)}Vm(V$,"laya.resource.Texture",VR);var Va=V$.prototype;return Va._setUrl=function(Vn){this.url=Vn},Va.setTo=function(Vn,Va){if(Vn instanceof VQ.HTMLElement){var VU=VTn.create("2D",Vn);this.bitmap=VU}else this.bitmap=Vn;if(this.uv=Va||V$.DEF_UV,Vn){this._w=Vn.width,this._h=Vn.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var Vx=this;if(this._loaded)Vu.addToAtlas&&Vu.addToAtlas(Vx);else{var VD=Vn;VD instanceof laya.resource.HTMLImage&&VD.image&&VD.image.addEventListener("load",function(Vn){Vu.addToAtlas&&Vu.addToAtlas(Vx)},!1)}}},Va.active=function(){this.bitmap&&this.bitmap.activeResource()},Va.destroy=function(Vn){if(void 0===Vn&&(Vn=!1),this.alphaTexture&&(this.alphaTexture.destroy(Vn),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var Va=this.bitmap;Vn?(VI.isConchApp&&Va.source&&Va.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,Va.dispose(),Va._clearReference()):(Va._removeReference(),0==Va.referenceCount&&(VI.isConchApp&&Va.source&&Va.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,Va.dispose())),this.url&&this===Vk.loader.getRes(this.url)&&Vk.loader.clearRes(this.url,Vn),this._loaded=!1}},Va.load=function(Vn){var Va=this;this._loaded=!1,Vn=VG.customFormat(Vn);var VU=this.bitmap||(this.bitmap=VWn.create(Vn));VU.uri=Vn,VU&&VU._addReference();var Vx=this;VU.onload=function(){VU.onload=null,Vx._loaded=!0,Va.sourceWidth=Va._w=VU.width,Va.sourceHeight=Va._h=VU.height,Vx.event("loaded",this),Vu.addToAtlas&&Vu.addToAtlas(Vx)}},Va.addTextureToAtlas=function(Vn){Vu.addTextureToAtlas(this)},Va.getPixels=function(Vn,Va,VU,Vx){if(VI.isConchApp){var VD=this.bitmap;if(VD.source&&VD.source.getImageData){var Vp=VD.source.getImageData(Vn,Va,VU,Vx),VQ=new Uint8Array(Vp);return Array.from(VQ)}return null}return VI.isWebGL?Vu.getTexturePixels(this,Vn,Va,VU,Vx):(Vf.canvas.size(VU,Vx),Vf.canvas.clear(),Vf.context.drawTexture(this,-Vn,-Va,this.width,this.height,0,0),Vf.context.getImageData(0,0,VU,Vx).data)},Va.onAsynLoaded=function(Vn,Va){if(Va){if("function"!=typeof Va._addReference)throw new Error("bitmap._addReference is not a function. "+Va.className+" "+typeof Va._addReference+" "+Va.constructor);Va._addReference()}this.setTo(Va,this.uv),this._loaded&&this.event("loaded",this)},VX(0,Va,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),VX(0,Va,"loaded",function(){return this._loaded}),VX(0,Va,"released",function(){return!this.bitmap||this.bitmap.released}),VX(0,Va,"width",function(){return this._w?this._w:this.uv&&this.uv!==V$.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(Vn){this._w=Vn,this.sourceWidth||(this.sourceWidth=Vn)}),VX(0,Va,"repeat",function(){return!VI.isWebGL||!this.bitmap||this.bitmap.repeat},function(Vn){Vn&&VI.isWebGL&&this.bitmap&&(this.bitmap.repeat=Vn)&&(this.bitmap.enableMerageInAtlas=!1)}),VX(0,Va,"height",function(){return this._h?this._h:this.uv&&this.uv!==V$.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(Vn){this._h=Vn,this.sourceHeight||(this.sourceHeight=Vn)}),VX(0,Va,"isLinearSampling",function(){return!VI.isWebGL||9728!=this.bitmap.minFifter},function(Vn){!Vn&&VI.isWebGL&&(Vn||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),V$.moveUV=function(Vn,Va,VU){for(var Vx=0;Vx<8;Vx+=2)VU[Vx]+=Vn,VU[Vx+1]+=Va;return VU},V$.create=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){void 0===Vp&&(Vp=0),void 0===VQ&&(VQ=0),void 0===VV&&(VV=0),void 0===Vy&&(Vy=0);var VR=Vn instanceof laya.resource.Texture,VX=VR?Vn.uv:V$.DEF_UV,Vz=VR?Vn.bitmap:Vn,Vi=Vu.isAtlas(Vz);if(Vi){var Vq=Vz._atlaser,VE=Vn._atlasID;if(-1==VE)throw new Error("create texture error");Vz=Vq._inAtlasTextureBitmapValue[VE],VX=Vq._inAtlasTextureOriUVValue[VE]}var Vm=new V$(Vz,null);Vz.width&&Va+Vx>Vz.width&&(Vx=Vz.width-Va),Vz.height&&VU+VD>Vz.height&&(VD=Vz.height-VU),Vm.width=Vx,Vm.height=VD,Vm.offsetX=Vp,Vm.offsetY=VQ,Vm.sourceWidth=VV||Vx,Vm.sourceHeight=Vy||VD;var Vb=1/Vz.width,VP=1/Vz.height;Va*=Vb,VU*=VP,Vx*=Vb,VD*=VP;var VA=Vm.uv[0],VT=Vm.uv[1],VK=Vm.uv[4],VY=Vm.uv[5],VW=VK-VA,Vk=VY-VT,VN=V$.moveUV(VX[0],VX[1],[Va,VU,Va+Vx,VU,Va+Vx,VU+VD,Va,VU+VD]);Vm.uv=[VA+VN[0]*VW,VT+VN[1]*Vk,VK-(1-VN[2])*VW,VT+VN[3]*Vk,VK-(1-VN[4])*VW,VY-(1-VN[5])*Vk,VA+VN[6]*VW,VY-(1-VN[7])*Vk],Vi&&Vm.addTextureToAtlas();var V_=Vz.scaleRate;return V_&&1!=V_?(Vm.sourceWidth/=V_,Vm.sourceHeight/=V_,Vm.width/=V_,Vm.height/=V_,Vm.scaleRate=V_,Vm.offsetX/=V_,Vm.offsetY/=V_):Vm.scaleRate=1,Vm},V$.createFromTexture=function(Vn,Va,VU,Vx,VD){var Vp=Vn.scaleRate;1!=Vp&&(Va*=Vp,VU*=Vp,Vx*=Vp,VD*=Vp);var VQ=V_.TEMP.setTo(Va-Vn.offsetX,VU-Vn.offsetY,Vx,VD),VV=VQ.intersection(V$._rect1.setTo(0,0,Vn.width,Vn.height),V$._rect2);if(!VV)return null;var Vy=V$.create(Vn,VV.x,VV.y,VV.width,VV.height,VV.x-VQ.x,VV.y-VQ.y,Vx,VD);if(Vy.bitmap&&Vy.bitmap._removeReference)return Vy.bitmap._removeReference(),Vy;var VR="bitmap:"+(Vy.bitmap?Vy.bitmap.constructor?Vy.bitmap.constructor.name:Vy.bitmap.__className:"")+", url:"+(Vn.url+" | "+(Vy.bitmap?Vy.bitmap.url:Vn.url))+", x="+Va+",y="+VU+",width="+Vx+",height="+VD+", result="+(VV?VV.x+","+VV.y+","+VV.width+","+VV.height:"null")+", rect="+VQ.x+","+VQ.y+","+VQ.width+","+VQ.height;throw new Error("报错：bitmap._removeReference is not a function  "+VR)},V$.DEF_UV=[0,0,1,0,1,1,0,1],V$.INV_UV=[0,1,1,1,1,0,0,0],V$._rect1=new V_,V$._rect2=new V_,V$}(),Vn=function(Vn){var VV;function Vp(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,Vp.__super.call(this)}Vm(Vp,"laya.utils.TimeLine",VR);var Va=Vp.prototype;return Va.to=function(Vn,Va,VU,Vx,VD){return void 0===VD&&(VD=0),this._create(Vn,Va,VU,Vx,VD,!0)},Va.from=function(Vn,Va,VU,Vx,VD){return void 0===VD&&(VD=0),this._create(Vn,Va,VU,Vx,VD,!1)},Va._create=function(Vn,Va,VU,Vx,VD,Vp){var VQ=VS.getItemByClass("tweenData",VV);return VQ.isTo=Vp,VQ.type=0,VQ.target=Vn,VQ.duration=VU,VQ.data=Va,VQ.startTime=this._startTime+VD,VQ.endTime=VQ.startTime+VQ.duration,VQ.ease=Vx,this._startTime=Math.max(VQ.endTime,this._startTime),this._tweenDataList.push(VQ),this._startTimeSort=!0,this._endTimeSort=!0,this},Va.addLabel=function(Vn,Va){var VU=VS.getItemByClass("tweenData",VV);return VU.type=1,VU.data=Vn,VU.endTime=VU.startTime=this._startTime+Va,this._labelDic||(this._labelDic={}),this._labelDic[Vn]=VU,this._tweenDataList.push(VU),this},Va.removeLabel=function(Vn){if(this._labelDic&&this._labelDic[Vn]){var Va=this._labelDic[Vn];if(Va){var VU=this._tweenDataList.indexOf(Va);-1<VU&&this._tweenDataList.splice(VU,1)}delete this._labelDic[Vn]}},Va.gotoTime=function(Vn){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var Va,VU,Vx,VD;for(var Vp in this._firstTweenDic)if(VU=this._firstTweenDic[Vp])for(var VQ in VU)VU.diyTarget.hasOwnProperty(VQ)&&(VU.diyTarget[VQ]=VU[VQ]);for(Vp in this._tweenDic)(Va=this._tweenDic[Vp]).clear(),delete this._tweenDic[Vp];if(this._index=0,this._gidIndex=0,this._currTime=Vn,this._lastTime=Vf.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=Vx=this._tweenDataList.concat(),Vx.sort(function(Vn,Va){return Vn.endTime>Va.endTime?1:Vn.endTime<Va.endTime?-1:0})}else Vx=this._endTweenDataList;for(var VV=0,Vy=Vx.length;VV<Vy;VV++)if(0==(VD=Vx[VV]).type){if(!(Vn>=VD.endTime))break;this._index=Math.max(this._index,VV+1);var VR=VD.data;if(VD.isTo)for(var VX in VR)VD.target[VX]=VR[VX]}for(VV=0,Vy=this._tweenDataList.length;VV<Vy;VV++)0==(VD=this._tweenDataList[VV]).type&&Vn>=VD.startTime&&Vn<VD.endTime&&(this._index=Math.max(this._index,VV+1),this._gidIndex++,(Va=VS.getItemByClass("tween",VC))._create(VD.target,VD.data,VD.duration,VD.ease,VA.create(this,this._animComplete,[this._gidIndex]),0,!1,VD.isTo,!0,!1),Va.setStartTime(this._currTime-(Vn-VD.startTime)),Va._updateEase(this._currTime),Va.gid=this._gidIndex,this._tweenDic[this._gidIndex]=Va)}},Va.gotoLabel=function(Vn){if(null!=this._labelDic){var Va=this._labelDic[Vn];Va&&this.gotoTime(Va.startTime)}},Va.pause=function(){Vk.timer.clear(this,this._update)},Va.resume=function(){this.play(this._currTime,this._loopKey)},Va.play=function(Vn,Va){if(void 0===Vn&&(Vn=0),void 0===Va&&(Va=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(Vn,Va){return Vn.startTime>Va.startTime?1:Vn.startTime<Va.startTime?-1:0});for(var VU=0,Vx=this._tweenDataList.length;VU<Vx;VU++){var VD=this._tweenDataList[VU];if(null!=VD&&0==VD.type){var Vp=VD.target,VQ=Vp.$_GID||(Vp.$_GID=Vt.getGID()),VV=null;for(var Vy in null==this._firstTweenDic[VQ]?((VV={}).diyTarget=Vp,this._firstTweenDic[VQ]=VV):VV=this._firstTweenDic[VQ],VD.data)null==VV[Vy]&&(VV[Vy]=Vp[Vy])}}}"string"==typeof Vn?this.gotoLabel(Vn):this.gotoTime(Vn),this._loopKey=Va,this._lastTime=Vf.now(),Vk.timer.frameLoop(1,this,this._update)}},Va._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var Vn in this._tweenDic)(Va=this._tweenDic[Vn]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var Va,VU=Vf.now(),Vx=VU-this._lastTime,VD=this._currTime+=Vx*this.scale;for(Vn in this._lastTime=VU,this._tweenDic)(Va=this._tweenDic[Vn])._updateEase(VD);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var Vp=this._tweenDataList[this._index];VD>=Vp.startTime&&(this._index++,0==Vp.type?(this._gidIndex++,(Va=VS.getItemByClass("tween",VC))._create(Vp.target,Vp.data,Vp.duration,Vp.ease,VA.create(this,this._animComplete,[this._gidIndex]),0,!1,Vp.isTo,!0,!1),Va.setStartTime(VD),Va.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=Va)._updateEase(VD)):this.event("label",Vp.data))}},Va._animComplete=function(Vn){this._tweenDic[Vn]&&delete this._tweenDic[Vn]},Va._complete=function(){this.event("complete")},Va.reset=function(){var Vn;if(this._labelDic)for(Vn in this._labelDic)delete this._labelDic[Vn];for(Vn in this._tweenDic)this._tweenDic[Vn].clear(),delete this._tweenDic[Vn];for(Vn in this._firstTweenDic)delete this._firstTweenDic[Vn];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var Va,VU=0;for(Va=this._tweenDataList.length,VU=0;VU<Va;VU++)this._tweenDataList[VU]&&this._tweenDataList[VU].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,Vk.timer.clear(this,this._update)},Va.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},VX(0,Va,"index",function(){return this._frameIndex},function(Vn){this._frameIndex=Vn,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),VX(0,Va,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),Vp.to=function(Vn,Va,VU,Vx,VD){return void 0===VD&&(VD=0),(new Vp).to(Vn,Va,VU,Vx,VD)},Vp.from=function(Vn,Va,VU,Vx,VD){return void 0===VD&&(VD=0),(new Vp).from(Vn,Va,VU,Vx,VD)},Vp.__init$=function(){VV=function(){function Vn(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return Vm(Vn,""),Vn.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,VS.recover("tweenData",this)},Vn}()},Vp}(),Vzn=function(VD){function VU(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,VU.__super.call(this),this._style=VV.EMPTY}Vm(VU,"laya.display.Sprite",VD);var Vn=VU.prototype;return Vk.imps(Vn,{"laya.display.ILayout":!0}),Vn.createConchModel=function(){return new ConchNode},Vn.destroy=function(Vn){if(void 0===Vn&&(Vn=!0),this._releaseMem(),!this._destroyed){this.filters=null;var Va=this.mask;Va&&(this.mask=null,Va.destroy(Vn))}VD.prototype.destroy.call(this,Vn),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},Vn.updateZOrder=function(){Vt.updateOrder(this._childs)&&this.repaint()},Vn.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},Vn.setBounds=function(Vn){this._set$P("uBounds",Vn)},Vn.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new V_),V_._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},Vn.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new V_),V_._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},Vn._boundPointsToParent=function(Vn){void 0===Vn&&(Vn=!1);var Va=0,VU=0;this._style&&(Va=this._style._tf.translateX,VU=this._style._tf.translateY,Vn=Vn||0!==this._style._tf.rotate,this._style.scrollRect&&(Va+=this._style.scrollRect.x,VU+=this._style.scrollRect.y));var Vx=this._getBoundPointsM(Vn);if(!Vx||Vx.length<1)return Vx;if(8!=Vx.length&&(Vx=Vn?VY.scanPList(Vx):V_._getWrapRec(Vx,V_.TEMP)._getBoundPoints()),!this.transform)return Vt.transPointList(Vx,this._x-Va,this._y-VU),Vx;var VD=VN.TEMP,Vp=0,VQ=Vx.length;for(Vp=0;Vp<VQ;Vp+=2)VD.x=Vx[Vp],VD.y=Vx[Vp+1],this.toParentPoint(VD),Vx[Vp]=VD.x,Vx[Vp+1]=VD.y;return Vx},Vn.getGraphicBounds=function(Vn){return void 0===Vn&&(Vn=!1),this._graphics?this._graphics.getBounds(Vn):V_.TEMP.setTo(0,0,0,0)},Vn._getBoundPointsM=function(Vn){if(void 0===Vn&&(Vn=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var Va=Vt.clearArray(this._$P.temBM),VU=V_.TEMP;return VU.copyFrom(this.scrollRect),Vt.concatArray(Va,VU._getBoundPoints()),Va}for(var Vx,VD,Vp,VQ=this._graphics?this._graphics.getBoundPoints():Vt.clearArray(this._$P.temBM),VV=0,Vy=(Vp=this._childs).length;VV<Vy;VV++)(Vx=Vp[VV])instanceof laya.display.Sprite&&1==Vx.visible&&(VD=Vx._boundPointsToParent(Vn))&&(VQ=VQ?Vt.concatArray(VQ,VD):VD);return VQ},Vn.getStyle=function(){return this._style===VV.EMPTY&&(this._style=new VV),this._style},Vn.setStyle=function(Vn){this._style=Vn},Vn._adjustTransform=function(){this._tfChanged=!1;var Vn,Va=this._style._tf,VU=Va.scaleX,Vx=Va.scaleY;if(Va.rotate||1!==VU||1!==Vx||Va.skewX||Va.skewY){(Vn=this._transform||(this._transform=Vc.create())).bTransform=!0;var VD=.0174532922222222*(Va.rotate-Va.skewX),Vp=.0174532922222222*(Va.rotate+Va.skewY),VQ=Math.cos(Vp),VV=Math.sin(Vp),Vy=Math.sin(VD),VR=Math.cos(VD);return Vn.a=VU*VQ,Vn.b=VU*VV,Vn.c=-Vx*Vy,Vn.d=Vx*VR,Vn.tx=Vn.ty=0,Vn}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,Vn},Vn.pos=function(Vn,Va,VU){if(void 0===VU&&(VU=!1),this._x!==Vn||this._y!==Va){if(this.destroyed)return this;if(VU){this._x=Vn,this._y=Va,this.conchModel&&this.conchModel.pos(this._x,this._y);var Vx=this._parent;Vx&&0===Vx._repaint&&(Vx._repaint=1,Vx.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=Vn,this.y=Va}return this},Vn.pivot=function(Vn,Va){return this.pivotX=Vn,this.pivotY=Va,this},Vn.size=function(Vn,Va){return this.width=Vn,this.height=Va,this},Vn.scale=function(Vn,Va,VU){void 0===VU&&(VU=!1);var Vx=this.getStyle(),VD=Vx._tf;if(VD.scaleX!=Vn||VD.scaleY!=Va){if(this.destroyed)return this;if(VU){Vx.setScale(Vn,Va),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Vn,Va),this._renderType|=4;var Vp=this._parent;Vp&&0===Vp._repaint&&(Vp._repaint=1,Vp.parentRepaint())}else this.scaleX=Vn,this.scaleY=Va}return this},Vn.skew=function(Vn,Va){return this.skewX=Vn,this.skewY=Va,this},Vn.render=function(Vn,Va,VU){Vw.spriteCount++,Vl.renders[this._renderType]._fun(this,Vn,Va+this._x,VU+this._y),this._repaint=0},Vn.drawToCanvas=function(Vn,Va,VU,Vx){if(VI.isConchNode){var VD=VTn.create("2D");return new Vv(Vn,Va,VD).ctx.setCanvasType(1),this.conchModel.drawToCanvas(VD.source,VU,Vx),VD}return Vu.drawToCanvas(this,this._renderType,Vn,Va,VU,Vx)},Vn.customRender=function(Vn,Va,VU){this._renderType|=1024},Vn._applyFilters=function(){var Vn;if(!VI.isWebGL&&((Vn=this._$P.filters)&&!(Vn.length<1)))for(var Va=0,VU=Vn.length;Va<VU;Va++)Vn[Va].action.apply(this._$P.cacheCanvas)},Vn._isHaveGlowFilter=function(){var Vn,Va=0;if(this.filters)for(Va=0;Va<this.filters.length;Va++)if(8==this.filters[Va].type)return!0;for(Va=0,Vn=this._childs.length;Va<Vn;Va++)if(this._childs[Va]._isHaveGlowFilter())return!0;return!1},Vn.localToGlobal=function(Vn,Va){void 0===Va&&(Va=!1),!0===Va&&(Vn=new VN(Vn.x,Vn.y));for(var VU=this;VU&&VU!=Vk.stage;)Vn=VU.toParentPoint(Vn),VU=VU.parent;return Vn},Vn.globalToLocal=function(Vn,Va){void 0===Va&&(Va=!1),Va&&(Vn=new VN(Vn.x,Vn.y));for(var VU=this,Vx=[];VU&&VU!=Vk.stage;)Vx.push(VU),VU=VU.parent;for(var VD=Vx.length-1;0<=VD;)Vn=(VU=Vx[VD]).fromParentPoint(Vn),VD--;return Vn},Vn.toParentPoint=function(Vn){if(!Vn)return Vn;Vn.x-=this.pivotX,Vn.y-=this.pivotY,this.transform&&this._transform.transformPoint(Vn),Vn.x+=this._x,Vn.y+=this._y;var Va=this._style.scrollRect;return Va&&(Vn.x-=Va.x,Vn.y-=Va.y),Vn},Vn.fromParentPoint=function(Vn){if(!Vn)return Vn;Vn.x-=this._x,Vn.y-=this._y;var Va=this._style.scrollRect;return Va&&(Vn.x+=Va.x,Vn.y+=Va.y),this.transform&&this._transform.invertTransformPoint(Vn),Vn.x+=this.pivotX,Vn.y+=this.pivotY,Vn},Vn.on=function(Vn,Va,VU,Vx){return 1!==this._mouseEnableState&&this.isMouseEvent(Vn)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(Vn,Va,VU,Vx,!1)):VD.prototype.on.call(this,Vn,Va,VU,Vx)},Vn.once=function(Vn,Va,VU,Vx){return 1!==this._mouseEnableState&&this.isMouseEvent(Vn)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(Vn,Va,VU,Vx,!0)):VD.prototype.once.call(this,Vn,Va,VU,Vx)},Vn._$2__onDisplay=function(){if(1!==this._mouseEnableState){var Vn=this;for(Vn=Vn.parent;Vn&&1!==Vn._mouseEnableState&&!Vn._getBit(2);)Vn.mouseEnabled=!0,Vn._setBit(2,!0),Vn=Vn.parent}},Vn.loadImage=function(Vn,Va,VU,Vx,VD,Vp){var VQ=this;return void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=0),void 0===VD&&(VD=0),this.graphics.loadImage(Vn,Va,VU,Vx,VD,function(Vn){VQ.destroyed||(VQ.size(Va+(Vx||Vn.width),VU+(VD||Vn.height)),VQ.repaint(),Vp&&Vp.runWith(Vn))}),this},Vn.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},Vn._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},Vn._childChanged=function(Vn){this._childs.length?this._renderType|=2048:this._renderType&=-2049,Vn&&this._get$P("hasZorder")&&Vk.timer.callLater(this,this.updateZOrder),this.repaint()},Vn.parentRepaint=function(){var Vn=this._parent;Vn&&0===Vn._repaint&&(Vn._repaint=1,Vn.parentRepaint())},Vn.startDrag=function(Vn,Va,VU,Vx,VD,Vp,VQ){void 0===Va&&(Va=!1),void 0===VU&&(VU=0),void 0===Vx&&(Vx=300),void 0===Vp&&(Vp=!1),void 0===VQ&&(VQ=.92),this._$P.dragging||this._set$P("dragging",new VO),this._$P.dragging.start(this,Vn,Va,VU,Vx,VD,Vp,VQ)},Vn.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},Vn._releaseMem=function(){if(this._$P){var Vn=this._$P.cacheCanvas;Vn&&Vn.ctx&&(VS.recover("RenderContext",Vn.ctx),Vn.ctx.canvas.size(0,0),Vn.ctx=null);var Va=this._$P._filterCache;Va&&(Va.destroy(),Va.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},Vn._setDisplay=function(Vn){Vn||this._releaseMem(),VD.prototype._setDisplay.call(this,Vn)},Vn.hitTestPoint=function(Vn,Va){var VU=this.globalToLocal(VN.TEMP.setTo(Vn,Va));return Vn=VU.x,Va=VU.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?V_.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(Vn,Va)},Vn.getMousePoint=function(){return this.globalToLocal(VN.TEMP.setTo(Vk.stage.mouseX,Vk.stage.mouseY))},Vn._getWords=function(){return null},Vn._addChildsToLayout=function(Vn){var Va=this._getWords();if(null==Va&&0==this._childs.length)return!1;if(Va)for(var VU=0,Vx=Va.length;VU<Vx;VU++)Vn.push(Va[VU]);VU=0;for(var VD=this._childs.length;VU<VD;++VU){var Vp=this._childs[VU];Vp._style._enableLayout()&&Vp._addToLayout(Vn)}return!0},Vn._addToLayout=function(Vn){this._style.absolute||(this._style.block?Vn.push(this):this._addChildsToLayout(Vn)&&(this.x=this.y=0))},Vn._isChar=function(){return!1},Vn._getCSSStyle=function(){return this._style.getCSSStyle()},Vn._setAttributes=function(Vn,Va){switch(Vn){case"x":this.x=parseFloat(Va);break;case"y":this.y=parseFloat(Va);break;case"width":this.width=parseFloat(Va);break;case"height":this.height=parseFloat(Va);break;default:this[Vn]=Va}},Vn._layoutLater=function(){this.parent&&this.parent._layoutLater()},VX(0,Vn,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(Vn){this._optimizeScrollRect!=Vn&&(this._optimizeScrollRect=Vn,this.conchModel&&this.conchModel.optimizeScrollRect(Vn))}),VX(0,Vn,"customRenderEnable",null,function(Vn){if(Vn&&(this._renderType|=1024,VI.isConchNode)){VU.CustomList.push(this);var Va=new VTn("2d");Va._setContext(new CanvasRenderingContext2D),this.customContext=new Vv(0,0,Va),Va.context.setCanvasType&&Va.context.setCanvasType(2),this.conchModel.custom(Va.context)}}),VX(0,Vn,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(Vn){this.cacheAs=Vn?this._$P.hasFilter?"none":"normal":"none"}),VX(0,Vn,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(Vn){var Va=this._$P.cacheCanvas;if(Vn!==(Va?Va.type:"none")){if("none"!==Vn)this._getBit(1)||this._setUpNoticeType(1),Va||(Va=this._set$P("cacheCanvas",VS.getItemByClass("cacheCanvas",Object))),Va.type=Vn,Va.reCache=!0,this._renderType|=16,"bitmap"==Vn&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(Va){var VU=Va;VU&&VU.ctx&&(VS.recover("RenderContext",VU.ctx),VU.ctx.canvas.size(0,0),VU.ctx=null),VS.recover("cacheCanvas",Va)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),VX(0,Vn,"zOrder",function(){return this._zOrder},function(Vn){this._zOrder!=Vn&&(this._zOrder=Vn,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(Vn),this._parent&&(Vn&&this._parent._set$P("hasZorder",!0),Vk.timer.callLater(this._parent,this.updateZOrder)))}),VX(0,Vn,"rotation",function(){return this._style._tf.rotate},function(Vn){var Va=this.getStyle();if(Va._tf.rotate!==Vn){Va.setRotate(Vn),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(Vn),this._renderType|=4;var VU=this._parent;VU&&0===VU._repaint&&(VU._repaint=1,VU.parentRepaint())}}),VX(0,Vn,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(Vn){this._width!==Vn&&(this._width=Vn,this.conchModel&&this.conchModel.size(Vn,this._height),this.repaint())}),VX(0,Vn,"x",function(){return this._x},function(Vn){if(this._x!==Vn){if(this.destroyed)return;this._x=Vn,this.conchModel&&this.conchModel.pos(Vn,this._y);var Va=this._parent;Va&&0===Va._repaint&&(Va._repaint=1,Va.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),VX(0,Vn,"globalScaleY",function(){for(var Vn=1,Va=this;Va&&Va!==Vk.stage;)Vn*=Va.scaleY,Va=Va.parent;return Vn}),VX(0,Vn,"hitArea",function(){return this._$P.hitArea},function(Vn){this._set$P("hitArea",Vn)}),VX(0,Vn,"staticCache",function(){return this._$P.staticCache},function(Vn){this._set$P("staticCache",Vn),Vn||this.reCache()}),VX(0,Vn,"texture",function(){return this._texture},function(Vn){this._texture!=Vn&&(this._texture=Vn,this.graphics.cleanByTexture(Vn,0,0))}),VX(0,Vn,"y",function(){return this._y},function(Vn){if(this._y!==Vn){if(this.destroyed)return;this._y=Vn,this.conchModel&&this.conchModel.pos(this._x,Vn);var Va=this._parent;Va&&0===Va._repaint&&(Va._repaint=1,Va.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),VX(0,Vn,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(Vn){this._height!==Vn&&(this._height=Vn,this.conchModel&&this.conchModel.size(this._width,Vn),this.repaint())}),VX(0,Vn,"blendMode",function(){return this._style.blendMode},function(Vn){this.getStyle().blendMode=Vn,this.conchModel&&this.conchModel.blendMode(Vn),Vn&&"source-over"!=Vn?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),VX(0,Vn,"scaleX",function(){return this._style._tf.scaleX},function(Vn){var Va=this.getStyle();if(Va._tf.scaleX!==Vn){Va.setScaleX(Vn),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Vn,Va._tf.scaleY),this._renderType|=4;var VU=this._parent;VU&&0===VU._repaint&&(VU._repaint=1,VU.parentRepaint())}}),VX(0,Vn,"scaleY",function(){return this._style._tf.scaleY},function(Vn){var Va=this.getStyle();if(Va._tf.scaleY!==Vn){Va.setScaleY(Vn),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Va._tf.scaleX,Vn),this._renderType|=4;var VU=this._parent;VU&&0===VU._repaint&&(VU._repaint=1,VU.parentRepaint())}}),VX(0,Vn,"stage",function(){return Vk.stage}),VX(0,Vn,"skewX",function(){return this._style._tf.skewX},function(Vn){var Va=this.getStyle();if(Va._tf.skewX!==Vn){Va.setSkewX(Vn),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(Vn,Va._tf.skewY),this._renderType|=4;var VU=this._parent;VU&&0===VU._repaint&&(VU._repaint=1,VU.parentRepaint())}}),VX(0,Vn,"scrollRect",function(){return this._style.scrollRect},function(Vn){this.getStyle().scrollRect=Vn,this.repaint(),Vn?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(Vn.x,Vn.y,Vn.width,Vn.height)):(this._renderType&=-129,this.conchModel&&(VU.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),VX(0,Vn,"skewY",function(){return this._style._tf.skewY},function(Vn){var Va=this.getStyle();if(Va._tf.skewY!==Vn){Va.setSkewY(Vn),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(Va._tf.skewX,Vn),this._renderType|=4;var VU=this._parent;VU&&0===VU._repaint&&(VU._repaint=1,VU.parentRepaint())}}),VX(0,Vn,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(Vn){this._tfChanged=!1,(this._transform=Vn)&&(this._x=Vn.tx,this._y=Vn.ty,Vn.tx=Vn.ty=0,this.conchModel&&this.conchModel.transform(Vn.a,Vn.b,Vn.c,Vn.d,this._x,this._y)),Vn?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),VX(0,Vn,"pivotX",function(){return this._style._tf.translateX},function(Vn){this.getStyle().setTranslateX(Vn),this.conchModel&&this.conchModel.pivot(Vn,this._style._tf.translateY),this.repaint()}),VX(0,Vn,"pivotY",function(){return this._style._tf.translateY},function(Vn){this.getStyle().setTranslateY(Vn),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,Vn),this.repaint()}),VX(0,Vn,"alpha",function(){return this._style.alpha},function(Vn){this._style&&this._style.alpha!==Vn&&(Vn=Vn<0?0:1<Vn?1:Vn,this.getStyle().alpha=Vn,this.conchModel&&this.conchModel.alpha(Vn),1!==Vn?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),VX(0,Vn,"visible",function(){return this._style.visible},function(Vn){this._style&&this._style.visible!==Vn&&(this.getStyle().visible=Vn,this.conchModel&&this.conchModel.visible(Vn),this.parentRepaint())}),VX(0,Vn,"graphics",function(){return this._graphics||(this.graphics=Vu.createGraphics())},function(Vn){this._graphics&&(this._graphics._sp=null),(this._graphics=Vn)?(this._renderType&=-2,this._renderType|=512,(Vn._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(VU.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),VX(0,Vn,"filters",function(){return this._$P.filters},function(Vn){Vn&&0===Vn.length&&(Vn=null),this._$P.filters!=Vn&&(this._set$P("filters",Vn?Vn.slice():null),VI.isConchApp&&(this.conchModel&&(VU.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),VI.isWebGL&&(Vn&&Vn.length?this._renderType|=32:this._renderType&=-33),Vn&&0<Vn.length?(this._getBit(1)||this._setUpNoticeType(1),VI.isWebGL&&1==Vn.length&&Vn[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(VI.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),VX(0,Vn,"parent",VD.prototype._$get_parent,function(Vn){Vk.superSet(Vnn,this,"parent",Vn),Vn&&this._getBit(2)&&this._$2__onDisplay()}),VX(0,Vn,"mask",function(){return this._$P._mask},function(Vn){Vn&&this.mask&&this.mask._$P.maskParent||(Vn?(this.cacheAs="bitmap",this._set$P("_mask",Vn),Vn._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",Vn),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(Vn?Vn.conchModel:null),this._renderType|=64,this.parentRepaint())}),VX(0,Vn,"mouseEnabled",function(){return 1<this._mouseEnableState},function(Vn){this._mouseEnableState=Vn?2:1}),VX(0,Vn,"globalScaleX",function(){for(var Vn=1,Va=this;Va&&Va!==Vk.stage;)Vn*=Va.scaleX,Va=Va.parent;return Vn}),VX(0,Vn,"mouseX",function(){return this.getMousePoint().x}),VX(0,Vn,"mouseY",function(){return this.getMousePoint().y}),VU.fromImage=function(Vn){return(new VU).loadImage(Vn)},VU._cachePool=[],VU.CustomList=[],Vy(VU,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=VQ.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),VU}(Vnn),Vin=function(Vn){function Va(Vn){this._audio=null,this._onEnd=null,this._resumePlay=null,Va.__super.call(this),this._onEnd=Vt.bind(this.__onEnd,this),this._resumePlay=Vt.bind(this.__resumePlay,this),Vn.addEventListener("ended",this._onEnd),this._audio=Vn}Vm(Va,"laya.media.h5audio.AudioSoundChannel",Vxn);var VU=Va.prototype;return VU.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(Vk.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},VU.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,Vf.container.appendChild(this._audio),this._audio.play()}catch(Vn){this.event("error")}},VU.play=function(Vn){this.isStopped=!1;try{this._audio.playbackRate=VZ.playbackRate,this._audio.currentTime=this.startTime}catch(Vn){return void this._audio.addEventListener("canplay",this._resumePlay)}VZ.addChannel(this),Vf.container.appendChild(this._audio),!Vn&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},VU.stop=function(){this.isStopped=!0,VZ.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&VI.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),Vf.onIE||this._audio!=VUn._musicAudio&&VS.recover("audio:"+this.url,this._audio),Vf.removeElement(this._audio),this._audio=null)},VU.pause=function(){this.isStopped=!0,VZ.removeChannel(this),"pause"in this._audio&&this._audio.pause()},VU.resume=function(){this._audio&&(this.isStopped=!1,VZ.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},VX(0,VU,"position",function(){return this._audio?this._audio.currentTime:0}),VX(0,VU,"duration",function(){return this._audio?this._audio.duration:0}),VX(0,VU,"volume",function(){return this._audio?this._audio.volume:1},function(Vn){this._audio&&(this._audio.volume=Vn)}),Va}(),Vqn=function(Vn){function Va(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=Vpn.ctx,Va.__super.call(this),this._onPlayEnd=Vt.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}Vm(Va,"laya.media.webaudio.WebAudioSoundChannel",Vxn);var VU=Va.prototype;return VU.play=function(Vn){if(VZ.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var Va=this.context,VU=this.gain,Vx=Va.createBufferSource();(this.bufferSource=Vx).buffer=this.audioBuffer,Vx.connect(VU),VU&&VU.disconnect(),VU.connect(Va.destination),Vx.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=Vf.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(Vx.loop=!0),Vx.playbackRate.setTargetAtTime?Vx.playbackRate.setTargetAtTime(VZ.playbackRate,this.context.currentTime,.1):Vx.playbackRate.value=VZ.playbackRate,Vx.start(0,this.startTime),!Vn&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},VU.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(Vk.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},VU._clearBufferSource=function(){if(this.bufferSource){var Vn=this.bufferSource;Vn.stop?Vn.stop(0):Vn.noteOff(0),Vn.disconnect(0),Vn.onended=null,Va._tryCleanFailed||this._tryClearBuffer(Vn),this.bufferSource=null}},VU._tryClearBuffer=function(Vn){try{Vn.buffer=null}catch(Vn){Va._tryCleanFailed=!0}},VU.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,VZ.removeChannel(this),this.startHandler=null,this.completeHandler=null},VU.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,VZ.removeChannel(this)},VU.resume=function(){this.startTime=this._pauseTime,this.play(!1)},VX(0,VU,"position",function(){return this.bufferSource?(Vf.now()-this._startTime)/1e3+this.startTime:0}),VX(0,VU,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),VX(0,VU,"volume",function(){return this._volume},function(Vn){this.isStopped||(this._volume=Vn,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(Vn,this.context.currentTime,.1):this.gain.gain.value=Vn)}),Va._tryCleanFailed=!1,Va}(),VEn=function(Vn){function Va(){Va.__super.call(this),this._w=0,this._h=0}Vm(Va,"laya.resource.Bitmap",VRn);var VU=Va.prototype;return VX(0,VU,"width",function(){return this._w}),VX(0,VU,"height",function(){return this._h}),VX(0,VU,"source",function(){return this._source}),Va}(),Vmn=function(Va){function Vn(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,Vn.__super.call(this),this._interval=Vx.animationInterval,this._setUpNoticeType(1)}Vm(Vn,"laya.display.AnimationPlayerBase",Va);var VU=Vn.prototype;return VU.play=function(Vn,Va,VU,Vx){void 0===Vn&&(Vn=0),void 0===Va&&(Va=!0),void 0===VU&&(VU=""),void 0===Vx&&(Vx=!0),this._isPlaying=!0,this.index="string"==typeof Vn?this._getFrameByLabel(Vn):Vn,this.loop=Va,this._actionName=VU,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},VU._getFrameByLabel=function(Vn){var Va=0;for(Va=0;Va<this._count;Va++)if(this._labels[Va]&&0<=this._labels[Va].indexOf(Vn))return Va;return 0},VU._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},VU._setControlNode=function(Vn){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=Vn)&&Vn!=this&&(Vn.on("display",this,this._checkResumePlaying),Vn.on("undisplay",this,this._checkResumePlaying))},VU._setDisplay=function(Vn){Va.prototype._setDisplay.call(this,Vn),this._checkResumePlaying()},VU._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},VU.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},VU.addLabel=function(Vn,Va){this._labels||(this._labels={}),this._labels[Va]||(this._labels[Va]=[]),this._labels[Va].push(Vn)},VU.removeLabel=function(Vn){if(Vn){if(this._labels)for(var Va in this._labels)this._removeLabelFromLabelList(this._labels[Va],Vn)}else this._labels=null},VU._removeLabelFromLabelList=function(Vn,Va){if(Vn)for(var VU=Vn.length-1;0<=VU;VU--)Vn[VU]==Va&&Vn.splice(VU,1)},VU.gotoAndStop=function(Vn){this.index="string"==typeof Vn?this._getFrameByLabel(Vn):Vn,this.stop()},VU._displayToIndex=function(Vn){},VU.clear=function(){this.stop(),this._labels=null},VX(0,VU,"interval",function(){return this._interval},function(Vn){this._interval!=Vn&&(this._frameRateChanged=!0,this._interval=Vn,this._isPlaying&&0<Vn&&this.timerLoop(Vn,this,this._frameLoop,null,!0,!0))}),VX(0,VU,"isPlaying",function(){return this._isPlaying}),VX(0,VU,"index",function(){return this._index},function(Vn){if(this._index=Vn,this._displayToIndex(Vn),this._labels&&this._labels[Vn])for(var Va=this._labels[Vn],VU=0,Vx=Va.length;VU<Vx;VU++)this.event("label",Va[VU])}),VX(0,VU,"count",function(){return this._count}),Vn.WRAP_POSITIVE=0,Vn.WRAP_REVERSE=1,Vn.WRAP_PINGPONG=2,Vn}(Vzn),Vbn=function(Va){function Vq(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,Vq.__super.call(this),this.overflow=Vq.VISIBLE,this._style=new Van(this),this._style.wordWrap=!1}Vm(Vq,"laya.display.Text",Va);var Vn=Vq.prototype;return Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,Vn),this._lines=null,this._words&&(this._words.length=0,this._words=null)},Vn._getBoundPointsM=function(Vn){void 0===Vn&&(Vn=!1);var Va=V_.TEMP;return Va.setTo(0,0,this.width,this.height),Va._getBoundPoints()},Vn.getGraphicBounds=function(Vn){void 0===Vn&&(Vn=!1);var Va=V_.TEMP;return Va.setTo(0,0,this.width,this.height),Va},Vn._getCSSStyle=function(){return this._style},Vn.lang=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX){if(Vn=Vq.langPacks&&Vq.langPacks[Vn]?Vq.langPacks[Vn]:Vn,arguments.length<2)this._text=Vn;else{for(var Vz=0,Vi=arguments.length;Vz<Vi;Vz++)Vn=Vn.replace("{"+Vz+"}",arguments[Vz+1]);this._text=Vn}},Vn._isPassWordMode=function(){var Vn=this._style.password;return"prompt"in this&&this.prompt==this._text&&(Vn=!1),Vn},Vn._getPassWordTxt=function(Vn){var Va;Va="";for(var VU=Vn.length;0<VU;VU--)Va+="●";return Va},Vn.renderText=function(Vn,Va){var VU=this.graphics;VU.clear(!0);var Vx=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(Vf.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);Vf.context.font=Vx;var VD=this.padding,Vp=VD[3],VQ="left",VV=this._lines,Vy=this.leading+this._charSize.height,VR=this._currBitmapFont;VR&&(Vy=this.leading+VR.getMaxHeight());var VX=VD[0];if(!VR&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(VQ="right",Vp=this._width-VD[1]):"center"==this.align&&(VQ="center",Vp=.5*this._width+VD[3]-VD[1])),0<this._height){var Vz=this._textHeight>this._height?"top":this.valign;"middle"===Vz?VX=.5*(this._height-Va*Vy)+VD[0]-VD[2]:"bottom"===Vz&&(VX=this._height-Va*Vy-VD[2])}var Vi=this._style;if(VR&&VR.autoScaleSize)var Vq=VR.fontSize/this.fontSize;if(this._clipPoint)if(VU.save(),VR&&VR.autoScaleSize){var VE=0,Vm=0;VE=this._width?this._width-VD[3]-VD[1]:this._textWidth,Vm=this._height?this._height-VD[0]-VD[2]:this._textHeight,VE*=Vq,Vm*=Vq,VU.clipRect(VD[3],VD[0],VE,Vm)}else VU.clipRect(VD[3],VD[0],this._width?this._width-VD[3]-VD[1]:this._textWidth,this._height?this._height-VD[0]-VD[2]:this._textHeight);var Vb=Vi.password;"prompt"in this&&this.prompt==this._text&&(Vb=!1);for(var VP=0,VA=0,VT=Math.min(this._lines.length,Va+Vn)||1,VK=Vn;VK<VT;VK++){var VY,VW=VV[VK];if(Vb){var Vk=VW.length;VW="";for(var VN=Vk;0<VN;VN--)VW+="●"}if(VP=Vp-(this._clipPoint?this._clipPoint.x:0),VA=VX+Vy*VK-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(VQ,VP,VA,VK),VR){var V_=this.width;VR.autoScaleSize&&(V_=this.width*Vq),VR.drawText(VW,this,VP,VA,this.align,V_)}else VI.isWebGL?(this._words||(this._words=[]),(VY=this._words.length>VK-Vn?this._words[VK-Vn]:new Ve).setText(VW)):VY=VW,Vi.stroke?VU.fillBorderText(VY,VP,VA,Vx,this.color,Vi.strokeColor,Vi.stroke,VQ):VU.fillText(VY,VP,VA,Vx,this.color,VQ)}if(VR&&VR.autoScaleSize){var V$=1/Vq;this.scale(V$,V$)}this._clipPoint&&VU.restore(),this._startX=Vp,this._startY=VX},Vn.drawUnderline=function(Vn,Va,VU,Vx){var VD=this._lineWidths[Vx];switch(Vn){case"center":Va-=VD/2;break;case"right":Va-=VD}VU+=this._charSize.height,this._graphics.drawLine(Va,VU,Va+VD,VU,this.underlineColor||this.color,1)},Vn.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);Vf.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new VN(0,0)):this._clipPoint=null;var Vn=this._lines.length;if(this.overflow!=Vq.VISIBLE){var Va=this.overflow==Vq.HIDDEN?Math.floor:Math.ceil;Vn=Math.min(Vn,Va((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var VU=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(VU,Vn),this.repaint()},Vn.evalTextSize=function(){var Vn,Va=NaN;Vn=Math.max.apply(this,this._lineWidths),Va=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],Vn==this._textWidth&&Va==this._textHeight||(this._textWidth=Vn,this._textHeight=Va,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},Vn.checkEnabledViewportOrNot=function(){return this.overflow==Vq.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},Vn.changeText=function(Vn){this._text!==Vn&&(this.lang(Vn+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},Vn.parseLines=function(Vn){var Va=this.wordWrap||this.overflow==Vq.HIDDEN;if(Va)var VU=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var Vx=Vt.contextMeasureText(Vq._testWord);VI.isConchApp&&0===Vx.width&&0===Vx.height&&(Vx=Vt.contextMeasureText("W")),this._charSize.width=Vx.width,this._charSize.height=Vx.height||this.fontSize}for(var VD=Vn.replace(/\r\n/g,"\n").split("\n"),Vp=0,VQ=VD.length;Vp<VQ;Vp++){var VV=VD[Vp];Va?this.parseLine(VV,VU):(this._lineWidths.push(this.getTextWidth(VV)),this._lines.push(VV))}},Vn.parseLine=function(Vn,Va){Vf.context;var VU,Vx=this._lines,VD=0,Vp=NaN,VQ=NaN,VV=0;if((Vp=this.getTextWidth(Vn))<=Va)return Vx.push(Vn),void this._lineWidths.push(Vp);Vp=this._charSize.width,0==(VD=Math.floor(Va/Vp))&&(VD=1),VQ=Vp=this.getTextWidth(Vn.substring(0,VD));for(var Vy=VD,VR=Vn.length;Vy<VR;Vy++)if(Va<(VQ+=Vp=this.getTextWidth(Vn.charAt(Vy))))if(this.wordWrap){var VX=Vn.substring(VV,Vy);if(VX.charCodeAt(VX.length-1)<255?(VU=/(?:\w|-)+$/.exec(VX))&&(Vy=VU.index+VV,0==VU.index?Vy+=VX.length:VX=Vn.substring(VV,Vy)):Vq.RightToLeft&&(VU=/([\u0600-\u06FF])+$/.exec(VX))&&(Vy=VU.index+VV,0==VU.index?Vy+=VX.length:VX=Vn.substring(VV,Vy)),Vx.push(VX),this._lineWidths.push(VQ-Vp),!((VV=Vy)+VD<VR)){Vx.push(Vn.substring(VV,VR)),this._lineWidths.push(this.getTextWidth(Vx[Vx.length-1])),VV=-1;break}Vy+=VD,VQ=Vp=this.getTextWidth(Vn.substring(VV,Vy)),Vy--}else if(this.overflow==Vq.HIDDEN)return Vx.push(Vn.substring(0,Vy)),void this._lineWidths.push(this.getTextWidth(Vx[Vx.length-1]));this.wordWrap&&-1!=VV&&(Vx.push(Vn.substring(VV,VR)),this._lineWidths.push(this.getTextWidth(Vx[Vx.length-1])))},Vn.getTextWidth=function(Vn){return this._currBitmapFont?this._currBitmapFont.getTextWidth(Vn):Vt.contextMeasureText(Vn).width},Vn.getWordWrapWidth=function(){var Vn=this.padding,Va=NaN;return(Va=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(Va=this.wordWrap?100:Vf.width),Va<=0&&(Va=100),Va-Vn[3]-Vn[1]},Vn.getCharPoint=function(Vn,Va){this._isChanged&&Vk.timer.runCallLater(this,this.typeset);for(var VU=0,Vx=this._lines,VD=0,Vp=0,VQ=Vx.length;Vp<VQ;Vp++){if(Vn<(VU+=Vx[Vp].length)){var VV=Vp;break}VD=VU}var Vy=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;Vf.context.font=Vy;var VR=this.getTextWidth(this._text.substring(VD,Vn));return(Va||new VN).setTo(this._startX+VR-(this._clipPoint?this._clipPoint.x:0),this._startY+VV*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},VX(0,Vn,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(Vn){Vn!=this._width&&(Vk.superSet(Vzn,this,"width",Vn),this.isChanged=!0)}),VX(0,Vn,"textWidth",function(){return this._isChanged&&Vk.timer.runCallLater(this,this.typeset),this._textWidth}),VX(0,Vn,"height",function(){return this._height?this._height:this.textHeight},function(Vn){Vn!=this._height&&(Vk.superSet(Vzn,this,"height",Vn),this.isChanged=!0)}),VX(0,Vn,"textHeight",function(){return this._isChanged&&Vk.timer.runCallLater(this,this.typeset),this._textHeight}),VX(0,Vn,"padding",function(){return this._getCSSStyle().padding},function(Vn){this._getCSSStyle().padding=Vn,this.isChanged=!0}),VX(0,Vn,"bold",function(){return this._getCSSStyle().bold},function(Vn){this._getCSSStyle().bold=Vn,this.isChanged=!0}),VX(0,Vn,"text",function(){return this._text||""},function(Vn){this._text!==Vn&&(this.lang(Vn+""),this.isChanged=!0,this.event("change"))}),VX(0,Vn,"color",function(){return this._getCSSStyle().color},function(Vn){this._getCSSStyle().color!=Vn&&(this._getCSSStyle().color=Vn,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),VX(0,Vn,"font",function(){return this._getCSSStyle().fontFamily},function(Vn){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),Vq._bitmapFonts&&Vq._bitmapFonts[Vn]&&(this._currBitmapFont=Vq._bitmapFonts[Vn]),this._getCSSStyle().fontFamily=Vn,this.isChanged=!0}),VX(0,Vn,"fontSize",function(){return this._getCSSStyle().fontSize},function(Vn){this._getCSSStyle().fontSize=Vn,this.isChanged=!0}),VX(0,Vn,"italic",function(){return this._getCSSStyle().italic},function(Vn){this._getCSSStyle().italic=Vn,this.isChanged=!0}),VX(0,Vn,"align",function(){return this._getCSSStyle().align},function(Vn){this._getCSSStyle().align=Vn,this.isChanged=!0}),VX(0,Vn,"valign",function(){return this._getCSSStyle().valign},function(Vn){this._getCSSStyle().valign=Vn,this.isChanged=!0}),VX(0,Vn,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(Vn){this._getCSSStyle().wordWrap=Vn,this.isChanged=!0}),VX(0,Vn,"leading",function(){return this._getCSSStyle().leading},function(Vn){this._getCSSStyle().leading=Vn,this.isChanged=!0}),VX(0,Vn,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(Vn){this._getCSSStyle().backgroundColor=Vn,this.isChanged=!0}),VX(0,Vn,"borderColor",function(){return this._getCSSStyle().borderColor},function(Vn){this._getCSSStyle().borderColor=Vn,this.isChanged=!0}),VX(0,Vn,"stroke",function(){return this._getCSSStyle().stroke},function(Vn){this._getCSSStyle().stroke=Vn,this.isChanged=!0}),VX(0,Vn,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(Vn){this._getCSSStyle().strokeColor=Vn,this.isChanged=!0}),VX(0,Vn,"isChanged",null,function(Vn){this._isChanged!==Vn&&(this._isChanged=Vn)&&Vk.timer.callLater(this,this.typeset)}),VX(0,Vn,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(Vn){if(!(this.overflow!=Vq.SCROLL||this.textWidth<this._width)&&this._clipPoint){Vn=Vn<this.padding[3]?this.padding[3]:Vn;var Va=this._textWidth-this._width;Vn=Va<Vn?Va:Vn;var VU=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=Vn,this.renderText(this._lastVisibleLineIndex,VU)}}),VX(0,Vn,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(Vn){if(!(this.overflow!=Vq.SCROLL||this.textHeight<this._height)&&this._clipPoint){Vn=Vn<this.padding[0]?this.padding[0]:Vn;var Va=this._textHeight-this._height,VU=(Vn=Va<Vn?Va:Vn)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=VU;var Vx=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=Vn,this.renderText(VU,Vx)}}),VX(0,Vn,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),VX(0,Vn,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),VX(0,Vn,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),VX(0,Vn,"underlineColor",function(){return this._underlineColor},function(Vn){this._underlineColor=Vn,this._isChanged=!0,this.typeset()}),Vq.registerBitmapFont=function(Vn,Va){Vq._bitmapFonts||(Vq._bitmapFonts={}),Vq._bitmapFonts[Vn]=Va},Vq.unregisterBitmapFont=function(Vn,Va){if(void 0===Va&&(Va=!0),Vq._bitmapFonts&&Vq._bitmapFonts[Vn]){var VU=Vq._bitmapFonts[Vn];Va&&VU.destroy(),delete Vq._bitmapFonts[Vn]}},Vq.setTextRightToLeft=function(){var Vn;(Vn=Vf.canvas.source.style).display="none",Vn.position="absolute",Vn.direction="rtl",VI._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,Vf.document.body.appendChild(Vf.canvas.source)},Vq.supportFont=function(Vn){Vf.context.font="10px sans-serif";var Va=Vt.contextMeasureText("abcji").width;Vf.context.font="10px "+Vn;var VU=Vt.contextMeasureText("abcji").width;return console.log(Va,VU),Va!==VU},Vq._testWord="游",Vq.langPacks=null,Vq.VISIBLE="visible",Vq.SCROLL="scroll",Vq.HIDDEN="hidden",Vq.CharacterCache=!0,Vq.RightToLeft=!1,Vq._bitmapFonts=null,Vy(Vq,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),Vq}(Vzn),VPn=function(Vz){function VQ(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",VQ.__super.call(this),this.offset=new VN,this._canvasTransform=new Vc,this._previousOrientation=Vf.window.orientation;var Va=this;this.transform=Vc.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var Vn=Vf.window,VU=this;Vn.addEventListener("focus",function(){Va._isFocused=!0,VU.event("focus"),VU.event("focuschange")}),Vn.addEventListener("blur",function(){Va._isFocused=!1,VU.event("blur"),VU.event("focuschange"),VU._isInputting()&&(VYn.inputElement.target.focus=!1)});var Vx="visibilityState",VD="visibilitychange",Vp=Vn.document;void 0!==Vp.hidden?(VD="visibilitychange",Vx="visibilityState"):void 0!==Vp.mozHidden?(VD="mozvisibilitychange",Vx="mozVisibilityState"):void 0!==Vp.msHidden?(VD="msvisibilitychange",Vx="msVisibilityState"):void 0!==Vp.webkitHidden&&(VD="webkitvisibilitychange",Vx="webkitVisibilityState"),Vn.document.addEventListener(VD,function(){"hidden"==Vf.document[Vx]?VU._setStageVisible(!1):VU._setStageVisible(!0)}),Vn.document.addEventListener("qbrowserVisibilityChange",function(Vn){VU._setStageVisible(!Vn.hidden)}),Vn.addEventListener("resize",function(){var Vn=Vf.window.orientation;null!=Vn&&Vn!=Va._previousOrientation&&VU._isInputting()&&(VYn.inputElement.target.focus=!1),Va._previousOrientation=Vn,VU._isInputting()||VU._resetCanvas()}),Vn.addEventListener("orientationchange",function(Vn){VU._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),Vf.onMobile&&this.on("mousedown",this,this._onmouseMove)}Vm(VQ,"laya.display.Stage",Vz);var Vn=VQ.prototype;return Vn._setStageVisible=function(Vn){this._isVisibility!=Vn&&(this._isVisibility=Vn,this._isVisibility||this._isInputting()&&(VYn.inputElement.target.focus=!1),this.event("visibilitychange"))},Vn._isInputting=function(){return Vf.onMobile&&VYn.isInputting},Vn._changeCanvasSize=function(){this.setScreenSize(Vf.clientWidth*Vf.pixelRatio,Vf.clientHeight*Vf.pixelRatio)},Vn._resetCanvas=function(){if(this.screenAdaptationEnabled){var Vn=VI._mainCanvas;Vn.source.style;Vn.size(1,1),Vk.timer.once(100,this,this._changeCanvasSize)}},Vn.setScreenSize=function(Vn,Va){var VU=!1;if("none"!==this._screenMode&&(VU=(Vn/Va<1?"vertical":"horizontal")!==this._screenMode)){var Vx=Va;Va=Vn,Vn=Vx}this.canvasRotation=VU;var VD=VI._mainCanvas,Vp=VD.source.style,VQ=this._canvasTransform.identity(),VV=this._scaleMode,Vy=Vn/this.designWidth,VR=Va/this.designHeight,VX=this.designWidth,Vz=this.designHeight,Vi=Vn,Vq=Va,VE=Vf.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,VV){case"noscale":Vy=VR=1,Vi=this.designWidth,Vq=this.designHeight;break;case"showall":Vy=VR=Math.min(Vy,VR),VX=Vi=Math.round(this.designWidth*Vy),Vz=Vq=Math.round(this.designHeight*VR);break;case"noborder":Vy=VR=Math.max(Vy,VR),Vi=Math.round(this.designWidth*Vy),Vq=Math.round(this.designHeight*VR);break;case"full":Vy=VR=1,this._width=VX=Vn,this._height=Vz=Va;break;case"fixedwidth":VR=Vy,this._height=Vz=Math.round(Va/Vy);break;case"fixedheight":Vy=VR,this._width=VX=Math.round(Vn/VR);break;case"fixedauto":Vn/Va<this.designWidth/this.designHeight?(VR=Vy,this._height=Vz=Math.round(Va/Vy)):(Vy=VR,this._width=VX=Math.round(Vn/VR))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,VX=VX+1&2147483646,Vz=Vz+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),Vy*=this.scaleX,VR*=this.scaleY,1===Vy&&1===VR?this.transform.identity():(this.transform.a=this._formatData(Vy/(Vi/VX)),this.transform.d=this._formatData(VR/(Vq/Vz)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),VD.size(VX,Vz),Vu.changeWebGLSize(VX,Vz),VQ.scale(Vi/VX/VE,Vq/Vz/VE),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(Vn-Vi)/VE:this.offset.x=.5*(Vn-Vi)/VE,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(Va-Vq)/VE:this.offset.y=.5*(Va-Vq)/VE,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),VQ.translate(this.offset.x,this.offset.y),this.canvasDegree=0,VU&&("horizontal"===this._screenMode?(VQ.rotate(Math.PI/2),VQ.translate(Va/VE,0),this.canvasDegree=90):(VQ.rotate(-Math.PI/2),VQ.translate(0,Vn/VE),this.canvasDegree=-90)),VQ.a=this._formatData(VQ.a),VQ.d=this._formatData(VQ.d),VQ.tx=this._formatData(VQ.tx),VQ.ty=this._formatData(VQ.ty),Vp.transformOrigin=Vp.webkitTransformOrigin=Vp.msTransformOrigin=Vp.mozTransformOrigin=Vp.oTransformOrigin="0px 0px 0px",Vp.transform=Vp.webkitTransform=Vp.msTransform=Vp.mozTransform=Vp.oTransform="matrix("+VQ.toString()+")",VQ.translate(parseInt(Vp.left)||0,parseInt(Vp.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},Vn._formatData=function(Vn){return Math.abs(Vn)<1e-6?0:Math.abs(1-Vn)<.001?0<Vn?1:-1:Vn},Vn.getMousePoint=function(){return VN.TEMP.setTo(this.mouseX,this.mouseY)},Vn.repaint=function(){this._repaint=1},Vn.parentRepaint=function(){},Vn._loop=function(){return this.render(VI.context,0,0),!0},Vn._onmouseMove=function(Vn){this._mouseMoveTime=Vf.now()},Vn.getTimeFromFrameStart=function(){return Vf.now()-this._frameStartTime},Vn.render=function(Vn,Va,VU){if("sleep"===this._frameRate&&!VI.isConchApp){var Vx=Vf.now();if(!(1e3<=Vx-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(Vw.loopCount++,VE.instance.runEvent(),Vk.timer._update()));this._frameStartTime=Vx}if(this._renderCount++,VI.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=Vf.now();var VD="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),Vp=this._renderCount%2==0;if(Vw.renderSlow=!VD,VD||Vp||VI.isConchApp){var VQ;Vw.loopCount++,VE.instance.runEvent(),Vk.timer._update(),Vu.update3DLoop();var VV=0,Vy=0;if(VI.isConchNode)for(VV=0,Vy=this._scenes.length;VV<Vy;VV++)(VQ=this._scenes[VV])&&VQ._updateSceneConch();else for(VV=0,Vy=this._scenes.length;VV<Vy;VV++)(VQ=this._scenes[VV])&&VQ._updateScene();if(VI.isConchNode){var VR=Vzn.CustomList;for(VV=0,Vy=VR.length;VV<Vy;VV++){var VX=VR[VV];VX.customRender(VX.customContext,0,0)}return}}VI.isConchNode||this.renderingEnabled&&(VD||!Vp||VI.isConchWebGL)&&(VI.isWebGL?VI.WebGL.mainContext&&!VI.WebGL.mainContext.isContextLost()&&(Vn.clear(),Vz.prototype.render.call(this,Vn,Va,VU),Vw._show&&Vw._sp&&Vw._sp.render(Vn,Va,VU),Vu.clear(this._bgColor),Vu.beginFlush(),Vn.flush(),Vu.endFinish(),Vr.instance&&Vr.getInstance().endDispose()):(Vu.clear(this._bgColor),Vz.prototype.render.call(this,Vn,Va,VU),Vw._show&&Vw._sp&&Vw._sp.render(Vn,Va,VU)))}else this._renderCount%5==0&&(Vw.loopCount++,VE.instance.runEvent(),Vk.timer._update())},Vn._requestFullscreen=function(){var Vn=Vf.document.documentElement;Vn.requestFullscreen?Vn.requestFullscreen():Vn.mozRequestFullScreen?Vn.mozRequestFullScreen():Vn.webkitRequestFullscreen?Vn.webkitRequestFullscreen():Vn.msRequestFullscreen&&Vn.msRequestFullscreen()},Vn._fullScreenChanged=function(){Vk.stage.event("fullscreenchange")},Vn.exitFullscreen=function(){var Vn=Vf.document;Vn.exitFullscreen?Vn.exitFullscreen():Vn.mozCancelFullScreen?Vn.mozCancelFullScreen():Vn.webkitExitFullscreen&&Vn.webkitExitFullscreen()},VX(0,Vn,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),VX(0,Vn,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),VX(0,Vn,"frameRate",function(){return this._frameRate},function(Vn){if(this._frameRate=Vn,VI.isConchApp)switch(this._frameRate){case"slow":Vf.window.conch&&Vf.window.conchConfig.setSlowFrame&&Vf.window.conchConfig.setSlowFrame(!0);break;case"fast":Vf.window.conch&&Vf.window.conchConfig.setSlowFrame&&Vf.window.conchConfig.setSlowFrame(!1);break;case"mouse":Vf.window.conch&&Vf.window.conchConfig.setMouseFrame&&Vf.window.conchConfig.setMouseFrame(2e3);break;case"sleep":Vf.window.conch&&Vf.window.conchConfig.setLimitFPS&&Vf.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),VX(0,Vn,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),VX(0,Vn,"width",Vz.prototype._$get_width,function(Vn){this.designWidth=Vn,Vk.superSet(Vzn,this,"width",Vn),Vk.timer.callLater(this,this._changeCanvasSize)}),VX(0,Vn,"alignH",function(){return this._alignH},function(Vn){this._alignH=Vn,Vk.timer.callLater(this,this._changeCanvasSize)}),VX(0,Vn,"isFocused",function(){return this._isFocused}),VX(0,Vn,"height",Vz.prototype._$get_height,function(Vn){this.designHeight=Vn,Vk.superSet(Vzn,this,"height",Vn),Vk.timer.callLater(this,this._changeCanvasSize)}),VX(0,Vn,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||Vc.create()},Vz.prototype._$set_transform),VX(0,Vn,"isVisibility",function(){return this._isVisibility}),VX(0,Vn,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),VX(0,Vn,"scaleMode",function(){return this._scaleMode},function(Vn){this._scaleMode=Vn,Vk.timer.callLater(this,this._changeCanvasSize)}),VX(0,Vn,"alignV",function(){return this._alignV},function(Vn){this._alignV=Vn,Vk.timer.callLater(this,this._changeCanvasSize)}),VX(0,Vn,"bgColor",function(){return this._bgColor},function(Vn){this._bgColor=Vn,this.conchModel&&this.conchModel.bgColor(Vn),VI.isWebGL&&(Vn?VQ._wgColor=VB.create(Vn)._color:Vf.onMiniGame||(VQ._wgColor=null)),Vf.onLimixiu?VQ._wgColor=VB.create(Vn)._color:VI.canvas.style.background=Vn||"none"}),VX(0,Vn,"mouseX",function(){return Math.round(VE.instance.mouseX/this.clientScaleX)}),VX(0,Vn,"mouseY",function(){return Math.round(VE.instance.mouseY/this.clientScaleY)}),VX(0,Vn,"screenMode",function(){return this._screenMode},function(Vn){this._screenMode=Vn}),VX(0,Vn,"visible",Vz.prototype._$get_visible,function(Vn){this.visible!==Vn&&(Vk.superSet(Vzn,this,"visible",Vn),VI._mainCanvas.source.style.visibility=Vn?"visible":"hidden")}),VX(0,Vn,"fullScreenEnabled",null,function(Vn){var Va=Vf.document,VU=VI.canvas;Vn?(VU.addEventListener("mousedown",this._requestFullscreen),VU.addEventListener("touchstart",this._requestFullscreen),Va.addEventListener("fullscreenchange",this._fullScreenChanged),Va.addEventListener("mozfullscreenchange",this._fullScreenChanged),Va.addEventListener("webkitfullscreenchange",this._fullScreenChanged),Va.addEventListener("msfullscreenchange",this._fullScreenChanged)):(VU.removeEventListener("mousedown",this._requestFullscreen),VU.removeEventListener("touchstart",this._requestFullscreen),Va.removeEventListener("fullscreenchange",this._fullScreenChanged),Va.removeEventListener("mozfullscreenchange",this._fullScreenChanged),Va.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),Va.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),VQ.SCALE_NOSCALE="noscale",VQ.SCALE_EXACTFIT="exactfit",VQ.SCALE_SHOWALL="showall",VQ.SCALE_NOBORDER="noborder",VQ.SCALE_FULL="full",VQ.SCALE_FIXED_WIDTH="fixedwidth",VQ.SCALE_FIXED_HEIGHT="fixedheight",VQ.SCALE_FIXED_AUTO="fixedauto",VQ.ALIGN_LEFT="left",VQ.ALIGN_RIGHT="right",VQ.ALIGN_CENTER="center",VQ.ALIGN_TOP="top",VQ.ALIGN_MIDDLE="middle",VQ.ALIGN_BOTTOM="bottom",VQ.SCREEN_NONE="none",VQ.SCREEN_HORIZONTAL="horizontal",VQ.SCREEN_VERTICAL="vertical",VQ.FRAME_FAST="fast",VQ.FRAME_SLOW="slow",VQ.FRAME_MOUSE="mouse",VQ.FRAME_SLEEP="sleep",VQ.FRAME_MOUSE_THREDHOLD=2e3,Vy(VQ,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),VQ}(Vzn),VAn=(function(Vn){function Va(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,Va.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}Vm(Va,"laya.media.SoundNode",Vzn);var VU=Va.prototype;VU._onParentChange=function(){this.target=this.parent},VU.play=function(Vn,Va){void 0===Vn&&(Vn=1),isNaN(Vn)&&(Vn=1),this.url&&(this.stop(),this._channel=VZ.playSound(this.url,Vn,null,Va))},VU.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},VU._setPlayAction=function(Vn,Va,VU,Vx){void 0===Vx&&(Vx=!0),this[VU]&&Vn&&(Vx?Vn.on(Va,this,this[VU]):Vn.off(Va,this,this[VU]))},VU._setPlayActions=function(Vn,Va,VU,Vx){if(void 0===Vx&&(Vx=!0),Vn&&Va){var VD,Vp=Va.split(","),VQ=0;for(VD=Vp.length,VQ=0;VQ<VD;VQ++)this._setPlayAction(Vn,Vp[VQ],VU,Vx)}},VX(0,VU,"playEvent",null,function(Vn){(this._playEvents=Vn)&&this._tar&&this._setPlayActions(this._tar,Vn,"play")}),VX(0,VU,"target",null,function(Vn){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=Vn,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),VX(0,VU,"stopEvent",null,function(Vn){(this._stopEvents=Vn)&&this._tar&&this._setPlayActions(this._tar,Vn,"stop")})}(),function(Vn){function Va(){this._src=null,this._onload=null,this._onerror=null,Va.__super.call(this)}Vm(Va,"laya.resource.FileBitmap",VEn);var VU=Va.prototype;return VX(0,VU,"src",function(){return this._src},function(Vn){this._src=Vn}),VX(0,VU,"onload",null,function(Vn){}),VX(0,VU,"onerror",null,function(Vn){}),Va}()),VTn=function(Vn){function VU(Vn,Va){this._is2D=!1,VU.__super.call(this);var Vx=this;if(this._source=this,"2D"===Vn||"AUTO"===Vn&&!VI.isWebGL){this._is2D=!0,this._source=Va||Vf.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var VD=this;VD.getContext=function(Vn,Va){if(Vx._ctx)return Vx._ctx;var VU=Vx._ctx=Vx._source.getContext(Vn,Va);return VU&&(VU._canvas=VD,VI.isFlash||Vf.onLimixiu||(VU.size=function(Vn,Va){})),VU}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}Vm(VU,"laya.resource.HTMLCanvas",VEn);var Va=VU.prototype;return Va.clear=function(){this._ctx&&this._ctx.clear()},Va.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},Va.release=function(){},Va._setContext=function(Vn){this._ctx=Vn},Va.getContext=function(Vn,Va){return this._ctx?this._ctx:this._ctx=VU._createContext(this)},Va.getMemSize=function(){return 0},Va.size=function(Vn,Va){(this._w!=Vn||this._h!=Va||this._source&&(this._source.width!=Vn||this._source.height!=Va))&&(this._w=Vn,this._h=Va,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(Vn,Va),this._source&&(this._source.height=Va,this._source.width=Vn))},Va.getCanvas=function(){return this._source},Va.toBase64=function(Vn,Va,VU){if(this._source)if(VI.isConchApp&&this._source.toBase64)this._source.toBase64(Vn,Va,VU);else{var Vx=this._source.toDataURL(Vn,Va);VU.call(this,Vx)}},VX(0,Va,"context",function(){return this._ctx}),VX(0,Va,"asBitmap",null,function(Vn){}),VU.create=function(Vn,Va){return new VU(Vn,Va)},VU.TYPE2D="2D",VU.TYPE3D="3D",VU.TYPEAUTO="AUTO",VU._createContext=null,VU}(),VKn=(function(Vn){function Vy(Vn,Va,VU,Vx,VD,Vp,VQ,VV){throw Vy.__super.call(this),new Error("不允许new！")}Vm(Vy,"laya.resource.HTMLSubImage",VEn),Vy.create=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){return void 0===VV&&(VV=!1),new Vy(Vn,Va,VU,Vx,VD,Vp,VQ,VV)}}(),function(Vn){function Vz(){this._frames=null,this._url=null,Vz.__super.call(this),this._setControlNode(this)}Vm(Vz,"laya.display.Animation",Vn);var Va=Vz.prototype;Va.destroy=function(Vn){void 0===Vn&&(Vn=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,Vn),this._frames=null,this._labels=null},Va.play=function(Vn,Va,VU,Vx){void 0===Vn&&(Vn=0),void 0===Va&&(Va=!0),void 0===VU&&(VU=""),void 0===Vx&&(Vx=!0),VU&&this._setFramesFromCache(VU,Vx),this._isPlaying=!0,this.index="string"==typeof Vn?this._getFrameByLabel(Vn):Vn,this.loop=Va,this._actionName=VU,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},Va._setFramesFromCache=function(Vn,Va){var VU;return void 0===Va&&(Va=!1),this._url&&(Vn=this._url+"#"+Vn),Vn&&Vz.framesMap[Vn]?((VU=Vz.framesMap[Vn])instanceof Array?(this._frames=Vz.framesMap[Vn],this._count=this._frames.length):(VU.nodeRoot&&(Vz.framesMap[Vn]=this._parseGraphicAnimationByData(VU),VU=Vz.framesMap[Vn]),this._frames=VU.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=VU.interval),this._labels=this._copyLabels(VU.labels)),!0):(Va&&console.log("ani not found:",Vn),!1)},Va._copyLabels=function(Vn){if(!Vn)return null;var Va,VU;for(VU in Va={},Vn)Va[VU]=Vt.copyArray([],Vn[VU]);return Va},Va._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&Vn.prototype._frameLoop.call(this)},Va._displayToIndex=function(Vn){this._frames&&(this.graphics=this._frames[Vn])},Va.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},Va.loadImages=function(Vn,Va){return void 0===Va&&(Va=""),this._url="",this._setFramesFromCache(Va)||(this.frames=Vz.framesMap[Va]?Vz.framesMap[Va]:Vz.createFrames(Vn,Va)),this},Va.loadAtlas=function(Va,VU,Vx){void 0===Vx&&(Vx=""),this._url="";var VD=this;function Vn(Vn){Va===Vn&&(VD.frames=Vz.framesMap[Vx]?Vz.framesMap[Vx]:Vz.createFrames(Va,Vx),VU&&VU.run())}return VD._setFramesFromCache(Vx)||(VVn.getAtlas(Va)?Vn(Va):Vk.loader.load(Va,VA.create(null,Vn,[Va]),null,"atlas")),this},Va.loadAnimation=function(Vn,Va,VU){this._url=Vn;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,Va&&Va.run()):!VU||VVn.getAtlas(VU)?this._loadAnimationData(Vn,Va,VU):Vk.loader.load(VU,VA.create(this,this._loadAnimationData,[Vn,Va,VU]),null,"atlas"),this},Va._loadAnimationData=function(VV,Vy,Vn){var VR=this;if(!Vn||VVn.getAtlas(Vn)){var VX=this;VVn.getRes(VV)?Va(VV):Vk.loader.load(VV,VA.create(null,Va,[VV]),null,"json"),VVn.clearRes(VV)}else console.warn("atlas load fail:"+Vn);function Va(Vn){if(VVn.getRes(Vn)&&VV===Vn){var Va;if(Vz.framesMap[VV+"#"])VX._setFramesFromCache(VR._actionName,!0),VR.index=0,VR._checkResumePlaying();else{var VU=VX._parseGraphicAnimation(VVn.getRes(VV));if(!VU)return;var Vx,VD=VU.animationList,Vp=0,VQ=VD.length;for(Vp=0;Vp<VQ;Vp++)Va=VD[Vp],Vz.framesMap[VV+"#"+Va.name]=Va,Vx||(Vx=Va);Vx&&(Vz.framesMap[VV+"#"]=Vx,VX._setFramesFromCache(VR._actionName,!0),VR.index=0),VR._checkResumePlaying()}Vy&&Vy.run()}}},Va._parseGraphicAnimation=function(Vn){return Vkn.parseAnimationData(Vn)},Va._parseGraphicAnimationByData=function(Vn){return Vkn.parseAnimationByData(Vn)},VX(0,Va,"frames",function(){return this._frames},function(Vn){(this._frames=Vn)&&(this._count=Vn.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),VX(0,Va,"autoPlay",null,function(Vn){Vn?this.play():this.stop()}),VX(0,Va,"source",null,function(Vn){-1<Vn.indexOf(".ani")?this.loadAnimation(Vn):-1<Vn.indexOf(".json")||-1<Vn.indexOf("als")||-1<Vn.indexOf("atlas")?this.loadAtlas(Vn):this.loadImages(Vn.split(","))}),VX(0,Va,"autoAnimation",null,function(Vn){this.play(0,!0,Vn,!1)}),Vz.createFrames=function(Vn,Va){var VU,Vx,VD=0,Vp=0;if("string"==typeof Vn){var VQ=VVn.getAtlas(Vn);if(VQ&&VQ.length)for(VU=[],VD=0,Vp=VQ.length;VD<Vp;VD++)(Vx=new Vu.createGraphics).drawTexture(VVn.getRes(VQ[VD]),0,0),VU.push(Vx)}else if(Vn instanceof Array)for(VU=[],VD=0,Vp=Vn.length;VD<Vp;VD++)(Vx=new Vu.createGraphics).loadImage(Vn[VD],0,0),VU.push(Vx);return Va&&(Vz.framesMap[Va]=VU),VU},Vz.clearCache=function(Vn){var Va,VU=Vz.framesMap,Vx=Vn+"#";for(Va in VU)Va!==Vn&&0!=Va.indexOf(Vx)||delete Vz.framesMap[Va]},Vz.framesMap={}}(Vmn),function(Vn){function Vp(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,Vp.__super.call(this),null==Vp._sortIndexFun&&(Vp._sortIndexFun=VW.sortByKey("index",!1,!0))}Vm(Vp,"laya.display.FrameAnimation",Vn);var Va=Vp.prototype;return Va._setUp=function(Vn,Va){this._labels=null,this._animationNewFrames=null,this._targetDic=Vn,this._animationData=Va,this.interval=1e3/Va.frameRate,Va.parsed?(this._count=Va.count,this._labels=Va.labels,this._animationNewFrames=Va.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),Va.parsed=!0,Va.labels=this._labels,Va.count=this._count,Va.animationNewFrames=this._animationNewFrames},Va.clear=function(){Vn.prototype.clear.call(this),this._targetDic=null,this._animationData=null},Va._displayToIndex=function(Vn){if(this._animationData){Vn<0&&(Vn=0),Vn>this._count&&(Vn=this._count);var Va=this._animationData.nodes,VU=0,Vx=Va.length;for(VU=0;VU<Vx;VU++)this._displayNodeToFrame(Va[VU],Vn)}},Va._displayNodeToFrame=function(Vn,Va,VU){VU||(VU=this._targetDic);var Vx=VU[Vn.target];if(Vx){var VD,Vp,VQ,VV=Vn.frames,Vy=Vn.keys,VR=0,VX=Vy.length;for(VR=0;VR<VX;VR++)VQ=(Vp=VV[VD=Vy[VR]]).length>Va?Vp[Va]:Vp[Vp.length-1],Vx[VD]=VQ}},Va._calculateDatas=function(){if(this._animationData){var Vn,Va=this._animationData.nodes,VU=0,Vx=Va.length;for(VU=this._count=0;VU<Vx;VU++)Vn=Va[VU],this._calculateNodeKeyFrames(Vn);this._count+=1}},Va._calculateNodeKeyFrames=function(Vn){var Va,VU,Vx=Vn.keyframes,VD=Vn.target;for(Va in Vn.frames||(Vn.frames={}),Vn.keys?Vn.keys.length=0:Vn.keys=[],Vn.initValues||(Vn.initValues={}),Vx)VU=Vx[Va],Vn.frames[Va]||(Vn.frames[Va]=[]),this._targetDic&&this._targetDic[VD]&&(Vn.initValues[Va]=this._targetDic[VD][Va]),VU.sort(Vp._sortIndexFun),Vn.keys.push(Va),this._calculateNodePropFrames(VU,Vn.frames[Va],Va,VD)},Va.resetToInitState=function(){if(this._targetDic&&this._animationData){var Vn,Va,VU=this._animationData.nodes,Vx=0,VD=VU.length;for(Vx=0;Vx<VD;Vx++)if(Va=(Vn=VU[Vx]).initValues){var Vp,VQ=this._targetDic[Vn.target];if(VQ)for(Vp in Va)VQ[Vp]=Va[Vp]}}},Va._calculateNodePropFrames=function(Vn,Va,VU,Vx){var VD=0,Vp=Vn.length-1;if(0<Vp){for(Va.length=Vn[Vp].index+1,VD=0;VD<Vp;VD++)this._dealKeyFrame(Vn[VD]),this._calculateFrameValues(Vn[VD],Vn[VD+1],Va);this._dealKeyFrame(Vn[VD])}0==Vp&&(Va[Vn[0].index]=Vn[0].value,this._animationNewFrames&&(this._animationNewFrames[Vn[0].index]=!0))},Va._dealKeyFrame=function(Vn){Vn.label&&""!=Vn.label&&this.addLabel(Vn.label,Vn.index)},Va._calculateFrameValues=function(Vn,Va,VU){var Vx,VD=0,Vp=Vn.index,VQ=Va.index,VV=Vn.value,Vy=Va.value-Vn.value,VR=VQ-Vp;if(VQ>this._count&&(this._count=VQ),Vn.tween)for(null==(Vx=VL[Vn.tweenMethod])&&(Vx=VL.linearNone),VD=Vp;VD<VQ;VD++)VU[VD]=Vx(VD-Vp,VV,Vy,VR),this._animationNewFrames&&(this._animationNewFrames[VD]=!0);else for(VD=Vp;VD<VQ;VD++)VU[VD]=VV;this._animationNewFrames&&(this._animationNewFrames[Vn.index]=!0,this._animationNewFrames[Va.index]=!0),VU[Va.index]=Va.value},Vp._sortIndexFun=null,Vp}(Vmn)),VYn=function(Va){function VD(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",VD.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=Vbn.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}Vm(VD,"laya.display.Input",Va);var Vn=VD.prototype;return Vn.setSelection=function(Vn,Va){this.focus=!0,laya.display.Input.inputElement.selectionStart=Vn,laya.display.Input.inputElement.selectionEnd=Va},Vn._onUnDisplay=function(Vn){this.focus=!1},Vn._onMouseDown=function(Vn){this.focus=!0},Vn._syncInputTransform=function(){var Vn=this.nativeInput,Va=Vt.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),VU=this._width-this.padding[1]-this.padding[3],Vx=this._height-this.padding[0]-this.padding[2];VI.isConchApp?(Vn.setScale(Va.scaleX,Va.scaleY),Vn.setSize(VU,Vx),Vn.setPos(Va.x,Va.y)):(VD.inputContainer.style.transform=VD.inputContainer.style.webkitTransform="scale("+Va.scaleX+","+Va.scaleY+") rotate("+Vk.stage.canvasDegree+"deg)",Vn.style.width=VU+"px",Vn.style.height=Vx+"px",VD.inputContainer.style.left=Va.x+"px",VD.inputContainer.style.top=Va.y+"px")},Vn.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},Vn._setInputMethod=function(){VD.input.parentElement&&VD.inputContainer.removeChild(VD.input),VD.area.parentElement&&VD.inputContainer.removeChild(VD.area),VD.inputElement=this._multiline?VD.area:VD.input,VD.inputContainer.appendChild(VD.inputElement),Vbn.RightToLeft&&(VD.inputElement.style.direction="rtl")},Vn._focusIn=function(){laya.display.Input.isInputting=!0;var Vn=this.nativeInput;this._focus=!0;var Va=Vn.style;Va.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),Vn.readOnly=!this._editable,VI.isConchApp&&(Vn.setType(this._type),Vn.setForbidEdit(!this._editable)),Vn.maxLength=this._maxChars;this.padding;if(Vn.type=this._type,Vn.value=this._content,Vn.placeholder=this._prompt,Vk.stage.off("keydown",this,this._onKeyDown),Vk.stage.on("keydown",this,this._onKeyDown),(Vk.stage.focus=this).event("focus"),Vf.onPC&&Vn.focus(),!Vf.onMiniGame){this._text;this._text=null}this.typeset(),Vn.setColor(this._originColor),Vn.setFontSize(this.fontSize),Vn.setFontFace(Vf.onIPhone&&Vbn._fontFamilyMap[this.font]||this.font),VI.isConchApp&&Vn.setMultiAble&&Vn.setMultiAble(this._multiline),Va.lineHeight=this.leading+this.fontSize+"px",Va.fontStyle=this.italic?"italic":"normal",Va.fontWeight=this.bold?"bold":"normal",Va.textAlign=this.align,Va.padding="0 0",this._syncInputTransform(),!VI.isConchApp&&Vf.onPC&&Vk.timer.frameLoop(1,this,this._syncInputTransform)},Vn._setPromptColor=function(){(VD.promptStyleDOM=Vf.getElementById("promptStyle"))||((VD.promptStyleDOM=Vf.createElement("style")).setAttribute("id","promptStyle"),Vf.document.head.appendChild(VD.promptStyleDOM)),VD.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},Vn._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(Vk.superSet(Vbn,this,"text",this._content),Vk.superSet(Vbn,this,"color",this._originColor)):(Vk.superSet(Vbn,this,"text",this._prompt),Vk.superSet(Vbn,this,"color",this._promptColor)),Vk.stage.off("keydown",this,this._onKeyDown),Vk.stage.focus=null,this.event("blur"),VI.isConchApp&&this.nativeInput.blur(),Vf.onPC&&Vk.timer.clear(this,this._syncInputTransform)},Vn._onKeyDown=function(Vn){13===Vn.keyCode&&(Vf.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},Vn.changeText=function(Vn){this._content=Vn,this._focus?(this.nativeInput.value=Vn||"",this.event("change")):Va.prototype.changeText.call(this,Vn)},VX(0,Vn,"color",Va.prototype._$get_color,function(Vn){this._focus&&this.nativeInput.setColor(Vn),Vk.superSet(Vbn,this,"color",this._content?Vn:this._promptColor),this._originColor=Vn}),VX(0,Vn,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(Vn){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),VX(0,Vn,"multiline",function(){return this._multiline},function(Vn){this._multiline=Vn,this.valign=Vn?"top":"middle"}),VX(0,Vn,"maxChars",function(){return this._maxChars},function(Vn){Vn<=0&&(Vn=1e5),this._maxChars=Vn}),VX(0,Vn,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(Vn){Vk.superSet(Vbn,this,"color",this._originColor),Vn+="",this._focus?(this.nativeInput.value=Vn||"",this.event("change")):(this._multiline||(Vn=Vn.replace(/\r?\n/g,"")),(this._content=Vn)?Vk.superSet(Vbn,this,"text",Vn):(Vk.superSet(Vbn,this,"text",this._prompt),Vk.superSet(Vbn,this,"color",this.promptColor)))}),VX(0,Vn,"nativeInput",function(){return this._multiline?VD.area:VD.input}),VX(0,Vn,"prompt",function(){return this._prompt},function(Vn){!this._text&&Vn&&Vk.superSet(Vbn,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?Vk.superSet(Vbn,this,"text",this._text==this._prompt?Vn:this._text):Vk.superSet(Vbn,this,"text",Vn),this._prompt=Vbn.langPacks&&Vbn.langPacks[Vn]?Vbn.langPacks[Vn]:Vn}),VX(0,Vn,"focus",function(){return this._focus},function(Vn){var Va=this.nativeInput;this._focus!==Vn&&(Vn?(Va.target?Va.target._focusOut():this._setInputMethod(),(Va.target=this)._focusIn()):(Va.target=null,this._focusOut(),Vf.document.body.scrollTop=0,Va.blur(),VI.isConchApp?Va.setPos(-1e4,-1e4):VD.inputContainer.contains(Va)&&VD.inputContainer.removeChild(Va)))}),VX(0,Vn,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(Vn){Vn?(-1<(Vn="[^"+Vn+"]").indexOf("^^")&&(Vn=Vn.replace("^^","")),this._restrictPattern=new RegExp(Vn,"g")):this._restrictPattern=null}),VX(0,Vn,"editable",function(){return this._editable},function(Vn){this._editable=Vn,VI.isConchApp&&VD.input.setForbidEdit(!Vn)}),VX(0,Vn,"promptColor",function(){return this._promptColor},function(Vn){this._promptColor=Vn,this._content||Vk.superSet(Vbn,this,"color",Vn)}),VX(0,Vn,"type",function(){return this._type},function(Vn){this._getCSSStyle().password="password"==Vn,this._type=Vn,VI.isConchApp&&this.nativeInput.setType(Vn)}),VX(0,Vn,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(Vn){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),VX(0,Vn,"asPassword",function(){return this._getCSSStyle().password},function(Vn){this._getCSSStyle().password=Vn,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),VD.__init__=function(){VD._createInputElement(),Vf.onMobile&&VI.canvas.addEventListener(VD.IOS_IFRAME?Vf.onMiniGame?"touchend":"click":"touchend",VD._popupInputMethod)},VD._popupInputMethod=function(Vn){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},VD._createInputElement=function(){VD._initInput(VD.area=Vf.createElement("textarea")),VD._initInput(VD.input=Vf.createElement("input")),(VD.inputContainer=Vf.createElement("div")).style.position="absolute",VD.inputContainer.style.zIndex=1e5,Vf.container.appendChild(VD.inputContainer),VD.inputContainer.setPos=function(Vn,Va){VD.inputContainer.style.left=Vn+"px",VD.inputContainer.style.top=Va+"px"}},VD._initInput=function(Va){var Vn=Va.style;Vn.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",Vn.resize="none",Vn.backgroundColor="transparent",Vn.border="none",Vn.outline="none",Vn.zIndex=1,Va.addEventListener("input",VD._processInputting),Va.addEventListener("mousemove",VD._stopEvent),Va.addEventListener("mousedown",VD._stopEvent),Va.addEventListener("touchmove",VD._stopEvent),Va.setFontFace=function(Vn){Va.style.fontFamily=Vn},VI.isConchApp||(Va.setColor=function(Vn){Va.style.color=Vn},Va.setFontSize=function(Vn){Va.style.fontSize=Vn+"px"})},VD._processInputting=function(Vn){var Va=laya.display.Input.inputElement.target;if(Va){var VU=laya.display.Input.inputElement.value;Va._restrictPattern&&(VU=VU.replace(/\u2006|\x27/g,""),Va._restrictPattern.test(VU)&&(VU=VU.replace(Va._restrictPattern,""),laya.display.Input.inputElement.value=VU)),Va._text=VU,Va.event("input")}},VD._stopEvent=function(Vn){"touchmove"==Vn.type&&Vn.preventDefault(),Vn.stopPropagation&&Vn.stopPropagation()},VD.TYPE_TEXT="text",VD.TYPE_PASSWORD="password",VD.TYPE_EMAIL="email",VD.TYPE_URL="url",VD.TYPE_NUMBER="number",VD.TYPE_RANGE="range",VD.TYPE_DATE="date",VD.TYPE_MONTH="month",VD.TYPE_WEEK="week",VD.TYPE_TIME="time",VD.TYPE_DATE_TIME="datetime",VD.TYPE_DATE_TIME_LOCAL="datetime-local",VD.TYPE_SEARCH="search",VD.input=null,VD.area=null,VD.inputElement=null,VD.inputContainer=null,VD.confirmButton=null,VD.promptStyleDOM=null,VD.inputHeight=45,VD.isInputting=!1,VD.stageMatrix=null,Vy(VD,["IOS_IFRAME",function(){return this.IOS_IFRAME=Vf.onIOS&&Vf.window.top!=Vf.window.self}]),VD}(Vbn),VWn=function(Vn){function VU(Vn,Va){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,VU.__super.call(this),Vn&&this._init_(Vn,Va)}Vm(VU,"laya.resource.HTMLImage",VAn);var Va=VU.prototype;return Va._init_=function(Vn,Va){this._src=Vn,this._source=new Vf.window.Image,Va&&(Va.onload&&(this.onload=Va.onload),Va.onerror&&(this.onerror=Va.onerror),Va.onCreate&&Va.onCreate(this)),0!=Vn.indexOf("data:image")&&(this._source.crossOrigin=""),Vn&&(this._source.src=Vn)},Va.recreateResource=function(){var Vn=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var Va=this;this._source=new Vf.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(Va._needReleaseAgain)return Va._needReleaseAgain=!1,Va._source.onload=null,void(Va._source=null);Va._source.onload=null,Va.memorySize=Vn._w*Vn._h*4,Va._recreateLock=!1,Va.completeCreate()},this._source.src=this._src}},Va.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},Va.onresize=function(){this._w=this._source.width,this._h=this._source.height},VX(0,Va,"onload",null,function(Vn){var Va=this;this._onload=Vn,this._source&&(this._source.onload=null!=this._onload?function(){Va.onresize(),Va._onload()}:null)}),VX(0,Va,"onerror",null,function(Vn){var Va=this;this._onerror=Vn,this._source&&(this._source.onerror=null!=this._onerror?function(){Va._onerror()}:null)}),VX(0,Va,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(Vn){this._enableMerageInAtlas=Vn,VI.isConchApp&&this._source&&(this._source.enableMerageInAtlas=Vn)}),VU.create=function(Vn,Va){return new VU(Vn,Va)},VU}(),Vkn=(function(Vp){function Vn(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,Vn.__super.call(this)}Vm(Vn,"laya.display.EffectAnimation",Vp);var Va=Vn.prototype;Va._onOtherBegin=function(Vn){Vn!=this&&this.stop()},Va.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},Va._onPlayAction=function(){this.play(0,!1)},Va.play=function(Vn,Va,VU,Vx){void 0===Vn&&(Vn=0),void 0===Va&&(Va=!0),void 0===VU&&(VU=""),void 0===Vx&&(Vx=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,Vn,Va,VU,Vx))},Va._recordInitData=function(){if(this._aniKeys){var Vn,Va,VU=0;for(Vn=this._aniKeys.length,VU=0;VU<Vn;VU++)Va=this._aniKeys[VU],this._initData[Va]=this._target[Va]}},Va._displayToIndex=function(Vn){if(this._animationData){Vn<0&&(Vn=0),Vn>this._count&&(Vn=this._count);var Va=this._animationData.nodes,VU=0,Vx=Va.length;for(Vx=1<Vx?1:Vx,VU=0;VU<Vx;VU++)this._displayNodeToFrame(Va[VU],Vn)}},Va._displayNodeToFrame=function(Vn,Va,VU){if(this._target){var Vx;Vx=this._target;var VD,Vp,VQ,VV,Vy=Vn.frames,VR=Vn.keys,VX=0,Vz=VR.length;VV=Vn.secondFrames;var Vi,Vq,VE,Vm,Vb=0;for(VX=0;VX<Vz;VX++)Vp=Vy[VD=VR[VX]],VQ=-1==(Vb=VV[VD])?this._initData[VD]:Va<Vb?(VE=(Vq=Vn.keyframes[VD])[0]).tween?(null==(Vi=VL[VE.tweenMethod])&&(Vi=VL.linearNone),Vm=Vq[1],Vi(Va,this._initData[VD],Vm.value-this._initData[VD],Vm.index)):this._initData[VD]:Vp.length>Va?Vp[Va]:Vp[Vp.length-1],Vx[VD]=VQ}},Va._calculateNodeKeyFrames=function(Vn){Vp.prototype._calculateNodeKeyFrames.call(this,Vn);var Va,VU,Vx,VD=Vn.keyframes;Vn.target;for(Va in Vx={},Vn.secondFrames=Vx,VD)(VU=VD[Va]).length<=1?Vx[Va]=-1:Vx[Va]=VU[1].index},VX(0,Va,"target",function(){return this._target},function(Vn){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=Vn,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),VX(0,Va,"playEvent",null,function(Vn){(this._playEvents=Vn)&&this.addEvent()}),VX(0,Va,"effectData",null,function(Vn){var Va;Vn&&((Va=Vn.animations)&&Va[0]&&(this._setUp({},Va[0]),Va[0].nodes&&Va[0].nodes[0]&&(this._aniKeys=Va[0].nodes[0].keys)))}),VX(0,Va,"effectClass",null,function(Vn){var Va,VU;(this._effectClass=Vo.getClass(Vn),this._effectClass)&&((Va=this._effectClass.uiView)&&(VU=Va.animations)&&VU[0]&&(this._setUp({},VU[0]),VU[0].nodes&&VU[0].nodes[0]&&(this._aniKeys=VU[0].nodes[0].keys)))}),Vn.EffectAnimationBegin="effectanimationbegin"}(VKn),function(Va){var VM;function VZ(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,VZ.__super.call(this)}Vm(VZ,"laya.utils.GraphicAnimation",Va);var Vn=VZ.prototype;return Vn._parseNodeList=function(Vn){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[Vn.compId]=Vn.props,Vn.compId&&this._nodeList.push(Vn.compId);var Va=Vn.child;if(Va){var VU=0,Vx=Va.length;for(VU=0;VU<Vx;VU++)this._parseNodeList(Va[VU])}},Vn._calGraphicData=function(Vn){var Va;if(this._setUp(null,Vn),this._createGraphicData(),this._nodeIDAniDic)for(Va in this._nodeIDAniDic)this._nodeIDAniDic[Va]=null},Vn._createGraphicData=function(){var Vn,Va=[],VU=0,Vx=this.count,VD=this._animationNewFrames;for(VD||(VD=[]),VU=0;VU<Vx;VU++)!VD[VU]&&Vn||(Vn=this._createFrameGraphic(VU)),Va.push(Vn);this._gList=Va},Vn._createFrameGraphic=function(Vn){var Va=Vu.createGraphics();return VZ._rootMatrix||(VZ._rootMatrix=new Vc),this._updateNodeGraphic(this._rootNode,Vn,VZ._rootMatrix,Va),Va},Vn._updateNodeGraphic=function(Vn,Va,VU,Vx,VD){var Vp;void 0===VD&&(VD=1);var VQ,VV,Vy,VR=(Vp=this._nodeGDic[Vn.compId]=this._getNodeGraphicData(Vn.compId,Va,this._nodeGDic[Vn.compId])).alpha*VD;if(!(VR<.01)&&(Vp.resultTransform||(Vp.resultTransform=Vc.create()),VQ=Vp.resultTransform,Vc.mul(Vp.transform,VU,VQ),Vp.skin&&(VV=this._getTextureByUrl(Vp.skin))&&(VQ._checkTransform()?(Vx.drawTexture(VV,0,0,Vp.width,Vp.height,VQ,VR),Vp.resultTransform=null):Vx.drawTexture(VV,VQ.tx,VQ.ty,Vp.width,Vp.height,null,VR)),Vy=Vn.child)){var VX,Vz=0;for(VX=Vy.length,Vz=0;Vz<VX;Vz++)this._updateNodeGraphic(Vy[Vz],Va,VQ,Vx,VR)}},Vn._updateNoChilds=function(Vn,Va){if(Vn.skin){var VU=this._getTextureByUrl(Vn.skin);if(VU){var Vx=Vn.transform;Vx._checkTransform();!Vx.bTransform?Va.drawTexture(VU,Vx.tx,Vx.ty,Vn.width,Vn.height,null,Vn.alpha):Va.drawTexture(VU,0,0,Vn.width,Vn.height,Vx.clone(),Vn.alpha)}}},Vn._updateNodeGraphic2=function(Vn,Va,VU){var Vx;if(Vx=this._nodeGDic[Vn.compId]=this._getNodeGraphicData(Vn.compId,Va,this._nodeGDic[Vn.compId]),Vn.child){var VD=Vx.transform;VD._checkTransform();var Vp,VQ;VQ=(Vp=!VD.bTransform)&&(0!=VD.tx||0!=VD.ty);var VV,Vy,VR;if((VV=VD.bTransform||1!=Vx.alpha)&&VU.save(),1!=Vx.alpha&&VU.alpha(Vx.alpha),Vp?VQ&&VU.translate(VD.tx,VD.ty):VU.transform(VD.clone()),Vy=Vn.child,Vx.skin&&(VR=this._getTextureByUrl(Vx.skin))&&VU.drawTexture(VR,0,0,Vx.width,Vx.height),Vy){var VX,Vz=0;for(VX=Vy.length,Vz=0;Vz<VX;Vz++)this._updateNodeGraphic2(Vy[Vz],Va,VU)}VV?VU.restore():Vp?VQ&&VU.translate(-VD.tx,-VD.ty):VU.transform(VD.clone().invert())}else this._updateNoChilds(Vx,VU)},Vn._calculateNodeKeyFrames=function(Vn){Va.prototype._calculateNodeKeyFrames.call(this,Vn),this._nodeIDAniDic[Vn.target]=Vn},Vn.getNodeDataByID=function(Vn){return this._nodeIDAniDic[Vn]},Vn._getParams=function(Vn,Va,VU,Vx){var VD=VZ._temParam;VD.length=Va.length;var Vp=0,VQ=Va.length;for(Vp=0;Vp<VQ;Vp++)VD[Vp]=this._getObjVar(Vn,Va[Vp][0],VU,Va[Vp][1],Vx);return VD},Vn._getObjVar=function(Vn,Va,VU,Vx,VD){if(Vn.hasOwnProperty(Va)){var Vp=Vn[Va];if(VU>=Vp.length&&(VU=Vp.length-1),null!=Vn[Va][VU])return Vn[Va][VU]}return VD.hasOwnProperty(Va)?VD[Va]:Vx},Vn._getNodeGraphicData=function(Vn,Va,VU){VU||(VU=VM.create()),VU.transform?VU.transform.identity():VU.transform=Vc.create();var Vx=this.getNodeDataByID(Vn);if(!Vx)return VU;var VD,Vp,VQ=Vx.frames,VV=this._getParams(VQ,VZ._drawTextureCmd,Va,this._nodeDefaultProps[Vn]),Vy=VV[0],VR=NaN,VX=NaN,Vz=VV[5],Vi=VV[6],Vq=VV[13],VE=VV[14],Vm=VV[7],Vb=VV[8],VP=VV[9],VA=VV[11],VT=VV[12];VR=VV[3],VX=VV[4],0!=VR&&0!=VX||(Vy=null),-1==VR&&(VR=0),-1==VX&&(VX=0),VU.skin=Vy,VU.width=VR,VU.height=VX,Vy&&((VD=this._getTextureByUrl(Vy))?(VR||(VR=VD.sourceWidth),VX||(VX=VD.sourceHeight)):console.warn("lost skin:",Vy,",you may load pics first")),VU.alpha=VV[10],Vp=VU.transform,0!=Vq&&(Vz=Vq*VR),0!=VE&&(Vi=VE*VX),0==Vz&&0==Vi||Vp.translate(-Vz,-Vi);var VK=null;if(VP||1!==Vm||1!==Vb||VA||VT){(VK=VZ._tempMt).identity(),VK.bTransform=!0;var VY=.0174532922222222*(VP-VA),VW=.0174532922222222*(VP+VT),Vk=Math.cos(VW),VN=Math.sin(VW),V_=Math.sin(VY),V$=Math.cos(VY);VK.a=Vm*Vk,VK.b=Vm*VN,VK.c=-Vb*V_,VK.d=Vb*V$,VK.tx=VK.ty=0}return VK&&(Vp=Vc.mul(Vp,VK,Vp)),Vp.translate(VV[1],VV[2]),VU},Vn._getTextureByUrl=function(Vn){return VVn.getRes(Vn)},Vn.setAniData=function(Vn,Va){if(Vn.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=Vn,this._parseNodeList(Vn);var VU,Vx={},VD=[],Vp=Vn.animations,VQ=0,VV=Vp.length;for(VQ=0;VQ<VV;VQ++)if(VU=Vp[VQ],this._labels=null,(!Va||Va==VU.name)&&VU){try{this._calGraphicData(VU)}catch(Vn){console.warn("parse animation fail:"+VU.name+",empty animation created"),this._gList=[]}var Vy={};Vy.interval=1e3/VU.frameRate,Vy.frames=this._gList,Vy.labels=this._labels,Vy.name=VU.name,VD.push(Vy),Vx[VU.name]=Vy}this.animationList=VD,this.animationDic=Vx}VZ._temParam.length=0},Vn.parseByData=function(Vn){var Va,VU;Va=Vn.nodeRoot,VU=Vn.aniO,delete Vn.nodeRoot,delete Vn.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=Va,this._parseNodeList(Va),this._labels=null;try{this._calGraphicData(VU)}catch(Vn){console.warn("parse animation fail:"+VU.name+",empty animation created"),this._gList=[]}var Vx=Vn;return Vx.interval=1e3/VU.frameRate,Vx.frames=this._gList,Vx.labels=this._labels,Vx.name=VU.name,Vx},Vn.setUpAniData=function(Vn){if(Vn.animations){var Va,VU={},Vx=[],VD=Vn.animations,Vp=0,VQ=VD.length;for(Vp=0;Vp<VQ;Vp++)if(Va=VD[Vp]){var VV={};VV.name=Va.name,VV.aniO=Va,VV.nodeRoot=Vn,Vx.push(VV),VU[Va.name]=VV}this.animationList=Vx,this.animationDic=VU}},Vn._clear=function(){var Vn,Va;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(Vn in this._nodeGDic)(Va=this._nodeGDic[Vn])&&Va.recover();this._nodeGDic=null},VZ.parseAnimationByData=function(Vn){var Va;return VZ._I||(VZ._I=new VZ),Va=VZ._I.parseByData(Vn),VZ._I._clear(),Va},VZ.parseAnimationData=function(Vn){var Va;return VZ._I||(VZ._I=new VZ),VZ._I.setUpAniData(Vn),(Va={}).animationList=VZ._I.animationList,Va.animationDic=VZ._I.animationDic,VZ._I._clear(),Va},VZ._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],VZ._temParam=[],VZ._I=null,VZ._rootMatrix=null,Vy(VZ,["_tempMt",function(){return this._tempMt=new Vc}]),VZ.__init$=function(){VM=function(){function Vn(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return Vm(Vn,""),Vn.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),VS.recover("GraphicNode",this)},Vn.create=function(){return VS.getItemByClass("GraphicNode",Vn)},Vn}()},VZ}(VKn));Vk.__init([VR,Vyn,VI,Vf,Vs,V$,Vn,Vkn])}(window,document,Laya),function(Vn,Va,VU){VU.un,VU.uns,VU.static;var Vx=VU.class;VU.getset,VU.__newvec;new(function(){function Vn(){}return Vx(Vn,"LayaMain"),Vn}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Vn,Va){"use strict";for(var VU in Object.defineProperty(Va,"__esModule",{value:!0}),Laya){var Vx=Laya[VU];Vx&&Vx.__isclass&&(Va[VU]=Vx)}}),function(Vn,Va,VW){VW.un,VW.uns;var VQ=VW.static,Vi=VW.class,Vx=VW.getset,Vp=VW.__newvec,VX=laya.maths.Arith,Vz=laya.maths.Bezier,VU=laya.resource.Bitmap,Vq=laya.utils.Browser,Vy=laya.utils.Byte,VE=laya.utils.Color,Vk=(laya.filters.ColorFilter,VW.Config),VD=laya.resource.Context,VN=(laya.events.Event,laya.filters.Filter),VV=laya.display.Graphics,VR=laya.resource.HTMLCanvas,Vm=(laya.utils.HTMLChar,laya.resource.HTMLImage),Vb=laya.resource.HTMLSubImage,V_=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),V$=laya.maths.Point,VM=laya.maths.Rectangle,VP=laya.renders.Render,VA=(laya.renders.RenderContext,laya.renders.RenderSprite),VT=laya.resource.Resource,VK=laya.resource.ResourceManager,VY=laya.utils.RunDriver,VZ=laya.display.Sprite,Vu=laya.display.Stage,Vc=laya.utils.Stat,VH=laya.utils.StringKey,VG=(laya.display.css.Style,laya.system.System),VI=laya.display.Text,Vv=laya.resource.Texture,Vl=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),Vj=laya.utils.VectorGraphManager;laya.utils.WordText;VW.interface("laya.webgl.shapes.IShape"),VW.interface("laya.webgl.submit.ISubmit"),VW.interface("laya.webgl.text.ICharSegment"),VW.interface("laya.webgl.canvas.save.ISaveData"),VW.interface("laya.webgl.resource.IMergeAtlasBitmap"),VW.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var Vh=function(){function Vn(){}Vi(Vn,"laya.filters.webgl.FilterActionGL");var Va=Vn.prototype;return VW.imps(Va,{"laya.filters.IFilterActionGL":!0}),Va.setValue=function(Vn){},Va.setValueMix=function(Vn){},Va.apply3d=function(Vn,Va,VU,Vx,VD){return null},Va.apply=function(Vn){return null},Vx(0,Va,"typeMix",function(){return 0}),Vn}(),Vf=function(){function Vn(){}return Vi(Vn,"laya.webgl.shader.ShaderValue"),Vn}(),VF=function(){var Vx,VD;function Vn(Vn,Va,VU){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new VD,void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),void 0===VU&&(VU=0),this._cells=null,this._rowInfo=null,this._init(Vn,Va),this._atlasID=VU}Vi(Vn,"laya.webgl.atlas.AtlasGrid");var Va=Vn.prototype;return Va.getAltasID=function(){return this._atlasID},Va.setAltasID=function(Vn){0<=Vn&&(this._atlasID=Vn)},Va.addTex=function(Vn,Va,VU){var Vx=this._get(Va,VU);return 0==Vx.ret||(this._fill(Vx.x,Vx.y,Va,VU,Vn),this._texCount++),Vx},Va._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},Va._init=function(Vn,Va){if(this._width=Vn,this._height=Va,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=Vp(this._height);for(var VU=0;VU<this._height;VU++)this._rowInfo[VU]=new Vx;return this._clear(),!0},Va._get=function(Vn,Va){var VU=new Vo;if(Vn>=this._failSize.width&&Va>=this._failSize.height)return VU;for(var Vx=-1,VD=-1,Vp=this._width,VQ=this._height,VV=this._cells,Vy=0;Vy<VQ;Vy++)if(!(this._rowInfo[Vy].spaceCount<Vn))for(var VR=0;VR<Vp;){var VX=3*(Vy*Vp+VR);if(0!=VV[VX]||VV[1+VX]<Vn||VV[2+VX]<Va)VR+=VV[1+VX];else{Vx=VR,VD=Vy;for(var Vz=0;Vz<Vn;Vz++)if(VV[3*Vz+VX+2]<Va){Vx=-1;break}if(!(Vx<0))return VU.ret=!0,VU.x=Vx,VU.y=VD,VU;VR+=VV[1+VX]}}return VU},Va._fill=function(Vn,Va,VU,Vx,VD){var Vp=this._width,VQ=this._height;this._check(Vn+VU<=Vp&&Va+Vx<=VQ);for(var VV=Va;VV<Vx+Va;++VV){this._check(this._rowInfo[VV].spaceCount>=VU),this._rowInfo[VV].spaceCount-=VU;for(var Vy=0;Vy<VU;Vy++){var VR=3*(Vn+VV*Vp+Vy);this._check(0==this._cells[VR]),this._cells[VR]=VD,this._cells[1+VR]=VU,this._cells[2+VR]=Vx}}if(0<Vn)for(VV=0;VV<Vx;++VV){var VX=0;for(Vy=Vn-1;0<=Vy&&0==this._cells[3*((Va+VV)*Vp+Vy)];--Vy,++VX);for(Vy=VX;0<Vy;--Vy)this._cells[3*((Va+VV)*Vp+Vn-Vy)+1]=Vy,this._check(0<Vy)}if(0<Va)for(Vy=Vn;Vy<Vn+VU;++Vy){for(VX=0,VV=Va-1;0<=VV&&0==this._cells[3*(Vy+VV*Vp)];--VV,VX++);for(VV=VX;0<VV;--VV)this._cells[3*(Vy+(Va-VV)*Vp)+2]=VV,this._check(0<VV)}},Va._check=function(Vn){0==Vn&&console.log("xtexMerger 错误啦")},Va._clear=function(){for(var Vn=this._texCount=0;Vn<this._height;Vn++)this._rowInfo[Vn].spaceCount=this._width;for(var Va=0;Va<this._height;Va++)for(var VU=0;VU<this._width;VU++){var Vx=3*(Va*this._width+VU);this._cells[Vx]=0,this._cells[1+Vx]=this._width-VU,this._cells[2+Vx]=this._width-Va}this._failSize.width=this._width+1,this._failSize.height=this._height+1},Vn.__init$=function(){Vx=function(){function Vn(){this.spaceCount=0}return Vi(Vn,""),Vn}(),VD=function(){function Vn(){this.width=0,this.height=0}return Vi(Vn,""),Vn}()},Vn}(),Vg=function(){function VP(Vn,Va,VU,Vx){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=Vn,this._height=Va,this._gridSize=VU,this._maxAtlaserCount=Vx,this._gridNumX=Vn/VU,this._gridNumY=Va/VU,this._curAtlasIndex=0,this._atlaserArray=[]}Vi(VP,"laya.webgl.atlas.AtlasResourceManager");var Vn=VP.prototype;return Vn.setAtlasParam=function(Vn,Va,VU,Vx){if(1==this._setAtlasParam)return VP._sid_=0,this._width=Vn,this._height=Va,this._gridSize=VU,this._maxAtlaserCount=Vx,this._gridNumX=Vn/VU,this._gridNumY=Va/VU,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},Vn.pushData=function(Vn){var Va,VU=Vn.bitmap,Vx=-1,VD=null,Vp=0,VQ=0;for(Vp=0,Va=this._atlaserArray.length;Vp<Va&&(VQ=(this._curAtlasIndex+Vp)%Va,-1==(Vx=(VD=this._atlaserArray[VQ]).findBitmapIsExist(VU)));Vp++);if(-1!=Vx){var VV=VD.InAtlasWebGLImagesOffsetValue[Vx];return VE=VV[0],Vm=VV[1],VD.addToAtlas(Vn,VE,Vm),!0}this._setAtlasParam=!1;for(var Vy=Math.ceil((Vn.bitmap.width+2)/this._gridSize),VR=Math.ceil((Vn.bitmap.height+2)/this._gridSize),VX=!1,Vz=0;Vz<2;Vz++){var Vi=this._maxAtlaserCount;for(Vp=0;Vp<Vi;Vp++){VQ=(this._curAtlasIndex+Vp)%Vi,this._atlaserArray.length-1>=VQ||this._atlaserArray.push(new VMn(this._gridNumX,this._gridNumY,this._width,this._height,VP._sid_++));var Vq=this._atlaserArray[VQ],VE=0,Vm=0,Vb=Vq.addTex(1,Vy,VR);if(Vb.ret){VE=Vb.x*this._gridSize+1,Vm=Vb.y*this._gridSize+1,VU.lock=!0,Vq.addToAtlasTexture(VU,VE,Vm),Vq.addToAtlas(Vn,VE,Vm),VX=!0,this._curAtlasIndex=VQ;break}}if(VX)break;this._atlaserArray.push(new VMn(this._gridNumX,this._gridNumY,this._width,this._height,VP._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return VX||console.log(">>>AtlasManager pushData error"),VX},Vn.addToAtlas=function(Vn){laya.webgl.atlas.AtlasResourceManager.instance.pushData(Vn)},Vn.garbageCollection=function(){if(!0===this._needGC){for(var Vn=this._atlaserArray.length-this._maxAtlaserCount,Va=0;Va<Vn;Va++)this._atlaserArray[Va].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+Vn),this._atlaserArray.splice(0,Vn),this._needGC=!1}return!0},Vn.freeAll=function(){for(var Vn=0,Va=this._atlaserArray.length;Vn<Va;Vn++)this._atlaserArray[Vn].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},Vn.getAtlaserCount=function(){return this._atlaserArray.length},Vn.getAtlaserByIndex=function(Vn){return this._atlaserArray[Vn]},Vx(1,VP,"instance",function(){return VP._Instance||(VP._Instance=new VP(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),VP._Instance}),Vx(1,VP,"enabled",function(){return Vk.atlasEnable}),Vx(1,VP,"atlasLimitWidth",function(){return VP._atlasLimitWidth},function(Vn){VP._atlasLimitWidth=Vn}),Vx(1,VP,"atlasLimitHeight",function(){return VP._atlasLimitHeight},function(Vn){VP._atlasLimitHeight=Vn}),VP._enable=function(){Vk.atlasEnable=!0},VP._disable=function(){Vk.atlasEnable=!1},VP.__init__=function(){VP.atlasTextureWidth=2048,VP.atlasTextureHeight=2048,VP.maxTextureCount=6,VP.atlasLimitWidth=512,VP.atlasLimitHeight=512},VP._atlasLimitWidth=0,VP._atlasLimitHeight=0,VP.gridSize=16,VP.atlasTextureWidth=0,VP.atlasTextureHeight=0,VP.maxTextureCount=0,VP._atlasRestore=0,VP.BOARDER_TYPE_NO=0,VP.BOARDER_TYPE_RIGHT=1,VP.BOARDER_TYPE_LEFT=2,VP.BOARDER_TYPE_BOTTOM=4,VP.BOARDER_TYPE_TOP=8,VP.BOARDER_TYPE_ALL=15,VP._sid_=0,VP._Instance=null,VP}(),Vo=function(){function Vn(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return Vi(Vn,"laya.webgl.atlas.MergeFillInfo"),Vn}(),VB=function(){function Va(){}return Vi(Va,"laya.webgl.canvas.BlendMode"),Va._init_=function(Vn){Va.fns=[Va.BlendNormal,Va.BlendAdd,Va.BlendMultiply,Va.BlendScreen,Va.BlendOverlay,Va.BlendLight,Va.BlendMask,Va.BlendDestinationOut],Va.targetFns=[Va.BlendNormalTarget,Va.BlendAddTarget,Va.BlendMultiplyTarget,Va.BlendScreenTarget,Va.BlendOverlayTarget,Va.BlendLightTarget,Va.BlendMask,Va.BlendDestinationOut]},Va.BlendNormal=function(Vn){Vn.blendFunc(1,771)},Va.BlendAdd=function(Vn){Vn.blendFunc(1,772)},Va.BlendMultiply=function(Vn){Vn.blendFunc(774,771)},Va.BlendScreen=function(Vn){Vn.blendFunc(1,1)},Va.BlendOverlay=function(Vn){Vn.blendFunc(1,769)},Va.BlendLight=function(Vn){Vn.blendFunc(1,1)},Va.BlendNormalTarget=function(Vn){Vn.blendFunc(1,771)},Va.BlendAddTarget=function(Vn){Vn.blendFunc(1,772)},Va.BlendMultiplyTarget=function(Vn){Vn.blendFunc(774,771)},Va.BlendScreenTarget=function(Vn){Vn.blendFunc(1,1)},Va.BlendOverlayTarget=function(Vn){Vn.blendFunc(1,769)},Va.BlendLightTarget=function(Vn){Vn.blendFunc(1,1)},Va.BlendMask=function(Vn){Vn.blendFunc(0,770)},Va.BlendDestinationOut=function(Vn){Vn.blendFunc(0,0)},Va.activeBlendFunction=null,Va.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],Va.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},Va.NORMAL="normal",Va.ADD="add",Va.MULTIPLY="multiply",Va.SCREEN="screen",Va.LIGHT="light",Va.OVERLAY="overlay",Va.DESTINATIONOUT="destination-out",Va.fns=[],Va.targetFns=[],Va}(),VO=function(){function VU(Vn){this._color=VE.create("black"),this.setValue(Vn)}Vi(VU,"laya.webgl.canvas.DrawStyle");var Vn=VU.prototype;return Vn.setValue=function(Vn){if(Vn){if("string"==typeof Vn)return void(this._color=VE.create(Vn));if(Vn instanceof laya.utils.Color)return void(this._color=Vn)}},Vn.reset=function(){this._color=VE.create("black")},Vn.equal=function(Vn){return"string"==typeof Vn?this._color.strColor===Vn:Vn instanceof laya.utils.Color&&this._color.numColor===Vn.numColor},Vn.toColorStr=function(){return this._color.strColor},VU.create=function(Vn){var Va;if(Vn&&("string"==typeof Vn?Va=VE.create(Vn):Vn instanceof laya.utils.Color&&(Va=Vn),Va))return Va._drawStyle||(Va._drawStyle=new VU(Vn));return laya.webgl.canvas.DrawStyle.DEFAULT},VQ(VU,["DEFAULT",function(){return this.DEFAULT=new VU("#000000")}]),VU}(),VL=function(){function Vn(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];VKn.mainContext;this.ib=VJn.create(35048),this.vb=Ven.create(5)}Vi(Vn,"laya.webgl.canvas.Path");var Va=Vn.prototype;return Va.addPoint=function(Vn,Va){this.tempArray.push(Vn,Va)},Va.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},Va.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},Va.polygon=function(Vn,Va,VU,Vx,VD,Vp){var VQ;return this.geomatrys.push(this._curGeomatry=VQ=new VHn(Vn,Va,VU,Vx,VD,Vp)),Vx||(VQ.fill=!1),null==Vp&&(VQ.borderWidth=0),VQ},Va.setGeomtry=function(Vn){this.geomatrys.push(this._curGeomatry=Vn)},Va.drawLine=function(Vn,Va,VU,Vx,VD){var Vp;return this.closePath?this.geomatrys.push(this._curGeomatry=Vp=new Vcn(Vn,Va,VU,Vx,VD)):this.geomatrys.push(this._curGeomatry=Vp=new Vun(Vn,Va,VU,Vx,VD)),Vp.fill=!1,Vp},Va.update=function(){var Vn=this.ib._byteLength,Va=this.geomatrys.length;this.offset=Vn;for(var VU=this.geoStart;VU<Va;VU++)this.geomatrys[VU].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=Va,this.count=(this.ib._byteLength-Vn)/Vmn.BYTES_PIDX},Va.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},Va.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},Vn}(),Vd=function(){function VV(){}Vi(VV,"laya.webgl.canvas.save.SaveBase");var Vn=VV.prototype;return VW.imps(Vn,{"laya.webgl.canvas.save.ISaveData":!0}),Vn.isSaveMark=function(){return!1},Vn.restore=function(Vn){this._dataObj[this._valueName]=this._value,(VV._cache[VV._cache._length++]=this)._newSubmit&&(Vn._curSubmit=Vpn.RENDERBASE,Vn._renderKey=0)},VV._createArray=function(){var Vn=[];return Vn._length=0,Vn},VV._init=function(){var Vn=VV._namemap={};return Vn[1]="ALPHA",Vn[2]="fillStyle",Vn[8]="font",Vn[256]="lineWidth",Vn[512]="strokeStyle",Vn[8192]="_mergeID",Vn[1024]=Vn[2048]=Vn[4096]=[],Vn[16384]="textBaseline",Vn[32768]="textAlign",Vn[65536]="_nBlendType",Vn[1048576]="shader",Vn[2097152]="filters",Vn},VV.save=function(Vn,Va,VU,Vx){if((Vn._saveMark._saveuse&Va)!==Va){Vn._saveMark._saveuse|=Va;var VD=VV._cache,Vp=0<VD._length?VD[--VD._length]:new VV;Vp._value=VU[Vp._valueName=VV._namemap[Va]],Vp._dataObj=VU,Vp._newSubmit=Vx;var VQ=Vn._save;VQ[VQ._length++]=Vp}},VV._cache=laya.webgl.canvas.save.SaveBase._createArray(),VV._namemap=VV._init(),VV}(),VS=function(){function Vp(){this._clipRect=new VM}Vi(Vp,"laya.webgl.canvas.save.SaveClipRect");var Vn=Vp.prototype;return VW.imps(Vn,{"laya.webgl.canvas.save.ISaveData":!0}),Vn.isSaveMark=function(){return!1},Vn.restore=function(Vn){Vn._clipRect=this._clipSaveRect,(Vp._cache[Vp._cache._length++]=this)._submitScissor.submitLength=Vn._submits._length-this._submitScissor.submitIndex,Vn._curSubmit=Vpn.RENDERBASE,Vn._renderKey=0},Vp.save=function(Vn,Va){if(131072!=(131072&Vn._saveMark._saveuse)){Vn._saveMark._saveuse|=131072;var VU=Vp._cache,Vx=0<VU._length?VU[--VU._length]:new Vp;Vx._clipSaveRect=Vn._clipRect,Vn._clipRect=Vx._clipRect.copyFrom(Vn._clipRect),Vx._submitScissor=Va;var VD=Vn._save;VD[VD._length++]=Vx}},VQ(Vp,["_cache",function(){return this._cache=Vd._createArray()}]),Vp}(),Vw=function(){function Vq(){this._contextX=0,this._contextY=0,this._clipRect=new VM,this._rect=new VM,this._matrix=new V_}Vi(Vq,"laya.webgl.canvas.save.SaveClipRectStencil");var Vn=Vq.prototype;return VW.imps(Vn,{"laya.webgl.canvas.save.ISaveData":!0}),Vn.isSaveMark=function(){return!1},Vn.restore=function(Vn){VXn.restore(Vn,this._rect,this._saveMatrix,this._contextX,this._contextY),Vn._clipRect=this._clipSaveRect,Vn._curMat=this._saveMatrix,Vn._x=this._contextX,Vn._y=this._contextY,Vq._cache[Vq._cache._length++]=this,Vn._curSubmit=Vpn.RENDERBASE},Vq.save=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){if(262144!=(262144&Vn._saveMark._saveuse)){Vn._saveMark._saveuse|=262144;var VX=Vq._cache,Vz=0<VX._length?VX[--VX._length]:new Vq;Vz._clipSaveRect=Vn._clipRect,Vz._clipRect.setTo(VQ,VV,Vy,VR),Vn._clipRect=Vz._clipRect,Vz._rect.x=VU,Vz._rect.y=Vx,Vz._rect.width=VD,Vz._rect.height=Vp,Vz._contextX=Vn._x,Vz._contextY=Vn._y,Vz._saveMatrix=Vn._curMat,Vn._curMat.copyTo(Vz._matrix),Vn._curMat=Vz._matrix,Vz._submitStencil=Va;var Vi=Vn._save;Vi[Vi._length++]=Vz}},VQ(Vq,["_cache",function(){return this._cache=Vd._createArray()}]),Vq}(),Vs=function(){function Vx(){this._saveuse=0}Vi(Vx,"laya.webgl.canvas.save.SaveMark");var Vn=Vx.prototype;return VW.imps(Vn,{"laya.webgl.canvas.save.ISaveData":!0}),Vn.isSaveMark=function(){return!0},Vn.restore=function(Vn){Vn._saveMark=this._preSaveMark,Vx._no[Vx._no._length++]=this},Vx.Create=function(Vn){var Va=Vx._no,VU=0<Va._length?Va[--Va._length]:new Vx;return VU._saveuse=0,VU._preSaveMark=Vn._saveMark,Vn._saveMark=VU},VQ(Vx,["_no",function(){return this._no=Vd._createArray()}]),Vx}(),VC=function(){function Vp(){this._matrix=new V_}Vi(Vp,"laya.webgl.canvas.save.SaveTransform");var Vn=Vp.prototype;return VW.imps(Vn,{"laya.webgl.canvas.save.ISaveData":!0}),Vn.isSaveMark=function(){return!1},Vn.restore=function(Vn){Vn._curMat=this._savematrix,Vp._no[Vp._no._length++]=this},Vp.save=function(Vn){var Va=Vn._saveMark;if(2048!=(2048&Va._saveuse)){Va._saveuse|=2048;var VU=Vp._no,Vx=0<VU._length?VU[--VU._length]:new Vp;Vx._savematrix=Vn._curMat,Vn._curMat=Vn._curMat.copyTo(Vx._matrix);var VD=Vn._save;VD[VD._length++]=Vx}},VQ(Vp,["_no",function(){return this._no=Vd._createArray()}]),Vp}(),Vt=function(){function VD(){}Vi(VD,"laya.webgl.canvas.save.SaveTranslate");var Vn=VD.prototype;return VW.imps(Vn,{"laya.webgl.canvas.save.ISaveData":!0}),Vn.isSaveMark=function(){return!1},Vn.restore=function(Vn){Vn._curMat;Vn._x=this._x,Vn._y=this._y,VD._no[VD._no._length++]=this},VD.save=function(Vn){var Va=VD._no,VU=0<Va._length?Va[--Va._length]:new VD;VU._x=Vn._x,VU._y=Vn._y;var Vx=Vn._save;Vx[Vx._length++]=VU},VQ(VD,["_no",function(){return this._no=Vd._createArray()}]),VD}(),Vr=function(){function Vn(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new VM}Vi(Vn,"laya.webgl.resource.RenderTargetMAX");var Va=Vn.prototype;return Va.setSP=function(Vn){this._sp=Vn},Va.size=function(Vn,Va){var VU=this;this._width!==Vn||this._height!==Va?(this.repaint=!0,this._width=Vn,this._height=Va,this.target?this.target.size(Vn,Va):this.target=Vjn.create(Vn,Va),this.target.hasListener("recovered")||this.target.on("recovered",this,function(Vn){VW.timer.callLater(VU._sp,VU._sp.repaint)})):this.target.size(Vn,Va)},Va._flushToTarget=function(Vn,Va){if(!Va._destroy){var VU=VAn.worldScissorTest,Vx=VAn.worldClipRect;VAn.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,VAn.worldScissorTest=!1,VKn.mainContext.disable(3089);var VD=VAn.worldAlpha,Vp=VAn.worldMatrix4,VQ=VAn.worldMatrix,VV=VAn.worldFilters,Vy=VAn.worldShaderDefines;if(VAn.worldMatrix=V_.EMPTY,VAn.restoreTempArray(),VAn.worldMatrix4=VAn.TEMPMAT4_ARRAY,VAn.worldAlpha=1,VAn.worldFilters=null,VAn.worldShaderDefines=null,Vln.activeShader=null,Va.start(),Vk.showCanvasMark?Va.clear(0,1,0,.3):Va.clear(0,0,0,0),Vn.flush(),Va.end(),Vln.activeShader=null,VAn.worldAlpha=VD,VAn.worldMatrix4=Vp,VAn.worldMatrix=VQ,VAn.worldFilters=VV,VAn.worldShaderDefines=Vy,VAn.worldScissorTest=VU){var VR=VAn.height-Vx.y-Vx.height;VKn.mainContext.scissor(Vx.x,VR,Vx.width,Vx.height),VKn.mainContext.enable(3089)}VAn.worldClipRect=Vx}},Va.flush=function(Vn){this.repaint&&(this._flushToTarget(Vn,this.target),this.repaint=!1)},Va.drawTo=function(Vn,Va,VU,Vx,VD){Vn.drawTexture(this.target.getTexture(),Va,VU,Vx,VD,0,0)},Va.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},Vn}(),VJ=function(){function Vn(){this.ALPHA=1,this.shaderType=0,this.defines=new VZn}return Vi(Vn,"laya.webgl.shader.d2.Shader2D"),Vn.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},Vn.__init__=function(){var Vn,Va;Vsn.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),Vsn.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),Vsn.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),Vsn.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),Vsn.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),Vsn.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),Vsn.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),Vsn.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),Vn="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",Va='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',Vsn.preCompile2D(0,1,Vn,Va,null),Vn="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",Va='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',Vsn.preCompile2D(0,2,Vn,Va,null),Vn="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",Va="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",Vsn.preCompile2D(0,4,Vn,Va,null),Vn="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",Va='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',Vsn.preCompile2D(0,256,Vn,Va,null),Vn="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",Va="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",Vsn.preCompile2D(0,512,Vn,Va,null)},Vn}(),Ve=function(){function Va(Vn,Va,VU){this._value=0,this._name2int=Vn,this._int2name=Va,this._int2nameMap=VU}Vi(Va,"laya.webgl.shader.ShaderDefines");var Vn=Va.prototype;return Vn.add=function(Vn){return"string"==typeof Vn&&(Vn=this._name2int[Vn]),this._value|=Vn,this._value},Vn.addInt=function(Vn){return this._value|=Vn,this._value},Vn.remove=function(Vn){return"string"==typeof Vn&&(Vn=this._name2int[Vn]),this._value&=~Vn,this._value},Vn.isDefine=function(Vn){return(this._value&Vn)===Vn},Vn.getValue=function(){return this._value},Vn.setValue=function(Vn){this._value=Vn},Vn.toNameDic=function(){var Vn=this._int2nameMap[this._value];return Vn||Va._toText(this._value,this._int2name,this._int2nameMap)},Va._reg=function(Vn,Va,VU,Vx){Vx[VU[Vn]=Va]=Vn},Va._toText=function(Vn,Va,VU){var Vx=VU[Vn];if(Vx)return Vx;for(var VD={},Vp=1,VQ=0;VQ<32&&!(Vn<(Vp=1<<VQ));VQ++)if(Vn&Vp){var VV=Va[Vp];VV&&(VD[VV]="")}return VU[Vn]=VD},Va._toInt=function(Vn,Va){for(var VU=Vn.split("."),Vx=0,VD=0,Vp=VU.length;VD<Vp;VD++){var VQ=Va[VU[VD]];if(!VQ)throw new Error("Defines to int err:"+Vn+"/"+VU[VD]);Vx|=VQ}return Vx},Va}(),Vnn=function(){function VQ(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new V_}Vi(VQ,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var Vn=VQ.prototype;return Vn.init=function(Vn,Va,VU){if(Va)this._vs=Va;else{this._vs=[];var Vx=Vn.width,VD=Vn.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(Vx,0,1,0,1,1,1,1),this._vs.push(Vx,VD,1,1,1,1,1,1),this._vs.push(0,VD,0,1,1,1,1,1)}VU?this._ps=VU:(VQ._defaultPS||(VQ._defaultPS=[]).push(0,1,3,3,1,2),this._ps=VQ._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=Vn},Vn.init2=function(Vn,Va,VU,Vx,VD){this.transform&&(this.transform=null),VU?this._ps=VU:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=Vx,this._uvs=VD,this.mEleNum=this._ps.length,this.mTexture=Vn,(VP.isConchNode||VP.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},Vn._initMyData=function(){var Vn=0,Va=0,VU=4*this._verticles.length;this._vs=VQ._tempVS;var Vx=!1;if(VP.isConchNode||VP.isConchApp?(this._vs.length=VU,Vx=!0):this._vs.length<VU&&(this._vs.length=VU,Vx=!0),VQ._tVSLen=VU,Vx)for(;Vn<VU;)this._vs[Vn]=this._verticles[Va],this._vs[Vn+1]=this._verticles[Va+1],this._vs[Vn+2]=this._uvs[Va],this._vs[Vn+3]=this._uvs[Va+1],this._vs[Vn+4]=1,this._vs[Vn+5]=1,this._vs[Vn+6]=1,this._vs[Vn+7]=1,Vn+=8,Va+=2;else for(;Vn<VU;)this._vs[Vn]=this._verticles[Va],this._vs[Vn+1]=this._verticles[Va+1],this._vs[Vn+2]=this._uvs[Va],this._vs[Vn+3]=this._uvs[Va+1],Vn+=8,Va+=2},Vn.getData2=function(Vn,Va,VU){var Vx;this.mVBBuffer=Vn,this.mIBBuffer=Va,this._initMyData(),Vn.appendEx2(this._vs,Float32Array,VQ._tVSLen,4),this._indexStart=Va._byteLength,(Vx=VQ._tempIB).length<this._ps.length&&(Vx.length=this._ps.length);for(var VD=0,Vp=this._ps.length;VD<Vp;VD++)Vx[VD]=this._ps[VD]+VU;Va.appendEx2(Vx,Uint16Array,this._ps.length,2)},Vn.getData=function(Vn,Va,VU){if(this.mVBBuffer=Vn,this.mIBBuffer=Va,Vn.append(this.mVBData),this._indexStart=Va._byteLength,this.mIBData.start!=VU){for(var Vx=0,VD=this._ps.length;Vx<VD;Vx++)this.mIBData[Vx]=this._ps[Vx]+VU;this.mIBData.start=VU}Va.append(this.mIBData)},Vn.render=function(Vn,Va,VU){if(VP.isWebGL&&this.mTexture){Vn._renderKey=0,Vn._shader2D.glTexture=null,Van.getInstance().addSkinMesh(this);var Vx=Vpn.createShape(Vn,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,VNn.create(512,0));this.transform||(this.transform=V_.EMPTY),this.transform.translate(Va,VU),V_.mul(this.transform,Vn._curMat,this._tempMatrix),this.transform.translate(-Va,-VU);var VD=Vx.shaderValue,Vp=VD.u_mmat2||VAn.getMatrArray();VAn.mat2MatArray(this._tempMatrix,Vp),VD.textureHost=this.mTexture,VD.offsetX=0,VD.offsetY=0,VD.u_mmat2=Vp,VD.ALPHA=Vn._shader2D.ALPHA,Vn._submits[Vn._submits._length++]=Vx}else VP.isConchApp&&this.mTexture&&(this.transform||(this.transform=V_.EMPTY),Vn.setSkinMesh&&Vn.setSkinMesh(Va,VU,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},VQ._tempVS=[],VQ._tempIB=[],VQ._defaultPS=null,VQ._tVSLen=0,VQ}(),Van=function(){function Vn(){this.ib=null,this.vb=null;VKn.mainContext;this.ib=VJn.create(35048),this.vb=Ven.create(8)}Vi(Vn,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var Va=Vn.prototype;return Va.addSkinMesh=function(Vn){Vn.getData2(this.vb,this.ib,this.vb._byteLength/32)},Va.reset=function(){this.vb.clear(),this.ib.clear()},Vn.getInstance=function(){return Vn.instance=Vn.instance||new Vn},Vn.instance=null,Vn}(),VUn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===Vy&&(Vy=0),this.x=Vn,this.y=Va,this.width=VU,this.height=Vx,this.edges=VD,this.color=Vp,this.borderWidth=VQ,this.borderColor=VV}Vi(Vn,"laya.webgl.shapes.BasePoly");var Va=Vn.prototype;return VW.imps(Va,{"laya.webgl.shapes.IShape":!0}),Va.getData=function(Vn,Va,VU){},Va.rebuild=function(Vn){},Va.setMatrix=function(Vn){},Va.needUpdate=function(Vn){return!0},Va.sector=function(Vn,Va,VU){var Vx=this.x,VD=this.y,Vp=this.edges,VQ=(this.r1-this.r0)/Vp,VV=this.width,Vy=this.height,VR=this.color,VX=(VR>>16&255)/255,Vz=(VR>>8&255)/255,Vi=(255&VR)/255;Vn.push(Vx,VD,VX,Vz,Vi);for(var Vq=0;Vq<Vp+1;Vq++)Vn.push(Vx+Math.sin(VQ*Vq+this.r0)*VV,VD+Math.cos(VQ*Vq+this.r0)*Vy),Vn.push(VX,Vz,Vi);for(Vq=0;Vq<Vp;Vq++)Va.push(VU,VU+Vq+1,VU+Vq+2)},Va.createLine2=function(Vn,Va,VU,Vx,VD,Vp){var VQ,VV,Vy,VR,VX,Vz,Vi,Vq,VE,Vm,Vb,VP,VA,VT,VK,VY,VW,Vk,VN,V_,V$=Vn.concat(),VM=VD,VZ=this.borderColor,Vu=(VZ>>16&255)/255,Vc=(VZ>>8&255)/255,VH=(255&VZ)/255,VG=V$.length/2,VI=Vx,Vv=VU/2;Vy=V$[0],VR=V$[1],Vm=Vy-(VX=V$[2]),VE=(VE=-(VR-(Vz=V$[3])))/(V_=Math.sqrt(VE*VE+Vm*Vm))*Vv,Vm=Vm/V_*Vv,VM.push(Vy-VE+this.x,VR-Vm+this.y,Vu,Vc,VH,Vy+VE+this.x,VR+Vm+this.y,Vu,Vc,VH);for(var Vl=1;Vl<VG-1;Vl++)Vy=V$[2*(Vl-1)],VR=V$[2*(Vl-1)+1],VX=V$[2*Vl],Vz=V$[2*Vl+1],Vi=V$[2*(Vl+1)],Vq=V$[2*(Vl+1)+1],Vm=Vy-VX,VP=VX-Vi,VK=(-(VE=(VE=-(VR-Vz))/(V_=Math.sqrt(VE*VE+Vm*Vm))*Vv)+Vy)*(-(Vm=Vm/V_*Vv)+Vz)-(-VE+VX)*(-Vm+VR),Vk=(-(Vb=(Vb=-(Vz-Vq))/(V_=Math.sqrt(Vb*Vb+VP*VP))*Vv)+Vi)*(-(VP=VP/V_*Vv)+Vz)-(-Vb+VX)*(-VP+Vq),VN=(VA=-Vm+VR-(-Vm+Vz))*(VW=-Vb+VX-(-Vb+Vi))-(VY=-VP+Vq-(-VP+Vz))*(VT=-VE+VX-(-VE+Vy)),Math.abs(VN)<.1?(VN+=10.1,VM.push(VX-VE+this.x,Vz-Vm+this.y,Vu,Vc,VH,VX+VE+this.x,Vz+Vm+this.y,Vu,Vc,VH)):(((VQ=(VT*Vk-VW*VK)/VN)-VX)*(VQ-VX)+((VV=(VY*VK-VA*Vk)/VN)-Vz)+(VV-Vz),VM.push(VQ+this.x,VV+this.y,Vu,Vc,VH,VX-(VQ-VX)+this.x,Vz-(VV-Vz)+this.y,Vu,Vc,VH));Vy=V$[V$.length-4],VR=V$[V$.length-3],Vm=Vy-(VX=V$[V$.length-2]),VE=(VE=-(VR-(Vz=V$[V$.length-1])))/(V_=Math.sqrt(VE*VE+Vm*Vm))*Vv,Vm=Vm/V_*Vv,VM.push(VX-VE+this.x,Vz-Vm+this.y,Vu,Vc,VH,VX+VE+this.x,Vz+Vm+this.y,Vu,Vc,VH);var Vj=Vp;for(Vl=1;Vl<Vj;Vl++)Va.push(VI+2*(Vl-1),VI+2*(Vl-1)+1,VI+2*Vl+1,VI+2*Vl+1,VI+2*Vl,VI+2*(Vl-1));return VM},Va.createLine=function(Vn,Va,VU,Vx){var VD=Vn.concat(),Vp=Vn,VQ=this.borderColor,VV=(VQ>>16&255)/255,Vy=(VQ>>8&255)/255,VR=(255&VQ)/255;VD.splice(0,5);var VX,Vz,Vi,Vq,VE,Vm,Vb,VP,VA,VT,VK,VY,VW,Vk,VN,V_,V$,VM,VZ,Vu,Vc=VD.length/5,VH=Vx,VG=VU/2;Vi=VD[0],Vq=VD[1],VT=Vi-(VE=VD[5]),VA=(VA=-(Vq-(Vm=VD[6])))/(Vu=Math.sqrt(VA*VA+VT*VT))*VG,VT=VT/Vu*VG,Vp.push(Vi-VA,Vq-VT,VV,Vy,VR,Vi+VA,Vq+VT,VV,Vy,VR);for(var VI=1;VI<Vc-1;VI++)Vi=VD[5*(VI-1)],Vq=VD[5*(VI-1)+1],VE=VD[5*VI],Vm=VD[5*VI+1],Vb=VD[5*(VI+1)],VP=VD[5*(VI+1)+1],VT=Vi-VE,VY=VE-Vb,VN=(-(VA=(VA=-(Vq-Vm))/(Vu=Math.sqrt(VA*VA+VT*VT))*VG)+Vi)*(-(VT=VT/Vu*VG)+Vm)-(-VA+VE)*(-VT+Vq),VM=(-(VK=(VK=-(Vm-VP))/(Vu=Math.sqrt(VK*VK+VY*VY))*VG)+Vb)*(-(VY=VY/Vu*VG)+Vm)-(-VK+VE)*(-VY+VP),VZ=(VW=-VT+Vq-(-VT+Vm))*(V$=-VK+VE-(-VK+Vb))-(V_=-VY+VP-(-VY+Vm))*(Vk=-VA+VE-(-VA+Vi)),Math.abs(VZ)<.1?(VZ+=10.1,Vp.push(VE-VA,Vm-VT,VV,Vy,VR,VE+VA,Vm+VT,VV,Vy,VR)):(((VX=(Vk*VM-V$*VN)/VZ)-VE)*(VX-VE)+((Vz=(V_*VN-VW*VM)/VZ)-Vm)+(Vz-Vm),Vp.push(VX,Vz,VV,Vy,VR,VE-(VX-VE),Vm-(Vz-Vm),VV,Vy,VR));Vi=VD[VD.length-10],Vq=VD[VD.length-9],VT=Vi-(VE=VD[VD.length-5]),VA=(VA=-(Vq-(Vm=VD[VD.length-4])))/(Vu=Math.sqrt(VA*VA+VT*VT))*VG,VT=VT/Vu*VG,Vp.push(VE-VA,Vm-VT,VV,Vy,VR,VE+VA,Vm+VT,VV,Vy,VR);var Vv=this.edges+1;for(VI=1;VI<Vv;VI++)Va.push(VH+2*(VI-1),VH+2*(VI-1)+1,VH+2*VI+1,VH+2*VI+1,VH+2*VI,VH+2*(VI-1));return Vp},Va.createLoopLine=function(Vn,Va,VU,Vx,VD,Vp){var VQ=Vn.concat(),VV=VD||Vn,Vy=this.borderColor,VR=(Vy>>16&255)/255,VX=(Vy>>8&255)/255,Vz=(255&Vy)/255;VQ.splice(0,5);var Vi=[VQ[0],VQ[1]],Vq=[VQ[VQ.length-5],VQ[VQ.length-4]],VE=Vq[0]+.5*(Vi[0]-Vq[0]),Vm=Vq[1]+.5*(Vi[1]-Vq[1]);VQ.unshift(VE,Vm,0,0,0),VQ.push(VE,Vm,0,0,0);var Vb,VP,VA,VT,VK,VY,VW,Vk,VN,V_,V$,VM,VZ,Vu,Vc,VH,VG,VI,Vv,Vl,Vj=VQ.length/5,Vh=Vx,Vf=VU/2;VA=VQ[0],VT=VQ[1],V_=VA-(VK=VQ[5]),VN=(VN=-(VT-(VY=VQ[6])))/(Vl=Math.sqrt(VN*VN+V_*V_))*Vf,V_=V_/Vl*Vf,VV.push(VA-VN,VT-V_,VR,VX,Vz,VA+VN,VT+V_,VR,VX,Vz);for(var VF=1;VF<Vj-1;VF++)VA=VQ[5*(VF-1)],VT=VQ[5*(VF-1)+1],VK=VQ[5*VF],VY=VQ[5*VF+1],VW=VQ[5*(VF+1)],Vk=VQ[5*(VF+1)+1],V_=VA-VK,VM=VK-VW,Vc=(-(VN=(VN=-(VT-VY))/(Vl=Math.sqrt(VN*VN+V_*V_))*Vf)+VA)*(-(V_=V_/Vl*Vf)+VY)-(-VN+VK)*(-V_+VT),VI=(-(V$=(V$=-(VY-Vk))/(Vl=Math.sqrt(V$*V$+VM*VM))*Vf)+VW)*(-(VM=VM/Vl*Vf)+VY)-(-V$+VK)*(-VM+Vk),Vv=(VZ=-V_+VT-(-V_+VY))*(VG=-V$+VK-(-V$+VW))-(VH=-VM+Vk-(-VM+VY))*(Vu=-VN+VK-(-VN+VA)),Math.abs(Vv)<.1?(Vv+=10.1,VV.push(VK-VN,VY-V_,VR,VX,Vz,VK+VN,VY+V_,VR,VX,Vz)):(((Vb=(Vu*VI-VG*Vc)/Vv)-VK)*(Vb-VK)+((VP=(VH*Vc-VZ*VI)/Vv)-VY)+(VP-VY),VV.push(Vb,VP,VR,VX,Vz,VK-(Vb-VK),VY-(VP-VY),VR,VX,Vz));Vp&&(Va=Vp);var Vg=this.edges+1;for(VF=1;VF<Vg;VF++)Va.push(Vh+2*(VF-1),Vh+2*(VF-1)+1,Vh+2*VF+1,Vh+2*VF+1,Vh+2*VF,Vh+2*(VF-1));return Va.push(Vh+2*(VF-1),Vh+2*(VF-1)+1,Vh+1,Vh+1,Vh,Vh+2*(VF-1)),VV},Vn}(),Vxn=function(){function Vm(){}return Vi(Vm,"laya.webgl.shapes.Earcut"),Vm.earcut=function(Vn,Va,VU){VU=VU||2;var Vx,VD,Vp,VQ,VV,Vy,VR,VX=Va&&Va.length,Vz=VX?Va[0]*VU:Vn.length,Vi=Vm.linkedList(Vn,0,Vz,VU,!0),Vq=[];if(!Vi)return Vq;if(VX&&(Vi=Vm.eliminateHoles(Vn,Va,Vi,VU)),Vn.length>80*VU){Vx=Vp=Vn[0],VD=VQ=Vn[1];for(var VE=VU;VE<Vz;VE+=VU)(VV=Vn[VE])<Vx&&(Vx=VV),(Vy=Vn[VE+1])<VD&&(VD=Vy),Vp<VV&&(Vp=VV),VQ<Vy&&(VQ=Vy);VR=0!==(VR=Math.max(Vp-Vx,VQ-VD))?1/VR:0}return Vm.earcutLinked(Vi,Vq,VU,Vx,VD,VR),Vq},Vm.linkedList=function(Vn,Va,VU,Vx,VD){var Vp,VQ;if(VD===0<Vm.signedArea(Vn,Va,VU,Vx))for(Vp=Va;Vp<VU;Vp+=Vx)VQ=Vm.insertNode(Vp,Vn[Vp],Vn[Vp+1],VQ);else for(Vp=VU-Vx;Va<=Vp;Vp-=Vx)VQ=Vm.insertNode(Vp,Vn[Vp],Vn[Vp+1],VQ);return VQ&&Vm.equals(VQ,VQ.next)&&(Vm.removeNode(VQ),VQ=VQ.next),VQ},Vm.filterPoints=function(Vn,Va){if(!Vn)return Vn;Va||(Va=Vn);var VU,Vx=Vn;do{if(VU=!1,Vx.steiner||!Vm.equals(Vx,Vx.next)&&0!==Vm.area(Vx.prev,Vx,Vx.next))Vx=Vx.next;else{if(Vm.removeNode(Vx),(Vx=Va=Vx.prev)===Vx.next)break;VU=!0}}while(VU||Vx!==Va);return Va},Vm.earcutLinked=function(Vn,Va,VU,Vx,VD,Vp,VQ){if(Vn){!VQ&&Vp&&Vm.indexCurve(Vn,Vx,VD,Vp);for(var VV,Vy,VR=Vn;Vn.prev!==Vn.next;)if(VV=Vn.prev,Vy=Vn.next,Vp?Vm.isEarHashed(Vn,Vx,VD,Vp):Vm.isEar(Vn))Va.push(VV.i/VU),Va.push(Vn.i/VU),Va.push(Vy.i/VU),Vm.removeNode(Vn),Vn=Vy.next,VR=Vy.next;else if((Vn=Vy)===VR){VQ?1===VQ?(Vn=Vm.cureLocalIntersections(Vn,Va,VU),Vm.earcutLinked(Vn,Va,VU,Vx,VD,Vp,2)):2===VQ&&Vm.splitEarcut(Vn,Va,VU,Vx,VD,Vp):Vm.earcutLinked(Vm.filterPoints(Vn,null),Va,VU,Vx,VD,Vp,1);break}}},Vm.isEar=function(Vn){var Va=Vn.prev,VU=Vn,Vx=Vn.next;if(0<=Vm.area(Va,VU,Vx))return!1;for(var VD=Vn.next.next;VD!==Vn.prev;){if(Vm.pointInTriangle(Va.x,Va.y,VU.x,VU.y,Vx.x,Vx.y,VD.x,VD.y)&&0<=Vm.area(VD.prev,VD,VD.next))return!1;VD=VD.next}return!0},Vm.isEarHashed=function(Vn,Va,VU,Vx){var VD=Vn.prev,Vp=Vn,VQ=Vn.next;if(0<=Vm.area(VD,Vp,VQ))return!1;for(var VV=VD.x<Vp.x?VD.x<VQ.x?VD.x:VQ.x:Vp.x<VQ.x?Vp.x:VQ.x,Vy=VD.y<Vp.y?VD.y<VQ.y?VD.y:VQ.y:Vp.y<VQ.y?Vp.y:VQ.y,VR=VD.x>Vp.x?VD.x>VQ.x?VD.x:VQ.x:Vp.x>VQ.x?Vp.x:VQ.x,VX=VD.y>Vp.y?VD.y>VQ.y?VD.y:VQ.y:Vp.y>VQ.y?Vp.y:VQ.y,Vz=Vm.zOrder(VV,Vy,Va,VU,Vx),Vi=Vm.zOrder(VR,VX,Va,VU,Vx),Vq=Vn.nextZ;Vq&&Vq.z<=Vi;){if(Vq!==Vn.prev&&Vq!==Vn.next&&Vm.pointInTriangle(VD.x,VD.y,Vp.x,Vp.y,VQ.x,VQ.y,Vq.x,Vq.y)&&0<=Vm.area(Vq.prev,Vq,Vq.next))return!1;Vq=Vq.nextZ}for(Vq=Vn.prevZ;Vq&&Vq.z>=Vz;){if(Vq!==Vn.prev&&Vq!==Vn.next&&Vm.pointInTriangle(VD.x,VD.y,Vp.x,Vp.y,VQ.x,VQ.y,Vq.x,Vq.y)&&0<=Vm.area(Vq.prev,Vq,Vq.next))return!1;Vq=Vq.prevZ}return!0},Vm.cureLocalIntersections=function(Vn,Va,VU){var Vx=Vn;do{var VD=Vx.prev,Vp=Vx.next.next;!Vm.equals(VD,Vp)&&Vm.intersects(VD,Vx,Vx.next,Vp)&&Vm.locallyInside(VD,Vp)&&Vm.locallyInside(Vp,VD)&&(Va.push(VD.i/VU),Va.push(Vx.i/VU),Va.push(Vp.i/VU),Vm.removeNode(Vx),Vm.removeNode(Vx.next),Vx=Vn=Vp),Vx=Vx.next}while(Vx!==Vn);return Vx},Vm.splitEarcut=function(Vn,Va,VU,Vx,VD,Vp){var VQ=Vn;do{for(var VV=VQ.next.next;VV!==VQ.prev;){if(VQ.i!==VV.i&&Vm.isValidDiagonal(VQ,VV)){var Vy=Vm.splitPolygon(VQ,VV);return VQ=Vm.filterPoints(VQ,VQ.next),Vy=Vm.filterPoints(Vy,Vy.next),Vm.earcutLinked(VQ,Va,VU,Vx,VD,Vp),void Vm.earcutLinked(Vy,Va,VU,Vx,VD,Vp)}VV=VV.next}VQ=VQ.next}while(VQ!==Vn)},Vm.eliminateHoles=function(Vn,Va,VU,Vx){var VD,Vp,VQ,VV,Vy,VR=[];for(VD=0,Vp=Va.length;VD<Vp;VD++)VQ=Va[VD]*Vx,VV=VD<Vp-1?Va[VD+1]*Vx:Vn.length,(Vy=Vm.linkedList(Vn,VQ,VV,Vx,!1))===Vy.next&&(Vy.steiner=!0),VR.push(Vm.getLeftmost(Vy));for(VR.sort(Vm.compareX),VD=0;VD<VR.length;VD++)Vm.eliminateHole(VR[VD],VU),VU=Vm.filterPoints(VU,VU.next);return VU},Vm.compareX=function(Vn,Va){return Vn.x-Va.x},Vm.eliminateHole=function(Vn,Va){if(Va=Vm.findHoleBridge(Vn,Va)){var VU=Vm.splitPolygon(Va,Vn);Vm.filterPoints(VU,VU.next)}},Vm.findHoleBridge=function(Vn,Va){var VU,Vx=Va,VD=Vn.x,Vp=Vn.y,VQ=-1/0;do{if(Vp<=Vx.y&&Vp>=Vx.next.y&&Vx.next.y!==Vx.y){var VV=Vx.x+(Vp-Vx.y)*(Vx.next.x-Vx.x)/(Vx.next.y-Vx.y);if(VV<=VD&&VQ<VV){if((VQ=VV)===VD){if(Vp===Vx.y)return Vx;if(Vp===Vx.next.y)return Vx.next}VU=Vx.x<Vx.next.x?Vx:Vx.next}}Vx=Vx.next}while(Vx!==Va);if(!VU)return null;if(VD===VQ)return VU.prev;var Vy,VR=VU,VX=VU.x,Vz=VU.y,Vi=1/0;for(Vx=VU.next;Vx!==VR;)VD>=Vx.x&&Vx.x>=VX&&VD!==Vx.x&&Vm.pointInTriangle(Vp<Vz?VD:VQ,Vp,VX,Vz,Vp<Vz?VQ:VD,Vp,Vx.x,Vx.y)&&((Vy=Math.abs(Vp-Vx.y)/(VD-Vx.x))<Vi||Vy===Vi&&Vx.x>VU.x)&&Vm.locallyInside(Vx,Vn)&&(VU=Vx,Vi=Vy),Vx=Vx.next;return VU},Vm.indexCurve=function(Vn,Va,VU,Vx){for(var VD=Vn;null===VD.z&&(VD.z=Vm.zOrder(VD.x,VD.y,Va,VU,Vx)),VD.prevZ=VD.prev,VD.nextZ=VD.next,(VD=VD.next)!==Vn;);VD.prevZ.nextZ=null,VD.prevZ=null,Vm.sortLinked(VD)},Vm.sortLinked=function(Vn){var Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR=1;do{for(VU=Vn,Vp=Vn=null,VQ=0;VU;){for(VQ++,Vx=VU,Va=VV=0;Va<VR&&(VV++,Vx=Vx.nextZ);Va++);for(Vy=VR;0<VV||0<Vy&&Vx;)0!==VV&&(0===Vy||!Vx||VU.z<=Vx.z)?(VU=(VD=VU).nextZ,VV--):(Vx=(VD=Vx).nextZ,Vy--),Vp?Vp.nextZ=VD:Vn=VD,VD.prevZ=Vp,Vp=VD;VU=Vx}Vp.nextZ=null,VR*=2}while(1<VQ);return Vn},Vm.zOrder=function(Vn,Va,VU,Vx,VD){return(Vn=1431655765&((Vn=858993459&((Vn=252645135&((Vn=16711935&((Vn=32767*(Vn-VU)*VD)|Vn<<8))|Vn<<4))|Vn<<2))|Vn<<1))|(Va=1431655765&((Va=858993459&((Va=252645135&((Va=16711935&((Va=32767*(Va-Vx)*VD)|Va<<8))|Va<<4))|Va<<2))|Va<<1))<<1},Vm.getLeftmost=function(Vn){for(var Va=Vn,VU=Vn;Va.x<VU.x&&(VU=Va),(Va=Va.next)!==Vn;);return VU},Vm.pointInTriangle=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){return 0<=(VD-VQ)*(Va-VV)-(Vn-VQ)*(Vp-VV)&&0<=(Vn-VQ)*(Vx-VV)-(VU-VQ)*(Va-VV)&&0<=(VU-VQ)*(Vp-VV)-(VD-VQ)*(Vx-VV)},Vm.isValidDiagonal=function(Vn,Va){return Vn.next.i!==Va.i&&Vn.prev.i!==Va.i&&!Vm.intersectsPolygon(Vn,Va)&&Vm.locallyInside(Vn,Va)&&Vm.locallyInside(Va,Vn)&&Vm.middleInside(Vn,Va)},Vm.area=function(Vn,Va,VU){return(Va.y-Vn.y)*(VU.x-Va.x)-(Va.x-Vn.x)*(VU.y-Va.y)},Vm.equals=function(Vn,Va){return Vn.x===Va.x&&Vn.y===Va.y},Vm.intersects=function(Vn,Va,VU,Vx){return!!(Vm.equals(Vn,Va)&&Vm.equals(VU,Vx)||Vm.equals(Vn,Vx)&&Vm.equals(VU,Va))||0<Vm.area(Vn,Va,VU)!=0<Vm.area(Vn,Va,Vx)&&0<Vm.area(VU,Vx,Vn)!=0<Vm.area(VU,Vx,Va)},Vm.intersectsPolygon=function(Vn,Va){var VU=Vn;do{if(VU.i!==Vn.i&&VU.next.i!==Vn.i&&VU.i!==Va.i&&VU.next.i!==Va.i&&Vm.intersects(VU,VU.next,Vn,Va))return!0;VU=VU.next}while(VU!==Vn);return!1},Vm.locallyInside=function(Vn,Va){return Vm.area(Vn.prev,Vn,Vn.next)<0?0<=Vm.area(Vn,Va,Vn.next)&&0<=Vm.area(Vn,Vn.prev,Va):Vm.area(Vn,Va,Vn.prev)<0||Vm.area(Vn,Vn.next,Va)<0},Vm.middleInside=function(Vn,Va){for(var VU=Vn,Vx=!1,VD=(Vn.x+Va.x)/2,Vp=(Vn.y+Va.y)/2;VU.y>Vp!=VU.next.y>Vp&&VU.next.y!==VU.y&&VD<(VU.next.x-VU.x)*(Vp-VU.y)/(VU.next.y-VU.y)+VU.x&&(Vx=!Vx),(VU=VU.next)!==Vn;);return Vx},Vm.splitPolygon=function(Vn,Va){var VU=new VDn(Vn.i,Vn.x,Vn.y),Vx=new VDn(Va.i,Va.x,Va.y),VD=Vn.next,Vp=Va.prev;return(Vn.next=Va).prev=Vn,(VU.next=VD).prev=VU,(Vx.next=VU).prev=Vx,(Vp.next=Vx).prev=Vp,Vx},Vm.insertNode=function(Vn,Va,VU,Vx){var VD=new VDn(Vn,Va,VU);return Vx?(VD.next=Vx.next,(VD.prev=Vx).next.prev=VD,Vx.next=VD):(VD.prev=VD).next=VD,VD},Vm.removeNode=function(Vn){Vn.next.prev=Vn.prev,Vn.prev.next=Vn.next,Vn.prevZ&&(Vn.prevZ.nextZ=Vn.nextZ),Vn.nextZ&&(Vn.nextZ.prevZ=Vn.prevZ)},Vm.signedArea=function(Vn,Va,VU,Vx){for(var VD=0,Vp=Va,VQ=VU-Vx;Vp<VU;Vp+=Vx)VD+=(Vn[VQ]-Vn[Vp])*(Vn[Vp+1]+Vn[VQ+1]),VQ=Vp;return VD},Vm}(),VDn=function(){function Vn(Vn,Va,VU){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=Vn,this.x=Va,this.y=VU,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return Vi(Vn,"laya.webgl.shapes.EarcutNode"),Vn}(),Vpn=(function(){function Vn(Vn,Va,VU,Vx,VD,Vp,VQ){this.lineWidth=Vn,this.lineColor=Va,this.lineAlpha=VU,this.fillColor=Vx,this.fillAlpha=VD,this.shape=VQ,this.fill=Vp}Vi(Vn,"laya.webgl.shapes.GeometryData");var Va=Vn.prototype;Va.clone=function(){return new Vn(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},Va.getIndexData=function(){return null},Va.getVertexData=function(){return null},Va.destroy=function(){this.shape=null}}(),function(){function Vn(Vn){if(Vn instanceof Float32Array)this.points=Vn;else if(Vn instanceof Array){Vn.length;this.points=new Float32Array(Vn)}}Vi(Vn,"laya.webgl.shapes.Vertex");var Va=Vn.prototype;VW.imps(Va,{"laya.webgl.shapes.IShape":!0}),Va.getData=function(Vn,Va,VU){},Va.needUpdate=function(Vn){return!1},Va.rebuild=function(Vn){},Va.setMatrix=function(Vn){}}(),function(){function Vy(Vn){void 0===Vn&&(Vn=1e4),this._renderType=Vn}Vi(Vy,"laya.webgl.submit.Submit");var Vn=Vy.prototype;return VW.imps(Vn,{"laya.webgl.submit.ISubmit":!0}),Vn.releaseRender=function(){var Vn=Vy._cache;(Vn[Vn._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Vn.getRenderType=function(){return this._renderType},Vn.renderSubmit=function(){if(0===this._numEle)return 1;var Vn=this.shaderValue.textureHost;if(Vn){var Va=Vn.source;if(!Vn.bitmap||!Va)return 1;this.shaderValue.texture=Va,Vn.alphaTexture&&Vn.alphaTexture.source&&(this.shaderValue.texture1=Vn.alphaTexture.source)}this._vb.bind_upload(this._ib);var VU=VKn.mainContext;return this.shaderValue.upload(),VB.activeBlendFunction!==this._blendFn&&(VU.enable(3042),this._blendFn(VU),VB.activeBlendFunction=this._blendFn),Vc.drawCall++,Vc.trianglesFaces+=this._numEle/3,VU.drawElements(4,this._numEle,5123,this._startIdx),1},Vy.__init__=function(){var Vn=Vy.RENDERBASE=new Vy(-1);Vn.shaderValue=new VNn(0,0),Vn.shaderValue.ALPHA=-1234},Vy.createSubmit=function(Vn,Va,VU,Vx,VD){var Vp=Vy._cache._length?Vy._cache[--Vy._cache._length]:new Vy;null==VU&&((VU=Vp._selfVb||(Vp._selfVb=Ven.create(-1))).clear(),Vx=0),Vp._ib=Va,Vp._vb=VU,Vp._startIdx=Vx*Vmn.BYTES_PIDX,Vp._numEle=0;var VQ=Vn._nBlendType;Vp._blendFn=Vn._targets?VB.targetFns[VQ]:VB.fns[VQ],Vp.shaderValue=VD,Vp.shaderValue.setValue(Vn._shader2D);var VV=Vn._shader2D.filters;return VV&&Vp.shaderValue.setFilters(VV),Vp},Vy.createShape=function(Vn,Va,VU,Vx,VD,Vp){var VQ=Vy._cache._length?Vy._cache[--Vy._cache._length]:new Vy;VQ._ib=Va,VQ._vb=VU,VQ._numEle=Vx,VQ._startIdx=VD,VQ.shaderValue=Vp,VQ.shaderValue.setValue(Vn._shader2D);var VV=Vn._nBlendType;return VQ._blendFn=Vn._targets?VB.targetFns[VV]:VB.fns[VV],VQ},Vy.TYPE_2D=1e4,Vy.TYPE_CANVAS=10003,Vy.TYPE_CMDSETRT=10004,Vy.TYPE_CUSTOM=10005,Vy.TYPE_BLURRT=10006,Vy.TYPE_CMDDESTORYPRERT=10007,Vy.TYPE_DISABLESTENCIL=10008,Vy.TYPE_OTHERIBVB=10009,Vy.TYPE_PRIMITIVE=10010,Vy.TYPE_RT=10011,Vy.TYPE_BLUR_RT=10012,Vy.TYPE_TARGET=10013,Vy.TYPE_CHANGE_VALUE=10014,Vy.TYPE_SHAPE=10015,Vy.TYPE_TEXTURE=10016,Vy.TYPE_FILLTEXTURE=10017,Vy.RENDERBASE=null,Vy._cache=((Vy._cache=[])._length=0,Vy._cache),Vy}()),VQn=function(){function Vx(){this.fun=null,this.args=null}Vi(Vx,"laya.webgl.submit.SubmitCMD");var Vn=Vx.prototype;return VW.imps(Vn,{"laya.webgl.submit.ISubmit":!0}),Vn.renderSubmit=function(){return this.fun.apply(null,this.args),1},Vn.getRenderType=function(){return 0},Vn.releaseRender=function(){var Vn=Vx._cache;Vn[Vn._length++]=this},Vx.create=function(Vn,Va){var VU=Vx._cache._length?Vx._cache[--Vx._cache._length]:new Vx;return VU.fun=Va,VU.args=Vn,VU},Vx._cache=((Vx._cache=[])._length=0,Vx._cache),Vx}(),VVn=function(){function Va(){this.variables={}}Vi(Va,"laya.webgl.submit.SubmitCMDScope");var Vn=Va.prototype;return Vn.getValue=function(Vn){return this.variables[Vn]},Vn.addValue=function(Vn,Va){return this.variables[Vn]=Va},Vn.setValue=function(Vn,Va){return this.variables.hasOwnProperty(Vn)?this.variables[Vn]=Va:null},Vn.clear=function(){for(var Vn in this.variables)delete this.variables[Vn]},Vn.recycle=function(){this.clear(),Va.POOL.push(this)},Va.create=function(){var Vn=Va.POOL.pop();return Vn||(Vn=new Va),Vn},Va.POOL=[],Va}(),Vyn=function(){function Vz(){this.offset=0,this.startIndex=0,this._mat=V_.create()}Vi(Vz,"laya.webgl.submit.SubmitOtherIBVB");var Vn=Vz.prototype;return VW.imps(Vn,{"laya.webgl.submit.ISubmit":!0}),Vn.releaseRender=function(){var Vn=Vz._cache;(Vn[Vn._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Vn.getRenderType=function(){return 10009},Vn.renderSubmit=function(){var Vn=this._shaderValue.textureHost;if(Vn){var Va=Vn.source;if(!Vn.bitmap||!Va)return 1;this._shaderValue.texture=Va}this._vb.bind_upload(this._ib);var VU=VAn.worldMatrix4,Vx=V_.TEMP;V_.mulPre(this._mat,VU[0],VU[1],VU[4],VU[5],VU[12],VU[13],Vx);var VD=VAn.worldMatrix4=Vz.tempMatrix4;VD[0]=Vx.a,VD[1]=Vx.b,VD[4]=Vx.c,VD[5]=Vx.d,VD[12]=Vx.tx,VD[13]=Vx.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var Vp=VKn.mainContext;return VB.activeBlendFunction!==this._blendFn&&(Vp.enable(3042),this._blendFn(Vp),VB.activeBlendFunction=this._blendFn),Vc.drawCall++,Vc.trianglesFaces+=this._numEle/3,Vp.drawElements(4,this._numEle,5123,this.startIndex),VAn.worldMatrix4=VU,Vln.activeShader=null,1},Vz.create=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){void 0===Vy&&(Vy=0);var VR=Vz._cache._length?Vz._cache[--Vz._cache._length]:new Vz;VR._ib=VU,VR._vb=Va,VR._numEle=Vx,VR._shader=VD,VR._shaderValue=Vp;var VX=Vn._nBlendType;switch(VR._blendFn=Vn._targets?VB.targetFns[VX]:VB.fns[VX],Vy){case 0:VR.offset=0,VR.startIndex=VV/(Vmn.BYTES_PE*Va.vertexStride)*1.5,VR.startIndex*=Vmn.BYTES_PIDX;break;case 1:VR.startIndex=VQ,VR.offset=VV}return VR},Vz._cache=((Vz._cache=[])._length=0,Vz._cache),Vz.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Vz}(),VRn=function(){function VU(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new VM,this.screenRect=new VM}Vi(VU,"laya.webgl.submit.SubmitScissor");var Vn=VU.prototype;return VW.imps(Vn,{"laya.webgl.submit.ISubmit":!0}),Vn._scissor=function(Vn,Va,VU,Vx){var VD=VAn.worldMatrix4,Vp=VD[0],VQ=VD[5],VV=VD[12],Vy=VD[13];if(Vx*=VQ,(VU*=Vp)<1||Vx<1)return!1;var VR=(Vn=Vn*Vp+VV)+VU,VX=(Va=Va*VQ+Vy)+Vx;Vn<0&&(VU=VR-(Vn=0)),Va<0&&(Vx=VX-(Va=0));var Vz=VAn.worldClipRect;if(Vn=Math.max(Vn,Vz.x),Va=Math.max(Va,Vz.y),VU=Math.min(VR,Vz.right)-Vn,Vx=Math.min(VX,Vz.bottom)-Va,VU<1||Vx<1)return!1;var Vi=VAn.worldScissorTest;return this.screenRect.copyFrom(Vz),Vz.x=Vn,Vz.y=Va,Vz.width=VU,Vz.height=Vx,VAn.worldScissorTest=!0,Va=VAn.height-Va-Vx,VKn.mainContext.scissor(Vn,Va,VU,Vx),VKn.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),Vi?(Va=VAn.height-this.screenRect.y-this.screenRect.height,VKn.mainContext.scissor(this.screenRect.x,Va,this.screenRect.width,this.screenRect.height),VKn.mainContext.enable(3089)):(VKn.mainContext.disable(3089),VAn.worldScissorTest=!1),Vz.copyFrom(this.screenRect),!0},Vn._scissorWithTagart=function(Vn,Va,VU,Vx){if(VU<1||Vx<1)return!1;var VD=Vn+VU,Vp=Va+Vx;Vn<0&&(VU=VD-(Vn=0)),Va<0&&(Vx=Vp-(Va=0));var VQ=VAn.worldClipRect;if(Vn=Math.max(Vn,VQ.x),Va=Math.max(Va,VQ.y),VU=Math.min(VD,VQ.right)-Vn,Vx=Math.min(Vp,VQ.bottom)-Va,VU<1||Vx<1)return!1;var VV=VAn.worldScissorTest;return this.screenRect.copyFrom(VQ),VAn.worldScissorTest=!0,VQ.x=Vn,VQ.y=Va,VQ.width=VU,VQ.height=Vx,Va=VAn.height-Va-Vx,VKn.mainContext.scissor(Vn,Va,VU,Vx),VKn.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),VV?(Va=VAn.height-this.screenRect.y-this.screenRect.height,VKn.mainContext.scissor(this.screenRect.x,Va,this.screenRect.width,this.screenRect.height),VKn.mainContext.enable(3089)):(VKn.mainContext.disable(3089),VAn.worldScissorTest=!1),VQ.copyFrom(this.screenRect),!0},Vn.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},Vn.getRenderType=function(){return 0},Vn.releaseRender=function(){var Vn=VU._cache;(Vn[Vn._length++]=this).context=null},VU.create=function(Vn){var Va=VU._cache._length?VU._cache[--VU._cache._length]:new VU;return Va.context=Vn,Va},VU._cache=((VU._cache=[])._length=0,VU._cache),VU}(),VXn=function(){function Vy(){this.step=0,this.blendMode=null,this.level=0}Vi(Vy,"laya.webgl.submit.SubmitStencil");var Vn=Vy.prototype;return VW.imps(Vn,{"laya.webgl.submit.ISubmit":!0}),Vn.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},Vn.getRenderType=function(){return 0},Vn.releaseRender=function(){var Vn=Vy._cache;Vn[Vn._length++]=this},Vn.do1=function(){var Vn=VKn.mainContext;Vn.enable(2960),Vn.clear(1024),Vn.colorMask(!1,!1,!1,!1),Vn.stencilFunc(514,this.level,255),Vn.stencilOp(7680,7680,7682)},Vn.do2=function(){var Vn=VKn.mainContext;Vn.stencilFunc(514,this.level+1,255),Vn.colorMask(!0,!0,!0,!0),Vn.stencilOp(7680,7680,7680)},Vn.do3=function(){var Vn=VKn.mainContext;Vn.colorMask(!0,!0,!0,!0),Vn.stencilOp(7680,7680,7680),Vn.clear(1024),Vn.disable(2960)},Vn.do4=function(){var Vn=VKn.mainContext;0==this.level&&(Vn.enable(2960),Vn.clear(1024)),Vn.colorMask(!1,!1,!1,!1),Vn.stencilFunc(519,0,255),Vn.stencilOp(7680,7680,7682)},Vn.do5=function(){var Vn=VKn.mainContext;Vn.stencilFunc(514,this.level,255),Vn.colorMask(!0,!0,!0,!0),Vn.stencilOp(7680,7680,7680)},Vn.do6=function(){var Vn=VKn.mainContext;VB.targetFns[VB.TOINT[this.blendMode]](Vn)},Vn.do7=function(){var Vn=VKn.mainContext;Vn.colorMask(!1,!1,!1,!1),Vn.stencilOp(7680,7680,7683)},Vn.do8=function(){var Vn=VKn.mainContext;Vn.colorMask(!0,!0,!0,!0),Vn.stencilFunc(514,this.level,255),Vn.stencilOp(7680,7680,7680)},Vy.restore=function(Vn,Va,VU,Vx,VD){var Vp;if((Vn._renderKey=0)<Vy._mask&&Vy._mask--,0==Vy._mask)Vp=laya.webgl.submit.SubmitStencil.create(3),Vn.addRenderObject(Vp),Vn._curSubmit=Vpn.RENDERBASE;else{Vp=laya.webgl.submit.SubmitStencil.create(7),Vn.addRenderObject(Vp);var VQ=Vn._vb;VQ._byteLength;if(Vbn.fillRectImgVb(VQ,null,Va.x,Va.y,Va.width,Va.height,Vv.DEF_UV,VU,Vx,VD,0,0)){Vn._shader2D.glTexture=null;var VV=Vn._curSubmit=Vpn.createSubmit(Vn,Vn._ib,VQ,(VQ._byteLength-64)/32*3,VNn.create(2,0));VV.shaderValue.ALPHA=1,Vn._submits[Vn._submits._length++]=VV,Vn._curSubmit._numEle+=6,Vn._curSubmit=Vpn.RENDERBASE}else alert("clipRect calc stencil rect error");Vp=laya.webgl.submit.SubmitStencil.create(8),Vn.addRenderObject(Vp)}},Vy.restore2=function(Vn,Va){var VU;(Vn._renderKey=0)<Vy._mask&&Vy._mask--,0==Vy._mask?(VU=laya.webgl.submit.SubmitStencil.create(3),Vn.addRenderObject(VU),Vn._curSubmit=Vpn.RENDERBASE):(VU=laya.webgl.submit.SubmitStencil.create(7),Vn.addRenderObject(VU),Vn._submits[Vn._submits._length++]=Va,VU=laya.webgl.submit.SubmitStencil.create(8),Vn.addRenderObject(VU))},Vy.create=function(Vn){var Va=Vy._cache._length?Vy._cache[--Vy._cache._length]:new Vy;return 5==(Va.step=Vn)&&++Vy._mask,Va.level=Vy._mask,Va},Vy._cache=((Vy._cache=[])._length=0,Vy._cache),Vy._mask=0,Vy}(),Vzn=function(){function VV(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}Vi(VV,"laya.webgl.submit.SubmitTarget");var Vn=VV.prototype;return VW.imps(Vn,{"laya.webgl.submit.ISubmit":!0}),Vn.renderSubmit=function(){this._vb.bind_upload(this._ib);var Vn=this.scope.getValue(this.proName);return Vn&&(this.shaderValue.texture=Vn.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[Vn.width,Vn.height]),this.shaderValue.upload(),this.blend(),Vc.drawCall++,Vc.trianglesFaces+=this._numEle/3,VKn.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},Vn.blend=function(){if(VB.activeBlendFunction!==VB.fns[this.blendType]){var Vn=VKn.mainContext;Vn.enable(3042),VB.fns[this.blendType](Vn),VB.activeBlendFunction=VB.fns[this.blendType]}},Vn.getRenderType=function(){return 0},Vn.releaseRender=function(){var Vn=VV._cache;(Vn[Vn._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},VV.create=function(Vn,Va,VU,Vx,VD,Vp){var VQ=VV._cache._length?VV._cache[--VV._cache._length]:new VV;return VQ._ib=Va,VQ._vb=VU,VQ.proName=Vp,VQ._startIdx=Vx*Vmn.BYTES_PIDX,VQ._numEle=0,VQ.blendType=Vn._nBlendType,VQ.shaderValue=VD,VQ.shaderValue.setValue(Vn._shader2D),VQ},VV._cache=((VV._cache=[])._length=0,VV._cache),VV}(),Vin=function(){function Vn(){this._sourceStr=null}Vi(Vn,"laya.webgl.text.CharSegment");var Va=Vn.prototype;return VW.imps(Va,{"laya.webgl.text.ICharSegment":!0}),Va.textToSpit=function(Vn){this._sourceStr=Vn},Va.getChar=function(Vn){return this._sourceStr.charAt(Vn)},Va.getCharCode=function(Vn){return this._sourceStr.charCodeAt(Vn)},Va.length=function(){return this._sourceStr.length},Vn}(),Vqn=function(){var Vn;function Vc(){}return Vi(Vc,"laya.webgl.text.DrawText"),Vc.__init__=function(){Vc._charsTemp=new Array,Vc._drawValue=new Vn,Vc._charSeg=new Vin},Vc.customCharSeg=function(Vn){Vc._charSeg=Vn},Vc.getChar=function(Vn,Va,VU){var Vx=Vdn.createOneChar(Vn,VU);return-1!=Va&&(Vc._charsCache[Va]=Vx),Vx},Vc._drawSlow=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vz,Vi,Vq,VE){var Vm,Vb,VP=Vc._drawValue.value(Vp,VV,Vy,VR,Vi,Vq,VE),VA=0,VT=0,VK=Vc._charsTemp,VY=0,VW=NaN;if(Vx)for(VK.length=Vx.length,VA=0,VT=Vx.length;VA<VT;VA++)(Vb=Vx[VA])&&(VW=Vb.charNum+VP.txtID,VK[VA]=Vm=Vc._charsCache[VW]||Vc.getChar(Vb.char,VW,VP),Vm.active());else{var Vk=VU instanceof laya.utils.WordText?VU.toString():VU;if(VI.CharacterCache){Vc._charSeg.textToSpit(Vk);var VN=Vc._charSeg.length();for(VA=0,VT=VK.length=VN;VA<VT;VA++)VW=Vc._charSeg.getCharCode(VA)+VP.txtID,VK[VA]=Vm=Vc._charsCache[VW]||Vc.getChar(Vc._charSeg.getChar(VA),VW,VP),Vm.active(),VY+=Vm.cw}else VK.length=0,(Vm=Vc.getChar(Vk,-1,VP)).active(),VY+=Vm.cw,VK[0]=Vm}var V_=0;null!==VQ&&"left"!==VQ&&(V_=-("center"==VQ?VY/2:VY));var V$,VM,VZ=NaN,Vu=0;if(Vx)for(VA=0,VT=VK.length;VA<VT;VA++)Vm=VK[VA],Vb=Vx[VA],Vm&&Vb&&!Vm.isSpace&&(VZ=Vm.borderSize,V$=Vm.texture,Va._drawText(V$,VX+V_+Vb.x*Vi-VZ,Vz+Vb.y*Vq-VZ,V$.width,V$.height,VD,0,0,0,0));else{for(VA=0,VT=VK.length;VA<VT;VA++)(Vm=VK[VA])&&!Vm.isSpace&&(VZ=Vm.borderSize,V$=Vm.texture,Va._drawText(V$,VX+V_-VZ,Vz-VZ,V$.width,V$.height,VD,0,0,0,0),Vn&&((VM=Vn[Vu++])||(VM=Vn[Vu-1]=[]),VM[0]=V$,VM[1]=V_-VZ,VM[2]=-VZ)),V_+=Vm.cw;Vn&&(Vn.length=Vu)}},Vc._drawFast=function(Vn,Va,VU,Vx,VD){for(var Vp,VQ,VV=0,Vy=Vn.length;VV<Vy;VV++)(Vp=(VQ=Vn[VV])[0]).active(),Va._drawText(Vp,Vx+VQ[1],VD+VQ[2],Vp.width,Vp.height,VU,0,0,0,0)},Vc.drawText=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vz){if(void 0===Vz&&(Vz=0),!(Va&&0===Va.length||VU&&0===VU.length)){var Vi=Vx.a,Vq=Vx.d;(0!==Vx.b||0!==Vx.c)&&(Vi=Vq=1);var VE=1!==Vi||1!==Vq;if(VE&&VW.stage.transform){var Vm=VW.stage.transform;VE=Vm.a===Vi&&Vm.d===Vq}else VE=!1;if(VE){var Vb=(Vx=Vx.copyTo(Vkn._tmpMatrix)).tx,VP=Vx.ty;Vx.scale(1/Vi,1/Vq),Vx._checkTransform(),VR*=Vi,VX*=Vq,VR+=Vb-Vx.tx,VX+=VP-Vx.ty}else Vi=Vq=1;if(VU)Vc._drawSlow(null,Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vi,Vq,Vz);else{if(null===Va.toUpperCase){var VA=Vi+1e5*Vq,VT=Va;return void(VT.changed||VT.id!==VA?(VT.id=VA,VT.changed=!1,Vc._drawSlow(VT.save,Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vi,Vq,Vz)):Vc._drawFast(VT.save,Vn,Vx,VR,VX))}var VK=Va+VD.toString()+VQ+VV+Vy+Vi+Vq+Vp,VY=Vc._textsCache[VK];VI.CharacterCache?VY?Vc._drawFast(VY,Vn,Vx,VR,VX):(Vc._textsCache.__length||(Vc._textsCache.__length=0),Vc._textsCache.__length>Vk.WebGLTextCacheCount&&((Vc._textsCache={}).__length=0,Vc._curPoolIndex=0),Vc._textCachesPool[Vc._curPoolIndex]?(VY=Vc._textsCache[VK]=Vc._textCachesPool[Vc._curPoolIndex]).length=0:Vc._textCachesPool[Vc._curPoolIndex]=VY=Vc._textsCache[VK]=[],Vc._textsCache.__length++,Vc._curPoolIndex++,Vc._drawSlow(VY,Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vi,Vq,Vz)):Vc._drawSlow(VY,Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vi,Vq,Vz)}}},Vc._charsTemp=null,Vc._textCachesPool=[],Vc._curPoolIndex=0,Vc._charsCache={},Vc._textsCache={},Vc._drawValue=null,Vc.d=[],Vc._charSeg=null,Vc.__init$=function(){Vn=function(){function Vy(){}return Vi(Vy,""),Vy.prototype.value=function(Vn,Va,VU,Vx,VD,Vp,VQ){this.font=Vn,this.fillColor=Va,this.borderColor=VU,this.lineWidth=Vx,this.scaleX=VD,this.scaleY=Vp,this.underLine=VQ;var VV=Vn.toString()+VD+Vp+Vx+(Va?Va.toLowerCase():" ")+(VU?VU.toLowerCase():" ")+VQ;return this.txtID=Vy._keymap[VV],this.txtID||(this.txtID=1e-7*++Vy._keymapCount,Vy._keymap[VV]=this.txtID),this},Vy.clear=function(){Vy._keymap={},Vy._keymapCount=1},Vy._keymap={},Vy._keymapCount=1,Vy}()},Vc}(),VEn=function(){function VD(Vn){this._index=0,this._size=14,this._italic=-2,VD._cache2=VD._cache2||[],this.setFont(Vn||"14px Arial")}Vi(VD,"laya.webgl.text.FontInContext");var Vn=VD.prototype;return Vn.setFont=function(Vn){var Va=VD._cache2[Vn];if(Va)this._words=Va[0],this._size=Va[1];else{this._words=Vn.split(" ");for(var VU=0,Vx=this._words.length;VU<Vx;VU++)if(0<this._words[VU].indexOf("px")){this._index=VU;break}this._size=parseInt(this._words[this._index]),VD._cache2[Vn]=[this._words,this._size]}this._text=null,this._italic=-2},Vn.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},Vn.hasType=function(Vn){for(var Va=0,VU=this._words.length;Va<VU;Va++)if(this._words[Va]===Vn)return Va;return-1},Vn.removeType=function(Vn){for(var Va=0,VU=this._words.length;Va<VU;Va++)if(this._words[Va]===Vn){this._words.splice(Va,1),this._index>Va&&this._index--;break}this._text=null,this._italic=-2},Vn.copyTo=function(Vn){return Vn._text=this._text,Vn._size=this._size,Vn._index=this._index,Vn._words=this._words.slice(),Vn._italic=-2,Vn},Vn.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},Vx(0,Vn,"size",function(){return this._size},function(Vn){this._size=Vn,this._words[this._index]=Vn+"px",this._text=null}),VD.create=function(Vn){var Va=VD._cache[Vn];return Va||(Va=VD._cache[Vn]=new VD(Vn))},VD.EMPTY=new VD,VD._cache={},VD._cache2=null,VD}(),Vmn=function(){function Vn(){}return Vi(Vn,"laya.webgl.utils.CONST3D2D"),Vn.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Vn.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],Vn.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],Vn._TMPARRAY=[],Vn._OFFSETX=0,Vn._OFFSETY=0,VQ(Vn,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),Vn}(),Vbn=function(){function VE(){}return Vi(VE,"laya.webgl.utils.GlUtils"),VE.make2DProjection=function(Vn,Va,VU){return[2/Vn,0,0,0,0,-2/Va,0,0,0,0,2/VU,0,-1,1,0,1]},VE.fillIBQuadrangle=function(Vn,Va){if(65535/4<Va)throw Error("IBQuadrangle count:"+Va+" must<:"+Math.floor(65535/4));Va=Math.floor(Va),Vn._resizeBuffer(6*(Va+1)*2,!1),Vn.byteLength=Vn.bufferLength;for(var VU=Vn.getUint16Array(),Vx=0,VD=0;VD<Va;VD++)VU[Vx++]=4*VD,VU[Vx++]=4*VD+2,VU[Vx++]=4*VD+1,VU[Vx++]=4*VD,VU[Vx++]=4*VD+3,VU[Vx++]=4*VD+2;return Vn.setNeedUpload(),!0},VE.expandIBQuadrangle=function(Vn,Va){Vn.bufferLength>=6*Va*2||VE.fillIBQuadrangle(Vn,Va)},VE.mathCeilPowerOfTwo=function(Vn){return Vn--,Vn|=Vn>>1,Vn|=Vn>>2,Vn|=Vn>>4,Vn|=Vn>>8,Vn|=Vn>>16,++Vn},VE.fillQuadrangleImgVb=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){var Vy=16+(Vn._byteLength>>2);Vn.byteLength=Vy<<2;var VR=Vn.getFloat32Array();VR[(Vy-=16)+2]=VD[0],VR[Vy+3]=VD[1],VR[Vy+6]=VD[2],VR[Vy+7]=VD[3],VR[Vy+10]=VD[4],VR[Vy+11]=VD[5],VR[Vy+14]=VD[6],VR[Vy+15]=VD[7];var VX=Vp.a,Vz=Vp.b,Vi=Vp.c,Vq=Vp.d;if(1!==VX||0!==Vz||0!==Vi||1!==Vq){Vp.bTransform=!0;var VE=Vp.tx+VQ,Vm=Vp.ty+VV;VR[Vy]=(Vx[0]+Va)*VX+(Vx[1]+VU)*Vi+VE,VR[Vy+1]=(Vx[0]+Va)*Vz+(Vx[1]+VU)*Vq+Vm,VR[Vy+4]=(Vx[2]+Va)*VX+(Vx[3]+VU)*Vi+VE,VR[Vy+5]=(Vx[2]+Va)*Vz+(Vx[3]+VU)*Vq+Vm,VR[Vy+8]=(Vx[4]+Va)*VX+(Vx[5]+VU)*Vi+VE,VR[Vy+9]=(Vx[4]+Va)*Vz+(Vx[5]+VU)*Vq+Vm,VR[Vy+12]=(Vx[6]+Va)*VX+(Vx[7]+VU)*Vi+VE,VR[Vy+13]=(Vx[6]+Va)*Vz+(Vx[7]+VU)*Vq+Vm}else Vp.bTransform=!1,Va+=Vp.tx+VQ,VU+=Vp.ty+VV,VR[Vy]=Va+Vx[0],VR[Vy+1]=VU+Vx[1],VR[Vy+4]=Va+Vx[2],VR[Vy+5]=VU+Vx[3],VR[Vy+8]=Va+Vx[4],VR[Vy+9]=VU+Vx[5],VR[Vy+12]=Va+Vx[6],VR[Vy+13]=VU+Vx[7];return Vn._upload=!0},VE.fillTranglesVB=function(Vn,Va,VU,Vx,VD,Vp,VQ){var VV=(Vn._byteLength>>2)+Vx.length;Vn.byteLength=VV<<2;var Vy=Vn.getFloat32Array();VV-=Vx.length;for(var VR=Vx.length,VX=VD.a,Vz=VD.b,Vi=VD.c,Vq=VD.d,VE=0;VE<VR;VE+=4)if(Vy[VV+VE+2]=Vx[VE+2],Vy[VV+VE+3]=Vx[VE+3],1!==VX||0!==Vz||0!==Vi||1!==Vq){VD.bTransform=!0;var Vm=VD.tx+Vp,Vb=VD.ty+VQ;Vy[VV+VE]=(Vx[VE]+Va)*VX+(Vx[VE+1]+VU)*Vi+Vm,Vy[VV+VE+1]=(Vx[VE]+Va)*Vz+(Vx[VE+1]+VU)*Vq+Vb}else VD.bTransform=!1,Va+=VD.tx+Vp,VU+=VD.ty+VQ,Vy[VV+VE]=Va+Vx[VE],Vy[VV+VE+1]=VU+Vx[VE+1];return Vn._upload=!0},VE.copyPreImgVb=function(Vn,Va,VU){var Vx=Vn._byteLength>>2;Vn.byteLength=Vx+16<<2;for(var VD=Vn.getFloat32Array(),Vp=0,VQ=Vx-16;Vp<4;Vp++)VD[Vx]=VD[VQ]+Va,++VQ,VD[++Vx]=VD[VQ]+VU,++VQ,VD[++Vx]=VD[VQ],++VQ,VD[++Vx]=VD[VQ],++Vx,++VQ;Vn._upload=!0},VE.fillRectImgVb=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vz,Vi){void 0===Vi&&(Vi=!1);var Vq,VE,Vm,Vb,VP,VA,VT,VK,VY,VW,Vk,VN,V_,V$,VM,VZ,Vu=1,Vc=VV.a,VH=VV.b,VG=VV.c,VI=VV.d,Vv=Va&&Va.width<99999999;if(1!==Vc||0!==VH||0!==VG||1!==VI?(VV.bTransform=!0,0===VH&&0===VG&&(Vu=23,VY=VD+VU,VW=Vp+Vx,Vq=Vc*VU+(Vk=VV.tx+Vy),Vm=Vc*VY+Vk,VE=VI*Vx+(VN=VV.ty+VR),Vb=VI*VW+VN)):(Vu=23,VV.bTransform=!1,Vm=(Vq=VU+VV.tx+Vy)+VD,Vb=(VE=Vx+VV.ty+VR)+Vp),Vv&&(VP=Va.x,VA=Va.y,VT=Va.width+VP,VK=Va.height+VA),1!==Vu){if(Math.min(Vq,Vm)>=VT)return!1;if(Math.min(VE,Vb)>=VK)return!1;if(Math.max(Vm,Vq)<=VP)return!1;if(Math.max(Vb,VE)<=VA)return!1}var Vl=Vn._byteLength>>2;Vn.byteLength=16+Vl<<2;var Vj=Vn.getFloat32Array();switch(Vj[2+Vl]=VQ[0],Vj[3+Vl]=VQ[1],Vj[6+Vl]=VQ[2],Vj[7+Vl]=VQ[3],Vj[10+Vl]=VQ[4],Vj[11+Vl]=VQ[5],Vj[14+Vl]=VQ[6],Vj[15+Vl]=VQ[7],Vu){case 1:Vk=VV.tx+Vy,VN=VV.ty+VR;var Vh=Vc*VU,Vf=VG*Vx,VF=VI*Vx,Vg=VH*VU,Vo=Vc*(VY=VD+VU),VB=VG*(VW=Vp+Vx),VO=VI*VW,VL=VH*VY;Vi?(V_=Vh+Vf+Vk,VM=Math.round(V_)-V_,V$=VF+Vg+VN,VZ=Math.round(V$)-V$,Vj[Vl]=V_+VM,Vj[1+Vl]=V$+VZ,Vj[4+Vl]=Vo+Vf+Vk+VM,Vj[5+Vl]=VF+VL+VN+VZ,Vj[8+Vl]=Vo+VB+Vk+VM,Vj[9+Vl]=VO+VL+VN+VZ,Vj[12+Vl]=Vh+VB+Vk+VM,Vj[13+Vl]=VO+Vg+VN+VZ):(Vj[Vl]=Vh+Vf+Vk,Vj[1+Vl]=VF+Vg+VN,Vj[4+Vl]=Vo+Vf+Vk,Vj[5+Vl]=VF+VL+VN,Vj[8+Vl]=Vo+VB+Vk,Vj[9+Vl]=VO+VL+VN,Vj[12+Vl]=Vh+VB+Vk,Vj[13+Vl]=VO+Vg+VN);break;case 23:Vi?(V_=Vq+VX,VM=Math.round(V_)-V_,V$=VE,VZ=Math.round(V$)-V$,Vj[Vl]=V_+VM,Vj[1+Vl]=V$+VZ,Vj[4+Vl]=Vm+VX+VM,Vj[5+Vl]=VE+VZ,Vj[8+Vl]=Vm+VM,Vj[9+Vl]=Vb+VZ,Vj[12+Vl]=Vq+VM,Vj[13+Vl]=Vb+VZ):(Vj[Vl]=Vq+VX,Vj[1+Vl]=VE,Vj[4+Vl]=Vm+VX,Vj[5+Vl]=VE,Vj[8+Vl]=Vm,Vj[9+Vl]=Vb,Vj[12+Vl]=Vq,Vj[13+Vl]=Vb)}return Vn._upload=!0},VE.fillLineVb=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){var Vy=.5*VQ,VR=VE._fillLineArray,VX=-(Vx-Vp),Vz=VU-VD,Vi=Math.sqrt(VX*VX+Vz*Vz);VX/=Vi,Vz/=Vi,VX*=Vy,Vz*=Vy,VR[0]=VU-VX,VR[1]=Vx-Vz,VR[4]=VU+VX,VR[5]=Vx+Vz,VR[8]=VD+VX,VR[9]=Vp+Vz,VR[12]=VD-VX,VR[13]=Vp-Vz,VV&&VV.transformPointArray(VR,VR);var Vq=16+(Vn._byteLength>>2);return Vn.byteLength=Vq<<2,Vn.insertData(VR,Vq-16),!0},VE._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],VE}(),VPn=(function(){function Vy(){}Vi(Vy,"laya.webgl.utils.MatirxArray"),Vy.ArrayMul=function(Vn,Va,VU){if(Vn)if(Va)for(var Vx=NaN,VD=NaN,Vp=NaN,VQ=NaN,VV=0;VV<4;VV++)Vx=Vn[VV],VD=Vn[VV+4],Vp=Vn[VV+8],VQ=Vn[VV+12],VU[VV]=Vx*Va[0]+VD*Va[1]+Vp*Va[2]+VQ*Va[3],VU[VV+4]=Vx*Va[4]+VD*Va[5]+Vp*Va[6]+VQ*Va[7],VU[VV+8]=Vx*Va[8]+VD*Va[9]+Vp*Va[10]+VQ*Va[11],VU[VV+12]=Vx*Va[12]+VD*Va[13]+Vp*Va[14]+VQ*Va[15];else Vy.copyArray(Vn,VU);else Vy.copyArray(Va,VU)},Vy.copyArray=function(Vn,Va){if(Vn&&Va)for(var VU=0;VU<Vn.length;VU++)Va[VU]=Vn[VU]}}(),function(){function Va(Vn,Va,VU){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=Vn,this._vb=new Ven(Vn,35048),Va&&this._vb._resizeBuffer(Va,!1),this._ib=new VJn,VU&&this._ib._resizeBuffer(VU,!1)}Vi(Va,"laya.webgl.utils.Mesh2D");var Vn=Va.prototype;return Vn.cloneWithNewVB=function(){var Vn=new Va(this._stride,0,0);return Vn._ib=this._ib,Vn._quadNum=this._quadNum,Vn._attribInfo=this._attribInfo,Vn},Vn.cloneWithNewVBIB=function(){var Vn=new Va(this._stride,0,0);return Vn._attribInfo=this._attribInfo,Vn},Vn.getVBW=function(){return this._vb.setNeedUpload(),this._vb},Vn.getVBR=function(){return this._vb},Vn.getIBR=function(){return this._ib},Vn.getIBW=function(){return this._ib.setNeedUpload(),this._ib},Vn.createQuadIB=function(Vn){this._quadNum=Vn,this._ib._resizeBuffer(6*Vn*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var Va=this._ib.getUint16Array(),VU=0,Vx=0,VD=0;VD<Vn;VD++)Va[VU++]=Vx,Va[VU++]=Vx+2,Va[VU++]=Vx+1,Va[VU++]=Vx,Va[VU++]=Vx+3,Va[VU++]=Vx+2,Vx+=4;this._ib.setNeedUpload()},Vn.setAttributes=function(Vn){if(this._attribInfo=Vn,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},Vn.getEleNum=function(){return this._ib.getBuffer().byteLength/2},Vn.releaseMesh=function(){},Vn.destroy=function(){},Vn.clearVB=function(){this._vb.clear()},Va._gvaoid=0,Va}()),VAn=function(){function VD(){}return Vi(VD,"laya.webgl.utils.RenderState2D"),VD.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},VD.mat2MatArray=function(Vn,Va){var VU=Vn,Vx=Va;return Vx[0]=VU.a,Vx[1]=VU.b,Vx[2]=VD.EMPTYMAT4_ARRAY[2],Vx[3]=VD.EMPTYMAT4_ARRAY[3],Vx[4]=VU.c,Vx[5]=VU.d,Vx[6]=VD.EMPTYMAT4_ARRAY[6],Vx[7]=VD.EMPTYMAT4_ARRAY[7],Vx[8]=VD.EMPTYMAT4_ARRAY[8],Vx[9]=VD.EMPTYMAT4_ARRAY[9],Vx[10]=VD.EMPTYMAT4_ARRAY[10],Vx[11]=VD.EMPTYMAT4_ARRAY[11],Vx[12]=VU.tx,Vx[13]=VU.ty,Vx[14]=VD.EMPTYMAT4_ARRAY[14],Vx[15]=VD.EMPTYMAT4_ARRAY[15],Va},VD.restoreTempArray=function(){VD.TEMPMAT4_ARRAY[0]=1,VD.TEMPMAT4_ARRAY[1]=0,VD.TEMPMAT4_ARRAY[4]=0,VD.TEMPMAT4_ARRAY[5]=1,VD.TEMPMAT4_ARRAY[12]=0,VD.TEMPMAT4_ARRAY[13]=0},VD.clear=function(){VD.worldScissorTest=!1,VD.worldShaderDefines=null,VD.worldFilters=null,VD.worldAlpha=1,VD.worldClipRect.x=VD.worldClipRect.y=0,VD.worldClipRect.width=VD.width,VD.worldClipRect.height=VD.height,VD.curRenderTarget=null},VD._MAXSIZE=99999999,VD.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],VD.worldMatrix4=VD.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],VD.worldAlpha=1,VD.worldScissorTest=!1,VD.worldFilters=null,VD.worldShaderDefines=null,VD.curRenderTarget=null,VD.width=0,VD.height=0,VQ(VD,["worldMatrix",function(){return this.worldMatrix=new V_},"worldClipRect",function(){return this.worldClipRect=new VM(0,0,99999999,99999999)}]),VD}(),VTn=function(){var VA,VU;function VT(Vn,Va,VU,Vx,VD){var Vp=this;function VQ(Vn){var Va=[],VU=new VA(Va);return Vp._compileToTree(VU,Vn.split("\n"),0,Va,VD),VU}var VV=Vq.now();this._VS=VQ(Va),this._PS=VQ(VU),this._nameMap=Vx,2<Vq.now()-VV&&console.log("ShaderCompile use time:"+(Vq.now()-VV)+"  size:"+Va.length+"/"+VU.length)}Vi(VT,"laya.webgl.utils.ShaderCompile");var Vn=VT.prototype;return Vn._compileToTree=function(Vn,Va,VU,Vx,VD){var Vp,VQ,VV,Vy,VR,VX,Vz,Vi=0,Vq=0,VE=0,Vm=0;for(Vq=VU;Vq<Va.length;Vq++)if(!((VV=Va[Vq]).length<1)&&0!==(Vi=VV.indexOf("//"))){if(0<=Vi&&(VV=VV.substr(0,Vi)),Vp=Vz||new VA(Vx),Vz=null,Vp.text=VV,Vp.noCompile=!0,0<=(Vi=VV.indexOf("#"))){for(Vy="#",Vm=Vi+1,VE=VV.length;Vm<VE;Vm++){var Vb=VV.charAt(Vm);if(" "===Vb||"\t"===Vb||"\r"===Vb||"\n"===Vb||"?"===Vb)break;Vy+=Vb}switch(Vp.name=Vy){case"#ifdef":case"#ifndef":if(Vp.src=VV,Vp.noCompile=null!=VV.match(/[!&|()=<>]/),Vp.noCompile?console.log("function():Boolean{return "+VV.substr(Vi+Vp.name.length)+"}"):(VX=VV.replace(/^\s*/,"").split(/\s+/),Vp.setCondition(VX[1],"#ifdef"===Vy?1:2),Vp.text="//"+Vp.text),Vp.setParent(Vn),Vn=Vp,VD)for(VX=VV.substr(Vm).split(VT._splitToWordExps3),Vm=0;Vm<VX.length;Vm++)(VV=VX[Vm]).length&&(VD[VV]=!0);continue;case"#if":if(Vp.src=VV,Vp.noCompile=!0,Vp.setParent(Vn),Vn=Vp,VD)for(VX=VV.substr(Vm).split(VT._splitToWordExps3),Vm=0;Vm<VX.length;Vm++)(VV=VX[Vm]).length&&"defined"!=VV&&(VD[VV]=!0);continue;case"#else":Vp.src=VV,VQ=(Vn=Vn.parent).childs[Vn.childs.length-1],Vp.noCompile=VQ.noCompile,Vp.noCompile||(Vp.condition=VQ.condition,Vp.conditionType=1==VQ.conditionType?2:1,Vp.text="//"+Vp.text+" "+VQ.text+" "+Vp.conditionType),Vp.setParent(Vn),Vn=Vp;continue;case"#endif":VQ=(Vn=Vn.parent).childs[Vn.childs.length-1],Vp.noCompile=VQ.noCompile,Vp.noCompile||(Vp.text="//"+Vp.text),Vp.setParent(Vn);continue;case"#include":VX=VT.splitToWords(VV,null);var VP=VT.includes[VX[1]];if(!VP)throw"ShaderCompile error no this include file:"+VX[1];if((Vi=VX[0].indexOf("?"))<0){Vp.setParent(Vn),VV=VP.getWith("with"==VX[2]?VX[3]:null),this._compileToTree(Vp,VV.split("\n"),0,Vx,VD),Vp.text="";continue}Vp.setCondition(VX[0].substr(Vi+1),1),Vp.text=VP.getWith("with"==VX[2]?VX[3]:null);break;case"#import":VR=(VX=VT.splitToWords(VV,null))[1],Vx.push({node:Vp,file:VT.includes[VR],ofs:Vp.text.length});continue}}else{if((VQ=Vn.childs[Vn.childs.length-1])&&!VQ.name){0<Vx.length&&VT.splitToWords(VV,VQ),Vz=Vp,VQ.text+="\n"+VV;continue}0<Vx.length&&VT.splitToWords(VV,Vp)}Vp.setParent(Vn)}},Vn.createShader=function(Vn,Va,VU){var Vx={},VD="";if(Vn)for(var Vp in Vn)VD+="#define "+Vp+"\n",Vx[Vp]=!0;var VQ=this._VS.toscript(Vx,[]),VV=this._PS.toscript(Vx,[]);return(VU||Vsn.create)(VD+VQ.join("\n"),VD+VV.join("\n"),Va,this._nameMap)},VT._parseOne=function(Vn,Va,VU,Vx,VD,Vp){var VQ={type:VT.shaderParamsMap[VU[Vx+1]],name:VU[Vx+2],size:isNaN(parseInt(VU[Vx+3]))?1:parseInt(VU[Vx+3])};return Vp&&("attribute"==VD?Vn.push(VQ):Va.push(VQ)),":"==VU[Vx+3]&&(VQ.type=VU[Vx+4],Vx+=2),Vx+=2},VT.addInclude=function(Vn,Va){if(!Va||0===Va.length)throw new Error("add shader include file err:"+Vn);if(VT.includes[Vn])throw new Error("add shader include file err, has add:"+Vn);VT.includes[Vn]=new VU(Va)},VT.preGetParams=function(Vn,Va){var VU=[Vn,Va],Vx={},VD=[],Vp=[],VQ={},VV=[];Vx.attributes=VD,Vx.uniforms=Vp,Vx.defines=VQ;for(var Vy=0,VR=0,VX=0;VX<2;VX++){VU[VX]=VU[VX].replace(VT._removeAnnotation,"");var Vz,Vi=VU[VX].match(VT._reg);for(Vy=0,VR=Vi.length;Vy<VR;Vy++){var Vq=Vi[Vy];if("attribute"==Vq||"uniform"==Vq)Vy=VT._parseOne(VD,Vp,Vi,Vy,Vq,!0);else{if("#define"==Vq){VV[Vq=Vi[++Vy]]=1;continue}if("#ifdef"==Vq){VQ[Vz=Vi[++Vy]]=VQ[Vz]||[];for(Vy++;Vy<VR;Vy++)if("attribute"==(Vq=Vi[Vy])||"uniform"==Vq)Vy=VT._parseOne(VD,Vp,Vi,Vy,Vq,VV[Vz]);else if("#else"==Vq)for(Vy++;Vy<VR;Vy++)if("attribute"==(Vq=Vi[Vy])||"uniform"==Vq)Vy=VT._parseOne(VD,Vp,Vi,Vy,Vq,!VV[Vz]);else if("#endif"==Vq)break}}}}return Vx},VT.splitToWords=function(Vn,Va){for(var VU,Vx,VD=[],Vp=-1,VQ=0,VV=Vn.length;VQ<VV;VQ++)if(VU=Vn.charAt(VQ),0<=" \t=+-*/&%!<>()'\",;".indexOf(VU)){if(0<=Vp&&1<VQ-Vp&&(Vx=Vn.substr(Vp,VQ-Vp),VD.push(Vx)),'"'==VU||"'"==VU){var Vy=Vn.indexOf(VU,VQ+1);if(Vy<0)throw"Sharder err:"+Vn;VD.push(Vn.substr(VQ+1,Vy-VQ-1)),VQ=Vy,Vp=-1;continue}"("==VU&&Va&&0<VD.length&&(Vx=VD[VD.length-1]+";","vec4;main;".indexOf(Vx)<0&&(Va.useFuns+=Vx)),Vp=-1}else Vp<0&&(Vp=VQ);return Vp<VV&&1<VV-Vp&&(Vx=Vn.substr(Vp,VV-Vp),VD.push(Vx)),VD},VT.IFDEF_NO=0,VT.IFDEF_YES=1,VT.IFDEF_ELSE=2,VT.IFDEF_PARENT=3,VT._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),VT._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),VT._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),VT.includes={},VQ(VT,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),VT.__init$=function(){VA=function(){function VU(Vn){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=Vn}Vi(VU,"");var Vn=VU.prototype;return Vn.setParent=function(Vn){Vn.childs.push(this),this.z=Vn.z+1,this.parent=Vn},Vn.setCondition=function(Vn,Va){Vn&&(this.conditionType=Va,Vn=Vn.replace(/(\s*$)/g,""),this.condition=function(){return this[Vn]},this.condition.__condition=Vn)},Vn.toscript=function(Vn,Va){return this._toscript(Vn,Va,++VU.__id)},Vn._toscript=function(Vx,VD,Vp){if(this.childs.length<1&&!this.text)return VD;VD.length;if(this.condition){var Vn=!!this.condition.call(Vx);if(2===this.conditionType&&(Vn=!Vn),!Vn)return VD}if(this.text&&VD.push(this.text),0<this.childs.length&&this.childs.forEach(function(Vn,Va,VU){Vn._toscript(Vx,VD,Vp)}),0<this.includefiles.length&&0<this.useFuns.length)for(var Va,VU=0,VQ=this.includefiles.length;VU<VQ;VU++)this.includefiles[VU].curUseID!=Vp&&0<(Va=this.includefiles[VU].file.getFunsScript(this.useFuns)).length&&(this.includefiles[VU].curUseID=Vp,VD[0]=Va+VD[0]);return VD},VU.__id=1,VU}(),VU=function(){function Vn(Vn){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=Vn;for(var Va=0,VU=0,Vx=0;!((Va=Vn.indexOf("#begin",Va))<0);){for(Vx=Va+5;!((Vx=Vn.indexOf("#end",Vx))<0)&&"i"===Vn.charAt(Vx+4);)Vx+=5;if(Vx<0)throw"add include err,no #end:"+Vn;VU=Vn.indexOf("\n",Va);var VD=VT.splitToWords(Vn.substr(Va,VU-Va),null);"code"==VD[1]?this.codes[VD[2]]=Vn.substr(VU+1,Vx-VU-1):"function"==VD[1]&&(VU=Vn.indexOf("function",Va),VU+="function".length,this.funs[VD[3]]=Vn.substr(VU+1,Vx-VU-1),this.funnames+=VD[3]+";"),Va=Vx+1}}Vi(Vn,"");var Va=Vn.prototype;return Va.getWith=function(Vn){var Va=Vn?this.codes[Vn]:this.script;if(!Va)throw"get with error:"+Vn;return Va},Va.getFunsScript=function(Vn){var Va="";for(var VU in this.funs)0<=Vn.indexOf(VU+";")&&(Va+=this.funs[VU]);return Va},Vn}()},VT}(),VKn=function(){function VQ(){}return Vi(VQ,"laya.webgl.WebGL"),VQ._uint8ArraySlice=function(){for(var Vn=this.length,Va=new Uint8Array(this.length),VU=0;VU<Vn;VU++)Va[VU]=this[VU];return Va},VQ._float32ArraySlice=function(){for(var Vn=this.length,Va=new Float32Array(this.length),VU=0;VU<Vn;VU++)Va[VU]=this[VU];return Va},VQ._uint16ArraySlice=function(Vn){var Va,VU=arguments,Vx=0,VD=0;if(0===VU.length)for(Vx=this.length,Va=new Uint16Array(Vx),VD=0;VD<Vx;VD++)Va[VD]=this[VD];else if(2===VU.length){var Vp=VU[0],VQ=VU[1];if(Vp<VQ)for(Vx=VQ-Vp,Va=new Uint16Array(Vx),VD=Vp;VD<VQ;VD++)Va[VD-Vp]=this[VD];else Va=new Uint16Array(0)}return Va},VQ.expandContext=function(){var Vn=VD.prototype,Va=CanvasRenderingContext2D.prototype;Va.fillTrangles=Vn.fillTrangles,VCn.__int__(null),Va.setIBVB=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){void 0===Vy&&(Vy=0),void 0===VR&&(VR=0),null===VU&&(this._ib=this._ib||VJn.QuadrangleIB,VU=this._ib,Vbn.expandIBQuadrangle(VU,Vx._byteLength/64+8)),this._setIBVB(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR)},Va.fillTrangles=function(Vn,Va,VU,Vx,VD){this._curMat=this._curMat||V_.create(),this._vb=this._vb||Ven.create(),this._ib||(this._ib=VJn.create(),Vbn.fillIBQuadrangle(this._ib,VQ/4));var Vp=this._vb,VQ=Vx.length>>4;Vbn.fillTranglesVB(Vp,Va,VU,Vx,VD||this._curMat,0,0),Vbn.expandIBQuadrangle(this._ib,Vp._byteLength/64+8);var VV=new VNn(1,0);VV.textureHost=Vn;var Vy=new Vrn("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");Vp._vertType=3,this._setIBVB(Va,VU,this._ib,Vp,6*VQ,VD,Vy,VV,0,0)}},VQ.enable=function(){if(Vq.__init__(),VP.isConchApp&&!VP.isConchWebGL)return VY.skinAniSprite=function(){return new Vnn},VQ.expandContext(),!1;if(VY.getWebGLContext=function(Vn){for(var Va,VU=["webgl","experimental-webgl","webkit-3d","moz-webgl"],Vx=0;Vx<VU.length;Vx++){try{Va=Vn.getContext(VU[Vx],{stencil:Vk.isStencil,alpha:Vk.isAlpha,antialias:Vk.isAntialias,premultipliedAlpha:Vk.premultipliedAlpha,preserveDrawingBuffer:Vk.preserveDrawingBuffer})}catch(Vn){}if(Va)return Va}return null},null==(VQ.mainContext=VQ.mainContext||VY.getWebGLContext(VP._mainCanvas)))return!1;if(VP.isWebGL)return!0;Vm.create=function(Vn,Va){return new Vna(Vn,Va)},Vb.create=function(Vn,Va,VU,Vx,VD,Vp,VQ){return new Vwn(Vn,Va,VU,Vx,VD,Vp,VQ)},VP.WebGL=VQ,VP.isWebGL=!0,Vqn.__init__(),VY.createRenderSprite=function(Vn,Va){return new V_n(Vn,Va)},VY.createWebGLContext2D=function(Vn){return new Vkn(Vn)},VY.changeWebGLSize=function(Vn,Va){laya.webgl.WebGL.onStageResize(Vn,Va)},VY.createGraphics=function(){return new VWn};var Vn=VY.createFilterAction;return VY.createFilterAction=Vn||function(Vn){return new V$n},VY.clear=function(Vn){VAn.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var Va=VP.context.ctx,VU=0==Va._submits._length||Vk.preserveDrawingBuffer?VE.create(Vn)._color:Vu._wgColor;VU&&Va.clearBG(VU[0],VU[1],VU[2],VU[3]),VAn.clear()},VY.addToAtlas=function(Vn,Va){void 0===Va&&(Va=!1);var VU=Vn.bitmap;VP.optimizeTextureMemory(Vn.url,Vn)?VW.__typeof(VU,"laya.webgl.resource.IMergeAtlasBitmap")&&VU.allowMerageInAtlas&&VU.on("recovered",Vn,Vn.addTextureToAtlas):VU.enableMerageInAtlas=!1},VY.isAtlas=function(Vn){return Vn instanceof laya.webgl.atlas.AtlasWebGLCanvas},Vg._enable(),VY.beginFlush=function(){for(var Vn=Vg.instance,Va=Vn.getAtlaserCount(),VU=0;VU<Va;VU++){var Vx=Vn.getAtlaserByIndex(VU).texture;Vx._flashCacheImageNeedFlush&&VY.flashFlushImage(Vx)}},VY.drawToCanvas=function(Vn,Va,VU,Vx,VD,Vp){(VU<=0||Vx<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),VU|=0,Vx|=0,VD|=0,Vp|=0;var VQ=Vjn.create(VU,Vx,6408,5121,0,!1);VQ.start(),VQ.clear(0,0,0,0),VP.context.clear(),VA.renders[Va]._fun(Vn,VP.context,VD,VAn.height-Vx+Vp),VP.context.flush(),VQ.end();var VV=VQ.getData(0,0,VU,Vx);if(VQ.recycle(),VV.byteLength==VU*Vx*4){var Vy=new VLn;Vy._canvas=Vq.createElement("canvas"),Vy.size(VU,Vx);var VR=Vy._canvas.getContext("2d");Vq.canvas.size(VU,Vx);var VX=Vq.context,Vz=VX.createImageData(VU,Vx);return Vz.data.set(new Uint8ClampedArray(VV.buffer)),Vy._imgData=Vz,VX.putImageData(Vz,0,0),VR.save(),VR.translate(0,Vx),VR.scale(1,-1),VR.drawImage(Vq.canvas.source,0,0),VR.restore(),Vy}console.log("drawToCanvas error: w:"+VU+",h:"+Vx+",datalen:"+VV.byteLength)},VY.createFilterAction=function(Vn){var Va;switch(Vn){case 32:Va=new V$n}return Va},VY.addTextureToAtlas=function(Vn){Vn._uvID++,Vg._atlasRestore++,Vn.bitmap.enableMerageInAtlas&&Vg.instance.addToAtlas(Vn)},VY.getTexturePixels=function(Vn,Va,VU,Vx,VD){VP.context.ctx.clear();var Vp=new VZ;Vp.graphics.drawTexture(Vn,-Va,-VU);var VQ=Vjn.create(Vx,VD);VQ.start(),VQ.clear(0,0,0,0),Vp.render(VP.context,0,0),VP.context.ctx.flush(),VQ.end();for(var VV=VQ.getData(0,0,Vx,VD),Vy=[],VR=0,VX=VD-1;0<=VX;VX--)for(var Vz=0;Vz<Vx;Vz++)VR=4*(VX*Vx+Vz),Vy.push(VV[VR]),Vy.push(VV[VR+1]),Vy.push(VV[VR+2]),Vy.push(VV[VR+3]);return Vy},VY.skinAniSprite=function(){return new Vnn},VR.create=function(Vn,Va){var VU=new VLn;return VU._imgData=Va,VU.flipY=!1,VU},VN._filterStart=function(Vn,Va,VU,Vx,VD){var Vp=Vn.getValue("bounds"),VQ=Vjn.create(Vp.width,Vp.height);if(VQ.start(),VQ.clear(0,0,0,0),Vn.addValue("src",VQ),Vn.addValue("ScissorTest",VAn.worldScissorTest),VAn.worldScissorTest){var VV=new VM;VV.copyFrom(VU.ctx._clipRect),Vn.addValue("clipRect",VV),VAn.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},VN._filterEnd=function(Vn,Va,VU,Vx,VD){var Vp=Vn.getValue("bounds");Vn.getValue("src").end();var VQ=Vjn.create(Vp.width,Vp.height);VQ.start(),VQ.clear(0,0,0,0),Vn.addValue("out",VQ),Va._set$P("_filterCache",VQ),Va._set$P("_isHaveGlowFilter",Vn.getValue("_isHaveGlowFilter"))},VN._EndTarget=function(Vn,Va){if(Vn.getValue("src").recycle(),Vn.getValue("out").end(),Vn.getValue("ScissorTest")){VAn.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),Va.ctx.save();var VU=Vn.getValue("clipRect");Va.ctx.clipRect(VU.x,VU.y,VU.width,VU.height)}},VN._useSrc=function(Vn){var Va=Vn.getValue("out");Va.end(),(Va=Vn.getValue("src")).start(),Va.clear(0,0,0,0)},VN._endSrc=function(Vn){Vn.getValue("src").end()},VN._useOut=function(Vn){var Va=Vn.getValue("src");Va.end(),(Va=Vn.getValue("out")).start(),Va.clear(0,0,0,0)},VN._endOut=function(Vn){Vn.getValue("out").end()},VN._recycleScope=function(Vn){Vn.recycle()},VN._filter=function(Vn,Va,VU,Vx){var VD=this._next;if(VD){var Vp,VQ,VV=Vn.filters,Vy=VV.length;if(1==Vy&&32==VV[0].type)return Va.ctx.save(),Va.ctx.setFilters([VV[0]]),VD._fun.call(VD,Vn,Va,VU,Vx),void Va.ctx.restore();var VR=VVn.create(),VX=V$.TEMP,Vz=Va.ctx._getTransformMatrix(),Vi=V_.create();Vz.copyTo(Vi);var Vq=0,VE=0,Vm=!1,Vb=Vn._$P._filterCache?Vn._$P._filterCache:null;if(!Vb||Vn._repaint){Vm=Vn._isHaveGlowFilter(),VR.addValue("_isHaveGlowFilter",Vm),Vm&&(Vq=50,VE=25),(VQ=new VM).copyFrom(Vn.getSelfBounds()),VQ.x+=Vn.x,VQ.y+=Vn.y,VQ.x-=Vn.pivotX+4,VQ.y-=Vn.pivotY+4;var VP=VQ.x,VA=VQ.y;if(VQ.width+=Vq+8,VQ.height+=Vq+8,VX.x=VQ.x*Vi.a+VQ.y*Vi.c,VX.y=VQ.y*Vi.d+VQ.x*Vi.b,VQ.x=VX.x,VQ.y=VX.y,VX.x=VQ.width*Vi.a+VQ.height*Vi.c,VX.y=VQ.height*Vi.d+VQ.width*Vi.b,VQ.width=VX.x,VQ.height=VX.y,VQ.width<=0||VQ.height<=0)return;Vb&&Vb.recycle(),VR.addValue("bounds",VQ);var VT=VQn.create([VR,Vn,Va,0,0],VN._filterStart);Va.addRenderObject(VT),Va.ctx._renderKey=0,Va.ctx._shader2D.glTexture=null;var VK=Vn.x-VP+VE,VY=Vn.y-VA+VE;VD._fun.call(VD,Vn,Va,VK,VY),VT=VQn.create([VR,Vn,Va,0,0],VN._filterEnd),Va.addRenderObject(VT);for(var VW=0;VW<Vy;VW++){0!=VW&&(VT=VQn.create([VR],VN._useSrc),Va.addRenderObject(VT),Vp=VNn.create(1,0),V_.TEMP.identity(),Va.ctx.drawTarget(VR,0,0,VQ.width,VQ.height,V_.TEMP,"out",Vp,null,VB.TOINT.overlay),VT=VQn.create([VR],VN._useOut),Va.addRenderObject(VT)),VV[VW].action.apply3d(VR,Vn,Va,0,0)}VT=VQn.create([VR,Va],VN._EndTarget),Va.addRenderObject(VT)}else{if((Vm=!!Vn._$P._isHaveGlowFilter&&Vn._$P._isHaveGlowFilter)&&(Vq=50,VE=25),(VQ=Vn.getBounds()).width<=0||VQ.height<=0)return;VQ.width+=Vq,VQ.height+=Vq,VX.x=VQ.x*Vi.a+VQ.y*Vi.c,VX.y=VQ.y*Vi.d+VQ.x*Vi.b,VQ.x=VX.x,VQ.y=VX.y,VX.x=VQ.width*Vi.a+VQ.height*Vi.c,VX.y=VQ.height*Vi.d+VQ.width*Vi.b,VQ.width=VX.x,VQ.height=VX.y,VR.addValue("out",Vb)}VU=VU-VE-Vn.x,Vx=Vx-VE-Vn.y,VX.setTo(VU,Vx),Vi.transformPoint(VX),VU=VX.x+VQ.x,Vx=VX.y+VQ.y,Vp=VNn.create(1,0),V_.TEMP.identity(),Va.ctx.drawTarget(VR,VU,Vx,VQ.width,VQ.height,V_.TEMP,"out",Vp,null,VB.TOINT.overlay),VT=VQn.create([VR],VN._recycleScope),Va.addRenderObject(VT),Vi.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=VQ._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=VQ._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=VQ._uint8ArraySlice),!0},VQ.onStageResize=function(Vn,Va){null!=VQ.mainContext&&(VQ.mainContext.viewport(0,0,Vn,Va),VAn.width=Vn,VAn.height=Va)},VQ.onInvalidGLRes=function(){Vg.instance.freeAll(),VK.releaseContentManagers(!0),VQ.doNodeRepaint(VW.stage),VQ.mainContext.viewport(0,0,VAn.width,VAn.height),VW.stage.event("devicelost")},VQ.doNodeRepaint=function(Vn){0==Vn.numChildren&&Vn.repaint();for(var Va=0;Va<Vn.numChildren;Va++)VQ.doNodeRepaint(Vn.getChildAt(Va))},VQ.init=function(Vn,Va,VU){VQ.mainCanvas=Vn,VR._createContext=function(Vn){return new Vkn(Vn)},VLn._createContext=function(Vn){return new Vkn(Vn)};var Vx=laya.webgl.WebGL.mainContext;if(null!=Vx.getShaderPrecisionFormat){var VD=Vx.getShaderPrecisionFormat(35633,36338),Vp=Vx.getShaderPrecisionFormat(35632,36338);VQ.shaderHighPrecision=!(!VD.precision||!Vp.precision)}else VQ.shaderHighPrecision=!1;if(VQ.compressAstc=Vx.getExtension("WEBGL_compressed_texture_astc"),VQ.compressAtc=Vx.getExtension("WEBGL_compressed_texture_atc"),VQ.compressEtc=Vx.getExtension("WEBGL_compressed_texture_etc"),VQ.compressEtc1=Vx.getExtension("WEBGL_compressed_texture_etc1"),VQ.compressPvrtc=Vx.getExtension("WEBGL_compressed_texture_pvrtc"),VQ.compressS3tc=Vx.getExtension("WEBGL_compressed_texture_s3tc"),VQ.compressS3tc_srgb=Vx.getExtension("WEBGL_compressed_texture_s3tc_srgb"),VQ.compressAstc=VQ.compressAstc?VQ.compressAstc:{},VQ.compressAtc=VQ.compressAtc?VQ.compressAtc:{},VQ.compressEtc=VQ.compressEtc?VQ.compressEtc:{},VQ.compressEtc1=VQ.compressEtc1?VQ.compressEtc1:{},VQ.compressPvrtc=VQ.compressPvrtc?VQ.compressPvrtc:{},VQ.compressS3tc=VQ.compressS3tc?VQ.compressS3tc:{},VQ.compressS3tc_srgb=VQ.compressS3tc_srgb?VQ.compressS3tc_srgb:{},Vx.deleteTexture1=Vx.deleteTexture,Vx.deleteTexture=function(Vn){Vn==VYn.curBindTexValue&&(VYn.curBindTexValue=null),Vx.deleteTexture1(Vn)},VQ.onStageResize(Va,VU),null==VQ.mainContext)throw new Error("webGL getContext err!");VG.__init__(),Vg.__init__(),VZn.__init__(),Vpn.__init__(),Vkn.__init__(),VNn.__init__(),VJ.__init__(),VCn.__int__(Vx),VB._init_(Vx),VP.isConchApp&&conch.setOnInvalidGLRes(VQ.onInvalidGLRes)},VQ.mainCanvas=null,VQ.antialias=!0,VQ.shaderHighPrecision=!1,VQ._bg_null=[0,0,0,0],VQ}(),VYn=function(){function Vx(){}return Vi(Vx,"laya.webgl.WebGLContext"),Vx.UseProgram=function(Vn){return Vx._useProgram!==Vn&&(VKn.mainContext.useProgram(Vn),Vx._useProgram=Vn,!0)},Vx.setDepthTest=function(Vn,Va){Va!==Vx._depthTest&&((Vx._depthTest=Va)?Vn.enable(2929):Vn.disable(2929))},Vx.setDepthMask=function(Vn,Va){Va!==Vx._depthMask&&(Vx._depthMask=Va,Vn.depthMask(Va))},Vx.setDepthFunc=function(Vn,Va){Va!==Vx._depthFunc&&(Vx._depthFunc=Va,Vn.depthFunc(Va))},Vx.setBlend=function(Vn,Va){Va!==Vx._blend&&((Vx._blend=Va)?Vn.enable(3042):Vn.disable(3042))},Vx.setBlendFunc=function(Vn,Va,VU){(Va!==Vx._sFactor||VU!==Vx._dFactor)&&(Vx._sFactor=Va,Vx._dFactor=VU,Vn.blendFunc(Va,VU))},Vx.setCullFace=function(Vn,Va){Va!==Vx._cullFace&&((Vx._cullFace=Va)?Vn.enable(2884):Vn.disable(2884))},Vx.setFrontFace=function(Vn,Va){Va!==Vx._frontFace&&(Vx._frontFace=Va,Vn.frontFace(Va))},Vx.bindTexture=function(Vn,Va,VU){Vn.bindTexture(Va,VU),Vx.curBindTexTarget=Va,Vx.curBindTexValue=VU},Vx.DEPTH_BUFFER_BIT=256,Vx.STENCIL_BUFFER_BIT=1024,Vx.COLOR_BUFFER_BIT=16384,Vx.POINTS=0,Vx.LINES=1,Vx.LINE_LOOP=2,Vx.LINE_STRIP=3,Vx.TRIANGLES=4,Vx.TRIANGLE_STRIP=5,Vx.TRIANGLE_FAN=6,Vx.ZERO=0,Vx.ONE=1,Vx.SRC_COLOR=768,Vx.ONE_MINUS_SRC_COLOR=769,Vx.SRC_ALPHA=770,Vx.ONE_MINUS_SRC_ALPHA=771,Vx.DST_ALPHA=772,Vx.ONE_MINUS_DST_ALPHA=773,Vx.DST_COLOR=774,Vx.ONE_MINUS_DST_COLOR=775,Vx.SRC_ALPHA_SATURATE=776,Vx.FUNC_ADD=32774,Vx.BLEND_EQUATION=32777,Vx.BLEND_EQUATION_RGB=32777,Vx.BLEND_EQUATION_ALPHA=34877,Vx.FUNC_SUBTRACT=32778,Vx.FUNC_REVERSE_SUBTRACT=32779,Vx.BLEND_DST_RGB=32968,Vx.BLEND_SRC_RGB=32969,Vx.BLEND_DST_ALPHA=32970,Vx.BLEND_SRC_ALPHA=32971,Vx.CONSTANT_COLOR=32769,Vx.ONE_MINUS_CONSTANT_COLOR=32770,Vx.CONSTANT_ALPHA=32771,Vx.ONE_MINUS_CONSTANT_ALPHA=32772,Vx.BLEND_COLOR=32773,Vx.ARRAY_BUFFER=34962,Vx.ELEMENT_ARRAY_BUFFER=34963,Vx.ARRAY_BUFFER_BINDING=34964,Vx.ELEMENT_ARRAY_BUFFER_BINDING=34965,Vx.STREAM_DRAW=35040,Vx.STATIC_DRAW=35044,Vx.DYNAMIC_DRAW=35048,Vx.BUFFER_SIZE=34660,Vx.BUFFER_USAGE=34661,Vx.CURRENT_VERTEX_ATTRIB=34342,Vx.FRONT=1028,Vx.BACK=1029,Vx.CULL_FACE=2884,Vx.FRONT_AND_BACK=1032,Vx.BLEND=3042,Vx.DITHER=3024,Vx.STENCIL_TEST=2960,Vx.DEPTH_TEST=2929,Vx.SCISSOR_TEST=3089,Vx.POLYGON_OFFSET_FILL=32823,Vx.SAMPLE_ALPHA_TO_COVERAGE=32926,Vx.SAMPLE_COVERAGE=32928,Vx.NO_ERROR=0,Vx.INVALID_ENUM=1280,Vx.INVALID_VALUE=1281,Vx.INVALID_OPERATION=1282,Vx.OUT_OF_MEMORY=1285,Vx.CW=2304,Vx.CCW=2305,Vx.LINE_WIDTH=2849,Vx.ALIASED_POINT_SIZE_RANGE=33901,Vx.ALIASED_LINE_WIDTH_RANGE=33902,Vx.CULL_FACE_MODE=2885,Vx.FRONT_FACE=2886,Vx.DEPTH_RANGE=2928,Vx.DEPTH_WRITEMASK=2930,Vx.DEPTH_CLEAR_VALUE=2931,Vx.DEPTH_FUNC=2932,Vx.STENCIL_CLEAR_VALUE=2961,Vx.STENCIL_FUNC=2962,Vx.STENCIL_FAIL=2964,Vx.STENCIL_PASS_DEPTH_FAIL=2965,Vx.STENCIL_PASS_DEPTH_PASS=2966,Vx.STENCIL_REF=2967,Vx.STENCIL_VALUE_MASK=2963,Vx.STENCIL_WRITEMASK=2968,Vx.STENCIL_BACK_FUNC=34816,Vx.STENCIL_BACK_FAIL=34817,Vx.STENCIL_BACK_PASS_DEPTH_FAIL=34818,Vx.STENCIL_BACK_PASS_DEPTH_PASS=34819,Vx.STENCIL_BACK_REF=36003,Vx.STENCIL_BACK_VALUE_MASK=36004,Vx.STENCIL_BACK_WRITEMASK=36005,Vx.VIEWPORT=2978,Vx.SCISSOR_BOX=3088,Vx.COLOR_CLEAR_VALUE=3106,Vx.COLOR_WRITEMASK=3107,Vx.UNPACK_ALIGNMENT=3317,Vx.PACK_ALIGNMENT=3333,Vx.MAX_TEXTURE_SIZE=3379,Vx.MAX_VIEWPORT_DIMS=3386,Vx.SUBPIXEL_BITS=3408,Vx.RED_BITS=3410,Vx.GREEN_BITS=3411,Vx.BLUE_BITS=3412,Vx.ALPHA_BITS=3413,Vx.DEPTH_BITS=3414,Vx.STENCIL_BITS=3415,Vx.POLYGON_OFFSET_UNITS=10752,Vx.POLYGON_OFFSET_FACTOR=32824,Vx.TEXTURE_BINDING_2D=32873,Vx.SAMPLE_BUFFERS=32936,Vx.SAMPLES=32937,Vx.SAMPLE_COVERAGE_VALUE=32938,Vx.SAMPLE_COVERAGE_INVERT=32939,Vx.NUM_COMPRESSED_TEXTURE_FORMATS=34466,Vx.COMPRESSED_TEXTURE_FORMATS=34467,Vx.DONT_CARE=4352,Vx.FASTEST=4353,Vx.NICEST=4354,Vx.GENERATE_MIPMAP_HINT=33170,Vx.BYTE=5120,Vx.UNSIGNED_BYTE=5121,Vx.SHORT=5122,Vx.UNSIGNED_SHORT=5123,Vx.INT=5124,Vx.UNSIGNED_INT=5125,Vx.FLOAT=5126,Vx.DEPTH_COMPONENT=6402,Vx.ALPHA=6406,Vx.RGB=6407,Vx.RGBA=6408,Vx.LUMINANCE=6409,Vx.LUMINANCE_ALPHA=6410,Vx.UNSIGNED_SHORT_4_4_4_4=32819,Vx.UNSIGNED_SHORT_5_5_5_1=32820,Vx.UNSIGNED_SHORT_5_6_5=33635,Vx.FRAGMENT_SHADER=35632,Vx.VERTEX_SHADER=35633,Vx.MAX_VERTEX_ATTRIBS=34921,Vx.MAX_VERTEX_UNIFORM_VECTORS=36347,Vx.MAX_VARYING_VECTORS=36348,Vx.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,Vx.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,Vx.MAX_TEXTURE_IMAGE_UNITS=34930,Vx.MAX_FRAGMENT_UNIFORM_VECTORS=36349,Vx.SHADER_TYPE=35663,Vx.DELETE_STATUS=35712,Vx.LINK_STATUS=35714,Vx.VALIDATE_STATUS=35715,Vx.ATTACHED_SHADERS=35717,Vx.ACTIVE_UNIFORMS=35718,Vx.ACTIVE_ATTRIBUTES=35721,Vx.SHADING_LANGUAGE_VERSION=35724,Vx.CURRENT_PROGRAM=35725,Vx.NEVER=512,Vx.LESS=513,Vx.EQUAL=514,Vx.LEQUAL=515,Vx.GREATER=516,Vx.NOTEQUAL=517,Vx.GEQUAL=518,Vx.ALWAYS=519,Vx.KEEP=7680,Vx.REPLACE=7681,Vx.INCR=7682,Vx.DECR=7683,Vx.INVERT=5386,Vx.INCR_WRAP=34055,Vx.DECR_WRAP=34056,Vx.VENDOR=7936,Vx.RENDERER=7937,Vx.VERSION=7938,Vx.NEAREST=9728,Vx.LINEAR=9729,Vx.NEAREST_MIPMAP_NEAREST=9984,Vx.LINEAR_MIPMAP_NEAREST=9985,Vx.NEAREST_MIPMAP_LINEAR=9986,Vx.LINEAR_MIPMAP_LINEAR=9987,Vx.TEXTURE_MAG_FILTER=10240,Vx.TEXTURE_MIN_FILTER=10241,Vx.TEXTURE_WRAP_S=10242,Vx.TEXTURE_WRAP_T=10243,Vx.TEXTURE_2D=3553,Vx.TEXTURE=5890,Vx.TEXTURE_CUBE_MAP=34067,Vx.TEXTURE_BINDING_CUBE_MAP=34068,Vx.TEXTURE_CUBE_MAP_POSITIVE_X=34069,Vx.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,Vx.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,Vx.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,Vx.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,Vx.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,Vx.MAX_CUBE_MAP_TEXTURE_SIZE=34076,Vx.TEXTURE0=33984,Vx.TEXTURE1=33985,Vx.TEXTURE2=33986,Vx.TEXTURE3=33987,Vx.TEXTURE4=33988,Vx.TEXTURE5=33989,Vx.TEXTURE6=33990,Vx.TEXTURE7=33991,Vx.TEXTURE8=33992,Vx.TEXTURE9=33993,Vx.TEXTURE10=33994,Vx.TEXTURE11=33995,Vx.TEXTURE12=33996,Vx.TEXTURE13=33997,Vx.TEXTURE14=33998,Vx.TEXTURE15=33999,Vx.TEXTURE16=34e3,Vx.TEXTURE17=34001,Vx.TEXTURE18=34002,Vx.TEXTURE19=34003,Vx.TEXTURE20=34004,Vx.TEXTURE21=34005,Vx.TEXTURE22=34006,Vx.TEXTURE23=34007,Vx.TEXTURE24=34008,Vx.TEXTURE25=34009,Vx.TEXTURE26=34010,Vx.TEXTURE27=34011,Vx.TEXTURE28=34012,Vx.TEXTURE29=34013,Vx.TEXTURE30=34014,Vx.TEXTURE31=34015,Vx.ACTIVE_TEXTURE=34016,Vx.REPEAT=10497,Vx.CLAMP_TO_EDGE=33071,Vx.MIRRORED_REPEAT=33648,Vx.FLOAT_VEC2=35664,Vx.FLOAT_VEC3=35665,Vx.FLOAT_VEC4=35666,Vx.INT_VEC2=35667,Vx.INT_VEC3=35668,Vx.INT_VEC4=35669,Vx.BOOL=35670,Vx.BOOL_VEC2=35671,Vx.BOOL_VEC3=35672,Vx.BOOL_VEC4=35673,Vx.FLOAT_MAT2=35674,Vx.FLOAT_MAT3=35675,Vx.FLOAT_MAT4=35676,Vx.SAMPLER_2D=35678,Vx.SAMPLER_CUBE=35680,Vx.VERTEX_ATTRIB_ARRAY_ENABLED=34338,Vx.VERTEX_ATTRIB_ARRAY_SIZE=34339,Vx.VERTEX_ATTRIB_ARRAY_STRIDE=34340,Vx.VERTEX_ATTRIB_ARRAY_TYPE=34341,Vx.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,Vx.VERTEX_ATTRIB_ARRAY_POINTER=34373,Vx.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,Vx.COMPILE_STATUS=35713,Vx.LOW_FLOAT=36336,Vx.MEDIUM_FLOAT=36337,Vx.HIGH_FLOAT=36338,Vx.LOW_INT=36339,Vx.MEDIUM_INT=36340,Vx.HIGH_INT=36341,Vx.FRAMEBUFFER=36160,Vx.RENDERBUFFER=36161,Vx.RGBA4=32854,Vx.RGB5_A1=32855,Vx.RGB565=36194,Vx.DEPTH_COMPONENT16=33189,Vx.STENCIL_INDEX=6401,Vx.STENCIL_INDEX8=36168,Vx.DEPTH_STENCIL=34041,Vx.RENDERBUFFER_WIDTH=36162,Vx.RENDERBUFFER_HEIGHT=36163,Vx.RENDERBUFFER_INTERNAL_FORMAT=36164,Vx.RENDERBUFFER_RED_SIZE=36176,Vx.RENDERBUFFER_GREEN_SIZE=36177,Vx.RENDERBUFFER_BLUE_SIZE=36178,Vx.RENDERBUFFER_ALPHA_SIZE=36179,Vx.RENDERBUFFER_DEPTH_SIZE=36180,Vx.RENDERBUFFER_STENCIL_SIZE=36181,Vx.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,Vx.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,Vx.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,Vx.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,Vx.COLOR_ATTACHMENT0=36064,Vx.DEPTH_ATTACHMENT=36096,Vx.STENCIL_ATTACHMENT=36128,Vx.DEPTH_STENCIL_ATTACHMENT=33306,Vx.NONE=0,Vx.FRAMEBUFFER_COMPLETE=36053,Vx.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,Vx.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,Vx.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,Vx.FRAMEBUFFER_UNSUPPORTED=36061,Vx.FRAMEBUFFER_BINDING=36006,Vx.RENDERBUFFER_BINDING=36007,Vx.MAX_RENDERBUFFER_SIZE=34024,Vx.INVALID_FRAMEBUFFER_OPERATION=1286,Vx.UNPACK_FLIP_Y_WEBGL=37440,Vx.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,Vx.CONTEXT_LOST_WEBGL=37442,Vx.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,Vx.BROWSER_DEFAULT_WEBGL=37444,Vx._useProgram=null,Vx._depthTest=!0,Vx._depthMask=!0,Vx._blend=!1,Vx._cullFace=!1,Vx.curBindTexTarget=null,Vx.curBindTexValue=null,VQ(Vx,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),Vx}(),VWn=function(Vn){function Va(){Va.__super.call(this)}Vi(Va,"laya.webgl.display.GraphicsGL",VV);var VU=Va.prototype;return VU.setShader=function(Vn){this._saveToCmd(VP.context._setShader,[Vn])},VU.setIBVB=function(Vn,Va,VU,Vx,VD,Vp){this._saveToCmd(VP.context._setIBVB,[Vn,Va,VU,Vx,VD,Vp])},VU.drawParticle=function(Vn,Va,VU){var Vx=VY.createParticleTemplate2D(VU);Vx.x=Vn,Vx.y=Va,this._saveToCmd(VP.context._drawParticle,[Vx])},Va}(),Vkn=function(Vn){var VU;function VF(Vn){this._x=0,this._y=0,this._id=++VF._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,VF.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=VF.MAXCLIPRECT,this.mOutPoint,this._canvas=Vn,this._canvas._addReference(),VF._contextcount++,VP.isFlash?(this._ib=VJn.create(35044),Vbn.fillIBQuadrangle(this._ib,16)):this._ib=VJn.QuadrangleIB,this.clear()}Vi(VF,"laya.webgl.canvas.WebGLContext2D",VD);var Va=VF.prototype;return Va.setIsMainContext=function(){this._isMain=!0},Va.clearBG=function(Vn,Va,VU,Vx){var VD=VKn.mainContext;VD.clearColor(Vn,Va,VU,Vx),VD.clear(16384)},Va._getSubmits=function(){return this._submits},Va._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var Vn=0,Va=this._submits._length;Vn<Va;Vn++)this._submits[Vn].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},Va.destroy=function(){--VF._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=VJn.QuadrangleIB&&this._ib.releaseResource()},Va.clear=function(){this._submits||(this._other=VU.DEFAULT,this._curMat=V_.create(),this._vb=Ven.create(-1),this._submits=[],this._save=[Vs.Create(this)],this._save.length=10,this._shader2D=new VJ,this._triangleMesh=Vvn.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=VU.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=VF.MAXCLIPRECT,this._curSubmit=Vpn.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=VO.DEFAULT;for(var Vn=0,Va=this._submits._length;Vn<Va;Vn++)this._submits[Vn].releaseRender(),this._submits[Vn]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},Va.size=function(Vn,Va){if(this._width!=Vn||this._height!=Va)if(0==Vn||0==Va){0!=this._vb._byteLength&&(this._width=Vn,this._height=Va,this._vb.clear(),this._vb.upload());for(var VU=0,Vx=this._submits._length;VU<Vx;VU++)this._submits[VU].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=Vn,this._height=Va,this._targets&&this._targets.size(Vn,Va),this._canvas.memorySize-=this._canvas.memorySize;0===Vn&&0===Va&&this._releaseMem()},Va._getTransformMatrix=function(){return this._curMat},Va.translate=function(Vn,Va){0===Vn&&0===Va||(Vt.save(this),this._curMat.bTransform&&(VC.save(this),this._curMat.transformPointN(V$.TEMP.setTo(Vn,Va)),Vn=V$.TEMP.x,Va=V$.TEMP.y),this._x+=Vn,this._y+=Va)},Va.save=function(){this._save[this._save._length++]=Vs.Create(this)},Va.restore=function(){var Vn=this._save._length;if(!(Vn<1))for(var Va=Vn-1;0<=Va;Va--){var VU=this._save[Va];if(VU.restore(this),VU.isSaveMark())return void(this._save._length=Va)}},Va._fillText=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){void 0===VR&&(VR=0);var VX=this._shader2D,Vz=this._curSubmit.shaderValue,Vi=VD?VEn.create(VD):this._other.font;if(Vg.enabled)VX.ALPHA!==Vz.ALPHA&&(VX.glTexture=null),Vqn.drawText(this,Vn,Va,this._curMat,Vi,Vy||this._other.textAlign,Vp,VQ,VV,VU,Vx,VR);else{this._shader2D.defines.getValue();var Vq=Vp?VE.create(Vp)._color:VX.colorAdd;VX.ALPHA===Vz.ALPHA&&Vq===VX.colorAdd&&Vz.colorAdd===VX.colorAdd||(VX.glTexture=null,VX.colorAdd=Vq),Vqn.drawText(this,Vn,Va,this._curMat,Vi,Vy||this._other.textAlign,Vp,VQ,VV,VU,Vx,VR)}},Va.fillWords=function(Vn,Va,VU,Vx,VD,Vp){this._fillText(null,Vn,Va,VU,Vx,VD,null,-1,null,Vp)},Va.fillBorderWords=function(Vn,Va,VU,Vx,VD,Vp,VQ){this._fillBorderText(null,Vn,Va,VU,Vx,VD,Vp,VQ,null)},Va.fillText=function(Vn,Va,VU,Vx,VD,Vp){this._fillText(Vn,null,Va,VU,Vx,VD,null,-1,Vp)},Va.strokeText=function(Vn,Va,VU,Vx,VD,Vp,VQ){this._fillText(Vn,null,Va,VU,Vx,null,VD,Vp||1,VQ)},Va.fillBorderText=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){this._fillBorderText(Vn,null,Va,VU,Vx,VD,Vp,VQ,VV)},Va._fillBorderText=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){if(!Vg.enabled)return this._fillText(Vn,Va,VU,Vx,VD,null,VQ,VV||1,Vy),void this._fillText(Vn,Va,VU,Vx,VD,Vp,null,-1,Vy);var VR=this._shader2D,VX=this._curSubmit.shaderValue;VR.ALPHA!==VX.ALPHA&&(VR.glTexture=null);var Vz=VD?(VF._fontTemp.setFont(VD),VF._fontTemp):this._other.font;Vqn.drawText(this,Vn,Va,this._curMat,Vz,Vy||this._other.textAlign,Vp,VQ,VV||1,VU,Vx,0)},Va.fillRect=function(Vn,Va,VU,Vx,VD){var Vp=this._vb;if(Vbn.fillRectImgVb(Vp,this._clipRect,Vn,Va,VU,Vx,Vv.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var VQ=this._shader2D.fillStyle;VD&&(this._shader2D.fillStyle=VO.create(VD));var VV=this._shader2D,Vy=this._curSubmit.shaderValue;if(VV.fillStyle!==Vy.fillStyle||VV.ALPHA!==Vy.ALPHA){VV.glTexture=null;var VR=this._curSubmit=Vpn.createSubmit(this,this._ib,Vp,(Vp._byteLength-64)/32*3,VNn.create(2,0));VR.shaderValue.color=VV.fillStyle._color._color,VR.shaderValue.ALPHA=VV.ALPHA,this._submits[this._submits._length++]=VR}this._curSubmit._numEle+=6,this._shader2D.fillStyle=VQ}},Va.fillTexture=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){if(Vn.loaded&&Vn.bitmap&&Vn.source){var Vy=this._vb,VR=Vn.bitmap.width,VX=Vn.bitmap.height,Vz=Vn.uv,Vi=VQ.x%Vn.width,Vq=VQ.y%Vn.height;if(VR!=VV.w||VX!=VV.h){if(!VV.w&&!VV.h)switch(VV.oy=VV.ox=0,Vp){case"repeat":VV.width=Vx,VV.height=VD;break;case"repeat-x":VV.width=Vx,Vq<0?Vn.height+Vq>VD?VV.height=VD:VV.height=Vn.height+Vq:(VV.oy=Vq,Vn.height+Vq>VD?VV.height=VD-Vq:VV.height=Vn.height);break;case"repeat-y":Vi<0?Vn.width+Vi>Vx?VV.width=Vx:VV.width=Vn.width+Vi:(VV.ox=Vi,Vn.width+Vi>Vx?VV.width=Vx-Vi:VV.width=Vn.width),VV.height=VD;break;case"no-repeat":Vi<0?Vn.width+Vi>Vx?VV.width=Vx:VV.width=Vn.width+Vi:(VV.ox=Vi,Vn.width+Vi>Vx?VV.width=Vx-Vi:VV.width=Vn.width),Vq<0?Vn.height+Vq>VD?VV.height=VD:VV.height=Vn.height+Vq:(VV.oy=Vq,Vn.height+Vq>VD?VV.height=VD-Vq:VV.height=Vn.height);break;default:VV.width=Vx,VV.height=VD}VV.w=VR,VV.h=VX,VV.uv=[0,0,VV.width/VR,0,VV.width/VR,VV.height/VX,0,VV.height/VX]}if(Va+=VV.ox,VU+=VV.oy,Vi-=VV.ox,Vq-=VV.oy,Vbn.fillRectImgVb(Vy,this._clipRect,Va,VU,VV.width,VV.height,VV.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var VE=VIn.create(this,this._ib,Vy,(Vy._byteLength-64)/32*3,VNn.create(256,0)),Vm=(this._submits[this._submits._length++]=VE).shaderValue;Vm.textureHost=Vn;var Vb=Vz[0]*VR,VP=Vz[1]*VX,VA=(Vz[2]-Vz[0])*VR,VT=(Vz[5]-Vz[3])*VX,VK=-Vi/VR,VY=-Vq/VX;Vm.u_TexRange[0]=Vb/VR,Vm.u_TexRange[1]=VA/VR,Vm.u_TexRange[2]=VP/VX,Vm.u_TexRange[3]=VT/VX,Vm.u_offset[0]=VK,Vm.u_offset[1]=VY,Vg.enabled&&!this._isMain&&VE.addTexture(Vn,(Vy._byteLength>>2)-16),(this._curSubmit=VE)._renderType=10017,VE._numEle+=6}}else this.sprite&&VW.timer.callLater(this,this._repaintSprite)},Va.setShader=function(Vn){Vd.save(this,1048576,this._shader2D,!0),this._shader2D.shader=Vn},Va.setFilters=function(Vn){Vd.save(this,2097152,this._shader2D,!0),this._shader2D.filters=Vn,this._curSubmit=Vpn.RENDERBASE,this._renderKey=0,this._drawCount++},Va.drawTexture=function(Vn,Va,VU,Vx,VD,Vp,VQ){this._drawTextureM(Vn,Va,VU,Vx,VD,Vp,VQ,null,1)},Va.addTextureVb=function(Vn,Va,VU){var Vx=this._curSubmit._vb||this._vb,VD=Vx._byteLength>>2;Vx.byteLength=VD+16<<2;for(var Vp=Vx.getFloat32Array(),VQ=0;VQ<16;VQ+=4)Vp[VD++]=Vn[VQ]+Va,Vp[VD++]=Vn[VQ+1]+VU,Vp[VD++]=Vn[VQ+2],Vp[VD++]=Vn[VQ+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),Vx._upload=!0},Va.willDrawTexture=function(Vn,Va){if(!(Vn.loaded&&Vn.bitmap&&Vn.source))return this.sprite&&VW.timer.callLater(this,this._repaintSprite),0;var VU=Vn.bitmap,Vx=VU.id+this._shader2D.ALPHA*Va+10016;if(Vx==this._renderKey)return Vx;var VD=this._shader2D,Vp=VD.ALPHA,VQ=this._curSubmit.shaderValue;VD.ALPHA*=Va,this._renderKey=Vx,this._drawCount++,VD.glTexture=VU;var VV=this._vb,Vy=null,VR=VV._byteLength/32*3,VX=VQ.textureHost&&VQ.textureHost==Vn&&VQ.textureHost.alphaTexture==Vn.alphaTexture;return Vy=VIn.create(this,this._ib,VV,VR,VNn.create(1,0)),(this._submits[this._submits._length++]=Vy).shaderValue.textureHost=Vn,Vy._renderType=10016,Vy._preIsSameTextureShader=10016===this._curSubmit._renderType&&VD.ALPHA===VQ.ALPHA&&VX,this._curSubmit=Vy,VD.ALPHA=Vp,Vx},Va.drawTextures=function(Vn,Va,VU,Vx){if(Vn.loaded&&Vn.bitmap&&Vn.source){var VD=this._clipRect;if(this._clipRect=VF.MAXCLIPRECT,this._drawTextureM(Vn,Va[0],Va[1],Vn.width,Vn.height,VU,Vx,null,1)){if(this._clipRect=VD,Vc.drawCall++,!(Va.length<4)){for(var Vp=this._curSubmit._vb||this._vb,VQ=this._curMat.a,VV=this._curMat.d,Vy=2,VR=Va.length;Vy<VR;Vy+=2)Vbn.copyPreImgVb(Vp,(Va[Vy]-Va[Vy-2])*VQ,(Va[Vy+1]-Va[Vy-1])*VV),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&VW.timer.callLater(this,this._repaintSprite)},Va._drawTextureM=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){if(!Vn.loaded||!Vn.source)return this.sprite&&VW.timer.callLater(this,this._repaintSprite),!1;var VR=this._curSubmit._vb||this._vb,VX=Vn.bitmap;Va+=Vp,VU+=VQ,this._drawCount++;var Vz=VX.id+this._shader2D.ALPHA*Vy+10016;if(Vz!=this._renderKey){this._renderKey=Vz;var Vi=this._curSubmit.shaderValue,Vq=this._shader2D,VE=Vq.ALPHA;Vq.ALPHA*=Vy,Vq.glTexture=VX;var Vm=this._vb,Vb=null,VP=Vm._byteLength/32*3,VA=Vi.textureHost&&Vi.textureHost==Vn&&Vi.textureHost.alphaTexture==Vn.alphaTexture;Vb=VIn.create(this,this._ib,Vm,VP,VNn.create(1,0)),(this._submits[this._submits._length++]=Vb).shaderValue.textureHost=Vn,Vb._renderType=10016,Vb._preIsSameTextureShader=10016===this._curSubmit._renderType&&Vq.ALPHA===Vi.ALPHA&&VA,this._curSubmit=Vb,VR=this._curSubmit._vb||this._vb,Vq.ALPHA=VE}return!!Vbn.fillRectImgVb(VR,this._clipRect,Va,VU,Vx||Vn.width,VD||Vn.height,Vn.uv,VV||this._curMat,this._x,this._y,0,0)&&(Vg.enabled&&!this._isMain&&this._curSubmit.addTexture(Vn,(VR._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},Va._repaintSprite=function(){this.sprite&&this.sprite.repaint()},Va._drawText=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){var VX=Vn.bitmap;this._drawCount++;var Vz=VX.id+this._shader2D.ALPHA+10016;if(Vz!=this._renderKey){this._renderKey=Vz;var Vi=this._curSubmit.shaderValue,Vq=this._shader2D;Vq.glTexture=VX;var VE=this._vb,Vm=null,Vb=VE._byteLength/32*3,VP=Vi.textureHost&&Vi.textureHost==Vn&&Vi.textureHost.alphaTexture==Vn.alphaTexture;(Vm=Vg.enabled?VIn.create(this,this._ib,VE,Vb,VNn.create(1,0)):VIn.create(this,this._ib,VE,Vb,Vtn.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&Vq.ALPHA===Vi.ALPHA&&VP,(this._submits[this._submits._length++]=Vm).shaderValue.textureHost=Vn,Vm._renderType=10016,this._curSubmit=Vm}Vn.active();var VA=this._curSubmit._vb||this._vb;Vbn.fillRectImgVb(VA,this._clipRect,Va+VQ,VU+VV,Vx||Vn.width,VD||Vn.height,Vn.uv,Vp||this._curMat,this._x,this._y,Vy,VR,!0)&&(Vg.enabled&&!this._isMain&&this._curSubmit.addTexture(Vn,(VA._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},Va.drawTextureWithTransform=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){if(Vp){var VR=this._curMat,VX=this._x,Vz=this._y;(0!==VQ||0!==VV)&&(this._x=VQ*VR.a+VV*VR.c,this._y=VV*VR.d+VQ*VR.b),Vp&&VR.bTransform?(V_.mul(Vp,VR,VF._tmpMatrix),(Vp=VF._tmpMatrix)._checkTransform()):(this._x+=VR.tx,this._y+=VR.ty),this._drawTextureM(Vn,Va,VU,Vx,VD,0,0,Vp,Vy),this._x=VX,this._y=Vz}else this._drawTextureM(Vn,Va,VU,Vx,VD,VQ,VV,null,Vy)},Va.fillQuadrangle=function(Vn,Va,VU,Vx,VD){var Vp=this._curSubmit,VQ=this._vb,VV=this._shader2D,Vy=Vp.shaderValue;if(this._renderKey=0,Vn.bitmap){var VR=Vn.bitmap;VV.glTexture==VR&&VV.ALPHA===Vy.ALPHA||(VV.glTexture=VR,(Vp=this._curSubmit=Vpn.createSubmit(this,this._ib,VQ,VQ._byteLength/32*3,VNn.create(1,0))).shaderValue.glTexture=VR,this._submits[this._submits._length++]=Vp),Vbn.fillQuadrangleImgVb(VQ,Va,VU,Vx,Vn.uv,VD||this._curMat,this._x,this._y)}else Vp.shaderValue.fillStyle&&Vp.shaderValue.fillStyle.equal(Vn)&&VV.ALPHA===Vy.ALPHA||(VV.glTexture=null,(Vp=this._curSubmit=Vpn.createSubmit(this,this._ib,VQ,VQ._byteLength/32*3,VNn.create(2,0))).shaderValue.defines.add(2),Vp.shaderValue.fillStyle=VO.create(Vn),this._submits[this._submits._length++]=Vp),Vbn.fillQuadrangleImgVb(VQ,Va,VU,Vx,Vv.DEF_UV,VD||this._curMat,this._x,this._y);Vp._numEle+=6},Va.drawTexture2=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){if(0!=Vp){var Vy=this._curMat;if(this._x=Vn*Vy.a+Va*Vy.c,this._y=Va*Vy.d+Vn*Vy.b,VD&&(VD=Vy.bTransform||VD.bTransform?(V_.mul(VD,Vy,VF._tmpMatrix),VF._tmpMatrix):(this._x+=VD.tx+Vy.tx,this._y+=VD.ty+Vy.ty,V_.EMPTY)),1!==Vp||VQ){var VR=this._shader2D.ALPHA,VX=this._nBlendType;this._shader2D.ALPHA=Vp,VQ&&(this._nBlendType=VB.TOINT(VQ)),this._drawTextureM(VV[0],VV[1]-VU,VV[2]-Vx,VV[3],VV[4],0,0,VD,1),this._shader2D.ALPHA=VR,this._nBlendType=VX}else this._drawTextureM(VV[0],VV[1]-VU,VV[2]-Vx,VV[3],VV[4],0,0,VD,1);this._x=this._y=0}},Va.drawCanvas=function(Vn,Va,VU,Vx,VD){var Vp=Vn.context;if(this._renderKey=0,Vp._targets)this._submits[this._submits._length++]=VGn.create(Vp,0,null),this._curSubmit=Vpn.RENDERBASE,Vp._targets.drawTo(this,Va,VU,Vx,VD);else{var VQ=this._submits[this._submits._length++]=VGn.create(Vp,this._shader2D.ALPHA,this._shader2D.filters),VV=Vx/Vn.width,Vy=VD/Vn.height,VR=VQ._matrix;this._curMat.copyTo(VR),1!=VV&&1!=Vy&&VR.scale(VV,Vy);var VX=VR.tx,Vz=VR.ty;VR.tx=VR.ty=0,VR.transformPoint(V$.TEMP.setTo(Va,VU)),VR.translate(V$.TEMP.x+VX,V$.TEMP.y+Vz),this._curSubmit=Vpn.RENDERBASE}Vk.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=Vp._targets?"yellow":"green",this.strokeRect(Va-1,VU-1,Vx+2,VD+2,1),this.strokeRect(Va,VU,Vx,VD,1),this.restore())},Va.drawTarget=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){void 0===VR&&(VR=-1);var VX=this._vb;if(Vbn.fillRectImgVb(VX,this._clipRect,Va,VU,Vx,VD,Vy||Vv.DEF_UV,Vp||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var Vz=this._curSubmit=Vzn.create(this,this._ib,VX,(VX._byteLength-64)/32*3,VV,VQ);Vz.blendType=-1==VR?this._nBlendType:VR,Vz.scope=Vn,this._submits[this._submits._length++]=Vz,this._curSubmit._numEle+=6}},Va.mixRGBandAlpha=function(Vn){return this._mixRGBandAlpha(Vn,this._shader2D.ALPHA)},Va._mixRGBandAlpha=function(Vn,Va){var VU=(4278190080&Vn)>>>24;return 0!=VU?VU*=Va:VU=255*Va,16777215&Vn|VU<<24},Va.drawTriangles=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){if(!Vn.loaded||!Vn.source)return this.sprite&&VW.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;Vn.bitmap;var VX=this._mixRGBandAlpha(4294967295,VV),Vz=(Vx.length,Vp.length);this._renderKey=-1;var Vi=this._curSubmit=VIn.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,VNn.create(1,0));return Vi.shaderValue.textureHost=Vn,Vi._renderType=10016,this._submits[this._submits._length++]=Vi,VQ?(VF._tmpMatrix.a=VQ.a,VF._tmpMatrix.b=VQ.b,VF._tmpMatrix.c=VQ.c,VF._tmpMatrix.d=VQ.d,VF._tmpMatrix.tx=VQ.tx+Va,VF._tmpMatrix.ty=VQ.ty+VU,V_.mul(VF._tmpMatrix,this._curMat,VF._tmpMatrix)):(VF._tmpMatrix.a=this._curMat.a,VF._tmpMatrix.b=this._curMat.b,VF._tmpMatrix.c=this._curMat.c,VF._tmpMatrix.d=this._curMat.d,VF._tmpMatrix.tx=this._curMat.tx+Va,VF._tmpMatrix.ty=this._curMat.ty+VU),this._triangleMesh.addData(Vx,VD,Vp,VF._tmpMatrix,VX,this),this._curSubmit._numEle+=Vz,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},Va.transform=function(Vn,Va,VU,Vx,VD,Vp){VC.save(this),V_.mul(V_.TEMP.setTo(Vn,Va,VU,Vx,VD,Vp),this._curMat,this._curMat),this._curMat._checkTransform()},Va.setTransformByMatrix=function(Vn){Vn.copyTo(this._curMat)},Va.transformByMatrix=function(Vn){VC.save(this),V_.mul(Vn,this._curMat,this._curMat),this._curMat._checkTransform()},Va.rotate=function(Vn){VC.save(this),this._curMat.rotateEx(Vn)},Va.scale=function(Vn,Va){VC.save(this),this._curMat.scaleEx(Vn,Va)},Va.clipRect=function(Vn,Va,VU,Vx){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var VD=VXn.create(4);this.addRenderObject(VD);var Vp=this._vb,VQ=Vp._byteLength>>2;if(Vbn.fillRectImgVb(Vp,null,Vn,Va,VU,Vx,Vv.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var VV=this._curSubmit=Vpn.createSubmit(this,this._ib,Vp,(Vp._byteLength-64)/32*3,VNn.create(2,0));VV.shaderValue.ALPHA=1,this._submits[this._submits._length++]=VV,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var Vy=VXn.create(5);this.addRenderObject(Vy);var VR=Vp.getFloat32Array(),VX=Math.min(Math.min(Math.min(VR[0+VQ],VR[4+VQ]),VR[8+VQ]),VR[12+VQ]),Vz=Math.max(Math.max(Math.max(VR[0+VQ],VR[4+VQ]),VR[8+VQ]),VR[12+VQ]),Vi=Math.min(Math.min(Math.min(VR[1+VQ],VR[5+VQ]),VR[9+VQ]),VR[13+VQ]),Vq=Math.max(Math.max(Math.max(VR[1+VQ],VR[5+VQ]),VR[9+VQ]),VR[13+VQ]);Vw.save(this,Vy,Vn,Va,VU,Vx,VX,Vi,Vz-VX,Vq-Vi),this._curSubmit=Vpn.RENDERBASE}else{VU*=this._curMat.a,Vx*=this._curMat.d;var VE=V$.TEMP;this._curMat.transformPoint(VE.setTo(Vn,Va)),VU<0&&(VE.x=VE.x+VU,VU=-VU),Vx<0&&(VE.y=VE.y+Vx,Vx=-Vx),this._renderKey=0;var Vm=this._curSubmit=VRn.create(this);(this._submits[this._submits._length++]=Vm).submitIndex=this._submits._length,Vm.submitLength=9999999,VS.save(this,Vm);var Vb=this._clipRect,VP=Vb.x,VA=Vb.y,VT=VE.x+VU,VK=VE.y+Vx;VP<VE.x&&(Vb.x=VE.x),VA<VE.y&&(Vb.y=VE.y),Vb.width=Math.min(VT,VP+Vb.width)-Vb.x,Vb.height=Math.min(VK,VA+Vb.height)-Vb.y,this._shader2D.glTexture=null,Vm.clipRect.copyFrom(Vb),this._curSubmit=Vpn.RENDERBASE}},Va.setIBVB=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX){if(void 0===Vy&&(Vy=0),void 0===VR&&(VR=0),void 0===VX&&(VX=0),null===VU){if(VP.isFlash){var Vz=Vx;Vz._selfIB||(Vz._selfIB=VJn.create(35044)),Vz._selfIB.clear(),VU=Vz._selfIB}else VU=this._ib;Vbn.expandIBQuadrangle(VU,Vx._byteLength/(4*Vx.vertexStride*4))}if(!VV||!VQ)throw Error("setIBVB must input:shader shaderValues");var Vi=Vyn.create(this,Vx,VU,VD,VQ,VV,Vy,VR,VX);Vp||(Vp=V_.EMPTY),Vp.translate(Vn,Va),V_.mul(Vp,this._curMat,Vi._mat),Vp.translate(-Vn,-Va),this._submits[this._submits._length++]=Vi,this._curSubmit=Vpn.RENDERBASE,this._renderKey=0},Va.addRenderObject=function(Vn){this._submits[this._submits._length++]=Vn},Va.fillTrangles=function(Vn,Va,VU,Vx,VD){var Vp=this._curSubmit,VQ=this._vb,VV=this._shader2D,Vy=Vp.shaderValue,VR=Vx.length>>4,VX=Vn.bitmap;this._renderKey=0,VV.glTexture==VX&&VV.ALPHA===Vy.ALPHA||((Vp=this._curSubmit=Vpn.createSubmit(this,this._ib,VQ,VQ._byteLength/32*3,VNn.create(1,0))).shaderValue.textureHost=Vn,this._submits[this._submits._length++]=Vp),Vbn.fillTranglesVB(VQ,Va,VU,Vx,VD||this._curMat,this._x,this._y),Vp._numEle+=6*VR},Va.submitElement=function(Vn,Va){var VU=this._submits;for(Va<0&&(Va=VU._length);Vn<Va;)Vn+=VU[Vn].renderSubmit()},Va.finish=function(){VKn.mainContext.finish()},Va.flush=function(){var Vn=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(Vn>this._ib.bufferLength/12&&Vbn.expandIBQuadrangle(this._ib,Vn),!this._isMain&&Vg.enabled&&Vg._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=Vg._atlasRestore;for(var Va=this._submits,VU=0,Vx=Va._length;VU<Vx;VU++){var VD=Va[VU];10016===VD.getRenderType()&&VD.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),Van.instance&&Van.getInstance().reset();var Vp;for(VU=0,Vp=this.meshlist.length;VU<Vp;VU++){var VQ=this.meshlist[VU];VQ.canReuse?VQ.releaseMesh():VQ.destroy()}return this.meshlist.length=0,this._curSubmit=Vpn.RENDERBASE,this._renderKey=0,this._triangleMesh=Vvn.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},Va.setPathId=function(Vn){if(this.mId=Vn,-1!=this.mId){this.mHaveKey=!1;var Va=Vj.getInstance();Va.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,Va.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},Va.movePath=function(Vn,Va){var VU=Vn,Vx=Va;Vn=this._curMat.a*VU+this._curMat.c*Vx+this._curMat.tx,Va=this._curMat.b*VU+this._curMat.d*Vx+this._curMat.ty,this.mX+=Vn,this.mY+=Va},Va.beginPath=function(){var Vn=this._getPath();Vn.tempArray.length=0,Vn.closePath=!1,this.mX=0,this.mY=0},Va.closePath=function(){this._path.closePath=!0},Va.fill=function(Vn){void 0===Vn&&(Vn=!1);var Va=this._getPath();this.drawPoly(0,0,Va.tempArray,this.fillStyle._color.numColor,0,0,Vn)},Va.stroke=function(){var Vn=this._getPath();if(0<this.lineWidth){if(-1==this.mId)Vn.drawLine(0,0,Vn.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var Va=Vj.getInstance().shapeLineDic[this.mId];Va.rebuild(Vn.tempArray),Vn.setGeomtry(Va)}else Vj.getInstance().addLine(this.mId,Vn.drawLine(0,0,Vn.tempArray,this.lineWidth,this.strokeStyle._color.numColor));Vn.update();var VU=[this.mX,this.mY],Vx=Vpn.createShape(this,Vn.ib,Vn.vb,Vn.count,Vn.offset,VNn.create(4,0));Vx.shaderValue.ALPHA=this._shader2D.ALPHA,Vx.shaderValue.u_pos=VU,Vx.shaderValue.u_mmat2=VAn.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=Vx,this._renderKey=-1}},Va.line=function(Vn,Va,VU,Vx,VD,Vp){var VQ=this._curSubmit,VV=this._vb;if(Vbn.fillLineVb(VV,this._clipRect,Vn,Va,VU,Vx,VD,Vp)){this._renderKey=0;var Vy=this._shader2D,VR=VQ.shaderValue;Vy.strokeStyle===VR.strokeStyle&&Vy.ALPHA===VR.ALPHA||(Vy.glTexture=null,(VQ=this._curSubmit=Vpn.createSubmit(this,this._ib,VV,(VV._byteLength-64)/32*3,VNn.create(2,0))).shaderValue.strokeStyle=Vy.strokeStyle,VQ.shaderValue.mainID=2,VQ.shaderValue.ALPHA=Vy.ALPHA,this._submits[this._submits._length++]=VQ),VQ._numEle+=6}},Va.moveTo=function(Vn,Va,VU){void 0===VU&&(VU=!0);var Vx=this._getPath();if(VU){var VD=Vn,Vp=Va;Vn=this._curMat.a*VD+this._curMat.c*Vp,Va=this._curMat.b*VD+this._curMat.d*Vp}Vx.addPoint(Vn,Va)},Va.lineTo=function(Vn,Va,VU){void 0===VU&&(VU=!0);var Vx=this._getPath();if(VU){var VD=Vn,Vp=Va;Vn=this._curMat.a*VD+this._curMat.c*Vp,Va=this._curMat.b*VD+this._curMat.d*Vp}Vx.addPoint(Vn,Va)},Va.drawCurves=function(Vn,Va,VU){this.setPathId(-1),this.beginPath(),this.strokeStyle=VU[3],this.lineWidth=VU[4];var Vx=VU[2];Vn+=VU[0],Va+=VU[1],this.movePath(Vn,Va),this.moveTo(Vx[0],Vx[1]);for(var VD=2,Vp=Vx.length;VD<Vp;)this.quadraticCurveTo(Vx[VD++],Vx[VD++],Vx[VD++],Vx[VD++]);this.stroke()},Va.arcTo=function(Vn,Va,VU,Vx,VD){if(-1==this.mId||!this.mHaveKey){var Vp=0,VQ=0,VV=0,Vy=this._getPath();this._curMat.copyTo(VF._tmpMatrix),VF._tmpMatrix.tx=VF._tmpMatrix.ty=0,VF._tempPoint.setTo(Vy.getEndPointX(),Vy.getEndPointY()),VF._tmpMatrix.invertTransformPoint(VF._tempPoint);var VR=VF._tempPoint.x-Vn,VX=VF._tempPoint.y-Va,Vz=Math.sqrt(VR*VR+VX*VX);if(!(Vz<=1e-6)){var Vi=VR/Vz,Vq=VX/Vz,VE=VU-Vn,Vm=Vx-Va,Vb=VE*VE+Vm*Vm,VP=Math.sqrt(Vb);if(!(VP<=1e-6)){var VA=VE/VP,VT=Vm/VP,VK=Vi+VA,VY=Vq+VT,VW=Math.sqrt(VK*VK+VY*VY);if(!(VW<=1e-6)){var Vk=VK/VW,VN=VY/VW,V_=Math.acos(Vk*Vi+VN*Vq),V$=Math.PI/2-V_,VM=(Vz=VD/Math.tan(V$))*Vi+Vn,VZ=Vz*Vq+Va,Vu=Math.sqrt(Vz*Vz+VD*VD),Vc=Vn+Vk*Vu,VH=Va+VN*Vu,VG=0,VI=0;if(0<=Vi*VT-Vq*VA){var Vv=2*V$/VF.SEGNUM;VG=Math.sin(Vv),VI=Math.cos(Vv)}else Vv=2*-V$/VF.SEGNUM,VG=Math.sin(Vv),VI=Math.cos(Vv);VQ=this._curMat.a*VM+this._curMat.c*VZ,VV=this._curMat.b*VM+this._curMat.d*VZ,VQ==this._path.getEndPointX()&&VV==this._path.getEndPointY()||Vy.addPoint(VQ,VV);var Vl=VM-Vc,Vj=VZ-VH;for(Vp=0;Vp<VF.SEGNUM;Vp++){var Vh=Vl*VI+Vj*VG,Vf=-Vl*VG+Vj*VI;VQ=Vh+Vc,VV=Vf+VH,Vn=this._curMat.a*VQ+this._curMat.c*VV,VV=Va=this._curMat.b*VQ+this._curMat.d*VV,(VQ=Vn)==this._path.getEndPointX()&&VV==this._path.getEndPointY()||Vy.addPoint(VQ,VV),Vl=Vh,Vj=Vf}}}}}},Va.arc=function(Vn,Va,VU,Vx,VD,Vp,VQ){if(void 0===Vp&&(Vp=!1),void 0===VQ&&(VQ=!0),-1!=this.mId){var VV=Vj.getInstance().shapeDic[this.mId];if(VV&&this.mHaveKey&&!VV.needUpdate(this._curMat))return;Va=Vn=0}var Vy,VR=0,VX=0,Vz=0,Vi=0,Vq=0,VE=0,Vm=0;if(VX=VD-Vx,Vp)if(Math.abs(VX)>=2*Math.PI)VX=2*-Math.PI;else for(;0<VX;)VX-=2*Math.PI;else if(Math.abs(VX)>=2*Math.PI)VX=2*Math.PI;else for(;VX<0;)VX+=2*Math.PI;Vy=VX/(Vm=VU<101?Math.max(10,VX*VU/5):VU<201?Math.max(10,VX*VU/20):Math.max(10,VX*VU/40))/2,Vz=Math.abs(4/3*(1-Math.cos(Vy))/Math.sin(Vy)),Vp&&(Vz=-Vz);var Vb=this._getPath(),VP=NaN,VA=NaN;for(VE=0;VE<=Vm;VE++)VR=Vx+VX*(VE/Vm),Vi=Vn+Math.cos(VR)*VU,Vq=Va+Math.sin(VR)*VU,VQ&&(VP=Vi,VA=Vq,Vi=this._curMat.a*VP+this._curMat.c*VA,Vq=this._curMat.b*VP+this._curMat.d*VA),Vi==this._path.getEndPointX()&&Vq==this._path.getEndPointY()||Vb.addPoint(Vi,Vq);Vi=Vn+Math.cos(VD)*VU,Vq=Va+Math.sin(VD)*VU,VQ&&(VP=Vi,VA=Vq,Vi=this._curMat.a*VP+this._curMat.c*VA,Vq=this._curMat.b*VP+this._curMat.d*VA),Vi==this._path.getEndPointX()&&Vq==this._path.getEndPointY()||Vb.addPoint(Vi,Vq)},Va.quadraticCurveTo=function(Vn,Va,VU,Vx){var VD=Vz.I,Vp=VU,VQ=Vx;VU=this._curMat.a*Vp+this._curMat.c*VQ,Vx=this._curMat.b*Vp+this._curMat.d*VQ,Vp=Vn,VQ=Va,Vn=this._curMat.a*Vp+this._curMat.c*VQ,Va=this._curMat.b*Vp+this._curMat.d*VQ;for(var VV=VD.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),Vn,Va,VU,Vx],30,2),Vy=0,VR=VV.length/2;Vy<VR;Vy++)this.lineTo(VV[2*Vy],VV[2*Vy+1],!1);this.lineTo(VU,Vx,!1)},Va.rect=function(Vn,Va,VU,Vx){this._other=this._other.make(),this._other.path||(this._other.path=new VL),this._other.path.rect(Vn,Va,VU,Vx)},Va.strokeRect=function(Vn,Va,VU,Vx,VD){var Vp=.5*VD;this.line(Vn-Vp,Va,Vn+VU+Vp,Va,VD,this._curMat),this.line(Vn+VU,Va,Vn+VU,Va+Vx,VD,this._curMat),this.line(Vn,Va,Vn,Va+Vx,VD,this._curMat),this.line(Vn-Vp,Va+Vx,Vn+VU+Vp,Va+Vx,VD,this._curMat)},Va.clip=function(){},Va.drawPoly=function(Vn,Va,VU,Vx,VD,Vp,VQ){void 0===VQ&&(VQ=!1),this._renderKey=0,this._shader2D.glTexture=null;var VV=this._getPath();if(-1==this.mId)VV.polygon(Vn,Va,VU,Vx,VD||1,Vp);else if(this.mHaveKey){var Vy=Vj.getInstance().shapeDic[this.mId];Vy.setMatrix(this._curMat),Vy.rebuild(VV.tempArray),VV.setGeomtry(Vy)}else{var VR=VV.polygon(Vn,Va,VU,Vx,VD||1,Vp);Vj.getInstance().addShape(this.mId,VR),VR.setMatrix(this._curMat)}VV.update();var VX,Vz=[this.mX,this.mY];if((VX=Vpn.createShape(this,VV.ib,VV.vb,VV.count,VV.offset,VNn.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,VX.shaderValue.u_pos=Vz,VX.shaderValue.u_mmat2=VAn.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=VX,0<VD){if(this.mHaveLineKey){var Vi=Vj.getInstance().shapeLineDic[this.mId];Vi.rebuild(VV.tempArray),VV.setGeomtry(Vi)}else Vj.getInstance().addShape(this.mId,VV.drawLine(Vn,Va,VU,VD,Vp));VV.update(),(VX=Vpn.createShape(this,VV.ib,VV.vb,VV.count,VV.offset,VNn.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,VX.shaderValue.u_mmat2=VAn.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=VX}},Va.drawParticle=function(Vn,Va,VU){VU.x=Vn,VU.y=Va,this._submits[this._submits._length++]=VU},Va._getPath=function(){return this._path||(this._path=new VL)},Vx(0,Va,"globalCompositeOperation",function(){return VB.NAMES[this._nBlendType]},function(Vn){var Va=VB.TOINT[Vn];null==Va||this._nBlendType===Va||(Vd.save(this,65536,this,!0),this._curSubmit=Vpn.RENDERBASE,this._renderKey=0,this._nBlendType=Va)}),Vx(0,Va,"strokeStyle",function(){return this._shader2D.strokeStyle},function(Vn){this._shader2D.strokeStyle.equal(Vn)||(Vd.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=VO.create(Vn))}),Vx(0,Va,"globalAlpha",function(){return this._shader2D.ALPHA},function(Vn){(Vn=Math.floor(1e3*Vn)/1e3)!=this._shader2D.ALPHA&&(Vd.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=Vn)}),Vx(0,Va,"asBitmap",null,function(Vn){if(Vn){if(this._targets||(this._targets=new Vr),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),Vx(0,Va,"fillStyle",function(){return this._shader2D.fillStyle},function(Vn){this._shader2D.fillStyle.equal(Vn)||(Vd.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=VO.create(Vn))}),Vx(0,Va,"textAlign",function(){return this._other.textAlign},function(Vn){this._other.textAlign===Vn||(this._other=this._other.make(),Vd.save(this,32768,this._other,!1),this._other.textAlign=Vn)}),Vx(0,Va,"lineWidth",function(){return this._other.lineWidth},function(Vn){this._other.lineWidth===Vn||(this._other=this._other.make(),Vd.save(this,256,this._other,!1),this._other.lineWidth=Vn)}),Vx(0,Va,"textBaseline",function(){return this._other.textBaseline},function(Vn){this._other.textBaseline===Vn||(this._other=this._other.make(),Vd.save(this,16384,this._other,!1),this._other.textBaseline=Vn)}),Vx(0,Va,"font",null,function(Vn){Vn!=this._other.font.toString()&&(this._other=this._other.make(),Vd.save(this,8,this._other,!1),this._other.font===VEn.EMPTY?this._other.font=new VEn(Vn):this._other.font.setFont(Vn))}),VF.__init__=function(){VU.DEFAULT=new VU},VF._tempPoint=new V$,VF._SUBMITVBSIZE=32e3,VF._MAXSIZE=99999999,VF._RECTVBSIZE=16,VF.MAXCLIPRECT=new VM(0,0,99999999,99999999),VF._COUNT=0,VF._tmpMatrix=new V_,VF.SEGNUM=32,VF._contextcount=0,VQ(VF,["_fontTemp",function(){return this._fontTemp=new VEn},"_drawStyleTemp",function(){return this._drawStyleTemp=new VO(null)}]),VF.__init$=function(){VU=function(){function Vn(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=VEn.EMPTY}Vi(Vn,"");var Va=Vn.prototype;return Va.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=VEn.EMPTY},Va.make=function(){return this===Vn.DEFAULT?new Vn:this},Vn.DEFAULT=null,Vn}()},VF}(),VNn=function(Vn){function Vx(Vn,Va){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,Vx.__super.call(this),this.defines=new VZn,this.position=Vx._POSITION,this.mainID=Vn,this.subID=Va,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=Vn|Va,this._inClassCache=Vx._cache[this._cacheID],0<Vn&&!this._inClassCache&&(this._inClassCache=Vx._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}Vi(Vx,"laya.webgl.shader.d2.value.Value2D",Vf);var Va=Vx.prototype;return Va.setValue=function(Vn){},Va.refresh=function(){var Vn=this.size;return Vn[0]=VAn.width,Vn[1]=VAn.height,this.alpha=this.ALPHA*VAn.worldAlpha,this.mmat=VAn.worldMatrix4,this},Va._ShaderWithCompile=function(){return Vsn.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,Vrn.create)},Va._withWorldShaderDefines=function(){var Vn=VAn.worldShaderDefines,Va=Vsn.sharders[this.mainID|this.defines._value|Vn.getValue()];if(!Va){var VU,Vx={};for(VU in this.defines.toNameDic())Vx[VU]="";for(VU in Vn.toNameDic())Vx[VU]="";Va=Vsn.withCompile2D(0,this.mainID,Vx,this.mainID|this.defines._value|Vn.getValue(),Vrn.create)}var VD=VAn.worldFilters;if(!VD)return Va;for(var Vp,VQ=VD.length,VV=0;VV<VQ;VV++)(Vp=VD[VV])&&Vp.action.setValue(this);return Va},Va.upload=function(){var Vn=VAn;this.alpha=this.ALPHA*Vn.worldAlpha,VAn.worldMatrix4!==VAn.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),VKn.shaderHighPrecision&&this.defines.add(1024);var Va,VU=Vn.worldShaderDefines?this._withWorldShaderDefines():Vsn.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=Vn.width,this.size[1]=Vn.height,this.mmat=Vn.worldMatrix4,Vln.activeShader!==VU?VU._shaderValueWidth!==Vn.width||VU._shaderValueHeight!==Vn.height?(VU._shaderValueWidth=Vn.width,VU._shaderValueHeight=Vn.height):Va=VU._params2dQuick2||VU._make2dQuick2():VU._shaderValueWidth!==Vn.width||VU._shaderValueHeight!==Vn.height?(VU._shaderValueWidth=Vn.width,VU._shaderValueHeight=Vn.height):Va=VU._params2dQuick1||VU._make2dQuick1(),VU.upload(this,Va)},Va.setFilters=function(Vn){if(this.filters=Vn)for(var Va,VU=Vn.length,Vx=0;Vx<VU;Vx++)(Va=Vn[Vx])&&(this.defines.add(Va.type),Va.action.setValue(this))},Va.clear=function(){this.defines.setValue(this.subID)},Va.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},Vx._initone=function(Vn,Va){Vx._typeClass[Vn]=Va,Vx._cache[Vn]=[],Vx._cache[Vn]._length=0},Vx.__init__=function(){Vx._POSITION=[2,5126,!1,4*Vmn.BYTES_PE,0],Vx._TEXCOORD=[2,5126,!1,4*Vmn.BYTES_PE,2*Vmn.BYTES_PE],Vx._initone(2,VFn),Vx._initone(4,VBn),Vx._initone(256,Vgn),Vx._initone(512,Vfn),Vx._initone(1,Von),Vx._initone(65,Vtn),Vx._initone(9,Von)},Vx.create=function(Vn,Va){var VU=Vx._cache[Vn|Va];return VU._length?VU[--VU._length]:new Vx._typeClass[Vn|Va](Va)},Vx._POSITION=null,Vx._TEXCOORD=null,Vx._cache=[],Vx._typeClass=[],Vx.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Vx}(),V_n=function(Vn){function Vb(Vn,Va){Vb.__super.call(this,Vn,Va)}Vi(Vb,"laya.webgl.utils.RenderSprite3D",VA);var Va=Vb.prototype;return Va.onCreate=function(Vn){switch(Vn){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},Va._mask=function(Vn,Va,VU,Vx){var VD,Vp,VQ=this._next,VV=Vn.mask;if(VV){Va.ctx.save();var Vy=Va.ctx.globalCompositeOperation,VR=new VM;if(VR.copyFrom(VV.getBounds()),VR.width=Math.round(VR.width),VR.height=Math.round(VR.height),VR.x=Math.round(VR.x),VR.y=Math.round(VR.y),0<VR.width&&0<VR.height){var VX=Vn._style._tf,Vz=VVn.create();Vz.addValue("bounds",VR),VD=VQn.create([Vz,Va],laya.webgl.utils.RenderSprite3D.tmpTarget),Va.addRenderObject(VD),VV.render(Va,-VR.x,-VR.y),VD=VQn.create([Vz],laya.webgl.utils.RenderSprite3D.endTmpTarget),Va.addRenderObject(VD),Va.ctx.save(),Va.clipRect(VU-VX.translateX+VR.x,Vx-VX.translateY+VR.y,VR.width,VR.height),VQ._fun.call(VQ,Vn,Va,VU,Vx),Va.ctx.restore(),Vp=VXn.create(6),Vy=Va.ctx.globalCompositeOperation,Vp.blendMode="mask",Va.addRenderObject(Vp),V_.TEMP.identity();var Vi=VNn.create(1,0),Vq=Vv.INV_UV,VE=VR.width,Vm=VR.height;(VR.width<32||VR.height<32)&&((Vq=Vb.tempUV)[0]=0,Vq[1]=0,Vq[2]=32<=VR.width?1:VR.width/32,Vq[3]=0,Vq[4]=32<=VR.width?1:VR.width/32,Vq[5]=32<=VR.height?1:VR.height/32,Vq[6]=0,Vq[7]=32<=VR.height?1:VR.height/32,VR.width=32<=VR.width?VR.width:32,VR.height=32<=VR.height?VR.height:32,Vq[1]*=-1,Vq[3]*=-1,Vq[5]*=-1,Vq[7]*=-1,Vq[1]+=1,Vq[3]+=1,Vq[5]+=1,Vq[7]+=1),Va.ctx.drawTarget(Vz,VU+VR.x-VX.translateX,Vx+VR.y-VX.translateY,VE,Vm,V_.TEMP,"tmpTarget",Vi,Vq,6),VD=VQn.create([Vz],laya.webgl.utils.RenderSprite3D.recycleTarget),Va.addRenderObject(VD),(Vp=VXn.create(6)).blendMode=Vy,Va.addRenderObject(Vp)}Va.ctx.restore()}else VQ._fun.call(VQ,Vn,Va,VU,Vx)},Va._blend=function(Vn,Va,VU,Vx){var VD=Vn._style,Vp=this._next;VD.blendMode?(Va.ctx.save(),Va.ctx.globalCompositeOperation=VD.blendMode,Vp._fun.call(Vp,Vn,Va,VU,Vx),Va.ctx.restore()):Vp._fun.call(Vp,Vn,Va,VU,Vx)},Va._transform=function(Vn,Va,VU,Vx){var VD=Vn.transform,Vp=this._next;if(VD&&Vp!=VA.NORENDER){var VQ=Va.ctx;Vn._style;VD.tx=VU,VD.ty=Vx;var VV=VQ._getTransformMatrix(),Vy=VV.clone();V_.mul(VD,VV,VV),VV._checkTransform(),VD.tx=VD.ty=0,Vp._fun.call(Vp,Vn,Va,0,0),Vy.copyTo(VV),Vy.destroy()}else Vp._fun.call(Vp,Vn,Va,VU,Vx)},Vb.tmpTarget=function(Vn,Va){var VU=Vn.getValue("bounds"),Vx=Vjn.create(VU.width,VU.height);Vx.start(),Vx.clear(0,0,0,0),Vn.addValue("tmpTarget",Vx)},Vb.endTmpTarget=function(Vn){Vn.getValue("tmpTarget").end()},Vb.recycleTarget=function(Vn){Vn.getValue("tmpTarget").recycle(),Vn.recycle()},VQ(Vb,["tempUV",function(){return this.tempUV=new Array(8)}]),Vb}(),V$n=function(Vn){function Va(){this.data=null,Va.__super.call(this)}Vi(Va,"laya.filters.webgl.ColorFilterActionGL",Vh);var VU=Va.prototype;return VW.imps(VU,{"laya.filters.IFilterActionGL":!0}),VU.setValue=function(Vn){Vn.colorMat=this.data._mat,Vn.colorAlpha=this.data._alpha},VU.apply3d=function(Vn,Va,VU,Vx,VD){var Vp=Vn.getValue("bounds"),VQ=VNn.create(1,0);VQ.setFilters([this.data]);var VV=V_.TEMP;VV.identity(),VU.ctx.drawTarget(Vn,0,0,Vp.width,Vp.height,VV,"src",VQ)},Va}(),VMn=function(Vn){function Vp(Vn,Va,VU,Vx,VD){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,Vp.__super.call(this,Vn,Va,VD),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new VOn,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=VU,this._atlasCanvas.height=Vx,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}Vi(Vp,"laya.webgl.atlas.Atlaser",VF);var Va=Vp.prototype;return Va.computeUVinAtlasTexture=function(Vn,Va,VU,Vx){var VD=Vg.atlasTextureWidth,Vp=Vg.atlasTextureHeight,VQ=VU/VD,VV=Vx/Vp,Vy=(VU+Vn.bitmap.width)/VD,VR=(Vx+Vn.bitmap.height)/Vp,VX=Vn.bitmap.width/VD,Vz=Vn.bitmap.height/Vp;Vn.uv=[VQ+Va[0]*VX,VV+Va[1]*Vz,Vy-(1-Va[2])*VX,VV+Va[3]*Vz,Vy-(1-Va[4])*VX,VR-(1-Va[5])*Vz,VQ+Va[6]*VX,VR-(1-Va[7])*Vz]},Va.findBitmapIsExist=function(Vn){if(Vn instanceof laya.webgl.resource.WebGLImage){var Va=Vn,VU=Va.url,Vx=this._InAtlasWebGLImagesKey[VU||Va.id];if(Vx)return Vx.offsetInfoID}return-1},Va.addToAtlasTexture=function(Vn,Va,VU){if(Vn instanceof laya.webgl.resource.WebGLImage){var Vx=Vn,VD=Vx.url;this._InAtlasWebGLImagesKey[VD||Vx.id]={bitmap:Vn,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([Va,VU])}this._atlasCanvas.texSubImage2D(Va,VU,Vn.atlasSource),Vn.clearAtlasSource()},Va.addToAtlas=function(Vn,Va,VU){Vn._atlasID=this._inAtlasTextureKey.length;var Vx=Vn.uv.slice(),VD=Vn.bitmap;this._inAtlasTextureKey.push(Vn),this._inAtlasTextureOriUVValue.push(Vx),this._inAtlasTextureBitmapValue.push(VD),this.computeUVinAtlasTexture(Vn,Vx,Va,VU),Vn.bitmap=this._atlasCanvas},Va.clear=function(){for(var Vn=0,Va=this._inAtlasTextureKey.length;Vn<Va;Vn++)this._inAtlasTextureKey[Vn].bitmap=this._inAtlasTextureBitmapValue[Vn],this._inAtlasTextureKey[Vn].uv=this._inAtlasTextureOriUVValue[Vn],this._inAtlasTextureKey[Vn]._atlasID=-1,this._inAtlasTextureKey[Vn].bitmap.lock=!1,this._inAtlasTextureKey[Vn].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},Va.dispose=function(){this.clear(),this._atlasCanvas.destroy()},Vx(0,Va,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),Vx(0,Va,"texture",function(){return this._atlasCanvas}),Vx(0,Va,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),Vp}(),VZn=function(Vn){function VU(){VU.__super.call(this,VU.__name2int,VU.__int2name,VU.__int2nameMap)}return Vi(VU,"laya.webgl.shader.d2.ShaderDefines2D",Ve),VU.__init__=function(){VU.reg("TEXTURE2D",1),VU.reg("COLOR2D",2),VU.reg("PRIMITIVE",4),VU.reg("GLOW_FILTER",8),VU.reg("BLUR_FILTER",16),VU.reg("COLOR_FILTER",32),VU.reg("COLOR_ADD",64),VU.reg("WORLDMAT",128),VU.reg("FILLTEXTURE",256),VU.reg("FSHIGHPRECISION",1024),VU.reg("TXTALPHA",2048),VU.reg("TXTCOMPRESS",4096)},VU.reg=function(Vn,Va){Ve._reg(Vn,Va,VU.__name2int,VU.__int2name)},VU.toText=function(Vn,Va,VU){return Ve._toText(Vn,Va,VU)},VU.toInt=function(Vn){return Ve._toInt(Vn,VU.__name2int)},VU.TEXTURE2D=1,VU.COLOR2D=2,VU.PRIMITIVE=4,VU.FILTERGLOW=8,VU.FILTERBLUR=16,VU.FILTERCOLOR=32,VU.COLORADD=64,VU.WORLDMAT=128,VU.FILLTEXTURE=256,VU.SKINMESH=512,VU.SHADERDEFINE_FSHIGHPRECISION=1024,VU.TXTALPHA=2048,VU.TXTCOMPRESS=4096,VU.__name2int={},VU.__int2name=[],VU.__int2nameMap=[],VU}(),Vun=(function(Vn){function VV(Vn,Va,VU,Vx,VD,Vp,VQ){VV.__super.call(this,Vn,Va,VU,Vx,40,VD,Vp,VQ)}Vi(VV,"laya.webgl.shapes.Ellipse",VUn)}(),function(Vn){function Vp(Vn,Va,VU,Vx,VD){this._points=[],this.rebuild(VU),Vp.__super.call(this,Vn,Va,0,0,0,VD,Vx,VD,0)}Vi(Vp,"laya.webgl.shapes.Line",VUn);var Va=Vp.prototype;return Va.rebuild=function(Vn){var Va=Vn.length;Va!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(Va/2-1)),this.mFloat32Array=new Float32Array(5*Va)),this._points.length=0;for(var VU=NaN,Vx=NaN,VD=-1,Vp=-1,VQ=Vn.length/2,VV=0;VV<VQ;VV++)VU=Vn[2*VV],Vx=Vn[2*VV+1],(.01<Math.abs(VD-VU)||.01<Math.abs(Vp-Vx))&&this._points.push(VU,Vx),VD=VU,Vp=Vx},Va.getData=function(Vn,Va,VU){var Vx=[],VD=[];0<this.borderWidth&&this.createLine2(this._points,Vx,this.borderWidth,VU,VD,this._points.length/2),this.mUint16Array.set(Vx,0),this.mFloat32Array.set(VD,0),Vn.append(this.mUint16Array),Va.append(this.mFloat32Array)},Vp}()),Vcn=function(Vn){function Vz(Vn,Va,VU,Vx,VD){this._points=[];for(var Vp=NaN,VQ=NaN,VV=-1,Vy=-1,VR=VU.length/2-1,VX=0;VX<VR;VX++)Vp=VU[2*VX],VQ=VU[2*VX+1],(.01<Math.abs(VV-Vp)||.01<Math.abs(Vy-VQ))&&this._points.push(Vp,VQ),VV=Vp,Vy=VQ;Vp=VU[2*VR],VQ=VU[2*VR+1],VV=this._points[0],Vy=this._points[1],(.01<Math.abs(VV-Vp)||.01<Math.abs(Vy-VQ))&&this._points.push(Vp,VQ),Vz.__super.call(this,Vn,Va,0,0,this._points.length/2,0,Vx,VD)}Vi(Vz,"laya.webgl.shapes.LoopLine",VUn);var Va=Vz.prototype;return Va.getData=function(Vn,Va,VU){if(0<this.borderWidth){for(var Vx=this.color,VD=(Vx>>16&255)/255,Vp=(Vx>>8&255)/255,VQ=(255&Vx)/255,VV=[],Vy=0,VR=0,VX=[],Vz=Math.floor(this._points.length/2),Vi=0;Vi<Vz;Vi++)Vy=this._points[2*Vi],VR=this._points[2*Vi+1],VV.push(this.x+Vy,this.y+VR,VD,Vp,VQ);this.createLoopLine(VV,VX,this.borderWidth,VU+VV.length/5),Vn.append(new Uint16Array(VX)),Va.append(new Float32Array(VV))}},Va.createLoopLine=function(Vn,Va,VU,Vx,VD,Vp){Vn.length;var VQ=Vn.concat(),VV=VD||Vn,Vy=this.borderColor,VR=(Vy>>16&255)/255,VX=(Vy>>8&255)/255,Vz=(255&Vy)/255,Vi=[VQ[0],VQ[1]],Vq=[VQ[VQ.length-5],VQ[VQ.length-4]],VE=Vq[0]+.5*(Vi[0]-Vq[0]),Vm=Vq[1]+.5*(Vi[1]-Vq[1]);VQ.unshift(VE,Vm,0,0,0),VQ.push(VE,Vm,0,0,0);var Vb,VP,VA,VT,VK,VY,VW,Vk,VN,V_,V$,VM,VZ,Vu,Vc,VH,VG,VI,Vv,Vl,Vj=VQ.length/5,Vh=Vx,Vf=VU/2;VA=VQ[0],VT=VQ[1],V_=VA-(VK=VQ[5]),VN=(VN=-(VT-(VY=VQ[6])))/(Vl=Math.sqrt(VN*VN+V_*V_))*Vf,V_=V_/Vl*Vf,VV.push(VA-VN,VT-V_,VR,VX,Vz,VA+VN,VT+V_,VR,VX,Vz);for(var VF=1;VF<Vj-1;VF++)VA=VQ[5*(VF-1)],VT=VQ[5*(VF-1)+1],VK=VQ[5*VF],VY=VQ[5*VF+1],VW=VQ[5*(VF+1)],Vk=VQ[5*(VF+1)+1],V_=VA-VK,VM=VK-VW,Vc=(-(VN=(VN=-(VT-VY))/(Vl=Math.sqrt(VN*VN+V_*V_))*Vf)+VA)*(-(V_=V_/Vl*Vf)+VY)-(-VN+VK)*(-V_+VT),VI=(-(V$=(V$=-(VY-Vk))/(Vl=Math.sqrt(V$*V$+VM*VM))*Vf)+VW)*(-(VM=VM/Vl*Vf)+VY)-(-V$+VK)*(-VM+Vk),Vv=(VZ=-V_+VT-(-V_+VY))*(VG=-V$+VK-(-V$+VW))-(VH=-VM+Vk-(-VM+VY))*(Vu=-VN+VK-(-VN+VA)),Math.abs(Vv)<.1?(Vv+=10.1,VV.push(VK-VN,VY-V_,VR,VX,Vz,VK+VN,VY+V_,VR,VX,Vz)):(((Vb=(Vu*VI-VG*Vc)/Vv)-VK)*(Vb-VK)+((VP=(VH*Vc-VZ*VI)/Vv)-VY)+(VP-VY),VV.push(Vb,VP,VR,VX,Vz,VK-(Vb-VK),VY-(VP-VY),VR,VX,Vz));Vp&&(Va=Vp);var Vg=this.edges+1;for(VF=1;VF<Vg;VF++)Va.push(Vh+2*(VF-1),Vh+2*(VF-1)+1,Vh+2*VF+1,Vh+2*VF+1,Vh+2*VF,Vh+2*(VF-1));return Va.push(Vh+2*(VF-1),Vh+2*(VF-1)+1,Vh+1,Vh+1,Vh,Vh+2*(VF-1)),VV},Vz}(),VHn=function(Vn){function VQ(Vn,Va,VU,Vx,VD,Vp){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=V_.create(),this._points=VU.slice(0,VU.length),VQ.__super.call(this,Vn,Va,0,0,this._points.length/2,Vx,VD,Vp)}Vi(VQ,"laya.webgl.shapes.Polygon",VUn);var Va=VQ.prototype;return Va.rebuild=function(Vn){this._repaint||(this._points.length=0,this._points=this._points.concat(Vn))},Va.setMatrix=function(Vn){Vn.copyTo(this._mat)},Va.needUpdate=function(Vn){return this._repaint=this._mat.a==Vn.a&&this._mat.b==Vn.b&&this._mat.c==Vn.c&&this._mat.d==Vn.d&&this._mat.tx==Vn.tx&&this._mat.ty==Vn.ty,!this._repaint},Va.getData=function(Vn,Va,VU){var Vx,VD=0,Vp=this._points,VQ=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=VU){for(this._start=VU,Vx=[],VQ=this.earcutTriangles.length,VD=0;VD<VQ;VD++)Vx.push(this.earcutTriangles[VD]+VU);this.mUint16Array=new Uint16Array(Vx)}}else{this._start=VU,Vx=[];var VV=[],Vy=[],VR=this.color,VX=(VR>>16&255)/255,Vz=(VR>>8&255)/255,Vi=(255&VR)/255;for(VQ=Math.floor(Vp.length/2),VD=0;VD<VQ;VD++)VV.push(this.x+Vp[2*VD],this.y+Vp[2*VD+1],VX,Vz,Vi),Vy.push(this.x+Vp[2*VD],this.y+Vp[2*VD+1]);for(this.earcutTriangles=Vxn.earcut(Vy,null,2),VQ=this.earcutTriangles.length,VD=0;VD<VQ;VD++)Vx.push(this.earcutTriangles[VD]+VU);this.mUint16Array=new Uint16Array(Vx),this.mFloat32Array=new Float32Array(VV)}Vn.append(this.mUint16Array),Va.append(this.mFloat32Array)},VQ}(),VGn=function(Vn){function Vp(){this._matrix=new V_,this._matrix4=Vmn.defaultMatrix4.concat(),Vp.__super.call(this,1e4),this.shaderValue=new VNn(0,0)}Vi(Vp,"laya.webgl.submit.SubmitCanvas",Vpn);var Va=Vp.prototype;return Va.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var Vn=VAn.worldAlpha,Va=VAn.worldMatrix4,VU=VAn.worldMatrix,Vx=VAn.worldFilters,VD=VAn.worldShaderDefines,Vp=this.shaderValue,VQ=this._matrix,VV=this._matrix4,Vy=V_.TEMP;return V_.mul(VQ,VU,Vy),VV[0]=Vy.a,VV[1]=Vy.b,VV[4]=Vy.c,VV[5]=Vy.d,VV[12]=Vy.tx,VV[13]=Vy.ty,VAn.worldMatrix=Vy.clone(),VAn.worldMatrix4=VV,VAn.worldAlpha=VAn.worldAlpha*Vp.alpha,Vp.filters&&Vp.filters.length&&(VAn.worldFilters=Vp.filters,VAn.worldShaderDefines=Vp.defines),this._ctx_src.flush(),VAn.worldAlpha=Vn,VAn.worldMatrix4=Va,VAn.worldMatrix.destroy(),VAn.worldMatrix=VU,VAn.worldFilters=Vx,VAn.worldShaderDefines=VD,1},Va.releaseRender=function(){var Vn=Vp._cache;this._ctx_src=null,Vn[Vn._length++]=this},Va.getRenderType=function(){return 10003},Vp.create=function(Vn,Va,VU){var Vx=Vp._cache._length?Vp._cache[--Vp._cache._length]:new Vp;Vx._ctx_src=Vn;var VD=Vx.shaderValue;return VD.alpha=Va,VD.defines.setValue(0),VU&&VU.length&&VD.setFilters(VU),Vx},Vp._cache=((Vp._cache=[])._length=0,Vp._cache),Vp}(),VIn=function(Vn){function VR(Vn){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===Vn&&(Vn=1e4),VR.__super.call(this,Vn)}Vi(VR,"laya.webgl.submit.SubmitTexture",Vpn);var Va=VR.prototype;return Va.releaseRender=function(){var Vn=VR._cache;(Vn[Vn._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},Va.addTexture=function(Vn,Va){this._texsID[this._texs.length]=Vn._uvID,this._texs.push(Vn),this._vbPos.push(Va)},Va.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var Vn=this.shaderValue.textureHost.bitmap;if(null!==Vn)for(var Va=this._vb.getFloat32Array(),VU=0,Vx=this._texs.length;VU<Vx;VU++){var VD=this._texs[VU];VD.active();var Vp=VD.uv;if(this._texsID[VU]!==VD._uvID){this._texsID[VU]=VD._uvID;var VQ=this._vbPos[VU];Va[VQ+2]=Vp[0],Va[VQ+3]=Vp[1],Va[VQ+6]=Vp[2],Va[VQ+7]=Vp[3],Va[VQ+10]=Vp[4],Va[VQ+11]=Vp[5],Va[VQ+14]=Vp[6],Va[VQ+15]=Vp[7],this._vb.setNeedUpload()}VD.bitmap!==Vn&&(this._isSameTexture=!1)}}},Va.renderSubmit=function(){if(0===this._numEle)return VR._shaderSet=!1,1;var Vn=this.shaderValue.textureHost;if(Vn){var Va=Vn.source;if(!Vn.bitmap||!Va)return VR._shaderSet=!1,1;this.shaderValue.texture=Va,Vn.alphaTexture&&Vn.alphaTexture.source&&(this.shaderValue.texture1=Vn.alphaTexture.source)}this._vb.bind_upload(this._ib);var VU=VKn.mainContext;if(VB.activeBlendFunction!==this._blendFn&&(VU.enable(3042),this._blendFn(VU),VB.activeBlendFunction=this._blendFn),Vc.drawCall++,Vc.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&Vln.activeShader&&VR._shaderSet?(Vln.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&Vln.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),VR._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var Vx=Vn.bitmap,VD=0,Vp=Vln.activeShader,VQ=0,VV=this._texs.length;VQ<VV;VQ++){var Vy=this._texs[VQ];Vy.bitmap===Vx&&VQ+1!==VV||(Vp.uploadTexture2D(Vy.source),VU.drawElements(4,6*(VQ-VD+1),5123,this._startIdx+6*VD*Vmn.BYTES_PIDX),Vx=Vy.bitmap,VD=VQ)}else VU.drawElements(4,this._numEle,5123,this._startIdx);return 1},VR.create=function(Vn,Va,VU,Vx,VD){var Vp=VR._cache._length?VR._cache[--VR._cache._length]:new VR;null==VU&&((VU=Vp._selfVb||(Vp._selfVb=Ven.create(-1))).clear(),Vx=0),Vp._ib=Va,Vp._vb=VU,Vp._startIdx=Vx*Vmn.BYTES_PIDX,Vp._numEle=0;var VQ=Vn._nBlendType;Vp._blendFn=Vn._targets?VB.targetFns[VQ]:VB.fns[VQ],Vp.shaderValue=VD,Vp.shaderValue.setValue(Vn._shader2D);var VV=Vn._shader2D.filters;return VV&&Vp.shaderValue.setFilters(VV),Vp},VR._cache=((VR._cache=[])._length=0,VR._cache),VR._shaderSet=!0,VR}(),Vvn=function(Vn){function VP(){VP.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}Vi(VP,"laya.webgl.utils.MeshTexture",VPn);var Va=VP.prototype;return Va.addData=function(Vn,Va,VU,Vx,VD,Vp){for(var VQ=Vn.length/2,VV=this._vb.needSize(VQ*VP.const_stride)>>2,Vy=this._vb.getFloat32Array(),VR=0,VX=0;VX<VQ;VX++){var Vz=Vn[VR],Vi=Vn[VR+1],Vq=Vz*Vx.a+Vi*Vx.c+Vx.tx,VE=Vz*Vx.b+Vi*Vx.d+Vx.ty;Vy[VV++]=Vq,Vy[VV++]=VE,Vy[VV++]=Va[VR],Vy[VV++]=Va[VR+1],VR+=2}this._vb.setNeedUpload();var Vm=this.vertNum;if(0<Vm){(VQ=VU.length)>VP.tmpIdx.length&&(VP.tmpIdx=new Uint16Array(VQ));for(var Vb=0;Vb<VQ;Vb++)VP.tmpIdx[Vb]=VU[Vb]+Vm;this._ib.appendU16Array(VP.tmpIdx,VU.length)}else this._ib.append(VU);this._ib.setNeedUpload(),this.vertNum+=VQ,this.indexNum+=VU.length},Va.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},Va.destroy=function(){this._ib.destroy(),this._vb.destroy()},VP.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new VP},VP.const_stride=16,VP._POOL=[],VQ(VP,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),VP}(),Vln=function(Vn){function Va(){Va.__super.call(this),this.lock=!0}return Vi(Va,"laya.webgl.shader.BaseShader",VT),Va.activeShader=null,Va.bindShader=null,Va}(),Vjn=function(Va){function VX(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===VU&&(VU=6408),void 0===Vx&&(Vx=5121),void 0===VD&&(VD=34041),void 0===Vp&&(Vp=!1),void 0===VQ&&(VQ=!1),void 0===VV&&(VV=-1),void 0===Vy&&(Vy=-1),this._type=1,this._w=Vn,this._h=Va,this._surfaceFormat=VU,this._surfaceType=Vx,this._depthStencilFormat=VD,VP.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=Vp,this._repeat=VQ,this._minFifter=VV,this._magFifter=Vy,this._createWebGLRenderTarget(),this.bitmap.lock=!0,VX.__super.call(this,this.bitmap,Vv.INV_UV)}Vi(VX,"laya.webgl.resource.RenderTarget2D",Va);var Vn=VX.prototype;return VW.imps(Vn,{"laya.resource.IDispose":!0}),Vn.getType=function(){return this._type},Vn.getTexture=function(){return this},Vn.size=function(Vn,Va){this._w==Vn&&this._h==Va||(this._w=Vn,this._h=Va,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},Vn.release=function(){this.destroy()},Vn.recycle=function(){VX.POOL.push(this)},Vn.start=function(){var Vn=VKn.mainContext;return this._preRenderTarget=VAn.curRenderTarget,VAn.curRenderTarget=this,Vn.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(Vn.viewport(0,0,this._w,this._h),this._svWidth=VAn.width,this._svHeight=VAn.height,VAn.width=this._w,VAn.height=this._h,Vln.activeShader=null),this},Vn.clear=function(Vn,Va,VU,Vx){void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=1);var VD=VKn.mainContext;VD.clearColor(Vn,Va,VU,Vx);var Vp=16384;switch(this._depthStencilFormat){case 33189:Vp|=256;break;case 36168:Vp|=1024;break;case 34041:Vp|=256,Vp|=1024}VD.clear(Vp)},Vn.end=function(){var Vn=VKn.mainContext;Vn.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,VAn.curRenderTarget=this._preRenderTarget,1==this._type?(Vn.viewport(0,0,this._svWidth,this._svHeight),VAn.width=this._svWidth,VAn.height=this._svHeight,Vln.activeShader=null):Vn.viewport(0,0,VW.stage.width,VW.stage.height)},Vn.getData=function(Vn,Va,VU,Vx){var VD=VKn.mainContext;if(VD.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===VD.checkFramebufferStatus(36160)))return VD.bindFramebuffer(36160,null),null;var Vp=new Uint8Array(this._w*this._h*4);return VD.readPixels(Vn,Va,VU,Vx,this._surfaceFormat,this._surfaceType,Vp),VD.bindFramebuffer(36160,null),Vp},Vn.destroy=function(Vn){void 0===Vn&&(Vn=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,Va.prototype.destroy.call(this))},Vn.dispose=function(){},Vn._createWebGLRenderTarget=function(){this.bitmap=new VSn(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(Vn){this.event("recovered")})},Vx(0,Vn,"surfaceFormat",function(){return this._surfaceFormat}),Vx(0,Vn,"magFifter",function(){return this._magFifter}),Vx(0,Vn,"surfaceType",function(){return this._surfaceType}),Vx(0,Vn,"mipMap",function(){return this._mipMap}),Vx(0,Vn,"depthStencilFormat",function(){return this._depthStencilFormat}),Vx(0,Vn,"minFifter",function(){return this._minFifter}),Vx(0,Vn,"source",function(){return this._alreadyResolved?VW.superGet(Vv,this,"source"):null}),VX.create=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){void 0===VU&&(VU=6408),void 0===Vx&&(Vx=5121),void 0===VD&&(VD=34041),void 0===Vp&&(Vp=!1),void 0===VQ&&(VQ=!1),void 0===VV&&(VV=-1),void 0===Vy&&(Vy=-1);var VR=VX.POOL.pop();return VR||(VR=new VX(Vn,Va)),VR.bitmap&&VR._w==Vn&&VR._h==Va&&VR._surfaceFormat==VU&&VR._surfaceType==Vx&&VR._depthStencilFormat==VD&&VR._mipMap==Vp&&VR._repeat==VQ&&VR._minFifter==VV&&VR._magFifter==Vy||(VR._w=Vn,VR._h=Va,VR._surfaceFormat=VU,VR._surfaceType=Vx,VR._depthStencilFormat=VD,VP.isConchWebGL&&34041===VR._depthStencilFormat&&(VR._depthStencilFormat=33189),VR._mipMap=Vp,VR._repeat=VQ,VR._minFifter=VV,VR._magFifter=Vy,VR.release(),VR._createWebGLRenderTarget()),VR},VX.TYPE2D=1,VX.TYPE3D=2,VX.POOL=[],VX}(Vv),Vhn=function(Vn){function Va(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,Va.__super.call(this),Va._gl=VKn.mainContext}Vi(Va,"laya.webgl.utils.Buffer",VT);var VU=Va.prototype;return VU._bind=function(){this.activeResource(),Va._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(Va._bindVertexBuffer=this._glBuffer),Va._gl.bindBuffer(this._bufferType,Va._bindActive[this._bufferType]=this._glBuffer),Vln.activeShader=null)},VU.recreateResource=function(){this._glBuffer||(this._glBuffer=Va._gl.createBuffer()),this.completeCreate()},VU.disposeResource=function(){this._glBuffer&&(VKn.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},Vx(0,VU,"bufferUsage",function(){return this._bufferUsage}),Va._gl=null,Va._bindActive={},Va._bindVertexBuffer=null,Va._enableAtributes=[],Va}(),Vfn=function(Vn){function VU(Vn){this.texcoord=null,this.offsetX=300,this.offsetY=0,VU.__super.call(this,512,0);var Va=8*Vmn.BYTES_PE;this.position=[2,5126,!1,Va,0],this.texcoord=[2,5126,!1,Va,2*Vmn.BYTES_PE],this.color=[4,5126,!1,Va,4*Vmn.BYTES_PE]}return Vi(VU,"laya.webgl.shader.d2.skinAnishader.SkinSV",VNn),VU}(),VFn=function(Vn){function Va(Vn){Va.__super.call(this,2,0),this.color=[]}return Vi(Va,"laya.webgl.shader.d2.value.Color2dSV",VNn),Va.prototype.setValue=function(Vn){Vn.fillStyle&&(this.color=Vn.fillStyle._color._color),Vn.strokeStyle&&(this.color=Vn.strokeStyle._color._color)},Va}(),Vgn=function(Vn){function Va(Vn){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=VNn._TEXCOORD,Va.__super.call(this,256,0)}Vi(Va,"laya.webgl.shader.d2.value.FillTextureSV",VNn);var VU=Va.prototype;return VU.setValue=function(Vn){this.ALPHA=Vn.ALPHA,Vn.filters&&this.setFilters(Vn.filters)},VU.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},Va}(),Von=function(Vn){function Va(Vn){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=VNn._TEXCOORD,void 0===Vn&&(Vn=0),Va.__super.call(this,1,Vn)}Vi(Va,"laya.webgl.shader.d2.value.TextureSV",VNn);var VU=Va.prototype;return VU.setValue=function(Vn){this.ALPHA=Vn.ALPHA,Vn.filters&&this.setFilters(Vn.filters)},VU.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},Va}(),VBn=function(Vn){function Va(Vn){this.a_color=null,this.u_pos=[0,0],Va.__super.call(this,4,0),this.position=[2,5126,!1,5*Vmn.BYTES_PE,0],this.a_color=[3,5126,!1,5*Vmn.BYTES_PE,2*Vmn.BYTES_PE]}return Vi(Va,"laya.webgl.shader.d2.value.PrimitiveSV",VNn),Va}(),VOn=function(Vn){function Va(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,Va.__super.call(this)}Vi(Va,"laya.webgl.atlas.AtlasWebGLCanvas",Vn);var VU=Va.prototype;return VU.recreateResource=function(){var Vn=VKn.mainContext,Va=this._source=Vn.createTexture(),VU=VYn.curBindTexTarget,Vx=VYn.curBindTexValue;VYn.bindTexture(Vn,3553,Va),Vn.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),Vn.texParameteri(3553,10241,9729),Vn.texParameteri(3553,10240,9729),Vn.texParameteri(3553,10242,33071),Vn.texParameteri(3553,10243,33071),VU&&Vx&&VYn.bindTexture(Vn,VU,Vx),this.memorySize=this._w*this._h*4,this.completeCreate()},VU.disposeResource=function(){this._source&&(VKn.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},VU.texSubImage2D=function(Vn,Va,VU){if(VP.isFlash){this._flashCacheImage||(this._flashCacheImage=Vm.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var Vx=VU.bitmapdata;this._flashCacheImage._image.copyPixels(Vx,0,0,Vx.width,Vx.height,Vn,Va),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var VD=VKn.mainContext,Vp=VYn.curBindTexTarget,VQ=VYn.curBindTexValue;VYn.bindTexture(VD,3553,this._source),VD.pixelStorei(37441,!0),0<=Vn-1&&VD.texSubImage2D(3553,0,Vn-1,Va,6408,5121,VU),Vn+1<=this._w&&VD.texSubImage2D(3553,0,Vn+1,Va,6408,5121,VU),0<=Va-1&&VD.texSubImage2D(3553,0,Vn,Va-1,6408,5121,VU),Va+1<=this._h&&VD.texSubImage2D(3553,0,Vn,Va+1,6408,5121,VU),VD.texSubImage2D(3553,0,Vn,Va,6408,5121,VU),VD.pixelStorei(37441,!1),Vp&&VQ&&VYn.bindTexture(VD,Vp,VQ)}},VU.texSubImage2DPixel=function(Vn,Va,VU,Vx,VD){var Vp=VKn.mainContext,VQ=VYn.curBindTexTarget,VV=VYn.curBindTexValue;VYn.bindTexture(Vp,3553,this._source);var Vy=new Uint8Array(VD.data);Vp.pixelStorei(37441,!0),Vp.texSubImage2D(3553,0,Vn,Va,VU,Vx,6408,5121,Vy),Vp.pixelStorei(37441,!1),VQ&&VV&&VYn.bindTexture(Vp,VQ,VV)},Vx(0,VU,"width",Vn.prototype._$get_width,function(Vn){this._w=Vn}),Vx(0,VU,"height",Vn.prototype._$get_height,function(Vn){this._h=Vn}),Va}(VU),VLn=function(Vn){function VD(){this.flipY=!0,this.alwaysChange=!1,VD.__super.call(this)}Vi(VD,"laya.webgl.resource.WebGLCanvas",VU);var Va=VD.prototype;return Va.getCanvas=function(){return this._canvas},Va.clear=function(){this._ctx&&this._ctx.clear()},Va.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},Va._setContext=function(Vn){this._ctx=Vn},Va.getContext=function(Vn,Va){return this._ctx?this._ctx:this._ctx=VD._createContext(this)},Va.size=function(Vn,Va){this._w==Vn&&this._h==Va||(this._w=Vn,this._h=Va,this._ctx&&this._ctx.size(Vn,Va),this._canvas&&(this._canvas.height=Va,this._canvas.width=Vn))},Va.activeResource=function(Vn){void 0===Vn&&(Vn=!1),this._source||this.recreateResource()},Va.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},Va.disposeResource=function(){this._source&&!this.iscpuSource&&(VKn.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Va.createWebGlTexture=function(){var Vn=VKn.mainContext;this._canvas;var Va=this._source=Vn.createTexture();this.iscpuSource=!1;var VU=VYn.curBindTexTarget,Vx=VYn.curBindTexValue;VYn.bindTexture(Vn,3553,Va),Vn.pixelStorei(37440,this.flipY?1:0),VD.premulAlpha&&Vn.pixelStorei(37441,!0),Vn.texImage2D(3553,0,6408,6408,5121,this._imgData),VD.premulAlpha&&Vn.pixelStorei(37441,!1),Vn.texParameteri(3553,10240,9729),Vn.texParameteri(3553,10241,9729),Vn.texParameteri(3553,10242,33071),Vn.texParameteri(3553,10243,33071),Vn.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,VU&&Vx&&VYn.bindTexture(Vn,VU,Vx)},Va.reloadCanvasData=function(){var Vn=VKn.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var Va=VYn.curBindTexTarget,VU=VYn.curBindTexValue;VYn.bindTexture(Vn,3553,this._source),VD.premulAlpha&&Vn.pixelStorei(37441,!0),Vn.texImage2D(3553,0,6408,6408,5121,this._imgData),VD.premulAlpha&&Vn.pixelStorei(37441,!1),Vn.pixelStorei(37440,0),Va&&VU&&VYn.bindTexture(Vn,Va,VU)},Va.texSubImage2D=function(Vn,Va,VU){var Vx=VKn.mainContext,VD=VYn.curBindTexTarget,Vp=VYn.curBindTexValue;VYn.bindTexture(Vx,3553,this._source),Vx.pixelStorei(37441,!0),Vx.texSubImage2D(3553,0,Va,VU,6408,5121,Vn._source),Vx.pixelStorei(37441,!1),VD&&Vp&&VYn.bindTexture(Vx,VD,Vp)},Va.toBase64=function(Vn,Va,VU){var Vx=null;this._canvas&&(Vx=this._canvas.toDataURL(Vn,Va)),VU.call(this,Vx)},Vx(0,Va,"context",function(){return this._ctx}),Vx(0,Va,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),Vx(0,Va,"asBitmap",null,function(Vn){this._ctx&&(this._ctx.asBitmap=Vn)}),VD._createContext=null,VD.premulAlpha=!1,VD}(),Vdn=function(Vn){function Vp(Vn,Va){this.CborderSize=12,Vp.__super.call(this),this.char=Vn,this.isSpace=" "===Vn,this.xs=Va.scaleX,this.ys=Va.scaleY,this.font=Va.font.toString(),this.fontSize=Va.font.size,this.fillColor=Va.fillColor,this.borderColor=Va.borderColor,this.lineWidth=Va.lineWidth,this.underLine=Va.underLine;var VU,Vx=VP.isConchApp;Vx?((VU=ConchTextCanvas)._source=ConchTextCanvas,VU._source.canvas=ConchTextCanvas):VU=Vq.canvas.source,this.canvas=VU,this._enableMerageInAtlas=!0,this._ctx=Vx?VU:this.canvas.getContext("2d",void 0);var VD=Vl.measureText(this.char,this.font);this.cw=VD.width*this.xs,this.ch=(VD.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new Vv(this)}Vi(Vp,"laya.webgl.resource.WebGLCharImage",VU);var Va=Vp.prototype;return VW.imps(Va,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Va.active=function(){this.texture.active()},Va.recreateResource=function(){var Vn=VP.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),Vn){var Va=this.fontSize;1==this.xs&&1==this.ys||(Va=parseInt(Va*(this.xs>this.ys?this.xs:this.ys)+""));var VU="normal 100 "+this.font;VU=VU.replace(Vp._fontSizeReg,Va),this.borderColor&&(VU+=" 1 "+this.borderColor),this._ctx.font=VU,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,VI.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var Vx=this._ctx.measureText(this.char);Vx||(Vx={width:16});var VD=Vx.width+1;this._ctx.lineTo(VD,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},Va.onresize=function(Vn,Va){this._w=Vn,this._h=Va,this._allowMerageInAtlas=!0},Va.clearAtlasSource=function(){},Vx(0,Va,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Vx(0,Va,"atlasSource",function(){return this.canvas}),Vx(0,Va,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(Vn){this._enableMerageInAtlas=Vn}),Vp.createOneChar=function(Vn,Va){return new Vp(Vn,Va)},Vp._fontSizeReg=new RegExp("\\d+(?=px)","g"),Vp}(),VSn=function(Vn){function VR(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){void 0===VU&&(VU=6408),void 0===Vx&&(Vx=5121),void 0===VD&&(VD=34041),void 0===Vp&&(Vp=!1),void 0===VQ&&(VQ=!1),void 0===VV&&(VV=-1),void 0===Vy&&(Vy=1),VR.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=Vn,this._h=Va,this._surfaceFormat=VU,this._surfaceType=Vx,this._depthStencilFormat=VD,this._mipMap=Vp,this._repeat=VQ,this._minFifter=VV,this._magFifter=Vy}Vi(VR,"laya.webgl.resource.WebGLRenderTarget",VU);var Va=VR.prototype;return Va.recreateResource=function(){var Vn=VKn.mainContext;this._frameBuffer||(this._frameBuffer=Vn.createFramebuffer()),this._source||(this._source=Vn.createTexture());var Va=VYn.curBindTexTarget,VU=VYn.curBindTexValue;VYn.bindTexture(Vn,3553,this._source),Vn.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var Vx=this._minFifter,VD=this._magFifter,Vp=this._repeat?10497:33071,VQ=VX.isPOT(this._w,this._h);if(VQ?(this._mipMap?-1!==Vx||(Vx=9987):-1!==Vx||(Vx=9729),-1!==VD||(VD=9729),Vn.texParameteri(3553,10241,Vx),Vn.texParameteri(3553,10240,VD),Vn.texParameteri(3553,10242,Vp),Vn.texParameteri(3553,10243,Vp),this._mipMap&&Vn.generateMipmap(3553)):(-1!==Vx||(Vx=9729),-1!==VD||(VD=9729),Vn.texParameteri(3553,10241,Vx),Vn.texParameteri(3553,10240,VD),Vn.texParameteri(3553,10242,33071),Vn.texParameteri(3553,10243,33071)),Vn.bindFramebuffer(36160,this._frameBuffer),Vn.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=Vn.createRenderbuffer()),Vn.bindRenderbuffer(36161,this._depthStencilBuffer),Vn.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:Vn.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:Vn.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:Vn.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}Vn.bindFramebuffer(36160,null),Va&&VU&&VYn.bindTexture(Vn,Va,VU),Vn.bindRenderbuffer(36161,null),VQ&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},Va.disposeResource=function(){this._frameBuffer&&(VKn.mainContext.deleteTexture(this._source),VKn.mainContext.deleteFramebuffer(this._frameBuffer),VKn.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null)},Vx(0,Va,"depthStencilBuffer",function(){return this._depthStencilBuffer}),Vx(0,Va,"frameBuffer",function(){return this._frameBuffer}),VR}(),Vwn=function(Vn){function VV(Vn,Va,VU,Vx,VD,Vp,VQ){this.offsetX=0,this.offsetY=0,VV.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=Vp,this.canvas=Vn,this._ctx=Vn.getContext("2d",void 0),this._w=Vx,this._h=VD,this.offsetX=Va,this.offsetY=VU,this.src=VQ,this._enableMerageInAtlas=!0,Vg.enabled&&this._w<Vg.atlasLimitWidth&&this._h<Vg.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}Vi(VV,"laya.webgl.resource.WebGLSubImage",VU);var Va=VV.prototype;return VW.imps(Va,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Va.size=function(Vn,Va){this._w=Vn,this._h=Va,this._ctx&&this._ctx.size(Vn,Va),this.canvas&&(this.canvas.height=Va,this.canvas.width=Vn)},Va.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},Va.createWebGlTexture=function(){var Vn=VKn.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var Va=this._source=Vn.createTexture(),VU=VYn.curBindTexTarget,Vx=VYn.curBindTexValue;VYn.bindTexture(Vn,3553,Va),Vn.pixelStorei(37441,!0),Vn.texImage2D(3553,0,6408,6408,5121,this.canvas),Vn.pixelStorei(37441,!1);var VD=this.minFifter,Vp=this.magFifter,VQ=this.repeat?10497:33071,VV=VX.isPOT(this.width,this.height);VV?(this.mipmap?-1!==VD||(VD=9987):-1!==VD||(VD=9729),-1!==Vp||(Vp=9729),Vn.texParameteri(3553,10240,Vp),Vn.texParameteri(3553,10241,VD),Vn.texParameteri(3553,10242,VQ),Vn.texParameteri(3553,10243,VQ),this.mipmap&&Vn.generateMipmap(3553)):(-1!==VD||(VD=9729),-1!==Vp||(Vp=9729),Vn.texParameteri(3553,10241,VD),Vn.texParameteri(3553,10240,Vp),Vn.texParameteri(3553,10242,33071),Vn.texParameteri(3553,10243,33071)),VU&&Vx&&VYn.bindTexture(Vn,VU,Vx),this.canvas=null,VV&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},Va.disposeResource=function(){Vg.enabled&&this._allowMerageInAtlas||!this._source||(VKn.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Va.clearAtlasSource=function(){},Vx(0,Va,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Vx(0,Va,"atlasSource",function(){return this.canvas}),Vx(0,Va,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(Vn){this._allowMerageInAtlas=Vn}),VV}(),Vsn=function(Vn){function VR(Vn,Va,VU,Vx){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,VR.__super.call(this),!Vn||!Va)throw"Shader Error";this._id=++VR._count,this._vs=Vn,this._ps=Va,this._nameMap=Vx||{},null!=VU&&(VR.sharders[VU]=this)}Vi(VR,"laya.webgl.shader.Shader",Vln);var Va=VR.prototype;return Va.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},Va.disposeResource=function(){VKn.mainContext.deleteShader(this._vshader),VKn.mainContext.deleteShader(this._pshader),VKn.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},Va._compile=function(){if(!VKn.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var Vn=[this._vs,this._ps],Va=VKn.mainContext;if(this._program=Va.createProgram(),this._vshader=VR._createShader(Va,Vn[0],35633),this._pshader=VR._createShader(Va,Vn[1],35632),Va.attachShader(this._program,this._vshader),Va.attachShader(this._program,this._pshader),Va.linkProgram(this._program),!VP.isConchApp&&!Va.getProgramParameter(this._program,35714))throw Va.getProgramInfoLog(this._program);var VU,Vx,VD=0,Vp=0;for(Vp=VP.isConchApp?Va.getProgramParameterEx(this._vs,this._ps,"",35721):Va.getProgramParameter(this._program,35721),VD=0;VD<Vp;VD++){var VQ=null;VU={vartype:"attribute",glfun:null,ivartype:0,attrib:VQ=VP.isConchApp?Va.getActiveAttribEx(this._vs,this._ps,"",VD):Va.getActiveAttrib(this._program,VD),location:Va.getAttribLocation(this._program,VQ.name),name:VQ.name,type:VQ.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(VU)}var VV=0;for(VV=VP.isConchApp?Va.getProgramParameterEx(this._vs,this._ps,"",35718):Va.getProgramParameter(this._program,35718),VD=0;VD<VV;VD++){var Vy=null;Vy=VP.isConchApp?Va.getActiveUniformEx(this._vs,this._ps,"",VD):Va.getActiveUniform(this._program,VD),0<(VU={vartype:"uniform",glfun:null,ivartype:1,attrib:VQ,location:Va.getUniformLocation(this._program,Vy.name),name:Vy.name,type:Vy.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(VU.name=VU.name.substr(0,VU.name.length-3),VU.isArray=!0,VU.location=Va.getUniformLocation(this._program,VU.name)),this._params.push(VU)}for(VD=0,Vx=this._params.length;VD<Vx;VD++)if((VU=this._params[VD]).indexOfParams=VD,VU.index=1,VU.value=[VU.location,null],VU.codename=VU.name,VU.name=this._nameMap[VU.codename]?this._nameMap[VU.codename]:VU.codename,(this._paramsMap[VU.name]=VU)._this=this,VU.uploadedValue=[],"attribute"!==VU.vartype)switch(VU.type){case 5124:VU.fun=VU.isArray?this._uniform1iv:this._uniform1i;break;case 5126:VU.fun=VU.isArray?this._uniform1fv:this._uniform1f;break;case 35664:VU.fun=VU.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:VU.fun=VU.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:VU.fun=VU.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:VU.fun=this._uniform_sampler2D;break;case 35680:VU.fun=this._uniform_samplerCube;break;case 35676:VU.glfun=Va.uniformMatrix4fv,VU.fun=this._uniformMatrix4fv;break;case 35670:VU.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else VU.fun=this._attribute}},Va.getUniform=function(Vn){return this._paramsMap[Vn]},Va._attribute=function(Vn,Va){var VU=VKn.mainContext,Vx=Vhn._enableAtributes,VD=Vn.location;return Vx[VD]||VU.enableVertexAttribArray(VD),VU.vertexAttribPointer(VD,Va[0],Va[1],Va[2],Va[3],Va[4]+this._offset),Vx[VD]=Vhn._bindVertexBuffer,1},Va._uniform1f=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va?(VKn.mainContext.uniform1f(Vn.location,VU[0]=Va),1):0},Va._uniform1fv=function(Vn,Va){if(Va.length<4){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]||VU[2]!==Va[2]||VU[3]!==Va[3]?(VKn.mainContext.uniform1fv(Vn.location,Va),VU[0]=Va[0],VU[1]=Va[1],VU[2]=Va[2],VU[3]=Va[3],1):0}return VKn.mainContext.uniform1fv(Vn.location,Va),1},Va._uniform_vec2=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]?(VKn.mainContext.uniform2f(Vn.location,VU[0]=Va[0],VU[1]=Va[1]),1):0},Va._uniform_vec2v=function(Vn,Va){if(Va.length<2){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]||VU[2]!==Va[2]||VU[3]!==Va[3]?(VKn.mainContext.uniform2fv(Vn.location,Va),VU[0]=Va[0],VU[1]=Va[1],VU[2]=Va[2],VU[3]=Va[3],1):0}return VKn.mainContext.uniform2fv(Vn.location,Va),1},Va._uniform_vec3=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]||VU[2]!==Va[2]?(VKn.mainContext.uniform3f(Vn.location,VU[0]=Va[0],VU[1]=Va[1],VU[2]=Va[2]),1):0},Va._uniform_vec3v=function(Vn,Va){return VKn.mainContext.uniform3fv(Vn.location,Va),1},Va._uniform_vec4=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]||VU[2]!==Va[2]||VU[3]!==Va[3]?(VKn.mainContext.uniform4f(Vn.location,VU[0]=Va[0],VU[1]=Va[1],VU[2]=Va[2],VU[3]=Va[3]),1):0},Va._uniform_vec4v=function(Vn,Va){return VKn.mainContext.uniform4fv(Vn.location,Va),1},Va._uniformMatrix2fv=function(Vn,Va){return VKn.mainContext.uniformMatrix2fv(Vn.location,!1,Va),1},Va._uniformMatrix3fv=function(Vn,Va){return VKn.mainContext.uniformMatrix3fv(Vn.location,!1,Va),1},Va._uniformMatrix4fv=function(Vn,Va){return VKn.mainContext.uniformMatrix4fv(Vn.location,!1,Va),1},Va._uniform1i=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va?(VKn.mainContext.uniform1i(Vn.location,VU[0]=Va),1):0},Va._uniform1iv=function(Vn,Va){return VKn.mainContext.uniform1iv(Vn.location,Va),1},Va._uniform_ivec2=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]?(VKn.mainContext.uniform2i(Vn.location,VU[0]=Va[0],VU[1]=Va[1]),1):0},Va._uniform_ivec2v=function(Vn,Va){return VKn.mainContext.uniform2iv(Vn.location,Va),1},Va._uniform_vec3i=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]||VU[2]!==Va[2]?(VKn.mainContext.uniform3i(Vn.location,VU[0]=Va[0],VU[1]=Va[1],VU[2]=Va[2]),1):0},Va._uniform_vec3vi=function(Vn,Va){return VKn.mainContext.uniform3iv(Vn.location,Va),1},Va._uniform_vec4i=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]||VU[2]!==Va[2]||VU[3]!==Va[3]?(VKn.mainContext.uniform4i(Vn.location,VU[0]=Va[0],VU[1]=Va[1],VU[2]=Va[2],VU[3]=Va[3]),1):0},Va._uniform_vec4vi=function(Vn,Va){return VKn.mainContext.uniform4iv(Vn.location,Va),1},Va._uniform_sampler2D=function(Vn,Va){var VU=VKn.mainContext,Vx=Vn.uploadedValue;return null==Vx[0]?(Vx[0]=this._curActTexIndex,VU.uniform1i(Vn.location,this._curActTexIndex),VU.activeTexture(VR._TEXTURES[this._curActTexIndex]),VYn.bindTexture(VU,3553,Va),this._curActTexIndex++,1):(VU.activeTexture(VR._TEXTURES[Vx[0]]),VYn.bindTexture(VU,3553,Va),0)},Va._uniform_samplerCube=function(Vn,Va){var VU=VKn.mainContext,Vx=Vn.uploadedValue;return null==Vx[0]?(Vx[0]=this._curActTexIndex,VU.uniform1i(Vn.location,this._curActTexIndex),VU.activeTexture(VR._TEXTURES[this._curActTexIndex]),VYn.bindTexture(VU,34067,Va),this._curActTexIndex++,1):(VU.activeTexture(VR._TEXTURES[Vx[0]]),VYn.bindTexture(VU,34067,Va),0)},Va._noSetValue=function(Vn){console.log("no....:"+Vn.name)},Va.uploadOne=function(Vn,Va){this.activeResource(),VYn.UseProgram(this._program);var VU=this._paramsMap[Vn];VU.fun.call(this,VU,Va)},Va.uploadTexture2D=function(Vn){Vc.shaderCall++;var Va=VKn.mainContext;Va.activeTexture(33984),VYn.bindTexture(Va,3553,Vn)},Va.uploadTexture2D1=function(Vn){Vc.shaderCall++;var Va=VKn.mainContext;Va.activeTexture(33985),VYn.bindTexture(Va,3553,Vn)},Va.upload=function(Vn,Va){Vln.activeShader=Vln.bindShader=this,this._lastUseFrameCount===Vc.loopCount||this.activeResource(),VYn.UseProgram(this._program),this._reCompile?(Va=this._params,this._reCompile=!1):Va=Va||this._params;VKn.mainContext;for(var VU,Vx,VD=Va.length,Vp=0,VQ=0;VQ<VD;VQ++)null!==(Vx=Vn[(VU=Va[VQ]).name])&&(Vp+=VU.fun.call(this,VU,Vx));Vc.shaderCall+=Vp},Va.uploadArray=function(Vn,Va,VU){Vln.activeShader=this,(Vln.bindShader=this).activeResource(),VYn.UseProgram(this._program);this._params;for(var Vx,VD,Vp=0,VQ=Va-2;0<=VQ;VQ-=2)(VD=this._paramsMap[Vn[VQ]])&&null!=(Vx=Vn[VQ+1])&&(VU&&VU[VD.name]&&VU[VD.name].bind(),Vp+=VD.fun.call(this,VD,Vx));Vc.shaderCall+=Vp},Va.getParams=function(){return this._params},VR.getShader=function(Vn){return VR.sharders[Vn]},VR.create=function(Vn,Va,VU,Vx){return new VR(Vn,Va,VU,Vx)},VR.withCompile=function(Vn,Va,VU,Vx){if(VU&&VR.sharders[VU])return VR.sharders[VU];var VD=VR._preCompileShader[2e-4*Vn];if(!VD)throw new Error("withCompile shader err!"+Vn);return VD.createShader(Va,VU,Vx)},VR.withCompile2D=function(Vn,Va,VU,Vx,VD){if(Vx&&VR.sharders[Vx])return VR.sharders[Vx];var Vp=VR._preCompileShader[2e-4*Vn+Va];if(!Vp)throw new Error("withCompile shader err!"+Vn+" "+Va);return Vp.createShader(VU,Vx,VD)},VR.addInclude=function(Vn,Va){VTn.addInclude(Vn,Va)},VR.preCompile=function(Vn,Va,VU,Vx){var VD=2e-4*Vn;VR._preCompileShader[VD]=new VTn(VD,Va,VU,Vx)},VR.preCompile2D=function(Vn,Va,VU,Vx,VD){var Vp=2e-4*Vn+Va;VR._preCompileShader[Vp]=new VTn(Vp,VU,Vx,VD)},VR._createShader=function(Vn,Va,VU){var Vx=Vn.createShader(VU);return Vn.shaderSource(Vx,Va),Vn.compileShader(Vx),Vx},VR._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],VR._count=0,VR._preCompileShader={},VR.SHADERNAME2ID=2e-4,VR.sharders=((VR.sharders=[]).length=32,VR.sharders),VQ(VR,["nameKey",function(){return this.nameKey=new VH}]),VR}(),VCn=function(Vn){function Va(){this._maxsize=0,this._upload=!0,this._uploadSize=0,Va.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}Vi(Va,"laya.webgl.utils.Buffer2D",Vn);var VU=Va.prototype;return VU.needSize=function(Vn){var Va=this._byteLength;if(Vn){var VU=this._byteLength+Vn;VU<=this._buffer.byteLength||this._resizeBuffer(VU<<1,!0),this._byteLength=VU}return Va},VU._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),Vc.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,Vhn._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),Vhn._gl.bufferSubData(this._bufferType,0,this._buffer)},VU._bufferSubData=function(Vn,Va,VU){if(void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),void 0===VU&&(VU=0),this._maxsize=Math.max(this._maxsize,this._byteLength),Vc.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,Vhn._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),Va||VU){var Vx=this._buffer.slice(Va,VU);Vhn._gl.bufferSubData(this._bufferType,Vn,Vx)}else Vhn._gl.bufferSubData(this._bufferType,Vn,this._buffer)},VU._checkArrayUse=function(){},VU._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},VU._bind_subUpload=function(Vn,Va,VU){return void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),void 0===VU&&(VU=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(Vn,Va,VU),!0)},VU._resizeBuffer=function(Vn,Va){if(Vn<this._buffer.byteLength)return this;if(this.memorySize=Vn,Va&&this._buffer&&0<this._buffer.byteLength){var VU=new ArrayBuffer(Vn);new Uint8Array(VU).set(new Uint8Array(this._buffer),0),this._buffer=VU}else this._buffer=new ArrayBuffer(Vn);return this._checkArrayUse(),this._upload=!0,this},VU.append=function(Vn){this._upload=!0;var Va,VU;Va=Vn.byteLength,Vn instanceof Uint8Array?(this._resizeBuffer(this._byteLength+Va,!0),VU=new Uint8Array(this._buffer,this._byteLength)):Vn instanceof Uint16Array?(this._resizeBuffer(this._byteLength+Va,!0),VU=new Uint16Array(this._buffer,this._byteLength)):Vn instanceof Float32Array&&(this._resizeBuffer(this._byteLength+Va,!0),VU=new Float32Array(this._buffer,this._byteLength)),VU.set(Vn,0),this._byteLength+=Va,this._checkArrayUse()},VU.appendU16Array=function(Vn,Va){this._resizeBuffer(this._byteLength+2*Va,!0);for(var VU=new Uint16Array(this._buffer,this._byteLength,Va),Vx=0;Vx<Va;Vx++)VU[Vx]=Vn[Vx];this._byteLength+=2*Va,this._checkArrayUse()},VU.appendEx=function(Vn,Va){this._upload=!0;var VU;VU=Vn.byteLength,this._resizeBuffer(this._byteLength+VU,!0),new Va(this._buffer,this._byteLength).set(Vn,0),this._byteLength+=VU,this._checkArrayUse()},VU.appendEx2=function(Vn,Va,VU,Vx){void 0===Vx&&(Vx=1),this._upload=!0;var VD,Vp;VD=VU*Vx,this._resizeBuffer(this._byteLength+VD,!0),Vp=new Va(this._buffer,this._byteLength);var VQ=0;for(VQ=0;VQ<VU;VQ++)Vp[VQ]=Vn[VQ];this._byteLength+=VD,this._checkArrayUse()},VU.getBuffer=function(){return this._buffer},VU.setNeedUpload=function(){this._upload=!0},VU.getNeedUpload=function(){return this._upload},VU.upload=function(){var Vn=this._bind_upload();return Vhn._gl.bindBuffer(this._bufferType,null),Vhn._bindActive[this._bufferType]=null,Vln.activeShader=null,Vn},VU.subUpload=function(Vn,Va,VU){void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),void 0===VU&&(VU=0);var Vx=this._bind_subUpload();return Vhn._gl.bindBuffer(this._bufferType,null),Vhn._bindActive[this._bufferType]=null,Vln.activeShader=null,Vx},VU.disposeResource=function(){Vn.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},VU.clear=function(){this._byteLength=0,this._upload=!0},Vx(0,VU,"bufferLength",function(){return this._buffer.byteLength}),Vx(0,VU,"byteLength",null,function(Vn){this._byteLength!==Vn&&(Vn<=this._buffer.byteLength||this._resizeBuffer(2*Vn+256,!0),this._byteLength=Vn)}),Va.__int__=function(Vn){VJn.QuadrangleIB=VJn.create(35044),Vbn.fillIBQuadrangle(VJn.QuadrangleIB,16)},Va.FLOAT32=4,Va.SHORT=2,Va}(Vhn),Vtn=(function(Va){function VU(Vn){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,VU.__super.call(this,9)}Vi(VU,"laya.webgl.shader.d2.value.GlowSV",Va);var Vn=VU.prototype;Vn.setValue=function(Vn){Va.prototype.setValue.call(this,Vn)},Vn.clear=function(){Va.prototype.clear.call(this)}}(Von),function(Vn){function Va(Vn){Va.__super.call(this,64),this.defines.add(64)}Vi(Va,"laya.webgl.shader.d2.value.TextSV",Vn);var VU=Va.prototype;return VU.release=function(){(Va.pool[Va._length++]=this).clear()},VU.clear=function(){Vn.prototype.clear.call(this)},Va.create=function(){return Va._length?Va.pool[--Va._length]:new Va(null)},Va.pool=[],Va._length=0,Va}(Von)),Vrn=function(Vn){function VD(Vn,Va,VU,Vx){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,VD.__super.call(this,Vn,Va,VU,Vx)}Vi(VD,"laya.webgl.shader.d2.Shader2X",Vn);var Va=VD.prototype;return Va.upload2dQuick1=function(Vn){this.upload(Vn,this._params2dQuick1||this._make2dQuick1())},Va._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var Vn,Va=this._params,VU=0,Vx=Va.length;VU<Vx;VU++)Vn=Va[VU],(VP.isFlash||"size"!==Vn.name&&"position"!==Vn.name&&"texcoord"!==Vn.name)&&this._params2dQuick1.push(Vn)}return this._params2dQuick1},Va.disposeResource=function(){Vn.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},Va.upload2dQuick2=function(Vn){this.upload(Vn,this._params2dQuick2||this._make2dQuick2())},Va._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var Vn,Va=this._params,VU=0,Vx=Va.length;VU<Vx;VU++)Vn=Va[VU],(VP.isFlash||"size"!==Vn.name)&&this._params2dQuick2.push(Vn)}return this._params2dQuick2},VD.create=function(Vn,Va,VU,Vx){return new VD(Vn,Va,VU,Vx)},VD}(Vsn),VJn=function(Vn){function Va(Vn){this._uint8Array=null,this._uint16Array=null,void 0===Vn&&(Vn=35044),Va.__super.call(this),this._bufferUsage=Vn,this._bufferType=34963,VP.isFlash||(this._buffer=new ArrayBuffer(8))}Vi(Va,"laya.webgl.utils.IndexBuffer2D",VCn);var VU=Va.prototype;return VU._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},VU.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},VU.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},VU.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},Va.QuadrangleIB=null,Va.create=function(Vn){return void 0===Vn&&(Vn=35044),new Va(Vn)},Va}(),Ven=function(Vn){function VU(Vn,Va){this._floatArray32=null,this._vertexStride=0,VU.__super.call(this),this._vertexStride=Vn,this._bufferUsage=Va,this._bufferType=34962,VP.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}Vi(VU,"laya.webgl.utils.VertexBuffer2D",Vn);var Va=VU.prototype;return Va.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},Va.bind=function(Vn){Vn&&Vn._bind(),this._bind()},Va.insertData=function(Vn,Va){this.getFloat32Array().set(Vn,Va),this._upload=!0},Va.bind_upload=function(Vn){Vn._bind_upload()||Vn._bind(),this._bind_upload()||this._bind()},Va._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},Va.disposeResource=function(){Vn.prototype.disposeResource.call(this)},Va.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},Vx(0,Va,"vertexStride",function(){return this._vertexStride}),VU.create=function(Vn,Va){return void 0===Va&&(Va=35048),new VU(Vn,Va)},VU}(VCn),Vna=function(Vn){function VV(Vn,Va,VU,Vx,VD,Vp){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===VU&&(VU=6408),void 0===Vx&&(Vx=!0),VV.__super.call(this,Vn,Va),Vn){if(this._format=VU,this._mipmap=Vx,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof Vn)this._url=Vn,this._src=Vn,this._image=new Vq.window.Image,Va&&(Va.onload&&(this.onload=Va.onload),Va.onerror&&(this.onerror=Va.onerror),Va.onCreate&&Va.onCreate(this)),this._image.crossOrigin=Vn&&0==Vn.indexOf("data:")?null:"",Vn&&(this._image.src=Vn);else if(Vn instanceof ArrayBuffer){this._src=Va,this._url=this._src;var VQ=new Vy(Vn);VQ.readUTFBytes(4),VQ.readUTFBytes(2),VQ.getInt16();VQ.endian="bigEndian",this._w=VQ.getInt16(),this._h=VQ.getInt16();VQ.getInt16(),VQ.getInt16();this._image=new Uint8Array(Vn,VQ.pos),this._format=VKn.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,Vg.enabled&&this._w<Vg.atlasLimitWidth&&this._h<Vg.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(Vn instanceof Uint8Array))return this._src=Va,this._url=this._src,this._image=Vn.source||Vn,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=Va,this._url=this._src,this._w=VD,this._h=Vp,this._image=Vn,this._format=0===VU?Vn.byteLength/(VD*Vp)==4?6408:6407:VU}this._$5__enableMerageInAtlas=!0}}Vi(VV,"laya.webgl.resource.WebGLImage",Vm);var Va=VV.prototype;return VW.imps(Va,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Va._init_=function(Vn,Va){},Va._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var Vn=VKn.mainContext,Va=this._source=Vn.createTexture(),VU=VYn.curBindTexTarget,Vx=VYn.curBindTexValue;VYn.bindTexture(Vn,3553,Va);var VD=this.minFifter,Vp=this.magFifter,VQ=this.repeat?10497:33071,VV=VX.isPOT(this._w,this._h),Vy=!1;switch(VV?(this.mipmap?-1!==VD||(VD=9987):-1!==VD||(VD=9729),-1!==Vp||(Vp=9729),Vn.texParameteri(3553,10241,VD),Vn.texParameteri(3553,10240,Vp),Vn.texParameteri(3553,10242,VQ),Vn.texParameteri(3553,10243,VQ),this.mipmap&&Vn.generateMipmap(3553)):(-1!==VD||(VD=9729),-1!==Vp||(Vp=9729),Vn.texParameteri(3553,10241,VD),Vn.texParameteri(3553,10240,Vp),Vn.texParameteri(3553,10242,33071),Vn.texParameteri(3553,10243,33071)),Vn.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&Vn.pixelStorei(Vn.UNPACK_ALIGNMENT,1),Vn.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&Vn.pixelStorei(Vn.UNPACK_ALIGNMENT,1),Vn.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:Vy=!0,Vn.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case VKn.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:Vy=!0,Vn.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}Vn.pixelStorei(37441,!1),VU&&Vx&&VYn.bindTexture(Vn,VU,Vx),this.uri||(this.uri=this._url),Vy?this.memorySize=this._image.length:VV&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},Va.recreateResource=function(){var Vn=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var Va=this;this._image=new Vq.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(Va._needReleaseAgain)return Va._needReleaseAgain=!1,Va._image.onload=null,void(Va._image=null);Va._allowMerageInAtlas&&Va._enableMerageInAtlas?(Vn.memorySize=0,Vn._recreateLock=!1):Va._createWebGlTexture(),Va.completeCreate()},this._image.src=this._src}},Va.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&VKn.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},Va.onresize=function(){this._w=this._image.width,this._h=this._image.height,Vg.enabled&&this._w<Vg.atlasLimitWidth&&this._h<Vg.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},Va.clearAtlasSource=function(){this._image=null},Vx(0,Va,"format",function(){return this._format}),Vx(0,Va,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(Vn){this._$5__enableMerageInAtlas=Vn}),Vx(0,Va,"mipmap",function(){return this._mipmap}),Vx(0,Va,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Vx(0,Va,"atlasSource",function(){return this._image}),Vx(0,Va,"onload",null,function(Vn){var Va=this;this._onload=Vn,this._image&&(this._image.onload=null!=this._onload?function(){Va.onresize(),Va._onload()}:null)}),Vx(0,Va,"onerror",null,function(Vn){var Va=this;this._onerror=Vn,this._image&&(this._image.onerror=null!=this._onerror?function(){Va._onerror()}:null)}),VV}();VW.__init([Vqn,VF,Vkn,VTn])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Vn,Va){"use strict";for(var VU in Object.defineProperty(Va,"__esModule",{value:!0}),Laya){var Vx=Laya[VU];Vx&&Vx.__isclass&&(Va[VU]=Vx)}}),function(Vp,Vn,Vx){Vx.un,Vx.uns;var VD=Vx.static,VQ=Vx.class,VV=Vx.getset,Vy=(Vx.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),VE=laya.utils.ClassUtils,Vz=(laya.events.Event,laya.utils.HTMLChar),VR=laya.net.Loader,VX=(laya.display.Node,laya.maths.Rectangle),Vi=laya.renders.Render,Vq=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),Vm=laya.utils.Stat,Vl=laya.display.Text,Vb=laya.resource.Texture,VP=laya.net.URL,VA=laya.utils.Utils,VT=function(){function Vq(){}return VQ(Vq,"laya.html.utils.HTMLParse"),Vq.parse=function(Vn,Va,VU){Va=(Va="<root>"+(Va=Va.replace(/<br>/g,"<br/>"))+"</root>").replace(Vq.spacePattern,Vq.char255);var Vx=VA.parseXMLFromString(Va);Vq._parseXML(Vn,Vx.childNodes[0].childNodes,VU)},Vq._parseXML=function(Vn,Va,VU,Vx){var VD=0,Vp=0;if(Va.join||Va.item)for(VD=0,Vp=Va.length;VD<Vp;++VD)Vq._parseXML(Vn,Va[VD],VU,Vx);else{var VQ,VV,Vy;if(3==Va.nodeType)return void(Vn instanceof laya.html.dom.HTMLDivElement?(null==Va.nodeName&&(Va.nodeName="#text"),VV=Va.nodeName.toLowerCase(),0<(Vy=Va.textContent.replace(/^\s+|\s+$/g,"")).length&&(VQ=VE.getInstance(VV))&&(Vn.addChild(VQ),VQ.innerTEXT=Vy.replace(Vq.char255AndOneSpacePattern," "))):0<(Vy=Va.textContent.replace(/^\s+|\s+$/g,"")).length&&(Vn.innerTEXT=Vy.replace(Vq.char255AndOneSpacePattern," ")));if("#comment"==(VV=Va.nodeName.toLowerCase()))return;if(VQ=VE.getInstance(VV)){(VQ=Vn.addChild(VQ)).URI=VU,VQ.href=Vx;var VR=Va.attributes;if(VR&&0<VR.length)for(VD=0,Vp=VR.length;VD<Vp;++VD){var VX=VR[VD],Vz=VX.nodeName,Vi=VX.value;VQ._setAttributes(Vz,Vi)}Vq._parseXML(VQ,Va.childNodes,VU,VQ.href)}else Vq._parseXML(Vn,Va.childNodes,VU,Vx)}},Vq.char255=String.fromCharCode(255),Vq.spacePattern=/&nbsp;|&#160;/g,Vq.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),Vq}(),VK=function(){function Vv(){}return VQ(Vv,"laya.html.utils.Layout"),Vv.later=function(Vn){null==Vv._will&&(Vv._will=[],Vx.stage.frameLoop(1,null,function(){if(!(Vv._will.length<1)){for(var Vn=0;Vn<Vv._will.length;Vn++)laya.html.utils.Layout.layout(Vv._will[Vn]);Vv._will.length=0}})),Vv._will.push(Vn)},Vv.layout=function(Vn){if(!Vn||!Vn._style)return null;if(0==(512&Vn._style._type))return null;Vn.getStyle()._type&=-513;var Va=Vv._multiLineLayout(Vn);return Vi.isConchApp&&Vn.layaoutCallNative&&Vn.layaoutCallNative(),Va},Vv._multiLineLayout=function(Vn){if(Vl.RightToLeft)return Vv._multiLineLayout2(Vn);var Va=new Array;Vn._addChildsToLayout(Va);var VU,Vx,VD,Vp,VQ,VV=0,Vy=Va.length,VR=Vn._getCSSStyle(),VX=VR.letterSpacing,Vz=VR.leading,Vi=VR.lineHeight,Vq=VR._widthAuto()||!VR.wordWrap,VE=Vq?999999:Vn.width,Vm=(Vn.height,0),Vb=VR.italic?VR.fontSize/3:0,VP=VR._getAlign(),VA=VR._getValign(),VT=0!==VA||0!==VP||0!=Vi,VK=0,VY=0,VW=0,Vk=0,VN=new Array,V_=VN[0]=new Vj,V$=!1,VM=!1;V_.h=0,VR.italic&&(VE-=VR.fontSize/3);var VZ=0,Vu=!0;function Vc(){V_.y=VY,VY+=V_.h+Vz,0==V_.h&&(VY+=Vi),V_.mWidth=VZ,VZ=0,V_=new Vj,VN.push(V_),V_.h=0,V$=!(Vu=!(VK=0))}for(VV=0;VV<Vy;VV++)if(null!=(VU=Va[VV]))if(Vu=!1,VU instanceof laya.html.dom.HTMLBrElement)Vc(),V_.y=VY;else{if(VU._isChar()){if((Vp=VU).isWord)V$=VM||"\n"===Vp.char,V_.wordStartIndex=V_.elements.length;else{if(VW=Vp.width+Vp.style.letterSpacin,0<VN.length&&VE<VK+VW&&0<V_.wordStartIndex){var VH;VH=V_.elements.length-V_.wordStartIndex+1,V_.elements.length=V_.wordStartIndex,VV-=VH,Vc();continue}V$=!1,VZ+=Vp.width}VW=Vp.width+VX,Vk=Vp.height,VM=!1,(V$=V$||VE<VK+VW)&&Vc(),V_.minTextHeight=Math.min(V_.minTextHeight,VU.height)}else Vx=VU._getCSSStyle(),VQ=VU,VD=Vx.padding,0===Vx._getCssFloat()||(VT=!0),V$=VM||Vx.lineElement,VW=VQ.width*VQ._style._tf.scaleX+VD[1]+VD[3]+VX,Vk=VQ.height*VQ._style._tf.scaleY+VD[0]+VD[2],VM=Vx.lineElement,(V$=V$||VE<VK+VW&&Vx.wordWrap)&&Vc();V_.elements.push(VU),V_.h=Math.max(V_.h,Vk),VU.x=VK,VU.y=VY,VK+=VW,V_.w=VK-VX,V_.y=VY,Vm=Math.max(VK+Vb,Vm)}else Vu||(VK+=Vv.DIV_ELEMENT_PADDING),V_.wordStartIndex=V_.elements.length;if(VY=V_.y+V_.h,VT){var VG=0,VI=VE;for(Vq&&0<Vn.width&&(VI=Vn.width),VV=0,Vy=VN.length;VV<Vy;VV++)VN[VV].updatePos(0,VI,VV,VG,VP,VA,Vi),VG+=Math.max(Vi,VN[VV].h+Vz);VY=VG}return Vq&&(Vn.width=Vm),VY>Vn.height&&(Vn.height=VY),[Vm,VY]},Vv._multiLineLayout2=function(Vn){var Va=new Array;Vn._addChildsToLayout(Va);var VU,Vx,VD,Vp,VQ,VV=0,Vy=Va.length,VR=Vn._getCSSStyle(),VX=VR.letterSpacing,Vz=VR.leading,Vi=VR.lineHeight,Vq=VR._widthAuto()||!VR.wordWrap,VE=Vq?999999:Vn.width,Vm=(Vn.height,0),Vb=VR.italic?VR.fontSize/3:0,VP=2-VR._getAlign(),VA=VR._getValign(),VT=0!==VA||0!=VP||0!=Vi,VK=0,VY=0,VW=0,Vk=0,VN=new Array,V_=VN[0]=new Vj,V$=!1,VM=!1;V_.h=0,VR.italic&&(VE-=VR.fontSize/3);var VZ=0,Vu=!0;function Vc(){V_.y=VY,VY+=V_.h+Vz,0==V_.h&&(VY+=Vi),V_.mWidth=VZ,VZ=0,V_=new Vj,VN.push(V_),V_.h=0,V$=!(Vu=!(VK=0))}for(VV=0;VV<Vy;VV++)if(null!=(VU=Va[VV]))if(Vu=!1,VU instanceof laya.html.dom.HTMLBrElement)Vc(),V_.y=VY;else{if(VU._isChar()){if((Vp=VU).isWord)V$=VM||"\n"===Vp.char,V_.wordStartIndex=V_.elements.length;else{if(0<VN.length&&VE<VK+VW&&0<V_.wordStartIndex){var VH;VH=V_.elements.length-V_.wordStartIndex+1,V_.elements.length=V_.wordStartIndex,VV-=VH,Vc();continue}V$=!1,VZ+=Vp.width}VW=Vp.width+VX,Vk=Vp.height,VM=!1,(V$=V$||VE<VK+VW)&&Vc(),V_.minTextHeight=Math.min(V_.minTextHeight,VU.height)}else Vx=VU._getCSSStyle(),VQ=VU,VD=Vx.padding,0===Vx._getCssFloat()||(VT=!0),V$=VM||Vx.lineElement,VW=VQ.width*VQ._style._tf.scaleX+VD[1]+VD[3]+VX,Vk=VQ.height*VQ._style._tf.scaleY+VD[0]+VD[2],VM=Vx.lineElement,(V$=V$||VE<VK+VW&&Vx.wordWrap)&&Vc();V_.elements.push(VU),V_.h=Math.max(V_.h,Vk),VU.x=VK,VU.y=VY,VK+=VW,V_.w=VK-VX,V_.y=VY,Vm=Math.max(VK+Vb,Vm)}else Vu||(VK+=Vv.DIV_ELEMENT_PADDING),V_.wordStartIndex=V_.elements.length;if(VY=V_.y+V_.h,VT){var VG=0,VI=VE;for(VV=0,Vy=VN.length;VV<Vy;VV++)VN[VV].updatePos(0,VI,VV,VG,VP,VA,Vi),VG+=Math.max(Vi,VN[VV].h+Vz);VY=VG}for(Vq&&(Vn.width=Vm),VY>Vn.height&&(Vn.height=VY),VV=0,Vy=VN.length;VV<Vy;VV++)VN[VV].revertOrder(VE);return[Vm,VY]},Vv._will=null,Vv.DIV_ELEMENT_PADDING=0,Vv}(),Vj=function(){function Vn(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}VQ(Vn,"laya.html.utils.LayoutLine");var Va=Vn.prototype;return Va.updatePos=function(Vn,Va,VU,Vx,VD,Vp,VQ){var VV,Vy=0;0<this.elements.length&&(Vy=(VV=this.elements[this.elements.length-1]).x+VV.width-this.elements[0].x);var VR=0,VX=NaN;1===VD&&(VR=(Va-Vy)/2),2===VD&&(VR=Va-Vy),0===VQ||0!=Vp||(Vp=1);for(var Vz=0,Vi=this.elements.length;Vz<Vi;Vz++){var Vq=(VV=this.elements[Vz])._getCSSStyle();switch(0!==VR&&(VV.x+=VR),Vq._getValign()){case 0:VV.y=Vx;break;case 1:var VE=0;99999!=this.minTextHeight&&(VE=this.minTextHeight);var Vm=(VE+VQ)/2;Vm=Math.max(Vm,this.h),VX=(laya.html.dom.HTMLImageElement,Vx+Vm-VV.height),VV.y=VX;break;case 2:VV.y=Vx+(VQ-VV.height)}}},Va.revertOrder=function(Vn){var Va;if(0<this.elements.length){var VU,Vx=0;for(VU=this.elements.length,Vx=0;Vx<VU;Vx++)(Va=this.elements[Vx]).x=Vn-Va.x-Va.width}},Vn}(),VY=function(VU){function Va(){this.URI=null,this._href=null,Va.__super.call(this),this._text=Va._EMPTYTEXT,this.setStyle(new Vy(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}VQ(Va,"laya.html.dom.HTMLElement",VU);var Vn=Va.prototype;return Vn.layaoutCallNative=function(){var Vn=0;if(this._childs&&0<(Vn=this._childs.length))for(var Va=0;Va<Vn;Va++)this._childs[Va].layaoutCallNative&&this._childs[Va].layaoutCallNative();var VU=this._getWords();VU?laya.html.dom.HTMLElement.fillWords(this,VU,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},Vn.appendChild=function(Vn){return this.addChild(Vn)},Vn._getWords2=function(){var Vn=this._text.text;if(!Vn||0===Vn.length)return null;var Va,VU,Vx=0,VD=0;if(this._text.drawWords)VU=this._text.drawWords;else{for(VD=(Va=Vn.split(" ")).length-1,VU=[],Vx=0;Vx<VD;Vx++)VU.push(Va[Vx]," ");0<=VD&&VU.push(Va[VD]),this._text.drawWords=VU}var Vp,VQ=this._text.words;if(VQ&&VQ.length===VU.length)return VQ;null===VQ&&(this._text.words=VQ=[]),VQ.length=VU.length;var VV=this.style,Vy=VV.font;for(Vx=0,VD=VU.length;Vx<VD;Vx++){Vp=VA.measureText(VU[Vx],Vy);var VR=VQ[Vx]=new Vz(VU[Vx],Vp.width,Vp.height||VV.fontSize,VV);if(1<VR.char.length&&(VR.charNum=VR.char),this.href){var VX=new Vq;this.addChild(VX),VR.setSprite(VX)}}return VQ},Vn._getWords=function(){if(!Vl.CharacterCache)return this._getWords2();var Vn=this._text.text;if(!Vn||0===Vn.length)return null;var Va,VU=this._text.words;if(VU&&VU.length===Vn.length)return VU;null===VU&&(this._text.words=VU=[]),VU.length=Vn.length;for(var Vx=this.style,VD=Vx.font,Vp=0,VQ=Vn.length;Vp<VQ;Vp++)if(Va=VA.measureText(Vn.charAt(Vp),VD)){var VV=VU[Vp]=new Vz(Vn.charAt(Vp),Va.width,Va.height||Vx.fontSize,Vx);if(this.href){var Vy=new Vq;this.addChild(Vy),VV.setSprite(Vy)}}else console.warn("_getWords size is null"+Vn.charAt(Vp),VD);return VU},Vn.showLinkSprite=function(){var Vn=this._text.words;if(Vn)for(var Va,VU,Vx=[],VD=0;VD<Vn.length;VD++)VU=Vn[VD],(Va=new Vq).graphics.drawRect(0,0,VU.width,VU.height,"#ff0000"),Va.width=VU.width,Va.height=VU.height,this.addChild(Va),Vx.push(Va)},Vn._layoutLater=function(){var Vn=this.style;512&Vn._type||(Vn.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&Vn.block?(VK.later(this),Vn._type|=512):this.parent&&this.parent._layoutLater())},Vn._setAttributes=function(Vn,Va){switch(Vn){case"style":return void this.style.cssText(Va);case"class":return void(this.className=Va)}VU.prototype._setAttributes.call(this,Vn,Va)},Vn.updateHref=function(){if(null!=this._href){var Vn=this._getWords();if(Vn)for(var Va,VU,Vx=0;Vx<Vn.length;Vx++)(VU=(Va=Vn[Vx]).getSprite())&&(VU.size(Va.width,Va.height),VU.on("click",this,this.onLinkHandler))}},Vn.onLinkHandler=function(Vn){switch(Vn.type){case"click":for(var Va=this;Va;)Va.event("link",[this.href]),Va=Va.parent}},Vn.formatURL=function(Vn){return this.URI?VP.formatURL(Vn,this.URI?this.URI.path:null):Vn},VV(0,Vn,"href",function(){return this._href},function(Vn){null!=(this._href=Vn)&&(this._getCSSStyle().underLine=1,this.updateHref())}),VV(0,Vn,"color",null,function(Vn){this.style.color=Vn}),VV(0,Vn,"onClick",null,function(Vn){Vx._runScript("fn=function(event){"+Vn+";}"),this.on("click",this,void 0)}),VV(0,Vn,"id",null,function(Vn){VW.document.setElementById(Vn,this)}),VV(0,Vn,"innerTEXT",function(){return this._text.text},function(Vn){this.text=Vn}),VV(0,Vn,"style",function(){return this._style}),VV(0,Vn,"text",function(){return this._text.text},function(Vn){this._text==Va._EMPTYTEXT?this._text={text:Vn,words:null}:(this._text.text=Vn,this._text.words&&(this._text.words.length=0)),Vi.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),VV(0,Vn,"parent",VU.prototype._$get_parent,function(Vn){if(Vn instanceof laya.html.dom.HTMLElement){var Va=Vn;this.URI||(this.URI=Va.URI),this.style.inherit(Va.style)}Vx.superSet(Vq,this,"parent",Vn)}),VV(0,Vn,"className",null,function(Vn){this.style.attrs(VW.document.styleSheets["."+Vn])}),Va.fillWords=function(Vn,Va,VU,Vx,VD,Vp,VQ){Vn.graphics.clear();for(var VV=0,Vy=Va.length;VV<Vy;VV++){var VR=Va[VV];Vn.graphics.fillText(VR.char,VR.x+VU,VR.y+Vx,VD,Vp,"left",VQ)}},Va._EMPTYTEXT={text:null,words:null},Va}(Vq),Va=(function(Vn){function Va(){Va.__super.call(this),this.style.lineElement=!0,this.style.block=!0}VQ(Va,"laya.html.dom.HTMLBrElement",VY)}(),function(Vn){function Va(){this.contextHeight=NaN,this.contextWidth=NaN,Va.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}VQ(Va,"laya.html.dom.HTMLDivElement",Vn);var VU=Va.prototype;return VU.appendHTML=function(Vn){VT.parse(this,Vn,this.URI),this.layout()},VU._addChildsToLayout=function(Va){var Vn=this._getWords();if(null==Vn&&0==this._childs.length)return!1;Vn&&Vn.forEach(function(Vn){Va.push(Vn)});for(var VU=!0,Vx=0,VD=this._childs.length;Vx<VD;Vx++){var Vp=this._childs[Vx];VU?VU=!1:Va.push(null),Vp._addToLayout(Va)}return!0},VU._addToLayout=function(Vn){this.layout()},VU.layout=function(){if(this.style){this.style._type|=512;var Vn=VK.layout(this);if(Vn){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new VX);var Va=this._$P.mHtmlBounds;Va.x=Va.y=0,Va.width=this.contextWidth=Vn[0],Va.height=this.contextHeight=Vn[1],this.setBounds(Va)}}},VV(0,VU,"height",function(){return this._height?this._height:this.contextHeight},Vn.prototype._$set_height),VV(0,VU,"innerHTML",null,function(Vn){this.destroyChildren(),this.appendHTML(Vn)}),VV(0,VU,"width",function(){return this._width?this._width:this.contextWidth},function(Vn){var Va=!1;Va=0===Vn?Vn!=this._width:Vn!=this.width,Vx.superSet(VY,this,"width",Vn),Va&&this.layout()}),Va}(VY)),VW=function(Vn){function Va(){this.all=new Array,this.styleSheets=Vy.styleSheets,Va.__super.call(this)}VQ(Va,"laya.html.dom.HTMLDocument",VY);var VU=Va.prototype;return VU.getElementById=function(Vn){return this.all[Vn]},VU.setElementById=function(Vn,Va){this.all[Vn]=Va},VD(Va,["document",function(){return this.document=new Va}]),Va}();(function(Vn){function Va(){this._tex=null,this._url=null,this._renderArgs=[],Va.__super.call(this),this.style.block=!0}VQ(Va,"laya.html.dom.HTMLImageElement",VY);var VU=Va.prototype;VU._addToLayout=function(Vn){!this._style.absolute&&Vn.push(this)},VU.render=function(Vn,Va,VU){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(Vm.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,Vn.ctx.drawTexture2(Va,VU,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},VU.layaoutCallNative=function(){var Vn=0;if(this._childs&&0<(Vn=this._childs.length))for(var Va=0;Va<Vn;Va++)this._childs[Va].layaoutCallNative&&this._childs[Va].layaoutCallNative()},VV(0,VU,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(Vn){this._width!==Vn&&(this._width=Vn,this._style.width=Vn,this.repaint())}),VV(0,VU,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(Vn){this._height!==Vn&&(this._height=Vn,this._style.height=Vn,this.repaint())}),VU.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),VR.clearCache(this,this._url),this._tex=null),VY.prototype.destroy.call(this)},VU.onloaded=function(){var Vn=this._style;Vn&&!Vn.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),Vn&&!Vn.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),Vi.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},VU._loadImageComplete=function(Vn,Va,VU){if(!this._destroyed)if(null!=VU)if(VU instanceof ArrayBuffer){var Vx=new DataView(VU);new laya.webgl.resource.WebGLImage(new Uint8Array(VU,8),Vn,0,!1,Vx.getUint32(0),Vx.getUint32(4));this.onloaded()}else if(VU instanceof Vb)VR.imgMgrSet[Vn]=Va,Vp.imgMgrLock(Vn,VR.imgMgrSet[Vn]),this._url=Vn,this._tex=VU,VR.keepCache(this,Vn),VR.cacheRes(Vn,this._tex),this.onloaded();else{var VD=-1!=Vn.indexOf(".png",Vn.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(VU,Vn,VD,!1,VU.width,VU.height);this.onloaded()}else this.event("error","Load image failed")},VV(0,VU,"src",null,function(Vn){(Vn=this.formatURL(Vn),this._url!=Vn)&&(null!=this._tex&&(VR.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=Vn,(this._tex=VR.getRes(Vn))?(VR.keepCache(this,Vn),this.onloaded()):Vp.imgMgrLoad(Vn,this._loadImageComplete.bind(this),2,!1))})})(),function(Vn){function Va(){this.type=null,Va.__super.call(this),this.visible=!1}VQ(Va,"laya.html.dom.HTMLLinkElement",Vn);var VU=Va.prototype;VU._onload=function(Vn){switch(this.type){case"text/css":Vy.parseCSS(Vn,this.URI)}},VV(0,VU,"href",Vn.prototype._$get_href,function(Vn){var Va=this;Vn=this.formatURL(Vn),this.URI=new VP(Vn);var VU=new VR;VU.once("complete",null,function(Vn){Va._onload(Vn)}),VU.load(Vn,"text")}),Va._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(VY),function(Vn){function Va(){Va.__super.call(this),this.visible=!1}VQ(Va,"laya.html.dom.HTMLStyleElement",Vn),VV(0,Va.prototype,"text",Vn.prototype._$get_text,function(Vn){Vy.parseCSS(Vn,null)})}(VY),function(Vn){function Va(){Va.__super.call(this),this._getCSSStyle().valign="middle"}VQ(Va,"laya.html.dom.HTMLIframeElement",Vn),VV(0,Va.prototype,"href",Vn.prototype._$get_href,function(VU){var Vx=this;VU=this.formatURL(VU);var Vn=new VR;Vn.once("complete",null,function(Vn){var Va=Vx.URI;Vx.URI=new VP(VU),Vx.innerHTML=Vn,!Va||(Vx.URI=Va)}),Vn.load(VU,"text")})}(Va)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Vn,Va){"use strict";for(var VU in Object.defineProperty(Va,"__esModule",{value:!0}),Laya){var Vx=Laya[VU];Vx&&Vx.__isclass&&(Va[VU]=Vx)}}),function(VD,Vn,Vm){Vm.un,Vm.uns;var Vx=Vm.static,Vp=Vm.class,VQ=Vm.getset,VU=(Vm.__newvec,laya.display.Animation),Vb=(laya.utils.Browser,laya.utils.ClassUtils),VV=laya.filters.ColorFilter,Vy=laya.utils.Ease,VR=laya.events.Event,VX=(laya.events.EventDispatcher,laya.display.css.Font),Vz=laya.display.FrameAnimation,Va=laya.display.Graphics,Vi=laya.utils.Handler,Vq=laya.display.Input,VA=laya.net.Loader,VE=(laya.display.Node,laya.maths.Point),VP=laya.maths.Rectangle,VT=laya.renders.Render,VK=laya.display.Sprite,VY=laya.display.Text,VW=laya.resource.Texture,Vk=laya.utils.Tween,VN=laya.utils.Utils,V_=laya.utils.WeakObject;Vm.interface("laya.ui.IItem"),Vm.interface("laya.ui.ISelect"),Vm.interface("laya.ui.IRender"),Vm.interface("laya.ui.IComponent"),Vm.interface("laya.ui.IBox","IComponent");var V$=function(){function Vn(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return Vp(Vn,"laya.ui.LayoutStyle"),Vx(Vn,["EMPTY",function(){return this.EMPTY=new Vn}]),Vn}(),VM=function(){function Vn(){}return Vp(Vn,"laya.ui.Styles"),Vn.labelColor="#000000",Vn.buttonStateNum=3,Vn.scrollBarMinNum=15,Vn.scrollBarDelayTime=500,Vx(Vn,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),Vn}(),VZ=function(){function VD(){}return Vp(VD,"laya.ui.UIUtils"),VD.fillArray=function(Vn,Va,VU){var Vx=Vn.concat();if(Va)for(var VD=Va.split(","),Vp=0,VQ=Math.min(Vx.length,VD.length);Vp<VQ;Vp++){var VV=VD[Vp];Vx[Vp]="true"==VV||"false"!=VV&&VV,null!=VU&&(Vx[Vp]=VU(VV))}return Vx},VD.toColor=function(Vn){return VN.toHexColor(Vn)},VD.gray=function(Vn,Va){void 0===Va&&(Va=!0),Va?VD.addFilter(Vn,VD.grayFilter):VD.clearFilter(Vn,VV)},VD.addFilter=function(Vn,Va){var VU=Vn.filters||[];VU.push(Va),Vn.filters=VU},VD.clearFilter=function(Vn,Va){var VU=Vn.filters;if(null!=VU&&0<VU.length){for(var Vx=VU.length-1;-1<Vx;Vx--){var VD=VU[Vx];Vm.__typeof(VD,Va)&&VU.splice(Vx,1)}Vn.filters=VU}},VD._getReplaceStr=function(Vn){return VD.escapeSequence[Vn]},VD.adptString=function(Vn){return Vn.replace(/\\(\w)/g,VD._getReplaceStr)},VD.getBindFun=function(Vn){var Va=VD._funMap.get(Vn);if(null==Va){var VU='"'+Vn+'"',Vx="(function(data){if(data==null)return;with(data){try{\nreturn "+(VU=VU.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";Va=Vm._runScript(Vx),VD._funMap.set(Vn,Va)}return Va},Vx(VD,["grayFilter",function(){return this.grayFilter=new VV([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new V_}]),VD}(),Vu=function(){function Vn(){}return Vp(Vn,"UIConfig"),Vn.touchScrollEnable=!0,Vn.mouseWheelEnable=!0,Vn.showButtons=!0,Vn.popupBgColor="#000000",Vn.popupBgAlpha=.5,Vn.closeDialogOnSide=!0,Vn}(),Vc=function(VU){function VP(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,VP.__super.call(this),this._weakKeys=[]}Vp(VP,"laya.ui.AutoBitmap",VU);var Vn=VP.prototype;return Vn.destroy=function(){if(VA.clearObject(this,this._weakKey),this._weakKeys){for(var Vn=0,Va=this._weakKeys.length;Vn<Va;++Vn)VA.clearObject(this,this._weakKeys[Vn]);this._weakKeys=null}VU.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},Vn._setChanged=function(){this._isChanged||(this._isChanged=!0,Vm.timer.callLater(this,this.changeSource))},Vn.changeSource=function(){this._isChanged=!1;var Vn=this._source;if(Vn&&Vn.bitmap){var Va=this.width,VU=this.height,Vx=this._sizeGrid,VD=Vn.sourceWidth,Vp=Vn.sourceHeight;if(!Vx||VD===Va&&Vp===VU)this.cleanByTexture(Vn,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,Va,VU);else{VA.clearObject(this,this._weakKey),Vn.$_GID||(Vn.$_GID=VN.getGID());var VQ=Vn.$_GID+"."+Va+"."+VU+"."+Vx.join("."),VV=VA.findObject(VQ);if(VN.isOKCmdList(VV))return this._weakKey=VQ,VA.keepObject(this,this._weakKey),void(this.cmds=VV);this.clear();var Vy,VR,VX=Vx[0],Vz=Vx[1],Vi=Vx[2],Vq=Vx[3],VE=Vx[4],Vm=!1;if(Va==VD&&(Vq=Vz=0),VU==Vp&&(VX=Vi=0),Va<Vq+Vz){var Vb=Va;Vm=!0,Va=Vq+Vz,this.save(),this.clipRect(0,0,Vb,VU)}Vq&&VX&&(Vy=VP.getTexture(Vn,0,0,Vq,VX),VR=this._weakKeys[0],Vy?(VR!=Vy.weakKey&&(VA.clearObject(this,VR),VA.keepObject(this,Vy.weakKey),this._weakKeys[0]=Vy.weakKey),this.drawTexture(Vy,0,0,Vq,VX)):(VA.clearObject(this,VR),this._weakKeys[0]="")),Vz&&VX&&(Vy=VP.getTexture(Vn,VD-Vz,0,Vz,VX),VR=this._weakKeys[1],Vy?(VR!=Vy.weakKey&&(VA.clearObject(this,VR),VA.keepObject(this,Vy.weakKey),this._weakKeys[1]=Vy.weakKey),this.drawTexture(Vy,Va-Vz,0,Vz,VX)):(VA.clearObject(this,VR),this._weakKeys[1]="")),Vq&&Vi&&(Vy=VP.getTexture(Vn,0,Vp-Vi,Vq,Vi),VR=this._weakKeys[2],Vy?(VR!=Vy.weakKey&&(VA.clearObject(this,VR),VA.keepObject(this,Vy.weakKey),this._weakKeys[2]=Vy.weakKey),this.drawTexture(Vy,0,VU-Vi,Vq,Vi)):(VA.clearObject(this,VR),this._weakKeys[2]="")),Vz&&Vi&&(Vy=VP.getTexture(Vn,VD-Vz,Vp-Vi,Vz,Vi),VR=this._weakKeys[3],Vy?(VR!=Vy.weakKey&&(VA.clearObject(this,VR),VA.keepObject(this,Vy.weakKey),this._weakKeys[3]=Vy.weakKey),this.drawTexture(Vy,Va-Vz,VU-Vi,Vz,Vi)):(VA.clearObject(this,VR),this._weakKeys[3]="")),VX&&(Vy=VP.getTexture(Vn,Vq,0,VD-Vq-Vz,VX),VR=this._weakKeys[4],Vy?(VR!=Vy.weakKey&&(VA.clearObject(this,VR),VA.keepObject(this,Vy.weakKey),this._weakKeys[4]=Vy.weakKey),this.drawBitmap(VE,Vy,Vq,0,Va-Vq-Vz,VX)):(VA.clearObject(this,VR),this._weakKeys[4]="")),Vi&&(Vy=VP.getTexture(Vn,Vq,Vp-Vi,VD-Vq-Vz,Vi),VR=this._weakKeys[5],Vy?(VR!=Vy.weakKey&&(VA.clearObject(this,VR),VA.keepObject(this,Vy.weakKey),this._weakKeys[5]=Vy.weakKey),this.drawBitmap(VE,Vy,Vq,VU-Vi,Va-Vq-Vz,Vi)):(VA.clearObject(this,VR),this._weakKeys[5]="")),Vq&&(Vy=VP.getTexture(Vn,0,VX,Vq,Vp-VX-Vi),VR=this._weakKeys[6],Vy?(VR!=Vy.weakKey&&(VA.clearObject(this,VR),VA.keepObject(this,Vy.weakKey),this._weakKeys[6]=Vy.weakKey),this.drawBitmap(VE,Vy,0,VX,Vq,VU-VX-Vi)):(VA.clearObject(this,VR),this._weakKeys[6]="")),Vz&&(Vy=VP.getTexture(Vn,VD-Vz,VX,Vz,Vp-VX-Vi),VR=this._weakKeys[7],Vy?(VR!=Vy.weakKey&&(VA.clearObject(this,VR),VA.keepObject(this,Vy.weakKey),this._weakKeys[7]=Vy.weakKey),this.drawBitmap(VE,Vy,Va-Vz,VX,Vz,VU-VX-Vi)):(VA.clearObject(this,VR),this._weakKeys[7]="")),Vy=VP.getTexture(Vn,Vq,VX,VD-Vq-Vz,Vp-VX-Vi),VR=this._weakKeys[8],Vy?(VR!=Vy.weakKey&&(VA.clearObject(this,VR),VA.keepObject(this,Vy.weakKey),this._weakKeys[8]=Vy.weakKey),this.drawBitmap(VE,Vy,Vq,VX,Va-Vq-Vz,VU-VX-Vi)):(VA.clearObject(this,VR),this._weakKeys[8]=""),Vm&&this.restore(),this.autoCacheCmd&&!VT.isConchApp&&(VA.saveObject(VQ,this.cmds,null),this._weakKey=VQ,VA.keepObject(this,this._weakKey))}this._repaint()}},Vn.drawBitmap=function(Vn,Va,VU,Vx,VD,Vp){void 0===VD&&(VD=0),void 0===Vp&&(Vp=0),VD<.1||Vp<.1||(!Vn||Va.width==VD&&Va.height==Vp?this.drawTexture(Va,VU,Vx,VD,Vp):this.fillTexture(Va,VU,Vx,VD,Vp))},Vn.clear=function(Vn){void 0===Vn&&(Vn=!0),VU.prototype.clear.call(this,!1)},VQ(0,Vn,"sizeGrid",function(){return this._sizeGrid},function(Vn){this._sizeGrid=Vn,this._setChanged()}),VQ(0,Vn,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(Vn){this._width!=Vn&&(this._width=Vn,this._setChanged())}),VQ(0,Vn,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(Vn){this._height!=Vn&&(this._height=Vn,this._setChanged())}),VQ(0,Vn,"source",function(){return this._source},function(Vn){Vn?(this._source=Vn,this._setChanged()):(this._source=null,this.clear())}),VP.getTexture=function(Vn,Va,VU,Vx,VD){Vx<=0&&(Vx=1),VD<=0&&(VD=1),Vn.$_GID||(Vn.$_GID=VN.getGID());var Vp=Vn.$_GID+"."+Va+"."+VU+"."+Vx+"."+VD,VQ=VA.findObject(Vp);if((!VQ||!VQ.source)&&(VQ=VW.createFromTexture(Vn,Va,VU,Vx,VD))){if(Vn.alphaTexture){var VV=Vn.width/Vn.alphaTexture.width;VQ.alphaTexture=VW.createFromTexture(Vn.alphaTexture,Va/VV,VU/VV,Vx/VV,VD/VV)}VA.saveObject(Vp,VQ),VQ.weakKey=Vp}return VQ},VP}(Va),VH=(function(Vn){function Va(){Va.__super.call(this)}Vp(Va,"laya.ui.UIEvent",VR),Va.SHOW_TIP="showtip",Va.HIDE_TIP="hidetip"}(),function(Va){function Vn(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,Vn.__super.call(this),this._layout=V$.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}Vp(Vn,"laya.ui.Component",Va);var VU=Vn.prototype;return Vm.imps(VU,{"laya.ui.IComponent":!0}),VU.destroy=function(Vn){void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,Vn),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},VU.preinitialize=function(){},VU.createChildren=function(){},VU.initialize=function(){},VU.callLater=function(Vn,Va){Vm.timer.callLater(this,Vn,Va)},VU.runCallLater=function(Vn){Vm.timer.runCallLater(this,Vn)},VU.commitMeasure=function(){},VU.changeSize=function(){this.event("resize")},VU.getLayout=function(){return this._layout===V$.EMPTY&&(this._layout=new V$),this._layout},VU._setLayoutEnabled=function(Vn){this._layout&&this._layout.enable!=Vn&&(this._layout.enable=Vn,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},VU.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},VU.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},VU.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},VU.resetLayoutX=function(){var Vn=this._layout;if(isNaN(Vn.anchorX)||(this.pivotX=Vn.anchorX*this.width),this.layoutEnabled){var Va=this.parent;Va&&(isNaN(Vn.centerX)?isNaN(Vn.left)?isNaN(Vn.right)||(this.x=Math.round(Va.width-this.displayWidth-Vn.right+this.pivotX*this.scaleX)):(this.x=Math.round(Vn.left+this.pivotX*this.scaleX),isNaN(Vn.right)||(this.width=(Va._width-Vn.left-Vn.right)/(this.scaleX||.01))):this.x=Math.round(.5*(Va.width-this.displayWidth)+Vn.centerX+this.pivotX*this.scaleX))}},VU.resetLayoutY=function(){var Vn=this._layout;if(isNaN(Vn.anchorY)||(this.pivotY=Vn.anchorY*this.height),this.layoutEnabled){var Va=this.parent;Va&&(isNaN(Vn.centerY)?isNaN(Vn.top)?isNaN(Vn.bottom)||(this.y=Math.round(Va.height-this.displayHeight-Vn.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(Vn.top+this.pivotY*this.scaleY),isNaN(Vn.bottom)||(this.height=(Va._height-Vn.top-Vn.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(Va.height-this.displayHeight)+Vn.centerY+this.pivotY*this.scaleY))}},VU.onMouseOver=function(Vn){Vm.stage.event("showtip",this._toolTip)},VU.onMouseOut=function(Vn){Vm.stage.event("hidetip",this._toolTip)},VQ(0,VU,"displayWidth",function(){return this.width*this.scaleX}),VQ(0,VU,"width",function(){return this._width?this._width:this.measureWidth},function(Vn){this._width!=Vn&&(this._width=Vn,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),VQ(0,VU,"measureWidth",function(){var Vn=0;this.commitMeasure();for(var Va=this.numChildren-1;-1<Va;Va--){var VU=this.getChildAt(Va);VU.visible&&(Vn=Math.max(VU.x+VU.width*VU.scaleX,Vn))}return Vn}),VQ(0,VU,"displayHeight",function(){return this.height*this.scaleY}),VQ(0,VU,"height",function(){return this._height?this._height:this.measureHeight},function(Vn){this._height!=Vn&&(this._height=Vn,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),VQ(0,VU,"dataSource",function(){return this._dataSource},function(Vn){for(var Va in this._dataSource=Vn,this._dataSource)this.hasOwnProperty(Va)&&"function"!=typeof this[Va]&&(this[Va]=this._dataSource[Va])}),VQ(0,VU,"scaleY",Va.prototype._$get_scaleY,function(Vn){Vm.superGet(VK,this,"scaleY")!=Vn&&(Vm.superSet(VK,this,"scaleY",Vn),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),VQ(0,VU,"measureHeight",function(){var Vn=0;this.commitMeasure();for(var Va=this.numChildren-1;-1<Va;Va--){var VU=this.getChildAt(Va);VU.visible&&(Vn=Math.max(VU.y+VU.height*VU.scaleY,Vn))}return Vn}),VQ(0,VU,"scaleX",Va.prototype._$get_scaleX,function(Vn){Vm.superGet(VK,this,"scaleX")!=Vn&&(Vm.superSet(VK,this,"scaleX",Vn),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),VQ(0,VU,"top",function(){return this._layout.top},function(Vn){Vn!=this._layout.top&&(this.getLayout().top=Vn,this._setLayoutEnabled(!0)),this.resetLayoutY()}),VQ(0,VU,"bottom",function(){return this._layout.bottom},function(Vn){Vn!=this._layout.bottom&&(this.getLayout().bottom=Vn,this._setLayoutEnabled(!0)),this.resetLayoutY()}),VQ(0,VU,"left",function(){return this._layout.left},function(Vn){Vn!=this._layout.left&&(this.getLayout().left=Vn,this._setLayoutEnabled(!0)),this.resetLayoutX()}),VQ(0,VU,"right",function(){return this._layout.right},function(Vn){Vn!=this._layout.right&&(this.getLayout().right=Vn,this._setLayoutEnabled(!0)),this.resetLayoutX()}),VQ(0,VU,"centerX",function(){return this._layout.centerX},function(Vn){Vn!=this._layout.centerX&&(this.getLayout().centerX=Vn,this._setLayoutEnabled(!0)),this.resetLayoutX()}),VQ(0,VU,"centerY",function(){return this._layout.centerY},function(Vn){Vn!=this._layout.centerY&&(this.getLayout().centerY=Vn,this._setLayoutEnabled(!0)),this.resetLayoutY()}),VQ(0,VU,"anchorX",function(){return this._layout.anchorX},function(Vn){Vn!=this._layout.anchorX&&(this.getLayout().anchorX=Vn,this._setLayoutEnabled(!0)),this.resetLayoutX()}),VQ(0,VU,"anchorY",function(){return this._layout.anchorY},function(Vn){Vn!=this._layout.anchorY&&(this.getLayout().anchorY=Vn,this._setLayoutEnabled(!0)),this.resetLayoutY()}),VQ(0,VU,"tag",function(){return this._tag},function(Vn){this._tag=Vn}),VQ(0,VU,"toolTip",function(){return this._toolTip},function(Vn){this._toolTip!=Vn&&(null!=(this._toolTip=Vn)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),VQ(0,VU,"comXml",function(){return this._comXml},function(Vn){this._comXml=Vn}),VQ(0,VU,"gray",function(){return this._gray},function(Vn){Vn!==this._gray&&(this._gray=Vn,VZ.gray(this,Vn))}),VQ(0,VU,"disabled",function(){return this._disabled},function(Vn){Vn!==this._disabled&&(this.gray=this._disabled=Vn,this.mouseEnabled=!Vn)}),Vn}(VK)),VG=function(Vn){function Va(){this.lockLayer=null,this.popupEffect=function(Vn){Vn.scale(1,1),Vk.from(Vn,{x:Vm.stage.width/2,y:Vm.stage.height/2,scaleX:0,scaleY:0},300,Vy.backOut,Vi.create(this,this.doOpen,[Vn]))},this.closeEffect=function(Vn,Va){Vk.to(Vn,{x:Vm.stage.width/2,y:Vm.stage.height/2,scaleX:0,scaleY:0},300,Vy.strongOut,Vi.create(this,this.doClose,[Vn,Va]))},Va.__super.call(this),this.maskLayer=new VK,this.popupEffectHandler=Vi.create(this,this.popupEffect,null,!1),this.closeEffectHandler=Vi.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,Vm.stage.addChild(this),Vm.stage.on("resize",this,this._onResize),Vu.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}Vp(Va,"laya.ui.DialogManager",VK);var VU=Va.prototype;return VU._closeOnSide=function(){var Vn=this.getChildAt(this.numChildren-1);Vn instanceof laya.ui.Dialog&&Vn.close("side")},VU.setLockView=function(Vn){this.lockLayer||(this.lockLayer=new VI,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(Vm.stage.width,Vm.stage.height)),this.lockLayer.removeChildren(),Vn&&(Vn.centerX=Vn.centerY=0,this.lockLayer.addChild(Vn))},VU._onResize=function(Vn){var Va=this.maskLayer.width=Vm.stage.width,VU=this.maskLayer.height=Vm.stage.height;this.lockLayer&&this.lockLayer.size(Va,VU),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,Va,VU,Vu.popupBgColor),this.maskLayer.alpha=Vu.popupBgAlpha;for(var Vx=this.numChildren-1;-1<Vx;Vx--){var VD=this.getChildAt(Vx);VD.popupCenter&&this._centerDialog(VD)}},VU._centerDialog=function(Vn){Vn.x=Math.round((Vm.stage.width-Vn.width>>1)+Vn.pivotX),Vn.y=Math.round((Vm.stage.height-Vn.height>>1)+Vn.pivotY)},VU.open=function(Vn,Va,VU){void 0===Va&&(Va=!1),void 0===VU&&(VU=!1),Va&&this._closeAll(),Vn.popupCenter&&this._centerDialog(Vn),this.addChild(Vn),(Vn.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),VU&&null!=Vn.popupEffect?Vn.popupEffect.runWith(Vn):this.doOpen(Vn),this.event("open")},VU.doOpen=function(Vn){Vn.onOpened()},VU.lock=function(Vn){this.lockLayer&&(Vn?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},VU.close=function(Vn,Va,VU){void 0===VU&&(VU=!1),VU&&null!=Vn.closeEffect?Vn.closeEffect.runWith([Vn,Va]):this.doClose(Vn,Va),this.event("close")},VU.doClose=function(Vn,Va){Vn.removeSelf(),Vn.isModal&&this._checkMask(),Vn.closeHandler&&Vn.closeHandler.runWith(Va),Vn.onClosed(Va)},VU.closeAll=function(){this._closeAll(),this.event("close")},VU._closeAll=function(){for(var Vn=this.numChildren-1;-1<Vn;Vn--){var Va=this.getChildAt(Vn);Va&&null!=Va.close&&this.doClose(Va)}},VU.getDialogsByGroup=function(Vn){for(var Va=[],VU=this.numChildren-1;-1<VU;VU--){var Vx=this.getChildAt(VU);Vx&&Vx.group===Vn&&Va.push(Vx)}return Va},VU.closeByGroup=function(Vn){for(var Va=[],VU=this.numChildren-1;-1<VU;VU--){var Vx=this.getChildAt(VU);Vx&&Vx.group===Vn&&(Vx.close(),Va.push(Vx))}return Va},VU._checkMask=function(){this.maskLayer.removeSelf();for(var Vn=this.numChildren-1;-1<Vn;Vn--){var Va=this.getChildAt(Vn);if(Va&&Va.isModal)return void this.addChildAt(this.maskLayer,Vn)}},Va}(),VI=function(Vn){function Va(){Va.__super.call(this)}Vp(Va,"laya.ui.Box",Vn);var VU=Va.prototype;return Vm.imps(VU,{"laya.ui.IBox":!0}),VQ(0,VU,"dataSource",Vn.prototype._$get_dataSource,function(Vn){for(var Va in this._dataSource=Vn){var VU=this.getChildByName(Va);VU?VU.dataSource=Vn[Va]:this.hasOwnProperty(Va)&&"function"!=typeof this[Va]&&(this[Va]=Vn[Va])}}),Va}(VH),Vv=function(Va){function VU(Vn,Va){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,VU.__super.call(this),this._labelColors=VM.buttonLabelColors,this._stateNum=VM.buttonStateNum,void 0===Va&&(Va=""),this.skin=Vn,this.label=Va}Vp(VU,"laya.ui.Button",Va);var Vn=VU.prototype;return Vm.imps(Vn,{"laya.ui.ISelect":!0}),Vn.destroy=function(Vn){this.clearEvent(),VA.clearCache(this,this._skin),VA.clearObject(this,this._weakKey),void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,Vn),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(Vn),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},Vn.clearEvent=function(){this._skin&&VD.atalsNotify&&VD.atalsNotify.off(this._skin,this,this._setBtnSource)},Vn.createChildren=function(){this.graphics=this._bitmap=new Vc},Vn.createText=function(){this._text||(this._text=new VY,this._text.overflow=VY.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},Vn.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},Vn.onMouse=function(Vn){if(!1!==this.toggle||!this._selected)return"click"===Vn.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=VU.stateMap[Vn.type]))},Vn.changeClips=function(){var Vn=VA.getRes(this._skin);if(Vn)if(this._skin&&""!=this._skin){VA.clearObject(this,this._weakKey);var Va=Vn.sourceWidth,VU=Vn.sourceHeight/this._stateNum;Vn.$_GID||(Vn.$_GID=VN.getGID());var Vx=Vn.$_GID+"-"+this._stateNum,VD=VA.findObject(Vx);if(VN.isOkTextureList(VD)||(VD=null),VD)this._weakKey=Vx,VA.keepObject(this,this._weakKey),this._sources=VD;else{if(this._sources=[],1===this._stateNum)this._sources.push(Vn);else for(var Vp=0;Vp<this._stateNum;Vp++){var VQ=VW.createFromTexture(Vn,0,VU*Vp,Va,VU);if(Vn.alphaTexture){var VV=Vn.width/Vn.alphaTexture.width;VQ.alphaTexture=VW.createFromTexture(Vn.alphaTexture,0/VV,VU*Vp/VV,Va/VV,VU/VV)}this._sources.push(VQ)}VA.saveObject(Vx,this._sources),this._weakKey=Vx,VA.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||Va,this._bitmap.height=this._height||VU,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=Va)}else console.warn("lose skin ",this._skin,this.name,this.__className)},Vn.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var Vn=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[Vn]),this.label&&(this._text.color=this._labelColors[Vn],this._strokeColors&&(this._text.strokeColor=this._strokeColors[Vn]))},Vn._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},VQ(0,Vn,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(Vn){this.createText(),this._text.strokeColor=Vn}),VQ(0,Vn,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),VQ(0,Vn,"skin",function(){return this._skin},function(Vn){if(this._skin!=Vn)if(this.clearEvent(),VA.clearCache(this,this._skin),this._skin=Vn,VA.keepCache(this,this._skin),VA.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var Va=VD.resAtalsObj&&VD.resAtalsObj[this._skin];Va?(VD.atalsNotify&&VD.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=Va.sourceW),0==this.height&&(this.height=Va.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),Vn._setBtnSource=function(Vn,Va){Vn===this._skin&&Va&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},VQ(0,Vn,"state",function(){return this._state},function(Vn){this._state!=Vn&&(this._state=Vn,this._setStateChanged())}),VQ(0,Vn,"text",function(){return this.createText(),this._text}),VQ(0,Vn,"stateNum",function(){return this._stateNum},function(Vn){"string"==typeof Vn&&(Vn=parseInt(Vn)),this._stateNum!=Vn&&(this._stateNum=Vn<1?1:3<Vn?3:Vn,this.callLater(this.changeClips))}),VQ(0,Vn,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(Vn){this._strokeColors=VZ.fillArray(VM.buttonLabelColors,Vn,String),this._setStateChanged()}),VQ(0,Vn,"labelColors",function(){return this._labelColors.join(",")},function(Vn){this._labelColors=VZ.fillArray(VM.buttonLabelColors,Vn,String),this._setStateChanged()}),VQ(0,Vn,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),VQ(0,Vn,"label",function(){return this._text?this._text.text:null},function(Vn){(this._text||Vn)&&(this.createText(),this._text.text!=Vn&&(Vn&&!this._text.parent&&this.addChild(this._text),this._text.text=(Vn+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),VQ(0,Vn,"selected",function(){return this._selected},function(Vn){this._selected!=Vn&&(this._selected=Vn,this.state=this._selected?2:0,this.event("change"))}),VQ(0,Vn,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(Vn){this.createText(),this._text.padding=VZ.fillArray(VM.labelPadding,Vn,Number)}),VQ(0,Vn,"labelSize",function(){return this.createText(),this._text.fontSize},function(Vn){this.createText(),this._text.fontSize=Vn}),VQ(0,Vn,"labelStroke",function(){return this.createText(),this._text.stroke},function(Vn){this.createText(),this._text.stroke=Vn}),VQ(0,Vn,"labelBold",function(){return this.createText(),this._text.bold},function(Vn){this.createText(),this._text.bold=Vn}),VQ(0,Vn,"labelFont",function(){return this.createText(),this._text.font},function(Vn){this.createText(),this._text.font=Vn}),VQ(0,Vn,"labelAlign",function(){return this.createText(),this._text.align},function(Vn){this.createText(),this._text.align=Vn}),VQ(0,Vn,"clickHandler",function(){return this._clickHandler},function(Vn){this._clickHandler=Vn}),VQ(0,Vn,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Vn){this._bitmap.sizeGrid=VZ.fillArray(VM.defaultSizeGrid,Vn,Number)}),VQ(0,Vn,"width",Va.prototype._$get_width,function(Vn){Vm.superSet(VH,this,"width",Vn),this._autoSize&&(this._bitmap.width=Vn,this._text&&(this._text.width=Vn))}),VQ(0,Vn,"height",Va.prototype._$get_height,function(Vn){Vm.superSet(VH,this,"height",Vn),this._autoSize&&(this._bitmap.height=Vn,this._text&&(this._text.height=Vn))}),VQ(0,Vn,"dataSource",Va.prototype._$get_dataSource,function(Vn){"number"==typeof(this._dataSource=Vn)||"string"==typeof Vn?this.label=Vn+"":Vm.superSet(VH,this,"dataSource",Vn)}),VQ(0,Vn,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(Vn){this._bitmap._offset=Vn?VZ.fillArray([1,1],Vn,Number):[]}),Vx(VU,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),VU}(VH),Vl=function(Va){function Vx(Vn,Va,VU){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,Vx.__super.call(this),void 0===Va&&(Va=1),void 0===VU&&(VU=1),this._clipX=Va,this._clipY=VU,this.skin=Vn}Vp(Vx,"laya.ui.Clip",Va);var Vn=Vx.prototype;return Vn.destroy=function(Vn){this.clearEvent(),this.clearLoad(),VA.clearCache(this,this._skin),VA.clearObject(this,this._weakKey),void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},Vn.dispose=function(){this.destroy(!0),Vm.loader.clearRes(this._skin)},Vn.createChildren=function(){this.graphics=this._bitmap=new Vc},Vn._onDisplay=function(Vn){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},Vn.changeClip=function(){if(this._clipChanged=!1,this._skin){var Vn=VA.getRes(this._skin);if(Vn)this.loadComplete(this._skin,Vn);else{if(VD.resAtalsObj&&VD.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=Vi.create(this,this.loadComplete,[this._skin]),this._progress=null,Vm.loader.load(this._skin,this._complete,this._progress)}}},Vn.loadComplete=function(Vn,Va){if(Vn===this._skin&&Va){VA.clearObject(this,this._weakKey);var VU=this._clipWidth||Math.ceil(Va.sourceWidth/this._clipX),Vx=this._clipHeight||Math.ceil(Va.sourceHeight/this._clipY),VD=this._skin+VU+Vx,Vp=VA.findObject(VD);if(VN.isOkTextureList(Vp)||(Vp=null),Vp)this._weakKey=VD,VA.keepObject(this,this._weakKey),this._sources=Vp;else{this._sources=[];for(var VQ=0;VQ<this._clipY;VQ++)for(var VV=0;VV<this._clipX;VV++){var Vy=VW.createFromTexture(Va,VU*VV,Vx*VQ,VU,Vx);if(Va.alphaTexture){var VR=Va.width/Va.alphaTexture.width;Vy.alphaTexture=VW.createFromTexture(Va.alphaTexture,VU*VV/VR,Vx*VQ/VR,VU/VR,Vx/VR)}this._sources.push(Vy)}VA.saveObject(VD,this._sources),this._weakKey=VD,VA.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},Vn.play=function(Vn,Va){void 0===Vn&&(Vn=0),void 0===Va&&(Va=-1),this._isPlaying=!0,this.index=Vn,this._toIndex=Va,this._index++,Vm.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},Vn._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},Vn.stop=function(){this._isPlaying=!1,Vm.timer.clear(this,this._loop),this.event("complete")},Vn._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},VQ(0,Vn,"interval",function(){return this._interval},function(Vn){this._interval!=Vn&&(this._interval=Vn,this._isPlaying&&this.play())}),Vn.clearEvent=function(){this._skin&&VD.atalsNotify&&VD.atalsNotify.off(this._skin,this,this._setBtnSource)},Vn.clearLoad=function(){this._skin&&((this._complete||this._progress)&&Vm.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},VQ(0,Vn,"skin",function(){return this._skin},function(Vn){if(this._skin!=Vn)if(this.clearLoad(),this.clearEvent(),VA.clearCache(this,this._skin),this._skin=Vn){VA.keepCache(this,this._skin);var Va=VA.getRes(Vn),VU=VD.resAtalsObj&&VD.resAtalsObj[this._skin];!Va&&VU?VD.atalsNotify&&VD.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),Vn._setBtnSource=function(Vn,Va){Vn===this._skin&&Va&&(this.loadComplete(Vn,Va),this.clearEvent())},VQ(0,Vn,"sources",function(){return this._sources},function(Vn){this._sources=Vn,this.index=this._index,this.event("loaded")}),VQ(0,Vn,"clipX",function(){return this._clipX},function(Vn){this._clipX=Vn||1,this._setClipChanged()}),VQ(0,Vn,"clipY",function(){return this._clipY},function(Vn){this._clipY=Vn||1,this._setClipChanged()}),VQ(0,Vn,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),VQ(0,Vn,"clipWidth",function(){return this._clipWidth},function(Vn){this._clipWidth=Vn,this._setClipChanged()}),VQ(0,Vn,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Vn){this._bitmap.sizeGrid=VZ.fillArray(VM.defaultSizeGrid,Vn,Number)}),VQ(0,Vn,"group",function(){return this._group},function(Vn){Vn&&this._skin&&VA.setGroup(this._skin,Vn),this._group=Vn}),VQ(0,Vn,"clipHeight",function(){return this._clipHeight},function(Vn){this._clipHeight=Vn,this._setClipChanged()}),VQ(0,Vn,"width",Va.prototype._$get_width,function(Vn){Vm.superSet(VH,this,"width",Vn),this._bitmap.width=Vn}),VQ(0,Vn,"height",Va.prototype._$get_height,function(Vn){Vm.superSet(VH,this,"height",Vn),this._bitmap.height=Vn}),VQ(0,Vn,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),VQ(0,Vn,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),VQ(0,Vn,"index",function(){return this._index},function(Vn){this._index=Vn,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[Vn]),this.event("change")}),VQ(0,Vn,"autoPlay",function(){return this._autoPlay},function(Vn){this._autoPlay!=Vn&&((this._autoPlay=Vn)?this.play():this.stop())}),VQ(0,Vn,"isPlaying",function(){return this._isPlaying},function(Vn){this._isPlaying=Vn}),VQ(0,Vn,"dataSource",Va.prototype._$get_dataSource,function(Vn){"number"==typeof(this._dataSource=Vn)&&Math.floor(Vn)==Vn||"string"==typeof Vn?this.index=parseInt(Vn):Vm.superSet(VH,this,"dataSource",Vn)}),VQ(0,Vn,"bitmap",function(){return this._bitmap}),Vx}(VH),Vj=function(Va){function Vn(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,Vn.__super.call(this)}Vp(Vn,"laya.ui.ColorPicker",Va);var VU=Vn.prototype;return VU.destroy=function(Vn){void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,Vn),this._colorPanel&&this._colorPanel.destroy(Vn),this._colorButton&&this._colorButton.destroy(Vn),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},VU.createChildren=function(){this.addChild(this._colorButton=new Vv),this._colorPanel=new VI,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new VK),this._colorPanel.addChild(this._colorBlock=new VK),this._colorPanel.addChild(this._colorInput=new Vq)},VU.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},VU.onPanelMouseDown=function(Vn){Vn.stopPropagation()},VU.changePanel=function(){this._panelChanged=!1;var Vn=this._colorPanel.graphics;Vn.clear(),Vn.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(Vn=this._colorTiles.graphics).clear();for(var Va=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],VU=0;VU<12;VU++)for(var Vx=0;Vx<20;Vx++){var VD=0;VD=0===Vx?Va[VU]:1===Vx?0:51*(((3*VU+Vx/6)%3<<0)+3*(VU/6<<0))<<16|Vx%6*51<<8|(VU<<0)%6*51;var Vp=VZ.toColor(VD);this._colors.push(Vp);var VQ=Vx*this._gridSize,VV=VU*this._gridSize;Vn.drawRect(VQ,VV,this._gridSize,this._gridSize,Vp,"#000000")}},VU.onColorButtonClick=function(Vn){this._colorPanel.parent?this.close():this.open()},VU.open=function(){var Vn=this.localToGlobal(new VE),Va=Vn.x+this._colorPanel.width<=Vm.stage.width?Vn.x:Vm.stage.width-this._colorPanel.width,VU=Vn.y+this._colorButton.height;VU=VU+this._colorPanel.height<=Vm.stage.height?VU:Vn.y-this._colorPanel.height,this._colorPanel.pos(Va,VU),this._colorPanel.zOrder=1001,Vm._currentStage.addChild(this._colorPanel),Vm.stage.on("mousedown",this,this.removeColorBox)},VU.close=function(){Vm.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},VU.removeColorBox=function(Vn){this.close()},VU.onColorFieldKeyDown=function(Vn){13==Vn.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),Vn.stopPropagation())},VU.onColorInputChange=function(Vn){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},VU.onColorTilesClick=function(Vn){this.selectedColor=this.getColorByMouse(),this.close()},VU.onColorTilesMouseMove=function(Vn){this._colorInput.focus=!1;var Va=this.getColorByMouse();this._colorInput.text=Va,this.drawBlock(Va)},VU.getColorByMouse=function(){var Vn=this._colorTiles.getMousePoint(),Va=Math.floor(Vn.x/this._gridSize),VU=Math.floor(Vn.y/this._gridSize);return this._colors[20*VU+Va]},VU.drawBlock=function(Vn){var Va=this._colorBlock.graphics;Va.clear();var VU=Vn||"#ffffff";Va.drawRect(0,0,50,20,VU,this._borderColor),Vn||Va.drawLine(0,0,50,20,"#ff0000")},VU.changeColor=function(){var Vn=this.graphics;Vn.clear();var Va=this._selectedColor||"#000000";Vn.drawRect(0,0,this._colorButton.width,this._colorButton.height,Va)},VU._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},VQ(0,VU,"inputBgColor",function(){return this._inputBgColor},function(Vn){this._inputBgColor=Vn,this._setPanelChanged()}),VQ(0,VU,"selectedColor",function(){return this._selectedColor},function(Vn){this._selectedColor!=Vn&&(this._selectedColor=this._colorInput.text=Vn,this.drawBlock(Vn),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",VR.EMPTY.setTo("change",this,this)))}),VQ(0,VU,"skin",function(){return this._colorButton.skin},function(Vn){this._colorButton.skin=Vn,this.changeColor()}),VQ(0,VU,"bgColor",function(){return this._bgColor},function(Vn){this._bgColor=Vn,this._setPanelChanged()}),VQ(0,VU,"borderColor",function(){return this._borderColor},function(Vn){this._borderColor=Vn,this._setPanelChanged()}),VQ(0,VU,"inputColor",function(){return this._inputColor},function(Vn){this._inputColor=Vn,this._setPanelChanged()}),Vn}(VH),Vh=function(Va){function VU(Vn,Va){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,VU.__super.call(this),this._itemColors=VM.comboBoxItemColors,this.skin=Vn,this.labels=Va}Vp(VU,"laya.ui.ComboBox",Va);var Vn=VU.prototype;return Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,Vn),this._button&&this._button.destroy(Vn),this._list&&this._list.destroy(Vn),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},Vn.createChildren=function(){this.addChild(this._button=new Vv),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},Vn._createList=function(){this._list=new Vw,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},Vn._setListEvent=function(Vn){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=Vi.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},Vn.onListDown=function(Vn){Vn.stopPropagation()},Vn.onScrollBarDown=function(Vn){Vn.stopPropagation()},Vn.onButtonMouseDown=function(Vn){this.callLater(this.switchTo,[!this._isOpen])},Vn.changeList=function(){this._listChanged=!1;var Vn=this.width-2,Va=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:Vn,height:this._itemHeight,fontSize:this._itemSize,color:Va}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},Vn.onlistItemMouse=function(Vn,Va){var VU=Vn.type;if("mouseover"===VU||"mouseout"===VU){if(this._isCustomList)return;var Vx=this._list.getCell(Va);if(!Vx)return;var VD=Vx.getChildByName("label");VD&&("mouseover"===VU?(VD.bgColor=this._itemColors[0],VD.color=this._itemColors[1]):(VD.bgColor=null,VD.color=this._itemColors[2]))}else"click"===VU&&(this.selectedIndex=Va,this.isOpen=!1)},Vn.switchTo=function(Vn){this.isOpen=Vn},Vn.changeOpen=function(){this.isOpen=!this._isOpen},Vn.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var Vn=this._list.graphics;Vn.clear(),Vn.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var Va=this._list.array||[],VU=Va.length=0,Vx=this._labels.length;VU<Vx;VU++)Va.push({label:this._labels[VU]});this._list.height=this._listHeight,this._list.array=Va},Vn.changeSelected=function(){this._button.label=this.selectedLabel},Vn._onStageMouseWheel=function(Vn){this._list&&!this._list.contains(Vn.target)&&this.removeList(null)},Vn.removeList=function(Vn){Vm.stage.off("mousedown",this,this.removeList),Vm.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},VQ(0,Vn,"selectedIndex",function(){return this._selectedIndex},function(Vn){this._selectedIndex!=Vn&&(this._selectedIndex=Vn,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[VR.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),VQ(0,Vn,"measureHeight",function(){return this._button.height}),VQ(0,Vn,"skin",function(){return this._button.skin},function(Vn){this._button.skin!=Vn&&(this._button.skin=Vn,this._listChanged=!0)}),VQ(0,Vn,"measureWidth",function(){return this._button.width}),VQ(0,Vn,"width",Va.prototype._$get_width,function(Vn){Vm.superSet(VH,this,"width",Vn),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),VQ(0,Vn,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(Vn){this.selectedIndex=this._labels.indexOf(Vn)}),VQ(0,Vn,"labels",function(){return this._labels.join(",")},function(Vn){0<this._labels.length&&(this.selectedIndex=-1),Vn?this._labels=Vn.split(","):this._labels.length=0,this._itemChanged=!0}),VQ(0,Vn,"height",Va.prototype._$get_height,function(Vn){Vm.superSet(VH,this,"height",Vn),this._button.height=this._height}),VQ(0,Vn,"selectHandler",function(){return this._selectHandler},function(Vn){this._selectHandler=Vn}),VQ(0,Vn,"visibleNum",function(){return this._visibleNum},function(Vn){this._visibleNum=Vn,this._listChanged=!0}),VQ(0,Vn,"labelBold",function(){return this._button.text.bold},function(Vn){this._button.text.bold=Vn}),VQ(0,Vn,"itemColors",function(){return String(this._itemColors)},function(Vn){this._itemColors=VZ.fillArray(this._itemColors,Vn,String),this._listChanged=!0}),VQ(0,Vn,"itemSize",function(){return this._itemSize},function(Vn){this._itemSize=Vn,this._listChanged=!0}),VQ(0,Vn,"scrollBar",function(){return this.list.scrollBar}),VQ(0,Vn,"isOpen",function(){return this._isOpen},function(Vn){if(this._isOpen!=Vn)if(this._isOpen=Vn,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var Va=this.localToGlobal(VE.TEMP.setTo(0,0)),VU=Va.y+this._button.height;VU=VU+this._listHeight<=Vm.stage.height?VU:Va.y-this._listHeight,this._list.pos(Va.x,VU),this._list.zOrder=1001,Vm._currentStage.addChild(this._list),Vm.stage.once("mousedown",this,this.removeList),Vm.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),VQ(0,Vn,"scrollBarSkin",function(){return this._scrollBarSkin},function(Vn){this._scrollBarSkin=Vn}),VQ(0,Vn,"sizeGrid",function(){return this._button.sizeGrid},function(Vn){this._button.sizeGrid=Vn}),VQ(0,Vn,"button",function(){return this._button}),VQ(0,Vn,"list",function(){return this._list||this._createList(),this._list},function(Vn){Vn&&(Vn.removeSelf(),this._isCustomList=!0,this._list=Vn,this._setListEvent(Vn),this._itemHeight=Vn.getCell(0).height+Vn.spaceY)}),VQ(0,Vn,"dataSource",Va.prototype._$get_dataSource,function(Vn){"number"==typeof(this._dataSource=Vn)&&Math.floor(Vn)==Vn||"string"==typeof Vn?this.selectedIndex=parseInt(Vn):Vn instanceof Array?this.labels=Vn.join(","):Vm.superSet(VH,this,"dataSource",Vn)}),VQ(0,Vn,"labelColors",function(){return this._button.labelColors},function(Vn){this._button.labelColors!=Vn&&(this._button.labelColors=Vn)}),VQ(0,Vn,"labelPadding",function(){return this._button.text.padding.join(",")},function(Vn){this._button.text.padding=VZ.fillArray(VM.labelPadding,Vn,Number)}),VQ(0,Vn,"labelSize",function(){return this._button.text.fontSize},function(Vn){this._button.text.fontSize=Vn}),VQ(0,Vn,"labelFont",function(){return this._button.text.font},function(Vn){this._button.text.font=Vn}),VQ(0,Vn,"stateNum",function(){return this._button.stateNum},function(Vn){this._button.stateNum=Vn}),VU}(VH),Vf=function(Va){function VU(Vn){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,VU.__super.call(this),this._showButtons=Vu.showButtons,this._touchScrollEnable=Vu.touchScrollEnable,this._mouseWheelEnable=Vu.mouseWheelEnable,this.skin=Vn,this.max=1}Vp(VU,"laya.ui.ScrollBar",Va);var Vn=VU.prototype;return Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),this.stopScroll(),this.target=null,Va.prototype.destroy.call(this,Vn),this.upButton&&this.upButton.destroy(Vn),this.downButton&&this.downButton.destroy(Vn),this.slider&&this.slider.destroy(Vn),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},Vn.createChildren=function(){this.addChild(this.slider=new VF),this.addChild(this.upButton=new Vv),this.addChild(this.downButton=new Vv)},Vn.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},Vn.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},Vn.onButtonMouseDown=function(Vn){var Va=Vn.currentTarget===this.upButton;this.slide(Va),Vm.timer.once(VM.scrollBarDelayTime,this,this.startLoop,[Va]),Vm.stage.once("mouseup",this,this.onStageMouseUp)},Vn.startLoop=function(Vn){Vm.timer.frameLoop(1,this,this.slide,[Vn])},Vn.slide=function(Vn){Vn?this.value-=this._scrollSize:this.value+=this._scrollSize},Vn.onStageMouseUp=function(Vn){Vm.timer.clear(this,this.startLoop),Vm.timer.clear(this,this.slide)},Vn.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},Vn.changeSize=function(){Va.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},Vn.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},Vn.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},Vn.setScroll=function(Vn,Va,VU){this.runCallLater(this.changeSize),this.slider.setSlider(Vn,Va,VU),this.slider.bar.visible=0<Va,!this._hide&&this.autoHide&&(this.visible=!1)},Vn.onTargetMouseWheel=function(Vn){this.value-=Vn.delta*this._scrollSize,this.target=this._target},Vn.onTargetMouseDown=function(Vn){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new VE),this._lastPoint.setTo(Vm.stage.mouseX,Vm.stage.mouseY),Vm.timer.clear(this,this.tweenMove),Vk.clearTween(this),Vm.stage.once("mouseup",this,this.onStageMouseUp2),Vm.stage.once("mouseout",this,this.onStageMouseUp2),Vm.timer.frameLoop(1,this,this.loop)},Vn.loop=function(){var Vn=Vm.stage.mouseY,Va=Vm.stage.mouseX;if(this._lastOffset=this.isVertical?Vn-this._lastPoint.y:Va-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?Vm.stage._canvasTransform.getScaleY():Vm.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=Va,this._lastPoint.y=Vn,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},Vn.onStageMouseUp2=function(Vn){if(Vm.stage.off("mouseup",this,this.onStageMouseUp2),Vm.stage.off("mouseout",this,this.onStageMouseUp2),Vm.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?Vk.to(this,{value:this.min},this.elasticBackTime,Vy.sineOut,Vi.create(this,this.elasticOver)):this._value>this.max&&Vk.to(this,{value:this.max},this.elasticBackTime,Vy.sineOut,Vi.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?Vm.stage.mouseY-this._lastPoint.y:Vm.stage.mouseX-this._lastPoint.x);for(var Va=0,VU=Math.min(this._offsets.length,3),Vx=0;Vx<VU;Vx++)Va+=this._offsets[this._offsets.length-1-Vx];if(this._lastOffset=Va/VU,(Va=Math.abs(this._lastOffset))<2)return void this.event("end");60<Va&&(this._lastOffset=0<this._lastOffset?60:-60);var VD=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));Vm.timer.frameLoop(1,this,this.tweenMove,[VD])}},Vn.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&Vk.to(this,{alpha:0},500),this.event("end")},Vn.tweenMove=function(Vn){this._lastOffset*=this.rollRatio;var Va=NaN;if(0<Vn&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,Va=.5*-(this.min-Vn-this.value),this._lastOffset>Va&&(this._lastOffset=Va)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,Va=.5*-(this.max+Vn-this.value),this._lastOffset<Va&&(this._lastOffset=Va))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(Vm.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?Vk.to(this,{value:this.min},this.elasticBackTime,Vy.sineOut,Vi.create(this,this.elasticOver)):this._value>this.max?Vk.to(this,{value:this.max},this.elasticBackTime,Vy.sineOut,Vi.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&Vk.to(this,{alpha:0},500)}},Vn.stopScroll=function(){this.onStageMouseUp2(null),Vm.timer.clear(this,this.tweenMove),Vk.clearTween(this)},VQ(0,Vn,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),VQ(0,Vn,"skin",function(){return this._skin},function(Vn){this._skin!=Vn&&(this._skin=Vn,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),VQ(0,Vn,"max",function(){return this.slider.max},function(Vn){this.slider.max=Vn}),VQ(0,Vn,"showButtons",function(){return this._showButtons},function(Vn){this._showButtons=Vn,this.callLater(this.changeScrollBar)}),VQ(0,Vn,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),VQ(0,Vn,"min",function(){return this.slider.min},function(Vn){this.slider.min=Vn}),VQ(0,Vn,"value",function(){return this._value},function(Vn){Vn!==this._value&&(this._value=Vn,this._isElastic||(this.slider._value!=Vn&&(this.slider._value=Vn,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),VQ(0,Vn,"isVertical",function(){return this.slider.isVertical},function(Vn){this.slider.isVertical=Vn}),VQ(0,Vn,"sizeGrid",function(){return this.slider.sizeGrid},function(Vn){this.slider.sizeGrid=Vn}),VQ(0,Vn,"scrollSize",function(){return this._scrollSize},function(Vn){this._scrollSize=Vn}),VQ(0,Vn,"dataSource",Va.prototype._$get_dataSource,function(Vn){"number"==typeof(this._dataSource=Vn)||"string"==typeof Vn?this.value=Number(Vn):Vm.superSet(VH,this,"dataSource",Vn)}),VQ(0,Vn,"thumbPercent",function(){return this._thumbPercent},function(Vn){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),Vn=1<=Vn?.99:Vn,this._thumbPercent=Vn,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*Vn,VM.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*Vn,VM.scrollBarMinNum))}),VQ(0,Vn,"target",function(){return this._target},function(Vn){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=Vn)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),VQ(0,Vn,"hide",function(){return this._hide},function(Vn){this._hide=Vn,this.visible=!Vn}),VQ(0,Vn,"touchScrollEnable",function(){return this._touchScrollEnable},function(Vn){this._touchScrollEnable=Vn,this.target=this._target}),VQ(0,Vn,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(Vn){this._mouseWheelEnable=Vn,this.target=this._target}),VQ(0,Vn,"tick",function(){return this.slider.tick},function(Vn){this.slider.tick=Vn}),VU}(VH),VF=function(Va){function VU(Vn){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,VU.__super.call(this),this.skin=Vn}Vp(VU,"laya.ui.Slider",Va);var Vn=VU.prototype;return Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,Vn),this._bg&&this._bg.destroy(Vn),this._bar&&this._bar.destroy(Vn),this._progress&&this._progress.destroy(Vn),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},Vn.createChildren=function(){this.addChild(this._bg=new Vg),this.addChild(this._bar=new Vv)},Vn.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},Vn.onBarMouseDown=function(Vn){this._globalSacle||(this._globalSacle=new VE),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=Vm.stage.mouseX,this._ty=Vm.stage.mouseY,Vm.stage.on("mousemove",this,this.mouseMove),Vm.stage.once("mouseup",this,this.mouseUp),Vm.stage.once("mouseout",this,this.mouseUp),this.showValueText()},Vn.showValueText=function(){if(this.showLabel){var Vn=laya.ui.Slider.label;this.addChild(Vn),Vn.textField.changeText(this._value+""),this.isVertical?(Vn.x=this._bar.x+20,Vn.y=.5*(this._bar.height-Vn.height)+this._bar.y):(Vn.y=this._bar.y-20,Vn.x=.5*(this._bar.width-Vn.width)+this._bar.x)}},Vn.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},Vn.mouseUp=function(Vn){Vm.stage.off("mousemove",this,this.mouseMove),Vm.stage.off("mouseup",this,this.mouseUp),Vm.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},Vn.mouseMove=function(Vn){var Va=this._value;this.isVertical?(this._bar.y+=(Vm.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(Vm.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=Vm.stage.mouseX,this._ty=Vm.stage.mouseY;var VU=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*VU)/VU,this._value!=Va&&this.sendChangeEvent(),this.showValueText()},Vn.sendChangeEvent=function(Vn){void 0===Vn&&(Vn="change"),this.event(Vn),this.changeHandler&&this.changeHandler.runWith(this._value)},Vn.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},Vn.changeSize=function(){Va.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},Vn.setSlider=function(Vn,Va,VU){this._value=-1,this._min=Vn,this._max=Vn<Va?Va:Vn,this.value=VU<Vn?Vn:Va<VU?Va:VU},Vn.changeValue=function(){var Vn=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*Vn)/Vn,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var Va=this._max-this._min;0===Va&&(Va=1),this.isVertical?(this._bar.y=(this._value-this._min)/Va*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/Va*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},Vn.onBgMouseDown=function(Vn){var Va=this._bg.getMousePoint();this.isVertical?this.value=Va.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=Va.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},VQ(0,Vn,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),VQ(0,Vn,"skin",function(){return this._skin},function(Vn){if(this._skin!=Vn){this._skin=Vn,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var Va=this._skin.replace(".png","$progress.png");VA.getRes(Va)&&(this._progress||(this.addChild(this._progress=new Vg),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=Va),this.setBarPoint(),this.callLater(this.changeValue)}}),VQ(0,Vn,"allowClickBack",function(){return this._allowClickBack},function(Vn){this._allowClickBack!=Vn&&((this._allowClickBack=Vn)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),VQ(0,Vn,"max",function(){return this._max},function(Vn){this._max!=Vn&&(this._max=Vn,this.callLater(this.changeValue))}),VQ(0,Vn,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),VQ(0,Vn,"tick",function(){return this._tick},function(Vn){this._tick!=Vn&&(this._tick=Vn,this.callLater(this.changeValue))}),VQ(0,Vn,"sizeGrid",function(){return this._bg.sizeGrid},function(Vn){this._bg.sizeGrid=Vn,this._bar.sizeGrid=Vn,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),VQ(0,Vn,"min",function(){return this._min},function(Vn){this._min!=Vn&&(this._min=Vn,this.callLater(this.changeValue))}),VQ(0,Vn,"value",function(){return this._value},function(Vn){if(this._value!=Vn){var Va=this._value;this._value=Vn,this.changeValue(),this._value!=Va&&this.sendChangeEvent()}}),VQ(0,Vn,"dataSource",Va.prototype._$get_dataSource,function(Vn){"number"==typeof(this._dataSource=Vn)||"string"==typeof Vn?this.value=Number(Vn):Vm.superSet(VH,this,"dataSource",Vn)}),VQ(0,Vn,"bar",function(){return this._bar}),Vx(VU,["label",function(){return this.label=new Vo}]),VU}(VH),Vg=function(Va){function VU(Vn){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,VU.__super.call(this),this.skin=Vn}Vp(VU,"laya.ui.Image",Va);var Vn=VU.prototype;return Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,VA.clearCache(this,this._skin)},Vn.dispose=function(){this.destroy(!0),VA.clearCache(this,this._skin),this.clearEvent()},Vn.createChildren=function(){this.graphics=this._bitmap=new Vc},Vn.setSource=function(Vn,Va){this.destroyed||Vn===this._skin&&Va&&(this.source=Va,this.onCompResize(),this.clearEvent())},Vn.clearEvent=function(){this._skin&&VD.atalsNotify&&VD.atalsNotify.off(this._skin,this,this.setSource)},Vn.clearLoad=function(){this._skin&&((this._complete||this._progress)&&Vm.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},VQ(0,Vn,"source",function(){return this._bitmap.source},function(Vn){this._bitmap&&(this._bitmap.source=Vn,this.event("loaded"),this.repaint())}),VQ(0,Vn,"dataSource",Va.prototype._$get_dataSource,function(Vn){"string"==typeof(this._dataSource=Vn)?this.skin=Vn:Vm.superSet(VH,this,"dataSource",Vn)}),VQ(0,Vn,"measureHeight",function(){return this._bitmap.height}),VQ(0,Vn,"skin",function(){return this._skin},function(Vn){if(this._skin!=Vn)if(VA.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=Vn){VA.keepCache(this,this._skin);var Va=VA.getRes(Vn),VU=VD.resAtalsObj&&VD.resAtalsObj[this._skin];Va?(this.source=Va,this.onCompResize()):VU?(VD.atalsNotify&&VD.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=VU.sourceW),0==this.height&&(this.height=VU.sourceH)):(this._complete=Vi.create(this,this.setSource,[this._skin]),this._progress=null,Vm.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),VQ(0,Vn,"group",function(){return this._group},function(Vn){Vn&&this._skin&&VA.setGroup(this._skin,Vn),this._group=Vn}),VQ(0,Vn,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Vn){this._bitmap.sizeGrid=VZ.fillArray(VM.defaultSizeGrid,Vn,Number)}),VQ(0,Vn,"measureWidth",function(){return this._bitmap.width}),VQ(0,Vn,"width",Va.prototype._$get_width,function(Vn){Vm.superSet(VH,this,"width",Vn),this._bitmap.width=0==Vn?1e-7:Vn}),VQ(0,Vn,"height",Va.prototype._$get_height,function(Vn){Vm.superSet(VH,this,"height",Vn),this._bitmap.height=0==Vn?1e-7:Vn}),VU}(VH),Vo=function(Va){function VU(Vn){this._tf=null,VU.__super.call(this),void 0===Vn&&(Vn=""),VX.defaultColor=VM.labelColor,this.text=Vn}Vp(VU,"laya.ui.Label",Va);var Vn=VU.prototype;return Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,Vn),this._tf=null},Vn.createChildren=function(){this.addChild(this._tf=new VY)},Vn.changeText=function(Vn){this._tf.changeText(Vn)},VQ(0,Vn,"padding",function(){return this._tf.padding.join(",")},function(Vn){this._tf.padding=VZ.fillArray(VM.labelPadding,Vn,Number)}),VQ(0,Vn,"bold",function(){return this._tf.bold},function(Vn){this._tf.bold=Vn}),VQ(0,Vn,"align",function(){return this._tf.align},function(Vn){this._tf.align=Vn}),VQ(0,Vn,"text",function(){return this._tf.text},function(Vn){this._tf.text!=Vn&&(Vn&&(Vn=VZ.adptString(Vn+"")),this._tf.text=Vn,this.event("change"),this._width&&this._height||this.onCompResize())}),VQ(0,Vn,"italic",function(){return this._tf.italic},function(Vn){this._tf.italic=Vn}),VQ(0,Vn,"wordWrap",function(){return this._tf.wordWrap},function(Vn){this._tf.wordWrap=Vn}),VQ(0,Vn,"font",function(){return this._tf.font},function(Vn){this._tf.font=Vn}),VQ(0,Vn,"dataSource",Va.prototype._$get_dataSource,function(Vn){"number"==typeof(this._dataSource=Vn)||"string"==typeof Vn?this.text=Vn+"":Vm.superSet(VH,this,"dataSource",Vn)}),VQ(0,Vn,"color",function(){return this._tf.color},function(Vn){this._tf.color=Vn}),VQ(0,Vn,"valign",function(){return this._tf.valign},function(Vn){this._tf.valign=Vn}),VQ(0,Vn,"leading",function(){return this._tf.leading},function(Vn){this._tf.leading=Vn}),VQ(0,Vn,"fontSize",function(){return this._tf.fontSize},function(Vn){this._tf.fontSize=Vn}),VQ(0,Vn,"bgColor",function(){return this._tf.bgColor},function(Vn){this._tf.bgColor=Vn}),VQ(0,Vn,"borderColor",function(){return this._tf.borderColor},function(Vn){this._tf.borderColor=Vn}),VQ(0,Vn,"stroke",function(){return this._tf.stroke},function(Vn){this._tf.stroke=Vn}),VQ(0,Vn,"strokeColor",function(){return this._tf.strokeColor},function(Vn){this._tf.strokeColor=Vn}),VQ(0,Vn,"textField",function(){return this._tf}),VQ(0,Vn,"measureWidth",function(){return this._tf.width}),VQ(0,Vn,"measureHeight",function(){return this._tf.height}),VQ(0,Vn,"width",function(){return this._width||this._tf.text?Vm.superGet(VH,this,"width"):0},function(Vn){Vm.superSet(VH,this,"width",Vn),this._tf.width=Vn}),VQ(0,Vn,"height",function(){return this._height||this._tf.text?Vm.superGet(VH,this,"height"):0},function(Vn){Vm.superSet(VH,this,"height",Vn),this._tf.height=Vn}),VQ(0,Vn,"overflow",function(){return this._tf.overflow},function(Vn){this._tf.overflow=Vn}),VQ(0,Vn,"underline",function(){return this._tf.underline},function(Vn){this._tf.underline=Vn}),VQ(0,Vn,"underlineColor",function(){return this._tf.underlineColor},function(Vn){this._tf.underlineColor=Vn}),VU}(VH),VB=function(Va){function VU(Vn){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,VU.__super.call(this),this.skin=Vn}Vp(VU,"laya.ui.ProgressBar",Va);var Vn=VU.prototype;return Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,Vn),this._bg&&this._bg.destroy(Vn),this._bar&&this._bar.destroy(Vn),this._bg=this._bar=null,this.changeHandler=null},Vn.createChildren=function(){this.addChild(this._bg=new Vg),this.addChild(this._bar=new Vg)},Vn.changeValue=function(){if(this.sizeGrid){var Vn=this.sizeGrid.split(","),Va=Number(Vn[3]),VU=Number(Vn[1]),Vx=(this.width-Va-VU)*this._value;this._bar.width=Va+VU+Vx,this._bar.visible=this._bar.width>Va+VU}else this._bar.width=this.width*this._value},VQ(0,Vn,"measureHeight",function(){return this._bg.height}),VQ(0,Vn,"skin",function(){return this._skin},function(Vn){this._skin!=Vn&&(this._skin=Vn,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),VQ(0,Vn,"measureWidth",function(){return this._bg.width}),VQ(0,Vn,"height",Va.prototype._$get_height,function(Vn){Vm.superSet(VH,this,"height",Vn),this._bg.height=this._height,this._bar.height=this._height}),VQ(0,Vn,"bar",function(){return this._bar}),VQ(0,Vn,"value",function(){return this._value},function(Vn){this._value!=Vn&&(Vn=1<Vn?1:Vn<0?0:Vn,this._value=Vn,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(Vn))}),VQ(0,Vn,"bg",function(){return this._bg}),VQ(0,Vn,"sizeGrid",function(){return this._bg.sizeGrid},function(Vn){this._bg.sizeGrid=this._bar.sizeGrid=Vn}),VQ(0,Vn,"width",Va.prototype._$get_width,function(Vn){Vm.superSet(VH,this,"width",Vn),this._bg.width=this._width,this.callLater(this.changeValue)}),VQ(0,Vn,"dataSource",Va.prototype._$get_dataSource,function(Vn){"number"==typeof(this._dataSource=Vn)||"string"==typeof Vn?this.value=Number(Vn):Vm.superSet(VH,this,"dataSource",Vn)}),VU}(VH),VO=(function(Vn){function VU(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,VU.__super.call(this),this._tipBox=new VH,this._tipBox.addChild(this._tipText=new VY),this._tipText.x=this._tipText.y=5,this._tipText.color=VU.tipTextColor,this._defaultTipHandler=this._showDefaultTip,Vm.stage.on("showtip",this,this._onStageShowTip),Vm.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}Vp(VU,"laya.ui.TipManager",VH);var Va=VU.prototype;Va._onStageHideTip=function(Vn){Vm.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},Va._onStageShowTip=function(Vn){Vm.timer.once(VU.tipDelay,this,this._showTip,[Vn],!0)},Va._showTip=function(Vn){if("string"==typeof Vn){var Va=String(Vn);Boolean(Va)&&this._defaultTipHandler(Va)}else Vn instanceof laya.utils.Handler?Vn.run():"function"==typeof Vn&&Vn.apply();Vm.stage.on("mousemove",this,this._onStageMouseMove),Vm.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},Va._onStageMouseDown=function(Vn){this.closeAll()},Va._onStageMouseMove=function(Vn){this._showToStage(this,VU.offsetX,VU.offsetY)},Va._showToStage=function(Vn,Va,VU){void 0===Va&&(Va=0),void 0===VU&&(VU=0);var Vx=Vn.getBounds();Vn.x=Vm.stage.mouseX+Va,Vn.y=Vm.stage.mouseY+VU,Vn.x+Vx.width>Vm.stage.width&&(Vn.x-=Vx.width+Va),Vn.y+Vx.height>Vm.stage.height&&(Vn.y-=Vx.height+VU)},Va.closeAll=function(){Vm.timer.clear(this,this._showTip),Vm.stage.off("mousemove",this,this._onStageMouseMove),Vm.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},Va.showDislayTip=function(Vn){this.addChild(Vn),this._showToStage(this),Vm._currentStage.addChild(this)},Va._showDefaultTip=function(Vn){this._tipText.text=Vn;var Va=this._tipBox.graphics;Va.clear(),Va.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,VU.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),Vm._currentStage.addChild(this)},VQ(0,Va,"defaultTipHandler",function(){return this._defaultTipHandler},function(Vn){this._defaultTipHandler=Vn}),VU.offsetX=10,VU.offsetY=15,VU.tipTextColor="#ffffff",VU.tipBackColor="#111111",VU.tipDelay=200}(),function(Vn){var Vq;function VE(){this._idMap=null,this._aniList=null,this._watchMap={},VE.__super.call(this)}Vp(VE,"laya.ui.View",VI);var Va=VE.prototype;return Va.createView=function(Vn){if(Vn.animations&&!this._idMap&&(this._idMap={}),VE.createComp(Vn,this,this),Vn.animations){var Va,VU,Vx=[],VD=Vn.animations,Vp=0,VQ=VD.length;for(Vp=0;Vp<VQ;Vp++){switch(Va=new Vz,VU=VD[Vp],Va._setUp(this._idMap,VU),(this[VU.name]=Va)._setControlNode(this),VU.action){case 1:Va.play(0,!1);break;case 2:Va.play(0,!0)}Vx.push(Va)}this._aniList=Vx}0<this._width&&null==Vn.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},Va.onEvent=function(Vn,Va){},Va.loadUI=function(Vn){var Va=VE.uiMap[Vn];Va&&this.createView(Va)},Va.destroy=function(Vn){void 0===Vn&&(Vn=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,Vn)},Va.changeData=function(Vn){var Va=this._watchMap[Vn];if(Va){console.log("change",Vn);for(var VU=0,Vx=Va.length;VU<Vx;VU++){Va[VU].exe(this)}}},VE._regs=function(){for(var Vn in VE.uiClassMap)Vb.regClass(Vn,VE.uiClassMap[Vn])},VE.createComp=function(Vn,Va,VU,Vx){if(!(Va=Va||VE.getCompInstance(Vn)))return console.warn("can not create:"+Vn.type),null;var VD=Vn.child;if(VD)for(var Vp=Va instanceof laya.ui.List,VQ=0,VV=VD.length;VQ<VV;VQ++){var Vy=VD[VQ];if(!Va.hasOwnProperty("itemRender")||"render"!=Vy.props.name&&"render"!==Vy.props.renderType)if("Graphic"==Vy.type)Vb.addGraphicsToSprite(Vy,Va);else if(Vb.isDrawType(Vy.type))Vb.addGraphicToSprite(Vy,Va,!0);else{if(Vp){var VR=[],VX=VE.createComp(Vy,null,VU,VR);VR.length&&(VX._$bindData=VR)}else VX=VE.createComp(Vy,null,VU,Vx);"Script"==Vy.type?"owner"in VX?VX.owner=Va:"target"in VX&&(VX.target=Va):"mask"==Vy.props.renderType||"mask"==Vy.props.name?Va.mask=VX:VX instanceof laya.display.Sprite&&Va.addChild(VX)}else Va.itemRender=Vy}var Vz=Vn.props;for(var Vi in Vz){var Vq=Vz[Vi];VE.eventDic[Vi]?Vq&&VU&&Va.on(Vi,VU,VU.onEvent,[Vq]):VE.setCompValue(Va,Vi,Vq,VU,Vx)}return Vm.__typeof(Va,"laya.ui.IItem")&&Va.initItems(),Vn.compId&&VU&&VU._idMap&&(VU._idMap[Vn.compId]=Va),Va},VE.setCompValue=function(Vn,Va,VU,Vx,VD){if("string"==typeof VU&&-1<VU.indexOf("${")){if(VE._sheet||(VE._sheet=Vb.getClass("laya.data.Table")),!VE._sheet)return void console.warn("Can not find class Sheet");if(VD)VD.push(Vn,Va,VU);else if(Vx){-1==VU.indexOf("].")&&(VU=VU.replace(".","[0]."));var Vp,VQ,VV=new Vq(Vn,Va,VU);VV.exe(Vx);for(var Vy=VU.replace(/\[.*?\]\./g,".");null!=(Vp=VE._parseWatchData.exec(Vy));){for(var VR=Vp[1];null!=(VQ=VE._parseKeyWord.exec(VR));){var VX=VQ[0],Vz=Vx._watchMap[VX]||(Vx._watchMap[VX]=[]);Vz.push(VV),VE._sheet.I.notifer.on(VX,Vx,Vx.changeData,[VX])}(Vz=Vx._watchMap[VR]||(Vx._watchMap[VR]=[])).push(VV),VE._sheet.I.notifer.on(VR,Vx,Vx.changeData,[VR])}}}else if("var"===Va&&Vx)Vx[VU]=Vn;else if("onClick"==Va){var Vi=Vm._runScript("(function(){"+VU+"})");Vn.on("click",Vx,Vi)}else Vn[Va]="true"===VU||"false"!==VU&&VU},VE.getCompInstance=function(Vn){var Va,VU=Vn.props?Vn.props.runtime:null;return Va=VU?VE.viewClassMap[VU]||VE.uiClassMap[VU]||Vm.__classmap[VU]:VE.uiClassMap[Vn.type],Vn.props&&Vn.props.hasOwnProperty("renderType")&&"instance"==Vn.props.renderType?Va.instance:Va?new Va:null},VE.regComponent=function(Vn,Va){VE.uiClassMap[Vn]=Va,Vb.regClass(Vn,Va)},VE.regViewRuntime=function(Vn,Va){VE.viewClassMap[Vn]=Va},VE.uiMap={},VE.viewClassMap={},VE._sheet=null,Vx(VE,["uiClassMap",function(){return this.uiClassMap={ViewStack:Vnn,LinkButton:Vv,TextArea:VRn,ColorPicker:Vj,Box:VI,Button:Vv,CheckBox:VL,Clip:Vl,ComboBox:Vh,Component:VH,HScrollBar:Vs,HSlider:Vt,Image:Vg,Label:Vo,List:Vw,Panel:VC,ProgressBar:VB,Radio:VJ,RadioGroup:VVn,ScrollBar:Vf,Slider:VF,Tab:Vyn,TextInput:VUn,View:VE,VScrollBar:Van,VSlider:Vxn,Tree:Ve,HBox:Vpn,VBox:VQn,Sprite:VK,Animation:VU,Text:VY,FontClip:VS}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),VE.__init$=function(){VE._regs(),Vq=function(){function Vn(Vn,Va,VU){this.comp=null,this.prop=null,this.value=null,this.comp=Vn,this.prop=Va,this.value=VU}return Vp(Vn,""),Vn.prototype.exe=function(Vn){var Va=VZ.getBindFun(this.value);this.comp[this.prop]=Va.call(this,Vn)},Vn}()},VE}()),VL=function(Vn){function VU(Vn,Va){void 0===Va&&(Va=""),VU.__super.call(this,Vn,Va)}Vp(VU,"laya.ui.CheckBox",Vn);var Va=VU.prototype;return Va.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},Va.initialize=function(){Vn.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},VQ(0,Va,"dataSource",Vn.prototype._$get_dataSource,function(Vn){"boolean"==typeof(this._dataSource=Vn)?this.selected=Vn:"string"==typeof Vn?this.selected="true"===Vn:Vm.superSet(Vv,this,"dataSource",Vn)}),VU}(Vv),Vd=function(Vn){function Va(){this._space=0,this._align="none",this._itemChanged=!1,Va.__super.call(this)}Vp(Va,"laya.ui.LayoutBox",VI);var VU=Va.prototype;return VU.addChild=function(Vn){return Vn.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,Vn)},VU.onResize=function(Vn){this._setItemChanged()},VU.addChildAt=function(Vn,Va){return Vn.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,Vn,Va)},VU.removeChild=function(Vn){return Vn.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,Vn)},VU.removeChildAt=function(Vn){return this.getChildAt(Vn).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,Vn)},VU.refresh=function(){this._setItemChanged()},VU.changeItems=function(){this._itemChanged=!1},VU.sortItem=function(Vn){Vn&&Vn.sort(function(Vn,Va){return Vn.y-Va.y})},VU._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},VQ(0,VU,"space",function(){return this._space},function(Vn){this._space=Vn,this._setItemChanged()}),VQ(0,VU,"align",function(){return this._align},function(Vn){this._align=Vn,this._setItemChanged()}),Va}(),VS=function(Va){function VU(Vn,Va){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,VU.__super.call(this),Vn&&(this.skin=Vn),Va&&(this.sheet=Va)}Vp(VU,"laya.ui.FontClip",Va);var Vn=VU.prototype;return Vn.createChildren=function(){this._bitmap=new Vc,this.on("loaded",this,this._onClipLoaded)},Vn._onClipLoaded=function(){this.callLater(this.changeValue)},Vn.changeValue=function(){var Vn;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),Vn=this._sources[0]))){var Va="horizontal"===this._direction;Va?(this._wordsW=this._valueArr.length*(Vn.sourceWidth+this.spaceX),this._wordsH=Vn.sourceHeight):(this._wordsW=Vn.sourceWidth,this._wordsH=(Vn.sourceHeight+this.spaceY)*this._valueArr.length);var VU=0;if(this._width)switch(this._align){case"center":VU=.5*(this._width-this._wordsW);break;case"right":VU=this._width-this._wordsW;break;default:VU=0}for(var Vx=0,VD=this._valueArr.length;Vx<VD;Vx++){var Vp=this._indexMap[this._valueArr.charAt(Vx)];this.sources[Vp]&&(Vn=this.sources[Vp],Va?this.graphics.drawTexture(Vn,VU+Vx*(Vn.sourceWidth+this.spaceX),0,Vn.sourceWidth,Vn.sourceHeight):this.graphics.drawTexture(Vn,0+VU,Vx*(Vn.sourceHeight+this.spaceY),Vn.sourceWidth,Vn.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),Va.prototype.destroy.call(this,Vn)},VQ(0,Vn,"sheet",function(){return this._sheet},function(Vn){Vn+="";var Va=(this._sheet=Vn).split(" ");this._clipX=String(Va[0]).length,this.clipY=Va.length,this._indexMap={};for(var VU=0;VU<this._clipY;VU++)for(var Vx=Va[VU].split(""),VD=0,Vp=Vx.length;VD<Vp;VD++)this._indexMap[Vx[VD]]=VU*this._clipX+VD}),VQ(0,Vn,"height",Va.prototype._$get_height,function(Vn){Vm.superSet(Vl,this,"height",Vn),this.callLater(this.changeValue)}),VQ(0,Vn,"direction",function(){return this._direction},function(Vn){this._direction=Vn,this.callLater(this.changeValue)}),VQ(0,Vn,"value",function(){return this._valueArr?this._valueArr:""},function(Vn){Vn+="",this._valueArr=Vn,this.callLater(this.changeValue)}),VQ(0,Vn,"width",Va.prototype._$get_width,function(Vn){Vm.superSet(Vl,this,"width",Vn),this.callLater(this.changeValue)}),VQ(0,Vn,"spaceX",function(){return this._spaceX},function(Vn){this._spaceX=Vn,"horizontal"===this._direction&&this.callLater(this.changeValue)}),VQ(0,Vn,"spaceY",function(){return this._spaceY},function(Vn){this._spaceY=Vn,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),VQ(0,Vn,"align",function(){return this._align},function(Vn){this._align=Vn,this.callLater(this.changeValue)}),VQ(0,Vn,"measureWidth",function(){return this._wordsW}),VQ(0,Vn,"measureHeight",function(){return this._wordsH}),VU}(Vl),Vw=function(Vn){function Va(){this.selectHandler=null,this.renderHandler=null,this.renderTwHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this._twSwitch=!0,this._twDone=!0,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new VE,Va.__super.call(this)}Vp(Va,"laya.ui.List",Vn);var VU=Va.prototype;return Vm.imps(VU,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),VU.destroy=function(Vn){void 0===Vn&&(Vn=!0),this._content&&this._content.destroy(Vn),this._scrollBar&&this._scrollBar.destroy(Vn),laya.ui.Component.prototype.destroy.call(this,Vn),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this._twSwitch=null,this._twDone=null,this.selectHandler=this.renderHandler=this.mouseHandler=this.renderTwHandler=null},VU.createChildren=function(){this.addChild(this._content=new VI)},VU.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=Vm.superGet(VI,this,"cacheAs")),Vm.superSet(VI,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},VU.onScrollEnd=function(){Vm.superSet(VI,this,"cacheAs",this._$P.cacheAs)},VU._removePreScrollBar=function(){var Vn=this.removeChildByName("scrollBar");Vn&&Vn.destroy(!0)},VU.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var Vn=this._getOneCell(),Va=Vn.width+this._spaceX||1,VU=Vn.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/Va):Math.ceil(this._width/Va)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/VU):Math.round(this._height/VU));var Vx=this._width?this._width:Va*this.repeatX-this._spaceX,VD=this._height?this._height:VU*this.repeatY-this._spaceY;this._cellSize=this._isVertical?VU:Va,this._cellOffset=this._isVertical?VU*Math.max(this._repeatY2,this._repeatY)-VD-this._spaceY:Va*Math.max(this._repeatX2,this._repeatX)-Vx-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=VD:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=Vx),this.setContentSize(Vx,VD);var Vp=this._isVertical?this.repeatX:this.repeatY,VQ=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,Vp,VQ),this._createdLine=VQ,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},VU._getOneCell=function(){if(0===this._cells.length){var Vn=this.createItem();if(this._offset.setTo(Vn.x,Vn.y),this.cacheContent)return Vn;this._cells.push(Vn)}return this._cells[0]},VU._createItems=function(Vn,Va,VU){var Vx=this._content,VD=this._getOneCell(),Vp=VD.width+this._spaceX,VQ=VD.height+this._spaceY;if(this.cacheContent){var VV=new VI;VV.cacheAsBitmap=!0,VV.pos((this._isVertical?0:Vn)*Vp,(this._isVertical?Vn:0)*VQ),this._content.addChild(VV),this._content.optimizeScrollRect=!0,Vx=VV}else{for(var Vy=[],VR=this._cells.length-1;-1<VR;VR--){var VX=this._cells[VR];VX.removeSelf(),Vy.push(VX)}this._cells.length=0}for(var Vz=Vn;Vz<VU;Vz++)for(var Vi=0;Vi<Va;Vi++)(VD=Vy&&Vy.length?Vy.pop():this.createItem()).x=(this._isVertical?Vi:Vz)*Vp-Vx.x,VD.y=(this._isVertical?Vz:Vi)*VQ-Vx.y,VD.name="item"+(Vz*Va+Vi),Vx.addChild(VD),this.addCell(VD)},VU.createItem=function(){var Vn=[];if("function"==typeof this._itemRender)var Va=new this._itemRender;else Va=VO.createComp(this._itemRender,null,null,Vn);if(0==Vn.length&&Va._watchMap){var VU=Va._watchMap;for(var Vx in VU)for(var VD=VU[Vx],Vp=0;Vp<VD.length;Vp++){var VQ=VD[Vp];Vn.push(VQ.comp,VQ.prop,VQ.value)}}return Vn.length&&(Va._$bindData=Vn),Va},VU.addCell=function(Vn){Vn.on("click",this,this.onCellMouse),Vn.on("rightclick",this,this.onCellMouse),Vn.on("mouseover",this,this.onCellMouse),Vn.on("mouseout",this,this.onCellMouse),Vn.on("mousedown",this,this.onCellMouse),Vn.on("mouseup",this,this.onCellMouse),this._cells.push(Vn)},VU.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var Vn=0,Va=Vn=0;Va<1e4;Va++){var VU=this.getChildByName("item"+Va);if(!VU)break;this.addCell(VU),Vn++}this.repeatY=Vn}},VU.setContentSize=function(Vn,Va){this._content.width=Vn,this._content.height=Va,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new VP),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,Vn,Va),this._content.scrollRect=this._content.scrollRect),this.event("resize")},VU.onCellMouse=function(Vn){"mousedown"===Vn.type&&(this._isMoved=!1);var Va=Vn.currentTarget,VU=this._startIndex+this._cells.indexOf(Va);VU<0||("click"===Vn.type||"rightclick"===Vn.type?this.selectEnable&&!this._isMoved?this.selectedIndex=VU:this.changeCellState(Va,!0,0):"mouseover"!==Vn.type&&"mouseout"!==Vn.type||this._selectedIndex===VU||this.changeCellState(Va,"mouseover"===Vn.type,0),this.mouseHandler&&this.mouseHandler.runWith([Vn,VU]))},VU.changeCellState=function(Vn,Va,VU){var Vx=Vn.getChildByName("selectBox");Vx&&(this.selectEnable=!0,Vx.visible=Va,Vx.index=VU)},VU.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},VU.onScrollBarChange=function(Vn){this.runCallLater(this.changeCells);var Va=this._scrollBar.value,VU=this._isVertical?this.repeatX:this.repeatY,Vx=this._isVertical?this.repeatY:this.repeatX,VD=Math.floor(Va/this._cellSize);if(this.cacheContent)VQ=Vx+1,this._createdLine-VD<VQ&&(this._createItems(this._createdLine,VU,this._createdLine+VQ),this.renderItems(this._createdLine*VU,0),this._createdLine+=VQ);else{var Vp=VD*VU,VQ=0;if(Vp>this._startIndex){VQ=Vp-this._startIndex;var VV=!0,Vy=this._startIndex+VU*(Vx+1);this._isMoved=!0}else Vp<this._startIndex&&(VQ=this._startIndex-Vp,VV=!1,Vy=this._startIndex-1,this._isMoved=!0);for(var VR=0;VR<VQ;VR++){if(VV){var VX=this._cells.shift();this._cells[this._cells.length]=VX;var Vz=Vy+VR}else VX=this._cells.pop(),this._cells.unshift(VX),Vz=Vy-VR;var Vi=Math.floor(Vz/VU)*this._cellSize;this._isVertical?VX.y=Vi:VX.x=Vi,this.renderItem(VX,Vz)}this._startIndex=Vp,this.changeSelectStatus()}var Vq=this._content.scrollRect;this._isVertical?(Vq.y=Va-this._offset.y,Vq.x=-this._offset.x):(Vq.y=-this._offset.y,Vq.x=Va-this._offset.x),this._content.scrollRect=Vq},VU.posCell=function(Vn,Va){if(this._scrollBar){var VU=this._isVertical?this.repeatX:this.repeatY,Vx=(this._isVertical?this.repeatY:this.repeatX,Math.floor(Va/VU)*this._cellSize);this._isVertical?Vn.y=Vx:Vn.x=Vx}},VU.changeSelectStatus=function(){for(var Vn=0,Va=this._cells.length;Vn<Va;Vn++)this.changeCellState(this._cells[Vn],this._selectedIndex===this._startIndex+Vn,1)},VU.renderItems=function(Vn,Va){void 0===Vn&&(Vn=0),void 0===Va&&(Va=0);for(var VU=Vn,Vx=Va||this._cells.length;VU<Vx;VU++)this.renderItem(this._cells[VU],this._startIndex+VU);this.changeSelectStatus(),this._twDone=!0},VU.renderItem=function(Vn,Va){this._array&&0<=Va&&Va<this._array.length?(Vn.visible=!0,Vn._$bindData?(Vn._dataSource=this._array[Va],this._bindData(Vn,this._array[Va])):Vn.dataSource=this._array[Va],this.cacheContent||this.posCell(Vn,Va),this.hasListener("render")&&this.event("render",[Vn,Va]),this.renderHandler&&this.renderHandler.runWith([Vn,Va]),this.renderTwHandler&&this.renderTwHandler.runWith([Vn,Va])):(Vn.visible=!1,Vn.dataSource=null)},VU._bindData=function(Vn,Va){for(var VU=Vn._$bindData,Vx=0,VD=VU.length;Vx<VD;Vx++){var Vp=VU[Vx++],VQ=VU[Vx++],VV=VU[Vx],Vy=VZ.getBindFun(VV);Vp[VQ]=Vy.call(this,Va)}},VU.refresh=function(){this.array=this._array},VU.getItem=function(Vn){return-1<Vn&&Vn<this._array.length?this._array[Vn]:null},VU.changeItem=function(Vn,Va){-1<Vn&&Vn<this._array.length&&(this._array[Vn]=Va,Vn>=this._startIndex&&Vn<this._startIndex+this._cells.length&&this.renderItem(this.getCell(Vn),Vn))},VU.setItem=function(Vn,Va){this.changeItem(Vn,Va)},VU.addItem=function(Vn){this._array.push(Vn),this.array=this._array},VU.addItemAt=function(Vn,Va){this._array.splice(Va,0,Vn),this.array=this._array},VU.deleteItem=function(Vn){this._array.splice(Vn,1),this.array=this._array},VU.getCell=function(Vn){return this.runCallLater(this.changeCells),-1<Vn&&this._cells?this._cells[(Vn-this._startIndex)%this._cells.length]:null},VU.scrollTo=function(Vn){if(this._scrollBar){var Va=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(Vn/Va)*this._cellSize}else this.startIndex=Vn},VU.tweenTo=function(Vn,Va,VU){if(void 0===Va&&(Va=200),this._scrollBar){var Vx=this._isVertical?this.repeatX:this.repeatY;Vk.to(this._scrollBar,{value:Math.floor(Vn/Vx)*this._cellSize},Va,null,VU,0,!0)}else this.startIndex=Vn,VU&&VU.run()},VU._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},VU.commitMeasure=function(){this.runCallLater(this.changeCells)},VQ(0,VU,"cacheAs",Vn.prototype._$get_cacheAs,function(Vn){Vm.superSet(VI,this,"cacheAs",Vn),this._scrollBar&&(this._$P.cacheAs=null,"none"!==Vn?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),VQ(0,VU,"content",function(){return this._content}),VQ(0,VU,"height",Vn.prototype._$get_height,function(Vn){Vn!=this._height&&(Vm.superSet(VI,this,"height",Vn),this._setCellChanged())}),VQ(0,VU,"itemRender",function(){return this._itemRender},function(Vn){if(this._itemRender!=Vn){this._itemRender=Vn;for(var Va=this._cells.length-1;-1<Va;Va--)this._cells[Va].destroy();this._cells.length=0,this._setCellChanged()}}),VQ(0,VU,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(Vn){this._removePreScrollBar();var Va=new Van;Va.name="scrollBar",Va.right=0,Vn&&" "!=Vn&&(Va.skin=Vn),this.scrollBar=Va,this.addChild(Va),this._setCellChanged()}),VQ(0,VU,"page",function(){return this._page},function(Vn){this._page=Vn,this._array&&(this._page=0<Vn?Vn:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),VQ(0,VU,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(Vn){this._removePreScrollBar();var Va=new Vs;Va.name="scrollBar",Va.bottom=0,Vn&&" "!=Vn&&(Va.skin=Vn),this.scrollBar=Va,this.addChild(Va),this._setCellChanged()}),VQ(0,VU,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(Vn){this._repeatX=Vn,this._setCellChanged()}),VQ(0,VU,"scrollBar",function(){return this._scrollBar},function(Vn){this._scrollBar!=Vn&&(this._scrollBar=Vn)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),VQ(0,VU,"width",Vn.prototype._$get_width,function(Vn){Vn!=this._width&&(Vm.superSet(VI,this,"width",Vn),this._setCellChanged())}),VQ(0,VU,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(Vn){this._repeatY=Vn,this._setCellChanged()}),VQ(0,VU,"spaceX",function(){return this._spaceX},function(Vn){this._spaceX=Vn,this._setCellChanged()}),VQ(0,VU,"spaceY",function(){return this._spaceY},function(Vn){this._spaceY=Vn,this._setCellChanged()}),VQ(0,VU,"selectedIndex",function(){return this._selectedIndex},function(Vn){this._selectedIndex!=Vn&&(this._selectedIndex=Vn,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(Vn),this.startIndex=this._startIndex)}),VQ(0,VU,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(Vn){this.selectedIndex=this._array.indexOf(Vn)}),VQ(0,VU,"length",function(){return this._array?this._array.length:0}),VQ(0,VU,"selection",function(){return this.getCell(this._selectedIndex)},function(Vn){this.selectedIndex=this._startIndex+this._cells.indexOf(Vn)}),VQ(0,VU,"startIndex",function(){return this._startIndex},function(Vn){this._startIndex=0<Vn?Vn:0,this.callLater(this.renderItems)}),VQ(0,VU,"twSwitch",function(){return this._twSwitch},function(Vn){this._twSwitch=Vn}),VQ(0,VU,"twDone",function(){return this._twDone},function(Vn){this._twDone=Vn}),VQ(0,VU,"array",function(){return this._array},function(Vn){this.runCallLater(this.changeCells),this._array=Vn||[];var Va=this._array.length;if(this.totalPage=Math.ceil(Va/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<Va?this._selectedIndex:Va-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var VU=this._isVertical?this.repeatX:this.repeatY,Vx=this._isVertical?this.repeatY:this.repeatX,VD=Math.ceil(Va/VU);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=Vx/VD,this._scrollBar.setScroll(0,(VD-Vx)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),VQ(0,VU,"dataSource",Vn.prototype._$get_dataSource,function(Vn){"number"==typeof(this._dataSource=Vn)&&Math.floor(Vn)==Vn||"string"==typeof Vn?this.selectedIndex=parseInt(Vn):Vn instanceof Array?this.array=Vn:Vm.superSet(VI,this,"dataSource",Vn)}),VQ(0,VU,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),Va}(VI),Vs=function(Vn){function Va(){Va.__super.call(this)}return Vp(Va,"laya.ui.HScrollBar",Vn),Va.prototype.initialize=function(){Vn.prototype.initialize.call(this),this.slider.isVertical=!1},Va}(Vf),VC=function(Vn){function Va(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,Va.__super.call(this),this.width=this.height=100}Vp(Va,"laya.ui.Panel",Vn);var VU=Va.prototype;return VU.destroy=function(Vn){void 0===Vn&&(Vn=!0),laya.ui.Component.prototype.destroy.call(this,Vn),this._content&&this._content.destroy(Vn),this._vScrollBar&&this._vScrollBar.destroy(Vn),this._hScrollBar&&this._hScrollBar.destroy(Vn),this._vScrollBar=null,this._hScrollBar=null,this._content=null},VU.destroyChildren=function(){this._content.destroyChildren()},VU.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new VI)},VU.addChild=function(Vn){return Vn.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(Vn)},VU.onResize=function(){this._setScrollChanged()},VU.addChildAt=function(Vn,Va){return Vn.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(Vn,Va)},VU.removeChild=function(Vn){return Vn.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(Vn)},VU.removeChildAt=function(Vn){return this.getChildAt(Vn).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(Vn)},VU.removeChildren=function(Vn,Va){return void 0===Vn&&(Vn=0),void 0===Va&&(Va=2147483647),this._content.removeChildren(Vn,Va),this._setScrollChanged(),this},VU.getChildAt=function(Vn){return this._content.getChildAt(Vn)},VU.getChildByName=function(Vn){return this._content.getChildByName(Vn)},VU.getChildIndex=function(Vn){return this._content.getChildIndex(Vn)},VU.changeScroll=function(){this._scrollChanged=!1;var Vn=this.contentWidth||1,Va=this.contentHeight||1,VU=this._vScrollBar,Vx=this._hScrollBar,VD=VU&&Va>this._height,Vp=Vx&&Vn>this._width,VQ=VD?this._width-VU.width:this._width,VV=Vp?this._height-Vx.height:this._height;VU&&(VU.x=this._width-VU.width,VU.y=0,VU.height=this._height-(Vp?Vx.height:0),VU.scrollSize=Math.max(.033*this._height,1),VU.thumbPercent=VV/Va,VU.setScroll(0,Va-VV,VU.value)),Vx&&(Vx.x=0,Vx.y=this._height-Vx.height,Vx.width=this._width-(VD?VU.width:0),Vx.scrollSize=Math.max(.033*this._width,1),Vx.thumbPercent=VQ/Vn,Vx.setScroll(0,Vn-VQ,Vx.value))},VU.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},VU.setContentSize=function(Vn,Va){var VU=this._content;VU.width=Vn,VU.height=Va,VU.scrollRect||(VU.scrollRect=new VP),VU.scrollRect.setTo(0,0,Vn,Va),VU.scrollRect=VU.scrollRect},VU.onScrollBarChange=function(Vn){var Va=this._content.scrollRect;if(Va){var VU=Math.round(Vn.value);Vn.isVertical?Va.y=VU:Va.x=VU,this._content.scrollRect=Va}},VU.scrollTo=function(Vn,Va){void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),this.vScrollBar&&(this.vScrollBar.value=Va),this.hScrollBar&&(this.hScrollBar.value=Vn)},VU.refresh=function(){this.changeScroll()},VU.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=Vm.superGet(VI,this,"cacheAs")),Vm.superSet(VI,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},VU.onScrollEnd=function(){Vm.superSet(VI,this,"cacheAs",this._$P.cacheAs)},VU._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},VQ(0,VU,"numChildren",function(){return this._content.numChildren}),VQ(0,VU,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(Vn){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new Vs),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=Vn}),VQ(0,VU,"contentWidth",function(){for(var Vn=0,Va=this._content.numChildren-1;-1<Va;Va--){var VU=this._content.getChildAt(Va);Vn=Math.max(VU.x+VU.width*VU.scaleX,Vn)}return Vn}),VQ(0,VU,"contentHeight",function(){for(var Vn=0,Va=this._content.numChildren-1;-1<Va;Va--){var VU=this._content.getChildAt(Va);Vn=Math.max(VU.y+VU.height*VU.scaleY,Vn)}return Vn}),VQ(0,VU,"width",Vn.prototype._$get_width,function(Vn){Vm.superSet(VI,this,"width",Vn),this._setScrollChanged()}),VQ(0,VU,"hScrollBar",function(){return this._hScrollBar}),VQ(0,VU,"content",function(){return this._content}),VQ(0,VU,"height",Vn.prototype._$get_height,function(Vn){Vm.superSet(VI,this,"height",Vn),this._setScrollChanged()}),VQ(0,VU,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(Vn){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new Van),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=Vn}),VQ(0,VU,"vScrollBar",function(){return this._vScrollBar}),VQ(0,VU,"cacheAs",Vn.prototype._$get_cacheAs,function(Vn){Vm.superSet(VI,this,"cacheAs",Vn),this._$P.cacheAs=null,"none"!==Vn?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),Va}(VI),Vt=function(Vn){function Va(Vn){Va.__super.call(this,Vn),this.isVertical=!1}return Vp(Va,"laya.ui.HSlider",VF),Va}(),Vr=function(Vn){function VU(Vn,Va){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,VU.__super.call(this),this.skin=Va,this.labels=Vn}Vp(VU,"laya.ui.UIGroup",Vn);var Va=VU.prototype;return Vm.imps(Va,{"laya.ui.IItem":!0}),Va.preinitialize=function(){this.mouseEnabled=!0},Va.destroy=function(Vn){void 0===Vn&&(Vn=!0),laya.ui.Component.prototype.destroy.call(this,Vn),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},Va.addItem=function(Vn,Va){void 0===Va&&(Va=!0);var VU=Vn,Vx=this._items.length;if(VU.name="item"+Vx,this.addChild(VU),this.initItems(),Va&&0<Vx){var VD=this._items[Vx-1];"horizontal"==this._direction?VU.x=VD.x+VD.width+this._space:VU.y=VD.y+VD.height+this._space}else Va&&(VU.x=0,VU.y=0);return Vx},Va.delItem=function(Vn,Va){void 0===Va&&(Va=!0);var VU=this._items.indexOf(Vn);if(-1!=VU){var Vx=Vn;this.removeChild(Vx);for(var VD=VU+1,Vp=this._items.length;VD<Vp;VD++){var VQ=this._items[VD];VQ.name="item"+(VD-1),Va&&("horizontal"==this._direction?VQ.x-=Vx.width+this._space:VQ.y-=Vx.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var VV;VV=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=VV}}},Va.initItems=function(){this._items||(this._items=[]);for(var Vn=this._items.length=0;Vn<1e4;Vn++){var Va=this.getChildByName("item"+Vn);if(null==Va)break;this._items.push(Va),Va.selected=Vn===this._selectedIndex,Va.clickHandler=Vi.create(this,this.itemClick,[Vn],!1)}},Va.itemClick=function(Vn){this.selectedIndex=Vn},Va.setSelect=function(Vn,Va){this._items&&-1<Vn&&Vn<this._items.length&&(this._items[Vn].selected=Va)},Va.createItem=function(Vn,Va){return null},Va.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var Vn=0,Va=0,VU=this._items.length;Va<VU;Va++){var Vx=this._items[Va];this._skin&&(Vx.skin=this._skin),this._labelColors&&(Vx.labelColors=this._labelColors),this._labelSize&&(Vx.labelSize=this._labelSize),this._labelStroke&&(Vx.labelStroke=this._labelStroke),this._labelStrokeColor&&(Vx.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(Vx.strokeColors=this._strokeColors),this._labelBold&&(Vx.labelBold=this._labelBold),this._labelPadding&&(Vx.labelPadding=this._labelPadding),this._labelAlign&&(Vx.labelAlign=this._labelAlign),this._stateNum&&(Vx.stateNum=this._stateNum),this._labelFont&&(Vx.labelFont=this._labelFont),"horizontal"===this._direction?(Vx.y=0,Vx.x=Vn,Vn+=Vx.width+this._space):(Vx.x=0,Vx.y=Vn,Vn+=Vx.height+this._space)}this.changeSize()},Va.commitMeasure=function(){this.runCallLater(this.changeLabels)},Va._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},VQ(0,Va,"labelStrokeColor",function(){return this._labelStrokeColor},function(Vn){this._labelStrokeColor!=Vn&&(this._labelStrokeColor=Vn,this._setLabelChanged())}),VQ(0,Va,"skin",function(){return this._skin},function(Vn){this._skin!=Vn&&(this._skin=Vn,this._setLabelChanged())}),VQ(0,Va,"selectedIndex",function(){return this._selectedIndex},function(Vn){this._selectedIndex!=Vn&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=Vn,this.setSelect(Vn,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),VQ(0,Va,"labels",function(){return this._labels},function(Vn){if(this._labels!=Vn){if(this._labels=Vn,this.removeChildren(),this._setLabelChanged(),this._labels)for(var Va=this._labels.split(","),VU=0,Vx=Va.length;VU<Vx;VU++){var VD=this.createItem(this._skin,Va[VU]);VD.name="item"+VU,this.addChild(VD)}this.initItems()}}),VQ(0,Va,"strokeColors",function(){return this._strokeColors},function(Vn){this._strokeColors!=Vn&&(this._strokeColors=Vn,this._setLabelChanged())}),VQ(0,Va,"labelColors",function(){return this._labelColors},function(Vn){this._labelColors!=Vn&&(this._labelColors=Vn,this._setLabelChanged())}),VQ(0,Va,"labelStroke",function(){return this._labelStroke},function(Vn){this._labelStroke!=Vn&&(this._labelStroke=Vn,this._setLabelChanged())}),VQ(0,Va,"labelSize",function(){return this._labelSize},function(Vn){this._labelSize!=Vn&&(this._labelSize=Vn,this._setLabelChanged())}),VQ(0,Va,"stateNum",function(){return this._stateNum},function(Vn){this._stateNum!=Vn&&(this._stateNum=Vn,this._setLabelChanged())}),VQ(0,Va,"labelBold",function(){return this._labelBold},function(Vn){this._labelBold!=Vn&&(this._labelBold=Vn,this._setLabelChanged())}),VQ(0,Va,"labelFont",function(){return this._labelFont},function(Vn){this._labelFont!=Vn&&(this._labelFont=Vn,this._setLabelChanged())}),VQ(0,Va,"labelPadding",function(){return this._labelPadding},function(Vn){this._labelPadding!=Vn&&(this._labelPadding=Vn,this._setLabelChanged())}),VQ(0,Va,"direction",function(){return this._direction},function(Vn){this._direction=Vn,this._setLabelChanged()}),VQ(0,Va,"space",function(){return this._space},function(Vn){this._space=Vn,this._setLabelChanged()}),VQ(0,Va,"items",function(){return this._items}),VQ(0,Va,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(Vn){this.selectedIndex=this._items.indexOf(Vn)}),VQ(0,Va,"dataSource",Vn.prototype._$get_dataSource,function(Vn){"number"==typeof(this._dataSource=Vn)&&Math.floor(Vn)==Vn||"string"==typeof Vn?this.selectedIndex=parseInt(Vn):Vn instanceof Array?this.labels=Vn.join(","):Vm.superSet(VI,this,"dataSource",Vn)}),VU}(VI),VJ=function(Va){function VU(Vn,Va){this._value=null,void 0===Va&&(Va=""),VU.__super.call(this,Vn,Va)}Vp(VU,"laya.ui.Radio",Va);var Vn=VU.prototype;return Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,Vn),this._value=null},Vn.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},Vn.initialize=function(){Va.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},Vn.onClick=function(Vn){this.selected=!0},VQ(0,Vn,"value",function(){return null!=this._value?this._value:this.label},function(Vn){this._value=Vn}),VU}(Vv),Ve=function(Vn){function Va(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,Va.__super.call(this),this.width=this.height=200}Vp(Va,"laya.ui.Tree",Vn);var VU=Va.prototype;return Vm.imps(VU,{"laya.ui.IRender":!0}),VU.destroy=function(Vn){void 0===Vn&&(Vn=!0),laya.ui.Component.prototype.destroy.call(this,Vn),this._list&&this._list.destroy(Vn),this._list=null,this._source=null,this._renderHandler=null},VU.createChildren=function(){this.addChild(this._list=new Vw),this._list.renderHandler=Vi.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},VU.onListChange=function(Vn){this.event("change")},VU.getArray=function(){var Vn,Va=[];for(var VU in this._source)Vn=this._source[VU],this.getParentOpenStatus(Vn)&&(Vn.x=this._spaceLeft*this.getDepth(Vn),Va.push(Vn));return Va},VU.getDepth=function(Vn,Va){return void 0===Va&&(Va=0),null==Vn.nodeParent?Va:this.getDepth(Vn.nodeParent,Va+1)},VU.getParentOpenStatus=function(Vn){var Va=Vn.nodeParent;return null==Va||!!Va.isOpen&&(null==Va.nodeParent||this.getParentOpenStatus(Va))},VU.renderItem=function(Vn,Va){var VU=Vn.dataSource;if(VU){Vn.left=VU.x;var Vx=Vn.getChildByName("arrow");Vx&&(VU.hasChild?(Vx.visible=!0,Vx.index=VU.isOpen?1:0,Vx.tag=Va,Vx.off("click",this,this.onArrowClick),Vx.on("click",this,this.onArrowClick)):Vx.visible=!1);var VD=Vn.getChildByName("folder");VD&&(2==VD.clipY?VD.index=VU.isDirectory?0:1:VD.index=VU.isDirectory?VU.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([Vn,Va])}},VU.onArrowClick=function(Vn){var Va=Vn.currentTarget.tag;this._list.array[Va].isOpen=!this._list.array[Va].isOpen,this.event("open"),this._list.array=this.getArray()},VU.setItemState=function(Vn,Va){this._list.array[Vn]&&(this._list.array[Vn].isOpen=Va,this._list.array=this.getArray())},VU.fresh=function(){this._list.array=this.getArray(),this.repaint()},VU.parseXml=function(Vn,Va,VU,Vx){var VD,Vp=Vn.childNodes,VQ=Vp.length;if(!Vx){VD={};var VV,Vy=Vn.attributes;for(var VR in Vy){var VX=(VV=Vy[VR]).nodeName,Vz=VV.nodeValue;VD[VX]="true"==Vz||"false"!=Vz&&Vz}VD.nodeParent=VU,0<VQ&&(VD.isDirectory=!0),VD.hasChild=0<VQ,Va.push(VD)}for(var Vi=0;Vi<VQ;Vi++){var Vq=Vp[Vi];this.parseXml(Vq,Va,VD,!1)}},VU.parseOpenStatus=function(Vn,Va){for(var VU=0,Vx=Va.length;VU<Vx;VU++){var VD=Va[VU];if(VD.isDirectory)for(var Vp=0,VQ=Vn.length;Vp<VQ;Vp++){var VV=Vn[Vp];if(VV.isDirectory&&this.isSameParent(VV,VD)&&VD.label==VV.label){VD.isOpen=VV.isOpen;break}}}},VU.isSameParent=function(Vn,Va){return null==Vn.nodeParent&&null==Va.nodeParent||null!=Vn.nodeParent&&null!=Va.nodeParent&&(Vn.nodeParent.label==Va.nodeParent.label&&this.isSameParent(Vn.nodeParent,Va.nodeParent))},VU.filter=function(Vn){if(Boolean(Vn)){var Va=[];this.getFilterSource(this._source,Va,Vn),this._list.array=Va}else this._list.array=this.getArray()},VU.getFilterSource=function(Vn,Va,VU){var Vx;for(var VD in VU=VU.toLocaleLowerCase(),Vn)!(Vx=Vn[VD]).isDirectory&&-1<String(Vx.label).toLowerCase().indexOf(VU)&&(Vx.x=0,Va.push(Vx)),Vx.child&&0<Vx.child.length&&this.getFilterSource(Vx.child,Va,VU)},VQ(0,VU,"spaceBottom",function(){return this._list.spaceY},function(Vn){this._list.spaceY=Vn}),VQ(0,VU,"keepStatus",function(){return this._keepStatus},function(Vn){this._keepStatus=Vn}),VQ(0,VU,"itemRender",function(){return this._list.itemRender},function(Vn){this._list.itemRender=Vn}),VQ(0,VU,"array",function(){return this._list.array},function(Vn){this._keepStatus&&this._list.array&&Vn&&this.parseOpenStatus(this._list.array,Vn),this._source=Vn,this._list.array=this.getArray()}),VQ(0,VU,"mouseHandler",function(){return this._list.mouseHandler},function(Vn){this._list.mouseHandler=Vn}),VQ(0,VU,"dataSource",Vn.prototype._$get_dataSource,function(Vn){this._dataSource=Vn,Vm.superSet(VI,this,"dataSource",Vn)}),VQ(0,VU,"source",function(){return this._source}),VQ(0,VU,"scrollBar",function(){return this._list.scrollBar}),VQ(0,VU,"list",function(){return this._list}),VQ(0,VU,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(Vn){this._list.vScrollBarSkin=Vn}),VQ(0,VU,"renderHandler",function(){return this._renderHandler},function(Vn){this._renderHandler=Vn}),VQ(0,VU,"selectedIndex",function(){return this._list.selectedIndex},function(Vn){this._list.selectedIndex=Vn}),VQ(0,VU,"spaceLeft",function(){return this._spaceLeft},function(Vn){this._spaceLeft=Vn}),VQ(0,VU,"selectedItem",function(){return this._list.selectedItem},function(Vn){this._list.selectedItem=Vn}),VQ(0,VU,"width",Vn.prototype._$get_width,function(Vn){Vm.superSet(VI,this,"width",Vn),this._list.width=Vn}),VQ(0,VU,"height",Vn.prototype._$get_height,function(Vn){Vm.superSet(VI,this,"height",Vn),this._list.height=Vn}),VQ(0,VU,"xml",null,function(Vn){var Va=[];this.parseXml(Vn.childNodes[0],Va,null,!0),this.array=Va}),VQ(0,VU,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),Va}(VI),Vnn=function(Vn){function Va(){this._items=null,this._selectedIndex=0,Va.__super.call(this),this._setIndexHandler=Vi.create(this,this.setIndex,null,!1)}Vp(Va,"laya.ui.ViewStack",Vn);var VU=Va.prototype;return Vm.imps(VU,{"laya.ui.IItem":!0}),VU.setItems=function(Vn){this.removeChildren();for(var Va=0,VU=0,Vx=Vn.length;VU<Vx;VU++){var VD=Vn[VU];VD&&(VD.name="item"+Va,this.addChild(VD),Va++)}this.initItems()},VU.addItem=function(Vn){Vn.name="item"+this._items.length,this.addChild(Vn),this.initItems()},VU.initItems=function(){this._items=[];for(var Vn=0;Vn<1e4;Vn++){var Va=this.getChildByName("item"+Vn);if(null==Va)break;this._items.push(Va),Va.visible=Vn==this._selectedIndex}},VU.setSelect=function(Vn,Va){this._items&&-1<Vn&&Vn<this._items.length&&(this._items[Vn].visible=Va)},VU.setIndex=function(Vn){this.selectedIndex=Vn},VQ(0,VU,"dataSource",Vn.prototype._$get_dataSource,function(Vn){if("number"==typeof(this._dataSource=Vn)&&Math.floor(Vn)==Vn||"string"==typeof Vn)this.selectedIndex=parseInt(Vn);else for(var Va in this._dataSource)this.hasOwnProperty(Va)&&(this[Va]=this._dataSource[Va])}),VQ(0,VU,"selectedIndex",function(){return this._selectedIndex},function(Vn){this._selectedIndex!=Vn&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=Vn,this.setSelect(this._selectedIndex,!0))}),VQ(0,VU,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(Vn){this.selectedIndex=this._items.indexOf(Vn)}),VQ(0,VU,"items",function(){return this._items}),VQ(0,VU,"setIndexHandler",function(){return this._setIndexHandler},function(Vn){this._setIndexHandler=Vn}),Va}(VI),Van=function(Vn){function Va(){Va.__super.call(this)}return Vp(Va,"laya.ui.VScrollBar",Vf),Va}(),VUn=function(Va){function VU(Vn){this._bg=null,this._skin=null,VU.__super.call(this),void 0===Vn&&(Vn=""),this.text=Vn,this.skin=this.skin}Vp(VU,"laya.ui.TextInput",Va);var Vn=VU.prototype;return Vn.preinitialize=function(){this.mouseEnabled=!0},Vn.destroy=function(Vn){VA.clearCache(this,this._skin),void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,Vn),this._bg&&this._bg.destroy(),this._bg=null},Vn.createChildren=function(){this.addChild(this._tf=new Vq),this._tf.padding=VM.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},Vn._onFocus=function(){this.event("focus",this)},Vn._onBlur=function(){this.event("blur",this)},Vn._onInput=function(){this.event("input",this)},Vn._onEnter=function(){this.event("enter",this)},Vn.initialize=function(){this.width=128,this.height=22},Vn.select=function(){this._tf.select()},Vn.setSelection=function(Vn,Va){this._tf.setSelection(Vn,Va)},VQ(0,Vn,"text",Va.prototype._$get_text,function(Vn){this._tf.text!=Vn&&(Vn+="",this._tf.text=Vn,this.event("change"))}),VQ(0,Vn,"bg",function(){return this._bg},function(Vn){this.graphics=this._bg=Vn}),VQ(0,Vn,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(Vn){this._tf.inputElementYAdjuster=Vn}),VQ(0,Vn,"multiline",function(){return this._tf.multiline},function(Vn){this._tf.multiline=Vn}),VQ(0,Vn,"skin",function(){return this._skin},function(Vn){this._skin!=Vn&&(VA.clearCache(this,this._skin),this._skin=Vn,this._bg||(this.graphics=this._bg=new Vc),VA.keepCache(this,this._skin),this._bg.source=VA.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),VQ(0,Vn,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(Vn){this._bg||(this.graphics=this._bg=new Vc),this._bg.sizeGrid=VZ.fillArray(VM.defaultSizeGrid,Vn,Number)}),VQ(0,Vn,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(Vn){this._tf.inputElementXAdjuster=Vn}),VQ(0,Vn,"width",Va.prototype._$get_width,function(Vn){Vm.superSet(Vo,this,"width",Vn),this._bg&&(this._bg.width=Vn)}),VQ(0,Vn,"height",Va.prototype._$get_height,function(Vn){Vm.superSet(Vo,this,"height",Vn),this._bg&&(this._bg.height=Vn)}),VQ(0,Vn,"editable",function(){return this._tf.editable},function(Vn){this._tf.editable=Vn}),VQ(0,Vn,"restrict",function(){return this._tf.restrict},function(Vn){this._tf.restrict=Vn}),VQ(0,Vn,"prompt",function(){return this._tf.prompt},function(Vn){this._tf.prompt=Vn}),VQ(0,Vn,"promptColor",function(){return this._tf.promptColor},function(Vn){this._tf.promptColor=Vn}),VQ(0,Vn,"maxChars",function(){return this._tf.maxChars},function(Vn){this._tf.maxChars=Vn}),VQ(0,Vn,"focus",function(){return this._tf.focus},function(Vn){this._tf.focus=Vn}),VQ(0,Vn,"type",function(){return this._tf.type},function(Vn){this._tf.type=Vn}),VQ(0,Vn,"asPassword",function(){return this._tf.asPassword},function(Vn){this._tf.asPassword=Vn}),VU}(Vo),Vxn=function(Vn){function Va(){Va.__super.call(this)}return Vp(Va,"laya.ui.VSlider",VF),Va}(),VDn=function(Vn){function Vx(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,Vx.__super.call(this)}Vp(Vx,"laya.ui.Dialog",Vn);var Va=Vx.prototype;return Va.initialize=function(){this.popupEffect=Vx.manager.popupEffectHandler,this.closeEffect=Vx.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},Va._dealDragArea=function(){var Vn=this.getChildByName("drag");Vn&&(this.dragArea=Vn.x+","+Vn.y+","+Vn.width+","+Vn.height,Vn.removeSelf())},Va._onClick=function(Vn){var Va=Vn.target;if(Va)switch(Va.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(Va.name)}},Va.show=function(Vn,Va){void 0===Vn&&(Vn=!1),void 0===Va&&(Va=!0),this._open(!1,Vn,Va)},Va.popup=function(Vn,Va){void 0===Vn&&(Vn=!1),void 0===Va&&(Va=!0),this._open(!0,Vn,Va)},Va._open=function(Vn,Va,VU){Vx.manager.lock(!1),this.isModal=Vn,Vx.manager.open(this,Va,VU)},Va.onOpened=function(){},Va.close=function(Vn,Va){void 0===Va&&(Va=!0),Vx.manager.close(this,Vn,Va)},Va.onClosed=function(Vn){},Va._onMouseDown=function(Vn){var Va=this.getMousePoint();this._dragArea.contains(Va.x,Va.y)?this.startDrag():this.stopDrag()},VQ(0,Va,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(Vn){if(Vn){var Va=VZ.fillArray([0,0,0,0],Vn,Number);this._dragArea=new VP(Va[0],Va[1],Va[2],Va[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),VQ(0,Va,"isPopup",function(){return null!=this.parent}),VQ(0,Va,"zOrder",Vn.prototype._$get_zOrder,function(Vn){Vm.superSet(VO,this,"zOrder",Vn),Vx.manager._checkMask()}),VQ(1,Vx,"manager",function(){return Vx._manager=Vx._manager||new VG},function(Vn){Vx._manager=Vn}),Vx.setLockView=function(Vn){Vx.manager.setLockView(Vn)},Vx.lock=function(Vn){Vx.manager.lock(Vn)},Vx.closeAll=function(){Vx.manager.closeAll()},Vx.getDialogsByGroup=function(Vn){return Vx.manager.getDialogsByGroup(Vn)},Vx.closeByGroup=function(Vn){return Vx.manager.closeByGroup(Vn)},Vx.CLOSE="close",Vx.CANCEL="cancel",Vx.SURE="sure",Vx.NO="no",Vx.OK="ok",Vx.YES="yes",Vx._manager=null,Vx}(VO),Vpn=function(Vn){function Va(){Va.__super.call(this)}Vp(Va,"laya.ui.HBox",Vn);var VU=Va.prototype;return VU.sortItem=function(Vn){Vn&&Vn.sort(function(Vn,Va){return Vn.x-Va.x})},VU.changeItems=function(){this._itemChanged=!1;for(var Vn=[],Va=0,VU=0,Vx=this.numChildren;VU<Vx;VU++){var VD=this.getChildAt(VU);VD&&VD.layoutEnabled&&(Vn.push(VD),Va=this._height?this._height:Math.max(Va,VD.height*VD.scaleY))}this.sortItem(Vn);var Vp=0;for(VU=0,Vx=Vn.length;VU<Vx;VU++)(VD=Vn[VU]).x=Vp,Vp+=VD.width*VD.scaleX+this._space,"top"==this._align?VD.y=0:"middle"==this._align?VD.y=.5*(Va-VD.height*VD.scaleY):"bottom"==this._align&&(VD.y=Va-VD.height*VD.scaleY);this.changeSize()},VQ(0,VU,"height",Vn.prototype._$get_height,function(Vn){this._height!=Vn&&(Vm.superSet(Vd,this,"height",Vn),this.callLater(this.changeItems))}),Va.NONE="none",Va.TOP="top",Va.MIDDLE="middle",Va.BOTTOM="bottom",Va}(Vd),VQn=function(Vn){function Va(){Va.__super.call(this)}Vp(Va,"laya.ui.VBox",Vn);var VU=Va.prototype;return VU.changeItems=function(){this._itemChanged=!1;for(var Vn=[],Va=0,VU=0,Vx=this.numChildren;VU<Vx;VU++){var VD=this.getChildAt(VU);VD&&VD.layoutEnabled&&(Vn.push(VD),Va=this._width?this._width:Math.max(Va,VD.width*VD.scaleX))}this.sortItem(Vn);var Vp=0;for(VU=0,Vx=Vn.length;VU<Vx;VU++)(VD=Vn[VU]).y=Vp,Vp+=VD.height*VD.scaleY+this._space,"left"==this._align?VD.x=0:"center"==this._align?VD.x=.5*(Va-VD.width*VD.scaleX):"right"==this._align&&(VD.x=Va-VD.width*VD.scaleX);this.changeSize()},VQ(0,VU,"width",Vn.prototype._$get_width,function(Vn){this._width!=Vn&&(Vm.superSet(Vd,this,"width",Vn),this.callLater(this.changeItems))}),Va.NONE="none",Va.LEFT="left",Va.CENTER="center",Va.RIGHT="right",Va}(Vd),VVn=function(Vn){function Va(){Va.__super.call(this)}return Vp(Va,"laya.ui.RadioGroup",Vr),Va.prototype.createItem=function(Vn,Va){return new VJ(Vn,Va)},Va}(),Vyn=function(Vn){function Va(){Va.__super.call(this)}return Vp(Va,"laya.ui.Tab",Vr),Va.prototype.createItem=function(Vn,Va){return new Vv(Vn,Va)},Va}(),VRn=function(Va){function VU(Vn){this._vScrollBar=null,this._hScrollBar=null,void 0===Vn&&(Vn=""),VU.__super.call(this,Vn)}Vp(VU,"laya.ui.TextArea",Va);var Vn=VU.prototype;return Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,Vn),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},Vn.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},Vn.onVBarChanged=function(Vn){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},Vn.onHBarChanged=function(Vn){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},Vn.changeScroll=function(){var Vn=this._vScrollBar&&0<this._tf.maxScrollY,Va=this._hScrollBar&&0<this._tf.maxScrollX,VU=Vn?this._width-this._vScrollBar.width:this._width,Vx=Va?this._height-this._hScrollBar.height:this._height,VD=this._tf.padding||VM.labelPadding;this._tf.width=VU,this._tf.height=Vx,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-VD[2],this._vScrollBar.y=VD[1],this._vScrollBar.height=this._height-(Va?this._hScrollBar.height:0)-VD[1]-VD[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=Vx/Math.max(this._tf.textHeight,Vx),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=Vn),this._hScrollBar&&(this._hScrollBar.x=VD[0],this._hScrollBar.y=this._height-this._hScrollBar.height-VD[3],this._hScrollBar.width=this._width-(Vn?this._vScrollBar.width:0)-VD[0]-VD[2],this._hScrollBar.scrollSize=Math.max(.033*VU,1),this._hScrollBar.thumbPercent=VU/Math.max(this._tf.textWidth,VU),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=Va)},Vn.scrollTo=function(Vn){this.commitMeasure(),this._tf.scrollY=Vn},VQ(0,Vn,"scrollY",function(){return this._tf.scrollY}),VQ(0,Vn,"width",Va.prototype._$get_width,function(Vn){Vm.superSet(VUn,this,"width",Vn),this.callLater(this.changeScroll)}),VQ(0,Vn,"hScrollBar",function(){return this._hScrollBar}),VQ(0,Vn,"height",Va.prototype._$get_height,function(Vn){Vm.superSet(VUn,this,"height",Vn),this.callLater(this.changeScroll)}),VQ(0,Vn,"maxScrollX",function(){return this._tf.maxScrollX}),VQ(0,Vn,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(Vn){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new Van),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=Vn}),VQ(0,Vn,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(Vn){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new Vs),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=Vn}),VQ(0,Vn,"vScrollBar",function(){return this._vScrollBar}),VQ(0,Vn,"maxScrollY",function(){return this._tf.maxScrollY}),VQ(0,Vn,"scrollX",function(){return this._tf.scrollX}),VU}(VUn);!function(Vn){function Va(){this._uiView=null,this.isCloseOther=!1,Va.__super.call(this)}Vp(Va,"laya.ui.AsynDialog",VDn);var VU=Va.prototype;VU.createView=function(Vn){this._uiView=Vn},VU._open=function(Vn,Va,VU){this.isModal=Vn,this.isCloseOther=Va,VDn.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},VU.onCreated=function(){this.createUI(),this.onOpen()},VU.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},VU.onOpen=function(){VDn.manager.open(this,this.isCloseOther),VDn.manager.lock(!1)},VU.close=function(Vn,Va){void 0===Va&&(Va=!0),VDn.manager.close(this),this.onClose()},VU.onClose=function(){},VU.destroy=function(Vn){void 0===Vn&&(Vn=!0),laya.ui.View.prototype.destroy.call(this,Vn),this._uiView=null,this.onDestroy()},VU.onDestroy=function(){}}();Vm.__init([VO])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Vn,Va){"use strict";for(var VU in Object.defineProperty(Va,"__esModule",{value:!0}),Laya){var Vx=Laya[VU];Vx&&Vx.__isclass&&(Va[VU]=Vx)}}),function(Vi,Vn,VY){VY.un,VY.uns;var Vz=VY.static,Vq=VY.class,VE=VY.getset,Vx=VY.__newvec,VK=laya.maths.Arith,VQ=laya.webgl.atlas.AtlasResourceManager,VU=laya.webgl.shader.BaseShader,VH=laya.utils.Browser,VV=laya.webgl.utils.Buffer,VW=laya.utils.Byte,VD=laya.utils.ClassUtils,Vy=VY.Config,Vp=(laya.events.Event,laya.events.EventDispatcher),VM=laya.utils.Handler,VP=laya.net.Loader,Va=laya.net.LoaderManager,VR=(laya.maths.MathUtil,laya.display.Node),Vm=laya.renders.Render,VX=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),Vb=laya.resource.Resource,VA=laya.utils.RunDriver,VT=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),Vk=laya.display.Sprite,VN=laya.utils.Stat,V_=laya.utils.StringKey,VZ=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),V$=laya.utils.Utils,Vu=laya.webgl.WebGL,Vc=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;VY.interface("laya.d3.core.IClone"),VY.interface("laya.d3.graphics.IVertex"),VY.interface("laya.d3.core.render.IUpdate"),VY.interface("laya.d3.core.scene.ITreeNode"),VY.interface("laya.d3.core.render.IRenderable");(function(){function Vv(){}Vq(Vv,"laya.d3.animation.AnimationClipParser01"),Vv.READ_DATA=function(){Vv._DATA.offset=Vv._reader.getUint32(),Vv._DATA.size=Vv._reader.getUint32()},Vv.READ_BLOCK=function(){for(var Vn=Vv._BLOCK.count=Vv._reader.getUint16(),Va=Vv._BLOCK.blockStarts=[],VU=Vv._BLOCK.blockLengths=[],Vx=0;Vx<Vn;Vx++)Va.push(Vv._reader.getUint32()),VU.push(Vv._reader.getUint32())},Vv.READ_STRINGS=function(){var Vn=Vv._reader.getUint32(),Va=Vv._reader.getUint16(),VU=Vv._reader.pos;Vv._reader.pos=Vn+Vv._DATA.offset;for(var Vx=0;Vx<Va;Vx++)Vv._strings[Vx]=Vv._reader.readUTFString();Vv._reader.pos=VU},Vv.parse=function(Vn,Va){Vv._animationClip=Vn;(Vv._reader=Va).__getBuffer();Vv.READ_DATA(),Vv.READ_BLOCK(),Vv.READ_STRINGS();for(var VU=0,Vx=Vv._BLOCK.count;VU<Vx;VU++){var VD=Va.getUint16(),Vp=Vv._strings[VD],VQ=Vv["READ_"+Vp];if(null==VQ)throw new Error("model file err,no this function:"+VD+" "+Vp);VQ.call()}},Vv.READ_ANIMATIONS=function(){var Vn,Va=0,VU=0,Vx=Vv._reader,VD=Vx.__getBuffer(),Vp=[],VQ=Vx.getUint8();for(Vp.length=VQ,Va=0;Va<VQ;Va++)Vp[Va]=Vx.getUint16();var VV=[],Vy=Vx.getUint16();for(VV.length=Vy,Va=0;Va<Vy;Va++)VV[Va]=Vx.getFloat32();var VR=Vv._animationClip;VR.name=Vv._strings[Vx.getUint16()];var VX=VR._duration=Vx.getFloat32();VR.islooping=!!Vx.getByte(),VR._frameRate=Vx.getInt16();var Vz=Vx.getInt16(),Vi=VR._nodes=new Array;Vi.length=Vz,(VR._publicClipDatas=[]).length=Vz;var Vq=VR._nodesMap={},VE=0,Vm=0;for(Va=0;Va<Vz;Va++){Vn=Vi[Va]=new VB;var Vb=Vx.getUint16(),VP=Vn.path=[];for(VP.length=Vb,VU=0;VU<Vb;VU++)VP[VU]=Vv._strings[Vx.getUint16()];var VA=VP.join("/"),VT=Vq[VA];VT||(Vq[VA]=VT=[]),VT.push(Vn);var VK=Vx.getInt16();-1!==VK&&(Vn.componentType=Vv._strings[VK]);var VY=Vg._propertyIndexDic[Vv._strings[Vx.getUint16()]];if(null==VY)throw new Error("AnimationClipParser01:unknown property name.");var VW=VY<4,Vk=!VW||VW&&""===VP[0];(Vn._cacheProperty=Vk)?VE++:Vm++,Vn.propertyNameID=VY;var VN=Vp[Vx.getUint8()];Vn.keyFrameWidth=VN/4;var V_=Vn.keyFrames=[],V$=V_.length=Vx.getUint16(),VM=null,VZ=NaN;for(VU=0;VU<V$;VU++){var Vu=V_[VU]=new Vo;VZ=Vu.startTime=VV[Vx.getUint16()];var Vc=Vx.pos;Vu.inTangent=new Float32Array(VD.slice(Vc,Vc+VN)),Vx.pos+=VN,Vc=Vx.pos,Vu.outTangent=new Float32Array(VD.slice(Vc,Vc+VN)),Vx.pos+=VN,Vc=Vx.pos,Vu.data=new Float32Array(VD.slice(Vc,Vc+VN)),Vx.pos+=VN,VM&&(VM.next=Vu,VM.duration=VZ-VM.startTime),VM=Vu}Vu.next=null,Vu.duration=VX-VZ}var VH=VR._nodeToCachePropertyMap=new Int32Array(Vz),VG=VR._cachePropertyMap=new Int32Array(VE),VI=VR._unCachePropertyMap=new Int32Array(Vm);for(VE=Vm=0,Va=0;Va<Vz;Va++)(Vn=Vi[Va])._cacheProperty?(VH[Va]=VE,VG[VE++]=Va):VI[Vm++]=Va},Vv._animationClip=null,Vv._reader=null,Vv._strings=[],Vz(Vv,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function Vf(){}Vq(Vf,"laya.d3.animation.AnimationClipParser02"),Vf.READ_DATA=function(){Vf._DATA.offset=Vf._reader.getUint32(),Vf._DATA.size=Vf._reader.getUint32()},Vf.READ_BLOCK=function(){for(var Vn=Vf._BLOCK.count=Vf._reader.getUint16(),Va=Vf._BLOCK.blockStarts=[],VU=Vf._BLOCK.blockLengths=[],Vx=0;Vx<Vn;Vx++)Va.push(Vf._reader.getUint32()),VU.push(Vf._reader.getUint32())},Vf.READ_STRINGS=function(){var Vn=Vf._reader.getUint32(),Va=Vf._reader.getUint16(),VU=Vf._reader.pos;Vf._reader.pos=Vn+Vf._DATA.offset;for(var Vx=0;Vx<Va;Vx++)Vf._strings[Vx]=Vf._reader.readUTFString();Vf._reader.pos=VU},Vf.parse=function(Vn,Va){Vf._animationClip=Vn;(Vf._reader=Va).__getBuffer();Vf.READ_DATA(),Vf.READ_BLOCK(),Vf.READ_STRINGS();for(var VU=0,Vx=Vf._BLOCK.count;VU<Vx;VU++){var VD=Va.getUint16(),Vp=Vf._strings[VD],VQ=Vf["READ_"+Vp];if(null==VQ)throw new Error("model file err,no this function:"+VD+" "+Vp);VQ.call()}},Vf.READ_ANIMATIONS=function(){var Vn,Va=0,VU=0,Vx=Vf._reader,VD=Vx.__getBuffer(),Vp=[],VQ=Vx.getUint8();for(Vp.length=VQ,Va=0;Va<VQ;Va++)Vp[Va]=Vx.getUint16();var VV=[],Vy=Vx.getUint16();for(VV.length=Vy,Va=0;Va<Vy;Va++)VV[Va]=Vx.getFloat32();var VR=Vf._animationClip;VR.name=Vf._strings[Vx.getUint16()];var VX=VR._duration=Vx.getFloat32();VR.islooping=!!Vx.getByte(),VR._frameRate=Vx.getInt16();var Vz=Vx.getInt16(),Vi=VR._nodes=new Array;Vi.length=Vz,(VR._publicClipDatas=[]).length=Vz;var Vq=VR._nodesMap={},VE=0,Vm=0;for(Va=0;Va<Vz;Va++){Vn=Vi[Va]=new VB;var Vb=Vx.getUint16(),VP=Vn.path=[];for(VP.length=Vb,VU=0;VU<Vb;VU++)VP[VU]=Vf._strings[Vx.getUint16()];var VA=VP.join("/"),VT=Vq[VA];VT||(Vq[VA]=VT=[]),VT.push(Vn);var VK=Vx.getInt16();-1!==VK&&(Vn.componentType=Vf._strings[VK]);var VY=Vg._propertyIndexDic[Vf._strings[Vx.getUint16()]];if(null==VY)throw new Error("AnimationClipParser02:unknown property name.");var VW=VY<4,Vk=!VW||VW&&""===VP[0];(Vn._cacheProperty=Vk)?VE++:Vm++,Vn.propertyNameID=VY;var VN=Vp[Vx.getUint8()];Vn.keyFrameWidth=VN/4;var V_=Vn.keyFrames=[],V$=V_.length=Vx.getUint16(),VM=null,VZ=NaN;for(VU=0;VU<V$;VU++){var Vu=V_[VU]=new Vo;VZ=Vu.startTime=VV[Vx.getUint16()];var Vc=Vx.pos;Vu.inTangent=new Float32Array(VD.slice(Vc,Vc+VN)),Vx.pos+=VN,Vc=Vx.pos,Vu.outTangent=new Float32Array(VD.slice(Vc,Vc+VN)),Vx.pos+=VN,Vc=Vx.pos,Vu.data=new Float32Array(VD.slice(Vc,Vc+VN)),Vx.pos+=VN,VM&&(VM.next=Vu,VM.duration=VZ-VM.startTime),VM=Vu}Vu.next=null,Vu.duration=VX-VZ}var VH=Vx.getUint16();for(Va=0;Va<VH;Va++){var VG,VI=new VF;VI.time=Vx.getFloat32(),VI.eventName=Vf._strings[Vx.getUint16()];var Vv=Vx.getUint16();for(0<Vv&&(VI.params=VG=[]),VU=0;VU<Vv;VU++){switch(Vx.getByte()){case 0:VG.push(!!Vx.getByte());break;case 1:VG.push(Vx.getInt32());break;case 2:VG.push(Vx.getFloat32());break;case 3:VG.push(Vf._strings[Vx.getUint16()]);break;default:throw new Error("unknown type.")}}VR.addEvent(VI)}var Vl=VR._nodeToCachePropertyMap=new Int32Array(Vz),Vj=VR._cachePropertyMap=new Int32Array(VE),Vh=VR._unCachePropertyMap=new Int32Array(Vm);for(VE=Vm=0,Va=0;Va<Vz;Va++)(Vn=Vi[Va])._cacheProperty?(Vl[Va]=VE,Vj[VE++]=Va):Vh[Vm++]=Va},Vf._animationClip=null,Vf._reader=null,Vf._strings=[],Vz(Vf,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var VF=function(){function Vn(){this.time=NaN,this.eventName=null,this.params=null}return Vq(Vn,"laya.d3.animation.AnimationEvent"),Vn}(),Vg=function(){function Vx(){this._childs=[],this.transform=new VAa(this)}Vq(Vx,"laya.d3.animation.AnimationNode");var Vn=Vx.prototype;return VY.imps(Vn,{"laya.d3.core.IClone":!0}),Vn.addChild=function(Vn){Vn._parent=this,Vn.transform.setParent(this.transform),this._childs.push(Vn)},Vn.removeChild=function(Vn){var Va=this._childs.indexOf(Vn);-1!==Va&&this._childs.splice(Va,1)},Vn.getChildByName=function(Vn){for(var Va=0,VU=this._childs.length;Va<VU;Va++){var Vx=this._childs[Va];if(Vx.name===Vn)return Vx}return null},Vn.getChildByIndex=function(Vn){return this._childs[Vn]},Vn.getChildCount=function(){return this._childs.length},Vn.cloneTo=function(Vn){var Va=Vn;Va.name=this.name;for(var VU=0,Vx=this._childs.length;VU<Vx;VU++){var VD=this._childs[VU],Vp=VD.clone();Va.addChild(Vp);var VQ=VD.transform,VV=Vp.transform;VV.setLocalPosition(VQ.getLocalPosition()),VV.setLocalRotation(VQ.getLocalRotation()),VV.setLocalScale(VQ.getLocalScale()),VV._localRotationEuler=VQ._localRotationEuler,VV._setWorldMatrixIgnoreUpdate(VQ.getWorldMatrix())}},Vn.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},Vx.__init__=function(){Vx.registerAnimationNodeProperty("localPosition",Vx._getLocalPosition,Vx._setLocalPosition),Vx.registerAnimationNodeProperty("localRotation",Vx._getLocalRotation,Vx._setLocalRotation),Vx.registerAnimationNodeProperty("localScale",Vx._getLocalScale,Vx._setLocalScale),Vx.registerAnimationNodeProperty("localRotationEuler",Vx._getLocalRotationEuler,Vx._setLocalRotationEuler),Vx.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",Vx._getParticleRenderSharedMaterialTintColor,Vx._setParticleRenderSharedMaterialTintColor),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",Vx._getMeshRenderSharedMaterialTilingOffset,Vx._setMeshRenderSharedMaterialTilingOffset),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",Vx._getMeshRenderSharedMaterialAlbedo,Vx._setMeshRenderSharedMaterialAlbedo),Vx.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",Vx._getSkinnedMeshRenderSharedMaterialTilingOffset,Vx._setSkinnedMeshRenderSharedMaterialTilingOffset),Vx.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",Vx._getSkinnedMeshRenderSharedMaterialAlbedo,Vx._setSkinnedMeshRenderSharedMaterialAlbedo),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",Vx._getMeshRenderSharedMaterialAlbedo,Vx._setMeshRenderSharedMaterialAlbedo),Vx.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",Vx._getSkinnedMeshRenderSharedMaterialAlbedo,Vx._setSkinnedMeshRenderSharedMaterialAlbedo),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",Vx._getMeshRenderSharedMaterialIntensity,Vx._setMeshRenderSharedMaterialIntensity),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",Vx._getMeshRenderSharedMaterialAlpha,Vx._setMeshRenderSharedMaterialAlpha),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",Vx._getMeshRenderSharedMaterialAlphaColor,Vx._setMeshRenderSharedMaterialAlphaColor),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",Vx._getMeshRenderSharedMaterialBaseColor,Vx._setMeshRenderSharedMaterialBaseColor),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",Vx._getMeshRenderSharedMaterialDissolve,Vx._setMeshRenderSharedMaterialDissolve),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",Vx._getMeshRenderSharedMaterialDissolveSpeed,Vx._setMeshRenderSharedMaterialDissolveSpeed),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",Vx._getMeshRenderSharedMaterialMMultiplier,Vx._setMeshRenderSharedMaterialMMultiplier),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",Vx._getMeshRenderSharedMaterialBaseScrollSpeedX,Vx._setMeshRenderSharedMaterialBaseScrollSpeedX),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",Vx._getMeshRenderSharedMaterialBaseScrollSpeedY,Vx._setMeshRenderSharedMaterialBaseScrollSpeedY),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",Vx._getMeshRenderSharedMaterialSecondScrollSpeedX,Vx._setMeshRenderSharedMaterialSecondScrollSpeedX),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",Vx._getMeshRenderSharedMaterialSecondScrollSpeedY,Vx._setMeshRenderSharedMaterialSecondScrollSpeedY),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",Vx._getMeshRenderSharedMaterialDetailTilingOffset,Vx._setMeshRenderSharedMaterialDetailTilingOffset),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",Vx._getMeshRenderSharedMaterialDissolveTilingOffset,Vx._setMeshRenderSharedMaterialDissolveTilingOffset),Vx.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",Vx._getMeshRenderSharedMaterialMaskTilingOffset,Vx._setMeshRenderSharedMaterialMaskTilingOffset)},Vx.registerAnimationNodeProperty=function(Vn,Va,VU){if(Vx._propertyIndexDic[Vn])throw new Error("AnimationNode: this propertyName has registered.");Vx._propertyIndexDic[Vn]=Vx._propertyIDCounter,Vx._propertyGetFuncs[Vx._propertyIDCounter]=Va,Vx._propertySetFuncs[Vx._propertyIDCounter]=VU,Vx._propertyIDCounter++},Vx._getLocalPosition=function(Vn,Va){return Vn?Vn.transform.getLocalPosition():Va._transform.localPosition.elements},Vx._setLocalPosition=function(Vn,Va,VU){if(Vn)Vn.transform.setLocalPosition(VU);else{var Vx=Va._transform,VD=Vx.localPosition;VD.elements=VU,Vx.localPosition=VD}},Vx._getLocalRotation=function(Vn,Va){return Vn?Vn.transform.getLocalRotation():Va._transform.localRotation.elements},Vx._setLocalRotation=function(Vn,Va,VU){if(Vn)Vn.transform.setLocalRotation(VU);else{var Vx=Va._transform,VD=Vx.localRotation;VD.elements=VU,Vx.localRotation=VD}},Vx._getLocalScale=function(Vn,Va){return Vn?Vn.transform.getLocalScale():Va._transform.localScale.elements},Vx._setLocalScale=function(Vn,Va,VU){if(Vn)Vn.transform.setLocalScale(VU);else{var Vx=Va._transform,VD=Vx.localScale;VD.elements=VU,Vx.localScale=VD}},Vx._getLocalRotationEuler=function(Vn,Va){return Vn?Vn.transform.getLocalRotationEuler():Va._transform.localRotationEuler.elements},Vx._setLocalRotationEuler=function(Vn,Va,VU){if(Vn)Vn.transform.setLocalRotationEuler(VU);else{var Vx=Va._transform,VD=Vx.localRotationEuler;VD.elements=VU,Vx.localRotationEuler=VD}},Vx._getMeshRenderSharedMaterialTilingOffset=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return Va.meshRender.sharedMaterial.tilingOffset.elements},Vx._setMeshRenderSharedMaterialTilingOffset=function(Vn,Va,VU){var Vx,VD;if(Vn){var Vp=Vn.transform._entity;Vp&&((VD=(Vx=Vp.owner.meshRender.material).tilingOffset).elements=VU,Vx.tilingOffset=VD)}else(VD=(Vx=Va.meshRender.material).tilingOffset).elements=VU,Vx.tilingOffset=VD},Vx._getMeshRenderSharedMaterialAlbedo=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.albedoColor.elements:null}return Va.meshRender.sharedMaterial.albedoColor.elements},Vx._setMeshRenderSharedMaterialAlbedo=function(Vn,Va,VU){var Vx,VD;if(Vn){var Vp=Vn.transform._entity;Vp&&((VD=(Vx=Vp.owner.meshRender.material).albedoColor).elements=VU,Vx.albedoColor=VD)}else(VD=(Vx=Va.meshRender.material).albedoColor).elements=VU,Vx.albedoColor=VD},Vx._getSkinnedMeshRenderSharedMaterialTilingOffset=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return Va.skinnedMeshRender.sharedMaterial.tilingOffset.elements},Vx._setSkinnedMeshRenderSharedMaterialTilingOffset=function(Vn,Va,VU){var Vx,VD;if(Vn){var Vp=Vn.transform._entity;Vp&&((VD=(Vx=Vp.owner.skinnedMeshRender.material).tilingOffset).elements=VU,Vx.tilingOffset=VD)}else(VD=(Vx=Va.skinnedMeshRender.material).tilingOffset).elements=VU,Vx.tilingOffset=VD},Vx._getSkinnedMeshRenderSharedMaterialAlbedo=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return Va.skinnedMeshRender.sharedMaterial.albedoColor.elements},Vx._setSkinnedMeshRenderSharedMaterialAlbedo=function(Vn,Va,VU){var Vx,VD;if(Vn){var Vp=Vn.transform._entity;Vp&&((VD=(Vx=Vp.owner.skinnedMeshRender.material).albedoColor).elements=VU,Vx.albedoColor=VD)}else(VD=(Vx=Va.skinnedMeshRender.material).albedoColor).elements=VU,Vx.albedoColor=VD},Vx._getParticleRenderSharedMaterialTintColor=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.particleRender.sharedMaterial.tintColor.elements:null}return Va.particleRender.sharedMaterial.tintColor.elements},Vx._setParticleRenderSharedMaterialTintColor=function(Vn,Va,VU){var Vx,VD;if(Vn){var Vp=Vn.transform._entity;Vp&&((VD=(Vx=Vp.owner.particleRender.material).tintColor).elements=VU,Vx.tintColor=VD)}else(VD=(Vx=Va.particleRender.material).tintColor).elements=VU,Vx.tintColor=VD},Vx._getMeshRenderSharedMaterialAlphaColor=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.alphaColor.elements:null}return Va.meshRender.sharedMaterial.alphaColor.elements},Vx._setMeshRenderSharedMaterialAlphaColor=function(Vn,Va,VU){var Vx,VD;if(Vn){var Vp=Vn.transform._entity;Vp&&((VD=(Vx=Vp.owner.meshRender.material).alphaColor).elements=VU,Vx.alphaColor=VD)}else(VD=(Vx=Va.meshRender.material).alphaColor).elements=VU,Vx.alphaColor=VD},Vx._getMeshRenderSharedMaterialBaseColor=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.baseColor.elements:null}return Va.meshRender.sharedMaterial.baseColor.elements},Vx._setMeshRenderSharedMaterialBaseColor=function(Vn,Va,VU){var Vx,VD;if(Vn){var Vp=Vn.transform._entity;Vp&&((VD=(Vx=Vp.owner.meshRender.material).baseColor).elements=VU,Vx.baseColor=VD)}else(VD=(Vx=Va.meshRender.material).baseColor).elements=VU,Vx.baseColor=VD},Vx._getMeshRenderSharedMaterialDissolve=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.dissolve:0}return Va.meshRender.sharedMaterial.dissolve},Vx._setMeshRenderSharedMaterialDissolve=function(Vn,Va,VU){if(Vn){var Vx=Vn.transform._entity;Vx&&(Vx.owner.meshRender.material.dissolve=VU[0])}else Va.meshRender.material.dissolve=VU[0]},Vx._getMeshRenderSharedMaterialDissolveSpeed=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.dissolveSpeed:0}return Va.meshRender.sharedMaterial.dissolveSpeed},Vx._setMeshRenderSharedMaterialDissolveSpeed=function(Vn,Va,VU){if(Vn){var Vx=Vn.transform._entity;Vx&&(Vx.owner.meshRender.material.dissolveSpeed=VU[0])}else Va.meshRender.material.dissolveSpeed=VU[0]},Vx._getMeshRenderSharedMaterialMMultiplier=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.mMultiplier:0}return Va.meshRender.sharedMaterial.mMultiplier},Vx._setMeshRenderSharedMaterialMMultiplier=function(Vn,Va,VU){if(Vn){var Vx=Vn.transform._entity;Vx&&(Vx.owner.meshRender.material.mMultiplier=VU[0])}else Va.meshRender.material.mMultiplier=VU[0]},Vx._getMeshRenderSharedMaterialBaseScrollSpeedX=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return Va.meshRender.sharedMaterial.baseScrollSpeedX},Vx._setMeshRenderSharedMaterialBaseScrollSpeedX=function(Vn,Va,VU){if(Vn){var Vx=Vn.transform._entity;Vx&&(Vx.owner.meshRender.material.baseScrollSpeedX=VU[0])}else Va.meshRender.material.baseScrollSpeedX=VU[0]},Vx._getMeshRenderSharedMaterialBaseScrollSpeedY=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return Va.meshRender.sharedMaterial.baseScrollSpeedY},Vx._setMeshRenderSharedMaterialBaseScrollSpeedY=function(Vn,Va,VU){if(Vn){var Vx=Vn.transform._entity;Vx&&(Vx.owner.meshRender.material.baseScrollSpeedY=VU[0])}else Va.meshRender.material.baseScrollSpeedY=VU[0]},Vx._getMeshRenderSharedMaterialSecondScrollSpeedX=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return Va.meshRender.sharedMaterial.secondScrollSpeedX},Vx._setMeshRenderSharedMaterialSecondScrollSpeedX=function(Vn,Va,VU){if(Vn){var Vx=Vn.transform._entity;Vx&&(Vx.owner.meshRender.material.secondScrollSpeedX=VU[0])}else Va.meshRender.material.secondScrollSpeedX=VU[0]},Vx._getMeshRenderSharedMaterialSecondScrollSpeedY=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return Va.meshRender.sharedMaterial.secondScrollSpeedY},Vx._setMeshRenderSharedMaterialSecondScrollSpeedY=function(Vn,Va,VU){if(Vn){var Vx=Vn.transform._entity;Vx&&(Vx.owner.meshRender.material.secondScrollSpeedY=VU[0])}else Va.meshRender.material.secondScrollSpeedY=VU[0]},Vx._getMeshRenderSharedMaterialAlpha=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.alpha:0}return Va.meshRender.sharedMaterial.alpha},Vx._setMeshRenderSharedMaterialAlpha=function(Vn,Va,VU){if(Vn){var Vx=Vn.transform._entity;Vx&&(Vx.owner.meshRender.material.alpha=VU[0])}else Va.meshRender.material.alpha=VU[0]},Vx._getMeshRenderSharedMaterialIntensity=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.intensity:0}return Va.meshRender.sharedMaterial.intensity},Vx._setMeshRenderSharedMaterialIntensity=function(Vn,Va,VU){if(Vn){var Vx=Vn.transform._entity;Vx&&(Vx.owner.meshRender.material.intensity=VU[0])}else Va.meshRender.material.intensity=VU[0]},Vx._getMeshRenderSharedMaterialDetailTilingOffset=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return Va.meshRender.sharedMaterial.detailTilingOffset.elements},Vx._setMeshRenderSharedMaterialDetailTilingOffset=function(Vn,Va,VU){var Vx,VD;if(Vn){var Vp=Vn.transform._entity;Vp&&((VD=(Vx=Vp.owner.meshRender.material).detailTilingOffset).elements=VU,Vx.detailTilingOffset=VD)}else(VD=(Vx=Va.meshRender.material).detailTilingOffset).elements=VU,Vx.detailTilingOffset=VD},Vx._getMeshRenderSharedMaterialDissolveTilingOffset=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return Va.meshRender.sharedMaterial.dissolveTilingOffset.elements},Vx._setMeshRenderSharedMaterialDissolveTilingOffset=function(Vn,Va,VU){var Vx,VD;if(Vn){var Vp=Vn.transform._entity;Vp&&((VD=(Vx=Vp.owner.meshRender.material).dissolveTilingOffset).elements=VU,Vx.dissolveTilingOffset=VD)}else(VD=(Vx=Va.meshRender.material).dissolveTilingOffset).elements=VU,Vx.dissolveTilingOffset=VD},Vx._getMeshRenderSharedMaterialMaskTilingOffset=function(Vn,Va){if(Vn){var VU=Vn.transform._entity;return VU?VU.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return Va.meshRender.sharedMaterial.maskTilingOffset.elements},Vx._setMeshRenderSharedMaterialMaskTilingOffset=function(Vn,Va,VU){var Vx,VD;if(Vn){var Vp=Vn.transform._entity;Vp&&((VD=(Vx=Vp.owner.meshRender.material).maskTilingOffset).elements=VU,Vx.maskTilingOffset=VD)}else(VD=(Vx=Va.meshRender.material).maskTilingOffset).elements=VU,Vx.maskTilingOffset=VD},Vx._propertyIDCounter=0,Vx._propertyIndexDic={},Vx._propertySetFuncs=[],Vx._propertyGetFuncs=[],Vx}(),Vo=function(){function Vn(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return Vq(Vn,"laya.d3.animation.Keyframe"),Vn}(),VB=function(){function Vn(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return Vq(Vn,"laya.d3.animation.KeyframeNode"),Vn}(),VG=(function(){function Vn(){this._tempVector30=new VQa,this._tempVector31=new VQa,this._tempVector32=new VQa,this._a=new VQa,this._b=new VQa,this._c=new VQa,this._d=new VQa}Vq(Vn,"laya.d3.core.glitter.SplineCurvePositionVelocity");var Va=Vn.prototype;Va.Init=function(Vn,Va,VU,Vx){Vn.cloneTo(this._d),Va.cloneTo(this._c),VQa.scale(Vn,2,this._a),VQa.scale(VU,2,this._tempVector30),VQa.subtract(this._a,this._tempVector30,this._a),VQa.add(this._a,Va,this._a),VQa.add(this._a,Vx,this._a),VQa.scale(VU,3,this._b),VQa.scale(Vn,3,this._tempVector30),VQa.subtract(this._b,this._tempVector30,this._b),VQa.subtract(this._b,Vx,this._b),VQa.scale(Va,2,this._tempVector30),VQa.subtract(this._b,this._tempVector30,this._b)},Va.Slerp=function(Vn,Va){VQa.scale(this._a,Vn*Vn*Vn,this._tempVector30),VQa.scale(this._b,Vn*Vn,this._tempVector31),VQa.scale(this._c,Vn,this._tempVector32),VQa.add(this._tempVector30,this._tempVector31,Va),VQa.add(Va,this._tempVector32,Va),VQa.add(Va,this._d,Va)}}(),function(){function Vj(Vn,Va,VU,Vx){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=Vn,this._h=Va,this._minHeight=VU,this._maxHeight=Vx}Vq(Vj,"laya.d3.core.HeightMap");var Vn=Vj.prototype;Vn._inBounds=function(Vn,Va){return 0<=Vn&&Vn<this._h&&0<=Va&&Va<this._w},Vn.getHeight=function(Vn,Va){return this._inBounds(Vn,Va)?this._datas[Vn][Va]:NaN},VE(0,Vn,"width",function(){return this._w}),VE(0,Vn,"height",function(){return this._h}),VE(0,Vn,"maxHeight",function(){return this._maxHeight}),VE(0,Vn,"minHeight",function(){return this._minHeight}),Vj.creatFromMesh=function(Vn,Va,VU,Vx){for(var VD=[],Vp=[],VQ=Vn.getSubMeshCount(),VV=0;VV<VQ;VV++){for(var Vy=Vn.getSubMesh(VV),VR=Vy._getVertexBuffer(),VX=VR.getData(),Vz=[],Vi=0;Vi<VX.length;Vi+=VR.vertexDeclaration.vertexStride/4){var Vq=new VQa(VX[Vi+0],VX[Vi+1],VX[Vi+2]);Vz.push(Vq)}VD.push(Vz);var VE=Vy._getIndexBuffer();Vp.push(VE.getData())}var Vm=Vn.boundingBox,Vb=Vm.min.x,VP=Vm.min.z,VA=Vm.max.x,VT=Vm.max.z,VK=Vm.min.y,VY=Vm.max.y,VW=VA-Vb,Vk=VT-VP,VN=Vx.elements[0]=VW/(Va-1),V_=Vx.elements[1]=Vk/(VU-1),V$=new Vj(Va,VU,VK,VY),VM=Vj._tempRay,VZ=VM.direction.elements;VZ[0]=0,VZ[1]=-1,VZ[2]=0;var Vu=VY+.1;VM.origin.elements[1]=Vu;for(var Vc=0;Vc<VU;Vc++){var VH=VP+Vc*V_;V$._datas[Vc]=[];for(var VG=0;VG<Va;VG++){var VI=Vb+VG*VN,Vv=VM.origin.elements;Vv[0]=VI,Vv[2]=VH;var Vl=Vj._getPosition(VM,VD,Vp);V$._datas[Vc][VG]=Vl===Number.MAX_VALUE?NaN:Vu-Vl}}return V$},Vj.createFromImage=function(Vn,Va,VU){for(var Vx=Vn.width,VD=Vn.height,Vp=new Vj(Vx,VD,Va,VU),VQ=(VU-Va)/254,VV=Vn.getPixels(),Vy=0,VR=0;VR<VD;VR++)for(var VX=Vp._datas[VR]=[],Vz=0;Vz<Vx;Vz++){var Vi=VV[Vy++],Vq=VV[Vy++],VE=VV[Vy++],Vm=VV[Vy++];VX[Vz]=255==Vi&&255==Vq&&255==VE&&255==Vm?NaN:(Vi+Vq+VE)/3*VQ+Va}return Vp},Vj._getPosition=function(Vn,Va,VU){for(var Vx=Number.MAX_VALUE,VD=0;VD<Va.length;VD++)for(var Vp=Va[VD],VQ=VU[VD],VV=0;VV<VQ.length;VV+=3){var Vy=Vp[VQ[VV+0]],VR=Vp[VQ[VV+1]],VX=Vp[VQ[VV+2]],Vz=VEa.rayIntersectsTriangle(Vn,Vy,VR,VX);!isNaN(Vz)&&Vz<Vx&&(Vx=Vz)}return Vx},Vz(Vj,["_tempRay",function(){return this._tempRay=new VDa(new VQa,new VQa)}])}(),function(){function VD(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}Vq(VD,"laya.d3.core.Layer");var Vn=VD.prototype;return Vn._binarySearchIndex=function(){for(var Vn=0,Va=VD._collsionTestList.length-1,VU=0;Vn<=Va;){VU=Math.floor((Vn+Va)/2);var Vx=VD._collsionTestList[VU];if(Vx==this._number)return VU;Vx>this._number?Va=VU-1:Vn=VU+1}return Vn},Vn._addCollider=function(Vn){0===this._colliders.length&&VD._collsionTestList.splice(this._binarySearchIndex(),0,this._number),Vn._isRigidbody?(this._colliders.unshift(Vn),this._nonRigidbodyOffset++):this._colliders.push(Vn)},Vn._removeCollider=function(Vn){var Va=this._colliders.indexOf(Vn);Va<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(Va,1),0===this._colliders.length&&VD._collsionTestList.splice(VD._collsionTestList.indexOf(this._number),1)},VE(0,Vn,"number",function(){return this._number}),VE(0,Vn,"visible",function(){return this._visible},function(Vn){this._visible=Vn,VD._visibleLayers=Vn?VD._visibleLayers|this.mask:VD._visibleLayers&~this.mask}),VE(0,Vn,"mask",function(){return this._mask}),VE(1,VD,"visibleLayers",function(){return VD._visibleLayers},function(Vn){VD._visibleLayers=Vn;for(var Va=0,VU=VD._layerList.length;Va<VU;Va++){var Vx=VD._layerList[Va];Vx._visible=0!=(Vx._mask&VD._visibleLayers)}}),VD.__init__=function(){VD._layerList.length=31;for(var Vn=0;Vn<31;Vn++){var Va=new VD;VD._layerList[Vn]=Va,0===Vn?(Va.name="Default Layer",Va.visible=!0):(Va.name="Layer-"+Vn,Va.visible=!1),Va._number=Vn,Va._mask=Math.pow(2,Vn)}VD.currentCreationLayer=VD._layerList[0]},VD.getLayerByNumber=function(Vn){if(Vn<0||30<Vn)throw new Error("无法返回指定Layer，该number超出范围！");return VD._layerList[Vn]},VD.getLayerByName=function(Vn){for(var Va=0;Va<31;Va++)if(VD._layerList[Va].name===Vn)return VD._layerList[Va];throw new Error("无法返回指定Layer,该name不存在")},VD.isVisible=function(Vn){return 0!=(Vn&VD._currentCameraCullingMask&VD._visibleLayers)},VD._layerList=[],VD._visibleLayers=2147483647,VD._collsionTestList=[],VD._currentCameraCullingMask=2147483647,VD.maxCount=31,VD.currentCreationLayer=null,VD}()),VI=(function(){function Vn(Vn,Va,VU){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=Vn,this._minCount=Va,this._maxCount=VU}Vq(Vn,"laya.d3.core.particleShuriKen.module.Burst");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.core.IClone":!0}),Va.cloneTo=function(Vn){var Va=Vn;Va._time=this._time,Va._minCount=this._minCount,Va._maxCount=this._maxCount},Va.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Va,"time",function(){return this._time}),VE(0,Va,"minCount",function(){return this._minCount}),VE(0,Va,"maxCount",function(){return this._maxCount})}(),function(){function Vn(Vn){this._color=null,this.enbale=!1,this._color=Vn}Vq(Vn,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var Va=Vn.prototype;Va.cloneTo=function(Vn){var Va=Vn;this._color.cloneTo(Va._color),Va.enbale=this.enbale},Va.clone=function(){var Vn;switch(this._color.type){case 0:Vn=Vl.createByConstant(this._color.constant.clone());break;case 1:Vn=Vl.createByGradient(this._color.gradient.clone());break;case 2:Vn=Vl.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:Vn=Vl.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var Va=new this.constructor(Vn);return Va.enbale=this.enbale,Va},VE(0,Va,"color",function(){return this._color})}(),function(){function Vn(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}Vq(Vn,"laya.d3.core.particleShuriKen.module.Emission");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),Va._destroy=function(){this._bursts=null,this._destroyed=!0},Va.getBurstsCount=function(){return this._bursts.length},Va.getBurstByIndex=function(Vn){return this._bursts[Vn]},Va.addBurst=function(Vn){var Va=this._bursts.length;if(0<Va)for(var VU=0;VU<Va;VU++)this._bursts[VU].time>Vn.time&&this._bursts.splice(VU,0,Vn);this._bursts.push(Vn)},Va.removeBurst=function(Vn){var Va=this._bursts.indexOf(Vn);-1!==Va&&this._bursts.splice(Va,1)},Va.removeBurstByIndex=function(Vn){this._bursts.splice(Vn,1)},Va.clearBurst=function(){this._bursts.length=0},Va.cloneTo=function(Vn){var Va=Vn,VU=Va._bursts;VU.length=this._bursts.length;for(var Vx=0,VD=this._bursts.length;Vx<VD;Vx++){var Vp=VU[Vx];Vp?this._bursts[Vx].cloneTo(Vp):VU[Vx]=this._bursts[Vx].clone()}Va._emissionRate=this._emissionRate,Va.enbale=this.enbale},Va.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Va,"destroyed",function(){return this._destroyed}),VE(0,Va,"emissionRate",function(){return this._emissionRate},function(Vn){if(Vn<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=Vn})}(),function(){function Vx(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}Vq(Vx,"laya.d3.core.particleShuriKen.module.FrameOverTime");var Vn=Vx.prototype;return VY.imps(Vn,{"laya.d3.core.IClone":!0}),Vn.cloneTo=function(Vn){var Va=Vn;Va._type=this._type,Va._constant=this._constant,this._overTime.cloneTo(Va._overTime),Va._constantMin=this._constantMin,Va._constantMax=this._constantMax,this._overTimeMin.cloneTo(Va._overTimeMin),this._overTimeMax.cloneTo(Va._overTimeMax)},Vn.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Vn,"frameOverTimeData",function(){return this._overTime}),VE(0,Vn,"constant",function(){return this._constant}),VE(0,Vn,"type",function(){return this._type}),VE(0,Vn,"frameOverTimeDataMin",function(){return this._overTimeMin}),VE(0,Vn,"constantMin",function(){return this._constantMin}),VE(0,Vn,"frameOverTimeDataMax",function(){return this._overTimeMax}),VE(0,Vn,"constantMax",function(){return this._constantMax}),Vx.createByConstant=function(Vn){var Va=new Vx;return Va._type=0,Va._constant=Vn,Va},Vx.createByOverTime=function(Vn){var Va=new Vx;return Va._type=1,Va._overTime=Vn,Va},Vx.createByRandomTwoConstant=function(Vn,Va){var VU=new Vx;return VU._type=2,VU._constantMin=Vn,VU._constantMax=Va,VU},Vx.createByRandomTwoOverTime=function(Vn,Va){var VU=new Vx;return VU._type=3,VU._overTimeMin=Vn,VU._overTimeMax=Va,VU},Vx}()),Vv=function(){function VR(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}Vq(VR,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var Vn=VR.prototype;return VY.imps(Vn,{"laya.d3.core.IClone":!0}),Vn.cloneTo=function(Vn){var Va=Vn;Va._type=this._type,Va._separateAxes=this._separateAxes,Va._constant=this._constant,this._constantSeparate.cloneTo(Va._constantSeparate),this._gradient.cloneTo(Va._gradient),this._gradientX.cloneTo(Va._gradientX),this._gradientY.cloneTo(Va._gradientY),this._gradientZ.cloneTo(Va._gradientZ),Va._constantMin=this._constantMin,Va._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(Va._constantMinSeparate),this._constantMaxSeparate.cloneTo(Va._constantMaxSeparate),this._gradientMin.cloneTo(Va._gradientMin),this._gradientMax.cloneTo(Va._gradientMax),this._gradientXMin.cloneTo(Va._gradientXMin),this._gradientXMax.cloneTo(Va._gradientXMax),this._gradientYMin.cloneTo(Va._gradientYMin),this._gradientYMax.cloneTo(Va._gradientYMax),this._gradientZMin.cloneTo(Va._gradientZMin),this._gradientZMax.cloneTo(Va._gradientZMax)},Vn.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Vn,"gradientZ",function(){return this._gradientZ}),VE(0,Vn,"constant",function(){return this._constant}),VE(0,Vn,"gradient",function(){return this._gradient}),VE(0,Vn,"separateAxes",function(){return this._separateAxes}),VE(0,Vn,"type",function(){return this._type}),VE(0,Vn,"constantSeparate",function(){return this._constantSeparate}),VE(0,Vn,"gradientX",function(){return this._gradientX}),VE(0,Vn,"gradientY",function(){return this._gradientY}),VE(0,Vn,"gradientW",function(){return this._gradientW}),VE(0,Vn,"gradientMin",function(){return this._gradientMin}),VE(0,Vn,"constantMin",function(){return this._constantMin}),VE(0,Vn,"gradientMax",function(){return this._gradientMax}),VE(0,Vn,"constantMax",function(){return this._constantMax}),VE(0,Vn,"gradientWMin",function(){return this._gradientWMin}),VE(0,Vn,"constantMinSeparate",function(){return this._constantMinSeparate}),VE(0,Vn,"constantMaxSeparate",function(){return this._constantMaxSeparate}),VE(0,Vn,"gradientXMin",function(){return this._gradientXMin}),VE(0,Vn,"gradientXMax",function(){return this._gradientXMax}),VE(0,Vn,"gradientWMax",function(){return this._gradientWMax}),VE(0,Vn,"gradientYMin",function(){return this._gradientYMin}),VE(0,Vn,"gradientYMax",function(){return this._gradientYMax}),VE(0,Vn,"gradientZMin",function(){return this._gradientZMin}),VE(0,Vn,"gradientZMax",function(){return this._gradientZMax}),VR.createByConstant=function(Vn){var Va=new VR;return Va._type=0,Va._separateAxes=!1,Va._constant=Vn,Va},VR.createByConstantSeparate=function(Vn){var Va=new VR;return Va._type=0,Va._separateAxes=!0,Va._constantSeparate=Vn,Va},VR.createByGradient=function(Vn){var Va=new VR;return Va._type=1,Va._separateAxes=!1,Va._gradient=Vn,Va},VR.createByGradientSeparate=function(Vn,Va,VU,Vx){var VD=new VR;return VD._type=1,VD._separateAxes=!0,VD._gradientX=Vn,VD._gradientY=Va,VD._gradientZ=VU,VD._gradientW=Vx,VD},VR.createByRandomTwoConstant=function(Vn,Va){var VU=new VR;return VU._type=2,VU._separateAxes=!1,VU._constantMin=Vn,VU._constantMax=Va,VU},VR.createByRandomTwoConstantSeparate=function(Vn,Va){var VU=new VR;return VU._type=2,VU._separateAxes=!0,VU._constantMinSeparate=Vn,VU._constantMaxSeparate=Va,VU},VR.createByRandomTwoGradient=function(Vn,Va){var VU=new VR;return VU._type=3,VU._separateAxes=!1,VU._gradientMin=Vn,VU._gradientMax=Va,VU},VR.createByRandomTwoGradientSeparate=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){var Vy=new VR;return Vy._type=3,Vy._separateAxes=!0,Vy._gradientXMin=Vn,Vy._gradientXMax=Va,Vy._gradientYMin=VU,Vy._gradientYMax=Vx,Vy._gradientZMin=VD,Vy._gradientZMax=Vp,Vy._gradientWMin=VQ,Vy._gradientWMax=VV,Vy},VR}(),Vl=function(){function Vx(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}Vq(Vx,"laya.d3.core.particleShuriKen.module.GradientColor");var Vn=Vx.prototype;return VY.imps(Vn,{"laya.d3.core.IClone":!0}),Vn.cloneTo=function(Vn){var Va=Vn;Va._type=this._type,this._constant.cloneTo(Va._constant),this._constantMin.cloneTo(Va._constantMin),this._constantMax.cloneTo(Va._constantMax),this._gradient.cloneTo(Va._gradient),this._gradientMin.cloneTo(Va._gradientMin),this._gradientMax.cloneTo(Va._gradientMax)},Vn.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Vn,"gradient",function(){return this._gradient}),VE(0,Vn,"constant",function(){return this._constant}),VE(0,Vn,"type",function(){return this._type}),VE(0,Vn,"gradientMin",function(){return this._gradientMin}),VE(0,Vn,"constantMin",function(){return this._constantMin}),VE(0,Vn,"gradientMax",function(){return this._gradientMax}),VE(0,Vn,"constantMax",function(){return this._constantMax}),Vx.createByConstant=function(Vn){var Va=new Vx;return Va._type=0,Va._constant=Vn,Va},Vx.createByGradient=function(Vn){var Va=new Vx;return Va._type=1,Va._gradient=Vn,Va},Vx.createByRandomTwoConstant=function(Vn,Va){var VU=new Vx;return VU._type=2,VU._constantMin=Vn,VU._constantMax=Va,VU},Vx.createByRandomTwoGradient=function(Vn,Va){var VU=new Vx;return VU._type=3,VU._gradientMin=Vn,VU._gradientMax=Va,VU},Vx}(),Vj=(function(){function Vn(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}Vq(Vn,"laya.d3.core.particleShuriKen.module.GradientDataColor");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.core.IClone":!0}),Va.addAlpha=function(Vn,Va){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==Vn&&(Vn=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=Vn,this._alphaElements[this._alphaCurrentLength++]=Va):DEBUG},Va.addRGB=function(Vn,Va){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==Vn&&(Vn=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=Vn,this._rgbElements[this._rgbCurrentLength++]=Va.x,this._rgbElements[this._rgbCurrentLength++]=Va.y,this._rgbElements[this._rgbCurrentLength++]=Va.z):DEBUG},Va.cloneTo=function(Vn){var Va=Vn,VU=0,Vx=0;Va._alphaCurrentLength=this._alphaCurrentLength;var VD=Va._alphaElements;for(VD.length=this._alphaElements.length,VU=0,Vx=this._alphaElements.length;VU<Vx;VU++)VD[VU]=this._alphaElements[VU];Va._rgbCurrentLength=this._rgbCurrentLength;var Vp=Va._rgbElements;for(Vp.length=this._rgbElements.length,VU=0,Vx=this._rgbElements.length;VU<Vx;VU++)Vp[VU]=this._rgbElements[VU]},Va.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Va,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),VE(0,Va,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function Vn(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}Vq(Vn,"laya.d3.core.particleShuriKen.module.GradientDataInt");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.core.IClone":!0}),Va.add=function(Vn,Va){this._currentLength<8?(6===this._currentLength&&1!==Vn&&(Vn=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=Vn,this._elements[this._currentLength++]=Va):console.log("Warning:data count must lessEqual than 4")},Va.cloneTo=function(Vn){var Va=Vn;Va._currentLength=this._currentLength;var VU=Va._elements;VU.length=this._elements.length;for(var Vx=0,VD=this._elements.length;Vx<VD;Vx++)VU[Vx]=this._elements[Vx]},Va.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Va,"gradientCount",function(){return this._currentLength/2})}(),function(){function Vn(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}Vq(Vn,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.core.IClone":!0}),Va.add=function(Vn,Va){this._currentLength<8?(6===this._currentLength&&1!==Vn&&(Vn=1,DEBUG),this._elements[this._currentLength++]=Vn,this._elements[this._currentLength++]=Va):DEBUG},Va.getKeyByIndex=function(Vn){return this._elements[2*Vn]},Va.getValueByIndex=function(Vn){return this._elements[2*Vn+1]},Va.getAverageValue=function(){for(var Vn=0,Va=this._currentLength-2;Vn<Va;Vn+=2){this._elements[Vn+1];this._elements[Vn+3],this._elements[Vn+2]-this._elements[Vn]}return 0},Va.cloneTo=function(Vn){var Va=Vn;Va._currentLength=this._currentLength;var VU=Va._elements;VU.length=this._elements.length;for(var Vx=0,VD=this._elements.length;Vx<VD;Vx++)VU[Vx]=this._elements[Vx]},Va.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Va,"gradientCount",function(){return this._currentLength/2})}(),function(){function Vn(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}Vq(Vn,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.core.IClone":!0}),Va.add=function(Vn,Va){this._currentLength<8?(6===this._currentLength&&1!==Vn&&(Vn=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=Vn,this._elements[this._currentLength++]=Va.x,this._elements[this._currentLength++]=Va.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},Va.cloneTo=function(Vn){var Va=Vn;Va._currentLength=this._currentLength;var VU=Va._elements;VU.length=this._elements.length;for(var Vx=0,VD=this._elements.length;Vx<VD;Vx++)VU[Vx]=this._elements[Vx]},Va.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Va,"gradientCount",function(){return this._currentLength/3})}(),function(){function VV(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}Vq(VV,"laya.d3.core.particleShuriKen.module.GradientSize");var Vn=VV.prototype;return VY.imps(Vn,{"laya.d3.core.IClone":!0}),Vn.getMaxSizeInGradient=function(){var Vn=0,Va=0,VU=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(Vn=0,Va=this._gradientX.gradientCount;Vn<Va;Vn++)VU=Math.max(VU,this._gradientX.getValueByIndex(Vn));for(Vn=0,Va=this._gradientY.gradientCount;Vn<Va;Vn++)VU=Math.max(VU,this._gradientY.getValueByIndex(Vn))}else for(Vn=0,Va=this._gradient.gradientCount;Vn<Va;Vn++)VU=Math.max(VU,this._gradient.getValueByIndex(Vn));break;case 1:VU=this._separateAxes?(VU=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),VU=Math.max(VU,this._constantMinSeparate.y),Math.max(VU,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(Vn=0,Va=this._gradientXMin.gradientCount;Vn<Va;Vn++)VU=Math.max(VU,this._gradientXMin.getValueByIndex(Vn));for(Vn=0,Va=this._gradientXMax.gradientCount;Vn<Va;Vn++)VU=Math.max(VU,this._gradientXMax.getValueByIndex(Vn));for(Vn=0,Va=this._gradientYMin.gradientCount;Vn<Va;Vn++)VU=Math.max(VU,this._gradientYMin.getValueByIndex(Vn));for(Vn=0,Va=this._gradientZMax.gradientCount;Vn<Va;Vn++)VU=Math.max(VU,this._gradientZMax.getValueByIndex(Vn))}else{for(Vn=0,Va=this._gradientMin.gradientCount;Vn<Va;Vn++)VU=Math.max(VU,this._gradientMin.getValueByIndex(Vn));for(Vn=0,Va=this._gradientMax.gradientCount;Vn<Va;Vn++)VU=Math.max(VU,this._gradientMax.getValueByIndex(Vn))}}return VU},Vn.cloneTo=function(Vn){var Va=Vn;Va._type=this._type,Va._separateAxes=this._separateAxes,this._gradient.cloneTo(Va._gradient),this._gradientX.cloneTo(Va._gradientX),this._gradientY.cloneTo(Va._gradientY),this._gradientZ.cloneTo(Va._gradientZ),Va._constantMin=this._constantMin,Va._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(Va._constantMinSeparate),this._constantMaxSeparate.cloneTo(Va._constantMaxSeparate),this._gradientMin.cloneTo(Va._gradientMin),this._gradientMax.cloneTo(Va._gradientMax),this._gradientXMin.cloneTo(Va._gradientXMin),this._gradientXMax.cloneTo(Va._gradientXMax),this._gradientYMin.cloneTo(Va._gradientYMin),this._gradientYMax.cloneTo(Va._gradientYMax),this._gradientZMin.cloneTo(Va._gradientZMin),this._gradientZMax.cloneTo(Va._gradientZMax)},Vn.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Vn,"gradientZ",function(){return this._gradientZ}),VE(0,Vn,"gradient",function(){return this._gradient}),VE(0,Vn,"separateAxes",function(){return this._separateAxes}),VE(0,Vn,"type",function(){return this._type}),VE(0,Vn,"gradientMin",function(){return this._gradientMin}),VE(0,Vn,"constantMin",function(){return this._constantMin}),VE(0,Vn,"gradientX",function(){return this._gradientX}),VE(0,Vn,"gradientY",function(){return this._gradientY}),VE(0,Vn,"gradientMax",function(){return this._gradientMax}),VE(0,Vn,"constantMax",function(){return this._constantMax}),VE(0,Vn,"constantMinSeparate",function(){return this._constantMinSeparate}),VE(0,Vn,"constantMaxSeparate",function(){return this._constantMaxSeparate}),VE(0,Vn,"gradientXMin",function(){return this._gradientXMin}),VE(0,Vn,"gradientXMax",function(){return this._gradientXMax}),VE(0,Vn,"gradientYMin",function(){return this._gradientYMin}),VE(0,Vn,"gradientYMax",function(){return this._gradientYMax}),VE(0,Vn,"gradientZMin",function(){return this._gradientZMin}),VE(0,Vn,"gradientZMax",function(){return this._gradientZMax}),VV.createByGradient=function(Vn){var Va=new VV;return Va._type=0,Va._separateAxes=!1,Va._gradient=Vn,Va},VV.createByGradientSeparate=function(Vn,Va,VU){var Vx=new VV;return Vx._type=0,Vx._separateAxes=!0,Vx._gradientX=Vn,Vx._gradientY=Va,Vx._gradientZ=VU,Vx},VV.createByRandomTwoConstant=function(Vn,Va){var VU=new VV;return VU._type=1,VU._separateAxes=!1,VU._constantMin=Vn,VU._constantMax=Va,VU},VV.createByRandomTwoConstantSeparate=function(Vn,Va){var VU=new VV;return VU._type=1,VU._separateAxes=!0,VU._constantMinSeparate=Vn,VU._constantMaxSeparate=Va,VU},VV.createByRandomTwoGradient=function(Vn,Va){var VU=new VV;return VU._type=2,VU._separateAxes=!1,VU._gradientMin=Vn,VU._gradientMax=Va,VU},VV.createByRandomTwoGradientSeparate=function(Vn,Va,VU,Vx,VD,Vp){var VQ=new VV;return VQ._type=2,VQ._separateAxes=!0,VQ._gradientXMin=Vn,VQ._gradientXMax=Va,VQ._gradientYMin=VU,VQ._gradientYMax=Vx,VQ._gradientZMin=VD,VQ._gradientZMax=Vp,VQ},VV}()),Vh=function(){function VV(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}Vq(VV,"laya.d3.core.particleShuriKen.module.GradientVelocity");var Vn=VV.prototype;return VY.imps(Vn,{"laya.d3.core.IClone":!0}),Vn.cloneTo=function(Vn){var Va=Vn;Va._type=this._type,this._constant.cloneTo(Va._constant),this._gradientX.cloneTo(Va._gradientX),this._gradientY.cloneTo(Va._gradientY),this._gradientZ.cloneTo(Va._gradientZ),this._constantMin.cloneTo(Va._constantMin),this._constantMax.cloneTo(Va._constantMax),this._gradientXMin.cloneTo(Va._gradientXMin),this._gradientXMax.cloneTo(Va._gradientXMax),this._gradientYMin.cloneTo(Va._gradientYMin),this._gradientYMax.cloneTo(Va._gradientYMax),this._gradientZMin.cloneTo(Va._gradientZMin),this._gradientZMax.cloneTo(Va._gradientZMax)},Vn.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Vn,"gradientZ",function(){return this._gradientZ}),VE(0,Vn,"constant",function(){return this._constant}),VE(0,Vn,"type",function(){return this._type}),VE(0,Vn,"gradientXMax",function(){return this._gradientXMax}),VE(0,Vn,"constantMin",function(){return this._constantMin}),VE(0,Vn,"gradientX",function(){return this._gradientX}),VE(0,Vn,"gradientY",function(){return this._gradientY}),VE(0,Vn,"gradientXMin",function(){return this._gradientXMin}),VE(0,Vn,"constantMax",function(){return this._constantMax}),VE(0,Vn,"gradientYMin",function(){return this._gradientYMin}),VE(0,Vn,"gradientYMax",function(){return this._gradientYMax}),VE(0,Vn,"gradientZMin",function(){return this._gradientZMin}),VE(0,Vn,"gradientZMax",function(){return this._gradientZMax}),VV.createByConstant=function(Vn){var Va=new VV;return Va._type=0,Va._constant=Vn,Va},VV.createByGradient=function(Vn,Va,VU){var Vx=new VV;return Vx._type=1,Vx._gradientX=Vn,Vx._gradientY=Va,Vx._gradientZ=VU,Vx},VV.createByRandomTwoConstant=function(Vn,Va){var VU=new VV;return VU._type=2,VU._constantMin=Vn,VU._constantMax=Va,VU},VV.createByRandomTwoGradient=function(Vn,Va,VU,Vx,VD,Vp){var VQ=new VV;return VQ._type=3,VQ._gradientXMin=Vn,VQ._gradientXMax=Va,VQ._gradientYMin=VU,VQ._gradientYMax=Vx,VQ._gradientZMin=VD,VQ._gradientZMax=Vp,VQ},VV}(),Vf=(function(){function Vn(Vn){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=Vn}Vq(Vn,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.core.IClone":!0}),Va.cloneTo=function(Vn){var Va=Vn;this._angularVelocity.cloneTo(Va._angularVelocity),Va.enbale=this.enbale},Va.clone=function(){var Vn;switch(this._angularVelocity.type){case 0:Vn=this._angularVelocity.separateAxes?Vv.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):Vv.createByConstant(this._angularVelocity.constant);break;case 1:Vn=this._angularVelocity.separateAxes?Vv.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):Vv.createByGradient(this._angularVelocity.gradient.clone());break;case 2:Vn=this._angularVelocity.separateAxes?Vv.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):Vv.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:Vn=this._angularVelocity.separateAxes?Vv.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):Vv.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var Va=new this.constructor(Vn);return Va.enbale=this.enbale,Va},VE(0,Va,"angularVelocity",function(){return this._angularVelocity})}(),function(){function Vn(){this.enable=!1,this.randomDirection=!1}Vq(Vn,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.core.IClone":!0}),Va._getShapeBoundBox=function(Vn){throw new Error("BaseShape: must override it.")},Va._getSpeedBoundBox=function(Vn){throw new Error("BaseShape: must override it.")},Va.generatePositionAndDirection=function(Vn,Va,VU,Vx){throw new Error("BaseShape: must override it.")},Va._calculateProceduralBounds=function(Vn,Va,VU){this._getShapeBoundBox(Vn);var Vx=Vn.min,VD=Vn.max;VQa.multiply(Vx,Va,Vx),VQa.multiply(VD,Va,VD);var Vp=new VCn(new VQa,new VQa);this.randomDirection?(Vp.min=new VQa(-1,-1,-1),Vp.max=new VQa(1,1,1)):this._getSpeedBoundBox(Vp);var VQ=new VCn(new VQa,new VQa),VV=VQ.min,Vy=VQ.max;VQa.scale(Vp.min,VU.y,VV),VQa.scale(Vp.max,VU.y,Vy),VQa.add(Vn.min,VV,VV),VQa.add(Vn.max,Vy,Vy),VQa.min(Vn.min,VV,Vn.min),VQa.max(Vn.max,VV,Vn.max);var VR=new VCn(new VQa,new VQa),VX=VR.min,Vz=VR.max;VQa.scale(Vp.min,VU.x,VX),VQa.scale(Vp.max,VU.x,Vz),VQa.min(VR.min,Vz,VV),VQa.max(VR.min,Vz,Vy),VQa.min(Vn.min,VV,Vn.min),VQa.max(Vn.max,VV,Vn.max)},Va.cloneTo=function(Vn){Vn.enable=this.enable},Va.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},Vn}()),VO=function(){function Vp(){}return Vq(Vp,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),Vp._randomPointUnitArcCircle=function(Vn,Va,VU){var Vx=Va.elements,VD=NaN;VD=VU?VU.getFloat()*Vn:Math.random()*Vn,Vx[0]=Math.cos(VD),Vx[1]=Math.sin(VD)},Vp._randomPointInsideUnitArcCircle=function(Vn,Va,VU){var Vx=Va.elements;Vp._randomPointUnitArcCircle(Vn,Va,VU);var VD=NaN;VD=VU?Math.pow(VU.getFloat(),.5):Math.pow(Math.random(),.5),Vx[0]=Vx[0]*VD,Vx[1]=Vx[1]*VD},Vp._randomPointUnitCircle=function(Vn,Va){var VU=Vn.elements,Vx=NaN;Vx=Va?Va.getFloat()*Math.PI*2:Math.random()*Math.PI*2,VU[0]=Math.cos(Vx),VU[1]=Math.sin(Vx)},Vp._randomPointInsideUnitCircle=function(Vn,Va){var VU=Vn.elements;Vp._randomPointUnitCircle(Vn);var Vx=NaN;Vx=Va?Math.pow(Va.getFloat(),.5):Math.pow(Math.random(),.5),VU[0]=VU[0]*Vx,VU[1]=VU[1]*Vx},Vp._randomPointUnitSphere=function(Vn,Va){var VU=Vn.elements,Vx=NaN,VD=NaN;VD=Va?(Vx=VU[2]=2*Va.getFloat()-1,Va.getFloat()*Math.PI*2):(Vx=VU[2]=2*Math.random()-1,Math.random()*Math.PI*2);var Vp=Math.sqrt(1-Vx*Vx);VU[0]=Vp*Math.cos(VD),VU[1]=Vp*Math.sin(VD)},Vp._randomPointInsideUnitSphere=function(Vn,Va){var VU=Vn.elements;Vp._randomPointUnitSphere(Vn);var Vx=NaN;Vx=Va?Math.pow(Va.getFloat(),1/3):Math.pow(Math.random(),1/3),VU[0]=VU[0]*Vx,VU[1]=VU[1]*Vx,VU[2]=VU[2]*Vx},Vp._randomPointInsideHalfUnitBox=function(Vn,Va){var VU=Vn.elements;Va?(VU[0]=Va.getFloat()-.5,VU[1]=Va.getFloat()-.5,VU[2]=Va.getFloat()-.5):(VU[0]=Math.random()-.5,VU[1]=Math.random()-.5,VU[2]=Math.random()-.5)},Vp}(),VL=(function(){function Vn(Vn){this._size=null,this.enbale=!1,this._size=Vn}Vq(Vn,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.core.IClone":!0}),Va.cloneTo=function(Vn){var Va=Vn;this._size.cloneTo(Va._size),Va.enbale=this.enbale},Va.clone=function(){var Vn;switch(this._size.type){case 0:Vn=this._size.separateAxes?Vj.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):Vj.createByGradient(this._size.gradient.clone());break;case 1:Vn=this._size.separateAxes?Vj.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):Vj.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:Vn=this._size.separateAxes?Vj.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):Vj.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var Va=new this.constructor(Vn);return Va.enbale=this.enbale,Va},VE(0,Va,"size",function(){return this._size})}(),function(){function Vx(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}Vq(Vx,"laya.d3.core.particleShuriKen.module.StartFrame");var Vn=Vx.prototype;return VY.imps(Vn,{"laya.d3.core.IClone":!0}),Vn.cloneTo=function(Vn){var Va=Vn;Va._type=this._type,Va._constant=this._constant,Va._constantMin=this._constantMin,Va._constantMax=this._constantMax},Vn.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Vn,"constant",function(){return this._constant}),VE(0,Vn,"type",function(){return this._type}),VE(0,Vn,"constantMin",function(){return this._constantMin}),VE(0,Vn,"constantMax",function(){return this._constantMax}),Vx.createByConstant=function(Vn){var Va=new Vx;return Va._type=0,Va._constant=Vn,Va},Vx.createByRandomTwoConstant=function(Vn,Va){var VU=new Vx;return VU._type=1,VU._constantMin=Vn,VU._constantMax=Va,VU},Vx}()),Vd=(function(){function Vn(Vn,Va){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new Vpa(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=Vn,this._startFrame=Va}Vq(Vn,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.core.IClone":!0}),Va.cloneTo=function(Vn){var Va=Vn;this.tiles.cloneTo(Va.tiles),Va.type=this.type,Va.randomRow=this.randomRow,this._frame.cloneTo(Va._frame),this._startFrame.cloneTo(Va._startFrame),Va.cycles=this.cycles,Va.enableUVChannels=this.enableUVChannels,Va.enable=this.enable},Va.clone=function(){var Vn,Va;switch(this._frame.type){case 0:Vn=VI.createByConstant(this._frame.constant);break;case 1:Vn=VI.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:Vn=VI.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:Vn=VI.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:Va=VL.createByConstant(this._startFrame.constant);break;case 1:Va=VL.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var VU=new this.constructor(Vn,Va);return this.tiles.cloneTo(VU.tiles),VU.type=this.type,VU.randomRow=this.randomRow,VU.cycles=this.cycles,VU.enableUVChannels=this.enableUVChannels,VU.enable=this.enable,VU},VE(0,Va,"frame",function(){return this._frame}),VE(0,Va,"startFrame",function(){return this._startFrame})}(),function(){function Vn(Vn){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=Vn}Vq(Vn,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.core.IClone":!0}),Va.cloneTo=function(Vn){var Va=Vn;this._velocity.cloneTo(Va._velocity),Va.enbale=this.enbale,Va.space=this.space},Va.clone=function(){var Vn;switch(this._velocity.type){case 0:Vn=Vh.createByConstant(this._velocity.constant.clone());break;case 1:Vn=Vh.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:Vn=Vh.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:Vn=Vh.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var Va=new this.constructor(Vn);return Va.enbale=this.enbale,Va.space=this.space,Va},VE(0,Va,"velocity",function(){return this._velocity})}(),function(){function Vn(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new Via,this._vb=Vfa.create(Vn._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=Vha.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=Vla.nameKey.getID("LINE"),this._shaderCompile=VNa._preCompileShader[this._sharderNameID]}Vq(Vn,"laya.d3.core.PhasorSpriter3D");var Va=Vn.prototype;return Va.line=function(Vn,Va,VU,Vx){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Vn.x,Vn.y,Vn.z,Va.x,Va.y,Va.z,Va.w),this.addVertex(VU.x,VU.y,VU.z,Vx.x,Vx.y,Vx.z,Vx.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},Va.circle=function(Vn,Va,VU,Vx,VD,Vp){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*Va,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/Va,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*Vn,Math.cos(this._tempNumver0)*Vn,0,VU,Vx,VD,Vp),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},Va.plane=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=Vx/2,this._tempNumver1=VD/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Vn-this._tempNumver0,Va+this._tempNumver1,VU,Vp,VQ,VV,Vy),this.addVertex(Vn+this._tempNumver0,Va+this._tempNumver1,VU,Vp,VQ,VV,Vy),this.addVertex(Vn-this._tempNumver0,Va-this._tempNumver1,VU,Vp,VQ,VV,Vy),this.addVertex(Vn+this._tempNumver0,Va-this._tempNumver1,VU,Vp,VQ,VV,Vy),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},Va.box=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=Vx/2,this._tempNumver1=VD/2,this._tempNumver2=Vp/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Vn-this._tempNumver0,Va+this._tempNumver1,VU+this._tempNumver2,VQ,VV,Vy,VR),this.addVertex(Vn+this._tempNumver0,Va+this._tempNumver1,VU+this._tempNumver2,VQ,VV,Vy,VR),this.addVertex(Vn-this._tempNumver0,Va-this._tempNumver1,VU+this._tempNumver2,VQ,VV,Vy,VR),this.addVertex(Vn+this._tempNumver0,Va-this._tempNumver1,VU+this._tempNumver2,VQ,VV,Vy,VR),this.addVertex(Vn+this._tempNumver0,Va+this._tempNumver1,VU-this._tempNumver2,VQ,VV,Vy,VR),this.addVertex(Vn-this._tempNumver0,Va+this._tempNumver1,VU-this._tempNumver2,VQ,VV,Vy,VR),this.addVertex(Vn+this._tempNumver0,Va-this._tempNumver1,VU-this._tempNumver2,VQ,VV,Vy,VR),this.addVertex(Vn-this._tempNumver0,Va-this._tempNumver1,VU-this._tempNumver2,VQ,VV,Vy,VR),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},Va.cone=function(Vn,Va,VU,Vx,VD,Vp,VQ){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*VU+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*VU>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/VU,this.addVertexIndex(0,Va,0,Vx,VD,Vp,VQ,this._tempUint0),this.addVertexIndex(0,0,0,Vx,VD,Vp,VQ,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<VU;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(Vn*this._tempNumver2,0,Vn*this._tempNumver3,Vx,VD,Vp,VQ,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==VU-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(Vn*this._tempNumver2,0,Vn*this._tempNumver3,Vx,VD,Vp,VQ,this._tempUint0+(this._tempInt0+VU)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==VU-1?this.addIndexes(this._tempUint1+VU+2):this.addIndexes(this._tempUint1+this._tempInt0+VU+1),this.addIndexes(this._tempUint1+this._tempInt0+VU),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},Va.boundingBoxLine=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Vn,VD,Vp,VQ,VV,Vy,VR),this.addVertex(Vx,VD,Vp,VQ,VV,Vy,VR),this.addVertex(Vn,Va,Vp,VQ,VV,Vy,VR),this.addVertex(Vx,Va,Vp,VQ,VV,Vy,VR),this.addVertex(Vx,VD,VU,VQ,VV,Vy,VR),this.addVertex(Vn,VD,VU,VQ,VV,Vy,VR),this.addVertex(Vx,Va,VU,VQ,VV,Vy,VR),this.addVertex(Vn,Va,VU,VQ,VV,Vy,VR),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},Va.addVertex=function(Vn,Va,VU,Vx,VD,Vp,VQ){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=Vn,this._vbData[this._posInVBData+1]=Va,this._vbData[this._posInVBData+2]=VU,this._vbData[this._posInVBData+3]=Vx,this._vbData[this._posInVBData+4]=VD,this._vbData[this._posInVBData+5]=Vp,this._vbData[this._posInVBData+6]=VQ,this._posInVBData+=this._floatSizePerVer,this},Va.addVertexIndex=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){return this._hasBegun||this.addVertexIndexException(),this._vbData[VV]=Vn,this._vbData[VV+1]=Va,this._vbData[VV+2]=VU,this._vbData[VV+3]=Vx,this._vbData[VV+4]=VD,this._vbData[VV+5]=Vp,this._vbData[VV+6]=VQ,(VV+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=VV),this},Va.addIndexes=function(Vn){var Va=arguments;this._hasBegun||this.addVertexIndexException();for(var VU=0;VU<Va.length;VU++)this._ibData[this._posInIBData]=Va[VU],this._posInIBData++;return this},Va.begin=function(Vn,Va){return this._hasBegun&&this.beginException0(),1!==Vn&&4!==Vn&&this.beginException1(),this._primitiveType=Vn,this._camera=Va,this._hasBegun=!0,this},Va.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},Va.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(Vn._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),VN.drawCall++,Vu.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},Va.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},Va.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},Va.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},Va.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},Va.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},Va.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(28,[new VQn(0,"vector3",0),new VQn(12,"vector4",1)])}]),Vn}()),VS=function(){function Vn(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++Vn._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new Via}Vq(Vn,"laya.d3.core.render.RenderElement");var Va=Vn.prototype;return Va.getDynamicBatchBakedVertexs=function(Vn){for(var Va=this._renderObj._getVertexBuffer(Vn),VU=Va.getData().slice(),Vx=Va.vertexDeclaration,VD=Vx.getVertexElementByUsage(0).offset/4,Vp=Vx.getVertexElementByUsage(3).offset/4,VQ=this._sprite3D.transform,VV=VQ.worldMatrix,Vy=VQ.rotation,VR=Vx.vertexStride/4,VX=0,Vz=VU.length;VX<Vz;VX+=VR){var Vi=VX+VD,Vq=VX+Vp;Vba.transformVector3ArrayToVector3ArrayCoordinate(VU,Vi,VV,VU,Vi),Vba.transformVector3ArrayByQuat(VU,Vq,Vy,VU,Vq)}return VU},Va.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},Va._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},VE(0,Va,"id",function(){return this._id}),VE(0,Va,"renderObj",function(){return this._renderObj},function(Vn){this._renderObj!==Vn&&(this._renderObj=Vn)}),Vn._uniqueIDCounter=0,Vn}(),Vw=function(){function Va(Vn){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++Va._uniqueIDCounter,this._needSort=!1,this._scene=Vn,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}Vq(Va,"laya.d3.core.render.RenderQueue");var Vn=Va.prototype;return Vn._sortOpaqueFunc=function(Vn,Va){if(Vn._render&&Va._render){var VU=Vn._material.renderQueue-Va._material.renderQueue;return 0==VU?Vn._render._distanceForSort-Va._render._distanceForSort:VU}return 0},Vn._sortAlphaFunc=function(Vn,Va){if(Vn._render&&Va._render){var VU=Vn._material.renderQueue-Va._material.renderQueue;return 0==VU?Va._render._distanceForSort-Vn._render._distanceForSort:VU}return 0},Vn._begainRenderElement=function(Vn,Va,VU){return!!Va._beforeRender(Vn)},Vn._sortAlpha=function(Vn){Va._cameraPosition=Vn,this._finalElements.sort(this._sortAlphaFunc)},Vn._sortOpaque=function(Vn){Va._cameraPosition=Vn,this._finalElements.sort(this._sortOpaqueFunc)},Vn._preRender=function(Vn){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},Vn._render=function(Vn,Va){for(var VU,Vx,VD,Vp,VQ,VV,Vy=VN.loopCount,VR=this._scene,VX=Vn.camera,Vz=(VX.id,!1),Vi=0,Vq=this._finalElements.length;Vi<Vq;Vi++){var VE,Vm,Vb,VP=this._finalElements[Vi];if(null!=VP._onPreRenderFunction&&VP._onPreRenderFunction.call(VP._sprite3D,Vn),0===VP._type){if(Vn.owner=Vb=VP._sprite3D,Vn.renderElement=VP,Vb._preRenderUpdateComponents(Vn),VE=VP.renderObj,Vm=VP._material,this._begainRenderElement(Vn,VE,Vm)){if(VU=VE._getVertexBuffers(),!(VD=(Vx=VE._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[Vx.id]){this._errorRecord[Vx.id]=1;var VA="vertexBuffer:"+("("+Vx._destroyed+","+Vx._released+","+Vx._referenceCount+","+Vx._buffer+")")+", material:"+(Vm?Vm.__className+"("+Vm._destroyed+","+Vm._released+")":"null")+", owner:"+(Vb?Vb.__className+"("+Vb._destroyed+","+Vb._activeInHierarchy+","+Vb._displayedInStage+")":"null")+", renderObj:"+(VE?VE.__className+"("+VE._destroyed+","+VE._released+","+VE._referenceCount+")":"")+", parent:, url:"+(Vb?Vb.url:"")+", disposeStack:"+Vx.disposeStack;VY.recordError("报错：unknown vertexDeclaration  "+VA)}continue}if(Vz=(Vp=Vn._shader=Vm._getShader(VR._shaderDefineValue,VD.shaderDefineValue,Vb._shaderDefineValue)).bind()||Vy!==Vp._uploadLoopCount,VU){if(Vp._uploadVertexBuffer!==VU||Vz){for(var VT=0;VT<VU.length;VT++){var VK=VU[VT];Vp.uploadAttributesX(VK.vertexDeclaration.shaderValues.data,VK)}Vp._uploadVertexBuffer=VU}}else(Vp._uploadVertexBuffer!==Vx||Vz)&&(Vp.uploadAttributes(VD.shaderValues.data,null),Vp._uploadVertexBuffer=Vx);(Vp._uploadScene!==VR||Vz)&&(Vp.uploadSceneUniforms(VR._shaderValues.data),Vp._uploadScene=VR),(VX!==Vp._uploadCamera||Vp._uploadSprite3D!==Vb||Vz)&&(Vp.uploadSpriteUniforms(Vb._shaderValues.data),Vp._uploadSprite3D=Vb),(VX!==Vp._uploadCamera||Vz)&&(Vp.uploadCameraUniforms(VX._shaderValues.data),Vp._uploadCamera=VX),(Vp._uploadMaterial!==Vm||Vz)&&(Vm._upload(),Vp._uploadMaterial=Vm),VQ!==Vm?(Vm._setRenderStateBlendDepth(),Vm._setRenderStateFrontFace(Va,Vb.transform),VQ=Vm,VV=Vb):VV!==Vb&&(Vm._setRenderStateFrontFace(Va,Vb.transform),VV=Vb),VE._render(Vn),Vp._uploadLoopCount=Vy}Vb._postRenderUpdateComponents(Vn)}else if(2===VP._type){VP.renderObj;Vn.owner=Vb=VP._sprite3D,Vn.renderElement=VP,Vn._batchIndexStart=VP._tempBatchIndexStart,Vn._batchIndexEnd=VP._tempBatchIndexEnd,VE=VP.renderObj,Vm=VP._material,this._begainRenderElement(Vn,VE,Vm)&&(VD=(Vx=VE._getVertexBuffer(0)).vertexDeclaration,Vz=(Vp=Vn._shader=Vm._getShader(VR._shaderDefineValue,VD.shaderDefineValue,Vb._shaderDefineValue)).bind()||Vy!==Vp._uploadLoopCount,(Vp._uploadVertexBuffer!==Vx||Vz)&&(Vp.uploadAttributes(VD.shaderValues.data,null),Vp._uploadVertexBuffer=Vx),(Vp._uploadScene!==VR||Vz)&&(Vp.uploadSceneUniforms(VR._shaderValues.data),Vp._uploadScene=VR),(VX!==Vp._uploadCamera||Vp._uploadSprite3D!==Vb||Vz)&&(Vp.uploadSpriteUniforms(Vb._shaderValues.data),Vp._uploadSprite3D=Vb),(VX!==Vp._uploadCamera||Vz)&&(Vp.uploadCameraUniforms(VX._shaderValues.data),Vp._uploadCamera=VX),(Vp._uploadMaterial!==Vm||Vz)&&(Vm._upload(),Vp._uploadMaterial=Vm),VQ!==Vm?(Vm._setRenderStateBlendDepth(),Vm._setRenderStateFrontFace(Va,Vb.transform),VQ=Vm,VV=Vb):VV!==Vb&&(Vm._setRenderStateFrontFace(Va,Vb.transform),VV=Vb),VE._render(Vn),Vp._uploadLoopCount=Vy)}}},Vn._renderShadow=function(Vn,Va){for(var VU,Vx,VD,Vp,VQ,VV=VN.loopCount,Vy=this._scene,VR=Vn.camera,VX=!1,Vz=0,Vi=this._finalElements.length;Vz<Vi;Vz++){var Vq,VE,Vm,Vb=this._finalElements[Vz];0===Vb._type&&(Vn.owner=Vm=Vb._sprite3D,Va||Vm._projectionViewWorldUpdateCamera===VR&&Vm._projectionViewWorldUpdateLoopCount===VN.loopCount||(Vm._render._renderUpdate(Vn._projectionViewMatrix),Vm._projectionViewWorldUpdateLoopCount=VN.loopCount,Vm._projectionViewWorldUpdateCamera=VR),Vn.renderElement=Vb,Vm._preRenderUpdateComponents(Vn),Vq=Vb.renderObj,VE=Vb._material,this._begainRenderElement(Vn,Vq,null)&&(Vx=(VU=Vq._getVertexBuffer(0)).vertexDeclaration,VX=(VD=Vn._shader=VE._getShader(Vy._shaderDefineValue,Vx.shaderDefineValue,Vm._shaderDefineValue)).bind()||VV!==VD._uploadLoopCount,(VD._uploadVertexBuffer!==VU||VX)&&(VD.uploadAttributes(Vx.shaderValues.data,null),VD._uploadVertexBuffer=VU),(VR!==VD._uploadCamera||VD._uploadSprite3D!==Vm||VX)&&(VD.uploadSpriteUniforms(Vm._shaderValues.data),VD._uploadSprite3D=Vm),(VR!==VD._uploadCamera||VX)&&(VD.uploadCameraUniforms(VR._shaderValues.data),VD._uploadCamera=VR),(VD._uploadMaterial!==VE||VX)&&(VE._upload(),VD._uploadMaterial=VE),VD._uploadRenderElement,Vp!==VE?(VE._setRenderStateFrontFace(!1,Vm.transform),Vp=VE,VQ=Vm):VQ!==Vm&&(VE._setRenderStateFrontFace(!1,Vm.transform),VQ=Vm),Vq._render(Vn),VD._uploadLoopCount=VV),Vm._postRenderUpdateComponents(Vn))}},Vn._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},Vn._addRenderElement=function(Vn){this._renderElements.push(Vn),this._needSort=!0},Vn._addDynamicBatchElement=function(Vn){this._dynamicBatchCombineRenderElements.push(Vn)},VE(0,Vn,"id",function(){return this._id}),Va._uniqueIDCounter=0,Va._cameraPosition=null,Va}(),Vs=function(){function Vn(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return Vq(Vn,"laya.d3.core.render.RenderState"),Vn.clientWidth=0,Vn.clientHeight=0,Vn}(),VC=function(){function VQ(Vn,Va){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new Vrn(new VQa,0),this._corners=[new VQa,new VQa,new VQa,new VQa,new VQa,new VQa,new VQa,new VQa],this._boundingBoxCenter=new VQa,this._children=Vx(8),this._objects=[],this._tempBoundBoxCorners=[new VQa,new VQa,new VQa,new VQa,new VQa,new VQa,new VQa,new VQa],this._scene=Vn,this._currentDepth=Va}Vq(VQ,"laya.d3.core.scene.OctreeNode");var Vn=VQ.prototype;return VY.imps(Vn,{"laya.d3.core.scene.ITreeNode":!0}),Vn.init=function(Vn,Va){var VU=new VQa,Vx=new VQa;VQa.scale(Va,-.5,VU),VQa.scale(Va,.5,Vx),VQa.add(VU,Vn,VU),VQa.add(Vx,Vn,Vx),this.exactBox=new VCn(VU,Vx),this.relaxBox=new VCn(VU,Vx)},Vn.addTreeNode=function(Vn){1===Collision.boxContainsBox(this._relaxBox,Vn.boundingBox)?this.addNodeDown(Vn,0):this.addObject(Vn)},Vn.addChild=function(Vn){var Va=this._children[Vn];if(null==Va){Va=new VQ(this._scene,this._currentDepth+1),(this._children[Vn]=Va)._parent=this,VQa.subtract(this._exactBox.max,this._exactBox.min,VQ.tempSize),VQa.multiply(VQ.tempSize,VQ._octreeSplit[Vn],VQ.tempCenter),VQa.add(this._exactBox.min,VQ.tempCenter,VQ.tempCenter),VQa.scale(VQ.tempSize,.25,VQ.tempSize);var VU=new VQa,Vx=new VQa;VQa.subtract(VQ.tempCenter,VQ.tempSize,VU),VQa.add(VQ.tempCenter,VQ.tempSize,Vx),Va.exactBox=new VCn(VU,Vx),VQa.scale(VQ.tempSize,VQ.relax,VQ.tempSize);var VD=new VQa,Vp=new VQa;VQa.subtract(VQ.tempCenter,VQ.tempSize,VD),VQa.add(VQ.tempCenter,VQ.tempSize,Vp),Va.relaxBox=new VCn(VD,Vp)}return Va},Vn.addObject=function(Vn){(Vn._treeNode=this)._objects.push(Vn)},Vn.removeObject=function(Vn){if(Vn._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var Va=this._objects.indexOf(Vn);return-1!==Va&&(this._objects.splice(Va,1),!0)},Vn.clearObject=function(){this._objects.length=0},Vn.addNodeUp=function(Vn,Va){this._parent&&1!==Collision.boxContainsBox(this._exactBox,Vn.boundingBox)?this._parent.addNodeUp(Vn,Va-1):this.addNodeDown(Vn,Va)},Vn.addNodeDown=function(Vn,Va){if(Va<this._scene.treeLevel){var VU=this.inChildIndex(Vn.boundingBoxCenter),Vx=this.addChild(VU);1===Collision.boxContainsBox(Vx._relaxBox,Vn.boundingBox)?Vx.addNodeDown(Vn,++Va):this.addObject(Vn)}else this.addObject(Vn)},Vn.inChildIndex=function(Vn){return 4*(Vn.z<this._boundingBoxCenter.z?0:1)+2*(Vn.y<this._boundingBoxCenter.y?0:1)+(Vn.x<this._boundingBoxCenter.x?0:1)},Vn.updateObject=function(Vn){1===Collision.boxContainsBox(this._relaxBox,Vn.boundingBox)?(this.removeObject(Vn),Vn._treeNode=null,this.addNodeDown(Vn,this._currentDepth)):this._parent&&(this.removeObject(Vn),Vn._treeNode=null,this._parent.addNodeUp(Vn,this._currentDepth-1))},Vn.cullingObjects=function(Vn,Va,VU,Vx,VD){var Vp,VQ=0,VV=0,Vy=0,VR=this._scene._dynamicBatchManager;for(VQ=0,Vp=this._objects.length;VQ<Vp;VQ++){var VX=this._objects[VQ];if(VG.isVisible(VX._owner.layer.mask)&&VX.enable){if(Va&&(VN.treeSpriteCollision+=1,0===Vn.containsBoundSphere(VX.boundingSphere)))continue;VX._renderUpdate(VD),VX._distanceForSort=VQa.distance(VX.boundingSphere.center,Vx)+VX.sortingFudge;var Vz=VX._renderElements;for(VV=0,Vy=Vz.length;VV<Vy;VV++){var Vi=Vz[VV],Vq=Vi._staticBatch;if(Vq&&Vq._material===Vi._material)Vq._addBatchRenderElement(Vi);else{var VE=Vi.renderObj;VE.triangleCount<10&&1===VE._vertexBufferCount&&VE._getIndexBuffer()&&Vi._material.renderQueue<2&&Vi._canDynamicBatch&&!VX._owner.isStatic?VR._addPrepareRenderElement(Vi):this._scene.getRenderQueue(Vi._material.renderQueue)._addRenderElement(Vi)}}}}for(VQ=0;VQ<8;VQ++){var Vm=this._children[VQ];if(null!=Vm){var Vb=Va;if(Va){var VP=Vn.containsBoundBox(Vm._relaxBox);if(VN.treeNodeCollision+=1,0===VP)continue;Vb=2===VP}Vm.cullingObjects(Vn,Vb,VU,Vx,VD)}}},Vn.cullingShadowObjects=function(Vn,Va,VU,Vx,VD){var Vp,VQ=0,VV=0,Vy=0;this._scene._dynamicBatchManager;for(VQ=0,Vp=this._objects.length;VQ<Vp;VQ++){var VR=this._objects[VQ];if(VR.castShadow&&VG.isVisible(VR._owner.layer.mask)&&VR.enable){if(VU&&0===Vn[0].containsBoundSphere(VR.boundingSphere))continue;for(var VX=1,Vz=Vn.length;VX<Vz;VX++){var Vi=Va[VX-1];if(0!==Vn[VX].containsBoundSphere(VR.boundingSphere)){var Vq=VR._renderElements;for(VV=0,Vy=Vq.length;VV<Vy;VV++)Vi._addRenderElement(Vq[VV])}}}}for(VQ=0;VQ<8;VQ++){var VE=this._children[VQ];if(null!=VE){var Vm=VU;if(VU){var Vb=Vn[0].containsBoundBox(VE._relaxBox);if(0===Vb)continue;Vm=2===Vb}VE.cullingShadowObjects(Vn,Va,Vm,Vx,VD)}}},Vn.cullingShadowObjectsOnePSSM=function(Vn,Va,VU,Vx,VD,Vp){var VQ,VV=Va[0],Vy=0,VR=0,VX=0;for(Vy=0,VQ=this._objects.length;Vy<VQ;Vy++){var Vz=this._objects[Vy];if(Vz.castShadow&&VG.isVisible(Vz._owner.layer.mask)&&Vz.enable){if(Vx&&0===Vn.containsBoundSphere(Vz.boundingSphere))continue;Vz._renderUpdate(VU);var Vi=Vz._renderElements;for(VR=0,VX=Vi.length;VR<VX;VR++)VV._addRenderElement(Vi[VR])}}for(Vy=0;Vy<8;Vy++){var Vq=this._children[Vy];if(null!=Vq){var VE=Vx;if(Vx){var Vm=Vn.containsBoundBox(Vq._relaxBox);if(0===Vm)continue;VE=2===Vm}Vq.cullingShadowObjectsOnePSSM(Vn,Va,VU,VE,VD,Vp)}}},Vn.renderBoudingBox=function(Vn){this._renderBoudingBox(Vn);for(var Va=0;Va<8;++Va){var VU=this._children[Va];VU&&VU.renderBoudingBox(Vn)}},Vn.buildAllChild=function(Vn){if(Vn<this._scene.treeLevel)for(var Va=0;Va<8;Va++){this.addChild(Va).buildAllChild(Vn+1)}},Vn._renderBoudingBox=function(Vn){},VE(0,Vn,"exactBox",function(){return this._exactBox},function(Vn){this._exactBox=Vn,VQa.add(Vn.min,Vn.max,this._boundingBoxCenter),VQa.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),VE(0,Vn,"relaxBox",function(){return this._relaxBox},function(Vn){(this._relaxBox=Vn).getCorners(this._corners),Vrn.createfromPoints(this._corners,this._boundingSphere)}),VQ.debugMode=!1,VQ.relax=1.15,VQ.CHILDNUM=8,Vz(VQ,["tempVector0",function(){return this.tempVector0=new VQa},"tempSize",function(){return this.tempSize=new VQa},"tempCenter",function(){return this.tempCenter=new VQa},"_octreeSplit",function(){return this._octreeSplit=[new VQa(.25,.25,.25),new VQa(.75,.25,.25),new VQa(.25,.75,.25),new VQa(.75,.75,.25),new VQa(.25,.25,.75),new VQa(.75,.25,.75),new VQa(.25,.75,.75),new VQa(.75,.75,.75)]}]),VQ}(),Vt=(function(){function Vn(){}Vq(Vn,"laya.d3.core.scene.SceneManager")}(),function(){function Vn(Vn,Va,VU,Vx){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===Vn&&(Vn=1),void 0===Va&&(Va=1),void 0===VU&&(VU=1),void 0===Vx&&(Vx=1),this._r=Vn,this._g=Va,this._b=VU,this._a=Vx}return Vq(Vn,"laya.d3.core.trail.module.Color",null,"Color$1"),Vn.prototype.cloneTo=function(Vn){Vn._r=this._r,Vn._g=this._g,Vn._b=this._b,Vn._a=this._a},Vz(Vn,["RED",function(){return this.RED=new Vn(1,0,0,1)},"GREEN",function(){return this.GREEN=new Vn(0,1,0,1)},"BLUE",function(){return this.BLUE=new Vn(0,0,1,1)},"CYAN",function(){return this.CYAN=new Vn(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new Vn(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new Vn(1,0,1,1)},"GRAY",function(){return this.GRAY=new Vn(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new Vn(1,1,1,1)},"BLACK",function(){return this.BLACK=new Vn(0,0,0,1)}]),Vn}()),Vr=(function(){function Vn(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}Vq(Vn,"laya.d3.core.trail.module.Gradient");var Va=Vn.prototype;Va.setKeys=function(Vn,Va){var VU,Vx;this._colorKeys=Vn;for(var VD=this.index=0;VD<Vn.length;VD++){var Vp=(VU=Vn[VD]).color;this._colorKeyData[this.index++]=Vp._r,this._colorKeyData[this.index++]=Vp._g,this._colorKeyData[this.index++]=Vp._b,this._colorKeyData[this.index++]=VU.time}this._alphaKeys=Va;for(var VQ=this.index=0;VQ<Va.length;VQ++)Vx=Va[VQ],this._alphaKeyData[this.index++]=Vx.alpha,this._alphaKeyData[this.index++]=Vx.time},Va.cloneTo=function(Vn){var Va=0,VU=0,Vx=this.colorKeys,VD=[];for(Va=0,VU=Vx.length;Va<VU;Va++){var Vp=new VJ;Vx[Va].cloneTo(Vp),VD.push(Vp)}var VQ=this.alphaKeys,VV=[];for(Va=0,VU=VQ.length;Va<VU;Va++){var Vy=new Vr;VQ[Va].cloneTo(Vy),VV.push(Vy)}Vn.setKeys(VD,VV)},VE(0,Va,"mode",function(){return this._mode},function(Vn){this._mode=Vn}),VE(0,Va,"colorKeys",function(){return this._colorKeys},function(Vn){this._colorKeys=Vn;for(var Va=this.index=0;Va<Vn.length;Va++){var VU=Vn[Va],Vx=VU.color;this._colorKeyData[this.index++]=Vx._r,this._colorKeyData[this.index++]=Vx._g,this._colorKeyData[this.index++]=Vx._b,this._colorKeyData[this.index++]=VU.time}}),VE(0,Va,"alphaKeys",function(){return this._alphaKeys},function(Vn){this._alphaKeys=Vn;for(var Va=this.index=0;Va<Vn.length;Va++){var VU=Vn[Va];this._alphaKeyData[this.index++]=VU.alpha,this._alphaKeyData[this.index++]=VU.time}})}(),function(){function Vn(Vn,Va){this._alpha=NaN,this._time=NaN,void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),this._alpha=Vn,this._time=Va}Vq(Vn,"laya.d3.core.trail.module.GradientAlphaKey");var Va=Vn.prototype;return Va.cloneTo=function(Vn){Vn.alpha=this.alpha,Vn.time=this.time},VE(0,Va,"alpha",function(){return this._alpha},function(Vn){this._alpha=Vn}),VE(0,Va,"time",function(){return this._time},function(Vn){this._time=Vn}),Vn}()),VJ=function(){function Vn(Vn,Va){this._color=null,this._time=NaN,void 0===Va&&(Va=0),this._color=Vn||new Vt,this._time=Va}Vq(Vn,"laya.d3.core.trail.module.GradientColorKey");var Va=Vn.prototype;return Va.cloneTo=function(Vn){this.color.cloneTo(Vn.color),Vn.time=this.time},VE(0,Va,"color",function(){return this._color},function(Vn){this._color=Vn}),VE(0,Va,"time",function(){return this._time},function(Vn){this._time=Vn}),Vn}(),Ve=(function(){function Vn(){}Vq(Vn,"laya.d3.core.trail.module.GradientMode"),Vn.Blend=0,Vn.Fixed=1}(),function(){function Vn(){}Vq(Vn,"laya.d3.core.trail.module.TextureMode"),Vn.Stretch=0,Vn.Tile=1}(),function(){function Vn(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}Vq(Vn,"laya.d3.core.trail.module.TrailKeyFrame"),Vn.prototype.cloneTo=function(Vn){Vn.time=this.time,Vn.inTangent=this.inTangent,Vn.outTangent=this.outTangent,Vn.value=this.value}}(),function(){function Va(Vn){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new VQa,this._curPosition=new VQa,this._delVector3=new VQa,this._lastFixedVertexPosition=new VQa,this._pointAtoBVector3=new VQa,this._pointA=new VQa,this._pointB=new VQa,this._owner=Vn,this._id=Va.renderElementCount++,0==this._id?Vn._owner.transform.position.cloneTo(this._lastPosition):Vn._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new Vfa(Ve.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new Vfa(Ve.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}Vq(Va,"laya.d3.core.trail.TrailRenderElement");var Vn=Va.prototype;VY.imps(Vn,{"laya.d3.core.render.IRenderable":!0}),Vn._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},Vn._addTrailByFirstPosition=function(Vn,Va){VQa.subtract(Va,Vn,this._delVector3),VQa.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),VQa.normalize(this._pointAtoBVector3,this._pointAtoBVector3),VQa.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(Vn),Vn.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},Vn._addTrailByNextPosition=function(Vn){VQa.subtract(Vn,this._lastFixedVertexPosition,this._delVector3),VQa.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),VQa.normalize(this._pointAtoBVector3,this._pointAtoBVector3),VQa.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=VQa.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=VJn.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(Vn),Vn.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(Vn),this._virtualVerticesCount=2)},Vn._updateVerticesByPosition=function(Vn){this._pointe=Vn.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},Vn._updateVertexBuffer2=function(){var Vn,Va=0,VU=0,Vx=0;for(Vx=0,Vn=(this._verticesCount+this._virtualVerticesCount)/2;Vx<Vn;Vx++)VU=0==this._owner.textureMode?(this._VerticesToTailLength[Vx]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[Vx],this._vertices2[Va++]=1-VU,this._vertices2[Va++]=1-VU;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},Vn._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},Vn._updateDisappear=function(){var Vn,Va=0;for(Va=this._curDisappearIndex,Vn=(this._verticesCount+this._virtualVerticesCount)/2;Va<Vn;Va++)this._owner._curtime-this._everyGroupVertexBirthTime[Va]>=this._owner.time+VJn.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},Vn._beforeRender=function(Vn){return this._camera=Vn.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),VQa.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},Vn._render=function(Vn){this._isDead||(Vu.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),VN.drawCall++,VN.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},Vn._getVertexBuffer=function(Vn){return void 0===Vn&&(Vn=0),0===Vn?this._vertexBuffer1:1===Vn?this._vertexBuffer2:null},Vn._getVertexBuffers=function(){return this._vertexBuffers},Vn._getIndexBuffer=function(){return null},Vn.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},Vn._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},VE(0,Vn,"_vertexBufferCount",function(){return this._vertexBuffers.length}),VE(0,Vn,"triangleCount",function(){return 0}),Va.renderElementCount=0}(),function(){function Vn(){}Vq(Vn,"laya.d3.core.trail.VertexTrail");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration1}),VE(1,Vn,"vertexDeclaration1",function(){return Vn._vertexDeclaration1}),VE(1,Vn,"vertexDeclaration2",function(){return Vn._vertexDeclaration2}),Vz(Vn,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new Vpn(32,[new VQn(0,"vector3",0),new VQn(12,"vector3",41),new VQn(24,"single",33),new VQn(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new Vpn(4,[new VQn(0,"single",38)])}]),Vn}()),Vnn=function(){function VK(Vn){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=Vn}Vq(VK,"laya.d3.graphics.DynamicBatch");var Vn=VK.prototype;return VY.imps(Vn,{"laya.d3.core.render.IRenderable":!0}),Vn._getVertexBuffer=function(Vn){return void 0===Vn&&(Vn=0),0===Vn?this._vertexBuffer:null},Vn._getIndexBuffer=function(){return this._indexBuffer},Vn._getCombineRenderElementFromPool=function(Vn,Va,VU){var Vx=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return Vx||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=Vx=new VS,Vx._sprite3D=new Vwa),Vx._sprite3D._render._renderUpdate(VU),Vx},Vn._getRenderElement=function(Vn,Va,VU){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*VK.maxVertexCount),this._indexDatas=new Uint16Array(VK.maxIndexCount),this._vertexBuffer=Vfa.create(this._vertexDeclaration,VK.maxVertexCount,35048),this._indexBuffer=Vha.create("ushort",VK.maxIndexCount,35048));for(var Vx=this._merageElements.length=0,VD=0,Vp=0,VQ=this._combineRenderElements.length;Vp<VQ;Vp++){var VV=this._combineRenderElements[Vp],Vy=VV.getDynamicBatchBakedVertexs(0),VR=VV.getBakedIndices(),VX=VV._sprite3D.transform._isFrontFaceInvert,Vz=Vx/(this._vertexDeclaration.vertexStride/4),Vi=VD,Vq=Vi+VR.length;VV._tempBatchIndexStart=Vi,VV._tempBatchIndexEnd=Vq,this._indexDatas.set(VR,VD);var VE=0;if(VX)for(VE=Vi;VE<Vq;VE+=3){this._indexDatas[VE]=Vz+this._indexDatas[VE];var Vm=this._indexDatas[VE+1],Vb=this._indexDatas[VE+2];this._indexDatas[VE+1]=Vz+Vb,this._indexDatas[VE+2]=Vz+Vm}else for(VE=Vi;VE<Vq;VE+=3)this._indexDatas[VE]=Vz+this._indexDatas[VE],this._indexDatas[VE+1]=Vz+this._indexDatas[VE+1],this._indexDatas[VE+2]=Vz+this._indexDatas[VE+2];VD+=VR.length,this._vertexDatas.set(Vy,Vx),Vx+=Vy.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),Vp=this._combineRenderElementPoolIndex=0,VQ=this._materials.length;Vp<VQ;Vp++){var VP=this._getCombineRenderElementFromPool(Vn,Va,VU);VP._type=2,VP._staticBatch=null;var VA=(VP.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[Vp]]._tempBatchIndexStart,VT=Vp+1===this._materialToRenderElementsOffsets.length?VD:this._combineRenderElements[this._materialToRenderElementsOffsets[Vp+1]]._tempBatchIndexStart;VP._tempBatchIndexStart=VA,VP._tempBatchIndexEnd=VT,VP._material=this._materials[Vp],this._merageElements.push(VP)}},Vn._addCombineRenderObjTest=function(Vn){var Va=Vn.renderObj,VU=this._currentCombineIndexCount+Va._getIndexBuffer().indexCount,Vx=this._currentCombineVertexCount+Va._getVertexBuffer().vertexCount;return!(VK.maxVertexCount<Vx||VK.maxIndexCount<VU)},Vn._addCombineRenderObj=function(Vn){var Va=Vn.renderObj;this._combineRenderElements.push(Vn),this._currentCombineIndexCount=this._currentCombineIndexCount+Va._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+Va._getVertexBuffer().vertexCount},Vn._addCombineMaterial=function(Vn){this._materials.push(Vn)},Vn._addMaterialToRenderElementOffset=function(Vn){this._materialToRenderElementsOffsets.push(Vn)},Vn._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},Vn._addToRenderQueue=function(Vn,Va,VU,Vx){this._getRenderElement(Va,VU,Vx);for(var VD=0,Vp=this._materials.length;VD<Vp;VD++)Vn.getRenderQueue(this._materials[VD].renderQueue)._addDynamicBatchElement(this._merageElements[VD])},Vn._beforeRender=function(Vn){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Vn._render=function(Vn){var Va=Vn._batchIndexEnd-Vn._batchIndexStart;Vu.mainContext.drawElements(4,Va,5123,2*Vn._batchIndexStart),VN.drawCall++,VN.trianglesFaces+=Va/3},Vn._getVertexBuffers=function(){return null},VE(0,Vn,"_vertexBufferCount",function(){return 1}),VE(0,Vn,"triangleCount",function(){return this._indexBuffer.indexCount/3}),VE(0,Vn,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),VK.maxVertexCount=2e4,VK.maxIndexCount=4e4,VK.maxCombineTriangleCount=10,VK}(),Van=function(){function VK(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}Vq(VK,"laya.d3.graphics.DynamicBatchManager");var Vn=VK.prototype;return Vn.getDynamicBatch=function(Vn,Va){var VU,Vx=Vn.id.toString()+Va;return this._dynamicBatches[Vx]?VU=this._dynamicBatches[Vx]:this._dynamicBatches[Vx]=VU=new Vnn(Vn),VU},Vn._garbageCollection=function(){for(var Vn in this._dynamicBatches)0===this._dynamicBatches[Vn].combineRenderElementsCount&&delete this._dynamicBatches[Vn]},Vn._addPrepareRenderElement=function(Vn){this._prepareDynamicBatchCombineElements.push(Vn)},Vn._finishCombineDynamicBatch=function(Vn){var Va,VU,Vx;this._prepareDynamicBatchCombineElements.sort(VK._sortPrepareDynamicBatch);for(var VD,Vp,VQ,VV,Vy,VR=-1,VX=!0,Vz=0,Vi=-1,Vq=0,VE=this._prepareDynamicBatchCombineElements.length;Vq<VE;Vq++){var Vm=(Vp=this._prepareDynamicBatchCombineElements[Vq]).renderObj._getVertexBuffer(0).vertexDeclaration,Vb=VU!==Vm;Vb&&(Vz=0,VU=Vm);var VP=Vz!==VR;if(VP&&(VR=Vz),(Vb||VP)&&(VQ=this.getDynamicBatch(Vm,Vz),Va=null),VX)if(VQ._addCombineRenderObjTest(Vp)){if(Va!==(VD=Vp._material))VV&&(Vn.getRenderQueue(Vy._material.renderQueue)._addRenderElement(Vy),Vy=VV=null,Vi=-1),VV=VD,Vi=VQ.combineRenderElementsCount,Vy=Vp,Va=VD;else if(VV){var VA=Vy.renderObj,VT=Vp.renderObj;VA._getVertexBuffer().vertexCount+VT._getVertexBuffer().vertexCount>Vnn.maxVertexCount||VA._getIndexBuffer().indexCount+VT._getIndexBuffer().indexCount>Vnn.maxIndexCount?(Vn.getRenderQueue(Vy._material.renderQueue)._addRenderElement(Vy),VV=VD,Vi=VQ.combineRenderElementsCount,Vy=Vp):(VQ._addCombineMaterial(VV),VQ._addMaterialToRenderElementOffset(Vi),VQ._addCombineRenderObj(Vy),Vy=VV=null,Vi=-1,VQ._addCombineRenderObj(Vp))}else VQ._addCombineRenderObj(Vp);VX=!0}else VV&&(Vn.getRenderQueue(Vy._material.renderQueue)._addRenderElement(Vy),Vy=VV=null,Vi=-1),Vz++,VX=!1;else Vx=this._prepareDynamicBatchCombineElements[Vq-1],VQ._addMaterialToRenderElementOffset(VQ.combineRenderElementsCount),Va=Vx._material,VQ._addCombineMaterial(Va),VQ._addCombineRenderObj(Vx),VX=!0,Va!==(VD=Vp._material)?(VV=VD,Vi=VQ.combineRenderElementsCount,Vy=Vp):VQ._addCombineRenderObj(Vp),Va=VD}VV&&(Vn.getRenderQueue(Vy._material.renderQueue)._addRenderElement(Vy),Vy=VV=null,Vi=-1),this._prepareDynamicBatchCombineElements.length=0},Vn._clearRenderElements=function(){for(var Vn in this._dynamicBatches)this._dynamicBatches[Vn]._clearRenderElements()},Vn._addToRenderQueue=function(Vn,Va,VU,Vx){for(var VD in this._dynamicBatches){var Vp=this._dynamicBatches[VD];0<Vp.combineRenderElementsCount&&Vp._addToRenderQueue(Vn,Va,VU,Vx)}},Vn.dispose=function(){this._dynamicBatches=null},VK._sortPrepareDynamicBatch=function(Vn,Va){return Vn._mainSortID-Va._mainSortID},VK}(),VUn=function(){function Vn(){}return Vq(Vn,"laya.d3.graphics.FrustumCulling"),Vn.renderShadowObjectCulling=function(Vn,Va,VU,Vx,VD){var Vp=0,VQ=0,VV=0,Vy=0;for(Vp=0,VV=VU.length;Vp<VV;Vp++){var VR=VU[Vp];VR&&VR._clearRenderElements()}var VX,Vz,Vi,Vq=Vn._cullingRenders;if(1<VD){for(Vp=0,VV=Vn._cullingRendersLength;Vp<VV;Vp++)if((VX=Vq[Vp]).castShadow&&VG.isVisible(VX._owner.layer.mask)&&VX.enable)for(var VE=1,Vm=Va.length;VE<Vm;VE++)if(Vz=VU[VE-1],0!==Va[VE].containsBoundSphere(VX.boundingSphere))for(VQ=0,Vy=(Vi=VX._renderElements).length;VQ<Vy;VQ++)Vz._addRenderElement(Vi[VQ])}else for(Vp=0,VV=Vn._cullingRendersLength;Vp<VV;Vp++)if((VX=Vq[Vp]).castShadow&&VG.isVisible(VX._owner.layer.mask)&&VX.enable&&0!==Va[0].containsBoundSphere(VX.boundingSphere))for(VX._renderUpdate(Vx),Vz=VU[0],VQ=0,Vy=(Vi=VX._renderElements).length;VQ<Vy;VQ++)Vz._addRenderElement(Vi[VQ])},Vn.renderShadowObjectCullingOctree=function(Vn,Va,VU,Vx,VD){for(var Vp=0,VQ=VU.length;Vp<VQ;Vp++){var VV=VU[Vp];VV&&VV._clearRenderElements()}1<VD?Vn.treeRoot.cullingShadowObjects(Va,VU,!0,0,Vn):Vn.treeRoot.cullingShadowObjectsOnePSSM(Va[0],VU,Vx,!0,0,Vn)},Vn.renderObjectCulling=function(Vn,Va,VU,Vx,VD,Vp){var VQ=0,VV=0,Vy=0,VR=0,VX=Va._quenes,Vz=Va._dynamicBatchManager,Vi=Va._cullingRenders;for(VQ=0,VV=VX.length;VQ<VV;VQ++){var Vq=VX[VQ];Vq&&Vq._clearRenderElements()}var VE=Vxn._staticBatchManagers;for(VQ=0,VV=VE.length;VQ<VV;VQ++)VE[VQ]._clearRenderElements();Vz._clearRenderElements();var Vm=VU.transform.position;for(VQ=0,VV=Va._cullingRendersLength;VQ<VV;VQ++){var Vb=Vi[VQ];if(VG.isVisible(Vb._owner.layer.mask)&&Vb.enable&&0!==Vn.containsBoundSphere(Vb.boundingSphere)&&Vb._renderUpdate(Vp)){Vb._distanceForSort=VQa.distance(Vb.boundingSphere.center,Vm)+Vb.sortingFudge;var VP=Vb._renderElements;for(Vy=0,VR=VP.length;Vy<VR;Vy++){var VA=VP[Vy],VT=VA._staticBatch;if(VT&&VT._material===VA._material)VT._addBatchRenderElement(VA);else{var VK=VA.renderObj;VK.triangleCount<10&&1===VK._vertexBufferCount&&VK._getIndexBuffer()&&VA._material.renderQueue<2&&VA._canDynamicBatch&&!Vb._owner.isStatic?Vz._addPrepareRenderElement(VA):Va.getRenderQueue(VA._material.renderQueue)._addRenderElement(VA)}}}}for(VQ=0,VV=VE.length;VQ<VV;VQ++)VE[VQ]._addToRenderQueue(Va,Vx,VD,Vp);Vz._finishCombineDynamicBatch(Va),Vz._addToRenderQueue(Va,Vx,VD,Vp)},Vn.renderObjectCullingOctree=function(Vn,Va,VU,Vx,VD,Vp){var VQ=0,VV=0,Vy=Va._quenes,VR=Va._dynamicBatchManager;for(VQ=0,VV=Vy.length;VQ<VV;VQ++){var VX=Vy[VQ];VX&&VX._clearRenderElements()}var Vz=Vxn._staticBatchManagers;for(VQ=0,VV=Vz.length;VQ<VV;VQ++)Vz[VQ]._clearRenderElements();for(VR._clearRenderElements(),Va._cullingRenders.length=0,Va.treeRoot.cullingObjects(Vn,!0,0,VU.transform.position,Vp),VQ=0,VV=Vz.length;VQ<VV;VQ++)Vz[VQ]._addToRenderQueue(Va,Vx,VD,Vp);VR._finishCombineDynamicBatch(Va),VR._addToRenderQueue(Va,Vx,VD,Vp)},Vn.renderObjectCullingNoBoundFrustum=function(Vn,Va,VU,Vx,VD){var Vp=0,VQ=0,VV=0,Vy=0,VR=Vn._quenes,VX=Vn._dynamicBatchManager,Vz=Vn._cullingRenders;for(Vp=0,VQ=VR.length;Vp<VQ;Vp++){var Vi=VR[Vp];Vi&&Vi._clearRenderElements()}var Vq=Vxn._staticBatchManagers;for(Vp=0,VQ=Vq.length;Vp<VQ;Vp++)Vq[Vp]._clearRenderElements();VX._clearRenderElements();var VE=Va.transform.position;for(Vp=0,VQ=Vn._cullingRendersLength;Vp<VQ;Vp++){var Vm=Vz[Vp];if(VG.isVisible(Vm._owner.layer.mask)&&Vm.enable){Vm._renderUpdate(VD),Vm._distanceForSort=VQa.distance(Vm.boundingSphere.center,VE)+Vm.sortingFudge;var Vb=Vm._renderElements;for(VV=0,Vy=Vb.length;VV<Vy;VV++){var VP=Vb[VV],VA=VP._staticBatch;if(VA&&VA._material===VP._material)VA._addBatchRenderElement(VP);else{var VT=VP.renderObj;VT.triangleCount<10&&1===VT._vertexBufferCount&&VT._getIndexBuffer()&&VP._material.renderQueue<2&&VP._canDynamicBatch&&!Vm._owner.isStatic?VX._addPrepareRenderElement(VP):Vn.getRenderQueue(VP._material.renderQueue)._addRenderElement(VP)}}}}for(Vp=0,VQ=Vq.length;Vp<VQ;Vp++)Vq[Vp]._addToRenderQueue(Vn,VU,Vx,VD);VX._finishCombineDynamicBatch(Vn),VX._addToRenderQueue(Vn,VU,Vx,VD)},Vn}(),Vxn=function(){function Vp(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}Vq(Vp,"laya.d3.graphics.StaticBatchManager");var Vn=Vp.prototype;return Vn._finishInit=function(){for(var Vn in this._staticBatches)this._staticBatches[Vn]._finishInit();this._initBatchRenderElements.length=0},Vn._initStaticBatchs=function(Vn){throw new Error("StaticBatchManager:must override this function.")},Vn._addInitBatchSprite=function(Vn){for(var Va=Vn._render._renderElements,VU=0,Vx=Va.length;VU<Vx;VU++)this._initBatchRenderElements.push(Va[VU])},Vn._clearRenderElements=function(){for(var Vn in this._staticBatches)this._staticBatches[Vn]._clearRenderElements()},Vn._garbageCollection=function(Vn){var Va=Vn._staticBatch,VU=Va._initBatchRenderElements,Vx=VU.indexOf(Vn);VU.splice(Vx,1),0===VU.length&&(Va.dispose(),delete this._staticBatches[Va._key])},Vn._addToRenderQueue=function(Vn,Va,VU,Vx){for(var VD in this._staticBatches){var Vp=this._staticBatches[VD];0<Vp._batchRenderElements.length&&Vp._updateToRenderQueue(Vn,Vx)}},Vn.dispose=function(){this._staticBatches=null},Vp._addToStaticBatchQueue=function(Vn){Vn instanceof laya.d3.core.RenderableSprite3D&&Vn._addToInitStaticBatchManager();for(var Va=0,VU=Vn.numChildren;Va<VU;Va++)Vp._addToStaticBatchQueue(Vn._childs[Va])},Vp.combine=function(Vn,Va){var VU,Vx=0,VD=0;if(Va)for(Vx=0,VD=Va.length;Vx<VD;Vx++){Va[Vx]._addToInitStaticBatchManager()}else Vn&&Vp._addToStaticBatchQueue(Vn);for(Vx=0,VD=Vp._staticBatchManagers.length;Vx<VD;Vx++)(VU=Vp._staticBatchManagers[Vx])._initStaticBatchs(Vn),VU._finishInit()},Vp._staticBatchManagers=[],Vp}(),VDn=function(){function Vn(Vn,Va,VU){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=Vn,this._manager=Va,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=VU}Vq(Vn,"laya.d3.graphics.StaticBatch");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),Va._binarySearch=function(Vn){for(var Va=0,VU=this._batchRenderElements.length-1,Vx=0;Va<=VU;)Vx=Math.floor((Va+VU)/2),this._compareBatchRenderElement(this._batchRenderElements[Vx],Vn)?VU=Vx-1:Va=Vx+1;return Va},Va._compareBatchRenderElement=function(Vn,Va){throw new Error("StaticBatch:must override this function.")},Va._getVertexDecLightMap=function(Vn){return Vn===Vhn.vertexDeclaration?VGn.vertexDeclaration:Vn===Vjn.vertexDeclaration?VHn.vertexDeclaration:Vn===V_n.vertexDeclaration?VKn.vertexDeclaration:Vn===Von.vertexDeclaration?null:Vn===Vmn.vertexDeclaration?Vbn.vertexDeclaration:Vn===VFn.vertexDeclaration?Vvn.vertexDeclaration:Vn===Vun.vertexDeclaration?Vcn.vertexDeclaration:Vn===Vfn.vertexDeclaration?VIn.vertexDeclaration:Vn===Vjn.vertexDeclaration?VHn.vertexDeclaration:Vn===V$n.vertexDeclaration?VYn.vertexDeclaration:Vn===Von.vertexDeclaration?null:Vn===Vmn.vertexDeclaration?Vbn.vertexDeclaration:Vn===Vgn.vertexDeclaration?Vln.vertexDeclaration:Vn===Vun.vertexDeclaration?Vcn.vertexDeclaration:Vn},Va._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},Va._addBatchRenderElement=function(Vn){this._batchRenderElements.splice(this._binarySearch(Vn),0,Vn)},Va._updateToRenderQueue=function(Vn,Va){this._combineRenderElementPoolIndex=0,this._getRenderElement(Vn.getRenderQueue(this._material.renderQueue)._renderElements,Vn,Va)},Va._getRenderElement=function(Vn,Va,VU){throw new Error("StaticBatch:must override this function.")},Va._finishInit=function(){throw new Error("StaticBatch:must override this function.")},Va._clearRenderElements=function(){this._batchRenderElements.length=0},Va.dispose=function(){},Va._getVertexBuffer=function(Vn){return void 0===Vn&&(Vn=0),null},Va._getIndexBuffer=function(){return null},Va._beforeRender=function(Vn){return!0},Va._render=function(Vn){},Va._getVertexBuffers=function(){return null},VE(0,Va,"_vertexBufferCount",function(){return 1}),VE(0,Va,"triangleCount",function(){return 0}),Vn.combine=function(Vn){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),Vxn.combine(Vn)},Vn.maxBatchVertexCount=65535,Vn}(),Vpn=function(){function VQ(Vn,Va){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++VQ._uniqueIDCounter,this._id>VQ.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",VQ.maxVertexDeclaration);this._shaderValues=new Via,this._vertexElementsDic={},this._vertexStride=Vn,this._vertexElements=Va;for(var VU=0;VU<Va.length;VU++){var Vx=Va[VU],VD=Vx.elementUsage;this._vertexElementsDic[VD]=Vx;var Vp=[VQ._getTypeSize(Vx.elementFormat)/4,5126,!1,this._vertexStride,Vx.offset];switch(this._shaderValues.setValue(VD,Vp),VD){case 1:this._addShaderDefine(VNa.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(VNa.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(VNa.SHADERDEFINE_UV1)}}}Vq(VQ,"laya.d3.graphics.VertexDeclaration");var Vn=VQ.prototype;return Vn._addShaderDefine=function(Vn){this._shaderDefineValue|=Vn},Vn._removeShaderDefine=function(Vn){this._shaderDefineValue&=~Vn},Vn.getVertexElements=function(){return this._vertexElements.slice()},Vn.getVertexElementByUsage=function(Vn){return this._vertexElementsDic[Vn]},Vn.unBinding=function(){},VE(0,Vn,"shaderDefineValue",function(){return this._shaderDefineValue}),VE(0,Vn,"id",function(){return this._id}),VE(0,Vn,"vertexStride",function(){return this._vertexStride}),VE(0,Vn,"shaderValues",function(){return this._shaderValues}),VQ._getTypeSize=function(Vn){switch(Vn){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},VQ.getVertexStride=function(Vn){for(var Va=0,VU=0;VU<Vn.Length;VU++){var Vx=Vn[VU],VD=Vx.offset+VQ._getTypeSize(Vx.elementFormat);Va<VD&&(Va=VD)}return Va},VQ._maxVertexDeclarationBit=1e3,VQ._uniqueIDCounter=1,Vz(VQ,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),VQ}(),VQn=function(){function Vn(Vn,Va,VU){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=Vn,this.elementFormat=Va,this.elementUsage=VU}return Vq(Vn,"laya.d3.graphics.VertexElement"),Vn}(),VVn=(function(){function Vn(){}Vq(Vn,"laya.d3.graphics.VertexElementFormat"),Vn.Single="single",Vn.Vector2="vector2",Vn.Vector3="vector3",Vn.Vector4="vector4",Vn.Color="color",Vn.Byte4="byte4",Vn.Short2="short2",Vn.Short4="short4",Vn.NormalizedShort2="normalizedshort2",Vn.NormalizedShort4="normalizedshort4",Vn.HalfVector2="halfvector2",Vn.HalfVector4="halfvector4"}(),function(){function Vn(){}Vq(Vn,"laya.d3.graphics.VertexElementUsage"),Vn.POSITION0=0,Vn.COLOR0=1,Vn.TEXTURECOORDINATE0=2,Vn.NORMAL0=3,Vn.BINORMAL0=4,Vn.TANGENT0=5,Vn.BLENDINDICES0=6,Vn.BLENDWEIGHT0=7,Vn.DEPTH0=8,Vn.FOG0=9,Vn.POINTSIZE0=10,Vn.SAMPLE0=11,Vn.TESSELLATEFACTOR0=12,Vn.COLOR1=13,Vn.NEXTTEXTURECOORDINATE0=14,Vn.TEXTURECOORDINATE1=15,Vn.NEXTTEXTURECOORDINATE1=16,Vn.CORNERTEXTURECOORDINATE0=17,Vn.VELOCITY0=18,Vn.STARTCOLOR0=19,Vn.STARTSIZE=20,Vn.AGEADDSCALE0=21,Vn.STARTROTATION=22,Vn.ENDCOLOR0=23,Vn.STARTLIFETIME=24,Vn.TIME0=33,Vn.SHAPEPOSITIONSTARTLIFETIME=30,Vn.DIRECTIONTIME=32,Vn.SIZEROTATION0=27,Vn.RADIUS0=28,Vn.RADIAN0=29,Vn.STARTSPEED=31,Vn.RANDOM0=34,Vn.RANDOM1=35,Vn.SIMULATIONWORLDPOSTION=36,Vn.SIMULATIONWORLDROTATION=37,Vn.TEXTURECOORDINATE0X=38,Vn.TEXTURECOORDINATE0X1=39,Vn.TEXTURECOORDINATE0Y=40,Vn.OFFSETVECTOR=41}(),function(){function Vn(Vn,Va,VU){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=Vn,this._textureCoordinate0=Va,this._time=VU}Vq(Vn,"laya.d3.graphics.VertexGlitter");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate0}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"time",function(){return this._time}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(24,[new VQn(0,"vector3",0),new VQn(12,"vector2",2),new VQn(20,"single",33)])}])}(),function(){function Vn(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=Vn,this._position=Va,this._velocity=VU,this._startColor=Vx,this._endColor=VD,this._sizeRotation=Vp,this._radius=VQ,this._radian=VV,this._ageAddScale=Vy,this._time=VR}Vq(Vn,"laya.d3.graphics.VertexParticle");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"endColor",function(){return this._endColor}),VE(0,Va,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),VE(0,Va,"sizeRotation",function(){return this._sizeRotation}),VE(0,Va,"velocity",function(){return this._velocity}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"startColor",function(){return this._startColor}),VE(0,Va,"radius",function(){return this._radius}),VE(0,Va,"radian",function(){return this._radian}),VE(0,Va,"ageAddScale",function(){return this._ageAddScale}),VE(0,Va,"time",function(){return this._time}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(116,[new VQn(0,"vector4",17),new VQn(16,"vector3",0),new VQn(28,"vector3",18),new VQn(40,"vector4",19),new VQn(56,"vector4",23),new VQn(72,"vector3",27),new VQn(84,"vector2",28),new VQn(92,"vector4",29),new VQn(108,"single",24),new VQn(112,"single",33)])}])}(),function(){function Vn(Vn){this._position=null,this._position=Vn}Vq(Vn,"laya.d3.graphics.VertexPosition");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(12,[new VQn(0,"vector3",0)])}]),Vn}()),Vyn=function(){function Vn(Vn,Va){this._position=null,this._normal=null,this._position=Vn,this._normal=Va}Vq(Vn,"laya.d3.graphics.VertexPositionNormal");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(24,[new VQn(0,"vector3",0),new VQn(12,"vector3",3)])}]),Vn}(),VRn=function(){function Vn(Vn,Va,VU){this._position=null,this._normal=null,this._color=null,this._position=Vn,this._normal=Va,this._color=VU}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColor");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(40,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1)])}]),Vn}(),VXn=function(){function Vn(Vn,Va,VU,Vx,VD){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=Vn,this._normal=Va,this._color=VU,this._blendIndex=Vx,this._blendWeight=VD}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorSkin");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(72,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector4",7),new VQn(56,"vector4",6)])}]),Vn}(),Vzn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Vn,this._normal=Va,this._color=VU,this._tangent=Vx,this._blendIndex=VD,this._blendWeight=Vp}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(88,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector4",7),new VQn(56,"vector4",6),new VQn(72,"vector4",5)])}]),Vn}(),Vin=function(){function Vn(Vn,Va,VU,Vx,VD,Vp){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Vn,this._normal=Va,this._color=VU,this._tangent=Vx,this._blendIndex=VD,this._blendWeight=Vp}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(84,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector4",7),new VQn(56,"vector4",6),new VQn(72,"vector3",5)])}]),Vn}(),Vqn=function(){function Vn(Vn,Va,VU,Vx){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=Vn,this._normal=Va,this._color=VU,this._tangent=Vx}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorSTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(56,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector4",5)])}]),Vn}(),VEn=function(){function Vn(Vn,Va,VU,Vx){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=Vn,this._normal=Va,this._color=VU,this._tangent=Vx}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(52,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector3",5)])}]),Vn}(),Vmn=function(){function Vn(Vn,Va,VU,Vx){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=Vn,this._normal=Va,this._color=VU,this._textureCoordinate=Vx}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTexture");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(48,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector2",2)])}]),Vn}(),Vbn=function(){function Vn(Vn,Va,VU,Vx,VD){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=Vn,this._normal=Va,this._color=VU,this._textureCoordinate0=Vx,this._textureCoordinate1=VD}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(56,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector2",2),new VQn(48,"vector2",15)])}]),Vn}(),VPn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp,VQ){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=Vn,this._normal=Va,this._color=VU,this._textureCoordinate0=Vx,this._textureCoordinate1=VD,this._blendIndex=Vp,this._blendWeight=VQ}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(88,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector2",2),new VQn(48,"vector2",15),new VQn(56,"vector4",7),new VQn(72,"vector4",6)])}]),Vn}(),VAn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp,VQ,VV){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Vn,this._normal=Va,this._color=VU,this._textureCoordinate0=Vx,this._textureCoordinate1=VD,this._tangent=Vp,this._blendIndex=VQ,this._blendWeight=VV}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(104,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector2",2),new VQn(48,"vector2",15),new VQn(56,"vector4",7),new VQn(72,"vector4",6),new VQn(88,"vector4",5)])}]),Vn}(),VTn=function(){function Vn(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),Va.VertexPositionNormalColorTexture0SkinTangent=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){this._position=Vn,this._normal=Va,this._color=VU,this._textureCoordinate0=Vx,this._textureCoordinate1=VD,this._tangent=Vp,this._blendIndex=VQ,this._blendWeight=VV},VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(100,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector2",2),new VQn(48,"vector2",15),new VQn(56,"vector4",7),new VQn(72,"vector4",6),new VQn(88,"vector3",5)])}]),Vn}(),VKn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=Vn,this._normal=Va,this._color=VU,this._textureCoordinate0=Vx,this._textureCoordinate1=VD,this._tangent=Vp}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(72,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector2",2),new VQn(48,"vector2",15),new VQn(56,"vector4",5)])}]),Vn}(),VYn=function(){function Vn(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),Va.VertexPositionNormalColorTexture0Tangent=function(Vn,Va,VU,Vx,VD,Vp){this._position=Vn,this._normal=Va,this._color=VU,this._textureCoordinate0=Vx,this._textureCoordinate1=VD,this._tangent=Vp},VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(68,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector2",2),new VQn(48,"vector2",15),new VQn(56,"vector3",5)])}]),Vn}(),VWn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=Vn,this._normal=Va,this._color=VU,this._textureCoordinate=Vx,this._blendIndex=VD,this._blendWeight=Vp}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(80,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector2",2),new VQn(48,"vector4",7),new VQn(64,"vector4",6)])}]),Vn}(),Vkn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp,VQ){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Vn,this._normal=Va,this._color=VU,this._textureCoordinate=Vx,this._tangent=VD,this._blendIndex=Vp,this._blendWeight=VQ}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(96,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector2",2),new VQn(48,"vector4",7),new VQn(64,"vector4",6),new VQn(80,"vector4",5)])}]),Vn}(),VNn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp,VQ){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Vn,this._normal=Va,this._color=VU,this._textureCoordinate=Vx,this._tangent=VD,this._blendIndex=Vp,this._blendWeight=VQ}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(92,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector2",2),new VQn(48,"vector4",7),new VQn(64,"vector4",6),new VQn(80,"vector3",5)])}]),Vn}(),V_n=function(){function Vn(Vn,Va,VU,Vx,VD){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=Vn,this._normal=Va,this._color=VU,this._textureCoordinate=Vx,this._tangent=VD}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(64,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector2",2),new VQn(48,"vector4",5)])}]),Vn}(),V$n=function(){function Vn(Vn,Va,VU,Vx,VD){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=Vn,this._normal=Va,this._color=VU,this._textureCoordinate=Vx,this._tangent=VD}Vq(Vn,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"color",function(){return this._color}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(60,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",1),new VQn(40,"vector2",2),new VQn(48,"vector3",5)])}]),Vn}(),VMn=function(){function Vn(Vn,Va,VU){this._position=null,this._normal=null,this._tangent=null,this._position=Vn,this._normal=Va,this._tangent=VU}Vq(Vn,"laya.d3.graphics.VertexPositionNormalSTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(40,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector4",5)])}]),Vn}(),VZn=function(){function Vn(Vn,Va,VU){this._position=null,this._normal=null,this._tangent=null,this._position=Vn,this._normal=Va,this._tangent=VU}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(36,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector3",5)])}]),Vn}(),Vun=function(){function Vn(Vn,Va,VU){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Vn,this._normal=Va,this._textureCoordinate=VU}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTexture");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(32,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2)])}]),Vn}(),Vcn=function(){function Vn(Vn,Va,VU,Vx){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=Vn,this._normal=Va,this._textureCoordinate0=VU,this._textureCoordinate1=Vx}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(40,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2),new VQn(32,"vector2",15)])}]),Vn}(),VHn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=Vn,this._normal=Va,this._textureCoordinate0=VU,this._textureCoordinate1=Vx,this._blendIndex=VD,this._blendWeight=Vp}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(72,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2),new VQn(32,"vector2",15),new VQn(40,"vector4",7),new VQn(56,"vector4",6)])}]),Vn}(),VGn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp,VQ){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Vn,this._normal=Va,this._textureCoordinate0=VU,this._textureCoordinate1=Vx,this._tangent=VD,this._blendIndex=Vp,this._blendWeight=VQ}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(88,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2),new VQn(32,"vector2",15),new VQn(40,"vector4",7),new VQn(56,"vector4",6),new VQn(72,"vector4",5)])}]),Vn}(),VIn=function(){function Vn(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),Va.VertexPositionNormalTexture0SkinTangent=function(Vn,Va,VU,Vx,VD,Vp,VQ){this._position=Vn,this._normal=Va,this._textureCoordinate0=VU,this._textureCoordinate1=Vx,this._tangent=VD,this._blendIndex=Vp,this._blendWeight=VQ},VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(84,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2),new VQn(32,"vector2",15),new VQn(40,"vector4",7),new VQn(56,"vector4",6),new VQn(72,"vector3",5)])}]),Vn}(),Vvn=function(){function Vn(Vn,Va,VU,Vx,VD){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=Vn,this._normal=Va,this._textureCoordinate0=VU,this._textureCoordinate1=Vx,this._tangent=VD}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(56,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2),new VQn(32,"vector2",15),new VQn(40,"vector4",5)])}]),Vn}(),Vln=function(){function Vn(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),Va.VertexPositionNormalTexture0Tangent=function(Vn,Va,VU,Vx,VD){this._position=Vn,this._normal=Va,this._textureCoordinate0=VU,this._textureCoordinate1=Vx,this._tangent=VD},VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(52,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2),new VQn(32,"vector2",15),new VQn(40,"vector3",5)])}]),Vn}(),Vjn=function(){function Vn(Vn,Va,VU,Vx,VD){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=Vn,this._normal=Va,this._textureCoordinate=VU,this._blendIndex=Vx,this._blendWeight=VD}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTextureSkin");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(64,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2),new VQn(32,"vector4",7),new VQn(48,"vector4",6)])}]),Vn}(),Vhn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Vn,this._normal=Va,this._textureCoordinate=VU,this._tangent=Vx,this._blendIndex=VD,this._blendWeight=Vp}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(80,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2),new VQn(32,"vector4",7),new VQn(48,"vector4",6),new VQn(64,"vector4",5)])}]),Vn}(),Vfn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Vn,this._normal=Va,this._textureCoordinate=VU,this._tangent=Vx,this._blendIndex=VD,this._blendWeight=Vp}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(76,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2),new VQn(32,"vector4",7),new VQn(48,"vector4",6),new VQn(64,"vector3",5)])}]),Vn}(),VFn=function(){function Vn(Vn,Va,VU,Vx){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=Vn,this._normal=Va,this._textureCoordinate=VU,this._tangent=Vx}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(48,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2),new VQn(32,"vector4",5)])}]),Vn}(),Vgn=function(){function Vn(Vn,Va,VU,Vx){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=Vn,this._normal=Va,this._textureCoordinate=VU,this._tangent=Vx}Vq(Vn,"laya.d3.graphics.VertexPositionNormalTextureTangent");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(44,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2),new VQn(32,"vector3",5)])}]),Vn}(),Von=function(){function Vn(Vn,Va,VU){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Vn,this._normal=Va,this._textureCoordinate=VU}Vq(Vn,"laya.d3.graphics.VertexPositionNTBTexture");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(56,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector3",5),new VQn(36,"vector3",4),new VQn(48,"vector2",2)])}]),Vn}(),VBn=function(){function Vn(Vn,Va,VU,Vx,VD,Vp,VQ,VV){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=Vn,this._normal=Va,this._textureCoordinate0=Vx,this._textureCoordinate1=VD,this._tangent=Vp,VU=VU,this._blendIndex=VQ,this._blendWeight=VV}Vq(Vn,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"tangent",function(){return this._tangent}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(0,Va,"textureCoordinate1",function(){return this._textureCoordinate1}),VE(0,Va,"blendIndex",function(){return this._blendIndex}),VE(0,Va,"blendWeight",function(){return this._blendWeight}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(96,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector3",5),new VQn(36,"vector3",4),new VQn(48,"vector2",2),new VQn(56,"vector2",15),new VQn(64,"vector4",7),new VQn(80,"vector4",6)])}]),Vn}(),VOn=function(){function Vn(Vn,Va,VU){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Vn,this._normal=Va,this._textureCoordinate=VU}Vq(Vn,"laya.d3.graphics.VertexPositionNTBTextureSkin");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"textureCoordinate",function(){return this._textureCoordinate}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(88,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector3",5),new VQn(36,"vector3",4),new VQn(48,"vector2",2),new VQn(56,"vector4",7),new VQn(72,"vector4",6)])}]),Vn}(),VLn=(function(){function Vn(Vn,Va,VU,Vx){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=Vn,this._normal=Va,this._textureCoord0=VU,this._textureCoord1=Vx}Vq(Vn,"laya.d3.graphics.VertexPositionTerrain");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"normal",function(){return this._normal}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"textureCoord0",function(){return this._textureCoord0}),VE(0,Va,"textureCoord1",function(){return this._textureCoord1}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(40,[new VQn(0,"vector3",0),new VQn(12,"vector3",3),new VQn(24,"vector2",2),new VQn(32,"vector2",15)])}])}(),function(){function Vn(Vn,Va){this._position=null,this._textureCoordinate0=null,this._position=Vn,this._textureCoordinate0=Va}Vq(Vn,"laya.d3.graphics.VertexPositionTexture0");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"position",function(){return this._position}),VE(0,Va,"textureCoordinate0",function(){return this._textureCoordinate0}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(20,[new VQn(0,"vector3",0),new VQn(12,"vector2",2)])}]),Vn}()),Vdn=(function(){function Vn(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vz,Vi,Vq){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=Vn,this._positionStartLifeTime=Va,this._velocity=VU,this._startColor=Vx,this._startSize=VD,this._startRotation0=Vp,this._startRotation1=VQ,this._startRotation2=VV,this._startLifeTime=Vy,this._time=VR,this._startSpeed=VX,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=Vq}Vq(Vn,"laya.d3.graphics.VertexShurikenParticleBillboard");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),VE(0,Va,"random1",function(){return this._randoms1}),VE(0,Va,"startRotation2",function(){return this._startRotation2}),VE(0,Va,"positionStartLifeTime",function(){return this._positionStartLifeTime}),VE(0,Va,"velocity",function(){return this._velocity}),VE(0,Va,"random0",function(){return this._randoms0}),VE(0,Va,"startSize",function(){return this._startSize}),VE(0,Va,"startColor",function(){return this._startColor}),VE(0,Va,"startRotation0",function(){return this._startRotation0}),VE(0,Va,"startRotation1",function(){return this._startRotation1}),VE(0,Va,"startLifeTime",function(){return this._startLifeTime}),VE(0,Va,"time",function(){return this._time}),VE(0,Va,"startSpeed",function(){return this._startSpeed}),VE(0,Va,"simulationWorldPostion",function(){return this._simulationWorldPostion}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(152,[new VQn(0,"vector4",17),new VQn(16,"vector4",30),new VQn(32,"vector4",32),new VQn(48,"vector4",19),new VQn(64,"vector3",20),new VQn(76,"vector3",22),new VQn(88,"single",31),new VQn(92,"vector4",34),new VQn(108,"vector4",35),new VQn(124,"vector3",36),new VQn(136,"vector4",37)])}])}(),function(){function Vn(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vz,Vi,Vq){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=Vn,this._positionStartLifeTime=Va,this._velocity=VU,this._startColor=Vx,this._startSize=VD,this._startRotation0=Vp,this._startRotation1=VQ,this._startRotation2=VV,this._startLifeTime=Vy,this._time=VR,this._startSpeed=VX,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=Vq}Vq(Vn,"laya.d3.graphics.VertexShurikenParticleMesh");var Va=Vn.prototype;VY.imps(Va,{"laya.d3.graphics.IVertex":!0}),VE(0,Va,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),VE(0,Va,"velocity",function(){return this._velocity}),VE(0,Va,"position",function(){return this._positionStartLifeTime}),VE(0,Va,"random0",function(){return this._randoms0}),VE(0,Va,"startSize",function(){return this._startSize}),VE(0,Va,"startColor",function(){return this._startColor}),VE(0,Va,"startRotation0",function(){return this._startRotation0}),VE(0,Va,"startRotation1",function(){return this._startRotation1}),VE(0,Va,"random1",function(){return this._randoms1}),VE(0,Va,"startRotation2",function(){return this._startRotation2}),VE(0,Va,"startLifeTime",function(){return this._startLifeTime}),VE(0,Va,"time",function(){return this._time}),VE(0,Va,"startSpeed",function(){return this._startSpeed}),VE(0,Va,"simulationWorldPostion",function(){return this._simulationWorldPostion}),VE(0,Va,"vertexDeclaration",function(){return Vn._vertexDeclaration}),VE(1,Vn,"vertexDeclaration",function(){return Vn._vertexDeclaration}),Vz(Vn,["_vertexDeclaration",function(){return this._vertexDeclaration=new Vpn(172,[new VQn(0,"vector3",0),new VQn(12,"vector4",1),new VQn(28,"vector2",2),new VQn(36,"vector4",30),new VQn(52,"vector4",32),new VQn(68,"vector4",19),new VQn(84,"vector3",20),new VQn(96,"vector3",22),new VQn(108,"single",31),new VQn(112,"vector4",34),new VQn(128,"vector4",35),new VQn(144,"vector3",36),new VQn(156,"vector4",37)])}])}(),function(){function VT(Vn,Va,VU,Vx,VD,Vp){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=VU,this._materials=Vx,this._subMeshes=VD,this._materialMap=Vp,this._version=Va,this._onLoaded(Vn)}Vq(VT,"laya.d3.loaders.LoadModelV01");var Vn=VT.prototype;return Vn._onLoaded=function(Vn){this._readData=Vn,this.READ_BLOCK();for(var Va=0;Va<this._BLOCK.count;Va++){var VU=this._readData.getUint16(),Vx=this._strings[VU],VD=this["READ_"+Vx];if(null==VD)throw new Error("model file err,no this function:"+VU+" "+Vx);if(!VD.call(this))break}return this._mesh},Vn.onError=function(){},Vn._readString=function(){return this._strings[this._readData.getUint16()]},Vn.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},Vn.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},Vn.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var Vn=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var Va=0;Va<this._STRINGS.size;Va++)this._strings[Va]=this._readData.readUTFString();return this._readData.pos=Vn,!0},Vn.READ_MATERIAL=function(){var Vn=this._readData.getUint16(),Va=(this._readString(),this._readString());return this._materials[Vn]="null"!==Va?VP.getRes(this._materialMap[Va]):new VZa,!0},Vn.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var Vn,Va=this._readData.__getBuffer(),VU=0,Vx=this._readData.getUint32(),VD=this._readData.getUint32(),Vp=(new Float32Array(Va.slice(Vx+this._DATA.offset,Vx+this._DATA.offset+VD)),this._readData.getUint32()),VQ=this._readData.getUint32(),VV=new Float32Array(Va.slice(Vp+this._DATA.offset,Vp+this._DATA.offset+VQ));for(this.mesh._inverseBindPoses=[],VU=0,Vn=VV.length;VU<Vn;VU+=16){var Vy=new Vna(VV[VU+0],VV[VU+1],VV[VU+2],VV[VU+3],VV[VU+4],VV[VU+5],VV[VU+6],VV[VU+7],VV[VU+8],VV[VU+9],VV[VU+10],VV[VU+11],VV[VU+12],VV[VU+13],VV[VU+14],VV[VU+15]);this.mesh._inverseBindPoses.push(Vy)}break;default:throw new Error("LoadModel:unknown version.")}return!0},Vn.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var Vn=this._readString();this._shaderAttributes=Vn.match(VT._attrReg);var Va=this._readData.getUint32(),VU=this._readData.getUint32(),Vx=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),VD=this._readData.getUint32(),Vp=this._readData.getUint32(),VQ=this._readData.getUint32(),VV=this._readData.__getBuffer(),Vy=new VRa(this._mesh),VR=this._getVertexDeclaration(),VX=Vfa.create(VR,VD/VR.vertexStride,35044,!0),Vz=Vx+this._DATA.offset,Vi=VV.slice(Vz,Vz+VD);VX.setData(new Float32Array(Vi));for(var Vq=(Vy._vertexBuffer=VX).vertexDeclaration.getVertexElements(),VE=0;VE<Vq.length;VE++)Vy._bufferUsage[Vq[VE].elementUsage]=VX;var Vm=Vha.create("ushort",VU/2,35044,!0),Vb=Va+this._DATA.offset,VP=VV.slice(Vb,Vb+VU);Vm.setData(new Uint16Array(VP)),Vy._indexBuffer=Vm;var VA=VV.slice(Vp+this._DATA.offset,Vp+this._DATA.offset+VQ);return Vy._boneIndicesList[0]=new Uint8Array(VA),this._subMeshes.push(Vy),!0},Vn.READ_DATAAREA=function(){return!1},Vn._getVertexDeclaration=function(){for(var Vn,Va=!1,VU=!1,Vx=!1,VD=!1,Vp=!1,VQ=!1,VV=!1,Vy=!1,VR=!1,VX=0;VX<this._shaderAttributes.length;VX+=8)switch(this._shaderAttributes[VX]){case"POSITION":Va=!0;break;case"NORMAL":VU=!0;break;case"COLOR":Vx=!0;break;case"UV":VD=!0;break;case"UV1":Vp=!0;break;case"BLENDWEIGHT":VV=!0;break;case"BLENDINDICES":Vy=!0;break;case"TANGENT":VQ=!0;break;case"BINORMAL":VR=!0}return Va&&VU&&Vx&&VD&&Vp&&VV&&Vy&&VQ?Vn=VTn.vertexDeclaration:Va&&VU&&Vx&&VD&&Vp&&VV&&Vy?Vn=VPn.vertexDeclaration:Va&&VU&&VD&&Vp&&VV&&Vy&&VQ?Vn=VIn.vertexDeclaration:Va&&VU&&VD&&Vp&&VV&&Vy?Vn=VHn.vertexDeclaration:Va&&VU&&Vx&&VD&&VV&&Vy&&VQ?Vn=VNn.vertexDeclaration:Va&&VU&&Vx&&VD&&VV&&Vy?Vn=VWn.vertexDeclaration:Va&&VU&&VQ&&VR&&VD&&VV&&Vy?Vn=VOn.vertexDeclaration:Va&&VU&&VD&&VV&&Vy&&VQ?Vn=Vfn.vertexDeclaration:Va&&VU&&VD&&VV&&Vy?Vn=Vjn.vertexDeclaration:Va&&VU&&Vx&&VV&&Vy&&VQ?Vn=Vin.vertexDeclaration:Va&&VU&&Vx&&VV&&Vy?Vn=VXn.vertexDeclaration:Va&&VU&&Vx&&VD&&Vp&&VQ?Vn=VYn.vertexDeclaration:Va&&VU&&Vx&&VD&&Vp?Vn=Vbn.vertexDeclaration:Va&&VU&&VD&&Vp&&VQ?Vn=Vln.vertexDeclaration:Va&&VU&&VD&&Vp?Vn=Vcn.vertexDeclaration:Va&&VU&&Vx&&VD&&VQ?Vn=V$n.vertexDeclaration:Va&&VU&&VD&&VQ&&VR?Vn=Von.vertexDeclaration:Va&&VU&&Vx&&VD?Vn=Vmn.vertexDeclaration:Va&&VU&&VD&&VQ?Vn=Vgn.vertexDeclaration:Va&&VU&&VD?Vn=Vun.vertexDeclaration:Va&&VU&&Vx&&VQ?Vn=VEn.vertexDeclaration:Va&&VU&&Vx&&(Vn=VRn.vertexDeclaration),Vn},VE(0,Vn,"mesh",function(){return this._mesh}),VT._attrReg=new RegExp("(\\w+)|([:,;])","g"),VT}()),VSn=function(){function Vk(){}return Vq(Vk,"laya.d3.loaders.LoadModelV02"),Vk.parse=function(Vn,Va,VU,Vx,VD,Vp){Vk._mesh=VU,Vk._materials=Vx,Vk._subMeshes=VD,Vk._materialMap=Vp,Vk._version=Va,Vk._readData=Vn,Vk.READ_DATA(),Vk.READ_BLOCK(),Vk.READ_STRINGS();for(var VQ=0,VV=Vk._BLOCK.count;VQ<VV;VQ++){Vk._readData.pos=Vk._BLOCK.blockStarts[VQ];var Vy=Vk._readData.getUint16(),VR=Vk._strings[Vy],VX=Vk["READ_"+VR];if(null==VX)throw new Error("model file err,no this function:"+Vy+" "+VR);VX.call()}Vk._strings.length=0,Vk._readData=null,Vk._version=null,Vk._mesh=null,Vk._materials=null,Vk._subMeshes=null,Vk._materialMap=null},Vk._readString=function(){return Vk._strings[Vk._readData.getUint16()]},Vk.READ_DATA=function(){Vk._DATA.offset=Vk._readData.getUint32(),Vk._DATA.size=Vk._readData.getUint32()},Vk.READ_BLOCK=function(){for(var Vn=Vk._BLOCK.count=Vk._readData.getUint16(),Va=Vk._BLOCK.blockStarts=[],VU=Vk._BLOCK.blockLengths=[],Vx=0;Vx<Vn;Vx++)Va.push(Vk._readData.getUint32()),VU.push(Vk._readData.getUint32())},Vk.READ_STRINGS=function(){var Vn=Vk._readData.getUint32(),Va=Vk._readData.getUint16(),VU=Vk._readData.pos;Vk._readData.pos=Vn+Vk._DATA.offset;for(var Vx=0;Vx<Va;Vx++)Vk._strings[Vx]=Vk._readData.readUTFString();Vk._readData.pos=VU},Vk.READ_MATERIAL=function(){Vk._readString(),Vk._readString();var Vn=Vk._readString();return""!==Vn&&Vk._materials.push(VP.getRes(Vk._materialMap[Vn])),!0},Vk.READ_MESH=function(){Vk._readString();var Vn,Va=Vk._readData.__getBuffer(),VU=0,Vx=Vk._readData.getInt16(),VD=Vk._DATA.offset;for(VU=0;VU<Vx;VU++){var Vp=VD+Vk._readData.getUint32(),VQ=Vk._readData.getUint32(),VV=new Float32Array(Va.slice(Vp,Vp+VQ)),Vy=Vk._readString().match(Vk._attrReg),VR=Vk._getVertexDeclaration(Vy),VX=Vfa.create(VR,4*VV.length/VR.vertexStride,35044,!0);VX.setData(VV),Vk._mesh._vertexBuffers.push(VX)}var Vz=VD+Vk._readData.getUint32(),Vi=Vk._readData.getUint32(),Vq=new Uint16Array(Va.slice(Vz,Vz+Vi)),VE=Vha.create("ushort",Vi/2,35044,!0);VE.setData(Vq),Vk._mesh._indexBuffer=VE;var Vm=Vk._mesh._boneNames=[],Vb=Vk._readData.getUint16();for(Vm.length=Vb,VU=0;VU<Vb;VU++)Vm[VU]=Vk._strings[Vk._readData.getUint16()];var VP=Vk._readData.getUint32(),VA=Vk._readData.getUint32(),VT=(new Float32Array(Va.slice(VD+VP,VD+VP+VA)),Vk._readData.getUint32()),VK=Vk._readData.getUint32(),VY=new Float32Array(Va.slice(VD+VT,VD+VT+VK));for(Vk._mesh._inverseBindPoses=[],VU=0,Vn=VY.length;VU<Vn;VU+=16){var VW=new Vna(VY[VU+0],VY[VU+1],VY[VU+2],VY[VU+3],VY[VU+4],VY[VU+5],VY[VU+6],VY[VU+7],VY[VU+8],VY[VU+9],VY[VU+10],VY[VU+11],VY[VU+12],VY[VU+13],VY[VU+14],VY[VU+15]);Vk._mesh._inverseBindPoses.push(VW)}return Vk._mesh._skinnedDatas=new Float32Array(16*VY.length),!0},Vk.READ_SUBMESH=function(){var Vn=Vk._readData.__getBuffer(),Va=new VRa(Vk._mesh),VU=Vk._readData.getInt16(),Vx=Vk._readData.getUint32(),VD=Vk._readData.getUint32();Va._vertexBuffer=Vk._mesh._vertexBuffers[VU],Va._vertexStart=Vx,Va._vertexCount=VD;var Vp=Vk._readData.getUint32(),VQ=Vk._readData.getUint32(),VV=Vk._mesh._indexBuffer;Va._indexBuffer=VV,Va._indexStart=Vp,Va._indexCount=VQ,Va._indices=new Uint16Array(VV.getData().buffer,2*Vp,VQ);var Vy=Vk._DATA.offset,VR=Va._subIndexBufferStart,VX=Va._subIndexBufferCount,Vz=Va._boneIndicesList,Vi=Vk._readData.getUint16();VR.length=Vi,VX.length=Vi,Vz.length=Vi;for(var Vq=0;Vq<Vi;Vq++){VR[Vq]=Vk._readData.getUint32(),VX[Vq]=Vk._readData.getUint32();var VE=Vk._readData.getUint32(),Vm=Vk._readData.getUint32();Va._boneIndicesList[Vq]=new Uint8Array(Vn.slice(Vy+VE,Vy+VE+Vm))}return Vk._subMeshes.push(Va),!0},Vk._getVertexDeclaration=function(Vn){for(var Va,VU=!1,Vx=!1,VD=!1,Vp=!1,VQ=!1,VV=!1,Vy=!1,VR=!1,VX=!1,Vz=0;Vz<Vn.length;Vz++)switch(Vn[Vz]){case"POSITION":VU=!0;break;case"NORMAL":Vx=!0;break;case"COLOR":VD=!0;break;case"UV":Vp=!0;break;case"UV1":VQ=!0;break;case"BLENDWEIGHT":Vy=!0;break;case"BLENDINDICES":VR=!0;break;case"TANGENT":VV=!0;break;case"BINORMAL":VX=!0}return VU&&Vx&&VD&&Vp&&VQ&&Vy&&VR&&VV?Va=VTn.vertexDeclaration:VU&&Vx&&VD&&Vp&&VQ&&Vy&&VR?Va=VPn.vertexDeclaration:VU&&Vx&&Vp&&VQ&&Vy&&VR&&VV?Va=VIn.vertexDeclaration:VU&&Vx&&Vp&&VQ&&Vy&&VR?Va=VHn.vertexDeclaration:VU&&Vx&&VD&&Vp&&Vy&&VR&&VV?Va=VNn.vertexDeclaration:VU&&Vx&&VD&&Vp&&Vy&&VR?Va=VWn.vertexDeclaration:VU&&Vx&&Vp&&Vy&&VR&&VV?Va=Vfn.vertexDeclaration:VU&&Vx&&Vp&&Vy&&VR?Va=Vjn.vertexDeclaration:VU&&Vx&&VD&&Vy&&VR&&VV?Va=Vin.vertexDeclaration:VU&&Vx&&VD&&Vy&&VR?Va=VXn.vertexDeclaration:VU&&Vx&&VD&&Vp&&VQ&&VV?Va=VYn.vertexDeclaration:VU&&Vx&&VD&&Vp&&VQ?Va=Vbn.vertexDeclaration:VU&&Vx&&Vp&&VQ&&VV?Va=Vln.vertexDeclaration:VU&&Vx&&Vp&&VQ?Va=Vcn.vertexDeclaration:VU&&Vx&&VD&&Vp&&VV?Va=V$n.vertexDeclaration:VU&&Vx&&Vp&&VV&&VX?Va=Von.vertexDeclaration:VU&&Vx&&VD&&Vp?Va=Vmn.vertexDeclaration:VU&&Vx&&Vp&&VV?Va=Vgn.vertexDeclaration:VU&&Vx&&Vp?Va=Vun.vertexDeclaration:VU&&Vx&&VD&&VV?Va=VEn.vertexDeclaration:VU&&Vx&&VD&&(Va=VRn.vertexDeclaration),Va},Vk._attrReg=new RegExp("(\\w+)|([:,;])","g"),Vk._strings=[],Vk._readData=null,Vk._version=null,Vk._mesh=null,Vk._materials=null,Vk._subMeshes=null,Vk._materialMap=null,Vz(Vk,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Vk}(),Vwn=function(){function VW(){}return Vq(VW,"laya.d3.loaders.LoadModelV03"),VW.parse=function(Vn,Va,VU,Vx,VD){VW._mesh=VU,VW._subMeshes=Vx,VW._materialMap=VD,VW._version=Va,VW._readData=Vn,VW.READ_DATA(),VW.READ_BLOCK(),VW.READ_STRINGS();for(var Vp=0,VQ=VW._BLOCK.count;Vp<VQ;Vp++){VW._readData.pos=VW._BLOCK.blockStarts[Vp];var VV=VW._readData.getUint16(),Vy=VW._strings[VV],VR=VW["READ_"+Vy];if(null==VR)throw new Error("model file err,no this function:"+VV+" "+Vy);VR.call()}VW._strings.length=0,VW._readData=null,VW._version=null,VW._mesh=null,VW._subMeshes=null,VW._materialMap=null},VW._readString=function(){return VW._strings[VW._readData.getUint16()]},VW.READ_DATA=function(){VW._DATA.offset=VW._readData.getUint32(),VW._DATA.size=VW._readData.getUint32()},VW.READ_BLOCK=function(){for(var Vn=VW._BLOCK.count=VW._readData.getUint16(),Va=VW._BLOCK.blockStarts=[],VU=VW._BLOCK.blockLengths=[],Vx=0;Vx<Vn;Vx++)Va.push(VW._readData.getUint32()),VU.push(VW._readData.getUint32())},VW.READ_STRINGS=function(){var Vn=VW._readData.getUint32(),Va=VW._readData.getUint16(),VU=VW._readData.pos;VW._readData.pos=Vn+VW._DATA.offset;for(var Vx=0;Vx<Va;Vx++)VW._strings[Vx]=VW._readData.readUTFString();VW._readData.pos=VU},VW.READ_MESH=function(){var Vn,Va=VW._readString(),VU=VW._readData.__getBuffer(),Vx=0,VD=VW._readData.getInt16(),Vp=VW._DATA.offset;for(Vx=0;Vx<VD;Vx++){var VQ,VV=Vp+VW._readData.getUint32(),Vy=VW._readData.getUint32(),VR=new Float32Array(VU.slice(VV,VV+Vy)),VX=VW._readString();switch(VW._version){case"LAYAMODEL:03":VQ=VW._vertexDeclarationMap_Discard[VX];break;case"LAYAMODEL:0301":VQ=VW._vertexDeclarationMap[VX];break;default:throw new Error("LoadModelV03: unknown version.")}if(!VQ)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+VW._version+"  bufferAttribute="+VX+"  name="+Va+"  url="+(VW._mesh?VW._mesh.url:"null"));var Vz=Vfa.create(VQ,4*VR.length/VQ.vertexStride,35044,!0,VW._mesh._url+"_"+Vx);Vz.setData(VR),VW._mesh._vertexBuffers.push(Vz)}var Vi=Vp+VW._readData.getUint32(),Vq=VW._readData.getUint32(),VE=new Uint16Array(VU.slice(Vi,Vi+Vq)),Vm=Vha.create("ushort",Vq/2,35044,!0,VW._mesh._url);Vm.setData(VE),VW._mesh._indexBuffer=Vm;var Vb=VW._mesh._boneNames=[],VP=VW._readData.getUint16();for(Vb.length=VP,Vx=0;Vx<VP;Vx++)Vb[Vx]=VW._strings[VW._readData.getUint16()];VW._readData.pos+=8;var VA=VW._readData.getUint32(),VT=VW._readData.getUint32(),VK=new Float32Array(VU.slice(Vp+VA,Vp+VA+VT));for(VW._mesh._inverseBindPoses=[],Vx=0,Vn=VK.length;Vx<Vn;Vx+=16){var VY=new Vna(VK[Vx+0],VK[Vx+1],VK[Vx+2],VK[Vx+3],VK[Vx+4],VK[Vx+5],VK[Vx+6],VK[Vx+7],VK[Vx+8],VK[Vx+9],VK[Vx+10],VK[Vx+11],VK[Vx+12],VK[Vx+13],VK[Vx+14],VK[Vx+15]);VW._mesh._inverseBindPoses.push(VY)}return VW._mesh._skinnedDatas=new Float32Array(16*VK.length),!0},VW.READ_SUBMESH=function(){var Vn=VW._readData.__getBuffer(),Va=new VRa(VW._mesh),VU=VW._readData.getInt16(),Vx=VW._readData.getUint32(),VD=VW._readData.getUint32();Va._vertexBuffer=VW._mesh._vertexBuffers[VU],Va._vertexStart=Vx,Va._vertexCount=VD;var Vp=VW._readData.getUint32(),VQ=VW._readData.getUint32(),VV=VW._mesh._indexBuffer;Va._indexBuffer=VV,Va._indexStart=Vp,Va._indexCount=VQ,Va._indices=new Uint16Array(VV.getData().buffer,2*Vp,VQ);var Vy=VW._DATA.offset,VR=Va._subIndexBufferStart,VX=Va._subIndexBufferCount,Vz=Va._boneIndicesList,Vi=VW._readData.getUint16();VR.length=Vi,VX.length=Vi,Vz.length=Vi;for(var Vq=0;Vq<Vi;Vq++){VR[Vq]=VW._readData.getUint32(),VX[Vq]=VW._readData.getUint32();var VE=VW._readData.getUint32(),Vm=VW._readData.getUint32();Vz[Vq]=new Uint8Array(Vn.slice(Vy+VE,Vy+VE+Vm))}return VW._subMeshes.push(Va),!0},VW._strings=[],VW._readData=null,VW._version=null,VW._mesh=null,VW._subMeshes=null,VW._materialMap=null,Vz(VW,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":VTn.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":VPn.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":VBn.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":VIn.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":VHn.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":VNn.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":VWn.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":Vfn.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":Vjn.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Vin.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":VXn.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":VYn.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Vbn.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":Vln.vertexDeclaration,"POSITION,NORMAL,UV,UV1":Vcn.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":V$n.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":Von.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Vmn.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":Vgn.vertexDeclaration,"POSITION,NORMAL,UV":Vun.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":VEn.vertexDeclaration,"POSITION,NORMAL,COLOR":VRn.vertexDeclaration,"POSITION,NORMAL,TANGENT":VZn.vertexDeclaration,"POSITION,NORMAL":Vyn.vertexDeclaration,"POSITION,UV":VLn.vertexDeclaration,POSITION:VVn.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":VAn.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":VPn.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":VBn.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":VGn.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":VHn.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":Vkn.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":VWn.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":Vhn.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":Vjn.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Vzn.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":VXn.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":VKn.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Vbn.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":Vvn.vertexDeclaration,"POSITION,NORMAL,UV,UV1":Vcn.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":V_n.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":Von.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Vmn.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":VFn.vertexDeclaration,"POSITION,NORMAL,UV":Vun.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Vqn.vertexDeclaration,"POSITION,NORMAL,COLOR":VRn.vertexDeclaration,"POSITION,NORMAL,TANGENT":VMn.vertexDeclaration,"POSITION,NORMAL":Vyn.vertexDeclaration,"POSITION,UV":VLn.vertexDeclaration,POSITION:VVn.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),VW}(),Vsn=function(){function VV(){}return Vq(VV,"laya.d3.loaders.MeshReader"),VV.read=function(Vn,Va,VU,Vx,VD){var Vp=new VW(Vn);Vp.pos=0;var VQ=Vp.readUTFString();switch(VQ){case"LAYAMODEL:01":case"LAYASKINANI:01":VV._readVersion01(Vp,VQ,Va,VU,Vx,VD);break;case"LAYAMODEL:02":VSn.parse(Vp,VQ,Va,VU,Vx,VD);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":Vwn.parse(Vp,VQ,Va,Vx,VD);break;default:throw new Error("MeshReader: unknown mesh version.")}Va._setSubMeshes(Vx)},VV._readVersion01=function(Vn,Va,VU,Vx,VD,Vp){new Vdn(Vn,Va,VU,Vx,VD,Vp)},VV}(),VCn=function(){function Vn(Vn,Va){this.min=null,this.max=null,this.min=Vn,this.max=Va}Vq(Vn,"laya.d3.math.BoundBox");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.core.IClone":!0}),Va.getCorners=function(Vn){Vn.length=8;var Va=this.min.elements,VU=this.max.elements,Vx=Va[0],VD=Va[1],Vp=Va[2],VQ=VU[0],VV=VU[1],Vy=VU[2];Vn[0]=new VQa(Vx,VV,Vy),Vn[1]=new VQa(VQ,VV,Vy),Vn[2]=new VQa(VQ,VD,Vy),Vn[3]=new VQa(Vx,VD,Vy),Vn[4]=new VQa(Vx,VV,Vp),Vn[5]=new VQa(VQ,VV,Vp),Vn[6]=new VQa(VQ,VD,Vp),Vn[7]=new VQa(Vx,VD,Vp)},Va.toDefault=function(){this.min.toDefault(),this.max.toDefault()},Va.cloneTo=function(Vn){var Va=Vn;this.min.cloneTo(Va.min),this.max.cloneTo(Va.max)},Va.clone=function(){var Vn=new this.constructor(new VQa,new VQa);return this.cloneTo(Vn),Vn},Vn.createfromPoints=function(Vn,Va){if(null==Vn)throw new Error("points");var VU=Va.min,Vx=Va.max,VD=VU.elements;VD[0]=Number.MAX_VALUE,VD[1]=Number.MAX_VALUE,VD[2]=Number.MAX_VALUE;var Vp=Vx.elements;Vp[0]=-Number.MAX_VALUE,Vp[1]=-Number.MAX_VALUE,Vp[2]=-Number.MAX_VALUE;for(var VQ=0,VV=Vn.length;VQ<VV;++VQ)VQa.min(VU,Vn[VQ],VU),VQa.max(Vx,Vn[VQ],Vx)},Vn.merge=function(Vn,Va,VU){VQa.min(Vn.min,Va.min,VU.min),VQa.max(Vn.max,Va.max,VU.max)},Vn}(),Vtn=function(){function VR(Vn){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=Vn,this._near=new Vaa(new VQa),this._far=new Vaa(new VQa),this._left=new Vaa(new VQa),this._right=new Vaa(new VQa),this._top=new Vaa(new VQa),this._bottom=new Vaa(new VQa),VR._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}Vq(VR,"laya.d3.math.BoundFrustum");var Vn=VR.prototype;return Vn.equalsBoundFrustum=function(Vn){return this._matrix.equalsOtherMatrix(Vn.matrix)},Vn.equalsObj=function(Vn){if(Vn instanceof laya.d3.math.BoundFrustum){var Va=Vn;return this.equalsBoundFrustum(Va)}return!1},Vn.getPlane=function(Vn){switch(Vn){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},Vn.getCorners=function(Vn){VR._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(Vn[0]),VR._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(Vn[1]),VR._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(Vn[2]),VR._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(Vn[3]),VR._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(Vn[4]),VR._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(Vn[5]),VR._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(Vn[6]),VR._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(Vn[7])},Vn.containsPoint=function(Vn){for(var Va=Vaa.PlaneIntersectionType_Front,VU=Vaa.PlaneIntersectionType_Front,Vx=0;Vx<6;Vx++){switch(Vx){case 0:VU=Collision.intersectsPlaneAndPoint(this._near,Vn);break;case 1:VU=Collision.intersectsPlaneAndPoint(this._far,Vn);break;case 2:VU=Collision.intersectsPlaneAndPoint(this._left,Vn);break;case 3:VU=Collision.intersectsPlaneAndPoint(this._right,Vn);break;case 4:VU=Collision.intersectsPlaneAndPoint(this._top,Vn);break;case 5:VU=Collision.intersectsPlaneAndPoint(this._bottom,Vn)}switch(VU){case Vaa.PlaneIntersectionType_Back:return 0;case Vaa.PlaneIntersectionType_Intersecting:Va=Vaa.PlaneIntersectionType_Intersecting}}switch(Va){case Vaa.PlaneIntersectionType_Intersecting:return 2;default:return 1}},Vn.containsBoundBox=function(Vn){for(var Va,VU=VR._tempV30,Vx=VR._tempV31,VD=1,Vp=0;Vp<6;Vp++){if(Va=this.getPlane(Vp),this._getBoxToPlanePVertexNVertex(Vn,Va.normal,VU,Vx),Collision.intersectsPlaneAndPoint(Va,VU)===Vaa.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(Va,Vx)===Vaa.PlaneIntersectionType_Back&&(VD=2)}return VD},Vn.containsBoundSphere=function(Vn){for(var Va=Vaa.PlaneIntersectionType_Front,VU=Vaa.PlaneIntersectionType_Front,Vx=0;Vx<6;Vx++){switch(Vx){case 0:VU=Collision.intersectsPlaneAndSphere(this._near,Vn);break;case 1:VU=Collision.intersectsPlaneAndSphere(this._far,Vn);break;case 2:VU=Collision.intersectsPlaneAndSphere(this._left,Vn);break;case 3:VU=Collision.intersectsPlaneAndSphere(this._right,Vn);break;case 4:VU=Collision.intersectsPlaneAndSphere(this._top,Vn);break;case 5:VU=Collision.intersectsPlaneAndSphere(this._bottom,Vn)}switch(VU){case Vaa.PlaneIntersectionType_Back:return 0;case Vaa.PlaneIntersectionType_Intersecting:Va=Vaa.PlaneIntersectionType_Intersecting}}switch(Va){case Vaa.PlaneIntersectionType_Intersecting:return 2;default:return 1}},Vn._getBoxToPlanePVertexNVertex=function(Vn,Va,VU,Vx){var VD=Vn.min,Vp=VD.elements,VQ=Vn.max,VV=VQ.elements,Vy=Va.elements,VR=Vy[0],VX=Vy[1],Vz=Vy[2];VD.cloneTo(VU);var Vi=VU.elements;0<=VR&&(Vi[0]=VV[0]),0<=VX&&(Vi[1]=VV[1]),0<=Vz&&(Vi[2]=VV[2]),VQ.cloneTo(Vx);var Vq=Vx.elements;0<=VR&&(Vq[0]=Vp[0]),0<=VX&&(Vq[1]=Vp[1]),0<=Vz&&(Vq[2]=Vp[2])},VE(0,Vn,"top",function(){return this._top}),VE(0,Vn,"matrix",function(){return this._matrix},function(Vn){this._matrix=Vn,VR._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),VE(0,Vn,"near",function(){return this._near}),VE(0,Vn,"far",function(){return this._far}),VE(0,Vn,"left",function(){return this._left}),VE(0,Vn,"right",function(){return this._right}),VE(0,Vn,"bottom",function(){return this._bottom}),VR._getPlanesFromMatrix=function(Vn,Va,VU,Vx,VD,Vp,VQ){var VV=Vn.elements,Vy=VV[0],VR=VV[1],VX=VV[2],Vz=VV[3],Vi=VV[4],Vq=VV[5],VE=VV[6],Vm=VV[7],Vb=VV[8],VP=VV[9],VA=VV[10],VT=VV[11],VK=VV[12],VY=VV[13],VW=VV[14],Vk=VV[15],VN=Va.normal.elements;VN[0]=Vz+VX,VN[1]=Vm+VE,VN[2]=VT+VA,Va.distance=Vk+VW,Va.normalize();var V_=VU.normal.elements;V_[0]=Vz-VX,V_[1]=Vm-VE,V_[2]=VT-VA,VU.distance=Vk-VW,VU.normalize();var V$=Vx.normal.elements;V$[0]=Vz+Vy,V$[1]=Vm+Vi,V$[2]=VT+Vb,Vx.distance=Vk+VK,Vx.normalize();var VM=VD.normal.elements;VM[0]=Vz-Vy,VM[1]=Vm-Vi,VM[2]=VT-Vb,VD.distance=Vk-VK,VD.normalize();var VZ=Vp.normal.elements;VZ[0]=Vz-VR,VZ[1]=Vm-Vq,VZ[2]=VT-VP,Vp.distance=Vk-VY,Vp.normalize();var Vu=VQ.normal.elements;Vu[0]=Vz+VR,Vu[1]=Vm+Vq,Vu[2]=VT+VP,VQ.distance=Vk+VY,VQ.normalize()},VR._get3PlaneInterPoint=function(Vn,Va,VU){var Vx=Vn.normal,VD=Va.normal,Vp=VU.normal;VQa.cross(VD,Vp,VR._tempV30),VQa.cross(Vp,Vx,VR._tempV31),VQa.cross(Vx,VD,VR._tempV32);var VQ=VQa.dot(Vx,VR._tempV30),VV=VQa.dot(VD,VR._tempV31),Vy=VQa.dot(Vp,VR._tempV32);return VQa.scale(VR._tempV30,-Vn.distance/VQ,VR._tempV33),VQa.scale(VR._tempV31,-Va.distance/VV,VR._tempV34),VQa.scale(VR._tempV32,-VU.distance/Vy,VR._tempV35),VQa.add(VR._tempV33,VR._tempV34,VR._tempV36),VQa.add(VR._tempV35,VR._tempV36,VR._tempV37),VR._tempV37},Vz(VR,["_tempV30",function(){return this._tempV30=new VQa},"_tempV31",function(){return this._tempV31=new VQa},"_tempV32",function(){return this._tempV32=new VQa},"_tempV33",function(){return this._tempV33=new VQa},"_tempV34",function(){return this._tempV34=new VQa},"_tempV35",function(){return this._tempV35=new VQa},"_tempV36",function(){return this._tempV36=new VQa},"_tempV37",function(){return this._tempV37=new VQa}]),VR}(),Vrn=function(){function VX(Vn,Va){this.center=null,this.radius=NaN,this.center=Vn,this.radius=Va}Vq(VX,"laya.d3.math.BoundSphere");var Vn=VX.prototype;return VY.imps(Vn,{"laya.d3.core.IClone":!0}),Vn.toDefault=function(){this.center.toDefault(),this.radius=0},Vn.intersectsRayDistance=function(Vn){return Collision.intersectsRayAndSphereRD(Vn,this)},Vn.intersectsRayPoint=function(Vn,Va){return Collision.intersectsRayAndSphereRP(Vn,this,Va)},Vn.cloneTo=function(Vn){var Va=Vn;this.center.cloneTo(Va.center),Va.radius=this.radius},Vn.clone=function(){var Vn=new this.constructor(new VQa,new VQa);return this.cloneTo(Vn),Vn},VX.createFromSubPoints=function(Vn,Va,VU,Vx){if(null==Vn)throw new Error("points");if(Va<0||Va>=Vn.length)throw new Error("start"+Va+"Must be in the range [0, "+(Vn.length-1)+"]");if(VU<0||Va+VU>Vn.length)throw new Error("count"+VU+"Must be in the range <= "+Vn.length+"}");var VD=Va+VU,Vp=VX._tempVector3;Vp.elements[0]=0,Vp.elements[1]=0,Vp.elements[2]=0;for(var VQ=Va;VQ<VD;++VQ)VQa.add(Vn[VQ],Vp,Vp);var VV=Vx.center;VQa.scale(Vp,1/VU,VV);var Vy=0;for(VQ=Va;VQ<VD;++VQ){var VR=VQa.distanceSquared(VV,Vn[VQ]);Vy<VR&&(Vy=VR)}Vx.radius=Math.sqrt(Vy)},VX.createfromPoints=function(Vn,Va){if(null==Vn)throw new Error("points");VX.createFromSubPoints(Vn,0,Vn.length,Va)},Vz(VX,["_tempVector3",function(){return this._tempVector3=new VQa}]),VX}(),VJn=(function(){function Vn(){}Vq(Vn,"laya.d3.math.ContainmentType"),Vn.Disjoint=0,Vn.Contains=1,Vn.Intersects=2}(),function(){function VU(){}return Vq(VU,"laya.d3.math.MathUtils3D"),VU.isZero=function(Vn){return Math.abs(Vn)<VU.zeroTolerance},VU.nearEqual=function(Vn,Va){return!!VU.isZero(Vn-Va)},VU.fastInvSqrt=function(Vn){return VU.isZero(Vn)?Vn:1/Math.sqrt(Vn)},Vz(VU,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),VU}()),Ven=function(){function Vy(){var Vn=this.elements=new Float32Array(9);Vn[0]=1,Vn[1]=0,Vn[2]=0,Vn[3]=0,Vn[4]=1,Vn[5]=0,Vn[6]=0,Vn[7]=0,Vn[8]=1}Vq(Vy,"laya.d3.math.Matrix3x3");var Vn=Vy.prototype;return VY.imps(Vn,{"laya.d3.core.IClone":!0}),Vn.determinant=function(){var Vn=this.elements,Va=Vn[0],VU=Vn[1],Vx=Vn[2],VD=Vn[3],Vp=Vn[4],VQ=Vn[5],VV=Vn[6],Vy=Vn[7],VR=Vn[8];return Va*(VR*Vp-VQ*Vy)+VU*(-VR*VD+VQ*VV)+Vx*(Vy*VD-Vp*VV)},Vn.translate=function(Vn,Va){var VU=Va.elements,Vx=this.elements,VD=Vn.elements,Vp=Vx[0],VQ=Vx[1],VV=Vx[2],Vy=Vx[3],VR=Vx[4],VX=Vx[5],Vz=Vx[6],Vi=Vx[7],Vq=Vx[8],VE=VD[0],Vm=VD[1];VU[0]=Vp,VU[1]=VQ,VU[2]=VV,VU[3]=Vy,VU[4]=VR,VU[5]=VX,VU[6]=VE*Vp+Vm*Vy+Vz,VU[7]=VE*VQ+Vm*VR+Vi,VU[8]=VE*VV+Vm*VX+Vq},Vn.rotate=function(Vn,Va){var VU=Va.elements,Vx=this.elements,VD=Vx[0],Vp=Vx[1],VQ=Vx[2],VV=Vx[3],Vy=Vx[4],VR=Vx[5],VX=Vx[6],Vz=Vx[7],Vi=Vx[8],Vq=Math.sin(Vn),VE=Math.cos(Vn);VU[0]=VE*VD+Vq*VV,VU[1]=VE*Vp+Vq*Vy,VU[2]=VE*VQ+Vq*VR,VU[3]=VE*VV-Vq*VD,VU[4]=VE*Vy-Vq*Vp,VU[5]=VE*VR-Vq*VQ,VU[6]=VX,VU[7]=Vz,VU[8]=Vi},Vn.scale=function(Vn,Va){var VU=Va.elements,Vx=this.elements,VD=Vn.elements,Vp=VD[0],VQ=VD[1];VU[0]=Vp*Vx[0],VU[1]=Vp*Vx[1],VU[2]=Vp*Vx[2],VU[3]=VQ*Vx[3],VU[4]=VQ*Vx[4],VU[5]=VQ*Vx[5],VU[6]=Vx[6],VU[7]=Vx[7],VU[8]=Vx[8]},Vn.invert=function(Vn){var Va=Vn.elements,VU=this.elements,Vx=VU[0],VD=VU[1],Vp=VU[2],VQ=VU[3],VV=VU[4],Vy=VU[5],VR=VU[6],VX=VU[7],Vz=VU[8],Vi=Vz*VV-Vy*VX,Vq=-Vz*VQ+Vy*VR,VE=VX*VQ-VV*VR,Vm=Vx*Vi+VD*Vq+Vp*VE;Vm||(Vn=null),Vm=1/Vm,Va[0]=Vi*Vm,Va[1]=(-Vz*VD+Vp*VX)*Vm,Va[2]=(Vy*VD-Vp*VV)*Vm,Va[3]=Vq*Vm,Va[4]=(Vz*Vx-Vp*VR)*Vm,Va[5]=(-Vy*Vx+Vp*VQ)*Vm,Va[6]=VE*Vm,Va[7]=(-VX*Vx+VD*VR)*Vm,Va[8]=(VV*Vx-VD*VQ)*Vm},Vn.transpose=function(Vn){var Va=Vn.elements,VU=this.elements;if(Vn===this){var Vx=VU[1],VD=VU[2],Vp=VU[5];Va[1]=VU[3],Va[2]=VU[6],Va[3]=Vx,Va[5]=VU[7],Va[6]=VD,Va[7]=Vp}else Va[0]=VU[0],Va[1]=VU[3],Va[2]=VU[6],Va[3]=VU[1],Va[4]=VU[4],Va[5]=VU[7],Va[6]=VU[2],Va[7]=VU[5],Va[8]=VU[8]},Vn.identity=function(){var Vn=this.elements;Vn[0]=1,Vn[1]=0,Vn[2]=0,Vn[3]=0,Vn[4]=1,Vn[5]=0,Vn[6]=0,Vn[7]=0,Vn[8]=1},Vn.cloneTo=function(Vn){var Va,VU,Vx;if((VU=this.elements)!==(Vx=Vn.elements))for(Va=0;Va<9;++Va)Vx[Va]=VU[Va]},Vn.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},Vy.createFromTranslation=function(Vn,Va){Va.elements;var VU=Vn.elements;Va[0]=1,Va[1]=0,Va[2]=0,Va[3]=0,Va[4]=1,Va[5]=0,Va[6]=VU[0],Va[7]=VU[1],Va[8]=1},Vy.createFromRotation=function(Vn,Va){var VU=Va.elements,Vx=Math.sin(Vn),VD=Math.cos(Vn);VU[0]=VD,VU[1]=Vx,VU[2]=0,VU[3]=-Vx,VU[4]=VD,VU[5]=0,VU[6]=0,VU[7]=0,VU[8]=1},Vy.createFromScaling=function(Vn,Va){var VU=Va.elements,Vx=Vn.elements;VU[0]=Vx[0],VU[1]=0,VU[2]=0,VU[3]=0,VU[4]=Vx[1],VU[5]=0,VU[6]=0,VU[7]=0,VU[8]=1},Vy.createFromMatrix4x4=function(Vn,Va){Va[0]=Vn[0],Va[1]=Vn[1],Va[2]=Vn[2],Va[3]=Vn[4],Va[4]=Vn[5],Va[5]=Vn[6],Va[6]=Vn[8],Va[7]=Vn[9],Va[8]=Vn[10]},Vy.multiply=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements,VQ=VD[0],VV=VD[1],Vy=VD[2],VR=VD[3],VX=VD[4],Vz=VD[5],Vi=VD[6],Vq=VD[7],VE=VD[8],Vm=Vp[0],Vb=Vp[1],VP=Vp[2],VA=Vp[3],VT=Vp[4],VK=Vp[5],VY=Vp[6],VW=Vp[7],Vk=Vp[8];Vx[0]=Vm*VQ+Vb*VR+VP*Vi,Vx[1]=Vm*VV+Vb*VX+VP*Vq,Vx[2]=Vm*Vy+Vb*Vz+VP*VE,Vx[3]=VA*VQ+VT*VR+VK*Vi,Vx[4]=VA*VV+VT*VX+VK*Vq,Vx[5]=VA*Vy+VT*Vz+VK*VE,Vx[6]=VY*VQ+VW*VR+Vk*Vi,Vx[7]=VY*VV+VW*VX+Vk*Vq,Vx[8]=VY*Vy+VW*Vz+Vk*VE},Vy.lookAt=function(Vn,Va,VU,Vx){VQa.subtract(Vn,Va,Vy._tempV30),VQa.normalize(Vy._tempV30,Vy._tempV30),VQa.cross(VU,Vy._tempV30,Vy._tempV31),VQa.normalize(Vy._tempV31,Vy._tempV31),VQa.cross(Vy._tempV30,Vy._tempV31,Vy._tempV32);var VD=Vy._tempV30.elements,Vp=Vy._tempV31.elements,VQ=Vy._tempV32.elements,VV=Vx.elements;VV[0]=Vp[0],VV[3]=Vp[1],VV[6]=Vp[2],VV[1]=VQ[0],VV[4]=VQ[1],VV[7]=VQ[2],VV[2]=VD[0],VV[5]=VD[1],VV[8]=VD[2]},Vy.DEFAULT=new Vy,Vz(Vy,["_tempV30",function(){return this._tempV30=new VQa},"_tempV31",function(){return this._tempV31=new VQa},"_tempV32",function(){return this._tempV32=new VQa}]),Vy}(),Vna=function(){function V_(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vz,Vi,Vq,VE,Vm){void 0===Vn&&(Vn=1),void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=0),void 0===VD&&(VD=0),void 0===Vp&&(Vp=1),void 0===VQ&&(VQ=0),void 0===VV&&(VV=0),void 0===Vy&&(Vy=0),void 0===VR&&(VR=0),void 0===VX&&(VX=1),void 0===Vz&&(Vz=0),void 0===Vi&&(Vi=0),void 0===Vq&&(Vq=0),void 0===VE&&(VE=0),void 0===Vm&&(Vm=1);var Vb=this.elements=new Float32Array(16);Vb[0]=Vn,Vb[1]=Va,Vb[2]=VU,Vb[3]=Vx,Vb[4]=VD,Vb[5]=Vp,Vb[6]=VQ,Vb[7]=VV,Vb[8]=Vy,Vb[9]=VR,Vb[10]=VX,Vb[11]=Vz,Vb[12]=Vi,Vb[13]=Vq,Vb[14]=VE,Vb[15]=Vm}Vq(V_,"laya.d3.math.Matrix4x4");var Vn=V_.prototype;return VY.imps(Vn,{"laya.d3.core.IClone":!0}),Vn.getElementByRowColumn=function(Vn,Va){if(Vn<0||3<Vn)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(Va<0||3<Va)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*Vn+Va]},Vn.setElementByRowColumn=function(Vn,Va,VU){if(Vn<0||3<Vn)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(Va<0||3<Va)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*Vn+Va]=VU},Vn.equalsOtherMatrix=function(Vn){var Va=this.elements,VU=Vn.elements;return VJn.nearEqual(Va[0],VU[0])&&VJn.nearEqual(Va[1],VU[1])&&VJn.nearEqual(Va[2],VU[2])&&VJn.nearEqual(Va[3],VU[3])&&VJn.nearEqual(Va[4],VU[4])&&VJn.nearEqual(Va[5],VU[5])&&VJn.nearEqual(Va[6],VU[6])&&VJn.nearEqual(Va[7],VU[7])&&VJn.nearEqual(Va[8],VU[8])&&VJn.nearEqual(Va[9],VU[9])&&VJn.nearEqual(Va[10],VU[10])&&VJn.nearEqual(Va[11],VU[11])&&VJn.nearEqual(Va[12],VU[12])&&VJn.nearEqual(Va[13],VU[13])&&VJn.nearEqual(Va[14],VU[14])&&VJn.nearEqual(Va[15],VU[15])},Vn.decomposeTransRotScale=function(Vn,Va,VU){var Vx=V_._tempMatrix4x4;return this.decomposeTransRotMatScale(Vn,Vx,VU)?(VUa.createFromMatrix4x4(Vx,Va),!0):(Va.identity(),!1)},Vn.decomposeTransRotMatScale=function(Vn,Va,VU){var Vx=this.elements,VD=Vn.elements,Vp=Va.elements,VQ=VU.elements;VD[0]=Vx[12],VD[1]=Vx[13],VD[2]=Vx[14];var VV=Vx[0],Vy=Vx[1],VR=Vx[2],VX=Vx[4],Vz=Vx[5],Vi=Vx[6],Vq=Vx[8],VE=Vx[9],Vm=Vx[10],Vb=VQ[0]=Math.sqrt(VV*VV+Vy*Vy+VR*VR),VP=VQ[1]=Math.sqrt(VX*VX+Vz*Vz+Vi*Vi),VA=VQ[2]=Math.sqrt(Vq*Vq+VE*VE+Vm*Vm);if(VJn.isZero(Vb)||VJn.isZero(VP)||VJn.isZero(VA))return Vp[1]=Vp[2]=Vp[3]=Vp[4]=Vp[6]=Vp[7]=Vp[8]=Vp[9]=Vp[11]=Vp[12]=Vp[13]=Vp[14]=0,Vp[0]=Vp[5]=Vp[10]=Vp[15]=1,!1;var VT=V_._tempVector0,VK=VT.elements;VK[0]=Vq/VA,VK[1]=VE/VA,VK[2]=Vm/VA;var VY=V_._tempVector1,VW=VY.elements;VW[0]=VV/Vb,VW[1]=Vy/Vb,VW[2]=VR/Vb;var Vk=V_._tempVector2;VQa.cross(VT,VY,Vk);var VN=V_._tempVector1;return VQa.cross(Vk,VT,VN),Vp[3]=Vp[7]=Vp[11]=Vp[12]=Vp[13]=Vp[14]=0,Vp[15]=1,Vp[0]=VN.x,Vp[1]=VN.y,Vp[2]=VN.z,Vp[4]=Vk.x,Vp[5]=Vk.y,Vp[6]=Vk.z,Vp[8]=VT.x,Vp[9]=VT.y,Vp[10]=VT.z,Vp[0]*VV+Vp[1]*Vy+Vp[2]*VR<0&&(VQ[0]=-Vb),Vp[4]*VX+Vp[5]*Vz+Vp[6]*Vi<0&&(VQ[1]=-VP),Vp[8]*Vq+Vp[9]*VE+Vp[10]*Vm<0&&(VQ[2]=-VA),!0},Vn.decomposeYawPitchRoll=function(Vn){var Va=Vn.elements,VU=Math.asin(-this.elements[9]);Va[1]=VU,Math.cos(VU)>VJn.zeroTolerance?(Va[2]=Math.atan2(this.elements[1],this.elements[5]),Va[0]=Math.atan2(this.elements[8],this.elements[10])):(Va[2]=Math.atan2(-this.elements[4],this.elements[0]),Va[0]=0)},Vn.normalize=function(){var Vn=this.elements,Va=Vn[0],VU=Vn[1],Vx=Vn[2],VD=Math.sqrt(Va*Va+VU*VU+Vx*Vx);if(!VD)return Vn[0]=0,Vn[1]=0,void(Vn[2]=0);1!=VD&&(VD=1/VD,Vn[0]=Va*VD,Vn[1]=VU*VD,Vn[2]=Vx*VD)},Vn.transpose=function(){var Vn,Va;return Va=(Vn=this.elements)[1],Vn[1]=Vn[4],Vn[4]=Va,Va=Vn[2],Vn[2]=Vn[8],Vn[8]=Va,Va=Vn[3],Vn[3]=Vn[12],Vn[12]=Va,Va=Vn[6],Vn[6]=Vn[9],Vn[9]=Va,Va=Vn[7],Vn[7]=Vn[13],Vn[13]=Va,Va=Vn[11],Vn[11]=Vn[14],Vn[14]=Va,this},Vn.invert=function(Vn){var Va=this.elements,VU=Vn.elements,Vx=Va[0],VD=Va[1],Vp=Va[2],VQ=Va[3],VV=Va[4],Vy=Va[5],VR=Va[6],VX=Va[7],Vz=Va[8],Vi=Va[9],Vq=Va[10],VE=Va[11],Vm=Va[12],Vb=Va[13],VP=Va[14],VA=Va[15],VT=Vx*Vy-VD*VV,VK=Vx*VR-Vp*VV,VY=Vx*VX-VQ*VV,VW=VD*VR-Vp*Vy,Vk=VD*VX-VQ*Vy,VN=Vp*VX-VQ*VR,V_=Vz*Vb-Vi*Vm,V$=Vz*VP-Vq*Vm,VM=Vz*VA-VE*Vm,VZ=Vi*VP-Vq*Vb,Vu=Vi*VA-VE*Vb,Vc=Vq*VA-VE*VP,VH=VT*Vc-VK*Vu+VY*VZ+VW*VM-Vk*V$+VN*V_;0!==Math.abs(VH)&&(VH=1/VH,VU[0]=(Vy*Vc-VR*Vu+VX*VZ)*VH,VU[1]=(Vp*Vu-VD*Vc-VQ*VZ)*VH,VU[2]=(Vb*VN-VP*Vk+VA*VW)*VH,VU[3]=(Vq*Vk-Vi*VN-VE*VW)*VH,VU[4]=(VR*VM-VV*Vc-VX*V$)*VH,VU[5]=(Vx*Vc-Vp*VM+VQ*V$)*VH,VU[6]=(VP*VY-Vm*VN-VA*VK)*VH,VU[7]=(Vz*VN-Vq*VY+VE*VK)*VH,VU[8]=(VV*Vu-Vy*VM+VX*V_)*VH,VU[9]=(VD*VM-Vx*Vu-VQ*V_)*VH,VU[10]=(Vm*Vk-Vb*VY+VA*VT)*VH,VU[11]=(Vi*VY-Vz*Vk-VE*VT)*VH,VU[12]=(Vy*V$-VV*VZ-VR*V_)*VH,VU[13]=(Vx*VZ-VD*V$+Vp*V_)*VH,VU[14]=(Vb*VK-Vm*VW-VP*VT)*VH,VU[15]=(Vz*VW-Vi*VK+Vq*VT)*VH)},Vn.identity=function(){var Vn=this.elements;Vn[1]=Vn[2]=Vn[3]=Vn[4]=Vn[6]=Vn[7]=Vn[8]=Vn[9]=Vn[11]=Vn[12]=Vn[13]=Vn[14]=0,Vn[0]=Vn[5]=Vn[10]=Vn[15]=1},Vn.cloneTo=function(Vn){var Va,VU,Vx;if((VU=this.elements)!==(Vx=Vn.elements))for(Va=0;Va<16;++Va)Vx[Va]=VU[Va]},Vn.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},Vn.getTranslationVector=function(Vn){var Va=this.elements,VU=Vn.elements;VU[0]=Va[12],VU[1]=Va[13],VU[2]=Va[14]},Vn.setTranslationVector=function(Vn){var Va=this.elements,VU=Vn.elements;Va[12]=VU[0],Va[13]=VU[1],Va[14]=VU[2]},Vn.getForward=function(Vn){var Va=this.elements,VU=Vn.elements;VU[0]=-Va[8],VU[1]=-Va[9],VU[2]=-Va[10]},Vn.setForward=function(Vn){var Va=this.elements,VU=Vn.elements;Va[8]=-VU[0],Va[9]=-VU[1],Va[10]=-VU[2]},V_.createRotationX=function(Vn,Va){var VU=Va.elements,Vx=Math.sin(Vn),VD=Math.cos(Vn);VU[1]=VU[2]=VU[3]=VU[4]=VU[7]=VU[8]=VU[11]=VU[12]=VU[13]=VU[14]=0,VU[0]=VU[15]=1,VU[5]=VU[10]=VD,VU[6]=Vx,VU[9]=-Vx},V_.createRotationY=function(Vn,Va){var VU=Va.elements,Vx=Math.sin(Vn),VD=Math.cos(Vn);VU[1]=VU[3]=VU[4]=VU[6]=VU[7]=VU[9]=VU[11]=VU[12]=VU[13]=VU[14]=0,VU[5]=VU[15]=1,VU[0]=VU[10]=VD,VU[2]=-Vx,VU[8]=Vx},V_.createRotationZ=function(Vn,Va){var VU=Va.elements,Vx=Math.sin(Vn),VD=Math.cos(Vn);VU[2]=VU[3]=VU[6]=VU[7]=VU[8]=VU[9]=VU[11]=VU[12]=VU[13]=VU[14]=0,VU[10]=VU[15]=1,VU[0]=VU[5]=VD,VU[1]=Vx,VU[4]=-Vx},V_.createRotationYawPitchRoll=function(Vn,Va,VU,Vx){VUa.createFromYawPitchRoll(Vn,Va,VU,V_._tempQuaternion),V_.createRotationQuaternion(V_._tempQuaternion,Vx)},V_.createRotationAxis=function(Vn,Va,VU){var Vx=Vn.elements,VD=Vx[0],Vp=Vx[1],VQ=Vx[2],VV=Math.cos(Va),Vy=Math.sin(Va),VR=VD*VD,VX=Vp*Vp,Vz=VQ*VQ,Vi=VD*Vp,Vq=VD*VQ,VE=Vp*VQ,Vm=VU.elements;Vm[3]=Vm[7]=Vm[11]=Vm[12]=Vm[13]=Vm[14]=0,Vm[15]=1,Vm[0]=VR+VV*(1-VR),Vm[1]=Vi-VV*Vi+Vy*VQ,Vm[2]=Vq-VV*Vq-Vy*Vp,Vm[4]=Vi-VV*Vi-Vy*VQ,Vm[5]=VX+VV*(1-VX),Vm[6]=VE-VV*VE+Vy*VD,Vm[8]=Vq-VV*Vq+Vy*Vp,Vm[9]=VE-VV*VE-Vy*VD,Vm[10]=Vz+VV*(1-Vz)},V_.createRotationQuaternion=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements,VD=VU[0],Vp=VU[1],VQ=VU[2],VV=VU[3],Vy=VD*VD,VR=Vp*Vp,VX=VQ*VQ,Vz=VD*Vp,Vi=VQ*VV,Vq=VQ*VD,VE=Vp*VV,Vm=Vp*VQ,Vb=VD*VV;Vx[3]=Vx[7]=Vx[11]=Vx[12]=Vx[13]=Vx[14]=0,Vx[15]=1,Vx[0]=1-2*(VR+VX),Vx[1]=2*(Vz+Vi),Vx[2]=2*(Vq-VE),Vx[4]=2*(Vz-Vi),Vx[5]=1-2*(VX+Vy),Vx[6]=2*(Vm+Vb),Vx[8]=2*(Vq+VE),Vx[9]=2*(Vm-Vb),Vx[10]=1-2*(VR+Vy)},V_.createTranslate=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements;Vx[4]=Vx[8]=Vx[1]=Vx[9]=Vx[2]=Vx[6]=Vx[3]=Vx[7]=Vx[11]=0,Vx[0]=Vx[5]=Vx[10]=Vx[15]=1,Vx[12]=VU[0],Vx[13]=VU[1],Vx[14]=VU[2]},V_.createScaling=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements;Vx[0]=VU[0],Vx[5]=VU[1],Vx[10]=VU[2],Vx[1]=Vx[4]=Vx[8]=Vx[12]=Vx[9]=Vx[13]=Vx[2]=Vx[6]=Vx[14]=Vx[3]=Vx[7]=Vx[11]=0,Vx[15]=1},V_.multiply=function(Vn,Va,VU){var Vx,VD,Vp,VQ,VV,Vy,VR,VX;for(VD=VU.elements,Vp=Vn.elements,VD===(VQ=Va.elements)&&(VQ=VQ.slice()),Vx=0;Vx<4;Vx++)VV=Vp[Vx],Vy=Vp[Vx+4],VR=Vp[Vx+8],VX=Vp[Vx+12],VD[Vx]=VV*VQ[0]+Vy*VQ[1]+VR*VQ[2]+VX*VQ[3],VD[Vx+4]=VV*VQ[4]+Vy*VQ[5]+VR*VQ[6]+VX*VQ[7],VD[Vx+8]=VV*VQ[8]+Vy*VQ[9]+VR*VQ[10]+VX*VQ[11],VD[Vx+12]=VV*VQ[12]+Vy*VQ[13]+VR*VQ[14]+VX*VQ[15]},V_.createFromQuaternion=function(Vn,Va){var VU=Va.elements,Vx=Vn.elements,VD=Vx[0],Vp=Vx[1],VQ=Vx[2],VV=Vx[3],Vy=VD+VD,VR=Vp+Vp,VX=VQ+VQ,Vz=VD*Vy,Vi=Vp*Vy,Vq=Vp*VR,VE=VQ*Vy,Vm=VQ*VR,Vb=VQ*VX,VP=VV*Vy,VA=VV*VR,VT=VV*VX;VU[0]=1-Vq-Vb,VU[1]=Vi+VT,VU[2]=VE-VA,VU[3]=0,VU[4]=Vi-VT,VU[5]=1-Vz-Vb,VU[6]=Vm+VP,VU[7]=0,VU[8]=VE+VA,VU[9]=Vm-VP,VU[10]=1-Vz-Vq,VU[11]=0,VU[12]=0,VU[13]=0,VU[14]=0,VU[15]=1},V_.createAffineTransformation=function(Vn,Va,VU,Vx){var VD=Vn.elements,Vp=Va.elements,VQ=VU.elements,VV=Vx.elements,Vy=Vp[0],VR=Vp[1],VX=Vp[2],Vz=Vp[3],Vi=Vy+Vy,Vq=VR+VR,VE=VX+VX,Vm=Vy*Vi,Vb=Vy*Vq,VP=Vy*VE,VA=VR*Vq,VT=VR*VE,VK=VX*VE,VY=Vz*Vi,VW=Vz*Vq,Vk=Vz*VE,VN=VQ[0],V_=VQ[1],V$=VQ[2];VV[0]=(1-(VA+VK))*VN,VV[1]=(Vb+Vk)*VN,VV[2]=(VP-VW)*VN,VV[3]=0,VV[4]=(Vb-Vk)*V_,VV[5]=(1-(Vm+VK))*V_,VV[6]=(VT+VY)*V_,VV[7]=0,VV[8]=(VP+VW)*V$,VV[9]=(VT-VY)*V$,VV[10]=(1-(Vm+VA))*V$,VV[11]=0,VV[12]=VD[0],VV[13]=VD[1],VV[14]=VD[2],VV[15]=1},V_.createLookAt=function(Vn,Va,VU,Vx){var VD=Vx.elements,Vp=V_._tempVector0,VQ=V_._tempVector1,VV=V_._tempVector2;VQa.subtract(Vn,Va,VV),VQa.normalize(VV,VV),VQa.cross(VU,VV,Vp),VQa.normalize(Vp,Vp),VQa.cross(VV,Vp,VQ),Vx.identity(),VD[0]=Vp.x,VD[4]=Vp.y,VD[8]=Vp.z,VD[1]=VQ.x,VD[5]=VQ.y,VD[9]=VQ.z,VD[2]=VV.x,VD[6]=VV.y,VD[10]=VV.z,VD[12]=-VQa.dot(Vp,Vn),VD[13]=-VQa.dot(VQ,Vn),VD[14]=-VQa.dot(VV,Vn)},V_.createPerspective=function(Vn,Va,VU,Vx,VD){var Vp=VD.elements,VQ=1/Math.tan(Vn/2),VV=1/(VU-Vx);Vp[0]=VQ/Va,Vp[5]=VQ,Vp[10]=(Vx+VU)*VV,Vp[11]=-1,Vp[14]=2*Vx*VU*VV,Vp[1]=Vp[2]=Vp[3]=Vp[4]=Vp[6]=Vp[7]=Vp[8]=Vp[9]=Vp[12]=Vp[13]=Vp[15]=0},V_.createOrthoOffCenterRH=function(Vn,Va,VU,Vx,VD,Vp,VQ){var VV=VQ.elements,Vy=1/(Vn-Va),VR=1/(VU-Vx),VX=1/(VD-Vp);VV[1]=VV[2]=VV[3]=VV[4]=VV[6]=VV[7]=VV[8]=VV[9]=VV[11]=0,VV[15]=1,VV[0]=-2*Vy,VV[5]=-2*VR,VV[10]=2*VX,VV[12]=(Vn+Va)*Vy,VV[13]=(Vx+VU)*VR,VV[14]=(Vp+VD)*VX},V_.translation=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements;Vx[0]=Vx[5]=Vx[10]=Vx[15]=1,Vx[12]=VU[0],Vx[13]=VU[1],Vx[14]=VU[2]},Vz(V_,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new V_},"_tempVector0",function(){return this._tempVector0=new VQa},"_tempVector1",function(){return this._tempVector1=new VQa},"_tempVector2",function(){return this._tempVector2=new VQa},"_tempQuaternion",function(){return this._tempQuaternion=new VUa},"DEFAULT",function(){return this.DEFAULT=new V_},"ZERO",function(){return this.ZERO=new V_(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),V_}(),Vaa=(function(){function VT(Vn,Va){this.extents=null,this.transformation=null,this.extents=Vn,this.transformation=Va}Vq(VT,"laya.d3.math.OrientedBoundBox");var Vn=VT.prototype;Vn.getCorners=function(Vn){var Va=VT._tempV30.elements,VU=VT._tempV31.elements,Vx=VT._tempV32.elements,VD=this.extents.elements;Va[0]=VD[0],Va[1]=Va[2]=0,VU[1]=VD[1],VU[0]=VU[2]=0,Vx[2]=VD[2],Vx[0]=Vx[1]=0,VQa.TransformNormal(VT._tempV30,this.transformation,VT._tempV30),VQa.TransformNormal(VT._tempV31,this.transformation,VT._tempV31),VQa.TransformNormal(VT._tempV32,this.transformation,VT._tempV32);var Vp=VT._tempV33;this.transformation.getTranslationVector(Vp),Vn.length=8,VQa.add(Vp,VT._tempV30,VT._tempV34),VQa.add(VT._tempV34,VT._tempV31,VT._tempV34),VQa.add(VT._tempV34,VT._tempV32,Vn[0]),VQa.add(Vp,VT._tempV30,VT._tempV34),VQa.add(VT._tempV34,VT._tempV31,VT._tempV34),VQa.subtract(VT._tempV34,VT._tempV32,Vn[1]),VQa.subtract(Vp,VT._tempV30,VT._tempV34),VQa.add(VT._tempV34,VT._tempV31,VT._tempV34),VQa.subtract(VT._tempV34,VT._tempV32,Vn[2]),VQa.subtract(Vp,VT._tempV30,VT._tempV34),VQa.add(VT._tempV34,VT._tempV31,VT._tempV34),VQa.add(VT._tempV34,VT._tempV32,Vn[3]),VQa.add(Vp,VT._tempV30,VT._tempV34),VQa.subtract(VT._tempV34,VT._tempV31,VT._tempV34),VQa.add(VT._tempV34,VT._tempV32,Vn[4]),VQa.add(Vp,VT._tempV30,VT._tempV34),VQa.subtract(VT._tempV34,VT._tempV31,VT._tempV34),VQa.subtract(VT._tempV34,VT._tempV32,Vn[5]),VQa.subtract(Vp,VT._tempV30,VT._tempV34),VQa.subtract(VT._tempV34,VT._tempV31,VT._tempV34),VQa.subtract(VT._tempV34,VT._tempV32,Vn[6]),VQa.subtract(Vp,VT._tempV30,VT._tempV34),VQa.subtract(VT._tempV34,VT._tempV31,VT._tempV34),VQa.add(VT._tempV34,VT._tempV32,Vn[7])},Vn.transform=function(Vn){Vna.multiply(this.transformation,Vn,this.transformation)},Vn.scale=function(Vn){VQa.multiply(this.extents,Vn,this.extents)},Vn.translate=function(Vn){this.transformation.getTranslationVector(VT._tempV30),VQa.add(VT._tempV30,Vn,VT._tempV31),this.transformation.setTranslationVector(VT._tempV31)},Vn.Size=function(Vn){VQa.scale(this.extents,2,Vn)},Vn.getSize=function(Vn){var Va=this.extents.elements;VT._tempV30.x=Va[0],VT._tempV31.y=Va[1],VT._tempV32.z=Va[2],VQa.TransformNormal(VT._tempV30,this.transformation,VT._tempV30),VQa.TransformNormal(VT._tempV31,this.transformation,VT._tempV31),VQa.TransformNormal(VT._tempV31,this.transformation,VT._tempV32);var VU=Vn.elements;VU[0]=VQa.scalarLength(VT._tempV30),VU[1]=VQa.scalarLength(VT._tempV31),VU[2]=VQa.scalarLength(VT._tempV32)},Vn.getSizeSquared=function(Vn){var Va=this.extents.elements;VT._tempV30.x=Va[0],VT._tempV31.y=Va[1],VT._tempV32.z=Va[2],VQa.TransformNormal(VT._tempV30,this.transformation,VT._tempV30),VQa.TransformNormal(VT._tempV31,this.transformation,VT._tempV31),VQa.TransformNormal(VT._tempV31,this.transformation,VT._tempV32);var VU=Vn.elements;VU[0]=VQa.scalarLengthSquared(VT._tempV30),VU[1]=VQa.scalarLengthSquared(VT._tempV31),VU[2]=VQa.scalarLengthSquared(VT._tempV32)},Vn.getCenter=function(Vn){this.transformation.getTranslationVector(Vn)},Vn.containsPoint=function(Vn){var Va=this.extents.elements,VU=Va[0],Vx=Va[1],VD=Va[2];this.transformation.invert(VT._tempM0),VQa.transformCoordinate(Vn,VT._tempM0,VT._tempV30);var Vp=VT._tempV30.elements,VQ=Math.abs(Vp[0]),VV=Math.abs(Vp[1]),Vy=Math.abs(Vp[2]);return VJn.nearEqual(VQ,VU)&&VJn.nearEqual(VV,Vx)&&VJn.nearEqual(Vy,VD)?2:VQ<VU&&VV<Vx&&Vy<VD?1:0},Vn.containsPoints=function(Vn){var Va=this.extents.elements,VU=Va[0],Vx=Va[1],VD=Va[2];this.transformation.invert(VT._tempM0);for(var Vp=!0,VQ=!1,VV=0;VV<Vn.length;VV++){VQa.transformCoordinate(Vn[VV],VT._tempM0,VT._tempV30);var Vy=VT._tempV30.elements,VR=Math.abs(Vy[0]),VX=Math.abs(Vy[1]),Vz=Math.abs(Vy[2]);VJn.nearEqual(VR,VU)&&VJn.nearEqual(VX,Vx)&&VJn.nearEqual(Vz,VD)&&(VQ=!0),VR<VU&&VX<Vx&&Vz<VD?VQ=!0:Vp=!1}return Vp?1:VQ?2:0},Vn.containsSphere=function(Vn,Va){void 0===Va&&(Va=!1);var VU=this.extents.elements,Vx=VU[0],VD=VU[1],Vp=VU[2],VQ=Vn.radius;this.transformation.invert(VT._tempM0),VQa.transformCoordinate(Vn.center,VT._tempM0,VT._tempV30);var VV=NaN;if(VV=Va?VQ:(VQa.scale(VQa.UnitX,VQ,VT._tempV31),VQa.TransformNormal(VT._tempV31,VT._tempM0,VT._tempV31),VQa.scalarLength(VT._tempV31)),VQa.scale(this.extents,-1,VT._tempV32),VQa.Clamp(VT._tempV30,VT._tempV32,this.extents,VT._tempV33),VV*VV<VQa.distanceSquared(VT._tempV30,VT._tempV33))return 0;var Vy=VT._tempV30.elements,VR=Vy[0],VX=Vy[1],Vz=Vy[2],Vi=VT._tempV32.elements,Vq=Vi[0],VE=Vi[1],Vm=Vi[2];return Vq+VV<=VR&&VR<=Vx-VV&&VV<Vx-Vq&&VE+VV<=VX&&VX<=VD-VV&&VV<VD-VE&&Vm+VV<=Vz&&Vz<=Vp-VV&&VV<Vp-Vm?1:2},Vn.containsOrientedBoundBox=function(Vn){var Va=0,VU=0;Vn.getCorners(VT._corners);var Vx=this.containsPoints(VT._corners);if(0!=Vx)return Vx;var VD=this.extents.elements;Vn.extents.cloneTo(VT._tempV35);var Vp=VT._tempV35.elements;VT._getRows(this.transformation,VT._rows1),VT._getRows(Vn.transformation,VT._rows2);var VQ=NaN;for(Va=0;Va<4;Va++)for(VU=0;VU<4;VU++)3==Va||3==VU?(VT._tempM0.setElementByRowColumn(Va,VU,0),VT._tempM1.setElementByRowColumn(Va,VU,0)):(VQ=VQa.dot(VT._rows1[Va],VT._rows2[VU]),VT._tempM0.setElementByRowColumn(Va,VU,VQ),VT._tempM1.setElementByRowColumn(Va,VU,Math.abs(VQ)));Vn.getCenter(VT._tempV34),this.getCenter(VT._tempV36),VQa.subtract(VT._tempV34,VT._tempV36,VT._tempV30);var VV=VT._tempV31.elements;VV[0]=VQa.dot(VT._tempV30,VT._rows1[0]),VV[1]=VQa.dot(VT._tempV30,VT._rows1[1]),VV[2]=VQa.dot(VT._tempV30,VT._rows1[2]);var Vy=VT._tempV32.elements,VR=VT._tempV33.elements;for(Va=0;Va<3;Va++)if(Vy[0]=VT._tempM1.getElementByRowColumn(Va,0),Vy[1]=VT._tempM1.getElementByRowColumn(Va,1),Vy[2]=VT._tempM1.getElementByRowColumn(Va,2),VD[Va]+VQa.dot(VT._tempV35,VT._tempV32)<Math.abs(VV[Va]))return 0;for(VU=0;VU<3;VU++)if(Vy[0]=VT._tempM1.getElementByRowColumn(0,VU),Vy[1]=VT._tempM1.getElementByRowColumn(1,VU),Vy[2]=VT._tempM1.getElementByRowColumn(2,VU),VR[0]=VT._tempM0.getElementByRowColumn(0,VU),VR[1]=VT._tempM0.getElementByRowColumn(1,VU),VR[2]=VT._tempM0.getElementByRowColumn(2,VU),VQa.dot(this.extents,VT._tempV32)+Vp[VU]<Math.abs(VQa.dot(VT._tempV31,VT._tempV33)))return 0;for(Va=0;Va<3;Va++)for(VU=0;VU<3;VU++){var VX=(Va+1)%3,Vz=(Va+2)%3,Vi=(VU+1)%3,Vq=(VU+2)%3;if(VD[VX]*VT._tempM1.getElementByRowColumn(Vz,VU)+VD[Vz]*VT._tempM1.getElementByRowColumn(VX,VU)+(Vp[Vi]*VT._tempM1.getElementByRowColumn(Va,Vq)+Vp[Vq]*VT._tempM1.getElementByRowColumn(Va,Vi))<Math.abs(VV[Vz]*VT._tempM0.getElementByRowColumn(VX,VU)-VV[VX]*VT._tempM0.getElementByRowColumn(Vz,VU)))return 0}return 2},Vn.containsLine=function(Vn,Va){VT._corners[0]=Vn,VT._corners[1]=Va;var VU=this.containsPoints(VT._corners);if(0!=VU)return VU;var Vx=this.extents.elements,VD=Vx[0],Vp=Vx[1],VQ=Vx[2];this.transformation.invert(VT._tempM0),VQa.transformCoordinate(Vn,VT._tempM0,VT._tempV30),VQa.transformCoordinate(Va,VT._tempM0,VT._tempV31),VQa.add(VT._tempV30,VT._tempV31,VT._tempV32),VQa.scale(VT._tempV32,.5,VT._tempV32),VQa.subtract(VT._tempV30,VT._tempV32,VT._tempV33);var VV=VT._tempV33.elements,Vy=VV[0],VR=VV[1],VX=VV[2],Vz=VT._tempV34.elements,Vi=Vz[0]=Math.abs(VV[0]),Vq=Vz[1]=Math.abs(VV[1]),VE=Vz[2]=Math.abs(VV[2]),Vm=VT._tempV32.elements,Vb=Vm[0],VP=Vm[1],VA=Vm[2];return Math.abs(Vb)>VD+Vi?0:Math.abs(VP)>Vp+Vq?0:Math.abs(VA)>VQ+VE?0:Math.abs(VP*VX-VA*VR)>Vp*VE+VQ*Vq?0:Math.abs(Vb*VX-VA*Vy)>VD*VE+VQ*Vi?0:Math.abs(Vb*VR-VP*Vy)>VD*Vq+Vp*Vi?0:2},Vn.containsBoundBox=function(Vn){var Va=0,VU=0,Vx=Vn.min,VD=Vn.max;Vn.getCorners(VT._corners);var Vp=this.containsPoints(VT._corners);if(0!=Vp)return Vp;VQa.subtract(VD,Vx,VT._tempV30),VQa.scale(VT._tempV30,.5,VT._tempV30),VQa.add(Vx,VT._tempV30,VT._tempV30),VQa.subtract(VD,VT._tempV30,VT._tempV31);var VQ=this.extents.elements,VV=VT._tempV31.elements;VT._getRows(this.transformation,VT._rows1),this.transformation.invert(VT._tempM0);for(Va=0;Va<3;Va++)for(VU=0;VU<3;VU++)VT._tempM1.setElementByRowColumn(Va,VU,Math.abs(VT._tempM0.getElementByRowColumn(Va,VU)));this.getCenter(VT._tempV35),VQa.subtract(VT._tempV30,VT._tempV35,VT._tempV32);var Vy=VT._tempV31.elements;Vy[0]=VQa.dot(VT._tempV32,VT._rows1[0]),Vy[1]=VQa.dot(VT._tempV32,VT._rows1[1]),Vy[2]=VQa.dot(VT._tempV32,VT._rows1[2]);var VR=VT._tempV33.elements,VX=VT._tempV34.elements;for(Va=0;Va<3;Va++)if(VR[0]=VT._tempM1.getElementByRowColumn(Va,0),VR[1]=VT._tempM1.getElementByRowColumn(Va,1),VR[2]=VT._tempM1.getElementByRowColumn(Va,2),VQ[Va]+VQa.dot(VT._tempV31,VT._tempV33)<Math.abs(Vy[Va]))return 0;for(VU=0;VU<3;VU++)if(VR[0]=VT._tempM1.getElementByRowColumn(0,VU),VR[1]=VT._tempM1.getElementByRowColumn(1,VU),VR[2]=VT._tempM1.getElementByRowColumn(2,VU),VX[0]=VT._tempM0.getElementByRowColumn(0,VU),VX[1]=VT._tempM0.getElementByRowColumn(1,VU),VX[2]=VT._tempM0.getElementByRowColumn(2,VU),VQa.dot(this.extents,VT._tempV33)+VV[VU]<Math.abs(VQa.dot(VT._tempV31,VT._tempV34)))return 0;for(Va=0;Va<3;Va++)for(VU=0;VU<3;VU++){var Vz=(Va+1)%3,Vi=(Va+2)%3,Vq=(VU+1)%3,VE=(VU+2)%3;if(VQ[Vz]*VT._tempM1.getElementByRowColumn(Vi,VU)+VQ[Vi]*VT._tempM1.getElementByRowColumn(Vz,VU)+(VV[Vq]*VT._tempM1.getElementByRowColumn(Va,VE)+VV[VE]*VT._tempM1.getElementByRowColumn(Va,Vq))<Math.abs(Vy[Vi]*VT._tempM0.getElementByRowColumn(Vz,VU)-Vy[Vz]*VT._tempM0.getElementByRowColumn(Vi,VU)))return 0}return 2},Vn.intersectsRay=function(Vn,Va){VQa.scale(this.extents,-1,VT._tempV30),this.transformation.invert(VT._tempM0),VQa.TransformNormal(Vn.direction,VT._tempM0,VT._ray.direction),VQa.transformCoordinate(Vn.origin,VT._tempM0,VT._ray.origin),VT._boxBound1.min=VT._tempV30,VT._boxBound1.max=this.extents;var VU=Collision.intersectsRayAndBoxRP(VT._ray,VT._boxBound1,Va);return-1!==VU&&VQa.transformCoordinate(Va,this.transformation,Va),VU},Vn._getLocalCorners=function(Vn){Vn.length=8;var Va=this.extents.elements;VT._tempV30.x=Va[0],VT._tempV31.y=Va[1],VT._tempV32.z=Va[2],VQa.add(VT._tempV30,VT._tempV31,VT._tempV33),VQa.add(VT._tempV33,VT._tempV32,Vn[0]),VQa.add(VT._tempV30,VT._tempV31,VT._tempV33),VQa.subtract(VT._tempV33,VT._tempV32,Vn[1]),VQa.subtract(VT._tempV31,VT._tempV30,VT._tempV33),VQa.subtract(VT._tempV33,VT._tempV30,Vn[2]),VQa.subtract(VT._tempV31,VT._tempV30,VT._tempV33),VQa.add(VT._tempV33,VT._tempV32,Vn[3]),VQa.subtract(VT._tempV30,VT._tempV31,VT._tempV33),VQa.add(VT._tempV33,VT._tempV32,Vn[4]),VQa.subtract(VT._tempV30,VT._tempV31,VT._tempV33),VQa.subtract(VT._tempV33,VT._tempV32,Vn[5]),VQa.scale(Vn[0],-1,Vn[6]),VQa.subtract(VT._tempV32,VT._tempV30,VT._tempV33),VQa.subtract(VT._tempV33,VT._tempV31,Vn[7])},Vn.equals=function(Vn){return this.extents==Vn.extents&&this.transformation==Vn.transformation},Vn.cloneTo=function(Vn){var Va=Vn;this.extents.cloneTo(Va.extents),this.transformation.cloneTo(Va.transformation)},VT.createByBoundBox=function(Vn,Va){var VU=Vn.min,Vx=Vn.max;VQa.subtract(Vx,VU,VT._tempV30),VQa.scale(VT._tempV30,.5,VT._tempV30),VQa.add(VU,VT._tempV30,VT._tempV31),VQa.subtract(Vx,VT._tempV31,VT._tempV32),Vna.translation(VT._tempV31,VT._tempM0);var VD=VT._tempV32.clone(),Vp=VT._tempM0.clone();Va.extents=VD,Va.transformation=Vp},VT.createByMinAndMaxVertex=function(Vn,Va){return VQa.subtract(Va,Vn,VT._tempV30),VQa.scale(VT._tempV30,.5,VT._tempV30),VQa.add(Vn,VT._tempV30,VT._tempV31),VQa.subtract(Va,VT._tempV31,VT._tempV32),Vna.translation(VT._tempV31,VT._tempM0),new VT(VT._tempV32,VT._tempM0)},VT._getRows=function(Vn,Va){Va.length=3;var VU=Vn.elements,Vx=Va[0].elements;Vx[0]=VU[0],Vx[1]=VU[1],Vx[2]=VU[2];var VD=Va[1].elements;VD[0]=VU[4],VD[1]=VU[5],VD[2]=VU[6];var Vp=Va[2].elements;Vp[0]=VU[8],Vp[1]=VU[9],Vp[2]=VU[10]},VT.getObbtoObbMatrix4x4=function(Vn,Va,VU,Vx){var VD=Vn.transformation,Vp=Va.transformation;if(VU){VT._getRows(VD,VT._rows1),VT._getRows(Vp,VT._rows2);for(var VQ=0;VQ<3;VQ++)for(var VV=0;VV<3;VV++)Vx.setElementByRowColumn(VQ,VV,VQa.dot(VT._rows2[VQ],VT._rows1[VV]));Va.getCenter(VT._tempV30),Vn.getCenter(VT._tempV31),VQa.subtract(VT._tempV30,VT._tempV31,VT._tempV32);var Vy=Vx.elements;Vy[12]=VQa.dot(VT._tempV32,VT._rows1[0]),Vy[13]=VQa.dot(VT._tempV32,VT._rows1[1]),Vy[14]=VQa.dot(VT._tempV32,VT._rows1[2]),Vy[15]=1}else VD.invert(VT._tempM0),Vna.multiply(Vp,VT._tempM0,Vx)},VT.merge=function(Vn,Va,VU){var Vx=Vn.extents,VD=Vn.transformation;VT.getObbtoObbMatrix4x4(Vn,Va,VU,VT._tempM0),Va._getLocalCorners(VT._corners),VQa.transformCoordinate(VT._corners[0],VT._tempM0,VT._corners[0]),VQa.transformCoordinate(VT._corners[1],VT._tempM0,VT._corners[1]),VQa.transformCoordinate(VT._corners[2],VT._tempM0,VT._corners[2]),VQa.transformCoordinate(VT._corners[3],VT._tempM0,VT._corners[3]),VQa.transformCoordinate(VT._corners[4],VT._tempM0,VT._corners[4]),VQa.transformCoordinate(VT._corners[5],VT._tempM0,VT._corners[5]),VQa.transformCoordinate(VT._corners[6],VT._tempM0,VT._corners[6]),VQa.transformCoordinate(VT._corners[7],VT._tempM0,VT._corners[7]),VQa.scale(Vx,-1,VT._boxBound1.min),Vx.cloneTo(VT._boxBound1.max),VCn.createfromPoints(VT._corners,VT._boxBound2),VCn.merge(VT._boxBound2,VT._boxBound1,VT._boxBound3);var Vp=VT._boxBound3.min,VQ=VT._boxBound3.max;VQa.subtract(VQ,Vp,VT._tempV30),VQa.scale(VT._tempV30,.5,VT._tempV30),VQa.add(Vp,VT._tempV30,VT._tempV32),VQa.subtract(VQ,VT._tempV32,Vx),VQa.transformCoordinate(VT._tempV32,VD,VT._tempV33)},Vz(VT,["_tempV30",function(){return this._tempV30=new VQa},"_tempV31",function(){return this._tempV31=new VQa},"_tempV32",function(){return this._tempV32=new VQa},"_tempV33",function(){return this._tempV33=new VQa},"_tempV34",function(){return this._tempV34=new VQa},"_tempV35",function(){return this._tempV35=new VQa},"_tempV36",function(){return this._tempV36=new VQa},"_tempM0",function(){return this._tempM0=new Vna},"_tempM1",function(){return this._tempM1=new Vna},"_corners",function(){return this._corners=[new VQa,new VQa,new VQa,new VQa,new VQa,new VQa,new VQa,new VQa]},"_rows1",function(){return this._rows1=[new VQa,new VQa,new VQa]},"_rows2",function(){return this._rows2=[new VQa,new VQa,new VQa]},"_ray",function(){return this._ray=new VDa(new VQa,new VQa)},"_boxBound1",function(){return this._boxBound1=new VCn(new VQa,new VQa)},"_boxBound2",function(){return this._boxBound2=new VCn(new VQa,new VQa)},"_boxBound3",function(){return this._boxBound3=new VCn(new VQa,new VQa)}])}(),function(){function VY(Vn,Va){this.normal=null,this.distance=NaN,void 0===Va&&(Va=0),this.normal=Vn,this.distance=Va}return Vq(VY,"laya.d3.math.Plane"),VY.prototype.normalize=function(){var Vn=this.normal.elements,Va=Vn[0],VU=Vn[1],Vx=Vn[2],VD=1/Math.sqrt(Va*Va+VU*VU+Vx*Vx);Vn[0]=Va*VD,Vn[1]=VU*VD,Vn[2]=Vx*VD,this.distance*=VD},VY.createPlaneBy3P=function(Vn,Va,VU){var Vx=Vn.elements,VD=Va.elements,Vp=VU.elements,VQ=VD[0]-Vx[0],VV=VD[1]-Vx[1],Vy=VD[2]-Vx[2],VR=Vp[0]-Vx[0],VX=Vp[1]-Vx[1],Vz=Vp[2]-Vx[2],Vi=VV*Vz-Vy*VX,Vq=Vy*VR-VQ*Vz,VE=VQ*VX-VV*VR,Vm=1/Math.sqrt(Vi*Vi+Vq*Vq+VE*VE),Vb=Vi*Vm,VP=Vq*Vm,VA=VE*Vm,VT=VY._TEMPVec3.elements;VT[0]=Vb,VT[1]=VP,VT[2]=VA;var VK=-(Vb*Vx[0]+VP*Vx[1]+VA*Vx[2]);return new VY(VY._TEMPVec3,VK)},VY.PlaneIntersectionType_Back=0,VY.PlaneIntersectionType_Front=1,VY.PlaneIntersectionType_Intersecting=2,Vz(VY,["_TEMPVec3",function(){return this._TEMPVec3=new VQa}]),VY}()),VUa=function(){function VD(Vn,Va,VU,Vx){this.elements=new Float32Array(4),void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=1),this.elements[0]=Vn,this.elements[1]=Va,this.elements[2]=VU,this.elements[3]=Vx}Vq(VD,"laya.d3.math.Quaternion");var Vn=VD.prototype;return VY.imps(Vn,{"laya.d3.core.IClone":!0}),Vn.scaling=function(Vn,Va){var VU=Va.elements,Vx=this.elements;VU[0]=Vx[0]*Vn,VU[1]=Vx[1]*Vn,VU[2]=Vx[2]*Vn,VU[3]=Vx[3]*Vn},Vn.normalize=function(Vn){var Va=Vn.elements,VU=this.elements,Vx=VU[0],VD=VU[1],Vp=VU[2],VQ=VU[3],VV=Vx*Vx+VD*VD+Vp*Vp+VQ*VQ;0<VV&&(VV=1/Math.sqrt(VV),Va[0]=Vx*VV,Va[1]=VD*VV,Va[2]=Vp*VV,Va[3]=VQ*VV)},Vn.length=function(){var Vn=this.elements,Va=Vn[0],VU=Vn[1],Vx=Vn[2],VD=Vn[3];return Math.sqrt(Va*Va+VU*VU+Vx*Vx+VD*VD)},Vn.rotateX=function(Vn,Va){var VU=Va.elements,Vx=this.elements;Vn*=.5;var VD=Vx[0],Vp=Vx[1],VQ=Vx[2],VV=Vx[3],Vy=Math.sin(Vn),VR=Math.cos(Vn);VU[0]=VD*VR+VV*Vy,VU[1]=Vp*VR+VQ*Vy,VU[2]=VQ*VR-Vp*Vy,VU[3]=VV*VR-VD*Vy},Vn.rotateY=function(Vn,Va){var VU=Va.elements,Vx=this.elements;Vn*=.5;var VD=Vx[0],Vp=Vx[1],VQ=Vx[2],VV=Vx[3],Vy=Math.sin(Vn),VR=Math.cos(Vn);VU[0]=VD*VR-VQ*Vy,VU[1]=Vp*VR+VV*Vy,VU[2]=VQ*VR+VD*Vy,VU[3]=VV*VR-Vp*Vy},Vn.rotateZ=function(Vn,Va){var VU=Va.elements,Vx=this.elements;Vn*=.5;var VD=Vx[0],Vp=Vx[1],VQ=Vx[2],VV=Vx[3],Vy=Math.sin(Vn),VR=Math.cos(Vn);VU[0]=VD*VR+Vp*Vy,VU[1]=Vp*VR-VD*Vy,VU[2]=VQ*VR+VV*Vy,VU[3]=VV*VR-VQ*Vy},Vn.getYawPitchRoll=function(Vn){VQa.transformQuat(VQa.ForwardRH,this,VD.TEMPVector31),VQa.transformQuat(VQa.Up,this,VD.TEMPVector32);var Va=VD.TEMPVector32.elements;VD.angleTo(VQa.ZERO,VD.TEMPVector31,VD.TEMPVector33);var VU=VD.TEMPVector33.elements;VU[0]==Math.PI/2?(VU[1]=VD.arcTanAngle(Va[2],Va[0]),VU[2]=0):VU[0]==-Math.PI/2?(VU[1]=VD.arcTanAngle(-Va[2],-Va[0]),VU[2]=0):(Vna.createRotationY(-VU[1],VD.TEMPMatrix0),Vna.createRotationX(-VU[0],VD.TEMPMatrix1),VQa.transformCoordinate(VD.TEMPVector32,VD.TEMPMatrix0,VD.TEMPVector32),VQa.transformCoordinate(VD.TEMPVector32,VD.TEMPMatrix1,VD.TEMPVector32),VU[2]=VD.arcTanAngle(Va[1],-Va[0])),VU[1]<=-Math.PI&&(VU[1]=Math.PI),VU[2]<=-Math.PI&&(VU[2]=Math.PI),VU[1]>=Math.PI&&VU[2]>=Math.PI&&(VU[1]=0,VU[2]=0,VU[0]=Math.PI-VU[0]);var Vx=Vn.elements;Vx[0]=VU[1],Vx[1]=VU[0],Vx[2]=VU[2]},Vn.invert=function(Vn){var Va=Vn.elements,VU=this.elements,Vx=VU[0],VD=VU[1],Vp=VU[2],VQ=VU[3],VV=Vx*Vx+VD*VD+Vp*Vp+VQ*VQ,Vy=VV?1/VV:0;Va[0]=-Vx*Vy,Va[1]=-VD*Vy,Va[2]=-Vp*Vy,Va[3]=VQ*Vy},Vn.identity=function(){var Vn=this.elements;Vn[0]=0,Vn[1]=0,Vn[2]=0,Vn[3]=1},Vn.fromArray=function(Vn,Va){void 0===Va&&(Va=0),this.elements[0]=Vn[Va+0],this.elements[1]=Vn[Va+1],this.elements[2]=Vn[Va+2],this.elements[3]=Vn[Va+3]},Vn.cloneTo=function(Vn){var Va,VU,Vx;if((VU=this.elements)!==(Vx=Vn.elements))for(Va=0;Va<4;++Va)Vx[Va]=VU[Va]},Vn.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},Vn.equals=function(Vn){var Va=this.elements,VU=Vn.elements;return VJn.nearEqual(Va[0],VU[0])&&VJn.nearEqual(Va[1],VU[1])&&VJn.nearEqual(Va[2],VU[2])&&VJn.nearEqual(Va[3],VU[3])},Vn.lengthSquared=function(){var Vn=this.elements[0],Va=this.elements[1],VU=this.elements[2],Vx=this.elements[3];return Vn*Vn+Va*Va+VU*VU+Vx*Vx},VE(0,Vn,"x",function(){return this.elements[0]}),VE(0,Vn,"y",function(){return this.elements[1]}),VE(0,Vn,"z",function(){return this.elements[2]}),VE(0,Vn,"w",function(){return this.elements[3]}),VD.createFromYawPitchRoll=function(Vn,Va,VU,Vx){var VD=.5*VU,Vp=.5*Va,VQ=.5*Vn,VV=Math.sin(VD),Vy=Math.cos(VD),VR=Math.sin(Vp),VX=Math.cos(Vp),Vz=Math.sin(VQ),Vi=Math.cos(VQ),Vq=Vx.elements;Vq[0]=Vi*VR*Vy+Vz*VX*VV,Vq[1]=Vz*VX*Vy-Vi*VR*VV,Vq[2]=Vi*VX*VV-Vz*VR*Vy,Vq[3]=Vi*VX*Vy+Vz*VR*VV},VD.multiply=function(Vn,Va,VU){var Vx=Vn.elements,VD=Va.elements,Vp=VU.elements,VQ=Vx[0],VV=Vx[1],Vy=Vx[2],VR=Vx[3],VX=VD[0],Vz=VD[1],Vi=VD[2],Vq=VD[3],VE=VV*Vi-Vy*Vz,Vm=Vy*VX-VQ*Vi,Vb=VQ*Vz-VV*VX,VP=VQ*VX+VV*Vz+Vy*Vi;Vp[0]=VQ*Vq+VX*VR+VE,Vp[1]=VV*Vq+Vz*VR+Vm,Vp[2]=Vy*Vq+Vi*VR+Vb,Vp[3]=VR*Vq-VP},VD.arcTanAngle=function(Vn,Va){return 0==Vn?1==Va?Math.PI/2:-Math.PI/2:0<Vn?Math.atan(Va/Vn):Vn<0?0<Va?Math.atan(Va/Vn)+Math.PI:Math.atan(Va/Vn)-Math.PI:0},VD.angleTo=function(Vn,Va,VU){VQa.subtract(Va,Vn,VD.TEMPVector30),VQa.normalize(VD.TEMPVector30,VD.TEMPVector30),VU.elements[0]=Math.asin(VD.TEMPVector30.y),VU.elements[1]=VD.arcTanAngle(-VD.TEMPVector30.z,-VD.TEMPVector30.x)},VD.createFromAxisAngle=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements;Va*=.5;var Vp=Math.sin(Va);Vx[0]=Vp*VD[0],Vx[1]=Vp*VD[1],Vx[2]=Vp*VD[2],Vx[3]=Math.cos(Va)},VD.createFromMatrix3x3=function(Vn,Va){var VU,Vx=Va.elements,VD=Vn.elements,Vp=VD[0]+VD[4]+VD[8];if(0<Vp)VU=Math.sqrt(Vp+1),Vx[3]=.5*VU,VU=.5/VU,Vx[0]=(VD[5]-VD[7])*VU,Vx[1]=(VD[6]-VD[2])*VU,Vx[2]=(VD[1]-VD[3])*VU;else{var VQ=0;VD[4]>VD[0]&&(VQ=1),VD[8]>VD[3*VQ+VQ]&&(VQ=2);var VV=(VQ+1)%3,Vy=(VQ+2)%3;VU=Math.sqrt(VD[3*VQ+VQ]-VD[3*VV+VV]-VD[3*Vy+Vy]+1),Vx[VQ]=.5*VU,VU=.5/VU,Vx[3]=(VD[3*VV+Vy]-VD[3*Vy+VV])*VU,Vx[VV]=(VD[3*VV+VQ]+VD[3*VQ+VV])*VU,Vx[Vy]=(VD[3*Vy+VQ]+VD[3*VQ+Vy])*VU}},VD.createFromMatrix4x4=function(Vn,Va){var VU,Vx,VD=Vn.elements,Vp=Va.elements,VQ=VD[0]+VD[5]+VD[10];0<VQ?(VU=Math.sqrt(VQ+1),Vp[3]=.5*VU,VU=.5/VU,Vp[0]=(VD[6]-VD[9])*VU,Vp[1]=(VD[8]-VD[2])*VU,Vp[2]=(VD[1]-VD[4])*VU):VD[0]>=VD[5]&&VD[0]>=VD[10]?(Vx=.5/(VU=Math.sqrt(1+VD[0]-VD[5]-VD[10])),Vp[0]=.5*VU,Vp[1]=(VD[1]+VD[4])*Vx,Vp[2]=(VD[2]+VD[8])*Vx,Vp[3]=(VD[6]-VD[9])*Vx):VD[5]>VD[10]?(Vx=.5/(VU=Math.sqrt(1+VD[5]-VD[0]-VD[10])),Vp[0]=(VD[4]+VD[1])*Vx,Vp[1]=.5*VU,Vp[2]=(VD[9]+VD[6])*Vx,Vp[3]=(VD[8]-VD[2])*Vx):(Vx=.5/(VU=Math.sqrt(1+VD[10]-VD[0]-VD[5])),Vp[0]=(VD[8]+VD[2])*Vx,Vp[1]=(VD[9]+VD[6])*Vx,Vp[2]=.5*VU,Vp[3]=(VD[1]-VD[4])*Vx)},VD.slerp=function(Vn,Va,VU,Vx){var VD,Vp,VQ,VV,Vy,VR=Vn.elements,VX=Va.elements,Vz=Vx.elements,Vi=VR[0],Vq=VR[1],VE=VR[2],Vm=VR[3],Vb=VX[0],VP=VX[1],VA=VX[2],VT=VX[3];return(Vp=Vi*Vb+Vq*VP+VE*VA+Vm*VT)<0&&(Vp=-Vp,Vb=-Vb,VP=-VP,VA=-VA,VT=-VT),Vy=1e-6<1-Vp?(VD=Math.acos(Vp),VQ=Math.sin(VD),VV=Math.sin((1-VU)*VD)/VQ,Math.sin(VU*VD)/VQ):(VV=1-VU,VU),Vz[0]=VV*Vi+Vy*Vb,Vz[1]=VV*Vq+Vy*VP,Vz[2]=VV*VE+Vy*VA,Vz[3]=VV*Vm+Vy*VT,Vz},VD.lerp=function(Vn,Va,VU,Vx){var VD=Vx.elements,Vp=Vn.elements,VQ=Va.elements,VV=Vp[0],Vy=Vp[1],VR=Vp[2],VX=Vp[3];VD[0]=VV+VU*(VQ[0]-VV),VD[1]=Vy+VU*(VQ[1]-Vy),VD[2]=VR+VU*(VQ[2]-VR),VD[3]=VX+VU*(VQ[3]-VX)},VD.add=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements;Vx[0]=VD[0]+Vp[0],Vx[1]=VD[1]+Vp[1],Vx[2]=VD[2]+Vp[2],Vx[3]=VD[3]+Vp[3]},VD.dot=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements;return VU[0]*Vx[0]+VU[1]*Vx[1]+VU[2]*Vx[2]+VU[3]*Vx[3]},VD.rotationLookAt=function(Vn,Va,VU){VD.lookAt(VQa.ZERO,Vn,Va,VU)},VD.lookAt=function(Vn,Va,VU,Vx){Ven.lookAt(Vn,Va,VU,VD._tempMatrix3x3),VD.rotationMatrix(VD._tempMatrix3x3,Vx)},VD.invert=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements,VD=Vn.lengthSquared();VJn.isZero(VD)||(VD=1/VD,Vx[0]=-VU[0]*VD,Vx[1]=-VU[1]*VD,Vx[2]=-VU[2]*VD,Vx[3]=VU[3]*VD)},VD.rotationMatrix=function(Vn,Va){var VU=Vn.elements,Vx=VU[0],VD=VU[1],Vp=VU[2],VQ=VU[3],VV=VU[4],Vy=VU[5],VR=VU[6],VX=VU[7],Vz=VU[8],Vi=Va.elements,Vq=NaN,VE=NaN,Vm=Vx+VV+Vz;0<Vm?(Vq=Math.sqrt(Vm+1),Vi[3]=.5*Vq,Vq=.5/Vq,Vi[0]=(Vy-VX)*Vq,Vi[1]=(VR-Vp)*Vq,Vi[2]=(VD-VQ)*Vq):VV<=Vx&&Vz<=Vx?(VE=.5/(Vq=Math.sqrt(1+Vx-VV-Vz)),Vi[0]=.5*Vq,Vi[1]=(VD+VQ)*VE,Vi[2]=(Vp+VR)*VE,Vi[3]=(Vy-VX)*VE):Vz<VV?(VE=.5/(Vq=Math.sqrt(1+VV-Vx-Vz)),Vi[0]=(VQ+VD)*VE,Vi[1]=.5*Vq,Vi[2]=(VX+Vy)*VE,Vi[3]=(VR-Vp)*VE):(VE=.5/(Vq=Math.sqrt(1+Vz-Vx-VV)),Vi[0]=(VR+Vp)*VE,Vi[1]=(VX+Vy)*VE,Vi[2]=.5*Vq,Vi[3]=(VD-VQ)*VE)},VD.DEFAULT=new VD,Vz(VD,["TEMPVector30",function(){return this.TEMPVector30=new VQa},"TEMPVector31",function(){return this.TEMPVector31=new VQa},"TEMPVector32",function(){return this.TEMPVector32=new VQa},"TEMPVector33",function(){return this.TEMPVector33=new VQa},"TEMPMatrix0",function(){return this.TEMPMatrix0=new Vna},"TEMPMatrix1",function(){return this.TEMPMatrix1=new Vna},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new Ven},"NAN",function(){return this.NAN=new VD(NaN,NaN,NaN,NaN)}]),VD}(),Vxa=function(){function Vn(Vn){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=Vn,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}Vq(Vn,"laya.d3.math.Rand");var Va=Vn.prototype;return Va.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},Va.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},Va.getSignedFloat=function(){return 2*this.getFloat()-1},VE(0,Va,"seed",function(){return this.seeds[0]},function(Vn){this.seeds[0]=Vn,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),Vn.getFloatFromInt=function(Vn){return 1/8388607*(8388607&Vn)},Vn.getByteFromInt=function(Vn){return(8388607&Vn)>>>15},Vn}(),VDa=(function(){function VD(Vn){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(Vn instanceof Array)||4!==Vn.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|Vn[0],this._state0L=0|Vn[1],this._state1U=0|Vn[2],this._state1L=0|Vn[3]}Vq(VD,"laya.d3.math.RandX");var Vn=VD.prototype;Vn.randomint=function(){var Vn=this._state0U,Va=this._state0L,VU=this._state1U,Vx=this._state1L,VD=(Vx>>>0)+(Va>>>0),Vp=VU+Vn+(VD/2>>>31)>>>0,VQ=VD>>>0,VV=0,Vy=0;VV=(Vn^=VV=Vn<<23|(-512&Va)>>>9)^(this._state0U=VU),Vy=(Va^=Vy=Va<<23)^(this._state0L=Vx);VV^=Vn>>>18,Vy^=Va>>>18|(262143&Vn)<<14;return VV^=VU>>>5,Vy^=Vx>>>5|(31&VU)<<27,this._state1U=VV,this._state1L=Vy,[Vp,VQ]},Vn.random=function(){var Vn=this.randomint(),Va=Vn[0],VU=1023<<20|Va>>>12,Vx=0|(Vn[1]>>>12|(4095&Va)<<20);return VD._CONVERTION_BUFFER.setUint32(0,VU,!1),VD._CONVERTION_BUFFER.setUint32(4,Vx,!1),Vxa._CONVERTION_BUFFER.getFloat64(0,!1)-1},Vz(VD,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new Vxa([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function Vn(Vn,Va){this.origin=null,this.direction=null,this.origin=Vn,this.direction=Va}return Vq(Vn,"laya.d3.math.Ray"),Vn}()),Vpa=function(){function Vn(Vn,Va){this.elements=new Float32Array(2),void 0===Vn&&(Vn=0),void 0===Va&&(Va=0);var VU=this.elements;VU[0]=Vn,VU[1]=Va}Vq(Vn,"laya.d3.math.Vector2");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.core.IClone":!0}),Va.fromArray=function(Vn,Va){void 0===Va&&(Va=0),this.elements[0]=Vn[Va+0],this.elements[1]=Vn[Va+1]},Va.cloneTo=function(Vn){var Va=Vn.elements,VU=this.elements;Va[0]=VU[0],Va[1]=VU[1]},Va.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Va,"x",function(){return this.elements[0]},function(Vn){this.elements[0]=Vn}),VE(0,Va,"y",function(){return this.elements[1]},function(Vn){this.elements[1]=Vn}),Vn.scale=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements;Vx[0]=VD[0]*Va,Vx[1]=VD[1]*Va},Vz(Vn,["ZERO",function(){return this.ZERO=new Vn(0,0)},"ONE",function(){return this.ONE=new Vn(1,1)}]),Vn}(),VQa=function(){function VX(Vn,Va,VU){this.elements=new Float32Array(3),void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),void 0===VU&&(VU=0);var Vx=this.elements;Vx[0]=Vn,Vx[1]=Va,Vx[2]=VU}Vq(VX,"laya.d3.math.Vector3");var Vn=VX.prototype;return VY.imps(Vn,{"laya.d3.core.IClone":!0}),Vn.fromArray=function(Vn,Va){void 0===Va&&(Va=0),this.elements[0]=Vn[Va+0],this.elements[1]=Vn[Va+1],this.elements[2]=Vn[Va+2]},Vn.cloneTo=function(Vn){var Va=Vn.elements,VU=this.elements;Va[0]=VU[0],Va[1]=VU[1],Va[2]=VU[2]},Vn.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},Vn.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},Vn.reset=function(Vn,Va,VU){this.elements[0]=Vn,this.elements[1]=Va,this.elements[2]=VU},VE(0,Vn,"x",function(){return this.elements[0]},function(Vn){this.elements[0]=Vn}),VE(0,Vn,"y",function(){return this.elements[1]},function(Vn){this.elements[1]=Vn}),VE(0,Vn,"z",function(){return this.elements[2]},function(Vn){this.elements[2]=Vn}),VX.distanceSquared=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements,VD=VU[0]-Vx[0],Vp=VU[1]-Vx[1],VQ=VU[2]-Vx[2];return VD*VD+Vp*Vp+VQ*VQ},VX.distance=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements,VD=VU[0]-Vx[0],Vp=VU[1]-Vx[1],VQ=VU[2]-Vx[2];return Math.sqrt(VD*VD+Vp*Vp+VQ*VQ)},VX.min=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements;Vx[0]=Math.min(VD[0],Vp[0]),Vx[1]=Math.min(VD[1],Vp[1]),Vx[2]=Math.min(VD[2],Vp[2])},VX.max=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements;Vx[0]=Math.max(VD[0],Vp[0]),Vx[1]=Math.max(VD[1],Vp[1]),Vx[2]=Math.max(VD[2],Vp[2])},VX.transformQuat=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements,VQ=VD[0],VV=VD[1],Vy=VD[2],VR=Vp[0],VX=Vp[1],Vz=Vp[2],Vi=Vp[3],Vq=Vi*VQ+VX*Vy-Vz*VV,VE=Vi*VV+Vz*VQ-VR*Vy,Vm=Vi*Vy+VR*VV-VX*VQ,Vb=-VR*VQ-VX*VV-Vz*Vy;Vx[0]=Vq*Vi+Vb*-VR+VE*-Vz-Vm*-VX,Vx[1]=VE*Vi+Vb*-VX+Vm*-VR-Vq*-Vz,Vx[2]=Vm*Vi+Vb*-Vz+Vq*-VX-VE*-VR},VX.scalarLength=function(Vn){var Va=Vn.elements,VU=Va[0],Vx=Va[1],VD=Va[2];return Math.sqrt(VU*VU+Vx*Vx+VD*VD)},VX.scalarLengthSquared=function(Vn){var Va=Vn.elements,VU=Va[0],Vx=Va[1],VD=Va[2];return VU*VU+Vx*Vx+VD*VD},VX.normalize=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements,VD=VU[0],Vp=VU[1],VQ=VU[2],VV=VD*VD+Vp*Vp+VQ*VQ;0<VV&&(VV=1/Math.sqrt(VV),Vx[0]=VU[0]*VV,Vx[1]=VU[1]*VV,Vx[2]=VU[2]*VV)},VX.multiply=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements;Vx[0]=VD[0]*Vp[0],Vx[1]=VD[1]*Vp[1],Vx[2]=VD[2]*Vp[2]},VX.scale=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements;Vx[0]=VD[0]*Va,Vx[1]=VD[1]*Va,Vx[2]=VD[2]*Va},VX.lerp=function(Vn,Va,VU,Vx){var VD=Vx.elements,Vp=Vn.elements,VQ=Va.elements,VV=Vp[0],Vy=Vp[1],VR=Vp[2];VD[0]=VV+VU*(VQ[0]-VV),VD[1]=Vy+VU*(VQ[1]-Vy),VD[2]=VR+VU*(VQ[2]-VR)},VX.transformV3ToV3=function(Vn,Va,VU){var Vx=VX._tempVector4;VX.transformV3ToV4(Vn,Va,Vx);var VD=Vx.elements,Vp=VU.elements;Vp[0]=VD[0],Vp[1]=VD[1],Vp[2]=VD[2]},VX.transformV3ToV4=function(Vn,Va,VU){var Vx=Vn.elements,VD=Vx[0],Vp=Vx[1],VQ=Vx[2],VV=Va.elements,Vy=VU.elements;Vy[0]=VD*VV[0]+Vp*VV[4]+VQ*VV[8]+VV[12],Vy[1]=VD*VV[1]+Vp*VV[5]+VQ*VV[9]+VV[13],Vy[2]=VD*VV[2]+Vp*VV[6]+VQ*VV[10]+VV[14],Vy[3]=VD*VV[3]+Vp*VV[7]+VQ*VV[11]+VV[15]},VX.TransformNormal=function(Vn,Va,VU){var Vx=Vn.elements,VD=Vx[0],Vp=Vx[1],VQ=Vx[2],VV=Va.elements,Vy=VU.elements;Vy[0]=VD*VV[0]+Vp*VV[4]+VQ*VV[8],Vy[1]=VD*VV[1]+Vp*VV[5]+VQ*VV[9],Vy[2]=VD*VV[2]+Vp*VV[6]+VQ*VV[10]},VX.transformCoordinate=function(Vn,Va,VU){var Vx=VX._tempVector4.elements,VD=Vn.elements,Vp=VD[0],VQ=VD[1],VV=VD[2],Vy=Va.elements;Vx[0]=Vp*Vy[0]+VQ*Vy[4]+VV*Vy[8]+Vy[12],Vx[1]=Vp*Vy[1]+VQ*Vy[5]+VV*Vy[9]+Vy[13],Vx[2]=Vp*Vy[2]+VQ*Vy[6]+VV*Vy[10]+Vy[14],Vx[3]=1/(Vp*Vy[3]+VQ*Vy[7]+VV*Vy[11]+Vy[15]);var VR=VU.elements;VR[0]=Vx[0]*Vx[3],VR[1]=Vx[1]*Vx[3],VR[2]=Vx[2]*Vx[3]},VX.Clamp=function(Vn,Va,VU,Vx){var VD=Vn.elements,Vp=VD[0],VQ=VD[1],VV=VD[2],Vy=Va.elements,VR=Vy[0],VX=Vy[1],Vz=Vy[2],Vi=VU.elements,Vq=Vi[0],VE=Vi[1],Vm=Vi[2],Vb=Vx.elements;Vp=(Vp=Vq<Vp?Vq:Vp)<VR?VR:Vp,VQ=(VQ=VE<VQ?VE:VQ)<VX?VX:VQ,VV=(VV=Vm<VV?Vm:VV)<Vz?Vz:VV,Vb[0]=Vp,Vb[1]=VQ,Vb[2]=VV},VX.add=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements;Vx[0]=VD[0]+Vp[0],Vx[1]=VD[1]+Vp[1],Vx[2]=VD[2]+Vp[2]},VX.subtract=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements;Vx[0]=VD[0]-Vp[0],Vx[1]=VD[1]-Vp[1],Vx[2]=VD[2]-Vp[2]},VX.cross=function(Vn,Va,VU){var Vx=Vn.elements,VD=Va.elements,Vp=VU.elements,VQ=Vx[0],VV=Vx[1],Vy=Vx[2],VR=VD[0],VX=VD[1],Vz=VD[2];Vp[0]=VV*Vz-Vy*VX,Vp[1]=Vy*VR-VQ*Vz,Vp[2]=VQ*VX-VV*VR},VX.dot=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements;return VU[0]*Vx[0]+VU[1]*Vx[1]+VU[2]*Vx[2]},VX.equals=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements;return VJn.nearEqual(Math.abs(VU[0]),Math.abs(Vx[0]))&&VJn.nearEqual(Math.abs(VU[1]),Math.abs(Vx[1]))&&VJn.nearEqual(Math.abs(VU[2]),Math.abs(Vx[2]))},VX.ZERO=new VX(0,0,0),VX.ONE=new VX(1,1,1),VX.NegativeUnitX=new VX(-1,0,0),VX.UnitX=new VX(1,0,0),VX.UnitY=new VX(0,1,0),VX.UnitZ=new VX(0,0,1),VX.ForwardRH=new VX(0,0,-1),VX.ForwardLH=new VX(0,0,1),VX.Up=new VX(0,1,0),VX.NAN=new VX(NaN,NaN,NaN),Vz(VX,["_tempVector4",function(){return this._tempVector4=new VVa}]),VX}(),VVa=function(){function Vn(Vn,Va,VU,Vx){this.elements=new Float32Array(4),void 0===Vn&&(Vn=0),void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=0);var VD=this.elements;VD[0]=Vn,VD[1]=Va,VD[2]=VU,VD[3]=Vx}Vq(Vn,"laya.d3.math.Vector4");var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.core.IClone":!0}),Va.fromArray=function(Vn,Va){void 0===Va&&(Va=0),this.elements[0]=Vn[Va+0],this.elements[1]=Vn[Va+1],this.elements[2]=Vn[Va+2],this.elements[3]=Vn[Va+3]},Va.cloneTo=function(Vn){var Va=Vn.elements,VU=this.elements;Va[0]=VU[0],Va[1]=VU[1],Va[2]=VU[2],Va[3]=VU[3]},Va.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},Va.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},Va.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},VE(0,Va,"x",function(){return this.elements[0]},function(Vn){this.elements[0]=Vn}),VE(0,Va,"y",function(){return this.elements[1]},function(Vn){this.elements[1]=Vn}),VE(0,Va,"z",function(){return this.elements[2]},function(Vn){this.elements[2]=Vn}),VE(0,Va,"w",function(){return this.elements[3]},function(Vn){this.elements[3]=Vn}),Vn.lerp=function(Vn,Va,VU,Vx){var VD=Vx.elements,Vp=Vn.elements,VQ=Va.elements,VV=Vp[0],Vy=Vp[1],VR=Vp[2],VX=Vp[3];VD[0]=VV+VU*(VQ[0]-VV),VD[1]=Vy+VU*(VQ[1]-Vy),VD[2]=VR+VU*(VQ[2]-VR),VD[3]=VX+VU*(VQ[3]-VX)},Vn.transformByM4x4=function(Vn,Va,VU){var Vx=Vn.elements,VD=Vx[0],Vp=Vx[1],VQ=Vx[2],VV=Vx[3],Vy=Va.elements,VR=VU.elements;VR[0]=VD*Vy[0]+Vp*Vy[4]+VQ*Vy[8]+VV*Vy[12],VR[1]=VD*Vy[1]+Vp*Vy[5]+VQ*Vy[9]+VV*Vy[13],VR[2]=VD*Vy[2]+Vp*Vy[6]+VQ*Vy[10]+VV*Vy[14],VR[3]=VD*Vy[3]+Vp*Vy[7]+VQ*Vy[11]+VV*Vy[15]},Vn.equals=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements;return VJn.nearEqual(Math.abs(VU[0]),Math.abs(Vx[0]))&&VJn.nearEqual(Math.abs(VU[1]),Math.abs(Vx[1]))&&VJn.nearEqual(Math.abs(VU[2]),Math.abs(Vx[2]))&&VJn.nearEqual(Math.abs(VU[3]),Math.abs(Vx[3]))},Vn.normalize=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements,VD=Vn.length();0<VD&&(Vx[0]=VU[0]*VD,Vx[1]=VU[1]*VD,Vx[2]=VU[2]*VD,Vx[3]=VU[3]*VD)},Vn.add=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements;Vx[0]=VD[0]+Vp[0],Vx[1]=VD[1]+Vp[1],Vx[2]=VD[2]+Vp[2],Vx[3]=VD[3]+Vp[3]},Vn.subtract=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements;Vx[0]=VD[0]-Vp[0],Vx[1]=VD[1]-Vp[1],Vx[2]=VD[2]-Vp[2],Vx[3]=VD[3]-Vp[3]},Vn.multiply=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements;Vx[0]=VD[0]*Vp[0],Vx[1]=VD[1]*Vp[1],Vx[2]=VD[2]*Vp[2],Vx[3]=VD[3]*Vp[3]},Vn.scale=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements;Vx[0]=VD[0]*Va,Vx[1]=VD[1]*Va,Vx[2]=VD[2]*Va,Vx[3]=VD[3]*Va},Vn.Clamp=function(Vn,Va,VU,Vx){var VD=Vn.elements,Vp=VD[0],VQ=VD[1],VV=VD[2],Vy=VD[3],VR=Va.elements,VX=VR[0],Vz=VR[1],Vi=VR[2],Vq=VR[3],VE=VU.elements,Vm=VE[0],Vb=VE[1],VP=VE[2],VA=VE[3],VT=Vx.elements;Vp=(Vp=Vm<Vp?Vm:Vp)<VX?VX:Vp,VQ=(VQ=Vb<VQ?Vb:VQ)<Vz?Vz:VQ,VV=(VV=VP<VV?VP:VV)<Vi?Vi:VV,Vy=(Vy=VA<Vy?VA:Vy)<Vq?Vq:Vy,VT[0]=Vp,VT[1]=VQ,VT[2]=VV,VT[3]=Vy},Vn.distanceSquared=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements,VD=VU[0]-Vx[0],Vp=VU[1]-Vx[1],VQ=VU[2]-Vx[2],VV=VU[3]-Vx[3];return VD*VD+Vp*Vp+VQ*VQ+VV*VV},Vn.distance=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements,VD=VU[0]-Vx[0],Vp=VU[1]-Vx[1],VQ=VU[2]-Vx[2],VV=VU[3]-Vx[3];return Math.sqrt(VD*VD+Vp*Vp+VQ*VQ+VV*VV)},Vn.dot=function(Vn,Va){var VU=Vn.elements,Vx=Va.elements;return VU[0]*Vx[0]+VU[1]*Vx[1]+VU[2]*Vx[2]+VU[3]*Vx[3]},Vn.min=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements;Vx[0]=Math.min(VD[0],Vp[0]),Vx[1]=Math.min(VD[1],Vp[1]),Vx[2]=Math.min(VD[2],Vp[2]),Vx[3]=Math.min(VD[3],Vp[3])},Vn.max=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va.elements;Vx[0]=Math.max(VD[0],Vp[0]),Vx[1]=Math.max(VD[1],Vp[1]),Vx[2]=Math.max(VD[2],Vp[2]),Vx[3]=Math.max(VD[3],Vp[3])},Vz(Vn,["ZERO",function(){return this.ZERO=new Vn},"ONE",function(){return this.ONE=new Vn(1,1,1,1)},"UnitX",function(){return this.UnitX=new Vn(1,0,0,0)},"UnitY",function(){return this.UnitY=new Vn(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new Vn(0,0,1,0)},"UnitW",function(){return this.UnitW=new Vn(0,0,0,1)}]),Vn}(),Vya=function(){function Vp(Vn,Va,VU,Vx){this.minDepth=0,this.maxDepth=1,this.x=Vn,this.y=Va,this.width=VU,this.height=Vx}Vq(Vp,"laya.d3.math.Viewport");var Vn=Vp.prototype;return Vn.project=function(Vn,Va,VU){VQa.transformV3ToV3(Vn,Va,VU);var Vx=Vn.elements,VD=Va.elements,Vp=VU.elements,VQ=Vx[0]*VD[3]+Vx[1]*VD[7]+Vx[2]*VD[11]+VD[15];1!==VQ&&(Vp[0]=Vp[0]/VQ,Vp[1]=Vp[1]/VQ,Vp[2]=Vp[2]/VQ),Vp[0]=.5*(Vp[0]+1)*this.width+this.x,Vp[1]=.5*(1-Vp[1])*this.height+this.y,Vp[2]=Vp[2]*(this.maxDepth-this.minDepth)+this.minDepth},Vn.unprojectFromMat=function(Vn,Va,VU){var Vx=Vn.elements,VD=Va.elements,Vp=VU.elements;Vp[0]=(Vx[0]-this.x)/this.width*2-1,Vp[1]=-((Vx[1]-this.y)/this.height*2-1);var VQ=(this.maxDepth-this.minDepth)/2;Vp[2]=(Vx[2]-this.minDepth-VQ)/VQ;var VV=Vp[0]*VD[3]+Vp[1]*VD[7]+Vp[2]*VD[11]+VD[15];VQa.transformV3ToV3(VU,Va,VU),1!==VV&&(Vp[0]=Vp[0]/VV,Vp[1]=Vp[1]/VV,Vp[2]=Vp[2]/VV)},Vn.unprojectFromWVP=function(Vn,Va,VU,Vx,VD){Vna.multiply(Va,VU,Vp._tempMatrix4x4),Vx&&Vna.multiply(Vp._tempMatrix4x4,Vx,Vp._tempMatrix4x4),Vp._tempMatrix4x4.invert(Vp._tempMatrix4x4),this.unprojectFromMat(Vn,Vp._tempMatrix4x4,VD)},Vz(Vp,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new Vna}]),Vp}(),VRa=function(){function VZ(Vn){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=Vn,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}Vq(VZ,"laya.d3.resource.models.SubMesh");var Vn=VZ.prototype;return VY.imps(Vn,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),Vn._getVertexBuffer=function(Vn){return void 0===Vn&&(Vn=0),0===Vn?this._vertexBuffer:null},Vn._getIndexBuffer=function(){return this._indexBuffer},Vn._getStaticBatchBakedVertexs=function(Vn,Va){var VU,Vx,VD=this._vertexBuffer,Vp=VD.vertexDeclaration,VQ=Vp.getVertexElementByUsage(0).offset/4,VV=Vp.getVertexElementByUsage(3).offset/4,Vy=Va.meshRender.lightmapScaleOffset,VR=0,VX=0,Vz=0,Vi=0,Vq=0,VE=0;if(Vy)if(Vx=Vp.getVertexElementByUsage(15))Vz=Vp.vertexStride/4,VU=0<this._vertexCount?VD.getData().slice(this._vertexStart*Vz,(this._vertexStart+this._vertexCount)*Vz):VD.getData().slice(),Vi=Vx.offset/4;else{Vz=(VE=Vp.vertexStride/4)+2,VU=this._vertexCount?new Float32Array(this._vertexCount*(VD.vertexDeclaration.vertexStride/4+2)):new Float32Array(VD.vertexCount*(VD.vertexDeclaration.vertexStride/4+2)),Vi=(Vq=Vp.getVertexElementByUsage(2).offset/4)+2;var Vm=VD.getData();for(VR=0,VX=Vm.length/VE;VR<VX;VR++){var Vb=0;Vb=0<this._vertexCount?(this._vertexStart+VR)*VE:VR*VE;var VP=VR*Vz,VA=0;for(VA=0;VA<Vi;VA++)VU[VP+VA]=Vm[Vb+VA];for(VA=Vi;VA<VE;VA++)VU[VP+VA+2]=Vm[Vb+VA]}}else Vz=Vp.vertexStride/4,VU=this._vertexCount?VD.getData().slice(this._vertexStart*Vz,(this._vertexStart+this._vertexCount)*Vz):VD.getData().slice();if(Vn){var VT=Vn.worldMatrix,VK=VZ._tempMatrix4x40;VT.invert(VK);var VY=VZ._tempMatrix4x41,VW=Va.transform.worldMatrix;Vna.multiply(VK,VW,VY)}else VY=Va.transform.worldMatrix;var Vk=VZ._tempQuaternion0;for(VY.decomposeTransRotScale(VZ._tempVector30,Vk,VZ._tempVector31),VR=0,VX=VU.length/Vz;VR<VX;VR++){var VN=VR*Vz+VQ,V_=VR*Vz+VV;if(Vba.transformVector3ArrayToVector3ArrayCoordinate(VU,VN,VY,VU,VN),Vba.transformVector3ArrayByQuat(VU,V_,Vk,VU,V_),Vy){var V$=VR*Vz+Vi;if(Vx)Vba.transformLightingMapTexcoordByUV1Array(VU,V$,Vy,VU,V$);else{var VM=VR*VE+Vq;Vba.transformLightingMapTexcoordByUV0Array(Vm,VM,Vy,VU,V$)}}}return VU},Vn._getVertexBuffers=function(){return null},Vn._beforeRender=function(Vn){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Vn._render=function(Vn){var Va,VU=0,Vx=Vn.renderElement;if(1<this._indexCount){var VD=this._boneIndicesList.length;if(1<VD){for(var Vp=0;Vp<VD;Vp++)(Va=Vx._skinAnimationDatas||this._skinAnimationDatas)&&(Vx._shaderValue.setValue(0,Va[Vp]),Vn._shader.uploadRenderElementUniforms(Vx._shaderValue.data)),Vu.mainContext.drawElements(4,this._subIndexBufferCount[Vp],5123,2*this._subIndexBufferStart[Vp]);VN.drawCall+=VD}else(Va=Vx._skinAnimationDatas||this._skinAnimationDatas)&&(Vx._shaderValue.setValue(0,Va[0]),Vn._shader.uploadRenderElementUniforms(Vx._shaderValue.data)),Vu.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),VN.drawCall++;VU=this._indexCount}else VU=this._indexBuffer.indexCount,(Va=Vx._skinAnimationDatas||this._skinAnimationDatas)&&(Vx._shaderValue.setValue(0,Va[0]),Vn._shader.uploadRenderElementUniforms(Vx._shaderValue.data)),Vu.mainContext.drawElements(4,VU,5123,0),VN.drawCall++;VN.trianglesFaces+=VU/3},Vn.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},Vn.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},VE(0,Vn,"_vertexBufferCount",function(){return 1}),VE(0,Vn,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Vz(VZ,["_tempVector30",function(){return this._tempVector30=new VQa},"_tempVector31",function(){return this._tempVector31=new VQa},"_tempQuaternion0",function(){return this._tempQuaternion0=new VUa},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new Vna},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new Vna}]),VZ}(),VXa=function(){function Vn(Vn){this.defineCounter=0,this.defines=null,Vn?(this.defineCounter=Vn.defineCounter,this.defines=Vn.defines.slice()):(this.defineCounter=0,this.defines=[])}return Vq(Vn,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),Vn.prototype.registerDefine=function(Vn){var Va=Math.pow(2,this.defineCounter++);return this.defines[Va]=Vn,Va},Vn}(),Vza=function(){function Vn(){}return Vq(Vn,"laya.d3.shader.ShaderInit3D"),Vn.__init__=function(){var Vn,Va;VNa._globalRegDefine("HIGHPRECISION",VNa.SHADERDEFINE_HIGHPRECISION),VNa._globalRegDefine("FOG",VNa.SHADERDEFINE_FOG),VNa._globalRegDefine("DIRECTIONLIGHT",VNa.SHADERDEFINE_DIRECTIONLIGHT),VNa._globalRegDefine("POINTLIGHT",VNa.SHADERDEFINE_POINTLIGHT),VNa._globalRegDefine("SPOTLIGHT",VNa.SHADERDEFINE_SPOTLIGHT),VNa._globalRegDefine("UV",VNa.SHADERDEFINE_UV0),VNa._globalRegDefine("COLOR",VNa.SHADERDEFINE_COLOR),VNa._globalRegDefine("UV1",VNa.SHADERDEFINE_UV1),VNa._globalRegDefine("CASTSHADOW",Vqa.SHADERDEFINE_CAST_SHADOW),VNa._globalRegDefine("SHADOWMAP_PSSM1",Vqa.SHADERDEFINE_SHADOW_PSSM1),VNa._globalRegDefine("SHADOWMAP_PSSM2",Vqa.SHADERDEFINE_SHADOW_PSSM2),VNa._globalRegDefine("SHADOWMAP_PSSM3",Vqa.SHADERDEFINE_SHADOW_PSSM3),VNa._globalRegDefine("SHADOWMAP_PCF_NO",Vqa.SHADERDEFINE_SHADOW_PCF_NO),VNa._globalRegDefine("SHADOWMAP_PCF1",Vqa.SHADERDEFINE_SHADOW_PCF1),VNa._globalRegDefine("SHADOWMAP_PCF2",Vqa.SHADERDEFINE_SHADOW_PCF2),VNa._globalRegDefine("SHADOWMAP_PCF3",Vqa.SHADERDEFINE_SHADOW_PCF3),VNa._globalRegDefine("DEPTHFOG",VNa.SAHDERDEFINE_DEPTHFOG),Vla.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),Vla.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),Vn={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},Va={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var VU=Vla.nameKey.add("SIMPLE");shaderCompile=VNa.add(VU,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',Vn,Va),Vja.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),Vja.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),Vja.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),Vja.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),Vja.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),Vja.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),Vja.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),Vja.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),Vja.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},Vn}(),Via=function(){function Vn(){this._data=null,this._data=[]}Vq(Vn,"laya.d3.shader.ValusArray");var Va=Vn.prototype;return Va.setValue=function(Vn,Va){this._data[Vn]=Va},VE(0,Va,"data",function(){return this._data}),Vn}(),Vqa=function(){function Vn(){}return Vn.SHADERDEFINE_RECEIVE_SHADOW=1,Vn.SHADERDEFINE_CAST_SHADOW=512,Vn.SHADERDEFINE_SHADOW_PSSM1=1024,Vn.SHADERDEFINE_SHADOW_PSSM2=2048,Vn.SHADERDEFINE_SHADOW_PSSM3=4096,Vn.SHADERDEFINE_SHADOW_PCF_NO=8192,Vn.SHADERDEFINE_SHADOW_PCF1=16384,Vn.SHADERDEFINE_SHADOW_PCF2=32768,Vn.SHADERDEFINE_SHADOW_PCF3=65536,Vn.MAX_PSSM_COUNT=3,Vn}(),VEa=function(){function Vw(){}return Vq(Vw,"laya.d3.utils.Picker"),Vw.calculateCursorRay=function(Vn,Va,VU,Vx,VD,Vp){var VQ=Vn.elements[0],VV=Vn.elements[1],Vy=Vw._tempVector30,VR=Vy.elements;VR[0]=VQ,VR[1]=VV,VR[2]=Va.minDepth;var VX=Vw._tempVector31,Vz=VX.elements;Vz[0]=VQ,Vz[1]=VV,Vz[2]=Va.maxDepth;var Vi=Vp.origin,Vq=Vw._tempVector32;Va.unprojectFromWVP(Vy,VU,Vx,VD,Vi),Va.unprojectFromWVP(VX,VU,Vx,VD,Vq);var VE=Vp.direction.elements;VE[0]=Vq.x-Vi.x,VE[1]=Vq.y-Vi.y,VE[2]=Vq.z-Vi.z,VQa.normalize(Vp.direction,Vp.direction)},Vw.rayIntersectsPositionsAndIndices=function(Vn,Va,VU,Vx,VD){for(var Vp=VU.vertexStride/4,VQ=VU.getVertexElementByUsage(0).offset/4,VV=Number.MAX_VALUE,Vy=-1,VR=-1,VX=-1,Vz=0;Vz<Vx.length;Vz+=3){var Vi=Vw._tempVector35,Vq=Vi.elements,VE=Vx[Vz]*Vp,Vm=VE+VQ;Vq[0]=Va[Vm],Vq[1]=Va[1+Vm],Vq[2]=Va[2+Vm];var Vb=Vw._tempVector36,VP=Vb.elements,VA=Vx[Vz+1]*Vp,VT=VA+VQ;VP[0]=Va[VT],VP[1]=Va[1+VT],VP[2]=Va[2+VT];var VK=Vw._tempVector37,VY=VK.elements,VW=Vx[Vz+2]*Vp,Vk=VW+VQ;VY[0]=Va[Vk],VY[1]=Va[1+Vk],VY[2]=Va[2+Vk];var VN=laya.d3.utils.Picker.rayIntersectsTriangle(Vn,Vi,Vb,VK);!isNaN(VN)&&VN<VV&&(VV=VN,Vy=VE,VR=VA,VX=VW)}if(VV===Number.MAX_VALUE)return VD.position.toDefault(),VD.distance=Number.MAX_VALUE,VD.trianglePositions[0].toDefault(),VD.trianglePositions[1].toDefault(),VD.trianglePositions[2].toDefault(),VD.triangleNormals[0].toDefault(),VD.triangleNormals[1].toDefault(),VD.triangleNormals[2].toDefault(),!1;VD.distance=VV,VQa.scale(Vn.direction,VV,VD.position),VQa.add(Vn.origin,VD.position,VD.position);var V_=VD.trianglePositions,V$=V_[0],VM=V_[1],VZ=V_[2],Vu=V$.elements,Vc=VM.elements,VH=VZ.elements,VG=Vy+VQ;Vu[0]=Va[VG],Vu[1]=Va[VG+1],Vu[2]=Va[VG+2];var VI=VR+VQ;Vc[0]=Va[VI],Vc[1]=Va[VI+1],Vc[2]=Va[VI+2];var Vv=VX+VQ;VH[0]=Va[Vv],VH[1]=Va[Vv+1],VH[2]=Va[Vv+2];var Vl=VU.getVertexElementByUsage(3);if(Vl){var Vj=Vl.offset/4,Vh=VD.triangleNormals,Vf=Vh[0],VF=Vh[1],Vg=Vh[2],Vo=Vf.elements,VB=VF.elements,VO=Vg.elements,VL=Vy+Vj;Vo[0]=Va[VL],Vo[1]=Va[VL+1],Vo[2]=Va[VL+2];var Vd=VR+Vj;VB[0]=Va[Vd],VB[1]=Va[Vd+1],VB[2]=Va[Vd+2];var VS=VX+Vj;VO[0]=Va[VS],VO[1]=Va[VS+1],VO[2]=Va[VS+2]}return!0},Vw.rayIntersectsTriangle=function(Vn,Va,VU,Vx){var VD=Vw._tempVector30,Vp=Vw._tempVector31;VQa.subtract(VU,Va,VD),VQa.subtract(Vx,Va,Vp);var VQ,VV=Vw._tempVector32;if(VQa.cross(Vn.direction,Vp,VV),(VQ=VQa.dot(VD,VV))>-Number.MIN_VALUE&&VQ<Number.MIN_VALUE)return Number.NaN;var Vy,VR=1/VQ,VX=Vw._tempVector33;if(VQa.subtract(Vn.origin,Va,VX),Vy=VQa.dot(VX,VV),(Vy*=VR)<0||1<Vy)return Number.NaN;var Vz,Vi,Vq=Vw._tempVector34;return VQa.cross(VX,VD,Vq),Vz=VQa.dot(Vn.direction,Vq),(Vz*=VR)<0||1<Vy+Vz?Number.NaN:(Vi=VQa.dot(Vp,Vq),(Vi*=VR)<0?Number.NaN:Vi)},Vz(Vw,["_tempVector30",function(){return this._tempVector30=new VQa},"_tempVector31",function(){return this._tempVector31=new VQa},"_tempVector32",function(){return this._tempVector32=new VQa},"_tempVector33",function(){return this._tempVector33=new VQa},"_tempVector34",function(){return this._tempVector34=new VQa},"_tempVector35",function(){return this._tempVector35=new VQa},"_tempVector36",function(){return this._tempVector36=new VQa},"_tempVector37",function(){return this._tempVector37=new VQa}]),Vw}(),Vma=(function(){function Vn(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new VQa,new VQa,new VQa],this.trianglePositions.length=3,this.triangleNormals=[new VQa,new VQa,new VQa],this.triangleNormals.length=3,this.position=new VQa}Vq(Vn,"laya.d3.utils.RaycastHit"),Vn.prototype.cloneTo=function(Vn){Vn.distance=this.distance,this.trianglePositions[0].cloneTo(Vn.trianglePositions[0]),this.trianglePositions[1].cloneTo(Vn.trianglePositions[1]),this.trianglePositions[2].cloneTo(Vn.trianglePositions[2]),this.triangleNormals[0].cloneTo(Vn.triangleNormals[0]),this.triangleNormals[1].cloneTo(Vn.triangleNormals[1]),this.triangleNormals[2].cloneTo(Vn.triangleNormals[2]),this.position.cloneTo(Vn.position),Vn.sprite3D=this.sprite3D}}(),function(){function Vn(Vn,Va){this._width=0,this._height=0,this._width=Vn,this._height=Va}Vq(Vn,"laya.d3.utils.Size");var Va=Vn.prototype;return VE(0,Va,"width",function(){return-1===this._width?Vs.clientWidth:this._width}),VE(0,Va,"height",function(){return-1===this._height?Vs.clientHeight:this._height}),VE(1,Vn,"fullScreen",function(){return new Vn(-1,-1)}),Vn}()),Vba=function(){function VG(){}return Vq(VG,"laya.d3.utils.Utils3D"),VG._rotationTransformScaleSkinAnimation=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vz){var Vi,Vq,VE,Vm,Vb,VP=VG._tempArray16_0,VA=VG._tempArray16_1,VT=VG._tempArray16_2,VK=Vx+Vx,VY=VD+VD,VW=Vp+Vp,Vk=Vx*VK,VN=VD*VK,V_=VD*VY,V$=Vp*VK,VM=Vp*VY,VZ=Vp*VW,Vu=VQ*VK,Vc=VQ*VY,VH=VQ*VW;for(VP[15]=1,VP[0]=1-V_-VZ,VP[1]=VN+VH,VP[2]=V$-Vc,VP[4]=VN-VH,VP[5]=1-Vk-VZ,VP[6]=VM+Vu,VP[8]=V$+Vc,VP[9]=VM-Vu,VP[10]=1-Vk-V_,VA[15]=1,VA[0]=VV,VA[5]=Vy,VA[10]=VR,Vi=0;Vi<4;Vi++)Vq=VP[Vi],VE=VP[Vi+4],Vm=VP[Vi+8],Vb=VP[Vi+12],VT[Vi]=Vq,VT[Vi+4]=VE,VT[Vi+8]=Vm,VT[Vi+12]=Vq*Vn+VE*Va+Vm*VU+Vb;for(Vi=0;Vi<4;Vi++)Vq=VT[Vi],VE=VT[Vi+4],Vm=VT[Vi+8],Vb=VT[Vi+12],VX[Vi+Vz]=Vq*VA[0]+VE*VA[1]+Vm*VA[2]+Vb*VA[3],VX[Vi+Vz+4]=Vq*VA[4]+VE*VA[5]+Vm*VA[6]+Vb*VA[7],VX[Vi+Vz+8]=Vq*VA[8]+VE*VA[9]+Vm*VA[10]+Vb*VA[11],VX[Vi+Vz+12]=Vq*VA[12]+VE*VA[13]+Vm*VA[14]+Vb*VA[15]},VG._createNodeByJson=function(Vn,Va,VU,Vx){if(!VU)switch(Va.type){case"Sprite3D":VU=new Vva;break;case"MeshSprite3D":VU=new Vwa;break;case"SkinnedMeshSprite3D":VU=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":VU=new ShuriKenParticle3D;break;case"TrailSprite3D":VU=new TrailSprite3D;break;case"Terrain":VU=new Terrain;break;case"Camera":VU=new VSa;break;case"DirectionLight":VU=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var VD=Va.props;if(VD)for(var Vp in VD)VU[Vp]=VD[Vp];var VQ=Va.customProps;VQ&&(VU instanceof laya.d3.core.Sprite3D?(VU._parseBaseCustomProps(VQ),VU._parseCustomProps(Vn,Vx,VQ,Va),VU._parseCustomComponent(Vn,Vx,Va.components)):VU._parseCustomProps(Vn,Vx,VQ,Va));var VV=Va.child;if(VV)for(var Vy=0,VR=VV.length;Vy<VR;Vy++){var VX=VG._createNodeByJson(Vn,VV[Vy],null,Vx);VU.addChild(VX)}return VU},VG._computeBoneAndAnimationDatasByBindPoseMatrxix=function(Vn,Va,VU,Vx,VD,Vp){var VQ,VV,Vy=0,VR=0,VX=Vn.length;for(VQ=0;VQ<VX;Vy+=Vn[VQ].keyframeWidth,VR+=16,VQ++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(Va[Vy+0],Va[Vy+1],Va[Vy+2],Va[Vy+3],Va[Vy+4],Va[Vy+5],Va[Vy+6],Va[Vy+7],Va[Vy+8],Va[Vy+9],Vx,VR),0!=VQ&&(VV=16*Vn[VQ].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(Vx,VV,Vx,VR,Vx,VR));var Vz=VU.length;for(VQ=0;VQ<Vz;VQ++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Vx,16*Vp[VQ],VU[VQ],VD,16*VQ)},VG._computeAnimationDatasByArrayAndMatrixFast=function(Vn,Va,VU,Vx){for(var VD=0,Vp=Vn.length;VD<Vp;VD++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Va,16*Vx[VD],Vn[VD],VU,16*VD)},VG._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(Vn,Va,VU,Vx,VD){var Vp,VQ,VV=0,Vy=0,VR=Vn.length;for(Vp=0;Vp<VR;VV+=Vn[Vp].keyframeWidth,Vy+=16,Vp++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(Va[VV+7],Va[VV+8],Va[VV+9],Va[VV+3],Va[VV+4],Va[VV+5],Va[VV+6],Va[VV+0],Va[VV+1],Va[VV+2],Vx,Vy),0!=Vp&&(VQ=16*Vn[Vp].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(Vx,VQ,Vx,Vy,Vx,Vy));var VX=VU.length;for(Vp=0;Vp<VX;Vp++){var Vz=16*Vp;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Vx,Vz,VU[Vp],VD,Vz)}},VG._computeAnimationDatasByArrayAndMatrixFastOld=function(Vn,Va,VU){for(var Vx=Vn.length,VD=0;VD<Vx;VD++){var Vp=16*VD;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Va,Vp,Vn[VD],VU,Vp)}},VG._computeRootAnimationData=function(Vn,Va,VU){for(var Vx=0,VD=0,Vp=0,VQ=Vn.length;Vx<VQ;VD+=Vn[Vx].keyframeWidth,Vp+=16,Vx++)laya.d3.utils.Utils3D.createAffineTransformationArray(Va[VD+0],Va[VD+1],Va[VD+2],Va[VD+3],Va[VD+4],Va[VD+5],Va[VD+6],Va[VD+7],Va[VD+8],Va[VD+9],VU,Vp)},VG.transformVector3ArrayByQuat=function(Vn,Va,VU,Vx,VD){var Vp=VU.elements,VQ=Vn[Va],VV=Vn[Va+1],Vy=Vn[Va+2],VR=Vp[0],VX=Vp[1],Vz=Vp[2],Vi=Vp[3],Vq=Vi*VQ+VX*Vy-Vz*VV,VE=Vi*VV+Vz*VQ-VR*Vy,Vm=Vi*Vy+VR*VV-VX*VQ,Vb=-VR*VQ-VX*VV-Vz*Vy;Vx[VD]=Vq*Vi+Vb*-VR+VE*-Vz-Vm*-VX,Vx[VD+1]=VE*Vi+Vb*-VX+Vm*-VR-Vq*-Vz,Vx[VD+2]=Vm*Vi+Vb*-Vz+Vq*-VX-VE*-VR},VG.mulMatrixByArray=function(Vn,Va,VU,Vx,VD,Vp){var VQ,VV,Vy,VR,VX;if(VD===VU){for(VU=VG._tempArray16_3,VQ=0;VQ<16;++VQ)VU[VQ]=VD[Vp+VQ];Vx=0}for(VQ=0;VQ<4;VQ++)VV=Vn[Va+VQ],Vy=Vn[Va+VQ+4],VR=Vn[Va+VQ+8],VX=Vn[Va+VQ+12],VD[Vp+VQ]=VV*VU[Vx+0]+Vy*VU[Vx+1]+VR*VU[Vx+2]+VX*VU[Vx+3],VD[Vp+VQ+4]=VV*VU[Vx+4]+Vy*VU[Vx+5]+VR*VU[Vx+6]+VX*VU[Vx+7],VD[Vp+VQ+8]=VV*VU[Vx+8]+Vy*VU[Vx+9]+VR*VU[Vx+10]+VX*VU[Vx+11],VD[Vp+VQ+12]=VV*VU[Vx+12]+Vy*VU[Vx+13]+VR*VU[Vx+14]+VX*VU[Vx+15]},VG.mulMatrixByArrayFast=function(Vn,Va,VU,Vx,VD,Vp){var VQ,VV,Vy,VR,VX;for(VQ=0;VQ<4;VQ++)VV=Vn[Va+VQ],Vy=Vn[Va+VQ+4],VR=Vn[Va+VQ+8],VX=Vn[Va+VQ+12],VD[Vp+VQ]=VV*VU[Vx+0]+Vy*VU[Vx+1]+VR*VU[Vx+2]+VX*VU[Vx+3],VD[Vp+VQ+4]=VV*VU[Vx+4]+Vy*VU[Vx+5]+VR*VU[Vx+6]+VX*VU[Vx+7],VD[Vp+VQ+8]=VV*VU[Vx+8]+Vy*VU[Vx+9]+VR*VU[Vx+10]+VX*VU[Vx+11],VD[Vp+VQ+12]=VV*VU[Vx+12]+Vy*VU[Vx+13]+VR*VU[Vx+14]+VX*VU[Vx+15]},VG.mulMatrixByArrayAndMatrixFast=function(Vn,Va,VU,Vx,VD){var Vp,VQ,VV,Vy,VR,VX=VU.elements,Vz=VX[0],Vi=VX[1],Vq=VX[2],VE=VX[3],Vm=VX[4],Vb=VX[5],VP=VX[6],VA=VX[7],VT=VX[8],VK=VX[9],VY=VX[10],VW=VX[11],Vk=VX[12],VN=VX[13],V_=VX[14],V$=VX[15],VM=Va,VZ=Va+4,Vu=Va+8,Vc=Va+12,VH=VD,VG=VD+4,VI=VD+8,Vv=VD+12;for(Vp=0;Vp<4;Vp++)VQ=Vn[VM+Vp],VV=Vn[VZ+Vp],Vy=Vn[Vu+Vp],VR=Vn[Vc+Vp],Vx[VH+Vp]=VQ*Vz+VV*Vi+Vy*Vq+VR*VE,Vx[VG+Vp]=VQ*Vm+VV*Vb+Vy*VP+VR*VA,Vx[VI+Vp]=VQ*VT+VV*VK+Vy*VY+VR*VW,Vx[Vv+Vp]=VQ*Vk+VV*VN+Vy*V_+VR*V$},VG.createAffineTransformationArray=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vz){var Vi=Vx+Vx,Vq=VD+VD,VE=Vp+Vp,Vm=Vx*Vi,Vb=Vx*Vq,VP=Vx*VE,VA=VD*Vq,VT=VD*VE,VK=Vp*VE,VY=VQ*Vi,VW=VQ*Vq,Vk=VQ*VE;VX[Vz+0]=(1-(VA+VK))*VV,VX[Vz+1]=(Vb+Vk)*VV,VX[Vz+2]=(VP-VW)*VV,VX[Vz+3]=0,VX[Vz+4]=(Vb-Vk)*Vy,VX[Vz+5]=(1-(Vm+VK))*Vy,VX[Vz+6]=(VT+VY)*Vy,VX[Vz+7]=0,VX[Vz+8]=(VP+VW)*VR,VX[Vz+9]=(VT-VY)*VR,VX[Vz+10]=(1-(Vm+VA))*VR,VX[Vz+11]=0,VX[Vz+12]=Vn,VX[Vz+13]=Va,VX[Vz+14]=VU,VX[Vz+15]=1},VG.transformVector3ArrayToVector3ArrayCoordinate=function(Vn,Va,VU,Vx,VD){var Vp=VG._tempArray4_0,VQ=Vn[Va+0],VV=Vn[Va+1],Vy=Vn[Va+2],VR=VU.elements;Vp[0]=VQ*VR[0]+VV*VR[4]+Vy*VR[8]+VR[12],Vp[1]=VQ*VR[1]+VV*VR[5]+Vy*VR[9]+VR[13],Vp[2]=VQ*VR[2]+VV*VR[6]+Vy*VR[10]+VR[14],Vp[3]=1/(VQ*VR[3]+VV*VR[7]+Vy*VR[11]+VR[15]),Vx[VD+0]=Vp[0]*Vp[3],Vx[VD+1]=Vp[1]*Vp[3],Vx[VD+2]=Vp[2]*Vp[3]},VG.transformLightingMapTexcoordByUV0Array=function(Vn,Va,VU,Vx,VD){var Vp=VU.elements;Vx[VD+0]=Vn[Va+0]*Vp[0]+Vp[2],Vx[VD+1]=(Vn[Va+1]-1)*Vp[1]+Vp[3]},VG.transformLightingMapTexcoordByUV1Array=function(Vn,Va,VU,Vx,VD){var Vp=VU.elements;Vx[VD+0]=Vn[Va+0]*Vp[0]+Vp[2],Vx[VD+1]=1+Vn[Va+1]*Vp[1]+Vp[3]},VG.getURLVerion=function(Vn){var Va=Vn.indexOf("?");return 0<=Va?Vn.substr(Va):null},VG._quaternionCreateFromYawPitchRollArray=function(Vn,Va,VU,Vx){var VD=.5*VU,Vp=.5*Va,VQ=.5*Vn,VV=Math.sin(VD),Vy=Math.cos(VD),VR=Math.sin(Vp),VX=Math.cos(Vp),Vz=Math.sin(VQ),Vi=Math.cos(VQ);Vx[0]=Vi*VR*Vy+Vz*VX*VV,Vx[1]=Vz*VX*Vy-Vi*VR*VV,Vx[2]=Vi*VX*VV-Vz*VR*Vy,Vx[3]=Vi*VX*Vy+Vz*VR*VV},VG._createAffineTransformationArray=function(Vn,Va,VU,Vx){var VD=Va[0],Vp=Va[1],VQ=Va[2],VV=Va[3],Vy=VD+VD,VR=Vp+Vp,VX=VQ+VQ,Vz=VD*Vy,Vi=VD*VR,Vq=VD*VX,VE=Vp*VR,Vm=Vp*VX,Vb=VQ*VX,VP=VV*Vy,VA=VV*VR,VT=VV*VX,VK=VU[0],VY=VU[1],VW=VU[2];Vx[0]=(1-(VE+Vb))*VK,Vx[1]=(Vi+VT)*VK,Vx[2]=(Vq-VA)*VK,Vx[3]=0,Vx[4]=(Vi-VT)*VY,Vx[5]=(1-(Vz+Vb))*VY,Vx[6]=(Vm+VP)*VY,Vx[7]=0,Vx[8]=(Vq+VA)*VW,Vx[9]=(Vm-VP)*VW,Vx[10]=(1-(Vz+VE))*VW,Vx[11]=0,Vx[12]=Vn[0],Vx[13]=Vn[1],Vx[14]=Vn[2],Vx[15]=1},VG._mulMatrixArray=function(Vn,Va,VU,Vx){var VD,Vp,VQ,VV,Vy,VR=Va.elements,VX=VR[0],Vz=VR[1],Vi=VR[2],Vq=VR[3],VE=VR[4],Vm=VR[5],Vb=VR[6],VP=VR[7],VA=VR[8],VT=VR[9],VK=VR[10],VY=VR[11],VW=VR[12],Vk=VR[13],VN=VR[14],V_=VR[15],V$=Vx,VM=Vx+4,VZ=Vx+8,Vu=Vx+12;for(VD=0;VD<4;VD++)Vp=Vn[VD],VQ=Vn[VD+4],VV=Vn[VD+8],Vy=Vn[VD+12],VU[V$+VD]=Vp*VX+VQ*Vz+VV*Vi+Vy*Vq,VU[VM+VD]=Vp*VE+VQ*Vm+VV*Vb+Vy*VP,VU[VZ+VD]=Vp*VA+VQ*VT+VV*VK+Vy*VY,VU[Vu+VD]=Vp*VW+VQ*Vk+VV*VN+Vy*V_},VG.getYawPitchRoll=function(Vn,Va){VG.transformQuat(VQa.ForwardRH,Vn,VUa.TEMPVector31),VG.transformQuat(VQa.Up,Vn,VUa.TEMPVector32);var VU=VUa.TEMPVector32.elements;VG.angleTo(VQa.ZERO,VUa.TEMPVector31,VUa.TEMPVector33);var Vx=VUa.TEMPVector33.elements;Vx[0]==Math.PI/2?(Vx[1]=VG.arcTanAngle(VU[2],VU[0]),Vx[2]=0):Vx[0]==-Math.PI/2?(Vx[1]=VG.arcTanAngle(-VU[2],-VU[0]),Vx[2]=0):(Vna.createRotationY(-Vx[1],VUa.TEMPMatrix0),Vna.createRotationX(-Vx[0],VUa.TEMPMatrix1),VQa.transformCoordinate(VUa.TEMPVector32,VUa.TEMPMatrix0,VUa.TEMPVector32),VQa.transformCoordinate(VUa.TEMPVector32,VUa.TEMPMatrix1,VUa.TEMPVector32),Vx[2]=VG.arcTanAngle(VU[1],-VU[0])),Vx[1]<=-Math.PI&&(Vx[1]=Math.PI),Vx[2]<=-Math.PI&&(Vx[2]=Math.PI),Vx[1]>=Math.PI&&Vx[2]>=Math.PI&&(Vx[1]=0,Vx[2]=0,Vx[0]=Math.PI-Vx[0]),Va[0]=Vx[1],Va[1]=Vx[0],Va[2]=Vx[2]},VG.arcTanAngle=function(Vn,Va){return 0==Vn?1==Va?Math.PI/2:-Math.PI/2:0<Vn?Math.atan(Va/Vn):Vn<0?0<Va?Math.atan(Va/Vn)+Math.PI:Math.atan(Va/Vn)-Math.PI:0},VG.angleTo=function(Vn,Va,VU){VQa.subtract(Va,Vn,VUa.TEMPVector30),VQa.normalize(VUa.TEMPVector30,VUa.TEMPVector30),VU.elements[0]=Math.asin(VUa.TEMPVector30.y),VU.elements[1]=VG.arcTanAngle(-VUa.TEMPVector30.z,-VUa.TEMPVector30.x)},VG.transformQuat=function(Vn,Va,VU){var Vx=VU.elements,VD=Vn.elements,Vp=Va,VQ=VD[0],VV=VD[1],Vy=VD[2],VR=Vp[0],VX=Vp[1],Vz=Vp[2],Vi=Vp[3],Vq=Vi*VQ+VX*Vy-Vz*VV,VE=Vi*VV+Vz*VQ-VR*Vy,Vm=Vi*Vy+VR*VV-VX*VQ,Vb=-VR*VQ-VX*VV-Vz*Vy;Vx[0]=Vq*Vi+Vb*-VR+VE*-Vz-Vm*-VX,Vx[1]=VE*Vi+Vb*-VX+Vm*-VR-Vq*-Vz,Vx[2]=Vm*Vi+Vb*-Vz+Vq*-VX-VE*-VR},VG.quaterionNormalize=function(Vn,Va){var VU=Vn[0],Vx=Vn[1],VD=Vn[2],Vp=Vn[3],VQ=VU*VU+Vx*Vx+VD*VD+Vp*Vp;0<VQ&&(VQ=1/Math.sqrt(VQ),Va[0]=VU*VQ,Va[1]=Vx*VQ,Va[2]=VD*VQ,Va[3]=Vp*VQ)},VG.matrix4x4MultiplyFFF=function(Vn,Va,VU){var Vx,VD,Vp,VQ,VV;if(VU===Va)for(Va=new Float32Array(16),Vx=0;Vx<16;++Vx)Va[Vx]=VU[Vx];for(Vx=0;Vx<4;Vx++)VD=Vn[Vx],Vp=Vn[Vx+4],VQ=Vn[Vx+8],VV=Vn[Vx+12],VU[Vx]=VD*Va[0]+Vp*Va[1]+VQ*Va[2]+VV*Va[3],VU[Vx+4]=VD*Va[4]+Vp*Va[5]+VQ*Va[6]+VV*Va[7],VU[Vx+8]=VD*Va[8]+Vp*Va[9]+VQ*Va[10]+VV*Va[11],VU[Vx+12]=VD*Va[12]+Vp*Va[13]+VQ*Va[14]+VV*Va[15]},VG.matrix4x4MultiplyMFM=function(Vn,Va,VU){VG.matrix4x4MultiplyFFF(Vn.elements,Va,VU.elements)},Vz(VG,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new VQa},"_tempVector3_1",function(){return this._tempVector3_1=new VQa},"_tempVector3_2",function(){return this._tempVector3_2=new VQa},"_tempVector3_3",function(){return this._tempVector3_3=new VQa},"_tempVector3_4",function(){return this._tempVector3_4=new VQa},"_tempVector3_5",function(){return this._tempVector3_5=new VQa},"_tempVector3_6",function(){return this._tempVector3_6=new VQa},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),VG}(),VPa=function(){function Vc(){}return Vq(Vc,"Laya3D"),Vc._cancelLoadByUrl=function(Vn){VY.loader.cancelLoadByUrl(Vn),Vc._innerFirstLevelLoaderManager.cancelLoadByUrl(Vn),Vc._innerSecondLevelLoaderManager.cancelLoadByUrl(Vn),Vc._innerThirdLevelLoaderManager.cancelLoadByUrl(Vn),Vc._innerFourthLevelLoaderManager.cancelLoadByUrl(Vn)},Vc._changeWebGLSize=function(Vn,Va){Vu.onStageResize(Vn,Va),Vs.clientWidth=Vn,Vs.clientHeight=Va},Vc.__init__=function(){var Vn=Va.createMap;Vn.lh=[Vva,"SPRITE3DHIERARCHY"],Vn.ls=[VIa,"SPRITE3DHIERARCHY"],Vn.lm=[Voa,"MESH"],Vn.lmat=[Vja,"MATERIAL"],Vn.jpg=[VOa,"nativeimage"],Vn.jpeg=[VOa,"nativeimage"],Vn.png=[VOa,"nativeimage"],Vn.pkm=[VOa,"arraybuffer"],Vn.raw=[VFa,"arraybuffer"],Vn.mipmaps=[VFa,"arraybuffer"],VP.parserMap.SPRITE3DHIERARCHY=Vc._loadHierarchy,VP.parserMap.MESH=Vc._loadMesh,VP.parserMap.MATERIAL=Vc._loadMaterial,VP.parserMap.TEXTURECUBE=Vc._loadTextureCube,VP.parserMap.TERRAIN=Vc._loadTerrain,Vc._innerFirstLevelLoaderManager.on("error",null,Vc._eventLoadManagerError),Vc._innerSecondLevelLoaderManager.on("error",null,Vc._eventLoadManagerError),Vc._innerThirdLevelLoaderManager.on("error",null,Vc._eventLoadManagerError),Vc._innerFourthLevelLoaderManager.on("error",null,Vc._eventLoadManagerError)},Vc.READ_BLOCK=function(){return Vc._readData.pos+=4,!0},Vc.READ_DATA=function(){return Vc._DATA.offset=Vc._readData.getUint32(),Vc._DATA.size=Vc._readData.getUint32(),!0},Vc.READ_STRINGS=function(){var Vn=[],Va={offset:0,size:0};Va.offset=Vc._readData.getUint16(),Va.size=Vc._readData.getUint16();Vc._readData.pos;Vc._readData.pos=Va.offset+Vc._DATA.offset;for(var VU=0;VU<Va.size;VU++){var Vx=Vc._readData.readUTFString();-1===Vx.lastIndexOf(".lmat")&&-1===Vx.lastIndexOf(".lpbr")||Vn.push(Vx)}return Vn},Vc.formatRelativePath=function(Vn,Va){var VU;if("."===Va.charAt(0)){for(var Vx=(Vn+Va).split("/"),VD=0,Vp=Vx.length;VD<Vp;VD++)if(".."==Vx[VD]){var VQ=VD-1;0<VQ&&".."!==Vx[VQ]&&(Vx.splice(VQ,2),VD-=2)}VU=Vx.join("/")}else VU=Vn+Va;return null!=VZ.customFormat&&(VU=VZ.customFormat(VU,null)),VU},Vc._eventLoadManagerError=function(Vn){VY.loader.event("error",Vn)},Vc._addHierarchyInnerUrls=function(Vn,Va,VU,Vx,VD,Vp){var VQ=Vc.formatRelativePath(Vx,VD);VU&&(VQ+=VU),Vn.push({url:VQ,clas:Vp}),Va[VD]=VQ},Vc._getSprite3DHierarchyInnerUrls=function(Vn,Va,VU,Vx,VD,Vp,VQ){var VV,Vy=0,VR=0;switch(Vn.type){case"Scene":var VX=Vn.customProps.lightmaps;for(Vy=0,VR=VX.length;Vy<VR;Vy++){var Vz=VX[Vy].replace(".exr",".png");Vc._addHierarchyInnerUrls(Vx,VD,Vp,VQ,Vz,VOa)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var Vi;if(Vn.instanceParams)(Vi=Vn.instanceParams.loadPath)&&Vc._addHierarchyInnerUrls(Va,VD,Vp,VQ,Vi,Voa);else{(Vi=(VV=Vn.customProps).meshPath)&&Vc._addHierarchyInnerUrls(Va,VD,Vp,VQ,Vi,Voa);var Vq=VV.materials;if(Vq)for(Vy=0,VR=Vq.length;Vy<VR;Vy++){for(var VE=Vq[Vy],Vm=VE.type.split("."),Vb=VH.window,VP=0,VA=Vm.length;VP<VA;++VP){Vb=Vb[this.clasPaths[VP]]}if("function"!=typeof Vb)throw"_getSprite3DHierarchyInnerUrls 错误: "+VE.type+" 不是类";Vc._addHierarchyInnerUrls(VU,VD,Vp,VQ,VE.path,Vb)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var VT=(VV=Vn.customProps).meshPath;VT&&Vc._addHierarchyInnerUrls(Va,VD,Vp,VQ,VT,Voa);var VK=VV.material;if(VK){Vm=VK.type.split("."),Vb=VH.window;for(VP=0,VA=Vm.length;VP<VA;++VP){Vb=Vb[this.clasPaths[VP]]}Vc._addHierarchyInnerUrls(VU,VD,Vp,VQ,VK.path,Vb)}else{var VY=VV.materialPath;if(VY)Vc._addHierarchyInnerUrls(VU,VD,Vp,VQ,VY,ShurikenParticleMaterial);else{var VW=VV.texturePath;VW&&Vc._addHierarchyInnerUrls(Vx,VD,Vp,VQ,VW,VOa)}}break;case"Terrain":Vc._addHierarchyInnerUrls(Vx,VD,Vp,VQ,Vn.customProps.dataPath,TerrainRes)}var Vk=Vn.components;for(var VN in Vk){var V_=Vk[VN];switch(VN){case"Animator":var V$=V_.avatarPath;if(V$)Vc._addHierarchyInnerUrls(Vx,VD,Vp,VQ,V$,Avatar);else{var VM=V_.avatar;VM&&Vc._addHierarchyInnerUrls(Vx,VD,Vp,VQ,VM.path,Avatar)}var VZ=V_.clipPaths;for(Vy=0,VR=VZ.length;Vy<VR;Vy++)Vc._addHierarchyInnerUrls(Vx,VD,Vp,VQ,VZ[Vy],AnimationClip)}}var Vu=Vn.child;for(Vy=0,VR=Vu.length;Vy<VR;Vy++)Vc._getSprite3DHierarchyInnerUrls(Vu[Vy],Va,VU,Vx,VD,Vp,VQ)},Vc._loadHierarchy=function(Vn){Vn.on("loaded",null,Vc._onHierarchylhLoaded,[Vn,Vn._class._getGroup()]),Vn.load(Vn.url,"json",!1,null,!0)},Vc._onHierarchylhLoaded=function(Vn,Va,VU){if(Vn._class.destroyed)Vn.endLoad();else{var Vx=Vn.url,VD=Vba.getURLVerion(Vx),Vp=VZ.getPath(Vx),VQ=[],VV=[],Vy=[],VR={};Vc._getSprite3DHierarchyInnerUrls(VU,VQ,VV,Vy,VR,VD,Vp);var VX=VQ.length+VV.length+Vy.length,Vz=VX+1,Vi=1/Vz;if(Vc._onProcessChange(Vn,0,Vi,1),0<Vy.length){var Vq=VX/Vz,VE=VM.create(null,Vc._onProcessChange,[Vn,Vi,Vq],!1);Vc._innerFourthLevelLoaderManager.create(Vy,VM.create(null,Vc._onHierarchyInnerForthLevResouLoaded,[Vn,Va,VE,VU,VR,VQ,VV,Vi+Vq*Vy.length,Vq]),VE,null,null,1,!0,Va)}else Vc._onHierarchyInnerForthLevResouLoaded(Vn,Va,null,VU,VR,VQ,VV,Vi,Vq)}},Vc._onHierarchyInnerForthLevResouLoaded=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){if(Vn._class.destroyed)Vn.endLoad();else if(VU&&VU.recover(),0<VQ.length){var VR=VM.create(null,Vc._onProcessChange,[Vn,VV,Vy],!1);Vc._innerSecondLevelLoaderManager.create(VQ,VM.create(null,Vc._onHierarchyInnerSecondLevResouLoaded,[Vn,Va,VR,Vx,VD,Vp,VV+Vy*VQ.length,Vy]),VU,null,null,1,!0,Va)}else Vc._onHierarchyInnerSecondLevResouLoaded(Vn,Va,null,Vx,VD,Vp,VV,Vy)},Vc._onHierarchyInnerSecondLevResouLoaded=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV){if(Vn._class.destroyed)Vn.endLoad();else if(VU&&VU.recover(),0<Vp.length){var Vy=VM.create(null,Vc._onProcessChange,[Vn,VQ,VV],!1);Vc._innerFirstLevelLoaderManager.create(Vp,VM.create(null,Vc._onHierarchyInnerFirstLevResouLoaded,[Vn,Vy,Vx,VD]),VU,null,null,1,!0,Va)}else Vc._onHierarchyInnerFirstLevResouLoaded(Vn,null,Vx,VD)},Vc._onHierarchyInnerFirstLevResouLoaded=function(Vn,Va,VU,Vx){Va&&Va.recover(),Vn.endLoad([VU,Vx])},Vc._loadTerrain=function(Vn){Vn.on("loaded",null,Vc._onTerrainLtLoaded,[Vn,Vn._class._getGroup()]),Vn.load(Vn.url,"json",!1,null,!0)},Vc._onTerrainLtLoaded=function(Vn,Va,VU){if(Vn._class.destroyed)Vn.endLoad();else{var Vx,VD,Vp=Vn.url,VQ=Vba.getURLVerion(Vp),VV=VZ.getPath(Vp),Vy=[],VR={},VX=0,Vz=0,Vi=VU.heightData;Vx=Vi.url,VD=Vc.formatRelativePath(VV,Vx),VQ&&(VD+=VQ),Vx=VR[Vx]=VD;var Vq=VU.detailTexture;for(VX=0,Vz=Vq.length;VX<Vz;VX++)Vy.push({url:Vq[VX].diffuse});var VE=VU.normalMap;for(VX=0,Vz=VE.length;VX<Vz;VX++)Vy.push({url:VE[VX]});var Vm=VU.alphaMap;for(VX=0,Vz=Vm.length;VX<Vz;VX++)Vy.push({url:Vm[VX],params:[!1,!1,6408,!0]});for(VX=0,Vz=Vy.length;VX<Vz;VX++){var Vb=Vy[VX].url;VD=Vc.formatRelativePath(VV,Vb),VQ&&(VD+=VQ),Vy[VX].url=VD,VR[Vb]=VD}var VP=Vy.length,VA=VP+2,VT=1/VA;Vc._onProcessChange(Vn,0,VT,1);var VK={heightMapLoaded:!1,texturesLoaded:!1},VY=VM.create(null,Vc._onProcessChange,[Vn,VT,VT],!1);Vc._innerFourthLevelLoaderManager.create(Vx,VM.create(null,Vc._onTerrainHeightMapLoaded,[Vn,VY,VU,VR,VK]),VY,null,[Vi.numX,Vi.numZ,Vi.bitType,Vi.value],1,!0,Va);var VW=VM.create(null,Vc._onProcessChange,[Vn,2*VT,VP/VA],!1);Vc._innerFourthLevelLoaderManager.create(Vy,VM.create(null,Vc._onTerrainTexturesLoaded,[Vn,VW,VU,VR,VK]),VW,null,null,1,!0,Va)}},Vc._onTerrainHeightMapLoaded=function(Vn,Va,VU,Vx,VD){VD.heightMapLoaded=!0,VD.texturesLoaded&&(Vn.endLoad([VU,Vx]),Va.recover())},Vc._onTerrainTexturesLoaded=function(Vn,Va,VU,Vx,VD){VD.texturesLoaded=!0,VD.heightMapLoaded&&(Vn.endLoad([VU,Vx]),Va.recover())},Vc._loadMesh=function(Vn){Vn.on("loaded",null,Vc._onMeshLmLoaded,[Vn,Vn._class._getGroup()]),Vn.load(Vn.url,"arraybuffer",!1,null,!0)},Vc._onMeshLmLoaded=function(Vn,Va,VU){if(Vn._class.destroyed)Vn.endLoad();else{var Vx,VD,Vp,VQ=Vn.url,VV=Vba.getURLVerion(VQ),Vy=VZ.getPath(VQ),VR={},VX=0,Vz=0;switch((Vc._readData=new VW(VU)).pos=0,Vc._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var Vi=Vc._readData.getUint32();Vc._readData.pos=Vc._readData.pos+4,Vz=Vc._readData.getUint16(),Vc._readData.pos=Vc._readData.pos+8*Vz;var Vq=Vc._readData.getUint32();for(Vz=Vc._readData.getUint16(),Vc._readData.pos=Vi+Vq,Vx=[],VX=0;VX<Vz;VX++){var VE=Vc._readData.readUTFString();-1!==VE.lastIndexOf(".lmat")&&Vx.push(VE)}break;default:for(Vc.READ_BLOCK(),VX=0;VX<2;VX++){var Vm=Vc._readData.getUint16(),Vb=Vc._strings[Vm],VP=Vc["READ_"+Vb];if(null==VP)throw new Error("model file err,no this function:"+Vm+" "+Vb);1===VX?Vx=VP.call():VP.call()}}for(VX=0,Vp=Vx.length;VX<Vp;VX++){var VA=Vx[VX];VD=Vc.formatRelativePath(Vy,VA),VV&&(VD+=VV),Vx[VX]=VD,VR[VA]=VD}if(0<Vx.length){Vc._onProcessChange(Vn,0,.5,1);var VT=VM.create(null,Vc._onProcessChange,[Vn,.5,.5],!1);Vc._innerSecondLevelLoaderManager.create(Vx,VM.create(null,Vc._onMeshMateialLoaded,[Vn,VT,VU,VR]),VT,null,null,1,!0,Va)}else Vn.endLoad([VU,VR])}},Vc._onMeshMateialLoaded=function(Vn,Va,VU,Vx){Vn.endLoad([VU,Vx]),Va.recover()},Vc._getMaterialTexturePath=function(Vn,Va,VU){var Vx=Vn.length-4;return Vn.indexOf(".dds")!=Vx&&Vn.indexOf(".tga")!=Vx&&Vn.indexOf(".exr")!=Vx&&Vn.indexOf(".DDS")!=Vx&&Vn.indexOf(".TGA")!=Vx&&Vn.indexOf(".EXR")!=Vx||(Vn=Vn.substr(0,Vx)+".png"),Vn=Vc.formatRelativePath(VU,Vn),Va&&(Vn+=Va),Vn},Vc._loadMaterial=function(Vn){Vn.on("loaded",null,Vc._onMaterilLmatLoaded,[Vn,Vn._class._getGroup()]),Vn.load(Vn.url,"json",!1,null,!0)},Vc._onMaterilLmatLoaded=function(Vn,Va,VU){if(Vn._class.destroyed)Vn.endLoad();else{var Vx,VD=Vn.url,Vp=Vba.getURLVerion(VD),VQ=VZ.getPath(VD),VV=[],Vy={},VR=VU.customProps,VX=VU.version;if(VX)switch(VX){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var Vz=VU.props.textures,Vi=0,Vq=Vz.length;Vi<Vq;Vi++){var VE=Vz[Vi],Vm=VE.path;if(Vm){var Vb=Vm.length-4;Vm.indexOf(".exr")!=Vb&&Vm.indexOf(".EXR")!=Vb||(Vm=Vm.substr(0,Vb)+".png"),Vx=Vc.formatRelativePath(VQ,Vm),Vp&&(Vx+=Vp),VV.push({url:Vx,params:VE.params}),Vy[Vm]=Vx}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var VP=VR.diffuseTexture.texture2D;if(VP&&(Vx=Vc._getMaterialTexturePath(VP,Vp,VQ),VV.push(Vx),Vy[VP]=Vx),VR.normalTexture){var VA=VR.normalTexture.texture2D;VA&&(Vx=Vc._getMaterialTexturePath(VA,Vp,VQ),VV.push(Vx),Vy[VA]=Vx)}if(VR.specularTexture){var VT=VR.specularTexture.texture2D;VT&&(Vx=Vc._getMaterialTexturePath(VT,Vp,VQ),VV.push(Vx),Vy[VT]=Vx)}if(VR.emissiveTexture){var VK=VR.emissiveTexture.texture2D;VK&&(Vx=Vc._getMaterialTexturePath(VK,Vp,VQ),VV.push(Vx),Vy[VK]=Vx)}if(VR.ambientTexture){var VY=VR.ambientTexture.texture2D;VY&&(Vx=Vc._getMaterialTexturePath(VY,Vp,VQ),VV.push(Vx),Vy[VY]=Vx)}if(VR.reflectTexture){var VW=VR.reflectTexture.texture2D;VW&&(Vx=Vc._getMaterialTexturePath(VW,Vp,VQ),VV.push(Vx),Vy[VW]=Vx)}}var Vk=VV.length,VN=Vk+1,V_=1/VN;if(Vc._onProcessChange(Vn,0,V_,1),0<Vk){var V$=VM.create(null,Vc._onProcessChange,[Vn,V_,Vk/VN],!1);Vc._innerFourthLevelLoaderManager.create(VV,VM.create(null,Vc._onMateialTexturesLoaded,[Vn,V$,VU,Vy]),V$,VOa,null,1,!0,Va)}else Vc._onMateialTexturesLoaded(Vn,null,VU,null)}},Vc._onMateialTexturesLoaded=function(Vn,Va,VU,Vx){Vn.endLoad([VU,Vx]),Va&&Va.recover()},Vc._loadTextureCube=function(Vn){Vn.on("loaded",null,Vc._onTextureCubeLtcLoaded,[Vn]),Vn.load(Vn.url,"json",!1,null,!0)},Vc._onTextureCubeLtcLoaded=function(Vn,Va){if(Vn._class.destroyed)Vn.endLoad();else{var VU=VZ.getPath(Vn.url),Vx=[Vc.formatRelativePath(VU,Va.px),Vc.formatRelativePath(VU,Va.nx),Vc.formatRelativePath(VU,Va.py),Vc.formatRelativePath(VU,Va.ny),Vc.formatRelativePath(VU,Va.pz),Vc.formatRelativePath(VU,Va.nz)];Vc._onProcessChange(Vn,0,1/7,1);var VD=VM.create(null,Vc._onProcessChange,[Vn,1/7,6/7],!1);Vc._innerFourthLevelLoaderManager.load(Vx,VM.create(null,Vc._onTextureCubeImagesLoaded,[Vn,Vx,VD]),VD,"nativeimage")}},Vc._onTextureCubeImagesLoaded=function(Vn,Va,VU){var Vx=[];Vx.length=6;for(var VD=0;VD<6;VD++){var Vp=Va[VD];Vx[VD]=VP.getRes(Vp),VP.clearRes(Vp)}Vn.endLoad(Vx),VU.recover()},Vc._onProcessChange=function(Vn,Va,VU,Vx){(Vx=Va+Vx*VU)<1&&Vn.event("progress",Vx)},Vc.init=function(Vn,Va,VU,Vx,VD,Vp){if(void 0===VU&&(VU=!1),void 0===Vx&&(Vx=!1),void 0===VD&&(VD=!0),void 0===Vp&&(Vp=!0),VA.update3DLoop=function(){},VA.cancelLoadByUrl=function(Vn){Vc._cancelLoadByUrl(Vn)},Vy.isAntialias=VU,Vy.isAlpha=Vx,Vy.premultipliedAlpha=VD,Vy.isStencil=Vp,!Vu.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");VA.changeWebGLSize=Vc._changeWebGLSize,Vm.is3DMode=!0,VY.init(Vn,Va),VG.__init__(),Vza.__init__(),Vwa.__init__(),Vg.__init__(),Vc.__init__(),VQ.maxTextureCount=2,(Vc.debugMode||VC.debugMode)&&(Vc._debugPhasorSprite=new Vd)},Vc.HIERARCHY="SPRITE3DHIERARCHY",Vc.MESH="MESH",Vc.MATERIAL="MATERIAL",Vc.PBRMATERIAL="PBRMTL",Vc.TEXTURECUBE="TEXTURECUBE",Vc.TERRAIN="TERRAIN",Vc._readData=null,Vc._debugPhasorSprite=null,Vc.debugMode=!1,Vz(Vc,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new Va},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new Va},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new Va},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new Va}]),Vc}(),VAa=function(Vn){function VD(Vn){VD.__super.call(this),this._owner=Vn,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}Vq(VD,"laya.d3.animation.AnimationTransform3D",Vp);var Va=VD.prototype;return Va._getlocalMatrix=function(){return this._localUpdate&&(Vba._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},Va._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var Vn=0,Va=this._childs.length;Vn<Va;Vn++)this._childs[Vn]._onWorldTransform()}},Va._setWorldMatrixAndUpdate=function(Vn){if(this._worldMatrix=Vn,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var Va=this._getlocalMatrix(),VU=0;VU<16;++VU)this._worldMatrix[VU]=Va[VU];else Vba.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},Va._setWorldMatrixNoUpdate=function(Vn){this._worldMatrix=Vn},Va._setWorldMatrixIgnoreUpdate=function(Vn){this._worldMatrix=Vn,this._worldUpdate=!1},Va.getLocalPosition=function(){return this._localPosition},Va.setLocalPosition=function(Vn){if(this._parent)this._localPosition=Vn,this._localUpdate=!0,this._onWorldTransform();else{var Va=this._entity.owner._transform,VU=this._entity.localPosition,Vx=VU.elements;Vx[0]=Vn[0],Vx[1]=Vn[1],Vx[2]=Vn[2],Va.localPosition=VU}},Va.getLocalRotation=function(){if(this._localQuaternionUpdate){var Vn=this._localRotationEuler;Vba._quaternionCreateFromYawPitchRollArray(Vn[1]/VD._angleToRandin,Vn[0]/VD._angleToRandin,Vn[2]/VD._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},Va.setLocalRotation=function(Vn){if(this._parent)this._localRotation=Vn,Vba.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var Va=this._entity.owner._transform,VU=this._entity.localRotation,Vx=VU.elements;Vx[0]=Vn[0],Vx[1]=Vn[1],Vx[2]=Vn[2],Vx[3]=Vn[3],Va.localRotation=VU}},Va.getLocalScale=function(){return this._localScale},Va.setLocalScale=function(Vn){if(this._parent)this._localScale=Vn,this._localUpdate=!0,this._onWorldTransform();else{var Va=this._entity.owner._transform,VU=this._entity.localScale,Vx=VU.elements;Vx[0]=Vn[0],Vx[1]=Vn[1],Vx[2]=Vn[2],Va.localScale=VU}},Va.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){Vba.getYawPitchRoll(this._localRotation,VD._tempVector3);var Vn=VD._tempVector3,Va=this._localRotationEuler;Va[0]=Vn[1]*VD._angleToRandin,Va[1]=Vn[0]*VD._angleToRandin,Va[2]=Vn[2]*VD._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},Va.setLocalRotationEuler=function(Vn){if(this._parent)Vba._quaternionCreateFromYawPitchRollArray(Vn[1]/VD._angleToRandin,Vn[0]/VD._angleToRandin,Vn[2]/VD._angleToRandin,this._localRotation),this._localRotationEuler=Vn,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var Va=this._entity.owner._transform,VU=this._entity.localRotationEuler,Vx=VU.elements;Vx[0]=Vn[0],Vx[1]=Vn[1],Vx[2]=Vn[2],Va.localRotationEuler=VU}},Va.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)Vba.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var Vn=this._getlocalMatrix(),Va=0;Va<16;++Va)this._worldMatrix[Va]=Vn[Va];this._worldUpdate=!1}return this._worldMatrix},Va.setParent=function(Vn){if(this._parent!==Vn){if(this._parent){var Va=this._parent._childs,VU=Va.indexOf(this);Va.splice(VU,1)}Vn&&(Vn._childs.push(this),Vn&&this._onWorldTransform()),this._parent=Vn}},Vz(VD,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),VD}(),VTa=function(Vn){function Va(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,Va.__super.call(this),this._destroyed=!1,this._id=Va._uniqueIDCounter,Va._uniqueIDCounter++}Vq(Va,"laya.d3.component.Component3D",Vp);var VU=Va.prototype;return VY.imps(VU,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),VU._initialize=function(Vn){this._owner=Vn,this._enable=!0,this.started=!1,this._load(Vn)},VU._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},VU._load=function(Vn){},VU._start=function(Vn){},VU._update=function(Vn){},VU._lateUpdate=function(Vn){},VU._preRenderUpdate=function(Vn){},VU._postRenderUpdate=function(Vn){},VU._unload=function(Vn){this.offAll()},VU._cloneTo=function(Vn){},VE(0,VU,"id",function(){return this._id}),VE(0,VU,"destroyed",function(){return this._destroyed}),VE(0,VU,"owner",function(){return this._owner}),VE(0,VU,"enable",function(){return this._enable},function(Vn){this._enable!==Vn&&(this._enable=Vn,this.event("enablechanged",this._enable))}),VE(0,VU,"isSingleton",function(){return Va._isSingleton}),Va._isSingleton=!0,Va._uniqueIDCounter=1,Va}(),VKa=function(Vn){function Va(){this._destroyed=!1,Va.__super.call(this),this._destroyed=!1}Vq(Va,"laya.d3.core.GeometryFilter",Vp);var VU=Va.prototype;return VY.imps(VU,{"laya.resource.IDestroy":!0}),VU._destroy=function(){this.offAll(),this._destroyed=!0},VE(0,VU,"_isAsyncLoaded",function(){return!0}),VE(0,VU,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),VE(0,VU,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),VE(0,VU,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),VE(0,VU,"destroyed",function(){return this._destroyed}),Va}(),VYa=function(Vn){function Vx(Vn){Vx.__super.call(this),this._id=++Vx._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new VCn(new VQa,new VQa),this._boundingBoxCenter=new VQa,this._boundingSphere=new Vrn(new VQa,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=Vn,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}Vq(Vx,"laya.d3.core.render.BaseRender",Vp);var Va=Vx.prototype;return VY.imps(Va,{"laya.resource.IDestroy":!0}),Va._changeMaterialReference=function(Vn,Va){Vn&&Vn._removeReference(),Va._addReference()},Va._getInstanceMaterial=function(Vn,Va){var VU=new Vn.constructor;return Vn.cloneTo(VU),VU.name=VU.name+"(Instance)",this._materialsInstance[Va]=!0,this._changeMaterialReference(this._materials[Va],VU),this._materials[Va]=VU},Va._setShaderValuelightMap=function(Vn){this._setShaderValueTexture(3,Vn)},Va._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},Va._renderRenderableBoundBox=function(){var Vn=VPa._debugPhasorSprite,Va=this.boundingBox,VU=Vx._tempBoundBoxCorners;Va.getCorners(VU),Vn.line(VU[0],Vx._greenColor,VU[1],Vx._greenColor),Vn.line(VU[2],Vx._greenColor,VU[3],Vx._greenColor),Vn.line(VU[4],Vx._greenColor,VU[5],Vx._greenColor),Vn.line(VU[6],Vx._greenColor,VU[7],Vx._greenColor),Vn.line(VU[0],Vx._greenColor,VU[3],Vx._greenColor),Vn.line(VU[1],Vx._greenColor,VU[2],Vx._greenColor),Vn.line(VU[2],Vx._greenColor,VU[6],Vx._greenColor),Vn.line(VU[3],Vx._greenColor,VU[7],Vx._greenColor),Vn.line(VU[0],Vx._greenColor,VU[4],Vx._greenColor),Vn.line(VU[1],Vx._greenColor,VU[5],Vx._greenColor),Vn.line(VU[4],Vx._greenColor,VU[7],Vx._greenColor),Vn.line(VU[5],Vx._greenColor,VU[6],Vx._greenColor)},Va._calculateBoundingSphere=function(){throw"BaseRender: must override it."},Va._calculateBoundingBox=function(){throw"BaseRender: must override it."},Va._setShaderValueTexture=function(Vn,Va){this._owner._shaderValues.setValue(Vn,Va)},Va._setShaderValueMatrix4x4=function(Vn,Va){this._owner._shaderValues.setValue(Vn,Va?Va.elements:null)},Va._setShaderValueColor=function(Vn,Va){this._owner._shaderValues.setValue(Vn,Va?Va.elements:null)},Va._setShaderValueBuffer=function(Vn,Va){this._owner._shaderValues.setValue(Vn,Va)},Va._setShaderValueInt=function(Vn,Va){this._owner._shaderValues.setValue(Vn,Va)},Va._setShaderValueBool=function(Vn,Va){this._owner._shaderValues.setValue(Vn,Va)},Va._setShaderValueNumber=function(Vn,Va){this._owner._shaderValues.setValue(Vn,Va)},Va._setShaderValueVector2=function(Vn,Va){this._owner._shaderValues.setValue(Vn,Va?Va.elements:null)},Va._addShaderDefine=function(Vn){this._owner._shaderDefineValue|=Vn},Va._removeShaderDefine=function(Vn){this._owner._shaderDefineValue&=~Vn},Va._renderUpdate=function(Vn){return!0},Va._applyLightMapParams=function(){if(0<=this._lightmapIndex){var Vn=this._owner.scene;if(Vn){var Va=Vn.getlightmaps()[this._lightmapIndex];Va?(this._addShaderDefine(Vda.SAHDERDEFINE_LIGHTMAP),Va.loaded?this._setShaderValuelightMap(Va):Va.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(Vda.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(Vda.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(Vda.SAHDERDEFINE_LIGHTMAP)},Va._updateOctreeNode=function(){var Vn=this._treeNode;Vn&&this._octreeNodeNeedChange&&(Vn.updateObject(this),this._octreeNodeNeedChange=!1)},Va._destroy=function(){this.offAll();var Vn=0,Va=0;for(Vn=0,Va=this._renderElements.length;Vn<Va;Vn++)this._renderElements[Vn]._destroy();for(Vn=0,Va=this._materials.length;Vn<Va;Vn++)this._materials[Vn]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},VE(0,Va,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),VE(0,Va,"id",function(){return this._id}),VE(0,Va,"material",function(){var Vn=this._materials[0];if(Vn&&!this._materialsInstance[0]){var Va=this._getInstanceMaterial(Vn,0);this.event("materialchanged",[this,0,Va])}return this._materials[0]},function(Vn){this.sharedMaterial=Vn}),VE(0,Va,"sharedMaterial",function(){return this._materials[0]},function(Vn){var Va=this._materials[0];Va!==Vn&&(this._materials[0]=Vn,this._materialsInstance[0]=!1,this._changeMaterialReference(Va,Vn),this.event("materialchanged",[this,0,Vn]))}),VE(0,Va,"lightmapIndex",function(){return this._lightmapIndex},function(Vn){this._lightmapIndex=Vn,this._applyLightMapParams()}),VE(0,Va,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(Vn){this._lightmapScaleOffset=Vn,this._setShaderValueColor(2,Vn),this._addShaderDefine(Vda.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),VE(0,Va,"enable",function(){return this._enable},function(Vn){this._enable=Vn,this.event("enablechanged",[this,Vn])}),VE(0,Va,"materials",function(){for(var Vn=0,Va=this._materials.length;Vn<Va;Vn++)if(!this._materialsInstance[Vn]){var VU=this._getInstanceMaterial(this._materials[Vn],Vn);this.event("materialchanged",[this,Vn,VU])}return this._materials.slice()},function(Vn){this.sharedMaterials=Vn}),VE(0,Va,"sharedMaterials",function(){return this._materials.slice()},function(Vn){if(!Vn)throw new Error("MeshRender: shadredMaterials value can't be null.");var Va=Vn.length;this._materialsInstance.length=Va;for(var VU=0;VU<Va;VU++){var Vx=this._materials[VU];Vx!==Vn[VU]&&(this._materialsInstance[VU]=!1,this._changeMaterialReference(Vx,Vn[VU]),this.event("materialchanged",[this,VU,Vn[VU]]))}this._materials=Vn}),VE(0,Va,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),VE(0,Va,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var Vn=this.boundingBox;VQa.add(Vn.min,Vn.max,this._boundingBoxCenter),VQa.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),VE(0,Va,"receiveShadow",function(){return this._receiveShadow},function(Vn){this._receiveShadow!==Vn&&((this._receiveShadow=Vn)?this._addShaderDefine(Vqa.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(Vqa.SHADERDEFINE_RECEIVE_SHADOW))}),VE(0,Va,"destroyed",function(){return this._destroyed}),Vx._uniqueIDCounter=0,Vz(Vx,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new VQa,new VQa,new VQa,new VQa,new VQa,new VQa,new VQa,new VQa]},"_greenColor",function(){return this._greenColor=new VVa(0,1,0,1)}]),Vx}(),VWa=function(Vn){function VV(Vn){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,VV.__super.call(this),this._localPosition=new VQa,this._localRotation=new VUa(0,0,0,1),this._localScale=new VQa(1,1,1),this._localRotationEuler=new VQa,this._localMatrix=new Vna,this._position=new VQa,this._rotation=new VUa(0,0,0,1),this._scale=new VQa(1,1,1),this._worldMatrix=new Vna,this._forward=new VQa,this._up=new VQa,this._right=new VQa,this._owner=Vn,this._childs=[]}Vq(VV,"laya.d3.core.Transform3D",Vp);var Va=VV.prototype;return Va._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)Vna.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var Vn=VV._tempVector30;VQa.multiply(this.pivot,this._localScale,Vn);var Va=VV._tempVector31;VQa.subtract(Vn,this.pivot,Va);var VU=VV._tempVector32,Vx=this.localRotation;VQa.transformQuat(Vn,Vx,VU),VQa.subtract(VU,Vn,VU);var VD=VV._tempVector33;VQa.subtract(this._localPosition,Va,VD),VQa.subtract(VD,VU,VD),Vna.createAffineTransformation(VD,Vx,this._localScale,this._localMatrix)}},Va._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var Vn=0,Va=this._childs.length;Vn<Va;Vn++)this._childs[Vn]._onWorldPositionRotationTransform()}},Va._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Vn=0,Va=this._childs.length;Vn<Va;Vn++)this._childs[Vn]._onWorldPositionScaleTransform()}},Va._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var Vn=0,Va=this._childs.length;Vn<Va;Vn++)this._childs[Vn]._onWorldPositionTransform()}},Va._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var Vn=0,Va=this._childs.length;Vn<Va;Vn++)this._childs[Vn]._onWorldPositionRotationTransform()}},Va._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Vn=0,Va=this._childs.length;Vn<Va;Vn++)this._childs[Vn]._onWorldPositionScaleTransform()}},Va._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Vn=0,Va=this._childs.length;Vn<Va;Vn++)this._childs[Vn]._onWorldTransform()}},Va.translate=function(Vn,Va){void 0===Va&&(Va=!0),Va?(Vna.createFromQuaternion(this.localRotation,VV._tempMatrix0),VQa.transformCoordinate(Vn,VV._tempMatrix0,VV._tempVector30),VQa.add(this.localPosition,VV._tempVector30,this._localPosition),this.localPosition=this._localPosition):(VQa.add(this.position,Vn,this._position),this.position=this._position)},Va.rotate=function(Vn,Va,VU){var Vx;void 0===Va&&(Va=!0),void 0===VU&&(VU=!0),Vx=VU?Vn:(VQa.scale(Vn,Math.PI/180,VV._tempVector30),VV._tempVector30),VUa.createFromYawPitchRoll(Vx.y,Vx.x,Vx.z,VV._tempQuaternion0),Va?(VUa.multiply(this._localRotation,VV._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(VUa.multiply(VV._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},Va.lookAt=function(Vn,Va,VU){void 0===VU&&(VU=!1);var Vx,VD=Vn.elements;if(VU){if(Vx=this._localPosition.elements,Math.abs(Vx[0]-VD[0])<VJn.zeroTolerance&&Math.abs(Vx[1]-VD[1])<VJn.zeroTolerance&&Math.abs(Vx[2]-VD[2])<VJn.zeroTolerance)return;VUa.lookAt(this._localPosition,Vn,Va,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var Vp=this.position;if(Vx=Vp.elements,Math.abs(Vx[0]-VD[0])<VJn.zeroTolerance&&Math.abs(Vx[1]-VD[1])<VJn.zeroTolerance&&Math.abs(Vx[2]-VD[2])<VJn.zeroTolerance)return;VUa.lookAt(Vp,Vn,Va,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},VE(0,Va,"_isFrontFaceInvert",function(){var Vn=this.scale,Va=Vn.x<0;return Vn.y<0&&(Va=!Va),Vn.z<0&&(Va=!Va),Va}),VE(0,Va,"owner",function(){return this._owner}),VE(0,Va,"localRotation",function(){if(this._localQuaternionUpdate){var Vn=this._localRotationEuler.elements;VUa.createFromYawPitchRoll(Vn[1]/VV._angleToRandin,Vn[0]/VV._angleToRandin,Vn[2]/VV._angleToRandin,this._localRotation)}return this._localRotation},function(Vn){this._localRotation=Vn,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),VE(0,Va,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?Vna.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(Vn){null===this._parent?Vn.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),Vna.multiply(this._localMatrix,Vn,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=Vn,this._worldUpdate=!1}),VE(0,Va,"worldNeedUpdate",function(){return this._worldUpdate}),VE(0,Va,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(Vn){this._localMatrix=Vn,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),VE(0,Va,"dummy",function(){return this._dummy},function(Vn){this._dummy!==Vn&&(this._dummy&&(this._dummy._entity=null),Vn&&(Vn._entity=this),this._dummy=Vn)}),VE(0,Va,"localPosition",function(){return this._localPosition},function(Vn){this._localPosition=Vn,this._localUpdate=!0,this._onWorldPositionTransform()}),VE(0,Va,"position",function(){if(this._positionUpdate){if(null!=this._parent){var Vn=this._parent.position;VQa.multiply(this._localPosition,this._parent.scale,VV._tempVector30),VQa.transformQuat(VV._tempVector30,this._parent.rotation,VV._tempVector30),VQa.add(Vn,VV._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(Vn){if(null!=this._parent){VQa.subtract(Vn,this._parent.position,this._localPosition);var Va=this._parent.scale.elements,VU=Va[0],Vx=Va[1],VD=Va[2];if(1!==VU||1!==Vx||1!==VD){var Vp=VV._tempVector30,VQ=Vp.elements;VQ[0]=1/VU,VQ[1]=1/Vx,VQ[2]=1/VD,VQa.multiply(this._localPosition,Vp,this._localPosition)}this._parent.rotation.invert(VV._tempQuaternion0),VQa.transformQuat(this._localPosition,VV._tempQuaternion0,this._localPosition)}else Vn.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=Vn,this._positionUpdate=!1}),VE(0,Va,"localScale",function(){return this._localScale},function(Vn){this._localScale=Vn,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),VE(0,Va,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(VV._tempVector30);var Vn=VV._tempVector30.elements,Va=this._localRotationEuler.elements;Va[0]=Vn[1]*VV._angleToRandin,Va[1]=Vn[0]*VV._angleToRandin,Va[2]=Vn[2]*VV._angleToRandin}return this._localRotationEuler},function(Vn){this._localRotationEuler=Vn,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),VE(0,Va,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?VUa.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(Vn){null!=this._parent?(this._parent.rotation.invert(VV._tempQuaternion0),VUa.multiply(Vn,VV._tempQuaternion0,this._localRotation)):Vn.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=Vn,this._rotationUpdate=!1}),VE(0,Va,"scale",function(){return this._scaleUpdate&&(null!==this._parent?VQa.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(Vn){if(null!==this._parent){var Va=this._parent.scale.elements,VU=VV._tempVector30.elements;VU[0]=1/Va[0],VU[1]=1/Va[1],VU[2]=1/Va[2],VQa.multiply(Vn,VV._tempVector30,this._localScale)}else Vn.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=Vn,this._scaleUpdate=!1}),VE(0,Va,"rotationEuler",null,function(Vn){VUa.createFromYawPitchRoll(Vn.y,Vn.x,Vn.z,this._rotation),this.rotation=this._rotation}),VE(0,Va,"forward",function(){var Vn=this.worldMatrix.elements;return this._forward.elements[0]=-Vn[8],this._forward.elements[1]=-Vn[9],this._forward.elements[2]=-Vn[10],this._forward}),VE(0,Va,"up",function(){var Vn=this.worldMatrix.elements;return this._up.elements[0]=Vn[4],this._up.elements[1]=Vn[5],this._up.elements[2]=Vn[6],this._up}),VE(0,Va,"right",function(){var Vn=this.worldMatrix.elements;return this._right.elements[0]=Vn[0],this._right.elements[1]=Vn[1],this._right.elements[2]=Vn[2],this._right}),VE(0,Va,"parent",function(){return this._parent},function(Vn){if(this._parent!==Vn){if(this._parent){var Va=this._parent._childs,VU=Va.indexOf(this);Va.splice(VU,1)}Vn&&(Vn._childs.push(this),Vn&&this._onWorldTransform()),this._parent=Vn}}),Vz(VV,["_tempVector30",function(){return this._tempVector30=new VQa},"_tempVector31",function(){return this._tempVector31=new VQa},"_tempVector32",function(){return this._tempVector32=new VQa},"_tempVector33",function(){return this._tempVector33=new VQa},"_tempQuaternion0",function(){return this._tempQuaternion0=new VUa},"_tempMatrix0",function(){return this._tempMatrix0=new Vna},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),VV}(),Vka=(function(Vn){function Va(){this._rotation=0,this._matNeedUpdte=!1,Va.__super.call(this),this._matrix=new Vna,this._offset=new Vpa,this._tiling=new Vpa(1,1)}Vq(Va,"laya.d3.core.TransformUV",Vp);var VU=Va.prototype;VY.imps(VU,{"laya.d3.core.IClone":!0}),VU._updateMatrix=function(){Va._tempOffsetV3.elements[0]=this._offset.x,Va._tempOffsetV3.elements[1]=this._offset.y,VUa.createFromYawPitchRoll(0,0,this._rotation,Va._tempRotationQua),Va._tempTitlingV3.elements[0]=this._tiling.x,Va._tempTitlingV3.elements[1]=this._tiling.y,Vna.createAffineTransformation(Va._tempOffsetV3,Va._tempRotationQua,Va._tempTitlingV3,this._matrix)},VU.cloneTo=function(Vn){Vn._matrix=this._matrix.clone(),Vn._offset=this._offset.clone(),Vn._rotation=this._rotation,Vn._tiling=this._tiling.clone()},VU.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,VU,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),VE(0,VU,"tiling",function(){return this._tiling},function(Vn){this._tiling=Vn,this._matNeedUpdte=!0}),VE(0,VU,"offset",function(){return this._offset},function(Vn){this._offset=Vn,this._matNeedUpdte=!0}),VE(0,VU,"rotation",function(){return this._rotation},function(Vn){this._rotation=Vn,this._matNeedUpdte=!0}),Vz(Va,["_tempOffsetV3",function(){return this._tempOffsetV3=new VQa(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new VUa},"_tempTitlingV3",function(){return this._tempTitlingV3=new VQa(1,1,1)}])}(),function(VU){function Vn(){this.x=NaN,this.y=NaN,this.z=NaN,Vn.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}Vq(Vn,"laya.d3.core.particleShuriKen.module.shape.BoxShape",VU);var Va=Vn.prototype;Va._getShapeBoundBox=function(Vn){var Va=Vn.min.elements;Va[0]=.5*-this.x,Va[1]=.5*-this.y,Va[2]=.5*-this.z;var VU=Vn.max.elements;VU[0]=.5*this.x,VU[1]=.5*this.y,VU[2]=.5*this.z},Va._getSpeedBoundBox=function(Vn){var Va=Vn.min.elements;Va[0]=0,Va[1]=0,Va[2]=0;var VU=Vn.max.elements;VU[0]=0,VU[1]=1,VU[2]=0},Va.generatePositionAndDirection=function(Vn,Va,VU,Vx){var VD=Vn.elements,Vp=Va.elements;VU?(VU.seed=Vx[16],VO._randomPointInsideHalfUnitBox(Vn,VU),Vx[16]=VU.seed):VO._randomPointInsideHalfUnitBox(Vn),VD[0]=this.x*VD[0],VD[1]=this.y*VD[1],VD[2]=this.z*VD[2],this.randomDirection?VU?(VU.seed=Vx[17],VO._randomPointUnitSphere(Va,VU),Vx[17]=VU.seed):VO._randomPointUnitSphere(Va):(Vp[0]=0,Vp[1]=0,Vp[2]=1)},Va.cloneTo=function(Vn){VU.prototype.cloneTo.call(this,Vn);var Va=Vn;Va.x=this.x,Va.y=this.y,Va.z=this.z,Va.randomDirection=this.randomDirection}}(Vf),function(VU){function VQ(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,VQ.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}Vq(VQ,"laya.d3.core.particleShuriKen.module.shape.CircleShape",VU);var Vn=VQ.prototype;Vn._getShapeBoundBox=function(Vn){var Va=Vn.min.elements;Va[0]=Va[2]=-this.radius,Va[1]=0;var VU=Vn.max.elements;VU[0]=VU[2]=this.radius,VU[1]=0},Vn._getSpeedBoundBox=function(Vn){var Va=Vn.min.elements;Va[0]=Va[1]=-1,Va[2]=0;var VU=Vn.max.elements;VU[0]=VU[1]=1,VU[2]=0},Vn.generatePositionAndDirection=function(Vn,Va,VU,Vx){var VD=Vn.elements,Vp=VQ._tempPositionPoint.elements;VU?(VU.seed=Vx[16],this.emitFromEdge?VO._randomPointUnitArcCircle(this.arc,VQ._tempPositionPoint,VU):VO._randomPointInsideUnitArcCircle(this.arc,VQ._tempPositionPoint,VU),Vx[16]=VU.seed):this.emitFromEdge?VO._randomPointUnitArcCircle(this.arc,VQ._tempPositionPoint):VO._randomPointInsideUnitArcCircle(this.arc,VQ._tempPositionPoint),VD[0]=-Vp[0],VD[1]=Vp[1],VD[2]=0,VQa.scale(Vn,this.radius,Vn),this.randomDirection?VU?(VU.seed=Vx[17],VO._randomPointUnitSphere(Va,VU),Vx[17]=VU.seed):VO._randomPointUnitSphere(Va):Vn.cloneTo(Va)},Vn.cloneTo=function(Vn){VU.prototype.cloneTo.call(this,Vn);var Va=Vn;Va.radius=this.radius,Va.arc=this.arc,Va.emitFromEdge=this.emitFromEdge,Va.randomDirection=this.randomDirection},Vz(VQ,["_tempPositionPoint",function(){return this._tempPositionPoint=new Vpa}])}(Vf),function(VU){function Vi(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,Vi.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}Vq(Vi,"laya.d3.core.particleShuriKen.module.shape.ConeShape",VU);var Vn=Vi.prototype;Vn._getShapeBoundBox=function(Vn){var Va=this.radius+this.length*Math.sin(this.angle),VU=this.length*Math.cos(this.angle),Vx=Vn.min.elements;Vx[0]=Vx[1]=-Va,Vx[2]=0;var VD=Vn.max.elements;VD[0]=VD[1]=Va,VD[2]=VU},Vn._getSpeedBoundBox=function(Vn){var Va=Math.sin(this.angle),VU=Vn.min.elements;VU[0]=VU[1]=-Va,VU[2]=0;var Vx=Vn.max.elements;Vx[0]=VU[1]=Va,Vx[2]=1},Vn.generatePositionAndDirection=function(Vn,Va,VU,Vx){var VD,Vp=Vn.elements,VQ=Va.elements,VV=Vi._tempPositionPoint.elements,Vy=NaN,VR=NaN,VX=Math.cos(this.angle),Vz=Math.sin(this.angle);switch(this.emitType){case 0:VU?(VU.seed=Vx[16],VO._randomPointInsideUnitCircle(Vi._tempPositionPoint,VU),Vx[16]=VU.seed):VO._randomPointInsideUnitCircle(Vi._tempPositionPoint),Vy=VV[0],VR=VV[1],Vp[0]=Vy*this.radius,Vp[1]=VR*this.radius,Vp[2]=0,this.randomDirection?(VU?(VU.seed=Vx[17],VO._randomPointInsideUnitCircle(Vi._tempDirectionPoint,VU),Vx[17]=VU.seed):VO._randomPointInsideUnitCircle(Vi._tempDirectionPoint),VD=Vi._tempDirectionPoint.elements,VQ[0]=VD[0]*Vz,VQ[1]=VD[1]*Vz):(VQ[0]=Vy*Vz,VQ[1]=VR*Vz),VQ[2]=VX;break;case 1:VU?(VU.seed=Vx[16],VO._randomPointUnitCircle(Vi._tempPositionPoint,VU),Vx[16]=VU.seed):VO._randomPointUnitCircle(Vi._tempPositionPoint),Vy=VV[0],VR=VV[1],Vp[0]=Vy*this.radius,Vp[1]=VR*this.radius,Vp[2]=0,this.randomDirection?(VU?(VU.seed=Vx[17],VO._randomPointInsideUnitCircle(Vi._tempDirectionPoint,VU),Vx[17]=VU.seed):VO._randomPointInsideUnitCircle(Vi._tempDirectionPoint),VD=Vi._tempDirectionPoint.elements,VQ[0]=VD[0]*Vz,VQ[1]=VD[1]*Vz):(VQ[0]=Vy*Vz,VQ[1]=VR*Vz),VQ[2]=VX;break;case 2:VU?(VU.seed=Vx[16],VO._randomPointInsideUnitCircle(Vi._tempPositionPoint,VU)):VO._randomPointInsideUnitCircle(Vi._tempPositionPoint),Vy=VV[0],VR=VV[1],Vp[0]=Vy*this.radius,Vp[1]=VR*this.radius,VQ[Vp[2]=0]=Vy*Vz,VQ[1]=VR*Vz,VQ[2]=VX,VQa.normalize(Va,Va),VU?(VQa.scale(Va,this.length*VU.getFloat(),Va),Vx[16]=VU.seed):VQa.scale(Va,this.length*Math.random(),Va),VQa.add(Vn,Va,Vn),this.randomDirection&&(VU?(VU.seed=Vx[17],VO._randomPointUnitSphere(Va,VU),Vx[17]=VU.seed):VO._randomPointUnitSphere(Va));break;case 3:VU?(VU.seed=Vx[16],VO._randomPointUnitCircle(Vi._tempPositionPoint,VU)):VO._randomPointUnitCircle(Vi._tempPositionPoint),Vy=VV[0],VR=VV[1],Vp[0]=Vy*this.radius,Vp[1]=VR*this.radius,VQ[Vp[2]=0]=Vy*Vz,VQ[1]=VR*Vz,VQ[2]=VX,VQa.normalize(Va,Va),VU?(VQa.scale(Va,this.length*VU.getFloat(),Va),Vx[16]=VU.seed):VQa.scale(Va,this.length*Math.random(),Va),VQa.add(Vn,Va,Vn),this.randomDirection&&(VU?(VU.seed=Vx[17],VO._randomPointUnitSphere(Va,VU),Vx[17]=VU.seed):VO._randomPointUnitSphere(Va));break;default:throw new Error("ConeShape:emitType is invalid.")}},Vn.cloneTo=function(Vn){VU.prototype.cloneTo.call(this,Vn);var Va=Vn;Va.angle=this.angle,Va.radius=this.radius,Va.length=this.length,Va.emitType=this.emitType,Va.randomDirection=this.randomDirection},Vz(Vi,["_tempPositionPoint",function(){return this._tempPositionPoint=new Vpa},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new Vpa}])}(Vf),function(VU){function Vn(){this.radius=NaN,this.emitFromShell=!1,Vn.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}Vq(Vn,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",VU);var Va=Vn.prototype;Va._getShapeBoundBox=function(Vn){var Va=Vn.min.elements;Va[0]=Va[1]=Va[2]=-this.radius;var VU=Vn.max.elements;VU[0]=VU[1]=this.radius,VU[2]=0},Va._getSpeedBoundBox=function(Vn){var Va=Vn.min.elements;Va[0]=Va[1]=-1,Va[2]=0;var VU=Vn.max.elements;VU[0]=VU[1]=VU[2]=1},Va.generatePositionAndDirection=function(Vn,Va,VU,Vx){var VD=Vn.elements;VU?(VU.seed=Vx[16],this.emitFromShell?VO._randomPointUnitSphere(Vn,VU):VO._randomPointInsideUnitSphere(Vn,VU),Vx[16]=VU.seed):this.emitFromShell?VO._randomPointUnitSphere(Vn):VO._randomPointInsideUnitSphere(Vn),VQa.scale(Vn,this.radius,Vn);var Vp=VD[2];Vp<0&&(VD[2]=-1*Vp),this.randomDirection?VU?(VU.seed=Vx[17],VO._randomPointUnitSphere(Va,VU),Vx[17]=VU.seed):VO._randomPointUnitSphere(Va):Vn.cloneTo(Va)},Va.cloneTo=function(Vn){VU.prototype.cloneTo.call(this,Vn);var Va=Vn;Va.radius=this.radius,Va.emitFromShell=this.emitFromShell,Va.randomDirection=this.randomDirection}}(Vf),function(VU){function Vn(){this.radius=NaN,this.emitFromShell=!1,Vn.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}Vq(Vn,"laya.d3.core.particleShuriKen.module.shape.SphereShape",VU);var Va=Vn.prototype;Va._getShapeBoundBox=function(Vn){var Va=Vn.min.elements;Va[0]=Va[1]=Va[2]=-this.radius;var VU=Vn.max.elements;VU[0]=VU[1]=VU[2]=this.radius},Va._getSpeedBoundBox=function(Vn){var Va=Vn.min.elements;Va[0]=Va[1]=Va[2]=-1;var VU=Vn.max.elements;VU[0]=VU[1]=VU[2]=1},Va.generatePositionAndDirection=function(Vn,Va,VU,Vx){VU?(VU.seed=Vx[16],this.emitFromShell?VO._randomPointUnitSphere(Vn,VU):VO._randomPointInsideUnitSphere(Vn,VU),Vx[16]=VU.seed):this.emitFromShell?VO._randomPointUnitSphere(Vn):VO._randomPointInsideUnitSphere(Vn),VQa.scale(Vn,this.radius,Vn),this.randomDirection?VU?(VU.seed=Vx[17],VO._randomPointUnitSphere(Va,VU),Vx[17]=VU.seed):VO._randomPointUnitSphere(Va):Vn.cloneTo(Va)},Va.cloneTo=function(Vn){VU.prototype.cloneTo.call(this,Vn);var Va=Vn;Va.radius=this.radius,Va.emitFromShell=this.emitFromShell,Va.randomDirection=this.randomDirection}}(Vf),function(Vn){function Va(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,Va.__super.call(this)}return Vq(Va,"laya.d3.core.render.SubMeshRenderElement",VS),Va}()),VNa=function(Vn){function Vb(Vn,Va,VU,Vx,VD,Vp){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=Vn,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[Vqa.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[Vda.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[Vda.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[VZa.SHADERDEFINE_ALPHATEST]="ALPHATEST";Vb.__super.call(this,Vn,Va,VU,null,{}),this._attributeMap=Vx;var VQ;for(VQ in VD){var VV=VD[VQ];switch(VV[1]){case 0:this._renderElementUniformMap[VQ]=VV[0];break;case 1:this._materialUniformMap[VQ]=VV[0];break;case 2:this._spriteUniformMap[VQ]=VV[0];break;case 3:this._cameraUniformMap[VQ]=VV[0];break;case 4:this._sceneUniformMap[VQ]=VV[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}Vq(Vb,"laya.d3.shader.ShaderCompile3D",VT);var Va=Vb.prototype;return Va._definesToNameDic=function(Vn,Va){for(var VU={},Vx=1,VD=0;VD<32&&!(Vn<(Vx=1<<VD));VD++)if(Vn&Vx){var Vp=Va[Vx];Vp&&(VU[Vp]="")}return VU},Va.withCompile=function(Vn,Va,VU,Vx){var VD,Vp,VQ;if(Vp=this.sharders[Vn])if(VQ=Vp[Va]){if(VD=VQ[VU])return VD}else VQ=Vp[Va]=[];else VQ=(Vp=this.sharders[Vn]=[])[Va]=[];var VV,Vy=this._definesToNameDic(Vn,Vb._globalInt2name),VR=this._definesToNameDic(Va,this._spriteInt2name),VX=this._definesToNameDic(VU,this._materialInt2name),Vz={},Vi="";if(Vy)for(VV in Vy)Vi+="#define "+VV+"\n",Vz[VV]=!0;if(VR)for(VV in VR)Vi+="#define "+VV+"\n",Vz[VV]=!0;if(VX)for(VV in VX)Vi+="#define "+VV+"\n",Vz[VV]=!0;var Vq=Vla.nameKey.getName(this._name)+" compile ("+Vn+","+Va+","+VU+")",VE=this._VS.toscript(Vz,[]),Vm=this._PS.toscript(Vz,[]);VH.now();if(VD=Vla.create(Vi+VE.join("\n"),Vi+Vm.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,Vx,Vq),VQ[VU]=VD,laya.d3.shader.ShaderCompile3D.debugMode)VH.now();return VD},Va.precompileShaderWithShaderDefine=function(Vn,Va,VU){this.withCompile(Vn,Va,VU,!0)},Va.addMaterialDefines=function(Vn){var Va=Vn.defines;for(var VU in Va){var Vx=Va[VU],VD=parseInt(VU);this._materialInt2name[VD]=Vx,this._materialName2Int[Vx]=VD}},Va.addSpriteDefines=function(Vn){var Va=Vn.defines;for(var VU in Va){var Vx=Va[VU],VD=parseInt(VU);this._spriteInt2name[VD]=Vx,this._spriteName2Int[Vx]=VD}},Va.getMaterialDefineByName=function(Vn){return this._materialName2Int[Vn]},Va.registerMaterialDefine=function(Vn){var Va=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[Va]=Vn,this._materialName2Int[Vn]=Va},Va.registerSpriteDefine=function(Vn){var Va=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[Va]=Vn,this._spriteName2Int[Vn]=Va},Vb._globalRegDefine=function(Vn,Va){Vb._globalInt2name[Va]=Vn},Vb.add=function(Vn,Va,VU,Vx,VD){return laya.d3.shader.ShaderCompile3D._preCompileShader[Vn]=new Vb(Vn,Va,VU,Vx,VD,VT.includes)},Vb.get=function(Vn){return laya.d3.shader.ShaderCompile3D._preCompileShader[Vla.nameKey.getID(Vn)]},Vb._preCompileShader={},Vb._globalInt2name=[],Vb.debugMode=!1,Vb.SHADERDEFINE_HIGHPRECISION=1,Vb.SHADERDEFINE_FOG=4,Vb.SHADERDEFINE_DIRECTIONLIGHT=8,Vb.SHADERDEFINE_POINTLIGHT=16,Vb.SHADERDEFINE_SPOTLIGHT=32,Vb.SHADERDEFINE_UV0=64,Vb.SHADERDEFINE_COLOR=128,Vb.SHADERDEFINE_UV1=256,Vb.SAHDERDEFINE_DEPTHFOG=131072,Vb}(),V_a=function(Vn){function VE(){VE.__super.call(this)}Vq(VE,"laya.d3.graphics.MeshSprite3DStaticBatchManager",Vxn);var Va=VE.prototype;return Va._getStaticBatch=function(Vn,Va,VU,Vx){var VD,Vp;return Vp=Vn?Vn.id.toString()+VU.id.toString()+Va.id.toString()+Vx.toString():VU.id.toString()+Va.id.toString()+Vx.toString(),this._staticBatches[Vp]?VD=this._staticBatches[Vp]:this._staticBatches[Vp]=VD=new V$a(Vp,this,Vn,Va,VU),VD},Va._initStaticBatchs=function(Vn){var Va,VU;this._initBatchRenderElements.sort(VE._sortPrepareStaticBatch);for(var Vx,VD=!1,Vp=0,VQ=0,VV=this._initBatchRenderElements.length;VQ<VV;VQ++){var Vy,VR=this._initBatchRenderElements[VQ],VX=VR.renderObj._getVertexBuffer(0);VR._sprite3D;if(VU===VX.vertexDeclaration&&Va===VR._material)if(VD)Vx._addCombineBatchRenderObjTest(VR)?(Vy=VR._staticBatch)!==Vx&&(Vy&&Vy._deleteCombineBatchRenderObj(VR),Vx._addCombineBatchRenderObj(VR)):(VD=!1,Vp++);else{var Vz=this._initBatchRenderElements[VQ-1],Vi=Vz.renderObj,Vq=VR.renderObj;VD=!(65535<Vi._getVertexBuffer().vertexCount+Vq._getVertexBuffer().vertexCount)&&(Vx=this._getStaticBatch(Vn,VU,Va,Vp),(Vy=Vz._staticBatch)!==Vx&&(Vy&&Vy._deleteCombineBatchRenderObj(Vz),Vx._addCombineBatchRenderObj(Vz)),(Vy=VR._staticBatch)!==Vx&&(Vy&&Vy._deleteCombineBatchRenderObj(VR),Vx._addCombineBatchRenderObj(VR)),!0)}else VD=!1,Vp=0;Va=VR._material,VU=VX.vertexDeclaration}},VE._sortPrepareStaticBatch=function(Vn,Va){var VU=Vn._render,Vx=Va._render,VD=VU.lightmapIndex-Vx.lightmapIndex;if(0!=VD)return VD;var Vp=VU.receiveShadow-Vx.receiveShadow;if(0!=Vp)return Vp;var VQ=Vn._mainSortID-Va._mainSortID;return 0==VQ?Vn.renderObj.triangleCount-Va.renderObj.triangleCount:VQ},VE}(),V$a=function(Vn){function Vp(Vn,Va,VU,Vx,VD){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,Vp.__super.call(this,Vn,Va,VU),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=Vx,this._material=VD}Vq(Vp,"laya.d3.graphics.SubMeshStaticBatch",VDn);var Va=Vp.prototype;return Va._compareBatchRenderElement=function(Vn,Va){return Vn._batchIndexStart>Va._batchIndexStart},Va._addCombineBatchRenderObjTest=function(Vn){var Va=Vn.renderObj._vertexCount;return!(65535<(0<Va?this._currentCombineVertexCount+Va:this._currentCombineVertexCount+Vn.renderObj._getVertexBuffer().vertexCount))},Va._addCombineBatchRenderObj=function(Vn){var Va=Vn.renderObj,VU=Va._vertexCount;this._initBatchRenderElements.push(Vn),Vn._staticBatch=this,0<VU?(this._currentCombineIndexCount+=Va._indexCount,this._currentCombineVertexCount+=VU):(this._currentCombineIndexCount=this._currentCombineIndexCount+Va._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+Va._getVertexBuffer().vertexCount),this._needFinishCombine=!0},Va._deleteCombineBatchRenderObj=function(Vn){var Va=Vn.renderObj,VU=this._initBatchRenderElements.indexOf(Vn);if(-1!==VU){this._initBatchRenderElements.splice(VU,1),Vn._staticBatch=null;var Vx=Va._vertexCount;0<Vx?(this._currentCombineIndexCount=this._currentCombineIndexCount-Va._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-Vx):(this._currentCombineIndexCount=this._currentCombineIndexCount-Va._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-Va._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},Va._finishInit=function(){if(this._needFinishCombine){var Vn=0,Va=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var VU=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),Vx=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=Vfa.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=Vha.create("ushort",this._currentCombineIndexCount,35044);for(var VD=0,Vp=this._initBatchRenderElements.length;VD<Vp;VD++){var VQ=this._initBatchRenderElements[VD],VV=VQ.renderObj,Vy=VV._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,VQ._sprite3D),VR=VV.getIndices(),VX=VQ._sprite3D.transform._isFrontFaceInvert,Vz=Vn/(this._vertexDeclaration.vertexStride/4)-VV._vertexStart,Vi=Va,Vq=Vi+VR.length;VQ._batchIndexStart=Vi,VQ._batchIndexEnd=Vq,Vx.set(VR,Va);var VE=0;if(VX)for(VE=Vi;VE<Vq;VE+=3){Vx[VE]=Vz+Vx[VE];var Vm=Vx[VE+1],Vb=Vx[VE+2];Vx[VE+1]=Vz+Vb,Vx[VE+2]=Vz+Vm}else for(VE=Vi;VE<Vq;VE+=3)Vx[VE]=Vz+Vx[VE],Vx[VE+1]=Vz+Vx[VE+1],Vx[VE+2]=Vz+Vx[VE+2];Va+=VR.length,VU.set(Vy,Vn),Vn+=Vy.length}this._vertexBuffer.setData(VU),this._indexBuffer.setData(Vx),this._needFinishCombine=!1}},Va._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new Vka)},Va._getRenderElement=function(Vn,Va,VU){for(var Vx,VD,Vp=this._batchRenderElements.length,VQ=!0,VV=0;VV<Vp;VV++){var Vy,VR,VX=(VD=this._batchRenderElements[VV])._sprite3D._render;if(0!==VV&&(VQ=(Vy=(Vx=this._batchRenderElements[VV-1])._sprite3D._render).lightmapIndex!==VX.lightmapIndex||Vy.receiveShadow!==VX.receiveShadow||Vx._batchIndexEnd!==VD._batchIndexStart),VQ){(VR=this._getCombineRenderElementFromPool()).renderObj=this,VR._material=this._material,VR._batchIndexStart=VD._batchIndexStart,VR._batchIndexEnd=VD._batchIndexEnd;var Vz=VX.lightmapIndex,Vi=Vz+1,Vq=this._batchOwnerIndices[Vi];Vq||(Vq=this._batchOwnerIndices[Vi]=[]);var VE,Vm=Vq[VD._render.receiveShadow?1:0];void 0===Vm?(Vq[VX.receiveShadow?1:0]=this._batchOwners.length,(VE=new Vwa(null,"StaticBatchMeshSprite3D"))._scene=Va,VE._transform=this._rootOwner?this._rootOwner._transform:null,VE._render.lightmapIndex=Vz,VE._render.receiveShadow=VD._render.receiveShadow,this._batchOwners.push(VE)):VE=this._batchOwners[Vm],VE._render._renderUpdate(VU),VR._sprite3D=VE,Vn.push(VR)}else VR._batchIndexEnd=VD._batchIndexEnd}},Va._beforeRender=function(Vn){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Va._render=function(Vn){var Va=Vn.renderElement,VU=Va._batchIndexStart,Vx=Va._batchIndexEnd-VU;Vu.mainContext.drawElements(4,Vx,5123,2*VU),VN.drawCall++,VN.trianglesFaces+=Vx/3},Va.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},Va._getVertexBuffer=function(Vn){return void 0===Vn&&(Vn=0),this._vertexBuffer},Vp}(),VMa=function(Vn){function Va(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,Va.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}Vq(Va,"laya.d3.core.ComponentNode",VR);var VU=Va.prototype;return VU.addComponent=function(Vn){var Va,VU=this._componentsMap.indexOf(Vn);if(-1===VU)Va=[],this._componentsMap.push(Vn),this._typeComponentsIndices.push(Va);else if(Va=this._typeComponentsIndices[VU],this._components[Va[0]].isSingleton)throw new Error("无法单实例创建"+Vn+"组件，"+Vn+"组件已存在！");var Vx=VD.getInstance(Vn);return Va.push(this._components.length),this._components.push(Vx),Vx instanceof laya.d3.component.Script&&this._scripts.push(Vx),Vx._initialize(this),Vx},VU._removeComponent=function(Vn,Va){var VU=this._typeComponentsIndices[Vn],Vx=VU[Va],VD=this._components[Vx];this._components.splice(Vx,1),VD instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(VD),1),VU.splice(Va,1),0===VU.length&&(this._typeComponentsIndices.splice(Vn,1),this._componentsMap.splice(Vn,1));for(var Vp=0,VQ=this._componentsMap.length;Vp<VQ;Vp++)for(var VV=(VU=this._typeComponentsIndices[Vp]).length-1;0<=VV;VV--){var Vy=VU[VV];if(!(Vx<Vy))break;VU[VV]=--Vy}VD._destroy()},VU.getComponentByType=function(Vn,Va){void 0===Va&&(Va=0);var VU=this._componentsMap.indexOf(Vn);return-1===VU?null:this._components[this._typeComponentsIndices[VU][Va]]},VU.getComponentsByType=function(Vn,Va){var VU=this._componentsMap.indexOf(Vn);if(-1!==VU){var Vx=this._typeComponentsIndices[VU],VD=Vx.length;Va.length=VD;for(var Vp=0;Vp<VD;Vp++)Va[Vp]=this._components[Vx[Vp]]}else Va.length=0},VU.getComponentByIndex=function(Vn){return this._components[Vn]},VU.removeComponentByType=function(Vn,Va){void 0===Va&&(Va=0);var VU=this._componentsMap.indexOf(Vn);-1!==VU&&this._removeComponent(VU,Va)},VU.removeComponentsByType=function(Vn){var Va=this._componentsMap.indexOf(Vn);if(-1!==Va)for(var VU=this._typeComponentsIndices[Va],Vx=0,VD=VU.length;Vx<VD;VU.length<VD?VD--:Vx++)this._removeComponent(Va,Vx)},VU.removeAllComponent=function(){for(var Vn=0,Va=this._componentsMap.length;Vn<Va;this._componentsMap.length<Va?Va--:Vn++)this.removeComponentsByType(this._componentsMap[Vn])},VU._updateComponents=function(Vn){for(var Va=0,VU=this._components.length;Va<VU;Va++){var Vx=this._components[Va];!Vx.started&&(Vx._start(Vn),Vx.started=!0),Vx.enable&&Vx._update(Vn)}},VU._lateUpdateComponents=function(Vn){for(var Va=0;Va<this._components.length;Va++){var VU=this._components[Va];!VU.started&&(VU._start(Vn),VU.started=!0),VU.enable&&VU._lateUpdate(Vn)}},VU._preRenderUpdateComponents=function(Vn){for(var Va=0;Va<this._components.length;Va++){var VU=this._components[Va];!VU.started&&(VU._start(Vn),VU.started=!0),VU.enable&&VU._preRenderUpdate(Vn)}},VU._postRenderUpdateComponents=function(Vn){for(var Va=0;Va<this._components.length;Va++){var VU=this._components[Va];!VU.started&&(VU._start(Vn),VU.started=!0),VU.enable&&VU._postRenderUpdate(Vn)}},Va}(),VZa=function(Vx){function Vn(){Vn.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new Via,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new VVa(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}Vq(Vn,"laya.d3.core.material.BaseMaterial",Vx);var Va=Vn.prototype;return VY.imps(Va,{"laya.d3.core.IClone":!0}),Va._addShaderDefine=function(Vn){this._shaderDefineValue|=Vn},Va._removeShaderDefine=function(Vn){this._shaderDefineValue&=~Vn},Va._addDisablePublicShaderDefine=function(Vn){this._disablePublicShaderDefine|=Vn},Va._removeDisablePublicShaderDefine=function(Vn){this._disablePublicShaderDefine&=~Vn},Va._setBuffer=function(Vn,Va){this._shaderValues.setValue(Vn,Va),this._values[Vn]=Va},Va._getBuffer=function(Vn){return this._values[Vn]},Va._setMatrix4x4=function(Vn,Va){this._shaderValues.setValue(Vn,Va?Va.elements:null),this._values[Vn]=Va},Va._getMatrix4x4=function(Vn){return this._values[Vn]},Va._setInt=function(Vn,Va){this._shaderValues.setValue(Vn,Va),this._values[Vn]=Va},Va._getInt=function(Vn){return this._values[Vn]},Va._setNumber=function(Vn,Va){this._shaderValues.setValue(Vn,Va),this._values[Vn]=Va},Va._getNumber=function(Vn){return this._values[Vn]},Va._setBool=function(Vn,Va){this._shaderValues.setValue(Vn,Va),this._values[Vn]=Va},Va._getBool=function(Vn){return this._values[Vn]},Va._setVector2=function(Vn,Va){this._shaderValues.setValue(Vn,Va?Va.elements:null),this._values[Vn]=Va},Va._getVector2=function(Vn){return this._values[Vn]},Va._setColor=function(Vn,Va){this._shaderValues.setValue(Vn,Va?Va.elements:null),this._values[Vn]=Va},Va._getColor=function(Vn){return this._values[Vn]},Va._setTexture=function(Vn,Va){var VU=this._values[Vn];this._values[Vn]=Va,this._shaderValues.setValue(Vn,Va),0<this.referenceCount&&(VU&&VU._removeReference(),Va&&Va._addReference())},Va._getTexture=function(Vn){return this._values[Vn]},Va._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},Va._getShader=function(Vn,Va,VU){var Vx=(Vn|Va)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(Vx,VU,this._shaderDefineValue),this._shader},Va._setRenderStateBlendDepth=function(){var Vn=Vu.mainContext;switch(Vc.setDepthMask(Vn,this.depthWrite),0===this.depthTest?Vc.setDepthTest(Vn,!1):(Vc.setDepthTest(Vn,!0),Vc.setDepthFunc(Vn,this.depthTest)),this.blend){case 0:Vc.setBlend(Vn,!1);break;case 1:Vc.setBlend(Vn,!0),Vc.setBlendFunc(Vn,this.srcBlend,this.dstBlend);break;case 2:Vc.setBlend(Vn,!0)}},Va._setRenderStateFrontFace=function(Vn,Va){var VU=Vu.mainContext,Vx=0;switch(this.cull){case 0:Vc.setCullFace(VU,!1);break;case 1:Vc.setCullFace(VU,!0),Vx=Vn?Va&&Va._isFrontFaceInvert?2305:2304:Va&&Va._isFrontFaceInvert?2304:2305,Vc.setFrontFace(VU,Vx);break;case 2:Vc.setCullFace(VU,!0),Vx=Vn?Va&&Va._isFrontFaceInvert?2304:2305:Va&&Va._isFrontFaceInvert?2305:2304,Vc.setFrontFace(VU,Vx)}},Va.onAsynLoaded=function(Vn,Va,VU){var Vx=Va[0],VD=Va[1];switch(Vx.version){case"LAYAMATERIAL:01":var Vp=0,VQ=0,VV=Vx.props;for(var Vy in VV)switch(Vy){case"vectors":var VR=VV[Vy];for(Vp=0,VQ=VR.length;Vp<VQ;Vp++){var VX=VR[Vp],Vz=VX.value;switch(Vz.length){case 2:this[VX.name]=new Vpa(Vz[0],Vz[1]);break;case 3:this[VX.name]=new VQa(Vz[0],Vz[1],Vz[2]);break;case 4:this[VX.name]=new VVa(Vz[0],Vz[1],Vz[2],Vz[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var Vi=VV[Vy];for(Vp=0,VQ=Vi.length;Vp<VQ;Vp++){var Vq=Vi[Vp],VE=Vq.path;VE&&(this[Vq.name]=VP.getRes(VD[VE]))}break;case"defines":var Vm=VV[Vy];for(Vp=0,VQ=Vm.length;Vp<VQ;Vp++){var Vb=this._shaderCompile.getMaterialDefineByName(Vm[Vp]);this._addShaderDefine(Vb)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[Vy]=VV[Vy];break;case"renderQueue":switch(VV[Vy]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[Vy]=VV[Vy]}break;case"LAYAMATERIAL:02":for(Vy in VV=Vx.props)switch(Vy){case"vectors":for(Vp=0,VQ=(VR=VV[Vy]).length;Vp<VQ;Vp++)switch((Vz=(VX=VR[Vp]).value).length){case 2:this[VX.name]=new Vpa(Vz[0],Vz[1]);break;case 3:this[VX.name]=new VQa(Vz[0],Vz[1],Vz[2]);break;case 4:this[VX.name]=new VVa(Vz[0],Vz[1],Vz[2],Vz[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(Vp=0,VQ=(Vi=VV[Vy]).length;Vp<VQ;Vp++)(VE=(Vq=Vi[Vp]).path)&&(this[Vq.name]=VP.getRes(VD[VE]));break;case"defines":for(Vp=0,VQ=(Vm=VV[Vy]).length;Vp<VQ;Vp++)Vb=this._shaderCompile.getMaterialDefineByName(Vm[Vp]),this._addShaderDefine(Vb);break;default:this[Vy]=VV[Vy]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},Va._addReference=function(){Vx.prototype._addReference.call(this);for(var Vn=0,Va=this._values.length;Vn<Va;Vn++){var VU=this._values[Vn];VU&&VU instanceof laya.d3.resource.BaseTexture&&VU._addReference()}},Va._removeReference=function(){Vx.prototype._removeReference.call(this);for(var Vn=0,Va=this._values.length;Vn<Va;Vn++){var VU=this._values[Vn];VU&&VU instanceof laya.d3.resource.BaseTexture&&VU._removeReference()}},Va.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},Va.setShaderName=function(Vn){var Va=Vla.nameKey.getID(Vn);if(-1===Va)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=VNa._preCompileShader[Va]},Va.cloneTo=function(Vn){var Va=Vn;Va.name=this.name,Va.cull=this.cull,Va.blend=this.blend,Va.srcBlend=this.srcBlend,Va.dstBlend=this.dstBlend,Va.srcBlendRGB=this.srcBlendRGB,Va.dstBlendRGB=this.dstBlendRGB,Va.srcBlendAlpha=this.srcBlendAlpha,Va.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(Va.blendConstColor),Va.blendEquation=this.blendEquation,Va.blendEquationRGB=this.blendEquationRGB,Va.blendEquationAlpha=this.blendEquationAlpha,Va.depthTest=this.depthTest,Va.depthWrite=this.depthWrite,Va.renderQueue=this.renderQueue,Va._shader=this._shader,Va._disablePublicShaderDefine=this._disablePublicShaderDefine,Va._shaderDefineValue=this._shaderDefineValue;var VU,Vx=0,VD=Va._shaderValues;Va._shaderValues.data.length=this._shaderValues.data.length;var Vp=this._values.length,VQ=Va._values;for(Vx=0,VU=VQ.length=Vp;Vx<VU;Vx++){var VV=this._values[Vx];if(VV)if("number"==typeof VV)VQ[Vx]=VV,VD.data[Vx]=VV;else if("number"==typeof VV&&Math.floor(VV)==VV)VQ[Vx]=VV,VD.data[Vx]=VV;else if("boolean"==typeof VV)VQ[Vx]=VV,VD.data[Vx]=VV;else if(VV instanceof laya.d3.math.Vector2){var Vy=VQ[Vx]||(VQ[Vx]=new Vpa);VV.cloneTo(Vy),VD.data[Vx]=Vy.elements}else if(VV instanceof laya.d3.math.Vector3){var VR=VQ[Vx]||(VQ[Vx]=new VQa);VV.cloneTo(VR),VD.data[Vx]=VR.elements}else if(VV instanceof laya.d3.math.Vector4){var VX=VQ[Vx]||(VQ[Vx]=new VVa);VV.cloneTo(VX),VD.data[Vx]=VX.elements}else if(VV instanceof laya.d3.math.Matrix4x4){var Vz=VQ[Vx]||(VQ[Vx]=new Vna);VV.cloneTo(Vz),VD.data[Vx]=Vz.elements}else VV instanceof laya.d3.resource.BaseTexture&&(VQ[Vx]=VV,VD.data[Vx]=VV)}},Va.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VE(0,Va,"alphaTestValue",function(){return this._getNumber(0)},function(Vn){this._setNumber(0,Vn)}),VE(0,Va,"alphaTest",function(){return this._alphaTest},function(Vn){(this._alphaTest=Vn)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),Vn.__init__=function(){Vn.SHADERDEFINE_ALPHATEST=Vn.shaderDefines.registerDefine("ALPHATEST")},Vn.RENDERQUEUE_OPAQUE=2e3,Vn.RENDERQUEUE_ALPHATEST=2450,Vn.RENDERQUEUE_TRANSPARENT=3e3,Vn.CULL_NONE=0,Vn.CULL_FRONT=1,Vn.CULL_BACK=2,Vn.BLEND_DISABLE=0,Vn.BLEND_ENABLE_ALL=1,Vn.BLEND_ENABLE_SEPERATE=2,Vn.BLENDPARAM_ZERO=0,Vn.BLENDPARAM_ONE=1,Vn.BLENDPARAM_SRC_COLOR=768,Vn.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,Vn.BLENDPARAM_DST_COLOR=774,Vn.BLENDPARAM_ONE_MINUS_DST_COLOR=775,Vn.BLENDPARAM_SRC_ALPHA=770,Vn.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,Vn.BLENDPARAM_DST_ALPHA=772,Vn.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,Vn.BLENDPARAM_SRC_ALPHA_SATURATE=776,Vn.BLENDEQUATION_ADD=0,Vn.BLENDEQUATION_SUBTRACT=1,Vn.BLENDEQUATION_REVERSE_SUBTRACT=2,Vn.DEPTHTEST_OFF=0,Vn.DEPTHTEST_NEVER=512,Vn.DEPTHTEST_LESS=513,Vn.DEPTHTEST_EQUAL=514,Vn.DEPTHTEST_LEQUAL=515,Vn.DEPTHTEST_GREATER=516,Vn.DEPTHTEST_NOTEQUAL=517,Vn.DEPTHTEST_GEQUAL=518,Vn.DEPTHTEST_ALWAYS=519,Vn.SHADERDEFINE_ALPHATEST=1,Vn.ALPHATESTVALUE=0,Vz(Vn,["shaderDefines",function(){return this.shaderDefines=new VXa}]),Vn}(Vb),Vua=function(Vn){function Va(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,Va.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}Vq(Va,"laya.d3.resource.BaseTexture",Vb);var VU=Va.prototype;return VE(0,VU,"width",function(){return this._width}),VE(0,VU,"repeat",function(){return this._repeat},function(Vn){if(this._repeat!==Vn&&(this._repeat=Vn,this._source)){var Va=Vu.mainContext;Vc.bindTexture(Va,this._type,this._source),VK.isPOT(this._width,this._height)&&this._repeat?(Va.texParameteri(this._type,10242,10497),Va.texParameteri(this._type,10243,10497)):(Va.texParameteri(this._type,10242,33071),Va.texParameteri(this._type,10243,33071))}}),VE(0,VU,"height",function(){return this._height}),VE(0,VU,"magFifter",function(){return this._magFifter},function(Vn){(this._magFifter=Vn)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(Vn)}),VE(0,VU,"wrapModeV",function(){return this._wrapModeV}),VE(0,VU,"size",function(){return this._size}),VE(0,VU,"wrapModeU",function(){return this._wrapModeU}),VE(0,VU,"mipmap",function(){return this._mipmap},function(Vn){this._mipmap=Vn,this._mipmap!=Vn&&this._conchTexture&&this._conchTexture.setMipMap(Vn)}),VE(0,VU,"minFifter",function(){return this._minFifter},function(Vn){this._minFifter=Vn,this._minFifter!=Vn&&this._conchTexture&&this._conchTexture.setMinFifter(Vn)}),VE(0,VU,"format",function(){return this._format}),VE(0,VU,"source",function(){return this.activeResource(),this._source}),VE(0,VU,"defaulteTexture",function(){return VBa.grayTexture}),Va.WARPMODE_REPEAT=0,Va.WARPMODE_CLAMP=1,Va}(),Vca=function(Vn){function Va(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,Va.__super.call(this),this._boundingBoxCorners=Vx(8,null)}Vq(Va,"laya.d3.resource.models.BaseMesh",Vb);var VU=Va.prototype;return VU._getPositions=function(){throw new Error("未Override,请重载该属性！")},VU._generateBoundingObject=function(){this._boundingSphere=new Vrn(new VQa,0),Vrn.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new VCn(new VQa,new VQa),VCn.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},VU.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},VU.getRenderElement=function(Vn){throw new Error("未Override,请重载该属性！")},VE(0,VU,"subMeshCount",function(){return this._subMeshCount}),VE(0,VU,"boundingBox",function(){return this._boundingBox}),VE(0,VU,"boundingBoxCorners",function(){return this._boundingBoxCorners}),VE(0,VU,"boundingSphere",function(){return this._boundingSphere}),Va}(),VHa=(function(Vn){function Va(){Va.__super.call(this)}Vq(Va,"laya.d3.component.Script",VTa);var VU=Va.prototype;VU.onTriggerEnter=function(Vn){},VU.onTriggerExit=function(Vn){},VU.onTriggerStay=function(Vn){},VE(0,VU,"isSingleton",function(){return Va._isSingleton}),Va._isSingleton=!1}(),function(Vn){function Va(Vn){this._owner=null,this._sharedMesh=null,Va.__super.call(this),this._owner=Vn}Vq(Va,"laya.d3.core.MeshFilter",Vn);var VU=Va.prototype;return VU._sharedMeshLoaded=function(){this.event("loaded")},VU._destroy=function(){Vn.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},VE(0,VU,"sharedMesh",function(){return this._sharedMesh},function(Vn){var Va=this._sharedMesh;Va&&Va._removeReference(),(this._sharedMesh=Vn)._addReference(),this.event("meshchanged",[this,Va,Vn]),Vn.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),VE(0,VU,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),VE(0,VU,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),VE(0,VU,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),VE(0,VU,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),Va}(VKa)),VGa=function(Vn){function Va(Vn){Va.__super.call(this,Vn),Vn.meshFilter.on("meshchanged",this,this._onMeshChanged)}Vq(Va,"laya.d3.core.MeshRender",VYa);var VU=Va.prototype;return VU._onMeshChanged=function(Vn,Va,VU){VU.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:VU.once("loaded",this,this._onMeshLoaed)},VU._onMeshLoaed=function(Vn,Va){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},VU._calculateBoundingSphereByInitSphere=function(Vn){var Va=NaN,VU=this._owner.transform,Vx=VU.scale.elements,VD=Math.abs(Vx[0]),Vp=Math.abs(Vx[1]),VQ=Math.abs(Vx[2]);Va=Vp<=VD&&VQ<=VD?VD:VQ<=Vp?Vp:VQ,VQa.transformCoordinate(Vn.center,VU.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=Vn.radius*Va},VU._calculateBoundBoxByInitCorners=function(Vn){for(var Va=this._owner.transform.worldMatrix,VU=0;VU<8;VU++)VQa.transformCoordinate(Vn[VU],Va,VYa._tempBoundBoxCorners[VU]);VCn.createfromPoints(VYa._tempBoundBoxCorners,this._boundingBox)},VU._calculateBoundingSphere=function(){var Vn=this._owner.meshFilter.sharedMesh;null==Vn||null==Vn.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(Vn.boundingSphere)},VU._calculateBoundingBox=function(){var Vn=this._owner.meshFilter.sharedMesh;null==Vn||null==Vn.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(Vn.boundingBoxCorners)},VU._renderUpdate=function(Vn){var Va=this._owner.transform;if(Va){this._setShaderValueMatrix4x4(0,Va.worldMatrix);var VU=this._owner.getProjectionViewWorldMatrix(Vn);this._setShaderValueMatrix4x4(1,VU)}else this._setShaderValueMatrix4x4(0,Vna.DEFAULT),this._setShaderValueMatrix4x4(1,Vn);return VPa.debugMode&&this._renderRenderableBoundBox(),!0},Va}(),VIa=function(Va){function Vx(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,Vx.__super.call(this),this._renderState=new Vs,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new Via,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new Van,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new VQa(.7,.7,.7),this.ambientColor=new VQa(.212,.227,.259),Vu.shaderHighPrecision&&this.addShaderDefine(VNa.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}Vq(Vx,"laya.d3.core.scene.Scene",Va);var Vn=Vx.prototype;return VY.imps(Vn,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),Vn._setUrl=function(Vn){this._url=Vn},Vn._getGroup=function(){return this._group},Vn._setGroup=function(Vn){this._group=Vn},Vn._display=function(){VY.stage._scenes.push(this),VY.stage._scenes.sort(Vx._sortScenes);for(var Vn=0,Va=this._childs.length;Vn<Va;Vn++){var VU=this._childs[Vn];VU.active&&VU._activeHierarchy()}},Vn._unDisplay=function(){var Vn=VY.stage._scenes;Vn.splice(Vn.indexOf(this),1);for(var Va=0,VU=this._childs.length;Va<VU;Va++){var Vx=this._childs[Va];Vx.active&&Vx._inActiveHierarchy()}},Vn._addChild3D=function(Vn){Vn.transform._onWorldTransform(),Vn._setBelongScene(this),this.displayedInStage&&Vn.active&&Vn._activeHierarchy()},Vn._removeChild3D=function(Vn){Vn.transform.parent=null,this.displayedInStage&&Vn.active&&Vn._inActiveHierarchy(),Vn._setUnBelongScene()},Vn.initOctree=function(Vn,Va,VU,Vx,VD){void 0===VD&&(VD=6),this.treeSize=new VQa(Vn,Va,VU),this.treeLevel=VD,this.treeRoot=new VC(this,0),this.treeRoot.init(Vx,this.treeSize)},Vn._prepareUpdateToRenderState=function(Vn,Va){Va.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,Va.scene=this},Vn._prepareSceneToRender=function(Vn){var Va=this._lights.length;if(0<Va)for(var VU=0,Vx=0;Vx<Va&&!(this._lights[Vx]._prepareToScene(Vn)&&++VU>=this._enableLightCount);Vx++);},Vn._updateChilds=function(Vn){for(var Va=0,VU=this._childs.length;Va<VU;++Va)this._childs[Va]._update(Vn)},Vn._preRenderScene=function(Vn,Va,VU){var Vx,VD=Va._viewMatrix,Vp=Va._projectionMatrix,VQ=Va._projectionViewMatrix,VV=0,Vy=Va.camera;for(Vy.useOcclusionCulling?this.treeRoot?VUn.renderObjectCullingOctree(VU,this,Vy,VD,Vp,VQ):VUn.renderObjectCulling(VU,this,Vy,VD,Vp,VQ):VUn.renderObjectCullingNoBoundFrustum(this,Vy,VD,Vp,VQ),VV=0,Vx=this._quenes.length;VV<Vx;VV++)this._quenes[VV]&&this._quenes[VV]._preRender(Va)},Vn._clear=function(Vn,Va){var VU=Va._viewport,Vx=Va.camera,VD=VU.x,Vp=Vx.renderTargetSize.height-VU.y-VU.height,VQ=VU.width,VV=VU.height;Vn.viewport(VD,Vp,VQ,VV);var Vy=256,VR=Vx.renderTarget;switch(Vx.clearFlag){case 0:var VX=Vx.clearColor;if(VX){Vn.enable(3089),Vn.scissor(VD,Vp,VQ,VV);var Vz=VX.elements;Vn.clearColor(Vz[0],Vz[1],Vz[2],Vz[3]),Vy|=16384}if(VR)switch(VX||(Vy=16384),VR.depthStencilFormat){case 33189:Vy|=256;break;case 36168:Vy|=1024;break;case 34041:Vy|=256,Vy|=1024}Vn.clear(Vy),VX&&Vn.disable(3089);break;case 1:case 2:if(VR)switch(Vy=16384,VR.depthStencilFormat){case 33189:Vy|=256;break;case 36168:Vy|=1024;break;case 34041:Vy|=256,Vy|=1024}Vn.clear(Vy);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},Vn._renderScene=function(Vn,Va){var VU,Vx,VD=Va.camera,Vp=0;for(Vp=0;Vp<2;Vp++)(Vx=this._quenes[Vp])&&(VD.renderTarget?Vx._render(Va,!0):Vx._render(Va,!1));if(1===VD.clearFlag){var VQ=VD.sky;VQ&&(Vc.setCullFace(Vn,!1),Vc.setDepthFunc(Vn,515),Vc.setDepthMask(Vn,!1),VQ._render(Va),Vc.setDepthFunc(Vn,513),Vc.setDepthMask(Vn,!0))}for(Vp=2,VU=this._quenes.length;Vp<VU;Vp++)(Vx=this._quenes[Vp])&&(Vx._sortAlpha(Va.camera.transform.position),VD.renderTarget?Vx._render(Va,!0):Vx._render(Va,!1))},Vn._set3DRenderConfig=function(Vn){Vn.disable(3042),Vc._blend=!1,Vn.blendFunc(770,771),Vc._sFactor=770,Vc._dFactor=771,Vn.disable(2929),Vc._depthTest=!1,Vn.enable(2884),Vc._cullFace=!0,Vn.depthMask(1),Vc._depthMask=!0,Vn.frontFace(2304),Vc._frontFace=2304},Vn._set2DRenderConfig=function(Vn){Vc.setBlend(Vn,!0),Vc.setBlendFunc(Vn,1,771),Vc.setDepthTest(Vn,!1),Vc.setCullFace(Vn,!1),Vc.setDepthMask(Vn,!0),Vc.setFrontFace(Vn,2305),Vn.viewport(0,0,VX.width,VX.height)},Vn._parseCustomProps=function(Vn,Va,VU,Vx){var VD=Vx.customProps.lightmaps,Vp=VD.length,VQ=this._lightmaps;VQ.length=Vp;for(var VV=0;VV<Vp;VV++)VQ[VV]=VP.getRes(Va[VD[VV].replace(".exr",".png")]);this.setlightmaps(VQ);var Vy=Vx.customProps.ambientColor;Vy&&(this.ambientColor=new VQa(Vy[0],Vy[1],Vy[2]));var VR=Vx.customProps.fogColor;VR&&(this.fogColor=new VQa(VR[0],VR[1],VR[2]))},Vn._addLight=function(Vn){this._lights.indexOf(Vn)<0&&this._lights.push(Vn)},Vn._removeLight=function(Vn){var Va=this._lights.indexOf(Vn);0<=Va&&this._lights.splice(Va,1)},Vn._updateScene=function(){var Vn=this._renderState;this._prepareUpdateToRenderState(Vu.mainContext,Vn),this._updateComponents(Vn),this._updateChilds(Vn),this._lateUpdateComponents(Vn),this._time+=Vn.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},Vn._updateSceneConch=function(){var Vn=this._renderState;this._prepareUpdateToRenderState(Vu.mainContext,Vn),this._updateComponents(Vn),this._lateUpdateComponents(Vn),this._prepareSceneToRender(Vn);for(var Va=0,VU=this._cameraPool.length;Va<VU;Va++){var Vx=this._cameraPool[Va];(Vn.camera=Vx)._prepareCameraToRender()}},Vn._preRenderShadow=function(Vn,Va,VU,Vx,VD){this.treeRoot?VUn.renderShadowObjectCullingOctree(this,Va,VU,Vx,VD):VUn.renderShadowObjectCulling(this,Va,VU,Vx,VD);for(var Vp=0,VQ=VU.length;Vp<VQ;Vp++)VU[Vp]&&VU[Vp]._preRender(Vn)},Vn._renderShadowMap=function(Vn,Va,VU){var Vx=this.parallelSplitShadowMaps[0];Vx._calcAllLightCameraInfo(VU);var VD,Vp,VQ,VV=Vx.PSSMNum;if(this._preRenderShadow(Va,Vx._lightCulling,Vx._shadowQuenes,Vx._lightVPMatrix[0],VV),this.addShaderDefine(Vqa.SHADERDEFINE_CAST_SHADOW),1<VV)for(var Vy=0;Vy<VV;Vy++)VD=Vx.getRenderTarget(Vy+1),Vx.beginRenderTarget(Vy+1),Vn.clearColor(1,1,1,1),Vn.clear(16640),Vn.viewport(0,0,VD.width,VD.height),Va.camera=VQ=Vx.getLightCamera(Vy),VQ._prepareCameraToRender(),VQ._prepareCameraViewProject(VQ.viewMatrix,VQ.projectionMatrix),Va._projectionViewMatrix=Vx._lightVPMatrix[Vy+1],(Vp=Vx._shadowQuenes[Vy])._preRender(Va),Vp._renderShadow(Va,!1),Vx.endRenderTarget(Vy+1);else VD=Vx.getRenderTarget(1),Vx.beginRenderTarget(1),Vn.clearColor(1,1,1,1),Vn.clear(16640),Vn.viewport(0,0,VD.width,VD.height),Va.camera=VQ=Vx.getLightCamera(0),VQ._prepareCameraToRender(),VQ._prepareCameraViewProject(VQ.viewMatrix,VQ.projectionMatrix),Va._projectionViewMatrix=Vx._lightVPMatrix[0],(Vp=Vx._shadowQuenes[0])._preRender(Va),Vp._renderShadow(Va,!0),Vx.endRenderTarget(1);this.removeShaderDefine(Vqa.SHADERDEFINE_CAST_SHADOW)},Vn.addTreeNode=function(Vn){this.treeRoot.addTreeNode(Vn)},Vn.removeTreeNode=function(Vn){this.treeSize&&Vn._treeNode&&Vn._treeNode.removeObject(Vn)},Vn.setlightmaps=function(Vn){this._lightmaps=Vn;for(var Va=0,VU=this._renderableSprite3Ds.length;Va<VU;Va++)this._renderableSprite3Ds[Va]._render._applyLightMapParams()},Vn.getlightmaps=function(){return this._lightmaps},Vn.addChildAt=function(Vn,Va){if(!(Vn instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(Vn&&Vn.__className));if(!Vn||this.destroyed||Vn===this)return Vn;if(Vn.zOrder&&this._set$P("hasZorder",!0),0<=Va&&Va<=this._childs.length){if(Vn._parent===this){var VU=this.getChildIndex(Vn);this._childs.splice(VU,1),this._childs.splice(Va,0,Vn),this.conchModel&&(this.conchModel.removeChild(Vn.conchModel),this.conchModel.addChildAt(Vn.conchModel,Va)),this._childChanged()}else Vn.parent&&Vn.parent.removeChild(Vn),this._childs===VR.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Va,0,Vn),this.conchModel&&this.conchModel.addChildAt(Vn.conchModel,Va),(Vn.parent=this)._addChild3D(Vn);return Vn}throw new Error("appendChildAt:The index is out of bounds")},Vn.addChild=function(Vn){if(!(Vn instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Vn||this.destroyed||Vn===this)return Vn;if(Vn.zOrder&&this._set$P("hasZorder",!0),Vn._parent===this){var Va=this.getChildIndex(Vn);Va!==this._childs.length-1&&(this._childs.splice(Va,1),this._childs.push(Vn),this.conchModel&&(this.conchModel.removeChild(Vn.conchModel),this.conchModel.addChildAt(Vn.conchModel,this._childs.length-1)),this._childChanged())}else Vn.parent&&Vn.parent.removeChild(Vn),this._childs===VR.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Vn),this.conchModel&&this.conchModel.addChildAt(Vn.conchModel,this._childs.length-1),(Vn.parent=this)._childChanged(),this._addChild3D(Vn);return Vn},Vn.removeChildAt=function(Vn){var Va=this.getChildAt(Vn);return Va&&(this._removeChild3D(Va),this._childs.splice(Vn,1),this.conchModel&&this.conchModel.removeChild(Va.conchModel),Va.parent=null),Va},Vn.removeChildren=function(Vn,Va){if(void 0===Vn&&(Vn=0),void 0===Va&&(Va=2147483647),this._childs&&0<this._childs.length){var VU=this._childs;if(0===Vn&&Vp<=Va){var Vx=VU;this._childs=VR.ARRAY_EMPTY}else Vx=VU.splice(Vn,Va-Vn);for(var VD=0,Vp=Vx.length;VD<Vp;VD++)this._removeChild3D(Vx[VD]),Vx[VD].parent=null,this.conchModel&&this.conchModel.removeChild(Vx[VD].conchModel)}return this},Vn.addFrustumCullingObject=function(Vn){this.treeRoot?this.addTreeNode(Vn):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(Vn):this._cullingRenders[this._cullingRendersLength]=Vn,Vn._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},Vn.removeFrustumCullingObject=function(Vn){if(this.treeRoot)this.removeTreeNode(Vn);else{this._cullingRendersLength--;var Va=Vn._indexInSceneFrustumCullingObjects;if(Va!==this._cullingRendersLength){var VU=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[Va]=VU)._indexInSceneFrustumCullingObjects=Va,Vn._indexInSceneFrustumCullingObjects=-1}}},Vn.getRenderQueue=function(Vn){return Vn<3e3?this._quenes[1]||(this._quenes[1]=new Vw(this)):this._quenes[2]||(this._quenes[2]=new Vw(this))},Vn.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new Vw(this)},Vn.addShaderDefine=function(Vn){this._shaderDefineValue|=Vn},Vn.removeShaderDefine=function(Vn){this._shaderDefineValue&=~Vn},Vn.addScript=function(Vn){return this._addComponent(Vn)},Vn.getScriptByType=function(Vn,Va){return void 0===Va&&(Va=0),this._getComponentByType(Vn,Va)},Vn.getScriptsByType=function(Vn,Va){this._getComponentsByType(Vn,Va)},Vn.getScriptByIndex=function(Vn){return this._getComponentByIndex(Vn)},Vn.removeScriptByType=function(Vn,Va){void 0===Va&&(Va=0),this._removeComponentByType(Vn,Va)},Vn.removeScriptsByType=function(Vn){this._removeComponentByType(Vn)},Vn.removeAllScript=function(){this._removeAllComponent()},Vn.render=function(Vn,Va,VU){(Vm._context.ctx._renderKey=0)<this._childs.length&&Vn.addRenderObject(this)},Vn.renderSubmit=function(){var Vn=Vu.mainContext,Va=this._renderState;this._set3DRenderConfig(Vn),this._prepareSceneToRender(this._renderState);var VU,Vx=0,VD=0;if(VPa.debugMode||VC.debugMode)for(Vx=0,VD=this._cameraPool.length;Vx<VD;Vx++)VU=this._cameraPool[Vx],VPa._debugPhasorSprite.begin(1,VU),VU.activeInHierarchy&&VU._renderCamera(Vn,Va,this),VPa._debugPhasorSprite.end();else for(Vx=0,VD=this._cameraPool.length;Vx<VD;Vx++)(VU=this._cameraPool[Vx]).activeInHierarchy&&VU._renderCamera(Vn,Va,this);return this._set2DRenderConfig(Vn),1},Vn.onAsynLoaded=function(Vn,Va,VU){var Vx=Va[0];if("Scene"!==Vx.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var VD=Va[1];Vba._createNodeByJson(this,Vx,this,VD),this.event("hierarchyloaded",[this]),this.__loaded=!0},Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),this.destroyed||(Va.prototype.destroy.call(this,Vn),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,VP.clearRes(this.url),this.loaded||VPa._cancelLoadByUrl(this.url))},Vn.getRenderType=function(){return 0},Vn.releaseRender=function(){},Vn._addComponent=function(Vn){var Va,VU=this._componentsMap.indexOf(Vn);if(-1===VU)Va=[],this._componentsMap.push(Vn),this._typeComponentsIndices.push(Va);else if(Va=this._typeComponentsIndices[VU],this._components[Va[0]].isSingleton)throw new Error("无法单实例创建"+Vn+"组件，"+Vn+"组件已存在！");var Vx=VD.getInstance(Vn);Va.push(this._components.length),this._components.push(Vx);return Vx._initialize(this),Vx},Vn._removeComponent=function(Vn,Va){var VU=this._typeComponentsIndices[Vn],Vx=VU[Va],VD=this._components[Vx];this._components.splice(Vx,1),VU.splice(Va,1),0===VU.length&&(this._typeComponentsIndices.splice(Vn,1),this._componentsMap.splice(Vn,1));for(var Vp=0,VQ=this._componentsMap.length;Vp<VQ;Vp++)for(var VV=(VU=this._typeComponentsIndices[Vp]).length-1;0<=VV;VV--){var Vy=VU[VV];if(!(Vx<Vy))break;VU[VV]=--Vy}VD._destroy()},Vn._getComponentByType=function(Vn,Va){void 0===Va&&(Va=0);var VU=this._componentsMap.indexOf(Vn);return-1===VU?null:this._components[this._typeComponentsIndices[VU][Va]]},Vn._getComponentsByType=function(Vn,Va){var VU=this._componentsMap.indexOf(Vn);if(-1!==VU){var Vx=this._typeComponentsIndices[VU],VD=Vx.length;Va.length=VD;for(var Vp=0;Vp<VD;Vp++)Va[Vp]=this._components[Vx[Vp]]}else Va.length=0},Vn._getComponentByIndex=function(Vn){return this._components[Vn]},Vn._removeComponentByType=function(Vn,Va){void 0===Va&&(Va=0);var VU=this._componentsMap.indexOf(Vn);-1!==VU&&this._removeComponent(VU,Va)},Vn._removeComponentsByType=function(Vn){var Va=this._componentsMap.indexOf(Vn);if(-1!==Va)for(var VU=this._typeComponentsIndices[Va],Vx=0,VD=VU.length;Vx<VD;VU.length<VD?VD--:Vx++)this._removeComponent(Va,Vx)},Vn._removeAllComponent=function(){for(var Vn=0,Va=this._componentsMap.length;Vn<Va;this._componentsMap.length<Va?Va--:Vn++)this._removeComponentsByType(this._componentsMap[Vn])},Vn._updateComponents=function(Vn){for(var Va=0,VU=this._components.length;Va<VU;Va++){var Vx=this._components[Va];!Vx.started&&(Vx._start(Vn),Vx.started=!0),Vx.enable&&Vx._update(Vn)}},Vn._lateUpdateComponents=function(Vn){for(var Va=0;Va<this._components.length;Va++){var VU=this._components[Va];!VU.started&&(VU._start(Vn),VU.started=!0),VU.enable&&VU._lateUpdate(Vn)}},Vn._preRenderUpdateComponents=function(Vn){for(var Va=0;Va<this._components.length;Va++){var VU=this._components[Va];!VU.started&&(VU._start(Vn),VU.started=!0),VU.enable&&VU._preRenderUpdate(Vn)}},Vn._postRenderUpdateComponents=function(Vn){for(var Va=0;Va<this._components.length;Va++){var VU=this._components[Va];!VU.started&&(VU._start(Vn),VU.started=!0),VU.enable&&VU._postRenderUpdate(Vn)}},VE(0,Vn,"_loaded",null,function(Vn){this.__loaded=Vn}),VE(0,Vn,"fogColor",function(){return this._fogColor},function(Vn){this._fogColor=Vn,this._shaderValues.setValue(0,Vn.elements)}),VE(0,Vn,"enableFog",function(){return this._enableFog},function(Vn){this._enableFog!==Vn&&((this._enableFog=Vn)?(this.addShaderDefine(VNa.SHADERDEFINE_FOG),this.removeShaderDefine(VNa.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(VNa.SHADERDEFINE_FOG))}),VE(0,Vn,"url",function(){return this._url}),VE(0,Vn,"loaded",function(){return this.__loaded}),VE(0,Vn,"enableDepthFog",function(){return this._enableDepthFog},function(Vn){this._enableDepthFog!=Vn&&((this._enableDepthFog=Vn)?(this.addShaderDefine(VNa.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(VNa.SHADERDEFINE_FOG)):this.removeShaderDefine(VNa.SAHDERDEFINE_DEPTHFOG))}),VE(0,Vn,"fogStart",function(){return this._fogStart},function(Vn){this._fogStart=Vn,this._shaderValues.setValue(1,Vn)}),VE(0,Vn,"fogRange",function(){return this._fogRange},function(Vn){this._fogRange=Vn,this._shaderValues.setValue(2,Vn)}),VE(0,Vn,"ambientColor",function(){return this._ambientColor},function(Vn){this._ambientColor=Vn,this._shaderValues.setValue(21,Vn.elements)}),VE(0,Vn,"scene",function(){return this}),VE(0,Vn,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),Vx._sortScenes=function(Vn,Va){if(Vn.parent!==VY.stage||Va.parent!==VY.stage)return Vn.parent!==VY.stage&&Va.parent!==VY.stage?Vx._sortScenes(Vn.parent,Va.parent):Vn.parent===VY.stage?-1:1;var VU=VY.stage._childs;return VU.indexOf(Vn)-VU.indexOf(Va)},Vx.load=function(Vn){return VY.loader.create(Vn,null,null,Vx)},Vx.FOGCOLOR=0,Vx.FOGSTART=1,Vx.FOGRANGE=2,Vx.LIGHTDIRECTION=3,Vx.LIGHTDIRCOLOR=4,Vx.POINTLIGHTPOS=5,Vx.POINTLIGHTRANGE=6,Vx.POINTLIGHTATTENUATION=7,Vx.POINTLIGHTCOLOR=8,Vx.SPOTLIGHTPOS=9,Vx.SPOTLIGHTDIRECTION=10,Vx.SPOTLIGHTSPOT=11,Vx.SPOTLIGHTRANGE=12,Vx.SPOTLIGHTATTENUATION=13,Vx.SPOTLIGHTCOLOR=14,Vx.SHADOWDISTANCE=15,Vx.SHADOWLIGHTVIEWPROJECT=16,Vx.SHADOWMAPPCFOFFSET=17,Vx.SHADOWMAPTEXTURE1=18,Vx.SHADOWMAPTEXTURE2=19,Vx.SHADOWMAPTEXTURE3=20,Vx.AMBIENTCOLOR=21,Vx.TIME=22,Vx}(Vk),Vva=function(Vn){function Va(Vn){Va.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new Vna,this._shaderValues=new Via,this._colliders=[],this._id=++Va._uniqueIDCounter,this._transform=new VWa(this),this.name=Vn||"Sprite3D-"+Va._nameNumberCounter++,this.layer=VG.currentCreationLayer,this.active=!0}Vq(Va,"laya.d3.core.Sprite3D",VMa);var VU=Va.prototype;return VY.imps(VU,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),VU._setUrl=function(Vn){this._url=Vn},VU._getGroup=function(){return this._group},VU._setGroup=function(Vn){this._group=Vn},VU._addChild3D=function(Vn){Vn.transform.parent=this.transform,this._hierarchyAnimator&&(!Vn._hierarchyAnimator&&Vn._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(Vn,!0,[Vn.name])),this._scene&&(Vn._setBelongScene(this._scene),this._activeInHierarchy&&Vn._active&&Vn._activeHierarchy())},VU._removeChild3D=function(Vn){Vn.transform.parent=null,this._scene&&(this._activeInHierarchy&&Vn._active&&Vn._inActiveHierarchy(),Vn._setUnBelongScene()),this._hierarchyAnimator&&(Vn._hierarchyAnimator==this._hierarchyAnimator&&Vn._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(Vn,!1,[Vn.name]))},VU._parseBaseCustomProps=function(Vn){var Va=this.transform.localPosition;Vn.translate?(Va.fromArray(Vn.translate),Va.x*=100,Va.y*=100,Va.z*=100):Va.elements.fill(0),this.transform.localPosition=Va;var VU=this.transform.localRotation;Vn.rotation?VU.fromArray(Vn.rotation):VU.fromArray([0,0,0,-1]),this.transform.localRotation=VU;var Vx=this.transform.localScale;Vn.scale?Vx.fromArray(Vn.scale):Vx.elements.fill(1),this.transform.localScale=Vx;var VD=Vn.layer;null!=VD&&(this.layer=VG.getLayerByNumber(VD))},VU._parseCustomComponent=function(Vn,Va,VU){for(var Vx in VU){var VD=VU[Vx];switch(Vx){case"Animator":var Vp=this.addComponent(Animator);if(VD.avatarPath)Vp.avatar=VP.getRes(Va[VD.avatarPath]);else{var VQ=VD.avatar;if(VQ){Vp.avatar=VP.getRes(Va[VQ.path]);var VV=VQ.linkSprites;VV&&Vn.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[Vp,VV])}}for(var Vy=VD.clipPaths,VR=Vy.length,VX=0;VX<VR;VX++)Vp.addClip(VP.getRes(Va[Vy[VX]]));Vp.clip=VP.getRes(Va[Vy[0]]);var Vz=VD.playOnWake;void 0!==Vz&&(Vp.playOnWake=Vz);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var Vi=this.addComponent(SphereCollider);Vi.isTrigger=VD.isTrigger;var Vq=Vi.center;Vq.fromArray(VD.center),Vi.center=Vq,Vi.radius=VD.radius;break;case"BoxCollider":var VE=this.addComponent(BoxCollider);VE.isTrigger=VD.isTrigger,VE.center.fromArray(VD.center);var Vm=VE.size;Vm.fromArray(VD.size),VE.size=Vm;break;case"MeshCollider":this.addComponent(MeshCollider)}}},VU._onRootNodeHierarchyLoaded=function(Vn,Va){for(var VU in Va){for(var Vx=this,VD=Va[VU],Vp=0,VQ=VD.length;Vp<VQ;Vp++){var VV=VD[Vp];if(""===VV)break;if(!(Vx=Vx.getChildByName(VV)))break}Vx&&Vn.linkSprite3DToAvatarNode(VU,Vx)}},VU._setHierarchyAnimator=function(Vn,Va){this._changeHierarchyAnimator(Vn);for(var VU=0,Vx=this._childs.length;VU<Vx;VU++){var VD=this._childs[VU];VD._hierarchyAnimator==Va&&VD._setHierarchyAnimator(Vn,Va)}},VU._clearHierarchyAnimator=function(Vn,Va){this._changeHierarchyAnimator(Va);for(var VU=0,Vx=this._childs.length;VU<Vx;VU++){var VD=this._childs[VU];VD._hierarchyAnimator==Vn&&VD._clearHierarchyAnimator(Vn,Va)}},VU._getAnimatorToLinkSprite3D=function(Vn,Va,VU){var Vx=this.getComponentByType(Animator);if(Vx&&(Vx.avatar?Vx.avatar._version||Vn._setAnimatorToLinkAvatar(Vx,Va):Vn._setAnimatorToLinkSprite3DNoAvatar(Vx,Va,VU)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){VU.unshift(this._parent.name);var VD=this._parent;VD._hierarchyAnimator&&VD._getAnimatorToLinkSprite3D(Vn,Va,VU)}},VU._setAnimatorToLinkSprite3DNoAvatar=function(Vn,Va,VU){var Vx=0,VD=0;for(Vx=0,VD=Vn.getClipCount();Vx<VD;Vx++)Vn._handleSpriteOwnersBySprite(Vx,Va,VU,this);for(Vx=0,VD=this._childs.length;Vx<VD;Vx++){var Vp=this._childs[Vx],VQ=VU.length;VU.push(Vp.name),Vp._setAnimatorToLinkSprite3DNoAvatar(Vn,Va,VU),VU.splice(VQ,1)}},VU._changeHierarchyAnimator=function(Vn){this._hierarchyAnimator=Vn},VU._isLinkSpriteToAnimationNode=function(Vn,Va,VU){var Vx=Vn._avatarNodes.indexOf(Va),VD=Vn._cacheSpriteToNodesMap;if(VU)this._transform.dummy=Va.transform,Vn._cacheNodesToSpriteMap[Vx]=VD.length,VD.push(Vx);else{this._transform.dummy=null;var Vp=Vn._cacheNodesToSpriteMap[Vx];Vn._cacheNodesToSpriteMap[Vx]=null,VD.splice(Vp,1)}},VU._setBelongScene=function(Vn){this._scene=Vn;for(var Va=0,VU=this._childs.length;Va<VU;Va++)this._childs[Va]._setBelongScene(Vn)},VU._setUnBelongScene=function(){this._scene=null;for(var Vn=0,Va=this._childs.length;Vn<Va;Vn++)this._childs[Vn]._setUnBelongScene()},VU._activeHierarchy=function(){var Vn=0,Va=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),Vn=0,Va=this._colliders.length;Vn<Va;Vn++)this._layer._addCollider(this._colliders[Vn]);for(this.event("activeinhierarchychanged",!0),Vn=0,Va=this._childs.length;Vn<Va;Vn++){var VU=this._childs[Vn];VU._active&&VU._activeHierarchy()}},VU._inActiveHierarchy=function(){var Vn=0,Va=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),Vn=0,Va=this._colliders.length;Vn<Va;Vn++){var VU=this._colliders[Vn];VU._clearCollsionMap(),this._layer._removeCollider(VU)}for(this.event("activeinhierarchychanged",!1),Vn=0,Va=this._childs.length;Vn<Va;Vn++){var Vx=this._childs[Vn];Vx._active&&Vx._inActiveHierarchy()}},VU.addComponent=function(Vn){var Va,VU=this._componentsMap.indexOf(Vn);if(-1===VU)Va=[],this._componentsMap.push(Vn),this._typeComponentsIndices.push(Va);else if(Va=this._typeComponentsIndices[VU],this._components[Va[0]].isSingleton)throw new Error("无法单实例创建"+Vn+"组件，"+Vn+"组件已存在！");var Vx=VD.getInstance(Vn);return Va.push(this._components.length),this._components.push(Vx),Vx instanceof laya.d3.component.Script&&this._scripts.push(Vx),Vx._initialize(this),Vx},VU._removeComponent=function(Vn,Va){var VU,Vx=0,VD=this._typeComponentsIndices[Vn],Vp=VD[Va],VQ=this._components[Vp];for(VQ instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(VQ),1),VD.splice(Va,1),0===VD.length&&(this._typeComponentsIndices.splice(Vn,1),this._componentsMap.splice(Vn,1)),Vx=0,VU=this._componentsMap.length;Vx<VU;Vx++)for(var VV=(VD=this._typeComponentsIndices[Vx]).length-1;0<=VV;VV--){var Vy=VD[VV];if(!(Vp<Vy))break;VD[VV]=--Vy}VQ._destroy()},VU._clearSelfRenderObjects=function(){},VU._addSelfRenderObjects=function(){},VU._parseCustomProps=function(Vn,Va,VU,Vx){},VU._updateChilds=function(Vn){var Va=this._childs.length;if(0!==Va)for(var VU=0;VU<Va;++VU)this._childs[VU]._update(Vn)},VU._getSortID=function(Vn,Va){return 1e3*Va.id+Vn._getVertexBuffer().vertexDeclaration.id},VU._update=function(Vn){(Vn.owner=this)._activeInHierarchy&&(this._updateComponents(Vn),this._lateUpdateComponents(Vn),VN.spriteCount++,this._childs.length&&this._updateChilds(Vn))},VU.getProjectionViewWorldMatrix=function(Vn){return Vna.multiply(Vn,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},VU.loadHierarchy=function(Vn){this.addChild(laya.d3.core.Sprite3D.load(Vn))},VU.addChildAt=function(Vn,Va){if(!(Vn instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Vn||this.destroyed||Vn===this)return Vn;if(Vn.zOrder&&this._set$P("hasZorder",!0),0<=Va&&Va<=this._childs.length){if(Vn._parent===this){var VU=this.getChildIndex(Vn);this._childs.splice(VU,1),this._childs.splice(Va,0,Vn),this.conchModel&&(this.conchModel.removeChild(Vn.conchModel),this.conchModel.addChildAt(Vn.conchModel,Va)),this._childChanged()}else Vn.parent&&Vn.parent.removeChild(Vn),this._childs===VR.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Va,0,Vn),this.conchModel&&this.conchModel.addChildAt(Vn.conchModel,Va),(Vn.parent=this)._addChild3D(Vn);return Vn}throw new Error("appendChildAt:The index is out of bounds")},VU.addChild=function(Vn){if(!(Vn instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Vn||this.destroyed||Vn===this)return Vn;if(Vn.zOrder&&this._set$P("hasZorder",!0),Vn._parent===this){var Va=this.getChildIndex(Vn);Va!==this._childs.length-1&&(this._childs.splice(Va,1),this._childs.push(Vn),this.conchModel&&(this.conchModel.removeChild(Vn.conchModel),this.conchModel.addChildAt(Vn.conchModel,this._childs.length-1)),this._childChanged())}else Vn.parent&&Vn.parent.removeChild(Vn),this._childs===VR.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Vn),this.conchModel&&this.conchModel.addChildAt(Vn.conchModel,this._childs.length-1),(Vn.parent=this)._childChanged(),this._addChild3D(Vn);return Vn},VU.removeChildAt=function(Vn){var Va=this.getChildAt(Vn);return Va&&(this._removeChild3D(Va),this._childs.splice(Vn,1),this.conchModel&&this.conchModel.removeChild(Va.conchModel),Va.parent=null),Va},VU.removeChildren=function(Vn,Va){if(void 0===Vn&&(Vn=0),void 0===Va&&(Va=2147483647),this._childs&&0<this._childs.length){var VU=this._childs;if(0===Vn&&Vp<=Va){var Vx=VU;this._childs=VR.ARRAY_EMPTY}else Vx=VU.splice(Vn,Va-Vn);for(var VD=0,Vp=Vx.length;VD<Vp;VD++)this._removeChild3D(Vx[VD]),Vx[VD].parent=null,this.conchModel&&this.conchModel.removeChild(Vx[VD].conchModel)}return this},VU.onAsynLoaded=function(Vn,Va,VU){var Vx=Va[0];if("Sprite3D"!==Vx.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var VD=Va[1];Vba._createNodeByJson(this,Vx,this,VD),this.event("hierarchyloaded",[this]),this.__loaded=!0},VU.cloneTo=function(Vn){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var Va=Vn;Va.name=this.name,Va._destroyed=this._destroyed,Va.timer=this.timer,Va._$P=this._$P,Va.active=this._active;var VU=Va.transform.localPosition;this.transform.localPosition.cloneTo(VU),Va.transform.localPosition=VU;var Vx=Va.transform.localRotation;this.transform.localRotation.cloneTo(Vx),Va.transform.localRotation=Vx;var VD=Va.transform.localScale;this.transform.localScale.cloneTo(VD),Va.transform.localScale=VD,Va.isStatic=this.isStatic;var Vp=0,VQ=0;for(Vp=0,VQ=this._componentsMap.length;Vp<VQ;Vp++){var VV=Va.addComponent(this._componentsMap[Vp]);this._components[Vp]._cloneTo(VV)}for(Vp=0,VQ=this._childs.length;Vp<VQ;Vp++)Va.addChild(this._childs[Vp].clone());var Vy=Va.getComponentByType(Animator);if(Vy){var VR=Vy._linkSpritesData;if(VR)for(var VX in VR){for(var Vz=VR[VX],Vi=Va,Vq=0,VE=Vz.length;Vq<VE&&(Vi=Vi.getChildByName(Vz[Vq]));Vq++);if(Vi){var Vm=Vy._avatarNodeMap[VX];Vi._isLinkSpriteToAnimationNode(Vy,Vm,!0)}}}},VU.clone=function(){var Vn=new this.constructor;return this.cloneTo(Vn),Vn},VU.destroy=function(Vn){if(void 0===Vn&&(Vn=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,Vn);var Va,VU=0;for(VU=0,Va=this._components.length;VU<Va;VU++)this._components[VU]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,VP.clearRes(this.url),this.loaded||VPa._cancelLoadByUrl(this.url)}},VU._handleSpriteToAvatar=function(Vn,Va){Vn._avatarNodes;var VU=Vn._avatarNodeMap[this.name];VU&&VU.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(Vn,VU,Va)},VU._setAnimatorToLinkAvatar=function(Vn,Va){this._handleSpriteToAvatar(Vn,Va);for(var VU=0,Vx=this._childs.length;VU<Vx;VU++){this._childs[VU]._setAnimatorToLinkAvatar(Vn,Va)}},VE(0,VU,"activeInHierarchy",function(){return this._activeInHierarchy}),VE(0,VU,"_loaded",null,function(Vn){this.__loaded=Vn}),VE(0,VU,"active",function(){return this._active},function(Vn){this._active!==Vn&&(this._active=Vn,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(Vn?this._activeHierarchy():this._inActiveHierarchy()))}),VE(0,VU,"componentsCount",function(){return this._components.length}),VE(0,VU,"loaded",function(){return this.__loaded}),VE(0,VU,"id",function(){return this._id}),VE(0,VU,"url",function(){return this._url}),VE(0,VU,"layer",function(){return this._layer},function(Vn){if(this._layer!==Vn){if(!Vn)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var Va=0,VU=this._colliders.length;if(this._layer)for(Va=0;Va<VU;Va++)this._layer._removeCollider(this._colliders[Va]);for(Va=0;Va<VU;Va++)Vn._addCollider(this._colliders[Va])}this._layer=Vn,this.event("layerchanged",Vn)}}),VE(0,VU,"scene",function(){return this._scene}),VE(0,VU,"transform",function(){return this._transform}),Va.instantiate=function(Vn,Va,VU,Vx,VD){void 0===VU&&(VU=!0);var Vp=Vn.clone();Va&&Va.addChild(Vp);var VQ=Vp.transform;if(VU){var VV=VQ.worldMatrix;Vn.transform.worldMatrix.cloneTo(VV),VQ.worldMatrix=VV}else Vx&&(VQ.position=Vx),VD&&(VQ.rotation=VD);return Vp},Va.load=function(Vn){return VY.loader.create(Vn,null,null,Va)},Va.WORLDMATRIX=0,Va.MVPMATRIX=1,Va._uniqueIDCounter=0,Va._nameNumberCounter=0,Va}(),Vla=function(Vn){function VX(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],VX.__super.call(this),!Vn||!Va)throw"Shader Error";this._id=++VX._count,this._vs=Vn,this._ps=Va,this._attributeMap=VU,this._sceneUniformMap=Vx,this._cameraUniformMap=VD,this._spriteUniformMap=Vp,this._materialUniformMap=VQ,this._renderElementUniformMap=VV,this._precompile=Vy,this._define=VR,this._precompile&&VX.extCompileObj&&VX.extCompileFunc?VX.extCompileFunc.call(VX.extCompileObj,Vn,Va,VR):this.recreateResource()}Vq(VX,"laya.d3.shader.Shader3D",VU);var Va=VX.prototype;return Va.recreateResource=function(){VH.now();this._compile(),this.completeCreate(),this.memorySize=0},Va.disposeResource=function(){Vu.mainContext.deleteShader(this._vshader),Vu.mainContext.deleteShader(this._pshader),Vu.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},Va._compile=function(){if(!Vu.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var Vn=[this._vs,this._ps],Va=Vu.mainContext;if(this._program=Va.createProgram(),this._vshader=VX._createShader(Va,Vn[0],35633),this._pshader=VX._createShader(Va,Vn[1],35632),Va.attachShader(this._program,this._vshader),Va.attachShader(this._program,this._pshader),Va.linkProgram(this._program),!Vm.isConchApp&&VNa.debugMode&&!Va.getProgramParameter(this._program,35714))throw Va.getProgramInfoLog(this._program);var VU,Vx=0,VD=0,Vp=0;for(Vp=Vm.isConchApp?Va.getProgramParameterEx(this._vs,this._ps,"",35721):Va.getProgramParameter(this._program,35721),Vx=0;Vx<Vp;Vx++){var VQ=null;VU={vartype:"attribute",ivartype:0,attrib:VQ=Vm.isConchApp?Va.getActiveAttribEx(this._vs,this._ps,"",Vx):Va.getActiveAttrib(this._program,Vx),location:Va.getAttribLocation(this._program,VQ.name),name:VQ.name,type:VQ.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(VU)}var VV=0;for(VV=Vm.isConchApp?Va.getProgramParameterEx(this._vs,this._ps,"",35718):Va.getProgramParameter(this._program,35718),Vx=0;Vx<VV;Vx++){var Vy=null;Vy=Vm.isConchApp?Va.getActiveUniformEx(this._vs,this._ps,"",Vx):Va.getActiveUniform(this._program,Vx),0<(VU={vartype:"uniform",ivartype:1,attrib:VQ,location:Va.getUniformLocation(this._program,Vy.name),name:Vy.name,type:Vy.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(VU.name=VU.name.substr(0,VU.name.length-3),VU.isArray=!0,VU.location=Va.getUniformLocation(this._program,VU.name)),this._uniformParams.push(VU)}for(Vx=0,VD=this._attributeParams.length;Vx<VD;Vx++)(VU=this._attributeParams[Vx]).indexOfParams=Vx,VU.index=1,VU.value=[VU.location,null],VU.codename=VU.name,VU.name=null!=this._attributeMap[VU.codename]?this._attributeMap[VU.codename]:VU.codename,this._attributeParamsMap.push(VU.name),this._attributeParamsMap.push(VU),VU._this=this,VU.uploadedValue=[],VU.fun=this._attribute;for(Vx=0,VD=this._uniformParams.length;Vx<VD;Vx++)switch((VU=this._uniformParams[Vx]).indexOfParams=Vx,VU.index=1,VU.value=[VU.location,null],VU.codename=VU.name,null!=this._sceneUniformMap[VU.codename]?(VU.name=this._sceneUniformMap[VU.codename],this._sceneUniformParamsMap.push(VU.name),this._sceneUniformParamsMap.push(VU)):null!=this._cameraUniformMap[VU.codename]?(VU.name=this._cameraUniformMap[VU.codename],this._cameraUniformParamsMap.push(VU.name),this._cameraUniformParamsMap.push(VU)):null!=this._spriteUniformMap[VU.codename]?(VU.name=this._spriteUniformMap[VU.codename],this._spriteUniformParamsMap.push(VU.name),this._spriteUniformParamsMap.push(VU)):null!=this._materialUniformMap[VU.codename]?(VU.name=this._materialUniformMap[VU.codename],this._materialUniformParamsMap.push(VU.name),this._materialUniformParamsMap.push(VU)):null!=this._renderElementUniformMap[VU.codename]?(VU.name=this._renderElementUniformMap[VU.codename],this._renderElementUniformParamsMap.push(VU.name),this._renderElementUniformParamsMap.push(VU)):console.log("Shader:can't find uinform name:"+VU.codename+" in shader file."),VU._this=this,VU.uploadedValue=[],VU.type){case 5124:VU.fun=VU.isArray?this._uniform1iv:this._uniform1i;break;case 5126:VU.fun=VU.isArray?this._uniform1fv:this._uniform1f;break;case 35664:VU.fun=VU.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:VU.fun=VU.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:VU.fun=VU.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:VU.fun=this._uniform_sampler2D;break;case 35680:VU.fun=this._uniform_samplerCube;break;case 35676:VU.fun=this._uniformMatrix4fv;break;case 35670:VU.fun=this._uniform1i;break;case 35674:VU.fun=this._uinformMatrix2fv;break;case 35675:VU.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},Va._attribute=function(Vn,Va){var VU=Vu.mainContext,Vx=VV._enableAtributes,VD=Vn.location;return Vx[VD]||VU.enableVertexAttribArray(VD),VU.vertexAttribPointer(VD,Va[0],Va[1],Va[2],Va[3],Va[4]),Vx[VD]=VV._bindVertexBuffer,1},Va._uniform1f=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va?(Vu.mainContext.uniform1f(Vn.location,VU[0]=Va),1):0},Va._uniform1fv=function(Vn,Va){if(Va.length<4){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]||VU[2]!==Va[2]||VU[3]!==Va[3]?(Vu.mainContext.uniform1fv(Vn.location,Va),VU[0]=Va[0],VU[1]=Va[1],VU[2]=Va[2],VU[3]=Va[3],1):0}return Vu.mainContext.uniform1fv(Vn.location,Va),1},Va._uniform_vec2=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]?(Vu.mainContext.uniform2f(Vn.location,VU[0]=Va[0],VU[1]=Va[1]),1):0},Va._uniform_vec2v=function(Vn,Va){if(Va.length<2){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]||VU[2]!==Va[2]||VU[3]!==Va[3]?(Vu.mainContext.uniform2fv(Vn.location,Va),VU[0]=Va[0],VU[1]=Va[1],VU[2]=Va[2],VU[3]=Va[3],1):0}return Vu.mainContext.uniform2fv(Vn.location,Va),1},Va._uniform_vec3=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]||VU[2]!==Va[2]?(Vu.mainContext.uniform3f(Vn.location,VU[0]=Va[0],VU[1]=Va[1],VU[2]=Va[2]),1):0},Va._uniform_vec3v=function(Vn,Va){return Vu.mainContext.uniform3fv(Vn.location,Va),1},Va._uniform_vec4=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]||VU[2]!==Va[2]||VU[3]!==Va[3]?(Vu.mainContext.uniform4f(Vn.location,VU[0]=Va[0],VU[1]=Va[1],VU[2]=Va[2],VU[3]=Va[3]),1):0},Va._uniform_vec4v=function(Vn,Va){return Vu.mainContext.uniform4fv(Vn.location,Va),1},Va._uniformMatrix2fv=function(Vn,Va){return Vu.mainContext.uniformMatrix2fv(Vn.location,!1,Va),1},Va._uniformMatrix3fv=function(Vn,Va){return Vu.mainContext.uniformMatrix3fv(Vn.location,!1,Va),1},Va._uniformMatrix4fv=function(Vn,Va){return Vu.mainContext.uniformMatrix4fv(Vn.location,!1,Va),1},Va._uinformMatrix2fv=function(Vn,Va){return Vu.mainContext.uniformMatrix2fv(Vn.location,!1,Va),1},Va._uinformMatrix3fv=function(Vn,Va){return Vu.mainContext.uniformMatrix3fv(Vn.location,!1,Va),1},Va._uniform1i=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va?(Vu.mainContext.uniform1i(Vn.location,VU[0]=Va),1):0},Va._uniform1iv=function(Vn,Va){return Vu.mainContext.uniform1iv(Vn.location,Va),1},Va._uniform_ivec2=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]?(Vu.mainContext.uniform2i(Vn.location,VU[0]=Va[0],VU[1]=Va[1]),1):0},Va._uniform_ivec2v=function(Vn,Va){return Vu.mainContext.uniform2iv(Vn.location,Va),1},Va._uniform_vec3i=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]||VU[2]!==Va[2]?(Vu.mainContext.uniform3i(Vn.location,VU[0]=Va[0],VU[1]=Va[1],VU[2]=Va[2]),1):0},Va._uniform_vec3vi=function(Vn,Va){return Vu.mainContext.uniform3iv(Vn.location,Va),1},Va._uniform_vec4i=function(Vn,Va){var VU=Vn.uploadedValue;return VU[0]!==Va[0]||VU[1]!==Va[1]||VU[2]!==Va[2]||VU[3]!==Va[3]?(Vu.mainContext.uniform4i(Vn.location,VU[0]=Va[0],VU[1]=Va[1],VU[2]=Va[2],VU[3]=Va[3]),1):0},Va._uniform_vec4vi=function(Vn,Va){return Vu.mainContext.uniform4iv(Vn.location,Va),1},Va._uniform_sampler2D=function(Vn,Va){var VU=Va.source||Va.defaulteTexture.source,Vx=Vu.mainContext,VD=Vn.uploadedValue;if(null!=VD[0])return Vx.activeTexture(VX._TEXTURES[VD[0]]),VU&&Vc.bindTexture(Vx,3553,VU),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return VD[0]=this._curActTexIndex,Vx.uniform1i(Vn.location,this._curActTexIndex),Vx.activeTexture(VX._TEXTURES[this._curActTexIndex]),VU&&Vc.bindTexture(Vx,3553,VU),this._curActTexIndex++,1},Va._uniform_samplerCube=function(Vn,Va){var VU=Va.source||Va.defaulteTexture.source,Vx=Vu.mainContext,VD=Vn.uploadedValue;if(null!=VD[0])return Vx.activeTexture(VX._TEXTURES[VD[0]]),VU?Vc.bindTexture(Vx,34067,VU):Vc.bindTexture(Vx,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return VD[0]=this._curActTexIndex,Vx.uniform1i(Vn.location,this._curActTexIndex),Vx.activeTexture(VX._TEXTURES[this._curActTexIndex]),VU?Vc.bindTexture(Vx,34067,VU):Vc.bindTexture(Vx,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},Va._noSetValue=function(Vn){console.log("no....:"+Vn.name)},Va.bind=function(){return VU.activeShader=this,(VU.bindShader=this).activeResource(),Vc.UseProgram(this._program)},Va.uploadAttributes=function(Vn,Va){for(var VU,Vx,VD=0,Vp=0,VQ=this._attributeParamsMap.length;Vp<VQ;Vp+=2)Vx=this._attributeParamsMap[Vp+1],null!=(VU=Vn[this._attributeParamsMap[Vp]])&&(Va&&Va[Vx.name]&&Va[Vx.name].bind(),VD+=Vx.fun.call(this,Vx,VU));VN.shaderCall+=VD},Va.uploadAttributesX=function(Vn,Va){for(var VU,Vx,VD=0,Vp=0,VQ=this._attributeParamsMap.length;Vp<VQ;Vp+=2)Vx=this._attributeParamsMap[Vp+1],null!=(VU=Vn[this._attributeParamsMap[Vp]])&&(Va._bind(),VD+=Vx.fun.call(this,Vx,VU));VN.shaderCall+=VD},Va.uploadSceneUniforms=function(Vn){for(var Va,VU,Vx=0,VD=0,Vp=this._sceneUniformParamsMap.length;VD<Vp;VD+=2)VU=this._sceneUniformParamsMap[VD+1],null!=(Va=Vn[this._sceneUniformParamsMap[VD]])&&(Vx+=VU.fun.call(this,VU,Va));VN.shaderCall+=Vx},Va.uploadCameraUniforms=function(Vn){for(var Va,VU,Vx=0,VD=0,Vp=this._cameraUniformParamsMap.length;VD<Vp;VD+=2)VU=this._cameraUniformParamsMap[VD+1],null!=(Va=Vn[this._cameraUniformParamsMap[VD]])&&(Vx+=VU.fun.call(this,VU,Va));VN.shaderCall+=Vx},Va.uploadSpriteUniforms=function(Vn){for(var Va,VU,Vx=0,VD=0,Vp=this._spriteUniformParamsMap.length;VD<Vp;VD+=2)VU=this._spriteUniformParamsMap[VD+1],null!=(Va=Vn[this._spriteUniformParamsMap[VD]])&&(Vx+=VU.fun.call(this,VU,Va));VN.shaderCall+=Vx},Va.uploadMaterialUniforms=function(Vn){for(var Va,VU,Vx=0,VD=0,Vp=this._materialUniformParamsMap.length;VD<Vp;VD+=2)VU=this._materialUniformParamsMap[VD+1],null!=(Va=Vn[this._materialUniformParamsMap[VD]])&&(Vx+=VU.fun.call(this,VU,Va));VN.shaderCall+=Vx},Va.uploadRenderElementUniforms=function(Vn){for(var Va,VU,Vx=0,VD=0,Vp=this._renderElementUniformParamsMap.length;VD<Vp;VD+=2)VU=this._renderElementUniformParamsMap[VD+1],null!=(Va=Vn[this._renderElementUniformParamsMap[VD]])&&(Vx+=VU.fun.call(this,VU,Va));VN.shaderCall+=Vx},VX.create=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){return new VX(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR)},VX.addInclude=function(Vn,Va){VT.addInclude(Vn,Va)},VX._createShader=function(Vn,Va,VU){var Vx=Vn.createShader(VU);if(Vn.shaderSource(Vx,Va),Vn.compileShader(Vx),VNa.debugMode&&!Vn.getShaderParameter(Vx,35713))throw Vn.getShaderInfoLog(Vx);return Vx},VX.PERIOD_RENDERELEMENT=0,VX.PERIOD_MATERIAL=1,VX.PERIOD_SPRITE=2,VX.PERIOD_CAMERA=3,VX.PERIOD_SCENE=4,VX._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],VX._count=0,VX._preCompile=!1,VX.extCompileFunc=null,VX.extCompileObj=null,Vz(VX,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new V_}]),VX}(),Vja=function(VV){function Vy(){this._transformUV=null,Vy.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new VQa(.6,.6,.6)),this._setColor(10,new VQa(1,1,1)),this._setColor(11,new VVa(1,1,1,8)),this._setColor(12,new VQa(1,1,1)),this._setColor(7,new VVa(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new VVa(1,1,0,0)),this.renderMode=1}Vq(Vy,"laya.d3.core.material.StandardMaterial",VV);var Vn=Vy.prototype;return Vn.disableLight=function(){this._addDisablePublicShaderDefine(VNa.SHADERDEFINE_POINTLIGHT|VNa.SHADERDEFINE_SPOTLIGHT|VNa.SHADERDEFINE_DIRECTIONLIGHT)},Vn.disableFog=function(){this._addDisablePublicShaderDefine(VNa.SHADERDEFINE_FOG)},Vn.onAsynLoaded=function(Vn,Va,VU){var Vx=Va[0];if(Vx.version)VV.prototype.onAsynLoaded.call(this,Vn,Va,VU);else{var VD=Va[1],Vp=Vx.props;for(var VQ in Vp)this[VQ]=Vp[VQ];Vy._parseStandardMaterial(VD,this,Vx),this._endLoaded()}},Vn.cloneTo=function(Vn){VV.prototype.cloneTo.call(this,Vn);var Va=Vn;this._transformUV&&(Va._transformUV=this._transformUV.clone())},VE(0,Vn,"ambientColor",function(){return this._getColor(9)},function(Vn){this._setColor(9,Vn)}),VE(0,Vn,"ambientTexture",function(){return this._getTexture(5)},function(Vn){Vn?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,Vn)}),VE(0,Vn,"renderMode",null,function(Vn){switch(Vn){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Vy.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(Vn)}),VE(0,Vn,"reflectColor",function(){return this._getColor(12)},function(Vn){this._setColor(12,Vn)}),VE(0,Vn,"tilingOffset",function(){return this._getColor(15)},function(Vn){if(Vn){var Va=Vn.elements;1!=Va[0]||1!=Va[1]||0!=Va[2]||0!=Va[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,Vn)}),VE(0,Vn,"albedo",function(){return this._getColor(7)},function(Vn){this._setColor(7,Vn)}),VE(0,Vn,"diffuseColor",function(){return this._getColor(10)},function(Vn){this._setColor(10,Vn)}),VE(0,Vn,"albedoColor",function(){return this._getColor(7)},function(Vn){this._setColor(7,Vn)}),VE(0,Vn,"specularColor",function(){return this._getColor(11)},function(Vn){this._setColor(11,Vn)}),VE(0,Vn,"diffuseTexture",function(){return this._getTexture(1)},function(Vn){Vn?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,Vn)}),VE(0,Vn,"normalTexture",function(){return this._getTexture(2)},function(Vn){Vn?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,Vn)}),VE(0,Vn,"specularTexture",function(){return this._getTexture(3)},function(Vn){Vn?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,Vn)}),VE(0,Vn,"emissiveTexture",function(){return this._getTexture(4)},function(Vn){Vn?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,Vn)}),VE(0,Vn,"reflectTexture",function(){return this._getTexture(6)},function(Vn){Vn?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,Vn)}),VE(0,Vn,"transformUV",function(){return this._transformUV},function(Vn){this._transformUV=Vn,this._setMatrix4x4(13,Vn.matrix),Vn?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,Vn.matrix.elements,0)}),Vy.__init__=function(){Vy.SHADERDEFINE_DIFFUSEMAP=Vy.shaderDefines.registerDefine("DIFFUSEMAP"),Vy.SHADERDEFINE_NORMALMAP=Vy.shaderDefines.registerDefine("NORMALMAP"),Vy.SHADERDEFINE_SPECULARMAP=Vy.shaderDefines.registerDefine("SPECULARMAP"),Vy.SHADERDEFINE_EMISSIVEMAP=Vy.shaderDefines.registerDefine("EMISSIVEMAP"),Vy.SHADERDEFINE_AMBIENTMAP=Vy.shaderDefines.registerDefine("AMBIENTMAP"),Vy.SHADERDEFINE_REFLECTMAP=Vy.shaderDefines.registerDefine("REFLECTMAP"),Vy.SHADERDEFINE_UVTRANSFORM=Vy.shaderDefines.registerDefine("UVTRANSFORM"),Vy.SHADERDEFINE_TILINGOFFSET=Vy.shaderDefines.registerDefine("TILINGOFFSET"),Vy.SHADERDEFINE_ADDTIVEFOG=Vy.shaderDefines.registerDefine("ADDTIVEFOG")},Vy.load=function(Vn){return VY.loader.create(Vn,null,null,Vy)},Vy._parseStandardMaterial=function(Vn,Va,VU){var Vx=VU.customProps,VD=Vx.ambientColor;Va.ambientColor=new VQa(VD[0],VD[1],VD[2]);var Vp=Vx.diffuseColor;Va.diffuseColor=new VQa(Vp[0],Vp[1],Vp[2]);var VQ=Vx.specularColor;Va.specularColor=new VVa(VQ[0],VQ[1],VQ[2],VQ[3]);var VV=Vx.reflectColor;Va.reflectColor=new VQa(VV[0],VV[1],VV[2]);var Vy=Vx.albedoColor;Vy&&(Va.albedo=new VVa(Vy[0],Vy[1],Vy[2],Vy[3]));var VR=Vx.diffuseTexture.texture2D;VR&&(Va.diffuseTexture=VP.getRes(Vn[VR]));var VX=Vx.normalTexture.texture2D;VX&&(Va.normalTexture=VP.getRes(Vn[VX]));var Vz=Vx.specularTexture.texture2D;Vz&&(Va.specularTexture=VP.getRes(Vn[Vz]));var Vi=Vx.emissiveTexture.texture2D;Vi&&(Va.emissiveTexture=VP.getRes(Vn[Vi]));var Vq=Vx.ambientTexture.texture2D;Vq&&(Va.ambientTexture=VP.getRes(Vn[Vq]));var VE=Vx.reflectTexture.texture2D;VE&&(Va.reflectTexture=VP.getRes(Vn[VE]))},Vy.RENDERMODE_OPAQUE=1,Vy.RENDERMODE_OPAQUEDOUBLEFACE=2,Vy.RENDERMODE_CUTOUT=3,Vy.RENDERMODE_CUTOUTDOUBLEFACE=4,Vy.RENDERMODE_TRANSPARENT=13,Vy.RENDERMODE_TRANSPARENTDOUBLEFACE=14,Vy.RENDERMODE_ADDTIVE=15,Vy.RENDERMODE_ADDTIVEDOUBLEFACE=16,Vy.RENDERMODE_DEPTHREAD_TRANSPARENT=5,Vy.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,Vy.RENDERMODE_DEPTHREAD_ADDTIVE=7,Vy.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,Vy.RENDERMODE_NONDEPTH_TRANSPARENT=9,Vy.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,Vy.RENDERMODE_NONDEPTH_ADDTIVE=11,Vy.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,Vy.SHADERDEFINE_DIFFUSEMAP=0,Vy.SHADERDEFINE_NORMALMAP=0,Vy.SHADERDEFINE_SPECULARMAP=0,Vy.SHADERDEFINE_EMISSIVEMAP=0,Vy.SHADERDEFINE_AMBIENTMAP=0,Vy.SHADERDEFINE_REFLECTMAP=0,Vy.SHADERDEFINE_UVTRANSFORM=0,Vy.SHADERDEFINE_TILINGOFFSET=0,Vy.SHADERDEFINE_ADDTIVEFOG=0,Vy.DIFFUSETEXTURE=1,Vy.NORMALTEXTURE=2,Vy.SPECULARTEXTURE=3,Vy.EMISSIVETEXTURE=4,Vy.AMBIENTTEXTURE=5,Vy.REFLECTTEXTURE=6,Vy.ALBEDO=7,Vy.UVANIAGE=8,Vy.MATERIALAMBIENT=9,Vy.MATERIALDIFFUSE=10,Vy.MATERIALSPECULAR=11,Vy.MATERIALREFLECT=12,Vy.UVMATRIX=13,Vy.UVAGE=14,Vy.TILINGOFFSET=15,Vz(Vy,["defaultMaterial",function(){var Vn=new Vy;return Vn.lock=!0,this.defaultMaterial=Vn},"shaderDefines",function(){return this.shaderDefines=new VXa(VZa.shaderDefines)}]),Vy}(VZa),Vha=function(Vn){function VQ(Vn,Va,VU,Vx,VD){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===VU&&(VU=35044),void 0===Vx&&(Vx=!1),VQ.__super.call(this),this._indexType=Vn,this._indexCount=Va,this._bufferUsage=VU,this._bufferType=34963,this._canRead=Vx;var Vp;if("ushort"==Vn)this._indexTypeByteCount=2;else{if("ubyte"!=Vn)throw new Error("unidentification index type.");this._indexTypeByteCount=1}Vp=this._indexTypeByteCount*Va,this._byteLength=Vp,this._bind(),VV._gl.bufferData(this._bufferType,Vp,this._bufferUsage),this.uri=VD,Vx?("ushort"==Vn?this._buffer=new Uint16Array(Va):"ubyte"==Vn&&(this._buffer=new Uint8Array(Va)),this.memorySize=2*Vp):this.memorySize=Vp}Vq(VQ,"laya.d3.graphics.IndexBuffer3D",Vn);var Va=VQ.prototype;return Va.setData=function(Vn,Va,VU,Vx){void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=4294967295);var VD=0;if("ushort"==this._indexType?(VD=2,0===VU&&4294967295===Vx||(Vn=new Uint16Array(Vn.buffer,VU*VD,Vx))):"ubyte"==this._indexType&&(VD=1,0===VU&&4294967295===Vx||(Vn=new Uint8Array(Vn.buffer,VU*VD,Vx))),this._bind(),VV._gl.bufferSubData(this._bufferType,Va*VD,Vn),this._canRead)if(0!==Va||0!==VU||4294967295!==Vx){var Vp=this._buffer.length-Va;Vp<Vx&&(Vx=Vp);for(var VQ=0;VQ<Vx;VQ++)this._buffer[Va+VQ]=Vn[VQ]}else this._buffer=Vn},Va.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},Va.disposeResource=function(){Vn.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},VE(0,Va,"indexType",function(){return this._indexType}),VE(0,Va,"indexTypeByteCount",function(){return this._indexTypeByteCount}),VE(0,Va,"indexCount",function(){return this._indexCount}),VE(0,Va,"canRead",function(){return this._canRead}),VQ.INDEXTYPE_UBYTE="ubyte",VQ.INDEXTYPE_USHORT="ushort",VQ.create=function(Vn,Va,VU,Vx,VD){return void 0===VU&&(VU=35044),void 0===Vx&&(Vx=!1),new VQ(Vn,Va,VU,Vx,VD)},VQ}(VV),Vfa=function(Vp){function VQ(Vn,Va,VU,Vx,VD){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===Vx&&(Vx=!1),VQ.__super.call(this),this._vertexDeclaration=Vn,this._vertexCount=Va,this._bufferUsage=VU,this._bufferType=34962,this._canRead=Vx,this.uri=VD,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*Va,this._bind(),VV._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),Vx&&(this._buffer=new Float32Array(this._byteLength/4))}Vq(VQ,"laya.d3.graphics.VertexBuffer3D",Vp);var Vn=VQ.prototype;return Vn.bindWithIndexBuffer=function(Vn){Vn&&Vn._bind(),this._bind()},Vn.setData=function(Vn,Va,VU,Vx){if(void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=4294967295),0===VU&&4294967295===Vx||(Vn=new Float32Array(Vn.buffer,4*VU,Vx)),this._bind(),VV._gl.bufferSubData(this._bufferType,4*Va,Vn),this._canRead)if(0!==Va||0!==VU||4294967295!==Vx){var VD=this._buffer.length-Va;VD<Vx&&(Vx=VD);for(var Vp=0;Vp<Vx;Vp++)this._buffer[Va+Vp]=Vn[Vp]}else this._buffer=Vn},Vn.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},Vn.disposeResource=function(){for(var Vn=Vu.mainContext,Va=this._vertexDeclaration.getVertexElements(),VU=VV._enableAtributes,Vx=0,VD=Va.length;Vx<VD;Vx++)VU[Vx]===this._glBuffer&&(Vn.disableVertexAttribArray(Vx),VU[Vx]=null);Vp.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},VE(0,Vn,"vertexDeclaration",function(){return this._vertexDeclaration}),VE(0,Vn,"vertexCount",function(){return this._vertexCount}),VE(0,Vn,"canRead",function(){return this._canRead}),VQ.create=function(Vn,Va,VU,Vx,VD){return void 0===VU&&(VU=35044),void 0===Vx&&(Vx=!1),new VQ(Vn,Va,VU,Vx,VD)},VQ}(VV),VFa=function(Vn){function VT(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,VT.__super.call(this),this._type=3553}Vq(VT,"laya.d3.resource.DataTexture2D",Vua);var Va=VT.prototype;return Va.genDebugMipmaps=function(){var Vn=[];return Vn.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),Vn.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),Vn.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),Vn.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),Vn.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),Vn.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),Vn.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),Vn.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),Vn.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),Vn.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),Vn},Va._onTextureLoaded=function(Vn){},Va._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var Vn=Vu.mainContext,Va=this._source=Vn.createTexture(),VU=this._width,Vx=this._height,VD=Vc.curBindTexTarget,Vp=Vc.curBindTexValue,VQ=!1;if(Vc.bindTexture(Vn,this._type,Va),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var VV=0;Vn.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var Vy=0;Vy<this._mipmaps.length;Vy++){if(this._mipmaps[Vy].byteLength!=VR*VX*4)throw"mipmap size error  level:"+Vy;Vn.texSubImage2D(this._type,0,VT.simLodRect[VV++],VT.simLodRect[VV++],VT.simLodRect[VV++],VT.simLodRect[VV++],6408,5121,new Uint8Array(this._mipmaps[Vy]))}this.minFifter=9729,this.magFifter=9729}else{var VR=this._width,VX=this._height;for(VV=0,Vn.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),Vy=0;Vy<this._mipmaps.length;Vy++){if(this._mipmaps[Vy].byteLength!=VR*VX*4)throw"mipmap size error  level:"+Vy;Vn.texImage2D(this._type,Vy,6408,VR,VX,0,6408,5121,new Uint8Array(this._mipmaps[Vy])),(VR/=2)<1&&(VR=1),(VX/=2)<1&&(VX=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&Vn.pixelStorei(Vn.UNPACK_ALIGNMENT,1),Vn.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var Vz=0,Vi=!1,Vq=!1;this._buffer.byteLength==4*VU*Vx?(Vz=6408,Vi=!0):this._buffer.byteLength==3*VU*Vx?(Vz=6407,Vq=!0):Vz=this._format,Vi||Vq?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),Vq&&Vn.pixelStorei(Vn.UNPACK_ALIGNMENT,1),Vn.texImage2D(this._type,0,Vz,VU,Vx,0,Vz,5121,this._buffer)):Vn&&Vz==Vn.ALPHA?(Vn.texImage2D(3553,0,Vz,VU,Vx,0,Vz,Vn.UNSIGNED_BYTE,this._buffer),VQ=!0):0!=Vz&&(Vn.compressedTexImage2D(3553,0,Vz,VU,Vx,0,this._buffer),VQ=!0)}var VE=this._minFifter,Vm=this._magFifter,Vb=0==this._wrapModeU?10497:33071,VP=0==this._wrapModeV?10497:33071,VA=VK.isPOT(VU,Vx);VA?(this._mipmap||this._mipmaps?-1!==VE||(VE=9987):-1!==VE||(VE=9729),-1!==Vm||(Vm=9729),Vn.texParameteri(this._type,10241,VE),Vn.texParameteri(this._type,10240,Vm),Vn.texParameteri(this._type,10242,Vb),Vn.texParameteri(this._type,10243,VP),this._mipmap&&Vn.generateMipmap(this._type)):(-1!==VE||(VE=9729),-1!==Vm||(Vm=9729),Vn.texParameteri(this._type,10241,VE),Vn.texParameteri(this._type,10240,Vm),Vn.texParameteri(this._type,10242,33071),Vn.texParameteri(this._type,10243,33071)),VD&&Vp&&Vc.bindTexture(Vn,VD,Vp),this.memorySize=VQ?this._buffer.length:VA?VU*Vx*4*(1+1/3):VU*Vx*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},Va.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},Va.onAsynLoaded=function(Vn,Va,VU){var Vx;VU&&(Vx=VU[0].call(this,Va)),Vx&&(this._width=Vx.width,this._height=Vx.height,this._buffer=Vx.data),this._src=Vn,this._size=new Vma(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},Va.getPixels=function(){return new Uint8Array(this._buffer)},Va.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(Vu.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},VE(0,Va,"src",function(){return this._src}),VT.create=function(Vn,Va,VU,Vx,VD,Vp,VQ){if(void 0===Vx&&(Vx=9729),void 0===VD&&(VD=9729),void 0===Vp&&(Vp=!0),!Vn||Vn.byteLength<Va*VU*4)throw"DataTexture2D create error";var VV=new VT;return VV.uri=VQ,VV._buffer=Vn,VV._width=Va,VV._height=VU,VV._mipmap=Vp,VV._magFifter=Vx,VV._minFifter=VD,VV._size=new Vma(VV._width,VV._height),VV._conchTexture?alert("怎么给runtime传递datatexture数据"):VV.activeResource(),VV},VT.load=function(Vn,Va,VU,Vx,VD){if(void 0===Va&&(Va=0),void 0===VU&&(VU=0),void 0===Vx&&(Vx=9729),void 0===VD&&(VD=9729),"mipmaps"===V$.getFileExtension(Vn)){var Vp=VY.loader.create(Vn,null,null,VT,[function(Vn){this._mipmaps=[];var Va=new Uint32Array(Vn);this._width=Va[0];var VU=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,VU=1024),this._width!=VU)throw"现在只支持512x256的环境贴图。当前的是"+Va[0];this._height=Va[1];for(var Vx=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,VD=this._height,Vp=8;;){var VQ=Vx*VD*4;if(Vp+VQ>Vn.byteLength)throw"load mipmaps data size error ";var VV=new Uint8Array(Vn,Vp,VQ);if(this._mipmaps.push(VV),Vp+=VQ,1==Vx&&1==VD)break;(Vx/=2)<1&&(Vx=1),(VD/=2)<1&&(VD=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){Vp.simLodInfo=new Float32Array(40);for(var VQ=0;VQ<Vp.simLodInfo.length;)Vp.simLodInfo[VQ]=(VT.simLodRect[VQ]+.5)/1024,VQ++,Vp.simLodInfo[VQ]=(VT.simLodRect[VQ]+.5)/256,VQ++,Vp.simLodInfo[VQ]=Math.max(VT.simLodRect[VQ]-1,.1)/1024,VQ++,Vp.simLodInfo[VQ]=Math.max(VT.simLodRect[VQ]-1.5,.1)/256,VQ++}return Vp}if("number"==typeof Va)return VY.loader.create(Vn,null,null,VT,[function(Vn){return this._width=Va,this._height=VU,this._buffer=Vn,null}]);if("function"==typeof Va)return VY.loader.create(Vn,null,null,VT,[Va]);throw new Error("unknown params.")},VT.lodasatlas=!1,Vz(VT,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),VT}(),Vga=function(Vn){function Va(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,Va.__super.call(this)}Vq(Va,"laya.d3.resource.models.PrimitiveMesh",Vca);var VU=Va.prototype;return VY.imps(VU,{"laya.d3.core.render.IRenderable":!0}),VU._getVertexBuffer=function(Vn){return void 0===Vn&&(Vn=0),0===Vn?this._vertexBuffer:null},VU._getVertexBuffers=function(){return null},VU._getIndexBuffer=function(){return this._indexBuffer},VU._getPositions=function(){var Vn,Va=[],VU=this._vertexBuffer.vertexDeclaration.getVertexElements(),Vx=0;for(Vx=0;Vx<VU.length;Vx++){var VD=VU[Vx];if("vector3"===VD.elementFormat&&0===VD.elementUsage){Vn=VD;break}}var Vp=this._vertexBuffer.getData();for(Vx=0;Vx<Vp.length;Vx+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var VQ=Vx+Vn.offset/4,VV=new VQa(Vp[VQ+0],Vp[VQ+1],Vp[VQ+2]);Va.push(VV)}return Va},VU.getRenderElement=function(Vn){return this},VU.getRenderElementsCount=function(){return 1},VU.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},VU._beforeRender=function(Vn){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},VU._render=function(Vn){Vu.mainContext.drawElements(4,this._numberIndices,5123,0),VN.drawCall++,VN.trianglesFaces+=this._numberIndices/3},VE(0,VU,"_vertexBufferCount",function(){return 1}),VE(0,VU,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Va}(),Voa=function(Vn){function Va(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,Va.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}Vq(Va,"laya.d3.resource.models.Mesh",Vca);var VU=Va.prototype;return VU._getPositions=function(){var Vn,Va,VU,Vx,VD,Vp=[],VQ=0,VV=0,Vy=0;if(0!==this._vertexBuffers.length){var VR=this._vertexBuffers.length;for(VQ=0;VQ<VR;VQ++){for(VU=(Vn=this._vertexBuffers[VQ]).vertexDeclaration.getVertexElements(),VV=0;VV<VU.length;VV++)if("vector3"===(Vx=VU[VV]).elementFormat&&0===Vx.elementUsage){Va=Vx;break}for(VD=Vn.getData(),VV=0;VV<VD.length;VV+=Vn.vertexDeclaration.vertexStride/4)Vy=VV+Va.offset/4,Vp.push(new VQa(VD[Vy+0],VD[Vy+1],VD[Vy+2]))}}else{var VX=this._subMeshes.length;for(VQ=0;VQ<VX;VQ++){for(VU=(Vn=this._subMeshes[VQ]._getVertexBuffer()).vertexDeclaration.getVertexElements(),VV=0;VV<VU.length;VV++)if("vector3"===(Vx=VU[VV]).elementFormat&&0===Vx.elementUsage){Va=Vx;break}for(VD=Vn.getData(),VV=0;VV<VD.length;VV+=Vn.vertexDeclaration.vertexStride/4)Vy=VV+Va.offset/4,Vp.push(new VQa(VD[Vy+0],VD[Vy+1],VD[Vy+2]))}}return Vp},VU._setSubMeshes=function(Vn){this._subMeshes=Vn,this._subMeshCount=Vn.length;for(var Va=0;Va<this._subMeshCount;Va++)Vn[Va]._indexInMesh=Va;this._positions=this._getPositions(),this._generateBoundingObject()},VU.onAsynLoaded=function(Vn,Va,VU){var Vx=Va[0],VD=Va[1];Vsn.read(Vx,this,this._materials,this._subMeshes,VD),this.completeCreate(),this._endLoaded()},VU.getSubMesh=function(Vn){return this._subMeshes[Vn]},VU.getSubMeshCount=function(){return this._subMeshes.length},VU.getRenderElementsCount=function(){return this._subMeshes.length},VU.getRenderElement=function(Vn){return this._subMeshes[Vn]},VU.disposeResource=function(){for(var Vn=0;Vn<this._subMeshes.length;Vn++)this._subMeshes[Vn].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},VE(0,VU,"materials",function(){return this._materials.slice()}),VE(0,VU,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),Va.load=function(Vn){return VY.loader.create(Vn,null,null,Va)},Va}(),VBa=(function(Vn){function VR(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===VU&&(VU=6408),void 0===Vx&&(Vx=5121),void 0===VD&&(VD=33189),void 0===Vp&&(Vp=!1),void 0===VQ&&(VQ=!1),void 0===VV&&(VV=-1),void 0===Vy&&(Vy=-1),VR.__super.call(this),this._type=3553,this._width=Vn,this._height=Va,this._size=new Vma(Vn,Va),this._surfaceFormat=VU,this._surfaceType=Vx,this._depthStencilFormat=VD,Vm.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=Vp,this._repeat=VQ,this._minFifter=VV,this._magFifter=Vy,this.activeResource(),this._alreadyResolved=!0}Vq(VR,"laya.d3.resource.RenderTexture",Vua);var Va=VR.prototype;Va.recreateResource=function(){var Vn=Vu.mainContext;this._frameBuffer=Vn.createFramebuffer(),this._source=Vn.createTexture();var Va=Vc.curBindTexTarget,VU=Vc.curBindTexValue;Vc.bindTexture(Vn,this._type,this._source),Vn.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var Vx=this._minFifter,VD=this._magFifter,Vp=this._repeat?10497:33071;if(VK.isPOT(this._width,this._height)?(this._mipmap?-1!==Vx||(Vx=9987):-1!==Vx||(Vx=9729),-1!==VD||(VD=9729),Vn.texParameteri(this._type,10241,Vx),Vn.texParameteri(this._type,10240,VD),Vn.texParameteri(this._type,10242,Vp),Vn.texParameteri(this._type,10243,Vp),this._mipmap&&Vn.generateMipmap(this._type)):(-1!==Vx||(Vx=9729),-1!==VD||(VD=9729),Vn.texParameteri(this._type,10241,Vx),Vn.texParameteri(this._type,10240,VD),Vn.texParameteri(this._type,10242,33071),Vn.texParameteri(this._type,10243,33071)),Va&&VU&&Vc.bindTexture(Vn,Va,VU),Vn.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=Vn.createRenderbuffer(),Vn.bindRenderbuffer(36161,this._depthStencilBuffer),Vn.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),Vn.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:Vn.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:Vn.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:Vn.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}Vn.framebufferTexture2D(36160,36064,3553,this._source,0),Vn.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},Va.start=function(){Vu.mainContext.bindFramebuffer(36160,this.frameBuffer),(VR._currentRenderTarget=this)._alreadyResolved=!1},Va.end=function(){Vu.mainContext.bindFramebuffer(36160,null),VR._currentRenderTarget=null,this._alreadyResolved=!0},Va.getData=function(Vn,Va,VU,Vx){var VD=Vu.mainContext;if(VD.bindFramebuffer(36160,this._frameBuffer),!(36053===VD.checkFramebufferStatus(36160)))return VD.bindFramebuffer(36160,null),null;var Vp=new Uint8Array(this._width*this._height*4);return VD.readPixels(Vn,Va,VU,Vx,this._surfaceFormat,this._surfaceType,Vp),VD.bindFramebuffer(36160,null),Vp},Va.disposeResource=function(){if(this._frameBuffer){var Vn=Vu.mainContext;Vn.deleteTexture(this._source),Vn.deleteFramebuffer(this._frameBuffer),Vn.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},VE(0,Va,"surfaceFormat",function(){return this._surfaceFormat}),VE(0,Va,"surfaceType",function(){return this._surfaceType}),VE(0,Va,"depthStencilFormat",function(){return this._depthStencilFormat}),VE(0,Va,"source",function(){return this._alreadyResolved?VY.superGet(Vua,this,"source"):null}),VE(0,Va,"depthStencilBuffer",function(){return this._depthStencilBuffer}),VE(0,Va,"frameBuffer",function(){return this._frameBuffer}),VR._currentRenderTarget=null}(),function(Vn){function Va(Vn){this._color=null,this._pixels=null,Va.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new Vma(this.width,this.height),this._color=Vn,this._pixels=new Uint8Array([255*Vn.x,255*Vn.y,255*Vn.z,255*Vn.w]),this.uri="SolidColorTexture2D_"+this.id}Vq(Va,"laya.d3.resource.SolidColorTexture2D",Vua);var VU=Va.prototype;return VU._createWebGlTexture=function(){var Vn=Vu.mainContext,Va=this._source=Vn.createTexture(),VU=this._width,Vx=this._height,VD=Vc.curBindTexTarget,Vp=Vc.curBindTexValue;Vc.bindTexture(Vn,this._type,Va),Vn.texImage2D(this._type,0,6408,VU,Vx,0,6408,5121,this._pixels);var VQ=this._minFifter,VV=this._magFifter,Vy=this._repeat?10497:33071,VR=VK.isPOT(VU,Vx);VR?(this._mipmap?-1!==VQ||(VQ=9987):-1!==VQ||(VQ=9729),-1!==VV||(VV=9729),Vn.texParameteri(this._type,10241,VQ),Vn.texParameteri(this._type,10240,VV),Vn.texParameteri(this._type,10242,Vy),Vn.texParameteri(this._type,10243,Vy),this._mipmap&&Vn.generateMipmap(this._type)):(-1!==VQ||(VQ=9729),-1!==VV||(VV=9729),Vn.texParameteri(this._type,10241,VQ),Vn.texParameteri(this._type,10240,VV),Vn.texParameteri(this._type,10242,33071),Vn.texParameteri(this._type,10243,33071)),VD&&Vp&&Vc.bindTexture(Vn,VD,Vp),this.memorySize=VR?VU*Vx*4*(1+1/3):VU*Vx*4},VU.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},VU.disposeResource=function(){this._source&&(Vu.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Vz(Va,["magentaTexture",function(){var Vn=new Va(new VVa(1,0,1,1));return Vn.lock=!0,this.magentaTexture=Vn},"grayTexture",function(){var Vn=new Va(new VVa(.5,.5,.5,1));return Vn.lock=!0,this.grayTexture=Vn}]),Va}()),VOa=function(Vn){function VD(Vn,Va,VU,Vx){this._canRead=!1,this._image=null,this._pixels=null,void 0===Vn&&(Vn=!1),void 0===Va&&(Va=!0),void 0===VU&&(VU=6408),void 0===Vx&&(Vx=!0),VD.__super.call(this),this._type=3553,this._repeat=Va,this._canRead=Vn,this._format=VU,this._mipmap=Vx}Vq(VD,"laya.d3.resource.Texture2D",Vua);var Va=VD.prototype;return Va._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var Vn=Vu.mainContext,Va=this._source=Vn.createTexture(),VU=this._width,Vx=this._height,VD=Vc.curBindTexTarget,Vp=Vc.curBindTexValue;switch(Vc.bindTexture(Vn,this._type,Va),this._format){case 6407:case 6408:this._canRead?Vn.texImage2D(this._type,0,this._format,VU,Vx,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?Vn.texImage2D(this._type,0,this._image._format,VU,Vx,0,this._image._format,5121,this._image.atlasSource):Vn.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case Vu.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:Vn.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var VQ=this._minFifter,VV=this._magFifter,Vy=this._repeat?10497:33071,VR=0==this._wrapModeU?10497:33071,VX=0==this._wrapModeV?10497:33071,Vz=VK.isPOT(VU,Vx);Vz?(this._mipmap?-1!==VQ||(VQ=9987):-1!==VQ||(VQ=9729),-1!==VV||(VV=9729),Vn.texParameteri(this._type,10241,VQ),Vn.texParameteri(this._type,10240,VV),Vn.texParameteri(this._type,10242,Vy),Vn.texParameteri(this._type,10243,Vy),Vn.texParameteri(this._type,10242,VR),Vn.texParameteri(this._type,10243,VX),this._mipmap&&Vn.generateMipmap(this._type)):(-1!==VQ||(VQ=9729),-1!==VV||(VV=9729),Vn.texParameteri(this._type,10241,VQ),Vn.texParameteri(this._type,10240,VV),Vn.texParameteri(this._type,10242,33071),Vn.texParameteri(this._type,10243,33071)),VD&&Vp&&Vc.bindTexture(Vn,VD,Vp),this._image.onload=null,this._image=null,this.memorySize=Vz?VU*Vx*4*(1+1/3):VU*Vx*4},Va.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},Va.onAsynLoaded=function(Vn,Va,VU){if(VU){var Vx=VU[0];void 0!==Vx&&(this._canRead=Vx);var VD=VU[1];void 0!==VD&&(this._repeat=VD);var Vp=VU[2];void 0!==Vp&&(this._format=Vp);var VQ=VU[3];void 0!==VQ&&(this._mipmap=VQ);var VV=VU.wrapModeU;void 0!==VV&&(this._wrapModeU=VV);var Vy=VU.wrapModeV;void 0!==Vy&&(this._wrapModeV=Vy)}switch(this._format){case 6407:case 6408:var VR=(this._image=Va).width,VX=Va.height;this._width=VR,this._height=VX,this._size=new Vma(VR,VX),this._canRead&&(Vm.isConchApp?Va instanceof Vi.HTMLElement&&(this._pixels=new Uint8Array(Va.getImageData(0,0,VR,VX))):(VH.canvas.size(VR,VX),VH.canvas.clear(),VH.context.drawImage(Va,0,0,VR,VX),this._pixels=new Uint8Array(VH.context.getImageData(0,0,VR,VX).data.buffer)));break;case Vu.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var Vz=new VW(Va);Vz.readUTFBytes(4),Vz.readUTFBytes(2),Vz.getInt16();Vz.endian="bigEndian",this._width=Vz.getInt16(),this._height=Vz.getInt16(),this._size=new Vma(this._width,this._height);Vz.getInt16(),Vz.getInt16();this._image=new Uint8Array(Va,Vz.pos)}this.recreateResource(),this._endLoaded()},Va.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},Va.disposeResource=function(){this._source&&(Vu.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},VE(0,Va,"_src",function(){return this.url}),VE(0,Va,"src",function(){return this.url}),VD.load=function(Vn){return VY.loader.create(Vn,null,null,VD)},VD}(),VLa=function(Va){function VU(Vn,Va){VU.__super.call(this),void 0===Vn&&(Vn=.3),void 0===Va&&(Va=1e3),this._tempVector3=new VQa,this._position=new VQa,this._up=new VQa,this._forward=new VQa,this._right=new VQa,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=Vma.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=Vn,this._farPlane=Va,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),VY.stage.on("resize",this,this._onScreenSizeChanged)}Vq(VU,"laya.d3.core.BaseCamera",Va);var Vn=VU.prototype;return Vn._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var Vn=this.scene._cameraPool,Va=Vn.length-1,VU=0;VU<Va;VU++)if(Vn[VU].renderingOrder>Vn[Va].renderingOrder){var Vx=Vn[VU];Vn[VU]=Vn[Va],Vn[Va]=Vx}},Vn._calculateProjectionMatrix=function(){},Vn._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},Vn._prepareCameraToRender=function(){VG._currentCameraCullingMask=this.cullingMask;var Vn=this._shaderValues;Vn.setValue(0,this.transform.position.elements),Vn.setValue(5,this.forward.elements),Vn.setValue(6,this.up.elements)},Vn._prepareCameraViewProject=function(Vn,Va){var VU=this._shaderValues;VU.setValue(1,Vn.elements),VU.setValue(2,Va.elements)},Vn._renderCamera=function(Vn,Va,VU){},Vn.addLayer=function(Vn){29!==Vn.number&&30!=Vn.number&&(this.cullingMask=this.cullingMask|Vn.mask)},Vn.removeLayer=function(Vn){29!==Vn.number&&30!=Vn.number&&(this.cullingMask=this.cullingMask&~Vn.mask)},Vn.addAllLayers=function(){this.cullingMask=2147483647},Vn.removeAllLayers=function(){this.cullingMask=0|VG.getLayerByNumber(29).mask|VG.getLayerByNumber(30).mask},Vn.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},Vn.moveForward=function(Vn){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=Vn,this.transform.translate(this._tempVector3)},Vn.moveRight=function(Vn){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=Vn,this.transform.translate(this._tempVector3)},Vn.moveVertical=function(Vn){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=Vn,this.transform.translate(this._tempVector3,!1)},Vn._addSelfRenderObjects=function(){var Vn=this.scene._cameraPool,Va=Vn.length;if(0<Va){for(var VU=Va-1;0<=VU;VU--)if(this.renderingOrder<=Vn[VU].renderingOrder){Vn.splice(VU+1,0,this);break}}else Vn.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},Vn._clearSelfRenderObjects=function(){var Vn=this.scene._cameraPool;Vn.splice(Vn.indexOf(this),1)},Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,VY.stage.off("resize",this,this._onScreenSizeChanged),Va.prototype.destroy.call(this,Vn)},VE(0,Vn,"sky",function(){return this._sky},function(Vn){(this._sky=Vn)._ownerCamera=this}),VE(0,Vn,"forward",function(){var Vn=this.transform.worldMatrix.elements,Va=this._forward.elements;return Va[0]=-Vn[8],Va[1]=-Vn[9],Va[2]=-Vn[10],this._forward}),VE(0,Vn,"position",function(){var Vn=this.transform.worldMatrix.elements,Va=this._position.elements;return Va[0]=Vn[12],Va[1]=Vn[13],Va[2]=Vn[14],this._position}),VE(0,Vn,"renderTarget",function(){return this._renderTarget},function(Vn){null!=(this._renderTarget=Vn)&&(this._renderTargetSize=Vn.size)}),VE(0,Vn,"up",function(){var Vn=this.transform.worldMatrix.elements,Va=this._up.elements;return Va[0]=Vn[4],Va[1]=Vn[5],Va[2]=Vn[6],this._up}),VE(0,Vn,"right",function(){var Vn=this.transform.worldMatrix.elements,Va=this._right.elements;return Va[0]=Vn[0],Va[1]=Vn[1],Va[2]=Vn[2],this._right}),VE(0,Vn,"renderTargetSize",function(){return this._renderTargetSize},function(Vn){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=Vn,this._calculateProjectionMatrix()}),VE(0,Vn,"fieldOfView",function(){return this._fieldOfView},function(Vn){this._fieldOfView=Vn,this._calculateProjectionMatrix()}),VE(0,Vn,"nearPlane",function(){return this._nearPlane},function(Vn){this._nearPlane=Vn,this._calculateProjectionMatrix()}),VE(0,Vn,"farPlane",function(){return this._farPlane},function(Vn){this._farPlane=Vn,this._calculateProjectionMatrix()}),VE(0,Vn,"orthographic",function(){return this._orthographic},function(Vn){this._orthographic=Vn,this._calculateProjectionMatrix()}),VE(0,Vn,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(Vn){this._orthographicVerticalSize=Vn,this._calculateProjectionMatrix()}),VE(0,Vn,"renderingOrder",function(){return this._renderingOrder},function(Vn){this._renderingOrder=Vn,this._sortCamerasByRenderingOrder()}),VU.CAMERAPOS=0,VU.VIEWMATRIX=1,VU.PROJECTMATRIX=2,VU.VPMATRIX=3,VU.VPMATRIX_NO_TRANSLATE=4,VU.CAMERADIRECTION=5,VU.CAMERAUP=6,VU.ENVIRONMENTDIFFUSE=7,VU.ENVIRONMENTSPECULAR=8,VU.SIMLODINFO=9,VU.DIFFUSEIRRADMATR=10,VU.DIFFUSEIRRADMATG=11,VU.DIFFUSEIRRADMATB=12,VU.HDREXPOSURE=13,VU.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",VU.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",VU.CLEARFLAG_SOLIDCOLOR=0,VU.CLEARFLAG_SKY=1,VU.CLEARFLAG_DEPTHONLY=2,VU.CLEARFLAG_NONE=3,Vz(VU,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new Vna(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new Vna},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new Vna}]),VU}(Vva),Vda=function(VU){function Va(Vn){this._render=null,this._geometryFilter=null,Va.__super.call(this,Vn)}Vq(Va,"laya.d3.core.RenderableSprite3D",VU);var Vn=Va.prototype;return Vn._addToInitStaticBatchManager=function(){},Vn._setBelongScene=function(Vn){VU.prototype._setBelongScene.call(this,Vn),Vn._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},Vn._setUnBelongScene=function(){var Vn=this._scene._renderableSprite3Ds,Va=Vn.indexOf(this);Vn.splice(Va,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),VU.prototype._setUnBelongScene.call(this)},Vn._update=function(Vn){(Vn.owner=this)._activeInHierarchy&&(this._updateComponents(Vn),this._render._updateOctreeNode(),this._lateUpdateComponents(Vn),VN.spriteCount++,this._childs.length&&this._updateChilds(Vn))},Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),VU.prototype.destroy.call(this,Vn),this._render._destroy(),this._render=null},Va.__init__=function(){Va.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=Va.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),Va.SAHDERDEFINE_LIGHTMAP=Va.shaderDefines.registerDefine("LIGHTMAP")},Va.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,Va.SAHDERDEFINE_LIGHTMAP=4,Va.LIGHTMAPSCALEOFFSET=2,Va.LIGHTMAP=3,Vz(Va,["shaderDefines",function(){return this.shaderDefines=new VXa}]),Va}(Vva),VSa=(function(Vn){function Vx(Vn,Va,VU){this._long=NaN,this._width=NaN,this._height=NaN,void 0===Vn&&(Vn=1),void 0===Va&&(Va=1),void 0===VU&&(VU=1),Vx.__super.call(this),this._long=Vn,this._width=Va,this._height=VU,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}Vq(Vx,"laya.d3.resource.models.BoxMesh",Vga);var Va=Vx.prototype;Va.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var Vn=Vun.vertexDeclaration,Va=(Vn.vertexStride,this._long/2),VU=this._height/2,Vx=this._width/2,VD=new Float32Array([-Va,VU,-Vx,0,1,0,0,0,Va,VU,-Vx,0,1,0,1,0,Va,VU,Vx,0,1,0,1,1,-Va,VU,Vx,0,1,0,0,1,-Va,-VU,-Vx,0,-1,0,0,1,Va,-VU,-Vx,0,-1,0,1,1,Va,-VU,Vx,0,-1,0,1,0,-Va,-VU,Vx,0,-1,0,0,0,-Va,VU,-Vx,-1,0,0,0,0,-Va,VU,Vx,-1,0,0,1,0,-Va,-VU,Vx,-1,0,0,1,1,-Va,-VU,-Vx,-1,0,0,0,1,Va,VU,-Vx,1,0,0,1,0,Va,VU,Vx,1,0,0,0,0,Va,-VU,Vx,1,0,0,0,1,Va,-VU,-Vx,1,0,0,1,1,-Va,VU,Vx,0,0,1,0,0,Va,VU,Vx,0,0,1,1,0,Va,-VU,Vx,0,0,1,1,1,-Va,-VU,Vx,0,0,1,0,1,-Va,VU,-Vx,0,0,-1,1,0,Va,VU,-Vx,0,0,-1,0,0,Va,-VU,-Vx,0,0,-1,0,1,-Va,-VU,-Vx,0,0,-1,1,1]),Vp=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new Vfa(Vn,this._numberVertices,35044,!0),this._indexBuffer=new Vha("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(VD),this._indexBuffer.setData(Vp),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},VE(0,Va,"long",function(){return this._long},function(Vn){this._long!==Vn&&(this._long=Vn,this.releaseResource(),this.activeResource())}),VE(0,Va,"width",function(){return this._width},function(Vn){this._width!==Vn&&(this._width=Vn,this.releaseResource(),this.activeResource())}),VE(0,Va,"height",function(){return this._height},function(Vn){this._height!==Vn&&(this._height=Vn,this.releaseResource(),this.activeResource())})}(),function(Vn){function VD(Vn,Va,VU,Vx){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===Vn&&(Vn=10),void 0===Va&&(Va=10),void 0===VU&&(VU=10),void 0===Vx&&(Vx=10),VD.__super.call(this),this._long=Vn,this._width=Va,this._stacks=VU,this._slices=Vx,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}Vq(VD,"laya.d3.resource.models.PlaneMesh",Vga);var Va=VD.prototype;Va.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var Vn=new Uint16Array(this._numberIndices),Va=Vun.vertexDeclaration,VU=Va.vertexStride/4,Vx=new Float32Array(this._numberVertices*VU),VD=this._long/2,Vp=this._width/2,VQ=this._long/this._stacks,VV=this._width/this._slices,Vy=0,VR=0;VR<=this._slices;VR++)for(var VX=0;VX<=this._stacks;VX++)Vx[Vy++]=VX*VQ-VD,Vx[Vy++]=0,Vx[Vy++]=VR*VV-Vp,Vx[Vy++]=0,Vx[Vy++]=1,Vx[Vy++]=0,Vx[Vy++]=1*VX/this._stacks,Vx[Vy++]=1*VR/this._slices;var Vz=0;for(VR=0;VR<this._slices;VR++)for(VX=0;VX<this._stacks;VX++)Vn[Vz++]=(VR+1)*(this._stacks+1)+VX,Vn[Vz++]=VR*(this._stacks+1)+VX,Vn[Vz++]=(VR+1)*(this._stacks+1)+VX+1,Vn[Vz++]=VR*(this._stacks+1)+VX,Vn[Vz++]=VR*(this._stacks+1)+VX+1,Vn[Vz++]=(VR+1)*(this._stacks+1)+VX+1;this._vertexBuffer=new Vfa(Va,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new Vha("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData(Vx),this._indexBuffer.setData(Vn),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},VE(0,Va,"long",function(){return this._long},function(Vn){this._long!==Vn&&(this._long=Vn,this.releaseResource(),this.activeResource())}),VE(0,Va,"width",function(){return this._width},function(Vn){this._width!==Vn&&(this._width=Vn,this.releaseResource(),this.activeResource())}),VE(0,Va,"stacks",function(){return this._stacks},function(Vn){this._stacks!==Vn&&(this._stacks=Vn,this.releaseResource(),this.activeResource())}),VE(0,Va,"slices",function(){return this._slices},function(Vn){this._slices!==Vn&&(this._slices=Vn,this.releaseResource(),this.activeResource())})}(),function(Vn){function VQ(Vn,Va,VU){void 0===Vn&&(Vn=0),void 0===Va&&(Va=.3),void 0===VU&&(VU=1e3),this._viewMatrix=new Vna,this._projectionMatrix=new Vna,this._projectionViewMatrix=new Vna,this._viewport=new Vya(0,0,0,0),this._normalizedViewport=new Vya(0,0,1,1),this._aspectRatio=Vn,this._boundFrustumUpdate=!0,this._boundFrustum=new Vtn(Vna.DEFAULT),VQ.__super.call(this,Va,VU),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}Vq(VQ,"laya.d3.core.Camera",VLa);var Va=VQ.prototype;return Va._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},Va._parseCustomProps=function(Vn,Va,VU,Vx){var VD=VU.clearColor;this.clearColor=new VVa(VD[0],VD[1],VD[2],VD[3]);var Vp=VU.viewport;this.normalizedViewport=new Vya(Vp[0],Vp[1],Vp[2],Vp[3])},Va._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var Vn=this.orthographicVerticalSize*this.aspectRatio*.5,Va=.5*this.orthographicVerticalSize;Vna.createOrthoOffCenterRH(-Vn,Vn,-Va,Va,this.nearPlane,this.farPlane,this._projectionMatrix)}else Vna.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},Va._update=function(Vn){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,Vn)},Va._renderCamera=function(Vn,Va,VU){var Vx,VD;VU.parallelSplitShadowMaps[0]&&VU._renderShadowMap(Vn,Va,this),(Va.camera=this)._prepareCameraToRender(),VU._preRenderUpdateComponents(Va),Vx=Va._viewMatrix=this.viewMatrix;var Vp=this._renderTarget;Vp?(Vp.start(),Vna.multiply(VLa._invertYScaleMatrix,this._projectionMatrix,VLa._invertYProjectionMatrix),Vna.multiply(VLa._invertYScaleMatrix,this.projectionViewMatrix,VLa._invertYProjectionViewMatrix),VD=Va._projectionMatrix=VLa._invertYProjectionMatrix,Va._projectionViewMatrix=VLa._invertYProjectionViewMatrix):(VD=Va._projectionMatrix=this._projectionMatrix,Va._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(Vx,VD),Va._viewport=this.viewport,VU._preRenderScene(Vn,Va,this.boundFrustum),VU._clear(Vn,Va),VU._renderScene(Vn,Va),VU._postRenderUpdateComponents(Va),Vp&&Vp.end()},Va.viewportPointToRay=function(Vn,Va){VEa.calculateCursorRay(Vn,this.viewport,this._projectionMatrix,this.viewMatrix,null,Va)},Va.normalizedViewportPointToRay=function(Vn,Va){var VU=VQ._tempVector20,Vx=this.viewport,VD=Vn.elements,Vp=VU.elements;Vp[0]=VD[0]*Vx.width,Vp[1]=VD[1]*Vx.height,VEa.calculateCursorRay(VU,this.viewport,this._projectionMatrix,this.viewMatrix,null,Va)},Va.worldToViewportPoint=function(Vn,Va){Vna.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(Vn,this._projectionViewMatrix,Va);var VU=Va.elements;VU[0]=VU[0]/VY.stage.clientScaleX,VU[1]=VU[1]/VY.stage.clientScaleY},Va.worldToNormalizedViewportPoint=function(Vn,Va){Vna.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(Vn,this._projectionViewMatrix,Va);var VU=Va.elements;VU[0]=VU[0]/VY.stage.clientScaleX,VU[1]=VU[1]/VY.stage.clientScaleY},Va.convertScreenCoordToOrthographicCoord=function(Vn,Va){if(this._orthographic){var VU=Vs.clientWidth,Vx=Vs.clientHeight,VD=this.orthographicVerticalSize*this.aspectRatio/VU,Vp=this.orthographicVerticalSize/Vx,VQ=Vn.elements,VV=Va.elements;return VV[0]=(-VU/2+VQ[0])*VD,VV[1]=(Vx/2-VQ[1])*Vp,VV[2]=(this.nearPlane-this.farPlane)*(VQ[2]+1)/2-this.nearPlane,VQa.transformCoordinate(Va,this.transform.worldMatrix,Va),!0}return!1},VE(0,Va,"projectionViewMatrix",function(){return Vna.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),VE(0,Va,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var Vn=this.viewport;return Vn.width/Vn.height},function(Vn){if(Vn<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=Vn,this._calculateProjectionMatrix()}),VE(0,Va,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),VE(0,Va,"needViewport",function(){var Vn=this.normalizedViewport;return 0===Vn.x&&0===Vn.y&&1===Vn.width&&1===Vn.height}),VE(0,Va,"viewport",function(){if(this._viewportExpressedInClipSpace){var Vn=this._normalizedViewport,Va=this.renderTargetSize,VU=Va.width,Vx=Va.height;this._viewport.x=Vn.x*VU,this._viewport.y=Vn.y*Vx,this._viewport.width=Vn.width*VU,this._viewport.height=Vn.height*Vx}return this._viewport},function(Vn){if(null!=this.renderTarget&&(Vn.x<0||Vn.y<0||0==Vn.width||0==Vn.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=Vn,this._calculateProjectionMatrix()}),VE(0,Va,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var Vn=this._viewport,Va=this.renderTargetSize,VU=Va.width,Vx=Va.height;this._normalizedViewport.x=Vn.x/VU,this._normalizedViewport.y=Vn.y/Vx,this._normalizedViewport.width=Vn.width/VU,this._normalizedViewport.height=Vn.height/Vx}return this._normalizedViewport},function(Vn){Vn.x<0&&(Vn.x=0,console.warn("Camera: viewport.x must large than 0.0.")),Vn.y<0&&(Vn.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<Vn.x+Vn.width&&(Vn.width=1-Vn.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<Vn.y+Vn.height&&(Vn.height=1-Vn.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=Vn,this._calculateProjectionMatrix()}),VE(0,Va,"projectionMatrix",function(){return this._projectionMatrix},function(Vn){this._projectionMatrix=Vn,this._useUserProjectionMatrix=!0}),VE(0,Va,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),Vz(VQ,["_tempVector20",function(){return this._tempVector20=new Vpa}]),VQ}()),Vwa=function(VU){function Vx(Vn,Va){Vx.__super.call(this,Va),this._geometryFilter=new VHa(this),this._render=new VGa(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),Vn&&(this._geometryFilter.sharedMesh=Vn)instanceof laya.d3.resource.models.Mesh&&(Vn.loaded?this._render.sharedMaterials=Vn.materials:Vn.once("loaded",this,this._applyMeshMaterials))}Vq(Vx,"laya.d3.core.MeshSprite3D",VU);var Vn=Vx.prototype;return Vn._changeRenderObjectByMesh=function(Vn){var Va=this._render._renderElements,VU=Va[Vn];VU||(VU=Va[Vn]=new Vka),VU._render=this._render;var Vx=this._render.sharedMaterials[Vn];Vx||(Vx=Vja.defaultMaterial);var VD=this._geometryFilter.sharedMesh.getRenderElement(Vn);return VU._mainSortID=this._getSortID(VD,Vx),VU._sprite3D=this,VU.renderObj=VD,VU._material=Vx,VU},Vn._changeRenderObjectByMaterial=function(Vn,Va){var VU=this._render._renderElements[Vn];Va||(Va=Vja.defaultMaterial);var Vx=this._geometryFilter.sharedMesh.getRenderElement(Vn);return VU._mainSortID=this._getSortID(Vx,Va),VU._sprite3D=this,VU.renderObj=Vx,VU._material=Va,VU},Vn._changeRenderObjectsByMesh=function(){var Vn=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=Vn;for(var Va=0;Va<Vn;Va++)this._changeRenderObjectByMesh(Va)},Vn._onMeshChanged=function(Vn){var Va=Vn.sharedMesh;Va.loaded?this._changeRenderObjectsByMesh():Va.once("loaded",this,this._onMeshLoaded)},Vn._onMeshLoaded=function(Vn){Vn===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},Vn._onMaterialChanged=function(Vn,Va,VU){Va<this._render._renderElements.length&&this._changeRenderObjectByMaterial(Va,VU)},Vn._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},Vn._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},Vn._parseCustomProps=function(Vn,Va,VU,Vx){var VD=this.meshRender,Vp=VU.lightmapIndex;null!=Vp&&(VD.lightmapIndex=Vp);var VQ,VV,Vy=VU.lightmapScaleOffset;if(Vy&&(VD.lightmapScaleOffset=new VVa(Vy[0],Vy[1],Vy[2],Vy[3])),Vx.instanceParams)(VQ=Vx.instanceParams.loadPath)&&(VV=VP.getRes(Va[VQ]),(this.meshFilter.sharedMesh=VV).loaded?VD.sharedMaterials=VV.materials:VV.once("loaded",this,this._applyMeshMaterials));else{(VQ=VU.meshPath)&&(VV=VP.getRes(Va[VQ]),this.meshFilter.sharedMesh=VV);var VR=VU.materials;if(VR){var VX=VD.sharedMaterials,Vz=VR.length;VX.length=Vz;for(var Vi=0;Vi<Vz;Vi++)VX[Vi]=VP.getRes(Va[VR[Vi].path]);VD.sharedMaterials=VX}}},Vn._applyMeshMaterials=function(Vn){for(var Va=this._render.sharedMaterials,VU=Vn.materials,Vx=0,VD=VU.length;Vx<VD;Vx++)Va[Vx]||(Va[Vx]=VU[Vx]);this._render.sharedMaterials=Va},Vn._addToInitStaticBatchManager=function(){Vx._staticBatchManager._addInitBatchSprite(this)},Vn.cloneTo=function(Vn){var Va=Vn;Va._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var VU=this._render,Vx=Va._render;Vx.enable=VU.enable,Vx.sharedMaterials=VU.sharedMaterials,Vx.castShadow=VU.castShadow;var VD=VU.lightmapScaleOffset;VD&&(Vx.lightmapScaleOffset=VD.clone()),Vx.lightmapIndex=VU.lightmapIndex,Vx.receiveShadow=VU.receiveShadow,Vx.sortingFudge=VU.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,Vn)},Vn.destroy=function(Vn){if(void 0===Vn&&(Vn=!0),!this.destroyed){var Va=this.meshFilter.sharedMesh;null!=Va&&(Va.loaded||Va.off("loaded",this,this._applyMeshMaterials)),VU.prototype.destroy.call(this,Vn),this._geometryFilter._destroy()}},VE(0,Vn,"meshFilter",function(){return this._geometryFilter}),VE(0,Vn,"meshRender",function(){return this._render}),Vx.__init__=function(){Vxn._staticBatchManagers.push(Vx._staticBatchManager)},Vx.load=function(Vn){return VY.loader.create(Vn,null,null,Vx)},Vz(Vx,["_staticBatchManager",function(){return this._staticBatchManager=new V_a}]),Vx}(Vda)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Vn,Va){"use strict";for(var VU in Object.defineProperty(Va,"__esModule",{value:!0}),Laya){var Vx=Laya[VU];Vx&&Vx.__isclass&&(Va[VU]=Vx)}}),function(Vn,Va,VDn){VDn.un,VDn.uns;var VU=VDn.static,Vx=VDn.class,Vp=VDn.getset,Vm=VDn.__newvec,VV=laya.maths.Bezier,Vz=laya.utils.Browser,Vun=laya.utils.Byte,VD=(laya.events.Event,laya.events.EventDispatcher),VQ=laya.display.Graphics,Vy=(laya.resource.HTMLCanvas,laya.utils.Handler),VR=laya.net.Loader,Vi=laya.maths.MathUtil,Vcn=laya.maths.Matrix,Vb=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),VX=(laya.renders.RenderContext,laya.resource.Resource),Vq=laya.utils.RunDriver,Vpn=laya.display.Sprite,VE=laya.utils.Stat,VHn=laya.resource.Texture,VP=(laya.net.URL,laya.utils.Utils),Vc=function(){function Vn(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return Vx(Vn,"laya.ani.AnimationContent"),Vn}(),VH=function(){function Vn(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return Vx(Vn,"laya.ani.AnimationNodeContent"),Vn}(),VT=function(){function Vn(){}return Vx(Vn,"laya.ani.AnimationParser01"),Vn.parse=function(Vn,Va){var VU=Va.__getBuffer(),Vx=0,VD=0,Vp=0,VQ=0,VV=0,Vy=0,VR=0,VX=Va.readUTFString();Vn._aniClassName=VX;var Vz,Vi=Va.readUTFString().split("\n"),Vq=Va.getUint8(),VE=Va.getUint32(),Vm=Va.getUint32();0<VE&&(Vz=VU.slice(VE,Vm));var Vb=new Vun(Vz);for(0<Vm&&(Vn._publicExtData=VU.slice(Vm,VU.byteLength)),Vn._useParent=!!Va.getUint8(),Vn._anis.length=Vq,Vx=0;Vx<Vq;Vx++){var VP=Vn._anis[Vx]=new Vc;VP.nodes=new Array;var VA=VP.name=Vi[Va.getUint16()];Vn._aniMap[VA]=Vx,VP.bone3DMap={},VP.playTime=Va.getFloat32(),VP.playTime<=0&&console.error("播放时间不能为0  url="+Vn.url+" name="+VP.name);var VT=VP.nodes.length=Va.getUint8();for(VD=VP.totalKeyframeDatasLength=0;VD<VT;VD++){var VK=VP.nodes[VD]=new VH;VK.childs=[];var VY=Va.getInt16();0<=VY&&(VK.name=Vi[VY],VP.bone3DMap[VK.name]=VD),VK.keyFrame=new Array,VK.parentIndex=Va.getInt16(),-1==VK.parentIndex?VK.parent=null:VK.parent=VP.nodes[VK.parentIndex],VK.lerpType=Va.getUint8();var VW=Va.getUint32();Vb.pos=VW;var Vk=VK.keyframeWidth=Vb.getUint16();if(VP.totalKeyframeDatasLength+=Vk,0===VK.lerpType||1===VK.lerpType)for(VK.interpolationMethod=[],VK.interpolationMethod.length=Vk,Vp=0;Vp<Vk;Vp++)VK.interpolationMethod[Vp]=Vv.interpolation[Vb.getUint8()];null!=VK.parent&&VK.parent.childs.push(VK);var VN=Va.getUint16();0<VN&&(VK.extenData=VU.slice(Va.pos,Va.pos+VN),Va.pos+=VN);var V_,V$=Va.getUint16(),VM=0;for(Vp=0,VQ=VK.keyFrame.length=V$;Vp<VQ;Vp++){if((V_=VK.keyFrame[Vp]=new VG).duration=Va.getFloat32(),V_.startTime=VM,2===VK.lerpType){V_.interpolationData=[];var VZ,Vu=Va.getUint8();switch(VZ=Va.getFloat32()){case 254:for(V_.interpolationData.length=Vk,VR=0;VR<Vk;VR++)V_.interpolationData[VR]=0;break;case 255:for(V_.interpolationData.length=Vk,VR=0;VR<Vk;VR++)V_.interpolationData[VR]=5;break;default:for(V_.interpolationData.push(VZ),Vy=1;Vy<Vu;Vy++)V_.interpolationData.push(Va.getFloat32())}}for(V_.data=new Float32Array(Vk),VV=0;VV<Vk;VV++)V_.data[VV]=Va.getFloat32(),-1e-8<V_.data[VV]&&V_.data[VV]<1e-8&&(V_.data[VV]=0);VM+=V_.duration}V_.startTime=VP.playTime,VK.playTime=VP.playTime,Vn._calculateKeyFrame(VK,V$,Vk)}}},Vn}(),VK=function(){function VY(){}return Vx(VY,"laya.ani.AnimationParser02"),VY.READ_DATA=function(){VY._DATA.offset=VY._reader.getUint32(),VY._DATA.size=VY._reader.getUint32()},VY.READ_BLOCK=function(){for(var Vn=VY._BLOCK.count=VY._reader.getUint16(),Va=VY._BLOCK.blockStarts=[],VU=VY._BLOCK.blockLengths=[],Vx=0;Vx<Vn;Vx++)Va.push(VY._reader.getUint32()),VU.push(VY._reader.getUint32())},VY.READ_STRINGS=function(){var Vn=VY._reader.getUint32(),Va=VY._reader.getUint16(),VU=VY._reader.pos;VY._reader.pos=Vn+VY._DATA.offset;for(var Vx=0;Vx<Va;Vx++)VY._strings[Vx]=VY._reader.readUTFString();VY._reader.pos=VU},VY.parse=function(Vn,Va){VY._templet=Vn;(VY._reader=Va).__getBuffer();VY.READ_DATA(),VY.READ_BLOCK(),VY.READ_STRINGS();for(var VU=0,Vx=VY._BLOCK.count;VU<Vx;VU++){var VD=Va.getUint16(),Vp=VY._strings[VD],VQ=VY["READ_"+Vp];if(null==VQ)throw new Error("model file err,no this function:"+VD+" "+Vp);VQ.call()}},VY.READ_ANIMATIONS=function(){var Vn=VY._reader,Va=Vn.__getBuffer(),VU=0,Vx=0,VD=0,Vp=0,VQ=Vn.getUint16(),VV=[];for(VV.length=VQ,VU=0;VU<VQ;VU++)VV[VU]=Vv.interpolation[Vn.getByte()];var Vy=Vn.getUint8();for(VY._templet._anis.length=Vy,VU=0;VU<Vy;VU++){var VR=VY._templet._anis[VU]={};VR.nodes=new Array;var VX=VR.name=VY._strings[Vn.getUint16()];VY._templet._aniMap[VX]=VU,VR.bone3DMap={},VR.playTime=Vn.getFloat32();var Vz=VR.nodes.length=Vn.getInt16();for(Vx=VR.totalKeyframeDatasLength=0;Vx<Vz;Vx++){var Vi=VR.nodes[Vx]={};Vi.keyframeWidth=VQ,Vi.childs=[];var Vq=Vn.getUint16();0<=Vq&&(Vi.name=VY._strings[Vq],VR.bone3DMap[Vi.name]=Vx),Vi.keyFrame=new Array,Vi.parentIndex=Vn.getInt16(),-1==Vi.parentIndex?Vi.parent=null:Vi.parent=VR.nodes[Vi.parentIndex],VR.totalKeyframeDatasLength+=VQ,Vi.interpolationMethod=VV,null!=Vi.parent&&Vi.parent.childs.push(Vi);var VE=Vn.getUint16(),Vm=null,Vb=null;for(VD=0,Vp=Vi.keyFrame.length=VE;VD<Vp;VD++){(Vm=Vi.keyFrame[VD]={}).startTime=Vn.getFloat32(),Vb&&(Vb.duration=Vm.startTime-Vb.startTime);var VP=VY._DATA.offset,VA=Vn.getUint32(),VT=4*VQ,VK=Va.slice(VP+VA,VP+VA+VT);Vm.data=new Float32Array(VK),Vb=Vm}Vm.duration=0,Vi.playTime=VR.playTime,VY._templet._calculateKeyFrame(Vi,VE,VQ)}}},VY._templet=null,VY._reader=null,VY._strings=[],VU(VY,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),VY}(),VGn=(function(){function Vn(){}Vx(Vn,"laya.ani.AnimationState"),Vn.stopped=0,Vn.paused=1,Vn.playing=2}(),function(){function VD(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new Vdn,this.resultMatrix=new Vcn,this._children=[]}Vx(VD,"laya.ani.bone.Bone");var Vn=VD.prototype;return Vn.setTempMatrix=function(Vn){this._tempMatrix=Vn;var Va,VU=0;for(VU=0,Va=this._children.length;VU<Va;VU++)this._children[VU].setTempMatrix(this._tempMatrix)},Vn.update=function(Vn){var Va;if(this.rotation=this.transform.skX,Vn)Va=this.resultTransform.getMatrix(),Vcn.mul(Va,Vn,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)Va=this.resultTransform.getMatrix(),Vcn.mul(Va,this.parentBone.resultMatrix,this.resultMatrix);else{var VU=this.parentBone,Vx=NaN,VD=NaN,Vp=NaN,VQ=this.parentBone.resultMatrix;Va=this.resultTransform.getMatrix();var VV=VQ.a*Va.tx+VQ.c*Va.ty+VQ.tx,Vy=VQ.b*Va.tx+VQ.d*Va.ty+VQ.ty,VR=new Vcn;this.inheritRotation?(Vx=Math.atan2(VU.resultMatrix.b,VU.resultMatrix.a),VD=Math.cos(Vx),Vp=Math.sin(Vx),VR.setTo(VD,Vp,-Vp,VD,0,0),Vcn.mul(this._tempMatrix,VR,Vcn.TEMP),Vcn.TEMP.copyTo(VR),Va=this.resultTransform.getMatrix(),Vcn.mul(Va,VR,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,Va=this.resultTransform.getMatrix(),Vcn.TEMP.identity(),Vcn.TEMP.d=this.d,Vcn.mul(Va,Vcn.TEMP,this.resultMatrix)),this.resultMatrix.tx=VV,this.resultMatrix.ty=Vy}else(Va=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var VX,Vz=0;for(Vz=0,VX=this._children.length;Vz<VX;Vz++)this._children[Vz].update()},Vn.updateChild=function(){var Vn,Va=0;for(Va=0,Vn=this._children.length;Va<Vn;Va++)this._children[Va].update()},Vn.setRotation=function(Vn){this._sprite&&(this._sprite.rotation=180*Vn/Math.PI)},Vn.updateDraw=function(Vn,Va){VD.ShowBones&&!VD.ShowBones[this.name]||(this._sprite||(this._sprite=new Vpn,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),VDn.stage.addChild(this._sprite)),this._sprite.x=Vn+this.resultMatrix.tx,this._sprite.y=Va+this.resultMatrix.ty);var VU,Vx=0;for(Vx=0,VU=this._children.length;Vx<VU;Vx++)this._children[Vx].updateDraw(Vn,Va)},Vn.addChild=function(Vn){this._children.push(Vn),Vn.parentBone=this},Vn.findBone=function(Vn){if(this.name==Vn)return this;var Va,VU,Vx=0;for(Vx=0,Va=this._children.length;Vx<Va;Vx++)if(VU=this._children[Vx].findBone(Vn))return VU;return null},Vn.localToWorld=function(Vn){var Va=Vn[0],VU=Vn[1];Vn[0]=Va*this.resultMatrix.a+VU*this.resultMatrix.c+this.resultMatrix.tx,Vn[1]=Va*this.resultMatrix.b+VU*this.resultMatrix.d+this.resultMatrix.ty},VD.ShowBones={},VD}()),VIn=function(){function Vm(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}Vx(Vm,"laya.ani.bone.BoneSlot");var Vn=Vm.prototype;return Vn.showSlotData=function(Vn,Va){void 0===Va&&(Va=!0),this.currSlotData=Vn,Va&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},Vn.showDisplayByName=function(Vn){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(Vn))},Vn.replaceDisplayByName=function(Vn,Va){if(this.currSlotData){var VU;VU=this.currSlotData.getDisplayByName(Vn);var Vx;Vx=this.currSlotData.getDisplayByName(Va),this.replaceDisplayByIndex(VU,Vx)}},Vn.replaceDisplayByIndex=function(Vn,Va){this.currSlotData&&(this._replaceDic[Vn]=Va,this.displayIndex==Vn&&this.showDisplayByIndex(Vn))},Vn.showDisplayByIndex=function(Vn){if(null!=this._replaceDic[Vn]&&(Vn=this._replaceDic[Vn]),this.currSlotData&&-1<Vn&&Vn<this.currSlotData.displayArr.length){if(this.displayIndex=Vn,this.currDisplayData=this.currSlotData.displayArr[Vn],this.currDisplayData){var Va=this.currDisplayData.name;this.currTexture=this.templet.getTexture(Va),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!Vb.isConchApp||Vb.isConchApp&&"0.9.15"<Vpn.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},Vn.replaceSkin=function(Vn){this._diyTexture=Vn,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},Vn.setParentMatrix=function(Vn){this._parentMatrix=Vn},Vn.draw=function(Vn,Va,VU,Vx){if(void 0===VU&&(VU=!1),void 0===Vx&&(Vx=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var VD,Vp=this.currTexture;switch(this._diyTexture&&(Vp=this._diyTexture),this.currDisplayData.type){case 0:if(Vn){var VQ=this.getDisplayMatrix();if(this._parentMatrix){var VV=!1;if(VQ){var Vy;if(Vcn.mul(VQ,this._parentMatrix,Vcn.TEMP),Vy=VU?(null==this._resultMatrix&&(this._resultMatrix=new Vcn),this._resultMatrix):new Vcn,!Vb.isWebGL&&this.currDisplayData.uvs||Vb.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var VR=Vm._tempMatrix;VR.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(VR.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(VV=!0,VR.rotate(-Math.PI/2)),Vcn.mul(VR,Vcn.TEMP,Vy)}else Vcn.TEMP.copyTo(Vy);VV?Vn.drawTexture(Vp,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,Vy):Vn.drawTexture(Vp,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,Vy)}}}break;case 1:if(null==(VD=VU?(null==this._skinSprite&&(this._skinSprite=Vm.createSkinMesh()),this._skinSprite):Vm.createSkinMesh()))return;var VX;if(null==this.currDisplayData.bones){var Vz,Vi=this.currDisplayData.weights;this.deformData&&(Vi=this.deformData),Vz=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Vk.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Vk.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=Vi;this.currDisplayData.triangles.length;VX=this.currDisplayData.triangles,VD.init2(Vp,null,VX,this._mVerticleArr,Vz);var Vq,VE=this.getDisplayMatrix();if(this._parentMatrix)if(VE)Vcn.mul(VE,this._parentMatrix,Vcn.TEMP),Vq=VU?(null==this._resultMatrix&&(this._resultMatrix=new Vcn),this._resultMatrix):new Vcn,Vcn.TEMP.copyTo(Vq),VD.transform=Vq}else this.skinMesh(Va,VD,Vx);Vn.drawSkin(VD);break;case 2:if(null==(VD=VU?(null==this._skinSprite&&(this._skinSprite=Vm.createSkinMesh()),this._skinSprite):Vm.createSkinMesh()))return;this.skinMesh(Va,VD,Vx),Vn.drawSkin(VD)}}},Vn.skinMesh=function(Vn,Va,VU){var Vx,VD=this.currTexture,Vp=this.currDisplayData.bones;Vx=this._diyTexture?(VD=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Vk.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Vk.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var VQ,VV,Vy=this.currDisplayData.weights,VR=this.currDisplayData.triangles,VX=0,Vz=0,Vi=0,Vq=NaN,VE=NaN,Vm=0,Vb=0,VP=[],VA=0,VT=0;if(this.deformData&&0<this.deformData.length){var VK=0;for(VA=0,VT=Vp.length;VA<VT;){for(Vi=Vp[VA++]+VA,Vz=VX=0;VA<Vi;VA++)VV=Vn[Vp[VA]],Vq=Vy[Vm]+this.deformData[VK++],VE=Vy[Vm+1]+this.deformData[VK++],Vb=Vy[Vm+2],VX+=(Vq*VV.a+VE*VV.c+VV.tx)*Vb,Vz+=(Vq*VV.b+VE*VV.d+VV.ty)*Vb,Vm+=3;VP.push(VX,Vz)}}else for(VA=0,VT=Vp.length;VA<VT;){for(Vi=Vp[VA++]+VA,Vz=VX=0;VA<Vi;VA++)VV=Vn[Vp[VA]],Vq=Vy[Vm],VE=Vy[Vm+1],Vb=Vy[Vm+2],VX+=(Vq*VV.a+VE*VV.c+VV.tx)*Vb,Vz+=(Vq*VV.b+VE*VV.d+VV.ty)*Vb,Vm+=3;VP.push(VX,Vz)}this._mVerticleArr=VP,VQ=VR,Va.init2(VD,null,VQ,this._mVerticleArr,Vx)},Vn.drawBonePoint=function(Vn){Vn&&this._parentMatrix&&Vn.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},Vn.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},Vn.getMatrix=function(){return this._resultMatrix},Vn.copy=function(){var Vn=new Vm;return Vn.type="copy",Vn.name=this.name,Vn.attachmentName=this.attachmentName,Vn.srcDisplayIndex=this.srcDisplayIndex,Vn.parent=this.parent,Vn.displayIndex=this.displayIndex,Vn.templet=this.templet,Vn.currSlotData=this.currSlotData,Vn.currTexture=this.currTexture,Vn.currDisplayData=this.currDisplayData,Vn},Vm.createSkinMesh=function(){return Vb.isWebGL||Vb.isConchApp?Vq.skinAniSprite():(Vb.isWebGL,null)},VU(Vm,["_tempMatrix",function(){return this._tempMatrix=new Vcn}]),Vm}(),Vvn=function(){function Vn(){this.skinName=null,this.deformSlotDataList=[]}return Vx(Vn,"laya.ani.bone.DeformAniData"),Vn}(),Vln=function(){function Vn(){this.deformSlotDisplayList=[]}return Vx(Vn,"laya.ani.bone.DeformSlotData"),Vn}(),Vjn=function(){function Vn(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}Vx(Vn,"laya.ani.bone.DeformSlotDisplayData");var Va=Vn.prototype;return Va.binarySearch1=function(Vn,Va){var VU=0,Vx=Vn.length-2;if(0==Vx)return 1;for(var VD=Vx>>>1;;){if(Vn[Math.floor(VD+1)]<=Va?VU=VD+1:Vx=VD,VU==Vx)return VU+1;VD=VU+Vx>>>1}return 0},Va.apply=function(Vn,Va,VU){if(void 0===VU&&(VU=1),Vn+=.05,!(this.timeList.length<=0)){var Vx=0;if(!(Vn<this.timeList[0])){var VD=this.vectices[0].length,Vp=[],VQ=this.binarySearch1(this.timeList,Vn);if(this.frameIndex=VQ,Vn>=this.timeList[this.timeList.length-1]){var VV=this.vectices[this.vectices.length-1];if(VU<1)for(Vx=0;Vx<VD;Vx++)Vp[Vx]+=(VV[Vx]-Vp[Vx])*VU;else for(Vx=0;Vx<VD;Vx++)Vp[Vx]=VV[Vx];this.deformData=Vp}else{this.tweenKeyList[this.frameIndex];var Vy=this.vectices[this.frameIndex-1],VR=this.vectices[this.frameIndex],VX=this.timeList[this.frameIndex-1],Vz=this.timeList[this.frameIndex];VU=this.tweenKeyList[VQ-1]?(Vn-VX)/(Vz-VX):0;var Vi=NaN;for(Vx=0;Vx<VD;Vx++)Vi=Vy[Vx],Vp[Vx]=Vi+(VR[Vx]-Vi)*VU;this.deformData=Vp}}}},Vn}(),Vhn=function(){function Vn(){this.time=NaN,this.drawOrder=[]}return Vx(Vn,"laya.ani.bone.DrawOrderData"),Vn}(),Vfn=function(){function Vn(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return Vx(Vn,"laya.ani.bone.EventData"),Vn}(),VA=function(){function Vxn(Vn,Va){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=Vn,this._targetBone=Va[Vn.targetBoneIndex],this.isSpine=Vn.isSpine,null==this._bones&&(this._bones=[]);for(var VU=this._bones.length=0,Vx=Vn.boneIndexs.length;VU<Vx;VU++)this._bones.push(Va[Vn.boneIndexs[VU]]);this.name=Vn.name,this.mix=Vn.mix,this.bendDirection=Vn.bendDirection}Vx(Vxn,"laya.ani.bone.IkConstraint");var Vn=Vxn.prototype;return Vn.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},Vn._applyIk1=function(Vn,Va,VU,Vx){var VD=Vn.parentBone,Vp=1/(VD.resultMatrix.a*VD.resultMatrix.d-VD.resultMatrix.b*VD.resultMatrix.c),VQ=Va-VD.resultMatrix.tx,VV=VU-VD.resultMatrix.ty,Vy=(VQ*VD.resultMatrix.d-VV*VD.resultMatrix.c)*Vp-Vn.transform.x,VR=(VV*VD.resultMatrix.a-VQ*VD.resultMatrix.b)*Vp-Vn.transform.y,VX=Math.atan2(VR,Vy)*Vxn.radDeg-0-Vn.transform.skX;Vn.transform.scX<0&&(VX+=180),180<VX?VX-=360:VX<-180&&(VX+=360),Vn.transform.skX=Vn.transform.skY=Vn.transform.skX+VX*Vx,Vn.update()},Vn.updatePos=function(Vn,Va){this._sp&&this._sp.pos(Vn,Va)},Vn._applyIk2=function(Vn,Va,VU,Vx,VD,Vp){if(0!=Vp){var VQ=Vn.resultTransform.x,VV=Vn.resultTransform.y,Vy=Vn.transform.scX,VR=Vn.transform.scY,VX=Va.transform.scX,Vz=0,Vi=0,Vq=0;Vq=Vy<0?(Vy=-Vy,Vz=180,-1):(Vz=0,1),VR<0&&(VR=-VR,Vq=-Vq),Vi=VX<0?(VX=-VX,180):0;var VE=Va.resultTransform.x,Vm=NaN,Vb=NaN,VP=NaN,VA=Vn.resultMatrix.a,VT=Vn.resultMatrix.c,VK=Vn.resultMatrix.b,VY=Vn.resultMatrix.d,VW=Math.abs(Vy-VR)<=1e-4;VP=VW?(Vb=VA*VE+VT*(Vm=Va.resultTransform.y)+Vn.resultMatrix.tx,VK*VE+VY*Vm+Vn.resultMatrix.ty):(Vm=0,Vb=VA*VE+Vn.resultMatrix.tx,VK*VE+Vn.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new Vpn,VDn.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(VU,Vx,15,"#ffff00"),this._sp.graphics.drawCircle(Vb,VP,15,"#ff00ff")),Vn.setRotation(Math.atan2(VP-Vn.resultMatrix.ty,Vb-Vn.resultMatrix.tx));var Vk=Vn.parentBone;VA=Vk.resultMatrix.a,VT=Vk.resultMatrix.c,VK=Vk.resultMatrix.b;var VN=1/(VA*(VY=Vk.resultMatrix.d)-VT*VK),V_=VU-Vk.resultMatrix.tx,V$=Vx-Vk.resultMatrix.ty,VM=(V_*VY-V$*VT)*VN-VQ,VZ=(V$*VA-V_*VK)*VN-VV,Vu=((V_=Vb-Vk.resultMatrix.tx)*VY-(V$=VP-Vk.resultMatrix.ty)*VT)*VN-VQ,Vc=(V$*VA-V_*VK)*VN-VV,VH=Math.sqrt(Vu*Vu+Vc*Vc),VG=Va.length*VX,VI=NaN,Vv=NaN;if(VW){var Vl=(VM*VM+VZ*VZ-VH*VH-(VG*=Vy)*VG)/(2*VH*VG);Vl<-1?Vl=-1:1<Vl&&(Vl=1),Vv=Math.acos(Vl)*VD,VA=VH+VG*Vl,VT=VG*Math.sin(Vv),VI=Math.atan2(VZ*VA-VM*VT,VM*VA+VZ*VT)}else{var Vj=(VA=Vy*VG)*VA,Vh=(VT=VR*VG)*VT,Vf=VM*VM+VZ*VZ,VF=Math.atan2(VZ,VM),Vg=-2*Vh*VH,Vo=Vh-Vj;if(0<(VY=Vg*Vg-4*Vo*(VK=Vh*VH*VH+Vj*Vf-Vj*Vh))){var VB=Math.sqrt(VY);Vg<0&&(VB=-VB);var VO=(VB=-(Vg+VB)/2)/Vo,VL=VK/VB,Vd=Math.abs(VO)<Math.abs(VL)?VO:VL;Vd*Vd<=Vf&&(V$=Math.sqrt(Vf-Vd*Vd)*VD,VI=VF-Math.atan2(V$,Vd),Vv=Math.atan2(V$/VR,(Vd-VH)/Vy))}var VS=0,Vw=Number.MAX_VALUE,Vs=0,VC=0,Vt=0,Vr=0,VJ=0,Ve=0;Vr<(VY=(V_=VH+VA)*V_)&&(Vt=0,Vr=VY,VJ=V_),(VY=(V_=VH-VA)*V_)<Vw&&(VS=Math.PI,Vw=VY,Vs=V_);var Vnn=Math.acos(-VA*VH/(Vj-Vh));(VY=(V_=VA*Math.cos(Vnn)+VH)*V_+(V$=VT*Math.sin(Vnn))*V$)<Vw&&(VS=Vnn,Vw=VY,Vs=V_,VC=V$),Vr<VY&&(Vt=Vnn,Vr=VY,VJ=V_,Ve=V$),Vv=Vf<=(Vw+Vr)/2?(VI=VF-Math.atan2(VC*VD,Vs),VS*VD):(VI=VF-Math.atan2(Ve*VD,VJ),Vt*VD)}var Van=Math.atan2(Vm,VE)*Vq,VUn=Vn.resultTransform.skX;180<(VI=(VI-Van)*Vxn.radDeg+Vz-VUn)?VI-=360:VI<-180&&(VI+=360),Vn.resultTransform.x=VQ,Vn.resultTransform.y=VV,Vn.resultTransform.skX=Vn.resultTransform.skY=VUn+VI*Vp,VUn=Va.resultTransform.skX,180<(Vv=((Vv+Van)*Vxn.radDeg-0)*Vq+Vi-(VUn%=360))?Vv-=360:Vv<-180&&(Vv+=360),Va.resultTransform.x=VE,Va.resultTransform.y=Vm,Va.resultTransform.skX=Va.resultTransform.skY=Va.resultTransform.skY+Vv*Vp,Vn.update()}},Vn._applyIk3=function(Vn,Va,VU,Vx,VD,Vp){if(0!=Vp){var VQ,VV,Vy=Va.resultMatrix.a*Va.length,VR=Va.resultMatrix.b*Va.length,VX=Vy*Vy+VR*VR,Vz=Math.sqrt(VX),Vi=Vn.resultMatrix.tx,Vq=Vn.resultMatrix.ty,VE=Va.resultMatrix.tx,Vm=Va.resultMatrix.ty,Vb=VE-Vi,VP=Vm-Vq,VA=Vb*Vb+VP*VP,VT=Math.sqrt(VA),VK=(Vb=VU-Vn.resultMatrix.tx)*Vb+(VP=Vx-Vn.resultMatrix.ty)*VP,VY=Math.sqrt(VK);if(Vz+VT<=VY||VY+Vz<=VT||VY+VT<=Vz){var VW=NaN;VE=Vi+(VW=Vz+VT<=VY?1:-1)*(VU-Vi)*VT/VY,Vm=Vq+VW*(Vx-Vq)*VT/VY}else{var Vk=(VA-VX+VK)/(2*VK),VN=Math.sqrt(VA-Vk*Vk*VK)/VY,V_=Vi+Vb*Vk,V$=Vq+VP*Vk,VM=-VP*VN,VZ=Vb*VN;Vm=0<VD?(VE=V_-VM,V$-VZ):(VE=V_+VM,V$+VZ)}VQ=VE,VV=Vm,this.isDebug&&(this._sp||(this._sp=new Vpn,VDn.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(Vi,Vq,15,"#ff00ff"),this._sp.graphics.drawCircle(VU,Vx,15,"#ffff00"),this._sp.graphics.drawCircle(VQ,VV,15,"#ff00ff"));var Vu,Vc;Vu=Math.atan2(VV-Vn.resultMatrix.ty,VQ-Vn.resultMatrix.tx),Vn.setRotation(Vu),(Vc=Vxn._tempMatrix).identity(),Vc.rotate(Vu),Vc.scale(Vn.resultMatrix.getScaleX(),Vn.resultMatrix.getScaleY()),Vc.translate(Vn.resultMatrix.tx,Vn.resultMatrix.ty),Vc.copyTo(Vn.resultMatrix),Vn.updateChild();var VH,VG;VH=Math.atan2(Vx-VV,VU-VQ),Va.setRotation(VH),(VG=Vxn._tempMatrix).identity(),VG.rotate(VH),VG.scale(Va.resultMatrix.getScaleX(),Va.resultMatrix.getScaleY()),VG.translate(VQ,VV),Vc.copyTo(Va.resultMatrix),Va.updateChild()}},VU(Vxn,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new Vcn}]),Vxn}(),VFn=function(){function Vn(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return Vx(Vn,"laya.ani.bone.IkConstraintData"),Vn}(),VY=function(){function VG(Vn,Va){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=Vn,this.position=Vn.position,this.spacing=Vn.spacing,this.rotateMix=Vn.rotateMix,this.translateMix=Vn.translateMix,this.bones=[];for(var VU=this.data.bones,Vx=0,VD=VU.length;Vx<VD;Vx++)this.bones.push(Va[VU[Vx]])}Vx(VG,"laya.ani.bone.PathConstraint");var Vn=VG.prototype;return Vn.apply=function(Vn,Va){if(this.target){var VU=this.translateMix,Vx=this.translateMix,VD=0<Vx,Vp=this.data.spacingMode,VQ="length"==Vp,VV=this.data.rotateMode,Vy="tangent"==VV,VR="chainScale"==VV,VX=[],Vz=this.bones.length,Vi=Vy?Vz:Vz+1,Vq=[];(this._spaces=Vq)[0]=this.position;var VE=this.spacing;if(VR||VQ)for(var Vm=0,Vb=Vi-1;Vm<Vb;){var VP=this.bones[Vm],VA=VP.length,VT=VA*VP.resultMatrix.a,VK=VA*VP.resultMatrix.b;VA=Math.sqrt(VT*VT+VK*VK),VR&&(VX[Vm]=VA),Vq[++Vm]=VQ?Math.max(0,VA+VE):VE}else for(Vm=1;Vm<Vi;Vm++)Vq[Vm]=VE;var VY=this.computeWorldPositions(this.target,Vn,Va,Vi,Vy,"percent"==this.data.positionMode,"percent"==Vp);if(this._debugKey){for(Vm=0;Vm<VY.length;Vm++)Va.drawCircle(VY[Vm++],VY[Vm++],5,"#00ff00");var VW=[];for(Vm=0;Vm<VY.length;Vm++)VW.push(VY[Vm++],VY[Vm++]);Va.drawLines(0,0,VW,"#ff0000")}var Vk=VY[0],VN=VY[1],V_=this.data.offsetRotation,V$="chain"==VV&&0==V_,VM=NaN;for(Vm=0,VM=3;Vm<Vz;Vm++,VM+=3){(VP=this.bones[Vm]).resultMatrix.tx+=(Vk-VP.resultMatrix.tx)*VU,VP.resultMatrix.ty+=(VN-VP.resultMatrix.ty)*VU;var VZ=(VT=VY[VM])-Vk,Vu=(VK=VY[VM+1])-VN;if(VR&&0!=(VA=VX[Vm])){var Vc=(Math.sqrt(VZ*VZ+Vu*Vu)/VA-1)*Vx+1;VP.resultMatrix.a*=Vc,VP.resultMatrix.c*=Vc}if(Vk=VT,VN=VK,VD){var VH=VP.resultMatrix.a,VG=VP.resultMatrix.c,VI=VP.resultMatrix.b,Vv=VP.resultMatrix.d,Vl=NaN,Vj=NaN,Vh=NaN;Vl=Vy?VY[VM-1]:0==Vq[Vm+1]?VY[VM+2]:Math.atan2(Vu,VZ),Vl-=Math.atan2(VI,VH)-V_/180*Math.PI,V$&&(Vj=Math.cos(Vl),Vh=Math.sin(Vl),Vk+=((VA=VP.length)*(Vj*VH-Vh*VI)-VZ)*Vx,VN+=(VA*(Vh*VH+Vj*VI)-Vu)*Vx),Vl>Math.PI?Vl-=2*Math.PI:Vl<-Math.PI&&(Vl+=2*Math.PI),Vl*=Vx,Vj=Math.cos(Vl),Vh=Math.sin(Vl),VP.resultMatrix.a=Vj*VH-Vh*VI,VP.resultMatrix.c=Vj*VG-Vh*Vv,VP.resultMatrix.b=Vh*VH+Vj*VI,VP.resultMatrix.d=Vh*VG+Vj*Vv}}}},Vn.computeWorldVertices2=function(Vn,Va,VU,Vx,VD,Vp){var VQ,VV,Vy=Vn.currDisplayData.bones,VR=Vn.currDisplayData.weights,VX=Vn.currDisplayData.triangles,Vz=0,Vi=0,Vq=0,VE=0,Vm=0,Vb=0,VP=0,VA=0,VT=0,VK=0,VY=0;if(null!=Vy){for(Vz=0;Vz<VU;Vz+=2)Vi+=(VE=Vy[Vi])+1,Vq+=VE;var VW=Va;for(Vm=Vp,Vb=3*Vq;Vm<Vx;Vm+=2){for(VA=VP=0,VE=Vy[Vi++],VE+=Vi;Vi<VE;Vi++,Vb+=3){VQ=VW[Vy[Vi]].resultMatrix,VT=VR[Vb],VK=VR[Vb+1];var Vk=VR[Vb+2];VP+=(VT*VQ.a+VK*VQ.c+VQ.tx)*Vk,VA+=(VT*VQ.b+VK*VQ.d+VQ.ty)*Vk}VD[Vm]=VP,VD[Vm+1]=VA}}else{var VN,V_;if(VX||(VX=VR),Vn.deformData&&(VX=Vn.deformData),VN=Vn.parent,Va)for(VY=Va.length,Vz=0;Vz<VY;Vz++)if(Va[Vz].name==VN){VV=Va[Vz];break}VV&&(V_=VV.resultMatrix),V_||(V_=VG._tempMt);var V$=V_.tx,VM=V_.ty,VZ=V_.a,Vu=V_.b,Vc=V_.c,VH=V_.d;for(VV&&(VH*=VV.d),Vi=VU,Vm=Vp;Vm<Vx;Vi+=2,Vm+=2)VT=VX[Vi],VK=VX[Vi+1],VD[Vm]=VT*VZ+VK*Vu+V$,VD[Vm+1]=-(VT*Vc+VK*VH+VM)}},Vn.computeWorldPositions=function(Vn,Va,VU,Vx,VD,Vp,VQ){Vn.currDisplayData.bones,Vn.currDisplayData.weights,Vn.currDisplayData.triangles;var VV=[],Vy=0,VR=Vn.currDisplayData.verLen,VX=this.position,Vz=this._spaces,Vi=[],Vq=[],VE=VR/6,Vm=-1,Vb=NaN,VP=0,VA=0,VT=NaN,VK=NaN,VY=NaN,VW=NaN;if(VE--,VR-=4,this.computeWorldVertices2(Vn,Va,2,VR,VV,0),this._debugKey)for(Vy=0;Vy<VV.length;)VU.drawCircle(VV[Vy++],VV[Vy++],10,"#ff0000");Vi=VV,this._curves.length=VE;var Vk=this._curves,VN=Vi[Vb=0],V_=Vi[1],V$=0,VM=0,VZ=0,Vu=0,Vc=0,VH=0,VG=NaN,VI=NaN,Vv=NaN,Vl=NaN,Vj=NaN,Vh=NaN,Vf=NaN,VF=NaN,Vg=0;for(Vy=0,Vg=2;Vy<VE;Vy++,Vg+=6)V$=Vi[Vg],VM=Vi[Vg+1],VZ=Vi[Vg+2],Vu=Vi[Vg+3],Vj=2*(VG=.1875*(VN-2*V$+VZ))+(Vv=.09375*(3*(V$-VZ)-VN+(Vc=Vi[Vg+4]))),Vh=2*(VI=.1875*(V_-2*VM+Vu))+(Vl=.09375*(3*(VM-Vu)-V_+(VH=Vi[Vg+5]))),Vf=.75*(V$-VN)+VG+.16666667*Vv,VF=.75*(VM-V_)+VI+.16666667*Vl,Vb+=Math.sqrt(Vf*Vf+VF*VF),Vf+=Vj,VF+=Vh,Vj+=Vv,Vh+=Vl,Vb+=Math.sqrt(Vf*Vf+VF*VF),Vf+=Vj,VF+=Vh,Vb+=Math.sqrt(Vf*Vf+VF*VF),Vf+=Vj+Vv,VF+=Vh+Vl,Vb+=Math.sqrt(Vf*Vf+VF*VF),Vk[Vy]=Vb,VN=Vc,V_=VH;if(Vp&&(VX*=Vb),VQ)for(Vy=0;Vy<Vx;Vy++)Vz[Vy]*=Vb;var Vo=this._segments,VB=0,VO=0;for(VO=VA=VP=Vy=0;Vy<Vx;Vy++,VP+=3)if((VT=VX+=VK=Vz[Vy])<0)this.addBeforePosition(VT,Vi,0,Vq,VP);else if(Vb<VT)this.addAfterPosition(VT-Vb,Vi,VR-4,Vq,VP);else{for(;;VA++)if(!((VW=Vk[VA])<VT)){0==VA?VT/=VW:VT=(VT-(VY=Vk[VA-1]))/(VW-VY);break}if(VA!=Vm){var VL=6*(Vm=VA);for(VN=Vi[VL],V_=Vi[VL+1],V$=Vi[VL+2],VM=Vi[VL+3],VZ=Vi[VL+4],Vu=Vi[VL+5],Vj=2*(VG=.03*(VN-2*V$+VZ))+(Vv=.006*(3*(V$-VZ)-VN+(Vc=Vi[VL+6]))),Vh=2*(VI=.03*(V_-2*VM+Vu))+(Vl=.006*(3*(VM-Vu)-V_+(VH=Vi[VL+7]))),Vf=.3*(V$-VN)+VG+.16666667*Vv,VF=.3*(VM-V_)+VI+.16666667*Vl,VB=Math.sqrt(Vf*Vf+VF*VF),Vo[0]=VB,VL=1;VL<8;VL++)Vf+=Vj,VF+=Vh,Vj+=Vv,Vh+=Vl,VB+=Math.sqrt(Vf*Vf+VF*VF),Vo[VL]=VB;Vf+=Vj,VF+=Vh,VB+=Math.sqrt(Vf*Vf+VF*VF),Vo[8]=VB,Vf+=Vj+Vv,VF+=Vh+Vl,VB+=Math.sqrt(Vf*Vf+VF*VF),Vo[9]=VB,VO=0}for(VT*=VB;;VO++)if(!((VW=Vo[VO])<VT)){0==VO?VT/=VW:VT=VO+(VT-(VY=Vo[VO-1]))/(VW-VY);break}this.addCurvePosition(.1*VT,VN,V_,V$,VM,VZ,Vu,Vc,VH,Vq,VP,VD||0<Vy&&0==VK)}return Vq},Vn.addBeforePosition=function(Vn,Va,VU,Vx,VD){var Vp=Va[VU],VQ=Va[VU+1],VV=Va[VU+2]-Vp,Vy=Va[VU+3]-VQ,VR=Math.atan2(Vy,VV);Vx[VD]=Vp+Vn*Math.cos(VR),Vx[VD+1]=VQ+Vn*Math.sin(VR),Vx[VD+2]=VR},Vn.addAfterPosition=function(Vn,Va,VU,Vx,VD){var Vp=Va[VU+2],VQ=Va[VU+3],VV=Vp-Va[VU],Vy=VQ-Va[VU+1],VR=Math.atan2(Vy,VV);Vx[VD]=Vp+Vn*Math.cos(VR),Vx[VD+1]=VQ+Vn*Math.sin(VR),Vx[VD+2]=VR},Vn.addCurvePosition=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX,Vz){0==Vn&&(Vn=1e-4);var Vi=Vn*Vn,Vq=Vi*Vn,VE=1-Vn,Vm=VE*VE,Vb=Vm*VE,VP=VE*Vn,VA=3*VP,VT=VE*VA,VK=VA*Vn,VY=Va*Vb+Vx*VT+Vp*VK+VV*Vq,VW=VU*Vb+VD*VT+VQ*VK+Vy*Vq;VR[VX]=VY,VR[VX+1]=VW,VR[VX+2]=Vz?Math.atan2(VW-(VU*Vm+VD*VP*2+VQ*Vi),VY-(Va*Vm+Vx*VP*2+Vp*Vi)):0},VG.NONE=-1,VG.BEFORE=-2,VG.AFTER=-3,VU(VG,["_tempMt",function(){return this._tempMt=new Vcn}]),VG}(),Vgn=function(){function Vn(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return Vx(Vn,"laya.ani.bone.PathConstraintData"),Vn}(),Von=function(){function Vn(){this.name=null,this.slotArr=[]}return Vx(Vn,"laya.ani.bone.SkinData"),Vn}(),VBn=function(){function Vn(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}Vx(Vn,"laya.ani.bone.SkinSlotDisplayData");var Va=Vn.prototype;return Va.createTexture=function(Vn){return this.texture||(this.texture=new VHn(Vn.bitmap,this.uvs),Vn.bitmap.alphaTexture&&(this.texture.alphaTexture=new VHn(Vn.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=Vn.height,this.texture.height=Vn.width,this.texture.offsetX=-Vn.offsetX,this.texture.offsetY=-Vn.offsetY,this.texture.sourceWidth=Vn.sourceHeight,this.texture.sourceHeight=Vn.sourceWidth):(this.texture.width=Vn.width,this.texture.height=Vn.height,this.texture.offsetX=-Vn.offsetX,this.texture.offsetY=-Vn.offsetY,this.texture.sourceWidth=Vn.sourceWidth,this.texture.sourceHeight=Vn.sourceHeight),Vb.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},Va.destory=function(){this.texture&&this.texture.destroy()},Vn}(),VOn=function(){function Vn(){this.name=null,this.displayArr=[]}return Vx(Vn,"laya.ani.bone.SlotData"),Vn.prototype.getDisplayByName=function(Vn){for(var Va=0,VU=this.displayArr.length;Va<VU;Va++)if(this.displayArr[Va].attachmentName==Vn)return Va;return-1},Vn}(),VW=function(){function Vn(Vn,Va){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=Vm(2,0),this._data=Vn,null==this._bones&&(this._bones=[]),this.target=Va[Vn.targetIndex];var VU,Vx=0;for(Vx=0,VU=Vn.boneIndexs.length;Vx<VU;Vx++)this._bones.push(Va[Vn.boneIndexs[Vx]]);this.rotateMix=Vn.rotateMix,this.translateMix=Vn.translateMix,this.scaleMix=Vn.scaleMix,this.shearMix=Vn.shearMix}return Vx(Vn,"laya.ani.bone.TfConstraint"),Vn.prototype.apply=function(){for(var Vn,Va=this.target.resultMatrix.a,VU=this.target.resultMatrix.b,Vx=this.target.resultMatrix.c,VD=this.target.resultMatrix.d,Vp=0,VQ=this._bones.length;Vp<VQ;Vp++){if(Vn=this._bones[Vp],0<this.rotateMix){var VV=Vn.resultMatrix.a,Vy=Vn.resultMatrix.b,VR=Vn.resultMatrix.c,VX=Vn.resultMatrix.d,Vz=Math.atan2(Vx,Va)-Math.atan2(VR,VV)+this._data.offsetRotation*Math.PI/180;Vz>Math.PI?Vz-=2*Math.PI:Vz<-Math.PI&&(Vz+=2*Math.PI),Vz*=this.rotateMix;var Vi=Math.cos(Vz),Vq=Math.sin(Vz);Vn.resultMatrix.a=Vi*VV-Vq*VR,Vn.resultMatrix.b=Vi*Vy-Vq*VX,Vn.resultMatrix.c=Vq*VV+Vi*VR,Vn.resultMatrix.d=Vq*Vy+Vi*VX}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),Vn.resultMatrix.tx+=(this._temp[0]-Vn.resultMatrix.tx)*this.translateMix,Vn.resultMatrix.ty+=(this._temp[1]-Vn.resultMatrix.ty)*this.translateMix,Vn.updateChild()),0<this.scaleMix){var VE=Math.sqrt(Vn.resultMatrix.a*Vn.resultMatrix.a+Vn.resultMatrix.c*Vn.resultMatrix.c),Vm=Math.sqrt(Va*Va+Vx*Vx),Vb=1e-5<VE?(VE+(Vm-VE+this._data.offsetScaleX)*this.scaleMix)/VE:0;Vn.resultMatrix.a*=Vb,Vn.resultMatrix.c*=Vb,VE=Math.sqrt(Vn.resultMatrix.b*Vn.resultMatrix.b+Vn.resultMatrix.d*Vn.resultMatrix.d),Vm=Math.sqrt(VU*VU+VD*VD),Vb=1e-5<VE?(VE+(Vm-VE+this._data.offsetScaleY)*this.scaleMix)/VE:0,Vn.resultMatrix.b*=Vb,Vn.resultMatrix.d*=Vb}if(0<this.shearMix){Vy=Vn.resultMatrix.b,VX=Vn.resultMatrix.d;var VP=Math.atan2(VX,Vy);(Vz=Math.atan2(VD,VU)-Math.atan2(Vx,Va)-(VP-Math.atan2(Vn.resultMatrix.c,Vn.resultMatrix.a)))>Math.PI?Vz-=2*Math.PI:Vz<-Math.PI&&(Vz+=2*Math.PI),Vz=VP+(Vz+this._data.offsetShearY*Math.PI/180)*this.shearMix,Vb=Math.sqrt(Vy*Vy+VX*VX),Vn.resultMatrix.b=Math.cos(Vz)*Vb,Vn.resultMatrix.d=Math.sin(Vz)*Vb}}},Vn}(),VLn=function(){function Vn(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return Vx(Vn,"laya.ani.bone.TfConstraintData"),Vn}(),Vdn=function(){function Vn(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}Vx(Vn,"laya.ani.bone.Transform");var Va=Vn.prototype;return Va.initData=function(Vn){null!=Vn.x&&(this.x=Vn.x),null!=Vn.y&&(this.y=Vn.y),null!=Vn.skX&&(this.skX=Vn.skX),null!=Vn.skY&&(this.skY=Vn.skY),null!=Vn.scX&&(this.scX=Vn.scX),null!=Vn.scY&&(this.scY=Vn.scY)},Va.getMatrix=function(){var Vn;return(Vn=this.mMatrix?this.mMatrix:this.mMatrix=new Vcn).identity(),Vn.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(Vn,this.skewX*Math.PI/180,this.skewY*Math.PI/180),Vn.rotate(this.skX*Math.PI/180),Vn.translate(this.x,this.y),Vn},Va.skew=function(Vn,Va,VU){var Vx=Math.sin(VU),VD=Math.cos(VU),Vp=Math.sin(Va),VQ=Math.cos(Va);return Vn.setTo(Vn.a*VQ-Vn.b*Vx,Vn.a*Vp+Vn.b*VD,Vn.c*VQ-Vn.d*Vx,Vn.c*Vp+Vn.d*VD,Vn.tx*VQ-Vn.ty*Vx,Vn.tx*Vp+Vn.ty*VD),Vn},Vn}(),Vk=function(){function Vn(){}return Vx(Vn,"laya.ani.bone.UVTools"),Vn.getRelativeUV=function(Vn,Va,VU){var Vx=Vn[0],VD=Vn[2]-Vn[0],Vp=Vn[1],VQ=Vn[5]-Vn[1];VU||(VU=[]),VU.length=Va.length;var VV,Vy=0;VV=VU.length;var VR=1/VD,VX=1/VQ;for(Vy=0;Vy<VV;Vy+=2)VU[Vy]=(Va[Vy]-Vx)*VR,VU[Vy+1]=(Va[Vy+1]-Vp)*VX;return VU},Vn.getAbsoluteUV=function(Vn,Va,VU){if(0==Vn[0]&&0==Vn[1]&&1==Vn[4]&&1==Vn[5])return VU?(VP.copyArray(VU,Va),VU):Va;var Vx=Vn[0],VD=Vn[2]-Vn[0],Vp=Vn[1],VQ=Vn[5]-Vn[1];VU||(VU=[]),VU.length=Va.length;var VV,Vy=0;for(VV=VU.length,Vy=0;Vy<VV;Vy+=2)VU[Vy]=Va[Vy]*VD+Vx,VU[Vy+1]=Va[Vy+1]*VQ+Vp;return VU},Vn}(),VG=function(){function Vn(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return Vx(Vn,"laya.ani.KeyFramesContent"),Vn}(),VN=function(){function VX(){}return Vx(VX,"laya.ani.math.BezierLerp"),VX.getBezierRate=function(Vn,Va,VU,Vx,VD){var Vp=VX._getBezierParamKey(Va,VU,Vx,VD),VQ=100*Vp+Vn;if(VX._bezierResultCache[VQ])return VX._bezierResultCache[VQ];var VV,Vy=VX._getBezierPoints(Va,VU,Vx,VD,Vp),VR=0;for(VV=Vy.length,VR=0;VR<VV;VR+=2)if(Vn<=Vy[VR])return VX._bezierResultCache[VQ]=Vy[VR+1],Vy[VR+1];return VX._bezierResultCache[VQ]=1},VX._getBezierParamKey=function(Vn,Va,VU,Vx){return 100*(100*(100*(100*Vn+Va)+VU)+Vx)},VX._getBezierPoints=function(Vn,Va,VU,Vx,VD){return VX._bezierPointsCache[VD]?VX._bezierPointsCache[VD]:(Vp=[0,0,Vn,Va,VU,Vx,1,1],VQ=(new VV).getBezierPoints(Vp,100,3),VX._bezierPointsCache[VD]=VQ);var Vp,VQ},VX._bezierResultCache={},VX._bezierPointsCache={},VX}(),V_=function(Vn){function Va(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,Va.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}Vx(Va,"laya.ani.AnimationPlayer",VD);var VU=Va.prototype;return VDn.imps(VU,{"laya.resource.IDestroy":!0}),VU._onTempletLoadedComputeFullKeyframeIndices=function(Vn,Va,VU){this._templet===VU&&this._cachePlayRate===Vn&&this._cacheFrameRate===Va&&this._computeFullKeyframeIndices()},VU._computeFullKeyframeIndices=function(){for(var Vn=this._fullFrames=[],Va=this._templet,VU=this._cacheFrameRateInterval*this._cachePlayRate,Vx=0,VD=Va.getAnimationCount();Vx<VD;Vx++){for(var Vp=[],VQ=0,VV=Va.getAnimation(Vx).nodes.length;VQ<VV;VQ++){for(var Vy=Va.getAnimation(Vx).nodes[VQ],VR=Math.floor(Vy.playTime/VU+.01),VX=new Uint16Array(VR+1),Vz=-1,Vi=0,Vq=Vy.keyFrame.length;Vi<Vq;Vi++){var VE=Vy.keyFrame[Vi],Vm=VE.startTime,Vb=Vm+VE.duration+VU;do{for(var VP=Math.floor(Vm/VU+.5),VA=Vz+1;VA<VP;VA++)VX[VA]=Vi;VX[Vz=VP]=Vi,Vm+=VU}while(Vm<=Vb)}Vp.push(VX)}Vn.push(Vp)}},VU._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},VU._calculatePlayDuration=function(){if(0!==this.state){var Vn=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=Vn),this._playEnd>Vn&&(this._playEnd=Vn),this._playDuration=this._playEnd-this._playStart}},VU._setPlayParams=function(Vn,Va){this._currentTime=Vn,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/Va+.01),0),this._currentFrameTime=this._currentKeyframeIndex*Va},VU._setPlayParamsWhenStop=function(Vn,Va){this._currentTime=Vn,this._currentKeyframeIndex=Math.max(Math.floor(Vn/Va+.01),0),this._currentFrameTime=this._currentKeyframeIndex*Va,this._currentAnimationClipIndex=-1},VU._update=function(Vn){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var Va=this._cacheFrameRateInterval*this._cachePlayRate,VU=0;this._startUpdateLoopCount!==VE.loopCount&&(VU=Vn*this.playbackRate,this._elapsedPlaybackTime+=VU);var Vx=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=Vx)return this._setPlayParamsWhenStop(Vx,Va),void this.event("stopped");if(VU+=this._currentTime,0<Vx)if(Vx<=VU)do{if(VU-=Vx,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(Vx,Va),this._stopWhenCircleFinish=!1,void this.event("stopped");VU<Vx&&(this._setPlayParams(VU,Va),this.event("complete"))}while(Vx<=VU);else this._setPlayParams(VU,Va);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(Vx,Va),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},VU._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},VU.play=function(Vn,Va,VU,Vx,VD){if(void 0===Vn&&(Vn=0),void 0===Va&&(Va=1),void 0===VU&&(VU=2147483647),void 0===Vx&&(Vx=0),void 0===VD&&(VD=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(VU<0||Vx<0||VD<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==VD&&VD<Vx)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=Va,this._overallDuration=VU,this._playStart=Vx,this._playEnd=VD,this._paused=!1,this._currentAnimationClipIndex=Vn,this._currentKeyframeIndex=0,this._startUpdateLoopCount=VE.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},VU.playByFrame=function(Vn,Va,VU,Vx,VD,Vp){void 0===Vn&&(Vn=0),void 0===Va&&(Va=1),void 0===VU&&(VU=2147483647),void 0===Vx&&(Vx=0),void 0===VD&&(VD=0),void 0===Vp&&(Vp=30);var VQ=1e3/Vp;this.play(Vn,Va,VU,Vx*VQ,VD*VQ)},VU.stop=function(Vn){void 0===Vn&&(Vn=!0),Vn?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},Vp(0,VU,"playEnd",function(){return this._playEnd}),Vp(0,VU,"templet",function(){return this._templet},function(Vn){0===!this.state&&this.stop(!0),this._templet!==Vn&&((this._templet=Vn).loaded?this._computeFullKeyframeIndices():Vn.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),Vp(0,VU,"playStart",function(){return this._playStart}),Vp(0,VU,"playDuration",function(){return this._playDuration}),Vp(0,VU,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),Vp(0,VU,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),Vp(0,VU,"overallDuration",function(){return this._overallDuration}),Vp(0,VU,"currentFrameTime",function(){return this._currentFrameTime}),Vp(0,VU,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),Vp(0,VU,"currentPlayTime",function(){return this._currentTime+this._playStart}),Vp(0,VU,"cachePlayRate",function(){return this._cachePlayRate},function(Vn){this._cachePlayRate!==Vn&&(this._cachePlayRate=Vn,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[Vn,this._cacheFrameRate])))}),Vp(0,VU,"cacheFrameRate",function(){return this._cacheFrameRate},function(Vn){this._cacheFrameRate!==Vn&&(this._cacheFrameRate=Vn,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,Vn])))}),Vp(0,VU,"currentTime",null,function(Vn){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(Vn<this._playStart||Vn>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=VE.loopCount;var Va=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=Vn,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/Va),0),this._currentFrameTime=this._currentKeyframeIndex*Va}}),Vp(0,VU,"paused",function(){return this._paused},function(Vn){(this._paused=Vn)&&this.event("paused")}),Vp(0,VU,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),Vp(0,VU,"destroyed",function(){return this._destroyed}),Va}(),VI=function(Vn){function Va(){Va.__super.call(this),Vb.isConchNode&&(this.drawSkin=function(Vn){Vn.transform||(Vn.transform=Vcn.EMPTY),this._addCmd([Vn]),this.setSkinMesh&&this.setSkinMesh(Vn._ps,Vn.mVBData,Vn.mEleNum,0,Vn.mTexture,Vn.transform)})}return Vx(Va,"laya.ani.GraphicsAni",VQ),Va.prototype.drawSkin=function(Vn){var Va=[Vn];this._saveToCmd(Vb._context._drawSkin,Va)},Va.create=function(){return Va._caches.pop()||new Va},Va.recycle=function(Vn){Vn.clear(),Va._caches.push(Vn)},Va._caches=[],Va}(),Vv=function(Vn){function VA(){this._aniMap={},this.unfixedLastAniIndex=-1,VA.__super.call(this),this._anis=new Array}Vx(VA,"laya.ani.AnimationTemplet",VX);var Va=VA.prototype;return Va.parse=function(Vn){var Va=new Vun(Vn);this._aniVersion=Va.readUTFString(),VT.parse(this,Va)},Va._calculateKeyFrame=function(Vn,Va,VU){var Vx=Vn.keyFrame;Vx[Va]=Vx[0];for(var VD=0;VD<Va;VD++){var Vp=Vx[VD];Vp.nextData=0===Vp.duration?Vp.data:Vx[VD+1].data}Vx.length--},Va.onAsynLoaded=function(Vn,Va,VU){var Vx=new Vun(Va);switch(this._aniVersion=Vx.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":VK.parse(this,Vx);break;default:VT.parse(this,Vx)}this._endLoaded()},Va.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},Va.getAnimationCount=function(){return this._anis.length},Va.getAnimation=function(Vn){return this._anis[Vn]},Va.getAniDuration=function(Vn){return this._anis[Vn].playTime},Va.getNodes=function(Vn){return this._anis[Vn].nodes},Va.getNodeIndexWithName=function(Vn,Va){return this._anis[Vn].bone3DMap[Va]},Va.getNodeCount=function(Vn){return this._anis[Vn].nodes.length},Va.getTotalkeyframesLength=function(Vn){return this._anis[Vn].totalKeyframeDatasLength},Va.getPublicExtData=function(){return this._publicExtData},Va.getAnimationDataWithCache=function(Vn,Va,VU,Vx){var VD=Va[VU];if(VD){var Vp=VD[Vn];return Vp?Vp[Vx]:null}return null},Va.setAnimationDataWithCache=function(Vn,Va,VU,Vx,VD){var Vp=Va[VU]||(Va[VU]={});(Vp[Vn]||(Vp[Vn]=[]))[Vx]=VD},Va.getOriginalData=function(Vn,Va,VU,Vx,VD){for(var Vp=this._anis[Vn].nodes,VQ=0,VV=0,Vy=Vp.length,VR=0;VV<Vy;VV++){var VX,Vz=Vp[VV];VX=Vz.keyFrame[VU[VV][Vx]],Vz.dataOffset=VR;var Vi=VD-VX.startTime,Vq=Vz.lerpType;if(Vq)switch(Vq){case 0:case 1:for(VQ=0;VQ<Vz.keyframeWidth;)VQ+=Vz.interpolationMethod[VQ](Vz,VQ,Va,VR+VQ,VX.data,Vi,null,VX.duration,VX.nextData);break;case 2:var VE=VX.interpolationData,Vm=VE.length,Vb=0;for(VQ=0;VQ<Vm;){var VP=VE[VQ];switch(VP){case 6:case 7:VQ+=VA.interpolation[VP](Vz,Vb,Va,VR+Vb,VX.data,Vi,null,VX.duration,VX.nextData,VE,VQ+1);break;default:VQ+=VA.interpolation[VP](Vz,Vb,Va,VR+Vb,VX.data,Vi,null,VX.duration,VX.nextData)}Vb++}}else for(VQ=0;VQ<Vz.keyframeWidth;)VQ+=Vz.interpolationMethod[VQ](Vz,VQ,Va,VR+VQ,VX.data,Vi,null,VX.duration,VX.nextData);VR+=Vz.keyframeWidth}},Va.getNodesCurrentFrameIndex=function(Vn,Va){var VU=this._anis[Vn].nodes;Vn!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(VU.length),this.unfixedCurrentTimes=new Float32Array(VU.length),this.unfixedLastAniIndex=Vn);for(var Vx=0,VD=VU.length;Vx<VD;Vx++){var Vp=VU[Vx];for(Va<this.unfixedCurrentTimes[Vx]&&(this.unfixedCurrentFrameIndexes[Vx]=0),this.unfixedCurrentTimes[Vx]=Va;this.unfixedCurrentFrameIndexes[Vx]<Vp.keyFrame.length&&!(Vp.keyFrame[this.unfixedCurrentFrameIndexes[Vx]].startTime>this.unfixedCurrentTimes[Vx]);)this.unfixedCurrentFrameIndexes[Vx]++;this.unfixedCurrentFrameIndexes[Vx]--}return this.unfixedCurrentFrameIndexes},Va.getOriginalDataUnfixedRate=function(Vn,Va,VU){var Vx=this._anis[Vn].nodes;Vn!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(Vx.length),this.unfixedCurrentTimes=new Float32Array(Vx.length),this.unfixedKeyframes=Vm(Vx.length),this.unfixedLastAniIndex=Vn);for(var VD=0,Vp=0,VQ=Vx.length,VV=0;Vp<VQ;Vp++){var Vy=Vx[Vp];for(VU<this.unfixedCurrentTimes[Vp]&&(this.unfixedCurrentFrameIndexes[Vp]=0),this.unfixedCurrentTimes[Vp]=VU;this.unfixedCurrentFrameIndexes[Vp]<Vy.keyFrame.length&&!(Vy.keyFrame[this.unfixedCurrentFrameIndexes[Vp]].startTime>this.unfixedCurrentTimes[Vp]);)this.unfixedKeyframes[Vp]=Vy.keyFrame[this.unfixedCurrentFrameIndexes[Vp]],this.unfixedCurrentFrameIndexes[Vp]++;var VR=this.unfixedKeyframes[Vp];Vy.dataOffset=VV;var VX=VU-VR.startTime;if(Vy.lerpType)switch(Vy.lerpType){case 0:case 1:for(VD=0;VD<Vy.keyframeWidth;)VD+=Vy.interpolationMethod[VD](Vy,VD,Va,VV+VD,VR.data,VX,null,VR.duration,VR.nextData);break;case 2:var Vz=VR.interpolationData,Vi=Vz.length,Vq=0;for(VD=0;VD<Vi;){var VE=Vz[VD];switch(VE){case 6:case 7:VD+=VA.interpolation[VE](Vy,Vq,Va,VV+Vq,VR.data,VX,null,VR.duration,VR.nextData,Vz,VD+1);break;default:VD+=VA.interpolation[VE](Vy,Vq,Va,VV+Vq,VR.data,VX,null,VR.duration,VR.nextData)}Vq++}}else for(VD=0;VD<Vy.keyframeWidth;)VD+=Vy.interpolationMethod[VD](Vy,VD,Va,VV+VD,VR.data,VX,null,VR.duration,VR.nextData);VV+=Vy.keyframeWidth}},VA._LinearInterpolation_0=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){var VX=0===VV?0:Vp/VV;return VU[Vx]=(1-VX)*VD[Va]+VX*Vy[Va],1},VA._QuaternionInterpolation_1=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){var VX=0===VV?0:Vp/VV;return Vi.slerpQuaternionArray(VD,Va,Vy,Va,VX,VU,Vx),4},VA._AngleInterpolation_2=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){return 0},VA._RadiansInterpolation_3=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){return 0},VA._Matrix4x4Interpolation_4=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){for(var VX=0;VX<16;VX++,Va++)VU[Vx+VX]=VD[Va]+Vp*VQ[Va];return 16},VA._NoInterpolation_5=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR){return VU[Vx]=VD[Va],1},VA._BezierInterpolation_6=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX){return void 0===VX&&(VX=0),VU[Vx]=VD[Va]+(Vy[Va]-VD[Va])*VN.getBezierRate(Vp/VV,VR[VX],VR[VX+1],VR[VX+2],VR[VX+3]),5},VA._BezierInterpolation_7=function(Vn,Va,VU,Vx,VD,Vp,VQ,VV,Vy,VR,VX){return void 0===VX&&(VX=0),VU[Vx]=VR[VX+4]+VR[VX+5]*VN.getBezierRate((.001*Vp+VR[VX+6])/VR[VX+7],VR[VX],VR[VX+1],VR[VX+2],VR[VX+3]),9},VA.load=function(Vn){return VDn.loader.create(Vn,null,null,VA)},VA.interpolation=[VA._LinearInterpolation_0,VA._QuaternionInterpolation_1,VA._AngleInterpolation_2,VA._RadiansInterpolation_3,VA._Matrix4x4Interpolation_4,VA._NoInterpolation_5,VA._BezierInterpolation_6,VA._BezierInterpolation_7],VA}(),V$=function(Va){function VU(Vn,Va){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,VU.__super.call(this),void 0===Va&&(Va=0),Vn&&this.init(Vn,Va)}Vx(VU,"laya.ani.bone.Skeleton",Va);var Vn=VU.prototype;return Vn.init=function(Vn,Va){void 0===Va&&(Va=0);var VU,Vx,VD,Vp=0,VQ=0;if(1==Va)for(this._graphicsCache=[],Vp=0,VQ=Vn.getAnimationCount();Vp<VQ;Vp++)this._graphicsCache.push([]);if(this._yReverseMatrix=Vn.yReverseMatrix,this._aniMode=Va,this._templet=Vn,this._player=new V_,this._player.cacheFrameRate=Vn.rate,this._player.templet=Vn,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=Vn.mBoneArr,this._rootBone=Vn.mRootBone,this._aniSectionDic=Vn.aniSectionDic,0<Vn.ikArr.length)for(this._ikArr=[],Vp=0,VQ=Vn.ikArr.length;Vp<VQ;Vp++)this._ikArr.push(new VA(Vn.ikArr[Vp],this._boneList));if(0<Vn.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),Vp=0,VQ=Vn.pathArr.length;Vp<VQ;Vp++)VU=Vn.pathArr[Vp],Vx=new VY(VU,this._boneList),(VD=this._boneSlotDic[VU.name])&&((Vx=new VY(VU,this._boneList)).target=VD),this._pathDic[VU.name]=Vx;if(0<Vn.tfArr.length)for(this._tfArr=[],Vp=0,VQ=Vn.tfArr.length;Vp<VQ;Vp++)this._tfArr.push(new VW(Vn.tfArr[Vp],this._boneList));if(0<Vn.skinDataArray.length){var VV=this._templet.skinDataArray[this._skinIndex];this._skinName=VV.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},Vn.load=function(Vn,Va,VU){},Vn._onLoaded=function(){},Vn._parseComplete=function(){var Vn=VM.TEMPLET_DICTIONARY[this._aniPath];Vn&&(this.init(Vn,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},Vn._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},Vn._onPlay=function(){this.event("played")},Vn._onStop=function(){var Vn,Va=this._templet.eventAniArr[this._aniClipIndex];if(Va&&this._eventIndex<Va.length)for(;this._eventIndex<Va.length;this._eventIndex++)(Vn=Va[this._eventIndex]).time>=this._player.playStart&&Vn.time<=this._player.playEnd&&this.event("label",Vn);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},Vn._onPause=function(){this.event("paused")},Vn._parseSrcBoneMatrix=function(){var Vn=0,Va=0;for(Va=this._templet.srcBoneMatrixArr.length,Vn=0;Vn<Va;Vn++)this._boneMatrixArray.push(new Vcn);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var VU,Vx,VD=this._templet.boneSlotArray;for(Vn=0,Va=VD.length;Vn<Va;Vn++)VU=VD[Vn],null==(Vx=this._bindBoneBoneSlotDic[VU.parent])&&(this._bindBoneBoneSlotDic[VU.parent]=Vx=[]),this._boneSlotDic[VU.name]=VU=VU.copy(),Vx.push(VU),this._boneSlotArray.push(VU)}},Vn._emitMissedEvents=function(Vn,Va,VU){void 0===VU&&(VU=0);var Vx=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(Vx){var VD,Vp,VQ=0;for(VD=Vx.length,VQ=VU;VQ<VD;VQ++)(Vp=Vx[VQ]).time>=this._player.playStart&&Vp.time<=this._player.playEnd&&this.event("label",Vp)}},Vn._update=function(Vn){if(void 0===Vn&&(Vn=!0),!(this._pause||Vn&&this._indexControl)){var Va=this.timer.currTimer,VU=this._player.currentKeyframeIndex,Vx=Va-this._lastTime;if(Vn?this._player._update(Vx):VU=-1,this._lastTime=Va,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<Vx&&this._clipIndex==VU&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var VD;this._lastUpdateAniClipIndex=this._aniClipIndex,VU>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var Vp,VQ=this._templet.eventAniArr[this._aniClipIndex];if(VQ&&this._eventIndex<VQ.length&&((VD=VQ[this._eventIndex]).time>=this._player.playStart&&VD.time<=this._player.playEnd?this._player.currentPlayTime>=VD.time&&(this.event("label",VD),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(Vp=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=Vp&&(this.graphics=Vp));var VV=0,Vy=0;for(Vy=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,Vy-1)&&0<Vy;)Vy--;if(Vy<this._clipIndex)for(VV=Vy;VV<this._clipIndex;VV++)this._createGraphics(VV)}else if(1==this._aniMode){if(Vp=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=Vp&&(this.graphics=Vp));for(Vy=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,Vy-1)&&0<Vy;)Vy--;if(Vy<this._clipIndex)for(VV=Vy;VV<this._clipIndex;VV++)this._createGraphics(VV)}this._createGraphics()}}},Vn._createGraphics=function(Vn){void 0===Vn&&(Vn=-1),-1==Vn&&(Vn=this._clipIndex);var Va,VU,Vx=Vn*this._player.cacheFrameRateInterval,VD=this._templet.drawOrderAniArr[this._aniClipIndex];if(VD&&0<VD.length)for(this._drawOrderIndex=0,Va=VD[this._drawOrderIndex];Vx>=Va.time&&(this._drawOrder=Va.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=VD.length));)Va=VD[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=VI.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=VI.create(),VU=this.graphics;var Vp=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],Vn,Vx);var VQ,VV,Vy,VR,VX=this._aniSectionDic[this._aniClipIndex],Vz=0,Vi=0,Vq=0,VE=0,Vm=0,Vb=this._templet.srcBoneMatrixArr.length;for(Vm=VX[Vi=0];Vi<Vb;Vi++)VR=this._boneList[Vi],Vy=this._templet.srcBoneMatrixArr[Vi],VR.resultTransform.scX=Vy.scX*this._curOriginalData[Vz++],VR.resultTransform.skX=Vy.skX+this._curOriginalData[Vz++],VR.resultTransform.skY=Vy.skY+this._curOriginalData[Vz++],VR.resultTransform.scY=Vy.scY*this._curOriginalData[Vz++],VR.resultTransform.x=Vy.x+this._curOriginalData[Vz++],VR.resultTransform.y=Vy.y+this._curOriginalData[Vz++],8===this._templet.tMatrixDataLen&&(VR.resultTransform.skewX=Vy.skewX+this._curOriginalData[Vz++],VR.resultTransform.skewY=Vy.skewY+this._curOriginalData[Vz++]);var VP,VA={},VT={};for(Vm+=VX[1];Vi<Vm;Vi++)VA[(VP=Vp[Vi]).name]=this._curOriginalData[Vz++],VT[VP.name]=this._curOriginalData[Vz++],this._curOriginalData[Vz++],this._curOriginalData[Vz++],this._curOriginalData[Vz++],this._curOriginalData[Vz++];var VK,VY,VW={},Vk={};for(Vm+=VX[2];Vi<Vm;Vi++)VW[(VP=Vp[Vi]).name]=this._curOriginalData[Vz++],Vk[VP.name]=this._curOriginalData[Vz++],this._curOriginalData[Vz++],this._curOriginalData[Vz++],this._curOriginalData[Vz++],this._curOriginalData[Vz++];if(this._pathDic)for(Vm+=VX[3];Vi<Vm;Vi++){if(VP=Vp[Vi],VK=this._pathDic[VP.name])switch(new Vun(VP.extenData).getByte()){case 1:VK.position=this._curOriginalData[Vz++];break;case 2:VK.spacing=this._curOriginalData[Vz++];break;case 3:VK.rotateMix=this._curOriginalData[Vz++],VK.translateMix=this._curOriginalData[Vz++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(Vcn.TEMP.identity()),this._ikArr)for(Vi=0,Vm=this._ikArr.length;Vi<Vm;Vi++)VY=this._ikArr[Vi],VW.hasOwnProperty(VY.name)&&(VY.bendDirection=VW[VY.name]),Vk.hasOwnProperty(VY.name)&&(VY.mix=Vk[VY.name]),VY.apply();if(this._pathDic)for(var VN in this._pathDic)(VK=this._pathDic[VN]).apply(this._boneList,VU);if(this._tfArr)for(Vi=0,VE=this._tfArr.length;Vi<VE;Vi++)this._tfArr[Vi].apply();for(Vi=0,VE=this._boneList.length;Vi<VE;Vi++)if(VR=this._boneList[Vi],VV=this._bindBoneBoneSlotDic[VR.name],VR.resultMatrix.copyTo(this._boneMatrixArray[Vi]),VV)for(Vq=0,Vm=VV.length;Vq<Vm;Vq++)(VQ=VV[Vq])&&VQ.setParentMatrix(VR.resultMatrix);var V_,V$,VM,VZ,Vu={},Vc=this._templet.deformAniArr;if(Vc&&0<Vc.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,Vi=0,Vm=this._boneSlotArray.length;Vi<Vm;Vi++)(VQ=this._boneSlotArray[Vi]).deformData=null;var VH,VG=Vc[this._aniClipIndex];for(VH in V_=VG.default,this._setDeform(V_,Vu,this._boneSlotArray,Vx),VG)"default"!=VH&&VH!=this._skinName&&(V_=VG[VH],this._setDeform(V_,Vu,this._boneSlotArray,Vx));V_=VG[this._skinName],this._setDeform(V_,Vu,this._boneSlotArray,Vx)}if(this._drawOrder)for(Vi=0,Vm=this._drawOrder.length;Vi<Vm;Vi++)V$=VA[(VQ=this._boneSlotArray[this._drawOrder[Vi]]).name],VM=VT[VQ.name],isNaN(VM)||(VU.save(),VU.alpha(VM)),isNaN(V$)||-2==V$||(this._templet.attachmentNames?VQ.showDisplayByName(this._templet.attachmentNames[V$]):VQ.showDisplayByIndex(V$)),Vu[this._drawOrder[Vi]]?(VZ=Vu[this._drawOrder[Vi]],VQ.currDisplayData&&VZ[VQ.currDisplayData.attachmentName]?VQ.deformData=VZ[VQ.currDisplayData.attachmentName]:VQ.deformData=null):VQ.deformData=null,isNaN(VM)?VQ.draw(VU,this._boneMatrixArray,2==this._aniMode):VQ.draw(VU,this._boneMatrixArray,2==this._aniMode,VM),isNaN(VM)||VU.restore();else for(Vi=0,Vm=this._boneSlotArray.length;Vi<Vm;Vi++)V$=VA[(VQ=this._boneSlotArray[Vi]).name],VM=VT[VQ.name],isNaN(VM)||(VU.save(),VU.alpha(VM)),isNaN(V$)||-2==V$||(this._templet.attachmentNames?VQ.showDisplayByName(this._templet.attachmentNames[V$]):VQ.showDisplayByIndex(V$)),Vu[Vi]?(VZ=Vu[Vi],VQ.currDisplayData&&VZ[VQ.currDisplayData.attachmentName]?VQ.deformData=VZ[VQ.currDisplayData.attachmentName]:VQ.deformData=null):VQ.deformData=null,isNaN(VM)?VQ.draw(VU,this._boneMatrixArray,2==this._aniMode):VQ.draw(VU,this._boneMatrixArray,2==this._aniMode,VM),isNaN(VM)||VU.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,Vn,VU):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,Vn,VU)},Vn._setDeform=function(Vn,Va,VU,Vx){if(Vn){var VD,Vp,VQ,VV=0,Vy=0,VR=0;if(Vn)for(VV=0,Vy=Vn.deformSlotDataList.length;VV<Vy;VV++)for(VD=Vn.deformSlotDataList[VV],VR=0;VR<VD.deformSlotDisplayList.length;VR++)VQ=VU[(Vp=VD.deformSlotDisplayList[VR]).slotIndex],Vp.apply(Vx,VQ),Va[Vp.slotIndex]||(Va[Vp.slotIndex]={}),Va[Vp.slotIndex][Vp.attachment]=Vp.deformData}},Vn.getAnimNum=function(){return this._templet.getAnimationCount()},Vn.getAniNameByIndex=function(Vn){return this._templet.getAniNameByIndex(Vn)},Vn.getSlotByName=function(Vn){return this._boneSlotDic[Vn]},Vn.showSkinByName=function(Vn,Va){void 0===Va&&(Va=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(Vn),Va)},Vn.showSkinByIndex=function(Vn,Va){void 0===Va&&(Va=!0);for(var VU=0;VU<this._boneSlotArray.length;VU++)this._boneSlotArray[VU].showSlotData(null,Va);if(this._templet.showSkinByIndex(this._boneSlotDic,Vn,Va)){var Vx=this._templet.skinDataArray[Vn];this._skinIndex=Vn,this._skinName=Vx.name}this._clearCache()},Vn.showSlotSkinByIndex=function(Vn,Va){if(0!=this._aniMode){var VU=this.getSlotByName(Vn);VU&&VU.showDisplayByIndex(Va),this._clearCache()}},Vn.showSlotSkinByName=function(Vn,Va){if(0!=this._aniMode){var VU=this.getSlotByName(Vn);VU&&VU.showDisplayByName(Va),this._clearCache()}},Vn.replaceSlotSkinName=function(Vn,Va,VU){if(0!=this._aniMode){var Vx=this.getSlotByName(Vn);Vx&&Vx.replaceDisplayByName(Va,VU),this._clearCache()}},Vn.replaceSlotSkinByIndex=function(Vn,Va,VU){if(0!=this._aniMode){var Vx=this.getSlotByName(Vn);Vx&&Vx.replaceDisplayByIndex(Va,VU),this._clearCache()}},Vn.setSlotSkin=function(Vn,Va){if(0!=this._aniMode){var VU=this.getSlotByName(Vn);VU&&VU.replaceSkin(Va),this._clearCache()}},Vn._clearCache=function(){if(1==this._aniMode)for(var Vn=0,Va=this._graphicsCache.length;Vn<Va;Vn++){for(var VU=0,Vx=this._graphicsCache[Vn].length;VU<Vx;VU++){var VD=this._graphicsCache[Vn][VU];VD!=this.graphics&&VI.recycle(VD)}this._graphicsCache[Vn].length=0}},Vn.play=function(Vn,Va,VU,Vx,VD,Vp){void 0===VU&&(VU=!0),void 0===Vx&&(Vx=0),void 0===VD&&(VD=0),void 0===Vp&&(Vp=!0),this._indexControl=!1;var VQ=-1,VV=NaN;if(VV=Va?2147483647:0,"string"==typeof Vn)for(var Vy=0,VR=this._templet.getAnimationCount();Vy<VR;Vy++){var VX=this._templet.getAnimation(Vy);if(VX&&Vn==VX.name){VQ=Vy;break}}else VQ=Vn;-1<VQ&&VQ<this.getAnimNum()&&(this._aniClipIndex=VQ,(VU||this._pause||this._currAniIndex!=VQ)&&(this._currAniIndex=VQ,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(VQ)),this._drawOrder=null,this._eventIndex=0,this._player.play(VQ,this._player.playbackRate,VV,Vx,VD),Vp&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=Vz.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},Vn.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},Vn.playbackRate=function(Vn){this._player&&(this._player.playbackRate=Vn)},Vn.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},Vn.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=Vz.now(),this.timer.frameLoop(1,this,this._update,null,!0))},Vn._getGrahicsDataWithCache=function(Vn,Va){return this._graphicsCache[Vn][Va]},Vn._setGrahicsDataWithCache=function(Vn,Va,VU){this._graphicsCache[Vn][Va]=VU},Vn.destroy=function(Vn){void 0===Vn&&(Vn=!0),Va.prototype.destroy.call(this,Vn),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},Vp(0,Vn,"url",function(){return this._aniPath},function(Vn){this.load(Vn)}),Vp(0,Vn,"index",function(){return this._index},function(Vn){this.player&&(this._index=Vn,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),Vp(0,Vn,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),Vp(0,Vn,"templet",function(){return this._templet}),Vp(0,Vn,"player",function(){return this._player}),VU.useSimpleMeshInCanvas=!1,VU}(Vpn),VM=function(Va){function VD(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,VD.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}Vx(VD,"laya.ani.bone.Templet",Va);var Vn=VD.prototype;return Vn.getLoadList=function(){return this._loadList},Vn.loadAni=function(Vn){this._skBufferUrl=Vn,VDn.loader.load(Vn,Vy.create(this,this.onComplete),null,"arraybuffer")},Vn.onComplete=function(Vn){if(this._isDestroyed)this.destroy();else{var Va=VR.getRes(this._skBufferUrl);Va?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,Va)):this.event("error","load failed:"+this._skBufferUrl)}},Vn.parseData=function(Vn,Va,VU){void 0===VU&&(VU=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=Vn,this._mainTexture&&Vb.isWebGL&&Vn.bitmap&&(Vn.bitmap.enableMerageInAtlas=!1),this._rate=VU,this.parse(Va)},Vn.buildArmature=function(Vn){return void 0===Vn&&(Vn=0),new V$(this,Vn)},Vn.parse=function(Vn){Va.prototype.parse.call(this,Vn),this._endLoaded(),this._aniVersion!=VD.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+VD.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},Vn._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var Vn=0;this._loadList=[];var Va,VU=new Vun(this.getPublicExtData()),Vx=0,VD=0,Vp=0,VQ=VU.getInt32(),VV=VU.readUTFString(),Vy=VV.split("\n");for(Vn=0;Vn<VQ;Vn++)Va=this._path+Vy[2*Vn],VV=Vy[2*Vn+1],VU.getFloat32(),VU.getFloat32(),Vx=VU.getFloat32(),VD=VU.getFloat32(),Vp=VU.getFloat32(),isNaN(Vp)?0:Vp,Vp=VU.getFloat32(),isNaN(Vp)?0:Vp,Vp=VU.getFloat32(),isNaN(Vp)?Vx:Vp,Vp=VU.getFloat32(),isNaN(Vp)?VD:Vp,-1==this._loadList.indexOf(Va)&&this._loadList.push(Va);this.event("inited",this)}},Vn._textureComplete=function(){for(var Vn,Va,VU=0,Vx=this._loadList.length;VU<Vx;VU++)Va=this._loadList[VU],Vn=this._textureDic[Va]=VR.getRes(Va),Vb.isWebGL&&Vn&&Vn.bitmap&&(Vn.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},Vn._parsePublicExtData=function(){var Vn=0,Va=0,VU=0,Vx=0,VD=0;for(Vn=0,VD=this.getAnimationCount();Vn<VD;Vn++)this._graphicsCache.push([]);var Vp;Vp="Dragon"!=this._aniClassName;var VQ,VV,Vy=new Vun(this.getPublicExtData()),VR=0,VX=0,Vz=0,Vi=0,Vq=0,VE=0,Vm=0,Vb=0,VP=0,VA=Vy.getInt32(),VT=Vy.readUTFString(),VK=VT.split("\n");for(Vn=0;Vn<VA;Vn++){if(VQ=this._mainTexture,VV=this._path+VK[2*Vn],VT=VK[2*Vn+1],null==this._mainTexture&&(VQ=this._textureDic[VV]),!VQ)return this.event("error",this),void(this.isParseFail=!0);VR=Vy.getFloat32(),VX=Vy.getFloat32(),Vz=Vy.getFloat32(),Vi=Vy.getFloat32(),VP=Vy.getFloat32(),Vq=isNaN(VP)?0:VP,VP=Vy.getFloat32(),VE=isNaN(VP)?0:VP,VP=Vy.getFloat32(),Vm=isNaN(VP)?Vz:VP,VP=Vy.getFloat32(),Vb=isNaN(VP)?Vi:VP,this.subTextureDic[VT]=VHn.create(VQ,VR,VX,Vz,Vi,-Vq,-VE,Vm,Vb),VQ.alphaTexture&&(this.subTextureDic[VT].alphaTexture=VHn.create(VQ.alphaTexture,VR,VX,Vz,Vi,-Vq,-VE,Vm,Vb))}this._mainTexture=VQ;var VY,VW,Vk,VN,V_,V$=Vy.getUint16();for(Vn=0;Vn<V$;Vn++)(VY=[]).push(Vy.getUint16()),VY.push(Vy.getUint16()),VY.push(Vy.getUint16()),VY.push(Vy.getUint16()),this.aniSectionDic[Vn]=VY;var VM,VZ=Vy.getInt16(),Vu={};for(Vn=0;Vn<VZ;Vn++)VW=new VGn,0==Vn?VM=VW:VW.root=VM,VW.d=Vp?-1:1,VN=Vy.readUTFString(),V_=Vy.readUTFString(),VW.length=Vy.getFloat32(),1==Vy.getByte()&&(VW.inheritRotation=!1),1==Vy.getByte()&&(VW.inheritScale=!1),VW.name=VN,V_&&((Vk=Vu[V_])?Vk.addChild(VW):this.mRootBone=VW),Vu[VN]=VW,this.mBoneArr.push(VW);this.tMatrixDataLen=Vy.getUint16();var Vc,VH,VG=Vy.getUint16(),VI=Math.floor(VG/this.tMatrixDataLen),Vv=this.srcBoneMatrixArr;for(Vn=0;Vn<VI;Vn++)(Vc=new Vdn).scX=Vy.getFloat32(),Vc.skX=Vy.getFloat32(),Vc.skY=Vy.getFloat32(),Vc.scY=Vy.getFloat32(),Vc.x=Vy.getFloat32(),Vc.y=Vy.getFloat32(),8===this.tMatrixDataLen&&(Vc.skewX=Vy.getFloat32(),Vc.skewY=Vy.getFloat32()),Vv.push(Vc),(VW=this.mBoneArr[Vn]).transform=Vc;var Vl,Vj=Vy.getUint16(),Vh=0;for(Vn=0;Vn<Vj;Vn++){for(VH=new VFn,Vh=Vy.getUint16(),Va=0;Va<Vh;Va++)VH.boneNames.push(Vy.readUTFString()),VH.boneIndexs.push(Vy.getInt16());VH.name=Vy.readUTFString(),VH.targetBoneName=Vy.readUTFString(),VH.targetBoneIndex=Vy.getInt16(),VH.bendDirection=Vy.getFloat32(),VH.mix=Vy.getFloat32(),VH.isSpine=Vp,this.ikArr.push(VH)}var Vf,VF=Vy.getUint16(),Vg=0;for(Vn=0;Vn<VF;Vn++){for(Vl=new VLn,Vg=Vy.getUint16(),Va=0;Va<Vg;Va++)Vl.boneIndexs.push(Vy.getInt16());Vl.name=Vy.getUTFString(),Vl.targetIndex=Vy.getInt16(),Vl.rotateMix=Vy.getFloat32(),Vl.translateMix=Vy.getFloat32(),Vl.scaleMix=Vy.getFloat32(),Vl.shearMix=Vy.getFloat32(),Vl.offsetRotation=Vy.getFloat32(),Vl.offsetX=Vy.getFloat32(),Vl.offsetY=Vy.getFloat32(),Vl.offsetScaleX=Vy.getFloat32(),Vl.offsetScaleY=Vy.getFloat32(),Vl.offsetShearY=Vy.getFloat32(),this.tfArr.push(Vl)}var Vo=Vy.getUint16(),VB=0;for(Vn=0;Vn<Vo;Vn++){for((Vf=new Vgn).name=Vy.readUTFString(),VB=Vy.getUint16(),Va=0;Va<VB;Va++)Vf.bones.push(Vy.getInt16());Vf.target=Vy.readUTFString(),Vf.positionMode=Vy.readUTFString(),Vf.spacingMode=Vy.readUTFString(),Vf.rotateMode=Vy.readUTFString(),Vf.offsetRotation=Vy.getFloat32(),Vf.position=Vy.getFloat32(),Vf.spacing=Vy.getFloat32(),Vf.rotateMix=Vy.getFloat32(),Vf.translateMix=Vy.getFloat32(),this.pathArr.push(Vf)}var VO,VL,Vd,VS,Vw,Vs=0,VC=0,Vt=0,Vr=NaN,VJ=0,Ve=Vy.getInt16();for(Vn=0;Vn<Ve;Vn++){var Vnn=Vy.getUint8(),Van={};this.deformAniArr.push(Van);for(var VUn=0;VUn<Vnn;VUn++)for((VO=new Vvn).skinName=Vy.getUTFString(),Van[VO.skinName]=VO,Vs=Vy.getInt16(),Va=0;Va<Vs;Va++)for(VL=new Vln,VO.deformSlotDataList.push(VL),VC=Vy.getInt16(),VU=0;VU<VC;VU++)for(Vd=new Vjn,VL.deformSlotDisplayList.push(Vd),Vd.slotIndex=Vy.getInt16(),Vd.attachment=Vy.getUTFString(),Vt=Vy.getInt16(),Vx=0;Vx<Vt;Vx++)for(1==Vy.getByte()?Vd.tweenKeyList.push(!0):Vd.tweenKeyList.push(!1),Vr=Vy.getFloat32(),Vd.timeList.push(Vr),VS=[],Vd.vectices.push(VS),VJ=Vy.getInt16(),VD=0;VD<VJ;VD++)VS.push(Vy.getFloat32())}var Vxn,VDn,Vpn=Vy.getInt16(),VQn=0,VVn=0;for(Vn=0;Vn<Vpn;Vn++){for(VQn=Vy.getInt16(),Vw=[],Va=0;Va<VQn;Va++){for((Vxn=new Vhn).time=Vy.getFloat32(),VVn=Vy.getInt16(),VU=0;VU<VVn;VU++)Vxn.drawOrder.push(Vy.getInt16());Vw.push(Vxn)}this.drawOrderAniArr.push(Vw)}var Vyn,VRn=Vy.getInt16(),VXn=0;for(Vn=0;Vn<VRn;Vn++){for(VXn=Vy.getInt16(),VDn=[],Va=0;Va<VXn;Va++)(Vyn=new Vfn).name=Vy.getUTFString(),Vyn.intValue=Vy.getInt32(),Vyn.floatValue=Vy.getFloat32(),Vyn.stringValue=Vy.getUTFString(),Vyn.time=Vy.getFloat32(),VDn.push(Vyn);this.eventAniArr.push(VDn)}var Vzn=Vy.getInt16();if(0<Vzn)for(this.attachmentNames=[],Vn=0;Vn<Vzn;Vn++)this.attachmentNames.push(Vy.getUTFString());var Vin,Vqn,VEn=Vy.getInt16();for(Vn=0;Vn<VEn;Vn++)(Vin=new VIn).name=Vy.readUTFString(),Vin.parent=Vy.readUTFString(),Vin.attachmentName=Vy.readUTFString(),Vin.srcDisplayIndex=Vin.displayIndex=Vy.getInt16(),(Vin.templet=this).boneSlotDic[Vin.name]=Vin,null==(Vqn=this.bindBoneBoneSlotDic[Vin.parent])&&(this.bindBoneBoneSlotDic[Vin.parent]=Vqn=[]),Vqn.push(Vin),this.boneSlotArray.push(Vin);var Vmn,Vbn,VPn,VAn=Vy.readUTFString().split("\n"),VTn=0,VKn=Vy.getUint8(),VYn=0,VWn=0,Vkn=0,VNn=0,V_n=0,V$n=0,VMn=0;for(Vn=0;Vn<VKn;Vn++){for((Vmn=new Von).name=VAn[VTn++],VYn=Vy.getUint8(),Va=0;Va<VYn;Va++){for((Vbn=new VOn).name=VAn[VTn++],Vin=this.boneSlotDic[Vbn.name],VWn=Vy.getUint8(),VU=0;VU<VWn;VU++){if(VPn=new VBn,this.skinSlotDisplayDataArr.push(VPn),VPn.name=VAn[VTn++],VPn.attachmentName=VAn[VTn++],VPn.transform=new Vdn,VPn.transform.scX=Vy.getFloat32(),VPn.transform.skX=Vy.getFloat32(),VPn.transform.skY=Vy.getFloat32(),VPn.transform.scY=Vy.getFloat32(),VPn.transform.x=Vy.getFloat32(),VPn.transform.y=Vy.getFloat32(),Vbn.displayArr.push(VPn),VPn.width=Vy.getFloat32(),VPn.height=Vy.getFloat32(),VPn.type=Vy.getUint8(),VPn.verLen=Vy.getUint16(),0<(VZ=Vy.getUint16()))for(VPn.bones=[],Vx=0;Vx<VZ;Vx++){var VZn=Vy.getUint16();VPn.bones.push(VZn)}if(0<(Vkn=Vy.getUint16()))for(VPn.uvs=[],Vx=0;Vx<Vkn;Vx++)VPn.uvs.push(Vy.getFloat32());if(0<(VNn=Vy.getUint16()))for(VPn.weights=[],Vx=0;Vx<VNn;Vx++)VPn.weights.push(Vy.getFloat32());if(0<(V_n=Vy.getUint16()))for(VPn.triangles=[],Vx=0;Vx<V_n;Vx++)VPn.triangles.push(Vy.getUint16());if(0<(V$n=Vy.getUint16()))for(VPn.vertices=[],Vx=0;Vx<V$n;Vx++)VPn.vertices.push(Vy.getFloat32());if(0<(VMn=Vy.getUint16()))for(VPn.lengths=[],Vx=0;Vx<VMn;Vx++)VPn.lengths.push(Vy.getFloat32())}Vmn.slotArr.push(Vbn)}this.skinDic[Vmn.name]=Vmn,this.skinDataArray.push(Vmn)}1==Vy.getUint8()?(this.yReverseMatrix=new Vcn(1,0,0,-1,0,0),VM&&VM.setTempMatrix(this.yReverseMatrix)):VM&&VM.setTempMatrix(new Vcn),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},Vn.getTexture=function(Vn){var Va=this.subTextureDic[Vn];return Va||(Va=this.subTextureDic[Vn.substr(0,Vn.length-1)]),null==Va?this._mainTexture:Va},Vn.showSkinByIndex=function(Vn,Va,VU){if(void 0===VU&&(VU=!0),Va<0&&Va>=this.skinDataArray.length)return!1;var Vx,VD,Vp=0,VQ=0,VV=this.skinDataArray[Va];if(VV){for(Vp=0,VQ=VV.slotArr.length;Vp<VQ;Vp++)(VD=VV.slotArr[Vp])&&(Vx=Vn[VD.name])&&(Vx.showSlotData(VD,VU),VU&&"undefined"!=Vx.attachmentName&&"null"!=Vx.attachmentName?Vx.showDisplayByName(Vx.attachmentName):Vx.showDisplayByIndex(Vx.displayIndex));return!0}return!1},Vn.getSkinIndexByName=function(Vn){for(var Va=0,VU=this.skinDataArray.length;Va<VU;Va++)if(this.skinDataArray[Va].name==Vn)return Va;return-1},Vn.getGrahicsDataWithCache=function(Vn,Va){return this._graphicsCache[Vn][Va]},Vn.setGrahicsDataWithCache=function(Vn,Va,VU){this._graphicsCache[Vn][Va]=VU},Vn.destroy=function(){var Vn;for(var Va in this._isDestroyed=!0,this.subTextureDic)(Vn=this.subTextureDic[Va])&&Vn.destroy();for(Va in this._textureDic)(Vn=this._textureDic[Va])&&Vn.destroy();for(var VU=0,Vx=this.skinSlotDisplayDataArr.length;VU<Vx;VU++)this.skinSlotDisplayDataArr[VU].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete VD.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},Vn.getAniNameByIndex=function(Vn){var Va=this.getAnimation(Vn);return Va?Va.name:null},Vp(0,Vn,"rate",function(){return this._rate},function(Vn){this._rate=Vn}),VD.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",VD.TEMPLET_DICTIONARY=null,VD}(Vv)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Vn,Va){"use strict";for(var VU in Object.defineProperty(Va,"__esModule",{value:!0}),Laya){var Vx=Laya[VU];Vx&&Vx.__isclass&&(Va[VU]=Vx)}});