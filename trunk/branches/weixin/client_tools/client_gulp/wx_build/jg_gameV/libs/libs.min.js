var Laya=window.Laya=function(u$c,u$W){var u$R={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(u$W,u$j){return 1==arguments.length?u$R.__presubstr.call(this,u$W):u$R.__presubstr.call(this,u$W,0<u$j?u$j:this.length+u$j)},__init:function(u$W){u$W.forEach(function(u$W){u$W.__init$&&u$W.__init$()})},__isClass:function(u$W){return u$W&&(u$W.__isclass||u$W==Object||u$W==String||u$W==Array)},__newvec:function(u$W,u$j){var u$t=[];u$t.length=u$W;for(var u$d=0;u$d<u$W;u$d++)u$t[u$d]=u$j;return u$t},__extend:function(u$W,u$j){for(var u$t in u$j)if(u$j.hasOwnProperty(u$t)){var u$d=Object.getOwnPropertyDescriptor(u$j,u$t),u$b=u$d.get,u$E=u$d.set;u$b||u$E?u$b&&u$E?Object.defineProperty(u$W,u$t,u$d):(u$b&&Object.defineProperty(u$W,u$t,u$b),u$E&&Object.defineProperty(u$W,u$t,u$E)):u$W[u$t]=u$j[u$t]}function u$O(){u$R.un(this,"constructor",u$W)}u$O.prototype=u$j.prototype,u$W.prototype=new u$O,u$R.un(u$W.prototype,"__imps",u$R.__copy({},u$j.prototype.__imps))},__copy:function(u$W,u$j){if(!u$j)return null;for(var u$t in u$W=u$W||{},u$j)u$W[u$t]=u$j[u$t];return u$W},__package:function(u$W,u$j){if(!u$R.__packages[u$W]){u$R.__packages[u$W]=!0;var u$t=u$c,u$d=u$W.split(".");if(1<u$d.length)for(var u$b=0,u$E=u$d.length-1;u$b<u$E;u$b++){var u$O=u$t[u$d[u$b]];u$t=u$O||(u$t[u$d[u$b]]={})}u$t[u$d[u$d.length-1]]||(u$t[u$d[u$d.length-1]]=u$j||{})}},__hasOwnProperty:function(u$W,u$j){return u$j=u$j||this,Object.hasOwnProperty.call(u$j,u$W)||function u$W(u$j,u$t){if(Object.hasOwnProperty.call(u$t.prototype,u$j))return!0;var u$d=u$t.prototype.__super;return null==u$d?null:u$W(u$j,u$d)}(u$W,u$j.__class)},__typeof:function(u$W,u$j){if(!u$W||!u$j)return!1;if(u$j===String)return"string"==typeof u$W;if(u$j===Number)return"number"==typeof u$W;if(u$j.__interface__)u$j=u$j.__interface__;else if("string"!=typeof u$j)return u$W instanceof u$j;return u$W.__imps&&u$W.__imps[u$j]||u$W.__class==u$j},__as:function(u$W,u$j){return this.__typeof(u$W,u$j)?u$W:null},__int:function(u$W){return u$W?parseInt(u$W):0},interface:function(u$W,u$j){u$R.__package(u$W,{});var u$t=u$R.__internals,u$d=u$t[u$W]=u$t[u$W]||{self:u$W};if(u$j){var u$b=u$j.split(",");u$d.extend=[];for(var u$E=0;u$E<u$b.length;u$E++){var u$O=u$b[u$E];u$t[u$O]=u$t[u$O]||{self:u$O},u$d.extend.push(u$t[u$O])}}var u$q=u$c,u$A=u$W.split(".");for(u$E=0;u$E<u$A.length-1;u$E++)u$q=u$q[u$A[u$E]];u$q[u$A[u$A.length-1]]={__interface__:u$W}},class:function(u$W,u$j,u$t,u$d){if(u$t&&u$R.__extend(u$W,u$t),u$j)if(u$R.__package(u$j,u$W),u$R.__classmap[u$j]=u$W,0<u$j.indexOf(".")){if(0==u$j.indexOf("laya.")){var u$b=u$j.split(".");u$d=u$d||u$b[u$b.length-1],u$R[u$d]&&console.log("Warning!,this class["+u$d+"] already exist:",u$R[u$d]),u$R[u$d]=u$W}}else"Main"==u$j?u$c.Main=u$W:"MainWX"==u$j?u$c.MainWX=u$W:(u$R[u$j]&&console.log("Error!,this class["+u$j+"] already exist:",u$R[u$j]),u$R[u$j]=u$W);var u$E=u$R.un,u$O=u$W.prototype;u$E(u$O,"hasOwnProperty",u$R.__hasOwnProperty),u$E(u$O,"__class",u$W),u$E(u$O,"__super",u$t),u$E(u$O,"__className",u$j),u$E(u$W,"__super",u$t),u$E(u$W,"__className",u$j),u$E(u$W,"__isclass",!0),u$E(u$W,"super",function(u$W){this.__super.call(u$W)})},imps:function(u$W,u$j){if(!u$j)return null;var u$b=u$W.__imps||u$R.un(u$W,"__imps",{});function u$E(u$W){var u$j,u$t;if((u$j=u$R.__internals[u$W])&&(u$b[u$W]=!0,u$t=u$j.extend))for(var u$d=0;u$d<u$t.length;u$d++)u$E(u$t[u$d].self)}for(var u$t in u$j)u$E(u$t)},superSet:function(u$W,u$j,u$t,u$d){var u$b=u$W.prototype["_$set_"+u$t];u$b&&u$b.call(u$j,u$d)},superGet:function(u$W,u$j,u$t){var u$d=u$W.prototype["_$get_"+u$t];return u$d?u$d.call(u$j):null},getset:function(u$W,u$j,u$t,u$d,u$b){u$W?(u$d&&(u$j["_$GET_"+u$t]=u$d),u$b&&(u$j["_$SET_"+u$t]=u$b)):(u$d&&u$R.un(u$j,"_$get_"+u$t,u$d),u$b&&u$R.un(u$j,"_$set_"+u$t,u$b)),u$d&&u$b?Object.defineProperty(u$j,u$t,{get:u$d,set:u$b,enumerable:!1,configurable:!0}):(u$d&&Object.defineProperty(u$j,u$t,{get:u$d,enumerable:!1,configurable:!0}),u$b&&Object.defineProperty(u$j,u$t,{set:u$b,enumerable:!1,configurable:!0}))},static:function(u$t,u$d){for(var u$b=0,u$W=u$d.length;u$b<u$W;u$b+=2)if("length"==u$d[u$b])u$t.length=u$d[u$b+1].call(u$t);else{function u$j(){var u$j=u$d[u$b],u$W=u$d[u$b+1];Object.defineProperty(u$t,u$j,{get:function(){return delete this[u$j],this[u$j]=u$W.call(this)},set:function(u$W){delete this[u$j],this[u$j]=u$W},enumerable:!0,configurable:!0})}u$j()}},un:function(u$W,u$j,u$t){return u$t||(u$t=u$W[u$j]),u$R.__propun.value=u$t,Object.defineProperty(u$W,u$j,u$R.__propun),u$t},uns:function(u$j,u$W){u$W.forEach(function(u$W){u$R.un(u$j,u$W)})}};return u$c.console=u$c.console||{log:function(){}},u$c.trace=u$c.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),u$R}(window,document);!function(u$W,u$j,u$t){u$t.un,u$t.uns,u$t.static,u$t.class,u$t.getset,u$t.__newvec}(window,document,Laya),function(u$O,u$j,u$N){u$N.un,u$N.uns;var u$A=u$N.static,u$R=u$N.class,u$$=u$N.getset;u$N.__newvec;u$N.interface("laya.runtime.IMarket"),u$N.interface("laya.filters.IFilter"),u$N.interface("laya.display.ILayout"),u$N.interface("laya.resource.IDispose"),u$N.interface("laya.runtime.IPlatform"),u$N.interface("laya.resource.IDestroy"),u$N.interface("laya.runtime.IConchNode"),u$N.interface("laya.filters.IFilterAction"),u$N.interface("laya.runtime.ICPlatformClass"),u$N.interface("laya.resource.ICreateResource"),u$N.interface("laya.runtime.IConchRenderObject"),u$N.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var u$G=function(){function u$E(){}return u$R(u$E,"laya.utils.RunDriver"),u$E.FILTER_ACTIONS=[],u$E.pixelRatio=-1,u$E._charSizeTestDiv=null,u$E.now=function(){return Date.now()},u$E.getWindow=function(){return u$O},u$E.getPixelRatio=function(){if(u$E.pixelRatio<0){var u$W=u$Y.context,u$j=u$W.backingStorePixelRatio||u$W.webkitBackingStorePixelRatio||u$W.mozBackingStorePixelRatio||u$W.msBackingStorePixelRatio||u$W.oBackingStorePixelRatio||u$W.backingStorePixelRatio||1;(u$E.pixelRatio=(u$Y.window.devicePixelRatio||1)/u$j)<1&&(u$E.pixelRatio=1)}return u$E.pixelRatio},u$E.getIncludeStr=function(u$W){return null},u$E.createShaderCondition=function(u$W){var u$j="(function() {return "+u$W+";})";return u$N._runScript(u$j)},u$E.fontMap=[],u$E.measureText=function(u$W,u$j){var u$t=u$E.hanzi.test(u$W);if(u$t&&u$E.fontMap[u$j])return u$E.fontMap[u$j];var u$d=u$Y.context;u$d.font=u$j;var u$b=u$d.measureText(u$W);return u$t&&(u$E.fontMap[u$j]=u$b),u$b},u$E.getWebGLContext=function(u$W){},u$E.beginFlush=function(){},u$E.endFinish=function(){},u$E.addToAtlas=null,u$E.flashFlushImage=function(u$W){},u$E.drawToCanvas=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=u$MW.create("2D"),u$q=new u$a(u$t,u$d,u$O);return u$u.renders[u$j]._fun(u$W,u$q,u$b,u$E),u$O},u$E.createParticleTemplate2D=null,u$E.createGLTextur=null,u$E.createWebGLContext2D=null,u$E.changeWebGLSize=function(u$W,u$j){},u$E.createRenderSprite=function(u$W,u$j){return new u$u(u$W,u$j)},u$E.createFilterAction=function(u$W){return new u$M},u$E.createGraphics=function(){return new u$Q},u$E.clear=function(u$W){u$y._context.ctx.clear()},u$E.cancelLoadByUrl=function(u$W){},u$E.clearAtlas=function(u$W){},u$E.isAtlas=function(u$W){return!1},u$E.addTextureToAtlas=function(u$W){},u$E.getTexturePixels=function(u$W,u$j,u$t,u$d,u$b){return null},u$E.skinAniSprite=function(){return null},u$E.update3DLoop=function(){},u$A(u$E,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),u$E}(),u$d=(u$$(1,u$N,"alertGlobalError",null,function(u$W){var u$E=0;u$Y.window.onerror=u$W?function(u$W,u$j,u$t,u$d,u$b){u$E++<5&&u$b&&alert(u$b.stack||u$b)}:null}),u$N.init=function(u$W,u$j,u$t){for(var u$d=[],u$b=2,u$E=arguments.length;u$b<u$E;u$b++)u$d.push(arguments[u$b]);if(!u$N._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=u$N._arrayBufferSlice),u$N._isinit=!0,u$Y.__init__(),u$D.__init__(),u$Q.__init__(),u$N.timer=new u$i,u$N.scaleTimer=new u$i,u$N.loader=new u$AW,u$p.__init__(),u$b=0;for(var u$O=u$d.length;u$b<u$O;u$b++)u$d[u$b].enable&&u$d[u$b].enable();return u$T.__init__(),u$q.__init__(),u$s.__init__(),u$I.beginCheck(),u$N._currentStage=u$N.stage=new u$oW,u$N.stage.conchModel&&u$N.stage.conchModel.setRootNode(),u$N._getUrlPath(),u$N.render=new u$y(0,0),u$N.stage.size(u$W,u$j),u$u.__init__(),u$m.__init__(),u$e.instance.__init__(u$N.stage,u$y.canvas),u$XW.__init__(),u$x.autoStopMusic=!0,u$L.__init__(),u$y.canvas}},u$N._getUrlPath=function(){var u$W=u$Y.window.location,u$j=u$W.pathname;u$j=u$j&&":"==u$j.charAt(2)?u$j.substring(1):u$j,u$v.rootPath=u$v.basePath=u$v.getPath("file:"==u$W.protocol?u$j:u$W.protocol+"//"+u$W.host+u$W.pathname)},u$N._arrayBufferSlice=function(u$W,u$j){var u$t=new Uint8Array(this,u$W,u$j-u$W),u$d=new Uint8Array(u$t.length);return u$d.set(u$t),u$d.buffer},u$N._runScript=function(u$W){return u$Y.window[u$N._evcode](u$W)},u$N.stage=null,u$N.timer=null,u$N.scaleTimer=null,u$N.loader=null,u$N.version="1.8.6",u$N.render=null,u$N._currentStage=null,u$N._isinit=!1,u$N.isDebug=!1,u$N.MiniAdpter={init:function(){u$O.navigator&&u$O.navigator.userAgent&&-1<u$O.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},u$A(u$N,["conchMarket",function(){return this.conchMarket=u$O.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=u$O.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function u$W(){}return u$R(u$W,"Config"),u$W.WebGLTextCacheCount=500,u$W.atlasEnable=!1,u$W.showCanvasMark=!1,u$W.animationInterval=50,u$W.isAntialias=!1,u$W.isAlpha=!1,u$W.premultipliedAlpha=!0,u$W.isStencil=!0,u$W.preserveDrawingBuffer=!1,u$W}()),u$c=function(){function u$c(){this._events=null}u$R(u$c,"laya.events.EventDispatcher");var u$W=u$c.prototype;return u$W.hasListener=function(u$W){return!!(this._events&&this._events[u$W])},u$W.event=function(u$W,u$j){if(!this._events||!this._events[u$W])return!1;var u$t=this._events[u$W];if(u$t.lock)u$t.queue||(u$t.queue=[]),u$t.queue.push(u$j);else{var u$d;for(u$t.lock=!0,u$t.cursor=u$t.head;u$t.cursor;)u$d=u$t.cursor,u$t.cursor=u$d.next,u$d.once&&u$c.delNode(u$t,u$d),null!=u$j?u$d.args?u$d.method.apply(u$d.caller,u$d.args.concat(u$j)):u$j instanceof Array?u$d.method.apply(u$d.caller,u$j):u$d.method.call(u$d.caller,u$j):u$d.method.apply(u$d.caller,u$d.args),u$d.once&&u$c.recoverHandler(u$d);u$t.lock=!1,!u$t.head&&this._events&&this._events[u$W]==u$t&&delete this._events[u$W],u$t.queue&&u$t.queue.length&&this.event(u$W,u$t.queue.shift())}return!0},u$W.on=function(u$W,u$j,u$t,u$d){return this._createListener(u$W,u$j,u$t,u$d,!1)},u$W.once=function(u$W,u$j,u$t,u$d){return this._createListener(u$W,u$j,u$t,u$d,!0)},u$W._createListener=function(u$W,u$j,u$t,u$d,u$b,u$E){void 0===u$E&&(u$E=!0),u$E&&this.off(u$W,u$j,u$t,u$b);var u$O=u$c.createHandler(u$j||this,u$t,u$d,u$b);this._events||(this._events={});var u$q=this._events,u$A=u$q[u$W];return u$A?u$A.tail?(u$O.prev=u$A.tail,u$A.tail.next=u$O,u$A.tail=u$O):u$A.head=u$A.tail=u$O:u$q[u$W]={head:u$O,tail:u$O,cursor:null,lock:!1},this},u$W.off=function(u$W,u$j,u$t,u$d){if(void 0===u$d&&(u$d=!1),!this._events||!this._events[u$W])return this;for(var u$b=this._events[u$W],u$E=u$b.head;u$E;){if((!u$j||u$E.caller===u$j)&&u$E.method===u$t&&(!u$d||u$E.once)){u$c.delNode(u$b,u$E),u$b.cursor==u$E&&(u$b.cursor=u$E.next),u$c.recoverHandler(u$E);break}u$E=u$E.next}return this},u$W.offAll=function(u$W){var u$j=this._events;if(!u$j)return this;if(u$W)this._recoverHandlers(u$j[u$W]),delete u$j[u$W];else{for(var u$t in u$j)this._recoverHandlers(u$j[u$t]);this._events=null}return this},u$W._recoverHandlers=function(u$W){if(u$W){for(var u$j=u$W.head;u$j;){u$c.delNode(u$W,u$j);var u$t=u$j.next;u$c.recoverHandler(u$j),u$j=u$t}u$W.cursor=null}},u$W.isMouseEvent=function(u$W){return u$c.MOUSE_EVENTS[u$W]},u$c.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},u$c.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},u$c.delNode=function(u$W,u$j){u$j.prev?u$j.prev.next=u$j.next:u$W.head=u$j.next,u$j.next?u$j.next.prev=u$j.prev:u$W.tail=u$j.prev},u$c.createHandler=function(u$W,u$j,u$t,u$d){var u$b=u$c._freeHandler;return u$b?(u$c._freeCount--,u$c._freeHandler=u$b.next,u$b.caller=u$W,u$b.method=u$j,u$b.args=u$t,u$b.once=u$d):u$b={caller:u$W,method:u$j,args:u$t,once:u$d},u$b.prev=u$b.next=null,u$b},u$c.recoverHandler=function(u$W){u$W.caller=u$W.method=u$W.args=u$W.prev=null,u$W.next=u$c._freeHandler,u$c._freeHandler=u$W,u$c._freeCount++},u$c._freeHandler=null,u$c._freeCount=0,u$c}(),u$S=function(){function u$b(u$W,u$j,u$t,u$d){this.once=!1,void(this._id=0)===u$d&&(u$d=!1),this.setTo(u$W,u$j,u$t,u$d)}u$R(u$b,"laya.utils.Handler");var u$W=u$b.prototype;return u$W.setTo=function(u$W,u$j,u$t,u$d){return this._id=u$b._gid++,this.caller=u$W,this.method=u$j,this.args=u$t,this.once=u$d,this},u$W.run=function(){if(null==this.method)return null;var u$W=this._id,u$j=this.method.apply(this.caller,this.args);return this._id===u$W&&this.once&&this.recover(),u$j},u$W.runWith=function(u$W){if(null==this.method)return null;var u$j=this._id;if(null==u$W)var u$t=this.method.apply(this.caller,this.args);else u$t=this.args||u$W.unshift?this.args?this.method.apply(this.caller,this.args.concat(u$W)):this.method.apply(this.caller,u$W):this.method.call(this.caller,u$W);return this._id===u$j&&this.once&&this.recover(),u$t},u$W.clear=function(){return this.caller=null,this.method=null,this.args=null,this},u$W.recover=function(){0<this._id&&(this._id=0,this.clear())},u$b.create=function(u$W,u$j,u$t,u$d){return void 0===u$d&&(u$d=!0),new u$b(u$W,u$j,u$t,u$d)},u$b._gid=1,u$b}(),u$V=function(){function u$W(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}u$R(u$W,"laya.display.BitmapFont");var u$j=u$W.prototype;return u$j.loadFont=function(u$W,u$j){this._path=u$W,this._complete=u$j,u$N.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],u$S.create(this,this.onLoaded))},u$j.onLoaded=function(){this.parseFont(u$qW.getRes(this._path),u$qW.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},u$j.parseFont=function(u$W,u$j){if(null!=u$W&&null!=u$j){this._texture=u$j;var u$t=u$W.getElementsByTagName("info");if(!u$t[0].getAttributeNode)return this.parseFont2(u$W,u$j);this.fontSize=parseInt(u$t[0].getAttributeNode("size").nodeValue);var u$d,u$b=u$t[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(u$b[0]),parseInt(u$b[1]),parseInt(u$b[2]),parseInt(u$b[3])],u$d=u$W.getElementsByTagName("char");var u$E=0;for(u$E=0;u$E<u$d.length;u$E++){var u$O=u$d[u$E],u$q=parseInt(u$O.getAttributeNode("id").nodeValue),u$A=parseInt(u$O.getAttributeNode("xoffset").nodeValue)/1,u$c=parseInt(u$O.getAttributeNode("yoffset").nodeValue)/1,u$R=parseInt(u$O.getAttributeNode("xadvance").nodeValue)/1,u$m=new u$C;u$m.x=parseInt(u$O.getAttributeNode("x").nodeValue),u$m.y=parseInt(u$O.getAttributeNode("y").nodeValue),u$m.width=parseInt(u$O.getAttributeNode("width").nodeValue),u$m.height=parseInt(u$O.getAttributeNode("height").nodeValue);var u$Q=u$RW.create(u$j,u$m.x,u$m.y,u$m.width,u$m.height,u$A,u$c);this._maxWidth=Math.max(this._maxWidth,u$R+this.letterSpacing),this._fontCharDic[u$q]=u$Q,this._fontWidthMap[u$q]=u$R}}},u$j.parseFont2=function(u$W,u$j){if(null!=u$W&&null!=u$j){this._texture=u$j;var u$t=u$W.getElementsByTagName("info");this.fontSize=parseInt(u$t[0].attributes.size.nodeValue);var u$d=u$t[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(u$d[0]),parseInt(u$d[1]),parseInt(u$d[2]),parseInt(u$d[3])];var u$b=u$W.getElementsByTagName("char"),u$E=0;for(u$E=0;u$E<u$b.length;u$E++){var u$O=u$b[u$E].attributes,u$q=parseInt(u$O.id.nodeValue),u$A=parseInt(u$O.xoffset.nodeValue)/1,u$c=parseInt(u$O.yoffset.nodeValue)/1,u$R=parseInt(u$O.xadvance.nodeValue)/1,u$m=new u$C;u$m.x=parseInt(u$O.x.nodeValue),u$m.y=parseInt(u$O.y.nodeValue),u$m.width=parseInt(u$O.width.nodeValue),u$m.height=parseInt(u$O.height.nodeValue);var u$Q=u$RW.create(u$j,u$m.x,u$m.y,u$m.width,u$m.height,u$A,u$c);this._maxWidth=Math.max(this._maxWidth,u$R+this.letterSpacing),this._fontCharDic[u$q]=u$Q,this._fontWidthMap[u$q]=u$R}}},u$j.getCharTexture=function(u$W){return this._fontCharDic[u$W.charCodeAt(0)]},u$j.destroy=function(){if(this._texture){for(var u$W in this._fontCharDic){var u$j=this._fontCharDic[u$W];u$j&&u$j.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},u$j.setSpaceWidth=function(u$W){this._spaceWidth=u$W},u$j.getCharWidth=function(u$W){var u$j=u$W.charCodeAt(0);return this._fontWidthMap[u$j]?this._fontWidthMap[u$j]+this.letterSpacing:" "==u$W?this._spaceWidth+this.letterSpacing:0},u$j.getTextWidth=function(u$W){for(var u$j=0,u$t=0,u$d=u$W.length;u$t<u$d;u$t++)u$j+=this.getCharWidth(u$W.charAt(u$t));return u$j},u$j.getMaxWidth=function(){return this._maxWidth},u$j.getMaxHeight=function(){return this.fontSize},u$j.drawText=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O,u$q=this.getTextWidth(u$W),u$A=0;"center"===u$b&&(u$A=(u$E-u$q)/2),"right"===u$b&&(u$A=u$E-u$q);for(var u$c=0,u$R=0,u$m=u$W.length;u$R<u$m;u$R++)(u$O=this.getCharTexture(u$W.charAt(u$R)))&&(u$j.graphics.drawTexture(u$O,u$t+u$c+u$A,u$d),u$c+=this.getCharWidth(u$W.charAt(u$R)))},u$W}(),u$q=function(){function u$t(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=u$t._TF_EMPTY}u$R(u$t,"laya.display.css.Style");var u$W=u$t.prototype;return u$W.getTransform=function(){return this._tf},u$W.setTransform=function(u$W){this._tf="none"!==u$W&&u$W?u$W:u$t._TF_EMPTY},u$W.setTranslateX=function(u$W){this._tf===u$t._TF_EMPTY&&(this._tf=new u$b),this._tf.translateX=u$W},u$W.setTranslateY=function(u$W){this._tf===u$t._TF_EMPTY&&(this._tf=new u$b),this._tf.translateY=u$W},u$W.setScaleX=function(u$W){this._tf===u$t._TF_EMPTY&&(this._tf=new u$b),this._tf.scaleX=u$W},u$W.setScale=function(u$W,u$j){this._tf===u$t._TF_EMPTY&&(this._tf=new u$b),this._tf.scaleX=u$W,this._tf.scaleY=u$j},u$W.setScaleY=function(u$W){this._tf===u$t._TF_EMPTY&&(this._tf=new u$b),this._tf.scaleY=u$W},u$W.setRotate=function(u$W){this._tf===u$t._TF_EMPTY&&(this._tf=new u$b),this._tf.rotate=u$W},u$W.setSkewX=function(u$W){this._tf===u$t._TF_EMPTY&&(this._tf=new u$b),this._tf.skewX=u$W},u$W.setSkewY=function(u$W){this._tf===u$t._TF_EMPTY&&(this._tf=new u$b),this._tf.skewY=u$W},u$W.destroy=function(){this.scrollRect=null},u$W.render=function(u$W,u$j,u$t,u$d){},u$W.getCSSStyle=function(){return u$jW.EMPTY},u$W._enableLayout=function(){return!1},u$$(0,u$W,"scaleX",function(){return this._tf.scaleX},function(u$W){this.setScaleX(u$W)}),u$$(0,u$W,"transform",function(){return this.getTransform()},function(u$W){this.setTransform(u$W)}),u$$(0,u$W,"translateX",function(){return this._tf.translateX},function(u$W){this.setTranslateX(u$W)}),u$$(0,u$W,"translateY",function(){return this._tf.translateY},function(u$W){this.setTranslateY(u$W)}),u$$(0,u$W,"scaleY",function(){return this._tf.scaleY},function(u$W){this.setScaleY(u$W)}),u$$(0,u$W,"block",function(){return 0!=(1&this._type)}),u$$(0,u$W,"skewY",function(){return this._tf.skewY},function(u$W){this.setSkewY(u$W)}),u$$(0,u$W,"rotate",function(){return this._tf.rotate},function(u$W){this.setRotate(u$W)}),u$$(0,u$W,"skewX",function(){return this._tf.skewX},function(u$W){this.setSkewX(u$W)}),u$$(0,u$W,"paddingLeft",function(){return 0}),u$$(0,u$W,"paddingTop",function(){return 0}),u$$(0,u$W,"absolute",function(){return!0}),u$t.__init__=function(){u$t._TF_EMPTY=new u$b,u$t.EMPTY=new u$t},u$t.EMPTY=null,u$t._TF_EMPTY=null,u$t}(),u$T=function(){function u$j(u$W){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=u$f.create(u$j.defaultColor),this.family=u$j.defaultFamily,this.stroke=u$j._STROKE,this.size=u$j.defaultSize,u$W&&u$W!==u$j.EMPTY&&u$W.copyTo(this)}u$R(u$j,"laya.display.css.Font");var u$W=u$j.prototype;return u$W.set=function(u$W){this._text=null;for(var u$j=u$W.split(" "),u$t=0,u$d=u$j.length;u$t<u$d;u$t++){var u$b=u$j[u$t];switch(u$b){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<u$b.indexOf("px")&&(this.size=parseInt(u$b),this.family=u$j[u$t+1],u$t++)}},u$W.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},u$W.copyTo=function(u$W){u$W._type=this._type,u$W._text=this._text,u$W._weight=this._weight,u$W._color=this._color,u$W.family=this.family,u$W.stroke=this.stroke!=u$j._STROKE?this.stroke.slice():u$j._STROKE,u$W.indent=this.indent,u$W.size=this.size},u$$(0,u$W,"password",function(){return 0!=(1024&this._type)},function(u$W){u$W?this._type|=1024:this._type&=-1025}),u$$(0,u$W,"color",function(){return this._color.strColor},function(u$W){this._color=u$f.create(u$W)}),u$$(0,u$W,"italic",function(){return 0!=(512&this._type)},function(u$W){u$W?this._type|=512:this._type&=-513}),u$$(0,u$W,"bold",function(){return 0!=(2048&this._type)},function(u$W){u$W?this._type|=2048:this._type&=-2049}),u$$(0,u$W,"weight",function(){return""+this._weight},function(u$W){var u$j=0;switch(u$W){case"normal":break;case"bold":this.bold=!0,u$j=700;break;case"bolder":u$j=800;break;case"lighter":u$j=100;break;default:u$j=parseInt(u$W)}this._weight=u$j,this._text=null}),u$$(0,u$W,"decoration",function(){return this._decoration?this._decoration.value:null},function(u$W){var u$j=u$W.split(" ");switch(this._decoration||(this._decoration={}),u$j[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=u$j[0]}u$j[1]&&(this._decoration.color=u$f.create(u$j)),this._decoration.value=u$W}),u$j.__init__=function(){u$j.EMPTY=new u$j(null)},u$j.EMPTY=null,u$j.defaultColor="#000000",u$j.defaultSize=12,u$j.defaultFamily="Arial",u$j.defaultFont="12px Arial",u$j._STROKE=[0,"#000000"],u$j._ITALIC=512,u$j._PASSWORD=1024,u$j._BOLD=2048,u$j}(),u$b=function(){function u$W(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return u$R(u$W,"laya.display.css.TransformInfo"),u$W}(),u$Q=function(){function u$m(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,u$y.isConchNode){this._nativeObj=new u$O._conchGraphics,this.id=this._nativeObj.conchID}}u$R(u$m,"laya.display.Graphics");var u$W=u$m.prototype;return u$W.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},u$W.clear=function(u$W){void 0===u$W&&(u$W=!1);var u$j=0,u$t=0;if(u$W){var u$d=this._one;if(this._cmds){for(u$t=this._cmds.length,u$j=0;u$j<u$t;u$j++)!(u$d=this._cmds[u$j])||u$d.callee!==u$y._context._drawTexture&&u$d.callee!==u$y._context._drawTextureWithTransform||(u$d[0]=null,u$m._cache.push(u$d));this._cmds.length=0}else u$d&&(!u$d||u$d.callee!==u$y._context._drawTexture&&u$d.callee!==u$y._context._drawTextureWithTransform||(u$d[0]=null,u$m._cache.push(u$d)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(u$j=0,u$t=this._vectorgraphArray.length;u$j<u$t;u$j++)u$k.getInstance().deleteShape(this._vectorgraphArray[u$j]);this._vectorgraphArray.length=0}},u$W._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},u$W._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new u$t,this._graphicBounds._graphics=this)},u$W._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},u$W._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},u$W.getBounds=function(u$W){return void 0===u$W&&(u$W=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(u$W)},u$W.getBoundPoints=function(u$W){return void 0===u$W&&(u$W=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(u$W)},u$W._addCmd=function(u$W){this._cmds=this._cmds||[],u$W.callee=u$W.shift(),this._cmds.push(u$W)},u$W.setFilters=function(u$W){this._saveToCmd(u$y._context._setFilters,u$W)},u$W.drawTexture=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){if(void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=0),void 0===u$b&&(u$b=0),void 0===u$O&&(u$O=1),!u$W||u$O<.01)return null;u$d||(u$d=u$W.sourceWidth),u$b||(u$b=u$W.sourceHeight),u$O=u$O<0?0:1<u$O?1:u$O;var u$q,u$A=!u$y.isWebGL&&(u$Y.onFirefox||u$Y.onEdge||u$Y.onIE||u$Y.onSafari)?.5:0,u$c=u$d/u$W.sourceWidth,u$R=u$b/u$W.sourceHeight;return u$d=u$W.width*u$c,u$b=u$W.height*u$R,u$W.loaded&&(u$d<=0||u$b<=0)?null:(u$j+=u$W.offsetX*u$c,u$t+=u$W.offsetY*u$R,this._sp&&(this._sp._renderType|=512),u$j-=u$A,u$t-=u$A,u$d+=2*u$A,u$b+=2*u$A,u$m._cache.length?((u$q=u$m._cache.pop())[0]=u$W,u$q[1]=u$j,u$q[2]=u$t,u$q[3]=u$d,u$q[4]=u$b,u$q[5]=u$E,u$q[6]=u$O):u$q=[u$W,u$j,u$t,u$d,u$b,u$E,u$O],u$q.callee=u$E||1!=u$O?u$y._context._drawTextureWithTransform:u$y._context._drawTexture,null!=this._one||u$E||1!=u$O?this._saveToCmd(u$q.callee,u$q):(this._one=u$q,this._render=this._renderOneImg),u$W.loaded||u$W.once("loaded",this,this._textureLoaded,[u$W,u$q]),this._repaint(),u$q)},u$W.cleanByTexture=function(u$W,u$j,u$t,u$d,u$b){if(void 0===u$d&&(u$d=0),void 0===u$b&&(u$b=0),!u$W)return this.clear();if(this._one&&this._render===this._renderOneImg){u$d||(u$d=u$W.sourceWidth),u$b||(u$b=u$W.sourceHeight);var u$E=u$d/u$W.sourceWidth,u$O=u$b/u$W.sourceHeight;u$d=u$W.width*u$E,u$b=u$W.height*u$O,u$j+=u$W.offsetX*u$E,u$t+=u$W.offsetY*u$O,this._one[0]=u$W,this._one[1]=u$j,this._one[2]=u$t,this._one[3]=u$d,this._one[4]=u$b,this._repaint()}else this.clear(),u$W&&this.drawTexture(u$W,u$j,u$t,u$d,u$b)},u$W.drawTextures=function(u$W,u$j){u$W&&this._saveToCmd(u$y._context._drawTextures,[u$W,u$j])},u$W.fillTexture=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){if(void 0===u$d&&(u$d=0),void 0===u$b&&(u$b=0),void 0===u$E&&(u$E="repeat"),u$W){var u$q=[u$W,u$j,u$t,u$d,u$b,u$E,u$O||u$z.EMPTY,{}];u$W.loaded||u$W.once("loaded",this,this._textureLoaded,[u$W,u$q]),this._saveToCmd(u$y._context._fillTexture,u$q)}},u$W._textureLoaded=function(u$W,u$j){u$j[3]=u$j[3]||u$W.width,u$j[4]=u$j[4]||u$W.height,this._repaint()},u$W.fillCircle=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){u$t.bitmap.enableMerageInAtlas=!1;var u$q=new Float32Array(2*(u$O+1)),u$A=new Float32Array(2*(u$O+1)),u$c=new Uint16Array(3*u$O),u$R=2*Math.PI/u$O,u$m=0;u$q[0]=u$d,u$q[1]=u$b,u$A[0]=u$d/u$t.width,u$A[1]=u$b/u$t.height;for(var u$Q=2,u$T=0;u$T<u$O;u$T++){var u$$=u$E*Math.cos(u$m)+u$d,u$e=u$E*Math.sin(u$m)+u$b;u$q[u$Q]=u$$,u$q[u$Q+1]=u$e,u$A[u$Q]=u$$/u$t.width,u$A[u$Q+1]=u$e/u$t.height,u$m+=u$R,u$Q+=2}for(u$T=u$Q=0;u$T<u$O;u$T++)u$c[u$Q++]=0,u$c[u$Q++]=u$T+1,u$c[u$Q++]=u$O+1<=u$T+2?1:u$T+2;this.drawTriangles(u$t,u$W,u$j,u$q,u$A,u$c)},u$W.drawTriangles=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){void 0===u$q&&(u$q=1),this._saveToCmd(u$y._context.drawTriangles,[u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c])},u$W._saveToCmd=function(u$W,u$j){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=u$j,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(u$j)),u$j.callee=u$W,this._repaint(),u$j},u$W.clipRect=function(u$W,u$j,u$t,u$d){this._saveToCmd(u$y._context._clipRect,[u$W,u$j,u$t,u$d])},u$W.fillText=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){void 0===u$O&&(u$O=0),this._saveToCmd(u$y._context._fillText,[u$W,u$j,u$t,u$d||u$T.defaultFont,u$b,u$E])},u$W.fillBorderText=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){this._saveToCmd(u$y._context._fillBorderText,[u$W,u$j,u$t,u$d||u$T.defaultFont,u$b,u$E,u$O,u$q])},u$W.strokeText=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this._saveToCmd(u$y._context._strokeText,[u$W,u$j,u$t,u$d||u$T.defaultFont,u$b,u$E,u$O])},u$W.alpha=function(u$W){u$W=u$W<0?0:1<u$W?1:u$W,this._saveToCmd(u$y._context._alpha,[u$W])},u$W.setAlpha=function(u$W){u$W=u$W<0?0:1<u$W?1:u$W,this._saveToCmd(u$y._context._setAlpha,[u$W])},u$W.transform=function(u$W,u$j,u$t){void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),this._saveToCmd(u$y._context._transform,[u$W,u$j,u$t])},u$W.rotate=function(u$W,u$j,u$t){void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),this._saveToCmd(u$y._context._rotate,[u$W,u$j,u$t])},u$W.scale=function(u$W,u$j,u$t,u$d){void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=0),this._saveToCmd(u$y._context._scale,[u$W,u$j,u$t,u$d])},u$W.translate=function(u$W,u$j){this._saveToCmd(u$y._context._translate,[u$W,u$j])},u$W.save=function(){this._saveToCmd(u$y._context._save,[])},u$W.restore=function(){this._saveToCmd(u$y._context._restore,[])},u$W.replaceText=function(u$W){this._repaint();var u$j=this._cmds;if(u$j){for(var u$t=u$j.length-1;-1<u$t;u$t--)if(this._isTextCmd(u$j[u$t].callee))return u$j[u$t][0].toUpperCase?u$j[u$t][0]=u$W:u$j[u$t][0].setText(u$W),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=u$W:this._one[0].setText(u$W),!0;return!1},u$W._isTextCmd=function(u$W){return u$W===u$y._context._fillText||u$W===u$y._context._fillBorderText||u$W===u$y._context._strokeText},u$W.replaceTextColor=function(u$W){this._repaint();var u$j=this._cmds;if(u$j)for(var u$t=u$j.length-1;-1<u$t;u$t--)this._isTextCmd(u$j[u$t].callee)&&(u$j[u$t][4]=u$W,u$j[u$t][0].toUpperCase||(u$j[u$t][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=u$W,this._one[0].toUpperCase||(this._one[0].changed=!0))},u$W.loadImage=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=this;void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=0),void 0===u$b&&(u$b=0);var u$q=u$qW.getRes(u$W);function u$A(u$W){u$W&&(u$O.drawTexture(u$W,u$j,u$t,u$d,u$b),null!=u$E&&u$E.call(u$O._sp,u$W))}u$q?u$A(u$q):u$N.loader.load(u$W,u$S.create(null,u$A),null,"image")},u$W._renderEmpty=function(u$W,u$j,u$t,u$d){},u$W._renderAll=function(u$W,u$j,u$t,u$d){for(var u$b,u$E=this._cmds,u$O=0,u$q=u$E.length;u$O<u$q;u$O++)(u$b=u$E[u$O]).callee.call(u$j,u$t,u$d,u$b)},u$W._renderOne=function(u$W,u$j,u$t,u$d){this._one.callee.call(u$j,u$t,u$d,this._one)},u$W._renderOneImg=function(u$W,u$j,u$t,u$d){this._one.callee.call(u$j,u$t,u$d,this._one),2305!==u$W._renderType&&(u$W._renderType|=1)},u$W.drawLine=function(u$W,u$j,u$t,u$d,u$b,u$E){void 0===u$E&&(u$E=1);var u$O=0;u$y.isWebGL&&(u$O=u$k.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(u$O));var u$q=u$E%2==0?0:.5,u$A=[u$W+u$q,u$j+u$q,u$t+u$q,u$d+u$q,u$b,u$E,u$O];this._saveToCmd(u$y._context._drawLine,u$A)},u$W.drawLines=function(u$W,u$j,u$t,u$d,u$b){void 0===u$b&&(u$b=1);var u$E=0;if(u$t&&!(u$t.length<4)){u$y.isWebGL&&(u$E=u$k.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(u$E));var u$O=u$b%2==0?0:.5,u$q=[u$W+u$O,u$j+u$O,u$t,u$d,u$b,u$E];this._saveToCmd(u$y._context._drawLines,u$q)}},u$W.drawCurves=function(u$W,u$j,u$t,u$d,u$b){void 0===u$b&&(u$b=1);var u$E=[u$W,u$j,u$t,u$d,u$b];this._saveToCmd(u$y._context._drawCurves,u$E)},u$W.drawRect=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){void 0===u$O&&(u$O=1);var u$q=u$E?u$O/2:0,u$A=u$E?u$O:0,u$c=[u$W+u$q,u$j+u$q,u$t-u$A,u$d-u$A,u$b,u$E,u$O];this._saveToCmd(u$y._context._drawRect,u$c)},u$W.drawCircle=function(u$W,u$j,u$t,u$d,u$b,u$E){void 0===u$E&&(u$E=1);var u$O=u$b?u$E/2:0,u$q=0;u$y.isWebGL&&(u$q=u$k.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(u$q));var u$A=[u$W,u$j,u$t-u$O,u$d,u$b,u$E,u$q];this._saveToCmd(u$y._context._drawCircle,u$A)},u$W.drawPie=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){void 0===u$q&&(u$q=1);var u$A=u$O?u$q/2:0,u$c=u$O?u$q:0,u$R=0;u$y.isWebGL&&(u$R=u$k.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(u$R));var u$m=[u$W+u$A,u$j+u$A,u$t-u$c,u$d,u$b,u$E,u$O,u$q,u$R];u$m[3]=u$n.toRadian(u$d),u$m[4]=u$n.toRadian(u$b),this._saveToCmd(u$y._context._drawPie,u$m)},u$W.drawPoly=function(u$W,u$j,u$t,u$d,u$b,u$E){void 0===u$E&&(u$E=1);var u$O=0,u$q=!1;u$y.isWebGL&&(u$O=u$k.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(u$O),u$q=!(6<u$t.length));var u$A=u$b?u$E%2==0?0:.5:0,u$c=[u$W+u$A,u$j+u$A,u$t,u$d,u$b,u$E,u$O,u$q];this._saveToCmd(u$y._context._drawPoly,u$c)},u$W.drawPath=function(u$W,u$j,u$t,u$d,u$b){var u$E=[u$W,u$j,u$t,u$d,u$b];this._saveToCmd(u$y._context._drawPath,u$E)},u$$(0,u$W,"cmds",function(){return this._cmds},function(u$W){this._sp&&(this._sp._renderType|=512),this._cmds=u$W,this._render=this._renderAll,this._repaint()}),u$m.__init__=function(){if(u$y.isConchNode){for(var u$W=laya.display.Graphics.prototype,u$j=u$Y.window.ConchGraphics.prototype,u$t=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],u$d=0,u$b=u$t.length;u$d<=u$b;u$d++){var u$E=u$t[u$d];u$W[u$E]=u$j[u$E]}u$W._saveToCmd=null,u$j.drawImageS&&(u$W.drawTextures=function(u$W,u$j){if(u$W&&u$W.loaded&&u$W.bitmap&&u$W.source){var u$t=u$W.uv,u$d=u$W.bitmap.width,u$b=u$W.bitmap.height;this.drawImageS(u$W.bitmap.source,u$t[0]*u$d,u$t[1]*u$b,(u$t[2]-u$t[0])*u$d,(u$t[5]-u$t[3])*u$b,u$W.offsetX,u$W.offsetY,u$W.width,u$W.height,u$j)}}),u$W.drawTexture=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){if(void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=0),void 0===u$b&&(u$b=0),void 0===u$O&&(u$O=1),u$W)if(u$W.loaded){if(u$W.loaded&&u$W.bitmap&&u$W.source&&(u$d||(u$d=u$W.sourceWidth),u$b||(u$b=u$W.sourceHeight),u$O=u$O<0?0:1<u$O?1:u$O,u$d=u$d-u$W.sourceWidth+u$W.width,u$b=u$b-u$W.sourceHeight+u$W.height,!(u$d<=0||u$b<=0))){u$j+=u$W.offsetX,u$t+=u$W.offsetY;var u$q=u$W.uv,u$A=u$W.bitmap.width,u$c=u$W.bitmap.height;u$q[4]<u$q[0]&&u$q[5]<u$q[1]?this.drawImageM(u$W.bitmap.source,u$q[4]*u$A,u$q[5]*u$c,(u$q[0]-u$q[4])*u$A,(u$q[1]-u$q[5])*u$c,u$j,u$t,u$d,u$b,u$E,u$O):this.drawImageM(u$W.bitmap.source,u$q[0]*u$A,u$q[1]*u$c,(u$q[2]-u$q[0])*u$A,(u$q[5]-u$q[3])*u$c,u$j,u$t,u$d,u$b,u$E,u$O),this._repaint()}}else u$W.once("loaded",this,function(){this.drawTexture(u$W,u$j,u$t,u$d,u$b,u$E)})},u$W.fillTexture=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){if(void 0===u$d&&(u$d=0),void 0===u$b&&(u$b=0),void 0===u$E&&(u$E="repeat"),u$W&&u$W.loaded){var u$q,u$A=u$y._context.ctx,u$c=u$W.bitmap.width,u$R=u$W.bitmap.height,u$m=u$W.uv;u$q=u$W.uv!=u$RW.DEF_UV?u$A.createPattern(u$W.bitmap.source,u$E,u$m[0]*u$c,u$m[1]*u$R,(u$m[2]-u$m[0])*u$c,(u$m[5]-u$m[3])*u$R):u$A.createPattern(u$W.bitmap.source,u$E);var u$Q=0,u$T=0;u$O&&(u$j+=u$O.x%u$W.width,u$t+=u$O.y%u$W.height,u$Q-=u$O.x%u$W.width,u$T-=u$O.y%u$W.height),this._fillImage(u$q,u$j,u$t,u$Q,u$T,u$d,u$b)}}}},u$m._cache=[],u$m}(),u$t=function(){function u$M(){this._cacheBoundsType=!1}u$R(u$M,"laya.display.GraphicsBounds");var u$W=u$M.prototype;return u$W.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},u$W.reset=function(){this._temp&&(this._temp.length=0)},u$W.getBounds=function(u$W){return void 0===u$W&&(u$W=!1),(!this._bounds||!this._temp||this._temp.length<1||u$W!=this._cacheBoundsType)&&(this._bounds=u$C._getWrapRec(this.getBoundPoints(u$W),this._bounds)),this._cacheBoundsType=u$W,this._bounds},u$W.getBoundPoints=function(u$W){return void 0===u$W&&(u$W=!1),(!this._temp||this._temp.length<1||u$W!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(u$W)),this._cacheBoundsType=u$W,this._rstBoundPoints=u$n.copyArray(this._rstBoundPoints,this._temp)},u$W._getCmdPoints=function(u$W){void 0===u$W&&(u$W=!1);var u$j,u$t,u$d=u$y._context,u$b=this._graphics.cmds;if((u$j=this._temp||(this._temp=[])).length=0,u$b||null==this._graphics._one||(u$M._tempCmds.length=0,u$M._tempCmds.push(this._graphics._one),u$b=u$M._tempCmds),!u$b)return u$j;(u$t=u$M._tempMatrixArrays).length=0;var u$E=u$M._initMatrix;u$E.identity();for(var u$O,u$q,u$A=u$M._tempMatrix,u$c=NaN,u$R=NaN,u$m=NaN,u$Q=NaN,u$T=NaN,u$$=NaN,u$e=0,u$K=u$b.length;u$e<u$K;u$e++)if((u$O=u$b[u$e]).callee)switch(u$O.callee){case u$d._save:case 7:u$t.push(u$E),u$E=u$E.clone();break;case u$d._restore:case 8:u$E=u$t.pop();break;case u$d._scale:case 5:u$A.identity(),u$A.translate(-u$O[2],-u$O[3]),u$A.scale(u$O[0],u$O[1]),u$A.translate(u$O[2],u$O[3]),this._switchMatrix(u$E,u$A);break;case u$d._rotate:case 3:u$A.identity(),u$A.translate(-u$O[1],-u$O[2]),u$A.rotate(u$O[0]),u$A.translate(u$O[1],u$O[2]),this._switchMatrix(u$E,u$A);break;case u$d._translate:case 6:u$A.identity(),u$A.translate(u$O[0],u$O[1]),this._switchMatrix(u$E,u$A);break;case u$d._transform:case 4:u$A.identity(),u$A.translate(-u$O[1],-u$O[2]),u$A.concat(u$O[0]),u$A.translate(u$O[1],u$O[2]),this._switchMatrix(u$E,u$A);break;case 16:case 24:u$M._addPointArrToRst(u$j,u$C._getBoundPointS(u$O[0],u$O[1],u$O[2],u$O[3]),u$E);break;case 17:u$E.copyTo(u$A),u$A.concat(u$O[4]),u$M._addPointArrToRst(u$j,u$C._getBoundPointS(u$O[0],u$O[1],u$O[2],u$O[3]),u$A);break;case u$d._drawTexture:u$q=u$O[0],u$W?u$O[3]&&u$O[4]?u$M._addPointArrToRst(u$j,u$C._getBoundPointS(u$O[1],u$O[2],u$O[3],u$O[4]),u$E):(u$q=u$O[0],u$M._addPointArrToRst(u$j,u$C._getBoundPointS(u$O[1],u$O[2],u$q.width,u$q.height),u$E)):(u$c=(u$O[3]||u$q.sourceWidth)/u$q.width,u$R=(u$O[4]||u$q.sourceHeight)/u$q.height,u$m=u$c*u$q.sourceWidth,u$Q=u$R*u$q.sourceHeight,u$T=0<u$q.offsetX?u$q.offsetX:0,u$$=0<u$q.offsetY?u$q.offsetY:0,u$T*=u$c,u$$*=u$R,u$M._addPointArrToRst(u$j,u$C._getBoundPointS(u$O[1]-u$T,u$O[2]-u$$,u$m,u$Q),u$E));break;case u$d._fillTexture:u$O[3]&&u$O[4]?u$M._addPointArrToRst(u$j,u$C._getBoundPointS(u$O[1],u$O[2],u$O[3],u$O[4]),u$E):(u$q=u$O[0],u$M._addPointArrToRst(u$j,u$C._getBoundPointS(u$O[1],u$O[2],u$q.width,u$q.height),u$E));break;case u$d._drawTextureWithTransform:var u$o;u$o=u$O[5]?(u$E.copyTo(u$A),u$A.concat(u$O[5]),u$A):u$E,u$W?u$O[3]&&u$O[4]?u$M._addPointArrToRst(u$j,u$C._getBoundPointS(u$O[1],u$O[2],u$O[3],u$O[4]),u$o):(u$q=u$O[0],u$M._addPointArrToRst(u$j,u$C._getBoundPointS(u$O[1],u$O[2],u$q.width,u$q.height),u$o)):(u$q=u$O[0],u$c=(u$O[3]||u$q.sourceWidth)/u$q.width,u$R=(u$O[4]||u$q.sourceHeight)/u$q.height,u$m=u$c*u$q.sourceWidth,u$Q=u$R*u$q.sourceHeight,u$T=0<u$q.offsetX?u$q.offsetX:0,u$$=0<u$q.offsetY?u$q.offsetY:0,u$T*=u$c,u$$*=u$R,u$M._addPointArrToRst(u$j,u$C._getBoundPointS(u$O[1]-u$T,u$O[2]-u$$,u$m,u$Q),u$o));break;case u$d._drawRect:case 13:u$M._addPointArrToRst(u$j,u$C._getBoundPointS(u$O[0],u$O[1],u$O[2],u$O[3]),u$E);break;case u$d._drawCircle:case u$d._fillCircle:case 14:u$M._addPointArrToRst(u$j,u$C._getBoundPointS(u$O[0]-u$O[2],u$O[1]-u$O[2],u$O[2]+u$O[2],u$O[2]+u$O[2]),u$E);break;case u$d._drawLine:case 20:u$M._tempPoints.length=0;var u$S;u$S=.5*u$O[5],u$O[0]==u$O[2]?u$M._tempPoints.push(u$O[0]+u$S,u$O[1],u$O[2]+u$S,u$O[3],u$O[0]-u$S,u$O[1],u$O[2]-u$S,u$O[3]):u$O[1]==u$O[3]?u$M._tempPoints.push(u$O[0],u$O[1]+u$S,u$O[2],u$O[3]+u$S,u$O[0],u$O[1]-u$S,u$O[2],u$O[3]-u$S):u$M._tempPoints.push(u$O[0],u$O[1],u$O[2],u$O[3]),u$M._addPointArrToRst(u$j,u$M._tempPoints,u$E);break;case u$d._drawCurves:case 22:u$M._addPointArrToRst(u$j,u$Z.I.getBezierPoints(u$O[2]),u$E,u$O[0],u$O[1]);break;case u$d._drawPoly:case u$d._drawLines:case 18:u$M._addPointArrToRst(u$j,u$O[2],u$E,u$O[0],u$O[1]);break;case u$d._drawPath:case 19:u$M._addPointArrToRst(u$j,this._getPathPoints(u$O[2]),u$E,u$O[0],u$O[1]);break;case u$d._drawPie:case 15:u$M._addPointArrToRst(u$j,this._getPiePoints(u$O[0],u$O[1],u$O[2],u$O[3],u$O[4]),u$E)}return 200<u$j.length?u$j=u$n.copyArray(u$j,u$C._getWrapRec(u$j)._getBoundPoints()):8<u$j.length&&(u$j=u$X.scanPList(u$j)),u$j},u$W._switchMatrix=function(u$W,u$j){u$j.concat(u$W),u$j.copyTo(u$W)},u$W._getPiePoints=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$M._tempPoints;u$M._tempPoints.length=0,u$E.push(u$W,u$j);var u$O=(u$b-u$d)%(2*Math.PI)/10,u$q=NaN,u$A=u$d;for(u$q=0;u$q<=10;u$q++)u$E.push(u$W+u$t*Math.cos(u$A),u$j+u$t*Math.sin(u$A)),u$A+=u$O;return u$E},u$W._getPathPoints=function(u$W){var u$j,u$t,u$d=0,u$b=u$M._tempPoints;for(u$b.length=0,u$j=u$W.length,u$d=0;u$d<u$j;u$d++)1<(u$t=u$W[u$d]).length&&(u$b.push(u$t[1],u$t[2]),3<u$t.length&&u$b.push(u$t[3],u$t[4]));return u$b},u$M._addPointArrToRst=function(u$W,u$j,u$t,u$d,u$b){void 0===u$d&&(u$d=0),void 0===u$b&&(u$b=0);var u$E,u$O=0;for(u$E=u$j.length,u$O=0;u$O<u$E;u$O+=2)u$M._addPointToRst(u$W,u$j[u$O]+u$d,u$j[u$O+1]+u$b,u$t)},u$M._addPointToRst=function(u$W,u$j,u$t,u$d){var u$b=u$z.TEMP;u$b.setTo(u$j||0,u$t||0),u$d.transformPoint(u$b),u$W.push(u$b.x,u$b.y)},u$M._tempPoints=[],u$M._tempMatrixArrays=[],u$M._tempCmds=[],u$A(u$M,["_tempMatrix",function(){return this._tempMatrix=new u$l},"_initMatrix",function(){return this._initMatrix=new u$l}]),u$M}(),u$E=function(){function u$W(){}u$R(u$W,"laya.events.Event");var u$j=u$W.prototype;return u$j.setTo=function(u$W,u$j,u$t){return this.type=u$W,this.currentTarget=u$j,this.target=u$t,this},u$j.stopPropagation=function(){this._stoped=!0},u$$(0,u$j,"stageY",function(){return u$N.stage.mouseY}),u$$(0,u$j,"charCode",function(){return this.nativeEvent.charCode}),u$$(0,u$j,"touches",function(){var u$W=this.nativeEvent.touches;if(u$W)for(var u$j=u$N.stage,u$t=0,u$d=u$W.length;u$t<u$d;u$t++){var u$b=u$W[u$t],u$E=u$z.TEMP;u$E.setTo(u$b.clientX,u$b.clientY),u$j._canvasTransform.invertTransformPoint(u$E),u$j.transform.invertTransformPoint(u$E),u$b.stageX=u$E.x,u$b.stageY=u$E.y}return u$W}),u$$(0,u$j,"keyLocation",function(){return this.nativeEvent.keyLocation}),u$$(0,u$j,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),u$$(0,u$j,"altKey",function(){return this.nativeEvent.altKey}),u$$(0,u$j,"shiftKey",function(){return this.nativeEvent.shiftKey}),u$$(0,u$j,"stageX",function(){return u$N.stage.mouseX}),u$W.EMPTY=new u$W,u$W.MOUSE_DOWN="mousedown",u$W.MOUSE_UP="mouseup",u$W.CLICK="click",u$W.RIGHT_MOUSE_DOWN="rightmousedown",u$W.RIGHT_MOUSE_UP="rightmouseup",u$W.RIGHT_CLICK="rightclick",u$W.MOUSE_MOVE="mousemove",u$W.MOUSE_OVER="mouseover",u$W.MOUSE_OUT="mouseout",u$W.MOUSE_WHEEL="mousewheel",u$W.ROLL_OVER="mouseover",u$W.ROLL_OUT="mouseout",u$W.DOUBLE_CLICK="doubleclick",u$W.CHANGE="change",u$W.CHANGED="changed",u$W.RESIZE="resize",u$W.ADDED="added",u$W.REMOVED="removed",u$W.DISPLAY="display",u$W.UNDISPLAY="undisplay",u$W.ERROR="error",u$W.COMPLETE="complete",u$W.LOADED="loaded",u$W.INITED="inited",u$W.PROGRESS="progress",u$W.INPUT="input",u$W.RENDER="render",u$W.OPEN="open",u$W.MESSAGE="message",u$W.CLOSE="close",u$W.KEY_DOWN="keydown",u$W.KEY_PRESS="keypress",u$W.KEY_UP="keyup",u$W.FRAME="enterframe",u$W.DRAG_START="dragstart",u$W.DRAG_MOVE="dragmove",u$W.DRAG_END="dragend",u$W.ENTER="enter",u$W.SELECT="select",u$W.BLUR="blur",u$W.FOCUS="focus",u$W.VISIBILITY_CHANGE="visibilitychange",u$W.FOCUS_CHANGE="focuschange",u$W.PLAYED="played",u$W.PAUSED="paused",u$W.STOPPED="stopped",u$W.START="start",u$W.END="end",u$W.ENABLE_CHANGED="enablechanged",u$W.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",u$W.COMPONENT_ADDED="componentadded",u$W.COMPONENT_REMOVED="componentremoved",u$W.LAYER_CHANGED="layerchanged",u$W.HIERARCHY_LOADED="hierarchyloaded",u$W.RECOVERED="recovered",u$W.RELEASED="released",u$W.LINK="link",u$W.LABEL="label",u$W.FULL_SCREEN_CHANGE="fullscreenchange",u$W.DEVICE_LOST="devicelost",u$W.MESH_CHANGED="meshchanged",u$W.MATERIAL_CHANGED="materialchanged",u$W.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",u$W.ANIMATION_CHANGED="animationchanged",u$W.TRIGGER_ENTER="triggerenter",u$W.TRIGGER_STAY="triggerstay",u$W.TRIGGER_EXIT="triggerexit",u$W.TRAIL_FILTER_CHANGE="trailfilterchange",u$W.DOMINO_FILTER_CHANGE="dominofilterchange",u$W}(),u$m=(function(){function u$W(){}u$R(u$W,"laya.events.Keyboard"),u$W.NUMBER_0=48,u$W.NUMBER_1=49,u$W.NUMBER_2=50,u$W.NUMBER_3=51,u$W.NUMBER_4=52,u$W.NUMBER_5=53,u$W.NUMBER_6=54,u$W.NUMBER_7=55,u$W.NUMBER_8=56,u$W.NUMBER_9=57,u$W.A=65,u$W.B=66,u$W.C=67,u$W.D=68,u$W.E=69,u$W.F=70,u$W.G=71,u$W.H=72,u$W.I=73,u$W.J=74,u$W.K=75,u$W.L=76,u$W.M=77,u$W.N=78,u$W.O=79,u$W.P=80,u$W.Q=81,u$W.R=82,u$W.S=83,u$W.T=84,u$W.U=85,u$W.V=86,u$W.W=87,u$W.X=88,u$W.Y=89,u$W.Z=90,u$W.F1=112,u$W.F2=113,u$W.F3=114,u$W.F4=115,u$W.F5=116,u$W.F6=117,u$W.F7=118,u$W.F8=119,u$W.F9=120,u$W.F10=121,u$W.F11=122,u$W.F12=123,u$W.F13=124,u$W.F14=125,u$W.F15=126,u$W.NUMPAD=21,u$W.NUMPAD_0=96,u$W.NUMPAD_1=97,u$W.NUMPAD_2=98,u$W.NUMPAD_3=99,u$W.NUMPAD_4=100,u$W.NUMPAD_5=101,u$W.NUMPAD_6=102,u$W.NUMPAD_7=103,u$W.NUMPAD_8=104,u$W.NUMPAD_9=105,u$W.NUMPAD_ADD=107,u$W.NUMPAD_DECIMAL=110,u$W.NUMPAD_DIVIDE=111,u$W.NUMPAD_ENTER=108,u$W.NUMPAD_MULTIPLY=106,u$W.NUMPAD_SUBTRACT=109,u$W.SEMICOLON=186,u$W.EQUAL=187,u$W.COMMA=188,u$W.MINUS=189,u$W.PERIOD=190,u$W.SLASH=191,u$W.BACKQUOTE=192,u$W.LEFTBRACKET=219,u$W.BACKSLASH=220,u$W.RIGHTBRACKET=221,u$W.QUOTE=222,u$W.ALTERNATE=18,u$W.BACKSPACE=8,u$W.CAPS_LOCK=20,u$W.COMMAND=15,u$W.CONTROL=17,u$W.DELETE=46,u$W.ENTER=13,u$W.ESCAPE=27,u$W.PAGE_UP=33,u$W.PAGE_DOWN=34,u$W.END=35,u$W.HOME=36,u$W.LEFT=37,u$W.UP=38,u$W.RIGHT=39,u$W.DOWN=40,u$W.SHIFT=16,u$W.SPACE=32,u$W.TAB=9,u$W.INSERT=45}(),function(){function u$b(){}return u$R(u$b,"laya.events.KeyBoardManager"),u$b.__init__=function(){u$b._addEvent("keydown"),u$b._addEvent("keypress"),u$b._addEvent("keyup")},u$b._addEvent=function(u$j){u$Y.document.addEventListener(u$j,function(u$W){laya.events.KeyBoardManager._dispatch(u$W,u$j)},!0)},u$b._dispatch=function(u$W,u$j){if(u$b.enabled){u$b._event._stoped=!1,u$b._event.nativeEvent=u$W,u$b._event.keyCode=u$W.keyCode||u$W.which||u$W.charCode,"keydown"===u$j?u$b._pressKeys[u$b._event.keyCode]=!0:"keyup"===u$j&&(u$b._pressKeys[u$b._event.keyCode]=null);for(var u$t=u$N.stage.focus&&null!=u$N.stage.focus.event&&u$N.stage.focus.displayedInStage?u$N.stage.focus:u$N.stage,u$d=u$t;u$d;)u$d.event(u$j,u$b._event.setTo(u$j,u$d,u$t)),u$d=u$d.parent}},u$b.hasKeyDown=function(u$W){return u$b._pressKeys[u$W]},u$b._pressKeys={},u$b.enabled=!0,u$A(u$b,["_event",function(){return this._event=new u$E}]),u$b}()),u$e=(function(){function u$W(){}u$R(u$W,"laya.events.KeyLocation"),u$W.STANDARD=0,u$W.LEFT=1,u$W.RIGHT=2,u$W.NUM_PAD=3}(),function(){function u$c(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=u$Y.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new u$E,this._matrix=new u$l,this._point=new u$z,this._rect=new u$C,this._prePoint=new u$z,this._curTouchID=NaN}u$R(u$c,"laya.events.MouseManager");var u$W=u$c.prototype;return u$W.__init__=function(u$W,u$j){var u$t=this;this._stage=u$W;var u$d=this,u$b=this._eventList;u$j.oncontextmenu=function(u$W){if(u$c.enabled)return!1},u$j.addEventListener("mousedown",function(u$W){u$c.enabled&&(u$Y.onIE||u$W.preventDefault(),u$b.push(u$W),u$d.mouseDownTime=u$Y.now())}),u$j.addEventListener("mouseup",function(u$W){u$c.enabled&&(u$W.preventDefault(),u$b.push(u$W),u$d.mouseDownTime=-u$Y.now())},!0),u$j.addEventListener("mousemove",function(u$W){if(u$c.enabled){u$W.preventDefault();var u$j=u$Y.now();if(u$j-u$d._lastMoveTimer<10)return;u$d._lastMoveTimer=u$j,u$b.push(u$W)}},!0),u$j.addEventListener("mouseout",function(u$W){u$c.enabled&&u$b.push(u$W)}),u$j.addEventListener("mouseover",function(u$W){u$c.enabled&&u$b.push(u$W)}),u$j.addEventListener("touchstart",function(u$W){u$c.enabled&&(u$b.push(u$W),u$c._isFirstTouch||u$XW.isInputting||u$W.preventDefault(),u$d.mouseDownTime=u$Y.now())}),u$j.addEventListener("touchend",function(u$W){u$c.enabled?(u$c._isFirstTouch||u$XW.isInputting||u$W.preventDefault(),u$c._isFirstTouch=!1,u$b.push(u$W),u$d.mouseDownTime=-u$Y.now()):u$t._curTouchID=NaN},!0),u$j.addEventListener("touchmove",function(u$W){u$c.enabled&&(u$W.preventDefault(),u$b.push(u$W))},!0),u$j.addEventListener("touchcancel",function(u$W){u$c.enabled?(u$W.preventDefault(),u$b.push(u$W)):u$t._curTouchID=NaN},!0),u$j.addEventListener("mousewheel",function(u$W){u$c.enabled&&u$b.push(u$W)}),u$j.addEventListener("DOMMouseScroll",function(u$W){u$c.enabled&&u$b.push(u$W)})},u$W.initEvent=function(u$W,u$j){var u$t;this._event._stoped=!1,this._event.nativeEvent=u$j||u$W,this._target=null,this._point.setTo(u$W.pageX||u$W.clientX,u$W.pageY||u$W.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=u$W.identifier||0,this._tTouchID=this._event.touchId,(u$t=u$K.I._event)._stoped=!1,u$t.nativeEvent=this._event.nativeEvent,u$t.touchId=this._event.touchId},u$W.checkMouseWheel=function(u$W){this._event.delta=u$W.wheelDelta?.025*u$W.wheelDelta:-u$W.detail;for(var u$j=u$K.I.getLastOvers(),u$t=0,u$d=u$j.length;u$t<u$d;u$t++){var u$b=u$j[u$t];u$b.event("mousewheel",this._event.setTo("mousewheel",u$b,this._target))}},u$W.onMouseMove=function(u$W){u$K.I.onMouseMove(u$W,this._tTouchID)},u$W.onMouseDown=function(u$W){if(u$XW.isInputting&&u$N.stage.focus&&u$N.stage.focus.focus&&!u$N.stage.focus.contains(this._target)){var u$j=u$N.stage.focus._tf||u$N.stage.focus,u$t=u$W._tf||u$W;u$t instanceof laya.display.Input&&u$t.multiline==u$j.multiline?u$j._focusOut():u$j.focus=!1}u$K.I.onMouseDown(u$W,this._tTouchID,this._isLeftMouse)},u$W.onMouseUp=function(u$W){u$K.I.onMouseUp(u$W,this._tTouchID,this._isLeftMouse)},u$W.check=function(u$W,u$j,u$t,u$d){this._point.setTo(u$j,u$t),u$W.fromParentPoint(this._point),u$j=this._point.x,u$t=this._point.y;var u$b=u$W.scrollRect;if(u$b&&(this._rect.setTo(u$b.x,u$b.y,u$b.width,u$b.height),!this._rect.contains(u$j,u$t)))return!1;if(!this.disableMouseEvent){if(u$W.hitTestPrior&&!u$W.mouseThrough&&!this.hitTest(u$W,u$j,u$t))return!1;for(var u$E=u$W._childs.length-1;-1<u$E;u$E--){var u$O=u$W._childs[u$E];if(!u$O.destroyed&&u$O.mouseEnabled&&u$O.visible&&this.check(u$O,u$j,u$t,u$d))return!0}}var u$q=!(!u$W.hitTestPrior||u$W.mouseThrough||this.disableMouseEvent)||this.hitTest(u$W,u$j,u$t);return u$q?(this._target=u$W,u$d.call(this,u$W)):u$d===this.onMouseUp&&u$W===this._stage&&(this._target=this._stage,u$d.call(this,this._target)),u$q},u$W.hitTest=function(u$W,u$j,u$t){var u$d=!1;if(u$W.scrollRect&&(u$j-=u$W.scrollRect.x,u$t-=u$W.scrollRect.y),u$W.hitArea instanceof laya.utils.HitArea)return u$W.hitArea.isHit(u$j,u$t);if(0<u$W.width&&0<u$W.height||u$W.mouseThrough||u$W.hitArea)if(u$W.mouseThrough)u$d=u$W.getGraphicBounds().contains(u$j,u$t);else{var u$b=this._rect;u$W.hitArea?u$b=u$W.hitArea:u$b.setTo(0,0,u$W.width,u$W.height),u$d=u$b.contains(u$j,u$t)}return u$d},u$W.runEvent=function(){var u$W=this._eventList.length;if(u$W){this.mouseEventTime=u$Y.now();var u$j,u$t=0,u$d=0,u$b=0;try{for(;u$t<u$W;){var u$E=this._eventList[u$t];switch("mousemove"!==u$E.type&&(this._prePoint.x=this._prePoint.y=-1e6),u$E.type){case"mousedown":this._touchIDs[0]=this._id++,u$c._isTouchRespond?u$c._isTouchRespond=!1:(this._isLeftMouse=0===u$E.button,this.initEvent(u$E),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===u$E.button,this.initEvent(u$E),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-u$E.clientX)+Math.abs(this._prePoint.y-u$E.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=u$E.clientX,this._prePoint.y=u$E.clientY,this.initEvent(u$E),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":u$c._isTouchRespond=!0,this._isLeftMouse=!0;var u$O=u$E.changedTouches;for(u$d=0,u$b=u$O.length;u$d<u$b;u$d++)u$j=u$O[u$d],(u$c.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=u$j.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[u$j.identifier]=this._id++,this.initEvent(u$j,u$E),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":u$c._isTouchRespond=!0,this._isLeftMouse=!0;var u$q=u$E.changedTouches;for(u$d=0,u$b=u$q.length;u$d<u$b;u$d++)if(u$j=u$q[u$d],u$c.multiTouchEnabled||u$j.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(u$j,u$E);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var u$A=u$E.changedTouches;for(u$d=0,u$b=u$A.length;u$d<u$b;u$d++)u$j=u$A[u$d],(u$c.multiTouchEnabled||u$j.identifier==this._curTouchID)&&(this.initEvent(u$j,u$E),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(u$E);break;case"mouseout":u$K.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}u$t++}}catch(u$W){throw this._eventList.length=0,u$W}this._eventList.length=0}},u$c.enabled=!0,u$c.multiTouchEnabled=!0,u$c._isTouchRespond=!1,u$c._isFirstTouch=!0,u$A(u$c,["instance",function(){return this.instance=new u$c}]),u$c}()),u$K=function(){function u$$(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new u$E}u$R(u$$,"laya.events.TouchManager");var u$W=u$$.prototype;return u$W._clearTempArrs=function(){u$$._oldArr.length=0,u$$._newArr.length=0,u$$._tEleArr.length=0},u$W.getTouchFromArr=function(u$W,u$j){var u$t,u$d,u$b=0;for(u$t=u$j.length,u$b=0;u$b<u$t;u$b++)if((u$d=u$j[u$b]).id==u$W)return u$d;return null},u$W.removeTouchFromArr=function(u$W,u$j){var u$t=0;for(u$t=u$j.length-1;0<=u$t;u$t--)u$j[u$t].id==u$W&&u$j.splice(u$t,1)},u$W.createTouchO=function(u$W,u$j){var u$t;return(u$t=u$r.getItem("TouchData")||{}).id=u$j,u$t.tar=u$W,u$t},u$W.onMouseDown=function(u$W,u$j,u$t){var u$d,u$b,u$E,u$O;(void 0===u$t&&(u$t=!1),this.enable)&&(u$d=this.getTouchFromArr(u$j,this.preOvers),u$E=this.getEles(u$W,null,u$$._tEleArr),u$d?u$d.tar=u$W:(u$b=this.createTouchO(u$W,u$j),this.preOvers.push(u$b)),u$Y.onMobile&&this.sendEvents(u$E,"mouseover",u$j),u$O=u$t?this.preDowns:this.preRightDowns,(u$d=this.getTouchFromArr(u$j,u$O))?u$d.tar=u$W:(u$b=this.createTouchO(u$W,u$j),u$O.push(u$b)),this.sendEvents(u$E,u$t?"mousedown":"rightmousedown",u$j),this._clearTempArrs())},u$W.sendEvents=function(u$W,u$j,u$t){void 0===u$t&&(u$t=0);var u$d,u$b,u$E,u$O=0;for(u$d=u$W.length,this._event._stoped=!1,u$b=u$W[0],u$O=0;u$O<u$d;u$O++){if((u$E=u$W[u$O]).destroyed)return;if(u$E.event(u$j,this._event.setTo(u$j,u$E,u$b)),this._event._stoped)break}},u$W.getEles=function(u$W,u$j,u$t){for(u$t?u$t.length=0:u$t=[];u$W&&u$W!=u$j;)u$t.push(u$W),u$W=u$W.parent;return u$t},u$W.checkMouseOutAndOverOfMove=function(u$W,u$j,u$t){if(void 0===u$t&&(u$t=0),u$j!=u$W){var u$d,u$b,u$E=0,u$O=0;if(u$j.contains(u$W))u$b=this.getEles(u$W,u$j,u$$._tEleArr),this.sendEvents(u$b,"mouseover",u$t);else if(u$W.contains(u$j))u$b=this.getEles(u$j,u$W,u$$._tEleArr),this.sendEvents(u$b,"mouseout",u$t);else{var u$q,u$A;(u$b=u$$._tEleArr).length=0,u$q=this.getEles(u$j,null,u$$._oldArr),u$A=this.getEles(u$W,null,u$$._newArr),u$O=u$q.length;var u$c=0;for(u$E=0;u$E<u$O;u$E++){if(u$d=u$q[u$E],0<=(u$c=u$A.indexOf(u$d))){u$A.splice(u$c,u$A.length-u$c);break}u$b.push(u$d)}0<u$b.length&&this.sendEvents(u$b,"mouseout",u$t),0<u$A.length&&this.sendEvents(u$A,"mouseover",u$t)}}},u$W.onMouseMove=function(u$W,u$j){var u$t,u$d;this.enable&&((u$t=this.getTouchFromArr(u$j,this.preOvers))?(this.checkMouseOutAndOverOfMove(u$W,u$t.tar),u$t.tar=u$W,u$d=this.getEles(u$W,null,u$$._tEleArr)):(u$d=this.getEles(u$W,null,u$$._tEleArr),this.sendEvents(u$d,"mouseover",u$j),this.preOvers.push(this.createTouchO(u$W,u$j))),this.sendEvents(u$d,"mousemove",u$j),this._clearTempArrs())},u$W.getLastOvers=function(){return(u$$._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,u$$._tEleArr):(u$$._tEleArr.push(u$N.stage),u$$._tEleArr)},u$W.stageMouseOut=function(){var u$W;u$W=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(u$W,"mouseout",0)},u$W.onMouseUp=function(u$W,u$j,u$t){if(void 0===u$t&&(u$t=!1),this.enable){var u$d,u$b,u$E,u$O,u$q,u$A,u$c=0,u$R=0,u$m=u$Y.onMobile;if(u$b=this.getEles(u$W,null,u$$._tEleArr),this.sendEvents(u$b,u$t?"mouseup":"rightmouseup",u$j),u$A=u$t?this.preDowns:this.preRightDowns,u$d=this.getTouchFromArr(u$j,u$A)){var u$Q,u$T=u$Y.now();if(u$Q=u$T-this._lastClickTime<300,this._lastClickTime=u$T,u$W==u$d.tar)u$q=u$b;else for(u$E=this.getEles(u$d.tar,null,u$$._oldArr),(u$q=u$$._newArr).length=0,u$R=u$E.length,u$c=0;u$c<u$R;u$c++)u$O=u$E[u$c],0<=u$b.indexOf(u$O)&&u$q.push(u$O);0<u$q.length&&this.sendEvents(u$q,u$t?"click":"rightclick",u$j),u$t&&u$Q&&this.sendEvents(u$q,"doubleclick",u$j),this.removeTouchFromArr(u$j,u$A),u$d.tar=null,u$r.recover("TouchData",u$d)}else;(u$d=this.getTouchFromArr(u$j,this.preOvers))&&u$m&&((u$q=this.getEles(u$d.tar,null,u$q))&&0<u$q.length&&this.sendEvents(u$q,"mouseout",u$j),this.removeTouchFromArr(u$j,this.preOvers),u$d.tar=null,u$r.recover("TouchData",u$d)),this._clearTempArrs()}},u$$._oldArr=[],u$$._newArr=[],u$$._tEleArr=[],u$A(u$$,["I",function(){return this.I=new u$$}]),u$$}(),u$o=function(){function u$W(){this._action=null}u$R(u$W,"laya.filters.Filter");var u$j=u$W.prototype;return u$N.imps(u$j,{"laya.filters.IFilter":!0}),u$j.callNative=function(u$W){},u$$(0,u$j,"type",function(){return-1}),u$$(0,u$j,"action",function(){return this._action}),u$W.BLUR=16,u$W.COLOR=32,u$W.GLOW=8,u$W._filterStart=null,u$W._filterEnd=null,u$W._EndTarget=null,u$W._recycleScope=null,u$W._filter=null,u$W._useSrc=null,u$W._endSrc=null,u$W._useOut=null,u$W._endOut=null,u$W}(),u$M=function(){function u$W(){this.data=null}u$R(u$W,"laya.filters.ColorFilterAction");var u$j=u$W.prototype;return u$N.imps(u$j,{"laya.filters.IFilterAction":!0}),u$j.apply=function(u$W){var u$j=u$W.ctx.ctx,u$t=u$W.ctx.ctx.canvas;if(0==u$t.width||0==u$t.height)return u$t;for(var u$d,u$b=u$j.getImageData(0,0,u$t.width,u$t.height),u$E=u$b.data,u$O=0,u$q=u$E.length;u$O<u$q;u$O+=4)u$d=this.getColor(u$E[u$O],u$E[u$O+1],u$E[u$O+2],u$E[u$O+3]),0!=u$E[u$O+3]&&(u$E[u$O]=u$d[0],u$E[u$O+1]=u$d[1],u$E[u$O+2]=u$d[2],u$E[u$O+3]=u$d[3]);return u$j.putImageData(u$b,0,0),u$W},u$j.getColor=function(u$W,u$j,u$t,u$d){var u$b=[];if(this.data._mat&&this.data._alpha){var u$E=this.data._mat,u$O=this.data._alpha;u$b[0]=u$E[0]*u$W+u$E[1]*u$j+u$E[2]*u$t+u$E[3]*u$d+u$O[0],u$b[1]=u$E[4]*u$W+u$E[5]*u$j+u$E[6]*u$t+u$E[7]*u$d+u$O[1],u$b[2]=u$E[8]*u$W+u$E[9]*u$j+u$E[10]*u$t+u$E[11]*u$d+u$O[2],u$b[3]=u$E[12]*u$W+u$E[13]*u$j+u$E[14]*u$t+u$E[15]*u$d+u$O[3]}return u$b},u$W}(),u$Z=(function(){function u$W(){}u$R(u$W,"laya.maths.Arith"),u$W.formatR=function(u$W){return u$W>Math.PI&&(u$W-=2*Math.PI),u$W<-Math.PI&&(u$W+=2*Math.PI),u$W},u$W.isPOT=function(u$W,u$j){return 0<u$W&&0==(u$W&u$W-1)&&0<u$j&&0==(u$j&u$j-1)},u$W.setMatToArray=function(u$W,u$j){u$W.a,u$W.b,u$W.c,u$W.d,u$W.tx,u$W.ty,u$j[0]=u$W.a,u$j[1]=u$W.b,u$j[4]=u$W.c,u$j[5]=u$W.d,u$j[12]=u$W.tx,u$j[13]=u$W.ty}}(),function(){function u$W(){this._controlPoints=[new u$z,new u$z,new u$z],this._calFun=this.getPoint2}u$R(u$W,"laya.maths.Bezier");var u$j=u$W.prototype;return u$j._switchPoint=function(u$W,u$j){var u$t=this._controlPoints.shift();u$t.setTo(u$W,u$j),this._controlPoints.push(u$t)},u$j.getPoint2=function(u$W,u$j){var u$t=this._controlPoints[0],u$d=this._controlPoints[1],u$b=this._controlPoints[2],u$E=Math.pow(1-u$W,2)*u$t.x+2*u$W*(1-u$W)*u$d.x+Math.pow(u$W,2)*u$b.x,u$O=Math.pow(1-u$W,2)*u$t.y+2*u$W*(1-u$W)*u$d.y+Math.pow(u$W,2)*u$b.y;u$j.push(u$E,u$O)},u$j.getPoint3=function(u$W,u$j){var u$t=this._controlPoints[0],u$d=this._controlPoints[1],u$b=this._controlPoints[2],u$E=this._controlPoints[3],u$O=Math.pow(1-u$W,3)*u$t.x+3*u$d.x*u$W*(1-u$W)*(1-u$W)+3*u$b.x*u$W*u$W*(1-u$W)+u$E.x*Math.pow(u$W,3),u$q=Math.pow(1-u$W,3)*u$t.y+3*u$d.y*u$W*(1-u$W)*(1-u$W)+3*u$b.y*u$W*u$W*(1-u$W)+u$E.y*Math.pow(u$W,3);u$j.push(u$O,u$q)},u$j.insertPoints=function(u$W,u$j){var u$t,u$d=NaN;for(u$t=1/(u$W=0<u$W?u$W:5),u$d=0;u$d<=1;u$d+=u$t)this._calFun(u$d,u$j)},u$j.getBezierPoints=function(u$W,u$j,u$t){void 0===u$j&&(u$j=5),void 0===u$t&&(u$t=2);var u$d,u$b,u$E=0;if((u$d=u$W.length)<2*(u$t+1))return[];switch(u$b=[],u$t){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=u$t;)this._controlPoints.push(new u$z);for(u$E=0;u$E<2*u$t;u$E+=2)this._switchPoint(u$W[u$E],u$W[u$E+1]);for(u$E=2*u$t;u$E<u$d;u$E+=2)this._switchPoint(u$W[u$E],u$W[u$E+1]),u$E/2%u$t==0&&this.insertPoints(u$j,u$b);return u$b},u$A(u$W,["I",function(){return this.I=new u$W}]),u$W}()),u$X=function(){function u$c(){}return u$R(u$c,"laya.maths.GrahamScan"),u$c.multiply=function(u$W,u$j,u$t){return(u$W.x-u$t.x)*(u$j.y-u$t.y)-(u$j.x-u$t.x)*(u$W.y-u$t.y)},u$c.dis=function(u$W,u$j){return(u$W.x-u$j.x)*(u$W.x-u$j.x)+(u$W.y-u$j.y)*(u$W.y-u$j.y)},u$c._getPoints=function(u$W,u$j,u$t){for(void 0===u$j&&(u$j=!1),u$c._mPointList||(u$c._mPointList=[]);u$c._mPointList.length<u$W;)u$c._mPointList.push(new u$z);return u$t||(u$t=[]),u$t.length=0,u$j?u$c.getFrom(u$t,u$c._mPointList,u$W):u$c.getFromR(u$t,u$c._mPointList,u$W),u$t},u$c.getFrom=function(u$W,u$j,u$t){var u$d=0;for(u$d=0;u$d<u$t;u$d++)u$W.push(u$j[u$d]);return u$W},u$c.getFromR=function(u$W,u$j,u$t){var u$d=0;for(u$d=0;u$d<u$t;u$d++)u$W.push(u$j.pop());return u$W},u$c.pListToPointList=function(u$W,u$j){void 0===u$j&&(u$j=!1);var u$t=0,u$d=u$W.length/2,u$b=u$c._getPoints(u$d,u$j,u$c._tempPointList);for(u$t=0;u$t<u$d;u$t++)u$b[u$t].setTo(u$W[u$t+u$t],u$W[u$t+u$t+1]);return u$b},u$c.pointListToPlist=function(u$W){var u$j,u$t=0,u$d=u$W.length,u$b=u$c._temPList;for(u$t=u$b.length=0;u$t<u$d;u$t++)u$j=u$W[u$t],u$b.push(u$j.x,u$j.y);return u$b},u$c.scanPList=function(u$W){return u$n.copyArray(u$W,u$c.pointListToPlist(u$c.scan(u$c.pListToPointList(u$W,!0))))},u$c.scan=function(u$W){var u$j,u$t,u$d,u$b=0,u$E=0,u$O=0,u$q=u$W.length,u$A={};for((u$t=u$c._temArr).length=0,u$b=(u$q=u$W.length)-1;0<=u$b;u$b--)u$d=(u$j=u$W[u$b]).x+"_"+u$j.y,u$A.hasOwnProperty(u$d)||(u$A[u$d]=!0,u$t.push(u$j));for(u$q=u$t.length,u$n.copyArray(u$W,u$t),u$b=1;u$b<u$q;u$b++)(u$W[u$b].y<u$W[u$O].y||u$W[u$b].y==u$W[u$O].y&&u$W[u$b].x<u$W[u$O].x)&&(u$O=u$b);for(u$j=u$W[0],u$W[0]=u$W[u$O],u$W[u$O]=u$j,u$b=1;u$b<u$q-1;u$b++){for(u$E=(u$O=u$b)+1;u$E<u$q;u$E++)(0<u$c.multiply(u$W[u$E],u$W[u$O],u$W[0])||0==u$c.multiply(u$W[u$E],u$W[u$O],u$W[0])&&u$c.dis(u$W[0],u$W[u$E])<u$c.dis(u$W[0],u$W[u$O]))&&(u$O=u$E);u$j=u$W[u$b],u$W[u$b]=u$W[u$O],u$W[u$O]=u$j}if((u$t=u$c._temArr).length=0,u$W.length<3)return u$n.copyArray(u$t,u$W);for(u$t.push(u$W[0],u$W[1],u$W[2]),u$b=3;u$b<u$q;u$b++){for(;2<=u$t.length&&0<=u$c.multiply(u$W[u$b],u$t[u$t.length-1],u$t[u$t.length-2]);)u$t.pop();u$W[u$b]&&u$t.push(u$W[u$b])}return u$t},u$c._mPointList=null,u$c._tempPointList=[],u$c._temPList=[],u$c._temArr=[],u$c}(),u$_=function(){function u$b(){}return u$R(u$b,"laya.maths.MathUtil"),u$b.subtractVector3=function(u$W,u$j,u$t){u$t[0]=u$W[0]-u$j[0],u$t[1]=u$W[1]-u$j[1],u$t[2]=u$W[2]-u$j[2]},u$b.lerp=function(u$W,u$j,u$t){return u$W*(1-u$t)+u$j*u$t},u$b.scaleVector3=function(u$W,u$j,u$t){u$t[0]=u$W[0]*u$j,u$t[1]=u$W[1]*u$j,u$t[2]=u$W[2]*u$j},u$b.lerpVector3=function(u$W,u$j,u$t,u$d){var u$b=u$W[0],u$E=u$W[1],u$O=u$W[2];u$d[0]=u$b+u$t*(u$j[0]-u$b),u$d[1]=u$E+u$t*(u$j[1]-u$E),u$d[2]=u$O+u$t*(u$j[2]-u$O)},u$b.lerpVector4=function(u$W,u$j,u$t,u$d){var u$b=u$W[0],u$E=u$W[1],u$O=u$W[2],u$q=u$W[3];u$d[0]=u$b+u$t*(u$j[0]-u$b),u$d[1]=u$E+u$t*(u$j[1]-u$E),u$d[2]=u$O+u$t*(u$j[2]-u$O),u$d[3]=u$q+u$t*(u$j[3]-u$q)},u$b.slerpQuaternionArray=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){var u$q,u$A,u$c,u$R,u$m,u$Q=u$W[u$j+0],u$T=u$W[u$j+1],u$$=u$W[u$j+2],u$e=u$W[u$j+3],u$K=u$t[u$d+0],u$o=u$t[u$d+1],u$S=u$t[u$d+2],u$M=u$t[u$d+3];return(u$A=u$Q*u$K+u$T*u$o+u$$*u$S+u$e*u$M)<0&&(u$A=-u$A,u$K=-u$K,u$o=-u$o,u$S=-u$S,u$M=-u$M),u$m=1e-6<1-u$A?(u$q=Math.acos(u$A),u$c=Math.sin(u$q),u$R=Math.sin((1-u$b)*u$q)/u$c,Math.sin(u$b*u$q)/u$c):(u$R=1-u$b,u$b),u$E[u$O+0]=u$R*u$Q+u$m*u$K,u$E[u$O+1]=u$R*u$T+u$m*u$o,u$E[u$O+2]=u$R*u$$+u$m*u$S,u$E[u$O+3]=u$R*u$e+u$m*u$M,u$E},u$b.getRotation=function(u$W,u$j,u$t,u$d){return Math.atan2(u$d-u$j,u$t-u$W)/Math.PI*180},u$b.sortBigFirst=function(u$W,u$j){return u$W==u$j?0:u$W<u$j?1:-1},u$b.sortSmallFirst=function(u$W,u$j){return u$W==u$j?0:u$W<u$j?-1:1},u$b.sortNumBigFirst=function(u$W,u$j){return parseFloat(u$j)-parseFloat(u$W)},u$b.sortNumSmallFirst=function(u$W,u$j){return parseFloat(u$W)-parseFloat(u$j)},u$b.sortByKey=function(u$t,u$W,u$j){var u$d;return void 0===u$W&&(u$W=!1),void 0===u$j&&(u$j=!0),u$d=u$W?u$j?u$b.sortNumBigFirst:u$b.sortBigFirst:u$j?u$b.sortNumSmallFirst:u$b.sortSmallFirst,function(u$W,u$j){return u$d(u$W[u$t],u$j[u$t])}},u$b}(),u$l=function(){function u$t(u$W,u$j,u$t,u$d,u$b,u$E){this.inPool=!1,this.bTransform=!1,void 0===u$W&&(u$W=1),void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=1),void 0===u$b&&(u$b=0),void 0===u$E&&(u$E=0),this.a=u$W,this.b=u$j,this.c=u$t,this.d=u$d,this.tx=u$b,this.ty=u$E,this._checkTransform()}u$R(u$t,"laya.maths.Matrix");var u$W=u$t.prototype;return u$W.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},u$W._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},u$W.setTranslate=function(u$W,u$j){return this.tx=u$W,this.ty=u$j,this},u$W.translate=function(u$W,u$j){return this.tx+=u$W,this.ty+=u$j,this},u$W.scale=function(u$W,u$j){this.a*=u$W,this.d*=u$j,this.c*=u$W,this.b*=u$j,this.tx*=u$W,this.ty*=u$j,this.bTransform=!0},u$W.rotate=function(u$W){var u$j=Math.cos(u$W),u$t=Math.sin(u$W),u$d=this.a,u$b=this.c,u$E=this.tx;this.a=u$d*u$j-this.b*u$t,this.b=u$d*u$t+this.b*u$j,this.c=u$b*u$j-this.d*u$t,this.d=u$b*u$t+this.d*u$j,this.tx=u$E*u$j-this.ty*u$t,this.ty=u$E*u$t+this.ty*u$j,this.bTransform=!0},u$W.skew=function(u$W,u$j){var u$t=Math.tan(u$W),u$d=Math.tan(u$j),u$b=this.a,u$E=this.b;return this.a+=u$d*this.c,this.b+=u$d*this.d,this.c+=u$t*u$b,this.d+=u$t*u$E,this},u$W.invertTransformPoint=function(u$W){var u$j=this.a,u$t=this.b,u$d=this.c,u$b=this.d,u$E=this.tx,u$O=u$j*u$b-u$t*u$d,u$q=u$b/u$O,u$A=-u$t/u$O,u$c=-u$d/u$O,u$R=u$j/u$O,u$m=(u$d*this.ty-u$b*u$E)/u$O,u$Q=-(u$j*this.ty-u$t*u$E)/u$O;return u$W.setTo(u$q*u$W.x+u$c*u$W.y+u$m,u$A*u$W.x+u$R*u$W.y+u$Q)},u$W.transformPoint=function(u$W){return u$W.setTo(this.a*u$W.x+this.c*u$W.y+this.tx,this.b*u$W.x+this.d*u$W.y+this.ty)},u$W.transformPointN=function(u$W){return u$W.setTo(this.a*u$W.x+this.c*u$W.y,this.b*u$W.x+this.d*u$W.y)},u$W.transformPointArray=function(u$W,u$j){for(var u$t=u$W.length,u$d=0;u$d<u$t;u$d+=2){var u$b=u$W[u$d],u$E=u$W[u$d+1];u$j[u$d]=this.a*u$b+this.c*u$E+this.tx,u$j[u$d+1]=this.b*u$b+this.d*u$E+this.ty}return u$j},u$W.transformPointArrayScale=function(u$W,u$j){for(var u$t=u$W.length,u$d=0;u$d<u$t;u$d+=2){var u$b=u$W[u$d],u$E=u$W[u$d+1];u$j[u$d]=this.a*u$b+this.c*u$E,u$j[u$d+1]=this.b*u$b+this.d*u$E}return u$j},u$W.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},u$W.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},u$W.invert=function(){var u$W=this.a,u$j=this.b,u$t=this.c,u$d=this.d,u$b=this.tx,u$E=u$W*u$d-u$j*u$t;return this.a=u$d/u$E,this.b=-u$j/u$E,this.c=-u$t/u$E,this.d=u$W/u$E,this.tx=(u$t*this.ty-u$d*u$b)/u$E,this.ty=-(u$W*this.ty-u$j*u$b)/u$E,this},u$W.setTo=function(u$W,u$j,u$t,u$d,u$b,u$E){return this.a=u$W,this.b=u$j,this.c=u$t,this.d=u$d,this.tx=u$b,this.ty=u$E,this},u$W.concat=function(u$W){var u$j=this.a,u$t=this.c,u$d=this.tx;return this.a=u$j*u$W.a+this.b*u$W.c,this.b=u$j*u$W.b+this.b*u$W.d,this.c=u$t*u$W.a+this.d*u$W.c,this.d=u$t*u$W.b+this.d*u$W.d,this.tx=u$d*u$W.a+this.ty*u$W.c+u$W.tx,this.ty=u$d*u$W.b+this.ty*u$W.d+u$W.ty,this},u$W.scaleEx=function(u$W,u$j){var u$t=this.a,u$d=this.b,u$b=this.c,u$E=this.d;0!==u$d||0!==u$b?(this.a=u$W*u$t,this.b=u$W*u$d,this.c=u$j*u$b):(this.a=u$W*u$t,this.b=0*u$E,this.c=0*u$t),this.d=u$j*u$E,this.bTransform=!0},u$W.rotateEx=function(u$W){var u$j=Math.cos(u$W),u$t=Math.sin(u$W),u$d=this.a,u$b=this.b,u$E=this.c,u$O=this.d;0!==u$b||0!==u$E?(this.a=u$j*u$d+u$t*u$E,this.b=u$j*u$b+u$t*u$O,this.c=-u$t*u$d+u$j*u$E,this.d=-u$t*u$b+u$j*u$O):(this.a=u$j*u$d,this.b=u$t*u$O,this.c=-u$t*u$d,this.d=u$j*u$O),this.bTransform=!0},u$W.clone=function(){var u$W=u$t.create();return u$W.a=this.a,u$W.b=this.b,u$W.c=this.c,u$W.d=this.d,u$W.tx=this.tx,u$W.ty=this.ty,u$W.bTransform=this.bTransform,u$W},u$W.copyTo=function(u$W){return u$W.a=this.a,u$W.b=this.b,u$W.c=this.c,u$W.d=this.d,u$W.tx=this.tx,u$W.ty=this.ty,u$W.bTransform=this.bTransform,u$W},u$W.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},u$W.destroy=function(){if(!this.inPool){var u$W=u$t._cache;this.inPool=!0,u$W._length||(u$W._length=0),(u$W[u$W._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},u$t.mul=function(u$W,u$j,u$t){var u$d=u$W.a,u$b=u$W.b,u$E=u$W.c,u$O=u$W.d,u$q=u$W.tx,u$A=u$W.ty,u$c=u$j.a,u$R=u$j.b,u$m=u$j.c,u$Q=u$j.d,u$T=u$j.tx,u$$=u$j.ty;return 0!==u$R||0!==u$m?(u$t.a=u$d*u$c+u$b*u$m,u$t.b=u$d*u$R+u$b*u$Q,u$t.c=u$E*u$c+u$O*u$m,u$t.d=u$E*u$R+u$O*u$Q,u$t.tx=u$c*u$q+u$m*u$A+u$T,u$t.ty=u$R*u$q+u$Q*u$A+u$$):(u$t.a=u$d*u$c,u$t.b=u$b*u$Q,u$t.c=u$E*u$c,u$t.d=u$O*u$Q,u$t.tx=u$c*u$q+u$T,u$t.ty=u$Q*u$A+u$$),u$t},u$t.mul16=function(u$W,u$j,u$t){var u$d=u$W.a,u$b=u$W.b,u$E=u$W.c,u$O=u$W.d,u$q=u$W.tx,u$A=u$W.ty,u$c=u$j.a,u$R=u$j.b,u$m=u$j.c,u$Q=u$j.d,u$T=u$j.tx,u$$=u$j.ty;return 0!==u$R||0!==u$m?(u$t[0]=u$d*u$c+u$b*u$m,u$t[1]=u$d*u$R+u$b*u$Q,u$t[4]=u$E*u$c+u$O*u$m,u$t[5]=u$E*u$R+u$O*u$Q,u$t[12]=u$c*u$q+u$m*u$A+u$T,u$t[13]=u$R*u$q+u$Q*u$A+u$$):(u$t[0]=u$d*u$c,u$t[1]=u$b*u$Q,u$t[4]=u$E*u$c,u$t[5]=u$O*u$Q,u$t[12]=u$c*u$q+u$T,u$t[13]=u$Q*u$A+u$$),u$t},u$t.mulPre=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){var u$A=u$W.a,u$c=u$W.b,u$R=u$W.c,u$m=u$W.d,u$Q=u$W.tx,u$T=u$W.ty;return 0!==u$t||0!==u$d?(u$q.a=u$A*u$j+u$c*u$d,u$q.b=u$A*u$t+u$c*u$b,u$q.c=u$R*u$j+u$m*u$d,u$q.d=u$R*u$t+u$m*u$b,u$q.tx=u$j*u$Q+u$d*u$T+u$E,u$q.ty=u$t*u$Q+u$b*u$T+u$O):(u$q.a=u$A*u$j,u$q.b=u$c*u$b,u$q.c=u$R*u$j,u$q.d=u$m*u$b,u$q.tx=u$j*u$Q+u$E,u$q.ty=u$b*u$T+u$O),u$q},u$t.mulPos=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){var u$A=u$W.a,u$c=u$W.b,u$R=u$W.c,u$m=u$W.d,u$Q=u$W.tx,u$T=u$W.ty;return 0!==u$c||0!==u$R?(u$q.a=u$j*u$A+u$t*u$R,u$q.b=u$j*u$c+u$t*u$m,u$q.c=u$d*u$A+u$b*u$R,u$q.d=u$d*u$c+u$b*u$m,u$q.tx=u$A*u$E+u$R*u$O+u$Q,u$q.ty=u$c*u$E+u$m*u$O+u$T):(u$q.a=u$j*u$A,u$q.b=u$t*u$m,u$q.c=u$d*u$A,u$q.d=u$b*u$m,u$q.tx=u$A*u$E+u$Q,u$q.ty=u$m*u$O+u$T),u$q},u$t.preMul=function(u$W,u$j,u$t){var u$d=u$W.a,u$b=u$W.b,u$E=u$W.c,u$O=u$W.d,u$q=u$j.a,u$A=u$j.b,u$c=u$j.c,u$R=u$j.d,u$m=u$j.tx,u$Q=u$j.ty;return u$t.a=u$q*u$d,u$t.b=u$t.c=0,u$t.d=u$R*u$O,u$t.tx=u$m*u$d+u$W.tx,u$t.ty=u$Q*u$O+u$W.ty,0===u$A&&0===u$c&&0===u$b&&0===u$E||(u$t.a+=u$A*u$E,u$t.d+=u$c*u$b,u$t.b+=u$q*u$b+u$A*u$O,u$t.c+=u$c*u$d+u$R*u$E,u$t.tx+=u$Q*u$E,u$t.ty+=u$m*u$b),u$t},u$t.preMulXY=function(u$W,u$j,u$t,u$d){var u$b=u$W.a,u$E=u$W.b,u$O=u$W.c,u$q=u$W.d;return u$d.a=u$b,u$d.b=u$E,u$d.c=u$O,u$d.d=u$q,u$d.tx=u$j*u$b+u$W.tx+u$t*u$O,u$d.ty=u$t*u$q+u$W.ty+u$j*u$E,u$d},u$t.create=function(){var u$W=u$t._cache,u$j=u$W._length?u$W[--u$W._length]:new u$t;return u$j.inPool=!1,u$j},u$t.EMPTY=new u$t,u$t.TEMP=new u$t,u$t._cache=[],u$t}(),u$z=function(){function u$W(u$W,u$j){void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),this.x=u$W,this.y=u$j}u$R(u$W,"laya.maths.Point");var u$j=u$W.prototype;return u$j.setTo=function(u$W,u$j){return this.x=u$W,this.y=u$j,this},u$j.distance=function(u$W,u$j){return Math.sqrt((this.x-u$W)*(this.x-u$W)+(this.y-u$j)*(this.y-u$j))},u$j.toString=function(){return this.x+","+this.y},u$j.normalize=function(){var u$W=Math.sqrt(this.x*this.x+this.y*this.y);if(0<u$W){var u$j=1/u$W;this.x*=u$j,this.y*=u$j}},u$W.TEMP=new u$W,u$W.EMPTY=new u$W,u$W}(),u$C=function(){function u$c(u$W,u$j,u$t,u$d){void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=0),this.x=u$W,this.y=u$j,this.width=u$t,this.height=u$d}u$R(u$c,"laya.maths.Rectangle");var u$W=u$c.prototype;return u$W.setTo=function(u$W,u$j,u$t,u$d){return this.x=u$W,this.y=u$j,this.width=u$t,this.height=u$d,this},u$W.copyFrom=function(u$W){return this.x=u$W.x,this.y=u$W.y,this.width=u$W.width,this.height=u$W.height,this},u$W.contains=function(u$W,u$j){return!(this.width<=0||this.height<=0)&&(u$W>=this.x&&u$W<this.right&&u$j>=this.y&&u$j<this.bottom)},u$W.intersects=function(u$W){return!(u$W.x>this.x+this.width||u$W.x+u$W.width<this.x||u$W.y>this.y+this.height||u$W.y+u$W.height<this.y)},u$W.intersection=function(u$W,u$j){return this.intersects(u$W)?(u$j||(u$j=new u$c),u$j.x=Math.max(this.x,u$W.x),u$j.y=Math.max(this.y,u$W.y),u$j.width=Math.min(this.right,u$W.right)-u$j.x,u$j.height=Math.min(this.bottom,u$W.bottom)-u$j.y,u$j):null},u$W.union=function(u$W,u$j){return u$j||(u$j=new u$c),this.clone(u$j),u$W.width<=0||u$W.height<=0?u$j:(u$j.addPoint(u$W.x,u$W.y),u$j.addPoint(u$W.right,u$W.bottom),this)},u$W.clone=function(u$W){return u$W||(u$W=new u$c),u$W.x=this.x,u$W.y=this.y,u$W.width=this.width,u$W.height=this.height,u$W},u$W.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},u$W.equals=function(u$W){return!(!u$W||u$W.x!==this.x||u$W.y!==this.y||u$W.width!==this.width||u$W.height!==this.height)},u$W.addPoint=function(u$W,u$j){return this.x>u$W&&(this.width+=this.x-u$W,this.x=u$W),this.y>u$j&&(this.height+=this.y-u$j,this.y=u$j),this.width<u$W-this.x&&(this.width=u$W-this.x),this.height<u$j-this.y&&(this.height=u$j-this.y),this},u$W._getBoundPoints=function(){var u$W=u$c._temB;return(u$W.length=0)==this.width||0==this.height||u$W.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),u$W},u$W.isEmpty=function(){return this.width<=0||this.height<=0},u$$(0,u$W,"right",function(){return this.x+this.width}),u$$(0,u$W,"bottom",function(){return this.y+this.height}),u$c._getBoundPointS=function(u$W,u$j,u$t,u$d){var u$b=u$c._temA;return(u$b.length=0)==u$t||0==u$d||u$b.push(u$W,u$j,u$W+u$t,u$j,u$W,u$j+u$d,u$W+u$t,u$j+u$d),u$b},u$c._getWrapRec=function(u$W,u$j){if(!u$W||u$W.length<1)return u$j?u$j.setTo(0,0,0,0):u$c.TEMP.setTo(0,0,0,0);u$j=u$j||new u$c;var u$t,u$d,u$b,u$E,u$O,u$q=u$W.length,u$A=u$z.TEMP;for(u$b=u$O=-(u$d=u$E=99999),u$t=0;u$t<u$q;u$t+=2)u$A.x=u$W[u$t],u$A.y=u$W[u$t+1],u$d=u$d<u$A.x?u$d:u$A.x,u$E=u$E<u$A.y?u$E:u$A.y,u$b=u$b>u$A.x?u$b:u$A.x,u$O=u$O>u$A.y?u$O:u$A.y;return u$j.setTo(u$d,u$E,u$b-u$d,u$O-u$E)},u$c.EMPTY=new u$c,u$c.TEMP=new u$c,u$c._temB=[],u$c._temA=[],u$c}(),u$x=function(){function u$A(){}return u$R(u$A,"laya.media.SoundManager"),u$$(1,u$A,"useAudioMusic",function(){return u$A._useAudioMusic},function(u$W){u$A._useAudioMusic=u$W,u$A._musicClass=u$W?u$tW:null}),u$$(1,u$A,"autoStopMusic",function(){return u$A._autoStopMusic},function(u$W){u$N.stage.off("blur",null,u$A._stageOnBlur),u$N.stage.off("focus",null,u$A._stageOnFocus),u$N.stage.off("visibilitychange",null,u$A._visibilityChange),(u$A._autoStopMusic=u$W)&&(u$N.stage.on("blur",null,u$A._stageOnBlur),u$N.stage.on("focus",null,u$A._stageOnFocus),u$N.stage.on("visibilitychange",null,u$A._visibilityChange))}),u$$(1,u$A,"muted",function(){return u$A._muted},function(u$W){u$W!=u$A._muted&&(u$W&&u$A.stopAllSound(),u$A.musicMuted=u$W,u$A._muted=u$W)}),u$$(1,u$A,"musicMuted",function(){return u$A._musicMuted},function(u$W){u$W!=u$A._musicMuted&&(u$W?(u$A._tMusic&&u$A._musicChannel&&!u$A._musicChannel.isStopped?u$A._musicChannel.pause():u$A._musicChannel=null,u$A._musicMuted=u$W):(u$A._musicMuted=u$W,u$A._tMusic&&u$A._musicChannel&&u$A._musicChannel.resume()))}),u$$(1,u$A,"soundMuted",function(){return u$A._soundMuted},function(u$W){u$A._soundMuted=u$W}),u$A.addChannel=function(u$W){0<=u$A._channels.indexOf(u$W)||(u$A._channels.push(u$W),u$A.autoReleaseSound&&0!=u$A._notUsedCount&&u$A._notUsedUrls[u$W.url]&&(delete u$A._notUsedUrls[u$W.url],0==--u$A._notUsedCount&&u$N.timer.clear(u$A,u$A.disposeSoundIfNotUsed)))},u$A.removeChannel=function(u$W){var u$j=u$A._channels,u$t=u$j.indexOf(u$W);if(-1!=u$t&&(u$j.splice(u$t,1),u$A.autoReleaseSound)){var u$d=u$W.url,u$b=u$A.defaultIntervals[u$d]||2e4;if(0<u$b){var u$E=!0;for(u$t=u$j.length-1;0<=u$t;u$t--)if(u$j[u$t].url==u$d){u$E=!1;break}u$E&&(u$A._notUsedUrls[u$d]=Date.now()+u$b,0==u$A._notUsedCount++&&u$N.timer.loop(1e4,u$A,u$A.disposeSoundIfNotUsed))}}},u$A.disposeSoundIfNotUsed=function(){var u$W=u$A._notUsedUrls;if(0!=u$A._notUsedCount){var u$j=Date.now();for(var u$t in u$W)u$j>=u$W[u$t]&&(delete u$W[u$t],--u$A._notUsedCount,u$A.destroySound(u$t));if(0!=u$A._notUsedCount)return}u$N.timer.clear(u$A,u$A.disposeSoundIfNotUsed)},u$A._visibilityChange=function(){u$N.stage.isVisibility?u$A._stageOnFocus():u$A._stageOnBlur()},u$A._stageOnBlur=function(){u$A._isActive=!1,u$A._musicChannel&&(u$A._musicChannel.isStopped||(u$A._blurPaused=!0,u$A._musicChannel.pause())),u$A.stopAllSound(),u$N.stage.once("mousedown",null,u$A._stageOnFocus)},u$A._recoverWebAudio=function(){u$EW.ctx&&"running"!=u$EW.ctx.state&&u$EW.ctx.resume&&u$EW.ctx.resume()},u$A._stageOnFocus=function(){if(u$A._isActive=!0,u$A._recoverWebAudio(),u$N.stage.off("mousedown",null,u$A._stageOnFocus),u$A._blurPaused){var u$W=u$A._musicChannel;u$W&&u$A._music&&u$W.isStopped&&(u$A._blurPaused=!1,u$A._music._disposed?u$A.playMusic(u$W.url,u$W.loops,u$W.startHandler,u$W.completeHandler,u$W.startTime):u$W.audioBuffer?u$W.resume():u$A._music.play(u$W.startTime,u$W.loops,u$W.startHandler,u$W))}},u$A.playSound=function(u$W,u$j,u$t,u$d,u$b,u$E){if(void 0===u$j&&(u$j=1),void 0===u$E&&(u$E=0),!u$W)return null;if(u$A._muted)return null;if(u$A._recoverWebAudio(),u$W==u$A._tMusic){if(u$A._musicMuted)return null}else{if(!u$A._isActive)return null;if(u$A._soundMuted)return null}var u$O,u$q=u$A._pool[u$W];return u$b||(u$b=u$A._soundClass),u$q||((u$q=new u$b).load(u$W),u$A._pool[u$W]=u$q),(u$O=u$q.play(u$E,u$j,u$t))?(u$W==u$A._tMusic&&(u$A._music=u$q,u$A._isActive||(u$A._blurPaused=!0,u$O.pause())),u$O.url=u$W,u$O.volume=u$W==u$A._tMusic?u$A.musicVolume:u$A.soundVolume,u$O.completeHandler=u$d,u$O):null},u$A.destroySound=function(u$W){var u$j=u$A._pool[u$W];u$j&&(delete u$A._pool[u$W],u$j.dispose())},u$A.playMusic=function(u$W,u$j,u$t,u$d,u$b){return void 0===u$j&&(u$j=0),void 0===u$b&&(u$b=0),u$A._tMusic=u$W,u$A._musicChannel&&u$A._musicChannel.stop(),u$A._musicChannel=u$A.playSound(u$W,u$j,u$t,u$d,null,u$b)},u$A.stopSound=function(u$W){for(var u$j,u$t=u$A._channels.length-1;0<=u$t;u$t--)(u$j=u$A._channels[u$t]).url==u$W&&u$j.stop()},u$A.stopAll=function(){u$A._tMusic=null;var u$W=0;for(u$W=u$A._channels.length-1;0<=u$W;u$W--)u$A._channels[u$W].stop()},u$A.stopAllSound=function(){var u$W,u$j=0;for(u$j=u$A._channels.length-1;0<=u$j;u$j--)(u$W=u$A._channels[u$j]).url!=u$A._tMusic&&u$W.stop()},u$A.stopMusic=function(){u$A._musicChannel&&u$A._musicChannel.stop(),u$A._tMusic=null},u$A.setSoundVolume=function(u$W,u$j){if(u$j)u$A._setVolume(u$j,u$W);else{u$A.soundVolume=u$W;var u$t,u$d=0;for(u$d=u$A._channels.length-1;0<=u$d;u$d--)(u$t=u$A._channels[u$d]).url!=u$A._tMusic&&(u$t.volume=u$W)}},u$A.setMusicVolume=function(u$W){u$A.musicVolume=u$W,u$A._setVolume(u$A._tMusic,u$W)},u$A._setVolume=function(u$W,u$j){for(var u$t,u$d=u$A._channels.length-1;0<=u$d;u$d--)(u$t=u$A._channels[u$d]).url==u$W&&(u$t.volume=u$j)},u$A.musicVolume=1,u$A.soundVolume=1,u$A.playbackRate=1,u$A._useAudioMusic=!0,u$A._muted=!1,u$A._soundMuted=!1,u$A._musicMuted=!1,u$A._tMusic=null,u$A._musicChannel=null,u$A._music=null,u$A._channels=[],u$A._autoStopMusic=!1,u$A._blurPaused=!1,u$A._isActive=!0,u$A._soundClass=null,u$A._musicClass=null,u$A.autoReleaseSound=!0,u$A._pool={},u$A.defaultIntervals={},u$A._notUsedUrls={},u$A._notUsedCount=0,u$A}(),u$L=function(){var u$W;function u$t(){}return u$R(u$t,"laya.net.LocalStorage"),u$t.__init__=function(){u$t._baseClass||(u$t._baseClass=u$W).init(),u$t.items=u$t._baseClass.items,u$t.support=u$t._baseClass.support},u$t.setItem=function(u$W,u$j){u$t._baseClass.setItem(u$W,u$j)},u$t.getItem=function(u$W){return u$t._baseClass.getItem(u$W)},u$t.setJSON=function(u$W,u$j){u$t._baseClass.setJSON(u$W,u$j)},u$t.getJSON=function(u$W){return u$t._baseClass.getJSON(u$W)},u$t.removeItem=function(u$W){u$t._baseClass.removeItem(u$W)},u$t.clear=function(){u$t._baseClass.clear()},u$t._baseClass=null,u$t.items=null,u$t.support=!1,u$t.__init$=function(){u$W=function(){function u$t(){}return u$R(u$t,""),u$t.init=function(){try{u$t.support=!0,u$t.items=u$O.localStorage,u$t.setItem("laya","1"),u$t.removeItem("laya")}catch(u$W){u$t.support=!1}u$t.support||console.log("LocalStorage is not supprot or browser is private mode.")},u$t.setItem=function(u$W,u$j){try{u$t.support&&u$t.items.setItem(u$W,u$j)}catch(u$W){console.warn("set localStorage failed",u$W)}},u$t.getItem=function(u$W){return u$t.support?u$t.items.getItem(u$W):null},u$t.setJSON=function(u$W,u$j){try{u$t.support&&u$t.items.setItem(u$W,JSON.stringify(u$j))}catch(u$W){console.warn("set localStorage failed",u$W)}},u$t.getJSON=function(u$W){return JSON.parse(u$t.support?u$t.items.getItem(u$W):null)},u$t.removeItem=function(u$W){u$t.support&&u$t.items.removeItem(u$W)},u$t.clear=function(){u$t.support&&u$t.items.clear()},u$t.items=null,u$t.support=!1,u$t}()},u$t}(),u$h=(function(){function u$d(){}u$R(u$d,"laya.net.ResourceVersion"),u$d.enable=function(u$W,u$j,u$t){void 0===u$t&&(u$t=2),laya.net.ResourceVersion.type=u$t,u$N.loader.load(u$W,u$S.create(null,u$d.onManifestLoaded,[u$j]),null,"json"),u$v.customFormat=u$d.addVersionPrefix},u$d.onManifestLoaded=function(u$W,u$j){u$d.manifest=u$j,u$W.run(),u$j||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},u$d.addVersionPrefix=function(u$W){return u$d.manifest&&u$d.manifest[u$W]?2==u$d.type?u$d.manifest[u$W]:u$d.manifest[u$W]+"/"+u$W:u$W},u$d.FOLDER_VERSION=1,u$d.FILENAME_VERSION=2,u$d.manifest=null,u$d.type=1}(),function(){function u$W(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}u$R(u$W,"laya.net.TTFLoader");var u$j=u$W.prototype;return u$j.load=function(u$W){var u$j=(this._url=u$W).split(".ttf")[0].split("/");this.fontName=u$j[u$j.length-1],u$Y.window.conch?this._loadConch():u$Y.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},u$j._loadConch=function(){this._http=new u$OW,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},u$j._onHttpLoaded=function(u$W){u$Y.window.conch.setFontFaceFromBuffer(this.fontName,u$W),this._clearHttp(),this._complete()},u$j._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},u$j._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},u$j._complete=function(){u$N.timer.clear(this,this._complete),u$N.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},u$j._checkComplete=function(){u$G.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},u$j._loadWithFontFace=function(){var u$W=new u$Y.window.FontFace(this.fontName,"url('"+this._url+"')");u$Y.window.document.fonts.add(u$W);var u$j=this;u$W.loaded.then(function(){u$j._complete()}),u$W.load()},u$j._createDiv=function(){this._div=u$Y.createElement("div"),this._div.innerHTML="laya";var u$W=this._div.style;u$W.fontFamily=this.fontName,u$W.position="absolute",u$W.left="-100px",u$W.top="-100px",u$Y.document.body.appendChild(this._div)},u$j._loadWithCSS=function(){var u$W=this,u$j=u$Y.createElement("style");u$j.type="text/css",u$Y.document.body.appendChild(u$j),u$j.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=u$G.measureText("LayaTTFFont",this._fontTxt).width;var u$t=this;u$j.onload=function(){u$N.timer.once(1e4,u$t,u$W._complete)},u$N.timer.loop(20,this,this._checkComplete),this._createDiv()},u$W._testString="LayaTTFFont",u$W}()),u$v=function(){function u$d(u$W){this._url=null,this._path=null,this._url=u$d.formatURL(u$W),this._path=u$d.getPath(u$W)}u$R(u$d,"laya.net.URL");var u$W=u$d.prototype;return u$$(0,u$W,"path",function(){return this._path}),u$$(0,u$W,"url",function(){return this._url}),u$d.formatURL=function(u$W,u$j){if(!u$W)return"null path";if(0<u$W.indexOf(":"))return u$W;null!=u$d.customFormat&&(u$W=u$d.customFormat(u$W,u$j));var u$t=u$W.charAt(0);if("."===u$t)return u$d.formatRelativePath((u$j||u$d.basePath)+u$W);if("~"===u$t)return u$d.rootPath+u$W.substring(1);if("d"===u$t){if(0===u$W.indexOf("data:image"))return u$W}else if("/"===u$t)return u$W;return(u$j||u$d.basePath)+u$W},u$d.formatRelativePath=function(u$W){for(var u$j=u$W.split("/"),u$t=0,u$d=u$j.length;u$t<u$d;u$t++)".."==u$j[u$t]&&(u$j.splice(u$t-1,2),u$t-=2);return u$j.join("/")},u$d.isAbsolute=function(u$W){return 0<u$W.indexOf(":")||"/"==u$W.charAt(0)},u$d.getPath=function(u$W){var u$j=u$W.lastIndexOf("/");return 0<u$j?u$W.substr(0,u$j+1):""},u$d.getFileName=function(u$W){var u$j=u$W.lastIndexOf("/");return 0<u$j?u$W.substr(u$j+1):u$W},u$d.version={},u$d.basePath="",u$d.rootPath="",u$d.customFormat=function(u$W){var u$j=u$d.version[u$W];return!u$y.isConchApp&&u$j&&(u$W+="?v="+u$j),u$W},u$d}(),u$y=function(){function u$b(u$W,u$j){this._timeId=0;var u$t=u$b._mainCanvas.source.style;u$t.position="absolute",u$t.top=u$t.left="0px",u$t.background="#000000",u$b._mainCanvas.source.id="layaCanvas";var u$d=laya.renders.Render.isWebGL;u$b._mainCanvas.source.width=u$W,u$b._mainCanvas.source.height=u$j,u$d&&u$b.WebGL.init(u$b._mainCanvas,u$W,u$j),u$Y.container.appendChild(u$b._mainCanvas.source),(u$b._context=new u$a(u$W,u$j,u$d?null:u$b._mainCanvas)).ctx.setIsMainContext(),u$Y.window.requestAnimationFrame(function u$W(u$j){u$Y.window.requestAnimationFrame(u$W);u$N.stage._loop()}),u$N.stage.on("visibilitychange",this,this._onVisibilitychange)}u$R(u$b,"laya.renders.Render");var u$W=u$b.prototype;return u$W._onVisibilitychange=function(){u$N.stage.isVisibility?0!=this._timeId&&u$Y.window.clearInterval(this._timeId):this._timeId=u$Y.window.setInterval(this._enterFrame,1e3)},u$W._enterFrame=function(u$W){u$N.stage._loop()},u$$(1,u$b,"context",function(){return u$b._context}),u$$(1,u$b,"canvas",function(){return u$b._mainCanvas.source}),u$b._context=null,u$b._mainCanvas=null,u$b.WebGL=null,u$b.isConchNode=!1,u$b.isConchApp=!1,u$b.isConchWebGL=!1,u$b.isWebGL=!1,u$b.is3DMode=!1,u$b.optimizeTextureMemory=function(u$W,u$j){return!0},u$b.__init$=function(){u$O.ConchRenderType=u$O.ConchRenderType||1,u$O.ConchRenderType|=u$O.conch?4:0,u$b.isConchNode=5==(5&u$O.ConchRenderType),u$b.isConchApp=4==(4&u$O.ConchRenderType),u$b.isConchWebGL=6==u$O.ConchRenderType},u$b}(),u$a=function(){function u$O(u$W,u$j,u$t){this.x=0,this.y=0,this._drawTexture=function(u$W,u$j,u$t){u$t[0].loaded&&this.ctx.drawTexture(u$t[0],u$t[1],u$t[2],u$t[3],u$t[4],u$W,u$j)},this._fillTexture=function(u$W,u$j,u$t){u$t[0].loaded&&this.ctx.fillTexture(u$t[0],u$t[1]+u$W,u$t[2]+u$j,u$t[3],u$t[4],u$t[5],u$t[6],u$t[7])},this._drawTextureWithTransform=function(u$W,u$j,u$t){u$t[0].loaded&&this.ctx.drawTextureWithTransform(u$t[0],u$t[1],u$t[2],u$t[3],u$t[4],u$t[5],u$W,u$j,u$t[6])},this._fillQuadrangle=function(u$W,u$j,u$t){this.ctx.fillQuadrangle(u$t[0],u$t[1],u$t[2],u$t[3],u$t[4])},this._drawRect=function(u$W,u$j,u$t){var u$d=this.ctx;null!=u$t[4]&&(u$d.fillStyle=u$t[4],u$d.fillRect(u$W+u$t[0],u$j+u$t[1],u$t[2],u$t[3],null)),null!=u$t[5]&&(u$d.strokeStyle=u$t[5],u$d.lineWidth=u$t[6],u$d.strokeRect(u$W+u$t[0],u$j+u$t[1],u$t[2],u$t[3],u$t[6]))},this._drawPie=function(u$W,u$j,u$t){var u$d=this.ctx;u$y.isWebGL&&u$d.setPathId(u$t[8]),u$d.beginPath(),u$y.isWebGL?(u$d.movePath(u$t[0]+u$W,u$t[1]+u$j),u$d.moveTo(0,0)):u$d.moveTo(u$W+u$t[0],u$j+u$t[1]),u$d.arc(u$W+u$t[0],u$j+u$t[1],u$t[2],u$t[3],u$t[4]),u$d.closePath(),this._fillAndStroke(u$t[5],u$t[6],u$t[7],!0)},this._clipRect=function(u$W,u$j,u$t){this.ctx.clipRect(u$W+u$t[0],u$j+u$t[1],u$t[2],u$t[3])},this._fillRect=function(u$W,u$j,u$t){this.ctx.fillRect(u$W+u$t[0],u$j+u$t[1],u$t[2],u$t[3],u$t[4])},this._drawCircle=function(u$W,u$j,u$t){var u$d=this.ctx;u$y.isWebGL&&u$d.setPathId(u$t[6]),u$P.drawCall++,u$d.beginPath(),u$y.isWebGL&&u$d.movePath(u$t[0]+u$W,u$t[1]+u$j),u$d.arc(u$t[0]+u$W,u$t[1]+u$j,u$t[2],0,u$O.PI2),u$d.closePath(),this._fillAndStroke(u$t[3],u$t[4],u$t[5],!0)},this._fillCircle=function(u$W,u$j,u$t){u$P.drawCall++;var u$d=this.ctx;u$d.beginPath(),u$d.fillStyle=u$t[3],u$d.arc(u$t[0]+u$W,u$t[1]+u$j,u$t[2],0,u$O.PI2),u$d.fill()},this._setShader=function(u$W,u$j,u$t){this.ctx.setShader(u$t[0])},this._drawLine=function(u$W,u$j,u$t){var u$d=this.ctx;u$y.isWebGL&&u$d.setPathId(u$t[6]),u$d.beginPath(),u$d.strokeStyle=u$t[4],u$d.lineWidth=u$t[5],u$y.isWebGL?(u$d.movePath(u$W,u$j),u$d.moveTo(u$t[0],u$t[1]),u$d.lineTo(u$t[2],u$t[3])):(u$d.moveTo(u$W+u$t[0],u$j+u$t[1]),u$d.lineTo(u$W+u$t[2],u$j+u$t[3])),u$d.stroke()},this._drawLines=function(u$W,u$j,u$t){var u$d=this.ctx;u$y.isWebGL&&u$d.setPathId(u$t[5]),u$d.beginPath(),u$W+=u$t[0],u$j+=u$t[1],u$y.isWebGL&&u$d.movePath(u$W,u$j),u$d.strokeStyle=u$t[3],u$d.lineWidth=u$t[4];var u$b=u$t[2],u$E=2,u$O=u$b.length;if(u$y.isWebGL)for(u$d.moveTo(u$b[0],u$b[1]);u$E<u$O;)u$d.lineTo(u$b[u$E++],u$b[u$E++]);else for(u$d.moveTo(u$W+u$b[0],u$j+u$b[1]);u$E<u$O;)u$d.lineTo(u$W+u$b[u$E++],u$j+u$b[u$E++]);u$d.stroke()},this._drawLinesWebGL=function(u$W,u$j,u$t){this.ctx.drawLines(u$W+this.x+u$t[0],u$j+this.y+u$t[1],u$t[2],u$t[3],u$t[4])},this._drawCurves=function(u$W,u$j,u$t){this.ctx.drawCurves(u$W,u$j,u$t)},this._draw=function(u$W,u$j,u$t){u$t[0].call(null,this,u$W,u$j)},this._transformByMatrix=function(u$W,u$j,u$t){this.ctx.transformByMatrix(u$t[0])},this._setTransform=function(u$W,u$j,u$t){this.ctx.setTransform(u$t[0],u$t[1],u$t[2],u$t[3],u$t[4],u$t[5])},this._setTransformByMatrix=function(u$W,u$j,u$t){this.ctx.setTransformByMatrix(u$t[0])},this._save=function(u$W,u$j,u$t){this.ctx.save()},this._restore=function(u$W,u$j,u$t){this.ctx.restore()},this._translate=function(u$W,u$j,u$t){this.ctx.translate(u$t[0],u$t[1])},this._transform=function(u$W,u$j,u$t){this.ctx.translate(u$t[1]+u$W,u$t[2]+u$j);var u$d=u$t[0];this.ctx.transform(u$d.a,u$d.b,u$d.c,u$d.d,u$d.tx,u$d.ty),this.ctx.translate(-u$W-u$t[1],-u$j-u$t[2])},this._rotate=function(u$W,u$j,u$t){this.ctx.translate(u$t[1]+u$W,u$t[2]+u$j),this.ctx.rotate(u$t[0]),this.ctx.translate(-u$W-u$t[1],-u$j-u$t[2])},this._scale=function(u$W,u$j,u$t){this.ctx.translate(u$t[2]+u$W,u$t[3]+u$j),this.ctx.scale(u$t[0],u$t[1]),this.ctx.translate(-u$W-u$t[2],-u$j-u$t[3])},this._alpha=function(u$W,u$j,u$t){this.ctx.globalAlpha*=u$t[0]},this._setAlpha=function(u$W,u$j,u$t){this.ctx.globalAlpha=u$t[0]},this._fillText=function(u$W,u$j,u$t){this.ctx.fillText(u$t[0],u$t[1]+u$W,u$t[2]+u$j,u$t[3],u$t[4],u$t[5])},this._strokeText=function(u$W,u$j,u$t){this.ctx.strokeText(u$t[0],u$t[1]+u$W,u$t[2]+u$j,u$t[3],u$t[4],u$t[5],u$t[6])},this._fillBorderText=function(u$W,u$j,u$t){this.ctx.fillBorderText(u$t[0],u$t[1]+u$W,u$t[2]+u$j,u$t[3],u$t[4],u$t[5],u$t[6],u$t[7])},this._blendMode=function(u$W,u$j,u$t){this.ctx.globalCompositeOperation=u$t[0]},this._beginClip=function(u$W,u$j,u$t){this.ctx.beginClip&&this.ctx.beginClip(u$W+u$t[0],u$j+u$t[1],u$t[2],u$t[3])},this._setIBVB=function(u$W,u$j,u$t){this.ctx.setIBVB(u$t[0]+u$W,u$t[1]+u$j,u$t[2],u$t[3],u$t[4],u$t[5],u$t[6],u$t[7])},this._fillTrangles=function(u$W,u$j,u$t){this.ctx.fillTrangles(u$t[0],u$t[1]+u$W,u$t[2]+u$j,u$t[3],u$t[4])},this._drawPath=function(u$W,u$j,u$t){var u$d=this.ctx;u$y.isWebGL&&u$d.setPathId(-1),u$d.beginPath(),u$W+=u$t[0],u$j+=u$t[1],u$y.isWebGL&&u$d.movePath(u$W,u$j);for(var u$b=u$t[2],u$E=0,u$O=u$b.length;u$E<u$O;u$E++){var u$q=u$b[u$E];switch(u$q[0]){case"moveTo":u$y.isWebGL?u$d.moveTo(u$q[1],u$q[2]):u$d.moveTo(u$W+u$q[1],u$j+u$q[2]);break;case"lineTo":u$y.isWebGL?u$d.lineTo(u$q[1],u$q[2]):u$d.lineTo(u$W+u$q[1],u$j+u$q[2]);break;case"arcTo":u$y.isWebGL?u$d.arcTo(u$q[1],u$q[2],u$q[3],u$q[4],u$q[5]):u$d.arcTo(u$W+u$q[1],u$j+u$q[2],u$W+u$q[3],u$j+u$q[4],u$q[5]);break;case"closePath":u$d.closePath()}}var u$A=u$t[3];null!=u$A&&(u$d.fillStyle=u$A.fillStyle,u$d.fill());var u$c=u$t[4];null!=u$c&&(u$d.strokeStyle=u$c.strokeStyle,u$d.lineWidth=u$c.lineWidth||1,u$d.lineJoin=u$c.lineJoin,u$d.lineCap=u$c.lineCap,u$d.miterLimit=u$c.miterLimit,u$d.stroke())},this.drawPoly=function(u$W,u$j,u$t){this.ctx.drawPoly(u$W+this.x+u$t[0],u$j+this.y+u$t[1],u$t[2],u$t[3],u$t[4],u$t[5],u$t[6])},this._drawPoly=function(u$W,u$j,u$t){var u$d=this.ctx,u$b=u$t[2],u$E=2,u$O=u$b.length;if(u$y.isWebGL)for(u$d.setPathId(u$t[6]),u$d.beginPath(),u$W+=u$t[0],u$j+=u$t[1],u$d.movePath(u$W,u$j),u$d.moveTo(u$b[0],u$b[1]);u$E<u$O;)u$d.lineTo(u$b[u$E++],u$b[u$E++]);else for(u$d.beginPath(),u$W+=u$t[0],u$j+=u$t[1],u$d.moveTo(u$W+u$b[0],u$j+u$b[1]);u$E<u$O;)u$d.lineTo(u$W+u$b[u$E++],u$j+u$b[u$E++]);u$d.closePath(),this._fillAndStroke(u$t[3],u$t[4],u$t[5],u$t[7])},this._drawSkin=function(u$W,u$j,u$t){var u$d=u$t[0];if(u$d){var u$b=this.ctx;u$d.render(u$b,u$W,u$j)}},this._drawParticle=function(u$W,u$j,u$t){this.ctx.drawParticle(u$W+this.x,u$j+this.y,u$t[0])},this._setFilters=function(u$W,u$j,u$t){this.ctx.setFilters(u$t)},u$t?this.ctx=u$t.getContext("2d"):(u$t=u$MW.create("3D"),this.ctx=u$G.createWebGLContext2D(u$t),u$t._setContext(this.ctx)),u$t.size(u$W,u$j),this.canvas=u$t}u$R(u$O,"laya.renders.RenderContext");var u$W=u$O.prototype;return u$W.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},u$W.drawTexture=function(u$W,u$j,u$t,u$d,u$b){u$W.loaded&&this.ctx.drawTexture(u$W,u$j,u$t,u$d,u$b,this.x,this.y)},u$W._drawTextures=function(u$W,u$j,u$t){u$t[0].loaded&&this.ctx.drawTextures(u$t[0],u$t[1],u$W+this.x,u$j+this.y)},u$W.drawTextureWithTransform=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){u$W.loaded&&this.ctx.drawTextureWithTransform(u$W,u$j,u$t,u$d,u$b,u$E,this.x,this.y,u$O)},u$W.fillQuadrangle=function(u$W,u$j,u$t,u$d,u$b){this.ctx.fillQuadrangle(u$W,u$j,u$t,u$d,u$b)},u$W.drawCanvas=function(u$W,u$j,u$t,u$d,u$b){this.ctx.drawCanvas(u$W,u$j+this.x,u$t+this.y,u$d,u$b)},u$W.drawRect=function(u$W,u$j,u$t,u$d,u$b,u$E){void 0===u$E&&(u$E=1);var u$O=this.ctx;u$O.strokeStyle=u$b,u$O.lineWidth=u$E,u$O.strokeRect(u$W+this.x,u$j+this.y,u$t,u$d,u$E)},u$W._fillAndStroke=function(u$W,u$j,u$t,u$d){void 0===u$d&&(u$d=!1);var u$b=this.ctx;null!=u$W&&(u$b.fillStyle=u$W,u$y.isWebGL?u$b.fill(u$d):u$b.fill()),null!=u$j&&0<u$t&&(u$b.strokeStyle=u$j,u$b.lineWidth=u$t,u$b.stroke())},u$W.clipRect=function(u$W,u$j,u$t,u$d){this.ctx.clipRect(u$W+this.x,u$j+this.y,u$t,u$d)},u$W.fillRect=function(u$W,u$j,u$t,u$d,u$b){this.ctx.fillRect(u$W+this.x,u$j+this.y,u$t,u$d,u$b)},u$W.drawCircle=function(u$W,u$j,u$t,u$d,u$b){void 0===u$b&&(u$b=1),u$P.drawCall++;var u$E=this.ctx;u$E.beginPath(),u$E.strokeStyle=u$d,u$E.lineWidth=u$b,u$E.arc(u$W+this.x,u$j+this.y,u$t,0,u$O.PI2),u$E.stroke()},u$W.drawTriangles=function(u$W,u$j,u$t){if(u$y.isWebGL)this.ctx.drawTriangles(u$t[0],u$W+u$t[1],u$j+u$t[2],u$t[3],u$t[4],u$t[5],u$t[6],u$t[7],u$t[8],u$t[9]);else{var u$d=u$t[5],u$b=0,u$E=u$d.length,u$O=this.ctx;for(u$b=0;u$b<u$E;u$b+=3){var u$q=2*u$d[u$b],u$A=2*u$d[u$b+1],u$c=2*u$d[u$b+2];u$O.drawTriangle(u$t[0],u$t[3],u$t[4],u$q,u$A,u$c,u$t[6],!0)}}},u$W.fillCircle=function(u$W,u$j,u$t,u$d){u$P.drawCall++;var u$b=this.ctx;u$b.beginPath(),u$b.fillStyle=u$d,u$b.arc(u$W+this.x,u$j+this.y,u$t,0,u$O.PI2),u$b.fill()},u$W.setShader=function(u$W){this.ctx.setShader(u$W)},u$W.drawLine=function(u$W,u$j,u$t,u$d,u$b,u$E){void 0===u$E&&(u$E=1);var u$O=this.ctx;u$O.beginPath(),u$O.strokeStyle=u$b,u$O.lineWidth=u$E,u$O.moveTo(this.x+u$W,this.y+u$j),u$O.lineTo(this.x+u$t,this.y+u$d),u$O.stroke()},u$W.clear=function(){this.ctx.clear()},u$W.transformByMatrix=function(u$W){this.ctx.transformByMatrix(u$W)},u$W.setTransform=function(u$W,u$j,u$t,u$d,u$b,u$E){this.ctx.setTransform(u$W,u$j,u$t,u$d,u$b,u$E)},u$W.setTransformByMatrix=function(u$W){this.ctx.setTransformByMatrix(u$W)},u$W.save=function(){this.ctx.save()},u$W.restore=function(){this.ctx.restore()},u$W.translate=function(u$W,u$j){this.ctx.translate(u$W,u$j)},u$W.transform=function(u$W,u$j,u$t,u$d,u$b,u$E){this.ctx.transform(u$W,u$j,u$t,u$d,u$b,u$E)},u$W.rotate=function(u$W){this.ctx.rotate(u$W)},u$W.scale=function(u$W,u$j){this.ctx.scale(u$W,u$j)},u$W.alpha=function(u$W){this.ctx.globalAlpha*=u$W},u$W.setAlpha=function(u$W){this.ctx.globalAlpha=u$W},u$W.fillWords=function(u$W,u$j,u$t,u$d,u$b,u$E){void 0===u$E&&(u$E=0),this.ctx.fillWords(u$W,u$j,u$t,u$d,u$b,u$E)},u$W.fillBorderWords=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this.ctx.fillBorderWords(u$W,u$j,u$t,u$d,u$b,u$E,u$O)},u$W.fillText=function(u$W,u$j,u$t,u$d,u$b,u$E){this.ctx.fillText(u$W,u$j+this.x,u$t+this.y,u$d,u$b,u$E)},u$W.strokeText=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this.ctx.strokeText(u$W,u$j+this.x,u$t+this.y,u$d,u$b,u$E,u$O)},u$W.blendMode=function(u$W){this.ctx.globalCompositeOperation=u$W},u$W.flush=function(){this.ctx.flush&&this.ctx.flush()},u$W.addRenderObject=function(u$W){this.ctx.addRenderObject(u$W)},u$W.beginClip=function(u$W,u$j,u$t,u$d){this.ctx.beginClip&&this.ctx.beginClip(u$W,u$j,u$t,u$d)},u$W.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},u$W.fillTrangles=function(u$W,u$j,u$t){this.ctx.fillTrangles(u$t[0],u$t[1],u$t[2],u$t[3],4<u$t.length?u$t[4]:null)},u$O.PI2=2*Math.PI,u$O}(),u$u=function(){function u$O(u$W,u$j){switch(this._next=u$j||u$O.NORENDER,u$W){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=u$o._filter);case 69905:return void(this._fun=u$O._initRenderFun)}this.onCreate(u$W)}u$R(u$O,"laya.renders.RenderSprite");var u$W=u$O.prototype;return u$W.onCreate=function(u$W){},u$W._style=function(u$W,u$j,u$t,u$d){u$W._style.render(u$W,u$j,u$t,u$d);var u$b=this._next;u$b._fun.call(u$b,u$W,u$j,u$t,u$d)},u$W._no=function(u$W,u$j,u$t,u$d){},u$W._custom=function(u$W,u$j,u$t,u$d){u$W.customRender(u$j,u$t,u$d);var u$b=u$W._style._tf;this._next._fun.call(this._next,u$W,u$j,u$t-u$b.translateX,u$d-u$b.translateY)},u$W._clip=function(u$W,u$j,u$t,u$d){var u$b=this._next;if(u$b!=u$O.NORENDER){var u$E=u$W._style.scrollRect;u$j.ctx.save(),u$j.ctx.clipRect(u$t,u$d,u$E.width,u$E.height),u$b._fun.call(u$b,u$W,u$j,u$t-u$E.x,u$d-u$E.y),u$j.ctx.restore()}},u$W._blend=function(u$W,u$j,u$t,u$d){var u$b=u$W._style;u$b.blendMode&&(u$j.ctx.globalCompositeOperation=u$b.blendMode);var u$E=this._next;u$E._fun.call(u$E,u$W,u$j,u$t,u$d),u$j.ctx.globalCompositeOperation="source-over"},u$W._mask=function(u$W,u$j,u$t,u$d){var u$b=this._next;u$b._fun.call(u$b,u$W,u$j,u$t,u$d);var u$E=u$W.mask;u$E&&(u$j.ctx.globalCompositeOperation="destination-in",(0<u$E.numChildren||!u$E.graphics._isOnlyOne())&&(u$E.cacheAsBitmap=!0),u$E.render(u$j,u$t-u$W.pivotX,u$d-u$W.pivotY)),u$j.ctx.globalCompositeOperation="source-over"},u$W._graphics=function(u$W,u$j,u$t,u$d){var u$b=u$W._style._tf;u$W._graphics&&u$W._graphics._render(u$W,u$j,u$t-u$b.translateX,u$d-u$b.translateY);var u$E=this._next;u$E._fun.call(u$E,u$W,u$j,u$t,u$d)},u$W._image=function(u$W,u$j,u$t,u$d){var u$b=u$W._style;u$j.ctx.drawTexture2(u$t,u$d,u$b._tf.translateX,u$b._tf.translateY,u$W.transform,u$b.alpha,u$b.blendMode,u$W._graphics._one)},u$W._image2=function(u$W,u$j,u$t,u$d){var u$b=u$W._style._tf;u$j.ctx.drawTexture2(u$t,u$d,u$b.translateX,u$b.translateY,u$W.transform,1,null,u$W._graphics._one)},u$W._alpha=function(u$W,u$j,u$t,u$d){var u$b;if(.01<(u$b=u$W._style.alpha)||u$W._needRepaint()){var u$E=u$j.ctx.globalAlpha;u$j.ctx.globalAlpha*=u$b;var u$O=this._next;u$O._fun.call(u$O,u$W,u$j,u$t,u$d),u$j.ctx.globalAlpha=u$E}},u$W._transform=function(u$W,u$j,u$t,u$d){var u$b=u$W.transform,u$E=this._next;u$b&&u$E!=u$O.NORENDER?(u$j.save(),u$j.transform(u$b.a,u$b.b,u$b.c,u$b.d,u$b.tx+u$t,u$b.ty+u$d),u$E._fun.call(u$E,u$W,u$j,0,0),u$j.restore()):u$E._fun.call(u$E,u$W,u$j,u$t,u$d)},u$W._childs=function(u$W,u$j,u$t,u$d){var u$b=u$W._style,u$E=u$b._tf;if(u$t=u$t-u$E.translateX+u$b.paddingLeft,u$d=u$d-u$E.translateY+u$b.paddingTop,u$b._calculation){var u$O=u$W._getWords();if(u$O){var u$q=u$b;u$q&&(u$q.stroke?u$j.fillBorderWords(u$O,u$t,u$d,u$q.font,u$q.color,u$q.strokeColor,u$q.stroke):u$j.fillWords(u$O,u$t,u$d,u$q.font,u$q.color,"none"!=u$q.textDecoration&&u$q.underLine?1:0))}}var u$A,u$c=u$W._childs,u$R=u$c.length;if(u$W.viewport||u$W.optimizeScrollRect&&u$W._style.scrollRect){var u$m=u$W.viewport||u$W._style.scrollRect,u$Q=u$m.x,u$T=u$m.y,u$$=u$m.right,u$e=u$m.bottom,u$K=NaN,u$o=NaN;for(u$S=0;u$S<u$R;++u$S)(u$A=u$c[u$S]).visible&&(u$K=u$A._x)<u$$&&u$K+u$A.width>u$Q&&(u$o=u$A._y)<u$e&&u$o+u$A.height>u$T&&u$A.render(u$j,u$t,u$d)}else for(var u$S=0;u$S<u$R;++u$S)(u$A=u$c[u$S])._style.visible&&u$A.render(u$j,u$t,u$d)},u$W._canvas=function(u$W,u$j,u$t,u$d){var u$b=u$W._$P.cacheCanvas;if(u$b){"bitmap"===u$b.type?u$P.canvasBitmap++:u$P.canvasNormal++;var u$E=u$b.ctx;if(u$W._needRepaint()||!u$E)this._canvas_repaint(u$W,u$j,u$t,u$d);else{var u$O=u$b._cacheRec;u$j.drawCanvas(u$E.canvas,u$t+u$O.x,u$d+u$O.y,u$O.width,u$O.height)}}else this._next._fun.call(this._next,u$W,u$j,u$t,u$d)},u$W._canvas_repaint=function(u$W,u$j,u$t,u$d){var u$b=u$W._$P.cacheCanvas,u$E=this._next;if(u$b){var u$O,u$q,u$A,u$c,u$R=u$b.ctx,u$m=u$W._needRepaint()||!u$R,u$Q=u$b.type;if("bitmap"===u$Q?u$P.canvasBitmap++:u$P.canvasNormal++,u$m){var u$T,u$$;u$b._cacheRec||(u$b._cacheRec=new u$C),u$y.isWebGL&&"bitmap"!==u$Q?u$b._cacheRec.setTo(-u$W.pivotX,-u$W.pivotY,1,1):((u$c=u$W.getSelfBounds()).x=u$c.x-u$W.pivotX,u$c.y=u$c.y-u$W.pivotY,u$c.x=u$c.x-16,u$c.y=u$c.y-16,u$c.width=u$c.width+32,u$c.height=u$c.height+32,u$c.x=Math.floor(u$c.x+u$t)-u$t,u$c.y=Math.floor(u$c.y+u$d)-u$d,u$c.width=Math.floor(u$c.width),u$c.height=Math.floor(u$c.height),u$b._cacheRec.copyFrom(u$c)),u$c=u$b._cacheRec;var u$e,u$K=u$y.isWebGL?1:u$Y.pixelRatio*u$N.stage.clientScaleX,u$o=u$y.isWebGL?1:u$Y.pixelRatio*u$N.stage.clientScaleY;if(!u$y.isWebGL){var u$S,u$M=1,u$Z=1;for(u$S=u$W;u$S&&u$S!=u$N.stage;)u$M*=u$S.scaleX,u$Z*=u$S.scaleY,u$S=u$S.parent;u$y.isWebGL?(u$M<1&&(u$K*=u$M),u$Z<1&&(u$o*=u$Z)):(1<u$M&&(u$K*=u$M),1<u$Z&&(u$o*=u$Z))}if(u$W.scrollRect){var u$X=u$W.scrollRect;u$c.x-=u$X.x,u$c.y-=u$X.y}if(u$T=u$c.width*u$K,u$$=u$c.height*u$o,u$q=u$c.x,u$A=u$c.y,u$y.isWebGL&&"bitmap"===u$Q&&(2048<u$T||2048<u$$))return console.warn("cache bitmap size larger than 2048,cache ignored"),u$b.ctx&&(u$r.recover("RenderContext",u$b.ctx),u$b.ctx.canvas.size(0,0),u$b.ctx=null),void u$E._fun.call(u$E,u$W,u$j,u$t,u$d);if(u$R||(u$R=u$b.ctx=u$r.getItem("RenderContext")||new u$a(u$T,u$$,u$MW.create("AUTO"))),u$R.ctx.sprite=u$W,(u$O=u$R.canvas).clear(),(u$O.width!=u$T||u$O.height!=u$$)&&u$O.size(u$T,u$$),"bitmap"===u$Q?u$O.context.asBitmap=!0:"normal"===u$Q&&(u$O.context.asBitmap=!1),1!=u$K||1!=u$o){var u$_=u$R.ctx;u$_.save(),u$_.scale(u$K,u$o),!u$y.isConchWebGL&&u$y.isConchApp&&(u$e=u$W._$P.cf)&&u$_.setFilterMatrix&&u$_.setFilterMatrix(u$e._mat,u$e._alpha),u$E._fun.call(u$E,u$W,u$R,-u$q,-u$A),u$_.restore(),u$y.isConchApp&&!u$y.isConchWebGL||u$W._applyFilters()}else u$_=u$R.ctx,!u$y.isConchWebGL&&u$y.isConchApp&&(u$e=u$W._$P.cf)&&u$_.setFilterMatrix&&u$_.setFilterMatrix(u$e._mat,u$e._alpha),u$E._fun.call(u$E,u$W,u$R,-u$q,-u$A),u$y.isConchApp&&!u$y.isConchWebGL||u$W._applyFilters();u$W._$P.staticCache&&(u$b.reCache=!1),u$P.canvasReCache++}else u$q=(u$c=u$b._cacheRec).x,u$A=u$c.y,u$O=u$R.canvas;u$j.drawCanvas(u$O,u$t+u$q,u$d+u$A,u$c.width,u$c.height)}else u$E._fun.call(u$E,u$W,u$R,u$t,u$d)},u$O.__init__=function(){var u$W,u$j,u$t=0;for(u$j=u$G.createRenderSprite(69905,null),u$W=u$O.renders.length=4096,u$t=0;u$t<u$W;u$t++)u$O.renders[u$t]=u$j;u$O.renders[0]=u$G.createRenderSprite(0,null),function(u$W,u$j){for(var u$t=0,u$d=0;u$d<u$W.length;u$d++)u$t|=u$W[u$d],u$O.renders[u$t]=u$j}([1,512,4,2],new u$O(1,null)),u$O.renders[513]=u$G.createRenderSprite(513,null),u$O.renders[517]=new u$O(517,null)},u$O._initRenderFun=function(u$W,u$j,u$t,u$d){var u$b=u$W._renderType;(u$O.renders[u$b]=u$O._getTypeRender(u$b))._fun(u$W,u$j,u$t,u$d)},u$O._getTypeRender=function(u$W){for(var u$j=null,u$t=2048;1<u$t;)u$t&u$W&&(u$j=u$G.createRenderSprite(u$t,u$j)),u$t>>=1;return u$j},u$O.IMAGE=1,u$O.ALPHA=2,u$O.TRANSFORM=4,u$O.BLEND=8,u$O.CANVAS=16,u$O.FILTERS=32,u$O.MASK=64,u$O.CLIP=128,u$O.STYLE=256,u$O.GRAPHICS=512,u$O.CUSTOM=1024,u$O.CHILDS=2048,u$O.INIT=69905,u$O.renders=[],u$O.NORENDER=new u$O(0,null),u$O}(),u$D=function(){function u$q(){this._repaint=!1}u$R(u$q,"laya.resource.Context");var u$W=u$q.prototype;return u$W.replaceReset=function(){var u$W,u$j,u$t=0;for(u$W=u$q.replaceKeys.length,u$t=0;u$t<u$W;u$t++)u$j=u$q.replaceKeys[u$t],this[u$q.newKeys[u$t]]=this[u$j]},u$W.replaceResotre=function(){this.__restore(),this.__reset()},u$W.setIsMainContext=function(){},u$W.drawTextures=function(u$W,u$j,u$t,u$d){u$P.drawCall+=u$j.length/2;for(var u$b=u$W.width,u$E=u$W.height,u$O=0,u$q=u$j.length;u$O<u$q;u$O+=2)this.drawTexture(u$W,u$j[u$O],u$j[u$O+1],u$b,u$E,u$t,u$d)},u$W.drawCanvas=function(u$W,u$j,u$t,u$d,u$b){u$P.drawCall++,this.drawImage(u$W.source,u$j,u$t,u$d,u$b)},u$W.fillRect=function(u$W,u$j,u$t,u$d,u$b){u$P.drawCall++,u$b&&(this.fillStyle=u$b),this.__fillRect(u$W,u$j,u$t,u$d)},u$W.fillText=function(u$W,u$j,u$t,u$d,u$b,u$E){u$P.drawCall++,3<arguments.length&&null!=u$d&&(this.font=u$d,this.fillStyle=u$b,this.textAlign=u$E,this.textBaseline="top"),this.__fillText(u$W,u$j,u$t)},u$W.fillBorderText=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){u$P.drawCall++,this.font=u$d,this.fillStyle=u$b,this.textBaseline="top",this.strokeStyle=u$E,this.lineWidth=u$O,this.textAlign=u$q,this.__strokeText(u$W,u$j,u$t),this.__fillText(u$W,u$j,u$t)},u$W.strokeText=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){u$P.drawCall++,3<arguments.length&&null!=u$d&&(this.font=u$d,this.strokeStyle=u$b,this.lineWidth=u$E,this.textAlign=u$O,this.textBaseline="top"),this.__strokeText(u$W,u$j,u$t)},u$W.transformByMatrix=function(u$W){this.transform(u$W.a,u$W.b,u$W.c,u$W.d,u$W.tx,u$W.ty)},u$W.setTransformByMatrix=function(u$W){this.setTransform(u$W.a,u$W.b,u$W.c,u$W.d,u$W.tx,u$W.ty)},u$W.clipRect=function(u$W,u$j,u$t,u$d){u$P.drawCall++,this.beginPath(),this.rect(u$W,u$j,u$t,u$d),this.clip()},u$W.drawTexture=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){u$P.drawCall++;var u$q=u$W.uv,u$A=u$W.bitmap.width,u$c=u$W.bitmap.height;this.drawImage(u$W.source,u$q[0]*u$A,u$q[1]*u$c,(u$q[2]-u$q[0])*u$A,(u$q[5]-u$q[3])*u$c,u$j+u$E,u$t+u$O,u$d,u$b)},u$W.drawTextureWithTransform=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){u$P.drawCall++;var u$c=u$W.uv,u$R=u$W.bitmap.width,u$m=u$W.bitmap.height;this.save(),1!=u$A&&(this.globalAlpha*=u$A),u$E?(this.transform(u$E.a,u$E.b,u$E.c,u$E.d,u$E.tx+u$O,u$E.ty+u$q),this.drawImage(u$W.source,u$c[0]*u$R,u$c[1]*u$m,(u$c[2]-u$c[0])*u$R,(u$c[5]-u$c[3])*u$m,u$j,u$t,u$d,u$b)):this.drawImage(u$W.source,u$c[0]*u$R,u$c[1]*u$m,(u$c[2]-u$c[0])*u$R,(u$c[5]-u$c[3])*u$m,u$j+u$O,u$t+u$q,u$d,u$b),this.restore()},u$W.drawTexture2=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){var u$A=u$q[0];if(u$A.loaded&&u$A.bitmap&&u$A.source){u$P.drawCall++;var u$c=1!==u$E;if(u$c){var u$R=this.globalAlpha;this.globalAlpha*=u$E}var u$m=u$A.uv,u$Q=u$A.bitmap.width,u$T=u$A.bitmap.height;u$b?(this.save(),this.transform(u$b.a,u$b.b,u$b.c,u$b.d,u$b.tx+u$W,u$b.ty+u$j),this.drawImage(u$A.source,u$m[0]*u$Q,u$m[1]*u$T,(u$m[2]-u$m[0])*u$Q,(u$m[5]-u$m[3])*u$T,u$q[1]-u$t,u$q[2]-u$d,u$q[3],u$q[4]),this.restore()):this.drawImage(u$A.source,u$m[0]*u$Q,u$m[1]*u$T,(u$m[2]-u$m[0])*u$Q,(u$m[5]-u$m[3])*u$T,u$q[1]-u$t+u$W,u$q[2]-u$d+u$j,u$q[3],u$q[4]),u$c&&(this.globalAlpha=u$R)}},u$W.fillTexture=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){if(!u$q.pat){if(u$W.uv!=u$RW.DEF_UV){var u$A=new u$MW("2D");u$A.getContext("2d"),u$A.size(u$W.width,u$W.height),u$A.context.drawTexture(u$W,0,0,u$W.width,u$W.height,0,0),u$W=new u$RW(u$A)}u$q.pat=this.createPattern(u$W.bitmap.source,u$E)}var u$c=u$j,u$R=u$t,u$m=0,u$Q=0;u$O&&(u$c+=u$O.x%u$W.width,u$R+=u$O.y%u$W.height,u$m-=u$O.x%u$W.width,u$Q-=u$O.y%u$W.height),this.translate(u$c,u$R),this.fillRect(u$m,u$Q,u$d,u$b,u$q.pat),this.translate(-u$c,-u$R)},u$W.drawTriangle=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){var u$A=u$W.bitmap,u$c=u$A.source,u$R=u$W.width,u$m=u$W.height,u$Q=u$A.width,u$T=u$A.height,u$$=u$t[u$d]*u$Q,u$e=u$t[u$b]*u$Q,u$K=u$t[u$E]*u$Q,u$o=u$t[u$d+1]*u$T,u$S=u$t[u$b+1]*u$T,u$M=u$t[u$E+1]*u$T,u$Z=u$j[u$d],u$X=u$j[u$b],u$_=u$j[u$E],u$N=u$j[u$d+1],u$z=u$j[u$b+1],u$C=u$j[u$E+1];if(u$q){var u$L=(u$Z+u$X+u$_)/3,u$V=(u$N+u$z+u$C)/3,u$x=u$Z-u$L,u$G=u$N-u$V,u$l=Math.sqrt(u$x*u$x+u$G*u$G);u$Z=u$L+u$x/u$l*(u$l+1),u$N=u$V+u$G/u$l*(u$l+1),u$G=u$z-u$V,u$X=u$L+(u$x=u$X-u$L)/(u$l=Math.sqrt(u$x*u$x+u$G*u$G))*(u$l+1),u$z=u$V+u$G/u$l*(u$l+1),u$G=u$C-u$V,u$_=u$L+(u$x=u$_-u$L)/(u$l=Math.sqrt(u$x*u$x+u$G*u$G))*(u$l+1),u$C=u$V+u$G/u$l*(u$l+1)}this.save(),u$O&&this.transform(u$O.a,u$O.b,u$O.c,u$O.d,u$O.tx,u$O.ty),this.beginPath(),this.moveTo(u$Z,u$N),this.lineTo(u$X,u$z),this.lineTo(u$_,u$C),this.closePath(),this.clip();var u$h=1/(u$$*u$S+u$o*u$K+u$e*u$M-u$S*u$K-u$o*u$e-u$$*u$M),u$v=u$Z*u$S+u$o*u$_+u$X*u$M-u$S*u$_-u$o*u$X-u$Z*u$M,u$y=u$$*u$X+u$Z*u$K+u$e*u$_-u$X*u$K-u$Z*u$e-u$$*u$_,u$a=u$$*u$S*u$_+u$o*u$X*u$K+u$Z*u$e*u$M-u$Z*u$S*u$K-u$o*u$e*u$_-u$$*u$X*u$M,u$u=u$N*u$S+u$o*u$C+u$z*u$M-u$S*u$C-u$o*u$z-u$N*u$M,u$D=u$$*u$z+u$N*u$K+u$e*u$C-u$z*u$K-u$N*u$e-u$$*u$C,u$s=u$$*u$S*u$C+u$o*u$z*u$K+u$N*u$e*u$M-u$N*u$S*u$K-u$o*u$e*u$C-u$$*u$z*u$M;this.transform(u$v*u$h,u$u*u$h,u$y*u$h,u$D*u$h,u$a*u$h,u$s*u$h),this.drawImage(u$c,u$W.uv[0]*u$Q,u$W.uv[1]*u$T,u$R,u$m,u$W.uv[0]*u$Q,u$W.uv[1]*u$T,u$R,u$m),this.restore()},u$W.flush=function(){return 0},u$W.fillWords=function(u$W,u$j,u$t,u$d,u$b,u$E){u$d&&(this.font=u$d),u$b&&(this.fillStyle=u$b);this.textBaseline="top",this.textAlign="left";for(var u$O=0,u$q=u$W.length;u$O<u$q;u$O++){var u$A=u$W[u$O];if(this.__fillText(u$A.char,u$A.x+u$j,u$A.y+u$t),1===u$E){var u$c=u$A.height,u$R=.5*u$A.style.letterSpacing;u$R||(u$R=0),this.beginPath(),this.strokeStyle=u$b,this.lineWidth=1,this.moveTo(u$j+u$A.x-u$R+.5,u$t+u$A.y+u$c+.5),this.lineTo(u$j+u$A.x+u$A.width+u$R+.5,u$t+u$A.y+u$c+.5),this.stroke()}}},u$W.fillBorderWords=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){u$d&&(this.font=u$d),u$b&&(this.fillStyle=u$b),this.textBaseline="top",this.lineWidth=u$O,this.textAlign="left",this.strokeStyle=u$E;for(var u$q=0,u$A=u$W.length;u$q<u$A;u$q++){var u$c=u$W[u$q];this.__strokeText(u$c.char,u$c.x+u$j,u$c.y+u$t),this.__fillText(u$c.char,u$c.x+u$j,u$c.y+u$t)}},u$W.destroy=function(){this.canvas.width=this.canvas.height=0},u$W.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},u$W.drawCurves=function(u$W,u$j,u$t){this.beginPath(),this.strokeStyle=u$t[3],this.lineWidth=u$t[4];var u$d=u$t[2];u$W+=u$t[0],u$j+=u$t[1],this.moveTo(u$W+u$d[0],u$j+u$d[1]);for(var u$b=2,u$E=u$d.length;u$b<u$E;)this.quadraticCurveTo(u$W+u$d[u$b++],u$j+u$d[u$b++],u$W+u$d[u$b++],u$j+u$d[u$b++]);this.stroke()},u$q.__init__=function(u$j){var u$t=laya.resource.Context.prototype;if(!(u$j=u$j||CanvasRenderingContext2D.prototype).inited){u$j.inited=!0,u$j.__fillText=u$j.fillText,u$j.__fillRect=u$j.fillRect,u$j.__strokeText=u$j.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(u$W){u$j[u$W]=u$t[u$W]})}},u$q.replaceCanvasGetSet=function(u$W,u$j){var u$t=Object.getOwnPropertyDescriptor(u$W,u$j);if(!u$t||!u$t.configurable)return!1;var u$d,u$b={};for(u$d in u$t)"set"!=u$d&&(u$b[u$d]=u$t[u$d]);var u$E=u$t.set;return u$b.set=function(u$W){u$E.call(this,u$W);var u$j=this.getContext("2d");u$j&&"__reset"in u$j&&u$j.__reset()},Object.defineProperty(u$W,u$j,u$b),!0},u$q.replaceGetSet=function(u$W,u$j){var u$t=Object.getOwnPropertyDescriptor(u$W,u$j);if(!u$t||!u$t.configurable)return!1;var u$d,u$b={};for(u$d in u$t)"set"!=u$d&&(u$b[u$d]=u$t[u$d]);var u$E=u$t.set,u$O="___"+u$j+"__";return u$q.newKeys.push(u$O),u$b.set=function(u$W){u$W!=this[u$O]&&(this[u$O]=u$W,u$E.call(this,u$W))},Object.defineProperty(u$W,u$j,u$b),!0},u$q._default=new u$q,u$q.newKeys=[],u$A(u$q,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),u$q}(),u$s=function(){function u$E(u$W){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++u$E._uniqueIDCounter,this._name=u$W||"Content Manager",u$E._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,u$E._resourceManagers.push(this),this._resources=[],this._records={}}u$R(u$E,"laya.resource.ResourceManager");var u$W=u$E.prototype;return u$N.imps(u$W,{"laya.resource.IDispose":!0}),u$W.getResourceByIndex=function(u$W){return this._resources[u$W]},u$W.getResourcesLength=function(){return this._resources.length},u$W.addResource=function(u$W){return u$W.resourceManager&&u$W.resourceManager.removeResource(u$W),-1===this._resources.indexOf(u$W)&&((u$W._resourceManager=this)._resources.push(u$W),this.addRecord(u$W.uri,u$W.__className,u$W.memorySize),this.addSize(u$W.memorySize),!0)},u$W.removeResource=function(u$W){var u$j=this._resources.indexOf(u$W);return-1!==u$j&&(this._resources.splice(u$j,1),u$W._resourceManager=null,this._memorySize-=u$W.memorySize,this.addRecord(u$W.uri,u$W.__className,-u$W.memorySize),!0)},u$W.unload=function(){for(var u$W=this._resources.slice(0,this._resources.length),u$j=0;u$j<u$W.length;u$j++){u$W[u$j].destroy()}u$W.length=0},u$W.dispose=function(){if(this===u$E._systemResourceManager)throw new Error("systemResourceManager不能被释放！");u$E._resourceManagers.splice(u$E._resourceManagers.indexOf(this),1),u$E._isResourceManagersSorted=!1;for(var u$W=this._resources.slice(0,this._resources.length),u$j=0;u$j<u$W.length;u$j++){var u$t=u$W[u$j];u$t.resourceManager.removeResource(u$t),u$t.destroy()}u$W.length=0},u$W.addSize=function(u$W){u$W&&(this.autoRelease&&0<u$W&&this._memorySize+u$W>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=u$W)},u$W.addRecord=function(u$W,u$j,u$t){DEBUG&&u$t&&!u$W&&console.error(u$W,u$j,u$t),u$W&&(this._records.hasOwnProperty(u$j+"|"+u$W)||(this._records[u$j+"|"+u$W]=0),this._records[u$j+"|"+u$W]+=u$t,DEBUG&&this._records[u$j+"|"+u$W]<0&&console.error(u$W,u$j,this._records[u$j+"|"+u$W]))},u$W.garbageCollection=function(u$W){var u$j=this._resources;(u$j=u$j.slice()).sort(function(u$W,u$j){if(!u$W||!u$j)throw new Error("a或b不能为空！");return u$W.released&&u$j.released?0:u$W.released?1:u$j.released?-1:u$W._lastUseFrameCount-u$j._lastUseFrameCount});for(var u$t=u$P.loopCount,u$d=0,u$b=u$j.length;u$d<u$b;u$d++){var u$E=u$j[u$d];if(!(1<u$t-u$E._lastUseFrameCount))return void(this._memorySize>=u$W&&(this._isOverflow=!0));if(u$E.releaseResource(),this._memorySize<u$W)return void(this._isOverflow=!1)}},u$$(0,u$W,"id",function(){return this._id}),u$$(0,u$W,"name",function(){return this._name},function(u$W){!u$W&&""===u$W||this._name===u$W||(this._name=u$W,u$E._isResourceManagersSorted=!1)}),u$$(0,u$W,"memorySize",function(){return this._memorySize}),u$$(0,u$W,"records",function(){return this._records}),u$$(1,u$E,"systemResourceManager",function(){return u$E._systemResourceManager}),u$E.__init__=function(){u$E.currentResourceManager=u$E.systemResourceManager},u$E.getLoadedResourceManagerByIndex=function(u$W){return u$E._resourceManagers[u$W]},u$E.getLoadedResourceManagersCount=function(){return u$E._resourceManagers.length},u$E.recreateContentManagers=function(u$W){void 0===u$W&&(u$W=!1);for(var u$j=u$E.currentResourceManager,u$t=0;u$t<u$E._resourceManagers.length;u$t++){u$E.currentResourceManager=u$E._resourceManagers[u$t];for(var u$d=0;u$d<u$E.currentResourceManager._resources.length;u$d++)u$E.currentResourceManager._resources[u$d].releaseResource(u$W),u$E.currentResourceManager._resources[u$d].activeResource(u$W)}u$E.currentResourceManager=u$j},u$E.releaseContentManagers=function(u$W){void 0===u$W&&(u$W=!1);for(var u$j=u$E.currentResourceManager,u$t=0;u$t<u$E._resourceManagers.length;u$t++){u$E.currentResourceManager=u$E._resourceManagers[u$t];for(var u$d=0;u$d<u$E.currentResourceManager._resources.length;u$d++){var u$b=u$E.currentResourceManager._resources[u$d];!u$b.released&&u$b.releaseResource(u$W)}}u$E.currentResourceManager=u$j},u$E._uniqueIDCounter=0,u$E._isResourceManagersSorted=!1,u$E._resourceManagers=[],u$A(u$E,["_systemResourceManager",function(){return this._systemResourceManager=new u$E("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=u$E._systemResourceManager}]),u$E}(),u$Y=(function(){function u$W(){}u$R(u$W,"laya.system.System"),u$W.changeDefinition=function(u$W,u$j){u$N[u$W]=u$j;var u$t=u$W+"=classObj";u$N._runScript(u$t)},u$W.__init__=function(){u$y.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function u$t(){}return u$R(u$t,"laya.utils.Browser"),u$$(1,u$t,"pixelRatio",function(){return u$t.__init__(),-1<u$t.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:u$G.getPixelRatio()}),u$$(1,u$t,"height",function(){return u$t.__init__(),(u$N.stage&&u$N.stage.canvasRotation?u$t.clientWidth:u$t.clientHeight)*u$t.pixelRatio}),u$$(1,u$t,"clientWidth",function(){return u$t.__init__(),u$t.window.innerWidth||u$t.document.body.clientWidth}),u$$(1,u$t,"window",function(){return u$t.__init__(),u$t._window}),u$$(1,u$t,"clientHeight",function(){return u$t.__init__(),u$t.window.innerHeight||u$t.document.body.clientHeight||u$t.document.documentElement.clientHeight}),u$$(1,u$t,"width",function(){return u$t.__init__(),(u$N.stage&&u$N.stage.canvasRotation?u$t.clientHeight:u$t.clientWidth)*u$t.pixelRatio}),u$$(1,u$t,"container",function(){return u$t.__init__(),u$t._container||((u$t._container=u$t.createElement("div")).id="layaContainer",u$t.document.body.appendChild(u$t._container)),u$t._container},function(u$W){u$t._container=u$W}),u$$(1,u$t,"document",function(){return u$t.__init__(),u$t._document}),u$t.__init__=function(){if(!u$t._window){u$t._window=u$G.getWindow(),u$t._document=u$t.window.document,u$t._window.addEventListener("message",function(u$W){laya.utils.Browser._onMessage(u$W)},!1),u$t.document.__createElement=u$t.document.createElement,u$O.requestAnimationFrame=u$O.requestAnimationFrame||u$O.webkitRequestAnimationFrame||u$O.mozRequestAnimationFrame||u$O.oRequestAnimationFrame||u$O.msRequestAnimationFrame||function(u$W){return u$O.setTimeout(u$W,1e3/60)};var u$W=u$O.document.body.style;u$W["-webkit-user-select"]="none",u$W["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",u$t.userAgent=u$t.window.navigator.userAgent,u$t.onIOS=!!(u$t.u=u$t.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),u$t.onMobile=-1<u$t.u.indexOf("Mobile"),u$t.onIPhone=-1<u$t.u.indexOf("iPhone"),u$t.onMac=-1<u$t.u.indexOf("Mac OS X"),u$t.onIPad=-1<u$t.u.indexOf("iPad"),u$t.onAndroid=-1<u$t.u.indexOf("Android")||-1<u$t.u.indexOf("Adr"),u$t.onWP=-1<u$t.u.indexOf("Windows Phone"),u$t.onQQBrowser=-1<u$t.u.indexOf("QQBrowser"),u$t.onMQQBrowser=-1<u$t.u.indexOf("MQQBrowser")||-1<u$t.u.indexOf("Mobile")&&-1<u$t.u.indexOf("QQ"),u$t.onIE=!!u$t.window.ActiveXObject||"ActiveXObject"in u$t.window,u$t.onWeiXin=-1<u$t.u.indexOf("MicroMessenger"),u$t.onPC=!u$t.onMobile,u$t.onSafari=-1<u$t.u.indexOf("Safari"),u$t.onFirefox=-1<u$t.u.indexOf("Firefox"),u$t.onEdge=-1<u$t.u.indexOf("Edge"),u$t.onMiniGame=-1<u$t.u.indexOf("MiniGame"),u$t.onLimixiu=-1<u$t.u.indexOf("limixiu"),u$t.httpProtocol="http:"==u$t.window.location.protocol,u$t.onMiniGame&&null==u$t.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),u$t.webAudioEnabled=!!(u$t.window.AudioContext||u$t.window.webkitAudioContext||u$t.window.mozAudioContext),u$t.soundType=u$t.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",u$bW=u$t.webAudioEnabled?u$EW:u$tW,u$t.webAudioEnabled&&u$EW.initWebAudio(),u$tW._initMusicAudio(),u$t.enableTouch="ontouchstart"in u$O||u$O.DocumentTouch&&u$j instanceof DocumentTouch,u$O.focus(),u$x._soundClass=u$bW,u$x._musicClass=u$tW,u$y._mainCanvas=u$y._mainCanvas||u$MW.create("2D"),u$t.canvas||(u$t.canvas=u$MW.create("2D"),u$t.context=u$t.canvas.getContext("2d"))}},u$t._onMessage=function(u$W){if(u$W.data&&"size"==u$W.data.name){if(u$t.window.innerWidth=u$W.data.width,u$t.window.innerHeight=u$W.data.height,u$t.window.__innerHeight=u$W.data.clientHeight,!u$t.document.createEvent)return void console.warn("no document.createEvent");var u$j=u$t.document.createEvent("HTMLEvents");return u$j.initEvent("resize",!1,!1),void u$t.window.dispatchEvent(u$j)}},u$t.createElement=function(u$W){return u$t.__init__(),u$t.document.__createElement(u$W)},u$t.getElementById=function(u$W){return u$t.__init__(),u$t.document.getElementById(u$W)},u$t.removeElement=function(u$W){u$W&&u$W.parentNode&&u$W.parentNode.removeChild(u$W)},u$t.now=function(){return u$G.now()},u$t._window=null,u$t._document=null,u$t._container=null,u$t.userAgent=null,u$t.u=null,u$t.onIOS=!1,u$t.onMac=!1,u$t.onMobile=!1,u$t.onIPhone=!1,u$t.onIPad=!1,u$t.onAndroid=!1,u$t.onWP=!1,u$t.onQQBrowser=!1,u$t.onMQQBrowser=!1,u$t.onSafari=!1,u$t.onFirefox=!1,u$t.onEdge=!1,u$t.onIE=!1,u$t.onWeiXin=!1,u$t.onMiniGame=!1,u$t.onLimixiu=!1,u$t.onPC=!1,u$t.httpProtocol=!1,u$t.webAudioEnabled=!1,u$t.soundType=null,u$t.enableTouch=!1,u$t.canvas=null,u$t.context=null,u$t.__init$=function(){},u$t}()),u$H=function(){function u$j(u$W){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,u$W?(this._u8d_=new Uint8Array(u$W),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}u$R(u$j,"laya.utils.Byte");var u$W=u$j.prototype;return u$W.___resizeBuffer=function(u$j){try{var u$W=new Uint8Array(u$j);null!=this._u8d_&&(this._u8d_.length<=u$j?u$W.set(this._u8d_):u$W.set(this._u8d_.subarray(0,u$j))),this._u8d_=u$W,this._d_=new DataView(u$W.buffer)}catch(u$W){throw"___resizeBuffer err:"+u$j}},u$W.getString=function(){return this.rUTF(this.getUint16())},u$W.getFloat32Array=function(u$W,u$j){var u$t=u$W+u$j;u$t=u$t>this._length?this._length:u$t;var u$d=new Float32Array(this._d_.buffer.slice(u$W,u$t));return this._pos_=u$t,u$d},u$W.getUint8Array=function(u$W,u$j){var u$t=u$W+u$j;u$t=u$t>this._length?this._length:u$t;var u$d=new Uint8Array(this._d_.buffer.slice(u$W,u$t));return this._pos_=u$t,u$d},u$W.getInt16Array=function(u$W,u$j){var u$t=u$W+u$j;u$t=u$t>this._length?this._length:u$t;var u$d=new Int16Array(this._d_.buffer.slice(u$W,u$t));return this._pos_=u$t,u$d},u$W.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var u$W=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,u$W},u$W.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var u$W=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,u$W},u$W.writeFloat32=function(u$W){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,u$W,this._xd_),this._pos_+=4},u$W.writeFloat64=function(u$W){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,u$W,this._xd_),this._pos_+=8},u$W.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var u$W=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,u$W},u$W.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var u$W=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,u$W},u$W.writeInt32=function(u$W){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,u$W,this._xd_),this._pos_+=4},u$W.writeUint32=function(u$W){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,u$W,this._xd_),this._pos_+=4},u$W.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var u$W=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,u$W},u$W.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var u$W=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,u$W},u$W.writeUint16=function(u$W){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,u$W,this._xd_),this._pos_+=2},u$W.writeInt16=function(u$W){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,u$W,this._xd_),this._pos_+=2},u$W.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},u$W.writeUint8=function(u$W){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,u$W),this._pos_++},u$W._getUInt8=function(u$W){return this._d_.getUint8(u$W)},u$W._getUint16=function(u$W){return this._d_.getUint16(u$W,this._xd_)},u$W._getMatrix=function(){return new u$l(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},u$W.rUTF=function(u$W){for(var u$j=[],u$t=this._pos_+u$W,u$d=0,u$b=0,u$E=0,u$O=String.fromCharCode,u$q=this._u8d_;this._pos_<u$t;)(u$d=u$q[this._pos_++])<128?0!=u$d&&u$j.push(u$O(u$d)):u$d<224?u$j.push(u$O((63&u$d)<<6|127&u$q[this._pos_++])):u$d<240?(u$b=u$q[this._pos_++],u$j.push(u$O((31&u$d)<<12|(127&u$b)<<6|127&u$q[this._pos_++]))):(u$b=u$q[this._pos_++],u$E=u$q[this._pos_++],u$j.push(u$O((15&u$d)<<18|(127&u$b)<<12|u$E<<6&127|127&u$q[this._pos_++]))),0;return u$j.join("")},u$W.getCustomString=function(u$W){for(var u$j=[],u$t=0,u$d=0,u$b=0,u$E=String.fromCharCode,u$O=this._u8d_;0<u$W;)if((u$d=u$O[this._pos_])<128)u$j.push(u$E(u$d)),this._pos_++,u$W--;else for(u$t=u$d-128,this._pos_++,u$W-=u$t;0<u$t;)u$d=u$O[this._pos_++],u$b=u$O[this._pos_++],u$j.push(u$E(u$b<<8|u$d)),u$t--;return u$j.join("")},u$W.clear=function(){this._pos_=0,this.length=0},u$W.__getBuffer=function(){return this._d_.buffer},u$W.writeUTFBytes=function(u$W){for(var u$j=0,u$t=(u$W+="").length;u$j<u$t;u$j++){var u$d=u$W.charCodeAt(u$j);u$d<=127?this.writeByte(u$d):u$d<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|u$d>>6,128|63&u$d],this._pos_),this._pos_+=2):u$d<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|u$d>>12,128|u$d>>6&63,128|63&u$d],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|u$d>>18,128|u$d>>12&63,128|u$d>>6&63,128|63&u$d],this._pos_),this._pos_+=4)}},u$W.writeUTFString=function(u$W){var u$j=this.pos;this.writeUint16(1),this.writeUTFBytes(u$W);var u$t=this.pos-u$j-2;if(65536<=u$t)throw"writeUTFString byte len more than 65536";this._d_.setUint16(u$j,u$t,this._xd_)},u$W.readUTFString=function(){return this.readUTFBytes(this.getUint16())},u$W.getUTFString=function(){return this.readUTFString()},u$W.readUTFBytes=function(u$W){if(void 0===u$W&&(u$W=-1),0==u$W)return"";var u$j=this.bytesAvailable;if(u$j<u$W)throw"readUTFBytes error - Out of bounds";return u$W=0<u$W?u$W:u$j,this.rUTF(u$W)},u$W.getUTFBytes=function(u$W){return void 0===u$W&&(u$W=-1),this.readUTFBytes(u$W)},u$W.writeByte=function(u$W){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,u$W),this._pos_+=1},u$W.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},u$W.getByte=function(){return this.readByte()},u$W.ensureWrite=function(u$W){this._length<u$W&&(this._length=u$W),this._allocated_<u$W&&(this.length=u$W)},u$W.writeArrayBuffer=function(u$W,u$j,u$t){if(void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),u$j<0||u$t<0)throw"writeArrayBuffer error - Out of bounds";0==u$t&&(u$t=u$W.byteLength-u$j),this.ensureWrite(this._pos_+u$t);var u$d=new Uint8Array(u$W);this._u8d_.set(u$d.subarray(u$j,u$j+u$t),this._pos_),this._pos_+=u$t},u$$(0,u$W,"buffer",function(){var u$W=this._d_.buffer;return u$W.byteLength==this.length?u$W:u$W.slice(0,this.length)}),u$$(0,u$W,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(u$W){this._xd_="littleEndian"==u$W}),u$$(0,u$W,"length",function(){return this._length},function(u$W){this._allocated_<u$W?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(u$W,2*this._allocated_))):this._allocated_>u$W&&this.___resizeBuffer(this._allocated_=u$W),this._length=u$W}),u$$(0,u$W,"pos",function(){return this._pos_},function(u$W){this._pos_=u$W}),u$$(0,u$W,"bytesAvailable",function(){return this._length-this._pos_}),u$j.getSystemEndian=function(){if(!u$j._sysEndian){var u$W=new ArrayBuffer(2);new DataView(u$W).setInt16(0,256,!0),u$j._sysEndian=256===new Int16Array(u$W)[0]?"littleEndian":"bigEndian"}return u$j._sysEndian},u$j.BIG_ENDIAN="bigEndian",u$j.LITTLE_ENDIAN="littleEndian",u$j._sysEndian=null,u$j}(),u$I=function(){function u$b(){}return u$R(u$b,"laya.utils.CacheManager"),u$b.regCacheByFunction=function(u$W,u$j){var u$t;u$b.unRegCacheByFunction(u$W,u$j),u$t={tryDispose:u$W,getCacheList:u$j},u$b._cacheList.push(u$t)},u$b.unRegCacheByFunction=function(u$W,u$j){var u$t,u$d=0;for(u$t=u$b._cacheList.length,u$d=0;u$d<u$t;u$d++)if(u$b._cacheList[u$d].tryDispose==u$W&&u$b._cacheList[u$d].getCacheList==u$j)return void u$b._cacheList.splice(u$d,1)},u$b.forceDispose=function(){var u$W=0,u$j=u$b._cacheList.length;for(u$W=0;u$W<u$j;u$W++)u$b._cacheList[u$W].tryDispose(!0)},u$b.beginCheck=function(u$W){void 0===u$W&&(u$W=15e3),u$N.timer.loop(u$W,null,u$b._checkLoop)},u$b.stopCheck=function(){u$N.timer.clear(null,u$b._checkLoop)},u$b._checkLoop=function(){var u$W=u$b._cacheList;if(!(u$W.length<1)){var u$j,u$t=u$Y.now(),u$d=0;for(u$j=u$d=u$W.length;0<u$d&&(u$W[u$b._index=++u$b._index%u$j].tryDispose(!1),!(u$Y.now()-u$t>u$b.loopTimeLimit));)u$d--}},u$b.loopTimeLimit=2,u$b._cacheList=[],u$b._index=0,u$b}(),u$g=function(){function u$T(){}return u$R(u$T,"laya.utils.ClassUtils"),u$T.regClass=function(u$W,u$j){u$T._classMap[u$W]=u$j},u$T.getRegClass=function(u$W){return u$T._classMap[u$W]},u$T.getInstance=function(u$W){var u$j=u$T.getClass(u$W);return u$j?new u$j:(console.warn("[error] Undefined class:",u$W),null)},u$T.createByJson=function(u$W,u$j,u$t,u$d,u$b){"string"==typeof u$W&&(u$W=JSON.parse(u$W));var u$E=u$W.props;if(!u$j&&!(u$j=u$b?u$b.runWith(u$W):u$T.getInstance(u$E.runtime||u$W.type)))return null;var u$O=u$W.child;if(u$O)for(var u$q=0,u$A=u$O.length;u$q<u$A;u$q++){var u$c=u$O[u$q];if("render"!==u$c.props.name&&"render"!==u$c.props.renderType||!u$j._$set_itemRender)if("Graphic"==u$c.type)u$T.addGraphicsToSprite(u$c,u$j);else if(u$T.isDrawType(u$c.type))u$T.addGraphicToSprite(u$c,u$j,!0);else{var u$R=u$T.createByJson(u$c,null,u$t,u$d,u$b);"Script"==u$c.type?u$R.hasOwnProperty("owner")?u$R.owner=u$j:u$R.hasOwnProperty("target")&&(u$R.target=u$j):"mask"==u$c.props.renderType?u$j.mask=u$R:u$j.addChild(u$R)}else u$j.itemRender=u$c}if(u$E)for(var u$m in u$E){var u$Q=u$E[u$m];"var"===u$m&&u$t?u$t[u$Q]=u$j:u$Q instanceof Array&&"function"==typeof u$j[u$m]?u$j[u$m].apply(u$j,u$Q):u$j[u$m]=u$Q}return u$d&&u$W.customProps&&u$d.runWith([u$j,u$W]),u$j.created&&u$j.created(),u$j},u$T.addGraphicsToSprite=function(u$W,u$j){var u$t;if((u$t=u$W.child)&&!(u$t.length<1)){var u$d;u$d=u$T._getGraphicsFromSprite(u$W,u$j);var u$b=0,u$E=0;u$W.props&&(u$b=u$T._getObjVar(u$W.props,"x",0),u$E=u$T._getObjVar(u$W.props,"y",0)),0!=u$b&&0!=u$E&&u$d.translate(u$b,u$E);var u$O,u$q=0;for(u$O=u$t.length,u$q=0;u$q<u$O;u$q++)u$T._addGraphicToGraphics(u$t[u$q],u$d);0!=u$b&&0!=u$E&&u$d.translate(-u$b,-u$E)}},u$T.addGraphicToSprite=function(u$W,u$j,u$t){var u$d;void 0===u$t&&(u$t=!1),u$d=u$t?u$T._getGraphicsFromSprite(u$W,u$j):u$j.graphics,u$T._addGraphicToGraphics(u$W,u$d)},u$T._getGraphicsFromSprite=function(u$W,u$j){var u$t,u$d;if(!u$W||!u$W.props)return u$j.graphics;switch(u$d=u$W.props.renderType){case"hit":case"unHit":var u$b;u$j.hitArea||(u$j.hitArea=new u$J),(u$b=u$j.hitArea)[u$d]||(u$b[u$d]=new u$Q),u$t=u$b[u$d]}return u$t||(u$t=u$j.graphics),u$t},u$T._getTransformData=function(u$W){var u$j;(u$W.hasOwnProperty("pivotX")||u$W.hasOwnProperty("pivotY"))&&(u$j=u$j||new u$l).translate(-u$T._getObjVar(u$W,"pivotX",0),-u$T._getObjVar(u$W,"pivotY",0));var u$t=u$T._getObjVar(u$W,"scaleX",1),u$d=u$T._getObjVar(u$W,"scaleY",1),u$b=u$T._getObjVar(u$W,"rotation",0);u$T._getObjVar(u$W,"skewX",0),u$T._getObjVar(u$W,"skewY",0);return 1==u$t&&1==u$d&&0==u$b||((u$j=u$j||new u$l).scale(u$t,u$d),u$j.rotate(.0174532922222222*u$b)),u$j},u$T._addGraphicToGraphics=function(u$W,u$j){var u$t,u$d;if((u$t=u$W.props)&&(u$d=u$T.DrawTypeDic[u$W.type])){var u$b,u$E;u$b=u$j;var u$O=u$T._getParams(u$t,u$d[1],u$d[2],u$d[3]);((u$E=u$T._tM)||1!=u$T._alpha)&&(u$b.save(),u$E&&u$b.transform(u$E),1!=u$T._alpha&&u$b.alpha(u$T._alpha)),u$b[u$d[0]].apply(u$b,u$O),(u$E||1!=u$T._alpha)&&u$b.restore()}},u$T._adptLineData=function(u$W){return u$W[2]=parseFloat(u$W[0])+parseFloat(u$W[2]),u$W[3]=parseFloat(u$W[1])+parseFloat(u$W[3]),u$W},u$T._adptTextureData=function(u$W){return u$W[0]=u$qW.getRes(u$W[0]),u$W},u$T._adptLinesData=function(u$W){return u$W[2]=u$T._getPointListByStr(u$W[2]),u$W},u$T.isDrawType=function(u$W){return"Image"!=u$W&&u$T.DrawTypeDic.hasOwnProperty(u$W)},u$T._getParams=function(u$W,u$j,u$t,u$d){var u$b;void 0===u$t&&(u$t=0),(u$b=u$T._temParam).length=u$j.length;var u$E,u$O,u$q=0;for(u$E=u$j.length,u$q=0;u$q<u$E;u$q++)u$b[u$q]=u$T._getObjVar(u$W,u$j[u$q][0],u$j[u$q][1]);return u$T._alpha=u$T._getObjVar(u$W,"alpha",1),u$O=u$T._getTransformData(u$W),u$T._tM=u$O?(u$t||(u$t=0),u$O.translate(u$b[u$t],u$b[u$t+1]),u$b[u$t]=u$b[u$t+1]=0,u$O):null,u$d&&u$T[u$d]&&(u$b=u$T[u$d](u$b)),u$b},u$T._getPointListByStr=function(u$W){var u$j,u$t,u$d=0;for(u$t=(u$j=u$W.split(",")).length,u$d=0;u$d<u$t;u$d++)u$j[u$d]=parseFloat(u$j[u$d]);return u$j},u$T._getObjVar=function(u$W,u$j,u$t){return u$W.hasOwnProperty(u$j)?u$W[u$j]:u$t},u$T._temParam=[],u$T._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},u$T.getClass=function(u$W){var u$j=u$T._classMap[u$W]||u$W;return"string"==typeof u$j?u$N.__classmap[u$j]:u$j},u$T._tM=null,u$T._alpha=NaN,u$A(u$T,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),u$T}(),u$f=function(){function u$E(u$W){if(this._color=[],"string"==typeof u$W){null===(this.strColor=u$W)&&(u$W="#000000"),"#"==u$W.charAt(0)&&(u$W=u$W.substr(1));var u$j=u$W.length;if(3==u$j||4==u$j){for(var u$t="",u$d=0;u$d<u$j;u$d++)u$t+=u$W[u$d]+u$W[u$d];u$W=u$t}var u$b=this.numColor=parseInt(u$W,16);if(8==u$W.length)return void(this._color=[parseInt(u$W.substr(0,2),16)/255,((16711680&u$b)>>16)/255,((65280&u$b)>>8)/255,(255&u$b)/255])}else u$b=this.numColor=u$W,this.strColor=u$n.toHexColor(u$b);this._color=[((16711680&u$b)>>16)/255,((65280&u$b)>>8)/255,(255&u$b)/255,1],this._color.__id=++u$E._COLODID}return u$R(u$E,"laya.utils.Color"),u$E._initDefault=function(){for(var u$W in u$E._DEFAULT={},u$E._COLOR_MAP)u$E._SAVE[u$W]=u$E._DEFAULT[u$W]=new u$E(u$E._COLOR_MAP[u$W]);return u$E._DEFAULT},u$E._initSaveMap=function(){for(var u$W in u$E._SAVE_SIZE=0,u$E._SAVE={},u$E._DEFAULT)u$E._SAVE[u$W]=u$E._DEFAULT[u$W]},u$E.create=function(u$W){var u$j=u$E._SAVE[u$W+""];return null!=u$j?u$j:(u$E._SAVE_SIZE<1e3||u$E._initSaveMap(),u$E._SAVE[u$W+""]=new u$E(u$W))},u$E._SAVE={},u$E._SAVE_SIZE=0,u$E._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},u$E._DEFAULT=u$E._initDefault(),u$E._COLODID=1,u$E}(),u$w=(function(){function u$W(){this._values=[],this._keys=[]}u$R(u$W,"laya.utils.Dictionary");var u$j=u$W.prototype;u$j.set=function(u$W,u$j){var u$t=this.indexOf(u$W);0<=u$t?this._values[u$t]=u$j:(this._keys.push(u$W),this._values.push(u$j))},u$j.indexOf=function(u$W){var u$j=this._keys.indexOf(u$W);return 0<=u$j?u$j:(u$W="string"==typeof u$W?Number(u$W):"number"==typeof u$W?u$W.toString():u$W,this._keys.indexOf(u$W))},u$j.get=function(u$W){var u$j=this.indexOf(u$W);return u$j<0?null:this._values[u$j]},u$j.remove=function(u$W){var u$j=this.indexOf(u$W);return 0<=u$j&&(this._keys.splice(u$j,1),this._values.splice(u$j,1),!0)},u$j.clear=function(){this._values.length=0,this._keys.length=0},u$$(0,u$j,"values",function(){return this._values}),u$$(0,u$j,"keys",function(){return this._keys})}(),function(){function u$W(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}u$R(u$W,"laya.utils.Dragging");var u$j=u$W.prototype;return u$j.start=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){void 0===u$q&&(u$q=.92),this.clearTimer(),this.target=u$W,this.area=u$j,this.hasInertia=u$t,this.elasticDistance=u$j?u$d:0,this.elasticBackTime=u$b,this.data=u$E,this._disableMouseEvent=u$O,this.ratio=u$q,1!=u$W.globalScaleX||1!=u$W.globalScaleY?this._parent=u$W.parent:this._parent=u$N.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,u$N.stage.on("mouseup",this,this.onStageMouseUp),u$N.stage.on("mouseout",this,this.onStageMouseUp),u$N.timer.frameLoop(1,this,this.loop)},u$j.clearTimer=function(){u$N.timer.clear(this,this.loop),u$N.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},u$j.stop=function(){this._dragging&&(u$e.instance.disableMouseEvent=!1,u$N.stage.off("mouseup",this,this.onStageMouseUp),u$N.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},u$j.loop=function(){var u$W=this._parent.getMousePoint(),u$j=u$W.x,u$t=u$W.y,u$d=u$j-this._lastX,u$b=u$t-this._lastY;if(this._clickOnly){if(!(1<Math.abs(u$d*u$N.stage._canvasTransform.getScaleX())||1<Math.abs(u$b*u$N.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),u$e.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(u$d,u$b);0==u$d&&0==u$b||(this._lastX=u$j,this._lastY=u$t,this.target.x+=u$d*this._elasticRateX,this.target.y+=u$b*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},u$j.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var u$W=this.area.x-this.target.x;else u$W=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-u$W/this.elasticDistance),this.target.y<this.area.y)var u$j=this.area.y-this.target.y;else u$j=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-u$j/this.elasticDistance)}},u$j.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},u$j.onStageMouseUp=function(u$W){if(u$e.instance.disableMouseEvent=!1,u$N.stage.off("mouseup",this,this.onStageMouseUp),u$N.stage.off("mouseout",this,this.onStageMouseUp),u$N.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var u$j=this._offsets.length,u$t=Math.min(u$j,6),u$d=this._offsets.length-u$t,u$b=u$j-1;u$d<u$b;u$b--)this._offsetY+=this._offsets[u$b--],this._offsetX+=this._offsets[u$b];this._offsetX=this._offsetX/u$t*2,this._offsetY=this._offsetY/u$t*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),u$N.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},u$j.checkElastic=function(){var u$W=NaN,u$j=NaN;if(this.target.x<this.area.x?u$W=this.area.x:this.target.x>this.area.x+this.area.width&&(u$W=this.area.x+this.area.width),this.target.y<this.area.y?u$j=this.area.y:this.target.y>this.area.y+this.area.height&&(u$j=this.area.y+this.area.height),isNaN(u$W)&&isNaN(u$j))this.clear();else{var u$t={};isNaN(u$W)||(u$t.x=u$W),isNaN(u$j)||(u$t.y=u$j),this._tween=u$B.to(this.target,u$t,this.elasticBackTime,u$U.sineOut,u$S.create(this,this.clear),0,!1,!1)}},u$j.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(u$N.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},u$j.clear=function(){if(this.target){this.clearTimer();var u$W=this.target;this.target=null,this._parent=null,u$W.event("dragend",this.data)}},u$W}()),u$U=function(){function u$q(){}return u$R(u$q,"laya.utils.Ease"),u$q.linearNone=function(u$W,u$j,u$t,u$d){return u$t*u$W/u$d+u$j},u$q.linearIn=function(u$W,u$j,u$t,u$d){return u$t*u$W/u$d+u$j},u$q.linearInOut=function(u$W,u$j,u$t,u$d){return u$t*u$W/u$d+u$j},u$q.linearOut=function(u$W,u$j,u$t,u$d){return u$t*u$W/u$d+u$j},u$q.bounceIn=function(u$W,u$j,u$t,u$d){return u$t-u$q.bounceOut(u$d-u$W,0,u$t,u$d)+u$j},u$q.bounceInOut=function(u$W,u$j,u$t,u$d){return u$W<.5*u$d?.5*u$q.bounceIn(2*u$W,0,u$t,u$d)+u$j:.5*u$q.bounceOut(2*u$W-u$d,0,u$t,u$d)+.5*u$t+u$j},u$q.bounceOut=function(u$W,u$j,u$t,u$d){return(u$W/=u$d)<1/2.75?u$t*(7.5625*u$W*u$W)+u$j:u$W<2/2.75?u$t*(7.5625*(u$W-=1.5/2.75)*u$W+.75)+u$j:u$W<2.5/2.75?u$t*(7.5625*(u$W-=2.25/2.75)*u$W+.9375)+u$j:u$t*(7.5625*(u$W-=2.625/2.75)*u$W+.984375)+u$j},u$q.backIn=function(u$W,u$j,u$t,u$d,u$b){return void 0===u$b&&(u$b=1.70158),u$t*(u$W/=u$d)*u$W*((u$b+1)*u$W-u$b)+u$j},u$q.backInOut=function(u$W,u$j,u$t,u$d,u$b){return void 0===u$b&&(u$b=1.70158),(u$W/=.5*u$d)<1?.5*u$t*(u$W*u$W*((1+(u$b*=1.525))*u$W-u$b))+u$j:u$t/2*((u$W-=2)*u$W*((1+(u$b*=1.525))*u$W+u$b)+2)+u$j},u$q.backOut=function(u$W,u$j,u$t,u$d,u$b){return void 0===u$b&&(u$b=1.70158),u$t*((u$W=u$W/u$d-1)*u$W*((u$b+1)*u$W+u$b)+1)+u$j},u$q.elasticIn=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O;return void 0===u$b&&(u$b=0),void 0===u$E&&(u$E=0),0==u$W?u$j:1==(u$W/=u$d)?u$j+u$t:(u$E||(u$E=.3*u$d),u$O=!u$b||0<u$t&&u$b<u$t||u$t<0&&u$b<-u$t?(u$b=u$t,u$E/4):u$E/u$q.PI2*Math.asin(u$t/u$b),-u$b*Math.pow(2,10*(u$W-=1))*Math.sin((u$W*u$d-u$O)*u$q.PI2/u$E)+u$j)},u$q.elasticInOut=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O;return void 0===u$b&&(u$b=0),void 0===u$E&&(u$E=0),0==u$W?u$j:2==(u$W/=.5*u$d)?u$j+u$t:(u$E||(u$E=u$d*(.3*1.5)),u$O=!u$b||0<u$t&&u$b<u$t||u$t<0&&u$b<-u$t?(u$b=u$t,u$E/4):u$E/u$q.PI2*Math.asin(u$t/u$b),u$W<1?u$b*Math.pow(2,10*(u$W-=1))*Math.sin((u$W*u$d-u$O)*u$q.PI2/u$E)*-.5+u$j:u$b*Math.pow(2,-10*(u$W-=1))*Math.sin((u$W*u$d-u$O)*u$q.PI2/u$E)*.5+u$t+u$j)},u$q.elasticOut=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O;return void 0===u$b&&(u$b=0),void 0===u$E&&(u$E=0),0==u$W?u$j:1==(u$W/=u$d)?u$j+u$t:(u$E||(u$E=.3*u$d),u$O=!u$b||0<u$t&&u$b<u$t||u$t<0&&u$b<-u$t?(u$b=u$t,u$E/4):u$E/u$q.PI2*Math.asin(u$t/u$b),u$b*Math.pow(2,-10*u$W)*Math.sin((u$W*u$d-u$O)*u$q.PI2/u$E)+u$t+u$j)},u$q.strongIn=function(u$W,u$j,u$t,u$d){return u$t*(u$W/=u$d)*u$W*u$W*u$W*u$W+u$j},u$q.strongInOut=function(u$W,u$j,u$t,u$d){return(u$W/=.5*u$d)<1?.5*u$t*u$W*u$W*u$W*u$W*u$W+u$j:.5*u$t*((u$W-=2)*u$W*u$W*u$W*u$W+2)+u$j},u$q.strongOut=function(u$W,u$j,u$t,u$d){return u$t*((u$W=u$W/u$d-1)*u$W*u$W*u$W*u$W+1)+u$j},u$q.sineInOut=function(u$W,u$j,u$t,u$d){return.5*-u$t*(Math.cos(Math.PI*u$W/u$d)-1)+u$j},u$q.sineIn=function(u$W,u$j,u$t,u$d){return-u$t*Math.cos(u$W/u$d*u$q.HALF_PI)+u$t+u$j},u$q.sineOut=function(u$W,u$j,u$t,u$d){return u$t*Math.sin(u$W/u$d*u$q.HALF_PI)+u$j},u$q.quintIn=function(u$W,u$j,u$t,u$d){return u$t*(u$W/=u$d)*u$W*u$W*u$W*u$W+u$j},u$q.quintInOut=function(u$W,u$j,u$t,u$d){return(u$W/=.5*u$d)<1?.5*u$t*u$W*u$W*u$W*u$W*u$W+u$j:.5*u$t*((u$W-=2)*u$W*u$W*u$W*u$W+2)+u$j},u$q.quintOut=function(u$W,u$j,u$t,u$d){return u$t*((u$W=u$W/u$d-1)*u$W*u$W*u$W*u$W+1)+u$j},u$q.quartIn=function(u$W,u$j,u$t,u$d){return u$t*(u$W/=u$d)*u$W*u$W*u$W+u$j},u$q.quartInOut=function(u$W,u$j,u$t,u$d){return(u$W/=.5*u$d)<1?.5*u$t*u$W*u$W*u$W*u$W+u$j:.5*-u$t*((u$W-=2)*u$W*u$W*u$W-2)+u$j},u$q.quartOut=function(u$W,u$j,u$t,u$d){return-u$t*((u$W=u$W/u$d-1)*u$W*u$W*u$W-1)+u$j},u$q.cubicIn=function(u$W,u$j,u$t,u$d){return u$t*(u$W/=u$d)*u$W*u$W+u$j},u$q.cubicInOut=function(u$W,u$j,u$t,u$d){return(u$W/=.5*u$d)<1?.5*u$t*u$W*u$W*u$W+u$j:.5*u$t*((u$W-=2)*u$W*u$W+2)+u$j},u$q.cubicOut=function(u$W,u$j,u$t,u$d){return u$t*((u$W=u$W/u$d-1)*u$W*u$W+1)+u$j},u$q.quadIn=function(u$W,u$j,u$t,u$d){return u$t*(u$W/=u$d)*u$W+u$j},u$q.quadInOut=function(u$W,u$j,u$t,u$d){return(u$W/=.5*u$d)<1?.5*u$t*u$W*u$W+u$j:.5*-u$t*(--u$W*(u$W-2)-1)+u$j},u$q.quadOut=function(u$W,u$j,u$t,u$d){return-u$t*(u$W/=u$d)*(u$W-2)+u$j},u$q.expoIn=function(u$W,u$j,u$t,u$d){return 0==u$W?u$j:u$t*Math.pow(2,10*(u$W/u$d-1))+u$j-.001*u$t},u$q.expoInOut=function(u$W,u$j,u$t,u$d){return 0==u$W?u$j:u$W==u$d?u$j+u$t:(u$W/=.5*u$d)<1?.5*u$t*Math.pow(2,10*(u$W-1))+u$j:.5*u$t*(2-Math.pow(2,-10*--u$W))+u$j},u$q.expoOut=function(u$W,u$j,u$t,u$d){return u$W==u$d?u$j+u$t:u$t*(1-Math.pow(2,-10*u$W/u$d))+u$j},u$q.circIn=function(u$W,u$j,u$t,u$d){return-u$t*(Math.sqrt(1-(u$W/=u$d)*u$W)-1)+u$j},u$q.circInOut=function(u$W,u$j,u$t,u$d){return(u$W/=.5*u$d)<1?.5*-u$t*(Math.sqrt(1-u$W*u$W)-1)+u$j:.5*u$t*(Math.sqrt(1-(u$W-=2)*u$W)+1)+u$j},u$q.circOut=function(u$W,u$j,u$t,u$d){return u$t*Math.sqrt(1-(u$W=u$W/u$d-1)*u$W)+u$j},u$q.HALF_PI=.5*Math.PI,u$q.PI2=2*Math.PI,u$q}(),u$J=function(){function u$m(){this._hit=null,this._unHit=null}u$R(u$m,"laya.utils.HitArea");var u$W=u$m.prototype;return u$W.isHit=function(u$W,u$j){return!!u$m.isHitGraphic(u$W,u$j,this.hit)&&!u$m.isHitGraphic(u$W,u$j,this.unHit)},u$W.contains=function(u$W,u$j){return this.isHit(u$W,u$j)},u$$(0,u$W,"hit",function(){return this._hit||(this._hit=new u$Q),this._hit},function(u$W){this._hit=u$W}),u$$(0,u$W,"unHit",function(){return this._unHit||(this._unHit=new u$Q),this._unHit},function(u$W){this._unHit=u$W}),u$m.isHitGraphic=function(u$W,u$j,u$t){if(!u$t)return!1;var u$d;if(!(u$d=u$t.cmds)&&u$t._one&&((u$d=u$m._cmds).length=1,u$d[0]=u$t._one),!u$d)return!1;var u$b,u$E,u$O=0;for(u$b=u$d.length,u$O=0;u$O<u$b;u$O++)if(u$E=u$d[u$O]){var u$q=u$y._context;switch(u$E.callee){case u$q._translate:case 6:u$W-=u$E[0],u$j-=u$E[1]}if(u$m.isHitCmd(u$W,u$j,u$E))return!0}return!1},u$m.isHitCmd=function(u$W,u$j,u$t){if(!u$t)return!1;var u$d=u$y._context,u$b=!1;switch(u$t.callee){case u$d._drawRect:case 13:u$m._rec.setTo(u$t[0],u$t[1],u$t[2],u$t[3]),u$b=u$m._rec.contains(u$W,u$j);break;case u$d._drawCircle:case u$d._fillCircle:case 14:u$b=(u$W-=u$t[0])*u$W+(u$j-=u$t[1])*u$j<u$t[2]*u$t[2];break;case u$d._drawPoly:case 18:u$W-=u$t[0],u$j-=u$t[1],u$b=u$m.ptInPolygon(u$W,u$j,u$t[2])}return u$b},u$m.ptInPolygon=function(u$W,u$j,u$t){var u$d;(u$d=u$m._ptPoint).setTo(u$W,u$j);var u$b,u$E=0,u$O=NaN,u$q=NaN,u$A=NaN,u$c=NaN;u$b=u$t.length;for(var u$R=0;u$R<u$b;u$R+=2){if(u$O=u$t[u$R],u$q=u$t[u$R+1],u$A=u$t[(u$R+2)%u$b],u$q!=(u$c=u$t[(u$R+3)%u$b]))if(!(u$d.y<Math.min(u$q,u$c)))if(!(u$d.y>=Math.max(u$q,u$c)))(u$d.y-u$q)*(u$A-u$O)/(u$c-u$q)+u$O>u$d.x&&u$E++}return u$E%2==1},u$m._cmds=[],u$A(u$m,["_rec",function(){return this._rec=new u$C},"_ptPoint",function(){return this._ptPoint=new u$z}]),u$m}(),u$r=(function(){function u$b(u$W,u$j,u$t,u$d){this.char=u$W,this.charNum=u$W.charCodeAt(0),this._x=this._y=0,this.width=u$j,this.height=u$t,this.style=u$d,this.isWord=!u$b._isWordRegExp.test(u$W)}u$R(u$b,"laya.utils.HTMLChar");var u$W=u$b.prototype;u$N.imps(u$W,{"laya.display.ILayout":!0}),u$W.setSprite=function(u$W){this._sprite=u$W},u$W.getSprite=function(){return this._sprite},u$W._isChar=function(){return!0},u$W._getCSSStyle=function(){return this.style},u$$(0,u$W,"width",function(){return this._w},function(u$W){this._w=u$W}),u$$(0,u$W,"x",function(){return this._x},function(u$W){this._sprite&&(this._sprite.x=u$W),this._x=u$W}),u$$(0,u$W,"y",function(){return this._y},function(u$W){this._sprite&&(this._sprite.y=u$W),this._y=u$W}),u$$(0,u$W,"height",function(){return this._h},function(u$W){this._h=u$W}),u$b._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function u$j(){}u$R(u$j,"laya.utils.Log"),u$j.enable=function(){u$j._logdiv||(u$j._logdiv=u$Y.window.document.createElement("div"),u$Y.window.document.body.appendChild(u$j._logdiv),u$j._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},u$j.toggle=function(){var u$W=u$j._logdiv.style;"1px"==u$W.width?u$W.width=u$W.height="50%":u$W.width=u$W.height="1px"},u$j.print=function(u$W){u$j._logdiv&&(u$j.maxCount<=u$j._count&&u$j.clear(),u$j._count++,u$j._logdiv.innerText+=u$W+"\n",u$j._logdiv.scrollTop=u$j._logdiv.scrollHeight)},u$j.clear=function(){u$j._logdiv.innerText="",u$j._count=0},u$j._logdiv=null,u$j._count=0,u$j.maxCount=20}(),function(){function u$j(){}u$R(u$j,"laya.utils.Mouse"),u$$(1,u$j,"cursor",function(){return u$j._style.cursor},function(u$W){u$j._style.cursor=u$W}),u$j.hide=function(){"none"!=u$j.cursor&&(u$j._preCursor=u$j.cursor,u$j.cursor="none")},u$j.show=function(){"none"==u$j.cursor&&(u$j.cursor=u$j._preCursor?u$j._preCursor:"auto")},u$j._preCursor=null,u$A(u$j,["_style",function(){return this._style=u$Y.document.body.style}])}(),function(){function u$E(){}return u$R(u$E,"laya.utils.Pool"),u$E.getPoolBySign=function(u$W){return u$E._poolDic[u$W]||(u$E._poolDic[u$W]=[])},u$E.clearBySign=function(u$W){u$E._poolDic[u$W]&&(u$E._poolDic[u$W].length=0)},u$E.recover=function(u$W,u$j){u$j.__InPool||(u$j.__InPool=!0,u$E.getPoolBySign(u$W).push(u$j))},u$E.getItemByClass=function(u$W,u$j){var u$t=u$E.getPoolBySign(u$W),u$d=u$t.length?u$t.pop():new u$j;return u$d.__InPool=!1,u$d},u$E.getItemByCreateFun=function(u$W,u$j,u$t){var u$d=u$E.getPoolBySign(u$W),u$b=u$d.length?u$d.pop():u$j.call(u$t);return u$b.__InPool=!1,u$b},u$E.getItem=function(u$W){var u$j=u$E.getPoolBySign(u$W),u$t=u$j.length?u$j.pop():null;return u$t&&(u$t.__InPool=!1),u$t},u$E._poolDic={},u$E.InPoolSign="__InPool",u$E}()),u$P=function(){function u$A(){}return u$R(u$A,"laya.utils.Stat"),u$$(1,u$A,"onclick",null,function(u$W){u$A._sp&&u$A._sp.on("click",u$A._sp,u$W),u$A._canvas&&(u$A._canvas.source.onclick=u$W,u$A._canvas.source.style.pointerEvents="")}),u$A.show=function(u$W,u$j,u$t){if(void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),!u$y.isConchApp||u$y.isConchWebGL){if(u$y.isConchWebGL||u$Y.onMiniGame||u$Y.onLimixiu||(u$A._useCanvas=!0),u$A._show=!0,u$A._fpsData.length=60,u$A._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},u$A._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},u$A._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},u$A._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},u$y.isWebGL)if(u$A._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},u$y.is3DMode){if(u$A._view[0].title="FPS(3D)",u$A._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},u$A._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},u$A._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==u$t){var u$d=8;u$A._view[u$d++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},u$A._view[u$d++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},u$A._view[u$d++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},u$A._view[u$d++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},u$A._view[u$d++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},u$A._view[u$d++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},u$A._view[u$d++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},u$A._view[u$d++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},u$A._view[u$d++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==u$t){u$d=8;u$A._view[u$d++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},u$A._view[u$d++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},u$A._view[u$d++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},u$A._view[u$d++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},u$A._view[u$d++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},u$A._view[u$d++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},u$A._view[u$d++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else u$A._view[0].title="FPS(WebGL)",u$A._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else u$A._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};u$A._useCanvas?u$A.createUIPre(u$W,u$j):u$A.createUI(u$W,u$j),u$A.enable()}else u$Y.window.conch.showFPS&&u$Y.window.conch.showFPS(u$W,u$j)},u$A.createUIPre=function(u$W,u$j){var u$t=u$Y.pixelRatio;u$A._width=170*u$t,u$A._vx=75*u$t,u$A._height=u$t*(12*u$A._view.length+3*u$t)+4,u$A._fontSize=12*u$t;for(var u$d=0;u$d<u$A._view.length;u$d++)u$A._view[u$d].x=4,u$A._view[u$d].y=u$d*u$A._fontSize+2*u$t;u$A._canvas||((u$A._canvas=new u$MW("2D")).size(u$A._width,u$A._height),(u$A._ctx=u$A._canvas.getContext("2d")).textBaseline="top",u$A._ctx.font=u$A._fontSize+"px Sans-serif",u$A._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+u$W+"px;top:"+u$j+"px;width:"+u$A._width/u$t+"px;height:"+u$A._height/u$t+"px;"),u$A._first=!0,u$A.loop(),u$A._first=!1,u$Y.container.appendChild(u$A._canvas.source)},u$A.createUI=function(u$W,u$j){var u$t=u$A._sp,u$d=u$Y.pixelRatio;u$t||(u$t=new u$mW,(u$A._leftText=new u$KW).pos(5,5),u$A._leftText.color="#ffffff",u$t.addChild(u$A._leftText),(u$A._txt=new u$KW).pos(80*u$d,5),u$A._txt.color="#ffffff",u$t.addChild(u$A._txt),u$A._sp=u$t),u$t.pos(u$W,u$j);for(var u$b="",u$E=0;u$E<u$A._view.length;u$E++){u$b+=u$A._view[u$E].title+"\n"}u$A._leftText.text=u$b;var u$O=170*u$d,u$q=u$d*(12*u$A._view.length+3*u$d)+4;u$A._txt.fontSize=u$A._fontSize*u$d,u$A._leftText.fontSize=u$A._fontSize*u$d,u$t.size(u$O,u$q),u$t.graphics.clear(),u$t.graphics.setAlpha(.5),u$t.graphics.drawRect(0,0,u$O,u$q,"#999999"),u$t.graphics.setAlpha(1),u$A.loop()},u$A.enable=function(){u$N.timer.frameLoop(1,u$A,u$A.loop)},u$A.hide=function(){u$A._show=!1,u$N.timer.clear(u$A,u$A.loop),u$A._canvas&&u$Y.removeElement(u$A._canvas.source)},u$A.clear=function(){u$A.trianglesFaces=u$A.drawCall=u$A.shaderCall=u$A.spriteCount=u$A.spriteRenderUseCacheCount=u$A.treeNodeCollision=u$A.treeSpriteCollision=u$A.canvasNormal=u$A.canvasBitmap=u$A.canvasReCache=0},u$A.loop=function(){u$A._count++;var u$W=u$Y.now();if(!(u$W-u$A._timer<1e3)){var u$j=u$A._count;if(u$A.FPS=Math.round(1e3*u$j/(u$W-u$A._timer)),u$A._show){u$A.trianglesFaces=Math.round(u$A.trianglesFaces/u$j),u$A.spriteCount=u$A._useCanvas?(u$A.drawCall=Math.round(u$A.drawCall/u$j)-2,u$A.shaderCall=Math.round(u$A.shaderCall/u$j),Math.round(u$A.spriteCount/u$j)-1):(u$A.drawCall=Math.round(u$A.drawCall/u$j)-2,u$A.shaderCall=Math.round(u$A.shaderCall/u$j)-4,Math.round(u$A.spriteCount/u$j)-4),u$A.spriteRenderUseCacheCount=Math.round(u$A.spriteRenderUseCacheCount/u$j),u$A.canvasNormal=Math.round(u$A.canvasNormal/u$j),u$A.canvasBitmap=Math.round(u$A.canvasBitmap/u$j),u$A.canvasReCache=Math.ceil(u$A.canvasReCache/u$j),u$A.treeNodeCollision=Math.round(u$A.treeNodeCollision/u$j),u$A.treeSpriteCollision=Math.round(u$A.treeSpriteCollision/u$j);var u$t=0<u$A.FPS?Math.floor(1e3/u$A.FPS).toString():" ";u$A._fpsStr=u$A.FPS+(u$A.renderSlow?" slow":"")+" "+u$t,u$A._spriteStr=u$A.spriteCount+(u$A.spriteRenderUseCacheCount?"/"+u$A.spriteRenderUseCacheCount:""),u$A._canvasStr=u$A.canvasReCache+"/"+u$A.canvasNormal+"/"+u$A.canvasBitmap,u$A.currentMemorySize=u$s.systemResourceManager.memorySize,u$A._useCanvas?u$A.renderInfoPre():u$A.renderInfo(),u$A.clear()}u$A._count=0,u$A._timer=u$W}},u$A.renderInfoPre=function(){if(u$A._canvas){var u$W=u$A._ctx;u$W.clearRect(u$A._first?0:u$A._vx,0,u$A._width,u$A._height);for(var u$j=u$y.WebGL.mainContext,u$t=0;u$t<u$A._view.length;u$t++){var u$d=u$A._view[u$t];u$A._first&&(u$W.fillStyle="white",u$W.fillText(u$d.title,u$d.x,u$d.y,null,null,null)),u$W.fillStyle=u$d.color;var u$b=-1;if((u$d=u$A._view[u$t]).varying){if(u$j)switch(u$d.varying){case 1:u$b=u$j.getParameter(u$j[u$d.value]);break;case 2:u$b=u$j.getExtension(u$d.value)}}else u$b=u$A[u$d.value];"M"==u$d.units&&(u$b=Math.floor(u$b/1048576*100)/100+" M"),"K"==u$d.units&&(u$b=Math.floor(u$b/1024*100)/100+" K"),"string"==u$d.units&&(u$b=u$b.match(/\d+\.?\d/i)),u$W.fillText(u$b+"",u$d.x+u$A._vx,u$d.y,null,null,null)}}},u$A.renderInfo=function(){for(var u$W="",u$j=u$y.WebGL.mainContext,u$t=0;u$t<u$A._view.length;u$t++){var u$d=u$A._view[u$t],u$b=-1;if(u$d.varying){if(u$j)switch(u$d.varying){case 1:u$b=u$j.getParameter(u$j[u$d.value]);break;case 2:u$b=u$j.getExtension(u$d.value)}}else u$b=u$A[u$d.value];"M"==u$d.units&&(u$b=Math.floor(u$b/1048576*100)/100+" M"),"K"==u$d.units&&(u$b=Math.floor(u$b/1024*100)/100+" K"),"string"==u$d.units&&(u$b=u$b.match(/\d+\.?\d/i)),u$W+=u$b+"\n"}u$A._txt.text=u$W},u$A.FPS=0,u$A.loopCount=0,u$A.shaderCall=0,u$A.drawCall=0,u$A.trianglesFaces=0,u$A.spriteCount=0,u$A.spriteRenderUseCacheCount=0,u$A.treeNodeCollision=0,u$A.treeSpriteCollision=0,u$A.canvasNormal=0,u$A.canvasBitmap=0,u$A.canvasReCache=0,u$A.renderSlow=!1,u$A.currentMemorySize=0,u$A._fpsStr=null,u$A._canvasStr=null,u$A._spriteStr=null,u$A._fpsData=[],u$A._timer=0,u$A._count=0,u$A._view=[],u$A._fontSize=12,u$A._txt=null,u$A._leftText=null,u$A._sp=null,u$A._show=!1,u$A._useCanvas=!1,u$A._canvas=null,u$A._ctx=null,u$A._first=!1,u$A._vx=NaN,u$A._width=0,u$A._height=100,u$A}(),u$i=(function(){function u$W(){this._strsToID={},this._idToStrs=[],this._length=0}u$R(u$W,"laya.utils.StringKey");var u$j=u$W.prototype;u$j.add=function(u$W){var u$j=this._strsToID[u$W];return null!=u$j?u$j:(this._idToStrs[this._length]=u$W,this._strsToID[u$W]=this._length++)},u$j.getID=function(u$W){var u$j=this._strsToID[u$W];return null==u$j?-1:u$j},u$j.getName=function(u$W){var u$j=this._idToStrs[u$W];return null==u$j?void 0:u$j}}(),function(){var u$c;function u$W(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}u$R(u$W,"laya.utils.Timer");var u$j=u$W.prototype;return u$j._init=function(){u$N.timer&&u$N.timer.frameLoop(1,this,this._update)},u$j._now=function(){return Date.now()},u$j._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var u$W=this.currFrame=this.currFrame+this.scale,u$j=this._now();this._delta=(u$j-this._lastTimer)*this.scale;var u$t=this.currTimer=this.currTimer+this._delta;u$N.isDebug&&6e4<Math.abs(u$j-this._lastTimer)&&console.error("系统时间错误！"+(u$j-this._lastTimer)),this._lastTimer=u$j;var u$d=this._handlers;for(u$O=this._count=0,u$q=u$d.length;u$O<u$q;u$O++)if(null!==(u$A=u$d[u$O]).method){var u$b=u$A.userFrame?u$W:u$t;if(u$b>=u$A.exeTime)if(u$A.repeat)if(u$A.jumpFrame)for(;u$b>=u$A.exeTime;)u$A.exeTime+=u$A.delay,u$A.run(!1);else u$A.exeTime+=u$A.delay,u$A.run(!1),u$b>u$A.exeTime&&(u$A.exeTime+=Math.ceil((u$b-u$A.exeTime)/u$A.delay)*u$A.delay);else u$A.run(!0)}else this._count++;(30<this._count||u$W%200==0)&&this._clearHandlers();for(var u$E=this._laters,u$O=0,u$q=u$E.length-1;u$O<=u$q;u$O++){var u$A=u$E[u$O];this._isIgnoreRecover(u$A)||(null!==u$A.method&&(delete this._map[u$A.key],u$A.run(!1)),this._recoverHandler(u$A)),u$O===u$q&&(u$q=u$E.length-1)}u$E.length=0}},u$j._clearHandlers=function(){for(var u$W=this._handlers,u$j=0,u$t=u$W.length;u$j<u$t;u$j++){var u$d=u$W[u$j];null!==u$d.method?this._temp.push(u$d):this._isIgnoreRecover(u$d)?this._temp.push(u$d):this._recoverHandler(u$d)}this._handlers=this._temp,this._temp=u$W,this._temp.length=0},u$j._recoverHandler=function(u$W){this._map[u$W.key]==u$W&&delete this._map[u$W.key],u$W.recover()},u$j._create=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){if(!u$t)return u$b.apply(u$d,u$E),null;if(u$O){var u$A=this._getHandler(u$d,u$b);if(u$A)return u$A.repeat=u$j,u$A.userFrame=u$W,u$A.delay=u$t,u$A.ignoreRecover=u$q,u$A.caller=u$d,u$A.method=u$b,u$A.args=u$E,u$A.exeTime=u$t+(u$W?this.currFrame:this.currTimer+this._now()-this._lastTimer),u$A}return(u$A=u$c.create()).repeat=u$j,u$A.userFrame=u$W,u$A.delay=u$t,u$A.ignoreRecover=u$q,u$A.caller=u$d,u$A.method=u$b,u$A.args=u$E,u$A.exeTime=u$t+(u$W?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(u$A),this._handlers.push(u$A),u$A},u$j._indexHandler=function(u$W){var u$j=u$W.caller,u$t=u$W.method,u$d=u$j?u$j.$_GID||(u$j.$_GID=u$n.getGID()):0,u$b=u$t.$_TID||(u$t.$_TID=this._mid++);u$W.key=u$d+"_"+u$b,this._map[u$W.key]=u$W},u$j.once=function(u$W,u$j,u$t,u$d,u$b){void 0===u$b&&(u$b=!0),this._create(!1,!1,u$W,u$j,u$t,u$d,u$b,!1)},u$j.loop=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){void 0===u$b&&(u$b=!0),void 0===u$E&&(u$E=!1),void 0===u$O&&(u$O=!1);var u$q=this._create(!1,!0,u$W,u$j,u$t,u$d,u$b,u$O);u$q&&(u$q.jumpFrame=u$E)},u$j.frameOnce=function(u$W,u$j,u$t,u$d,u$b){void 0===u$b&&(u$b=!0),this._create(!0,!1,u$W,u$j,u$t,u$d,u$b,!1)},u$j.frameLoop=function(u$W,u$j,u$t,u$d,u$b,u$E){void 0===u$b&&(u$b=!0),void 0===u$E&&(u$E=!1),this._create(!0,!0,u$W,u$j,u$t,u$d,u$b,u$E)},u$j.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+u$c._freeCount},u$j.clear=function(u$W,u$j){var u$t=this._getHandler(u$W,u$j);return!(!u$t||this._isIgnoreRecover(u$t))&&(delete this._map[u$t.key],u$t.key=null,u$t.clear(),!0)},u$j.clearAll=function(u$W){if(u$W)for(var u$j=0,u$t=this._handlers.length;u$j<u$t;u$j++){var u$d=this._handlers[u$j];u$d.caller===u$W&&(this._isIgnoreRecover(u$d)||(delete this._map[u$d.key],u$d.key=null,u$d.clear()))}},u$j._getHandler=function(u$W,u$j){var u$t=u$W?u$W.$_GID||(u$W.$_GID=u$n.getGID()):0,u$d=u$j.$_TID||(u$j.$_TID=this._mid++);return this._map[u$t+"_"+u$d]},u$j._isIgnoreRecover=function(u$W){if(u$W.ignoreRecover||u$W.caller&&"IgnoreRecover"==u$W.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var u$j="";try{arguments.propertyIsEnumerable.caller}catch(u$W){u$j=u$W.stack}u$N.recordError("报错：核心定时器销毁忽略  "+u$j)}return!0}return!1},u$j.hasHandler=function(u$W,u$j){return this._map[u$W.$_GID+"_"+u$j.$_TID]},u$j.callLater=function(u$W,u$j,u$t){if(null==this._getHandler(u$W,u$j)){var u$d=u$c.create();u$d.caller=u$W,u$d.method=u$j,u$d.args=u$t,this._indexHandler(u$d),this._laters.push(u$d)}},u$j.runCallLater=function(u$W,u$j){var u$t=this._getHandler(u$W,u$j);u$t&&null!=u$t.method&&(this._isIgnoreRecover(u$t)||(delete this._map[u$t.key],u$t.run(!0)))},u$j.runTimer=function(u$W,u$j){this.runCallLater(u$W,u$j)},u$$(0,u$j,"delta",function(){return this._delta}),u$W.__init$=function(){u$c=function(){function u$j(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}u$R(u$j,"");var u$W=u$j.prototype;return u$W.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},u$W.recover=function(){this.clear(),this.args=u$j._freeHandler,u$j._freeHandler=this,u$j._freeCount++},u$W.run=function(u$W){var u$j=this.caller;if(u$j&&u$j.destroyed)return this.clear();var u$t=this.method,u$d=this.args;u$W&&this.clear(),null!=u$t&&(u$d?u$t.apply(u$j,u$d):u$t.call(u$j))},u$j._freeHandler=null,u$j._freeCount=0,u$j.create=function(){var u$W=u$j._freeHandler;return u$W?(u$j._freeHandler=u$W.args,--u$j._freeCount,u$W.args=null,u$W):new u$j},u$j}()},u$W}()),u$B=function(){function u$m(){this.gid=0}u$R(u$m,"laya.utils.Tween");var u$W=u$m.prototype;return u$W.to=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){return void 0===u$E&&(u$E=0),void 0===u$O&&(u$O=!1),this._create(u$W,u$j,u$t,u$d,u$b,u$E,u$O,!0,!1,!0)},u$W.from=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){return void 0===u$E&&(u$E=0),void 0===u$O&&(u$O=!1),this._create(u$W,u$j,u$t,u$d,u$b,u$E,u$O,!1,!1,!0)},u$W._create=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){if(!u$W)throw new Error("Tween:target is null");this._target=u$W,this._duration=u$t,this._ease=u$d||u$j.ease||u$m.easeNone,this._complete=u$b||u$j.complete,this._delay=u$E,this._props=[],this._usedTimer=0,this._startTimer=u$Y.now(),this._usedPool=u$A,this._delayParam=null,this.update=u$j.update;var u$R=u$W.$_GID||(u$W.$_GID=u$n.getGID());return u$m.tweenMap[u$R]?(u$O&&u$m.clearTween(u$W),u$m.tweenMap[u$R].push(this)):u$m.tweenMap[u$R]=[this],u$c?u$E<=0?this.firstStart(u$W,u$j,u$q):(this._delayParam=[u$W,u$j,u$q],u$N.scaleTimer.once(u$E,this,this.firstStart,this._delayParam)):this._initProps(u$W,u$j,u$q),this},u$W.firstStart=function(u$W,u$j,u$t){this._delayParam=null,u$W.destroyed?this.clear():(this._initProps(u$W,u$j,u$t),this._beginLoop())},u$W._initProps=function(u$W,u$j,u$t){for(var u$d in u$j)if("number"==typeof u$W[u$d]){var u$b=u$t?u$W[u$d]:u$j[u$d],u$E=u$t?u$j[u$d]:u$W[u$d];this._props.push([u$d,u$b,u$E-u$b]),u$t||(u$W[u$d]=u$b)}},u$W._beginLoop=function(){u$N.scaleTimer.frameLoop(1,this,this._doEase)},u$W._doEase=function(){this._updateEase(u$Y.now())},u$W._updateEase=function(u$W){var u$j=this._target;if(u$j){if(u$j.destroyed)return u$m.clearTween(u$j);var u$t=this._usedTimer=u$W-this._startTimer-this._delay;if(!(u$t<0)){if(u$t>=this._duration)return this.complete();for(var u$d=0<u$t?this._ease(u$t,0,1,this._duration):0,u$b=this._props,u$E=0,u$O=u$b.length;u$E<u$O;u$E++){var u$q=u$b[u$E];u$j[u$q[0]]=u$q[1]+u$d*u$q[2]}this.update&&this.update.run()}}},u$W.complete=function(){if(this._target){u$N.scaleTimer.runTimer(this,this.firstStart);for(var u$W=this._target,u$j=this._props,u$t=this._complete,u$d=0,u$b=u$j.length;u$d<u$b;u$d++){var u$E=u$j[u$d];u$W[u$E[0]]=u$E[1]+u$E[2]}this.update&&this.update.run(),this.clear(),u$t&&u$t.run()}},u$W.pause=function(){u$N.scaleTimer.clear(this,this._beginLoop),u$N.scaleTimer.clear(this,this._doEase),u$N.scaleTimer.clear(this,this.firstStart);var u$W;(u$W=u$Y.now()-this._startTimer-this._delay)<0&&(this._usedTimer=u$W)},u$W.setStartTime=function(u$W){this._startTimer=u$W},u$W.clear=function(){this._target&&(this._remove(),this._clear())},u$W._clear=function(){this.pause(),u$N.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,u$r.recover("tween",this))},u$W.recover=function(){this._usedPool=!0,this._clear()},u$W._remove=function(){var u$W=u$m.tweenMap[this._target.$_GID];if(u$W)for(var u$j=0,u$t=u$W.length;u$j<u$t;u$j++)if(u$W[u$j]===this){u$W.splice(u$j,1);break}},u$W.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=u$Y.now(),this._delayParam)u$N.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var u$W=this._props,u$j=0,u$t=u$W.length;u$j<u$t;u$j++){var u$d=u$W[u$j];this._target[u$d[0]]=u$d[1]}u$N.scaleTimer.once(this._delay,this,this._beginLoop)}},u$W.resume=function(){this._usedTimer>=this._duration||(this._startTimer=u$Y.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?u$N.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},u$$(0,u$W,"progress",null,function(u$W){var u$j=u$W*this._duration;this._startTimer=u$Y.now()-this._delay-u$j}),u$m.to=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){return void 0===u$E&&(u$E=0),void 0===u$O&&(u$O=!1),void 0===u$q&&(u$q=!0),u$r.getItemByClass("tween",u$m)._create(u$W,u$j,u$t,u$d,u$b,u$E,u$O,!0,u$q,!0)},u$m.from=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){return void 0===u$E&&(u$E=0),void 0===u$O&&(u$O=!1),void 0===u$q&&(u$q=!0),u$r.getItemByClass("tween",u$m)._create(u$W,u$j,u$t,u$d,u$b,u$E,u$O,!1,u$q,!0)},u$m.clearAll=function(u$W){if(u$W&&u$W.$_GID){var u$j=u$m.tweenMap[u$W.$_GID];if(u$j){for(var u$t=0,u$d=u$j.length;u$t<u$d;u$t++)u$j[u$t]._clear();u$j.length=0}}},u$m.clear=function(u$W){u$W.clear()},u$m.clearTween=function(u$W){u$m.clearAll(u$W)},u$m.easeNone=function(u$W,u$j,u$t,u$d){return u$t*u$W/u$d+u$j},u$m.tweenMap={},u$m}(),u$n=function(){function u$q(){}return u$R(u$q,"laya.utils.Utils"),u$q.toRadian=function(u$W){return u$W*u$q._pi2},u$q.toAngle=function(u$W){return u$W*u$q._pi},u$q.toHexColor=function(u$W){if(u$W<0||isNaN(u$W))return null;for(var u$j=u$W.toString(16);u$j.length<6;)u$j="0"+u$j;return"#"+u$j},u$q.getGID=function(){return u$q._gid++},u$q.concatArray=function(u$W,u$j){if(!u$j)return u$W;if(!u$W)return u$j;var u$t=0,u$d=u$j.length;for(u$t=0;u$t<u$d;u$t++)u$W.push(u$j[u$t]);return u$W},u$q.clearArray=function(u$W){return u$W&&(u$W.length=0),u$W},u$q.copyArray=function(u$W,u$j){if(u$W||(u$W=[]),!u$j)return u$W;u$W.length=u$j.length;var u$t=0,u$d=u$j.length;for(u$t=0;u$t<u$d;u$t++)u$W[u$t]=u$j[u$t];return u$W},u$q.getGlobalRecByPoints=function(u$W,u$j,u$t,u$d,u$b){var u$E,u$O;return u$E=new u$z(u$j,u$t),u$E=u$W.localToGlobal(u$E),u$O=new u$z(u$d,u$b),u$O=u$W.localToGlobal(u$O),u$C._getWrapRec([u$E.x,u$E.y,u$O.x,u$O.y])},u$q.getGlobalPosAndScale=function(u$W){return u$q.getGlobalRecByPoints(u$W,0,0,1,1)},u$q.bind=function(u$W,u$j){return u$W.bind(u$j)},u$q.measureText=function(u$W,u$j){return u$G.measureText(u$W,u$j)},u$q.updateOrder=function(u$W){if(!u$W||u$W.length<2)return!1;for(var u$j,u$t=1,u$d=0,u$b=u$W.length,u$E=NaN;u$t<u$b;){for(u$j=u$W[u$d=u$t],u$E=u$W[u$d]._zOrder;-1<--u$d&&u$W[u$d]._zOrder>u$E;)u$W[u$d+1]=u$W[u$d];u$W[u$d+1]=u$j,u$t++}var u$O=u$j.parent.conchModel;if(u$O)if(null!=u$O.updateZOrder)u$O.updateZOrder();else{for(u$t=0;u$t<u$b;u$t++)u$O.removeChild(u$W[u$t].conchModel);for(u$t=0;u$t<u$b;u$t++)u$O.addChildAt(u$W[u$t].conchModel,u$t)}return!0},u$q.transPointList=function(u$W,u$j,u$t){var u$d=0,u$b=u$W.length;for(u$d=0;u$d<u$b;u$d+=2)u$W[u$d]+=u$j,u$W[u$d+1]+=u$t},u$q.parseInt=function(u$W,u$j){void 0===u$j&&(u$j=0);var u$t=u$Y.window.parseInt(u$W,u$j);return isNaN(u$t)?0:u$t},u$q.getFileExtension=function(u$W){u$q._extReg.lastIndex=u$W.lastIndexOf(".");var u$j=u$q._extReg.exec(u$W);return u$j&&1<u$j.length?u$j[1].toLowerCase():null},u$q.getTransformRelativeToWindow=function(u$W,u$j,u$t){var u$d=u$N.stage,u$b=laya.utils.Utils.getGlobalPosAndScale(u$W),u$E=u$d._canvasTransform.clone(),u$O=u$E.tx,u$q=u$E.ty;u$E.rotate(-Math.PI/180*u$N.stage.canvasDegree),u$E.scale(u$N.stage.clientScaleX,u$N.stage.clientScaleY);var u$A=u$N.stage.canvasDegree%180!=0,u$c=NaN,u$R=NaN;u$A?(u$c=u$t+u$b.y,u$R=u$j+u$b.x,u$c*=u$E.d,u$R*=u$E.a,90==u$N.stage.canvasDegree?(u$c=u$O-u$c,u$R+=u$q):(u$c+=u$O,u$R=u$q-u$R)):(u$c=u$j+u$b.x,u$R=u$t+u$b.y,u$c*=u$E.a,u$R*=u$E.d,u$c+=u$O,u$R+=u$q);var u$m=NaN,u$Q=NaN;return u$Q=u$A?(u$m=u$E.d*u$b.height,u$E.a*u$b.width):(u$m=u$E.a*u$b.width,u$E.d*u$b.height),{x:u$c,y:u$R,scaleX:u$m,scaleY:u$Q}},u$q.fitDOMElementInArea=function(u$W,u$j,u$t,u$d,u$b,u$E){u$W._fitLayaAirInitialized||(u$W._fitLayaAirInitialized=!0,u$W.style.transformOrigin=u$W.style.webKittransformOrigin="left top",u$W.style.position="absolute");var u$O=u$q.getTransformRelativeToWindow(u$j,u$t,u$d);u$W.style.transform=u$W.style.webkitTransform="scale("+u$O.scaleX+","+u$O.scaleY+") rotate("+u$N.stage.canvasDegree+"deg)",u$W.style.width=u$b+"px",u$W.style.height=u$E+"px",u$W.style.left=u$O.x+"px",u$W.style.top=u$O.y+"px"},u$q.isOkTextureList=function(u$W){if(!u$W)return!1;var u$j,u$t=0,u$d=u$W.length;for(u$t=0;u$t<u$d;u$t++)if(!(u$j=u$W[u$t])||!u$j.source)return!1;return!0},u$q.isOKCmdList=function(u$W){if(!u$W)return!1;var u$j,u$t,u$d=0,u$b=u$W.length,u$E=u$y._context;for(u$d=0;u$d<u$b;u$d++)switch((u$j=u$W[u$d]).callee){case u$E._drawTexture:case u$E._fillTexture:case u$E._drawTextureWithTransform:if(!(u$t=u$j[0])||!u$t.source)return!1}return!0},u$q._gid=1,u$q._pi=180/Math.PI,u$q._pi2=Math.PI/180,u$q._extReg=/\.(\w+)\??/g,u$q.parseXMLFromString=function(u$W){var u$j;if(u$W=u$W.replace(/>\s+</g,"><"),-1<(u$j=(new DOMParser).parseFromString(u$W,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(u$j.firstChild.firstChild.textContent);return u$j},u$q}(),u$k=function(){function u$W(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],u$y.isWebGL&&u$I.regCacheByFunction(u$n.bind(this.startDispose,this),u$n.bind(this.getCacheList,this))}u$R(u$W,"laya.utils.VectorGraphManager");var u$j=u$W.prototype;return u$j.getId=function(){return this._id++},u$j.addShape=function(u$W,u$j){this.shapeDic[u$W]=u$j,this.useDic[u$W]||(this.useDic[u$W]=!0)},u$j.addLine=function(u$W,u$j){this.shapeLineDic[u$W]=u$j,this.shapeLineDic[u$W]||(this.shapeLineDic[u$W]=!0)},u$j.getShape=function(u$W){this._checkKey&&null!=this.useDic[u$W]&&(this.useDic[u$W]=!0)},u$j.deleteShape=function(u$W){this.shapeDic[u$W]&&(this.shapeDic[u$W]=null,delete this.shapeDic[u$W]),this.shapeLineDic[u$W]&&(this.shapeLineDic[u$W]=null,delete this.shapeLineDic[u$W]),null!=this.useDic[u$W]&&delete this.useDic[u$W]},u$j.getCacheList=function(){var u$W,u$j=[];for(u$W in this.shapeDic)u$j.push(this.shapeDic[u$W]);for(u$W in this.shapeLineDic)u$j.push(this.shapeLineDic[u$W]);return u$j},u$j.startDispose=function(u$W){var u$j;for(u$j in this.useDic)this.useDic[u$j]=!1;this._checkKey=!0},u$j.endDispose=function(){if(this._checkKey){var u$W;for(u$W in this.useDic)this.useDic[u$W]||this.deleteShape(u$W);this._checkKey=!1}},u$W.getInstance=function(){return u$W.instance=u$W.instance||new u$W},u$W.instance=null,u$W}(),u$p=function(){function u$d(){this._obj=null,this._obj=u$d.supportWeakMap?new u$Y.window.WeakMap:{},u$d.supportWeakMap||u$d._maps.push(this)}u$R(u$d,"laya.utils.WeakObject");var u$W=u$d.prototype;return u$W.set=function(u$W,u$j){if(null!=u$W)if(u$d.supportWeakMap){var u$t=u$W;"string"!=typeof u$W&&"number"!=typeof u$W||(u$t=u$d._keys[u$W])||(u$t=u$d._keys[u$W]={k:u$W}),this._obj.set(u$t,u$j)}else"string"==typeof u$W||"number"==typeof u$W?this._obj[u$W]=u$j:(u$W.$_GID||(u$W.$_GID=u$n.getGID()),this._obj[u$W.$_GID]=u$j)},u$W.get=function(u$W){if(null==u$W)return null;if(u$d.supportWeakMap){var u$j="string"==typeof u$W||"number"==typeof u$W?u$d._keys[u$W]:u$W;return u$j?this._obj.get(u$j):null}return"string"==typeof u$W||"number"==typeof u$W?this._obj[u$W]:this._obj[u$W.$_GID]},u$W.del=function(u$W){if(null!=u$W)if(u$d.supportWeakMap){var u$j="string"==typeof u$W||"number"==typeof u$W?u$d._keys[u$W]:u$W;if(!u$j)return;this._obj.delete(u$j)}else"string"==typeof u$W||"number"==typeof u$W?delete this._obj[u$W]:delete this._obj[this._obj.$_GID]},u$W.has=function(u$W){if(null==u$W)return!1;if(u$d.supportWeakMap){var u$j="string"==typeof u$W||"number"==typeof u$W?u$d._keys[u$W]:u$W;return this._obj.has(u$j)}return"string"==typeof u$W||"number"==typeof u$W?null!=this._obj[u$W]:null!=this._obj[this._obj.$_GID]},u$d.__init__=function(){(u$d.supportWeakMap=null!=u$Y.window.WeakMap)||u$N.timer.loop(u$d.delInterval,null,u$d.clearCache)},u$d.clearCache=function(){for(var u$W=0,u$j=u$d._maps.length;u$W<u$j;u$W++){u$d._maps[u$W]._obj={}}},u$d.supportWeakMap=!1,u$d.delInterval=3e5,u$d._keys={},u$d._maps=[],u$A(u$d,["I",function(){return this.I=new u$d}]),u$d}(),u$F=function(){function u$W(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}u$R(u$W,"laya.utils.WordText");var u$j=u$W.prototype;return u$j.setText=function(u$W){this.changed=!0,this._text=u$W},u$j.toString=function(){return this._text},u$j.charCodeAt=function(u$W){return this._text?this._text.charCodeAt(u$W):NaN},u$j.charAt=function(u$W){return this._text?this._text.charAt(u$W):null},u$$(0,u$j,"length",function(){return this._text?this._text.length:0}),u$W}(),u$WW=function(u$W){function u$O(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,u$O.__super.call(this),this._childs=u$O.ARRAY_EMPTY,this._$P=u$O.PROP_EMPTY,this.timer=u$N.scaleTimer,this.conchModel=u$y.isConchNode?this.createConchModel():null}u$R(u$O,"laya.display.Node",u$c);var u$j=u$O.prototype;return u$j._setBit=function(u$W,u$j){1==u$W&&(this._getBit(u$W)!=u$j&&this._updateDisplayedInstage());u$j?this._bits|=u$W:this._bits&=~u$W},u$j._getBit=function(u$W){return 0!=(this._bits&u$W)},u$j._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},u$j._setUpNoticeType=function(u$W){var u$j=this;for(u$j._setBit(u$W,!0),u$j=u$j.parent;u$j;){if(u$j._getBit(u$W))return;u$j._setBit(u$W,!0),u$j=u$j.parent}},u$j.on=function(u$W,u$j,u$t,u$d){return"display"!==u$W&&"undisplay"!==u$W||this._getBit(1)||this._setUpNoticeType(1),this._createListener(u$W,u$j,u$t,u$d,!1)},u$j.once=function(u$W,u$j,u$t,u$d){return"display"!==u$W&&"undisplay"!==u$W||this._getBit(1)||this._setUpNoticeType(1),this._createListener(u$W,u$j,u$t,u$d,!0)},u$j.createConchModel=function(){return null},u$j.destroy=function(u$W){void 0===u$W&&(u$W=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(u$W?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},u$j.destroyChildren=function(){if(this._childs)for(var u$W=this._childs.length-1;-1<u$W;u$W--)this._childs[u$W].destroy(!0)},u$j.addChild=function(u$W){if(!u$W||this.destroyed||u$W===this)return u$W;if(u$W.zOrder&&this._set$P("hasZorder",!0),u$W._parent===this){var u$j=this.getChildIndex(u$W);u$j!==this._childs.length-1&&(this._childs.splice(u$j,1),this._childs.push(u$W),this.conchModel&&(this.conchModel.removeChild(u$W.conchModel),this.conchModel.addChildAt(u$W.conchModel,this._childs.length-1)),this._childChanged())}else u$W.parent&&u$W.parent.removeChild(u$W),this._childs===u$O.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(u$W),this.conchModel&&this.conchModel.addChildAt(u$W.conchModel,this._childs.length-1),(u$W.parent=this)._childChanged();return u$W},u$j.addChildren=function(u$W){for(var u$j=arguments,u$t=0,u$d=u$j.length;u$t<u$d;)this.addChild(u$j[u$t++])},u$j.addChildAt=function(u$W,u$j){if(!u$W||this.destroyed||u$W===this)return u$W;if(u$W.zOrder&&this._set$P("hasZorder",!0),0<=u$j&&u$j<=this._childs.length){if(u$W._parent===this){var u$t=this.getChildIndex(u$W);this._childs.splice(u$t,1),this._childs.splice(u$j,0,u$W),this.conchModel&&(this.conchModel.removeChild(u$W.conchModel),this.conchModel.addChildAt(u$W.conchModel,u$j)),this._childChanged()}else u$W.parent&&u$W.parent.removeChild(u$W),this._childs===u$O.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(u$j,0,u$W),this.conchModel&&this.conchModel.addChildAt(u$W.conchModel,u$j),u$W.parent=this;return u$W}throw new Error("appendChildAt:The index is out of bounds")},u$j.getChildIndex=function(u$W){return this._childs.indexOf(u$W)},u$j.getChildByName=function(u$W){var u$j=this._childs;if(u$j)for(var u$t=0,u$d=u$j.length;u$t<u$d;u$t++){var u$b=u$j[u$t];if(u$b.name===u$W)return u$b}return null},u$j._get$P=function(u$W){return this._$P[u$W]},u$j._set$P=function(u$W,u$j){return this.destroyed||(this._$P===u$O.PROP_EMPTY&&(this._$P={}),this._$P[u$W]=u$j),u$j},u$j.getChildAt=function(u$W){return this._childs[u$W]},u$j.setChildIndex=function(u$W,u$j){var u$t=this._childs;if(u$j<0||u$j>=u$t.length)throw new Error("setChildIndex:The index is out of bounds.");var u$d=this.getChildIndex(u$W);if(u$d<0)throw new Error("setChildIndex:node is must child of this object.");return u$t.splice(u$d,1),u$t.splice(u$j,0,u$W),this.conchModel&&(this.conchModel.removeChild(u$W.conchModel),this.conchModel.addChildAt(u$W.conchModel,u$j)),this._childChanged(),u$W},u$j._childChanged=function(u$W){},u$j.removeChild=function(u$W){if(!this._childs)return u$W;var u$j=this._childs.indexOf(u$W);return this.removeChildAt(u$j)},u$j.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},u$j.removeChildByName=function(u$W){var u$j=this.getChildByName(u$W);return u$j&&this.removeChild(u$j),u$j},u$j.removeChildAt=function(u$W){var u$j=this.getChildAt(u$W);if(u$j){for(var u$t=this._childs.length-1,u$d=u$W;u$d<u$t;++u$d)this._childs[u$d]=this._childs[u$d+1];this._childs.length=u$t,this.conchModel&&this.conchModel.removeChild(u$j.conchModel),u$j.parent=null}return u$j},u$j.removeChildren=function(u$W,u$j){if(void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=2147483647),this._childs&&0<this._childs.length){var u$t=this._childs;if(0===u$W&&u$E<=u$j){var u$d=u$t;this._childs=u$O.ARRAY_EMPTY}else u$d=u$t.splice(u$W,u$j-u$W);for(var u$b=0,u$E=u$d.length;u$b<u$E;u$b++)u$d[u$b].parent=null,this.conchModel&&this.conchModel.removeChild(u$d[u$b].conchModel)}return this},u$j.replaceChild=function(u$W,u$j){var u$t=this._childs.indexOf(u$j);return-1<u$t?(this._childs.splice(u$t,1,u$W),this.conchModel&&(this.conchModel.removeChild(u$j.conchModel),this.conchModel.addChildAt(u$W.conchModel,u$t)),u$j.parent=null,u$W.parent=this,u$W):null},u$j._updateDisplayedInstage=function(){var u$W;u$W=this;var u$j=u$N.stage;for(this._displayedInStage=!1;u$W;){if(u$W._getBit(1)){this._displayedInStage=u$W._displayedInStage;break}if(u$W==u$j||u$W._displayedInStage){this._displayedInStage=!0;break}u$W=u$W.parent}},u$j._setDisplay=function(u$W){this._displayedInStage!==u$W&&((this._displayedInStage=u$W)?this.event("display"):this.event("undisplay"))},u$j._displayChild=function(u$W,u$j){var u$t=u$W._childs;if(u$t)for(var u$d=0;u$d<u$t.length;u$d++){var u$b=u$t[u$d];u$b&&u$b._getBit(1)&&(0<u$b._childs.length?this._displayChild(u$b,u$j):u$b._setDisplay(u$j))}u$W._setDisplay(u$j)},u$j.contains=function(u$W){if(u$W===this)return!0;for(;u$W;){if(u$W.parent===this)return!0;u$W=u$W.parent}return!1},u$j.timerLoop=function(u$W,u$j,u$t,u$d,u$b,u$E){void 0===u$b&&(u$b=!0),void 0===u$E&&(u$E=!1),this.timer.loop(u$W,u$j,u$t,u$d,u$b,u$E)},u$j.timerOnce=function(u$W,u$j,u$t,u$d,u$b){void 0===u$b&&(u$b=!0),this.timer._create(!1,!1,u$W,u$j,u$t,u$d,u$b)},u$j.frameLoop=function(u$W,u$j,u$t,u$d,u$b){void 0===u$b&&(u$b=!0),this.timer._create(!0,!0,u$W,u$j,u$t,u$d,u$b)},u$j.frameOnce=function(u$W,u$j,u$t,u$d,u$b){void 0===u$b&&(u$b=!0),this.timer._create(!0,!1,u$W,u$j,u$t,u$d,u$b)},u$j.clearTimer=function(u$W,u$j){this.timer.clear(u$W,u$j)},u$$(0,u$j,"numChildren",function(){return this._childs.length}),u$$(0,u$j,"destroyed",function(){return this._destroyed}),u$$(0,u$j,"parent",function(){return this._parent},function(u$W){this._parent!==u$W&&(u$W?(this._parent=u$W,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),u$W.displayedInStage&&this._displayChild(this,!0)),u$W._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=u$W))}),u$$(0,u$j,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),u$O.ARRAY_EMPTY=[],u$O.PROP_EMPTY={},u$O.NOTICE_DISPLAY=1,u$O.MOUSEENABLE=2,u$O}(),u$jW=function(u$W){function u$Q(u$W){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,u$Q.__super.call(this),this._padding=u$Q._PADDING,this._spacing=u$Q._SPACING,this._aligns=u$Q._ALIGNS,this._font=u$T.EMPTY,this._ower=u$W}u$R(u$Q,"laya.display.css.CSSStyle",u$W);var u$j=u$Q.prototype;return u$j.destroy=function(){this._ower=null,this._font=null,this._rect=null},u$j.inherit=function(u$W){this._font=u$W._font,this._spacing=u$W._spacing===u$Q._SPACING?u$Q._SPACING:u$W._spacing.slice(),this.lineHeight=u$W.lineHeight},u$j._widthAuto=function(){return 0!=(262144&this._type)},u$j.widthed=function(u$W){return 0!=(8&this._type)},u$j._calculation=function(u$W,u$j){if(u$j.indexOf("%")<0)return!1;var u$d=this._ower,u$b=u$d.parent,u$E=this._rect;function u$O(u$W,u$j,u$t){return u$W*u$t[0]+u$j*u$t[1]+u$t[2]}function u$t(u$W){var u$j=u$b.width,u$t=u$d.width;u$E.width&&(u$d.width=u$O(u$j,u$t,u$E.width)),u$E.height&&(u$d.height=u$O(u$j,u$t,u$E.height)),u$E.left&&(u$d.x=u$O(u$j,u$t,u$E.left)),u$E.top&&(u$d.y=u$O(u$j,u$t,u$E.top))}null===u$E&&(u$b._getCSSStyle()._type|=524288,u$b.on("resize",this,u$t),this._rect=u$E={input:{}});var u$q=u$j.split(" ");return u$q[0]=parseFloat(u$q[0])/100,1==u$q.length?u$q[1]=u$q[2]=0:(u$q[1]=parseFloat(u$q[1])/100,u$q[2]=parseFloat(u$q[2])),u$E[u$W]=u$q,u$E.input[u$W]=u$j,u$t(),!0},u$j.heighted=function(u$W){return 0!=(8192&this._type)},u$j.size=function(u$W,u$j){var u$t=this._ower,u$d=!1;-1!==u$W&&u$W!=this._ower.width&&(this._type|=8,this._ower.width=u$W,u$d=!0),-1!==u$j&&u$j!=this._ower.height&&(this._type|=8192,this._ower.height=u$j,u$d=!0),u$d&&(u$t._layoutLater(),524288&this._type&&u$t.event("resize",this))},u$j._getAlign=function(){return this._aligns[0]},u$j._getValign=function(){return this._aligns[1]},u$j._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},u$j._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new u$T(this._font))},u$j.render=function(u$W,u$j,u$t,u$d){var u$b=u$W.width,u$E=u$W.height;u$t-=u$W.pivotX,u$d-=u$W.pivotY,this._bgground&&null!=this._bgground.color&&u$j.ctx.fillRect(u$t,u$d,u$b,u$E,this._bgground.color),this._border&&this._border.color&&u$j.drawRect(u$t,u$d,u$b,u$E,this._border.color.strColor,this._border.size)},u$j.getCSSStyle=function(){return this},u$j.cssText=function(u$W){this.attrs(u$Q.parseOneCSS(u$W,";"))},u$j.attrs=function(u$W){if(u$W)for(var u$j=0,u$t=u$W.length;u$j<u$t;u$j++){var u$d=u$W[u$j];this[u$d[0]]=u$d[1]}},u$j.setTransform=function(u$W){"none"===u$W?this._tf=u$q._TF_EMPTY:this.attrs(u$Q.parseOneCSS(u$W,","))},u$j.translate=function(u$W,u$j){this._tf===u$q._TF_EMPTY&&(this._tf=new u$b),this._tf.translateX=u$W,this._tf.translateY=u$j},u$j.scale=function(u$W,u$j){this._tf===u$q._TF_EMPTY&&(this._tf=new u$b),this._tf.scaleX=u$W,this._tf.scaleY=u$j},u$j._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},u$$(0,u$j,"block",u$W.prototype._$get_block,function(u$W){u$W?this._type|=1:this._type&=-2}),u$$(0,u$j,"valign",function(){return u$Q._valigndef[this._aligns[1]]},function(u$W){this._aligns===u$Q._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=u$Q._valigndef[u$W]}),u$$(0,u$j,"height",null,function(u$W){if(this._type|=8192,"string"==typeof u$W){if(this._calculation("height",u$W))return;u$W=parseInt(u$W)}this.size(-1,u$W)}),u$$(0,u$j,"width",null,function(u$W){if(this._type|=8,"string"==typeof u$W){var u$j=u$W.indexOf("auto");if(0<=u$j&&(this._type|=262144,u$W=u$W.substr(0,u$j)),this._calculation("width",u$W))return;u$W=parseInt(u$W)}this.size(u$W,-1)}),u$$(0,u$j,"fontWeight",function(){return this._font.weight},function(u$W){this._createFont().weight=u$W}),u$$(0,u$j,"left",null,function(u$W){var u$j=this._ower;if("string"==typeof u$W){if("center"===u$W?u$W="50% -50% 0":"right"===u$W&&(u$W="100% -100% 0"),this._calculation("left",u$W))return;u$W=parseInt(u$W)}u$j.x=u$W}),u$$(0,u$j,"_translate",null,function(u$W){this.translate(u$W[0],u$W[1])}),u$$(0,u$j,"absolute",function(){return 0!=(4&this._type)}),u$$(0,u$j,"top",null,function(u$W){var u$j=this._ower;if("string"==typeof u$W){if("middle"===u$W?u$W="50% -50% 0":"bottom"===u$W&&(u$W="100% -100% 0"),this._calculation("top",u$W))return;u$W=parseInt(u$W)}u$j.y=u$W}),u$$(0,u$j,"align",function(){return u$Q._aligndef[this._aligns[0]]},function(u$W){this._aligns===u$Q._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=u$Q._aligndef[u$W]}),u$$(0,u$j,"bold",function(){return this._font.bold},function(u$W){this._createFont().bold=u$W}),u$$(0,u$j,"padding",function(){return this._padding},function(u$W){this._padding=u$W}),u$$(0,u$j,"leading",function(){return this._spacing[1]},function(u$W){"string"==typeof u$W&&(u$W=parseInt(u$W+"")),this._spacing===u$Q._SPACING&&(this._spacing=[0,0]),this._spacing[1]=u$W}),u$$(0,u$j,"lineElement",function(){return 0!=(65536&this._type)},function(u$W){u$W?this._type|=65536:this._type&=-65537}),u$$(0,u$j,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(u$W){this.lineElement=!1,"right"===u$W?this._type|=32768:this._type&=-32769}),u$$(0,u$j,"textDecoration",function(){return this._font.decoration},function(u$W){this._createFont().decoration=u$W}),u$$(0,u$j,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(u$W){"nowrap"===u$W&&(this._type|=131072),"none"===u$W&&(this._type&=-131073)}),u$$(0,u$j,"background",null,function(u$W){u$W?(this._bgground||(this._bgground={}),this._bgground.color=u$W,this._ower.conchModel&&this._ower.conchModel.bgColor(u$W),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),u$$(0,u$j,"wordWrap",function(){return 0==(131072&this._type)},function(u$W){u$W?this._type&=-131073:this._type|=131072}),u$$(0,u$j,"color",function(){return this._font.color},function(u$W){this._createFont().color=u$W}),u$$(0,u$j,"password",function(){return this._font.password},function(u$W){this._createFont().password=u$W}),u$$(0,u$j,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(u$W){"none"===u$W?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=u$W),this._ower.conchModel&&this._ower.conchModel.bgColor(u$W),this._ower._renderType|=256}),u$$(0,u$j,"font",function(){return this._font.toString()},function(u$W){this._createFont().set(u$W)}),u$$(0,u$j,"weight",null,function(u$W){this._createFont().weight=u$W}),u$$(0,u$j,"letterSpacing",function(){return this._spacing[0]},function(u$W){"string"==typeof u$W&&(u$W=parseInt(u$W+"")),this._spacing===u$Q._SPACING&&(this._spacing=[0,0]),this._spacing[0]=u$W}),u$$(0,u$j,"fontSize",function(){return this._font.size},function(u$W){this._createFont().size=u$W}),u$$(0,u$j,"italic",function(){return this._font.italic},function(u$W){this._createFont().italic=u$W}),u$$(0,u$j,"fontFamily",function(){return this._font.family},function(u$W){this._createFont().family=u$W}),u$$(0,u$j,"stroke",function(){return this._font.stroke[0]},function(u$W){this._createFont().stroke===u$T._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=u$W}),u$$(0,u$j,"strokeColor",function(){return this._font.stroke[1]},function(u$W){this._createFont().stroke===u$T._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=u$W}),u$$(0,u$j,"border",function(){return this._border?this._border.value:""},function(u$W){if("none"!=u$W){this._border||(this._border={});var u$j=(this._border.value=u$W).split(" ");if(this._border.color=u$f.create(u$j[u$j.length-1]),1==u$j.length)return this._border.size=1,void(this._border.type="solid");var u$t=0;0<u$j[0].indexOf("px")?(this._border.size=parseInt(u$j[0]),u$t++):this._border.size=1,this._border.type=u$j[u$t],this._ower._renderType|=256}else this._border=null}),u$$(0,u$j,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(u$W){u$W?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==u$W?null:u$f.create(u$W),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),u$$(0,u$j,"position",function(){return 4&this._type?"absolute":""},function(u$W){"absolute"==u$W?this._type|=4:this._type&=-5}),u$$(0,u$j,"display",null,function(u$W){switch(u$W){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),u$$(0,u$j,"paddingLeft",function(){return this.padding[3]}),u$$(0,u$j,"paddingTop",function(){return this.padding[0]}),u$$(0,u$j,"_scale",null,function(u$W){this._ower.scale(u$W[0],u$W[1])}),u$$(0,u$j,"_rotate",null,function(u$W){this._ower.rotation=u$W}),u$Q.parseOneCSS=function(u$W,u$j){for(var u$t,u$d=[],u$b=u$W.split(u$j),u$E=0,u$O=u$b.length;u$E<u$O;u$E++){var u$q=u$b[u$E],u$A=u$q.indexOf(":"),u$c=u$q.substr(0,u$A).replace(/^\s+|\s+$/g,"");if(0!=u$c.length){var u$R=u$q.substr(u$A+1).replace(/^\s+|\s+$/g,""),u$m=[u$c,u$R];switch(u$c){case"italic":case"bold":u$m[1]="true"==u$R;break;case"line-height":u$m[0]="lineHeight",u$m[1]=parseInt(u$R);break;case"font-size":u$m[0]="fontSize",u$m[1]=parseInt(u$R);break;case"padding":1<(u$t=u$R.split(" ")).length||(u$t[1]=u$t[2]=u$t[3]=u$t[0]),u$m[1]=[parseInt(u$t[0]),parseInt(u$t[1]),parseInt(u$t[2]),parseInt(u$t[3])];break;case"rotate":u$m[0]="_rotate",u$m[1]=parseFloat(u$R);break;case"scale":u$t=u$R.split(" "),u$m[0]="_scale",u$m[1]=[parseFloat(u$t[0]),parseFloat(u$t[1])];break;case"translate":u$t=u$R.split(" "),u$m[0]="_translate",u$m[1]=[parseInt(u$t[0]),parseInt(u$t[1])];break;default:(u$m[0]=u$Q._CSSTOVALUE[u$c])||(u$m[0]=u$c)}u$d.push(u$m)}}return u$d},u$Q.parseCSS=function(u$W,u$j){for(var u$t;null!=(u$t=u$Q._parseCSSRegExp.exec(u$W));)u$Q.styleSheets[u$t[1]]=u$Q.parseOneCSS(u$t[2],";")},u$Q.EMPTY=new u$Q(null),u$Q._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},u$Q._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),u$Q._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},u$Q._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},u$Q.styleSheets={},u$Q.ALIGN_CENTER=1,u$Q.ALIGN_RIGHT=2,u$Q.VALIGN_MIDDLE=1,u$Q.VALIGN_BOTTOM=2,u$Q._CSS_BLOCK=1,u$Q._DISPLAY_NONE=2,u$Q._ABSOLUTE=4,u$Q._WIDTH_SET=8,u$Q._PADDING=[0,0,0,0],u$Q._RECT=[-1,-1,-1,-1],u$Q._SPACING=[0,0],u$Q._ALIGNS=[0,0,0],u$Q.ADDLAYOUTED=512,u$Q._NEWFONT=4096,u$Q._HEIGHT_SET=8192,u$Q._BACKGROUND_SET=16384,u$Q._FLOAT_RIGHT=32768,u$Q._LINE_ELEMENT=65536,u$Q._NOWARP=131072,u$Q._WIDTHAUTO=262144,u$Q._LISTERRESZIE=524288,u$Q}(u$q),u$tW=function(u$W){function u$O(){this.url=null,this.audio=null,this.loaded=!1,u$O.__super.call(this)}u$R(u$O,"laya.media.h5audio.AudioSound",u$c);var u$j=u$O.prototype;return u$j.dispose=function(){var u$W=u$O._audioCache[this.url];u$W&&(u$W.src="",delete u$O._audioCache[this.url])},u$j.load=function(u$W){var u$j;if(u$W=u$v.formatURL(u$W),(this.url=u$W)==u$x._tMusic?(u$O._initMusicAudio(),(u$j=u$O._musicAudio).src!=u$W&&(u$O._audioCache[u$j.src]=null,u$j=null)):u$j=u$O._audioCache[u$W],u$j&&2<=u$j.readyState)this.event("complete");else{u$j||(u$j=u$W==u$x._tMusic?(u$O._initMusicAudio(),u$O._musicAudio):u$Y.createElement("audio"),(u$O._audioCache[u$W]=u$j).src=u$W),u$j.addEventListener("canplaythrough",u$d),u$j.addEventListener("error",u$b);var u$t=this;(this.audio=u$j).load?u$j.load():u$b()}function u$d(){u$E(),u$t.loaded=!0,u$t.event("complete")}function u$b(){u$j.load=null,u$E(),u$t.event("error")}function u$E(){u$j.removeEventListener("canplaythrough",u$d),u$j.removeEventListener("error",u$b)}},u$j.play=function(u$W,u$j,u$t){if(void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),!this.url)return null;var u$d,u$b;if(!(u$d=this.url==u$x._tMusic?u$O._musicAudio:u$O._audioCache[this.url]))return null;u$b=u$r.getItem("audio:"+this.url),u$y.isConchApp?u$b||((u$b=u$Y.createElement("audio")).src=this.url):this.url==u$x._tMusic?(u$O._initMusicAudio(),(u$b=u$O._musicAudio).src=this.url):u$b=u$b||u$d.cloneNode(!0);var u$E=new u$QW(u$b);return u$E.url=this.url,u$E.loops=u$j,u$E.startTime=u$W,u$E.startHandler=u$t,u$E.play(!1),u$x.addChannel(u$E),u$E},u$$(0,u$j,"duration",function(){var u$W;return(u$W=u$O._audioCache[this.url])?u$W.duration:0}),u$O._initMusicAudio=function(){u$O._musicAudio||(u$O._musicAudio||(u$O._musicAudio=u$Y.createElement("audio")),u$y.isConchApp||u$Y.document.addEventListener("mousedown",u$O._makeMusicOK))},u$O._makeMusicOK=function(){u$Y.document.removeEventListener("mousedown",u$O._makeMusicOK),u$O._musicAudio.src?u$O._musicAudio.play():(u$O._musicAudio.src="",u$O._musicAudio.load())},u$O._audioCache={},u$O._musicAudio=null,u$O}(),u$dW=function(u$W){function u$j(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,u$j.__super.call(this)}u$R(u$j,"laya.media.SoundChannel",u$c);var u$t=u$j.prototype;return u$t.play=function(){},u$t.stop=function(){},u$t.pause=function(){},u$t.resume=function(){},u$t.__runComplete=function(u$W){u$W&&u$W.run()},u$$(0,u$t,"volume",function(){return 1},function(u$W){}),u$$(0,u$t,"position",function(){return 0}),u$$(0,u$t,"duration",function(){return 0}),u$j}(),u$bW=function(u$W){function u$j(){u$j.__super.call(this)}u$R(u$j,"laya.media.Sound",u$c);var u$t=u$j.prototype;return u$t.load=function(u$W){},u$t.play=function(u$W,u$j,u$t){return void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),null},u$t.dispose=function(){},u$$(0,u$t,"duration",function(){return 0}),u$j}(),u$EW=function(u$W){function u$b(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,u$b.__super.call(this)}u$R(u$b,"laya.media.webaudio.WebAudioSound",u$c);var u$j=u$b.prototype;return u$j.load=function(u$W){this.url=u$W,this.audioBuffer=u$b._dataCache[u$W],this.audioBuffer?this._loaded(this.audioBuffer):(u$b.e.on("loaded:"+u$W,this,this._loaded),u$b.e.on("err:"+u$W,this,this._err),u$b.__loadingSound[u$W]||(u$b.__loadingSound[u$W]=!0,u$N.loader.load(u$W,u$S.create(this,this.onloaded),null,u$qW.BUFFER,4,!1,null,!0)))},u$j.onloaded=function(u$W){u$W||this._err(),this._disposed?this._removeLoadEvents():(this.data=u$W,u$b.buffs.push({buffer:this.data,url:this.url}),u$b.decode())},u$j._err=function(){if(this._removeLoadEvents(),u$b.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var u$W,u$j,u$t,u$d=0;for(u$W=(u$j=this.__toPlays).length,u$d=0;u$d<u$W;u$d++)(u$t=u$j[u$d])[3]&&!u$t[3].isStopped&&u$t[3].event("error");this.__toPlays.length=0}},u$j._loaded=function(u$W){this._removeLoadEvents(),this._disposed||(this.audioBuffer=u$W,this.loaded=!0,this.event("complete"))},u$j._removeLoadEvents=function(){u$b.e.off("loaded:"+this.url,this,this._loaded),u$b.e.off("err:"+this.url,this,this._err)},u$j.__playAfterLoaded=function(){if(this.__toPlays){var u$W,u$j,u$t,u$d=0;for(u$W=(u$j=this.__toPlays).length,u$d=0;u$d<u$W;u$d++)(u$t=u$j[u$d])[3]&&!u$t[3].isStopped&&this.play(u$t[0],u$t[1],u$t[2],u$t[3]);this.__toPlays.length=0}},u$j.play=function(u$W,u$j,u$t,u$d){return void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),u$d=u$d||new u$TW,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([u$W,u$j,u$t,u$d]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),u$d.url=this.url,u$d.loops=u$j,u$d.audioBuffer=this.audioBuffer,u$d.startTime=u$W,u$d.startHandler=u$t,u$d.play(!1),u$x.addChannel(u$d),u$d},u$j.dispose=function(){this._disposed=!0,delete u$b._dataCache[this.url],delete u$b.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},u$$(0,u$j,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),u$b.decode=function(){if(!(u$b.buffs.length<=0||u$b.isDecoding))if(u$b.isDecoding=!0,(u$b.tInfo=u$b.buffs.shift())&&u$b.tInfo.buffer&&u$b.tInfo.buffer.byteLength)try{u$b.ctx.decodeAudioData(u$b.tInfo.buffer,u$b._done,u$b._fail)}catch(u$W){console.error("decodeAudioData error  byteLength:"+u$b.tInfo.buffer.byteLength+"  url:"+u$b.tInfo.url)}else u$b._fail()},u$b._done=function(u$W){u$b.e.event("loaded:"+u$b.tInfo.url,u$W),u$b._dataCache[u$b.tInfo.url]=u$W,u$b.isDecoding=!1,u$b.decode()},u$b._fail=function(){u$b.e.event("err:"+u$b.tInfo.url,null),u$b.isDecoding=!1,u$b.decode()},u$b._playEmptySound=function(){if(null!=u$b.ctx){if(u$b._emptySource&&(u$b._emptySource.stop(),u$b._emptySource.disconnect(0),!u$TW._tryCleanFailed))try{u$b._emptySource.buffer=null}catch(u$W){u$TW._tryCleanFailed=!0}var u$W=u$b.ctx.createBufferSource();u$W.buffer=u$b._miniBuffer,u$W.connect(u$b.ctx.destination),u$W.start(0,0,0),u$b._emptySource=u$W}},u$b._unlock=function(){u$b._unlocked||(u$b._playEmptySound(),"running"==u$b.ctx.state?(u$Y.document.removeEventListener("mousedown",u$b._unlock,!0),u$Y.document.removeEventListener("touchend",u$b._unlock,!0),u$Y.document.removeEventListener("touchstart",u$b._unlock,!0),u$b._unlocked=!0):"suspended"==u$b.ctx.state&&u$x._recoverWebAudio())},u$b.initWebAudio=function(){"running"!=u$b.ctx.state&&(u$b._unlock(),u$Y.document.addEventListener("mousedown",u$b._unlock,!0),u$Y.document.addEventListener("touchend",u$b._unlock,!0),u$Y.document.addEventListener("touchstart",u$b._unlock,!0))},u$b._emptySource=null,u$b._dataCache={},u$b.buffs=[],u$b.isDecoding=!1,u$b._unlocked=!1,u$b.tInfo=null,u$b.__loadingSound={},u$A(u$b,["window",function(){return this.window=u$Y.window},"webAudioEnabled",function(){return this.webAudioEnabled=u$b.window.AudioContext||u$b.window.webkitAudioContext||u$b.window.mozAudioContext},"ctx",function(){return this.ctx=u$b.webAudioEnabled?new(u$b.window.AudioContext||u$b.window.webkitAudioContext||u$b.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=u$b.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new u$c}]),u$b}(),u$OW=function(u$W){function u$j(){this._responseType=null,this._data=null,u$j.__super.call(this),this._http=new u$Y.window.XMLHttpRequest}u$R(u$j,"laya.net.HttpRequest",u$c);var u$t=u$j.prototype;return u$t.send=function(u$W,u$j,u$t,u$d,u$b){void 0===u$t&&(u$t="get"),void 0===u$d&&(u$d="text"),this._responseType=u$d,this._data=null;var u$E=this,u$O=this._http;if(u$O.open(u$t,u$W,!0),u$b)for(var u$q=0;u$q<u$b.length;u$q++)u$O.setRequestHeader(u$b[u$q++],u$b[u$q]);else u$y.isConchApp||(u$j&&"string"!=typeof u$j?u$O.setRequestHeader("Content-Type","application/json"):u$O.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));u$O.responseType="arraybuffer"!==u$d?"text":"arraybuffer",u$O.onerror=function(u$W){u$E._onError(u$W)},u$O.onabort=function(u$W){u$E._onAbort(u$W)},u$O.onprogress=function(u$W){u$E._onProgress(u$W)},u$O.onload=function(u$W){u$E._onLoad(u$W)},u$O.send(u$j)},u$t._onProgress=function(u$W){u$W&&u$W.lengthComputable&&this.event("progress",u$W.loaded/u$W.total)},u$t._onAbort=function(u$W){this.error("Request was aborted by user")},u$t._onError=function(u$W){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},u$t._onLoad=function(u$W){var u$j=this._http,u$t=void 0!==u$j.status?u$j.status:200;200===u$t||204===u$t||0===u$t?this.complete():this.error("["+u$j.status+"]"+u$j.statusText+":"+u$j.responseURL)},u$t.error=function(u$W){this.clear(),this.event("error",u$W)},u$t.complete=function(){this.clear();var u$j=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=u$n.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(u$W){u$j=!1,this.error(u$W.message)}u$j&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},u$t.clear=function(){var u$W=this._http;u$W.onerror=u$W.onabort=u$W.onprogress=u$W.onload=null},u$$(0,u$t,"url",function(){return this._http.responseURL}),u$$(0,u$t,"http",function(){return this._http}),u$$(0,u$t,"data",function(){return this._data}),u$j}(),u$qW=function(u$W){function u$L(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,u$L.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}u$R(u$L,"laya.net.Loader",u$c);var u$j=u$L.prototype;return u$j.load=function(u$W,u$j,u$t,u$d,u$b){if(u$W&&""!=u$W||console.error("Loader 加载的url不合法 "+u$W),void 0===u$t&&(u$t=!0),void 0===u$b&&(u$b=!1),0===(this._url=u$W).indexOf("data:image")?this._type=u$j="image":this._type=u$j||(u$j=this.getTypeFromUrl(u$W)),this._cache=u$t,this._data=null,!u$b&&u$L.loadedMap[u$W])return this._data=u$L.loadedMap[u$W],this.event("progress",1),void this.event("complete",this._data);if(u$d&&u$L.setGroup(u$W,u$d),null!=u$L.parserMap[u$j])return this._customParse=!0,void(u$L.parserMap[u$j]instanceof laya.utils.Handler?u$L.parserMap[u$j].runWith(this):u$L.parserMap[u$j].call(null,this));if("image"===u$j||"htmlimage"===u$j||"nativeimage"===u$j)return this._loadImage(u$W);if("ttf"===u$j)return this._loadTTF(u$W);switch(u$j){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:u$j}u$L.preLoadedMap[u$W]?this.onLoaded(u$L.preLoadedMap[u$W]):u$O.resMgrLoad(u$W,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},u$j.getTypeFromUrl=function(u$W){var u$j=u$n.getFileExtension(u$W);return u$j?u$L.typeMap[u$j]:(console.warn("Not recognize the resources suffix",u$W),"text")},u$j._loadTTF=function(u$W){u$W=u$v.formatURL(u$W);var u$j=new u$h;u$j.complete=u$S.create(this,this.onLoaded),u$j.load(u$W)},u$j._loadImage=function(u$W){u$O.imgMgrLoad(u$W,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},u$j._loadImageComplete=function(u$W,u$j,u$t){if(null!=u$t)if(u$t instanceof ArrayBuffer){var u$d=new DataView(u$t),u$b=new laya.webgl.resource.WebGLImage(new Uint8Array(u$t,8),u$W,0,!1,u$d.getUint32(0),u$d.getUint32(4));this.onLoaded(u$b)}else if(u$t instanceof u$RW)u$L.imgMgrSet[u$W]=u$j,u$O.imgMgrLock(u$W,u$L.imgMgrSet[u$W]),this._url=u$W,this.complete(u$t);else{var u$E=-1!=u$W.indexOf(".png",u$W.length-4)?6408:6407;u$b=new laya.webgl.resource.WebGLImage(u$t,u$W,u$E,!1,u$t.width,u$t.height);this.onLoaded(u$b)}else this.event("error","Load image failed")},u$j._loadSound=function(u$W){var u$j=new u$x._soundClass,u$t=this;function u$d(){u$j.offAll()}u$j.on("complete",this,function(){u$d(),u$t.onLoaded(u$j)}),u$j.on("error",this,function(){u$d(),u$j.dispose(),u$t.event("error","Load sound failed")}),u$j.load(u$W)},u$j.onProgress=function(u$W){"atlas"===this._type?this.event("progress",.3*u$W):this.event("progress",u$W)},u$j.onError=function(u$W){this.event("error",u$W)},u$j._loadedComplete=function(u$W,u$j,u$t){if(null!=u$t)switch(this._type){case"atlas":case"plf":case"json":var u$d=new u$H(u$t);this.onLoaded(JSON.parse(u$d.readUTFBytes()));break;case"font":u$d=new u$H(u$t);this.onLoaded(u$n.parseXMLFromString(u$d.readUTFBytes()));break;default:this.onLoaded(u$t)}else this.event("error",u$W)},u$j.onLoaded=function(u$W){var u$j=this._type;if("plf"==u$j)this.parsePLFData(u$W),this.complete(u$W);else if("image"===u$j){var u$t=new u$RW(u$W);u$t.url=this._url,this.complete(u$t)}else if("sound"===u$j||"htmlimage"===u$j||"nativeimage"===u$j)this.complete(u$W);else if("atlas"===u$j){if(!u$W.src&&!u$W._setContext){if(!this._data){if((this._data=u$W).meta&&u$W.meta.image)for(var u$d=u$W.meta.image.split(","),u$b=0<=this._url.indexOf("/")?"/":"\\",u$E=this._url.lastIndexOf(u$b),u$O=0<=u$E?this._url.substr(0,u$E+1):"",u$q=0,u$A=u$d.length;u$q<u$A;u$q++)u$d[u$q]=u$O+u$d[u$q];else u$d=[this._url.replace(".json",".png")];u$d.reverse(),u$W.toLoads=u$d,u$W.pics=[]}return this.event("progress",.3+1/u$d.length*.6),this._loadImage(u$d.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(u$W),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var u$c=this._data.frames,u$R=this._url.split("?")[0],u$m=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:u$R.substring(0,u$R.lastIndexOf("."))+"/",u$Q=this._data.pics,u$T=u$v.formatURL(this._url),u$$=u$L.atlasMap[u$T]||(u$L.atlasMap[u$T]=[]);u$$.dir=u$m;var u$e=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var u$K in u$e=parseFloat(this._data.meta.scale),u$c){var u$o,u$S=u$c[u$K],u$M=u$Q[u$S.frame.idx?u$S.frame.idx:0],u$Z=u$v.formatURL(u$m+u$K);u$M.scaleRate=u$e,u$o=u$RW.create(u$M,u$S.frame.x,u$S.frame.y,u$S.frame.w,u$S.frame.h,u$S.spriteSourceSize.x,u$S.spriteSourceSize.y,u$S.sourceSize.w,u$S.sourceSize.h),u$L.cacheRes(u$Z,u$o),u$L.keepCache(this._url,u$m+u$K),u$o.url=u$Z,u$$.push(u$Z)}else for(u$K in u$c)u$M=u$Q[(u$S=u$c[u$K]).frame.idx?u$S.frame.idx:0],u$Z=u$v.formatURL(u$m+u$K),u$L.cacheRes(u$Z,u$RW.create(u$M,u$S.frame.x,u$S.frame.y,u$S.frame.w,u$S.frame.h,u$S.spriteSourceSize.x,u$S.spriteSourceSize.y,u$S.sourceSize.w,u$S.sourceSize.h)),u$L.loadedMap[u$Z].url=u$Z,u$L.keepCache(this._url,u$m+u$K),u$$.push(u$Z);delete this._data.pics,this.complete(this._data)}else if("font"==u$j){if(!u$W.src)return this._data=u$W,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var u$X=new u$V;u$X.parseFont(this._data,u$W);var u$_=this._url.split(".fnt")[0].split("/"),u$N=u$_[u$_.length-1];u$KW.registerBitmapFont(u$N,u$X),this._data=u$X,this.complete(this._data)}else if("pkm"==u$j){var u$z=u$_W.create(u$W,this._url),u$C=new u$RW(u$z);u$C.url=this._url,this.complete(u$C)}else this.complete(u$W)},u$j.parsePLFData=function(u$W){var u$j,u$t,u$d;for(u$j in u$W)switch(u$d=u$W[u$j],u$j){case"json":case"text":for(u$t in u$d)u$L.preLoadedMap[u$v.formatURL(u$t)]=u$d[u$t];break;default:for(u$t in u$d)u$L.preLoadedMap[u$v.formatURL(u$t)]=u$d[u$t]}},u$j.complete=function(u$W){this._data=u$W,this._customParse?this.event("loaded",u$W instanceof Array?[u$W]:u$W):(u$L._loaders.push(this),u$L._isWorking||u$L.checkNext())},u$j.endLoad=function(u$W){u$W&&(this._data=u$W),this._cache&&u$L.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},u$$(0,u$j,"url",function(){return this._url}),u$$(0,u$j,"data",function(){return this._data}),u$$(0,u$j,"cache",function(){return this._cache}),u$$(0,u$j,"type",function(){return this._type}),u$L.checkNext=function(){u$L._isWorking=!0;for(var u$W=u$Y.now();u$L._startIndex<u$L._loaders.length;)if(u$Y.now(),u$L._loaders[u$L._startIndex].endLoad(),u$L._startIndex++,u$Y.now()-u$W>u$L.maxTimeOut)return console.warn("loader callback cost a long time:"+(u$Y.now()-u$W)+" url="+u$L._loaders[u$L._startIndex-1].url),void u$N.timer.frameOnce(1,null,u$L.checkNext);u$L._loaders.length=0,u$L._startIndex=0,u$L._isWorking=!1},u$L.clearRes=function(u$W,u$j){if(null!=u$W){void 0===u$j&&(u$j=!1),u$W=u$v.formatURL(u$W);var u$t=u$L.getAtlas(u$W);if(u$t){for(var u$d=0,u$b=u$t.length;u$d<u$b;u$d++){var u$E=u$t[u$d],u$O=u$L.getRes(u$E);delete u$L.loadedMap[u$E],u$L.clearCache(u$W.substring(u$v.basePath.length),u$E.substring(u$v.basePath.length)),u$O&&u$O.destroy(u$j)}u$t.length=0,delete u$L.atlasMap[u$W],delete u$L.loadedMap[u$W]}else{var u$q=u$L.loadedMap[u$W];u$q&&(delete u$L.loadedMap[u$W],u$q instanceof laya.resource.Texture&&u$q.bitmap&&u$q.destroy(u$j))}}},u$L.clearTextureRes=function(u$W){u$W=u$v.formatURL(u$W);var u$j=laya.net.Loader.getAtlas(u$W),u$t=u$j&&0<u$j.length?laya.net.Loader.getRes(u$j[0]):laya.net.Loader.getRes(u$W);u$t&&u$t.bitmap&&(u$y.isConchApp&&!u$y.isConchWebGL?u$t.bitmap.source.releaseTexture&&u$t.bitmap.source.releaseTexture():null==u$t.bitmap._atlaser&&u$t.bitmap.releaseResource(!0))},u$L.getRes=function(u$W){return u$L.loadedMap[u$v.formatURL(u$W)]},u$L.getAtlas=function(u$W){return u$L.atlasMap[u$v.formatURL(u$W)]},u$L.cacheRes=function(u$W,u$j){u$W=u$v.formatURL(u$W),null!=u$L.loadedMap[u$W]?console.warn("Resources already exist,is repeated loading:",u$W):u$L.loadedMap[u$W]=u$j},u$L.setGroup=function(u$W,u$j){u$L.groupMap[u$j]||(u$L.groupMap[u$j]=[]),u$L.groupMap[u$j].push(u$W)},u$L.clearResByGroup=function(u$W){if(u$L.groupMap[u$W]){var u$j=u$L.groupMap[u$W],u$t=0,u$d=u$j.length;for(u$t=0;u$t<u$d;u$t++)u$L.clearRes(u$j[u$t]);u$j.length=0}},u$L.keepCache=function(u$W,u$j){if(u$W&&u$j){var u$t=u$L.cacheSet[u$j];u$t?-1==u$t.indexOf(u$W)&&u$t.push(u$W):u$L.cacheSet[u$j]=[u$W]}},u$L.clearCache=function(u$W,u$j){if(u$W&&u$j){var u$t=u$L.cacheSet[u$j];if(u$t){var u$d=u$t.indexOf(u$W);if(-1!==u$d){var u$b=u$t.length-1;0==u$b?(delete u$L.cacheSet[u$j],0<u$L.imgMgrSet[u$j]?u$O.imgMgrFree(u$j,u$L.imgMgrSet[u$j]):u$L.clearRes(u$j,!0)):(u$t[u$d]=u$t[u$b],u$t.length=u$b)}}}},u$L.saveObject=function(u$W,u$j,u$t){if(u$j&&u$W){var u$d=u$L.objectSet[u$W];u$d?(console.warn("Loader.saveObject: "+u$W),u$d[0]=u$j,u$d[1]=u$t):u$L.objectSet[u$W]=[u$j,u$t,[]]}},u$L.findObject=function(u$W){if(u$W){var u$j=u$L.objectSet[u$W];if(u$j)return u$j[0]}return null},u$L.keepObject=function(u$W,u$j){if(u$W&&u$j){var u$t=u$L.objectSet[u$j];u$t&&-1===u$t[2].indexOf(u$W)&&u$t[2].push(u$W)}},u$L.clearObject=function(u$W,u$j){if(u$W&&u$j){var u$t=u$L.objectSet[u$j];if(u$t){var u$d=u$t[2],u$b=u$d.indexOf(u$W);if(-1!==u$b){var u$E=u$d.length-1;0==u$E?(delete u$L.objectSet[u$j],u$t[1]&&u$t[1].call(null,u$t[0])):(u$d[u$b]=u$d[u$E],u$d.length=u$E)}}}},u$L.TEXT="text",u$L.JSON="json",u$L.XML="xml",u$L.BUFFER="arraybuffer",u$L.IMAGE="image",u$L.SOUND="sound",u$L.ATLAS="atlas",u$L.FONT="font",u$L.TTF="ttf",u$L.PLF="plf",u$L.PKM="pkm",u$L.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},u$L.parserMap={},u$L.groupMap={},u$L.maxTimeOut=100,u$L.loadedMap={},u$L.preLoadedMap={},u$L.atlasMap={},u$L._loaders=[],u$L._isWorking=!1,u$L._startIndex=0,u$L.imgCache={},u$L.cacheSet={},u$L.objectSet={},u$L.imgMgrSet={},u$L}(),u$AW=function(u$W){var u$Q;function u$T(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},u$T.__super.call(this);for(var u$W=0;u$W<this._maxPriority;u$W++)this._resInfos[u$W]=[]}u$R(u$T,"laya.net.LoaderManager",u$c);var u$j=u$T.prototype;return u$j.create=function(u$W,u$t,u$j,u$d,u$b,u$E,u$O,u$q){if(null==u$E&&(u$E=2),null==u$O&&(u$O=!0),u$W instanceof Array){var u$A=u$W,u$c=u$A.length,u$R=0;if(u$j)var u$m=u$S.create(u$j.caller,u$j.method,u$j.args,!1);for(var u$Q=0;u$Q<u$c;u$Q++){var u$T=u$A[u$Q];"string"==typeof u$T&&(u$T=u$A[u$Q]={url:u$T}),u$T.progress=0}for(u$Q=0;u$Q<u$c;u$Q++){u$T=u$A[u$Q];var u$$=u$j?u$S.create(null,u$o,[u$T],!1):null,u$e=u$j||u$t?u$S.create(null,u$K,[u$T]):null;this._create(u$T.url,u$e,u$$,u$T.clas||u$d,u$T.params||u$b,null!=u$T.priority&&0<=u$T.priority?u$T.priority:u$E,u$O,u$T.group||u$q)}function u$K(u$W,u$j){u$R++,u$W.progress=1,u$R===u$c&&u$t&&u$t.run()}function u$o(u$W,u$j){u$W.progress=u$j;for(var u$t=0,u$d=0;u$d<u$c;u$d++){u$t+=u$A[u$d].progress}var u$b=u$t/u$c;u$m.runWith(u$b)}return!0}return this._create(u$W,u$t,u$j,u$d,u$b,u$E,u$O,u$q)},u$j._create=function(u$j,u$t,u$W,u$d,u$b,u$E,u$O,u$q){u$j&&""!=u$j||console.error("加载的url不合法 "+u$j),null==u$E&&(u$E=2),null==u$O&&(u$O=!0);var u$A=u$v.formatURL(u$j),u$c=this.getRes(u$A);if(u$c)!u$c.hasOwnProperty("loaded")||u$c.loaded?(u$W&&u$W.runWith(1),u$t&&u$t.run()):u$t&&u$N.loader._createListener(u$j,u$t.caller,u$t.method,u$t.args,!0,!1);else{var u$R=u$n.getFileExtension(u$j),u$m=u$T.createMap[u$R];if(!u$m)throw new Error("LoaderManager:unknown file("+u$j+") extension with: "+u$R+".");u$d||(u$d=u$m[0]);var u$Q=u$m[1];if("atlas"==u$R)this.load(u$j,u$t,u$W,u$Q,u$E,u$O);else{u$d===u$RW&&(u$Q="htmlimage"),(u$c=u$d?new u$d:null).hasOwnProperty("_loaded")&&(u$c._loaded=!1),u$c._setUrl(u$j),u$q&&u$c._setGroup(u$q),this._createLoad(u$c,u$j,u$S.create(null,function(u$W){u$c&&!u$c.destroyed&&u$W&&u$c.onAsynLoaded.call(u$c,u$j,u$W,u$b),u$t&&u$t.run();u$N.loader.event(u$j)}),u$W,u$Q,u$E,!1,u$q,!0),u$O&&this.cacheRes(u$A,u$c)}}return u$c},u$j.load=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){u$W&&""!=u$W||console.error("加载的url不合法 "+u$W);var u$A=this;if(null==u$b&&(u$b=2),null==u$E&&(u$E=!0),void 0===u$q&&(u$q=!1),u$W instanceof Array)return this._loadAssets(u$W,u$j,u$t,u$d,u$b,u$E,u$O);var u$c=u$qW.getRes(u$W);if(null!=u$c)u$N.timer.frameOnce(1,null,function(){u$t&&u$t.runWith(1),u$j&&u$j.runWith(u$c),u$A._loaderCount||u$A.event("complete")});else{var u$R=u$T._resMap[u$W];u$R?(u$j&&u$R._createListener("complete",u$j.caller,u$j.method,u$j.args,!1,!1),u$t&&u$R._createListener("progress",u$t.caller,u$t.method,u$t.args,!1,!1)):((u$R=this._infoPool.length?this._infoPool.pop():new u$Q).url=u$W,u$R.type=u$d,u$R.cache=u$E,u$R.group=u$O,u$R.ignoreCache=u$q,u$R.priority=u$b,u$j&&u$R.on("complete",u$j.caller,u$j.method,u$j.args),u$t&&u$R.on("progress",u$t.caller,u$t.method,u$t.args),u$T._resMap[u$W]=u$R,u$b=u$b<this._maxPriority?0<=u$b?u$b:0:this._maxPriority-1,this._resInfos[u$b].push(u$R),this._next())}return this},u$j._createLoad=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){var u$c=this;if(null==u$E&&(u$E=2),null==u$O&&(u$O=!0),void 0===u$A&&(u$A=!1),u$j instanceof Array)return this._loadAssets(u$j,u$t,u$d,u$b,u$E,u$O,u$q);var u$R=u$qW.getRes(u$j);if(null!=u$R)u$N.timer.frameOnce(1,null,function(){u$d&&u$d.runWith(1),u$t&&u$t.runWith(u$R),u$c._loaderCount||u$c.event("complete")});else{var u$m=u$T._resMap[u$j];u$m?(u$t&&u$m._createListener("complete",u$t.caller,u$t.method,u$t.args,!1,!1),u$d&&u$m._createListener("progress",u$d.caller,u$d.method,u$d.args,!1,!1)):((u$m=this._infoPool.length?this._infoPool.pop():new u$Q).url=u$j,u$m.clas=u$W,u$m.type=u$b,u$m.cache=u$O,u$m.group=u$q,u$m.ignoreCache=u$A,u$m.priority=u$E,u$t&&u$m.on("complete",u$t.caller,u$t.method,u$t.args),u$d&&u$m.on("progress",u$d.caller,u$d.method,u$d.args),u$T._resMap[u$j]=u$m,u$E=u$E<this._maxPriority?0<=u$E?u$E:0:this._maxPriority-1,this._resInfos[u$E].push(u$m),this._next())}return this},u$j._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var u$W=0;u$W<this._maxPriority;u$W++)for(var u$j=this._resInfos[u$W];0<u$j.length;){var u$t=u$j.shift();if(u$t)return this._doLoad(u$t)}this._loaderCount||this.event("complete")}},u$j._doLoad=function(u$j){this._loaderCount++;var u$t=this._loaders.length?this._loaders.pop():new u$qW;u$t.on("complete",null,u$b),u$t.on("progress",null,function(u$W){u$j.event("progress",u$W)}),u$t.on("error",null,function(u$W){u$b(null)});var u$d=this;function u$b(u$W){u$t.offAll(),u$t._data=null,u$t._customParse=!1,u$d._loaders.push(u$t),u$d._endLoad(u$j,u$W instanceof Array?[u$W]:u$W),u$d._loaderCount--,u$d._next()}u$t._class=u$j.clas,1<=u$j.priority?(u$t.priority=u$j.priority,u$t.realTime=!1):(u$t.priority=0,u$t.realTime=!0),u$t.load(u$j.url,u$j.type,u$j.cache,u$j.group,u$j.ignoreCache)},u$j._endLoad=function(u$W,u$j){var u$t=u$W.url;if(null==u$j){var u$d=this._failRes[u$t]||0;if(u$d<this.retryNum)return console.warn("[warn]Retry to load:",u$t),this._failRes[u$t]=u$d+1,void u$N.timer.once(this.retryDelay,this,this._addReTry,[u$W],!1);console.warn("[error]Failed to load:",u$t),this.event("error",u$t)}this._failRes[u$t]&&(this._failRes[u$t]=0),delete u$T._resMap[u$t],u$W.event("complete",u$j),u$W.offAll(),this._infoPool.push(u$W)},u$j._addReTry=function(u$W){this._resInfos[this._maxPriority-1].push(u$W),this._next()},u$j.clearRes=function(u$W,u$j){void 0===u$j&&(u$j=!1),u$qW.clearRes(u$W,u$j)},u$j.getRes=function(u$W){return u$qW.getRes(u$W)},u$j.cacheRes=function(u$W,u$j){u$qW.cacheRes(u$W,u$j)},u$j.clearTextureRes=function(u$W){u$qW.clearTextureRes(u$W)},u$j.setGroup=function(u$W,u$j){u$qW.setGroup(u$W,u$j)},u$j.clearResByGroup=function(u$W){u$qW.clearResByGroup(u$W)},u$j.clearUnLoaded=function(){for(var u$W=0;u$W<this._maxPriority;u$W++){for(var u$j=this._resInfos[u$W],u$t=u$j.length-1;-1<u$t;u$t--){var u$d=u$j[u$t];u$d&&(u$d.offAll(),this._infoPool.push(u$d))}u$j.length=0}this._loaderCount=0,u$T._resMap={}},u$j.cancelLoadByUrls=function(u$W){if(u$W)for(var u$j=0,u$t=u$W.length;u$j<u$t;u$j++)this.cancelLoadByUrl(u$W[u$j])},u$j.cancelLoadByUrl=function(u$W){for(var u$j=0;u$j<this._maxPriority;u$j++)for(var u$t=this._resInfos[u$j],u$d=u$t.length-1;-1<u$d;u$d--){var u$b=u$t[u$d];u$b&&u$b.url===u$W&&(u$t[u$d]=null,u$b.offAll(),this._infoPool.push(u$b))}u$T._resMap[u$W]&&delete u$T._resMap[u$W]},u$j._loadAssets=function(u$W,u$t,u$O,u$j,u$d,u$b,u$E){null==u$d&&(u$d=2),null==u$b&&(u$b=!0);for(var u$q=u$W.length,u$A=0,u$c=0,u$R=[],u$m=!0,u$Q=0;u$Q<u$q;u$Q++){var u$T=u$W[u$Q];if(!u$T)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+u$W);"string"==typeof u$T&&(u$T={url:u$T,type:u$j,size:1,priority:u$d}),u$T.size||(u$T.size=1),u$T.progress=0,u$c+=u$T.size,u$R.push(u$T);var u$$=u$O?u$S.create(null,u$o,[u$T],!1):null,u$e=u$t||u$O?u$S.create(null,u$K,[u$T]):null;this.load(u$T.url,u$e,u$$,u$T.type,null!=u$T.priority&&0<=u$T.priority?u$T.priority:2,u$b,u$T.group||u$E)}function u$K(u$W,u$j){u$A++,u$W.progress=1,u$j||(u$m=!1),u$A===u$q&&u$t&&u$t.runWith(u$m)}function u$o(u$W,u$j){if(null!=u$O){u$W.progress=u$j;for(var u$t=0,u$d=0;u$d<u$R.length;u$d++){var u$b=u$R[u$d];u$t+=u$b.size*u$b.progress}var u$E=u$t/u$c;u$O.runWith(u$E)}}return this},u$T.cacheRes=function(u$W,u$j){u$qW.cacheRes(u$W,u$j)},u$T._resMap={},u$A(u$T,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),u$T.__init$=function(){u$Q=function(u$W){function u$j(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,u$j.__super.call(this)}return u$R(u$j,"",u$c),u$j}()},u$T}(),u$cW=(function(u$W){function u$b(u$W){u$b.__super.call(this),u$W||(u$W=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var u$j=0,u$t=0,u$d=0;u$d<20;u$d++)u$d%5!=4?this._mat[u$j++]=u$W[u$d]:this._alpha[u$t++]=u$W[u$d];this._action=u$G.createFilterAction(32),this._action.data=this}u$R(u$b,"laya.filters.ColorFilter",u$o);var u$j=u$b.prototype;u$N.imps(u$j,{"laya.filters.IFilter":!0}),u$j.callNative=function(u$W){u$W._$P.cf=this;u$W.conchModel&&u$W.conchModel.setFilterMatrix&&u$W.conchModel.setFilterMatrix(this._mat,this._alpha)},u$$(0,u$j,"type",function(){return 32}),u$$(0,u$j,"action",function(){return this._action})}(),function(u$W){function u$d(u$W,u$j,u$t){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===u$j&&(u$j=0),u$d.__super.call(this),this._byteClass=u$t||u$H,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,u$W&&0<u$j&&u$j<65535&&this.connect(u$W,u$j)}u$R(u$d,"laya.net.Socket",u$c);var u$j=u$d.prototype;u$j.connect=function(u$W,u$j){var u$t="ws://"+u$W+":"+u$j;u$t="https:"==u$Y.window.location.protocol?"wss://"+u$W+":"+u$j:"ws://"+u$W+":"+u$j,this.connectByUrl(u$t)},u$j.connectByUrl=function(u$W){var u$j=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new u$Y.window.WebSocket(u$W,this.protocols):this._socket=new u$Y.window.WebSocket(u$W),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(u$W){u$j._onOpen(u$W)},this._socket.onmessage=function(u$W){u$j._onMessage(u$W)},this._socket.onclose=function(u$W){u$j._onClose(u$W)},this._socket.onerror=function(u$W){u$j._onError(u$W)}},u$j.cleanSocket=function(){try{this._socket.close()}catch(u$W){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},u$j.close=function(){if(null!=this._socket)try{this._socket.close()}catch(u$W){}},u$j._onOpen=function(u$W){this._connected=!0,this.event("open",u$W)},u$j._onMessage=function(u$W){if(u$W&&u$W.data){var u$j=u$W.data;if(this.disableInput&&u$j)this.event("message",u$j);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var u$t=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,u$j&&("string"==typeof u$j?this._input.writeUTFBytes(u$j):this._input.writeArrayBuffer(u$j),this._addInputPosition=this._input.pos,this._input.pos=u$t),this.event("message",u$j)}}},u$j._onClose=function(u$W){this._connected=!1,this.event("close",u$W)},u$j._onError=function(u$W){this.event("error",u$W)},u$j.send=function(u$W){this._socket.send(u$W)},u$j.flush=function(){if(this._output&&0<this._output.length){var u$j;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(u$W){u$j=u$W}this._output.endian=this.endian,this._output.clear(),u$j&&this.event("error",u$j)}},u$$(0,u$j,"input",function(){return this._input}),u$$(0,u$j,"output",function(){return this._output}),u$$(0,u$j,"connected",function(){return this._connected}),u$$(0,u$j,"endian",function(){return this._endian},function(u$W){this._endian=u$W,null!=this._input&&(this._input.endian=u$W),null!=this._output&&(this._output.endian=u$W)}),u$d.LITTLE_ENDIAN="littleEndian",u$d.BIG_ENDIAN="bigEndian"}(),function(u$W){function u$q(){u$q.__super.call(this),this._$1__id=++u$q._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(u$q._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,u$s.currentResourceManager&&u$s.currentResourceManager.addResource(this)}u$R(u$q,"laya.resource.Resource",u$c);var u$j=u$q.prototype;return u$N.imps(u$j,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),u$j._setUrl=function(u$W){var u$j;this._url!==u$W&&(this._url&&((u$j=u$q._urlResourcesMap[this._url]).splice(u$j.indexOf(this),1),0===u$j.length&&delete u$q._urlResourcesMap[this._url]),u$W&&((u$j=u$q._urlResourcesMap[u$W])||(u$q._urlResourcesMap[u$W]=u$j=[]),u$j.push(this)),this._url=u$W)},u$j._getGroup=function(){return this._group},u$j._setGroup=function(u$W){var u$j;this._group!==u$W&&(this._group&&((u$j=u$q._groupResourcesMap[this._group]).splice(u$j.indexOf(this),1),0===u$j.length&&delete u$q._groupResourcesMap[this._group]),u$W&&((u$j=u$q._groupResourcesMap[u$W])||(u$q._groupResourcesMap[u$W]=u$j=[]),u$j.push(this)),this._group=u$W)},u$j._addReference=function(){this._referenceCount++},u$j._removeReference=function(){this._referenceCount--},u$j._clearReference=function(){this._referenceCount=0},u$j._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},u$j.recreateResource=function(){this.completeCreate()},u$j.disposeResource=function(){},u$j.activeResource=function(u$W){void 0===u$W&&(u$W=!1),this._lastUseFrameCount=u$P.loopCount,!this._destroyed&&this.__loaded&&(this._released||u$W)&&this.recreateResource()},u$j.releaseResource=function(u$W){return void 0===u$W&&(u$W=!0),!(!u$W&&this.lock)&&(!(this._released&&!u$W)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},u$j.onAsynLoaded=function(u$W,u$j,u$t){throw new Error("Resource: must override this function!")},u$j.destroy=function(){var u$W;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete u$q._idResourcesMap[this.id],this._url&&((u$W=u$q._urlResourcesMap[this._url])&&(u$W.splice(u$W.indexOf(this),1),0===u$W.length&&delete u$q._urlResourcesMap[this.url]),u$qW.clearRes(this._url),this.__loaded||u$G.cancelLoadByUrl(this._url)),this._group&&((u$W=u$q._groupResourcesMap[this._group]).splice(u$W.indexOf(this),1),0===u$W.length&&delete u$q._groupResourcesMap[this.url]))},u$j.completeCreate=function(){this._released=!1,this.event("recovered",this)},u$j.dispose=function(){this.destroy()},u$$(0,u$j,"memorySize",function(){return this._memorySize},function(u$W){var u$j=u$W-this._memorySize;this._memorySize=u$W,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,u$j),this.resourceManager&&this.resourceManager.addSize(u$j)}),u$$(0,u$j,"_loaded",null,function(u$W){this.__loaded=u$W}),u$$(0,u$j,"loaded",function(){return this.__loaded}),u$$(0,u$j,"id",function(){return this._$1__id}),u$$(0,u$j,"destroyed",function(){return this._destroyed}),u$$(0,u$j,"group",function(){return this._getGroup()},function(u$W){this._setGroup(u$W)}),u$$(0,u$j,"resourceManager",function(){return this._resourceManager}),u$$(0,u$j,"url",function(){return this._url}),u$$(0,u$j,"released",function(){return this._released}),u$$(0,u$j,"referenceCount",function(){return this._referenceCount}),u$q.getResourceByID=function(u$W){return u$q._idResourcesMap[u$W]},u$q.getResourceByURL=function(u$W,u$j){return void 0===u$j&&(u$j=0),null==u$q._urlResourcesMap[u$W]?null:u$q._urlResourcesMap[u$W][u$j]},u$q.getResourceCountByURL=function(u$W){return u$q._urlResourcesMap[u$W].length},u$q.destroyUnusedResources=function(u$W){var u$j;if(u$W){var u$t=u$q._groupResourcesMap[u$W];if(u$t)for(var u$d=u$t.slice(),u$b=0,u$E=u$d.length;u$b<u$E;u$b++)(u$j=u$d[u$b]).lock||0!==u$j._referenceCount||u$j.destroy()}else for(var u$O in u$q._idResourcesMap)(u$j=u$q._idResourcesMap[u$O]).lock||0!==u$j._referenceCount||u$j.destroy()},u$q._uniqueIDCounter=0,u$q._idResourcesMap={},u$q._urlResourcesMap={},u$q._groupResourcesMap={},u$q}()),u$RW=function(u$W){function u$L(u$W,u$j){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,u$L.__super.call(this),u$W&&null!=u$W._addReference&&u$W._addReference(),this.setTo(u$W,u$j)}u$R(u$L,"laya.resource.Texture",u$c);var u$j=u$L.prototype;return u$j._setUrl=function(u$W){this.url=u$W},u$j.setTo=function(u$W,u$j){if(u$W instanceof u$O.HTMLElement){var u$t=u$MW.create("2D",u$W);this.bitmap=u$t}else this.bitmap=u$W;if(this.uv=u$j||u$L.DEF_UV,u$W){this._w=u$W.width,this._h=u$W.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var u$d=this;if(this._loaded)u$G.addToAtlas&&u$G.addToAtlas(u$d);else{var u$b=u$W;u$b instanceof laya.resource.HTMLImage&&u$b.image&&u$b.image.addEventListener("load",function(u$W){u$G.addToAtlas&&u$G.addToAtlas(u$d)},!1)}}},u$j.active=function(){this.bitmap&&this.bitmap.activeResource()},u$j.destroy=function(u$W){if(void 0===u$W&&(u$W=!1),this.alphaTexture&&(this.alphaTexture.destroy(u$W),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var u$j=this.bitmap;u$W?(u$y.isConchApp&&u$j.source&&u$j.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,u$j.dispose(),u$j._clearReference()):(u$j._removeReference(),0==u$j.referenceCount&&(u$y.isConchApp&&u$j.source&&u$j.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,u$j.dispose())),this.url&&this===u$N.loader.getRes(this.url)&&u$N.loader.clearRes(this.url,u$W),this._loaded=!1}},u$j.load=function(u$W){var u$j=this;this._loaded=!1,u$W=u$v.customFormat(u$W);var u$t=this.bitmap||(this.bitmap=u$_W.create(u$W));u$t.uri=u$W,u$t&&u$t._addReference();var u$d=this;u$t.onload=function(){u$t.onload=null,u$d._loaded=!0,u$j.sourceWidth=u$j._w=u$t.width,u$j.sourceHeight=u$j._h=u$t.height,u$d.event("loaded",this),u$G.addToAtlas&&u$G.addToAtlas(u$d)}},u$j.addTextureToAtlas=function(u$W){u$G.addTextureToAtlas(this)},u$j.getPixels=function(u$W,u$j,u$t,u$d){if(u$y.isConchApp){var u$b=this.bitmap;if(u$b.source&&u$b.source.getImageData){var u$E=u$b.source.getImageData(u$W,u$j,u$t,u$d),u$O=new Uint8Array(u$E);return Array.from(u$O)}return null}return u$y.isWebGL?u$G.getTexturePixels(this,u$W,u$j,u$t,u$d):(u$Y.canvas.size(u$t,u$d),u$Y.canvas.clear(),u$Y.context.drawTexture(this,-u$W,-u$j,this.width,this.height,0,0),u$Y.context.getImageData(0,0,u$t,u$d).data)},u$j.onAsynLoaded=function(u$W,u$j){if(u$j){if("function"!=typeof u$j._addReference)throw new Error("bitmap._addReference is not a function. "+u$j.className+" "+typeof u$j._addReference+" "+u$j.constructor);u$j._addReference()}this.setTo(u$j,this.uv),this._loaded&&this.event("loaded",this)},u$$(0,u$j,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),u$$(0,u$j,"loaded",function(){return this._loaded}),u$$(0,u$j,"released",function(){return!this.bitmap||this.bitmap.released}),u$$(0,u$j,"width",function(){return this._w?this._w:this.uv&&this.uv!==u$L.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(u$W){this._w=u$W,this.sourceWidth||(this.sourceWidth=u$W)}),u$$(0,u$j,"repeat",function(){return!u$y.isWebGL||!this.bitmap||this.bitmap.repeat},function(u$W){u$W&&u$y.isWebGL&&this.bitmap&&(this.bitmap.repeat=u$W)&&(this.bitmap.enableMerageInAtlas=!1)}),u$$(0,u$j,"height",function(){return this._h?this._h:this.uv&&this.uv!==u$L.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(u$W){this._h=u$W,this.sourceHeight||(this.sourceHeight=u$W)}),u$$(0,u$j,"isLinearSampling",function(){return!u$y.isWebGL||9728!=this.bitmap.minFifter},function(u$W){!u$W&&u$y.isWebGL&&(u$W||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),u$L.moveUV=function(u$W,u$j,u$t){for(var u$d=0;u$d<8;u$d+=2)u$t[u$d]+=u$W,u$t[u$d+1]+=u$j;return u$t},u$L.create=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){void 0===u$E&&(u$E=0),void 0===u$O&&(u$O=0),void 0===u$q&&(u$q=0),void 0===u$A&&(u$A=0);var u$c=u$W instanceof laya.resource.Texture,u$R=u$c?u$W.uv:u$L.DEF_UV,u$m=u$c?u$W.bitmap:u$W,u$Q=u$G.isAtlas(u$m);if(u$Q){var u$T=u$m._atlaser,u$$=u$W._atlasID;if(-1==u$$)throw new Error("create texture error");u$m=u$T._inAtlasTextureBitmapValue[u$$],u$R=u$T._inAtlasTextureOriUVValue[u$$]}var u$e=new u$L(u$m,null);u$m.width&&u$j+u$d>u$m.width&&(u$d=u$m.width-u$j),u$m.height&&u$t+u$b>u$m.height&&(u$b=u$m.height-u$t),u$e.width=u$d,u$e.height=u$b,u$e.offsetX=u$E,u$e.offsetY=u$O,u$e.sourceWidth=u$q||u$d,u$e.sourceHeight=u$A||u$b;var u$K=1/u$m.width,u$o=1/u$m.height;u$j*=u$K,u$t*=u$o,u$d*=u$K,u$b*=u$o;var u$S=u$e.uv[0],u$M=u$e.uv[1],u$Z=u$e.uv[4],u$X=u$e.uv[5],u$_=u$Z-u$S,u$N=u$X-u$M,u$z=u$L.moveUV(u$R[0],u$R[1],[u$j,u$t,u$j+u$d,u$t,u$j+u$d,u$t+u$b,u$j,u$t+u$b]);u$e.uv=[u$S+u$z[0]*u$_,u$M+u$z[1]*u$N,u$Z-(1-u$z[2])*u$_,u$M+u$z[3]*u$N,u$Z-(1-u$z[4])*u$_,u$X-(1-u$z[5])*u$N,u$S+u$z[6]*u$_,u$X-(1-u$z[7])*u$N],u$Q&&u$e.addTextureToAtlas();var u$C=u$m.scaleRate;return u$C&&1!=u$C?(u$e.sourceWidth/=u$C,u$e.sourceHeight/=u$C,u$e.width/=u$C,u$e.height/=u$C,u$e.scaleRate=u$C,u$e.offsetX/=u$C,u$e.offsetY/=u$C):u$e.scaleRate=1,u$e},u$L.createFromTexture=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$W.scaleRate;1!=u$E&&(u$j*=u$E,u$t*=u$E,u$d*=u$E,u$b*=u$E);var u$O=u$C.TEMP.setTo(u$j-u$W.offsetX,u$t-u$W.offsetY,u$d,u$b),u$q=u$O.intersection(u$L._rect1.setTo(0,0,u$W.width,u$W.height),u$L._rect2);if(!u$q)return null;var u$A=u$L.create(u$W,u$q.x,u$q.y,u$q.width,u$q.height,u$q.x-u$O.x,u$q.y-u$O.y,u$d,u$b);if(u$A.bitmap&&u$A.bitmap._removeReference)return u$A.bitmap._removeReference(),u$A;var u$c="bitmap:"+(u$A.bitmap?u$A.bitmap.constructor?u$A.bitmap.constructor.name:u$A.bitmap.__className:"")+", url:"+(u$W.url+" | "+(u$A.bitmap?u$A.bitmap.url:u$W.url))+", x="+u$j+",y="+u$t+",width="+u$d+",height="+u$b+", result="+(u$q?u$q.x+","+u$q.y+","+u$q.width+","+u$q.height:"null")+", rect="+u$O.x+","+u$O.y+","+u$O.width+","+u$O.height;throw new Error("报错：bitmap._removeReference is not a function  "+u$c)},u$L.DEF_UV=[0,0,1,0,1,1,0,1],u$L.INV_UV=[0,1,1,1,1,0,0,0],u$L._rect1=new u$C,u$L._rect2=new u$C,u$L}(),u$W=function(u$W){var u$q;function u$E(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,u$E.__super.call(this)}u$R(u$E,"laya.utils.TimeLine",u$c);var u$j=u$E.prototype;return u$j.to=function(u$W,u$j,u$t,u$d,u$b){return void 0===u$b&&(u$b=0),this._create(u$W,u$j,u$t,u$d,u$b,!0)},u$j.from=function(u$W,u$j,u$t,u$d,u$b){return void 0===u$b&&(u$b=0),this._create(u$W,u$j,u$t,u$d,u$b,!1)},u$j._create=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=u$r.getItemByClass("tweenData",u$q);return u$O.isTo=u$E,u$O.type=0,u$O.target=u$W,u$O.duration=u$t,u$O.data=u$j,u$O.startTime=this._startTime+u$b,u$O.endTime=u$O.startTime+u$O.duration,u$O.ease=u$d,this._startTime=Math.max(u$O.endTime,this._startTime),this._tweenDataList.push(u$O),this._startTimeSort=!0,this._endTimeSort=!0,this},u$j.addLabel=function(u$W,u$j){var u$t=u$r.getItemByClass("tweenData",u$q);return u$t.type=1,u$t.data=u$W,u$t.endTime=u$t.startTime=this._startTime+u$j,this._labelDic||(this._labelDic={}),this._labelDic[u$W]=u$t,this._tweenDataList.push(u$t),this},u$j.removeLabel=function(u$W){if(this._labelDic&&this._labelDic[u$W]){var u$j=this._labelDic[u$W];if(u$j){var u$t=this._tweenDataList.indexOf(u$j);-1<u$t&&this._tweenDataList.splice(u$t,1)}delete this._labelDic[u$W]}},u$j.gotoTime=function(u$W){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var u$j,u$t,u$d,u$b;for(var u$E in this._firstTweenDic)if(u$t=this._firstTweenDic[u$E])for(var u$O in u$t)u$t.diyTarget.hasOwnProperty(u$O)&&(u$t.diyTarget[u$O]=u$t[u$O]);for(u$E in this._tweenDic)(u$j=this._tweenDic[u$E]).clear(),delete this._tweenDic[u$E];if(this._index=0,this._gidIndex=0,this._currTime=u$W,this._lastTime=u$Y.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=u$d=this._tweenDataList.concat(),u$d.sort(function(u$W,u$j){return u$W.endTime>u$j.endTime?1:u$W.endTime<u$j.endTime?-1:0})}else u$d=this._endTweenDataList;for(var u$q=0,u$A=u$d.length;u$q<u$A;u$q++)if(0==(u$b=u$d[u$q]).type){if(!(u$W>=u$b.endTime))break;this._index=Math.max(this._index,u$q+1);var u$c=u$b.data;if(u$b.isTo)for(var u$R in u$c)u$b.target[u$R]=u$c[u$R]}for(u$q=0,u$A=this._tweenDataList.length;u$q<u$A;u$q++)0==(u$b=this._tweenDataList[u$q]).type&&u$W>=u$b.startTime&&u$W<u$b.endTime&&(this._index=Math.max(this._index,u$q+1),this._gidIndex++,(u$j=u$r.getItemByClass("tween",u$B))._create(u$b.target,u$b.data,u$b.duration,u$b.ease,u$S.create(this,this._animComplete,[this._gidIndex]),0,!1,u$b.isTo,!0,!1),u$j.setStartTime(this._currTime-(u$W-u$b.startTime)),u$j._updateEase(this._currTime),u$j.gid=this._gidIndex,this._tweenDic[this._gidIndex]=u$j)}},u$j.gotoLabel=function(u$W){if(null!=this._labelDic){var u$j=this._labelDic[u$W];u$j&&this.gotoTime(u$j.startTime)}},u$j.pause=function(){u$N.timer.clear(this,this._update)},u$j.resume=function(){this.play(this._currTime,this._loopKey)},u$j.play=function(u$W,u$j){if(void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(u$W,u$j){return u$W.startTime>u$j.startTime?1:u$W.startTime<u$j.startTime?-1:0});for(var u$t=0,u$d=this._tweenDataList.length;u$t<u$d;u$t++){var u$b=this._tweenDataList[u$t];if(null!=u$b&&0==u$b.type){var u$E=u$b.target,u$O=u$E.$_GID||(u$E.$_GID=u$n.getGID()),u$q=null;for(var u$A in null==this._firstTweenDic[u$O]?((u$q={}).diyTarget=u$E,this._firstTweenDic[u$O]=u$q):u$q=this._firstTweenDic[u$O],u$b.data)null==u$q[u$A]&&(u$q[u$A]=u$E[u$A])}}}"string"==typeof u$W?this.gotoLabel(u$W):this.gotoTime(u$W),this._loopKey=u$j,this._lastTime=u$Y.now(),u$N.timer.frameLoop(1,this,this._update)}},u$j._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var u$W in this._tweenDic)(u$j=this._tweenDic[u$W]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var u$j,u$t=u$Y.now(),u$d=u$t-this._lastTime,u$b=this._currTime+=u$d*this.scale;for(u$W in this._lastTime=u$t,this._tweenDic)(u$j=this._tweenDic[u$W])._updateEase(u$b);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var u$E=this._tweenDataList[this._index];u$b>=u$E.startTime&&(this._index++,0==u$E.type?(this._gidIndex++,(u$j=u$r.getItemByClass("tween",u$B))._create(u$E.target,u$E.data,u$E.duration,u$E.ease,u$S.create(this,this._animComplete,[this._gidIndex]),0,!1,u$E.isTo,!0,!1),u$j.setStartTime(u$b),u$j.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=u$j)._updateEase(u$b)):this.event("label",u$E.data))}},u$j._animComplete=function(u$W){this._tweenDic[u$W]&&delete this._tweenDic[u$W]},u$j._complete=function(){this.event("complete")},u$j.reset=function(){var u$W;if(this._labelDic)for(u$W in this._labelDic)delete this._labelDic[u$W];for(u$W in this._tweenDic)this._tweenDic[u$W].clear(),delete this._tweenDic[u$W];for(u$W in this._firstTweenDic)delete this._firstTweenDic[u$W];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var u$j,u$t=0;for(u$j=this._tweenDataList.length,u$t=0;u$t<u$j;u$t++)this._tweenDataList[u$t]&&this._tweenDataList[u$t].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,u$N.timer.clear(this,this._update)},u$j.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},u$$(0,u$j,"index",function(){return this._frameIndex},function(u$W){this._frameIndex=u$W,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),u$$(0,u$j,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),u$E.to=function(u$W,u$j,u$t,u$d,u$b){return void 0===u$b&&(u$b=0),(new u$E).to(u$W,u$j,u$t,u$d,u$b)},u$E.from=function(u$W,u$j,u$t,u$d,u$b){return void 0===u$b&&(u$b=0),(new u$E).from(u$W,u$j,u$t,u$d,u$b)},u$E.__init$=function(){u$q=function(){function u$W(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return u$R(u$W,""),u$W.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,u$r.recover("tweenData",this)},u$W}()},u$E}(),u$mW=function(u$b){function u$t(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,u$t.__super.call(this),this._style=u$q.EMPTY}u$R(u$t,"laya.display.Sprite",u$b);var u$W=u$t.prototype;return u$N.imps(u$W,{"laya.display.ILayout":!0}),u$W.createConchModel=function(){return new ConchNode},u$W.destroy=function(u$W){if(void 0===u$W&&(u$W=!0),this._releaseMem(),!this._destroyed){this.filters=null;var u$j=this.mask;u$j&&(this.mask=null,u$j.destroy(u$W))}u$b.prototype.destroy.call(this,u$W),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},u$W.updateZOrder=function(){u$n.updateOrder(this._childs)&&this.repaint()},u$W.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},u$W.setBounds=function(u$W){this._set$P("uBounds",u$W)},u$W.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new u$C),u$C._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},u$W.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new u$C),u$C._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},u$W._boundPointsToParent=function(u$W){void 0===u$W&&(u$W=!1);var u$j=0,u$t=0;this._style&&(u$j=this._style._tf.translateX,u$t=this._style._tf.translateY,u$W=u$W||0!==this._style._tf.rotate,this._style.scrollRect&&(u$j+=this._style.scrollRect.x,u$t+=this._style.scrollRect.y));var u$d=this._getBoundPointsM(u$W);if(!u$d||u$d.length<1)return u$d;if(8!=u$d.length&&(u$d=u$W?u$X.scanPList(u$d):u$C._getWrapRec(u$d,u$C.TEMP)._getBoundPoints()),!this.transform)return u$n.transPointList(u$d,this._x-u$j,this._y-u$t),u$d;var u$b=u$z.TEMP,u$E=0,u$O=u$d.length;for(u$E=0;u$E<u$O;u$E+=2)u$b.x=u$d[u$E],u$b.y=u$d[u$E+1],this.toParentPoint(u$b),u$d[u$E]=u$b.x,u$d[u$E+1]=u$b.y;return u$d},u$W.getGraphicBounds=function(u$W){return void 0===u$W&&(u$W=!1),this._graphics?this._graphics.getBounds(u$W):u$C.TEMP.setTo(0,0,0,0)},u$W._getBoundPointsM=function(u$W){if(void 0===u$W&&(u$W=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var u$j=u$n.clearArray(this._$P.temBM),u$t=u$C.TEMP;return u$t.copyFrom(this.scrollRect),u$n.concatArray(u$j,u$t._getBoundPoints()),u$j}for(var u$d,u$b,u$E,u$O=this._graphics?this._graphics.getBoundPoints():u$n.clearArray(this._$P.temBM),u$q=0,u$A=(u$E=this._childs).length;u$q<u$A;u$q++)(u$d=u$E[u$q])instanceof laya.display.Sprite&&1==u$d.visible&&(u$b=u$d._boundPointsToParent(u$W))&&(u$O=u$O?u$n.concatArray(u$O,u$b):u$b);return u$O},u$W.getStyle=function(){return this._style===u$q.EMPTY&&(this._style=new u$q),this._style},u$W.setStyle=function(u$W){this._style=u$W},u$W._adjustTransform=function(){this._tfChanged=!1;var u$W,u$j=this._style._tf,u$t=u$j.scaleX,u$d=u$j.scaleY;if(u$j.rotate||1!==u$t||1!==u$d||u$j.skewX||u$j.skewY){(u$W=this._transform||(this._transform=u$l.create())).bTransform=!0;var u$b=.0174532922222222*(u$j.rotate-u$j.skewX),u$E=.0174532922222222*(u$j.rotate+u$j.skewY),u$O=Math.cos(u$E),u$q=Math.sin(u$E),u$A=Math.sin(u$b),u$c=Math.cos(u$b);return u$W.a=u$t*u$O,u$W.b=u$t*u$q,u$W.c=-u$d*u$A,u$W.d=u$d*u$c,u$W.tx=u$W.ty=0,u$W}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,u$W},u$W.pos=function(u$W,u$j,u$t){if(void 0===u$t&&(u$t=!1),this._x!==u$W||this._y!==u$j){if(this.destroyed)return this;if(u$t){this._x=u$W,this._y=u$j,this.conchModel&&this.conchModel.pos(this._x,this._y);var u$d=this._parent;u$d&&0===u$d._repaint&&(u$d._repaint=1,u$d.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=u$W,this.y=u$j}return this},u$W.pivot=function(u$W,u$j){return this.pivotX=u$W,this.pivotY=u$j,this},u$W.size=function(u$W,u$j){return this.width=u$W,this.height=u$j,this},u$W.scale=function(u$W,u$j,u$t){void 0===u$t&&(u$t=!1);var u$d=this.getStyle(),u$b=u$d._tf;if(u$b.scaleX!=u$W||u$b.scaleY!=u$j){if(this.destroyed)return this;if(u$t){u$d.setScale(u$W,u$j),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(u$W,u$j),this._renderType|=4;var u$E=this._parent;u$E&&0===u$E._repaint&&(u$E._repaint=1,u$E.parentRepaint())}else this.scaleX=u$W,this.scaleY=u$j}return this},u$W.skew=function(u$W,u$j){return this.skewX=u$W,this.skewY=u$j,this},u$W.render=function(u$W,u$j,u$t){u$P.spriteCount++,u$u.renders[this._renderType]._fun(this,u$W,u$j+this._x,u$t+this._y),this._repaint=0},u$W.drawToCanvas=function(u$W,u$j,u$t,u$d){if(u$y.isConchNode){var u$b=u$MW.create("2D");return new u$a(u$W,u$j,u$b).ctx.setCanvasType(1),this.conchModel.drawToCanvas(u$b.source,u$t,u$d),u$b}return u$G.drawToCanvas(this,this._renderType,u$W,u$j,u$t,u$d)},u$W.customRender=function(u$W,u$j,u$t){this._renderType|=1024},u$W._applyFilters=function(){var u$W;if(!u$y.isWebGL&&((u$W=this._$P.filters)&&!(u$W.length<1)))for(var u$j=0,u$t=u$W.length;u$j<u$t;u$j++)u$W[u$j].action.apply(this._$P.cacheCanvas)},u$W._isHaveGlowFilter=function(){var u$W,u$j=0;if(this.filters)for(u$j=0;u$j<this.filters.length;u$j++)if(8==this.filters[u$j].type)return!0;for(u$j=0,u$W=this._childs.length;u$j<u$W;u$j++)if(this._childs[u$j]._isHaveGlowFilter())return!0;return!1},u$W.localToGlobal=function(u$W,u$j){void 0===u$j&&(u$j=!1),!0===u$j&&(u$W=new u$z(u$W.x,u$W.y));for(var u$t=this;u$t&&u$t!=u$N.stage;)u$W=u$t.toParentPoint(u$W),u$t=u$t.parent;return u$W},u$W.globalToLocal=function(u$W,u$j){void 0===u$j&&(u$j=!1),u$j&&(u$W=new u$z(u$W.x,u$W.y));for(var u$t=this,u$d=[];u$t&&u$t!=u$N.stage;)u$d.push(u$t),u$t=u$t.parent;for(var u$b=u$d.length-1;0<=u$b;)u$W=(u$t=u$d[u$b]).fromParentPoint(u$W),u$b--;return u$W},u$W.toParentPoint=function(u$W){if(!u$W)return u$W;u$W.x-=this.pivotX,u$W.y-=this.pivotY,this.transform&&this._transform.transformPoint(u$W),u$W.x+=this._x,u$W.y+=this._y;var u$j=this._style.scrollRect;return u$j&&(u$W.x-=u$j.x,u$W.y-=u$j.y),u$W},u$W.fromParentPoint=function(u$W){if(!u$W)return u$W;u$W.x-=this._x,u$W.y-=this._y;var u$j=this._style.scrollRect;return u$j&&(u$W.x+=u$j.x,u$W.y+=u$j.y),this.transform&&this._transform.invertTransformPoint(u$W),u$W.x+=this.pivotX,u$W.y+=this.pivotY,u$W},u$W.on=function(u$W,u$j,u$t,u$d){return 1!==this._mouseEnableState&&this.isMouseEvent(u$W)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(u$W,u$j,u$t,u$d,!1)):u$b.prototype.on.call(this,u$W,u$j,u$t,u$d)},u$W.once=function(u$W,u$j,u$t,u$d){return 1!==this._mouseEnableState&&this.isMouseEvent(u$W)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(u$W,u$j,u$t,u$d,!0)):u$b.prototype.once.call(this,u$W,u$j,u$t,u$d)},u$W._$2__onDisplay=function(){if(1!==this._mouseEnableState){var u$W=this;for(u$W=u$W.parent;u$W&&1!==u$W._mouseEnableState&&!u$W._getBit(2);)u$W.mouseEnabled=!0,u$W._setBit(2,!0),u$W=u$W.parent}},u$W.loadImage=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=this;return void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=0),void 0===u$b&&(u$b=0),this.graphics.loadImage(u$W,u$j,u$t,u$d,u$b,function(u$W){u$O.destroyed||(u$O.size(u$j+(u$d||u$W.width),u$t+(u$b||u$W.height)),u$O.repaint(),u$E&&u$E.runWith(u$W))}),this},u$W.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},u$W._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},u$W._childChanged=function(u$W){this._childs.length?this._renderType|=2048:this._renderType&=-2049,u$W&&this._get$P("hasZorder")&&u$N.timer.callLater(this,this.updateZOrder),this.repaint()},u$W.parentRepaint=function(){var u$W=this._parent;u$W&&0===u$W._repaint&&(u$W._repaint=1,u$W.parentRepaint())},u$W.startDrag=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){void 0===u$j&&(u$j=!1),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=300),void 0===u$E&&(u$E=!1),void 0===u$O&&(u$O=.92),this._$P.dragging||this._set$P("dragging",new u$w),this._$P.dragging.start(this,u$W,u$j,u$t,u$d,u$b,u$E,u$O)},u$W.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},u$W._releaseMem=function(){if(this._$P){var u$W=this._$P.cacheCanvas;u$W&&u$W.ctx&&(u$r.recover("RenderContext",u$W.ctx),u$W.ctx.canvas.size(0,0),u$W.ctx=null);var u$j=this._$P._filterCache;u$j&&(u$j.destroy(),u$j.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},u$W._setDisplay=function(u$W){u$W||this._releaseMem(),u$b.prototype._setDisplay.call(this,u$W)},u$W.hitTestPoint=function(u$W,u$j){var u$t=this.globalToLocal(u$z.TEMP.setTo(u$W,u$j));return u$W=u$t.x,u$j=u$t.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?u$C.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(u$W,u$j)},u$W.getMousePoint=function(){return this.globalToLocal(u$z.TEMP.setTo(u$N.stage.mouseX,u$N.stage.mouseY))},u$W._getWords=function(){return null},u$W._addChildsToLayout=function(u$W){var u$j=this._getWords();if(null==u$j&&0==this._childs.length)return!1;if(u$j)for(var u$t=0,u$d=u$j.length;u$t<u$d;u$t++)u$W.push(u$j[u$t]);u$t=0;for(var u$b=this._childs.length;u$t<u$b;++u$t){var u$E=this._childs[u$t];u$E._style._enableLayout()&&u$E._addToLayout(u$W)}return!0},u$W._addToLayout=function(u$W){this._style.absolute||(this._style.block?u$W.push(this):this._addChildsToLayout(u$W)&&(this.x=this.y=0))},u$W._isChar=function(){return!1},u$W._getCSSStyle=function(){return this._style.getCSSStyle()},u$W._setAttributes=function(u$W,u$j){switch(u$W){case"x":this.x=parseFloat(u$j);break;case"y":this.y=parseFloat(u$j);break;case"width":this.width=parseFloat(u$j);break;case"height":this.height=parseFloat(u$j);break;default:this[u$W]=u$j}},u$W._layoutLater=function(){this.parent&&this.parent._layoutLater()},u$$(0,u$W,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(u$W){this._optimizeScrollRect!=u$W&&(this._optimizeScrollRect=u$W,this.conchModel&&this.conchModel.optimizeScrollRect(u$W))}),u$$(0,u$W,"customRenderEnable",null,function(u$W){if(u$W&&(this._renderType|=1024,u$y.isConchNode)){u$t.CustomList.push(this);var u$j=new u$MW("2d");u$j._setContext(new CanvasRenderingContext2D),this.customContext=new u$a(0,0,u$j),u$j.context.setCanvasType&&u$j.context.setCanvasType(2),this.conchModel.custom(u$j.context)}}),u$$(0,u$W,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(u$W){this.cacheAs=u$W?this._$P.hasFilter?"none":"normal":"none"}),u$$(0,u$W,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(u$W){var u$j=this._$P.cacheCanvas;if(u$W!==(u$j?u$j.type:"none")){if("none"!==u$W)this._getBit(1)||this._setUpNoticeType(1),u$j||(u$j=this._set$P("cacheCanvas",u$r.getItemByClass("cacheCanvas",Object))),u$j.type=u$W,u$j.reCache=!0,this._renderType|=16,"bitmap"==u$W&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(u$j){var u$t=u$j;u$t&&u$t.ctx&&(u$r.recover("RenderContext",u$t.ctx),u$t.ctx.canvas.size(0,0),u$t.ctx=null),u$r.recover("cacheCanvas",u$j)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),u$$(0,u$W,"zOrder",function(){return this._zOrder},function(u$W){this._zOrder!=u$W&&(this._zOrder=u$W,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(u$W),this._parent&&(u$W&&this._parent._set$P("hasZorder",!0),u$N.timer.callLater(this._parent,this.updateZOrder)))}),u$$(0,u$W,"rotation",function(){return this._style._tf.rotate},function(u$W){var u$j=this.getStyle();if(u$j._tf.rotate!==u$W){u$j.setRotate(u$W),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(u$W),this._renderType|=4;var u$t=this._parent;u$t&&0===u$t._repaint&&(u$t._repaint=1,u$t.parentRepaint())}}),u$$(0,u$W,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(u$W){this._width!==u$W&&(this._width=u$W,this.conchModel&&this.conchModel.size(u$W,this._height),this.repaint())}),u$$(0,u$W,"x",function(){return this._x},function(u$W){if(this._x!==u$W){if(this.destroyed)return;this._x=u$W,this.conchModel&&this.conchModel.pos(u$W,this._y);var u$j=this._parent;u$j&&0===u$j._repaint&&(u$j._repaint=1,u$j.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),u$$(0,u$W,"globalScaleY",function(){for(var u$W=1,u$j=this;u$j&&u$j!==u$N.stage;)u$W*=u$j.scaleY,u$j=u$j.parent;return u$W}),u$$(0,u$W,"hitArea",function(){return this._$P.hitArea},function(u$W){this._set$P("hitArea",u$W)}),u$$(0,u$W,"staticCache",function(){return this._$P.staticCache},function(u$W){this._set$P("staticCache",u$W),u$W||this.reCache()}),u$$(0,u$W,"texture",function(){return this._texture},function(u$W){this._texture!=u$W&&(this._texture=u$W,this.graphics.cleanByTexture(u$W,0,0))}),u$$(0,u$W,"y",function(){return this._y},function(u$W){if(this._y!==u$W){if(this.destroyed)return;this._y=u$W,this.conchModel&&this.conchModel.pos(this._x,u$W);var u$j=this._parent;u$j&&0===u$j._repaint&&(u$j._repaint=1,u$j.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),u$$(0,u$W,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(u$W){this._height!==u$W&&(this._height=u$W,this.conchModel&&this.conchModel.size(this._width,u$W),this.repaint())}),u$$(0,u$W,"blendMode",function(){return this._style.blendMode},function(u$W){this.getStyle().blendMode=u$W,this.conchModel&&this.conchModel.blendMode(u$W),u$W&&"source-over"!=u$W?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),u$$(0,u$W,"scaleX",function(){return this._style._tf.scaleX},function(u$W){var u$j=this.getStyle();if(u$j._tf.scaleX!==u$W){u$j.setScaleX(u$W),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(u$W,u$j._tf.scaleY),this._renderType|=4;var u$t=this._parent;u$t&&0===u$t._repaint&&(u$t._repaint=1,u$t.parentRepaint())}}),u$$(0,u$W,"scaleY",function(){return this._style._tf.scaleY},function(u$W){var u$j=this.getStyle();if(u$j._tf.scaleY!==u$W){u$j.setScaleY(u$W),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(u$j._tf.scaleX,u$W),this._renderType|=4;var u$t=this._parent;u$t&&0===u$t._repaint&&(u$t._repaint=1,u$t.parentRepaint())}}),u$$(0,u$W,"stage",function(){return u$N.stage}),u$$(0,u$W,"skewX",function(){return this._style._tf.skewX},function(u$W){var u$j=this.getStyle();if(u$j._tf.skewX!==u$W){u$j.setSkewX(u$W),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(u$W,u$j._tf.skewY),this._renderType|=4;var u$t=this._parent;u$t&&0===u$t._repaint&&(u$t._repaint=1,u$t.parentRepaint())}}),u$$(0,u$W,"scrollRect",function(){return this._style.scrollRect},function(u$W){this.getStyle().scrollRect=u$W,this.repaint(),u$W?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(u$W.x,u$W.y,u$W.width,u$W.height)):(this._renderType&=-129,this.conchModel&&(u$t.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),u$$(0,u$W,"skewY",function(){return this._style._tf.skewY},function(u$W){var u$j=this.getStyle();if(u$j._tf.skewY!==u$W){u$j.setSkewY(u$W),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(u$j._tf.skewX,u$W),this._renderType|=4;var u$t=this._parent;u$t&&0===u$t._repaint&&(u$t._repaint=1,u$t.parentRepaint())}}),u$$(0,u$W,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(u$W){this._tfChanged=!1,(this._transform=u$W)&&(this._x=u$W.tx,this._y=u$W.ty,u$W.tx=u$W.ty=0,this.conchModel&&this.conchModel.transform(u$W.a,u$W.b,u$W.c,u$W.d,this._x,this._y)),u$W?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),u$$(0,u$W,"pivotX",function(){return this._style._tf.translateX},function(u$W){this.getStyle().setTranslateX(u$W),this.conchModel&&this.conchModel.pivot(u$W,this._style._tf.translateY),this.repaint()}),u$$(0,u$W,"pivotY",function(){return this._style._tf.translateY},function(u$W){this.getStyle().setTranslateY(u$W),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,u$W),this.repaint()}),u$$(0,u$W,"alpha",function(){return this._style.alpha},function(u$W){this._style&&this._style.alpha!==u$W&&(u$W=u$W<0?0:1<u$W?1:u$W,this.getStyle().alpha=u$W,this.conchModel&&this.conchModel.alpha(u$W),1!==u$W?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),u$$(0,u$W,"visible",function(){return this._style.visible},function(u$W){this._style&&this._style.visible!==u$W&&(this.getStyle().visible=u$W,this.conchModel&&this.conchModel.visible(u$W),this.parentRepaint())}),u$$(0,u$W,"graphics",function(){return this._graphics||(this.graphics=u$G.createGraphics())},function(u$W){this._graphics&&(this._graphics._sp=null),(this._graphics=u$W)?(this._renderType&=-2,this._renderType|=512,(u$W._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(u$t.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),u$$(0,u$W,"filters",function(){return this._$P.filters},function(u$W){u$W&&0===u$W.length&&(u$W=null),this._$P.filters!=u$W&&(this._set$P("filters",u$W?u$W.slice():null),u$y.isConchApp&&(this.conchModel&&(u$t.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),u$y.isWebGL&&(u$W&&u$W.length?this._renderType|=32:this._renderType&=-33),u$W&&0<u$W.length?(this._getBit(1)||this._setUpNoticeType(1),u$y.isWebGL&&1==u$W.length&&u$W[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(u$y.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),u$$(0,u$W,"parent",u$b.prototype._$get_parent,function(u$W){u$N.superSet(u$WW,this,"parent",u$W),u$W&&this._getBit(2)&&this._$2__onDisplay()}),u$$(0,u$W,"mask",function(){return this._$P._mask},function(u$W){u$W&&this.mask&&this.mask._$P.maskParent||(u$W?(this.cacheAs="bitmap",this._set$P("_mask",u$W),u$W._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",u$W),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(u$W?u$W.conchModel:null),this._renderType|=64,this.parentRepaint())}),u$$(0,u$W,"mouseEnabled",function(){return 1<this._mouseEnableState},function(u$W){this._mouseEnableState=u$W?2:1}),u$$(0,u$W,"globalScaleX",function(){for(var u$W=1,u$j=this;u$j&&u$j!==u$N.stage;)u$W*=u$j.scaleX,u$j=u$j.parent;return u$W}),u$$(0,u$W,"mouseX",function(){return this.getMousePoint().x}),u$$(0,u$W,"mouseY",function(){return this.getMousePoint().y}),u$t.fromImage=function(u$W){return(new u$t).loadImage(u$W)},u$t._cachePool=[],u$t.CustomList=[],u$A(u$t,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=u$O.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),u$t}(u$WW),u$QW=function(u$W){function u$j(u$W){this._audio=null,this._onEnd=null,this._resumePlay=null,u$j.__super.call(this),this._onEnd=u$n.bind(this.__onEnd,this),this._resumePlay=u$n.bind(this.__resumePlay,this),u$W.addEventListener("ended",this._onEnd),this._audio=u$W}u$R(u$j,"laya.media.h5audio.AudioSoundChannel",u$dW);var u$t=u$j.prototype;return u$t.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(u$N.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},u$t.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,u$Y.container.appendChild(this._audio),this._audio.play()}catch(u$W){this.event("error")}},u$t.play=function(u$W){this.isStopped=!1;try{this._audio.playbackRate=u$x.playbackRate,this._audio.currentTime=this.startTime}catch(u$W){return void this._audio.addEventListener("canplay",this._resumePlay)}u$x.addChannel(this),u$Y.container.appendChild(this._audio),!u$W&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},u$t.stop=function(){this.isStopped=!0,u$x.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&u$y.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),u$Y.onIE||this._audio!=u$tW._musicAudio&&u$r.recover("audio:"+this.url,this._audio),u$Y.removeElement(this._audio),this._audio=null)},u$t.pause=function(){this.isStopped=!0,u$x.removeChannel(this),"pause"in this._audio&&this._audio.pause()},u$t.resume=function(){this._audio&&(this.isStopped=!1,u$x.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},u$$(0,u$t,"position",function(){return this._audio?this._audio.currentTime:0}),u$$(0,u$t,"duration",function(){return this._audio?this._audio.duration:0}),u$$(0,u$t,"volume",function(){return this._audio?this._audio.volume:1},function(u$W){this._audio&&(this._audio.volume=u$W)}),u$j}(),u$TW=function(u$W){function u$j(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=u$EW.ctx,u$j.__super.call(this),this._onPlayEnd=u$n.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}u$R(u$j,"laya.media.webaudio.WebAudioSoundChannel",u$dW);var u$t=u$j.prototype;return u$t.play=function(u$W){if(u$x.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var u$j=this.context,u$t=this.gain,u$d=u$j.createBufferSource();(this.bufferSource=u$d).buffer=this.audioBuffer,u$d.connect(u$t),u$t&&u$t.disconnect(),u$t.connect(u$j.destination),u$d.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=u$Y.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(u$d.loop=!0),u$d.playbackRate.setTargetAtTime?u$d.playbackRate.setTargetAtTime(u$x.playbackRate,this.context.currentTime,.1):u$d.playbackRate.value=u$x.playbackRate,u$d.start(0,this.startTime),!u$W&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},u$t.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(u$N.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},u$t._clearBufferSource=function(){if(this.bufferSource){var u$W=this.bufferSource;u$W.stop?u$W.stop(0):u$W.noteOff(0),u$W.disconnect(0),u$W.onended=null,u$j._tryCleanFailed||this._tryClearBuffer(u$W),this.bufferSource=null}},u$t._tryClearBuffer=function(u$W){try{u$W.buffer=null}catch(u$W){u$j._tryCleanFailed=!0}},u$t.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,u$x.removeChannel(this),this.startHandler=null,this.completeHandler=null},u$t.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,u$x.removeChannel(this)},u$t.resume=function(){this.startTime=this._pauseTime,this.play(!1)},u$$(0,u$t,"position",function(){return this.bufferSource?(u$Y.now()-this._startTime)/1e3+this.startTime:0}),u$$(0,u$t,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),u$$(0,u$t,"volume",function(){return this._volume},function(u$W){this.isStopped||(this._volume=u$W,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(u$W,this.context.currentTime,.1):this.gain.gain.value=u$W)}),u$j._tryCleanFailed=!1,u$j}(),u$$W=function(u$W){function u$j(){u$j.__super.call(this),this._w=0,this._h=0}u$R(u$j,"laya.resource.Bitmap",u$cW);var u$t=u$j.prototype;return u$$(0,u$t,"width",function(){return this._w}),u$$(0,u$t,"height",function(){return this._h}),u$$(0,u$t,"source",function(){return this._source}),u$j}(),u$eW=function(u$j){function u$W(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,u$W.__super.call(this),this._interval=u$d.animationInterval,this._setUpNoticeType(1)}u$R(u$W,"laya.display.AnimationPlayerBase",u$j);var u$t=u$W.prototype;return u$t.play=function(u$W,u$j,u$t,u$d){void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=!0),void 0===u$t&&(u$t=""),void 0===u$d&&(u$d=!0),this._isPlaying=!0,this.index="string"==typeof u$W?this._getFrameByLabel(u$W):u$W,this.loop=u$j,this._actionName=u$t,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},u$t._getFrameByLabel=function(u$W){var u$j=0;for(u$j=0;u$j<this._count;u$j++)if(this._labels[u$j]&&0<=this._labels[u$j].indexOf(u$W))return u$j;return 0},u$t._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},u$t._setControlNode=function(u$W){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=u$W)&&u$W!=this&&(u$W.on("display",this,this._checkResumePlaying),u$W.on("undisplay",this,this._checkResumePlaying))},u$t._setDisplay=function(u$W){u$j.prototype._setDisplay.call(this,u$W),this._checkResumePlaying()},u$t._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},u$t.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},u$t.addLabel=function(u$W,u$j){this._labels||(this._labels={}),this._labels[u$j]||(this._labels[u$j]=[]),this._labels[u$j].push(u$W)},u$t.removeLabel=function(u$W){if(u$W){if(this._labels)for(var u$j in this._labels)this._removeLabelFromLabelList(this._labels[u$j],u$W)}else this._labels=null},u$t._removeLabelFromLabelList=function(u$W,u$j){if(u$W)for(var u$t=u$W.length-1;0<=u$t;u$t--)u$W[u$t]==u$j&&u$W.splice(u$t,1)},u$t.gotoAndStop=function(u$W){this.index="string"==typeof u$W?this._getFrameByLabel(u$W):u$W,this.stop()},u$t._displayToIndex=function(u$W){},u$t.clear=function(){this.stop(),this._labels=null},u$$(0,u$t,"interval",function(){return this._interval},function(u$W){this._interval!=u$W&&(this._frameRateChanged=!0,this._interval=u$W,this._isPlaying&&0<u$W&&this.timerLoop(u$W,this,this._frameLoop,null,!0,!0))}),u$$(0,u$t,"isPlaying",function(){return this._isPlaying}),u$$(0,u$t,"index",function(){return this._index},function(u$W){if(this._index=u$W,this._displayToIndex(u$W),this._labels&&this._labels[u$W])for(var u$j=this._labels[u$W],u$t=0,u$d=u$j.length;u$t<u$d;u$t++)this.event("label",u$j[u$t])}),u$$(0,u$t,"count",function(){return this._count}),u$W.WRAP_POSITIVE=0,u$W.WRAP_REVERSE=1,u$W.WRAP_PINGPONG=2,u$W}(u$mW),u$KW=function(u$j){function u$T(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,u$T.__super.call(this),this.overflow=u$T.VISIBLE,this._style=new u$jW(this),this._style.wordWrap=!1}u$R(u$T,"laya.display.Text",u$j);var u$W=u$T.prototype;return u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,u$W),this._lines=null,this._words&&(this._words.length=0,this._words=null)},u$W._getBoundPointsM=function(u$W){void 0===u$W&&(u$W=!1);var u$j=u$C.TEMP;return u$j.setTo(0,0,this.width,this.height),u$j._getBoundPoints()},u$W.getGraphicBounds=function(u$W){void 0===u$W&&(u$W=!1);var u$j=u$C.TEMP;return u$j.setTo(0,0,this.width,this.height),u$j},u$W._getCSSStyle=function(){return this._style},u$W.lang=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R){if(u$W=u$T.langPacks&&u$T.langPacks[u$W]?u$T.langPacks[u$W]:u$W,arguments.length<2)this._text=u$W;else{for(var u$m=0,u$Q=arguments.length;u$m<u$Q;u$m++)u$W=u$W.replace("{"+u$m+"}",arguments[u$m+1]);this._text=u$W}},u$W._isPassWordMode=function(){var u$W=this._style.password;return"prompt"in this&&this.prompt==this._text&&(u$W=!1),u$W},u$W._getPassWordTxt=function(u$W){var u$j;u$j="";for(var u$t=u$W.length;0<u$t;u$t--)u$j+="●";return u$j},u$W.renderText=function(u$W,u$j){var u$t=this.graphics;u$t.clear(!0);var u$d=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(u$Y.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);u$Y.context.font=u$d;var u$b=this.padding,u$E=u$b[3],u$O="left",u$q=this._lines,u$A=this.leading+this._charSize.height,u$c=this._currBitmapFont;u$c&&(u$A=this.leading+u$c.getMaxHeight());var u$R=u$b[0];if(!u$c&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(u$O="right",u$E=this._width-u$b[1]):"center"==this.align&&(u$O="center",u$E=.5*this._width+u$b[3]-u$b[1])),0<this._height){var u$m=this._textHeight>this._height?"top":this.valign;"middle"===u$m?u$R=.5*(this._height-u$j*u$A)+u$b[0]-u$b[2]:"bottom"===u$m&&(u$R=this._height-u$j*u$A-u$b[2])}var u$Q=this._style;if(u$c&&u$c.autoScaleSize)var u$T=u$c.fontSize/this.fontSize;if(this._clipPoint)if(u$t.save(),u$c&&u$c.autoScaleSize){var u$$=0,u$e=0;u$$=this._width?this._width-u$b[3]-u$b[1]:this._textWidth,u$e=this._height?this._height-u$b[0]-u$b[2]:this._textHeight,u$$*=u$T,u$e*=u$T,u$t.clipRect(u$b[3],u$b[0],u$$,u$e)}else u$t.clipRect(u$b[3],u$b[0],this._width?this._width-u$b[3]-u$b[1]:this._textWidth,this._height?this._height-u$b[0]-u$b[2]:this._textHeight);var u$K=u$Q.password;"prompt"in this&&this.prompt==this._text&&(u$K=!1);for(var u$o=0,u$S=0,u$M=Math.min(this._lines.length,u$j+u$W)||1,u$Z=u$W;u$Z<u$M;u$Z++){var u$X,u$_=u$q[u$Z];if(u$K){var u$N=u$_.length;u$_="";for(var u$z=u$N;0<u$z;u$z--)u$_+="●"}if(u$o=u$E-(this._clipPoint?this._clipPoint.x:0),u$S=u$R+u$A*u$Z-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(u$O,u$o,u$S,u$Z),u$c){var u$C=this.width;u$c.autoScaleSize&&(u$C=this.width*u$T),u$c.drawText(u$_,this,u$o,u$S,this.align,u$C)}else u$y.isWebGL?(this._words||(this._words=[]),(u$X=this._words.length>u$Z-u$W?this._words[u$Z-u$W]:new u$F).setText(u$_)):u$X=u$_,u$Q.stroke?u$t.fillBorderText(u$X,u$o,u$S,u$d,this.color,u$Q.strokeColor,u$Q.stroke,u$O):u$t.fillText(u$X,u$o,u$S,u$d,this.color,u$O)}if(u$c&&u$c.autoScaleSize){var u$L=1/u$T;this.scale(u$L,u$L)}this._clipPoint&&u$t.restore(),this._startX=u$E,this._startY=u$R},u$W.drawUnderline=function(u$W,u$j,u$t,u$d){var u$b=this._lineWidths[u$d];switch(u$W){case"center":u$j-=u$b/2;break;case"right":u$j-=u$b}u$t+=this._charSize.height,this._graphics.drawLine(u$j,u$t,u$j+u$b,u$t,this.underlineColor||this.color,1)},u$W.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);u$Y.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new u$z(0,0)):this._clipPoint=null;var u$W=this._lines.length;if(this.overflow!=u$T.VISIBLE){var u$j=this.overflow==u$T.HIDDEN?Math.floor:Math.ceil;u$W=Math.min(u$W,u$j((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var u$t=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(u$t,u$W),this.repaint()},u$W.evalTextSize=function(){var u$W,u$j=NaN;u$W=Math.max.apply(this,this._lineWidths),u$j=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],u$W==this._textWidth&&u$j==this._textHeight||(this._textWidth=u$W,this._textHeight=u$j,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},u$W.checkEnabledViewportOrNot=function(){return this.overflow==u$T.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},u$W.changeText=function(u$W){this._text!==u$W&&(this.lang(u$W+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},u$W.parseLines=function(u$W){var u$j=this.wordWrap||this.overflow==u$T.HIDDEN;if(u$j)var u$t=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var u$d=u$Y.context.measureText(u$T._testWord);u$y.isConchApp&&0===u$d.width&&0===u$d.height&&(u$d=u$Y.context.measureText("W")),this._charSize.width=u$d.width,this._charSize.height=u$d.height||this.fontSize}for(var u$b=u$W.replace(/\r\n/g,"\n").split("\n"),u$E=0,u$O=u$b.length;u$E<u$O;u$E++){var u$q=u$b[u$E];u$j?this.parseLine(u$q,u$t):(this._lineWidths.push(this.getTextWidth(u$q)),this._lines.push(u$q))}},u$W.parseLine=function(u$W,u$j){u$Y.context;var u$t,u$d=this._lines,u$b=0,u$E=NaN,u$O=NaN,u$q=0;if((u$E=this.getTextWidth(u$W))<=u$j)return u$d.push(u$W),void this._lineWidths.push(u$E);u$E=this._charSize.width,0==(u$b=Math.floor(u$j/u$E))&&(u$b=1),u$O=u$E=this.getTextWidth(u$W.substring(0,u$b));for(var u$A=u$b,u$c=u$W.length;u$A<u$c;u$A++)if(u$j<(u$O+=u$E=this.getTextWidth(u$W.charAt(u$A))))if(this.wordWrap){var u$R=u$W.substring(u$q,u$A);if(u$R.charCodeAt(u$R.length-1)<255?(u$t=/(?:\w|-)+$/.exec(u$R))&&(u$A=u$t.index+u$q,0==u$t.index?u$A+=u$R.length:u$R=u$W.substring(u$q,u$A)):u$T.RightToLeft&&(u$t=/([\u0600-\u06FF])+$/.exec(u$R))&&(u$A=u$t.index+u$q,0==u$t.index?u$A+=u$R.length:u$R=u$W.substring(u$q,u$A)),u$d.push(u$R),this._lineWidths.push(u$O-u$E),!((u$q=u$A)+u$b<u$c)){u$d.push(u$W.substring(u$q,u$c)),this._lineWidths.push(this.getTextWidth(u$d[u$d.length-1])),u$q=-1;break}u$A+=u$b,u$O=u$E=this.getTextWidth(u$W.substring(u$q,u$A)),u$A--}else if(this.overflow==u$T.HIDDEN)return u$d.push(u$W.substring(0,u$A)),void this._lineWidths.push(this.getTextWidth(u$d[u$d.length-1]));this.wordWrap&&-1!=u$q&&(u$d.push(u$W.substring(u$q,u$c)),this._lineWidths.push(this.getTextWidth(u$d[u$d.length-1])))},u$W.getTextWidth=function(u$W){return this._currBitmapFont?this._currBitmapFont.getTextWidth(u$W):u$Y.context.measureText(u$W).width},u$W.getWordWrapWidth=function(){var u$W=this.padding,u$j=NaN;return(u$j=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(u$j=this.wordWrap?100:u$Y.width),u$j<=0&&(u$j=100),u$j-u$W[3]-u$W[1]},u$W.getCharPoint=function(u$W,u$j){this._isChanged&&u$N.timer.runCallLater(this,this.typeset);for(var u$t=0,u$d=this._lines,u$b=0,u$E=0,u$O=u$d.length;u$E<u$O;u$E++){if(u$W<(u$t+=u$d[u$E].length)){var u$q=u$E;break}u$b=u$t}var u$A=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;u$Y.context.font=u$A;var u$c=this.getTextWidth(this._text.substring(u$b,u$W));return(u$j||new u$z).setTo(this._startX+u$c-(this._clipPoint?this._clipPoint.x:0),this._startY+u$q*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},u$$(0,u$W,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(u$W){u$W!=this._width&&(u$N.superSet(u$mW,this,"width",u$W),this.isChanged=!0)}),u$$(0,u$W,"textWidth",function(){return this._isChanged&&u$N.timer.runCallLater(this,this.typeset),this._textWidth}),u$$(0,u$W,"height",function(){return this._height?this._height:this.textHeight},function(u$W){u$W!=this._height&&(u$N.superSet(u$mW,this,"height",u$W),this.isChanged=!0)}),u$$(0,u$W,"textHeight",function(){return this._isChanged&&u$N.timer.runCallLater(this,this.typeset),this._textHeight}),u$$(0,u$W,"padding",function(){return this._getCSSStyle().padding},function(u$W){this._getCSSStyle().padding=u$W,this.isChanged=!0}),u$$(0,u$W,"bold",function(){return this._getCSSStyle().bold},function(u$W){this._getCSSStyle().bold=u$W,this.isChanged=!0}),u$$(0,u$W,"text",function(){return this._text||""},function(u$W){this._text!==u$W&&(this.lang(u$W+""),this.isChanged=!0,this.event("change"))}),u$$(0,u$W,"color",function(){return this._getCSSStyle().color},function(u$W){this._getCSSStyle().color!=u$W&&(this._getCSSStyle().color=u$W,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),u$$(0,u$W,"font",function(){return this._getCSSStyle().fontFamily},function(u$W){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),u$T._bitmapFonts&&u$T._bitmapFonts[u$W]&&(this._currBitmapFont=u$T._bitmapFonts[u$W]),this._getCSSStyle().fontFamily=u$W,this.isChanged=!0}),u$$(0,u$W,"fontSize",function(){return this._getCSSStyle().fontSize},function(u$W){this._getCSSStyle().fontSize=u$W,this.isChanged=!0}),u$$(0,u$W,"italic",function(){return this._getCSSStyle().italic},function(u$W){this._getCSSStyle().italic=u$W,this.isChanged=!0}),u$$(0,u$W,"align",function(){return this._getCSSStyle().align},function(u$W){this._getCSSStyle().align=u$W,this.isChanged=!0}),u$$(0,u$W,"valign",function(){return this._getCSSStyle().valign},function(u$W){this._getCSSStyle().valign=u$W,this.isChanged=!0}),u$$(0,u$W,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(u$W){this._getCSSStyle().wordWrap=u$W,this.isChanged=!0}),u$$(0,u$W,"leading",function(){return this._getCSSStyle().leading},function(u$W){this._getCSSStyle().leading=u$W,this.isChanged=!0}),u$$(0,u$W,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(u$W){this._getCSSStyle().backgroundColor=u$W,this.isChanged=!0}),u$$(0,u$W,"borderColor",function(){return this._getCSSStyle().borderColor},function(u$W){this._getCSSStyle().borderColor=u$W,this.isChanged=!0}),u$$(0,u$W,"stroke",function(){return this._getCSSStyle().stroke},function(u$W){this._getCSSStyle().stroke=u$W,this.isChanged=!0}),u$$(0,u$W,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(u$W){this._getCSSStyle().strokeColor=u$W,this.isChanged=!0}),u$$(0,u$W,"isChanged",null,function(u$W){this._isChanged!==u$W&&(this._isChanged=u$W)&&u$N.timer.callLater(this,this.typeset)}),u$$(0,u$W,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(u$W){if(!(this.overflow!=u$T.SCROLL||this.textWidth<this._width)&&this._clipPoint){u$W=u$W<this.padding[3]?this.padding[3]:u$W;var u$j=this._textWidth-this._width;u$W=u$j<u$W?u$j:u$W;var u$t=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=u$W,this.renderText(this._lastVisibleLineIndex,u$t)}}),u$$(0,u$W,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(u$W){if(!(this.overflow!=u$T.SCROLL||this.textHeight<this._height)&&this._clipPoint){u$W=u$W<this.padding[0]?this.padding[0]:u$W;var u$j=this._textHeight-this._height,u$t=(u$W=u$j<u$W?u$j:u$W)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=u$t;var u$d=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=u$W,this.renderText(u$t,u$d)}}),u$$(0,u$W,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),u$$(0,u$W,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),u$$(0,u$W,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),u$$(0,u$W,"underlineColor",function(){return this._underlineColor},function(u$W){this._underlineColor=u$W,this._isChanged=!0,this.typeset()}),u$T.registerBitmapFont=function(u$W,u$j){u$T._bitmapFonts||(u$T._bitmapFonts={}),u$T._bitmapFonts[u$W]=u$j},u$T.unregisterBitmapFont=function(u$W,u$j){if(void 0===u$j&&(u$j=!0),u$T._bitmapFonts&&u$T._bitmapFonts[u$W]){var u$t=u$T._bitmapFonts[u$W];u$j&&u$t.destroy(),delete u$T._bitmapFonts[u$W]}},u$T.setTextRightToLeft=function(){var u$W;(u$W=u$Y.canvas.source.style).display="none",u$W.position="absolute",u$W.direction="rtl",u$y._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,u$Y.document.body.appendChild(u$Y.canvas.source)},u$T.supportFont=function(u$W){u$Y.context.font="10px sans-serif";var u$j=u$Y.context.measureText("abcji").width;u$Y.context.font="10px "+u$W;var u$t=u$Y.context.measureText("abcji").width;return console.log(u$j,u$t),u$j!==u$t},u$T._testWord="游",u$T.langPacks=null,u$T.VISIBLE="visible",u$T.SCROLL="scroll",u$T.HIDDEN="hidden",u$T.CharacterCache=!0,u$T.RightToLeft=!1,u$T._bitmapFonts=null,u$A(u$T,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),u$T}(u$mW),u$oW=function(u$m){function u$O(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",u$O.__super.call(this),this.offset=new u$z,this._canvasTransform=new u$l,this._previousOrientation=u$Y.window.orientation;var u$j=this;this.transform=u$l.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var u$W=u$Y.window,u$t=this;u$W.addEventListener("focus",function(){u$j._isFocused=!0,u$t.event("focus"),u$t.event("focuschange")}),u$W.addEventListener("blur",function(){u$j._isFocused=!1,u$t.event("blur"),u$t.event("focuschange"),u$t._isInputting()&&(u$XW.inputElement.target.focus=!1)});var u$d="visibilityState",u$b="visibilitychange",u$E=u$W.document;void 0!==u$E.hidden?(u$b="visibilitychange",u$d="visibilityState"):void 0!==u$E.mozHidden?(u$b="mozvisibilitychange",u$d="mozVisibilityState"):void 0!==u$E.msHidden?(u$b="msvisibilitychange",u$d="msVisibilityState"):void 0!==u$E.webkitHidden&&(u$b="webkitvisibilitychange",u$d="webkitVisibilityState"),u$W.document.addEventListener(u$b,function(){"hidden"==u$Y.document[u$d]?u$t._setStageVisible(!1):u$t._setStageVisible(!0)}),u$W.document.addEventListener("qbrowserVisibilityChange",function(u$W){u$t._setStageVisible(!u$W.hidden)}),u$W.addEventListener("resize",function(){var u$W=u$Y.window.orientation;null!=u$W&&u$W!=u$j._previousOrientation&&u$t._isInputting()&&(u$XW.inputElement.target.focus=!1),u$j._previousOrientation=u$W,u$t._isInputting()||u$t._resetCanvas()}),u$W.addEventListener("orientationchange",function(u$W){u$t._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),u$Y.onMobile&&this.on("mousedown",this,this._onmouseMove)}u$R(u$O,"laya.display.Stage",u$m);var u$W=u$O.prototype;return u$W._setStageVisible=function(u$W){this._isVisibility!=u$W&&(this._isVisibility=u$W,this._isVisibility||this._isInputting()&&(u$XW.inputElement.target.focus=!1),this.event("visibilitychange"))},u$W._isInputting=function(){return u$Y.onMobile&&u$XW.isInputting},u$W._changeCanvasSize=function(){this.setScreenSize(u$Y.clientWidth*u$Y.pixelRatio,u$Y.clientHeight*u$Y.pixelRatio)},u$W._resetCanvas=function(){if(this.screenAdaptationEnabled){var u$W=u$y._mainCanvas;u$W.source.style;u$W.size(1,1),u$N.timer.once(100,this,this._changeCanvasSize)}},u$W.setScreenSize=function(u$W,u$j){var u$t=!1;if("none"!==this._screenMode&&(u$t=(u$W/u$j<1?"vertical":"horizontal")!==this._screenMode)){var u$d=u$j;u$j=u$W,u$W=u$d}this.canvasRotation=u$t;var u$b=u$y._mainCanvas,u$E=u$b.source.style,u$O=this._canvasTransform.identity(),u$q=this._scaleMode,u$A=u$W/this.designWidth,u$c=u$j/this.designHeight,u$R=this.designWidth,u$m=this.designHeight,u$Q=u$W,u$T=u$j,u$$=u$Y.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,u$q){case"noscale":u$A=u$c=1,u$Q=this.designWidth,u$T=this.designHeight;break;case"showall":u$A=u$c=Math.min(u$A,u$c),u$R=u$Q=Math.round(this.designWidth*u$A),u$m=u$T=Math.round(this.designHeight*u$c);break;case"noborder":u$A=u$c=Math.max(u$A,u$c),u$Q=Math.round(this.designWidth*u$A),u$T=Math.round(this.designHeight*u$c);break;case"full":u$A=u$c=1,this._width=u$R=u$W,this._height=u$m=u$j;break;case"fixedwidth":u$c=u$A,this._height=u$m=Math.round(u$j/u$A);break;case"fixedheight":u$A=u$c,this._width=u$R=Math.round(u$W/u$c);break;case"fixedauto":u$W/u$j<this.designWidth/this.designHeight?(u$c=u$A,this._height=u$m=Math.round(u$j/u$A)):(u$A=u$c,this._width=u$R=Math.round(u$W/u$c))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,u$R=u$R+1&2147483646,u$m=u$m+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),u$A*=this.scaleX,u$c*=this.scaleY,1===u$A&&1===u$c?this.transform.identity():(this.transform.a=this._formatData(u$A/(u$Q/u$R)),this.transform.d=this._formatData(u$c/(u$T/u$m)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),u$b.size(u$R,u$m),u$G.changeWebGLSize(u$R,u$m),u$O.scale(u$Q/u$R/u$$,u$T/u$m/u$$),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(u$W-u$Q)/u$$:this.offset.x=.5*(u$W-u$Q)/u$$,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(u$j-u$T)/u$$:this.offset.y=.5*(u$j-u$T)/u$$,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),u$O.translate(this.offset.x,this.offset.y),this.canvasDegree=0,u$t&&("horizontal"===this._screenMode?(u$O.rotate(Math.PI/2),u$O.translate(u$j/u$$,0),this.canvasDegree=90):(u$O.rotate(-Math.PI/2),u$O.translate(0,u$W/u$$),this.canvasDegree=-90)),u$O.a=this._formatData(u$O.a),u$O.d=this._formatData(u$O.d),u$O.tx=this._formatData(u$O.tx),u$O.ty=this._formatData(u$O.ty),u$E.transformOrigin=u$E.webkitTransformOrigin=u$E.msTransformOrigin=u$E.mozTransformOrigin=u$E.oTransformOrigin="0px 0px 0px",u$E.transform=u$E.webkitTransform=u$E.msTransform=u$E.mozTransform=u$E.oTransform="matrix("+u$O.toString()+")",u$O.translate(parseInt(u$E.left)||0,parseInt(u$E.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},u$W._formatData=function(u$W){return Math.abs(u$W)<1e-6?0:Math.abs(1-u$W)<.001?0<u$W?1:-1:u$W},u$W.getMousePoint=function(){return u$z.TEMP.setTo(this.mouseX,this.mouseY)},u$W.repaint=function(){this._repaint=1},u$W.parentRepaint=function(){},u$W._loop=function(){return this.render(u$y.context,0,0),!0},u$W._onmouseMove=function(u$W){this._mouseMoveTime=u$Y.now()},u$W.getTimeFromFrameStart=function(){return u$Y.now()-this._frameStartTime},u$W.render=function(u$W,u$j,u$t){if("sleep"===this._frameRate&&!u$y.isConchApp){var u$d=u$Y.now();if(!(1e3<=u$d-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(u$P.loopCount++,u$e.instance.runEvent(),u$N.timer._update()));this._frameStartTime=u$d}if(this._renderCount++,u$y.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=u$Y.now();var u$b="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),u$E=this._renderCount%2==0;if(u$P.renderSlow=!u$b,u$b||u$E||u$y.isConchApp){var u$O;u$P.loopCount++,u$e.instance.runEvent(),u$N.timer._update(),u$G.update3DLoop();var u$q=0,u$A=0;if(u$y.isConchNode)for(u$q=0,u$A=this._scenes.length;u$q<u$A;u$q++)(u$O=this._scenes[u$q])&&u$O._updateSceneConch();else for(u$q=0,u$A=this._scenes.length;u$q<u$A;u$q++)(u$O=this._scenes[u$q])&&u$O._updateScene();if(u$y.isConchNode){var u$c=u$mW.CustomList;for(u$q=0,u$A=u$c.length;u$q<u$A;u$q++){var u$R=u$c[u$q];u$R.customRender(u$R.customContext,0,0)}return}}u$y.isConchNode||this.renderingEnabled&&(u$b||!u$E||u$y.isConchWebGL)&&(u$y.isWebGL?u$y.WebGL.mainContext&&!u$y.WebGL.mainContext.isContextLost()&&(u$W.clear(),u$m.prototype.render.call(this,u$W,u$j,u$t),u$P._show&&u$P._sp&&u$P._sp.render(u$W,u$j,u$t),u$G.clear(this._bgColor),u$G.beginFlush(),u$W.flush(),u$G.endFinish(),u$k.instance&&u$k.getInstance().endDispose()):(u$G.clear(this._bgColor),u$m.prototype.render.call(this,u$W,u$j,u$t),u$P._show&&u$P._sp&&u$P._sp.render(u$W,u$j,u$t)))}else this._renderCount%5==0&&(u$P.loopCount++,u$e.instance.runEvent(),u$N.timer._update())},u$W._requestFullscreen=function(){var u$W=u$Y.document.documentElement;u$W.requestFullscreen?u$W.requestFullscreen():u$W.mozRequestFullScreen?u$W.mozRequestFullScreen():u$W.webkitRequestFullscreen?u$W.webkitRequestFullscreen():u$W.msRequestFullscreen&&u$W.msRequestFullscreen()},u$W._fullScreenChanged=function(){u$N.stage.event("fullscreenchange")},u$W.exitFullscreen=function(){var u$W=u$Y.document;u$W.exitFullscreen?u$W.exitFullscreen():u$W.mozCancelFullScreen?u$W.mozCancelFullScreen():u$W.webkitExitFullscreen&&u$W.webkitExitFullscreen()},u$$(0,u$W,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),u$$(0,u$W,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),u$$(0,u$W,"frameRate",function(){return this._frameRate},function(u$W){if(this._frameRate=u$W,u$y.isConchApp)switch(this._frameRate){case"slow":u$Y.window.conch&&u$Y.window.conchConfig.setSlowFrame&&u$Y.window.conchConfig.setSlowFrame(!0);break;case"fast":u$Y.window.conch&&u$Y.window.conchConfig.setSlowFrame&&u$Y.window.conchConfig.setSlowFrame(!1);break;case"mouse":u$Y.window.conch&&u$Y.window.conchConfig.setMouseFrame&&u$Y.window.conchConfig.setMouseFrame(2e3);break;case"sleep":u$Y.window.conch&&u$Y.window.conchConfig.setLimitFPS&&u$Y.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),u$$(0,u$W,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),u$$(0,u$W,"width",u$m.prototype._$get_width,function(u$W){this.designWidth=u$W,u$N.superSet(u$mW,this,"width",u$W),u$N.timer.callLater(this,this._changeCanvasSize)}),u$$(0,u$W,"alignH",function(){return this._alignH},function(u$W){this._alignH=u$W,u$N.timer.callLater(this,this._changeCanvasSize)}),u$$(0,u$W,"isFocused",function(){return this._isFocused}),u$$(0,u$W,"height",u$m.prototype._$get_height,function(u$W){this.designHeight=u$W,u$N.superSet(u$mW,this,"height",u$W),u$N.timer.callLater(this,this._changeCanvasSize)}),u$$(0,u$W,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||u$l.create()},u$m.prototype._$set_transform),u$$(0,u$W,"isVisibility",function(){return this._isVisibility}),u$$(0,u$W,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),u$$(0,u$W,"scaleMode",function(){return this._scaleMode},function(u$W){this._scaleMode=u$W,u$N.timer.callLater(this,this._changeCanvasSize)}),u$$(0,u$W,"alignV",function(){return this._alignV},function(u$W){this._alignV=u$W,u$N.timer.callLater(this,this._changeCanvasSize)}),u$$(0,u$W,"bgColor",function(){return this._bgColor},function(u$W){this._bgColor=u$W,this.conchModel&&this.conchModel.bgColor(u$W),u$y.isWebGL&&(u$W?u$O._wgColor=u$f.create(u$W)._color:u$Y.onMiniGame||(u$O._wgColor=null)),u$Y.onLimixiu?u$O._wgColor=u$f.create(u$W)._color:u$y.canvas.style.background=u$W||"none"}),u$$(0,u$W,"mouseX",function(){return Math.round(u$e.instance.mouseX/this.clientScaleX)}),u$$(0,u$W,"mouseY",function(){return Math.round(u$e.instance.mouseY/this.clientScaleY)}),u$$(0,u$W,"screenMode",function(){return this._screenMode},function(u$W){this._screenMode=u$W}),u$$(0,u$W,"visible",u$m.prototype._$get_visible,function(u$W){this.visible!==u$W&&(u$N.superSet(u$mW,this,"visible",u$W),u$y._mainCanvas.source.style.visibility=u$W?"visible":"hidden")}),u$$(0,u$W,"fullScreenEnabled",null,function(u$W){var u$j=u$Y.document,u$t=u$y.canvas;u$W?(u$t.addEventListener("mousedown",this._requestFullscreen),u$t.addEventListener("touchstart",this._requestFullscreen),u$j.addEventListener("fullscreenchange",this._fullScreenChanged),u$j.addEventListener("mozfullscreenchange",this._fullScreenChanged),u$j.addEventListener("webkitfullscreenchange",this._fullScreenChanged),u$j.addEventListener("msfullscreenchange",this._fullScreenChanged)):(u$t.removeEventListener("mousedown",this._requestFullscreen),u$t.removeEventListener("touchstart",this._requestFullscreen),u$j.removeEventListener("fullscreenchange",this._fullScreenChanged),u$j.removeEventListener("mozfullscreenchange",this._fullScreenChanged),u$j.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),u$j.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),u$O.SCALE_NOSCALE="noscale",u$O.SCALE_EXACTFIT="exactfit",u$O.SCALE_SHOWALL="showall",u$O.SCALE_NOBORDER="noborder",u$O.SCALE_FULL="full",u$O.SCALE_FIXED_WIDTH="fixedwidth",u$O.SCALE_FIXED_HEIGHT="fixedheight",u$O.SCALE_FIXED_AUTO="fixedauto",u$O.ALIGN_LEFT="left",u$O.ALIGN_RIGHT="right",u$O.ALIGN_CENTER="center",u$O.ALIGN_TOP="top",u$O.ALIGN_MIDDLE="middle",u$O.ALIGN_BOTTOM="bottom",u$O.SCREEN_NONE="none",u$O.SCREEN_HORIZONTAL="horizontal",u$O.SCREEN_VERTICAL="vertical",u$O.FRAME_FAST="fast",u$O.FRAME_SLOW="slow",u$O.FRAME_MOUSE="mouse",u$O.FRAME_SLEEP="sleep",u$O.FRAME_MOUSE_THREDHOLD=2e3,u$A(u$O,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),u$O}(u$mW),u$SW=(function(u$W){function u$j(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,u$j.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}u$R(u$j,"laya.media.SoundNode",u$mW);var u$t=u$j.prototype;u$t._onParentChange=function(){this.target=this.parent},u$t.play=function(u$W,u$j){void 0===u$W&&(u$W=1),isNaN(u$W)&&(u$W=1),this.url&&(this.stop(),this._channel=u$x.playSound(this.url,u$W,null,u$j))},u$t.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},u$t._setPlayAction=function(u$W,u$j,u$t,u$d){void 0===u$d&&(u$d=!0),this[u$t]&&u$W&&(u$d?u$W.on(u$j,this,this[u$t]):u$W.off(u$j,this,this[u$t]))},u$t._setPlayActions=function(u$W,u$j,u$t,u$d){if(void 0===u$d&&(u$d=!0),u$W&&u$j){var u$b,u$E=u$j.split(","),u$O=0;for(u$b=u$E.length,u$O=0;u$O<u$b;u$O++)this._setPlayAction(u$W,u$E[u$O],u$t,u$d)}},u$$(0,u$t,"playEvent",null,function(u$W){(this._playEvents=u$W)&&this._tar&&this._setPlayActions(this._tar,u$W,"play")}),u$$(0,u$t,"target",null,function(u$W){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=u$W,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),u$$(0,u$t,"stopEvent",null,function(u$W){(this._stopEvents=u$W)&&this._tar&&this._setPlayActions(this._tar,u$W,"stop")})}(),function(u$W){function u$j(){this._src=null,this._onload=null,this._onerror=null,u$j.__super.call(this)}u$R(u$j,"laya.resource.FileBitmap",u$$W);var u$t=u$j.prototype;return u$$(0,u$t,"src",function(){return this._src},function(u$W){this._src=u$W}),u$$(0,u$t,"onload",null,function(u$W){}),u$$(0,u$t,"onerror",null,function(u$W){}),u$j}()),u$MW=function(u$W){function u$t(u$W,u$j){this._is2D=!1,u$t.__super.call(this);var u$d=this;if(this._source=this,"2D"===u$W||"AUTO"===u$W&&!u$y.isWebGL){this._is2D=!0,this._source=u$j||u$Y.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var u$b=this;u$b.getContext=function(u$W,u$j){if(u$d._ctx)return u$d._ctx;var u$t=u$d._ctx=u$d._source.getContext(u$W,u$j);return u$t&&(u$t._canvas=u$b,u$y.isFlash||u$Y.onLimixiu||(u$t.size=function(u$W,u$j){})),u$t}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}u$R(u$t,"laya.resource.HTMLCanvas",u$$W);var u$j=u$t.prototype;return u$j.clear=function(){this._ctx&&this._ctx.clear()},u$j.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},u$j.release=function(){},u$j._setContext=function(u$W){this._ctx=u$W},u$j.getContext=function(u$W,u$j){return this._ctx?this._ctx:this._ctx=u$t._createContext(this)},u$j.getMemSize=function(){return 0},u$j.size=function(u$W,u$j){(this._w!=u$W||this._h!=u$j||this._source&&(this._source.width!=u$W||this._source.height!=u$j))&&(this._w=u$W,this._h=u$j,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(u$W,u$j),this._source&&(this._source.height=u$j,this._source.width=u$W))},u$j.getCanvas=function(){return this._source},u$j.toBase64=function(u$W,u$j,u$t){if(this._source)if(u$y.isConchApp&&this._source.toBase64)this._source.toBase64(u$W,u$j,u$t);else{var u$d=this._source.toDataURL(u$W,u$j);u$t.call(this,u$d)}},u$$(0,u$j,"context",function(){return this._ctx}),u$$(0,u$j,"asBitmap",null,function(u$W){}),u$t.create=function(u$W,u$j){return new u$t(u$W,u$j)},u$t.TYPE2D="2D",u$t.TYPE3D="3D",u$t.TYPEAUTO="AUTO",u$t._createContext=null,u$t}(),u$ZW=(function(u$W){function u$A(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){throw u$A.__super.call(this),new Error("不允许new！")}u$R(u$A,"laya.resource.HTMLSubImage",u$$W),u$A.create=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){return void 0===u$q&&(u$q=!1),new u$A(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q)}}(),function(u$W){function u$m(){this._frames=null,this._url=null,u$m.__super.call(this),this._setControlNode(this)}u$R(u$m,"laya.display.Animation",u$W);var u$j=u$m.prototype;u$j.destroy=function(u$W){void 0===u$W&&(u$W=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,u$W),this._frames=null,this._labels=null},u$j.play=function(u$W,u$j,u$t,u$d){void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=!0),void 0===u$t&&(u$t=""),void 0===u$d&&(u$d=!0),u$t&&this._setFramesFromCache(u$t,u$d),this._isPlaying=!0,this.index="string"==typeof u$W?this._getFrameByLabel(u$W):u$W,this.loop=u$j,this._actionName=u$t,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},u$j._setFramesFromCache=function(u$W,u$j){var u$t;return void 0===u$j&&(u$j=!1),this._url&&(u$W=this._url+"#"+u$W),u$W&&u$m.framesMap[u$W]?((u$t=u$m.framesMap[u$W])instanceof Array?(this._frames=u$m.framesMap[u$W],this._count=this._frames.length):(u$t.nodeRoot&&(u$m.framesMap[u$W]=this._parseGraphicAnimationByData(u$t),u$t=u$m.framesMap[u$W]),this._frames=u$t.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=u$t.interval),this._labels=this._copyLabels(u$t.labels)),!0):(u$j&&console.log("ani not found:",u$W),!1)},u$j._copyLabels=function(u$W){if(!u$W)return null;var u$j,u$t;for(u$t in u$j={},u$W)u$j[u$t]=u$n.copyArray([],u$W[u$t]);return u$j},u$j._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&u$W.prototype._frameLoop.call(this)},u$j._displayToIndex=function(u$W){this._frames&&(this.graphics=this._frames[u$W])},u$j.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},u$j.loadImages=function(u$W,u$j){return void 0===u$j&&(u$j=""),this._url="",this._setFramesFromCache(u$j)||(this.frames=u$m.framesMap[u$j]?u$m.framesMap[u$j]:u$m.createFrames(u$W,u$j)),this},u$j.loadAtlas=function(u$j,u$t,u$d){void 0===u$d&&(u$d=""),this._url="";var u$b=this;function u$W(u$W){u$j===u$W&&(u$b.frames=u$m.framesMap[u$d]?u$m.framesMap[u$d]:u$m.createFrames(u$j,u$d),u$t&&u$t.run())}return u$b._setFramesFromCache(u$d)||(u$qW.getAtlas(u$j)?u$W(u$j):u$N.loader.load(u$j,u$S.create(null,u$W,[u$j]),null,"atlas")),this},u$j.loadAnimation=function(u$W,u$j,u$t){this._url=u$W;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,u$j&&u$j.run()):!u$t||u$qW.getAtlas(u$t)?this._loadAnimationData(u$W,u$j,u$t):u$N.loader.load(u$t,u$S.create(this,this._loadAnimationData,[u$W,u$j,u$t]),null,"atlas"),this},u$j._loadAnimationData=function(u$q,u$A,u$W){var u$c=this;if(!u$W||u$qW.getAtlas(u$W)){var u$R=this;u$qW.getRes(u$q)?u$j(u$q):u$N.loader.load(u$q,u$S.create(null,u$j,[u$q]),null,"json"),u$qW.clearRes(u$q)}else console.warn("atlas load fail:"+u$W);function u$j(u$W){if(u$qW.getRes(u$W)&&u$q===u$W){var u$j;if(u$m.framesMap[u$q+"#"])u$R._setFramesFromCache(u$c._actionName,!0),u$c.index=0,u$c._checkResumePlaying();else{var u$t=u$R._parseGraphicAnimation(u$qW.getRes(u$q));if(!u$t)return;var u$d,u$b=u$t.animationList,u$E=0,u$O=u$b.length;for(u$E=0;u$E<u$O;u$E++)u$j=u$b[u$E],u$m.framesMap[u$q+"#"+u$j.name]=u$j,u$d||(u$d=u$j);u$d&&(u$m.framesMap[u$q+"#"]=u$d,u$R._setFramesFromCache(u$c._actionName,!0),u$c.index=0),u$c._checkResumePlaying()}u$A&&u$A.run()}}},u$j._parseGraphicAnimation=function(u$W){return u$NW.parseAnimationData(u$W)},u$j._parseGraphicAnimationByData=function(u$W){return u$NW.parseAnimationByData(u$W)},u$$(0,u$j,"frames",function(){return this._frames},function(u$W){(this._frames=u$W)&&(this._count=u$W.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),u$$(0,u$j,"autoPlay",null,function(u$W){u$W?this.play():this.stop()}),u$$(0,u$j,"source",null,function(u$W){-1<u$W.indexOf(".ani")?this.loadAnimation(u$W):-1<u$W.indexOf(".json")||-1<u$W.indexOf("als")||-1<u$W.indexOf("atlas")?this.loadAtlas(u$W):this.loadImages(u$W.split(","))}),u$$(0,u$j,"autoAnimation",null,function(u$W){this.play(0,!0,u$W,!1)}),u$m.createFrames=function(u$W,u$j){var u$t,u$d,u$b=0,u$E=0;if("string"==typeof u$W){var u$O=u$qW.getAtlas(u$W);if(u$O&&u$O.length)for(u$t=[],u$b=0,u$E=u$O.length;u$b<u$E;u$b++)(u$d=new u$G.createGraphics).drawTexture(u$qW.getRes(u$O[u$b]),0,0),u$t.push(u$d)}else if(u$W instanceof Array)for(u$t=[],u$b=0,u$E=u$W.length;u$b<u$E;u$b++)(u$d=new u$G.createGraphics).loadImage(u$W[u$b],0,0),u$t.push(u$d);return u$j&&(u$m.framesMap[u$j]=u$t),u$t},u$m.clearCache=function(u$W){var u$j,u$t=u$m.framesMap,u$d=u$W+"#";for(u$j in u$t)u$j!==u$W&&0!=u$j.indexOf(u$d)||delete u$m.framesMap[u$j]},u$m.framesMap={}}(u$eW),function(u$W){function u$E(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,u$E.__super.call(this),null==u$E._sortIndexFun&&(u$E._sortIndexFun=u$_.sortByKey("index",!1,!0))}u$R(u$E,"laya.display.FrameAnimation",u$W);var u$j=u$E.prototype;return u$j._setUp=function(u$W,u$j){this._labels=null,this._animationNewFrames=null,this._targetDic=u$W,this._animationData=u$j,this.interval=1e3/u$j.frameRate,u$j.parsed?(this._count=u$j.count,this._labels=u$j.labels,this._animationNewFrames=u$j.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),u$j.parsed=!0,u$j.labels=this._labels,u$j.count=this._count,u$j.animationNewFrames=this._animationNewFrames},u$j.clear=function(){u$W.prototype.clear.call(this),this._targetDic=null,this._animationData=null},u$j._displayToIndex=function(u$W){if(this._animationData){u$W<0&&(u$W=0),u$W>this._count&&(u$W=this._count);var u$j=this._animationData.nodes,u$t=0,u$d=u$j.length;for(u$t=0;u$t<u$d;u$t++)this._displayNodeToFrame(u$j[u$t],u$W)}},u$j._displayNodeToFrame=function(u$W,u$j,u$t){u$t||(u$t=this._targetDic);var u$d=u$t[u$W.target];if(u$d){var u$b,u$E,u$O,u$q=u$W.frames,u$A=u$W.keys,u$c=0,u$R=u$A.length;for(u$c=0;u$c<u$R;u$c++)u$O=(u$E=u$q[u$b=u$A[u$c]]).length>u$j?u$E[u$j]:u$E[u$E.length-1],u$d[u$b]=u$O}},u$j._calculateDatas=function(){if(this._animationData){var u$W,u$j=this._animationData.nodes,u$t=0,u$d=u$j.length;for(u$t=this._count=0;u$t<u$d;u$t++)u$W=u$j[u$t],this._calculateNodeKeyFrames(u$W);this._count+=1}},u$j._calculateNodeKeyFrames=function(u$W){var u$j,u$t,u$d=u$W.keyframes,u$b=u$W.target;for(u$j in u$W.frames||(u$W.frames={}),u$W.keys?u$W.keys.length=0:u$W.keys=[],u$W.initValues||(u$W.initValues={}),u$d)u$t=u$d[u$j],u$W.frames[u$j]||(u$W.frames[u$j]=[]),this._targetDic&&this._targetDic[u$b]&&(u$W.initValues[u$j]=this._targetDic[u$b][u$j]),u$t.sort(u$E._sortIndexFun),u$W.keys.push(u$j),this._calculateNodePropFrames(u$t,u$W.frames[u$j],u$j,u$b)},u$j.resetToInitState=function(){if(this._targetDic&&this._animationData){var u$W,u$j,u$t=this._animationData.nodes,u$d=0,u$b=u$t.length;for(u$d=0;u$d<u$b;u$d++)if(u$j=(u$W=u$t[u$d]).initValues){var u$E,u$O=this._targetDic[u$W.target];if(u$O)for(u$E in u$j)u$O[u$E]=u$j[u$E]}}},u$j._calculateNodePropFrames=function(u$W,u$j,u$t,u$d){var u$b=0,u$E=u$W.length-1;if(0<u$E){for(u$j.length=u$W[u$E].index+1,u$b=0;u$b<u$E;u$b++)this._dealKeyFrame(u$W[u$b]),this._calculateFrameValues(u$W[u$b],u$W[u$b+1],u$j);this._dealKeyFrame(u$W[u$b])}0==u$E&&(u$j[u$W[0].index]=u$W[0].value,this._animationNewFrames&&(this._animationNewFrames[u$W[0].index]=!0))},u$j._dealKeyFrame=function(u$W){u$W.label&&""!=u$W.label&&this.addLabel(u$W.label,u$W.index)},u$j._calculateFrameValues=function(u$W,u$j,u$t){var u$d,u$b=0,u$E=u$W.index,u$O=u$j.index,u$q=u$W.value,u$A=u$j.value-u$W.value,u$c=u$O-u$E;if(u$O>this._count&&(this._count=u$O),u$W.tween)for(null==(u$d=u$U[u$W.tweenMethod])&&(u$d=u$U.linearNone),u$b=u$E;u$b<u$O;u$b++)u$t[u$b]=u$d(u$b-u$E,u$q,u$A,u$c),this._animationNewFrames&&(this._animationNewFrames[u$b]=!0);else for(u$b=u$E;u$b<u$O;u$b++)u$t[u$b]=u$q;this._animationNewFrames&&(this._animationNewFrames[u$W.index]=!0,this._animationNewFrames[u$j.index]=!0),u$t[u$j.index]=u$j.value},u$E._sortIndexFun=null,u$E}(u$eW)),u$XW=function(u$j){function u$b(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",u$b.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=u$KW.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}u$R(u$b,"laya.display.Input",u$j);var u$W=u$b.prototype;return u$W.setSelection=function(u$W,u$j){this.focus=!0,laya.display.Input.inputElement.selectionStart=u$W,laya.display.Input.inputElement.selectionEnd=u$j},u$W._onUnDisplay=function(u$W){this.focus=!1},u$W._onMouseDown=function(u$W){this.focus=!0},u$W._syncInputTransform=function(){var u$W=this.nativeInput,u$j=u$n.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),u$t=this._width-this.padding[1]-this.padding[3],u$d=this._height-this.padding[0]-this.padding[2];u$y.isConchApp?(u$W.setScale(u$j.scaleX,u$j.scaleY),u$W.setSize(u$t,u$d),u$W.setPos(u$j.x,u$j.y)):(u$b.inputContainer.style.transform=u$b.inputContainer.style.webkitTransform="scale("+u$j.scaleX+","+u$j.scaleY+") rotate("+u$N.stage.canvasDegree+"deg)",u$W.style.width=u$t+"px",u$W.style.height=u$d+"px",u$b.inputContainer.style.left=u$j.x+"px",u$b.inputContainer.style.top=u$j.y+"px")},u$W.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},u$W._setInputMethod=function(){u$b.input.parentElement&&u$b.inputContainer.removeChild(u$b.input),u$b.area.parentElement&&u$b.inputContainer.removeChild(u$b.area),u$b.inputElement=this._multiline?u$b.area:u$b.input,u$b.inputContainer.appendChild(u$b.inputElement),u$KW.RightToLeft&&(u$b.inputElement.style.direction="rtl")},u$W._focusIn=function(){laya.display.Input.isInputting=!0;var u$W=this.nativeInput;this._focus=!0;var u$j=u$W.style;u$j.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),u$W.readOnly=!this._editable,u$y.isConchApp&&(u$W.setType(this._type),u$W.setForbidEdit(!this._editable)),u$W.maxLength=this._maxChars;this.padding;if(u$W.type=this._type,u$W.value=this._content,u$W.placeholder=this._prompt,u$N.stage.off("keydown",this,this._onKeyDown),u$N.stage.on("keydown",this,this._onKeyDown),(u$N.stage.focus=this).event("focus"),u$Y.onPC&&u$W.focus(),!u$Y.onMiniGame){this._text;this._text=null}this.typeset(),u$W.setColor(this._originColor),u$W.setFontSize(this.fontSize),u$W.setFontFace(u$Y.onIPhone&&u$KW._fontFamilyMap[this.font]||this.font),u$y.isConchApp&&u$W.setMultiAble&&u$W.setMultiAble(this._multiline),u$j.lineHeight=this.leading+this.fontSize+"px",u$j.fontStyle=this.italic?"italic":"normal",u$j.fontWeight=this.bold?"bold":"normal",u$j.textAlign=this.align,u$j.padding="0 0",this._syncInputTransform(),!u$y.isConchApp&&u$Y.onPC&&u$N.timer.frameLoop(1,this,this._syncInputTransform)},u$W._setPromptColor=function(){(u$b.promptStyleDOM=u$Y.getElementById("promptStyle"))||((u$b.promptStyleDOM=u$Y.createElement("style")).setAttribute("id","promptStyle"),u$Y.document.head.appendChild(u$b.promptStyleDOM)),u$b.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},u$W._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(u$N.superSet(u$KW,this,"text",this._content),u$N.superSet(u$KW,this,"color",this._originColor)):(u$N.superSet(u$KW,this,"text",this._prompt),u$N.superSet(u$KW,this,"color",this._promptColor)),u$N.stage.off("keydown",this,this._onKeyDown),u$N.stage.focus=null,this.event("blur"),u$y.isConchApp&&this.nativeInput.blur(),u$Y.onPC&&u$N.timer.clear(this,this._syncInputTransform)},u$W._onKeyDown=function(u$W){13===u$W.keyCode&&(u$Y.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},u$W.changeText=function(u$W){this._content=u$W,this._focus?(this.nativeInput.value=u$W||"",this.event("change")):u$j.prototype.changeText.call(this,u$W)},u$$(0,u$W,"color",u$j.prototype._$get_color,function(u$W){this._focus&&this.nativeInput.setColor(u$W),u$N.superSet(u$KW,this,"color",this._content?u$W:this._promptColor),this._originColor=u$W}),u$$(0,u$W,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(u$W){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),u$$(0,u$W,"multiline",function(){return this._multiline},function(u$W){this._multiline=u$W,this.valign=u$W?"top":"middle"}),u$$(0,u$W,"maxChars",function(){return this._maxChars},function(u$W){u$W<=0&&(u$W=1e5),this._maxChars=u$W}),u$$(0,u$W,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(u$W){u$N.superSet(u$KW,this,"color",this._originColor),u$W+="",this._focus?(this.nativeInput.value=u$W||"",this.event("change")):(this._multiline||(u$W=u$W.replace(/\r?\n/g,"")),(this._content=u$W)?u$N.superSet(u$KW,this,"text",u$W):(u$N.superSet(u$KW,this,"text",this._prompt),u$N.superSet(u$KW,this,"color",this.promptColor)))}),u$$(0,u$W,"nativeInput",function(){return this._multiline?u$b.area:u$b.input}),u$$(0,u$W,"prompt",function(){return this._prompt},function(u$W){!this._text&&u$W&&u$N.superSet(u$KW,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?u$N.superSet(u$KW,this,"text",this._text==this._prompt?u$W:this._text):u$N.superSet(u$KW,this,"text",u$W),this._prompt=u$KW.langPacks&&u$KW.langPacks[u$W]?u$KW.langPacks[u$W]:u$W}),u$$(0,u$W,"focus",function(){return this._focus},function(u$W){var u$j=this.nativeInput;this._focus!==u$W&&(u$W?(u$j.target?u$j.target._focusOut():this._setInputMethod(),(u$j.target=this)._focusIn()):(u$j.target=null,this._focusOut(),u$Y.document.body.scrollTop=0,u$j.blur(),u$y.isConchApp?u$j.setPos(-1e4,-1e4):u$b.inputContainer.contains(u$j)&&u$b.inputContainer.removeChild(u$j)))}),u$$(0,u$W,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(u$W){u$W?(-1<(u$W="[^"+u$W+"]").indexOf("^^")&&(u$W=u$W.replace("^^","")),this._restrictPattern=new RegExp(u$W,"g")):this._restrictPattern=null}),u$$(0,u$W,"editable",function(){return this._editable},function(u$W){this._editable=u$W,u$y.isConchApp&&u$b.input.setForbidEdit(!u$W)}),u$$(0,u$W,"promptColor",function(){return this._promptColor},function(u$W){this._promptColor=u$W,this._content||u$N.superSet(u$KW,this,"color",u$W)}),u$$(0,u$W,"type",function(){return this._type},function(u$W){this._getCSSStyle().password="password"==u$W,this._type=u$W,u$y.isConchApp&&this.nativeInput.setType(u$W)}),u$$(0,u$W,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(u$W){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),u$$(0,u$W,"asPassword",function(){return this._getCSSStyle().password},function(u$W){this._getCSSStyle().password=u$W,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),u$b.__init__=function(){u$b._createInputElement(),u$Y.onMobile&&u$y.canvas.addEventListener(u$b.IOS_IFRAME?u$Y.onMiniGame?"touchend":"click":"touchend",u$b._popupInputMethod)},u$b._popupInputMethod=function(u$W){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},u$b._createInputElement=function(){u$b._initInput(u$b.area=u$Y.createElement("textarea")),u$b._initInput(u$b.input=u$Y.createElement("input")),(u$b.inputContainer=u$Y.createElement("div")).style.position="absolute",u$b.inputContainer.style.zIndex=1e5,u$Y.container.appendChild(u$b.inputContainer),u$b.inputContainer.setPos=function(u$W,u$j){u$b.inputContainer.style.left=u$W+"px",u$b.inputContainer.style.top=u$j+"px"}},u$b._initInput=function(u$j){var u$W=u$j.style;u$W.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",u$W.resize="none",u$W.backgroundColor="transparent",u$W.border="none",u$W.outline="none",u$W.zIndex=1,u$j.addEventListener("input",u$b._processInputting),u$j.addEventListener("mousemove",u$b._stopEvent),u$j.addEventListener("mousedown",u$b._stopEvent),u$j.addEventListener("touchmove",u$b._stopEvent),u$j.setFontFace=function(u$W){u$j.style.fontFamily=u$W},u$y.isConchApp||(u$j.setColor=function(u$W){u$j.style.color=u$W},u$j.setFontSize=function(u$W){u$j.style.fontSize=u$W+"px"})},u$b._processInputting=function(u$W){var u$j=laya.display.Input.inputElement.target;if(u$j){var u$t=laya.display.Input.inputElement.value;u$j._restrictPattern&&(u$t=u$t.replace(/\u2006|\x27/g,""),u$j._restrictPattern.test(u$t)&&(u$t=u$t.replace(u$j._restrictPattern,""),laya.display.Input.inputElement.value=u$t)),u$j._text=u$t,u$j.event("input")}},u$b._stopEvent=function(u$W){"touchmove"==u$W.type&&u$W.preventDefault(),u$W.stopPropagation&&u$W.stopPropagation()},u$b.TYPE_TEXT="text",u$b.TYPE_PASSWORD="password",u$b.TYPE_EMAIL="email",u$b.TYPE_URL="url",u$b.TYPE_NUMBER="number",u$b.TYPE_RANGE="range",u$b.TYPE_DATE="date",u$b.TYPE_MONTH="month",u$b.TYPE_WEEK="week",u$b.TYPE_TIME="time",u$b.TYPE_DATE_TIME="datetime",u$b.TYPE_DATE_TIME_LOCAL="datetime-local",u$b.TYPE_SEARCH="search",u$b.input=null,u$b.area=null,u$b.inputElement=null,u$b.inputContainer=null,u$b.confirmButton=null,u$b.promptStyleDOM=null,u$b.inputHeight=45,u$b.isInputting=!1,u$b.stageMatrix=null,u$A(u$b,["IOS_IFRAME",function(){return this.IOS_IFRAME=u$Y.onIOS&&u$Y.window.top!=u$Y.window.self}]),u$b}(u$KW),u$_W=function(u$W){function u$t(u$W,u$j){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,u$t.__super.call(this),u$W&&this._init_(u$W,u$j)}u$R(u$t,"laya.resource.HTMLImage",u$SW);var u$j=u$t.prototype;return u$j._init_=function(u$W,u$j){this._src=u$W,this._source=new u$Y.window.Image,u$j&&(u$j.onload&&(this.onload=u$j.onload),u$j.onerror&&(this.onerror=u$j.onerror),u$j.onCreate&&u$j.onCreate(this)),0!=u$W.indexOf("data:image")&&(this._source.crossOrigin=""),u$W&&(this._source.src=u$W)},u$j.recreateResource=function(){var u$W=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var u$j=this;this._source=new u$Y.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(u$j._needReleaseAgain)return u$j._needReleaseAgain=!1,u$j._source.onload=null,void(u$j._source=null);u$j._source.onload=null,u$j.memorySize=u$W._w*u$W._h*4,u$j._recreateLock=!1,u$j.completeCreate()},this._source.src=this._src}},u$j.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},u$j.onresize=function(){this._w=this._source.width,this._h=this._source.height},u$$(0,u$j,"onload",null,function(u$W){var u$j=this;this._onload=u$W,this._source&&(this._source.onload=null!=this._onload?function(){u$j.onresize(),u$j._onload()}:null)}),u$$(0,u$j,"onerror",null,function(u$W){var u$j=this;this._onerror=u$W,this._source&&(this._source.onerror=null!=this._onerror?function(){u$j._onerror()}:null)}),u$$(0,u$j,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(u$W){this._enableMerageInAtlas=u$W,u$y.isConchApp&&this._source&&(this._source.enableMerageInAtlas=u$W)}),u$t.create=function(u$W,u$j){return new u$t(u$W,u$j)},u$t}(),u$NW=(function(u$E){function u$W(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,u$W.__super.call(this)}u$R(u$W,"laya.display.EffectAnimation",u$E);var u$j=u$W.prototype;u$j._onOtherBegin=function(u$W){u$W!=this&&this.stop()},u$j.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},u$j._onPlayAction=function(){this.play(0,!1)},u$j.play=function(u$W,u$j,u$t,u$d){void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=!0),void 0===u$t&&(u$t=""),void 0===u$d&&(u$d=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,u$W,u$j,u$t,u$d))},u$j._recordInitData=function(){if(this._aniKeys){var u$W,u$j,u$t=0;for(u$W=this._aniKeys.length,u$t=0;u$t<u$W;u$t++)u$j=this._aniKeys[u$t],this._initData[u$j]=this._target[u$j]}},u$j._displayToIndex=function(u$W){if(this._animationData){u$W<0&&(u$W=0),u$W>this._count&&(u$W=this._count);var u$j=this._animationData.nodes,u$t=0,u$d=u$j.length;for(u$d=1<u$d?1:u$d,u$t=0;u$t<u$d;u$t++)this._displayNodeToFrame(u$j[u$t],u$W)}},u$j._displayNodeToFrame=function(u$W,u$j,u$t){if(this._target){var u$d;u$d=this._target;var u$b,u$E,u$O,u$q,u$A=u$W.frames,u$c=u$W.keys,u$R=0,u$m=u$c.length;u$q=u$W.secondFrames;var u$Q,u$T,u$$,u$e,u$K=0;for(u$R=0;u$R<u$m;u$R++)u$E=u$A[u$b=u$c[u$R]],u$O=-1==(u$K=u$q[u$b])?this._initData[u$b]:u$j<u$K?(u$$=(u$T=u$W.keyframes[u$b])[0]).tween?(null==(u$Q=u$U[u$$.tweenMethod])&&(u$Q=u$U.linearNone),u$e=u$T[1],u$Q(u$j,this._initData[u$b],u$e.value-this._initData[u$b],u$e.index)):this._initData[u$b]:u$E.length>u$j?u$E[u$j]:u$E[u$E.length-1],u$d[u$b]=u$O}},u$j._calculateNodeKeyFrames=function(u$W){u$E.prototype._calculateNodeKeyFrames.call(this,u$W);var u$j,u$t,u$d,u$b=u$W.keyframes;u$W.target;for(u$j in u$d={},u$W.secondFrames=u$d,u$b)(u$t=u$b[u$j]).length<=1?u$d[u$j]=-1:u$d[u$j]=u$t[1].index},u$$(0,u$j,"target",function(){return this._target},function(u$W){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=u$W,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),u$$(0,u$j,"playEvent",null,function(u$W){(this._playEvents=u$W)&&this.addEvent()}),u$$(0,u$j,"effectData",null,function(u$W){var u$j;u$W&&((u$j=u$W.animations)&&u$j[0]&&(this._setUp({},u$j[0]),u$j[0].nodes&&u$j[0].nodes[0]&&(this._aniKeys=u$j[0].nodes[0].keys)))}),u$$(0,u$j,"effectClass",null,function(u$W){var u$j,u$t;(this._effectClass=u$g.getClass(u$W),this._effectClass)&&((u$j=this._effectClass.uiView)&&(u$t=u$j.animations)&&u$t[0]&&(this._setUp({},u$t[0]),u$t[0].nodes&&u$t[0].nodes[0]&&(this._aniKeys=u$t[0].nodes[0].keys)))}),u$W.EffectAnimationBegin="effectanimationbegin"}(u$ZW),function(u$j){var u$V;function u$x(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,u$x.__super.call(this)}u$R(u$x,"laya.utils.GraphicAnimation",u$j);var u$W=u$x.prototype;return u$W._parseNodeList=function(u$W){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[u$W.compId]=u$W.props,u$W.compId&&this._nodeList.push(u$W.compId);var u$j=u$W.child;if(u$j){var u$t=0,u$d=u$j.length;for(u$t=0;u$t<u$d;u$t++)this._parseNodeList(u$j[u$t])}},u$W._calGraphicData=function(u$W){var u$j;if(this._setUp(null,u$W),this._createGraphicData(),this._nodeIDAniDic)for(u$j in this._nodeIDAniDic)this._nodeIDAniDic[u$j]=null},u$W._createGraphicData=function(){var u$W,u$j=[],u$t=0,u$d=this.count,u$b=this._animationNewFrames;for(u$b||(u$b=[]),u$t=0;u$t<u$d;u$t++)!u$b[u$t]&&u$W||(u$W=this._createFrameGraphic(u$t)),u$j.push(u$W);this._gList=u$j},u$W._createFrameGraphic=function(u$W){var u$j=u$G.createGraphics();return u$x._rootMatrix||(u$x._rootMatrix=new u$l),this._updateNodeGraphic(this._rootNode,u$W,u$x._rootMatrix,u$j),u$j},u$W._updateNodeGraphic=function(u$W,u$j,u$t,u$d,u$b){var u$E;void 0===u$b&&(u$b=1);var u$O,u$q,u$A,u$c=(u$E=this._nodeGDic[u$W.compId]=this._getNodeGraphicData(u$W.compId,u$j,this._nodeGDic[u$W.compId])).alpha*u$b;if(!(u$c<.01)&&(u$E.resultTransform||(u$E.resultTransform=u$l.create()),u$O=u$E.resultTransform,u$l.mul(u$E.transform,u$t,u$O),u$E.skin&&(u$q=this._getTextureByUrl(u$E.skin))&&(u$O._checkTransform()?(u$d.drawTexture(u$q,0,0,u$E.width,u$E.height,u$O,u$c),u$E.resultTransform=null):u$d.drawTexture(u$q,u$O.tx,u$O.ty,u$E.width,u$E.height,null,u$c)),u$A=u$W.child)){var u$R,u$m=0;for(u$R=u$A.length,u$m=0;u$m<u$R;u$m++)this._updateNodeGraphic(u$A[u$m],u$j,u$O,u$d,u$c)}},u$W._updateNoChilds=function(u$W,u$j){if(u$W.skin){var u$t=this._getTextureByUrl(u$W.skin);if(u$t){var u$d=u$W.transform;u$d._checkTransform();!u$d.bTransform?u$j.drawTexture(u$t,u$d.tx,u$d.ty,u$W.width,u$W.height,null,u$W.alpha):u$j.drawTexture(u$t,0,0,u$W.width,u$W.height,u$d.clone(),u$W.alpha)}}},u$W._updateNodeGraphic2=function(u$W,u$j,u$t){var u$d;if(u$d=this._nodeGDic[u$W.compId]=this._getNodeGraphicData(u$W.compId,u$j,this._nodeGDic[u$W.compId]),u$W.child){var u$b=u$d.transform;u$b._checkTransform();var u$E,u$O;u$O=(u$E=!u$b.bTransform)&&(0!=u$b.tx||0!=u$b.ty);var u$q,u$A,u$c;if((u$q=u$b.bTransform||1!=u$d.alpha)&&u$t.save(),1!=u$d.alpha&&u$t.alpha(u$d.alpha),u$E?u$O&&u$t.translate(u$b.tx,u$b.ty):u$t.transform(u$b.clone()),u$A=u$W.child,u$d.skin&&(u$c=this._getTextureByUrl(u$d.skin))&&u$t.drawTexture(u$c,0,0,u$d.width,u$d.height),u$A){var u$R,u$m=0;for(u$R=u$A.length,u$m=0;u$m<u$R;u$m++)this._updateNodeGraphic2(u$A[u$m],u$j,u$t)}u$q?u$t.restore():u$E?u$O&&u$t.translate(-u$b.tx,-u$b.ty):u$t.transform(u$b.clone().invert())}else this._updateNoChilds(u$d,u$t)},u$W._calculateNodeKeyFrames=function(u$W){u$j.prototype._calculateNodeKeyFrames.call(this,u$W),this._nodeIDAniDic[u$W.target]=u$W},u$W.getNodeDataByID=function(u$W){return this._nodeIDAniDic[u$W]},u$W._getParams=function(u$W,u$j,u$t,u$d){var u$b=u$x._temParam;u$b.length=u$j.length;var u$E=0,u$O=u$j.length;for(u$E=0;u$E<u$O;u$E++)u$b[u$E]=this._getObjVar(u$W,u$j[u$E][0],u$t,u$j[u$E][1],u$d);return u$b},u$W._getObjVar=function(u$W,u$j,u$t,u$d,u$b){if(u$W.hasOwnProperty(u$j)){var u$E=u$W[u$j];if(u$t>=u$E.length&&(u$t=u$E.length-1),null!=u$W[u$j][u$t])return u$W[u$j][u$t]}return u$b.hasOwnProperty(u$j)?u$b[u$j]:u$d},u$W._getNodeGraphicData=function(u$W,u$j,u$t){u$t||(u$t=u$V.create()),u$t.transform?u$t.transform.identity():u$t.transform=u$l.create();var u$d=this.getNodeDataByID(u$W);if(!u$d)return u$t;var u$b,u$E,u$O=u$d.frames,u$q=this._getParams(u$O,u$x._drawTextureCmd,u$j,this._nodeDefaultProps[u$W]),u$A=u$q[0],u$c=NaN,u$R=NaN,u$m=u$q[5],u$Q=u$q[6],u$T=u$q[13],u$$=u$q[14],u$e=u$q[7],u$K=u$q[8],u$o=u$q[9],u$S=u$q[11],u$M=u$q[12];u$c=u$q[3],u$R=u$q[4],0!=u$c&&0!=u$R||(u$A=null),-1==u$c&&(u$c=0),-1==u$R&&(u$R=0),u$t.skin=u$A,u$t.width=u$c,u$t.height=u$R,u$A&&((u$b=this._getTextureByUrl(u$A))?(u$c||(u$c=u$b.sourceWidth),u$R||(u$R=u$b.sourceHeight)):console.warn("lost skin:",u$A,",you may load pics first")),u$t.alpha=u$q[10],u$E=u$t.transform,0!=u$T&&(u$m=u$T*u$c),0!=u$$&&(u$Q=u$$*u$R),0==u$m&&0==u$Q||u$E.translate(-u$m,-u$Q);var u$Z=null;if(u$o||1!==u$e||1!==u$K||u$S||u$M){(u$Z=u$x._tempMt).identity(),u$Z.bTransform=!0;var u$X=.0174532922222222*(u$o-u$S),u$_=.0174532922222222*(u$o+u$M),u$N=Math.cos(u$_),u$z=Math.sin(u$_),u$C=Math.sin(u$X),u$L=Math.cos(u$X);u$Z.a=u$e*u$N,u$Z.b=u$e*u$z,u$Z.c=-u$K*u$C,u$Z.d=u$K*u$L,u$Z.tx=u$Z.ty=0}return u$Z&&(u$E=u$l.mul(u$E,u$Z,u$E)),u$E.translate(u$q[1],u$q[2]),u$t},u$W._getTextureByUrl=function(u$W){return u$qW.getRes(u$W)},u$W.setAniData=function(u$W,u$j){if(u$W.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=u$W,this._parseNodeList(u$W);var u$t,u$d={},u$b=[],u$E=u$W.animations,u$O=0,u$q=u$E.length;for(u$O=0;u$O<u$q;u$O++)if(u$t=u$E[u$O],this._labels=null,(!u$j||u$j==u$t.name)&&u$t){try{this._calGraphicData(u$t)}catch(u$W){console.warn("parse animation fail:"+u$t.name+",empty animation created"),this._gList=[]}var u$A={};u$A.interval=1e3/u$t.frameRate,u$A.frames=this._gList,u$A.labels=this._labels,u$A.name=u$t.name,u$b.push(u$A),u$d[u$t.name]=u$A}this.animationList=u$b,this.animationDic=u$d}u$x._temParam.length=0},u$W.parseByData=function(u$W){var u$j,u$t;u$j=u$W.nodeRoot,u$t=u$W.aniO,delete u$W.nodeRoot,delete u$W.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=u$j,this._parseNodeList(u$j),this._labels=null;try{this._calGraphicData(u$t)}catch(u$W){console.warn("parse animation fail:"+u$t.name+",empty animation created"),this._gList=[]}var u$d=u$W;return u$d.interval=1e3/u$t.frameRate,u$d.frames=this._gList,u$d.labels=this._labels,u$d.name=u$t.name,u$d},u$W.setUpAniData=function(u$W){if(u$W.animations){var u$j,u$t={},u$d=[],u$b=u$W.animations,u$E=0,u$O=u$b.length;for(u$E=0;u$E<u$O;u$E++)if(u$j=u$b[u$E]){var u$q={};u$q.name=u$j.name,u$q.aniO=u$j,u$q.nodeRoot=u$W,u$d.push(u$q),u$t[u$j.name]=u$q}this.animationList=u$d,this.animationDic=u$t}},u$W._clear=function(){var u$W,u$j;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(u$W in this._nodeGDic)(u$j=this._nodeGDic[u$W])&&u$j.recover();this._nodeGDic=null},u$x.parseAnimationByData=function(u$W){var u$j;return u$x._I||(u$x._I=new u$x),u$j=u$x._I.parseByData(u$W),u$x._I._clear(),u$j},u$x.parseAnimationData=function(u$W){var u$j;return u$x._I||(u$x._I=new u$x),u$x._I.setUpAniData(u$W),(u$j={}).animationList=u$x._I.animationList,u$j.animationDic=u$x._I.animationDic,u$x._I._clear(),u$j},u$x._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],u$x._temParam=[],u$x._I=null,u$x._rootMatrix=null,u$A(u$x,["_tempMt",function(){return this._tempMt=new u$l}]),u$x.__init$=function(){u$V=function(){function u$W(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return u$R(u$W,""),u$W.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),u$r.recover("GraphicNode",this)},u$W.create=function(){return u$r.getItemByClass("GraphicNode",u$W)},u$W}()},u$x}(u$ZW));u$N.__init([u$c,u$AW,u$y,u$Y,u$i,u$L,u$W,u$NW])}(window,document,Laya),function(u$W,u$j,u$t){u$t.un,u$t.uns,u$t.static;var u$d=u$t.class;u$t.getset,u$t.__newvec;new(function(){function u$W(){}return u$d(u$W,"LayaMain"),u$W}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(u$W,u$j){"use strict";for(var u$t in Object.defineProperty(u$j,"__esModule",{value:!0}),Laya){var u$d=Laya[u$t];u$d&&u$d.__isclass&&(u$j[u$t]=u$d)}}),function(u$W,u$j,u$_){u$_.un,u$_.uns;var u$O=u$_.static,u$Q=u$_.class,u$d=u$_.getset,u$E=u$_.__newvec,u$R=laya.maths.Arith,u$m=laya.maths.Bezier,u$t=laya.resource.Bitmap,u$T=laya.utils.Browser,u$A=laya.utils.Byte,u$$=laya.utils.Color,u$N=(laya.filters.ColorFilter,u$_.Config),u$b=laya.resource.Context,u$z=(laya.events.Event,laya.filters.Filter),u$q=laya.display.Graphics,u$c=laya.resource.HTMLCanvas,u$e=(laya.utils.HTMLChar,laya.resource.HTMLImage),u$K=laya.resource.HTMLSubImage,u$C=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),u$L=laya.maths.Point,u$V=laya.maths.Rectangle,u$o=laya.renders.Render,u$S=(laya.renders.RenderContext,laya.renders.RenderSprite),u$M=laya.resource.Resource,u$Z=laya.resource.ResourceManager,u$X=laya.utils.RunDriver,u$x=laya.display.Sprite,u$G=laya.display.Stage,u$l=laya.utils.Stat,u$h=laya.utils.StringKey,u$v=(laya.display.css.Style,laya.system.System),u$y=laya.display.Text,u$a=laya.resource.Texture,u$u=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),u$D=laya.utils.VectorGraphManager;laya.utils.WordText;u$_.interface("laya.webgl.shapes.IShape"),u$_.interface("laya.webgl.submit.ISubmit"),u$_.interface("laya.webgl.text.ICharSegment"),u$_.interface("laya.webgl.canvas.save.ISaveData"),u$_.interface("laya.webgl.resource.IMergeAtlasBitmap"),u$_.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var u$s=function(){function u$W(){}u$Q(u$W,"laya.filters.webgl.FilterActionGL");var u$j=u$W.prototype;return u$_.imps(u$j,{"laya.filters.IFilterActionGL":!0}),u$j.setValue=function(u$W){},u$j.setValueMix=function(u$W){},u$j.apply3d=function(u$W,u$j,u$t,u$d,u$b){return null},u$j.apply=function(u$W){return null},u$d(0,u$j,"typeMix",function(){return 0}),u$W}(),u$Y=function(){function u$W(){}return u$Q(u$W,"laya.webgl.shader.ShaderValue"),u$W}(),u$H=function(){var u$d,u$b;function u$W(u$W,u$j,u$t){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new u$b,void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),this._cells=null,this._rowInfo=null,this._init(u$W,u$j),this._atlasID=u$t}u$Q(u$W,"laya.webgl.atlas.AtlasGrid");var u$j=u$W.prototype;return u$j.getAltasID=function(){return this._atlasID},u$j.setAltasID=function(u$W){0<=u$W&&(this._atlasID=u$W)},u$j.addTex=function(u$W,u$j,u$t){var u$d=this._get(u$j,u$t);return 0==u$d.ret||(this._fill(u$d.x,u$d.y,u$j,u$t,u$W),this._texCount++),u$d},u$j._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},u$j._init=function(u$W,u$j){if(this._width=u$W,this._height=u$j,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=u$E(this._height);for(var u$t=0;u$t<this._height;u$t++)this._rowInfo[u$t]=new u$d;return this._clear(),!0},u$j._get=function(u$W,u$j){var u$t=new u$g;if(u$W>=this._failSize.width&&u$j>=this._failSize.height)return u$t;for(var u$d=-1,u$b=-1,u$E=this._width,u$O=this._height,u$q=this._cells,u$A=0;u$A<u$O;u$A++)if(!(this._rowInfo[u$A].spaceCount<u$W))for(var u$c=0;u$c<u$E;){var u$R=3*(u$A*u$E+u$c);if(0!=u$q[u$R]||u$q[1+u$R]<u$W||u$q[2+u$R]<u$j)u$c+=u$q[1+u$R];else{u$d=u$c,u$b=u$A;for(var u$m=0;u$m<u$W;u$m++)if(u$q[3*u$m+u$R+2]<u$j){u$d=-1;break}if(!(u$d<0))return u$t.ret=!0,u$t.x=u$d,u$t.y=u$b,u$t;u$c+=u$q[1+u$R]}}return u$t},u$j._fill=function(u$W,u$j,u$t,u$d,u$b){var u$E=this._width,u$O=this._height;this._check(u$W+u$t<=u$E&&u$j+u$d<=u$O);for(var u$q=u$j;u$q<u$d+u$j;++u$q){this._check(this._rowInfo[u$q].spaceCount>=u$t),this._rowInfo[u$q].spaceCount-=u$t;for(var u$A=0;u$A<u$t;u$A++){var u$c=3*(u$W+u$q*u$E+u$A);this._check(0==this._cells[u$c]),this._cells[u$c]=u$b,this._cells[1+u$c]=u$t,this._cells[2+u$c]=u$d}}if(0<u$W)for(u$q=0;u$q<u$d;++u$q){var u$R=0;for(u$A=u$W-1;0<=u$A&&0==this._cells[3*((u$j+u$q)*u$E+u$A)];--u$A,++u$R);for(u$A=u$R;0<u$A;--u$A)this._cells[3*((u$j+u$q)*u$E+u$W-u$A)+1]=u$A,this._check(0<u$A)}if(0<u$j)for(u$A=u$W;u$A<u$W+u$t;++u$A){for(u$R=0,u$q=u$j-1;0<=u$q&&0==this._cells[3*(u$A+u$q*u$E)];--u$q,u$R++);for(u$q=u$R;0<u$q;--u$q)this._cells[3*(u$A+(u$j-u$q)*u$E)+2]=u$q,this._check(0<u$q)}},u$j._check=function(u$W){0==u$W&&console.log("xtexMerger 错误啦")},u$j._clear=function(){for(var u$W=this._texCount=0;u$W<this._height;u$W++)this._rowInfo[u$W].spaceCount=this._width;for(var u$j=0;u$j<this._height;u$j++)for(var u$t=0;u$t<this._width;u$t++){var u$d=3*(u$j*this._width+u$t);this._cells[u$d]=0,this._cells[1+u$d]=this._width-u$t,this._cells[2+u$d]=this._width-u$j}this._failSize.width=this._width+1,this._failSize.height=this._height+1},u$W.__init$=function(){u$d=function(){function u$W(){this.spaceCount=0}return u$Q(u$W,""),u$W}(),u$b=function(){function u$W(){this.width=0,this.height=0}return u$Q(u$W,""),u$W}()},u$W}(),u$I=function(){function u$o(u$W,u$j,u$t,u$d){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=u$W,this._height=u$j,this._gridSize=u$t,this._maxAtlaserCount=u$d,this._gridNumX=u$W/u$t,this._gridNumY=u$j/u$t,this._curAtlasIndex=0,this._atlaserArray=[]}u$Q(u$o,"laya.webgl.atlas.AtlasResourceManager");var u$W=u$o.prototype;return u$W.setAtlasParam=function(u$W,u$j,u$t,u$d){if(1==this._setAtlasParam)return u$o._sid_=0,this._width=u$W,this._height=u$j,this._gridSize=u$t,this._maxAtlaserCount=u$d,this._gridNumX=u$W/u$t,this._gridNumY=u$j/u$t,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},u$W.pushData=function(u$W){var u$j,u$t=u$W.bitmap,u$d=-1,u$b=null,u$E=0,u$O=0;for(u$E=0,u$j=this._atlaserArray.length;u$E<u$j&&(u$O=(this._curAtlasIndex+u$E)%u$j,-1==(u$d=(u$b=this._atlaserArray[u$O]).findBitmapIsExist(u$t)));u$E++);if(-1!=u$d){var u$q=u$b.InAtlasWebGLImagesOffsetValue[u$d];return u$$=u$q[0],u$e=u$q[1],u$b.addToAtlas(u$W,u$$,u$e),!0}this._setAtlasParam=!1;for(var u$A=Math.ceil((u$W.bitmap.width+2)/this._gridSize),u$c=Math.ceil((u$W.bitmap.height+2)/this._gridSize),u$R=!1,u$m=0;u$m<2;u$m++){var u$Q=this._maxAtlaserCount;for(u$E=0;u$E<u$Q;u$E++){u$O=(this._curAtlasIndex+u$E)%u$Q,this._atlaserArray.length-1>=u$O||this._atlaserArray.push(new u$VW(this._gridNumX,this._gridNumY,this._width,this._height,u$o._sid_++));var u$T=this._atlaserArray[u$O],u$$=0,u$e=0,u$K=u$T.addTex(1,u$A,u$c);if(u$K.ret){u$$=u$K.x*this._gridSize+1,u$e=u$K.y*this._gridSize+1,u$t.lock=!0,u$T.addToAtlasTexture(u$t,u$$,u$e),u$T.addToAtlas(u$W,u$$,u$e),u$R=!0,this._curAtlasIndex=u$O;break}}if(u$R)break;this._atlaserArray.push(new u$VW(this._gridNumX,this._gridNumY,this._width,this._height,u$o._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return u$R||console.log(">>>AtlasManager pushData error"),u$R},u$W.addToAtlas=function(u$W){laya.webgl.atlas.AtlasResourceManager.instance.pushData(u$W)},u$W.garbageCollection=function(){if(!0===this._needGC){for(var u$W=this._atlaserArray.length-this._maxAtlaserCount,u$j=0;u$j<u$W;u$j++)this._atlaserArray[u$j].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+u$W),this._atlaserArray.splice(0,u$W),this._needGC=!1}return!0},u$W.freeAll=function(){for(var u$W=0,u$j=this._atlaserArray.length;u$W<u$j;u$W++)this._atlaserArray[u$W].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},u$W.getAtlaserCount=function(){return this._atlaserArray.length},u$W.getAtlaserByIndex=function(u$W){return this._atlaserArray[u$W]},u$d(1,u$o,"instance",function(){return u$o._Instance||(u$o._Instance=new u$o(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),u$o._Instance}),u$d(1,u$o,"enabled",function(){return u$N.atlasEnable}),u$d(1,u$o,"atlasLimitWidth",function(){return u$o._atlasLimitWidth},function(u$W){u$o._atlasLimitWidth=u$W}),u$d(1,u$o,"atlasLimitHeight",function(){return u$o._atlasLimitHeight},function(u$W){u$o._atlasLimitHeight=u$W}),u$o._enable=function(){u$N.atlasEnable=!0},u$o._disable=function(){u$N.atlasEnable=!1},u$o.__init__=function(){u$o.atlasTextureWidth=2048,u$o.atlasTextureHeight=2048,u$o.maxTextureCount=6,u$o.atlasLimitWidth=512,u$o.atlasLimitHeight=512},u$o._atlasLimitWidth=0,u$o._atlasLimitHeight=0,u$o.gridSize=16,u$o.atlasTextureWidth=0,u$o.atlasTextureHeight=0,u$o.maxTextureCount=0,u$o._atlasRestore=0,u$o.BOARDER_TYPE_NO=0,u$o.BOARDER_TYPE_RIGHT=1,u$o.BOARDER_TYPE_LEFT=2,u$o.BOARDER_TYPE_BOTTOM=4,u$o.BOARDER_TYPE_TOP=8,u$o.BOARDER_TYPE_ALL=15,u$o._sid_=0,u$o._Instance=null,u$o}(),u$g=function(){function u$W(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return u$Q(u$W,"laya.webgl.atlas.MergeFillInfo"),u$W}(),u$f=function(){function u$j(){}return u$Q(u$j,"laya.webgl.canvas.BlendMode"),u$j._init_=function(u$W){u$j.fns=[u$j.BlendNormal,u$j.BlendAdd,u$j.BlendMultiply,u$j.BlendScreen,u$j.BlendOverlay,u$j.BlendLight,u$j.BlendMask,u$j.BlendDestinationOut],u$j.targetFns=[u$j.BlendNormalTarget,u$j.BlendAddTarget,u$j.BlendMultiplyTarget,u$j.BlendScreenTarget,u$j.BlendOverlayTarget,u$j.BlendLightTarget,u$j.BlendMask,u$j.BlendDestinationOut]},u$j.BlendNormal=function(u$W){u$W.blendFunc(1,771)},u$j.BlendAdd=function(u$W){u$W.blendFunc(1,772)},u$j.BlendMultiply=function(u$W){u$W.blendFunc(774,771)},u$j.BlendScreen=function(u$W){u$W.blendFunc(1,1)},u$j.BlendOverlay=function(u$W){u$W.blendFunc(1,769)},u$j.BlendLight=function(u$W){u$W.blendFunc(1,1)},u$j.BlendNormalTarget=function(u$W){u$W.blendFunc(1,771)},u$j.BlendAddTarget=function(u$W){u$W.blendFunc(1,772)},u$j.BlendMultiplyTarget=function(u$W){u$W.blendFunc(774,771)},u$j.BlendScreenTarget=function(u$W){u$W.blendFunc(1,1)},u$j.BlendOverlayTarget=function(u$W){u$W.blendFunc(1,769)},u$j.BlendLightTarget=function(u$W){u$W.blendFunc(1,1)},u$j.BlendMask=function(u$W){u$W.blendFunc(0,770)},u$j.BlendDestinationOut=function(u$W){u$W.blendFunc(0,0)},u$j.activeBlendFunction=null,u$j.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],u$j.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},u$j.NORMAL="normal",u$j.ADD="add",u$j.MULTIPLY="multiply",u$j.SCREEN="screen",u$j.LIGHT="light",u$j.OVERLAY="overlay",u$j.DESTINATIONOUT="destination-out",u$j.fns=[],u$j.targetFns=[],u$j}(),u$w=function(){function u$t(u$W){this._color=u$$.create("black"),this.setValue(u$W)}u$Q(u$t,"laya.webgl.canvas.DrawStyle");var u$W=u$t.prototype;return u$W.setValue=function(u$W){if(u$W){if("string"==typeof u$W)return void(this._color=u$$.create(u$W));if(u$W instanceof laya.utils.Color)return void(this._color=u$W)}},u$W.reset=function(){this._color=u$$.create("black")},u$W.equal=function(u$W){return"string"==typeof u$W?this._color.strColor===u$W:u$W instanceof laya.utils.Color&&this._color.numColor===u$W.numColor},u$W.toColorStr=function(){return this._color.strColor},u$t.create=function(u$W){var u$j;if(u$W&&("string"==typeof u$W?u$j=u$$.create(u$W):u$W instanceof laya.utils.Color&&(u$j=u$W),u$j))return u$j._drawStyle||(u$j._drawStyle=new u$t(u$W));return laya.webgl.canvas.DrawStyle.DEFAULT},u$O(u$t,["DEFAULT",function(){return this.DEFAULT=new u$t("#000000")}]),u$t}(),u$U=function(){function u$W(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];u$ZW.mainContext;this.ib=u$pW.create(35048),this.vb=u$FW.create(5)}u$Q(u$W,"laya.webgl.canvas.Path");var u$j=u$W.prototype;return u$j.addPoint=function(u$W,u$j){this.tempArray.push(u$W,u$j)},u$j.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},u$j.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},u$j.polygon=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O;return this.geomatrys.push(this._curGeomatry=u$O=new u$hW(u$W,u$j,u$t,u$d,u$b,u$E)),u$d||(u$O.fill=!1),null==u$E&&(u$O.borderWidth=0),u$O},u$j.setGeomtry=function(u$W){this.geomatrys.push(this._curGeomatry=u$W)},u$j.drawLine=function(u$W,u$j,u$t,u$d,u$b){var u$E;return this.closePath?this.geomatrys.push(this._curGeomatry=u$E=new u$lW(u$W,u$j,u$t,u$d,u$b)):this.geomatrys.push(this._curGeomatry=u$E=new u$GW(u$W,u$j,u$t,u$d,u$b)),u$E.fill=!1,u$E},u$j.update=function(){var u$W=this.ib._byteLength,u$j=this.geomatrys.length;this.offset=u$W;for(var u$t=this.geoStart;u$t<u$j;u$t++)this.geomatrys[u$t].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=u$j,this.count=(this.ib._byteLength-u$W)/u$eW.BYTES_PIDX},u$j.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},u$j.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},u$W}(),u$J=function(){function u$q(){}u$Q(u$q,"laya.webgl.canvas.save.SaveBase");var u$W=u$q.prototype;return u$_.imps(u$W,{"laya.webgl.canvas.save.ISaveData":!0}),u$W.isSaveMark=function(){return!1},u$W.restore=function(u$W){this._dataObj[this._valueName]=this._value,(u$q._cache[u$q._cache._length++]=this)._newSubmit&&(u$W._curSubmit=u$EW.RENDERBASE,u$W._renderKey=0)},u$q._createArray=function(){var u$W=[];return u$W._length=0,u$W},u$q._init=function(){var u$W=u$q._namemap={};return u$W[1]="ALPHA",u$W[2]="fillStyle",u$W[8]="font",u$W[256]="lineWidth",u$W[512]="strokeStyle",u$W[8192]="_mergeID",u$W[1024]=u$W[2048]=u$W[4096]=[],u$W[16384]="textBaseline",u$W[32768]="textAlign",u$W[65536]="_nBlendType",u$W[1048576]="shader",u$W[2097152]="filters",u$W},u$q.save=function(u$W,u$j,u$t,u$d){if((u$W._saveMark._saveuse&u$j)!==u$j){u$W._saveMark._saveuse|=u$j;var u$b=u$q._cache,u$E=0<u$b._length?u$b[--u$b._length]:new u$q;u$E._value=u$t[u$E._valueName=u$q._namemap[u$j]],u$E._dataObj=u$t,u$E._newSubmit=u$d;var u$O=u$W._save;u$O[u$O._length++]=u$E}},u$q._cache=laya.webgl.canvas.save.SaveBase._createArray(),u$q._namemap=u$q._init(),u$q}(),u$r=function(){function u$E(){this._clipRect=new u$V}u$Q(u$E,"laya.webgl.canvas.save.SaveClipRect");var u$W=u$E.prototype;return u$_.imps(u$W,{"laya.webgl.canvas.save.ISaveData":!0}),u$W.isSaveMark=function(){return!1},u$W.restore=function(u$W){u$W._clipRect=this._clipSaveRect,(u$E._cache[u$E._cache._length++]=this)._submitScissor.submitLength=u$W._submits._length-this._submitScissor.submitIndex,u$W._curSubmit=u$EW.RENDERBASE,u$W._renderKey=0},u$E.save=function(u$W,u$j){if(131072!=(131072&u$W._saveMark._saveuse)){u$W._saveMark._saveuse|=131072;var u$t=u$E._cache,u$d=0<u$t._length?u$t[--u$t._length]:new u$E;u$d._clipSaveRect=u$W._clipRect,u$W._clipRect=u$d._clipRect.copyFrom(u$W._clipRect),u$d._submitScissor=u$j;var u$b=u$W._save;u$b[u$b._length++]=u$d}},u$O(u$E,["_cache",function(){return this._cache=u$J._createArray()}]),u$E}(),u$P=function(){function u$T(){this._contextX=0,this._contextY=0,this._clipRect=new u$V,this._rect=new u$V,this._matrix=new u$C}u$Q(u$T,"laya.webgl.canvas.save.SaveClipRectStencil");var u$W=u$T.prototype;return u$_.imps(u$W,{"laya.webgl.canvas.save.ISaveData":!0}),u$W.isSaveMark=function(){return!1},u$W.restore=function(u$W){u$RW.restore(u$W,this._rect,this._saveMatrix,this._contextX,this._contextY),u$W._clipRect=this._clipSaveRect,u$W._curMat=this._saveMatrix,u$W._x=this._contextX,u$W._y=this._contextY,u$T._cache[u$T._cache._length++]=this,u$W._curSubmit=u$EW.RENDERBASE},u$T.save=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){if(262144!=(262144&u$W._saveMark._saveuse)){u$W._saveMark._saveuse|=262144;var u$R=u$T._cache,u$m=0<u$R._length?u$R[--u$R._length]:new u$T;u$m._clipSaveRect=u$W._clipRect,u$m._clipRect.setTo(u$O,u$q,u$A,u$c),u$W._clipRect=u$m._clipRect,u$m._rect.x=u$t,u$m._rect.y=u$d,u$m._rect.width=u$b,u$m._rect.height=u$E,u$m._contextX=u$W._x,u$m._contextY=u$W._y,u$m._saveMatrix=u$W._curMat,u$W._curMat.copyTo(u$m._matrix),u$W._curMat=u$m._matrix,u$m._submitStencil=u$j;var u$Q=u$W._save;u$Q[u$Q._length++]=u$m}},u$O(u$T,["_cache",function(){return this._cache=u$J._createArray()}]),u$T}(),u$i=function(){function u$d(){this._saveuse=0}u$Q(u$d,"laya.webgl.canvas.save.SaveMark");var u$W=u$d.prototype;return u$_.imps(u$W,{"laya.webgl.canvas.save.ISaveData":!0}),u$W.isSaveMark=function(){return!0},u$W.restore=function(u$W){u$W._saveMark=this._preSaveMark,u$d._no[u$d._no._length++]=this},u$d.Create=function(u$W){var u$j=u$d._no,u$t=0<u$j._length?u$j[--u$j._length]:new u$d;return u$t._saveuse=0,u$t._preSaveMark=u$W._saveMark,u$W._saveMark=u$t},u$O(u$d,["_no",function(){return this._no=u$J._createArray()}]),u$d}(),u$B=function(){function u$E(){this._matrix=new u$C}u$Q(u$E,"laya.webgl.canvas.save.SaveTransform");var u$W=u$E.prototype;return u$_.imps(u$W,{"laya.webgl.canvas.save.ISaveData":!0}),u$W.isSaveMark=function(){return!1},u$W.restore=function(u$W){u$W._curMat=this._savematrix,u$E._no[u$E._no._length++]=this},u$E.save=function(u$W){var u$j=u$W._saveMark;if(2048!=(2048&u$j._saveuse)){u$j._saveuse|=2048;var u$t=u$E._no,u$d=0<u$t._length?u$t[--u$t._length]:new u$E;u$d._savematrix=u$W._curMat,u$W._curMat=u$W._curMat.copyTo(u$d._matrix);var u$b=u$W._save;u$b[u$b._length++]=u$d}},u$O(u$E,["_no",function(){return this._no=u$J._createArray()}]),u$E}(),u$n=function(){function u$b(){}u$Q(u$b,"laya.webgl.canvas.save.SaveTranslate");var u$W=u$b.prototype;return u$_.imps(u$W,{"laya.webgl.canvas.save.ISaveData":!0}),u$W.isSaveMark=function(){return!1},u$W.restore=function(u$W){u$W._curMat;u$W._x=this._x,u$W._y=this._y,u$b._no[u$b._no._length++]=this},u$b.save=function(u$W){var u$j=u$b._no,u$t=0<u$j._length?u$j[--u$j._length]:new u$b;u$t._x=u$W._x,u$t._y=u$W._y;var u$d=u$W._save;u$d[u$d._length++]=u$t},u$O(u$b,["_no",function(){return this._no=u$J._createArray()}]),u$b}(),u$k=function(){function u$W(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new u$V}u$Q(u$W,"laya.webgl.resource.RenderTargetMAX");var u$j=u$W.prototype;return u$j.setSP=function(u$W){this._sp=u$W},u$j.size=function(u$W,u$j){var u$t=this;this._width!==u$W||this._height!==u$j?(this.repaint=!0,this._width=u$W,this._height=u$j,this.target?this.target.size(u$W,u$j):this.target=u$DW.create(u$W,u$j),this.target.hasListener("recovered")||this.target.on("recovered",this,function(u$W){u$_.timer.callLater(u$t._sp,u$t._sp.repaint)})):this.target.size(u$W,u$j)},u$j._flushToTarget=function(u$W,u$j){if(!u$j._destroy){var u$t=u$SW.worldScissorTest,u$d=u$SW.worldClipRect;u$SW.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,u$SW.worldScissorTest=!1,u$ZW.mainContext.disable(3089);var u$b=u$SW.worldAlpha,u$E=u$SW.worldMatrix4,u$O=u$SW.worldMatrix,u$q=u$SW.worldFilters,u$A=u$SW.worldShaderDefines;if(u$SW.worldMatrix=u$C.EMPTY,u$SW.restoreTempArray(),u$SW.worldMatrix4=u$SW.TEMPMAT4_ARRAY,u$SW.worldAlpha=1,u$SW.worldFilters=null,u$SW.worldShaderDefines=null,u$uW.activeShader=null,u$j.start(),u$N.showCanvasMark?u$j.clear(0,1,0,.3):u$j.clear(0,0,0,0),u$W.flush(),u$j.end(),u$uW.activeShader=null,u$SW.worldAlpha=u$b,u$SW.worldMatrix4=u$E,u$SW.worldMatrix=u$O,u$SW.worldFilters=u$q,u$SW.worldShaderDefines=u$A,u$SW.worldScissorTest=u$t){var u$c=u$SW.height-u$d.y-u$d.height;u$ZW.mainContext.scissor(u$d.x,u$c,u$d.width,u$d.height),u$ZW.mainContext.enable(3089)}u$SW.worldClipRect=u$d}},u$j.flush=function(u$W){this.repaint&&(this._flushToTarget(u$W,this.target),this.repaint=!1)},u$j.drawTo=function(u$W,u$j,u$t,u$d,u$b){u$W.drawTexture(this.target.getTexture(),u$j,u$t,u$d,u$b,0,0)},u$j.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},u$W}(),u$p=function(){function u$W(){this.ALPHA=1,this.shaderType=0,this.defines=new u$xW}return u$Q(u$W,"laya.webgl.shader.d2.Shader2D"),u$W.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},u$W.__init__=function(){var u$W,u$j;u$iW.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),u$iW.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),u$iW.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),u$iW.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),u$iW.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),u$iW.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),u$iW.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),u$iW.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),u$W="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",u$j='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',u$iW.preCompile2D(0,1,u$W,u$j,null),u$W="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",u$j='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',u$iW.preCompile2D(0,2,u$W,u$j,null),u$W="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",u$j="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",u$iW.preCompile2D(0,4,u$W,u$j,null),u$W="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",u$j='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',u$iW.preCompile2D(0,256,u$W,u$j,null),u$W="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",u$j="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",u$iW.preCompile2D(0,512,u$W,u$j,null)},u$W}(),u$F=function(){function u$j(u$W,u$j,u$t){this._value=0,this._name2int=u$W,this._int2name=u$j,this._int2nameMap=u$t}u$Q(u$j,"laya.webgl.shader.ShaderDefines");var u$W=u$j.prototype;return u$W.add=function(u$W){return"string"==typeof u$W&&(u$W=this._name2int[u$W]),this._value|=u$W,this._value},u$W.addInt=function(u$W){return this._value|=u$W,this._value},u$W.remove=function(u$W){return"string"==typeof u$W&&(u$W=this._name2int[u$W]),this._value&=~u$W,this._value},u$W.isDefine=function(u$W){return(this._value&u$W)===u$W},u$W.getValue=function(){return this._value},u$W.setValue=function(u$W){this._value=u$W},u$W.toNameDic=function(){var u$W=this._int2nameMap[this._value];return u$W||u$j._toText(this._value,this._int2name,this._int2nameMap)},u$j._reg=function(u$W,u$j,u$t,u$d){u$d[u$t[u$W]=u$j]=u$W},u$j._toText=function(u$W,u$j,u$t){var u$d=u$t[u$W];if(u$d)return u$d;for(var u$b={},u$E=1,u$O=0;u$O<32&&!(u$W<(u$E=1<<u$O));u$O++)if(u$W&u$E){var u$q=u$j[u$E];u$q&&(u$b[u$q]="")}return u$t[u$W]=u$b},u$j._toInt=function(u$W,u$j){for(var u$t=u$W.split("."),u$d=0,u$b=0,u$E=u$t.length;u$b<u$E;u$b++){var u$O=u$j[u$t[u$b]];if(!u$O)throw new Error("Defines to int err:"+u$W+"/"+u$t[u$b]);u$d|=u$O}return u$d},u$j}(),u$WW=function(){function u$O(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new u$C}u$Q(u$O,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var u$W=u$O.prototype;return u$W.init=function(u$W,u$j,u$t){if(u$j)this._vs=u$j;else{this._vs=[];var u$d=u$W.width,u$b=u$W.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(u$d,0,1,0,1,1,1,1),this._vs.push(u$d,u$b,1,1,1,1,1,1),this._vs.push(0,u$b,0,1,1,1,1,1)}u$t?this._ps=u$t:(u$O._defaultPS||(u$O._defaultPS=[]).push(0,1,3,3,1,2),this._ps=u$O._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=u$W},u$W.init2=function(u$W,u$j,u$t,u$d,u$b){this.transform&&(this.transform=null),u$t?this._ps=u$t:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=u$d,this._uvs=u$b,this.mEleNum=this._ps.length,this.mTexture=u$W,(u$o.isConchNode||u$o.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},u$W._initMyData=function(){var u$W=0,u$j=0,u$t=4*this._verticles.length;this._vs=u$O._tempVS;var u$d=!1;if(u$o.isConchNode||u$o.isConchApp?(this._vs.length=u$t,u$d=!0):this._vs.length<u$t&&(this._vs.length=u$t,u$d=!0),u$O._tVSLen=u$t,u$d)for(;u$W<u$t;)this._vs[u$W]=this._verticles[u$j],this._vs[u$W+1]=this._verticles[u$j+1],this._vs[u$W+2]=this._uvs[u$j],this._vs[u$W+3]=this._uvs[u$j+1],this._vs[u$W+4]=1,this._vs[u$W+5]=1,this._vs[u$W+6]=1,this._vs[u$W+7]=1,u$W+=8,u$j+=2;else for(;u$W<u$t;)this._vs[u$W]=this._verticles[u$j],this._vs[u$W+1]=this._verticles[u$j+1],this._vs[u$W+2]=this._uvs[u$j],this._vs[u$W+3]=this._uvs[u$j+1],u$W+=8,u$j+=2},u$W.getData2=function(u$W,u$j,u$t){var u$d;this.mVBBuffer=u$W,this.mIBBuffer=u$j,this._initMyData(),u$W.appendEx2(this._vs,Float32Array,u$O._tVSLen,4),this._indexStart=u$j._byteLength,(u$d=u$O._tempIB).length<this._ps.length&&(u$d.length=this._ps.length);for(var u$b=0,u$E=this._ps.length;u$b<u$E;u$b++)u$d[u$b]=this._ps[u$b]+u$t;u$j.appendEx2(u$d,Uint16Array,this._ps.length,2)},u$W.getData=function(u$W,u$j,u$t){if(this.mVBBuffer=u$W,this.mIBBuffer=u$j,u$W.append(this.mVBData),this._indexStart=u$j._byteLength,this.mIBData.start!=u$t){for(var u$d=0,u$b=this._ps.length;u$d<u$b;u$d++)this.mIBData[u$d]=this._ps[u$d]+u$t;this.mIBData.start=u$t}u$j.append(this.mIBData)},u$W.render=function(u$W,u$j,u$t){if(u$o.isWebGL&&this.mTexture){u$W._renderKey=0,u$W._shader2D.glTexture=null,u$jW.getInstance().addSkinMesh(this);var u$d=u$EW.createShape(u$W,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,u$zW.create(512,0));this.transform||(this.transform=u$C.EMPTY),this.transform.translate(u$j,u$t),u$C.mul(this.transform,u$W._curMat,this._tempMatrix),this.transform.translate(-u$j,-u$t);var u$b=u$d.shaderValue,u$E=u$b.u_mmat2||u$SW.getMatrArray();u$SW.mat2MatArray(this._tempMatrix,u$E),u$b.textureHost=this.mTexture,u$b.offsetX=0,u$b.offsetY=0,u$b.u_mmat2=u$E,u$b.ALPHA=u$W._shader2D.ALPHA,u$W._submits[u$W._submits._length++]=u$d}else u$o.isConchApp&&this.mTexture&&(this.transform||(this.transform=u$C.EMPTY),u$W.setSkinMesh&&u$W.setSkinMesh(u$j,u$t,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},u$O._tempVS=[],u$O._tempIB=[],u$O._defaultPS=null,u$O._tVSLen=0,u$O}(),u$jW=function(){function u$W(){this.ib=null,this.vb=null;u$ZW.mainContext;this.ib=u$pW.create(35048),this.vb=u$FW.create(8)}u$Q(u$W,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var u$j=u$W.prototype;return u$j.addSkinMesh=function(u$W){u$W.getData2(this.vb,this.ib,this.vb._byteLength/32)},u$j.reset=function(){this.vb.clear(),this.ib.clear()},u$W.getInstance=function(){return u$W.instance=u$W.instance||new u$W},u$W.instance=null,u$W}(),u$tW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===u$A&&(u$A=0),this.x=u$W,this.y=u$j,this.width=u$t,this.height=u$d,this.edges=u$b,this.color=u$E,this.borderWidth=u$O,this.borderColor=u$q}u$Q(u$W,"laya.webgl.shapes.BasePoly");var u$j=u$W.prototype;return u$_.imps(u$j,{"laya.webgl.shapes.IShape":!0}),u$j.getData=function(u$W,u$j,u$t){},u$j.rebuild=function(u$W){},u$j.setMatrix=function(u$W){},u$j.needUpdate=function(u$W){return!0},u$j.sector=function(u$W,u$j,u$t){var u$d=this.x,u$b=this.y,u$E=this.edges,u$O=(this.r1-this.r0)/u$E,u$q=this.width,u$A=this.height,u$c=this.color,u$R=(u$c>>16&255)/255,u$m=(u$c>>8&255)/255,u$Q=(255&u$c)/255;u$W.push(u$d,u$b,u$R,u$m,u$Q);for(var u$T=0;u$T<u$E+1;u$T++)u$W.push(u$d+Math.sin(u$O*u$T+this.r0)*u$q,u$b+Math.cos(u$O*u$T+this.r0)*u$A),u$W.push(u$R,u$m,u$Q);for(u$T=0;u$T<u$E;u$T++)u$j.push(u$t,u$t+u$T+1,u$t+u$T+2)},u$j.createLine2=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O,u$q,u$A,u$c,u$R,u$m,u$Q,u$T,u$$,u$e,u$K,u$o,u$S,u$M,u$Z,u$X,u$_,u$N,u$z,u$C,u$L=u$W.concat(),u$V=u$b,u$x=this.borderColor,u$G=(u$x>>16&255)/255,u$l=(u$x>>8&255)/255,u$h=(255&u$x)/255,u$v=u$L.length/2,u$y=u$d,u$a=u$t/2;u$A=u$L[0],u$c=u$L[1],u$e=u$A-(u$R=u$L[2]),u$$=(u$$=-(u$c-(u$m=u$L[3])))/(u$C=Math.sqrt(u$$*u$$+u$e*u$e))*u$a,u$e=u$e/u$C*u$a,u$V.push(u$A-u$$+this.x,u$c-u$e+this.y,u$G,u$l,u$h,u$A+u$$+this.x,u$c+u$e+this.y,u$G,u$l,u$h);for(var u$u=1;u$u<u$v-1;u$u++)u$A=u$L[2*(u$u-1)],u$c=u$L[2*(u$u-1)+1],u$R=u$L[2*u$u],u$m=u$L[2*u$u+1],u$Q=u$L[2*(u$u+1)],u$T=u$L[2*(u$u+1)+1],u$e=u$A-u$R,u$o=u$R-u$Q,u$Z=(-(u$$=(u$$=-(u$c-u$m))/(u$C=Math.sqrt(u$$*u$$+u$e*u$e))*u$a)+u$A)*(-(u$e=u$e/u$C*u$a)+u$m)-(-u$$+u$R)*(-u$e+u$c),u$N=(-(u$K=(u$K=-(u$m-u$T))/(u$C=Math.sqrt(u$K*u$K+u$o*u$o))*u$a)+u$Q)*(-(u$o=u$o/u$C*u$a)+u$m)-(-u$K+u$R)*(-u$o+u$T),u$z=(u$S=-u$e+u$c-(-u$e+u$m))*(u$_=-u$K+u$R-(-u$K+u$Q))-(u$X=-u$o+u$T-(-u$o+u$m))*(u$M=-u$$+u$R-(-u$$+u$A)),Math.abs(u$z)<.1?(u$z+=10.1,u$V.push(u$R-u$$+this.x,u$m-u$e+this.y,u$G,u$l,u$h,u$R+u$$+this.x,u$m+u$e+this.y,u$G,u$l,u$h)):(((u$O=(u$M*u$N-u$_*u$Z)/u$z)-u$R)*(u$O-u$R)+((u$q=(u$X*u$Z-u$S*u$N)/u$z)-u$m)+(u$q-u$m),u$V.push(u$O+this.x,u$q+this.y,u$G,u$l,u$h,u$R-(u$O-u$R)+this.x,u$m-(u$q-u$m)+this.y,u$G,u$l,u$h));u$A=u$L[u$L.length-4],u$c=u$L[u$L.length-3],u$e=u$A-(u$R=u$L[u$L.length-2]),u$$=(u$$=-(u$c-(u$m=u$L[u$L.length-1])))/(u$C=Math.sqrt(u$$*u$$+u$e*u$e))*u$a,u$e=u$e/u$C*u$a,u$V.push(u$R-u$$+this.x,u$m-u$e+this.y,u$G,u$l,u$h,u$R+u$$+this.x,u$m+u$e+this.y,u$G,u$l,u$h);var u$D=u$E;for(u$u=1;u$u<u$D;u$u++)u$j.push(u$y+2*(u$u-1),u$y+2*(u$u-1)+1,u$y+2*u$u+1,u$y+2*u$u+1,u$y+2*u$u,u$y+2*(u$u-1));return u$V},u$j.createLine=function(u$W,u$j,u$t,u$d){var u$b=u$W.concat(),u$E=u$W,u$O=this.borderColor,u$q=(u$O>>16&255)/255,u$A=(u$O>>8&255)/255,u$c=(255&u$O)/255;u$b.splice(0,5);var u$R,u$m,u$Q,u$T,u$$,u$e,u$K,u$o,u$S,u$M,u$Z,u$X,u$_,u$N,u$z,u$C,u$L,u$V,u$x,u$G,u$l=u$b.length/5,u$h=u$d,u$v=u$t/2;u$Q=u$b[0],u$T=u$b[1],u$M=u$Q-(u$$=u$b[5]),u$S=(u$S=-(u$T-(u$e=u$b[6])))/(u$G=Math.sqrt(u$S*u$S+u$M*u$M))*u$v,u$M=u$M/u$G*u$v,u$E.push(u$Q-u$S,u$T-u$M,u$q,u$A,u$c,u$Q+u$S,u$T+u$M,u$q,u$A,u$c);for(var u$y=1;u$y<u$l-1;u$y++)u$Q=u$b[5*(u$y-1)],u$T=u$b[5*(u$y-1)+1],u$$=u$b[5*u$y],u$e=u$b[5*u$y+1],u$K=u$b[5*(u$y+1)],u$o=u$b[5*(u$y+1)+1],u$M=u$Q-u$$,u$X=u$$-u$K,u$z=(-(u$S=(u$S=-(u$T-u$e))/(u$G=Math.sqrt(u$S*u$S+u$M*u$M))*u$v)+u$Q)*(-(u$M=u$M/u$G*u$v)+u$e)-(-u$S+u$$)*(-u$M+u$T),u$V=(-(u$Z=(u$Z=-(u$e-u$o))/(u$G=Math.sqrt(u$Z*u$Z+u$X*u$X))*u$v)+u$K)*(-(u$X=u$X/u$G*u$v)+u$e)-(-u$Z+u$$)*(-u$X+u$o),u$x=(u$_=-u$M+u$T-(-u$M+u$e))*(u$L=-u$Z+u$$-(-u$Z+u$K))-(u$C=-u$X+u$o-(-u$X+u$e))*(u$N=-u$S+u$$-(-u$S+u$Q)),Math.abs(u$x)<.1?(u$x+=10.1,u$E.push(u$$-u$S,u$e-u$M,u$q,u$A,u$c,u$$+u$S,u$e+u$M,u$q,u$A,u$c)):(((u$R=(u$N*u$V-u$L*u$z)/u$x)-u$$)*(u$R-u$$)+((u$m=(u$C*u$z-u$_*u$V)/u$x)-u$e)+(u$m-u$e),u$E.push(u$R,u$m,u$q,u$A,u$c,u$$-(u$R-u$$),u$e-(u$m-u$e),u$q,u$A,u$c));u$Q=u$b[u$b.length-10],u$T=u$b[u$b.length-9],u$M=u$Q-(u$$=u$b[u$b.length-5]),u$S=(u$S=-(u$T-(u$e=u$b[u$b.length-4])))/(u$G=Math.sqrt(u$S*u$S+u$M*u$M))*u$v,u$M=u$M/u$G*u$v,u$E.push(u$$-u$S,u$e-u$M,u$q,u$A,u$c,u$$+u$S,u$e+u$M,u$q,u$A,u$c);var u$a=this.edges+1;for(u$y=1;u$y<u$a;u$y++)u$j.push(u$h+2*(u$y-1),u$h+2*(u$y-1)+1,u$h+2*u$y+1,u$h+2*u$y+1,u$h+2*u$y,u$h+2*(u$y-1));return u$E},u$j.createLoopLine=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=u$W.concat(),u$q=u$b||u$W,u$A=this.borderColor,u$c=(u$A>>16&255)/255,u$R=(u$A>>8&255)/255,u$m=(255&u$A)/255;u$O.splice(0,5);var u$Q=[u$O[0],u$O[1]],u$T=[u$O[u$O.length-5],u$O[u$O.length-4]],u$$=u$T[0]+.5*(u$Q[0]-u$T[0]),u$e=u$T[1]+.5*(u$Q[1]-u$T[1]);u$O.unshift(u$$,u$e,0,0,0),u$O.push(u$$,u$e,0,0,0);var u$K,u$o,u$S,u$M,u$Z,u$X,u$_,u$N,u$z,u$C,u$L,u$V,u$x,u$G,u$l,u$h,u$v,u$y,u$a,u$u,u$D=u$O.length/5,u$s=u$d,u$Y=u$t/2;u$S=u$O[0],u$M=u$O[1],u$C=u$S-(u$Z=u$O[5]),u$z=(u$z=-(u$M-(u$X=u$O[6])))/(u$u=Math.sqrt(u$z*u$z+u$C*u$C))*u$Y,u$C=u$C/u$u*u$Y,u$q.push(u$S-u$z,u$M-u$C,u$c,u$R,u$m,u$S+u$z,u$M+u$C,u$c,u$R,u$m);for(var u$H=1;u$H<u$D-1;u$H++)u$S=u$O[5*(u$H-1)],u$M=u$O[5*(u$H-1)+1],u$Z=u$O[5*u$H],u$X=u$O[5*u$H+1],u$_=u$O[5*(u$H+1)],u$N=u$O[5*(u$H+1)+1],u$C=u$S-u$Z,u$V=u$Z-u$_,u$l=(-(u$z=(u$z=-(u$M-u$X))/(u$u=Math.sqrt(u$z*u$z+u$C*u$C))*u$Y)+u$S)*(-(u$C=u$C/u$u*u$Y)+u$X)-(-u$z+u$Z)*(-u$C+u$M),u$y=(-(u$L=(u$L=-(u$X-u$N))/(u$u=Math.sqrt(u$L*u$L+u$V*u$V))*u$Y)+u$_)*(-(u$V=u$V/u$u*u$Y)+u$X)-(-u$L+u$Z)*(-u$V+u$N),u$a=(u$x=-u$C+u$M-(-u$C+u$X))*(u$v=-u$L+u$Z-(-u$L+u$_))-(u$h=-u$V+u$N-(-u$V+u$X))*(u$G=-u$z+u$Z-(-u$z+u$S)),Math.abs(u$a)<.1?(u$a+=10.1,u$q.push(u$Z-u$z,u$X-u$C,u$c,u$R,u$m,u$Z+u$z,u$X+u$C,u$c,u$R,u$m)):(((u$K=(u$G*u$y-u$v*u$l)/u$a)-u$Z)*(u$K-u$Z)+((u$o=(u$h*u$l-u$x*u$y)/u$a)-u$X)+(u$o-u$X),u$q.push(u$K,u$o,u$c,u$R,u$m,u$Z-(u$K-u$Z),u$X-(u$o-u$X),u$c,u$R,u$m));u$E&&(u$j=u$E);var u$I=this.edges+1;for(u$H=1;u$H<u$I;u$H++)u$j.push(u$s+2*(u$H-1),u$s+2*(u$H-1)+1,u$s+2*u$H+1,u$s+2*u$H+1,u$s+2*u$H,u$s+2*(u$H-1));return u$j.push(u$s+2*(u$H-1),u$s+2*(u$H-1)+1,u$s+1,u$s+1,u$s,u$s+2*(u$H-1)),u$q},u$W}(),u$dW=function(){function u$e(){}return u$Q(u$e,"laya.webgl.shapes.Earcut"),u$e.earcut=function(u$W,u$j,u$t){u$t=u$t||2;var u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R=u$j&&u$j.length,u$m=u$R?u$j[0]*u$t:u$W.length,u$Q=u$e.linkedList(u$W,0,u$m,u$t,!0),u$T=[];if(!u$Q)return u$T;if(u$R&&(u$Q=u$e.eliminateHoles(u$W,u$j,u$Q,u$t)),u$W.length>80*u$t){u$d=u$E=u$W[0],u$b=u$O=u$W[1];for(var u$$=u$t;u$$<u$m;u$$+=u$t)(u$q=u$W[u$$])<u$d&&(u$d=u$q),(u$A=u$W[u$$+1])<u$b&&(u$b=u$A),u$E<u$q&&(u$E=u$q),u$O<u$A&&(u$O=u$A);u$c=0!==(u$c=Math.max(u$E-u$d,u$O-u$b))?1/u$c:0}return u$e.earcutLinked(u$Q,u$T,u$t,u$d,u$b,u$c),u$T},u$e.linkedList=function(u$W,u$j,u$t,u$d,u$b){var u$E,u$O;if(u$b===0<u$e.signedArea(u$W,u$j,u$t,u$d))for(u$E=u$j;u$E<u$t;u$E+=u$d)u$O=u$e.insertNode(u$E,u$W[u$E],u$W[u$E+1],u$O);else for(u$E=u$t-u$d;u$j<=u$E;u$E-=u$d)u$O=u$e.insertNode(u$E,u$W[u$E],u$W[u$E+1],u$O);return u$O&&u$e.equals(u$O,u$O.next)&&(u$e.removeNode(u$O),u$O=u$O.next),u$O},u$e.filterPoints=function(u$W,u$j){if(!u$W)return u$W;u$j||(u$j=u$W);var u$t,u$d=u$W;do{if(u$t=!1,u$d.steiner||!u$e.equals(u$d,u$d.next)&&0!==u$e.area(u$d.prev,u$d,u$d.next))u$d=u$d.next;else{if(u$e.removeNode(u$d),(u$d=u$j=u$d.prev)===u$d.next)break;u$t=!0}}while(u$t||u$d!==u$j);return u$j},u$e.earcutLinked=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){if(u$W){!u$O&&u$E&&u$e.indexCurve(u$W,u$d,u$b,u$E);for(var u$q,u$A,u$c=u$W;u$W.prev!==u$W.next;)if(u$q=u$W.prev,u$A=u$W.next,u$E?u$e.isEarHashed(u$W,u$d,u$b,u$E):u$e.isEar(u$W))u$j.push(u$q.i/u$t),u$j.push(u$W.i/u$t),u$j.push(u$A.i/u$t),u$e.removeNode(u$W),u$W=u$A.next,u$c=u$A.next;else if((u$W=u$A)===u$c){u$O?1===u$O?(u$W=u$e.cureLocalIntersections(u$W,u$j,u$t),u$e.earcutLinked(u$W,u$j,u$t,u$d,u$b,u$E,2)):2===u$O&&u$e.splitEarcut(u$W,u$j,u$t,u$d,u$b,u$E):u$e.earcutLinked(u$e.filterPoints(u$W,null),u$j,u$t,u$d,u$b,u$E,1);break}}},u$e.isEar=function(u$W){var u$j=u$W.prev,u$t=u$W,u$d=u$W.next;if(0<=u$e.area(u$j,u$t,u$d))return!1;for(var u$b=u$W.next.next;u$b!==u$W.prev;){if(u$e.pointInTriangle(u$j.x,u$j.y,u$t.x,u$t.y,u$d.x,u$d.y,u$b.x,u$b.y)&&0<=u$e.area(u$b.prev,u$b,u$b.next))return!1;u$b=u$b.next}return!0},u$e.isEarHashed=function(u$W,u$j,u$t,u$d){var u$b=u$W.prev,u$E=u$W,u$O=u$W.next;if(0<=u$e.area(u$b,u$E,u$O))return!1;for(var u$q=u$b.x<u$E.x?u$b.x<u$O.x?u$b.x:u$O.x:u$E.x<u$O.x?u$E.x:u$O.x,u$A=u$b.y<u$E.y?u$b.y<u$O.y?u$b.y:u$O.y:u$E.y<u$O.y?u$E.y:u$O.y,u$c=u$b.x>u$E.x?u$b.x>u$O.x?u$b.x:u$O.x:u$E.x>u$O.x?u$E.x:u$O.x,u$R=u$b.y>u$E.y?u$b.y>u$O.y?u$b.y:u$O.y:u$E.y>u$O.y?u$E.y:u$O.y,u$m=u$e.zOrder(u$q,u$A,u$j,u$t,u$d),u$Q=u$e.zOrder(u$c,u$R,u$j,u$t,u$d),u$T=u$W.nextZ;u$T&&u$T.z<=u$Q;){if(u$T!==u$W.prev&&u$T!==u$W.next&&u$e.pointInTriangle(u$b.x,u$b.y,u$E.x,u$E.y,u$O.x,u$O.y,u$T.x,u$T.y)&&0<=u$e.area(u$T.prev,u$T,u$T.next))return!1;u$T=u$T.nextZ}for(u$T=u$W.prevZ;u$T&&u$T.z>=u$m;){if(u$T!==u$W.prev&&u$T!==u$W.next&&u$e.pointInTriangle(u$b.x,u$b.y,u$E.x,u$E.y,u$O.x,u$O.y,u$T.x,u$T.y)&&0<=u$e.area(u$T.prev,u$T,u$T.next))return!1;u$T=u$T.prevZ}return!0},u$e.cureLocalIntersections=function(u$W,u$j,u$t){var u$d=u$W;do{var u$b=u$d.prev,u$E=u$d.next.next;!u$e.equals(u$b,u$E)&&u$e.intersects(u$b,u$d,u$d.next,u$E)&&u$e.locallyInside(u$b,u$E)&&u$e.locallyInside(u$E,u$b)&&(u$j.push(u$b.i/u$t),u$j.push(u$d.i/u$t),u$j.push(u$E.i/u$t),u$e.removeNode(u$d),u$e.removeNode(u$d.next),u$d=u$W=u$E),u$d=u$d.next}while(u$d!==u$W);return u$d},u$e.splitEarcut=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=u$W;do{for(var u$q=u$O.next.next;u$q!==u$O.prev;){if(u$O.i!==u$q.i&&u$e.isValidDiagonal(u$O,u$q)){var u$A=u$e.splitPolygon(u$O,u$q);return u$O=u$e.filterPoints(u$O,u$O.next),u$A=u$e.filterPoints(u$A,u$A.next),u$e.earcutLinked(u$O,u$j,u$t,u$d,u$b,u$E),void u$e.earcutLinked(u$A,u$j,u$t,u$d,u$b,u$E)}u$q=u$q.next}u$O=u$O.next}while(u$O!==u$W)},u$e.eliminateHoles=function(u$W,u$j,u$t,u$d){var u$b,u$E,u$O,u$q,u$A,u$c=[];for(u$b=0,u$E=u$j.length;u$b<u$E;u$b++)u$O=u$j[u$b]*u$d,u$q=u$b<u$E-1?u$j[u$b+1]*u$d:u$W.length,(u$A=u$e.linkedList(u$W,u$O,u$q,u$d,!1))===u$A.next&&(u$A.steiner=!0),u$c.push(u$e.getLeftmost(u$A));for(u$c.sort(u$e.compareX),u$b=0;u$b<u$c.length;u$b++)u$e.eliminateHole(u$c[u$b],u$t),u$t=u$e.filterPoints(u$t,u$t.next);return u$t},u$e.compareX=function(u$W,u$j){return u$W.x-u$j.x},u$e.eliminateHole=function(u$W,u$j){if(u$j=u$e.findHoleBridge(u$W,u$j)){var u$t=u$e.splitPolygon(u$j,u$W);u$e.filterPoints(u$t,u$t.next)}},u$e.findHoleBridge=function(u$W,u$j){var u$t,u$d=u$j,u$b=u$W.x,u$E=u$W.y,u$O=-1/0;do{if(u$E<=u$d.y&&u$E>=u$d.next.y&&u$d.next.y!==u$d.y){var u$q=u$d.x+(u$E-u$d.y)*(u$d.next.x-u$d.x)/(u$d.next.y-u$d.y);if(u$q<=u$b&&u$O<u$q){if((u$O=u$q)===u$b){if(u$E===u$d.y)return u$d;if(u$E===u$d.next.y)return u$d.next}u$t=u$d.x<u$d.next.x?u$d:u$d.next}}u$d=u$d.next}while(u$d!==u$j);if(!u$t)return null;if(u$b===u$O)return u$t.prev;var u$A,u$c=u$t,u$R=u$t.x,u$m=u$t.y,u$Q=1/0;for(u$d=u$t.next;u$d!==u$c;)u$b>=u$d.x&&u$d.x>=u$R&&u$b!==u$d.x&&u$e.pointInTriangle(u$E<u$m?u$b:u$O,u$E,u$R,u$m,u$E<u$m?u$O:u$b,u$E,u$d.x,u$d.y)&&((u$A=Math.abs(u$E-u$d.y)/(u$b-u$d.x))<u$Q||u$A===u$Q&&u$d.x>u$t.x)&&u$e.locallyInside(u$d,u$W)&&(u$t=u$d,u$Q=u$A),u$d=u$d.next;return u$t},u$e.indexCurve=function(u$W,u$j,u$t,u$d){for(var u$b=u$W;null===u$b.z&&(u$b.z=u$e.zOrder(u$b.x,u$b.y,u$j,u$t,u$d)),u$b.prevZ=u$b.prev,u$b.nextZ=u$b.next,(u$b=u$b.next)!==u$W;);u$b.prevZ.nextZ=null,u$b.prevZ=null,u$e.sortLinked(u$b)},u$e.sortLinked=function(u$W){var u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c=1;do{for(u$t=u$W,u$E=u$W=null,u$O=0;u$t;){for(u$O++,u$d=u$t,u$j=u$q=0;u$j<u$c&&(u$q++,u$d=u$d.nextZ);u$j++);for(u$A=u$c;0<u$q||0<u$A&&u$d;)0!==u$q&&(0===u$A||!u$d||u$t.z<=u$d.z)?(u$t=(u$b=u$t).nextZ,u$q--):(u$d=(u$b=u$d).nextZ,u$A--),u$E?u$E.nextZ=u$b:u$W=u$b,u$b.prevZ=u$E,u$E=u$b;u$t=u$d}u$E.nextZ=null,u$c*=2}while(1<u$O);return u$W},u$e.zOrder=function(u$W,u$j,u$t,u$d,u$b){return(u$W=1431655765&((u$W=858993459&((u$W=252645135&((u$W=16711935&((u$W=32767*(u$W-u$t)*u$b)|u$W<<8))|u$W<<4))|u$W<<2))|u$W<<1))|(u$j=1431655765&((u$j=858993459&((u$j=252645135&((u$j=16711935&((u$j=32767*(u$j-u$d)*u$b)|u$j<<8))|u$j<<4))|u$j<<2))|u$j<<1))<<1},u$e.getLeftmost=function(u$W){for(var u$j=u$W,u$t=u$W;u$j.x<u$t.x&&(u$t=u$j),(u$j=u$j.next)!==u$W;);return u$t},u$e.pointInTriangle=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){return 0<=(u$b-u$O)*(u$j-u$q)-(u$W-u$O)*(u$E-u$q)&&0<=(u$W-u$O)*(u$d-u$q)-(u$t-u$O)*(u$j-u$q)&&0<=(u$t-u$O)*(u$E-u$q)-(u$b-u$O)*(u$d-u$q)},u$e.isValidDiagonal=function(u$W,u$j){return u$W.next.i!==u$j.i&&u$W.prev.i!==u$j.i&&!u$e.intersectsPolygon(u$W,u$j)&&u$e.locallyInside(u$W,u$j)&&u$e.locallyInside(u$j,u$W)&&u$e.middleInside(u$W,u$j)},u$e.area=function(u$W,u$j,u$t){return(u$j.y-u$W.y)*(u$t.x-u$j.x)-(u$j.x-u$W.x)*(u$t.y-u$j.y)},u$e.equals=function(u$W,u$j){return u$W.x===u$j.x&&u$W.y===u$j.y},u$e.intersects=function(u$W,u$j,u$t,u$d){return!!(u$e.equals(u$W,u$j)&&u$e.equals(u$t,u$d)||u$e.equals(u$W,u$d)&&u$e.equals(u$t,u$j))||0<u$e.area(u$W,u$j,u$t)!=0<u$e.area(u$W,u$j,u$d)&&0<u$e.area(u$t,u$d,u$W)!=0<u$e.area(u$t,u$d,u$j)},u$e.intersectsPolygon=function(u$W,u$j){var u$t=u$W;do{if(u$t.i!==u$W.i&&u$t.next.i!==u$W.i&&u$t.i!==u$j.i&&u$t.next.i!==u$j.i&&u$e.intersects(u$t,u$t.next,u$W,u$j))return!0;u$t=u$t.next}while(u$t!==u$W);return!1},u$e.locallyInside=function(u$W,u$j){return u$e.area(u$W.prev,u$W,u$W.next)<0?0<=u$e.area(u$W,u$j,u$W.next)&&0<=u$e.area(u$W,u$W.prev,u$j):u$e.area(u$W,u$j,u$W.prev)<0||u$e.area(u$W,u$W.next,u$j)<0},u$e.middleInside=function(u$W,u$j){for(var u$t=u$W,u$d=!1,u$b=(u$W.x+u$j.x)/2,u$E=(u$W.y+u$j.y)/2;u$t.y>u$E!=u$t.next.y>u$E&&u$t.next.y!==u$t.y&&u$b<(u$t.next.x-u$t.x)*(u$E-u$t.y)/(u$t.next.y-u$t.y)+u$t.x&&(u$d=!u$d),(u$t=u$t.next)!==u$W;);return u$d},u$e.splitPolygon=function(u$W,u$j){var u$t=new u$bW(u$W.i,u$W.x,u$W.y),u$d=new u$bW(u$j.i,u$j.x,u$j.y),u$b=u$W.next,u$E=u$j.prev;return(u$W.next=u$j).prev=u$W,(u$t.next=u$b).prev=u$t,(u$d.next=u$t).prev=u$d,(u$E.next=u$d).prev=u$E,u$d},u$e.insertNode=function(u$W,u$j,u$t,u$d){var u$b=new u$bW(u$W,u$j,u$t);return u$d?(u$b.next=u$d.next,(u$b.prev=u$d).next.prev=u$b,u$d.next=u$b):(u$b.prev=u$b).next=u$b,u$b},u$e.removeNode=function(u$W){u$W.next.prev=u$W.prev,u$W.prev.next=u$W.next,u$W.prevZ&&(u$W.prevZ.nextZ=u$W.nextZ),u$W.nextZ&&(u$W.nextZ.prevZ=u$W.prevZ)},u$e.signedArea=function(u$W,u$j,u$t,u$d){for(var u$b=0,u$E=u$j,u$O=u$t-u$d;u$E<u$t;u$E+=u$d)u$b+=(u$W[u$O]-u$W[u$E])*(u$W[u$E+1]+u$W[u$O+1]),u$O=u$E;return u$b},u$e}(),u$bW=function(){function u$W(u$W,u$j,u$t){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=u$W,this.x=u$j,this.y=u$t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return u$Q(u$W,"laya.webgl.shapes.EarcutNode"),u$W}(),u$EW=(function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this.lineWidth=u$W,this.lineColor=u$j,this.lineAlpha=u$t,this.fillColor=u$d,this.fillAlpha=u$b,this.shape=u$O,this.fill=u$E}u$Q(u$W,"laya.webgl.shapes.GeometryData");var u$j=u$W.prototype;u$j.clone=function(){return new u$W(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},u$j.getIndexData=function(){return null},u$j.getVertexData=function(){return null},u$j.destroy=function(){this.shape=null}}(),function(){function u$W(u$W){if(u$W instanceof Float32Array)this.points=u$W;else if(u$W instanceof Array){u$W.length;this.points=new Float32Array(u$W)}}u$Q(u$W,"laya.webgl.shapes.Vertex");var u$j=u$W.prototype;u$_.imps(u$j,{"laya.webgl.shapes.IShape":!0}),u$j.getData=function(u$W,u$j,u$t){},u$j.needUpdate=function(u$W){return!1},u$j.rebuild=function(u$W){},u$j.setMatrix=function(u$W){}}(),function(){function u$A(u$W){void 0===u$W&&(u$W=1e4),this._renderType=u$W}u$Q(u$A,"laya.webgl.submit.Submit");var u$W=u$A.prototype;return u$_.imps(u$W,{"laya.webgl.submit.ISubmit":!0}),u$W.releaseRender=function(){var u$W=u$A._cache;(u$W[u$W._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},u$W.getRenderType=function(){return this._renderType},u$W.renderSubmit=function(){if(0===this._numEle)return 1;var u$W=this.shaderValue.textureHost;if(u$W){var u$j=u$W.source;if(!u$W.bitmap||!u$j)return 1;this.shaderValue.texture=u$j,u$W.alphaTexture&&u$W.alphaTexture.source&&(this.shaderValue.texture1=u$W.alphaTexture.source)}this._vb.bind_upload(this._ib);var u$t=u$ZW.mainContext;return this.shaderValue.upload(),u$f.activeBlendFunction!==this._blendFn&&(u$t.enable(3042),this._blendFn(u$t),u$f.activeBlendFunction=this._blendFn),u$l.drawCall++,u$l.trianglesFaces+=this._numEle/3,u$t.drawElements(4,this._numEle,5123,this._startIdx),1},u$A.__init__=function(){var u$W=u$A.RENDERBASE=new u$A(-1);u$W.shaderValue=new u$zW(0,0),u$W.shaderValue.ALPHA=-1234},u$A.createSubmit=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$A._cache._length?u$A._cache[--u$A._cache._length]:new u$A;null==u$t&&((u$t=u$E._selfVb||(u$E._selfVb=u$FW.create(-1))).clear(),u$d=0),u$E._ib=u$j,u$E._vb=u$t,u$E._startIdx=u$d*u$eW.BYTES_PIDX,u$E._numEle=0;var u$O=u$W._nBlendType;u$E._blendFn=u$W._targets?u$f.targetFns[u$O]:u$f.fns[u$O],u$E.shaderValue=u$b,u$E.shaderValue.setValue(u$W._shader2D);var u$q=u$W._shader2D.filters;return u$q&&u$E.shaderValue.setFilters(u$q),u$E},u$A.createShape=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=u$A._cache._length?u$A._cache[--u$A._cache._length]:new u$A;u$O._ib=u$j,u$O._vb=u$t,u$O._numEle=u$d,u$O._startIdx=u$b,u$O.shaderValue=u$E,u$O.shaderValue.setValue(u$W._shader2D);var u$q=u$W._nBlendType;return u$O._blendFn=u$W._targets?u$f.targetFns[u$q]:u$f.fns[u$q],u$O},u$A.TYPE_2D=1e4,u$A.TYPE_CANVAS=10003,u$A.TYPE_CMDSETRT=10004,u$A.TYPE_CUSTOM=10005,u$A.TYPE_BLURRT=10006,u$A.TYPE_CMDDESTORYPRERT=10007,u$A.TYPE_DISABLESTENCIL=10008,u$A.TYPE_OTHERIBVB=10009,u$A.TYPE_PRIMITIVE=10010,u$A.TYPE_RT=10011,u$A.TYPE_BLUR_RT=10012,u$A.TYPE_TARGET=10013,u$A.TYPE_CHANGE_VALUE=10014,u$A.TYPE_SHAPE=10015,u$A.TYPE_TEXTURE=10016,u$A.TYPE_FILLTEXTURE=10017,u$A.RENDERBASE=null,u$A._cache=((u$A._cache=[])._length=0,u$A._cache),u$A}()),u$OW=function(){function u$d(){this.fun=null,this.args=null}u$Q(u$d,"laya.webgl.submit.SubmitCMD");var u$W=u$d.prototype;return u$_.imps(u$W,{"laya.webgl.submit.ISubmit":!0}),u$W.renderSubmit=function(){return this.fun.apply(null,this.args),1},u$W.getRenderType=function(){return 0},u$W.releaseRender=function(){var u$W=u$d._cache;u$W[u$W._length++]=this},u$d.create=function(u$W,u$j){var u$t=u$d._cache._length?u$d._cache[--u$d._cache._length]:new u$d;return u$t.fun=u$j,u$t.args=u$W,u$t},u$d._cache=((u$d._cache=[])._length=0,u$d._cache),u$d}(),u$qW=function(){function u$j(){this.variables={}}u$Q(u$j,"laya.webgl.submit.SubmitCMDScope");var u$W=u$j.prototype;return u$W.getValue=function(u$W){return this.variables[u$W]},u$W.addValue=function(u$W,u$j){return this.variables[u$W]=u$j},u$W.setValue=function(u$W,u$j){return this.variables.hasOwnProperty(u$W)?this.variables[u$W]=u$j:null},u$W.clear=function(){for(var u$W in this.variables)delete this.variables[u$W]},u$W.recycle=function(){this.clear(),u$j.POOL.push(this)},u$j.create=function(){var u$W=u$j.POOL.pop();return u$W||(u$W=new u$j),u$W},u$j.POOL=[],u$j}(),u$AW=function(){function u$m(){this.offset=0,this.startIndex=0,this._mat=u$C.create()}u$Q(u$m,"laya.webgl.submit.SubmitOtherIBVB");var u$W=u$m.prototype;return u$_.imps(u$W,{"laya.webgl.submit.ISubmit":!0}),u$W.releaseRender=function(){var u$W=u$m._cache;(u$W[u$W._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},u$W.getRenderType=function(){return 10009},u$W.renderSubmit=function(){var u$W=this._shaderValue.textureHost;if(u$W){var u$j=u$W.source;if(!u$W.bitmap||!u$j)return 1;this._shaderValue.texture=u$j}this._vb.bind_upload(this._ib);var u$t=u$SW.worldMatrix4,u$d=u$C.TEMP;u$C.mulPre(this._mat,u$t[0],u$t[1],u$t[4],u$t[5],u$t[12],u$t[13],u$d);var u$b=u$SW.worldMatrix4=u$m.tempMatrix4;u$b[0]=u$d.a,u$b[1]=u$d.b,u$b[4]=u$d.c,u$b[5]=u$d.d,u$b[12]=u$d.tx,u$b[13]=u$d.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var u$E=u$ZW.mainContext;return u$f.activeBlendFunction!==this._blendFn&&(u$E.enable(3042),this._blendFn(u$E),u$f.activeBlendFunction=this._blendFn),u$l.drawCall++,u$l.trianglesFaces+=this._numEle/3,u$E.drawElements(4,this._numEle,5123,this.startIndex),u$SW.worldMatrix4=u$t,u$uW.activeShader=null,1},u$m.create=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){void 0===u$A&&(u$A=0);var u$c=u$m._cache._length?u$m._cache[--u$m._cache._length]:new u$m;u$c._ib=u$t,u$c._vb=u$j,u$c._numEle=u$d,u$c._shader=u$b,u$c._shaderValue=u$E;var u$R=u$W._nBlendType;switch(u$c._blendFn=u$W._targets?u$f.targetFns[u$R]:u$f.fns[u$R],u$A){case 0:u$c.offset=0,u$c.startIndex=u$q/(u$eW.BYTES_PE*u$j.vertexStride)*1.5,u$c.startIndex*=u$eW.BYTES_PIDX;break;case 1:u$c.startIndex=u$O,u$c.offset=u$q}return u$c},u$m._cache=((u$m._cache=[])._length=0,u$m._cache),u$m.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u$m}(),u$cW=function(){function u$t(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new u$V,this.screenRect=new u$V}u$Q(u$t,"laya.webgl.submit.SubmitScissor");var u$W=u$t.prototype;return u$_.imps(u$W,{"laya.webgl.submit.ISubmit":!0}),u$W._scissor=function(u$W,u$j,u$t,u$d){var u$b=u$SW.worldMatrix4,u$E=u$b[0],u$O=u$b[5],u$q=u$b[12],u$A=u$b[13];if(u$d*=u$O,(u$t*=u$E)<1||u$d<1)return!1;var u$c=(u$W=u$W*u$E+u$q)+u$t,u$R=(u$j=u$j*u$O+u$A)+u$d;u$W<0&&(u$t=u$c-(u$W=0)),u$j<0&&(u$d=u$R-(u$j=0));var u$m=u$SW.worldClipRect;if(u$W=Math.max(u$W,u$m.x),u$j=Math.max(u$j,u$m.y),u$t=Math.min(u$c,u$m.right)-u$W,u$d=Math.min(u$R,u$m.bottom)-u$j,u$t<1||u$d<1)return!1;var u$Q=u$SW.worldScissorTest;return this.screenRect.copyFrom(u$m),u$m.x=u$W,u$m.y=u$j,u$m.width=u$t,u$m.height=u$d,u$SW.worldScissorTest=!0,u$j=u$SW.height-u$j-u$d,u$ZW.mainContext.scissor(u$W,u$j,u$t,u$d),u$ZW.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),u$Q?(u$j=u$SW.height-this.screenRect.y-this.screenRect.height,u$ZW.mainContext.scissor(this.screenRect.x,u$j,this.screenRect.width,this.screenRect.height),u$ZW.mainContext.enable(3089)):(u$ZW.mainContext.disable(3089),u$SW.worldScissorTest=!1),u$m.copyFrom(this.screenRect),!0},u$W._scissorWithTagart=function(u$W,u$j,u$t,u$d){if(u$t<1||u$d<1)return!1;var u$b=u$W+u$t,u$E=u$j+u$d;u$W<0&&(u$t=u$b-(u$W=0)),u$j<0&&(u$d=u$E-(u$j=0));var u$O=u$SW.worldClipRect;if(u$W=Math.max(u$W,u$O.x),u$j=Math.max(u$j,u$O.y),u$t=Math.min(u$b,u$O.right)-u$W,u$d=Math.min(u$E,u$O.bottom)-u$j,u$t<1||u$d<1)return!1;var u$q=u$SW.worldScissorTest;return this.screenRect.copyFrom(u$O),u$SW.worldScissorTest=!0,u$O.x=u$W,u$O.y=u$j,u$O.width=u$t,u$O.height=u$d,u$j=u$SW.height-u$j-u$d,u$ZW.mainContext.scissor(u$W,u$j,u$t,u$d),u$ZW.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),u$q?(u$j=u$SW.height-this.screenRect.y-this.screenRect.height,u$ZW.mainContext.scissor(this.screenRect.x,u$j,this.screenRect.width,this.screenRect.height),u$ZW.mainContext.enable(3089)):(u$ZW.mainContext.disable(3089),u$SW.worldScissorTest=!1),u$O.copyFrom(this.screenRect),!0},u$W.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},u$W.getRenderType=function(){return 0},u$W.releaseRender=function(){var u$W=u$t._cache;(u$W[u$W._length++]=this).context=null},u$t.create=function(u$W){var u$j=u$t._cache._length?u$t._cache[--u$t._cache._length]:new u$t;return u$j.context=u$W,u$j},u$t._cache=((u$t._cache=[])._length=0,u$t._cache),u$t}(),u$RW=function(){function u$A(){this.step=0,this.blendMode=null,this.level=0}u$Q(u$A,"laya.webgl.submit.SubmitStencil");var u$W=u$A.prototype;return u$_.imps(u$W,{"laya.webgl.submit.ISubmit":!0}),u$W.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},u$W.getRenderType=function(){return 0},u$W.releaseRender=function(){var u$W=u$A._cache;u$W[u$W._length++]=this},u$W.do1=function(){var u$W=u$ZW.mainContext;u$W.enable(2960),u$W.clear(1024),u$W.colorMask(!1,!1,!1,!1),u$W.stencilFunc(514,this.level,255),u$W.stencilOp(7680,7680,7682)},u$W.do2=function(){var u$W=u$ZW.mainContext;u$W.stencilFunc(514,this.level+1,255),u$W.colorMask(!0,!0,!0,!0),u$W.stencilOp(7680,7680,7680)},u$W.do3=function(){var u$W=u$ZW.mainContext;u$W.colorMask(!0,!0,!0,!0),u$W.stencilOp(7680,7680,7680),u$W.clear(1024),u$W.disable(2960)},u$W.do4=function(){var u$W=u$ZW.mainContext;0==this.level&&(u$W.enable(2960),u$W.clear(1024)),u$W.colorMask(!1,!1,!1,!1),u$W.stencilFunc(519,0,255),u$W.stencilOp(7680,7680,7682)},u$W.do5=function(){var u$W=u$ZW.mainContext;u$W.stencilFunc(514,this.level,255),u$W.colorMask(!0,!0,!0,!0),u$W.stencilOp(7680,7680,7680)},u$W.do6=function(){var u$W=u$ZW.mainContext;u$f.targetFns[u$f.TOINT[this.blendMode]](u$W)},u$W.do7=function(){var u$W=u$ZW.mainContext;u$W.colorMask(!1,!1,!1,!1),u$W.stencilOp(7680,7680,7683)},u$W.do8=function(){var u$W=u$ZW.mainContext;u$W.colorMask(!0,!0,!0,!0),u$W.stencilFunc(514,this.level,255),u$W.stencilOp(7680,7680,7680)},u$A.restore=function(u$W,u$j,u$t,u$d,u$b){var u$E;if((u$W._renderKey=0)<u$A._mask&&u$A._mask--,0==u$A._mask)u$E=laya.webgl.submit.SubmitStencil.create(3),u$W.addRenderObject(u$E),u$W._curSubmit=u$EW.RENDERBASE;else{u$E=laya.webgl.submit.SubmitStencil.create(7),u$W.addRenderObject(u$E);var u$O=u$W._vb;u$O._byteLength;if(u$KW.fillRectImgVb(u$O,null,u$j.x,u$j.y,u$j.width,u$j.height,u$a.DEF_UV,u$t,u$d,u$b,0,0)){u$W._shader2D.glTexture=null;var u$q=u$W._curSubmit=u$EW.createSubmit(u$W,u$W._ib,u$O,(u$O._byteLength-64)/32*3,u$zW.create(2,0));u$q.shaderValue.ALPHA=1,u$W._submits[u$W._submits._length++]=u$q,u$W._curSubmit._numEle+=6,u$W._curSubmit=u$EW.RENDERBASE}else alert("clipRect calc stencil rect error");u$E=laya.webgl.submit.SubmitStencil.create(8),u$W.addRenderObject(u$E)}},u$A.restore2=function(u$W,u$j){var u$t;(u$W._renderKey=0)<u$A._mask&&u$A._mask--,0==u$A._mask?(u$t=laya.webgl.submit.SubmitStencil.create(3),u$W.addRenderObject(u$t),u$W._curSubmit=u$EW.RENDERBASE):(u$t=laya.webgl.submit.SubmitStencil.create(7),u$W.addRenderObject(u$t),u$W._submits[u$W._submits._length++]=u$j,u$t=laya.webgl.submit.SubmitStencil.create(8),u$W.addRenderObject(u$t))},u$A.create=function(u$W){var u$j=u$A._cache._length?u$A._cache[--u$A._cache._length]:new u$A;return 5==(u$j.step=u$W)&&++u$A._mask,u$j.level=u$A._mask,u$j},u$A._cache=((u$A._cache=[])._length=0,u$A._cache),u$A._mask=0,u$A}(),u$mW=function(){function u$q(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}u$Q(u$q,"laya.webgl.submit.SubmitTarget");var u$W=u$q.prototype;return u$_.imps(u$W,{"laya.webgl.submit.ISubmit":!0}),u$W.renderSubmit=function(){this._vb.bind_upload(this._ib);var u$W=this.scope.getValue(this.proName);return u$W&&(this.shaderValue.texture=u$W.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[u$W.width,u$W.height]),this.shaderValue.upload(),this.blend(),u$l.drawCall++,u$l.trianglesFaces+=this._numEle/3,u$ZW.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},u$W.blend=function(){if(u$f.activeBlendFunction!==u$f.fns[this.blendType]){var u$W=u$ZW.mainContext;u$W.enable(3042),u$f.fns[this.blendType](u$W),u$f.activeBlendFunction=u$f.fns[this.blendType]}},u$W.getRenderType=function(){return 0},u$W.releaseRender=function(){var u$W=u$q._cache;(u$W[u$W._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},u$q.create=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=u$q._cache._length?u$q._cache[--u$q._cache._length]:new u$q;return u$O._ib=u$j,u$O._vb=u$t,u$O.proName=u$E,u$O._startIdx=u$d*u$eW.BYTES_PIDX,u$O._numEle=0,u$O.blendType=u$W._nBlendType,u$O.shaderValue=u$b,u$O.shaderValue.setValue(u$W._shader2D),u$O},u$q._cache=((u$q._cache=[])._length=0,u$q._cache),u$q}(),u$QW=function(){function u$W(){this._sourceStr=null}u$Q(u$W,"laya.webgl.text.CharSegment");var u$j=u$W.prototype;return u$_.imps(u$j,{"laya.webgl.text.ICharSegment":!0}),u$j.textToSpit=function(u$W){this._sourceStr=u$W},u$j.getChar=function(u$W){return this._sourceStr.charAt(u$W)},u$j.getCharCode=function(u$W){return this._sourceStr.charCodeAt(u$W)},u$j.length=function(){return this._sourceStr.length},u$W}(),u$TW=function(){var u$W;function u$l(){}return u$Q(u$l,"laya.webgl.text.DrawText"),u$l.__init__=function(){u$l._charsTemp=new Array,u$l._drawValue=new u$W,u$l._charSeg=new u$QW},u$l.customCharSeg=function(u$W){u$l._charSeg=u$W},u$l.getChar=function(u$W,u$j,u$t){var u$d=u$JW.createOneChar(u$W,u$t);return-1!=u$j&&(u$l._charsCache[u$j]=u$d),u$d},u$l._drawSlow=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$m,u$Q,u$T,u$$){var u$e,u$K,u$o=u$l._drawValue.value(u$E,u$q,u$A,u$c,u$Q,u$T,u$$),u$S=0,u$M=0,u$Z=u$l._charsTemp,u$X=0,u$_=NaN;if(u$d)for(u$Z.length=u$d.length,u$S=0,u$M=u$d.length;u$S<u$M;u$S++)(u$K=u$d[u$S])&&(u$_=u$K.charNum+u$o.txtID,u$Z[u$S]=u$e=u$l._charsCache[u$_]||u$l.getChar(u$K.char,u$_,u$o),u$e.active());else{var u$N=u$t instanceof laya.utils.WordText?u$t.toString():u$t;if(u$y.CharacterCache){u$l._charSeg.textToSpit(u$N);var u$z=u$l._charSeg.length();for(u$S=0,u$M=u$Z.length=u$z;u$S<u$M;u$S++)u$_=u$l._charSeg.getCharCode(u$S)+u$o.txtID,u$Z[u$S]=u$e=u$l._charsCache[u$_]||u$l.getChar(u$l._charSeg.getChar(u$S),u$_,u$o),u$e.active(),u$X+=u$e.cw}else u$Z.length=0,(u$e=u$l.getChar(u$N,-1,u$o)).active(),u$X+=u$e.cw,u$Z[0]=u$e}var u$C=0;null!==u$O&&"left"!==u$O&&(u$C=-("center"==u$O?u$X/2:u$X));var u$L,u$V,u$x=NaN,u$G=0;if(u$d)for(u$S=0,u$M=u$Z.length;u$S<u$M;u$S++)u$e=u$Z[u$S],u$K=u$d[u$S],u$e&&u$K&&!u$e.isSpace&&(u$x=u$e.borderSize,u$L=u$e.texture,u$j._drawText(u$L,u$R+u$C+u$K.x*u$Q-u$x,u$m+u$K.y*u$T-u$x,u$L.width,u$L.height,u$b,0,0,0,0));else{for(u$S=0,u$M=u$Z.length;u$S<u$M;u$S++)(u$e=u$Z[u$S])&&!u$e.isSpace&&(u$x=u$e.borderSize,u$L=u$e.texture,u$j._drawText(u$L,u$R+u$C-u$x,u$m-u$x,u$L.width,u$L.height,u$b,0,0,0,0),u$W&&((u$V=u$W[u$G++])||(u$V=u$W[u$G-1]=[]),u$V[0]=u$L,u$V[1]=u$C-u$x,u$V[2]=-u$x)),u$C+=u$e.cw;u$W&&(u$W.length=u$G)}},u$l._drawFast=function(u$W,u$j,u$t,u$d,u$b){for(var u$E,u$O,u$q=0,u$A=u$W.length;u$q<u$A;u$q++)(u$E=(u$O=u$W[u$q])[0]).active(),u$j._drawText(u$E,u$d+u$O[1],u$b+u$O[2],u$E.width,u$E.height,u$t,0,0,0,0)},u$l.drawText=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$m){if(void 0===u$m&&(u$m=0),!(u$j&&0===u$j.length||u$t&&0===u$t.length)){var u$Q=u$d.a,u$T=u$d.d;(0!==u$d.b||0!==u$d.c)&&(u$Q=u$T=1);var u$$=1!==u$Q||1!==u$T;if(u$$&&u$_.stage.transform){var u$e=u$_.stage.transform;u$$=u$e.a===u$Q&&u$e.d===u$T}else u$$=!1;if(u$$){var u$K=(u$d=u$d.copyTo(u$NW._tmpMatrix)).tx,u$o=u$d.ty;u$d.scale(1/u$Q,1/u$T),u$d._checkTransform(),u$c*=u$Q,u$R*=u$T,u$c+=u$K-u$d.tx,u$R+=u$o-u$d.ty}else u$Q=u$T=1;if(u$t)u$l._drawSlow(null,u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$Q,u$T,u$m);else{if(null===u$j.toUpperCase){var u$S=u$Q+1e5*u$T,u$M=u$j;return void(u$M.changed||u$M.id!==u$S?(u$M.id=u$S,u$M.changed=!1,u$l._drawSlow(u$M.save,u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$Q,u$T,u$m)):u$l._drawFast(u$M.save,u$W,u$d,u$c,u$R))}var u$Z=u$j+u$b.toString()+u$O+u$q+u$A+u$Q+u$T+u$E,u$X=u$l._textsCache[u$Z];u$y.CharacterCache?u$X?u$l._drawFast(u$X,u$W,u$d,u$c,u$R):(u$l._textsCache.__length||(u$l._textsCache.__length=0),u$l._textsCache.__length>u$N.WebGLTextCacheCount&&((u$l._textsCache={}).__length=0,u$l._curPoolIndex=0),u$l._textCachesPool[u$l._curPoolIndex]?(u$X=u$l._textsCache[u$Z]=u$l._textCachesPool[u$l._curPoolIndex]).length=0:u$l._textCachesPool[u$l._curPoolIndex]=u$X=u$l._textsCache[u$Z]=[],u$l._textsCache.__length++,u$l._curPoolIndex++,u$l._drawSlow(u$X,u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$Q,u$T,u$m)):u$l._drawSlow(u$X,u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$Q,u$T,u$m)}}},u$l._charsTemp=null,u$l._textCachesPool=[],u$l._curPoolIndex=0,u$l._charsCache={},u$l._textsCache={},u$l._drawValue=null,u$l.d=[],u$l._charSeg=null,u$l.__init$=function(){u$W=function(){function u$A(){}return u$Q(u$A,""),u$A.prototype.value=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this.font=u$W,this.fillColor=u$j,this.borderColor=u$t,this.lineWidth=u$d,this.scaleX=u$b,this.scaleY=u$E,this.underLine=u$O;var u$q=u$W.toString()+u$b+u$E+u$d+(u$j?u$j.toLowerCase():" ")+(u$t?u$t.toLowerCase():" ")+u$O;return this.txtID=u$A._keymap[u$q],this.txtID||(this.txtID=1e-7*++u$A._keymapCount,u$A._keymap[u$q]=this.txtID),this},u$A.clear=function(){u$A._keymap={},u$A._keymapCount=1},u$A._keymap={},u$A._keymapCount=1,u$A}()},u$l}(),u$$W=function(){function u$b(u$W){this._index=0,this._size=14,this._italic=-2,u$b._cache2=u$b._cache2||[],this.setFont(u$W||"14px Arial")}u$Q(u$b,"laya.webgl.text.FontInContext");var u$W=u$b.prototype;return u$W.setFont=function(u$W){var u$j=u$b._cache2[u$W];if(u$j)this._words=u$j[0],this._size=u$j[1];else{this._words=u$W.split(" ");for(var u$t=0,u$d=this._words.length;u$t<u$d;u$t++)if(0<this._words[u$t].indexOf("px")){this._index=u$t;break}this._size=parseInt(this._words[this._index]),u$b._cache2[u$W]=[this._words,this._size]}this._text=null,this._italic=-2},u$W.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},u$W.hasType=function(u$W){for(var u$j=0,u$t=this._words.length;u$j<u$t;u$j++)if(this._words[u$j]===u$W)return u$j;return-1},u$W.removeType=function(u$W){for(var u$j=0,u$t=this._words.length;u$j<u$t;u$j++)if(this._words[u$j]===u$W){this._words.splice(u$j,1),this._index>u$j&&this._index--;break}this._text=null,this._italic=-2},u$W.copyTo=function(u$W){return u$W._text=this._text,u$W._size=this._size,u$W._index=this._index,u$W._words=this._words.slice(),u$W._italic=-2,u$W},u$W.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},u$d(0,u$W,"size",function(){return this._size},function(u$W){this._size=u$W,this._words[this._index]=u$W+"px",this._text=null}),u$b.create=function(u$W){var u$j=u$b._cache[u$W];return u$j||(u$j=u$b._cache[u$W]=new u$b(u$W))},u$b.EMPTY=new u$b,u$b._cache={},u$b._cache2=null,u$b}(),u$eW=function(){function u$W(){}return u$Q(u$W,"laya.webgl.utils.CONST3D2D"),u$W.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u$W.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],u$W.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],u$W._TMPARRAY=[],u$W._OFFSETX=0,u$W._OFFSETY=0,u$O(u$W,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),u$W}(),u$KW=function(){function u$$(){}return u$Q(u$$,"laya.webgl.utils.GlUtils"),u$$.make2DProjection=function(u$W,u$j,u$t){return[2/u$W,0,0,0,0,-2/u$j,0,0,0,0,2/u$t,0,-1,1,0,1]},u$$.fillIBQuadrangle=function(u$W,u$j){if(65535/4<u$j)throw Error("IBQuadrangle count:"+u$j+" must<:"+Math.floor(65535/4));u$j=Math.floor(u$j),u$W._resizeBuffer(6*(u$j+1)*2,!1),u$W.byteLength=u$W.bufferLength;for(var u$t=u$W.getUint16Array(),u$d=0,u$b=0;u$b<u$j;u$b++)u$t[u$d++]=4*u$b,u$t[u$d++]=4*u$b+2,u$t[u$d++]=4*u$b+1,u$t[u$d++]=4*u$b,u$t[u$d++]=4*u$b+3,u$t[u$d++]=4*u$b+2;return u$W.setNeedUpload(),!0},u$$.expandIBQuadrangle=function(u$W,u$j){u$W.bufferLength>=6*u$j*2||u$$.fillIBQuadrangle(u$W,u$j)},u$$.mathCeilPowerOfTwo=function(u$W){return u$W--,u$W|=u$W>>1,u$W|=u$W>>2,u$W|=u$W>>4,u$W|=u$W>>8,u$W|=u$W>>16,++u$W},u$$.fillQuadrangleImgVb=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){var u$A=16+(u$W._byteLength>>2);u$W.byteLength=u$A<<2;var u$c=u$W.getFloat32Array();u$c[(u$A-=16)+2]=u$b[0],u$c[u$A+3]=u$b[1],u$c[u$A+6]=u$b[2],u$c[u$A+7]=u$b[3],u$c[u$A+10]=u$b[4],u$c[u$A+11]=u$b[5],u$c[u$A+14]=u$b[6],u$c[u$A+15]=u$b[7];var u$R=u$E.a,u$m=u$E.b,u$Q=u$E.c,u$T=u$E.d;if(1!==u$R||0!==u$m||0!==u$Q||1!==u$T){u$E.bTransform=!0;var u$$=u$E.tx+u$O,u$e=u$E.ty+u$q;u$c[u$A]=(u$d[0]+u$j)*u$R+(u$d[1]+u$t)*u$Q+u$$,u$c[u$A+1]=(u$d[0]+u$j)*u$m+(u$d[1]+u$t)*u$T+u$e,u$c[u$A+4]=(u$d[2]+u$j)*u$R+(u$d[3]+u$t)*u$Q+u$$,u$c[u$A+5]=(u$d[2]+u$j)*u$m+(u$d[3]+u$t)*u$T+u$e,u$c[u$A+8]=(u$d[4]+u$j)*u$R+(u$d[5]+u$t)*u$Q+u$$,u$c[u$A+9]=(u$d[4]+u$j)*u$m+(u$d[5]+u$t)*u$T+u$e,u$c[u$A+12]=(u$d[6]+u$j)*u$R+(u$d[7]+u$t)*u$Q+u$$,u$c[u$A+13]=(u$d[6]+u$j)*u$m+(u$d[7]+u$t)*u$T+u$e}else u$E.bTransform=!1,u$j+=u$E.tx+u$O,u$t+=u$E.ty+u$q,u$c[u$A]=u$j+u$d[0],u$c[u$A+1]=u$t+u$d[1],u$c[u$A+4]=u$j+u$d[2],u$c[u$A+5]=u$t+u$d[3],u$c[u$A+8]=u$j+u$d[4],u$c[u$A+9]=u$t+u$d[5],u$c[u$A+12]=u$j+u$d[6],u$c[u$A+13]=u$t+u$d[7];return u$W._upload=!0},u$$.fillTranglesVB=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){var u$q=(u$W._byteLength>>2)+u$d.length;u$W.byteLength=u$q<<2;var u$A=u$W.getFloat32Array();u$q-=u$d.length;for(var u$c=u$d.length,u$R=u$b.a,u$m=u$b.b,u$Q=u$b.c,u$T=u$b.d,u$$=0;u$$<u$c;u$$+=4)if(u$A[u$q+u$$+2]=u$d[u$$+2],u$A[u$q+u$$+3]=u$d[u$$+3],1!==u$R||0!==u$m||0!==u$Q||1!==u$T){u$b.bTransform=!0;var u$e=u$b.tx+u$E,u$K=u$b.ty+u$O;u$A[u$q+u$$]=(u$d[u$$]+u$j)*u$R+(u$d[u$$+1]+u$t)*u$Q+u$e,u$A[u$q+u$$+1]=(u$d[u$$]+u$j)*u$m+(u$d[u$$+1]+u$t)*u$T+u$K}else u$b.bTransform=!1,u$j+=u$b.tx+u$E,u$t+=u$b.ty+u$O,u$A[u$q+u$$]=u$j+u$d[u$$],u$A[u$q+u$$+1]=u$t+u$d[u$$+1];return u$W._upload=!0},u$$.copyPreImgVb=function(u$W,u$j,u$t){var u$d=u$W._byteLength>>2;u$W.byteLength=u$d+16<<2;for(var u$b=u$W.getFloat32Array(),u$E=0,u$O=u$d-16;u$E<4;u$E++)u$b[u$d]=u$b[u$O]+u$j,++u$O,u$b[++u$d]=u$b[u$O]+u$t,++u$O,u$b[++u$d]=u$b[u$O],++u$O,u$b[++u$d]=u$b[u$O],++u$d,++u$O;u$W._upload=!0},u$$.fillRectImgVb=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$m,u$Q){void 0===u$Q&&(u$Q=!1);var u$T,u$$,u$e,u$K,u$o,u$S,u$M,u$Z,u$X,u$_,u$N,u$z,u$C,u$L,u$V,u$x,u$G=1,u$l=u$q.a,u$h=u$q.b,u$v=u$q.c,u$y=u$q.d,u$a=u$j&&u$j.width<99999999;if(1!==u$l||0!==u$h||0!==u$v||1!==u$y?(u$q.bTransform=!0,0===u$h&&0===u$v&&(u$G=23,u$X=u$b+u$t,u$_=u$E+u$d,u$T=u$l*u$t+(u$N=u$q.tx+u$A),u$e=u$l*u$X+u$N,u$$=u$y*u$d+(u$z=u$q.ty+u$c),u$K=u$y*u$_+u$z)):(u$G=23,u$q.bTransform=!1,u$e=(u$T=u$t+u$q.tx+u$A)+u$b,u$K=(u$$=u$d+u$q.ty+u$c)+u$E),u$a&&(u$o=u$j.x,u$S=u$j.y,u$M=u$j.width+u$o,u$Z=u$j.height+u$S),1!==u$G){if(Math.min(u$T,u$e)>=u$M)return!1;if(Math.min(u$$,u$K)>=u$Z)return!1;if(Math.max(u$e,u$T)<=u$o)return!1;if(Math.max(u$K,u$$)<=u$S)return!1}var u$u=u$W._byteLength>>2;u$W.byteLength=16+u$u<<2;var u$D=u$W.getFloat32Array();switch(u$D[2+u$u]=u$O[0],u$D[3+u$u]=u$O[1],u$D[6+u$u]=u$O[2],u$D[7+u$u]=u$O[3],u$D[10+u$u]=u$O[4],u$D[11+u$u]=u$O[5],u$D[14+u$u]=u$O[6],u$D[15+u$u]=u$O[7],u$G){case 1:u$N=u$q.tx+u$A,u$z=u$q.ty+u$c;var u$s=u$l*u$t,u$Y=u$v*u$d,u$H=u$y*u$d,u$I=u$h*u$t,u$g=u$l*(u$X=u$b+u$t),u$f=u$v*(u$_=u$E+u$d),u$w=u$y*u$_,u$U=u$h*u$X;u$Q?(u$C=u$s+u$Y+u$N,u$V=Math.round(u$C)-u$C,u$L=u$H+u$I+u$z,u$x=Math.round(u$L)-u$L,u$D[u$u]=u$C+u$V,u$D[1+u$u]=u$L+u$x,u$D[4+u$u]=u$g+u$Y+u$N+u$V,u$D[5+u$u]=u$H+u$U+u$z+u$x,u$D[8+u$u]=u$g+u$f+u$N+u$V,u$D[9+u$u]=u$w+u$U+u$z+u$x,u$D[12+u$u]=u$s+u$f+u$N+u$V,u$D[13+u$u]=u$w+u$I+u$z+u$x):(u$D[u$u]=u$s+u$Y+u$N,u$D[1+u$u]=u$H+u$I+u$z,u$D[4+u$u]=u$g+u$Y+u$N,u$D[5+u$u]=u$H+u$U+u$z,u$D[8+u$u]=u$g+u$f+u$N,u$D[9+u$u]=u$w+u$U+u$z,u$D[12+u$u]=u$s+u$f+u$N,u$D[13+u$u]=u$w+u$I+u$z);break;case 23:u$Q?(u$C=u$T+u$R,u$V=Math.round(u$C)-u$C,u$L=u$$,u$x=Math.round(u$L)-u$L,u$D[u$u]=u$C+u$V,u$D[1+u$u]=u$L+u$x,u$D[4+u$u]=u$e+u$R+u$V,u$D[5+u$u]=u$$+u$x,u$D[8+u$u]=u$e+u$V,u$D[9+u$u]=u$K+u$x,u$D[12+u$u]=u$T+u$V,u$D[13+u$u]=u$K+u$x):(u$D[u$u]=u$T+u$R,u$D[1+u$u]=u$$,u$D[4+u$u]=u$e+u$R,u$D[5+u$u]=u$$,u$D[8+u$u]=u$e,u$D[9+u$u]=u$K,u$D[12+u$u]=u$T,u$D[13+u$u]=u$K)}return u$W._upload=!0},u$$.fillLineVb=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){var u$A=.5*u$O,u$c=u$$._fillLineArray,u$R=-(u$d-u$E),u$m=u$t-u$b,u$Q=Math.sqrt(u$R*u$R+u$m*u$m);u$R/=u$Q,u$m/=u$Q,u$R*=u$A,u$m*=u$A,u$c[0]=u$t-u$R,u$c[1]=u$d-u$m,u$c[4]=u$t+u$R,u$c[5]=u$d+u$m,u$c[8]=u$b+u$R,u$c[9]=u$E+u$m,u$c[12]=u$b-u$R,u$c[13]=u$E-u$m,u$q&&u$q.transformPointArray(u$c,u$c);var u$T=16+(u$W._byteLength>>2);return u$W.byteLength=u$T<<2,u$W.insertData(u$c,u$T-16),!0},u$$._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],u$$}(),u$oW=(function(){function u$A(){}u$Q(u$A,"laya.webgl.utils.MatirxArray"),u$A.ArrayMul=function(u$W,u$j,u$t){if(u$W)if(u$j)for(var u$d=NaN,u$b=NaN,u$E=NaN,u$O=NaN,u$q=0;u$q<4;u$q++)u$d=u$W[u$q],u$b=u$W[u$q+4],u$E=u$W[u$q+8],u$O=u$W[u$q+12],u$t[u$q]=u$d*u$j[0]+u$b*u$j[1]+u$E*u$j[2]+u$O*u$j[3],u$t[u$q+4]=u$d*u$j[4]+u$b*u$j[5]+u$E*u$j[6]+u$O*u$j[7],u$t[u$q+8]=u$d*u$j[8]+u$b*u$j[9]+u$E*u$j[10]+u$O*u$j[11],u$t[u$q+12]=u$d*u$j[12]+u$b*u$j[13]+u$E*u$j[14]+u$O*u$j[15];else u$A.copyArray(u$W,u$t);else u$A.copyArray(u$j,u$t)},u$A.copyArray=function(u$W,u$j){if(u$W&&u$j)for(var u$t=0;u$t<u$W.length;u$t++)u$j[u$t]=u$W[u$t]}}(),function(){function u$j(u$W,u$j,u$t){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=u$W,this._vb=new u$FW(u$W,35048),u$j&&this._vb._resizeBuffer(u$j,!1),this._ib=new u$pW,u$t&&this._ib._resizeBuffer(u$t,!1)}u$Q(u$j,"laya.webgl.utils.Mesh2D");var u$W=u$j.prototype;return u$W.cloneWithNewVB=function(){var u$W=new u$j(this._stride,0,0);return u$W._ib=this._ib,u$W._quadNum=this._quadNum,u$W._attribInfo=this._attribInfo,u$W},u$W.cloneWithNewVBIB=function(){var u$W=new u$j(this._stride,0,0);return u$W._attribInfo=this._attribInfo,u$W},u$W.getVBW=function(){return this._vb.setNeedUpload(),this._vb},u$W.getVBR=function(){return this._vb},u$W.getIBR=function(){return this._ib},u$W.getIBW=function(){return this._ib.setNeedUpload(),this._ib},u$W.createQuadIB=function(u$W){this._quadNum=u$W,this._ib._resizeBuffer(6*u$W*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var u$j=this._ib.getUint16Array(),u$t=0,u$d=0,u$b=0;u$b<u$W;u$b++)u$j[u$t++]=u$d,u$j[u$t++]=u$d+2,u$j[u$t++]=u$d+1,u$j[u$t++]=u$d,u$j[u$t++]=u$d+3,u$j[u$t++]=u$d+2,u$d+=4;this._ib.setNeedUpload()},u$W.setAttributes=function(u$W){if(this._attribInfo=u$W,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},u$W.getEleNum=function(){return this._ib.getBuffer().byteLength/2},u$W.releaseMesh=function(){},u$W.destroy=function(){},u$W.clearVB=function(){this._vb.clear()},u$j._gvaoid=0,u$j}()),u$SW=function(){function u$b(){}return u$Q(u$b,"laya.webgl.utils.RenderState2D"),u$b.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},u$b.mat2MatArray=function(u$W,u$j){var u$t=u$W,u$d=u$j;return u$d[0]=u$t.a,u$d[1]=u$t.b,u$d[2]=u$b.EMPTYMAT4_ARRAY[2],u$d[3]=u$b.EMPTYMAT4_ARRAY[3],u$d[4]=u$t.c,u$d[5]=u$t.d,u$d[6]=u$b.EMPTYMAT4_ARRAY[6],u$d[7]=u$b.EMPTYMAT4_ARRAY[7],u$d[8]=u$b.EMPTYMAT4_ARRAY[8],u$d[9]=u$b.EMPTYMAT4_ARRAY[9],u$d[10]=u$b.EMPTYMAT4_ARRAY[10],u$d[11]=u$b.EMPTYMAT4_ARRAY[11],u$d[12]=u$t.tx,u$d[13]=u$t.ty,u$d[14]=u$b.EMPTYMAT4_ARRAY[14],u$d[15]=u$b.EMPTYMAT4_ARRAY[15],u$j},u$b.restoreTempArray=function(){u$b.TEMPMAT4_ARRAY[0]=1,u$b.TEMPMAT4_ARRAY[1]=0,u$b.TEMPMAT4_ARRAY[4]=0,u$b.TEMPMAT4_ARRAY[5]=1,u$b.TEMPMAT4_ARRAY[12]=0,u$b.TEMPMAT4_ARRAY[13]=0},u$b.clear=function(){u$b.worldScissorTest=!1,u$b.worldShaderDefines=null,u$b.worldFilters=null,u$b.worldAlpha=1,u$b.worldClipRect.x=u$b.worldClipRect.y=0,u$b.worldClipRect.width=u$b.width,u$b.worldClipRect.height=u$b.height,u$b.curRenderTarget=null},u$b._MAXSIZE=99999999,u$b.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u$b.worldMatrix4=u$b.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u$b.worldAlpha=1,u$b.worldScissorTest=!1,u$b.worldFilters=null,u$b.worldShaderDefines=null,u$b.curRenderTarget=null,u$b.width=0,u$b.height=0,u$O(u$b,["worldMatrix",function(){return this.worldMatrix=new u$C},"worldClipRect",function(){return this.worldClipRect=new u$V(0,0,99999999,99999999)}]),u$b}(),u$MW=function(){var u$S,u$t;function u$M(u$W,u$j,u$t,u$d,u$b){var u$E=this;function u$O(u$W){var u$j=[],u$t=new u$S(u$j);return u$E._compileToTree(u$t,u$W.split("\n"),0,u$j,u$b),u$t}var u$q=u$T.now();this._VS=u$O(u$j),this._PS=u$O(u$t),this._nameMap=u$d,2<u$T.now()-u$q&&console.log("ShaderCompile use time:"+(u$T.now()-u$q)+"  size:"+u$j.length+"/"+u$t.length)}u$Q(u$M,"laya.webgl.utils.ShaderCompile");var u$W=u$M.prototype;return u$W._compileToTree=function(u$W,u$j,u$t,u$d,u$b){var u$E,u$O,u$q,u$A,u$c,u$R,u$m,u$Q=0,u$T=0,u$$=0,u$e=0;for(u$T=u$t;u$T<u$j.length;u$T++)if(!((u$q=u$j[u$T]).length<1)&&0!==(u$Q=u$q.indexOf("//"))){if(0<=u$Q&&(u$q=u$q.substr(0,u$Q)),u$E=u$m||new u$S(u$d),u$m=null,u$E.text=u$q,u$E.noCompile=!0,0<=(u$Q=u$q.indexOf("#"))){for(u$A="#",u$e=u$Q+1,u$$=u$q.length;u$e<u$$;u$e++){var u$K=u$q.charAt(u$e);if(" "===u$K||"\t"===u$K||"\r"===u$K||"\n"===u$K||"?"===u$K)break;u$A+=u$K}switch(u$E.name=u$A){case"#ifdef":case"#ifndef":if(u$E.src=u$q,u$E.noCompile=null!=u$q.match(/[!&|()=<>]/),u$E.noCompile?console.log("function():Boolean{return "+u$q.substr(u$Q+u$E.name.length)+"}"):(u$R=u$q.replace(/^\s*/,"").split(/\s+/),u$E.setCondition(u$R[1],"#ifdef"===u$A?1:2),u$E.text="//"+u$E.text),u$E.setParent(u$W),u$W=u$E,u$b)for(u$R=u$q.substr(u$e).split(u$M._splitToWordExps3),u$e=0;u$e<u$R.length;u$e++)(u$q=u$R[u$e]).length&&(u$b[u$q]=!0);continue;case"#if":if(u$E.src=u$q,u$E.noCompile=!0,u$E.setParent(u$W),u$W=u$E,u$b)for(u$R=u$q.substr(u$e).split(u$M._splitToWordExps3),u$e=0;u$e<u$R.length;u$e++)(u$q=u$R[u$e]).length&&"defined"!=u$q&&(u$b[u$q]=!0);continue;case"#else":u$E.src=u$q,u$O=(u$W=u$W.parent).childs[u$W.childs.length-1],u$E.noCompile=u$O.noCompile,u$E.noCompile||(u$E.condition=u$O.condition,u$E.conditionType=1==u$O.conditionType?2:1,u$E.text="//"+u$E.text+" "+u$O.text+" "+u$E.conditionType),u$E.setParent(u$W),u$W=u$E;continue;case"#endif":u$O=(u$W=u$W.parent).childs[u$W.childs.length-1],u$E.noCompile=u$O.noCompile,u$E.noCompile||(u$E.text="//"+u$E.text),u$E.setParent(u$W);continue;case"#include":u$R=u$M.splitToWords(u$q,null);var u$o=u$M.includes[u$R[1]];if(!u$o)throw"ShaderCompile error no this include file:"+u$R[1];if((u$Q=u$R[0].indexOf("?"))<0){u$E.setParent(u$W),u$q=u$o.getWith("with"==u$R[2]?u$R[3]:null),this._compileToTree(u$E,u$q.split("\n"),0,u$d,u$b),u$E.text="";continue}u$E.setCondition(u$R[0].substr(u$Q+1),1),u$E.text=u$o.getWith("with"==u$R[2]?u$R[3]:null);break;case"#import":u$c=(u$R=u$M.splitToWords(u$q,null))[1],u$d.push({node:u$E,file:u$M.includes[u$c],ofs:u$E.text.length});continue}}else{if((u$O=u$W.childs[u$W.childs.length-1])&&!u$O.name){0<u$d.length&&u$M.splitToWords(u$q,u$O),u$m=u$E,u$O.text+="\n"+u$q;continue}0<u$d.length&&u$M.splitToWords(u$q,u$E)}u$E.setParent(u$W)}},u$W.createShader=function(u$W,u$j,u$t){var u$d={},u$b="";if(u$W)for(var u$E in u$W)u$b+="#define "+u$E+"\n",u$d[u$E]=!0;var u$O=this._VS.toscript(u$d,[]),u$q=this._PS.toscript(u$d,[]);return(u$t||u$iW.create)(u$b+u$O.join("\n"),u$b+u$q.join("\n"),u$j,this._nameMap)},u$M._parseOne=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O={type:u$M.shaderParamsMap[u$t[u$d+1]],name:u$t[u$d+2],size:isNaN(parseInt(u$t[u$d+3]))?1:parseInt(u$t[u$d+3])};return u$E&&("attribute"==u$b?u$W.push(u$O):u$j.push(u$O)),":"==u$t[u$d+3]&&(u$O.type=u$t[u$d+4],u$d+=2),u$d+=2},u$M.addInclude=function(u$W,u$j){if(!u$j||0===u$j.length)throw new Error("add shader include file err:"+u$W);if(u$M.includes[u$W])throw new Error("add shader include file err, has add:"+u$W);u$M.includes[u$W]=new u$t(u$j)},u$M.preGetParams=function(u$W,u$j){var u$t=[u$W,u$j],u$d={},u$b=[],u$E=[],u$O={},u$q=[];u$d.attributes=u$b,u$d.uniforms=u$E,u$d.defines=u$O;for(var u$A=0,u$c=0,u$R=0;u$R<2;u$R++){u$t[u$R]=u$t[u$R].replace(u$M._removeAnnotation,"");var u$m,u$Q=u$t[u$R].match(u$M._reg);for(u$A=0,u$c=u$Q.length;u$A<u$c;u$A++){var u$T=u$Q[u$A];if("attribute"==u$T||"uniform"==u$T)u$A=u$M._parseOne(u$b,u$E,u$Q,u$A,u$T,!0);else{if("#define"==u$T){u$q[u$T=u$Q[++u$A]]=1;continue}if("#ifdef"==u$T){u$O[u$m=u$Q[++u$A]]=u$O[u$m]||[];for(u$A++;u$A<u$c;u$A++)if("attribute"==(u$T=u$Q[u$A])||"uniform"==u$T)u$A=u$M._parseOne(u$b,u$E,u$Q,u$A,u$T,u$q[u$m]);else if("#else"==u$T)for(u$A++;u$A<u$c;u$A++)if("attribute"==(u$T=u$Q[u$A])||"uniform"==u$T)u$A=u$M._parseOne(u$b,u$E,u$Q,u$A,u$T,!u$q[u$m]);else if("#endif"==u$T)break}}}}return u$d},u$M.splitToWords=function(u$W,u$j){for(var u$t,u$d,u$b=[],u$E=-1,u$O=0,u$q=u$W.length;u$O<u$q;u$O++)if(u$t=u$W.charAt(u$O),0<=" \t=+-*/&%!<>()'\",;".indexOf(u$t)){if(0<=u$E&&1<u$O-u$E&&(u$d=u$W.substr(u$E,u$O-u$E),u$b.push(u$d)),'"'==u$t||"'"==u$t){var u$A=u$W.indexOf(u$t,u$O+1);if(u$A<0)throw"Sharder err:"+u$W;u$b.push(u$W.substr(u$O+1,u$A-u$O-1)),u$O=u$A,u$E=-1;continue}"("==u$t&&u$j&&0<u$b.length&&(u$d=u$b[u$b.length-1]+";","vec4;main;".indexOf(u$d)<0&&(u$j.useFuns+=u$d)),u$E=-1}else u$E<0&&(u$E=u$O);return u$E<u$q&&1<u$q-u$E&&(u$d=u$W.substr(u$E,u$q-u$E),u$b.push(u$d)),u$b},u$M.IFDEF_NO=0,u$M.IFDEF_YES=1,u$M.IFDEF_ELSE=2,u$M.IFDEF_PARENT=3,u$M._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),u$M._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),u$M._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),u$M.includes={},u$O(u$M,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),u$M.__init$=function(){u$S=function(){function u$t(u$W){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=u$W}u$Q(u$t,"");var u$W=u$t.prototype;return u$W.setParent=function(u$W){u$W.childs.push(this),this.z=u$W.z+1,this.parent=u$W},u$W.setCondition=function(u$W,u$j){u$W&&(this.conditionType=u$j,u$W=u$W.replace(/(\s*$)/g,""),this.condition=function(){return this[u$W]},this.condition.__condition=u$W)},u$W.toscript=function(u$W,u$j){return this._toscript(u$W,u$j,++u$t.__id)},u$W._toscript=function(u$d,u$b,u$E){if(this.childs.length<1&&!this.text)return u$b;u$b.length;if(this.condition){var u$W=!!this.condition.call(u$d);if(2===this.conditionType&&(u$W=!u$W),!u$W)return u$b}if(this.text&&u$b.push(this.text),0<this.childs.length&&this.childs.forEach(function(u$W,u$j,u$t){u$W._toscript(u$d,u$b,u$E)}),0<this.includefiles.length&&0<this.useFuns.length)for(var u$j,u$t=0,u$O=this.includefiles.length;u$t<u$O;u$t++)this.includefiles[u$t].curUseID!=u$E&&0<(u$j=this.includefiles[u$t].file.getFunsScript(this.useFuns)).length&&(this.includefiles[u$t].curUseID=u$E,u$b[0]=u$j+u$b[0]);return u$b},u$t.__id=1,u$t}(),u$t=function(){function u$W(u$W){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=u$W;for(var u$j=0,u$t=0,u$d=0;!((u$j=u$W.indexOf("#begin",u$j))<0);){for(u$d=u$j+5;!((u$d=u$W.indexOf("#end",u$d))<0)&&"i"===u$W.charAt(u$d+4);)u$d+=5;if(u$d<0)throw"add include err,no #end:"+u$W;u$t=u$W.indexOf("\n",u$j);var u$b=u$M.splitToWords(u$W.substr(u$j,u$t-u$j),null);"code"==u$b[1]?this.codes[u$b[2]]=u$W.substr(u$t+1,u$d-u$t-1):"function"==u$b[1]&&(u$t=u$W.indexOf("function",u$j),u$t+="function".length,this.funs[u$b[3]]=u$W.substr(u$t+1,u$d-u$t-1),this.funnames+=u$b[3]+";"),u$j=u$d+1}}u$Q(u$W,"");var u$j=u$W.prototype;return u$j.getWith=function(u$W){var u$j=u$W?this.codes[u$W]:this.script;if(!u$j)throw"get with error:"+u$W;return u$j},u$j.getFunsScript=function(u$W){var u$j="";for(var u$t in this.funs)0<=u$W.indexOf(u$t+";")&&(u$j+=this.funs[u$t]);return u$j},u$W}()},u$M}(),u$ZW=function(){function u$O(){}return u$Q(u$O,"laya.webgl.WebGL"),u$O._uint8ArraySlice=function(){for(var u$W=this.length,u$j=new Uint8Array(this.length),u$t=0;u$t<u$W;u$t++)u$j[u$t]=this[u$t];return u$j},u$O._float32ArraySlice=function(){for(var u$W=this.length,u$j=new Float32Array(this.length),u$t=0;u$t<u$W;u$t++)u$j[u$t]=this[u$t];return u$j},u$O._uint16ArraySlice=function(u$W){var u$j,u$t=arguments,u$d=0,u$b=0;if(0===u$t.length)for(u$d=this.length,u$j=new Uint16Array(u$d),u$b=0;u$b<u$d;u$b++)u$j[u$b]=this[u$b];else if(2===u$t.length){var u$E=u$t[0],u$O=u$t[1];if(u$E<u$O)for(u$d=u$O-u$E,u$j=new Uint16Array(u$d),u$b=u$E;u$b<u$O;u$b++)u$j[u$b-u$E]=this[u$b];else u$j=new Uint16Array(0)}return u$j},u$O.expandContext=function(){var u$W=u$b.prototype,u$j=CanvasRenderingContext2D.prototype;u$j.fillTrangles=u$W.fillTrangles,u$BW.__int__(null),u$j.setIBVB=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){void 0===u$A&&(u$A=0),void 0===u$c&&(u$c=0),null===u$t&&(this._ib=this._ib||u$pW.QuadrangleIB,u$t=this._ib,u$KW.expandIBQuadrangle(u$t,u$d._byteLength/64+8)),this._setIBVB(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c)},u$j.fillTrangles=function(u$W,u$j,u$t,u$d,u$b){this._curMat=this._curMat||u$C.create(),this._vb=this._vb||u$FW.create(),this._ib||(this._ib=u$pW.create(),u$KW.fillIBQuadrangle(this._ib,u$O/4));var u$E=this._vb,u$O=u$d.length>>4;u$KW.fillTranglesVB(u$E,u$j,u$t,u$d,u$b||this._curMat,0,0),u$KW.expandIBQuadrangle(this._ib,u$E._byteLength/64+8);var u$q=new u$zW(1,0);u$q.textureHost=u$W;var u$A=new u$kW("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");u$E._vertType=3,this._setIBVB(u$j,u$t,this._ib,u$E,6*u$O,u$b,u$A,u$q,0,0)}},u$O.enable=function(){if(u$T.__init__(),u$o.isConchApp&&!u$o.isConchWebGL)return u$X.skinAniSprite=function(){return new u$WW},u$O.expandContext(),!1;if(u$X.getWebGLContext=function(u$W){for(var u$j,u$t=["webgl","experimental-webgl","webkit-3d","moz-webgl"],u$d=0;u$d<u$t.length;u$d++){try{u$j=u$W.getContext(u$t[u$d],{stencil:u$N.isStencil,alpha:u$N.isAlpha,antialias:u$N.isAntialias,premultipliedAlpha:u$N.premultipliedAlpha,preserveDrawingBuffer:u$N.preserveDrawingBuffer})}catch(u$W){}if(u$j)return u$j}return null},null==(u$O.mainContext=u$X.getWebGLContext(u$o._mainCanvas)))return!1;if(u$o.isWebGL)return!0;u$e.create=function(u$W,u$j){return new u$Wj(u$W,u$j)},u$K.create=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){return new u$PW(u$W,u$j,u$t,u$d,u$b,u$E,u$O)},u$o.WebGL=u$O,u$o.isWebGL=!0,u$TW.__init__(),u$X.createRenderSprite=function(u$W,u$j){return new u$CW(u$W,u$j)},u$X.createWebGLContext2D=function(u$W){return new u$NW(u$W)},u$X.changeWebGLSize=function(u$W,u$j){laya.webgl.WebGL.onStageResize(u$W,u$j)},u$X.createGraphics=function(){return new u$_W};var u$W=u$X.createFilterAction;return u$X.createFilterAction=u$W||function(u$W){return new u$LW},u$X.clear=function(u$W){u$SW.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var u$j=u$o.context.ctx,u$t=0==u$j._submits._length||u$N.preserveDrawingBuffer?u$$.create(u$W)._color:u$G._wgColor;u$t&&u$j.clearBG(u$t[0],u$t[1],u$t[2],u$t[3]),u$SW.clear()},u$X.addToAtlas=function(u$W,u$j){void 0===u$j&&(u$j=!1);var u$t=u$W.bitmap;u$o.optimizeTextureMemory(u$W.url,u$W)?u$_.__typeof(u$t,"laya.webgl.resource.IMergeAtlasBitmap")&&u$t.allowMerageInAtlas&&u$t.on("recovered",u$W,u$W.addTextureToAtlas):u$t.enableMerageInAtlas=!1},u$X.isAtlas=function(u$W){return u$W instanceof laya.webgl.atlas.AtlasWebGLCanvas},u$I._enable(),u$X.beginFlush=function(){for(var u$W=u$I.instance,u$j=u$W.getAtlaserCount(),u$t=0;u$t<u$j;u$t++){var u$d=u$W.getAtlaserByIndex(u$t).texture;u$d._flashCacheImageNeedFlush&&u$X.flashFlushImage(u$d)}},u$X.drawToCanvas=function(u$W,u$j,u$t,u$d,u$b,u$E){(u$t<=0||u$d<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),u$t|=0,u$d|=0,u$b|=0,u$E|=0;var u$O=u$DW.create(u$t,u$d,6408,5121,0,!1);u$O.start(),u$O.clear(0,0,0,0),u$o.context.clear(),u$S.renders[u$j]._fun(u$W,u$o.context,u$b,u$SW.height-u$d+u$E),u$o.context.flush(),u$O.end();var u$q=u$O.getData(0,0,u$t,u$d);if(u$O.recycle(),u$q.byteLength==u$t*u$d*4){var u$A=new u$UW;u$A._canvas=u$T.createElement("canvas"),u$A.size(u$t,u$d);var u$c=u$A._canvas.getContext("2d");u$T.canvas.size(u$t,u$d);var u$R=u$T.context,u$m=u$R.createImageData(u$t,u$d);return u$m.data.set(new Uint8ClampedArray(u$q.buffer)),u$A._imgData=u$m,u$R.putImageData(u$m,0,0),u$c.save(),u$c.translate(0,u$d),u$c.scale(1,-1),u$c.drawImage(u$T.canvas.source,0,0),u$c.restore(),u$A}console.log("drawToCanvas error: w:"+u$t+",h:"+u$d+",datalen:"+u$q.byteLength)},u$X.createFilterAction=function(u$W){var u$j;switch(u$W){case 32:u$j=new u$LW}return u$j},u$X.addTextureToAtlas=function(u$W){u$W._uvID++,u$I._atlasRestore++,u$W.bitmap.enableMerageInAtlas&&u$I.instance.addToAtlas(u$W)},u$X.getTexturePixels=function(u$W,u$j,u$t,u$d,u$b){u$o.context.ctx.clear();var u$E=new u$x;u$E.graphics.drawTexture(u$W,-u$j,-u$t);var u$O=u$DW.create(u$d,u$b);u$O.start(),u$O.clear(0,0,0,0),u$E.render(u$o.context,0,0),u$o.context.ctx.flush(),u$O.end();for(var u$q=u$O.getData(0,0,u$d,u$b),u$A=[],u$c=0,u$R=u$b-1;0<=u$R;u$R--)for(var u$m=0;u$m<u$d;u$m++)u$c=4*(u$R*u$d+u$m),u$A.push(u$q[u$c]),u$A.push(u$q[u$c+1]),u$A.push(u$q[u$c+2]),u$A.push(u$q[u$c+3]);return u$A},u$X.skinAniSprite=function(){return new u$WW},u$c.create=function(u$W,u$j){var u$t=new u$UW;return u$t._imgData=u$j,u$t.flipY=!1,u$t},u$z._filterStart=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$W.getValue("bounds"),u$O=u$DW.create(u$E.width,u$E.height);if(u$O.start(),u$O.clear(0,0,0,0),u$W.addValue("src",u$O),u$W.addValue("ScissorTest",u$SW.worldScissorTest),u$SW.worldScissorTest){var u$q=new u$V;u$q.copyFrom(u$t.ctx._clipRect),u$W.addValue("clipRect",u$q),u$SW.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},u$z._filterEnd=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$W.getValue("bounds");u$W.getValue("src").end();var u$O=u$DW.create(u$E.width,u$E.height);u$O.start(),u$O.clear(0,0,0,0),u$W.addValue("out",u$O),u$j._set$P("_filterCache",u$O),u$j._set$P("_isHaveGlowFilter",u$W.getValue("_isHaveGlowFilter"))},u$z._EndTarget=function(u$W,u$j){if(u$W.getValue("src").recycle(),u$W.getValue("out").end(),u$W.getValue("ScissorTest")){u$SW.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),u$j.ctx.save();var u$t=u$W.getValue("clipRect");u$j.ctx.clipRect(u$t.x,u$t.y,u$t.width,u$t.height)}},u$z._useSrc=function(u$W){var u$j=u$W.getValue("out");u$j.end(),(u$j=u$W.getValue("src")).start(),u$j.clear(0,0,0,0)},u$z._endSrc=function(u$W){u$W.getValue("src").end()},u$z._useOut=function(u$W){var u$j=u$W.getValue("src");u$j.end(),(u$j=u$W.getValue("out")).start(),u$j.clear(0,0,0,0)},u$z._endOut=function(u$W){u$W.getValue("out").end()},u$z._recycleScope=function(u$W){u$W.recycle()},u$z._filter=function(u$W,u$j,u$t,u$d){var u$b=this._next;if(u$b){var u$E,u$O,u$q=u$W.filters,u$A=u$q.length;if(1==u$A&&32==u$q[0].type)return u$j.ctx.save(),u$j.ctx.setFilters([u$q[0]]),u$b._fun.call(u$b,u$W,u$j,u$t,u$d),void u$j.ctx.restore();var u$c=u$qW.create(),u$R=u$L.TEMP,u$m=u$j.ctx._getTransformMatrix(),u$Q=u$C.create();u$m.copyTo(u$Q);var u$T=0,u$$=0,u$e=!1,u$K=u$W._$P._filterCache?u$W._$P._filterCache:null;if(!u$K||u$W._repaint){u$e=u$W._isHaveGlowFilter(),u$c.addValue("_isHaveGlowFilter",u$e),u$e&&(u$T=50,u$$=25),(u$O=new u$V).copyFrom(u$W.getSelfBounds()),u$O.x+=u$W.x,u$O.y+=u$W.y,u$O.x-=u$W.pivotX+4,u$O.y-=u$W.pivotY+4;var u$o=u$O.x,u$S=u$O.y;if(u$O.width+=u$T+8,u$O.height+=u$T+8,u$R.x=u$O.x*u$Q.a+u$O.y*u$Q.c,u$R.y=u$O.y*u$Q.d+u$O.x*u$Q.b,u$O.x=u$R.x,u$O.y=u$R.y,u$R.x=u$O.width*u$Q.a+u$O.height*u$Q.c,u$R.y=u$O.height*u$Q.d+u$O.width*u$Q.b,u$O.width=u$R.x,u$O.height=u$R.y,u$O.width<=0||u$O.height<=0)return;u$K&&u$K.recycle(),u$c.addValue("bounds",u$O);var u$M=u$OW.create([u$c,u$W,u$j,0,0],u$z._filterStart);u$j.addRenderObject(u$M),u$j.ctx._renderKey=0,u$j.ctx._shader2D.glTexture=null;var u$Z=u$W.x-u$o+u$$,u$X=u$W.y-u$S+u$$;u$b._fun.call(u$b,u$W,u$j,u$Z,u$X),u$M=u$OW.create([u$c,u$W,u$j,0,0],u$z._filterEnd),u$j.addRenderObject(u$M);for(var u$_=0;u$_<u$A;u$_++){0!=u$_&&(u$M=u$OW.create([u$c],u$z._useSrc),u$j.addRenderObject(u$M),u$E=u$zW.create(1,0),u$C.TEMP.identity(),u$j.ctx.drawTarget(u$c,0,0,u$O.width,u$O.height,u$C.TEMP,"out",u$E,null,u$f.TOINT.overlay),u$M=u$OW.create([u$c],u$z._useOut),u$j.addRenderObject(u$M)),u$q[u$_].action.apply3d(u$c,u$W,u$j,0,0)}u$M=u$OW.create([u$c,u$j],u$z._EndTarget),u$j.addRenderObject(u$M)}else{if((u$e=!!u$W._$P._isHaveGlowFilter&&u$W._$P._isHaveGlowFilter)&&(u$T=50,u$$=25),(u$O=u$W.getBounds()).width<=0||u$O.height<=0)return;u$O.width+=u$T,u$O.height+=u$T,u$R.x=u$O.x*u$Q.a+u$O.y*u$Q.c,u$R.y=u$O.y*u$Q.d+u$O.x*u$Q.b,u$O.x=u$R.x,u$O.y=u$R.y,u$R.x=u$O.width*u$Q.a+u$O.height*u$Q.c,u$R.y=u$O.height*u$Q.d+u$O.width*u$Q.b,u$O.width=u$R.x,u$O.height=u$R.y,u$c.addValue("out",u$K)}u$t=u$t-u$$-u$W.x,u$d=u$d-u$$-u$W.y,u$R.setTo(u$t,u$d),u$Q.transformPoint(u$R),u$t=u$R.x+u$O.x,u$d=u$R.y+u$O.y,u$E=u$zW.create(1,0),u$C.TEMP.identity(),u$j.ctx.drawTarget(u$c,u$t,u$d,u$O.width,u$O.height,u$C.TEMP,"out",u$E,null,u$f.TOINT.overlay),u$M=u$OW.create([u$c],u$z._recycleScope),u$j.addRenderObject(u$M),u$Q.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=u$O._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=u$O._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=u$O._uint8ArraySlice),!0},u$O.onStageResize=function(u$W,u$j){null!=u$O.mainContext&&(u$O.mainContext.viewport(0,0,u$W,u$j),u$SW.width=u$W,u$SW.height=u$j)},u$O.onInvalidGLRes=function(){u$I.instance.freeAll(),u$Z.releaseContentManagers(!0),u$O.doNodeRepaint(u$_.stage),u$O.mainContext.viewport(0,0,u$SW.width,u$SW.height),u$_.stage.event("devicelost")},u$O.doNodeRepaint=function(u$W){0==u$W.numChildren&&u$W.repaint();for(var u$j=0;u$j<u$W.numChildren;u$j++)u$O.doNodeRepaint(u$W.getChildAt(u$j))},u$O.init=function(u$W,u$j,u$t){u$O.mainCanvas=u$W,u$c._createContext=function(u$W){return new u$NW(u$W)},u$UW._createContext=function(u$W){return new u$NW(u$W)};var u$d=laya.webgl.WebGL.mainContext;if(null!=u$d.getShaderPrecisionFormat){var u$b=u$d.getShaderPrecisionFormat(35633,36338),u$E=u$d.getShaderPrecisionFormat(35632,36338);u$O.shaderHighPrecision=!(!u$b.precision||!u$E.precision)}else u$O.shaderHighPrecision=!1;if(u$d.deleteTexture1=u$d.deleteTexture,u$d.deleteTexture=function(u$W){u$W==u$XW.curBindTexValue&&(u$XW.curBindTexValue=null),u$d.deleteTexture1(u$W)},u$O.onStageResize(u$j,u$t),null==u$O.mainContext)throw new Error("webGL getContext err!");u$v.__init__(),u$I.__init__(),u$xW.__init__(),u$EW.__init__(),u$NW.__init__(),u$zW.__init__(),u$p.__init__(),u$BW.__int__(u$d),u$f._init_(u$d),u$o.isConchApp&&conch.setOnInvalidGLRes(u$O.onInvalidGLRes)},u$O.mainCanvas=null,u$O.mainContext=null,u$O.antialias=!0,u$O.shaderHighPrecision=!1,u$O._bg_null=[0,0,0,0],u$O}(),u$XW=function(){function u$d(){}return u$Q(u$d,"laya.webgl.WebGLContext"),u$d.UseProgram=function(u$W){return u$d._useProgram!==u$W&&(u$ZW.mainContext.useProgram(u$W),u$d._useProgram=u$W,!0)},u$d.setDepthTest=function(u$W,u$j){u$j!==u$d._depthTest&&((u$d._depthTest=u$j)?u$W.enable(2929):u$W.disable(2929))},u$d.setDepthMask=function(u$W,u$j){u$j!==u$d._depthMask&&(u$d._depthMask=u$j,u$W.depthMask(u$j))},u$d.setDepthFunc=function(u$W,u$j){u$j!==u$d._depthFunc&&(u$d._depthFunc=u$j,u$W.depthFunc(u$j))},u$d.setBlend=function(u$W,u$j){u$j!==u$d._blend&&((u$d._blend=u$j)?u$W.enable(3042):u$W.disable(3042))},u$d.setBlendFunc=function(u$W,u$j,u$t){(u$j!==u$d._sFactor||u$t!==u$d._dFactor)&&(u$d._sFactor=u$j,u$d._dFactor=u$t,u$W.blendFunc(u$j,u$t))},u$d.setCullFace=function(u$W,u$j){u$j!==u$d._cullFace&&((u$d._cullFace=u$j)?u$W.enable(2884):u$W.disable(2884))},u$d.setFrontFace=function(u$W,u$j){u$j!==u$d._frontFace&&(u$d._frontFace=u$j,u$W.frontFace(u$j))},u$d.bindTexture=function(u$W,u$j,u$t){u$W.bindTexture(u$j,u$t),u$d.curBindTexTarget=u$j,u$d.curBindTexValue=u$t},u$d.DEPTH_BUFFER_BIT=256,u$d.STENCIL_BUFFER_BIT=1024,u$d.COLOR_BUFFER_BIT=16384,u$d.POINTS=0,u$d.LINES=1,u$d.LINE_LOOP=2,u$d.LINE_STRIP=3,u$d.TRIANGLES=4,u$d.TRIANGLE_STRIP=5,u$d.TRIANGLE_FAN=6,u$d.ZERO=0,u$d.ONE=1,u$d.SRC_COLOR=768,u$d.ONE_MINUS_SRC_COLOR=769,u$d.SRC_ALPHA=770,u$d.ONE_MINUS_SRC_ALPHA=771,u$d.DST_ALPHA=772,u$d.ONE_MINUS_DST_ALPHA=773,u$d.DST_COLOR=774,u$d.ONE_MINUS_DST_COLOR=775,u$d.SRC_ALPHA_SATURATE=776,u$d.FUNC_ADD=32774,u$d.BLEND_EQUATION=32777,u$d.BLEND_EQUATION_RGB=32777,u$d.BLEND_EQUATION_ALPHA=34877,u$d.FUNC_SUBTRACT=32778,u$d.FUNC_REVERSE_SUBTRACT=32779,u$d.BLEND_DST_RGB=32968,u$d.BLEND_SRC_RGB=32969,u$d.BLEND_DST_ALPHA=32970,u$d.BLEND_SRC_ALPHA=32971,u$d.CONSTANT_COLOR=32769,u$d.ONE_MINUS_CONSTANT_COLOR=32770,u$d.CONSTANT_ALPHA=32771,u$d.ONE_MINUS_CONSTANT_ALPHA=32772,u$d.BLEND_COLOR=32773,u$d.ARRAY_BUFFER=34962,u$d.ELEMENT_ARRAY_BUFFER=34963,u$d.ARRAY_BUFFER_BINDING=34964,u$d.ELEMENT_ARRAY_BUFFER_BINDING=34965,u$d.STREAM_DRAW=35040,u$d.STATIC_DRAW=35044,u$d.DYNAMIC_DRAW=35048,u$d.BUFFER_SIZE=34660,u$d.BUFFER_USAGE=34661,u$d.CURRENT_VERTEX_ATTRIB=34342,u$d.FRONT=1028,u$d.BACK=1029,u$d.CULL_FACE=2884,u$d.FRONT_AND_BACK=1032,u$d.BLEND=3042,u$d.DITHER=3024,u$d.STENCIL_TEST=2960,u$d.DEPTH_TEST=2929,u$d.SCISSOR_TEST=3089,u$d.POLYGON_OFFSET_FILL=32823,u$d.SAMPLE_ALPHA_TO_COVERAGE=32926,u$d.SAMPLE_COVERAGE=32928,u$d.NO_ERROR=0,u$d.INVALID_ENUM=1280,u$d.INVALID_VALUE=1281,u$d.INVALID_OPERATION=1282,u$d.OUT_OF_MEMORY=1285,u$d.CW=2304,u$d.CCW=2305,u$d.LINE_WIDTH=2849,u$d.ALIASED_POINT_SIZE_RANGE=33901,u$d.ALIASED_LINE_WIDTH_RANGE=33902,u$d.CULL_FACE_MODE=2885,u$d.FRONT_FACE=2886,u$d.DEPTH_RANGE=2928,u$d.DEPTH_WRITEMASK=2930,u$d.DEPTH_CLEAR_VALUE=2931,u$d.DEPTH_FUNC=2932,u$d.STENCIL_CLEAR_VALUE=2961,u$d.STENCIL_FUNC=2962,u$d.STENCIL_FAIL=2964,u$d.STENCIL_PASS_DEPTH_FAIL=2965,u$d.STENCIL_PASS_DEPTH_PASS=2966,u$d.STENCIL_REF=2967,u$d.STENCIL_VALUE_MASK=2963,u$d.STENCIL_WRITEMASK=2968,u$d.STENCIL_BACK_FUNC=34816,u$d.STENCIL_BACK_FAIL=34817,u$d.STENCIL_BACK_PASS_DEPTH_FAIL=34818,u$d.STENCIL_BACK_PASS_DEPTH_PASS=34819,u$d.STENCIL_BACK_REF=36003,u$d.STENCIL_BACK_VALUE_MASK=36004,u$d.STENCIL_BACK_WRITEMASK=36005,u$d.VIEWPORT=2978,u$d.SCISSOR_BOX=3088,u$d.COLOR_CLEAR_VALUE=3106,u$d.COLOR_WRITEMASK=3107,u$d.UNPACK_ALIGNMENT=3317,u$d.PACK_ALIGNMENT=3333,u$d.MAX_TEXTURE_SIZE=3379,u$d.MAX_VIEWPORT_DIMS=3386,u$d.SUBPIXEL_BITS=3408,u$d.RED_BITS=3410,u$d.GREEN_BITS=3411,u$d.BLUE_BITS=3412,u$d.ALPHA_BITS=3413,u$d.DEPTH_BITS=3414,u$d.STENCIL_BITS=3415,u$d.POLYGON_OFFSET_UNITS=10752,u$d.POLYGON_OFFSET_FACTOR=32824,u$d.TEXTURE_BINDING_2D=32873,u$d.SAMPLE_BUFFERS=32936,u$d.SAMPLES=32937,u$d.SAMPLE_COVERAGE_VALUE=32938,u$d.SAMPLE_COVERAGE_INVERT=32939,u$d.NUM_COMPRESSED_TEXTURE_FORMATS=34466,u$d.COMPRESSED_TEXTURE_FORMATS=34467,u$d.DONT_CARE=4352,u$d.FASTEST=4353,u$d.NICEST=4354,u$d.GENERATE_MIPMAP_HINT=33170,u$d.BYTE=5120,u$d.UNSIGNED_BYTE=5121,u$d.SHORT=5122,u$d.UNSIGNED_SHORT=5123,u$d.INT=5124,u$d.UNSIGNED_INT=5125,u$d.FLOAT=5126,u$d.DEPTH_COMPONENT=6402,u$d.ALPHA=6406,u$d.RGB=6407,u$d.RGBA=6408,u$d.LUMINANCE=6409,u$d.LUMINANCE_ALPHA=6410,u$d.UNSIGNED_SHORT_4_4_4_4=32819,u$d.UNSIGNED_SHORT_5_5_5_1=32820,u$d.UNSIGNED_SHORT_5_6_5=33635,u$d.FRAGMENT_SHADER=35632,u$d.VERTEX_SHADER=35633,u$d.MAX_VERTEX_ATTRIBS=34921,u$d.MAX_VERTEX_UNIFORM_VECTORS=36347,u$d.MAX_VARYING_VECTORS=36348,u$d.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,u$d.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,u$d.MAX_TEXTURE_IMAGE_UNITS=34930,u$d.MAX_FRAGMENT_UNIFORM_VECTORS=36349,u$d.SHADER_TYPE=35663,u$d.DELETE_STATUS=35712,u$d.LINK_STATUS=35714,u$d.VALIDATE_STATUS=35715,u$d.ATTACHED_SHADERS=35717,u$d.ACTIVE_UNIFORMS=35718,u$d.ACTIVE_ATTRIBUTES=35721,u$d.SHADING_LANGUAGE_VERSION=35724,u$d.CURRENT_PROGRAM=35725,u$d.NEVER=512,u$d.LESS=513,u$d.EQUAL=514,u$d.LEQUAL=515,u$d.GREATER=516,u$d.NOTEQUAL=517,u$d.GEQUAL=518,u$d.ALWAYS=519,u$d.KEEP=7680,u$d.REPLACE=7681,u$d.INCR=7682,u$d.DECR=7683,u$d.INVERT=5386,u$d.INCR_WRAP=34055,u$d.DECR_WRAP=34056,u$d.VENDOR=7936,u$d.RENDERER=7937,u$d.VERSION=7938,u$d.NEAREST=9728,u$d.LINEAR=9729,u$d.NEAREST_MIPMAP_NEAREST=9984,u$d.LINEAR_MIPMAP_NEAREST=9985,u$d.NEAREST_MIPMAP_LINEAR=9986,u$d.LINEAR_MIPMAP_LINEAR=9987,u$d.TEXTURE_MAG_FILTER=10240,u$d.TEXTURE_MIN_FILTER=10241,u$d.TEXTURE_WRAP_S=10242,u$d.TEXTURE_WRAP_T=10243,u$d.TEXTURE_2D=3553,u$d.TEXTURE=5890,u$d.TEXTURE_CUBE_MAP=34067,u$d.TEXTURE_BINDING_CUBE_MAP=34068,u$d.TEXTURE_CUBE_MAP_POSITIVE_X=34069,u$d.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,u$d.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,u$d.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,u$d.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,u$d.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,u$d.MAX_CUBE_MAP_TEXTURE_SIZE=34076,u$d.TEXTURE0=33984,u$d.TEXTURE1=33985,u$d.TEXTURE2=33986,u$d.TEXTURE3=33987,u$d.TEXTURE4=33988,u$d.TEXTURE5=33989,u$d.TEXTURE6=33990,u$d.TEXTURE7=33991,u$d.TEXTURE8=33992,u$d.TEXTURE9=33993,u$d.TEXTURE10=33994,u$d.TEXTURE11=33995,u$d.TEXTURE12=33996,u$d.TEXTURE13=33997,u$d.TEXTURE14=33998,u$d.TEXTURE15=33999,u$d.TEXTURE16=34e3,u$d.TEXTURE17=34001,u$d.TEXTURE18=34002,u$d.TEXTURE19=34003,u$d.TEXTURE20=34004,u$d.TEXTURE21=34005,u$d.TEXTURE22=34006,u$d.TEXTURE23=34007,u$d.TEXTURE24=34008,u$d.TEXTURE25=34009,u$d.TEXTURE26=34010,u$d.TEXTURE27=34011,u$d.TEXTURE28=34012,u$d.TEXTURE29=34013,u$d.TEXTURE30=34014,u$d.TEXTURE31=34015,u$d.ACTIVE_TEXTURE=34016,u$d.REPEAT=10497,u$d.CLAMP_TO_EDGE=33071,u$d.MIRRORED_REPEAT=33648,u$d.FLOAT_VEC2=35664,u$d.FLOAT_VEC3=35665,u$d.FLOAT_VEC4=35666,u$d.INT_VEC2=35667,u$d.INT_VEC3=35668,u$d.INT_VEC4=35669,u$d.BOOL=35670,u$d.BOOL_VEC2=35671,u$d.BOOL_VEC3=35672,u$d.BOOL_VEC4=35673,u$d.FLOAT_MAT2=35674,u$d.FLOAT_MAT3=35675,u$d.FLOAT_MAT4=35676,u$d.SAMPLER_2D=35678,u$d.SAMPLER_CUBE=35680,u$d.VERTEX_ATTRIB_ARRAY_ENABLED=34338,u$d.VERTEX_ATTRIB_ARRAY_SIZE=34339,u$d.VERTEX_ATTRIB_ARRAY_STRIDE=34340,u$d.VERTEX_ATTRIB_ARRAY_TYPE=34341,u$d.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,u$d.VERTEX_ATTRIB_ARRAY_POINTER=34373,u$d.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,u$d.COMPILE_STATUS=35713,u$d.LOW_FLOAT=36336,u$d.MEDIUM_FLOAT=36337,u$d.HIGH_FLOAT=36338,u$d.LOW_INT=36339,u$d.MEDIUM_INT=36340,u$d.HIGH_INT=36341,u$d.FRAMEBUFFER=36160,u$d.RENDERBUFFER=36161,u$d.RGBA4=32854,u$d.RGB5_A1=32855,u$d.RGB565=36194,u$d.DEPTH_COMPONENT16=33189,u$d.STENCIL_INDEX=6401,u$d.STENCIL_INDEX8=36168,u$d.DEPTH_STENCIL=34041,u$d.RENDERBUFFER_WIDTH=36162,u$d.RENDERBUFFER_HEIGHT=36163,u$d.RENDERBUFFER_INTERNAL_FORMAT=36164,u$d.RENDERBUFFER_RED_SIZE=36176,u$d.RENDERBUFFER_GREEN_SIZE=36177,u$d.RENDERBUFFER_BLUE_SIZE=36178,u$d.RENDERBUFFER_ALPHA_SIZE=36179,u$d.RENDERBUFFER_DEPTH_SIZE=36180,u$d.RENDERBUFFER_STENCIL_SIZE=36181,u$d.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,u$d.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,u$d.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,u$d.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,u$d.COLOR_ATTACHMENT0=36064,u$d.DEPTH_ATTACHMENT=36096,u$d.STENCIL_ATTACHMENT=36128,u$d.DEPTH_STENCIL_ATTACHMENT=33306,u$d.NONE=0,u$d.FRAMEBUFFER_COMPLETE=36053,u$d.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,u$d.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,u$d.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,u$d.FRAMEBUFFER_UNSUPPORTED=36061,u$d.FRAMEBUFFER_BINDING=36006,u$d.RENDERBUFFER_BINDING=36007,u$d.MAX_RENDERBUFFER_SIZE=34024,u$d.INVALID_FRAMEBUFFER_OPERATION=1286,u$d.UNPACK_FLIP_Y_WEBGL=37440,u$d.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,u$d.CONTEXT_LOST_WEBGL=37442,u$d.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,u$d.BROWSER_DEFAULT_WEBGL=37444,u$d._useProgram=null,u$d._depthTest=!0,u$d._depthMask=!0,u$d._blend=!1,u$d._cullFace=!1,u$d.curBindTexTarget=null,u$d.curBindTexValue=null,u$O(u$d,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),u$d}(),u$_W=function(u$W){function u$j(){u$j.__super.call(this)}u$Q(u$j,"laya.webgl.display.GraphicsGL",u$q);var u$t=u$j.prototype;return u$t.setShader=function(u$W){this._saveToCmd(u$o.context._setShader,[u$W])},u$t.setIBVB=function(u$W,u$j,u$t,u$d,u$b,u$E){this._saveToCmd(u$o.context._setIBVB,[u$W,u$j,u$t,u$d,u$b,u$E])},u$t.drawParticle=function(u$W,u$j,u$t){var u$d=u$X.createParticleTemplate2D(u$t);u$d.x=u$W,u$d.y=u$j,this._saveToCmd(u$o.context._drawParticle,[u$d])},u$j}(),u$NW=function(u$W){var u$t;function u$H(u$W){this._x=0,this._y=0,this._id=++u$H._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,u$H.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=u$H.MAXCLIPRECT,this.mOutPoint,this._canvas=u$W,this._canvas._addReference(),u$H._contextcount++,u$o.isFlash?(this._ib=u$pW.create(35044),u$KW.fillIBQuadrangle(this._ib,16)):this._ib=u$pW.QuadrangleIB,this.clear()}u$Q(u$H,"laya.webgl.canvas.WebGLContext2D",u$b);var u$j=u$H.prototype;return u$j.setIsMainContext=function(){this._isMain=!0},u$j.clearBG=function(u$W,u$j,u$t,u$d){var u$b=u$ZW.mainContext;u$b.clearColor(u$W,u$j,u$t,u$d),u$b.clear(16384)},u$j._getSubmits=function(){return this._submits},u$j._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var u$W=0,u$j=this._submits._length;u$W<u$j;u$W++)this._submits[u$W].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},u$j.destroy=function(){--u$H._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=u$pW.QuadrangleIB&&this._ib.releaseResource()},u$j.clear=function(){this._submits||(this._other=u$t.DEFAULT,this._curMat=u$C.create(),this._vb=u$FW.create(-1),this._submits=[],this._save=[u$i.Create(this)],this._save.length=10,this._shader2D=new u$p,this._triangleMesh=u$aW.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=u$t.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=u$H.MAXCLIPRECT,this._curSubmit=u$EW.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=u$w.DEFAULT;for(var u$W=0,u$j=this._submits._length;u$W<u$j;u$W++)this._submits[u$W].releaseRender(),this._submits[u$W]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},u$j.size=function(u$W,u$j){if(this._width!=u$W||this._height!=u$j)if(0==u$W||0==u$j){0!=this._vb._byteLength&&(this._width=u$W,this._height=u$j,this._vb.clear(),this._vb.upload());for(var u$t=0,u$d=this._submits._length;u$t<u$d;u$t++)this._submits[u$t].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=u$W,this._height=u$j,this._targets&&this._targets.size(u$W,u$j),this._canvas.memorySize-=this._canvas.memorySize;0===u$W&&0===u$j&&this._releaseMem()},u$j._getTransformMatrix=function(){return this._curMat},u$j.translate=function(u$W,u$j){0===u$W&&0===u$j||(u$n.save(this),this._curMat.bTransform&&(u$B.save(this),this._curMat.transformPointN(u$L.TEMP.setTo(u$W,u$j)),u$W=u$L.TEMP.x,u$j=u$L.TEMP.y),this._x+=u$W,this._y+=u$j)},u$j.save=function(){this._save[this._save._length++]=u$i.Create(this)},u$j.restore=function(){var u$W=this._save._length;if(!(u$W<1))for(var u$j=u$W-1;0<=u$j;u$j--){var u$t=this._save[u$j];if(u$t.restore(this),u$t.isSaveMark())return void(this._save._length=u$j)}},u$j._fillText=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){void 0===u$c&&(u$c=0);var u$R=this._shader2D,u$m=this._curSubmit.shaderValue,u$Q=u$b?u$$W.create(u$b):this._other.font;if(u$I.enabled)u$R.ALPHA!==u$m.ALPHA&&(u$R.glTexture=null),u$TW.drawText(this,u$W,u$j,this._curMat,u$Q,u$A||this._other.textAlign,u$E,u$O,u$q,u$t,u$d,u$c);else{this._shader2D.defines.getValue();var u$T=u$E?u$$.create(u$E)._color:u$R.colorAdd;u$R.ALPHA===u$m.ALPHA&&u$T===u$R.colorAdd&&u$m.colorAdd===u$R.colorAdd||(u$R.glTexture=null,u$R.colorAdd=u$T),u$TW.drawText(this,u$W,u$j,this._curMat,u$Q,u$A||this._other.textAlign,u$E,u$O,u$q,u$t,u$d,u$c)}},u$j.fillWords=function(u$W,u$j,u$t,u$d,u$b,u$E){this._fillText(null,u$W,u$j,u$t,u$d,u$b,null,-1,null,u$E)},u$j.fillBorderWords=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this._fillBorderText(null,u$W,u$j,u$t,u$d,u$b,u$E,u$O,null)},u$j.fillText=function(u$W,u$j,u$t,u$d,u$b,u$E){this._fillText(u$W,null,u$j,u$t,u$d,u$b,null,-1,u$E)},u$j.strokeText=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this._fillText(u$W,null,u$j,u$t,u$d,null,u$b,u$E||1,u$O)},u$j.fillBorderText=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){this._fillBorderText(u$W,null,u$j,u$t,u$d,u$b,u$E,u$O,u$q)},u$j._fillBorderText=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){if(!u$I.enabled)return this._fillText(u$W,u$j,u$t,u$d,u$b,null,u$O,u$q||1,u$A),void this._fillText(u$W,u$j,u$t,u$d,u$b,u$E,null,-1,u$A);var u$c=this._shader2D,u$R=this._curSubmit.shaderValue;u$c.ALPHA!==u$R.ALPHA&&(u$c.glTexture=null);var u$m=u$b?(u$H._fontTemp.setFont(u$b),u$H._fontTemp):this._other.font;u$TW.drawText(this,u$W,u$j,this._curMat,u$m,u$A||this._other.textAlign,u$E,u$O,u$q||1,u$t,u$d,0)},u$j.fillRect=function(u$W,u$j,u$t,u$d,u$b){var u$E=this._vb;if(u$KW.fillRectImgVb(u$E,this._clipRect,u$W,u$j,u$t,u$d,u$a.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var u$O=this._shader2D.fillStyle;u$b&&(this._shader2D.fillStyle=u$w.create(u$b));var u$q=this._shader2D,u$A=this._curSubmit.shaderValue;if(u$q.fillStyle!==u$A.fillStyle||u$q.ALPHA!==u$A.ALPHA){u$q.glTexture=null;var u$c=this._curSubmit=u$EW.createSubmit(this,this._ib,u$E,(u$E._byteLength-64)/32*3,u$zW.create(2,0));u$c.shaderValue.color=u$q.fillStyle._color._color,u$c.shaderValue.ALPHA=u$q.ALPHA,this._submits[this._submits._length++]=u$c}this._curSubmit._numEle+=6,this._shader2D.fillStyle=u$O}},u$j.fillTexture=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){if(u$W.loaded&&u$W.bitmap&&u$W.source){var u$A=this._vb,u$c=u$W.bitmap.width,u$R=u$W.bitmap.height,u$m=u$W.uv,u$Q=u$O.x%u$W.width,u$T=u$O.y%u$W.height;if(u$c!=u$q.w||u$R!=u$q.h){if(!u$q.w&&!u$q.h)switch(u$q.oy=u$q.ox=0,u$E){case"repeat":u$q.width=u$d,u$q.height=u$b;break;case"repeat-x":u$q.width=u$d,u$T<0?u$W.height+u$T>u$b?u$q.height=u$b:u$q.height=u$W.height+u$T:(u$q.oy=u$T,u$W.height+u$T>u$b?u$q.height=u$b-u$T:u$q.height=u$W.height);break;case"repeat-y":u$Q<0?u$W.width+u$Q>u$d?u$q.width=u$d:u$q.width=u$W.width+u$Q:(u$q.ox=u$Q,u$W.width+u$Q>u$d?u$q.width=u$d-u$Q:u$q.width=u$W.width),u$q.height=u$b;break;case"no-repeat":u$Q<0?u$W.width+u$Q>u$d?u$q.width=u$d:u$q.width=u$W.width+u$Q:(u$q.ox=u$Q,u$W.width+u$Q>u$d?u$q.width=u$d-u$Q:u$q.width=u$W.width),u$T<0?u$W.height+u$T>u$b?u$q.height=u$b:u$q.height=u$W.height+u$T:(u$q.oy=u$T,u$W.height+u$T>u$b?u$q.height=u$b-u$T:u$q.height=u$W.height);break;default:u$q.width=u$d,u$q.height=u$b}u$q.w=u$c,u$q.h=u$R,u$q.uv=[0,0,u$q.width/u$c,0,u$q.width/u$c,u$q.height/u$R,0,u$q.height/u$R]}if(u$j+=u$q.ox,u$t+=u$q.oy,u$Q-=u$q.ox,u$T-=u$q.oy,u$KW.fillRectImgVb(u$A,this._clipRect,u$j,u$t,u$q.width,u$q.height,u$q.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var u$$=u$yW.create(this,this._ib,u$A,(u$A._byteLength-64)/32*3,u$zW.create(256,0)),u$e=(this._submits[this._submits._length++]=u$$).shaderValue;u$e.textureHost=u$W;var u$K=u$m[0]*u$c,u$o=u$m[1]*u$R,u$S=(u$m[2]-u$m[0])*u$c,u$M=(u$m[5]-u$m[3])*u$R,u$Z=-u$Q/u$c,u$X=-u$T/u$R;u$e.u_TexRange[0]=u$K/u$c,u$e.u_TexRange[1]=u$S/u$c,u$e.u_TexRange[2]=u$o/u$R,u$e.u_TexRange[3]=u$M/u$R,u$e.u_offset[0]=u$Z,u$e.u_offset[1]=u$X,u$I.enabled&&!this._isMain&&u$$.addTexture(u$W,(u$A._byteLength>>2)-16),(this._curSubmit=u$$)._renderType=10017,u$$._numEle+=6}}else this.sprite&&u$_.timer.callLater(this,this._repaintSprite)},u$j.setShader=function(u$W){u$J.save(this,1048576,this._shader2D,!0),this._shader2D.shader=u$W},u$j.setFilters=function(u$W){u$J.save(this,2097152,this._shader2D,!0),this._shader2D.filters=u$W,this._curSubmit=u$EW.RENDERBASE,this._renderKey=0,this._drawCount++},u$j.drawTexture=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this._drawTextureM(u$W,u$j,u$t,u$d,u$b,u$E,u$O,null,1)},u$j.addTextureVb=function(u$W,u$j,u$t){var u$d=this._curSubmit._vb||this._vb,u$b=u$d._byteLength>>2;u$d.byteLength=u$b+16<<2;for(var u$E=u$d.getFloat32Array(),u$O=0;u$O<16;u$O+=4)u$E[u$b++]=u$W[u$O]+u$j,u$E[u$b++]=u$W[u$O+1]+u$t,u$E[u$b++]=u$W[u$O+2],u$E[u$b++]=u$W[u$O+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),u$d._upload=!0},u$j.willDrawTexture=function(u$W,u$j){if(!(u$W.loaded&&u$W.bitmap&&u$W.source))return this.sprite&&u$_.timer.callLater(this,this._repaintSprite),0;var u$t=u$W.bitmap,u$d=u$t.id+this._shader2D.ALPHA*u$j+10016;if(u$d==this._renderKey)return u$d;var u$b=this._shader2D,u$E=u$b.ALPHA,u$O=this._curSubmit.shaderValue;u$b.ALPHA*=u$j,this._renderKey=u$d,this._drawCount++,u$b.glTexture=u$t;var u$q=this._vb,u$A=null,u$c=u$q._byteLength/32*3,u$R=u$O.textureHost&&u$O.textureHost==u$W&&u$O.textureHost.alphaTexture==u$W.alphaTexture;return u$A=u$yW.create(this,this._ib,u$q,u$c,u$zW.create(1,0)),(this._submits[this._submits._length++]=u$A).shaderValue.textureHost=u$W,u$A._renderType=10016,u$A._preIsSameTextureShader=10016===this._curSubmit._renderType&&u$b.ALPHA===u$O.ALPHA&&u$R,this._curSubmit=u$A,u$b.ALPHA=u$E,u$d},u$j.drawTextures=function(u$W,u$j,u$t,u$d){if(u$W.loaded&&u$W.bitmap&&u$W.source){var u$b=this._clipRect;if(this._clipRect=u$H.MAXCLIPRECT,this._drawTextureM(u$W,u$j[0],u$j[1],u$W.width,u$W.height,u$t,u$d,null,1)){if(this._clipRect=u$b,u$l.drawCall++,!(u$j.length<4)){for(var u$E=this._curSubmit._vb||this._vb,u$O=this._curMat.a,u$q=this._curMat.d,u$A=2,u$c=u$j.length;u$A<u$c;u$A+=2)u$KW.copyPreImgVb(u$E,(u$j[u$A]-u$j[u$A-2])*u$O,(u$j[u$A+1]-u$j[u$A-1])*u$q),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&u$_.timer.callLater(this,this._repaintSprite)},u$j._drawTextureM=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){if(!u$W.loaded||!u$W.source)return this.sprite&&u$_.timer.callLater(this,this._repaintSprite),!1;var u$c=this._curSubmit._vb||this._vb,u$R=u$W.bitmap;u$j+=u$E,u$t+=u$O,this._drawCount++;var u$m=u$R.id+this._shader2D.ALPHA*u$A+10016;if(u$m!=this._renderKey){this._renderKey=u$m;var u$Q=this._curSubmit.shaderValue,u$T=this._shader2D,u$$=u$T.ALPHA;u$T.ALPHA*=u$A,u$T.glTexture=u$R;var u$e=this._vb,u$K=null,u$o=u$e._byteLength/32*3,u$S=u$Q.textureHost&&u$Q.textureHost==u$W&&u$Q.textureHost.alphaTexture==u$W.alphaTexture;u$K=u$yW.create(this,this._ib,u$e,u$o,u$zW.create(1,0)),(this._submits[this._submits._length++]=u$K).shaderValue.textureHost=u$W,u$K._renderType=10016,u$K._preIsSameTextureShader=10016===this._curSubmit._renderType&&u$T.ALPHA===u$Q.ALPHA&&u$S,this._curSubmit=u$K,u$c=this._curSubmit._vb||this._vb,u$T.ALPHA=u$$}return!!u$KW.fillRectImgVb(u$c,this._clipRect,u$j,u$t,u$d||u$W.width,u$b||u$W.height,u$W.uv,u$q||this._curMat,this._x,this._y,0,0)&&(u$I.enabled&&!this._isMain&&this._curSubmit.addTexture(u$W,(u$c._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},u$j._repaintSprite=function(){this.sprite&&this.sprite.repaint()},u$j._drawText=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){var u$R=u$W.bitmap;this._drawCount++;var u$m=u$R.id+this._shader2D.ALPHA+10016;if(u$m!=this._renderKey){this._renderKey=u$m;var u$Q=this._curSubmit.shaderValue,u$T=this._shader2D;u$T.glTexture=u$R;var u$$=this._vb,u$e=null,u$K=u$$._byteLength/32*3,u$o=u$Q.textureHost&&u$Q.textureHost==u$W&&u$Q.textureHost.alphaTexture==u$W.alphaTexture;(u$e=u$I.enabled?u$yW.create(this,this._ib,u$$,u$K,u$zW.create(1,0)):u$yW.create(this,this._ib,u$$,u$K,u$nW.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&u$T.ALPHA===u$Q.ALPHA&&u$o,(this._submits[this._submits._length++]=u$e).shaderValue.textureHost=u$W,u$e._renderType=10016,this._curSubmit=u$e}u$W.active();var u$S=this._curSubmit._vb||this._vb;u$KW.fillRectImgVb(u$S,this._clipRect,u$j+u$O,u$t+u$q,u$d||u$W.width,u$b||u$W.height,u$W.uv,u$E||this._curMat,this._x,this._y,u$A,u$c,!0)&&(u$I.enabled&&!this._isMain&&this._curSubmit.addTexture(u$W,(u$S._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},u$j.drawTextureWithTransform=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){if(u$E){var u$c=this._curMat,u$R=this._x,u$m=this._y;(0!==u$O||0!==u$q)&&(this._x=u$O*u$c.a+u$q*u$c.c,this._y=u$q*u$c.d+u$O*u$c.b),u$E&&u$c.bTransform?(u$C.mul(u$E,u$c,u$H._tmpMatrix),(u$E=u$H._tmpMatrix)._checkTransform()):(this._x+=u$c.tx,this._y+=u$c.ty),this._drawTextureM(u$W,u$j,u$t,u$d,u$b,0,0,u$E,u$A),this._x=u$R,this._y=u$m}else this._drawTextureM(u$W,u$j,u$t,u$d,u$b,u$O,u$q,null,u$A)},u$j.fillQuadrangle=function(u$W,u$j,u$t,u$d,u$b){var u$E=this._curSubmit,u$O=this._vb,u$q=this._shader2D,u$A=u$E.shaderValue;if(this._renderKey=0,u$W.bitmap){var u$c=u$W.bitmap;u$q.glTexture==u$c&&u$q.ALPHA===u$A.ALPHA||(u$q.glTexture=u$c,(u$E=this._curSubmit=u$EW.createSubmit(this,this._ib,u$O,u$O._byteLength/32*3,u$zW.create(1,0))).shaderValue.glTexture=u$c,this._submits[this._submits._length++]=u$E),u$KW.fillQuadrangleImgVb(u$O,u$j,u$t,u$d,u$W.uv,u$b||this._curMat,this._x,this._y)}else u$E.shaderValue.fillStyle&&u$E.shaderValue.fillStyle.equal(u$W)&&u$q.ALPHA===u$A.ALPHA||(u$q.glTexture=null,(u$E=this._curSubmit=u$EW.createSubmit(this,this._ib,u$O,u$O._byteLength/32*3,u$zW.create(2,0))).shaderValue.defines.add(2),u$E.shaderValue.fillStyle=u$w.create(u$W),this._submits[this._submits._length++]=u$E),u$KW.fillQuadrangleImgVb(u$O,u$j,u$t,u$d,u$a.DEF_UV,u$b||this._curMat,this._x,this._y);u$E._numEle+=6},u$j.drawTexture2=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){if(0!=u$E){var u$A=this._curMat;if(this._x=u$W*u$A.a+u$j*u$A.c,this._y=u$j*u$A.d+u$W*u$A.b,u$b&&(u$b=u$A.bTransform||u$b.bTransform?(u$C.mul(u$b,u$A,u$H._tmpMatrix),u$H._tmpMatrix):(this._x+=u$b.tx+u$A.tx,this._y+=u$b.ty+u$A.ty,u$C.EMPTY)),1!==u$E||u$O){var u$c=this._shader2D.ALPHA,u$R=this._nBlendType;this._shader2D.ALPHA=u$E,u$O&&(this._nBlendType=u$f.TOINT(u$O)),this._drawTextureM(u$q[0],u$q[1]-u$t,u$q[2]-u$d,u$q[3],u$q[4],0,0,u$b,1),this._shader2D.ALPHA=u$c,this._nBlendType=u$R}else this._drawTextureM(u$q[0],u$q[1]-u$t,u$q[2]-u$d,u$q[3],u$q[4],0,0,u$b,1);this._x=this._y=0}},u$j.drawCanvas=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$W.context;if(this._renderKey=0,u$E._targets)this._submits[this._submits._length++]=u$vW.create(u$E,0,null),this._curSubmit=u$EW.RENDERBASE,u$E._targets.drawTo(this,u$j,u$t,u$d,u$b);else{var u$O=this._submits[this._submits._length++]=u$vW.create(u$E,this._shader2D.ALPHA,this._shader2D.filters),u$q=u$d/u$W.width,u$A=u$b/u$W.height,u$c=u$O._matrix;this._curMat.copyTo(u$c),1!=u$q&&1!=u$A&&u$c.scale(u$q,u$A);var u$R=u$c.tx,u$m=u$c.ty;u$c.tx=u$c.ty=0,u$c.transformPoint(u$L.TEMP.setTo(u$j,u$t)),u$c.translate(u$L.TEMP.x+u$R,u$L.TEMP.y+u$m),this._curSubmit=u$EW.RENDERBASE}u$N.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=u$E._targets?"yellow":"green",this.strokeRect(u$j-1,u$t-1,u$d+2,u$b+2,1),this.strokeRect(u$j,u$t,u$d,u$b,1),this.restore())},u$j.drawTarget=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){void 0===u$c&&(u$c=-1);var u$R=this._vb;if(u$KW.fillRectImgVb(u$R,this._clipRect,u$j,u$t,u$d,u$b,u$A||u$a.DEF_UV,u$E||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var u$m=this._curSubmit=u$mW.create(this,this._ib,u$R,(u$R._byteLength-64)/32*3,u$q,u$O);u$m.blendType=-1==u$c?this._nBlendType:u$c,u$m.scope=u$W,this._submits[this._submits._length++]=u$m,this._curSubmit._numEle+=6}},u$j.mixRGBandAlpha=function(u$W){return this._mixRGBandAlpha(u$W,this._shader2D.ALPHA)},u$j._mixRGBandAlpha=function(u$W,u$j){var u$t=(4278190080&u$W)>>>24;return 0!=u$t?u$t*=u$j:u$t=255*u$j,16777215&u$W|u$t<<24},u$j.drawTriangles=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){if(!u$W.loaded||!u$W.source)return this.sprite&&u$_.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;u$W.bitmap;var u$R=this._mixRGBandAlpha(4294967295,u$q),u$m=(u$d.length,u$E.length);this._renderKey=-1;var u$Q=this._curSubmit=u$yW.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,u$zW.create(1,0));return u$Q.shaderValue.textureHost=u$W,u$Q._renderType=10016,this._submits[this._submits._length++]=u$Q,u$O?(u$H._tmpMatrix.a=u$O.a,u$H._tmpMatrix.b=u$O.b,u$H._tmpMatrix.c=u$O.c,u$H._tmpMatrix.d=u$O.d,u$H._tmpMatrix.tx=u$O.tx+u$j,u$H._tmpMatrix.ty=u$O.ty+u$t,u$C.mul(u$H._tmpMatrix,this._curMat,u$H._tmpMatrix)):(u$H._tmpMatrix.a=this._curMat.a,u$H._tmpMatrix.b=this._curMat.b,u$H._tmpMatrix.c=this._curMat.c,u$H._tmpMatrix.d=this._curMat.d,u$H._tmpMatrix.tx=this._curMat.tx+u$j,u$H._tmpMatrix.ty=this._curMat.ty+u$t),this._triangleMesh.addData(u$d,u$b,u$E,u$H._tmpMatrix,u$R,this),this._curSubmit._numEle+=u$m,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},u$j.transform=function(u$W,u$j,u$t,u$d,u$b,u$E){u$B.save(this),u$C.mul(u$C.TEMP.setTo(u$W,u$j,u$t,u$d,u$b,u$E),this._curMat,this._curMat),this._curMat._checkTransform()},u$j.setTransformByMatrix=function(u$W){u$W.copyTo(this._curMat)},u$j.transformByMatrix=function(u$W){u$B.save(this),u$C.mul(u$W,this._curMat,this._curMat),this._curMat._checkTransform()},u$j.rotate=function(u$W){u$B.save(this),this._curMat.rotateEx(u$W)},u$j.scale=function(u$W,u$j){u$B.save(this),this._curMat.scaleEx(u$W,u$j)},u$j.clipRect=function(u$W,u$j,u$t,u$d){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var u$b=u$RW.create(4);this.addRenderObject(u$b);var u$E=this._vb,u$O=u$E._byteLength>>2;if(u$KW.fillRectImgVb(u$E,null,u$W,u$j,u$t,u$d,u$a.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var u$q=this._curSubmit=u$EW.createSubmit(this,this._ib,u$E,(u$E._byteLength-64)/32*3,u$zW.create(2,0));u$q.shaderValue.ALPHA=1,this._submits[this._submits._length++]=u$q,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var u$A=u$RW.create(5);this.addRenderObject(u$A);var u$c=u$E.getFloat32Array(),u$R=Math.min(Math.min(Math.min(u$c[0+u$O],u$c[4+u$O]),u$c[8+u$O]),u$c[12+u$O]),u$m=Math.max(Math.max(Math.max(u$c[0+u$O],u$c[4+u$O]),u$c[8+u$O]),u$c[12+u$O]),u$Q=Math.min(Math.min(Math.min(u$c[1+u$O],u$c[5+u$O]),u$c[9+u$O]),u$c[13+u$O]),u$T=Math.max(Math.max(Math.max(u$c[1+u$O],u$c[5+u$O]),u$c[9+u$O]),u$c[13+u$O]);u$P.save(this,u$A,u$W,u$j,u$t,u$d,u$R,u$Q,u$m-u$R,u$T-u$Q),this._curSubmit=u$EW.RENDERBASE}else{u$t*=this._curMat.a,u$d*=this._curMat.d;var u$$=u$L.TEMP;this._curMat.transformPoint(u$$.setTo(u$W,u$j)),u$t<0&&(u$$.x=u$$.x+u$t,u$t=-u$t),u$d<0&&(u$$.y=u$$.y+u$d,u$d=-u$d),this._renderKey=0;var u$e=this._curSubmit=u$cW.create(this);(this._submits[this._submits._length++]=u$e).submitIndex=this._submits._length,u$e.submitLength=9999999,u$r.save(this,u$e);var u$K=this._clipRect,u$o=u$K.x,u$S=u$K.y,u$M=u$$.x+u$t,u$Z=u$$.y+u$d;u$o<u$$.x&&(u$K.x=u$$.x),u$S<u$$.y&&(u$K.y=u$$.y),u$K.width=Math.min(u$M,u$o+u$K.width)-u$K.x,u$K.height=Math.min(u$Z,u$S+u$K.height)-u$K.y,this._shader2D.glTexture=null,u$e.clipRect.copyFrom(u$K),this._curSubmit=u$EW.RENDERBASE}},u$j.setIBVB=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R){if(void 0===u$A&&(u$A=0),void 0===u$c&&(u$c=0),void 0===u$R&&(u$R=0),null===u$t){if(u$o.isFlash){var u$m=u$d;u$m._selfIB||(u$m._selfIB=u$pW.create(35044)),u$m._selfIB.clear(),u$t=u$m._selfIB}else u$t=this._ib;u$KW.expandIBQuadrangle(u$t,u$d._byteLength/(4*u$d.vertexStride*4))}if(!u$q||!u$O)throw Error("setIBVB must input:shader shaderValues");var u$Q=u$AW.create(this,u$d,u$t,u$b,u$O,u$q,u$A,u$c,u$R);u$E||(u$E=u$C.EMPTY),u$E.translate(u$W,u$j),u$C.mul(u$E,this._curMat,u$Q._mat),u$E.translate(-u$W,-u$j),this._submits[this._submits._length++]=u$Q,this._curSubmit=u$EW.RENDERBASE,this._renderKey=0},u$j.addRenderObject=function(u$W){this._submits[this._submits._length++]=u$W},u$j.fillTrangles=function(u$W,u$j,u$t,u$d,u$b){var u$E=this._curSubmit,u$O=this._vb,u$q=this._shader2D,u$A=u$E.shaderValue,u$c=u$d.length>>4,u$R=u$W.bitmap;this._renderKey=0,u$q.glTexture==u$R&&u$q.ALPHA===u$A.ALPHA||((u$E=this._curSubmit=u$EW.createSubmit(this,this._ib,u$O,u$O._byteLength/32*3,u$zW.create(1,0))).shaderValue.textureHost=u$W,this._submits[this._submits._length++]=u$E),u$KW.fillTranglesVB(u$O,u$j,u$t,u$d,u$b||this._curMat,this._x,this._y),u$E._numEle+=6*u$c},u$j.submitElement=function(u$W,u$j){var u$t=this._submits;for(u$j<0&&(u$j=u$t._length);u$W<u$j;)u$W+=u$t[u$W].renderSubmit()},u$j.finish=function(){u$ZW.mainContext.finish()},u$j.flush=function(){var u$W=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(u$W>this._ib.bufferLength/12&&u$KW.expandIBQuadrangle(this._ib,u$W),!this._isMain&&u$I.enabled&&u$I._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=u$I._atlasRestore;for(var u$j=this._submits,u$t=0,u$d=u$j._length;u$t<u$d;u$t++){var u$b=u$j[u$t];10016===u$b.getRenderType()&&u$b.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),u$jW.instance&&u$jW.getInstance().reset();var u$E;for(u$t=0,u$E=this.meshlist.length;u$t<u$E;u$t++){var u$O=this.meshlist[u$t];u$O.canReuse?u$O.releaseMesh():u$O.destroy()}return this.meshlist.length=0,this._curSubmit=u$EW.RENDERBASE,this._renderKey=0,this._triangleMesh=u$aW.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},u$j.setPathId=function(u$W){if(this.mId=u$W,-1!=this.mId){this.mHaveKey=!1;var u$j=u$D.getInstance();u$j.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,u$j.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},u$j.movePath=function(u$W,u$j){var u$t=u$W,u$d=u$j;u$W=this._curMat.a*u$t+this._curMat.c*u$d+this._curMat.tx,u$j=this._curMat.b*u$t+this._curMat.d*u$d+this._curMat.ty,this.mX+=u$W,this.mY+=u$j},u$j.beginPath=function(){var u$W=this._getPath();u$W.tempArray.length=0,u$W.closePath=!1,this.mX=0,this.mY=0},u$j.closePath=function(){this._path.closePath=!0},u$j.fill=function(u$W){void 0===u$W&&(u$W=!1);var u$j=this._getPath();this.drawPoly(0,0,u$j.tempArray,this.fillStyle._color.numColor,0,0,u$W)},u$j.stroke=function(){var u$W=this._getPath();if(0<this.lineWidth){if(-1==this.mId)u$W.drawLine(0,0,u$W.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var u$j=u$D.getInstance().shapeLineDic[this.mId];u$j.rebuild(u$W.tempArray),u$W.setGeomtry(u$j)}else u$D.getInstance().addLine(this.mId,u$W.drawLine(0,0,u$W.tempArray,this.lineWidth,this.strokeStyle._color.numColor));u$W.update();var u$t=[this.mX,this.mY],u$d=u$EW.createShape(this,u$W.ib,u$W.vb,u$W.count,u$W.offset,u$zW.create(4,0));u$d.shaderValue.ALPHA=this._shader2D.ALPHA,u$d.shaderValue.u_pos=u$t,u$d.shaderValue.u_mmat2=u$SW.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=u$d,this._renderKey=-1}},u$j.line=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=this._curSubmit,u$q=this._vb;if(u$KW.fillLineVb(u$q,this._clipRect,u$W,u$j,u$t,u$d,u$b,u$E)){this._renderKey=0;var u$A=this._shader2D,u$c=u$O.shaderValue;u$A.strokeStyle===u$c.strokeStyle&&u$A.ALPHA===u$c.ALPHA||(u$A.glTexture=null,(u$O=this._curSubmit=u$EW.createSubmit(this,this._ib,u$q,(u$q._byteLength-64)/32*3,u$zW.create(2,0))).shaderValue.strokeStyle=u$A.strokeStyle,u$O.shaderValue.mainID=2,u$O.shaderValue.ALPHA=u$A.ALPHA,this._submits[this._submits._length++]=u$O),u$O._numEle+=6}},u$j.moveTo=function(u$W,u$j,u$t){void 0===u$t&&(u$t=!0);var u$d=this._getPath();if(u$t){var u$b=u$W,u$E=u$j;u$W=this._curMat.a*u$b+this._curMat.c*u$E,u$j=this._curMat.b*u$b+this._curMat.d*u$E}u$d.addPoint(u$W,u$j)},u$j.lineTo=function(u$W,u$j,u$t){void 0===u$t&&(u$t=!0);var u$d=this._getPath();if(u$t){var u$b=u$W,u$E=u$j;u$W=this._curMat.a*u$b+this._curMat.c*u$E,u$j=this._curMat.b*u$b+this._curMat.d*u$E}u$d.addPoint(u$W,u$j)},u$j.drawCurves=function(u$W,u$j,u$t){this.setPathId(-1),this.beginPath(),this.strokeStyle=u$t[3],this.lineWidth=u$t[4];var u$d=u$t[2];u$W+=u$t[0],u$j+=u$t[1],this.movePath(u$W,u$j),this.moveTo(u$d[0],u$d[1]);for(var u$b=2,u$E=u$d.length;u$b<u$E;)this.quadraticCurveTo(u$d[u$b++],u$d[u$b++],u$d[u$b++],u$d[u$b++]);this.stroke()},u$j.arcTo=function(u$W,u$j,u$t,u$d,u$b){if(-1==this.mId||!this.mHaveKey){var u$E=0,u$O=0,u$q=0,u$A=this._getPath();this._curMat.copyTo(u$H._tmpMatrix),u$H._tmpMatrix.tx=u$H._tmpMatrix.ty=0,u$H._tempPoint.setTo(u$A.getEndPointX(),u$A.getEndPointY()),u$H._tmpMatrix.invertTransformPoint(u$H._tempPoint);var u$c=u$H._tempPoint.x-u$W,u$R=u$H._tempPoint.y-u$j,u$m=Math.sqrt(u$c*u$c+u$R*u$R);if(!(u$m<=1e-6)){var u$Q=u$c/u$m,u$T=u$R/u$m,u$$=u$t-u$W,u$e=u$d-u$j,u$K=u$$*u$$+u$e*u$e,u$o=Math.sqrt(u$K);if(!(u$o<=1e-6)){var u$S=u$$/u$o,u$M=u$e/u$o,u$Z=u$Q+u$S,u$X=u$T+u$M,u$_=Math.sqrt(u$Z*u$Z+u$X*u$X);if(!(u$_<=1e-6)){var u$N=u$Z/u$_,u$z=u$X/u$_,u$C=Math.acos(u$N*u$Q+u$z*u$T),u$L=Math.PI/2-u$C,u$V=(u$m=u$b/Math.tan(u$L))*u$Q+u$W,u$x=u$m*u$T+u$j,u$G=Math.sqrt(u$m*u$m+u$b*u$b),u$l=u$W+u$N*u$G,u$h=u$j+u$z*u$G,u$v=0,u$y=0;if(0<=u$Q*u$M-u$T*u$S){var u$a=2*u$L/u$H.SEGNUM;u$v=Math.sin(u$a),u$y=Math.cos(u$a)}else u$a=2*-u$L/u$H.SEGNUM,u$v=Math.sin(u$a),u$y=Math.cos(u$a);u$O=this._curMat.a*u$V+this._curMat.c*u$x,u$q=this._curMat.b*u$V+this._curMat.d*u$x,u$O==this._path.getEndPointX()&&u$q==this._path.getEndPointY()||u$A.addPoint(u$O,u$q);var u$u=u$V-u$l,u$D=u$x-u$h;for(u$E=0;u$E<u$H.SEGNUM;u$E++){var u$s=u$u*u$y+u$D*u$v,u$Y=-u$u*u$v+u$D*u$y;u$O=u$s+u$l,u$q=u$Y+u$h,u$W=this._curMat.a*u$O+this._curMat.c*u$q,u$q=u$j=this._curMat.b*u$O+this._curMat.d*u$q,(u$O=u$W)==this._path.getEndPointX()&&u$q==this._path.getEndPointY()||u$A.addPoint(u$O,u$q),u$u=u$s,u$D=u$Y}}}}}},u$j.arc=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){if(void 0===u$E&&(u$E=!1),void 0===u$O&&(u$O=!0),-1!=this.mId){var u$q=u$D.getInstance().shapeDic[this.mId];if(u$q&&this.mHaveKey&&!u$q.needUpdate(this._curMat))return;u$j=u$W=0}var u$A,u$c=0,u$R=0,u$m=0,u$Q=0,u$T=0,u$$=0,u$e=0;if(u$R=u$b-u$d,u$E)if(Math.abs(u$R)>=2*Math.PI)u$R=2*-Math.PI;else for(;0<u$R;)u$R-=2*Math.PI;else if(Math.abs(u$R)>=2*Math.PI)u$R=2*Math.PI;else for(;u$R<0;)u$R+=2*Math.PI;u$A=u$R/(u$e=u$t<101?Math.max(10,u$R*u$t/5):u$t<201?Math.max(10,u$R*u$t/20):Math.max(10,u$R*u$t/40))/2,u$m=Math.abs(4/3*(1-Math.cos(u$A))/Math.sin(u$A)),u$E&&(u$m=-u$m);var u$K=this._getPath(),u$o=NaN,u$S=NaN;for(u$$=0;u$$<=u$e;u$$++)u$c=u$d+u$R*(u$$/u$e),u$Q=u$W+Math.cos(u$c)*u$t,u$T=u$j+Math.sin(u$c)*u$t,u$O&&(u$o=u$Q,u$S=u$T,u$Q=this._curMat.a*u$o+this._curMat.c*u$S,u$T=this._curMat.b*u$o+this._curMat.d*u$S),u$Q==this._path.getEndPointX()&&u$T==this._path.getEndPointY()||u$K.addPoint(u$Q,u$T);u$Q=u$W+Math.cos(u$b)*u$t,u$T=u$j+Math.sin(u$b)*u$t,u$O&&(u$o=u$Q,u$S=u$T,u$Q=this._curMat.a*u$o+this._curMat.c*u$S,u$T=this._curMat.b*u$o+this._curMat.d*u$S),u$Q==this._path.getEndPointX()&&u$T==this._path.getEndPointY()||u$K.addPoint(u$Q,u$T)},u$j.quadraticCurveTo=function(u$W,u$j,u$t,u$d){var u$b=u$m.I,u$E=u$t,u$O=u$d;u$t=this._curMat.a*u$E+this._curMat.c*u$O,u$d=this._curMat.b*u$E+this._curMat.d*u$O,u$E=u$W,u$O=u$j,u$W=this._curMat.a*u$E+this._curMat.c*u$O,u$j=this._curMat.b*u$E+this._curMat.d*u$O;for(var u$q=u$b.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),u$W,u$j,u$t,u$d],30,2),u$A=0,u$c=u$q.length/2;u$A<u$c;u$A++)this.lineTo(u$q[2*u$A],u$q[2*u$A+1],!1);this.lineTo(u$t,u$d,!1)},u$j.rect=function(u$W,u$j,u$t,u$d){this._other=this._other.make(),this._other.path||(this._other.path=new u$U),this._other.path.rect(u$W,u$j,u$t,u$d)},u$j.strokeRect=function(u$W,u$j,u$t,u$d,u$b){var u$E=.5*u$b;this.line(u$W-u$E,u$j,u$W+u$t+u$E,u$j,u$b,this._curMat),this.line(u$W+u$t,u$j,u$W+u$t,u$j+u$d,u$b,this._curMat),this.line(u$W,u$j,u$W,u$j+u$d,u$b,this._curMat),this.line(u$W-u$E,u$j+u$d,u$W+u$t+u$E,u$j+u$d,u$b,this._curMat)},u$j.clip=function(){},u$j.drawPoly=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){void 0===u$O&&(u$O=!1),this._renderKey=0,this._shader2D.glTexture=null;var u$q=this._getPath();if(-1==this.mId)u$q.polygon(u$W,u$j,u$t,u$d,u$b||1,u$E);else if(this.mHaveKey){var u$A=u$D.getInstance().shapeDic[this.mId];u$A.setMatrix(this._curMat),u$A.rebuild(u$q.tempArray),u$q.setGeomtry(u$A)}else{var u$c=u$q.polygon(u$W,u$j,u$t,u$d,u$b||1,u$E);u$D.getInstance().addShape(this.mId,u$c),u$c.setMatrix(this._curMat)}u$q.update();var u$R,u$m=[this.mX,this.mY];if((u$R=u$EW.createShape(this,u$q.ib,u$q.vb,u$q.count,u$q.offset,u$zW.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,u$R.shaderValue.u_pos=u$m,u$R.shaderValue.u_mmat2=u$SW.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=u$R,0<u$b){if(this.mHaveLineKey){var u$Q=u$D.getInstance().shapeLineDic[this.mId];u$Q.rebuild(u$q.tempArray),u$q.setGeomtry(u$Q)}else u$D.getInstance().addShape(this.mId,u$q.drawLine(u$W,u$j,u$t,u$b,u$E));u$q.update(),(u$R=u$EW.createShape(this,u$q.ib,u$q.vb,u$q.count,u$q.offset,u$zW.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,u$R.shaderValue.u_mmat2=u$SW.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=u$R}},u$j.drawParticle=function(u$W,u$j,u$t){u$t.x=u$W,u$t.y=u$j,this._submits[this._submits._length++]=u$t},u$j._getPath=function(){return this._path||(this._path=new u$U)},u$d(0,u$j,"globalCompositeOperation",function(){return u$f.NAMES[this._nBlendType]},function(u$W){var u$j=u$f.TOINT[u$W];null==u$j||this._nBlendType===u$j||(u$J.save(this,65536,this,!0),this._curSubmit=u$EW.RENDERBASE,this._renderKey=0,this._nBlendType=u$j)}),u$d(0,u$j,"strokeStyle",function(){return this._shader2D.strokeStyle},function(u$W){this._shader2D.strokeStyle.equal(u$W)||(u$J.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=u$w.create(u$W))}),u$d(0,u$j,"globalAlpha",function(){return this._shader2D.ALPHA},function(u$W){(u$W=Math.floor(1e3*u$W)/1e3)!=this._shader2D.ALPHA&&(u$J.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=u$W)}),u$d(0,u$j,"asBitmap",null,function(u$W){if(u$W){if(this._targets||(this._targets=new u$k),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),u$d(0,u$j,"fillStyle",function(){return this._shader2D.fillStyle},function(u$W){this._shader2D.fillStyle.equal(u$W)||(u$J.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=u$w.create(u$W))}),u$d(0,u$j,"textAlign",function(){return this._other.textAlign},function(u$W){this._other.textAlign===u$W||(this._other=this._other.make(),u$J.save(this,32768,this._other,!1),this._other.textAlign=u$W)}),u$d(0,u$j,"lineWidth",function(){return this._other.lineWidth},function(u$W){this._other.lineWidth===u$W||(this._other=this._other.make(),u$J.save(this,256,this._other,!1),this._other.lineWidth=u$W)}),u$d(0,u$j,"textBaseline",function(){return this._other.textBaseline},function(u$W){this._other.textBaseline===u$W||(this._other=this._other.make(),u$J.save(this,16384,this._other,!1),this._other.textBaseline=u$W)}),u$d(0,u$j,"font",null,function(u$W){u$W!=this._other.font.toString()&&(this._other=this._other.make(),u$J.save(this,8,this._other,!1),this._other.font===u$$W.EMPTY?this._other.font=new u$$W(u$W):this._other.font.setFont(u$W))}),u$H.__init__=function(){u$t.DEFAULT=new u$t},u$H._tempPoint=new u$L,u$H._SUBMITVBSIZE=32e3,u$H._MAXSIZE=99999999,u$H._RECTVBSIZE=16,u$H.MAXCLIPRECT=new u$V(0,0,99999999,99999999),u$H._COUNT=0,u$H._tmpMatrix=new u$C,u$H.SEGNUM=32,u$H._contextcount=0,u$O(u$H,["_fontTemp",function(){return this._fontTemp=new u$$W},"_drawStyleTemp",function(){return this._drawStyleTemp=new u$w(null)}]),u$H.__init$=function(){u$t=function(){function u$W(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=u$$W.EMPTY}u$Q(u$W,"");var u$j=u$W.prototype;return u$j.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=u$$W.EMPTY},u$j.make=function(){return this===u$W.DEFAULT?new u$W:this},u$W.DEFAULT=null,u$W}()},u$H}(),u$zW=function(u$W){function u$d(u$W,u$j){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,u$d.__super.call(this),this.defines=new u$xW,this.position=u$d._POSITION,this.mainID=u$W,this.subID=u$j,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=u$W|u$j,this._inClassCache=u$d._cache[this._cacheID],0<u$W&&!this._inClassCache&&(this._inClassCache=u$d._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}u$Q(u$d,"laya.webgl.shader.d2.value.Value2D",u$Y);var u$j=u$d.prototype;return u$j.setValue=function(u$W){},u$j.refresh=function(){var u$W=this.size;return u$W[0]=u$SW.width,u$W[1]=u$SW.height,this.alpha=this.ALPHA*u$SW.worldAlpha,this.mmat=u$SW.worldMatrix4,this},u$j._ShaderWithCompile=function(){return u$iW.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,u$kW.create)},u$j._withWorldShaderDefines=function(){var u$W=u$SW.worldShaderDefines,u$j=u$iW.sharders[this.mainID|this.defines._value|u$W.getValue()];if(!u$j){var u$t,u$d={};for(u$t in this.defines.toNameDic())u$d[u$t]="";for(u$t in u$W.toNameDic())u$d[u$t]="";u$j=u$iW.withCompile2D(0,this.mainID,u$d,this.mainID|this.defines._value|u$W.getValue(),u$kW.create)}var u$b=u$SW.worldFilters;if(!u$b)return u$j;for(var u$E,u$O=u$b.length,u$q=0;u$q<u$O;u$q++)(u$E=u$b[u$q])&&u$E.action.setValue(this);return u$j},u$j.upload=function(){var u$W=u$SW;this.alpha=this.ALPHA*u$W.worldAlpha,u$SW.worldMatrix4!==u$SW.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),u$ZW.shaderHighPrecision&&this.defines.add(1024);var u$j,u$t=u$W.worldShaderDefines?this._withWorldShaderDefines():u$iW.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=u$W.width,this.size[1]=u$W.height,this.mmat=u$W.worldMatrix4,u$uW.activeShader!==u$t?u$t._shaderValueWidth!==u$W.width||u$t._shaderValueHeight!==u$W.height?(u$t._shaderValueWidth=u$W.width,u$t._shaderValueHeight=u$W.height):u$j=u$t._params2dQuick2||u$t._make2dQuick2():u$t._shaderValueWidth!==u$W.width||u$t._shaderValueHeight!==u$W.height?(u$t._shaderValueWidth=u$W.width,u$t._shaderValueHeight=u$W.height):u$j=u$t._params2dQuick1||u$t._make2dQuick1(),u$t.upload(this,u$j)},u$j.setFilters=function(u$W){if(this.filters=u$W)for(var u$j,u$t=u$W.length,u$d=0;u$d<u$t;u$d++)(u$j=u$W[u$d])&&(this.defines.add(u$j.type),u$j.action.setValue(this))},u$j.clear=function(){this.defines.setValue(this.subID)},u$j.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},u$d._initone=function(u$W,u$j){u$d._typeClass[u$W]=u$j,u$d._cache[u$W]=[],u$d._cache[u$W]._length=0},u$d.__init__=function(){u$d._POSITION=[2,5126,!1,4*u$eW.BYTES_PE,0],u$d._TEXCOORD=[2,5126,!1,4*u$eW.BYTES_PE,2*u$eW.BYTES_PE],u$d._initone(2,u$HW),u$d._initone(4,u$fW),u$d._initone(256,u$IW),u$d._initone(512,u$YW),u$d._initone(1,u$gW),u$d._initone(65,u$nW),u$d._initone(9,u$gW)},u$d.create=function(u$W,u$j){var u$t=u$d._cache[u$W|u$j];return u$t._length?u$t[--u$t._length]:new u$d._typeClass[u$W|u$j](u$j)},u$d._POSITION=null,u$d._TEXCOORD=null,u$d._cache=[],u$d._typeClass=[],u$d.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],u$d}(),u$CW=function(u$W){function u$K(u$W,u$j){u$K.__super.call(this,u$W,u$j)}u$Q(u$K,"laya.webgl.utils.RenderSprite3D",u$S);var u$j=u$K.prototype;return u$j.onCreate=function(u$W){switch(u$W){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},u$j._mask=function(u$W,u$j,u$t,u$d){var u$b,u$E,u$O=this._next,u$q=u$W.mask;if(u$q){u$j.ctx.save();var u$A=u$j.ctx.globalCompositeOperation,u$c=new u$V;if(u$c.copyFrom(u$q.getBounds()),u$c.width=Math.round(u$c.width),u$c.height=Math.round(u$c.height),u$c.x=Math.round(u$c.x),u$c.y=Math.round(u$c.y),0<u$c.width&&0<u$c.height){var u$R=u$W._style._tf,u$m=u$qW.create();u$m.addValue("bounds",u$c),u$b=u$OW.create([u$m,u$j],laya.webgl.utils.RenderSprite3D.tmpTarget),u$j.addRenderObject(u$b),u$q.render(u$j,-u$c.x,-u$c.y),u$b=u$OW.create([u$m],laya.webgl.utils.RenderSprite3D.endTmpTarget),u$j.addRenderObject(u$b),u$j.ctx.save(),u$j.clipRect(u$t-u$R.translateX+u$c.x,u$d-u$R.translateY+u$c.y,u$c.width,u$c.height),u$O._fun.call(u$O,u$W,u$j,u$t,u$d),u$j.ctx.restore(),u$E=u$RW.create(6),u$A=u$j.ctx.globalCompositeOperation,u$E.blendMode="mask",u$j.addRenderObject(u$E),u$C.TEMP.identity();var u$Q=u$zW.create(1,0),u$T=u$a.INV_UV,u$$=u$c.width,u$e=u$c.height;(u$c.width<32||u$c.height<32)&&((u$T=u$K.tempUV)[0]=0,u$T[1]=0,u$T[2]=32<=u$c.width?1:u$c.width/32,u$T[3]=0,u$T[4]=32<=u$c.width?1:u$c.width/32,u$T[5]=32<=u$c.height?1:u$c.height/32,u$T[6]=0,u$T[7]=32<=u$c.height?1:u$c.height/32,u$c.width=32<=u$c.width?u$c.width:32,u$c.height=32<=u$c.height?u$c.height:32,u$T[1]*=-1,u$T[3]*=-1,u$T[5]*=-1,u$T[7]*=-1,u$T[1]+=1,u$T[3]+=1,u$T[5]+=1,u$T[7]+=1),u$j.ctx.drawTarget(u$m,u$t+u$c.x-u$R.translateX,u$d+u$c.y-u$R.translateY,u$$,u$e,u$C.TEMP,"tmpTarget",u$Q,u$T,6),u$b=u$OW.create([u$m],laya.webgl.utils.RenderSprite3D.recycleTarget),u$j.addRenderObject(u$b),(u$E=u$RW.create(6)).blendMode=u$A,u$j.addRenderObject(u$E)}u$j.ctx.restore()}else u$O._fun.call(u$O,u$W,u$j,u$t,u$d)},u$j._blend=function(u$W,u$j,u$t,u$d){var u$b=u$W._style,u$E=this._next;u$b.blendMode?(u$j.ctx.save(),u$j.ctx.globalCompositeOperation=u$b.blendMode,u$E._fun.call(u$E,u$W,u$j,u$t,u$d),u$j.ctx.restore()):u$E._fun.call(u$E,u$W,u$j,u$t,u$d)},u$j._transform=function(u$W,u$j,u$t,u$d){var u$b=u$W.transform,u$E=this._next;if(u$b&&u$E!=u$S.NORENDER){var u$O=u$j.ctx;u$W._style;u$b.tx=u$t,u$b.ty=u$d;var u$q=u$O._getTransformMatrix(),u$A=u$q.clone();u$C.mul(u$b,u$q,u$q),u$q._checkTransform(),u$b.tx=u$b.ty=0,u$E._fun.call(u$E,u$W,u$j,0,0),u$A.copyTo(u$q),u$A.destroy()}else u$E._fun.call(u$E,u$W,u$j,u$t,u$d)},u$K.tmpTarget=function(u$W,u$j){var u$t=u$W.getValue("bounds"),u$d=u$DW.create(u$t.width,u$t.height);u$d.start(),u$d.clear(0,0,0,0),u$W.addValue("tmpTarget",u$d)},u$K.endTmpTarget=function(u$W){u$W.getValue("tmpTarget").end()},u$K.recycleTarget=function(u$W){u$W.getValue("tmpTarget").recycle(),u$W.recycle()},u$O(u$K,["tempUV",function(){return this.tempUV=new Array(8)}]),u$K}(),u$LW=function(u$W){function u$j(){this.data=null,u$j.__super.call(this)}u$Q(u$j,"laya.filters.webgl.ColorFilterActionGL",u$s);var u$t=u$j.prototype;return u$_.imps(u$t,{"laya.filters.IFilterActionGL":!0}),u$t.setValue=function(u$W){u$W.colorMat=this.data._mat,u$W.colorAlpha=this.data._alpha},u$t.apply3d=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$W.getValue("bounds"),u$O=u$zW.create(1,0);u$O.setFilters([this.data]);var u$q=u$C.TEMP;u$q.identity(),u$t.ctx.drawTarget(u$W,0,0,u$E.width,u$E.height,u$q,"src",u$O)},u$j}(),u$VW=function(u$W){function u$E(u$W,u$j,u$t,u$d,u$b){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,u$E.__super.call(this,u$W,u$j,u$b),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new u$wW,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=u$t,this._atlasCanvas.height=u$d,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}u$Q(u$E,"laya.webgl.atlas.Atlaser",u$H);var u$j=u$E.prototype;return u$j.computeUVinAtlasTexture=function(u$W,u$j,u$t,u$d){var u$b=u$I.atlasTextureWidth,u$E=u$I.atlasTextureHeight,u$O=u$t/u$b,u$q=u$d/u$E,u$A=(u$t+u$W.bitmap.width)/u$b,u$c=(u$d+u$W.bitmap.height)/u$E,u$R=u$W.bitmap.width/u$b,u$m=u$W.bitmap.height/u$E;u$W.uv=[u$O+u$j[0]*u$R,u$q+u$j[1]*u$m,u$A-(1-u$j[2])*u$R,u$q+u$j[3]*u$m,u$A-(1-u$j[4])*u$R,u$c-(1-u$j[5])*u$m,u$O+u$j[6]*u$R,u$c-(1-u$j[7])*u$m]},u$j.findBitmapIsExist=function(u$W){if(u$W instanceof laya.webgl.resource.WebGLImage){var u$j=u$W,u$t=u$j.url,u$d=this._InAtlasWebGLImagesKey[u$t||u$j.id];if(u$d)return u$d.offsetInfoID}return-1},u$j.addToAtlasTexture=function(u$W,u$j,u$t){if(u$W instanceof laya.webgl.resource.WebGLImage){var u$d=u$W,u$b=u$d.url;this._InAtlasWebGLImagesKey[u$b||u$d.id]={bitmap:u$W,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([u$j,u$t])}this._atlasCanvas.texSubImage2D(u$j,u$t,u$W.atlasSource),u$W.clearAtlasSource()},u$j.addToAtlas=function(u$W,u$j,u$t){u$W._atlasID=this._inAtlasTextureKey.length;var u$d=u$W.uv.slice(),u$b=u$W.bitmap;this._inAtlasTextureKey.push(u$W),this._inAtlasTextureOriUVValue.push(u$d),this._inAtlasTextureBitmapValue.push(u$b),this.computeUVinAtlasTexture(u$W,u$d,u$j,u$t),u$W.bitmap=this._atlasCanvas},u$j.clear=function(){for(var u$W=0,u$j=this._inAtlasTextureKey.length;u$W<u$j;u$W++)this._inAtlasTextureKey[u$W].bitmap=this._inAtlasTextureBitmapValue[u$W],this._inAtlasTextureKey[u$W].uv=this._inAtlasTextureOriUVValue[u$W],this._inAtlasTextureKey[u$W]._atlasID=-1,this._inAtlasTextureKey[u$W].bitmap.lock=!1,this._inAtlasTextureKey[u$W].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},u$j.dispose=function(){this.clear(),this._atlasCanvas.destroy()},u$d(0,u$j,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),u$d(0,u$j,"texture",function(){return this._atlasCanvas}),u$d(0,u$j,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),u$E}(),u$xW=function(u$W){function u$t(){u$t.__super.call(this,u$t.__name2int,u$t.__int2name,u$t.__int2nameMap)}return u$Q(u$t,"laya.webgl.shader.d2.ShaderDefines2D",u$F),u$t.__init__=function(){u$t.reg("TEXTURE2D",1),u$t.reg("COLOR2D",2),u$t.reg("PRIMITIVE",4),u$t.reg("GLOW_FILTER",8),u$t.reg("BLUR_FILTER",16),u$t.reg("COLOR_FILTER",32),u$t.reg("COLOR_ADD",64),u$t.reg("WORLDMAT",128),u$t.reg("FILLTEXTURE",256),u$t.reg("FSHIGHPRECISION",1024),u$t.reg("TXTALPHA",2048),u$t.reg("TXTCOMPRESS",4096)},u$t.reg=function(u$W,u$j){u$F._reg(u$W,u$j,u$t.__name2int,u$t.__int2name)},u$t.toText=function(u$W,u$j,u$t){return u$F._toText(u$W,u$j,u$t)},u$t.toInt=function(u$W){return u$F._toInt(u$W,u$t.__name2int)},u$t.TEXTURE2D=1,u$t.COLOR2D=2,u$t.PRIMITIVE=4,u$t.FILTERGLOW=8,u$t.FILTERBLUR=16,u$t.FILTERCOLOR=32,u$t.COLORADD=64,u$t.WORLDMAT=128,u$t.FILLTEXTURE=256,u$t.SKINMESH=512,u$t.SHADERDEFINE_FSHIGHPRECISION=1024,u$t.TXTALPHA=2048,u$t.TXTCOMPRESS=4096,u$t.__name2int={},u$t.__int2name=[],u$t.__int2nameMap=[],u$t}(),u$GW=(function(u$W){function u$q(u$W,u$j,u$t,u$d,u$b,u$E,u$O){u$q.__super.call(this,u$W,u$j,u$t,u$d,40,u$b,u$E,u$O)}u$Q(u$q,"laya.webgl.shapes.Ellipse",u$tW)}(),function(u$W){function u$E(u$W,u$j,u$t,u$d,u$b){this._points=[],this.rebuild(u$t),u$E.__super.call(this,u$W,u$j,0,0,0,u$b,u$d,u$b,0)}u$Q(u$E,"laya.webgl.shapes.Line",u$tW);var u$j=u$E.prototype;return u$j.rebuild=function(u$W){var u$j=u$W.length;u$j!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(u$j/2-1)),this.mFloat32Array=new Float32Array(5*u$j)),this._points.length=0;for(var u$t=NaN,u$d=NaN,u$b=-1,u$E=-1,u$O=u$W.length/2,u$q=0;u$q<u$O;u$q++)u$t=u$W[2*u$q],u$d=u$W[2*u$q+1],(.01<Math.abs(u$b-u$t)||.01<Math.abs(u$E-u$d))&&this._points.push(u$t,u$d),u$b=u$t,u$E=u$d},u$j.getData=function(u$W,u$j,u$t){var u$d=[],u$b=[];0<this.borderWidth&&this.createLine2(this._points,u$d,this.borderWidth,u$t,u$b,this._points.length/2),this.mUint16Array.set(u$d,0),this.mFloat32Array.set(u$b,0),u$W.append(this.mUint16Array),u$j.append(this.mFloat32Array)},u$E}()),u$lW=function(u$W){function u$m(u$W,u$j,u$t,u$d,u$b){this._points=[];for(var u$E=NaN,u$O=NaN,u$q=-1,u$A=-1,u$c=u$t.length/2-1,u$R=0;u$R<u$c;u$R++)u$E=u$t[2*u$R],u$O=u$t[2*u$R+1],(.01<Math.abs(u$q-u$E)||.01<Math.abs(u$A-u$O))&&this._points.push(u$E,u$O),u$q=u$E,u$A=u$O;u$E=u$t[2*u$c],u$O=u$t[2*u$c+1],u$q=this._points[0],u$A=this._points[1],(.01<Math.abs(u$q-u$E)||.01<Math.abs(u$A-u$O))&&this._points.push(u$E,u$O),u$m.__super.call(this,u$W,u$j,0,0,this._points.length/2,0,u$d,u$b)}u$Q(u$m,"laya.webgl.shapes.LoopLine",u$tW);var u$j=u$m.prototype;return u$j.getData=function(u$W,u$j,u$t){if(0<this.borderWidth){for(var u$d=this.color,u$b=(u$d>>16&255)/255,u$E=(u$d>>8&255)/255,u$O=(255&u$d)/255,u$q=[],u$A=0,u$c=0,u$R=[],u$m=Math.floor(this._points.length/2),u$Q=0;u$Q<u$m;u$Q++)u$A=this._points[2*u$Q],u$c=this._points[2*u$Q+1],u$q.push(this.x+u$A,this.y+u$c,u$b,u$E,u$O);this.createLoopLine(u$q,u$R,this.borderWidth,u$t+u$q.length/5),u$W.append(new Uint16Array(u$R)),u$j.append(new Float32Array(u$q))}},u$j.createLoopLine=function(u$W,u$j,u$t,u$d,u$b,u$E){u$W.length;var u$O=u$W.concat(),u$q=u$b||u$W,u$A=this.borderColor,u$c=(u$A>>16&255)/255,u$R=(u$A>>8&255)/255,u$m=(255&u$A)/255,u$Q=[u$O[0],u$O[1]],u$T=[u$O[u$O.length-5],u$O[u$O.length-4]],u$$=u$T[0]+.5*(u$Q[0]-u$T[0]),u$e=u$T[1]+.5*(u$Q[1]-u$T[1]);u$O.unshift(u$$,u$e,0,0,0),u$O.push(u$$,u$e,0,0,0);var u$K,u$o,u$S,u$M,u$Z,u$X,u$_,u$N,u$z,u$C,u$L,u$V,u$x,u$G,u$l,u$h,u$v,u$y,u$a,u$u,u$D=u$O.length/5,u$s=u$d,u$Y=u$t/2;u$S=u$O[0],u$M=u$O[1],u$C=u$S-(u$Z=u$O[5]),u$z=(u$z=-(u$M-(u$X=u$O[6])))/(u$u=Math.sqrt(u$z*u$z+u$C*u$C))*u$Y,u$C=u$C/u$u*u$Y,u$q.push(u$S-u$z,u$M-u$C,u$c,u$R,u$m,u$S+u$z,u$M+u$C,u$c,u$R,u$m);for(var u$H=1;u$H<u$D-1;u$H++)u$S=u$O[5*(u$H-1)],u$M=u$O[5*(u$H-1)+1],u$Z=u$O[5*u$H],u$X=u$O[5*u$H+1],u$_=u$O[5*(u$H+1)],u$N=u$O[5*(u$H+1)+1],u$C=u$S-u$Z,u$V=u$Z-u$_,u$l=(-(u$z=(u$z=-(u$M-u$X))/(u$u=Math.sqrt(u$z*u$z+u$C*u$C))*u$Y)+u$S)*(-(u$C=u$C/u$u*u$Y)+u$X)-(-u$z+u$Z)*(-u$C+u$M),u$y=(-(u$L=(u$L=-(u$X-u$N))/(u$u=Math.sqrt(u$L*u$L+u$V*u$V))*u$Y)+u$_)*(-(u$V=u$V/u$u*u$Y)+u$X)-(-u$L+u$Z)*(-u$V+u$N),u$a=(u$x=-u$C+u$M-(-u$C+u$X))*(u$v=-u$L+u$Z-(-u$L+u$_))-(u$h=-u$V+u$N-(-u$V+u$X))*(u$G=-u$z+u$Z-(-u$z+u$S)),Math.abs(u$a)<.1?(u$a+=10.1,u$q.push(u$Z-u$z,u$X-u$C,u$c,u$R,u$m,u$Z+u$z,u$X+u$C,u$c,u$R,u$m)):(((u$K=(u$G*u$y-u$v*u$l)/u$a)-u$Z)*(u$K-u$Z)+((u$o=(u$h*u$l-u$x*u$y)/u$a)-u$X)+(u$o-u$X),u$q.push(u$K,u$o,u$c,u$R,u$m,u$Z-(u$K-u$Z),u$X-(u$o-u$X),u$c,u$R,u$m));u$E&&(u$j=u$E);var u$I=this.edges+1;for(u$H=1;u$H<u$I;u$H++)u$j.push(u$s+2*(u$H-1),u$s+2*(u$H-1)+1,u$s+2*u$H+1,u$s+2*u$H+1,u$s+2*u$H,u$s+2*(u$H-1));return u$j.push(u$s+2*(u$H-1),u$s+2*(u$H-1)+1,u$s+1,u$s+1,u$s,u$s+2*(u$H-1)),u$q},u$m}(),u$hW=function(u$W){function u$O(u$W,u$j,u$t,u$d,u$b,u$E){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=u$C.create(),this._points=u$t.slice(0,u$t.length),u$O.__super.call(this,u$W,u$j,0,0,this._points.length/2,u$d,u$b,u$E)}u$Q(u$O,"laya.webgl.shapes.Polygon",u$tW);var u$j=u$O.prototype;return u$j.rebuild=function(u$W){this._repaint||(this._points.length=0,this._points=this._points.concat(u$W))},u$j.setMatrix=function(u$W){u$W.copyTo(this._mat)},u$j.needUpdate=function(u$W){return this._repaint=this._mat.a==u$W.a&&this._mat.b==u$W.b&&this._mat.c==u$W.c&&this._mat.d==u$W.d&&this._mat.tx==u$W.tx&&this._mat.ty==u$W.ty,!this._repaint},u$j.getData=function(u$W,u$j,u$t){var u$d,u$b=0,u$E=this._points,u$O=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=u$t){for(this._start=u$t,u$d=[],u$O=this.earcutTriangles.length,u$b=0;u$b<u$O;u$b++)u$d.push(this.earcutTriangles[u$b]+u$t);this.mUint16Array=new Uint16Array(u$d)}}else{this._start=u$t,u$d=[];var u$q=[],u$A=[],u$c=this.color,u$R=(u$c>>16&255)/255,u$m=(u$c>>8&255)/255,u$Q=(255&u$c)/255;for(u$O=Math.floor(u$E.length/2),u$b=0;u$b<u$O;u$b++)u$q.push(this.x+u$E[2*u$b],this.y+u$E[2*u$b+1],u$R,u$m,u$Q),u$A.push(this.x+u$E[2*u$b],this.y+u$E[2*u$b+1]);for(this.earcutTriangles=u$dW.earcut(u$A,null,2),u$O=this.earcutTriangles.length,u$b=0;u$b<u$O;u$b++)u$d.push(this.earcutTriangles[u$b]+u$t);this.mUint16Array=new Uint16Array(u$d),this.mFloat32Array=new Float32Array(u$q)}u$W.append(this.mUint16Array),u$j.append(this.mFloat32Array)},u$O}(),u$vW=function(u$W){function u$E(){this._matrix=new u$C,this._matrix4=u$eW.defaultMatrix4.concat(),u$E.__super.call(this,1e4),this.shaderValue=new u$zW(0,0)}u$Q(u$E,"laya.webgl.submit.SubmitCanvas",u$EW);var u$j=u$E.prototype;return u$j.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var u$W=u$SW.worldAlpha,u$j=u$SW.worldMatrix4,u$t=u$SW.worldMatrix,u$d=u$SW.worldFilters,u$b=u$SW.worldShaderDefines,u$E=this.shaderValue,u$O=this._matrix,u$q=this._matrix4,u$A=u$C.TEMP;return u$C.mul(u$O,u$t,u$A),u$q[0]=u$A.a,u$q[1]=u$A.b,u$q[4]=u$A.c,u$q[5]=u$A.d,u$q[12]=u$A.tx,u$q[13]=u$A.ty,u$SW.worldMatrix=u$A.clone(),u$SW.worldMatrix4=u$q,u$SW.worldAlpha=u$SW.worldAlpha*u$E.alpha,u$E.filters&&u$E.filters.length&&(u$SW.worldFilters=u$E.filters,u$SW.worldShaderDefines=u$E.defines),this._ctx_src.flush(),u$SW.worldAlpha=u$W,u$SW.worldMatrix4=u$j,u$SW.worldMatrix.destroy(),u$SW.worldMatrix=u$t,u$SW.worldFilters=u$d,u$SW.worldShaderDefines=u$b,1},u$j.releaseRender=function(){var u$W=u$E._cache;this._ctx_src=null,u$W[u$W._length++]=this},u$j.getRenderType=function(){return 10003},u$E.create=function(u$W,u$j,u$t){var u$d=u$E._cache._length?u$E._cache[--u$E._cache._length]:new u$E;u$d._ctx_src=u$W;var u$b=u$d.shaderValue;return u$b.alpha=u$j,u$b.defines.setValue(0),u$t&&u$t.length&&u$b.setFilters(u$t),u$d},u$E._cache=((u$E._cache=[])._length=0,u$E._cache),u$E}(),u$yW=function(u$W){function u$c(u$W){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===u$W&&(u$W=1e4),u$c.__super.call(this,u$W)}u$Q(u$c,"laya.webgl.submit.SubmitTexture",u$EW);var u$j=u$c.prototype;return u$j.releaseRender=function(){var u$W=u$c._cache;(u$W[u$W._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},u$j.addTexture=function(u$W,u$j){this._texsID[this._texs.length]=u$W._uvID,this._texs.push(u$W),this._vbPos.push(u$j)},u$j.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var u$W=this.shaderValue.textureHost.bitmap;if(null!==u$W)for(var u$j=this._vb.getFloat32Array(),u$t=0,u$d=this._texs.length;u$t<u$d;u$t++){var u$b=this._texs[u$t];u$b.active();var u$E=u$b.uv;if(this._texsID[u$t]!==u$b._uvID){this._texsID[u$t]=u$b._uvID;var u$O=this._vbPos[u$t];u$j[u$O+2]=u$E[0],u$j[u$O+3]=u$E[1],u$j[u$O+6]=u$E[2],u$j[u$O+7]=u$E[3],u$j[u$O+10]=u$E[4],u$j[u$O+11]=u$E[5],u$j[u$O+14]=u$E[6],u$j[u$O+15]=u$E[7],this._vb.setNeedUpload()}u$b.bitmap!==u$W&&(this._isSameTexture=!1)}}},u$j.renderSubmit=function(){if(0===this._numEle)return u$c._shaderSet=!1,1;var u$W=this.shaderValue.textureHost;if(u$W){var u$j=u$W.source;if(!u$W.bitmap||!u$j)return u$c._shaderSet=!1,1;this.shaderValue.texture=u$j,u$W.alphaTexture&&u$W.alphaTexture.source&&(this.shaderValue.texture1=u$W.alphaTexture.source)}this._vb.bind_upload(this._ib);var u$t=u$ZW.mainContext;if(u$f.activeBlendFunction!==this._blendFn&&(u$t.enable(3042),this._blendFn(u$t),u$f.activeBlendFunction=this._blendFn),u$l.drawCall++,u$l.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&u$uW.activeShader&&u$c._shaderSet?(u$uW.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&u$uW.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),u$c._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var u$d=u$W.bitmap,u$b=0,u$E=u$uW.activeShader,u$O=0,u$q=this._texs.length;u$O<u$q;u$O++){var u$A=this._texs[u$O];u$A.bitmap===u$d&&u$O+1!==u$q||(u$E.uploadTexture2D(u$A.source),u$t.drawElements(4,6*(u$O-u$b+1),5123,this._startIdx+6*u$b*u$eW.BYTES_PIDX),u$d=u$A.bitmap,u$b=u$O)}else u$t.drawElements(4,this._numEle,5123,this._startIdx);return 1},u$c.create=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$c._cache._length?u$c._cache[--u$c._cache._length]:new u$c;null==u$t&&((u$t=u$E._selfVb||(u$E._selfVb=u$FW.create(-1))).clear(),u$d=0),u$E._ib=u$j,u$E._vb=u$t,u$E._startIdx=u$d*u$eW.BYTES_PIDX,u$E._numEle=0;var u$O=u$W._nBlendType;u$E._blendFn=u$W._targets?u$f.targetFns[u$O]:u$f.fns[u$O],u$E.shaderValue=u$b,u$E.shaderValue.setValue(u$W._shader2D);var u$q=u$W._shader2D.filters;return u$q&&u$E.shaderValue.setFilters(u$q),u$E},u$c._cache=((u$c._cache=[])._length=0,u$c._cache),u$c._shaderSet=!0,u$c}(),u$aW=function(u$W){function u$o(){u$o.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}u$Q(u$o,"laya.webgl.utils.MeshTexture",u$oW);var u$j=u$o.prototype;return u$j.addData=function(u$W,u$j,u$t,u$d,u$b,u$E){for(var u$O=u$W.length/2,u$q=this._vb.needSize(u$O*u$o.const_stride)>>2,u$A=this._vb.getFloat32Array(),u$c=0,u$R=0;u$R<u$O;u$R++){var u$m=u$W[u$c],u$Q=u$W[u$c+1],u$T=u$m*u$d.a+u$Q*u$d.c+u$d.tx,u$$=u$m*u$d.b+u$Q*u$d.d+u$d.ty;u$A[u$q++]=u$T,u$A[u$q++]=u$$,u$A[u$q++]=u$j[u$c],u$A[u$q++]=u$j[u$c+1],u$c+=2}this._vb.setNeedUpload();var u$e=this.vertNum;if(0<u$e){(u$O=u$t.length)>u$o.tmpIdx.length&&(u$o.tmpIdx=new Uint16Array(u$O));for(var u$K=0;u$K<u$O;u$K++)u$o.tmpIdx[u$K]=u$t[u$K]+u$e;this._ib.appendU16Array(u$o.tmpIdx,u$t.length)}else this._ib.append(u$t);this._ib.setNeedUpload(),this.vertNum+=u$O,this.indexNum+=u$t.length},u$j.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},u$j.destroy=function(){this._ib.destroy(),this._vb.destroy()},u$o.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new u$o},u$o.const_stride=16,u$o._POOL=[],u$O(u$o,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),u$o}(),u$uW=function(u$W){function u$j(){u$j.__super.call(this),this.lock=!0}return u$Q(u$j,"laya.webgl.shader.BaseShader",u$M),u$j.activeShader=null,u$j.bindShader=null,u$j}(),u$DW=function(u$j){function u$R(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===u$t&&(u$t=6408),void 0===u$d&&(u$d=5121),void 0===u$b&&(u$b=34041),void 0===u$E&&(u$E=!1),void 0===u$O&&(u$O=!1),void 0===u$q&&(u$q=-1),void 0===u$A&&(u$A=-1),this._type=1,this._w=u$W,this._h=u$j,this._surfaceFormat=u$t,this._surfaceType=u$d,this._depthStencilFormat=u$b,u$o.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=u$E,this._repeat=u$O,this._minFifter=u$q,this._magFifter=u$A,this._createWebGLRenderTarget(),this.bitmap.lock=!0,u$R.__super.call(this,this.bitmap,u$a.INV_UV)}u$Q(u$R,"laya.webgl.resource.RenderTarget2D",u$j);var u$W=u$R.prototype;return u$_.imps(u$W,{"laya.resource.IDispose":!0}),u$W.getType=function(){return this._type},u$W.getTexture=function(){return this},u$W.size=function(u$W,u$j){this._w==u$W&&this._h==u$j||(this._w=u$W,this._h=u$j,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},u$W.release=function(){this.destroy()},u$W.recycle=function(){u$R.POOL.push(this)},u$W.start=function(){var u$W=u$ZW.mainContext;return this._preRenderTarget=u$SW.curRenderTarget,u$SW.curRenderTarget=this,u$W.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(u$W.viewport(0,0,this._w,this._h),this._svWidth=u$SW.width,this._svHeight=u$SW.height,u$SW.width=this._w,u$SW.height=this._h,u$uW.activeShader=null),this},u$W.clear=function(u$W,u$j,u$t,u$d){void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=1);var u$b=u$ZW.mainContext;u$b.clearColor(u$W,u$j,u$t,u$d);var u$E=16384;switch(this._depthStencilFormat){case 33189:u$E|=256;break;case 36168:u$E|=1024;break;case 34041:u$E|=256,u$E|=1024}u$b.clear(u$E)},u$W.end=function(){var u$W=u$ZW.mainContext;u$W.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,u$SW.curRenderTarget=this._preRenderTarget,1==this._type?(u$W.viewport(0,0,this._svWidth,this._svHeight),u$SW.width=this._svWidth,u$SW.height=this._svHeight,u$uW.activeShader=null):u$W.viewport(0,0,u$_.stage.width,u$_.stage.height)},u$W.getData=function(u$W,u$j,u$t,u$d){var u$b=u$ZW.mainContext;if(u$b.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===u$b.checkFramebufferStatus(36160)))return u$b.bindFramebuffer(36160,null),null;var u$E=new Uint8Array(this._w*this._h*4);return u$b.readPixels(u$W,u$j,u$t,u$d,this._surfaceFormat,this._surfaceType,u$E),u$b.bindFramebuffer(36160,null),u$E},u$W.destroy=function(u$W){void 0===u$W&&(u$W=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,u$j.prototype.destroy.call(this))},u$W.dispose=function(){},u$W._createWebGLRenderTarget=function(){this.bitmap=new u$rW(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(u$W){this.event("recovered")})},u$d(0,u$W,"surfaceFormat",function(){return this._surfaceFormat}),u$d(0,u$W,"magFifter",function(){return this._magFifter}),u$d(0,u$W,"surfaceType",function(){return this._surfaceType}),u$d(0,u$W,"mipMap",function(){return this._mipMap}),u$d(0,u$W,"depthStencilFormat",function(){return this._depthStencilFormat}),u$d(0,u$W,"minFifter",function(){return this._minFifter}),u$d(0,u$W,"source",function(){return this._alreadyResolved?u$_.superGet(u$a,this,"source"):null}),u$R.create=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){void 0===u$t&&(u$t=6408),void 0===u$d&&(u$d=5121),void 0===u$b&&(u$b=34041),void 0===u$E&&(u$E=!1),void 0===u$O&&(u$O=!1),void 0===u$q&&(u$q=-1),void 0===u$A&&(u$A=-1);var u$c=u$R.POOL.pop();return u$c||(u$c=new u$R(u$W,u$j)),u$c.bitmap&&u$c._w==u$W&&u$c._h==u$j&&u$c._surfaceFormat==u$t&&u$c._surfaceType==u$d&&u$c._depthStencilFormat==u$b&&u$c._mipMap==u$E&&u$c._repeat==u$O&&u$c._minFifter==u$q&&u$c._magFifter==u$A||(u$c._w=u$W,u$c._h=u$j,u$c._surfaceFormat=u$t,u$c._surfaceType=u$d,u$c._depthStencilFormat=u$b,u$o.isConchWebGL&&34041===u$c._depthStencilFormat&&(u$c._depthStencilFormat=33189),u$c._mipMap=u$E,u$c._repeat=u$O,u$c._minFifter=u$q,u$c._magFifter=u$A,u$c.release(),u$c._createWebGLRenderTarget()),u$c},u$R.TYPE2D=1,u$R.TYPE3D=2,u$R.POOL=[],u$R}(u$a),u$sW=function(u$W){function u$j(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,u$j.__super.call(this),u$j._gl=u$ZW.mainContext}u$Q(u$j,"laya.webgl.utils.Buffer",u$M);var u$t=u$j.prototype;return u$t._bind=function(){this.activeResource(),u$j._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(u$j._bindVertexBuffer=this._glBuffer),u$j._gl.bindBuffer(this._bufferType,u$j._bindActive[this._bufferType]=this._glBuffer),u$uW.activeShader=null)},u$t.recreateResource=function(){this._glBuffer||(this._glBuffer=u$j._gl.createBuffer()),this.completeCreate()},u$t.disposeResource=function(){this._glBuffer&&(u$ZW.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},u$d(0,u$t,"bufferUsage",function(){return this._bufferUsage}),u$j._gl=null,u$j._bindActive={},u$j._bindVertexBuffer=null,u$j._enableAtributes=[],u$j}(),u$YW=function(u$W){function u$t(u$W){this.texcoord=null,this.offsetX=300,this.offsetY=0,u$t.__super.call(this,512,0);var u$j=8*u$eW.BYTES_PE;this.position=[2,5126,!1,u$j,0],this.texcoord=[2,5126,!1,u$j,2*u$eW.BYTES_PE],this.color=[4,5126,!1,u$j,4*u$eW.BYTES_PE]}return u$Q(u$t,"laya.webgl.shader.d2.skinAnishader.SkinSV",u$zW),u$t}(),u$HW=function(u$W){function u$j(u$W){u$j.__super.call(this,2,0),this.color=[]}return u$Q(u$j,"laya.webgl.shader.d2.value.Color2dSV",u$zW),u$j.prototype.setValue=function(u$W){u$W.fillStyle&&(this.color=u$W.fillStyle._color._color),u$W.strokeStyle&&(this.color=u$W.strokeStyle._color._color)},u$j}(),u$IW=function(u$W){function u$j(u$W){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=u$zW._TEXCOORD,u$j.__super.call(this,256,0)}u$Q(u$j,"laya.webgl.shader.d2.value.FillTextureSV",u$zW);var u$t=u$j.prototype;return u$t.setValue=function(u$W){this.ALPHA=u$W.ALPHA,u$W.filters&&this.setFilters(u$W.filters)},u$t.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},u$j}(),u$gW=function(u$W){function u$j(u$W){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=u$zW._TEXCOORD,void 0===u$W&&(u$W=0),u$j.__super.call(this,1,u$W)}u$Q(u$j,"laya.webgl.shader.d2.value.TextureSV",u$zW);var u$t=u$j.prototype;return u$t.setValue=function(u$W){this.ALPHA=u$W.ALPHA,u$W.filters&&this.setFilters(u$W.filters)},u$t.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},u$j}(),u$fW=function(u$W){function u$j(u$W){this.a_color=null,this.u_pos=[0,0],u$j.__super.call(this,4,0),this.position=[2,5126,!1,5*u$eW.BYTES_PE,0],this.a_color=[3,5126,!1,5*u$eW.BYTES_PE,2*u$eW.BYTES_PE]}return u$Q(u$j,"laya.webgl.shader.d2.value.PrimitiveSV",u$zW),u$j}(),u$wW=function(u$W){function u$j(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,u$j.__super.call(this)}u$Q(u$j,"laya.webgl.atlas.AtlasWebGLCanvas",u$W);var u$t=u$j.prototype;return u$t.recreateResource=function(){var u$W=u$ZW.mainContext,u$j=this._source=u$W.createTexture(),u$t=u$XW.curBindTexTarget,u$d=u$XW.curBindTexValue;u$XW.bindTexture(u$W,3553,u$j),u$W.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),u$W.texParameteri(3553,10241,9729),u$W.texParameteri(3553,10240,9729),u$W.texParameteri(3553,10242,33071),u$W.texParameteri(3553,10243,33071),u$t&&u$d&&u$XW.bindTexture(u$W,u$t,u$d),this.memorySize=this._w*this._h*4,this.completeCreate()},u$t.disposeResource=function(){this._source&&(u$ZW.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},u$t.texSubImage2D=function(u$W,u$j,u$t){if(u$o.isFlash){this._flashCacheImage||(this._flashCacheImage=u$e.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var u$d=u$t.bitmapdata;this._flashCacheImage._image.copyPixels(u$d,0,0,u$d.width,u$d.height,u$W,u$j),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var u$b=u$ZW.mainContext,u$E=u$XW.curBindTexTarget,u$O=u$XW.curBindTexValue;u$XW.bindTexture(u$b,3553,this._source),u$b.pixelStorei(37441,!0),0<=u$W-1&&u$b.texSubImage2D(3553,0,u$W-1,u$j,6408,5121,u$t),u$W+1<=this._w&&u$b.texSubImage2D(3553,0,u$W+1,u$j,6408,5121,u$t),0<=u$j-1&&u$b.texSubImage2D(3553,0,u$W,u$j-1,6408,5121,u$t),u$j+1<=this._h&&u$b.texSubImage2D(3553,0,u$W,u$j+1,6408,5121,u$t),u$b.texSubImage2D(3553,0,u$W,u$j,6408,5121,u$t),u$b.pixelStorei(37441,!1),u$E&&u$O&&u$XW.bindTexture(u$b,u$E,u$O)}},u$t.texSubImage2DPixel=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$ZW.mainContext,u$O=u$XW.curBindTexTarget,u$q=u$XW.curBindTexValue;u$XW.bindTexture(u$E,3553,this._source);var u$A=new Uint8Array(u$b.data);u$E.pixelStorei(37441,!0),u$E.texSubImage2D(3553,0,u$W,u$j,u$t,u$d,6408,5121,u$A),u$E.pixelStorei(37441,!1),u$O&&u$q&&u$XW.bindTexture(u$E,u$O,u$q)},u$d(0,u$t,"width",u$W.prototype._$get_width,function(u$W){this._w=u$W}),u$d(0,u$t,"height",u$W.prototype._$get_height,function(u$W){this._h=u$W}),u$j}(u$t),u$UW=function(u$W){function u$b(){this.flipY=!0,this.alwaysChange=!1,u$b.__super.call(this)}u$Q(u$b,"laya.webgl.resource.WebGLCanvas",u$t);var u$j=u$b.prototype;return u$j.getCanvas=function(){return this._canvas},u$j.clear=function(){this._ctx&&this._ctx.clear()},u$j.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},u$j._setContext=function(u$W){this._ctx=u$W},u$j.getContext=function(u$W,u$j){return this._ctx?this._ctx:this._ctx=u$b._createContext(this)},u$j.size=function(u$W,u$j){this._w==u$W&&this._h==u$j||(this._w=u$W,this._h=u$j,this._ctx&&this._ctx.size(u$W,u$j),this._canvas&&(this._canvas.height=u$j,this._canvas.width=u$W))},u$j.activeResource=function(u$W){void 0===u$W&&(u$W=!1),this._source||this.recreateResource()},u$j.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},u$j.disposeResource=function(){this._source&&!this.iscpuSource&&(u$ZW.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},u$j.createWebGlTexture=function(){var u$W=u$ZW.mainContext;this._canvas;var u$j=this._source=u$W.createTexture();this.iscpuSource=!1;var u$t=u$XW.curBindTexTarget,u$d=u$XW.curBindTexValue;u$XW.bindTexture(u$W,3553,u$j),u$W.pixelStorei(37440,this.flipY?1:0),u$b.premulAlpha&&u$W.pixelStorei(37441,!0),u$W.texImage2D(3553,0,6408,6408,5121,this._imgData),u$b.premulAlpha&&u$W.pixelStorei(37441,!1),u$W.texParameteri(3553,10240,9729),u$W.texParameteri(3553,10241,9729),u$W.texParameteri(3553,10242,33071),u$W.texParameteri(3553,10243,33071),u$W.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,u$t&&u$d&&u$XW.bindTexture(u$W,u$t,u$d)},u$j.reloadCanvasData=function(){var u$W=u$ZW.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var u$j=u$XW.curBindTexTarget,u$t=u$XW.curBindTexValue;u$XW.bindTexture(u$W,3553,this._source),u$b.premulAlpha&&u$W.pixelStorei(37441,!0),u$W.texImage2D(3553,0,6408,6408,5121,this._imgData),u$b.premulAlpha&&u$W.pixelStorei(37441,!1),u$W.pixelStorei(37440,0),u$j&&u$t&&u$XW.bindTexture(u$W,u$j,u$t)},u$j.texSubImage2D=function(u$W,u$j,u$t){var u$d=u$ZW.mainContext,u$b=u$XW.curBindTexTarget,u$E=u$XW.curBindTexValue;u$XW.bindTexture(u$d,3553,this._source),u$d.pixelStorei(37441,!0),u$d.texSubImage2D(3553,0,u$j,u$t,6408,5121,u$W._source),u$d.pixelStorei(37441,!1),u$b&&u$E&&u$XW.bindTexture(u$d,u$b,u$E)},u$j.toBase64=function(u$W,u$j,u$t){var u$d=null;this._canvas&&(u$d=this._canvas.toDataURL(u$W,u$j)),u$t.call(this,u$d)},u$d(0,u$j,"context",function(){return this._ctx}),u$d(0,u$j,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),u$d(0,u$j,"asBitmap",null,function(u$W){this._ctx&&(this._ctx.asBitmap=u$W)}),u$b._createContext=null,u$b.premulAlpha=!1,u$b}(),u$JW=function(u$W){function u$E(u$W,u$j){this.CborderSize=12,u$E.__super.call(this),this.char=u$W,this.isSpace=" "===u$W,this.xs=u$j.scaleX,this.ys=u$j.scaleY,this.font=u$j.font.toString(),this.fontSize=u$j.font.size,this.fillColor=u$j.fillColor,this.borderColor=u$j.borderColor,this.lineWidth=u$j.lineWidth,this.underLine=u$j.underLine;var u$t,u$d=u$o.isConchApp;u$d?((u$t=ConchTextCanvas)._source=ConchTextCanvas,u$t._source.canvas=ConchTextCanvas):u$t=u$T.canvas.source,this.canvas=u$t,this._enableMerageInAtlas=!0,this._ctx=u$d?u$t:this.canvas.getContext("2d",void 0);var u$b=u$u.measureText(this.char,this.font);this.cw=u$b.width*this.xs,this.ch=(u$b.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new u$a(this)}u$Q(u$E,"laya.webgl.resource.WebGLCharImage",u$t);var u$j=u$E.prototype;return u$_.imps(u$j,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),u$j.active=function(){this.texture.active()},u$j.recreateResource=function(){var u$W=u$o.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),u$W){var u$j=this.fontSize;1==this.xs&&1==this.ys||(u$j=parseInt(u$j*(this.xs>this.ys?this.xs:this.ys)+""));var u$t="normal 100 "+this.font;u$t=u$t.replace(u$E._fontSizeReg,u$j),this.borderColor&&(u$t+=" 1 "+this.borderColor),this._ctx.font=u$t,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,u$y.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var u$d=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(u$d,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},u$j.onresize=function(u$W,u$j){this._w=u$W,this._h=u$j,this._allowMerageInAtlas=!0},u$j.clearAtlasSource=function(){},u$d(0,u$j,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),u$d(0,u$j,"atlasSource",function(){return this.canvas}),u$d(0,u$j,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(u$W){this._enableMerageInAtlas=u$W}),u$E.createOneChar=function(u$W,u$j){return new u$E(u$W,u$j)},u$E._fontSizeReg=new RegExp("\\d+(?=px)","g"),u$E}(),u$rW=function(u$W){function u$c(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){void 0===u$t&&(u$t=6408),void 0===u$d&&(u$d=5121),void 0===u$b&&(u$b=34041),void 0===u$E&&(u$E=!1),void 0===u$O&&(u$O=!1),void 0===u$q&&(u$q=-1),void 0===u$A&&(u$A=1),u$c.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=u$W,this._h=u$j,this._surfaceFormat=u$t,this._surfaceType=u$d,this._depthStencilFormat=u$b,this._mipMap=u$E,this._repeat=u$O,this._minFifter=u$q,this._magFifter=u$A}u$Q(u$c,"laya.webgl.resource.WebGLRenderTarget",u$t);var u$j=u$c.prototype;return u$j.recreateResource=function(){var u$W=u$ZW.mainContext;this._frameBuffer||(this._frameBuffer=u$W.createFramebuffer()),this._source||(this._source=u$W.createTexture());var u$j=u$XW.curBindTexTarget,u$t=u$XW.curBindTexValue;u$XW.bindTexture(u$W,3553,this._source),u$W.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var u$d=this._minFifter,u$b=this._magFifter,u$E=this._repeat?10497:33071,u$O=u$R.isPOT(this._w,this._h);if(u$O?(this._mipMap?-1!==u$d||(u$d=9987):-1!==u$d||(u$d=9729),-1!==u$b||(u$b=9729),u$W.texParameteri(3553,10241,u$d),u$W.texParameteri(3553,10240,u$b),u$W.texParameteri(3553,10242,u$E),u$W.texParameteri(3553,10243,u$E),this._mipMap&&u$W.generateMipmap(3553)):(-1!==u$d||(u$d=9729),-1!==u$b||(u$b=9729),u$W.texParameteri(3553,10241,u$d),u$W.texParameteri(3553,10240,u$b),u$W.texParameteri(3553,10242,33071),u$W.texParameteri(3553,10243,33071)),u$W.bindFramebuffer(36160,this._frameBuffer),u$W.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=u$W.createRenderbuffer()),u$W.bindRenderbuffer(36161,this._depthStencilBuffer),u$W.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:u$W.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:u$W.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:u$W.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}u$W.bindFramebuffer(36160,null),u$j&&u$t&&u$XW.bindTexture(u$W,u$j,u$t),u$W.bindRenderbuffer(36161,null),u$O&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},u$j.disposeResource=function(){this._frameBuffer&&(u$ZW.mainContext.deleteTexture(this._source),u$ZW.mainContext.deleteFramebuffer(this._frameBuffer),u$ZW.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},u$d(0,u$j,"depthStencilBuffer",function(){return this._depthStencilBuffer}),u$d(0,u$j,"frameBuffer",function(){return this._frameBuffer}),u$c}(),u$PW=function(u$W){function u$q(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this.offsetX=0,this.offsetY=0,u$q.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=u$E,this.canvas=u$W,this._ctx=u$W.getContext("2d",void 0),this._w=u$d,this._h=u$b,this.offsetX=u$j,this.offsetY=u$t,this.src=u$O,this._enableMerageInAtlas=!0,u$I.enabled&&this._w<u$I.atlasLimitWidth&&this._h<u$I.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}u$Q(u$q,"laya.webgl.resource.WebGLSubImage",u$t);var u$j=u$q.prototype;return u$_.imps(u$j,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),u$j.size=function(u$W,u$j){this._w=u$W,this._h=u$j,this._ctx&&this._ctx.size(u$W,u$j),this.canvas&&(this.canvas.height=u$j,this.canvas.width=u$W)},u$j.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},u$j.createWebGlTexture=function(){var u$W=u$ZW.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var u$j=this._source=u$W.createTexture(),u$t=u$XW.curBindTexTarget,u$d=u$XW.curBindTexValue;u$XW.bindTexture(u$W,3553,u$j),u$W.pixelStorei(37441,!0),u$W.texImage2D(3553,0,6408,6408,5121,this.canvas),u$W.pixelStorei(37441,!1);var u$b=this.minFifter,u$E=this.magFifter,u$O=this.repeat?10497:33071,u$q=u$R.isPOT(this.width,this.height);u$q?(this.mipmap?-1!==u$b||(u$b=9987):-1!==u$b||(u$b=9729),-1!==u$E||(u$E=9729),u$W.texParameteri(3553,10240,u$E),u$W.texParameteri(3553,10241,u$b),u$W.texParameteri(3553,10242,u$O),u$W.texParameteri(3553,10243,u$O),this.mipmap&&u$W.generateMipmap(3553)):(-1!==u$b||(u$b=9729),-1!==u$E||(u$E=9729),u$W.texParameteri(3553,10241,u$b),u$W.texParameteri(3553,10240,u$E),u$W.texParameteri(3553,10242,33071),u$W.texParameteri(3553,10243,33071)),u$t&&u$d&&u$XW.bindTexture(u$W,u$t,u$d),this.canvas=null,u$q&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},u$j.disposeResource=function(){u$I.enabled&&this._allowMerageInAtlas||!this._source||(u$ZW.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},u$j.clearAtlasSource=function(){},u$d(0,u$j,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),u$d(0,u$j,"atlasSource",function(){return this.canvas}),u$d(0,u$j,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(u$W){this._allowMerageInAtlas=u$W}),u$q}(),u$iW=function(u$W){function u$c(u$W,u$j,u$t,u$d){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,u$c.__super.call(this),!u$W||!u$j)throw"Shader Error";this._id=++u$c._count,this._vs=u$W,this._ps=u$j,this._nameMap=u$d||{},null!=u$t&&(u$c.sharders[u$t]=this)}u$Q(u$c,"laya.webgl.shader.Shader",u$uW);var u$j=u$c.prototype;return u$j.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},u$j.disposeResource=function(){u$ZW.mainContext.deleteShader(this._vshader),u$ZW.mainContext.deleteShader(this._pshader),u$ZW.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},u$j._compile=function(){if(!u$ZW.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var u$W=[this._vs,this._ps],u$j=u$ZW.mainContext;if(this._program=u$j.createProgram(),this._vshader=u$c._createShader(u$j,u$W[0],35633),this._pshader=u$c._createShader(u$j,u$W[1],35632),u$j.attachShader(this._program,this._vshader),u$j.attachShader(this._program,this._pshader),u$j.linkProgram(this._program),!u$o.isConchApp&&!u$j.getProgramParameter(this._program,35714))throw u$j.getProgramInfoLog(this._program);var u$t,u$d,u$b=0,u$E=0;for(u$E=u$o.isConchApp?u$j.getProgramParameterEx(this._vs,this._ps,"",35721):u$j.getProgramParameter(this._program,35721),u$b=0;u$b<u$E;u$b++){var u$O=null;u$t={vartype:"attribute",glfun:null,ivartype:0,attrib:u$O=u$o.isConchApp?u$j.getActiveAttribEx(this._vs,this._ps,"",u$b):u$j.getActiveAttrib(this._program,u$b),location:u$j.getAttribLocation(this._program,u$O.name),name:u$O.name,type:u$O.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(u$t)}var u$q=0;for(u$q=u$o.isConchApp?u$j.getProgramParameterEx(this._vs,this._ps,"",35718):u$j.getProgramParameter(this._program,35718),u$b=0;u$b<u$q;u$b++){var u$A=null;u$A=u$o.isConchApp?u$j.getActiveUniformEx(this._vs,this._ps,"",u$b):u$j.getActiveUniform(this._program,u$b),0<(u$t={vartype:"uniform",glfun:null,ivartype:1,attrib:u$O,location:u$j.getUniformLocation(this._program,u$A.name),name:u$A.name,type:u$A.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(u$t.name=u$t.name.substr(0,u$t.name.length-3),u$t.isArray=!0,u$t.location=u$j.getUniformLocation(this._program,u$t.name)),this._params.push(u$t)}for(u$b=0,u$d=this._params.length;u$b<u$d;u$b++)if((u$t=this._params[u$b]).indexOfParams=u$b,u$t.index=1,u$t.value=[u$t.location,null],u$t.codename=u$t.name,u$t.name=this._nameMap[u$t.codename]?this._nameMap[u$t.codename]:u$t.codename,(this._paramsMap[u$t.name]=u$t)._this=this,u$t.uploadedValue=[],"attribute"!==u$t.vartype)switch(u$t.type){case 5124:u$t.fun=u$t.isArray?this._uniform1iv:this._uniform1i;break;case 5126:u$t.fun=u$t.isArray?this._uniform1fv:this._uniform1f;break;case 35664:u$t.fun=u$t.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:u$t.fun=u$t.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:u$t.fun=u$t.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:u$t.fun=this._uniform_sampler2D;break;case 35680:u$t.fun=this._uniform_samplerCube;break;case 35676:u$t.glfun=u$j.uniformMatrix4fv,u$t.fun=this._uniformMatrix4fv;break;case 35670:u$t.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else u$t.fun=this._attribute}},u$j.getUniform=function(u$W){return this._paramsMap[u$W]},u$j._attribute=function(u$W,u$j){var u$t=u$ZW.mainContext,u$d=u$sW._enableAtributes,u$b=u$W.location;return u$d[u$b]||u$t.enableVertexAttribArray(u$b),u$t.vertexAttribPointer(u$b,u$j[0],u$j[1],u$j[2],u$j[3],u$j[4]+this._offset),u$d[u$b]=u$sW._bindVertexBuffer,1},u$j._uniform1f=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j?(u$ZW.mainContext.uniform1f(u$W.location,u$t[0]=u$j),1):0},u$j._uniform1fv=function(u$W,u$j){if(u$j.length<4){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]||u$t[2]!==u$j[2]||u$t[3]!==u$j[3]?(u$ZW.mainContext.uniform1fv(u$W.location,u$j),u$t[0]=u$j[0],u$t[1]=u$j[1],u$t[2]=u$j[2],u$t[3]=u$j[3],1):0}return u$ZW.mainContext.uniform1fv(u$W.location,u$j),1},u$j._uniform_vec2=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]?(u$ZW.mainContext.uniform2f(u$W.location,u$t[0]=u$j[0],u$t[1]=u$j[1]),1):0},u$j._uniform_vec2v=function(u$W,u$j){if(u$j.length<2){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]||u$t[2]!==u$j[2]||u$t[3]!==u$j[3]?(u$ZW.mainContext.uniform2fv(u$W.location,u$j),u$t[0]=u$j[0],u$t[1]=u$j[1],u$t[2]=u$j[2],u$t[3]=u$j[3],1):0}return u$ZW.mainContext.uniform2fv(u$W.location,u$j),1},u$j._uniform_vec3=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]||u$t[2]!==u$j[2]?(u$ZW.mainContext.uniform3f(u$W.location,u$t[0]=u$j[0],u$t[1]=u$j[1],u$t[2]=u$j[2]),1):0},u$j._uniform_vec3v=function(u$W,u$j){return u$ZW.mainContext.uniform3fv(u$W.location,u$j),1},u$j._uniform_vec4=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]||u$t[2]!==u$j[2]||u$t[3]!==u$j[3]?(u$ZW.mainContext.uniform4f(u$W.location,u$t[0]=u$j[0],u$t[1]=u$j[1],u$t[2]=u$j[2],u$t[3]=u$j[3]),1):0},u$j._uniform_vec4v=function(u$W,u$j){return u$ZW.mainContext.uniform4fv(u$W.location,u$j),1},u$j._uniformMatrix2fv=function(u$W,u$j){return u$ZW.mainContext.uniformMatrix2fv(u$W.location,!1,u$j),1},u$j._uniformMatrix3fv=function(u$W,u$j){return u$ZW.mainContext.uniformMatrix3fv(u$W.location,!1,u$j),1},u$j._uniformMatrix4fv=function(u$W,u$j){return u$ZW.mainContext.uniformMatrix4fv(u$W.location,!1,u$j),1},u$j._uniform1i=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j?(u$ZW.mainContext.uniform1i(u$W.location,u$t[0]=u$j),1):0},u$j._uniform1iv=function(u$W,u$j){return u$ZW.mainContext.uniform1iv(u$W.location,u$j),1},u$j._uniform_ivec2=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]?(u$ZW.mainContext.uniform2i(u$W.location,u$t[0]=u$j[0],u$t[1]=u$j[1]),1):0},u$j._uniform_ivec2v=function(u$W,u$j){return u$ZW.mainContext.uniform2iv(u$W.location,u$j),1},u$j._uniform_vec3i=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]||u$t[2]!==u$j[2]?(u$ZW.mainContext.uniform3i(u$W.location,u$t[0]=u$j[0],u$t[1]=u$j[1],u$t[2]=u$j[2]),1):0},u$j._uniform_vec3vi=function(u$W,u$j){return u$ZW.mainContext.uniform3iv(u$W.location,u$j),1},u$j._uniform_vec4i=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]||u$t[2]!==u$j[2]||u$t[3]!==u$j[3]?(u$ZW.mainContext.uniform4i(u$W.location,u$t[0]=u$j[0],u$t[1]=u$j[1],u$t[2]=u$j[2],u$t[3]=u$j[3]),1):0},u$j._uniform_vec4vi=function(u$W,u$j){return u$ZW.mainContext.uniform4iv(u$W.location,u$j),1},u$j._uniform_sampler2D=function(u$W,u$j){var u$t=u$ZW.mainContext,u$d=u$W.uploadedValue;return null==u$d[0]?(u$d[0]=this._curActTexIndex,u$t.uniform1i(u$W.location,this._curActTexIndex),u$t.activeTexture(u$c._TEXTURES[this._curActTexIndex]),u$XW.bindTexture(u$t,3553,u$j),this._curActTexIndex++,1):(u$t.activeTexture(u$c._TEXTURES[u$d[0]]),u$XW.bindTexture(u$t,3553,u$j),0)},u$j._uniform_samplerCube=function(u$W,u$j){var u$t=u$ZW.mainContext,u$d=u$W.uploadedValue;return null==u$d[0]?(u$d[0]=this._curActTexIndex,u$t.uniform1i(u$W.location,this._curActTexIndex),u$t.activeTexture(u$c._TEXTURES[this._curActTexIndex]),u$XW.bindTexture(u$t,34067,u$j),this._curActTexIndex++,1):(u$t.activeTexture(u$c._TEXTURES[u$d[0]]),u$XW.bindTexture(u$t,34067,u$j),0)},u$j._noSetValue=function(u$W){console.log("no....:"+u$W.name)},u$j.uploadOne=function(u$W,u$j){this.activeResource(),u$XW.UseProgram(this._program);var u$t=this._paramsMap[u$W];u$t.fun.call(this,u$t,u$j)},u$j.uploadTexture2D=function(u$W){u$l.shaderCall++;var u$j=u$ZW.mainContext;u$j.activeTexture(33984),u$XW.bindTexture(u$j,3553,u$W)},u$j.uploadTexture2D1=function(u$W){u$l.shaderCall++;var u$j=u$ZW.mainContext;u$j.activeTexture(33985),u$XW.bindTexture(u$j,3553,u$W)},u$j.upload=function(u$W,u$j){u$uW.activeShader=u$uW.bindShader=this,this._lastUseFrameCount===u$l.loopCount||this.activeResource(),u$XW.UseProgram(this._program),this._reCompile?(u$j=this._params,this._reCompile=!1):u$j=u$j||this._params;u$ZW.mainContext;for(var u$t,u$d,u$b=u$j.length,u$E=0,u$O=0;u$O<u$b;u$O++)null!==(u$d=u$W[(u$t=u$j[u$O]).name])&&(u$E+=u$t.fun.call(this,u$t,u$d));u$l.shaderCall+=u$E},u$j.uploadArray=function(u$W,u$j,u$t){u$uW.activeShader=this,(u$uW.bindShader=this).activeResource(),u$XW.UseProgram(this._program);this._params;for(var u$d,u$b,u$E=0,u$O=u$j-2;0<=u$O;u$O-=2)(u$b=this._paramsMap[u$W[u$O]])&&null!=(u$d=u$W[u$O+1])&&(u$t&&u$t[u$b.name]&&u$t[u$b.name].bind(),u$E+=u$b.fun.call(this,u$b,u$d));u$l.shaderCall+=u$E},u$j.getParams=function(){return this._params},u$c.getShader=function(u$W){return u$c.sharders[u$W]},u$c.create=function(u$W,u$j,u$t,u$d){return new u$c(u$W,u$j,u$t,u$d)},u$c.withCompile=function(u$W,u$j,u$t,u$d){if(u$t&&u$c.sharders[u$t])return u$c.sharders[u$t];var u$b=u$c._preCompileShader[2e-4*u$W];if(!u$b)throw new Error("withCompile shader err!"+u$W);return u$b.createShader(u$j,u$t,u$d)},u$c.withCompile2D=function(u$W,u$j,u$t,u$d,u$b){if(u$d&&u$c.sharders[u$d])return u$c.sharders[u$d];var u$E=u$c._preCompileShader[2e-4*u$W+u$j];if(!u$E)throw new Error("withCompile shader err!"+u$W+" "+u$j);return u$E.createShader(u$t,u$d,u$b)},u$c.addInclude=function(u$W,u$j){u$MW.addInclude(u$W,u$j)},u$c.preCompile=function(u$W,u$j,u$t,u$d){var u$b=2e-4*u$W;u$c._preCompileShader[u$b]=new u$MW(u$b,u$j,u$t,u$d)},u$c.preCompile2D=function(u$W,u$j,u$t,u$d,u$b){var u$E=2e-4*u$W+u$j;u$c._preCompileShader[u$E]=new u$MW(u$E,u$t,u$d,u$b)},u$c._createShader=function(u$W,u$j,u$t){var u$d=u$W.createShader(u$t);return u$W.shaderSource(u$d,u$j),u$W.compileShader(u$d),u$d},u$c._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],u$c._count=0,u$c._preCompileShader={},u$c.SHADERNAME2ID=2e-4,u$c.sharders=((u$c.sharders=[]).length=32,u$c.sharders),u$O(u$c,["nameKey",function(){return this.nameKey=new u$h}]),u$c}(),u$BW=function(u$W){function u$j(){this._maxsize=0,this._upload=!0,this._uploadSize=0,u$j.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}u$Q(u$j,"laya.webgl.utils.Buffer2D",u$W);var u$t=u$j.prototype;return u$t.needSize=function(u$W){var u$j=this._byteLength;if(u$W){var u$t=this._byteLength+u$W;u$t<=this._buffer.byteLength||this._resizeBuffer(u$t<<1,!0),this._byteLength=u$t}return u$j},u$t._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),u$l.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,u$sW._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),u$sW._gl.bufferSubData(this._bufferType,0,this._buffer)},u$t._bufferSubData=function(u$W,u$j,u$t){if(void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),this._maxsize=Math.max(this._maxsize,this._byteLength),u$l.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,u$sW._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),u$j||u$t){var u$d=this._buffer.slice(u$j,u$t);u$sW._gl.bufferSubData(this._bufferType,u$W,u$d)}else u$sW._gl.bufferSubData(this._bufferType,u$W,this._buffer)},u$t._checkArrayUse=function(){},u$t._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},u$t._bind_subUpload=function(u$W,u$j,u$t){return void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(u$W,u$j,u$t),!0)},u$t._resizeBuffer=function(u$W,u$j){if(u$W<this._buffer.byteLength)return this;if(this.memorySize=u$W,u$j&&this._buffer&&0<this._buffer.byteLength){var u$t=new ArrayBuffer(u$W);new Uint8Array(u$t).set(new Uint8Array(this._buffer),0),this._buffer=u$t}else this._buffer=new ArrayBuffer(u$W);return this._checkArrayUse(),this._upload=!0,this},u$t.append=function(u$W){this._upload=!0;var u$j,u$t;u$j=u$W.byteLength,u$W instanceof Uint8Array?(this._resizeBuffer(this._byteLength+u$j,!0),u$t=new Uint8Array(this._buffer,this._byteLength)):u$W instanceof Uint16Array?(this._resizeBuffer(this._byteLength+u$j,!0),u$t=new Uint16Array(this._buffer,this._byteLength)):u$W instanceof Float32Array&&(this._resizeBuffer(this._byteLength+u$j,!0),u$t=new Float32Array(this._buffer,this._byteLength)),u$t.set(u$W,0),this._byteLength+=u$j,this._checkArrayUse()},u$t.appendU16Array=function(u$W,u$j){this._resizeBuffer(this._byteLength+2*u$j,!0);for(var u$t=new Uint16Array(this._buffer,this._byteLength,u$j),u$d=0;u$d<u$j;u$d++)u$t[u$d]=u$W[u$d];this._byteLength+=2*u$j,this._checkArrayUse()},u$t.appendEx=function(u$W,u$j){this._upload=!0;var u$t;u$t=u$W.byteLength,this._resizeBuffer(this._byteLength+u$t,!0),new u$j(this._buffer,this._byteLength).set(u$W,0),this._byteLength+=u$t,this._checkArrayUse()},u$t.appendEx2=function(u$W,u$j,u$t,u$d){void 0===u$d&&(u$d=1),this._upload=!0;var u$b,u$E;u$b=u$t*u$d,this._resizeBuffer(this._byteLength+u$b,!0),u$E=new u$j(this._buffer,this._byteLength);var u$O=0;for(u$O=0;u$O<u$t;u$O++)u$E[u$O]=u$W[u$O];this._byteLength+=u$b,this._checkArrayUse()},u$t.getBuffer=function(){return this._buffer},u$t.setNeedUpload=function(){this._upload=!0},u$t.getNeedUpload=function(){return this._upload},u$t.upload=function(){var u$W=this._bind_upload();return u$sW._gl.bindBuffer(this._bufferType,null),u$sW._bindActive[this._bufferType]=null,u$uW.activeShader=null,u$W},u$t.subUpload=function(u$W,u$j,u$t){void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0);var u$d=this._bind_subUpload();return u$sW._gl.bindBuffer(this._bufferType,null),u$sW._bindActive[this._bufferType]=null,u$uW.activeShader=null,u$d},u$t.disposeResource=function(){u$W.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},u$t.clear=function(){this._byteLength=0,this._upload=!0},u$d(0,u$t,"bufferLength",function(){return this._buffer.byteLength}),u$d(0,u$t,"byteLength",null,function(u$W){this._byteLength!==u$W&&(u$W<=this._buffer.byteLength||this._resizeBuffer(2*u$W+256,!0),this._byteLength=u$W)}),u$j.__int__=function(u$W){u$pW.QuadrangleIB=u$pW.create(35044),u$KW.fillIBQuadrangle(u$pW.QuadrangleIB,16)},u$j.FLOAT32=4,u$j.SHORT=2,u$j}(u$sW),u$nW=(function(u$j){function u$t(u$W){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,u$t.__super.call(this,9)}u$Q(u$t,"laya.webgl.shader.d2.value.GlowSV",u$j);var u$W=u$t.prototype;u$W.setValue=function(u$W){u$j.prototype.setValue.call(this,u$W)},u$W.clear=function(){u$j.prototype.clear.call(this)}}(u$gW),function(u$W){function u$j(u$W){u$j.__super.call(this,64),this.defines.add(64)}u$Q(u$j,"laya.webgl.shader.d2.value.TextSV",u$W);var u$t=u$j.prototype;return u$t.release=function(){(u$j.pool[u$j._length++]=this).clear()},u$t.clear=function(){u$W.prototype.clear.call(this)},u$j.create=function(){return u$j._length?u$j.pool[--u$j._length]:new u$j(null)},u$j.pool=[],u$j._length=0,u$j}(u$gW)),u$kW=function(u$W){function u$b(u$W,u$j,u$t,u$d){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,u$b.__super.call(this,u$W,u$j,u$t,u$d)}u$Q(u$b,"laya.webgl.shader.d2.Shader2X",u$W);var u$j=u$b.prototype;return u$j.upload2dQuick1=function(u$W){this.upload(u$W,this._params2dQuick1||this._make2dQuick1())},u$j._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var u$W,u$j=this._params,u$t=0,u$d=u$j.length;u$t<u$d;u$t++)u$W=u$j[u$t],(u$o.isFlash||"size"!==u$W.name&&"position"!==u$W.name&&"texcoord"!==u$W.name)&&this._params2dQuick1.push(u$W)}return this._params2dQuick1},u$j.disposeResource=function(){u$W.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},u$j.upload2dQuick2=function(u$W){this.upload(u$W,this._params2dQuick2||this._make2dQuick2())},u$j._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var u$W,u$j=this._params,u$t=0,u$d=u$j.length;u$t<u$d;u$t++)u$W=u$j[u$t],(u$o.isFlash||"size"!==u$W.name)&&this._params2dQuick2.push(u$W)}return this._params2dQuick2},u$b.create=function(u$W,u$j,u$t,u$d){return new u$b(u$W,u$j,u$t,u$d)},u$b}(u$iW),u$pW=function(u$W){function u$j(u$W){this._uint8Array=null,this._uint16Array=null,void 0===u$W&&(u$W=35044),u$j.__super.call(this),this._bufferUsage=u$W,this._bufferType=34963,u$o.isFlash||(this._buffer=new ArrayBuffer(8))}u$Q(u$j,"laya.webgl.utils.IndexBuffer2D",u$BW);var u$t=u$j.prototype;return u$t._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},u$t.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},u$t.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},u$t.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},u$j.QuadrangleIB=null,u$j.create=function(u$W){return void 0===u$W&&(u$W=35044),new u$j(u$W)},u$j}(),u$FW=function(u$W){function u$t(u$W,u$j){this._floatArray32=null,this._vertexStride=0,u$t.__super.call(this),this._vertexStride=u$W,this._bufferUsage=u$j,this._bufferType=34962,u$o.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}u$Q(u$t,"laya.webgl.utils.VertexBuffer2D",u$W);var u$j=u$t.prototype;return u$j.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},u$j.bind=function(u$W){u$W&&u$W._bind(),this._bind()},u$j.insertData=function(u$W,u$j){this.getFloat32Array().set(u$W,u$j),this._upload=!0},u$j.bind_upload=function(u$W){u$W._bind_upload()||u$W._bind(),this._bind_upload()||this._bind()},u$j._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},u$j.disposeResource=function(){u$W.prototype.disposeResource.call(this)},u$j.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},u$d(0,u$j,"vertexStride",function(){return this._vertexStride}),u$t.create=function(u$W,u$j){return void 0===u$j&&(u$j=35048),new u$t(u$W,u$j)},u$t}(u$BW),u$Wj=function(u$W){function u$q(u$W,u$j,u$t,u$d,u$b,u$E){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===u$t&&(u$t=6408),void 0===u$d&&(u$d=!0),u$q.__super.call(this,u$W,u$j),u$W){if(this._format=u$t,this._mipmap=u$d,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof u$W)this._url=u$W,this._src=u$W,this._image=new u$T.window.Image,u$j&&(u$j.onload&&(this.onload=u$j.onload),u$j.onerror&&(this.onerror=u$j.onerror),u$j.onCreate&&u$j.onCreate(this)),this._image.crossOrigin=u$W&&0==u$W.indexOf("data:")?null:"",u$W&&(this._image.src=u$W);else if(u$W instanceof ArrayBuffer){this._src=u$j,this._url=this._src;var u$O=new u$A(u$W);u$O.readUTFBytes(4),u$O.readUTFBytes(2),u$O.getInt16();u$O.endian="bigEndian",this._w=u$O.getInt16(),this._h=u$O.getInt16();u$O.getInt16(),u$O.getInt16();this._image=new Uint8Array(u$W,u$O.pos),this._format=u$ZW.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,u$I.enabled&&this._w<u$I.atlasLimitWidth&&this._h<u$I.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(u$W instanceof Uint8Array))return this._src=u$j,this._url=this._src,this._image=u$W.source||u$W,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=u$j,this._url=this._src,this._w=u$b,this._h=u$E,this._image=u$W,this._format=0===u$t?u$W.byteLength/(u$b*u$E)==4?6408:6407:u$t}this._$5__enableMerageInAtlas=!0}}u$Q(u$q,"laya.webgl.resource.WebGLImage",u$e);var u$j=u$q.prototype;return u$_.imps(u$j,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),u$j._init_=function(u$W,u$j){},u$j._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var u$W=u$ZW.mainContext,u$j=this._source=u$W.createTexture(),u$t=u$XW.curBindTexTarget,u$d=u$XW.curBindTexValue;u$XW.bindTexture(u$W,3553,u$j);var u$b=this.minFifter,u$E=this.magFifter,u$O=this.repeat?10497:33071,u$q=u$R.isPOT(this._w,this._h),u$A=!1;switch(u$q?(this.mipmap?-1!==u$b||(u$b=9987):-1!==u$b||(u$b=9729),-1!==u$E||(u$E=9729),u$W.texParameteri(3553,10241,u$b),u$W.texParameteri(3553,10240,u$E),u$W.texParameteri(3553,10242,u$O),u$W.texParameteri(3553,10243,u$O),this.mipmap&&u$W.generateMipmap(3553)):(-1!==u$b||(u$b=9729),-1!==u$E||(u$E=9729),u$W.texParameteri(3553,10241,u$b),u$W.texParameteri(3553,10240,u$E),u$W.texParameteri(3553,10242,33071),u$W.texParameteri(3553,10243,33071)),u$W.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&u$W.pixelStorei(u$W.UNPACK_ALIGNMENT,1),u$W.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&u$W.pixelStorei(u$W.UNPACK_ALIGNMENT,1),u$W.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:u$A=!0,u$W.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case u$ZW.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:u$A=!0,u$W.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}u$W.pixelStorei(37441,!1),u$t&&u$d&&u$XW.bindTexture(u$W,u$t,u$d),this.uri||(this.uri=this._url),u$A?this.memorySize=this._image.length:u$q&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},u$j.recreateResource=function(){var u$W=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var u$j=this;this._image=new u$T.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(u$j._needReleaseAgain)return u$j._needReleaseAgain=!1,u$j._image.onload=null,void(u$j._image=null);u$j._allowMerageInAtlas&&u$j._enableMerageInAtlas?(u$W.memorySize=0,u$W._recreateLock=!1):u$j._createWebGlTexture(),u$j.completeCreate()},this._image.src=this._src}},u$j.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&u$ZW.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},u$j.onresize=function(){this._w=this._image.width,this._h=this._image.height,u$I.enabled&&this._w<u$I.atlasLimitWidth&&this._h<u$I.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},u$j.clearAtlasSource=function(){this._image=null},u$d(0,u$j,"format",function(){return this._format}),u$d(0,u$j,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(u$W){this._$5__enableMerageInAtlas=u$W}),u$d(0,u$j,"mipmap",function(){return this._mipmap}),u$d(0,u$j,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),u$d(0,u$j,"atlasSource",function(){return this._image}),u$d(0,u$j,"onload",null,function(u$W){var u$j=this;this._onload=u$W,this._image&&(this._image.onload=null!=this._onload?function(){u$j.onresize(),u$j._onload()}:null)}),u$d(0,u$j,"onerror",null,function(u$W){var u$j=this;this._onerror=u$W,this._image&&(this._image.onerror=null!=this._onerror?function(){u$j._onerror()}:null)}),u$q}();u$_.__init([u$TW,u$H,u$NW,u$MW])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(u$W,u$j){"use strict";for(var u$t in Object.defineProperty(u$j,"__esModule",{value:!0}),Laya){var u$d=Laya[u$t];u$d&&u$d.__isclass&&(u$j[u$t]=u$d)}}),function(u$E,u$W,u$d){u$d.un,u$d.uns;var u$b=u$d.static,u$O=u$d.class,u$q=u$d.getset,u$A=(u$d.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),u$$=laya.utils.ClassUtils,u$m=(laya.events.Event,laya.utils.HTMLChar),u$c=laya.net.Loader,u$R=(laya.display.Node,laya.maths.Rectangle),u$Q=laya.renders.Render,u$T=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),u$e=laya.utils.Stat,u$u=laya.display.Text,u$K=laya.resource.Texture,u$o=laya.net.URL,u$S=laya.utils.Utils,u$M=function(){function u$T(){}return u$O(u$T,"laya.html.utils.HTMLParse"),u$T.parse=function(u$W,u$j,u$t){u$j=(u$j="<root>"+(u$j=u$j.replace(/<br>/g,"<br/>"))+"</root>").replace(u$T.spacePattern,u$T.char255);var u$d=u$S.parseXMLFromString(u$j);u$T._parseXML(u$W,u$d.childNodes[0].childNodes,u$t)},u$T._parseXML=function(u$W,u$j,u$t,u$d){var u$b=0,u$E=0;if(u$j.join||u$j.item)for(u$b=0,u$E=u$j.length;u$b<u$E;++u$b)u$T._parseXML(u$W,u$j[u$b],u$t,u$d);else{var u$O,u$q,u$A;if(3==u$j.nodeType)return void(u$W instanceof laya.html.dom.HTMLDivElement?(null==u$j.nodeName&&(u$j.nodeName="#text"),u$q=u$j.nodeName.toLowerCase(),0<(u$A=u$j.textContent.replace(/^\s+|\s+$/g,"")).length&&(u$O=u$$.getInstance(u$q))&&(u$W.addChild(u$O),u$O.innerTEXT=u$A.replace(u$T.char255AndOneSpacePattern," "))):0<(u$A=u$j.textContent.replace(/^\s+|\s+$/g,"")).length&&(u$W.innerTEXT=u$A.replace(u$T.char255AndOneSpacePattern," ")));if("#comment"==(u$q=u$j.nodeName.toLowerCase()))return;if(u$O=u$$.getInstance(u$q)){(u$O=u$W.addChild(u$O)).URI=u$t,u$O.href=u$d;var u$c=u$j.attributes;if(u$c&&0<u$c.length)for(u$b=0,u$E=u$c.length;u$b<u$E;++u$b){var u$R=u$c[u$b],u$m=u$R.nodeName,u$Q=u$R.value;u$O._setAttributes(u$m,u$Q)}u$T._parseXML(u$O,u$j.childNodes,u$t,u$O.href)}else u$T._parseXML(u$W,u$j.childNodes,u$t,u$d)}},u$T.char255=String.fromCharCode(255),u$T.spacePattern=/&nbsp;|&#160;/g,u$T.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),u$T}(),u$Z=function(){function u$a(){}return u$O(u$a,"laya.html.utils.Layout"),u$a.later=function(u$W){null==u$a._will&&(u$a._will=[],u$d.stage.frameLoop(1,null,function(){if(!(u$a._will.length<1)){for(var u$W=0;u$W<u$a._will.length;u$W++)laya.html.utils.Layout.layout(u$a._will[u$W]);u$a._will.length=0}})),u$a._will.push(u$W)},u$a.layout=function(u$W){if(!u$W||!u$W._style)return null;if(0==(512&u$W._style._type))return null;u$W.getStyle()._type&=-513;var u$j=u$a._multiLineLayout(u$W);return u$Q.isConchApp&&u$W.layaoutCallNative&&u$W.layaoutCallNative(),u$j},u$a._multiLineLayout=function(u$W){if(u$u.RightToLeft)return u$a._multiLineLayout2(u$W);var u$j=new Array;u$W._addChildsToLayout(u$j);var u$t,u$d,u$b,u$E,u$O,u$q=0,u$A=u$j.length,u$c=u$W._getCSSStyle(),u$R=u$c.letterSpacing,u$m=u$c.leading,u$Q=u$c.lineHeight,u$T=u$c._widthAuto()||!u$c.wordWrap,u$$=u$T?999999:u$W.width,u$e=(u$W.height,0),u$K=u$c.italic?u$c.fontSize/3:0,u$o=u$c._getAlign(),u$S=u$c._getValign(),u$M=0!==u$S||0!==u$o||0!=u$Q,u$Z=0,u$X=0,u$_=0,u$N=0,u$z=new Array,u$C=u$z[0]=new u$D,u$L=!1,u$V=!1;u$C.h=0,u$c.italic&&(u$$-=u$c.fontSize/3);var u$x=0,u$G=!0;function u$l(){u$C.y=u$X,u$X+=u$C.h+u$m,0==u$C.h&&(u$X+=u$Q),u$C.mWidth=u$x,u$x=0,u$C=new u$D,u$z.push(u$C),u$C.h=0,u$L=!(u$G=!(u$Z=0))}for(u$q=0;u$q<u$A;u$q++)if(null!=(u$t=u$j[u$q]))if(u$G=!1,u$t instanceof laya.html.dom.HTMLBrElement)u$l(),u$C.y=u$X;else{if(u$t._isChar()){if((u$E=u$t).isWord)u$L=u$V||"\n"===u$E.char,u$C.wordStartIndex=u$C.elements.length;else{if(u$_=u$E.width+u$E.style.letterSpacin,0<u$z.length&&u$$<u$Z+u$_&&0<u$C.wordStartIndex){var u$h;u$h=u$C.elements.length-u$C.wordStartIndex+1,u$C.elements.length=u$C.wordStartIndex,u$q-=u$h,u$l();continue}u$L=!1,u$x+=u$E.width}u$_=u$E.width+u$R,u$N=u$E.height,u$V=!1,(u$L=u$L||u$$<u$Z+u$_)&&u$l(),u$C.minTextHeight=Math.min(u$C.minTextHeight,u$t.height)}else u$d=u$t._getCSSStyle(),u$O=u$t,u$b=u$d.padding,0===u$d._getCssFloat()||(u$M=!0),u$L=u$V||u$d.lineElement,u$_=u$O.width*u$O._style._tf.scaleX+u$b[1]+u$b[3]+u$R,u$N=u$O.height*u$O._style._tf.scaleY+u$b[0]+u$b[2],u$V=u$d.lineElement,(u$L=u$L||u$$<u$Z+u$_&&u$d.wordWrap)&&u$l();u$C.elements.push(u$t),u$C.h=Math.max(u$C.h,u$N),u$t.x=u$Z,u$t.y=u$X,u$Z+=u$_,u$C.w=u$Z-u$R,u$C.y=u$X,u$e=Math.max(u$Z+u$K,u$e)}else u$G||(u$Z+=u$a.DIV_ELEMENT_PADDING),u$C.wordStartIndex=u$C.elements.length;if(u$X=u$C.y+u$C.h,u$M){var u$v=0,u$y=u$$;for(u$T&&0<u$W.width&&(u$y=u$W.width),u$q=0,u$A=u$z.length;u$q<u$A;u$q++)u$z[u$q].updatePos(0,u$y,u$q,u$v,u$o,u$S,u$Q),u$v+=Math.max(u$Q,u$z[u$q].h+u$m);u$X=u$v}return u$T&&(u$W.width=u$e),u$X>u$W.height&&(u$W.height=u$X),[u$e,u$X]},u$a._multiLineLayout2=function(u$W){var u$j=new Array;u$W._addChildsToLayout(u$j);var u$t,u$d,u$b,u$E,u$O,u$q=0,u$A=u$j.length,u$c=u$W._getCSSStyle(),u$R=u$c.letterSpacing,u$m=u$c.leading,u$Q=u$c.lineHeight,u$T=u$c._widthAuto()||!u$c.wordWrap,u$$=u$T?999999:u$W.width,u$e=(u$W.height,0),u$K=u$c.italic?u$c.fontSize/3:0,u$o=2-u$c._getAlign(),u$S=u$c._getValign(),u$M=0!==u$S||0!=u$o||0!=u$Q,u$Z=0,u$X=0,u$_=0,u$N=0,u$z=new Array,u$C=u$z[0]=new u$D,u$L=!1,u$V=!1;u$C.h=0,u$c.italic&&(u$$-=u$c.fontSize/3);var u$x=0,u$G=!0;function u$l(){u$C.y=u$X,u$X+=u$C.h+u$m,0==u$C.h&&(u$X+=u$Q),u$C.mWidth=u$x,u$x=0,u$C=new u$D,u$z.push(u$C),u$C.h=0,u$L=!(u$G=!(u$Z=0))}for(u$q=0;u$q<u$A;u$q++)if(null!=(u$t=u$j[u$q]))if(u$G=!1,u$t instanceof laya.html.dom.HTMLBrElement)u$l(),u$C.y=u$X;else{if(u$t._isChar()){if((u$E=u$t).isWord)u$L=u$V||"\n"===u$E.char,u$C.wordStartIndex=u$C.elements.length;else{if(0<u$z.length&&u$$<u$Z+u$_&&0<u$C.wordStartIndex){var u$h;u$h=u$C.elements.length-u$C.wordStartIndex+1,u$C.elements.length=u$C.wordStartIndex,u$q-=u$h,u$l();continue}u$L=!1,u$x+=u$E.width}u$_=u$E.width+u$R,u$N=u$E.height,u$V=!1,(u$L=u$L||u$$<u$Z+u$_)&&u$l(),u$C.minTextHeight=Math.min(u$C.minTextHeight,u$t.height)}else u$d=u$t._getCSSStyle(),u$O=u$t,u$b=u$d.padding,0===u$d._getCssFloat()||(u$M=!0),u$L=u$V||u$d.lineElement,u$_=u$O.width*u$O._style._tf.scaleX+u$b[1]+u$b[3]+u$R,u$N=u$O.height*u$O._style._tf.scaleY+u$b[0]+u$b[2],u$V=u$d.lineElement,(u$L=u$L||u$$<u$Z+u$_&&u$d.wordWrap)&&u$l();u$C.elements.push(u$t),u$C.h=Math.max(u$C.h,u$N),u$t.x=u$Z,u$t.y=u$X,u$Z+=u$_,u$C.w=u$Z-u$R,u$C.y=u$X,u$e=Math.max(u$Z+u$K,u$e)}else u$G||(u$Z+=u$a.DIV_ELEMENT_PADDING),u$C.wordStartIndex=u$C.elements.length;if(u$X=u$C.y+u$C.h,u$M){var u$v=0,u$y=u$$;for(u$q=0,u$A=u$z.length;u$q<u$A;u$q++)u$z[u$q].updatePos(0,u$y,u$q,u$v,u$o,u$S,u$Q),u$v+=Math.max(u$Q,u$z[u$q].h+u$m);u$X=u$v}for(u$T&&(u$W.width=u$e),u$X>u$W.height&&(u$W.height=u$X),u$q=0,u$A=u$z.length;u$q<u$A;u$q++)u$z[u$q].revertOrder(u$$);return[u$e,u$X]},u$a._will=null,u$a.DIV_ELEMENT_PADDING=0,u$a}(),u$D=function(){function u$W(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}u$O(u$W,"laya.html.utils.LayoutLine");var u$j=u$W.prototype;return u$j.updatePos=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){var u$q,u$A=0;0<this.elements.length&&(u$A=(u$q=this.elements[this.elements.length-1]).x+u$q.width-this.elements[0].x);var u$c=0,u$R=NaN;1===u$b&&(u$c=(u$j-u$A)/2),2===u$b&&(u$c=u$j-u$A),0===u$O||0!=u$E||(u$E=1);for(var u$m=0,u$Q=this.elements.length;u$m<u$Q;u$m++){var u$T=(u$q=this.elements[u$m])._getCSSStyle();switch(0!==u$c&&(u$q.x+=u$c),u$T._getValign()){case 0:u$q.y=u$d;break;case 1:var u$$=0;99999!=this.minTextHeight&&(u$$=this.minTextHeight);var u$e=(u$$+u$O)/2;u$e=Math.max(u$e,this.h),u$R=(laya.html.dom.HTMLImageElement,u$d+u$e-u$q.height),u$q.y=u$R;break;case 2:u$q.y=u$d+(u$O-u$q.height)}}},u$j.revertOrder=function(u$W){var u$j;if(0<this.elements.length){var u$t,u$d=0;for(u$t=this.elements.length,u$d=0;u$d<u$t;u$d++)(u$j=this.elements[u$d]).x=u$W-u$j.x-u$j.width}},u$W}(),u$X=function(u$t){function u$j(){this.URI=null,this._href=null,u$j.__super.call(this),this._text=u$j._EMPTYTEXT,this.setStyle(new u$A(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}u$O(u$j,"laya.html.dom.HTMLElement",u$t);var u$W=u$j.prototype;return u$W.layaoutCallNative=function(){var u$W=0;if(this._childs&&0<(u$W=this._childs.length))for(var u$j=0;u$j<u$W;u$j++)this._childs[u$j].layaoutCallNative&&this._childs[u$j].layaoutCallNative();var u$t=this._getWords();u$t?laya.html.dom.HTMLElement.fillWords(this,u$t,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},u$W.appendChild=function(u$W){return this.addChild(u$W)},u$W._getWords2=function(){var u$W=this._text.text;if(!u$W||0===u$W.length)return null;var u$j,u$t,u$d=0,u$b=0;if(this._text.drawWords)u$t=this._text.drawWords;else{for(u$b=(u$j=u$W.split(" ")).length-1,u$t=[],u$d=0;u$d<u$b;u$d++)u$t.push(u$j[u$d]," ");0<=u$b&&u$t.push(u$j[u$b]),this._text.drawWords=u$t}var u$E,u$O=this._text.words;if(u$O&&u$O.length===u$t.length)return u$O;null===u$O&&(this._text.words=u$O=[]),u$O.length=u$t.length;var u$q=this.style,u$A=u$q.font;for(u$d=0,u$b=u$t.length;u$d<u$b;u$d++){u$E=u$S.measureText(u$t[u$d],u$A);var u$c=u$O[u$d]=new u$m(u$t[u$d],u$E.width,u$E.height||u$q.fontSize,u$q);if(1<u$c.char.length&&(u$c.charNum=u$c.char),this.href){var u$R=new u$T;this.addChild(u$R),u$c.setSprite(u$R)}}return u$O},u$W._getWords=function(){if(!u$u.CharacterCache)return this._getWords2();var u$W=this._text.text;if(!u$W||0===u$W.length)return null;var u$j,u$t=this._text.words;if(u$t&&u$t.length===u$W.length)return u$t;null===u$t&&(this._text.words=u$t=[]),u$t.length=u$W.length;for(var u$d=this.style,u$b=u$d.font,u$E=0,u$O=u$W.length;u$E<u$O;u$E++)if(u$j=u$S.measureText(u$W.charAt(u$E),u$b)){var u$q=u$t[u$E]=new u$m(u$W.charAt(u$E),u$j.width,u$j.height||u$d.fontSize,u$d);if(this.href){var u$A=new u$T;this.addChild(u$A),u$q.setSprite(u$A)}}else console.warn("_getWords size is null"+u$W.charAt(u$E),u$b);return u$t},u$W.showLinkSprite=function(){var u$W=this._text.words;if(u$W)for(var u$j,u$t,u$d=[],u$b=0;u$b<u$W.length;u$b++)u$t=u$W[u$b],(u$j=new u$T).graphics.drawRect(0,0,u$t.width,u$t.height,"#ff0000"),u$j.width=u$t.width,u$j.height=u$t.height,this.addChild(u$j),u$d.push(u$j)},u$W._layoutLater=function(){var u$W=this.style;512&u$W._type||(u$W.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&u$W.block?(u$Z.later(this),u$W._type|=512):this.parent&&this.parent._layoutLater())},u$W._setAttributes=function(u$W,u$j){switch(u$W){case"style":return void this.style.cssText(u$j);case"class":return void(this.className=u$j)}u$t.prototype._setAttributes.call(this,u$W,u$j)},u$W.updateHref=function(){if(null!=this._href){var u$W=this._getWords();if(u$W)for(var u$j,u$t,u$d=0;u$d<u$W.length;u$d++)(u$t=(u$j=u$W[u$d]).getSprite())&&(u$t.size(u$j.width,u$j.height),u$t.on("click",this,this.onLinkHandler))}},u$W.onLinkHandler=function(u$W){switch(u$W.type){case"click":for(var u$j=this;u$j;)u$j.event("link",[this.href]),u$j=u$j.parent}},u$W.formatURL=function(u$W){return this.URI?u$o.formatURL(u$W,this.URI?this.URI.path:null):u$W},u$q(0,u$W,"href",function(){return this._href},function(u$W){null!=(this._href=u$W)&&(this._getCSSStyle().underLine=1,this.updateHref())}),u$q(0,u$W,"color",null,function(u$W){this.style.color=u$W}),u$q(0,u$W,"onClick",null,function(u$W){u$d._runScript("fn=function(event){"+u$W+";}"),this.on("click",this,void 0)}),u$q(0,u$W,"id",null,function(u$W){u$_.document.setElementById(u$W,this)}),u$q(0,u$W,"innerTEXT",function(){return this._text.text},function(u$W){this.text=u$W}),u$q(0,u$W,"style",function(){return this._style}),u$q(0,u$W,"text",function(){return this._text.text},function(u$W){this._text==u$j._EMPTYTEXT?this._text={text:u$W,words:null}:(this._text.text=u$W,this._text.words&&(this._text.words.length=0)),u$Q.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),u$q(0,u$W,"parent",u$t.prototype._$get_parent,function(u$W){if(u$W instanceof laya.html.dom.HTMLElement){var u$j=u$W;this.URI||(this.URI=u$j.URI),this.style.inherit(u$j.style)}u$d.superSet(u$T,this,"parent",u$W)}),u$q(0,u$W,"className",null,function(u$W){this.style.attrs(u$_.document.styleSheets["."+u$W])}),u$j.fillWords=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){u$W.graphics.clear();for(var u$q=0,u$A=u$j.length;u$q<u$A;u$q++){var u$c=u$j[u$q];u$W.graphics.fillText(u$c.char,u$c.x+u$t,u$c.y+u$d,u$b,u$E,"left",u$O)}},u$j._EMPTYTEXT={text:null,words:null},u$j}(u$T),u$j=(function(u$W){function u$j(){u$j.__super.call(this),this.style.lineElement=!0,this.style.block=!0}u$O(u$j,"laya.html.dom.HTMLBrElement",u$X)}(),function(u$W){function u$j(){this.contextHeight=NaN,this.contextWidth=NaN,u$j.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}u$O(u$j,"laya.html.dom.HTMLDivElement",u$W);var u$t=u$j.prototype;return u$t.appendHTML=function(u$W){u$M.parse(this,u$W,this.URI),this.layout()},u$t._addChildsToLayout=function(u$j){var u$W=this._getWords();if(null==u$W&&0==this._childs.length)return!1;u$W&&u$W.forEach(function(u$W){u$j.push(u$W)});for(var u$t=!0,u$d=0,u$b=this._childs.length;u$d<u$b;u$d++){var u$E=this._childs[u$d];u$t?u$t=!1:u$j.push(null),u$E._addToLayout(u$j)}return!0},u$t._addToLayout=function(u$W){this.layout()},u$t.layout=function(){if(this.style){this.style._type|=512;var u$W=u$Z.layout(this);if(u$W){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new u$R);var u$j=this._$P.mHtmlBounds;u$j.x=u$j.y=0,u$j.width=this.contextWidth=u$W[0],u$j.height=this.contextHeight=u$W[1],this.setBounds(u$j)}}},u$q(0,u$t,"height",function(){return this._height?this._height:this.contextHeight},u$W.prototype._$set_height),u$q(0,u$t,"innerHTML",null,function(u$W){this.destroyChildren(),this.appendHTML(u$W)}),u$q(0,u$t,"width",function(){return this._width?this._width:this.contextWidth},function(u$W){var u$j=!1;u$j=0===u$W?u$W!=this._width:u$W!=this.width,u$d.superSet(u$X,this,"width",u$W),u$j&&this.layout()}),u$j}(u$X)),u$_=function(u$W){function u$j(){this.all=new Array,this.styleSheets=u$A.styleSheets,u$j.__super.call(this)}u$O(u$j,"laya.html.dom.HTMLDocument",u$X);var u$t=u$j.prototype;return u$t.getElementById=function(u$W){return this.all[u$W]},u$t.setElementById=function(u$W,u$j){this.all[u$W]=u$j},u$b(u$j,["document",function(){return this.document=new u$j}]),u$j}();(function(u$W){function u$j(){this._tex=null,this._url=null,this._renderArgs=[],u$j.__super.call(this),this.style.block=!0}u$O(u$j,"laya.html.dom.HTMLImageElement",u$X);var u$t=u$j.prototype;u$t._addToLayout=function(u$W){!this._style.absolute&&u$W.push(this)},u$t.render=function(u$W,u$j,u$t){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(u$e.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,u$W.ctx.drawTexture2(u$j,u$t,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},u$t.layaoutCallNative=function(){var u$W=0;if(this._childs&&0<(u$W=this._childs.length))for(var u$j=0;u$j<u$W;u$j++)this._childs[u$j].layaoutCallNative&&this._childs[u$j].layaoutCallNative()},u$q(0,u$t,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(u$W){this._width!==u$W&&(this._width=u$W,this._style.width=u$W,this.repaint())}),u$q(0,u$t,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(u$W){this._height!==u$W&&(this._height=u$W,this._style.height=u$W,this.repaint())}),u$t.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),u$c.clearCache(this,this._url),this._tex=null),u$X.prototype.destroy.call(this)},u$t.onloaded=function(){var u$W=this._style;u$W&&!u$W.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),u$W&&!u$W.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),u$Q.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},u$t._loadImageComplete=function(u$W,u$j,u$t){if(!this._destroyed)if(null!=u$t)if(u$t instanceof ArrayBuffer){var u$d=new DataView(u$t);new laya.webgl.resource.WebGLImage(new Uint8Array(u$t,8),u$W,0,!1,u$d.getUint32(0),u$d.getUint32(4));this.onloaded()}else if(u$t instanceof u$K)u$c.imgMgrSet[u$W]=u$j,u$E.imgMgrLock(u$W,u$c.imgMgrSet[u$W]),this._url=u$W,this._tex=u$t,u$c.keepCache(this,u$W),u$c.cacheRes(u$W,this._tex),this.onloaded();else{var u$b=-1!=u$W.indexOf(".png",u$W.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(u$t,u$W,u$b,!1,u$t.width,u$t.height);this.onloaded()}else this.event("error","Load image failed")},u$q(0,u$t,"src",null,function(u$W){(u$W=this.formatURL(u$W),this._url!=u$W)&&(null!=this._tex&&(u$c.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=u$W,(this._tex=u$c.getRes(u$W))?(u$c.keepCache(this,u$W),this.onloaded()):u$E.imgMgrLoad(u$W,this._loadImageComplete.bind(this),2,!1))})})(),function(u$W){function u$j(){this.type=null,u$j.__super.call(this),this.visible=!1}u$O(u$j,"laya.html.dom.HTMLLinkElement",u$W);var u$t=u$j.prototype;u$t._onload=function(u$W){switch(this.type){case"text/css":u$A.parseCSS(u$W,this.URI)}},u$q(0,u$t,"href",u$W.prototype._$get_href,function(u$W){var u$j=this;u$W=this.formatURL(u$W),this.URI=new u$o(u$W);var u$t=new u$c;u$t.once("complete",null,function(u$W){u$j._onload(u$W)}),u$t.load(u$W,"text")}),u$j._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(u$X),function(u$W){function u$j(){u$j.__super.call(this),this.visible=!1}u$O(u$j,"laya.html.dom.HTMLStyleElement",u$W),u$q(0,u$j.prototype,"text",u$W.prototype._$get_text,function(u$W){u$A.parseCSS(u$W,null)})}(u$X),function(u$W){function u$j(){u$j.__super.call(this),this._getCSSStyle().valign="middle"}u$O(u$j,"laya.html.dom.HTMLIframeElement",u$W),u$q(0,u$j.prototype,"href",u$W.prototype._$get_href,function(u$t){var u$d=this;u$t=this.formatURL(u$t);var u$W=new u$c;u$W.once("complete",null,function(u$W){var u$j=u$d.URI;u$d.URI=new u$o(u$t),u$d.innerHTML=u$W,!u$j||(u$d.URI=u$j)}),u$W.load(u$t,"text")})}(u$j)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(u$W,u$j){"use strict";for(var u$t in Object.defineProperty(u$j,"__esModule",{value:!0}),Laya){var u$d=Laya[u$t];u$d&&u$d.__isclass&&(u$j[u$t]=u$d)}}),function(u$W,u$j,u$e){u$e.un,u$e.uns;var u$d=u$e.static,u$E=u$e.class,u$b=u$e.getset,u$t=(u$e.__newvec,laya.display.Animation),u$K=(laya.utils.Browser,laya.utils.ClassUtils),u$O=laya.filters.ColorFilter,u$q=laya.utils.Ease,u$A=laya.events.Event,u$c=(laya.events.EventDispatcher,laya.display.css.Font),u$R=laya.display.FrameAnimation,u$m=laya.display.Graphics,u$Q=laya.utils.Handler,u$T=laya.display.Input,u$S=laya.net.Loader,u$$=(laya.display.Node,laya.maths.Point),u$o=laya.maths.Rectangle,u$M=laya.renders.Render,u$Z=laya.display.Sprite,u$X=laya.display.Text,u$_=laya.resource.Texture,u$N=laya.utils.Tween,u$z=laya.utils.Utils,u$C=laya.utils.WeakObject;u$e.interface("laya.ui.IItem"),u$e.interface("laya.ui.ISelect"),u$e.interface("laya.ui.IRender"),u$e.interface("laya.ui.IComponent"),u$e.interface("laya.ui.IBox","IComponent");var u$L=function(){function u$W(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return u$E(u$W,"laya.ui.LayoutStyle"),u$d(u$W,["EMPTY",function(){return this.EMPTY=new u$W}]),u$W}(),u$V=function(){function u$W(){}return u$E(u$W,"laya.ui.Styles"),u$W.labelColor="#000000",u$W.buttonStateNum=3,u$W.scrollBarMinNum=15,u$W.scrollBarDelayTime=500,u$d(u$W,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),u$W}(),u$x=function(){function u$b(){}return u$E(u$b,"laya.ui.UIUtils"),u$b.fillArray=function(u$W,u$j,u$t){var u$d=u$W.concat();if(u$j)for(var u$b=u$j.split(","),u$E=0,u$O=Math.min(u$d.length,u$b.length);u$E<u$O;u$E++){var u$q=u$b[u$E];u$d[u$E]="true"==u$q||"false"!=u$q&&u$q,null!=u$t&&(u$d[u$E]=u$t(u$q))}return u$d},u$b.toColor=function(u$W){return u$z.toHexColor(u$W)},u$b.gray=function(u$W,u$j){void 0===u$j&&(u$j=!0),u$j?u$b.addFilter(u$W,u$b.grayFilter):u$b.clearFilter(u$W,u$O)},u$b.addFilter=function(u$W,u$j){var u$t=u$W.filters||[];u$t.push(u$j),u$W.filters=u$t},u$b.clearFilter=function(u$W,u$j){var u$t=u$W.filters;if(null!=u$t&&0<u$t.length){for(var u$d=u$t.length-1;-1<u$d;u$d--){var u$b=u$t[u$d];u$e.__typeof(u$b,u$j)&&u$t.splice(u$d,1)}u$W.filters=u$t}},u$b._getReplaceStr=function(u$W){return u$b.escapeSequence[u$W]},u$b.adptString=function(u$W){return u$W.replace(/\\(\w)/g,u$b._getReplaceStr)},u$b.getBindFun=function(u$W){var u$j=u$b._funMap.get(u$W);if(null==u$j){var u$t='"'+u$W+'"',u$d="(function(data){if(data==null)return;with(data){try{\nreturn "+(u$t=u$t.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";u$j=u$e._runScript(u$d),u$b._funMap.set(u$W,u$j)}return u$j},u$d(u$b,["grayFilter",function(){return this.grayFilter=new u$O([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new u$C}]),u$b}(),u$G=function(){function u$W(){}return u$E(u$W,"UIConfig"),u$W.touchScrollEnable=!0,u$W.mouseWheelEnable=!0,u$W.showButtons=!0,u$W.popupBgColor="#000000",u$W.popupBgAlpha=.5,u$W.closeDialogOnSide=!0,u$W}(),u$l=function(u$t){function u$o(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,u$o.__super.call(this),this._weakKeys=[]}u$E(u$o,"laya.ui.AutoBitmap",u$t);var u$W=u$o.prototype;return u$W.destroy=function(){if(u$S.clearObject(this,this._weakKey),this._weakKeys){for(var u$W=0,u$j=this._weakKeys.length;u$W<u$j;++u$W)u$S.clearObject(this,this._weakKeys[u$W]);this._weakKeys=null}u$t.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},u$W._setChanged=function(){this._isChanged||(this._isChanged=!0,u$e.timer.callLater(this,this.changeSource))},u$W.changeSource=function(){this._isChanged=!1;var u$W=this._source;if(u$W&&u$W.bitmap){var u$j=this.width,u$t=this.height,u$d=this._sizeGrid,u$b=u$W.sourceWidth,u$E=u$W.sourceHeight;if(!u$d||u$b===u$j&&u$E===u$t)this.cleanByTexture(u$W,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,u$j,u$t);else{u$S.clearObject(this,this._weakKey),u$W.$_GID||(u$W.$_GID=u$z.getGID());var u$O=u$W.$_GID+"."+u$j+"."+u$t+"."+u$d.join("."),u$q=u$S.findObject(u$O);if(u$z.isOKCmdList(u$q))return this._weakKey=u$O,u$S.keepObject(this,this._weakKey),void(this.cmds=u$q);this.clear();var u$A,u$c,u$R=u$d[0],u$m=u$d[1],u$Q=u$d[2],u$T=u$d[3],u$$=u$d[4],u$e=!1;if(u$j==u$b&&(u$T=u$m=0),u$t==u$E&&(u$R=u$Q=0),u$j<u$T+u$m){var u$K=u$j;u$e=!0,u$j=u$T+u$m,this.save(),this.clipRect(0,0,u$K,u$t)}u$T&&u$R&&(u$A=u$o.getTexture(u$W,0,0,u$T,u$R),u$c=this._weakKeys[0],u$A?(u$c!=u$A.weakKey&&(u$S.clearObject(this,u$c),u$S.keepObject(this,u$A.weakKey),this._weakKeys[0]=u$A.weakKey),this.drawTexture(u$A,0,0,u$T,u$R)):(u$S.clearObject(this,u$c),this._weakKeys[0]="")),u$m&&u$R&&(u$A=u$o.getTexture(u$W,u$b-u$m,0,u$m,u$R),u$c=this._weakKeys[1],u$A?(u$c!=u$A.weakKey&&(u$S.clearObject(this,u$c),u$S.keepObject(this,u$A.weakKey),this._weakKeys[1]=u$A.weakKey),this.drawTexture(u$A,u$j-u$m,0,u$m,u$R)):(u$S.clearObject(this,u$c),this._weakKeys[1]="")),u$T&&u$Q&&(u$A=u$o.getTexture(u$W,0,u$E-u$Q,u$T,u$Q),u$c=this._weakKeys[2],u$A?(u$c!=u$A.weakKey&&(u$S.clearObject(this,u$c),u$S.keepObject(this,u$A.weakKey),this._weakKeys[2]=u$A.weakKey),this.drawTexture(u$A,0,u$t-u$Q,u$T,u$Q)):(u$S.clearObject(this,u$c),this._weakKeys[2]="")),u$m&&u$Q&&(u$A=u$o.getTexture(u$W,u$b-u$m,u$E-u$Q,u$m,u$Q),u$c=this._weakKeys[3],u$A?(u$c!=u$A.weakKey&&(u$S.clearObject(this,u$c),u$S.keepObject(this,u$A.weakKey),this._weakKeys[3]=u$A.weakKey),this.drawTexture(u$A,u$j-u$m,u$t-u$Q,u$m,u$Q)):(u$S.clearObject(this,u$c),this._weakKeys[3]="")),u$R&&(u$A=u$o.getTexture(u$W,u$T,0,u$b-u$T-u$m,u$R),u$c=this._weakKeys[4],u$A?(u$c!=u$A.weakKey&&(u$S.clearObject(this,u$c),u$S.keepObject(this,u$A.weakKey),this._weakKeys[4]=u$A.weakKey),this.drawBitmap(u$$,u$A,u$T,0,u$j-u$T-u$m,u$R)):(u$S.clearObject(this,u$c),this._weakKeys[4]="")),u$Q&&(u$A=u$o.getTexture(u$W,u$T,u$E-u$Q,u$b-u$T-u$m,u$Q),u$c=this._weakKeys[5],u$A?(u$c!=u$A.weakKey&&(u$S.clearObject(this,u$c),u$S.keepObject(this,u$A.weakKey),this._weakKeys[5]=u$A.weakKey),this.drawBitmap(u$$,u$A,u$T,u$t-u$Q,u$j-u$T-u$m,u$Q)):(u$S.clearObject(this,u$c),this._weakKeys[5]="")),u$T&&(u$A=u$o.getTexture(u$W,0,u$R,u$T,u$E-u$R-u$Q),u$c=this._weakKeys[6],u$A?(u$c!=u$A.weakKey&&(u$S.clearObject(this,u$c),u$S.keepObject(this,u$A.weakKey),this._weakKeys[6]=u$A.weakKey),this.drawBitmap(u$$,u$A,0,u$R,u$T,u$t-u$R-u$Q)):(u$S.clearObject(this,u$c),this._weakKeys[6]="")),u$m&&(u$A=u$o.getTexture(u$W,u$b-u$m,u$R,u$m,u$E-u$R-u$Q),u$c=this._weakKeys[7],u$A?(u$c!=u$A.weakKey&&(u$S.clearObject(this,u$c),u$S.keepObject(this,u$A.weakKey),this._weakKeys[7]=u$A.weakKey),this.drawBitmap(u$$,u$A,u$j-u$m,u$R,u$m,u$t-u$R-u$Q)):(u$S.clearObject(this,u$c),this._weakKeys[7]="")),u$A=u$o.getTexture(u$W,u$T,u$R,u$b-u$T-u$m,u$E-u$R-u$Q),u$c=this._weakKeys[8],u$A?(u$c!=u$A.weakKey&&(u$S.clearObject(this,u$c),u$S.keepObject(this,u$A.weakKey),this._weakKeys[8]=u$A.weakKey),this.drawBitmap(u$$,u$A,u$T,u$R,u$j-u$T-u$m,u$t-u$R-u$Q)):(u$S.clearObject(this,u$c),this._weakKeys[8]=""),u$e&&this.restore(),this.autoCacheCmd&&!u$M.isConchApp&&(u$S.saveObject(u$O,this.cmds,null),this._weakKey=u$O,u$S.keepObject(this,this._weakKey))}this._repaint()}},u$W.drawBitmap=function(u$W,u$j,u$t,u$d,u$b,u$E){void 0===u$b&&(u$b=0),void 0===u$E&&(u$E=0),u$b<.1||u$E<.1||(!u$W||u$j.width==u$b&&u$j.height==u$E?this.drawTexture(u$j,u$t,u$d,u$b,u$E):this.fillTexture(u$j,u$t,u$d,u$b,u$E))},u$W.clear=function(u$W){void 0===u$W&&(u$W=!0),u$t.prototype.clear.call(this,!1)},u$b(0,u$W,"sizeGrid",function(){return this._sizeGrid},function(u$W){this._sizeGrid=u$W,this._setChanged()}),u$b(0,u$W,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(u$W){this._width!=u$W&&(this._width=u$W,this._setChanged())}),u$b(0,u$W,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(u$W){this._height!=u$W&&(this._height=u$W,this._setChanged())}),u$b(0,u$W,"source",function(){return this._source},function(u$W){u$W?(this._source=u$W,this._setChanged()):(this._source=null,this.clear())}),u$o.getTexture=function(u$W,u$j,u$t,u$d,u$b){u$d<=0&&(u$d=1),u$b<=0&&(u$b=1),u$W.$_GID||(u$W.$_GID=u$z.getGID());var u$E=u$W.$_GID+"."+u$j+"."+u$t+"."+u$d+"."+u$b,u$O=u$S.findObject(u$E);if((!u$O||!u$O.source)&&(u$O=u$_.createFromTexture(u$W,u$j,u$t,u$d,u$b))){if(u$W.alphaTexture){var u$q=u$W.width/u$W.alphaTexture.width;u$O.alphaTexture=u$_.createFromTexture(u$W.alphaTexture,u$j/u$q,u$t/u$q,u$d/u$q,u$b/u$q)}u$S.saveObject(u$E,u$O),u$O.weakKey=u$E}return u$O},u$o}(u$m),u$h=(function(u$W){function u$j(){u$j.__super.call(this)}u$E(u$j,"laya.ui.UIEvent",u$A),u$j.SHOW_TIP="showtip",u$j.HIDE_TIP="hidetip"}(),function(u$j){function u$W(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,u$W.__super.call(this),this._layout=u$L.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}u$E(u$W,"laya.ui.Component",u$j);var u$t=u$W.prototype;return u$e.imps(u$t,{"laya.ui.IComponent":!0}),u$t.destroy=function(u$W){void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,u$W),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},u$t.preinitialize=function(){},u$t.createChildren=function(){},u$t.initialize=function(){},u$t.callLater=function(u$W,u$j){u$e.timer.callLater(this,u$W,u$j)},u$t.runCallLater=function(u$W){u$e.timer.runCallLater(this,u$W)},u$t.commitMeasure=function(){},u$t.changeSize=function(){this.event("resize")},u$t.getLayout=function(){return this._layout===u$L.EMPTY&&(this._layout=new u$L),this._layout},u$t._setLayoutEnabled=function(u$W){this._layout&&this._layout.enable!=u$W&&(this._layout.enable=u$W,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},u$t.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},u$t.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},u$t.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},u$t.resetLayoutX=function(){var u$W=this._layout;if(isNaN(u$W.anchorX)||(this.pivotX=u$W.anchorX*this.width),this.layoutEnabled){var u$j=this.parent;u$j&&(isNaN(u$W.centerX)?isNaN(u$W.left)?isNaN(u$W.right)||(this.x=Math.round(u$j.width-this.displayWidth-u$W.right+this.pivotX*this.scaleX)):(this.x=Math.round(u$W.left+this.pivotX*this.scaleX),isNaN(u$W.right)||(this.width=(u$j._width-u$W.left-u$W.right)/(this.scaleX||.01))):this.x=Math.round(.5*(u$j.width-this.displayWidth)+u$W.centerX+this.pivotX*this.scaleX))}},u$t.resetLayoutY=function(){var u$W=this._layout;if(isNaN(u$W.anchorY)||(this.pivotY=u$W.anchorY*this.height),this.layoutEnabled){var u$j=this.parent;u$j&&(isNaN(u$W.centerY)?isNaN(u$W.top)?isNaN(u$W.bottom)||(this.y=Math.round(u$j.height-this.displayHeight-u$W.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(u$W.top+this.pivotY*this.scaleY),isNaN(u$W.bottom)||(this.height=(u$j._height-u$W.top-u$W.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(u$j.height-this.displayHeight)+u$W.centerY+this.pivotY*this.scaleY))}},u$t.onMouseOver=function(u$W){u$e.stage.event("showtip",this._toolTip)},u$t.onMouseOut=function(u$W){u$e.stage.event("hidetip",this._toolTip)},u$b(0,u$t,"displayWidth",function(){return this.width*this.scaleX}),u$b(0,u$t,"width",function(){return this._width?this._width:this.measureWidth},function(u$W){this._width!=u$W&&(this._width=u$W,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),u$b(0,u$t,"measureWidth",function(){var u$W=0;this.commitMeasure();for(var u$j=this.numChildren-1;-1<u$j;u$j--){var u$t=this.getChildAt(u$j);u$t.visible&&(u$W=Math.max(u$t.x+u$t.width*u$t.scaleX,u$W))}return u$W}),u$b(0,u$t,"displayHeight",function(){return this.height*this.scaleY}),u$b(0,u$t,"height",function(){return this._height?this._height:this.measureHeight},function(u$W){this._height!=u$W&&(this._height=u$W,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),u$b(0,u$t,"dataSource",function(){return this._dataSource},function(u$W){for(var u$j in this._dataSource=u$W,this._dataSource)this.hasOwnProperty(u$j)&&"function"!=typeof this[u$j]&&(this[u$j]=this._dataSource[u$j])}),u$b(0,u$t,"scaleY",u$j.prototype._$get_scaleY,function(u$W){u$e.superGet(u$Z,this,"scaleY")!=u$W&&(u$e.superSet(u$Z,this,"scaleY",u$W),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),u$b(0,u$t,"measureHeight",function(){var u$W=0;this.commitMeasure();for(var u$j=this.numChildren-1;-1<u$j;u$j--){var u$t=this.getChildAt(u$j);u$t.visible&&(u$W=Math.max(u$t.y+u$t.height*u$t.scaleY,u$W))}return u$W}),u$b(0,u$t,"scaleX",u$j.prototype._$get_scaleX,function(u$W){u$e.superGet(u$Z,this,"scaleX")!=u$W&&(u$e.superSet(u$Z,this,"scaleX",u$W),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),u$b(0,u$t,"top",function(){return this._layout.top},function(u$W){u$W!=this._layout.top&&(this.getLayout().top=u$W,this._setLayoutEnabled(!0)),this.resetLayoutY()}),u$b(0,u$t,"bottom",function(){return this._layout.bottom},function(u$W){u$W!=this._layout.bottom&&(this.getLayout().bottom=u$W,this._setLayoutEnabled(!0)),this.resetLayoutY()}),u$b(0,u$t,"left",function(){return this._layout.left},function(u$W){u$W!=this._layout.left&&(this.getLayout().left=u$W,this._setLayoutEnabled(!0)),this.resetLayoutX()}),u$b(0,u$t,"right",function(){return this._layout.right},function(u$W){u$W!=this._layout.right&&(this.getLayout().right=u$W,this._setLayoutEnabled(!0)),this.resetLayoutX()}),u$b(0,u$t,"centerX",function(){return this._layout.centerX},function(u$W){u$W!=this._layout.centerX&&(this.getLayout().centerX=u$W,this._setLayoutEnabled(!0)),this.resetLayoutX()}),u$b(0,u$t,"centerY",function(){return this._layout.centerY},function(u$W){u$W!=this._layout.centerY&&(this.getLayout().centerY=u$W,this._setLayoutEnabled(!0)),this.resetLayoutY()}),u$b(0,u$t,"anchorX",function(){return this._layout.anchorX},function(u$W){u$W!=this._layout.anchorX&&(this.getLayout().anchorX=u$W,this._setLayoutEnabled(!0)),this.resetLayoutX()}),u$b(0,u$t,"anchorY",function(){return this._layout.anchorY},function(u$W){u$W!=this._layout.anchorY&&(this.getLayout().anchorY=u$W,this._setLayoutEnabled(!0)),this.resetLayoutY()}),u$b(0,u$t,"tag",function(){return this._tag},function(u$W){this._tag=u$W}),u$b(0,u$t,"toolTip",function(){return this._toolTip},function(u$W){this._toolTip!=u$W&&(null!=(this._toolTip=u$W)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),u$b(0,u$t,"comXml",function(){return this._comXml},function(u$W){this._comXml=u$W}),u$b(0,u$t,"gray",function(){return this._gray},function(u$W){u$W!==this._gray&&(this._gray=u$W,u$x.gray(this,u$W))}),u$b(0,u$t,"disabled",function(){return this._disabled},function(u$W){u$W!==this._disabled&&(this.gray=this._disabled=u$W,this.mouseEnabled=!u$W)}),u$W}(u$Z)),u$v=function(u$W){function u$j(){this.lockLayer=null,this.popupEffect=function(u$W){u$W.scale(1,1),u$N.from(u$W,{x:u$e.stage.width/2,y:u$e.stage.height/2,scaleX:0,scaleY:0},300,u$q.backOut,u$Q.create(this,this.doOpen,[u$W]))},this.closeEffect=function(u$W,u$j){u$N.to(u$W,{x:u$e.stage.width/2,y:u$e.stage.height/2,scaleX:0,scaleY:0},300,u$q.strongOut,u$Q.create(this,this.doClose,[u$W,u$j]))},u$j.__super.call(this),this.maskLayer=new u$Z,this.popupEffectHandler=u$Q.create(this,this.popupEffect,null,!1),this.closeEffectHandler=u$Q.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,u$e.stage.addChild(this),u$e.stage.on("resize",this,this._onResize),u$G.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}u$E(u$j,"laya.ui.DialogManager",u$Z);var u$t=u$j.prototype;return u$t._closeOnSide=function(){var u$W=this.getChildAt(this.numChildren-1);u$W instanceof laya.ui.Dialog&&u$W.close("side")},u$t.setLockView=function(u$W){this.lockLayer||(this.lockLayer=new u$y,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(u$e.stage.width,u$e.stage.height)),this.lockLayer.removeChildren(),u$W&&(u$W.centerX=u$W.centerY=0,this.lockLayer.addChild(u$W))},u$t._onResize=function(u$W){var u$j=this.maskLayer.width=u$e.stage.width,u$t=this.maskLayer.height=u$e.stage.height;this.lockLayer&&this.lockLayer.size(u$j,u$t),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,u$j,u$t,u$G.popupBgColor),this.maskLayer.alpha=u$G.popupBgAlpha;for(var u$d=this.numChildren-1;-1<u$d;u$d--){var u$b=this.getChildAt(u$d);u$b.popupCenter&&this._centerDialog(u$b)}},u$t._centerDialog=function(u$W){u$W.x=Math.round((u$e.stage.width-u$W.width>>1)+u$W.pivotX),u$W.y=Math.round((u$e.stage.height-u$W.height>>1)+u$W.pivotY)},u$t.open=function(u$W,u$j,u$t){void 0===u$j&&(u$j=!1),void 0===u$t&&(u$t=!1),u$j&&this._closeAll(),u$W.popupCenter&&this._centerDialog(u$W),this.addChild(u$W),(u$W.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),u$t&&null!=u$W.popupEffect?u$W.popupEffect.runWith(u$W):this.doOpen(u$W),this.event("open")},u$t.doOpen=function(u$W){u$W.onOpened()},u$t.lock=function(u$W){this.lockLayer&&(u$W?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},u$t.close=function(u$W,u$j,u$t){void 0===u$t&&(u$t=!1),u$t&&null!=u$W.closeEffect?u$W.closeEffect.runWith([u$W,u$j]):this.doClose(u$W,u$j),this.event("close")},u$t.doClose=function(u$W,u$j){u$W.removeSelf(),u$W.isModal&&this._checkMask(),u$W.closeHandler&&u$W.closeHandler.runWith(u$j),u$W.onClosed(u$j)},u$t.closeAll=function(){this._closeAll(),this.event("close")},u$t._closeAll=function(){for(var u$W=this.numChildren-1;-1<u$W;u$W--){var u$j=this.getChildAt(u$W);u$j&&null!=u$j.close&&this.doClose(u$j)}},u$t.getDialogsByGroup=function(u$W){for(var u$j=[],u$t=this.numChildren-1;-1<u$t;u$t--){var u$d=this.getChildAt(u$t);u$d&&u$d.group===u$W&&u$j.push(u$d)}return u$j},u$t.closeByGroup=function(u$W){for(var u$j=[],u$t=this.numChildren-1;-1<u$t;u$t--){var u$d=this.getChildAt(u$t);u$d&&u$d.group===u$W&&(u$d.close(),u$j.push(u$d))}return u$j},u$t._checkMask=function(){this.maskLayer.removeSelf();for(var u$W=this.numChildren-1;-1<u$W;u$W--){var u$j=this.getChildAt(u$W);if(u$j&&u$j.isModal)return void this.addChildAt(this.maskLayer,u$W)}},u$j}(),u$y=function(u$W){function u$j(){u$j.__super.call(this)}u$E(u$j,"laya.ui.Box",u$W);var u$t=u$j.prototype;return u$e.imps(u$t,{"laya.ui.IBox":!0}),u$b(0,u$t,"dataSource",u$W.prototype._$get_dataSource,function(u$W){for(var u$j in this._dataSource=u$W){var u$t=this.getChildByName(u$j);u$t?u$t.dataSource=u$W[u$j]:this.hasOwnProperty(u$j)&&"function"!=typeof this[u$j]&&(this[u$j]=u$W[u$j])}}),u$j}(u$h),u$a=function(u$j){function u$t(u$W,u$j){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,u$t.__super.call(this),this._labelColors=u$V.buttonLabelColors,this._stateNum=u$V.buttonStateNum,void 0===u$j&&(u$j=""),this.skin=u$W,this.label=u$j}u$E(u$t,"laya.ui.Button",u$j);var u$W=u$t.prototype;return u$e.imps(u$W,{"laya.ui.ISelect":!0}),u$W.destroy=function(u$W){u$S.clearCache(this,this._skin),u$S.clearObject(this,this._weakKey),void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,u$W),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(u$W),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},u$W.createChildren=function(){this.graphics=this._bitmap=new u$l},u$W.createText=function(){this._text||(this._text=new u$X,this._text.overflow=u$X.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},u$W.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},u$W.onMouse=function(u$W){if(!1!==this.toggle||!this._selected)return"click"===u$W.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=u$t.stateMap[u$W.type]))},u$W.changeClips=function(){var u$W=u$S.getRes(this._skin);if(u$W&&this._skin&&""!=this._skin){u$S.clearObject(this,this._weakKey);var u$j=u$W.sourceWidth,u$t=u$W.sourceHeight/this._stateNum;u$W.$_GID||(u$W.$_GID=u$z.getGID());var u$d=u$W.$_GID+"-"+this._stateNum,u$b=u$S.findObject(u$d);if(u$z.isOkTextureList(u$b)||(u$b=null),u$b)this._weakKey=u$d,u$S.keepObject(this,this._weakKey),this._sources=u$b;else{if(this._sources=[],1===this._stateNum)this._sources.push(u$W);else for(var u$E=0;u$E<this._stateNum;u$E++){var u$O=u$_.createFromTexture(u$W,0,u$t*u$E,u$j,u$t);if(u$W.alphaTexture){var u$q=u$W.width/u$W.alphaTexture.width;u$O.alphaTexture=u$_.createFromTexture(u$W.alphaTexture,0/u$q,u$t*u$E/u$q,u$j/u$q,u$t/u$q)}this._sources.push(u$O)}u$S.saveObject(u$d,this._sources),this._weakKey=u$d,u$S.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||u$j,this._bitmap.height=this._height||u$t,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=u$j)}else console.warn("lose skin ",this._skin,this.name,this.__className)},u$W.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var u$W=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[u$W]),this.label&&(this._text.color=this._labelColors[u$W],this._strokeColors&&(this._text.strokeColor=this._strokeColors[u$W]))},u$W._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},u$b(0,u$W,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(u$W){this.createText(),this._text.strokeColor=u$W}),u$b(0,u$W,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),u$b(0,u$W,"skin",function(){return this._skin},function(u$W){this._skin!=u$W&&(u$S.clearCache(this,this._skin),this._skin=u$W,u$S.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),u$b(0,u$W,"state",function(){return this._state},function(u$W){this._state!=u$W&&(this._state=u$W,this._setStateChanged())}),u$b(0,u$W,"text",function(){return this.createText(),this._text}),u$b(0,u$W,"stateNum",function(){return this._stateNum},function(u$W){"string"==typeof u$W&&(u$W=parseInt(u$W)),this._stateNum!=u$W&&(this._stateNum=u$W<1?1:3<u$W?3:u$W,this.callLater(this.changeClips))}),u$b(0,u$W,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(u$W){this._strokeColors=u$x.fillArray(u$V.buttonLabelColors,u$W,String),this._setStateChanged()}),u$b(0,u$W,"labelColors",function(){return this._labelColors.join(",")},function(u$W){this._labelColors=u$x.fillArray(u$V.buttonLabelColors,u$W,String),this._setStateChanged()}),u$b(0,u$W,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),u$b(0,u$W,"label",function(){return this._text?this._text.text:null},function(u$W){(this._text||u$W)&&(this.createText(),this._text.text!=u$W&&(u$W&&!this._text.parent&&this.addChild(this._text),this._text.text=(u$W+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),u$b(0,u$W,"selected",function(){return this._selected},function(u$W){this._selected!=u$W&&(this._selected=u$W,this.state=this._selected?2:0,this.event("change"))}),u$b(0,u$W,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(u$W){this.createText(),this._text.padding=u$x.fillArray(u$V.labelPadding,u$W,Number)}),u$b(0,u$W,"labelSize",function(){return this.createText(),this._text.fontSize},function(u$W){this.createText(),this._text.fontSize=u$W}),u$b(0,u$W,"labelStroke",function(){return this.createText(),this._text.stroke},function(u$W){this.createText(),this._text.stroke=u$W}),u$b(0,u$W,"labelBold",function(){return this.createText(),this._text.bold},function(u$W){this.createText(),this._text.bold=u$W}),u$b(0,u$W,"labelFont",function(){return this.createText(),this._text.font},function(u$W){this.createText(),this._text.font=u$W}),u$b(0,u$W,"labelAlign",function(){return this.createText(),this._text.align},function(u$W){this.createText(),this._text.align=u$W}),u$b(0,u$W,"clickHandler",function(){return this._clickHandler},function(u$W){this._clickHandler=u$W}),u$b(0,u$W,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(u$W){this._bitmap.sizeGrid=u$x.fillArray(u$V.defaultSizeGrid,u$W,Number)}),u$b(0,u$W,"width",u$j.prototype._$get_width,function(u$W){u$e.superSet(u$h,this,"width",u$W),this._autoSize&&(this._bitmap.width=u$W,this._text&&(this._text.width=u$W))}),u$b(0,u$W,"height",u$j.prototype._$get_height,function(u$W){u$e.superSet(u$h,this,"height",u$W),this._autoSize&&(this._bitmap.height=u$W,this._text&&(this._text.height=u$W))}),u$b(0,u$W,"dataSource",u$j.prototype._$get_dataSource,function(u$W){"number"==typeof(this._dataSource=u$W)||"string"==typeof u$W?this.label=u$W+"":u$e.superSet(u$h,this,"dataSource",u$W)}),u$b(0,u$W,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(u$W){this._bitmap._offset=u$W?u$x.fillArray([1,1],u$W,Number):[]}),u$d(u$t,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),u$t}(u$h),u$u=function(u$j){function u$d(u$W,u$j,u$t){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,u$d.__super.call(this),void 0===u$j&&(u$j=1),void 0===u$t&&(u$t=1),this._clipX=u$j,this._clipY=u$t,this.skin=u$W}u$E(u$d,"laya.ui.Clip",u$j);var u$W=u$d.prototype;return u$W.destroy=function(u$W){u$S.clearCache(this,this._skin),u$S.clearObject(this,this._weakKey),void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},u$W.dispose=function(){this.destroy(!0),u$e.loader.clearRes(this._skin)},u$W.createChildren=function(){this.graphics=this._bitmap=new u$l},u$W._onDisplay=function(u$W){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},u$W.changeClip=function(){if(this._clipChanged=!1,this._skin){var u$W=u$S.getRes(this._skin);u$W?this.loadComplete(this._skin,u$W):u$e.loader.load(this._skin,u$Q.create(this,this.loadComplete,[this._skin]))}},u$W.loadComplete=function(u$W,u$j){if(u$W===this._skin&&u$j){u$S.clearObject(this,this._weakKey);var u$t=this._clipWidth||Math.ceil(u$j.sourceWidth/this._clipX),u$d=this._clipHeight||Math.ceil(u$j.sourceHeight/this._clipY),u$b=this._skin+u$t+u$d,u$E=u$S.findObject(u$b);if(u$z.isOkTextureList(u$E)||(u$E=null),u$E)this._weakKey=u$b,u$S.keepObject(this,this._weakKey),this._sources=u$E;else{this._sources=[];for(var u$O=0;u$O<this._clipY;u$O++)for(var u$q=0;u$q<this._clipX;u$q++){var u$A=u$_.createFromTexture(u$j,u$t*u$q,u$d*u$O,u$t,u$d);if(u$j.alphaTexture){var u$c=u$j.width/u$j.alphaTexture.width;u$A.alphaTexture=u$_.createFromTexture(u$j.alphaTexture,u$t*u$q/u$c,u$d*u$O/u$c,u$t/u$c,u$d/u$c)}this._sources.push(u$A)}u$S.saveObject(u$b,this._sources),this._weakKey=u$b,u$S.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},u$W.play=function(u$W,u$j){void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=-1),this._isPlaying=!0,this.index=u$W,this._toIndex=u$j,this._index++,u$e.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},u$W._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},u$W.stop=function(){this._isPlaying=!1,u$e.timer.clear(this,this._loop),this.event("complete")},u$W._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},u$b(0,u$W,"interval",function(){return this._interval},function(u$W){this._interval!=u$W&&(this._interval=u$W,this._isPlaying&&this.play())}),u$b(0,u$W,"skin",function(){return this._skin},function(u$W){this._skin!=u$W&&(u$S.clearCache(this,this._skin),(this._skin=u$W)?(u$S.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),u$b(0,u$W,"sources",function(){return this._sources},function(u$W){this._sources=u$W,this.index=this._index,this.event("loaded")}),u$b(0,u$W,"clipX",function(){return this._clipX},function(u$W){this._clipX=u$W||1,this._setClipChanged()}),u$b(0,u$W,"clipY",function(){return this._clipY},function(u$W){this._clipY=u$W||1,this._setClipChanged()}),u$b(0,u$W,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),u$b(0,u$W,"clipWidth",function(){return this._clipWidth},function(u$W){this._clipWidth=u$W,this._setClipChanged()}),u$b(0,u$W,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(u$W){this._bitmap.sizeGrid=u$x.fillArray(u$V.defaultSizeGrid,u$W,Number)}),u$b(0,u$W,"group",function(){return this._group},function(u$W){u$W&&this._skin&&u$S.setGroup(this._skin,u$W),this._group=u$W}),u$b(0,u$W,"clipHeight",function(){return this._clipHeight},function(u$W){this._clipHeight=u$W,this._setClipChanged()}),u$b(0,u$W,"width",u$j.prototype._$get_width,function(u$W){u$e.superSet(u$h,this,"width",u$W),this._bitmap.width=u$W}),u$b(0,u$W,"height",u$j.prototype._$get_height,function(u$W){u$e.superSet(u$h,this,"height",u$W),this._bitmap.height=u$W}),u$b(0,u$W,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),u$b(0,u$W,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),u$b(0,u$W,"index",function(){return this._index},function(u$W){this._index=u$W,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[u$W]),this.event("change")}),u$b(0,u$W,"autoPlay",function(){return this._autoPlay},function(u$W){this._autoPlay!=u$W&&((this._autoPlay=u$W)?this.play():this.stop())}),u$b(0,u$W,"isPlaying",function(){return this._isPlaying},function(u$W){this._isPlaying=u$W}),u$b(0,u$W,"dataSource",u$j.prototype._$get_dataSource,function(u$W){"number"==typeof(this._dataSource=u$W)&&Math.floor(u$W)==u$W||"string"==typeof u$W?this.index=parseInt(u$W):u$e.superSet(u$h,this,"dataSource",u$W)}),u$b(0,u$W,"bitmap",function(){return this._bitmap}),u$d}(u$h),u$D=function(u$j){function u$W(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,u$W.__super.call(this)}u$E(u$W,"laya.ui.ColorPicker",u$j);var u$t=u$W.prototype;return u$t.destroy=function(u$W){void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,u$W),this._colorPanel&&this._colorPanel.destroy(u$W),this._colorButton&&this._colorButton.destroy(u$W),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},u$t.createChildren=function(){this.addChild(this._colorButton=new u$a),this._colorPanel=new u$y,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new u$Z),this._colorPanel.addChild(this._colorBlock=new u$Z),this._colorPanel.addChild(this._colorInput=new u$T)},u$t.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},u$t.onPanelMouseDown=function(u$W){u$W.stopPropagation()},u$t.changePanel=function(){this._panelChanged=!1;var u$W=this._colorPanel.graphics;u$W.clear(),u$W.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(u$W=this._colorTiles.graphics).clear();for(var u$j=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],u$t=0;u$t<12;u$t++)for(var u$d=0;u$d<20;u$d++){var u$b=0;u$b=0===u$d?u$j[u$t]:1===u$d?0:51*(((3*u$t+u$d/6)%3<<0)+3*(u$t/6<<0))<<16|u$d%6*51<<8|(u$t<<0)%6*51;var u$E=u$x.toColor(u$b);this._colors.push(u$E);var u$O=u$d*this._gridSize,u$q=u$t*this._gridSize;u$W.drawRect(u$O,u$q,this._gridSize,this._gridSize,u$E,"#000000")}},u$t.onColorButtonClick=function(u$W){this._colorPanel.parent?this.close():this.open()},u$t.open=function(){var u$W=this.localToGlobal(new u$$),u$j=u$W.x+this._colorPanel.width<=u$e.stage.width?u$W.x:u$e.stage.width-this._colorPanel.width,u$t=u$W.y+this._colorButton.height;u$t=u$t+this._colorPanel.height<=u$e.stage.height?u$t:u$W.y-this._colorPanel.height,this._colorPanel.pos(u$j,u$t),this._colorPanel.zOrder=1001,u$e._currentStage.addChild(this._colorPanel),u$e.stage.on("mousedown",this,this.removeColorBox)},u$t.close=function(){u$e.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},u$t.removeColorBox=function(u$W){this.close()},u$t.onColorFieldKeyDown=function(u$W){13==u$W.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),u$W.stopPropagation())},u$t.onColorInputChange=function(u$W){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},u$t.onColorTilesClick=function(u$W){this.selectedColor=this.getColorByMouse(),this.close()},u$t.onColorTilesMouseMove=function(u$W){this._colorInput.focus=!1;var u$j=this.getColorByMouse();this._colorInput.text=u$j,this.drawBlock(u$j)},u$t.getColorByMouse=function(){var u$W=this._colorTiles.getMousePoint(),u$j=Math.floor(u$W.x/this._gridSize),u$t=Math.floor(u$W.y/this._gridSize);return this._colors[20*u$t+u$j]},u$t.drawBlock=function(u$W){var u$j=this._colorBlock.graphics;u$j.clear();var u$t=u$W||"#ffffff";u$j.drawRect(0,0,50,20,u$t,this._borderColor),u$W||u$j.drawLine(0,0,50,20,"#ff0000")},u$t.changeColor=function(){var u$W=this.graphics;u$W.clear();var u$j=this._selectedColor||"#000000";u$W.drawRect(0,0,this._colorButton.width,this._colorButton.height,u$j)},u$t._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},u$b(0,u$t,"inputBgColor",function(){return this._inputBgColor},function(u$W){this._inputBgColor=u$W,this._setPanelChanged()}),u$b(0,u$t,"selectedColor",function(){return this._selectedColor},function(u$W){this._selectedColor!=u$W&&(this._selectedColor=this._colorInput.text=u$W,this.drawBlock(u$W),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",u$A.EMPTY.setTo("change",this,this)))}),u$b(0,u$t,"skin",function(){return this._colorButton.skin},function(u$W){this._colorButton.skin=u$W,this.changeColor()}),u$b(0,u$t,"bgColor",function(){return this._bgColor},function(u$W){this._bgColor=u$W,this._setPanelChanged()}),u$b(0,u$t,"borderColor",function(){return this._borderColor},function(u$W){this._borderColor=u$W,this._setPanelChanged()}),u$b(0,u$t,"inputColor",function(){return this._inputColor},function(u$W){this._inputColor=u$W,this._setPanelChanged()}),u$W}(u$h),u$s=function(u$j){function u$t(u$W,u$j){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,u$t.__super.call(this),this._itemColors=u$V.comboBoxItemColors,this.skin=u$W,this.labels=u$j}u$E(u$t,"laya.ui.ComboBox",u$j);var u$W=u$t.prototype;return u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,u$W),this._button&&this._button.destroy(u$W),this._list&&this._list.destroy(u$W),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},u$W.createChildren=function(){this.addChild(this._button=new u$a),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},u$W._createList=function(){this._list=new u$P,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},u$W._setListEvent=function(u$W){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=u$Q.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},u$W.onListDown=function(u$W){u$W.stopPropagation()},u$W.onScrollBarDown=function(u$W){u$W.stopPropagation()},u$W.onButtonMouseDown=function(u$W){this.callLater(this.switchTo,[!this._isOpen])},u$W.changeList=function(){this._listChanged=!1;var u$W=this.width-2,u$j=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:u$W,height:this._itemHeight,fontSize:this._itemSize,color:u$j}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},u$W.onlistItemMouse=function(u$W,u$j){var u$t=u$W.type;if("mouseover"===u$t||"mouseout"===u$t){if(this._isCustomList)return;var u$d=this._list.getCell(u$j);if(!u$d)return;var u$b=u$d.getChildByName("label");u$b&&("mouseover"===u$t?(u$b.bgColor=this._itemColors[0],u$b.color=this._itemColors[1]):(u$b.bgColor=null,u$b.color=this._itemColors[2]))}else"click"===u$t&&(this.selectedIndex=u$j,this.isOpen=!1)},u$W.switchTo=function(u$W){this.isOpen=u$W},u$W.changeOpen=function(){this.isOpen=!this._isOpen},u$W.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var u$W=this._list.graphics;u$W.clear(),u$W.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var u$j=this._list.array||[],u$t=u$j.length=0,u$d=this._labels.length;u$t<u$d;u$t++)u$j.push({label:this._labels[u$t]});this._list.height=this._listHeight,this._list.array=u$j},u$W.changeSelected=function(){this._button.label=this.selectedLabel},u$W._onStageMouseWheel=function(u$W){this._list&&!this._list.contains(u$W.target)&&this.removeList(null)},u$W.removeList=function(u$W){u$e.stage.off("mousedown",this,this.removeList),u$e.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},u$b(0,u$W,"selectedIndex",function(){return this._selectedIndex},function(u$W){this._selectedIndex!=u$W&&(this._selectedIndex=u$W,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[u$A.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),u$b(0,u$W,"measureHeight",function(){return this._button.height}),u$b(0,u$W,"skin",function(){return this._button.skin},function(u$W){this._button.skin!=u$W&&(this._button.skin=u$W,this._listChanged=!0)}),u$b(0,u$W,"measureWidth",function(){return this._button.width}),u$b(0,u$W,"width",u$j.prototype._$get_width,function(u$W){u$e.superSet(u$h,this,"width",u$W),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),u$b(0,u$W,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(u$W){this.selectedIndex=this._labels.indexOf(u$W)}),u$b(0,u$W,"labels",function(){return this._labels.join(",")},function(u$W){0<this._labels.length&&(this.selectedIndex=-1),u$W?this._labels=u$W.split(","):this._labels.length=0,this._itemChanged=!0}),u$b(0,u$W,"height",u$j.prototype._$get_height,function(u$W){u$e.superSet(u$h,this,"height",u$W),this._button.height=this._height}),u$b(0,u$W,"selectHandler",function(){return this._selectHandler},function(u$W){this._selectHandler=u$W}),u$b(0,u$W,"visibleNum",function(){return this._visibleNum},function(u$W){this._visibleNum=u$W,this._listChanged=!0}),u$b(0,u$W,"labelBold",function(){return this._button.text.bold},function(u$W){this._button.text.bold=u$W}),u$b(0,u$W,"itemColors",function(){return String(this._itemColors)},function(u$W){this._itemColors=u$x.fillArray(this._itemColors,u$W,String),this._listChanged=!0}),u$b(0,u$W,"itemSize",function(){return this._itemSize},function(u$W){this._itemSize=u$W,this._listChanged=!0}),u$b(0,u$W,"scrollBar",function(){return this.list.scrollBar}),u$b(0,u$W,"isOpen",function(){return this._isOpen},function(u$W){if(this._isOpen!=u$W)if(this._isOpen=u$W,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var u$j=this.localToGlobal(u$$.TEMP.setTo(0,0)),u$t=u$j.y+this._button.height;u$t=u$t+this._listHeight<=u$e.stage.height?u$t:u$j.y-this._listHeight,this._list.pos(u$j.x,u$t),this._list.zOrder=1001,u$e._currentStage.addChild(this._list),u$e.stage.once("mousedown",this,this.removeList),u$e.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),u$b(0,u$W,"scrollBarSkin",function(){return this._scrollBarSkin},function(u$W){this._scrollBarSkin=u$W}),u$b(0,u$W,"sizeGrid",function(){return this._button.sizeGrid},function(u$W){this._button.sizeGrid=u$W}),u$b(0,u$W,"button",function(){return this._button}),u$b(0,u$W,"list",function(){return this._list||this._createList(),this._list},function(u$W){u$W&&(u$W.removeSelf(),this._isCustomList=!0,this._list=u$W,this._setListEvent(u$W),this._itemHeight=u$W.getCell(0).height+u$W.spaceY)}),u$b(0,u$W,"dataSource",u$j.prototype._$get_dataSource,function(u$W){"number"==typeof(this._dataSource=u$W)&&Math.floor(u$W)==u$W||"string"==typeof u$W?this.selectedIndex=parseInt(u$W):u$W instanceof Array?this.labels=u$W.join(","):u$e.superSet(u$h,this,"dataSource",u$W)}),u$b(0,u$W,"labelColors",function(){return this._button.labelColors},function(u$W){this._button.labelColors!=u$W&&(this._button.labelColors=u$W)}),u$b(0,u$W,"labelPadding",function(){return this._button.text.padding.join(",")},function(u$W){this._button.text.padding=u$x.fillArray(u$V.labelPadding,u$W,Number)}),u$b(0,u$W,"labelSize",function(){return this._button.text.fontSize},function(u$W){this._button.text.fontSize=u$W}),u$b(0,u$W,"labelFont",function(){return this._button.text.font},function(u$W){this._button.text.font=u$W}),u$b(0,u$W,"stateNum",function(){return this._button.stateNum},function(u$W){this._button.stateNum=u$W}),u$t}(u$h),u$Y=function(u$j){function u$t(u$W){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,u$t.__super.call(this),this._showButtons=u$G.showButtons,this._touchScrollEnable=u$G.touchScrollEnable,this._mouseWheelEnable=u$G.mouseWheelEnable,this.skin=u$W,this.max=1}u$E(u$t,"laya.ui.ScrollBar",u$j);var u$W=u$t.prototype;return u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),this.stopScroll(),this.target=null,u$j.prototype.destroy.call(this,u$W),this.upButton&&this.upButton.destroy(u$W),this.downButton&&this.downButton.destroy(u$W),this.slider&&this.slider.destroy(u$W),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},u$W.createChildren=function(){this.addChild(this.slider=new u$H),this.addChild(this.upButton=new u$a),this.addChild(this.downButton=new u$a)},u$W.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},u$W.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},u$W.onButtonMouseDown=function(u$W){var u$j=u$W.currentTarget===this.upButton;this.slide(u$j),u$e.timer.once(u$V.scrollBarDelayTime,this,this.startLoop,[u$j]),u$e.stage.once("mouseup",this,this.onStageMouseUp)},u$W.startLoop=function(u$W){u$e.timer.frameLoop(1,this,this.slide,[u$W])},u$W.slide=function(u$W){u$W?this.value-=this._scrollSize:this.value+=this._scrollSize},u$W.onStageMouseUp=function(u$W){u$e.timer.clear(this,this.startLoop),u$e.timer.clear(this,this.slide)},u$W.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},u$W.changeSize=function(){u$j.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},u$W.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},u$W.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},u$W.setScroll=function(u$W,u$j,u$t){this.runCallLater(this.changeSize),this.slider.setSlider(u$W,u$j,u$t),this.slider.bar.visible=0<u$j,!this._hide&&this.autoHide&&(this.visible=!1)},u$W.onTargetMouseWheel=function(u$W){this.value-=u$W.delta*this._scrollSize,this.target=this._target},u$W.onTargetMouseDown=function(u$W){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new u$$),this._lastPoint.setTo(u$e.stage.mouseX,u$e.stage.mouseY),u$e.timer.clear(this,this.tweenMove),u$N.clearTween(this),u$e.stage.once("mouseup",this,this.onStageMouseUp2),u$e.stage.once("mouseout",this,this.onStageMouseUp2),u$e.timer.frameLoop(1,this,this.loop)},u$W.loop=function(){var u$W=u$e.stage.mouseY,u$j=u$e.stage.mouseX;if(this._lastOffset=this.isVertical?u$W-this._lastPoint.y:u$j-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?u$e.stage._canvasTransform.getScaleY():u$e.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=u$j,this._lastPoint.y=u$W,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},u$W.onStageMouseUp2=function(u$W){if(u$e.stage.off("mouseup",this,this.onStageMouseUp2),u$e.stage.off("mouseout",this,this.onStageMouseUp2),u$e.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?u$N.to(this,{value:this.min},this.elasticBackTime,u$q.sineOut,u$Q.create(this,this.elasticOver)):this._value>this.max&&u$N.to(this,{value:this.max},this.elasticBackTime,u$q.sineOut,u$Q.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?u$e.stage.mouseY-this._lastPoint.y:u$e.stage.mouseX-this._lastPoint.x);for(var u$j=0,u$t=Math.min(this._offsets.length,3),u$d=0;u$d<u$t;u$d++)u$j+=this._offsets[this._offsets.length-1-u$d];if(this._lastOffset=u$j/u$t,(u$j=Math.abs(this._lastOffset))<2)return void this.event("end");60<u$j&&(this._lastOffset=0<this._lastOffset?60:-60);var u$b=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));u$e.timer.frameLoop(1,this,this.tweenMove,[u$b])}},u$W.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&u$N.to(this,{alpha:0},500),this.event("end")},u$W.tweenMove=function(u$W){this._lastOffset*=this.rollRatio;var u$j=NaN;if(0<u$W&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,u$j=.5*-(this.min-u$W-this.value),this._lastOffset>u$j&&(this._lastOffset=u$j)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,u$j=.5*-(this.max+u$W-this.value),this._lastOffset<u$j&&(this._lastOffset=u$j))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(u$e.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?u$N.to(this,{value:this.min},this.elasticBackTime,u$q.sineOut,u$Q.create(this,this.elasticOver)):this._value>this.max?u$N.to(this,{value:this.max},this.elasticBackTime,u$q.sineOut,u$Q.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&u$N.to(this,{alpha:0},500)}},u$W.stopScroll=function(){this.onStageMouseUp2(null),u$e.timer.clear(this,this.tweenMove),u$N.clearTween(this)},u$b(0,u$W,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),u$b(0,u$W,"skin",function(){return this._skin},function(u$W){this._skin!=u$W&&(this._skin=u$W,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),u$b(0,u$W,"max",function(){return this.slider.max},function(u$W){this.slider.max=u$W}),u$b(0,u$W,"showButtons",function(){return this._showButtons},function(u$W){this._showButtons=u$W,this.callLater(this.changeScrollBar)}),u$b(0,u$W,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),u$b(0,u$W,"min",function(){return this.slider.min},function(u$W){this.slider.min=u$W}),u$b(0,u$W,"value",function(){return this._value},function(u$W){u$W!==this._value&&(this._value=u$W,this._isElastic||(this.slider._value!=u$W&&(this.slider._value=u$W,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),u$b(0,u$W,"isVertical",function(){return this.slider.isVertical},function(u$W){this.slider.isVertical=u$W}),u$b(0,u$W,"sizeGrid",function(){return this.slider.sizeGrid},function(u$W){this.slider.sizeGrid=u$W}),u$b(0,u$W,"scrollSize",function(){return this._scrollSize},function(u$W){this._scrollSize=u$W}),u$b(0,u$W,"dataSource",u$j.prototype._$get_dataSource,function(u$W){"number"==typeof(this._dataSource=u$W)||"string"==typeof u$W?this.value=Number(u$W):u$e.superSet(u$h,this,"dataSource",u$W)}),u$b(0,u$W,"thumbPercent",function(){return this._thumbPercent},function(u$W){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),u$W=1<=u$W?.99:u$W,this._thumbPercent=u$W,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*u$W,u$V.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*u$W,u$V.scrollBarMinNum))}),u$b(0,u$W,"target",function(){return this._target},function(u$W){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=u$W)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),u$b(0,u$W,"hide",function(){return this._hide},function(u$W){this._hide=u$W,this.visible=!u$W}),u$b(0,u$W,"touchScrollEnable",function(){return this._touchScrollEnable},function(u$W){this._touchScrollEnable=u$W,this.target=this._target}),u$b(0,u$W,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(u$W){this._mouseWheelEnable=u$W,this.target=this._target}),u$b(0,u$W,"tick",function(){return this.slider.tick},function(u$W){this.slider.tick=u$W}),u$t}(u$h),u$H=function(u$j){function u$t(u$W){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,u$t.__super.call(this),this.skin=u$W}u$E(u$t,"laya.ui.Slider",u$j);var u$W=u$t.prototype;return u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,u$W),this._bg&&this._bg.destroy(u$W),this._bar&&this._bar.destroy(u$W),this._progress&&this._progress.destroy(u$W),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},u$W.createChildren=function(){this.addChild(this._bg=new u$I),this.addChild(this._bar=new u$a)},u$W.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},u$W.onBarMouseDown=function(u$W){this._globalSacle||(this._globalSacle=new u$$),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=u$e.stage.mouseX,this._ty=u$e.stage.mouseY,u$e.stage.on("mousemove",this,this.mouseMove),u$e.stage.once("mouseup",this,this.mouseUp),u$e.stage.once("mouseout",this,this.mouseUp),this.showValueText()},u$W.showValueText=function(){if(this.showLabel){var u$W=laya.ui.Slider.label;this.addChild(u$W),u$W.textField.changeText(this._value+""),this.isVertical?(u$W.x=this._bar.x+20,u$W.y=.5*(this._bar.height-u$W.height)+this._bar.y):(u$W.y=this._bar.y-20,u$W.x=.5*(this._bar.width-u$W.width)+this._bar.x)}},u$W.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},u$W.mouseUp=function(u$W){u$e.stage.off("mousemove",this,this.mouseMove),u$e.stage.off("mouseup",this,this.mouseUp),u$e.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},u$W.mouseMove=function(u$W){var u$j=this._value;this.isVertical?(this._bar.y+=(u$e.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(u$e.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=u$e.stage.mouseX,this._ty=u$e.stage.mouseY;var u$t=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*u$t)/u$t,this._value!=u$j&&this.sendChangeEvent(),this.showValueText()},u$W.sendChangeEvent=function(u$W){void 0===u$W&&(u$W="change"),this.event(u$W),this.changeHandler&&this.changeHandler.runWith(this._value)},u$W.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},u$W.changeSize=function(){u$j.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},u$W.setSlider=function(u$W,u$j,u$t){this._value=-1,this._min=u$W,this._max=u$W<u$j?u$j:u$W,this.value=u$t<u$W?u$W:u$j<u$t?u$j:u$t},u$W.changeValue=function(){var u$W=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*u$W)/u$W,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var u$j=this._max-this._min;0===u$j&&(u$j=1),this.isVertical?(this._bar.y=(this._value-this._min)/u$j*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/u$j*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},u$W.onBgMouseDown=function(u$W){var u$j=this._bg.getMousePoint();this.isVertical?this.value=u$j.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=u$j.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},u$b(0,u$W,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),u$b(0,u$W,"skin",function(){return this._skin},function(u$W){if(this._skin!=u$W){this._skin=u$W,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var u$j=this._skin.replace(".png","$progress.png");u$S.getRes(u$j)&&(this._progress||(this.addChild(this._progress=new u$I),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=u$j),this.setBarPoint(),this.callLater(this.changeValue)}}),u$b(0,u$W,"allowClickBack",function(){return this._allowClickBack},function(u$W){this._allowClickBack!=u$W&&((this._allowClickBack=u$W)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),u$b(0,u$W,"max",function(){return this._max},function(u$W){this._max!=u$W&&(this._max=u$W,this.callLater(this.changeValue))}),u$b(0,u$W,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),u$b(0,u$W,"tick",function(){return this._tick},function(u$W){this._tick!=u$W&&(this._tick=u$W,this.callLater(this.changeValue))}),u$b(0,u$W,"sizeGrid",function(){return this._bg.sizeGrid},function(u$W){this._bg.sizeGrid=u$W,this._bar.sizeGrid=u$W,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),u$b(0,u$W,"min",function(){return this._min},function(u$W){this._min!=u$W&&(this._min=u$W,this.callLater(this.changeValue))}),u$b(0,u$W,"value",function(){return this._value},function(u$W){if(this._value!=u$W){var u$j=this._value;this._value=u$W,this.changeValue(),this._value!=u$j&&this.sendChangeEvent()}}),u$b(0,u$W,"dataSource",u$j.prototype._$get_dataSource,function(u$W){"number"==typeof(this._dataSource=u$W)||"string"==typeof u$W?this.value=Number(u$W):u$e.superSet(u$h,this,"dataSource",u$W)}),u$b(0,u$W,"bar",function(){return this._bar}),u$d(u$t,["label",function(){return this.label=new u$g}]),u$t}(u$h),u$I=function(u$j){function u$t(u$W){this._bitmap=null,this._skin=null,this._group=null,u$t.__super.call(this),this.skin=u$W}u$E(u$t,"laya.ui.Image",u$j);var u$W=u$t.prototype;return u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,u$S.clearCache(this,this._skin)},u$W.dispose=function(){this.destroy(!0),u$S.clearCache(this,this._skin)},u$W.createChildren=function(){this.graphics=this._bitmap=new u$l},u$W.setSource=function(u$W,u$j){u$W===this._skin&&u$j&&(this.source=u$j,this.onCompResize())},u$b(0,u$W,"source",function(){return this._bitmap.source},function(u$W){this._bitmap&&(this._bitmap.source=u$W,this.event("loaded"),this.repaint())}),u$b(0,u$W,"dataSource",u$j.prototype._$get_dataSource,function(u$W){"string"==typeof(this._dataSource=u$W)?this.skin=u$W:u$e.superSet(u$h,this,"dataSource",u$W)}),u$b(0,u$W,"measureHeight",function(){return this._bitmap.height}),u$b(0,u$W,"skin",function(){return this._skin},function(u$W){if(this._skin!=u$W)if(u$S.clearCache(this,this._skin),this._skin=u$W){u$S.keepCache(this,this._skin);var u$j=u$S.getRes(u$W);u$j?(this.source=u$j,this.onCompResize()):u$e.loader.load(this._skin,u$Q.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),u$b(0,u$W,"group",function(){return this._group},function(u$W){u$W&&this._skin&&u$S.setGroup(this._skin,u$W),this._group=u$W}),u$b(0,u$W,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(u$W){this._bitmap.sizeGrid=u$x.fillArray(u$V.defaultSizeGrid,u$W,Number)}),u$b(0,u$W,"measureWidth",function(){return this._bitmap.width}),u$b(0,u$W,"width",u$j.prototype._$get_width,function(u$W){u$e.superSet(u$h,this,"width",u$W),this._bitmap.width=0==u$W?1e-7:u$W}),u$b(0,u$W,"height",u$j.prototype._$get_height,function(u$W){u$e.superSet(u$h,this,"height",u$W),this._bitmap.height=0==u$W?1e-7:u$W}),u$t}(u$h),u$g=function(u$j){function u$t(u$W){this._tf=null,u$t.__super.call(this),void 0===u$W&&(u$W=""),u$c.defaultColor=u$V.labelColor,this.text=u$W}u$E(u$t,"laya.ui.Label",u$j);var u$W=u$t.prototype;return u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,u$W),this._tf=null},u$W.createChildren=function(){this.addChild(this._tf=new u$X)},u$W.changeText=function(u$W){this._tf.changeText(u$W)},u$b(0,u$W,"padding",function(){return this._tf.padding.join(",")},function(u$W){this._tf.padding=u$x.fillArray(u$V.labelPadding,u$W,Number)}),u$b(0,u$W,"bold",function(){return this._tf.bold},function(u$W){this._tf.bold=u$W}),u$b(0,u$W,"align",function(){return this._tf.align},function(u$W){this._tf.align=u$W}),u$b(0,u$W,"text",function(){return this._tf.text},function(u$W){this._tf.text!=u$W&&(u$W&&(u$W=u$x.adptString(u$W+"")),this._tf.text=u$W,this.event("change"),this._width&&this._height||this.onCompResize())}),u$b(0,u$W,"italic",function(){return this._tf.italic},function(u$W){this._tf.italic=u$W}),u$b(0,u$W,"wordWrap",function(){return this._tf.wordWrap},function(u$W){this._tf.wordWrap=u$W}),u$b(0,u$W,"font",function(){return this._tf.font},function(u$W){this._tf.font=u$W}),u$b(0,u$W,"dataSource",u$j.prototype._$get_dataSource,function(u$W){"number"==typeof(this._dataSource=u$W)||"string"==typeof u$W?this.text=u$W+"":u$e.superSet(u$h,this,"dataSource",u$W)}),u$b(0,u$W,"color",function(){return this._tf.color},function(u$W){this._tf.color=u$W}),u$b(0,u$W,"valign",function(){return this._tf.valign},function(u$W){this._tf.valign=u$W}),u$b(0,u$W,"leading",function(){return this._tf.leading},function(u$W){this._tf.leading=u$W}),u$b(0,u$W,"fontSize",function(){return this._tf.fontSize},function(u$W){this._tf.fontSize=u$W}),u$b(0,u$W,"bgColor",function(){return this._tf.bgColor},function(u$W){this._tf.bgColor=u$W}),u$b(0,u$W,"borderColor",function(){return this._tf.borderColor},function(u$W){this._tf.borderColor=u$W}),u$b(0,u$W,"stroke",function(){return this._tf.stroke},function(u$W){this._tf.stroke=u$W}),u$b(0,u$W,"strokeColor",function(){return this._tf.strokeColor},function(u$W){this._tf.strokeColor=u$W}),u$b(0,u$W,"textField",function(){return this._tf}),u$b(0,u$W,"measureWidth",function(){return this._tf.width}),u$b(0,u$W,"measureHeight",function(){return this._tf.height}),u$b(0,u$W,"width",function(){return this._width||this._tf.text?u$e.superGet(u$h,this,"width"):0},function(u$W){u$e.superSet(u$h,this,"width",u$W),this._tf.width=u$W}),u$b(0,u$W,"height",function(){return this._height||this._tf.text?u$e.superGet(u$h,this,"height"):0},function(u$W){u$e.superSet(u$h,this,"height",u$W),this._tf.height=u$W}),u$b(0,u$W,"overflow",function(){return this._tf.overflow},function(u$W){this._tf.overflow=u$W}),u$b(0,u$W,"underline",function(){return this._tf.underline},function(u$W){this._tf.underline=u$W}),u$b(0,u$W,"underlineColor",function(){return this._tf.underlineColor},function(u$W){this._tf.underlineColor=u$W}),u$t}(u$h),u$f=function(u$j){function u$t(u$W){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,u$t.__super.call(this),this.skin=u$W}u$E(u$t,"laya.ui.ProgressBar",u$j);var u$W=u$t.prototype;return u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,u$W),this._bg&&this._bg.destroy(u$W),this._bar&&this._bar.destroy(u$W),this._bg=this._bar=null,this.changeHandler=null},u$W.createChildren=function(){this.addChild(this._bg=new u$I),this.addChild(this._bar=new u$I)},u$W.changeValue=function(){if(this.sizeGrid){var u$W=this.sizeGrid.split(","),u$j=Number(u$W[3]),u$t=Number(u$W[1]),u$d=(this.width-u$j-u$t)*this._value;this._bar.width=u$j+u$t+u$d,this._bar.visible=this._bar.width>u$j+u$t}else this._bar.width=this.width*this._value},u$b(0,u$W,"measureHeight",function(){return this._bg.height}),u$b(0,u$W,"skin",function(){return this._skin},function(u$W){this._skin!=u$W&&(this._skin=u$W,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),u$b(0,u$W,"measureWidth",function(){return this._bg.width}),u$b(0,u$W,"height",u$j.prototype._$get_height,function(u$W){u$e.superSet(u$h,this,"height",u$W),this._bg.height=this._height,this._bar.height=this._height}),u$b(0,u$W,"bar",function(){return this._bar}),u$b(0,u$W,"value",function(){return this._value},function(u$W){this._value!=u$W&&(u$W=1<u$W?1:u$W<0?0:u$W,this._value=u$W,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(u$W))}),u$b(0,u$W,"bg",function(){return this._bg}),u$b(0,u$W,"sizeGrid",function(){return this._bg.sizeGrid},function(u$W){this._bg.sizeGrid=this._bar.sizeGrid=u$W}),u$b(0,u$W,"width",u$j.prototype._$get_width,function(u$W){u$e.superSet(u$h,this,"width",u$W),this._bg.width=this._width,this.callLater(this.changeValue)}),u$b(0,u$W,"dataSource",u$j.prototype._$get_dataSource,function(u$W){"number"==typeof(this._dataSource=u$W)||"string"==typeof u$W?this.value=Number(u$W):u$e.superSet(u$h,this,"dataSource",u$W)}),u$t}(u$h),u$w=(function(u$W){function u$t(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,u$t.__super.call(this),this._tipBox=new u$h,this._tipBox.addChild(this._tipText=new u$X),this._tipText.x=this._tipText.y=5,this._tipText.color=u$t.tipTextColor,this._defaultTipHandler=this._showDefaultTip,u$e.stage.on("showtip",this,this._onStageShowTip),u$e.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}u$E(u$t,"laya.ui.TipManager",u$h);var u$j=u$t.prototype;u$j._onStageHideTip=function(u$W){u$e.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},u$j._onStageShowTip=function(u$W){u$e.timer.once(u$t.tipDelay,this,this._showTip,[u$W],!0)},u$j._showTip=function(u$W){if("string"==typeof u$W){var u$j=String(u$W);Boolean(u$j)&&this._defaultTipHandler(u$j)}else u$W instanceof laya.utils.Handler?u$W.run():"function"==typeof u$W&&u$W.apply();u$e.stage.on("mousemove",this,this._onStageMouseMove),u$e.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},u$j._onStageMouseDown=function(u$W){this.closeAll()},u$j._onStageMouseMove=function(u$W){this._showToStage(this,u$t.offsetX,u$t.offsetY)},u$j._showToStage=function(u$W,u$j,u$t){void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0);var u$d=u$W.getBounds();u$W.x=u$e.stage.mouseX+u$j,u$W.y=u$e.stage.mouseY+u$t,u$W.x+u$d.width>u$e.stage.width&&(u$W.x-=u$d.width+u$j),u$W.y+u$d.height>u$e.stage.height&&(u$W.y-=u$d.height+u$t)},u$j.closeAll=function(){u$e.timer.clear(this,this._showTip),u$e.stage.off("mousemove",this,this._onStageMouseMove),u$e.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},u$j.showDislayTip=function(u$W){this.addChild(u$W),this._showToStage(this),u$e._currentStage.addChild(this)},u$j._showDefaultTip=function(u$W){this._tipText.text=u$W;var u$j=this._tipBox.graphics;u$j.clear(),u$j.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,u$t.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),u$e._currentStage.addChild(this)},u$b(0,u$j,"defaultTipHandler",function(){return this._defaultTipHandler},function(u$W){this._defaultTipHandler=u$W}),u$t.offsetX=10,u$t.offsetY=15,u$t.tipTextColor="#ffffff",u$t.tipBackColor="#111111",u$t.tipDelay=200}(),function(u$W){var u$T;function u$$(){this._idMap=null,this._aniList=null,this._watchMap={},u$$.__super.call(this)}u$E(u$$,"laya.ui.View",u$y);var u$j=u$$.prototype;return u$j.createView=function(u$W){if(u$W.animations&&!this._idMap&&(this._idMap={}),u$$.createComp(u$W,this,this),u$W.animations){var u$j,u$t,u$d=[],u$b=u$W.animations,u$E=0,u$O=u$b.length;for(u$E=0;u$E<u$O;u$E++){switch(u$j=new u$R,u$t=u$b[u$E],u$j._setUp(this._idMap,u$t),(this[u$t.name]=u$j)._setControlNode(this),u$t.action){case 1:u$j.play(0,!1);break;case 2:u$j.play(0,!0)}u$d.push(u$j)}this._aniList=u$d}0<this._width&&null==u$W.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},u$j.onEvent=function(u$W,u$j){},u$j.loadUI=function(u$W){var u$j=u$$.uiMap[u$W];u$j&&this.createView(u$j)},u$j.destroy=function(u$W){void 0===u$W&&(u$W=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,u$W)},u$j.changeData=function(u$W){var u$j=this._watchMap[u$W];if(u$j){console.log("change",u$W);for(var u$t=0,u$d=u$j.length;u$t<u$d;u$t++){u$j[u$t].exe(this)}}},u$$._regs=function(){for(var u$W in u$$.uiClassMap)u$K.regClass(u$W,u$$.uiClassMap[u$W])},u$$.createComp=function(u$W,u$j,u$t,u$d){if(!(u$j=u$j||u$$.getCompInstance(u$W)))return console.warn("can not create:"+u$W.type),null;var u$b=u$W.child;if(u$b)for(var u$E=u$j instanceof laya.ui.List,u$O=0,u$q=u$b.length;u$O<u$q;u$O++){var u$A=u$b[u$O];if(!u$j.hasOwnProperty("itemRender")||"render"!=u$A.props.name&&"render"!==u$A.props.renderType)if("Graphic"==u$A.type)u$K.addGraphicsToSprite(u$A,u$j);else if(u$K.isDrawType(u$A.type))u$K.addGraphicToSprite(u$A,u$j,!0);else{if(u$E){var u$c=[],u$R=u$$.createComp(u$A,null,u$t,u$c);u$c.length&&(u$R._$bindData=u$c)}else u$R=u$$.createComp(u$A,null,u$t,u$d);"Script"==u$A.type?"owner"in u$R?u$R.owner=u$j:"target"in u$R&&(u$R.target=u$j):"mask"==u$A.props.renderType||"mask"==u$A.props.name?u$j.mask=u$R:u$R instanceof laya.display.Sprite&&u$j.addChild(u$R)}else u$j.itemRender=u$A}var u$m=u$W.props;for(var u$Q in u$m){var u$T=u$m[u$Q];u$$.eventDic[u$Q]?u$T&&u$t&&u$j.on(u$Q,u$t,u$t.onEvent,[u$T]):u$$.setCompValue(u$j,u$Q,u$T,u$t,u$d)}return u$e.__typeof(u$j,"laya.ui.IItem")&&u$j.initItems(),u$W.compId&&u$t&&u$t._idMap&&(u$t._idMap[u$W.compId]=u$j),u$j},u$$.setCompValue=function(u$W,u$j,u$t,u$d,u$b){if("string"==typeof u$t&&-1<u$t.indexOf("${")){if(u$$._sheet||(u$$._sheet=u$K.getClass("laya.data.Table")),!u$$._sheet)return void console.warn("Can not find class Sheet");if(u$b)u$b.push(u$W,u$j,u$t);else if(u$d){-1==u$t.indexOf("].")&&(u$t=u$t.replace(".","[0]."));var u$E,u$O,u$q=new u$T(u$W,u$j,u$t);u$q.exe(u$d);for(var u$A=u$t.replace(/\[.*?\]\./g,".");null!=(u$E=u$$._parseWatchData.exec(u$A));){for(var u$c=u$E[1];null!=(u$O=u$$._parseKeyWord.exec(u$c));){var u$R=u$O[0],u$m=u$d._watchMap[u$R]||(u$d._watchMap[u$R]=[]);u$m.push(u$q),u$$._sheet.I.notifer.on(u$R,u$d,u$d.changeData,[u$R])}(u$m=u$d._watchMap[u$c]||(u$d._watchMap[u$c]=[])).push(u$q),u$$._sheet.I.notifer.on(u$c,u$d,u$d.changeData,[u$c])}}}else if("var"===u$j&&u$d)u$d[u$t]=u$W;else if("onClick"==u$j){var u$Q=u$e._runScript("(function(){"+u$t+"})");u$W.on("click",u$d,u$Q)}else u$W[u$j]="true"===u$t||"false"!==u$t&&u$t},u$$.getCompInstance=function(u$W){var u$j,u$t=u$W.props?u$W.props.runtime:null;return u$j=u$t?u$$.viewClassMap[u$t]||u$$.uiClassMap[u$t]||u$e.__classmap[u$t]:u$$.uiClassMap[u$W.type],u$W.props&&u$W.props.hasOwnProperty("renderType")&&"instance"==u$W.props.renderType?u$j.instance:u$j?new u$j:null},u$$.regComponent=function(u$W,u$j){u$$.uiClassMap[u$W]=u$j,u$K.regClass(u$W,u$j)},u$$.regViewRuntime=function(u$W,u$j){u$$.viewClassMap[u$W]=u$j},u$$.uiMap={},u$$.viewClassMap={},u$$._sheet=null,u$d(u$$,["uiClassMap",function(){return this.uiClassMap={ViewStack:u$WW,LinkButton:u$a,TextArea:u$cW,ColorPicker:u$D,Box:u$y,Button:u$a,CheckBox:u$U,Clip:u$u,ComboBox:u$s,Component:u$h,HScrollBar:u$i,HSlider:u$n,Image:u$I,Label:u$g,List:u$P,Panel:u$B,ProgressBar:u$f,Radio:u$p,RadioGroup:u$qW,ScrollBar:u$Y,Slider:u$H,Tab:u$AW,TextInput:u$tW,View:u$$,VScrollBar:u$jW,VSlider:u$dW,Tree:u$F,HBox:u$EW,VBox:u$OW,Sprite:u$Z,Animation:u$t,Text:u$X,FontClip:u$r}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),u$$.__init$=function(){u$$._regs(),u$T=function(){function u$W(u$W,u$j,u$t){this.comp=null,this.prop=null,this.value=null,this.comp=u$W,this.prop=u$j,this.value=u$t}return u$E(u$W,""),u$W.prototype.exe=function(u$W){var u$j=u$x.getBindFun(this.value);this.comp[this.prop]=u$j.call(this,u$W)},u$W}()},u$$}()),u$U=function(u$W){function u$t(u$W,u$j){void 0===u$j&&(u$j=""),u$t.__super.call(this,u$W,u$j)}u$E(u$t,"laya.ui.CheckBox",u$W);var u$j=u$t.prototype;return u$j.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},u$j.initialize=function(){u$W.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},u$b(0,u$j,"dataSource",u$W.prototype._$get_dataSource,function(u$W){"boolean"==typeof(this._dataSource=u$W)?this.selected=u$W:"string"==typeof u$W?this.selected="true"===u$W:u$e.superSet(u$a,this,"dataSource",u$W)}),u$t}(u$a),u$J=function(u$W){function u$j(){this._space=0,this._align="none",this._itemChanged=!1,u$j.__super.call(this)}u$E(u$j,"laya.ui.LayoutBox",u$y);var u$t=u$j.prototype;return u$t.addChild=function(u$W){return u$W.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,u$W)},u$t.onResize=function(u$W){this._setItemChanged()},u$t.addChildAt=function(u$W,u$j){return u$W.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,u$W,u$j)},u$t.removeChild=function(u$W){return u$W.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,u$W)},u$t.removeChildAt=function(u$W){return this.getChildAt(u$W).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,u$W)},u$t.refresh=function(){this._setItemChanged()},u$t.changeItems=function(){this._itemChanged=!1},u$t.sortItem=function(u$W){u$W&&u$W.sort(function(u$W,u$j){return u$W.y-u$j.y})},u$t._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},u$b(0,u$t,"space",function(){return this._space},function(u$W){this._space=u$W,this._setItemChanged()}),u$b(0,u$t,"align",function(){return this._align},function(u$W){this._align=u$W,this._setItemChanged()}),u$j}(),u$r=function(u$j){function u$t(u$W,u$j){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,u$t.__super.call(this),u$W&&(this.skin=u$W),u$j&&(this.sheet=u$j)}u$E(u$t,"laya.ui.FontClip",u$j);var u$W=u$t.prototype;return u$W.createChildren=function(){this._bitmap=new u$l,this.on("loaded",this,this._onClipLoaded)},u$W._onClipLoaded=function(){this.callLater(this.changeValue)},u$W.changeValue=function(){var u$W;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),u$W=this._sources[0]))){var u$j="horizontal"===this._direction;u$j?(this._wordsW=this._valueArr.length*(u$W.sourceWidth+this.spaceX),this._wordsH=u$W.sourceHeight):(this._wordsW=u$W.sourceWidth,this._wordsH=(u$W.sourceHeight+this.spaceY)*this._valueArr.length);var u$t=0;if(this._width)switch(this._align){case"center":u$t=.5*(this._width-this._wordsW);break;case"right":u$t=this._width-this._wordsW;break;default:u$t=0}for(var u$d=0,u$b=this._valueArr.length;u$d<u$b;u$d++){var u$E=this._indexMap[this._valueArr.charAt(u$d)];this.sources[u$E]&&(u$W=this.sources[u$E],u$j?this.graphics.drawTexture(u$W,u$t+u$d*(u$W.sourceWidth+this.spaceX),0,u$W.sourceWidth,u$W.sourceHeight):this.graphics.drawTexture(u$W,0+u$t,u$d*(u$W.sourceHeight+this.spaceY),u$W.sourceWidth,u$W.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),u$j.prototype.destroy.call(this,u$W)},u$b(0,u$W,"sheet",function(){return this._sheet},function(u$W){u$W+="";var u$j=(this._sheet=u$W).split(" ");this._clipX=String(u$j[0]).length,this.clipY=u$j.length,this._indexMap={};for(var u$t=0;u$t<this._clipY;u$t++)for(var u$d=u$j[u$t].split(""),u$b=0,u$E=u$d.length;u$b<u$E;u$b++)this._indexMap[u$d[u$b]]=u$t*this._clipX+u$b}),u$b(0,u$W,"height",u$j.prototype._$get_height,function(u$W){u$e.superSet(u$u,this,"height",u$W),this.callLater(this.changeValue)}),u$b(0,u$W,"direction",function(){return this._direction},function(u$W){this._direction=u$W,this.callLater(this.changeValue)}),u$b(0,u$W,"value",function(){return this._valueArr?this._valueArr:""},function(u$W){u$W+="",this._valueArr=u$W,this.callLater(this.changeValue)}),u$b(0,u$W,"width",u$j.prototype._$get_width,function(u$W){u$e.superSet(u$u,this,"width",u$W),this.callLater(this.changeValue)}),u$b(0,u$W,"spaceX",function(){return this._spaceX},function(u$W){this._spaceX=u$W,"horizontal"===this._direction&&this.callLater(this.changeValue)}),u$b(0,u$W,"spaceY",function(){return this._spaceY},function(u$W){this._spaceY=u$W,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),u$b(0,u$W,"align",function(){return this._align},function(u$W){this._align=u$W,this.callLater(this.changeValue)}),u$b(0,u$W,"measureWidth",function(){return this._wordsW}),u$b(0,u$W,"measureHeight",function(){return this._wordsH}),u$t}(u$u),u$P=function(u$W){function u$j(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new u$$,u$j.__super.call(this)}u$E(u$j,"laya.ui.List",u$W);var u$t=u$j.prototype;return u$e.imps(u$t,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),u$t.destroy=function(u$W){void 0===u$W&&(u$W=!0),this._content&&this._content.destroy(u$W),this._scrollBar&&this._scrollBar.destroy(u$W),laya.ui.Component.prototype.destroy.call(this,u$W),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},u$t.createChildren=function(){this.addChild(this._content=new u$y)},u$t.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=u$e.superGet(u$y,this,"cacheAs")),u$e.superSet(u$y,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},u$t.onScrollEnd=function(){u$e.superSet(u$y,this,"cacheAs",this._$P.cacheAs)},u$t._removePreScrollBar=function(){var u$W=this.removeChildByName("scrollBar");u$W&&u$W.destroy(!0)},u$t.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var u$W=this._getOneCell(),u$j=u$W.width+this._spaceX||1,u$t=u$W.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/u$j):Math.ceil(this._width/u$j)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/u$t):Math.round(this._height/u$t));var u$d=this._width?this._width:u$j*this.repeatX-this._spaceX,u$b=this._height?this._height:u$t*this.repeatY-this._spaceY;this._cellSize=this._isVertical?u$t:u$j,this._cellOffset=this._isVertical?u$t*Math.max(this._repeatY2,this._repeatY)-u$b-this._spaceY:u$j*Math.max(this._repeatX2,this._repeatX)-u$d-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=u$b:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=u$d),this.setContentSize(u$d,u$b);var u$E=this._isVertical?this.repeatX:this.repeatY,u$O=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,u$E,u$O),this._createdLine=u$O,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},u$t._getOneCell=function(){if(0===this._cells.length){var u$W=this.createItem();if(this._offset.setTo(u$W.x,u$W.y),this.cacheContent)return u$W;this._cells.push(u$W)}return this._cells[0]},u$t._createItems=function(u$W,u$j,u$t){var u$d=this._content,u$b=this._getOneCell(),u$E=u$b.width+this._spaceX,u$O=u$b.height+this._spaceY;if(this.cacheContent){var u$q=new u$y;u$q.cacheAsBitmap=!0,u$q.pos((this._isVertical?0:u$W)*u$E,(this._isVertical?u$W:0)*u$O),this._content.addChild(u$q),this._content.optimizeScrollRect=!0,u$d=u$q}else{for(var u$A=[],u$c=this._cells.length-1;-1<u$c;u$c--){var u$R=this._cells[u$c];u$R.removeSelf(),u$A.push(u$R)}this._cells.length=0}for(var u$m=u$W;u$m<u$t;u$m++)for(var u$Q=0;u$Q<u$j;u$Q++)(u$b=u$A&&u$A.length?u$A.pop():this.createItem()).x=(this._isVertical?u$Q:u$m)*u$E-u$d.x,u$b.y=(this._isVertical?u$m:u$Q)*u$O-u$d.y,u$b.name="item"+(u$m*u$j+u$Q),u$d.addChild(u$b),this.addCell(u$b)},u$t.createItem=function(){var u$W=[];if("function"==typeof this._itemRender)var u$j=new this._itemRender;else u$j=u$w.createComp(this._itemRender,null,null,u$W);if(0==u$W.length&&u$j._watchMap){var u$t=u$j._watchMap;for(var u$d in u$t)for(var u$b=u$t[u$d],u$E=0;u$E<u$b.length;u$E++){var u$O=u$b[u$E];u$W.push(u$O.comp,u$O.prop,u$O.value)}}return u$W.length&&(u$j._$bindData=u$W),u$j},u$t.addCell=function(u$W){u$W.on("click",this,this.onCellMouse),u$W.on("rightclick",this,this.onCellMouse),u$W.on("mouseover",this,this.onCellMouse),u$W.on("mouseout",this,this.onCellMouse),u$W.on("mousedown",this,this.onCellMouse),u$W.on("mouseup",this,this.onCellMouse),this._cells.push(u$W)},u$t.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var u$W=0,u$j=u$W=0;u$j<1e4;u$j++){var u$t=this.getChildByName("item"+u$j);if(!u$t)break;this.addCell(u$t),u$W++}this.repeatY=u$W}},u$t.setContentSize=function(u$W,u$j){this._content.width=u$W,this._content.height=u$j,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new u$o),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,u$W,u$j),this._content.scrollRect=this._content.scrollRect),this.event("resize")},u$t.onCellMouse=function(u$W){"mousedown"===u$W.type&&(this._isMoved=!1);var u$j=u$W.currentTarget,u$t=this._startIndex+this._cells.indexOf(u$j);u$t<0||("click"===u$W.type||"rightclick"===u$W.type?this.selectEnable&&!this._isMoved?this.selectedIndex=u$t:this.changeCellState(u$j,!0,0):"mouseover"!==u$W.type&&"mouseout"!==u$W.type||this._selectedIndex===u$t||this.changeCellState(u$j,"mouseover"===u$W.type,0),this.mouseHandler&&this.mouseHandler.runWith([u$W,u$t]))},u$t.changeCellState=function(u$W,u$j,u$t){var u$d=u$W.getChildByName("selectBox");u$d&&(this.selectEnable=!0,u$d.visible=u$j,u$d.index=u$t)},u$t.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},u$t.onScrollBarChange=function(u$W){this.runCallLater(this.changeCells);var u$j=this._scrollBar.value,u$t=this._isVertical?this.repeatX:this.repeatY,u$d=this._isVertical?this.repeatY:this.repeatX,u$b=Math.floor(u$j/this._cellSize);if(this.cacheContent)u$O=u$d+1,this._createdLine-u$b<u$O&&(this._createItems(this._createdLine,u$t,this._createdLine+u$O),this.renderItems(this._createdLine*u$t,0),this._createdLine+=u$O);else{var u$E=u$b*u$t,u$O=0;if(u$E>this._startIndex){u$O=u$E-this._startIndex;var u$q=!0,u$A=this._startIndex+u$t*(u$d+1);this._isMoved=!0}else u$E<this._startIndex&&(u$O=this._startIndex-u$E,u$q=!1,u$A=this._startIndex-1,this._isMoved=!0);for(var u$c=0;u$c<u$O;u$c++){if(u$q){var u$R=this._cells.shift();this._cells[this._cells.length]=u$R;var u$m=u$A+u$c}else u$R=this._cells.pop(),this._cells.unshift(u$R),u$m=u$A-u$c;var u$Q=Math.floor(u$m/u$t)*this._cellSize;this._isVertical?u$R.y=u$Q:u$R.x=u$Q,this.renderItem(u$R,u$m)}this._startIndex=u$E,this.changeSelectStatus()}var u$T=this._content.scrollRect;this._isVertical?(u$T.y=u$j-this._offset.y,u$T.x=-this._offset.x):(u$T.y=-this._offset.y,u$T.x=u$j-this._offset.x),this._content.scrollRect=u$T},u$t.posCell=function(u$W,u$j){if(this._scrollBar){var u$t=this._isVertical?this.repeatX:this.repeatY,u$d=(this._isVertical?this.repeatY:this.repeatX,Math.floor(u$j/u$t)*this._cellSize);this._isVertical?u$W.y=u$d:u$W.x=u$d}},u$t.changeSelectStatus=function(){for(var u$W=0,u$j=this._cells.length;u$W<u$j;u$W++)this.changeCellState(this._cells[u$W],this._selectedIndex===this._startIndex+u$W,1)},u$t.renderItems=function(u$W,u$j){void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0);for(var u$t=u$W,u$d=u$j||this._cells.length;u$t<u$d;u$t++)this.renderItem(this._cells[u$t],this._startIndex+u$t);this.changeSelectStatus()},u$t.renderItem=function(u$W,u$j){this._array&&0<=u$j&&u$j<this._array.length?(u$W.visible=!0,u$W._$bindData?(u$W._dataSource=this._array[u$j],this._bindData(u$W,this._array[u$j])):u$W.dataSource=this._array[u$j],this.cacheContent||this.posCell(u$W,u$j),this.hasListener("render")&&this.event("render",[u$W,u$j]),this.renderHandler&&this.renderHandler.runWith([u$W,u$j])):(u$W.visible=!1,u$W.dataSource=null)},u$t._bindData=function(u$W,u$j){for(var u$t=u$W._$bindData,u$d=0,u$b=u$t.length;u$d<u$b;u$d++){var u$E=u$t[u$d++],u$O=u$t[u$d++],u$q=u$t[u$d],u$A=u$x.getBindFun(u$q);u$E[u$O]=u$A.call(this,u$j)}},u$t.refresh=function(){this.array=this._array},u$t.getItem=function(u$W){return-1<u$W&&u$W<this._array.length?this._array[u$W]:null},u$t.changeItem=function(u$W,u$j){-1<u$W&&u$W<this._array.length&&(this._array[u$W]=u$j,u$W>=this._startIndex&&u$W<this._startIndex+this._cells.length&&this.renderItem(this.getCell(u$W),u$W))},u$t.setItem=function(u$W,u$j){this.changeItem(u$W,u$j)},u$t.addItem=function(u$W){this._array.push(u$W),this.array=this._array},u$t.addItemAt=function(u$W,u$j){this._array.splice(u$j,0,u$W),this.array=this._array},u$t.deleteItem=function(u$W){this._array.splice(u$W,1),this.array=this._array},u$t.getCell=function(u$W){return this.runCallLater(this.changeCells),-1<u$W&&this._cells?this._cells[(u$W-this._startIndex)%this._cells.length]:null},u$t.scrollTo=function(u$W){if(this._scrollBar){var u$j=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(u$W/u$j)*this._cellSize}else this.startIndex=u$W},u$t.tweenTo=function(u$W,u$j,u$t){if(void 0===u$j&&(u$j=200),this._scrollBar){var u$d=this._isVertical?this.repeatX:this.repeatY;u$N.to(this._scrollBar,{value:Math.floor(u$W/u$d)*this._cellSize},u$j,null,u$t,0,!0)}else this.startIndex=u$W,u$t&&u$t.run()},u$t._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},u$t.commitMeasure=function(){this.runCallLater(this.changeCells)},u$b(0,u$t,"cacheAs",u$W.prototype._$get_cacheAs,function(u$W){u$e.superSet(u$y,this,"cacheAs",u$W),this._scrollBar&&(this._$P.cacheAs=null,"none"!==u$W?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),u$b(0,u$t,"content",function(){return this._content}),u$b(0,u$t,"height",u$W.prototype._$get_height,function(u$W){u$W!=this._height&&(u$e.superSet(u$y,this,"height",u$W),this._setCellChanged())}),u$b(0,u$t,"itemRender",function(){return this._itemRender},function(u$W){if(this._itemRender!=u$W){this._itemRender=u$W;for(var u$j=this._cells.length-1;-1<u$j;u$j--)this._cells[u$j].destroy();this._cells.length=0,this._setCellChanged()}}),u$b(0,u$t,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(u$W){this._removePreScrollBar();var u$j=new u$jW;u$j.name="scrollBar",u$j.right=0,u$W&&" "!=u$W&&(u$j.skin=u$W),this.scrollBar=u$j,this.addChild(u$j),this._setCellChanged()}),u$b(0,u$t,"page",function(){return this._page},function(u$W){this._page=u$W,this._array&&(this._page=0<u$W?u$W:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),u$b(0,u$t,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(u$W){this._removePreScrollBar();var u$j=new u$i;u$j.name="scrollBar",u$j.bottom=0,u$W&&" "!=u$W&&(u$j.skin=u$W),this.scrollBar=u$j,this.addChild(u$j),this._setCellChanged()}),u$b(0,u$t,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(u$W){this._repeatX=u$W,this._setCellChanged()}),u$b(0,u$t,"scrollBar",function(){return this._scrollBar},function(u$W){this._scrollBar!=u$W&&(this._scrollBar=u$W)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),u$b(0,u$t,"width",u$W.prototype._$get_width,function(u$W){u$W!=this._width&&(u$e.superSet(u$y,this,"width",u$W),this._setCellChanged())}),u$b(0,u$t,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(u$W){this._repeatY=u$W,this._setCellChanged()}),u$b(0,u$t,"spaceX",function(){return this._spaceX},function(u$W){this._spaceX=u$W,this._setCellChanged()}),u$b(0,u$t,"spaceY",function(){return this._spaceY},function(u$W){this._spaceY=u$W,this._setCellChanged()}),u$b(0,u$t,"selectedIndex",function(){return this._selectedIndex},function(u$W){this._selectedIndex!=u$W&&(this._selectedIndex=u$W,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(u$W),this.startIndex=this._startIndex)}),u$b(0,u$t,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(u$W){this.selectedIndex=this._array.indexOf(u$W)}),u$b(0,u$t,"length",function(){return this._array?this._array.length:0}),u$b(0,u$t,"selection",function(){return this.getCell(this._selectedIndex)},function(u$W){this.selectedIndex=this._startIndex+this._cells.indexOf(u$W)}),u$b(0,u$t,"startIndex",function(){return this._startIndex},function(u$W){this._startIndex=0<u$W?u$W:0,this.callLater(this.renderItems)}),u$b(0,u$t,"array",function(){return this._array},function(u$W){this.runCallLater(this.changeCells),this._array=u$W||[];var u$j=this._array.length;if(this.totalPage=Math.ceil(u$j/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<u$j?this._selectedIndex:u$j-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var u$t=this._isVertical?this.repeatX:this.repeatY,u$d=this._isVertical?this.repeatY:this.repeatX,u$b=Math.ceil(u$j/u$t);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=u$d/u$b,this._scrollBar.setScroll(0,(u$b-u$d)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),u$b(0,u$t,"dataSource",u$W.prototype._$get_dataSource,function(u$W){"number"==typeof(this._dataSource=u$W)&&Math.floor(u$W)==u$W||"string"==typeof u$W?this.selectedIndex=parseInt(u$W):u$W instanceof Array?this.array=u$W:u$e.superSet(u$y,this,"dataSource",u$W)}),u$b(0,u$t,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),u$j}(u$y),u$i=function(u$W){function u$j(){u$j.__super.call(this)}return u$E(u$j,"laya.ui.HScrollBar",u$W),u$j.prototype.initialize=function(){u$W.prototype.initialize.call(this),this.slider.isVertical=!1},u$j}(u$Y),u$B=function(u$W){function u$j(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,u$j.__super.call(this),this.width=this.height=100}u$E(u$j,"laya.ui.Panel",u$W);var u$t=u$j.prototype;return u$t.destroy=function(u$W){void 0===u$W&&(u$W=!0),laya.ui.Component.prototype.destroy.call(this,u$W),this._content&&this._content.destroy(u$W),this._vScrollBar&&this._vScrollBar.destroy(u$W),this._hScrollBar&&this._hScrollBar.destroy(u$W),this._vScrollBar=null,this._hScrollBar=null,this._content=null},u$t.destroyChildren=function(){this._content.destroyChildren()},u$t.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new u$y)},u$t.addChild=function(u$W){return u$W.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(u$W)},u$t.onResize=function(){this._setScrollChanged()},u$t.addChildAt=function(u$W,u$j){return u$W.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(u$W,u$j)},u$t.removeChild=function(u$W){return u$W.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(u$W)},u$t.removeChildAt=function(u$W){return this.getChildAt(u$W).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(u$W)},u$t.removeChildren=function(u$W,u$j){return void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=2147483647),this._content.removeChildren(u$W,u$j),this._setScrollChanged(),this},u$t.getChildAt=function(u$W){return this._content.getChildAt(u$W)},u$t.getChildByName=function(u$W){return this._content.getChildByName(u$W)},u$t.getChildIndex=function(u$W){return this._content.getChildIndex(u$W)},u$t.changeScroll=function(){this._scrollChanged=!1;var u$W=this.contentWidth||1,u$j=this.contentHeight||1,u$t=this._vScrollBar,u$d=this._hScrollBar,u$b=u$t&&u$j>this._height,u$E=u$d&&u$W>this._width,u$O=u$b?this._width-u$t.width:this._width,u$q=u$E?this._height-u$d.height:this._height;u$t&&(u$t.x=this._width-u$t.width,u$t.y=0,u$t.height=this._height-(u$E?u$d.height:0),u$t.scrollSize=Math.max(.033*this._height,1),u$t.thumbPercent=u$q/u$j,u$t.setScroll(0,u$j-u$q,u$t.value)),u$d&&(u$d.x=0,u$d.y=this._height-u$d.height,u$d.width=this._width-(u$b?u$t.width:0),u$d.scrollSize=Math.max(.033*this._width,1),u$d.thumbPercent=u$O/u$W,u$d.setScroll(0,u$W-u$O,u$d.value))},u$t.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},u$t.setContentSize=function(u$W,u$j){var u$t=this._content;u$t.width=u$W,u$t.height=u$j,u$t.scrollRect||(u$t.scrollRect=new u$o),u$t.scrollRect.setTo(0,0,u$W,u$j),u$t.scrollRect=u$t.scrollRect},u$t.onScrollBarChange=function(u$W){var u$j=this._content.scrollRect;if(u$j){var u$t=Math.round(u$W.value);u$W.isVertical?u$j.y=u$t:u$j.x=u$t,this._content.scrollRect=u$j}},u$t.scrollTo=function(u$W,u$j){void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),this.vScrollBar&&(this.vScrollBar.value=u$j),this.hScrollBar&&(this.hScrollBar.value=u$W)},u$t.refresh=function(){this.changeScroll()},u$t.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=u$e.superGet(u$y,this,"cacheAs")),u$e.superSet(u$y,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},u$t.onScrollEnd=function(){u$e.superSet(u$y,this,"cacheAs",this._$P.cacheAs)},u$t._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},u$b(0,u$t,"numChildren",function(){return this._content.numChildren}),u$b(0,u$t,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(u$W){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new u$i),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=u$W}),u$b(0,u$t,"contentWidth",function(){for(var u$W=0,u$j=this._content.numChildren-1;-1<u$j;u$j--){var u$t=this._content.getChildAt(u$j);u$W=Math.max(u$t.x+u$t.width*u$t.scaleX,u$W)}return u$W}),u$b(0,u$t,"contentHeight",function(){for(var u$W=0,u$j=this._content.numChildren-1;-1<u$j;u$j--){var u$t=this._content.getChildAt(u$j);u$W=Math.max(u$t.y+u$t.height*u$t.scaleY,u$W)}return u$W}),u$b(0,u$t,"width",u$W.prototype._$get_width,function(u$W){u$e.superSet(u$y,this,"width",u$W),this._setScrollChanged()}),u$b(0,u$t,"hScrollBar",function(){return this._hScrollBar}),u$b(0,u$t,"content",function(){return this._content}),u$b(0,u$t,"height",u$W.prototype._$get_height,function(u$W){u$e.superSet(u$y,this,"height",u$W),this._setScrollChanged()}),u$b(0,u$t,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(u$W){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new u$jW),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=u$W}),u$b(0,u$t,"vScrollBar",function(){return this._vScrollBar}),u$b(0,u$t,"cacheAs",u$W.prototype._$get_cacheAs,function(u$W){u$e.superSet(u$y,this,"cacheAs",u$W),this._$P.cacheAs=null,"none"!==u$W?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),u$j}(u$y),u$n=function(u$W){function u$j(u$W){u$j.__super.call(this,u$W),this.isVertical=!1}return u$E(u$j,"laya.ui.HSlider",u$H),u$j}(),u$k=function(u$W){function u$t(u$W,u$j){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,u$t.__super.call(this),this.skin=u$j,this.labels=u$W}u$E(u$t,"laya.ui.UIGroup",u$W);var u$j=u$t.prototype;return u$e.imps(u$j,{"laya.ui.IItem":!0}),u$j.preinitialize=function(){this.mouseEnabled=!0},u$j.destroy=function(u$W){void 0===u$W&&(u$W=!0),laya.ui.Component.prototype.destroy.call(this,u$W),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},u$j.addItem=function(u$W,u$j){void 0===u$j&&(u$j=!0);var u$t=u$W,u$d=this._items.length;if(u$t.name="item"+u$d,this.addChild(u$t),this.initItems(),u$j&&0<u$d){var u$b=this._items[u$d-1];"horizontal"==this._direction?u$t.x=u$b.x+u$b.width+this._space:u$t.y=u$b.y+u$b.height+this._space}else u$j&&(u$t.x=0,u$t.y=0);return u$d},u$j.delItem=function(u$W,u$j){void 0===u$j&&(u$j=!0);var u$t=this._items.indexOf(u$W);if(-1!=u$t){var u$d=u$W;this.removeChild(u$d);for(var u$b=u$t+1,u$E=this._items.length;u$b<u$E;u$b++){var u$O=this._items[u$b];u$O.name="item"+(u$b-1),u$j&&("horizontal"==this._direction?u$O.x-=u$d.width+this._space:u$O.y-=u$d.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var u$q;u$q=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=u$q}}},u$j.initItems=function(){this._items||(this._items=[]);for(var u$W=this._items.length=0;u$W<1e4;u$W++){var u$j=this.getChildByName("item"+u$W);if(null==u$j)break;this._items.push(u$j),u$j.selected=u$W===this._selectedIndex,u$j.clickHandler=u$Q.create(this,this.itemClick,[u$W],!1)}},u$j.itemClick=function(u$W){this.selectedIndex=u$W},u$j.setSelect=function(u$W,u$j){this._items&&-1<u$W&&u$W<this._items.length&&(this._items[u$W].selected=u$j)},u$j.createItem=function(u$W,u$j){return null},u$j.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var u$W=0,u$j=0,u$t=this._items.length;u$j<u$t;u$j++){var u$d=this._items[u$j];this._skin&&(u$d.skin=this._skin),this._labelColors&&(u$d.labelColors=this._labelColors),this._labelSize&&(u$d.labelSize=this._labelSize),this._labelStroke&&(u$d.labelStroke=this._labelStroke),this._labelStrokeColor&&(u$d.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(u$d.strokeColors=this._strokeColors),this._labelBold&&(u$d.labelBold=this._labelBold),this._labelPadding&&(u$d.labelPadding=this._labelPadding),this._labelAlign&&(u$d.labelAlign=this._labelAlign),this._stateNum&&(u$d.stateNum=this._stateNum),this._labelFont&&(u$d.labelFont=this._labelFont),"horizontal"===this._direction?(u$d.y=0,u$d.x=u$W,u$W+=u$d.width+this._space):(u$d.x=0,u$d.y=u$W,u$W+=u$d.height+this._space)}this.changeSize()},u$j.commitMeasure=function(){this.runCallLater(this.changeLabels)},u$j._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},u$b(0,u$j,"labelStrokeColor",function(){return this._labelStrokeColor},function(u$W){this._labelStrokeColor!=u$W&&(this._labelStrokeColor=u$W,this._setLabelChanged())}),u$b(0,u$j,"skin",function(){return this._skin},function(u$W){this._skin!=u$W&&(this._skin=u$W,this._setLabelChanged())}),u$b(0,u$j,"selectedIndex",function(){return this._selectedIndex},function(u$W){this._selectedIndex!=u$W&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=u$W,this.setSelect(u$W,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),u$b(0,u$j,"labels",function(){return this._labels},function(u$W){if(this._labels!=u$W){if(this._labels=u$W,this.removeChildren(),this._setLabelChanged(),this._labels)for(var u$j=this._labels.split(","),u$t=0,u$d=u$j.length;u$t<u$d;u$t++){var u$b=this.createItem(this._skin,u$j[u$t]);u$b.name="item"+u$t,this.addChild(u$b)}this.initItems()}}),u$b(0,u$j,"strokeColors",function(){return this._strokeColors},function(u$W){this._strokeColors!=u$W&&(this._strokeColors=u$W,this._setLabelChanged())}),u$b(0,u$j,"labelColors",function(){return this._labelColors},function(u$W){this._labelColors!=u$W&&(this._labelColors=u$W,this._setLabelChanged())}),u$b(0,u$j,"labelStroke",function(){return this._labelStroke},function(u$W){this._labelStroke!=u$W&&(this._labelStroke=u$W,this._setLabelChanged())}),u$b(0,u$j,"labelSize",function(){return this._labelSize},function(u$W){this._labelSize!=u$W&&(this._labelSize=u$W,this._setLabelChanged())}),u$b(0,u$j,"stateNum",function(){return this._stateNum},function(u$W){this._stateNum!=u$W&&(this._stateNum=u$W,this._setLabelChanged())}),u$b(0,u$j,"labelBold",function(){return this._labelBold},function(u$W){this._labelBold!=u$W&&(this._labelBold=u$W,this._setLabelChanged())}),u$b(0,u$j,"labelFont",function(){return this._labelFont},function(u$W){this._labelFont!=u$W&&(this._labelFont=u$W,this._setLabelChanged())}),u$b(0,u$j,"labelPadding",function(){return this._labelPadding},function(u$W){this._labelPadding!=u$W&&(this._labelPadding=u$W,this._setLabelChanged())}),u$b(0,u$j,"direction",function(){return this._direction},function(u$W){this._direction=u$W,this._setLabelChanged()}),u$b(0,u$j,"space",function(){return this._space},function(u$W){this._space=u$W,this._setLabelChanged()}),u$b(0,u$j,"items",function(){return this._items}),u$b(0,u$j,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(u$W){this.selectedIndex=this._items.indexOf(u$W)}),u$b(0,u$j,"dataSource",u$W.prototype._$get_dataSource,function(u$W){"number"==typeof(this._dataSource=u$W)&&Math.floor(u$W)==u$W||"string"==typeof u$W?this.selectedIndex=parseInt(u$W):u$W instanceof Array?this.labels=u$W.join(","):u$e.superSet(u$y,this,"dataSource",u$W)}),u$t}(u$y),u$p=function(u$j){function u$t(u$W,u$j){this._value=null,void 0===u$j&&(u$j=""),u$t.__super.call(this,u$W,u$j)}u$E(u$t,"laya.ui.Radio",u$j);var u$W=u$t.prototype;return u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,u$W),this._value=null},u$W.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},u$W.initialize=function(){u$j.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},u$W.onClick=function(u$W){this.selected=!0},u$b(0,u$W,"value",function(){return null!=this._value?this._value:this.label},function(u$W){this._value=u$W}),u$t}(u$a),u$F=function(u$W){function u$j(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,u$j.__super.call(this),this.width=this.height=200}u$E(u$j,"laya.ui.Tree",u$W);var u$t=u$j.prototype;return u$e.imps(u$t,{"laya.ui.IRender":!0}),u$t.destroy=function(u$W){void 0===u$W&&(u$W=!0),laya.ui.Component.prototype.destroy.call(this,u$W),this._list&&this._list.destroy(u$W),this._list=null,this._source=null,this._renderHandler=null},u$t.createChildren=function(){this.addChild(this._list=new u$P),this._list.renderHandler=u$Q.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},u$t.onListChange=function(u$W){this.event("change")},u$t.getArray=function(){var u$W,u$j=[];for(var u$t in this._source)u$W=this._source[u$t],this.getParentOpenStatus(u$W)&&(u$W.x=this._spaceLeft*this.getDepth(u$W),u$j.push(u$W));return u$j},u$t.getDepth=function(u$W,u$j){return void 0===u$j&&(u$j=0),null==u$W.nodeParent?u$j:this.getDepth(u$W.nodeParent,u$j+1)},u$t.getParentOpenStatus=function(u$W){var u$j=u$W.nodeParent;return null==u$j||!!u$j.isOpen&&(null==u$j.nodeParent||this.getParentOpenStatus(u$j))},u$t.renderItem=function(u$W,u$j){var u$t=u$W.dataSource;if(u$t){u$W.left=u$t.x;var u$d=u$W.getChildByName("arrow");u$d&&(u$t.hasChild?(u$d.visible=!0,u$d.index=u$t.isOpen?1:0,u$d.tag=u$j,u$d.off("click",this,this.onArrowClick),u$d.on("click",this,this.onArrowClick)):u$d.visible=!1);var u$b=u$W.getChildByName("folder");u$b&&(2==u$b.clipY?u$b.index=u$t.isDirectory?0:1:u$b.index=u$t.isDirectory?u$t.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([u$W,u$j])}},u$t.onArrowClick=function(u$W){var u$j=u$W.currentTarget.tag;this._list.array[u$j].isOpen=!this._list.array[u$j].isOpen,this.event("open"),this._list.array=this.getArray()},u$t.setItemState=function(u$W,u$j){this._list.array[u$W]&&(this._list.array[u$W].isOpen=u$j,this._list.array=this.getArray())},u$t.fresh=function(){this._list.array=this.getArray(),this.repaint()},u$t.parseXml=function(u$W,u$j,u$t,u$d){var u$b,u$E=u$W.childNodes,u$O=u$E.length;if(!u$d){u$b={};var u$q,u$A=u$W.attributes;for(var u$c in u$A){var u$R=(u$q=u$A[u$c]).nodeName,u$m=u$q.nodeValue;u$b[u$R]="true"==u$m||"false"!=u$m&&u$m}u$b.nodeParent=u$t,0<u$O&&(u$b.isDirectory=!0),u$b.hasChild=0<u$O,u$j.push(u$b)}for(var u$Q=0;u$Q<u$O;u$Q++){var u$T=u$E[u$Q];this.parseXml(u$T,u$j,u$b,!1)}},u$t.parseOpenStatus=function(u$W,u$j){for(var u$t=0,u$d=u$j.length;u$t<u$d;u$t++){var u$b=u$j[u$t];if(u$b.isDirectory)for(var u$E=0,u$O=u$W.length;u$E<u$O;u$E++){var u$q=u$W[u$E];if(u$q.isDirectory&&this.isSameParent(u$q,u$b)&&u$b.label==u$q.label){u$b.isOpen=u$q.isOpen;break}}}},u$t.isSameParent=function(u$W,u$j){return null==u$W.nodeParent&&null==u$j.nodeParent||null!=u$W.nodeParent&&null!=u$j.nodeParent&&(u$W.nodeParent.label==u$j.nodeParent.label&&this.isSameParent(u$W.nodeParent,u$j.nodeParent))},u$t.filter=function(u$W){if(Boolean(u$W)){var u$j=[];this.getFilterSource(this._source,u$j,u$W),this._list.array=u$j}else this._list.array=this.getArray()},u$t.getFilterSource=function(u$W,u$j,u$t){var u$d;for(var u$b in u$t=u$t.toLocaleLowerCase(),u$W)!(u$d=u$W[u$b]).isDirectory&&-1<String(u$d.label).toLowerCase().indexOf(u$t)&&(u$d.x=0,u$j.push(u$d)),u$d.child&&0<u$d.child.length&&this.getFilterSource(u$d.child,u$j,u$t)},u$b(0,u$t,"spaceBottom",function(){return this._list.spaceY},function(u$W){this._list.spaceY=u$W}),u$b(0,u$t,"keepStatus",function(){return this._keepStatus},function(u$W){this._keepStatus=u$W}),u$b(0,u$t,"itemRender",function(){return this._list.itemRender},function(u$W){this._list.itemRender=u$W}),u$b(0,u$t,"array",function(){return this._list.array},function(u$W){this._keepStatus&&this._list.array&&u$W&&this.parseOpenStatus(this._list.array,u$W),this._source=u$W,this._list.array=this.getArray()}),u$b(0,u$t,"mouseHandler",function(){return this._list.mouseHandler},function(u$W){this._list.mouseHandler=u$W}),u$b(0,u$t,"dataSource",u$W.prototype._$get_dataSource,function(u$W){this._dataSource=u$W,u$e.superSet(u$y,this,"dataSource",u$W)}),u$b(0,u$t,"source",function(){return this._source}),u$b(0,u$t,"scrollBar",function(){return this._list.scrollBar}),u$b(0,u$t,"list",function(){return this._list}),u$b(0,u$t,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(u$W){this._list.vScrollBarSkin=u$W}),u$b(0,u$t,"renderHandler",function(){return this._renderHandler},function(u$W){this._renderHandler=u$W}),u$b(0,u$t,"selectedIndex",function(){return this._list.selectedIndex},function(u$W){this._list.selectedIndex=u$W}),u$b(0,u$t,"spaceLeft",function(){return this._spaceLeft},function(u$W){this._spaceLeft=u$W}),u$b(0,u$t,"selectedItem",function(){return this._list.selectedItem},function(u$W){this._list.selectedItem=u$W}),u$b(0,u$t,"width",u$W.prototype._$get_width,function(u$W){u$e.superSet(u$y,this,"width",u$W),this._list.width=u$W}),u$b(0,u$t,"height",u$W.prototype._$get_height,function(u$W){u$e.superSet(u$y,this,"height",u$W),this._list.height=u$W}),u$b(0,u$t,"xml",null,function(u$W){var u$j=[];this.parseXml(u$W.childNodes[0],u$j,null,!0),this.array=u$j}),u$b(0,u$t,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),u$j}(u$y),u$WW=function(u$W){function u$j(){this._items=null,this._selectedIndex=0,u$j.__super.call(this),this._setIndexHandler=u$Q.create(this,this.setIndex,null,!1)}u$E(u$j,"laya.ui.ViewStack",u$W);var u$t=u$j.prototype;return u$e.imps(u$t,{"laya.ui.IItem":!0}),u$t.setItems=function(u$W){this.removeChildren();for(var u$j=0,u$t=0,u$d=u$W.length;u$t<u$d;u$t++){var u$b=u$W[u$t];u$b&&(u$b.name="item"+u$j,this.addChild(u$b),u$j++)}this.initItems()},u$t.addItem=function(u$W){u$W.name="item"+this._items.length,this.addChild(u$W),this.initItems()},u$t.initItems=function(){this._items=[];for(var u$W=0;u$W<1e4;u$W++){var u$j=this.getChildByName("item"+u$W);if(null==u$j)break;this._items.push(u$j),u$j.visible=u$W==this._selectedIndex}},u$t.setSelect=function(u$W,u$j){this._items&&-1<u$W&&u$W<this._items.length&&(this._items[u$W].visible=u$j)},u$t.setIndex=function(u$W){this.selectedIndex=u$W},u$b(0,u$t,"dataSource",u$W.prototype._$get_dataSource,function(u$W){if("number"==typeof(this._dataSource=u$W)&&Math.floor(u$W)==u$W||"string"==typeof u$W)this.selectedIndex=parseInt(u$W);else for(var u$j in this._dataSource)this.hasOwnProperty(u$j)&&(this[u$j]=this._dataSource[u$j])}),u$b(0,u$t,"selectedIndex",function(){return this._selectedIndex},function(u$W){this._selectedIndex!=u$W&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=u$W,this.setSelect(this._selectedIndex,!0))}),u$b(0,u$t,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(u$W){this.selectedIndex=this._items.indexOf(u$W)}),u$b(0,u$t,"items",function(){return this._items}),u$b(0,u$t,"setIndexHandler",function(){return this._setIndexHandler},function(u$W){this._setIndexHandler=u$W}),u$j}(u$y),u$jW=function(u$W){function u$j(){u$j.__super.call(this)}return u$E(u$j,"laya.ui.VScrollBar",u$Y),u$j}(),u$tW=function(u$j){function u$t(u$W){this._bg=null,this._skin=null,u$t.__super.call(this),void 0===u$W&&(u$W=""),this.text=u$W,this.skin=this.skin}u$E(u$t,"laya.ui.TextInput",u$j);var u$W=u$t.prototype;return u$W.preinitialize=function(){this.mouseEnabled=!0},u$W.destroy=function(u$W){u$S.clearCache(this,this._skin),void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,u$W),this._bg&&this._bg.destroy(),this._bg=null},u$W.createChildren=function(){this.addChild(this._tf=new u$T),this._tf.padding=u$V.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},u$W._onFocus=function(){this.event("focus",this)},u$W._onBlur=function(){this.event("blur",this)},u$W._onInput=function(){this.event("input",this)},u$W._onEnter=function(){this.event("enter",this)},u$W.initialize=function(){this.width=128,this.height=22},u$W.select=function(){this._tf.select()},u$W.setSelection=function(u$W,u$j){this._tf.setSelection(u$W,u$j)},u$b(0,u$W,"text",u$j.prototype._$get_text,function(u$W){this._tf.text!=u$W&&(u$W+="",this._tf.text=u$W,this.event("change"))}),u$b(0,u$W,"bg",function(){return this._bg},function(u$W){this.graphics=this._bg=u$W}),u$b(0,u$W,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(u$W){this._tf.inputElementYAdjuster=u$W}),u$b(0,u$W,"multiline",function(){return this._tf.multiline},function(u$W){this._tf.multiline=u$W}),u$b(0,u$W,"skin",function(){return this._skin},function(u$W){this._skin!=u$W&&(u$S.clearCache(this,this._skin),this._skin=u$W,this._bg||(this.graphics=this._bg=new u$l),u$S.keepCache(this,this._skin),this._bg.source=u$S.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),u$b(0,u$W,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(u$W){this._bg||(this.graphics=this._bg=new u$l),this._bg.sizeGrid=u$x.fillArray(u$V.defaultSizeGrid,u$W,Number)}),u$b(0,u$W,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(u$W){this._tf.inputElementXAdjuster=u$W}),u$b(0,u$W,"width",u$j.prototype._$get_width,function(u$W){u$e.superSet(u$g,this,"width",u$W),this._bg&&(this._bg.width=u$W)}),u$b(0,u$W,"height",u$j.prototype._$get_height,function(u$W){u$e.superSet(u$g,this,"height",u$W),this._bg&&(this._bg.height=u$W)}),u$b(0,u$W,"editable",function(){return this._tf.editable},function(u$W){this._tf.editable=u$W}),u$b(0,u$W,"restrict",function(){return this._tf.restrict},function(u$W){this._tf.restrict=u$W}),u$b(0,u$W,"prompt",function(){return this._tf.prompt},function(u$W){this._tf.prompt=u$W}),u$b(0,u$W,"promptColor",function(){return this._tf.promptColor},function(u$W){this._tf.promptColor=u$W}),u$b(0,u$W,"maxChars",function(){return this._tf.maxChars},function(u$W){this._tf.maxChars=u$W}),u$b(0,u$W,"focus",function(){return this._tf.focus},function(u$W){this._tf.focus=u$W}),u$b(0,u$W,"type",function(){return this._tf.type},function(u$W){this._tf.type=u$W}),u$b(0,u$W,"asPassword",function(){return this._tf.asPassword},function(u$W){this._tf.asPassword=u$W}),u$t}(u$g),u$dW=function(u$W){function u$j(){u$j.__super.call(this)}return u$E(u$j,"laya.ui.VSlider",u$H),u$j}(),u$bW=function(u$W){function u$d(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,u$d.__super.call(this)}u$E(u$d,"laya.ui.Dialog",u$W);var u$j=u$d.prototype;return u$j.initialize=function(){this.popupEffect=u$d.manager.popupEffectHandler,this.closeEffect=u$d.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},u$j._dealDragArea=function(){var u$W=this.getChildByName("drag");u$W&&(this.dragArea=u$W.x+","+u$W.y+","+u$W.width+","+u$W.height,u$W.removeSelf())},u$j._onClick=function(u$W){var u$j=u$W.target;if(u$j)switch(u$j.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(u$j.name)}},u$j.show=function(u$W,u$j){void 0===u$W&&(u$W=!1),void 0===u$j&&(u$j=!0),this._open(!1,u$W,u$j)},u$j.popup=function(u$W,u$j){void 0===u$W&&(u$W=!1),void 0===u$j&&(u$j=!0),this._open(!0,u$W,u$j)},u$j._open=function(u$W,u$j,u$t){u$d.manager.lock(!1),this.isModal=u$W,u$d.manager.open(this,u$j,u$t)},u$j.onOpened=function(){},u$j.close=function(u$W,u$j){void 0===u$j&&(u$j=!0),u$d.manager.close(this,u$W,u$j)},u$j.onClosed=function(u$W){},u$j._onMouseDown=function(u$W){var u$j=this.getMousePoint();this._dragArea.contains(u$j.x,u$j.y)?this.startDrag():this.stopDrag()},u$b(0,u$j,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(u$W){if(u$W){var u$j=u$x.fillArray([0,0,0,0],u$W,Number);this._dragArea=new u$o(u$j[0],u$j[1],u$j[2],u$j[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),u$b(0,u$j,"isPopup",function(){return null!=this.parent}),u$b(0,u$j,"zOrder",u$W.prototype._$get_zOrder,function(u$W){u$e.superSet(u$w,this,"zOrder",u$W),u$d.manager._checkMask()}),u$b(1,u$d,"manager",function(){return u$d._manager=u$d._manager||new u$v},function(u$W){u$d._manager=u$W}),u$d.setLockView=function(u$W){u$d.manager.setLockView(u$W)},u$d.lock=function(u$W){u$d.manager.lock(u$W)},u$d.closeAll=function(){u$d.manager.closeAll()},u$d.getDialogsByGroup=function(u$W){return u$d.manager.getDialogsByGroup(u$W)},u$d.closeByGroup=function(u$W){return u$d.manager.closeByGroup(u$W)},u$d.CLOSE="close",u$d.CANCEL="cancel",u$d.SURE="sure",u$d.NO="no",u$d.OK="ok",u$d.YES="yes",u$d._manager=null,u$d}(u$w),u$EW=function(u$W){function u$j(){u$j.__super.call(this)}u$E(u$j,"laya.ui.HBox",u$W);var u$t=u$j.prototype;return u$t.sortItem=function(u$W){u$W&&u$W.sort(function(u$W,u$j){return u$W.x-u$j.x})},u$t.changeItems=function(){this._itemChanged=!1;for(var u$W=[],u$j=0,u$t=0,u$d=this.numChildren;u$t<u$d;u$t++){var u$b=this.getChildAt(u$t);u$b&&u$b.layoutEnabled&&(u$W.push(u$b),u$j=this._height?this._height:Math.max(u$j,u$b.height*u$b.scaleY))}this.sortItem(u$W);var u$E=0;for(u$t=0,u$d=u$W.length;u$t<u$d;u$t++)(u$b=u$W[u$t]).x=u$E,u$E+=u$b.width*u$b.scaleX+this._space,"top"==this._align?u$b.y=0:"middle"==this._align?u$b.y=.5*(u$j-u$b.height*u$b.scaleY):"bottom"==this._align&&(u$b.y=u$j-u$b.height*u$b.scaleY);this.changeSize()},u$b(0,u$t,"height",u$W.prototype._$get_height,function(u$W){this._height!=u$W&&(u$e.superSet(u$J,this,"height",u$W),this.callLater(this.changeItems))}),u$j.NONE="none",u$j.TOP="top",u$j.MIDDLE="middle",u$j.BOTTOM="bottom",u$j}(u$J),u$OW=function(u$W){function u$j(){u$j.__super.call(this)}u$E(u$j,"laya.ui.VBox",u$W);var u$t=u$j.prototype;return u$t.changeItems=function(){this._itemChanged=!1;for(var u$W=[],u$j=0,u$t=0,u$d=this.numChildren;u$t<u$d;u$t++){var u$b=this.getChildAt(u$t);u$b&&u$b.layoutEnabled&&(u$W.push(u$b),u$j=this._width?this._width:Math.max(u$j,u$b.width*u$b.scaleX))}this.sortItem(u$W);var u$E=0;for(u$t=0,u$d=u$W.length;u$t<u$d;u$t++)(u$b=u$W[u$t]).y=u$E,u$E+=u$b.height*u$b.scaleY+this._space,"left"==this._align?u$b.x=0:"center"==this._align?u$b.x=.5*(u$j-u$b.width*u$b.scaleX):"right"==this._align&&(u$b.x=u$j-u$b.width*u$b.scaleX);this.changeSize()},u$b(0,u$t,"width",u$W.prototype._$get_width,function(u$W){this._width!=u$W&&(u$e.superSet(u$J,this,"width",u$W),this.callLater(this.changeItems))}),u$j.NONE="none",u$j.LEFT="left",u$j.CENTER="center",u$j.RIGHT="right",u$j}(u$J),u$qW=function(u$W){function u$j(){u$j.__super.call(this)}return u$E(u$j,"laya.ui.RadioGroup",u$k),u$j.prototype.createItem=function(u$W,u$j){return new u$p(u$W,u$j)},u$j}(),u$AW=function(u$W){function u$j(){u$j.__super.call(this)}return u$E(u$j,"laya.ui.Tab",u$k),u$j.prototype.createItem=function(u$W,u$j){return new u$a(u$W,u$j)},u$j}(),u$cW=function(u$j){function u$t(u$W){this._vScrollBar=null,this._hScrollBar=null,void 0===u$W&&(u$W=""),u$t.__super.call(this,u$W)}u$E(u$t,"laya.ui.TextArea",u$j);var u$W=u$t.prototype;return u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,u$W),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},u$W.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},u$W.onVBarChanged=function(u$W){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},u$W.onHBarChanged=function(u$W){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},u$W.changeScroll=function(){var u$W=this._vScrollBar&&0<this._tf.maxScrollY,u$j=this._hScrollBar&&0<this._tf.maxScrollX,u$t=u$W?this._width-this._vScrollBar.width:this._width,u$d=u$j?this._height-this._hScrollBar.height:this._height,u$b=this._tf.padding||u$V.labelPadding;this._tf.width=u$t,this._tf.height=u$d,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-u$b[2],this._vScrollBar.y=u$b[1],this._vScrollBar.height=this._height-(u$j?this._hScrollBar.height:0)-u$b[1]-u$b[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=u$d/Math.max(this._tf.textHeight,u$d),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=u$W),this._hScrollBar&&(this._hScrollBar.x=u$b[0],this._hScrollBar.y=this._height-this._hScrollBar.height-u$b[3],this._hScrollBar.width=this._width-(u$W?this._vScrollBar.width:0)-u$b[0]-u$b[2],this._hScrollBar.scrollSize=Math.max(.033*u$t,1),this._hScrollBar.thumbPercent=u$t/Math.max(this._tf.textWidth,u$t),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=u$j)},u$W.scrollTo=function(u$W){this.commitMeasure(),this._tf.scrollY=u$W},u$b(0,u$W,"scrollY",function(){return this._tf.scrollY}),u$b(0,u$W,"width",u$j.prototype._$get_width,function(u$W){u$e.superSet(u$tW,this,"width",u$W),this.callLater(this.changeScroll)}),u$b(0,u$W,"hScrollBar",function(){return this._hScrollBar}),u$b(0,u$W,"height",u$j.prototype._$get_height,function(u$W){u$e.superSet(u$tW,this,"height",u$W),this.callLater(this.changeScroll)}),u$b(0,u$W,"maxScrollX",function(){return this._tf.maxScrollX}),u$b(0,u$W,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(u$W){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new u$jW),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=u$W}),u$b(0,u$W,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(u$W){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new u$i),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=u$W}),u$b(0,u$W,"vScrollBar",function(){return this._vScrollBar}),u$b(0,u$W,"maxScrollY",function(){return this._tf.maxScrollY}),u$b(0,u$W,"scrollX",function(){return this._tf.scrollX}),u$t}(u$tW);!function(u$W){function u$j(){this._uiView=null,this.isCloseOther=!1,u$j.__super.call(this)}u$E(u$j,"laya.ui.AsynDialog",u$bW);var u$t=u$j.prototype;u$t.createView=function(u$W){this._uiView=u$W},u$t._open=function(u$W,u$j,u$t){this.isModal=u$W,this.isCloseOther=u$j,u$bW.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},u$t.onCreated=function(){this.createUI(),this.onOpen()},u$t.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},u$t.onOpen=function(){u$bW.manager.open(this,this.isCloseOther),u$bW.manager.lock(!1)},u$t.close=function(u$W,u$j){void 0===u$j&&(u$j=!0),u$bW.manager.close(this),this.onClose()},u$t.onClose=function(){},u$t.destroy=function(u$W){void 0===u$W&&(u$W=!0),laya.ui.View.prototype.destroy.call(this,u$W),this._uiView=null,this.onDestroy()},u$t.onDestroy=function(){}}();u$e.__init([u$w])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(u$W,u$j){"use strict";for(var u$t in Object.defineProperty(u$j,"__esModule",{value:!0}),Laya){var u$d=Laya[u$t];u$d&&u$d.__isclass&&(u$j[u$t]=u$d)}}),function(u$Q,u$W,u$X){u$X.un,u$X.uns;var u$m=u$X.static,u$T=u$X.class,u$$=u$X.getset,u$d=u$X.__newvec,u$Z=laya.maths.Arith,u$O=laya.webgl.atlas.AtlasResourceManager,u$t=laya.webgl.shader.BaseShader,u$h=laya.utils.Browser,u$q=laya.webgl.utils.Buffer,u$_=laya.utils.Byte,u$b=laya.utils.ClassUtils,u$A=u$X.Config,u$E=(laya.events.Event,laya.events.EventDispatcher),u$V=laya.utils.Handler,u$o=laya.net.Loader,u$j=laya.net.LoaderManager,u$c=(laya.maths.MathUtil,laya.display.Node),u$e=laya.renders.Render,u$R=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),u$K=laya.resource.Resource,u$S=laya.utils.RunDriver,u$M=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),u$N=laya.display.Sprite,u$z=laya.utils.Stat,u$C=laya.utils.StringKey,u$x=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),u$L=laya.utils.Utils,u$G=laya.webgl.WebGL,u$l=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;u$X.interface("laya.d3.core.IClone"),u$X.interface("laya.d3.graphics.IVertex"),u$X.interface("laya.d3.core.render.IUpdate"),u$X.interface("laya.d3.core.scene.ITreeNode"),u$X.interface("laya.d3.core.render.IRenderable");(function(){function u$a(){}u$T(u$a,"laya.d3.animation.AnimationClipParser01"),u$a.READ_DATA=function(){u$a._DATA.offset=u$a._reader.getUint32(),u$a._DATA.size=u$a._reader.getUint32()},u$a.READ_BLOCK=function(){for(var u$W=u$a._BLOCK.count=u$a._reader.getUint16(),u$j=u$a._BLOCK.blockStarts=[],u$t=u$a._BLOCK.blockLengths=[],u$d=0;u$d<u$W;u$d++)u$j.push(u$a._reader.getUint32()),u$t.push(u$a._reader.getUint32())},u$a.READ_STRINGS=function(){var u$W=u$a._reader.getUint32(),u$j=u$a._reader.getUint16(),u$t=u$a._reader.pos;u$a._reader.pos=u$W+u$a._DATA.offset;for(var u$d=0;u$d<u$j;u$d++)u$a._strings[u$d]=u$a._reader.readUTFString();u$a._reader.pos=u$t},u$a.parse=function(u$W,u$j){u$a._animationClip=u$W;(u$a._reader=u$j).__getBuffer();u$a.READ_DATA(),u$a.READ_BLOCK(),u$a.READ_STRINGS();for(var u$t=0,u$d=u$a._BLOCK.count;u$t<u$d;u$t++){var u$b=u$j.getUint16(),u$E=u$a._strings[u$b],u$O=u$a["READ_"+u$E];if(null==u$O)throw new Error("model file err,no this function:"+u$b+" "+u$E);u$O.call()}},u$a.READ_ANIMATIONS=function(){var u$W,u$j=0,u$t=0,u$d=u$a._reader,u$b=u$d.__getBuffer(),u$E=[],u$O=u$d.getUint8();for(u$E.length=u$O,u$j=0;u$j<u$O;u$j++)u$E[u$j]=u$d.getUint16();var u$q=[],u$A=u$d.getUint16();for(u$q.length=u$A,u$j=0;u$j<u$A;u$j++)u$q[u$j]=u$d.getFloat32();var u$c=u$a._animationClip;u$c.name=u$a._strings[u$d.getUint16()];var u$R=u$c._duration=u$d.getFloat32();u$c.islooping=!!u$d.getByte(),u$c._frameRate=u$d.getInt16();var u$m=u$d.getInt16(),u$Q=u$c._nodes=new Array;u$Q.length=u$m,(u$c._publicClipDatas=[]).length=u$m;var u$T=u$c._nodesMap={},u$$=0,u$e=0;for(u$j=0;u$j<u$m;u$j++){u$W=u$Q[u$j]=new u$f;var u$K=u$d.getUint16(),u$o=u$W.path=[];for(u$o.length=u$K,u$t=0;u$t<u$K;u$t++)u$o[u$t]=u$a._strings[u$d.getUint16()];var u$S=u$o.join("/"),u$M=u$T[u$S];u$M||(u$T[u$S]=u$M=[]),u$M.push(u$W);var u$Z=u$d.getInt16();-1!==u$Z&&(u$W.componentType=u$a._strings[u$Z]);var u$X=u$I._propertyIndexDic[u$a._strings[u$d.getUint16()]];if(null==u$X)throw new Error("AnimationClipParser01:unknown property name.");var u$_=u$X<4,u$N=!u$_||u$_&&""===u$o[0];(u$W._cacheProperty=u$N)?u$$++:u$e++,u$W.propertyNameID=u$X;var u$z=u$E[u$d.getUint8()];u$W.keyFrameWidth=u$z/4;var u$C=u$W.keyFrames=[],u$L=u$C.length=u$d.getUint16(),u$V=null,u$x=NaN;for(u$t=0;u$t<u$L;u$t++){var u$G=u$C[u$t]=new u$g;u$x=u$G.startTime=u$q[u$d.getUint16()];var u$l=u$d.pos;u$G.inTangent=new Float32Array(u$b.slice(u$l,u$l+u$z)),u$d.pos+=u$z,u$l=u$d.pos,u$G.outTangent=new Float32Array(u$b.slice(u$l,u$l+u$z)),u$d.pos+=u$z,u$l=u$d.pos,u$G.data=new Float32Array(u$b.slice(u$l,u$l+u$z)),u$d.pos+=u$z,u$V&&(u$V.next=u$G,u$V.duration=u$x-u$V.startTime),u$V=u$G}u$G.next=null,u$G.duration=u$R-u$x}var u$h=u$c._nodeToCachePropertyMap=new Int32Array(u$m),u$v=u$c._cachePropertyMap=new Int32Array(u$$),u$y=u$c._unCachePropertyMap=new Int32Array(u$e);for(u$$=u$e=0,u$j=0;u$j<u$m;u$j++)(u$W=u$Q[u$j])._cacheProperty?(u$h[u$j]=u$$,u$v[u$$++]=u$j):u$y[u$e++]=u$j},u$a._animationClip=null,u$a._reader=null,u$a._strings=[],u$m(u$a,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function u$Y(){}u$T(u$Y,"laya.d3.animation.AnimationClipParser02"),u$Y.READ_DATA=function(){u$Y._DATA.offset=u$Y._reader.getUint32(),u$Y._DATA.size=u$Y._reader.getUint32()},u$Y.READ_BLOCK=function(){for(var u$W=u$Y._BLOCK.count=u$Y._reader.getUint16(),u$j=u$Y._BLOCK.blockStarts=[],u$t=u$Y._BLOCK.blockLengths=[],u$d=0;u$d<u$W;u$d++)u$j.push(u$Y._reader.getUint32()),u$t.push(u$Y._reader.getUint32())},u$Y.READ_STRINGS=function(){var u$W=u$Y._reader.getUint32(),u$j=u$Y._reader.getUint16(),u$t=u$Y._reader.pos;u$Y._reader.pos=u$W+u$Y._DATA.offset;for(var u$d=0;u$d<u$j;u$d++)u$Y._strings[u$d]=u$Y._reader.readUTFString();u$Y._reader.pos=u$t},u$Y.parse=function(u$W,u$j){u$Y._animationClip=u$W;(u$Y._reader=u$j).__getBuffer();u$Y.READ_DATA(),u$Y.READ_BLOCK(),u$Y.READ_STRINGS();for(var u$t=0,u$d=u$Y._BLOCK.count;u$t<u$d;u$t++){var u$b=u$j.getUint16(),u$E=u$Y._strings[u$b],u$O=u$Y["READ_"+u$E];if(null==u$O)throw new Error("model file err,no this function:"+u$b+" "+u$E);u$O.call()}},u$Y.READ_ANIMATIONS=function(){var u$W,u$j=0,u$t=0,u$d=u$Y._reader,u$b=u$d.__getBuffer(),u$E=[],u$O=u$d.getUint8();for(u$E.length=u$O,u$j=0;u$j<u$O;u$j++)u$E[u$j]=u$d.getUint16();var u$q=[],u$A=u$d.getUint16();for(u$q.length=u$A,u$j=0;u$j<u$A;u$j++)u$q[u$j]=u$d.getFloat32();var u$c=u$Y._animationClip;u$c.name=u$Y._strings[u$d.getUint16()];var u$R=u$c._duration=u$d.getFloat32();u$c.islooping=!!u$d.getByte(),u$c._frameRate=u$d.getInt16();var u$m=u$d.getInt16(),u$Q=u$c._nodes=new Array;u$Q.length=u$m,(u$c._publicClipDatas=[]).length=u$m;var u$T=u$c._nodesMap={},u$$=0,u$e=0;for(u$j=0;u$j<u$m;u$j++){u$W=u$Q[u$j]=new u$f;var u$K=u$d.getUint16(),u$o=u$W.path=[];for(u$o.length=u$K,u$t=0;u$t<u$K;u$t++)u$o[u$t]=u$Y._strings[u$d.getUint16()];var u$S=u$o.join("/"),u$M=u$T[u$S];u$M||(u$T[u$S]=u$M=[]),u$M.push(u$W);var u$Z=u$d.getInt16();-1!==u$Z&&(u$W.componentType=u$Y._strings[u$Z]);var u$X=u$I._propertyIndexDic[u$Y._strings[u$d.getUint16()]];if(null==u$X)throw new Error("AnimationClipParser02:unknown property name.");var u$_=u$X<4,u$N=!u$_||u$_&&""===u$o[0];(u$W._cacheProperty=u$N)?u$$++:u$e++,u$W.propertyNameID=u$X;var u$z=u$E[u$d.getUint8()];u$W.keyFrameWidth=u$z/4;var u$C=u$W.keyFrames=[],u$L=u$C.length=u$d.getUint16(),u$V=null,u$x=NaN;for(u$t=0;u$t<u$L;u$t++){var u$G=u$C[u$t]=new u$g;u$x=u$G.startTime=u$q[u$d.getUint16()];var u$l=u$d.pos;u$G.inTangent=new Float32Array(u$b.slice(u$l,u$l+u$z)),u$d.pos+=u$z,u$l=u$d.pos,u$G.outTangent=new Float32Array(u$b.slice(u$l,u$l+u$z)),u$d.pos+=u$z,u$l=u$d.pos,u$G.data=new Float32Array(u$b.slice(u$l,u$l+u$z)),u$d.pos+=u$z,u$V&&(u$V.next=u$G,u$V.duration=u$x-u$V.startTime),u$V=u$G}u$G.next=null,u$G.duration=u$R-u$x}var u$h=u$d.getUint16();for(u$j=0;u$j<u$h;u$j++){var u$v,u$y=new u$H;u$y.time=u$d.getFloat32(),u$y.eventName=u$Y._strings[u$d.getUint16()];var u$a=u$d.getUint16();for(0<u$a&&(u$y.params=u$v=[]),u$t=0;u$t<u$a;u$t++){switch(u$d.getByte()){case 0:u$v.push(!!u$d.getByte());break;case 1:u$v.push(u$d.getInt32());break;case 2:u$v.push(u$d.getFloat32());break;case 3:u$v.push(u$Y._strings[u$d.getUint16()]);break;default:throw new Error("unknown type.")}}u$c.addEvent(u$y)}var u$u=u$c._nodeToCachePropertyMap=new Int32Array(u$m),u$D=u$c._cachePropertyMap=new Int32Array(u$$),u$s=u$c._unCachePropertyMap=new Int32Array(u$e);for(u$$=u$e=0,u$j=0;u$j<u$m;u$j++)(u$W=u$Q[u$j])._cacheProperty?(u$u[u$j]=u$$,u$D[u$$++]=u$j):u$s[u$e++]=u$j},u$Y._animationClip=null,u$Y._reader=null,u$Y._strings=[],u$m(u$Y,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var u$H=function(){function u$W(){this.time=NaN,this.eventName=null,this.params=null}return u$T(u$W,"laya.d3.animation.AnimationEvent"),u$W}(),u$I=function(){function u$d(){this._childs=[],this.transform=new u$Sj(this)}u$T(u$d,"laya.d3.animation.AnimationNode");var u$W=u$d.prototype;return u$X.imps(u$W,{"laya.d3.core.IClone":!0}),u$W.addChild=function(u$W){u$W._parent=this,u$W.transform.setParent(this.transform),this._childs.push(u$W)},u$W.removeChild=function(u$W){var u$j=this._childs.indexOf(u$W);-1!==u$j&&this._childs.splice(u$j,1)},u$W.getChildByName=function(u$W){for(var u$j=0,u$t=this._childs.length;u$j<u$t;u$j++){var u$d=this._childs[u$j];if(u$d.name===u$W)return u$d}return null},u$W.getChildByIndex=function(u$W){return this._childs[u$W]},u$W.getChildCount=function(){return this._childs.length},u$W.cloneTo=function(u$W){var u$j=u$W;u$j.name=this.name;for(var u$t=0,u$d=this._childs.length;u$t<u$d;u$t++){var u$b=this._childs[u$t],u$E=u$b.clone();u$j.addChild(u$E);var u$O=u$b.transform,u$q=u$E.transform;u$q.setLocalPosition(u$O.getLocalPosition()),u$q.setLocalRotation(u$O.getLocalRotation()),u$q.setLocalScale(u$O.getLocalScale()),u$q._localRotationEuler=u$O._localRotationEuler,u$q._setWorldMatrixIgnoreUpdate(u$O.getWorldMatrix())}},u$W.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$d.__init__=function(){u$d.registerAnimationNodeProperty("localPosition",u$d._getLocalPosition,u$d._setLocalPosition),u$d.registerAnimationNodeProperty("localRotation",u$d._getLocalRotation,u$d._setLocalRotation),u$d.registerAnimationNodeProperty("localScale",u$d._getLocalScale,u$d._setLocalScale),u$d.registerAnimationNodeProperty("localRotationEuler",u$d._getLocalRotationEuler,u$d._setLocalRotationEuler),u$d.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",u$d._getParticleRenderSharedMaterialTintColor,u$d._setParticleRenderSharedMaterialTintColor),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",u$d._getMeshRenderSharedMaterialTilingOffset,u$d._setMeshRenderSharedMaterialTilingOffset),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",u$d._getMeshRenderSharedMaterialAlbedo,u$d._setMeshRenderSharedMaterialAlbedo),u$d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",u$d._getSkinnedMeshRenderSharedMaterialTilingOffset,u$d._setSkinnedMeshRenderSharedMaterialTilingOffset),u$d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",u$d._getSkinnedMeshRenderSharedMaterialAlbedo,u$d._setSkinnedMeshRenderSharedMaterialAlbedo),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",u$d._getMeshRenderSharedMaterialAlbedo,u$d._setMeshRenderSharedMaterialAlbedo),u$d.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",u$d._getSkinnedMeshRenderSharedMaterialAlbedo,u$d._setSkinnedMeshRenderSharedMaterialAlbedo),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",u$d._getMeshRenderSharedMaterialIntensity,u$d._setMeshRenderSharedMaterialIntensity),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",u$d._getMeshRenderSharedMaterialAlpha,u$d._setMeshRenderSharedMaterialAlpha),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",u$d._getMeshRenderSharedMaterialAlphaColor,u$d._setMeshRenderSharedMaterialAlphaColor),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",u$d._getMeshRenderSharedMaterialBaseColor,u$d._setMeshRenderSharedMaterialBaseColor),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",u$d._getMeshRenderSharedMaterialDissolve,u$d._setMeshRenderSharedMaterialDissolve),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",u$d._getMeshRenderSharedMaterialDissolveSpeed,u$d._setMeshRenderSharedMaterialDissolveSpeed),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",u$d._getMeshRenderSharedMaterialMMultiplier,u$d._setMeshRenderSharedMaterialMMultiplier),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",u$d._getMeshRenderSharedMaterialBaseScrollSpeedX,u$d._setMeshRenderSharedMaterialBaseScrollSpeedX),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",u$d._getMeshRenderSharedMaterialBaseScrollSpeedY,u$d._setMeshRenderSharedMaterialBaseScrollSpeedY),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",u$d._getMeshRenderSharedMaterialSecondScrollSpeedX,u$d._setMeshRenderSharedMaterialSecondScrollSpeedX),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",u$d._getMeshRenderSharedMaterialSecondScrollSpeedY,u$d._setMeshRenderSharedMaterialSecondScrollSpeedY),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",u$d._getMeshRenderSharedMaterialDetailTilingOffset,u$d._setMeshRenderSharedMaterialDetailTilingOffset),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",u$d._getMeshRenderSharedMaterialDissolveTilingOffset,u$d._setMeshRenderSharedMaterialDissolveTilingOffset),u$d.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",u$d._getMeshRenderSharedMaterialMaskTilingOffset,u$d._setMeshRenderSharedMaterialMaskTilingOffset)},u$d.registerAnimationNodeProperty=function(u$W,u$j,u$t){if(u$d._propertyIndexDic[u$W])throw new Error("AnimationNode: this propertyName has registered.");u$d._propertyIndexDic[u$W]=u$d._propertyIDCounter,u$d._propertyGetFuncs[u$d._propertyIDCounter]=u$j,u$d._propertySetFuncs[u$d._propertyIDCounter]=u$t,u$d._propertyIDCounter++},u$d._getLocalPosition=function(u$W,u$j){return u$W?u$W.transform.getLocalPosition():u$j._transform.localPosition.elements},u$d._setLocalPosition=function(u$W,u$j,u$t){if(u$W)u$W.transform.setLocalPosition(u$t);else{var u$d=u$j._transform,u$b=u$d.localPosition;u$b.elements=u$t,u$d.localPosition=u$b}},u$d._getLocalRotation=function(u$W,u$j){return u$W?u$W.transform.getLocalRotation():u$j._transform.localRotation.elements},u$d._setLocalRotation=function(u$W,u$j,u$t){if(u$W)u$W.transform.setLocalRotation(u$t);else{var u$d=u$j._transform,u$b=u$d.localRotation;u$b.elements=u$t,u$d.localRotation=u$b}},u$d._getLocalScale=function(u$W,u$j){return u$W?u$W.transform.getLocalScale():u$j._transform.localScale.elements},u$d._setLocalScale=function(u$W,u$j,u$t){if(u$W)u$W.transform.setLocalScale(u$t);else{var u$d=u$j._transform,u$b=u$d.localScale;u$b.elements=u$t,u$d.localScale=u$b}},u$d._getLocalRotationEuler=function(u$W,u$j){return u$W?u$W.transform.getLocalRotationEuler():u$j._transform.localRotationEuler.elements},u$d._setLocalRotationEuler=function(u$W,u$j,u$t){if(u$W)u$W.transform.setLocalRotationEuler(u$t);else{var u$d=u$j._transform,u$b=u$d.localRotationEuler;u$b.elements=u$t,u$d.localRotationEuler=u$b}},u$d._getMeshRenderSharedMaterialTilingOffset=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return u$j.meshRender.sharedMaterial.tilingOffset.elements},u$d._setMeshRenderSharedMaterialTilingOffset=function(u$W,u$j,u$t){var u$d,u$b;if(u$W){var u$E=u$W.transform._entity;u$E&&((u$b=(u$d=u$E.owner.meshRender.material).tilingOffset).elements=u$t,u$d.tilingOffset=u$b)}else(u$b=(u$d=u$j.meshRender.material).tilingOffset).elements=u$t,u$d.tilingOffset=u$b},u$d._getMeshRenderSharedMaterialAlbedo=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.albedoColor.elements:null}return u$j.meshRender.sharedMaterial.albedoColor.elements},u$d._setMeshRenderSharedMaterialAlbedo=function(u$W,u$j,u$t){var u$d,u$b;if(u$W){var u$E=u$W.transform._entity;u$E&&((u$b=(u$d=u$E.owner.meshRender.material).albedoColor).elements=u$t,u$d.albedoColor=u$b)}else(u$b=(u$d=u$j.meshRender.material).albedoColor).elements=u$t,u$d.albedoColor=u$b},u$d._getSkinnedMeshRenderSharedMaterialTilingOffset=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return u$j.skinnedMeshRender.sharedMaterial.tilingOffset.elements},u$d._setSkinnedMeshRenderSharedMaterialTilingOffset=function(u$W,u$j,u$t){var u$d,u$b;if(u$W){var u$E=u$W.transform._entity;u$E&&((u$b=(u$d=u$E.owner.skinnedMeshRender.material).tilingOffset).elements=u$t,u$d.tilingOffset=u$b)}else(u$b=(u$d=u$j.skinnedMeshRender.material).tilingOffset).elements=u$t,u$d.tilingOffset=u$b},u$d._getSkinnedMeshRenderSharedMaterialAlbedo=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return u$j.skinnedMeshRender.sharedMaterial.albedoColor.elements},u$d._setSkinnedMeshRenderSharedMaterialAlbedo=function(u$W,u$j,u$t){var u$d,u$b;if(u$W){var u$E=u$W.transform._entity;u$E&&((u$b=(u$d=u$E.owner.skinnedMeshRender.material).albedoColor).elements=u$t,u$d.albedoColor=u$b)}else(u$b=(u$d=u$j.skinnedMeshRender.material).albedoColor).elements=u$t,u$d.albedoColor=u$b},u$d._getParticleRenderSharedMaterialTintColor=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.particleRender.sharedMaterial.tintColor.elements:null}return u$j.particleRender.sharedMaterial.tintColor.elements},u$d._setParticleRenderSharedMaterialTintColor=function(u$W,u$j,u$t){var u$d,u$b;if(u$W){var u$E=u$W.transform._entity;u$E&&((u$b=(u$d=u$E.owner.particleRender.material).tintColor).elements=u$t,u$d.tintColor=u$b)}else(u$b=(u$d=u$j.particleRender.material).tintColor).elements=u$t,u$d.tintColor=u$b},u$d._getMeshRenderSharedMaterialAlphaColor=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.alphaColor.elements:null}return u$j.meshRender.sharedMaterial.alphaColor.elements},u$d._setMeshRenderSharedMaterialAlphaColor=function(u$W,u$j,u$t){var u$d,u$b;if(u$W){var u$E=u$W.transform._entity;u$E&&((u$b=(u$d=u$E.owner.meshRender.material).alphaColor).elements=u$t,u$d.alphaColor=u$b)}else(u$b=(u$d=u$j.meshRender.material).alphaColor).elements=u$t,u$d.alphaColor=u$b},u$d._getMeshRenderSharedMaterialBaseColor=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.baseColor.elements:null}return u$j.meshRender.sharedMaterial.baseColor.elements},u$d._setMeshRenderSharedMaterialBaseColor=function(u$W,u$j,u$t){var u$d,u$b;if(u$W){var u$E=u$W.transform._entity;u$E&&((u$b=(u$d=u$E.owner.meshRender.material).baseColor).elements=u$t,u$d.baseColor=u$b)}else(u$b=(u$d=u$j.meshRender.material).baseColor).elements=u$t,u$d.baseColor=u$b},u$d._getMeshRenderSharedMaterialDissolve=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.dissolve:0}return u$j.meshRender.sharedMaterial.dissolve},u$d._setMeshRenderSharedMaterialDissolve=function(u$W,u$j,u$t){if(u$W){var u$d=u$W.transform._entity;u$d&&(u$d.owner.meshRender.material.dissolve=u$t[0])}else u$j.meshRender.material.dissolve=u$t[0]},u$d._getMeshRenderSharedMaterialDissolveSpeed=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.dissolveSpeed:0}return u$j.meshRender.sharedMaterial.dissolveSpeed},u$d._setMeshRenderSharedMaterialDissolveSpeed=function(u$W,u$j,u$t){if(u$W){var u$d=u$W.transform._entity;u$d&&(u$d.owner.meshRender.material.dissolveSpeed=u$t[0])}else u$j.meshRender.material.dissolveSpeed=u$t[0]},u$d._getMeshRenderSharedMaterialMMultiplier=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.mMultiplier:0}return u$j.meshRender.sharedMaterial.mMultiplier},u$d._setMeshRenderSharedMaterialMMultiplier=function(u$W,u$j,u$t){if(u$W){var u$d=u$W.transform._entity;u$d&&(u$d.owner.meshRender.material.mMultiplier=u$t[0])}else u$j.meshRender.material.mMultiplier=u$t[0]},u$d._getMeshRenderSharedMaterialBaseScrollSpeedX=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return u$j.meshRender.sharedMaterial.baseScrollSpeedX},u$d._setMeshRenderSharedMaterialBaseScrollSpeedX=function(u$W,u$j,u$t){if(u$W){var u$d=u$W.transform._entity;u$d&&(u$d.owner.meshRender.material.baseScrollSpeedX=u$t[0])}else u$j.meshRender.material.baseScrollSpeedX=u$t[0]},u$d._getMeshRenderSharedMaterialBaseScrollSpeedY=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return u$j.meshRender.sharedMaterial.baseScrollSpeedY},u$d._setMeshRenderSharedMaterialBaseScrollSpeedY=function(u$W,u$j,u$t){if(u$W){var u$d=u$W.transform._entity;u$d&&(u$d.owner.meshRender.material.baseScrollSpeedY=u$t[0])}else u$j.meshRender.material.baseScrollSpeedY=u$t[0]},u$d._getMeshRenderSharedMaterialSecondScrollSpeedX=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return u$j.meshRender.sharedMaterial.secondScrollSpeedX},u$d._setMeshRenderSharedMaterialSecondScrollSpeedX=function(u$W,u$j,u$t){if(u$W){var u$d=u$W.transform._entity;u$d&&(u$d.owner.meshRender.material.secondScrollSpeedX=u$t[0])}else u$j.meshRender.material.secondScrollSpeedX=u$t[0]},u$d._getMeshRenderSharedMaterialSecondScrollSpeedY=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return u$j.meshRender.sharedMaterial.secondScrollSpeedY},u$d._setMeshRenderSharedMaterialSecondScrollSpeedY=function(u$W,u$j,u$t){if(u$W){var u$d=u$W.transform._entity;u$d&&(u$d.owner.meshRender.material.secondScrollSpeedY=u$t[0])}else u$j.meshRender.material.secondScrollSpeedY=u$t[0]},u$d._getMeshRenderSharedMaterialAlpha=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.alpha:0}return u$j.meshRender.sharedMaterial.alpha},u$d._setMeshRenderSharedMaterialAlpha=function(u$W,u$j,u$t){if(u$W){var u$d=u$W.transform._entity;u$d&&(u$d.owner.meshRender.material.alpha=u$t[0])}else u$j.meshRender.material.alpha=u$t[0]},u$d._getMeshRenderSharedMaterialIntensity=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.intensity:0}return u$j.meshRender.sharedMaterial.intensity},u$d._setMeshRenderSharedMaterialIntensity=function(u$W,u$j,u$t){if(u$W){var u$d=u$W.transform._entity;u$d&&(u$d.owner.meshRender.material.intensity=u$t[0])}else u$j.meshRender.material.intensity=u$t[0]},u$d._getMeshRenderSharedMaterialDetailTilingOffset=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return u$j.meshRender.sharedMaterial.detailTilingOffset.elements},u$d._setMeshRenderSharedMaterialDetailTilingOffset=function(u$W,u$j,u$t){var u$d,u$b;if(u$W){var u$E=u$W.transform._entity;u$E&&((u$b=(u$d=u$E.owner.meshRender.material).detailTilingOffset).elements=u$t,u$d.detailTilingOffset=u$b)}else(u$b=(u$d=u$j.meshRender.material).detailTilingOffset).elements=u$t,u$d.detailTilingOffset=u$b},u$d._getMeshRenderSharedMaterialDissolveTilingOffset=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return u$j.meshRender.sharedMaterial.dissolveTilingOffset.elements},u$d._setMeshRenderSharedMaterialDissolveTilingOffset=function(u$W,u$j,u$t){var u$d,u$b;if(u$W){var u$E=u$W.transform._entity;u$E&&((u$b=(u$d=u$E.owner.meshRender.material).dissolveTilingOffset).elements=u$t,u$d.dissolveTilingOffset=u$b)}else(u$b=(u$d=u$j.meshRender.material).dissolveTilingOffset).elements=u$t,u$d.dissolveTilingOffset=u$b},u$d._getMeshRenderSharedMaterialMaskTilingOffset=function(u$W,u$j){if(u$W){var u$t=u$W.transform._entity;return u$t?u$t.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return u$j.meshRender.sharedMaterial.maskTilingOffset.elements},u$d._setMeshRenderSharedMaterialMaskTilingOffset=function(u$W,u$j,u$t){var u$d,u$b;if(u$W){var u$E=u$W.transform._entity;u$E&&((u$b=(u$d=u$E.owner.meshRender.material).maskTilingOffset).elements=u$t,u$d.maskTilingOffset=u$b)}else(u$b=(u$d=u$j.meshRender.material).maskTilingOffset).elements=u$t,u$d.maskTilingOffset=u$b},u$d._propertyIDCounter=0,u$d._propertyIndexDic={},u$d._propertySetFuncs=[],u$d._propertyGetFuncs=[],u$d}(),u$g=function(){function u$W(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return u$T(u$W,"laya.d3.animation.Keyframe"),u$W}(),u$f=function(){function u$W(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return u$T(u$W,"laya.d3.animation.KeyframeNode"),u$W}(),u$v=(function(){function u$W(){this._tempVector30=new u$Oj,this._tempVector31=new u$Oj,this._tempVector32=new u$Oj,this._a=new u$Oj,this._b=new u$Oj,this._c=new u$Oj,this._d=new u$Oj}u$T(u$W,"laya.d3.core.glitter.SplineCurvePositionVelocity");var u$j=u$W.prototype;u$j.Init=function(u$W,u$j,u$t,u$d){u$W.cloneTo(this._d),u$j.cloneTo(this._c),u$Oj.scale(u$W,2,this._a),u$Oj.scale(u$t,2,this._tempVector30),u$Oj.subtract(this._a,this._tempVector30,this._a),u$Oj.add(this._a,u$j,this._a),u$Oj.add(this._a,u$d,this._a),u$Oj.scale(u$t,3,this._b),u$Oj.scale(u$W,3,this._tempVector30),u$Oj.subtract(this._b,this._tempVector30,this._b),u$Oj.subtract(this._b,u$d,this._b),u$Oj.scale(u$j,2,this._tempVector30),u$Oj.subtract(this._b,this._tempVector30,this._b)},u$j.Slerp=function(u$W,u$j){u$Oj.scale(this._a,u$W*u$W*u$W,this._tempVector30),u$Oj.scale(this._b,u$W*u$W,this._tempVector31),u$Oj.scale(this._c,u$W,this._tempVector32),u$Oj.add(this._tempVector30,this._tempVector31,u$j),u$Oj.add(u$j,this._tempVector32,u$j),u$Oj.add(u$j,this._d,u$j)}}(),function(){function u$D(u$W,u$j,u$t,u$d){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=u$W,this._h=u$j,this._minHeight=u$t,this._maxHeight=u$d}u$T(u$D,"laya.d3.core.HeightMap");var u$W=u$D.prototype;u$W._inBounds=function(u$W,u$j){return 0<=u$W&&u$W<this._h&&0<=u$j&&u$j<this._w},u$W.getHeight=function(u$W,u$j){return this._inBounds(u$W,u$j)?this._datas[u$W][u$j]:NaN},u$$(0,u$W,"width",function(){return this._w}),u$$(0,u$W,"height",function(){return this._h}),u$$(0,u$W,"maxHeight",function(){return this._maxHeight}),u$$(0,u$W,"minHeight",function(){return this._minHeight}),u$D.creatFromMesh=function(u$W,u$j,u$t,u$d){for(var u$b=[],u$E=[],u$O=u$W.getSubMeshCount(),u$q=0;u$q<u$O;u$q++){for(var u$A=u$W.getSubMesh(u$q),u$c=u$A._getVertexBuffer(),u$R=u$c.getData(),u$m=[],u$Q=0;u$Q<u$R.length;u$Q+=u$c.vertexDeclaration.vertexStride/4){var u$T=new u$Oj(u$R[u$Q+0],u$R[u$Q+1],u$R[u$Q+2]);u$m.push(u$T)}u$b.push(u$m);var u$$=u$A._getIndexBuffer();u$E.push(u$$.getData())}var u$e=u$W.boundingBox,u$K=u$e.min.x,u$o=u$e.min.z,u$S=u$e.max.x,u$M=u$e.max.z,u$Z=u$e.min.y,u$X=u$e.max.y,u$_=u$S-u$K,u$N=u$M-u$o,u$z=u$d.elements[0]=u$_/(u$j-1),u$C=u$d.elements[1]=u$N/(u$t-1),u$L=new u$D(u$j,u$t,u$Z,u$X),u$V=u$D._tempRay,u$x=u$V.direction.elements;u$x[0]=0,u$x[1]=-1,u$x[2]=0;var u$G=u$X+.1;u$V.origin.elements[1]=u$G;for(var u$l=0;u$l<u$t;u$l++){var u$h=u$o+u$l*u$C;u$L._datas[u$l]=[];for(var u$v=0;u$v<u$j;u$v++){var u$y=u$K+u$v*u$z,u$a=u$V.origin.elements;u$a[0]=u$y,u$a[2]=u$h;var u$u=u$D._getPosition(u$V,u$b,u$E);u$L._datas[u$l][u$v]=u$u===Number.MAX_VALUE?NaN:u$G-u$u}}return u$L},u$D.createFromImage=function(u$W,u$j,u$t){for(var u$d=u$W.width,u$b=u$W.height,u$E=new u$D(u$d,u$b,u$j,u$t),u$O=(u$t-u$j)/254,u$q=u$W.getPixels(),u$A=0,u$c=0;u$c<u$b;u$c++)for(var u$R=u$E._datas[u$c]=[],u$m=0;u$m<u$d;u$m++){var u$Q=u$q[u$A++],u$T=u$q[u$A++],u$$=u$q[u$A++],u$e=u$q[u$A++];u$R[u$m]=255==u$Q&&255==u$T&&255==u$$&&255==u$e?NaN:(u$Q+u$T+u$$)/3*u$O+u$j}return u$E},u$D._getPosition=function(u$W,u$j,u$t){for(var u$d=Number.MAX_VALUE,u$b=0;u$b<u$j.length;u$b++)for(var u$E=u$j[u$b],u$O=u$t[u$b],u$q=0;u$q<u$O.length;u$q+=3){var u$A=u$E[u$O[u$q+0]],u$c=u$E[u$O[u$q+1]],u$R=u$E[u$O[u$q+2]],u$m=u$$j.rayIntersectsTriangle(u$W,u$A,u$c,u$R);!isNaN(u$m)&&u$m<u$d&&(u$d=u$m)}return u$d},u$m(u$D,["_tempRay",function(){return this._tempRay=new u$bj(new u$Oj,new u$Oj)}])}(),function(){function u$b(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}u$T(u$b,"laya.d3.core.Layer");var u$W=u$b.prototype;return u$W._binarySearchIndex=function(){for(var u$W=0,u$j=u$b._collsionTestList.length-1,u$t=0;u$W<=u$j;){u$t=Math.floor((u$W+u$j)/2);var u$d=u$b._collsionTestList[u$t];if(u$d==this._number)return u$t;u$d>this._number?u$j=u$t-1:u$W=u$t+1}return u$W},u$W._addCollider=function(u$W){0===this._colliders.length&&u$b._collsionTestList.splice(this._binarySearchIndex(),0,this._number),u$W._isRigidbody?(this._colliders.unshift(u$W),this._nonRigidbodyOffset++):this._colliders.push(u$W)},u$W._removeCollider=function(u$W){var u$j=this._colliders.indexOf(u$W);u$j<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(u$j,1),0===this._colliders.length&&u$b._collsionTestList.splice(u$b._collsionTestList.indexOf(this._number),1)},u$$(0,u$W,"number",function(){return this._number}),u$$(0,u$W,"visible",function(){return this._visible},function(u$W){this._visible=u$W,u$b._visibleLayers=u$W?u$b._visibleLayers|this.mask:u$b._visibleLayers&~this.mask}),u$$(0,u$W,"mask",function(){return this._mask}),u$$(1,u$b,"visibleLayers",function(){return u$b._visibleLayers},function(u$W){u$b._visibleLayers=u$W;for(var u$j=0,u$t=u$b._layerList.length;u$j<u$t;u$j++){var u$d=u$b._layerList[u$j];u$d._visible=0!=(u$d._mask&u$b._visibleLayers)}}),u$b.__init__=function(){u$b._layerList.length=31;for(var u$W=0;u$W<31;u$W++){var u$j=new u$b;u$b._layerList[u$W]=u$j,0===u$W?(u$j.name="Default Layer",u$j.visible=!0):(u$j.name="Layer-"+u$W,u$j.visible=!1),u$j._number=u$W,u$j._mask=Math.pow(2,u$W)}u$b.currentCreationLayer=u$b._layerList[0]},u$b.getLayerByNumber=function(u$W){if(u$W<0||30<u$W)throw new Error("无法返回指定Layer，该number超出范围！");return u$b._layerList[u$W]},u$b.getLayerByName=function(u$W){for(var u$j=0;u$j<31;u$j++)if(u$b._layerList[u$j].name===u$W)return u$b._layerList[u$j];throw new Error("无法返回指定Layer,该name不存在")},u$b.isVisible=function(u$W){return 0!=(u$W&u$b._currentCameraCullingMask&u$b._visibleLayers)},u$b._layerList=[],u$b._visibleLayers=2147483647,u$b._collsionTestList=[],u$b._currentCameraCullingMask=2147483647,u$b.maxCount=31,u$b.currentCreationLayer=null,u$b}()),u$y=(function(){function u$W(u$W,u$j,u$t){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=u$W,this._minCount=u$j,this._maxCount=u$t}u$T(u$W,"laya.d3.core.particleShuriKen.module.Burst");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j.cloneTo=function(u$W){var u$j=u$W;u$j._time=this._time,u$j._minCount=this._minCount,u$j._maxCount=this._maxCount},u$j.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$j,"time",function(){return this._time}),u$$(0,u$j,"minCount",function(){return this._minCount}),u$$(0,u$j,"maxCount",function(){return this._maxCount})}(),function(){function u$W(u$W){this._color=null,this.enbale=!1,this._color=u$W}u$T(u$W,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var u$j=u$W.prototype;u$j.cloneTo=function(u$W){var u$j=u$W;this._color.cloneTo(u$j._color),u$j.enbale=this.enbale},u$j.clone=function(){var u$W;switch(this._color.type){case 0:u$W=u$u.createByConstant(this._color.constant.clone());break;case 1:u$W=u$u.createByGradient(this._color.gradient.clone());break;case 2:u$W=u$u.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:u$W=u$u.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var u$j=new this.constructor(u$W);return u$j.enbale=this.enbale,u$j},u$$(0,u$j,"color",function(){return this._color})}(),function(){function u$W(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}u$T(u$W,"laya.d3.core.particleShuriKen.module.Emission");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),u$j._destroy=function(){this._bursts=null,this._destroyed=!0},u$j.getBurstsCount=function(){return this._bursts.length},u$j.getBurstByIndex=function(u$W){return this._bursts[u$W]},u$j.addBurst=function(u$W){var u$j=this._bursts.length;if(0<u$j)for(var u$t=0;u$t<u$j;u$t++)this._bursts[u$t].time>u$W.time&&this._bursts.splice(u$t,0,u$W);this._bursts.push(u$W)},u$j.removeBurst=function(u$W){var u$j=this._bursts.indexOf(u$W);-1!==u$j&&this._bursts.splice(u$j,1)},u$j.removeBurstByIndex=function(u$W){this._bursts.splice(u$W,1)},u$j.clearBurst=function(){this._bursts.length=0},u$j.cloneTo=function(u$W){var u$j=u$W,u$t=u$j._bursts;u$t.length=this._bursts.length;for(var u$d=0,u$b=this._bursts.length;u$d<u$b;u$d++){var u$E=u$t[u$d];u$E?this._bursts[u$d].cloneTo(u$E):u$t[u$d]=this._bursts[u$d].clone()}u$j._emissionRate=this._emissionRate,u$j.enbale=this.enbale},u$j.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$j,"destroyed",function(){return this._destroyed}),u$$(0,u$j,"emissionRate",function(){return this._emissionRate},function(u$W){if(u$W<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=u$W})}(),function(){function u$d(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}u$T(u$d,"laya.d3.core.particleShuriKen.module.FrameOverTime");var u$W=u$d.prototype;return u$X.imps(u$W,{"laya.d3.core.IClone":!0}),u$W.cloneTo=function(u$W){var u$j=u$W;u$j._type=this._type,u$j._constant=this._constant,this._overTime.cloneTo(u$j._overTime),u$j._constantMin=this._constantMin,u$j._constantMax=this._constantMax,this._overTimeMin.cloneTo(u$j._overTimeMin),this._overTimeMax.cloneTo(u$j._overTimeMax)},u$W.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$W,"frameOverTimeData",function(){return this._overTime}),u$$(0,u$W,"constant",function(){return this._constant}),u$$(0,u$W,"type",function(){return this._type}),u$$(0,u$W,"frameOverTimeDataMin",function(){return this._overTimeMin}),u$$(0,u$W,"constantMin",function(){return this._constantMin}),u$$(0,u$W,"frameOverTimeDataMax",function(){return this._overTimeMax}),u$$(0,u$W,"constantMax",function(){return this._constantMax}),u$d.createByConstant=function(u$W){var u$j=new u$d;return u$j._type=0,u$j._constant=u$W,u$j},u$d.createByOverTime=function(u$W){var u$j=new u$d;return u$j._type=1,u$j._overTime=u$W,u$j},u$d.createByRandomTwoConstant=function(u$W,u$j){var u$t=new u$d;return u$t._type=2,u$t._constantMin=u$W,u$t._constantMax=u$j,u$t},u$d.createByRandomTwoOverTime=function(u$W,u$j){var u$t=new u$d;return u$t._type=3,u$t._overTimeMin=u$W,u$t._overTimeMax=u$j,u$t},u$d}()),u$a=function(){function u$c(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}u$T(u$c,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var u$W=u$c.prototype;return u$X.imps(u$W,{"laya.d3.core.IClone":!0}),u$W.cloneTo=function(u$W){var u$j=u$W;u$j._type=this._type,u$j._separateAxes=this._separateAxes,u$j._constant=this._constant,this._constantSeparate.cloneTo(u$j._constantSeparate),this._gradient.cloneTo(u$j._gradient),this._gradientX.cloneTo(u$j._gradientX),this._gradientY.cloneTo(u$j._gradientY),this._gradientZ.cloneTo(u$j._gradientZ),u$j._constantMin=this._constantMin,u$j._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(u$j._constantMinSeparate),this._constantMaxSeparate.cloneTo(u$j._constantMaxSeparate),this._gradientMin.cloneTo(u$j._gradientMin),this._gradientMax.cloneTo(u$j._gradientMax),this._gradientXMin.cloneTo(u$j._gradientXMin),this._gradientXMax.cloneTo(u$j._gradientXMax),this._gradientYMin.cloneTo(u$j._gradientYMin),this._gradientYMax.cloneTo(u$j._gradientYMax),this._gradientZMin.cloneTo(u$j._gradientZMin),this._gradientZMax.cloneTo(u$j._gradientZMax)},u$W.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$W,"gradientZ",function(){return this._gradientZ}),u$$(0,u$W,"constant",function(){return this._constant}),u$$(0,u$W,"gradient",function(){return this._gradient}),u$$(0,u$W,"separateAxes",function(){return this._separateAxes}),u$$(0,u$W,"type",function(){return this._type}),u$$(0,u$W,"constantSeparate",function(){return this._constantSeparate}),u$$(0,u$W,"gradientX",function(){return this._gradientX}),u$$(0,u$W,"gradientY",function(){return this._gradientY}),u$$(0,u$W,"gradientW",function(){return this._gradientW}),u$$(0,u$W,"gradientMin",function(){return this._gradientMin}),u$$(0,u$W,"constantMin",function(){return this._constantMin}),u$$(0,u$W,"gradientMax",function(){return this._gradientMax}),u$$(0,u$W,"constantMax",function(){return this._constantMax}),u$$(0,u$W,"gradientWMin",function(){return this._gradientWMin}),u$$(0,u$W,"constantMinSeparate",function(){return this._constantMinSeparate}),u$$(0,u$W,"constantMaxSeparate",function(){return this._constantMaxSeparate}),u$$(0,u$W,"gradientXMin",function(){return this._gradientXMin}),u$$(0,u$W,"gradientXMax",function(){return this._gradientXMax}),u$$(0,u$W,"gradientWMax",function(){return this._gradientWMax}),u$$(0,u$W,"gradientYMin",function(){return this._gradientYMin}),u$$(0,u$W,"gradientYMax",function(){return this._gradientYMax}),u$$(0,u$W,"gradientZMin",function(){return this._gradientZMin}),u$$(0,u$W,"gradientZMax",function(){return this._gradientZMax}),u$c.createByConstant=function(u$W){var u$j=new u$c;return u$j._type=0,u$j._separateAxes=!1,u$j._constant=u$W,u$j},u$c.createByConstantSeparate=function(u$W){var u$j=new u$c;return u$j._type=0,u$j._separateAxes=!0,u$j._constantSeparate=u$W,u$j},u$c.createByGradient=function(u$W){var u$j=new u$c;return u$j._type=1,u$j._separateAxes=!1,u$j._gradient=u$W,u$j},u$c.createByGradientSeparate=function(u$W,u$j,u$t,u$d){var u$b=new u$c;return u$b._type=1,u$b._separateAxes=!0,u$b._gradientX=u$W,u$b._gradientY=u$j,u$b._gradientZ=u$t,u$b._gradientW=u$d,u$b},u$c.createByRandomTwoConstant=function(u$W,u$j){var u$t=new u$c;return u$t._type=2,u$t._separateAxes=!1,u$t._constantMin=u$W,u$t._constantMax=u$j,u$t},u$c.createByRandomTwoConstantSeparate=function(u$W,u$j){var u$t=new u$c;return u$t._type=2,u$t._separateAxes=!0,u$t._constantMinSeparate=u$W,u$t._constantMaxSeparate=u$j,u$t},u$c.createByRandomTwoGradient=function(u$W,u$j){var u$t=new u$c;return u$t._type=3,u$t._separateAxes=!1,u$t._gradientMin=u$W,u$t._gradientMax=u$j,u$t},u$c.createByRandomTwoGradientSeparate=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){var u$A=new u$c;return u$A._type=3,u$A._separateAxes=!0,u$A._gradientXMin=u$W,u$A._gradientXMax=u$j,u$A._gradientYMin=u$t,u$A._gradientYMax=u$d,u$A._gradientZMin=u$b,u$A._gradientZMax=u$E,u$A._gradientWMin=u$O,u$A._gradientWMax=u$q,u$A},u$c}(),u$u=function(){function u$d(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}u$T(u$d,"laya.d3.core.particleShuriKen.module.GradientColor");var u$W=u$d.prototype;return u$X.imps(u$W,{"laya.d3.core.IClone":!0}),u$W.cloneTo=function(u$W){var u$j=u$W;u$j._type=this._type,this._constant.cloneTo(u$j._constant),this._constantMin.cloneTo(u$j._constantMin),this._constantMax.cloneTo(u$j._constantMax),this._gradient.cloneTo(u$j._gradient),this._gradientMin.cloneTo(u$j._gradientMin),this._gradientMax.cloneTo(u$j._gradientMax)},u$W.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$W,"gradient",function(){return this._gradient}),u$$(0,u$W,"constant",function(){return this._constant}),u$$(0,u$W,"type",function(){return this._type}),u$$(0,u$W,"gradientMin",function(){return this._gradientMin}),u$$(0,u$W,"constantMin",function(){return this._constantMin}),u$$(0,u$W,"gradientMax",function(){return this._gradientMax}),u$$(0,u$W,"constantMax",function(){return this._constantMax}),u$d.createByConstant=function(u$W){var u$j=new u$d;return u$j._type=0,u$j._constant=u$W,u$j},u$d.createByGradient=function(u$W){var u$j=new u$d;return u$j._type=1,u$j._gradient=u$W,u$j},u$d.createByRandomTwoConstant=function(u$W,u$j){var u$t=new u$d;return u$t._type=2,u$t._constantMin=u$W,u$t._constantMax=u$j,u$t},u$d.createByRandomTwoGradient=function(u$W,u$j){var u$t=new u$d;return u$t._type=3,u$t._gradientMin=u$W,u$t._gradientMax=u$j,u$t},u$d}(),u$D=(function(){function u$W(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}u$T(u$W,"laya.d3.core.particleShuriKen.module.GradientDataColor");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j.addAlpha=function(u$W,u$j){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==u$W&&(u$W=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=u$W,this._alphaElements[this._alphaCurrentLength++]=u$j):DEBUG},u$j.addRGB=function(u$W,u$j){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==u$W&&(u$W=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=u$W,this._rgbElements[this._rgbCurrentLength++]=u$j.x,this._rgbElements[this._rgbCurrentLength++]=u$j.y,this._rgbElements[this._rgbCurrentLength++]=u$j.z):DEBUG},u$j.cloneTo=function(u$W){var u$j=u$W,u$t=0,u$d=0;u$j._alphaCurrentLength=this._alphaCurrentLength;var u$b=u$j._alphaElements;for(u$b.length=this._alphaElements.length,u$t=0,u$d=this._alphaElements.length;u$t<u$d;u$t++)u$b[u$t]=this._alphaElements[u$t];u$j._rgbCurrentLength=this._rgbCurrentLength;var u$E=u$j._rgbElements;for(u$E.length=this._rgbElements.length,u$t=0,u$d=this._rgbElements.length;u$t<u$d;u$t++)u$E[u$t]=this._rgbElements[u$t]},u$j.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$j,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),u$$(0,u$j,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function u$W(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}u$T(u$W,"laya.d3.core.particleShuriKen.module.GradientDataInt");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j.add=function(u$W,u$j){this._currentLength<8?(6===this._currentLength&&1!==u$W&&(u$W=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=u$W,this._elements[this._currentLength++]=u$j):console.log("Warning:data count must lessEqual than 4")},u$j.cloneTo=function(u$W){var u$j=u$W;u$j._currentLength=this._currentLength;var u$t=u$j._elements;u$t.length=this._elements.length;for(var u$d=0,u$b=this._elements.length;u$d<u$b;u$d++)u$t[u$d]=this._elements[u$d]},u$j.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$j,"gradientCount",function(){return this._currentLength/2})}(),function(){function u$W(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}u$T(u$W,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j.add=function(u$W,u$j){this._currentLength<8?(6===this._currentLength&&1!==u$W&&(u$W=1,DEBUG),this._elements[this._currentLength++]=u$W,this._elements[this._currentLength++]=u$j):DEBUG},u$j.getKeyByIndex=function(u$W){return this._elements[2*u$W]},u$j.getValueByIndex=function(u$W){return this._elements[2*u$W+1]},u$j.getAverageValue=function(){for(var u$W=0,u$j=this._currentLength-2;u$W<u$j;u$W+=2){this._elements[u$W+1];this._elements[u$W+3],this._elements[u$W+2]-this._elements[u$W]}return 0},u$j.cloneTo=function(u$W){var u$j=u$W;u$j._currentLength=this._currentLength;var u$t=u$j._elements;u$t.length=this._elements.length;for(var u$d=0,u$b=this._elements.length;u$d<u$b;u$d++)u$t[u$d]=this._elements[u$d]},u$j.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$j,"gradientCount",function(){return this._currentLength/2})}(),function(){function u$W(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}u$T(u$W,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j.add=function(u$W,u$j){this._currentLength<8?(6===this._currentLength&&1!==u$W&&(u$W=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=u$W,this._elements[this._currentLength++]=u$j.x,this._elements[this._currentLength++]=u$j.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},u$j.cloneTo=function(u$W){var u$j=u$W;u$j._currentLength=this._currentLength;var u$t=u$j._elements;u$t.length=this._elements.length;for(var u$d=0,u$b=this._elements.length;u$d<u$b;u$d++)u$t[u$d]=this._elements[u$d]},u$j.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$j,"gradientCount",function(){return this._currentLength/3})}(),function(){function u$q(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}u$T(u$q,"laya.d3.core.particleShuriKen.module.GradientSize");var u$W=u$q.prototype;return u$X.imps(u$W,{"laya.d3.core.IClone":!0}),u$W.getMaxSizeInGradient=function(){var u$W=0,u$j=0,u$t=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(u$W=0,u$j=this._gradientX.gradientCount;u$W<u$j;u$W++)u$t=Math.max(u$t,this._gradientX.getValueByIndex(u$W));for(u$W=0,u$j=this._gradientY.gradientCount;u$W<u$j;u$W++)u$t=Math.max(u$t,this._gradientY.getValueByIndex(u$W))}else for(u$W=0,u$j=this._gradient.gradientCount;u$W<u$j;u$W++)u$t=Math.max(u$t,this._gradient.getValueByIndex(u$W));break;case 1:u$t=this._separateAxes?(u$t=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),u$t=Math.max(u$t,this._constantMinSeparate.y),Math.max(u$t,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(u$W=0,u$j=this._gradientXMin.gradientCount;u$W<u$j;u$W++)u$t=Math.max(u$t,this._gradientXMin.getValueByIndex(u$W));for(u$W=0,u$j=this._gradientXMax.gradientCount;u$W<u$j;u$W++)u$t=Math.max(u$t,this._gradientXMax.getValueByIndex(u$W));for(u$W=0,u$j=this._gradientYMin.gradientCount;u$W<u$j;u$W++)u$t=Math.max(u$t,this._gradientYMin.getValueByIndex(u$W));for(u$W=0,u$j=this._gradientZMax.gradientCount;u$W<u$j;u$W++)u$t=Math.max(u$t,this._gradientZMax.getValueByIndex(u$W))}else{for(u$W=0,u$j=this._gradientMin.gradientCount;u$W<u$j;u$W++)u$t=Math.max(u$t,this._gradientMin.getValueByIndex(u$W));for(u$W=0,u$j=this._gradientMax.gradientCount;u$W<u$j;u$W++)u$t=Math.max(u$t,this._gradientMax.getValueByIndex(u$W))}}return u$t},u$W.cloneTo=function(u$W){var u$j=u$W;u$j._type=this._type,u$j._separateAxes=this._separateAxes,this._gradient.cloneTo(u$j._gradient),this._gradientX.cloneTo(u$j._gradientX),this._gradientY.cloneTo(u$j._gradientY),this._gradientZ.cloneTo(u$j._gradientZ),u$j._constantMin=this._constantMin,u$j._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(u$j._constantMinSeparate),this._constantMaxSeparate.cloneTo(u$j._constantMaxSeparate),this._gradientMin.cloneTo(u$j._gradientMin),this._gradientMax.cloneTo(u$j._gradientMax),this._gradientXMin.cloneTo(u$j._gradientXMin),this._gradientXMax.cloneTo(u$j._gradientXMax),this._gradientYMin.cloneTo(u$j._gradientYMin),this._gradientYMax.cloneTo(u$j._gradientYMax),this._gradientZMin.cloneTo(u$j._gradientZMin),this._gradientZMax.cloneTo(u$j._gradientZMax)},u$W.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$W,"gradientZ",function(){return this._gradientZ}),u$$(0,u$W,"gradient",function(){return this._gradient}),u$$(0,u$W,"separateAxes",function(){return this._separateAxes}),u$$(0,u$W,"type",function(){return this._type}),u$$(0,u$W,"gradientMin",function(){return this._gradientMin}),u$$(0,u$W,"constantMin",function(){return this._constantMin}),u$$(0,u$W,"gradientX",function(){return this._gradientX}),u$$(0,u$W,"gradientY",function(){return this._gradientY}),u$$(0,u$W,"gradientMax",function(){return this._gradientMax}),u$$(0,u$W,"constantMax",function(){return this._constantMax}),u$$(0,u$W,"constantMinSeparate",function(){return this._constantMinSeparate}),u$$(0,u$W,"constantMaxSeparate",function(){return this._constantMaxSeparate}),u$$(0,u$W,"gradientXMin",function(){return this._gradientXMin}),u$$(0,u$W,"gradientXMax",function(){return this._gradientXMax}),u$$(0,u$W,"gradientYMin",function(){return this._gradientYMin}),u$$(0,u$W,"gradientYMax",function(){return this._gradientYMax}),u$$(0,u$W,"gradientZMin",function(){return this._gradientZMin}),u$$(0,u$W,"gradientZMax",function(){return this._gradientZMax}),u$q.createByGradient=function(u$W){var u$j=new u$q;return u$j._type=0,u$j._separateAxes=!1,u$j._gradient=u$W,u$j},u$q.createByGradientSeparate=function(u$W,u$j,u$t){var u$d=new u$q;return u$d._type=0,u$d._separateAxes=!0,u$d._gradientX=u$W,u$d._gradientY=u$j,u$d._gradientZ=u$t,u$d},u$q.createByRandomTwoConstant=function(u$W,u$j){var u$t=new u$q;return u$t._type=1,u$t._separateAxes=!1,u$t._constantMin=u$W,u$t._constantMax=u$j,u$t},u$q.createByRandomTwoConstantSeparate=function(u$W,u$j){var u$t=new u$q;return u$t._type=1,u$t._separateAxes=!0,u$t._constantMinSeparate=u$W,u$t._constantMaxSeparate=u$j,u$t},u$q.createByRandomTwoGradient=function(u$W,u$j){var u$t=new u$q;return u$t._type=2,u$t._separateAxes=!1,u$t._gradientMin=u$W,u$t._gradientMax=u$j,u$t},u$q.createByRandomTwoGradientSeparate=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=new u$q;return u$O._type=2,u$O._separateAxes=!0,u$O._gradientXMin=u$W,u$O._gradientXMax=u$j,u$O._gradientYMin=u$t,u$O._gradientYMax=u$d,u$O._gradientZMin=u$b,u$O._gradientZMax=u$E,u$O},u$q}()),u$s=function(){function u$q(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}u$T(u$q,"laya.d3.core.particleShuriKen.module.GradientVelocity");var u$W=u$q.prototype;return u$X.imps(u$W,{"laya.d3.core.IClone":!0}),u$W.cloneTo=function(u$W){var u$j=u$W;u$j._type=this._type,this._constant.cloneTo(u$j._constant),this._gradientX.cloneTo(u$j._gradientX),this._gradientY.cloneTo(u$j._gradientY),this._gradientZ.cloneTo(u$j._gradientZ),this._constantMin.cloneTo(u$j._constantMin),this._constantMax.cloneTo(u$j._constantMax),this._gradientXMin.cloneTo(u$j._gradientXMin),this._gradientXMax.cloneTo(u$j._gradientXMax),this._gradientYMin.cloneTo(u$j._gradientYMin),this._gradientYMax.cloneTo(u$j._gradientYMax),this._gradientZMin.cloneTo(u$j._gradientZMin),this._gradientZMax.cloneTo(u$j._gradientZMax)},u$W.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$W,"gradientZ",function(){return this._gradientZ}),u$$(0,u$W,"constant",function(){return this._constant}),u$$(0,u$W,"type",function(){return this._type}),u$$(0,u$W,"gradientXMax",function(){return this._gradientXMax}),u$$(0,u$W,"constantMin",function(){return this._constantMin}),u$$(0,u$W,"gradientX",function(){return this._gradientX}),u$$(0,u$W,"gradientY",function(){return this._gradientY}),u$$(0,u$W,"gradientXMin",function(){return this._gradientXMin}),u$$(0,u$W,"constantMax",function(){return this._constantMax}),u$$(0,u$W,"gradientYMin",function(){return this._gradientYMin}),u$$(0,u$W,"gradientYMax",function(){return this._gradientYMax}),u$$(0,u$W,"gradientZMin",function(){return this._gradientZMin}),u$$(0,u$W,"gradientZMax",function(){return this._gradientZMax}),u$q.createByConstant=function(u$W){var u$j=new u$q;return u$j._type=0,u$j._constant=u$W,u$j},u$q.createByGradient=function(u$W,u$j,u$t){var u$d=new u$q;return u$d._type=1,u$d._gradientX=u$W,u$d._gradientY=u$j,u$d._gradientZ=u$t,u$d},u$q.createByRandomTwoConstant=function(u$W,u$j){var u$t=new u$q;return u$t._type=2,u$t._constantMin=u$W,u$t._constantMax=u$j,u$t},u$q.createByRandomTwoGradient=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=new u$q;return u$O._type=3,u$O._gradientXMin=u$W,u$O._gradientXMax=u$j,u$O._gradientYMin=u$t,u$O._gradientYMax=u$d,u$O._gradientZMin=u$b,u$O._gradientZMax=u$E,u$O},u$q}(),u$Y=(function(){function u$W(u$W){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=u$W}u$T(u$W,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j.cloneTo=function(u$W){var u$j=u$W;this._angularVelocity.cloneTo(u$j._angularVelocity),u$j.enbale=this.enbale},u$j.clone=function(){var u$W;switch(this._angularVelocity.type){case 0:u$W=this._angularVelocity.separateAxes?u$a.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):u$a.createByConstant(this._angularVelocity.constant);break;case 1:u$W=this._angularVelocity.separateAxes?u$a.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):u$a.createByGradient(this._angularVelocity.gradient.clone());break;case 2:u$W=this._angularVelocity.separateAxes?u$a.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):u$a.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:u$W=this._angularVelocity.separateAxes?u$a.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):u$a.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var u$j=new this.constructor(u$W);return u$j.enbale=this.enbale,u$j},u$$(0,u$j,"angularVelocity",function(){return this._angularVelocity})}(),function(){function u$W(){this.enable=!1,this.randomDirection=!1}u$T(u$W,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j._getShapeBoundBox=function(u$W){throw new Error("BaseShape: must override it.")},u$j._getSpeedBoundBox=function(u$W){throw new Error("BaseShape: must override it.")},u$j.generatePositionAndDirection=function(u$W,u$j,u$t,u$d){throw new Error("BaseShape: must override it.")},u$j._calculateProceduralBounds=function(u$W,u$j,u$t){this._getShapeBoundBox(u$W);var u$d=u$W.min,u$b=u$W.max;u$Oj.multiply(u$d,u$j,u$d),u$Oj.multiply(u$b,u$j,u$b);var u$E=new u$BW(new u$Oj,new u$Oj);this.randomDirection?(u$E.min=new u$Oj(-1,-1,-1),u$E.max=new u$Oj(1,1,1)):this._getSpeedBoundBox(u$E);var u$O=new u$BW(new u$Oj,new u$Oj),u$q=u$O.min,u$A=u$O.max;u$Oj.scale(u$E.min,u$t.y,u$q),u$Oj.scale(u$E.max,u$t.y,u$A),u$Oj.add(u$W.min,u$q,u$q),u$Oj.add(u$W.max,u$A,u$A),u$Oj.min(u$W.min,u$q,u$W.min),u$Oj.max(u$W.max,u$q,u$W.max);var u$c=new u$BW(new u$Oj,new u$Oj),u$R=u$c.min,u$m=u$c.max;u$Oj.scale(u$E.min,u$t.x,u$R),u$Oj.scale(u$E.max,u$t.x,u$m),u$Oj.min(u$c.min,u$m,u$q),u$Oj.max(u$c.min,u$m,u$A),u$Oj.min(u$W.min,u$q,u$W.min),u$Oj.max(u$W.max,u$q,u$W.max)},u$j.cloneTo=function(u$W){u$W.enable=this.enable},u$j.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$W}()),u$w=function(){function u$E(){}return u$T(u$E,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),u$E._randomPointUnitArcCircle=function(u$W,u$j,u$t){var u$d=u$j.elements,u$b=NaN;u$b=u$t?u$t.getFloat()*u$W:Math.random()*u$W,u$d[0]=Math.cos(u$b),u$d[1]=Math.sin(u$b)},u$E._randomPointInsideUnitArcCircle=function(u$W,u$j,u$t){var u$d=u$j.elements;u$E._randomPointUnitArcCircle(u$W,u$j,u$t);var u$b=NaN;u$b=u$t?Math.pow(u$t.getFloat(),.5):Math.pow(Math.random(),.5),u$d[0]=u$d[0]*u$b,u$d[1]=u$d[1]*u$b},u$E._randomPointUnitCircle=function(u$W,u$j){var u$t=u$W.elements,u$d=NaN;u$d=u$j?u$j.getFloat()*Math.PI*2:Math.random()*Math.PI*2,u$t[0]=Math.cos(u$d),u$t[1]=Math.sin(u$d)},u$E._randomPointInsideUnitCircle=function(u$W,u$j){var u$t=u$W.elements;u$E._randomPointUnitCircle(u$W);var u$d=NaN;u$d=u$j?Math.pow(u$j.getFloat(),.5):Math.pow(Math.random(),.5),u$t[0]=u$t[0]*u$d,u$t[1]=u$t[1]*u$d},u$E._randomPointUnitSphere=function(u$W,u$j){var u$t=u$W.elements,u$d=NaN,u$b=NaN;u$b=u$j?(u$d=u$t[2]=2*u$j.getFloat()-1,u$j.getFloat()*Math.PI*2):(u$d=u$t[2]=2*Math.random()-1,Math.random()*Math.PI*2);var u$E=Math.sqrt(1-u$d*u$d);u$t[0]=u$E*Math.cos(u$b),u$t[1]=u$E*Math.sin(u$b)},u$E._randomPointInsideUnitSphere=function(u$W,u$j){var u$t=u$W.elements;u$E._randomPointUnitSphere(u$W);var u$d=NaN;u$d=u$j?Math.pow(u$j.getFloat(),1/3):Math.pow(Math.random(),1/3),u$t[0]=u$t[0]*u$d,u$t[1]=u$t[1]*u$d,u$t[2]=u$t[2]*u$d},u$E._randomPointInsideHalfUnitBox=function(u$W,u$j){var u$t=u$W.elements;u$j?(u$t[0]=u$j.getFloat()-.5,u$t[1]=u$j.getFloat()-.5,u$t[2]=u$j.getFloat()-.5):(u$t[0]=Math.random()-.5,u$t[1]=Math.random()-.5,u$t[2]=Math.random()-.5)},u$E}(),u$U=(function(){function u$W(u$W){this._size=null,this.enbale=!1,this._size=u$W}u$T(u$W,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j.cloneTo=function(u$W){var u$j=u$W;this._size.cloneTo(u$j._size),u$j.enbale=this.enbale},u$j.clone=function(){var u$W;switch(this._size.type){case 0:u$W=this._size.separateAxes?u$D.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):u$D.createByGradient(this._size.gradient.clone());break;case 1:u$W=this._size.separateAxes?u$D.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):u$D.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:u$W=this._size.separateAxes?u$D.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):u$D.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var u$j=new this.constructor(u$W);return u$j.enbale=this.enbale,u$j},u$$(0,u$j,"size",function(){return this._size})}(),function(){function u$d(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}u$T(u$d,"laya.d3.core.particleShuriKen.module.StartFrame");var u$W=u$d.prototype;return u$X.imps(u$W,{"laya.d3.core.IClone":!0}),u$W.cloneTo=function(u$W){var u$j=u$W;u$j._type=this._type,u$j._constant=this._constant,u$j._constantMin=this._constantMin,u$j._constantMax=this._constantMax},u$W.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$W,"constant",function(){return this._constant}),u$$(0,u$W,"type",function(){return this._type}),u$$(0,u$W,"constantMin",function(){return this._constantMin}),u$$(0,u$W,"constantMax",function(){return this._constantMax}),u$d.createByConstant=function(u$W){var u$j=new u$d;return u$j._type=0,u$j._constant=u$W,u$j},u$d.createByRandomTwoConstant=function(u$W,u$j){var u$t=new u$d;return u$t._type=1,u$t._constantMin=u$W,u$t._constantMax=u$j,u$t},u$d}()),u$J=(function(){function u$W(u$W,u$j){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new u$Ej(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=u$W,this._startFrame=u$j}u$T(u$W,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j.cloneTo=function(u$W){var u$j=u$W;this.tiles.cloneTo(u$j.tiles),u$j.type=this.type,u$j.randomRow=this.randomRow,this._frame.cloneTo(u$j._frame),this._startFrame.cloneTo(u$j._startFrame),u$j.cycles=this.cycles,u$j.enableUVChannels=this.enableUVChannels,u$j.enable=this.enable},u$j.clone=function(){var u$W,u$j;switch(this._frame.type){case 0:u$W=u$y.createByConstant(this._frame.constant);break;case 1:u$W=u$y.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:u$W=u$y.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:u$W=u$y.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:u$j=u$U.createByConstant(this._startFrame.constant);break;case 1:u$j=u$U.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var u$t=new this.constructor(u$W,u$j);return this.tiles.cloneTo(u$t.tiles),u$t.type=this.type,u$t.randomRow=this.randomRow,u$t.cycles=this.cycles,u$t.enableUVChannels=this.enableUVChannels,u$t.enable=this.enable,u$t},u$$(0,u$j,"frame",function(){return this._frame}),u$$(0,u$j,"startFrame",function(){return this._startFrame})}(),function(){function u$W(u$W){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=u$W}u$T(u$W,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j.cloneTo=function(u$W){var u$j=u$W;this._velocity.cloneTo(u$j._velocity),u$j.enbale=this.enbale,u$j.space=this.space},u$j.clone=function(){var u$W;switch(this._velocity.type){case 0:u$W=u$s.createByConstant(this._velocity.constant.clone());break;case 1:u$W=u$s.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:u$W=u$s.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:u$W=u$s.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var u$j=new this.constructor(u$W);return u$j.enbale=this.enbale,u$j.space=this.space,u$j},u$$(0,u$j,"velocity",function(){return this._velocity})}(),function(){function u$W(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new u$Qj,this._vb=u$Yj.create(u$W._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=u$sj.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=u$uj.nameKey.getID("LINE"),this._shaderCompile=u$zj._preCompileShader[this._sharderNameID]}u$T(u$W,"laya.d3.core.PhasorSpriter3D");var u$j=u$W.prototype;return u$j.line=function(u$W,u$j,u$t,u$d){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(u$W.x,u$W.y,u$W.z,u$j.x,u$j.y,u$j.z,u$j.w),this.addVertex(u$t.x,u$t.y,u$t.z,u$d.x,u$d.y,u$d.z,u$d.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},u$j.circle=function(u$W,u$j,u$t,u$d,u$b,u$E){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*u$j,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/u$j,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*u$W,Math.cos(this._tempNumver0)*u$W,0,u$t,u$d,u$b,u$E),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},u$j.plane=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=u$d/2,this._tempNumver1=u$b/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(u$W-this._tempNumver0,u$j+this._tempNumver1,u$t,u$E,u$O,u$q,u$A),this.addVertex(u$W+this._tempNumver0,u$j+this._tempNumver1,u$t,u$E,u$O,u$q,u$A),this.addVertex(u$W-this._tempNumver0,u$j-this._tempNumver1,u$t,u$E,u$O,u$q,u$A),this.addVertex(u$W+this._tempNumver0,u$j-this._tempNumver1,u$t,u$E,u$O,u$q,u$A),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},u$j.box=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=u$d/2,this._tempNumver1=u$b/2,this._tempNumver2=u$E/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(u$W-this._tempNumver0,u$j+this._tempNumver1,u$t+this._tempNumver2,u$O,u$q,u$A,u$c),this.addVertex(u$W+this._tempNumver0,u$j+this._tempNumver1,u$t+this._tempNumver2,u$O,u$q,u$A,u$c),this.addVertex(u$W-this._tempNumver0,u$j-this._tempNumver1,u$t+this._tempNumver2,u$O,u$q,u$A,u$c),this.addVertex(u$W+this._tempNumver0,u$j-this._tempNumver1,u$t+this._tempNumver2,u$O,u$q,u$A,u$c),this.addVertex(u$W+this._tempNumver0,u$j+this._tempNumver1,u$t-this._tempNumver2,u$O,u$q,u$A,u$c),this.addVertex(u$W-this._tempNumver0,u$j+this._tempNumver1,u$t-this._tempNumver2,u$O,u$q,u$A,u$c),this.addVertex(u$W+this._tempNumver0,u$j-this._tempNumver1,u$t-this._tempNumver2,u$O,u$q,u$A,u$c),this.addVertex(u$W-this._tempNumver0,u$j-this._tempNumver1,u$t-this._tempNumver2,u$O,u$q,u$A,u$c),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},u$j.cone=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*u$t+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*u$t>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/u$t,this.addVertexIndex(0,u$j,0,u$d,u$b,u$E,u$O,this._tempUint0),this.addVertexIndex(0,0,0,u$d,u$b,u$E,u$O,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<u$t;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(u$W*this._tempNumver2,0,u$W*this._tempNumver3,u$d,u$b,u$E,u$O,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==u$t-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(u$W*this._tempNumver2,0,u$W*this._tempNumver3,u$d,u$b,u$E,u$O,this._tempUint0+(this._tempInt0+u$t)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==u$t-1?this.addIndexes(this._tempUint1+u$t+2):this.addIndexes(this._tempUint1+this._tempInt0+u$t+1),this.addIndexes(this._tempUint1+this._tempInt0+u$t),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},u$j.boundingBoxLine=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(u$W,u$b,u$E,u$O,u$q,u$A,u$c),this.addVertex(u$d,u$b,u$E,u$O,u$q,u$A,u$c),this.addVertex(u$W,u$j,u$E,u$O,u$q,u$A,u$c),this.addVertex(u$d,u$j,u$E,u$O,u$q,u$A,u$c),this.addVertex(u$d,u$b,u$t,u$O,u$q,u$A,u$c),this.addVertex(u$W,u$b,u$t,u$O,u$q,u$A,u$c),this.addVertex(u$d,u$j,u$t,u$O,u$q,u$A,u$c),this.addVertex(u$W,u$j,u$t,u$O,u$q,u$A,u$c),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},u$j.addVertex=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=u$W,this._vbData[this._posInVBData+1]=u$j,this._vbData[this._posInVBData+2]=u$t,this._vbData[this._posInVBData+3]=u$d,this._vbData[this._posInVBData+4]=u$b,this._vbData[this._posInVBData+5]=u$E,this._vbData[this._posInVBData+6]=u$O,this._posInVBData+=this._floatSizePerVer,this},u$j.addVertexIndex=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){return this._hasBegun||this.addVertexIndexException(),this._vbData[u$q]=u$W,this._vbData[u$q+1]=u$j,this._vbData[u$q+2]=u$t,this._vbData[u$q+3]=u$d,this._vbData[u$q+4]=u$b,this._vbData[u$q+5]=u$E,this._vbData[u$q+6]=u$O,(u$q+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=u$q),this},u$j.addIndexes=function(u$W){var u$j=arguments;this._hasBegun||this.addVertexIndexException();for(var u$t=0;u$t<u$j.length;u$t++)this._ibData[this._posInIBData]=u$j[u$t],this._posInIBData++;return this},u$j.begin=function(u$W,u$j){return this._hasBegun&&this.beginException0(),1!==u$W&&4!==u$W&&this.beginException1(),this._primitiveType=u$W,this._camera=u$j,this._hasBegun=!0,this},u$j.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},u$j.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(u$W._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),u$z.drawCall++,u$G.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},u$j.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},u$j.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},u$j.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},u$j.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},u$j.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},u$j.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(28,[new u$OW(0,"vector3",0),new u$OW(12,"vector4",1)])}]),u$W}()),u$r=function(){function u$W(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++u$W._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new u$Qj}u$T(u$W,"laya.d3.core.render.RenderElement");var u$j=u$W.prototype;return u$j.getDynamicBatchBakedVertexs=function(u$W){for(var u$j=this._renderObj._getVertexBuffer(u$W),u$t=u$j.getData().slice(),u$d=u$j.vertexDeclaration,u$b=u$d.getVertexElementByUsage(0).offset/4,u$E=u$d.getVertexElementByUsage(3).offset/4,u$O=this._sprite3D.transform,u$q=u$O.worldMatrix,u$A=u$O.rotation,u$c=u$d.vertexStride/4,u$R=0,u$m=u$t.length;u$R<u$m;u$R+=u$c){var u$Q=u$R+u$b,u$T=u$R+u$E;u$Kj.transformVector3ArrayToVector3ArrayCoordinate(u$t,u$Q,u$q,u$t,u$Q),u$Kj.transformVector3ArrayByQuat(u$t,u$T,u$A,u$t,u$T)}return u$t},u$j.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},u$j._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},u$$(0,u$j,"id",function(){return this._id}),u$$(0,u$j,"renderObj",function(){return this._renderObj},function(u$W){this._renderObj!==u$W&&(this._renderObj=u$W)}),u$W._uniqueIDCounter=0,u$W}(),u$P=function(){function u$j(u$W){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++u$j._uniqueIDCounter,this._needSort=!1,this._scene=u$W,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}u$T(u$j,"laya.d3.core.render.RenderQueue");var u$W=u$j.prototype;return u$W._sortOpaqueFunc=function(u$W,u$j){if(u$W._render&&u$j._render){var u$t=u$W._material.renderQueue-u$j._material.renderQueue;return 0==u$t?u$W._render._distanceForSort-u$j._render._distanceForSort:u$t}return 0},u$W._sortAlphaFunc=function(u$W,u$j){if(u$W._render&&u$j._render){var u$t=u$W._material.renderQueue-u$j._material.renderQueue;return 0==u$t?u$j._render._distanceForSort-u$W._render._distanceForSort:u$t}return 0},u$W._begainRenderElement=function(u$W,u$j,u$t){return!!u$j._beforeRender(u$W)},u$W._sortAlpha=function(u$W){u$j._cameraPosition=u$W,this._finalElements.sort(this._sortAlphaFunc)},u$W._sortOpaque=function(u$W){u$j._cameraPosition=u$W,this._finalElements.sort(this._sortOpaqueFunc)},u$W._preRender=function(u$W){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},u$W._render=function(u$W,u$j){for(var u$t,u$d,u$b,u$E,u$O,u$q,u$A=u$z.loopCount,u$c=this._scene,u$R=u$W.camera,u$m=(u$R.id,!1),u$Q=0,u$T=this._finalElements.length;u$Q<u$T;u$Q++){var u$$,u$e,u$K,u$o=this._finalElements[u$Q];if(null!=u$o._onPreRenderFunction&&u$o._onPreRenderFunction.call(u$o._sprite3D,u$W),0===u$o._type){if(u$W.owner=u$K=u$o._sprite3D,u$W.renderElement=u$o,u$K._preRenderUpdateComponents(u$W),u$$=u$o.renderObj,u$e=u$o._material,this._begainRenderElement(u$W,u$$,u$e)){if(u$t=u$$._getVertexBuffers(),!(u$b=(u$d=u$$._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[u$d.id]){this._errorRecord[u$d.id]=1;var u$S="vertexBuffer:"+("("+u$d._destroyed+","+u$d._released+","+u$d._referenceCount+","+u$d._buffer+")")+", material:"+(u$e?u$e.__className+"("+u$e._destroyed+","+u$e._released+")":"null")+", owner:"+(u$K?u$K.__className+"("+u$K._destroyed+","+u$K._activeInHierarchy+","+u$K._displayedInStage+")":"null")+", renderObj:"+(u$$?u$$.__className+"("+u$$._destroyed+","+u$$._released+","+u$$._referenceCount+")":"")+", parent:, url:"+(u$K?u$K.url:"")+", disposeStack:"+u$d.disposeStack;u$X.recordError("报错：unknown vertexDeclaration  "+u$S)}continue}if(u$m=(u$E=u$W._shader=u$e._getShader(u$c._shaderDefineValue,u$b.shaderDefineValue,u$K._shaderDefineValue)).bind()||u$A!==u$E._uploadLoopCount,u$t){if(u$E._uploadVertexBuffer!==u$t||u$m){for(var u$M=0;u$M<u$t.length;u$M++){var u$Z=u$t[u$M];u$E.uploadAttributesX(u$Z.vertexDeclaration.shaderValues.data,u$Z)}u$E._uploadVertexBuffer=u$t}}else(u$E._uploadVertexBuffer!==u$d||u$m)&&(u$E.uploadAttributes(u$b.shaderValues.data,null),u$E._uploadVertexBuffer=u$d);(u$E._uploadScene!==u$c||u$m)&&(u$E.uploadSceneUniforms(u$c._shaderValues.data),u$E._uploadScene=u$c),(u$R!==u$E._uploadCamera||u$E._uploadSprite3D!==u$K||u$m)&&(u$E.uploadSpriteUniforms(u$K._shaderValues.data),u$E._uploadSprite3D=u$K),(u$R!==u$E._uploadCamera||u$m)&&(u$E.uploadCameraUniforms(u$R._shaderValues.data),u$E._uploadCamera=u$R),(u$E._uploadMaterial!==u$e||u$m)&&(u$e._upload(),u$E._uploadMaterial=u$e),u$O!==u$e?(u$e._setRenderStateBlendDepth(),u$e._setRenderStateFrontFace(u$j,u$K.transform),u$O=u$e,u$q=u$K):u$q!==u$K&&(u$e._setRenderStateFrontFace(u$j,u$K.transform),u$q=u$K),u$$._render(u$W),u$E._uploadLoopCount=u$A}u$K._postRenderUpdateComponents(u$W)}else if(2===u$o._type){u$o.renderObj;u$W.owner=u$K=u$o._sprite3D,u$W.renderElement=u$o,u$W._batchIndexStart=u$o._tempBatchIndexStart,u$W._batchIndexEnd=u$o._tempBatchIndexEnd,u$$=u$o.renderObj,u$e=u$o._material,this._begainRenderElement(u$W,u$$,u$e)&&(u$b=(u$d=u$$._getVertexBuffer(0)).vertexDeclaration,u$m=(u$E=u$W._shader=u$e._getShader(u$c._shaderDefineValue,u$b.shaderDefineValue,u$K._shaderDefineValue)).bind()||u$A!==u$E._uploadLoopCount,(u$E._uploadVertexBuffer!==u$d||u$m)&&(u$E.uploadAttributes(u$b.shaderValues.data,null),u$E._uploadVertexBuffer=u$d),(u$E._uploadScene!==u$c||u$m)&&(u$E.uploadSceneUniforms(u$c._shaderValues.data),u$E._uploadScene=u$c),(u$R!==u$E._uploadCamera||u$E._uploadSprite3D!==u$K||u$m)&&(u$E.uploadSpriteUniforms(u$K._shaderValues.data),u$E._uploadSprite3D=u$K),(u$R!==u$E._uploadCamera||u$m)&&(u$E.uploadCameraUniforms(u$R._shaderValues.data),u$E._uploadCamera=u$R),(u$E._uploadMaterial!==u$e||u$m)&&(u$e._upload(),u$E._uploadMaterial=u$e),u$O!==u$e?(u$e._setRenderStateBlendDepth(),u$e._setRenderStateFrontFace(u$j,u$K.transform),u$O=u$e,u$q=u$K):u$q!==u$K&&(u$e._setRenderStateFrontFace(u$j,u$K.transform),u$q=u$K),u$$._render(u$W),u$E._uploadLoopCount=u$A)}}},u$W._renderShadow=function(u$W,u$j){for(var u$t,u$d,u$b,u$E,u$O,u$q=u$z.loopCount,u$A=this._scene,u$c=u$W.camera,u$R=!1,u$m=0,u$Q=this._finalElements.length;u$m<u$Q;u$m++){var u$T,u$$,u$e,u$K=this._finalElements[u$m];0===u$K._type&&(u$W.owner=u$e=u$K._sprite3D,u$j||u$e._projectionViewWorldUpdateCamera===u$c&&u$e._projectionViewWorldUpdateLoopCount===u$z.loopCount||(u$e._render._renderUpdate(u$W._projectionViewMatrix),u$e._projectionViewWorldUpdateLoopCount=u$z.loopCount,u$e._projectionViewWorldUpdateCamera=u$c),u$W.renderElement=u$K,u$e._preRenderUpdateComponents(u$W),u$T=u$K.renderObj,u$$=u$K._material,this._begainRenderElement(u$W,u$T,null)&&(u$d=(u$t=u$T._getVertexBuffer(0)).vertexDeclaration,u$R=(u$b=u$W._shader=u$$._getShader(u$A._shaderDefineValue,u$d.shaderDefineValue,u$e._shaderDefineValue)).bind()||u$q!==u$b._uploadLoopCount,(u$b._uploadVertexBuffer!==u$t||u$R)&&(u$b.uploadAttributes(u$d.shaderValues.data,null),u$b._uploadVertexBuffer=u$t),(u$c!==u$b._uploadCamera||u$b._uploadSprite3D!==u$e||u$R)&&(u$b.uploadSpriteUniforms(u$e._shaderValues.data),u$b._uploadSprite3D=u$e),(u$c!==u$b._uploadCamera||u$R)&&(u$b.uploadCameraUniforms(u$c._shaderValues.data),u$b._uploadCamera=u$c),(u$b._uploadMaterial!==u$$||u$R)&&(u$$._upload(),u$b._uploadMaterial=u$$),u$b._uploadRenderElement,u$E!==u$$?(u$$._setRenderStateFrontFace(!1,u$e.transform),u$E=u$$,u$O=u$e):u$O!==u$e&&(u$$._setRenderStateFrontFace(!1,u$e.transform),u$O=u$e),u$T._render(u$W),u$b._uploadLoopCount=u$q),u$e._postRenderUpdateComponents(u$W))}},u$W._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},u$W._addRenderElement=function(u$W){this._renderElements.push(u$W),this._needSort=!0},u$W._addDynamicBatchElement=function(u$W){this._dynamicBatchCombineRenderElements.push(u$W)},u$$(0,u$W,"id",function(){return this._id}),u$j._uniqueIDCounter=0,u$j._cameraPosition=null,u$j}(),u$i=function(){function u$W(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return u$T(u$W,"laya.d3.core.render.RenderState"),u$W.clientWidth=0,u$W.clientHeight=0,u$W}(),u$B=function(){function u$O(u$W,u$j){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new u$kW(new u$Oj,0),this._corners=[new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj],this._boundingBoxCenter=new u$Oj,this._children=u$d(8),this._objects=[],this._tempBoundBoxCorners=[new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj],this._scene=u$W,this._currentDepth=u$j}u$T(u$O,"laya.d3.core.scene.OctreeNode");var u$W=u$O.prototype;return u$X.imps(u$W,{"laya.d3.core.scene.ITreeNode":!0}),u$W.init=function(u$W,u$j){var u$t=new u$Oj,u$d=new u$Oj;u$Oj.scale(u$j,-.5,u$t),u$Oj.scale(u$j,.5,u$d),u$Oj.add(u$t,u$W,u$t),u$Oj.add(u$d,u$W,u$d),this.exactBox=new u$BW(u$t,u$d),this.relaxBox=new u$BW(u$t,u$d)},u$W.addTreeNode=function(u$W){1===Collision.boxContainsBox(this._relaxBox,u$W.boundingBox)?this.addNodeDown(u$W,0):this.addObject(u$W)},u$W.addChild=function(u$W){var u$j=this._children[u$W];if(null==u$j){u$j=new u$O(this._scene,this._currentDepth+1),(this._children[u$W]=u$j)._parent=this,u$Oj.subtract(this._exactBox.max,this._exactBox.min,u$O.tempSize),u$Oj.multiply(u$O.tempSize,u$O._octreeSplit[u$W],u$O.tempCenter),u$Oj.add(this._exactBox.min,u$O.tempCenter,u$O.tempCenter),u$Oj.scale(u$O.tempSize,.25,u$O.tempSize);var u$t=new u$Oj,u$d=new u$Oj;u$Oj.subtract(u$O.tempCenter,u$O.tempSize,u$t),u$Oj.add(u$O.tempCenter,u$O.tempSize,u$d),u$j.exactBox=new u$BW(u$t,u$d),u$Oj.scale(u$O.tempSize,u$O.relax,u$O.tempSize);var u$b=new u$Oj,u$E=new u$Oj;u$Oj.subtract(u$O.tempCenter,u$O.tempSize,u$b),u$Oj.add(u$O.tempCenter,u$O.tempSize,u$E),u$j.relaxBox=new u$BW(u$b,u$E)}return u$j},u$W.addObject=function(u$W){(u$W._treeNode=this)._objects.push(u$W)},u$W.removeObject=function(u$W){if(u$W._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var u$j=this._objects.indexOf(u$W);return-1!==u$j&&(this._objects.splice(u$j,1),!0)},u$W.clearObject=function(){this._objects.length=0},u$W.addNodeUp=function(u$W,u$j){this._parent&&1!==Collision.boxContainsBox(this._exactBox,u$W.boundingBox)?this._parent.addNodeUp(u$W,u$j-1):this.addNodeDown(u$W,u$j)},u$W.addNodeDown=function(u$W,u$j){if(u$j<this._scene.treeLevel){var u$t=this.inChildIndex(u$W.boundingBoxCenter),u$d=this.addChild(u$t);1===Collision.boxContainsBox(u$d._relaxBox,u$W.boundingBox)?u$d.addNodeDown(u$W,++u$j):this.addObject(u$W)}else this.addObject(u$W)},u$W.inChildIndex=function(u$W){return 4*(u$W.z<this._boundingBoxCenter.z?0:1)+2*(u$W.y<this._boundingBoxCenter.y?0:1)+(u$W.x<this._boundingBoxCenter.x?0:1)},u$W.updateObject=function(u$W){1===Collision.boxContainsBox(this._relaxBox,u$W.boundingBox)?(this.removeObject(u$W),u$W._treeNode=null,this.addNodeDown(u$W,this._currentDepth)):this._parent&&(this.removeObject(u$W),u$W._treeNode=null,this._parent.addNodeUp(u$W,this._currentDepth-1))},u$W.cullingObjects=function(u$W,u$j,u$t,u$d,u$b){var u$E,u$O=0,u$q=0,u$A=0,u$c=this._scene._dynamicBatchManager;for(u$O=0,u$E=this._objects.length;u$O<u$E;u$O++){var u$R=this._objects[u$O];if(u$v.isVisible(u$R._owner.layer.mask)&&u$R.enable){if(u$j&&(u$z.treeSpriteCollision+=1,0===u$W.containsBoundSphere(u$R.boundingSphere)))continue;u$R._renderUpdate(u$b),u$R._distanceForSort=u$Oj.distance(u$R.boundingSphere.center,u$d)+u$R.sortingFudge;var u$m=u$R._renderElements;for(u$q=0,u$A=u$m.length;u$q<u$A;u$q++){var u$Q=u$m[u$q],u$T=u$Q._staticBatch;if(u$T&&u$T._material===u$Q._material)u$T._addBatchRenderElement(u$Q);else{var u$$=u$Q.renderObj;u$$.triangleCount<10&&1===u$$._vertexBufferCount&&u$$._getIndexBuffer()&&u$Q._material.renderQueue<2&&u$Q._canDynamicBatch&&!u$R._owner.isStatic?u$c._addPrepareRenderElement(u$Q):this._scene.getRenderQueue(u$Q._material.renderQueue)._addRenderElement(u$Q)}}}}for(u$O=0;u$O<8;u$O++){var u$e=this._children[u$O];if(null!=u$e){var u$K=u$j;if(u$j){var u$o=u$W.containsBoundBox(u$e._relaxBox);if(u$z.treeNodeCollision+=1,0===u$o)continue;u$K=2===u$o}u$e.cullingObjects(u$W,u$K,u$t,u$d,u$b)}}},u$W.cullingShadowObjects=function(u$W,u$j,u$t,u$d,u$b){var u$E,u$O=0,u$q=0,u$A=0;this._scene._dynamicBatchManager;for(u$O=0,u$E=this._objects.length;u$O<u$E;u$O++){var u$c=this._objects[u$O];if(u$c.castShadow&&u$v.isVisible(u$c._owner.layer.mask)&&u$c.enable){if(u$t&&0===u$W[0].containsBoundSphere(u$c.boundingSphere))continue;for(var u$R=1,u$m=u$W.length;u$R<u$m;u$R++){var u$Q=u$j[u$R-1];if(0!==u$W[u$R].containsBoundSphere(u$c.boundingSphere)){var u$T=u$c._renderElements;for(u$q=0,u$A=u$T.length;u$q<u$A;u$q++)u$Q._addRenderElement(u$T[u$q])}}}}for(u$O=0;u$O<8;u$O++){var u$$=this._children[u$O];if(null!=u$$){var u$e=u$t;if(u$t){var u$K=u$W[0].containsBoundBox(u$$._relaxBox);if(0===u$K)continue;u$e=2===u$K}u$$.cullingShadowObjects(u$W,u$j,u$e,u$d,u$b)}}},u$W.cullingShadowObjectsOnePSSM=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O,u$q=u$j[0],u$A=0,u$c=0,u$R=0;for(u$A=0,u$O=this._objects.length;u$A<u$O;u$A++){var u$m=this._objects[u$A];if(u$m.castShadow&&u$v.isVisible(u$m._owner.layer.mask)&&u$m.enable){if(u$d&&0===u$W.containsBoundSphere(u$m.boundingSphere))continue;u$m._renderUpdate(u$t);var u$Q=u$m._renderElements;for(u$c=0,u$R=u$Q.length;u$c<u$R;u$c++)u$q._addRenderElement(u$Q[u$c])}}for(u$A=0;u$A<8;u$A++){var u$T=this._children[u$A];if(null!=u$T){var u$$=u$d;if(u$d){var u$e=u$W.containsBoundBox(u$T._relaxBox);if(0===u$e)continue;u$$=2===u$e}u$T.cullingShadowObjectsOnePSSM(u$W,u$j,u$t,u$$,u$b,u$E)}}},u$W.renderBoudingBox=function(u$W){this._renderBoudingBox(u$W);for(var u$j=0;u$j<8;++u$j){var u$t=this._children[u$j];u$t&&u$t.renderBoudingBox(u$W)}},u$W.buildAllChild=function(u$W){if(u$W<this._scene.treeLevel)for(var u$j=0;u$j<8;u$j++){this.addChild(u$j).buildAllChild(u$W+1)}},u$W._renderBoudingBox=function(u$W){},u$$(0,u$W,"exactBox",function(){return this._exactBox},function(u$W){this._exactBox=u$W,u$Oj.add(u$W.min,u$W.max,this._boundingBoxCenter),u$Oj.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),u$$(0,u$W,"relaxBox",function(){return this._relaxBox},function(u$W){(this._relaxBox=u$W).getCorners(this._corners),u$kW.createfromPoints(this._corners,this._boundingSphere)}),u$O.debugMode=!1,u$O.relax=1.15,u$O.CHILDNUM=8,u$m(u$O,["tempVector0",function(){return this.tempVector0=new u$Oj},"tempSize",function(){return this.tempSize=new u$Oj},"tempCenter",function(){return this.tempCenter=new u$Oj},"_octreeSplit",function(){return this._octreeSplit=[new u$Oj(.25,.25,.25),new u$Oj(.75,.25,.25),new u$Oj(.25,.75,.25),new u$Oj(.75,.75,.25),new u$Oj(.25,.25,.75),new u$Oj(.75,.25,.75),new u$Oj(.25,.75,.75),new u$Oj(.75,.75,.75)]}]),u$O}(),u$n=(function(){function u$W(){}u$T(u$W,"laya.d3.core.scene.SceneManager")}(),function(){function u$W(u$W,u$j,u$t,u$d){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===u$W&&(u$W=1),void 0===u$j&&(u$j=1),void 0===u$t&&(u$t=1),void 0===u$d&&(u$d=1),this._r=u$W,this._g=u$j,this._b=u$t,this._a=u$d}return u$T(u$W,"laya.d3.core.trail.module.Color",null,"Color$1"),u$W.prototype.cloneTo=function(u$W){u$W._r=this._r,u$W._g=this._g,u$W._b=this._b,u$W._a=this._a},u$m(u$W,["RED",function(){return this.RED=new u$W(1,0,0,1)},"GREEN",function(){return this.GREEN=new u$W(0,1,0,1)},"BLUE",function(){return this.BLUE=new u$W(0,0,1,1)},"CYAN",function(){return this.CYAN=new u$W(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new u$W(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new u$W(1,0,1,1)},"GRAY",function(){return this.GRAY=new u$W(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new u$W(1,1,1,1)},"BLACK",function(){return this.BLACK=new u$W(0,0,0,1)}]),u$W}()),u$k=(function(){function u$W(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}u$T(u$W,"laya.d3.core.trail.module.Gradient");var u$j=u$W.prototype;u$j.setKeys=function(u$W,u$j){var u$t,u$d;this._colorKeys=u$W;for(var u$b=this.index=0;u$b<u$W.length;u$b++){var u$E=(u$t=u$W[u$b]).color;this._colorKeyData[this.index++]=u$E._r,this._colorKeyData[this.index++]=u$E._g,this._colorKeyData[this.index++]=u$E._b,this._colorKeyData[this.index++]=u$t.time}this._alphaKeys=u$j;for(var u$O=this.index=0;u$O<u$j.length;u$O++)u$d=u$j[u$O],this._alphaKeyData[this.index++]=u$d.alpha,this._alphaKeyData[this.index++]=u$d.time},u$j.cloneTo=function(u$W){var u$j=0,u$t=0,u$d=this.colorKeys,u$b=[];for(u$j=0,u$t=u$d.length;u$j<u$t;u$j++){var u$E=new u$p;u$d[u$j].cloneTo(u$E),u$b.push(u$E)}var u$O=this.alphaKeys,u$q=[];for(u$j=0,u$t=u$O.length;u$j<u$t;u$j++){var u$A=new u$k;u$O[u$j].cloneTo(u$A),u$q.push(u$A)}u$W.setKeys(u$b,u$q)},u$$(0,u$j,"mode",function(){return this._mode},function(u$W){this._mode=u$W}),u$$(0,u$j,"colorKeys",function(){return this._colorKeys},function(u$W){this._colorKeys=u$W;for(var u$j=this.index=0;u$j<u$W.length;u$j++){var u$t=u$W[u$j],u$d=u$t.color;this._colorKeyData[this.index++]=u$d._r,this._colorKeyData[this.index++]=u$d._g,this._colorKeyData[this.index++]=u$d._b,this._colorKeyData[this.index++]=u$t.time}}),u$$(0,u$j,"alphaKeys",function(){return this._alphaKeys},function(u$W){this._alphaKeys=u$W;for(var u$j=this.index=0;u$j<u$W.length;u$j++){var u$t=u$W[u$j];this._alphaKeyData[this.index++]=u$t.alpha,this._alphaKeyData[this.index++]=u$t.time}})}(),function(){function u$W(u$W,u$j){this._alpha=NaN,this._time=NaN,void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),this._alpha=u$W,this._time=u$j}u$T(u$W,"laya.d3.core.trail.module.GradientAlphaKey");var u$j=u$W.prototype;return u$j.cloneTo=function(u$W){u$W.alpha=this.alpha,u$W.time=this.time},u$$(0,u$j,"alpha",function(){return this._alpha},function(u$W){this._alpha=u$W}),u$$(0,u$j,"time",function(){return this._time},function(u$W){this._time=u$W}),u$W}()),u$p=function(){function u$W(u$W,u$j){this._color=null,this._time=NaN,void 0===u$j&&(u$j=0),this._color=u$W||new u$n,this._time=u$j}u$T(u$W,"laya.d3.core.trail.module.GradientColorKey");var u$j=u$W.prototype;return u$j.cloneTo=function(u$W){this.color.cloneTo(u$W.color),u$W.time=this.time},u$$(0,u$j,"color",function(){return this._color},function(u$W){this._color=u$W}),u$$(0,u$j,"time",function(){return this._time},function(u$W){this._time=u$W}),u$W}(),u$F=(function(){function u$W(){}u$T(u$W,"laya.d3.core.trail.module.GradientMode"),u$W.Blend=0,u$W.Fixed=1}(),function(){function u$W(){}u$T(u$W,"laya.d3.core.trail.module.TextureMode"),u$W.Stretch=0,u$W.Tile=1}(),function(){function u$W(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}u$T(u$W,"laya.d3.core.trail.module.TrailKeyFrame"),u$W.prototype.cloneTo=function(u$W){u$W.time=this.time,u$W.inTangent=this.inTangent,u$W.outTangent=this.outTangent,u$W.value=this.value}}(),function(){function u$j(u$W){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new u$Oj,this._curPosition=new u$Oj,this._delVector3=new u$Oj,this._lastFixedVertexPosition=new u$Oj,this._pointAtoBVector3=new u$Oj,this._pointA=new u$Oj,this._pointB=new u$Oj,this._owner=u$W,this._id=u$j.renderElementCount++,0==this._id?u$W._owner.transform.position.cloneTo(this._lastPosition):u$W._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new u$Yj(u$F.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new u$Yj(u$F.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}u$T(u$j,"laya.d3.core.trail.TrailRenderElement");var u$W=u$j.prototype;u$X.imps(u$W,{"laya.d3.core.render.IRenderable":!0}),u$W._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},u$W._addTrailByFirstPosition=function(u$W,u$j){u$Oj.subtract(u$j,u$W,this._delVector3),u$Oj.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),u$Oj.normalize(this._pointAtoBVector3,this._pointAtoBVector3),u$Oj.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(u$W),u$W.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},u$W._addTrailByNextPosition=function(u$W){u$Oj.subtract(u$W,this._lastFixedVertexPosition,this._delVector3),u$Oj.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),u$Oj.normalize(this._pointAtoBVector3,this._pointAtoBVector3),u$Oj.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=u$Oj.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=u$pW.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(u$W),u$W.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(u$W),this._virtualVerticesCount=2)},u$W._updateVerticesByPosition=function(u$W){this._pointe=u$W.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},u$W._updateVertexBuffer2=function(){var u$W,u$j=0,u$t=0,u$d=0;for(u$d=0,u$W=(this._verticesCount+this._virtualVerticesCount)/2;u$d<u$W;u$d++)u$t=0==this._owner.textureMode?(this._VerticesToTailLength[u$d]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[u$d],this._vertices2[u$j++]=1-u$t,this._vertices2[u$j++]=1-u$t;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},u$W._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},u$W._updateDisappear=function(){var u$W,u$j=0;for(u$j=this._curDisappearIndex,u$W=(this._verticesCount+this._virtualVerticesCount)/2;u$j<u$W;u$j++)this._owner._curtime-this._everyGroupVertexBirthTime[u$j]>=this._owner.time+u$pW.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},u$W._beforeRender=function(u$W){return this._camera=u$W.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),u$Oj.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},u$W._render=function(u$W){this._isDead||(u$G.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),u$z.drawCall++,u$z.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},u$W._getVertexBuffer=function(u$W){return void 0===u$W&&(u$W=0),0===u$W?this._vertexBuffer1:1===u$W?this._vertexBuffer2:null},u$W._getVertexBuffers=function(){return this._vertexBuffers},u$W._getIndexBuffer=function(){return null},u$W.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},u$W._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},u$$(0,u$W,"_vertexBufferCount",function(){return this._vertexBuffers.length}),u$$(0,u$W,"triangleCount",function(){return 0}),u$j.renderElementCount=0}(),function(){function u$W(){}u$T(u$W,"laya.d3.core.trail.VertexTrail");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration1}),u$$(1,u$W,"vertexDeclaration1",function(){return u$W._vertexDeclaration1}),u$$(1,u$W,"vertexDeclaration2",function(){return u$W._vertexDeclaration2}),u$m(u$W,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new u$EW(32,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",41),new u$OW(24,"single",33),new u$OW(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new u$EW(4,[new u$OW(0,"single",38)])}]),u$W}()),u$WW=function(){function u$Z(u$W){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=u$W}u$T(u$Z,"laya.d3.graphics.DynamicBatch");var u$W=u$Z.prototype;return u$X.imps(u$W,{"laya.d3.core.render.IRenderable":!0}),u$W._getVertexBuffer=function(u$W){return void 0===u$W&&(u$W=0),0===u$W?this._vertexBuffer:null},u$W._getIndexBuffer=function(){return this._indexBuffer},u$W._getCombineRenderElementFromPool=function(u$W,u$j,u$t){var u$d=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return u$d||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=u$d=new u$r,u$d._sprite3D=new u$Pj),u$d._sprite3D._render._renderUpdate(u$t),u$d},u$W._getRenderElement=function(u$W,u$j,u$t){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*u$Z.maxVertexCount),this._indexDatas=new Uint16Array(u$Z.maxIndexCount),this._vertexBuffer=u$Yj.create(this._vertexDeclaration,u$Z.maxVertexCount,35048),this._indexBuffer=u$sj.create("ushort",u$Z.maxIndexCount,35048));for(var u$d=this._merageElements.length=0,u$b=0,u$E=0,u$O=this._combineRenderElements.length;u$E<u$O;u$E++){var u$q=this._combineRenderElements[u$E],u$A=u$q.getDynamicBatchBakedVertexs(0),u$c=u$q.getBakedIndices(),u$R=u$q._sprite3D.transform._isFrontFaceInvert,u$m=u$d/(this._vertexDeclaration.vertexStride/4),u$Q=u$b,u$T=u$Q+u$c.length;u$q._tempBatchIndexStart=u$Q,u$q._tempBatchIndexEnd=u$T,this._indexDatas.set(u$c,u$b);var u$$=0;if(u$R)for(u$$=u$Q;u$$<u$T;u$$+=3){this._indexDatas[u$$]=u$m+this._indexDatas[u$$];var u$e=this._indexDatas[u$$+1],u$K=this._indexDatas[u$$+2];this._indexDatas[u$$+1]=u$m+u$K,this._indexDatas[u$$+2]=u$m+u$e}else for(u$$=u$Q;u$$<u$T;u$$+=3)this._indexDatas[u$$]=u$m+this._indexDatas[u$$],this._indexDatas[u$$+1]=u$m+this._indexDatas[u$$+1],this._indexDatas[u$$+2]=u$m+this._indexDatas[u$$+2];u$b+=u$c.length,this._vertexDatas.set(u$A,u$d),u$d+=u$A.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),u$E=this._combineRenderElementPoolIndex=0,u$O=this._materials.length;u$E<u$O;u$E++){var u$o=this._getCombineRenderElementFromPool(u$W,u$j,u$t);u$o._type=2,u$o._staticBatch=null;var u$S=(u$o.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[u$E]]._tempBatchIndexStart,u$M=u$E+1===this._materialToRenderElementsOffsets.length?u$b:this._combineRenderElements[this._materialToRenderElementsOffsets[u$E+1]]._tempBatchIndexStart;u$o._tempBatchIndexStart=u$S,u$o._tempBatchIndexEnd=u$M,u$o._material=this._materials[u$E],this._merageElements.push(u$o)}},u$W._addCombineRenderObjTest=function(u$W){var u$j=u$W.renderObj,u$t=this._currentCombineIndexCount+u$j._getIndexBuffer().indexCount,u$d=this._currentCombineVertexCount+u$j._getVertexBuffer().vertexCount;return!(u$Z.maxVertexCount<u$d||u$Z.maxIndexCount<u$t)},u$W._addCombineRenderObj=function(u$W){var u$j=u$W.renderObj;this._combineRenderElements.push(u$W),this._currentCombineIndexCount=this._currentCombineIndexCount+u$j._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+u$j._getVertexBuffer().vertexCount},u$W._addCombineMaterial=function(u$W){this._materials.push(u$W)},u$W._addMaterialToRenderElementOffset=function(u$W){this._materialToRenderElementsOffsets.push(u$W)},u$W._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},u$W._addToRenderQueue=function(u$W,u$j,u$t,u$d){this._getRenderElement(u$j,u$t,u$d);for(var u$b=0,u$E=this._materials.length;u$b<u$E;u$b++)u$W.getRenderQueue(this._materials[u$b].renderQueue)._addDynamicBatchElement(this._merageElements[u$b])},u$W._beforeRender=function(u$W){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},u$W._render=function(u$W){var u$j=u$W._batchIndexEnd-u$W._batchIndexStart;u$G.mainContext.drawElements(4,u$j,5123,2*u$W._batchIndexStart),u$z.drawCall++,u$z.trianglesFaces+=u$j/3},u$W._getVertexBuffers=function(){return null},u$$(0,u$W,"_vertexBufferCount",function(){return 1}),u$$(0,u$W,"triangleCount",function(){return this._indexBuffer.indexCount/3}),u$$(0,u$W,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),u$Z.maxVertexCount=2e4,u$Z.maxIndexCount=4e4,u$Z.maxCombineTriangleCount=10,u$Z}(),u$jW=function(){function u$Z(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}u$T(u$Z,"laya.d3.graphics.DynamicBatchManager");var u$W=u$Z.prototype;return u$W.getDynamicBatch=function(u$W,u$j){var u$t,u$d=u$W.id.toString()+u$j;return this._dynamicBatches[u$d]?u$t=this._dynamicBatches[u$d]:this._dynamicBatches[u$d]=u$t=new u$WW(u$W),u$t},u$W._garbageCollection=function(){for(var u$W in this._dynamicBatches)0===this._dynamicBatches[u$W].combineRenderElementsCount&&delete this._dynamicBatches[u$W]},u$W._addPrepareRenderElement=function(u$W){this._prepareDynamicBatchCombineElements.push(u$W)},u$W._finishCombineDynamicBatch=function(u$W){var u$j,u$t,u$d;this._prepareDynamicBatchCombineElements.sort(u$Z._sortPrepareDynamicBatch);for(var u$b,u$E,u$O,u$q,u$A,u$c=-1,u$R=!0,u$m=0,u$Q=-1,u$T=0,u$$=this._prepareDynamicBatchCombineElements.length;u$T<u$$;u$T++){var u$e=(u$E=this._prepareDynamicBatchCombineElements[u$T]).renderObj._getVertexBuffer(0).vertexDeclaration,u$K=u$t!==u$e;u$K&&(u$m=0,u$t=u$e);var u$o=u$m!==u$c;if(u$o&&(u$c=u$m),(u$K||u$o)&&(u$O=this.getDynamicBatch(u$e,u$m),u$j=null),u$R)if(u$O._addCombineRenderObjTest(u$E)){if(u$j!==(u$b=u$E._material))u$q&&(u$W.getRenderQueue(u$A._material.renderQueue)._addRenderElement(u$A),u$A=u$q=null,u$Q=-1),u$q=u$b,u$Q=u$O.combineRenderElementsCount,u$A=u$E,u$j=u$b;else if(u$q){var u$S=u$A.renderObj,u$M=u$E.renderObj;u$S._getVertexBuffer().vertexCount+u$M._getVertexBuffer().vertexCount>u$WW.maxVertexCount||u$S._getIndexBuffer().indexCount+u$M._getIndexBuffer().indexCount>u$WW.maxIndexCount?(u$W.getRenderQueue(u$A._material.renderQueue)._addRenderElement(u$A),u$q=u$b,u$Q=u$O.combineRenderElementsCount,u$A=u$E):(u$O._addCombineMaterial(u$q),u$O._addMaterialToRenderElementOffset(u$Q),u$O._addCombineRenderObj(u$A),u$A=u$q=null,u$Q=-1,u$O._addCombineRenderObj(u$E))}else u$O._addCombineRenderObj(u$E);u$R=!0}else u$q&&(u$W.getRenderQueue(u$A._material.renderQueue)._addRenderElement(u$A),u$A=u$q=null,u$Q=-1),u$m++,u$R=!1;else u$d=this._prepareDynamicBatchCombineElements[u$T-1],u$O._addMaterialToRenderElementOffset(u$O.combineRenderElementsCount),u$j=u$d._material,u$O._addCombineMaterial(u$j),u$O._addCombineRenderObj(u$d),u$R=!0,u$j!==(u$b=u$E._material)?(u$q=u$b,u$Q=u$O.combineRenderElementsCount,u$A=u$E):u$O._addCombineRenderObj(u$E),u$j=u$b}u$q&&(u$W.getRenderQueue(u$A._material.renderQueue)._addRenderElement(u$A),u$A=u$q=null,u$Q=-1),this._prepareDynamicBatchCombineElements.length=0},u$W._clearRenderElements=function(){for(var u$W in this._dynamicBatches)this._dynamicBatches[u$W]._clearRenderElements()},u$W._addToRenderQueue=function(u$W,u$j,u$t,u$d){for(var u$b in this._dynamicBatches){var u$E=this._dynamicBatches[u$b];0<u$E.combineRenderElementsCount&&u$E._addToRenderQueue(u$W,u$j,u$t,u$d)}},u$W.dispose=function(){this._dynamicBatches=null},u$Z._sortPrepareDynamicBatch=function(u$W,u$j){return u$W._mainSortID-u$j._mainSortID},u$Z}(),u$tW=function(){function u$W(){}return u$T(u$W,"laya.d3.graphics.FrustumCulling"),u$W.renderShadowObjectCulling=function(u$W,u$j,u$t,u$d,u$b){var u$E=0,u$O=0,u$q=0,u$A=0;for(u$E=0,u$q=u$t.length;u$E<u$q;u$E++){var u$c=u$t[u$E];u$c&&u$c._clearRenderElements()}var u$R,u$m,u$Q,u$T=u$W._cullingRenders;if(1<u$b){for(u$E=0,u$q=u$W._cullingRendersLength;u$E<u$q;u$E++)if((u$R=u$T[u$E]).castShadow&&u$v.isVisible(u$R._owner.layer.mask)&&u$R.enable)for(var u$$=1,u$e=u$j.length;u$$<u$e;u$$++)if(u$m=u$t[u$$-1],0!==u$j[u$$].containsBoundSphere(u$R.boundingSphere))for(u$O=0,u$A=(u$Q=u$R._renderElements).length;u$O<u$A;u$O++)u$m._addRenderElement(u$Q[u$O])}else for(u$E=0,u$q=u$W._cullingRendersLength;u$E<u$q;u$E++)if((u$R=u$T[u$E]).castShadow&&u$v.isVisible(u$R._owner.layer.mask)&&u$R.enable&&0!==u$j[0].containsBoundSphere(u$R.boundingSphere))for(u$R._renderUpdate(u$d),u$m=u$t[0],u$O=0,u$A=(u$Q=u$R._renderElements).length;u$O<u$A;u$O++)u$m._addRenderElement(u$Q[u$O])},u$W.renderShadowObjectCullingOctree=function(u$W,u$j,u$t,u$d,u$b){for(var u$E=0,u$O=u$t.length;u$E<u$O;u$E++){var u$q=u$t[u$E];u$q&&u$q._clearRenderElements()}1<u$b?u$W.treeRoot.cullingShadowObjects(u$j,u$t,!0,0,u$W):u$W.treeRoot.cullingShadowObjectsOnePSSM(u$j[0],u$t,u$d,!0,0,u$W)},u$W.renderObjectCulling=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=0,u$q=0,u$A=0,u$c=0,u$R=u$j._quenes,u$m=u$j._dynamicBatchManager,u$Q=u$j._cullingRenders;for(u$O=0,u$q=u$R.length;u$O<u$q;u$O++){var u$T=u$R[u$O];u$T&&u$T._clearRenderElements()}var u$$=u$dW._staticBatchManagers;for(u$O=0,u$q=u$$.length;u$O<u$q;u$O++)u$$[u$O]._clearRenderElements();u$m._clearRenderElements();var u$e=u$t.transform.position;for(u$O=0,u$q=u$j._cullingRendersLength;u$O<u$q;u$O++){var u$K=u$Q[u$O];if(u$v.isVisible(u$K._owner.layer.mask)&&u$K.enable&&0!==u$W.containsBoundSphere(u$K.boundingSphere)&&u$K._renderUpdate(u$E)){u$K._distanceForSort=u$Oj.distance(u$K.boundingSphere.center,u$e)+u$K.sortingFudge;var u$o=u$K._renderElements;for(u$A=0,u$c=u$o.length;u$A<u$c;u$A++){var u$S=u$o[u$A],u$M=u$S._staticBatch;if(u$M&&u$M._material===u$S._material)u$M._addBatchRenderElement(u$S);else{var u$Z=u$S.renderObj;u$Z.triangleCount<10&&1===u$Z._vertexBufferCount&&u$Z._getIndexBuffer()&&u$S._material.renderQueue<2&&u$S._canDynamicBatch&&!u$K._owner.isStatic?u$m._addPrepareRenderElement(u$S):u$j.getRenderQueue(u$S._material.renderQueue)._addRenderElement(u$S)}}}}for(u$O=0,u$q=u$$.length;u$O<u$q;u$O++)u$$[u$O]._addToRenderQueue(u$j,u$d,u$b,u$E);u$m._finishCombineDynamicBatch(u$j),u$m._addToRenderQueue(u$j,u$d,u$b,u$E)},u$W.renderObjectCullingOctree=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=0,u$q=0,u$A=u$j._quenes,u$c=u$j._dynamicBatchManager;for(u$O=0,u$q=u$A.length;u$O<u$q;u$O++){var u$R=u$A[u$O];u$R&&u$R._clearRenderElements()}var u$m=u$dW._staticBatchManagers;for(u$O=0,u$q=u$m.length;u$O<u$q;u$O++)u$m[u$O]._clearRenderElements();for(u$c._clearRenderElements(),u$j._cullingRenders.length=0,u$j.treeRoot.cullingObjects(u$W,!0,0,u$t.transform.position,u$E),u$O=0,u$q=u$m.length;u$O<u$q;u$O++)u$m[u$O]._addToRenderQueue(u$j,u$d,u$b,u$E);u$c._finishCombineDynamicBatch(u$j),u$c._addToRenderQueue(u$j,u$d,u$b,u$E)},u$W.renderObjectCullingNoBoundFrustum=function(u$W,u$j,u$t,u$d,u$b){var u$E=0,u$O=0,u$q=0,u$A=0,u$c=u$W._quenes,u$R=u$W._dynamicBatchManager,u$m=u$W._cullingRenders;for(u$E=0,u$O=u$c.length;u$E<u$O;u$E++){var u$Q=u$c[u$E];u$Q&&u$Q._clearRenderElements()}var u$T=u$dW._staticBatchManagers;for(u$E=0,u$O=u$T.length;u$E<u$O;u$E++)u$T[u$E]._clearRenderElements();u$R._clearRenderElements();var u$$=u$j.transform.position;for(u$E=0,u$O=u$W._cullingRendersLength;u$E<u$O;u$E++){var u$e=u$m[u$E];if(u$v.isVisible(u$e._owner.layer.mask)&&u$e.enable){u$e._renderUpdate(u$b),u$e._distanceForSort=u$Oj.distance(u$e.boundingSphere.center,u$$)+u$e.sortingFudge;var u$K=u$e._renderElements;for(u$q=0,u$A=u$K.length;u$q<u$A;u$q++){var u$o=u$K[u$q],u$S=u$o._staticBatch;if(u$S&&u$S._material===u$o._material)u$S._addBatchRenderElement(u$o);else{var u$M=u$o.renderObj;u$M.triangleCount<10&&1===u$M._vertexBufferCount&&u$M._getIndexBuffer()&&u$o._material.renderQueue<2&&u$o._canDynamicBatch&&!u$e._owner.isStatic?u$R._addPrepareRenderElement(u$o):u$W.getRenderQueue(u$o._material.renderQueue)._addRenderElement(u$o)}}}}for(u$E=0,u$O=u$T.length;u$E<u$O;u$E++)u$T[u$E]._addToRenderQueue(u$W,u$t,u$d,u$b);u$R._finishCombineDynamicBatch(u$W),u$R._addToRenderQueue(u$W,u$t,u$d,u$b)},u$W}(),u$dW=function(){function u$E(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}u$T(u$E,"laya.d3.graphics.StaticBatchManager");var u$W=u$E.prototype;return u$W._finishInit=function(){for(var u$W in this._staticBatches)this._staticBatches[u$W]._finishInit();this._initBatchRenderElements.length=0},u$W._initStaticBatchs=function(u$W){throw new Error("StaticBatchManager:must override this function.")},u$W._addInitBatchSprite=function(u$W){for(var u$j=u$W._render._renderElements,u$t=0,u$d=u$j.length;u$t<u$d;u$t++)this._initBatchRenderElements.push(u$j[u$t])},u$W._clearRenderElements=function(){for(var u$W in this._staticBatches)this._staticBatches[u$W]._clearRenderElements()},u$W._garbageCollection=function(u$W){var u$j=u$W._staticBatch,u$t=u$j._initBatchRenderElements,u$d=u$t.indexOf(u$W);u$t.splice(u$d,1),0===u$t.length&&(u$j.dispose(),delete this._staticBatches[u$j._key])},u$W._addToRenderQueue=function(u$W,u$j,u$t,u$d){for(var u$b in this._staticBatches){var u$E=this._staticBatches[u$b];0<u$E._batchRenderElements.length&&u$E._updateToRenderQueue(u$W,u$d)}},u$W.dispose=function(){this._staticBatches=null},u$E._addToStaticBatchQueue=function(u$W){u$W instanceof laya.d3.core.RenderableSprite3D&&u$W._addToInitStaticBatchManager();for(var u$j=0,u$t=u$W.numChildren;u$j<u$t;u$j++)u$E._addToStaticBatchQueue(u$W._childs[u$j])},u$E.combine=function(u$W,u$j){var u$t,u$d=0,u$b=0;if(u$j)for(u$d=0,u$b=u$j.length;u$d<u$b;u$d++){u$j[u$d]._addToInitStaticBatchManager()}else u$W&&u$E._addToStaticBatchQueue(u$W);for(u$d=0,u$b=u$E._staticBatchManagers.length;u$d<u$b;u$d++)(u$t=u$E._staticBatchManagers[u$d])._initStaticBatchs(u$W),u$t._finishInit()},u$E._staticBatchManagers=[],u$E}(),u$bW=function(){function u$W(u$W,u$j,u$t){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=u$W,this._manager=u$j,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=u$t}u$T(u$W,"laya.d3.graphics.StaticBatch");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),u$j._binarySearch=function(u$W){for(var u$j=0,u$t=this._batchRenderElements.length-1,u$d=0;u$j<=u$t;)u$d=Math.floor((u$j+u$t)/2),this._compareBatchRenderElement(this._batchRenderElements[u$d],u$W)?u$t=u$d-1:u$j=u$d+1;return u$j},u$j._compareBatchRenderElement=function(u$W,u$j){throw new Error("StaticBatch:must override this function.")},u$j._getVertexDecLightMap=function(u$W){return u$W===u$sW.vertexDeclaration?u$vW.vertexDeclaration:u$W===u$DW.vertexDeclaration?u$hW.vertexDeclaration:u$W===u$CW.vertexDeclaration?u$ZW.vertexDeclaration:u$W===u$gW.vertexDeclaration?null:u$W===u$eW.vertexDeclaration?u$KW.vertexDeclaration:u$W===u$HW.vertexDeclaration?u$aW.vertexDeclaration:u$W===u$GW.vertexDeclaration?u$lW.vertexDeclaration:u$W===u$YW.vertexDeclaration?u$yW.vertexDeclaration:u$W===u$DW.vertexDeclaration?u$hW.vertexDeclaration:u$W===u$LW.vertexDeclaration?u$XW.vertexDeclaration:u$W===u$gW.vertexDeclaration?null:u$W===u$eW.vertexDeclaration?u$KW.vertexDeclaration:u$W===u$IW.vertexDeclaration?u$uW.vertexDeclaration:u$W===u$GW.vertexDeclaration?u$lW.vertexDeclaration:u$W},u$j._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},u$j._addBatchRenderElement=function(u$W){this._batchRenderElements.splice(this._binarySearch(u$W),0,u$W)},u$j._updateToRenderQueue=function(u$W,u$j){this._combineRenderElementPoolIndex=0,this._getRenderElement(u$W.getRenderQueue(this._material.renderQueue)._renderElements,u$W,u$j)},u$j._getRenderElement=function(u$W,u$j,u$t){throw new Error("StaticBatch:must override this function.")},u$j._finishInit=function(){throw new Error("StaticBatch:must override this function.")},u$j._clearRenderElements=function(){this._batchRenderElements.length=0},u$j.dispose=function(){},u$j._getVertexBuffer=function(u$W){return void 0===u$W&&(u$W=0),null},u$j._getIndexBuffer=function(){return null},u$j._beforeRender=function(u$W){return!0},u$j._render=function(u$W){},u$j._getVertexBuffers=function(){return null},u$$(0,u$j,"_vertexBufferCount",function(){return 1}),u$$(0,u$j,"triangleCount",function(){return 0}),u$W.combine=function(u$W){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),u$dW.combine(u$W)},u$W.maxBatchVertexCount=65535,u$W}(),u$EW=function(){function u$O(u$W,u$j){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++u$O._uniqueIDCounter,this._id>u$O.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",u$O.maxVertexDeclaration);this._shaderValues=new u$Qj,this._vertexElementsDic={},this._vertexStride=u$W,this._vertexElements=u$j;for(var u$t=0;u$t<u$j.length;u$t++){var u$d=u$j[u$t],u$b=u$d.elementUsage;this._vertexElementsDic[u$b]=u$d;var u$E=[u$O._getTypeSize(u$d.elementFormat)/4,5126,!1,this._vertexStride,u$d.offset];switch(this._shaderValues.setValue(u$b,u$E),u$b){case 1:this._addShaderDefine(u$zj.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(u$zj.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(u$zj.SHADERDEFINE_UV1)}}}u$T(u$O,"laya.d3.graphics.VertexDeclaration");var u$W=u$O.prototype;return u$W._addShaderDefine=function(u$W){this._shaderDefineValue|=u$W},u$W._removeShaderDefine=function(u$W){this._shaderDefineValue&=~u$W},u$W.getVertexElements=function(){return this._vertexElements.slice()},u$W.getVertexElementByUsage=function(u$W){return this._vertexElementsDic[u$W]},u$W.unBinding=function(){},u$$(0,u$W,"shaderDefineValue",function(){return this._shaderDefineValue}),u$$(0,u$W,"id",function(){return this._id}),u$$(0,u$W,"vertexStride",function(){return this._vertexStride}),u$$(0,u$W,"shaderValues",function(){return this._shaderValues}),u$O._getTypeSize=function(u$W){switch(u$W){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},u$O.getVertexStride=function(u$W){for(var u$j=0,u$t=0;u$t<u$W.Length;u$t++){var u$d=u$W[u$t],u$b=u$d.offset+u$O._getTypeSize(u$d.elementFormat);u$j<u$b&&(u$j=u$b)}return u$j},u$O._maxVertexDeclarationBit=1e3,u$O._uniqueIDCounter=1,u$m(u$O,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),u$O}(),u$OW=function(){function u$W(u$W,u$j,u$t){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=u$W,this.elementFormat=u$j,this.elementUsage=u$t}return u$T(u$W,"laya.d3.graphics.VertexElement"),u$W}(),u$qW=(function(){function u$W(){}u$T(u$W,"laya.d3.graphics.VertexElementFormat"),u$W.Single="single",u$W.Vector2="vector2",u$W.Vector3="vector3",u$W.Vector4="vector4",u$W.Color="color",u$W.Byte4="byte4",u$W.Short2="short2",u$W.Short4="short4",u$W.NormalizedShort2="normalizedshort2",u$W.NormalizedShort4="normalizedshort4",u$W.HalfVector2="halfvector2",u$W.HalfVector4="halfvector4"}(),function(){function u$W(){}u$T(u$W,"laya.d3.graphics.VertexElementUsage"),u$W.POSITION0=0,u$W.COLOR0=1,u$W.TEXTURECOORDINATE0=2,u$W.NORMAL0=3,u$W.BINORMAL0=4,u$W.TANGENT0=5,u$W.BLENDINDICES0=6,u$W.BLENDWEIGHT0=7,u$W.DEPTH0=8,u$W.FOG0=9,u$W.POINTSIZE0=10,u$W.SAMPLE0=11,u$W.TESSELLATEFACTOR0=12,u$W.COLOR1=13,u$W.NEXTTEXTURECOORDINATE0=14,u$W.TEXTURECOORDINATE1=15,u$W.NEXTTEXTURECOORDINATE1=16,u$W.CORNERTEXTURECOORDINATE0=17,u$W.VELOCITY0=18,u$W.STARTCOLOR0=19,u$W.STARTSIZE=20,u$W.AGEADDSCALE0=21,u$W.STARTROTATION=22,u$W.ENDCOLOR0=23,u$W.STARTLIFETIME=24,u$W.TIME0=33,u$W.SHAPEPOSITIONSTARTLIFETIME=30,u$W.DIRECTIONTIME=32,u$W.SIZEROTATION0=27,u$W.RADIUS0=28,u$W.RADIAN0=29,u$W.STARTSPEED=31,u$W.RANDOM0=34,u$W.RANDOM1=35,u$W.SIMULATIONWORLDPOSTION=36,u$W.SIMULATIONWORLDROTATION=37,u$W.TEXTURECOORDINATE0X=38,u$W.TEXTURECOORDINATE0X1=39,u$W.TEXTURECOORDINATE0Y=40,u$W.OFFSETVECTOR=41}(),function(){function u$W(u$W,u$j,u$t){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=u$W,this._textureCoordinate0=u$j,this._time=u$t}u$T(u$W,"laya.d3.graphics.VertexGlitter");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate0}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"time",function(){return this._time}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(24,[new u$OW(0,"vector3",0),new u$OW(12,"vector2",2),new u$OW(20,"single",33)])}])}(),function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=u$W,this._position=u$j,this._velocity=u$t,this._startColor=u$d,this._endColor=u$b,this._sizeRotation=u$E,this._radius=u$O,this._radian=u$q,this._ageAddScale=u$A,this._time=u$c}u$T(u$W,"laya.d3.graphics.VertexParticle");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"endColor",function(){return this._endColor}),u$$(0,u$j,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),u$$(0,u$j,"sizeRotation",function(){return this._sizeRotation}),u$$(0,u$j,"velocity",function(){return this._velocity}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"startColor",function(){return this._startColor}),u$$(0,u$j,"radius",function(){return this._radius}),u$$(0,u$j,"radian",function(){return this._radian}),u$$(0,u$j,"ageAddScale",function(){return this._ageAddScale}),u$$(0,u$j,"time",function(){return this._time}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(116,[new u$OW(0,"vector4",17),new u$OW(16,"vector3",0),new u$OW(28,"vector3",18),new u$OW(40,"vector4",19),new u$OW(56,"vector4",23),new u$OW(72,"vector3",27),new u$OW(84,"vector2",28),new u$OW(92,"vector4",29),new u$OW(108,"single",24),new u$OW(112,"single",33)])}])}(),function(){function u$W(u$W){this._position=null,this._position=u$W}u$T(u$W,"laya.d3.graphics.VertexPosition");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(12,[new u$OW(0,"vector3",0)])}]),u$W}()),u$AW=function(){function u$W(u$W,u$j){this._position=null,this._normal=null,this._position=u$W,this._normal=u$j}u$T(u$W,"laya.d3.graphics.VertexPositionNormal");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(24,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3)])}]),u$W}(),u$cW=function(){function u$W(u$W,u$j,u$t){this._position=null,this._normal=null,this._color=null,this._position=u$W,this._normal=u$j,this._color=u$t}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColor");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(40,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1)])}]),u$W}(),u$RW=function(){function u$W(u$W,u$j,u$t,u$d,u$b){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._blendIndex=u$d,this._blendWeight=u$b}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorSkin");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(72,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector4",7),new u$OW(56,"vector4",6)])}]),u$W}(),u$mW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._tangent=u$d,this._blendIndex=u$b,this._blendWeight=u$E}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(88,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector4",7),new u$OW(56,"vector4",6),new u$OW(72,"vector4",5)])}]),u$W}(),u$QW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._tangent=u$d,this._blendIndex=u$b,this._blendWeight=u$E}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(84,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector4",7),new u$OW(56,"vector4",6),new u$OW(72,"vector3",5)])}]),u$W}(),u$TW=function(){function u$W(u$W,u$j,u$t,u$d){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._tangent=u$d}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorSTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(56,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector4",5)])}]),u$W}(),u$$W=function(){function u$W(u$W,u$j,u$t,u$d){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._tangent=u$d}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(52,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector3",5)])}]),u$W}(),u$eW=function(){function u$W(u$W,u$j,u$t,u$d){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._textureCoordinate=u$d}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTexture");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(48,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector2",2)])}]),u$W}(),u$KW=function(){function u$W(u$W,u$j,u$t,u$d,u$b){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._textureCoordinate0=u$d,this._textureCoordinate1=u$b}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(56,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector2",2),new u$OW(48,"vector2",15)])}]),u$W}(),u$oW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._textureCoordinate0=u$d,this._textureCoordinate1=u$b,this._blendIndex=u$E,this._blendWeight=u$O}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(88,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector2",2),new u$OW(48,"vector2",15),new u$OW(56,"vector4",7),new u$OW(72,"vector4",6)])}]),u$W}(),u$SW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._textureCoordinate0=u$d,this._textureCoordinate1=u$b,this._tangent=u$E,this._blendIndex=u$O,this._blendWeight=u$q}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(104,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector2",2),new u$OW(48,"vector2",15),new u$OW(56,"vector4",7),new u$OW(72,"vector4",6),new u$OW(88,"vector4",5)])}]),u$W}(),u$MW=function(){function u$W(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$j.VertexPositionNormalColorTexture0SkinTangent=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){this._position=u$W,this._normal=u$j,this._color=u$t,this._textureCoordinate0=u$d,this._textureCoordinate1=u$b,this._tangent=u$E,this._blendIndex=u$O,this._blendWeight=u$q},u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(100,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector2",2),new u$OW(48,"vector2",15),new u$OW(56,"vector4",7),new u$OW(72,"vector4",6),new u$OW(88,"vector3",5)])}]),u$W}(),u$ZW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._textureCoordinate0=u$d,this._textureCoordinate1=u$b,this._tangent=u$E}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(72,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector2",2),new u$OW(48,"vector2",15),new u$OW(56,"vector4",5)])}]),u$W}(),u$XW=function(){function u$W(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$j.VertexPositionNormalColorTexture0Tangent=function(u$W,u$j,u$t,u$d,u$b,u$E){this._position=u$W,this._normal=u$j,this._color=u$t,this._textureCoordinate0=u$d,this._textureCoordinate1=u$b,this._tangent=u$E},u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(68,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector2",2),new u$OW(48,"vector2",15),new u$OW(56,"vector3",5)])}]),u$W}(),u$_W=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._textureCoordinate=u$d,this._blendIndex=u$b,this._blendWeight=u$E}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(80,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector2",2),new u$OW(48,"vector4",7),new u$OW(64,"vector4",6)])}]),u$W}(),u$NW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._textureCoordinate=u$d,this._tangent=u$b,this._blendIndex=u$E,this._blendWeight=u$O}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(96,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector2",2),new u$OW(48,"vector4",7),new u$OW(64,"vector4",6),new u$OW(80,"vector4",5)])}]),u$W}(),u$zW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._textureCoordinate=u$d,this._tangent=u$b,this._blendIndex=u$E,this._blendWeight=u$O}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(92,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector2",2),new u$OW(48,"vector4",7),new u$OW(64,"vector4",6),new u$OW(80,"vector3",5)])}]),u$W}(),u$CW=function(){function u$W(u$W,u$j,u$t,u$d,u$b){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._textureCoordinate=u$d,this._tangent=u$b}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(64,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector2",2),new u$OW(48,"vector4",5)])}]),u$W}(),u$LW=function(){function u$W(u$W,u$j,u$t,u$d,u$b){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._color=u$t,this._textureCoordinate=u$d,this._tangent=u$b}u$T(u$W,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"color",function(){return this._color}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(60,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",1),new u$OW(40,"vector2",2),new u$OW(48,"vector3",5)])}]),u$W}(),u$VW=function(){function u$W(u$W,u$j,u$t){this._position=null,this._normal=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._tangent=u$t}u$T(u$W,"laya.d3.graphics.VertexPositionNormalSTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(40,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector4",5)])}]),u$W}(),u$xW=function(){function u$W(u$W,u$j,u$t){this._position=null,this._normal=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._tangent=u$t}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(36,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector3",5)])}]),u$W}(),u$GW=function(){function u$W(u$W,u$j,u$t){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=u$W,this._normal=u$j,this._textureCoordinate=u$t}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTexture");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(32,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2)])}]),u$W}(),u$lW=function(){function u$W(u$W,u$j,u$t,u$d){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=u$W,this._normal=u$j,this._textureCoordinate0=u$t,this._textureCoordinate1=u$d}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(40,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2),new u$OW(32,"vector2",15)])}]),u$W}(),u$hW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=u$W,this._normal=u$j,this._textureCoordinate0=u$t,this._textureCoordinate1=u$d,this._blendIndex=u$b,this._blendWeight=u$E}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(72,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2),new u$OW(32,"vector2",15),new u$OW(40,"vector4",7),new u$OW(56,"vector4",6)])}]),u$W}(),u$vW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._textureCoordinate0=u$t,this._textureCoordinate1=u$d,this._tangent=u$b,this._blendIndex=u$E,this._blendWeight=u$O}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(88,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2),new u$OW(32,"vector2",15),new u$OW(40,"vector4",7),new u$OW(56,"vector4",6),new u$OW(72,"vector4",5)])}]),u$W}(),u$yW=function(){function u$W(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$j.VertexPositionNormalTexture0SkinTangent=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){this._position=u$W,this._normal=u$j,this._textureCoordinate0=u$t,this._textureCoordinate1=u$d,this._tangent=u$b,this._blendIndex=u$E,this._blendWeight=u$O},u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(84,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2),new u$OW(32,"vector2",15),new u$OW(40,"vector4",7),new u$OW(56,"vector4",6),new u$OW(72,"vector3",5)])}]),u$W}(),u$aW=function(){function u$W(u$W,u$j,u$t,u$d,u$b){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._textureCoordinate0=u$t,this._textureCoordinate1=u$d,this._tangent=u$b}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(56,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2),new u$OW(32,"vector2",15),new u$OW(40,"vector4",5)])}]),u$W}(),u$uW=function(){function u$W(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$j.VertexPositionNormalTexture0Tangent=function(u$W,u$j,u$t,u$d,u$b){this._position=u$W,this._normal=u$j,this._textureCoordinate0=u$t,this._textureCoordinate1=u$d,this._tangent=u$b},u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(52,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2),new u$OW(32,"vector2",15),new u$OW(40,"vector3",5)])}]),u$W}(),u$DW=function(){function u$W(u$W,u$j,u$t,u$d,u$b){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=u$W,this._normal=u$j,this._textureCoordinate=u$t,this._blendIndex=u$d,this._blendWeight=u$b}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTextureSkin");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(64,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2),new u$OW(32,"vector4",7),new u$OW(48,"vector4",6)])}]),u$W}(),u$sW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._textureCoordinate=u$t,this._tangent=u$d,this._blendIndex=u$b,this._blendWeight=u$E}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(80,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2),new u$OW(32,"vector4",7),new u$OW(48,"vector4",6),new u$OW(64,"vector4",5)])}]),u$W}(),u$YW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._textureCoordinate=u$t,this._tangent=u$d,this._blendIndex=u$b,this._blendWeight=u$E}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(76,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2),new u$OW(32,"vector4",7),new u$OW(48,"vector4",6),new u$OW(64,"vector3",5)])}]),u$W}(),u$HW=function(){function u$W(u$W,u$j,u$t,u$d){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._textureCoordinate=u$t,this._tangent=u$d}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(48,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2),new u$OW(32,"vector4",5)])}]),u$W}(),u$IW=function(){function u$W(u$W,u$j,u$t,u$d){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=u$W,this._normal=u$j,this._textureCoordinate=u$t,this._tangent=u$d}u$T(u$W,"laya.d3.graphics.VertexPositionNormalTextureTangent");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(44,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2),new u$OW(32,"vector3",5)])}]),u$W}(),u$gW=function(){function u$W(u$W,u$j,u$t){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=u$W,this._normal=u$j,this._textureCoordinate=u$t}u$T(u$W,"laya.d3.graphics.VertexPositionNTBTexture");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(56,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector3",5),new u$OW(36,"vector3",4),new u$OW(48,"vector2",2)])}]),u$W}(),u$fW=function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=u$W,this._normal=u$j,this._textureCoordinate0=u$d,this._textureCoordinate1=u$b,this._tangent=u$E,u$t=u$t,this._blendIndex=u$O,this._blendWeight=u$q}u$T(u$W,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"tangent",function(){return this._tangent}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(0,u$j,"textureCoordinate1",function(){return this._textureCoordinate1}),u$$(0,u$j,"blendIndex",function(){return this._blendIndex}),u$$(0,u$j,"blendWeight",function(){return this._blendWeight}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(96,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector3",5),new u$OW(36,"vector3",4),new u$OW(48,"vector2",2),new u$OW(56,"vector2",15),new u$OW(64,"vector4",7),new u$OW(80,"vector4",6)])}]),u$W}(),u$wW=function(){function u$W(u$W,u$j,u$t){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=u$W,this._normal=u$j,this._textureCoordinate=u$t}u$T(u$W,"laya.d3.graphics.VertexPositionNTBTextureSkin");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"textureCoordinate",function(){return this._textureCoordinate}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(88,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector3",5),new u$OW(36,"vector3",4),new u$OW(48,"vector2",2),new u$OW(56,"vector4",7),new u$OW(72,"vector4",6)])}]),u$W}(),u$UW=(function(){function u$W(u$W,u$j,u$t,u$d){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=u$W,this._normal=u$j,this._textureCoord0=u$t,this._textureCoord1=u$d}u$T(u$W,"laya.d3.graphics.VertexPositionTerrain");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"normal",function(){return this._normal}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"textureCoord0",function(){return this._textureCoord0}),u$$(0,u$j,"textureCoord1",function(){return this._textureCoord1}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(40,[new u$OW(0,"vector3",0),new u$OW(12,"vector3",3),new u$OW(24,"vector2",2),new u$OW(32,"vector2",15)])}])}(),function(){function u$W(u$W,u$j){this._position=null,this._textureCoordinate0=null,this._position=u$W,this._textureCoordinate0=u$j}u$T(u$W,"laya.d3.graphics.VertexPositionTexture0");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"position",function(){return this._position}),u$$(0,u$j,"textureCoordinate0",function(){return this._textureCoordinate0}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(20,[new u$OW(0,"vector3",0),new u$OW(12,"vector2",2)])}]),u$W}()),u$JW=(function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$m,u$Q,u$T){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=u$W,this._positionStartLifeTime=u$j,this._velocity=u$t,this._startColor=u$d,this._startSize=u$b,this._startRotation0=u$E,this._startRotation1=u$O,this._startRotation2=u$q,this._startLifeTime=u$A,this._time=u$c,this._startSpeed=u$R,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=u$T}u$T(u$W,"laya.d3.graphics.VertexShurikenParticleBillboard");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),u$$(0,u$j,"random1",function(){return this._randoms1}),u$$(0,u$j,"startRotation2",function(){return this._startRotation2}),u$$(0,u$j,"positionStartLifeTime",function(){return this._positionStartLifeTime}),u$$(0,u$j,"velocity",function(){return this._velocity}),u$$(0,u$j,"random0",function(){return this._randoms0}),u$$(0,u$j,"startSize",function(){return this._startSize}),u$$(0,u$j,"startColor",function(){return this._startColor}),u$$(0,u$j,"startRotation0",function(){return this._startRotation0}),u$$(0,u$j,"startRotation1",function(){return this._startRotation1}),u$$(0,u$j,"startLifeTime",function(){return this._startLifeTime}),u$$(0,u$j,"time",function(){return this._time}),u$$(0,u$j,"startSpeed",function(){return this._startSpeed}),u$$(0,u$j,"simulationWorldPostion",function(){return this._simulationWorldPostion}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(152,[new u$OW(0,"vector4",17),new u$OW(16,"vector4",30),new u$OW(32,"vector4",32),new u$OW(48,"vector4",19),new u$OW(64,"vector3",20),new u$OW(76,"vector3",22),new u$OW(88,"single",31),new u$OW(92,"vector4",34),new u$OW(108,"vector4",35),new u$OW(124,"vector3",36),new u$OW(136,"vector4",37)])}])}(),function(){function u$W(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$m,u$Q,u$T){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=u$W,this._positionStartLifeTime=u$j,this._velocity=u$t,this._startColor=u$d,this._startSize=u$b,this._startRotation0=u$E,this._startRotation1=u$O,this._startRotation2=u$q,this._startLifeTime=u$A,this._time=u$c,this._startSpeed=u$R,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=u$T}u$T(u$W,"laya.d3.graphics.VertexShurikenParticleMesh");var u$j=u$W.prototype;u$X.imps(u$j,{"laya.d3.graphics.IVertex":!0}),u$$(0,u$j,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),u$$(0,u$j,"velocity",function(){return this._velocity}),u$$(0,u$j,"position",function(){return this._positionStartLifeTime}),u$$(0,u$j,"random0",function(){return this._randoms0}),u$$(0,u$j,"startSize",function(){return this._startSize}),u$$(0,u$j,"startColor",function(){return this._startColor}),u$$(0,u$j,"startRotation0",function(){return this._startRotation0}),u$$(0,u$j,"startRotation1",function(){return this._startRotation1}),u$$(0,u$j,"random1",function(){return this._randoms1}),u$$(0,u$j,"startRotation2",function(){return this._startRotation2}),u$$(0,u$j,"startLifeTime",function(){return this._startLifeTime}),u$$(0,u$j,"time",function(){return this._time}),u$$(0,u$j,"startSpeed",function(){return this._startSpeed}),u$$(0,u$j,"simulationWorldPostion",function(){return this._simulationWorldPostion}),u$$(0,u$j,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$$(1,u$W,"vertexDeclaration",function(){return u$W._vertexDeclaration}),u$m(u$W,["_vertexDeclaration",function(){return this._vertexDeclaration=new u$EW(172,[new u$OW(0,"vector3",0),new u$OW(12,"vector4",1),new u$OW(28,"vector2",2),new u$OW(36,"vector4",30),new u$OW(52,"vector4",32),new u$OW(68,"vector4",19),new u$OW(84,"vector3",20),new u$OW(96,"vector3",22),new u$OW(108,"single",31),new u$OW(112,"vector4",34),new u$OW(128,"vector4",35),new u$OW(144,"vector3",36),new u$OW(156,"vector4",37)])}])}(),function(){function u$M(u$W,u$j,u$t,u$d,u$b,u$E){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=u$t,this._materials=u$d,this._subMeshes=u$b,this._materialMap=u$E,this._version=u$j,this._onLoaded(u$W)}u$T(u$M,"laya.d3.loaders.LoadModelV01");var u$W=u$M.prototype;return u$W._onLoaded=function(u$W){this._readData=u$W,this.READ_BLOCK();for(var u$j=0;u$j<this._BLOCK.count;u$j++){var u$t=this._readData.getUint16(),u$d=this._strings[u$t],u$b=this["READ_"+u$d];if(null==u$b)throw new Error("model file err,no this function:"+u$t+" "+u$d);if(!u$b.call(this))break}return this._mesh},u$W.onError=function(){},u$W._readString=function(){return this._strings[this._readData.getUint16()]},u$W.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},u$W.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},u$W.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var u$W=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var u$j=0;u$j<this._STRINGS.size;u$j++)this._strings[u$j]=this._readData.readUTFString();return this._readData.pos=u$W,!0},u$W.READ_MATERIAL=function(){var u$W=this._readData.getUint16(),u$j=(this._readString(),this._readString());return this._materials[u$W]="null"!==u$j?u$o.getRes(this._materialMap[u$j]):new u$xj,!0},u$W.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var u$W,u$j=this._readData.__getBuffer(),u$t=0,u$d=this._readData.getUint32(),u$b=this._readData.getUint32(),u$E=(new Float32Array(u$j.slice(u$d+this._DATA.offset,u$d+this._DATA.offset+u$b)),this._readData.getUint32()),u$O=this._readData.getUint32(),u$q=new Float32Array(u$j.slice(u$E+this._DATA.offset,u$E+this._DATA.offset+u$O));for(this.mesh._inverseBindPoses=[],u$t=0,u$W=u$q.length;u$t<u$W;u$t+=16){var u$A=new u$Wj(u$q[u$t+0],u$q[u$t+1],u$q[u$t+2],u$q[u$t+3],u$q[u$t+4],u$q[u$t+5],u$q[u$t+6],u$q[u$t+7],u$q[u$t+8],u$q[u$t+9],u$q[u$t+10],u$q[u$t+11],u$q[u$t+12],u$q[u$t+13],u$q[u$t+14],u$q[u$t+15]);this.mesh._inverseBindPoses.push(u$A)}break;default:throw new Error("LoadModel:unknown version.")}return!0},u$W.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var u$W=this._readString();this._shaderAttributes=u$W.match(u$M._attrReg);var u$j=this._readData.getUint32(),u$t=this._readData.getUint32(),u$d=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),u$b=this._readData.getUint32(),u$E=this._readData.getUint32(),u$O=this._readData.getUint32(),u$q=this._readData.__getBuffer(),u$A=new u$cj(this._mesh),u$c=this._getVertexDeclaration(),u$R=u$Yj.create(u$c,u$b/u$c.vertexStride,35044,!0),u$m=u$d+this._DATA.offset,u$Q=u$q.slice(u$m,u$m+u$b);u$R.setData(new Float32Array(u$Q));for(var u$T=(u$A._vertexBuffer=u$R).vertexDeclaration.getVertexElements(),u$$=0;u$$<u$T.length;u$$++)u$A._bufferUsage[u$T[u$$].elementUsage]=u$R;var u$e=u$sj.create("ushort",u$t/2,35044,!0),u$K=u$j+this._DATA.offset,u$o=u$q.slice(u$K,u$K+u$t);u$e.setData(new Uint16Array(u$o)),u$A._indexBuffer=u$e;var u$S=u$q.slice(u$E+this._DATA.offset,u$E+this._DATA.offset+u$O);return u$A._boneIndicesList[0]=new Uint8Array(u$S),this._subMeshes.push(u$A),!0},u$W.READ_DATAAREA=function(){return!1},u$W._getVertexDeclaration=function(){for(var u$W,u$j=!1,u$t=!1,u$d=!1,u$b=!1,u$E=!1,u$O=!1,u$q=!1,u$A=!1,u$c=!1,u$R=0;u$R<this._shaderAttributes.length;u$R+=8)switch(this._shaderAttributes[u$R]){case"POSITION":u$j=!0;break;case"NORMAL":u$t=!0;break;case"COLOR":u$d=!0;break;case"UV":u$b=!0;break;case"UV1":u$E=!0;break;case"BLENDWEIGHT":u$q=!0;break;case"BLENDINDICES":u$A=!0;break;case"TANGENT":u$O=!0;break;case"BINORMAL":u$c=!0}return u$j&&u$t&&u$d&&u$b&&u$E&&u$q&&u$A&&u$O?u$W=u$MW.vertexDeclaration:u$j&&u$t&&u$d&&u$b&&u$E&&u$q&&u$A?u$W=u$oW.vertexDeclaration:u$j&&u$t&&u$b&&u$E&&u$q&&u$A&&u$O?u$W=u$yW.vertexDeclaration:u$j&&u$t&&u$b&&u$E&&u$q&&u$A?u$W=u$hW.vertexDeclaration:u$j&&u$t&&u$d&&u$b&&u$q&&u$A&&u$O?u$W=u$zW.vertexDeclaration:u$j&&u$t&&u$d&&u$b&&u$q&&u$A?u$W=u$_W.vertexDeclaration:u$j&&u$t&&u$O&&u$c&&u$b&&u$q&&u$A?u$W=u$wW.vertexDeclaration:u$j&&u$t&&u$b&&u$q&&u$A&&u$O?u$W=u$YW.vertexDeclaration:u$j&&u$t&&u$b&&u$q&&u$A?u$W=u$DW.vertexDeclaration:u$j&&u$t&&u$d&&u$q&&u$A&&u$O?u$W=u$QW.vertexDeclaration:u$j&&u$t&&u$d&&u$q&&u$A?u$W=u$RW.vertexDeclaration:u$j&&u$t&&u$d&&u$b&&u$E&&u$O?u$W=u$XW.vertexDeclaration:u$j&&u$t&&u$d&&u$b&&u$E?u$W=u$KW.vertexDeclaration:u$j&&u$t&&u$b&&u$E&&u$O?u$W=u$uW.vertexDeclaration:u$j&&u$t&&u$b&&u$E?u$W=u$lW.vertexDeclaration:u$j&&u$t&&u$d&&u$b&&u$O?u$W=u$LW.vertexDeclaration:u$j&&u$t&&u$b&&u$O&&u$c?u$W=u$gW.vertexDeclaration:u$j&&u$t&&u$d&&u$b?u$W=u$eW.vertexDeclaration:u$j&&u$t&&u$b&&u$O?u$W=u$IW.vertexDeclaration:u$j&&u$t&&u$b?u$W=u$GW.vertexDeclaration:u$j&&u$t&&u$d&&u$O?u$W=u$$W.vertexDeclaration:u$j&&u$t&&u$d&&(u$W=u$cW.vertexDeclaration),u$W},u$$(0,u$W,"mesh",function(){return this._mesh}),u$M._attrReg=new RegExp("(\\w+)|([:,;])","g"),u$M}()),u$rW=function(){function u$N(){}return u$T(u$N,"laya.d3.loaders.LoadModelV02"),u$N.parse=function(u$W,u$j,u$t,u$d,u$b,u$E){u$N._mesh=u$t,u$N._materials=u$d,u$N._subMeshes=u$b,u$N._materialMap=u$E,u$N._version=u$j,u$N._readData=u$W,u$N.READ_DATA(),u$N.READ_BLOCK(),u$N.READ_STRINGS();for(var u$O=0,u$q=u$N._BLOCK.count;u$O<u$q;u$O++){u$N._readData.pos=u$N._BLOCK.blockStarts[u$O];var u$A=u$N._readData.getUint16(),u$c=u$N._strings[u$A],u$R=u$N["READ_"+u$c];if(null==u$R)throw new Error("model file err,no this function:"+u$A+" "+u$c);u$R.call()}u$N._strings.length=0,u$N._readData=null,u$N._version=null,u$N._mesh=null,u$N._materials=null,u$N._subMeshes=null,u$N._materialMap=null},u$N._readString=function(){return u$N._strings[u$N._readData.getUint16()]},u$N.READ_DATA=function(){u$N._DATA.offset=u$N._readData.getUint32(),u$N._DATA.size=u$N._readData.getUint32()},u$N.READ_BLOCK=function(){for(var u$W=u$N._BLOCK.count=u$N._readData.getUint16(),u$j=u$N._BLOCK.blockStarts=[],u$t=u$N._BLOCK.blockLengths=[],u$d=0;u$d<u$W;u$d++)u$j.push(u$N._readData.getUint32()),u$t.push(u$N._readData.getUint32())},u$N.READ_STRINGS=function(){var u$W=u$N._readData.getUint32(),u$j=u$N._readData.getUint16(),u$t=u$N._readData.pos;u$N._readData.pos=u$W+u$N._DATA.offset;for(var u$d=0;u$d<u$j;u$d++)u$N._strings[u$d]=u$N._readData.readUTFString();u$N._readData.pos=u$t},u$N.READ_MATERIAL=function(){u$N._readString(),u$N._readString();var u$W=u$N._readString();return""!==u$W&&u$N._materials.push(u$o.getRes(u$N._materialMap[u$W])),!0},u$N.READ_MESH=function(){u$N._readString();var u$W,u$j=u$N._readData.__getBuffer(),u$t=0,u$d=u$N._readData.getInt16(),u$b=u$N._DATA.offset;for(u$t=0;u$t<u$d;u$t++){var u$E=u$b+u$N._readData.getUint32(),u$O=u$N._readData.getUint32(),u$q=new Float32Array(u$j.slice(u$E,u$E+u$O)),u$A=u$N._readString().match(u$N._attrReg),u$c=u$N._getVertexDeclaration(u$A),u$R=u$Yj.create(u$c,4*u$q.length/u$c.vertexStride,35044,!0);u$R.setData(u$q),u$N._mesh._vertexBuffers.push(u$R)}var u$m=u$b+u$N._readData.getUint32(),u$Q=u$N._readData.getUint32(),u$T=new Uint16Array(u$j.slice(u$m,u$m+u$Q)),u$$=u$sj.create("ushort",u$Q/2,35044,!0);u$$.setData(u$T),u$N._mesh._indexBuffer=u$$;var u$e=u$N._mesh._boneNames=[],u$K=u$N._readData.getUint16();for(u$e.length=u$K,u$t=0;u$t<u$K;u$t++)u$e[u$t]=u$N._strings[u$N._readData.getUint16()];var u$o=u$N._readData.getUint32(),u$S=u$N._readData.getUint32(),u$M=(new Float32Array(u$j.slice(u$b+u$o,u$b+u$o+u$S)),u$N._readData.getUint32()),u$Z=u$N._readData.getUint32(),u$X=new Float32Array(u$j.slice(u$b+u$M,u$b+u$M+u$Z));for(u$N._mesh._inverseBindPoses=[],u$t=0,u$W=u$X.length;u$t<u$W;u$t+=16){var u$_=new u$Wj(u$X[u$t+0],u$X[u$t+1],u$X[u$t+2],u$X[u$t+3],u$X[u$t+4],u$X[u$t+5],u$X[u$t+6],u$X[u$t+7],u$X[u$t+8],u$X[u$t+9],u$X[u$t+10],u$X[u$t+11],u$X[u$t+12],u$X[u$t+13],u$X[u$t+14],u$X[u$t+15]);u$N._mesh._inverseBindPoses.push(u$_)}return u$N._mesh._skinnedDatas=new Float32Array(16*u$X.length),!0},u$N.READ_SUBMESH=function(){var u$W=u$N._readData.__getBuffer(),u$j=new u$cj(u$N._mesh),u$t=u$N._readData.getInt16(),u$d=u$N._readData.getUint32(),u$b=u$N._readData.getUint32();u$j._vertexBuffer=u$N._mesh._vertexBuffers[u$t],u$j._vertexStart=u$d,u$j._vertexCount=u$b;var u$E=u$N._readData.getUint32(),u$O=u$N._readData.getUint32(),u$q=u$N._mesh._indexBuffer;u$j._indexBuffer=u$q,u$j._indexStart=u$E,u$j._indexCount=u$O,u$j._indices=new Uint16Array(u$q.getData().buffer,2*u$E,u$O);var u$A=u$N._DATA.offset,u$c=u$j._subIndexBufferStart,u$R=u$j._subIndexBufferCount,u$m=u$j._boneIndicesList,u$Q=u$N._readData.getUint16();u$c.length=u$Q,u$R.length=u$Q,u$m.length=u$Q;for(var u$T=0;u$T<u$Q;u$T++){u$c[u$T]=u$N._readData.getUint32(),u$R[u$T]=u$N._readData.getUint32();var u$$=u$N._readData.getUint32(),u$e=u$N._readData.getUint32();u$j._boneIndicesList[u$T]=new Uint8Array(u$W.slice(u$A+u$$,u$A+u$$+u$e))}return u$N._subMeshes.push(u$j),!0},u$N._getVertexDeclaration=function(u$W){for(var u$j,u$t=!1,u$d=!1,u$b=!1,u$E=!1,u$O=!1,u$q=!1,u$A=!1,u$c=!1,u$R=!1,u$m=0;u$m<u$W.length;u$m++)switch(u$W[u$m]){case"POSITION":u$t=!0;break;case"NORMAL":u$d=!0;break;case"COLOR":u$b=!0;break;case"UV":u$E=!0;break;case"UV1":u$O=!0;break;case"BLENDWEIGHT":u$A=!0;break;case"BLENDINDICES":u$c=!0;break;case"TANGENT":u$q=!0;break;case"BINORMAL":u$R=!0}return u$t&&u$d&&u$b&&u$E&&u$O&&u$A&&u$c&&u$q?u$j=u$MW.vertexDeclaration:u$t&&u$d&&u$b&&u$E&&u$O&&u$A&&u$c?u$j=u$oW.vertexDeclaration:u$t&&u$d&&u$E&&u$O&&u$A&&u$c&&u$q?u$j=u$yW.vertexDeclaration:u$t&&u$d&&u$E&&u$O&&u$A&&u$c?u$j=u$hW.vertexDeclaration:u$t&&u$d&&u$b&&u$E&&u$A&&u$c&&u$q?u$j=u$zW.vertexDeclaration:u$t&&u$d&&u$b&&u$E&&u$A&&u$c?u$j=u$_W.vertexDeclaration:u$t&&u$d&&u$E&&u$A&&u$c&&u$q?u$j=u$YW.vertexDeclaration:u$t&&u$d&&u$E&&u$A&&u$c?u$j=u$DW.vertexDeclaration:u$t&&u$d&&u$b&&u$A&&u$c&&u$q?u$j=u$QW.vertexDeclaration:u$t&&u$d&&u$b&&u$A&&u$c?u$j=u$RW.vertexDeclaration:u$t&&u$d&&u$b&&u$E&&u$O&&u$q?u$j=u$XW.vertexDeclaration:u$t&&u$d&&u$b&&u$E&&u$O?u$j=u$KW.vertexDeclaration:u$t&&u$d&&u$E&&u$O&&u$q?u$j=u$uW.vertexDeclaration:u$t&&u$d&&u$E&&u$O?u$j=u$lW.vertexDeclaration:u$t&&u$d&&u$b&&u$E&&u$q?u$j=u$LW.vertexDeclaration:u$t&&u$d&&u$E&&u$q&&u$R?u$j=u$gW.vertexDeclaration:u$t&&u$d&&u$b&&u$E?u$j=u$eW.vertexDeclaration:u$t&&u$d&&u$E&&u$q?u$j=u$IW.vertexDeclaration:u$t&&u$d&&u$E?u$j=u$GW.vertexDeclaration:u$t&&u$d&&u$b&&u$q?u$j=u$$W.vertexDeclaration:u$t&&u$d&&u$b&&(u$j=u$cW.vertexDeclaration),u$j},u$N._attrReg=new RegExp("(\\w+)|([:,;])","g"),u$N._strings=[],u$N._readData=null,u$N._version=null,u$N._mesh=null,u$N._materials=null,u$N._subMeshes=null,u$N._materialMap=null,u$m(u$N,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),u$N}(),u$PW=function(){function u$_(){}return u$T(u$_,"laya.d3.loaders.LoadModelV03"),u$_.parse=function(u$W,u$j,u$t,u$d,u$b){u$_._mesh=u$t,u$_._subMeshes=u$d,u$_._materialMap=u$b,u$_._version=u$j,u$_._readData=u$W,u$_.READ_DATA(),u$_.READ_BLOCK(),u$_.READ_STRINGS();for(var u$E=0,u$O=u$_._BLOCK.count;u$E<u$O;u$E++){u$_._readData.pos=u$_._BLOCK.blockStarts[u$E];var u$q=u$_._readData.getUint16(),u$A=u$_._strings[u$q],u$c=u$_["READ_"+u$A];if(null==u$c)throw new Error("model file err,no this function:"+u$q+" "+u$A);u$c.call()}u$_._strings.length=0,u$_._readData=null,u$_._version=null,u$_._mesh=null,u$_._subMeshes=null,u$_._materialMap=null},u$_._readString=function(){return u$_._strings[u$_._readData.getUint16()]},u$_.READ_DATA=function(){u$_._DATA.offset=u$_._readData.getUint32(),u$_._DATA.size=u$_._readData.getUint32()},u$_.READ_BLOCK=function(){for(var u$W=u$_._BLOCK.count=u$_._readData.getUint16(),u$j=u$_._BLOCK.blockStarts=[],u$t=u$_._BLOCK.blockLengths=[],u$d=0;u$d<u$W;u$d++)u$j.push(u$_._readData.getUint32()),u$t.push(u$_._readData.getUint32())},u$_.READ_STRINGS=function(){var u$W=u$_._readData.getUint32(),u$j=u$_._readData.getUint16(),u$t=u$_._readData.pos;u$_._readData.pos=u$W+u$_._DATA.offset;for(var u$d=0;u$d<u$j;u$d++)u$_._strings[u$d]=u$_._readData.readUTFString();u$_._readData.pos=u$t},u$_.READ_MESH=function(){var u$W,u$j=u$_._readString(),u$t=u$_._readData.__getBuffer(),u$d=0,u$b=u$_._readData.getInt16(),u$E=u$_._DATA.offset;for(u$d=0;u$d<u$b;u$d++){var u$O,u$q=u$E+u$_._readData.getUint32(),u$A=u$_._readData.getUint32(),u$c=new Float32Array(u$t.slice(u$q,u$q+u$A)),u$R=u$_._readString();switch(u$_._version){case"LAYAMODEL:03":u$O=u$_._vertexDeclarationMap_Discard[u$R];break;case"LAYAMODEL:0301":u$O=u$_._vertexDeclarationMap[u$R];break;default:throw new Error("LoadModelV03: unknown version.")}if(!u$O)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+u$_._version+"  bufferAttribute="+u$R+"  name="+u$j+"  url="+(u$_._mesh?u$_._mesh.url:"null"));var u$m=u$Yj.create(u$O,4*u$c.length/u$O.vertexStride,35044,!0,u$_._mesh._url+"_"+u$d);u$m.setData(u$c),u$_._mesh._vertexBuffers.push(u$m)}var u$Q=u$E+u$_._readData.getUint32(),u$T=u$_._readData.getUint32(),u$$=new Uint16Array(u$t.slice(u$Q,u$Q+u$T)),u$e=u$sj.create("ushort",u$T/2,35044,!0,u$_._mesh._url);u$e.setData(u$$),u$_._mesh._indexBuffer=u$e;var u$K=u$_._mesh._boneNames=[],u$o=u$_._readData.getUint16();for(u$K.length=u$o,u$d=0;u$d<u$o;u$d++)u$K[u$d]=u$_._strings[u$_._readData.getUint16()];u$_._readData.pos+=8;var u$S=u$_._readData.getUint32(),u$M=u$_._readData.getUint32(),u$Z=new Float32Array(u$t.slice(u$E+u$S,u$E+u$S+u$M));for(u$_._mesh._inverseBindPoses=[],u$d=0,u$W=u$Z.length;u$d<u$W;u$d+=16){var u$X=new u$Wj(u$Z[u$d+0],u$Z[u$d+1],u$Z[u$d+2],u$Z[u$d+3],u$Z[u$d+4],u$Z[u$d+5],u$Z[u$d+6],u$Z[u$d+7],u$Z[u$d+8],u$Z[u$d+9],u$Z[u$d+10],u$Z[u$d+11],u$Z[u$d+12],u$Z[u$d+13],u$Z[u$d+14],u$Z[u$d+15]);u$_._mesh._inverseBindPoses.push(u$X)}return u$_._mesh._skinnedDatas=new Float32Array(16*u$Z.length),!0},u$_.READ_SUBMESH=function(){var u$W=u$_._readData.__getBuffer(),u$j=new u$cj(u$_._mesh),u$t=u$_._readData.getInt16(),u$d=u$_._readData.getUint32(),u$b=u$_._readData.getUint32();u$j._vertexBuffer=u$_._mesh._vertexBuffers[u$t],u$j._vertexStart=u$d,u$j._vertexCount=u$b;var u$E=u$_._readData.getUint32(),u$O=u$_._readData.getUint32(),u$q=u$_._mesh._indexBuffer;u$j._indexBuffer=u$q,u$j._indexStart=u$E,u$j._indexCount=u$O,u$j._indices=new Uint16Array(u$q.getData().buffer,2*u$E,u$O);var u$A=u$_._DATA.offset,u$c=u$j._subIndexBufferStart,u$R=u$j._subIndexBufferCount,u$m=u$j._boneIndicesList,u$Q=u$_._readData.getUint16();u$c.length=u$Q,u$R.length=u$Q,u$m.length=u$Q;for(var u$T=0;u$T<u$Q;u$T++){u$c[u$T]=u$_._readData.getUint32(),u$R[u$T]=u$_._readData.getUint32();var u$$=u$_._readData.getUint32(),u$e=u$_._readData.getUint32();u$m[u$T]=new Uint8Array(u$W.slice(u$A+u$$,u$A+u$$+u$e))}return u$_._subMeshes.push(u$j),!0},u$_._strings=[],u$_._readData=null,u$_._version=null,u$_._mesh=null,u$_._subMeshes=null,u$_._materialMap=null,u$m(u$_,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":u$MW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":u$oW.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":u$fW.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":u$yW.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":u$hW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":u$zW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":u$_W.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":u$YW.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":u$DW.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":u$QW.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":u$RW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":u$XW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":u$KW.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":u$uW.vertexDeclaration,"POSITION,NORMAL,UV,UV1":u$lW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":u$LW.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":u$gW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":u$eW.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":u$IW.vertexDeclaration,"POSITION,NORMAL,UV":u$GW.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":u$$W.vertexDeclaration,"POSITION,NORMAL,COLOR":u$cW.vertexDeclaration,"POSITION,NORMAL,TANGENT":u$xW.vertexDeclaration,"POSITION,NORMAL":u$AW.vertexDeclaration,"POSITION,UV":u$UW.vertexDeclaration,POSITION:u$qW.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":u$SW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":u$oW.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":u$fW.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":u$vW.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":u$hW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":u$NW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":u$_W.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":u$sW.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":u$DW.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":u$mW.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":u$RW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":u$ZW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":u$KW.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":u$aW.vertexDeclaration,"POSITION,NORMAL,UV,UV1":u$lW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":u$CW.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":u$gW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":u$eW.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":u$HW.vertexDeclaration,"POSITION,NORMAL,UV":u$GW.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":u$TW.vertexDeclaration,"POSITION,NORMAL,COLOR":u$cW.vertexDeclaration,"POSITION,NORMAL,TANGENT":u$VW.vertexDeclaration,"POSITION,NORMAL":u$AW.vertexDeclaration,"POSITION,UV":u$UW.vertexDeclaration,POSITION:u$qW.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),u$_}(),u$iW=function(){function u$q(){}return u$T(u$q,"laya.d3.loaders.MeshReader"),u$q.read=function(u$W,u$j,u$t,u$d,u$b){var u$E=new u$_(u$W);u$E.pos=0;var u$O=u$E.readUTFString();switch(u$O){case"LAYAMODEL:01":case"LAYASKINANI:01":u$q._readVersion01(u$E,u$O,u$j,u$t,u$d,u$b);break;case"LAYAMODEL:02":u$rW.parse(u$E,u$O,u$j,u$t,u$d,u$b);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":u$PW.parse(u$E,u$O,u$j,u$d,u$b);break;default:throw new Error("MeshReader: unknown mesh version.")}u$j._setSubMeshes(u$d)},u$q._readVersion01=function(u$W,u$j,u$t,u$d,u$b,u$E){new u$JW(u$W,u$j,u$t,u$d,u$b,u$E)},u$q}(),u$BW=function(){function u$W(u$W,u$j){this.min=null,this.max=null,this.min=u$W,this.max=u$j}u$T(u$W,"laya.d3.math.BoundBox");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j.getCorners=function(u$W){u$W.length=8;var u$j=this.min.elements,u$t=this.max.elements,u$d=u$j[0],u$b=u$j[1],u$E=u$j[2],u$O=u$t[0],u$q=u$t[1],u$A=u$t[2];u$W[0]=new u$Oj(u$d,u$q,u$A),u$W[1]=new u$Oj(u$O,u$q,u$A),u$W[2]=new u$Oj(u$O,u$b,u$A),u$W[3]=new u$Oj(u$d,u$b,u$A),u$W[4]=new u$Oj(u$d,u$q,u$E),u$W[5]=new u$Oj(u$O,u$q,u$E),u$W[6]=new u$Oj(u$O,u$b,u$E),u$W[7]=new u$Oj(u$d,u$b,u$E)},u$j.toDefault=function(){this.min.toDefault(),this.max.toDefault()},u$j.cloneTo=function(u$W){var u$j=u$W;this.min.cloneTo(u$j.min),this.max.cloneTo(u$j.max)},u$j.clone=function(){var u$W=new this.constructor(new u$Oj,new u$Oj);return this.cloneTo(u$W),u$W},u$W.createfromPoints=function(u$W,u$j){if(null==u$W)throw new Error("points");var u$t=u$j.min,u$d=u$j.max,u$b=u$t.elements;u$b[0]=Number.MAX_VALUE,u$b[1]=Number.MAX_VALUE,u$b[2]=Number.MAX_VALUE;var u$E=u$d.elements;u$E[0]=-Number.MAX_VALUE,u$E[1]=-Number.MAX_VALUE,u$E[2]=-Number.MAX_VALUE;for(var u$O=0,u$q=u$W.length;u$O<u$q;++u$O)u$Oj.min(u$t,u$W[u$O],u$t),u$Oj.max(u$d,u$W[u$O],u$d)},u$W.merge=function(u$W,u$j,u$t){u$Oj.min(u$W.min,u$j.min,u$t.min),u$Oj.max(u$W.max,u$j.max,u$t.max)},u$W}(),u$nW=function(){function u$c(u$W){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=u$W,this._near=new u$jj(new u$Oj),this._far=new u$jj(new u$Oj),this._left=new u$jj(new u$Oj),this._right=new u$jj(new u$Oj),this._top=new u$jj(new u$Oj),this._bottom=new u$jj(new u$Oj),u$c._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}u$T(u$c,"laya.d3.math.BoundFrustum");var u$W=u$c.prototype;return u$W.equalsBoundFrustum=function(u$W){return this._matrix.equalsOtherMatrix(u$W.matrix)},u$W.equalsObj=function(u$W){if(u$W instanceof laya.d3.math.BoundFrustum){var u$j=u$W;return this.equalsBoundFrustum(u$j)}return!1},u$W.getPlane=function(u$W){switch(u$W){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},u$W.getCorners=function(u$W){u$c._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(u$W[0]),u$c._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(u$W[1]),u$c._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(u$W[2]),u$c._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(u$W[3]),u$c._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(u$W[4]),u$c._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(u$W[5]),u$c._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(u$W[6]),u$c._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(u$W[7])},u$W.containsPoint=function(u$W){for(var u$j=u$jj.PlaneIntersectionType_Front,u$t=u$jj.PlaneIntersectionType_Front,u$d=0;u$d<6;u$d++){switch(u$d){case 0:u$t=Collision.intersectsPlaneAndPoint(this._near,u$W);break;case 1:u$t=Collision.intersectsPlaneAndPoint(this._far,u$W);break;case 2:u$t=Collision.intersectsPlaneAndPoint(this._left,u$W);break;case 3:u$t=Collision.intersectsPlaneAndPoint(this._right,u$W);break;case 4:u$t=Collision.intersectsPlaneAndPoint(this._top,u$W);break;case 5:u$t=Collision.intersectsPlaneAndPoint(this._bottom,u$W)}switch(u$t){case u$jj.PlaneIntersectionType_Back:return 0;case u$jj.PlaneIntersectionType_Intersecting:u$j=u$jj.PlaneIntersectionType_Intersecting}}switch(u$j){case u$jj.PlaneIntersectionType_Intersecting:return 2;default:return 1}},u$W.containsBoundBox=function(u$W){for(var u$j,u$t=u$c._tempV30,u$d=u$c._tempV31,u$b=1,u$E=0;u$E<6;u$E++){if(u$j=this.getPlane(u$E),this._getBoxToPlanePVertexNVertex(u$W,u$j.normal,u$t,u$d),Collision.intersectsPlaneAndPoint(u$j,u$t)===u$jj.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(u$j,u$d)===u$jj.PlaneIntersectionType_Back&&(u$b=2)}return u$b},u$W.containsBoundSphere=function(u$W){for(var u$j=u$jj.PlaneIntersectionType_Front,u$t=u$jj.PlaneIntersectionType_Front,u$d=0;u$d<6;u$d++){switch(u$d){case 0:u$t=Collision.intersectsPlaneAndSphere(this._near,u$W);break;case 1:u$t=Collision.intersectsPlaneAndSphere(this._far,u$W);break;case 2:u$t=Collision.intersectsPlaneAndSphere(this._left,u$W);break;case 3:u$t=Collision.intersectsPlaneAndSphere(this._right,u$W);break;case 4:u$t=Collision.intersectsPlaneAndSphere(this._top,u$W);break;case 5:u$t=Collision.intersectsPlaneAndSphere(this._bottom,u$W)}switch(u$t){case u$jj.PlaneIntersectionType_Back:return 0;case u$jj.PlaneIntersectionType_Intersecting:u$j=u$jj.PlaneIntersectionType_Intersecting}}switch(u$j){case u$jj.PlaneIntersectionType_Intersecting:return 2;default:return 1}},u$W._getBoxToPlanePVertexNVertex=function(u$W,u$j,u$t,u$d){var u$b=u$W.min,u$E=u$b.elements,u$O=u$W.max,u$q=u$O.elements,u$A=u$j.elements,u$c=u$A[0],u$R=u$A[1],u$m=u$A[2];u$b.cloneTo(u$t);var u$Q=u$t.elements;0<=u$c&&(u$Q[0]=u$q[0]),0<=u$R&&(u$Q[1]=u$q[1]),0<=u$m&&(u$Q[2]=u$q[2]),u$O.cloneTo(u$d);var u$T=u$d.elements;0<=u$c&&(u$T[0]=u$E[0]),0<=u$R&&(u$T[1]=u$E[1]),0<=u$m&&(u$T[2]=u$E[2])},u$$(0,u$W,"top",function(){return this._top}),u$$(0,u$W,"matrix",function(){return this._matrix},function(u$W){this._matrix=u$W,u$c._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),u$$(0,u$W,"near",function(){return this._near}),u$$(0,u$W,"far",function(){return this._far}),u$$(0,u$W,"left",function(){return this._left}),u$$(0,u$W,"right",function(){return this._right}),u$$(0,u$W,"bottom",function(){return this._bottom}),u$c._getPlanesFromMatrix=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){var u$q=u$W.elements,u$A=u$q[0],u$c=u$q[1],u$R=u$q[2],u$m=u$q[3],u$Q=u$q[4],u$T=u$q[5],u$$=u$q[6],u$e=u$q[7],u$K=u$q[8],u$o=u$q[9],u$S=u$q[10],u$M=u$q[11],u$Z=u$q[12],u$X=u$q[13],u$_=u$q[14],u$N=u$q[15],u$z=u$j.normal.elements;u$z[0]=u$m+u$R,u$z[1]=u$e+u$$,u$z[2]=u$M+u$S,u$j.distance=u$N+u$_,u$j.normalize();var u$C=u$t.normal.elements;u$C[0]=u$m-u$R,u$C[1]=u$e-u$$,u$C[2]=u$M-u$S,u$t.distance=u$N-u$_,u$t.normalize();var u$L=u$d.normal.elements;u$L[0]=u$m+u$A,u$L[1]=u$e+u$Q,u$L[2]=u$M+u$K,u$d.distance=u$N+u$Z,u$d.normalize();var u$V=u$b.normal.elements;u$V[0]=u$m-u$A,u$V[1]=u$e-u$Q,u$V[2]=u$M-u$K,u$b.distance=u$N-u$Z,u$b.normalize();var u$x=u$E.normal.elements;u$x[0]=u$m-u$c,u$x[1]=u$e-u$T,u$x[2]=u$M-u$o,u$E.distance=u$N-u$X,u$E.normalize();var u$G=u$O.normal.elements;u$G[0]=u$m+u$c,u$G[1]=u$e+u$T,u$G[2]=u$M+u$o,u$O.distance=u$N+u$X,u$O.normalize()},u$c._get3PlaneInterPoint=function(u$W,u$j,u$t){var u$d=u$W.normal,u$b=u$j.normal,u$E=u$t.normal;u$Oj.cross(u$b,u$E,u$c._tempV30),u$Oj.cross(u$E,u$d,u$c._tempV31),u$Oj.cross(u$d,u$b,u$c._tempV32);var u$O=u$Oj.dot(u$d,u$c._tempV30),u$q=u$Oj.dot(u$b,u$c._tempV31),u$A=u$Oj.dot(u$E,u$c._tempV32);return u$Oj.scale(u$c._tempV30,-u$W.distance/u$O,u$c._tempV33),u$Oj.scale(u$c._tempV31,-u$j.distance/u$q,u$c._tempV34),u$Oj.scale(u$c._tempV32,-u$t.distance/u$A,u$c._tempV35),u$Oj.add(u$c._tempV33,u$c._tempV34,u$c._tempV36),u$Oj.add(u$c._tempV35,u$c._tempV36,u$c._tempV37),u$c._tempV37},u$m(u$c,["_tempV30",function(){return this._tempV30=new u$Oj},"_tempV31",function(){return this._tempV31=new u$Oj},"_tempV32",function(){return this._tempV32=new u$Oj},"_tempV33",function(){return this._tempV33=new u$Oj},"_tempV34",function(){return this._tempV34=new u$Oj},"_tempV35",function(){return this._tempV35=new u$Oj},"_tempV36",function(){return this._tempV36=new u$Oj},"_tempV37",function(){return this._tempV37=new u$Oj}]),u$c}(),u$kW=function(){function u$R(u$W,u$j){this.center=null,this.radius=NaN,this.center=u$W,this.radius=u$j}u$T(u$R,"laya.d3.math.BoundSphere");var u$W=u$R.prototype;return u$X.imps(u$W,{"laya.d3.core.IClone":!0}),u$W.toDefault=function(){this.center.toDefault(),this.radius=0},u$W.intersectsRayDistance=function(u$W){return Collision.intersectsRayAndSphereRD(u$W,this)},u$W.intersectsRayPoint=function(u$W,u$j){return Collision.intersectsRayAndSphereRP(u$W,this,u$j)},u$W.cloneTo=function(u$W){var u$j=u$W;this.center.cloneTo(u$j.center),u$j.radius=this.radius},u$W.clone=function(){var u$W=new this.constructor(new u$Oj,new u$Oj);return this.cloneTo(u$W),u$W},u$R.createFromSubPoints=function(u$W,u$j,u$t,u$d){if(null==u$W)throw new Error("points");if(u$j<0||u$j>=u$W.length)throw new Error("start"+u$j+"Must be in the range [0, "+(u$W.length-1)+"]");if(u$t<0||u$j+u$t>u$W.length)throw new Error("count"+u$t+"Must be in the range <= "+u$W.length+"}");var u$b=u$j+u$t,u$E=u$R._tempVector3;u$E.elements[0]=0,u$E.elements[1]=0,u$E.elements[2]=0;for(var u$O=u$j;u$O<u$b;++u$O)u$Oj.add(u$W[u$O],u$E,u$E);var u$q=u$d.center;u$Oj.scale(u$E,1/u$t,u$q);var u$A=0;for(u$O=u$j;u$O<u$b;++u$O){var u$c=u$Oj.distanceSquared(u$q,u$W[u$O]);u$A<u$c&&(u$A=u$c)}u$d.radius=Math.sqrt(u$A)},u$R.createfromPoints=function(u$W,u$j){if(null==u$W)throw new Error("points");u$R.createFromSubPoints(u$W,0,u$W.length,u$j)},u$m(u$R,["_tempVector3",function(){return this._tempVector3=new u$Oj}]),u$R}(),u$pW=(function(){function u$W(){}u$T(u$W,"laya.d3.math.ContainmentType"),u$W.Disjoint=0,u$W.Contains=1,u$W.Intersects=2}(),function(){function u$t(){}return u$T(u$t,"laya.d3.math.MathUtils3D"),u$t.isZero=function(u$W){return Math.abs(u$W)<u$t.zeroTolerance},u$t.nearEqual=function(u$W,u$j){return!!u$t.isZero(u$W-u$j)},u$t.fastInvSqrt=function(u$W){return u$t.isZero(u$W)?u$W:1/Math.sqrt(u$W)},u$m(u$t,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),u$t}()),u$FW=function(){function u$A(){var u$W=this.elements=new Float32Array(9);u$W[0]=1,u$W[1]=0,u$W[2]=0,u$W[3]=0,u$W[4]=1,u$W[5]=0,u$W[6]=0,u$W[7]=0,u$W[8]=1}u$T(u$A,"laya.d3.math.Matrix3x3");var u$W=u$A.prototype;return u$X.imps(u$W,{"laya.d3.core.IClone":!0}),u$W.determinant=function(){var u$W=this.elements,u$j=u$W[0],u$t=u$W[1],u$d=u$W[2],u$b=u$W[3],u$E=u$W[4],u$O=u$W[5],u$q=u$W[6],u$A=u$W[7],u$c=u$W[8];return u$j*(u$c*u$E-u$O*u$A)+u$t*(-u$c*u$b+u$O*u$q)+u$d*(u$A*u$b-u$E*u$q)},u$W.translate=function(u$W,u$j){var u$t=u$j.elements,u$d=this.elements,u$b=u$W.elements,u$E=u$d[0],u$O=u$d[1],u$q=u$d[2],u$A=u$d[3],u$c=u$d[4],u$R=u$d[5],u$m=u$d[6],u$Q=u$d[7],u$T=u$d[8],u$$=u$b[0],u$e=u$b[1];u$t[0]=u$E,u$t[1]=u$O,u$t[2]=u$q,u$t[3]=u$A,u$t[4]=u$c,u$t[5]=u$R,u$t[6]=u$$*u$E+u$e*u$A+u$m,u$t[7]=u$$*u$O+u$e*u$c+u$Q,u$t[8]=u$$*u$q+u$e*u$R+u$T},u$W.rotate=function(u$W,u$j){var u$t=u$j.elements,u$d=this.elements,u$b=u$d[0],u$E=u$d[1],u$O=u$d[2],u$q=u$d[3],u$A=u$d[4],u$c=u$d[5],u$R=u$d[6],u$m=u$d[7],u$Q=u$d[8],u$T=Math.sin(u$W),u$$=Math.cos(u$W);u$t[0]=u$$*u$b+u$T*u$q,u$t[1]=u$$*u$E+u$T*u$A,u$t[2]=u$$*u$O+u$T*u$c,u$t[3]=u$$*u$q-u$T*u$b,u$t[4]=u$$*u$A-u$T*u$E,u$t[5]=u$$*u$c-u$T*u$O,u$t[6]=u$R,u$t[7]=u$m,u$t[8]=u$Q},u$W.scale=function(u$W,u$j){var u$t=u$j.elements,u$d=this.elements,u$b=u$W.elements,u$E=u$b[0],u$O=u$b[1];u$t[0]=u$E*u$d[0],u$t[1]=u$E*u$d[1],u$t[2]=u$E*u$d[2],u$t[3]=u$O*u$d[3],u$t[4]=u$O*u$d[4],u$t[5]=u$O*u$d[5],u$t[6]=u$d[6],u$t[7]=u$d[7],u$t[8]=u$d[8]},u$W.invert=function(u$W){var u$j=u$W.elements,u$t=this.elements,u$d=u$t[0],u$b=u$t[1],u$E=u$t[2],u$O=u$t[3],u$q=u$t[4],u$A=u$t[5],u$c=u$t[6],u$R=u$t[7],u$m=u$t[8],u$Q=u$m*u$q-u$A*u$R,u$T=-u$m*u$O+u$A*u$c,u$$=u$R*u$O-u$q*u$c,u$e=u$d*u$Q+u$b*u$T+u$E*u$$;u$e||(u$W=null),u$e=1/u$e,u$j[0]=u$Q*u$e,u$j[1]=(-u$m*u$b+u$E*u$R)*u$e,u$j[2]=(u$A*u$b-u$E*u$q)*u$e,u$j[3]=u$T*u$e,u$j[4]=(u$m*u$d-u$E*u$c)*u$e,u$j[5]=(-u$A*u$d+u$E*u$O)*u$e,u$j[6]=u$$*u$e,u$j[7]=(-u$R*u$d+u$b*u$c)*u$e,u$j[8]=(u$q*u$d-u$b*u$O)*u$e},u$W.transpose=function(u$W){var u$j=u$W.elements,u$t=this.elements;if(u$W===this){var u$d=u$t[1],u$b=u$t[2],u$E=u$t[5];u$j[1]=u$t[3],u$j[2]=u$t[6],u$j[3]=u$d,u$j[5]=u$t[7],u$j[6]=u$b,u$j[7]=u$E}else u$j[0]=u$t[0],u$j[1]=u$t[3],u$j[2]=u$t[6],u$j[3]=u$t[1],u$j[4]=u$t[4],u$j[5]=u$t[7],u$j[6]=u$t[2],u$j[7]=u$t[5],u$j[8]=u$t[8]},u$W.identity=function(){var u$W=this.elements;u$W[0]=1,u$W[1]=0,u$W[2]=0,u$W[3]=0,u$W[4]=1,u$W[5]=0,u$W[6]=0,u$W[7]=0,u$W[8]=1},u$W.cloneTo=function(u$W){var u$j,u$t,u$d;if((u$t=this.elements)!==(u$d=u$W.elements))for(u$j=0;u$j<9;++u$j)u$d[u$j]=u$t[u$j]},u$W.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$A.createFromTranslation=function(u$W,u$j){u$j.elements;var u$t=u$W.elements;u$j[0]=1,u$j[1]=0,u$j[2]=0,u$j[3]=0,u$j[4]=1,u$j[5]=0,u$j[6]=u$t[0],u$j[7]=u$t[1],u$j[8]=1},u$A.createFromRotation=function(u$W,u$j){var u$t=u$j.elements,u$d=Math.sin(u$W),u$b=Math.cos(u$W);u$t[0]=u$b,u$t[1]=u$d,u$t[2]=0,u$t[3]=-u$d,u$t[4]=u$b,u$t[5]=0,u$t[6]=0,u$t[7]=0,u$t[8]=1},u$A.createFromScaling=function(u$W,u$j){var u$t=u$j.elements,u$d=u$W.elements;u$t[0]=u$d[0],u$t[1]=0,u$t[2]=0,u$t[3]=0,u$t[4]=u$d[1],u$t[5]=0,u$t[6]=0,u$t[7]=0,u$t[8]=1},u$A.createFromMatrix4x4=function(u$W,u$j){u$j[0]=u$W[0],u$j[1]=u$W[1],u$j[2]=u$W[2],u$j[3]=u$W[4],u$j[4]=u$W[5],u$j[5]=u$W[6],u$j[6]=u$W[8],u$j[7]=u$W[9],u$j[8]=u$W[10]},u$A.multiply=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements,u$O=u$b[0],u$q=u$b[1],u$A=u$b[2],u$c=u$b[3],u$R=u$b[4],u$m=u$b[5],u$Q=u$b[6],u$T=u$b[7],u$$=u$b[8],u$e=u$E[0],u$K=u$E[1],u$o=u$E[2],u$S=u$E[3],u$M=u$E[4],u$Z=u$E[5],u$X=u$E[6],u$_=u$E[7],u$N=u$E[8];u$d[0]=u$e*u$O+u$K*u$c+u$o*u$Q,u$d[1]=u$e*u$q+u$K*u$R+u$o*u$T,u$d[2]=u$e*u$A+u$K*u$m+u$o*u$$,u$d[3]=u$S*u$O+u$M*u$c+u$Z*u$Q,u$d[4]=u$S*u$q+u$M*u$R+u$Z*u$T,u$d[5]=u$S*u$A+u$M*u$m+u$Z*u$$,u$d[6]=u$X*u$O+u$_*u$c+u$N*u$Q,u$d[7]=u$X*u$q+u$_*u$R+u$N*u$T,u$d[8]=u$X*u$A+u$_*u$m+u$N*u$$},u$A.lookAt=function(u$W,u$j,u$t,u$d){u$Oj.subtract(u$W,u$j,u$A._tempV30),u$Oj.normalize(u$A._tempV30,u$A._tempV30),u$Oj.cross(u$t,u$A._tempV30,u$A._tempV31),u$Oj.normalize(u$A._tempV31,u$A._tempV31),u$Oj.cross(u$A._tempV30,u$A._tempV31,u$A._tempV32);var u$b=u$A._tempV30.elements,u$E=u$A._tempV31.elements,u$O=u$A._tempV32.elements,u$q=u$d.elements;u$q[0]=u$E[0],u$q[3]=u$E[1],u$q[6]=u$E[2],u$q[1]=u$O[0],u$q[4]=u$O[1],u$q[7]=u$O[2],u$q[2]=u$b[0],u$q[5]=u$b[1],u$q[8]=u$b[2]},u$A.DEFAULT=new u$A,u$m(u$A,["_tempV30",function(){return this._tempV30=new u$Oj},"_tempV31",function(){return this._tempV31=new u$Oj},"_tempV32",function(){return this._tempV32=new u$Oj}]),u$A}(),u$Wj=function(){function u$C(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$m,u$Q,u$T,u$$,u$e){void 0===u$W&&(u$W=1),void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=0),void 0===u$b&&(u$b=0),void 0===u$E&&(u$E=1),void 0===u$O&&(u$O=0),void 0===u$q&&(u$q=0),void 0===u$A&&(u$A=0),void 0===u$c&&(u$c=0),void 0===u$R&&(u$R=1),void 0===u$m&&(u$m=0),void 0===u$Q&&(u$Q=0),void 0===u$T&&(u$T=0),void 0===u$$&&(u$$=0),void 0===u$e&&(u$e=1);var u$K=this.elements=new Float32Array(16);u$K[0]=u$W,u$K[1]=u$j,u$K[2]=u$t,u$K[3]=u$d,u$K[4]=u$b,u$K[5]=u$E,u$K[6]=u$O,u$K[7]=u$q,u$K[8]=u$A,u$K[9]=u$c,u$K[10]=u$R,u$K[11]=u$m,u$K[12]=u$Q,u$K[13]=u$T,u$K[14]=u$$,u$K[15]=u$e}u$T(u$C,"laya.d3.math.Matrix4x4");var u$W=u$C.prototype;return u$X.imps(u$W,{"laya.d3.core.IClone":!0}),u$W.getElementByRowColumn=function(u$W,u$j){if(u$W<0||3<u$W)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(u$j<0||3<u$j)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*u$W+u$j]},u$W.setElementByRowColumn=function(u$W,u$j,u$t){if(u$W<0||3<u$W)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(u$j<0||3<u$j)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*u$W+u$j]=u$t},u$W.equalsOtherMatrix=function(u$W){var u$j=this.elements,u$t=u$W.elements;return u$pW.nearEqual(u$j[0],u$t[0])&&u$pW.nearEqual(u$j[1],u$t[1])&&u$pW.nearEqual(u$j[2],u$t[2])&&u$pW.nearEqual(u$j[3],u$t[3])&&u$pW.nearEqual(u$j[4],u$t[4])&&u$pW.nearEqual(u$j[5],u$t[5])&&u$pW.nearEqual(u$j[6],u$t[6])&&u$pW.nearEqual(u$j[7],u$t[7])&&u$pW.nearEqual(u$j[8],u$t[8])&&u$pW.nearEqual(u$j[9],u$t[9])&&u$pW.nearEqual(u$j[10],u$t[10])&&u$pW.nearEqual(u$j[11],u$t[11])&&u$pW.nearEqual(u$j[12],u$t[12])&&u$pW.nearEqual(u$j[13],u$t[13])&&u$pW.nearEqual(u$j[14],u$t[14])&&u$pW.nearEqual(u$j[15],u$t[15])},u$W.decomposeTransRotScale=function(u$W,u$j,u$t){var u$d=u$C._tempMatrix4x4;return this.decomposeTransRotMatScale(u$W,u$d,u$t)?(u$tj.createFromMatrix4x4(u$d,u$j),!0):(u$j.identity(),!1)},u$W.decomposeTransRotMatScale=function(u$W,u$j,u$t){var u$d=this.elements,u$b=u$W.elements,u$E=u$j.elements,u$O=u$t.elements;u$b[0]=u$d[12],u$b[1]=u$d[13],u$b[2]=u$d[14];var u$q=u$d[0],u$A=u$d[1],u$c=u$d[2],u$R=u$d[4],u$m=u$d[5],u$Q=u$d[6],u$T=u$d[8],u$$=u$d[9],u$e=u$d[10],u$K=u$O[0]=Math.sqrt(u$q*u$q+u$A*u$A+u$c*u$c),u$o=u$O[1]=Math.sqrt(u$R*u$R+u$m*u$m+u$Q*u$Q),u$S=u$O[2]=Math.sqrt(u$T*u$T+u$$*u$$+u$e*u$e);if(u$pW.isZero(u$K)||u$pW.isZero(u$o)||u$pW.isZero(u$S))return u$E[1]=u$E[2]=u$E[3]=u$E[4]=u$E[6]=u$E[7]=u$E[8]=u$E[9]=u$E[11]=u$E[12]=u$E[13]=u$E[14]=0,u$E[0]=u$E[5]=u$E[10]=u$E[15]=1,!1;var u$M=u$C._tempVector0,u$Z=u$M.elements;u$Z[0]=u$T/u$S,u$Z[1]=u$$/u$S,u$Z[2]=u$e/u$S;var u$X=u$C._tempVector1,u$_=u$X.elements;u$_[0]=u$q/u$K,u$_[1]=u$A/u$K,u$_[2]=u$c/u$K;var u$N=u$C._tempVector2;u$Oj.cross(u$M,u$X,u$N);var u$z=u$C._tempVector1;return u$Oj.cross(u$N,u$M,u$z),u$E[3]=u$E[7]=u$E[11]=u$E[12]=u$E[13]=u$E[14]=0,u$E[15]=1,u$E[0]=u$z.x,u$E[1]=u$z.y,u$E[2]=u$z.z,u$E[4]=u$N.x,u$E[5]=u$N.y,u$E[6]=u$N.z,u$E[8]=u$M.x,u$E[9]=u$M.y,u$E[10]=u$M.z,u$E[0]*u$q+u$E[1]*u$A+u$E[2]*u$c<0&&(u$O[0]=-u$K),u$E[4]*u$R+u$E[5]*u$m+u$E[6]*u$Q<0&&(u$O[1]=-u$o),u$E[8]*u$T+u$E[9]*u$$+u$E[10]*u$e<0&&(u$O[2]=-u$S),!0},u$W.decomposeYawPitchRoll=function(u$W){var u$j=u$W.elements,u$t=Math.asin(-this.elements[9]);u$j[1]=u$t,Math.cos(u$t)>u$pW.zeroTolerance?(u$j[2]=Math.atan2(this.elements[1],this.elements[5]),u$j[0]=Math.atan2(this.elements[8],this.elements[10])):(u$j[2]=Math.atan2(-this.elements[4],this.elements[0]),u$j[0]=0)},u$W.normalize=function(){var u$W=this.elements,u$j=u$W[0],u$t=u$W[1],u$d=u$W[2],u$b=Math.sqrt(u$j*u$j+u$t*u$t+u$d*u$d);if(!u$b)return u$W[0]=0,u$W[1]=0,void(u$W[2]=0);1!=u$b&&(u$b=1/u$b,u$W[0]=u$j*u$b,u$W[1]=u$t*u$b,u$W[2]=u$d*u$b)},u$W.transpose=function(){var u$W,u$j;return u$j=(u$W=this.elements)[1],u$W[1]=u$W[4],u$W[4]=u$j,u$j=u$W[2],u$W[2]=u$W[8],u$W[8]=u$j,u$j=u$W[3],u$W[3]=u$W[12],u$W[12]=u$j,u$j=u$W[6],u$W[6]=u$W[9],u$W[9]=u$j,u$j=u$W[7],u$W[7]=u$W[13],u$W[13]=u$j,u$j=u$W[11],u$W[11]=u$W[14],u$W[14]=u$j,this},u$W.invert=function(u$W){var u$j=this.elements,u$t=u$W.elements,u$d=u$j[0],u$b=u$j[1],u$E=u$j[2],u$O=u$j[3],u$q=u$j[4],u$A=u$j[5],u$c=u$j[6],u$R=u$j[7],u$m=u$j[8],u$Q=u$j[9],u$T=u$j[10],u$$=u$j[11],u$e=u$j[12],u$K=u$j[13],u$o=u$j[14],u$S=u$j[15],u$M=u$d*u$A-u$b*u$q,u$Z=u$d*u$c-u$E*u$q,u$X=u$d*u$R-u$O*u$q,u$_=u$b*u$c-u$E*u$A,u$N=u$b*u$R-u$O*u$A,u$z=u$E*u$R-u$O*u$c,u$C=u$m*u$K-u$Q*u$e,u$L=u$m*u$o-u$T*u$e,u$V=u$m*u$S-u$$*u$e,u$x=u$Q*u$o-u$T*u$K,u$G=u$Q*u$S-u$$*u$K,u$l=u$T*u$S-u$$*u$o,u$h=u$M*u$l-u$Z*u$G+u$X*u$x+u$_*u$V-u$N*u$L+u$z*u$C;0!==Math.abs(u$h)&&(u$h=1/u$h,u$t[0]=(u$A*u$l-u$c*u$G+u$R*u$x)*u$h,u$t[1]=(u$E*u$G-u$b*u$l-u$O*u$x)*u$h,u$t[2]=(u$K*u$z-u$o*u$N+u$S*u$_)*u$h,u$t[3]=(u$T*u$N-u$Q*u$z-u$$*u$_)*u$h,u$t[4]=(u$c*u$V-u$q*u$l-u$R*u$L)*u$h,u$t[5]=(u$d*u$l-u$E*u$V+u$O*u$L)*u$h,u$t[6]=(u$o*u$X-u$e*u$z-u$S*u$Z)*u$h,u$t[7]=(u$m*u$z-u$T*u$X+u$$*u$Z)*u$h,u$t[8]=(u$q*u$G-u$A*u$V+u$R*u$C)*u$h,u$t[9]=(u$b*u$V-u$d*u$G-u$O*u$C)*u$h,u$t[10]=(u$e*u$N-u$K*u$X+u$S*u$M)*u$h,u$t[11]=(u$Q*u$X-u$m*u$N-u$$*u$M)*u$h,u$t[12]=(u$A*u$L-u$q*u$x-u$c*u$C)*u$h,u$t[13]=(u$d*u$x-u$b*u$L+u$E*u$C)*u$h,u$t[14]=(u$K*u$Z-u$e*u$_-u$o*u$M)*u$h,u$t[15]=(u$m*u$_-u$Q*u$Z+u$T*u$M)*u$h)},u$W.identity=function(){var u$W=this.elements;u$W[1]=u$W[2]=u$W[3]=u$W[4]=u$W[6]=u$W[7]=u$W[8]=u$W[9]=u$W[11]=u$W[12]=u$W[13]=u$W[14]=0,u$W[0]=u$W[5]=u$W[10]=u$W[15]=1},u$W.cloneTo=function(u$W){var u$j,u$t,u$d;if((u$t=this.elements)!==(u$d=u$W.elements))for(u$j=0;u$j<16;++u$j)u$d[u$j]=u$t[u$j]},u$W.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$W.getTranslationVector=function(u$W){var u$j=this.elements,u$t=u$W.elements;u$t[0]=u$j[12],u$t[1]=u$j[13],u$t[2]=u$j[14]},u$W.setTranslationVector=function(u$W){var u$j=this.elements,u$t=u$W.elements;u$j[12]=u$t[0],u$j[13]=u$t[1],u$j[14]=u$t[2]},u$W.getForward=function(u$W){var u$j=this.elements,u$t=u$W.elements;u$t[0]=-u$j[8],u$t[1]=-u$j[9],u$t[2]=-u$j[10]},u$W.setForward=function(u$W){var u$j=this.elements,u$t=u$W.elements;u$j[8]=-u$t[0],u$j[9]=-u$t[1],u$j[10]=-u$t[2]},u$C.createRotationX=function(u$W,u$j){var u$t=u$j.elements,u$d=Math.sin(u$W),u$b=Math.cos(u$W);u$t[1]=u$t[2]=u$t[3]=u$t[4]=u$t[7]=u$t[8]=u$t[11]=u$t[12]=u$t[13]=u$t[14]=0,u$t[0]=u$t[15]=1,u$t[5]=u$t[10]=u$b,u$t[6]=u$d,u$t[9]=-u$d},u$C.createRotationY=function(u$W,u$j){var u$t=u$j.elements,u$d=Math.sin(u$W),u$b=Math.cos(u$W);u$t[1]=u$t[3]=u$t[4]=u$t[6]=u$t[7]=u$t[9]=u$t[11]=u$t[12]=u$t[13]=u$t[14]=0,u$t[5]=u$t[15]=1,u$t[0]=u$t[10]=u$b,u$t[2]=-u$d,u$t[8]=u$d},u$C.createRotationZ=function(u$W,u$j){var u$t=u$j.elements,u$d=Math.sin(u$W),u$b=Math.cos(u$W);u$t[2]=u$t[3]=u$t[6]=u$t[7]=u$t[8]=u$t[9]=u$t[11]=u$t[12]=u$t[13]=u$t[14]=0,u$t[10]=u$t[15]=1,u$t[0]=u$t[5]=u$b,u$t[1]=u$d,u$t[4]=-u$d},u$C.createRotationYawPitchRoll=function(u$W,u$j,u$t,u$d){u$tj.createFromYawPitchRoll(u$W,u$j,u$t,u$C._tempQuaternion),u$C.createRotationQuaternion(u$C._tempQuaternion,u$d)},u$C.createRotationAxis=function(u$W,u$j,u$t){var u$d=u$W.elements,u$b=u$d[0],u$E=u$d[1],u$O=u$d[2],u$q=Math.cos(u$j),u$A=Math.sin(u$j),u$c=u$b*u$b,u$R=u$E*u$E,u$m=u$O*u$O,u$Q=u$b*u$E,u$T=u$b*u$O,u$$=u$E*u$O,u$e=u$t.elements;u$e[3]=u$e[7]=u$e[11]=u$e[12]=u$e[13]=u$e[14]=0,u$e[15]=1,u$e[0]=u$c+u$q*(1-u$c),u$e[1]=u$Q-u$q*u$Q+u$A*u$O,u$e[2]=u$T-u$q*u$T-u$A*u$E,u$e[4]=u$Q-u$q*u$Q-u$A*u$O,u$e[5]=u$R+u$q*(1-u$R),u$e[6]=u$$-u$q*u$$+u$A*u$b,u$e[8]=u$T-u$q*u$T+u$A*u$E,u$e[9]=u$$-u$q*u$$-u$A*u$b,u$e[10]=u$m+u$q*(1-u$m)},u$C.createRotationQuaternion=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements,u$b=u$t[0],u$E=u$t[1],u$O=u$t[2],u$q=u$t[3],u$A=u$b*u$b,u$c=u$E*u$E,u$R=u$O*u$O,u$m=u$b*u$E,u$Q=u$O*u$q,u$T=u$O*u$b,u$$=u$E*u$q,u$e=u$E*u$O,u$K=u$b*u$q;u$d[3]=u$d[7]=u$d[11]=u$d[12]=u$d[13]=u$d[14]=0,u$d[15]=1,u$d[0]=1-2*(u$c+u$R),u$d[1]=2*(u$m+u$Q),u$d[2]=2*(u$T-u$$),u$d[4]=2*(u$m-u$Q),u$d[5]=1-2*(u$R+u$A),u$d[6]=2*(u$e+u$K),u$d[8]=2*(u$T+u$$),u$d[9]=2*(u$e-u$K),u$d[10]=1-2*(u$c+u$A)},u$C.createTranslate=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements;u$d[4]=u$d[8]=u$d[1]=u$d[9]=u$d[2]=u$d[6]=u$d[3]=u$d[7]=u$d[11]=0,u$d[0]=u$d[5]=u$d[10]=u$d[15]=1,u$d[12]=u$t[0],u$d[13]=u$t[1],u$d[14]=u$t[2]},u$C.createScaling=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements;u$d[0]=u$t[0],u$d[5]=u$t[1],u$d[10]=u$t[2],u$d[1]=u$d[4]=u$d[8]=u$d[12]=u$d[9]=u$d[13]=u$d[2]=u$d[6]=u$d[14]=u$d[3]=u$d[7]=u$d[11]=0,u$d[15]=1},u$C.multiply=function(u$W,u$j,u$t){var u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R;for(u$b=u$t.elements,u$E=u$W.elements,u$b===(u$O=u$j.elements)&&(u$O=u$O.slice()),u$d=0;u$d<4;u$d++)u$q=u$E[u$d],u$A=u$E[u$d+4],u$c=u$E[u$d+8],u$R=u$E[u$d+12],u$b[u$d]=u$q*u$O[0]+u$A*u$O[1]+u$c*u$O[2]+u$R*u$O[3],u$b[u$d+4]=u$q*u$O[4]+u$A*u$O[5]+u$c*u$O[6]+u$R*u$O[7],u$b[u$d+8]=u$q*u$O[8]+u$A*u$O[9]+u$c*u$O[10]+u$R*u$O[11],u$b[u$d+12]=u$q*u$O[12]+u$A*u$O[13]+u$c*u$O[14]+u$R*u$O[15]},u$C.createFromQuaternion=function(u$W,u$j){var u$t=u$j.elements,u$d=u$W.elements,u$b=u$d[0],u$E=u$d[1],u$O=u$d[2],u$q=u$d[3],u$A=u$b+u$b,u$c=u$E+u$E,u$R=u$O+u$O,u$m=u$b*u$A,u$Q=u$E*u$A,u$T=u$E*u$c,u$$=u$O*u$A,u$e=u$O*u$c,u$K=u$O*u$R,u$o=u$q*u$A,u$S=u$q*u$c,u$M=u$q*u$R;u$t[0]=1-u$T-u$K,u$t[1]=u$Q+u$M,u$t[2]=u$$-u$S,u$t[3]=0,u$t[4]=u$Q-u$M,u$t[5]=1-u$m-u$K,u$t[6]=u$e+u$o,u$t[7]=0,u$t[8]=u$$+u$S,u$t[9]=u$e-u$o,u$t[10]=1-u$m-u$T,u$t[11]=0,u$t[12]=0,u$t[13]=0,u$t[14]=0,u$t[15]=1},u$C.createAffineTransformation=function(u$W,u$j,u$t,u$d){var u$b=u$W.elements,u$E=u$j.elements,u$O=u$t.elements,u$q=u$d.elements,u$A=u$E[0],u$c=u$E[1],u$R=u$E[2],u$m=u$E[3],u$Q=u$A+u$A,u$T=u$c+u$c,u$$=u$R+u$R,u$e=u$A*u$Q,u$K=u$A*u$T,u$o=u$A*u$$,u$S=u$c*u$T,u$M=u$c*u$$,u$Z=u$R*u$$,u$X=u$m*u$Q,u$_=u$m*u$T,u$N=u$m*u$$,u$z=u$O[0],u$C=u$O[1],u$L=u$O[2];u$q[0]=(1-(u$S+u$Z))*u$z,u$q[1]=(u$K+u$N)*u$z,u$q[2]=(u$o-u$_)*u$z,u$q[3]=0,u$q[4]=(u$K-u$N)*u$C,u$q[5]=(1-(u$e+u$Z))*u$C,u$q[6]=(u$M+u$X)*u$C,u$q[7]=0,u$q[8]=(u$o+u$_)*u$L,u$q[9]=(u$M-u$X)*u$L,u$q[10]=(1-(u$e+u$S))*u$L,u$q[11]=0,u$q[12]=u$b[0],u$q[13]=u$b[1],u$q[14]=u$b[2],u$q[15]=1},u$C.createLookAt=function(u$W,u$j,u$t,u$d){var u$b=u$d.elements,u$E=u$C._tempVector0,u$O=u$C._tempVector1,u$q=u$C._tempVector2;u$Oj.subtract(u$W,u$j,u$q),u$Oj.normalize(u$q,u$q),u$Oj.cross(u$t,u$q,u$E),u$Oj.normalize(u$E,u$E),u$Oj.cross(u$q,u$E,u$O),u$d.identity(),u$b[0]=u$E.x,u$b[4]=u$E.y,u$b[8]=u$E.z,u$b[1]=u$O.x,u$b[5]=u$O.y,u$b[9]=u$O.z,u$b[2]=u$q.x,u$b[6]=u$q.y,u$b[10]=u$q.z,u$b[12]=-u$Oj.dot(u$E,u$W),u$b[13]=-u$Oj.dot(u$O,u$W),u$b[14]=-u$Oj.dot(u$q,u$W)},u$C.createPerspective=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$b.elements,u$O=1/Math.tan(u$W/2),u$q=1/(u$t-u$d);u$E[0]=u$O/u$j,u$E[5]=u$O,u$E[10]=(u$d+u$t)*u$q,u$E[11]=-1,u$E[14]=2*u$d*u$t*u$q,u$E[1]=u$E[2]=u$E[3]=u$E[4]=u$E[6]=u$E[7]=u$E[8]=u$E[9]=u$E[12]=u$E[13]=u$E[15]=0},u$C.createOrthoOffCenterRH=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){var u$q=u$O.elements,u$A=1/(u$W-u$j),u$c=1/(u$t-u$d),u$R=1/(u$b-u$E);u$q[1]=u$q[2]=u$q[3]=u$q[4]=u$q[6]=u$q[7]=u$q[8]=u$q[9]=u$q[11]=0,u$q[15]=1,u$q[0]=-2*u$A,u$q[5]=-2*u$c,u$q[10]=2*u$R,u$q[12]=(u$W+u$j)*u$A,u$q[13]=(u$d+u$t)*u$c,u$q[14]=(u$E+u$b)*u$R},u$C.translation=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements;u$d[0]=u$d[5]=u$d[10]=u$d[15]=1,u$d[12]=u$t[0],u$d[13]=u$t[1],u$d[14]=u$t[2]},u$m(u$C,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new u$C},"_tempVector0",function(){return this._tempVector0=new u$Oj},"_tempVector1",function(){return this._tempVector1=new u$Oj},"_tempVector2",function(){return this._tempVector2=new u$Oj},"_tempQuaternion",function(){return this._tempQuaternion=new u$tj},"DEFAULT",function(){return this.DEFAULT=new u$C},"ZERO",function(){return this.ZERO=new u$C(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),u$C}(),u$jj=(function(){function u$M(u$W,u$j){this.extents=null,this.transformation=null,this.extents=u$W,this.transformation=u$j}u$T(u$M,"laya.d3.math.OrientedBoundBox");var u$W=u$M.prototype;u$W.getCorners=function(u$W){var u$j=u$M._tempV30.elements,u$t=u$M._tempV31.elements,u$d=u$M._tempV32.elements,u$b=this.extents.elements;u$j[0]=u$b[0],u$j[1]=u$j[2]=0,u$t[1]=u$b[1],u$t[0]=u$t[2]=0,u$d[2]=u$b[2],u$d[0]=u$d[1]=0,u$Oj.TransformNormal(u$M._tempV30,this.transformation,u$M._tempV30),u$Oj.TransformNormal(u$M._tempV31,this.transformation,u$M._tempV31),u$Oj.TransformNormal(u$M._tempV32,this.transformation,u$M._tempV32);var u$E=u$M._tempV33;this.transformation.getTranslationVector(u$E),u$W.length=8,u$Oj.add(u$E,u$M._tempV30,u$M._tempV34),u$Oj.add(u$M._tempV34,u$M._tempV31,u$M._tempV34),u$Oj.add(u$M._tempV34,u$M._tempV32,u$W[0]),u$Oj.add(u$E,u$M._tempV30,u$M._tempV34),u$Oj.add(u$M._tempV34,u$M._tempV31,u$M._tempV34),u$Oj.subtract(u$M._tempV34,u$M._tempV32,u$W[1]),u$Oj.subtract(u$E,u$M._tempV30,u$M._tempV34),u$Oj.add(u$M._tempV34,u$M._tempV31,u$M._tempV34),u$Oj.subtract(u$M._tempV34,u$M._tempV32,u$W[2]),u$Oj.subtract(u$E,u$M._tempV30,u$M._tempV34),u$Oj.add(u$M._tempV34,u$M._tempV31,u$M._tempV34),u$Oj.add(u$M._tempV34,u$M._tempV32,u$W[3]),u$Oj.add(u$E,u$M._tempV30,u$M._tempV34),u$Oj.subtract(u$M._tempV34,u$M._tempV31,u$M._tempV34),u$Oj.add(u$M._tempV34,u$M._tempV32,u$W[4]),u$Oj.add(u$E,u$M._tempV30,u$M._tempV34),u$Oj.subtract(u$M._tempV34,u$M._tempV31,u$M._tempV34),u$Oj.subtract(u$M._tempV34,u$M._tempV32,u$W[5]),u$Oj.subtract(u$E,u$M._tempV30,u$M._tempV34),u$Oj.subtract(u$M._tempV34,u$M._tempV31,u$M._tempV34),u$Oj.subtract(u$M._tempV34,u$M._tempV32,u$W[6]),u$Oj.subtract(u$E,u$M._tempV30,u$M._tempV34),u$Oj.subtract(u$M._tempV34,u$M._tempV31,u$M._tempV34),u$Oj.add(u$M._tempV34,u$M._tempV32,u$W[7])},u$W.transform=function(u$W){u$Wj.multiply(this.transformation,u$W,this.transformation)},u$W.scale=function(u$W){u$Oj.multiply(this.extents,u$W,this.extents)},u$W.translate=function(u$W){this.transformation.getTranslationVector(u$M._tempV30),u$Oj.add(u$M._tempV30,u$W,u$M._tempV31),this.transformation.setTranslationVector(u$M._tempV31)},u$W.Size=function(u$W){u$Oj.scale(this.extents,2,u$W)},u$W.getSize=function(u$W){var u$j=this.extents.elements;u$M._tempV30.x=u$j[0],u$M._tempV31.y=u$j[1],u$M._tempV32.z=u$j[2],u$Oj.TransformNormal(u$M._tempV30,this.transformation,u$M._tempV30),u$Oj.TransformNormal(u$M._tempV31,this.transformation,u$M._tempV31),u$Oj.TransformNormal(u$M._tempV31,this.transformation,u$M._tempV32);var u$t=u$W.elements;u$t[0]=u$Oj.scalarLength(u$M._tempV30),u$t[1]=u$Oj.scalarLength(u$M._tempV31),u$t[2]=u$Oj.scalarLength(u$M._tempV32)},u$W.getSizeSquared=function(u$W){var u$j=this.extents.elements;u$M._tempV30.x=u$j[0],u$M._tempV31.y=u$j[1],u$M._tempV32.z=u$j[2],u$Oj.TransformNormal(u$M._tempV30,this.transformation,u$M._tempV30),u$Oj.TransformNormal(u$M._tempV31,this.transformation,u$M._tempV31),u$Oj.TransformNormal(u$M._tempV31,this.transformation,u$M._tempV32);var u$t=u$W.elements;u$t[0]=u$Oj.scalarLengthSquared(u$M._tempV30),u$t[1]=u$Oj.scalarLengthSquared(u$M._tempV31),u$t[2]=u$Oj.scalarLengthSquared(u$M._tempV32)},u$W.getCenter=function(u$W){this.transformation.getTranslationVector(u$W)},u$W.containsPoint=function(u$W){var u$j=this.extents.elements,u$t=u$j[0],u$d=u$j[1],u$b=u$j[2];this.transformation.invert(u$M._tempM0),u$Oj.transformCoordinate(u$W,u$M._tempM0,u$M._tempV30);var u$E=u$M._tempV30.elements,u$O=Math.abs(u$E[0]),u$q=Math.abs(u$E[1]),u$A=Math.abs(u$E[2]);return u$pW.nearEqual(u$O,u$t)&&u$pW.nearEqual(u$q,u$d)&&u$pW.nearEqual(u$A,u$b)?2:u$O<u$t&&u$q<u$d&&u$A<u$b?1:0},u$W.containsPoints=function(u$W){var u$j=this.extents.elements,u$t=u$j[0],u$d=u$j[1],u$b=u$j[2];this.transformation.invert(u$M._tempM0);for(var u$E=!0,u$O=!1,u$q=0;u$q<u$W.length;u$q++){u$Oj.transformCoordinate(u$W[u$q],u$M._tempM0,u$M._tempV30);var u$A=u$M._tempV30.elements,u$c=Math.abs(u$A[0]),u$R=Math.abs(u$A[1]),u$m=Math.abs(u$A[2]);u$pW.nearEqual(u$c,u$t)&&u$pW.nearEqual(u$R,u$d)&&u$pW.nearEqual(u$m,u$b)&&(u$O=!0),u$c<u$t&&u$R<u$d&&u$m<u$b?u$O=!0:u$E=!1}return u$E?1:u$O?2:0},u$W.containsSphere=function(u$W,u$j){void 0===u$j&&(u$j=!1);var u$t=this.extents.elements,u$d=u$t[0],u$b=u$t[1],u$E=u$t[2],u$O=u$W.radius;this.transformation.invert(u$M._tempM0),u$Oj.transformCoordinate(u$W.center,u$M._tempM0,u$M._tempV30);var u$q=NaN;if(u$q=u$j?u$O:(u$Oj.scale(u$Oj.UnitX,u$O,u$M._tempV31),u$Oj.TransformNormal(u$M._tempV31,u$M._tempM0,u$M._tempV31),u$Oj.scalarLength(u$M._tempV31)),u$Oj.scale(this.extents,-1,u$M._tempV32),u$Oj.Clamp(u$M._tempV30,u$M._tempV32,this.extents,u$M._tempV33),u$q*u$q<u$Oj.distanceSquared(u$M._tempV30,u$M._tempV33))return 0;var u$A=u$M._tempV30.elements,u$c=u$A[0],u$R=u$A[1],u$m=u$A[2],u$Q=u$M._tempV32.elements,u$T=u$Q[0],u$$=u$Q[1],u$e=u$Q[2];return u$T+u$q<=u$c&&u$c<=u$d-u$q&&u$q<u$d-u$T&&u$$+u$q<=u$R&&u$R<=u$b-u$q&&u$q<u$b-u$$&&u$e+u$q<=u$m&&u$m<=u$E-u$q&&u$q<u$E-u$e?1:2},u$W.containsOrientedBoundBox=function(u$W){var u$j=0,u$t=0;u$W.getCorners(u$M._corners);var u$d=this.containsPoints(u$M._corners);if(0!=u$d)return u$d;var u$b=this.extents.elements;u$W.extents.cloneTo(u$M._tempV35);var u$E=u$M._tempV35.elements;u$M._getRows(this.transformation,u$M._rows1),u$M._getRows(u$W.transformation,u$M._rows2);var u$O=NaN;for(u$j=0;u$j<4;u$j++)for(u$t=0;u$t<4;u$t++)3==u$j||3==u$t?(u$M._tempM0.setElementByRowColumn(u$j,u$t,0),u$M._tempM1.setElementByRowColumn(u$j,u$t,0)):(u$O=u$Oj.dot(u$M._rows1[u$j],u$M._rows2[u$t]),u$M._tempM0.setElementByRowColumn(u$j,u$t,u$O),u$M._tempM1.setElementByRowColumn(u$j,u$t,Math.abs(u$O)));u$W.getCenter(u$M._tempV34),this.getCenter(u$M._tempV36),u$Oj.subtract(u$M._tempV34,u$M._tempV36,u$M._tempV30);var u$q=u$M._tempV31.elements;u$q[0]=u$Oj.dot(u$M._tempV30,u$M._rows1[0]),u$q[1]=u$Oj.dot(u$M._tempV30,u$M._rows1[1]),u$q[2]=u$Oj.dot(u$M._tempV30,u$M._rows1[2]);var u$A=u$M._tempV32.elements,u$c=u$M._tempV33.elements;for(u$j=0;u$j<3;u$j++)if(u$A[0]=u$M._tempM1.getElementByRowColumn(u$j,0),u$A[1]=u$M._tempM1.getElementByRowColumn(u$j,1),u$A[2]=u$M._tempM1.getElementByRowColumn(u$j,2),u$b[u$j]+u$Oj.dot(u$M._tempV35,u$M._tempV32)<Math.abs(u$q[u$j]))return 0;for(u$t=0;u$t<3;u$t++)if(u$A[0]=u$M._tempM1.getElementByRowColumn(0,u$t),u$A[1]=u$M._tempM1.getElementByRowColumn(1,u$t),u$A[2]=u$M._tempM1.getElementByRowColumn(2,u$t),u$c[0]=u$M._tempM0.getElementByRowColumn(0,u$t),u$c[1]=u$M._tempM0.getElementByRowColumn(1,u$t),u$c[2]=u$M._tempM0.getElementByRowColumn(2,u$t),u$Oj.dot(this.extents,u$M._tempV32)+u$E[u$t]<Math.abs(u$Oj.dot(u$M._tempV31,u$M._tempV33)))return 0;for(u$j=0;u$j<3;u$j++)for(u$t=0;u$t<3;u$t++){var u$R=(u$j+1)%3,u$m=(u$j+2)%3,u$Q=(u$t+1)%3,u$T=(u$t+2)%3;if(u$b[u$R]*u$M._tempM1.getElementByRowColumn(u$m,u$t)+u$b[u$m]*u$M._tempM1.getElementByRowColumn(u$R,u$t)+(u$E[u$Q]*u$M._tempM1.getElementByRowColumn(u$j,u$T)+u$E[u$T]*u$M._tempM1.getElementByRowColumn(u$j,u$Q))<Math.abs(u$q[u$m]*u$M._tempM0.getElementByRowColumn(u$R,u$t)-u$q[u$R]*u$M._tempM0.getElementByRowColumn(u$m,u$t)))return 0}return 2},u$W.containsLine=function(u$W,u$j){u$M._corners[0]=u$W,u$M._corners[1]=u$j;var u$t=this.containsPoints(u$M._corners);if(0!=u$t)return u$t;var u$d=this.extents.elements,u$b=u$d[0],u$E=u$d[1],u$O=u$d[2];this.transformation.invert(u$M._tempM0),u$Oj.transformCoordinate(u$W,u$M._tempM0,u$M._tempV30),u$Oj.transformCoordinate(u$j,u$M._tempM0,u$M._tempV31),u$Oj.add(u$M._tempV30,u$M._tempV31,u$M._tempV32),u$Oj.scale(u$M._tempV32,.5,u$M._tempV32),u$Oj.subtract(u$M._tempV30,u$M._tempV32,u$M._tempV33);var u$q=u$M._tempV33.elements,u$A=u$q[0],u$c=u$q[1],u$R=u$q[2],u$m=u$M._tempV34.elements,u$Q=u$m[0]=Math.abs(u$q[0]),u$T=u$m[1]=Math.abs(u$q[1]),u$$=u$m[2]=Math.abs(u$q[2]),u$e=u$M._tempV32.elements,u$K=u$e[0],u$o=u$e[1],u$S=u$e[2];return Math.abs(u$K)>u$b+u$Q?0:Math.abs(u$o)>u$E+u$T?0:Math.abs(u$S)>u$O+u$$?0:Math.abs(u$o*u$R-u$S*u$c)>u$E*u$$+u$O*u$T?0:Math.abs(u$K*u$R-u$S*u$A)>u$b*u$$+u$O*u$Q?0:Math.abs(u$K*u$c-u$o*u$A)>u$b*u$T+u$E*u$Q?0:2},u$W.containsBoundBox=function(u$W){var u$j=0,u$t=0,u$d=u$W.min,u$b=u$W.max;u$W.getCorners(u$M._corners);var u$E=this.containsPoints(u$M._corners);if(0!=u$E)return u$E;u$Oj.subtract(u$b,u$d,u$M._tempV30),u$Oj.scale(u$M._tempV30,.5,u$M._tempV30),u$Oj.add(u$d,u$M._tempV30,u$M._tempV30),u$Oj.subtract(u$b,u$M._tempV30,u$M._tempV31);var u$O=this.extents.elements,u$q=u$M._tempV31.elements;u$M._getRows(this.transformation,u$M._rows1),this.transformation.invert(u$M._tempM0);for(u$j=0;u$j<3;u$j++)for(u$t=0;u$t<3;u$t++)u$M._tempM1.setElementByRowColumn(u$j,u$t,Math.abs(u$M._tempM0.getElementByRowColumn(u$j,u$t)));this.getCenter(u$M._tempV35),u$Oj.subtract(u$M._tempV30,u$M._tempV35,u$M._tempV32);var u$A=u$M._tempV31.elements;u$A[0]=u$Oj.dot(u$M._tempV32,u$M._rows1[0]),u$A[1]=u$Oj.dot(u$M._tempV32,u$M._rows1[1]),u$A[2]=u$Oj.dot(u$M._tempV32,u$M._rows1[2]);var u$c=u$M._tempV33.elements,u$R=u$M._tempV34.elements;for(u$j=0;u$j<3;u$j++)if(u$c[0]=u$M._tempM1.getElementByRowColumn(u$j,0),u$c[1]=u$M._tempM1.getElementByRowColumn(u$j,1),u$c[2]=u$M._tempM1.getElementByRowColumn(u$j,2),u$O[u$j]+u$Oj.dot(u$M._tempV31,u$M._tempV33)<Math.abs(u$A[u$j]))return 0;for(u$t=0;u$t<3;u$t++)if(u$c[0]=u$M._tempM1.getElementByRowColumn(0,u$t),u$c[1]=u$M._tempM1.getElementByRowColumn(1,u$t),u$c[2]=u$M._tempM1.getElementByRowColumn(2,u$t),u$R[0]=u$M._tempM0.getElementByRowColumn(0,u$t),u$R[1]=u$M._tempM0.getElementByRowColumn(1,u$t),u$R[2]=u$M._tempM0.getElementByRowColumn(2,u$t),u$Oj.dot(this.extents,u$M._tempV33)+u$q[u$t]<Math.abs(u$Oj.dot(u$M._tempV31,u$M._tempV34)))return 0;for(u$j=0;u$j<3;u$j++)for(u$t=0;u$t<3;u$t++){var u$m=(u$j+1)%3,u$Q=(u$j+2)%3,u$T=(u$t+1)%3,u$$=(u$t+2)%3;if(u$O[u$m]*u$M._tempM1.getElementByRowColumn(u$Q,u$t)+u$O[u$Q]*u$M._tempM1.getElementByRowColumn(u$m,u$t)+(u$q[u$T]*u$M._tempM1.getElementByRowColumn(u$j,u$$)+u$q[u$$]*u$M._tempM1.getElementByRowColumn(u$j,u$T))<Math.abs(u$A[u$Q]*u$M._tempM0.getElementByRowColumn(u$m,u$t)-u$A[u$m]*u$M._tempM0.getElementByRowColumn(u$Q,u$t)))return 0}return 2},u$W.intersectsRay=function(u$W,u$j){u$Oj.scale(this.extents,-1,u$M._tempV30),this.transformation.invert(u$M._tempM0),u$Oj.TransformNormal(u$W.direction,u$M._tempM0,u$M._ray.direction),u$Oj.transformCoordinate(u$W.origin,u$M._tempM0,u$M._ray.origin),u$M._boxBound1.min=u$M._tempV30,u$M._boxBound1.max=this.extents;var u$t=Collision.intersectsRayAndBoxRP(u$M._ray,u$M._boxBound1,u$j);return-1!==u$t&&u$Oj.transformCoordinate(u$j,this.transformation,u$j),u$t},u$W._getLocalCorners=function(u$W){u$W.length=8;var u$j=this.extents.elements;u$M._tempV30.x=u$j[0],u$M._tempV31.y=u$j[1],u$M._tempV32.z=u$j[2],u$Oj.add(u$M._tempV30,u$M._tempV31,u$M._tempV33),u$Oj.add(u$M._tempV33,u$M._tempV32,u$W[0]),u$Oj.add(u$M._tempV30,u$M._tempV31,u$M._tempV33),u$Oj.subtract(u$M._tempV33,u$M._tempV32,u$W[1]),u$Oj.subtract(u$M._tempV31,u$M._tempV30,u$M._tempV33),u$Oj.subtract(u$M._tempV33,u$M._tempV30,u$W[2]),u$Oj.subtract(u$M._tempV31,u$M._tempV30,u$M._tempV33),u$Oj.add(u$M._tempV33,u$M._tempV32,u$W[3]),u$Oj.subtract(u$M._tempV30,u$M._tempV31,u$M._tempV33),u$Oj.add(u$M._tempV33,u$M._tempV32,u$W[4]),u$Oj.subtract(u$M._tempV30,u$M._tempV31,u$M._tempV33),u$Oj.subtract(u$M._tempV33,u$M._tempV32,u$W[5]),u$Oj.scale(u$W[0],-1,u$W[6]),u$Oj.subtract(u$M._tempV32,u$M._tempV30,u$M._tempV33),u$Oj.subtract(u$M._tempV33,u$M._tempV31,u$W[7])},u$W.equals=function(u$W){return this.extents==u$W.extents&&this.transformation==u$W.transformation},u$W.cloneTo=function(u$W){var u$j=u$W;this.extents.cloneTo(u$j.extents),this.transformation.cloneTo(u$j.transformation)},u$M.createByBoundBox=function(u$W,u$j){var u$t=u$W.min,u$d=u$W.max;u$Oj.subtract(u$d,u$t,u$M._tempV30),u$Oj.scale(u$M._tempV30,.5,u$M._tempV30),u$Oj.add(u$t,u$M._tempV30,u$M._tempV31),u$Oj.subtract(u$d,u$M._tempV31,u$M._tempV32),u$Wj.translation(u$M._tempV31,u$M._tempM0);var u$b=u$M._tempV32.clone(),u$E=u$M._tempM0.clone();u$j.extents=u$b,u$j.transformation=u$E},u$M.createByMinAndMaxVertex=function(u$W,u$j){return u$Oj.subtract(u$j,u$W,u$M._tempV30),u$Oj.scale(u$M._tempV30,.5,u$M._tempV30),u$Oj.add(u$W,u$M._tempV30,u$M._tempV31),u$Oj.subtract(u$j,u$M._tempV31,u$M._tempV32),u$Wj.translation(u$M._tempV31,u$M._tempM0),new u$M(u$M._tempV32,u$M._tempM0)},u$M._getRows=function(u$W,u$j){u$j.length=3;var u$t=u$W.elements,u$d=u$j[0].elements;u$d[0]=u$t[0],u$d[1]=u$t[1],u$d[2]=u$t[2];var u$b=u$j[1].elements;u$b[0]=u$t[4],u$b[1]=u$t[5],u$b[2]=u$t[6];var u$E=u$j[2].elements;u$E[0]=u$t[8],u$E[1]=u$t[9],u$E[2]=u$t[10]},u$M.getObbtoObbMatrix4x4=function(u$W,u$j,u$t,u$d){var u$b=u$W.transformation,u$E=u$j.transformation;if(u$t){u$M._getRows(u$b,u$M._rows1),u$M._getRows(u$E,u$M._rows2);for(var u$O=0;u$O<3;u$O++)for(var u$q=0;u$q<3;u$q++)u$d.setElementByRowColumn(u$O,u$q,u$Oj.dot(u$M._rows2[u$O],u$M._rows1[u$q]));u$j.getCenter(u$M._tempV30),u$W.getCenter(u$M._tempV31),u$Oj.subtract(u$M._tempV30,u$M._tempV31,u$M._tempV32);var u$A=u$d.elements;u$A[12]=u$Oj.dot(u$M._tempV32,u$M._rows1[0]),u$A[13]=u$Oj.dot(u$M._tempV32,u$M._rows1[1]),u$A[14]=u$Oj.dot(u$M._tempV32,u$M._rows1[2]),u$A[15]=1}else u$b.invert(u$M._tempM0),u$Wj.multiply(u$E,u$M._tempM0,u$d)},u$M.merge=function(u$W,u$j,u$t){var u$d=u$W.extents,u$b=u$W.transformation;u$M.getObbtoObbMatrix4x4(u$W,u$j,u$t,u$M._tempM0),u$j._getLocalCorners(u$M._corners),u$Oj.transformCoordinate(u$M._corners[0],u$M._tempM0,u$M._corners[0]),u$Oj.transformCoordinate(u$M._corners[1],u$M._tempM0,u$M._corners[1]),u$Oj.transformCoordinate(u$M._corners[2],u$M._tempM0,u$M._corners[2]),u$Oj.transformCoordinate(u$M._corners[3],u$M._tempM0,u$M._corners[3]),u$Oj.transformCoordinate(u$M._corners[4],u$M._tempM0,u$M._corners[4]),u$Oj.transformCoordinate(u$M._corners[5],u$M._tempM0,u$M._corners[5]),u$Oj.transformCoordinate(u$M._corners[6],u$M._tempM0,u$M._corners[6]),u$Oj.transformCoordinate(u$M._corners[7],u$M._tempM0,u$M._corners[7]),u$Oj.scale(u$d,-1,u$M._boxBound1.min),u$d.cloneTo(u$M._boxBound1.max),u$BW.createfromPoints(u$M._corners,u$M._boxBound2),u$BW.merge(u$M._boxBound2,u$M._boxBound1,u$M._boxBound3);var u$E=u$M._boxBound3.min,u$O=u$M._boxBound3.max;u$Oj.subtract(u$O,u$E,u$M._tempV30),u$Oj.scale(u$M._tempV30,.5,u$M._tempV30),u$Oj.add(u$E,u$M._tempV30,u$M._tempV32),u$Oj.subtract(u$O,u$M._tempV32,u$d),u$Oj.transformCoordinate(u$M._tempV32,u$b,u$M._tempV33)},u$m(u$M,["_tempV30",function(){return this._tempV30=new u$Oj},"_tempV31",function(){return this._tempV31=new u$Oj},"_tempV32",function(){return this._tempV32=new u$Oj},"_tempV33",function(){return this._tempV33=new u$Oj},"_tempV34",function(){return this._tempV34=new u$Oj},"_tempV35",function(){return this._tempV35=new u$Oj},"_tempV36",function(){return this._tempV36=new u$Oj},"_tempM0",function(){return this._tempM0=new u$Wj},"_tempM1",function(){return this._tempM1=new u$Wj},"_corners",function(){return this._corners=[new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj]},"_rows1",function(){return this._rows1=[new u$Oj,new u$Oj,new u$Oj]},"_rows2",function(){return this._rows2=[new u$Oj,new u$Oj,new u$Oj]},"_ray",function(){return this._ray=new u$bj(new u$Oj,new u$Oj)},"_boxBound1",function(){return this._boxBound1=new u$BW(new u$Oj,new u$Oj)},"_boxBound2",function(){return this._boxBound2=new u$BW(new u$Oj,new u$Oj)},"_boxBound3",function(){return this._boxBound3=new u$BW(new u$Oj,new u$Oj)}])}(),function(){function u$X(u$W,u$j){this.normal=null,this.distance=NaN,void 0===u$j&&(u$j=0),this.normal=u$W,this.distance=u$j}return u$T(u$X,"laya.d3.math.Plane"),u$X.prototype.normalize=function(){var u$W=this.normal.elements,u$j=u$W[0],u$t=u$W[1],u$d=u$W[2],u$b=1/Math.sqrt(u$j*u$j+u$t*u$t+u$d*u$d);u$W[0]=u$j*u$b,u$W[1]=u$t*u$b,u$W[2]=u$d*u$b,this.distance*=u$b},u$X.createPlaneBy3P=function(u$W,u$j,u$t){var u$d=u$W.elements,u$b=u$j.elements,u$E=u$t.elements,u$O=u$b[0]-u$d[0],u$q=u$b[1]-u$d[1],u$A=u$b[2]-u$d[2],u$c=u$E[0]-u$d[0],u$R=u$E[1]-u$d[1],u$m=u$E[2]-u$d[2],u$Q=u$q*u$m-u$A*u$R,u$T=u$A*u$c-u$O*u$m,u$$=u$O*u$R-u$q*u$c,u$e=1/Math.sqrt(u$Q*u$Q+u$T*u$T+u$$*u$$),u$K=u$Q*u$e,u$o=u$T*u$e,u$S=u$$*u$e,u$M=u$X._TEMPVec3.elements;u$M[0]=u$K,u$M[1]=u$o,u$M[2]=u$S;var u$Z=-(u$K*u$d[0]+u$o*u$d[1]+u$S*u$d[2]);return new u$X(u$X._TEMPVec3,u$Z)},u$X.PlaneIntersectionType_Back=0,u$X.PlaneIntersectionType_Front=1,u$X.PlaneIntersectionType_Intersecting=2,u$m(u$X,["_TEMPVec3",function(){return this._TEMPVec3=new u$Oj}]),u$X}()),u$tj=function(){function u$b(u$W,u$j,u$t,u$d){this.elements=new Float32Array(4),void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=1),this.elements[0]=u$W,this.elements[1]=u$j,this.elements[2]=u$t,this.elements[3]=u$d}u$T(u$b,"laya.d3.math.Quaternion");var u$W=u$b.prototype;return u$X.imps(u$W,{"laya.d3.core.IClone":!0}),u$W.scaling=function(u$W,u$j){var u$t=u$j.elements,u$d=this.elements;u$t[0]=u$d[0]*u$W,u$t[1]=u$d[1]*u$W,u$t[2]=u$d[2]*u$W,u$t[3]=u$d[3]*u$W},u$W.normalize=function(u$W){var u$j=u$W.elements,u$t=this.elements,u$d=u$t[0],u$b=u$t[1],u$E=u$t[2],u$O=u$t[3],u$q=u$d*u$d+u$b*u$b+u$E*u$E+u$O*u$O;0<u$q&&(u$q=1/Math.sqrt(u$q),u$j[0]=u$d*u$q,u$j[1]=u$b*u$q,u$j[2]=u$E*u$q,u$j[3]=u$O*u$q)},u$W.length=function(){var u$W=this.elements,u$j=u$W[0],u$t=u$W[1],u$d=u$W[2],u$b=u$W[3];return Math.sqrt(u$j*u$j+u$t*u$t+u$d*u$d+u$b*u$b)},u$W.rotateX=function(u$W,u$j){var u$t=u$j.elements,u$d=this.elements;u$W*=.5;var u$b=u$d[0],u$E=u$d[1],u$O=u$d[2],u$q=u$d[3],u$A=Math.sin(u$W),u$c=Math.cos(u$W);u$t[0]=u$b*u$c+u$q*u$A,u$t[1]=u$E*u$c+u$O*u$A,u$t[2]=u$O*u$c-u$E*u$A,u$t[3]=u$q*u$c-u$b*u$A},u$W.rotateY=function(u$W,u$j){var u$t=u$j.elements,u$d=this.elements;u$W*=.5;var u$b=u$d[0],u$E=u$d[1],u$O=u$d[2],u$q=u$d[3],u$A=Math.sin(u$W),u$c=Math.cos(u$W);u$t[0]=u$b*u$c-u$O*u$A,u$t[1]=u$E*u$c+u$q*u$A,u$t[2]=u$O*u$c+u$b*u$A,u$t[3]=u$q*u$c-u$E*u$A},u$W.rotateZ=function(u$W,u$j){var u$t=u$j.elements,u$d=this.elements;u$W*=.5;var u$b=u$d[0],u$E=u$d[1],u$O=u$d[2],u$q=u$d[3],u$A=Math.sin(u$W),u$c=Math.cos(u$W);u$t[0]=u$b*u$c+u$E*u$A,u$t[1]=u$E*u$c-u$b*u$A,u$t[2]=u$O*u$c+u$q*u$A,u$t[3]=u$q*u$c-u$O*u$A},u$W.getYawPitchRoll=function(u$W){u$Oj.transformQuat(u$Oj.ForwardRH,this,u$b.TEMPVector31),u$Oj.transformQuat(u$Oj.Up,this,u$b.TEMPVector32);var u$j=u$b.TEMPVector32.elements;u$b.angleTo(u$Oj.ZERO,u$b.TEMPVector31,u$b.TEMPVector33);var u$t=u$b.TEMPVector33.elements;u$t[0]==Math.PI/2?(u$t[1]=u$b.arcTanAngle(u$j[2],u$j[0]),u$t[2]=0):u$t[0]==-Math.PI/2?(u$t[1]=u$b.arcTanAngle(-u$j[2],-u$j[0]),u$t[2]=0):(u$Wj.createRotationY(-u$t[1],u$b.TEMPMatrix0),u$Wj.createRotationX(-u$t[0],u$b.TEMPMatrix1),u$Oj.transformCoordinate(u$b.TEMPVector32,u$b.TEMPMatrix0,u$b.TEMPVector32),u$Oj.transformCoordinate(u$b.TEMPVector32,u$b.TEMPMatrix1,u$b.TEMPVector32),u$t[2]=u$b.arcTanAngle(u$j[1],-u$j[0])),u$t[1]<=-Math.PI&&(u$t[1]=Math.PI),u$t[2]<=-Math.PI&&(u$t[2]=Math.PI),u$t[1]>=Math.PI&&u$t[2]>=Math.PI&&(u$t[1]=0,u$t[2]=0,u$t[0]=Math.PI-u$t[0]);var u$d=u$W.elements;u$d[0]=u$t[1],u$d[1]=u$t[0],u$d[2]=u$t[2]},u$W.invert=function(u$W){var u$j=u$W.elements,u$t=this.elements,u$d=u$t[0],u$b=u$t[1],u$E=u$t[2],u$O=u$t[3],u$q=u$d*u$d+u$b*u$b+u$E*u$E+u$O*u$O,u$A=u$q?1/u$q:0;u$j[0]=-u$d*u$A,u$j[1]=-u$b*u$A,u$j[2]=-u$E*u$A,u$j[3]=u$O*u$A},u$W.identity=function(){var u$W=this.elements;u$W[0]=0,u$W[1]=0,u$W[2]=0,u$W[3]=1},u$W.fromArray=function(u$W,u$j){void 0===u$j&&(u$j=0),this.elements[0]=u$W[u$j+0],this.elements[1]=u$W[u$j+1],this.elements[2]=u$W[u$j+2],this.elements[3]=u$W[u$j+3]},u$W.cloneTo=function(u$W){var u$j,u$t,u$d;if((u$t=this.elements)!==(u$d=u$W.elements))for(u$j=0;u$j<4;++u$j)u$d[u$j]=u$t[u$j]},u$W.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$W.equals=function(u$W){var u$j=this.elements,u$t=u$W.elements;return u$pW.nearEqual(u$j[0],u$t[0])&&u$pW.nearEqual(u$j[1],u$t[1])&&u$pW.nearEqual(u$j[2],u$t[2])&&u$pW.nearEqual(u$j[3],u$t[3])},u$W.lengthSquared=function(){var u$W=this.elements[0],u$j=this.elements[1],u$t=this.elements[2],u$d=this.elements[3];return u$W*u$W+u$j*u$j+u$t*u$t+u$d*u$d},u$$(0,u$W,"x",function(){return this.elements[0]}),u$$(0,u$W,"y",function(){return this.elements[1]}),u$$(0,u$W,"z",function(){return this.elements[2]}),u$$(0,u$W,"w",function(){return this.elements[3]}),u$b.createFromYawPitchRoll=function(u$W,u$j,u$t,u$d){var u$b=.5*u$t,u$E=.5*u$j,u$O=.5*u$W,u$q=Math.sin(u$b),u$A=Math.cos(u$b),u$c=Math.sin(u$E),u$R=Math.cos(u$E),u$m=Math.sin(u$O),u$Q=Math.cos(u$O),u$T=u$d.elements;u$T[0]=u$Q*u$c*u$A+u$m*u$R*u$q,u$T[1]=u$m*u$R*u$A-u$Q*u$c*u$q,u$T[2]=u$Q*u$R*u$q-u$m*u$c*u$A,u$T[3]=u$Q*u$R*u$A+u$m*u$c*u$q},u$b.multiply=function(u$W,u$j,u$t){var u$d=u$W.elements,u$b=u$j.elements,u$E=u$t.elements,u$O=u$d[0],u$q=u$d[1],u$A=u$d[2],u$c=u$d[3],u$R=u$b[0],u$m=u$b[1],u$Q=u$b[2],u$T=u$b[3],u$$=u$q*u$Q-u$A*u$m,u$e=u$A*u$R-u$O*u$Q,u$K=u$O*u$m-u$q*u$R,u$o=u$O*u$R+u$q*u$m+u$A*u$Q;u$E[0]=u$O*u$T+u$R*u$c+u$$,u$E[1]=u$q*u$T+u$m*u$c+u$e,u$E[2]=u$A*u$T+u$Q*u$c+u$K,u$E[3]=u$c*u$T-u$o},u$b.arcTanAngle=function(u$W,u$j){return 0==u$W?1==u$j?Math.PI/2:-Math.PI/2:0<u$W?Math.atan(u$j/u$W):u$W<0?0<u$j?Math.atan(u$j/u$W)+Math.PI:Math.atan(u$j/u$W)-Math.PI:0},u$b.angleTo=function(u$W,u$j,u$t){u$Oj.subtract(u$j,u$W,u$b.TEMPVector30),u$Oj.normalize(u$b.TEMPVector30,u$b.TEMPVector30),u$t.elements[0]=Math.asin(u$b.TEMPVector30.y),u$t.elements[1]=u$b.arcTanAngle(-u$b.TEMPVector30.z,-u$b.TEMPVector30.x)},u$b.createFromAxisAngle=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements;u$j*=.5;var u$E=Math.sin(u$j);u$d[0]=u$E*u$b[0],u$d[1]=u$E*u$b[1],u$d[2]=u$E*u$b[2],u$d[3]=Math.cos(u$j)},u$b.createFromMatrix3x3=function(u$W,u$j){var u$t,u$d=u$j.elements,u$b=u$W.elements,u$E=u$b[0]+u$b[4]+u$b[8];if(0<u$E)u$t=Math.sqrt(u$E+1),u$d[3]=.5*u$t,u$t=.5/u$t,u$d[0]=(u$b[5]-u$b[7])*u$t,u$d[1]=(u$b[6]-u$b[2])*u$t,u$d[2]=(u$b[1]-u$b[3])*u$t;else{var u$O=0;u$b[4]>u$b[0]&&(u$O=1),u$b[8]>u$b[3*u$O+u$O]&&(u$O=2);var u$q=(u$O+1)%3,u$A=(u$O+2)%3;u$t=Math.sqrt(u$b[3*u$O+u$O]-u$b[3*u$q+u$q]-u$b[3*u$A+u$A]+1),u$d[u$O]=.5*u$t,u$t=.5/u$t,u$d[3]=(u$b[3*u$q+u$A]-u$b[3*u$A+u$q])*u$t,u$d[u$q]=(u$b[3*u$q+u$O]+u$b[3*u$O+u$q])*u$t,u$d[u$A]=(u$b[3*u$A+u$O]+u$b[3*u$O+u$A])*u$t}},u$b.createFromMatrix4x4=function(u$W,u$j){var u$t,u$d,u$b=u$W.elements,u$E=u$j.elements,u$O=u$b[0]+u$b[5]+u$b[10];0<u$O?(u$t=Math.sqrt(u$O+1),u$E[3]=.5*u$t,u$t=.5/u$t,u$E[0]=(u$b[6]-u$b[9])*u$t,u$E[1]=(u$b[8]-u$b[2])*u$t,u$E[2]=(u$b[1]-u$b[4])*u$t):u$b[0]>=u$b[5]&&u$b[0]>=u$b[10]?(u$d=.5/(u$t=Math.sqrt(1+u$b[0]-u$b[5]-u$b[10])),u$E[0]=.5*u$t,u$E[1]=(u$b[1]+u$b[4])*u$d,u$E[2]=(u$b[2]+u$b[8])*u$d,u$E[3]=(u$b[6]-u$b[9])*u$d):u$b[5]>u$b[10]?(u$d=.5/(u$t=Math.sqrt(1+u$b[5]-u$b[0]-u$b[10])),u$E[0]=(u$b[4]+u$b[1])*u$d,u$E[1]=.5*u$t,u$E[2]=(u$b[9]+u$b[6])*u$d,u$E[3]=(u$b[8]-u$b[2])*u$d):(u$d=.5/(u$t=Math.sqrt(1+u$b[10]-u$b[0]-u$b[5])),u$E[0]=(u$b[8]+u$b[2])*u$d,u$E[1]=(u$b[9]+u$b[6])*u$d,u$E[2]=.5*u$t,u$E[3]=(u$b[1]-u$b[4])*u$d)},u$b.slerp=function(u$W,u$j,u$t,u$d){var u$b,u$E,u$O,u$q,u$A,u$c=u$W.elements,u$R=u$j.elements,u$m=u$d.elements,u$Q=u$c[0],u$T=u$c[1],u$$=u$c[2],u$e=u$c[3],u$K=u$R[0],u$o=u$R[1],u$S=u$R[2],u$M=u$R[3];return(u$E=u$Q*u$K+u$T*u$o+u$$*u$S+u$e*u$M)<0&&(u$E=-u$E,u$K=-u$K,u$o=-u$o,u$S=-u$S,u$M=-u$M),u$A=1e-6<1-u$E?(u$b=Math.acos(u$E),u$O=Math.sin(u$b),u$q=Math.sin((1-u$t)*u$b)/u$O,Math.sin(u$t*u$b)/u$O):(u$q=1-u$t,u$t),u$m[0]=u$q*u$Q+u$A*u$K,u$m[1]=u$q*u$T+u$A*u$o,u$m[2]=u$q*u$$+u$A*u$S,u$m[3]=u$q*u$e+u$A*u$M,u$m},u$b.lerp=function(u$W,u$j,u$t,u$d){var u$b=u$d.elements,u$E=u$W.elements,u$O=u$j.elements,u$q=u$E[0],u$A=u$E[1],u$c=u$E[2],u$R=u$E[3];u$b[0]=u$q+u$t*(u$O[0]-u$q),u$b[1]=u$A+u$t*(u$O[1]-u$A),u$b[2]=u$c+u$t*(u$O[2]-u$c),u$b[3]=u$R+u$t*(u$O[3]-u$R)},u$b.add=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements;u$d[0]=u$b[0]+u$E[0],u$d[1]=u$b[1]+u$E[1],u$d[2]=u$b[2]+u$E[2],u$d[3]=u$b[3]+u$E[3]},u$b.dot=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements;return u$t[0]*u$d[0]+u$t[1]*u$d[1]+u$t[2]*u$d[2]+u$t[3]*u$d[3]},u$b.rotationLookAt=function(u$W,u$j,u$t){u$b.lookAt(u$Oj.ZERO,u$W,u$j,u$t)},u$b.lookAt=function(u$W,u$j,u$t,u$d){u$FW.lookAt(u$W,u$j,u$t,u$b._tempMatrix3x3),u$b.rotationMatrix(u$b._tempMatrix3x3,u$d)},u$b.invert=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements,u$b=u$W.lengthSquared();u$pW.isZero(u$b)||(u$b=1/u$b,u$d[0]=-u$t[0]*u$b,u$d[1]=-u$t[1]*u$b,u$d[2]=-u$t[2]*u$b,u$d[3]=u$t[3]*u$b)},u$b.rotationMatrix=function(u$W,u$j){var u$t=u$W.elements,u$d=u$t[0],u$b=u$t[1],u$E=u$t[2],u$O=u$t[3],u$q=u$t[4],u$A=u$t[5],u$c=u$t[6],u$R=u$t[7],u$m=u$t[8],u$Q=u$j.elements,u$T=NaN,u$$=NaN,u$e=u$d+u$q+u$m;0<u$e?(u$T=Math.sqrt(u$e+1),u$Q[3]=.5*u$T,u$T=.5/u$T,u$Q[0]=(u$A-u$R)*u$T,u$Q[1]=(u$c-u$E)*u$T,u$Q[2]=(u$b-u$O)*u$T):u$q<=u$d&&u$m<=u$d?(u$$=.5/(u$T=Math.sqrt(1+u$d-u$q-u$m)),u$Q[0]=.5*u$T,u$Q[1]=(u$b+u$O)*u$$,u$Q[2]=(u$E+u$c)*u$$,u$Q[3]=(u$A-u$R)*u$$):u$m<u$q?(u$$=.5/(u$T=Math.sqrt(1+u$q-u$d-u$m)),u$Q[0]=(u$O+u$b)*u$$,u$Q[1]=.5*u$T,u$Q[2]=(u$R+u$A)*u$$,u$Q[3]=(u$c-u$E)*u$$):(u$$=.5/(u$T=Math.sqrt(1+u$m-u$d-u$q)),u$Q[0]=(u$c+u$E)*u$$,u$Q[1]=(u$R+u$A)*u$$,u$Q[2]=.5*u$T,u$Q[3]=(u$b-u$O)*u$$)},u$b.DEFAULT=new u$b,u$m(u$b,["TEMPVector30",function(){return this.TEMPVector30=new u$Oj},"TEMPVector31",function(){return this.TEMPVector31=new u$Oj},"TEMPVector32",function(){return this.TEMPVector32=new u$Oj},"TEMPVector33",function(){return this.TEMPVector33=new u$Oj},"TEMPMatrix0",function(){return this.TEMPMatrix0=new u$Wj},"TEMPMatrix1",function(){return this.TEMPMatrix1=new u$Wj},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new u$FW},"NAN",function(){return this.NAN=new u$b(NaN,NaN,NaN,NaN)}]),u$b}(),u$dj=function(){function u$W(u$W){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=u$W,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}u$T(u$W,"laya.d3.math.Rand");var u$j=u$W.prototype;return u$j.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},u$j.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},u$j.getSignedFloat=function(){return 2*this.getFloat()-1},u$$(0,u$j,"seed",function(){return this.seeds[0]},function(u$W){this.seeds[0]=u$W,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),u$W.getFloatFromInt=function(u$W){return 1/8388607*(8388607&u$W)},u$W.getByteFromInt=function(u$W){return(8388607&u$W)>>>15},u$W}(),u$bj=(function(){function u$b(u$W){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(u$W instanceof Array)||4!==u$W.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|u$W[0],this._state0L=0|u$W[1],this._state1U=0|u$W[2],this._state1L=0|u$W[3]}u$T(u$b,"laya.d3.math.RandX");var u$W=u$b.prototype;u$W.randomint=function(){var u$W=this._state0U,u$j=this._state0L,u$t=this._state1U,u$d=this._state1L,u$b=(u$d>>>0)+(u$j>>>0),u$E=u$t+u$W+(u$b/2>>>31)>>>0,u$O=u$b>>>0,u$q=0,u$A=0;u$q=(u$W^=u$q=u$W<<23|(-512&u$j)>>>9)^(this._state0U=u$t),u$A=(u$j^=u$A=u$j<<23)^(this._state0L=u$d);u$q^=u$W>>>18,u$A^=u$j>>>18|(262143&u$W)<<14;return u$q^=u$t>>>5,u$A^=u$d>>>5|(31&u$t)<<27,this._state1U=u$q,this._state1L=u$A,[u$E,u$O]},u$W.random=function(){var u$W=this.randomint(),u$j=u$W[0],u$t=1023<<20|u$j>>>12,u$d=0|(u$W[1]>>>12|(4095&u$j)<<20);return u$b._CONVERTION_BUFFER.setUint32(0,u$t,!1),u$b._CONVERTION_BUFFER.setUint32(4,u$d,!1),u$dj._CONVERTION_BUFFER.getFloat64(0,!1)-1},u$m(u$b,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new u$dj([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function u$W(u$W,u$j){this.origin=null,this.direction=null,this.origin=u$W,this.direction=u$j}return u$T(u$W,"laya.d3.math.Ray"),u$W}()),u$Ej=function(){function u$W(u$W,u$j){this.elements=new Float32Array(2),void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0);var u$t=this.elements;u$t[0]=u$W,u$t[1]=u$j}u$T(u$W,"laya.d3.math.Vector2");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j.fromArray=function(u$W,u$j){void 0===u$j&&(u$j=0),this.elements[0]=u$W[u$j+0],this.elements[1]=u$W[u$j+1]},u$j.cloneTo=function(u$W){var u$j=u$W.elements,u$t=this.elements;u$j[0]=u$t[0],u$j[1]=u$t[1]},u$j.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$j,"x",function(){return this.elements[0]},function(u$W){this.elements[0]=u$W}),u$$(0,u$j,"y",function(){return this.elements[1]},function(u$W){this.elements[1]=u$W}),u$W.scale=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements;u$d[0]=u$b[0]*u$j,u$d[1]=u$b[1]*u$j},u$m(u$W,["ZERO",function(){return this.ZERO=new u$W(0,0)},"ONE",function(){return this.ONE=new u$W(1,1)}]),u$W}(),u$Oj=function(){function u$R(u$W,u$j,u$t){this.elements=new Float32Array(3),void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0);var u$d=this.elements;u$d[0]=u$W,u$d[1]=u$j,u$d[2]=u$t}u$T(u$R,"laya.d3.math.Vector3");var u$W=u$R.prototype;return u$X.imps(u$W,{"laya.d3.core.IClone":!0}),u$W.fromArray=function(u$W,u$j){void 0===u$j&&(u$j=0),this.elements[0]=u$W[u$j+0],this.elements[1]=u$W[u$j+1],this.elements[2]=u$W[u$j+2]},u$W.cloneTo=function(u$W){var u$j=u$W.elements,u$t=this.elements;u$j[0]=u$t[0],u$j[1]=u$t[1],u$j[2]=u$t[2]},u$W.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$W.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},u$W.reset=function(u$W,u$j,u$t){this.elements[0]=u$W,this.elements[1]=u$j,this.elements[2]=u$t},u$$(0,u$W,"x",function(){return this.elements[0]},function(u$W){this.elements[0]=u$W}),u$$(0,u$W,"y",function(){return this.elements[1]},function(u$W){this.elements[1]=u$W}),u$$(0,u$W,"z",function(){return this.elements[2]},function(u$W){this.elements[2]=u$W}),u$R.distanceSquared=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements,u$b=u$t[0]-u$d[0],u$E=u$t[1]-u$d[1],u$O=u$t[2]-u$d[2];return u$b*u$b+u$E*u$E+u$O*u$O},u$R.distance=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements,u$b=u$t[0]-u$d[0],u$E=u$t[1]-u$d[1],u$O=u$t[2]-u$d[2];return Math.sqrt(u$b*u$b+u$E*u$E+u$O*u$O)},u$R.min=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements;u$d[0]=Math.min(u$b[0],u$E[0]),u$d[1]=Math.min(u$b[1],u$E[1]),u$d[2]=Math.min(u$b[2],u$E[2])},u$R.max=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements;u$d[0]=Math.max(u$b[0],u$E[0]),u$d[1]=Math.max(u$b[1],u$E[1]),u$d[2]=Math.max(u$b[2],u$E[2])},u$R.transformQuat=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements,u$O=u$b[0],u$q=u$b[1],u$A=u$b[2],u$c=u$E[0],u$R=u$E[1],u$m=u$E[2],u$Q=u$E[3],u$T=u$Q*u$O+u$R*u$A-u$m*u$q,u$$=u$Q*u$q+u$m*u$O-u$c*u$A,u$e=u$Q*u$A+u$c*u$q-u$R*u$O,u$K=-u$c*u$O-u$R*u$q-u$m*u$A;u$d[0]=u$T*u$Q+u$K*-u$c+u$$*-u$m-u$e*-u$R,u$d[1]=u$$*u$Q+u$K*-u$R+u$e*-u$c-u$T*-u$m,u$d[2]=u$e*u$Q+u$K*-u$m+u$T*-u$R-u$$*-u$c},u$R.scalarLength=function(u$W){var u$j=u$W.elements,u$t=u$j[0],u$d=u$j[1],u$b=u$j[2];return Math.sqrt(u$t*u$t+u$d*u$d+u$b*u$b)},u$R.scalarLengthSquared=function(u$W){var u$j=u$W.elements,u$t=u$j[0],u$d=u$j[1],u$b=u$j[2];return u$t*u$t+u$d*u$d+u$b*u$b},u$R.normalize=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements,u$b=u$t[0],u$E=u$t[1],u$O=u$t[2],u$q=u$b*u$b+u$E*u$E+u$O*u$O;0<u$q&&(u$q=1/Math.sqrt(u$q),u$d[0]=u$t[0]*u$q,u$d[1]=u$t[1]*u$q,u$d[2]=u$t[2]*u$q)},u$R.multiply=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements;u$d[0]=u$b[0]*u$E[0],u$d[1]=u$b[1]*u$E[1],u$d[2]=u$b[2]*u$E[2]},u$R.scale=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements;u$d[0]=u$b[0]*u$j,u$d[1]=u$b[1]*u$j,u$d[2]=u$b[2]*u$j},u$R.lerp=function(u$W,u$j,u$t,u$d){var u$b=u$d.elements,u$E=u$W.elements,u$O=u$j.elements,u$q=u$E[0],u$A=u$E[1],u$c=u$E[2];u$b[0]=u$q+u$t*(u$O[0]-u$q),u$b[1]=u$A+u$t*(u$O[1]-u$A),u$b[2]=u$c+u$t*(u$O[2]-u$c)},u$R.transformV3ToV3=function(u$W,u$j,u$t){var u$d=u$R._tempVector4;u$R.transformV3ToV4(u$W,u$j,u$d);var u$b=u$d.elements,u$E=u$t.elements;u$E[0]=u$b[0],u$E[1]=u$b[1],u$E[2]=u$b[2]},u$R.transformV3ToV4=function(u$W,u$j,u$t){var u$d=u$W.elements,u$b=u$d[0],u$E=u$d[1],u$O=u$d[2],u$q=u$j.elements,u$A=u$t.elements;u$A[0]=u$b*u$q[0]+u$E*u$q[4]+u$O*u$q[8]+u$q[12],u$A[1]=u$b*u$q[1]+u$E*u$q[5]+u$O*u$q[9]+u$q[13],u$A[2]=u$b*u$q[2]+u$E*u$q[6]+u$O*u$q[10]+u$q[14],u$A[3]=u$b*u$q[3]+u$E*u$q[7]+u$O*u$q[11]+u$q[15]},u$R.TransformNormal=function(u$W,u$j,u$t){var u$d=u$W.elements,u$b=u$d[0],u$E=u$d[1],u$O=u$d[2],u$q=u$j.elements,u$A=u$t.elements;u$A[0]=u$b*u$q[0]+u$E*u$q[4]+u$O*u$q[8],u$A[1]=u$b*u$q[1]+u$E*u$q[5]+u$O*u$q[9],u$A[2]=u$b*u$q[2]+u$E*u$q[6]+u$O*u$q[10]},u$R.transformCoordinate=function(u$W,u$j,u$t){var u$d=u$R._tempVector4.elements,u$b=u$W.elements,u$E=u$b[0],u$O=u$b[1],u$q=u$b[2],u$A=u$j.elements;u$d[0]=u$E*u$A[0]+u$O*u$A[4]+u$q*u$A[8]+u$A[12],u$d[1]=u$E*u$A[1]+u$O*u$A[5]+u$q*u$A[9]+u$A[13],u$d[2]=u$E*u$A[2]+u$O*u$A[6]+u$q*u$A[10]+u$A[14],u$d[3]=1/(u$E*u$A[3]+u$O*u$A[7]+u$q*u$A[11]+u$A[15]);var u$c=u$t.elements;u$c[0]=u$d[0]*u$d[3],u$c[1]=u$d[1]*u$d[3],u$c[2]=u$d[2]*u$d[3]},u$R.Clamp=function(u$W,u$j,u$t,u$d){var u$b=u$W.elements,u$E=u$b[0],u$O=u$b[1],u$q=u$b[2],u$A=u$j.elements,u$c=u$A[0],u$R=u$A[1],u$m=u$A[2],u$Q=u$t.elements,u$T=u$Q[0],u$$=u$Q[1],u$e=u$Q[2],u$K=u$d.elements;u$E=(u$E=u$T<u$E?u$T:u$E)<u$c?u$c:u$E,u$O=(u$O=u$$<u$O?u$$:u$O)<u$R?u$R:u$O,u$q=(u$q=u$e<u$q?u$e:u$q)<u$m?u$m:u$q,u$K[0]=u$E,u$K[1]=u$O,u$K[2]=u$q},u$R.add=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements;u$d[0]=u$b[0]+u$E[0],u$d[1]=u$b[1]+u$E[1],u$d[2]=u$b[2]+u$E[2]},u$R.subtract=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements;u$d[0]=u$b[0]-u$E[0],u$d[1]=u$b[1]-u$E[1],u$d[2]=u$b[2]-u$E[2]},u$R.cross=function(u$W,u$j,u$t){var u$d=u$W.elements,u$b=u$j.elements,u$E=u$t.elements,u$O=u$d[0],u$q=u$d[1],u$A=u$d[2],u$c=u$b[0],u$R=u$b[1],u$m=u$b[2];u$E[0]=u$q*u$m-u$A*u$R,u$E[1]=u$A*u$c-u$O*u$m,u$E[2]=u$O*u$R-u$q*u$c},u$R.dot=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements;return u$t[0]*u$d[0]+u$t[1]*u$d[1]+u$t[2]*u$d[2]},u$R.equals=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements;return u$pW.nearEqual(Math.abs(u$t[0]),Math.abs(u$d[0]))&&u$pW.nearEqual(Math.abs(u$t[1]),Math.abs(u$d[1]))&&u$pW.nearEqual(Math.abs(u$t[2]),Math.abs(u$d[2]))},u$R.ZERO=new u$R(0,0,0),u$R.ONE=new u$R(1,1,1),u$R.NegativeUnitX=new u$R(-1,0,0),u$R.UnitX=new u$R(1,0,0),u$R.UnitY=new u$R(0,1,0),u$R.UnitZ=new u$R(0,0,1),u$R.ForwardRH=new u$R(0,0,-1),u$R.ForwardLH=new u$R(0,0,1),u$R.Up=new u$R(0,1,0),u$R.NAN=new u$R(NaN,NaN,NaN),u$m(u$R,["_tempVector4",function(){return this._tempVector4=new u$qj}]),u$R}(),u$qj=function(){function u$W(u$W,u$j,u$t,u$d){this.elements=new Float32Array(4),void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=0);var u$b=this.elements;u$b[0]=u$W,u$b[1]=u$j,u$b[2]=u$t,u$b[3]=u$d}u$T(u$W,"laya.d3.math.Vector4");var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j.fromArray=function(u$W,u$j){void 0===u$j&&(u$j=0),this.elements[0]=u$W[u$j+0],this.elements[1]=u$W[u$j+1],this.elements[2]=u$W[u$j+2],this.elements[3]=u$W[u$j+3]},u$j.cloneTo=function(u$W){var u$j=u$W.elements,u$t=this.elements;u$j[0]=u$t[0],u$j[1]=u$t[1],u$j[2]=u$t[2],u$j[3]=u$t[3]},u$j.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$j.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},u$j.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},u$$(0,u$j,"x",function(){return this.elements[0]},function(u$W){this.elements[0]=u$W}),u$$(0,u$j,"y",function(){return this.elements[1]},function(u$W){this.elements[1]=u$W}),u$$(0,u$j,"z",function(){return this.elements[2]},function(u$W){this.elements[2]=u$W}),u$$(0,u$j,"w",function(){return this.elements[3]},function(u$W){this.elements[3]=u$W}),u$W.lerp=function(u$W,u$j,u$t,u$d){var u$b=u$d.elements,u$E=u$W.elements,u$O=u$j.elements,u$q=u$E[0],u$A=u$E[1],u$c=u$E[2],u$R=u$E[3];u$b[0]=u$q+u$t*(u$O[0]-u$q),u$b[1]=u$A+u$t*(u$O[1]-u$A),u$b[2]=u$c+u$t*(u$O[2]-u$c),u$b[3]=u$R+u$t*(u$O[3]-u$R)},u$W.transformByM4x4=function(u$W,u$j,u$t){var u$d=u$W.elements,u$b=u$d[0],u$E=u$d[1],u$O=u$d[2],u$q=u$d[3],u$A=u$j.elements,u$c=u$t.elements;u$c[0]=u$b*u$A[0]+u$E*u$A[4]+u$O*u$A[8]+u$q*u$A[12],u$c[1]=u$b*u$A[1]+u$E*u$A[5]+u$O*u$A[9]+u$q*u$A[13],u$c[2]=u$b*u$A[2]+u$E*u$A[6]+u$O*u$A[10]+u$q*u$A[14],u$c[3]=u$b*u$A[3]+u$E*u$A[7]+u$O*u$A[11]+u$q*u$A[15]},u$W.equals=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements;return u$pW.nearEqual(Math.abs(u$t[0]),Math.abs(u$d[0]))&&u$pW.nearEqual(Math.abs(u$t[1]),Math.abs(u$d[1]))&&u$pW.nearEqual(Math.abs(u$t[2]),Math.abs(u$d[2]))&&u$pW.nearEqual(Math.abs(u$t[3]),Math.abs(u$d[3]))},u$W.normalize=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements,u$b=u$W.length();0<u$b&&(u$d[0]=u$t[0]*u$b,u$d[1]=u$t[1]*u$b,u$d[2]=u$t[2]*u$b,u$d[3]=u$t[3]*u$b)},u$W.add=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements;u$d[0]=u$b[0]+u$E[0],u$d[1]=u$b[1]+u$E[1],u$d[2]=u$b[2]+u$E[2],u$d[3]=u$b[3]+u$E[3]},u$W.subtract=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements;u$d[0]=u$b[0]-u$E[0],u$d[1]=u$b[1]-u$E[1],u$d[2]=u$b[2]-u$E[2],u$d[3]=u$b[3]-u$E[3]},u$W.multiply=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements;u$d[0]=u$b[0]*u$E[0],u$d[1]=u$b[1]*u$E[1],u$d[2]=u$b[2]*u$E[2],u$d[3]=u$b[3]*u$E[3]},u$W.scale=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements;u$d[0]=u$b[0]*u$j,u$d[1]=u$b[1]*u$j,u$d[2]=u$b[2]*u$j,u$d[3]=u$b[3]*u$j},u$W.Clamp=function(u$W,u$j,u$t,u$d){var u$b=u$W.elements,u$E=u$b[0],u$O=u$b[1],u$q=u$b[2],u$A=u$b[3],u$c=u$j.elements,u$R=u$c[0],u$m=u$c[1],u$Q=u$c[2],u$T=u$c[3],u$$=u$t.elements,u$e=u$$[0],u$K=u$$[1],u$o=u$$[2],u$S=u$$[3],u$M=u$d.elements;u$E=(u$E=u$e<u$E?u$e:u$E)<u$R?u$R:u$E,u$O=(u$O=u$K<u$O?u$K:u$O)<u$m?u$m:u$O,u$q=(u$q=u$o<u$q?u$o:u$q)<u$Q?u$Q:u$q,u$A=(u$A=u$S<u$A?u$S:u$A)<u$T?u$T:u$A,u$M[0]=u$E,u$M[1]=u$O,u$M[2]=u$q,u$M[3]=u$A},u$W.distanceSquared=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements,u$b=u$t[0]-u$d[0],u$E=u$t[1]-u$d[1],u$O=u$t[2]-u$d[2],u$q=u$t[3]-u$d[3];return u$b*u$b+u$E*u$E+u$O*u$O+u$q*u$q},u$W.distance=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements,u$b=u$t[0]-u$d[0],u$E=u$t[1]-u$d[1],u$O=u$t[2]-u$d[2],u$q=u$t[3]-u$d[3];return Math.sqrt(u$b*u$b+u$E*u$E+u$O*u$O+u$q*u$q)},u$W.dot=function(u$W,u$j){var u$t=u$W.elements,u$d=u$j.elements;return u$t[0]*u$d[0]+u$t[1]*u$d[1]+u$t[2]*u$d[2]+u$t[3]*u$d[3]},u$W.min=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements;u$d[0]=Math.min(u$b[0],u$E[0]),u$d[1]=Math.min(u$b[1],u$E[1]),u$d[2]=Math.min(u$b[2],u$E[2]),u$d[3]=Math.min(u$b[3],u$E[3])},u$W.max=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j.elements;u$d[0]=Math.max(u$b[0],u$E[0]),u$d[1]=Math.max(u$b[1],u$E[1]),u$d[2]=Math.max(u$b[2],u$E[2]),u$d[3]=Math.max(u$b[3],u$E[3])},u$m(u$W,["ZERO",function(){return this.ZERO=new u$W},"ONE",function(){return this.ONE=new u$W(1,1,1,1)},"UnitX",function(){return this.UnitX=new u$W(1,0,0,0)},"UnitY",function(){return this.UnitY=new u$W(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new u$W(0,0,1,0)},"UnitW",function(){return this.UnitW=new u$W(0,0,0,1)}]),u$W}(),u$Aj=function(){function u$E(u$W,u$j,u$t,u$d){this.minDepth=0,this.maxDepth=1,this.x=u$W,this.y=u$j,this.width=u$t,this.height=u$d}u$T(u$E,"laya.d3.math.Viewport");var u$W=u$E.prototype;return u$W.project=function(u$W,u$j,u$t){u$Oj.transformV3ToV3(u$W,u$j,u$t);var u$d=u$W.elements,u$b=u$j.elements,u$E=u$t.elements,u$O=u$d[0]*u$b[3]+u$d[1]*u$b[7]+u$d[2]*u$b[11]+u$b[15];1!==u$O&&(u$E[0]=u$E[0]/u$O,u$E[1]=u$E[1]/u$O,u$E[2]=u$E[2]/u$O),u$E[0]=.5*(u$E[0]+1)*this.width+this.x,u$E[1]=.5*(1-u$E[1])*this.height+this.y,u$E[2]=u$E[2]*(this.maxDepth-this.minDepth)+this.minDepth},u$W.unprojectFromMat=function(u$W,u$j,u$t){var u$d=u$W.elements,u$b=u$j.elements,u$E=u$t.elements;u$E[0]=(u$d[0]-this.x)/this.width*2-1,u$E[1]=-((u$d[1]-this.y)/this.height*2-1);var u$O=(this.maxDepth-this.minDepth)/2;u$E[2]=(u$d[2]-this.minDepth-u$O)/u$O;var u$q=u$E[0]*u$b[3]+u$E[1]*u$b[7]+u$E[2]*u$b[11]+u$b[15];u$Oj.transformV3ToV3(u$t,u$j,u$t),1!==u$q&&(u$E[0]=u$E[0]/u$q,u$E[1]=u$E[1]/u$q,u$E[2]=u$E[2]/u$q)},u$W.unprojectFromWVP=function(u$W,u$j,u$t,u$d,u$b){u$Wj.multiply(u$j,u$t,u$E._tempMatrix4x4),u$d&&u$Wj.multiply(u$E._tempMatrix4x4,u$d,u$E._tempMatrix4x4),u$E._tempMatrix4x4.invert(u$E._tempMatrix4x4),this.unprojectFromMat(u$W,u$E._tempMatrix4x4,u$b)},u$m(u$E,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new u$Wj}]),u$E}(),u$cj=function(){function u$x(u$W){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=u$W,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}u$T(u$x,"laya.d3.resource.models.SubMesh");var u$W=u$x.prototype;return u$X.imps(u$W,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),u$W._getVertexBuffer=function(u$W){return void 0===u$W&&(u$W=0),0===u$W?this._vertexBuffer:null},u$W._getIndexBuffer=function(){return this._indexBuffer},u$W._getStaticBatchBakedVertexs=function(u$W,u$j){var u$t,u$d,u$b=this._vertexBuffer,u$E=u$b.vertexDeclaration,u$O=u$E.getVertexElementByUsage(0).offset/4,u$q=u$E.getVertexElementByUsage(3).offset/4,u$A=u$j.meshRender.lightmapScaleOffset,u$c=0,u$R=0,u$m=0,u$Q=0,u$T=0,u$$=0;if(u$A)if(u$d=u$E.getVertexElementByUsage(15))u$m=u$E.vertexStride/4,u$t=0<this._vertexCount?u$b.getData().slice(this._vertexStart*u$m,(this._vertexStart+this._vertexCount)*u$m):u$b.getData().slice(),u$Q=u$d.offset/4;else{u$m=(u$$=u$E.vertexStride/4)+2,u$t=this._vertexCount?new Float32Array(this._vertexCount*(u$b.vertexDeclaration.vertexStride/4+2)):new Float32Array(u$b.vertexCount*(u$b.vertexDeclaration.vertexStride/4+2)),u$Q=(u$T=u$E.getVertexElementByUsage(2).offset/4)+2;var u$e=u$b.getData();for(u$c=0,u$R=u$e.length/u$$;u$c<u$R;u$c++){var u$K=0;u$K=0<this._vertexCount?(this._vertexStart+u$c)*u$$:u$c*u$$;var u$o=u$c*u$m,u$S=0;for(u$S=0;u$S<u$Q;u$S++)u$t[u$o+u$S]=u$e[u$K+u$S];for(u$S=u$Q;u$S<u$$;u$S++)u$t[u$o+u$S+2]=u$e[u$K+u$S]}}else u$m=u$E.vertexStride/4,u$t=this._vertexCount?u$b.getData().slice(this._vertexStart*u$m,(this._vertexStart+this._vertexCount)*u$m):u$b.getData().slice();if(u$W){var u$M=u$W.worldMatrix,u$Z=u$x._tempMatrix4x40;u$M.invert(u$Z);var u$X=u$x._tempMatrix4x41,u$_=u$j.transform.worldMatrix;u$Wj.multiply(u$Z,u$_,u$X)}else u$X=u$j.transform.worldMatrix;var u$N=u$x._tempQuaternion0;for(u$X.decomposeTransRotScale(u$x._tempVector30,u$N,u$x._tempVector31),u$c=0,u$R=u$t.length/u$m;u$c<u$R;u$c++){var u$z=u$c*u$m+u$O,u$C=u$c*u$m+u$q;if(u$Kj.transformVector3ArrayToVector3ArrayCoordinate(u$t,u$z,u$X,u$t,u$z),u$Kj.transformVector3ArrayByQuat(u$t,u$C,u$N,u$t,u$C),u$A){var u$L=u$c*u$m+u$Q;if(u$d)u$Kj.transformLightingMapTexcoordByUV1Array(u$t,u$L,u$A,u$t,u$L);else{var u$V=u$c*u$$+u$T;u$Kj.transformLightingMapTexcoordByUV0Array(u$e,u$V,u$A,u$t,u$L)}}}return u$t},u$W._getVertexBuffers=function(){return null},u$W._beforeRender=function(u$W){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},u$W._render=function(u$W){var u$j,u$t=0,u$d=u$W.renderElement;if(1<this._indexCount){var u$b=this._boneIndicesList.length;if(1<u$b){for(var u$E=0;u$E<u$b;u$E++)(u$j=u$d._skinAnimationDatas||this._skinAnimationDatas)&&(u$d._shaderValue.setValue(0,u$j[u$E]),u$W._shader.uploadRenderElementUniforms(u$d._shaderValue.data)),u$G.mainContext.drawElements(4,this._subIndexBufferCount[u$E],5123,2*this._subIndexBufferStart[u$E]);u$z.drawCall+=u$b}else(u$j=u$d._skinAnimationDatas||this._skinAnimationDatas)&&(u$d._shaderValue.setValue(0,u$j[0]),u$W._shader.uploadRenderElementUniforms(u$d._shaderValue.data)),u$G.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),u$z.drawCall++;u$t=this._indexCount}else u$t=this._indexBuffer.indexCount,(u$j=u$d._skinAnimationDatas||this._skinAnimationDatas)&&(u$d._shaderValue.setValue(0,u$j[0]),u$W._shader.uploadRenderElementUniforms(u$d._shaderValue.data)),u$G.mainContext.drawElements(4,u$t,5123,0),u$z.drawCall++;u$z.trianglesFaces+=u$t/3},u$W.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},u$W.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},u$$(0,u$W,"_vertexBufferCount",function(){return 1}),u$$(0,u$W,"triangleCount",function(){return this._indexBuffer.indexCount/3}),u$m(u$x,["_tempVector30",function(){return this._tempVector30=new u$Oj},"_tempVector31",function(){return this._tempVector31=new u$Oj},"_tempQuaternion0",function(){return this._tempQuaternion0=new u$tj},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new u$Wj},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new u$Wj}]),u$x}(),u$Rj=function(){function u$W(u$W){this.defineCounter=0,this.defines=null,u$W?(this.defineCounter=u$W.defineCounter,this.defines=u$W.defines.slice()):(this.defineCounter=0,this.defines=[])}return u$T(u$W,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),u$W.prototype.registerDefine=function(u$W){var u$j=Math.pow(2,this.defineCounter++);return this.defines[u$j]=u$W,u$j},u$W}(),u$mj=function(){function u$W(){}return u$T(u$W,"laya.d3.shader.ShaderInit3D"),u$W.__init__=function(){var u$W,u$j;u$zj._globalRegDefine("HIGHPRECISION",u$zj.SHADERDEFINE_HIGHPRECISION),u$zj._globalRegDefine("FOG",u$zj.SHADERDEFINE_FOG),u$zj._globalRegDefine("DIRECTIONLIGHT",u$zj.SHADERDEFINE_DIRECTIONLIGHT),u$zj._globalRegDefine("POINTLIGHT",u$zj.SHADERDEFINE_POINTLIGHT),u$zj._globalRegDefine("SPOTLIGHT",u$zj.SHADERDEFINE_SPOTLIGHT),u$zj._globalRegDefine("UV",u$zj.SHADERDEFINE_UV0),u$zj._globalRegDefine("COLOR",u$zj.SHADERDEFINE_COLOR),u$zj._globalRegDefine("UV1",u$zj.SHADERDEFINE_UV1),u$zj._globalRegDefine("CASTSHADOW",u$Tj.SHADERDEFINE_CAST_SHADOW),u$zj._globalRegDefine("SHADOWMAP_PSSM1",u$Tj.SHADERDEFINE_SHADOW_PSSM1),u$zj._globalRegDefine("SHADOWMAP_PSSM2",u$Tj.SHADERDEFINE_SHADOW_PSSM2),u$zj._globalRegDefine("SHADOWMAP_PSSM3",u$Tj.SHADERDEFINE_SHADOW_PSSM3),u$zj._globalRegDefine("SHADOWMAP_PCF_NO",u$Tj.SHADERDEFINE_SHADOW_PCF_NO),u$zj._globalRegDefine("SHADOWMAP_PCF1",u$Tj.SHADERDEFINE_SHADOW_PCF1),u$zj._globalRegDefine("SHADOWMAP_PCF2",u$Tj.SHADERDEFINE_SHADOW_PCF2),u$zj._globalRegDefine("SHADOWMAP_PCF3",u$Tj.SHADERDEFINE_SHADOW_PCF3),u$zj._globalRegDefine("DEPTHFOG",u$zj.SAHDERDEFINE_DEPTHFOG),u$uj.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),u$uj.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),u$W={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},u$j={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var u$t=u$uj.nameKey.add("SIMPLE");shaderCompile=u$zj.add(u$t,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',u$W,u$j),u$Dj.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),u$Dj.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),u$Dj.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),u$Dj.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),u$Dj.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),u$Dj.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),u$Dj.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),u$Dj.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),u$Dj.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},u$W}(),u$Qj=function(){function u$W(){this._data=null,this._data=[]}u$T(u$W,"laya.d3.shader.ValusArray");var u$j=u$W.prototype;return u$j.setValue=function(u$W,u$j){this._data[u$W]=u$j},u$$(0,u$j,"data",function(){return this._data}),u$W}(),u$Tj=function(){function u$W(){}return u$W.SHADERDEFINE_RECEIVE_SHADOW=1,u$W.SHADERDEFINE_CAST_SHADOW=512,u$W.SHADERDEFINE_SHADOW_PSSM1=1024,u$W.SHADERDEFINE_SHADOW_PSSM2=2048,u$W.SHADERDEFINE_SHADOW_PSSM3=4096,u$W.SHADERDEFINE_SHADOW_PCF_NO=8192,u$W.SHADERDEFINE_SHADOW_PCF1=16384,u$W.SHADERDEFINE_SHADOW_PCF2=32768,u$W.SHADERDEFINE_SHADOW_PCF3=65536,u$W.MAX_PSSM_COUNT=3,u$W}(),u$$j=function(){function u$P(){}return u$T(u$P,"laya.d3.utils.Picker"),u$P.calculateCursorRay=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=u$W.elements[0],u$q=u$W.elements[1],u$A=u$P._tempVector30,u$c=u$A.elements;u$c[0]=u$O,u$c[1]=u$q,u$c[2]=u$j.minDepth;var u$R=u$P._tempVector31,u$m=u$R.elements;u$m[0]=u$O,u$m[1]=u$q,u$m[2]=u$j.maxDepth;var u$Q=u$E.origin,u$T=u$P._tempVector32;u$j.unprojectFromWVP(u$A,u$t,u$d,u$b,u$Q),u$j.unprojectFromWVP(u$R,u$t,u$d,u$b,u$T);var u$$=u$E.direction.elements;u$$[0]=u$T.x-u$Q.x,u$$[1]=u$T.y-u$Q.y,u$$[2]=u$T.z-u$Q.z,u$Oj.normalize(u$E.direction,u$E.direction)},u$P.rayIntersectsPositionsAndIndices=function(u$W,u$j,u$t,u$d,u$b){for(var u$E=u$t.vertexStride/4,u$O=u$t.getVertexElementByUsage(0).offset/4,u$q=Number.MAX_VALUE,u$A=-1,u$c=-1,u$R=-1,u$m=0;u$m<u$d.length;u$m+=3){var u$Q=u$P._tempVector35,u$T=u$Q.elements,u$$=u$d[u$m]*u$E,u$e=u$$+u$O;u$T[0]=u$j[u$e],u$T[1]=u$j[1+u$e],u$T[2]=u$j[2+u$e];var u$K=u$P._tempVector36,u$o=u$K.elements,u$S=u$d[u$m+1]*u$E,u$M=u$S+u$O;u$o[0]=u$j[u$M],u$o[1]=u$j[1+u$M],u$o[2]=u$j[2+u$M];var u$Z=u$P._tempVector37,u$X=u$Z.elements,u$_=u$d[u$m+2]*u$E,u$N=u$_+u$O;u$X[0]=u$j[u$N],u$X[1]=u$j[1+u$N],u$X[2]=u$j[2+u$N];var u$z=laya.d3.utils.Picker.rayIntersectsTriangle(u$W,u$Q,u$K,u$Z);!isNaN(u$z)&&u$z<u$q&&(u$q=u$z,u$A=u$$,u$c=u$S,u$R=u$_)}if(u$q===Number.MAX_VALUE)return u$b.position.toDefault(),u$b.distance=Number.MAX_VALUE,u$b.trianglePositions[0].toDefault(),u$b.trianglePositions[1].toDefault(),u$b.trianglePositions[2].toDefault(),u$b.triangleNormals[0].toDefault(),u$b.triangleNormals[1].toDefault(),u$b.triangleNormals[2].toDefault(),!1;u$b.distance=u$q,u$Oj.scale(u$W.direction,u$q,u$b.position),u$Oj.add(u$W.origin,u$b.position,u$b.position);var u$C=u$b.trianglePositions,u$L=u$C[0],u$V=u$C[1],u$x=u$C[2],u$G=u$L.elements,u$l=u$V.elements,u$h=u$x.elements,u$v=u$A+u$O;u$G[0]=u$j[u$v],u$G[1]=u$j[u$v+1],u$G[2]=u$j[u$v+2];var u$y=u$c+u$O;u$l[0]=u$j[u$y],u$l[1]=u$j[u$y+1],u$l[2]=u$j[u$y+2];var u$a=u$R+u$O;u$h[0]=u$j[u$a],u$h[1]=u$j[u$a+1],u$h[2]=u$j[u$a+2];var u$u=u$t.getVertexElementByUsage(3);if(u$u){var u$D=u$u.offset/4,u$s=u$b.triangleNormals,u$Y=u$s[0],u$H=u$s[1],u$I=u$s[2],u$g=u$Y.elements,u$f=u$H.elements,u$w=u$I.elements,u$U=u$A+u$D;u$g[0]=u$j[u$U],u$g[1]=u$j[u$U+1],u$g[2]=u$j[u$U+2];var u$J=u$c+u$D;u$f[0]=u$j[u$J],u$f[1]=u$j[u$J+1],u$f[2]=u$j[u$J+2];var u$r=u$R+u$D;u$w[0]=u$j[u$r],u$w[1]=u$j[u$r+1],u$w[2]=u$j[u$r+2]}return!0},u$P.rayIntersectsTriangle=function(u$W,u$j,u$t,u$d){var u$b=u$P._tempVector30,u$E=u$P._tempVector31;u$Oj.subtract(u$t,u$j,u$b),u$Oj.subtract(u$d,u$j,u$E);var u$O,u$q=u$P._tempVector32;if(u$Oj.cross(u$W.direction,u$E,u$q),(u$O=u$Oj.dot(u$b,u$q))>-Number.MIN_VALUE&&u$O<Number.MIN_VALUE)return Number.NaN;var u$A,u$c=1/u$O,u$R=u$P._tempVector33;if(u$Oj.subtract(u$W.origin,u$j,u$R),u$A=u$Oj.dot(u$R,u$q),(u$A*=u$c)<0||1<u$A)return Number.NaN;var u$m,u$Q,u$T=u$P._tempVector34;return u$Oj.cross(u$R,u$b,u$T),u$m=u$Oj.dot(u$W.direction,u$T),(u$m*=u$c)<0||1<u$A+u$m?Number.NaN:(u$Q=u$Oj.dot(u$E,u$T),(u$Q*=u$c)<0?Number.NaN:u$Q)},u$m(u$P,["_tempVector30",function(){return this._tempVector30=new u$Oj},"_tempVector31",function(){return this._tempVector31=new u$Oj},"_tempVector32",function(){return this._tempVector32=new u$Oj},"_tempVector33",function(){return this._tempVector33=new u$Oj},"_tempVector34",function(){return this._tempVector34=new u$Oj},"_tempVector35",function(){return this._tempVector35=new u$Oj},"_tempVector36",function(){return this._tempVector36=new u$Oj},"_tempVector37",function(){return this._tempVector37=new u$Oj}]),u$P}(),u$ej=(function(){function u$W(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new u$Oj,new u$Oj,new u$Oj],this.trianglePositions.length=3,this.triangleNormals=[new u$Oj,new u$Oj,new u$Oj],this.triangleNormals.length=3,this.position=new u$Oj}u$T(u$W,"laya.d3.utils.RaycastHit"),u$W.prototype.cloneTo=function(u$W){u$W.distance=this.distance,this.trianglePositions[0].cloneTo(u$W.trianglePositions[0]),this.trianglePositions[1].cloneTo(u$W.trianglePositions[1]),this.trianglePositions[2].cloneTo(u$W.trianglePositions[2]),this.triangleNormals[0].cloneTo(u$W.triangleNormals[0]),this.triangleNormals[1].cloneTo(u$W.triangleNormals[1]),this.triangleNormals[2].cloneTo(u$W.triangleNormals[2]),this.position.cloneTo(u$W.position),u$W.sprite3D=this.sprite3D}}(),function(){function u$W(u$W,u$j){this._width=0,this._height=0,this._width=u$W,this._height=u$j}u$T(u$W,"laya.d3.utils.Size");var u$j=u$W.prototype;return u$$(0,u$j,"width",function(){return-1===this._width?u$i.clientWidth:this._width}),u$$(0,u$j,"height",function(){return-1===this._height?u$i.clientHeight:this._height}),u$$(1,u$W,"fullScreen",function(){return new u$W(-1,-1)}),u$W}()),u$Kj=function(){function u$v(){}return u$T(u$v,"laya.d3.utils.Utils3D"),u$v._rotationTransformScaleSkinAnimation=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$m){var u$Q,u$T,u$$,u$e,u$K,u$o=u$v._tempArray16_0,u$S=u$v._tempArray16_1,u$M=u$v._tempArray16_2,u$Z=u$d+u$d,u$X=u$b+u$b,u$_=u$E+u$E,u$N=u$d*u$Z,u$z=u$b*u$Z,u$C=u$b*u$X,u$L=u$E*u$Z,u$V=u$E*u$X,u$x=u$E*u$_,u$G=u$O*u$Z,u$l=u$O*u$X,u$h=u$O*u$_;for(u$o[15]=1,u$o[0]=1-u$C-u$x,u$o[1]=u$z+u$h,u$o[2]=u$L-u$l,u$o[4]=u$z-u$h,u$o[5]=1-u$N-u$x,u$o[6]=u$V+u$G,u$o[8]=u$L+u$l,u$o[9]=u$V-u$G,u$o[10]=1-u$N-u$C,u$S[15]=1,u$S[0]=u$q,u$S[5]=u$A,u$S[10]=u$c,u$Q=0;u$Q<4;u$Q++)u$T=u$o[u$Q],u$$=u$o[u$Q+4],u$e=u$o[u$Q+8],u$K=u$o[u$Q+12],u$M[u$Q]=u$T,u$M[u$Q+4]=u$$,u$M[u$Q+8]=u$e,u$M[u$Q+12]=u$T*u$W+u$$*u$j+u$e*u$t+u$K;for(u$Q=0;u$Q<4;u$Q++)u$T=u$M[u$Q],u$$=u$M[u$Q+4],u$e=u$M[u$Q+8],u$K=u$M[u$Q+12],u$R[u$Q+u$m]=u$T*u$S[0]+u$$*u$S[1]+u$e*u$S[2]+u$K*u$S[3],u$R[u$Q+u$m+4]=u$T*u$S[4]+u$$*u$S[5]+u$e*u$S[6]+u$K*u$S[7],u$R[u$Q+u$m+8]=u$T*u$S[8]+u$$*u$S[9]+u$e*u$S[10]+u$K*u$S[11],u$R[u$Q+u$m+12]=u$T*u$S[12]+u$$*u$S[13]+u$e*u$S[14]+u$K*u$S[15]},u$v._createNodeByJson=function(u$W,u$j,u$t,u$d){if(!u$t)switch(u$j.type){case"Sprite3D":u$t=new u$aj;break;case"MeshSprite3D":u$t=new u$Pj;break;case"SkinnedMeshSprite3D":u$t=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":u$t=new ShuriKenParticle3D;break;case"TrailSprite3D":u$t=new TrailSprite3D;break;case"Terrain":u$t=new Terrain;break;case"Camera":u$t=new u$rj;break;case"DirectionLight":u$t=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var u$b=u$j.props;if(u$b)for(var u$E in u$b)u$t[u$E]=u$b[u$E];var u$O=u$j.customProps;u$O&&(u$t instanceof laya.d3.core.Sprite3D?(u$t._parseBaseCustomProps(u$O),u$t._parseCustomProps(u$W,u$d,u$O,u$j),u$t._parseCustomComponent(u$W,u$d,u$j.components)):u$t._parseCustomProps(u$W,u$d,u$O,u$j));var u$q=u$j.child;if(u$q)for(var u$A=0,u$c=u$q.length;u$A<u$c;u$A++){var u$R=u$v._createNodeByJson(u$W,u$q[u$A],null,u$d);u$t.addChild(u$R)}return u$t},u$v._computeBoneAndAnimationDatasByBindPoseMatrxix=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O,u$q,u$A=0,u$c=0,u$R=u$W.length;for(u$O=0;u$O<u$R;u$A+=u$W[u$O].keyframeWidth,u$c+=16,u$O++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(u$j[u$A+0],u$j[u$A+1],u$j[u$A+2],u$j[u$A+3],u$j[u$A+4],u$j[u$A+5],u$j[u$A+6],u$j[u$A+7],u$j[u$A+8],u$j[u$A+9],u$d,u$c),0!=u$O&&(u$q=16*u$W[u$O].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(u$d,u$q,u$d,u$c,u$d,u$c));var u$m=u$t.length;for(u$O=0;u$O<u$m;u$O++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(u$d,16*u$E[u$O],u$t[u$O],u$b,16*u$O)},u$v._computeAnimationDatasByArrayAndMatrixFast=function(u$W,u$j,u$t,u$d){for(var u$b=0,u$E=u$W.length;u$b<u$E;u$b++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(u$j,16*u$d[u$b],u$W[u$b],u$t,16*u$b)},u$v._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(u$W,u$j,u$t,u$d,u$b){var u$E,u$O,u$q=0,u$A=0,u$c=u$W.length;for(u$E=0;u$E<u$c;u$q+=u$W[u$E].keyframeWidth,u$A+=16,u$E++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(u$j[u$q+7],u$j[u$q+8],u$j[u$q+9],u$j[u$q+3],u$j[u$q+4],u$j[u$q+5],u$j[u$q+6],u$j[u$q+0],u$j[u$q+1],u$j[u$q+2],u$d,u$A),0!=u$E&&(u$O=16*u$W[u$E].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(u$d,u$O,u$d,u$A,u$d,u$A));var u$R=u$t.length;for(u$E=0;u$E<u$R;u$E++){var u$m=16*u$E;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(u$d,u$m,u$t[u$E],u$b,u$m)}},u$v._computeAnimationDatasByArrayAndMatrixFastOld=function(u$W,u$j,u$t){for(var u$d=u$W.length,u$b=0;u$b<u$d;u$b++){var u$E=16*u$b;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(u$j,u$E,u$W[u$b],u$t,u$E)}},u$v._computeRootAnimationData=function(u$W,u$j,u$t){for(var u$d=0,u$b=0,u$E=0,u$O=u$W.length;u$d<u$O;u$b+=u$W[u$d].keyframeWidth,u$E+=16,u$d++)laya.d3.utils.Utils3D.createAffineTransformationArray(u$j[u$b+0],u$j[u$b+1],u$j[u$b+2],u$j[u$b+3],u$j[u$b+4],u$j[u$b+5],u$j[u$b+6],u$j[u$b+7],u$j[u$b+8],u$j[u$b+9],u$t,u$E)},u$v.transformVector3ArrayByQuat=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$t.elements,u$O=u$W[u$j],u$q=u$W[u$j+1],u$A=u$W[u$j+2],u$c=u$E[0],u$R=u$E[1],u$m=u$E[2],u$Q=u$E[3],u$T=u$Q*u$O+u$R*u$A-u$m*u$q,u$$=u$Q*u$q+u$m*u$O-u$c*u$A,u$e=u$Q*u$A+u$c*u$q-u$R*u$O,u$K=-u$c*u$O-u$R*u$q-u$m*u$A;u$d[u$b]=u$T*u$Q+u$K*-u$c+u$$*-u$m-u$e*-u$R,u$d[u$b+1]=u$$*u$Q+u$K*-u$R+u$e*-u$c-u$T*-u$m,u$d[u$b+2]=u$e*u$Q+u$K*-u$m+u$T*-u$R-u$$*-u$c},u$v.mulMatrixByArray=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O,u$q,u$A,u$c,u$R;if(u$b===u$t){for(u$t=u$v._tempArray16_3,u$O=0;u$O<16;++u$O)u$t[u$O]=u$b[u$E+u$O];u$d=0}for(u$O=0;u$O<4;u$O++)u$q=u$W[u$j+u$O],u$A=u$W[u$j+u$O+4],u$c=u$W[u$j+u$O+8],u$R=u$W[u$j+u$O+12],u$b[u$E+u$O]=u$q*u$t[u$d+0]+u$A*u$t[u$d+1]+u$c*u$t[u$d+2]+u$R*u$t[u$d+3],u$b[u$E+u$O+4]=u$q*u$t[u$d+4]+u$A*u$t[u$d+5]+u$c*u$t[u$d+6]+u$R*u$t[u$d+7],u$b[u$E+u$O+8]=u$q*u$t[u$d+8]+u$A*u$t[u$d+9]+u$c*u$t[u$d+10]+u$R*u$t[u$d+11],u$b[u$E+u$O+12]=u$q*u$t[u$d+12]+u$A*u$t[u$d+13]+u$c*u$t[u$d+14]+u$R*u$t[u$d+15]},u$v.mulMatrixByArrayFast=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O,u$q,u$A,u$c,u$R;for(u$O=0;u$O<4;u$O++)u$q=u$W[u$j+u$O],u$A=u$W[u$j+u$O+4],u$c=u$W[u$j+u$O+8],u$R=u$W[u$j+u$O+12],u$b[u$E+u$O]=u$q*u$t[u$d+0]+u$A*u$t[u$d+1]+u$c*u$t[u$d+2]+u$R*u$t[u$d+3],u$b[u$E+u$O+4]=u$q*u$t[u$d+4]+u$A*u$t[u$d+5]+u$c*u$t[u$d+6]+u$R*u$t[u$d+7],u$b[u$E+u$O+8]=u$q*u$t[u$d+8]+u$A*u$t[u$d+9]+u$c*u$t[u$d+10]+u$R*u$t[u$d+11],u$b[u$E+u$O+12]=u$q*u$t[u$d+12]+u$A*u$t[u$d+13]+u$c*u$t[u$d+14]+u$R*u$t[u$d+15]},u$v.mulMatrixByArrayAndMatrixFast=function(u$W,u$j,u$t,u$d,u$b){var u$E,u$O,u$q,u$A,u$c,u$R=u$t.elements,u$m=u$R[0],u$Q=u$R[1],u$T=u$R[2],u$$=u$R[3],u$e=u$R[4],u$K=u$R[5],u$o=u$R[6],u$S=u$R[7],u$M=u$R[8],u$Z=u$R[9],u$X=u$R[10],u$_=u$R[11],u$N=u$R[12],u$z=u$R[13],u$C=u$R[14],u$L=u$R[15],u$V=u$j,u$x=u$j+4,u$G=u$j+8,u$l=u$j+12,u$h=u$b,u$v=u$b+4,u$y=u$b+8,u$a=u$b+12;for(u$E=0;u$E<4;u$E++)u$O=u$W[u$V+u$E],u$q=u$W[u$x+u$E],u$A=u$W[u$G+u$E],u$c=u$W[u$l+u$E],u$d[u$h+u$E]=u$O*u$m+u$q*u$Q+u$A*u$T+u$c*u$$,u$d[u$v+u$E]=u$O*u$e+u$q*u$K+u$A*u$o+u$c*u$S,u$d[u$y+u$E]=u$O*u$M+u$q*u$Z+u$A*u$X+u$c*u$_,u$d[u$a+u$E]=u$O*u$N+u$q*u$z+u$A*u$C+u$c*u$L},u$v.createAffineTransformationArray=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$m){var u$Q=u$d+u$d,u$T=u$b+u$b,u$$=u$E+u$E,u$e=u$d*u$Q,u$K=u$d*u$T,u$o=u$d*u$$,u$S=u$b*u$T,u$M=u$b*u$$,u$Z=u$E*u$$,u$X=u$O*u$Q,u$_=u$O*u$T,u$N=u$O*u$$;u$R[u$m+0]=(1-(u$S+u$Z))*u$q,u$R[u$m+1]=(u$K+u$N)*u$q,u$R[u$m+2]=(u$o-u$_)*u$q,u$R[u$m+3]=0,u$R[u$m+4]=(u$K-u$N)*u$A,u$R[u$m+5]=(1-(u$e+u$Z))*u$A,u$R[u$m+6]=(u$M+u$X)*u$A,u$R[u$m+7]=0,u$R[u$m+8]=(u$o+u$_)*u$c,u$R[u$m+9]=(u$M-u$X)*u$c,u$R[u$m+10]=(1-(u$e+u$S))*u$c,u$R[u$m+11]=0,u$R[u$m+12]=u$W,u$R[u$m+13]=u$j,u$R[u$m+14]=u$t,u$R[u$m+15]=1},u$v.transformVector3ArrayToVector3ArrayCoordinate=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$v._tempArray4_0,u$O=u$W[u$j+0],u$q=u$W[u$j+1],u$A=u$W[u$j+2],u$c=u$t.elements;u$E[0]=u$O*u$c[0]+u$q*u$c[4]+u$A*u$c[8]+u$c[12],u$E[1]=u$O*u$c[1]+u$q*u$c[5]+u$A*u$c[9]+u$c[13],u$E[2]=u$O*u$c[2]+u$q*u$c[6]+u$A*u$c[10]+u$c[14],u$E[3]=1/(u$O*u$c[3]+u$q*u$c[7]+u$A*u$c[11]+u$c[15]),u$d[u$b+0]=u$E[0]*u$E[3],u$d[u$b+1]=u$E[1]*u$E[3],u$d[u$b+2]=u$E[2]*u$E[3]},u$v.transformLightingMapTexcoordByUV0Array=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$t.elements;u$d[u$b+0]=u$W[u$j+0]*u$E[0]+u$E[2],u$d[u$b+1]=(u$W[u$j+1]-1)*u$E[1]+u$E[3]},u$v.transformLightingMapTexcoordByUV1Array=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$t.elements;u$d[u$b+0]=u$W[u$j+0]*u$E[0]+u$E[2],u$d[u$b+1]=1+u$W[u$j+1]*u$E[1]+u$E[3]},u$v.getURLVerion=function(u$W){var u$j=u$W.indexOf("?");return 0<=u$j?u$W.substr(u$j):null},u$v._quaternionCreateFromYawPitchRollArray=function(u$W,u$j,u$t,u$d){var u$b=.5*u$t,u$E=.5*u$j,u$O=.5*u$W,u$q=Math.sin(u$b),u$A=Math.cos(u$b),u$c=Math.sin(u$E),u$R=Math.cos(u$E),u$m=Math.sin(u$O),u$Q=Math.cos(u$O);u$d[0]=u$Q*u$c*u$A+u$m*u$R*u$q,u$d[1]=u$m*u$R*u$A-u$Q*u$c*u$q,u$d[2]=u$Q*u$R*u$q-u$m*u$c*u$A,u$d[3]=u$Q*u$R*u$A+u$m*u$c*u$q},u$v._createAffineTransformationArray=function(u$W,u$j,u$t,u$d){var u$b=u$j[0],u$E=u$j[1],u$O=u$j[2],u$q=u$j[3],u$A=u$b+u$b,u$c=u$E+u$E,u$R=u$O+u$O,u$m=u$b*u$A,u$Q=u$b*u$c,u$T=u$b*u$R,u$$=u$E*u$c,u$e=u$E*u$R,u$K=u$O*u$R,u$o=u$q*u$A,u$S=u$q*u$c,u$M=u$q*u$R,u$Z=u$t[0],u$X=u$t[1],u$_=u$t[2];u$d[0]=(1-(u$$+u$K))*u$Z,u$d[1]=(u$Q+u$M)*u$Z,u$d[2]=(u$T-u$S)*u$Z,u$d[3]=0,u$d[4]=(u$Q-u$M)*u$X,u$d[5]=(1-(u$m+u$K))*u$X,u$d[6]=(u$e+u$o)*u$X,u$d[7]=0,u$d[8]=(u$T+u$S)*u$_,u$d[9]=(u$e-u$o)*u$_,u$d[10]=(1-(u$m+u$$))*u$_,u$d[11]=0,u$d[12]=u$W[0],u$d[13]=u$W[1],u$d[14]=u$W[2],u$d[15]=1},u$v._mulMatrixArray=function(u$W,u$j,u$t,u$d){var u$b,u$E,u$O,u$q,u$A,u$c=u$j.elements,u$R=u$c[0],u$m=u$c[1],u$Q=u$c[2],u$T=u$c[3],u$$=u$c[4],u$e=u$c[5],u$K=u$c[6],u$o=u$c[7],u$S=u$c[8],u$M=u$c[9],u$Z=u$c[10],u$X=u$c[11],u$_=u$c[12],u$N=u$c[13],u$z=u$c[14],u$C=u$c[15],u$L=u$d,u$V=u$d+4,u$x=u$d+8,u$G=u$d+12;for(u$b=0;u$b<4;u$b++)u$E=u$W[u$b],u$O=u$W[u$b+4],u$q=u$W[u$b+8],u$A=u$W[u$b+12],u$t[u$L+u$b]=u$E*u$R+u$O*u$m+u$q*u$Q+u$A*u$T,u$t[u$V+u$b]=u$E*u$$+u$O*u$e+u$q*u$K+u$A*u$o,u$t[u$x+u$b]=u$E*u$S+u$O*u$M+u$q*u$Z+u$A*u$X,u$t[u$G+u$b]=u$E*u$_+u$O*u$N+u$q*u$z+u$A*u$C},u$v.getYawPitchRoll=function(u$W,u$j){u$v.transformQuat(u$Oj.ForwardRH,u$W,u$tj.TEMPVector31),u$v.transformQuat(u$Oj.Up,u$W,u$tj.TEMPVector32);var u$t=u$tj.TEMPVector32.elements;u$v.angleTo(u$Oj.ZERO,u$tj.TEMPVector31,u$tj.TEMPVector33);var u$d=u$tj.TEMPVector33.elements;u$d[0]==Math.PI/2?(u$d[1]=u$v.arcTanAngle(u$t[2],u$t[0]),u$d[2]=0):u$d[0]==-Math.PI/2?(u$d[1]=u$v.arcTanAngle(-u$t[2],-u$t[0]),u$d[2]=0):(u$Wj.createRotationY(-u$d[1],u$tj.TEMPMatrix0),u$Wj.createRotationX(-u$d[0],u$tj.TEMPMatrix1),u$Oj.transformCoordinate(u$tj.TEMPVector32,u$tj.TEMPMatrix0,u$tj.TEMPVector32),u$Oj.transformCoordinate(u$tj.TEMPVector32,u$tj.TEMPMatrix1,u$tj.TEMPVector32),u$d[2]=u$v.arcTanAngle(u$t[1],-u$t[0])),u$d[1]<=-Math.PI&&(u$d[1]=Math.PI),u$d[2]<=-Math.PI&&(u$d[2]=Math.PI),u$d[1]>=Math.PI&&u$d[2]>=Math.PI&&(u$d[1]=0,u$d[2]=0,u$d[0]=Math.PI-u$d[0]),u$j[0]=u$d[1],u$j[1]=u$d[0],u$j[2]=u$d[2]},u$v.arcTanAngle=function(u$W,u$j){return 0==u$W?1==u$j?Math.PI/2:-Math.PI/2:0<u$W?Math.atan(u$j/u$W):u$W<0?0<u$j?Math.atan(u$j/u$W)+Math.PI:Math.atan(u$j/u$W)-Math.PI:0},u$v.angleTo=function(u$W,u$j,u$t){u$Oj.subtract(u$j,u$W,u$tj.TEMPVector30),u$Oj.normalize(u$tj.TEMPVector30,u$tj.TEMPVector30),u$t.elements[0]=Math.asin(u$tj.TEMPVector30.y),u$t.elements[1]=u$v.arcTanAngle(-u$tj.TEMPVector30.z,-u$tj.TEMPVector30.x)},u$v.transformQuat=function(u$W,u$j,u$t){var u$d=u$t.elements,u$b=u$W.elements,u$E=u$j,u$O=u$b[0],u$q=u$b[1],u$A=u$b[2],u$c=u$E[0],u$R=u$E[1],u$m=u$E[2],u$Q=u$E[3],u$T=u$Q*u$O+u$R*u$A-u$m*u$q,u$$=u$Q*u$q+u$m*u$O-u$c*u$A,u$e=u$Q*u$A+u$c*u$q-u$R*u$O,u$K=-u$c*u$O-u$R*u$q-u$m*u$A;u$d[0]=u$T*u$Q+u$K*-u$c+u$$*-u$m-u$e*-u$R,u$d[1]=u$$*u$Q+u$K*-u$R+u$e*-u$c-u$T*-u$m,u$d[2]=u$e*u$Q+u$K*-u$m+u$T*-u$R-u$$*-u$c},u$v.quaterionNormalize=function(u$W,u$j){var u$t=u$W[0],u$d=u$W[1],u$b=u$W[2],u$E=u$W[3],u$O=u$t*u$t+u$d*u$d+u$b*u$b+u$E*u$E;0<u$O&&(u$O=1/Math.sqrt(u$O),u$j[0]=u$t*u$O,u$j[1]=u$d*u$O,u$j[2]=u$b*u$O,u$j[3]=u$E*u$O)},u$v.matrix4x4MultiplyFFF=function(u$W,u$j,u$t){var u$d,u$b,u$E,u$O,u$q;if(u$t===u$j)for(u$j=new Float32Array(16),u$d=0;u$d<16;++u$d)u$j[u$d]=u$t[u$d];for(u$d=0;u$d<4;u$d++)u$b=u$W[u$d],u$E=u$W[u$d+4],u$O=u$W[u$d+8],u$q=u$W[u$d+12],u$t[u$d]=u$b*u$j[0]+u$E*u$j[1]+u$O*u$j[2]+u$q*u$j[3],u$t[u$d+4]=u$b*u$j[4]+u$E*u$j[5]+u$O*u$j[6]+u$q*u$j[7],u$t[u$d+8]=u$b*u$j[8]+u$E*u$j[9]+u$O*u$j[10]+u$q*u$j[11],u$t[u$d+12]=u$b*u$j[12]+u$E*u$j[13]+u$O*u$j[14]+u$q*u$j[15]},u$v.matrix4x4MultiplyMFM=function(u$W,u$j,u$t){u$v.matrix4x4MultiplyFFF(u$W.elements,u$j,u$t.elements)},u$m(u$v,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new u$Oj},"_tempVector3_1",function(){return this._tempVector3_1=new u$Oj},"_tempVector3_2",function(){return this._tempVector3_2=new u$Oj},"_tempVector3_3",function(){return this._tempVector3_3=new u$Oj},"_tempVector3_4",function(){return this._tempVector3_4=new u$Oj},"_tempVector3_5",function(){return this._tempVector3_5=new u$Oj},"_tempVector3_6",function(){return this._tempVector3_6=new u$Oj},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),u$v}(),u$oj=function(){function u$l(){}return u$T(u$l,"Laya3D"),u$l._cancelLoadByUrl=function(u$W){u$X.loader.cancelLoadByUrl(u$W),u$l._innerFirstLevelLoaderManager.cancelLoadByUrl(u$W),u$l._innerSecondLevelLoaderManager.cancelLoadByUrl(u$W),u$l._innerThirdLevelLoaderManager.cancelLoadByUrl(u$W),u$l._innerFourthLevelLoaderManager.cancelLoadByUrl(u$W)},u$l._changeWebGLSize=function(u$W,u$j){u$G.onStageResize(u$W,u$j),u$i.clientWidth=u$W,u$i.clientHeight=u$j},u$l.__init__=function(){var u$W=u$j.createMap;u$W.lh=[u$aj,"SPRITE3DHIERARCHY"],u$W.ls=[u$yj,"SPRITE3DHIERARCHY"],u$W.lm=[u$gj,"MESH"],u$W.lmat=[u$Dj,"MATERIAL"],u$W.jpg=[u$wj,"nativeimage"],u$W.jpeg=[u$wj,"nativeimage"],u$W.png=[u$wj,"nativeimage"],u$W.pkm=[u$wj,"arraybuffer"],u$W.raw=[u$Hj,"arraybuffer"],u$W.mipmaps=[u$Hj,"arraybuffer"],u$o.parserMap.SPRITE3DHIERARCHY=u$l._loadHierarchy,u$o.parserMap.MESH=u$l._loadMesh,u$o.parserMap.MATERIAL=u$l._loadMaterial,u$o.parserMap.TEXTURECUBE=u$l._loadTextureCube,u$o.parserMap.TERRAIN=u$l._loadTerrain,u$l._innerFirstLevelLoaderManager.on("error",null,u$l._eventLoadManagerError),u$l._innerSecondLevelLoaderManager.on("error",null,u$l._eventLoadManagerError),u$l._innerThirdLevelLoaderManager.on("error",null,u$l._eventLoadManagerError),u$l._innerFourthLevelLoaderManager.on("error",null,u$l._eventLoadManagerError)},u$l.READ_BLOCK=function(){return u$l._readData.pos+=4,!0},u$l.READ_DATA=function(){return u$l._DATA.offset=u$l._readData.getUint32(),u$l._DATA.size=u$l._readData.getUint32(),!0},u$l.READ_STRINGS=function(){var u$W=[],u$j={offset:0,size:0};u$j.offset=u$l._readData.getUint16(),u$j.size=u$l._readData.getUint16();u$l._readData.pos;u$l._readData.pos=u$j.offset+u$l._DATA.offset;for(var u$t=0;u$t<u$j.size;u$t++){var u$d=u$l._readData.readUTFString();-1===u$d.lastIndexOf(".lmat")&&-1===u$d.lastIndexOf(".lpbr")||u$W.push(u$d)}return u$W},u$l.formatRelativePath=function(u$W,u$j){var u$t;if("."===u$j.charAt(0)){for(var u$d=(u$W+u$j).split("/"),u$b=0,u$E=u$d.length;u$b<u$E;u$b++)if(".."==u$d[u$b]){var u$O=u$b-1;0<u$O&&".."!==u$d[u$O]&&(u$d.splice(u$O,2),u$b-=2)}u$t=u$d.join("/")}else u$t=u$W+u$j;return null!=u$x.customFormat&&(u$t=u$x.customFormat(u$t,null)),u$t},u$l._eventLoadManagerError=function(u$W){u$X.loader.event("error",u$W)},u$l._addHierarchyInnerUrls=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O=u$l.formatRelativePath(u$d,u$b);u$t&&(u$O+=u$t),u$W.push({url:u$O,clas:u$E}),u$j[u$b]=u$O},u$l._getSprite3DHierarchyInnerUrls=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){var u$q,u$A=0,u$c=0;switch(u$W.type){case"Scene":var u$R=u$W.customProps.lightmaps;for(u$A=0,u$c=u$R.length;u$A<u$c;u$A++){var u$m=u$R[u$A].replace(".exr",".png");u$l._addHierarchyInnerUrls(u$d,u$b,u$E,u$O,u$m,u$wj)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var u$Q;if(u$W.instanceParams)(u$Q=u$W.instanceParams.loadPath)&&u$l._addHierarchyInnerUrls(u$j,u$b,u$E,u$O,u$Q,u$gj);else{(u$Q=(u$q=u$W.customProps).meshPath)&&u$l._addHierarchyInnerUrls(u$j,u$b,u$E,u$O,u$Q,u$gj);var u$T=u$q.materials;if(u$T)for(u$A=0,u$c=u$T.length;u$A<u$c;u$A++){for(var u$$=u$T[u$A],u$e=u$$.type.split("."),u$K=u$h.window,u$o=0,u$S=u$e.length;u$o<u$S;++u$o){u$K=u$K[this.clasPaths[u$o]]}if("function"!=typeof u$K)throw"_getSprite3DHierarchyInnerUrls 错误: "+u$$.type+" 不是类";u$l._addHierarchyInnerUrls(u$t,u$b,u$E,u$O,u$$.path,u$K)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var u$M=(u$q=u$W.customProps).meshPath;u$M&&u$l._addHierarchyInnerUrls(u$j,u$b,u$E,u$O,u$M,u$gj);var u$Z=u$q.material;if(u$Z){u$e=u$Z.type.split("."),u$K=u$h.window;for(u$o=0,u$S=u$e.length;u$o<u$S;++u$o){u$K=u$K[this.clasPaths[u$o]]}u$l._addHierarchyInnerUrls(u$t,u$b,u$E,u$O,u$Z.path,u$K)}else{var u$X=u$q.materialPath;if(u$X)u$l._addHierarchyInnerUrls(u$t,u$b,u$E,u$O,u$X,ShurikenParticleMaterial);else{var u$_=u$q.texturePath;u$_&&u$l._addHierarchyInnerUrls(u$d,u$b,u$E,u$O,u$_,u$wj)}}break;case"Terrain":u$l._addHierarchyInnerUrls(u$d,u$b,u$E,u$O,u$W.customProps.dataPath,TerrainRes)}var u$N=u$W.components;for(var u$z in u$N){var u$C=u$N[u$z];switch(u$z){case"Animator":var u$L=u$C.avatarPath;if(u$L)u$l._addHierarchyInnerUrls(u$d,u$b,u$E,u$O,u$L,Avatar);else{var u$V=u$C.avatar;u$V&&u$l._addHierarchyInnerUrls(u$d,u$b,u$E,u$O,u$V.path,Avatar)}var u$x=u$C.clipPaths;for(u$A=0,u$c=u$x.length;u$A<u$c;u$A++)u$l._addHierarchyInnerUrls(u$d,u$b,u$E,u$O,u$x[u$A],AnimationClip)}}var u$G=u$W.child;for(u$A=0,u$c=u$G.length;u$A<u$c;u$A++)u$l._getSprite3DHierarchyInnerUrls(u$G[u$A],u$j,u$t,u$d,u$b,u$E,u$O)},u$l._loadHierarchy=function(u$W){u$W.on("loaded",null,u$l._onHierarchylhLoaded,[u$W,u$W._class._getGroup()]),u$W.load(u$W.url,"json",!1,null,!0)},u$l._onHierarchylhLoaded=function(u$W,u$j,u$t){if(u$W._class.destroyed)u$W.endLoad();else{var u$d=u$W.url,u$b=u$Kj.getURLVerion(u$d),u$E=u$x.getPath(u$d),u$O=[],u$q=[],u$A=[],u$c={};u$l._getSprite3DHierarchyInnerUrls(u$t,u$O,u$q,u$A,u$c,u$b,u$E);var u$R=u$O.length+u$q.length+u$A.length,u$m=u$R+1,u$Q=1/u$m;if(u$l._onProcessChange(u$W,0,u$Q,1),0<u$A.length){var u$T=u$R/u$m,u$$=u$V.create(null,u$l._onProcessChange,[u$W,u$Q,u$T],!1);u$l._innerFourthLevelLoaderManager.create(u$A,u$V.create(null,u$l._onHierarchyInnerForthLevResouLoaded,[u$W,u$j,u$$,u$t,u$c,u$O,u$q,u$Q+u$T*u$A.length,u$T]),u$$,null,null,1,!0,u$j)}else u$l._onHierarchyInnerForthLevResouLoaded(u$W,u$j,null,u$t,u$c,u$O,u$q,u$Q,u$T)}},u$l._onHierarchyInnerForthLevResouLoaded=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){if(u$W._class.destroyed)u$W.endLoad();else if(u$t&&u$t.recover(),0<u$O.length){var u$c=u$V.create(null,u$l._onProcessChange,[u$W,u$q,u$A],!1);u$l._innerSecondLevelLoaderManager.create(u$O,u$V.create(null,u$l._onHierarchyInnerSecondLevResouLoaded,[u$W,u$j,u$c,u$d,u$b,u$E,u$q+u$A*u$O.length,u$A]),u$t,null,null,1,!0,u$j)}else u$l._onHierarchyInnerSecondLevResouLoaded(u$W,u$j,null,u$d,u$b,u$E,u$q,u$A)},u$l._onHierarchyInnerSecondLevResouLoaded=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q){if(u$W._class.destroyed)u$W.endLoad();else if(u$t&&u$t.recover(),0<u$E.length){var u$A=u$V.create(null,u$l._onProcessChange,[u$W,u$O,u$q],!1);u$l._innerFirstLevelLoaderManager.create(u$E,u$V.create(null,u$l._onHierarchyInnerFirstLevResouLoaded,[u$W,u$A,u$d,u$b]),u$t,null,null,1,!0,u$j)}else u$l._onHierarchyInnerFirstLevResouLoaded(u$W,null,u$d,u$b)},u$l._onHierarchyInnerFirstLevResouLoaded=function(u$W,u$j,u$t,u$d){u$j&&u$j.recover(),u$W.endLoad([u$t,u$d])},u$l._loadTerrain=function(u$W){u$W.on("loaded",null,u$l._onTerrainLtLoaded,[u$W,u$W._class._getGroup()]),u$W.load(u$W.url,"json",!1,null,!0)},u$l._onTerrainLtLoaded=function(u$W,u$j,u$t){if(u$W._class.destroyed)u$W.endLoad();else{var u$d,u$b,u$E=u$W.url,u$O=u$Kj.getURLVerion(u$E),u$q=u$x.getPath(u$E),u$A=[],u$c={},u$R=0,u$m=0,u$Q=u$t.heightData;u$d=u$Q.url,u$b=u$l.formatRelativePath(u$q,u$d),u$O&&(u$b+=u$O),u$d=u$c[u$d]=u$b;var u$T=u$t.detailTexture;for(u$R=0,u$m=u$T.length;u$R<u$m;u$R++)u$A.push({url:u$T[u$R].diffuse});var u$$=u$t.normalMap;for(u$R=0,u$m=u$$.length;u$R<u$m;u$R++)u$A.push({url:u$$[u$R]});var u$e=u$t.alphaMap;for(u$R=0,u$m=u$e.length;u$R<u$m;u$R++)u$A.push({url:u$e[u$R],params:[!1,!1,6408,!0]});for(u$R=0,u$m=u$A.length;u$R<u$m;u$R++){var u$K=u$A[u$R].url;u$b=u$l.formatRelativePath(u$q,u$K),u$O&&(u$b+=u$O),u$A[u$R].url=u$b,u$c[u$K]=u$b}var u$o=u$A.length,u$S=u$o+2,u$M=1/u$S;u$l._onProcessChange(u$W,0,u$M,1);var u$Z={heightMapLoaded:!1,texturesLoaded:!1},u$X=u$V.create(null,u$l._onProcessChange,[u$W,u$M,u$M],!1);u$l._innerFourthLevelLoaderManager.create(u$d,u$V.create(null,u$l._onTerrainHeightMapLoaded,[u$W,u$X,u$t,u$c,u$Z]),u$X,null,[u$Q.numX,u$Q.numZ,u$Q.bitType,u$Q.value],1,!0,u$j);var u$_=u$V.create(null,u$l._onProcessChange,[u$W,2*u$M,u$o/u$S],!1);u$l._innerFourthLevelLoaderManager.create(u$A,u$V.create(null,u$l._onTerrainTexturesLoaded,[u$W,u$_,u$t,u$c,u$Z]),u$_,null,null,1,!0,u$j)}},u$l._onTerrainHeightMapLoaded=function(u$W,u$j,u$t,u$d,u$b){u$b.heightMapLoaded=!0,u$b.texturesLoaded&&(u$W.endLoad([u$t,u$d]),u$j.recover())},u$l._onTerrainTexturesLoaded=function(u$W,u$j,u$t,u$d,u$b){u$b.texturesLoaded=!0,u$b.heightMapLoaded&&(u$W.endLoad([u$t,u$d]),u$j.recover())},u$l._loadMesh=function(u$W){u$W.on("loaded",null,u$l._onMeshLmLoaded,[u$W,u$W._class._getGroup()]),u$W.load(u$W.url,"arraybuffer",!1,null,!0)},u$l._onMeshLmLoaded=function(u$W,u$j,u$t){if(u$W._class.destroyed)u$W.endLoad();else{var u$d,u$b,u$E,u$O=u$W.url,u$q=u$Kj.getURLVerion(u$O),u$A=u$x.getPath(u$O),u$c={},u$R=0,u$m=0;switch((u$l._readData=new u$_(u$t)).pos=0,u$l._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var u$Q=u$l._readData.getUint32();u$l._readData.pos=u$l._readData.pos+4,u$m=u$l._readData.getUint16(),u$l._readData.pos=u$l._readData.pos+8*u$m;var u$T=u$l._readData.getUint32();for(u$m=u$l._readData.getUint16(),u$l._readData.pos=u$Q+u$T,u$d=[],u$R=0;u$R<u$m;u$R++){var u$$=u$l._readData.readUTFString();-1!==u$$.lastIndexOf(".lmat")&&u$d.push(u$$)}break;default:for(u$l.READ_BLOCK(),u$R=0;u$R<2;u$R++){var u$e=u$l._readData.getUint16(),u$K=u$l._strings[u$e],u$o=u$l["READ_"+u$K];if(null==u$o)throw new Error("model file err,no this function:"+u$e+" "+u$K);1===u$R?u$d=u$o.call():u$o.call()}}for(u$R=0,u$E=u$d.length;u$R<u$E;u$R++){var u$S=u$d[u$R];u$b=u$l.formatRelativePath(u$A,u$S),u$q&&(u$b+=u$q),u$d[u$R]=u$b,u$c[u$S]=u$b}if(0<u$d.length){u$l._onProcessChange(u$W,0,.5,1);var u$M=u$V.create(null,u$l._onProcessChange,[u$W,.5,.5],!1);u$l._innerSecondLevelLoaderManager.create(u$d,u$V.create(null,u$l._onMeshMateialLoaded,[u$W,u$M,u$t,u$c]),u$M,null,null,1,!0,u$j)}else u$W.endLoad([u$t,u$c])}},u$l._onMeshMateialLoaded=function(u$W,u$j,u$t,u$d){u$W.endLoad([u$t,u$d]),u$j.recover()},u$l._getMaterialTexturePath=function(u$W,u$j,u$t){var u$d=u$W.length-4;return u$W.indexOf(".dds")!=u$d&&u$W.indexOf(".tga")!=u$d&&u$W.indexOf(".exr")!=u$d&&u$W.indexOf(".DDS")!=u$d&&u$W.indexOf(".TGA")!=u$d&&u$W.indexOf(".EXR")!=u$d||(u$W=u$W.substr(0,u$d)+".png"),u$W=u$l.formatRelativePath(u$t,u$W),u$j&&(u$W+=u$j),u$W},u$l._loadMaterial=function(u$W){u$W.on("loaded",null,u$l._onMaterilLmatLoaded,[u$W,u$W._class._getGroup()]),u$W.load(u$W.url,"json",!1,null,!0)},u$l._onMaterilLmatLoaded=function(u$W,u$j,u$t){if(u$W._class.destroyed)u$W.endLoad();else{var u$d,u$b=u$W.url,u$E=u$Kj.getURLVerion(u$b),u$O=u$x.getPath(u$b),u$q=[],u$A={},u$c=u$t.customProps,u$R=u$t.version;if(u$R)switch(u$R){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var u$m=u$t.props.textures,u$Q=0,u$T=u$m.length;u$Q<u$T;u$Q++){var u$$=u$m[u$Q],u$e=u$$.path;if(u$e){var u$K=u$e.length-4;u$e.indexOf(".exr")!=u$K&&u$e.indexOf(".EXR")!=u$K||(u$e=u$e.substr(0,u$K)+".png"),u$d=u$l.formatRelativePath(u$O,u$e),u$E&&(u$d+=u$E),u$q.push({url:u$d,params:u$$.params}),u$A[u$e]=u$d}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var u$o=u$c.diffuseTexture.texture2D;if(u$o&&(u$d=u$l._getMaterialTexturePath(u$o,u$E,u$O),u$q.push(u$d),u$A[u$o]=u$d),u$c.normalTexture){var u$S=u$c.normalTexture.texture2D;u$S&&(u$d=u$l._getMaterialTexturePath(u$S,u$E,u$O),u$q.push(u$d),u$A[u$S]=u$d)}if(u$c.specularTexture){var u$M=u$c.specularTexture.texture2D;u$M&&(u$d=u$l._getMaterialTexturePath(u$M,u$E,u$O),u$q.push(u$d),u$A[u$M]=u$d)}if(u$c.emissiveTexture){var u$Z=u$c.emissiveTexture.texture2D;u$Z&&(u$d=u$l._getMaterialTexturePath(u$Z,u$E,u$O),u$q.push(u$d),u$A[u$Z]=u$d)}if(u$c.ambientTexture){var u$X=u$c.ambientTexture.texture2D;u$X&&(u$d=u$l._getMaterialTexturePath(u$X,u$E,u$O),u$q.push(u$d),u$A[u$X]=u$d)}if(u$c.reflectTexture){var u$_=u$c.reflectTexture.texture2D;u$_&&(u$d=u$l._getMaterialTexturePath(u$_,u$E,u$O),u$q.push(u$d),u$A[u$_]=u$d)}}var u$N=u$q.length,u$z=u$N+1,u$C=1/u$z;if(u$l._onProcessChange(u$W,0,u$C,1),0<u$N){var u$L=u$V.create(null,u$l._onProcessChange,[u$W,u$C,u$N/u$z],!1);u$l._innerFourthLevelLoaderManager.create(u$q,u$V.create(null,u$l._onMateialTexturesLoaded,[u$W,u$L,u$t,u$A]),u$L,u$wj,null,1,!0,u$j)}else u$l._onMateialTexturesLoaded(u$W,null,u$t,null)}},u$l._onMateialTexturesLoaded=function(u$W,u$j,u$t,u$d){u$W.endLoad([u$t,u$d]),u$j&&u$j.recover()},u$l._loadTextureCube=function(u$W){u$W.on("loaded",null,u$l._onTextureCubeLtcLoaded,[u$W]),u$W.load(u$W.url,"json",!1,null,!0)},u$l._onTextureCubeLtcLoaded=function(u$W,u$j){if(u$W._class.destroyed)u$W.endLoad();else{var u$t=u$x.getPath(u$W.url),u$d=[u$l.formatRelativePath(u$t,u$j.px),u$l.formatRelativePath(u$t,u$j.nx),u$l.formatRelativePath(u$t,u$j.py),u$l.formatRelativePath(u$t,u$j.ny),u$l.formatRelativePath(u$t,u$j.pz),u$l.formatRelativePath(u$t,u$j.nz)];u$l._onProcessChange(u$W,0,1/7,1);var u$b=u$V.create(null,u$l._onProcessChange,[u$W,1/7,6/7],!1);u$l._innerFourthLevelLoaderManager.load(u$d,u$V.create(null,u$l._onTextureCubeImagesLoaded,[u$W,u$d,u$b]),u$b,"nativeimage")}},u$l._onTextureCubeImagesLoaded=function(u$W,u$j,u$t){var u$d=[];u$d.length=6;for(var u$b=0;u$b<6;u$b++){var u$E=u$j[u$b];u$d[u$b]=u$o.getRes(u$E),u$o.clearRes(u$E)}u$W.endLoad(u$d),u$t.recover()},u$l._onProcessChange=function(u$W,u$j,u$t,u$d){(u$d=u$j+u$d*u$t)<1&&u$W.event("progress",u$d)},u$l.init=function(u$W,u$j,u$t,u$d,u$b,u$E){if(void 0===u$t&&(u$t=!1),void 0===u$d&&(u$d=!1),void 0===u$b&&(u$b=!0),void 0===u$E&&(u$E=!0),u$S.update3DLoop=function(){},u$S.cancelLoadByUrl=function(u$W){u$l._cancelLoadByUrl(u$W)},u$A.isAntialias=u$t,u$A.isAlpha=u$d,u$A.premultipliedAlpha=u$b,u$A.isStencil=u$E,!u$G.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");u$S.changeWebGLSize=u$l._changeWebGLSize,u$e.is3DMode=!0,u$X.init(u$W,u$j),u$v.__init__(),u$mj.__init__(),u$Pj.__init__(),u$I.__init__(),u$l.__init__(),u$O.maxTextureCount=2,(u$l.debugMode||u$B.debugMode)&&(u$l._debugPhasorSprite=new u$J)},u$l.HIERARCHY="SPRITE3DHIERARCHY",u$l.MESH="MESH",u$l.MATERIAL="MATERIAL",u$l.PBRMATERIAL="PBRMTL",u$l.TEXTURECUBE="TEXTURECUBE",u$l.TERRAIN="TERRAIN",u$l._readData=null,u$l._debugPhasorSprite=null,u$l.debugMode=!1,u$m(u$l,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new u$j},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new u$j},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new u$j},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new u$j}]),u$l}(),u$Sj=function(u$W){function u$b(u$W){u$b.__super.call(this),this._owner=u$W,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}u$T(u$b,"laya.d3.animation.AnimationTransform3D",u$E);var u$j=u$b.prototype;return u$j._getlocalMatrix=function(){return this._localUpdate&&(u$Kj._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},u$j._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var u$W=0,u$j=this._childs.length;u$W<u$j;u$W++)this._childs[u$W]._onWorldTransform()}},u$j._setWorldMatrixAndUpdate=function(u$W){if(this._worldMatrix=u$W,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var u$j=this._getlocalMatrix(),u$t=0;u$t<16;++u$t)this._worldMatrix[u$t]=u$j[u$t];else u$Kj.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},u$j._setWorldMatrixNoUpdate=function(u$W){this._worldMatrix=u$W},u$j._setWorldMatrixIgnoreUpdate=function(u$W){this._worldMatrix=u$W,this._worldUpdate=!1},u$j.getLocalPosition=function(){return this._localPosition},u$j.setLocalPosition=function(u$W){if(this._parent)this._localPosition=u$W,this._localUpdate=!0,this._onWorldTransform();else{var u$j=this._entity.owner._transform,u$t=this._entity.localPosition,u$d=u$t.elements;u$d[0]=u$W[0],u$d[1]=u$W[1],u$d[2]=u$W[2],u$j.localPosition=u$t}},u$j.getLocalRotation=function(){if(this._localQuaternionUpdate){var u$W=this._localRotationEuler;u$Kj._quaternionCreateFromYawPitchRollArray(u$W[1]/u$b._angleToRandin,u$W[0]/u$b._angleToRandin,u$W[2]/u$b._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},u$j.setLocalRotation=function(u$W){if(this._parent)this._localRotation=u$W,u$Kj.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var u$j=this._entity.owner._transform,u$t=this._entity.localRotation,u$d=u$t.elements;u$d[0]=u$W[0],u$d[1]=u$W[1],u$d[2]=u$W[2],u$d[3]=u$W[3],u$j.localRotation=u$t}},u$j.getLocalScale=function(){return this._localScale},u$j.setLocalScale=function(u$W){if(this._parent)this._localScale=u$W,this._localUpdate=!0,this._onWorldTransform();else{var u$j=this._entity.owner._transform,u$t=this._entity.localScale,u$d=u$t.elements;u$d[0]=u$W[0],u$d[1]=u$W[1],u$d[2]=u$W[2],u$j.localScale=u$t}},u$j.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){u$Kj.getYawPitchRoll(this._localRotation,u$b._tempVector3);var u$W=u$b._tempVector3,u$j=this._localRotationEuler;u$j[0]=u$W[1]*u$b._angleToRandin,u$j[1]=u$W[0]*u$b._angleToRandin,u$j[2]=u$W[2]*u$b._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},u$j.setLocalRotationEuler=function(u$W){if(this._parent)u$Kj._quaternionCreateFromYawPitchRollArray(u$W[1]/u$b._angleToRandin,u$W[0]/u$b._angleToRandin,u$W[2]/u$b._angleToRandin,this._localRotation),this._localRotationEuler=u$W,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var u$j=this._entity.owner._transform,u$t=this._entity.localRotationEuler,u$d=u$t.elements;u$d[0]=u$W[0],u$d[1]=u$W[1],u$d[2]=u$W[2],u$j.localRotationEuler=u$t}},u$j.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)u$Kj.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var u$W=this._getlocalMatrix(),u$j=0;u$j<16;++u$j)this._worldMatrix[u$j]=u$W[u$j];this._worldUpdate=!1}return this._worldMatrix},u$j.setParent=function(u$W){if(this._parent!==u$W){if(this._parent){var u$j=this._parent._childs,u$t=u$j.indexOf(this);u$j.splice(u$t,1)}u$W&&(u$W._childs.push(this),u$W&&this._onWorldTransform()),this._parent=u$W}},u$m(u$b,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),u$b}(),u$Mj=function(u$W){function u$j(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,u$j.__super.call(this),this._destroyed=!1,this._id=u$j._uniqueIDCounter,u$j._uniqueIDCounter++}u$T(u$j,"laya.d3.component.Component3D",u$E);var u$t=u$j.prototype;return u$X.imps(u$t,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),u$t._initialize=function(u$W){this._owner=u$W,this._enable=!0,this.started=!1,this._load(u$W)},u$t._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},u$t._load=function(u$W){},u$t._start=function(u$W){},u$t._update=function(u$W){},u$t._lateUpdate=function(u$W){},u$t._preRenderUpdate=function(u$W){},u$t._postRenderUpdate=function(u$W){},u$t._unload=function(u$W){this.offAll()},u$t._cloneTo=function(u$W){},u$$(0,u$t,"id",function(){return this._id}),u$$(0,u$t,"destroyed",function(){return this._destroyed}),u$$(0,u$t,"owner",function(){return this._owner}),u$$(0,u$t,"enable",function(){return this._enable},function(u$W){this._enable!==u$W&&(this._enable=u$W,this.event("enablechanged",this._enable))}),u$$(0,u$t,"isSingleton",function(){return u$j._isSingleton}),u$j._isSingleton=!0,u$j._uniqueIDCounter=1,u$j}(),u$Zj=function(u$W){function u$j(){this._destroyed=!1,u$j.__super.call(this),this._destroyed=!1}u$T(u$j,"laya.d3.core.GeometryFilter",u$E);var u$t=u$j.prototype;return u$X.imps(u$t,{"laya.resource.IDestroy":!0}),u$t._destroy=function(){this.offAll(),this._destroyed=!0},u$$(0,u$t,"_isAsyncLoaded",function(){return!0}),u$$(0,u$t,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),u$$(0,u$t,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),u$$(0,u$t,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),u$$(0,u$t,"destroyed",function(){return this._destroyed}),u$j}(),u$Xj=function(u$W){function u$d(u$W){u$d.__super.call(this),this._id=++u$d._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new u$BW(new u$Oj,new u$Oj),this._boundingBoxCenter=new u$Oj,this._boundingSphere=new u$kW(new u$Oj,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=u$W,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}u$T(u$d,"laya.d3.core.render.BaseRender",u$E);var u$j=u$d.prototype;return u$X.imps(u$j,{"laya.resource.IDestroy":!0}),u$j._changeMaterialReference=function(u$W,u$j){u$W&&u$W._removeReference(),u$j._addReference()},u$j._getInstanceMaterial=function(u$W,u$j){var u$t=new u$W.constructor;return u$W.cloneTo(u$t),u$t.name=u$t.name+"(Instance)",this._materialsInstance[u$j]=!0,this._changeMaterialReference(this._materials[u$j],u$t),this._materials[u$j]=u$t},u$j._setShaderValuelightMap=function(u$W){this._setShaderValueTexture(3,u$W)},u$j._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},u$j._renderRenderableBoundBox=function(){var u$W=u$oj._debugPhasorSprite,u$j=this.boundingBox,u$t=u$d._tempBoundBoxCorners;u$j.getCorners(u$t),u$W.line(u$t[0],u$d._greenColor,u$t[1],u$d._greenColor),u$W.line(u$t[2],u$d._greenColor,u$t[3],u$d._greenColor),u$W.line(u$t[4],u$d._greenColor,u$t[5],u$d._greenColor),u$W.line(u$t[6],u$d._greenColor,u$t[7],u$d._greenColor),u$W.line(u$t[0],u$d._greenColor,u$t[3],u$d._greenColor),u$W.line(u$t[1],u$d._greenColor,u$t[2],u$d._greenColor),u$W.line(u$t[2],u$d._greenColor,u$t[6],u$d._greenColor),u$W.line(u$t[3],u$d._greenColor,u$t[7],u$d._greenColor),u$W.line(u$t[0],u$d._greenColor,u$t[4],u$d._greenColor),u$W.line(u$t[1],u$d._greenColor,u$t[5],u$d._greenColor),u$W.line(u$t[4],u$d._greenColor,u$t[7],u$d._greenColor),u$W.line(u$t[5],u$d._greenColor,u$t[6],u$d._greenColor)},u$j._calculateBoundingSphere=function(){throw"BaseRender: must override it."},u$j._calculateBoundingBox=function(){throw"BaseRender: must override it."},u$j._setShaderValueTexture=function(u$W,u$j){this._owner._shaderValues.setValue(u$W,u$j)},u$j._setShaderValueMatrix4x4=function(u$W,u$j){this._owner._shaderValues.setValue(u$W,u$j?u$j.elements:null)},u$j._setShaderValueColor=function(u$W,u$j){this._owner._shaderValues.setValue(u$W,u$j?u$j.elements:null)},u$j._setShaderValueBuffer=function(u$W,u$j){this._owner._shaderValues.setValue(u$W,u$j)},u$j._setShaderValueInt=function(u$W,u$j){this._owner._shaderValues.setValue(u$W,u$j)},u$j._setShaderValueBool=function(u$W,u$j){this._owner._shaderValues.setValue(u$W,u$j)},u$j._setShaderValueNumber=function(u$W,u$j){this._owner._shaderValues.setValue(u$W,u$j)},u$j._setShaderValueVector2=function(u$W,u$j){this._owner._shaderValues.setValue(u$W,u$j?u$j.elements:null)},u$j._addShaderDefine=function(u$W){this._owner._shaderDefineValue|=u$W},u$j._removeShaderDefine=function(u$W){this._owner._shaderDefineValue&=~u$W},u$j._renderUpdate=function(u$W){return!0},u$j._applyLightMapParams=function(){if(0<=this._lightmapIndex){var u$W=this._owner.scene;if(u$W){var u$j=u$W.getlightmaps()[this._lightmapIndex];u$j?(this._addShaderDefine(u$Jj.SAHDERDEFINE_LIGHTMAP),u$j.loaded?this._setShaderValuelightMap(u$j):u$j.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(u$Jj.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(u$Jj.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(u$Jj.SAHDERDEFINE_LIGHTMAP)},u$j._updateOctreeNode=function(){var u$W=this._treeNode;u$W&&this._octreeNodeNeedChange&&(u$W.updateObject(this),this._octreeNodeNeedChange=!1)},u$j._destroy=function(){this.offAll();var u$W=0,u$j=0;for(u$W=0,u$j=this._renderElements.length;u$W<u$j;u$W++)this._renderElements[u$W]._destroy();for(u$W=0,u$j=this._materials.length;u$W<u$j;u$W++)this._materials[u$W]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},u$$(0,u$j,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),u$$(0,u$j,"id",function(){return this._id}),u$$(0,u$j,"material",function(){var u$W=this._materials[0];if(u$W&&!this._materialsInstance[0]){var u$j=this._getInstanceMaterial(u$W,0);this.event("materialchanged",[this,0,u$j])}return this._materials[0]},function(u$W){this.sharedMaterial=u$W}),u$$(0,u$j,"sharedMaterial",function(){return this._materials[0]},function(u$W){var u$j=this._materials[0];u$j!==u$W&&(this._materials[0]=u$W,this._materialsInstance[0]=!1,this._changeMaterialReference(u$j,u$W),this.event("materialchanged",[this,0,u$W]))}),u$$(0,u$j,"lightmapIndex",function(){return this._lightmapIndex},function(u$W){this._lightmapIndex=u$W,this._applyLightMapParams()}),u$$(0,u$j,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(u$W){this._lightmapScaleOffset=u$W,this._setShaderValueColor(2,u$W),this._addShaderDefine(u$Jj.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),u$$(0,u$j,"enable",function(){return this._enable},function(u$W){this._enable=u$W,this.event("enablechanged",[this,u$W])}),u$$(0,u$j,"materials",function(){for(var u$W=0,u$j=this._materials.length;u$W<u$j;u$W++)if(!this._materialsInstance[u$W]){var u$t=this._getInstanceMaterial(this._materials[u$W],u$W);this.event("materialchanged",[this,u$W,u$t])}return this._materials.slice()},function(u$W){this.sharedMaterials=u$W}),u$$(0,u$j,"sharedMaterials",function(){return this._materials.slice()},function(u$W){if(!u$W)throw new Error("MeshRender: shadredMaterials value can't be null.");var u$j=u$W.length;this._materialsInstance.length=u$j;for(var u$t=0;u$t<u$j;u$t++){var u$d=this._materials[u$t];u$d!==u$W[u$t]&&(this._materialsInstance[u$t]=!1,this._changeMaterialReference(u$d,u$W[u$t]),this.event("materialchanged",[this,u$t,u$W[u$t]]))}this._materials=u$W}),u$$(0,u$j,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),u$$(0,u$j,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var u$W=this.boundingBox;u$Oj.add(u$W.min,u$W.max,this._boundingBoxCenter),u$Oj.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),u$$(0,u$j,"receiveShadow",function(){return this._receiveShadow},function(u$W){this._receiveShadow!==u$W&&((this._receiveShadow=u$W)?this._addShaderDefine(u$Tj.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(u$Tj.SHADERDEFINE_RECEIVE_SHADOW))}),u$$(0,u$j,"destroyed",function(){return this._destroyed}),u$d._uniqueIDCounter=0,u$m(u$d,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj,new u$Oj]},"_greenColor",function(){return this._greenColor=new u$qj(0,1,0,1)}]),u$d}(),u$_j=function(u$W){function u$q(u$W){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,u$q.__super.call(this),this._localPosition=new u$Oj,this._localRotation=new u$tj(0,0,0,1),this._localScale=new u$Oj(1,1,1),this._localRotationEuler=new u$Oj,this._localMatrix=new u$Wj,this._position=new u$Oj,this._rotation=new u$tj(0,0,0,1),this._scale=new u$Oj(1,1,1),this._worldMatrix=new u$Wj,this._forward=new u$Oj,this._up=new u$Oj,this._right=new u$Oj,this._owner=u$W,this._childs=[]}u$T(u$q,"laya.d3.core.Transform3D",u$E);var u$j=u$q.prototype;return u$j._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)u$Wj.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var u$W=u$q._tempVector30;u$Oj.multiply(this.pivot,this._localScale,u$W);var u$j=u$q._tempVector31;u$Oj.subtract(u$W,this.pivot,u$j);var u$t=u$q._tempVector32,u$d=this.localRotation;u$Oj.transformQuat(u$W,u$d,u$t),u$Oj.subtract(u$t,u$W,u$t);var u$b=u$q._tempVector33;u$Oj.subtract(this._localPosition,u$j,u$b),u$Oj.subtract(u$b,u$t,u$b),u$Wj.createAffineTransformation(u$b,u$d,this._localScale,this._localMatrix)}},u$j._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var u$W=0,u$j=this._childs.length;u$W<u$j;u$W++)this._childs[u$W]._onWorldPositionRotationTransform()}},u$j._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var u$W=0,u$j=this._childs.length;u$W<u$j;u$W++)this._childs[u$W]._onWorldPositionScaleTransform()}},u$j._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var u$W=0,u$j=this._childs.length;u$W<u$j;u$W++)this._childs[u$W]._onWorldPositionTransform()}},u$j._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var u$W=0,u$j=this._childs.length;u$W<u$j;u$W++)this._childs[u$W]._onWorldPositionRotationTransform()}},u$j._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var u$W=0,u$j=this._childs.length;u$W<u$j;u$W++)this._childs[u$W]._onWorldPositionScaleTransform()}},u$j._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var u$W=0,u$j=this._childs.length;u$W<u$j;u$W++)this._childs[u$W]._onWorldTransform()}},u$j.translate=function(u$W,u$j){void 0===u$j&&(u$j=!0),u$j?(u$Wj.createFromQuaternion(this.localRotation,u$q._tempMatrix0),u$Oj.transformCoordinate(u$W,u$q._tempMatrix0,u$q._tempVector30),u$Oj.add(this.localPosition,u$q._tempVector30,this._localPosition),this.localPosition=this._localPosition):(u$Oj.add(this.position,u$W,this._position),this.position=this._position)},u$j.rotate=function(u$W,u$j,u$t){var u$d;void 0===u$j&&(u$j=!0),void 0===u$t&&(u$t=!0),u$d=u$t?u$W:(u$Oj.scale(u$W,Math.PI/180,u$q._tempVector30),u$q._tempVector30),u$tj.createFromYawPitchRoll(u$d.y,u$d.x,u$d.z,u$q._tempQuaternion0),u$j?(u$tj.multiply(this._localRotation,u$q._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(u$tj.multiply(u$q._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},u$j.lookAt=function(u$W,u$j,u$t){void 0===u$t&&(u$t=!1);var u$d,u$b=u$W.elements;if(u$t){if(u$d=this._localPosition.elements,Math.abs(u$d[0]-u$b[0])<u$pW.zeroTolerance&&Math.abs(u$d[1]-u$b[1])<u$pW.zeroTolerance&&Math.abs(u$d[2]-u$b[2])<u$pW.zeroTolerance)return;u$tj.lookAt(this._localPosition,u$W,u$j,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var u$E=this.position;if(u$d=u$E.elements,Math.abs(u$d[0]-u$b[0])<u$pW.zeroTolerance&&Math.abs(u$d[1]-u$b[1])<u$pW.zeroTolerance&&Math.abs(u$d[2]-u$b[2])<u$pW.zeroTolerance)return;u$tj.lookAt(u$E,u$W,u$j,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},u$$(0,u$j,"_isFrontFaceInvert",function(){var u$W=this.scale,u$j=u$W.x<0;return u$W.y<0&&(u$j=!u$j),u$W.z<0&&(u$j=!u$j),u$j}),u$$(0,u$j,"owner",function(){return this._owner}),u$$(0,u$j,"localRotation",function(){if(this._localQuaternionUpdate){var u$W=this._localRotationEuler.elements;u$tj.createFromYawPitchRoll(u$W[1]/u$q._angleToRandin,u$W[0]/u$q._angleToRandin,u$W[2]/u$q._angleToRandin,this._localRotation)}return this._localRotation},function(u$W){this._localRotation=u$W,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),u$$(0,u$j,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?u$Wj.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(u$W){null===this._parent?u$W.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),u$Wj.multiply(this._localMatrix,u$W,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=u$W,this._worldUpdate=!1}),u$$(0,u$j,"worldNeedUpdate",function(){return this._worldUpdate}),u$$(0,u$j,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(u$W){this._localMatrix=u$W,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),u$$(0,u$j,"dummy",function(){return this._dummy},function(u$W){this._dummy!==u$W&&(this._dummy&&(this._dummy._entity=null),u$W&&(u$W._entity=this),this._dummy=u$W)}),u$$(0,u$j,"localPosition",function(){return this._localPosition},function(u$W){this._localPosition=u$W,this._localUpdate=!0,this._onWorldPositionTransform()}),u$$(0,u$j,"position",function(){if(this._positionUpdate){if(null!=this._parent){var u$W=this._parent.position;u$Oj.multiply(this._localPosition,this._parent.scale,u$q._tempVector30),u$Oj.transformQuat(u$q._tempVector30,this._parent.rotation,u$q._tempVector30),u$Oj.add(u$W,u$q._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(u$W){if(null!=this._parent){u$Oj.subtract(u$W,this._parent.position,this._localPosition);var u$j=this._parent.scale.elements,u$t=u$j[0],u$d=u$j[1],u$b=u$j[2];if(1!==u$t||1!==u$d||1!==u$b){var u$E=u$q._tempVector30,u$O=u$E.elements;u$O[0]=1/u$t,u$O[1]=1/u$d,u$O[2]=1/u$b,u$Oj.multiply(this._localPosition,u$E,this._localPosition)}this._parent.rotation.invert(u$q._tempQuaternion0),u$Oj.transformQuat(this._localPosition,u$q._tempQuaternion0,this._localPosition)}else u$W.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=u$W,this._positionUpdate=!1}),u$$(0,u$j,"localScale",function(){return this._localScale},function(u$W){this._localScale=u$W,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),u$$(0,u$j,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(u$q._tempVector30);var u$W=u$q._tempVector30.elements,u$j=this._localRotationEuler.elements;u$j[0]=u$W[1]*u$q._angleToRandin,u$j[1]=u$W[0]*u$q._angleToRandin,u$j[2]=u$W[2]*u$q._angleToRandin}return this._localRotationEuler},function(u$W){this._localRotationEuler=u$W,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),u$$(0,u$j,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?u$tj.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(u$W){null!=this._parent?(this._parent.rotation.invert(u$q._tempQuaternion0),u$tj.multiply(u$W,u$q._tempQuaternion0,this._localRotation)):u$W.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=u$W,this._rotationUpdate=!1}),u$$(0,u$j,"scale",function(){return this._scaleUpdate&&(null!==this._parent?u$Oj.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(u$W){if(null!==this._parent){var u$j=this._parent.scale.elements,u$t=u$q._tempVector30.elements;u$t[0]=1/u$j[0],u$t[1]=1/u$j[1],u$t[2]=1/u$j[2],u$Oj.multiply(u$W,u$q._tempVector30,this._localScale)}else u$W.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=u$W,this._scaleUpdate=!1}),u$$(0,u$j,"rotationEuler",null,function(u$W){u$tj.createFromYawPitchRoll(u$W.y,u$W.x,u$W.z,this._rotation),this.rotation=this._rotation}),u$$(0,u$j,"forward",function(){var u$W=this.worldMatrix.elements;return this._forward.elements[0]=-u$W[8],this._forward.elements[1]=-u$W[9],this._forward.elements[2]=-u$W[10],this._forward}),u$$(0,u$j,"up",function(){var u$W=this.worldMatrix.elements;return this._up.elements[0]=u$W[4],this._up.elements[1]=u$W[5],this._up.elements[2]=u$W[6],this._up}),u$$(0,u$j,"right",function(){var u$W=this.worldMatrix.elements;return this._right.elements[0]=u$W[0],this._right.elements[1]=u$W[1],this._right.elements[2]=u$W[2],this._right}),u$$(0,u$j,"parent",function(){return this._parent},function(u$W){if(this._parent!==u$W){if(this._parent){var u$j=this._parent._childs,u$t=u$j.indexOf(this);u$j.splice(u$t,1)}u$W&&(u$W._childs.push(this),u$W&&this._onWorldTransform()),this._parent=u$W}}),u$m(u$q,["_tempVector30",function(){return this._tempVector30=new u$Oj},"_tempVector31",function(){return this._tempVector31=new u$Oj},"_tempVector32",function(){return this._tempVector32=new u$Oj},"_tempVector33",function(){return this._tempVector33=new u$Oj},"_tempQuaternion0",function(){return this._tempQuaternion0=new u$tj},"_tempMatrix0",function(){return this._tempMatrix0=new u$Wj},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),u$q}(),u$Nj=(function(u$W){function u$j(){this._rotation=0,this._matNeedUpdte=!1,u$j.__super.call(this),this._matrix=new u$Wj,this._offset=new u$Ej,this._tiling=new u$Ej(1,1)}u$T(u$j,"laya.d3.core.TransformUV",u$E);var u$t=u$j.prototype;u$X.imps(u$t,{"laya.d3.core.IClone":!0}),u$t._updateMatrix=function(){u$j._tempOffsetV3.elements[0]=this._offset.x,u$j._tempOffsetV3.elements[1]=this._offset.y,u$tj.createFromYawPitchRoll(0,0,this._rotation,u$j._tempRotationQua),u$j._tempTitlingV3.elements[0]=this._tiling.x,u$j._tempTitlingV3.elements[1]=this._tiling.y,u$Wj.createAffineTransformation(u$j._tempOffsetV3,u$j._tempRotationQua,u$j._tempTitlingV3,this._matrix)},u$t.cloneTo=function(u$W){u$W._matrix=this._matrix.clone(),u$W._offset=this._offset.clone(),u$W._rotation=this._rotation,u$W._tiling=this._tiling.clone()},u$t.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$t,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),u$$(0,u$t,"tiling",function(){return this._tiling},function(u$W){this._tiling=u$W,this._matNeedUpdte=!0}),u$$(0,u$t,"offset",function(){return this._offset},function(u$W){this._offset=u$W,this._matNeedUpdte=!0}),u$$(0,u$t,"rotation",function(){return this._rotation},function(u$W){this._rotation=u$W,this._matNeedUpdte=!0}),u$m(u$j,["_tempOffsetV3",function(){return this._tempOffsetV3=new u$Oj(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new u$tj},"_tempTitlingV3",function(){return this._tempTitlingV3=new u$Oj(1,1,1)}])}(),function(u$t){function u$W(){this.x=NaN,this.y=NaN,this.z=NaN,u$W.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}u$T(u$W,"laya.d3.core.particleShuriKen.module.shape.BoxShape",u$t);var u$j=u$W.prototype;u$j._getShapeBoundBox=function(u$W){var u$j=u$W.min.elements;u$j[0]=.5*-this.x,u$j[1]=.5*-this.y,u$j[2]=.5*-this.z;var u$t=u$W.max.elements;u$t[0]=.5*this.x,u$t[1]=.5*this.y,u$t[2]=.5*this.z},u$j._getSpeedBoundBox=function(u$W){var u$j=u$W.min.elements;u$j[0]=0,u$j[1]=0,u$j[2]=0;var u$t=u$W.max.elements;u$t[0]=0,u$t[1]=1,u$t[2]=0},u$j.generatePositionAndDirection=function(u$W,u$j,u$t,u$d){var u$b=u$W.elements,u$E=u$j.elements;u$t?(u$t.seed=u$d[16],u$w._randomPointInsideHalfUnitBox(u$W,u$t),u$d[16]=u$t.seed):u$w._randomPointInsideHalfUnitBox(u$W),u$b[0]=this.x*u$b[0],u$b[1]=this.y*u$b[1],u$b[2]=this.z*u$b[2],this.randomDirection?u$t?(u$t.seed=u$d[17],u$w._randomPointUnitSphere(u$j,u$t),u$d[17]=u$t.seed):u$w._randomPointUnitSphere(u$j):(u$E[0]=0,u$E[1]=0,u$E[2]=1)},u$j.cloneTo=function(u$W){u$t.prototype.cloneTo.call(this,u$W);var u$j=u$W;u$j.x=this.x,u$j.y=this.y,u$j.z=this.z,u$j.randomDirection=this.randomDirection}}(u$Y),function(u$t){function u$O(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,u$O.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}u$T(u$O,"laya.d3.core.particleShuriKen.module.shape.CircleShape",u$t);var u$W=u$O.prototype;u$W._getShapeBoundBox=function(u$W){var u$j=u$W.min.elements;u$j[0]=u$j[2]=-this.radius,u$j[1]=0;var u$t=u$W.max.elements;u$t[0]=u$t[2]=this.radius,u$t[1]=0},u$W._getSpeedBoundBox=function(u$W){var u$j=u$W.min.elements;u$j[0]=u$j[1]=-1,u$j[2]=0;var u$t=u$W.max.elements;u$t[0]=u$t[1]=1,u$t[2]=0},u$W.generatePositionAndDirection=function(u$W,u$j,u$t,u$d){var u$b=u$W.elements,u$E=u$O._tempPositionPoint.elements;u$t?(u$t.seed=u$d[16],this.emitFromEdge?u$w._randomPointUnitArcCircle(this.arc,u$O._tempPositionPoint,u$t):u$w._randomPointInsideUnitArcCircle(this.arc,u$O._tempPositionPoint,u$t),u$d[16]=u$t.seed):this.emitFromEdge?u$w._randomPointUnitArcCircle(this.arc,u$O._tempPositionPoint):u$w._randomPointInsideUnitArcCircle(this.arc,u$O._tempPositionPoint),u$b[0]=-u$E[0],u$b[1]=u$E[1],u$b[2]=0,u$Oj.scale(u$W,this.radius,u$W),this.randomDirection?u$t?(u$t.seed=u$d[17],u$w._randomPointUnitSphere(u$j,u$t),u$d[17]=u$t.seed):u$w._randomPointUnitSphere(u$j):u$W.cloneTo(u$j)},u$W.cloneTo=function(u$W){u$t.prototype.cloneTo.call(this,u$W);var u$j=u$W;u$j.radius=this.radius,u$j.arc=this.arc,u$j.emitFromEdge=this.emitFromEdge,u$j.randomDirection=this.randomDirection},u$m(u$O,["_tempPositionPoint",function(){return this._tempPositionPoint=new u$Ej}])}(u$Y),function(u$t){function u$Q(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,u$Q.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}u$T(u$Q,"laya.d3.core.particleShuriKen.module.shape.ConeShape",u$t);var u$W=u$Q.prototype;u$W._getShapeBoundBox=function(u$W){var u$j=this.radius+this.length*Math.sin(this.angle),u$t=this.length*Math.cos(this.angle),u$d=u$W.min.elements;u$d[0]=u$d[1]=-u$j,u$d[2]=0;var u$b=u$W.max.elements;u$b[0]=u$b[1]=u$j,u$b[2]=u$t},u$W._getSpeedBoundBox=function(u$W){var u$j=Math.sin(this.angle),u$t=u$W.min.elements;u$t[0]=u$t[1]=-u$j,u$t[2]=0;var u$d=u$W.max.elements;u$d[0]=u$t[1]=u$j,u$d[2]=1},u$W.generatePositionAndDirection=function(u$W,u$j,u$t,u$d){var u$b,u$E=u$W.elements,u$O=u$j.elements,u$q=u$Q._tempPositionPoint.elements,u$A=NaN,u$c=NaN,u$R=Math.cos(this.angle),u$m=Math.sin(this.angle);switch(this.emitType){case 0:u$t?(u$t.seed=u$d[16],u$w._randomPointInsideUnitCircle(u$Q._tempPositionPoint,u$t),u$d[16]=u$t.seed):u$w._randomPointInsideUnitCircle(u$Q._tempPositionPoint),u$A=u$q[0],u$c=u$q[1],u$E[0]=u$A*this.radius,u$E[1]=u$c*this.radius,u$E[2]=0,this.randomDirection?(u$t?(u$t.seed=u$d[17],u$w._randomPointInsideUnitCircle(u$Q._tempDirectionPoint,u$t),u$d[17]=u$t.seed):u$w._randomPointInsideUnitCircle(u$Q._tempDirectionPoint),u$b=u$Q._tempDirectionPoint.elements,u$O[0]=u$b[0]*u$m,u$O[1]=u$b[1]*u$m):(u$O[0]=u$A*u$m,u$O[1]=u$c*u$m),u$O[2]=u$R;break;case 1:u$t?(u$t.seed=u$d[16],u$w._randomPointUnitCircle(u$Q._tempPositionPoint,u$t),u$d[16]=u$t.seed):u$w._randomPointUnitCircle(u$Q._tempPositionPoint),u$A=u$q[0],u$c=u$q[1],u$E[0]=u$A*this.radius,u$E[1]=u$c*this.radius,u$E[2]=0,this.randomDirection?(u$t?(u$t.seed=u$d[17],u$w._randomPointInsideUnitCircle(u$Q._tempDirectionPoint,u$t),u$d[17]=u$t.seed):u$w._randomPointInsideUnitCircle(u$Q._tempDirectionPoint),u$b=u$Q._tempDirectionPoint.elements,u$O[0]=u$b[0]*u$m,u$O[1]=u$b[1]*u$m):(u$O[0]=u$A*u$m,u$O[1]=u$c*u$m),u$O[2]=u$R;break;case 2:u$t?(u$t.seed=u$d[16],u$w._randomPointInsideUnitCircle(u$Q._tempPositionPoint,u$t)):u$w._randomPointInsideUnitCircle(u$Q._tempPositionPoint),u$A=u$q[0],u$c=u$q[1],u$E[0]=u$A*this.radius,u$E[1]=u$c*this.radius,u$O[u$E[2]=0]=u$A*u$m,u$O[1]=u$c*u$m,u$O[2]=u$R,u$Oj.normalize(u$j,u$j),u$t?(u$Oj.scale(u$j,this.length*u$t.getFloat(),u$j),u$d[16]=u$t.seed):u$Oj.scale(u$j,this.length*Math.random(),u$j),u$Oj.add(u$W,u$j,u$W),this.randomDirection&&(u$t?(u$t.seed=u$d[17],u$w._randomPointUnitSphere(u$j,u$t),u$d[17]=u$t.seed):u$w._randomPointUnitSphere(u$j));break;case 3:u$t?(u$t.seed=u$d[16],u$w._randomPointUnitCircle(u$Q._tempPositionPoint,u$t)):u$w._randomPointUnitCircle(u$Q._tempPositionPoint),u$A=u$q[0],u$c=u$q[1],u$E[0]=u$A*this.radius,u$E[1]=u$c*this.radius,u$O[u$E[2]=0]=u$A*u$m,u$O[1]=u$c*u$m,u$O[2]=u$R,u$Oj.normalize(u$j,u$j),u$t?(u$Oj.scale(u$j,this.length*u$t.getFloat(),u$j),u$d[16]=u$t.seed):u$Oj.scale(u$j,this.length*Math.random(),u$j),u$Oj.add(u$W,u$j,u$W),this.randomDirection&&(u$t?(u$t.seed=u$d[17],u$w._randomPointUnitSphere(u$j,u$t),u$d[17]=u$t.seed):u$w._randomPointUnitSphere(u$j));break;default:throw new Error("ConeShape:emitType is invalid.")}},u$W.cloneTo=function(u$W){u$t.prototype.cloneTo.call(this,u$W);var u$j=u$W;u$j.angle=this.angle,u$j.radius=this.radius,u$j.length=this.length,u$j.emitType=this.emitType,u$j.randomDirection=this.randomDirection},u$m(u$Q,["_tempPositionPoint",function(){return this._tempPositionPoint=new u$Ej},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new u$Ej}])}(u$Y),function(u$t){function u$W(){this.radius=NaN,this.emitFromShell=!1,u$W.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}u$T(u$W,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",u$t);var u$j=u$W.prototype;u$j._getShapeBoundBox=function(u$W){var u$j=u$W.min.elements;u$j[0]=u$j[1]=u$j[2]=-this.radius;var u$t=u$W.max.elements;u$t[0]=u$t[1]=this.radius,u$t[2]=0},u$j._getSpeedBoundBox=function(u$W){var u$j=u$W.min.elements;u$j[0]=u$j[1]=-1,u$j[2]=0;var u$t=u$W.max.elements;u$t[0]=u$t[1]=u$t[2]=1},u$j.generatePositionAndDirection=function(u$W,u$j,u$t,u$d){var u$b=u$W.elements;u$t?(u$t.seed=u$d[16],this.emitFromShell?u$w._randomPointUnitSphere(u$W,u$t):u$w._randomPointInsideUnitSphere(u$W,u$t),u$d[16]=u$t.seed):this.emitFromShell?u$w._randomPointUnitSphere(u$W):u$w._randomPointInsideUnitSphere(u$W),u$Oj.scale(u$W,this.radius,u$W);var u$E=u$b[2];u$E<0&&(u$b[2]=-1*u$E),this.randomDirection?u$t?(u$t.seed=u$d[17],u$w._randomPointUnitSphere(u$j,u$t),u$d[17]=u$t.seed):u$w._randomPointUnitSphere(u$j):u$W.cloneTo(u$j)},u$j.cloneTo=function(u$W){u$t.prototype.cloneTo.call(this,u$W);var u$j=u$W;u$j.radius=this.radius,u$j.emitFromShell=this.emitFromShell,u$j.randomDirection=this.randomDirection}}(u$Y),function(u$t){function u$W(){this.radius=NaN,this.emitFromShell=!1,u$W.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}u$T(u$W,"laya.d3.core.particleShuriKen.module.shape.SphereShape",u$t);var u$j=u$W.prototype;u$j._getShapeBoundBox=function(u$W){var u$j=u$W.min.elements;u$j[0]=u$j[1]=u$j[2]=-this.radius;var u$t=u$W.max.elements;u$t[0]=u$t[1]=u$t[2]=this.radius},u$j._getSpeedBoundBox=function(u$W){var u$j=u$W.min.elements;u$j[0]=u$j[1]=u$j[2]=-1;var u$t=u$W.max.elements;u$t[0]=u$t[1]=u$t[2]=1},u$j.generatePositionAndDirection=function(u$W,u$j,u$t,u$d){u$t?(u$t.seed=u$d[16],this.emitFromShell?u$w._randomPointUnitSphere(u$W,u$t):u$w._randomPointInsideUnitSphere(u$W,u$t),u$d[16]=u$t.seed):this.emitFromShell?u$w._randomPointUnitSphere(u$W):u$w._randomPointInsideUnitSphere(u$W),u$Oj.scale(u$W,this.radius,u$W),this.randomDirection?u$t?(u$t.seed=u$d[17],u$w._randomPointUnitSphere(u$j,u$t),u$d[17]=u$t.seed):u$w._randomPointUnitSphere(u$j):u$W.cloneTo(u$j)},u$j.cloneTo=function(u$W){u$t.prototype.cloneTo.call(this,u$W);var u$j=u$W;u$j.radius=this.radius,u$j.emitFromShell=this.emitFromShell,u$j.randomDirection=this.randomDirection}}(u$Y),function(u$W){function u$j(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,u$j.__super.call(this)}return u$T(u$j,"laya.d3.core.render.SubMeshRenderElement",u$r),u$j}()),u$zj=function(u$W){function u$K(u$W,u$j,u$t,u$d,u$b,u$E){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=u$W,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[u$Tj.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[u$Jj.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[u$Jj.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[u$xj.SHADERDEFINE_ALPHATEST]="ALPHATEST";u$K.__super.call(this,u$W,u$j,u$t,null,{}),this._attributeMap=u$d;var u$O;for(u$O in u$b){var u$q=u$b[u$O];switch(u$q[1]){case 0:this._renderElementUniformMap[u$O]=u$q[0];break;case 1:this._materialUniformMap[u$O]=u$q[0];break;case 2:this._spriteUniformMap[u$O]=u$q[0];break;case 3:this._cameraUniformMap[u$O]=u$q[0];break;case 4:this._sceneUniformMap[u$O]=u$q[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}u$T(u$K,"laya.d3.shader.ShaderCompile3D",u$M);var u$j=u$K.prototype;return u$j._definesToNameDic=function(u$W,u$j){for(var u$t={},u$d=1,u$b=0;u$b<32&&!(u$W<(u$d=1<<u$b));u$b++)if(u$W&u$d){var u$E=u$j[u$d];u$E&&(u$t[u$E]="")}return u$t},u$j.withCompile=function(u$W,u$j,u$t,u$d){var u$b,u$E,u$O;if(u$E=this.sharders[u$W])if(u$O=u$E[u$j]){if(u$b=u$O[u$t])return u$b}else u$O=u$E[u$j]=[];else u$O=(u$E=this.sharders[u$W]=[])[u$j]=[];var u$q,u$A=this._definesToNameDic(u$W,u$K._globalInt2name),u$c=this._definesToNameDic(u$j,this._spriteInt2name),u$R=this._definesToNameDic(u$t,this._materialInt2name),u$m={},u$Q="";if(u$A)for(u$q in u$A)u$Q+="#define "+u$q+"\n",u$m[u$q]=!0;if(u$c)for(u$q in u$c)u$Q+="#define "+u$q+"\n",u$m[u$q]=!0;if(u$R)for(u$q in u$R)u$Q+="#define "+u$q+"\n",u$m[u$q]=!0;var u$T=u$uj.nameKey.getName(this._name)+" compile ("+u$W+","+u$j+","+u$t+")",u$$=this._VS.toscript(u$m,[]),u$e=this._PS.toscript(u$m,[]);u$h.now();if(u$b=u$uj.create(u$Q+u$$.join("\n"),u$Q+u$e.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,u$d,u$T),u$O[u$t]=u$b,laya.d3.shader.ShaderCompile3D.debugMode)u$h.now();return u$b},u$j.precompileShaderWithShaderDefine=function(u$W,u$j,u$t){this.withCompile(u$W,u$j,u$t,!0)},u$j.addMaterialDefines=function(u$W){var u$j=u$W.defines;for(var u$t in u$j){var u$d=u$j[u$t],u$b=parseInt(u$t);this._materialInt2name[u$b]=u$d,this._materialName2Int[u$d]=u$b}},u$j.addSpriteDefines=function(u$W){var u$j=u$W.defines;for(var u$t in u$j){var u$d=u$j[u$t],u$b=parseInt(u$t);this._spriteInt2name[u$b]=u$d,this._spriteName2Int[u$d]=u$b}},u$j.getMaterialDefineByName=function(u$W){return this._materialName2Int[u$W]},u$j.registerMaterialDefine=function(u$W){var u$j=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[u$j]=u$W,this._materialName2Int[u$W]=u$j},u$j.registerSpriteDefine=function(u$W){var u$j=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[u$j]=u$W,this._spriteName2Int[u$W]=u$j},u$K._globalRegDefine=function(u$W,u$j){u$K._globalInt2name[u$j]=u$W},u$K.add=function(u$W,u$j,u$t,u$d,u$b){return laya.d3.shader.ShaderCompile3D._preCompileShader[u$W]=new u$K(u$W,u$j,u$t,u$d,u$b,u$M.includes)},u$K.get=function(u$W){return laya.d3.shader.ShaderCompile3D._preCompileShader[u$uj.nameKey.getID(u$W)]},u$K._preCompileShader={},u$K._globalInt2name=[],u$K.debugMode=!1,u$K.SHADERDEFINE_HIGHPRECISION=1,u$K.SHADERDEFINE_FOG=4,u$K.SHADERDEFINE_DIRECTIONLIGHT=8,u$K.SHADERDEFINE_POINTLIGHT=16,u$K.SHADERDEFINE_SPOTLIGHT=32,u$K.SHADERDEFINE_UV0=64,u$K.SHADERDEFINE_COLOR=128,u$K.SHADERDEFINE_UV1=256,u$K.SAHDERDEFINE_DEPTHFOG=131072,u$K}(),u$Cj=function(u$W){function u$$(){u$$.__super.call(this)}u$T(u$$,"laya.d3.graphics.MeshSprite3DStaticBatchManager",u$dW);var u$j=u$$.prototype;return u$j._getStaticBatch=function(u$W,u$j,u$t,u$d){var u$b,u$E;return u$E=u$W?u$W.id.toString()+u$t.id.toString()+u$j.id.toString()+u$d.toString():u$t.id.toString()+u$j.id.toString()+u$d.toString(),this._staticBatches[u$E]?u$b=this._staticBatches[u$E]:this._staticBatches[u$E]=u$b=new u$Lj(u$E,this,u$W,u$j,u$t),u$b},u$j._initStaticBatchs=function(u$W){var u$j,u$t;this._initBatchRenderElements.sort(u$$._sortPrepareStaticBatch);for(var u$d,u$b=!1,u$E=0,u$O=0,u$q=this._initBatchRenderElements.length;u$O<u$q;u$O++){var u$A,u$c=this._initBatchRenderElements[u$O],u$R=u$c.renderObj._getVertexBuffer(0);u$c._sprite3D;if(u$t===u$R.vertexDeclaration&&u$j===u$c._material)if(u$b)u$d._addCombineBatchRenderObjTest(u$c)?(u$A=u$c._staticBatch)!==u$d&&(u$A&&u$A._deleteCombineBatchRenderObj(u$c),u$d._addCombineBatchRenderObj(u$c)):(u$b=!1,u$E++);else{var u$m=this._initBatchRenderElements[u$O-1],u$Q=u$m.renderObj,u$T=u$c.renderObj;u$b=!(65535<u$Q._getVertexBuffer().vertexCount+u$T._getVertexBuffer().vertexCount)&&(u$d=this._getStaticBatch(u$W,u$t,u$j,u$E),(u$A=u$m._staticBatch)!==u$d&&(u$A&&u$A._deleteCombineBatchRenderObj(u$m),u$d._addCombineBatchRenderObj(u$m)),(u$A=u$c._staticBatch)!==u$d&&(u$A&&u$A._deleteCombineBatchRenderObj(u$c),u$d._addCombineBatchRenderObj(u$c)),!0)}else u$b=!1,u$E=0;u$j=u$c._material,u$t=u$R.vertexDeclaration}},u$$._sortPrepareStaticBatch=function(u$W,u$j){var u$t=u$W._render,u$d=u$j._render,u$b=u$t.lightmapIndex-u$d.lightmapIndex;if(0!=u$b)return u$b;var u$E=u$t.receiveShadow-u$d.receiveShadow;if(0!=u$E)return u$E;var u$O=u$W._mainSortID-u$j._mainSortID;return 0==u$O?u$W.renderObj.triangleCount-u$j.renderObj.triangleCount:u$O},u$$}(),u$Lj=function(u$W){function u$E(u$W,u$j,u$t,u$d,u$b){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,u$E.__super.call(this,u$W,u$j,u$t),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=u$d,this._material=u$b}u$T(u$E,"laya.d3.graphics.SubMeshStaticBatch",u$bW);var u$j=u$E.prototype;return u$j._compareBatchRenderElement=function(u$W,u$j){return u$W._batchIndexStart>u$j._batchIndexStart},u$j._addCombineBatchRenderObjTest=function(u$W){var u$j=u$W.renderObj._vertexCount;return!(65535<(0<u$j?this._currentCombineVertexCount+u$j:this._currentCombineVertexCount+u$W.renderObj._getVertexBuffer().vertexCount))},u$j._addCombineBatchRenderObj=function(u$W){var u$j=u$W.renderObj,u$t=u$j._vertexCount;this._initBatchRenderElements.push(u$W),u$W._staticBatch=this,0<u$t?(this._currentCombineIndexCount+=u$j._indexCount,this._currentCombineVertexCount+=u$t):(this._currentCombineIndexCount=this._currentCombineIndexCount+u$j._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+u$j._getVertexBuffer().vertexCount),this._needFinishCombine=!0},u$j._deleteCombineBatchRenderObj=function(u$W){var u$j=u$W.renderObj,u$t=this._initBatchRenderElements.indexOf(u$W);if(-1!==u$t){this._initBatchRenderElements.splice(u$t,1),u$W._staticBatch=null;var u$d=u$j._vertexCount;0<u$d?(this._currentCombineIndexCount=this._currentCombineIndexCount-u$j._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-u$d):(this._currentCombineIndexCount=this._currentCombineIndexCount-u$j._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-u$j._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},u$j._finishInit=function(){if(this._needFinishCombine){var u$W=0,u$j=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var u$t=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),u$d=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=u$Yj.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=u$sj.create("ushort",this._currentCombineIndexCount,35044);for(var u$b=0,u$E=this._initBatchRenderElements.length;u$b<u$E;u$b++){var u$O=this._initBatchRenderElements[u$b],u$q=u$O.renderObj,u$A=u$q._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,u$O._sprite3D),u$c=u$q.getIndices(),u$R=u$O._sprite3D.transform._isFrontFaceInvert,u$m=u$W/(this._vertexDeclaration.vertexStride/4)-u$q._vertexStart,u$Q=u$j,u$T=u$Q+u$c.length;u$O._batchIndexStart=u$Q,u$O._batchIndexEnd=u$T,u$d.set(u$c,u$j);var u$$=0;if(u$R)for(u$$=u$Q;u$$<u$T;u$$+=3){u$d[u$$]=u$m+u$d[u$$];var u$e=u$d[u$$+1],u$K=u$d[u$$+2];u$d[u$$+1]=u$m+u$K,u$d[u$$+2]=u$m+u$e}else for(u$$=u$Q;u$$<u$T;u$$+=3)u$d[u$$]=u$m+u$d[u$$],u$d[u$$+1]=u$m+u$d[u$$+1],u$d[u$$+2]=u$m+u$d[u$$+2];u$j+=u$c.length,u$t.set(u$A,u$W),u$W+=u$A.length}this._vertexBuffer.setData(u$t),this._indexBuffer.setData(u$d),this._needFinishCombine=!1}},u$j._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new u$Nj)},u$j._getRenderElement=function(u$W,u$j,u$t){for(var u$d,u$b,u$E=this._batchRenderElements.length,u$O=!0,u$q=0;u$q<u$E;u$q++){var u$A,u$c,u$R=(u$b=this._batchRenderElements[u$q])._sprite3D._render;if(0!==u$q&&(u$O=(u$A=(u$d=this._batchRenderElements[u$q-1])._sprite3D._render).lightmapIndex!==u$R.lightmapIndex||u$A.receiveShadow!==u$R.receiveShadow||u$d._batchIndexEnd!==u$b._batchIndexStart),u$O){(u$c=this._getCombineRenderElementFromPool()).renderObj=this,u$c._material=this._material,u$c._batchIndexStart=u$b._batchIndexStart,u$c._batchIndexEnd=u$b._batchIndexEnd;var u$m=u$R.lightmapIndex,u$Q=u$m+1,u$T=this._batchOwnerIndices[u$Q];u$T||(u$T=this._batchOwnerIndices[u$Q]=[]);var u$$,u$e=u$T[u$b._render.receiveShadow?1:0];void 0===u$e?(u$T[u$R.receiveShadow?1:0]=this._batchOwners.length,(u$$=new u$Pj(null,"StaticBatchMeshSprite3D"))._scene=u$j,u$$._transform=this._rootOwner?this._rootOwner._transform:null,u$$._render.lightmapIndex=u$m,u$$._render.receiveShadow=u$b._render.receiveShadow,this._batchOwners.push(u$$)):u$$=this._batchOwners[u$e],u$$._render._renderUpdate(u$t),u$c._sprite3D=u$$,u$W.push(u$c)}else u$c._batchIndexEnd=u$b._batchIndexEnd}},u$j._beforeRender=function(u$W){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},u$j._render=function(u$W){var u$j=u$W.renderElement,u$t=u$j._batchIndexStart,u$d=u$j._batchIndexEnd-u$t;u$G.mainContext.drawElements(4,u$d,5123,2*u$t),u$z.drawCall++,u$z.trianglesFaces+=u$d/3},u$j.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},u$j._getVertexBuffer=function(u$W){return void 0===u$W&&(u$W=0),this._vertexBuffer},u$E}(),u$Vj=function(u$W){function u$j(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,u$j.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}u$T(u$j,"laya.d3.core.ComponentNode",u$c);var u$t=u$j.prototype;return u$t.addComponent=function(u$W){var u$j,u$t=this._componentsMap.indexOf(u$W);if(-1===u$t)u$j=[],this._componentsMap.push(u$W),this._typeComponentsIndices.push(u$j);else if(u$j=this._typeComponentsIndices[u$t],this._components[u$j[0]].isSingleton)throw new Error("无法单实例创建"+u$W+"组件，"+u$W+"组件已存在！");var u$d=u$b.getInstance(u$W);return u$j.push(this._components.length),this._components.push(u$d),u$d instanceof laya.d3.component.Script&&this._scripts.push(u$d),u$d._initialize(this),u$d},u$t._removeComponent=function(u$W,u$j){var u$t=this._typeComponentsIndices[u$W],u$d=u$t[u$j],u$b=this._components[u$d];this._components.splice(u$d,1),u$b instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(u$b),1),u$t.splice(u$j,1),0===u$t.length&&(this._typeComponentsIndices.splice(u$W,1),this._componentsMap.splice(u$W,1));for(var u$E=0,u$O=this._componentsMap.length;u$E<u$O;u$E++)for(var u$q=(u$t=this._typeComponentsIndices[u$E]).length-1;0<=u$q;u$q--){var u$A=u$t[u$q];if(!(u$d<u$A))break;u$t[u$q]=--u$A}u$b._destroy()},u$t.getComponentByType=function(u$W,u$j){void 0===u$j&&(u$j=0);var u$t=this._componentsMap.indexOf(u$W);return-1===u$t?null:this._components[this._typeComponentsIndices[u$t][u$j]]},u$t.getComponentsByType=function(u$W,u$j){var u$t=this._componentsMap.indexOf(u$W);if(-1!==u$t){var u$d=this._typeComponentsIndices[u$t],u$b=u$d.length;u$j.length=u$b;for(var u$E=0;u$E<u$b;u$E++)u$j[u$E]=this._components[u$d[u$E]]}else u$j.length=0},u$t.getComponentByIndex=function(u$W){return this._components[u$W]},u$t.removeComponentByType=function(u$W,u$j){void 0===u$j&&(u$j=0);var u$t=this._componentsMap.indexOf(u$W);-1!==u$t&&this._removeComponent(u$t,u$j)},u$t.removeComponentsByType=function(u$W){var u$j=this._componentsMap.indexOf(u$W);if(-1!==u$j)for(var u$t=this._typeComponentsIndices[u$j],u$d=0,u$b=u$t.length;u$d<u$b;u$t.length<u$b?u$b--:u$d++)this._removeComponent(u$j,u$d)},u$t.removeAllComponent=function(){for(var u$W=0,u$j=this._componentsMap.length;u$W<u$j;this._componentsMap.length<u$j?u$j--:u$W++)this.removeComponentsByType(this._componentsMap[u$W])},u$t._updateComponents=function(u$W){for(var u$j=0,u$t=this._components.length;u$j<u$t;u$j++){var u$d=this._components[u$j];!u$d.started&&(u$d._start(u$W),u$d.started=!0),u$d.enable&&u$d._update(u$W)}},u$t._lateUpdateComponents=function(u$W){for(var u$j=0;u$j<this._components.length;u$j++){var u$t=this._components[u$j];!u$t.started&&(u$t._start(u$W),u$t.started=!0),u$t.enable&&u$t._lateUpdate(u$W)}},u$t._preRenderUpdateComponents=function(u$W){for(var u$j=0;u$j<this._components.length;u$j++){var u$t=this._components[u$j];!u$t.started&&(u$t._start(u$W),u$t.started=!0),u$t.enable&&u$t._preRenderUpdate(u$W)}},u$t._postRenderUpdateComponents=function(u$W){for(var u$j=0;u$j<this._components.length;u$j++){var u$t=this._components[u$j];!u$t.started&&(u$t._start(u$W),u$t.started=!0),u$t.enable&&u$t._postRenderUpdate(u$W)}},u$j}(),u$xj=function(u$d){function u$W(){u$W.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new u$Qj,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new u$qj(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}u$T(u$W,"laya.d3.core.material.BaseMaterial",u$d);var u$j=u$W.prototype;return u$X.imps(u$j,{"laya.d3.core.IClone":!0}),u$j._addShaderDefine=function(u$W){this._shaderDefineValue|=u$W},u$j._removeShaderDefine=function(u$W){this._shaderDefineValue&=~u$W},u$j._addDisablePublicShaderDefine=function(u$W){this._disablePublicShaderDefine|=u$W},u$j._removeDisablePublicShaderDefine=function(u$W){this._disablePublicShaderDefine&=~u$W},u$j._setBuffer=function(u$W,u$j){this._shaderValues.setValue(u$W,u$j),this._values[u$W]=u$j},u$j._getBuffer=function(u$W){return this._values[u$W]},u$j._setMatrix4x4=function(u$W,u$j){this._shaderValues.setValue(u$W,u$j?u$j.elements:null),this._values[u$W]=u$j},u$j._getMatrix4x4=function(u$W){return this._values[u$W]},u$j._setInt=function(u$W,u$j){this._shaderValues.setValue(u$W,u$j),this._values[u$W]=u$j},u$j._getInt=function(u$W){return this._values[u$W]},u$j._setNumber=function(u$W,u$j){this._shaderValues.setValue(u$W,u$j),this._values[u$W]=u$j},u$j._getNumber=function(u$W){return this._values[u$W]},u$j._setBool=function(u$W,u$j){this._shaderValues.setValue(u$W,u$j),this._values[u$W]=u$j},u$j._getBool=function(u$W){return this._values[u$W]},u$j._setVector2=function(u$W,u$j){this._shaderValues.setValue(u$W,u$j?u$j.elements:null),this._values[u$W]=u$j},u$j._getVector2=function(u$W){return this._values[u$W]},u$j._setColor=function(u$W,u$j){this._shaderValues.setValue(u$W,u$j?u$j.elements:null),this._values[u$W]=u$j},u$j._getColor=function(u$W){return this._values[u$W]},u$j._setTexture=function(u$W,u$j){var u$t=this._values[u$W];this._values[u$W]=u$j,this._shaderValues.setValue(u$W,u$j),0<this.referenceCount&&(u$t&&u$t._removeReference(),u$j&&u$j._addReference())},u$j._getTexture=function(u$W){return this._values[u$W]},u$j._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},u$j._getShader=function(u$W,u$j,u$t){var u$d=(u$W|u$j)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(u$d,u$t,this._shaderDefineValue),this._shader},u$j._setRenderStateBlendDepth=function(){var u$W=u$G.mainContext;switch(u$l.setDepthMask(u$W,this.depthWrite),0===this.depthTest?u$l.setDepthTest(u$W,!1):(u$l.setDepthTest(u$W,!0),u$l.setDepthFunc(u$W,this.depthTest)),this.blend){case 0:u$l.setBlend(u$W,!1);break;case 1:u$l.setBlend(u$W,!0),u$l.setBlendFunc(u$W,this.srcBlend,this.dstBlend);break;case 2:u$l.setBlend(u$W,!0)}},u$j._setRenderStateFrontFace=function(u$W,u$j){var u$t=u$G.mainContext,u$d=0;switch(this.cull){case 0:u$l.setCullFace(u$t,!1);break;case 1:u$l.setCullFace(u$t,!0),u$d=u$W?u$j&&u$j._isFrontFaceInvert?2305:2304:u$j&&u$j._isFrontFaceInvert?2304:2305,u$l.setFrontFace(u$t,u$d);break;case 2:u$l.setCullFace(u$t,!0),u$d=u$W?u$j&&u$j._isFrontFaceInvert?2304:2305:u$j&&u$j._isFrontFaceInvert?2305:2304,u$l.setFrontFace(u$t,u$d)}},u$j.onAsynLoaded=function(u$W,u$j,u$t){var u$d=u$j[0],u$b=u$j[1];switch(u$d.version){case"LAYAMATERIAL:01":var u$E=0,u$O=0,u$q=u$d.props;for(var u$A in u$q)switch(u$A){case"vectors":var u$c=u$q[u$A];for(u$E=0,u$O=u$c.length;u$E<u$O;u$E++){var u$R=u$c[u$E],u$m=u$R.value;switch(u$m.length){case 2:this[u$R.name]=new u$Ej(u$m[0],u$m[1]);break;case 3:this[u$R.name]=new u$Oj(u$m[0],u$m[1],u$m[2]);break;case 4:this[u$R.name]=new u$qj(u$m[0],u$m[1],u$m[2],u$m[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var u$Q=u$q[u$A];for(u$E=0,u$O=u$Q.length;u$E<u$O;u$E++){var u$T=u$Q[u$E],u$$=u$T.path;u$$&&(this[u$T.name]=u$o.getRes(u$b[u$$]))}break;case"defines":var u$e=u$q[u$A];for(u$E=0,u$O=u$e.length;u$E<u$O;u$E++){var u$K=this._shaderCompile.getMaterialDefineByName(u$e[u$E]);this._addShaderDefine(u$K)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[u$A]=u$q[u$A];break;case"renderQueue":switch(u$q[u$A]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[u$A]=u$q[u$A]}break;case"LAYAMATERIAL:02":for(u$A in u$q=u$d.props)switch(u$A){case"vectors":for(u$E=0,u$O=(u$c=u$q[u$A]).length;u$E<u$O;u$E++)switch((u$m=(u$R=u$c[u$E]).value).length){case 2:this[u$R.name]=new u$Ej(u$m[0],u$m[1]);break;case 3:this[u$R.name]=new u$Oj(u$m[0],u$m[1],u$m[2]);break;case 4:this[u$R.name]=new u$qj(u$m[0],u$m[1],u$m[2],u$m[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(u$E=0,u$O=(u$Q=u$q[u$A]).length;u$E<u$O;u$E++)(u$$=(u$T=u$Q[u$E]).path)&&(this[u$T.name]=u$o.getRes(u$b[u$$]));break;case"defines":for(u$E=0,u$O=(u$e=u$q[u$A]).length;u$E<u$O;u$E++)u$K=this._shaderCompile.getMaterialDefineByName(u$e[u$E]),this._addShaderDefine(u$K);break;default:this[u$A]=u$q[u$A]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},u$j._addReference=function(){u$d.prototype._addReference.call(this);for(var u$W=0,u$j=this._values.length;u$W<u$j;u$W++){var u$t=this._values[u$W];u$t&&u$t instanceof laya.d3.resource.BaseTexture&&u$t._addReference()}},u$j._removeReference=function(){u$d.prototype._removeReference.call(this);for(var u$W=0,u$j=this._values.length;u$W<u$j;u$W++){var u$t=this._values[u$W];u$t&&u$t instanceof laya.d3.resource.BaseTexture&&u$t._removeReference()}},u$j.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},u$j.setShaderName=function(u$W){var u$j=u$uj.nameKey.getID(u$W);if(-1===u$j)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=u$zj._preCompileShader[u$j]},u$j.cloneTo=function(u$W){var u$j=u$W;u$j.name=this.name,u$j.cull=this.cull,u$j.blend=this.blend,u$j.srcBlend=this.srcBlend,u$j.dstBlend=this.dstBlend,u$j.srcBlendRGB=this.srcBlendRGB,u$j.dstBlendRGB=this.dstBlendRGB,u$j.srcBlendAlpha=this.srcBlendAlpha,u$j.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(u$j.blendConstColor),u$j.blendEquation=this.blendEquation,u$j.blendEquationRGB=this.blendEquationRGB,u$j.blendEquationAlpha=this.blendEquationAlpha,u$j.depthTest=this.depthTest,u$j.depthWrite=this.depthWrite,u$j.renderQueue=this.renderQueue,u$j._shader=this._shader,u$j._disablePublicShaderDefine=this._disablePublicShaderDefine,u$j._shaderDefineValue=this._shaderDefineValue;var u$t,u$d=0,u$b=u$j._shaderValues;u$j._shaderValues.data.length=this._shaderValues.data.length;var u$E=this._values.length,u$O=u$j._values;for(u$d=0,u$t=u$O.length=u$E;u$d<u$t;u$d++){var u$q=this._values[u$d];if(u$q)if("number"==typeof u$q)u$O[u$d]=u$q,u$b.data[u$d]=u$q;else if("number"==typeof u$q&&Math.floor(u$q)==u$q)u$O[u$d]=u$q,u$b.data[u$d]=u$q;else if("boolean"==typeof u$q)u$O[u$d]=u$q,u$b.data[u$d]=u$q;else if(u$q instanceof laya.d3.math.Vector2){var u$A=u$O[u$d]||(u$O[u$d]=new u$Ej);u$q.cloneTo(u$A),u$b.data[u$d]=u$A.elements}else if(u$q instanceof laya.d3.math.Vector3){var u$c=u$O[u$d]||(u$O[u$d]=new u$Oj);u$q.cloneTo(u$c),u$b.data[u$d]=u$c.elements}else if(u$q instanceof laya.d3.math.Vector4){var u$R=u$O[u$d]||(u$O[u$d]=new u$qj);u$q.cloneTo(u$R),u$b.data[u$d]=u$R.elements}else if(u$q instanceof laya.d3.math.Matrix4x4){var u$m=u$O[u$d]||(u$O[u$d]=new u$Wj);u$q.cloneTo(u$m),u$b.data[u$d]=u$m.elements}else u$q instanceof laya.d3.resource.BaseTexture&&(u$O[u$d]=u$q,u$b.data[u$d]=u$q)}},u$j.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$$(0,u$j,"alphaTestValue",function(){return this._getNumber(0)},function(u$W){this._setNumber(0,u$W)}),u$$(0,u$j,"alphaTest",function(){return this._alphaTest},function(u$W){(this._alphaTest=u$W)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),u$W.__init__=function(){u$W.SHADERDEFINE_ALPHATEST=u$W.shaderDefines.registerDefine("ALPHATEST")},u$W.RENDERQUEUE_OPAQUE=2e3,u$W.RENDERQUEUE_ALPHATEST=2450,u$W.RENDERQUEUE_TRANSPARENT=3e3,u$W.CULL_NONE=0,u$W.CULL_FRONT=1,u$W.CULL_BACK=2,u$W.BLEND_DISABLE=0,u$W.BLEND_ENABLE_ALL=1,u$W.BLEND_ENABLE_SEPERATE=2,u$W.BLENDPARAM_ZERO=0,u$W.BLENDPARAM_ONE=1,u$W.BLENDPARAM_SRC_COLOR=768,u$W.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,u$W.BLENDPARAM_DST_COLOR=774,u$W.BLENDPARAM_ONE_MINUS_DST_COLOR=775,u$W.BLENDPARAM_SRC_ALPHA=770,u$W.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,u$W.BLENDPARAM_DST_ALPHA=772,u$W.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,u$W.BLENDPARAM_SRC_ALPHA_SATURATE=776,u$W.BLENDEQUATION_ADD=0,u$W.BLENDEQUATION_SUBTRACT=1,u$W.BLENDEQUATION_REVERSE_SUBTRACT=2,u$W.DEPTHTEST_OFF=0,u$W.DEPTHTEST_NEVER=512,u$W.DEPTHTEST_LESS=513,u$W.DEPTHTEST_EQUAL=514,u$W.DEPTHTEST_LEQUAL=515,u$W.DEPTHTEST_GREATER=516,u$W.DEPTHTEST_NOTEQUAL=517,u$W.DEPTHTEST_GEQUAL=518,u$W.DEPTHTEST_ALWAYS=519,u$W.SHADERDEFINE_ALPHATEST=1,u$W.ALPHATESTVALUE=0,u$m(u$W,["shaderDefines",function(){return this.shaderDefines=new u$Rj}]),u$W}(u$K),u$Gj=function(u$W){function u$j(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,u$j.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}u$T(u$j,"laya.d3.resource.BaseTexture",u$K);var u$t=u$j.prototype;return u$$(0,u$t,"width",function(){return this._width}),u$$(0,u$t,"repeat",function(){return this._repeat},function(u$W){if(this._repeat!==u$W&&(this._repeat=u$W,this._source)){var u$j=u$G.mainContext;u$l.bindTexture(u$j,this._type,this._source),u$Z.isPOT(this._width,this._height)&&this._repeat?(u$j.texParameteri(this._type,10242,10497),u$j.texParameteri(this._type,10243,10497)):(u$j.texParameteri(this._type,10242,33071),u$j.texParameteri(this._type,10243,33071))}}),u$$(0,u$t,"height",function(){return this._height}),u$$(0,u$t,"magFifter",function(){return this._magFifter},function(u$W){(this._magFifter=u$W)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(u$W)}),u$$(0,u$t,"wrapModeV",function(){return this._wrapModeV}),u$$(0,u$t,"size",function(){return this._size}),u$$(0,u$t,"wrapModeU",function(){return this._wrapModeU}),u$$(0,u$t,"mipmap",function(){return this._mipmap},function(u$W){this._mipmap=u$W,this._mipmap!=u$W&&this._conchTexture&&this._conchTexture.setMipMap(u$W)}),u$$(0,u$t,"minFifter",function(){return this._minFifter},function(u$W){this._minFifter=u$W,this._minFifter!=u$W&&this._conchTexture&&this._conchTexture.setMinFifter(u$W)}),u$$(0,u$t,"format",function(){return this._format}),u$$(0,u$t,"source",function(){return this.activeResource(),this._source}),u$$(0,u$t,"defaulteTexture",function(){return u$fj.grayTexture}),u$j.WARPMODE_REPEAT=0,u$j.WARPMODE_CLAMP=1,u$j}(),u$lj=function(u$W){function u$j(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,u$j.__super.call(this),this._boundingBoxCorners=u$d(8,null)}u$T(u$j,"laya.d3.resource.models.BaseMesh",u$K);var u$t=u$j.prototype;return u$t._getPositions=function(){throw new Error("未Override,请重载该属性！")},u$t._generateBoundingObject=function(){this._boundingSphere=new u$kW(new u$Oj,0),u$kW.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new u$BW(new u$Oj,new u$Oj),u$BW.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},u$t.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},u$t.getRenderElement=function(u$W){throw new Error("未Override,请重载该属性！")},u$$(0,u$t,"subMeshCount",function(){return this._subMeshCount}),u$$(0,u$t,"boundingBox",function(){return this._boundingBox}),u$$(0,u$t,"boundingBoxCorners",function(){return this._boundingBoxCorners}),u$$(0,u$t,"boundingSphere",function(){return this._boundingSphere}),u$j}(),u$hj=(function(u$W){function u$j(){u$j.__super.call(this)}u$T(u$j,"laya.d3.component.Script",u$Mj);var u$t=u$j.prototype;u$t.onTriggerEnter=function(u$W){},u$t.onTriggerExit=function(u$W){},u$t.onTriggerStay=function(u$W){},u$$(0,u$t,"isSingleton",function(){return u$j._isSingleton}),u$j._isSingleton=!1}(),function(u$W){function u$j(u$W){this._owner=null,this._sharedMesh=null,u$j.__super.call(this),this._owner=u$W}u$T(u$j,"laya.d3.core.MeshFilter",u$W);var u$t=u$j.prototype;return u$t._sharedMeshLoaded=function(){this.event("loaded")},u$t._destroy=function(){u$W.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},u$$(0,u$t,"sharedMesh",function(){return this._sharedMesh},function(u$W){var u$j=this._sharedMesh;u$j&&u$j._removeReference(),(this._sharedMesh=u$W)._addReference(),this.event("meshchanged",[this,u$j,u$W]),u$W.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),u$$(0,u$t,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),u$$(0,u$t,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),u$$(0,u$t,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),u$$(0,u$t,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),u$j}(u$Zj)),u$vj=function(u$W){function u$j(u$W){u$j.__super.call(this,u$W),u$W.meshFilter.on("meshchanged",this,this._onMeshChanged)}u$T(u$j,"laya.d3.core.MeshRender",u$Xj);var u$t=u$j.prototype;return u$t._onMeshChanged=function(u$W,u$j,u$t){u$t.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:u$t.once("loaded",this,this._onMeshLoaed)},u$t._onMeshLoaed=function(u$W,u$j){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},u$t._calculateBoundingSphereByInitSphere=function(u$W){var u$j=NaN,u$t=this._owner.transform,u$d=u$t.scale.elements,u$b=Math.abs(u$d[0]),u$E=Math.abs(u$d[1]),u$O=Math.abs(u$d[2]);u$j=u$E<=u$b&&u$O<=u$b?u$b:u$O<=u$E?u$E:u$O,u$Oj.transformCoordinate(u$W.center,u$t.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=u$W.radius*u$j},u$t._calculateBoundBoxByInitCorners=function(u$W){for(var u$j=this._owner.transform.worldMatrix,u$t=0;u$t<8;u$t++)u$Oj.transformCoordinate(u$W[u$t],u$j,u$Xj._tempBoundBoxCorners[u$t]);u$BW.createfromPoints(u$Xj._tempBoundBoxCorners,this._boundingBox)},u$t._calculateBoundingSphere=function(){var u$W=this._owner.meshFilter.sharedMesh;null==u$W||null==u$W.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(u$W.boundingSphere)},u$t._calculateBoundingBox=function(){var u$W=this._owner.meshFilter.sharedMesh;null==u$W||null==u$W.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(u$W.boundingBoxCorners)},u$t._renderUpdate=function(u$W){var u$j=this._owner.transform;if(u$j){this._setShaderValueMatrix4x4(0,u$j.worldMatrix);var u$t=this._owner.getProjectionViewWorldMatrix(u$W);this._setShaderValueMatrix4x4(1,u$t)}else this._setShaderValueMatrix4x4(0,u$Wj.DEFAULT),this._setShaderValueMatrix4x4(1,u$W);return u$oj.debugMode&&this._renderRenderableBoundBox(),!0},u$j}(),u$yj=function(u$j){function u$d(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,u$d.__super.call(this),this._renderState=new u$i,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new u$Qj,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new u$jW,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new u$Oj(.7,.7,.7),this.ambientColor=new u$Oj(.212,.227,.259),u$G.shaderHighPrecision&&this.addShaderDefine(u$zj.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}u$T(u$d,"laya.d3.core.scene.Scene",u$j);var u$W=u$d.prototype;return u$X.imps(u$W,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),u$W._setUrl=function(u$W){this._url=u$W},u$W._getGroup=function(){return this._group},u$W._setGroup=function(u$W){this._group=u$W},u$W._display=function(){u$X.stage._scenes.push(this),u$X.stage._scenes.sort(u$d._sortScenes);for(var u$W=0,u$j=this._childs.length;u$W<u$j;u$W++){var u$t=this._childs[u$W];u$t.active&&u$t._activeHierarchy()}},u$W._unDisplay=function(){var u$W=u$X.stage._scenes;u$W.splice(u$W.indexOf(this),1);for(var u$j=0,u$t=this._childs.length;u$j<u$t;u$j++){var u$d=this._childs[u$j];u$d.active&&u$d._inActiveHierarchy()}},u$W._addChild3D=function(u$W){u$W.transform._onWorldTransform(),u$W._setBelongScene(this),this.displayedInStage&&u$W.active&&u$W._activeHierarchy()},u$W._removeChild3D=function(u$W){u$W.transform.parent=null,this.displayedInStage&&u$W.active&&u$W._inActiveHierarchy(),u$W._setUnBelongScene()},u$W.initOctree=function(u$W,u$j,u$t,u$d,u$b){void 0===u$b&&(u$b=6),this.treeSize=new u$Oj(u$W,u$j,u$t),this.treeLevel=u$b,this.treeRoot=new u$B(this,0),this.treeRoot.init(u$d,this.treeSize)},u$W._prepareUpdateToRenderState=function(u$W,u$j){u$j.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,u$j.scene=this},u$W._prepareSceneToRender=function(u$W){var u$j=this._lights.length;if(0<u$j)for(var u$t=0,u$d=0;u$d<u$j&&!(this._lights[u$d]._prepareToScene(u$W)&&++u$t>=this._enableLightCount);u$d++);},u$W._updateChilds=function(u$W){for(var u$j=0,u$t=this._childs.length;u$j<u$t;++u$j)this._childs[u$j]._update(u$W)},u$W._preRenderScene=function(u$W,u$j,u$t){var u$d,u$b=u$j._viewMatrix,u$E=u$j._projectionMatrix,u$O=u$j._projectionViewMatrix,u$q=0,u$A=u$j.camera;for(u$A.useOcclusionCulling?this.treeRoot?u$tW.renderObjectCullingOctree(u$t,this,u$A,u$b,u$E,u$O):u$tW.renderObjectCulling(u$t,this,u$A,u$b,u$E,u$O):u$tW.renderObjectCullingNoBoundFrustum(this,u$A,u$b,u$E,u$O),u$q=0,u$d=this._quenes.length;u$q<u$d;u$q++)this._quenes[u$q]&&this._quenes[u$q]._preRender(u$j)},u$W._clear=function(u$W,u$j){var u$t=u$j._viewport,u$d=u$j.camera,u$b=u$t.x,u$E=u$d.renderTargetSize.height-u$t.y-u$t.height,u$O=u$t.width,u$q=u$t.height;u$W.viewport(u$b,u$E,u$O,u$q);var u$A=256,u$c=u$d.renderTarget;switch(u$d.clearFlag){case 0:var u$R=u$d.clearColor;if(u$R){u$W.enable(3089),u$W.scissor(u$b,u$E,u$O,u$q);var u$m=u$R.elements;u$W.clearColor(u$m[0],u$m[1],u$m[2],u$m[3]),u$A|=16384}if(u$c)switch(u$R||(u$A=16384),u$c.depthStencilFormat){case 33189:u$A|=256;break;case 36168:u$A|=1024;break;case 34041:u$A|=256,u$A|=1024}u$W.clear(u$A),u$R&&u$W.disable(3089);break;case 1:case 2:if(u$c)switch(u$A=16384,u$c.depthStencilFormat){case 33189:u$A|=256;break;case 36168:u$A|=1024;break;case 34041:u$A|=256,u$A|=1024}u$W.clear(u$A);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},u$W._renderScene=function(u$W,u$j){var u$t,u$d,u$b=u$j.camera,u$E=0;for(u$E=0;u$E<2;u$E++)(u$d=this._quenes[u$E])&&(u$b.renderTarget?u$d._render(u$j,!0):u$d._render(u$j,!1));if(1===u$b.clearFlag){var u$O=u$b.sky;u$O&&(u$l.setCullFace(u$W,!1),u$l.setDepthFunc(u$W,515),u$l.setDepthMask(u$W,!1),u$O._render(u$j),u$l.setDepthFunc(u$W,513),u$l.setDepthMask(u$W,!0))}for(u$E=2,u$t=this._quenes.length;u$E<u$t;u$E++)(u$d=this._quenes[u$E])&&(u$d._sortAlpha(u$j.camera.transform.position),u$b.renderTarget?u$d._render(u$j,!0):u$d._render(u$j,!1))},u$W._set3DRenderConfig=function(u$W){u$W.disable(3042),u$l._blend=!1,u$W.blendFunc(770,771),u$l._sFactor=770,u$l._dFactor=771,u$W.disable(2929),u$l._depthTest=!1,u$W.enable(2884),u$l._cullFace=!0,u$W.depthMask(1),u$l._depthMask=!0,u$W.frontFace(2304),u$l._frontFace=2304},u$W._set2DRenderConfig=function(u$W){u$l.setBlend(u$W,!0),u$l.setBlendFunc(u$W,1,771),u$l.setDepthTest(u$W,!1),u$l.setCullFace(u$W,!1),u$l.setDepthMask(u$W,!0),u$l.setFrontFace(u$W,2305),u$W.viewport(0,0,u$R.width,u$R.height)},u$W._parseCustomProps=function(u$W,u$j,u$t,u$d){var u$b=u$d.customProps.lightmaps,u$E=u$b.length,u$O=this._lightmaps;u$O.length=u$E;for(var u$q=0;u$q<u$E;u$q++)u$O[u$q]=u$o.getRes(u$j[u$b[u$q].replace(".exr",".png")]);this.setlightmaps(u$O);var u$A=u$d.customProps.ambientColor;u$A&&(this.ambientColor=new u$Oj(u$A[0],u$A[1],u$A[2]));var u$c=u$d.customProps.fogColor;u$c&&(this.fogColor=new u$Oj(u$c[0],u$c[1],u$c[2]))},u$W._addLight=function(u$W){this._lights.indexOf(u$W)<0&&this._lights.push(u$W)},u$W._removeLight=function(u$W){var u$j=this._lights.indexOf(u$W);0<=u$j&&this._lights.splice(u$j,1)},u$W._updateScene=function(){var u$W=this._renderState;this._prepareUpdateToRenderState(u$G.mainContext,u$W),this._updateComponents(u$W),this._updateChilds(u$W),this._lateUpdateComponents(u$W),this._time+=u$W.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},u$W._updateSceneConch=function(){var u$W=this._renderState;this._prepareUpdateToRenderState(u$G.mainContext,u$W),this._updateComponents(u$W),this._lateUpdateComponents(u$W),this._prepareSceneToRender(u$W);for(var u$j=0,u$t=this._cameraPool.length;u$j<u$t;u$j++){var u$d=this._cameraPool[u$j];(u$W.camera=u$d)._prepareCameraToRender()}},u$W._preRenderShadow=function(u$W,u$j,u$t,u$d,u$b){this.treeRoot?u$tW.renderShadowObjectCullingOctree(this,u$j,u$t,u$d,u$b):u$tW.renderShadowObjectCulling(this,u$j,u$t,u$d,u$b);for(var u$E=0,u$O=u$t.length;u$E<u$O;u$E++)u$t[u$E]&&u$t[u$E]._preRender(u$W)},u$W._renderShadowMap=function(u$W,u$j,u$t){var u$d=this.parallelSplitShadowMaps[0];u$d._calcAllLightCameraInfo(u$t);var u$b,u$E,u$O,u$q=u$d.PSSMNum;if(this._preRenderShadow(u$j,u$d._lightCulling,u$d._shadowQuenes,u$d._lightVPMatrix[0],u$q),this.addShaderDefine(u$Tj.SHADERDEFINE_CAST_SHADOW),1<u$q)for(var u$A=0;u$A<u$q;u$A++)u$b=u$d.getRenderTarget(u$A+1),u$d.beginRenderTarget(u$A+1),u$W.clearColor(1,1,1,1),u$W.clear(16640),u$W.viewport(0,0,u$b.width,u$b.height),u$j.camera=u$O=u$d.getLightCamera(u$A),u$O._prepareCameraToRender(),u$O._prepareCameraViewProject(u$O.viewMatrix,u$O.projectionMatrix),u$j._projectionViewMatrix=u$d._lightVPMatrix[u$A+1],(u$E=u$d._shadowQuenes[u$A])._preRender(u$j),u$E._renderShadow(u$j,!1),u$d.endRenderTarget(u$A+1);else u$b=u$d.getRenderTarget(1),u$d.beginRenderTarget(1),u$W.clearColor(1,1,1,1),u$W.clear(16640),u$W.viewport(0,0,u$b.width,u$b.height),u$j.camera=u$O=u$d.getLightCamera(0),u$O._prepareCameraToRender(),u$O._prepareCameraViewProject(u$O.viewMatrix,u$O.projectionMatrix),u$j._projectionViewMatrix=u$d._lightVPMatrix[0],(u$E=u$d._shadowQuenes[0])._preRender(u$j),u$E._renderShadow(u$j,!0),u$d.endRenderTarget(1);this.removeShaderDefine(u$Tj.SHADERDEFINE_CAST_SHADOW)},u$W.addTreeNode=function(u$W){this.treeRoot.addTreeNode(u$W)},u$W.removeTreeNode=function(u$W){this.treeSize&&u$W._treeNode&&u$W._treeNode.removeObject(u$W)},u$W.setlightmaps=function(u$W){this._lightmaps=u$W;for(var u$j=0,u$t=this._renderableSprite3Ds.length;u$j<u$t;u$j++)this._renderableSprite3Ds[u$j]._render._applyLightMapParams()},u$W.getlightmaps=function(){return this._lightmaps},u$W.addChildAt=function(u$W,u$j){if(!(u$W instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(u$W&&u$W.__className));if(!u$W||this.destroyed||u$W===this)return u$W;if(u$W.zOrder&&this._set$P("hasZorder",!0),0<=u$j&&u$j<=this._childs.length){if(u$W._parent===this){var u$t=this.getChildIndex(u$W);this._childs.splice(u$t,1),this._childs.splice(u$j,0,u$W),this.conchModel&&(this.conchModel.removeChild(u$W.conchModel),this.conchModel.addChildAt(u$W.conchModel,u$j)),this._childChanged()}else u$W.parent&&u$W.parent.removeChild(u$W),this._childs===u$c.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(u$j,0,u$W),this.conchModel&&this.conchModel.addChildAt(u$W.conchModel,u$j),(u$W.parent=this)._addChild3D(u$W);return u$W}throw new Error("appendChildAt:The index is out of bounds")},u$W.addChild=function(u$W){if(!(u$W instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!u$W||this.destroyed||u$W===this)return u$W;if(u$W.zOrder&&this._set$P("hasZorder",!0),u$W._parent===this){var u$j=this.getChildIndex(u$W);u$j!==this._childs.length-1&&(this._childs.splice(u$j,1),this._childs.push(u$W),this.conchModel&&(this.conchModel.removeChild(u$W.conchModel),this.conchModel.addChildAt(u$W.conchModel,this._childs.length-1)),this._childChanged())}else u$W.parent&&u$W.parent.removeChild(u$W),this._childs===u$c.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(u$W),this.conchModel&&this.conchModel.addChildAt(u$W.conchModel,this._childs.length-1),(u$W.parent=this)._childChanged(),this._addChild3D(u$W);return u$W},u$W.removeChildAt=function(u$W){var u$j=this.getChildAt(u$W);return u$j&&(this._removeChild3D(u$j),this._childs.splice(u$W,1),this.conchModel&&this.conchModel.removeChild(u$j.conchModel),u$j.parent=null),u$j},u$W.removeChildren=function(u$W,u$j){if(void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=2147483647),this._childs&&0<this._childs.length){var u$t=this._childs;if(0===u$W&&u$E<=u$j){var u$d=u$t;this._childs=u$c.ARRAY_EMPTY}else u$d=u$t.splice(u$W,u$j-u$W);for(var u$b=0,u$E=u$d.length;u$b<u$E;u$b++)this._removeChild3D(u$d[u$b]),u$d[u$b].parent=null,this.conchModel&&this.conchModel.removeChild(u$d[u$b].conchModel)}return this},u$W.addFrustumCullingObject=function(u$W){this.treeRoot?this.addTreeNode(u$W):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(u$W):this._cullingRenders[this._cullingRendersLength]=u$W,u$W._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},u$W.removeFrustumCullingObject=function(u$W){if(this.treeRoot)this.removeTreeNode(u$W);else{this._cullingRendersLength--;var u$j=u$W._indexInSceneFrustumCullingObjects;if(u$j!==this._cullingRendersLength){var u$t=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[u$j]=u$t)._indexInSceneFrustumCullingObjects=u$j,u$W._indexInSceneFrustumCullingObjects=-1}}},u$W.getRenderQueue=function(u$W){return u$W<3e3?this._quenes[1]||(this._quenes[1]=new u$P(this)):this._quenes[2]||(this._quenes[2]=new u$P(this))},u$W.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new u$P(this)},u$W.addShaderDefine=function(u$W){this._shaderDefineValue|=u$W},u$W.removeShaderDefine=function(u$W){this._shaderDefineValue&=~u$W},u$W.addScript=function(u$W){return this._addComponent(u$W)},u$W.getScriptByType=function(u$W,u$j){return void 0===u$j&&(u$j=0),this._getComponentByType(u$W,u$j)},u$W.getScriptsByType=function(u$W,u$j){this._getComponentsByType(u$W,u$j)},u$W.getScriptByIndex=function(u$W){return this._getComponentByIndex(u$W)},u$W.removeScriptByType=function(u$W,u$j){void 0===u$j&&(u$j=0),this._removeComponentByType(u$W,u$j)},u$W.removeScriptsByType=function(u$W){this._removeComponentByType(u$W)},u$W.removeAllScript=function(){this._removeAllComponent()},u$W.render=function(u$W,u$j,u$t){(u$e._context.ctx._renderKey=0)<this._childs.length&&u$W.addRenderObject(this)},u$W.renderSubmit=function(){var u$W=u$G.mainContext,u$j=this._renderState;this._set3DRenderConfig(u$W),this._prepareSceneToRender(this._renderState);var u$t,u$d=0,u$b=0;if(u$oj.debugMode||u$B.debugMode)for(u$d=0,u$b=this._cameraPool.length;u$d<u$b;u$d++)u$t=this._cameraPool[u$d],u$oj._debugPhasorSprite.begin(1,u$t),u$t.activeInHierarchy&&u$t._renderCamera(u$W,u$j,this),u$oj._debugPhasorSprite.end();else for(u$d=0,u$b=this._cameraPool.length;u$d<u$b;u$d++)(u$t=this._cameraPool[u$d]).activeInHierarchy&&u$t._renderCamera(u$W,u$j,this);return this._set2DRenderConfig(u$W),1},u$W.onAsynLoaded=function(u$W,u$j,u$t){var u$d=u$j[0];if("Scene"!==u$d.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var u$b=u$j[1];u$Kj._createNodeByJson(this,u$d,this,u$b),this.event("hierarchyloaded",[this]),this.__loaded=!0},u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),this.destroyed||(u$j.prototype.destroy.call(this,u$W),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,u$o.clearRes(this.url),this.loaded||u$oj._cancelLoadByUrl(this.url))},u$W.getRenderType=function(){return 0},u$W.releaseRender=function(){},u$W._addComponent=function(u$W){var u$j,u$t=this._componentsMap.indexOf(u$W);if(-1===u$t)u$j=[],this._componentsMap.push(u$W),this._typeComponentsIndices.push(u$j);else if(u$j=this._typeComponentsIndices[u$t],this._components[u$j[0]].isSingleton)throw new Error("无法单实例创建"+u$W+"组件，"+u$W+"组件已存在！");var u$d=u$b.getInstance(u$W);u$j.push(this._components.length),this._components.push(u$d);return u$d._initialize(this),u$d},u$W._removeComponent=function(u$W,u$j){var u$t=this._typeComponentsIndices[u$W],u$d=u$t[u$j],u$b=this._components[u$d];this._components.splice(u$d,1),u$t.splice(u$j,1),0===u$t.length&&(this._typeComponentsIndices.splice(u$W,1),this._componentsMap.splice(u$W,1));for(var u$E=0,u$O=this._componentsMap.length;u$E<u$O;u$E++)for(var u$q=(u$t=this._typeComponentsIndices[u$E]).length-1;0<=u$q;u$q--){var u$A=u$t[u$q];if(!(u$d<u$A))break;u$t[u$q]=--u$A}u$b._destroy()},u$W._getComponentByType=function(u$W,u$j){void 0===u$j&&(u$j=0);var u$t=this._componentsMap.indexOf(u$W);return-1===u$t?null:this._components[this._typeComponentsIndices[u$t][u$j]]},u$W._getComponentsByType=function(u$W,u$j){var u$t=this._componentsMap.indexOf(u$W);if(-1!==u$t){var u$d=this._typeComponentsIndices[u$t],u$b=u$d.length;u$j.length=u$b;for(var u$E=0;u$E<u$b;u$E++)u$j[u$E]=this._components[u$d[u$E]]}else u$j.length=0},u$W._getComponentByIndex=function(u$W){return this._components[u$W]},u$W._removeComponentByType=function(u$W,u$j){void 0===u$j&&(u$j=0);var u$t=this._componentsMap.indexOf(u$W);-1!==u$t&&this._removeComponent(u$t,u$j)},u$W._removeComponentsByType=function(u$W){var u$j=this._componentsMap.indexOf(u$W);if(-1!==u$j)for(var u$t=this._typeComponentsIndices[u$j],u$d=0,u$b=u$t.length;u$d<u$b;u$t.length<u$b?u$b--:u$d++)this._removeComponent(u$j,u$d)},u$W._removeAllComponent=function(){for(var u$W=0,u$j=this._componentsMap.length;u$W<u$j;this._componentsMap.length<u$j?u$j--:u$W++)this._removeComponentsByType(this._componentsMap[u$W])},u$W._updateComponents=function(u$W){for(var u$j=0,u$t=this._components.length;u$j<u$t;u$j++){var u$d=this._components[u$j];!u$d.started&&(u$d._start(u$W),u$d.started=!0),u$d.enable&&u$d._update(u$W)}},u$W._lateUpdateComponents=function(u$W){for(var u$j=0;u$j<this._components.length;u$j++){var u$t=this._components[u$j];!u$t.started&&(u$t._start(u$W),u$t.started=!0),u$t.enable&&u$t._lateUpdate(u$W)}},u$W._preRenderUpdateComponents=function(u$W){for(var u$j=0;u$j<this._components.length;u$j++){var u$t=this._components[u$j];!u$t.started&&(u$t._start(u$W),u$t.started=!0),u$t.enable&&u$t._preRenderUpdate(u$W)}},u$W._postRenderUpdateComponents=function(u$W){for(var u$j=0;u$j<this._components.length;u$j++){var u$t=this._components[u$j];!u$t.started&&(u$t._start(u$W),u$t.started=!0),u$t.enable&&u$t._postRenderUpdate(u$W)}},u$$(0,u$W,"_loaded",null,function(u$W){this.__loaded=u$W}),u$$(0,u$W,"fogColor",function(){return this._fogColor},function(u$W){this._fogColor=u$W,this._shaderValues.setValue(0,u$W.elements)}),u$$(0,u$W,"enableFog",function(){return this._enableFog},function(u$W){this._enableFog!==u$W&&((this._enableFog=u$W)?(this.addShaderDefine(u$zj.SHADERDEFINE_FOG),this.removeShaderDefine(u$zj.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(u$zj.SHADERDEFINE_FOG))}),u$$(0,u$W,"url",function(){return this._url}),u$$(0,u$W,"loaded",function(){return this.__loaded}),u$$(0,u$W,"enableDepthFog",function(){return this._enableDepthFog},function(u$W){this._enableDepthFog!=u$W&&((this._enableDepthFog=u$W)?(this.addShaderDefine(u$zj.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(u$zj.SHADERDEFINE_FOG)):this.removeShaderDefine(u$zj.SAHDERDEFINE_DEPTHFOG))}),u$$(0,u$W,"fogStart",function(){return this._fogStart},function(u$W){this._fogStart=u$W,this._shaderValues.setValue(1,u$W)}),u$$(0,u$W,"fogRange",function(){return this._fogRange},function(u$W){this._fogRange=u$W,this._shaderValues.setValue(2,u$W)}),u$$(0,u$W,"ambientColor",function(){return this._ambientColor},function(u$W){this._ambientColor=u$W,this._shaderValues.setValue(21,u$W.elements)}),u$$(0,u$W,"scene",function(){return this}),u$$(0,u$W,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),u$d._sortScenes=function(u$W,u$j){if(u$W.parent!==u$X.stage||u$j.parent!==u$X.stage)return u$W.parent!==u$X.stage&&u$j.parent!==u$X.stage?u$d._sortScenes(u$W.parent,u$j.parent):u$W.parent===u$X.stage?-1:1;var u$t=u$X.stage._childs;return u$t.indexOf(u$W)-u$t.indexOf(u$j)},u$d.load=function(u$W){return u$X.loader.create(u$W,null,null,u$d)},u$d.FOGCOLOR=0,u$d.FOGSTART=1,u$d.FOGRANGE=2,u$d.LIGHTDIRECTION=3,u$d.LIGHTDIRCOLOR=4,u$d.POINTLIGHTPOS=5,u$d.POINTLIGHTRANGE=6,u$d.POINTLIGHTATTENUATION=7,u$d.POINTLIGHTCOLOR=8,u$d.SPOTLIGHTPOS=9,u$d.SPOTLIGHTDIRECTION=10,u$d.SPOTLIGHTSPOT=11,u$d.SPOTLIGHTRANGE=12,u$d.SPOTLIGHTATTENUATION=13,u$d.SPOTLIGHTCOLOR=14,u$d.SHADOWDISTANCE=15,u$d.SHADOWLIGHTVIEWPROJECT=16,u$d.SHADOWMAPPCFOFFSET=17,u$d.SHADOWMAPTEXTURE1=18,u$d.SHADOWMAPTEXTURE2=19,u$d.SHADOWMAPTEXTURE3=20,u$d.AMBIENTCOLOR=21,u$d.TIME=22,u$d}(u$N),u$aj=function(u$W){function u$j(u$W){u$j.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new u$Wj,this._shaderValues=new u$Qj,this._colliders=[],this._id=++u$j._uniqueIDCounter,this._transform=new u$_j(this),this.name=u$W||"Sprite3D-"+u$j._nameNumberCounter++,this.layer=u$v.currentCreationLayer,this.active=!0}u$T(u$j,"laya.d3.core.Sprite3D",u$Vj);var u$t=u$j.prototype;return u$X.imps(u$t,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),u$t._setUrl=function(u$W){this._url=u$W},u$t._getGroup=function(){return this._group},u$t._setGroup=function(u$W){this._group=u$W},u$t._addChild3D=function(u$W){u$W.transform.parent=this.transform,this._hierarchyAnimator&&(!u$W._hierarchyAnimator&&u$W._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(u$W,!0,[u$W.name])),this._scene&&(u$W._setBelongScene(this._scene),this._activeInHierarchy&&u$W._active&&u$W._activeHierarchy())},u$t._removeChild3D=function(u$W){u$W.transform.parent=null,this._scene&&(this._activeInHierarchy&&u$W._active&&u$W._inActiveHierarchy(),u$W._setUnBelongScene()),this._hierarchyAnimator&&(u$W._hierarchyAnimator==this._hierarchyAnimator&&u$W._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(u$W,!1,[u$W.name]))},u$t._parseBaseCustomProps=function(u$W){var u$j=this.transform.localPosition;u$W.translate?(u$j.fromArray(u$W.translate),u$j.x*=100,u$j.y*=100,u$j.z*=100):u$j.elements.fill(0),this.transform.localPosition=u$j;var u$t=this.transform.localRotation;u$W.rotation?u$t.fromArray(u$W.rotation):u$t.fromArray([0,0,0,-1]),this.transform.localRotation=u$t;var u$d=this.transform.localScale;u$W.scale?u$d.fromArray(u$W.scale):u$d.elements.fill(1),this.transform.localScale=u$d;var u$b=u$W.layer;null!=u$b&&(this.layer=u$v.getLayerByNumber(u$b))},u$t._parseCustomComponent=function(u$W,u$j,u$t){for(var u$d in u$t){var u$b=u$t[u$d];switch(u$d){case"Animator":var u$E=this.addComponent(Animator);if(u$b.avatarPath)u$E.avatar=u$o.getRes(u$j[u$b.avatarPath]);else{var u$O=u$b.avatar;if(u$O){u$E.avatar=u$o.getRes(u$j[u$O.path]);var u$q=u$O.linkSprites;u$q&&u$W.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[u$E,u$q])}}for(var u$A=u$b.clipPaths,u$c=u$A.length,u$R=0;u$R<u$c;u$R++)u$E.addClip(u$o.getRes(u$j[u$A[u$R]]));u$E.clip=u$o.getRes(u$j[u$A[0]]);var u$m=u$b.playOnWake;void 0!==u$m&&(u$E.playOnWake=u$m);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var u$Q=this.addComponent(SphereCollider);u$Q.isTrigger=u$b.isTrigger;var u$T=u$Q.center;u$T.fromArray(u$b.center),u$Q.center=u$T,u$Q.radius=u$b.radius;break;case"BoxCollider":var u$$=this.addComponent(BoxCollider);u$$.isTrigger=u$b.isTrigger,u$$.center.fromArray(u$b.center);var u$e=u$$.size;u$e.fromArray(u$b.size),u$$.size=u$e;break;case"MeshCollider":this.addComponent(MeshCollider)}}},u$t._onRootNodeHierarchyLoaded=function(u$W,u$j){for(var u$t in u$j){for(var u$d=this,u$b=u$j[u$t],u$E=0,u$O=u$b.length;u$E<u$O;u$E++){var u$q=u$b[u$E];if(""===u$q)break;if(!(u$d=u$d.getChildByName(u$q)))break}u$d&&u$W.linkSprite3DToAvatarNode(u$t,u$d)}},u$t._setHierarchyAnimator=function(u$W,u$j){this._changeHierarchyAnimator(u$W);for(var u$t=0,u$d=this._childs.length;u$t<u$d;u$t++){var u$b=this._childs[u$t];u$b._hierarchyAnimator==u$j&&u$b._setHierarchyAnimator(u$W,u$j)}},u$t._clearHierarchyAnimator=function(u$W,u$j){this._changeHierarchyAnimator(u$j);for(var u$t=0,u$d=this._childs.length;u$t<u$d;u$t++){var u$b=this._childs[u$t];u$b._hierarchyAnimator==u$W&&u$b._clearHierarchyAnimator(u$W,u$j)}},u$t._getAnimatorToLinkSprite3D=function(u$W,u$j,u$t){var u$d=this.getComponentByType(Animator);if(u$d&&(u$d.avatar?u$d.avatar._version||u$W._setAnimatorToLinkAvatar(u$d,u$j):u$W._setAnimatorToLinkSprite3DNoAvatar(u$d,u$j,u$t)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){u$t.unshift(this._parent.name);var u$b=this._parent;u$b._hierarchyAnimator&&u$b._getAnimatorToLinkSprite3D(u$W,u$j,u$t)}},u$t._setAnimatorToLinkSprite3DNoAvatar=function(u$W,u$j,u$t){var u$d=0,u$b=0;for(u$d=0,u$b=u$W.getClipCount();u$d<u$b;u$d++)u$W._handleSpriteOwnersBySprite(u$d,u$j,u$t,this);for(u$d=0,u$b=this._childs.length;u$d<u$b;u$d++){var u$E=this._childs[u$d],u$O=u$t.length;u$t.push(u$E.name),u$E._setAnimatorToLinkSprite3DNoAvatar(u$W,u$j,u$t),u$t.splice(u$O,1)}},u$t._changeHierarchyAnimator=function(u$W){this._hierarchyAnimator=u$W},u$t._isLinkSpriteToAnimationNode=function(u$W,u$j,u$t){var u$d=u$W._avatarNodes.indexOf(u$j),u$b=u$W._cacheSpriteToNodesMap;if(u$t)this._transform.dummy=u$j.transform,u$W._cacheNodesToSpriteMap[u$d]=u$b.length,u$b.push(u$d);else{this._transform.dummy=null;var u$E=u$W._cacheNodesToSpriteMap[u$d];u$W._cacheNodesToSpriteMap[u$d]=null,u$b.splice(u$E,1)}},u$t._setBelongScene=function(u$W){this._scene=u$W;for(var u$j=0,u$t=this._childs.length;u$j<u$t;u$j++)this._childs[u$j]._setBelongScene(u$W)},u$t._setUnBelongScene=function(){this._scene=null;for(var u$W=0,u$j=this._childs.length;u$W<u$j;u$W++)this._childs[u$W]._setUnBelongScene()},u$t._activeHierarchy=function(){var u$W=0,u$j=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),u$W=0,u$j=this._colliders.length;u$W<u$j;u$W++)this._layer._addCollider(this._colliders[u$W]);for(this.event("activeinhierarchychanged",!0),u$W=0,u$j=this._childs.length;u$W<u$j;u$W++){var u$t=this._childs[u$W];u$t._active&&u$t._activeHierarchy()}},u$t._inActiveHierarchy=function(){var u$W=0,u$j=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),u$W=0,u$j=this._colliders.length;u$W<u$j;u$W++){var u$t=this._colliders[u$W];u$t._clearCollsionMap(),this._layer._removeCollider(u$t)}for(this.event("activeinhierarchychanged",!1),u$W=0,u$j=this._childs.length;u$W<u$j;u$W++){var u$d=this._childs[u$W];u$d._active&&u$d._inActiveHierarchy()}},u$t.addComponent=function(u$W){var u$j,u$t=this._componentsMap.indexOf(u$W);if(-1===u$t)u$j=[],this._componentsMap.push(u$W),this._typeComponentsIndices.push(u$j);else if(u$j=this._typeComponentsIndices[u$t],this._components[u$j[0]].isSingleton)throw new Error("无法单实例创建"+u$W+"组件，"+u$W+"组件已存在！");var u$d=u$b.getInstance(u$W);return u$j.push(this._components.length),this._components.push(u$d),u$d instanceof laya.d3.component.Script&&this._scripts.push(u$d),u$d._initialize(this),u$d},u$t._removeComponent=function(u$W,u$j){var u$t,u$d=0,u$b=this._typeComponentsIndices[u$W],u$E=u$b[u$j],u$O=this._components[u$E];for(u$O instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(u$O),1),u$b.splice(u$j,1),0===u$b.length&&(this._typeComponentsIndices.splice(u$W,1),this._componentsMap.splice(u$W,1)),u$d=0,u$t=this._componentsMap.length;u$d<u$t;u$d++)for(var u$q=(u$b=this._typeComponentsIndices[u$d]).length-1;0<=u$q;u$q--){var u$A=u$b[u$q];if(!(u$E<u$A))break;u$b[u$q]=--u$A}u$O._destroy()},u$t._clearSelfRenderObjects=function(){},u$t._addSelfRenderObjects=function(){},u$t._parseCustomProps=function(u$W,u$j,u$t,u$d){},u$t._updateChilds=function(u$W){var u$j=this._childs.length;if(0!==u$j)for(var u$t=0;u$t<u$j;++u$t)this._childs[u$t]._update(u$W)},u$t._getSortID=function(u$W,u$j){return 1e3*u$j.id+u$W._getVertexBuffer().vertexDeclaration.id},u$t._update=function(u$W){(u$W.owner=this)._activeInHierarchy&&(this._updateComponents(u$W),this._lateUpdateComponents(u$W),u$z.spriteCount++,this._childs.length&&this._updateChilds(u$W))},u$t.getProjectionViewWorldMatrix=function(u$W){return u$Wj.multiply(u$W,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},u$t.loadHierarchy=function(u$W){this.addChild(laya.d3.core.Sprite3D.load(u$W))},u$t.addChildAt=function(u$W,u$j){if(!(u$W instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!u$W||this.destroyed||u$W===this)return u$W;if(u$W.zOrder&&this._set$P("hasZorder",!0),0<=u$j&&u$j<=this._childs.length){if(u$W._parent===this){var u$t=this.getChildIndex(u$W);this._childs.splice(u$t,1),this._childs.splice(u$j,0,u$W),this.conchModel&&(this.conchModel.removeChild(u$W.conchModel),this.conchModel.addChildAt(u$W.conchModel,u$j)),this._childChanged()}else u$W.parent&&u$W.parent.removeChild(u$W),this._childs===u$c.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(u$j,0,u$W),this.conchModel&&this.conchModel.addChildAt(u$W.conchModel,u$j),(u$W.parent=this)._addChild3D(u$W);return u$W}throw new Error("appendChildAt:The index is out of bounds")},u$t.addChild=function(u$W){if(!(u$W instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!u$W||this.destroyed||u$W===this)return u$W;if(u$W.zOrder&&this._set$P("hasZorder",!0),u$W._parent===this){var u$j=this.getChildIndex(u$W);u$j!==this._childs.length-1&&(this._childs.splice(u$j,1),this._childs.push(u$W),this.conchModel&&(this.conchModel.removeChild(u$W.conchModel),this.conchModel.addChildAt(u$W.conchModel,this._childs.length-1)),this._childChanged())}else u$W.parent&&u$W.parent.removeChild(u$W),this._childs===u$c.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(u$W),this.conchModel&&this.conchModel.addChildAt(u$W.conchModel,this._childs.length-1),(u$W.parent=this)._childChanged(),this._addChild3D(u$W);return u$W},u$t.removeChildAt=function(u$W){var u$j=this.getChildAt(u$W);return u$j&&(this._removeChild3D(u$j),this._childs.splice(u$W,1),this.conchModel&&this.conchModel.removeChild(u$j.conchModel),u$j.parent=null),u$j},u$t.removeChildren=function(u$W,u$j){if(void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=2147483647),this._childs&&0<this._childs.length){var u$t=this._childs;if(0===u$W&&u$E<=u$j){var u$d=u$t;this._childs=u$c.ARRAY_EMPTY}else u$d=u$t.splice(u$W,u$j-u$W);for(var u$b=0,u$E=u$d.length;u$b<u$E;u$b++)this._removeChild3D(u$d[u$b]),u$d[u$b].parent=null,this.conchModel&&this.conchModel.removeChild(u$d[u$b].conchModel)}return this},u$t.onAsynLoaded=function(u$W,u$j,u$t){var u$d=u$j[0];if("Sprite3D"!==u$d.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var u$b=u$j[1];u$Kj._createNodeByJson(this,u$d,this,u$b),this.event("hierarchyloaded",[this]),this.__loaded=!0},u$t.cloneTo=function(u$W){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var u$j=u$W;u$j.name=this.name,u$j._destroyed=this._destroyed,u$j.timer=this.timer,u$j._$P=this._$P,u$j.active=this._active;var u$t=u$j.transform.localPosition;this.transform.localPosition.cloneTo(u$t),u$j.transform.localPosition=u$t;var u$d=u$j.transform.localRotation;this.transform.localRotation.cloneTo(u$d),u$j.transform.localRotation=u$d;var u$b=u$j.transform.localScale;this.transform.localScale.cloneTo(u$b),u$j.transform.localScale=u$b,u$j.isStatic=this.isStatic;var u$E=0,u$O=0;for(u$E=0,u$O=this._componentsMap.length;u$E<u$O;u$E++){var u$q=u$j.addComponent(this._componentsMap[u$E]);this._components[u$E]._cloneTo(u$q)}for(u$E=0,u$O=this._childs.length;u$E<u$O;u$E++)u$j.addChild(this._childs[u$E].clone());var u$A=u$j.getComponentByType(Animator);if(u$A){var u$c=u$A._linkSpritesData;if(u$c)for(var u$R in u$c){for(var u$m=u$c[u$R],u$Q=u$j,u$T=0,u$$=u$m.length;u$T<u$$&&(u$Q=u$Q.getChildByName(u$m[u$T]));u$T++);if(u$Q){var u$e=u$A._avatarNodeMap[u$R];u$Q._isLinkSpriteToAnimationNode(u$A,u$e,!0)}}}},u$t.clone=function(){var u$W=new this.constructor;return this.cloneTo(u$W),u$W},u$t.destroy=function(u$W){if(void 0===u$W&&(u$W=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,u$W);var u$j,u$t=0;for(u$t=0,u$j=this._components.length;u$t<u$j;u$t++)this._components[u$t]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,u$o.clearRes(this.url),this.loaded||u$oj._cancelLoadByUrl(this.url)}},u$t._handleSpriteToAvatar=function(u$W,u$j){u$W._avatarNodes;var u$t=u$W._avatarNodeMap[this.name];u$t&&u$t.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(u$W,u$t,u$j)},u$t._setAnimatorToLinkAvatar=function(u$W,u$j){this._handleSpriteToAvatar(u$W,u$j);for(var u$t=0,u$d=this._childs.length;u$t<u$d;u$t++){this._childs[u$t]._setAnimatorToLinkAvatar(u$W,u$j)}},u$$(0,u$t,"activeInHierarchy",function(){return this._activeInHierarchy}),u$$(0,u$t,"_loaded",null,function(u$W){this.__loaded=u$W}),u$$(0,u$t,"active",function(){return this._active},function(u$W){this._active!==u$W&&(this._active=u$W,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(u$W?this._activeHierarchy():this._inActiveHierarchy()))}),u$$(0,u$t,"componentsCount",function(){return this._components.length}),u$$(0,u$t,"loaded",function(){return this.__loaded}),u$$(0,u$t,"id",function(){return this._id}),u$$(0,u$t,"url",function(){return this._url}),u$$(0,u$t,"layer",function(){return this._layer},function(u$W){if(this._layer!==u$W){if(!u$W)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var u$j=0,u$t=this._colliders.length;if(this._layer)for(u$j=0;u$j<u$t;u$j++)this._layer._removeCollider(this._colliders[u$j]);for(u$j=0;u$j<u$t;u$j++)u$W._addCollider(this._colliders[u$j])}this._layer=u$W,this.event("layerchanged",u$W)}}),u$$(0,u$t,"scene",function(){return this._scene}),u$$(0,u$t,"transform",function(){return this._transform}),u$j.instantiate=function(u$W,u$j,u$t,u$d,u$b){void 0===u$t&&(u$t=!0);var u$E=u$W.clone();u$j&&u$j.addChild(u$E);var u$O=u$E.transform;if(u$t){var u$q=u$O.worldMatrix;u$W.transform.worldMatrix.cloneTo(u$q),u$O.worldMatrix=u$q}else u$d&&(u$O.position=u$d),u$b&&(u$O.rotation=u$b);return u$E},u$j.load=function(u$W){return u$X.loader.create(u$W,null,null,u$j)},u$j.WORLDMATRIX=0,u$j.MVPMATRIX=1,u$j._uniqueIDCounter=0,u$j._nameNumberCounter=0,u$j}(),u$uj=function(u$W){function u$R(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],u$R.__super.call(this),!u$W||!u$j)throw"Shader Error";this._id=++u$R._count,this._vs=u$W,this._ps=u$j,this._attributeMap=u$t,this._sceneUniformMap=u$d,this._cameraUniformMap=u$b,this._spriteUniformMap=u$E,this._materialUniformMap=u$O,this._renderElementUniformMap=u$q,this._precompile=u$A,this._define=u$c,this._precompile&&u$R.extCompileObj&&u$R.extCompileFunc?u$R.extCompileFunc.call(u$R.extCompileObj,u$W,u$j,u$c):this.recreateResource()}u$T(u$R,"laya.d3.shader.Shader3D",u$t);var u$j=u$R.prototype;return u$j.recreateResource=function(){u$h.now();this._compile(),this.completeCreate(),this.memorySize=0},u$j.disposeResource=function(){u$G.mainContext.deleteShader(this._vshader),u$G.mainContext.deleteShader(this._pshader),u$G.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},u$j._compile=function(){if(!u$G.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var u$W=[this._vs,this._ps],u$j=u$G.mainContext;if(this._program=u$j.createProgram(),this._vshader=u$R._createShader(u$j,u$W[0],35633),this._pshader=u$R._createShader(u$j,u$W[1],35632),u$j.attachShader(this._program,this._vshader),u$j.attachShader(this._program,this._pshader),u$j.linkProgram(this._program),!u$e.isConchApp&&u$zj.debugMode&&!u$j.getProgramParameter(this._program,35714))throw u$j.getProgramInfoLog(this._program);var u$t,u$d=0,u$b=0,u$E=0;for(u$E=u$e.isConchApp?u$j.getProgramParameterEx(this._vs,this._ps,"",35721):u$j.getProgramParameter(this._program,35721),u$d=0;u$d<u$E;u$d++){var u$O=null;u$t={vartype:"attribute",ivartype:0,attrib:u$O=u$e.isConchApp?u$j.getActiveAttribEx(this._vs,this._ps,"",u$d):u$j.getActiveAttrib(this._program,u$d),location:u$j.getAttribLocation(this._program,u$O.name),name:u$O.name,type:u$O.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(u$t)}var u$q=0;for(u$q=u$e.isConchApp?u$j.getProgramParameterEx(this._vs,this._ps,"",35718):u$j.getProgramParameter(this._program,35718),u$d=0;u$d<u$q;u$d++){var u$A=null;u$A=u$e.isConchApp?u$j.getActiveUniformEx(this._vs,this._ps,"",u$d):u$j.getActiveUniform(this._program,u$d),0<(u$t={vartype:"uniform",ivartype:1,attrib:u$O,location:u$j.getUniformLocation(this._program,u$A.name),name:u$A.name,type:u$A.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(u$t.name=u$t.name.substr(0,u$t.name.length-3),u$t.isArray=!0,u$t.location=u$j.getUniformLocation(this._program,u$t.name)),this._uniformParams.push(u$t)}for(u$d=0,u$b=this._attributeParams.length;u$d<u$b;u$d++)(u$t=this._attributeParams[u$d]).indexOfParams=u$d,u$t.index=1,u$t.value=[u$t.location,null],u$t.codename=u$t.name,u$t.name=null!=this._attributeMap[u$t.codename]?this._attributeMap[u$t.codename]:u$t.codename,this._attributeParamsMap.push(u$t.name),this._attributeParamsMap.push(u$t),u$t._this=this,u$t.uploadedValue=[],u$t.fun=this._attribute;for(u$d=0,u$b=this._uniformParams.length;u$d<u$b;u$d++)switch((u$t=this._uniformParams[u$d]).indexOfParams=u$d,u$t.index=1,u$t.value=[u$t.location,null],u$t.codename=u$t.name,null!=this._sceneUniformMap[u$t.codename]?(u$t.name=this._sceneUniformMap[u$t.codename],this._sceneUniformParamsMap.push(u$t.name),this._sceneUniformParamsMap.push(u$t)):null!=this._cameraUniformMap[u$t.codename]?(u$t.name=this._cameraUniformMap[u$t.codename],this._cameraUniformParamsMap.push(u$t.name),this._cameraUniformParamsMap.push(u$t)):null!=this._spriteUniformMap[u$t.codename]?(u$t.name=this._spriteUniformMap[u$t.codename],this._spriteUniformParamsMap.push(u$t.name),this._spriteUniformParamsMap.push(u$t)):null!=this._materialUniformMap[u$t.codename]?(u$t.name=this._materialUniformMap[u$t.codename],this._materialUniformParamsMap.push(u$t.name),this._materialUniformParamsMap.push(u$t)):null!=this._renderElementUniformMap[u$t.codename]?(u$t.name=this._renderElementUniformMap[u$t.codename],this._renderElementUniformParamsMap.push(u$t.name),this._renderElementUniformParamsMap.push(u$t)):console.log("Shader:can't find uinform name:"+u$t.codename+" in shader file."),u$t._this=this,u$t.uploadedValue=[],u$t.type){case 5124:u$t.fun=u$t.isArray?this._uniform1iv:this._uniform1i;break;case 5126:u$t.fun=u$t.isArray?this._uniform1fv:this._uniform1f;break;case 35664:u$t.fun=u$t.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:u$t.fun=u$t.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:u$t.fun=u$t.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:u$t.fun=this._uniform_sampler2D;break;case 35680:u$t.fun=this._uniform_samplerCube;break;case 35676:u$t.fun=this._uniformMatrix4fv;break;case 35670:u$t.fun=this._uniform1i;break;case 35674:u$t.fun=this._uinformMatrix2fv;break;case 35675:u$t.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},u$j._attribute=function(u$W,u$j){var u$t=u$G.mainContext,u$d=u$q._enableAtributes,u$b=u$W.location;return u$d[u$b]||u$t.enableVertexAttribArray(u$b),u$t.vertexAttribPointer(u$b,u$j[0],u$j[1],u$j[2],u$j[3],u$j[4]),u$d[u$b]=u$q._bindVertexBuffer,1},u$j._uniform1f=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j?(u$G.mainContext.uniform1f(u$W.location,u$t[0]=u$j),1):0},u$j._uniform1fv=function(u$W,u$j){if(u$j.length<4){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]||u$t[2]!==u$j[2]||u$t[3]!==u$j[3]?(u$G.mainContext.uniform1fv(u$W.location,u$j),u$t[0]=u$j[0],u$t[1]=u$j[1],u$t[2]=u$j[2],u$t[3]=u$j[3],1):0}return u$G.mainContext.uniform1fv(u$W.location,u$j),1},u$j._uniform_vec2=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]?(u$G.mainContext.uniform2f(u$W.location,u$t[0]=u$j[0],u$t[1]=u$j[1]),1):0},u$j._uniform_vec2v=function(u$W,u$j){if(u$j.length<2){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]||u$t[2]!==u$j[2]||u$t[3]!==u$j[3]?(u$G.mainContext.uniform2fv(u$W.location,u$j),u$t[0]=u$j[0],u$t[1]=u$j[1],u$t[2]=u$j[2],u$t[3]=u$j[3],1):0}return u$G.mainContext.uniform2fv(u$W.location,u$j),1},u$j._uniform_vec3=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]||u$t[2]!==u$j[2]?(u$G.mainContext.uniform3f(u$W.location,u$t[0]=u$j[0],u$t[1]=u$j[1],u$t[2]=u$j[2]),1):0},u$j._uniform_vec3v=function(u$W,u$j){return u$G.mainContext.uniform3fv(u$W.location,u$j),1},u$j._uniform_vec4=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]||u$t[2]!==u$j[2]||u$t[3]!==u$j[3]?(u$G.mainContext.uniform4f(u$W.location,u$t[0]=u$j[0],u$t[1]=u$j[1],u$t[2]=u$j[2],u$t[3]=u$j[3]),1):0},u$j._uniform_vec4v=function(u$W,u$j){return u$G.mainContext.uniform4fv(u$W.location,u$j),1},u$j._uniformMatrix2fv=function(u$W,u$j){return u$G.mainContext.uniformMatrix2fv(u$W.location,!1,u$j),1},u$j._uniformMatrix3fv=function(u$W,u$j){return u$G.mainContext.uniformMatrix3fv(u$W.location,!1,u$j),1},u$j._uniformMatrix4fv=function(u$W,u$j){return u$G.mainContext.uniformMatrix4fv(u$W.location,!1,u$j),1},u$j._uinformMatrix2fv=function(u$W,u$j){return u$G.mainContext.uniformMatrix2fv(u$W.location,!1,u$j),1},u$j._uinformMatrix3fv=function(u$W,u$j){return u$G.mainContext.uniformMatrix3fv(u$W.location,!1,u$j),1},u$j._uniform1i=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j?(u$G.mainContext.uniform1i(u$W.location,u$t[0]=u$j),1):0},u$j._uniform1iv=function(u$W,u$j){return u$G.mainContext.uniform1iv(u$W.location,u$j),1},u$j._uniform_ivec2=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]?(u$G.mainContext.uniform2i(u$W.location,u$t[0]=u$j[0],u$t[1]=u$j[1]),1):0},u$j._uniform_ivec2v=function(u$W,u$j){return u$G.mainContext.uniform2iv(u$W.location,u$j),1},u$j._uniform_vec3i=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]||u$t[2]!==u$j[2]?(u$G.mainContext.uniform3i(u$W.location,u$t[0]=u$j[0],u$t[1]=u$j[1],u$t[2]=u$j[2]),1):0},u$j._uniform_vec3vi=function(u$W,u$j){return u$G.mainContext.uniform3iv(u$W.location,u$j),1},u$j._uniform_vec4i=function(u$W,u$j){var u$t=u$W.uploadedValue;return u$t[0]!==u$j[0]||u$t[1]!==u$j[1]||u$t[2]!==u$j[2]||u$t[3]!==u$j[3]?(u$G.mainContext.uniform4i(u$W.location,u$t[0]=u$j[0],u$t[1]=u$j[1],u$t[2]=u$j[2],u$t[3]=u$j[3]),1):0},u$j._uniform_vec4vi=function(u$W,u$j){return u$G.mainContext.uniform4iv(u$W.location,u$j),1},u$j._uniform_sampler2D=function(u$W,u$j){var u$t=u$j.source||u$j.defaulteTexture.source,u$d=u$G.mainContext,u$b=u$W.uploadedValue;if(null!=u$b[0])return u$d.activeTexture(u$R._TEXTURES[u$b[0]]),u$t&&u$l.bindTexture(u$d,3553,u$t),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return u$b[0]=this._curActTexIndex,u$d.uniform1i(u$W.location,this._curActTexIndex),u$d.activeTexture(u$R._TEXTURES[this._curActTexIndex]),u$t&&u$l.bindTexture(u$d,3553,u$t),this._curActTexIndex++,1},u$j._uniform_samplerCube=function(u$W,u$j){var u$t=u$j.source||u$j.defaulteTexture.source,u$d=u$G.mainContext,u$b=u$W.uploadedValue;if(null!=u$b[0])return u$d.activeTexture(u$R._TEXTURES[u$b[0]]),u$t?u$l.bindTexture(u$d,34067,u$t):u$l.bindTexture(u$d,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return u$b[0]=this._curActTexIndex,u$d.uniform1i(u$W.location,this._curActTexIndex),u$d.activeTexture(u$R._TEXTURES[this._curActTexIndex]),u$t?u$l.bindTexture(u$d,34067,u$t):u$l.bindTexture(u$d,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},u$j._noSetValue=function(u$W){console.log("no....:"+u$W.name)},u$j.bind=function(){return u$t.activeShader=this,(u$t.bindShader=this).activeResource(),u$l.UseProgram(this._program)},u$j.uploadAttributes=function(u$W,u$j){for(var u$t,u$d,u$b=0,u$E=0,u$O=this._attributeParamsMap.length;u$E<u$O;u$E+=2)u$d=this._attributeParamsMap[u$E+1],null!=(u$t=u$W[this._attributeParamsMap[u$E]])&&(u$j&&u$j[u$d.name]&&u$j[u$d.name].bind(),u$b+=u$d.fun.call(this,u$d,u$t));u$z.shaderCall+=u$b},u$j.uploadAttributesX=function(u$W,u$j){for(var u$t,u$d,u$b=0,u$E=0,u$O=this._attributeParamsMap.length;u$E<u$O;u$E+=2)u$d=this._attributeParamsMap[u$E+1],null!=(u$t=u$W[this._attributeParamsMap[u$E]])&&(u$j._bind(),u$b+=u$d.fun.call(this,u$d,u$t));u$z.shaderCall+=u$b},u$j.uploadSceneUniforms=function(u$W){for(var u$j,u$t,u$d=0,u$b=0,u$E=this._sceneUniformParamsMap.length;u$b<u$E;u$b+=2)u$t=this._sceneUniformParamsMap[u$b+1],null!=(u$j=u$W[this._sceneUniformParamsMap[u$b]])&&(u$d+=u$t.fun.call(this,u$t,u$j));u$z.shaderCall+=u$d},u$j.uploadCameraUniforms=function(u$W){for(var u$j,u$t,u$d=0,u$b=0,u$E=this._cameraUniformParamsMap.length;u$b<u$E;u$b+=2)u$t=this._cameraUniformParamsMap[u$b+1],null!=(u$j=u$W[this._cameraUniformParamsMap[u$b]])&&(u$d+=u$t.fun.call(this,u$t,u$j));u$z.shaderCall+=u$d},u$j.uploadSpriteUniforms=function(u$W){for(var u$j,u$t,u$d=0,u$b=0,u$E=this._spriteUniformParamsMap.length;u$b<u$E;u$b+=2)u$t=this._spriteUniformParamsMap[u$b+1],null!=(u$j=u$W[this._spriteUniformParamsMap[u$b]])&&(u$d+=u$t.fun.call(this,u$t,u$j));u$z.shaderCall+=u$d},u$j.uploadMaterialUniforms=function(u$W){for(var u$j,u$t,u$d=0,u$b=0,u$E=this._materialUniformParamsMap.length;u$b<u$E;u$b+=2)u$t=this._materialUniformParamsMap[u$b+1],null!=(u$j=u$W[this._materialUniformParamsMap[u$b]])&&(u$d+=u$t.fun.call(this,u$t,u$j));u$z.shaderCall+=u$d},u$j.uploadRenderElementUniforms=function(u$W){for(var u$j,u$t,u$d=0,u$b=0,u$E=this._renderElementUniformParamsMap.length;u$b<u$E;u$b+=2)u$t=this._renderElementUniformParamsMap[u$b+1],null!=(u$j=u$W[this._renderElementUniformParamsMap[u$b]])&&(u$d+=u$t.fun.call(this,u$t,u$j));u$z.shaderCall+=u$d},u$R.create=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){return new u$R(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c)},u$R.addInclude=function(u$W,u$j){u$M.addInclude(u$W,u$j)},u$R._createShader=function(u$W,u$j,u$t){var u$d=u$W.createShader(u$t);if(u$W.shaderSource(u$d,u$j),u$W.compileShader(u$d),u$zj.debugMode&&!u$W.getShaderParameter(u$d,35713))throw u$W.getShaderInfoLog(u$d);return u$d},u$R.PERIOD_RENDERELEMENT=0,u$R.PERIOD_MATERIAL=1,u$R.PERIOD_SPRITE=2,u$R.PERIOD_CAMERA=3,u$R.PERIOD_SCENE=4,u$R._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],u$R._count=0,u$R._preCompile=!1,u$R.extCompileFunc=null,u$R.extCompileObj=null,u$m(u$R,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new u$C}]),u$R}(),u$Dj=function(u$q){function u$A(){this._transformUV=null,u$A.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new u$Oj(.6,.6,.6)),this._setColor(10,new u$Oj(1,1,1)),this._setColor(11,new u$qj(1,1,1,8)),this._setColor(12,new u$Oj(1,1,1)),this._setColor(7,new u$qj(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new u$qj(1,1,0,0)),this.renderMode=1}u$T(u$A,"laya.d3.core.material.StandardMaterial",u$q);var u$W=u$A.prototype;return u$W.disableLight=function(){this._addDisablePublicShaderDefine(u$zj.SHADERDEFINE_POINTLIGHT|u$zj.SHADERDEFINE_SPOTLIGHT|u$zj.SHADERDEFINE_DIRECTIONLIGHT)},u$W.disableFog=function(){this._addDisablePublicShaderDefine(u$zj.SHADERDEFINE_FOG)},u$W.onAsynLoaded=function(u$W,u$j,u$t){var u$d=u$j[0];if(u$d.version)u$q.prototype.onAsynLoaded.call(this,u$W,u$j,u$t);else{var u$b=u$j[1],u$E=u$d.props;for(var u$O in u$E)this[u$O]=u$E[u$O];u$A._parseStandardMaterial(u$b,this,u$d),this._endLoaded()}},u$W.cloneTo=function(u$W){u$q.prototype.cloneTo.call(this,u$W);var u$j=u$W;this._transformUV&&(u$j._transformUV=this._transformUV.clone())},u$$(0,u$W,"ambientColor",function(){return this._getColor(9)},function(u$W){this._setColor(9,u$W)}),u$$(0,u$W,"ambientTexture",function(){return this._getTexture(5)},function(u$W){u$W?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,u$W)}),u$$(0,u$W,"renderMode",null,function(u$W){switch(u$W){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(u$A.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(u$W)}),u$$(0,u$W,"reflectColor",function(){return this._getColor(12)},function(u$W){this._setColor(12,u$W)}),u$$(0,u$W,"tilingOffset",function(){return this._getColor(15)},function(u$W){if(u$W){var u$j=u$W.elements;1!=u$j[0]||1!=u$j[1]||0!=u$j[2]||0!=u$j[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,u$W)}),u$$(0,u$W,"albedo",function(){return this._getColor(7)},function(u$W){this._setColor(7,u$W)}),u$$(0,u$W,"diffuseColor",function(){return this._getColor(10)},function(u$W){this._setColor(10,u$W)}),u$$(0,u$W,"albedoColor",function(){return this._getColor(7)},function(u$W){this._setColor(7,u$W)}),u$$(0,u$W,"specularColor",function(){return this._getColor(11)},function(u$W){this._setColor(11,u$W)}),u$$(0,u$W,"diffuseTexture",function(){return this._getTexture(1)},function(u$W){u$W?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,u$W)}),u$$(0,u$W,"normalTexture",function(){return this._getTexture(2)},function(u$W){u$W?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,u$W)}),u$$(0,u$W,"specularTexture",function(){return this._getTexture(3)},function(u$W){u$W?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,u$W)}),u$$(0,u$W,"emissiveTexture",function(){return this._getTexture(4)},function(u$W){u$W?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,u$W)}),u$$(0,u$W,"reflectTexture",function(){return this._getTexture(6)},function(u$W){u$W?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,u$W)}),u$$(0,u$W,"transformUV",function(){return this._transformUV},function(u$W){this._transformUV=u$W,this._setMatrix4x4(13,u$W.matrix),u$W?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,u$W.matrix.elements,0)}),u$A.__init__=function(){u$A.SHADERDEFINE_DIFFUSEMAP=u$A.shaderDefines.registerDefine("DIFFUSEMAP"),u$A.SHADERDEFINE_NORMALMAP=u$A.shaderDefines.registerDefine("NORMALMAP"),u$A.SHADERDEFINE_SPECULARMAP=u$A.shaderDefines.registerDefine("SPECULARMAP"),u$A.SHADERDEFINE_EMISSIVEMAP=u$A.shaderDefines.registerDefine("EMISSIVEMAP"),u$A.SHADERDEFINE_AMBIENTMAP=u$A.shaderDefines.registerDefine("AMBIENTMAP"),u$A.SHADERDEFINE_REFLECTMAP=u$A.shaderDefines.registerDefine("REFLECTMAP"),u$A.SHADERDEFINE_UVTRANSFORM=u$A.shaderDefines.registerDefine("UVTRANSFORM"),u$A.SHADERDEFINE_TILINGOFFSET=u$A.shaderDefines.registerDefine("TILINGOFFSET"),u$A.SHADERDEFINE_ADDTIVEFOG=u$A.shaderDefines.registerDefine("ADDTIVEFOG")},u$A.load=function(u$W){return u$X.loader.create(u$W,null,null,u$A)},u$A._parseStandardMaterial=function(u$W,u$j,u$t){var u$d=u$t.customProps,u$b=u$d.ambientColor;u$j.ambientColor=new u$Oj(u$b[0],u$b[1],u$b[2]);var u$E=u$d.diffuseColor;u$j.diffuseColor=new u$Oj(u$E[0],u$E[1],u$E[2]);var u$O=u$d.specularColor;u$j.specularColor=new u$qj(u$O[0],u$O[1],u$O[2],u$O[3]);var u$q=u$d.reflectColor;u$j.reflectColor=new u$Oj(u$q[0],u$q[1],u$q[2]);var u$A=u$d.albedoColor;u$A&&(u$j.albedo=new u$qj(u$A[0],u$A[1],u$A[2],u$A[3]));var u$c=u$d.diffuseTexture.texture2D;u$c&&(u$j.diffuseTexture=u$o.getRes(u$W[u$c]));var u$R=u$d.normalTexture.texture2D;u$R&&(u$j.normalTexture=u$o.getRes(u$W[u$R]));var u$m=u$d.specularTexture.texture2D;u$m&&(u$j.specularTexture=u$o.getRes(u$W[u$m]));var u$Q=u$d.emissiveTexture.texture2D;u$Q&&(u$j.emissiveTexture=u$o.getRes(u$W[u$Q]));var u$T=u$d.ambientTexture.texture2D;u$T&&(u$j.ambientTexture=u$o.getRes(u$W[u$T]));var u$$=u$d.reflectTexture.texture2D;u$$&&(u$j.reflectTexture=u$o.getRes(u$W[u$$]))},u$A.RENDERMODE_OPAQUE=1,u$A.RENDERMODE_OPAQUEDOUBLEFACE=2,u$A.RENDERMODE_CUTOUT=3,u$A.RENDERMODE_CUTOUTDOUBLEFACE=4,u$A.RENDERMODE_TRANSPARENT=13,u$A.RENDERMODE_TRANSPARENTDOUBLEFACE=14,u$A.RENDERMODE_ADDTIVE=15,u$A.RENDERMODE_ADDTIVEDOUBLEFACE=16,u$A.RENDERMODE_DEPTHREAD_TRANSPARENT=5,u$A.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,u$A.RENDERMODE_DEPTHREAD_ADDTIVE=7,u$A.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,u$A.RENDERMODE_NONDEPTH_TRANSPARENT=9,u$A.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,u$A.RENDERMODE_NONDEPTH_ADDTIVE=11,u$A.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,u$A.SHADERDEFINE_DIFFUSEMAP=0,u$A.SHADERDEFINE_NORMALMAP=0,u$A.SHADERDEFINE_SPECULARMAP=0,u$A.SHADERDEFINE_EMISSIVEMAP=0,u$A.SHADERDEFINE_AMBIENTMAP=0,u$A.SHADERDEFINE_REFLECTMAP=0,u$A.SHADERDEFINE_UVTRANSFORM=0,u$A.SHADERDEFINE_TILINGOFFSET=0,u$A.SHADERDEFINE_ADDTIVEFOG=0,u$A.DIFFUSETEXTURE=1,u$A.NORMALTEXTURE=2,u$A.SPECULARTEXTURE=3,u$A.EMISSIVETEXTURE=4,u$A.AMBIENTTEXTURE=5,u$A.REFLECTTEXTURE=6,u$A.ALBEDO=7,u$A.UVANIAGE=8,u$A.MATERIALAMBIENT=9,u$A.MATERIALDIFFUSE=10,u$A.MATERIALSPECULAR=11,u$A.MATERIALREFLECT=12,u$A.UVMATRIX=13,u$A.UVAGE=14,u$A.TILINGOFFSET=15,u$m(u$A,["defaultMaterial",function(){var u$W=new u$A;return u$W.lock=!0,this.defaultMaterial=u$W},"shaderDefines",function(){return this.shaderDefines=new u$Rj(u$xj.shaderDefines)}]),u$A}(u$xj),u$sj=function(u$W){function u$O(u$W,u$j,u$t,u$d,u$b){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===u$t&&(u$t=35044),void 0===u$d&&(u$d=!1),u$O.__super.call(this),this._indexType=u$W,this._indexCount=u$j,this._bufferUsage=u$t,this._bufferType=34963,this._canRead=u$d;var u$E;if("ushort"==u$W)this._indexTypeByteCount=2;else{if("ubyte"!=u$W)throw new Error("unidentification index type.");this._indexTypeByteCount=1}u$E=this._indexTypeByteCount*u$j,this._byteLength=u$E,this._bind(),u$q._gl.bufferData(this._bufferType,u$E,this._bufferUsage),this.uri=u$b,u$d?("ushort"==u$W?this._buffer=new Uint16Array(u$j):"ubyte"==u$W&&(this._buffer=new Uint8Array(u$j)),this.memorySize=2*u$E):this.memorySize=u$E}u$T(u$O,"laya.d3.graphics.IndexBuffer3D",u$W);var u$j=u$O.prototype;return u$j.setData=function(u$W,u$j,u$t,u$d){void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=4294967295);var u$b=0;if("ushort"==this._indexType?(u$b=2,0===u$t&&4294967295===u$d||(u$W=new Uint16Array(u$W.buffer,u$t*u$b,u$d))):"ubyte"==this._indexType&&(u$b=1,0===u$t&&4294967295===u$d||(u$W=new Uint8Array(u$W.buffer,u$t*u$b,u$d))),this._bind(),u$q._gl.bufferSubData(this._bufferType,u$j*u$b,u$W),this._canRead)if(0!==u$j||0!==u$t||4294967295!==u$d){var u$E=this._buffer.length-u$j;u$E<u$d&&(u$d=u$E);for(var u$O=0;u$O<u$d;u$O++)this._buffer[u$j+u$O]=u$W[u$O]}else this._buffer=u$W},u$j.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},u$j.disposeResource=function(){u$W.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},u$$(0,u$j,"indexType",function(){return this._indexType}),u$$(0,u$j,"indexTypeByteCount",function(){return this._indexTypeByteCount}),u$$(0,u$j,"indexCount",function(){return this._indexCount}),u$$(0,u$j,"canRead",function(){return this._canRead}),u$O.INDEXTYPE_UBYTE="ubyte",u$O.INDEXTYPE_USHORT="ushort",u$O.create=function(u$W,u$j,u$t,u$d,u$b){return void 0===u$t&&(u$t=35044),void 0===u$d&&(u$d=!1),new u$O(u$W,u$j,u$t,u$d,u$b)},u$O}(u$q),u$Yj=function(u$E){function u$O(u$W,u$j,u$t,u$d,u$b){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===u$d&&(u$d=!1),u$O.__super.call(this),this._vertexDeclaration=u$W,this._vertexCount=u$j,this._bufferUsage=u$t,this._bufferType=34962,this._canRead=u$d,this.uri=u$b,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*u$j,this._bind(),u$q._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),u$d&&(this._buffer=new Float32Array(this._byteLength/4))}u$T(u$O,"laya.d3.graphics.VertexBuffer3D",u$E);var u$W=u$O.prototype;return u$W.bindWithIndexBuffer=function(u$W){u$W&&u$W._bind(),this._bind()},u$W.setData=function(u$W,u$j,u$t,u$d){if(void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=4294967295),0===u$t&&4294967295===u$d||(u$W=new Float32Array(u$W.buffer,4*u$t,u$d)),this._bind(),u$q._gl.bufferSubData(this._bufferType,4*u$j,u$W),this._canRead)if(0!==u$j||0!==u$t||4294967295!==u$d){var u$b=this._buffer.length-u$j;u$b<u$d&&(u$d=u$b);for(var u$E=0;u$E<u$d;u$E++)this._buffer[u$j+u$E]=u$W[u$E]}else this._buffer=u$W},u$W.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},u$W.disposeResource=function(){for(var u$W=u$G.mainContext,u$j=this._vertexDeclaration.getVertexElements(),u$t=u$q._enableAtributes,u$d=0,u$b=u$j.length;u$d<u$b;u$d++)u$t[u$d]===this._glBuffer&&(u$W.disableVertexAttribArray(u$d),u$t[u$d]=null);u$E.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},u$$(0,u$W,"vertexDeclaration",function(){return this._vertexDeclaration}),u$$(0,u$W,"vertexCount",function(){return this._vertexCount}),u$$(0,u$W,"canRead",function(){return this._canRead}),u$O.create=function(u$W,u$j,u$t,u$d,u$b){return void 0===u$t&&(u$t=35044),void 0===u$d&&(u$d=!1),new u$O(u$W,u$j,u$t,u$d,u$b)},u$O}(u$q),u$Hj=function(u$W){function u$M(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,u$M.__super.call(this),this._type=3553}u$T(u$M,"laya.d3.resource.DataTexture2D",u$Gj);var u$j=u$M.prototype;return u$j.genDebugMipmaps=function(){var u$W=[];return u$W.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),u$W.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),u$W.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),u$W.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),u$W.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),u$W.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),u$W.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),u$W.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),u$W.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),u$W.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),u$W},u$j._onTextureLoaded=function(u$W){},u$j._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var u$W=u$G.mainContext,u$j=this._source=u$W.createTexture(),u$t=this._width,u$d=this._height,u$b=u$l.curBindTexTarget,u$E=u$l.curBindTexValue,u$O=!1;if(u$l.bindTexture(u$W,this._type,u$j),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var u$q=0;u$W.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var u$A=0;u$A<this._mipmaps.length;u$A++){if(this._mipmaps[u$A].byteLength!=u$c*u$R*4)throw"mipmap size error  level:"+u$A;u$W.texSubImage2D(this._type,0,u$M.simLodRect[u$q++],u$M.simLodRect[u$q++],u$M.simLodRect[u$q++],u$M.simLodRect[u$q++],6408,5121,new Uint8Array(this._mipmaps[u$A]))}this.minFifter=9729,this.magFifter=9729}else{var u$c=this._width,u$R=this._height;for(u$q=0,u$W.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),u$A=0;u$A<this._mipmaps.length;u$A++){if(this._mipmaps[u$A].byteLength!=u$c*u$R*4)throw"mipmap size error  level:"+u$A;u$W.texImage2D(this._type,u$A,6408,u$c,u$R,0,6408,5121,new Uint8Array(this._mipmaps[u$A])),(u$c/=2)<1&&(u$c=1),(u$R/=2)<1&&(u$R=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&u$W.pixelStorei(u$W.UNPACK_ALIGNMENT,1),u$W.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var u$m=0,u$Q=!1,u$T=!1;this._buffer.byteLength==4*u$t*u$d?(u$m=6408,u$Q=!0):this._buffer.byteLength==3*u$t*u$d?(u$m=6407,u$T=!0):u$m=this._format,u$Q||u$T?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),u$T&&u$W.pixelStorei(u$W.UNPACK_ALIGNMENT,1),u$W.texImage2D(this._type,0,u$m,u$t,u$d,0,u$m,5121,this._buffer)):u$W&&u$m==u$W.ALPHA?(u$W.texImage2D(3553,0,u$m,u$t,u$d,0,u$m,u$W.UNSIGNED_BYTE,this._buffer),u$O=!0):0!=u$m&&(u$W.compressedTexImage2D(3553,0,u$m,u$t,u$d,0,this._buffer),u$O=!0)}var u$$=this._minFifter,u$e=this._magFifter,u$K=0==this._wrapModeU?10497:33071,u$o=0==this._wrapModeV?10497:33071,u$S=u$Z.isPOT(u$t,u$d);u$S?(this._mipmap||this._mipmaps?-1!==u$$||(u$$=9987):-1!==u$$||(u$$=9729),-1!==u$e||(u$e=9729),u$W.texParameteri(this._type,10241,u$$),u$W.texParameteri(this._type,10240,u$e),u$W.texParameteri(this._type,10242,u$K),u$W.texParameteri(this._type,10243,u$o),this._mipmap&&u$W.generateMipmap(this._type)):(-1!==u$$||(u$$=9729),-1!==u$e||(u$e=9729),u$W.texParameteri(this._type,10241,u$$),u$W.texParameteri(this._type,10240,u$e),u$W.texParameteri(this._type,10242,33071),u$W.texParameteri(this._type,10243,33071)),u$b&&u$E&&u$l.bindTexture(u$W,u$b,u$E),this.memorySize=u$O?this._buffer.length:u$S?u$t*u$d*4*(1+1/3):u$t*u$d*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},u$j.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},u$j.onAsynLoaded=function(u$W,u$j,u$t){var u$d;u$t&&(u$d=u$t[0].call(this,u$j)),u$d&&(this._width=u$d.width,this._height=u$d.height,this._buffer=u$d.data),this._src=u$W,this._size=new u$ej(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},u$j.getPixels=function(){return new Uint8Array(this._buffer)},u$j.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(u$G.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},u$$(0,u$j,"src",function(){return this._src}),u$M.create=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){if(void 0===u$d&&(u$d=9729),void 0===u$b&&(u$b=9729),void 0===u$E&&(u$E=!0),!u$W||u$W.byteLength<u$j*u$t*4)throw"DataTexture2D create error";var u$q=new u$M;return u$q.uri=u$O,u$q._buffer=u$W,u$q._width=u$j,u$q._height=u$t,u$q._mipmap=u$E,u$q._magFifter=u$d,u$q._minFifter=u$b,u$q._size=new u$ej(u$q._width,u$q._height),u$q._conchTexture?alert("怎么给runtime传递datatexture数据"):u$q.activeResource(),u$q},u$M.load=function(u$W,u$j,u$t,u$d,u$b){if(void 0===u$j&&(u$j=0),void 0===u$t&&(u$t=0),void 0===u$d&&(u$d=9729),void 0===u$b&&(u$b=9729),"mipmaps"===u$L.getFileExtension(u$W)){var u$E=u$X.loader.create(u$W,null,null,u$M,[function(u$W){this._mipmaps=[];var u$j=new Uint32Array(u$W);this._width=u$j[0];var u$t=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,u$t=1024),this._width!=u$t)throw"现在只支持512x256的环境贴图。当前的是"+u$j[0];this._height=u$j[1];for(var u$d=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,u$b=this._height,u$E=8;;){var u$O=u$d*u$b*4;if(u$E+u$O>u$W.byteLength)throw"load mipmaps data size error ";var u$q=new Uint8Array(u$W,u$E,u$O);if(this._mipmaps.push(u$q),u$E+=u$O,1==u$d&&1==u$b)break;(u$d/=2)<1&&(u$d=1),(u$b/=2)<1&&(u$b=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){u$E.simLodInfo=new Float32Array(40);for(var u$O=0;u$O<u$E.simLodInfo.length;)u$E.simLodInfo[u$O]=(u$M.simLodRect[u$O]+.5)/1024,u$O++,u$E.simLodInfo[u$O]=(u$M.simLodRect[u$O]+.5)/256,u$O++,u$E.simLodInfo[u$O]=Math.max(u$M.simLodRect[u$O]-1,.1)/1024,u$O++,u$E.simLodInfo[u$O]=Math.max(u$M.simLodRect[u$O]-1.5,.1)/256,u$O++}return u$E}if("number"==typeof u$j)return u$X.loader.create(u$W,null,null,u$M,[function(u$W){return this._width=u$j,this._height=u$t,this._buffer=u$W,null}]);if("function"==typeof u$j)return u$X.loader.create(u$W,null,null,u$M,[u$j]);throw new Error("unknown params.")},u$M.lodasatlas=!1,u$m(u$M,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),u$M}(),u$Ij=function(u$W){function u$j(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,u$j.__super.call(this)}u$T(u$j,"laya.d3.resource.models.PrimitiveMesh",u$lj);var u$t=u$j.prototype;return u$X.imps(u$t,{"laya.d3.core.render.IRenderable":!0}),u$t._getVertexBuffer=function(u$W){return void 0===u$W&&(u$W=0),0===u$W?this._vertexBuffer:null},u$t._getVertexBuffers=function(){return null},u$t._getIndexBuffer=function(){return this._indexBuffer},u$t._getPositions=function(){var u$W,u$j=[],u$t=this._vertexBuffer.vertexDeclaration.getVertexElements(),u$d=0;for(u$d=0;u$d<u$t.length;u$d++){var u$b=u$t[u$d];if("vector3"===u$b.elementFormat&&0===u$b.elementUsage){u$W=u$b;break}}var u$E=this._vertexBuffer.getData();for(u$d=0;u$d<u$E.length;u$d+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var u$O=u$d+u$W.offset/4,u$q=new u$Oj(u$E[u$O+0],u$E[u$O+1],u$E[u$O+2]);u$j.push(u$q)}return u$j},u$t.getRenderElement=function(u$W){return this},u$t.getRenderElementsCount=function(){return 1},u$t.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},u$t._beforeRender=function(u$W){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},u$t._render=function(u$W){u$G.mainContext.drawElements(4,this._numberIndices,5123,0),u$z.drawCall++,u$z.trianglesFaces+=this._numberIndices/3},u$$(0,u$t,"_vertexBufferCount",function(){return 1}),u$$(0,u$t,"triangleCount",function(){return this._indexBuffer.indexCount/3}),u$j}(),u$gj=function(u$W){function u$j(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,u$j.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}u$T(u$j,"laya.d3.resource.models.Mesh",u$lj);var u$t=u$j.prototype;return u$t._getPositions=function(){var u$W,u$j,u$t,u$d,u$b,u$E=[],u$O=0,u$q=0,u$A=0;if(0!==this._vertexBuffers.length){var u$c=this._vertexBuffers.length;for(u$O=0;u$O<u$c;u$O++){for(u$t=(u$W=this._vertexBuffers[u$O]).vertexDeclaration.getVertexElements(),u$q=0;u$q<u$t.length;u$q++)if("vector3"===(u$d=u$t[u$q]).elementFormat&&0===u$d.elementUsage){u$j=u$d;break}for(u$b=u$W.getData(),u$q=0;u$q<u$b.length;u$q+=u$W.vertexDeclaration.vertexStride/4)u$A=u$q+u$j.offset/4,u$E.push(new u$Oj(u$b[u$A+0],u$b[u$A+1],u$b[u$A+2]))}}else{var u$R=this._subMeshes.length;for(u$O=0;u$O<u$R;u$O++){for(u$t=(u$W=this._subMeshes[u$O]._getVertexBuffer()).vertexDeclaration.getVertexElements(),u$q=0;u$q<u$t.length;u$q++)if("vector3"===(u$d=u$t[u$q]).elementFormat&&0===u$d.elementUsage){u$j=u$d;break}for(u$b=u$W.getData(),u$q=0;u$q<u$b.length;u$q+=u$W.vertexDeclaration.vertexStride/4)u$A=u$q+u$j.offset/4,u$E.push(new u$Oj(u$b[u$A+0],u$b[u$A+1],u$b[u$A+2]))}}return u$E},u$t._setSubMeshes=function(u$W){this._subMeshes=u$W,this._subMeshCount=u$W.length;for(var u$j=0;u$j<this._subMeshCount;u$j++)u$W[u$j]._indexInMesh=u$j;this._positions=this._getPositions(),this._generateBoundingObject()},u$t.onAsynLoaded=function(u$W,u$j,u$t){var u$d=u$j[0],u$b=u$j[1];u$iW.read(u$d,this,this._materials,this._subMeshes,u$b),this.completeCreate(),this._endLoaded()},u$t.getSubMesh=function(u$W){return this._subMeshes[u$W]},u$t.getSubMeshCount=function(){return this._subMeshes.length},u$t.getRenderElementsCount=function(){return this._subMeshes.length},u$t.getRenderElement=function(u$W){return this._subMeshes[u$W]},u$t.disposeResource=function(){for(var u$W=0;u$W<this._subMeshes.length;u$W++)this._subMeshes[u$W].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},u$$(0,u$t,"materials",function(){return this._materials.slice()}),u$$(0,u$t,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),u$j.load=function(u$W){return u$X.loader.create(u$W,null,null,u$j)},u$j}(),u$fj=(function(u$W){function u$c(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===u$t&&(u$t=6408),void 0===u$d&&(u$d=5121),void 0===u$b&&(u$b=33189),void 0===u$E&&(u$E=!1),void 0===u$O&&(u$O=!1),void 0===u$q&&(u$q=-1),void 0===u$A&&(u$A=-1),u$c.__super.call(this),this._type=3553,this._width=u$W,this._height=u$j,this._size=new u$ej(u$W,u$j),this._surfaceFormat=u$t,this._surfaceType=u$d,this._depthStencilFormat=u$b,u$e.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=u$E,this._repeat=u$O,this._minFifter=u$q,this._magFifter=u$A,this.activeResource(),this._alreadyResolved=!0}u$T(u$c,"laya.d3.resource.RenderTexture",u$Gj);var u$j=u$c.prototype;u$j.recreateResource=function(){var u$W=u$G.mainContext;this._frameBuffer=u$W.createFramebuffer(),this._source=u$W.createTexture();var u$j=u$l.curBindTexTarget,u$t=u$l.curBindTexValue;u$l.bindTexture(u$W,this._type,this._source),u$W.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var u$d=this._minFifter,u$b=this._magFifter,u$E=this._repeat?10497:33071;if(u$Z.isPOT(this._width,this._height)?(this._mipmap?-1!==u$d||(u$d=9987):-1!==u$d||(u$d=9729),-1!==u$b||(u$b=9729),u$W.texParameteri(this._type,10241,u$d),u$W.texParameteri(this._type,10240,u$b),u$W.texParameteri(this._type,10242,u$E),u$W.texParameteri(this._type,10243,u$E),this._mipmap&&u$W.generateMipmap(this._type)):(-1!==u$d||(u$d=9729),-1!==u$b||(u$b=9729),u$W.texParameteri(this._type,10241,u$d),u$W.texParameteri(this._type,10240,u$b),u$W.texParameteri(this._type,10242,33071),u$W.texParameteri(this._type,10243,33071)),u$j&&u$t&&u$l.bindTexture(u$W,u$j,u$t),u$W.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=u$W.createRenderbuffer(),u$W.bindRenderbuffer(36161,this._depthStencilBuffer),u$W.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),u$W.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:u$W.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:u$W.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:u$W.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}u$W.framebufferTexture2D(36160,36064,3553,this._source,0),u$W.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},u$j.start=function(){u$G.mainContext.bindFramebuffer(36160,this.frameBuffer),(u$c._currentRenderTarget=this)._alreadyResolved=!1},u$j.end=function(){u$G.mainContext.bindFramebuffer(36160,null),u$c._currentRenderTarget=null,this._alreadyResolved=!0},u$j.getData=function(u$W,u$j,u$t,u$d){var u$b=u$G.mainContext;if(u$b.bindFramebuffer(36160,this._frameBuffer),!(36053===u$b.checkFramebufferStatus(36160)))return u$b.bindFramebuffer(36160,null),null;var u$E=new Uint8Array(this._width*this._height*4);return u$b.readPixels(u$W,u$j,u$t,u$d,this._surfaceFormat,this._surfaceType,u$E),u$b.bindFramebuffer(36160,null),u$E},u$j.disposeResource=function(){if(this._frameBuffer){var u$W=u$G.mainContext;u$W.deleteTexture(this._source),u$W.deleteFramebuffer(this._frameBuffer),u$W.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},u$$(0,u$j,"surfaceFormat",function(){return this._surfaceFormat}),u$$(0,u$j,"surfaceType",function(){return this._surfaceType}),u$$(0,u$j,"depthStencilFormat",function(){return this._depthStencilFormat}),u$$(0,u$j,"source",function(){return this._alreadyResolved?u$X.superGet(u$Gj,this,"source"):null}),u$$(0,u$j,"depthStencilBuffer",function(){return this._depthStencilBuffer}),u$$(0,u$j,"frameBuffer",function(){return this._frameBuffer}),u$c._currentRenderTarget=null}(),function(u$W){function u$j(u$W){this._color=null,this._pixels=null,u$j.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new u$ej(this.width,this.height),this._color=u$W,this._pixels=new Uint8Array([255*u$W.x,255*u$W.y,255*u$W.z,255*u$W.w]),this.uri="SolidColorTexture2D_"+this.id}u$T(u$j,"laya.d3.resource.SolidColorTexture2D",u$Gj);var u$t=u$j.prototype;return u$t._createWebGlTexture=function(){var u$W=u$G.mainContext,u$j=this._source=u$W.createTexture(),u$t=this._width,u$d=this._height,u$b=u$l.curBindTexTarget,u$E=u$l.curBindTexValue;u$l.bindTexture(u$W,this._type,u$j),u$W.texImage2D(this._type,0,6408,u$t,u$d,0,6408,5121,this._pixels);var u$O=this._minFifter,u$q=this._magFifter,u$A=this._repeat?10497:33071,u$c=u$Z.isPOT(u$t,u$d);u$c?(this._mipmap?-1!==u$O||(u$O=9987):-1!==u$O||(u$O=9729),-1!==u$q||(u$q=9729),u$W.texParameteri(this._type,10241,u$O),u$W.texParameteri(this._type,10240,u$q),u$W.texParameteri(this._type,10242,u$A),u$W.texParameteri(this._type,10243,u$A),this._mipmap&&u$W.generateMipmap(this._type)):(-1!==u$O||(u$O=9729),-1!==u$q||(u$q=9729),u$W.texParameteri(this._type,10241,u$O),u$W.texParameteri(this._type,10240,u$q),u$W.texParameteri(this._type,10242,33071),u$W.texParameteri(this._type,10243,33071)),u$b&&u$E&&u$l.bindTexture(u$W,u$b,u$E),this.memorySize=u$c?u$t*u$d*4*(1+1/3):u$t*u$d*4},u$t.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},u$t.disposeResource=function(){this._source&&(u$G.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},u$m(u$j,["magentaTexture",function(){var u$W=new u$j(new u$qj(1,0,1,1));return u$W.lock=!0,this.magentaTexture=u$W},"grayTexture",function(){var u$W=new u$j(new u$qj(.5,.5,.5,1));return u$W.lock=!0,this.grayTexture=u$W}]),u$j}()),u$wj=function(u$W){function u$b(u$W,u$j,u$t,u$d){this._canRead=!1,this._image=null,this._pixels=null,void 0===u$W&&(u$W=!1),void 0===u$j&&(u$j=!0),void 0===u$t&&(u$t=6408),void 0===u$d&&(u$d=!0),u$b.__super.call(this),this._type=3553,this._repeat=u$j,this._canRead=u$W,this._format=u$t,this._mipmap=u$d}u$T(u$b,"laya.d3.resource.Texture2D",u$Gj);var u$j=u$b.prototype;return u$j._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var u$W=u$G.mainContext,u$j=this._source=u$W.createTexture(),u$t=this._width,u$d=this._height,u$b=u$l.curBindTexTarget,u$E=u$l.curBindTexValue;switch(u$l.bindTexture(u$W,this._type,u$j),this._format){case 6407:case 6408:this._canRead?u$W.texImage2D(this._type,0,this._format,u$t,u$d,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?u$W.texImage2D(this._type,0,this._image._format,u$t,u$d,0,this._image._format,5121,this._image.atlasSource):u$W.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case u$G.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:u$W.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var u$O=this._minFifter,u$q=this._magFifter,u$A=this._repeat?10497:33071,u$c=0==this._wrapModeU?10497:33071,u$R=0==this._wrapModeV?10497:33071,u$m=u$Z.isPOT(u$t,u$d);u$m?(this._mipmap?-1!==u$O||(u$O=9987):-1!==u$O||(u$O=9729),-1!==u$q||(u$q=9729),u$W.texParameteri(this._type,10241,u$O),u$W.texParameteri(this._type,10240,u$q),u$W.texParameteri(this._type,10242,u$A),u$W.texParameteri(this._type,10243,u$A),u$W.texParameteri(this._type,10242,u$c),u$W.texParameteri(this._type,10243,u$R),this._mipmap&&u$W.generateMipmap(this._type)):(-1!==u$O||(u$O=9729),-1!==u$q||(u$q=9729),u$W.texParameteri(this._type,10241,u$O),u$W.texParameteri(this._type,10240,u$q),u$W.texParameteri(this._type,10242,33071),u$W.texParameteri(this._type,10243,33071)),u$b&&u$E&&u$l.bindTexture(u$W,u$b,u$E),this._image.onload=null,this._image=null,this.memorySize=u$m?u$t*u$d*4*(1+1/3):u$t*u$d*4},u$j.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},u$j.onAsynLoaded=function(u$W,u$j,u$t){if(u$t){var u$d=u$t[0];void 0!==u$d&&(this._canRead=u$d);var u$b=u$t[1];void 0!==u$b&&(this._repeat=u$b);var u$E=u$t[2];void 0!==u$E&&(this._format=u$E);var u$O=u$t[3];void 0!==u$O&&(this._mipmap=u$O);var u$q=u$t.wrapModeU;void 0!==u$q&&(this._wrapModeU=u$q);var u$A=u$t.wrapModeV;void 0!==u$A&&(this._wrapModeV=u$A)}switch(this._format){case 6407:case 6408:var u$c=(this._image=u$j).width,u$R=u$j.height;this._width=u$c,this._height=u$R,this._size=new u$ej(u$c,u$R),this._canRead&&(u$e.isConchApp?u$j instanceof u$Q.HTMLElement&&(this._pixels=new Uint8Array(u$j.getImageData(0,0,u$c,u$R))):(u$h.canvas.size(u$c,u$R),u$h.canvas.clear(),u$h.context.drawImage(u$j,0,0,u$c,u$R),this._pixels=new Uint8Array(u$h.context.getImageData(0,0,u$c,u$R).data.buffer)));break;case u$G.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var u$m=new u$_(u$j);u$m.readUTFBytes(4),u$m.readUTFBytes(2),u$m.getInt16();u$m.endian="bigEndian",this._width=u$m.getInt16(),this._height=u$m.getInt16(),this._size=new u$ej(this._width,this._height);u$m.getInt16(),u$m.getInt16();this._image=new Uint8Array(u$j,u$m.pos)}this.recreateResource(),this._endLoaded()},u$j.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},u$j.disposeResource=function(){this._source&&(u$G.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},u$$(0,u$j,"_src",function(){return this.url}),u$$(0,u$j,"src",function(){return this.url}),u$b.load=function(u$W){return u$X.loader.create(u$W,null,null,u$b)},u$b}(),u$Uj=function(u$j){function u$t(u$W,u$j){u$t.__super.call(this),void 0===u$W&&(u$W=.3),void 0===u$j&&(u$j=1e3),this._tempVector3=new u$Oj,this._position=new u$Oj,this._up=new u$Oj,this._forward=new u$Oj,this._right=new u$Oj,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=u$ej.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=u$W,this._farPlane=u$j,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),u$X.stage.on("resize",this,this._onScreenSizeChanged)}u$T(u$t,"laya.d3.core.BaseCamera",u$j);var u$W=u$t.prototype;return u$W._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var u$W=this.scene._cameraPool,u$j=u$W.length-1,u$t=0;u$t<u$j;u$t++)if(u$W[u$t].renderingOrder>u$W[u$j].renderingOrder){var u$d=u$W[u$t];u$W[u$t]=u$W[u$j],u$W[u$j]=u$d}},u$W._calculateProjectionMatrix=function(){},u$W._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},u$W._prepareCameraToRender=function(){u$v._currentCameraCullingMask=this.cullingMask;var u$W=this._shaderValues;u$W.setValue(0,this.transform.position.elements),u$W.setValue(5,this.forward.elements),u$W.setValue(6,this.up.elements)},u$W._prepareCameraViewProject=function(u$W,u$j){var u$t=this._shaderValues;u$t.setValue(1,u$W.elements),u$t.setValue(2,u$j.elements)},u$W._renderCamera=function(u$W,u$j,u$t){},u$W.addLayer=function(u$W){29!==u$W.number&&30!=u$W.number&&(this.cullingMask=this.cullingMask|u$W.mask)},u$W.removeLayer=function(u$W){29!==u$W.number&&30!=u$W.number&&(this.cullingMask=this.cullingMask&~u$W.mask)},u$W.addAllLayers=function(){this.cullingMask=2147483647},u$W.removeAllLayers=function(){this.cullingMask=0|u$v.getLayerByNumber(29).mask|u$v.getLayerByNumber(30).mask},u$W.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},u$W.moveForward=function(u$W){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=u$W,this.transform.translate(this._tempVector3)},u$W.moveRight=function(u$W){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=u$W,this.transform.translate(this._tempVector3)},u$W.moveVertical=function(u$W){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=u$W,this.transform.translate(this._tempVector3,!1)},u$W._addSelfRenderObjects=function(){var u$W=this.scene._cameraPool,u$j=u$W.length;if(0<u$j){for(var u$t=u$j-1;0<=u$t;u$t--)if(this.renderingOrder<=u$W[u$t].renderingOrder){u$W.splice(u$t+1,0,this);break}}else u$W.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},u$W._clearSelfRenderObjects=function(){var u$W=this.scene._cameraPool;u$W.splice(u$W.indexOf(this),1)},u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,u$X.stage.off("resize",this,this._onScreenSizeChanged),u$j.prototype.destroy.call(this,u$W)},u$$(0,u$W,"sky",function(){return this._sky},function(u$W){(this._sky=u$W)._ownerCamera=this}),u$$(0,u$W,"forward",function(){var u$W=this.transform.worldMatrix.elements,u$j=this._forward.elements;return u$j[0]=-u$W[8],u$j[1]=-u$W[9],u$j[2]=-u$W[10],this._forward}),u$$(0,u$W,"position",function(){var u$W=this.transform.worldMatrix.elements,u$j=this._position.elements;return u$j[0]=u$W[12],u$j[1]=u$W[13],u$j[2]=u$W[14],this._position}),u$$(0,u$W,"renderTarget",function(){return this._renderTarget},function(u$W){null!=(this._renderTarget=u$W)&&(this._renderTargetSize=u$W.size)}),u$$(0,u$W,"up",function(){var u$W=this.transform.worldMatrix.elements,u$j=this._up.elements;return u$j[0]=u$W[4],u$j[1]=u$W[5],u$j[2]=u$W[6],this._up}),u$$(0,u$W,"right",function(){var u$W=this.transform.worldMatrix.elements,u$j=this._right.elements;return u$j[0]=u$W[0],u$j[1]=u$W[1],u$j[2]=u$W[2],this._right}),u$$(0,u$W,"renderTargetSize",function(){return this._renderTargetSize},function(u$W){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=u$W,this._calculateProjectionMatrix()}),u$$(0,u$W,"fieldOfView",function(){return this._fieldOfView},function(u$W){this._fieldOfView=u$W,this._calculateProjectionMatrix()}),u$$(0,u$W,"nearPlane",function(){return this._nearPlane},function(u$W){this._nearPlane=u$W,this._calculateProjectionMatrix()}),u$$(0,u$W,"farPlane",function(){return this._farPlane},function(u$W){this._farPlane=u$W,this._calculateProjectionMatrix()}),u$$(0,u$W,"orthographic",function(){return this._orthographic},function(u$W){this._orthographic=u$W,this._calculateProjectionMatrix()}),u$$(0,u$W,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(u$W){this._orthographicVerticalSize=u$W,this._calculateProjectionMatrix()}),u$$(0,u$W,"renderingOrder",function(){return this._renderingOrder},function(u$W){this._renderingOrder=u$W,this._sortCamerasByRenderingOrder()}),u$t.CAMERAPOS=0,u$t.VIEWMATRIX=1,u$t.PROJECTMATRIX=2,u$t.VPMATRIX=3,u$t.VPMATRIX_NO_TRANSLATE=4,u$t.CAMERADIRECTION=5,u$t.CAMERAUP=6,u$t.ENVIRONMENTDIFFUSE=7,u$t.ENVIRONMENTSPECULAR=8,u$t.SIMLODINFO=9,u$t.DIFFUSEIRRADMATR=10,u$t.DIFFUSEIRRADMATG=11,u$t.DIFFUSEIRRADMATB=12,u$t.HDREXPOSURE=13,u$t.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",u$t.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",u$t.CLEARFLAG_SOLIDCOLOR=0,u$t.CLEARFLAG_SKY=1,u$t.CLEARFLAG_DEPTHONLY=2,u$t.CLEARFLAG_NONE=3,u$m(u$t,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new u$Wj(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new u$Wj},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new u$Wj}]),u$t}(u$aj),u$Jj=function(u$t){function u$j(u$W){this._render=null,this._geometryFilter=null,u$j.__super.call(this,u$W)}u$T(u$j,"laya.d3.core.RenderableSprite3D",u$t);var u$W=u$j.prototype;return u$W._addToInitStaticBatchManager=function(){},u$W._setBelongScene=function(u$W){u$t.prototype._setBelongScene.call(this,u$W),u$W._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},u$W._setUnBelongScene=function(){var u$W=this._scene._renderableSprite3Ds,u$j=u$W.indexOf(this);u$W.splice(u$j,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),u$t.prototype._setUnBelongScene.call(this)},u$W._update=function(u$W){(u$W.owner=this)._activeInHierarchy&&(this._updateComponents(u$W),this._render._updateOctreeNode(),this._lateUpdateComponents(u$W),u$z.spriteCount++,this._childs.length&&this._updateChilds(u$W))},u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),u$t.prototype.destroy.call(this,u$W),this._render._destroy(),this._render=null},u$j.__init__=function(){u$j.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=u$j.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),u$j.SAHDERDEFINE_LIGHTMAP=u$j.shaderDefines.registerDefine("LIGHTMAP")},u$j.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,u$j.SAHDERDEFINE_LIGHTMAP=4,u$j.LIGHTMAPSCALEOFFSET=2,u$j.LIGHTMAP=3,u$m(u$j,["shaderDefines",function(){return this.shaderDefines=new u$Rj}]),u$j}(u$aj),u$rj=(function(u$W){function u$d(u$W,u$j,u$t){this._long=NaN,this._width=NaN,this._height=NaN,void 0===u$W&&(u$W=1),void 0===u$j&&(u$j=1),void 0===u$t&&(u$t=1),u$d.__super.call(this),this._long=u$W,this._width=u$j,this._height=u$t,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}u$T(u$d,"laya.d3.resource.models.BoxMesh",u$Ij);var u$j=u$d.prototype;u$j.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var u$W=u$GW.vertexDeclaration,u$j=(u$W.vertexStride,this._long/2),u$t=this._height/2,u$d=this._width/2,u$b=new Float32Array([-u$j,u$t,-u$d,0,1,0,0,0,u$j,u$t,-u$d,0,1,0,1,0,u$j,u$t,u$d,0,1,0,1,1,-u$j,u$t,u$d,0,1,0,0,1,-u$j,-u$t,-u$d,0,-1,0,0,1,u$j,-u$t,-u$d,0,-1,0,1,1,u$j,-u$t,u$d,0,-1,0,1,0,-u$j,-u$t,u$d,0,-1,0,0,0,-u$j,u$t,-u$d,-1,0,0,0,0,-u$j,u$t,u$d,-1,0,0,1,0,-u$j,-u$t,u$d,-1,0,0,1,1,-u$j,-u$t,-u$d,-1,0,0,0,1,u$j,u$t,-u$d,1,0,0,1,0,u$j,u$t,u$d,1,0,0,0,0,u$j,-u$t,u$d,1,0,0,0,1,u$j,-u$t,-u$d,1,0,0,1,1,-u$j,u$t,u$d,0,0,1,0,0,u$j,u$t,u$d,0,0,1,1,0,u$j,-u$t,u$d,0,0,1,1,1,-u$j,-u$t,u$d,0,0,1,0,1,-u$j,u$t,-u$d,0,0,-1,1,0,u$j,u$t,-u$d,0,0,-1,0,0,u$j,-u$t,-u$d,0,0,-1,0,1,-u$j,-u$t,-u$d,0,0,-1,1,1]),u$E=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new u$Yj(u$W,this._numberVertices,35044,!0),this._indexBuffer=new u$sj("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(u$b),this._indexBuffer.setData(u$E),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},u$$(0,u$j,"long",function(){return this._long},function(u$W){this._long!==u$W&&(this._long=u$W,this.releaseResource(),this.activeResource())}),u$$(0,u$j,"width",function(){return this._width},function(u$W){this._width!==u$W&&(this._width=u$W,this.releaseResource(),this.activeResource())}),u$$(0,u$j,"height",function(){return this._height},function(u$W){this._height!==u$W&&(this._height=u$W,this.releaseResource(),this.activeResource())})}(),function(u$W){function u$O(u$W,u$j,u$t){void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=.3),void 0===u$t&&(u$t=1e3),this._viewMatrix=new u$Wj,this._projectionMatrix=new u$Wj,this._projectionViewMatrix=new u$Wj,this._viewport=new u$Aj(0,0,0,0),this._normalizedViewport=new u$Aj(0,0,1,1),this._aspectRatio=u$W,this._boundFrustumUpdate=!0,this._boundFrustum=new u$nW(u$Wj.DEFAULT),u$O.__super.call(this,u$j,u$t),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}u$T(u$O,"laya.d3.core.Camera",u$Uj);var u$j=u$O.prototype;return u$j._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},u$j._parseCustomProps=function(u$W,u$j,u$t,u$d){var u$b=u$t.clearColor;this.clearColor=new u$qj(u$b[0],u$b[1],u$b[2],u$b[3]);var u$E=u$t.viewport;this.normalizedViewport=new u$Aj(u$E[0],u$E[1],u$E[2],u$E[3])},u$j._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var u$W=this.orthographicVerticalSize*this.aspectRatio*.5,u$j=.5*this.orthographicVerticalSize;u$Wj.createOrthoOffCenterRH(-u$W,u$W,-u$j,u$j,this.nearPlane,this.farPlane,this._projectionMatrix)}else u$Wj.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},u$j._update=function(u$W){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,u$W)},u$j._renderCamera=function(u$W,u$j,u$t){var u$d,u$b;u$t.parallelSplitShadowMaps[0]&&u$t._renderShadowMap(u$W,u$j,this),(u$j.camera=this)._prepareCameraToRender(),u$t._preRenderUpdateComponents(u$j),u$d=u$j._viewMatrix=this.viewMatrix;var u$E=this._renderTarget;u$E?(u$E.start(),u$Wj.multiply(u$Uj._invertYScaleMatrix,this._projectionMatrix,u$Uj._invertYProjectionMatrix),u$Wj.multiply(u$Uj._invertYScaleMatrix,this.projectionViewMatrix,u$Uj._invertYProjectionViewMatrix),u$b=u$j._projectionMatrix=u$Uj._invertYProjectionMatrix,u$j._projectionViewMatrix=u$Uj._invertYProjectionViewMatrix):(u$b=u$j._projectionMatrix=this._projectionMatrix,u$j._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(u$d,u$b),u$j._viewport=this.viewport,u$t._preRenderScene(u$W,u$j,this.boundFrustum),u$t._clear(u$W,u$j),u$t._renderScene(u$W,u$j),u$t._postRenderUpdateComponents(u$j),u$E&&u$E.end()},u$j.viewportPointToRay=function(u$W,u$j){u$$j.calculateCursorRay(u$W,this.viewport,this._projectionMatrix,this.viewMatrix,null,u$j)},u$j.normalizedViewportPointToRay=function(u$W,u$j){var u$t=u$O._tempVector20,u$d=this.viewport,u$b=u$W.elements,u$E=u$t.elements;u$E[0]=u$b[0]*u$d.width,u$E[1]=u$b[1]*u$d.height,u$$j.calculateCursorRay(u$t,this.viewport,this._projectionMatrix,this.viewMatrix,null,u$j)},u$j.worldToViewportPoint=function(u$W,u$j){u$Wj.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(u$W,this._projectionViewMatrix,u$j);var u$t=u$j.elements;u$t[0]=u$t[0]/u$X.stage.clientScaleX,u$t[1]=u$t[1]/u$X.stage.clientScaleY},u$j.worldToNormalizedViewportPoint=function(u$W,u$j){u$Wj.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(u$W,this._projectionViewMatrix,u$j);var u$t=u$j.elements;u$t[0]=u$t[0]/u$X.stage.clientScaleX,u$t[1]=u$t[1]/u$X.stage.clientScaleY},u$j.convertScreenCoordToOrthographicCoord=function(u$W,u$j){if(this._orthographic){var u$t=u$i.clientWidth,u$d=u$i.clientHeight,u$b=this.orthographicVerticalSize*this.aspectRatio/u$t,u$E=this.orthographicVerticalSize/u$d,u$O=u$W.elements,u$q=u$j.elements;return u$q[0]=(-u$t/2+u$O[0])*u$b,u$q[1]=(u$d/2-u$O[1])*u$E,u$q[2]=(this.nearPlane-this.farPlane)*(u$O[2]+1)/2-this.nearPlane,u$Oj.transformCoordinate(u$j,this.transform.worldMatrix,u$j),!0}return!1},u$$(0,u$j,"projectionViewMatrix",function(){return u$Wj.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),u$$(0,u$j,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var u$W=this.viewport;return u$W.width/u$W.height},function(u$W){if(u$W<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=u$W,this._calculateProjectionMatrix()}),u$$(0,u$j,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),u$$(0,u$j,"needViewport",function(){var u$W=this.normalizedViewport;return 0===u$W.x&&0===u$W.y&&1===u$W.width&&1===u$W.height}),u$$(0,u$j,"viewport",function(){if(this._viewportExpressedInClipSpace){var u$W=this._normalizedViewport,u$j=this.renderTargetSize,u$t=u$j.width,u$d=u$j.height;this._viewport.x=u$W.x*u$t,this._viewport.y=u$W.y*u$d,this._viewport.width=u$W.width*u$t,this._viewport.height=u$W.height*u$d}return this._viewport},function(u$W){if(null!=this.renderTarget&&(u$W.x<0||u$W.y<0||0==u$W.width||0==u$W.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=u$W,this._calculateProjectionMatrix()}),u$$(0,u$j,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var u$W=this._viewport,u$j=this.renderTargetSize,u$t=u$j.width,u$d=u$j.height;this._normalizedViewport.x=u$W.x/u$t,this._normalizedViewport.y=u$W.y/u$d,this._normalizedViewport.width=u$W.width/u$t,this._normalizedViewport.height=u$W.height/u$d}return this._normalizedViewport},function(u$W){u$W.x<0&&(u$W.x=0,console.warn("Camera: viewport.x must large than 0.0.")),u$W.y<0&&(u$W.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<u$W.x+u$W.width&&(u$W.width=1-u$W.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<u$W.y+u$W.height&&(u$W.height=1-u$W.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=u$W,this._calculateProjectionMatrix()}),u$$(0,u$j,"projectionMatrix",function(){return this._projectionMatrix},function(u$W){this._projectionMatrix=u$W,this._useUserProjectionMatrix=!0}),u$$(0,u$j,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),u$m(u$O,["_tempVector20",function(){return this._tempVector20=new u$Ej}]),u$O}()),u$Pj=function(u$t){function u$d(u$W,u$j){u$d.__super.call(this,u$j),this._geometryFilter=new u$hj(this),this._render=new u$vj(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),u$W&&(this._geometryFilter.sharedMesh=u$W)instanceof laya.d3.resource.models.Mesh&&(u$W.loaded?this._render.sharedMaterials=u$W.materials:u$W.once("loaded",this,this._applyMeshMaterials))}u$T(u$d,"laya.d3.core.MeshSprite3D",u$t);var u$W=u$d.prototype;return u$W._changeRenderObjectByMesh=function(u$W){var u$j=this._render._renderElements,u$t=u$j[u$W];u$t||(u$t=u$j[u$W]=new u$Nj),u$t._render=this._render;var u$d=this._render.sharedMaterials[u$W];u$d||(u$d=u$Dj.defaultMaterial);var u$b=this._geometryFilter.sharedMesh.getRenderElement(u$W);return u$t._mainSortID=this._getSortID(u$b,u$d),u$t._sprite3D=this,u$t.renderObj=u$b,u$t._material=u$d,u$t},u$W._changeRenderObjectByMaterial=function(u$W,u$j){var u$t=this._render._renderElements[u$W];u$j||(u$j=u$Dj.defaultMaterial);var u$d=this._geometryFilter.sharedMesh.getRenderElement(u$W);return u$t._mainSortID=this._getSortID(u$d,u$j),u$t._sprite3D=this,u$t.renderObj=u$d,u$t._material=u$j,u$t},u$W._changeRenderObjectsByMesh=function(){var u$W=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=u$W;for(var u$j=0;u$j<u$W;u$j++)this._changeRenderObjectByMesh(u$j)},u$W._onMeshChanged=function(u$W){var u$j=u$W.sharedMesh;u$j.loaded?this._changeRenderObjectsByMesh():u$j.once("loaded",this,this._onMeshLoaded)},u$W._onMeshLoaded=function(u$W){u$W===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},u$W._onMaterialChanged=function(u$W,u$j,u$t){u$j<this._render._renderElements.length&&this._changeRenderObjectByMaterial(u$j,u$t)},u$W._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},u$W._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},u$W._parseCustomProps=function(u$W,u$j,u$t,u$d){var u$b=this.meshRender,u$E=u$t.lightmapIndex;null!=u$E&&(u$b.lightmapIndex=u$E);var u$O,u$q,u$A=u$t.lightmapScaleOffset;if(u$A&&(u$b.lightmapScaleOffset=new u$qj(u$A[0],u$A[1],u$A[2],u$A[3])),u$d.instanceParams)(u$O=u$d.instanceParams.loadPath)&&(u$q=u$o.getRes(u$j[u$O]),(this.meshFilter.sharedMesh=u$q).loaded?u$b.sharedMaterials=u$q.materials:u$q.once("loaded",this,this._applyMeshMaterials));else{(u$O=u$t.meshPath)&&(u$q=u$o.getRes(u$j[u$O]),this.meshFilter.sharedMesh=u$q);var u$c=u$t.materials;if(u$c){var u$R=u$b.sharedMaterials,u$m=u$c.length;u$R.length=u$m;for(var u$Q=0;u$Q<u$m;u$Q++)u$R[u$Q]=u$o.getRes(u$j[u$c[u$Q].path]);u$b.sharedMaterials=u$R}}},u$W._applyMeshMaterials=function(u$W){for(var u$j=this._render.sharedMaterials,u$t=u$W.materials,u$d=0,u$b=u$t.length;u$d<u$b;u$d++)u$j[u$d]||(u$j[u$d]=u$t[u$d]);this._render.sharedMaterials=u$j},u$W._addToInitStaticBatchManager=function(){u$d._staticBatchManager._addInitBatchSprite(this)},u$W.cloneTo=function(u$W){var u$j=u$W;u$j._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var u$t=this._render,u$d=u$j._render;u$d.enable=u$t.enable,u$d.sharedMaterials=u$t.sharedMaterials,u$d.castShadow=u$t.castShadow;var u$b=u$t.lightmapScaleOffset;u$b&&(u$d.lightmapScaleOffset=u$b.clone()),u$d.lightmapIndex=u$t.lightmapIndex,u$d.receiveShadow=u$t.receiveShadow,u$d.sortingFudge=u$t.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,u$W)},u$W.destroy=function(u$W){if(void 0===u$W&&(u$W=!0),!this.destroyed){var u$j=this.meshFilter.sharedMesh;null!=u$j&&(u$j.loaded||u$j.off("loaded",this,this._applyMeshMaterials)),u$t.prototype.destroy.call(this,u$W),this._geometryFilter._destroy()}},u$$(0,u$W,"meshFilter",function(){return this._geometryFilter}),u$$(0,u$W,"meshRender",function(){return this._render}),u$d.__init__=function(){u$dW._staticBatchManagers.push(u$d._staticBatchManager)},u$d.load=function(u$W){return u$X.loader.create(u$W,null,null,u$d)},u$m(u$d,["_staticBatchManager",function(){return this._staticBatchManager=new u$Cj}]),u$d}(u$Jj)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(u$W,u$j){"use strict";for(var u$t in Object.defineProperty(u$j,"__esModule",{value:!0}),Laya){var u$d=Laya[u$t];u$d&&u$d.__isclass&&(u$j[u$t]=u$d)}}),function(u$W,u$j,u$bW){u$bW.un,u$bW.uns;var u$t=u$bW.static,u$d=u$bW.class,u$E=u$bW.getset,u$e=u$bW.__newvec,u$q=laya.maths.Bezier,u$m=laya.utils.Browser,u$GW=laya.utils.Byte,u$b=(laya.events.Event,laya.events.EventDispatcher),u$O=laya.display.Graphics,u$A=(laya.resource.HTMLCanvas,laya.utils.Handler),u$c=laya.net.Loader,u$Q=laya.maths.MathUtil,u$lW=laya.maths.Matrix,u$K=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),u$R=(laya.renders.RenderContext,laya.resource.Resource),u$T=laya.utils.RunDriver,u$EW=laya.display.Sprite,u$$=laya.utils.Stat,u$hW=laya.resource.Texture,u$o=(laya.net.URL,laya.utils.Utils),u$l=function(){function u$W(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return u$d(u$W,"laya.ani.AnimationContent"),u$W}(),u$h=function(){function u$W(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return u$d(u$W,"laya.ani.AnimationNodeContent"),u$W}(),u$M=function(){function u$W(){}return u$d(u$W,"laya.ani.AnimationParser01"),u$W.parse=function(u$W,u$j){var u$t=u$j.__getBuffer(),u$d=0,u$b=0,u$E=0,u$O=0,u$q=0,u$A=0,u$c=0,u$R=u$j.readUTFString();u$W._aniClassName=u$R;var u$m,u$Q=u$j.readUTFString().split("\n"),u$T=u$j.getUint8(),u$$=u$j.getUint32(),u$e=u$j.getUint32();0<u$$&&(u$m=u$t.slice(u$$,u$e));var u$K=new u$GW(u$m);for(0<u$e&&(u$W._publicExtData=u$t.slice(u$e,u$t.byteLength)),u$W._useParent=!!u$j.getUint8(),u$W._anis.length=u$T,u$d=0;u$d<u$T;u$d++){var u$o=u$W._anis[u$d]=new u$l;u$o.nodes=new Array;var u$S=u$o.name=u$Q[u$j.getUint16()];u$W._aniMap[u$S]=u$d,u$o.bone3DMap={},u$o.playTime=u$j.getFloat32(),u$o.playTime<=0&&console.error("播放时间不能为0  url="+u$W.url+" name="+u$o.name);var u$M=u$o.nodes.length=u$j.getUint8();for(u$b=u$o.totalKeyframeDatasLength=0;u$b<u$M;u$b++){var u$Z=u$o.nodes[u$b]=new u$h;u$Z.childs=[];var u$X=u$j.getInt16();0<=u$X&&(u$Z.name=u$Q[u$X],u$o.bone3DMap[u$Z.name]=u$b),u$Z.keyFrame=new Array,u$Z.parentIndex=u$j.getInt16(),-1==u$Z.parentIndex?u$Z.parent=null:u$Z.parent=u$o.nodes[u$Z.parentIndex],u$Z.lerpType=u$j.getUint8();var u$_=u$j.getUint32();u$K.pos=u$_;var u$N=u$Z.keyframeWidth=u$K.getUint16();if(u$o.totalKeyframeDatasLength+=u$N,0===u$Z.lerpType||1===u$Z.lerpType)for(u$Z.interpolationMethod=[],u$Z.interpolationMethod.length=u$N,u$E=0;u$E<u$N;u$E++)u$Z.interpolationMethod[u$E]=u$a.interpolation[u$K.getUint8()];null!=u$Z.parent&&u$Z.parent.childs.push(u$Z);var u$z=u$j.getUint16();0<u$z&&(u$Z.extenData=u$t.slice(u$j.pos,u$j.pos+u$z),u$j.pos+=u$z);var u$C,u$L=u$j.getUint16(),u$V=0;for(u$E=0,u$O=u$Z.keyFrame.length=u$L;u$E<u$O;u$E++){if((u$C=u$Z.keyFrame[u$E]=new u$v).duration=u$j.getFloat32(),u$C.startTime=u$V,2===u$Z.lerpType){u$C.interpolationData=[];var u$x,u$G=u$j.getUint8();switch(u$x=u$j.getFloat32()){case 254:for(u$C.interpolationData.length=u$N,u$c=0;u$c<u$N;u$c++)u$C.interpolationData[u$c]=0;break;case 255:for(u$C.interpolationData.length=u$N,u$c=0;u$c<u$N;u$c++)u$C.interpolationData[u$c]=5;break;default:for(u$C.interpolationData.push(u$x),u$A=1;u$A<u$G;u$A++)u$C.interpolationData.push(u$j.getFloat32())}}for(u$C.data=new Float32Array(u$N),u$q=0;u$q<u$N;u$q++)u$C.data[u$q]=u$j.getFloat32(),-1e-8<u$C.data[u$q]&&u$C.data[u$q]<1e-8&&(u$C.data[u$q]=0);u$V+=u$C.duration}u$C.startTime=u$o.playTime,u$Z.playTime=u$o.playTime,u$W._calculateKeyFrame(u$Z,u$L,u$N)}}},u$W}(),u$Z=function(){function u$X(){}return u$d(u$X,"laya.ani.AnimationParser02"),u$X.READ_DATA=function(){u$X._DATA.offset=u$X._reader.getUint32(),u$X._DATA.size=u$X._reader.getUint32()},u$X.READ_BLOCK=function(){for(var u$W=u$X._BLOCK.count=u$X._reader.getUint16(),u$j=u$X._BLOCK.blockStarts=[],u$t=u$X._BLOCK.blockLengths=[],u$d=0;u$d<u$W;u$d++)u$j.push(u$X._reader.getUint32()),u$t.push(u$X._reader.getUint32())},u$X.READ_STRINGS=function(){var u$W=u$X._reader.getUint32(),u$j=u$X._reader.getUint16(),u$t=u$X._reader.pos;u$X._reader.pos=u$W+u$X._DATA.offset;for(var u$d=0;u$d<u$j;u$d++)u$X._strings[u$d]=u$X._reader.readUTFString();u$X._reader.pos=u$t},u$X.parse=function(u$W,u$j){u$X._templet=u$W;(u$X._reader=u$j).__getBuffer();u$X.READ_DATA(),u$X.READ_BLOCK(),u$X.READ_STRINGS();for(var u$t=0,u$d=u$X._BLOCK.count;u$t<u$d;u$t++){var u$b=u$j.getUint16(),u$E=u$X._strings[u$b],u$O=u$X["READ_"+u$E];if(null==u$O)throw new Error("model file err,no this function:"+u$b+" "+u$E);u$O.call()}},u$X.READ_ANIMATIONS=function(){var u$W=u$X._reader,u$j=u$W.__getBuffer(),u$t=0,u$d=0,u$b=0,u$E=0,u$O=u$W.getUint16(),u$q=[];for(u$q.length=u$O,u$t=0;u$t<u$O;u$t++)u$q[u$t]=u$a.interpolation[u$W.getByte()];var u$A=u$W.getUint8();for(u$X._templet._anis.length=u$A,u$t=0;u$t<u$A;u$t++){var u$c=u$X._templet._anis[u$t]={};u$c.nodes=new Array;var u$R=u$c.name=u$X._strings[u$W.getUint16()];u$X._templet._aniMap[u$R]=u$t,u$c.bone3DMap={},u$c.playTime=u$W.getFloat32();var u$m=u$c.nodes.length=u$W.getInt16();for(u$d=u$c.totalKeyframeDatasLength=0;u$d<u$m;u$d++){var u$Q=u$c.nodes[u$d]={};u$Q.keyframeWidth=u$O,u$Q.childs=[];var u$T=u$W.getUint16();0<=u$T&&(u$Q.name=u$X._strings[u$T],u$c.bone3DMap[u$Q.name]=u$d),u$Q.keyFrame=new Array,u$Q.parentIndex=u$W.getInt16(),-1==u$Q.parentIndex?u$Q.parent=null:u$Q.parent=u$c.nodes[u$Q.parentIndex],u$c.totalKeyframeDatasLength+=u$O,u$Q.interpolationMethod=u$q,null!=u$Q.parent&&u$Q.parent.childs.push(u$Q);var u$$=u$W.getUint16(),u$e=null,u$K=null;for(u$b=0,u$E=u$Q.keyFrame.length=u$$;u$b<u$E;u$b++){(u$e=u$Q.keyFrame[u$b]={}).startTime=u$W.getFloat32(),u$K&&(u$K.duration=u$e.startTime-u$K.startTime);var u$o=u$X._DATA.offset,u$S=u$W.getUint32(),u$M=4*u$O,u$Z=u$j.slice(u$o+u$S,u$o+u$S+u$M);u$e.data=new Float32Array(u$Z),u$K=u$e}u$e.duration=0,u$Q.playTime=u$c.playTime,u$X._templet._calculateKeyFrame(u$Q,u$$,u$O)}}},u$X._templet=null,u$X._reader=null,u$X._strings=[],u$t(u$X,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),u$X}(),u$vW=(function(){function u$W(){}u$d(u$W,"laya.ani.AnimationState"),u$W.stopped=0,u$W.paused=1,u$W.playing=2}(),function(){function u$b(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new u$JW,this.resultMatrix=new u$lW,this._children=[]}u$d(u$b,"laya.ani.bone.Bone");var u$W=u$b.prototype;return u$W.setTempMatrix=function(u$W){this._tempMatrix=u$W;var u$j,u$t=0;for(u$t=0,u$j=this._children.length;u$t<u$j;u$t++)this._children[u$t].setTempMatrix(this._tempMatrix)},u$W.update=function(u$W){var u$j;if(this.rotation=this.transform.skX,u$W)u$j=this.resultTransform.getMatrix(),u$lW.mul(u$j,u$W,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)u$j=this.resultTransform.getMatrix(),u$lW.mul(u$j,this.parentBone.resultMatrix,this.resultMatrix);else{var u$t=this.parentBone,u$d=NaN,u$b=NaN,u$E=NaN,u$O=this.parentBone.resultMatrix;u$j=this.resultTransform.getMatrix();var u$q=u$O.a*u$j.tx+u$O.c*u$j.ty+u$O.tx,u$A=u$O.b*u$j.tx+u$O.d*u$j.ty+u$O.ty,u$c=new u$lW;this.inheritRotation?(u$d=Math.atan2(u$t.resultMatrix.b,u$t.resultMatrix.a),u$b=Math.cos(u$d),u$E=Math.sin(u$d),u$c.setTo(u$b,u$E,-u$E,u$b,0,0),u$lW.mul(this._tempMatrix,u$c,u$lW.TEMP),u$lW.TEMP.copyTo(u$c),u$j=this.resultTransform.getMatrix(),u$lW.mul(u$j,u$c,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,u$j=this.resultTransform.getMatrix(),u$lW.TEMP.identity(),u$lW.TEMP.d=this.d,u$lW.mul(u$j,u$lW.TEMP,this.resultMatrix)),this.resultMatrix.tx=u$q,this.resultMatrix.ty=u$A}else(u$j=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var u$R,u$m=0;for(u$m=0,u$R=this._children.length;u$m<u$R;u$m++)this._children[u$m].update()},u$W.updateChild=function(){var u$W,u$j=0;for(u$j=0,u$W=this._children.length;u$j<u$W;u$j++)this._children[u$j].update()},u$W.setRotation=function(u$W){this._sprite&&(this._sprite.rotation=180*u$W/Math.PI)},u$W.updateDraw=function(u$W,u$j){u$b.ShowBones&&!u$b.ShowBones[this.name]||(this._sprite||(this._sprite=new u$EW,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),u$bW.stage.addChild(this._sprite)),this._sprite.x=u$W+this.resultMatrix.tx,this._sprite.y=u$j+this.resultMatrix.ty);var u$t,u$d=0;for(u$d=0,u$t=this._children.length;u$d<u$t;u$d++)this._children[u$d].updateDraw(u$W,u$j)},u$W.addChild=function(u$W){this._children.push(u$W),u$W.parentBone=this},u$W.findBone=function(u$W){if(this.name==u$W)return this;var u$j,u$t,u$d=0;for(u$d=0,u$j=this._children.length;u$d<u$j;u$d++)if(u$t=this._children[u$d].findBone(u$W))return u$t;return null},u$W.localToWorld=function(u$W){var u$j=u$W[0],u$t=u$W[1];u$W[0]=u$j*this.resultMatrix.a+u$t*this.resultMatrix.c+this.resultMatrix.tx,u$W[1]=u$j*this.resultMatrix.b+u$t*this.resultMatrix.d+this.resultMatrix.ty},u$b.ShowBones={},u$b}()),u$yW=function(){function u$e(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}u$d(u$e,"laya.ani.bone.BoneSlot");var u$W=u$e.prototype;return u$W.showSlotData=function(u$W,u$j){void 0===u$j&&(u$j=!0),this.currSlotData=u$W,u$j&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},u$W.showDisplayByName=function(u$W){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(u$W))},u$W.replaceDisplayByName=function(u$W,u$j){if(this.currSlotData){var u$t;u$t=this.currSlotData.getDisplayByName(u$W);var u$d;u$d=this.currSlotData.getDisplayByName(u$j),this.replaceDisplayByIndex(u$t,u$d)}},u$W.replaceDisplayByIndex=function(u$W,u$j){this.currSlotData&&(this._replaceDic[u$W]=u$j,this.displayIndex==u$W&&this.showDisplayByIndex(u$W))},u$W.showDisplayByIndex=function(u$W){if(null!=this._replaceDic[u$W]&&(u$W=this._replaceDic[u$W]),this.currSlotData&&-1<u$W&&u$W<this.currSlotData.displayArr.length){if(this.displayIndex=u$W,this.currDisplayData=this.currSlotData.displayArr[u$W],this.currDisplayData){var u$j=this.currDisplayData.name;this.currTexture=this.templet.getTexture(u$j),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!u$K.isConchApp||u$K.isConchApp&&"0.9.15"<u$EW.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},u$W.replaceSkin=function(u$W){this._diyTexture=u$W,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},u$W.setParentMatrix=function(u$W){this._parentMatrix=u$W},u$W.draw=function(u$W,u$j,u$t,u$d){if(void 0===u$t&&(u$t=!1),void 0===u$d&&(u$d=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var u$b,u$E=this.currTexture;switch(this._diyTexture&&(u$E=this._diyTexture),this.currDisplayData.type){case 0:if(u$W){var u$O=this.getDisplayMatrix();if(this._parentMatrix){var u$q=!1;if(u$O){var u$A;if(u$lW.mul(u$O,this._parentMatrix,u$lW.TEMP),u$A=u$t?(null==this._resultMatrix&&(this._resultMatrix=new u$lW),this._resultMatrix):new u$lW,!u$K.isWebGL&&this.currDisplayData.uvs||u$K.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var u$c=u$e._tempMatrix;u$c.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(u$c.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(u$q=!0,u$c.rotate(-Math.PI/2)),u$lW.mul(u$c,u$lW.TEMP,u$A)}else u$lW.TEMP.copyTo(u$A);u$q?u$W.drawTexture(u$E,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,u$A):u$W.drawTexture(u$E,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,u$A)}}}break;case 1:if(null==(u$b=u$t?(null==this._skinSprite&&(this._skinSprite=u$e.createSkinMesh()),this._skinSprite):u$e.createSkinMesh()))return;var u$R;if(null==this.currDisplayData.bones){var u$m,u$Q=this.currDisplayData.weights;this.deformData&&(u$Q=this.deformData),u$m=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=u$N.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=u$N.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=u$Q;this.currDisplayData.triangles.length;u$R=this.currDisplayData.triangles,u$b.init2(u$E,null,u$R,this._mVerticleArr,u$m);var u$T,u$$=this.getDisplayMatrix();if(this._parentMatrix)if(u$$)u$lW.mul(u$$,this._parentMatrix,u$lW.TEMP),u$T=u$t?(null==this._resultMatrix&&(this._resultMatrix=new u$lW),this._resultMatrix):new u$lW,u$lW.TEMP.copyTo(u$T),u$b.transform=u$T}else this.skinMesh(u$j,u$b,u$d);u$W.drawSkin(u$b);break;case 2:if(null==(u$b=u$t?(null==this._skinSprite&&(this._skinSprite=u$e.createSkinMesh()),this._skinSprite):u$e.createSkinMesh()))return;this.skinMesh(u$j,u$b,u$d),u$W.drawSkin(u$b)}}},u$W.skinMesh=function(u$W,u$j,u$t){var u$d,u$b=this.currTexture,u$E=this.currDisplayData.bones;u$d=this._diyTexture?(u$b=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=u$N.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=u$N.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var u$O,u$q,u$A=this.currDisplayData.weights,u$c=this.currDisplayData.triangles,u$R=0,u$m=0,u$Q=0,u$T=NaN,u$$=NaN,u$e=0,u$K=0,u$o=[],u$S=0,u$M=0;if(this.deformData&&0<this.deformData.length){var u$Z=0;for(u$S=0,u$M=u$E.length;u$S<u$M;){for(u$Q=u$E[u$S++]+u$S,u$m=u$R=0;u$S<u$Q;u$S++)u$q=u$W[u$E[u$S]],u$T=u$A[u$e]+this.deformData[u$Z++],u$$=u$A[u$e+1]+this.deformData[u$Z++],u$K=u$A[u$e+2],u$R+=(u$T*u$q.a+u$$*u$q.c+u$q.tx)*u$K,u$m+=(u$T*u$q.b+u$$*u$q.d+u$q.ty)*u$K,u$e+=3;u$o.push(u$R,u$m)}}else for(u$S=0,u$M=u$E.length;u$S<u$M;){for(u$Q=u$E[u$S++]+u$S,u$m=u$R=0;u$S<u$Q;u$S++)u$q=u$W[u$E[u$S]],u$T=u$A[u$e],u$$=u$A[u$e+1],u$K=u$A[u$e+2],u$R+=(u$T*u$q.a+u$$*u$q.c+u$q.tx)*u$K,u$m+=(u$T*u$q.b+u$$*u$q.d+u$q.ty)*u$K,u$e+=3;u$o.push(u$R,u$m)}this._mVerticleArr=u$o,u$O=u$c,u$j.init2(u$b,null,u$O,this._mVerticleArr,u$d)},u$W.drawBonePoint=function(u$W){u$W&&this._parentMatrix&&u$W.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},u$W.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},u$W.getMatrix=function(){return this._resultMatrix},u$W.copy=function(){var u$W=new u$e;return u$W.type="copy",u$W.name=this.name,u$W.attachmentName=this.attachmentName,u$W.srcDisplayIndex=this.srcDisplayIndex,u$W.parent=this.parent,u$W.displayIndex=this.displayIndex,u$W.templet=this.templet,u$W.currSlotData=this.currSlotData,u$W.currTexture=this.currTexture,u$W.currDisplayData=this.currDisplayData,u$W},u$e.createSkinMesh=function(){return u$K.isWebGL||u$K.isConchApp?u$T.skinAniSprite():(u$K.isWebGL,null)},u$t(u$e,["_tempMatrix",function(){return this._tempMatrix=new u$lW}]),u$e}(),u$aW=function(){function u$W(){this.skinName=null,this.deformSlotDataList=[]}return u$d(u$W,"laya.ani.bone.DeformAniData"),u$W}(),u$uW=function(){function u$W(){this.deformSlotDisplayList=[]}return u$d(u$W,"laya.ani.bone.DeformSlotData"),u$W}(),u$DW=function(){function u$W(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}u$d(u$W,"laya.ani.bone.DeformSlotDisplayData");var u$j=u$W.prototype;return u$j.binarySearch1=function(u$W,u$j){var u$t=0,u$d=u$W.length-2;if(0==u$d)return 1;for(var u$b=u$d>>>1;;){if(u$W[Math.floor(u$b+1)]<=u$j?u$t=u$b+1:u$d=u$b,u$t==u$d)return u$t+1;u$b=u$t+u$d>>>1}return 0},u$j.apply=function(u$W,u$j,u$t){if(void 0===u$t&&(u$t=1),u$W+=.05,!(this.timeList.length<=0)){var u$d=0;if(!(u$W<this.timeList[0])){var u$b=this.vectices[0].length,u$E=[],u$O=this.binarySearch1(this.timeList,u$W);if(this.frameIndex=u$O,u$W>=this.timeList[this.timeList.length-1]){var u$q=this.vectices[this.vectices.length-1];if(u$t<1)for(u$d=0;u$d<u$b;u$d++)u$E[u$d]+=(u$q[u$d]-u$E[u$d])*u$t;else for(u$d=0;u$d<u$b;u$d++)u$E[u$d]=u$q[u$d];this.deformData=u$E}else{this.tweenKeyList[this.frameIndex];var u$A=this.vectices[this.frameIndex-1],u$c=this.vectices[this.frameIndex],u$R=this.timeList[this.frameIndex-1],u$m=this.timeList[this.frameIndex];u$t=this.tweenKeyList[u$O-1]?(u$W-u$R)/(u$m-u$R):0;var u$Q=NaN;for(u$d=0;u$d<u$b;u$d++)u$Q=u$A[u$d],u$E[u$d]=u$Q+(u$c[u$d]-u$Q)*u$t;this.deformData=u$E}}}},u$W}(),u$sW=function(){function u$W(){this.time=NaN,this.drawOrder=[]}return u$d(u$W,"laya.ani.bone.DrawOrderData"),u$W}(),u$YW=function(){function u$W(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return u$d(u$W,"laya.ani.bone.EventData"),u$W}(),u$S=function(){function u$dW(u$W,u$j){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=u$W,this._targetBone=u$j[u$W.targetBoneIndex],this.isSpine=u$W.isSpine,null==this._bones&&(this._bones=[]);for(var u$t=this._bones.length=0,u$d=u$W.boneIndexs.length;u$t<u$d;u$t++)this._bones.push(u$j[u$W.boneIndexs[u$t]]);this.name=u$W.name,this.mix=u$W.mix,this.bendDirection=u$W.bendDirection}u$d(u$dW,"laya.ani.bone.IkConstraint");var u$W=u$dW.prototype;return u$W.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},u$W._applyIk1=function(u$W,u$j,u$t,u$d){var u$b=u$W.parentBone,u$E=1/(u$b.resultMatrix.a*u$b.resultMatrix.d-u$b.resultMatrix.b*u$b.resultMatrix.c),u$O=u$j-u$b.resultMatrix.tx,u$q=u$t-u$b.resultMatrix.ty,u$A=(u$O*u$b.resultMatrix.d-u$q*u$b.resultMatrix.c)*u$E-u$W.transform.x,u$c=(u$q*u$b.resultMatrix.a-u$O*u$b.resultMatrix.b)*u$E-u$W.transform.y,u$R=Math.atan2(u$c,u$A)*u$dW.radDeg-0-u$W.transform.skX;u$W.transform.scX<0&&(u$R+=180),180<u$R?u$R-=360:u$R<-180&&(u$R+=360),u$W.transform.skX=u$W.transform.skY=u$W.transform.skX+u$R*u$d,u$W.update()},u$W.updatePos=function(u$W,u$j){this._sp&&this._sp.pos(u$W,u$j)},u$W._applyIk2=function(u$W,u$j,u$t,u$d,u$b,u$E){if(0!=u$E){var u$O=u$W.resultTransform.x,u$q=u$W.resultTransform.y,u$A=u$W.transform.scX,u$c=u$W.transform.scY,u$R=u$j.transform.scX,u$m=0,u$Q=0,u$T=0;u$T=u$A<0?(u$A=-u$A,u$m=180,-1):(u$m=0,1),u$c<0&&(u$c=-u$c,u$T=-u$T),u$Q=u$R<0?(u$R=-u$R,180):0;var u$$=u$j.resultTransform.x,u$e=NaN,u$K=NaN,u$o=NaN,u$S=u$W.resultMatrix.a,u$M=u$W.resultMatrix.c,u$Z=u$W.resultMatrix.b,u$X=u$W.resultMatrix.d,u$_=Math.abs(u$A-u$c)<=1e-4;u$o=u$_?(u$K=u$S*u$$+u$M*(u$e=u$j.resultTransform.y)+u$W.resultMatrix.tx,u$Z*u$$+u$X*u$e+u$W.resultMatrix.ty):(u$e=0,u$K=u$S*u$$+u$W.resultMatrix.tx,u$Z*u$$+u$W.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new u$EW,u$bW.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(u$t,u$d,15,"#ffff00"),this._sp.graphics.drawCircle(u$K,u$o,15,"#ff00ff")),u$W.setRotation(Math.atan2(u$o-u$W.resultMatrix.ty,u$K-u$W.resultMatrix.tx));var u$N=u$W.parentBone;u$S=u$N.resultMatrix.a,u$M=u$N.resultMatrix.c,u$Z=u$N.resultMatrix.b;var u$z=1/(u$S*(u$X=u$N.resultMatrix.d)-u$M*u$Z),u$C=u$t-u$N.resultMatrix.tx,u$L=u$d-u$N.resultMatrix.ty,u$V=(u$C*u$X-u$L*u$M)*u$z-u$O,u$x=(u$L*u$S-u$C*u$Z)*u$z-u$q,u$G=((u$C=u$K-u$N.resultMatrix.tx)*u$X-(u$L=u$o-u$N.resultMatrix.ty)*u$M)*u$z-u$O,u$l=(u$L*u$S-u$C*u$Z)*u$z-u$q,u$h=Math.sqrt(u$G*u$G+u$l*u$l),u$v=u$j.length*u$R,u$y=NaN,u$a=NaN;if(u$_){var u$u=(u$V*u$V+u$x*u$x-u$h*u$h-(u$v*=u$A)*u$v)/(2*u$h*u$v);u$u<-1?u$u=-1:1<u$u&&(u$u=1),u$a=Math.acos(u$u)*u$b,u$S=u$h+u$v*u$u,u$M=u$v*Math.sin(u$a),u$y=Math.atan2(u$x*u$S-u$V*u$M,u$V*u$S+u$x*u$M)}else{var u$D=(u$S=u$A*u$v)*u$S,u$s=(u$M=u$c*u$v)*u$M,u$Y=u$V*u$V+u$x*u$x,u$H=Math.atan2(u$x,u$V),u$I=-2*u$s*u$h,u$g=u$s-u$D;if(0<(u$X=u$I*u$I-4*u$g*(u$Z=u$s*u$h*u$h+u$D*u$Y-u$D*u$s))){var u$f=Math.sqrt(u$X);u$I<0&&(u$f=-u$f);var u$w=(u$f=-(u$I+u$f)/2)/u$g,u$U=u$Z/u$f,u$J=Math.abs(u$w)<Math.abs(u$U)?u$w:u$U;u$J*u$J<=u$Y&&(u$L=Math.sqrt(u$Y-u$J*u$J)*u$b,u$y=u$H-Math.atan2(u$L,u$J),u$a=Math.atan2(u$L/u$c,(u$J-u$h)/u$A))}var u$r=0,u$P=Number.MAX_VALUE,u$i=0,u$B=0,u$n=0,u$k=0,u$p=0,u$F=0;u$k<(u$X=(u$C=u$h+u$S)*u$C)&&(u$n=0,u$k=u$X,u$p=u$C),(u$X=(u$C=u$h-u$S)*u$C)<u$P&&(u$r=Math.PI,u$P=u$X,u$i=u$C);var u$WW=Math.acos(-u$S*u$h/(u$D-u$s));(u$X=(u$C=u$S*Math.cos(u$WW)+u$h)*u$C+(u$L=u$M*Math.sin(u$WW))*u$L)<u$P&&(u$r=u$WW,u$P=u$X,u$i=u$C,u$B=u$L),u$k<u$X&&(u$n=u$WW,u$k=u$X,u$p=u$C,u$F=u$L),u$a=u$Y<=(u$P+u$k)/2?(u$y=u$H-Math.atan2(u$B*u$b,u$i),u$r*u$b):(u$y=u$H-Math.atan2(u$F*u$b,u$p),u$n*u$b)}var u$jW=Math.atan2(u$e,u$$)*u$T,u$tW=u$W.resultTransform.skX;180<(u$y=(u$y-u$jW)*u$dW.radDeg+u$m-u$tW)?u$y-=360:u$y<-180&&(u$y+=360),u$W.resultTransform.x=u$O,u$W.resultTransform.y=u$q,u$W.resultTransform.skX=u$W.resultTransform.skY=u$tW+u$y*u$E,u$tW=u$j.resultTransform.skX,180<(u$a=((u$a+u$jW)*u$dW.radDeg-0)*u$T+u$Q-(u$tW%=360))?u$a-=360:u$a<-180&&(u$a+=360),u$j.resultTransform.x=u$$,u$j.resultTransform.y=u$e,u$j.resultTransform.skX=u$j.resultTransform.skY=u$j.resultTransform.skY+u$a*u$E,u$W.update()}},u$W._applyIk3=function(u$W,u$j,u$t,u$d,u$b,u$E){if(0!=u$E){var u$O,u$q,u$A=u$j.resultMatrix.a*u$j.length,u$c=u$j.resultMatrix.b*u$j.length,u$R=u$A*u$A+u$c*u$c,u$m=Math.sqrt(u$R),u$Q=u$W.resultMatrix.tx,u$T=u$W.resultMatrix.ty,u$$=u$j.resultMatrix.tx,u$e=u$j.resultMatrix.ty,u$K=u$$-u$Q,u$o=u$e-u$T,u$S=u$K*u$K+u$o*u$o,u$M=Math.sqrt(u$S),u$Z=(u$K=u$t-u$W.resultMatrix.tx)*u$K+(u$o=u$d-u$W.resultMatrix.ty)*u$o,u$X=Math.sqrt(u$Z);if(u$m+u$M<=u$X||u$X+u$m<=u$M||u$X+u$M<=u$m){var u$_=NaN;u$$=u$Q+(u$_=u$m+u$M<=u$X?1:-1)*(u$t-u$Q)*u$M/u$X,u$e=u$T+u$_*(u$d-u$T)*u$M/u$X}else{var u$N=(u$S-u$R+u$Z)/(2*u$Z),u$z=Math.sqrt(u$S-u$N*u$N*u$Z)/u$X,u$C=u$Q+u$K*u$N,u$L=u$T+u$o*u$N,u$V=-u$o*u$z,u$x=u$K*u$z;u$e=0<u$b?(u$$=u$C-u$V,u$L-u$x):(u$$=u$C+u$V,u$L+u$x)}u$O=u$$,u$q=u$e,this.isDebug&&(this._sp||(this._sp=new u$EW,u$bW.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(u$Q,u$T,15,"#ff00ff"),this._sp.graphics.drawCircle(u$t,u$d,15,"#ffff00"),this._sp.graphics.drawCircle(u$O,u$q,15,"#ff00ff"));var u$G,u$l;u$G=Math.atan2(u$q-u$W.resultMatrix.ty,u$O-u$W.resultMatrix.tx),u$W.setRotation(u$G),(u$l=u$dW._tempMatrix).identity(),u$l.rotate(u$G),u$l.scale(u$W.resultMatrix.getScaleX(),u$W.resultMatrix.getScaleY()),u$l.translate(u$W.resultMatrix.tx,u$W.resultMatrix.ty),u$l.copyTo(u$W.resultMatrix),u$W.updateChild();var u$h,u$v;u$h=Math.atan2(u$d-u$q,u$t-u$O),u$j.setRotation(u$h),(u$v=u$dW._tempMatrix).identity(),u$v.rotate(u$h),u$v.scale(u$j.resultMatrix.getScaleX(),u$j.resultMatrix.getScaleY()),u$v.translate(u$O,u$q),u$l.copyTo(u$j.resultMatrix),u$j.updateChild()}},u$t(u$dW,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new u$lW}]),u$dW}(),u$HW=function(){function u$W(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return u$d(u$W,"laya.ani.bone.IkConstraintData"),u$W}(),u$X=function(){function u$v(u$W,u$j){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=u$W,this.position=u$W.position,this.spacing=u$W.spacing,this.rotateMix=u$W.rotateMix,this.translateMix=u$W.translateMix,this.bones=[];for(var u$t=this.data.bones,u$d=0,u$b=u$t.length;u$d<u$b;u$d++)this.bones.push(u$j[u$t[u$d]])}u$d(u$v,"laya.ani.bone.PathConstraint");var u$W=u$v.prototype;return u$W.apply=function(u$W,u$j){if(this.target){var u$t=this.translateMix,u$d=this.translateMix,u$b=0<u$d,u$E=this.data.spacingMode,u$O="length"==u$E,u$q=this.data.rotateMode,u$A="tangent"==u$q,u$c="chainScale"==u$q,u$R=[],u$m=this.bones.length,u$Q=u$A?u$m:u$m+1,u$T=[];(this._spaces=u$T)[0]=this.position;var u$$=this.spacing;if(u$c||u$O)for(var u$e=0,u$K=u$Q-1;u$e<u$K;){var u$o=this.bones[u$e],u$S=u$o.length,u$M=u$S*u$o.resultMatrix.a,u$Z=u$S*u$o.resultMatrix.b;u$S=Math.sqrt(u$M*u$M+u$Z*u$Z),u$c&&(u$R[u$e]=u$S),u$T[++u$e]=u$O?Math.max(0,u$S+u$$):u$$}else for(u$e=1;u$e<u$Q;u$e++)u$T[u$e]=u$$;var u$X=this.computeWorldPositions(this.target,u$W,u$j,u$Q,u$A,"percent"==this.data.positionMode,"percent"==u$E);if(this._debugKey){for(u$e=0;u$e<u$X.length;u$e++)u$j.drawCircle(u$X[u$e++],u$X[u$e++],5,"#00ff00");var u$_=[];for(u$e=0;u$e<u$X.length;u$e++)u$_.push(u$X[u$e++],u$X[u$e++]);u$j.drawLines(0,0,u$_,"#ff0000")}var u$N=u$X[0],u$z=u$X[1],u$C=this.data.offsetRotation,u$L="chain"==u$q&&0==u$C,u$V=NaN;for(u$e=0,u$V=3;u$e<u$m;u$e++,u$V+=3){(u$o=this.bones[u$e]).resultMatrix.tx+=(u$N-u$o.resultMatrix.tx)*u$t,u$o.resultMatrix.ty+=(u$z-u$o.resultMatrix.ty)*u$t;var u$x=(u$M=u$X[u$V])-u$N,u$G=(u$Z=u$X[u$V+1])-u$z;if(u$c&&0!=(u$S=u$R[u$e])){var u$l=(Math.sqrt(u$x*u$x+u$G*u$G)/u$S-1)*u$d+1;u$o.resultMatrix.a*=u$l,u$o.resultMatrix.c*=u$l}if(u$N=u$M,u$z=u$Z,u$b){var u$h=u$o.resultMatrix.a,u$v=u$o.resultMatrix.c,u$y=u$o.resultMatrix.b,u$a=u$o.resultMatrix.d,u$u=NaN,u$D=NaN,u$s=NaN;u$u=u$A?u$X[u$V-1]:0==u$T[u$e+1]?u$X[u$V+2]:Math.atan2(u$G,u$x),u$u-=Math.atan2(u$y,u$h)-u$C/180*Math.PI,u$L&&(u$D=Math.cos(u$u),u$s=Math.sin(u$u),u$N+=((u$S=u$o.length)*(u$D*u$h-u$s*u$y)-u$x)*u$d,u$z+=(u$S*(u$s*u$h+u$D*u$y)-u$G)*u$d),u$u>Math.PI?u$u-=2*Math.PI:u$u<-Math.PI&&(u$u+=2*Math.PI),u$u*=u$d,u$D=Math.cos(u$u),u$s=Math.sin(u$u),u$o.resultMatrix.a=u$D*u$h-u$s*u$y,u$o.resultMatrix.c=u$D*u$v-u$s*u$a,u$o.resultMatrix.b=u$s*u$h+u$D*u$y,u$o.resultMatrix.d=u$s*u$v+u$D*u$a}}}},u$W.computeWorldVertices2=function(u$W,u$j,u$t,u$d,u$b,u$E){var u$O,u$q,u$A=u$W.currDisplayData.bones,u$c=u$W.currDisplayData.weights,u$R=u$W.currDisplayData.triangles,u$m=0,u$Q=0,u$T=0,u$$=0,u$e=0,u$K=0,u$o=0,u$S=0,u$M=0,u$Z=0,u$X=0;if(null!=u$A){for(u$m=0;u$m<u$t;u$m+=2)u$Q+=(u$$=u$A[u$Q])+1,u$T+=u$$;var u$_=u$j;for(u$e=u$E,u$K=3*u$T;u$e<u$d;u$e+=2){for(u$S=u$o=0,u$$=u$A[u$Q++],u$$+=u$Q;u$Q<u$$;u$Q++,u$K+=3){u$O=u$_[u$A[u$Q]].resultMatrix,u$M=u$c[u$K],u$Z=u$c[u$K+1];var u$N=u$c[u$K+2];u$o+=(u$M*u$O.a+u$Z*u$O.c+u$O.tx)*u$N,u$S+=(u$M*u$O.b+u$Z*u$O.d+u$O.ty)*u$N}u$b[u$e]=u$o,u$b[u$e+1]=u$S}}else{var u$z,u$C;if(u$R||(u$R=u$c),u$W.deformData&&(u$R=u$W.deformData),u$z=u$W.parent,u$j)for(u$X=u$j.length,u$m=0;u$m<u$X;u$m++)if(u$j[u$m].name==u$z){u$q=u$j[u$m];break}u$q&&(u$C=u$q.resultMatrix),u$C||(u$C=u$v._tempMt);var u$L=u$C.tx,u$V=u$C.ty,u$x=u$C.a,u$G=u$C.b,u$l=u$C.c,u$h=u$C.d;for(u$q&&(u$h*=u$q.d),u$Q=u$t,u$e=u$E;u$e<u$d;u$Q+=2,u$e+=2)u$M=u$R[u$Q],u$Z=u$R[u$Q+1],u$b[u$e]=u$M*u$x+u$Z*u$G+u$L,u$b[u$e+1]=-(u$M*u$l+u$Z*u$h+u$V)}},u$W.computeWorldPositions=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O){u$W.currDisplayData.bones,u$W.currDisplayData.weights,u$W.currDisplayData.triangles;var u$q=[],u$A=0,u$c=u$W.currDisplayData.verLen,u$R=this.position,u$m=this._spaces,u$Q=[],u$T=[],u$$=u$c/6,u$e=-1,u$K=NaN,u$o=0,u$S=0,u$M=NaN,u$Z=NaN,u$X=NaN,u$_=NaN;if(u$$--,u$c-=4,this.computeWorldVertices2(u$W,u$j,2,u$c,u$q,0),this._debugKey)for(u$A=0;u$A<u$q.length;)u$t.drawCircle(u$q[u$A++],u$q[u$A++],10,"#ff0000");u$Q=u$q,this._curves.length=u$$;var u$N=this._curves,u$z=u$Q[u$K=0],u$C=u$Q[1],u$L=0,u$V=0,u$x=0,u$G=0,u$l=0,u$h=0,u$v=NaN,u$y=NaN,u$a=NaN,u$u=NaN,u$D=NaN,u$s=NaN,u$Y=NaN,u$H=NaN,u$I=0;for(u$A=0,u$I=2;u$A<u$$;u$A++,u$I+=6)u$L=u$Q[u$I],u$V=u$Q[u$I+1],u$x=u$Q[u$I+2],u$G=u$Q[u$I+3],u$D=2*(u$v=.1875*(u$z-2*u$L+u$x))+(u$a=.09375*(3*(u$L-u$x)-u$z+(u$l=u$Q[u$I+4]))),u$s=2*(u$y=.1875*(u$C-2*u$V+u$G))+(u$u=.09375*(3*(u$V-u$G)-u$C+(u$h=u$Q[u$I+5]))),u$Y=.75*(u$L-u$z)+u$v+.16666667*u$a,u$H=.75*(u$V-u$C)+u$y+.16666667*u$u,u$K+=Math.sqrt(u$Y*u$Y+u$H*u$H),u$Y+=u$D,u$H+=u$s,u$D+=u$a,u$s+=u$u,u$K+=Math.sqrt(u$Y*u$Y+u$H*u$H),u$Y+=u$D,u$H+=u$s,u$K+=Math.sqrt(u$Y*u$Y+u$H*u$H),u$Y+=u$D+u$a,u$H+=u$s+u$u,u$K+=Math.sqrt(u$Y*u$Y+u$H*u$H),u$N[u$A]=u$K,u$z=u$l,u$C=u$h;if(u$E&&(u$R*=u$K),u$O)for(u$A=0;u$A<u$d;u$A++)u$m[u$A]*=u$K;var u$g=this._segments,u$f=0,u$w=0;for(u$w=u$S=u$o=u$A=0;u$A<u$d;u$A++,u$o+=3)if((u$M=u$R+=u$Z=u$m[u$A])<0)this.addBeforePosition(u$M,u$Q,0,u$T,u$o);else if(u$K<u$M)this.addAfterPosition(u$M-u$K,u$Q,u$c-4,u$T,u$o);else{for(;;u$S++)if(!((u$_=u$N[u$S])<u$M)){0==u$S?u$M/=u$_:u$M=(u$M-(u$X=u$N[u$S-1]))/(u$_-u$X);break}if(u$S!=u$e){var u$U=6*(u$e=u$S);for(u$z=u$Q[u$U],u$C=u$Q[u$U+1],u$L=u$Q[u$U+2],u$V=u$Q[u$U+3],u$x=u$Q[u$U+4],u$G=u$Q[u$U+5],u$D=2*(u$v=.03*(u$z-2*u$L+u$x))+(u$a=.006*(3*(u$L-u$x)-u$z+(u$l=u$Q[u$U+6]))),u$s=2*(u$y=.03*(u$C-2*u$V+u$G))+(u$u=.006*(3*(u$V-u$G)-u$C+(u$h=u$Q[u$U+7]))),u$Y=.3*(u$L-u$z)+u$v+.16666667*u$a,u$H=.3*(u$V-u$C)+u$y+.16666667*u$u,u$f=Math.sqrt(u$Y*u$Y+u$H*u$H),u$g[0]=u$f,u$U=1;u$U<8;u$U++)u$Y+=u$D,u$H+=u$s,u$D+=u$a,u$s+=u$u,u$f+=Math.sqrt(u$Y*u$Y+u$H*u$H),u$g[u$U]=u$f;u$Y+=u$D,u$H+=u$s,u$f+=Math.sqrt(u$Y*u$Y+u$H*u$H),u$g[8]=u$f,u$Y+=u$D+u$a,u$H+=u$s+u$u,u$f+=Math.sqrt(u$Y*u$Y+u$H*u$H),u$g[9]=u$f,u$w=0}for(u$M*=u$f;;u$w++)if(!((u$_=u$g[u$w])<u$M)){0==u$w?u$M/=u$_:u$M=u$w+(u$M-(u$X=u$g[u$w-1]))/(u$_-u$X);break}this.addCurvePosition(.1*u$M,u$z,u$C,u$L,u$V,u$x,u$G,u$l,u$h,u$T,u$o,u$b||0<u$A&&0==u$Z)}return u$T},u$W.addBeforePosition=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$j[u$t],u$O=u$j[u$t+1],u$q=u$j[u$t+2]-u$E,u$A=u$j[u$t+3]-u$O,u$c=Math.atan2(u$A,u$q);u$d[u$b]=u$E+u$W*Math.cos(u$c),u$d[u$b+1]=u$O+u$W*Math.sin(u$c),u$d[u$b+2]=u$c},u$W.addAfterPosition=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$j[u$t+2],u$O=u$j[u$t+3],u$q=u$E-u$j[u$t],u$A=u$O-u$j[u$t+1],u$c=Math.atan2(u$A,u$q);u$d[u$b]=u$E+u$W*Math.cos(u$c),u$d[u$b+1]=u$O+u$W*Math.sin(u$c),u$d[u$b+2]=u$c},u$W.addCurvePosition=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R,u$m){0==u$W&&(u$W=1e-4);var u$Q=u$W*u$W,u$T=u$Q*u$W,u$$=1-u$W,u$e=u$$*u$$,u$K=u$e*u$$,u$o=u$$*u$W,u$S=3*u$o,u$M=u$$*u$S,u$Z=u$S*u$W,u$X=u$j*u$K+u$d*u$M+u$E*u$Z+u$q*u$T,u$_=u$t*u$K+u$b*u$M+u$O*u$Z+u$A*u$T;u$c[u$R]=u$X,u$c[u$R+1]=u$_,u$c[u$R+2]=u$m?Math.atan2(u$_-(u$t*u$e+u$b*u$o*2+u$O*u$Q),u$X-(u$j*u$e+u$d*u$o*2+u$E*u$Q)):0},u$v.NONE=-1,u$v.BEFORE=-2,u$v.AFTER=-3,u$t(u$v,["_tempMt",function(){return this._tempMt=new u$lW}]),u$v}(),u$IW=function(){function u$W(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return u$d(u$W,"laya.ani.bone.PathConstraintData"),u$W}(),u$gW=function(){function u$W(){this.name=null,this.slotArr=[]}return u$d(u$W,"laya.ani.bone.SkinData"),u$W}(),u$fW=function(){function u$W(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}u$d(u$W,"laya.ani.bone.SkinSlotDisplayData");var u$j=u$W.prototype;return u$j.createTexture=function(u$W){return this.texture||(this.texture=new u$hW(u$W.bitmap,this.uvs),u$W.bitmap.alphaTexture&&(this.texture.alphaTexture=new u$hW(u$W.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=u$W.height,this.texture.height=u$W.width,this.texture.offsetX=-u$W.offsetX,this.texture.offsetY=-u$W.offsetY,this.texture.sourceWidth=u$W.sourceHeight,this.texture.sourceHeight=u$W.sourceWidth):(this.texture.width=u$W.width,this.texture.height=u$W.height,this.texture.offsetX=-u$W.offsetX,this.texture.offsetY=-u$W.offsetY,this.texture.sourceWidth=u$W.sourceWidth,this.texture.sourceHeight=u$W.sourceHeight),u$K.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},u$j.destory=function(){this.texture&&this.texture.destroy()},u$W}(),u$wW=function(){function u$W(){this.name=null,this.displayArr=[]}return u$d(u$W,"laya.ani.bone.SlotData"),u$W.prototype.getDisplayByName=function(u$W){for(var u$j=0,u$t=this.displayArr.length;u$j<u$t;u$j++)if(this.displayArr[u$j].attachmentName==u$W)return u$j;return-1},u$W}(),u$_=function(){function u$W(u$W,u$j){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=u$e(2,0),this._data=u$W,null==this._bones&&(this._bones=[]),this.target=u$j[u$W.targetIndex];var u$t,u$d=0;for(u$d=0,u$t=u$W.boneIndexs.length;u$d<u$t;u$d++)this._bones.push(u$j[u$W.boneIndexs[u$d]]);this.rotateMix=u$W.rotateMix,this.translateMix=u$W.translateMix,this.scaleMix=u$W.scaleMix,this.shearMix=u$W.shearMix}return u$d(u$W,"laya.ani.bone.TfConstraint"),u$W.prototype.apply=function(){for(var u$W,u$j=this.target.resultMatrix.a,u$t=this.target.resultMatrix.b,u$d=this.target.resultMatrix.c,u$b=this.target.resultMatrix.d,u$E=0,u$O=this._bones.length;u$E<u$O;u$E++){if(u$W=this._bones[u$E],0<this.rotateMix){var u$q=u$W.resultMatrix.a,u$A=u$W.resultMatrix.b,u$c=u$W.resultMatrix.c,u$R=u$W.resultMatrix.d,u$m=Math.atan2(u$d,u$j)-Math.atan2(u$c,u$q)+this._data.offsetRotation*Math.PI/180;u$m>Math.PI?u$m-=2*Math.PI:u$m<-Math.PI&&(u$m+=2*Math.PI),u$m*=this.rotateMix;var u$Q=Math.cos(u$m),u$T=Math.sin(u$m);u$W.resultMatrix.a=u$Q*u$q-u$T*u$c,u$W.resultMatrix.b=u$Q*u$A-u$T*u$R,u$W.resultMatrix.c=u$T*u$q+u$Q*u$c,u$W.resultMatrix.d=u$T*u$A+u$Q*u$R}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),u$W.resultMatrix.tx+=(this._temp[0]-u$W.resultMatrix.tx)*this.translateMix,u$W.resultMatrix.ty+=(this._temp[1]-u$W.resultMatrix.ty)*this.translateMix,u$W.updateChild()),0<this.scaleMix){var u$$=Math.sqrt(u$W.resultMatrix.a*u$W.resultMatrix.a+u$W.resultMatrix.c*u$W.resultMatrix.c),u$e=Math.sqrt(u$j*u$j+u$d*u$d),u$K=1e-5<u$$?(u$$+(u$e-u$$+this._data.offsetScaleX)*this.scaleMix)/u$$:0;u$W.resultMatrix.a*=u$K,u$W.resultMatrix.c*=u$K,u$$=Math.sqrt(u$W.resultMatrix.b*u$W.resultMatrix.b+u$W.resultMatrix.d*u$W.resultMatrix.d),u$e=Math.sqrt(u$t*u$t+u$b*u$b),u$K=1e-5<u$$?(u$$+(u$e-u$$+this._data.offsetScaleY)*this.scaleMix)/u$$:0,u$W.resultMatrix.b*=u$K,u$W.resultMatrix.d*=u$K}if(0<this.shearMix){u$A=u$W.resultMatrix.b,u$R=u$W.resultMatrix.d;var u$o=Math.atan2(u$R,u$A);(u$m=Math.atan2(u$b,u$t)-Math.atan2(u$d,u$j)-(u$o-Math.atan2(u$W.resultMatrix.c,u$W.resultMatrix.a)))>Math.PI?u$m-=2*Math.PI:u$m<-Math.PI&&(u$m+=2*Math.PI),u$m=u$o+(u$m+this._data.offsetShearY*Math.PI/180)*this.shearMix,u$K=Math.sqrt(u$A*u$A+u$R*u$R),u$W.resultMatrix.b=Math.cos(u$m)*u$K,u$W.resultMatrix.d=Math.sin(u$m)*u$K}}},u$W}(),u$UW=function(){function u$W(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return u$d(u$W,"laya.ani.bone.TfConstraintData"),u$W}(),u$JW=function(){function u$W(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}u$d(u$W,"laya.ani.bone.Transform");var u$j=u$W.prototype;return u$j.initData=function(u$W){null!=u$W.x&&(this.x=u$W.x),null!=u$W.y&&(this.y=u$W.y),null!=u$W.skX&&(this.skX=u$W.skX),null!=u$W.skY&&(this.skY=u$W.skY),null!=u$W.scX&&(this.scX=u$W.scX),null!=u$W.scY&&(this.scY=u$W.scY)},u$j.getMatrix=function(){var u$W;return(u$W=this.mMatrix?this.mMatrix:this.mMatrix=new u$lW).identity(),u$W.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(u$W,this.skewX*Math.PI/180,this.skewY*Math.PI/180),u$W.rotate(this.skX*Math.PI/180),u$W.translate(this.x,this.y),u$W},u$j.skew=function(u$W,u$j,u$t){var u$d=Math.sin(u$t),u$b=Math.cos(u$t),u$E=Math.sin(u$j),u$O=Math.cos(u$j);return u$W.setTo(u$W.a*u$O-u$W.b*u$d,u$W.a*u$E+u$W.b*u$b,u$W.c*u$O-u$W.d*u$d,u$W.c*u$E+u$W.d*u$b,u$W.tx*u$O-u$W.ty*u$d,u$W.tx*u$E+u$W.ty*u$b),u$W},u$W}(),u$N=function(){function u$W(){}return u$d(u$W,"laya.ani.bone.UVTools"),u$W.getRelativeUV=function(u$W,u$j,u$t){var u$d=u$W[0],u$b=u$W[2]-u$W[0],u$E=u$W[1],u$O=u$W[5]-u$W[1];u$t||(u$t=[]),u$t.length=u$j.length;var u$q,u$A=0;u$q=u$t.length;var u$c=1/u$b,u$R=1/u$O;for(u$A=0;u$A<u$q;u$A+=2)u$t[u$A]=(u$j[u$A]-u$d)*u$c,u$t[u$A+1]=(u$j[u$A+1]-u$E)*u$R;return u$t},u$W.getAbsoluteUV=function(u$W,u$j,u$t){if(0==u$W[0]&&0==u$W[1]&&1==u$W[4]&&1==u$W[5])return u$t?(u$o.copyArray(u$t,u$j),u$t):u$j;var u$d=u$W[0],u$b=u$W[2]-u$W[0],u$E=u$W[1],u$O=u$W[5]-u$W[1];u$t||(u$t=[]),u$t.length=u$j.length;var u$q,u$A=0;for(u$q=u$t.length,u$A=0;u$A<u$q;u$A+=2)u$t[u$A]=u$j[u$A]*u$b+u$d,u$t[u$A+1]=u$j[u$A+1]*u$O+u$E;return u$t},u$W}(),u$v=function(){function u$W(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return u$d(u$W,"laya.ani.KeyFramesContent"),u$W}(),u$z=function(){function u$R(){}return u$d(u$R,"laya.ani.math.BezierLerp"),u$R.getBezierRate=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$R._getBezierParamKey(u$j,u$t,u$d,u$b),u$O=100*u$E+u$W;if(u$R._bezierResultCache[u$O])return u$R._bezierResultCache[u$O];var u$q,u$A=u$R._getBezierPoints(u$j,u$t,u$d,u$b,u$E),u$c=0;for(u$q=u$A.length,u$c=0;u$c<u$q;u$c+=2)if(u$W<=u$A[u$c])return u$R._bezierResultCache[u$O]=u$A[u$c+1],u$A[u$c+1];return u$R._bezierResultCache[u$O]=1},u$R._getBezierParamKey=function(u$W,u$j,u$t,u$d){return 100*(100*(100*(100*u$W+u$j)+u$t)+u$d)},u$R._getBezierPoints=function(u$W,u$j,u$t,u$d,u$b){return u$R._bezierPointsCache[u$b]?u$R._bezierPointsCache[u$b]:(u$E=[0,0,u$W,u$j,u$t,u$d,1,1],u$O=(new u$q).getBezierPoints(u$E,100,3),u$R._bezierPointsCache[u$b]=u$O);var u$E,u$O},u$R._bezierResultCache={},u$R._bezierPointsCache={},u$R}(),u$C=function(u$W){function u$j(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,u$j.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}u$d(u$j,"laya.ani.AnimationPlayer",u$b);var u$t=u$j.prototype;return u$bW.imps(u$t,{"laya.resource.IDestroy":!0}),u$t._onTempletLoadedComputeFullKeyframeIndices=function(u$W,u$j,u$t){this._templet===u$t&&this._cachePlayRate===u$W&&this._cacheFrameRate===u$j&&this._computeFullKeyframeIndices()},u$t._computeFullKeyframeIndices=function(){for(var u$W=this._fullFrames=[],u$j=this._templet,u$t=this._cacheFrameRateInterval*this._cachePlayRate,u$d=0,u$b=u$j.getAnimationCount();u$d<u$b;u$d++){for(var u$E=[],u$O=0,u$q=u$j.getAnimation(u$d).nodes.length;u$O<u$q;u$O++){for(var u$A=u$j.getAnimation(u$d).nodes[u$O],u$c=Math.floor(u$A.playTime/u$t+.01),u$R=new Uint16Array(u$c+1),u$m=-1,u$Q=0,u$T=u$A.keyFrame.length;u$Q<u$T;u$Q++){var u$$=u$A.keyFrame[u$Q],u$e=u$$.startTime,u$K=u$e+u$$.duration+u$t;do{for(var u$o=Math.floor(u$e/u$t+.5),u$S=u$m+1;u$S<u$o;u$S++)u$R[u$S]=u$Q;u$R[u$m=u$o]=u$Q,u$e+=u$t}while(u$e<=u$K)}u$E.push(u$R)}u$W.push(u$E)}},u$t._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},u$t._calculatePlayDuration=function(){if(0!==this.state){var u$W=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=u$W),this._playEnd>u$W&&(this._playEnd=u$W),this._playDuration=this._playEnd-this._playStart}},u$t._setPlayParams=function(u$W,u$j){this._currentTime=u$W,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/u$j+.01),0),this._currentFrameTime=this._currentKeyframeIndex*u$j},u$t._setPlayParamsWhenStop=function(u$W,u$j){this._currentTime=u$W,this._currentKeyframeIndex=Math.max(Math.floor(u$W/u$j+.01),0),this._currentFrameTime=this._currentKeyframeIndex*u$j,this._currentAnimationClipIndex=-1},u$t._update=function(u$W){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var u$j=this._cacheFrameRateInterval*this._cachePlayRate,u$t=0;this._startUpdateLoopCount!==u$$.loopCount&&(u$t=u$W*this.playbackRate,this._elapsedPlaybackTime+=u$t);var u$d=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=u$d)return this._setPlayParamsWhenStop(u$d,u$j),void this.event("stopped");if(u$t+=this._currentTime,0<u$d)if(u$d<=u$t)do{if(u$t-=u$d,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(u$d,u$j),this._stopWhenCircleFinish=!1,void this.event("stopped");u$t<u$d&&(this._setPlayParams(u$t,u$j),this.event("complete"))}while(u$d<=u$t);else this._setPlayParams(u$t,u$j);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(u$d,u$j),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},u$t._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},u$t.play=function(u$W,u$j,u$t,u$d,u$b){if(void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=1),void 0===u$t&&(u$t=2147483647),void 0===u$d&&(u$d=0),void 0===u$b&&(u$b=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(u$t<0||u$d<0||u$b<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==u$b&&u$b<u$d)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=u$j,this._overallDuration=u$t,this._playStart=u$d,this._playEnd=u$b,this._paused=!1,this._currentAnimationClipIndex=u$W,this._currentKeyframeIndex=0,this._startUpdateLoopCount=u$$.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},u$t.playByFrame=function(u$W,u$j,u$t,u$d,u$b,u$E){void 0===u$W&&(u$W=0),void 0===u$j&&(u$j=1),void 0===u$t&&(u$t=2147483647),void 0===u$d&&(u$d=0),void 0===u$b&&(u$b=0),void 0===u$E&&(u$E=30);var u$O=1e3/u$E;this.play(u$W,u$j,u$t,u$d*u$O,u$b*u$O)},u$t.stop=function(u$W){void 0===u$W&&(u$W=!0),u$W?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},u$E(0,u$t,"playEnd",function(){return this._playEnd}),u$E(0,u$t,"templet",function(){return this._templet},function(u$W){0===!this.state&&this.stop(!0),this._templet!==u$W&&((this._templet=u$W).loaded?this._computeFullKeyframeIndices():u$W.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),u$E(0,u$t,"playStart",function(){return this._playStart}),u$E(0,u$t,"playDuration",function(){return this._playDuration}),u$E(0,u$t,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),u$E(0,u$t,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),u$E(0,u$t,"overallDuration",function(){return this._overallDuration}),u$E(0,u$t,"currentFrameTime",function(){return this._currentFrameTime}),u$E(0,u$t,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),u$E(0,u$t,"currentPlayTime",function(){return this._currentTime+this._playStart}),u$E(0,u$t,"cachePlayRate",function(){return this._cachePlayRate},function(u$W){this._cachePlayRate!==u$W&&(this._cachePlayRate=u$W,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[u$W,this._cacheFrameRate])))}),u$E(0,u$t,"cacheFrameRate",function(){return this._cacheFrameRate},function(u$W){this._cacheFrameRate!==u$W&&(this._cacheFrameRate=u$W,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,u$W])))}),u$E(0,u$t,"currentTime",null,function(u$W){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(u$W<this._playStart||u$W>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=u$$.loopCount;var u$j=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=u$W,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/u$j),0),this._currentFrameTime=this._currentKeyframeIndex*u$j}}),u$E(0,u$t,"paused",function(){return this._paused},function(u$W){(this._paused=u$W)&&this.event("paused")}),u$E(0,u$t,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),u$E(0,u$t,"destroyed",function(){return this._destroyed}),u$j}(),u$y=function(u$W){function u$j(){u$j.__super.call(this),u$K.isConchNode&&(this.drawSkin=function(u$W){u$W.transform||(u$W.transform=u$lW.EMPTY),this._addCmd([u$W]),this.setSkinMesh&&this.setSkinMesh(u$W._ps,u$W.mVBData,u$W.mEleNum,0,u$W.mTexture,u$W.transform)})}return u$d(u$j,"laya.ani.GraphicsAni",u$O),u$j.prototype.drawSkin=function(u$W){var u$j=[u$W];this._saveToCmd(u$K._context._drawSkin,u$j)},u$j.create=function(){return u$j._caches.pop()||new u$j},u$j.recycle=function(u$W){u$W.clear(),u$j._caches.push(u$W)},u$j._caches=[],u$j}(),u$a=function(u$W){function u$S(){this._aniMap={},this.unfixedLastAniIndex=-1,u$S.__super.call(this),this._anis=new Array}u$d(u$S,"laya.ani.AnimationTemplet",u$R);var u$j=u$S.prototype;return u$j.parse=function(u$W){var u$j=new u$GW(u$W);this._aniVersion=u$j.readUTFString(),u$M.parse(this,u$j)},u$j._calculateKeyFrame=function(u$W,u$j,u$t){var u$d=u$W.keyFrame;u$d[u$j]=u$d[0];for(var u$b=0;u$b<u$j;u$b++){var u$E=u$d[u$b];u$E.nextData=0===u$E.duration?u$E.data:u$d[u$b+1].data}u$d.length--},u$j.onAsynLoaded=function(u$W,u$j,u$t){var u$d=new u$GW(u$j);switch(this._aniVersion=u$d.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":u$Z.parse(this,u$d);break;default:u$M.parse(this,u$d)}this._endLoaded()},u$j.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},u$j.getAnimationCount=function(){return this._anis.length},u$j.getAnimation=function(u$W){return this._anis[u$W]},u$j.getAniDuration=function(u$W){return this._anis[u$W].playTime},u$j.getNodes=function(u$W){return this._anis[u$W].nodes},u$j.getNodeIndexWithName=function(u$W,u$j){return this._anis[u$W].bone3DMap[u$j]},u$j.getNodeCount=function(u$W){return this._anis[u$W].nodes.length},u$j.getTotalkeyframesLength=function(u$W){return this._anis[u$W].totalKeyframeDatasLength},u$j.getPublicExtData=function(){return this._publicExtData},u$j.getAnimationDataWithCache=function(u$W,u$j,u$t,u$d){var u$b=u$j[u$t];if(u$b){var u$E=u$b[u$W];return u$E?u$E[u$d]:null}return null},u$j.setAnimationDataWithCache=function(u$W,u$j,u$t,u$d,u$b){var u$E=u$j[u$t]||(u$j[u$t]={});(u$E[u$W]||(u$E[u$W]=[]))[u$d]=u$b},u$j.getOriginalData=function(u$W,u$j,u$t,u$d,u$b){for(var u$E=this._anis[u$W].nodes,u$O=0,u$q=0,u$A=u$E.length,u$c=0;u$q<u$A;u$q++){var u$R,u$m=u$E[u$q];u$R=u$m.keyFrame[u$t[u$q][u$d]],u$m.dataOffset=u$c;var u$Q=u$b-u$R.startTime,u$T=u$m.lerpType;if(u$T)switch(u$T){case 0:case 1:for(u$O=0;u$O<u$m.keyframeWidth;)u$O+=u$m.interpolationMethod[u$O](u$m,u$O,u$j,u$c+u$O,u$R.data,u$Q,null,u$R.duration,u$R.nextData);break;case 2:var u$$=u$R.interpolationData,u$e=u$$.length,u$K=0;for(u$O=0;u$O<u$e;){var u$o=u$$[u$O];switch(u$o){case 6:case 7:u$O+=u$S.interpolation[u$o](u$m,u$K,u$j,u$c+u$K,u$R.data,u$Q,null,u$R.duration,u$R.nextData,u$$,u$O+1);break;default:u$O+=u$S.interpolation[u$o](u$m,u$K,u$j,u$c+u$K,u$R.data,u$Q,null,u$R.duration,u$R.nextData)}u$K++}}else for(u$O=0;u$O<u$m.keyframeWidth;)u$O+=u$m.interpolationMethod[u$O](u$m,u$O,u$j,u$c+u$O,u$R.data,u$Q,null,u$R.duration,u$R.nextData);u$c+=u$m.keyframeWidth}},u$j.getNodesCurrentFrameIndex=function(u$W,u$j){var u$t=this._anis[u$W].nodes;u$W!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(u$t.length),this.unfixedCurrentTimes=new Float32Array(u$t.length),this.unfixedLastAniIndex=u$W);for(var u$d=0,u$b=u$t.length;u$d<u$b;u$d++){var u$E=u$t[u$d];for(u$j<this.unfixedCurrentTimes[u$d]&&(this.unfixedCurrentFrameIndexes[u$d]=0),this.unfixedCurrentTimes[u$d]=u$j;this.unfixedCurrentFrameIndexes[u$d]<u$E.keyFrame.length&&!(u$E.keyFrame[this.unfixedCurrentFrameIndexes[u$d]].startTime>this.unfixedCurrentTimes[u$d]);)this.unfixedCurrentFrameIndexes[u$d]++;this.unfixedCurrentFrameIndexes[u$d]--}return this.unfixedCurrentFrameIndexes},u$j.getOriginalDataUnfixedRate=function(u$W,u$j,u$t){var u$d=this._anis[u$W].nodes;u$W!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(u$d.length),this.unfixedCurrentTimes=new Float32Array(u$d.length),this.unfixedKeyframes=u$e(u$d.length),this.unfixedLastAniIndex=u$W);for(var u$b=0,u$E=0,u$O=u$d.length,u$q=0;u$E<u$O;u$E++){var u$A=u$d[u$E];for(u$t<this.unfixedCurrentTimes[u$E]&&(this.unfixedCurrentFrameIndexes[u$E]=0),this.unfixedCurrentTimes[u$E]=u$t;this.unfixedCurrentFrameIndexes[u$E]<u$A.keyFrame.length&&!(u$A.keyFrame[this.unfixedCurrentFrameIndexes[u$E]].startTime>this.unfixedCurrentTimes[u$E]);)this.unfixedKeyframes[u$E]=u$A.keyFrame[this.unfixedCurrentFrameIndexes[u$E]],this.unfixedCurrentFrameIndexes[u$E]++;var u$c=this.unfixedKeyframes[u$E];u$A.dataOffset=u$q;var u$R=u$t-u$c.startTime;if(u$A.lerpType)switch(u$A.lerpType){case 0:case 1:for(u$b=0;u$b<u$A.keyframeWidth;)u$b+=u$A.interpolationMethod[u$b](u$A,u$b,u$j,u$q+u$b,u$c.data,u$R,null,u$c.duration,u$c.nextData);break;case 2:var u$m=u$c.interpolationData,u$Q=u$m.length,u$T=0;for(u$b=0;u$b<u$Q;){var u$$=u$m[u$b];switch(u$$){case 6:case 7:u$b+=u$S.interpolation[u$$](u$A,u$T,u$j,u$q+u$T,u$c.data,u$R,null,u$c.duration,u$c.nextData,u$m,u$b+1);break;default:u$b+=u$S.interpolation[u$$](u$A,u$T,u$j,u$q+u$T,u$c.data,u$R,null,u$c.duration,u$c.nextData)}u$T++}}else for(u$b=0;u$b<u$A.keyframeWidth;)u$b+=u$A.interpolationMethod[u$b](u$A,u$b,u$j,u$q+u$b,u$c.data,u$R,null,u$c.duration,u$c.nextData);u$q+=u$A.keyframeWidth}},u$S._LinearInterpolation_0=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){var u$R=0===u$q?0:u$E/u$q;return u$t[u$d]=(1-u$R)*u$b[u$j]+u$R*u$A[u$j],1},u$S._QuaternionInterpolation_1=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){var u$R=0===u$q?0:u$E/u$q;return u$Q.slerpQuaternionArray(u$b,u$j,u$A,u$j,u$R,u$t,u$d),4},u$S._AngleInterpolation_2=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){return 0},u$S._RadiansInterpolation_3=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){return 0},u$S._Matrix4x4Interpolation_4=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){for(var u$R=0;u$R<16;u$R++,u$j++)u$t[u$d+u$R]=u$b[u$j]+u$E*u$O[u$j];return 16},u$S._NoInterpolation_5=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c){return u$t[u$d]=u$b[u$j],1},u$S._BezierInterpolation_6=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R){return void 0===u$R&&(u$R=0),u$t[u$d]=u$b[u$j]+(u$A[u$j]-u$b[u$j])*u$z.getBezierRate(u$E/u$q,u$c[u$R],u$c[u$R+1],u$c[u$R+2],u$c[u$R+3]),5},u$S._BezierInterpolation_7=function(u$W,u$j,u$t,u$d,u$b,u$E,u$O,u$q,u$A,u$c,u$R){return void 0===u$R&&(u$R=0),u$t[u$d]=u$c[u$R+4]+u$c[u$R+5]*u$z.getBezierRate((.001*u$E+u$c[u$R+6])/u$c[u$R+7],u$c[u$R],u$c[u$R+1],u$c[u$R+2],u$c[u$R+3]),9},u$S.load=function(u$W){return u$bW.loader.create(u$W,null,null,u$S)},u$S.interpolation=[u$S._LinearInterpolation_0,u$S._QuaternionInterpolation_1,u$S._AngleInterpolation_2,u$S._RadiansInterpolation_3,u$S._Matrix4x4Interpolation_4,u$S._NoInterpolation_5,u$S._BezierInterpolation_6,u$S._BezierInterpolation_7],u$S}(),u$L=function(u$j){function u$t(u$W,u$j){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,u$t.__super.call(this),void 0===u$j&&(u$j=0),u$W&&this.init(u$W,u$j)}u$d(u$t,"laya.ani.bone.Skeleton",u$j);var u$W=u$t.prototype;return u$W.init=function(u$W,u$j){void 0===u$j&&(u$j=0);var u$t,u$d,u$b,u$E=0,u$O=0;if(1==u$j)for(this._graphicsCache=[],u$E=0,u$O=u$W.getAnimationCount();u$E<u$O;u$E++)this._graphicsCache.push([]);if(this._yReverseMatrix=u$W.yReverseMatrix,this._aniMode=u$j,this._templet=u$W,this._player=new u$C,this._player.cacheFrameRate=u$W.rate,this._player.templet=u$W,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=u$W.mBoneArr,this._rootBone=u$W.mRootBone,this._aniSectionDic=u$W.aniSectionDic,0<u$W.ikArr.length)for(this._ikArr=[],u$E=0,u$O=u$W.ikArr.length;u$E<u$O;u$E++)this._ikArr.push(new u$S(u$W.ikArr[u$E],this._boneList));if(0<u$W.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),u$E=0,u$O=u$W.pathArr.length;u$E<u$O;u$E++)u$t=u$W.pathArr[u$E],u$d=new u$X(u$t,this._boneList),(u$b=this._boneSlotDic[u$t.name])&&((u$d=new u$X(u$t,this._boneList)).target=u$b),this._pathDic[u$t.name]=u$d;if(0<u$W.tfArr.length)for(this._tfArr=[],u$E=0,u$O=u$W.tfArr.length;u$E<u$O;u$E++)this._tfArr.push(new u$_(u$W.tfArr[u$E],this._boneList));if(0<u$W.skinDataArray.length){var u$q=this._templet.skinDataArray[this._skinIndex];this._skinName=u$q.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},u$W.load=function(u$W,u$j,u$t){},u$W._onLoaded=function(){},u$W._parseComplete=function(){var u$W=u$V.TEMPLET_DICTIONARY[this._aniPath];u$W&&(this.init(u$W,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},u$W._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},u$W._onPlay=function(){this.event("played")},u$W._onStop=function(){var u$W,u$j=this._templet.eventAniArr[this._aniClipIndex];if(u$j&&this._eventIndex<u$j.length)for(;this._eventIndex<u$j.length;this._eventIndex++)(u$W=u$j[this._eventIndex]).time>=this._player.playStart&&u$W.time<=this._player.playEnd&&this.event("label",u$W);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},u$W._onPause=function(){this.event("paused")},u$W._parseSrcBoneMatrix=function(){var u$W=0,u$j=0;for(u$j=this._templet.srcBoneMatrixArr.length,u$W=0;u$W<u$j;u$W++)this._boneMatrixArray.push(new u$lW);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var u$t,u$d,u$b=this._templet.boneSlotArray;for(u$W=0,u$j=u$b.length;u$W<u$j;u$W++)u$t=u$b[u$W],null==(u$d=this._bindBoneBoneSlotDic[u$t.parent])&&(this._bindBoneBoneSlotDic[u$t.parent]=u$d=[]),this._boneSlotDic[u$t.name]=u$t=u$t.copy(),u$d.push(u$t),this._boneSlotArray.push(u$t)}},u$W._emitMissedEvents=function(u$W,u$j,u$t){void 0===u$t&&(u$t=0);var u$d=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(u$d){var u$b,u$E,u$O=0;for(u$b=u$d.length,u$O=u$t;u$O<u$b;u$O++)(u$E=u$d[u$O]).time>=this._player.playStart&&u$E.time<=this._player.playEnd&&this.event("label",u$E)}},u$W._update=function(u$W){if(void 0===u$W&&(u$W=!0),!(this._pause||u$W&&this._indexControl)){var u$j=this.timer.currTimer,u$t=this._player.currentKeyframeIndex,u$d=u$j-this._lastTime;if(u$W?this._player._update(u$d):u$t=-1,this._lastTime=u$j,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<u$d&&this._clipIndex==u$t&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var u$b;this._lastUpdateAniClipIndex=this._aniClipIndex,u$t>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var u$E,u$O=this._templet.eventAniArr[this._aniClipIndex];if(u$O&&this._eventIndex<u$O.length&&((u$b=u$O[this._eventIndex]).time>=this._player.playStart&&u$b.time<=this._player.playEnd?this._player.currentPlayTime>=u$b.time&&(this.event("label",u$b),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(u$E=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=u$E&&(this.graphics=u$E));var u$q=0,u$A=0;for(u$A=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,u$A-1)&&0<u$A;)u$A--;if(u$A<this._clipIndex)for(u$q=u$A;u$q<this._clipIndex;u$q++)this._createGraphics(u$q)}else if(1==this._aniMode){if(u$E=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=u$E&&(this.graphics=u$E));for(u$A=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,u$A-1)&&0<u$A;)u$A--;if(u$A<this._clipIndex)for(u$q=u$A;u$q<this._clipIndex;u$q++)this._createGraphics(u$q)}this._createGraphics()}}},u$W._createGraphics=function(u$W){void 0===u$W&&(u$W=-1),-1==u$W&&(u$W=this._clipIndex);var u$j,u$t,u$d=u$W*this._player.cacheFrameRateInterval,u$b=this._templet.drawOrderAniArr[this._aniClipIndex];if(u$b&&0<u$b.length)for(this._drawOrderIndex=0,u$j=u$b[this._drawOrderIndex];u$d>=u$j.time&&(this._drawOrder=u$j.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=u$b.length));)u$j=u$b[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=u$y.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=u$y.create(),u$t=this.graphics;var u$E=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],u$W,u$d);var u$O,u$q,u$A,u$c,u$R=this._aniSectionDic[this._aniClipIndex],u$m=0,u$Q=0,u$T=0,u$$=0,u$e=0,u$K=this._templet.srcBoneMatrixArr.length;for(u$e=u$R[u$Q=0];u$Q<u$K;u$Q++)u$c=this._boneList[u$Q],u$A=this._templet.srcBoneMatrixArr[u$Q],u$c.resultTransform.scX=u$A.scX*this._curOriginalData[u$m++],u$c.resultTransform.skX=u$A.skX+this._curOriginalData[u$m++],u$c.resultTransform.skY=u$A.skY+this._curOriginalData[u$m++],u$c.resultTransform.scY=u$A.scY*this._curOriginalData[u$m++],u$c.resultTransform.x=u$A.x+this._curOriginalData[u$m++],u$c.resultTransform.y=u$A.y+this._curOriginalData[u$m++],8===this._templet.tMatrixDataLen&&(u$c.resultTransform.skewX=u$A.skewX+this._curOriginalData[u$m++],u$c.resultTransform.skewY=u$A.skewY+this._curOriginalData[u$m++]);var u$o,u$S={},u$M={};for(u$e+=u$R[1];u$Q<u$e;u$Q++)u$S[(u$o=u$E[u$Q]).name]=this._curOriginalData[u$m++],u$M[u$o.name]=this._curOriginalData[u$m++],this._curOriginalData[u$m++],this._curOriginalData[u$m++],this._curOriginalData[u$m++],this._curOriginalData[u$m++];var u$Z,u$X,u$_={},u$N={};for(u$e+=u$R[2];u$Q<u$e;u$Q++)u$_[(u$o=u$E[u$Q]).name]=this._curOriginalData[u$m++],u$N[u$o.name]=this._curOriginalData[u$m++],this._curOriginalData[u$m++],this._curOriginalData[u$m++],this._curOriginalData[u$m++],this._curOriginalData[u$m++];if(this._pathDic)for(u$e+=u$R[3];u$Q<u$e;u$Q++){if(u$o=u$E[u$Q],u$Z=this._pathDic[u$o.name])switch(new u$GW(u$o.extenData).getByte()){case 1:u$Z.position=this._curOriginalData[u$m++];break;case 2:u$Z.spacing=this._curOriginalData[u$m++];break;case 3:u$Z.rotateMix=this._curOriginalData[u$m++],u$Z.translateMix=this._curOriginalData[u$m++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(u$lW.TEMP.identity()),this._ikArr)for(u$Q=0,u$e=this._ikArr.length;u$Q<u$e;u$Q++)u$X=this._ikArr[u$Q],u$_.hasOwnProperty(u$X.name)&&(u$X.bendDirection=u$_[u$X.name]),u$N.hasOwnProperty(u$X.name)&&(u$X.mix=u$N[u$X.name]),u$X.apply();if(this._pathDic)for(var u$z in this._pathDic)(u$Z=this._pathDic[u$z]).apply(this._boneList,u$t);if(this._tfArr)for(u$Q=0,u$$=this._tfArr.length;u$Q<u$$;u$Q++)this._tfArr[u$Q].apply();for(u$Q=0,u$$=this._boneList.length;u$Q<u$$;u$Q++)if(u$c=this._boneList[u$Q],u$q=this._bindBoneBoneSlotDic[u$c.name],u$c.resultMatrix.copyTo(this._boneMatrixArray[u$Q]),u$q)for(u$T=0,u$e=u$q.length;u$T<u$e;u$T++)(u$O=u$q[u$T])&&u$O.setParentMatrix(u$c.resultMatrix);var u$C,u$L,u$V,u$x,u$G={},u$l=this._templet.deformAniArr;if(u$l&&0<u$l.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,u$Q=0,u$e=this._boneSlotArray.length;u$Q<u$e;u$Q++)(u$O=this._boneSlotArray[u$Q]).deformData=null;var u$h,u$v=u$l[this._aniClipIndex];for(u$h in u$C=u$v.default,this._setDeform(u$C,u$G,this._boneSlotArray,u$d),u$v)"default"!=u$h&&u$h!=this._skinName&&(u$C=u$v[u$h],this._setDeform(u$C,u$G,this._boneSlotArray,u$d));u$C=u$v[this._skinName],this._setDeform(u$C,u$G,this._boneSlotArray,u$d)}if(this._drawOrder)for(u$Q=0,u$e=this._drawOrder.length;u$Q<u$e;u$Q++)u$L=u$S[(u$O=this._boneSlotArray[this._drawOrder[u$Q]]).name],u$V=u$M[u$O.name],isNaN(u$V)||(u$t.save(),u$t.alpha(u$V)),isNaN(u$L)||-2==u$L||(this._templet.attachmentNames?u$O.showDisplayByName(this._templet.attachmentNames[u$L]):u$O.showDisplayByIndex(u$L)),u$G[this._drawOrder[u$Q]]?(u$x=u$G[this._drawOrder[u$Q]],u$O.currDisplayData&&u$x[u$O.currDisplayData.attachmentName]?u$O.deformData=u$x[u$O.currDisplayData.attachmentName]:u$O.deformData=null):u$O.deformData=null,isNaN(u$V)?u$O.draw(u$t,this._boneMatrixArray,2==this._aniMode):u$O.draw(u$t,this._boneMatrixArray,2==this._aniMode,u$V),isNaN(u$V)||u$t.restore();else for(u$Q=0,u$e=this._boneSlotArray.length;u$Q<u$e;u$Q++)u$L=u$S[(u$O=this._boneSlotArray[u$Q]).name],u$V=u$M[u$O.name],isNaN(u$V)||(u$t.save(),u$t.alpha(u$V)),isNaN(u$L)||-2==u$L||(this._templet.attachmentNames?u$O.showDisplayByName(this._templet.attachmentNames[u$L]):u$O.showDisplayByIndex(u$L)),u$G[u$Q]?(u$x=u$G[u$Q],u$O.currDisplayData&&u$x[u$O.currDisplayData.attachmentName]?u$O.deformData=u$x[u$O.currDisplayData.attachmentName]:u$O.deformData=null):u$O.deformData=null,isNaN(u$V)?u$O.draw(u$t,this._boneMatrixArray,2==this._aniMode):u$O.draw(u$t,this._boneMatrixArray,2==this._aniMode,u$V),isNaN(u$V)||u$t.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,u$W,u$t):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,u$W,u$t)},u$W._setDeform=function(u$W,u$j,u$t,u$d){if(u$W){var u$b,u$E,u$O,u$q=0,u$A=0,u$c=0;if(u$W)for(u$q=0,u$A=u$W.deformSlotDataList.length;u$q<u$A;u$q++)for(u$b=u$W.deformSlotDataList[u$q],u$c=0;u$c<u$b.deformSlotDisplayList.length;u$c++)u$O=u$t[(u$E=u$b.deformSlotDisplayList[u$c]).slotIndex],u$E.apply(u$d,u$O),u$j[u$E.slotIndex]||(u$j[u$E.slotIndex]={}),u$j[u$E.slotIndex][u$E.attachment]=u$E.deformData}},u$W.getAnimNum=function(){return this._templet.getAnimationCount()},u$W.getAniNameByIndex=function(u$W){return this._templet.getAniNameByIndex(u$W)},u$W.getSlotByName=function(u$W){return this._boneSlotDic[u$W]},u$W.showSkinByName=function(u$W,u$j){void 0===u$j&&(u$j=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(u$W),u$j)},u$W.showSkinByIndex=function(u$W,u$j){void 0===u$j&&(u$j=!0);for(var u$t=0;u$t<this._boneSlotArray.length;u$t++)this._boneSlotArray[u$t].showSlotData(null,u$j);if(this._templet.showSkinByIndex(this._boneSlotDic,u$W,u$j)){var u$d=this._templet.skinDataArray[u$W];this._skinIndex=u$W,this._skinName=u$d.name}this._clearCache()},u$W.showSlotSkinByIndex=function(u$W,u$j){if(0!=this._aniMode){var u$t=this.getSlotByName(u$W);u$t&&u$t.showDisplayByIndex(u$j),this._clearCache()}},u$W.showSlotSkinByName=function(u$W,u$j){if(0!=this._aniMode){var u$t=this.getSlotByName(u$W);u$t&&u$t.showDisplayByName(u$j),this._clearCache()}},u$W.replaceSlotSkinName=function(u$W,u$j,u$t){if(0!=this._aniMode){var u$d=this.getSlotByName(u$W);u$d&&u$d.replaceDisplayByName(u$j,u$t),this._clearCache()}},u$W.replaceSlotSkinByIndex=function(u$W,u$j,u$t){if(0!=this._aniMode){var u$d=this.getSlotByName(u$W);u$d&&u$d.replaceDisplayByIndex(u$j,u$t),this._clearCache()}},u$W.setSlotSkin=function(u$W,u$j){if(0!=this._aniMode){var u$t=this.getSlotByName(u$W);u$t&&u$t.replaceSkin(u$j),this._clearCache()}},u$W._clearCache=function(){if(1==this._aniMode)for(var u$W=0,u$j=this._graphicsCache.length;u$W<u$j;u$W++){for(var u$t=0,u$d=this._graphicsCache[u$W].length;u$t<u$d;u$t++){var u$b=this._graphicsCache[u$W][u$t];u$b!=this.graphics&&u$y.recycle(u$b)}this._graphicsCache[u$W].length=0}},u$W.play=function(u$W,u$j,u$t,u$d,u$b,u$E){void 0===u$t&&(u$t=!0),void 0===u$d&&(u$d=0),void 0===u$b&&(u$b=0),void 0===u$E&&(u$E=!0),this._indexControl=!1;var u$O=-1,u$q=NaN;if(u$q=u$j?2147483647:0,"string"==typeof u$W)for(var u$A=0,u$c=this._templet.getAnimationCount();u$A<u$c;u$A++){var u$R=this._templet.getAnimation(u$A);if(u$R&&u$W==u$R.name){u$O=u$A;break}}else u$O=u$W;-1<u$O&&u$O<this.getAnimNum()&&(this._aniClipIndex=u$O,(u$t||this._pause||this._currAniIndex!=u$O)&&(this._currAniIndex=u$O,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(u$O)),this._drawOrder=null,this._eventIndex=0,this._player.play(u$O,this._player.playbackRate,u$q,u$d,u$b),u$E&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=u$m.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},u$W.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},u$W.playbackRate=function(u$W){this._player&&(this._player.playbackRate=u$W)},u$W.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},u$W.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=u$m.now(),this.timer.frameLoop(1,this,this._update,null,!0))},u$W._getGrahicsDataWithCache=function(u$W,u$j){return this._graphicsCache[u$W][u$j]},u$W._setGrahicsDataWithCache=function(u$W,u$j,u$t){this._graphicsCache[u$W][u$j]=u$t},u$W.destroy=function(u$W){void 0===u$W&&(u$W=!0),u$j.prototype.destroy.call(this,u$W),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},u$E(0,u$W,"url",function(){return this._aniPath},function(u$W){this.load(u$W)}),u$E(0,u$W,"index",function(){return this._index},function(u$W){this.player&&(this._index=u$W,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),u$E(0,u$W,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),u$E(0,u$W,"templet",function(){return this._templet}),u$E(0,u$W,"player",function(){return this._player}),u$t.useSimpleMeshInCanvas=!1,u$t}(u$EW),u$V=function(u$j){function u$b(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,u$b.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}u$d(u$b,"laya.ani.bone.Templet",u$j);var u$W=u$b.prototype;return u$W.getLoadList=function(){return this._loadList},u$W.loadAni=function(u$W){this._skBufferUrl=u$W,u$bW.loader.load(u$W,u$A.create(this,this.onComplete),null,"arraybuffer")},u$W.onComplete=function(u$W){if(this._isDestroyed)this.destroy();else{var u$j=u$c.getRes(this._skBufferUrl);u$j?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,u$j)):this.event("error","load failed:"+this._skBufferUrl)}},u$W.parseData=function(u$W,u$j,u$t){void 0===u$t&&(u$t=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=u$W,this._mainTexture&&u$K.isWebGL&&u$W.bitmap&&(u$W.bitmap.enableMerageInAtlas=!1),this._rate=u$t,this.parse(u$j)},u$W.buildArmature=function(u$W){return void 0===u$W&&(u$W=0),new u$L(this,u$W)},u$W.parse=function(u$W){u$j.prototype.parse.call(this,u$W),this._endLoaded(),this._aniVersion!=u$b.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+u$b.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},u$W._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var u$W=0;this._loadList=[];var u$j,u$t=new u$GW(this.getPublicExtData()),u$d=0,u$b=0,u$E=0,u$O=u$t.getInt32(),u$q=u$t.readUTFString(),u$A=u$q.split("\n");for(u$W=0;u$W<u$O;u$W++)u$j=this._path+u$A[2*u$W],u$q=u$A[2*u$W+1],u$t.getFloat32(),u$t.getFloat32(),u$d=u$t.getFloat32(),u$b=u$t.getFloat32(),u$E=u$t.getFloat32(),isNaN(u$E)?0:u$E,u$E=u$t.getFloat32(),isNaN(u$E)?0:u$E,u$E=u$t.getFloat32(),isNaN(u$E)?u$d:u$E,u$E=u$t.getFloat32(),isNaN(u$E)?u$b:u$E,-1==this._loadList.indexOf(u$j)&&this._loadList.push(u$j);this.event("inited",this)}},u$W._textureComplete=function(){for(var u$W,u$j,u$t=0,u$d=this._loadList.length;u$t<u$d;u$t++)u$j=this._loadList[u$t],u$W=this._textureDic[u$j]=u$c.getRes(u$j),u$K.isWebGL&&u$W&&u$W.bitmap&&(u$W.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},u$W._parsePublicExtData=function(){var u$W=0,u$j=0,u$t=0,u$d=0,u$b=0;for(u$W=0,u$b=this.getAnimationCount();u$W<u$b;u$W++)this._graphicsCache.push([]);var u$E;u$E="Dragon"!=this._aniClassName;var u$O,u$q,u$A=new u$GW(this.getPublicExtData()),u$c=0,u$R=0,u$m=0,u$Q=0,u$T=0,u$$=0,u$e=0,u$K=0,u$o=0,u$S=u$A.getInt32(),u$M=u$A.readUTFString(),u$Z=u$M.split("\n");for(u$W=0;u$W<u$S;u$W++){if(u$O=this._mainTexture,u$q=this._path+u$Z[2*u$W],u$M=u$Z[2*u$W+1],null==this._mainTexture&&(u$O=this._textureDic[u$q]),!u$O)return this.event("error",this),void(this.isParseFail=!0);u$c=u$A.getFloat32(),u$R=u$A.getFloat32(),u$m=u$A.getFloat32(),u$Q=u$A.getFloat32(),u$o=u$A.getFloat32(),u$T=isNaN(u$o)?0:u$o,u$o=u$A.getFloat32(),u$$=isNaN(u$o)?0:u$o,u$o=u$A.getFloat32(),u$e=isNaN(u$o)?u$m:u$o,u$o=u$A.getFloat32(),u$K=isNaN(u$o)?u$Q:u$o,this.subTextureDic[u$M]=u$hW.create(u$O,u$c,u$R,u$m,u$Q,-u$T,-u$$,u$e,u$K),u$O.alphaTexture&&(this.subTextureDic[u$M].alphaTexture=u$hW.create(u$O.alphaTexture,u$c,u$R,u$m,u$Q,-u$T,-u$$,u$e,u$K))}this._mainTexture=u$O;var u$X,u$_,u$N,u$z,u$C,u$L=u$A.getUint16();for(u$W=0;u$W<u$L;u$W++)(u$X=[]).push(u$A.getUint16()),u$X.push(u$A.getUint16()),u$X.push(u$A.getUint16()),u$X.push(u$A.getUint16()),this.aniSectionDic[u$W]=u$X;var u$V,u$x=u$A.getInt16(),u$G={};for(u$W=0;u$W<u$x;u$W++)u$_=new u$vW,0==u$W?u$V=u$_:u$_.root=u$V,u$_.d=u$E?-1:1,u$z=u$A.readUTFString(),u$C=u$A.readUTFString(),u$_.length=u$A.getFloat32(),1==u$A.getByte()&&(u$_.inheritRotation=!1),1==u$A.getByte()&&(u$_.inheritScale=!1),u$_.name=u$z,u$C&&((u$N=u$G[u$C])?u$N.addChild(u$_):this.mRootBone=u$_),u$G[u$z]=u$_,this.mBoneArr.push(u$_);this.tMatrixDataLen=u$A.getUint16();var u$l,u$h,u$v=u$A.getUint16(),u$y=Math.floor(u$v/this.tMatrixDataLen),u$a=this.srcBoneMatrixArr;for(u$W=0;u$W<u$y;u$W++)(u$l=new u$JW).scX=u$A.getFloat32(),u$l.skX=u$A.getFloat32(),u$l.skY=u$A.getFloat32(),u$l.scY=u$A.getFloat32(),u$l.x=u$A.getFloat32(),u$l.y=u$A.getFloat32(),8===this.tMatrixDataLen&&(u$l.skewX=u$A.getFloat32(),u$l.skewY=u$A.getFloat32()),u$a.push(u$l),(u$_=this.mBoneArr[u$W]).transform=u$l;var u$u,u$D=u$A.getUint16(),u$s=0;for(u$W=0;u$W<u$D;u$W++){for(u$h=new u$HW,u$s=u$A.getUint16(),u$j=0;u$j<u$s;u$j++)u$h.boneNames.push(u$A.readUTFString()),u$h.boneIndexs.push(u$A.getInt16());u$h.name=u$A.readUTFString(),u$h.targetBoneName=u$A.readUTFString(),u$h.targetBoneIndex=u$A.getInt16(),u$h.bendDirection=u$A.getFloat32(),u$h.mix=u$A.getFloat32(),u$h.isSpine=u$E,this.ikArr.push(u$h)}var u$Y,u$H=u$A.getUint16(),u$I=0;for(u$W=0;u$W<u$H;u$W++){for(u$u=new u$UW,u$I=u$A.getUint16(),u$j=0;u$j<u$I;u$j++)u$u.boneIndexs.push(u$A.getInt16());u$u.name=u$A.getUTFString(),u$u.targetIndex=u$A.getInt16(),u$u.rotateMix=u$A.getFloat32(),u$u.translateMix=u$A.getFloat32(),u$u.scaleMix=u$A.getFloat32(),u$u.shearMix=u$A.getFloat32(),u$u.offsetRotation=u$A.getFloat32(),u$u.offsetX=u$A.getFloat32(),u$u.offsetY=u$A.getFloat32(),u$u.offsetScaleX=u$A.getFloat32(),u$u.offsetScaleY=u$A.getFloat32(),u$u.offsetShearY=u$A.getFloat32(),this.tfArr.push(u$u)}var u$g=u$A.getUint16(),u$f=0;for(u$W=0;u$W<u$g;u$W++){for((u$Y=new u$IW).name=u$A.readUTFString(),u$f=u$A.getUint16(),u$j=0;u$j<u$f;u$j++)u$Y.bones.push(u$A.getInt16());u$Y.target=u$A.readUTFString(),u$Y.positionMode=u$A.readUTFString(),u$Y.spacingMode=u$A.readUTFString(),u$Y.rotateMode=u$A.readUTFString(),u$Y.offsetRotation=u$A.getFloat32(),u$Y.position=u$A.getFloat32(),u$Y.spacing=u$A.getFloat32(),u$Y.rotateMix=u$A.getFloat32(),u$Y.translateMix=u$A.getFloat32(),this.pathArr.push(u$Y)}var u$w,u$U,u$J,u$r,u$P,u$i=0,u$B=0,u$n=0,u$k=NaN,u$p=0,u$F=u$A.getInt16();for(u$W=0;u$W<u$F;u$W++){var u$WW=u$A.getUint8(),u$jW={};this.deformAniArr.push(u$jW);for(var u$tW=0;u$tW<u$WW;u$tW++)for((u$w=new u$aW).skinName=u$A.getUTFString(),u$jW[u$w.skinName]=u$w,u$i=u$A.getInt16(),u$j=0;u$j<u$i;u$j++)for(u$U=new u$uW,u$w.deformSlotDataList.push(u$U),u$B=u$A.getInt16(),u$t=0;u$t<u$B;u$t++)for(u$J=new u$DW,u$U.deformSlotDisplayList.push(u$J),u$J.slotIndex=u$A.getInt16(),u$J.attachment=u$A.getUTFString(),u$n=u$A.getInt16(),u$d=0;u$d<u$n;u$d++)for(1==u$A.getByte()?u$J.tweenKeyList.push(!0):u$J.tweenKeyList.push(!1),u$k=u$A.getFloat32(),u$J.timeList.push(u$k),u$r=[],u$J.vectices.push(u$r),u$p=u$A.getInt16(),u$b=0;u$b<u$p;u$b++)u$r.push(u$A.getFloat32())}var u$dW,u$bW,u$EW=u$A.getInt16(),u$OW=0,u$qW=0;for(u$W=0;u$W<u$EW;u$W++){for(u$OW=u$A.getInt16(),u$P=[],u$j=0;u$j<u$OW;u$j++){for((u$dW=new u$sW).time=u$A.getFloat32(),u$qW=u$A.getInt16(),u$t=0;u$t<u$qW;u$t++)u$dW.drawOrder.push(u$A.getInt16());u$P.push(u$dW)}this.drawOrderAniArr.push(u$P)}var u$AW,u$cW=u$A.getInt16(),u$RW=0;for(u$W=0;u$W<u$cW;u$W++){for(u$RW=u$A.getInt16(),u$bW=[],u$j=0;u$j<u$RW;u$j++)(u$AW=new u$YW).name=u$A.getUTFString(),u$AW.intValue=u$A.getInt32(),u$AW.floatValue=u$A.getFloat32(),u$AW.stringValue=u$A.getUTFString(),u$AW.time=u$A.getFloat32(),u$bW.push(u$AW);this.eventAniArr.push(u$bW)}var u$mW=u$A.getInt16();if(0<u$mW)for(this.attachmentNames=[],u$W=0;u$W<u$mW;u$W++)this.attachmentNames.push(u$A.getUTFString());var u$QW,u$TW,u$$W=u$A.getInt16();for(u$W=0;u$W<u$$W;u$W++)(u$QW=new u$yW).name=u$A.readUTFString(),u$QW.parent=u$A.readUTFString(),u$QW.attachmentName=u$A.readUTFString(),u$QW.srcDisplayIndex=u$QW.displayIndex=u$A.getInt16(),(u$QW.templet=this).boneSlotDic[u$QW.name]=u$QW,null==(u$TW=this.bindBoneBoneSlotDic[u$QW.parent])&&(this.bindBoneBoneSlotDic[u$QW.parent]=u$TW=[]),u$TW.push(u$QW),this.boneSlotArray.push(u$QW);var u$eW,u$KW,u$oW,u$SW=u$A.readUTFString().split("\n"),u$MW=0,u$ZW=u$A.getUint8(),u$XW=0,u$_W=0,u$NW=0,u$zW=0,u$CW=0,u$LW=0,u$VW=0;for(u$W=0;u$W<u$ZW;u$W++){for((u$eW=new u$gW).name=u$SW[u$MW++],u$XW=u$A.getUint8(),u$j=0;u$j<u$XW;u$j++){for((u$KW=new u$wW).name=u$SW[u$MW++],u$QW=this.boneSlotDic[u$KW.name],u$_W=u$A.getUint8(),u$t=0;u$t<u$_W;u$t++){if(u$oW=new u$fW,this.skinSlotDisplayDataArr.push(u$oW),u$oW.name=u$SW[u$MW++],u$oW.attachmentName=u$SW[u$MW++],u$oW.transform=new u$JW,u$oW.transform.scX=u$A.getFloat32(),u$oW.transform.skX=u$A.getFloat32(),u$oW.transform.skY=u$A.getFloat32(),u$oW.transform.scY=u$A.getFloat32(),u$oW.transform.x=u$A.getFloat32(),u$oW.transform.y=u$A.getFloat32(),u$KW.displayArr.push(u$oW),u$oW.width=u$A.getFloat32(),u$oW.height=u$A.getFloat32(),u$oW.type=u$A.getUint8(),u$oW.verLen=u$A.getUint16(),0<(u$x=u$A.getUint16()))for(u$oW.bones=[],u$d=0;u$d<u$x;u$d++){var u$xW=u$A.getUint16();u$oW.bones.push(u$xW)}if(0<(u$NW=u$A.getUint16()))for(u$oW.uvs=[],u$d=0;u$d<u$NW;u$d++)u$oW.uvs.push(u$A.getFloat32());if(0<(u$zW=u$A.getUint16()))for(u$oW.weights=[],u$d=0;u$d<u$zW;u$d++)u$oW.weights.push(u$A.getFloat32());if(0<(u$CW=u$A.getUint16()))for(u$oW.triangles=[],u$d=0;u$d<u$CW;u$d++)u$oW.triangles.push(u$A.getUint16());if(0<(u$LW=u$A.getUint16()))for(u$oW.vertices=[],u$d=0;u$d<u$LW;u$d++)u$oW.vertices.push(u$A.getFloat32());if(0<(u$VW=u$A.getUint16()))for(u$oW.lengths=[],u$d=0;u$d<u$VW;u$d++)u$oW.lengths.push(u$A.getFloat32())}u$eW.slotArr.push(u$KW)}this.skinDic[u$eW.name]=u$eW,this.skinDataArray.push(u$eW)}1==u$A.getUint8()?(this.yReverseMatrix=new u$lW(1,0,0,-1,0,0),u$V&&u$V.setTempMatrix(this.yReverseMatrix)):u$V&&u$V.setTempMatrix(new u$lW),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},u$W.getTexture=function(u$W){var u$j=this.subTextureDic[u$W];return u$j||(u$j=this.subTextureDic[u$W.substr(0,u$W.length-1)]),null==u$j?this._mainTexture:u$j},u$W.showSkinByIndex=function(u$W,u$j,u$t){if(void 0===u$t&&(u$t=!0),u$j<0&&u$j>=this.skinDataArray.length)return!1;var u$d,u$b,u$E=0,u$O=0,u$q=this.skinDataArray[u$j];if(u$q){for(u$E=0,u$O=u$q.slotArr.length;u$E<u$O;u$E++)(u$b=u$q.slotArr[u$E])&&(u$d=u$W[u$b.name])&&(u$d.showSlotData(u$b,u$t),u$t&&"undefined"!=u$d.attachmentName&&"null"!=u$d.attachmentName?u$d.showDisplayByName(u$d.attachmentName):u$d.showDisplayByIndex(u$d.displayIndex));return!0}return!1},u$W.getSkinIndexByName=function(u$W){for(var u$j=0,u$t=this.skinDataArray.length;u$j<u$t;u$j++)if(this.skinDataArray[u$j].name==u$W)return u$j;return-1},u$W.getGrahicsDataWithCache=function(u$W,u$j){return this._graphicsCache[u$W][u$j]},u$W.setGrahicsDataWithCache=function(u$W,u$j,u$t){this._graphicsCache[u$W][u$j]=u$t},u$W.destroy=function(){var u$W;for(var u$j in this._isDestroyed=!0,this.subTextureDic)(u$W=this.subTextureDic[u$j])&&u$W.destroy();for(u$j in this._textureDic)(u$W=this._textureDic[u$j])&&u$W.destroy();for(var u$t=0,u$d=this.skinSlotDisplayDataArr.length;u$t<u$d;u$t++)this.skinSlotDisplayDataArr[u$t].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete u$b.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},u$W.getAniNameByIndex=function(u$W){var u$j=this.getAnimation(u$W);return u$j?u$j.name:null},u$E(0,u$W,"rate",function(){return this._rate},function(u$W){this._rate=u$W}),u$b.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",u$b.TEMPLET_DICTIONARY=null,u$b}(u$a)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(u$W,u$j){"use strict";for(var u$t in Object.defineProperty(u$j,"__esModule",{value:!0}),Laya){var u$d=Laya[u$t];u$d&&u$d.__isclass&&(u$j[u$t]=u$d)}});