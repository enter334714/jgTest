var Laya=window.Laya=function(Gj,Ga){var Gk={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(Ga,Gb){return 1==arguments.length?Gk.__presubstr.call(this,Ga):Gk.__presubstr.call(this,Ga,0<Gb?Gb:this.length+Gb)},__init:function(Ga){Ga.forEach(function(Ga){Ga.__init$&&Ga.__init$()})},__isClass:function(Ga){return Ga&&(Ga.__isclass||Ga==Object||Ga==String||Ga==Array)},__newvec:function(Ga,Gb){var Gc=[];Gc.length=Ga;for(var Gd=0;Gd<Ga;Gd++)Gc[Gd]=Gb;return Gc},__extend:function(Ga,Gb){for(var Gc in Gb)if(Gb.hasOwnProperty(Gc)){var Gd=Object.getOwnPropertyDescriptor(Gb,Gc),Ge=Gd.get,Gf=Gd.set;Ge||Gf?Ge&&Gf?Object.defineProperty(Ga,Gc,Gd):(Ge&&Object.defineProperty(Ga,Gc,Ge),Gf&&Object.defineProperty(Ga,Gc,Gf)):Ga[Gc]=Gb[Gc]}function Gg(){Gk.un(this,"constructor",Ga)}Gg.prototype=Gb.prototype,Ga.prototype=new Gg,Gk.un(Ga.prototype,"__imps",Gk.__copy({},Gb.prototype.__imps))},__copy:function(Ga,Gb){if(!Gb)return null;for(var Gc in Ga=Ga||{},Gb)Ga[Gc]=Gb[Gc];return Ga},__package:function(Ga,Gb){if(!Gk.__packages[Ga]){Gk.__packages[Ga]=!0;var Gc=Gj,Gd=Ga.split(".");if(1<Gd.length)for(var Ge=0,Gf=Gd.length-1;Ge<Gf;Ge++){var Gg=Gc[Gd[Ge]];Gc=Gg||(Gc[Gd[Ge]]={})}Gc[Gd[Gd.length-1]]||(Gc[Gd[Gd.length-1]]=Gb||{})}},__hasOwnProperty:function(Ga,Gb){return Gb=Gb||this,Object.hasOwnProperty.call(Gb,Ga)||function Ga(Gb,Gc){if(Object.hasOwnProperty.call(Gc.prototype,Gb))return!0;var Gd=Gc.prototype.__super;return null==Gd?null:Ga(Gb,Gd)}(Ga,Gb.__class)},__typeof:function(Ga,Gb){if(!Ga||!Gb)return!1;if(Gb===String)return"string"==typeof Ga;if(Gb===Number)return"number"==typeof Ga;if(Gb.__interface__)Gb=Gb.__interface__;else if("string"!=typeof Gb)return Ga instanceof Gb;return Ga.__imps&&Ga.__imps[Gb]||Ga.__class==Gb},__as:function(Ga,Gb){return this.__typeof(Ga,Gb)?Ga:null},__int:function(Ga){return Ga?parseInt(Ga):0},interface:function(Ga,Gb){Gk.__package(Ga,{});var Gc=Gk.__internals,Gd=Gc[Ga]=Gc[Ga]||{self:Ga};if(Gb){var Ge=Gb.split(",");Gd.extend=[];for(var Gf=0;Gf<Ge.length;Gf++){var Gg=Ge[Gf];Gc[Gg]=Gc[Gg]||{self:Gg},Gd.extend.push(Gc[Gg])}}var Gh=Gj,Gi=Ga.split(".");for(Gf=0;Gf<Gi.length-1;Gf++)Gh=Gh[Gi[Gf]];Gh[Gi[Gi.length-1]]={__interface__:Ga}},class:function(Ga,Gb,Gc,Gd){if(Gc&&Gk.__extend(Ga,Gc),Gb)if(Gk.__package(Gb,Ga),Gk.__classmap[Gb]=Ga,0<Gb.indexOf(".")){if(0==Gb.indexOf("laya.")){var Ge=Gb.split(".");Gd=Gd||Ge[Ge.length-1],Gk[Gd]&&console.log("Warning!,this class["+Gd+"] already exist:",Gk[Gd]),Gk[Gd]=Ga}}else"Main"==Gb?Gj.Main=Ga:"MainWX"==Gb?Gj.MainWX=Ga:(Gk[Gb]&&console.log("Error!,this class["+Gb+"] already exist:",Gk[Gb]),Gk[Gb]=Ga);var Gf=Gk.un,Gg=Ga.prototype;Gf(Gg,"hasOwnProperty",Gk.__hasOwnProperty),Gf(Gg,"__class",Ga),Gf(Gg,"__super",Gc),Gf(Gg,"__className",Gb),Gf(Ga,"__super",Gc),Gf(Ga,"__className",Gb),Gf(Ga,"__isclass",!0),Gf(Ga,"super",function(Ga){this.__super.call(Ga)})},imps:function(Ga,Gb){if(!Gb)return null;var Ge=Ga.__imps||Gk.un(Ga,"__imps",{});function Gf(Ga){var Gb,Gc;if((Gb=Gk.__internals[Ga])&&(Ge[Ga]=!0,Gc=Gb.extend))for(var Gd=0;Gd<Gc.length;Gd++)Gf(Gc[Gd].self)}for(var Gc in Gb)Gf(Gc)},superSet:function(Ga,Gb,Gc,Gd){var Ge=Ga.prototype["_$set_"+Gc];Ge&&Ge.call(Gb,Gd)},superGet:function(Ga,Gb,Gc){var Gd=Ga.prototype["_$get_"+Gc];return Gd?Gd.call(Gb):null},getset:function(Ga,Gb,Gc,Gd,Ge){Ga?(Gd&&(Gb["_$GET_"+Gc]=Gd),Ge&&(Gb["_$SET_"+Gc]=Ge)):(Gd&&Gk.un(Gb,"_$get_"+Gc,Gd),Ge&&Gk.un(Gb,"_$set_"+Gc,Ge)),Gd&&Ge?Object.defineProperty(Gb,Gc,{get:Gd,set:Ge,enumerable:!1,configurable:!0}):(Gd&&Object.defineProperty(Gb,Gc,{get:Gd,enumerable:!1,configurable:!0}),Ge&&Object.defineProperty(Gb,Gc,{set:Ge,enumerable:!1,configurable:!0}))},static:function(Gc,Gd){for(var Ge=0,Ga=Gd.length;Ge<Ga;Ge+=2)if("length"==Gd[Ge])Gc.length=Gd[Ge+1].call(Gc);else{function Gb(){var Gb=Gd[Ge],Ga=Gd[Ge+1];Object.defineProperty(Gc,Gb,{get:function(){return delete this[Gb],this[Gb]=Ga.call(this)},set:function(Ga){delete this[Gb],this[Gb]=Ga},enumerable:!0,configurable:!0})}Gb()}},un:function(Ga,Gb,Gc){return Gc||(Gc=Ga[Gb]),Gk.__propun.value=Gc,Object.defineProperty(Ga,Gb,Gk.__propun),Gc},uns:function(Gb,Ga){Ga.forEach(function(Ga){Gk.un(Gb,Ga)})}};return Gj.console=Gj.console||{log:function(){}},Gj.trace=Gj.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),Gk}(window,document);!function(Ga,Gb,Gc){Gc.un,Gc.uns,Gc.static,Gc.class,Gc.getset,Gc.__newvec}(window,document,Laya),function(Gg,Gb,Gz){Gz.un,Gz.uns;var Gi=Gz.static,Gr=Gz.class,Gk=Gz.getset;Gz.__newvec;Gz.interface("laya.runtime.IMarket"),Gz.interface("laya.filters.IFilter"),Gz.interface("laya.display.ILayout"),Gz.interface("laya.resource.IDispose"),Gz.interface("laya.runtime.IPlatform"),Gz.interface("laya.resource.IDestroy"),Gz.interface("laya.runtime.IConchNode"),Gz.interface("laya.filters.IFilterAction"),Gz.interface("laya.runtime.ICPlatformClass"),Gz.interface("laya.resource.ICreateResource"),Gz.interface("laya.runtime.IConchRenderObject"),Gz.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var GF=function(){function Gf(){}return Gr(Gf,"laya.utils.RunDriver"),Gf.FILTER_ACTIONS=[],Gf.pixelRatio=-1,Gf._charSizeTestDiv=null,Gf.now=function(){return Date.now()},Gf.getWindow=function(){return Gg},Gf.getPixelRatio=function(){if(Gf.pixelRatio<0){var Ga=GO.context,Gb=Ga.backingStorePixelRatio||Ga.webkitBackingStorePixelRatio||Ga.mozBackingStorePixelRatio||Ga.msBackingStorePixelRatio||Ga.oBackingStorePixelRatio||Ga.backingStorePixelRatio||1;(Gf.pixelRatio=(GO.window.devicePixelRatio||1)/Gb)<1&&(Gf.pixelRatio=1)}return Gf.pixelRatio},Gf.getIncludeStr=function(Ga){return null},Gf.createShaderCondition=function(Ga){var Gb="(function() {return "+Ga+";})";return Gz._runScript(Gb)},Gf.fontMap=[],Gf.measureText=function(Ga,Gb){var Gc=Gf.hanzi.test(Ga);if(Gc&&Gf.fontMap[Gb])return Gf.fontMap[Gb];var Gd=GO.context;Gd.font=Gb;var Ge=Gd.measureText(Ga);return Gc&&(Gf.fontMap[Gb]=Ge),Ge},Gf.getWebGLContext=function(Ga){},Gf.beginFlush=function(){},Gf.endFinish=function(){},Gf.addToAtlas=null,Gf.flashFlushImage=function(Ga){},Gf.drawToCanvas=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=Gva.create("2D"),Gh=new GK(Gc,Gd,Gg);return GL.renders[Gb]._fun(Ga,Gh,Ge,Gf),Gg},Gf.createParticleTemplate2D=null,Gf.createGLTextur=null,Gf.createWebGLContext2D=null,Gf.changeWebGLSize=function(Ga,Gb){},Gf.createRenderSprite=function(Ga,Gb){return new GL(Ga,Gb)},Gf.createFilterAction=function(Ga){return new Gv},Gf.createGraphics=function(){return new Go},Gf.clear=function(Ga){GJ._context.ctx.clear()},Gf.cancelLoadByUrl=function(Ga){},Gf.clearAtlas=function(Ga){},Gf.isAtlas=function(Ga){return!1},Gf.addTextureToAtlas=function(Ga){},Gf.getTexturePixels=function(Ga,Gb,Gc,Gd,Ge){return null},Gf.skinAniSprite=function(){return null},Gf.update3DLoop=function(){},Gi(Gf,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),Gf}(),Gd=(Gk(1,Gz,"alertGlobalError",null,function(Ga){var Gf=0;GO.window.onerror=Ga?function(Ga,Gb,Gc,Gd,Ge){Gf++<5&&Ge&&alert(Ge.stack||Ge)}:null}),Gz.init=function(Ga,Gb,Gc){for(var Gd=[],Ge=2,Gf=arguments.length;Ge<Gf;Ge++)Gd.push(arguments[Ge]);if(!Gz._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=Gz._arrayBufferSlice),Gz._isinit=!0,GO.__init__(),GM.__init__(),Go.__init__(),Gz.timer=new GY,Gz.scaleTimer=new GY,Gz.loader=new Gia,Gm.__init__(),Ge=0;for(var Gg=Gd.length;Ge<Gg;Ge++)Gd[Ge].enable&&Gd[Ge].enable();return Gp.__init__(),Gh.__init__(),GN.__init__(),GQ.beginCheck(),Gz._currentStage=Gz.stage=new Gta,Gz.stage.conchModel&&Gz.stage.conchModel.setRootNode(),Gz._getUrlPath(),Gz.render=new GJ(0,0),Gz.stage.size(Ga,Gb),GL.__init__(),Gl.__init__(),Gq.instance.__init__(Gz.stage,GJ.canvas),Gxa.__init__(),GE.autoStopMusic=!0,GC.__init__(),GJ.canvas}},Gz._getUrlPath=function(){var Ga=GO.window.location,Gb=Ga.pathname;Gb=Gb&&":"==Gb.charAt(2)?Gb.substring(1):Gb,GI.rootPath=GI.basePath=GI.getPath("file:"==Ga.protocol?Gb:Ga.protocol+"//"+Ga.host+Ga.pathname)},Gz._arrayBufferSlice=function(Ga,Gb){var Gc=new Uint8Array(this,Ga,Gb-Ga),Gd=new Uint8Array(Gc.length);return Gd.set(Gc),Gd.buffer},Gz._runScript=function(Ga){return GO.window[Gz._evcode](Ga)},Gz.stage=null,Gz.timer=null,Gz.scaleTimer=null,Gz.loader=null,Gz.version="1.8.6",Gz.render=null,Gz._currentStage=null,Gz._isinit=!1,Gz.isDebug=!1,Gz.MiniAdpter={init:function(){Gg.navigator&&Gg.navigator.userAgent&&-1<Gg.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},Gi(Gz,["conchMarket",function(){return this.conchMarket=Gg.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=Gg.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function Ga(){}return Gr(Ga,"Config"),Ga.WebGLTextCacheCount=500,Ga.atlasEnable=!1,Ga.showCanvasMark=!1,Ga.animationInterval=50,Ga.isAntialias=!1,Ga.isAlpha=!1,Ga.premultipliedAlpha=!0,Ga.isStencil=!0,Ga.preserveDrawingBuffer=!1,Ga}()),Gj=function(){function Gj(){this._events=null}Gr(Gj,"laya.events.EventDispatcher");var Ga=Gj.prototype;return Ga.hasListener=function(Ga){return!!(this._events&&this._events[Ga])},Ga.event=function(Ga,Gb){if(!this._events||!this._events[Ga])return!1;var Gc=this._events[Ga];if(Gc.lock)Gc.queue||(Gc.queue=[]),Gc.queue.push(Gb);else{var Gd;for(Gc.lock=!0,Gc.cursor=Gc.head;Gc.cursor;)Gd=Gc.cursor,Gc.cursor=Gd.next,Gd.once&&Gj.delNode(Gc,Gd),null!=Gb?Gd.args?Gd.method.apply(Gd.caller,Gd.args.concat(Gb)):Gb instanceof Array?Gd.method.apply(Gd.caller,Gb):Gd.method.call(Gd.caller,Gb):Gd.method.apply(Gd.caller,Gd.args),Gd.once&&Gj.recoverHandler(Gd);Gc.lock=!1,!Gc.head&&this._events&&this._events[Ga]==Gc&&delete this._events[Ga],Gc.queue&&Gc.queue.length&&this.event(Ga,Gc.queue.shift())}return!0},Ga.on=function(Ga,Gb,Gc,Gd){return this._createListener(Ga,Gb,Gc,Gd,!1)},Ga.once=function(Ga,Gb,Gc,Gd){return this._createListener(Ga,Gb,Gc,Gd,!0)},Ga._createListener=function(Ga,Gb,Gc,Gd,Ge,Gf){void 0===Gf&&(Gf=!0),Gf&&this.off(Ga,Gb,Gc,Ge);var Gg=Gj.createHandler(Gb||this,Gc,Gd,Ge);this._events||(this._events={});var Gh=this._events,Gi=Gh[Ga];return Gi?Gi.tail?(Gg.prev=Gi.tail,Gi.tail.next=Gg,Gi.tail=Gg):Gi.head=Gi.tail=Gg:Gh[Ga]={head:Gg,tail:Gg,cursor:null,lock:!1},this},Ga.off=function(Ga,Gb,Gc,Gd){if(void 0===Gd&&(Gd=!1),!this._events||!this._events[Ga])return this;for(var Ge=this._events[Ga],Gf=Ge.head;Gf;){if((!Gb||Gf.caller===Gb)&&Gf.method===Gc&&(!Gd||Gf.once)){Gj.delNode(Ge,Gf),Ge.cursor==Gf&&(Ge.cursor=Gf.next),Gj.recoverHandler(Gf);break}Gf=Gf.next}return this},Ga.offAll=function(Ga){var Gb=this._events;if(!Gb)return this;if(Ga)this._recoverHandlers(Gb[Ga]),delete Gb[Ga];else{for(var Gc in Gb)this._recoverHandlers(Gb[Gc]);this._events=null}return this},Ga._recoverHandlers=function(Ga){if(Ga){for(var Gb=Ga.head;Gb;){Gj.delNode(Ga,Gb);var Gc=Gb.next;Gj.recoverHandler(Gb),Gb=Gc}Ga.cursor=null}},Ga.isMouseEvent=function(Ga){return Gj.MOUSE_EVENTS[Ga]},Gj.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},Gj.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},Gj.delNode=function(Ga,Gb){Gb.prev?Gb.prev.next=Gb.next:Ga.head=Gb.next,Gb.next?Gb.next.prev=Gb.prev:Ga.tail=Gb.prev},Gj.createHandler=function(Ga,Gb,Gc,Gd){var Ge=Gj._freeHandler;return Ge?(Gj._freeCount--,Gj._freeHandler=Ge.next,Ge.caller=Ga,Ge.method=Gb,Ge.args=Gc,Ge.once=Gd):Ge={caller:Ga,method:Gb,args:Gc,once:Gd},Ge.prev=Ge.next=null,Ge},Gj.recoverHandler=function(Ga){Ga.caller=Ga.method=Ga.args=Ga.prev=null,Ga.next=Gj._freeHandler,Gj._freeHandler=Ga,Gj._freeCount++},Gj._freeHandler=null,Gj._freeCount=0,Gj}(),Gu=function(){function Ge(Ga,Gb,Gc,Gd){this.once=!1,void(this._id=0)===Gd&&(Gd=!1),this.setTo(Ga,Gb,Gc,Gd)}Gr(Ge,"laya.utils.Handler");var Ga=Ge.prototype;return Ga.setTo=function(Ga,Gb,Gc,Gd){return this._id=Ge._gid++,this.caller=Ga,this.method=Gb,this.args=Gc,this.once=Gd,this},Ga.run=function(){if(null==this.method)return null;var Ga=this._id,Gb=this.method.apply(this.caller,this.args);return this._id===Ga&&this.once&&this.recover(),Gb},Ga.runWith=function(Ga){if(null==this.method)return null;var Gb=this._id;if(null==Ga)var Gc=this.method.apply(this.caller,this.args);else Gc=this.args||Ga.unshift?this.args?this.method.apply(this.caller,this.args.concat(Ga)):this.method.apply(this.caller,Ga):this.method.call(this.caller,Ga);return this._id===Gb&&this.once&&this.recover(),Gc},Ga.clear=function(){return this.caller=null,this.method=null,this.args=null,this},Ga.recover=function(){0<this._id&&(this._id=0,this.clear())},Ge.create=function(Ga,Gb,Gc,Gd){return void 0===Gd&&(Gd=!0),new Ge(Ga,Gb,Gc,Gd)},Ge._gid=1,Ge}(),GD=function(){function Ga(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}Gr(Ga,"laya.display.BitmapFont");var Gb=Ga.prototype;return Gb.loadFont=function(Ga,Gb){this._path=Ga,this._complete=Gb,Gz.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],Gu.create(this,this.onLoaded))},Gb.onLoaded=function(){this.parseFont(Gha.getRes(this._path),Gha.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},Gb.parseFont=function(Ga,Gb){if(null!=Ga&&null!=Gb){this._texture=Gb;var Gc=Ga.getElementsByTagName("info");if(!Gc[0].getAttributeNode)return this.parseFont2(Ga,Gb);this.fontSize=parseInt(Gc[0].getAttributeNode("size").nodeValue);var Gd,Ge=Gc[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(Ge[0]),parseInt(Ge[1]),parseInt(Ge[2]),parseInt(Ge[3])],Gd=Ga.getElementsByTagName("char");var Gf=0;for(Gf=0;Gf<Gd.length;Gf++){var Gg=Gd[Gf],Gh=parseInt(Gg.getAttributeNode("id").nodeValue),Gi=parseInt(Gg.getAttributeNode("xoffset").nodeValue)/1,Gj=parseInt(Gg.getAttributeNode("yoffset").nodeValue)/1,Gk=parseInt(Gg.getAttributeNode("xadvance").nodeValue)/1,Gl=new GB;Gl.x=parseInt(Gg.getAttributeNode("x").nodeValue),Gl.y=parseInt(Gg.getAttributeNode("y").nodeValue),Gl.width=parseInt(Gg.getAttributeNode("width").nodeValue),Gl.height=parseInt(Gg.getAttributeNode("height").nodeValue);var Go=Gka.create(Gb,Gl.x,Gl.y,Gl.width,Gl.height,Gi,Gj);this._maxWidth=Math.max(this._maxWidth,Gk+this.letterSpacing),this._fontCharDic[Gh]=Go,this._fontWidthMap[Gh]=Gk}}},Gb.parseFont2=function(Ga,Gb){if(null!=Ga&&null!=Gb){this._texture=Gb;var Gc=Ga.getElementsByTagName("info");this.fontSize=parseInt(Gc[0].attributes.size.nodeValue);var Gd=Gc[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(Gd[0]),parseInt(Gd[1]),parseInt(Gd[2]),parseInt(Gd[3])];var Ge=Ga.getElementsByTagName("char"),Gf=0;for(Gf=0;Gf<Ge.length;Gf++){var Gg=Ge[Gf].attributes,Gh=parseInt(Gg.id.nodeValue),Gi=parseInt(Gg.xoffset.nodeValue)/1,Gj=parseInt(Gg.yoffset.nodeValue)/1,Gk=parseInt(Gg.xadvance.nodeValue)/1,Gl=new GB;Gl.x=parseInt(Gg.x.nodeValue),Gl.y=parseInt(Gg.y.nodeValue),Gl.width=parseInt(Gg.width.nodeValue),Gl.height=parseInt(Gg.height.nodeValue);var Go=Gka.create(Gb,Gl.x,Gl.y,Gl.width,Gl.height,Gi,Gj);this._maxWidth=Math.max(this._maxWidth,Gk+this.letterSpacing),this._fontCharDic[Gh]=Go,this._fontWidthMap[Gh]=Gk}}},Gb.getCharTexture=function(Ga){return this._fontCharDic[Ga.charCodeAt(0)]},Gb.destroy=function(){if(this._texture){for(var Ga in this._fontCharDic){var Gb=this._fontCharDic[Ga];Gb&&Gb.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},Gb.setSpaceWidth=function(Ga){this._spaceWidth=Ga},Gb.getCharWidth=function(Ga){var Gb=Ga.charCodeAt(0);return this._fontWidthMap[Gb]?this._fontWidthMap[Gb]+this.letterSpacing:" "==Ga?this._spaceWidth+this.letterSpacing:0},Gb.getTextWidth=function(Ga){for(var Gb=0,Gc=0,Gd=Ga.length;Gc<Gd;Gc++)Gb+=this.getCharWidth(Ga.charAt(Gc));return Gb},Gb.getMaxWidth=function(){return this._maxWidth},Gb.getMaxHeight=function(){return this.fontSize},Gb.drawText=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg,Gh=this.getTextWidth(Ga),Gi=0;"center"===Ge&&(Gi=(Gf-Gh)/2),"right"===Ge&&(Gi=Gf-Gh);for(var Gj=0,Gk=0,Gl=Ga.length;Gk<Gl;Gk++)(Gg=this.getCharTexture(Ga.charAt(Gk)))&&(Gb.graphics.drawTexture(Gg,Gc+Gj+Gi,Gd),Gj+=this.getCharWidth(Ga.charAt(Gk)))},Ga}(),Gh=function(){function Gc(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=Gc._TF_EMPTY}Gr(Gc,"laya.display.css.Style");var Ga=Gc.prototype;return Ga.getTransform=function(){return this._tf},Ga.setTransform=function(Ga){this._tf="none"!==Ga&&Ga?Ga:Gc._TF_EMPTY},Ga.setTranslateX=function(Ga){this._tf===Gc._TF_EMPTY&&(this._tf=new Ge),this._tf.translateX=Ga},Ga.setTranslateY=function(Ga){this._tf===Gc._TF_EMPTY&&(this._tf=new Ge),this._tf.translateY=Ga},Ga.setScaleX=function(Ga){this._tf===Gc._TF_EMPTY&&(this._tf=new Ge),this._tf.scaleX=Ga},Ga.setScale=function(Ga,Gb){this._tf===Gc._TF_EMPTY&&(this._tf=new Ge),this._tf.scaleX=Ga,this._tf.scaleY=Gb},Ga.setScaleY=function(Ga){this._tf===Gc._TF_EMPTY&&(this._tf=new Ge),this._tf.scaleY=Ga},Ga.setRotate=function(Ga){this._tf===Gc._TF_EMPTY&&(this._tf=new Ge),this._tf.rotate=Ga},Ga.setSkewX=function(Ga){this._tf===Gc._TF_EMPTY&&(this._tf=new Ge),this._tf.skewX=Ga},Ga.setSkewY=function(Ga){this._tf===Gc._TF_EMPTY&&(this._tf=new Ge),this._tf.skewY=Ga},Ga.destroy=function(){this.scrollRect=null},Ga.render=function(Ga,Gb,Gc,Gd){},Ga.getCSSStyle=function(){return Gba.EMPTY},Ga._enableLayout=function(){return!1},Gk(0,Ga,"scaleX",function(){return this._tf.scaleX},function(Ga){this.setScaleX(Ga)}),Gk(0,Ga,"transform",function(){return this.getTransform()},function(Ga){this.setTransform(Ga)}),Gk(0,Ga,"translateX",function(){return this._tf.translateX},function(Ga){this.setTranslateX(Ga)}),Gk(0,Ga,"translateY",function(){return this._tf.translateY},function(Ga){this.setTranslateY(Ga)}),Gk(0,Ga,"scaleY",function(){return this._tf.scaleY},function(Ga){this.setScaleY(Ga)}),Gk(0,Ga,"block",function(){return 0!=(1&this._type)}),Gk(0,Ga,"skewY",function(){return this._tf.skewY},function(Ga){this.setSkewY(Ga)}),Gk(0,Ga,"rotate",function(){return this._tf.rotate},function(Ga){this.setRotate(Ga)}),Gk(0,Ga,"skewX",function(){return this._tf.skewX},function(Ga){this.setSkewX(Ga)}),Gk(0,Ga,"paddingLeft",function(){return 0}),Gk(0,Ga,"paddingTop",function(){return 0}),Gk(0,Ga,"absolute",function(){return!0}),Gc.__init__=function(){Gc._TF_EMPTY=new Ge,Gc.EMPTY=new Gc},Gc.EMPTY=null,Gc._TF_EMPTY=null,Gc}(),Gp=function(){function Gb(Ga){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=GS.create(Gb.defaultColor),this.family=Gb.defaultFamily,this.stroke=Gb._STROKE,this.size=Gb.defaultSize,Ga&&Ga!==Gb.EMPTY&&Ga.copyTo(this)}Gr(Gb,"laya.display.css.Font");var Ga=Gb.prototype;return Ga.set=function(Ga){this._text=null;for(var Gb=Ga.split(" "),Gc=0,Gd=Gb.length;Gc<Gd;Gc++){var Ge=Gb[Gc];switch(Ge){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<Ge.indexOf("px")&&(this.size=parseInt(Ge),this.family=Gb[Gc+1],Gc++)}},Ga.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},Ga.copyTo=function(Ga){Ga._type=this._type,Ga._text=this._text,Ga._weight=this._weight,Ga._color=this._color,Ga.family=this.family,Ga.stroke=this.stroke!=Gb._STROKE?this.stroke.slice():Gb._STROKE,Ga.indent=this.indent,Ga.size=this.size},Gk(0,Ga,"password",function(){return 0!=(1024&this._type)},function(Ga){Ga?this._type|=1024:this._type&=-1025}),Gk(0,Ga,"color",function(){return this._color.strColor},function(Ga){this._color=GS.create(Ga)}),Gk(0,Ga,"italic",function(){return 0!=(512&this._type)},function(Ga){Ga?this._type|=512:this._type&=-513}),Gk(0,Ga,"bold",function(){return 0!=(2048&this._type)},function(Ga){Ga?this._type|=2048:this._type&=-2049}),Gk(0,Ga,"weight",function(){return""+this._weight},function(Ga){var Gb=0;switch(Ga){case"normal":break;case"bold":this.bold=!0,Gb=700;break;case"bolder":Gb=800;break;case"lighter":Gb=100;break;default:Gb=parseInt(Ga)}this._weight=Gb,this._text=null}),Gk(0,Ga,"decoration",function(){return this._decoration?this._decoration.value:null},function(Ga){var Gb=Ga.split(" ");switch(this._decoration||(this._decoration={}),Gb[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=Gb[0]}Gb[1]&&(this._decoration.color=GS.create(Gb)),this._decoration.value=Ga}),Gb.__init__=function(){Gb.EMPTY=new Gb(null)},Gb.EMPTY=null,Gb.defaultColor="#000000",Gb.defaultSize=12,Gb.defaultFamily="Arial",Gb.defaultFont="12px Arial",Gb._STROKE=[0,"#000000"],Gb._ITALIC=512,Gb._PASSWORD=1024,Gb._BOLD=2048,Gb}(),Ge=function(){function Ga(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return Gr(Ga,"laya.display.css.TransformInfo"),Ga}(),Go=function(){function Gl(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,GJ.isConchNode){this._nativeObj=new Gg._conchGraphics,this.id=this._nativeObj.conchID}}Gr(Gl,"laya.display.Graphics");var Ga=Gl.prototype;return Ga.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},Ga.clear=function(Ga){void 0===Ga&&(Ga=!1);var Gb=0,Gc=0;if(Ga){var Gd=this._one;if(this._cmds){for(Gc=this._cmds.length,Gb=0;Gb<Gc;Gb++)!(Gd=this._cmds[Gb])||Gd.callee!==GJ._context._drawTexture&&Gd.callee!==GJ._context._drawTextureWithTransform||(Gd[0]=null,Gl._cache.push(Gd));this._cmds.length=0}else Gd&&(!Gd||Gd.callee!==GJ._context._drawTexture&&Gd.callee!==GJ._context._drawTextureWithTransform||(Gd[0]=null,Gl._cache.push(Gd)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(Gb=0,Gc=this._vectorgraphArray.length;Gb<Gc;Gb++)G_.getInstance().deleteShape(this._vectorgraphArray[Gb]);this._vectorgraphArray.length=0}},Ga._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},Ga._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new Gc,this._graphicBounds._graphics=this)},Ga._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},Ga._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},Ga.getBounds=function(Ga){return void 0===Ga&&(Ga=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(Ga)},Ga.getBoundPoints=function(Ga){return void 0===Ga&&(Ga=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(Ga)},Ga._addCmd=function(Ga){this._cmds=this._cmds||[],Ga.callee=Ga.shift(),this._cmds.push(Ga)},Ga.setFilters=function(Ga){this._saveToCmd(GJ._context._setFilters,Ga)},Ga.drawTexture=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){if(void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=0),void 0===Ge&&(Ge=0),void 0===Gg&&(Gg=1),!Ga||Gg<.01)return null;Gd||(Gd=Ga.sourceWidth),Ge||(Ge=Ga.sourceHeight),Gg=Gg<0?0:1<Gg?1:Gg;var Gh,Gi=!GJ.isWebGL&&(GO.onFirefox||GO.onEdge||GO.onIE||GO.onSafari)?.5:0,Gj=Gd/Ga.sourceWidth,Gk=Ge/Ga.sourceHeight;return Gd=Ga.width*Gj,Ge=Ga.height*Gk,Ga.loaded&&(Gd<=0||Ge<=0)?null:(Gb+=Ga.offsetX*Gj,Gc+=Ga.offsetY*Gk,this._sp&&(this._sp._renderType|=512),Gb-=Gi,Gc-=Gi,Gd+=2*Gi,Ge+=2*Gi,Gl._cache.length?((Gh=Gl._cache.pop())[0]=Ga,Gh[1]=Gb,Gh[2]=Gc,Gh[3]=Gd,Gh[4]=Ge,Gh[5]=Gf,Gh[6]=Gg):Gh=[Ga,Gb,Gc,Gd,Ge,Gf,Gg],Gh.callee=Gf||1!=Gg?GJ._context._drawTextureWithTransform:GJ._context._drawTexture,null!=this._one||Gf||1!=Gg?this._saveToCmd(Gh.callee,Gh):(this._one=Gh,this._render=this._renderOneImg),Ga.loaded||Ga.once("loaded",this,this._textureLoaded,[Ga,Gh]),this._repaint(),Gh)},Ga.cleanByTexture=function(Ga,Gb,Gc,Gd,Ge){if(void 0===Gd&&(Gd=0),void 0===Ge&&(Ge=0),!Ga)return this.clear();if(this._one&&this._render===this._renderOneImg){Gd||(Gd=Ga.sourceWidth),Ge||(Ge=Ga.sourceHeight);var Gf=Gd/Ga.sourceWidth,Gg=Ge/Ga.sourceHeight;Gd=Ga.width*Gf,Ge=Ga.height*Gg,Gb+=Ga.offsetX*Gf,Gc+=Ga.offsetY*Gg,this._one[0]=Ga,this._one[1]=Gb,this._one[2]=Gc,this._one[3]=Gd,this._one[4]=Ge,this._repaint()}else this.clear(),Ga&&this.drawTexture(Ga,Gb,Gc,Gd,Ge)},Ga.drawTextures=function(Ga,Gb){Ga&&this._saveToCmd(GJ._context._drawTextures,[Ga,Gb])},Ga.fillTexture=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){if(void 0===Gd&&(Gd=0),void 0===Ge&&(Ge=0),void 0===Gf&&(Gf="repeat"),Ga){var Gh=[Ga,Gb,Gc,Gd,Ge,Gf,Gg||GA.EMPTY,{}];Ga.loaded||Ga.once("loaded",this,this._textureLoaded,[Ga,Gh]),this._saveToCmd(GJ._context._fillTexture,Gh)}},Ga._textureLoaded=function(Ga,Gb){Gb[3]=Gb[3]||Ga.width,Gb[4]=Gb[4]||Ga.height,this._repaint()},Ga.fillCircle=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){Gc.bitmap.enableMerageInAtlas=!1;var Gh=new Float32Array(2*(Gg+1)),Gi=new Float32Array(2*(Gg+1)),Gj=new Uint16Array(3*Gg),Gk=2*Math.PI/Gg,Gl=0;Gh[0]=Gd,Gh[1]=Ge,Gi[0]=Gd/Gc.width,Gi[1]=Ge/Gc.height;for(var Go=2,Gp=0;Gp<Gg;Gp++){var Gq=Gf*Math.cos(Gl)+Gd,Gr=Gf*Math.sin(Gl)+Ge;Gh[Go]=Gq,Gh[Go+1]=Gr,Gi[Go]=Gq/Gc.width,Gi[Go+1]=Gr/Gc.height,Gl+=Gk,Go+=2}for(Gp=Go=0;Gp<Gg;Gp++)Gj[Go++]=0,Gj[Go++]=Gp+1,Gj[Go++]=Gg+1<=Gp+2?1:Gp+2;this.drawTriangles(Gc,Ga,Gb,Gh,Gi,Gj)},Ga.drawTriangles=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){void 0===Gh&&(Gh=1),this._saveToCmd(GJ._context.drawTriangles,[Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj])},Ga._saveToCmd=function(Ga,Gb){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=Gb,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(Gb)),Gb.callee=Ga,this._repaint(),Gb},Ga.clipRect=function(Ga,Gb,Gc,Gd){this._saveToCmd(GJ._context._clipRect,[Ga,Gb,Gc,Gd])},Ga.fillText=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){void 0===Gg&&(Gg=0),this._saveToCmd(GJ._context._fillText,[Ga,Gb,Gc,Gd||Gp.defaultFont,Ge,Gf])},Ga.fillBorderText=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){this._saveToCmd(GJ._context._fillBorderText,[Ga,Gb,Gc,Gd||Gp.defaultFont,Ge,Gf,Gg,Gh])},Ga.strokeText=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this._saveToCmd(GJ._context._strokeText,[Ga,Gb,Gc,Gd||Gp.defaultFont,Ge,Gf,Gg])},Ga.alpha=function(Ga){Ga=Ga<0?0:1<Ga?1:Ga,this._saveToCmd(GJ._context._alpha,[Ga])},Ga.setAlpha=function(Ga){Ga=Ga<0?0:1<Ga?1:Ga,this._saveToCmd(GJ._context._setAlpha,[Ga])},Ga.transform=function(Ga,Gb,Gc){void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),this._saveToCmd(GJ._context._transform,[Ga,Gb,Gc])},Ga.rotate=function(Ga,Gb,Gc){void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),this._saveToCmd(GJ._context._rotate,[Ga,Gb,Gc])},Ga.scale=function(Ga,Gb,Gc,Gd){void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=0),this._saveToCmd(GJ._context._scale,[Ga,Gb,Gc,Gd])},Ga.translate=function(Ga,Gb){this._saveToCmd(GJ._context._translate,[Ga,Gb])},Ga.save=function(){this._saveToCmd(GJ._context._save,[])},Ga.restore=function(){this._saveToCmd(GJ._context._restore,[])},Ga.replaceText=function(Ga){this._repaint();var Gb=this._cmds;if(Gb){for(var Gc=Gb.length-1;-1<Gc;Gc--)if(this._isTextCmd(Gb[Gc].callee))return Gb[Gc][0].toUpperCase?Gb[Gc][0]=Ga:Gb[Gc][0].setText(Ga),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=Ga:this._one[0].setText(Ga),!0;return!1},Ga._isTextCmd=function(Ga){return Ga===GJ._context._fillText||Ga===GJ._context._fillBorderText||Ga===GJ._context._strokeText},Ga.replaceTextColor=function(Ga){this._repaint();var Gb=this._cmds;if(Gb)for(var Gc=Gb.length-1;-1<Gc;Gc--)this._isTextCmd(Gb[Gc].callee)&&(Gb[Gc][4]=Ga,Gb[Gc][0].toUpperCase||(Gb[Gc][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=Ga,this._one[0].toUpperCase||(this._one[0].changed=!0))},Ga.loadImage=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=this;void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=0),void 0===Ge&&(Ge=0);var Gh=Gha.getRes(Ga);function Gi(Ga){Ga&&(Gg.drawTexture(Ga,Gb,Gc,Gd,Ge),null!=Gf&&Gf.call(Gg._sp,Ga))}Gh?Gi(Gh):Gz.loader.load(Ga,Gu.create(null,Gi),null,"image")},Ga._renderEmpty=function(Ga,Gb,Gc,Gd){},Ga._renderAll=function(Ga,Gb,Gc,Gd){for(var Ge,Gf=this._cmds,Gg=0,Gh=Gf.length;Gg<Gh;Gg++)(Ge=Gf[Gg]).callee.call(Gb,Gc,Gd,Ge)},Ga._renderOne=function(Ga,Gb,Gc,Gd){this._one.callee.call(Gb,Gc,Gd,this._one)},Ga._renderOneImg=function(Ga,Gb,Gc,Gd){this._one.callee.call(Gb,Gc,Gd,this._one),2305!==Ga._renderType&&(Ga._renderType|=1)},Ga.drawLine=function(Ga,Gb,Gc,Gd,Ge,Gf){void 0===Gf&&(Gf=1);var Gg=0;GJ.isWebGL&&(Gg=G_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Gg));var Gh=Gf%2==0?0:.5,Gi=[Ga+Gh,Gb+Gh,Gc+Gh,Gd+Gh,Ge,Gf,Gg];this._saveToCmd(GJ._context._drawLine,Gi)},Ga.drawLines=function(Ga,Gb,Gc,Gd,Ge){void 0===Ge&&(Ge=1);var Gf=0;if(Gc&&!(Gc.length<4)){GJ.isWebGL&&(Gf=G_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Gf));var Gg=Ge%2==0?0:.5,Gh=[Ga+Gg,Gb+Gg,Gc,Gd,Ge,Gf];this._saveToCmd(GJ._context._drawLines,Gh)}},Ga.drawCurves=function(Ga,Gb,Gc,Gd,Ge){void 0===Ge&&(Ge=1);var Gf=[Ga,Gb,Gc,Gd,Ge];this._saveToCmd(GJ._context._drawCurves,Gf)},Ga.drawRect=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){void 0===Gg&&(Gg=1);var Gh=Gf?Gg/2:0,Gi=Gf?Gg:0,Gj=[Ga+Gh,Gb+Gh,Gc-Gi,Gd-Gi,Ge,Gf,Gg];this._saveToCmd(GJ._context._drawRect,Gj)},Ga.drawCircle=function(Ga,Gb,Gc,Gd,Ge,Gf){void 0===Gf&&(Gf=1);var Gg=Ge?Gf/2:0,Gh=0;GJ.isWebGL&&(Gh=G_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Gh));var Gi=[Ga,Gb,Gc-Gg,Gd,Ge,Gf,Gh];this._saveToCmd(GJ._context._drawCircle,Gi)},Ga.drawPie=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){void 0===Gh&&(Gh=1);var Gi=Gg?Gh/2:0,Gj=Gg?Gh:0,Gk=0;GJ.isWebGL&&(Gk=G_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Gk));var Gl=[Ga+Gi,Gb+Gi,Gc-Gj,Gd,Ge,Gf,Gg,Gh,Gk];Gl[3]=G$.toRadian(Gd),Gl[4]=G$.toRadian(Ge),this._saveToCmd(GJ._context._drawPie,Gl)},Ga.drawPoly=function(Ga,Gb,Gc,Gd,Ge,Gf){void 0===Gf&&(Gf=1);var Gg=0,Gh=!1;GJ.isWebGL&&(Gg=G_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(Gg),Gh=!(6<Gc.length));var Gi=Ge?Gf%2==0?0:.5:0,Gj=[Ga+Gi,Gb+Gi,Gc,Gd,Ge,Gf,Gg,Gh];this._saveToCmd(GJ._context._drawPoly,Gj)},Ga.drawPath=function(Ga,Gb,Gc,Gd,Ge){var Gf=[Ga,Gb,Gc,Gd,Ge];this._saveToCmd(GJ._context._drawPath,Gf)},Gk(0,Ga,"cmds",function(){return this._cmds},function(Ga){this._sp&&(this._sp._renderType|=512),this._cmds=Ga,this._render=this._renderAll,this._repaint()}),Gl.__init__=function(){if(GJ.isConchNode){for(var Ga=laya.display.Graphics.prototype,Gb=GO.window.ConchGraphics.prototype,Gc=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],Gd=0,Ge=Gc.length;Gd<=Ge;Gd++){var Gf=Gc[Gd];Ga[Gf]=Gb[Gf]}Ga._saveToCmd=null,Gb.drawImageS&&(Ga.drawTextures=function(Ga,Gb){if(Ga&&Ga.loaded&&Ga.bitmap&&Ga.source){var Gc=Ga.uv,Gd=Ga.bitmap.width,Ge=Ga.bitmap.height;this.drawImageS(Ga.bitmap.source,Gc[0]*Gd,Gc[1]*Ge,(Gc[2]-Gc[0])*Gd,(Gc[5]-Gc[3])*Ge,Ga.offsetX,Ga.offsetY,Ga.width,Ga.height,Gb)}}),Ga.drawTexture=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){if(void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=0),void 0===Ge&&(Ge=0),void 0===Gg&&(Gg=1),Ga)if(Ga.loaded){if(Ga.loaded&&Ga.bitmap&&Ga.source&&(Gd||(Gd=Ga.sourceWidth),Ge||(Ge=Ga.sourceHeight),Gg=Gg<0?0:1<Gg?1:Gg,Gd=Gd-Ga.sourceWidth+Ga.width,Ge=Ge-Ga.sourceHeight+Ga.height,!(Gd<=0||Ge<=0))){Gb+=Ga.offsetX,Gc+=Ga.offsetY;var Gh=Ga.uv,Gi=Ga.bitmap.width,Gj=Ga.bitmap.height;Gh[4]<Gh[0]&&Gh[5]<Gh[1]?this.drawImageM(Ga.bitmap.source,Gh[4]*Gi,Gh[5]*Gj,(Gh[0]-Gh[4])*Gi,(Gh[1]-Gh[5])*Gj,Gb,Gc,Gd,Ge,Gf,Gg):this.drawImageM(Ga.bitmap.source,Gh[0]*Gi,Gh[1]*Gj,(Gh[2]-Gh[0])*Gi,(Gh[5]-Gh[3])*Gj,Gb,Gc,Gd,Ge,Gf,Gg),this._repaint()}}else Ga.once("loaded",this,function(){this.drawTexture(Ga,Gb,Gc,Gd,Ge,Gf)})},Ga.fillTexture=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){if(void 0===Gd&&(Gd=0),void 0===Ge&&(Ge=0),void 0===Gf&&(Gf="repeat"),Ga&&Ga.loaded){var Gh,Gi=GJ._context.ctx,Gj=Ga.bitmap.width,Gk=Ga.bitmap.height,Gl=Ga.uv;Gh=Ga.uv!=Gka.DEF_UV?Gi.createPattern(Ga.bitmap.source,Gf,Gl[0]*Gj,Gl[1]*Gk,(Gl[2]-Gl[0])*Gj,(Gl[5]-Gl[3])*Gk):Gi.createPattern(Ga.bitmap.source,Gf);var Go=0,Gp=0;Gg&&(Gb+=Gg.x%Ga.width,Gc+=Gg.y%Ga.height,Go-=Gg.x%Ga.width,Gp-=Gg.y%Ga.height),this._fillImage(Gh,Gb,Gc,Go,Gp,Gd,Ge)}}}},Gl._cache=[],Gl}(),Gc=function(){function Gv(){this._cacheBoundsType=!1}Gr(Gv,"laya.display.GraphicsBounds");var Ga=Gv.prototype;return Ga.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},Ga.reset=function(){this._temp&&(this._temp.length=0)},Ga.getBounds=function(Ga){return void 0===Ga&&(Ga=!1),(!this._bounds||!this._temp||this._temp.length<1||Ga!=this._cacheBoundsType)&&(this._bounds=GB._getWrapRec(this.getBoundPoints(Ga),this._bounds)),this._cacheBoundsType=Ga,this._bounds},Ga.getBoundPoints=function(Ga){return void 0===Ga&&(Ga=!1),(!this._temp||this._temp.length<1||Ga!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(Ga)),this._cacheBoundsType=Ga,this._rstBoundPoints=G$.copyArray(this._rstBoundPoints,this._temp)},Ga._getCmdPoints=function(Ga){void 0===Ga&&(Ga=!1);var Gb,Gc,Gd=GJ._context,Ge=this._graphics.cmds;if((Gb=this._temp||(this._temp=[])).length=0,Ge||null==this._graphics._one||(Gv._tempCmds.length=0,Gv._tempCmds.push(this._graphics._one),Ge=Gv._tempCmds),!Ge)return Gb;(Gc=Gv._tempMatrixArrays).length=0;var Gf=Gv._initMatrix;Gf.identity();for(var Gg,Gh,Gi=Gv._tempMatrix,Gj=NaN,Gk=NaN,Gl=NaN,Go=NaN,Gp=NaN,Gq=NaN,Gr=0,Gs=Ge.length;Gr<Gs;Gr++)if((Gg=Ge[Gr]).callee)switch(Gg.callee){case Gd._save:case 7:Gc.push(Gf),Gf=Gf.clone();break;case Gd._restore:case 8:Gf=Gc.pop();break;case Gd._scale:case 5:Gi.identity(),Gi.translate(-Gg[2],-Gg[3]),Gi.scale(Gg[0],Gg[1]),Gi.translate(Gg[2],Gg[3]),this._switchMatrix(Gf,Gi);break;case Gd._rotate:case 3:Gi.identity(),Gi.translate(-Gg[1],-Gg[2]),Gi.rotate(Gg[0]),Gi.translate(Gg[1],Gg[2]),this._switchMatrix(Gf,Gi);break;case Gd._translate:case 6:Gi.identity(),Gi.translate(Gg[0],Gg[1]),this._switchMatrix(Gf,Gi);break;case Gd._transform:case 4:Gi.identity(),Gi.translate(-Gg[1],-Gg[2]),Gi.concat(Gg[0]),Gi.translate(Gg[1],Gg[2]),this._switchMatrix(Gf,Gi);break;case 16:case 24:Gv._addPointArrToRst(Gb,GB._getBoundPointS(Gg[0],Gg[1],Gg[2],Gg[3]),Gf);break;case 17:Gf.copyTo(Gi),Gi.concat(Gg[4]),Gv._addPointArrToRst(Gb,GB._getBoundPointS(Gg[0],Gg[1],Gg[2],Gg[3]),Gi);break;case Gd._drawTexture:Gh=Gg[0],Ga?Gg[3]&&Gg[4]?Gv._addPointArrToRst(Gb,GB._getBoundPointS(Gg[1],Gg[2],Gg[3],Gg[4]),Gf):(Gh=Gg[0],Gv._addPointArrToRst(Gb,GB._getBoundPointS(Gg[1],Gg[2],Gh.width,Gh.height),Gf)):(Gj=(Gg[3]||Gh.sourceWidth)/Gh.width,Gk=(Gg[4]||Gh.sourceHeight)/Gh.height,Gl=Gj*Gh.sourceWidth,Go=Gk*Gh.sourceHeight,Gp=0<Gh.offsetX?Gh.offsetX:0,Gq=0<Gh.offsetY?Gh.offsetY:0,Gp*=Gj,Gq*=Gk,Gv._addPointArrToRst(Gb,GB._getBoundPointS(Gg[1]-Gp,Gg[2]-Gq,Gl,Go),Gf));break;case Gd._fillTexture:Gg[3]&&Gg[4]?Gv._addPointArrToRst(Gb,GB._getBoundPointS(Gg[1],Gg[2],Gg[3],Gg[4]),Gf):(Gh=Gg[0],Gv._addPointArrToRst(Gb,GB._getBoundPointS(Gg[1],Gg[2],Gh.width,Gh.height),Gf));break;case Gd._drawTextureWithTransform:var Gt;Gt=Gg[5]?(Gf.copyTo(Gi),Gi.concat(Gg[5]),Gi):Gf,Ga?Gg[3]&&Gg[4]?Gv._addPointArrToRst(Gb,GB._getBoundPointS(Gg[1],Gg[2],Gg[3],Gg[4]),Gt):(Gh=Gg[0],Gv._addPointArrToRst(Gb,GB._getBoundPointS(Gg[1],Gg[2],Gh.width,Gh.height),Gt)):(Gh=Gg[0],Gj=(Gg[3]||Gh.sourceWidth)/Gh.width,Gk=(Gg[4]||Gh.sourceHeight)/Gh.height,Gl=Gj*Gh.sourceWidth,Go=Gk*Gh.sourceHeight,Gp=0<Gh.offsetX?Gh.offsetX:0,Gq=0<Gh.offsetY?Gh.offsetY:0,Gp*=Gj,Gq*=Gk,Gv._addPointArrToRst(Gb,GB._getBoundPointS(Gg[1]-Gp,Gg[2]-Gq,Gl,Go),Gt));break;case Gd._drawRect:case 13:Gv._addPointArrToRst(Gb,GB._getBoundPointS(Gg[0],Gg[1],Gg[2],Gg[3]),Gf);break;case Gd._drawCircle:case Gd._fillCircle:case 14:Gv._addPointArrToRst(Gb,GB._getBoundPointS(Gg[0]-Gg[2],Gg[1]-Gg[2],Gg[2]+Gg[2],Gg[2]+Gg[2]),Gf);break;case Gd._drawLine:case 20:Gv._tempPoints.length=0;var Gu;Gu=.5*Gg[5],Gg[0]==Gg[2]?Gv._tempPoints.push(Gg[0]+Gu,Gg[1],Gg[2]+Gu,Gg[3],Gg[0]-Gu,Gg[1],Gg[2]-Gu,Gg[3]):Gg[1]==Gg[3]?Gv._tempPoints.push(Gg[0],Gg[1]+Gu,Gg[2],Gg[3]+Gu,Gg[0],Gg[1]-Gu,Gg[2],Gg[3]-Gu):Gv._tempPoints.push(Gg[0],Gg[1],Gg[2],Gg[3]),Gv._addPointArrToRst(Gb,Gv._tempPoints,Gf);break;case Gd._drawCurves:case 22:Gv._addPointArrToRst(Gb,Gw.I.getBezierPoints(Gg[2]),Gf,Gg[0],Gg[1]);break;case Gd._drawPoly:case Gd._drawLines:case 18:Gv._addPointArrToRst(Gb,Gg[2],Gf,Gg[0],Gg[1]);break;case Gd._drawPath:case 19:Gv._addPointArrToRst(Gb,this._getPathPoints(Gg[2]),Gf,Gg[0],Gg[1]);break;case Gd._drawPie:case 15:Gv._addPointArrToRst(Gb,this._getPiePoints(Gg[0],Gg[1],Gg[2],Gg[3],Gg[4]),Gf)}return 200<Gb.length?Gb=G$.copyArray(Gb,GB._getWrapRec(Gb)._getBoundPoints()):8<Gb.length&&(Gb=Gx.scanPList(Gb)),Gb},Ga._switchMatrix=function(Ga,Gb){Gb.concat(Ga),Gb.copyTo(Ga)},Ga._getPiePoints=function(Ga,Gb,Gc,Gd,Ge){var Gf=Gv._tempPoints;Gv._tempPoints.length=0,Gf.push(Ga,Gb);var Gg=(Ge-Gd)%(2*Math.PI)/10,Gh=NaN,Gi=Gd;for(Gh=0;Gh<=10;Gh++)Gf.push(Ga+Gc*Math.cos(Gi),Gb+Gc*Math.sin(Gi)),Gi+=Gg;return Gf},Ga._getPathPoints=function(Ga){var Gb,Gc,Gd=0,Ge=Gv._tempPoints;for(Ge.length=0,Gb=Ga.length,Gd=0;Gd<Gb;Gd++)1<(Gc=Ga[Gd]).length&&(Ge.push(Gc[1],Gc[2]),3<Gc.length&&Ge.push(Gc[3],Gc[4]));return Ge},Gv._addPointArrToRst=function(Ga,Gb,Gc,Gd,Ge){void 0===Gd&&(Gd=0),void 0===Ge&&(Ge=0);var Gf,Gg=0;for(Gf=Gb.length,Gg=0;Gg<Gf;Gg+=2)Gv._addPointToRst(Ga,Gb[Gg]+Gd,Gb[Gg+1]+Ge,Gc)},Gv._addPointToRst=function(Ga,Gb,Gc,Gd){var Ge=GA.TEMP;Ge.setTo(Gb||0,Gc||0),Gd.transformPoint(Ge),Ga.push(Ge.x,Ge.y)},Gv._tempPoints=[],Gv._tempMatrixArrays=[],Gv._tempCmds=[],Gi(Gv,["_tempMatrix",function(){return this._tempMatrix=new GG},"_initMatrix",function(){return this._initMatrix=new GG}]),Gv}(),Gf=function(){function Ga(){}Gr(Ga,"laya.events.Event");var Gb=Ga.prototype;return Gb.setTo=function(Ga,Gb,Gc){return this.type=Ga,this.currentTarget=Gb,this.target=Gc,this},Gb.stopPropagation=function(){this._stoped=!0},Gk(0,Gb,"stageY",function(){return Gz.stage.mouseY}),Gk(0,Gb,"charCode",function(){return this.nativeEvent.charCode}),Gk(0,Gb,"touches",function(){var Ga=this.nativeEvent.touches;if(Ga)for(var Gb=Gz.stage,Gc=0,Gd=Ga.length;Gc<Gd;Gc++){var Ge=Ga[Gc],Gf=GA.TEMP;Gf.setTo(Ge.clientX,Ge.clientY),Gb._canvasTransform.invertTransformPoint(Gf),Gb.transform.invertTransformPoint(Gf),Ge.stageX=Gf.x,Ge.stageY=Gf.y}return Ga}),Gk(0,Gb,"keyLocation",function(){return this.nativeEvent.keyLocation}),Gk(0,Gb,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),Gk(0,Gb,"altKey",function(){return this.nativeEvent.altKey}),Gk(0,Gb,"shiftKey",function(){return this.nativeEvent.shiftKey}),Gk(0,Gb,"stageX",function(){return Gz.stage.mouseX}),Ga.EMPTY=new Ga,Ga.MOUSE_DOWN="mousedown",Ga.MOUSE_UP="mouseup",Ga.CLICK="click",Ga.RIGHT_MOUSE_DOWN="rightmousedown",Ga.RIGHT_MOUSE_UP="rightmouseup",Ga.RIGHT_CLICK="rightclick",Ga.MOUSE_MOVE="mousemove",Ga.MOUSE_OVER="mouseover",Ga.MOUSE_OUT="mouseout",Ga.MOUSE_WHEEL="mousewheel",Ga.ROLL_OVER="mouseover",Ga.ROLL_OUT="mouseout",Ga.DOUBLE_CLICK="doubleclick",Ga.CHANGE="change",Ga.CHANGED="changed",Ga.RESIZE="resize",Ga.ADDED="added",Ga.REMOVED="removed",Ga.DISPLAY="display",Ga.UNDISPLAY="undisplay",Ga.ERROR="error",Ga.COMPLETE="complete",Ga.LOADED="loaded",Ga.INITED="inited",Ga.PROGRESS="progress",Ga.INPUT="input",Ga.RENDER="render",Ga.OPEN="open",Ga.MESSAGE="message",Ga.CLOSE="close",Ga.KEY_DOWN="keydown",Ga.KEY_PRESS="keypress",Ga.KEY_UP="keyup",Ga.FRAME="enterframe",Ga.DRAG_START="dragstart",Ga.DRAG_MOVE="dragmove",Ga.DRAG_END="dragend",Ga.ENTER="enter",Ga.SELECT="select",Ga.BLUR="blur",Ga.FOCUS="focus",Ga.VISIBILITY_CHANGE="visibilitychange",Ga.FOCUS_CHANGE="focuschange",Ga.PLAYED="played",Ga.PAUSED="paused",Ga.STOPPED="stopped",Ga.START="start",Ga.END="end",Ga.ENABLE_CHANGED="enablechanged",Ga.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",Ga.COMPONENT_ADDED="componentadded",Ga.COMPONENT_REMOVED="componentremoved",Ga.LAYER_CHANGED="layerchanged",Ga.HIERARCHY_LOADED="hierarchyloaded",Ga.RECOVERED="recovered",Ga.RELEASED="released",Ga.LINK="link",Ga.LABEL="label",Ga.FULL_SCREEN_CHANGE="fullscreenchange",Ga.DEVICE_LOST="devicelost",Ga.MESH_CHANGED="meshchanged",Ga.MATERIAL_CHANGED="materialchanged",Ga.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",Ga.ANIMATION_CHANGED="animationchanged",Ga.TRIGGER_ENTER="triggerenter",Ga.TRIGGER_STAY="triggerstay",Ga.TRIGGER_EXIT="triggerexit",Ga.TRAIL_FILTER_CHANGE="trailfilterchange",Ga.DOMINO_FILTER_CHANGE="dominofilterchange",Ga}(),Gl=(function(){function Ga(){}Gr(Ga,"laya.events.Keyboard"),Ga.NUMBER_0=48,Ga.NUMBER_1=49,Ga.NUMBER_2=50,Ga.NUMBER_3=51,Ga.NUMBER_4=52,Ga.NUMBER_5=53,Ga.NUMBER_6=54,Ga.NUMBER_7=55,Ga.NUMBER_8=56,Ga.NUMBER_9=57,Ga.A=65,Ga.B=66,Ga.C=67,Ga.D=68,Ga.E=69,Ga.F=70,Ga.G=71,Ga.H=72,Ga.I=73,Ga.J=74,Ga.K=75,Ga.L=76,Ga.M=77,Ga.N=78,Ga.O=79,Ga.P=80,Ga.Q=81,Ga.R=82,Ga.S=83,Ga.T=84,Ga.U=85,Ga.V=86,Ga.W=87,Ga.X=88,Ga.Y=89,Ga.Z=90,Ga.F1=112,Ga.F2=113,Ga.F3=114,Ga.F4=115,Ga.F5=116,Ga.F6=117,Ga.F7=118,Ga.F8=119,Ga.F9=120,Ga.F10=121,Ga.F11=122,Ga.F12=123,Ga.F13=124,Ga.F14=125,Ga.F15=126,Ga.NUMPAD=21,Ga.NUMPAD_0=96,Ga.NUMPAD_1=97,Ga.NUMPAD_2=98,Ga.NUMPAD_3=99,Ga.NUMPAD_4=100,Ga.NUMPAD_5=101,Ga.NUMPAD_6=102,Ga.NUMPAD_7=103,Ga.NUMPAD_8=104,Ga.NUMPAD_9=105,Ga.NUMPAD_ADD=107,Ga.NUMPAD_DECIMAL=110,Ga.NUMPAD_DIVIDE=111,Ga.NUMPAD_ENTER=108,Ga.NUMPAD_MULTIPLY=106,Ga.NUMPAD_SUBTRACT=109,Ga.SEMICOLON=186,Ga.EQUAL=187,Ga.COMMA=188,Ga.MINUS=189,Ga.PERIOD=190,Ga.SLASH=191,Ga.BACKQUOTE=192,Ga.LEFTBRACKET=219,Ga.BACKSLASH=220,Ga.RIGHTBRACKET=221,Ga.QUOTE=222,Ga.ALTERNATE=18,Ga.BACKSPACE=8,Ga.CAPS_LOCK=20,Ga.COMMAND=15,Ga.CONTROL=17,Ga.DELETE=46,Ga.ENTER=13,Ga.ESCAPE=27,Ga.PAGE_UP=33,Ga.PAGE_DOWN=34,Ga.END=35,Ga.HOME=36,Ga.LEFT=37,Ga.UP=38,Ga.RIGHT=39,Ga.DOWN=40,Ga.SHIFT=16,Ga.SPACE=32,Ga.TAB=9,Ga.INSERT=45}(),function(){function Ge(){}return Gr(Ge,"laya.events.KeyBoardManager"),Ge.__init__=function(){Ge._addEvent("keydown"),Ge._addEvent("keypress"),Ge._addEvent("keyup")},Ge._addEvent=function(Gb){GO.document.addEventListener(Gb,function(Ga){laya.events.KeyBoardManager._dispatch(Ga,Gb)},!0)},Ge._dispatch=function(Ga,Gb){if(Ge.enabled){Ge._event._stoped=!1,Ge._event.nativeEvent=Ga,Ge._event.keyCode=Ga.keyCode||Ga.which||Ga.charCode,"keydown"===Gb?Ge._pressKeys[Ge._event.keyCode]=!0:"keyup"===Gb&&(Ge._pressKeys[Ge._event.keyCode]=null);for(var Gc=Gz.stage.focus&&null!=Gz.stage.focus.event&&Gz.stage.focus.displayedInStage?Gz.stage.focus:Gz.stage,Gd=Gc;Gd;)Gd.event(Gb,Ge._event.setTo(Gb,Gd,Gc)),Gd=Gd.parent}},Ge.hasKeyDown=function(Ga){return Ge._pressKeys[Ga]},Ge._pressKeys={},Ge.enabled=!0,Gi(Ge,["_event",function(){return this._event=new Gf}]),Ge}()),Gq=(function(){function Ga(){}Gr(Ga,"laya.events.KeyLocation"),Ga.STANDARD=0,Ga.LEFT=1,Ga.RIGHT=2,Ga.NUM_PAD=3}(),function(){function Gk(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=GO.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new Gf,this._matrix=new GG,this._point=new GA,this._rect=new GB,this._prePoint=new GA,this._curTouchID=NaN}Gr(Gk,"laya.events.MouseManager");var Ga=Gk.prototype;return Ga.__init__=function(Ga,Gb){var Gc=this;this._stage=Ga;var Gd=this,Ge=this._eventList;Gb.oncontextmenu=function(Ga){if(Gk.enabled)return!1},Gb.addEventListener("mousedown",function(Ga){Gk.enabled&&(GO.onIE||Ga.preventDefault(),Ge.push(Ga),Gd.mouseDownTime=GO.now())}),Gb.addEventListener("mouseup",function(Ga){Gk.enabled&&(Ga.preventDefault(),Ge.push(Ga),Gd.mouseDownTime=-GO.now())},!0),Gb.addEventListener("mousemove",function(Ga){if(Gk.enabled){Ga.preventDefault();var Gb=GO.now();if(Gb-Gd._lastMoveTimer<10)return;Gd._lastMoveTimer=Gb,Ge.push(Ga)}},!0),Gb.addEventListener("mouseout",function(Ga){Gk.enabled&&Ge.push(Ga)}),Gb.addEventListener("mouseover",function(Ga){Gk.enabled&&Ge.push(Ga)}),Gb.addEventListener("touchstart",function(Ga){Gk.enabled&&(Ge.push(Ga),Gk._isFirstTouch||Gxa.isInputting||Ga.preventDefault(),Gd.mouseDownTime=GO.now())}),Gb.addEventListener("touchend",function(Ga){Gk.enabled?(Gk._isFirstTouch||Gxa.isInputting||Ga.preventDefault(),Gk._isFirstTouch=!1,Ge.push(Ga),Gd.mouseDownTime=-GO.now()):Gc._curTouchID=NaN},!0),Gb.addEventListener("touchmove",function(Ga){Gk.enabled&&(Ga.preventDefault(),Ge.push(Ga))},!0),Gb.addEventListener("touchcancel",function(Ga){Gk.enabled?(Ga.preventDefault(),Ge.push(Ga)):Gc._curTouchID=NaN},!0),Gb.addEventListener("mousewheel",function(Ga){Gk.enabled&&Ge.push(Ga)}),Gb.addEventListener("DOMMouseScroll",function(Ga){Gk.enabled&&Ge.push(Ga)})},Ga.initEvent=function(Ga,Gb){var Gc;this._event._stoped=!1,this._event.nativeEvent=Gb||Ga,this._target=null,this._point.setTo(Ga.pageX||Ga.clientX,Ga.pageY||Ga.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=Ga.identifier||0,this._tTouchID=this._event.touchId,(Gc=Gs.I._event)._stoped=!1,Gc.nativeEvent=this._event.nativeEvent,Gc.touchId=this._event.touchId},Ga.checkMouseWheel=function(Ga){this._event.delta=Ga.wheelDelta?.025*Ga.wheelDelta:-Ga.detail;for(var Gb=Gs.I.getLastOvers(),Gc=0,Gd=Gb.length;Gc<Gd;Gc++){var Ge=Gb[Gc];Ge.event("mousewheel",this._event.setTo("mousewheel",Ge,this._target))}},Ga.onMouseMove=function(Ga){Gs.I.onMouseMove(Ga,this._tTouchID)},Ga.onMouseDown=function(Ga){if(Gxa.isInputting&&Gz.stage.focus&&Gz.stage.focus.focus&&!Gz.stage.focus.contains(this._target)){var Gb=Gz.stage.focus._tf||Gz.stage.focus,Gc=Ga._tf||Ga;Gc instanceof laya.display.Input&&Gc.multiline==Gb.multiline?Gb._focusOut():Gb.focus=!1}Gs.I.onMouseDown(Ga,this._tTouchID,this._isLeftMouse)},Ga.onMouseUp=function(Ga){Gs.I.onMouseUp(Ga,this._tTouchID,this._isLeftMouse)},Ga.check=function(Ga,Gb,Gc,Gd){this._point.setTo(Gb,Gc),Ga.fromParentPoint(this._point),Gb=this._point.x,Gc=this._point.y;var Ge=Ga.scrollRect;if(Ge&&(this._rect.setTo(Ge.x,Ge.y,Ge.width,Ge.height),!this._rect.contains(Gb,Gc)))return!1;if(!this.disableMouseEvent){if(Ga.hitTestPrior&&!Ga.mouseThrough&&!this.hitTest(Ga,Gb,Gc))return!1;for(var Gf=Ga._childs.length-1;-1<Gf;Gf--){var Gg=Ga._childs[Gf];if(!Gg.destroyed&&Gg.mouseEnabled&&Gg.visible&&this.check(Gg,Gb,Gc,Gd))return!0}}var Gh=!(!Ga.hitTestPrior||Ga.mouseThrough||this.disableMouseEvent)||this.hitTest(Ga,Gb,Gc);return Gh?(this._target=Ga,Gd.call(this,Ga)):Gd===this.onMouseUp&&Ga===this._stage&&(this._target=this._stage,Gd.call(this,this._target)),Gh},Ga.hitTest=function(Ga,Gb,Gc){var Gd=!1;if(Ga.scrollRect&&(Gb-=Ga.scrollRect.x,Gc-=Ga.scrollRect.y),Ga.hitArea instanceof laya.utils.HitArea)return Ga.hitArea.isHit(Gb,Gc);if(0<Ga.width&&0<Ga.height||Ga.mouseThrough||Ga.hitArea)if(Ga.mouseThrough)Gd=Ga.getGraphicBounds().contains(Gb,Gc);else{var Ge=this._rect;Ga.hitArea?Ge=Ga.hitArea:Ge.setTo(0,0,Ga.width,Ga.height),Gd=Ge.contains(Gb,Gc)}return Gd},Ga.runEvent=function(){var Ga=this._eventList.length;if(Ga){var Gb=this;Gb.mouseEventTime=GO.now();var Gc,Gd=0,Ge=0,Gf=0;try{for(;Gd<Ga;){var Gg=this._eventList[Gd];switch("mousemove"!==Gg.type&&(this._prePoint.x=this._prePoint.y=-1e6),Gg.type){case"mousedown":this._touchIDs[0]=this._id++,Gk._isTouchRespond?Gk._isTouchRespond=!1:(Gb._isLeftMouse=0===Gg.button,Gb.initEvent(Gg),Gb.check(Gb._stage,Gb.mouseX,Gb.mouseY,Gb.onMouseDown));break;case"mouseup":Gb._isLeftMouse=0===Gg.button,Gb.initEvent(Gg),Gb.check(Gb._stage,Gb.mouseX,Gb.mouseY,Gb.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-Gg.clientX)+Math.abs(this._prePoint.y-Gg.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=Gg.clientX,this._prePoint.y=Gg.clientY,Gb.initEvent(Gg),Gb.check(Gb._stage,Gb.mouseX,Gb.mouseY,Gb.onMouseMove));break;case"touchstart":Gk._isTouchRespond=!0,Gb._isLeftMouse=!0;var Gh=Gg.changedTouches;for(Ge=0,Gf=Gh.length;Ge<Gf;Ge++)Gc=Gh[Ge],(Gk.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=Gc.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[Gc.identifier]=this._id++,Gb.initEvent(Gc,Gg),Gb.check(Gb._stage,Gb.mouseX,Gb.mouseY,Gb.onMouseDown));break;case"touchend":case"touchcancel":Gk._isTouchRespond=!0,Gb._isLeftMouse=!0;var Gi=Gg.changedTouches;for(Ge=0,Gf=Gi.length;Ge<Gf;Ge++)if(Gc=Gi[Ge],Gk.multiTouchEnabled||Gc.identifier==this._curTouchID){this._curTouchID=NaN,Gb.initEvent(Gc,Gg);Gb.check(Gb._stage,Gb.mouseX,Gb.mouseY,Gb.onMouseUp)||Gb.onMouseUp(null)}break;case"touchmove":var Gj=Gg.changedTouches;for(Ge=0,Gf=Gj.length;Ge<Gf;Ge++)Gc=Gj[Ge],(Gk.multiTouchEnabled||Gc.identifier==this._curTouchID)&&(Gb.initEvent(Gc,Gg),Gb.check(Gb._stage,Gb.mouseX,Gb.mouseY,Gb.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":Gb.checkMouseWheel(Gg);break;case"mouseout":Gs.I.stageMouseOut();break;case"mouseover":Gb._stage.event("mouseover",Gb._event.setTo("mouseover",Gb._stage,Gb._stage))}Gd++}}catch(Ga){throw this._eventList.length=0,Ga}this._eventList.length=0}},Gk.enabled=!0,Gk.multiTouchEnabled=!0,Gk._isTouchRespond=!1,Gk._isFirstTouch=!0,Gi(Gk,["instance",function(){return this.instance=new Gk}]),Gk}()),Gs=function(){function Gq(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new Gf}Gr(Gq,"laya.events.TouchManager");var Ga=Gq.prototype;return Ga._clearTempArrs=function(){Gq._oldArr.length=0,Gq._newArr.length=0,Gq._tEleArr.length=0},Ga.getTouchFromArr=function(Ga,Gb){var Gc,Gd,Ge=0;for(Gc=Gb.length,Ge=0;Ge<Gc;Ge++)if((Gd=Gb[Ge]).id==Ga)return Gd;return null},Ga.removeTouchFromArr=function(Ga,Gb){var Gc=0;for(Gc=Gb.length-1;0<=Gc;Gc--)Gb[Gc].id==Ga&&Gb.splice(Gc,1)},Ga.createTouchO=function(Ga,Gb){var Gc;return(Gc=GW.getItem("TouchData")||{}).id=Gb,Gc.tar=Ga,Gc},Ga.onMouseDown=function(Ga,Gb,Gc){var Gd,Ge,Gf,Gg;(void 0===Gc&&(Gc=!1),this.enable)&&(Gd=this.getTouchFromArr(Gb,this.preOvers),Gf=this.getEles(Ga,null,Gq._tEleArr),Gd?Gd.tar=Ga:(Ge=this.createTouchO(Ga,Gb),this.preOvers.push(Ge)),GO.onMobile&&this.sendEvents(Gf,"mouseover",Gb),Gg=Gc?this.preDowns:this.preRightDowns,(Gd=this.getTouchFromArr(Gb,Gg))?Gd.tar=Ga:(Ge=this.createTouchO(Ga,Gb),Gg.push(Ge)),this.sendEvents(Gf,Gc?"mousedown":"rightmousedown",Gb),this._clearTempArrs())},Ga.sendEvents=function(Ga,Gb,Gc){void 0===Gc&&(Gc=0);var Gd,Ge,Gf,Gg=0;for(Gd=Ga.length,this._event._stoped=!1,Ge=Ga[0],Gg=0;Gg<Gd;Gg++){if((Gf=Ga[Gg]).destroyed)return;if(Gf.event(Gb,this._event.setTo(Gb,Gf,Ge)),this._event._stoped)break}},Ga.getEles=function(Ga,Gb,Gc){for(Gc?Gc.length=0:Gc=[];Ga&&Ga!=Gb;)Gc.push(Ga),Ga=Ga.parent;return Gc},Ga.checkMouseOutAndOverOfMove=function(Ga,Gb,Gc){if(void 0===Gc&&(Gc=0),Gb!=Ga){var Gd,Ge,Gf=0,Gg=0;if(Gb.contains(Ga))Ge=this.getEles(Ga,Gb,Gq._tEleArr),this.sendEvents(Ge,"mouseover",Gc);else if(Ga.contains(Gb))Ge=this.getEles(Gb,Ga,Gq._tEleArr),this.sendEvents(Ge,"mouseout",Gc);else{var Gh,Gi;(Ge=Gq._tEleArr).length=0,Gh=this.getEles(Gb,null,Gq._oldArr),Gi=this.getEles(Ga,null,Gq._newArr),Gg=Gh.length;var Gj=0;for(Gf=0;Gf<Gg;Gf++){if(Gd=Gh[Gf],0<=(Gj=Gi.indexOf(Gd))){Gi.splice(Gj,Gi.length-Gj);break}Ge.push(Gd)}0<Ge.length&&this.sendEvents(Ge,"mouseout",Gc),0<Gi.length&&this.sendEvents(Gi,"mouseover",Gc)}}},Ga.onMouseMove=function(Ga,Gb){var Gc,Gd;this.enable&&((Gc=this.getTouchFromArr(Gb,this.preOvers))?(this.checkMouseOutAndOverOfMove(Ga,Gc.tar),Gc.tar=Ga,Gd=this.getEles(Ga,null,Gq._tEleArr)):(Gd=this.getEles(Ga,null,Gq._tEleArr),this.sendEvents(Gd,"mouseover",Gb),this.preOvers.push(this.createTouchO(Ga,Gb))),this.sendEvents(Gd,"mousemove",Gb),this._clearTempArrs())},Ga.getLastOvers=function(){return(Gq._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,Gq._tEleArr):(Gq._tEleArr.push(Gz.stage),Gq._tEleArr)},Ga.stageMouseOut=function(){var Ga;Ga=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(Ga,"mouseout",0)},Ga.onMouseUp=function(Ga,Gb,Gc){if(void 0===Gc&&(Gc=!1),this.enable){var Gd,Ge,Gf,Gg,Gh,Gi,Gj=0,Gk=0,Gl=GO.onMobile;if(Ge=this.getEles(Ga,null,Gq._tEleArr),this.sendEvents(Ge,Gc?"mouseup":"rightmouseup",Gb),Gi=Gc?this.preDowns:this.preRightDowns,Gd=this.getTouchFromArr(Gb,Gi)){var Go,Gp=GO.now();if(Go=Gp-this._lastClickTime<300,this._lastClickTime=Gp,Ga==Gd.tar)Gh=Ge;else for(Gf=this.getEles(Gd.tar,null,Gq._oldArr),(Gh=Gq._newArr).length=0,Gk=Gf.length,Gj=0;Gj<Gk;Gj++)Gg=Gf[Gj],0<=Ge.indexOf(Gg)&&Gh.push(Gg);0<Gh.length&&this.sendEvents(Gh,Gc?"click":"rightclick",Gb),Gc&&Go&&this.sendEvents(Gh,"doubleclick",Gb),this.removeTouchFromArr(Gb,Gi),Gd.tar=null,GW.recover("TouchData",Gd)}else;(Gd=this.getTouchFromArr(Gb,this.preOvers))&&Gl&&((Gh=this.getEles(Gd.tar,null,Gh))&&0<Gh.length&&this.sendEvents(Gh,"mouseout",Gb),this.removeTouchFromArr(Gb,this.preOvers),Gd.tar=null,GW.recover("TouchData",Gd)),this._clearTempArrs()}},Gq._oldArr=[],Gq._newArr=[],Gq._tEleArr=[],Gi(Gq,["I",function(){return this.I=new Gq}]),Gq}(),Gt=function(){function Ga(){this._action=null}Gr(Ga,"laya.filters.Filter");var Gb=Ga.prototype;return Gz.imps(Gb,{"laya.filters.IFilter":!0}),Gb.callNative=function(Ga){},Gk(0,Gb,"type",function(){return-1}),Gk(0,Gb,"action",function(){return this._action}),Ga.BLUR=16,Ga.COLOR=32,Ga.GLOW=8,Ga._filterStart=null,Ga._filterEnd=null,Ga._EndTarget=null,Ga._recycleScope=null,Ga._filter=null,Ga._useSrc=null,Ga._endSrc=null,Ga._useOut=null,Ga._endOut=null,Ga}(),Gv=function(){function Ga(){this.data=null}Gr(Ga,"laya.filters.ColorFilterAction");var Gb=Ga.prototype;return Gz.imps(Gb,{"laya.filters.IFilterAction":!0}),Gb.apply=function(Ga){var Gb=Ga.ctx.ctx,Gc=Ga.ctx.ctx.canvas;if(0==Gc.width||0==Gc.height)return Gc;for(var Gd,Ge=Gb.getImageData(0,0,Gc.width,Gc.height),Gf=Ge.data,Gg=0,Gh=Gf.length;Gg<Gh;Gg+=4)Gd=this.getColor(Gf[Gg],Gf[Gg+1],Gf[Gg+2],Gf[Gg+3]),0!=Gf[Gg+3]&&(Gf[Gg]=Gd[0],Gf[Gg+1]=Gd[1],Gf[Gg+2]=Gd[2],Gf[Gg+3]=Gd[3]);return Gb.putImageData(Ge,0,0),Ga},Gb.getColor=function(Ga,Gb,Gc,Gd){var Ge=[];if(this.data._mat&&this.data._alpha){var Gf=this.data._mat,Gg=this.data._alpha;Ge[0]=Gf[0]*Ga+Gf[1]*Gb+Gf[2]*Gc+Gf[3]*Gd+Gg[0],Ge[1]=Gf[4]*Ga+Gf[5]*Gb+Gf[6]*Gc+Gf[7]*Gd+Gg[1],Ge[2]=Gf[8]*Ga+Gf[9]*Gb+Gf[10]*Gc+Gf[11]*Gd+Gg[2],Ge[3]=Gf[12]*Ga+Gf[13]*Gb+Gf[14]*Gc+Gf[15]*Gd+Gg[3]}return Ge},Ga}(),Gw=(function(){function Ga(){}Gr(Ga,"laya.maths.Arith"),Ga.formatR=function(Ga){return Ga>Math.PI&&(Ga-=2*Math.PI),Ga<-Math.PI&&(Ga+=2*Math.PI),Ga},Ga.isPOT=function(Ga,Gb){return 0<Ga&&0==(Ga&Ga-1)&&0<Gb&&0==(Gb&Gb-1)},Ga.setMatToArray=function(Ga,Gb){Ga.a,Ga.b,Ga.c,Ga.d,Ga.tx,Ga.ty,Gb[0]=Ga.a,Gb[1]=Ga.b,Gb[4]=Ga.c,Gb[5]=Ga.d,Gb[12]=Ga.tx,Gb[13]=Ga.ty}}(),function(){function Ga(){this._controlPoints=[new GA,new GA,new GA],this._calFun=this.getPoint2}Gr(Ga,"laya.maths.Bezier");var Gb=Ga.prototype;return Gb._switchPoint=function(Ga,Gb){var Gc=this._controlPoints.shift();Gc.setTo(Ga,Gb),this._controlPoints.push(Gc)},Gb.getPoint2=function(Ga,Gb){var Gc=this._controlPoints[0],Gd=this._controlPoints[1],Ge=this._controlPoints[2],Gf=Math.pow(1-Ga,2)*Gc.x+2*Ga*(1-Ga)*Gd.x+Math.pow(Ga,2)*Ge.x,Gg=Math.pow(1-Ga,2)*Gc.y+2*Ga*(1-Ga)*Gd.y+Math.pow(Ga,2)*Ge.y;Gb.push(Gf,Gg)},Gb.getPoint3=function(Ga,Gb){var Gc=this._controlPoints[0],Gd=this._controlPoints[1],Ge=this._controlPoints[2],Gf=this._controlPoints[3],Gg=Math.pow(1-Ga,3)*Gc.x+3*Gd.x*Ga*(1-Ga)*(1-Ga)+3*Ge.x*Ga*Ga*(1-Ga)+Gf.x*Math.pow(Ga,3),Gh=Math.pow(1-Ga,3)*Gc.y+3*Gd.y*Ga*(1-Ga)*(1-Ga)+3*Ge.y*Ga*Ga*(1-Ga)+Gf.y*Math.pow(Ga,3);Gb.push(Gg,Gh)},Gb.insertPoints=function(Ga,Gb){var Gc,Gd=NaN;for(Gc=1/(Ga=0<Ga?Ga:5),Gd=0;Gd<=1;Gd+=Gc)this._calFun(Gd,Gb)},Gb.getBezierPoints=function(Ga,Gb,Gc){void 0===Gb&&(Gb=5),void 0===Gc&&(Gc=2);var Gd,Ge,Gf=0;if((Gd=Ga.length)<2*(Gc+1))return[];switch(Ge=[],Gc){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=Gc;)this._controlPoints.push(new GA);for(Gf=0;Gf<2*Gc;Gf+=2)this._switchPoint(Ga[Gf],Ga[Gf+1]);for(Gf=2*Gc;Gf<Gd;Gf+=2)this._switchPoint(Ga[Gf],Ga[Gf+1]),Gf/2%Gc==0&&this.insertPoints(Gb,Ge);return Ge},Gi(Ga,["I",function(){return this.I=new Ga}]),Ga}()),Gx=function(){function Gj(){}return Gr(Gj,"laya.maths.GrahamScan"),Gj.multiply=function(Ga,Gb,Gc){return(Ga.x-Gc.x)*(Gb.y-Gc.y)-(Gb.x-Gc.x)*(Ga.y-Gc.y)},Gj.dis=function(Ga,Gb){return(Ga.x-Gb.x)*(Ga.x-Gb.x)+(Ga.y-Gb.y)*(Ga.y-Gb.y)},Gj._getPoints=function(Ga,Gb,Gc){for(void 0===Gb&&(Gb=!1),Gj._mPointList||(Gj._mPointList=[]);Gj._mPointList.length<Ga;)Gj._mPointList.push(new GA);return Gc||(Gc=[]),Gc.length=0,Gb?Gj.getFrom(Gc,Gj._mPointList,Ga):Gj.getFromR(Gc,Gj._mPointList,Ga),Gc},Gj.getFrom=function(Ga,Gb,Gc){var Gd=0;for(Gd=0;Gd<Gc;Gd++)Ga.push(Gb[Gd]);return Ga},Gj.getFromR=function(Ga,Gb,Gc){var Gd=0;for(Gd=0;Gd<Gc;Gd++)Ga.push(Gb.pop());return Ga},Gj.pListToPointList=function(Ga,Gb){void 0===Gb&&(Gb=!1);var Gc=0,Gd=Ga.length/2,Ge=Gj._getPoints(Gd,Gb,Gj._tempPointList);for(Gc=0;Gc<Gd;Gc++)Ge[Gc].setTo(Ga[Gc+Gc],Ga[Gc+Gc+1]);return Ge},Gj.pointListToPlist=function(Ga){var Gb,Gc=0,Gd=Ga.length,Ge=Gj._temPList;for(Gc=Ge.length=0;Gc<Gd;Gc++)Gb=Ga[Gc],Ge.push(Gb.x,Gb.y);return Ge},Gj.scanPList=function(Ga){return G$.copyArray(Ga,Gj.pointListToPlist(Gj.scan(Gj.pListToPointList(Ga,!0))))},Gj.scan=function(Ga){var Gb,Gc,Gd,Ge=0,Gf=0,Gg=0,Gh=Ga.length,Gi={};for((Gc=Gj._temArr).length=0,Ge=(Gh=Ga.length)-1;0<=Ge;Ge--)Gd=(Gb=Ga[Ge]).x+"_"+Gb.y,Gi.hasOwnProperty(Gd)||(Gi[Gd]=!0,Gc.push(Gb));for(Gh=Gc.length,G$.copyArray(Ga,Gc),Ge=1;Ge<Gh;Ge++)(Ga[Ge].y<Ga[Gg].y||Ga[Ge].y==Ga[Gg].y&&Ga[Ge].x<Ga[Gg].x)&&(Gg=Ge);for(Gb=Ga[0],Ga[0]=Ga[Gg],Ga[Gg]=Gb,Ge=1;Ge<Gh-1;Ge++){for(Gf=(Gg=Ge)+1;Gf<Gh;Gf++)(0<Gj.multiply(Ga[Gf],Ga[Gg],Ga[0])||0==Gj.multiply(Ga[Gf],Ga[Gg],Ga[0])&&Gj.dis(Ga[0],Ga[Gf])<Gj.dis(Ga[0],Ga[Gg]))&&(Gg=Gf);Gb=Ga[Ge],Ga[Ge]=Ga[Gg],Ga[Gg]=Gb}if((Gc=Gj._temArr).length=0,Ga.length<3)return G$.copyArray(Gc,Ga);for(Gc.push(Ga[0],Ga[1],Ga[2]),Ge=3;Ge<Gh;Ge++){for(;2<=Gc.length&&0<=Gj.multiply(Ga[Ge],Gc[Gc.length-1],Gc[Gc.length-2]);)Gc.pop();Ga[Ge]&&Gc.push(Ga[Ge])}return Gc},Gj._mPointList=null,Gj._tempPointList=[],Gj._temPList=[],Gj._temArr=[],Gj}(),Gy=function(){function Ge(){}return Gr(Ge,"laya.maths.MathUtil"),Ge.subtractVector3=function(Ga,Gb,Gc){Gc[0]=Ga[0]-Gb[0],Gc[1]=Ga[1]-Gb[1],Gc[2]=Ga[2]-Gb[2]},Ge.lerp=function(Ga,Gb,Gc){return Ga*(1-Gc)+Gb*Gc},Ge.scaleVector3=function(Ga,Gb,Gc){Gc[0]=Ga[0]*Gb,Gc[1]=Ga[1]*Gb,Gc[2]=Ga[2]*Gb},Ge.lerpVector3=function(Ga,Gb,Gc,Gd){var Ge=Ga[0],Gf=Ga[1],Gg=Ga[2];Gd[0]=Ge+Gc*(Gb[0]-Ge),Gd[1]=Gf+Gc*(Gb[1]-Gf),Gd[2]=Gg+Gc*(Gb[2]-Gg)},Ge.lerpVector4=function(Ga,Gb,Gc,Gd){var Ge=Ga[0],Gf=Ga[1],Gg=Ga[2],Gh=Ga[3];Gd[0]=Ge+Gc*(Gb[0]-Ge),Gd[1]=Gf+Gc*(Gb[1]-Gf),Gd[2]=Gg+Gc*(Gb[2]-Gg),Gd[3]=Gh+Gc*(Gb[3]-Gh)},Ge.slerpQuaternionArray=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){var Gh,Gi,Gj,Gk,Gl,Go=Ga[Gb+0],Gp=Ga[Gb+1],Gq=Ga[Gb+2],Gr=Ga[Gb+3],Gs=Gc[Gd+0],Gt=Gc[Gd+1],Gu=Gc[Gd+2],Gv=Gc[Gd+3];return(Gi=Go*Gs+Gp*Gt+Gq*Gu+Gr*Gv)<0&&(Gi=-Gi,Gs=-Gs,Gt=-Gt,Gu=-Gu,Gv=-Gv),Gl=1e-6<1-Gi?(Gh=Math.acos(Gi),Gj=Math.sin(Gh),Gk=Math.sin((1-Ge)*Gh)/Gj,Math.sin(Ge*Gh)/Gj):(Gk=1-Ge,Ge),Gf[Gg+0]=Gk*Go+Gl*Gs,Gf[Gg+1]=Gk*Gp+Gl*Gt,Gf[Gg+2]=Gk*Gq+Gl*Gu,Gf[Gg+3]=Gk*Gr+Gl*Gv,Gf},Ge.getRotation=function(Ga,Gb,Gc,Gd){return Math.atan2(Gd-Gb,Gc-Ga)/Math.PI*180},Ge.sortBigFirst=function(Ga,Gb){return Ga==Gb?0:Ga<Gb?1:-1},Ge.sortSmallFirst=function(Ga,Gb){return Ga==Gb?0:Ga<Gb?-1:1},Ge.sortNumBigFirst=function(Ga,Gb){return parseFloat(Gb)-parseFloat(Ga)},Ge.sortNumSmallFirst=function(Ga,Gb){return parseFloat(Ga)-parseFloat(Gb)},Ge.sortByKey=function(Gc,Ga,Gb){var Gd;return void 0===Ga&&(Ga=!1),void 0===Gb&&(Gb=!0),Gd=Ga?Gb?Ge.sortNumBigFirst:Ge.sortBigFirst:Gb?Ge.sortNumSmallFirst:Ge.sortSmallFirst,function(Ga,Gb){return Gd(Ga[Gc],Gb[Gc])}},Ge}(),GG=function(){function Gc(Ga,Gb,Gc,Gd,Ge,Gf){this.inPool=!1,this.bTransform=!1,void 0===Ga&&(Ga=1),void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=1),void 0===Ge&&(Ge=0),void 0===Gf&&(Gf=0),this.a=Ga,this.b=Gb,this.c=Gc,this.d=Gd,this.tx=Ge,this.ty=Gf,this._checkTransform()}Gr(Gc,"laya.maths.Matrix");var Ga=Gc.prototype;return Ga.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},Ga._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},Ga.setTranslate=function(Ga,Gb){return this.tx=Ga,this.ty=Gb,this},Ga.translate=function(Ga,Gb){return this.tx+=Ga,this.ty+=Gb,this},Ga.scale=function(Ga,Gb){this.a*=Ga,this.d*=Gb,this.c*=Ga,this.b*=Gb,this.tx*=Ga,this.ty*=Gb,this.bTransform=!0},Ga.rotate=function(Ga){var Gb=Math.cos(Ga),Gc=Math.sin(Ga),Gd=this.a,Ge=this.c,Gf=this.tx;this.a=Gd*Gb-this.b*Gc,this.b=Gd*Gc+this.b*Gb,this.c=Ge*Gb-this.d*Gc,this.d=Ge*Gc+this.d*Gb,this.tx=Gf*Gb-this.ty*Gc,this.ty=Gf*Gc+this.ty*Gb,this.bTransform=!0},Ga.skew=function(Ga,Gb){var Gc=Math.tan(Ga),Gd=Math.tan(Gb),Ge=this.a,Gf=this.b;return this.a+=Gd*this.c,this.b+=Gd*this.d,this.c+=Gc*Ge,this.d+=Gc*Gf,this},Ga.invertTransformPoint=function(Ga){var Gb=this.a,Gc=this.b,Gd=this.c,Ge=this.d,Gf=this.tx,Gg=Gb*Ge-Gc*Gd,Gh=Ge/Gg,Gi=-Gc/Gg,Gj=-Gd/Gg,Gk=Gb/Gg,Gl=(Gd*this.ty-Ge*Gf)/Gg,Go=-(Gb*this.ty-Gc*Gf)/Gg;return Ga.setTo(Gh*Ga.x+Gj*Ga.y+Gl,Gi*Ga.x+Gk*Ga.y+Go)},Ga.transformPoint=function(Ga){return Ga.setTo(this.a*Ga.x+this.c*Ga.y+this.tx,this.b*Ga.x+this.d*Ga.y+this.ty)},Ga.transformPointN=function(Ga){return Ga.setTo(this.a*Ga.x+this.c*Ga.y,this.b*Ga.x+this.d*Ga.y)},Ga.transformPointArray=function(Ga,Gb){for(var Gc=Ga.length,Gd=0;Gd<Gc;Gd+=2){var Ge=Ga[Gd],Gf=Ga[Gd+1];Gb[Gd]=this.a*Ge+this.c*Gf+this.tx,Gb[Gd+1]=this.b*Ge+this.d*Gf+this.ty}return Gb},Ga.transformPointArrayScale=function(Ga,Gb){for(var Gc=Ga.length,Gd=0;Gd<Gc;Gd+=2){var Ge=Ga[Gd],Gf=Ga[Gd+1];Gb[Gd]=this.a*Ge+this.c*Gf,Gb[Gd+1]=this.b*Ge+this.d*Gf}return Gb},Ga.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},Ga.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},Ga.invert=function(){var Ga=this.a,Gb=this.b,Gc=this.c,Gd=this.d,Ge=this.tx,Gf=Ga*Gd-Gb*Gc;return this.a=Gd/Gf,this.b=-Gb/Gf,this.c=-Gc/Gf,this.d=Ga/Gf,this.tx=(Gc*this.ty-Gd*Ge)/Gf,this.ty=-(Ga*this.ty-Gb*Ge)/Gf,this},Ga.setTo=function(Ga,Gb,Gc,Gd,Ge,Gf){return this.a=Ga,this.b=Gb,this.c=Gc,this.d=Gd,this.tx=Ge,this.ty=Gf,this},Ga.concat=function(Ga){var Gb=this.a,Gc=this.c,Gd=this.tx;return this.a=Gb*Ga.a+this.b*Ga.c,this.b=Gb*Ga.b+this.b*Ga.d,this.c=Gc*Ga.a+this.d*Ga.c,this.d=Gc*Ga.b+this.d*Ga.d,this.tx=Gd*Ga.a+this.ty*Ga.c+Ga.tx,this.ty=Gd*Ga.b+this.ty*Ga.d+Ga.ty,this},Ga.scaleEx=function(Ga,Gb){var Gc=this.a,Gd=this.b,Ge=this.c,Gf=this.d;0!==Gd||0!==Ge?(this.a=Ga*Gc,this.b=Ga*Gd,this.c=Gb*Ge):(this.a=Ga*Gc,this.b=0*Gf,this.c=0*Gc),this.d=Gb*Gf,this.bTransform=!0},Ga.rotateEx=function(Ga){var Gb=Math.cos(Ga),Gc=Math.sin(Ga),Gd=this.a,Ge=this.b,Gf=this.c,Gg=this.d;0!==Ge||0!==Gf?(this.a=Gb*Gd+Gc*Gf,this.b=Gb*Ge+Gc*Gg,this.c=-Gc*Gd+Gb*Gf,this.d=-Gc*Ge+Gb*Gg):(this.a=Gb*Gd,this.b=Gc*Gg,this.c=-Gc*Gd,this.d=Gb*Gg),this.bTransform=!0},Ga.clone=function(){var Ga=Gc.create();return Ga.a=this.a,Ga.b=this.b,Ga.c=this.c,Ga.d=this.d,Ga.tx=this.tx,Ga.ty=this.ty,Ga.bTransform=this.bTransform,Ga},Ga.copyTo=function(Ga){return Ga.a=this.a,Ga.b=this.b,Ga.c=this.c,Ga.d=this.d,Ga.tx=this.tx,Ga.ty=this.ty,Ga.bTransform=this.bTransform,Ga},Ga.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},Ga.destroy=function(){if(!this.inPool){var Ga=Gc._cache;this.inPool=!0,Ga._length||(Ga._length=0),(Ga[Ga._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},Gc.mul=function(Ga,Gb,Gc){var Gd=Ga.a,Ge=Ga.b,Gf=Ga.c,Gg=Ga.d,Gh=Ga.tx,Gi=Ga.ty,Gj=Gb.a,Gk=Gb.b,Gl=Gb.c,Go=Gb.d,Gp=Gb.tx,Gq=Gb.ty;return 0!==Gk||0!==Gl?(Gc.a=Gd*Gj+Ge*Gl,Gc.b=Gd*Gk+Ge*Go,Gc.c=Gf*Gj+Gg*Gl,Gc.d=Gf*Gk+Gg*Go,Gc.tx=Gj*Gh+Gl*Gi+Gp,Gc.ty=Gk*Gh+Go*Gi+Gq):(Gc.a=Gd*Gj,Gc.b=Ge*Go,Gc.c=Gf*Gj,Gc.d=Gg*Go,Gc.tx=Gj*Gh+Gp,Gc.ty=Go*Gi+Gq),Gc},Gc.mul16=function(Ga,Gb,Gc){var Gd=Ga.a,Ge=Ga.b,Gf=Ga.c,Gg=Ga.d,Gh=Ga.tx,Gi=Ga.ty,Gj=Gb.a,Gk=Gb.b,Gl=Gb.c,Go=Gb.d,Gp=Gb.tx,Gq=Gb.ty;return 0!==Gk||0!==Gl?(Gc[0]=Gd*Gj+Ge*Gl,Gc[1]=Gd*Gk+Ge*Go,Gc[4]=Gf*Gj+Gg*Gl,Gc[5]=Gf*Gk+Gg*Go,Gc[12]=Gj*Gh+Gl*Gi+Gp,Gc[13]=Gk*Gh+Go*Gi+Gq):(Gc[0]=Gd*Gj,Gc[1]=Ge*Go,Gc[4]=Gf*Gj,Gc[5]=Gg*Go,Gc[12]=Gj*Gh+Gp,Gc[13]=Go*Gi+Gq),Gc},Gc.mulPre=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){var Gi=Ga.a,Gj=Ga.b,Gk=Ga.c,Gl=Ga.d,Go=Ga.tx,Gp=Ga.ty;return 0!==Gc||0!==Gd?(Gh.a=Gi*Gb+Gj*Gd,Gh.b=Gi*Gc+Gj*Ge,Gh.c=Gk*Gb+Gl*Gd,Gh.d=Gk*Gc+Gl*Ge,Gh.tx=Gb*Go+Gd*Gp+Gf,Gh.ty=Gc*Go+Ge*Gp+Gg):(Gh.a=Gi*Gb,Gh.b=Gj*Ge,Gh.c=Gk*Gb,Gh.d=Gl*Ge,Gh.tx=Gb*Go+Gf,Gh.ty=Ge*Gp+Gg),Gh},Gc.mulPos=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){var Gi=Ga.a,Gj=Ga.b,Gk=Ga.c,Gl=Ga.d,Go=Ga.tx,Gp=Ga.ty;return 0!==Gj||0!==Gk?(Gh.a=Gb*Gi+Gc*Gk,Gh.b=Gb*Gj+Gc*Gl,Gh.c=Gd*Gi+Ge*Gk,Gh.d=Gd*Gj+Ge*Gl,Gh.tx=Gi*Gf+Gk*Gg+Go,Gh.ty=Gj*Gf+Gl*Gg+Gp):(Gh.a=Gb*Gi,Gh.b=Gc*Gl,Gh.c=Gd*Gi,Gh.d=Ge*Gl,Gh.tx=Gi*Gf+Go,Gh.ty=Gl*Gg+Gp),Gh},Gc.preMul=function(Ga,Gb,Gc){var Gd=Ga.a,Ge=Ga.b,Gf=Ga.c,Gg=Ga.d,Gh=Gb.a,Gi=Gb.b,Gj=Gb.c,Gk=Gb.d,Gl=Gb.tx,Go=Gb.ty;return Gc.a=Gh*Gd,Gc.b=Gc.c=0,Gc.d=Gk*Gg,Gc.tx=Gl*Gd+Ga.tx,Gc.ty=Go*Gg+Ga.ty,0===Gi&&0===Gj&&0===Ge&&0===Gf||(Gc.a+=Gi*Gf,Gc.d+=Gj*Ge,Gc.b+=Gh*Ge+Gi*Gg,Gc.c+=Gj*Gd+Gk*Gf,Gc.tx+=Go*Gf,Gc.ty+=Gl*Ge),Gc},Gc.preMulXY=function(Ga,Gb,Gc,Gd){var Ge=Ga.a,Gf=Ga.b,Gg=Ga.c,Gh=Ga.d;return Gd.a=Ge,Gd.b=Gf,Gd.c=Gg,Gd.d=Gh,Gd.tx=Gb*Ge+Ga.tx+Gc*Gg,Gd.ty=Gc*Gh+Ga.ty+Gb*Gf,Gd},Gc.create=function(){var Ga=Gc._cache,Gb=Ga._length?Ga[--Ga._length]:new Gc;return Gb.inPool=!1,Gb},Gc.EMPTY=new Gc,Gc.TEMP=new Gc,Gc._cache=[],Gc}(),GA=function(){function Ga(Ga,Gb){void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),this.x=Ga,this.y=Gb}Gr(Ga,"laya.maths.Point");var Gb=Ga.prototype;return Gb.setTo=function(Ga,Gb){return this.x=Ga,this.y=Gb,this},Gb.distance=function(Ga,Gb){return Math.sqrt((this.x-Ga)*(this.x-Ga)+(this.y-Gb)*(this.y-Gb))},Gb.toString=function(){return this.x+","+this.y},Gb.normalize=function(){var Ga=Math.sqrt(this.x*this.x+this.y*this.y);if(0<Ga){var Gb=1/Ga;this.x*=Gb,this.y*=Gb}},Ga.TEMP=new Ga,Ga.EMPTY=new Ga,Ga}(),GB=function(){function Gj(Ga,Gb,Gc,Gd){void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=0),this.x=Ga,this.y=Gb,this.width=Gc,this.height=Gd}Gr(Gj,"laya.maths.Rectangle");var Ga=Gj.prototype;return Ga.setTo=function(Ga,Gb,Gc,Gd){return this.x=Ga,this.y=Gb,this.width=Gc,this.height=Gd,this},Ga.copyFrom=function(Ga){return this.x=Ga.x,this.y=Ga.y,this.width=Ga.width,this.height=Ga.height,this},Ga.contains=function(Ga,Gb){return!(this.width<=0||this.height<=0)&&(Ga>=this.x&&Ga<this.right&&Gb>=this.y&&Gb<this.bottom)},Ga.intersects=function(Ga){return!(Ga.x>this.x+this.width||Ga.x+Ga.width<this.x||Ga.y>this.y+this.height||Ga.y+Ga.height<this.y)},Ga.intersection=function(Ga,Gb){return this.intersects(Ga)?(Gb||(Gb=new Gj),Gb.x=Math.max(this.x,Ga.x),Gb.y=Math.max(this.y,Ga.y),Gb.width=Math.min(this.right,Ga.right)-Gb.x,Gb.height=Math.min(this.bottom,Ga.bottom)-Gb.y,Gb):null},Ga.union=function(Ga,Gb){return Gb||(Gb=new Gj),this.clone(Gb),Ga.width<=0||Ga.height<=0?Gb:(Gb.addPoint(Ga.x,Ga.y),Gb.addPoint(Ga.right,Ga.bottom),this)},Ga.clone=function(Ga){return Ga||(Ga=new Gj),Ga.x=this.x,Ga.y=this.y,Ga.width=this.width,Ga.height=this.height,Ga},Ga.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},Ga.equals=function(Ga){return!(!Ga||Ga.x!==this.x||Ga.y!==this.y||Ga.width!==this.width||Ga.height!==this.height)},Ga.addPoint=function(Ga,Gb){return this.x>Ga&&(this.width+=this.x-Ga,this.x=Ga),this.y>Gb&&(this.height+=this.y-Gb,this.y=Gb),this.width<Ga-this.x&&(this.width=Ga-this.x),this.height<Gb-this.y&&(this.height=Gb-this.y),this},Ga._getBoundPoints=function(){var Ga=Gj._temB;return(Ga.length=0)==this.width||0==this.height||Ga.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),Ga},Ga.isEmpty=function(){return this.width<=0||this.height<=0},Gk(0,Ga,"right",function(){return this.x+this.width}),Gk(0,Ga,"bottom",function(){return this.y+this.height}),Gj._getBoundPointS=function(Ga,Gb,Gc,Gd){var Ge=Gj._temA;return(Ge.length=0)==Gc||0==Gd||Ge.push(Ga,Gb,Ga+Gc,Gb,Ga,Gb+Gd,Ga+Gc,Gb+Gd),Ge},Gj._getWrapRec=function(Ga,Gb){if(!Ga||Ga.length<1)return Gb?Gb.setTo(0,0,0,0):Gj.TEMP.setTo(0,0,0,0);Gb=Gb||new Gj;var Gc,Gd,Ge,Gf,Gg,Gh=Ga.length,Gi=GA.TEMP;for(Ge=Gg=-(Gd=Gf=99999),Gc=0;Gc<Gh;Gc+=2)Gi.x=Ga[Gc],Gi.y=Ga[Gc+1],Gd=Gd<Gi.x?Gd:Gi.x,Gf=Gf<Gi.y?Gf:Gi.y,Ge=Ge>Gi.x?Ge:Gi.x,Gg=Gg>Gi.y?Gg:Gi.y;return Gb.setTo(Gd,Gf,Ge-Gd,Gg-Gf)},Gj.EMPTY=new Gj,Gj.TEMP=new Gj,Gj._temB=[],Gj._temA=[],Gj}(),GE=function(){function Gi(){}return Gr(Gi,"laya.media.SoundManager"),Gk(1,Gi,"useAudioMusic",function(){return Gi._useAudioMusic},function(Ga){Gi._useAudioMusic=Ga,Gi._musicClass=Ga?Gca:null}),Gk(1,Gi,"autoStopMusic",function(){return Gi._autoStopMusic},function(Ga){Gz.stage.off("blur",null,Gi._stageOnBlur),Gz.stage.off("focus",null,Gi._stageOnFocus),Gz.stage.off("visibilitychange",null,Gi._visibilityChange),(Gi._autoStopMusic=Ga)&&(Gz.stage.on("blur",null,Gi._stageOnBlur),Gz.stage.on("focus",null,Gi._stageOnFocus),Gz.stage.on("visibilitychange",null,Gi._visibilityChange))}),Gk(1,Gi,"muted",function(){return Gi._muted},function(Ga){Ga!=Gi._muted&&(Ga&&Gi.stopAllSound(),Gi.musicMuted=Ga,Gi._muted=Ga)}),Gk(1,Gi,"musicMuted",function(){return Gi._musicMuted},function(Ga){Ga!=Gi._musicMuted&&(Ga?(Gi._tMusic&&Gi._musicChannel&&!Gi._musicChannel.isStopped?Gi._musicChannel.pause():Gi._musicChannel=null,Gi._musicMuted=Ga):(Gi._musicMuted=Ga,Gi._tMusic&&Gi._musicChannel&&Gi._musicChannel.resume()))}),Gk(1,Gi,"soundMuted",function(){return Gi._soundMuted},function(Ga){Gi._soundMuted=Ga}),Gi.addChannel=function(Ga){0<=Gi._channels.indexOf(Ga)||(Gi._channels.push(Ga),Gi.autoReleaseSound&&0!=Gi._notUsedCount&&Gi._notUsedUrls[Ga.url]&&(delete Gi._notUsedUrls[Ga.url],0==--Gi._notUsedCount&&Gz.timer.clear(Gi,Gi.disposeSoundIfNotUsed)))},Gi.removeChannel=function(Ga){var Gb=Gi._channels,Gc=Gb.indexOf(Ga);if(-1!=Gc&&(Gb.splice(Gc,1),Gi.autoReleaseSound)){var Gd=Ga.url,Ge=Gi.defaultIntervals[Gd]||2e4;if(0<Ge){var Gf=!0;for(Gc=Gb.length-1;0<=Gc;Gc--)if(Gb[Gc].url==Gd){Gf=!1;break}Gf&&(Gi._notUsedUrls[Gd]=Date.now()+Ge,0==Gi._notUsedCount++&&Gz.timer.loop(1e4,Gi,Gi.disposeSoundIfNotUsed))}}},Gi.disposeSoundIfNotUsed=function(){var Ga=Gi._notUsedUrls;if(0!=Gi._notUsedCount){var Gb=Date.now();for(var Gc in Ga)Gb>=Ga[Gc]&&(delete Ga[Gc],--Gi._notUsedCount,Gi.destroySound(Gc));if(0!=Gi._notUsedCount)return}Gz.timer.clear(Gi,Gi.disposeSoundIfNotUsed)},Gi._visibilityChange=function(){Gz.stage.isVisibility?Gi._stageOnFocus():Gi._stageOnBlur()},Gi._stageOnBlur=function(){Gi._isActive=!1,Gi._musicChannel&&(Gi._musicChannel.isStopped||(Gi._blurPaused=!0,Gi._musicChannel.pause())),Gi.stopAllSound(),Gz.stage.once("mousedown",null,Gi._stageOnFocus)},Gi._recoverWebAudio=function(){Gfa.ctx&&"running"!=Gfa.ctx.state&&Gfa.ctx.resume&&Gfa.ctx.resume()},Gi._stageOnFocus=function(){if(Gi._isActive=!0,Gi._recoverWebAudio(),Gz.stage.off("mousedown",null,Gi._stageOnFocus),Gi._blurPaused){var Ga=Gi._musicChannel;Ga&&Gi._music&&Ga.isStopped&&(Gi._blurPaused=!1,Gi._music._disposed?Gi.playMusic(Ga.url,Ga.loops,Ga.startHandler,Ga.completeHandler,Ga.startTime):Ga.audioBuffer?Ga.resume():Gi._music.play(Ga.startTime,Ga.loops,Ga.startHandler,Ga))}},Gi.playSound=function(Ga,Gb,Gc,Gd,Ge,Gf){if(void 0===Gb&&(Gb=1),void 0===Gf&&(Gf=0),!Ga)return null;if(Gi._muted)return null;if(Gi._recoverWebAudio(),Ga==Gi._tMusic){if(Gi._musicMuted)return null}else{if(!Gi._isActive)return null;if(Gi._soundMuted)return null}var Gg,Gh=Gi._pool[Ga];return Ge||(Ge=Gi._soundClass),Gh||((Gh=new Ge).load(Ga),Gi._pool[Ga]=Gh),(Gg=Gh.play(Gf,Gb,Gc))?(Ga==Gi._tMusic&&(Gi._music=Gh,Gi._isActive||(Gi._blurPaused=!0,Gg.pause())),Gg.url=Ga,Gg.volume=Ga==Gi._tMusic?Gi.musicVolume:Gi.soundVolume,Gg.completeHandler=Gd,Gg):null},Gi.destroySound=function(Ga){var Gb=Gi._pool[Ga];Gb&&(delete Gi._pool[Ga],Gb.dispose())},Gi.playMusic=function(Ga,Gb,Gc,Gd,Ge){return void 0===Gb&&(Gb=0),void 0===Ge&&(Ge=0),Gi._tMusic=Ga,Gi._musicChannel&&Gi._musicChannel.stop(),Gi._musicChannel=Gi.playSound(Ga,Gb,Gc,Gd,null,Ge)},Gi.stopSound=function(Ga){for(var Gb,Gc=Gi._channels.length-1;0<=Gc;Gc--)(Gb=Gi._channels[Gc]).url==Ga&&Gb.stop()},Gi.stopAll=function(){Gi._tMusic=null;var Ga=0;for(Ga=Gi._channels.length-1;0<=Ga;Ga--)Gi._channels[Ga].stop()},Gi.stopAllSound=function(){var Ga,Gb=0;for(Gb=Gi._channels.length-1;0<=Gb;Gb--)(Ga=Gi._channels[Gb]).url!=Gi._tMusic&&Ga.stop()},Gi.stopMusic=function(){Gi._musicChannel&&Gi._musicChannel.stop(),Gi._tMusic=null},Gi.setSoundVolume=function(Ga,Gb){if(Gb)Gi._setVolume(Gb,Ga);else{Gi.soundVolume=Ga;var Gc,Gd=0;for(Gd=Gi._channels.length-1;0<=Gd;Gd--)(Gc=Gi._channels[Gd]).url!=Gi._tMusic&&(Gc.volume=Ga)}},Gi.setMusicVolume=function(Ga){Gi.musicVolume=Ga,Gi._setVolume(Gi._tMusic,Ga)},Gi._setVolume=function(Ga,Gb){for(var Gc,Gd=Gi._channels.length-1;0<=Gd;Gd--)(Gc=Gi._channels[Gd]).url==Ga&&(Gc.volume=Gb)},Gi.musicVolume=1,Gi.soundVolume=1,Gi.playbackRate=1,Gi._useAudioMusic=!0,Gi._muted=!1,Gi._soundMuted=!1,Gi._musicMuted=!1,Gi._tMusic=null,Gi._musicChannel=null,Gi._music=null,Gi._channels=[],Gi._autoStopMusic=!1,Gi._blurPaused=!1,Gi._isActive=!0,Gi._soundClass=null,Gi._musicClass=null,Gi.autoReleaseSound=!0,Gi._pool={},Gi.defaultIntervals={},Gi._notUsedUrls={},Gi._notUsedCount=0,Gi}(),GC=function(){var Ga;function Gc(){}return Gr(Gc,"laya.net.LocalStorage"),Gc.__init__=function(){Gc._baseClass||(Gc._baseClass=Ga).init(),Gc.items=Gc._baseClass.items,Gc.support=Gc._baseClass.support},Gc.setItem=function(Ga,Gb){Gc._baseClass.setItem(Ga,Gb)},Gc.getItem=function(Ga){return Gc._baseClass.getItem(Ga)},Gc.setJSON=function(Ga,Gb){Gc._baseClass.setJSON(Ga,Gb)},Gc.getJSON=function(Ga){return Gc._baseClass.getJSON(Ga)},Gc.removeItem=function(Ga){Gc._baseClass.removeItem(Ga)},Gc.clear=function(){Gc._baseClass.clear()},Gc._baseClass=null,Gc.items=null,Gc.support=!1,Gc.__init$=function(){Ga=function(){function Gc(){}return Gr(Gc,""),Gc.init=function(){try{Gc.support=!0,Gc.items=Gg.localStorage,Gc.setItem("laya","1"),Gc.removeItem("laya")}catch(Ga){Gc.support=!1}Gc.support||console.log("LocalStorage is not supprot or browser is private mode.")},Gc.setItem=function(Ga,Gb){try{Gc.support&&Gc.items.setItem(Ga,Gb)}catch(Ga){console.warn("set localStorage failed",Ga)}},Gc.getItem=function(Ga){return Gc.support?Gc.items.getItem(Ga):null},Gc.setJSON=function(Ga,Gb){try{Gc.support&&Gc.items.setItem(Ga,JSON.stringify(Gb))}catch(Ga){console.warn("set localStorage failed",Ga)}},Gc.getJSON=function(Ga){return JSON.parse(Gc.support?Gc.items.getItem(Ga):null)},Gc.removeItem=function(Ga){Gc.support&&Gc.items.removeItem(Ga)},Gc.clear=function(){Gc.support&&Gc.items.clear()},Gc.items=null,Gc.support=!1,Gc}()},Gc}(),GH=(function(){function Gd(){}Gr(Gd,"laya.net.ResourceVersion"),Gd.enable=function(Ga,Gb,Gc){void 0===Gc&&(Gc=2),laya.net.ResourceVersion.type=Gc,Gz.loader.load(Ga,Gu.create(null,Gd.onManifestLoaded,[Gb]),null,"json"),GI.customFormat=Gd.addVersionPrefix},Gd.onManifestLoaded=function(Ga,Gb){Gd.manifest=Gb,Ga.run(),Gb||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},Gd.addVersionPrefix=function(Ga){return Gd.manifest&&Gd.manifest[Ga]?2==Gd.type?Gd.manifest[Ga]:Gd.manifest[Ga]+"/"+Ga:Ga},Gd.FOLDER_VERSION=1,Gd.FILENAME_VERSION=2,Gd.manifest=null,Gd.type=1}(),function(){function Ga(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}Gr(Ga,"laya.net.TTFLoader");var Gb=Ga.prototype;return Gb.load=function(Ga){var Gb=(this._url=Ga).split(".ttf")[0].split("/");this.fontName=Gb[Gb.length-1],GO.window.conch?this._loadConch():GO.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},Gb._loadConch=function(){this._http=new Gga,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},Gb._onHttpLoaded=function(Ga){GO.window.conch.setFontFaceFromBuffer(this.fontName,Ga),this._clearHttp(),this._complete()},Gb._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},Gb._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},Gb._complete=function(){Gz.timer.clear(this,this._complete),Gz.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},Gb._checkComplete=function(){GF.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},Gb._loadWithFontFace=function(){var Ga=new GO.window.FontFace(this.fontName,"url('"+this._url+"')");GO.window.document.fonts.add(Ga);var Gb=this;Ga.loaded.then(function(){Gb._complete()}),Ga.load()},Gb._createDiv=function(){this._div=GO.createElement("div"),this._div.innerHTML="laya";var Ga=this._div.style;Ga.fontFamily=this.fontName,Ga.position="absolute",Ga.left="-100px",Ga.top="-100px",GO.document.body.appendChild(this._div)},Gb._loadWithCSS=function(){var Ga=this,Gb=GO.createElement("style");Gb.type="text/css",GO.document.body.appendChild(Gb),Gb.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=GF.measureText("LayaTTFFont",this._fontTxt).width;var Gc=this;Gb.onload=function(){Gz.timer.once(1e4,Gc,Ga._complete)},Gz.timer.loop(20,this,this._checkComplete),this._createDiv()},Ga._testString="LayaTTFFont",Ga}()),GI=function(){function Gd(Ga){this._url=null,this._path=null,this._url=Gd.formatURL(Ga),this._path=Gd.getPath(Ga)}Gr(Gd,"laya.net.URL");var Ga=Gd.prototype;return Gk(0,Ga,"path",function(){return this._path}),Gk(0,Ga,"url",function(){return this._url}),Gd.formatURL=function(Ga,Gb){if(!Ga)return"null path";if(0<Ga.indexOf(":"))return Ga;null!=Gd.customFormat&&(Ga=Gd.customFormat(Ga,Gb));var Gc=Ga.charAt(0);if("."===Gc)return Gd.formatRelativePath((Gb||Gd.basePath)+Ga);if("~"===Gc)return Gd.rootPath+Ga.substring(1);if("d"===Gc){if(0===Ga.indexOf("data:image"))return Ga}else if("/"===Gc)return Ga;return(Gb||Gd.basePath)+Ga},Gd.formatRelativePath=function(Ga){for(var Gb=Ga.split("/"),Gc=0,Gd=Gb.length;Gc<Gd;Gc++)".."==Gb[Gc]&&(Gb.splice(Gc-1,2),Gc-=2);return Gb.join("/")},Gd.isAbsolute=function(Ga){return 0<Ga.indexOf(":")||"/"==Ga.charAt(0)},Gd.getPath=function(Ga){var Gb=Ga.lastIndexOf("/");return 0<Gb?Ga.substr(0,Gb+1):""},Gd.getFileName=function(Ga){var Gb=Ga.lastIndexOf("/");return 0<Gb?Ga.substr(Gb+1):Ga},Gd.version={},Gd.basePath="",Gd.rootPath="",Gd.customFormat=function(Ga){var Gb=Gd.version[Ga];return!GJ.isConchApp&&Gb&&(Ga+="?v="+Gb),Ga},Gd}(),GJ=function(){function Ge(Ga,Gb){this._timeId=0;var Gc=Ge._mainCanvas.source.style;Gc.position="absolute",Gc.top=Gc.left="0px",Gc.background="#000000",Ge._mainCanvas.source.id="layaCanvas";var Gd=laya.renders.Render.isWebGL;Ge._mainCanvas.source.width=Ga,Ge._mainCanvas.source.height=Gb,Gd&&Ge.WebGL.init(Ge._mainCanvas,Ga,Gb),GO.container.appendChild(Ge._mainCanvas.source),(Ge._context=new GK(Ga,Gb,Gd?null:Ge._mainCanvas)).ctx.setIsMainContext(),GO.window.requestAnimationFrame(function Ga(Gb){GO.window.requestAnimationFrame(Ga);Gz.stage._loop()}),Gz.stage.on("visibilitychange",this,this._onVisibilitychange)}Gr(Ge,"laya.renders.Render");var Ga=Ge.prototype;return Ga._onVisibilitychange=function(){Gz.stage.isVisibility?0!=this._timeId&&GO.window.clearInterval(this._timeId):this._timeId=GO.window.setInterval(this._enterFrame,1e3)},Ga._enterFrame=function(Ga){Gz.stage._loop()},Gk(1,Ge,"context",function(){return Ge._context}),Gk(1,Ge,"canvas",function(){return Ge._mainCanvas.source}),Ge._context=null,Ge._mainCanvas=null,Ge.WebGL=null,Ge.isConchNode=!1,Ge.isConchApp=!1,Ge.isConchWebGL=!1,Ge.isWebGL=!1,Ge.is3DMode=!1,Ge.optimizeTextureMemory=function(Ga,Gb){return!0},Ge.__init$=function(){Gg.ConchRenderType=Gg.ConchRenderType||1,Gg.ConchRenderType|=Gg.conch?4:0,Ge.isConchNode=5==(5&Gg.ConchRenderType),Ge.isConchApp=4==(4&Gg.ConchRenderType),Ge.isConchWebGL=6==Gg.ConchRenderType},Ge}(),GK=function(){function Gg(Ga,Gb,Gc){this.x=0,this.y=0,this._drawTexture=function(Ga,Gb,Gc){Gc[0].loaded&&this.ctx.drawTexture(Gc[0],Gc[1],Gc[2],Gc[3],Gc[4],Ga,Gb)},this._fillTexture=function(Ga,Gb,Gc){Gc[0].loaded&&this.ctx.fillTexture(Gc[0],Gc[1]+Ga,Gc[2]+Gb,Gc[3],Gc[4],Gc[5],Gc[6],Gc[7])},this._drawTextureWithTransform=function(Ga,Gb,Gc){Gc[0].loaded&&this.ctx.drawTextureWithTransform(Gc[0],Gc[1],Gc[2],Gc[3],Gc[4],Gc[5],Ga,Gb,Gc[6])},this._fillQuadrangle=function(Ga,Gb,Gc){this.ctx.fillQuadrangle(Gc[0],Gc[1],Gc[2],Gc[3],Gc[4])},this._drawRect=function(Ga,Gb,Gc){var Gd=this.ctx;null!=Gc[4]&&(Gd.fillStyle=Gc[4],Gd.fillRect(Ga+Gc[0],Gb+Gc[1],Gc[2],Gc[3],null)),null!=Gc[5]&&(Gd.strokeStyle=Gc[5],Gd.lineWidth=Gc[6],Gd.strokeRect(Ga+Gc[0],Gb+Gc[1],Gc[2],Gc[3],Gc[6]))},this._drawPie=function(Ga,Gb,Gc){var Gd=this.ctx;GJ.isWebGL&&Gd.setPathId(Gc[8]),Gd.beginPath(),GJ.isWebGL?(Gd.movePath(Gc[0]+Ga,Gc[1]+Gb),Gd.moveTo(0,0)):Gd.moveTo(Ga+Gc[0],Gb+Gc[1]),Gd.arc(Ga+Gc[0],Gb+Gc[1],Gc[2],Gc[3],Gc[4]),Gd.closePath(),this._fillAndStroke(Gc[5],Gc[6],Gc[7],!0)},this._clipRect=function(Ga,Gb,Gc){this.ctx.clipRect(Ga+Gc[0],Gb+Gc[1],Gc[2],Gc[3])},this._fillRect=function(Ga,Gb,Gc){this.ctx.fillRect(Ga+Gc[0],Gb+Gc[1],Gc[2],Gc[3],Gc[4])},this._drawCircle=function(Ga,Gb,Gc){var Gd=this.ctx;GJ.isWebGL&&Gd.setPathId(Gc[6]),GX.drawCall++,Gd.beginPath(),GJ.isWebGL&&Gd.movePath(Gc[0]+Ga,Gc[1]+Gb),Gd.arc(Gc[0]+Ga,Gc[1]+Gb,Gc[2],0,Gg.PI2),Gd.closePath(),this._fillAndStroke(Gc[3],Gc[4],Gc[5],!0)},this._fillCircle=function(Ga,Gb,Gc){GX.drawCall++;var Gd=this.ctx;Gd.beginPath(),Gd.fillStyle=Gc[3],Gd.arc(Gc[0]+Ga,Gc[1]+Gb,Gc[2],0,Gg.PI2),Gd.fill()},this._setShader=function(Ga,Gb,Gc){this.ctx.setShader(Gc[0])},this._drawLine=function(Ga,Gb,Gc){var Gd=this.ctx;GJ.isWebGL&&Gd.setPathId(Gc[6]),Gd.beginPath(),Gd.strokeStyle=Gc[4],Gd.lineWidth=Gc[5],GJ.isWebGL?(Gd.movePath(Ga,Gb),Gd.moveTo(Gc[0],Gc[1]),Gd.lineTo(Gc[2],Gc[3])):(Gd.moveTo(Ga+Gc[0],Gb+Gc[1]),Gd.lineTo(Ga+Gc[2],Gb+Gc[3])),Gd.stroke()},this._drawLines=function(Ga,Gb,Gc){var Gd=this.ctx;GJ.isWebGL&&Gd.setPathId(Gc[5]),Gd.beginPath(),Ga+=Gc[0],Gb+=Gc[1],GJ.isWebGL&&Gd.movePath(Ga,Gb),Gd.strokeStyle=Gc[3],Gd.lineWidth=Gc[4];var Ge=Gc[2],Gf=2,Gg=Ge.length;if(GJ.isWebGL)for(Gd.moveTo(Ge[0],Ge[1]);Gf<Gg;)Gd.lineTo(Ge[Gf++],Ge[Gf++]);else for(Gd.moveTo(Ga+Ge[0],Gb+Ge[1]);Gf<Gg;)Gd.lineTo(Ga+Ge[Gf++],Gb+Ge[Gf++]);Gd.stroke()},this._drawLinesWebGL=function(Ga,Gb,Gc){this.ctx.drawLines(Ga+this.x+Gc[0],Gb+this.y+Gc[1],Gc[2],Gc[3],Gc[4])},this._drawCurves=function(Ga,Gb,Gc){this.ctx.drawCurves(Ga,Gb,Gc)},this._draw=function(Ga,Gb,Gc){Gc[0].call(null,this,Ga,Gb)},this._transformByMatrix=function(Ga,Gb,Gc){this.ctx.transformByMatrix(Gc[0])},this._setTransform=function(Ga,Gb,Gc){this.ctx.setTransform(Gc[0],Gc[1],Gc[2],Gc[3],Gc[4],Gc[5])},this._setTransformByMatrix=function(Ga,Gb,Gc){this.ctx.setTransformByMatrix(Gc[0])},this._save=function(Ga,Gb,Gc){this.ctx.save()},this._restore=function(Ga,Gb,Gc){this.ctx.restore()},this._translate=function(Ga,Gb,Gc){this.ctx.translate(Gc[0],Gc[1])},this._transform=function(Ga,Gb,Gc){this.ctx.translate(Gc[1]+Ga,Gc[2]+Gb);var Gd=Gc[0];this.ctx.transform(Gd.a,Gd.b,Gd.c,Gd.d,Gd.tx,Gd.ty),this.ctx.translate(-Ga-Gc[1],-Gb-Gc[2])},this._rotate=function(Ga,Gb,Gc){this.ctx.translate(Gc[1]+Ga,Gc[2]+Gb),this.ctx.rotate(Gc[0]),this.ctx.translate(-Ga-Gc[1],-Gb-Gc[2])},this._scale=function(Ga,Gb,Gc){this.ctx.translate(Gc[2]+Ga,Gc[3]+Gb),this.ctx.scale(Gc[0],Gc[1]),this.ctx.translate(-Ga-Gc[2],-Gb-Gc[3])},this._alpha=function(Ga,Gb,Gc){this.ctx.globalAlpha*=Gc[0]},this._setAlpha=function(Ga,Gb,Gc){this.ctx.globalAlpha=Gc[0]},this._fillText=function(Ga,Gb,Gc){this.ctx.fillText(Gc[0],Gc[1]+Ga,Gc[2]+Gb,Gc[3],Gc[4],Gc[5])},this._strokeText=function(Ga,Gb,Gc){this.ctx.strokeText(Gc[0],Gc[1]+Ga,Gc[2]+Gb,Gc[3],Gc[4],Gc[5],Gc[6])},this._fillBorderText=function(Ga,Gb,Gc){this.ctx.fillBorderText(Gc[0],Gc[1]+Ga,Gc[2]+Gb,Gc[3],Gc[4],Gc[5],Gc[6],Gc[7])},this._blendMode=function(Ga,Gb,Gc){this.ctx.globalCompositeOperation=Gc[0]},this._beginClip=function(Ga,Gb,Gc){this.ctx.beginClip&&this.ctx.beginClip(Ga+Gc[0],Gb+Gc[1],Gc[2],Gc[3])},this._setIBVB=function(Ga,Gb,Gc){this.ctx.setIBVB(Gc[0]+Ga,Gc[1]+Gb,Gc[2],Gc[3],Gc[4],Gc[5],Gc[6],Gc[7])},this._fillTrangles=function(Ga,Gb,Gc){this.ctx.fillTrangles(Gc[0],Gc[1]+Ga,Gc[2]+Gb,Gc[3],Gc[4])},this._drawPath=function(Ga,Gb,Gc){var Gd=this.ctx;GJ.isWebGL&&Gd.setPathId(-1),Gd.beginPath(),Ga+=Gc[0],Gb+=Gc[1],GJ.isWebGL&&Gd.movePath(Ga,Gb);for(var Ge=Gc[2],Gf=0,Gg=Ge.length;Gf<Gg;Gf++){var Gh=Ge[Gf];switch(Gh[0]){case"moveTo":GJ.isWebGL?Gd.moveTo(Gh[1],Gh[2]):Gd.moveTo(Ga+Gh[1],Gb+Gh[2]);break;case"lineTo":GJ.isWebGL?Gd.lineTo(Gh[1],Gh[2]):Gd.lineTo(Ga+Gh[1],Gb+Gh[2]);break;case"arcTo":GJ.isWebGL?Gd.arcTo(Gh[1],Gh[2],Gh[3],Gh[4],Gh[5]):Gd.arcTo(Ga+Gh[1],Gb+Gh[2],Ga+Gh[3],Gb+Gh[4],Gh[5]);break;case"closePath":Gd.closePath()}}var Gi=Gc[3];null!=Gi&&(Gd.fillStyle=Gi.fillStyle,Gd.fill());var Gj=Gc[4];null!=Gj&&(Gd.strokeStyle=Gj.strokeStyle,Gd.lineWidth=Gj.lineWidth||1,Gd.lineJoin=Gj.lineJoin,Gd.lineCap=Gj.lineCap,Gd.miterLimit=Gj.miterLimit,Gd.stroke())},this.drawPoly=function(Ga,Gb,Gc){this.ctx.drawPoly(Ga+this.x+Gc[0],Gb+this.y+Gc[1],Gc[2],Gc[3],Gc[4],Gc[5],Gc[6])},this._drawPoly=function(Ga,Gb,Gc){var Gd=this.ctx,Ge=Gc[2],Gf=2,Gg=Ge.length;if(GJ.isWebGL)for(Gd.setPathId(Gc[6]),Gd.beginPath(),Ga+=Gc[0],Gb+=Gc[1],Gd.movePath(Ga,Gb),Gd.moveTo(Ge[0],Ge[1]);Gf<Gg;)Gd.lineTo(Ge[Gf++],Ge[Gf++]);else for(Gd.beginPath(),Ga+=Gc[0],Gb+=Gc[1],Gd.moveTo(Ga+Ge[0],Gb+Ge[1]);Gf<Gg;)Gd.lineTo(Ga+Ge[Gf++],Gb+Ge[Gf++]);Gd.closePath(),this._fillAndStroke(Gc[3],Gc[4],Gc[5],Gc[7])},this._drawSkin=function(Ga,Gb,Gc){var Gd=Gc[0];if(Gd){var Ge=this.ctx;Gd.render(Ge,Ga,Gb)}},this._drawParticle=function(Ga,Gb,Gc){this.ctx.drawParticle(Ga+this.x,Gb+this.y,Gc[0])},this._setFilters=function(Ga,Gb,Gc){this.ctx.setFilters(Gc)},Gc?this.ctx=Gc.getContext("2d"):(Gc=Gva.create("3D"),this.ctx=GF.createWebGLContext2D(Gc),Gc._setContext(this.ctx)),Gc.size(Ga,Gb),this.canvas=Gc}Gr(Gg,"laya.renders.RenderContext");var Ga=Gg.prototype;return Ga.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},Ga.drawTexture=function(Ga,Gb,Gc,Gd,Ge){Ga.loaded&&this.ctx.drawTexture(Ga,Gb,Gc,Gd,Ge,this.x,this.y)},Ga._drawTextures=function(Ga,Gb,Gc){Gc[0].loaded&&this.ctx.drawTextures(Gc[0],Gc[1],Ga+this.x,Gb+this.y)},Ga.drawTextureWithTransform=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){Ga.loaded&&this.ctx.drawTextureWithTransform(Ga,Gb,Gc,Gd,Ge,Gf,this.x,this.y,Gg)},Ga.fillQuadrangle=function(Ga,Gb,Gc,Gd,Ge){this.ctx.fillQuadrangle(Ga,Gb,Gc,Gd,Ge)},Ga.drawCanvas=function(Ga,Gb,Gc,Gd,Ge){this.ctx.drawCanvas(Ga,Gb+this.x,Gc+this.y,Gd,Ge)},Ga.drawRect=function(Ga,Gb,Gc,Gd,Ge,Gf){void 0===Gf&&(Gf=1);var Gg=this.ctx;Gg.strokeStyle=Ge,Gg.lineWidth=Gf,Gg.strokeRect(Ga+this.x,Gb+this.y,Gc,Gd,Gf)},Ga._fillAndStroke=function(Ga,Gb,Gc,Gd){void 0===Gd&&(Gd=!1);var Ge=this.ctx;null!=Ga&&(Ge.fillStyle=Ga,GJ.isWebGL?Ge.fill(Gd):Ge.fill()),null!=Gb&&0<Gc&&(Ge.strokeStyle=Gb,Ge.lineWidth=Gc,Ge.stroke())},Ga.clipRect=function(Ga,Gb,Gc,Gd){this.ctx.clipRect(Ga+this.x,Gb+this.y,Gc,Gd)},Ga.fillRect=function(Ga,Gb,Gc,Gd,Ge){this.ctx.fillRect(Ga+this.x,Gb+this.y,Gc,Gd,Ge)},Ga.drawCircle=function(Ga,Gb,Gc,Gd,Ge){void 0===Ge&&(Ge=1),GX.drawCall++;var Gf=this.ctx;Gf.beginPath(),Gf.strokeStyle=Gd,Gf.lineWidth=Ge,Gf.arc(Ga+this.x,Gb+this.y,Gc,0,Gg.PI2),Gf.stroke()},Ga.drawTriangles=function(Ga,Gb,Gc){if(GJ.isWebGL)this.ctx.drawTriangles(Gc[0],Ga+Gc[1],Gb+Gc[2],Gc[3],Gc[4],Gc[5],Gc[6],Gc[7],Gc[8],Gc[9]);else{var Gd=Gc[5],Ge=0,Gf=Gd.length,Gg=this.ctx;for(Ge=0;Ge<Gf;Ge+=3){var Gh=2*Gd[Ge],Gi=2*Gd[Ge+1],Gj=2*Gd[Ge+2];Gg.drawTriangle(Gc[0],Gc[3],Gc[4],Gh,Gi,Gj,Gc[6],!0)}}},Ga.fillCircle=function(Ga,Gb,Gc,Gd){GX.drawCall++;var Ge=this.ctx;Ge.beginPath(),Ge.fillStyle=Gd,Ge.arc(Ga+this.x,Gb+this.y,Gc,0,Gg.PI2),Ge.fill()},Ga.setShader=function(Ga){this.ctx.setShader(Ga)},Ga.drawLine=function(Ga,Gb,Gc,Gd,Ge,Gf){void 0===Gf&&(Gf=1);var Gg=this.ctx;Gg.beginPath(),Gg.strokeStyle=Ge,Gg.lineWidth=Gf,Gg.moveTo(this.x+Ga,this.y+Gb),Gg.lineTo(this.x+Gc,this.y+Gd),Gg.stroke()},Ga.clear=function(){this.ctx.clear()},Ga.transformByMatrix=function(Ga){this.ctx.transformByMatrix(Ga)},Ga.setTransform=function(Ga,Gb,Gc,Gd,Ge,Gf){this.ctx.setTransform(Ga,Gb,Gc,Gd,Ge,Gf)},Ga.setTransformByMatrix=function(Ga){this.ctx.setTransformByMatrix(Ga)},Ga.save=function(){this.ctx.save()},Ga.restore=function(){this.ctx.restore()},Ga.translate=function(Ga,Gb){this.ctx.translate(Ga,Gb)},Ga.transform=function(Ga,Gb,Gc,Gd,Ge,Gf){this.ctx.transform(Ga,Gb,Gc,Gd,Ge,Gf)},Ga.rotate=function(Ga){this.ctx.rotate(Ga)},Ga.scale=function(Ga,Gb){this.ctx.scale(Ga,Gb)},Ga.alpha=function(Ga){this.ctx.globalAlpha*=Ga},Ga.setAlpha=function(Ga){this.ctx.globalAlpha=Ga},Ga.fillWords=function(Ga,Gb,Gc,Gd,Ge,Gf){void 0===Gf&&(Gf=0),this.ctx.fillWords(Ga,Gb,Gc,Gd,Ge,Gf)},Ga.fillBorderWords=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this.ctx.fillBorderWords(Ga,Gb,Gc,Gd,Ge,Gf,Gg)},Ga.fillText=function(Ga,Gb,Gc,Gd,Ge,Gf){this.ctx.fillText(Ga,Gb+this.x,Gc+this.y,Gd,Ge,Gf)},Ga.strokeText=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this.ctx.strokeText(Ga,Gb+this.x,Gc+this.y,Gd,Ge,Gf,Gg)},Ga.blendMode=function(Ga){this.ctx.globalCompositeOperation=Ga},Ga.flush=function(){this.ctx.flush&&this.ctx.flush()},Ga.addRenderObject=function(Ga){this.ctx.addRenderObject(Ga)},Ga.beginClip=function(Ga,Gb,Gc,Gd){this.ctx.beginClip&&this.ctx.beginClip(Ga,Gb,Gc,Gd)},Ga.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},Ga.fillTrangles=function(Ga,Gb,Gc){this.ctx.fillTrangles(Gc[0],Gc[1],Gc[2],Gc[3],4<Gc.length?Gc[4]:null)},Gg.PI2=2*Math.PI,Gg}(),GL=function(){function Gg(Ga,Gb){switch(this._next=Gb||Gg.NORENDER,Ga){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=Gt._filter);case 69905:return void(this._fun=Gg._initRenderFun)}this.onCreate(Ga)}Gr(Gg,"laya.renders.RenderSprite");var Ga=Gg.prototype;return Ga.onCreate=function(Ga){},Ga._style=function(Ga,Gb,Gc,Gd){Ga._style.render(Ga,Gb,Gc,Gd);var Ge=this._next;Ge._fun.call(Ge,Ga,Gb,Gc,Gd)},Ga._no=function(Ga,Gb,Gc,Gd){},Ga._custom=function(Ga,Gb,Gc,Gd){Ga.customRender(Gb,Gc,Gd);var Ge=Ga._style._tf;this._next._fun.call(this._next,Ga,Gb,Gc-Ge.translateX,Gd-Ge.translateY)},Ga._clip=function(Ga,Gb,Gc,Gd){var Ge=this._next;if(Ge!=Gg.NORENDER){var Gf=Ga._style.scrollRect;Gb.ctx.save(),Gb.ctx.clipRect(Gc,Gd,Gf.width,Gf.height),Ge._fun.call(Ge,Ga,Gb,Gc-Gf.x,Gd-Gf.y),Gb.ctx.restore()}},Ga._blend=function(Ga,Gb,Gc,Gd){var Ge=Ga._style;Ge.blendMode&&(Gb.ctx.globalCompositeOperation=Ge.blendMode);var Gf=this._next;Gf._fun.call(Gf,Ga,Gb,Gc,Gd),Gb.ctx.globalCompositeOperation="source-over"},Ga._mask=function(Ga,Gb,Gc,Gd){var Ge=this._next;Ge._fun.call(Ge,Ga,Gb,Gc,Gd);var Gf=Ga.mask;Gf&&(Gb.ctx.globalCompositeOperation="destination-in",(0<Gf.numChildren||!Gf.graphics._isOnlyOne())&&(Gf.cacheAsBitmap=!0),Gf.render(Gb,Gc-Ga.pivotX,Gd-Ga.pivotY)),Gb.ctx.globalCompositeOperation="source-over"},Ga._graphics=function(Ga,Gb,Gc,Gd){var Ge=Ga._style._tf;Ga._graphics&&Ga._graphics._render(Ga,Gb,Gc-Ge.translateX,Gd-Ge.translateY);var Gf=this._next;Gf._fun.call(Gf,Ga,Gb,Gc,Gd)},Ga._image=function(Ga,Gb,Gc,Gd){var Ge=Ga._style;Gb.ctx.drawTexture2(Gc,Gd,Ge._tf.translateX,Ge._tf.translateY,Ga.transform,Ge.alpha,Ge.blendMode,Ga._graphics._one)},Ga._image2=function(Ga,Gb,Gc,Gd){var Ge=Ga._style._tf;Gb.ctx.drawTexture2(Gc,Gd,Ge.translateX,Ge.translateY,Ga.transform,1,null,Ga._graphics._one)},Ga._alpha=function(Ga,Gb,Gc,Gd){var Ge;if(.01<(Ge=Ga._style.alpha)||Ga._needRepaint()){var Gf=Gb.ctx.globalAlpha;Gb.ctx.globalAlpha*=Ge;var Gg=this._next;Gg._fun.call(Gg,Ga,Gb,Gc,Gd),Gb.ctx.globalAlpha=Gf}},Ga._transform=function(Ga,Gb,Gc,Gd){var Ge=Ga.transform,Gf=this._next;Ge&&Gf!=Gg.NORENDER?(Gb.save(),Gb.transform(Ge.a,Ge.b,Ge.c,Ge.d,Ge.tx+Gc,Ge.ty+Gd),Gf._fun.call(Gf,Ga,Gb,0,0),Gb.restore()):Gf._fun.call(Gf,Ga,Gb,Gc,Gd)},Ga._childs=function(Ga,Gb,Gc,Gd){var Ge=Ga._style,Gf=Ge._tf;if(Gc=Gc-Gf.translateX+Ge.paddingLeft,Gd=Gd-Gf.translateY+Ge.paddingTop,Ge._calculation){var Gg=Ga._getWords();if(Gg){var Gh=Ge;Gh&&(Gh.stroke?Gb.fillBorderWords(Gg,Gc,Gd,Gh.font,Gh.color,Gh.strokeColor,Gh.stroke):Gb.fillWords(Gg,Gc,Gd,Gh.font,Gh.color,"none"!=Gh.textDecoration&&Gh.underLine?1:0))}}var Gi,Gj=Ga._childs,Gk=Gj.length;if(Ga.viewport||Ga.optimizeScrollRect&&Ga._style.scrollRect){var Gl=Ga.viewport||Ga._style.scrollRect,Go=Gl.x,Gp=Gl.y,Gq=Gl.right,Gr=Gl.bottom,Gs=NaN,Gt=NaN;for(Gu=0;Gu<Gk;++Gu)(Gi=Gj[Gu]).visible&&(Gs=Gi._x)<Gq&&Gs+Gi.width>Go&&(Gt=Gi._y)<Gr&&Gt+Gi.height>Gp&&Gi.render(Gb,Gc,Gd)}else for(var Gu=0;Gu<Gk;++Gu)(Gi=Gj[Gu])._style.visible&&Gi.render(Gb,Gc,Gd)},Ga._canvas=function(Ga,Gb,Gc,Gd){var Ge=Ga._$P.cacheCanvas;if(Ge){"bitmap"===Ge.type?GX.canvasBitmap++:GX.canvasNormal++;var Gf=Ge.ctx;if(Ga._needRepaint()||!Gf)this._canvas_repaint(Ga,Gb,Gc,Gd);else{var Gg=Ge._cacheRec;Gb.drawCanvas(Gf.canvas,Gc+Gg.x,Gd+Gg.y,Gg.width,Gg.height)}}else this._next._fun.call(this._next,Ga,Gb,Gc,Gd)},Ga._canvas_repaint=function(Ga,Gb,Gc,Gd){var Ge=Ga._$P.cacheCanvas,Gf=this._next;if(Ge){var Gg,Gh,Gi,Gj,Gk=Ge.ctx,Gl=Ga._needRepaint()||!Gk,Go=Ge.type;if("bitmap"===Go?GX.canvasBitmap++:GX.canvasNormal++,Gl){var Gp,Gq;Ge._cacheRec||(Ge._cacheRec=new GB),GJ.isWebGL&&"bitmap"!==Go?Ge._cacheRec.setTo(-Ga.pivotX,-Ga.pivotY,1,1):((Gj=Ga.getSelfBounds()).x=Gj.x-Ga.pivotX,Gj.y=Gj.y-Ga.pivotY,Gj.x=Gj.x-16,Gj.y=Gj.y-16,Gj.width=Gj.width+32,Gj.height=Gj.height+32,Gj.x=Math.floor(Gj.x+Gc)-Gc,Gj.y=Math.floor(Gj.y+Gd)-Gd,Gj.width=Math.floor(Gj.width),Gj.height=Math.floor(Gj.height),Ge._cacheRec.copyFrom(Gj)),Gj=Ge._cacheRec;var Gr,Gs=GJ.isWebGL?1:GO.pixelRatio*Gz.stage.clientScaleX,Gt=GJ.isWebGL?1:GO.pixelRatio*Gz.stage.clientScaleY;if(!GJ.isWebGL){var Gu,Gv=1,Gw=1;for(Gu=Ga;Gu&&Gu!=Gz.stage;)Gv*=Gu.scaleX,Gw*=Gu.scaleY,Gu=Gu.parent;GJ.isWebGL?(Gv<1&&(Gs*=Gv),Gw<1&&(Gt*=Gw)):(1<Gv&&(Gs*=Gv),1<Gw&&(Gt*=Gw))}if(Ga.scrollRect){var Gx=Ga.scrollRect;Gj.x-=Gx.x,Gj.y-=Gx.y}if(Gp=Gj.width*Gs,Gq=Gj.height*Gt,Gh=Gj.x,Gi=Gj.y,GJ.isWebGL&&"bitmap"===Go&&(2048<Gp||2048<Gq))return console.warn("cache bitmap size larger than 2048,cache ignored"),Ge.ctx&&(GW.recover("RenderContext",Ge.ctx),Ge.ctx.canvas.size(0,0),Ge.ctx=null),void Gf._fun.call(Gf,Ga,Gb,Gc,Gd);if(Gk||(Gk=Ge.ctx=GW.getItem("RenderContext")||new GK(Gp,Gq,Gva.create("AUTO"))),Gk.ctx.sprite=Ga,(Gg=Gk.canvas).clear(),(Gg.width!=Gp||Gg.height!=Gq)&&Gg.size(Gp,Gq),"bitmap"===Go?Gg.context.asBitmap=!0:"normal"===Go&&(Gg.context.asBitmap=!1),1!=Gs||1!=Gt){var Gy=Gk.ctx;Gy.save(),Gy.scale(Gs,Gt),!GJ.isConchWebGL&&GJ.isConchApp&&(Gr=Ga._$P.cf)&&Gy.setFilterMatrix&&Gy.setFilterMatrix(Gr._mat,Gr._alpha),Gf._fun.call(Gf,Ga,Gk,-Gh,-Gi),Gy.restore(),GJ.isConchApp&&!GJ.isConchWebGL||Ga._applyFilters()}else Gy=Gk.ctx,!GJ.isConchWebGL&&GJ.isConchApp&&(Gr=Ga._$P.cf)&&Gy.setFilterMatrix&&Gy.setFilterMatrix(Gr._mat,Gr._alpha),Gf._fun.call(Gf,Ga,Gk,-Gh,-Gi),GJ.isConchApp&&!GJ.isConchWebGL||Ga._applyFilters();Ga._$P.staticCache&&(Ge.reCache=!1),GX.canvasReCache++}else Gh=(Gj=Ge._cacheRec).x,Gi=Gj.y,Gg=Gk.canvas;Gb.drawCanvas(Gg,Gc+Gh,Gd+Gi,Gj.width,Gj.height)}else Gf._fun.call(Gf,Ga,Gk,Gc,Gd)},Gg.__init__=function(){var Ga,Gb,Gc=0;for(Gb=GF.createRenderSprite(69905,null),Ga=Gg.renders.length=4096,Gc=0;Gc<Ga;Gc++)Gg.renders[Gc]=Gb;Gg.renders[0]=GF.createRenderSprite(0,null),function(Ga,Gb){for(var Gc=0,Gd=0;Gd<Ga.length;Gd++)Gc|=Ga[Gd],Gg.renders[Gc]=Gb}([1,512,4,2],new Gg(1,null)),Gg.renders[513]=GF.createRenderSprite(513,null),Gg.renders[517]=new Gg(517,null)},Gg._initRenderFun=function(Ga,Gb,Gc,Gd){var Ge=Ga._renderType;(Gg.renders[Ge]=Gg._getTypeRender(Ge))._fun(Ga,Gb,Gc,Gd)},Gg._getTypeRender=function(Ga){for(var Gb=null,Gc=2048;1<Gc;)Gc&Ga&&(Gb=GF.createRenderSprite(Gc,Gb)),Gc>>=1;return Gb},Gg.IMAGE=1,Gg.ALPHA=2,Gg.TRANSFORM=4,Gg.BLEND=8,Gg.CANVAS=16,Gg.FILTERS=32,Gg.MASK=64,Gg.CLIP=128,Gg.STYLE=256,Gg.GRAPHICS=512,Gg.CUSTOM=1024,Gg.CHILDS=2048,Gg.INIT=69905,Gg.renders=[],Gg.NORENDER=new Gg(0,null),Gg}(),GM=function(){function Gh(){this._repaint=!1}Gr(Gh,"laya.resource.Context");var Ga=Gh.prototype;return Ga.replaceReset=function(){var Ga,Gb,Gc=0;for(Ga=Gh.replaceKeys.length,Gc=0;Gc<Ga;Gc++)Gb=Gh.replaceKeys[Gc],this[Gh.newKeys[Gc]]=this[Gb]},Ga.replaceResotre=function(){this.__restore(),this.__reset()},Ga.setIsMainContext=function(){},Ga.drawTextures=function(Ga,Gb,Gc,Gd){GX.drawCall+=Gb.length/2;for(var Ge=Ga.width,Gf=Ga.height,Gg=0,Gh=Gb.length;Gg<Gh;Gg+=2)this.drawTexture(Ga,Gb[Gg],Gb[Gg+1],Ge,Gf,Gc,Gd)},Ga.drawCanvas=function(Ga,Gb,Gc,Gd,Ge){GX.drawCall++,this.drawImage(Ga.source,Gb,Gc,Gd,Ge)},Ga.fillRect=function(Ga,Gb,Gc,Gd,Ge){GX.drawCall++,Ge&&(this.fillStyle=Ge),this.__fillRect(Ga,Gb,Gc,Gd)},Ga.fillText=function(Ga,Gb,Gc,Gd,Ge,Gf){GX.drawCall++,3<arguments.length&&null!=Gd&&(this.font=Gd,this.fillStyle=Ge,this.textAlign=Gf,this.textBaseline="top"),this.__fillText(Ga,Gb,Gc)},Ga.fillBorderText=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){GX.drawCall++,this.font=Gd,this.fillStyle=Ge,this.textBaseline="top",this.strokeStyle=Gf,this.lineWidth=Gg,this.textAlign=Gh,this.__strokeText(Ga,Gb,Gc),this.__fillText(Ga,Gb,Gc)},Ga.strokeText=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){GX.drawCall++,3<arguments.length&&null!=Gd&&(this.font=Gd,this.strokeStyle=Ge,this.lineWidth=Gf,this.textAlign=Gg,this.textBaseline="top"),this.__strokeText(Ga,Gb,Gc)},Ga.transformByMatrix=function(Ga){this.transform(Ga.a,Ga.b,Ga.c,Ga.d,Ga.tx,Ga.ty)},Ga.setTransformByMatrix=function(Ga){this.setTransform(Ga.a,Ga.b,Ga.c,Ga.d,Ga.tx,Ga.ty)},Ga.clipRect=function(Ga,Gb,Gc,Gd){GX.drawCall++,this.beginPath(),this.rect(Ga,Gb,Gc,Gd),this.clip()},Ga.drawTexture=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){GX.drawCall++;var Gh=Ga.uv,Gi=Ga.bitmap.width,Gj=Ga.bitmap.height;this.drawImage(Ga.source,Gh[0]*Gi,Gh[1]*Gj,(Gh[2]-Gh[0])*Gi,(Gh[5]-Gh[3])*Gj,Gb+Gf,Gc+Gg,Gd,Ge)},Ga.drawTextureWithTransform=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){GX.drawCall++;var Gj=Ga.uv,Gk=Ga.bitmap.width,Gl=Ga.bitmap.height;this.save(),1!=Gi&&(this.globalAlpha*=Gi),Gf?(this.transform(Gf.a,Gf.b,Gf.c,Gf.d,Gf.tx+Gg,Gf.ty+Gh),this.drawImage(Ga.source,Gj[0]*Gk,Gj[1]*Gl,(Gj[2]-Gj[0])*Gk,(Gj[5]-Gj[3])*Gl,Gb,Gc,Gd,Ge)):this.drawImage(Ga.source,Gj[0]*Gk,Gj[1]*Gl,(Gj[2]-Gj[0])*Gk,(Gj[5]-Gj[3])*Gl,Gb+Gg,Gc+Gh,Gd,Ge),this.restore()},Ga.drawTexture2=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){var Gi=Gh[0];if(Gi.loaded&&Gi.bitmap&&Gi.source){GX.drawCall++;var Gj=1!==Gf;if(Gj){var Gk=this.globalAlpha;this.globalAlpha*=Gf}var Gl=Gi.uv,Go=Gi.bitmap.width,Gp=Gi.bitmap.height;Ge?(this.save(),this.transform(Ge.a,Ge.b,Ge.c,Ge.d,Ge.tx+Ga,Ge.ty+Gb),this.drawImage(Gi.source,Gl[0]*Go,Gl[1]*Gp,(Gl[2]-Gl[0])*Go,(Gl[5]-Gl[3])*Gp,Gh[1]-Gc,Gh[2]-Gd,Gh[3],Gh[4]),this.restore()):this.drawImage(Gi.source,Gl[0]*Go,Gl[1]*Gp,(Gl[2]-Gl[0])*Go,(Gl[5]-Gl[3])*Gp,Gh[1]-Gc+Ga,Gh[2]-Gd+Gb,Gh[3],Gh[4]),Gj&&(this.globalAlpha=Gk)}},Ga.fillTexture=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){if(!Gh.pat){if(Ga.uv!=Gka.DEF_UV){var Gi=new Gva("2D");Gi.getContext("2d"),Gi.size(Ga.width,Ga.height),Gi.context.drawTexture(Ga,0,0,Ga.width,Ga.height,0,0),Ga=new Gka(Gi)}Gh.pat=this.createPattern(Ga.bitmap.source,Gf)}var Gj=Gb,Gk=Gc,Gl=0,Go=0;Gg&&(Gj+=Gg.x%Ga.width,Gk+=Gg.y%Ga.height,Gl-=Gg.x%Ga.width,Go-=Gg.y%Ga.height),this.translate(Gj,Gk),this.fillRect(Gl,Go,Gd,Ge,Gh.pat),this.translate(-Gj,-Gk)},Ga.drawTriangle=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){var Gi=Ga.bitmap,Gj=Gi.source,Gk=Ga.width,Gl=Ga.height,Go=Gi.width,Gp=Gi.height,Gq=Gc[Gd]*Go,Gr=Gc[Ge]*Go,Gs=Gc[Gf]*Go,Gt=Gc[Gd+1]*Gp,Gu=Gc[Ge+1]*Gp,Gv=Gc[Gf+1]*Gp,Gw=Gb[Gd],Gx=Gb[Ge],Gy=Gb[Gf],Gz=Gb[Gd+1],GA=Gb[Ge+1],GB=Gb[Gf+1];if(Gh){var GC=(Gw+Gx+Gy)/3,GD=(Gz+GA+GB)/3,GE=Gw-GC,GF=Gz-GD,GG=Math.sqrt(GE*GE+GF*GF);Gw=GC+GE/GG*(GG+1),Gz=GD+GF/GG*(GG+1),GF=GA-GD,Gx=GC+(GE=Gx-GC)/(GG=Math.sqrt(GE*GE+GF*GF))*(GG+1),GA=GD+GF/GG*(GG+1),GF=GB-GD,Gy=GC+(GE=Gy-GC)/(GG=Math.sqrt(GE*GE+GF*GF))*(GG+1),GB=GD+GF/GG*(GG+1)}this.save(),Gg&&this.transform(Gg.a,Gg.b,Gg.c,Gg.d,Gg.tx,Gg.ty),this.beginPath(),this.moveTo(Gw,Gz),this.lineTo(Gx,GA),this.lineTo(Gy,GB),this.closePath(),this.clip();var GH=1/(Gq*Gu+Gt*Gs+Gr*Gv-Gu*Gs-Gt*Gr-Gq*Gv),GI=Gw*Gu+Gt*Gy+Gx*Gv-Gu*Gy-Gt*Gx-Gw*Gv,GJ=Gq*Gx+Gw*Gs+Gr*Gy-Gx*Gs-Gw*Gr-Gq*Gy,GK=Gq*Gu*Gy+Gt*Gx*Gs+Gw*Gr*Gv-Gw*Gu*Gs-Gt*Gr*Gy-Gq*Gx*Gv,GL=Gz*Gu+Gt*GB+GA*Gv-Gu*GB-Gt*GA-Gz*Gv,GM=Gq*GA+Gz*Gs+Gr*GB-GA*Gs-Gz*Gr-Gq*GB,GN=Gq*Gu*GB+Gt*GA*Gs+Gz*Gr*Gv-Gz*Gu*Gs-Gt*Gr*GB-Gq*GA*Gv;this.transform(GI*GH,GL*GH,GJ*GH,GM*GH,GK*GH,GN*GH),this.drawImage(Gj,Ga.uv[0]*Go,Ga.uv[1]*Gp,Gk,Gl,Ga.uv[0]*Go,Ga.uv[1]*Gp,Gk,Gl),this.restore()},Ga.flush=function(){return 0},Ga.fillWords=function(Ga,Gb,Gc,Gd,Ge,Gf){Gd&&(this.font=Gd),Ge&&(this.fillStyle=Ge);this.textBaseline="top",this.textAlign="left";for(var Gg=0,Gh=Ga.length;Gg<Gh;Gg++){var Gi=Ga[Gg];if(this.__fillText(Gi.char,Gi.x+Gb,Gi.y+Gc),1===Gf){var Gj=Gi.height,Gk=.5*Gi.style.letterSpacing;Gk||(Gk=0),this.beginPath(),this.strokeStyle=Ge,this.lineWidth=1,this.moveTo(Gb+Gi.x-Gk+.5,Gc+Gi.y+Gj+.5),this.lineTo(Gb+Gi.x+Gi.width+Gk+.5,Gc+Gi.y+Gj+.5),this.stroke()}}},Ga.fillBorderWords=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){Gd&&(this.font=Gd),Ge&&(this.fillStyle=Ge),this.textBaseline="top",this.lineWidth=Gg,this.textAlign="left",this.strokeStyle=Gf;for(var Gh=0,Gi=Ga.length;Gh<Gi;Gh++){var Gj=Ga[Gh];this.__strokeText(Gj.char,Gj.x+Gb,Gj.y+Gc),this.__fillText(Gj.char,Gj.x+Gb,Gj.y+Gc)}},Ga.destroy=function(){this.canvas.width=this.canvas.height=0},Ga.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},Ga.drawCurves=function(Ga,Gb,Gc){this.beginPath(),this.strokeStyle=Gc[3],this.lineWidth=Gc[4];var Gd=Gc[2];Ga+=Gc[0],Gb+=Gc[1],this.moveTo(Ga+Gd[0],Gb+Gd[1]);for(var Ge=2,Gf=Gd.length;Ge<Gf;)this.quadraticCurveTo(Ga+Gd[Ge++],Gb+Gd[Ge++],Ga+Gd[Ge++],Gb+Gd[Ge++]);this.stroke()},Gh.__init__=function(Gb){var Gc=laya.resource.Context.prototype;if(!(Gb=Gb||CanvasRenderingContext2D.prototype).inited){Gb.inited=!0,Gb.__fillText=Gb.fillText,Gb.__fillRect=Gb.fillRect,Gb.__strokeText=Gb.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(Ga){Gb[Ga]=Gc[Ga]})}},Gh.replaceCanvasGetSet=function(Ga,Gb){var Gc=Object.getOwnPropertyDescriptor(Ga,Gb);if(!Gc||!Gc.configurable)return!1;var Gd,Ge={};for(Gd in Gc)"set"!=Gd&&(Ge[Gd]=Gc[Gd]);var Gf=Gc.set;return Ge.set=function(Ga){Gf.call(this,Ga);var Gb=this.getContext("2d");Gb&&"__reset"in Gb&&Gb.__reset()},Object.defineProperty(Ga,Gb,Ge),!0},Gh.replaceGetSet=function(Ga,Gb){var Gc=Object.getOwnPropertyDescriptor(Ga,Gb);if(!Gc||!Gc.configurable)return!1;var Gd,Ge={};for(Gd in Gc)"set"!=Gd&&(Ge[Gd]=Gc[Gd]);var Gf=Gc.set,Gg="___"+Gb+"__";return Gh.newKeys.push(Gg),Ge.set=function(Ga){Ga!=this[Gg]&&(this[Gg]=Ga,Gf.call(this,Ga))},Object.defineProperty(Ga,Gb,Ge),!0},Gh._default=new Gh,Gh.newKeys=[],Gi(Gh,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),Gh}(),GN=function(){function Gf(Ga){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++Gf._uniqueIDCounter,this._name=Ga||"Content Manager",Gf._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,Gf._resourceManagers.push(this),this._resources=[],this._records={}}Gr(Gf,"laya.resource.ResourceManager");var Ga=Gf.prototype;return Gz.imps(Ga,{"laya.resource.IDispose":!0}),Ga.getResourceByIndex=function(Ga){return this._resources[Ga]},Ga.getResourcesLength=function(){return this._resources.length},Ga.addResource=function(Ga){return Ga.resourceManager&&Ga.resourceManager.removeResource(Ga),-1===this._resources.indexOf(Ga)&&((Ga._resourceManager=this)._resources.push(Ga),this.addRecord(Ga.uri,Ga.__className,Ga.memorySize),this.addSize(Ga.memorySize),!0)},Ga.removeResource=function(Ga){var Gb=this._resources.indexOf(Ga);return-1!==Gb&&(this._resources.splice(Gb,1),Ga._resourceManager=null,this._memorySize-=Ga.memorySize,this.addRecord(Ga.uri,Ga.__className,-Ga.memorySize),!0)},Ga.unload=function(){for(var Ga=this._resources.slice(0,this._resources.length),Gb=0;Gb<Ga.length;Gb++){Ga[Gb].destroy()}Ga.length=0},Ga.dispose=function(){if(this===Gf._systemResourceManager)throw new Error("systemResourceManager不能被释放！");Gf._resourceManagers.splice(Gf._resourceManagers.indexOf(this),1),Gf._isResourceManagersSorted=!1;for(var Ga=this._resources.slice(0,this._resources.length),Gb=0;Gb<Ga.length;Gb++){var Gc=Ga[Gb];Gc.resourceManager.removeResource(Gc),Gc.destroy()}Ga.length=0},Ga.addSize=function(Ga){Ga&&(this.autoRelease&&0<Ga&&this._memorySize+Ga>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=Ga)},Ga.addRecord=function(Ga,Gb,Gc){DEBUG&&Gc&&!Ga&&console.error(Ga,Gb,Gc),Ga&&(this._records.hasOwnProperty(Gb+"|"+Ga)||(this._records[Gb+"|"+Ga]=0),this._records[Gb+"|"+Ga]+=Gc,DEBUG&&this._records[Gb+"|"+Ga]<0&&console.error(Ga,Gb,this._records[Gb+"|"+Ga]))},Ga.garbageCollection=function(Ga){var Gb=this._resources;(Gb=Gb.slice()).sort(function(Ga,Gb){if(!Ga||!Gb)throw new Error("a或b不能为空！");return Ga.released&&Gb.released?0:Ga.released?1:Gb.released?-1:Ga._lastUseFrameCount-Gb._lastUseFrameCount});for(var Gc=GX.loopCount,Gd=0,Ge=Gb.length;Gd<Ge;Gd++){var Gf=Gb[Gd];if(!(1<Gc-Gf._lastUseFrameCount))return void(this._memorySize>=Ga&&(this._isOverflow=!0));if(Gf.releaseResource(),this._memorySize<Ga)return void(this._isOverflow=!1)}},Gk(0,Ga,"id",function(){return this._id}),Gk(0,Ga,"name",function(){return this._name},function(Ga){!Ga&&""===Ga||this._name===Ga||(this._name=Ga,Gf._isResourceManagersSorted=!1)}),Gk(0,Ga,"memorySize",function(){return this._memorySize}),Gk(0,Ga,"records",function(){return this._records}),Gk(1,Gf,"systemResourceManager",function(){return Gf._systemResourceManager}),Gf.__init__=function(){Gf.currentResourceManager=Gf.systemResourceManager},Gf.getLoadedResourceManagerByIndex=function(Ga){return Gf._resourceManagers[Ga]},Gf.getLoadedResourceManagersCount=function(){return Gf._resourceManagers.length},Gf.recreateContentManagers=function(Ga){void 0===Ga&&(Ga=!1);for(var Gb=Gf.currentResourceManager,Gc=0;Gc<Gf._resourceManagers.length;Gc++){Gf.currentResourceManager=Gf._resourceManagers[Gc];for(var Gd=0;Gd<Gf.currentResourceManager._resources.length;Gd++)Gf.currentResourceManager._resources[Gd].releaseResource(Ga),Gf.currentResourceManager._resources[Gd].activeResource(Ga)}Gf.currentResourceManager=Gb},Gf.releaseContentManagers=function(Ga){void 0===Ga&&(Ga=!1);for(var Gb=Gf.currentResourceManager,Gc=0;Gc<Gf._resourceManagers.length;Gc++){Gf.currentResourceManager=Gf._resourceManagers[Gc];for(var Gd=0;Gd<Gf.currentResourceManager._resources.length;Gd++){var Ge=Gf.currentResourceManager._resources[Gd];!Ge.released&&Ge.releaseResource(Ga)}}Gf.currentResourceManager=Gb},Gf._uniqueIDCounter=0,Gf._isResourceManagersSorted=!1,Gf._resourceManagers=[],Gi(Gf,["_systemResourceManager",function(){return this._systemResourceManager=new Gf("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=Gf._systemResourceManager}]),Gf}(),GO=(function(){function Ga(){}Gr(Ga,"laya.system.System"),Ga.changeDefinition=function(Ga,Gb){Gz[Ga]=Gb;var Gc=Ga+"=classObj";Gz._runScript(Gc)},Ga.__init__=function(){GJ.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function Gc(){}return Gr(Gc,"laya.utils.Browser"),Gk(1,Gc,"pixelRatio",function(){return Gc.__init__(),-1<Gc.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:GF.getPixelRatio()}),Gk(1,Gc,"height",function(){return Gc.__init__(),(Gz.stage&&Gz.stage.canvasRotation?Gc.clientWidth:Gc.clientHeight)*Gc.pixelRatio}),Gk(1,Gc,"clientWidth",function(){return Gc.__init__(),Gc.window.innerWidth||Gc.document.body.clientWidth}),Gk(1,Gc,"window",function(){return Gc.__init__(),Gc._window}),Gk(1,Gc,"clientHeight",function(){return Gc.__init__(),Gc.window.innerHeight||Gc.document.body.clientHeight||Gc.document.documentElement.clientHeight}),Gk(1,Gc,"width",function(){return Gc.__init__(),(Gz.stage&&Gz.stage.canvasRotation?Gc.clientHeight:Gc.clientWidth)*Gc.pixelRatio}),Gk(1,Gc,"container",function(){return Gc.__init__(),Gc._container||((Gc._container=Gc.createElement("div")).id="layaContainer",Gc.document.body.appendChild(Gc._container)),Gc._container},function(Ga){Gc._container=Ga}),Gk(1,Gc,"document",function(){return Gc.__init__(),Gc._document}),Gc.__init__=function(){if(!Gc._window){Gc._window=GF.getWindow(),Gc._document=Gc.window.document,Gc._window.addEventListener("message",function(Ga){laya.utils.Browser._onMessage(Ga)},!1),Gc.document.__createElement=Gc.document.createElement,Gg.requestAnimationFrame=Gg.requestAnimationFrame||Gg.webkitRequestAnimationFrame||Gg.mozRequestAnimationFrame||Gg.oRequestAnimationFrame||Gg.msRequestAnimationFrame||function(Ga){return Gg.setTimeout(Ga,1e3/60)};var Ga=Gg.document.body.style;Ga["-webkit-user-select"]="none",Ga["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",Gc.userAgent=Gc.window.navigator.userAgent,Gc.onIOS=!!(Gc.u=Gc.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),Gc.onMobile=-1<Gc.u.indexOf("Mobile"),Gc.onIPhone=-1<Gc.u.indexOf("iPhone"),Gc.onMac=-1<Gc.u.indexOf("Mac OS X"),Gc.onIPad=-1<Gc.u.indexOf("iPad"),Gc.onAndroid=-1<Gc.u.indexOf("Android")||-1<Gc.u.indexOf("Adr"),Gc.onWP=-1<Gc.u.indexOf("Windows Phone"),Gc.onQQBrowser=-1<Gc.u.indexOf("QQBrowser"),Gc.onMQQBrowser=-1<Gc.u.indexOf("MQQBrowser")||-1<Gc.u.indexOf("Mobile")&&-1<Gc.u.indexOf("QQ"),Gc.onIE=!!Gc.window.ActiveXObject||"ActiveXObject"in Gc.window,Gc.onWeiXin=-1<Gc.u.indexOf("MicroMessenger"),Gc.onPC=!Gc.onMobile,Gc.onSafari=-1<Gc.u.indexOf("Safari"),Gc.onFirefox=-1<Gc.u.indexOf("Firefox"),Gc.onEdge=-1<Gc.u.indexOf("Edge"),Gc.onMiniGame=-1<Gc.u.indexOf("MiniGame"),Gc.onLimixiu=-1<Gc.u.indexOf("limixiu"),Gc.httpProtocol="http:"==Gc.window.location.protocol,Gc.onMiniGame&&null==Gc.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),Gc.webAudioEnabled=!!(Gc.window.AudioContext||Gc.window.webkitAudioContext||Gc.window.mozAudioContext),Gc.soundType=Gc.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",Gea=Gc.webAudioEnabled?Gfa:Gca,Gc.webAudioEnabled&&Gfa.initWebAudio(),Gca._initMusicAudio(),Gc.enableTouch="ontouchstart"in Gg||Gg.DocumentTouch&&Gb instanceof DocumentTouch,Gg.focus(),GE._soundClass=Gea,GE._musicClass=Gca,GJ._mainCanvas=GJ._mainCanvas||Gva.create("2D"),Gc.canvas||(Gc.canvas=Gva.create("2D"),Gc.context=Gc.canvas.getContext("2d"))}},Gc._onMessage=function(Ga){if(Ga.data&&"size"==Ga.data.name){if(Gc.window.innerWidth=Ga.data.width,Gc.window.innerHeight=Ga.data.height,Gc.window.__innerHeight=Ga.data.clientHeight,!Gc.document.createEvent)return void console.warn("no document.createEvent");var Gb=Gc.document.createEvent("HTMLEvents");return Gb.initEvent("resize",!1,!1),void Gc.window.dispatchEvent(Gb)}},Gc.createElement=function(Ga){return Gc.__init__(),Gc.document.__createElement(Ga)},Gc.getElementById=function(Ga){return Gc.__init__(),Gc.document.getElementById(Ga)},Gc.removeElement=function(Ga){Ga&&Ga.parentNode&&Ga.parentNode.removeChild(Ga)},Gc.now=function(){return GF.now()},Gc._window=null,Gc._document=null,Gc._container=null,Gc.userAgent=null,Gc.u=null,Gc.onIOS=!1,Gc.onMac=!1,Gc.onMobile=!1,Gc.onIPhone=!1,Gc.onIPad=!1,Gc.onAndroid=!1,Gc.onWP=!1,Gc.onQQBrowser=!1,Gc.onMQQBrowser=!1,Gc.onSafari=!1,Gc.onFirefox=!1,Gc.onEdge=!1,Gc.onIE=!1,Gc.onWeiXin=!1,Gc.onMiniGame=!1,Gc.onLimixiu=!1,Gc.onPC=!1,Gc.httpProtocol=!1,Gc.webAudioEnabled=!1,Gc.soundType=null,Gc.enableTouch=!1,Gc.canvas=null,Gc.context=null,Gc.__init$=function(){},Gc}()),GP=function(){function Gb(Ga){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,Ga?(this._u8d_=new Uint8Array(Ga),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}Gr(Gb,"laya.utils.Byte");var Ga=Gb.prototype;return Ga.___resizeBuffer=function(Gb){try{var Ga=new Uint8Array(Gb);null!=this._u8d_&&(this._u8d_.length<=Gb?Ga.set(this._u8d_):Ga.set(this._u8d_.subarray(0,Gb))),this._u8d_=Ga,this._d_=new DataView(Ga.buffer)}catch(Ga){throw"___resizeBuffer err:"+Gb}},Ga.getString=function(){return this.rUTF(this.getUint16())},Ga.getFloat32Array=function(Ga,Gb){var Gc=Ga+Gb;Gc=Gc>this._length?this._length:Gc;var Gd=new Float32Array(this._d_.buffer.slice(Ga,Gc));return this._pos_=Gc,Gd},Ga.getUint8Array=function(Ga,Gb){var Gc=Ga+Gb;Gc=Gc>this._length?this._length:Gc;var Gd=new Uint8Array(this._d_.buffer.slice(Ga,Gc));return this._pos_=Gc,Gd},Ga.getInt16Array=function(Ga,Gb){var Gc=Ga+Gb;Gc=Gc>this._length?this._length:Gc;var Gd=new Int16Array(this._d_.buffer.slice(Ga,Gc));return this._pos_=Gc,Gd},Ga.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var Ga=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,Ga},Ga.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var Ga=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,Ga},Ga.writeFloat32=function(Ga){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,Ga,this._xd_),this._pos_+=4},Ga.writeFloat64=function(Ga){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,Ga,this._xd_),this._pos_+=8},Ga.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var Ga=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,Ga},Ga.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var Ga=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,Ga},Ga.writeInt32=function(Ga){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,Ga,this._xd_),this._pos_+=4},Ga.writeUint32=function(Ga){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,Ga,this._xd_),this._pos_+=4},Ga.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var Ga=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,Ga},Ga.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var Ga=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,Ga},Ga.writeUint16=function(Ga){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,Ga,this._xd_),this._pos_+=2},Ga.writeInt16=function(Ga){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,Ga,this._xd_),this._pos_+=2},Ga.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},Ga.writeUint8=function(Ga){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,Ga),this._pos_++},Ga._getUInt8=function(Ga){return this._d_.getUint8(Ga)},Ga._getUint16=function(Ga){return this._d_.getUint16(Ga,this._xd_)},Ga._getMatrix=function(){return new GG(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},Ga.rUTF=function(Ga){for(var Gb=[],Gc=this._pos_+Ga,Gd=0,Ge=0,Gf=0,Gg=String.fromCharCode,Gh=this._u8d_;this._pos_<Gc;)(Gd=Gh[this._pos_++])<128?0!=Gd&&Gb.push(Gg(Gd)):Gd<224?Gb.push(Gg((63&Gd)<<6|127&Gh[this._pos_++])):Gd<240?(Ge=Gh[this._pos_++],Gb.push(Gg((31&Gd)<<12|(127&Ge)<<6|127&Gh[this._pos_++]))):(Ge=Gh[this._pos_++],Gf=Gh[this._pos_++],Gb.push(Gg((15&Gd)<<18|(127&Ge)<<12|Gf<<6&127|127&Gh[this._pos_++]))),0;return Gb.join("")},Ga.getCustomString=function(Ga){for(var Gb=[],Gc=0,Gd=0,Ge=0,Gf=String.fromCharCode,Gg=this._u8d_;0<Ga;)if((Gd=Gg[this._pos_])<128)Gb.push(Gf(Gd)),this._pos_++,Ga--;else for(Gc=Gd-128,this._pos_++,Ga-=Gc;0<Gc;)Gd=Gg[this._pos_++],Ge=Gg[this._pos_++],Gb.push(Gf(Ge<<8|Gd)),Gc--;return Gb.join("")},Ga.clear=function(){this._pos_=0,this.length=0},Ga.__getBuffer=function(){return this._d_.buffer},Ga.writeUTFBytes=function(Ga){for(var Gb=0,Gc=(Ga+="").length;Gb<Gc;Gb++){var Gd=Ga.charCodeAt(Gb);Gd<=127?this.writeByte(Gd):Gd<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|Gd>>6,128|63&Gd],this._pos_),this._pos_+=2):Gd<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|Gd>>12,128|Gd>>6&63,128|63&Gd],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|Gd>>18,128|Gd>>12&63,128|Gd>>6&63,128|63&Gd],this._pos_),this._pos_+=4)}},Ga.writeUTFString=function(Ga){var Gb=this.pos;this.writeUint16(1),this.writeUTFBytes(Ga);var Gc=this.pos-Gb-2;if(65536<=Gc)throw"writeUTFString byte len more than 65536";this._d_.setUint16(Gb,Gc,this._xd_)},Ga.readUTFString=function(){return this.readUTFBytes(this.getUint16())},Ga.getUTFString=function(){return this.readUTFString()},Ga.readUTFBytes=function(Ga){if(void 0===Ga&&(Ga=-1),0==Ga)return"";var Gb=this.bytesAvailable;if(Gb<Ga)throw"readUTFBytes error - Out of bounds";return Ga=0<Ga?Ga:Gb,this.rUTF(Ga)},Ga.getUTFBytes=function(Ga){return void 0===Ga&&(Ga=-1),this.readUTFBytes(Ga)},Ga.writeByte=function(Ga){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,Ga),this._pos_+=1},Ga.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},Ga.getByte=function(){return this.readByte()},Ga.ensureWrite=function(Ga){this._length<Ga&&(this._length=Ga),this._allocated_<Ga&&(this.length=Ga)},Ga.writeArrayBuffer=function(Ga,Gb,Gc){if(void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),Gb<0||Gc<0)throw"writeArrayBuffer error - Out of bounds";0==Gc&&(Gc=Ga.byteLength-Gb),this.ensureWrite(this._pos_+Gc);var Gd=new Uint8Array(Ga);this._u8d_.set(Gd.subarray(Gb,Gb+Gc),this._pos_),this._pos_+=Gc},Gk(0,Ga,"buffer",function(){var Ga=this._d_.buffer;return Ga.byteLength==this.length?Ga:Ga.slice(0,this.length)}),Gk(0,Ga,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(Ga){this._xd_="littleEndian"==Ga}),Gk(0,Ga,"length",function(){return this._length},function(Ga){this._allocated_<Ga?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(Ga,2*this._allocated_))):this._allocated_>Ga&&this.___resizeBuffer(this._allocated_=Ga),this._length=Ga}),Gk(0,Ga,"pos",function(){return this._pos_},function(Ga){this._pos_=Ga}),Gk(0,Ga,"bytesAvailable",function(){return this._length-this._pos_}),Gb.getSystemEndian=function(){if(!Gb._sysEndian){var Ga=new ArrayBuffer(2);new DataView(Ga).setInt16(0,256,!0),Gb._sysEndian=256===new Int16Array(Ga)[0]?"littleEndian":"bigEndian"}return Gb._sysEndian},Gb.BIG_ENDIAN="bigEndian",Gb.LITTLE_ENDIAN="littleEndian",Gb._sysEndian=null,Gb}(),GQ=function(){function Ge(){}return Gr(Ge,"laya.utils.CacheManager"),Ge.regCacheByFunction=function(Ga,Gb){var Gc;Ge.unRegCacheByFunction(Ga,Gb),Gc={tryDispose:Ga,getCacheList:Gb},Ge._cacheList.push(Gc)},Ge.unRegCacheByFunction=function(Ga,Gb){var Gc,Gd=0;for(Gc=Ge._cacheList.length,Gd=0;Gd<Gc;Gd++)if(Ge._cacheList[Gd].tryDispose==Ga&&Ge._cacheList[Gd].getCacheList==Gb)return void Ge._cacheList.splice(Gd,1)},Ge.forceDispose=function(){var Ga=0,Gb=Ge._cacheList.length;for(Ga=0;Ga<Gb;Ga++)Ge._cacheList[Ga].tryDispose(!0)},Ge.beginCheck=function(Ga){void 0===Ga&&(Ga=15e3),Gz.timer.loop(Ga,null,Ge._checkLoop)},Ge.stopCheck=function(){Gz.timer.clear(null,Ge._checkLoop)},Ge._checkLoop=function(){var Ga=Ge._cacheList;if(!(Ga.length<1)){var Gb,Gc=GO.now(),Gd=0;for(Gb=Gd=Ga.length;0<Gd&&(Ga[Ge._index=++Ge._index%Gb].tryDispose(!1),!(GO.now()-Gc>Ge.loopTimeLimit));)Gd--}},Ge.loopTimeLimit=2,Ge._cacheList=[],Ge._index=0,Ge}(),GR=function(){function Gp(){}return Gr(Gp,"laya.utils.ClassUtils"),Gp.regClass=function(Ga,Gb){Gp._classMap[Ga]=Gb},Gp.getRegClass=function(Ga){return Gp._classMap[Ga]},Gp.getInstance=function(Ga){var Gb=Gp.getClass(Ga);return Gb?new Gb:(console.warn("[error] Undefined class:",Ga),null)},Gp.createByJson=function(Ga,Gb,Gc,Gd,Ge){"string"==typeof Ga&&(Ga=JSON.parse(Ga));var Gf=Ga.props;if(!Gb&&!(Gb=Ge?Ge.runWith(Ga):Gp.getInstance(Gf.runtime||Ga.type)))return null;var Gg=Ga.child;if(Gg)for(var Gh=0,Gi=Gg.length;Gh<Gi;Gh++){var Gj=Gg[Gh];if("render"!==Gj.props.name&&"render"!==Gj.props.renderType||!Gb._$set_itemRender)if("Graphic"==Gj.type)Gp.addGraphicsToSprite(Gj,Gb);else if(Gp.isDrawType(Gj.type))Gp.addGraphicToSprite(Gj,Gb,!0);else{var Gk=Gp.createByJson(Gj,null,Gc,Gd,Ge);"Script"==Gj.type?Gk.hasOwnProperty("owner")?Gk.owner=Gb:Gk.hasOwnProperty("target")&&(Gk.target=Gb):"mask"==Gj.props.renderType?Gb.mask=Gk:Gb.addChild(Gk)}else Gb.itemRender=Gj}if(Gf)for(var Gl in Gf){var Go=Gf[Gl];"var"===Gl&&Gc?Gc[Go]=Gb:Go instanceof Array&&"function"==typeof Gb[Gl]?Gb[Gl].apply(Gb,Go):Gb[Gl]=Go}return Gd&&Ga.customProps&&Gd.runWith([Gb,Ga]),Gb.created&&Gb.created(),Gb},Gp.addGraphicsToSprite=function(Ga,Gb){var Gc;if((Gc=Ga.child)&&!(Gc.length<1)){var Gd;Gd=Gp._getGraphicsFromSprite(Ga,Gb);var Ge=0,Gf=0;Ga.props&&(Ge=Gp._getObjVar(Ga.props,"x",0),Gf=Gp._getObjVar(Ga.props,"y",0)),0!=Ge&&0!=Gf&&Gd.translate(Ge,Gf);var Gg,Gh=0;for(Gg=Gc.length,Gh=0;Gh<Gg;Gh++)Gp._addGraphicToGraphics(Gc[Gh],Gd);0!=Ge&&0!=Gf&&Gd.translate(-Ge,-Gf)}},Gp.addGraphicToSprite=function(Ga,Gb,Gc){var Gd;void 0===Gc&&(Gc=!1),Gd=Gc?Gp._getGraphicsFromSprite(Ga,Gb):Gb.graphics,Gp._addGraphicToGraphics(Ga,Gd)},Gp._getGraphicsFromSprite=function(Ga,Gb){var Gc,Gd;if(!Ga||!Ga.props)return Gb.graphics;switch(Gd=Ga.props.renderType){case"hit":case"unHit":var Ge;Gb.hitArea||(Gb.hitArea=new GV),(Ge=Gb.hitArea)[Gd]||(Ge[Gd]=new Go),Gc=Ge[Gd]}return Gc||(Gc=Gb.graphics),Gc},Gp._getTransformData=function(Ga){var Gb;(Ga.hasOwnProperty("pivotX")||Ga.hasOwnProperty("pivotY"))&&(Gb=Gb||new GG).translate(-Gp._getObjVar(Ga,"pivotX",0),-Gp._getObjVar(Ga,"pivotY",0));var Gc=Gp._getObjVar(Ga,"scaleX",1),Gd=Gp._getObjVar(Ga,"scaleY",1),Ge=Gp._getObjVar(Ga,"rotation",0);Gp._getObjVar(Ga,"skewX",0),Gp._getObjVar(Ga,"skewY",0);return 1==Gc&&1==Gd&&0==Ge||((Gb=Gb||new GG).scale(Gc,Gd),Gb.rotate(.0174532922222222*Ge)),Gb},Gp._addGraphicToGraphics=function(Ga,Gb){var Gc,Gd;if((Gc=Ga.props)&&(Gd=Gp.DrawTypeDic[Ga.type])){var Ge,Gf;Ge=Gb;var Gg=Gp._getParams(Gc,Gd[1],Gd[2],Gd[3]);((Gf=Gp._tM)||1!=Gp._alpha)&&(Ge.save(),Gf&&Ge.transform(Gf),1!=Gp._alpha&&Ge.alpha(Gp._alpha)),Ge[Gd[0]].apply(Ge,Gg),(Gf||1!=Gp._alpha)&&Ge.restore()}},Gp._adptLineData=function(Ga){return Ga[2]=parseFloat(Ga[0])+parseFloat(Ga[2]),Ga[3]=parseFloat(Ga[1])+parseFloat(Ga[3]),Ga},Gp._adptTextureData=function(Ga){return Ga[0]=Gha.getRes(Ga[0]),Ga},Gp._adptLinesData=function(Ga){return Ga[2]=Gp._getPointListByStr(Ga[2]),Ga},Gp.isDrawType=function(Ga){return"Image"!=Ga&&Gp.DrawTypeDic.hasOwnProperty(Ga)},Gp._getParams=function(Ga,Gb,Gc,Gd){var Ge;void 0===Gc&&(Gc=0),(Ge=Gp._temParam).length=Gb.length;var Gf,Gg,Gh=0;for(Gf=Gb.length,Gh=0;Gh<Gf;Gh++)Ge[Gh]=Gp._getObjVar(Ga,Gb[Gh][0],Gb[Gh][1]);return Gp._alpha=Gp._getObjVar(Ga,"alpha",1),Gg=Gp._getTransformData(Ga),Gp._tM=Gg?(Gc||(Gc=0),Gg.translate(Ge[Gc],Ge[Gc+1]),Ge[Gc]=Ge[Gc+1]=0,Gg):null,Gd&&Gp[Gd]&&(Ge=Gp[Gd](Ge)),Ge},Gp._getPointListByStr=function(Ga){var Gb,Gc,Gd=0;for(Gc=(Gb=Ga.split(",")).length,Gd=0;Gd<Gc;Gd++)Gb[Gd]=parseFloat(Gb[Gd]);return Gb},Gp._getObjVar=function(Ga,Gb,Gc){return Ga.hasOwnProperty(Gb)?Ga[Gb]:Gc},Gp._temParam=[],Gp._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},Gp.getClass=function(Ga){var Gb=Gp._classMap[Ga]||Ga;return"string"==typeof Gb?Gz.__classmap[Gb]:Gb},Gp._tM=null,Gp._alpha=NaN,Gi(Gp,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),Gp}(),GS=function(){function Gf(Ga){if(this._color=[],"string"==typeof Ga){null===(this.strColor=Ga)&&(Ga="#000000"),"#"==Ga.charAt(0)&&(Ga=Ga.substr(1));var Gb=Ga.length;if(3==Gb||4==Gb){for(var Gc="",Gd=0;Gd<Gb;Gd++)Gc+=Ga[Gd]+Ga[Gd];Ga=Gc}var Ge=this.numColor=parseInt(Ga,16);if(8==Ga.length)return void(this._color=[parseInt(Ga.substr(0,2),16)/255,((16711680&Ge)>>16)/255,((65280&Ge)>>8)/255,(255&Ge)/255])}else Ge=this.numColor=Ga,this.strColor=G$.toHexColor(Ge);this._color=[((16711680&Ge)>>16)/255,((65280&Ge)>>8)/255,(255&Ge)/255,1],this._color.__id=++Gf._COLODID}return Gr(Gf,"laya.utils.Color"),Gf._initDefault=function(){for(var Ga in Gf._DEFAULT={},Gf._COLOR_MAP)Gf._SAVE[Ga]=Gf._DEFAULT[Ga]=new Gf(Gf._COLOR_MAP[Ga]);return Gf._DEFAULT},Gf._initSaveMap=function(){for(var Ga in Gf._SAVE_SIZE=0,Gf._SAVE={},Gf._DEFAULT)Gf._SAVE[Ga]=Gf._DEFAULT[Ga]},Gf.create=function(Ga){var Gb=Gf._SAVE[Ga+""];return null!=Gb?Gb:(Gf._SAVE_SIZE<1e3||Gf._initSaveMap(),Gf._SAVE[Ga+""]=new Gf(Ga))},Gf._SAVE={},Gf._SAVE_SIZE=0,Gf._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},Gf._DEFAULT=Gf._initDefault(),Gf._COLODID=1,Gf}(),GT=(function(){function Ga(){this._values=[],this._keys=[]}Gr(Ga,"laya.utils.Dictionary");var Gb=Ga.prototype;Gb.set=function(Ga,Gb){var Gc=this.indexOf(Ga);0<=Gc?this._values[Gc]=Gb:(this._keys.push(Ga),this._values.push(Gb))},Gb.indexOf=function(Ga){var Gb=this._keys.indexOf(Ga);return 0<=Gb?Gb:(Ga="string"==typeof Ga?Number(Ga):"number"==typeof Ga?Ga.toString():Ga,this._keys.indexOf(Ga))},Gb.get=function(Ga){var Gb=this.indexOf(Ga);return Gb<0?null:this._values[Gb]},Gb.remove=function(Ga){var Gb=this.indexOf(Ga);return 0<=Gb&&(this._keys.splice(Gb,1),this._values.splice(Gb,1),!0)},Gb.clear=function(){this._values.length=0,this._keys.length=0},Gk(0,Gb,"values",function(){return this._values}),Gk(0,Gb,"keys",function(){return this._keys})}(),function(){function Ga(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}Gr(Ga,"laya.utils.Dragging");var Gb=Ga.prototype;return Gb.start=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){void 0===Gh&&(Gh=.92),this.clearTimer(),this.target=Ga,this.area=Gb,this.hasInertia=Gc,this.elasticDistance=Gb?Gd:0,this.elasticBackTime=Ge,this.data=Gf,this._disableMouseEvent=Gg,this.ratio=Gh,1!=Ga.globalScaleX||1!=Ga.globalScaleY?this._parent=Ga.parent:this._parent=Gz.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,Gz.stage.on("mouseup",this,this.onStageMouseUp),Gz.stage.on("mouseout",this,this.onStageMouseUp),Gz.timer.frameLoop(1,this,this.loop)},Gb.clearTimer=function(){Gz.timer.clear(this,this.loop),Gz.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},Gb.stop=function(){this._dragging&&(Gq.instance.disableMouseEvent=!1,Gz.stage.off("mouseup",this,this.onStageMouseUp),Gz.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},Gb.loop=function(){var Ga=this._parent.getMousePoint(),Gb=Ga.x,Gc=Ga.y,Gd=Gb-this._lastX,Ge=Gc-this._lastY;if(this._clickOnly){if(!(1<Math.abs(Gd*Gz.stage._canvasTransform.getScaleX())||1<Math.abs(Ge*Gz.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),Gq.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(Gd,Ge);0==Gd&&0==Ge||(this._lastX=Gb,this._lastY=Gc,this.target.x+=Gd*this._elasticRateX,this.target.y+=Ge*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},Gb.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var Ga=this.area.x-this.target.x;else Ga=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-Ga/this.elasticDistance),this.target.y<this.area.y)var Gb=this.area.y-this.target.y;else Gb=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-Gb/this.elasticDistance)}},Gb.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},Gb.onStageMouseUp=function(Ga){if(Gq.instance.disableMouseEvent=!1,Gz.stage.off("mouseup",this,this.onStageMouseUp),Gz.stage.off("mouseout",this,this.onStageMouseUp),Gz.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var Gb=this._offsets.length,Gc=Math.min(Gb,6),Gd=this._offsets.length-Gc,Ge=Gb-1;Gd<Ge;Ge--)this._offsetY+=this._offsets[Ge--],this._offsetX+=this._offsets[Ge];this._offsetX=this._offsetX/Gc*2,this._offsetY=this._offsetY/Gc*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),Gz.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},Gb.checkElastic=function(){var Ga=NaN,Gb=NaN;if(this.target.x<this.area.x?Ga=this.area.x:this.target.x>this.area.x+this.area.width&&(Ga=this.area.x+this.area.width),this.target.y<this.area.y?Gb=this.area.y:this.target.y>this.area.y+this.area.height&&(Gb=this.area.y+this.area.height),isNaN(Ga)&&isNaN(Gb))this.clear();else{var Gc={};isNaN(Ga)||(Gc.x=Ga),isNaN(Gb)||(Gc.y=Gb),this._tween=GZ.to(this.target,Gc,this.elasticBackTime,GU.sineOut,Gu.create(this,this.clear),0,!1,!1)}},Gb.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(Gz.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},Gb.clear=function(){if(this.target){this.clearTimer();var Ga=this.target;this.target=null,this._parent=null,Ga.event("dragend",this.data)}},Ga}()),GU=function(){function Gh(){}return Gr(Gh,"laya.utils.Ease"),Gh.linearNone=function(Ga,Gb,Gc,Gd){return Gc*Ga/Gd+Gb},Gh.linearIn=function(Ga,Gb,Gc,Gd){return Gc*Ga/Gd+Gb},Gh.linearInOut=function(Ga,Gb,Gc,Gd){return Gc*Ga/Gd+Gb},Gh.linearOut=function(Ga,Gb,Gc,Gd){return Gc*Ga/Gd+Gb},Gh.bounceIn=function(Ga,Gb,Gc,Gd){return Gc-Gh.bounceOut(Gd-Ga,0,Gc,Gd)+Gb},Gh.bounceInOut=function(Ga,Gb,Gc,Gd){return Ga<.5*Gd?.5*Gh.bounceIn(2*Ga,0,Gc,Gd)+Gb:.5*Gh.bounceOut(2*Ga-Gd,0,Gc,Gd)+.5*Gc+Gb},Gh.bounceOut=function(Ga,Gb,Gc,Gd){return(Ga/=Gd)<1/2.75?Gc*(7.5625*Ga*Ga)+Gb:Ga<2/2.75?Gc*(7.5625*(Ga-=1.5/2.75)*Ga+.75)+Gb:Ga<2.5/2.75?Gc*(7.5625*(Ga-=2.25/2.75)*Ga+.9375)+Gb:Gc*(7.5625*(Ga-=2.625/2.75)*Ga+.984375)+Gb},Gh.backIn=function(Ga,Gb,Gc,Gd,Ge){return void 0===Ge&&(Ge=1.70158),Gc*(Ga/=Gd)*Ga*((Ge+1)*Ga-Ge)+Gb},Gh.backInOut=function(Ga,Gb,Gc,Gd,Ge){return void 0===Ge&&(Ge=1.70158),(Ga/=.5*Gd)<1?.5*Gc*(Ga*Ga*((1+(Ge*=1.525))*Ga-Ge))+Gb:Gc/2*((Ga-=2)*Ga*((1+(Ge*=1.525))*Ga+Ge)+2)+Gb},Gh.backOut=function(Ga,Gb,Gc,Gd,Ge){return void 0===Ge&&(Ge=1.70158),Gc*((Ga=Ga/Gd-1)*Ga*((Ge+1)*Ga+Ge)+1)+Gb},Gh.elasticIn=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg;return void 0===Ge&&(Ge=0),void 0===Gf&&(Gf=0),0==Ga?Gb:1==(Ga/=Gd)?Gb+Gc:(Gf||(Gf=.3*Gd),Gg=!Ge||0<Gc&&Ge<Gc||Gc<0&&Ge<-Gc?(Ge=Gc,Gf/4):Gf/Gh.PI2*Math.asin(Gc/Ge),-Ge*Math.pow(2,10*(Ga-=1))*Math.sin((Ga*Gd-Gg)*Gh.PI2/Gf)+Gb)},Gh.elasticInOut=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg;return void 0===Ge&&(Ge=0),void 0===Gf&&(Gf=0),0==Ga?Gb:2==(Ga/=.5*Gd)?Gb+Gc:(Gf||(Gf=Gd*(.3*1.5)),Gg=!Ge||0<Gc&&Ge<Gc||Gc<0&&Ge<-Gc?(Ge=Gc,Gf/4):Gf/Gh.PI2*Math.asin(Gc/Ge),Ga<1?Ge*Math.pow(2,10*(Ga-=1))*Math.sin((Ga*Gd-Gg)*Gh.PI2/Gf)*-.5+Gb:Ge*Math.pow(2,-10*(Ga-=1))*Math.sin((Ga*Gd-Gg)*Gh.PI2/Gf)*.5+Gc+Gb)},Gh.elasticOut=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg;return void 0===Ge&&(Ge=0),void 0===Gf&&(Gf=0),0==Ga?Gb:1==(Ga/=Gd)?Gb+Gc:(Gf||(Gf=.3*Gd),Gg=!Ge||0<Gc&&Ge<Gc||Gc<0&&Ge<-Gc?(Ge=Gc,Gf/4):Gf/Gh.PI2*Math.asin(Gc/Ge),Ge*Math.pow(2,-10*Ga)*Math.sin((Ga*Gd-Gg)*Gh.PI2/Gf)+Gc+Gb)},Gh.strongIn=function(Ga,Gb,Gc,Gd){return Gc*(Ga/=Gd)*Ga*Ga*Ga*Ga+Gb},Gh.strongInOut=function(Ga,Gb,Gc,Gd){return(Ga/=.5*Gd)<1?.5*Gc*Ga*Ga*Ga*Ga*Ga+Gb:.5*Gc*((Ga-=2)*Ga*Ga*Ga*Ga+2)+Gb},Gh.strongOut=function(Ga,Gb,Gc,Gd){return Gc*((Ga=Ga/Gd-1)*Ga*Ga*Ga*Ga+1)+Gb},Gh.sineInOut=function(Ga,Gb,Gc,Gd){return.5*-Gc*(Math.cos(Math.PI*Ga/Gd)-1)+Gb},Gh.sineIn=function(Ga,Gb,Gc,Gd){return-Gc*Math.cos(Ga/Gd*Gh.HALF_PI)+Gc+Gb},Gh.sineOut=function(Ga,Gb,Gc,Gd){return Gc*Math.sin(Ga/Gd*Gh.HALF_PI)+Gb},Gh.quintIn=function(Ga,Gb,Gc,Gd){return Gc*(Ga/=Gd)*Ga*Ga*Ga*Ga+Gb},Gh.quintInOut=function(Ga,Gb,Gc,Gd){return(Ga/=.5*Gd)<1?.5*Gc*Ga*Ga*Ga*Ga*Ga+Gb:.5*Gc*((Ga-=2)*Ga*Ga*Ga*Ga+2)+Gb},Gh.quintOut=function(Ga,Gb,Gc,Gd){return Gc*((Ga=Ga/Gd-1)*Ga*Ga*Ga*Ga+1)+Gb},Gh.quartIn=function(Ga,Gb,Gc,Gd){return Gc*(Ga/=Gd)*Ga*Ga*Ga+Gb},Gh.quartInOut=function(Ga,Gb,Gc,Gd){return(Ga/=.5*Gd)<1?.5*Gc*Ga*Ga*Ga*Ga+Gb:.5*-Gc*((Ga-=2)*Ga*Ga*Ga-2)+Gb},Gh.quartOut=function(Ga,Gb,Gc,Gd){return-Gc*((Ga=Ga/Gd-1)*Ga*Ga*Ga-1)+Gb},Gh.cubicIn=function(Ga,Gb,Gc,Gd){return Gc*(Ga/=Gd)*Ga*Ga+Gb},Gh.cubicInOut=function(Ga,Gb,Gc,Gd){return(Ga/=.5*Gd)<1?.5*Gc*Ga*Ga*Ga+Gb:.5*Gc*((Ga-=2)*Ga*Ga+2)+Gb},Gh.cubicOut=function(Ga,Gb,Gc,Gd){return Gc*((Ga=Ga/Gd-1)*Ga*Ga+1)+Gb},Gh.quadIn=function(Ga,Gb,Gc,Gd){return Gc*(Ga/=Gd)*Ga+Gb},Gh.quadInOut=function(Ga,Gb,Gc,Gd){return(Ga/=.5*Gd)<1?.5*Gc*Ga*Ga+Gb:.5*-Gc*(--Ga*(Ga-2)-1)+Gb},Gh.quadOut=function(Ga,Gb,Gc,Gd){return-Gc*(Ga/=Gd)*(Ga-2)+Gb},Gh.expoIn=function(Ga,Gb,Gc,Gd){return 0==Ga?Gb:Gc*Math.pow(2,10*(Ga/Gd-1))+Gb-.001*Gc},Gh.expoInOut=function(Ga,Gb,Gc,Gd){return 0==Ga?Gb:Ga==Gd?Gb+Gc:(Ga/=.5*Gd)<1?.5*Gc*Math.pow(2,10*(Ga-1))+Gb:.5*Gc*(2-Math.pow(2,-10*--Ga))+Gb},Gh.expoOut=function(Ga,Gb,Gc,Gd){return Ga==Gd?Gb+Gc:Gc*(1-Math.pow(2,-10*Ga/Gd))+Gb},Gh.circIn=function(Ga,Gb,Gc,Gd){return-Gc*(Math.sqrt(1-(Ga/=Gd)*Ga)-1)+Gb},Gh.circInOut=function(Ga,Gb,Gc,Gd){return(Ga/=.5*Gd)<1?.5*-Gc*(Math.sqrt(1-Ga*Ga)-1)+Gb:.5*Gc*(Math.sqrt(1-(Ga-=2)*Ga)+1)+Gb},Gh.circOut=function(Ga,Gb,Gc,Gd){return Gc*Math.sqrt(1-(Ga=Ga/Gd-1)*Ga)+Gb},Gh.HALF_PI=.5*Math.PI,Gh.PI2=2*Math.PI,Gh}(),GV=function(){function Gl(){this._hit=null,this._unHit=null}Gr(Gl,"laya.utils.HitArea");var Ga=Gl.prototype;return Ga.isHit=function(Ga,Gb){return!!Gl.isHitGraphic(Ga,Gb,this.hit)&&!Gl.isHitGraphic(Ga,Gb,this.unHit)},Ga.contains=function(Ga,Gb){return this.isHit(Ga,Gb)},Gk(0,Ga,"hit",function(){return this._hit||(this._hit=new Go),this._hit},function(Ga){this._hit=Ga}),Gk(0,Ga,"unHit",function(){return this._unHit||(this._unHit=new Go),this._unHit},function(Ga){this._unHit=Ga}),Gl.isHitGraphic=function(Ga,Gb,Gc){if(!Gc)return!1;var Gd;if(!(Gd=Gc.cmds)&&Gc._one&&((Gd=Gl._cmds).length=1,Gd[0]=Gc._one),!Gd)return!1;var Ge,Gf,Gg=0;for(Ge=Gd.length,Gg=0;Gg<Ge;Gg++)if(Gf=Gd[Gg]){var Gh=GJ._context;switch(Gf.callee){case Gh._translate:case 6:Ga-=Gf[0],Gb-=Gf[1]}if(Gl.isHitCmd(Ga,Gb,Gf))return!0}return!1},Gl.isHitCmd=function(Ga,Gb,Gc){if(!Gc)return!1;var Gd=GJ._context,Ge=!1;switch(Gc.callee){case Gd._drawRect:case 13:Gl._rec.setTo(Gc[0],Gc[1],Gc[2],Gc[3]),Ge=Gl._rec.contains(Ga,Gb);break;case Gd._drawCircle:case Gd._fillCircle:case 14:Ge=(Ga-=Gc[0])*Ga+(Gb-=Gc[1])*Gb<Gc[2]*Gc[2];break;case Gd._drawPoly:case 18:Ga-=Gc[0],Gb-=Gc[1],Ge=Gl.ptInPolygon(Ga,Gb,Gc[2])}return Ge},Gl.ptInPolygon=function(Ga,Gb,Gc){var Gd;(Gd=Gl._ptPoint).setTo(Ga,Gb);var Ge,Gf=0,Gg=NaN,Gh=NaN,Gi=NaN,Gj=NaN;Ge=Gc.length;for(var Gk=0;Gk<Ge;Gk+=2){if(Gg=Gc[Gk],Gh=Gc[Gk+1],Gi=Gc[(Gk+2)%Ge],Gh!=(Gj=Gc[(Gk+3)%Ge]))if(!(Gd.y<Math.min(Gh,Gj)))if(!(Gd.y>=Math.max(Gh,Gj)))(Gd.y-Gh)*(Gi-Gg)/(Gj-Gh)+Gg>Gd.x&&Gf++}return Gf%2==1},Gl._cmds=[],Gi(Gl,["_rec",function(){return this._rec=new GB},"_ptPoint",function(){return this._ptPoint=new GA}]),Gl}(),GW=(function(){function Ge(Ga,Gb,Gc,Gd){this.char=Ga,this.charNum=Ga.charCodeAt(0),this._x=this._y=0,this.width=Gb,this.height=Gc,this.style=Gd,this.isWord=!Ge._isWordRegExp.test(Ga)}Gr(Ge,"laya.utils.HTMLChar");var Ga=Ge.prototype;Gz.imps(Ga,{"laya.display.ILayout":!0}),Ga.setSprite=function(Ga){this._sprite=Ga},Ga.getSprite=function(){return this._sprite},Ga._isChar=function(){return!0},Ga._getCSSStyle=function(){return this.style},Gk(0,Ga,"width",function(){return this._w},function(Ga){this._w=Ga}),Gk(0,Ga,"x",function(){return this._x},function(Ga){this._sprite&&(this._sprite.x=Ga),this._x=Ga}),Gk(0,Ga,"y",function(){return this._y},function(Ga){this._sprite&&(this._sprite.y=Ga),this._y=Ga}),Gk(0,Ga,"height",function(){return this._h},function(Ga){this._h=Ga}),Ge._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function Gb(){}Gr(Gb,"laya.utils.Log"),Gb.enable=function(){Gb._logdiv||(Gb._logdiv=GO.window.document.createElement("div"),GO.window.document.body.appendChild(Gb._logdiv),Gb._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},Gb.toggle=function(){var Ga=Gb._logdiv.style;"1px"==Ga.width?Ga.width=Ga.height="50%":Ga.width=Ga.height="1px"},Gb.print=function(Ga){Gb._logdiv&&(Gb.maxCount<=Gb._count&&Gb.clear(),Gb._count++,Gb._logdiv.innerText+=Ga+"\n",Gb._logdiv.scrollTop=Gb._logdiv.scrollHeight)},Gb.clear=function(){Gb._logdiv.innerText="",Gb._count=0},Gb._logdiv=null,Gb._count=0,Gb.maxCount=20}(),function(){function Gb(){}Gr(Gb,"laya.utils.Mouse"),Gk(1,Gb,"cursor",function(){return Gb._style.cursor},function(Ga){Gb._style.cursor=Ga}),Gb.hide=function(){"none"!=Gb.cursor&&(Gb._preCursor=Gb.cursor,Gb.cursor="none")},Gb.show=function(){"none"==Gb.cursor&&(Gb.cursor=Gb._preCursor?Gb._preCursor:"auto")},Gb._preCursor=null,Gi(Gb,["_style",function(){return this._style=GO.document.body.style}])}(),function(){function Gf(){}return Gr(Gf,"laya.utils.Pool"),Gf.getPoolBySign=function(Ga){return Gf._poolDic[Ga]||(Gf._poolDic[Ga]=[])},Gf.clearBySign=function(Ga){Gf._poolDic[Ga]&&(Gf._poolDic[Ga].length=0)},Gf.recover=function(Ga,Gb){Gb.__InPool||(Gb.__InPool=!0,Gf.getPoolBySign(Ga).push(Gb))},Gf.getItemByClass=function(Ga,Gb){var Gc=Gf.getPoolBySign(Ga),Gd=Gc.length?Gc.pop():new Gb;return Gd.__InPool=!1,Gd},Gf.getItemByCreateFun=function(Ga,Gb,Gc){var Gd=Gf.getPoolBySign(Ga),Ge=Gd.length?Gd.pop():Gb.call(Gc);return Ge.__InPool=!1,Ge},Gf.getItem=function(Ga){var Gb=Gf.getPoolBySign(Ga),Gc=Gb.length?Gb.pop():null;return Gc&&(Gc.__InPool=!1),Gc},Gf._poolDic={},Gf.InPoolSign="__InPool",Gf}()),GX=function(){function Gi(){}return Gr(Gi,"laya.utils.Stat"),Gk(1,Gi,"onclick",null,function(Ga){Gi._sp&&Gi._sp.on("click",Gi._sp,Ga),Gi._canvas&&(Gi._canvas.source.onclick=Ga,Gi._canvas.source.style.pointerEvents="")}),Gi.show=function(Ga,Gb,Gc){if(void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),!GJ.isConchApp||GJ.isConchWebGL){if(GJ.isConchWebGL||GO.onMiniGame||GO.onLimixiu||(Gi._useCanvas=!0),Gi._show=!0,Gi._fpsData.length=60,Gi._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},Gi._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},Gi._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},Gi._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},GJ.isWebGL)if(Gi._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},GJ.is3DMode){if(Gi._view[0].title="FPS(3D)",Gi._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},Gi._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},Gi._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==Gc){var Gd=8;Gi._view[Gd++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},Gi._view[Gd++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},Gi._view[Gd++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},Gi._view[Gd++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Gi._view[Gd++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Gi._view[Gd++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},Gi._view[Gd++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},Gi._view[Gd++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},Gi._view[Gd++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==Gc){Gd=8;Gi._view[Gd++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},Gi._view[Gd++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},Gi._view[Gd++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},Gi._view[Gd++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},Gi._view[Gd++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},Gi._view[Gd++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},Gi._view[Gd++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else Gi._view[0].title="FPS(WebGL)",Gi._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else Gi._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};Gi._useCanvas?Gi.createUIPre(Ga,Gb):Gi.createUI(Ga,Gb),Gi.enable()}else GO.window.conch.showFPS&&GO.window.conch.showFPS(Ga,Gb)},Gi.createUIPre=function(Ga,Gb){var Gc=GO.pixelRatio;Gi._width=170*Gc,Gi._vx=75*Gc,Gi._height=Gc*(12*Gi._view.length+3*Gc)+4,Gi._fontSize=12*Gc;for(var Gd=0;Gd<Gi._view.length;Gd++)Gi._view[Gd].x=4,Gi._view[Gd].y=Gd*Gi._fontSize+2*Gc;Gi._canvas||((Gi._canvas=new Gva("2D")).size(Gi._width,Gi._height),(Gi._ctx=Gi._canvas.getContext("2d")).textBaseline="top",Gi._ctx.font=Gi._fontSize+"px Sans-serif",Gi._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+Ga+"px;top:"+Gb+"px;width:"+Gi._width/Gc+"px;height:"+Gi._height/Gc+"px;"),Gi._first=!0,Gi.loop(),Gi._first=!1,GO.container.appendChild(Gi._canvas.source)},Gi.createUI=function(Ga,Gb){var Gc=Gi._sp,Gd=GO.pixelRatio;Gc||(Gc=new Gla,(Gi._leftText=new Gsa).pos(5,5),Gi._leftText.color="#ffffff",Gc.addChild(Gi._leftText),(Gi._txt=new Gsa).pos(80*Gd,5),Gi._txt.color="#ffffff",Gc.addChild(Gi._txt),Gi._sp=Gc),Gc.pos(Ga,Gb);for(var Ge="",Gf=0;Gf<Gi._view.length;Gf++){Ge+=Gi._view[Gf].title+"\n"}Gi._leftText.text=Ge;var Gg=170*Gd,Gh=Gd*(12*Gi._view.length+3*Gd)+4;Gi._txt.fontSize=Gi._fontSize*Gd,Gi._leftText.fontSize=Gi._fontSize*Gd,Gc.size(Gg,Gh),Gc.graphics.clear(),Gc.graphics.setAlpha(.5),Gc.graphics.drawRect(0,0,Gg,Gh,"#999999"),Gc.graphics.setAlpha(1),Gi.loop()},Gi.enable=function(){Gz.timer.frameLoop(1,Gi,Gi.loop)},Gi.hide=function(){Gi._show=!1,Gz.timer.clear(Gi,Gi.loop),Gi._canvas&&GO.removeElement(Gi._canvas.source)},Gi.clear=function(){Gi.trianglesFaces=Gi.drawCall=Gi.shaderCall=Gi.spriteCount=Gi.spriteRenderUseCacheCount=Gi.treeNodeCollision=Gi.treeSpriteCollision=Gi.canvasNormal=Gi.canvasBitmap=Gi.canvasReCache=0},Gi.loop=function(){Gi._count++;var Ga=GO.now();if(!(Ga-Gi._timer<1e3)){var Gb=Gi._count;if(Gi.FPS=Math.round(1e3*Gb/(Ga-Gi._timer)),Gi._show){Gi.trianglesFaces=Math.round(Gi.trianglesFaces/Gb),Gi.spriteCount=Gi._useCanvas?(Gi.drawCall=Math.round(Gi.drawCall/Gb)-2,Gi.shaderCall=Math.round(Gi.shaderCall/Gb),Math.round(Gi.spriteCount/Gb)-1):(Gi.drawCall=Math.round(Gi.drawCall/Gb)-2,Gi.shaderCall=Math.round(Gi.shaderCall/Gb)-4,Math.round(Gi.spriteCount/Gb)-4),Gi.spriteRenderUseCacheCount=Math.round(Gi.spriteRenderUseCacheCount/Gb),Gi.canvasNormal=Math.round(Gi.canvasNormal/Gb),Gi.canvasBitmap=Math.round(Gi.canvasBitmap/Gb),Gi.canvasReCache=Math.ceil(Gi.canvasReCache/Gb),Gi.treeNodeCollision=Math.round(Gi.treeNodeCollision/Gb),Gi.treeSpriteCollision=Math.round(Gi.treeSpriteCollision/Gb);var Gc=0<Gi.FPS?Math.floor(1e3/Gi.FPS).toString():" ";Gi._fpsStr=Gi.FPS+(Gi.renderSlow?" slow":"")+" "+Gc,Gi._spriteStr=Gi.spriteCount+(Gi.spriteRenderUseCacheCount?"/"+Gi.spriteRenderUseCacheCount:""),Gi._canvasStr=Gi.canvasReCache+"/"+Gi.canvasNormal+"/"+Gi.canvasBitmap,Gi.currentMemorySize=GN.systemResourceManager.memorySize,Gi._useCanvas?Gi.renderInfoPre():Gi.renderInfo(),Gi.clear()}Gi._count=0,Gi._timer=Ga}},Gi.renderInfoPre=function(){if(Gi._canvas){var Ga=Gi._ctx;Ga.clearRect(Gi._first?0:Gi._vx,0,Gi._width,Gi._height);for(var Gb=GJ.WebGL.mainContext,Gc=0;Gc<Gi._view.length;Gc++){var Gd=Gi._view[Gc];Gi._first&&(Ga.fillStyle="white",Ga.fillText(Gd.title,Gd.x,Gd.y,null,null,null)),Ga.fillStyle=Gd.color;var Ge=-1;if((Gd=Gi._view[Gc]).varying){if(Gb)switch(Gd.varying){case 1:Ge=Gb.getParameter(Gb[Gd.value]);break;case 2:Ge=Gb.getExtension(Gd.value)}}else Ge=Gi[Gd.value];"M"==Gd.units&&(Ge=Math.floor(Ge/1048576*100)/100+" M"),"K"==Gd.units&&(Ge=Math.floor(Ge/1024*100)/100+" K"),"string"==Gd.units&&(Ge=Ge.match(/\d+\.?\d/i)),Ga.fillText(Ge+"",Gd.x+Gi._vx,Gd.y,null,null,null)}}},Gi.renderInfo=function(){for(var Ga="",Gb=GJ.WebGL.mainContext,Gc=0;Gc<Gi._view.length;Gc++){var Gd=Gi._view[Gc],Ge=-1;if(Gd.varying){if(Gb)switch(Gd.varying){case 1:Ge=Gb.getParameter(Gb[Gd.value]);break;case 2:Ge=Gb.getExtension(Gd.value)}}else Ge=Gi[Gd.value];"M"==Gd.units&&(Ge=Math.floor(Ge/1048576*100)/100+" M"),"K"==Gd.units&&(Ge=Math.floor(Ge/1024*100)/100+" K"),"string"==Gd.units&&(Ge=Ge.match(/\d+\.?\d/i)),Ga+=Ge+"\n"}Gi._txt.text=Ga},Gi.FPS=0,Gi.loopCount=0,Gi.shaderCall=0,Gi.drawCall=0,Gi.trianglesFaces=0,Gi.spriteCount=0,Gi.spriteRenderUseCacheCount=0,Gi.treeNodeCollision=0,Gi.treeSpriteCollision=0,Gi.canvasNormal=0,Gi.canvasBitmap=0,Gi.canvasReCache=0,Gi.renderSlow=!1,Gi.currentMemorySize=0,Gi._fpsStr=null,Gi._canvasStr=null,Gi._spriteStr=null,Gi._fpsData=[],Gi._timer=0,Gi._count=0,Gi._view=[],Gi._fontSize=12,Gi._txt=null,Gi._leftText=null,Gi._sp=null,Gi._show=!1,Gi._useCanvas=!1,Gi._canvas=null,Gi._ctx=null,Gi._first=!1,Gi._vx=NaN,Gi._width=0,Gi._height=100,Gi}(),GY=(function(){function Ga(){this._strsToID={},this._idToStrs=[],this._length=0}Gr(Ga,"laya.utils.StringKey");var Gb=Ga.prototype;Gb.add=function(Ga){var Gb=this._strsToID[Ga];return null!=Gb?Gb:(this._idToStrs[this._length]=Ga,this._strsToID[Ga]=this._length++)},Gb.getID=function(Ga){var Gb=this._strsToID[Ga];return null==Gb?-1:Gb},Gb.getName=function(Ga){var Gb=this._idToStrs[Ga];return null==Gb?void 0:Gb}}(),function(){var Gj;function Ga(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}Gr(Ga,"laya.utils.Timer");var Gb=Ga.prototype;return Gb._init=function(){Gz.timer&&Gz.timer.frameLoop(1,this,this._update)},Gb._now=function(){return Date.now()},Gb._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var Ga=this.currFrame=this.currFrame+this.scale,Gb=this._now();this._delta=(Gb-this._lastTimer)*this.scale;var Gc=this.currTimer=this.currTimer+this._delta;Gz.isDebug&&6e4<Math.abs(Gb-this._lastTimer)&&console.error("系统时间错误！"+(Gb-this._lastTimer)),this._lastTimer=Gb;var Gd=this._handlers;for(Gg=this._count=0,Gh=Gd.length;Gg<Gh;Gg++)if(null!==(Gi=Gd[Gg]).method){var Ge=Gi.userFrame?Ga:Gc;if(Ge>=Gi.exeTime)if(Gi.repeat)if(Gi.jumpFrame)for(;Ge>=Gi.exeTime;)Gi.exeTime+=Gi.delay,Gi.run(!1);else Gi.exeTime+=Gi.delay,Gi.run(!1),Ge>Gi.exeTime&&(Gi.exeTime+=Math.ceil((Ge-Gi.exeTime)/Gi.delay)*Gi.delay);else Gi.run(!0)}else this._count++;(30<this._count||Ga%200==0)&&this._clearHandlers();for(var Gf=this._laters,Gg=0,Gh=Gf.length-1;Gg<=Gh;Gg++){var Gi=Gf[Gg];this._isIgnoreRecover(Gi)||(null!==Gi.method&&(delete this._map[Gi.key],Gi.run(!1)),this._recoverHandler(Gi)),Gg===Gh&&(Gh=Gf.length-1)}Gf.length=0}},Gb._clearHandlers=function(){for(var Ga=this._handlers,Gb=0,Gc=Ga.length;Gb<Gc;Gb++){var Gd=Ga[Gb];null!==Gd.method?this._temp.push(Gd):this._isIgnoreRecover(Gd)?this._temp.push(Gd):this._recoverHandler(Gd)}this._handlers=this._temp,this._temp=Ga,this._temp.length=0},Gb._recoverHandler=function(Ga){this._map[Ga.key]==Ga&&delete this._map[Ga.key],Ga.recover()},Gb._create=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){if(!Gc)return Ge.apply(Gd,Gf),null;if(Gg){var Gi=this._getHandler(Gd,Ge);if(Gi)return Gi.repeat=Gb,Gi.userFrame=Ga,Gi.delay=Gc,Gi.ignoreRecover=Gh,Gi.caller=Gd,Gi.method=Ge,Gi.args=Gf,Gi.exeTime=Gc+(Ga?this.currFrame:this.currTimer+this._now()-this._lastTimer),Gi}return(Gi=Gj.create()).repeat=Gb,Gi.userFrame=Ga,Gi.delay=Gc,Gi.ignoreRecover=Gh,Gi.caller=Gd,Gi.method=Ge,Gi.args=Gf,Gi.exeTime=Gc+(Ga?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(Gi),this._handlers.push(Gi),Gi},Gb._indexHandler=function(Ga){var Gb=Ga.caller,Gc=Ga.method,Gd=Gb?Gb.$_GID||(Gb.$_GID=G$.getGID()):0,Ge=Gc.$_TID||(Gc.$_TID=this._mid++);Ga.key=Gd+"_"+Ge,this._map[Ga.key]=Ga},Gb.once=function(Ga,Gb,Gc,Gd,Ge){void 0===Ge&&(Ge=!0),this._create(!1,!1,Ga,Gb,Gc,Gd,Ge,!1)},Gb.loop=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){void 0===Ge&&(Ge=!0),void 0===Gf&&(Gf=!1),void 0===Gg&&(Gg=!1);var Gh=this._create(!1,!0,Ga,Gb,Gc,Gd,Ge,Gg);Gh&&(Gh.jumpFrame=Gf)},Gb.frameOnce=function(Ga,Gb,Gc,Gd,Ge){void 0===Ge&&(Ge=!0),this._create(!0,!1,Ga,Gb,Gc,Gd,Ge,!1)},Gb.frameLoop=function(Ga,Gb,Gc,Gd,Ge,Gf){void 0===Ge&&(Ge=!0),void 0===Gf&&(Gf=!1),this._create(!0,!0,Ga,Gb,Gc,Gd,Ge,Gf)},Gb.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+Gj._freeCount},Gb.clear=function(Ga,Gb){var Gc=this._getHandler(Ga,Gb);return!(!Gc||this._isIgnoreRecover(Gc))&&(delete this._map[Gc.key],Gc.key=null,Gc.clear(),!0)},Gb.clearAll=function(Ga){if(Ga)for(var Gb=0,Gc=this._handlers.length;Gb<Gc;Gb++){var Gd=this._handlers[Gb];Gd.caller===Ga&&(this._isIgnoreRecover(Gd)||(delete this._map[Gd.key],Gd.key=null,Gd.clear()))}},Gb._getHandler=function(Ga,Gb){var Gc=Ga?Ga.$_GID||(Ga.$_GID=G$.getGID()):0,Gd=Gb.$_TID||(Gb.$_TID=this._mid++);return this._map[Gc+"_"+Gd]},Gb._isIgnoreRecover=function(Ga){if(Ga.ignoreRecover||Ga.caller&&"IgnoreRecover"==Ga.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var Gb="";try{arguments.propertyIsEnumerable.caller}catch(Ga){Gb=Ga.stack}Gz.recordError("报错：核心定时器销毁忽略  "+Gb)}return!0}return!1},Gb.hasHandler=function(Ga,Gb){return this._map[Ga.$_GID+"_"+Gb.$_TID]},Gb.callLater=function(Ga,Gb,Gc){if(null==this._getHandler(Ga,Gb)){var Gd=Gj.create();Gd.caller=Ga,Gd.method=Gb,Gd.args=Gc,this._indexHandler(Gd),this._laters.push(Gd)}},Gb.runCallLater=function(Ga,Gb){var Gc=this._getHandler(Ga,Gb);Gc&&null!=Gc.method&&(this._isIgnoreRecover(Gc)||(delete this._map[Gc.key],Gc.run(!0)))},Gb.runTimer=function(Ga,Gb){this.runCallLater(Ga,Gb)},Gk(0,Gb,"delta",function(){return this._delta}),Ga.__init$=function(){Gj=function(){function Gb(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}Gr(Gb,"");var Ga=Gb.prototype;return Ga.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},Ga.recover=function(){this.clear(),this.args=Gb._freeHandler,Gb._freeHandler=this,Gb._freeCount++},Ga.run=function(Ga){var Gb=this.caller;if(Gb&&Gb.destroyed)return this.clear();var Gc=this.method,Gd=this.args;Ga&&this.clear(),null!=Gc&&(Gd?Gc.apply(Gb,Gd):Gc.call(Gb))},Gb._freeHandler=null,Gb._freeCount=0,Gb.create=function(){var Ga=Gb._freeHandler;return Ga?(Gb._freeHandler=Ga.args,--Gb._freeCount,Ga.args=null,Ga):new Gb},Gb}()},Ga}()),GZ=function(){function Gl(){this.gid=0}Gr(Gl,"laya.utils.Tween");var Ga=Gl.prototype;return Ga.to=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){return void 0===Gf&&(Gf=0),void 0===Gg&&(Gg=!1),this._create(Ga,Gb,Gc,Gd,Ge,Gf,Gg,!0,!1,!0)},Ga.from=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){return void 0===Gf&&(Gf=0),void 0===Gg&&(Gg=!1),this._create(Ga,Gb,Gc,Gd,Ge,Gf,Gg,!1,!1,!0)},Ga._create=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){if(!Ga)throw new Error("Tween:target is null");this._target=Ga,this._duration=Gc,this._ease=Gd||Gb.ease||Gl.easeNone,this._complete=Ge||Gb.complete,this._delay=Gf,this._props=[],this._usedTimer=0,this._startTimer=GO.now(),this._usedPool=Gi,this._delayParam=null,this.update=Gb.update;var Gk=Ga.$_GID||(Ga.$_GID=G$.getGID());return Gl.tweenMap[Gk]?(Gg&&Gl.clearTween(Ga),Gl.tweenMap[Gk].push(this)):Gl.tweenMap[Gk]=[this],Gj?Gf<=0?this.firstStart(Ga,Gb,Gh):(this._delayParam=[Ga,Gb,Gh],Gz.scaleTimer.once(Gf,this,this.firstStart,this._delayParam)):this._initProps(Ga,Gb,Gh),this},Ga.firstStart=function(Ga,Gb,Gc){this._delayParam=null,Ga.destroyed?this.clear():(this._initProps(Ga,Gb,Gc),this._beginLoop())},Ga._initProps=function(Ga,Gb,Gc){for(var Gd in Gb)if("number"==typeof Ga[Gd]){var Ge=Gc?Ga[Gd]:Gb[Gd],Gf=Gc?Gb[Gd]:Ga[Gd];this._props.push([Gd,Ge,Gf-Ge]),Gc||(Ga[Gd]=Ge)}},Ga._beginLoop=function(){Gz.scaleTimer.frameLoop(1,this,this._doEase)},Ga._doEase=function(){this._updateEase(GO.now())},Ga._updateEase=function(Ga){var Gb=this._target;if(Gb){if(Gb.destroyed)return Gl.clearTween(Gb);var Gc=this._usedTimer=Ga-this._startTimer-this._delay;if(!(Gc<0)){if(Gc>=this._duration)return this.complete();for(var Gd=0<Gc?this._ease(Gc,0,1,this._duration):0,Ge=this._props,Gf=0,Gg=Ge.length;Gf<Gg;Gf++){var Gh=Ge[Gf];Gb[Gh[0]]=Gh[1]+Gd*Gh[2]}this.update&&this.update.run()}}},Ga.complete=function(){if(this._target){Gz.scaleTimer.runTimer(this,this.firstStart);for(var Ga=this._target,Gb=this._props,Gc=this._complete,Gd=0,Ge=Gb.length;Gd<Ge;Gd++){var Gf=Gb[Gd];Ga[Gf[0]]=Gf[1]+Gf[2]}this.update&&this.update.run(),this.clear(),Gc&&Gc.run()}},Ga.pause=function(){Gz.scaleTimer.clear(this,this._beginLoop),Gz.scaleTimer.clear(this,this._doEase),Gz.scaleTimer.clear(this,this.firstStart);var Ga;(Ga=GO.now()-this._startTimer-this._delay)<0&&(this._usedTimer=Ga)},Ga.setStartTime=function(Ga){this._startTimer=Ga},Ga.clear=function(){this._target&&(this._remove(),this._clear())},Ga._clear=function(){this.pause(),Gz.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,GW.recover("tween",this))},Ga.recover=function(){this._usedPool=!0,this._clear()},Ga._remove=function(){var Ga=Gl.tweenMap[this._target.$_GID];if(Ga)for(var Gb=0,Gc=Ga.length;Gb<Gc;Gb++)if(Ga[Gb]===this){Ga.splice(Gb,1);break}},Ga.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=GO.now(),this._delayParam)Gz.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var Ga=this._props,Gb=0,Gc=Ga.length;Gb<Gc;Gb++){var Gd=Ga[Gb];this._target[Gd[0]]=Gd[1]}Gz.scaleTimer.once(this._delay,this,this._beginLoop)}},Ga.resume=function(){this._usedTimer>=this._duration||(this._startTimer=GO.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?Gz.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},Gk(0,Ga,"progress",null,function(Ga){var Gb=Ga*this._duration;this._startTimer=GO.now()-this._delay-Gb}),Gl.to=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){return void 0===Gf&&(Gf=0),void 0===Gg&&(Gg=!1),void 0===Gh&&(Gh=!0),GW.getItemByClass("tween",Gl)._create(Ga,Gb,Gc,Gd,Ge,Gf,Gg,!0,Gh,!0)},Gl.from=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){return void 0===Gf&&(Gf=0),void 0===Gg&&(Gg=!1),void 0===Gh&&(Gh=!0),GW.getItemByClass("tween",Gl)._create(Ga,Gb,Gc,Gd,Ge,Gf,Gg,!1,Gh,!0)},Gl.clearAll=function(Ga){if(Ga&&Ga.$_GID){var Gb=Gl.tweenMap[Ga.$_GID];if(Gb){for(var Gc=0,Gd=Gb.length;Gc<Gd;Gc++)Gb[Gc]._clear();Gb.length=0}}},Gl.clear=function(Ga){Ga.clear()},Gl.clearTween=function(Ga){Gl.clearAll(Ga)},Gl.easeNone=function(Ga,Gb,Gc,Gd){return Gc*Ga/Gd+Gb},Gl.tweenMap={},Gl}(),G$=function(){function Gh(){}return Gr(Gh,"laya.utils.Utils"),Gh.toRadian=function(Ga){return Ga*Gh._pi2},Gh.toAngle=function(Ga){return Ga*Gh._pi},Gh.toHexColor=function(Ga){if(Ga<0||isNaN(Ga))return null;for(var Gb=Ga.toString(16);Gb.length<6;)Gb="0"+Gb;return"#"+Gb},Gh.getGID=function(){return Gh._gid++},Gh.concatArray=function(Ga,Gb){if(!Gb)return Ga;if(!Ga)return Gb;var Gc=0,Gd=Gb.length;for(Gc=0;Gc<Gd;Gc++)Ga.push(Gb[Gc]);return Ga},Gh.clearArray=function(Ga){return Ga&&(Ga.length=0),Ga},Gh.copyArray=function(Ga,Gb){if(Ga||(Ga=[]),!Gb)return Ga;Ga.length=Gb.length;var Gc=0,Gd=Gb.length;for(Gc=0;Gc<Gd;Gc++)Ga[Gc]=Gb[Gc];return Ga},Gh.getGlobalRecByPoints=function(Ga,Gb,Gc,Gd,Ge){var Gf,Gg;return Gf=new GA(Gb,Gc),Gf=Ga.localToGlobal(Gf),Gg=new GA(Gd,Ge),Gg=Ga.localToGlobal(Gg),GB._getWrapRec([Gf.x,Gf.y,Gg.x,Gg.y])},Gh.getGlobalPosAndScale=function(Ga){return Gh.getGlobalRecByPoints(Ga,0,0,1,1)},Gh.bind=function(Ga,Gb){return Ga.bind(Gb)},Gh.measureText=function(Ga,Gb){return GF.measureText(Ga,Gb)},Gh.updateOrder=function(Ga){if(!Ga||Ga.length<2)return!1;for(var Gb,Gc=1,Gd=0,Ge=Ga.length,Gf=NaN;Gc<Ge;){for(Gb=Ga[Gd=Gc],Gf=Ga[Gd]._zOrder;-1<--Gd&&Ga[Gd]._zOrder>Gf;)Ga[Gd+1]=Ga[Gd];Ga[Gd+1]=Gb,Gc++}var Gg=Gb.parent.conchModel;if(Gg)if(null!=Gg.updateZOrder)Gg.updateZOrder();else{for(Gc=0;Gc<Ge;Gc++)Gg.removeChild(Ga[Gc].conchModel);for(Gc=0;Gc<Ge;Gc++)Gg.addChildAt(Ga[Gc].conchModel,Gc)}return!0},Gh.transPointList=function(Ga,Gb,Gc){var Gd=0,Ge=Ga.length;for(Gd=0;Gd<Ge;Gd+=2)Ga[Gd]+=Gb,Ga[Gd+1]+=Gc},Gh.parseInt=function(Ga,Gb){void 0===Gb&&(Gb=0);var Gc=GO.window.parseInt(Ga,Gb);return isNaN(Gc)?0:Gc},Gh.getFileExtension=function(Ga){Gh._extReg.lastIndex=Ga.lastIndexOf(".");var Gb=Gh._extReg.exec(Ga);return Gb&&1<Gb.length?Gb[1].toLowerCase():null},Gh.getTransformRelativeToWindow=function(Ga,Gb,Gc){var Gd=Gz.stage,Ge=laya.utils.Utils.getGlobalPosAndScale(Ga),Gf=Gd._canvasTransform.clone(),Gg=Gf.tx,Gh=Gf.ty;Gf.rotate(-Math.PI/180*Gz.stage.canvasDegree),Gf.scale(Gz.stage.clientScaleX,Gz.stage.clientScaleY);var Gi=Gz.stage.canvasDegree%180!=0,Gj=NaN,Gk=NaN;Gi?(Gj=Gc+Ge.y,Gk=Gb+Ge.x,Gj*=Gf.d,Gk*=Gf.a,90==Gz.stage.canvasDegree?(Gj=Gg-Gj,Gk+=Gh):(Gj+=Gg,Gk=Gh-Gk)):(Gj=Gb+Ge.x,Gk=Gc+Ge.y,Gj*=Gf.a,Gk*=Gf.d,Gj+=Gg,Gk+=Gh);var Gl=NaN,Go=NaN;return Go=Gi?(Gl=Gf.d*Ge.height,Gf.a*Ge.width):(Gl=Gf.a*Ge.width,Gf.d*Ge.height),{x:Gj,y:Gk,scaleX:Gl,scaleY:Go}},Gh.fitDOMElementInArea=function(Ga,Gb,Gc,Gd,Ge,Gf){Ga._fitLayaAirInitialized||(Ga._fitLayaAirInitialized=!0,Ga.style.transformOrigin=Ga.style.webKittransformOrigin="left top",Ga.style.position="absolute");var Gg=Gh.getTransformRelativeToWindow(Gb,Gc,Gd);Ga.style.transform=Ga.style.webkitTransform="scale("+Gg.scaleX+","+Gg.scaleY+") rotate("+Gz.stage.canvasDegree+"deg)",Ga.style.width=Ge+"px",Ga.style.height=Gf+"px",Ga.style.left=Gg.x+"px",Ga.style.top=Gg.y+"px"},Gh.isOkTextureList=function(Ga){if(!Ga)return!1;var Gb,Gc=0,Gd=Ga.length;for(Gc=0;Gc<Gd;Gc++)if(!(Gb=Ga[Gc])||!Gb.source)return!1;return!0},Gh.isOKCmdList=function(Ga){if(!Ga)return!1;var Gb,Gc,Gd=0,Ge=Ga.length,Gf=GJ._context;for(Gd=0;Gd<Ge;Gd++)switch((Gb=Ga[Gd]).callee){case Gf._drawTexture:case Gf._fillTexture:case Gf._drawTextureWithTransform:if(!(Gc=Gb[0])||!Gc.source)return!1}return!0},Gh._gid=1,Gh._pi=180/Math.PI,Gh._pi2=Math.PI/180,Gh._extReg=/\.(\w+)\??/g,Gh.parseXMLFromString=function(Ga){var Gb;if(Ga=Ga.replace(/>\s+</g,"><"),-1<(Gb=(new DOMParser).parseFromString(Ga,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(Gb.firstChild.firstChild.textContent);return Gb},Gh}(),G_=function(){function Ga(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],GJ.isWebGL&&GQ.regCacheByFunction(G$.bind(this.startDispose,this),G$.bind(this.getCacheList,this))}Gr(Ga,"laya.utils.VectorGraphManager");var Gb=Ga.prototype;return Gb.getId=function(){return this._id++},Gb.addShape=function(Ga,Gb){this.shapeDic[Ga]=Gb,this.useDic[Ga]||(this.useDic[Ga]=!0)},Gb.addLine=function(Ga,Gb){this.shapeLineDic[Ga]=Gb,this.shapeLineDic[Ga]||(this.shapeLineDic[Ga]=!0)},Gb.getShape=function(Ga){this._checkKey&&null!=this.useDic[Ga]&&(this.useDic[Ga]=!0)},Gb.deleteShape=function(Ga){this.shapeDic[Ga]&&(this.shapeDic[Ga]=null,delete this.shapeDic[Ga]),this.shapeLineDic[Ga]&&(this.shapeLineDic[Ga]=null,delete this.shapeLineDic[Ga]),null!=this.useDic[Ga]&&delete this.useDic[Ga]},Gb.getCacheList=function(){var Ga,Gb=[];for(Ga in this.shapeDic)Gb.push(this.shapeDic[Ga]);for(Ga in this.shapeLineDic)Gb.push(this.shapeLineDic[Ga]);return Gb},Gb.startDispose=function(Ga){var Gb;for(Gb in this.useDic)this.useDic[Gb]=!1;this._checkKey=!0},Gb.endDispose=function(){if(this._checkKey){var Ga;for(Ga in this.useDic)this.useDic[Ga]||this.deleteShape(Ga);this._checkKey=!1}},Ga.getInstance=function(){return Ga.instance=Ga.instance||new Ga},Ga.instance=null,Ga}(),Gm=function(){function Gd(){this._obj=null,this._obj=Gd.supportWeakMap?new GO.window.WeakMap:{},Gd.supportWeakMap||Gd._maps.push(this)}Gr(Gd,"laya.utils.WeakObject");var Ga=Gd.prototype;return Ga.set=function(Ga,Gb){if(null!=Ga)if(Gd.supportWeakMap){var Gc=Ga;"string"!=typeof Ga&&"number"!=typeof Ga||(Gc=Gd._keys[Ga])||(Gc=Gd._keys[Ga]={k:Ga}),this._obj.set(Gc,Gb)}else"string"==typeof Ga||"number"==typeof Ga?this._obj[Ga]=Gb:(Ga.$_GID||(Ga.$_GID=G$.getGID()),this._obj[Ga.$_GID]=Gb)},Ga.get=function(Ga){if(null==Ga)return null;if(Gd.supportWeakMap){var Gb="string"==typeof Ga||"number"==typeof Ga?Gd._keys[Ga]:Ga;return Gb?this._obj.get(Gb):null}return"string"==typeof Ga||"number"==typeof Ga?this._obj[Ga]:this._obj[Ga.$_GID]},Ga.del=function(Ga){if(null!=Ga)if(Gd.supportWeakMap){var Gb="string"==typeof Ga||"number"==typeof Ga?Gd._keys[Ga]:Ga;if(!Gb)return;this._obj.delete(Gb)}else"string"==typeof Ga||"number"==typeof Ga?delete this._obj[Ga]:delete this._obj[this._obj.$_GID]},Ga.has=function(Ga){if(null==Ga)return!1;if(Gd.supportWeakMap){var Gb="string"==typeof Ga||"number"==typeof Ga?Gd._keys[Ga]:Ga;return this._obj.has(Gb)}return"string"==typeof Ga||"number"==typeof Ga?null!=this._obj[Ga]:null!=this._obj[this._obj.$_GID]},Gd.__init__=function(){(Gd.supportWeakMap=null!=GO.window.WeakMap)||Gz.timer.loop(Gd.delInterval,null,Gd.clearCache)},Gd.clearCache=function(){for(var Ga=0,Gb=Gd._maps.length;Ga<Gb;Ga++){Gd._maps[Ga]._obj={}}},Gd.supportWeakMap=!1,Gd.delInterval=3e5,Gd._keys={},Gd._maps=[],Gi(Gd,["I",function(){return this.I=new Gd}]),Gd}(),Gn=function(){function Ga(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}Gr(Ga,"laya.utils.WordText");var Gb=Ga.prototype;return Gb.setText=function(Ga){this.changed=!0,this._text=Ga},Gb.toString=function(){return this._text},Gb.charCodeAt=function(Ga){return this._text?this._text.charCodeAt(Ga):NaN},Gb.charAt=function(Ga){return this._text?this._text.charAt(Ga):null},Gk(0,Gb,"length",function(){return this._text?this._text.length:0}),Ga}(),Gaa=function(Ga){function Gg(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,Gg.__super.call(this),this._childs=Gg.ARRAY_EMPTY,this._$P=Gg.PROP_EMPTY,this.timer=Gz.scaleTimer,this.conchModel=GJ.isConchNode?this.createConchModel():null}Gr(Gg,"laya.display.Node",Gj);var Gb=Gg.prototype;return Gb._setBit=function(Ga,Gb){1==Ga&&(this._getBit(Ga)!=Gb&&this._updateDisplayedInstage());Gb?this._bits|=Ga:this._bits&=~Ga},Gb._getBit=function(Ga){return 0!=(this._bits&Ga)},Gb._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},Gb._setUpNoticeType=function(Ga){var Gb=this;for(Gb._setBit(Ga,!0),Gb=Gb.parent;Gb;){if(Gb._getBit(Ga))return;Gb._setBit(Ga,!0),Gb=Gb.parent}},Gb.on=function(Ga,Gb,Gc,Gd){return"display"!==Ga&&"undisplay"!==Ga||this._getBit(1)||this._setUpNoticeType(1),this._createListener(Ga,Gb,Gc,Gd,!1)},Gb.once=function(Ga,Gb,Gc,Gd){return"display"!==Ga&&"undisplay"!==Ga||this._getBit(1)||this._setUpNoticeType(1),this._createListener(Ga,Gb,Gc,Gd,!0)},Gb.createConchModel=function(){return null},Gb.destroy=function(Ga){void 0===Ga&&(Ga=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(Ga?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},Gb.destroyChildren=function(){if(this._childs)for(var Ga=this._childs.length-1;-1<Ga;Ga--)this._childs[Ga].destroy(!0)},Gb.addChild=function(Ga){if(!Ga||this.destroyed||Ga===this)return Ga;if(Ga.zOrder&&this._set$P("hasZorder",!0),Ga._parent===this){var Gb=this.getChildIndex(Ga);Gb!==this._childs.length-1&&(this._childs.splice(Gb,1),this._childs.push(Ga),this.conchModel&&(this.conchModel.removeChild(Ga.conchModel),this.conchModel.addChildAt(Ga.conchModel,this._childs.length-1)),this._childChanged())}else Ga.parent&&Ga.parent.removeChild(Ga),this._childs===Gg.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Ga),this.conchModel&&this.conchModel.addChildAt(Ga.conchModel,this._childs.length-1),(Ga.parent=this)._childChanged();return Ga},Gb.addChildren=function(Ga){for(var Gb=arguments,Gc=0,Gd=Gb.length;Gc<Gd;)this.addChild(Gb[Gc++])},Gb.addChildAt=function(Ga,Gb){if(!Ga||this.destroyed||Ga===this)return Ga;if(Ga.zOrder&&this._set$P("hasZorder",!0),0<=Gb&&Gb<=this._childs.length){if(Ga._parent===this){var Gc=this.getChildIndex(Ga);this._childs.splice(Gc,1),this._childs.splice(Gb,0,Ga),this.conchModel&&(this.conchModel.removeChild(Ga.conchModel),this.conchModel.addChildAt(Ga.conchModel,Gb)),this._childChanged()}else Ga.parent&&Ga.parent.removeChild(Ga),this._childs===Gg.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Gb,0,Ga),this.conchModel&&this.conchModel.addChildAt(Ga.conchModel,Gb),Ga.parent=this;return Ga}throw new Error("appendChildAt:The index is out of bounds")},Gb.getChildIndex=function(Ga){return this._childs.indexOf(Ga)},Gb.getChildByName=function(Ga){var Gb=this._childs;if(Gb)for(var Gc=0,Gd=Gb.length;Gc<Gd;Gc++){var Ge=Gb[Gc];if(Ge.name===Ga)return Ge}return null},Gb._get$P=function(Ga){return this._$P[Ga]},Gb._set$P=function(Ga,Gb){return this.destroyed||(this._$P===Gg.PROP_EMPTY&&(this._$P={}),this._$P[Ga]=Gb),Gb},Gb.getChildAt=function(Ga){return this._childs[Ga]},Gb.setChildIndex=function(Ga,Gb){var Gc=this._childs;if(Gb<0||Gb>=Gc.length)throw new Error("setChildIndex:The index is out of bounds.");var Gd=this.getChildIndex(Ga);if(Gd<0)throw new Error("setChildIndex:node is must child of this object.");return Gc.splice(Gd,1),Gc.splice(Gb,0,Ga),this.conchModel&&(this.conchModel.removeChild(Ga.conchModel),this.conchModel.addChildAt(Ga.conchModel,Gb)),this._childChanged(),Ga},Gb._childChanged=function(Ga){},Gb.removeChild=function(Ga){if(!this._childs)return Ga;var Gb=this._childs.indexOf(Ga);return this.removeChildAt(Gb)},Gb.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},Gb.removeChildByName=function(Ga){var Gb=this.getChildByName(Ga);return Gb&&this.removeChild(Gb),Gb},Gb.removeChildAt=function(Ga){var Gb=this.getChildAt(Ga);if(Gb){for(var Gc=this._childs.length-1,Gd=Ga;Gd<Gc;++Gd)this._childs[Gd]=this._childs[Gd+1];this._childs.length=Gc,this.conchModel&&this.conchModel.removeChild(Gb.conchModel),Gb.parent=null}return Gb},Gb.removeChildren=function(Ga,Gb){if(void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=2147483647),this._childs&&0<this._childs.length){var Gc=this._childs;if(0===Ga&&Gf<=Gb){var Gd=Gc;this._childs=Gg.ARRAY_EMPTY}else Gd=Gc.splice(Ga,Gb-Ga);for(var Ge=0,Gf=Gd.length;Ge<Gf;Ge++)Gd[Ge].parent=null,this.conchModel&&this.conchModel.removeChild(Gd[Ge].conchModel)}return this},Gb.replaceChild=function(Ga,Gb){var Gc=this._childs.indexOf(Gb);return-1<Gc?(this._childs.splice(Gc,1,Ga),this.conchModel&&(this.conchModel.removeChild(Gb.conchModel),this.conchModel.addChildAt(Ga.conchModel,Gc)),Gb.parent=null,Ga.parent=this,Ga):null},Gb._updateDisplayedInstage=function(){var Ga;Ga=this;var Gb=Gz.stage;for(this._displayedInStage=!1;Ga;){if(Ga._getBit(1)){this._displayedInStage=Ga._displayedInStage;break}if(Ga==Gb||Ga._displayedInStage){this._displayedInStage=!0;break}Ga=Ga.parent}},Gb._setDisplay=function(Ga){this._displayedInStage!==Ga&&((this._displayedInStage=Ga)?this.event("display"):this.event("undisplay"))},Gb._displayChild=function(Ga,Gb){var Gc=Ga._childs;if(Gc)for(var Gd=0;Gd<Gc.length;Gd++){var Ge=Gc[Gd];Ge&&Ge._getBit(1)&&(0<Ge._childs.length?this._displayChild(Ge,Gb):Ge._setDisplay(Gb))}Ga._setDisplay(Gb)},Gb.contains=function(Ga){if(Ga===this)return!0;for(;Ga;){if(Ga.parent===this)return!0;Ga=Ga.parent}return!1},Gb.timerLoop=function(Ga,Gb,Gc,Gd,Ge,Gf){void 0===Ge&&(Ge=!0),void 0===Gf&&(Gf=!1),this.timer.loop(Ga,Gb,Gc,Gd,Ge,Gf)},Gb.timerOnce=function(Ga,Gb,Gc,Gd,Ge){void 0===Ge&&(Ge=!0),this.timer._create(!1,!1,Ga,Gb,Gc,Gd,Ge)},Gb.frameLoop=function(Ga,Gb,Gc,Gd,Ge){void 0===Ge&&(Ge=!0),this.timer._create(!0,!0,Ga,Gb,Gc,Gd,Ge)},Gb.frameOnce=function(Ga,Gb,Gc,Gd,Ge){void 0===Ge&&(Ge=!0),this.timer._create(!0,!1,Ga,Gb,Gc,Gd,Ge)},Gb.clearTimer=function(Ga,Gb){this.timer.clear(Ga,Gb)},Gk(0,Gb,"numChildren",function(){return this._childs.length}),Gk(0,Gb,"destroyed",function(){return this._destroyed}),Gk(0,Gb,"parent",function(){return this._parent},function(Ga){this._parent!==Ga&&(Ga?(this._parent=Ga,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),Ga.displayedInStage&&this._displayChild(this,!0)),Ga._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=Ga))}),Gk(0,Gb,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),Gg.ARRAY_EMPTY=[],Gg.PROP_EMPTY={},Gg.NOTICE_DISPLAY=1,Gg.MOUSEENABLE=2,Gg}(),Gba=function(Ga){function Go(Ga){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,Go.__super.call(this),this._padding=Go._PADDING,this._spacing=Go._SPACING,this._aligns=Go._ALIGNS,this._font=Gp.EMPTY,this._ower=Ga}Gr(Go,"laya.display.css.CSSStyle",Ga);var Gb=Go.prototype;return Gb.destroy=function(){this._ower=null,this._font=null,this._rect=null},Gb.inherit=function(Ga){this._font=Ga._font,this._spacing=Ga._spacing===Go._SPACING?Go._SPACING:Ga._spacing.slice(),this.lineHeight=Ga.lineHeight},Gb._widthAuto=function(){return 0!=(262144&this._type)},Gb.widthed=function(Ga){return 0!=(8&this._type)},Gb._calculation=function(Ga,Gb){if(Gb.indexOf("%")<0)return!1;var Gd=this._ower,Ge=Gd.parent,Gf=this._rect;function Gg(Ga,Gb,Gc){return Ga*Gc[0]+Gb*Gc[1]+Gc[2]}function Gc(Ga){var Gb=Ge.width,Gc=Gd.width;Gf.width&&(Gd.width=Gg(Gb,Gc,Gf.width)),Gf.height&&(Gd.height=Gg(Gb,Gc,Gf.height)),Gf.left&&(Gd.x=Gg(Gb,Gc,Gf.left)),Gf.top&&(Gd.y=Gg(Gb,Gc,Gf.top))}null===Gf&&(Ge._getCSSStyle()._type|=524288,Ge.on("resize",this,Gc),this._rect=Gf={input:{}});var Gh=Gb.split(" ");return Gh[0]=parseFloat(Gh[0])/100,1==Gh.length?Gh[1]=Gh[2]=0:(Gh[1]=parseFloat(Gh[1])/100,Gh[2]=parseFloat(Gh[2])),Gf[Ga]=Gh,Gf.input[Ga]=Gb,Gc(),!0},Gb.heighted=function(Ga){return 0!=(8192&this._type)},Gb.size=function(Ga,Gb){var Gc=this._ower,Gd=!1;-1!==Ga&&Ga!=this._ower.width&&(this._type|=8,this._ower.width=Ga,Gd=!0),-1!==Gb&&Gb!=this._ower.height&&(this._type|=8192,this._ower.height=Gb,Gd=!0),Gd&&(Gc._layoutLater(),524288&this._type&&Gc.event("resize",this))},Gb._getAlign=function(){return this._aligns[0]},Gb._getValign=function(){return this._aligns[1]},Gb._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},Gb._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new Gp(this._font))},Gb.render=function(Ga,Gb,Gc,Gd){var Ge=Ga.width,Gf=Ga.height;Gc-=Ga.pivotX,Gd-=Ga.pivotY,this._bgground&&null!=this._bgground.color&&Gb.ctx.fillRect(Gc,Gd,Ge,Gf,this._bgground.color),this._border&&this._border.color&&Gb.drawRect(Gc,Gd,Ge,Gf,this._border.color.strColor,this._border.size)},Gb.getCSSStyle=function(){return this},Gb.cssText=function(Ga){this.attrs(Go.parseOneCSS(Ga,";"))},Gb.attrs=function(Ga){if(Ga)for(var Gb=0,Gc=Ga.length;Gb<Gc;Gb++){var Gd=Ga[Gb];this[Gd[0]]=Gd[1]}},Gb.setTransform=function(Ga){"none"===Ga?this._tf=Gh._TF_EMPTY:this.attrs(Go.parseOneCSS(Ga,","))},Gb.translate=function(Ga,Gb){this._tf===Gh._TF_EMPTY&&(this._tf=new Ge),this._tf.translateX=Ga,this._tf.translateY=Gb},Gb.scale=function(Ga,Gb){this._tf===Gh._TF_EMPTY&&(this._tf=new Ge),this._tf.scaleX=Ga,this._tf.scaleY=Gb},Gb._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},Gk(0,Gb,"block",Ga.prototype._$get_block,function(Ga){Ga?this._type|=1:this._type&=-2}),Gk(0,Gb,"valign",function(){return Go._valigndef[this._aligns[1]]},function(Ga){this._aligns===Go._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=Go._valigndef[Ga]}),Gk(0,Gb,"height",null,function(Ga){if(this._type|=8192,"string"==typeof Ga){if(this._calculation("height",Ga))return;Ga=parseInt(Ga)}this.size(-1,Ga)}),Gk(0,Gb,"width",null,function(Ga){if(this._type|=8,"string"==typeof Ga){var Gb=Ga.indexOf("auto");if(0<=Gb&&(this._type|=262144,Ga=Ga.substr(0,Gb)),this._calculation("width",Ga))return;Ga=parseInt(Ga)}this.size(Ga,-1)}),Gk(0,Gb,"fontWeight",function(){return this._font.weight},function(Ga){this._createFont().weight=Ga}),Gk(0,Gb,"left",null,function(Ga){var Gb=this._ower;if("string"==typeof Ga){if("center"===Ga?Ga="50% -50% 0":"right"===Ga&&(Ga="100% -100% 0"),this._calculation("left",Ga))return;Ga=parseInt(Ga)}Gb.x=Ga}),Gk(0,Gb,"_translate",null,function(Ga){this.translate(Ga[0],Ga[1])}),Gk(0,Gb,"absolute",function(){return 0!=(4&this._type)}),Gk(0,Gb,"top",null,function(Ga){var Gb=this._ower;if("string"==typeof Ga){if("middle"===Ga?Ga="50% -50% 0":"bottom"===Ga&&(Ga="100% -100% 0"),this._calculation("top",Ga))return;Ga=parseInt(Ga)}Gb.y=Ga}),Gk(0,Gb,"align",function(){return Go._aligndef[this._aligns[0]]},function(Ga){this._aligns===Go._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=Go._aligndef[Ga]}),Gk(0,Gb,"bold",function(){return this._font.bold},function(Ga){this._createFont().bold=Ga}),Gk(0,Gb,"padding",function(){return this._padding},function(Ga){this._padding=Ga}),Gk(0,Gb,"leading",function(){return this._spacing[1]},function(Ga){"string"==typeof Ga&&(Ga=parseInt(Ga+"")),this._spacing===Go._SPACING&&(this._spacing=[0,0]),this._spacing[1]=Ga}),Gk(0,Gb,"lineElement",function(){return 0!=(65536&this._type)},function(Ga){Ga?this._type|=65536:this._type&=-65537}),Gk(0,Gb,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(Ga){this.lineElement=!1,"right"===Ga?this._type|=32768:this._type&=-32769}),Gk(0,Gb,"textDecoration",function(){return this._font.decoration},function(Ga){this._createFont().decoration=Ga}),Gk(0,Gb,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(Ga){"nowrap"===Ga&&(this._type|=131072),"none"===Ga&&(this._type&=-131073)}),Gk(0,Gb,"background",null,function(Ga){Ga?(this._bgground||(this._bgground={}),this._bgground.color=Ga,this._ower.conchModel&&this._ower.conchModel.bgColor(Ga),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),Gk(0,Gb,"wordWrap",function(){return 0==(131072&this._type)},function(Ga){Ga?this._type&=-131073:this._type|=131072}),Gk(0,Gb,"color",function(){return this._font.color},function(Ga){this._createFont().color=Ga}),Gk(0,Gb,"password",function(){return this._font.password},function(Ga){this._createFont().password=Ga}),Gk(0,Gb,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(Ga){"none"===Ga?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=Ga),this._ower.conchModel&&this._ower.conchModel.bgColor(Ga),this._ower._renderType|=256}),Gk(0,Gb,"font",function(){return this._font.toString()},function(Ga){this._createFont().set(Ga)}),Gk(0,Gb,"weight",null,function(Ga){this._createFont().weight=Ga}),Gk(0,Gb,"letterSpacing",function(){return this._spacing[0]},function(Ga){"string"==typeof Ga&&(Ga=parseInt(Ga+"")),this._spacing===Go._SPACING&&(this._spacing=[0,0]),this._spacing[0]=Ga}),Gk(0,Gb,"fontSize",function(){return this._font.size},function(Ga){this._createFont().size=Ga}),Gk(0,Gb,"italic",function(){return this._font.italic},function(Ga){this._createFont().italic=Ga}),Gk(0,Gb,"fontFamily",function(){return this._font.family},function(Ga){this._createFont().family=Ga}),Gk(0,Gb,"stroke",function(){return this._font.stroke[0]},function(Ga){this._createFont().stroke===Gp._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=Ga}),Gk(0,Gb,"strokeColor",function(){return this._font.stroke[1]},function(Ga){this._createFont().stroke===Gp._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=Ga}),Gk(0,Gb,"border",function(){return this._border?this._border.value:""},function(Ga){if("none"!=Ga){this._border||(this._border={});var Gb=(this._border.value=Ga).split(" ");if(this._border.color=GS.create(Gb[Gb.length-1]),1==Gb.length)return this._border.size=1,void(this._border.type="solid");var Gc=0;0<Gb[0].indexOf("px")?(this._border.size=parseInt(Gb[0]),Gc++):this._border.size=1,this._border.type=Gb[Gc],this._ower._renderType|=256}else this._border=null}),Gk(0,Gb,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(Ga){Ga?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==Ga?null:GS.create(Ga),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),Gk(0,Gb,"position",function(){return 4&this._type?"absolute":""},function(Ga){"absolute"==Ga?this._type|=4:this._type&=-5}),Gk(0,Gb,"display",null,function(Ga){switch(Ga){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),Gk(0,Gb,"paddingLeft",function(){return this.padding[3]}),Gk(0,Gb,"paddingTop",function(){return this.padding[0]}),Gk(0,Gb,"_scale",null,function(Ga){this._ower.scale(Ga[0],Ga[1])}),Gk(0,Gb,"_rotate",null,function(Ga){this._ower.rotation=Ga}),Go.parseOneCSS=function(Ga,Gb){for(var Gc,Gd=[],Ge=Ga.split(Gb),Gf=0,Gg=Ge.length;Gf<Gg;Gf++){var Gh=Ge[Gf],Gi=Gh.indexOf(":"),Gj=Gh.substr(0,Gi).replace(/^\s+|\s+$/g,"");if(0!=Gj.length){var Gk=Gh.substr(Gi+1).replace(/^\s+|\s+$/g,""),Gl=[Gj,Gk];switch(Gj){case"italic":case"bold":Gl[1]="true"==Gk;break;case"line-height":Gl[0]="lineHeight",Gl[1]=parseInt(Gk);break;case"font-size":Gl[0]="fontSize",Gl[1]=parseInt(Gk);break;case"padding":1<(Gc=Gk.split(" ")).length||(Gc[1]=Gc[2]=Gc[3]=Gc[0]),Gl[1]=[parseInt(Gc[0]),parseInt(Gc[1]),parseInt(Gc[2]),parseInt(Gc[3])];break;case"rotate":Gl[0]="_rotate",Gl[1]=parseFloat(Gk);break;case"scale":Gc=Gk.split(" "),Gl[0]="_scale",Gl[1]=[parseFloat(Gc[0]),parseFloat(Gc[1])];break;case"translate":Gc=Gk.split(" "),Gl[0]="_translate",Gl[1]=[parseInt(Gc[0]),parseInt(Gc[1])];break;default:(Gl[0]=Go._CSSTOVALUE[Gj])||(Gl[0]=Gj)}Gd.push(Gl)}}return Gd},Go.parseCSS=function(Ga,Gb){for(var Gc;null!=(Gc=Go._parseCSSRegExp.exec(Ga));)Go.styleSheets[Gc[1]]=Go.parseOneCSS(Gc[2],";")},Go.EMPTY=new Go(null),Go._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},Go._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),Go._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},Go._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},Go.styleSheets={},Go.ALIGN_CENTER=1,Go.ALIGN_RIGHT=2,Go.VALIGN_MIDDLE=1,Go.VALIGN_BOTTOM=2,Go._CSS_BLOCK=1,Go._DISPLAY_NONE=2,Go._ABSOLUTE=4,Go._WIDTH_SET=8,Go._PADDING=[0,0,0,0],Go._RECT=[-1,-1,-1,-1],Go._SPACING=[0,0],Go._ALIGNS=[0,0,0],Go.ADDLAYOUTED=512,Go._NEWFONT=4096,Go._HEIGHT_SET=8192,Go._BACKGROUND_SET=16384,Go._FLOAT_RIGHT=32768,Go._LINE_ELEMENT=65536,Go._NOWARP=131072,Go._WIDTHAUTO=262144,Go._LISTERRESZIE=524288,Go}(Gh),Gca=function(Ga){function Gg(){this.url=null,this.audio=null,this.loaded=!1,Gg.__super.call(this)}Gr(Gg,"laya.media.h5audio.AudioSound",Gj);var Gb=Gg.prototype;return Gb.dispose=function(){var Ga=Gg._audioCache[this.url];Ga&&(Ga.src="",delete Gg._audioCache[this.url])},Gb.load=function(Ga){var Gb;if(Ga=GI.formatURL(Ga),(this.url=Ga)==GE._tMusic?(Gg._initMusicAudio(),(Gb=Gg._musicAudio).src!=Ga&&(Gg._audioCache[Gb.src]=null,Gb=null)):Gb=Gg._audioCache[Ga],Gb&&2<=Gb.readyState)this.event("complete");else{Gb||(Gb=Ga==GE._tMusic?(Gg._initMusicAudio(),Gg._musicAudio):GO.createElement("audio"),(Gg._audioCache[Ga]=Gb).src=Ga),Gb.addEventListener("canplaythrough",Gd),Gb.addEventListener("error",Ge);var Gc=this;(this.audio=Gb).load?Gb.load():Ge()}function Gd(){Gf(),Gc.loaded=!0,Gc.event("complete")}function Ge(){Gb.load=null,Gf(),Gc.event("error")}function Gf(){Gb.removeEventListener("canplaythrough",Gd),Gb.removeEventListener("error",Ge)}},Gb.play=function(Ga,Gb,Gc){if(void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),!this.url)return null;var Gd,Ge;if(!(Gd=this.url==GE._tMusic?Gg._musicAudio:Gg._audioCache[this.url]))return null;Ge=GW.getItem("audio:"+this.url),GJ.isConchApp?Ge||((Ge=GO.createElement("audio")).src=this.url):this.url==GE._tMusic?(Gg._initMusicAudio(),(Ge=Gg._musicAudio).src=this.url):Ge=Ge||Gd.cloneNode(!0);var Gf=new Goa(Ge);return Gf.url=this.url,Gf.loops=Gb,Gf.startTime=Ga,Gf.startHandler=Gc,Gf.play(!1),GE.addChannel(Gf),Gf},Gk(0,Gb,"duration",function(){var Ga;return(Ga=Gg._audioCache[this.url])?Ga.duration:0}),Gg._initMusicAudio=function(){Gg._musicAudio||(Gg._musicAudio||(Gg._musicAudio=GO.createElement("audio")),GJ.isConchApp||GO.document.addEventListener("mousedown",Gg._makeMusicOK))},Gg._makeMusicOK=function(){GO.document.removeEventListener("mousedown",Gg._makeMusicOK),Gg._musicAudio.src?Gg._musicAudio.play():(Gg._musicAudio.src="",Gg._musicAudio.load())},Gg._audioCache={},Gg._musicAudio=null,Gg}(),Gda=function(Ga){function Gb(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,Gb.__super.call(this)}Gr(Gb,"laya.media.SoundChannel",Gj);var Gc=Gb.prototype;return Gc.play=function(){},Gc.stop=function(){},Gc.pause=function(){},Gc.resume=function(){},Gc.__runComplete=function(Ga){Ga&&Ga.run()},Gk(0,Gc,"volume",function(){return 1},function(Ga){}),Gk(0,Gc,"position",function(){return 0}),Gk(0,Gc,"duration",function(){return 0}),Gb}(),Gea=function(Ga){function Gb(){Gb.__super.call(this)}Gr(Gb,"laya.media.Sound",Gj);var Gc=Gb.prototype;return Gc.load=function(Ga){},Gc.play=function(Ga,Gb,Gc){return void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),null},Gc.dispose=function(){},Gk(0,Gc,"duration",function(){return 0}),Gb}(),Gfa=function(Ga){function Ge(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,Ge.__super.call(this)}Gr(Ge,"laya.media.webaudio.WebAudioSound",Gj);var Gb=Ge.prototype;return Gb.load=function(Ga){this.url=Ga,this.audioBuffer=Ge._dataCache[Ga],this.audioBuffer?this._loaded(this.audioBuffer):(Ge.e.on("loaded:"+Ga,this,this._loaded),Ge.e.on("err:"+Ga,this,this._err),Ge.__loadingSound[Ga]||(Ge.__loadingSound[Ga]=!0,Gz.loader.load(Ga,Gu.create(this,this.onloaded),null,Gha.BUFFER,4,!1,null,!0)))},Gb.onloaded=function(Ga){Ga||this._err(),this._disposed?this._removeLoadEvents():(this.data=Ga,Ge.buffs.push({buffer:this.data,url:this.url}),Ge.decode())},Gb._err=function(){if(this._removeLoadEvents(),Ge.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var Ga,Gb,Gc,Gd=0;for(Ga=(Gb=this.__toPlays).length,Gd=0;Gd<Ga;Gd++)(Gc=Gb[Gd])[3]&&!Gc[3].isStopped&&Gc[3].event("error");this.__toPlays.length=0}},Gb._loaded=function(Ga){this._removeLoadEvents(),this._disposed||(this.audioBuffer=Ga,this.loaded=!0,this.event("complete"))},Gb._removeLoadEvents=function(){Ge.e.off("loaded:"+this.url,this,this._loaded),Ge.e.off("err:"+this.url,this,this._err)},Gb.__playAfterLoaded=function(){if(this.__toPlays){var Ga,Gb,Gc,Gd=0;for(Ga=(Gb=this.__toPlays).length,Gd=0;Gd<Ga;Gd++)(Gc=Gb[Gd])[3]&&!Gc[3].isStopped&&this.play(Gc[0],Gc[1],Gc[2],Gc[3]);this.__toPlays.length=0}},Gb.play=function(Ga,Gb,Gc,Gd){return void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),Gd=Gd||new Gpa,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([Ga,Gb,Gc,Gd]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),Gd.url=this.url,Gd.loops=Gb,Gd.audioBuffer=this.audioBuffer,Gd.startTime=Ga,Gd.startHandler=Gc,Gd.play(!1),GE.addChannel(Gd),Gd},Gb.dispose=function(){this._disposed=!0,delete Ge._dataCache[this.url],delete Ge.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},Gk(0,Gb,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),Ge.decode=function(){if(!(Ge.buffs.length<=0||Ge.isDecoding))if(Ge.isDecoding=!0,(Ge.tInfo=Ge.buffs.shift())&&Ge.tInfo.buffer&&Ge.tInfo.buffer.byteLength)try{Ge.ctx.decodeAudioData(Ge.tInfo.buffer,Ge._done,Ge._fail)}catch(Ga){console.error("decodeAudioData error  byteLength:"+Ge.tInfo.buffer.byteLength+"  url:"+Ge.tInfo.url)}else Ge._fail()},Ge._done=function(Ga){Ge.e.event("loaded:"+Ge.tInfo.url,Ga),Ge._dataCache[Ge.tInfo.url]=Ga,Ge.isDecoding=!1,Ge.decode()},Ge._fail=function(){Ge.e.event("err:"+Ge.tInfo.url,null),Ge.isDecoding=!1,Ge.decode()},Ge._playEmptySound=function(){if(null!=Ge.ctx){if(Ge._emptySource&&(Ge._emptySource.stop(),Ge._emptySource.disconnect(0),!Gpa._tryCleanFailed))try{Ge._emptySource.buffer=null}catch(Ga){Gpa._tryCleanFailed=!0}var Ga=Ge.ctx.createBufferSource();Ga.buffer=Ge._miniBuffer,Ga.connect(Ge.ctx.destination),Ga.start(0,0,0),Ge._emptySource=Ga}},Ge._unlock=function(){Ge._unlocked||(Ge._playEmptySound(),"running"==Ge.ctx.state?(GO.document.removeEventListener("mousedown",Ge._unlock,!0),GO.document.removeEventListener("touchend",Ge._unlock,!0),GO.document.removeEventListener("touchstart",Ge._unlock,!0),Ge._unlocked=!0):"suspended"==Ge.ctx.state&&GE._recoverWebAudio())},Ge.initWebAudio=function(){"running"!=Ge.ctx.state&&(Ge._unlock(),GO.document.addEventListener("mousedown",Ge._unlock,!0),GO.document.addEventListener("touchend",Ge._unlock,!0),GO.document.addEventListener("touchstart",Ge._unlock,!0))},Ge._emptySource=null,Ge._dataCache={},Ge.buffs=[],Ge.isDecoding=!1,Ge._unlocked=!1,Ge.tInfo=null,Ge.__loadingSound={},Gi(Ge,["window",function(){return this.window=GO.window},"webAudioEnabled",function(){return this.webAudioEnabled=Ge.window.AudioContext||Ge.window.webkitAudioContext||Ge.window.mozAudioContext},"ctx",function(){return this.ctx=Ge.webAudioEnabled?new(Ge.window.AudioContext||Ge.window.webkitAudioContext||Ge.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=Ge.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new Gj}]),Ge}(),Gga=function(Ga){function Gb(){this._responseType=null,this._data=null,Gb.__super.call(this),this._http=new GO.window.XMLHttpRequest}Gr(Gb,"laya.net.HttpRequest",Gj);var Gc=Gb.prototype;return Gc.send=function(Ga,Gb,Gc,Gd,Ge){void 0===Gc&&(Gc="get"),void 0===Gd&&(Gd="text"),this._responseType=Gd,this._data=null;var Gf=this,Gg=this._http;if(Gg.open(Gc,Ga,!0),Ge)for(var Gh=0;Gh<Ge.length;Gh++)Gg.setRequestHeader(Ge[Gh++],Ge[Gh]);else GJ.isConchApp||(Gb&&"string"!=typeof Gb?Gg.setRequestHeader("Content-Type","application/json"):Gg.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));Gg.responseType="arraybuffer"!==Gd?"text":"arraybuffer",Gg.onerror=function(Ga){Gf._onError(Ga)},Gg.onabort=function(Ga){Gf._onAbort(Ga)},Gg.onprogress=function(Ga){Gf._onProgress(Ga)},Gg.onload=function(Ga){Gf._onLoad(Ga)},Gg.send(Gb)},Gc._onProgress=function(Ga){Ga&&Ga.lengthComputable&&this.event("progress",Ga.loaded/Ga.total)},Gc._onAbort=function(Ga){this.error("Request was aborted by user")},Gc._onError=function(Ga){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},Gc._onLoad=function(Ga){var Gb=this._http,Gc=void 0!==Gb.status?Gb.status:200;200===Gc||204===Gc||0===Gc?this.complete():this.error("["+Gb.status+"]"+Gb.statusText+":"+Gb.responseURL)},Gc.error=function(Ga){this.clear(),this.event("error",Ga)},Gc.complete=function(){this.clear();var Gb=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=G$.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(Ga){Gb=!1,this.error(Ga.message)}Gb&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},Gc.clear=function(){var Ga=this._http;Ga.onerror=Ga.onabort=Ga.onprogress=Ga.onload=null},Gk(0,Gc,"url",function(){return this._http.responseURL}),Gk(0,Gc,"http",function(){return this._http}),Gk(0,Gc,"data",function(){return this._data}),Gb}(),Gha=function(Ga){function GC(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,GC.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}Gr(GC,"laya.net.Loader",Gj);var Gb=GC.prototype;return Gb.load=function(Ga,Gb,Gc,Gd,Ge){if(Ga&&""!=Ga||console.error("Loader 加载的url不合法 "+Ga),void 0===Gc&&(Gc=!0),void 0===Ge&&(Ge=!1),0===(this._url=Ga).indexOf("data:image")?this._type=Gb="image":this._type=Gb||(Gb=this.getTypeFromUrl(Ga)),this._cache=Gc,this._data=null,!Ge&&GC.loadedMap[Ga])return this._data=GC.loadedMap[Ga],this.event("progress",1),void this.event("complete",this._data);if(Gd&&GC.setGroup(Ga,Gd),null!=GC.parserMap[Gb])return this._customParse=!0,void(GC.parserMap[Gb]instanceof laya.utils.Handler?GC.parserMap[Gb].runWith(this):GC.parserMap[Gb].call(null,this));if("image"===Gb||"htmlimage"===Gb||"nativeimage"===Gb)return this._loadImage(Ga);if("ttf"===Gb)return this._loadTTF(Ga);switch(Gb){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:Gb}GC.preLoadedMap[Ga]?this.onLoaded(GC.preLoadedMap[Ga]):Gg.resMgrLoad(Ga,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},Gb.getTypeFromUrl=function(Ga){var Gb=G$.getFileExtension(Ga);return Gb?GC.typeMap[Gb]:(console.warn("Not recognize the resources suffix",Ga),"text")},Gb._loadTTF=function(Ga){Ga=GI.formatURL(Ga);var Gb=new GH;Gb.complete=Gu.create(this,this.onLoaded),Gb.load(Ga)},Gb._loadImage=function(Ga){Gg.imgMgrLoad(Ga,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},Gb._loadImageComplete=function(Ga,Gb,Gc){if(null!=Gc)if(Gc instanceof ArrayBuffer){var Gd=new DataView(Gc),Ge=new laya.webgl.resource.WebGLImage(new Uint8Array(Gc,8),Ga,0,!1,Gd.getUint32(0),Gd.getUint32(4));this.onLoaded(Ge)}else if(Gc instanceof Gka)GC.imgMgrSet[Ga]=Gb,Gg.imgMgrLock(Ga,GC.imgMgrSet[Ga]),this._url=Ga,this.complete(Gc);else{var Gf=-1!=Ga.indexOf(".png",Ga.length-4)?6408:6407;Ge=new laya.webgl.resource.WebGLImage(Gc,Ga,Gf,!1,Gc.width,Gc.height);this.onLoaded(Ge)}else this.event("error","Load image failed")},Gb._loadSound=function(Ga){var Gb=new GE._soundClass,Gc=this;function Gd(){Gb.offAll()}Gb.on("complete",this,function(){Gd(),Gc.onLoaded(Gb)}),Gb.on("error",this,function(){Gd(),Gb.dispose(),Gc.event("error","Load sound failed")}),Gb.load(Ga)},Gb.onProgress=function(Ga){"atlas"===this._type?this.event("progress",.3*Ga):this.event("progress",Ga)},Gb.onError=function(Ga){this.event("error",Ga)},Gb._loadedComplete=function(Ga,Gb,Gc){if(null!=Gc)switch(this._type){case"atlas":case"plf":case"json":var Gd=new GP(Gc);this.onLoaded(JSON.parse(Gd.readUTFBytes()));break;case"font":Gd=new GP(Gc);this.onLoaded(G$.parseXMLFromString(Gd.readUTFBytes()));break;default:this.onLoaded(Gc)}else this.event("error",Ga)},Gb.onLoaded=function(Ga){var Gb=this._type;if("plf"==Gb)this.parsePLFData(Ga),this.complete(Ga);else if("image"===Gb){var Gc=new Gka(Ga);Gc.url=this._url,this.complete(Gc)}else if("sound"===Gb||"htmlimage"===Gb||"nativeimage"===Gb)this.complete(Ga);else if("atlas"===Gb){if(!Ga.src&&!Ga._setContext){if(!this._data){if((this._data=Ga).meta&&Ga.meta.image)for(var Gd=Ga.meta.image.split(","),Ge=0<=this._url.indexOf("/")?"/":"\\",Gf=this._url.lastIndexOf(Ge),Gg=0<=Gf?this._url.substr(0,Gf+1):"",Gh=0,Gi=Gd.length;Gh<Gi;Gh++)Gd[Gh]=Gg+Gd[Gh];else Gd=[this._url.replace(".json",".png")];Gd.reverse(),Ga.toLoads=Gd,Ga.pics=[]}return this.event("progress",.3+1/Gd.length*.6),this._loadImage(Gd.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(Ga),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var Gj=this._data.frames,Gk=this._url.split("?")[0],Gl=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:Gk.substring(0,Gk.lastIndexOf("."))+"/",Go=this._data.pics,Gp=GI.formatURL(this._url),Gq=GC.atlasMap[Gp]||(GC.atlasMap[Gp]=[]);Gq.dir=Gl;var Gr=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var Gs in Gr=parseFloat(this._data.meta.scale),Gj){var Gt,Gu=Gj[Gs],Gv=Go[Gu.frame.idx?Gu.frame.idx:0],Gw=GI.formatURL(Gl+Gs);Gv.scaleRate=Gr,Gt=Gka.create(Gv,Gu.frame.x,Gu.frame.y,Gu.frame.w,Gu.frame.h,Gu.spriteSourceSize.x,Gu.spriteSourceSize.y,Gu.sourceSize.w,Gu.sourceSize.h),GC.cacheRes(Gw,Gt),GC.keepCache(this._url,Gl+Gs),Gt.url=Gw,Gq.push(Gw)}else for(Gs in Gj)Gv=Go[(Gu=Gj[Gs]).frame.idx?Gu.frame.idx:0],Gw=GI.formatURL(Gl+Gs),GC.cacheRes(Gw,Gka.create(Gv,Gu.frame.x,Gu.frame.y,Gu.frame.w,Gu.frame.h,Gu.spriteSourceSize.x,Gu.spriteSourceSize.y,Gu.sourceSize.w,Gu.sourceSize.h)),GC.loadedMap[Gw].url=Gw,GC.keepCache(this._url,Gl+Gs),Gq.push(Gw);delete this._data.pics,this.complete(this._data)}else if("font"==Gb){if(!Ga.src)return this._data=Ga,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var Gx=new GD;Gx.parseFont(this._data,Ga);var Gy=this._url.split(".fnt")[0].split("/"),Gz=Gy[Gy.length-1];Gsa.registerBitmapFont(Gz,Gx),this._data=Gx,this.complete(this._data)}else if("pkm"==Gb){var GA=Gya.create(Ga,this._url),GB=new Gka(GA);GB.url=this._url,this.complete(GB)}else this.complete(Ga)},Gb.parsePLFData=function(Ga){var Gb,Gc,Gd;for(Gb in Ga)switch(Gd=Ga[Gb],Gb){case"json":case"text":for(Gc in Gd)GC.preLoadedMap[GI.formatURL(Gc)]=Gd[Gc];break;default:for(Gc in Gd)GC.preLoadedMap[GI.formatURL(Gc)]=Gd[Gc]}},Gb.complete=function(Ga){this._data=Ga,this._customParse?this.event("loaded",Ga instanceof Array?[Ga]:Ga):(GC._loaders.push(this),GC._isWorking||GC.checkNext())},Gb.endLoad=function(Ga){Ga&&(this._data=Ga),this._cache&&GC.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},Gk(0,Gb,"url",function(){return this._url}),Gk(0,Gb,"data",function(){return this._data}),Gk(0,Gb,"cache",function(){return this._cache}),Gk(0,Gb,"type",function(){return this._type}),GC.checkNext=function(){GC._isWorking=!0;for(var Ga=GO.now();GC._startIndex<GC._loaders.length;)if(GO.now(),GC._loaders[GC._startIndex].endLoad(),GC._startIndex++,GO.now()-Ga>GC.maxTimeOut)return console.warn("loader callback cost a long time:"+(GO.now()-Ga)+" url="+GC._loaders[GC._startIndex-1].url),void Gz.timer.frameOnce(1,null,GC.checkNext);GC._loaders.length=0,GC._startIndex=0,GC._isWorking=!1},GC.clearRes=function(Ga,Gb){if(null!=Ga){void 0===Gb&&(Gb=!1),Ga=GI.formatURL(Ga);var Gc=GC.getAtlas(Ga);if(Gc){for(var Gd=0,Ge=Gc.length;Gd<Ge;Gd++){var Gf=Gc[Gd],Gg=GC.getRes(Gf);delete GC.loadedMap[Gf],GC.clearCache(Ga.substring(GI.basePath.length),Gf.substring(GI.basePath.length)),Gg&&Gg.destroy(Gb)}Gc.length=0,delete GC.atlasMap[Ga],delete GC.loadedMap[Ga]}else{var Gh=GC.loadedMap[Ga];Gh&&(delete GC.loadedMap[Ga],Gh instanceof laya.resource.Texture&&Gh.bitmap&&Gh.destroy(Gb))}}},GC.clearTextureRes=function(Ga){Ga=GI.formatURL(Ga);var Gb=laya.net.Loader.getAtlas(Ga),Gc=Gb&&0<Gb.length?laya.net.Loader.getRes(Gb[0]):laya.net.Loader.getRes(Ga);Gc&&Gc.bitmap&&(GJ.isConchApp&&!GJ.isConchWebGL?Gc.bitmap.source.releaseTexture&&Gc.bitmap.source.releaseTexture():null==Gc.bitmap._atlaser&&Gc.bitmap.releaseResource(!0))},GC.getRes=function(Ga){return GC.loadedMap[GI.formatURL(Ga)]},GC.getAtlas=function(Ga){return GC.atlasMap[GI.formatURL(Ga)]},GC.cacheRes=function(Ga,Gb){Ga=GI.formatURL(Ga),null!=GC.loadedMap[Ga]?console.warn("Resources already exist,is repeated loading:",Ga):GC.loadedMap[Ga]=Gb},GC.setGroup=function(Ga,Gb){GC.groupMap[Gb]||(GC.groupMap[Gb]=[]),GC.groupMap[Gb].push(Ga)},GC.clearResByGroup=function(Ga){if(GC.groupMap[Ga]){var Gb=GC.groupMap[Ga],Gc=0,Gd=Gb.length;for(Gc=0;Gc<Gd;Gc++)GC.clearRes(Gb[Gc]);Gb.length=0}},GC.keepCache=function(Ga,Gb){if(Ga&&Gb){var Gc=GC.cacheSet[Gb];Gc?-1==Gc.indexOf(Ga)&&Gc.push(Ga):GC.cacheSet[Gb]=[Ga]}},GC.clearCache=function(Ga,Gb){if(Ga&&Gb){var Gc=GC.cacheSet[Gb];if(Gc){var Gd=Gc.indexOf(Ga);if(-1!==Gd){var Ge=Gc.length-1;0==Ge?(delete GC.cacheSet[Gb],0<GC.imgMgrSet[Gb]?Gg.imgMgrFree(Gb,GC.imgMgrSet[Gb]):GC.clearRes(Gb,!0)):(Gc[Gd]=Gc[Ge],Gc.length=Ge)}}}},GC.saveObject=function(Ga,Gb,Gc){if(Gb&&Ga){var Gd=GC.objectSet[Ga];Gd?(console.warn("Loader.saveObject: "+Ga),Gd[0]=Gb,Gd[1]=Gc):GC.objectSet[Ga]=[Gb,Gc,[]]}},GC.findObject=function(Ga){if(Ga){var Gb=GC.objectSet[Ga];if(Gb)return Gb[0]}return null},GC.keepObject=function(Ga,Gb){if(Ga&&Gb){var Gc=GC.objectSet[Gb];Gc&&-1===Gc[2].indexOf(Ga)&&Gc[2].push(Ga)}},GC.clearObject=function(Ga,Gb){if(Ga&&Gb){var Gc=GC.objectSet[Gb];if(Gc){var Gd=Gc[2],Ge=Gd.indexOf(Ga);if(-1!==Ge){var Gf=Gd.length-1;0==Gf?(delete GC.objectSet[Gb],Gc[1]&&Gc[1].call(null,Gc[0])):(Gd[Ge]=Gd[Gf],Gd.length=Gf)}}}},GC.TEXT="text",GC.JSON="json",GC.XML="xml",GC.BUFFER="arraybuffer",GC.IMAGE="image",GC.SOUND="sound",GC.ATLAS="atlas",GC.FONT="font",GC.TTF="ttf",GC.PLF="plf",GC.PKM="pkm",GC.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},GC.parserMap={},GC.groupMap={},GC.maxTimeOut=100,GC.loadedMap={},GC.preLoadedMap={},GC.atlasMap={},GC._loaders=[],GC._isWorking=!1,GC._startIndex=0,GC.imgCache={},GC.cacheSet={},GC.objectSet={},GC.imgMgrSet={},GC}(),Gia=function(Ga){var Go;function Gp(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},Gp.__super.call(this);for(var Ga=0;Ga<this._maxPriority;Ga++)this._resInfos[Ga]=[]}Gr(Gp,"laya.net.LoaderManager",Gj);var Gb=Gp.prototype;return Gb.create=function(Ga,Gc,Gb,Gd,Ge,Gf,Gg,Gh){if(null==Gf&&(Gf=2),null==Gg&&(Gg=!0),Ga instanceof Array){var Gi=Ga,Gj=Gi.length,Gk=0;if(Gb)var Gl=Gu.create(Gb.caller,Gb.method,Gb.args,!1);for(var Go=0;Go<Gj;Go++){var Gp=Gi[Go];"string"==typeof Gp&&(Gp=Gi[Go]={url:Gp}),Gp.progress=0}for(Go=0;Go<Gj;Go++){Gp=Gi[Go];var Gq=Gb?Gu.create(null,Gt,[Gp],!1):null,Gr=Gb||Gc?Gu.create(null,Gs,[Gp]):null;this._create(Gp.url,Gr,Gq,Gp.clas||Gd,Gp.params||Ge,null!=Gp.priority&&0<=Gp.priority?Gp.priority:Gf,Gg,Gp.group||Gh)}function Gs(Ga,Gb){Gk++,Ga.progress=1,Gk===Gj&&Gc&&Gc.run()}function Gt(Ga,Gb){Ga.progress=Gb;for(var Gc=0,Gd=0;Gd<Gj;Gd++){Gc+=Gi[Gd].progress}var Ge=Gc/Gj;Gl.runWith(Ge)}return!0}return this._create(Ga,Gc,Gb,Gd,Ge,Gf,Gg,Gh)},Gb._create=function(Gb,Gc,Ga,Gd,Ge,Gf,Gg,Gh){Gb&&""!=Gb||console.error("加载的url不合法 "+Gb),null==Gf&&(Gf=2),null==Gg&&(Gg=!0);var Gi=GI.formatURL(Gb),Gj=this.getRes(Gi);if(Gj)!Gj.hasOwnProperty("loaded")||Gj.loaded?(Ga&&Ga.runWith(1),Gc&&Gc.run()):Gc&&Gz.loader._createListener(Gb,Gc.caller,Gc.method,Gc.args,!0,!1);else{var Gk=G$.getFileExtension(Gb),Gl=Gp.createMap[Gk];if(!Gl)throw new Error("LoaderManager:unknown file("+Gb+") extension with: "+Gk+".");Gd||(Gd=Gl[0]);var Go=Gl[1];if("atlas"==Gk)this.load(Gb,Gc,Ga,Go,Gf,Gg);else{Gd===Gka&&(Go="htmlimage"),(Gj=Gd?new Gd:null).hasOwnProperty("_loaded")&&(Gj._loaded=!1),Gj._setUrl(Gb),Gh&&Gj._setGroup(Gh),this._createLoad(Gj,Gb,Gu.create(null,function(Ga){Gj&&!Gj.destroyed&&Ga&&Gj.onAsynLoaded.call(Gj,Gb,Ga,Ge),Gc&&Gc.run();Gz.loader.event(Gb)}),Ga,Go,Gf,!1,Gh,!0),Gg&&this.cacheRes(Gi,Gj)}}return Gj},Gb.load=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){Ga&&""!=Ga||console.error("加载的url不合法 "+Ga);var Gi=this;if(null==Ge&&(Ge=2),null==Gf&&(Gf=!0),void 0===Gh&&(Gh=!1),Ga instanceof Array)return this._loadAssets(Ga,Gb,Gc,Gd,Ge,Gf,Gg);var Gj=Gha.getRes(Ga);if(null!=Gj)Gz.timer.frameOnce(1,null,function(){Gc&&Gc.runWith(1),Gb&&Gb.runWith(Gj),Gi._loaderCount||Gi.event("complete")});else{var Gk=Gp._resMap[Ga];Gk?(Gb&&Gk._createListener("complete",Gb.caller,Gb.method,Gb.args,!1,!1),Gc&&Gk._createListener("progress",Gc.caller,Gc.method,Gc.args,!1,!1)):((Gk=this._infoPool.length?this._infoPool.pop():new Go).url=Ga,Gk.type=Gd,Gk.cache=Gf,Gk.group=Gg,Gk.ignoreCache=Gh,Gk.priority=Ge,Gb&&Gk.on("complete",Gb.caller,Gb.method,Gb.args),Gc&&Gk.on("progress",Gc.caller,Gc.method,Gc.args),Gp._resMap[Ga]=Gk,Ge=Ge<this._maxPriority?0<=Ge?Ge:0:this._maxPriority-1,this._resInfos[Ge].push(Gk),this._next())}return this},Gb._createLoad=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){var Gj=this;if(null==Gf&&(Gf=2),null==Gg&&(Gg=!0),void 0===Gi&&(Gi=!1),Gb instanceof Array)return this._loadAssets(Gb,Gc,Gd,Ge,Gf,Gg,Gh);var Gk=Gha.getRes(Gb);if(null!=Gk)Gz.timer.frameOnce(1,null,function(){Gd&&Gd.runWith(1),Gc&&Gc.runWith(Gk),Gj._loaderCount||Gj.event("complete")});else{var Gl=Gp._resMap[Gb];Gl?(Gc&&Gl._createListener("complete",Gc.caller,Gc.method,Gc.args,!1,!1),Gd&&Gl._createListener("progress",Gd.caller,Gd.method,Gd.args,!1,!1)):((Gl=this._infoPool.length?this._infoPool.pop():new Go).url=Gb,Gl.clas=Ga,Gl.type=Ge,Gl.cache=Gg,Gl.group=Gh,Gl.ignoreCache=Gi,Gl.priority=Gf,Gc&&Gl.on("complete",Gc.caller,Gc.method,Gc.args),Gd&&Gl.on("progress",Gd.caller,Gd.method,Gd.args),Gp._resMap[Gb]=Gl,Gf=Gf<this._maxPriority?0<=Gf?Gf:0:this._maxPriority-1,this._resInfos[Gf].push(Gl),this._next())}return this},Gb._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var Ga=0;Ga<this._maxPriority;Ga++)for(var Gb=this._resInfos[Ga];0<Gb.length;){var Gc=Gb.shift();if(Gc)return this._doLoad(Gc)}this._loaderCount||this.event("complete")}},Gb._doLoad=function(Gb){this._loaderCount++;var Gc=this._loaders.length?this._loaders.pop():new Gha;Gc.on("complete",null,Ge),Gc.on("progress",null,function(Ga){Gb.event("progress",Ga)}),Gc.on("error",null,function(Ga){Ge(null)});var Gd=this;function Ge(Ga){Gc.offAll(),Gc._data=null,Gc._customParse=!1,Gd._loaders.push(Gc),Gd._endLoad(Gb,Ga instanceof Array?[Ga]:Ga),Gd._loaderCount--,Gd._next()}Gc._class=Gb.clas,1<=Gb.priority?(Gc.priority=Gb.priority,Gc.realTime=!1):(Gc.priority=0,Gc.realTime=!0),Gc.load(Gb.url,Gb.type,Gb.cache,Gb.group,Gb.ignoreCache)},Gb._endLoad=function(Ga,Gb){var Gc=Ga.url;if(null==Gb){var Gd=this._failRes[Gc]||0;if(Gd<this.retryNum)return console.warn("[warn]Retry to load:",Gc),this._failRes[Gc]=Gd+1,void Gz.timer.once(this.retryDelay,this,this._addReTry,[Ga],!1);console.warn("[error]Failed to load:",Gc),this.event("error",Gc)}this._failRes[Gc]&&(this._failRes[Gc]=0),delete Gp._resMap[Gc],Ga.event("complete",Gb),Ga.offAll(),this._infoPool.push(Ga)},Gb._addReTry=function(Ga){this._resInfos[this._maxPriority-1].push(Ga),this._next()},Gb.clearRes=function(Ga,Gb){void 0===Gb&&(Gb=!1),Gha.clearRes(Ga,Gb)},Gb.getRes=function(Ga){return Gha.getRes(Ga)},Gb.cacheRes=function(Ga,Gb){Gha.cacheRes(Ga,Gb)},Gb.clearTextureRes=function(Ga){Gha.clearTextureRes(Ga)},Gb.setGroup=function(Ga,Gb){Gha.setGroup(Ga,Gb)},Gb.clearResByGroup=function(Ga){Gha.clearResByGroup(Ga)},Gb.clearUnLoaded=function(){for(var Ga=0;Ga<this._maxPriority;Ga++){for(var Gb=this._resInfos[Ga],Gc=Gb.length-1;-1<Gc;Gc--){var Gd=Gb[Gc];Gd&&(Gd.offAll(),this._infoPool.push(Gd))}Gb.length=0}this._loaderCount=0,Gp._resMap={}},Gb.cancelLoadByUrls=function(Ga){if(Ga)for(var Gb=0,Gc=Ga.length;Gb<Gc;Gb++)this.cancelLoadByUrl(Ga[Gb])},Gb.cancelLoadByUrl=function(Ga){for(var Gb=0;Gb<this._maxPriority;Gb++)for(var Gc=this._resInfos[Gb],Gd=Gc.length-1;-1<Gd;Gd--){var Ge=Gc[Gd];Ge&&Ge.url===Ga&&(Gc[Gd]=null,Ge.offAll(),this._infoPool.push(Ge))}Gp._resMap[Ga]&&delete Gp._resMap[Ga]},Gb._loadAssets=function(Ga,Gc,Gg,Gb,Gd,Ge,Gf){null==Gd&&(Gd=2),null==Ge&&(Ge=!0);for(var Gh=Ga.length,Gi=0,Gj=0,Gk=[],Gl=!0,Go=0;Go<Gh;Go++){var Gp=Ga[Go];if(!Gp)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+Ga);"string"==typeof Gp&&(Gp={url:Gp,type:Gb,size:1,priority:Gd}),Gp.size||(Gp.size=1),Gp.progress=0,Gj+=Gp.size,Gk.push(Gp);var Gq=Gg?Gu.create(null,Gt,[Gp],!1):null,Gr=Gc||Gg?Gu.create(null,Gs,[Gp]):null;this.load(Gp.url,Gr,Gq,Gp.type,null!=Gp.priority&&0<=Gp.priority?Gp.priority:2,Ge,Gp.group||Gf)}function Gs(Ga,Gb){Gi++,Ga.progress=1,Gb||(Gl=!1),Gi===Gh&&Gc&&Gc.runWith(Gl)}function Gt(Ga,Gb){if(null!=Gg){Ga.progress=Gb;for(var Gc=0,Gd=0;Gd<Gk.length;Gd++){var Ge=Gk[Gd];Gc+=Ge.size*Ge.progress}var Gf=Gc/Gj;Gg.runWith(Gf)}}return this},Gp.cacheRes=function(Ga,Gb){Gha.cacheRes(Ga,Gb)},Gp._resMap={},Gi(Gp,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),Gp.__init$=function(){Go=function(Ga){function Gb(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,Gb.__super.call(this)}return Gr(Gb,"",Gj),Gb}()},Gp}(),Gja=(function(Ga){function Ge(Ga){Ge.__super.call(this),Ga||(Ga=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var Gb=0,Gc=0,Gd=0;Gd<20;Gd++)Gd%5!=4?this._mat[Gb++]=Ga[Gd]:this._alpha[Gc++]=Ga[Gd];this._action=GF.createFilterAction(32),this._action.data=this}Gr(Ge,"laya.filters.ColorFilter",Gt);var Gb=Ge.prototype;Gz.imps(Gb,{"laya.filters.IFilter":!0}),Gb.callNative=function(Ga){Ga._$P.cf=this;Ga.conchModel&&Ga.conchModel.setFilterMatrix&&Ga.conchModel.setFilterMatrix(this._mat,this._alpha)},Gk(0,Gb,"type",function(){return 32}),Gk(0,Gb,"action",function(){return this._action})}(),function(Ga){function Gd(Ga,Gb,Gc){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===Gb&&(Gb=0),Gd.__super.call(this),this._byteClass=Gc||GP,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,Ga&&0<Gb&&Gb<65535&&this.connect(Ga,Gb)}Gr(Gd,"laya.net.Socket",Gj);var Gb=Gd.prototype;Gb.connect=function(Ga,Gb){var Gc="ws://"+Ga+":"+Gb;Gc="https:"==GO.window.location.protocol?"wss://"+Ga+":"+Gb:"ws://"+Ga+":"+Gb,this.connectByUrl(Gc)},Gb.connectByUrl=function(Ga){var Gb=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new GO.window.WebSocket(Ga,this.protocols):this._socket=new GO.window.WebSocket(Ga),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(Ga){Gb._onOpen(Ga)},this._socket.onmessage=function(Ga){Gb._onMessage(Ga)},this._socket.onclose=function(Ga){Gb._onClose(Ga)},this._socket.onerror=function(Ga){Gb._onError(Ga)}},Gb.cleanSocket=function(){try{this._socket.close()}catch(Ga){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},Gb.close=function(){if(null!=this._socket)try{this._socket.close()}catch(Ga){}},Gb._onOpen=function(Ga){this._connected=!0,this.event("open",Ga)},Gb._onMessage=function(Ga){if(Ga&&Ga.data){var Gb=Ga.data;if(this.disableInput&&Gb)this.event("message",Gb);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var Gc=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,Gb&&("string"==typeof Gb?this._input.writeUTFBytes(Gb):this._input.writeArrayBuffer(Gb),this._addInputPosition=this._input.pos,this._input.pos=Gc),this.event("message",Gb)}}},Gb._onClose=function(Ga){this._connected=!1,this.event("close",Ga)},Gb._onError=function(Ga){this.event("error",Ga)},Gb.send=function(Ga){this._socket.send(Ga)},Gb.flush=function(){if(this._output&&0<this._output.length){var Gb;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(Ga){Gb=Ga}this._output.endian=this.endian,this._output.clear(),Gb&&this.event("error",Gb)}},Gk(0,Gb,"input",function(){return this._input}),Gk(0,Gb,"output",function(){return this._output}),Gk(0,Gb,"connected",function(){return this._connected}),Gk(0,Gb,"endian",function(){return this._endian},function(Ga){this._endian=Ga,null!=this._input&&(this._input.endian=Ga),null!=this._output&&(this._output.endian=Ga)}),Gd.LITTLE_ENDIAN="littleEndian",Gd.BIG_ENDIAN="bigEndian"}(),function(Ga){function Gh(){Gh.__super.call(this),this._$1__id=++Gh._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(Gh._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,GN.currentResourceManager&&GN.currentResourceManager.addResource(this)}Gr(Gh,"laya.resource.Resource",Gj);var Gb=Gh.prototype;return Gz.imps(Gb,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),Gb._setUrl=function(Ga){var Gb;this._url!==Ga&&(this._url&&((Gb=Gh._urlResourcesMap[this._url]).splice(Gb.indexOf(this),1),0===Gb.length&&delete Gh._urlResourcesMap[this._url]),Ga&&((Gb=Gh._urlResourcesMap[Ga])||(Gh._urlResourcesMap[Ga]=Gb=[]),Gb.push(this)),this._url=Ga)},Gb._getGroup=function(){return this._group},Gb._setGroup=function(Ga){var Gb;this._group!==Ga&&(this._group&&((Gb=Gh._groupResourcesMap[this._group]).splice(Gb.indexOf(this),1),0===Gb.length&&delete Gh._groupResourcesMap[this._group]),Ga&&((Gb=Gh._groupResourcesMap[Ga])||(Gh._groupResourcesMap[Ga]=Gb=[]),Gb.push(this)),this._group=Ga)},Gb._addReference=function(){this._referenceCount++},Gb._removeReference=function(){this._referenceCount--},Gb._clearReference=function(){this._referenceCount=0},Gb._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},Gb.recreateResource=function(){this.completeCreate()},Gb.disposeResource=function(){},Gb.activeResource=function(Ga){void 0===Ga&&(Ga=!1),this._lastUseFrameCount=GX.loopCount,!this._destroyed&&this.__loaded&&(this._released||Ga)&&this.recreateResource()},Gb.releaseResource=function(Ga){return void 0===Ga&&(Ga=!0),!(!Ga&&this.lock)&&(!(this._released&&!Ga)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},Gb.onAsynLoaded=function(Ga,Gb,Gc){throw new Error("Resource: must override this function!")},Gb.destroy=function(){var Ga;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete Gh._idResourcesMap[this.id],this._url&&((Ga=Gh._urlResourcesMap[this._url])&&(Ga.splice(Ga.indexOf(this),1),0===Ga.length&&delete Gh._urlResourcesMap[this.url]),Gha.clearRes(this._url),this.__loaded||GF.cancelLoadByUrl(this._url)),this._group&&((Ga=Gh._groupResourcesMap[this._group]).splice(Ga.indexOf(this),1),0===Ga.length&&delete Gh._groupResourcesMap[this.url]))},Gb.completeCreate=function(){this._released=!1,this.event("recovered",this)},Gb.dispose=function(){this.destroy()},Gk(0,Gb,"memorySize",function(){return this._memorySize},function(Ga){var Gb=Ga-this._memorySize;this._memorySize=Ga,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,Gb),this.resourceManager&&this.resourceManager.addSize(Gb)}),Gk(0,Gb,"_loaded",null,function(Ga){this.__loaded=Ga}),Gk(0,Gb,"loaded",function(){return this.__loaded}),Gk(0,Gb,"id",function(){return this._$1__id}),Gk(0,Gb,"destroyed",function(){return this._destroyed}),Gk(0,Gb,"group",function(){return this._getGroup()},function(Ga){this._setGroup(Ga)}),Gk(0,Gb,"resourceManager",function(){return this._resourceManager}),Gk(0,Gb,"url",function(){return this._url}),Gk(0,Gb,"released",function(){return this._released}),Gk(0,Gb,"referenceCount",function(){return this._referenceCount}),Gh.getResourceByID=function(Ga){return Gh._idResourcesMap[Ga]},Gh.getResourceByURL=function(Ga,Gb){return void 0===Gb&&(Gb=0),null==Gh._urlResourcesMap[Ga]?null:Gh._urlResourcesMap[Ga][Gb]},Gh.getResourceCountByURL=function(Ga){return Gh._urlResourcesMap[Ga].length},Gh.destroyUnusedResources=function(Ga){var Gb;if(Ga){var Gc=Gh._groupResourcesMap[Ga];if(Gc)for(var Gd=Gc.slice(),Ge=0,Gf=Gd.length;Ge<Gf;Ge++)(Gb=Gd[Ge]).lock||0!==Gb._referenceCount||Gb.destroy()}else for(var Gg in Gh._idResourcesMap)(Gb=Gh._idResourcesMap[Gg]).lock||0!==Gb._referenceCount||Gb.destroy()},Gh._uniqueIDCounter=0,Gh._idResourcesMap={},Gh._urlResourcesMap={},Gh._groupResourcesMap={},Gh}()),Gka=function(Ga){function GC(Ga,Gb){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,GC.__super.call(this),Ga&&null!=Ga._addReference&&Ga._addReference(),this.setTo(Ga,Gb)}Gr(GC,"laya.resource.Texture",Gj);var Gb=GC.prototype;return Gb._setUrl=function(Ga){this.url=Ga},Gb.setTo=function(Ga,Gb){if(Ga instanceof Gg.HTMLElement){var Gc=Gva.create("2D",Ga);this.bitmap=Gc}else this.bitmap=Ga;if(this.uv=Gb||GC.DEF_UV,Ga){this._w=Ga.width,this._h=Ga.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var Gd=this;if(this._loaded)GF.addToAtlas&&GF.addToAtlas(Gd);else{var Ge=Ga;Ge instanceof laya.resource.HTMLImage&&Ge.image&&Ge.image.addEventListener("load",function(Ga){GF.addToAtlas&&GF.addToAtlas(Gd)},!1)}}},Gb.active=function(){this.bitmap&&this.bitmap.activeResource()},Gb.destroy=function(Ga){if(void 0===Ga&&(Ga=!1),this.alphaTexture&&(this.alphaTexture.destroy(Ga),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var Gb=this.bitmap;Ga?(GJ.isConchApp&&Gb.source&&Gb.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,Gb.dispose(),Gb._clearReference()):(Gb._removeReference(),0==Gb.referenceCount&&(GJ.isConchApp&&Gb.source&&Gb.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,Gb.dispose())),this.url&&this===Gz.loader.getRes(this.url)&&Gz.loader.clearRes(this.url,Ga),this._loaded=!1}},Gb.load=function(Ga){var Gb=this;this._loaded=!1,Ga=GI.customFormat(Ga);var Gc=this.bitmap||(this.bitmap=Gya.create(Ga));Gc.uri=Ga,Gc&&Gc._addReference();var Gd=this;Gc.onload=function(){Gc.onload=null,Gd._loaded=!0,Gb.sourceWidth=Gb._w=Gc.width,Gb.sourceHeight=Gb._h=Gc.height,Gd.event("loaded",this),GF.addToAtlas&&GF.addToAtlas(Gd)}},Gb.addTextureToAtlas=function(Ga){GF.addTextureToAtlas(this)},Gb.getPixels=function(Ga,Gb,Gc,Gd){if(GJ.isConchApp){var Ge=this.bitmap;if(Ge.source&&Ge.source.getImageData){var Gf=Ge.source.getImageData(Ga,Gb,Gc,Gd),Gg=new Uint8Array(Gf);return Array.from(Gg)}return null}return GJ.isWebGL?GF.getTexturePixels(this,Ga,Gb,Gc,Gd):(GO.canvas.size(Gc,Gd),GO.canvas.clear(),GO.context.drawTexture(this,-Ga,-Gb,this.width,this.height,0,0),GO.context.getImageData(0,0,Gc,Gd).data)},Gb.onAsynLoaded=function(Ga,Gb){if(Gb){if("function"!=typeof Gb._addReference)throw new Error("bitmap._addReference is not a function. "+Gb.className+" "+typeof Gb._addReference+" "+Gb.constructor);Gb._addReference()}this.setTo(Gb,this.uv),this._loaded&&this.event("loaded",this)},Gk(0,Gb,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),Gk(0,Gb,"loaded",function(){return this._loaded}),Gk(0,Gb,"released",function(){return!this.bitmap||this.bitmap.released}),Gk(0,Gb,"width",function(){return this._w?this._w:this.uv&&this.uv!==GC.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(Ga){this._w=Ga,this.sourceWidth||(this.sourceWidth=Ga)}),Gk(0,Gb,"repeat",function(){return!GJ.isWebGL||!this.bitmap||this.bitmap.repeat},function(Ga){Ga&&GJ.isWebGL&&this.bitmap&&(this.bitmap.repeat=Ga)&&(this.bitmap.enableMerageInAtlas=!1)}),Gk(0,Gb,"height",function(){return this._h?this._h:this.uv&&this.uv!==GC.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(Ga){this._h=Ga,this.sourceHeight||(this.sourceHeight=Ga)}),Gk(0,Gb,"isLinearSampling",function(){return!GJ.isWebGL||9728!=this.bitmap.minFifter},function(Ga){!Ga&&GJ.isWebGL&&(Ga||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),GC.moveUV=function(Ga,Gb,Gc){for(var Gd=0;Gd<8;Gd+=2)Gc[Gd]+=Ga,Gc[Gd+1]+=Gb;return Gc},GC.create=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){void 0===Gf&&(Gf=0),void 0===Gg&&(Gg=0),void 0===Gh&&(Gh=0),void 0===Gi&&(Gi=0);var Gj=Ga instanceof laya.resource.Texture,Gk=Gj?Ga.uv:GC.DEF_UV,Gl=Gj?Ga.bitmap:Ga,Go=GF.isAtlas(Gl);if(Go){var Gp=Gl._atlaser,Gq=Ga._atlasID;if(-1==Gq)throw new Error("create texture error");Gl=Gp._inAtlasTextureBitmapValue[Gq],Gk=Gp._inAtlasTextureOriUVValue[Gq]}var Gr=new GC(Gl,null);Gl.width&&Gb+Gd>Gl.width&&(Gd=Gl.width-Gb),Gl.height&&Gc+Ge>Gl.height&&(Ge=Gl.height-Gc),Gr.width=Gd,Gr.height=Ge,Gr.offsetX=Gf,Gr.offsetY=Gg,Gr.sourceWidth=Gh||Gd,Gr.sourceHeight=Gi||Ge;var Gs=1/Gl.width,Gt=1/Gl.height;Gb*=Gs,Gc*=Gt,Gd*=Gs,Ge*=Gt;var Gu=Gr.uv[0],Gv=Gr.uv[1],Gw=Gr.uv[4],Gx=Gr.uv[5],Gy=Gw-Gu,Gz=Gx-Gv,GA=GC.moveUV(Gk[0],Gk[1],[Gb,Gc,Gb+Gd,Gc,Gb+Gd,Gc+Ge,Gb,Gc+Ge]);Gr.uv=[Gu+GA[0]*Gy,Gv+GA[1]*Gz,Gw-(1-GA[2])*Gy,Gv+GA[3]*Gz,Gw-(1-GA[4])*Gy,Gx-(1-GA[5])*Gz,Gu+GA[6]*Gy,Gx-(1-GA[7])*Gz],Go&&Gr.addTextureToAtlas();var GB=Gl.scaleRate;return GB&&1!=GB?(Gr.sourceWidth/=GB,Gr.sourceHeight/=GB,Gr.width/=GB,Gr.height/=GB,Gr.scaleRate=GB,Gr.offsetX/=GB,Gr.offsetY/=GB):Gr.scaleRate=1,Gr},GC.createFromTexture=function(Ga,Gb,Gc,Gd,Ge){var Gf=Ga.scaleRate;1!=Gf&&(Gb*=Gf,Gc*=Gf,Gd*=Gf,Ge*=Gf);var Gg=GB.TEMP.setTo(Gb-Ga.offsetX,Gc-Ga.offsetY,Gd,Ge),Gh=Gg.intersection(GC._rect1.setTo(0,0,Ga.width,Ga.height),GC._rect2);if(!Gh)return null;var Gi=GC.create(Ga,Gh.x,Gh.y,Gh.width,Gh.height,Gh.x-Gg.x,Gh.y-Gg.y,Gd,Ge);if(Gi.bitmap&&Gi.bitmap._removeReference)return Gi.bitmap._removeReference(),Gi;var Gj="bitmap:"+(Gi.bitmap?Gi.bitmap.constructor?Gi.bitmap.constructor.name:Gi.bitmap.__className:"")+", url:"+(Ga.url+" | "+(Gi.bitmap?Gi.bitmap.url:Ga.url))+", x="+Gb+",y="+Gc+",width="+Gd+",height="+Ge+", result="+(Gh?Gh.x+","+Gh.y+","+Gh.width+","+Gh.height:"null")+", rect="+Gg.x+","+Gg.y+","+Gg.width+","+Gg.height;throw new Error("报错：bitmap._removeReference is not a function  "+Gj)},GC.DEF_UV=[0,0,1,0,1,1,0,1],GC.INV_UV=[0,1,1,1,1,0,0,0],GC._rect1=new GB,GC._rect2=new GB,GC}(),Ga=function(Ga){var Gh;function Gf(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,Gf.__super.call(this)}Gr(Gf,"laya.utils.TimeLine",Gj);var Gb=Gf.prototype;return Gb.to=function(Ga,Gb,Gc,Gd,Ge){return void 0===Ge&&(Ge=0),this._create(Ga,Gb,Gc,Gd,Ge,!0)},Gb.from=function(Ga,Gb,Gc,Gd,Ge){return void 0===Ge&&(Ge=0),this._create(Ga,Gb,Gc,Gd,Ge,!1)},Gb._create=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=GW.getItemByClass("tweenData",Gh);return Gg.isTo=Gf,Gg.type=0,Gg.target=Ga,Gg.duration=Gc,Gg.data=Gb,Gg.startTime=this._startTime+Ge,Gg.endTime=Gg.startTime+Gg.duration,Gg.ease=Gd,this._startTime=Math.max(Gg.endTime,this._startTime),this._tweenDataList.push(Gg),this._startTimeSort=!0,this._endTimeSort=!0,this},Gb.addLabel=function(Ga,Gb){var Gc=GW.getItemByClass("tweenData",Gh);return Gc.type=1,Gc.data=Ga,Gc.endTime=Gc.startTime=this._startTime+Gb,this._labelDic||(this._labelDic={}),this._labelDic[Ga]=Gc,this._tweenDataList.push(Gc),this},Gb.removeLabel=function(Ga){if(this._labelDic&&this._labelDic[Ga]){var Gb=this._labelDic[Ga];if(Gb){var Gc=this._tweenDataList.indexOf(Gb);-1<Gc&&this._tweenDataList.splice(Gc,1)}delete this._labelDic[Ga]}},Gb.gotoTime=function(Ga){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var Gb,Gc,Gd,Ge;for(var Gf in this._firstTweenDic)if(Gc=this._firstTweenDic[Gf])for(var Gg in Gc)Gc.diyTarget.hasOwnProperty(Gg)&&(Gc.diyTarget[Gg]=Gc[Gg]);for(Gf in this._tweenDic)(Gb=this._tweenDic[Gf]).clear(),delete this._tweenDic[Gf];if(this._index=0,this._gidIndex=0,this._currTime=Ga,this._lastTime=GO.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=Gd=this._tweenDataList.concat(),Gd.sort(function(Ga,Gb){return Ga.endTime>Gb.endTime?1:Ga.endTime<Gb.endTime?-1:0})}else Gd=this._endTweenDataList;for(var Gh=0,Gi=Gd.length;Gh<Gi;Gh++)if(0==(Ge=Gd[Gh]).type){if(!(Ga>=Ge.endTime))break;this._index=Math.max(this._index,Gh+1);var Gj=Ge.data;if(Ge.isTo)for(var Gk in Gj)Ge.target[Gk]=Gj[Gk]}for(Gh=0,Gi=this._tweenDataList.length;Gh<Gi;Gh++)0==(Ge=this._tweenDataList[Gh]).type&&Ga>=Ge.startTime&&Ga<Ge.endTime&&(this._index=Math.max(this._index,Gh+1),this._gidIndex++,(Gb=GW.getItemByClass("tween",GZ))._create(Ge.target,Ge.data,Ge.duration,Ge.ease,Gu.create(this,this._animComplete,[this._gidIndex]),0,!1,Ge.isTo,!0,!1),Gb.setStartTime(this._currTime-(Ga-Ge.startTime)),Gb._updateEase(this._currTime),Gb.gid=this._gidIndex,this._tweenDic[this._gidIndex]=Gb)}},Gb.gotoLabel=function(Ga){if(null!=this._labelDic){var Gb=this._labelDic[Ga];Gb&&this.gotoTime(Gb.startTime)}},Gb.pause=function(){Gz.timer.clear(this,this._update)},Gb.resume=function(){this.play(this._currTime,this._loopKey)},Gb.play=function(Ga,Gb){if(void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(Ga,Gb){return Ga.startTime>Gb.startTime?1:Ga.startTime<Gb.startTime?-1:0});for(var Gc=0,Gd=this._tweenDataList.length;Gc<Gd;Gc++){var Ge=this._tweenDataList[Gc];if(null!=Ge&&0==Ge.type){var Gf=Ge.target,Gg=Gf.$_GID||(Gf.$_GID=G$.getGID()),Gh=null;for(var Gi in null==this._firstTweenDic[Gg]?((Gh={}).diyTarget=Gf,this._firstTweenDic[Gg]=Gh):Gh=this._firstTweenDic[Gg],Ge.data)null==Gh[Gi]&&(Gh[Gi]=Gf[Gi])}}}"string"==typeof Ga?this.gotoLabel(Ga):this.gotoTime(Ga),this._loopKey=Gb,this._lastTime=GO.now(),Gz.timer.frameLoop(1,this,this._update)}},Gb._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var Ga in this._tweenDic)(Gb=this._tweenDic[Ga]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var Gb,Gc=GO.now(),Gd=Gc-this._lastTime,Ge=this._currTime+=Gd*this.scale;for(Ga in this._lastTime=Gc,this._tweenDic)(Gb=this._tweenDic[Ga])._updateEase(Ge);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var Gf=this._tweenDataList[this._index];Ge>=Gf.startTime&&(this._index++,0==Gf.type?(this._gidIndex++,(Gb=GW.getItemByClass("tween",GZ))._create(Gf.target,Gf.data,Gf.duration,Gf.ease,Gu.create(this,this._animComplete,[this._gidIndex]),0,!1,Gf.isTo,!0,!1),Gb.setStartTime(Ge),Gb.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=Gb)._updateEase(Ge)):this.event("label",Gf.data))}},Gb._animComplete=function(Ga){this._tweenDic[Ga]&&delete this._tweenDic[Ga]},Gb._complete=function(){this.event("complete")},Gb.reset=function(){var Ga;if(this._labelDic)for(Ga in this._labelDic)delete this._labelDic[Ga];for(Ga in this._tweenDic)this._tweenDic[Ga].clear(),delete this._tweenDic[Ga];for(Ga in this._firstTweenDic)delete this._firstTweenDic[Ga];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var Gb,Gc=0;for(Gb=this._tweenDataList.length,Gc=0;Gc<Gb;Gc++)this._tweenDataList[Gc]&&this._tweenDataList[Gc].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,Gz.timer.clear(this,this._update)},Gb.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},Gk(0,Gb,"index",function(){return this._frameIndex},function(Ga){this._frameIndex=Ga,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),Gk(0,Gb,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),Gf.to=function(Ga,Gb,Gc,Gd,Ge){return void 0===Ge&&(Ge=0),(new Gf).to(Ga,Gb,Gc,Gd,Ge)},Gf.from=function(Ga,Gb,Gc,Gd,Ge){return void 0===Ge&&(Ge=0),(new Gf).from(Ga,Gb,Gc,Gd,Ge)},Gf.__init$=function(){Gh=function(){function Ga(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return Gr(Ga,""),Ga.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,GW.recover("tweenData",this)},Ga}()},Gf}(),Gla=function(Ge){function Gc(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,Gc.__super.call(this),this._style=Gh.EMPTY}Gr(Gc,"laya.display.Sprite",Ge);var Ga=Gc.prototype;return Gz.imps(Ga,{"laya.display.ILayout":!0}),Ga.createConchModel=function(){return new ConchNode},Ga.destroy=function(Ga){if(void 0===Ga&&(Ga=!0),this._releaseMem(),!this._destroyed){this.filters=null;var Gb=this.mask;Gb&&(this.mask=null,Gb.destroy(Ga))}Ge.prototype.destroy.call(this,Ga),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},Ga.updateZOrder=function(){G$.updateOrder(this._childs)&&this.repaint()},Ga.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},Ga.setBounds=function(Ga){this._set$P("uBounds",Ga)},Ga.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new GB),GB._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},Ga.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new GB),GB._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},Ga._boundPointsToParent=function(Ga){void 0===Ga&&(Ga=!1);var Gb=0,Gc=0;this._style&&(Gb=this._style._tf.translateX,Gc=this._style._tf.translateY,Ga=Ga||0!==this._style._tf.rotate,this._style.scrollRect&&(Gb+=this._style.scrollRect.x,Gc+=this._style.scrollRect.y));var Gd=this._getBoundPointsM(Ga);if(!Gd||Gd.length<1)return Gd;if(8!=Gd.length&&(Gd=Ga?Gx.scanPList(Gd):GB._getWrapRec(Gd,GB.TEMP)._getBoundPoints()),!this.transform)return G$.transPointList(Gd,this._x-Gb,this._y-Gc),Gd;var Ge=GA.TEMP,Gf=0,Gg=Gd.length;for(Gf=0;Gf<Gg;Gf+=2)Ge.x=Gd[Gf],Ge.y=Gd[Gf+1],this.toParentPoint(Ge),Gd[Gf]=Ge.x,Gd[Gf+1]=Ge.y;return Gd},Ga.getGraphicBounds=function(Ga){return void 0===Ga&&(Ga=!1),this._graphics?this._graphics.getBounds(Ga):GB.TEMP.setTo(0,0,0,0)},Ga._getBoundPointsM=function(Ga){if(void 0===Ga&&(Ga=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var Gb=G$.clearArray(this._$P.temBM),Gc=GB.TEMP;return Gc.copyFrom(this.scrollRect),G$.concatArray(Gb,Gc._getBoundPoints()),Gb}for(var Gd,Ge,Gf,Gg=this._graphics?this._graphics.getBoundPoints():G$.clearArray(this._$P.temBM),Gh=0,Gi=(Gf=this._childs).length;Gh<Gi;Gh++)(Gd=Gf[Gh])instanceof laya.display.Sprite&&1==Gd.visible&&(Ge=Gd._boundPointsToParent(Ga))&&(Gg=Gg?G$.concatArray(Gg,Ge):Ge);return Gg},Ga.getStyle=function(){return this._style===Gh.EMPTY&&(this._style=new Gh),this._style},Ga.setStyle=function(Ga){this._style=Ga},Ga._adjustTransform=function(){this._tfChanged=!1;var Ga,Gb=this._style._tf,Gc=Gb.scaleX,Gd=Gb.scaleY;if(Gb.rotate||1!==Gc||1!==Gd||Gb.skewX||Gb.skewY){(Ga=this._transform||(this._transform=GG.create())).bTransform=!0;var Ge=.0174532922222222*(Gb.rotate-Gb.skewX),Gf=.0174532922222222*(Gb.rotate+Gb.skewY),Gg=Math.cos(Gf),Gh=Math.sin(Gf),Gi=Math.sin(Ge),Gj=Math.cos(Ge);return Ga.a=Gc*Gg,Ga.b=Gc*Gh,Ga.c=-Gd*Gi,Ga.d=Gd*Gj,Ga.tx=Ga.ty=0,Ga}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,Ga},Ga.pos=function(Ga,Gb,Gc){if(void 0===Gc&&(Gc=!1),this._x!==Ga||this._y!==Gb){if(this.destroyed)return this;if(Gc){this._x=Ga,this._y=Gb,this.conchModel&&this.conchModel.pos(this._x,this._y);var Gd=this._parent;Gd&&0===Gd._repaint&&(Gd._repaint=1,Gd.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=Ga,this.y=Gb}return this},Ga.pivot=function(Ga,Gb){return this.pivotX=Ga,this.pivotY=Gb,this},Ga.size=function(Ga,Gb){return this.width=Ga,this.height=Gb,this},Ga.scale=function(Ga,Gb,Gc){void 0===Gc&&(Gc=!1);var Gd=this.getStyle(),Ge=Gd._tf;if(Ge.scaleX!=Ga||Ge.scaleY!=Gb){if(this.destroyed)return this;if(Gc){Gd.setScale(Ga,Gb),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Ga,Gb),this._renderType|=4;var Gf=this._parent;Gf&&0===Gf._repaint&&(Gf._repaint=1,Gf.parentRepaint())}else this.scaleX=Ga,this.scaleY=Gb}return this},Ga.skew=function(Ga,Gb){return this.skewX=Ga,this.skewY=Gb,this},Ga.render=function(Ga,Gb,Gc){GX.spriteCount++,GL.renders[this._renderType]._fun(this,Ga,Gb+this._x,Gc+this._y),this._repaint=0},Ga.drawToCanvas=function(Ga,Gb,Gc,Gd){if(GJ.isConchNode){var Ge=Gva.create("2D");return new GK(Ga,Gb,Ge).ctx.setCanvasType(1),this.conchModel.drawToCanvas(Ge.source,Gc,Gd),Ge}return GF.drawToCanvas(this,this._renderType,Ga,Gb,Gc,Gd)},Ga.customRender=function(Ga,Gb,Gc){this._renderType|=1024},Ga._applyFilters=function(){var Ga;if(!GJ.isWebGL&&((Ga=this._$P.filters)&&!(Ga.length<1)))for(var Gb=0,Gc=Ga.length;Gb<Gc;Gb++)Ga[Gb].action.apply(this._$P.cacheCanvas)},Ga._isHaveGlowFilter=function(){var Ga,Gb=0;if(this.filters)for(Gb=0;Gb<this.filters.length;Gb++)if(8==this.filters[Gb].type)return!0;for(Gb=0,Ga=this._childs.length;Gb<Ga;Gb++)if(this._childs[Gb]._isHaveGlowFilter())return!0;return!1},Ga.localToGlobal=function(Ga,Gb){void 0===Gb&&(Gb=!1),!0===Gb&&(Ga=new GA(Ga.x,Ga.y));for(var Gc=this;Gc&&Gc!=Gz.stage;)Ga=Gc.toParentPoint(Ga),Gc=Gc.parent;return Ga},Ga.globalToLocal=function(Ga,Gb){void 0===Gb&&(Gb=!1),Gb&&(Ga=new GA(Ga.x,Ga.y));for(var Gc=this,Gd=[];Gc&&Gc!=Gz.stage;)Gd.push(Gc),Gc=Gc.parent;for(var Ge=Gd.length-1;0<=Ge;)Ga=(Gc=Gd[Ge]).fromParentPoint(Ga),Ge--;return Ga},Ga.toParentPoint=function(Ga){if(!Ga)return Ga;Ga.x-=this.pivotX,Ga.y-=this.pivotY,this.transform&&this._transform.transformPoint(Ga),Ga.x+=this._x,Ga.y+=this._y;var Gb=this._style.scrollRect;return Gb&&(Ga.x-=Gb.x,Ga.y-=Gb.y),Ga},Ga.fromParentPoint=function(Ga){if(!Ga)return Ga;Ga.x-=this._x,Ga.y-=this._y;var Gb=this._style.scrollRect;return Gb&&(Ga.x+=Gb.x,Ga.y+=Gb.y),this.transform&&this._transform.invertTransformPoint(Ga),Ga.x+=this.pivotX,Ga.y+=this.pivotY,Ga},Ga.on=function(Ga,Gb,Gc,Gd){return 1!==this._mouseEnableState&&this.isMouseEvent(Ga)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(Ga,Gb,Gc,Gd,!1)):Ge.prototype.on.call(this,Ga,Gb,Gc,Gd)},Ga.once=function(Ga,Gb,Gc,Gd){return 1!==this._mouseEnableState&&this.isMouseEvent(Ga)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(Ga,Gb,Gc,Gd,!0)):Ge.prototype.once.call(this,Ga,Gb,Gc,Gd)},Ga._$2__onDisplay=function(){if(1!==this._mouseEnableState){var Ga=this;for(Ga=Ga.parent;Ga&&1!==Ga._mouseEnableState&&!Ga._getBit(2);)Ga.mouseEnabled=!0,Ga._setBit(2,!0),Ga=Ga.parent}},Ga.loadImage=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=this;return void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=0),void 0===Ge&&(Ge=0),this.graphics.loadImage(Ga,Gb,Gc,Gd,Ge,function(Ga){Gg.destroyed||(Gg.size(Gb+(Gd||Ga.width),Gc+(Ge||Ga.height)),Gg.repaint(),Gf&&Gf.runWith(Ga))}),this},Ga.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},Ga._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},Ga._childChanged=function(Ga){this._childs.length?this._renderType|=2048:this._renderType&=-2049,Ga&&this._get$P("hasZorder")&&Gz.timer.callLater(this,this.updateZOrder),this.repaint()},Ga.parentRepaint=function(){var Ga=this._parent;Ga&&0===Ga._repaint&&(Ga._repaint=1,Ga.parentRepaint())},Ga.startDrag=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){void 0===Gb&&(Gb=!1),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=300),void 0===Gf&&(Gf=!1),void 0===Gg&&(Gg=.92),this._$P.dragging||this._set$P("dragging",new GT),this._$P.dragging.start(this,Ga,Gb,Gc,Gd,Ge,Gf,Gg)},Ga.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},Ga._releaseMem=function(){if(this._$P){var Ga=this._$P.cacheCanvas;Ga&&Ga.ctx&&(GW.recover("RenderContext",Ga.ctx),Ga.ctx.canvas.size(0,0),Ga.ctx=null);var Gb=this._$P._filterCache;Gb&&(Gb.destroy(),Gb.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},Ga._setDisplay=function(Ga){Ga||this._releaseMem(),Ge.prototype._setDisplay.call(this,Ga)},Ga.hitTestPoint=function(Ga,Gb){var Gc=this.globalToLocal(GA.TEMP.setTo(Ga,Gb));return Ga=Gc.x,Gb=Gc.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?GB.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(Ga,Gb)},Ga.getMousePoint=function(){return this.globalToLocal(GA.TEMP.setTo(Gz.stage.mouseX,Gz.stage.mouseY))},Ga._getWords=function(){return null},Ga._addChildsToLayout=function(Ga){var Gb=this._getWords();if(null==Gb&&0==this._childs.length)return!1;if(Gb)for(var Gc=0,Gd=Gb.length;Gc<Gd;Gc++)Ga.push(Gb[Gc]);Gc=0;for(var Ge=this._childs.length;Gc<Ge;++Gc){var Gf=this._childs[Gc];Gf._style._enableLayout()&&Gf._addToLayout(Ga)}return!0},Ga._addToLayout=function(Ga){this._style.absolute||(this._style.block?Ga.push(this):this._addChildsToLayout(Ga)&&(this.x=this.y=0))},Ga._isChar=function(){return!1},Ga._getCSSStyle=function(){return this._style.getCSSStyle()},Ga._setAttributes=function(Ga,Gb){switch(Ga){case"x":this.x=parseFloat(Gb);break;case"y":this.y=parseFloat(Gb);break;case"width":this.width=parseFloat(Gb);break;case"height":this.height=parseFloat(Gb);break;default:this[Ga]=Gb}},Ga._layoutLater=function(){this.parent&&this.parent._layoutLater()},Gk(0,Ga,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(Ga){this._optimizeScrollRect!=Ga&&(this._optimizeScrollRect=Ga,this.conchModel&&this.conchModel.optimizeScrollRect(Ga))}),Gk(0,Ga,"customRenderEnable",null,function(Ga){if(Ga&&(this._renderType|=1024,GJ.isConchNode)){Gc.CustomList.push(this);var Gb=new Gva("2d");Gb._setContext(new CanvasRenderingContext2D),this.customContext=new GK(0,0,Gb),Gb.context.setCanvasType&&Gb.context.setCanvasType(2),this.conchModel.custom(Gb.context)}}),Gk(0,Ga,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(Ga){this.cacheAs=Ga?this._$P.hasFilter?"none":"normal":"none"}),Gk(0,Ga,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(Ga){var Gb=this._$P.cacheCanvas;if(Ga!==(Gb?Gb.type:"none")){if("none"!==Ga)this._getBit(1)||this._setUpNoticeType(1),Gb||(Gb=this._set$P("cacheCanvas",GW.getItemByClass("cacheCanvas",Object))),Gb.type=Ga,Gb.reCache=!0,this._renderType|=16,"bitmap"==Ga&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(Gb){var Gc=Gb;Gc&&Gc.ctx&&(GW.recover("RenderContext",Gc.ctx),Gc.ctx.canvas.size(0,0),Gc.ctx=null),GW.recover("cacheCanvas",Gb)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),Gk(0,Ga,"zOrder",function(){return this._zOrder},function(Ga){this._zOrder!=Ga&&(this._zOrder=Ga,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(Ga),this._parent&&(Ga&&this._parent._set$P("hasZorder",!0),Gz.timer.callLater(this._parent,this.updateZOrder)))}),Gk(0,Ga,"rotation",function(){return this._style._tf.rotate},function(Ga){var Gb=this.getStyle();if(Gb._tf.rotate!==Ga){Gb.setRotate(Ga),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(Ga),this._renderType|=4;var Gc=this._parent;Gc&&0===Gc._repaint&&(Gc._repaint=1,Gc.parentRepaint())}}),Gk(0,Ga,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(Ga){this._width!==Ga&&(this._width=Ga,this.conchModel&&this.conchModel.size(Ga,this._height),this.repaint())}),Gk(0,Ga,"x",function(){return this._x},function(Ga){if(this._x!==Ga){if(this.destroyed)return;this._x=Ga,this.conchModel&&this.conchModel.pos(Ga,this._y);var Gb=this._parent;Gb&&0===Gb._repaint&&(Gb._repaint=1,Gb.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),Gk(0,Ga,"globalScaleY",function(){for(var Ga=1,Gb=this;Gb&&Gb!==Gz.stage;)Ga*=Gb.scaleY,Gb=Gb.parent;return Ga}),Gk(0,Ga,"hitArea",function(){return this._$P.hitArea},function(Ga){this._set$P("hitArea",Ga)}),Gk(0,Ga,"staticCache",function(){return this._$P.staticCache},function(Ga){this._set$P("staticCache",Ga),Ga||this.reCache()}),Gk(0,Ga,"texture",function(){return this._texture},function(Ga){this._texture!=Ga&&(this._texture=Ga,this.graphics.cleanByTexture(Ga,0,0))}),Gk(0,Ga,"y",function(){return this._y},function(Ga){if(this._y!==Ga){if(this.destroyed)return;this._y=Ga,this.conchModel&&this.conchModel.pos(this._x,Ga);var Gb=this._parent;Gb&&0===Gb._repaint&&(Gb._repaint=1,Gb.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),Gk(0,Ga,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(Ga){this._height!==Ga&&(this._height=Ga,this.conchModel&&this.conchModel.size(this._width,Ga),this.repaint())}),Gk(0,Ga,"blendMode",function(){return this._style.blendMode},function(Ga){this.getStyle().blendMode=Ga,this.conchModel&&this.conchModel.blendMode(Ga),Ga&&"source-over"!=Ga?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),Gk(0,Ga,"scaleX",function(){return this._style._tf.scaleX},function(Ga){var Gb=this.getStyle();if(Gb._tf.scaleX!==Ga){Gb.setScaleX(Ga),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Ga,Gb._tf.scaleY),this._renderType|=4;var Gc=this._parent;Gc&&0===Gc._repaint&&(Gc._repaint=1,Gc.parentRepaint())}}),Gk(0,Ga,"scaleY",function(){return this._style._tf.scaleY},function(Ga){var Gb=this.getStyle();if(Gb._tf.scaleY!==Ga){Gb.setScaleY(Ga),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(Gb._tf.scaleX,Ga),this._renderType|=4;var Gc=this._parent;Gc&&0===Gc._repaint&&(Gc._repaint=1,Gc.parentRepaint())}}),Gk(0,Ga,"stage",function(){return Gz.stage}),Gk(0,Ga,"skewX",function(){return this._style._tf.skewX},function(Ga){var Gb=this.getStyle();if(Gb._tf.skewX!==Ga){Gb.setSkewX(Ga),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(Ga,Gb._tf.skewY),this._renderType|=4;var Gc=this._parent;Gc&&0===Gc._repaint&&(Gc._repaint=1,Gc.parentRepaint())}}),Gk(0,Ga,"scrollRect",function(){return this._style.scrollRect},function(Ga){this.getStyle().scrollRect=Ga,this.repaint(),Ga?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(Ga.x,Ga.y,Ga.width,Ga.height)):(this._renderType&=-129,this.conchModel&&(Gc.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),Gk(0,Ga,"skewY",function(){return this._style._tf.skewY},function(Ga){var Gb=this.getStyle();if(Gb._tf.skewY!==Ga){Gb.setSkewY(Ga),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(Gb._tf.skewX,Ga),this._renderType|=4;var Gc=this._parent;Gc&&0===Gc._repaint&&(Gc._repaint=1,Gc.parentRepaint())}}),Gk(0,Ga,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(Ga){this._tfChanged=!1,(this._transform=Ga)&&(this._x=Ga.tx,this._y=Ga.ty,Ga.tx=Ga.ty=0,this.conchModel&&this.conchModel.transform(Ga.a,Ga.b,Ga.c,Ga.d,this._x,this._y)),Ga?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),Gk(0,Ga,"pivotX",function(){return this._style._tf.translateX},function(Ga){this.getStyle().setTranslateX(Ga),this.conchModel&&this.conchModel.pivot(Ga,this._style._tf.translateY),this.repaint()}),Gk(0,Ga,"pivotY",function(){return this._style._tf.translateY},function(Ga){this.getStyle().setTranslateY(Ga),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,Ga),this.repaint()}),Gk(0,Ga,"alpha",function(){return this._style.alpha},function(Ga){this._style&&this._style.alpha!==Ga&&(Ga=Ga<0?0:1<Ga?1:Ga,this.getStyle().alpha=Ga,this.conchModel&&this.conchModel.alpha(Ga),1!==Ga?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),Gk(0,Ga,"visible",function(){return this._style.visible},function(Ga){this._style&&this._style.visible!==Ga&&(this.getStyle().visible=Ga,this.conchModel&&this.conchModel.visible(Ga),this.parentRepaint())}),Gk(0,Ga,"graphics",function(){return this._graphics||(this.graphics=GF.createGraphics())},function(Ga){this._graphics&&(this._graphics._sp=null),(this._graphics=Ga)?(this._renderType&=-2,this._renderType|=512,(Ga._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(Gc.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),Gk(0,Ga,"filters",function(){return this._$P.filters},function(Ga){Ga&&0===Ga.length&&(Ga=null),this._$P.filters!=Ga&&(this._set$P("filters",Ga?Ga.slice():null),GJ.isConchApp&&(this.conchModel&&(Gc.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),GJ.isWebGL&&(Ga&&Ga.length?this._renderType|=32:this._renderType&=-33),Ga&&0<Ga.length?(this._getBit(1)||this._setUpNoticeType(1),GJ.isWebGL&&1==Ga.length&&Ga[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(GJ.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),Gk(0,Ga,"parent",Ge.prototype._$get_parent,function(Ga){Gz.superSet(Gaa,this,"parent",Ga),Ga&&this._getBit(2)&&this._$2__onDisplay()}),Gk(0,Ga,"mask",function(){return this._$P._mask},function(Ga){Ga&&this.mask&&this.mask._$P.maskParent||(Ga?(this.cacheAs="bitmap",this._set$P("_mask",Ga),Ga._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",Ga),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(Ga?Ga.conchModel:null),this._renderType|=64,this.parentRepaint())}),Gk(0,Ga,"mouseEnabled",function(){return 1<this._mouseEnableState},function(Ga){this._mouseEnableState=Ga?2:1}),Gk(0,Ga,"globalScaleX",function(){for(var Ga=1,Gb=this;Gb&&Gb!==Gz.stage;)Ga*=Gb.scaleX,Gb=Gb.parent;return Ga}),Gk(0,Ga,"mouseX",function(){return this.getMousePoint().x}),Gk(0,Ga,"mouseY",function(){return this.getMousePoint().y}),Gc.fromImage=function(Ga){return(new Gc).loadImage(Ga)},Gc._cachePool=[],Gc.CustomList=[],Gi(Gc,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=Gg.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),Gc}(Gaa),Goa=function(Ga){function Gb(Ga){this._audio=null,this._onEnd=null,this._resumePlay=null,Gb.__super.call(this),this._onEnd=G$.bind(this.__onEnd,this),this._resumePlay=G$.bind(this.__resumePlay,this),Ga.addEventListener("ended",this._onEnd),this._audio=Ga}Gr(Gb,"laya.media.h5audio.AudioSoundChannel",Gda);var Gc=Gb.prototype;return Gc.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(Gz.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},Gc.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,GO.container.appendChild(this._audio),this._audio.play()}catch(Ga){this.event("error")}},Gc.play=function(Ga){this.isStopped=!1;try{this._audio.playbackRate=GE.playbackRate,this._audio.currentTime=this.startTime}catch(Ga){return void this._audio.addEventListener("canplay",this._resumePlay)}GE.addChannel(this),GO.container.appendChild(this._audio),!Ga&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},Gc.stop=function(){this.isStopped=!0,GE.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&GJ.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),GO.onIE||this._audio!=Gca._musicAudio&&GW.recover("audio:"+this.url,this._audio),GO.removeElement(this._audio),this._audio=null)},Gc.pause=function(){this.isStopped=!0,GE.removeChannel(this),"pause"in this._audio&&this._audio.pause()},Gc.resume=function(){this._audio&&(this.isStopped=!1,GE.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},Gk(0,Gc,"position",function(){return this._audio?this._audio.currentTime:0}),Gk(0,Gc,"duration",function(){return this._audio?this._audio.duration:0}),Gk(0,Gc,"volume",function(){return this._audio?this._audio.volume:1},function(Ga){this._audio&&(this._audio.volume=Ga)}),Gb}(),Gpa=function(Ga){function Gb(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=Gfa.ctx,Gb.__super.call(this),this._onPlayEnd=G$.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}Gr(Gb,"laya.media.webaudio.WebAudioSoundChannel",Gda);var Gc=Gb.prototype;return Gc.play=function(Ga){if(GE.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var Gb=this.context,Gc=this.gain,Gd=Gb.createBufferSource();(this.bufferSource=Gd).buffer=this.audioBuffer,Gd.connect(Gc),Gc&&Gc.disconnect(),Gc.connect(Gb.destination),Gd.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=GO.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(Gd.loop=!0),Gd.playbackRate.setTargetAtTime?Gd.playbackRate.setTargetAtTime(GE.playbackRate,this.context.currentTime,.1):Gd.playbackRate.value=GE.playbackRate,Gd.start(0,this.startTime),!Ga&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},Gc.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(Gz.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},Gc._clearBufferSource=function(){if(this.bufferSource){var Ga=this.bufferSource;Ga.stop?Ga.stop(0):Ga.noteOff(0),Ga.disconnect(0),Ga.onended=null,Gb._tryCleanFailed||this._tryClearBuffer(Ga),this.bufferSource=null}},Gc._tryClearBuffer=function(Ga){try{Ga.buffer=null}catch(Ga){Gb._tryCleanFailed=!0}},Gc.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,GE.removeChannel(this),this.startHandler=null,this.completeHandler=null},Gc.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,GE.removeChannel(this)},Gc.resume=function(){this.startTime=this._pauseTime,this.play(!1)},Gk(0,Gc,"position",function(){return this.bufferSource?(GO.now()-this._startTime)/1e3+this.startTime:0}),Gk(0,Gc,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),Gk(0,Gc,"volume",function(){return this._volume},function(Ga){this.isStopped||(this._volume=Ga,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(Ga,this.context.currentTime,.1):this.gain.gain.value=Ga)}),Gb._tryCleanFailed=!1,Gb}(),Gqa=function(Ga){function Gb(){Gb.__super.call(this),this._w=0,this._h=0}Gr(Gb,"laya.resource.Bitmap",Gja);var Gc=Gb.prototype;return Gk(0,Gc,"width",function(){return this._w}),Gk(0,Gc,"height",function(){return this._h}),Gk(0,Gc,"source",function(){return this._source}),Gb}(),Gra=function(Gb){function Ga(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,Ga.__super.call(this),this._interval=Gd.animationInterval,this._setUpNoticeType(1)}Gr(Ga,"laya.display.AnimationPlayerBase",Gb);var Gc=Ga.prototype;return Gc.play=function(Ga,Gb,Gc,Gd){void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=!0),void 0===Gc&&(Gc=""),void 0===Gd&&(Gd=!0),this._isPlaying=!0,this.index="string"==typeof Ga?this._getFrameByLabel(Ga):Ga,this.loop=Gb,this._actionName=Gc,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},Gc._getFrameByLabel=function(Ga){var Gb=0;for(Gb=0;Gb<this._count;Gb++)if(this._labels[Gb]&&0<=this._labels[Gb].indexOf(Ga))return Gb;return 0},Gc._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},Gc._setControlNode=function(Ga){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=Ga)&&Ga!=this&&(Ga.on("display",this,this._checkResumePlaying),Ga.on("undisplay",this,this._checkResumePlaying))},Gc._setDisplay=function(Ga){Gb.prototype._setDisplay.call(this,Ga),this._checkResumePlaying()},Gc._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},Gc.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},Gc.addLabel=function(Ga,Gb){this._labels||(this._labels={}),this._labels[Gb]||(this._labels[Gb]=[]),this._labels[Gb].push(Ga)},Gc.removeLabel=function(Ga){if(Ga){if(this._labels)for(var Gb in this._labels)this._removeLabelFromLabelList(this._labels[Gb],Ga)}else this._labels=null},Gc._removeLabelFromLabelList=function(Ga,Gb){if(Ga)for(var Gc=Ga.length-1;0<=Gc;Gc--)Ga[Gc]==Gb&&Ga.splice(Gc,1)},Gc.gotoAndStop=function(Ga){this.index="string"==typeof Ga?this._getFrameByLabel(Ga):Ga,this.stop()},Gc._displayToIndex=function(Ga){},Gc.clear=function(){this.stop(),this._labels=null},Gk(0,Gc,"interval",function(){return this._interval},function(Ga){this._interval!=Ga&&(this._frameRateChanged=!0,this._interval=Ga,this._isPlaying&&0<Ga&&this.timerLoop(Ga,this,this._frameLoop,null,!0,!0))}),Gk(0,Gc,"isPlaying",function(){return this._isPlaying}),Gk(0,Gc,"index",function(){return this._index},function(Ga){if(this._index=Ga,this._displayToIndex(Ga),this._labels&&this._labels[Ga])for(var Gb=this._labels[Ga],Gc=0,Gd=Gb.length;Gc<Gd;Gc++)this.event("label",Gb[Gc])}),Gk(0,Gc,"count",function(){return this._count}),Ga.WRAP_POSITIVE=0,Ga.WRAP_REVERSE=1,Ga.WRAP_PINGPONG=2,Ga}(Gla),Gsa=function(Gb){function Gp(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,Gp.__super.call(this),this.overflow=Gp.VISIBLE,this._style=new Gba(this),this._style.wordWrap=!1}Gr(Gp,"laya.display.Text",Gb);var Ga=Gp.prototype;return Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,Ga),this._lines=null,this._words&&(this._words.length=0,this._words=null)},Ga._getBoundPointsM=function(Ga){void 0===Ga&&(Ga=!1);var Gb=GB.TEMP;return Gb.setTo(0,0,this.width,this.height),Gb._getBoundPoints()},Ga.getGraphicBounds=function(Ga){void 0===Ga&&(Ga=!1);var Gb=GB.TEMP;return Gb.setTo(0,0,this.width,this.height),Gb},Ga._getCSSStyle=function(){return this._style},Ga.lang=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk){if(Ga=Gp.langPacks&&Gp.langPacks[Ga]?Gp.langPacks[Ga]:Ga,arguments.length<2)this._text=Ga;else{for(var Gl=0,Go=arguments.length;Gl<Go;Gl++)Ga=Ga.replace("{"+Gl+"}",arguments[Gl+1]);this._text=Ga}},Ga._isPassWordMode=function(){var Ga=this._style.password;return"prompt"in this&&this.prompt==this._text&&(Ga=!1),Ga},Ga._getPassWordTxt=function(Ga){var Gb;Gb="";for(var Gc=Ga.length;0<Gc;Gc--)Gb+="●";return Gb},Ga.renderText=function(Ga,Gb){var Gc=this.graphics;Gc.clear(!0);var Gd=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(GO.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);GO.context.font=Gd;var Ge=this.padding,Gf=Ge[3],Gg="left",Gh=this._lines,Gi=this.leading+this._charSize.height,Gj=this._currBitmapFont;Gj&&(Gi=this.leading+Gj.getMaxHeight());var Gk=Ge[0];if(!Gj&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(Gg="right",Gf=this._width-Ge[1]):"center"==this.align&&(Gg="center",Gf=.5*this._width+Ge[3]-Ge[1])),0<this._height){var Gl=this._textHeight>this._height?"top":this.valign;"middle"===Gl?Gk=.5*(this._height-Gb*Gi)+Ge[0]-Ge[2]:"bottom"===Gl&&(Gk=this._height-Gb*Gi-Ge[2])}var Go=this._style;if(Gj&&Gj.autoScaleSize)var Gp=Gj.fontSize/this.fontSize;if(this._clipPoint)if(Gc.save(),Gj&&Gj.autoScaleSize){var Gq=0,Gr=0;Gq=this._width?this._width-Ge[3]-Ge[1]:this._textWidth,Gr=this._height?this._height-Ge[0]-Ge[2]:this._textHeight,Gq*=Gp,Gr*=Gp,Gc.clipRect(Ge[3],Ge[0],Gq,Gr)}else Gc.clipRect(Ge[3],Ge[0],this._width?this._width-Ge[3]-Ge[1]:this._textWidth,this._height?this._height-Ge[0]-Ge[2]:this._textHeight);var Gs=Go.password;"prompt"in this&&this.prompt==this._text&&(Gs=!1);for(var Gt=0,Gu=0,Gv=Math.min(this._lines.length,Gb+Ga)||1,Gw=Ga;Gw<Gv;Gw++){var Gx,Gy=Gh[Gw];if(Gs){var Gz=Gy.length;Gy="";for(var GA=Gz;0<GA;GA--)Gy+="●"}if(Gt=Gf-(this._clipPoint?this._clipPoint.x:0),Gu=Gk+Gi*Gw-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(Gg,Gt,Gu,Gw),Gj){var GB=this.width;Gj.autoScaleSize&&(GB=this.width*Gp),Gj.drawText(Gy,this,Gt,Gu,this.align,GB)}else GJ.isWebGL?(this._words||(this._words=[]),(Gx=this._words.length>Gw-Ga?this._words[Gw-Ga]:new Gn).setText(Gy)):Gx=Gy,Go.stroke?Gc.fillBorderText(Gx,Gt,Gu,Gd,this.color,Go.strokeColor,Go.stroke,Gg):Gc.fillText(Gx,Gt,Gu,Gd,this.color,Gg)}if(Gj&&Gj.autoScaleSize){var GC=1/Gp;this.scale(GC,GC)}this._clipPoint&&Gc.restore(),this._startX=Gf,this._startY=Gk},Ga.drawUnderline=function(Ga,Gb,Gc,Gd){var Ge=this._lineWidths[Gd];switch(Ga){case"center":Gb-=Ge/2;break;case"right":Gb-=Ge}Gc+=this._charSize.height,this._graphics.drawLine(Gb,Gc,Gb+Ge,Gc,this.underlineColor||this.color,1)},Ga.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);GO.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new GA(0,0)):this._clipPoint=null;var Ga=this._lines.length;if(this.overflow!=Gp.VISIBLE){var Gb=this.overflow==Gp.HIDDEN?Math.floor:Math.ceil;Ga=Math.min(Ga,Gb((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var Gc=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(Gc,Ga),this.repaint()},Ga.evalTextSize=function(){var Ga,Gb=NaN;Ga=Math.max.apply(this,this._lineWidths),Gb=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],Ga==this._textWidth&&Gb==this._textHeight||(this._textWidth=Ga,this._textHeight=Gb,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},Ga.checkEnabledViewportOrNot=function(){return this.overflow==Gp.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},Ga.changeText=function(Ga){this._text!==Ga&&(this.lang(Ga+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},Ga.parseLines=function(Ga){var Gb=this.wordWrap||this.overflow==Gp.HIDDEN;if(Gb)var Gc=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var Gd=GO.context.measureText(Gp._testWord);GJ.isConchApp&&0===Gd.width&&0===Gd.height&&(Gd=GO.context.measureText("W")),this._charSize.width=Gd.width,this._charSize.height=Gd.height||this.fontSize}for(var Ge=Ga.replace(/\r\n/g,"\n").split("\n"),Gf=0,Gg=Ge.length;Gf<Gg;Gf++){var Gh=Ge[Gf];Gb?this.parseLine(Gh,Gc):(this._lineWidths.push(this.getTextWidth(Gh)),this._lines.push(Gh))}},Ga.parseLine=function(Ga,Gb){GO.context;var Gc,Gd=this._lines,Ge=0,Gf=NaN,Gg=NaN,Gh=0;if((Gf=this.getTextWidth(Ga))<=Gb)return Gd.push(Ga),void this._lineWidths.push(Gf);Gf=this._charSize.width,0==(Ge=Math.floor(Gb/Gf))&&(Ge=1),Gg=Gf=this.getTextWidth(Ga.substring(0,Ge));for(var Gi=Ge,Gj=Ga.length;Gi<Gj;Gi++)if(Gb<(Gg+=Gf=this.getTextWidth(Ga.charAt(Gi))))if(this.wordWrap){var Gk=Ga.substring(Gh,Gi);if(Gk.charCodeAt(Gk.length-1)<255?(Gc=/(?:\w|-)+$/.exec(Gk))&&(Gi=Gc.index+Gh,0==Gc.index?Gi+=Gk.length:Gk=Ga.substring(Gh,Gi)):Gp.RightToLeft&&(Gc=/([\u0600-\u06FF])+$/.exec(Gk))&&(Gi=Gc.index+Gh,0==Gc.index?Gi+=Gk.length:Gk=Ga.substring(Gh,Gi)),Gd.push(Gk),this._lineWidths.push(Gg-Gf),!((Gh=Gi)+Ge<Gj)){Gd.push(Ga.substring(Gh,Gj)),this._lineWidths.push(this.getTextWidth(Gd[Gd.length-1])),Gh=-1;break}Gi+=Ge,Gg=Gf=this.getTextWidth(Ga.substring(Gh,Gi)),Gi--}else if(this.overflow==Gp.HIDDEN)return Gd.push(Ga.substring(0,Gi)),void this._lineWidths.push(this.getTextWidth(Gd[Gd.length-1]));this.wordWrap&&-1!=Gh&&(Gd.push(Ga.substring(Gh,Gj)),this._lineWidths.push(this.getTextWidth(Gd[Gd.length-1])))},Ga.getTextWidth=function(Ga){return this._currBitmapFont?this._currBitmapFont.getTextWidth(Ga):GO.context.measureText(Ga).width},Ga.getWordWrapWidth=function(){var Ga=this.padding,Gb=NaN;return(Gb=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(Gb=this.wordWrap?100:GO.width),Gb<=0&&(Gb=100),Gb-Ga[3]-Ga[1]},Ga.getCharPoint=function(Ga,Gb){this._isChanged&&Gz.timer.runCallLater(this,this.typeset);for(var Gc=0,Gd=this._lines,Ge=0,Gf=0,Gg=Gd.length;Gf<Gg;Gf++){if(Ga<(Gc+=Gd[Gf].length)){var Gh=Gf;break}Ge=Gc}var Gi=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;GO.context.font=Gi;var Gj=this.getTextWidth(this._text.substring(Ge,Ga));return(Gb||new GA).setTo(this._startX+Gj-(this._clipPoint?this._clipPoint.x:0),this._startY+Gh*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},Gk(0,Ga,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(Ga){Ga!=this._width&&(Gz.superSet(Gla,this,"width",Ga),this.isChanged=!0)}),Gk(0,Ga,"textWidth",function(){return this._isChanged&&Gz.timer.runCallLater(this,this.typeset),this._textWidth}),Gk(0,Ga,"height",function(){return this._height?this._height:this.textHeight},function(Ga){Ga!=this._height&&(Gz.superSet(Gla,this,"height",Ga),this.isChanged=!0)}),Gk(0,Ga,"textHeight",function(){return this._isChanged&&Gz.timer.runCallLater(this,this.typeset),this._textHeight}),Gk(0,Ga,"padding",function(){return this._getCSSStyle().padding},function(Ga){this._getCSSStyle().padding=Ga,this.isChanged=!0}),Gk(0,Ga,"bold",function(){return this._getCSSStyle().bold},function(Ga){this._getCSSStyle().bold=Ga,this.isChanged=!0}),Gk(0,Ga,"text",function(){return this._text||""},function(Ga){this._text!==Ga&&(this.lang(Ga+""),this.isChanged=!0,this.event("change"))}),Gk(0,Ga,"color",function(){return this._getCSSStyle().color},function(Ga){this._getCSSStyle().color!=Ga&&(this._getCSSStyle().color=Ga,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),Gk(0,Ga,"font",function(){return this._getCSSStyle().fontFamily},function(Ga){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),Gp._bitmapFonts&&Gp._bitmapFonts[Ga]&&(this._currBitmapFont=Gp._bitmapFonts[Ga]),this._getCSSStyle().fontFamily=Ga,this.isChanged=!0}),Gk(0,Ga,"fontSize",function(){return this._getCSSStyle().fontSize},function(Ga){this._getCSSStyle().fontSize=Ga,this.isChanged=!0}),Gk(0,Ga,"italic",function(){return this._getCSSStyle().italic},function(Ga){this._getCSSStyle().italic=Ga,this.isChanged=!0}),Gk(0,Ga,"align",function(){return this._getCSSStyle().align},function(Ga){this._getCSSStyle().align=Ga,this.isChanged=!0}),Gk(0,Ga,"valign",function(){return this._getCSSStyle().valign},function(Ga){this._getCSSStyle().valign=Ga,this.isChanged=!0}),Gk(0,Ga,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(Ga){this._getCSSStyle().wordWrap=Ga,this.isChanged=!0}),Gk(0,Ga,"leading",function(){return this._getCSSStyle().leading},function(Ga){this._getCSSStyle().leading=Ga,this.isChanged=!0}),Gk(0,Ga,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(Ga){this._getCSSStyle().backgroundColor=Ga,this.isChanged=!0}),Gk(0,Ga,"borderColor",function(){return this._getCSSStyle().borderColor},function(Ga){this._getCSSStyle().borderColor=Ga,this.isChanged=!0}),Gk(0,Ga,"stroke",function(){return this._getCSSStyle().stroke},function(Ga){this._getCSSStyle().stroke=Ga,this.isChanged=!0}),Gk(0,Ga,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(Ga){this._getCSSStyle().strokeColor=Ga,this.isChanged=!0}),Gk(0,Ga,"isChanged",null,function(Ga){this._isChanged!==Ga&&(this._isChanged=Ga)&&Gz.timer.callLater(this,this.typeset)}),Gk(0,Ga,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(Ga){if(!(this.overflow!=Gp.SCROLL||this.textWidth<this._width)&&this._clipPoint){Ga=Ga<this.padding[3]?this.padding[3]:Ga;var Gb=this._textWidth-this._width;Ga=Gb<Ga?Gb:Ga;var Gc=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=Ga,this.renderText(this._lastVisibleLineIndex,Gc)}}),Gk(0,Ga,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(Ga){if(!(this.overflow!=Gp.SCROLL||this.textHeight<this._height)&&this._clipPoint){Ga=Ga<this.padding[0]?this.padding[0]:Ga;var Gb=this._textHeight-this._height,Gc=(Ga=Gb<Ga?Gb:Ga)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=Gc;var Gd=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=Ga,this.renderText(Gc,Gd)}}),Gk(0,Ga,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),Gk(0,Ga,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),Gk(0,Ga,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),Gk(0,Ga,"underlineColor",function(){return this._underlineColor},function(Ga){this._underlineColor=Ga,this._isChanged=!0,this.typeset()}),Gp.registerBitmapFont=function(Ga,Gb){Gp._bitmapFonts||(Gp._bitmapFonts={}),Gp._bitmapFonts[Ga]=Gb},Gp.unregisterBitmapFont=function(Ga,Gb){if(void 0===Gb&&(Gb=!0),Gp._bitmapFonts&&Gp._bitmapFonts[Ga]){var Gc=Gp._bitmapFonts[Ga];Gb&&Gc.destroy(),delete Gp._bitmapFonts[Ga]}},Gp.setTextRightToLeft=function(){var Ga;(Ga=GO.canvas.source.style).display="none",Ga.position="absolute",Ga.direction="rtl",GJ._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,GO.document.body.appendChild(GO.canvas.source)},Gp.supportFont=function(Ga){GO.context.font="10px sans-serif";var Gb=GO.context.measureText("abcji").width;GO.context.font="10px "+Ga;var Gc=GO.context.measureText("abcji").width;return console.log(Gb,Gc),Gb!==Gc},Gp._testWord="游",Gp.langPacks=null,Gp.VISIBLE="visible",Gp.SCROLL="scroll",Gp.HIDDEN="hidden",Gp.CharacterCache=!0,Gp.RightToLeft=!1,Gp._bitmapFonts=null,Gi(Gp,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),Gp}(Gla),Gta=function(Gl){function Gg(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",Gg.__super.call(this),this.offset=new GA,this._canvasTransform=new GG,this._previousOrientation=GO.window.orientation;var Gb=this;this.transform=GG.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var Ga=GO.window,Gc=this;Ga.addEventListener("focus",function(){Gb._isFocused=!0,Gc.event("focus"),Gc.event("focuschange")}),Ga.addEventListener("blur",function(){Gb._isFocused=!1,Gc.event("blur"),Gc.event("focuschange"),Gc._isInputting()&&(Gxa.inputElement.target.focus=!1)});var Gd="visibilityState",Ge="visibilitychange",Gf=Ga.document;void 0!==Gf.hidden?(Ge="visibilitychange",Gd="visibilityState"):void 0!==Gf.mozHidden?(Ge="mozvisibilitychange",Gd="mozVisibilityState"):void 0!==Gf.msHidden?(Ge="msvisibilitychange",Gd="msVisibilityState"):void 0!==Gf.webkitHidden&&(Ge="webkitvisibilitychange",Gd="webkitVisibilityState"),Ga.document.addEventListener(Ge,function(){"hidden"==GO.document[Gd]?Gc._setStageVisible(!1):Gc._setStageVisible(!0)}),Ga.document.addEventListener("qbrowserVisibilityChange",function(Ga){Gc._setStageVisible(!Ga.hidden)}),Ga.addEventListener("resize",function(){var Ga=GO.window.orientation;null!=Ga&&Ga!=Gb._previousOrientation&&Gc._isInputting()&&(Gxa.inputElement.target.focus=!1),Gb._previousOrientation=Ga,Gc._isInputting()||Gc._resetCanvas()}),Ga.addEventListener("orientationchange",function(Ga){Gc._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),GO.onMobile&&this.on("mousedown",this,this._onmouseMove)}Gr(Gg,"laya.display.Stage",Gl);var Ga=Gg.prototype;return Ga._setStageVisible=function(Ga){this._isVisibility!=Ga&&(this._isVisibility=Ga,this._isVisibility||this._isInputting()&&(Gxa.inputElement.target.focus=!1),this.event("visibilitychange"))},Ga._isInputting=function(){return GO.onMobile&&Gxa.isInputting},Ga._changeCanvasSize=function(){this.setScreenSize(GO.clientWidth*GO.pixelRatio,GO.clientHeight*GO.pixelRatio)},Ga._resetCanvas=function(){if(this.screenAdaptationEnabled){var Ga=GJ._mainCanvas;Ga.source.style;Ga.size(1,1),Gz.timer.once(100,this,this._changeCanvasSize)}},Ga.setScreenSize=function(Ga,Gb){var Gc=!1;if("none"!==this._screenMode&&(Gc=(Ga/Gb<1?"vertical":"horizontal")!==this._screenMode)){var Gd=Gb;Gb=Ga,Ga=Gd}this.canvasRotation=Gc;var Ge=GJ._mainCanvas,Gf=Ge.source.style,Gg=this._canvasTransform.identity(),Gh=this._scaleMode,Gi=Ga/this.designWidth,Gj=Gb/this.designHeight,Gk=this.designWidth,Gl=this.designHeight,Go=Ga,Gp=Gb,Gq=GO.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,Gh){case"noscale":Gi=Gj=1,Go=this.designWidth,Gp=this.designHeight;break;case"showall":Gi=Gj=Math.min(Gi,Gj),Gk=Go=Math.round(this.designWidth*Gi),Gl=Gp=Math.round(this.designHeight*Gj);break;case"noborder":Gi=Gj=Math.max(Gi,Gj),Go=Math.round(this.designWidth*Gi),Gp=Math.round(this.designHeight*Gj);break;case"full":Gi=Gj=1,this._width=Gk=Ga,this._height=Gl=Gb;break;case"fixedwidth":Gj=Gi,this._height=Gl=Math.round(Gb/Gi);break;case"fixedheight":Gi=Gj,this._width=Gk=Math.round(Ga/Gj);break;case"fixedauto":Ga/Gb<this.designWidth/this.designHeight?(Gj=Gi,this._height=Gl=Math.round(Gb/Gi)):(Gi=Gj,this._width=Gk=Math.round(Ga/Gj))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,Gk=Gk+1&2147483646,Gl=Gl+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),Gi*=this.scaleX,Gj*=this.scaleY,1===Gi&&1===Gj?this.transform.identity():(this.transform.a=this._formatData(Gi/(Go/Gk)),this.transform.d=this._formatData(Gj/(Gp/Gl)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),Ge.size(Gk,Gl),GF.changeWebGLSize(Gk,Gl),Gg.scale(Go/Gk/Gq,Gp/Gl/Gq),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(Ga-Go)/Gq:this.offset.x=.5*(Ga-Go)/Gq,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(Gb-Gp)/Gq:this.offset.y=.5*(Gb-Gp)/Gq,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),Gg.translate(this.offset.x,this.offset.y),this.canvasDegree=0,Gc&&("horizontal"===this._screenMode?(Gg.rotate(Math.PI/2),Gg.translate(Gb/Gq,0),this.canvasDegree=90):(Gg.rotate(-Math.PI/2),Gg.translate(0,Ga/Gq),this.canvasDegree=-90)),Gg.a=this._formatData(Gg.a),Gg.d=this._formatData(Gg.d),Gg.tx=this._formatData(Gg.tx),Gg.ty=this._formatData(Gg.ty),Gf.transformOrigin=Gf.webkitTransformOrigin=Gf.msTransformOrigin=Gf.mozTransformOrigin=Gf.oTransformOrigin="0px 0px 0px",Gf.transform=Gf.webkitTransform=Gf.msTransform=Gf.mozTransform=Gf.oTransform="matrix("+Gg.toString()+")",Gg.translate(parseInt(Gf.left)||0,parseInt(Gf.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},Ga._formatData=function(Ga){return Math.abs(Ga)<1e-6?0:Math.abs(1-Ga)<.001?0<Ga?1:-1:Ga},Ga.getMousePoint=function(){return GA.TEMP.setTo(this.mouseX,this.mouseY)},Ga.repaint=function(){this._repaint=1},Ga.parentRepaint=function(){},Ga._loop=function(){return this.render(GJ.context,0,0),!0},Ga._onmouseMove=function(Ga){this._mouseMoveTime=GO.now()},Ga.getTimeFromFrameStart=function(){return GO.now()-this._frameStartTime},Ga.render=function(Ga,Gb,Gc){if("sleep"===this._frameRate&&!GJ.isConchApp){var Gd=GO.now();if(!(1e3<=Gd-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(GX.loopCount++,Gq.instance.runEvent(),Gz.timer._update()));this._frameStartTime=Gd}if(this._renderCount++,GJ.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=GO.now();var Ge="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),Gf=this._renderCount%2==0;if(GX.renderSlow=!Ge,Ge||Gf||GJ.isConchApp){var Gg;GX.loopCount++,Gq.instance.runEvent(),Gz.timer._update(),GF.update3DLoop();var Gh=0,Gi=0;if(GJ.isConchNode)for(Gh=0,Gi=this._scenes.length;Gh<Gi;Gh++)(Gg=this._scenes[Gh])&&Gg._updateSceneConch();else for(Gh=0,Gi=this._scenes.length;Gh<Gi;Gh++)(Gg=this._scenes[Gh])&&Gg._updateScene();if(GJ.isConchNode){var Gj=Gla.CustomList;for(Gh=0,Gi=Gj.length;Gh<Gi;Gh++){var Gk=Gj[Gh];Gk.customRender(Gk.customContext,0,0)}return}}GJ.isConchNode||this.renderingEnabled&&(Ge||!Gf||GJ.isConchWebGL)&&(GJ.isWebGL?GJ.WebGL.mainContext&&!GJ.WebGL.mainContext.isContextLost()&&(Ga.clear(),Gl.prototype.render.call(this,Ga,Gb,Gc),GX._show&&GX._sp&&GX._sp.render(Ga,Gb,Gc),GF.clear(this._bgColor),GF.beginFlush(),Ga.flush(),GF.endFinish(),G_.instance&&G_.getInstance().endDispose()):(GF.clear(this._bgColor),Gl.prototype.render.call(this,Ga,Gb,Gc),GX._show&&GX._sp&&GX._sp.render(Ga,Gb,Gc)))}else this._renderCount%5==0&&(GX.loopCount++,Gq.instance.runEvent(),Gz.timer._update())},Ga._requestFullscreen=function(){var Ga=GO.document.documentElement;Ga.requestFullscreen?Ga.requestFullscreen():Ga.mozRequestFullScreen?Ga.mozRequestFullScreen():Ga.webkitRequestFullscreen?Ga.webkitRequestFullscreen():Ga.msRequestFullscreen&&Ga.msRequestFullscreen()},Ga._fullScreenChanged=function(){Gz.stage.event("fullscreenchange")},Ga.exitFullscreen=function(){var Ga=GO.document;Ga.exitFullscreen?Ga.exitFullscreen():Ga.mozCancelFullScreen?Ga.mozCancelFullScreen():Ga.webkitExitFullscreen&&Ga.webkitExitFullscreen()},Gk(0,Ga,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),Gk(0,Ga,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),Gk(0,Ga,"frameRate",function(){return this._frameRate},function(Ga){if(this._frameRate=Ga,GJ.isConchApp)switch(this._frameRate){case"slow":GO.window.conch&&GO.window.conchConfig.setSlowFrame&&GO.window.conchConfig.setSlowFrame(!0);break;case"fast":GO.window.conch&&GO.window.conchConfig.setSlowFrame&&GO.window.conchConfig.setSlowFrame(!1);break;case"mouse":GO.window.conch&&GO.window.conchConfig.setMouseFrame&&GO.window.conchConfig.setMouseFrame(2e3);break;case"sleep":GO.window.conch&&GO.window.conchConfig.setLimitFPS&&GO.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),Gk(0,Ga,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),Gk(0,Ga,"width",Gl.prototype._$get_width,function(Ga){this.designWidth=Ga,Gz.superSet(Gla,this,"width",Ga),Gz.timer.callLater(this,this._changeCanvasSize)}),Gk(0,Ga,"alignH",function(){return this._alignH},function(Ga){this._alignH=Ga,Gz.timer.callLater(this,this._changeCanvasSize)}),Gk(0,Ga,"isFocused",function(){return this._isFocused}),Gk(0,Ga,"height",Gl.prototype._$get_height,function(Ga){this.designHeight=Ga,Gz.superSet(Gla,this,"height",Ga),Gz.timer.callLater(this,this._changeCanvasSize)}),Gk(0,Ga,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||GG.create()},Gl.prototype._$set_transform),Gk(0,Ga,"isVisibility",function(){return this._isVisibility}),Gk(0,Ga,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),Gk(0,Ga,"scaleMode",function(){return this._scaleMode},function(Ga){this._scaleMode=Ga,Gz.timer.callLater(this,this._changeCanvasSize)}),Gk(0,Ga,"alignV",function(){return this._alignV},function(Ga){this._alignV=Ga,Gz.timer.callLater(this,this._changeCanvasSize)}),Gk(0,Ga,"bgColor",function(){return this._bgColor},function(Ga){this._bgColor=Ga,this.conchModel&&this.conchModel.bgColor(Ga),GJ.isWebGL&&(Ga?Gg._wgColor=GS.create(Ga)._color:GO.onMiniGame||(Gg._wgColor=null)),GO.onLimixiu?Gg._wgColor=GS.create(Ga)._color:GJ.canvas.style.background=Ga||"none"}),Gk(0,Ga,"mouseX",function(){return Math.round(Gq.instance.mouseX/this.clientScaleX)}),Gk(0,Ga,"mouseY",function(){return Math.round(Gq.instance.mouseY/this.clientScaleY)}),Gk(0,Ga,"screenMode",function(){return this._screenMode},function(Ga){this._screenMode=Ga}),Gk(0,Ga,"visible",Gl.prototype._$get_visible,function(Ga){this.visible!==Ga&&(Gz.superSet(Gla,this,"visible",Ga),GJ._mainCanvas.source.style.visibility=Ga?"visible":"hidden")}),Gk(0,Ga,"fullScreenEnabled",null,function(Ga){var Gb=GO.document,Gc=GJ.canvas;Ga?(Gc.addEventListener("mousedown",this._requestFullscreen),Gc.addEventListener("touchstart",this._requestFullscreen),Gb.addEventListener("fullscreenchange",this._fullScreenChanged),Gb.addEventListener("mozfullscreenchange",this._fullScreenChanged),Gb.addEventListener("webkitfullscreenchange",this._fullScreenChanged),Gb.addEventListener("msfullscreenchange",this._fullScreenChanged)):(Gc.removeEventListener("mousedown",this._requestFullscreen),Gc.removeEventListener("touchstart",this._requestFullscreen),Gb.removeEventListener("fullscreenchange",this._fullScreenChanged),Gb.removeEventListener("mozfullscreenchange",this._fullScreenChanged),Gb.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),Gb.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),Gg.SCALE_NOSCALE="noscale",Gg.SCALE_EXACTFIT="exactfit",Gg.SCALE_SHOWALL="showall",Gg.SCALE_NOBORDER="noborder",Gg.SCALE_FULL="full",Gg.SCALE_FIXED_WIDTH="fixedwidth",Gg.SCALE_FIXED_HEIGHT="fixedheight",Gg.SCALE_FIXED_AUTO="fixedauto",Gg.ALIGN_LEFT="left",Gg.ALIGN_RIGHT="right",Gg.ALIGN_CENTER="center",Gg.ALIGN_TOP="top",Gg.ALIGN_MIDDLE="middle",Gg.ALIGN_BOTTOM="bottom",Gg.SCREEN_NONE="none",Gg.SCREEN_HORIZONTAL="horizontal",Gg.SCREEN_VERTICAL="vertical",Gg.FRAME_FAST="fast",Gg.FRAME_SLOW="slow",Gg.FRAME_MOUSE="mouse",Gg.FRAME_SLEEP="sleep",Gg.FRAME_MOUSE_THREDHOLD=2e3,Gi(Gg,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),Gg}(Gla),Gua=(function(Ga){function Gb(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,Gb.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}Gr(Gb,"laya.media.SoundNode",Gla);var Gc=Gb.prototype;Gc._onParentChange=function(){this.target=this.parent},Gc.play=function(Ga,Gb){void 0===Ga&&(Ga=1),isNaN(Ga)&&(Ga=1),this.url&&(this.stop(),this._channel=GE.playSound(this.url,Ga,null,Gb))},Gc.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},Gc._setPlayAction=function(Ga,Gb,Gc,Gd){void 0===Gd&&(Gd=!0),this[Gc]&&Ga&&(Gd?Ga.on(Gb,this,this[Gc]):Ga.off(Gb,this,this[Gc]))},Gc._setPlayActions=function(Ga,Gb,Gc,Gd){if(void 0===Gd&&(Gd=!0),Ga&&Gb){var Ge,Gf=Gb.split(","),Gg=0;for(Ge=Gf.length,Gg=0;Gg<Ge;Gg++)this._setPlayAction(Ga,Gf[Gg],Gc,Gd)}},Gk(0,Gc,"playEvent",null,function(Ga){(this._playEvents=Ga)&&this._tar&&this._setPlayActions(this._tar,Ga,"play")}),Gk(0,Gc,"target",null,function(Ga){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=Ga,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),Gk(0,Gc,"stopEvent",null,function(Ga){(this._stopEvents=Ga)&&this._tar&&this._setPlayActions(this._tar,Ga,"stop")})}(),function(Ga){function Gb(){this._src=null,this._onload=null,this._onerror=null,Gb.__super.call(this)}Gr(Gb,"laya.resource.FileBitmap",Gqa);var Gc=Gb.prototype;return Gk(0,Gc,"src",function(){return this._src},function(Ga){this._src=Ga}),Gk(0,Gc,"onload",null,function(Ga){}),Gk(0,Gc,"onerror",null,function(Ga){}),Gb}()),Gva=function(Ga){function Gc(Ga,Gb){this._is2D=!1,Gc.__super.call(this);var Gd=this;if(this._source=this,"2D"===Ga||"AUTO"===Ga&&!GJ.isWebGL){this._is2D=!0,this._source=Gb||GO.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var Ge=this;Ge.getContext=function(Ga,Gb){if(Gd._ctx)return Gd._ctx;var Gc=Gd._ctx=Gd._source.getContext(Ga,Gb);return Gc&&(Gc._canvas=Ge,GJ.isFlash||GO.onLimixiu||(Gc.size=function(Ga,Gb){})),Gc}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}Gr(Gc,"laya.resource.HTMLCanvas",Gqa);var Gb=Gc.prototype;return Gb.clear=function(){this._ctx&&this._ctx.clear()},Gb.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},Gb.release=function(){},Gb._setContext=function(Ga){this._ctx=Ga},Gb.getContext=function(Ga,Gb){return this._ctx?this._ctx:this._ctx=Gc._createContext(this)},Gb.getMemSize=function(){return 0},Gb.size=function(Ga,Gb){(this._w!=Ga||this._h!=Gb||this._source&&(this._source.width!=Ga||this._source.height!=Gb))&&(this._w=Ga,this._h=Gb,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(Ga,Gb),this._source&&(this._source.height=Gb,this._source.width=Ga))},Gb.getCanvas=function(){return this._source},Gb.toBase64=function(Ga,Gb,Gc){if(this._source)if(GJ.isConchApp&&this._source.toBase64)this._source.toBase64(Ga,Gb,Gc);else{var Gd=this._source.toDataURL(Ga,Gb);Gc.call(this,Gd)}},Gk(0,Gb,"context",function(){return this._ctx}),Gk(0,Gb,"asBitmap",null,function(Ga){}),Gc.create=function(Ga,Gb){return new Gc(Ga,Gb)},Gc.TYPE2D="2D",Gc.TYPE3D="3D",Gc.TYPEAUTO="AUTO",Gc._createContext=null,Gc}(),Gwa=(function(Ga){function Gi(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){throw Gi.__super.call(this),new Error("不允许new！")}Gr(Gi,"laya.resource.HTMLSubImage",Gqa),Gi.create=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){return void 0===Gh&&(Gh=!1),new Gi(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh)}}(),function(Ga){function Gl(){this._frames=null,this._url=null,Gl.__super.call(this),this._setControlNode(this)}Gr(Gl,"laya.display.Animation",Ga);var Gb=Gl.prototype;Gb.destroy=function(Ga){void 0===Ga&&(Ga=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,Ga),this._frames=null,this._labels=null},Gb.play=function(Ga,Gb,Gc,Gd){void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=!0),void 0===Gc&&(Gc=""),void 0===Gd&&(Gd=!0),Gc&&this._setFramesFromCache(Gc,Gd),this._isPlaying=!0,this.index="string"==typeof Ga?this._getFrameByLabel(Ga):Ga,this.loop=Gb,this._actionName=Gc,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},Gb._setFramesFromCache=function(Ga,Gb){var Gc;return void 0===Gb&&(Gb=!1),this._url&&(Ga=this._url+"#"+Ga),Ga&&Gl.framesMap[Ga]?((Gc=Gl.framesMap[Ga])instanceof Array?(this._frames=Gl.framesMap[Ga],this._count=this._frames.length):(Gc.nodeRoot&&(Gl.framesMap[Ga]=this._parseGraphicAnimationByData(Gc),Gc=Gl.framesMap[Ga]),this._frames=Gc.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=Gc.interval),this._labels=this._copyLabels(Gc.labels)),!0):(Gb&&console.log("ani not found:",Ga),!1)},Gb._copyLabels=function(Ga){if(!Ga)return null;var Gb,Gc;for(Gc in Gb={},Ga)Gb[Gc]=G$.copyArray([],Ga[Gc]);return Gb},Gb._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&Ga.prototype._frameLoop.call(this)},Gb._displayToIndex=function(Ga){this._frames&&(this.graphics=this._frames[Ga])},Gb.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},Gb.loadImages=function(Ga,Gb){return void 0===Gb&&(Gb=""),this._url="",this._setFramesFromCache(Gb)||(this.frames=Gl.framesMap[Gb]?Gl.framesMap[Gb]:Gl.createFrames(Ga,Gb)),this},Gb.loadAtlas=function(Gb,Gc,Gd){void 0===Gd&&(Gd=""),this._url="";var Ge=this;function Ga(Ga){Gb===Ga&&(Ge.frames=Gl.framesMap[Gd]?Gl.framesMap[Gd]:Gl.createFrames(Gb,Gd),Gc&&Gc.run())}return Ge._setFramesFromCache(Gd)||(Gha.getAtlas(Gb)?Ga(Gb):Gz.loader.load(Gb,Gu.create(null,Ga,[Gb]),null,"atlas")),this},Gb.loadAnimation=function(Ga,Gb,Gc){this._url=Ga;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,Gb&&Gb.run()):!Gc||Gha.getAtlas(Gc)?this._loadAnimationData(Ga,Gb,Gc):Gz.loader.load(Gc,Gu.create(this,this._loadAnimationData,[Ga,Gb,Gc]),null,"atlas"),this},Gb._loadAnimationData=function(Gh,Gi,Ga){var Gj=this;if(!Ga||Gha.getAtlas(Ga)){var Gk=this;Gha.getRes(Gh)?Gb(Gh):Gz.loader.load(Gh,Gu.create(null,Gb,[Gh]),null,"json"),Gha.clearRes(Gh)}else console.warn("atlas load fail:"+Ga);function Gb(Ga){if(Gha.getRes(Ga)&&Gh===Ga){var Gb;if(Gl.framesMap[Gh+"#"])Gk._setFramesFromCache(Gj._actionName,!0),Gj.index=0,Gj._checkResumePlaying();else{var Gc=Gk._parseGraphicAnimation(Gha.getRes(Gh));if(!Gc)return;var Gd,Ge=Gc.animationList,Gf=0,Gg=Ge.length;for(Gf=0;Gf<Gg;Gf++)Gb=Ge[Gf],Gl.framesMap[Gh+"#"+Gb.name]=Gb,Gd||(Gd=Gb);Gd&&(Gl.framesMap[Gh+"#"]=Gd,Gk._setFramesFromCache(Gj._actionName,!0),Gj.index=0),Gj._checkResumePlaying()}Gi&&Gi.run()}}},Gb._parseGraphicAnimation=function(Ga){return Gza.parseAnimationData(Ga)},Gb._parseGraphicAnimationByData=function(Ga){return Gza.parseAnimationByData(Ga)},Gk(0,Gb,"frames",function(){return this._frames},function(Ga){(this._frames=Ga)&&(this._count=Ga.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),Gk(0,Gb,"autoPlay",null,function(Ga){Ga?this.play():this.stop()}),Gk(0,Gb,"source",null,function(Ga){-1<Ga.indexOf(".ani")?this.loadAnimation(Ga):-1<Ga.indexOf(".json")||-1<Ga.indexOf("als")||-1<Ga.indexOf("atlas")?this.loadAtlas(Ga):this.loadImages(Ga.split(","))}),Gk(0,Gb,"autoAnimation",null,function(Ga){this.play(0,!0,Ga,!1)}),Gl.createFrames=function(Ga,Gb){var Gc,Gd,Ge=0,Gf=0;if("string"==typeof Ga){var Gg=Gha.getAtlas(Ga);if(Gg&&Gg.length)for(Gc=[],Ge=0,Gf=Gg.length;Ge<Gf;Ge++)(Gd=new GF.createGraphics).drawTexture(Gha.getRes(Gg[Ge]),0,0),Gc.push(Gd)}else if(Ga instanceof Array)for(Gc=[],Ge=0,Gf=Ga.length;Ge<Gf;Ge++)(Gd=new GF.createGraphics).loadImage(Ga[Ge],0,0),Gc.push(Gd);return Gb&&(Gl.framesMap[Gb]=Gc),Gc},Gl.clearCache=function(Ga){var Gb,Gc=Gl.framesMap,Gd=Ga+"#";for(Gb in Gc)Gb!==Ga&&0!=Gb.indexOf(Gd)||delete Gl.framesMap[Gb]},Gl.framesMap={}}(Gra),function(Ga){function Gf(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,Gf.__super.call(this),null==Gf._sortIndexFun&&(Gf._sortIndexFun=Gy.sortByKey("index",!1,!0))}Gr(Gf,"laya.display.FrameAnimation",Ga);var Gb=Gf.prototype;return Gb._setUp=function(Ga,Gb){this._labels=null,this._animationNewFrames=null,this._targetDic=Ga,this._animationData=Gb,this.interval=1e3/Gb.frameRate,Gb.parsed?(this._count=Gb.count,this._labels=Gb.labels,this._animationNewFrames=Gb.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),Gb.parsed=!0,Gb.labels=this._labels,Gb.count=this._count,Gb.animationNewFrames=this._animationNewFrames},Gb.clear=function(){Ga.prototype.clear.call(this),this._targetDic=null,this._animationData=null},Gb._displayToIndex=function(Ga){if(this._animationData){Ga<0&&(Ga=0),Ga>this._count&&(Ga=this._count);var Gb=this._animationData.nodes,Gc=0,Gd=Gb.length;for(Gc=0;Gc<Gd;Gc++)this._displayNodeToFrame(Gb[Gc],Ga)}},Gb._displayNodeToFrame=function(Ga,Gb,Gc){Gc||(Gc=this._targetDic);var Gd=Gc[Ga.target];if(Gd){var Ge,Gf,Gg,Gh=Ga.frames,Gi=Ga.keys,Gj=0,Gk=Gi.length;for(Gj=0;Gj<Gk;Gj++)Gg=(Gf=Gh[Ge=Gi[Gj]]).length>Gb?Gf[Gb]:Gf[Gf.length-1],Gd[Ge]=Gg}},Gb._calculateDatas=function(){if(this._animationData){var Ga,Gb=this._animationData.nodes,Gc=0,Gd=Gb.length;for(Gc=this._count=0;Gc<Gd;Gc++)Ga=Gb[Gc],this._calculateNodeKeyFrames(Ga);this._count+=1}},Gb._calculateNodeKeyFrames=function(Ga){var Gb,Gc,Gd=Ga.keyframes,Ge=Ga.target;for(Gb in Ga.frames||(Ga.frames={}),Ga.keys?Ga.keys.length=0:Ga.keys=[],Ga.initValues||(Ga.initValues={}),Gd)Gc=Gd[Gb],Ga.frames[Gb]||(Ga.frames[Gb]=[]),this._targetDic&&this._targetDic[Ge]&&(Ga.initValues[Gb]=this._targetDic[Ge][Gb]),Gc.sort(Gf._sortIndexFun),Ga.keys.push(Gb),this._calculateNodePropFrames(Gc,Ga.frames[Gb],Gb,Ge)},Gb.resetToInitState=function(){if(this._targetDic&&this._animationData){var Ga,Gb,Gc=this._animationData.nodes,Gd=0,Ge=Gc.length;for(Gd=0;Gd<Ge;Gd++)if(Gb=(Ga=Gc[Gd]).initValues){var Gf,Gg=this._targetDic[Ga.target];if(Gg)for(Gf in Gb)Gg[Gf]=Gb[Gf]}}},Gb._calculateNodePropFrames=function(Ga,Gb,Gc,Gd){var Ge=0,Gf=Ga.length-1;if(0<Gf){for(Gb.length=Ga[Gf].index+1,Ge=0;Ge<Gf;Ge++)this._dealKeyFrame(Ga[Ge]),this._calculateFrameValues(Ga[Ge],Ga[Ge+1],Gb);this._dealKeyFrame(Ga[Ge])}0==Gf&&(Gb[Ga[0].index]=Ga[0].value,this._animationNewFrames&&(this._animationNewFrames[Ga[0].index]=!0))},Gb._dealKeyFrame=function(Ga){Ga.label&&""!=Ga.label&&this.addLabel(Ga.label,Ga.index)},Gb._calculateFrameValues=function(Ga,Gb,Gc){var Gd,Ge=0,Gf=Ga.index,Gg=Gb.index,Gh=Ga.value,Gi=Gb.value-Ga.value,Gj=Gg-Gf;if(Gg>this._count&&(this._count=Gg),Ga.tween)for(null==(Gd=GU[Ga.tweenMethod])&&(Gd=GU.linearNone),Ge=Gf;Ge<Gg;Ge++)Gc[Ge]=Gd(Ge-Gf,Gh,Gi,Gj),this._animationNewFrames&&(this._animationNewFrames[Ge]=!0);else for(Ge=Gf;Ge<Gg;Ge++)Gc[Ge]=Gh;this._animationNewFrames&&(this._animationNewFrames[Ga.index]=!0,this._animationNewFrames[Gb.index]=!0),Gc[Gb.index]=Gb.value},Gf._sortIndexFun=null,Gf}(Gra)),Gxa=function(Gb){function Ge(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",Ge.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=Gsa.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}Gr(Ge,"laya.display.Input",Gb);var Ga=Ge.prototype;return Ga.setSelection=function(Ga,Gb){this.focus=!0,laya.display.Input.inputElement.selectionStart=Ga,laya.display.Input.inputElement.selectionEnd=Gb},Ga._onUnDisplay=function(Ga){this.focus=!1},Ga._onMouseDown=function(Ga){this.focus=!0},Ga._syncInputTransform=function(){var Ga=this.nativeInput,Gb=G$.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),Gc=this._width-this.padding[1]-this.padding[3],Gd=this._height-this.padding[0]-this.padding[2];GJ.isConchApp?(Ga.setScale(Gb.scaleX,Gb.scaleY),Ga.setSize(Gc,Gd),Ga.setPos(Gb.x,Gb.y)):(Ge.inputContainer.style.transform=Ge.inputContainer.style.webkitTransform="scale("+Gb.scaleX+","+Gb.scaleY+") rotate("+Gz.stage.canvasDegree+"deg)",Ga.style.width=Gc+"px",Ga.style.height=Gd+"px",Ge.inputContainer.style.left=Gb.x+"px",Ge.inputContainer.style.top=Gb.y+"px")},Ga.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},Ga._setInputMethod=function(){Ge.input.parentElement&&Ge.inputContainer.removeChild(Ge.input),Ge.area.parentElement&&Ge.inputContainer.removeChild(Ge.area),Ge.inputElement=this._multiline?Ge.area:Ge.input,Ge.inputContainer.appendChild(Ge.inputElement),Gsa.RightToLeft&&(Ge.inputElement.style.direction="rtl")},Ga._focusIn=function(){laya.display.Input.isInputting=!0;var Ga=this.nativeInput;this._focus=!0;var Gb=Ga.style;Gb.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),Ga.readOnly=!this._editable,GJ.isConchApp&&(Ga.setType(this._type),Ga.setForbidEdit(!this._editable)),Ga.maxLength=this._maxChars;this.padding;if(Ga.type=this._type,Ga.value=this._content,Ga.placeholder=this._prompt,Gz.stage.off("keydown",this,this._onKeyDown),Gz.stage.on("keydown",this,this._onKeyDown),(Gz.stage.focus=this).event("focus"),GO.onPC&&Ga.focus(),!GO.onMiniGame){this._text;this._text=null}this.typeset(),Ga.setColor(this._originColor),Ga.setFontSize(this.fontSize),Ga.setFontFace(GO.onIPhone&&Gsa._fontFamilyMap[this.font]||this.font),GJ.isConchApp&&Ga.setMultiAble&&Ga.setMultiAble(this._multiline),Gb.lineHeight=this.leading+this.fontSize+"px",Gb.fontStyle=this.italic?"italic":"normal",Gb.fontWeight=this.bold?"bold":"normal",Gb.textAlign=this.align,Gb.padding="0 0",this._syncInputTransform(),!GJ.isConchApp&&GO.onPC&&Gz.timer.frameLoop(1,this,this._syncInputTransform)},Ga._setPromptColor=function(){(Ge.promptStyleDOM=GO.getElementById("promptStyle"))||((Ge.promptStyleDOM=GO.createElement("style")).setAttribute("id","promptStyle"),GO.document.head.appendChild(Ge.promptStyleDOM)),Ge.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},Ga._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(Gz.superSet(Gsa,this,"text",this._content),Gz.superSet(Gsa,this,"color",this._originColor)):(Gz.superSet(Gsa,this,"text",this._prompt),Gz.superSet(Gsa,this,"color",this._promptColor)),Gz.stage.off("keydown",this,this._onKeyDown),Gz.stage.focus=null,this.event("blur"),GJ.isConchApp&&this.nativeInput.blur(),GO.onPC&&Gz.timer.clear(this,this._syncInputTransform)},Ga._onKeyDown=function(Ga){13===Ga.keyCode&&(GO.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},Ga.changeText=function(Ga){this._content=Ga,this._focus?(this.nativeInput.value=Ga||"",this.event("change")):Gb.prototype.changeText.call(this,Ga)},Gk(0,Ga,"color",Gb.prototype._$get_color,function(Ga){this._focus&&this.nativeInput.setColor(Ga),Gz.superSet(Gsa,this,"color",this._content?Ga:this._promptColor),this._originColor=Ga}),Gk(0,Ga,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(Ga){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),Gk(0,Ga,"multiline",function(){return this._multiline},function(Ga){this._multiline=Ga,this.valign=Ga?"top":"middle"}),Gk(0,Ga,"maxChars",function(){return this._maxChars},function(Ga){Ga<=0&&(Ga=1e5),this._maxChars=Ga}),Gk(0,Ga,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(Ga){Gz.superSet(Gsa,this,"color",this._originColor),Ga+="",this._focus?(this.nativeInput.value=Ga||"",this.event("change")):(this._multiline||(Ga=Ga.replace(/\r?\n/g,"")),(this._content=Ga)?Gz.superSet(Gsa,this,"text",Ga):(Gz.superSet(Gsa,this,"text",this._prompt),Gz.superSet(Gsa,this,"color",this.promptColor)))}),Gk(0,Ga,"nativeInput",function(){return this._multiline?Ge.area:Ge.input}),Gk(0,Ga,"prompt",function(){return this._prompt},function(Ga){!this._text&&Ga&&Gz.superSet(Gsa,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?Gz.superSet(Gsa,this,"text",this._text==this._prompt?Ga:this._text):Gz.superSet(Gsa,this,"text",Ga),this._prompt=Gsa.langPacks&&Gsa.langPacks[Ga]?Gsa.langPacks[Ga]:Ga}),Gk(0,Ga,"focus",function(){return this._focus},function(Ga){var Gb=this.nativeInput;this._focus!==Ga&&(Ga?(Gb.target?Gb.target._focusOut():this._setInputMethod(),(Gb.target=this)._focusIn()):(Gb.target=null,this._focusOut(),GO.document.body.scrollTop=0,Gb.blur(),GJ.isConchApp?Gb.setPos(-1e4,-1e4):Ge.inputContainer.contains(Gb)&&Ge.inputContainer.removeChild(Gb)))}),Gk(0,Ga,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(Ga){Ga?(-1<(Ga="[^"+Ga+"]").indexOf("^^")&&(Ga=Ga.replace("^^","")),this._restrictPattern=new RegExp(Ga,"g")):this._restrictPattern=null}),Gk(0,Ga,"editable",function(){return this._editable},function(Ga){this._editable=Ga,GJ.isConchApp&&Ge.input.setForbidEdit(!Ga)}),Gk(0,Ga,"promptColor",function(){return this._promptColor},function(Ga){this._promptColor=Ga,this._content||Gz.superSet(Gsa,this,"color",Ga)}),Gk(0,Ga,"type",function(){return this._type},function(Ga){this._getCSSStyle().password="password"==Ga,this._type=Ga,GJ.isConchApp&&this.nativeInput.setType(Ga)}),Gk(0,Ga,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(Ga){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),Gk(0,Ga,"asPassword",function(){return this._getCSSStyle().password},function(Ga){this._getCSSStyle().password=Ga,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),Ge.__init__=function(){Ge._createInputElement(),GO.onMobile&&GJ.canvas.addEventListener(Ge.IOS_IFRAME?GO.onMiniGame?"touchend":"click":"touchend",Ge._popupInputMethod)},Ge._popupInputMethod=function(Ga){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},Ge._createInputElement=function(){Ge._initInput(Ge.area=GO.createElement("textarea")),Ge._initInput(Ge.input=GO.createElement("input")),(Ge.inputContainer=GO.createElement("div")).style.position="absolute",Ge.inputContainer.style.zIndex=1e5,GO.container.appendChild(Ge.inputContainer),Ge.inputContainer.setPos=function(Ga,Gb){Ge.inputContainer.style.left=Ga+"px",Ge.inputContainer.style.top=Gb+"px"}},Ge._initInput=function(Gb){var Ga=Gb.style;Ga.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",Ga.resize="none",Ga.backgroundColor="transparent",Ga.border="none",Ga.outline="none",Ga.zIndex=1,Gb.addEventListener("input",Ge._processInputting),Gb.addEventListener("mousemove",Ge._stopEvent),Gb.addEventListener("mousedown",Ge._stopEvent),Gb.addEventListener("touchmove",Ge._stopEvent),Gb.setFontFace=function(Ga){Gb.style.fontFamily=Ga},GJ.isConchApp||(Gb.setColor=function(Ga){Gb.style.color=Ga},Gb.setFontSize=function(Ga){Gb.style.fontSize=Ga+"px"})},Ge._processInputting=function(Ga){var Gb=laya.display.Input.inputElement.target;if(Gb){var Gc=laya.display.Input.inputElement.value;Gb._restrictPattern&&(Gc=Gc.replace(/\u2006|\x27/g,""),Gb._restrictPattern.test(Gc)&&(Gc=Gc.replace(Gb._restrictPattern,""),laya.display.Input.inputElement.value=Gc)),Gb._text=Gc,Gb.event("input")}},Ge._stopEvent=function(Ga){"touchmove"==Ga.type&&Ga.preventDefault(),Ga.stopPropagation&&Ga.stopPropagation()},Ge.TYPE_TEXT="text",Ge.TYPE_PASSWORD="password",Ge.TYPE_EMAIL="email",Ge.TYPE_URL="url",Ge.TYPE_NUMBER="number",Ge.TYPE_RANGE="range",Ge.TYPE_DATE="date",Ge.TYPE_MONTH="month",Ge.TYPE_WEEK="week",Ge.TYPE_TIME="time",Ge.TYPE_DATE_TIME="datetime",Ge.TYPE_DATE_TIME_LOCAL="datetime-local",Ge.TYPE_SEARCH="search",Ge.input=null,Ge.area=null,Ge.inputElement=null,Ge.inputContainer=null,Ge.confirmButton=null,Ge.promptStyleDOM=null,Ge.inputHeight=45,Ge.isInputting=!1,Ge.stageMatrix=null,Gi(Ge,["IOS_IFRAME",function(){return this.IOS_IFRAME=GO.onIOS&&GO.window.top!=GO.window.self}]),Ge}(Gsa),Gya=function(Ga){function Gc(Ga,Gb){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,Gc.__super.call(this),Ga&&this._init_(Ga,Gb)}Gr(Gc,"laya.resource.HTMLImage",Gua);var Gb=Gc.prototype;return Gb._init_=function(Ga,Gb){this._src=Ga,this._source=new GO.window.Image,Gb&&(Gb.onload&&(this.onload=Gb.onload),Gb.onerror&&(this.onerror=Gb.onerror),Gb.onCreate&&Gb.onCreate(this)),0!=Ga.indexOf("data:image")&&(this._source.crossOrigin=""),Ga&&(this._source.src=Ga)},Gb.recreateResource=function(){var Ga=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var Gb=this;this._source=new GO.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(Gb._needReleaseAgain)return Gb._needReleaseAgain=!1,Gb._source.onload=null,void(Gb._source=null);Gb._source.onload=null,Gb.memorySize=Ga._w*Ga._h*4,Gb._recreateLock=!1,Gb.completeCreate()},this._source.src=this._src}},Gb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},Gb.onresize=function(){this._w=this._source.width,this._h=this._source.height},Gk(0,Gb,"onload",null,function(Ga){var Gb=this;this._onload=Ga,this._source&&(this._source.onload=null!=this._onload?function(){Gb.onresize(),Gb._onload()}:null)}),Gk(0,Gb,"onerror",null,function(Ga){var Gb=this;this._onerror=Ga,this._source&&(this._source.onerror=null!=this._onerror?function(){Gb._onerror()}:null)}),Gk(0,Gb,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(Ga){this._enableMerageInAtlas=Ga,GJ.isConchApp&&this._source&&(this._source.enableMerageInAtlas=Ga)}),Gc.create=function(Ga,Gb){return new Gc(Ga,Gb)},Gc}(),Gza=(function(Gf){function Ga(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,Ga.__super.call(this)}Gr(Ga,"laya.display.EffectAnimation",Gf);var Gb=Ga.prototype;Gb._onOtherBegin=function(Ga){Ga!=this&&this.stop()},Gb.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},Gb._onPlayAction=function(){this.play(0,!1)},Gb.play=function(Ga,Gb,Gc,Gd){void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=!0),void 0===Gc&&(Gc=""),void 0===Gd&&(Gd=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,Ga,Gb,Gc,Gd))},Gb._recordInitData=function(){if(this._aniKeys){var Ga,Gb,Gc=0;for(Ga=this._aniKeys.length,Gc=0;Gc<Ga;Gc++)Gb=this._aniKeys[Gc],this._initData[Gb]=this._target[Gb]}},Gb._displayToIndex=function(Ga){if(this._animationData){Ga<0&&(Ga=0),Ga>this._count&&(Ga=this._count);var Gb=this._animationData.nodes,Gc=0,Gd=Gb.length;for(Gd=1<Gd?1:Gd,Gc=0;Gc<Gd;Gc++)this._displayNodeToFrame(Gb[Gc],Ga)}},Gb._displayNodeToFrame=function(Ga,Gb,Gc){if(this._target){var Gd;Gd=this._target;var Ge,Gf,Gg,Gh,Gi=Ga.frames,Gj=Ga.keys,Gk=0,Gl=Gj.length;Gh=Ga.secondFrames;var Go,Gp,Gq,Gr,Gs=0;for(Gk=0;Gk<Gl;Gk++)Gf=Gi[Ge=Gj[Gk]],Gg=-1==(Gs=Gh[Ge])?this._initData[Ge]:Gb<Gs?(Gq=(Gp=Ga.keyframes[Ge])[0]).tween?(null==(Go=GU[Gq.tweenMethod])&&(Go=GU.linearNone),Gr=Gp[1],Go(Gb,this._initData[Ge],Gr.value-this._initData[Ge],Gr.index)):this._initData[Ge]:Gf.length>Gb?Gf[Gb]:Gf[Gf.length-1],Gd[Ge]=Gg}},Gb._calculateNodeKeyFrames=function(Ga){Gf.prototype._calculateNodeKeyFrames.call(this,Ga);var Gb,Gc,Gd,Ge=Ga.keyframes;Ga.target;for(Gb in Gd={},Ga.secondFrames=Gd,Ge)(Gc=Ge[Gb]).length<=1?Gd[Gb]=-1:Gd[Gb]=Gc[1].index},Gk(0,Gb,"target",function(){return this._target},function(Ga){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=Ga,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),Gk(0,Gb,"playEvent",null,function(Ga){(this._playEvents=Ga)&&this.addEvent()}),Gk(0,Gb,"effectData",null,function(Ga){var Gb;Ga&&((Gb=Ga.animations)&&Gb[0]&&(this._setUp({},Gb[0]),Gb[0].nodes&&Gb[0].nodes[0]&&(this._aniKeys=Gb[0].nodes[0].keys)))}),Gk(0,Gb,"effectClass",null,function(Ga){var Gb,Gc;(this._effectClass=GR.getClass(Ga),this._effectClass)&&((Gb=this._effectClass.uiView)&&(Gc=Gb.animations)&&Gc[0]&&(this._setUp({},Gc[0]),Gc[0].nodes&&Gc[0].nodes[0]&&(this._aniKeys=Gc[0].nodes[0].keys)))}),Ga.EffectAnimationBegin="effectanimationbegin"}(Gwa),function(Gb){var GD;function GE(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,GE.__super.call(this)}Gr(GE,"laya.utils.GraphicAnimation",Gb);var Ga=GE.prototype;return Ga._parseNodeList=function(Ga){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[Ga.compId]=Ga.props,Ga.compId&&this._nodeList.push(Ga.compId);var Gb=Ga.child;if(Gb){var Gc=0,Gd=Gb.length;for(Gc=0;Gc<Gd;Gc++)this._parseNodeList(Gb[Gc])}},Ga._calGraphicData=function(Ga){var Gb;if(this._setUp(null,Ga),this._createGraphicData(),this._nodeIDAniDic)for(Gb in this._nodeIDAniDic)this._nodeIDAniDic[Gb]=null},Ga._createGraphicData=function(){var Ga,Gb=[],Gc=0,Gd=this.count,Ge=this._animationNewFrames;for(Ge||(Ge=[]),Gc=0;Gc<Gd;Gc++)!Ge[Gc]&&Ga||(Ga=this._createFrameGraphic(Gc)),Gb.push(Ga);this._gList=Gb},Ga._createFrameGraphic=function(Ga){var Gb=GF.createGraphics();return GE._rootMatrix||(GE._rootMatrix=new GG),this._updateNodeGraphic(this._rootNode,Ga,GE._rootMatrix,Gb),Gb},Ga._updateNodeGraphic=function(Ga,Gb,Gc,Gd,Ge){var Gf;void 0===Ge&&(Ge=1);var Gg,Gh,Gi,Gj=(Gf=this._nodeGDic[Ga.compId]=this._getNodeGraphicData(Ga.compId,Gb,this._nodeGDic[Ga.compId])).alpha*Ge;if(!(Gj<.01)&&(Gf.resultTransform||(Gf.resultTransform=GG.create()),Gg=Gf.resultTransform,GG.mul(Gf.transform,Gc,Gg),Gf.skin&&(Gh=this._getTextureByUrl(Gf.skin))&&(Gg._checkTransform()?(Gd.drawTexture(Gh,0,0,Gf.width,Gf.height,Gg,Gj),Gf.resultTransform=null):Gd.drawTexture(Gh,Gg.tx,Gg.ty,Gf.width,Gf.height,null,Gj)),Gi=Ga.child)){var Gk,Gl=0;for(Gk=Gi.length,Gl=0;Gl<Gk;Gl++)this._updateNodeGraphic(Gi[Gl],Gb,Gg,Gd,Gj)}},Ga._updateNoChilds=function(Ga,Gb){if(Ga.skin){var Gc=this._getTextureByUrl(Ga.skin);if(Gc){var Gd=Ga.transform;Gd._checkTransform();!Gd.bTransform?Gb.drawTexture(Gc,Gd.tx,Gd.ty,Ga.width,Ga.height,null,Ga.alpha):Gb.drawTexture(Gc,0,0,Ga.width,Ga.height,Gd.clone(),Ga.alpha)}}},Ga._updateNodeGraphic2=function(Ga,Gb,Gc){var Gd;if(Gd=this._nodeGDic[Ga.compId]=this._getNodeGraphicData(Ga.compId,Gb,this._nodeGDic[Ga.compId]),Ga.child){var Ge=Gd.transform;Ge._checkTransform();var Gf,Gg;Gg=(Gf=!Ge.bTransform)&&(0!=Ge.tx||0!=Ge.ty);var Gh,Gi,Gj;if((Gh=Ge.bTransform||1!=Gd.alpha)&&Gc.save(),1!=Gd.alpha&&Gc.alpha(Gd.alpha),Gf?Gg&&Gc.translate(Ge.tx,Ge.ty):Gc.transform(Ge.clone()),Gi=Ga.child,Gd.skin&&(Gj=this._getTextureByUrl(Gd.skin))&&Gc.drawTexture(Gj,0,0,Gd.width,Gd.height),Gi){var Gk,Gl=0;for(Gk=Gi.length,Gl=0;Gl<Gk;Gl++)this._updateNodeGraphic2(Gi[Gl],Gb,Gc)}Gh?Gc.restore():Gf?Gg&&Gc.translate(-Ge.tx,-Ge.ty):Gc.transform(Ge.clone().invert())}else this._updateNoChilds(Gd,Gc)},Ga._calculateNodeKeyFrames=function(Ga){Gb.prototype._calculateNodeKeyFrames.call(this,Ga),this._nodeIDAniDic[Ga.target]=Ga},Ga.getNodeDataByID=function(Ga){return this._nodeIDAniDic[Ga]},Ga._getParams=function(Ga,Gb,Gc,Gd){var Ge=GE._temParam;Ge.length=Gb.length;var Gf=0,Gg=Gb.length;for(Gf=0;Gf<Gg;Gf++)Ge[Gf]=this._getObjVar(Ga,Gb[Gf][0],Gc,Gb[Gf][1],Gd);return Ge},Ga._getObjVar=function(Ga,Gb,Gc,Gd,Ge){if(Ga.hasOwnProperty(Gb)){var Gf=Ga[Gb];if(Gc>=Gf.length&&(Gc=Gf.length-1),null!=Ga[Gb][Gc])return Ga[Gb][Gc]}return Ge.hasOwnProperty(Gb)?Ge[Gb]:Gd},Ga._getNodeGraphicData=function(Ga,Gb,Gc){Gc||(Gc=GD.create()),Gc.transform?Gc.transform.identity():Gc.transform=GG.create();var Gd=this.getNodeDataByID(Ga);if(!Gd)return Gc;var Ge,Gf,Gg=Gd.frames,Gh=this._getParams(Gg,GE._drawTextureCmd,Gb,this._nodeDefaultProps[Ga]),Gi=Gh[0],Gj=NaN,Gk=NaN,Gl=Gh[5],Go=Gh[6],Gp=Gh[13],Gq=Gh[14],Gr=Gh[7],Gs=Gh[8],Gt=Gh[9],Gu=Gh[11],Gv=Gh[12];Gj=Gh[3],Gk=Gh[4],0!=Gj&&0!=Gk||(Gi=null),-1==Gj&&(Gj=0),-1==Gk&&(Gk=0),Gc.skin=Gi,Gc.width=Gj,Gc.height=Gk,Gi&&((Ge=this._getTextureByUrl(Gi))?(Gj||(Gj=Ge.sourceWidth),Gk||(Gk=Ge.sourceHeight)):console.warn("lost skin:",Gi,",you may load pics first")),Gc.alpha=Gh[10],Gf=Gc.transform,0!=Gp&&(Gl=Gp*Gj),0!=Gq&&(Go=Gq*Gk),0==Gl&&0==Go||Gf.translate(-Gl,-Go);var Gw=null;if(Gt||1!==Gr||1!==Gs||Gu||Gv){(Gw=GE._tempMt).identity(),Gw.bTransform=!0;var Gx=.0174532922222222*(Gt-Gu),Gy=.0174532922222222*(Gt+Gv),Gz=Math.cos(Gy),GA=Math.sin(Gy),GB=Math.sin(Gx),GC=Math.cos(Gx);Gw.a=Gr*Gz,Gw.b=Gr*GA,Gw.c=-Gs*GB,Gw.d=Gs*GC,Gw.tx=Gw.ty=0}return Gw&&(Gf=GG.mul(Gf,Gw,Gf)),Gf.translate(Gh[1],Gh[2]),Gc},Ga._getTextureByUrl=function(Ga){return Gha.getRes(Ga)},Ga.setAniData=function(Ga,Gb){if(Ga.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=Ga,this._parseNodeList(Ga);var Gc,Gd={},Ge=[],Gf=Ga.animations,Gg=0,Gh=Gf.length;for(Gg=0;Gg<Gh;Gg++)if(Gc=Gf[Gg],this._labels=null,(!Gb||Gb==Gc.name)&&Gc){try{this._calGraphicData(Gc)}catch(Ga){console.warn("parse animation fail:"+Gc.name+",empty animation created"),this._gList=[]}var Gi={};Gi.interval=1e3/Gc.frameRate,Gi.frames=this._gList,Gi.labels=this._labels,Gi.name=Gc.name,Ge.push(Gi),Gd[Gc.name]=Gi}this.animationList=Ge,this.animationDic=Gd}GE._temParam.length=0},Ga.parseByData=function(Ga){var Gb,Gc;Gb=Ga.nodeRoot,Gc=Ga.aniO,delete Ga.nodeRoot,delete Ga.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=Gb,this._parseNodeList(Gb),this._labels=null;try{this._calGraphicData(Gc)}catch(Ga){console.warn("parse animation fail:"+Gc.name+",empty animation created"),this._gList=[]}var Gd=Ga;return Gd.interval=1e3/Gc.frameRate,Gd.frames=this._gList,Gd.labels=this._labels,Gd.name=Gc.name,Gd},Ga.setUpAniData=function(Ga){if(Ga.animations){var Gb,Gc={},Gd=[],Ge=Ga.animations,Gf=0,Gg=Ge.length;for(Gf=0;Gf<Gg;Gf++)if(Gb=Ge[Gf]){var Gh={};Gh.name=Gb.name,Gh.aniO=Gb,Gh.nodeRoot=Ga,Gd.push(Gh),Gc[Gb.name]=Gh}this.animationList=Gd,this.animationDic=Gc}},Ga._clear=function(){var Ga,Gb;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(Ga in this._nodeGDic)(Gb=this._nodeGDic[Ga])&&Gb.recover();this._nodeGDic=null},GE.parseAnimationByData=function(Ga){var Gb;return GE._I||(GE._I=new GE),Gb=GE._I.parseByData(Ga),GE._I._clear(),Gb},GE.parseAnimationData=function(Ga){var Gb;return GE._I||(GE._I=new GE),GE._I.setUpAniData(Ga),(Gb={}).animationList=GE._I.animationList,Gb.animationDic=GE._I.animationDic,GE._I._clear(),Gb},GE._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],GE._temParam=[],GE._I=null,GE._rootMatrix=null,Gi(GE,["_tempMt",function(){return this._tempMt=new GG}]),GE.__init$=function(){GD=function(){function Ga(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return Gr(Ga,""),Ga.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),GW.recover("GraphicNode",this)},Ga.create=function(){return GW.getItemByClass("GraphicNode",Ga)},Ga}()},GE}(Gwa));Gz.__init([Gj,Gia,GJ,GO,GY,GC,Ga,Gza])}(window,document,Laya),function(Ga,Gb,Gc){Gc.un,Gc.uns,Gc.static;var Gd=Gc.class;Gc.getset,Gc.__newvec;new(function(){function Ga(){}return Gd(Ga,"LayaMain"),Ga}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ga,Gb){"use strict";for(var Gc in Object.defineProperty(Gb,"__esModule",{value:!0}),Laya){var Gd=Laya[Gc];Gd&&Gd.__isclass&&(Gb[Gc]=Gd)}}),function(Ga,Gb,Gy){Gy.un,Gy.uns;var Gg=Gy.static,Go=Gy.class,Gd=Gy.getset,Gf=Gy.__newvec,Gk=laya.maths.Arith,Gl=laya.maths.Bezier,Gc=laya.resource.Bitmap,Gp=laya.utils.Browser,Gi=laya.utils.Byte,Gq=laya.utils.Color,Gz=(laya.filters.ColorFilter,Gy.Config),Ge=laya.resource.Context,GA=(laya.events.Event,laya.filters.Filter),Gh=laya.display.Graphics,Gj=laya.resource.HTMLCanvas,Gr=(laya.utils.HTMLChar,laya.resource.HTMLImage),Gs=laya.resource.HTMLSubImage,GB=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),GC=laya.maths.Point,GD=laya.maths.Rectangle,Gt=laya.renders.Render,Gu=(laya.renders.RenderContext,laya.renders.RenderSprite),Gv=laya.resource.Resource,Gw=laya.resource.ResourceManager,Gx=laya.utils.RunDriver,GE=laya.display.Sprite,GF=laya.display.Stage,GG=laya.utils.Stat,GH=laya.utils.StringKey,GI=(laya.display.css.Style,laya.system.System),GJ=laya.display.Text,GK=laya.resource.Texture,GL=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),GM=laya.utils.VectorGraphManager;laya.utils.WordText;Gy.interface("laya.webgl.shapes.IShape"),Gy.interface("laya.webgl.submit.ISubmit"),Gy.interface("laya.webgl.text.ICharSegment"),Gy.interface("laya.webgl.canvas.save.ISaveData"),Gy.interface("laya.webgl.resource.IMergeAtlasBitmap"),Gy.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var GN=function(){function Ga(){}Go(Ga,"laya.filters.webgl.FilterActionGL");var Gb=Ga.prototype;return Gy.imps(Gb,{"laya.filters.IFilterActionGL":!0}),Gb.setValue=function(Ga){},Gb.setValueMix=function(Ga){},Gb.apply3d=function(Ga,Gb,Gc,Gd,Ge){return null},Gb.apply=function(Ga){return null},Gd(0,Gb,"typeMix",function(){return 0}),Ga}(),GO=function(){function Ga(){}return Go(Ga,"laya.webgl.shader.ShaderValue"),Ga}(),GP=function(){var Gd,Ge;function Ga(Ga,Gb,Gc){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new Ge,void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),this._cells=null,this._rowInfo=null,this._init(Ga,Gb),this._atlasID=Gc}Go(Ga,"laya.webgl.atlas.AtlasGrid");var Gb=Ga.prototype;return Gb.getAltasID=function(){return this._atlasID},Gb.setAltasID=function(Ga){0<=Ga&&(this._atlasID=Ga)},Gb.addTex=function(Ga,Gb,Gc){var Gd=this._get(Gb,Gc);return 0==Gd.ret||(this._fill(Gd.x,Gd.y,Gb,Gc,Ga),this._texCount++),Gd},Gb._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},Gb._init=function(Ga,Gb){if(this._width=Ga,this._height=Gb,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=Gf(this._height);for(var Gc=0;Gc<this._height;Gc++)this._rowInfo[Gc]=new Gd;return this._clear(),!0},Gb._get=function(Ga,Gb){var Gc=new GR;if(Ga>=this._failSize.width&&Gb>=this._failSize.height)return Gc;for(var Gd=-1,Ge=-1,Gf=this._width,Gg=this._height,Gh=this._cells,Gi=0;Gi<Gg;Gi++)if(!(this._rowInfo[Gi].spaceCount<Ga))for(var Gj=0;Gj<Gf;){var Gk=3*(Gi*Gf+Gj);if(0!=Gh[Gk]||Gh[1+Gk]<Ga||Gh[2+Gk]<Gb)Gj+=Gh[1+Gk];else{Gd=Gj,Ge=Gi;for(var Gl=0;Gl<Ga;Gl++)if(Gh[3*Gl+Gk+2]<Gb){Gd=-1;break}if(!(Gd<0))return Gc.ret=!0,Gc.x=Gd,Gc.y=Ge,Gc;Gj+=Gh[1+Gk]}}return Gc},Gb._fill=function(Ga,Gb,Gc,Gd,Ge){var Gf=this._width,Gg=this._height;this._check(Ga+Gc<=Gf&&Gb+Gd<=Gg);for(var Gh=Gb;Gh<Gd+Gb;++Gh){this._check(this._rowInfo[Gh].spaceCount>=Gc),this._rowInfo[Gh].spaceCount-=Gc;for(var Gi=0;Gi<Gc;Gi++){var Gj=3*(Ga+Gh*Gf+Gi);this._check(0==this._cells[Gj]),this._cells[Gj]=Ge,this._cells[1+Gj]=Gc,this._cells[2+Gj]=Gd}}if(0<Ga)for(Gh=0;Gh<Gd;++Gh){var Gk=0;for(Gi=Ga-1;0<=Gi&&0==this._cells[3*((Gb+Gh)*Gf+Gi)];--Gi,++Gk);for(Gi=Gk;0<Gi;--Gi)this._cells[3*((Gb+Gh)*Gf+Ga-Gi)+1]=Gi,this._check(0<Gi)}if(0<Gb)for(Gi=Ga;Gi<Ga+Gc;++Gi){for(Gk=0,Gh=Gb-1;0<=Gh&&0==this._cells[3*(Gi+Gh*Gf)];--Gh,Gk++);for(Gh=Gk;0<Gh;--Gh)this._cells[3*(Gi+(Gb-Gh)*Gf)+2]=Gh,this._check(0<Gh)}},Gb._check=function(Ga){0==Ga&&console.log("xtexMerger 错误啦")},Gb._clear=function(){for(var Ga=this._texCount=0;Ga<this._height;Ga++)this._rowInfo[Ga].spaceCount=this._width;for(var Gb=0;Gb<this._height;Gb++)for(var Gc=0;Gc<this._width;Gc++){var Gd=3*(Gb*this._width+Gc);this._cells[Gd]=0,this._cells[1+Gd]=this._width-Gc,this._cells[2+Gd]=this._width-Gb}this._failSize.width=this._width+1,this._failSize.height=this._height+1},Ga.__init$=function(){Gd=function(){function Ga(){this.spaceCount=0}return Go(Ga,""),Ga}(),Ge=function(){function Ga(){this.width=0,this.height=0}return Go(Ga,""),Ga}()},Ga}(),GQ=function(){function Gt(Ga,Gb,Gc,Gd){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=Ga,this._height=Gb,this._gridSize=Gc,this._maxAtlaserCount=Gd,this._gridNumX=Ga/Gc,this._gridNumY=Gb/Gc,this._curAtlasIndex=0,this._atlaserArray=[]}Go(Gt,"laya.webgl.atlas.AtlasResourceManager");var Ga=Gt.prototype;return Ga.setAtlasParam=function(Ga,Gb,Gc,Gd){if(1==this._setAtlasParam)return Gt._sid_=0,this._width=Ga,this._height=Gb,this._gridSize=Gc,this._maxAtlaserCount=Gd,this._gridNumX=Ga/Gc,this._gridNumY=Gb/Gc,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},Ga.pushData=function(Ga){var Gb,Gc=Ga.bitmap,Gd=-1,Ge=null,Gf=0,Gg=0;for(Gf=0,Gb=this._atlaserArray.length;Gf<Gb&&(Gg=(this._curAtlasIndex+Gf)%Gb,-1==(Gd=(Ge=this._atlaserArray[Gg]).findBitmapIsExist(Gc)));Gf++);if(-1!=Gd){var Gh=Ge.InAtlasWebGLImagesOffsetValue[Gd];return Gq=Gh[0],Gr=Gh[1],Ge.addToAtlas(Ga,Gq,Gr),!0}this._setAtlasParam=!1;for(var Gi=Math.ceil((Ga.bitmap.width+2)/this._gridSize),Gj=Math.ceil((Ga.bitmap.height+2)/this._gridSize),Gk=!1,Gl=0;Gl<2;Gl++){var Go=this._maxAtlaserCount;for(Gf=0;Gf<Go;Gf++){Gg=(this._curAtlasIndex+Gf)%Go,this._atlaserArray.length-1>=Gg||this._atlaserArray.push(new GDa(this._gridNumX,this._gridNumY,this._width,this._height,Gt._sid_++));var Gp=this._atlaserArray[Gg],Gq=0,Gr=0,Gs=Gp.addTex(1,Gi,Gj);if(Gs.ret){Gq=Gs.x*this._gridSize+1,Gr=Gs.y*this._gridSize+1,Gc.lock=!0,Gp.addToAtlasTexture(Gc,Gq,Gr),Gp.addToAtlas(Ga,Gq,Gr),Gk=!0,this._curAtlasIndex=Gg;break}}if(Gk)break;this._atlaserArray.push(new GDa(this._gridNumX,this._gridNumY,this._width,this._height,Gt._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return Gk||console.log(">>>AtlasManager pushData error"),Gk},Ga.addToAtlas=function(Ga){laya.webgl.atlas.AtlasResourceManager.instance.pushData(Ga)},Ga.garbageCollection=function(){if(!0===this._needGC){for(var Ga=this._atlaserArray.length-this._maxAtlaserCount,Gb=0;Gb<Ga;Gb++)this._atlaserArray[Gb].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+Ga),this._atlaserArray.splice(0,Ga),this._needGC=!1}return!0},Ga.freeAll=function(){for(var Ga=0,Gb=this._atlaserArray.length;Ga<Gb;Ga++)this._atlaserArray[Ga].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},Ga.getAtlaserCount=function(){return this._atlaserArray.length},Ga.getAtlaserByIndex=function(Ga){return this._atlaserArray[Ga]},Gd(1,Gt,"instance",function(){return Gt._Instance||(Gt._Instance=new Gt(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),Gt._Instance}),Gd(1,Gt,"enabled",function(){return Gz.atlasEnable}),Gd(1,Gt,"atlasLimitWidth",function(){return Gt._atlasLimitWidth},function(Ga){Gt._atlasLimitWidth=Ga}),Gd(1,Gt,"atlasLimitHeight",function(){return Gt._atlasLimitHeight},function(Ga){Gt._atlasLimitHeight=Ga}),Gt._enable=function(){Gz.atlasEnable=!0},Gt._disable=function(){Gz.atlasEnable=!1},Gt.__init__=function(){Gt.atlasTextureWidth=2048,Gt.atlasTextureHeight=2048,Gt.maxTextureCount=6,Gt.atlasLimitWidth=512,Gt.atlasLimitHeight=512},Gt._atlasLimitWidth=0,Gt._atlasLimitHeight=0,Gt.gridSize=16,Gt.atlasTextureWidth=0,Gt.atlasTextureHeight=0,Gt.maxTextureCount=0,Gt._atlasRestore=0,Gt.BOARDER_TYPE_NO=0,Gt.BOARDER_TYPE_RIGHT=1,Gt.BOARDER_TYPE_LEFT=2,Gt.BOARDER_TYPE_BOTTOM=4,Gt.BOARDER_TYPE_TOP=8,Gt.BOARDER_TYPE_ALL=15,Gt._sid_=0,Gt._Instance=null,Gt}(),GR=function(){function Ga(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return Go(Ga,"laya.webgl.atlas.MergeFillInfo"),Ga}(),GS=function(){function Gb(){}return Go(Gb,"laya.webgl.canvas.BlendMode"),Gb._init_=function(Ga){Gb.fns=[Gb.BlendNormal,Gb.BlendAdd,Gb.BlendMultiply,Gb.BlendScreen,Gb.BlendOverlay,Gb.BlendLight,Gb.BlendMask,Gb.BlendDestinationOut],Gb.targetFns=[Gb.BlendNormalTarget,Gb.BlendAddTarget,Gb.BlendMultiplyTarget,Gb.BlendScreenTarget,Gb.BlendOverlayTarget,Gb.BlendLightTarget,Gb.BlendMask,Gb.BlendDestinationOut]},Gb.BlendNormal=function(Ga){Ga.blendFunc(1,771)},Gb.BlendAdd=function(Ga){Ga.blendFunc(1,772)},Gb.BlendMultiply=function(Ga){Ga.blendFunc(774,771)},Gb.BlendScreen=function(Ga){Ga.blendFunc(1,1)},Gb.BlendOverlay=function(Ga){Ga.blendFunc(1,769)},Gb.BlendLight=function(Ga){Ga.blendFunc(1,1)},Gb.BlendNormalTarget=function(Ga){Ga.blendFunc(1,771)},Gb.BlendAddTarget=function(Ga){Ga.blendFunc(1,772)},Gb.BlendMultiplyTarget=function(Ga){Ga.blendFunc(774,771)},Gb.BlendScreenTarget=function(Ga){Ga.blendFunc(1,1)},Gb.BlendOverlayTarget=function(Ga){Ga.blendFunc(1,769)},Gb.BlendLightTarget=function(Ga){Ga.blendFunc(1,1)},Gb.BlendMask=function(Ga){Ga.blendFunc(0,770)},Gb.BlendDestinationOut=function(Ga){Ga.blendFunc(0,0)},Gb.activeBlendFunction=null,Gb.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],Gb.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},Gb.NORMAL="normal",Gb.ADD="add",Gb.MULTIPLY="multiply",Gb.SCREEN="screen",Gb.LIGHT="light",Gb.OVERLAY="overlay",Gb.DESTINATIONOUT="destination-out",Gb.fns=[],Gb.targetFns=[],Gb}(),GT=function(){function Gc(Ga){this._color=Gq.create("black"),this.setValue(Ga)}Go(Gc,"laya.webgl.canvas.DrawStyle");var Ga=Gc.prototype;return Ga.setValue=function(Ga){if(Ga){if("string"==typeof Ga)return void(this._color=Gq.create(Ga));if(Ga instanceof laya.utils.Color)return void(this._color=Ga)}},Ga.reset=function(){this._color=Gq.create("black")},Ga.equal=function(Ga){return"string"==typeof Ga?this._color.strColor===Ga:Ga instanceof laya.utils.Color&&this._color.numColor===Ga.numColor},Ga.toColorStr=function(){return this._color.strColor},Gc.create=function(Ga){var Gb;if(Ga&&("string"==typeof Ga?Gb=Gq.create(Ga):Ga instanceof laya.utils.Color&&(Gb=Ga),Gb))return Gb._drawStyle||(Gb._drawStyle=new Gc(Ga));return laya.webgl.canvas.DrawStyle.DEFAULT},Gg(Gc,["DEFAULT",function(){return this.DEFAULT=new Gc("#000000")}]),Gc}(),GU=function(){function Ga(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];Gwa.mainContext;this.ib=Gma.create(35048),this.vb=Gna.create(5)}Go(Ga,"laya.webgl.canvas.Path");var Gb=Ga.prototype;return Gb.addPoint=function(Ga,Gb){this.tempArray.push(Ga,Gb)},Gb.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},Gb.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},Gb.polygon=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg;return this.geomatrys.push(this._curGeomatry=Gg=new GHa(Ga,Gb,Gc,Gd,Ge,Gf)),Gd||(Gg.fill=!1),null==Gf&&(Gg.borderWidth=0),Gg},Gb.setGeomtry=function(Ga){this.geomatrys.push(this._curGeomatry=Ga)},Gb.drawLine=function(Ga,Gb,Gc,Gd,Ge){var Gf;return this.closePath?this.geomatrys.push(this._curGeomatry=Gf=new GGa(Ga,Gb,Gc,Gd,Ge)):this.geomatrys.push(this._curGeomatry=Gf=new GFa(Ga,Gb,Gc,Gd,Ge)),Gf.fill=!1,Gf},Gb.update=function(){var Ga=this.ib._byteLength,Gb=this.geomatrys.length;this.offset=Ga;for(var Gc=this.geoStart;Gc<Gb;Gc++)this.geomatrys[Gc].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=Gb,this.count=(this.ib._byteLength-Ga)/Gra.BYTES_PIDX},Gb.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},Gb.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},Ga}(),GV=function(){function Gh(){}Go(Gh,"laya.webgl.canvas.save.SaveBase");var Ga=Gh.prototype;return Gy.imps(Ga,{"laya.webgl.canvas.save.ISaveData":!0}),Ga.isSaveMark=function(){return!1},Ga.restore=function(Ga){this._dataObj[this._valueName]=this._value,(Gh._cache[Gh._cache._length++]=this)._newSubmit&&(Ga._curSubmit=Gfa.RENDERBASE,Ga._renderKey=0)},Gh._createArray=function(){var Ga=[];return Ga._length=0,Ga},Gh._init=function(){var Ga=Gh._namemap={};return Ga[1]="ALPHA",Ga[2]="fillStyle",Ga[8]="font",Ga[256]="lineWidth",Ga[512]="strokeStyle",Ga[8192]="_mergeID",Ga[1024]=Ga[2048]=Ga[4096]=[],Ga[16384]="textBaseline",Ga[32768]="textAlign",Ga[65536]="_nBlendType",Ga[1048576]="shader",Ga[2097152]="filters",Ga},Gh.save=function(Ga,Gb,Gc,Gd){if((Ga._saveMark._saveuse&Gb)!==Gb){Ga._saveMark._saveuse|=Gb;var Ge=Gh._cache,Gf=0<Ge._length?Ge[--Ge._length]:new Gh;Gf._value=Gc[Gf._valueName=Gh._namemap[Gb]],Gf._dataObj=Gc,Gf._newSubmit=Gd;var Gg=Ga._save;Gg[Gg._length++]=Gf}},Gh._cache=laya.webgl.canvas.save.SaveBase._createArray(),Gh._namemap=Gh._init(),Gh}(),GW=function(){function Gf(){this._clipRect=new GD}Go(Gf,"laya.webgl.canvas.save.SaveClipRect");var Ga=Gf.prototype;return Gy.imps(Ga,{"laya.webgl.canvas.save.ISaveData":!0}),Ga.isSaveMark=function(){return!1},Ga.restore=function(Ga){Ga._clipRect=this._clipSaveRect,(Gf._cache[Gf._cache._length++]=this)._submitScissor.submitLength=Ga._submits._length-this._submitScissor.submitIndex,Ga._curSubmit=Gfa.RENDERBASE,Ga._renderKey=0},Gf.save=function(Ga,Gb){if(131072!=(131072&Ga._saveMark._saveuse)){Ga._saveMark._saveuse|=131072;var Gc=Gf._cache,Gd=0<Gc._length?Gc[--Gc._length]:new Gf;Gd._clipSaveRect=Ga._clipRect,Ga._clipRect=Gd._clipRect.copyFrom(Ga._clipRect),Gd._submitScissor=Gb;var Ge=Ga._save;Ge[Ge._length++]=Gd}},Gg(Gf,["_cache",function(){return this._cache=GV._createArray()}]),Gf}(),GX=function(){function Gp(){this._contextX=0,this._contextY=0,this._clipRect=new GD,this._rect=new GD,this._matrix=new GB}Go(Gp,"laya.webgl.canvas.save.SaveClipRectStencil");var Ga=Gp.prototype;return Gy.imps(Ga,{"laya.webgl.canvas.save.ISaveData":!0}),Ga.isSaveMark=function(){return!1},Ga.restore=function(Ga){Gka.restore(Ga,this._rect,this._saveMatrix,this._contextX,this._contextY),Ga._clipRect=this._clipSaveRect,Ga._curMat=this._saveMatrix,Ga._x=this._contextX,Ga._y=this._contextY,Gp._cache[Gp._cache._length++]=this,Ga._curSubmit=Gfa.RENDERBASE},Gp.save=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){if(262144!=(262144&Ga._saveMark._saveuse)){Ga._saveMark._saveuse|=262144;var Gk=Gp._cache,Gl=0<Gk._length?Gk[--Gk._length]:new Gp;Gl._clipSaveRect=Ga._clipRect,Gl._clipRect.setTo(Gg,Gh,Gi,Gj),Ga._clipRect=Gl._clipRect,Gl._rect.x=Gc,Gl._rect.y=Gd,Gl._rect.width=Ge,Gl._rect.height=Gf,Gl._contextX=Ga._x,Gl._contextY=Ga._y,Gl._saveMatrix=Ga._curMat,Ga._curMat.copyTo(Gl._matrix),Ga._curMat=Gl._matrix,Gl._submitStencil=Gb;var Go=Ga._save;Go[Go._length++]=Gl}},Gg(Gp,["_cache",function(){return this._cache=GV._createArray()}]),Gp}(),GY=function(){function Gd(){this._saveuse=0}Go(Gd,"laya.webgl.canvas.save.SaveMark");var Ga=Gd.prototype;return Gy.imps(Ga,{"laya.webgl.canvas.save.ISaveData":!0}),Ga.isSaveMark=function(){return!0},Ga.restore=function(Ga){Ga._saveMark=this._preSaveMark,Gd._no[Gd._no._length++]=this},Gd.Create=function(Ga){var Gb=Gd._no,Gc=0<Gb._length?Gb[--Gb._length]:new Gd;return Gc._saveuse=0,Gc._preSaveMark=Ga._saveMark,Ga._saveMark=Gc},Gg(Gd,["_no",function(){return this._no=GV._createArray()}]),Gd}(),GZ=function(){function Gf(){this._matrix=new GB}Go(Gf,"laya.webgl.canvas.save.SaveTransform");var Ga=Gf.prototype;return Gy.imps(Ga,{"laya.webgl.canvas.save.ISaveData":!0}),Ga.isSaveMark=function(){return!1},Ga.restore=function(Ga){Ga._curMat=this._savematrix,Gf._no[Gf._no._length++]=this},Gf.save=function(Ga){var Gb=Ga._saveMark;if(2048!=(2048&Gb._saveuse)){Gb._saveuse|=2048;var Gc=Gf._no,Gd=0<Gc._length?Gc[--Gc._length]:new Gf;Gd._savematrix=Ga._curMat,Ga._curMat=Ga._curMat.copyTo(Gd._matrix);var Ge=Ga._save;Ge[Ge._length++]=Gd}},Gg(Gf,["_no",function(){return this._no=GV._createArray()}]),Gf}(),G$=function(){function Ge(){}Go(Ge,"laya.webgl.canvas.save.SaveTranslate");var Ga=Ge.prototype;return Gy.imps(Ga,{"laya.webgl.canvas.save.ISaveData":!0}),Ga.isSaveMark=function(){return!1},Ga.restore=function(Ga){Ga._curMat;Ga._x=this._x,Ga._y=this._y,Ge._no[Ge._no._length++]=this},Ge.save=function(Ga){var Gb=Ge._no,Gc=0<Gb._length?Gb[--Gb._length]:new Ge;Gc._x=Ga._x,Gc._y=Ga._y;var Gd=Ga._save;Gd[Gd._length++]=Gc},Gg(Ge,["_no",function(){return this._no=GV._createArray()}]),Ge}(),G_=function(){function Ga(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new GD}Go(Ga,"laya.webgl.resource.RenderTargetMAX");var Gb=Ga.prototype;return Gb.setSP=function(Ga){this._sp=Ga},Gb.size=function(Ga,Gb){var Gc=this;this._width!==Ga||this._height!==Gb?(this.repaint=!0,this._width=Ga,this._height=Gb,this.target?this.target.size(Ga,Gb):this.target=GMa.create(Ga,Gb),this.target.hasListener("recovered")||this.target.on("recovered",this,function(Ga){Gy.timer.callLater(Gc._sp,Gc._sp.repaint)})):this.target.size(Ga,Gb)},Gb._flushToTarget=function(Ga,Gb){if(!Gb._destroy){var Gc=Gua.worldScissorTest,Gd=Gua.worldClipRect;Gua.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,Gua.worldScissorTest=!1,Gwa.mainContext.disable(3089);var Ge=Gua.worldAlpha,Gf=Gua.worldMatrix4,Gg=Gua.worldMatrix,Gh=Gua.worldFilters,Gi=Gua.worldShaderDefines;if(Gua.worldMatrix=GB.EMPTY,Gua.restoreTempArray(),Gua.worldMatrix4=Gua.TEMPMAT4_ARRAY,Gua.worldAlpha=1,Gua.worldFilters=null,Gua.worldShaderDefines=null,GLa.activeShader=null,Gb.start(),Gz.showCanvasMark?Gb.clear(0,1,0,.3):Gb.clear(0,0,0,0),Ga.flush(),Gb.end(),GLa.activeShader=null,Gua.worldAlpha=Ge,Gua.worldMatrix4=Gf,Gua.worldMatrix=Gg,Gua.worldFilters=Gh,Gua.worldShaderDefines=Gi,Gua.worldScissorTest=Gc){var Gj=Gua.height-Gd.y-Gd.height;Gwa.mainContext.scissor(Gd.x,Gj,Gd.width,Gd.height),Gwa.mainContext.enable(3089)}Gua.worldClipRect=Gd}},Gb.flush=function(Ga){this.repaint&&(this._flushToTarget(Ga,this.target),this.repaint=!1)},Gb.drawTo=function(Ga,Gb,Gc,Gd,Ge){Ga.drawTexture(this.target.getTexture(),Gb,Gc,Gd,Ge,0,0)},Gb.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},Ga}(),Gm=function(){function Ga(){this.ALPHA=1,this.shaderType=0,this.defines=new GEa}return Go(Ga,"laya.webgl.shader.d2.Shader2D"),Ga.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},Ga.__init__=function(){var Ga,Gb;GYa.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),GYa.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),GYa.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),GYa.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),GYa.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),GYa.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),GYa.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),GYa.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),Ga="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",Gb='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',GYa.preCompile2D(0,1,Ga,Gb,null),Ga="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",Gb='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',GYa.preCompile2D(0,2,Ga,Gb,null),Ga="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",Gb="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",GYa.preCompile2D(0,4,Ga,Gb,null),Ga="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",Gb='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',GYa.preCompile2D(0,256,Ga,Gb,null),Ga="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",Gb="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",GYa.preCompile2D(0,512,Ga,Gb,null)},Ga}(),Gn=function(){function Gb(Ga,Gb,Gc){this._value=0,this._name2int=Ga,this._int2name=Gb,this._int2nameMap=Gc}Go(Gb,"laya.webgl.shader.ShaderDefines");var Ga=Gb.prototype;return Ga.add=function(Ga){return"string"==typeof Ga&&(Ga=this._name2int[Ga]),this._value|=Ga,this._value},Ga.addInt=function(Ga){return this._value|=Ga,this._value},Ga.remove=function(Ga){return"string"==typeof Ga&&(Ga=this._name2int[Ga]),this._value&=~Ga,this._value},Ga.isDefine=function(Ga){return(this._value&Ga)===Ga},Ga.getValue=function(){return this._value},Ga.setValue=function(Ga){this._value=Ga},Ga.toNameDic=function(){var Ga=this._int2nameMap[this._value];return Ga||Gb._toText(this._value,this._int2name,this._int2nameMap)},Gb._reg=function(Ga,Gb,Gc,Gd){Gd[Gc[Ga]=Gb]=Ga},Gb._toText=function(Ga,Gb,Gc){var Gd=Gc[Ga];if(Gd)return Gd;for(var Ge={},Gf=1,Gg=0;Gg<32&&!(Ga<(Gf=1<<Gg));Gg++)if(Ga&Gf){var Gh=Gb[Gf];Gh&&(Ge[Gh]="")}return Gc[Ga]=Ge},Gb._toInt=function(Ga,Gb){for(var Gc=Ga.split("."),Gd=0,Ge=0,Gf=Gc.length;Ge<Gf;Ge++){var Gg=Gb[Gc[Ge]];if(!Gg)throw new Error("Defines to int err:"+Ga+"/"+Gc[Ge]);Gd|=Gg}return Gd},Gb}(),Gaa=function(){function Gg(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new GB}Go(Gg,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var Ga=Gg.prototype;return Ga.init=function(Ga,Gb,Gc){if(Gb)this._vs=Gb;else{this._vs=[];var Gd=Ga.width,Ge=Ga.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(Gd,0,1,0,1,1,1,1),this._vs.push(Gd,Ge,1,1,1,1,1,1),this._vs.push(0,Ge,0,1,1,1,1,1)}Gc?this._ps=Gc:(Gg._defaultPS||(Gg._defaultPS=[]).push(0,1,3,3,1,2),this._ps=Gg._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=Ga},Ga.init2=function(Ga,Gb,Gc,Gd,Ge){this.transform&&(this.transform=null),Gc?this._ps=Gc:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=Gd,this._uvs=Ge,this.mEleNum=this._ps.length,this.mTexture=Ga,(Gt.isConchNode||Gt.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},Ga._initMyData=function(){var Ga=0,Gb=0,Gc=4*this._verticles.length;this._vs=Gg._tempVS;var Gd=!1;if(Gt.isConchNode||Gt.isConchApp?(this._vs.length=Gc,Gd=!0):this._vs.length<Gc&&(this._vs.length=Gc,Gd=!0),Gg._tVSLen=Gc,Gd)for(;Ga<Gc;)this._vs[Ga]=this._verticles[Gb],this._vs[Ga+1]=this._verticles[Gb+1],this._vs[Ga+2]=this._uvs[Gb],this._vs[Ga+3]=this._uvs[Gb+1],this._vs[Ga+4]=1,this._vs[Ga+5]=1,this._vs[Ga+6]=1,this._vs[Ga+7]=1,Ga+=8,Gb+=2;else for(;Ga<Gc;)this._vs[Ga]=this._verticles[Gb],this._vs[Ga+1]=this._verticles[Gb+1],this._vs[Ga+2]=this._uvs[Gb],this._vs[Ga+3]=this._uvs[Gb+1],Ga+=8,Gb+=2},Ga.getData2=function(Ga,Gb,Gc){var Gd;this.mVBBuffer=Ga,this.mIBBuffer=Gb,this._initMyData(),Ga.appendEx2(this._vs,Float32Array,Gg._tVSLen,4),this._indexStart=Gb._byteLength,(Gd=Gg._tempIB).length<this._ps.length&&(Gd.length=this._ps.length);for(var Ge=0,Gf=this._ps.length;Ge<Gf;Ge++)Gd[Ge]=this._ps[Ge]+Gc;Gb.appendEx2(Gd,Uint16Array,this._ps.length,2)},Ga.getData=function(Ga,Gb,Gc){if(this.mVBBuffer=Ga,this.mIBBuffer=Gb,Ga.append(this.mVBData),this._indexStart=Gb._byteLength,this.mIBData.start!=Gc){for(var Gd=0,Ge=this._ps.length;Gd<Ge;Gd++)this.mIBData[Gd]=this._ps[Gd]+Gc;this.mIBData.start=Gc}Gb.append(this.mIBData)},Ga.render=function(Ga,Gb,Gc){if(Gt.isWebGL&&this.mTexture){Ga._renderKey=0,Ga._shader2D.glTexture=null,Gba.getInstance().addSkinMesh(this);var Gd=Gfa.createShape(Ga,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,GAa.create(512,0));this.transform||(this.transform=GB.EMPTY),this.transform.translate(Gb,Gc),GB.mul(this.transform,Ga._curMat,this._tempMatrix),this.transform.translate(-Gb,-Gc);var Ge=Gd.shaderValue,Gf=Ge.u_mmat2||Gua.getMatrArray();Gua.mat2MatArray(this._tempMatrix,Gf),Ge.textureHost=this.mTexture,Ge.offsetX=0,Ge.offsetY=0,Ge.u_mmat2=Gf,Ge.ALPHA=Ga._shader2D.ALPHA,Ga._submits[Ga._submits._length++]=Gd}else Gt.isConchApp&&this.mTexture&&(this.transform||(this.transform=GB.EMPTY),Ga.setSkinMesh&&Ga.setSkinMesh(Gb,Gc,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},Gg._tempVS=[],Gg._tempIB=[],Gg._defaultPS=null,Gg._tVSLen=0,Gg}(),Gba=function(){function Ga(){this.ib=null,this.vb=null;Gwa.mainContext;this.ib=Gma.create(35048),this.vb=Gna.create(8)}Go(Ga,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var Gb=Ga.prototype;return Gb.addSkinMesh=function(Ga){Ga.getData2(this.vb,this.ib,this.vb._byteLength/32)},Gb.reset=function(){this.vb.clear(),this.ib.clear()},Ga.getInstance=function(){return Ga.instance=Ga.instance||new Ga},Ga.instance=null,Ga}(),Gca=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===Gi&&(Gi=0),this.x=Ga,this.y=Gb,this.width=Gc,this.height=Gd,this.edges=Ge,this.color=Gf,this.borderWidth=Gg,this.borderColor=Gh}Go(Ga,"laya.webgl.shapes.BasePoly");var Gb=Ga.prototype;return Gy.imps(Gb,{"laya.webgl.shapes.IShape":!0}),Gb.getData=function(Ga,Gb,Gc){},Gb.rebuild=function(Ga){},Gb.setMatrix=function(Ga){},Gb.needUpdate=function(Ga){return!0},Gb.sector=function(Ga,Gb,Gc){var Gd=this.x,Ge=this.y,Gf=this.edges,Gg=(this.r1-this.r0)/Gf,Gh=this.width,Gi=this.height,Gj=this.color,Gk=(Gj>>16&255)/255,Gl=(Gj>>8&255)/255,Go=(255&Gj)/255;Ga.push(Gd,Ge,Gk,Gl,Go);for(var Gp=0;Gp<Gf+1;Gp++)Ga.push(Gd+Math.sin(Gg*Gp+this.r0)*Gh,Ge+Math.cos(Gg*Gp+this.r0)*Gi),Ga.push(Gk,Gl,Go);for(Gp=0;Gp<Gf;Gp++)Gb.push(Gc,Gc+Gp+1,Gc+Gp+2)},Gb.createLine2=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg,Gh,Gi,Gj,Gk,Gl,Go,Gp,Gq,Gr,Gs,Gt,Gu,Gv,Gw,Gx,Gy,Gz,GA,GB,GC=Ga.concat(),GD=Ge,GE=this.borderColor,GF=(GE>>16&255)/255,GG=(GE>>8&255)/255,GH=(255&GE)/255,GI=GC.length/2,GJ=Gd,GK=Gc/2;Gi=GC[0],Gj=GC[1],Gr=Gi-(Gk=GC[2]),Gq=(Gq=-(Gj-(Gl=GC[3])))/(GB=Math.sqrt(Gq*Gq+Gr*Gr))*GK,Gr=Gr/GB*GK,GD.push(Gi-Gq+this.x,Gj-Gr+this.y,GF,GG,GH,Gi+Gq+this.x,Gj+Gr+this.y,GF,GG,GH);for(var GL=1;GL<GI-1;GL++)Gi=GC[2*(GL-1)],Gj=GC[2*(GL-1)+1],Gk=GC[2*GL],Gl=GC[2*GL+1],Go=GC[2*(GL+1)],Gp=GC[2*(GL+1)+1],Gr=Gi-Gk,Gt=Gk-Go,Gw=(-(Gq=(Gq=-(Gj-Gl))/(GB=Math.sqrt(Gq*Gq+Gr*Gr))*GK)+Gi)*(-(Gr=Gr/GB*GK)+Gl)-(-Gq+Gk)*(-Gr+Gj),Gz=(-(Gs=(Gs=-(Gl-Gp))/(GB=Math.sqrt(Gs*Gs+Gt*Gt))*GK)+Go)*(-(Gt=Gt/GB*GK)+Gl)-(-Gs+Gk)*(-Gt+Gp),GA=(Gu=-Gr+Gj-(-Gr+Gl))*(Gy=-Gs+Gk-(-Gs+Go))-(Gx=-Gt+Gp-(-Gt+Gl))*(Gv=-Gq+Gk-(-Gq+Gi)),Math.abs(GA)<.1?(GA+=10.1,GD.push(Gk-Gq+this.x,Gl-Gr+this.y,GF,GG,GH,Gk+Gq+this.x,Gl+Gr+this.y,GF,GG,GH)):(((Gg=(Gv*Gz-Gy*Gw)/GA)-Gk)*(Gg-Gk)+((Gh=(Gx*Gw-Gu*Gz)/GA)-Gl)+(Gh-Gl),GD.push(Gg+this.x,Gh+this.y,GF,GG,GH,Gk-(Gg-Gk)+this.x,Gl-(Gh-Gl)+this.y,GF,GG,GH));Gi=GC[GC.length-4],Gj=GC[GC.length-3],Gr=Gi-(Gk=GC[GC.length-2]),Gq=(Gq=-(Gj-(Gl=GC[GC.length-1])))/(GB=Math.sqrt(Gq*Gq+Gr*Gr))*GK,Gr=Gr/GB*GK,GD.push(Gk-Gq+this.x,Gl-Gr+this.y,GF,GG,GH,Gk+Gq+this.x,Gl+Gr+this.y,GF,GG,GH);var GM=Gf;for(GL=1;GL<GM;GL++)Gb.push(GJ+2*(GL-1),GJ+2*(GL-1)+1,GJ+2*GL+1,GJ+2*GL+1,GJ+2*GL,GJ+2*(GL-1));return GD},Gb.createLine=function(Ga,Gb,Gc,Gd){var Ge=Ga.concat(),Gf=Ga,Gg=this.borderColor,Gh=(Gg>>16&255)/255,Gi=(Gg>>8&255)/255,Gj=(255&Gg)/255;Ge.splice(0,5);var Gk,Gl,Go,Gp,Gq,Gr,Gs,Gt,Gu,Gv,Gw,Gx,Gy,Gz,GA,GB,GC,GD,GE,GF,GG=Ge.length/5,GH=Gd,GI=Gc/2;Go=Ge[0],Gp=Ge[1],Gv=Go-(Gq=Ge[5]),Gu=(Gu=-(Gp-(Gr=Ge[6])))/(GF=Math.sqrt(Gu*Gu+Gv*Gv))*GI,Gv=Gv/GF*GI,Gf.push(Go-Gu,Gp-Gv,Gh,Gi,Gj,Go+Gu,Gp+Gv,Gh,Gi,Gj);for(var GJ=1;GJ<GG-1;GJ++)Go=Ge[5*(GJ-1)],Gp=Ge[5*(GJ-1)+1],Gq=Ge[5*GJ],Gr=Ge[5*GJ+1],Gs=Ge[5*(GJ+1)],Gt=Ge[5*(GJ+1)+1],Gv=Go-Gq,Gx=Gq-Gs,GA=(-(Gu=(Gu=-(Gp-Gr))/(GF=Math.sqrt(Gu*Gu+Gv*Gv))*GI)+Go)*(-(Gv=Gv/GF*GI)+Gr)-(-Gu+Gq)*(-Gv+Gp),GD=(-(Gw=(Gw=-(Gr-Gt))/(GF=Math.sqrt(Gw*Gw+Gx*Gx))*GI)+Gs)*(-(Gx=Gx/GF*GI)+Gr)-(-Gw+Gq)*(-Gx+Gt),GE=(Gy=-Gv+Gp-(-Gv+Gr))*(GC=-Gw+Gq-(-Gw+Gs))-(GB=-Gx+Gt-(-Gx+Gr))*(Gz=-Gu+Gq-(-Gu+Go)),Math.abs(GE)<.1?(GE+=10.1,Gf.push(Gq-Gu,Gr-Gv,Gh,Gi,Gj,Gq+Gu,Gr+Gv,Gh,Gi,Gj)):(((Gk=(Gz*GD-GC*GA)/GE)-Gq)*(Gk-Gq)+((Gl=(GB*GA-Gy*GD)/GE)-Gr)+(Gl-Gr),Gf.push(Gk,Gl,Gh,Gi,Gj,Gq-(Gk-Gq),Gr-(Gl-Gr),Gh,Gi,Gj));Go=Ge[Ge.length-10],Gp=Ge[Ge.length-9],Gv=Go-(Gq=Ge[Ge.length-5]),Gu=(Gu=-(Gp-(Gr=Ge[Ge.length-4])))/(GF=Math.sqrt(Gu*Gu+Gv*Gv))*GI,Gv=Gv/GF*GI,Gf.push(Gq-Gu,Gr-Gv,Gh,Gi,Gj,Gq+Gu,Gr+Gv,Gh,Gi,Gj);var GK=this.edges+1;for(GJ=1;GJ<GK;GJ++)Gb.push(GH+2*(GJ-1),GH+2*(GJ-1)+1,GH+2*GJ+1,GH+2*GJ+1,GH+2*GJ,GH+2*(GJ-1));return Gf},Gb.createLoopLine=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=Ga.concat(),Gh=Ge||Ga,Gi=this.borderColor,Gj=(Gi>>16&255)/255,Gk=(Gi>>8&255)/255,Gl=(255&Gi)/255;Gg.splice(0,5);var Go=[Gg[0],Gg[1]],Gp=[Gg[Gg.length-5],Gg[Gg.length-4]],Gq=Gp[0]+.5*(Go[0]-Gp[0]),Gr=Gp[1]+.5*(Go[1]-Gp[1]);Gg.unshift(Gq,Gr,0,0,0),Gg.push(Gq,Gr,0,0,0);var Gs,Gt,Gu,Gv,Gw,Gx,Gy,Gz,GA,GB,GC,GD,GE,GF,GG,GH,GI,GJ,GK,GL,GM=Gg.length/5,GN=Gd,GO=Gc/2;Gu=Gg[0],Gv=Gg[1],GB=Gu-(Gw=Gg[5]),GA=(GA=-(Gv-(Gx=Gg[6])))/(GL=Math.sqrt(GA*GA+GB*GB))*GO,GB=GB/GL*GO,Gh.push(Gu-GA,Gv-GB,Gj,Gk,Gl,Gu+GA,Gv+GB,Gj,Gk,Gl);for(var GP=1;GP<GM-1;GP++)Gu=Gg[5*(GP-1)],Gv=Gg[5*(GP-1)+1],Gw=Gg[5*GP],Gx=Gg[5*GP+1],Gy=Gg[5*(GP+1)],Gz=Gg[5*(GP+1)+1],GB=Gu-Gw,GD=Gw-Gy,GG=(-(GA=(GA=-(Gv-Gx))/(GL=Math.sqrt(GA*GA+GB*GB))*GO)+Gu)*(-(GB=GB/GL*GO)+Gx)-(-GA+Gw)*(-GB+Gv),GJ=(-(GC=(GC=-(Gx-Gz))/(GL=Math.sqrt(GC*GC+GD*GD))*GO)+Gy)*(-(GD=GD/GL*GO)+Gx)-(-GC+Gw)*(-GD+Gz),GK=(GE=-GB+Gv-(-GB+Gx))*(GI=-GC+Gw-(-GC+Gy))-(GH=-GD+Gz-(-GD+Gx))*(GF=-GA+Gw-(-GA+Gu)),Math.abs(GK)<.1?(GK+=10.1,Gh.push(Gw-GA,Gx-GB,Gj,Gk,Gl,Gw+GA,Gx+GB,Gj,Gk,Gl)):(((Gs=(GF*GJ-GI*GG)/GK)-Gw)*(Gs-Gw)+((Gt=(GH*GG-GE*GJ)/GK)-Gx)+(Gt-Gx),Gh.push(Gs,Gt,Gj,Gk,Gl,Gw-(Gs-Gw),Gx-(Gt-Gx),Gj,Gk,Gl));Gf&&(Gb=Gf);var GQ=this.edges+1;for(GP=1;GP<GQ;GP++)Gb.push(GN+2*(GP-1),GN+2*(GP-1)+1,GN+2*GP+1,GN+2*GP+1,GN+2*GP,GN+2*(GP-1));return Gb.push(GN+2*(GP-1),GN+2*(GP-1)+1,GN+1,GN+1,GN,GN+2*(GP-1)),Gh},Ga}(),Gda=function(){function Gr(){}return Go(Gr,"laya.webgl.shapes.Earcut"),Gr.earcut=function(Ga,Gb,Gc){Gc=Gc||2;var Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk=Gb&&Gb.length,Gl=Gk?Gb[0]*Gc:Ga.length,Go=Gr.linkedList(Ga,0,Gl,Gc,!0),Gp=[];if(!Go)return Gp;if(Gk&&(Go=Gr.eliminateHoles(Ga,Gb,Go,Gc)),Ga.length>80*Gc){Gd=Gf=Ga[0],Ge=Gg=Ga[1];for(var Gq=Gc;Gq<Gl;Gq+=Gc)(Gh=Ga[Gq])<Gd&&(Gd=Gh),(Gi=Ga[Gq+1])<Ge&&(Ge=Gi),Gf<Gh&&(Gf=Gh),Gg<Gi&&(Gg=Gi);Gj=0!==(Gj=Math.max(Gf-Gd,Gg-Ge))?1/Gj:0}return Gr.earcutLinked(Go,Gp,Gc,Gd,Ge,Gj),Gp},Gr.linkedList=function(Ga,Gb,Gc,Gd,Ge){var Gf,Gg;if(Ge===0<Gr.signedArea(Ga,Gb,Gc,Gd))for(Gf=Gb;Gf<Gc;Gf+=Gd)Gg=Gr.insertNode(Gf,Ga[Gf],Ga[Gf+1],Gg);else for(Gf=Gc-Gd;Gb<=Gf;Gf-=Gd)Gg=Gr.insertNode(Gf,Ga[Gf],Ga[Gf+1],Gg);return Gg&&Gr.equals(Gg,Gg.next)&&(Gr.removeNode(Gg),Gg=Gg.next),Gg},Gr.filterPoints=function(Ga,Gb){if(!Ga)return Ga;Gb||(Gb=Ga);var Gc,Gd=Ga;do{if(Gc=!1,Gd.steiner||!Gr.equals(Gd,Gd.next)&&0!==Gr.area(Gd.prev,Gd,Gd.next))Gd=Gd.next;else{if(Gr.removeNode(Gd),(Gd=Gb=Gd.prev)===Gd.next)break;Gc=!0}}while(Gc||Gd!==Gb);return Gb},Gr.earcutLinked=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){if(Ga){!Gg&&Gf&&Gr.indexCurve(Ga,Gd,Ge,Gf);for(var Gh,Gi,Gj=Ga;Ga.prev!==Ga.next;)if(Gh=Ga.prev,Gi=Ga.next,Gf?Gr.isEarHashed(Ga,Gd,Ge,Gf):Gr.isEar(Ga))Gb.push(Gh.i/Gc),Gb.push(Ga.i/Gc),Gb.push(Gi.i/Gc),Gr.removeNode(Ga),Ga=Gi.next,Gj=Gi.next;else if((Ga=Gi)===Gj){Gg?1===Gg?(Ga=Gr.cureLocalIntersections(Ga,Gb,Gc),Gr.earcutLinked(Ga,Gb,Gc,Gd,Ge,Gf,2)):2===Gg&&Gr.splitEarcut(Ga,Gb,Gc,Gd,Ge,Gf):Gr.earcutLinked(Gr.filterPoints(Ga,null),Gb,Gc,Gd,Ge,Gf,1);break}}},Gr.isEar=function(Ga){var Gb=Ga.prev,Gc=Ga,Gd=Ga.next;if(0<=Gr.area(Gb,Gc,Gd))return!1;for(var Ge=Ga.next.next;Ge!==Ga.prev;){if(Gr.pointInTriangle(Gb.x,Gb.y,Gc.x,Gc.y,Gd.x,Gd.y,Ge.x,Ge.y)&&0<=Gr.area(Ge.prev,Ge,Ge.next))return!1;Ge=Ge.next}return!0},Gr.isEarHashed=function(Ga,Gb,Gc,Gd){var Ge=Ga.prev,Gf=Ga,Gg=Ga.next;if(0<=Gr.area(Ge,Gf,Gg))return!1;for(var Gh=Ge.x<Gf.x?Ge.x<Gg.x?Ge.x:Gg.x:Gf.x<Gg.x?Gf.x:Gg.x,Gi=Ge.y<Gf.y?Ge.y<Gg.y?Ge.y:Gg.y:Gf.y<Gg.y?Gf.y:Gg.y,Gj=Ge.x>Gf.x?Ge.x>Gg.x?Ge.x:Gg.x:Gf.x>Gg.x?Gf.x:Gg.x,Gk=Ge.y>Gf.y?Ge.y>Gg.y?Ge.y:Gg.y:Gf.y>Gg.y?Gf.y:Gg.y,Gl=Gr.zOrder(Gh,Gi,Gb,Gc,Gd),Go=Gr.zOrder(Gj,Gk,Gb,Gc,Gd),Gp=Ga.nextZ;Gp&&Gp.z<=Go;){if(Gp!==Ga.prev&&Gp!==Ga.next&&Gr.pointInTriangle(Ge.x,Ge.y,Gf.x,Gf.y,Gg.x,Gg.y,Gp.x,Gp.y)&&0<=Gr.area(Gp.prev,Gp,Gp.next))return!1;Gp=Gp.nextZ}for(Gp=Ga.prevZ;Gp&&Gp.z>=Gl;){if(Gp!==Ga.prev&&Gp!==Ga.next&&Gr.pointInTriangle(Ge.x,Ge.y,Gf.x,Gf.y,Gg.x,Gg.y,Gp.x,Gp.y)&&0<=Gr.area(Gp.prev,Gp,Gp.next))return!1;Gp=Gp.prevZ}return!0},Gr.cureLocalIntersections=function(Ga,Gb,Gc){var Gd=Ga;do{var Ge=Gd.prev,Gf=Gd.next.next;!Gr.equals(Ge,Gf)&&Gr.intersects(Ge,Gd,Gd.next,Gf)&&Gr.locallyInside(Ge,Gf)&&Gr.locallyInside(Gf,Ge)&&(Gb.push(Ge.i/Gc),Gb.push(Gd.i/Gc),Gb.push(Gf.i/Gc),Gr.removeNode(Gd),Gr.removeNode(Gd.next),Gd=Ga=Gf),Gd=Gd.next}while(Gd!==Ga);return Gd},Gr.splitEarcut=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=Ga;do{for(var Gh=Gg.next.next;Gh!==Gg.prev;){if(Gg.i!==Gh.i&&Gr.isValidDiagonal(Gg,Gh)){var Gi=Gr.splitPolygon(Gg,Gh);return Gg=Gr.filterPoints(Gg,Gg.next),Gi=Gr.filterPoints(Gi,Gi.next),Gr.earcutLinked(Gg,Gb,Gc,Gd,Ge,Gf),void Gr.earcutLinked(Gi,Gb,Gc,Gd,Ge,Gf)}Gh=Gh.next}Gg=Gg.next}while(Gg!==Ga)},Gr.eliminateHoles=function(Ga,Gb,Gc,Gd){var Ge,Gf,Gg,Gh,Gi,Gj=[];for(Ge=0,Gf=Gb.length;Ge<Gf;Ge++)Gg=Gb[Ge]*Gd,Gh=Ge<Gf-1?Gb[Ge+1]*Gd:Ga.length,(Gi=Gr.linkedList(Ga,Gg,Gh,Gd,!1))===Gi.next&&(Gi.steiner=!0),Gj.push(Gr.getLeftmost(Gi));for(Gj.sort(Gr.compareX),Ge=0;Ge<Gj.length;Ge++)Gr.eliminateHole(Gj[Ge],Gc),Gc=Gr.filterPoints(Gc,Gc.next);return Gc},Gr.compareX=function(Ga,Gb){return Ga.x-Gb.x},Gr.eliminateHole=function(Ga,Gb){if(Gb=Gr.findHoleBridge(Ga,Gb)){var Gc=Gr.splitPolygon(Gb,Ga);Gr.filterPoints(Gc,Gc.next)}},Gr.findHoleBridge=function(Ga,Gb){var Gc,Gd=Gb,Ge=Ga.x,Gf=Ga.y,Gg=-1/0;do{if(Gf<=Gd.y&&Gf>=Gd.next.y&&Gd.next.y!==Gd.y){var Gh=Gd.x+(Gf-Gd.y)*(Gd.next.x-Gd.x)/(Gd.next.y-Gd.y);if(Gh<=Ge&&Gg<Gh){if((Gg=Gh)===Ge){if(Gf===Gd.y)return Gd;if(Gf===Gd.next.y)return Gd.next}Gc=Gd.x<Gd.next.x?Gd:Gd.next}}Gd=Gd.next}while(Gd!==Gb);if(!Gc)return null;if(Ge===Gg)return Gc.prev;var Gi,Gj=Gc,Gk=Gc.x,Gl=Gc.y,Go=1/0;for(Gd=Gc.next;Gd!==Gj;)Ge>=Gd.x&&Gd.x>=Gk&&Ge!==Gd.x&&Gr.pointInTriangle(Gf<Gl?Ge:Gg,Gf,Gk,Gl,Gf<Gl?Gg:Ge,Gf,Gd.x,Gd.y)&&((Gi=Math.abs(Gf-Gd.y)/(Ge-Gd.x))<Go||Gi===Go&&Gd.x>Gc.x)&&Gr.locallyInside(Gd,Ga)&&(Gc=Gd,Go=Gi),Gd=Gd.next;return Gc},Gr.indexCurve=function(Ga,Gb,Gc,Gd){for(var Ge=Ga;null===Ge.z&&(Ge.z=Gr.zOrder(Ge.x,Ge.y,Gb,Gc,Gd)),Ge.prevZ=Ge.prev,Ge.nextZ=Ge.next,(Ge=Ge.next)!==Ga;);Ge.prevZ.nextZ=null,Ge.prevZ=null,Gr.sortLinked(Ge)},Gr.sortLinked=function(Ga){var Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj=1;do{for(Gc=Ga,Gf=Ga=null,Gg=0;Gc;){for(Gg++,Gd=Gc,Gb=Gh=0;Gb<Gj&&(Gh++,Gd=Gd.nextZ);Gb++);for(Gi=Gj;0<Gh||0<Gi&&Gd;)0!==Gh&&(0===Gi||!Gd||Gc.z<=Gd.z)?(Gc=(Ge=Gc).nextZ,Gh--):(Gd=(Ge=Gd).nextZ,Gi--),Gf?Gf.nextZ=Ge:Ga=Ge,Ge.prevZ=Gf,Gf=Ge;Gc=Gd}Gf.nextZ=null,Gj*=2}while(1<Gg);return Ga},Gr.zOrder=function(Ga,Gb,Gc,Gd,Ge){return(Ga=1431655765&((Ga=858993459&((Ga=252645135&((Ga=16711935&((Ga=32767*(Ga-Gc)*Ge)|Ga<<8))|Ga<<4))|Ga<<2))|Ga<<1))|(Gb=1431655765&((Gb=858993459&((Gb=252645135&((Gb=16711935&((Gb=32767*(Gb-Gd)*Ge)|Gb<<8))|Gb<<4))|Gb<<2))|Gb<<1))<<1},Gr.getLeftmost=function(Ga){for(var Gb=Ga,Gc=Ga;Gb.x<Gc.x&&(Gc=Gb),(Gb=Gb.next)!==Ga;);return Gc},Gr.pointInTriangle=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){return 0<=(Ge-Gg)*(Gb-Gh)-(Ga-Gg)*(Gf-Gh)&&0<=(Ga-Gg)*(Gd-Gh)-(Gc-Gg)*(Gb-Gh)&&0<=(Gc-Gg)*(Gf-Gh)-(Ge-Gg)*(Gd-Gh)},Gr.isValidDiagonal=function(Ga,Gb){return Ga.next.i!==Gb.i&&Ga.prev.i!==Gb.i&&!Gr.intersectsPolygon(Ga,Gb)&&Gr.locallyInside(Ga,Gb)&&Gr.locallyInside(Gb,Ga)&&Gr.middleInside(Ga,Gb)},Gr.area=function(Ga,Gb,Gc){return(Gb.y-Ga.y)*(Gc.x-Gb.x)-(Gb.x-Ga.x)*(Gc.y-Gb.y)},Gr.equals=function(Ga,Gb){return Ga.x===Gb.x&&Ga.y===Gb.y},Gr.intersects=function(Ga,Gb,Gc,Gd){return!!(Gr.equals(Ga,Gb)&&Gr.equals(Gc,Gd)||Gr.equals(Ga,Gd)&&Gr.equals(Gc,Gb))||0<Gr.area(Ga,Gb,Gc)!=0<Gr.area(Ga,Gb,Gd)&&0<Gr.area(Gc,Gd,Ga)!=0<Gr.area(Gc,Gd,Gb)},Gr.intersectsPolygon=function(Ga,Gb){var Gc=Ga;do{if(Gc.i!==Ga.i&&Gc.next.i!==Ga.i&&Gc.i!==Gb.i&&Gc.next.i!==Gb.i&&Gr.intersects(Gc,Gc.next,Ga,Gb))return!0;Gc=Gc.next}while(Gc!==Ga);return!1},Gr.locallyInside=function(Ga,Gb){return Gr.area(Ga.prev,Ga,Ga.next)<0?0<=Gr.area(Ga,Gb,Ga.next)&&0<=Gr.area(Ga,Ga.prev,Gb):Gr.area(Ga,Gb,Ga.prev)<0||Gr.area(Ga,Ga.next,Gb)<0},Gr.middleInside=function(Ga,Gb){for(var Gc=Ga,Gd=!1,Ge=(Ga.x+Gb.x)/2,Gf=(Ga.y+Gb.y)/2;Gc.y>Gf!=Gc.next.y>Gf&&Gc.next.y!==Gc.y&&Ge<(Gc.next.x-Gc.x)*(Gf-Gc.y)/(Gc.next.y-Gc.y)+Gc.x&&(Gd=!Gd),(Gc=Gc.next)!==Ga;);return Gd},Gr.splitPolygon=function(Ga,Gb){var Gc=new Gea(Ga.i,Ga.x,Ga.y),Gd=new Gea(Gb.i,Gb.x,Gb.y),Ge=Ga.next,Gf=Gb.prev;return(Ga.next=Gb).prev=Ga,(Gc.next=Ge).prev=Gc,(Gd.next=Gc).prev=Gd,(Gf.next=Gd).prev=Gf,Gd},Gr.insertNode=function(Ga,Gb,Gc,Gd){var Ge=new Gea(Ga,Gb,Gc);return Gd?(Ge.next=Gd.next,(Ge.prev=Gd).next.prev=Ge,Gd.next=Ge):(Ge.prev=Ge).next=Ge,Ge},Gr.removeNode=function(Ga){Ga.next.prev=Ga.prev,Ga.prev.next=Ga.next,Ga.prevZ&&(Ga.prevZ.nextZ=Ga.nextZ),Ga.nextZ&&(Ga.nextZ.prevZ=Ga.prevZ)},Gr.signedArea=function(Ga,Gb,Gc,Gd){for(var Ge=0,Gf=Gb,Gg=Gc-Gd;Gf<Gc;Gf+=Gd)Ge+=(Ga[Gg]-Ga[Gf])*(Ga[Gf+1]+Ga[Gg+1]),Gg=Gf;return Ge},Gr}(),Gea=function(){function Ga(Ga,Gb,Gc){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=Ga,this.x=Gb,this.y=Gc,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return Go(Ga,"laya.webgl.shapes.EarcutNode"),Ga}(),Gfa=(function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this.lineWidth=Ga,this.lineColor=Gb,this.lineAlpha=Gc,this.fillColor=Gd,this.fillAlpha=Ge,this.shape=Gg,this.fill=Gf}Go(Ga,"laya.webgl.shapes.GeometryData");var Gb=Ga.prototype;Gb.clone=function(){return new Ga(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},Gb.getIndexData=function(){return null},Gb.getVertexData=function(){return null},Gb.destroy=function(){this.shape=null}}(),function(){function Ga(Ga){if(Ga instanceof Float32Array)this.points=Ga;else if(Ga instanceof Array){Ga.length;this.points=new Float32Array(Ga)}}Go(Ga,"laya.webgl.shapes.Vertex");var Gb=Ga.prototype;Gy.imps(Gb,{"laya.webgl.shapes.IShape":!0}),Gb.getData=function(Ga,Gb,Gc){},Gb.needUpdate=function(Ga){return!1},Gb.rebuild=function(Ga){},Gb.setMatrix=function(Ga){}}(),function(){function Gi(Ga){void 0===Ga&&(Ga=1e4),this._renderType=Ga}Go(Gi,"laya.webgl.submit.Submit");var Ga=Gi.prototype;return Gy.imps(Ga,{"laya.webgl.submit.ISubmit":!0}),Ga.releaseRender=function(){var Ga=Gi._cache;(Ga[Ga._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Ga.getRenderType=function(){return this._renderType},Ga.renderSubmit=function(){if(0===this._numEle)return 1;var Ga=this.shaderValue.textureHost;if(Ga){var Gb=Ga.source;if(!Ga.bitmap||!Gb)return 1;this.shaderValue.texture=Gb,Ga.alphaTexture&&Ga.alphaTexture.source&&(this.shaderValue.texture1=Ga.alphaTexture.source)}this._vb.bind_upload(this._ib);var Gc=Gwa.mainContext;return this.shaderValue.upload(),GS.activeBlendFunction!==this._blendFn&&(Gc.enable(3042),this._blendFn(Gc),GS.activeBlendFunction=this._blendFn),GG.drawCall++,GG.trianglesFaces+=this._numEle/3,Gc.drawElements(4,this._numEle,5123,this._startIdx),1},Gi.__init__=function(){var Ga=Gi.RENDERBASE=new Gi(-1);Ga.shaderValue=new GAa(0,0),Ga.shaderValue.ALPHA=-1234},Gi.createSubmit=function(Ga,Gb,Gc,Gd,Ge){var Gf=Gi._cache._length?Gi._cache[--Gi._cache._length]:new Gi;null==Gc&&((Gc=Gf._selfVb||(Gf._selfVb=Gna.create(-1))).clear(),Gd=0),Gf._ib=Gb,Gf._vb=Gc,Gf._startIdx=Gd*Gra.BYTES_PIDX,Gf._numEle=0;var Gg=Ga._nBlendType;Gf._blendFn=Ga._targets?GS.targetFns[Gg]:GS.fns[Gg],Gf.shaderValue=Ge,Gf.shaderValue.setValue(Ga._shader2D);var Gh=Ga._shader2D.filters;return Gh&&Gf.shaderValue.setFilters(Gh),Gf},Gi.createShape=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=Gi._cache._length?Gi._cache[--Gi._cache._length]:new Gi;Gg._ib=Gb,Gg._vb=Gc,Gg._numEle=Gd,Gg._startIdx=Ge,Gg.shaderValue=Gf,Gg.shaderValue.setValue(Ga._shader2D);var Gh=Ga._nBlendType;return Gg._blendFn=Ga._targets?GS.targetFns[Gh]:GS.fns[Gh],Gg},Gi.TYPE_2D=1e4,Gi.TYPE_CANVAS=10003,Gi.TYPE_CMDSETRT=10004,Gi.TYPE_CUSTOM=10005,Gi.TYPE_BLURRT=10006,Gi.TYPE_CMDDESTORYPRERT=10007,Gi.TYPE_DISABLESTENCIL=10008,Gi.TYPE_OTHERIBVB=10009,Gi.TYPE_PRIMITIVE=10010,Gi.TYPE_RT=10011,Gi.TYPE_BLUR_RT=10012,Gi.TYPE_TARGET=10013,Gi.TYPE_CHANGE_VALUE=10014,Gi.TYPE_SHAPE=10015,Gi.TYPE_TEXTURE=10016,Gi.TYPE_FILLTEXTURE=10017,Gi.RENDERBASE=null,Gi._cache=((Gi._cache=[])._length=0,Gi._cache),Gi}()),Gga=function(){function Gd(){this.fun=null,this.args=null}Go(Gd,"laya.webgl.submit.SubmitCMD");var Ga=Gd.prototype;return Gy.imps(Ga,{"laya.webgl.submit.ISubmit":!0}),Ga.renderSubmit=function(){return this.fun.apply(null,this.args),1},Ga.getRenderType=function(){return 0},Ga.releaseRender=function(){var Ga=Gd._cache;Ga[Ga._length++]=this},Gd.create=function(Ga,Gb){var Gc=Gd._cache._length?Gd._cache[--Gd._cache._length]:new Gd;return Gc.fun=Gb,Gc.args=Ga,Gc},Gd._cache=((Gd._cache=[])._length=0,Gd._cache),Gd}(),Gha=function(){function Gb(){this.variables={}}Go(Gb,"laya.webgl.submit.SubmitCMDScope");var Ga=Gb.prototype;return Ga.getValue=function(Ga){return this.variables[Ga]},Ga.addValue=function(Ga,Gb){return this.variables[Ga]=Gb},Ga.setValue=function(Ga,Gb){return this.variables.hasOwnProperty(Ga)?this.variables[Ga]=Gb:null},Ga.clear=function(){for(var Ga in this.variables)delete this.variables[Ga]},Ga.recycle=function(){this.clear(),Gb.POOL.push(this)},Gb.create=function(){var Ga=Gb.POOL.pop();return Ga||(Ga=new Gb),Ga},Gb.POOL=[],Gb}(),Gia=function(){function Gl(){this.offset=0,this.startIndex=0,this._mat=GB.create()}Go(Gl,"laya.webgl.submit.SubmitOtherIBVB");var Ga=Gl.prototype;return Gy.imps(Ga,{"laya.webgl.submit.ISubmit":!0}),Ga.releaseRender=function(){var Ga=Gl._cache;(Ga[Ga._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Ga.getRenderType=function(){return 10009},Ga.renderSubmit=function(){var Ga=this._shaderValue.textureHost;if(Ga){var Gb=Ga.source;if(!Ga.bitmap||!Gb)return 1;this._shaderValue.texture=Gb}this._vb.bind_upload(this._ib);var Gc=Gua.worldMatrix4,Gd=GB.TEMP;GB.mulPre(this._mat,Gc[0],Gc[1],Gc[4],Gc[5],Gc[12],Gc[13],Gd);var Ge=Gua.worldMatrix4=Gl.tempMatrix4;Ge[0]=Gd.a,Ge[1]=Gd.b,Ge[4]=Gd.c,Ge[5]=Gd.d,Ge[12]=Gd.tx,Ge[13]=Gd.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var Gf=Gwa.mainContext;return GS.activeBlendFunction!==this._blendFn&&(Gf.enable(3042),this._blendFn(Gf),GS.activeBlendFunction=this._blendFn),GG.drawCall++,GG.trianglesFaces+=this._numEle/3,Gf.drawElements(4,this._numEle,5123,this.startIndex),Gua.worldMatrix4=Gc,GLa.activeShader=null,1},Gl.create=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){void 0===Gi&&(Gi=0);var Gj=Gl._cache._length?Gl._cache[--Gl._cache._length]:new Gl;Gj._ib=Gc,Gj._vb=Gb,Gj._numEle=Gd,Gj._shader=Ge,Gj._shaderValue=Gf;var Gk=Ga._nBlendType;switch(Gj._blendFn=Ga._targets?GS.targetFns[Gk]:GS.fns[Gk],Gi){case 0:Gj.offset=0,Gj.startIndex=Gh/(Gra.BYTES_PE*Gb.vertexStride)*1.5,Gj.startIndex*=Gra.BYTES_PIDX;break;case 1:Gj.startIndex=Gg,Gj.offset=Gh}return Gj},Gl._cache=((Gl._cache=[])._length=0,Gl._cache),Gl.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Gl}(),Gja=function(){function Gc(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new GD,this.screenRect=new GD}Go(Gc,"laya.webgl.submit.SubmitScissor");var Ga=Gc.prototype;return Gy.imps(Ga,{"laya.webgl.submit.ISubmit":!0}),Ga._scissor=function(Ga,Gb,Gc,Gd){var Ge=Gua.worldMatrix4,Gf=Ge[0],Gg=Ge[5],Gh=Ge[12],Gi=Ge[13];if(Gd*=Gg,(Gc*=Gf)<1||Gd<1)return!1;var Gj=(Ga=Ga*Gf+Gh)+Gc,Gk=(Gb=Gb*Gg+Gi)+Gd;Ga<0&&(Gc=Gj-(Ga=0)),Gb<0&&(Gd=Gk-(Gb=0));var Gl=Gua.worldClipRect;if(Ga=Math.max(Ga,Gl.x),Gb=Math.max(Gb,Gl.y),Gc=Math.min(Gj,Gl.right)-Ga,Gd=Math.min(Gk,Gl.bottom)-Gb,Gc<1||Gd<1)return!1;var Go=Gua.worldScissorTest;return this.screenRect.copyFrom(Gl),Gl.x=Ga,Gl.y=Gb,Gl.width=Gc,Gl.height=Gd,Gua.worldScissorTest=!0,Gb=Gua.height-Gb-Gd,Gwa.mainContext.scissor(Ga,Gb,Gc,Gd),Gwa.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),Go?(Gb=Gua.height-this.screenRect.y-this.screenRect.height,Gwa.mainContext.scissor(this.screenRect.x,Gb,this.screenRect.width,this.screenRect.height),Gwa.mainContext.enable(3089)):(Gwa.mainContext.disable(3089),Gua.worldScissorTest=!1),Gl.copyFrom(this.screenRect),!0},Ga._scissorWithTagart=function(Ga,Gb,Gc,Gd){if(Gc<1||Gd<1)return!1;var Ge=Ga+Gc,Gf=Gb+Gd;Ga<0&&(Gc=Ge-(Ga=0)),Gb<0&&(Gd=Gf-(Gb=0));var Gg=Gua.worldClipRect;if(Ga=Math.max(Ga,Gg.x),Gb=Math.max(Gb,Gg.y),Gc=Math.min(Ge,Gg.right)-Ga,Gd=Math.min(Gf,Gg.bottom)-Gb,Gc<1||Gd<1)return!1;var Gh=Gua.worldScissorTest;return this.screenRect.copyFrom(Gg),Gua.worldScissorTest=!0,Gg.x=Ga,Gg.y=Gb,Gg.width=Gc,Gg.height=Gd,Gb=Gua.height-Gb-Gd,Gwa.mainContext.scissor(Ga,Gb,Gc,Gd),Gwa.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),Gh?(Gb=Gua.height-this.screenRect.y-this.screenRect.height,Gwa.mainContext.scissor(this.screenRect.x,Gb,this.screenRect.width,this.screenRect.height),Gwa.mainContext.enable(3089)):(Gwa.mainContext.disable(3089),Gua.worldScissorTest=!1),Gg.copyFrom(this.screenRect),!0},Ga.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},Ga.getRenderType=function(){return 0},Ga.releaseRender=function(){var Ga=Gc._cache;(Ga[Ga._length++]=this).context=null},Gc.create=function(Ga){var Gb=Gc._cache._length?Gc._cache[--Gc._cache._length]:new Gc;return Gb.context=Ga,Gb},Gc._cache=((Gc._cache=[])._length=0,Gc._cache),Gc}(),Gka=function(){function Gi(){this.step=0,this.blendMode=null,this.level=0}Go(Gi,"laya.webgl.submit.SubmitStencil");var Ga=Gi.prototype;return Gy.imps(Ga,{"laya.webgl.submit.ISubmit":!0}),Ga.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},Ga.getRenderType=function(){return 0},Ga.releaseRender=function(){var Ga=Gi._cache;Ga[Ga._length++]=this},Ga.do1=function(){var Ga=Gwa.mainContext;Ga.enable(2960),Ga.clear(1024),Ga.colorMask(!1,!1,!1,!1),Ga.stencilFunc(514,this.level,255),Ga.stencilOp(7680,7680,7682)},Ga.do2=function(){var Ga=Gwa.mainContext;Ga.stencilFunc(514,this.level+1,255),Ga.colorMask(!0,!0,!0,!0),Ga.stencilOp(7680,7680,7680)},Ga.do3=function(){var Ga=Gwa.mainContext;Ga.colorMask(!0,!0,!0,!0),Ga.stencilOp(7680,7680,7680),Ga.clear(1024),Ga.disable(2960)},Ga.do4=function(){var Ga=Gwa.mainContext;0==this.level&&(Ga.enable(2960),Ga.clear(1024)),Ga.colorMask(!1,!1,!1,!1),Ga.stencilFunc(519,0,255),Ga.stencilOp(7680,7680,7682)},Ga.do5=function(){var Ga=Gwa.mainContext;Ga.stencilFunc(514,this.level,255),Ga.colorMask(!0,!0,!0,!0),Ga.stencilOp(7680,7680,7680)},Ga.do6=function(){var Ga=Gwa.mainContext;GS.targetFns[GS.TOINT[this.blendMode]](Ga)},Ga.do7=function(){var Ga=Gwa.mainContext;Ga.colorMask(!1,!1,!1,!1),Ga.stencilOp(7680,7680,7683)},Ga.do8=function(){var Ga=Gwa.mainContext;Ga.colorMask(!0,!0,!0,!0),Ga.stencilFunc(514,this.level,255),Ga.stencilOp(7680,7680,7680)},Gi.restore=function(Ga,Gb,Gc,Gd,Ge){var Gf;if((Ga._renderKey=0)<Gi._mask&&Gi._mask--,0==Gi._mask)Gf=laya.webgl.submit.SubmitStencil.create(3),Ga.addRenderObject(Gf),Ga._curSubmit=Gfa.RENDERBASE;else{Gf=laya.webgl.submit.SubmitStencil.create(7),Ga.addRenderObject(Gf);var Gg=Ga._vb;Gg._byteLength;if(Gsa.fillRectImgVb(Gg,null,Gb.x,Gb.y,Gb.width,Gb.height,GK.DEF_UV,Gc,Gd,Ge,0,0)){Ga._shader2D.glTexture=null;var Gh=Ga._curSubmit=Gfa.createSubmit(Ga,Ga._ib,Gg,(Gg._byteLength-64)/32*3,GAa.create(2,0));Gh.shaderValue.ALPHA=1,Ga._submits[Ga._submits._length++]=Gh,Ga._curSubmit._numEle+=6,Ga._curSubmit=Gfa.RENDERBASE}else alert("clipRect calc stencil rect error");Gf=laya.webgl.submit.SubmitStencil.create(8),Ga.addRenderObject(Gf)}},Gi.restore2=function(Ga,Gb){var Gc;(Ga._renderKey=0)<Gi._mask&&Gi._mask--,0==Gi._mask?(Gc=laya.webgl.submit.SubmitStencil.create(3),Ga.addRenderObject(Gc),Ga._curSubmit=Gfa.RENDERBASE):(Gc=laya.webgl.submit.SubmitStencil.create(7),Ga.addRenderObject(Gc),Ga._submits[Ga._submits._length++]=Gb,Gc=laya.webgl.submit.SubmitStencil.create(8),Ga.addRenderObject(Gc))},Gi.create=function(Ga){var Gb=Gi._cache._length?Gi._cache[--Gi._cache._length]:new Gi;return 5==(Gb.step=Ga)&&++Gi._mask,Gb.level=Gi._mask,Gb},Gi._cache=((Gi._cache=[])._length=0,Gi._cache),Gi._mask=0,Gi}(),Gla=function(){function Gh(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}Go(Gh,"laya.webgl.submit.SubmitTarget");var Ga=Gh.prototype;return Gy.imps(Ga,{"laya.webgl.submit.ISubmit":!0}),Ga.renderSubmit=function(){this._vb.bind_upload(this._ib);var Ga=this.scope.getValue(this.proName);return Ga&&(this.shaderValue.texture=Ga.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[Ga.width,Ga.height]),this.shaderValue.upload(),this.blend(),GG.drawCall++,GG.trianglesFaces+=this._numEle/3,Gwa.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},Ga.blend=function(){if(GS.activeBlendFunction!==GS.fns[this.blendType]){var Ga=Gwa.mainContext;Ga.enable(3042),GS.fns[this.blendType](Ga),GS.activeBlendFunction=GS.fns[this.blendType]}},Ga.getRenderType=function(){return 0},Ga.releaseRender=function(){var Ga=Gh._cache;(Ga[Ga._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},Gh.create=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=Gh._cache._length?Gh._cache[--Gh._cache._length]:new Gh;return Gg._ib=Gb,Gg._vb=Gc,Gg.proName=Gf,Gg._startIdx=Gd*Gra.BYTES_PIDX,Gg._numEle=0,Gg.blendType=Ga._nBlendType,Gg.shaderValue=Ge,Gg.shaderValue.setValue(Ga._shader2D),Gg},Gh._cache=((Gh._cache=[])._length=0,Gh._cache),Gh}(),Goa=function(){function Ga(){this._sourceStr=null}Go(Ga,"laya.webgl.text.CharSegment");var Gb=Ga.prototype;return Gy.imps(Gb,{"laya.webgl.text.ICharSegment":!0}),Gb.textToSpit=function(Ga){this._sourceStr=Ga},Gb.getChar=function(Ga){return this._sourceStr.charAt(Ga)},Gb.getCharCode=function(Ga){return this._sourceStr.charCodeAt(Ga)},Gb.length=function(){return this._sourceStr.length},Ga}(),Gpa=function(){var Ga;function GG(){}return Go(GG,"laya.webgl.text.DrawText"),GG.__init__=function(){GG._charsTemp=new Array,GG._drawValue=new Ga,GG._charSeg=new Goa},GG.customCharSeg=function(Ga){GG._charSeg=Ga},GG.getChar=function(Ga,Gb,Gc){var Gd=GVa.createOneChar(Ga,Gc);return-1!=Gb&&(GG._charsCache[Gb]=Gd),Gd},GG._drawSlow=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Gl,Go,Gp,Gq){var Gr,Gs,Gt=GG._drawValue.value(Gf,Gh,Gi,Gj,Go,Gp,Gq),Gu=0,Gv=0,Gw=GG._charsTemp,Gx=0,Gy=NaN;if(Gd)for(Gw.length=Gd.length,Gu=0,Gv=Gd.length;Gu<Gv;Gu++)(Gs=Gd[Gu])&&(Gy=Gs.charNum+Gt.txtID,Gw[Gu]=Gr=GG._charsCache[Gy]||GG.getChar(Gs.char,Gy,Gt),Gr.active());else{var Gz=Gc instanceof laya.utils.WordText?Gc.toString():Gc;if(GJ.CharacterCache){GG._charSeg.textToSpit(Gz);var GA=GG._charSeg.length();for(Gu=0,Gv=Gw.length=GA;Gu<Gv;Gu++)Gy=GG._charSeg.getCharCode(Gu)+Gt.txtID,Gw[Gu]=Gr=GG._charsCache[Gy]||GG.getChar(GG._charSeg.getChar(Gu),Gy,Gt),Gr.active(),Gx+=Gr.cw}else Gw.length=0,(Gr=GG.getChar(Gz,-1,Gt)).active(),Gx+=Gr.cw,Gw[0]=Gr}var GB=0;null!==Gg&&"left"!==Gg&&(GB=-("center"==Gg?Gx/2:Gx));var GC,GD,GE=NaN,GF=0;if(Gd)for(Gu=0,Gv=Gw.length;Gu<Gv;Gu++)Gr=Gw[Gu],Gs=Gd[Gu],Gr&&Gs&&!Gr.isSpace&&(GE=Gr.borderSize,GC=Gr.texture,Gb._drawText(GC,Gk+GB+Gs.x*Go-GE,Gl+Gs.y*Gp-GE,GC.width,GC.height,Ge,0,0,0,0));else{for(Gu=0,Gv=Gw.length;Gu<Gv;Gu++)(Gr=Gw[Gu])&&!Gr.isSpace&&(GE=Gr.borderSize,GC=Gr.texture,Gb._drawText(GC,Gk+GB-GE,Gl-GE,GC.width,GC.height,Ge,0,0,0,0),Ga&&((GD=Ga[GF++])||(GD=Ga[GF-1]=[]),GD[0]=GC,GD[1]=GB-GE,GD[2]=-GE)),GB+=Gr.cw;Ga&&(Ga.length=GF)}},GG._drawFast=function(Ga,Gb,Gc,Gd,Ge){for(var Gf,Gg,Gh=0,Gi=Ga.length;Gh<Gi;Gh++)(Gf=(Gg=Ga[Gh])[0]).active(),Gb._drawText(Gf,Gd+Gg[1],Ge+Gg[2],Gf.width,Gf.height,Gc,0,0,0,0)},GG.drawText=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Gl){if(void 0===Gl&&(Gl=0),!(Gb&&0===Gb.length||Gc&&0===Gc.length)){var Go=Gd.a,Gp=Gd.d;(0!==Gd.b||0!==Gd.c)&&(Go=Gp=1);var Gq=1!==Go||1!==Gp;if(Gq&&Gy.stage.transform){var Gr=Gy.stage.transform;Gq=Gr.a===Go&&Gr.d===Gp}else Gq=!1;if(Gq){var Gs=(Gd=Gd.copyTo(Gza._tmpMatrix)).tx,Gt=Gd.ty;Gd.scale(1/Go,1/Gp),Gd._checkTransform(),Gj*=Go,Gk*=Gp,Gj+=Gs-Gd.tx,Gk+=Gt-Gd.ty}else Go=Gp=1;if(Gc)GG._drawSlow(null,Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Go,Gp,Gl);else{if(null===Gb.toUpperCase){var Gu=Go+1e5*Gp,Gv=Gb;return void(Gv.changed||Gv.id!==Gu?(Gv.id=Gu,Gv.changed=!1,GG._drawSlow(Gv.save,Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Go,Gp,Gl)):GG._drawFast(Gv.save,Ga,Gd,Gj,Gk))}var Gw=Gb+Ge.toString()+Gg+Gh+Gi+Go+Gp+Gf,Gx=GG._textsCache[Gw];GJ.CharacterCache?Gx?GG._drawFast(Gx,Ga,Gd,Gj,Gk):(GG._textsCache.__length||(GG._textsCache.__length=0),GG._textsCache.__length>Gz.WebGLTextCacheCount&&((GG._textsCache={}).__length=0,GG._curPoolIndex=0),GG._textCachesPool[GG._curPoolIndex]?(Gx=GG._textsCache[Gw]=GG._textCachesPool[GG._curPoolIndex]).length=0:GG._textCachesPool[GG._curPoolIndex]=Gx=GG._textsCache[Gw]=[],GG._textsCache.__length++,GG._curPoolIndex++,GG._drawSlow(Gx,Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Go,Gp,Gl)):GG._drawSlow(Gx,Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Go,Gp,Gl)}}},GG._charsTemp=null,GG._textCachesPool=[],GG._curPoolIndex=0,GG._charsCache={},GG._textsCache={},GG._drawValue=null,GG.d=[],GG._charSeg=null,GG.__init$=function(){Ga=function(){function Gi(){}return Go(Gi,""),Gi.prototype.value=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this.font=Ga,this.fillColor=Gb,this.borderColor=Gc,this.lineWidth=Gd,this.scaleX=Ge,this.scaleY=Gf,this.underLine=Gg;var Gh=Ga.toString()+Ge+Gf+Gd+(Gb?Gb.toLowerCase():" ")+(Gc?Gc.toLowerCase():" ")+Gg;return this.txtID=Gi._keymap[Gh],this.txtID||(this.txtID=1e-7*++Gi._keymapCount,Gi._keymap[Gh]=this.txtID),this},Gi.clear=function(){Gi._keymap={},Gi._keymapCount=1},Gi._keymap={},Gi._keymapCount=1,Gi}()},GG}(),Gqa=function(){function Ge(Ga){this._index=0,this._size=14,this._italic=-2,Ge._cache2=Ge._cache2||[],this.setFont(Ga||"14px Arial")}Go(Ge,"laya.webgl.text.FontInContext");var Ga=Ge.prototype;return Ga.setFont=function(Ga){var Gb=Ge._cache2[Ga];if(Gb)this._words=Gb[0],this._size=Gb[1];else{this._words=Ga.split(" ");for(var Gc=0,Gd=this._words.length;Gc<Gd;Gc++)if(0<this._words[Gc].indexOf("px")){this._index=Gc;break}this._size=parseInt(this._words[this._index]),Ge._cache2[Ga]=[this._words,this._size]}this._text=null,this._italic=-2},Ga.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},Ga.hasType=function(Ga){for(var Gb=0,Gc=this._words.length;Gb<Gc;Gb++)if(this._words[Gb]===Ga)return Gb;return-1},Ga.removeType=function(Ga){for(var Gb=0,Gc=this._words.length;Gb<Gc;Gb++)if(this._words[Gb]===Ga){this._words.splice(Gb,1),this._index>Gb&&this._index--;break}this._text=null,this._italic=-2},Ga.copyTo=function(Ga){return Ga._text=this._text,Ga._size=this._size,Ga._index=this._index,Ga._words=this._words.slice(),Ga._italic=-2,Ga},Ga.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},Gd(0,Ga,"size",function(){return this._size},function(Ga){this._size=Ga,this._words[this._index]=Ga+"px",this._text=null}),Ge.create=function(Ga){var Gb=Ge._cache[Ga];return Gb||(Gb=Ge._cache[Ga]=new Ge(Ga))},Ge.EMPTY=new Ge,Ge._cache={},Ge._cache2=null,Ge}(),Gra=function(){function Ga(){}return Go(Ga,"laya.webgl.utils.CONST3D2D"),Ga.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ga.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],Ga.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],Ga._TMPARRAY=[],Ga._OFFSETX=0,Ga._OFFSETY=0,Gg(Ga,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),Ga}(),Gsa=function(){function Gq(){}return Go(Gq,"laya.webgl.utils.GlUtils"),Gq.make2DProjection=function(Ga,Gb,Gc){return[2/Ga,0,0,0,0,-2/Gb,0,0,0,0,2/Gc,0,-1,1,0,1]},Gq.fillIBQuadrangle=function(Ga,Gb){if(65535/4<Gb)throw Error("IBQuadrangle count:"+Gb+" must<:"+Math.floor(65535/4));Gb=Math.floor(Gb),Ga._resizeBuffer(6*(Gb+1)*2,!1),Ga.byteLength=Ga.bufferLength;for(var Gc=Ga.getUint16Array(),Gd=0,Ge=0;Ge<Gb;Ge++)Gc[Gd++]=4*Ge,Gc[Gd++]=4*Ge+2,Gc[Gd++]=4*Ge+1,Gc[Gd++]=4*Ge,Gc[Gd++]=4*Ge+3,Gc[Gd++]=4*Ge+2;return Ga.setNeedUpload(),!0},Gq.expandIBQuadrangle=function(Ga,Gb){Ga.bufferLength>=6*Gb*2||Gq.fillIBQuadrangle(Ga,Gb)},Gq.mathCeilPowerOfTwo=function(Ga){return Ga--,Ga|=Ga>>1,Ga|=Ga>>2,Ga|=Ga>>4,Ga|=Ga>>8,Ga|=Ga>>16,++Ga},Gq.fillQuadrangleImgVb=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){var Gi=16+(Ga._byteLength>>2);Ga.byteLength=Gi<<2;var Gj=Ga.getFloat32Array();Gj[(Gi-=16)+2]=Ge[0],Gj[Gi+3]=Ge[1],Gj[Gi+6]=Ge[2],Gj[Gi+7]=Ge[3],Gj[Gi+10]=Ge[4],Gj[Gi+11]=Ge[5],Gj[Gi+14]=Ge[6],Gj[Gi+15]=Ge[7];var Gk=Gf.a,Gl=Gf.b,Go=Gf.c,Gp=Gf.d;if(1!==Gk||0!==Gl||0!==Go||1!==Gp){Gf.bTransform=!0;var Gq=Gf.tx+Gg,Gr=Gf.ty+Gh;Gj[Gi]=(Gd[0]+Gb)*Gk+(Gd[1]+Gc)*Go+Gq,Gj[Gi+1]=(Gd[0]+Gb)*Gl+(Gd[1]+Gc)*Gp+Gr,Gj[Gi+4]=(Gd[2]+Gb)*Gk+(Gd[3]+Gc)*Go+Gq,Gj[Gi+5]=(Gd[2]+Gb)*Gl+(Gd[3]+Gc)*Gp+Gr,Gj[Gi+8]=(Gd[4]+Gb)*Gk+(Gd[5]+Gc)*Go+Gq,Gj[Gi+9]=(Gd[4]+Gb)*Gl+(Gd[5]+Gc)*Gp+Gr,Gj[Gi+12]=(Gd[6]+Gb)*Gk+(Gd[7]+Gc)*Go+Gq,Gj[Gi+13]=(Gd[6]+Gb)*Gl+(Gd[7]+Gc)*Gp+Gr}else Gf.bTransform=!1,Gb+=Gf.tx+Gg,Gc+=Gf.ty+Gh,Gj[Gi]=Gb+Gd[0],Gj[Gi+1]=Gc+Gd[1],Gj[Gi+4]=Gb+Gd[2],Gj[Gi+5]=Gc+Gd[3],Gj[Gi+8]=Gb+Gd[4],Gj[Gi+9]=Gc+Gd[5],Gj[Gi+12]=Gb+Gd[6],Gj[Gi+13]=Gc+Gd[7];return Ga._upload=!0},Gq.fillTranglesVB=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){var Gh=(Ga._byteLength>>2)+Gd.length;Ga.byteLength=Gh<<2;var Gi=Ga.getFloat32Array();Gh-=Gd.length;for(var Gj=Gd.length,Gk=Ge.a,Gl=Ge.b,Go=Ge.c,Gp=Ge.d,Gq=0;Gq<Gj;Gq+=4)if(Gi[Gh+Gq+2]=Gd[Gq+2],Gi[Gh+Gq+3]=Gd[Gq+3],1!==Gk||0!==Gl||0!==Go||1!==Gp){Ge.bTransform=!0;var Gr=Ge.tx+Gf,Gs=Ge.ty+Gg;Gi[Gh+Gq]=(Gd[Gq]+Gb)*Gk+(Gd[Gq+1]+Gc)*Go+Gr,Gi[Gh+Gq+1]=(Gd[Gq]+Gb)*Gl+(Gd[Gq+1]+Gc)*Gp+Gs}else Ge.bTransform=!1,Gb+=Ge.tx+Gf,Gc+=Ge.ty+Gg,Gi[Gh+Gq]=Gb+Gd[Gq],Gi[Gh+Gq+1]=Gc+Gd[Gq+1];return Ga._upload=!0},Gq.copyPreImgVb=function(Ga,Gb,Gc){var Gd=Ga._byteLength>>2;Ga.byteLength=Gd+16<<2;for(var Ge=Ga.getFloat32Array(),Gf=0,Gg=Gd-16;Gf<4;Gf++)Ge[Gd]=Ge[Gg]+Gb,++Gg,Ge[++Gd]=Ge[Gg]+Gc,++Gg,Ge[++Gd]=Ge[Gg],++Gg,Ge[++Gd]=Ge[Gg],++Gd,++Gg;Ga._upload=!0},Gq.fillRectImgVb=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Gl,Go){void 0===Go&&(Go=!1);var Gp,Gq,Gr,Gs,Gt,Gu,Gv,Gw,Gx,Gy,Gz,GA,GB,GC,GD,GE,GF=1,GG=Gh.a,GH=Gh.b,GI=Gh.c,GJ=Gh.d,GK=Gb&&Gb.width<99999999;if(1!==GG||0!==GH||0!==GI||1!==GJ?(Gh.bTransform=!0,0===GH&&0===GI&&(GF=23,Gx=Ge+Gc,Gy=Gf+Gd,Gp=GG*Gc+(Gz=Gh.tx+Gi),Gr=GG*Gx+Gz,Gq=GJ*Gd+(GA=Gh.ty+Gj),Gs=GJ*Gy+GA)):(GF=23,Gh.bTransform=!1,Gr=(Gp=Gc+Gh.tx+Gi)+Ge,Gs=(Gq=Gd+Gh.ty+Gj)+Gf),GK&&(Gt=Gb.x,Gu=Gb.y,Gv=Gb.width+Gt,Gw=Gb.height+Gu),1!==GF){if(Math.min(Gp,Gr)>=Gv)return!1;if(Math.min(Gq,Gs)>=Gw)return!1;if(Math.max(Gr,Gp)<=Gt)return!1;if(Math.max(Gs,Gq)<=Gu)return!1}var GL=Ga._byteLength>>2;Ga.byteLength=16+GL<<2;var GM=Ga.getFloat32Array();switch(GM[2+GL]=Gg[0],GM[3+GL]=Gg[1],GM[6+GL]=Gg[2],GM[7+GL]=Gg[3],GM[10+GL]=Gg[4],GM[11+GL]=Gg[5],GM[14+GL]=Gg[6],GM[15+GL]=Gg[7],GF){case 1:Gz=Gh.tx+Gi,GA=Gh.ty+Gj;var GN=GG*Gc,GO=GI*Gd,GP=GJ*Gd,GQ=GH*Gc,GR=GG*(Gx=Ge+Gc),GS=GI*(Gy=Gf+Gd),GT=GJ*Gy,GU=GH*Gx;Go?(GB=GN+GO+Gz,GD=Math.round(GB)-GB,GC=GP+GQ+GA,GE=Math.round(GC)-GC,GM[GL]=GB+GD,GM[1+GL]=GC+GE,GM[4+GL]=GR+GO+Gz+GD,GM[5+GL]=GP+GU+GA+GE,GM[8+GL]=GR+GS+Gz+GD,GM[9+GL]=GT+GU+GA+GE,GM[12+GL]=GN+GS+Gz+GD,GM[13+GL]=GT+GQ+GA+GE):(GM[GL]=GN+GO+Gz,GM[1+GL]=GP+GQ+GA,GM[4+GL]=GR+GO+Gz,GM[5+GL]=GP+GU+GA,GM[8+GL]=GR+GS+Gz,GM[9+GL]=GT+GU+GA,GM[12+GL]=GN+GS+Gz,GM[13+GL]=GT+GQ+GA);break;case 23:Go?(GB=Gp+Gk,GD=Math.round(GB)-GB,GC=Gq,GE=Math.round(GC)-GC,GM[GL]=GB+GD,GM[1+GL]=GC+GE,GM[4+GL]=Gr+Gk+GD,GM[5+GL]=Gq+GE,GM[8+GL]=Gr+GD,GM[9+GL]=Gs+GE,GM[12+GL]=Gp+GD,GM[13+GL]=Gs+GE):(GM[GL]=Gp+Gk,GM[1+GL]=Gq,GM[4+GL]=Gr+Gk,GM[5+GL]=Gq,GM[8+GL]=Gr,GM[9+GL]=Gs,GM[12+GL]=Gp,GM[13+GL]=Gs)}return Ga._upload=!0},Gq.fillLineVb=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){var Gi=.5*Gg,Gj=Gq._fillLineArray,Gk=-(Gd-Gf),Gl=Gc-Ge,Go=Math.sqrt(Gk*Gk+Gl*Gl);Gk/=Go,Gl/=Go,Gk*=Gi,Gl*=Gi,Gj[0]=Gc-Gk,Gj[1]=Gd-Gl,Gj[4]=Gc+Gk,Gj[5]=Gd+Gl,Gj[8]=Ge+Gk,Gj[9]=Gf+Gl,Gj[12]=Ge-Gk,Gj[13]=Gf-Gl,Gh&&Gh.transformPointArray(Gj,Gj);var Gp=16+(Ga._byteLength>>2);return Ga.byteLength=Gp<<2,Ga.insertData(Gj,Gp-16),!0},Gq._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Gq}(),Gta=(function(){function Gi(){}Go(Gi,"laya.webgl.utils.MatirxArray"),Gi.ArrayMul=function(Ga,Gb,Gc){if(Ga)if(Gb)for(var Gd=NaN,Ge=NaN,Gf=NaN,Gg=NaN,Gh=0;Gh<4;Gh++)Gd=Ga[Gh],Ge=Ga[Gh+4],Gf=Ga[Gh+8],Gg=Ga[Gh+12],Gc[Gh]=Gd*Gb[0]+Ge*Gb[1]+Gf*Gb[2]+Gg*Gb[3],Gc[Gh+4]=Gd*Gb[4]+Ge*Gb[5]+Gf*Gb[6]+Gg*Gb[7],Gc[Gh+8]=Gd*Gb[8]+Ge*Gb[9]+Gf*Gb[10]+Gg*Gb[11],Gc[Gh+12]=Gd*Gb[12]+Ge*Gb[13]+Gf*Gb[14]+Gg*Gb[15];else Gi.copyArray(Ga,Gc);else Gi.copyArray(Gb,Gc)},Gi.copyArray=function(Ga,Gb){if(Ga&&Gb)for(var Gc=0;Gc<Ga.length;Gc++)Gb[Gc]=Ga[Gc]}}(),function(){function Gb(Ga,Gb,Gc){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=Ga,this._vb=new Gna(Ga,35048),Gb&&this._vb._resizeBuffer(Gb,!1),this._ib=new Gma,Gc&&this._ib._resizeBuffer(Gc,!1)}Go(Gb,"laya.webgl.utils.Mesh2D");var Ga=Gb.prototype;return Ga.cloneWithNewVB=function(){var Ga=new Gb(this._stride,0,0);return Ga._ib=this._ib,Ga._quadNum=this._quadNum,Ga._attribInfo=this._attribInfo,Ga},Ga.cloneWithNewVBIB=function(){var Ga=new Gb(this._stride,0,0);return Ga._attribInfo=this._attribInfo,Ga},Ga.getVBW=function(){return this._vb.setNeedUpload(),this._vb},Ga.getVBR=function(){return this._vb},Ga.getIBR=function(){return this._ib},Ga.getIBW=function(){return this._ib.setNeedUpload(),this._ib},Ga.createQuadIB=function(Ga){this._quadNum=Ga,this._ib._resizeBuffer(6*Ga*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var Gb=this._ib.getUint16Array(),Gc=0,Gd=0,Ge=0;Ge<Ga;Ge++)Gb[Gc++]=Gd,Gb[Gc++]=Gd+2,Gb[Gc++]=Gd+1,Gb[Gc++]=Gd,Gb[Gc++]=Gd+3,Gb[Gc++]=Gd+2,Gd+=4;this._ib.setNeedUpload()},Ga.setAttributes=function(Ga){if(this._attribInfo=Ga,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},Ga.getEleNum=function(){return this._ib.getBuffer().byteLength/2},Ga.releaseMesh=function(){},Ga.destroy=function(){},Ga.clearVB=function(){this._vb.clear()},Gb._gvaoid=0,Gb}()),Gua=function(){function Ge(){}return Go(Ge,"laya.webgl.utils.RenderState2D"),Ge.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Ge.mat2MatArray=function(Ga,Gb){var Gc=Ga,Gd=Gb;return Gd[0]=Gc.a,Gd[1]=Gc.b,Gd[2]=Ge.EMPTYMAT4_ARRAY[2],Gd[3]=Ge.EMPTYMAT4_ARRAY[3],Gd[4]=Gc.c,Gd[5]=Gc.d,Gd[6]=Ge.EMPTYMAT4_ARRAY[6],Gd[7]=Ge.EMPTYMAT4_ARRAY[7],Gd[8]=Ge.EMPTYMAT4_ARRAY[8],Gd[9]=Ge.EMPTYMAT4_ARRAY[9],Gd[10]=Ge.EMPTYMAT4_ARRAY[10],Gd[11]=Ge.EMPTYMAT4_ARRAY[11],Gd[12]=Gc.tx,Gd[13]=Gc.ty,Gd[14]=Ge.EMPTYMAT4_ARRAY[14],Gd[15]=Ge.EMPTYMAT4_ARRAY[15],Gb},Ge.restoreTempArray=function(){Ge.TEMPMAT4_ARRAY[0]=1,Ge.TEMPMAT4_ARRAY[1]=0,Ge.TEMPMAT4_ARRAY[4]=0,Ge.TEMPMAT4_ARRAY[5]=1,Ge.TEMPMAT4_ARRAY[12]=0,Ge.TEMPMAT4_ARRAY[13]=0},Ge.clear=function(){Ge.worldScissorTest=!1,Ge.worldShaderDefines=null,Ge.worldFilters=null,Ge.worldAlpha=1,Ge.worldClipRect.x=Ge.worldClipRect.y=0,Ge.worldClipRect.width=Ge.width,Ge.worldClipRect.height=Ge.height,Ge.curRenderTarget=null},Ge._MAXSIZE=99999999,Ge.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ge.worldMatrix4=Ge.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ge.worldAlpha=1,Ge.worldScissorTest=!1,Ge.worldFilters=null,Ge.worldShaderDefines=null,Ge.curRenderTarget=null,Ge.width=0,Ge.height=0,Gg(Ge,["worldMatrix",function(){return this.worldMatrix=new GB},"worldClipRect",function(){return this.worldClipRect=new GD(0,0,99999999,99999999)}]),Ge}(),Gva=function(){var Gu,Gc;function Gv(Ga,Gb,Gc,Gd,Ge){var Gf=this;function Gg(Ga){var Gb=[],Gc=new Gu(Gb);return Gf._compileToTree(Gc,Ga.split("\n"),0,Gb,Ge),Gc}var Gh=Gp.now();this._VS=Gg(Gb),this._PS=Gg(Gc),this._nameMap=Gd,2<Gp.now()-Gh&&console.log("ShaderCompile use time:"+(Gp.now()-Gh)+"  size:"+Gb.length+"/"+Gc.length)}Go(Gv,"laya.webgl.utils.ShaderCompile");var Ga=Gv.prototype;return Ga._compileToTree=function(Ga,Gb,Gc,Gd,Ge){var Gf,Gg,Gh,Gi,Gj,Gk,Gl,Go=0,Gp=0,Gq=0,Gr=0;for(Gp=Gc;Gp<Gb.length;Gp++)if(!((Gh=Gb[Gp]).length<1)&&0!==(Go=Gh.indexOf("//"))){if(0<=Go&&(Gh=Gh.substr(0,Go)),Gf=Gl||new Gu(Gd),Gl=null,Gf.text=Gh,Gf.noCompile=!0,0<=(Go=Gh.indexOf("#"))){for(Gi="#",Gr=Go+1,Gq=Gh.length;Gr<Gq;Gr++){var Gs=Gh.charAt(Gr);if(" "===Gs||"\t"===Gs||"\r"===Gs||"\n"===Gs||"?"===Gs)break;Gi+=Gs}switch(Gf.name=Gi){case"#ifdef":case"#ifndef":if(Gf.src=Gh,Gf.noCompile=null!=Gh.match(/[!&|()=<>]/),Gf.noCompile?console.log("function():Boolean{return "+Gh.substr(Go+Gf.name.length)+"}"):(Gk=Gh.replace(/^\s*/,"").split(/\s+/),Gf.setCondition(Gk[1],"#ifdef"===Gi?1:2),Gf.text="//"+Gf.text),Gf.setParent(Ga),Ga=Gf,Ge)for(Gk=Gh.substr(Gr).split(Gv._splitToWordExps3),Gr=0;Gr<Gk.length;Gr++)(Gh=Gk[Gr]).length&&(Ge[Gh]=!0);continue;case"#if":if(Gf.src=Gh,Gf.noCompile=!0,Gf.setParent(Ga),Ga=Gf,Ge)for(Gk=Gh.substr(Gr).split(Gv._splitToWordExps3),Gr=0;Gr<Gk.length;Gr++)(Gh=Gk[Gr]).length&&"defined"!=Gh&&(Ge[Gh]=!0);continue;case"#else":Gf.src=Gh,Gg=(Ga=Ga.parent).childs[Ga.childs.length-1],Gf.noCompile=Gg.noCompile,Gf.noCompile||(Gf.condition=Gg.condition,Gf.conditionType=1==Gg.conditionType?2:1,Gf.text="//"+Gf.text+" "+Gg.text+" "+Gf.conditionType),Gf.setParent(Ga),Ga=Gf;continue;case"#endif":Gg=(Ga=Ga.parent).childs[Ga.childs.length-1],Gf.noCompile=Gg.noCompile,Gf.noCompile||(Gf.text="//"+Gf.text),Gf.setParent(Ga);continue;case"#include":Gk=Gv.splitToWords(Gh,null);var Gt=Gv.includes[Gk[1]];if(!Gt)throw"ShaderCompile error no this include file:"+Gk[1];if((Go=Gk[0].indexOf("?"))<0){Gf.setParent(Ga),Gh=Gt.getWith("with"==Gk[2]?Gk[3]:null),this._compileToTree(Gf,Gh.split("\n"),0,Gd,Ge),Gf.text="";continue}Gf.setCondition(Gk[0].substr(Go+1),1),Gf.text=Gt.getWith("with"==Gk[2]?Gk[3]:null);break;case"#import":Gj=(Gk=Gv.splitToWords(Gh,null))[1],Gd.push({node:Gf,file:Gv.includes[Gj],ofs:Gf.text.length});continue}}else{if((Gg=Ga.childs[Ga.childs.length-1])&&!Gg.name){0<Gd.length&&Gv.splitToWords(Gh,Gg),Gl=Gf,Gg.text+="\n"+Gh;continue}0<Gd.length&&Gv.splitToWords(Gh,Gf)}Gf.setParent(Ga)}},Ga.createShader=function(Ga,Gb,Gc){var Gd={},Ge="";if(Ga)for(var Gf in Ga)Ge+="#define "+Gf+"\n",Gd[Gf]=!0;var Gg=this._VS.toscript(Gd,[]),Gh=this._PS.toscript(Gd,[]);return(Gc||GYa.create)(Ge+Gg.join("\n"),Ge+Gh.join("\n"),Gb,this._nameMap)},Gv._parseOne=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg={type:Gv.shaderParamsMap[Gc[Gd+1]],name:Gc[Gd+2],size:isNaN(parseInt(Gc[Gd+3]))?1:parseInt(Gc[Gd+3])};return Gf&&("attribute"==Ge?Ga.push(Gg):Gb.push(Gg)),":"==Gc[Gd+3]&&(Gg.type=Gc[Gd+4],Gd+=2),Gd+=2},Gv.addInclude=function(Ga,Gb){if(!Gb||0===Gb.length)throw new Error("add shader include file err:"+Ga);if(Gv.includes[Ga])throw new Error("add shader include file err, has add:"+Ga);Gv.includes[Ga]=new Gc(Gb)},Gv.preGetParams=function(Ga,Gb){var Gc=[Ga,Gb],Gd={},Ge=[],Gf=[],Gg={},Gh=[];Gd.attributes=Ge,Gd.uniforms=Gf,Gd.defines=Gg;for(var Gi=0,Gj=0,Gk=0;Gk<2;Gk++){Gc[Gk]=Gc[Gk].replace(Gv._removeAnnotation,"");var Gl,Go=Gc[Gk].match(Gv._reg);for(Gi=0,Gj=Go.length;Gi<Gj;Gi++){var Gp=Go[Gi];if("attribute"==Gp||"uniform"==Gp)Gi=Gv._parseOne(Ge,Gf,Go,Gi,Gp,!0);else{if("#define"==Gp){Gh[Gp=Go[++Gi]]=1;continue}if("#ifdef"==Gp){Gg[Gl=Go[++Gi]]=Gg[Gl]||[];for(Gi++;Gi<Gj;Gi++)if("attribute"==(Gp=Go[Gi])||"uniform"==Gp)Gi=Gv._parseOne(Ge,Gf,Go,Gi,Gp,Gh[Gl]);else if("#else"==Gp)for(Gi++;Gi<Gj;Gi++)if("attribute"==(Gp=Go[Gi])||"uniform"==Gp)Gi=Gv._parseOne(Ge,Gf,Go,Gi,Gp,!Gh[Gl]);else if("#endif"==Gp)break}}}}return Gd},Gv.splitToWords=function(Ga,Gb){for(var Gc,Gd,Ge=[],Gf=-1,Gg=0,Gh=Ga.length;Gg<Gh;Gg++)if(Gc=Ga.charAt(Gg),0<=" \t=+-*/&%!<>()'\",;".indexOf(Gc)){if(0<=Gf&&1<Gg-Gf&&(Gd=Ga.substr(Gf,Gg-Gf),Ge.push(Gd)),'"'==Gc||"'"==Gc){var Gi=Ga.indexOf(Gc,Gg+1);if(Gi<0)throw"Sharder err:"+Ga;Ge.push(Ga.substr(Gg+1,Gi-Gg-1)),Gg=Gi,Gf=-1;continue}"("==Gc&&Gb&&0<Ge.length&&(Gd=Ge[Ge.length-1]+";","vec4;main;".indexOf(Gd)<0&&(Gb.useFuns+=Gd)),Gf=-1}else Gf<0&&(Gf=Gg);return Gf<Gh&&1<Gh-Gf&&(Gd=Ga.substr(Gf,Gh-Gf),Ge.push(Gd)),Ge},Gv.IFDEF_NO=0,Gv.IFDEF_YES=1,Gv.IFDEF_ELSE=2,Gv.IFDEF_PARENT=3,Gv._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),Gv._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),Gv._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),Gv.includes={},Gg(Gv,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),Gv.__init$=function(){Gu=function(){function Gc(Ga){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=Ga}Go(Gc,"");var Ga=Gc.prototype;return Ga.setParent=function(Ga){Ga.childs.push(this),this.z=Ga.z+1,this.parent=Ga},Ga.setCondition=function(Ga,Gb){Ga&&(this.conditionType=Gb,Ga=Ga.replace(/(\s*$)/g,""),this.condition=function(){return this[Ga]},this.condition.__condition=Ga)},Ga.toscript=function(Ga,Gb){return this._toscript(Ga,Gb,++Gc.__id)},Ga._toscript=function(Gd,Ge,Gf){if(this.childs.length<1&&!this.text)return Ge;Ge.length;if(this.condition){var Ga=!!this.condition.call(Gd);if(2===this.conditionType&&(Ga=!Ga),!Ga)return Ge}if(this.text&&Ge.push(this.text),0<this.childs.length&&this.childs.forEach(function(Ga,Gb,Gc){Ga._toscript(Gd,Ge,Gf)}),0<this.includefiles.length&&0<this.useFuns.length)for(var Gb,Gc=0,Gg=this.includefiles.length;Gc<Gg;Gc++)this.includefiles[Gc].curUseID!=Gf&&0<(Gb=this.includefiles[Gc].file.getFunsScript(this.useFuns)).length&&(this.includefiles[Gc].curUseID=Gf,Ge[0]=Gb+Ge[0]);return Ge},Gc.__id=1,Gc}(),Gc=function(){function Ga(Ga){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=Ga;for(var Gb=0,Gc=0,Gd=0;!((Gb=Ga.indexOf("#begin",Gb))<0);){for(Gd=Gb+5;!((Gd=Ga.indexOf("#end",Gd))<0)&&"i"===Ga.charAt(Gd+4);)Gd+=5;if(Gd<0)throw"add include err,no #end:"+Ga;Gc=Ga.indexOf("\n",Gb);var Ge=Gv.splitToWords(Ga.substr(Gb,Gc-Gb),null);"code"==Ge[1]?this.codes[Ge[2]]=Ga.substr(Gc+1,Gd-Gc-1):"function"==Ge[1]&&(Gc=Ga.indexOf("function",Gb),Gc+="function".length,this.funs[Ge[3]]=Ga.substr(Gc+1,Gd-Gc-1),this.funnames+=Ge[3]+";"),Gb=Gd+1}}Go(Ga,"");var Gb=Ga.prototype;return Gb.getWith=function(Ga){var Gb=Ga?this.codes[Ga]:this.script;if(!Gb)throw"get with error:"+Ga;return Gb},Gb.getFunsScript=function(Ga){var Gb="";for(var Gc in this.funs)0<=Ga.indexOf(Gc+";")&&(Gb+=this.funs[Gc]);return Gb},Ga}()},Gv}(),Gwa=function(){function Gg(){}return Go(Gg,"laya.webgl.WebGL"),Gg._uint8ArraySlice=function(){for(var Ga=this.length,Gb=new Uint8Array(this.length),Gc=0;Gc<Ga;Gc++)Gb[Gc]=this[Gc];return Gb},Gg._float32ArraySlice=function(){for(var Ga=this.length,Gb=new Float32Array(this.length),Gc=0;Gc<Ga;Gc++)Gb[Gc]=this[Gc];return Gb},Gg._uint16ArraySlice=function(Ga){var Gb,Gc=arguments,Gd=0,Ge=0;if(0===Gc.length)for(Gd=this.length,Gb=new Uint16Array(Gd),Ge=0;Ge<Gd;Ge++)Gb[Ge]=this[Ge];else if(2===Gc.length){var Gf=Gc[0],Gg=Gc[1];if(Gf<Gg)for(Gd=Gg-Gf,Gb=new Uint16Array(Gd),Ge=Gf;Ge<Gg;Ge++)Gb[Ge-Gf]=this[Ge];else Gb=new Uint16Array(0)}return Gb},Gg.expandContext=function(){var Ga=Ge.prototype,Gb=CanvasRenderingContext2D.prototype;Gb.fillTrangles=Ga.fillTrangles,GZa.__int__(null),Gb.setIBVB=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){void 0===Gi&&(Gi=0),void 0===Gj&&(Gj=0),null===Gc&&(this._ib=this._ib||Gma.QuadrangleIB,Gc=this._ib,Gsa.expandIBQuadrangle(Gc,Gd._byteLength/64+8)),this._setIBVB(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj)},Gb.fillTrangles=function(Ga,Gb,Gc,Gd,Ge){this._curMat=this._curMat||GB.create(),this._vb=this._vb||Gna.create(),this._ib||(this._ib=Gma.create(),Gsa.fillIBQuadrangle(this._ib,Gg/4));var Gf=this._vb,Gg=Gd.length>>4;Gsa.fillTranglesVB(Gf,Gb,Gc,Gd,Ge||this._curMat,0,0),Gsa.expandIBQuadrangle(this._ib,Gf._byteLength/64+8);var Gh=new GAa(1,0);Gh.textureHost=Ga;var Gi=new G_a("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");Gf._vertType=3,this._setIBVB(Gb,Gc,this._ib,Gf,6*Gg,Ge,Gi,Gh,0,0)}},Gg.enable=function(){if(Gp.__init__(),Gt.isConchApp&&!Gt.isConchWebGL)return Gx.skinAniSprite=function(){return new Gaa},Gg.expandContext(),!1;if(Gx.getWebGLContext=function(Ga){for(var Gb,Gc=["webgl","experimental-webgl","webkit-3d","moz-webgl"],Gd=0;Gd<Gc.length;Gd++){try{Gb=Ga.getContext(Gc[Gd],{stencil:Gz.isStencil,alpha:Gz.isAlpha,antialias:Gz.isAntialias,premultipliedAlpha:Gz.premultipliedAlpha,preserveDrawingBuffer:Gz.preserveDrawingBuffer})}catch(Ga){}if(Gb)return Gb}return null},null==(Gg.mainContext=Gx.getWebGLContext(Gt._mainCanvas)))return!1;if(Gt.isWebGL)return!0;Gr.create=function(Ga,Gb){return new Gab(Ga,Gb)},Gs.create=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){return new GXa(Ga,Gb,Gc,Gd,Ge,Gf,Gg)},Gt.WebGL=Gg,Gt.isWebGL=!0,Gpa.__init__(),Gx.createRenderSprite=function(Ga,Gb){return new GBa(Ga,Gb)},Gx.createWebGLContext2D=function(Ga){return new Gza(Ga)},Gx.changeWebGLSize=function(Ga,Gb){laya.webgl.WebGL.onStageResize(Ga,Gb)},Gx.createGraphics=function(){return new Gya};var Ga=Gx.createFilterAction;return Gx.createFilterAction=Ga||function(Ga){return new GCa},Gx.clear=function(Ga){Gua.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var Gb=Gt.context.ctx,Gc=0==Gb._submits._length||Gz.preserveDrawingBuffer?Gq.create(Ga)._color:GF._wgColor;Gc&&Gb.clearBG(Gc[0],Gc[1],Gc[2],Gc[3]),Gua.clear()},Gx.addToAtlas=function(Ga,Gb){void 0===Gb&&(Gb=!1);var Gc=Ga.bitmap;Gt.optimizeTextureMemory(Ga.url,Ga)?Gy.__typeof(Gc,"laya.webgl.resource.IMergeAtlasBitmap")&&Gc.allowMerageInAtlas&&Gc.on("recovered",Ga,Ga.addTextureToAtlas):Gc.enableMerageInAtlas=!1},Gx.isAtlas=function(Ga){return Ga instanceof laya.webgl.atlas.AtlasWebGLCanvas},GQ._enable(),Gx.beginFlush=function(){for(var Ga=GQ.instance,Gb=Ga.getAtlaserCount(),Gc=0;Gc<Gb;Gc++){var Gd=Ga.getAtlaserByIndex(Gc).texture;Gd._flashCacheImageNeedFlush&&Gx.flashFlushImage(Gd)}},Gx.drawToCanvas=function(Ga,Gb,Gc,Gd,Ge,Gf){(Gc<=0||Gd<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),Gc|=0,Gd|=0,Ge|=0,Gf|=0;var Gg=GMa.create(Gc,Gd,6408,5121,0,!1);Gg.start(),Gg.clear(0,0,0,0),Gt.context.clear(),Gu.renders[Gb]._fun(Ga,Gt.context,Ge,Gua.height-Gd+Gf),Gt.context.flush(),Gg.end();var Gh=Gg.getData(0,0,Gc,Gd);if(Gg.recycle(),Gh.byteLength==Gc*Gd*4){var Gi=new GUa;Gi._canvas=Gp.createElement("canvas"),Gi.size(Gc,Gd);var Gj=Gi._canvas.getContext("2d");Gp.canvas.size(Gc,Gd);var Gk=Gp.context,Gl=Gk.createImageData(Gc,Gd);return Gl.data.set(new Uint8ClampedArray(Gh.buffer)),Gi._imgData=Gl,Gk.putImageData(Gl,0,0),Gj.save(),Gj.translate(0,Gd),Gj.scale(1,-1),Gj.drawImage(Gp.canvas.source,0,0),Gj.restore(),Gi}console.log("drawToCanvas error: w:"+Gc+",h:"+Gd+",datalen:"+Gh.byteLength)},Gx.createFilterAction=function(Ga){var Gb;switch(Ga){case 32:Gb=new GCa}return Gb},Gx.addTextureToAtlas=function(Ga){Ga._uvID++,GQ._atlasRestore++,Ga.bitmap.enableMerageInAtlas&&GQ.instance.addToAtlas(Ga)},Gx.getTexturePixels=function(Ga,Gb,Gc,Gd,Ge){Gt.context.ctx.clear();var Gf=new GE;Gf.graphics.drawTexture(Ga,-Gb,-Gc);var Gg=GMa.create(Gd,Ge);Gg.start(),Gg.clear(0,0,0,0),Gf.render(Gt.context,0,0),Gt.context.ctx.flush(),Gg.end();for(var Gh=Gg.getData(0,0,Gd,Ge),Gi=[],Gj=0,Gk=Ge-1;0<=Gk;Gk--)for(var Gl=0;Gl<Gd;Gl++)Gj=4*(Gk*Gd+Gl),Gi.push(Gh[Gj]),Gi.push(Gh[Gj+1]),Gi.push(Gh[Gj+2]),Gi.push(Gh[Gj+3]);return Gi},Gx.skinAniSprite=function(){return new Gaa},Gj.create=function(Ga,Gb){var Gc=new GUa;return Gc._imgData=Gb,Gc.flipY=!1,Gc},GA._filterStart=function(Ga,Gb,Gc,Gd,Ge){var Gf=Ga.getValue("bounds"),Gg=GMa.create(Gf.width,Gf.height);if(Gg.start(),Gg.clear(0,0,0,0),Ga.addValue("src",Gg),Ga.addValue("ScissorTest",Gua.worldScissorTest),Gua.worldScissorTest){var Gh=new GD;Gh.copyFrom(Gc.ctx._clipRect),Ga.addValue("clipRect",Gh),Gua.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},GA._filterEnd=function(Ga,Gb,Gc,Gd,Ge){var Gf=Ga.getValue("bounds");Ga.getValue("src").end();var Gg=GMa.create(Gf.width,Gf.height);Gg.start(),Gg.clear(0,0,0,0),Ga.addValue("out",Gg),Gb._set$P("_filterCache",Gg),Gb._set$P("_isHaveGlowFilter",Ga.getValue("_isHaveGlowFilter"))},GA._EndTarget=function(Ga,Gb){if(Ga.getValue("src").recycle(),Ga.getValue("out").end(),Ga.getValue("ScissorTest")){Gua.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),Gb.ctx.save();var Gc=Ga.getValue("clipRect");Gb.ctx.clipRect(Gc.x,Gc.y,Gc.width,Gc.height)}},GA._useSrc=function(Ga){var Gb=Ga.getValue("out");Gb.end(),(Gb=Ga.getValue("src")).start(),Gb.clear(0,0,0,0)},GA._endSrc=function(Ga){Ga.getValue("src").end()},GA._useOut=function(Ga){var Gb=Ga.getValue("src");Gb.end(),(Gb=Ga.getValue("out")).start(),Gb.clear(0,0,0,0)},GA._endOut=function(Ga){Ga.getValue("out").end()},GA._recycleScope=function(Ga){Ga.recycle()},GA._filter=function(Ga,Gb,Gc,Gd){var Ge=this._next;if(Ge){var Gf,Gg,Gh=Ga.filters,Gi=Gh.length;if(1==Gi&&32==Gh[0].type)return Gb.ctx.save(),Gb.ctx.setFilters([Gh[0]]),Ge._fun.call(Ge,Ga,Gb,Gc,Gd),void Gb.ctx.restore();var Gj=Gha.create(),Gk=GC.TEMP,Gl=Gb.ctx._getTransformMatrix(),Go=GB.create();Gl.copyTo(Go);var Gp=0,Gq=0,Gr=!1,Gs=Ga._$P._filterCache?Ga._$P._filterCache:null;if(!Gs||Ga._repaint){Gr=Ga._isHaveGlowFilter(),Gj.addValue("_isHaveGlowFilter",Gr),Gr&&(Gp=50,Gq=25),(Gg=new GD).copyFrom(Ga.getSelfBounds()),Gg.x+=Ga.x,Gg.y+=Ga.y,Gg.x-=Ga.pivotX+4,Gg.y-=Ga.pivotY+4;var Gt=Gg.x,Gu=Gg.y;if(Gg.width+=Gp+8,Gg.height+=Gp+8,Gk.x=Gg.x*Go.a+Gg.y*Go.c,Gk.y=Gg.y*Go.d+Gg.x*Go.b,Gg.x=Gk.x,Gg.y=Gk.y,Gk.x=Gg.width*Go.a+Gg.height*Go.c,Gk.y=Gg.height*Go.d+Gg.width*Go.b,Gg.width=Gk.x,Gg.height=Gk.y,Gg.width<=0||Gg.height<=0)return;Gs&&Gs.recycle(),Gj.addValue("bounds",Gg);var Gv=Gga.create([Gj,Ga,Gb,0,0],GA._filterStart);Gb.addRenderObject(Gv),Gb.ctx._renderKey=0,Gb.ctx._shader2D.glTexture=null;var Gw=Ga.x-Gt+Gq,Gx=Ga.y-Gu+Gq;Ge._fun.call(Ge,Ga,Gb,Gw,Gx),Gv=Gga.create([Gj,Ga,Gb,0,0],GA._filterEnd),Gb.addRenderObject(Gv);for(var Gy=0;Gy<Gi;Gy++){0!=Gy&&(Gv=Gga.create([Gj],GA._useSrc),Gb.addRenderObject(Gv),Gf=GAa.create(1,0),GB.TEMP.identity(),Gb.ctx.drawTarget(Gj,0,0,Gg.width,Gg.height,GB.TEMP,"out",Gf,null,GS.TOINT.overlay),Gv=Gga.create([Gj],GA._useOut),Gb.addRenderObject(Gv)),Gh[Gy].action.apply3d(Gj,Ga,Gb,0,0)}Gv=Gga.create([Gj,Gb],GA._EndTarget),Gb.addRenderObject(Gv)}else{if((Gr=!!Ga._$P._isHaveGlowFilter&&Ga._$P._isHaveGlowFilter)&&(Gp=50,Gq=25),(Gg=Ga.getBounds()).width<=0||Gg.height<=0)return;Gg.width+=Gp,Gg.height+=Gp,Gk.x=Gg.x*Go.a+Gg.y*Go.c,Gk.y=Gg.y*Go.d+Gg.x*Go.b,Gg.x=Gk.x,Gg.y=Gk.y,Gk.x=Gg.width*Go.a+Gg.height*Go.c,Gk.y=Gg.height*Go.d+Gg.width*Go.b,Gg.width=Gk.x,Gg.height=Gk.y,Gj.addValue("out",Gs)}Gc=Gc-Gq-Ga.x,Gd=Gd-Gq-Ga.y,Gk.setTo(Gc,Gd),Go.transformPoint(Gk),Gc=Gk.x+Gg.x,Gd=Gk.y+Gg.y,Gf=GAa.create(1,0),GB.TEMP.identity(),Gb.ctx.drawTarget(Gj,Gc,Gd,Gg.width,Gg.height,GB.TEMP,"out",Gf,null,GS.TOINT.overlay),Gv=Gga.create([Gj],GA._recycleScope),Gb.addRenderObject(Gv),Go.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=Gg._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=Gg._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=Gg._uint8ArraySlice),!0},Gg.onStageResize=function(Ga,Gb){null!=Gg.mainContext&&(Gg.mainContext.viewport(0,0,Ga,Gb),Gua.width=Ga,Gua.height=Gb)},Gg.onInvalidGLRes=function(){GQ.instance.freeAll(),Gw.releaseContentManagers(!0),Gg.doNodeRepaint(Gy.stage),Gg.mainContext.viewport(0,0,Gua.width,Gua.height),Gy.stage.event("devicelost")},Gg.doNodeRepaint=function(Ga){0==Ga.numChildren&&Ga.repaint();for(var Gb=0;Gb<Ga.numChildren;Gb++)Gg.doNodeRepaint(Ga.getChildAt(Gb))},Gg.init=function(Ga,Gb,Gc){Gg.mainCanvas=Ga,Gj._createContext=function(Ga){return new Gza(Ga)},GUa._createContext=function(Ga){return new Gza(Ga)};var Gd=laya.webgl.WebGL.mainContext;if(null!=Gd.getShaderPrecisionFormat){var Ge=Gd.getShaderPrecisionFormat(35633,36338),Gf=Gd.getShaderPrecisionFormat(35632,36338);Gg.shaderHighPrecision=!(!Ge.precision||!Gf.precision)}else Gg.shaderHighPrecision=!1;if(Gd.deleteTexture1=Gd.deleteTexture,Gd.deleteTexture=function(Ga){Ga==Gxa.curBindTexValue&&(Gxa.curBindTexValue=null),Gd.deleteTexture1(Ga)},Gg.onStageResize(Gb,Gc),null==Gg.mainContext)throw new Error("webGL getContext err!");GI.__init__(),GQ.__init__(),GEa.__init__(),Gfa.__init__(),Gza.__init__(),GAa.__init__(),Gm.__init__(),GZa.__int__(Gd),GS._init_(Gd),Gt.isConchApp&&conch.setOnInvalidGLRes(Gg.onInvalidGLRes)},Gg.mainCanvas=null,Gg.mainContext=null,Gg.antialias=!0,Gg.shaderHighPrecision=!1,Gg._bg_null=[0,0,0,0],Gg}(),Gxa=function(){function Gd(){}return Go(Gd,"laya.webgl.WebGLContext"),Gd.UseProgram=function(Ga){return Gd._useProgram!==Ga&&(Gwa.mainContext.useProgram(Ga),Gd._useProgram=Ga,!0)},Gd.setDepthTest=function(Ga,Gb){Gb!==Gd._depthTest&&((Gd._depthTest=Gb)?Ga.enable(2929):Ga.disable(2929))},Gd.setDepthMask=function(Ga,Gb){Gb!==Gd._depthMask&&(Gd._depthMask=Gb,Ga.depthMask(Gb))},Gd.setDepthFunc=function(Ga,Gb){Gb!==Gd._depthFunc&&(Gd._depthFunc=Gb,Ga.depthFunc(Gb))},Gd.setBlend=function(Ga,Gb){Gb!==Gd._blend&&((Gd._blend=Gb)?Ga.enable(3042):Ga.disable(3042))},Gd.setBlendFunc=function(Ga,Gb,Gc){(Gb!==Gd._sFactor||Gc!==Gd._dFactor)&&(Gd._sFactor=Gb,Gd._dFactor=Gc,Ga.blendFunc(Gb,Gc))},Gd.setCullFace=function(Ga,Gb){Gb!==Gd._cullFace&&((Gd._cullFace=Gb)?Ga.enable(2884):Ga.disable(2884))},Gd.setFrontFace=function(Ga,Gb){Gb!==Gd._frontFace&&(Gd._frontFace=Gb,Ga.frontFace(Gb))},Gd.bindTexture=function(Ga,Gb,Gc){Ga.bindTexture(Gb,Gc),Gd.curBindTexTarget=Gb,Gd.curBindTexValue=Gc},Gd.DEPTH_BUFFER_BIT=256,Gd.STENCIL_BUFFER_BIT=1024,Gd.COLOR_BUFFER_BIT=16384,Gd.POINTS=0,Gd.LINES=1,Gd.LINE_LOOP=2,Gd.LINE_STRIP=3,Gd.TRIANGLES=4,Gd.TRIANGLE_STRIP=5,Gd.TRIANGLE_FAN=6,Gd.ZERO=0,Gd.ONE=1,Gd.SRC_COLOR=768,Gd.ONE_MINUS_SRC_COLOR=769,Gd.SRC_ALPHA=770,Gd.ONE_MINUS_SRC_ALPHA=771,Gd.DST_ALPHA=772,Gd.ONE_MINUS_DST_ALPHA=773,Gd.DST_COLOR=774,Gd.ONE_MINUS_DST_COLOR=775,Gd.SRC_ALPHA_SATURATE=776,Gd.FUNC_ADD=32774,Gd.BLEND_EQUATION=32777,Gd.BLEND_EQUATION_RGB=32777,Gd.BLEND_EQUATION_ALPHA=34877,Gd.FUNC_SUBTRACT=32778,Gd.FUNC_REVERSE_SUBTRACT=32779,Gd.BLEND_DST_RGB=32968,Gd.BLEND_SRC_RGB=32969,Gd.BLEND_DST_ALPHA=32970,Gd.BLEND_SRC_ALPHA=32971,Gd.CONSTANT_COLOR=32769,Gd.ONE_MINUS_CONSTANT_COLOR=32770,Gd.CONSTANT_ALPHA=32771,Gd.ONE_MINUS_CONSTANT_ALPHA=32772,Gd.BLEND_COLOR=32773,Gd.ARRAY_BUFFER=34962,Gd.ELEMENT_ARRAY_BUFFER=34963,Gd.ARRAY_BUFFER_BINDING=34964,Gd.ELEMENT_ARRAY_BUFFER_BINDING=34965,Gd.STREAM_DRAW=35040,Gd.STATIC_DRAW=35044,Gd.DYNAMIC_DRAW=35048,Gd.BUFFER_SIZE=34660,Gd.BUFFER_USAGE=34661,Gd.CURRENT_VERTEX_ATTRIB=34342,Gd.FRONT=1028,Gd.BACK=1029,Gd.CULL_FACE=2884,Gd.FRONT_AND_BACK=1032,Gd.BLEND=3042,Gd.DITHER=3024,Gd.STENCIL_TEST=2960,Gd.DEPTH_TEST=2929,Gd.SCISSOR_TEST=3089,Gd.POLYGON_OFFSET_FILL=32823,Gd.SAMPLE_ALPHA_TO_COVERAGE=32926,Gd.SAMPLE_COVERAGE=32928,Gd.NO_ERROR=0,Gd.INVALID_ENUM=1280,Gd.INVALID_VALUE=1281,Gd.INVALID_OPERATION=1282,Gd.OUT_OF_MEMORY=1285,Gd.CW=2304,Gd.CCW=2305,Gd.LINE_WIDTH=2849,Gd.ALIASED_POINT_SIZE_RANGE=33901,Gd.ALIASED_LINE_WIDTH_RANGE=33902,Gd.CULL_FACE_MODE=2885,Gd.FRONT_FACE=2886,Gd.DEPTH_RANGE=2928,Gd.DEPTH_WRITEMASK=2930,Gd.DEPTH_CLEAR_VALUE=2931,Gd.DEPTH_FUNC=2932,Gd.STENCIL_CLEAR_VALUE=2961,Gd.STENCIL_FUNC=2962,Gd.STENCIL_FAIL=2964,Gd.STENCIL_PASS_DEPTH_FAIL=2965,Gd.STENCIL_PASS_DEPTH_PASS=2966,Gd.STENCIL_REF=2967,Gd.STENCIL_VALUE_MASK=2963,Gd.STENCIL_WRITEMASK=2968,Gd.STENCIL_BACK_FUNC=34816,Gd.STENCIL_BACK_FAIL=34817,Gd.STENCIL_BACK_PASS_DEPTH_FAIL=34818,Gd.STENCIL_BACK_PASS_DEPTH_PASS=34819,Gd.STENCIL_BACK_REF=36003,Gd.STENCIL_BACK_VALUE_MASK=36004,Gd.STENCIL_BACK_WRITEMASK=36005,Gd.VIEWPORT=2978,Gd.SCISSOR_BOX=3088,Gd.COLOR_CLEAR_VALUE=3106,Gd.COLOR_WRITEMASK=3107,Gd.UNPACK_ALIGNMENT=3317,Gd.PACK_ALIGNMENT=3333,Gd.MAX_TEXTURE_SIZE=3379,Gd.MAX_VIEWPORT_DIMS=3386,Gd.SUBPIXEL_BITS=3408,Gd.RED_BITS=3410,Gd.GREEN_BITS=3411,Gd.BLUE_BITS=3412,Gd.ALPHA_BITS=3413,Gd.DEPTH_BITS=3414,Gd.STENCIL_BITS=3415,Gd.POLYGON_OFFSET_UNITS=10752,Gd.POLYGON_OFFSET_FACTOR=32824,Gd.TEXTURE_BINDING_2D=32873,Gd.SAMPLE_BUFFERS=32936,Gd.SAMPLES=32937,Gd.SAMPLE_COVERAGE_VALUE=32938,Gd.SAMPLE_COVERAGE_INVERT=32939,Gd.NUM_COMPRESSED_TEXTURE_FORMATS=34466,Gd.COMPRESSED_TEXTURE_FORMATS=34467,Gd.DONT_CARE=4352,Gd.FASTEST=4353,Gd.NICEST=4354,Gd.GENERATE_MIPMAP_HINT=33170,Gd.BYTE=5120,Gd.UNSIGNED_BYTE=5121,Gd.SHORT=5122,Gd.UNSIGNED_SHORT=5123,Gd.INT=5124,Gd.UNSIGNED_INT=5125,Gd.FLOAT=5126,Gd.DEPTH_COMPONENT=6402,Gd.ALPHA=6406,Gd.RGB=6407,Gd.RGBA=6408,Gd.LUMINANCE=6409,Gd.LUMINANCE_ALPHA=6410,Gd.UNSIGNED_SHORT_4_4_4_4=32819,Gd.UNSIGNED_SHORT_5_5_5_1=32820,Gd.UNSIGNED_SHORT_5_6_5=33635,Gd.FRAGMENT_SHADER=35632,Gd.VERTEX_SHADER=35633,Gd.MAX_VERTEX_ATTRIBS=34921,Gd.MAX_VERTEX_UNIFORM_VECTORS=36347,Gd.MAX_VARYING_VECTORS=36348,Gd.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,Gd.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,Gd.MAX_TEXTURE_IMAGE_UNITS=34930,Gd.MAX_FRAGMENT_UNIFORM_VECTORS=36349,Gd.SHADER_TYPE=35663,Gd.DELETE_STATUS=35712,Gd.LINK_STATUS=35714,Gd.VALIDATE_STATUS=35715,Gd.ATTACHED_SHADERS=35717,Gd.ACTIVE_UNIFORMS=35718,Gd.ACTIVE_ATTRIBUTES=35721,Gd.SHADING_LANGUAGE_VERSION=35724,Gd.CURRENT_PROGRAM=35725,Gd.NEVER=512,Gd.LESS=513,Gd.EQUAL=514,Gd.LEQUAL=515,Gd.GREATER=516,Gd.NOTEQUAL=517,Gd.GEQUAL=518,Gd.ALWAYS=519,Gd.KEEP=7680,Gd.REPLACE=7681,Gd.INCR=7682,Gd.DECR=7683,Gd.INVERT=5386,Gd.INCR_WRAP=34055,Gd.DECR_WRAP=34056,Gd.VENDOR=7936,Gd.RENDERER=7937,Gd.VERSION=7938,Gd.NEAREST=9728,Gd.LINEAR=9729,Gd.NEAREST_MIPMAP_NEAREST=9984,Gd.LINEAR_MIPMAP_NEAREST=9985,Gd.NEAREST_MIPMAP_LINEAR=9986,Gd.LINEAR_MIPMAP_LINEAR=9987,Gd.TEXTURE_MAG_FILTER=10240,Gd.TEXTURE_MIN_FILTER=10241,Gd.TEXTURE_WRAP_S=10242,Gd.TEXTURE_WRAP_T=10243,Gd.TEXTURE_2D=3553,Gd.TEXTURE=5890,Gd.TEXTURE_CUBE_MAP=34067,Gd.TEXTURE_BINDING_CUBE_MAP=34068,Gd.TEXTURE_CUBE_MAP_POSITIVE_X=34069,Gd.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,Gd.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,Gd.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,Gd.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,Gd.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,Gd.MAX_CUBE_MAP_TEXTURE_SIZE=34076,Gd.TEXTURE0=33984,Gd.TEXTURE1=33985,Gd.TEXTURE2=33986,Gd.TEXTURE3=33987,Gd.TEXTURE4=33988,Gd.TEXTURE5=33989,Gd.TEXTURE6=33990,Gd.TEXTURE7=33991,Gd.TEXTURE8=33992,Gd.TEXTURE9=33993,Gd.TEXTURE10=33994,Gd.TEXTURE11=33995,Gd.TEXTURE12=33996,Gd.TEXTURE13=33997,Gd.TEXTURE14=33998,Gd.TEXTURE15=33999,Gd.TEXTURE16=34e3,Gd.TEXTURE17=34001,Gd.TEXTURE18=34002,Gd.TEXTURE19=34003,Gd.TEXTURE20=34004,Gd.TEXTURE21=34005,Gd.TEXTURE22=34006,Gd.TEXTURE23=34007,Gd.TEXTURE24=34008,Gd.TEXTURE25=34009,Gd.TEXTURE26=34010,Gd.TEXTURE27=34011,Gd.TEXTURE28=34012,Gd.TEXTURE29=34013,Gd.TEXTURE30=34014,Gd.TEXTURE31=34015,Gd.ACTIVE_TEXTURE=34016,Gd.REPEAT=10497,Gd.CLAMP_TO_EDGE=33071,Gd.MIRRORED_REPEAT=33648,Gd.FLOAT_VEC2=35664,Gd.FLOAT_VEC3=35665,Gd.FLOAT_VEC4=35666,Gd.INT_VEC2=35667,Gd.INT_VEC3=35668,Gd.INT_VEC4=35669,Gd.BOOL=35670,Gd.BOOL_VEC2=35671,Gd.BOOL_VEC3=35672,Gd.BOOL_VEC4=35673,Gd.FLOAT_MAT2=35674,Gd.FLOAT_MAT3=35675,Gd.FLOAT_MAT4=35676,Gd.SAMPLER_2D=35678,Gd.SAMPLER_CUBE=35680,Gd.VERTEX_ATTRIB_ARRAY_ENABLED=34338,Gd.VERTEX_ATTRIB_ARRAY_SIZE=34339,Gd.VERTEX_ATTRIB_ARRAY_STRIDE=34340,Gd.VERTEX_ATTRIB_ARRAY_TYPE=34341,Gd.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,Gd.VERTEX_ATTRIB_ARRAY_POINTER=34373,Gd.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,Gd.COMPILE_STATUS=35713,Gd.LOW_FLOAT=36336,Gd.MEDIUM_FLOAT=36337,Gd.HIGH_FLOAT=36338,Gd.LOW_INT=36339,Gd.MEDIUM_INT=36340,Gd.HIGH_INT=36341,Gd.FRAMEBUFFER=36160,Gd.RENDERBUFFER=36161,Gd.RGBA4=32854,Gd.RGB5_A1=32855,Gd.RGB565=36194,Gd.DEPTH_COMPONENT16=33189,Gd.STENCIL_INDEX=6401,Gd.STENCIL_INDEX8=36168,Gd.DEPTH_STENCIL=34041,Gd.RENDERBUFFER_WIDTH=36162,Gd.RENDERBUFFER_HEIGHT=36163,Gd.RENDERBUFFER_INTERNAL_FORMAT=36164,Gd.RENDERBUFFER_RED_SIZE=36176,Gd.RENDERBUFFER_GREEN_SIZE=36177,Gd.RENDERBUFFER_BLUE_SIZE=36178,Gd.RENDERBUFFER_ALPHA_SIZE=36179,Gd.RENDERBUFFER_DEPTH_SIZE=36180,Gd.RENDERBUFFER_STENCIL_SIZE=36181,Gd.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,Gd.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,Gd.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,Gd.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,Gd.COLOR_ATTACHMENT0=36064,Gd.DEPTH_ATTACHMENT=36096,Gd.STENCIL_ATTACHMENT=36128,Gd.DEPTH_STENCIL_ATTACHMENT=33306,Gd.NONE=0,Gd.FRAMEBUFFER_COMPLETE=36053,Gd.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,Gd.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,Gd.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,Gd.FRAMEBUFFER_UNSUPPORTED=36061,Gd.FRAMEBUFFER_BINDING=36006,Gd.RENDERBUFFER_BINDING=36007,Gd.MAX_RENDERBUFFER_SIZE=34024,Gd.INVALID_FRAMEBUFFER_OPERATION=1286,Gd.UNPACK_FLIP_Y_WEBGL=37440,Gd.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,Gd.CONTEXT_LOST_WEBGL=37442,Gd.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,Gd.BROWSER_DEFAULT_WEBGL=37444,Gd._useProgram=null,Gd._depthTest=!0,Gd._depthMask=!0,Gd._blend=!1,Gd._cullFace=!1,Gd.curBindTexTarget=null,Gd.curBindTexValue=null,Gg(Gd,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),Gd}(),Gya=function(Ga){function Gb(){Gb.__super.call(this)}Go(Gb,"laya.webgl.display.GraphicsGL",Gh);var Gc=Gb.prototype;return Gc.setShader=function(Ga){this._saveToCmd(Gt.context._setShader,[Ga])},Gc.setIBVB=function(Ga,Gb,Gc,Gd,Ge,Gf){this._saveToCmd(Gt.context._setIBVB,[Ga,Gb,Gc,Gd,Ge,Gf])},Gc.drawParticle=function(Ga,Gb,Gc){var Gd=Gx.createParticleTemplate2D(Gc);Gd.x=Ga,Gd.y=Gb,this._saveToCmd(Gt.context._drawParticle,[Gd])},Gb}(),Gza=function(Ga){var Gc;function GP(Ga){this._x=0,this._y=0,this._id=++GP._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,GP.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=GP.MAXCLIPRECT,this.mOutPoint,this._canvas=Ga,this._canvas._addReference(),GP._contextcount++,Gt.isFlash?(this._ib=Gma.create(35044),Gsa.fillIBQuadrangle(this._ib,16)):this._ib=Gma.QuadrangleIB,this.clear()}Go(GP,"laya.webgl.canvas.WebGLContext2D",Ge);var Gb=GP.prototype;return Gb.setIsMainContext=function(){this._isMain=!0},Gb.clearBG=function(Ga,Gb,Gc,Gd){var Ge=Gwa.mainContext;Ge.clearColor(Ga,Gb,Gc,Gd),Ge.clear(16384)},Gb._getSubmits=function(){return this._submits},Gb._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var Ga=0,Gb=this._submits._length;Ga<Gb;Ga++)this._submits[Ga].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},Gb.destroy=function(){--GP._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=Gma.QuadrangleIB&&this._ib.releaseResource()},Gb.clear=function(){this._submits||(this._other=Gc.DEFAULT,this._curMat=GB.create(),this._vb=Gna.create(-1),this._submits=[],this._save=[GY.Create(this)],this._save.length=10,this._shader2D=new Gm,this._triangleMesh=GKa.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=Gc.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=GP.MAXCLIPRECT,this._curSubmit=Gfa.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=GT.DEFAULT;for(var Ga=0,Gb=this._submits._length;Ga<Gb;Ga++)this._submits[Ga].releaseRender(),this._submits[Ga]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},Gb.size=function(Ga,Gb){if(this._width!=Ga||this._height!=Gb)if(0==Ga||0==Gb){0!=this._vb._byteLength&&(this._width=Ga,this._height=Gb,this._vb.clear(),this._vb.upload());for(var Gc=0,Gd=this._submits._length;Gc<Gd;Gc++)this._submits[Gc].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=Ga,this._height=Gb,this._targets&&this._targets.size(Ga,Gb),this._canvas.memorySize-=this._canvas.memorySize;0===Ga&&0===Gb&&this._releaseMem()},Gb._getTransformMatrix=function(){return this._curMat},Gb.translate=function(Ga,Gb){0===Ga&&0===Gb||(G$.save(this),this._curMat.bTransform&&(GZ.save(this),this._curMat.transformPointN(GC.TEMP.setTo(Ga,Gb)),Ga=GC.TEMP.x,Gb=GC.TEMP.y),this._x+=Ga,this._y+=Gb)},Gb.save=function(){this._save[this._save._length++]=GY.Create(this)},Gb.restore=function(){var Ga=this._save._length;if(!(Ga<1))for(var Gb=Ga-1;0<=Gb;Gb--){var Gc=this._save[Gb];if(Gc.restore(this),Gc.isSaveMark())return void(this._save._length=Gb)}},Gb._fillText=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){void 0===Gj&&(Gj=0);var Gk=this._shader2D,Gl=this._curSubmit.shaderValue,Go=Ge?Gqa.create(Ge):this._other.font;if(GQ.enabled)Gk.ALPHA!==Gl.ALPHA&&(Gk.glTexture=null),Gpa.drawText(this,Ga,Gb,this._curMat,Go,Gi||this._other.textAlign,Gf,Gg,Gh,Gc,Gd,Gj);else{this._shader2D.defines.getValue();var Gp=Gf?Gq.create(Gf)._color:Gk.colorAdd;Gk.ALPHA===Gl.ALPHA&&Gp===Gk.colorAdd&&Gl.colorAdd===Gk.colorAdd||(Gk.glTexture=null,Gk.colorAdd=Gp),Gpa.drawText(this,Ga,Gb,this._curMat,Go,Gi||this._other.textAlign,Gf,Gg,Gh,Gc,Gd,Gj)}},Gb.fillWords=function(Ga,Gb,Gc,Gd,Ge,Gf){this._fillText(null,Ga,Gb,Gc,Gd,Ge,null,-1,null,Gf)},Gb.fillBorderWords=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this._fillBorderText(null,Ga,Gb,Gc,Gd,Ge,Gf,Gg,null)},Gb.fillText=function(Ga,Gb,Gc,Gd,Ge,Gf){this._fillText(Ga,null,Gb,Gc,Gd,Ge,null,-1,Gf)},Gb.strokeText=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this._fillText(Ga,null,Gb,Gc,Gd,null,Ge,Gf||1,Gg)},Gb.fillBorderText=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){this._fillBorderText(Ga,null,Gb,Gc,Gd,Ge,Gf,Gg,Gh)},Gb._fillBorderText=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){if(!GQ.enabled)return this._fillText(Ga,Gb,Gc,Gd,Ge,null,Gg,Gh||1,Gi),void this._fillText(Ga,Gb,Gc,Gd,Ge,Gf,null,-1,Gi);var Gj=this._shader2D,Gk=this._curSubmit.shaderValue;Gj.ALPHA!==Gk.ALPHA&&(Gj.glTexture=null);var Gl=Ge?(GP._fontTemp.setFont(Ge),GP._fontTemp):this._other.font;Gpa.drawText(this,Ga,Gb,this._curMat,Gl,Gi||this._other.textAlign,Gf,Gg,Gh||1,Gc,Gd,0)},Gb.fillRect=function(Ga,Gb,Gc,Gd,Ge){var Gf=this._vb;if(Gsa.fillRectImgVb(Gf,this._clipRect,Ga,Gb,Gc,Gd,GK.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var Gg=this._shader2D.fillStyle;Ge&&(this._shader2D.fillStyle=GT.create(Ge));var Gh=this._shader2D,Gi=this._curSubmit.shaderValue;if(Gh.fillStyle!==Gi.fillStyle||Gh.ALPHA!==Gi.ALPHA){Gh.glTexture=null;var Gj=this._curSubmit=Gfa.createSubmit(this,this._ib,Gf,(Gf._byteLength-64)/32*3,GAa.create(2,0));Gj.shaderValue.color=Gh.fillStyle._color._color,Gj.shaderValue.ALPHA=Gh.ALPHA,this._submits[this._submits._length++]=Gj}this._curSubmit._numEle+=6,this._shader2D.fillStyle=Gg}},Gb.fillTexture=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){if(Ga.loaded&&Ga.bitmap&&Ga.source){var Gi=this._vb,Gj=Ga.bitmap.width,Gk=Ga.bitmap.height,Gl=Ga.uv,Go=Gg.x%Ga.width,Gp=Gg.y%Ga.height;if(Gj!=Gh.w||Gk!=Gh.h){if(!Gh.w&&!Gh.h)switch(Gh.oy=Gh.ox=0,Gf){case"repeat":Gh.width=Gd,Gh.height=Ge;break;case"repeat-x":Gh.width=Gd,Gp<0?Ga.height+Gp>Ge?Gh.height=Ge:Gh.height=Ga.height+Gp:(Gh.oy=Gp,Ga.height+Gp>Ge?Gh.height=Ge-Gp:Gh.height=Ga.height);break;case"repeat-y":Go<0?Ga.width+Go>Gd?Gh.width=Gd:Gh.width=Ga.width+Go:(Gh.ox=Go,Ga.width+Go>Gd?Gh.width=Gd-Go:Gh.width=Ga.width),Gh.height=Ge;break;case"no-repeat":Go<0?Ga.width+Go>Gd?Gh.width=Gd:Gh.width=Ga.width+Go:(Gh.ox=Go,Ga.width+Go>Gd?Gh.width=Gd-Go:Gh.width=Ga.width),Gp<0?Ga.height+Gp>Ge?Gh.height=Ge:Gh.height=Ga.height+Gp:(Gh.oy=Gp,Ga.height+Gp>Ge?Gh.height=Ge-Gp:Gh.height=Ga.height);break;default:Gh.width=Gd,Gh.height=Ge}Gh.w=Gj,Gh.h=Gk,Gh.uv=[0,0,Gh.width/Gj,0,Gh.width/Gj,Gh.height/Gk,0,Gh.height/Gk]}if(Gb+=Gh.ox,Gc+=Gh.oy,Go-=Gh.ox,Gp-=Gh.oy,Gsa.fillRectImgVb(Gi,this._clipRect,Gb,Gc,Gh.width,Gh.height,Gh.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var Gq=GJa.create(this,this._ib,Gi,(Gi._byteLength-64)/32*3,GAa.create(256,0)),Gr=(this._submits[this._submits._length++]=Gq).shaderValue;Gr.textureHost=Ga;var Gs=Gl[0]*Gj,Gt=Gl[1]*Gk,Gu=(Gl[2]-Gl[0])*Gj,Gv=(Gl[5]-Gl[3])*Gk,Gw=-Go/Gj,Gx=-Gp/Gk;Gr.u_TexRange[0]=Gs/Gj,Gr.u_TexRange[1]=Gu/Gj,Gr.u_TexRange[2]=Gt/Gk,Gr.u_TexRange[3]=Gv/Gk,Gr.u_offset[0]=Gw,Gr.u_offset[1]=Gx,GQ.enabled&&!this._isMain&&Gq.addTexture(Ga,(Gi._byteLength>>2)-16),(this._curSubmit=Gq)._renderType=10017,Gq._numEle+=6}}else this.sprite&&Gy.timer.callLater(this,this._repaintSprite)},Gb.setShader=function(Ga){GV.save(this,1048576,this._shader2D,!0),this._shader2D.shader=Ga},Gb.setFilters=function(Ga){GV.save(this,2097152,this._shader2D,!0),this._shader2D.filters=Ga,this._curSubmit=Gfa.RENDERBASE,this._renderKey=0,this._drawCount++},Gb.drawTexture=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this._drawTextureM(Ga,Gb,Gc,Gd,Ge,Gf,Gg,null,1)},Gb.addTextureVb=function(Ga,Gb,Gc){var Gd=this._curSubmit._vb||this._vb,Ge=Gd._byteLength>>2;Gd.byteLength=Ge+16<<2;for(var Gf=Gd.getFloat32Array(),Gg=0;Gg<16;Gg+=4)Gf[Ge++]=Ga[Gg]+Gb,Gf[Ge++]=Ga[Gg+1]+Gc,Gf[Ge++]=Ga[Gg+2],Gf[Ge++]=Ga[Gg+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),Gd._upload=!0},Gb.willDrawTexture=function(Ga,Gb){if(!(Ga.loaded&&Ga.bitmap&&Ga.source))return this.sprite&&Gy.timer.callLater(this,this._repaintSprite),0;var Gc=Ga.bitmap,Gd=Gc.id+this._shader2D.ALPHA*Gb+10016;if(Gd==this._renderKey)return Gd;var Ge=this._shader2D,Gf=Ge.ALPHA,Gg=this._curSubmit.shaderValue;Ge.ALPHA*=Gb,this._renderKey=Gd,this._drawCount++,Ge.glTexture=Gc;var Gh=this._vb,Gi=null,Gj=Gh._byteLength/32*3,Gk=Gg.textureHost&&Gg.textureHost==Ga&&Gg.textureHost.alphaTexture==Ga.alphaTexture;return Gi=GJa.create(this,this._ib,Gh,Gj,GAa.create(1,0)),(this._submits[this._submits._length++]=Gi).shaderValue.textureHost=Ga,Gi._renderType=10016,Gi._preIsSameTextureShader=10016===this._curSubmit._renderType&&Ge.ALPHA===Gg.ALPHA&&Gk,this._curSubmit=Gi,Ge.ALPHA=Gf,Gd},Gb.drawTextures=function(Ga,Gb,Gc,Gd){if(Ga.loaded&&Ga.bitmap&&Ga.source){var Ge=this._clipRect;if(this._clipRect=GP.MAXCLIPRECT,this._drawTextureM(Ga,Gb[0],Gb[1],Ga.width,Ga.height,Gc,Gd,null,1)){if(this._clipRect=Ge,GG.drawCall++,!(Gb.length<4)){for(var Gf=this._curSubmit._vb||this._vb,Gg=this._curMat.a,Gh=this._curMat.d,Gi=2,Gj=Gb.length;Gi<Gj;Gi+=2)Gsa.copyPreImgVb(Gf,(Gb[Gi]-Gb[Gi-2])*Gg,(Gb[Gi+1]-Gb[Gi-1])*Gh),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&Gy.timer.callLater(this,this._repaintSprite)},Gb._drawTextureM=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){if(!Ga.loaded||!Ga.source)return this.sprite&&Gy.timer.callLater(this,this._repaintSprite),!1;var Gj=this._curSubmit._vb||this._vb,Gk=Ga.bitmap;Gb+=Gf,Gc+=Gg,this._drawCount++;var Gl=Gk.id+this._shader2D.ALPHA*Gi+10016;if(Gl!=this._renderKey){this._renderKey=Gl;var Go=this._curSubmit.shaderValue,Gp=this._shader2D,Gq=Gp.ALPHA;Gp.ALPHA*=Gi,Gp.glTexture=Gk;var Gr=this._vb,Gs=null,Gt=Gr._byteLength/32*3,Gu=Go.textureHost&&Go.textureHost==Ga&&Go.textureHost.alphaTexture==Ga.alphaTexture;Gs=GJa.create(this,this._ib,Gr,Gt,GAa.create(1,0)),(this._submits[this._submits._length++]=Gs).shaderValue.textureHost=Ga,Gs._renderType=10016,Gs._preIsSameTextureShader=10016===this._curSubmit._renderType&&Gp.ALPHA===Go.ALPHA&&Gu,this._curSubmit=Gs,Gj=this._curSubmit._vb||this._vb,Gp.ALPHA=Gq}return!!Gsa.fillRectImgVb(Gj,this._clipRect,Gb,Gc,Gd||Ga.width,Ge||Ga.height,Ga.uv,Gh||this._curMat,this._x,this._y,0,0)&&(GQ.enabled&&!this._isMain&&this._curSubmit.addTexture(Ga,(Gj._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},Gb._repaintSprite=function(){this.sprite&&this.sprite.repaint()},Gb._drawText=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){var Gk=Ga.bitmap;this._drawCount++;var Gl=Gk.id+this._shader2D.ALPHA+10016;if(Gl!=this._renderKey){this._renderKey=Gl;var Go=this._curSubmit.shaderValue,Gp=this._shader2D;Gp.glTexture=Gk;var Gq=this._vb,Gr=null,Gs=Gq._byteLength/32*3,Gt=Go.textureHost&&Go.textureHost==Ga&&Go.textureHost.alphaTexture==Ga.alphaTexture;(Gr=GQ.enabled?GJa.create(this,this._ib,Gq,Gs,GAa.create(1,0)):GJa.create(this,this._ib,Gq,Gs,G$a.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&Gp.ALPHA===Go.ALPHA&&Gt,(this._submits[this._submits._length++]=Gr).shaderValue.textureHost=Ga,Gr._renderType=10016,this._curSubmit=Gr}Ga.active();var Gu=this._curSubmit._vb||this._vb;Gsa.fillRectImgVb(Gu,this._clipRect,Gb+Gg,Gc+Gh,Gd||Ga.width,Ge||Ga.height,Ga.uv,Gf||this._curMat,this._x,this._y,Gi,Gj,!0)&&(GQ.enabled&&!this._isMain&&this._curSubmit.addTexture(Ga,(Gu._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},Gb.drawTextureWithTransform=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){if(Gf){var Gj=this._curMat,Gk=this._x,Gl=this._y;(0!==Gg||0!==Gh)&&(this._x=Gg*Gj.a+Gh*Gj.c,this._y=Gh*Gj.d+Gg*Gj.b),Gf&&Gj.bTransform?(GB.mul(Gf,Gj,GP._tmpMatrix),(Gf=GP._tmpMatrix)._checkTransform()):(this._x+=Gj.tx,this._y+=Gj.ty),this._drawTextureM(Ga,Gb,Gc,Gd,Ge,0,0,Gf,Gi),this._x=Gk,this._y=Gl}else this._drawTextureM(Ga,Gb,Gc,Gd,Ge,Gg,Gh,null,Gi)},Gb.fillQuadrangle=function(Ga,Gb,Gc,Gd,Ge){var Gf=this._curSubmit,Gg=this._vb,Gh=this._shader2D,Gi=Gf.shaderValue;if(this._renderKey=0,Ga.bitmap){var Gj=Ga.bitmap;Gh.glTexture==Gj&&Gh.ALPHA===Gi.ALPHA||(Gh.glTexture=Gj,(Gf=this._curSubmit=Gfa.createSubmit(this,this._ib,Gg,Gg._byteLength/32*3,GAa.create(1,0))).shaderValue.glTexture=Gj,this._submits[this._submits._length++]=Gf),Gsa.fillQuadrangleImgVb(Gg,Gb,Gc,Gd,Ga.uv,Ge||this._curMat,this._x,this._y)}else Gf.shaderValue.fillStyle&&Gf.shaderValue.fillStyle.equal(Ga)&&Gh.ALPHA===Gi.ALPHA||(Gh.glTexture=null,(Gf=this._curSubmit=Gfa.createSubmit(this,this._ib,Gg,Gg._byteLength/32*3,GAa.create(2,0))).shaderValue.defines.add(2),Gf.shaderValue.fillStyle=GT.create(Ga),this._submits[this._submits._length++]=Gf),Gsa.fillQuadrangleImgVb(Gg,Gb,Gc,Gd,GK.DEF_UV,Ge||this._curMat,this._x,this._y);Gf._numEle+=6},Gb.drawTexture2=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){if(0!=Gf){var Gi=this._curMat;if(this._x=Ga*Gi.a+Gb*Gi.c,this._y=Gb*Gi.d+Ga*Gi.b,Ge&&(Ge=Gi.bTransform||Ge.bTransform?(GB.mul(Ge,Gi,GP._tmpMatrix),GP._tmpMatrix):(this._x+=Ge.tx+Gi.tx,this._y+=Ge.ty+Gi.ty,GB.EMPTY)),1!==Gf||Gg){var Gj=this._shader2D.ALPHA,Gk=this._nBlendType;this._shader2D.ALPHA=Gf,Gg&&(this._nBlendType=GS.TOINT(Gg)),this._drawTextureM(Gh[0],Gh[1]-Gc,Gh[2]-Gd,Gh[3],Gh[4],0,0,Ge,1),this._shader2D.ALPHA=Gj,this._nBlendType=Gk}else this._drawTextureM(Gh[0],Gh[1]-Gc,Gh[2]-Gd,Gh[3],Gh[4],0,0,Ge,1);this._x=this._y=0}},Gb.drawCanvas=function(Ga,Gb,Gc,Gd,Ge){var Gf=Ga.context;if(this._renderKey=0,Gf._targets)this._submits[this._submits._length++]=GIa.create(Gf,0,null),this._curSubmit=Gfa.RENDERBASE,Gf._targets.drawTo(this,Gb,Gc,Gd,Ge);else{var Gg=this._submits[this._submits._length++]=GIa.create(Gf,this._shader2D.ALPHA,this._shader2D.filters),Gh=Gd/Ga.width,Gi=Ge/Ga.height,Gj=Gg._matrix;this._curMat.copyTo(Gj),1!=Gh&&1!=Gi&&Gj.scale(Gh,Gi);var Gk=Gj.tx,Gl=Gj.ty;Gj.tx=Gj.ty=0,Gj.transformPoint(GC.TEMP.setTo(Gb,Gc)),Gj.translate(GC.TEMP.x+Gk,GC.TEMP.y+Gl),this._curSubmit=Gfa.RENDERBASE}Gz.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=Gf._targets?"yellow":"green",this.strokeRect(Gb-1,Gc-1,Gd+2,Ge+2,1),this.strokeRect(Gb,Gc,Gd,Ge,1),this.restore())},Gb.drawTarget=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){void 0===Gj&&(Gj=-1);var Gk=this._vb;if(Gsa.fillRectImgVb(Gk,this._clipRect,Gb,Gc,Gd,Ge,Gi||GK.DEF_UV,Gf||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var Gl=this._curSubmit=Gla.create(this,this._ib,Gk,(Gk._byteLength-64)/32*3,Gh,Gg);Gl.blendType=-1==Gj?this._nBlendType:Gj,Gl.scope=Ga,this._submits[this._submits._length++]=Gl,this._curSubmit._numEle+=6}},Gb.mixRGBandAlpha=function(Ga){return this._mixRGBandAlpha(Ga,this._shader2D.ALPHA)},Gb._mixRGBandAlpha=function(Ga,Gb){var Gc=(4278190080&Ga)>>>24;return 0!=Gc?Gc*=Gb:Gc=255*Gb,16777215&Ga|Gc<<24},Gb.drawTriangles=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){if(!Ga.loaded||!Ga.source)return this.sprite&&Gy.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;Ga.bitmap;var Gk=this._mixRGBandAlpha(4294967295,Gh),Gl=(Gd.length,Gf.length);this._renderKey=-1;var Go=this._curSubmit=GJa.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,GAa.create(1,0));return Go.shaderValue.textureHost=Ga,Go._renderType=10016,this._submits[this._submits._length++]=Go,Gg?(GP._tmpMatrix.a=Gg.a,GP._tmpMatrix.b=Gg.b,GP._tmpMatrix.c=Gg.c,GP._tmpMatrix.d=Gg.d,GP._tmpMatrix.tx=Gg.tx+Gb,GP._tmpMatrix.ty=Gg.ty+Gc,GB.mul(GP._tmpMatrix,this._curMat,GP._tmpMatrix)):(GP._tmpMatrix.a=this._curMat.a,GP._tmpMatrix.b=this._curMat.b,GP._tmpMatrix.c=this._curMat.c,GP._tmpMatrix.d=this._curMat.d,GP._tmpMatrix.tx=this._curMat.tx+Gb,GP._tmpMatrix.ty=this._curMat.ty+Gc),this._triangleMesh.addData(Gd,Ge,Gf,GP._tmpMatrix,Gk,this),this._curSubmit._numEle+=Gl,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},Gb.transform=function(Ga,Gb,Gc,Gd,Ge,Gf){GZ.save(this),GB.mul(GB.TEMP.setTo(Ga,Gb,Gc,Gd,Ge,Gf),this._curMat,this._curMat),this._curMat._checkTransform()},Gb.setTransformByMatrix=function(Ga){Ga.copyTo(this._curMat)},Gb.transformByMatrix=function(Ga){GZ.save(this),GB.mul(Ga,this._curMat,this._curMat),this._curMat._checkTransform()},Gb.rotate=function(Ga){GZ.save(this),this._curMat.rotateEx(Ga)},Gb.scale=function(Ga,Gb){GZ.save(this),this._curMat.scaleEx(Ga,Gb)},Gb.clipRect=function(Ga,Gb,Gc,Gd){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var Ge=Gka.create(4);this.addRenderObject(Ge);var Gf=this._vb,Gg=Gf._byteLength>>2;if(Gsa.fillRectImgVb(Gf,null,Ga,Gb,Gc,Gd,GK.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var Gh=this._curSubmit=Gfa.createSubmit(this,this._ib,Gf,(Gf._byteLength-64)/32*3,GAa.create(2,0));Gh.shaderValue.ALPHA=1,this._submits[this._submits._length++]=Gh,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var Gi=Gka.create(5);this.addRenderObject(Gi);var Gj=Gf.getFloat32Array(),Gk=Math.min(Math.min(Math.min(Gj[0+Gg],Gj[4+Gg]),Gj[8+Gg]),Gj[12+Gg]),Gl=Math.max(Math.max(Math.max(Gj[0+Gg],Gj[4+Gg]),Gj[8+Gg]),Gj[12+Gg]),Go=Math.min(Math.min(Math.min(Gj[1+Gg],Gj[5+Gg]),Gj[9+Gg]),Gj[13+Gg]),Gp=Math.max(Math.max(Math.max(Gj[1+Gg],Gj[5+Gg]),Gj[9+Gg]),Gj[13+Gg]);GX.save(this,Gi,Ga,Gb,Gc,Gd,Gk,Go,Gl-Gk,Gp-Go),this._curSubmit=Gfa.RENDERBASE}else{Gc*=this._curMat.a,Gd*=this._curMat.d;var Gq=GC.TEMP;this._curMat.transformPoint(Gq.setTo(Ga,Gb)),Gc<0&&(Gq.x=Gq.x+Gc,Gc=-Gc),Gd<0&&(Gq.y=Gq.y+Gd,Gd=-Gd),this._renderKey=0;var Gr=this._curSubmit=Gja.create(this);(this._submits[this._submits._length++]=Gr).submitIndex=this._submits._length,Gr.submitLength=9999999,GW.save(this,Gr);var Gs=this._clipRect,Gt=Gs.x,Gu=Gs.y,Gv=Gq.x+Gc,Gw=Gq.y+Gd;Gt<Gq.x&&(Gs.x=Gq.x),Gu<Gq.y&&(Gs.y=Gq.y),Gs.width=Math.min(Gv,Gt+Gs.width)-Gs.x,Gs.height=Math.min(Gw,Gu+Gs.height)-Gs.y,this._shader2D.glTexture=null,Gr.clipRect.copyFrom(Gs),this._curSubmit=Gfa.RENDERBASE}},Gb.setIBVB=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk){if(void 0===Gi&&(Gi=0),void 0===Gj&&(Gj=0),void 0===Gk&&(Gk=0),null===Gc){if(Gt.isFlash){var Gl=Gd;Gl._selfIB||(Gl._selfIB=Gma.create(35044)),Gl._selfIB.clear(),Gc=Gl._selfIB}else Gc=this._ib;Gsa.expandIBQuadrangle(Gc,Gd._byteLength/(4*Gd.vertexStride*4))}if(!Gh||!Gg)throw Error("setIBVB must input:shader shaderValues");var Go=Gia.create(this,Gd,Gc,Ge,Gg,Gh,Gi,Gj,Gk);Gf||(Gf=GB.EMPTY),Gf.translate(Ga,Gb),GB.mul(Gf,this._curMat,Go._mat),Gf.translate(-Ga,-Gb),this._submits[this._submits._length++]=Go,this._curSubmit=Gfa.RENDERBASE,this._renderKey=0},Gb.addRenderObject=function(Ga){this._submits[this._submits._length++]=Ga},Gb.fillTrangles=function(Ga,Gb,Gc,Gd,Ge){var Gf=this._curSubmit,Gg=this._vb,Gh=this._shader2D,Gi=Gf.shaderValue,Gj=Gd.length>>4,Gk=Ga.bitmap;this._renderKey=0,Gh.glTexture==Gk&&Gh.ALPHA===Gi.ALPHA||((Gf=this._curSubmit=Gfa.createSubmit(this,this._ib,Gg,Gg._byteLength/32*3,GAa.create(1,0))).shaderValue.textureHost=Ga,this._submits[this._submits._length++]=Gf),Gsa.fillTranglesVB(Gg,Gb,Gc,Gd,Ge||this._curMat,this._x,this._y),Gf._numEle+=6*Gj},Gb.submitElement=function(Ga,Gb){var Gc=this._submits;for(Gb<0&&(Gb=Gc._length);Ga<Gb;)Ga+=Gc[Ga].renderSubmit()},Gb.finish=function(){Gwa.mainContext.finish()},Gb.flush=function(){var Ga=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(Ga>this._ib.bufferLength/12&&Gsa.expandIBQuadrangle(this._ib,Ga),!this._isMain&&GQ.enabled&&GQ._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=GQ._atlasRestore;for(var Gb=this._submits,Gc=0,Gd=Gb._length;Gc<Gd;Gc++){var Ge=Gb[Gc];10016===Ge.getRenderType()&&Ge.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),Gba.instance&&Gba.getInstance().reset();var Gf;for(Gc=0,Gf=this.meshlist.length;Gc<Gf;Gc++){var Gg=this.meshlist[Gc];Gg.canReuse?Gg.releaseMesh():Gg.destroy()}return this.meshlist.length=0,this._curSubmit=Gfa.RENDERBASE,this._renderKey=0,this._triangleMesh=GKa.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},Gb.setPathId=function(Ga){if(this.mId=Ga,-1!=this.mId){this.mHaveKey=!1;var Gb=GM.getInstance();Gb.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,Gb.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},Gb.movePath=function(Ga,Gb){var Gc=Ga,Gd=Gb;Ga=this._curMat.a*Gc+this._curMat.c*Gd+this._curMat.tx,Gb=this._curMat.b*Gc+this._curMat.d*Gd+this._curMat.ty,this.mX+=Ga,this.mY+=Gb},Gb.beginPath=function(){var Ga=this._getPath();Ga.tempArray.length=0,Ga.closePath=!1,this.mX=0,this.mY=0},Gb.closePath=function(){this._path.closePath=!0},Gb.fill=function(Ga){void 0===Ga&&(Ga=!1);var Gb=this._getPath();this.drawPoly(0,0,Gb.tempArray,this.fillStyle._color.numColor,0,0,Ga)},Gb.stroke=function(){var Ga=this._getPath();if(0<this.lineWidth){if(-1==this.mId)Ga.drawLine(0,0,Ga.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var Gb=GM.getInstance().shapeLineDic[this.mId];Gb.rebuild(Ga.tempArray),Ga.setGeomtry(Gb)}else GM.getInstance().addLine(this.mId,Ga.drawLine(0,0,Ga.tempArray,this.lineWidth,this.strokeStyle._color.numColor));Ga.update();var Gc=[this.mX,this.mY],Gd=Gfa.createShape(this,Ga.ib,Ga.vb,Ga.count,Ga.offset,GAa.create(4,0));Gd.shaderValue.ALPHA=this._shader2D.ALPHA,Gd.shaderValue.u_pos=Gc,Gd.shaderValue.u_mmat2=Gua.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=Gd,this._renderKey=-1}},Gb.line=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=this._curSubmit,Gh=this._vb;if(Gsa.fillLineVb(Gh,this._clipRect,Ga,Gb,Gc,Gd,Ge,Gf)){this._renderKey=0;var Gi=this._shader2D,Gj=Gg.shaderValue;Gi.strokeStyle===Gj.strokeStyle&&Gi.ALPHA===Gj.ALPHA||(Gi.glTexture=null,(Gg=this._curSubmit=Gfa.createSubmit(this,this._ib,Gh,(Gh._byteLength-64)/32*3,GAa.create(2,0))).shaderValue.strokeStyle=Gi.strokeStyle,Gg.shaderValue.mainID=2,Gg.shaderValue.ALPHA=Gi.ALPHA,this._submits[this._submits._length++]=Gg),Gg._numEle+=6}},Gb.moveTo=function(Ga,Gb,Gc){void 0===Gc&&(Gc=!0);var Gd=this._getPath();if(Gc){var Ge=Ga,Gf=Gb;Ga=this._curMat.a*Ge+this._curMat.c*Gf,Gb=this._curMat.b*Ge+this._curMat.d*Gf}Gd.addPoint(Ga,Gb)},Gb.lineTo=function(Ga,Gb,Gc){void 0===Gc&&(Gc=!0);var Gd=this._getPath();if(Gc){var Ge=Ga,Gf=Gb;Ga=this._curMat.a*Ge+this._curMat.c*Gf,Gb=this._curMat.b*Ge+this._curMat.d*Gf}Gd.addPoint(Ga,Gb)},Gb.drawCurves=function(Ga,Gb,Gc){this.setPathId(-1),this.beginPath(),this.strokeStyle=Gc[3],this.lineWidth=Gc[4];var Gd=Gc[2];Ga+=Gc[0],Gb+=Gc[1],this.movePath(Ga,Gb),this.moveTo(Gd[0],Gd[1]);for(var Ge=2,Gf=Gd.length;Ge<Gf;)this.quadraticCurveTo(Gd[Ge++],Gd[Ge++],Gd[Ge++],Gd[Ge++]);this.stroke()},Gb.arcTo=function(Ga,Gb,Gc,Gd,Ge){if(-1==this.mId||!this.mHaveKey){var Gf=0,Gg=0,Gh=0,Gi=this._getPath();this._curMat.copyTo(GP._tmpMatrix),GP._tmpMatrix.tx=GP._tmpMatrix.ty=0,GP._tempPoint.setTo(Gi.getEndPointX(),Gi.getEndPointY()),GP._tmpMatrix.invertTransformPoint(GP._tempPoint);var Gj=GP._tempPoint.x-Ga,Gk=GP._tempPoint.y-Gb,Gl=Math.sqrt(Gj*Gj+Gk*Gk);if(!(Gl<=1e-6)){var Go=Gj/Gl,Gp=Gk/Gl,Gq=Gc-Ga,Gr=Gd-Gb,Gs=Gq*Gq+Gr*Gr,Gt=Math.sqrt(Gs);if(!(Gt<=1e-6)){var Gu=Gq/Gt,Gv=Gr/Gt,Gw=Go+Gu,Gx=Gp+Gv,Gy=Math.sqrt(Gw*Gw+Gx*Gx);if(!(Gy<=1e-6)){var Gz=Gw/Gy,GA=Gx/Gy,GB=Math.acos(Gz*Go+GA*Gp),GC=Math.PI/2-GB,GD=(Gl=Ge/Math.tan(GC))*Go+Ga,GE=Gl*Gp+Gb,GF=Math.sqrt(Gl*Gl+Ge*Ge),GG=Ga+Gz*GF,GH=Gb+GA*GF,GI=0,GJ=0;if(0<=Go*Gv-Gp*Gu){var GK=2*GC/GP.SEGNUM;GI=Math.sin(GK),GJ=Math.cos(GK)}else GK=2*-GC/GP.SEGNUM,GI=Math.sin(GK),GJ=Math.cos(GK);Gg=this._curMat.a*GD+this._curMat.c*GE,Gh=this._curMat.b*GD+this._curMat.d*GE,Gg==this._path.getEndPointX()&&Gh==this._path.getEndPointY()||Gi.addPoint(Gg,Gh);var GL=GD-GG,GM=GE-GH;for(Gf=0;Gf<GP.SEGNUM;Gf++){var GN=GL*GJ+GM*GI,GO=-GL*GI+GM*GJ;Gg=GN+GG,Gh=GO+GH,Ga=this._curMat.a*Gg+this._curMat.c*Gh,Gh=Gb=this._curMat.b*Gg+this._curMat.d*Gh,(Gg=Ga)==this._path.getEndPointX()&&Gh==this._path.getEndPointY()||Gi.addPoint(Gg,Gh),GL=GN,GM=GO}}}}}},Gb.arc=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){if(void 0===Gf&&(Gf=!1),void 0===Gg&&(Gg=!0),-1!=this.mId){var Gh=GM.getInstance().shapeDic[this.mId];if(Gh&&this.mHaveKey&&!Gh.needUpdate(this._curMat))return;Gb=Ga=0}var Gi,Gj=0,Gk=0,Gl=0,Go=0,Gp=0,Gq=0,Gr=0;if(Gk=Ge-Gd,Gf)if(Math.abs(Gk)>=2*Math.PI)Gk=2*-Math.PI;else for(;0<Gk;)Gk-=2*Math.PI;else if(Math.abs(Gk)>=2*Math.PI)Gk=2*Math.PI;else for(;Gk<0;)Gk+=2*Math.PI;Gi=Gk/(Gr=Gc<101?Math.max(10,Gk*Gc/5):Gc<201?Math.max(10,Gk*Gc/20):Math.max(10,Gk*Gc/40))/2,Gl=Math.abs(4/3*(1-Math.cos(Gi))/Math.sin(Gi)),Gf&&(Gl=-Gl);var Gs=this._getPath(),Gt=NaN,Gu=NaN;for(Gq=0;Gq<=Gr;Gq++)Gj=Gd+Gk*(Gq/Gr),Go=Ga+Math.cos(Gj)*Gc,Gp=Gb+Math.sin(Gj)*Gc,Gg&&(Gt=Go,Gu=Gp,Go=this._curMat.a*Gt+this._curMat.c*Gu,Gp=this._curMat.b*Gt+this._curMat.d*Gu),Go==this._path.getEndPointX()&&Gp==this._path.getEndPointY()||Gs.addPoint(Go,Gp);Go=Ga+Math.cos(Ge)*Gc,Gp=Gb+Math.sin(Ge)*Gc,Gg&&(Gt=Go,Gu=Gp,Go=this._curMat.a*Gt+this._curMat.c*Gu,Gp=this._curMat.b*Gt+this._curMat.d*Gu),Go==this._path.getEndPointX()&&Gp==this._path.getEndPointY()||Gs.addPoint(Go,Gp)},Gb.quadraticCurveTo=function(Ga,Gb,Gc,Gd){var Ge=Gl.I,Gf=Gc,Gg=Gd;Gc=this._curMat.a*Gf+this._curMat.c*Gg,Gd=this._curMat.b*Gf+this._curMat.d*Gg,Gf=Ga,Gg=Gb,Ga=this._curMat.a*Gf+this._curMat.c*Gg,Gb=this._curMat.b*Gf+this._curMat.d*Gg;for(var Gh=Ge.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),Ga,Gb,Gc,Gd],30,2),Gi=0,Gj=Gh.length/2;Gi<Gj;Gi++)this.lineTo(Gh[2*Gi],Gh[2*Gi+1],!1);this.lineTo(Gc,Gd,!1)},Gb.rect=function(Ga,Gb,Gc,Gd){this._other=this._other.make(),this._other.path||(this._other.path=new GU),this._other.path.rect(Ga,Gb,Gc,Gd)},Gb.strokeRect=function(Ga,Gb,Gc,Gd,Ge){var Gf=.5*Ge;this.line(Ga-Gf,Gb,Ga+Gc+Gf,Gb,Ge,this._curMat),this.line(Ga+Gc,Gb,Ga+Gc,Gb+Gd,Ge,this._curMat),this.line(Ga,Gb,Ga,Gb+Gd,Ge,this._curMat),this.line(Ga-Gf,Gb+Gd,Ga+Gc+Gf,Gb+Gd,Ge,this._curMat)},Gb.clip=function(){},Gb.drawPoly=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){void 0===Gg&&(Gg=!1),this._renderKey=0,this._shader2D.glTexture=null;var Gh=this._getPath();if(-1==this.mId)Gh.polygon(Ga,Gb,Gc,Gd,Ge||1,Gf);else if(this.mHaveKey){var Gi=GM.getInstance().shapeDic[this.mId];Gi.setMatrix(this._curMat),Gi.rebuild(Gh.tempArray),Gh.setGeomtry(Gi)}else{var Gj=Gh.polygon(Ga,Gb,Gc,Gd,Ge||1,Gf);GM.getInstance().addShape(this.mId,Gj),Gj.setMatrix(this._curMat)}Gh.update();var Gk,Gl=[this.mX,this.mY];if((Gk=Gfa.createShape(this,Gh.ib,Gh.vb,Gh.count,Gh.offset,GAa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,Gk.shaderValue.u_pos=Gl,Gk.shaderValue.u_mmat2=Gua.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=Gk,0<Ge){if(this.mHaveLineKey){var Go=GM.getInstance().shapeLineDic[this.mId];Go.rebuild(Gh.tempArray),Gh.setGeomtry(Go)}else GM.getInstance().addShape(this.mId,Gh.drawLine(Ga,Gb,Gc,Ge,Gf));Gh.update(),(Gk=Gfa.createShape(this,Gh.ib,Gh.vb,Gh.count,Gh.offset,GAa.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,Gk.shaderValue.u_mmat2=Gua.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=Gk}},Gb.drawParticle=function(Ga,Gb,Gc){Gc.x=Ga,Gc.y=Gb,this._submits[this._submits._length++]=Gc},Gb._getPath=function(){return this._path||(this._path=new GU)},Gd(0,Gb,"globalCompositeOperation",function(){return GS.NAMES[this._nBlendType]},function(Ga){var Gb=GS.TOINT[Ga];null==Gb||this._nBlendType===Gb||(GV.save(this,65536,this,!0),this._curSubmit=Gfa.RENDERBASE,this._renderKey=0,this._nBlendType=Gb)}),Gd(0,Gb,"strokeStyle",function(){return this._shader2D.strokeStyle},function(Ga){this._shader2D.strokeStyle.equal(Ga)||(GV.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=GT.create(Ga))}),Gd(0,Gb,"globalAlpha",function(){return this._shader2D.ALPHA},function(Ga){(Ga=Math.floor(1e3*Ga)/1e3)!=this._shader2D.ALPHA&&(GV.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=Ga)}),Gd(0,Gb,"asBitmap",null,function(Ga){if(Ga){if(this._targets||(this._targets=new G_),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),Gd(0,Gb,"fillStyle",function(){return this._shader2D.fillStyle},function(Ga){this._shader2D.fillStyle.equal(Ga)||(GV.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=GT.create(Ga))}),Gd(0,Gb,"textAlign",function(){return this._other.textAlign},function(Ga){this._other.textAlign===Ga||(this._other=this._other.make(),GV.save(this,32768,this._other,!1),this._other.textAlign=Ga)}),Gd(0,Gb,"lineWidth",function(){return this._other.lineWidth},function(Ga){this._other.lineWidth===Ga||(this._other=this._other.make(),GV.save(this,256,this._other,!1),this._other.lineWidth=Ga)}),Gd(0,Gb,"textBaseline",function(){return this._other.textBaseline},function(Ga){this._other.textBaseline===Ga||(this._other=this._other.make(),GV.save(this,16384,this._other,!1),this._other.textBaseline=Ga)}),Gd(0,Gb,"font",null,function(Ga){Ga!=this._other.font.toString()&&(this._other=this._other.make(),GV.save(this,8,this._other,!1),this._other.font===Gqa.EMPTY?this._other.font=new Gqa(Ga):this._other.font.setFont(Ga))}),GP.__init__=function(){Gc.DEFAULT=new Gc},GP._tempPoint=new GC,GP._SUBMITVBSIZE=32e3,GP._MAXSIZE=99999999,GP._RECTVBSIZE=16,GP.MAXCLIPRECT=new GD(0,0,99999999,99999999),GP._COUNT=0,GP._tmpMatrix=new GB,GP.SEGNUM=32,GP._contextcount=0,Gg(GP,["_fontTemp",function(){return this._fontTemp=new Gqa},"_drawStyleTemp",function(){return this._drawStyleTemp=new GT(null)}]),GP.__init$=function(){Gc=function(){function Ga(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=Gqa.EMPTY}Go(Ga,"");var Gb=Ga.prototype;return Gb.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=Gqa.EMPTY},Gb.make=function(){return this===Ga.DEFAULT?new Ga:this},Ga.DEFAULT=null,Ga}()},GP}(),GAa=function(Ga){function Gd(Ga,Gb){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,Gd.__super.call(this),this.defines=new GEa,this.position=Gd._POSITION,this.mainID=Ga,this.subID=Gb,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=Ga|Gb,this._inClassCache=Gd._cache[this._cacheID],0<Ga&&!this._inClassCache&&(this._inClassCache=Gd._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}Go(Gd,"laya.webgl.shader.d2.value.Value2D",GO);var Gb=Gd.prototype;return Gb.setValue=function(Ga){},Gb.refresh=function(){var Ga=this.size;return Ga[0]=Gua.width,Ga[1]=Gua.height,this.alpha=this.ALPHA*Gua.worldAlpha,this.mmat=Gua.worldMatrix4,this},Gb._ShaderWithCompile=function(){return GYa.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,G_a.create)},Gb._withWorldShaderDefines=function(){var Ga=Gua.worldShaderDefines,Gb=GYa.sharders[this.mainID|this.defines._value|Ga.getValue()];if(!Gb){var Gc,Gd={};for(Gc in this.defines.toNameDic())Gd[Gc]="";for(Gc in Ga.toNameDic())Gd[Gc]="";Gb=GYa.withCompile2D(0,this.mainID,Gd,this.mainID|this.defines._value|Ga.getValue(),G_a.create)}var Ge=Gua.worldFilters;if(!Ge)return Gb;for(var Gf,Gg=Ge.length,Gh=0;Gh<Gg;Gh++)(Gf=Ge[Gh])&&Gf.action.setValue(this);return Gb},Gb.upload=function(){var Ga=Gua;this.alpha=this.ALPHA*Ga.worldAlpha,Gua.worldMatrix4!==Gua.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),Gwa.shaderHighPrecision&&this.defines.add(1024);var Gb,Gc=Ga.worldShaderDefines?this._withWorldShaderDefines():GYa.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=Ga.width,this.size[1]=Ga.height,this.mmat=Ga.worldMatrix4,GLa.activeShader!==Gc?Gc._shaderValueWidth!==Ga.width||Gc._shaderValueHeight!==Ga.height?(Gc._shaderValueWidth=Ga.width,Gc._shaderValueHeight=Ga.height):Gb=Gc._params2dQuick2||Gc._make2dQuick2():Gc._shaderValueWidth!==Ga.width||Gc._shaderValueHeight!==Ga.height?(Gc._shaderValueWidth=Ga.width,Gc._shaderValueHeight=Ga.height):Gb=Gc._params2dQuick1||Gc._make2dQuick1(),Gc.upload(this,Gb)},Gb.setFilters=function(Ga){if(this.filters=Ga)for(var Gb,Gc=Ga.length,Gd=0;Gd<Gc;Gd++)(Gb=Ga[Gd])&&(this.defines.add(Gb.type),Gb.action.setValue(this))},Gb.clear=function(){this.defines.setValue(this.subID)},Gb.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},Gd._initone=function(Ga,Gb){Gd._typeClass[Ga]=Gb,Gd._cache[Ga]=[],Gd._cache[Ga]._length=0},Gd.__init__=function(){Gd._POSITION=[2,5126,!1,4*Gra.BYTES_PE,0],Gd._TEXCOORD=[2,5126,!1,4*Gra.BYTES_PE,2*Gra.BYTES_PE],Gd._initone(2,GPa),Gd._initone(4,GSa),Gd._initone(256,GQa),Gd._initone(512,GOa),Gd._initone(1,GRa),Gd._initone(65,G$a),Gd._initone(9,GRa)},Gd.create=function(Ga,Gb){var Gc=Gd._cache[Ga|Gb];return Gc._length?Gc[--Gc._length]:new Gd._typeClass[Ga|Gb](Gb)},Gd._POSITION=null,Gd._TEXCOORD=null,Gd._cache=[],Gd._typeClass=[],Gd.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Gd}(),GBa=function(Ga){function Gs(Ga,Gb){Gs.__super.call(this,Ga,Gb)}Go(Gs,"laya.webgl.utils.RenderSprite3D",Gu);var Gb=Gs.prototype;return Gb.onCreate=function(Ga){switch(Ga){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},Gb._mask=function(Ga,Gb,Gc,Gd){var Ge,Gf,Gg=this._next,Gh=Ga.mask;if(Gh){Gb.ctx.save();var Gi=Gb.ctx.globalCompositeOperation,Gj=new GD;if(Gj.copyFrom(Gh.getBounds()),Gj.width=Math.round(Gj.width),Gj.height=Math.round(Gj.height),Gj.x=Math.round(Gj.x),Gj.y=Math.round(Gj.y),0<Gj.width&&0<Gj.height){var Gk=Ga._style._tf,Gl=Gha.create();Gl.addValue("bounds",Gj),Ge=Gga.create([Gl,Gb],laya.webgl.utils.RenderSprite3D.tmpTarget),Gb.addRenderObject(Ge),Gh.render(Gb,-Gj.x,-Gj.y),Ge=Gga.create([Gl],laya.webgl.utils.RenderSprite3D.endTmpTarget),Gb.addRenderObject(Ge),Gb.ctx.save(),Gb.clipRect(Gc-Gk.translateX+Gj.x,Gd-Gk.translateY+Gj.y,Gj.width,Gj.height),Gg._fun.call(Gg,Ga,Gb,Gc,Gd),Gb.ctx.restore(),Gf=Gka.create(6),Gi=Gb.ctx.globalCompositeOperation,Gf.blendMode="mask",Gb.addRenderObject(Gf),GB.TEMP.identity();var Go=GAa.create(1,0),Gp=GK.INV_UV,Gq=Gj.width,Gr=Gj.height;(Gj.width<32||Gj.height<32)&&((Gp=Gs.tempUV)[0]=0,Gp[1]=0,Gp[2]=32<=Gj.width?1:Gj.width/32,Gp[3]=0,Gp[4]=32<=Gj.width?1:Gj.width/32,Gp[5]=32<=Gj.height?1:Gj.height/32,Gp[6]=0,Gp[7]=32<=Gj.height?1:Gj.height/32,Gj.width=32<=Gj.width?Gj.width:32,Gj.height=32<=Gj.height?Gj.height:32,Gp[1]*=-1,Gp[3]*=-1,Gp[5]*=-1,Gp[7]*=-1,Gp[1]+=1,Gp[3]+=1,Gp[5]+=1,Gp[7]+=1),Gb.ctx.drawTarget(Gl,Gc+Gj.x-Gk.translateX,Gd+Gj.y-Gk.translateY,Gq,Gr,GB.TEMP,"tmpTarget",Go,Gp,6),Ge=Gga.create([Gl],laya.webgl.utils.RenderSprite3D.recycleTarget),Gb.addRenderObject(Ge),(Gf=Gka.create(6)).blendMode=Gi,Gb.addRenderObject(Gf)}Gb.ctx.restore()}else Gg._fun.call(Gg,Ga,Gb,Gc,Gd)},Gb._blend=function(Ga,Gb,Gc,Gd){var Ge=Ga._style,Gf=this._next;Ge.blendMode?(Gb.ctx.save(),Gb.ctx.globalCompositeOperation=Ge.blendMode,Gf._fun.call(Gf,Ga,Gb,Gc,Gd),Gb.ctx.restore()):Gf._fun.call(Gf,Ga,Gb,Gc,Gd)},Gb._transform=function(Ga,Gb,Gc,Gd){var Ge=Ga.transform,Gf=this._next;if(Ge&&Gf!=Gu.NORENDER){var Gg=Gb.ctx;Ga._style;Ge.tx=Gc,Ge.ty=Gd;var Gh=Gg._getTransformMatrix(),Gi=Gh.clone();GB.mul(Ge,Gh,Gh),Gh._checkTransform(),Ge.tx=Ge.ty=0,Gf._fun.call(Gf,Ga,Gb,0,0),Gi.copyTo(Gh),Gi.destroy()}else Gf._fun.call(Gf,Ga,Gb,Gc,Gd)},Gs.tmpTarget=function(Ga,Gb){var Gc=Ga.getValue("bounds"),Gd=GMa.create(Gc.width,Gc.height);Gd.start(),Gd.clear(0,0,0,0),Ga.addValue("tmpTarget",Gd)},Gs.endTmpTarget=function(Ga){Ga.getValue("tmpTarget").end()},Gs.recycleTarget=function(Ga){Ga.getValue("tmpTarget").recycle(),Ga.recycle()},Gg(Gs,["tempUV",function(){return this.tempUV=new Array(8)}]),Gs}(),GCa=function(Ga){function Gb(){this.data=null,Gb.__super.call(this)}Go(Gb,"laya.filters.webgl.ColorFilterActionGL",GN);var Gc=Gb.prototype;return Gy.imps(Gc,{"laya.filters.IFilterActionGL":!0}),Gc.setValue=function(Ga){Ga.colorMat=this.data._mat,Ga.colorAlpha=this.data._alpha},Gc.apply3d=function(Ga,Gb,Gc,Gd,Ge){var Gf=Ga.getValue("bounds"),Gg=GAa.create(1,0);Gg.setFilters([this.data]);var Gh=GB.TEMP;Gh.identity(),Gc.ctx.drawTarget(Ga,0,0,Gf.width,Gf.height,Gh,"src",Gg)},Gb}(),GDa=function(Ga){function Gf(Ga,Gb,Gc,Gd,Ge){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,Gf.__super.call(this,Ga,Gb,Ge),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new GTa,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=Gc,this._atlasCanvas.height=Gd,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}Go(Gf,"laya.webgl.atlas.Atlaser",GP);var Gb=Gf.prototype;return Gb.computeUVinAtlasTexture=function(Ga,Gb,Gc,Gd){var Ge=GQ.atlasTextureWidth,Gf=GQ.atlasTextureHeight,Gg=Gc/Ge,Gh=Gd/Gf,Gi=(Gc+Ga.bitmap.width)/Ge,Gj=(Gd+Ga.bitmap.height)/Gf,Gk=Ga.bitmap.width/Ge,Gl=Ga.bitmap.height/Gf;Ga.uv=[Gg+Gb[0]*Gk,Gh+Gb[1]*Gl,Gi-(1-Gb[2])*Gk,Gh+Gb[3]*Gl,Gi-(1-Gb[4])*Gk,Gj-(1-Gb[5])*Gl,Gg+Gb[6]*Gk,Gj-(1-Gb[7])*Gl]},Gb.findBitmapIsExist=function(Ga){if(Ga instanceof laya.webgl.resource.WebGLImage){var Gb=Ga,Gc=Gb.url,Gd=this._InAtlasWebGLImagesKey[Gc||Gb.id];if(Gd)return Gd.offsetInfoID}return-1},Gb.addToAtlasTexture=function(Ga,Gb,Gc){if(Ga instanceof laya.webgl.resource.WebGLImage){var Gd=Ga,Ge=Gd.url;this._InAtlasWebGLImagesKey[Ge||Gd.id]={bitmap:Ga,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([Gb,Gc])}this._atlasCanvas.texSubImage2D(Gb,Gc,Ga.atlasSource),Ga.clearAtlasSource()},Gb.addToAtlas=function(Ga,Gb,Gc){Ga._atlasID=this._inAtlasTextureKey.length;var Gd=Ga.uv.slice(),Ge=Ga.bitmap;this._inAtlasTextureKey.push(Ga),this._inAtlasTextureOriUVValue.push(Gd),this._inAtlasTextureBitmapValue.push(Ge),this.computeUVinAtlasTexture(Ga,Gd,Gb,Gc),Ga.bitmap=this._atlasCanvas},Gb.clear=function(){for(var Ga=0,Gb=this._inAtlasTextureKey.length;Ga<Gb;Ga++)this._inAtlasTextureKey[Ga].bitmap=this._inAtlasTextureBitmapValue[Ga],this._inAtlasTextureKey[Ga].uv=this._inAtlasTextureOriUVValue[Ga],this._inAtlasTextureKey[Ga]._atlasID=-1,this._inAtlasTextureKey[Ga].bitmap.lock=!1,this._inAtlasTextureKey[Ga].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},Gb.dispose=function(){this.clear(),this._atlasCanvas.destroy()},Gd(0,Gb,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),Gd(0,Gb,"texture",function(){return this._atlasCanvas}),Gd(0,Gb,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),Gf}(),GEa=function(Ga){function Gc(){Gc.__super.call(this,Gc.__name2int,Gc.__int2name,Gc.__int2nameMap)}return Go(Gc,"laya.webgl.shader.d2.ShaderDefines2D",Gn),Gc.__init__=function(){Gc.reg("TEXTURE2D",1),Gc.reg("COLOR2D",2),Gc.reg("PRIMITIVE",4),Gc.reg("GLOW_FILTER",8),Gc.reg("BLUR_FILTER",16),Gc.reg("COLOR_FILTER",32),Gc.reg("COLOR_ADD",64),Gc.reg("WORLDMAT",128),Gc.reg("FILLTEXTURE",256),Gc.reg("FSHIGHPRECISION",1024),Gc.reg("TXTALPHA",2048),Gc.reg("TXTCOMPRESS",4096)},Gc.reg=function(Ga,Gb){Gn._reg(Ga,Gb,Gc.__name2int,Gc.__int2name)},Gc.toText=function(Ga,Gb,Gc){return Gn._toText(Ga,Gb,Gc)},Gc.toInt=function(Ga){return Gn._toInt(Ga,Gc.__name2int)},Gc.TEXTURE2D=1,Gc.COLOR2D=2,Gc.PRIMITIVE=4,Gc.FILTERGLOW=8,Gc.FILTERBLUR=16,Gc.FILTERCOLOR=32,Gc.COLORADD=64,Gc.WORLDMAT=128,Gc.FILLTEXTURE=256,Gc.SKINMESH=512,Gc.SHADERDEFINE_FSHIGHPRECISION=1024,Gc.TXTALPHA=2048,Gc.TXTCOMPRESS=4096,Gc.__name2int={},Gc.__int2name=[],Gc.__int2nameMap=[],Gc}(),GFa=(function(Ga){function Gh(Ga,Gb,Gc,Gd,Ge,Gf,Gg){Gh.__super.call(this,Ga,Gb,Gc,Gd,40,Ge,Gf,Gg)}Go(Gh,"laya.webgl.shapes.Ellipse",Gca)}(),function(Ga){function Gf(Ga,Gb,Gc,Gd,Ge){this._points=[],this.rebuild(Gc),Gf.__super.call(this,Ga,Gb,0,0,0,Ge,Gd,Ge,0)}Go(Gf,"laya.webgl.shapes.Line",Gca);var Gb=Gf.prototype;return Gb.rebuild=function(Ga){var Gb=Ga.length;Gb!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(Gb/2-1)),this.mFloat32Array=new Float32Array(5*Gb)),this._points.length=0;for(var Gc=NaN,Gd=NaN,Ge=-1,Gf=-1,Gg=Ga.length/2,Gh=0;Gh<Gg;Gh++)Gc=Ga[2*Gh],Gd=Ga[2*Gh+1],(.01<Math.abs(Ge-Gc)||.01<Math.abs(Gf-Gd))&&this._points.push(Gc,Gd),Ge=Gc,Gf=Gd},Gb.getData=function(Ga,Gb,Gc){var Gd=[],Ge=[];0<this.borderWidth&&this.createLine2(this._points,Gd,this.borderWidth,Gc,Ge,this._points.length/2),this.mUint16Array.set(Gd,0),this.mFloat32Array.set(Ge,0),Ga.append(this.mUint16Array),Gb.append(this.mFloat32Array)},Gf}()),GGa=function(Ga){function Gl(Ga,Gb,Gc,Gd,Ge){this._points=[];for(var Gf=NaN,Gg=NaN,Gh=-1,Gi=-1,Gj=Gc.length/2-1,Gk=0;Gk<Gj;Gk++)Gf=Gc[2*Gk],Gg=Gc[2*Gk+1],(.01<Math.abs(Gh-Gf)||.01<Math.abs(Gi-Gg))&&this._points.push(Gf,Gg),Gh=Gf,Gi=Gg;Gf=Gc[2*Gj],Gg=Gc[2*Gj+1],Gh=this._points[0],Gi=this._points[1],(.01<Math.abs(Gh-Gf)||.01<Math.abs(Gi-Gg))&&this._points.push(Gf,Gg),Gl.__super.call(this,Ga,Gb,0,0,this._points.length/2,0,Gd,Ge)}Go(Gl,"laya.webgl.shapes.LoopLine",Gca);var Gb=Gl.prototype;return Gb.getData=function(Ga,Gb,Gc){if(0<this.borderWidth){for(var Gd=this.color,Ge=(Gd>>16&255)/255,Gf=(Gd>>8&255)/255,Gg=(255&Gd)/255,Gh=[],Gi=0,Gj=0,Gk=[],Gl=Math.floor(this._points.length/2),Go=0;Go<Gl;Go++)Gi=this._points[2*Go],Gj=this._points[2*Go+1],Gh.push(this.x+Gi,this.y+Gj,Ge,Gf,Gg);this.createLoopLine(Gh,Gk,this.borderWidth,Gc+Gh.length/5),Ga.append(new Uint16Array(Gk)),Gb.append(new Float32Array(Gh))}},Gb.createLoopLine=function(Ga,Gb,Gc,Gd,Ge,Gf){Ga.length;var Gg=Ga.concat(),Gh=Ge||Ga,Gi=this.borderColor,Gj=(Gi>>16&255)/255,Gk=(Gi>>8&255)/255,Gl=(255&Gi)/255,Go=[Gg[0],Gg[1]],Gp=[Gg[Gg.length-5],Gg[Gg.length-4]],Gq=Gp[0]+.5*(Go[0]-Gp[0]),Gr=Gp[1]+.5*(Go[1]-Gp[1]);Gg.unshift(Gq,Gr,0,0,0),Gg.push(Gq,Gr,0,0,0);var Gs,Gt,Gu,Gv,Gw,Gx,Gy,Gz,GA,GB,GC,GD,GE,GF,GG,GH,GI,GJ,GK,GL,GM=Gg.length/5,GN=Gd,GO=Gc/2;Gu=Gg[0],Gv=Gg[1],GB=Gu-(Gw=Gg[5]),GA=(GA=-(Gv-(Gx=Gg[6])))/(GL=Math.sqrt(GA*GA+GB*GB))*GO,GB=GB/GL*GO,Gh.push(Gu-GA,Gv-GB,Gj,Gk,Gl,Gu+GA,Gv+GB,Gj,Gk,Gl);for(var GP=1;GP<GM-1;GP++)Gu=Gg[5*(GP-1)],Gv=Gg[5*(GP-1)+1],Gw=Gg[5*GP],Gx=Gg[5*GP+1],Gy=Gg[5*(GP+1)],Gz=Gg[5*(GP+1)+1],GB=Gu-Gw,GD=Gw-Gy,GG=(-(GA=(GA=-(Gv-Gx))/(GL=Math.sqrt(GA*GA+GB*GB))*GO)+Gu)*(-(GB=GB/GL*GO)+Gx)-(-GA+Gw)*(-GB+Gv),GJ=(-(GC=(GC=-(Gx-Gz))/(GL=Math.sqrt(GC*GC+GD*GD))*GO)+Gy)*(-(GD=GD/GL*GO)+Gx)-(-GC+Gw)*(-GD+Gz),GK=(GE=-GB+Gv-(-GB+Gx))*(GI=-GC+Gw-(-GC+Gy))-(GH=-GD+Gz-(-GD+Gx))*(GF=-GA+Gw-(-GA+Gu)),Math.abs(GK)<.1?(GK+=10.1,Gh.push(Gw-GA,Gx-GB,Gj,Gk,Gl,Gw+GA,Gx+GB,Gj,Gk,Gl)):(((Gs=(GF*GJ-GI*GG)/GK)-Gw)*(Gs-Gw)+((Gt=(GH*GG-GE*GJ)/GK)-Gx)+(Gt-Gx),Gh.push(Gs,Gt,Gj,Gk,Gl,Gw-(Gs-Gw),Gx-(Gt-Gx),Gj,Gk,Gl));Gf&&(Gb=Gf);var GQ=this.edges+1;for(GP=1;GP<GQ;GP++)Gb.push(GN+2*(GP-1),GN+2*(GP-1)+1,GN+2*GP+1,GN+2*GP+1,GN+2*GP,GN+2*(GP-1));return Gb.push(GN+2*(GP-1),GN+2*(GP-1)+1,GN+1,GN+1,GN,GN+2*(GP-1)),Gh},Gl}(),GHa=function(Ga){function Gg(Ga,Gb,Gc,Gd,Ge,Gf){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=GB.create(),this._points=Gc.slice(0,Gc.length),Gg.__super.call(this,Ga,Gb,0,0,this._points.length/2,Gd,Ge,Gf)}Go(Gg,"laya.webgl.shapes.Polygon",Gca);var Gb=Gg.prototype;return Gb.rebuild=function(Ga){this._repaint||(this._points.length=0,this._points=this._points.concat(Ga))},Gb.setMatrix=function(Ga){Ga.copyTo(this._mat)},Gb.needUpdate=function(Ga){return this._repaint=this._mat.a==Ga.a&&this._mat.b==Ga.b&&this._mat.c==Ga.c&&this._mat.d==Ga.d&&this._mat.tx==Ga.tx&&this._mat.ty==Ga.ty,!this._repaint},Gb.getData=function(Ga,Gb,Gc){var Gd,Ge=0,Gf=this._points,Gg=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=Gc){for(this._start=Gc,Gd=[],Gg=this.earcutTriangles.length,Ge=0;Ge<Gg;Ge++)Gd.push(this.earcutTriangles[Ge]+Gc);this.mUint16Array=new Uint16Array(Gd)}}else{this._start=Gc,Gd=[];var Gh=[],Gi=[],Gj=this.color,Gk=(Gj>>16&255)/255,Gl=(Gj>>8&255)/255,Go=(255&Gj)/255;for(Gg=Math.floor(Gf.length/2),Ge=0;Ge<Gg;Ge++)Gh.push(this.x+Gf[2*Ge],this.y+Gf[2*Ge+1],Gk,Gl,Go),Gi.push(this.x+Gf[2*Ge],this.y+Gf[2*Ge+1]);for(this.earcutTriangles=Gda.earcut(Gi,null,2),Gg=this.earcutTriangles.length,Ge=0;Ge<Gg;Ge++)Gd.push(this.earcutTriangles[Ge]+Gc);this.mUint16Array=new Uint16Array(Gd),this.mFloat32Array=new Float32Array(Gh)}Ga.append(this.mUint16Array),Gb.append(this.mFloat32Array)},Gg}(),GIa=function(Ga){function Gf(){this._matrix=new GB,this._matrix4=Gra.defaultMatrix4.concat(),Gf.__super.call(this,1e4),this.shaderValue=new GAa(0,0)}Go(Gf,"laya.webgl.submit.SubmitCanvas",Gfa);var Gb=Gf.prototype;return Gb.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var Ga=Gua.worldAlpha,Gb=Gua.worldMatrix4,Gc=Gua.worldMatrix,Gd=Gua.worldFilters,Ge=Gua.worldShaderDefines,Gf=this.shaderValue,Gg=this._matrix,Gh=this._matrix4,Gi=GB.TEMP;return GB.mul(Gg,Gc,Gi),Gh[0]=Gi.a,Gh[1]=Gi.b,Gh[4]=Gi.c,Gh[5]=Gi.d,Gh[12]=Gi.tx,Gh[13]=Gi.ty,Gua.worldMatrix=Gi.clone(),Gua.worldMatrix4=Gh,Gua.worldAlpha=Gua.worldAlpha*Gf.alpha,Gf.filters&&Gf.filters.length&&(Gua.worldFilters=Gf.filters,Gua.worldShaderDefines=Gf.defines),this._ctx_src.flush(),Gua.worldAlpha=Ga,Gua.worldMatrix4=Gb,Gua.worldMatrix.destroy(),Gua.worldMatrix=Gc,Gua.worldFilters=Gd,Gua.worldShaderDefines=Ge,1},Gb.releaseRender=function(){var Ga=Gf._cache;this._ctx_src=null,Ga[Ga._length++]=this},Gb.getRenderType=function(){return 10003},Gf.create=function(Ga,Gb,Gc){var Gd=Gf._cache._length?Gf._cache[--Gf._cache._length]:new Gf;Gd._ctx_src=Ga;var Ge=Gd.shaderValue;return Ge.alpha=Gb,Ge.defines.setValue(0),Gc&&Gc.length&&Ge.setFilters(Gc),Gd},Gf._cache=((Gf._cache=[])._length=0,Gf._cache),Gf}(),GJa=function(Ga){function Gj(Ga){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===Ga&&(Ga=1e4),Gj.__super.call(this,Ga)}Go(Gj,"laya.webgl.submit.SubmitTexture",Gfa);var Gb=Gj.prototype;return Gb.releaseRender=function(){var Ga=Gj._cache;(Ga[Ga._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},Gb.addTexture=function(Ga,Gb){this._texsID[this._texs.length]=Ga._uvID,this._texs.push(Ga),this._vbPos.push(Gb)},Gb.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var Ga=this.shaderValue.textureHost.bitmap;if(null!==Ga)for(var Gb=this._vb.getFloat32Array(),Gc=0,Gd=this._texs.length;Gc<Gd;Gc++){var Ge=this._texs[Gc];Ge.active();var Gf=Ge.uv;if(this._texsID[Gc]!==Ge._uvID){this._texsID[Gc]=Ge._uvID;var Gg=this._vbPos[Gc];Gb[Gg+2]=Gf[0],Gb[Gg+3]=Gf[1],Gb[Gg+6]=Gf[2],Gb[Gg+7]=Gf[3],Gb[Gg+10]=Gf[4],Gb[Gg+11]=Gf[5],Gb[Gg+14]=Gf[6],Gb[Gg+15]=Gf[7],this._vb.setNeedUpload()}Ge.bitmap!==Ga&&(this._isSameTexture=!1)}}},Gb.renderSubmit=function(){if(0===this._numEle)return Gj._shaderSet=!1,1;var Ga=this.shaderValue.textureHost;if(Ga){var Gb=Ga.source;if(!Ga.bitmap||!Gb)return Gj._shaderSet=!1,1;this.shaderValue.texture=Gb,Ga.alphaTexture&&Ga.alphaTexture.source&&(this.shaderValue.texture1=Ga.alphaTexture.source)}this._vb.bind_upload(this._ib);var Gc=Gwa.mainContext;if(GS.activeBlendFunction!==this._blendFn&&(Gc.enable(3042),this._blendFn(Gc),GS.activeBlendFunction=this._blendFn),GG.drawCall++,GG.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&GLa.activeShader&&Gj._shaderSet?(GLa.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&GLa.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),Gj._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var Gd=Ga.bitmap,Ge=0,Gf=GLa.activeShader,Gg=0,Gh=this._texs.length;Gg<Gh;Gg++){var Gi=this._texs[Gg];Gi.bitmap===Gd&&Gg+1!==Gh||(Gf.uploadTexture2D(Gi.source),Gc.drawElements(4,6*(Gg-Ge+1),5123,this._startIdx+6*Ge*Gra.BYTES_PIDX),Gd=Gi.bitmap,Ge=Gg)}else Gc.drawElements(4,this._numEle,5123,this._startIdx);return 1},Gj.create=function(Ga,Gb,Gc,Gd,Ge){var Gf=Gj._cache._length?Gj._cache[--Gj._cache._length]:new Gj;null==Gc&&((Gc=Gf._selfVb||(Gf._selfVb=Gna.create(-1))).clear(),Gd=0),Gf._ib=Gb,Gf._vb=Gc,Gf._startIdx=Gd*Gra.BYTES_PIDX,Gf._numEle=0;var Gg=Ga._nBlendType;Gf._blendFn=Ga._targets?GS.targetFns[Gg]:GS.fns[Gg],Gf.shaderValue=Ge,Gf.shaderValue.setValue(Ga._shader2D);var Gh=Ga._shader2D.filters;return Gh&&Gf.shaderValue.setFilters(Gh),Gf},Gj._cache=((Gj._cache=[])._length=0,Gj._cache),Gj._shaderSet=!0,Gj}(),GKa=function(Ga){function Gt(){Gt.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}Go(Gt,"laya.webgl.utils.MeshTexture",Gta);var Gb=Gt.prototype;return Gb.addData=function(Ga,Gb,Gc,Gd,Ge,Gf){for(var Gg=Ga.length/2,Gh=this._vb.needSize(Gg*Gt.const_stride)>>2,Gi=this._vb.getFloat32Array(),Gj=0,Gk=0;Gk<Gg;Gk++){var Gl=Ga[Gj],Go=Ga[Gj+1],Gp=Gl*Gd.a+Go*Gd.c+Gd.tx,Gq=Gl*Gd.b+Go*Gd.d+Gd.ty;Gi[Gh++]=Gp,Gi[Gh++]=Gq,Gi[Gh++]=Gb[Gj],Gi[Gh++]=Gb[Gj+1],Gj+=2}this._vb.setNeedUpload();var Gr=this.vertNum;if(0<Gr){(Gg=Gc.length)>Gt.tmpIdx.length&&(Gt.tmpIdx=new Uint16Array(Gg));for(var Gs=0;Gs<Gg;Gs++)Gt.tmpIdx[Gs]=Gc[Gs]+Gr;this._ib.appendU16Array(Gt.tmpIdx,Gc.length)}else this._ib.append(Gc);this._ib.setNeedUpload(),this.vertNum+=Gg,this.indexNum+=Gc.length},Gb.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},Gb.destroy=function(){this._ib.destroy(),this._vb.destroy()},Gt.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new Gt},Gt.const_stride=16,Gt._POOL=[],Gg(Gt,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),Gt}(),GLa=function(Ga){function Gb(){Gb.__super.call(this),this.lock=!0}return Go(Gb,"laya.webgl.shader.BaseShader",Gv),Gb.activeShader=null,Gb.bindShader=null,Gb}(),GMa=function(Gb){function Gk(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===Gc&&(Gc=6408),void 0===Gd&&(Gd=5121),void 0===Ge&&(Ge=34041),void 0===Gf&&(Gf=!1),void 0===Gg&&(Gg=!1),void 0===Gh&&(Gh=-1),void 0===Gi&&(Gi=-1),this._type=1,this._w=Ga,this._h=Gb,this._surfaceFormat=Gc,this._surfaceType=Gd,this._depthStencilFormat=Ge,Gt.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=Gf,this._repeat=Gg,this._minFifter=Gh,this._magFifter=Gi,this._createWebGLRenderTarget(),this.bitmap.lock=!0,Gk.__super.call(this,this.bitmap,GK.INV_UV)}Go(Gk,"laya.webgl.resource.RenderTarget2D",Gb);var Ga=Gk.prototype;return Gy.imps(Ga,{"laya.resource.IDispose":!0}),Ga.getType=function(){return this._type},Ga.getTexture=function(){return this},Ga.size=function(Ga,Gb){this._w==Ga&&this._h==Gb||(this._w=Ga,this._h=Gb,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},Ga.release=function(){this.destroy()},Ga.recycle=function(){Gk.POOL.push(this)},Ga.start=function(){var Ga=Gwa.mainContext;return this._preRenderTarget=Gua.curRenderTarget,Gua.curRenderTarget=this,Ga.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(Ga.viewport(0,0,this._w,this._h),this._svWidth=Gua.width,this._svHeight=Gua.height,Gua.width=this._w,Gua.height=this._h,GLa.activeShader=null),this},Ga.clear=function(Ga,Gb,Gc,Gd){void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=1);var Ge=Gwa.mainContext;Ge.clearColor(Ga,Gb,Gc,Gd);var Gf=16384;switch(this._depthStencilFormat){case 33189:Gf|=256;break;case 36168:Gf|=1024;break;case 34041:Gf|=256,Gf|=1024}Ge.clear(Gf)},Ga.end=function(){var Ga=Gwa.mainContext;Ga.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,Gua.curRenderTarget=this._preRenderTarget,1==this._type?(Ga.viewport(0,0,this._svWidth,this._svHeight),Gua.width=this._svWidth,Gua.height=this._svHeight,GLa.activeShader=null):Ga.viewport(0,0,Gy.stage.width,Gy.stage.height)},Ga.getData=function(Ga,Gb,Gc,Gd){var Ge=Gwa.mainContext;if(Ge.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===Ge.checkFramebufferStatus(36160)))return Ge.bindFramebuffer(36160,null),null;var Gf=new Uint8Array(this._w*this._h*4);return Ge.readPixels(Ga,Gb,Gc,Gd,this._surfaceFormat,this._surfaceType,Gf),Ge.bindFramebuffer(36160,null),Gf},Ga.destroy=function(Ga){void 0===Ga&&(Ga=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,Gb.prototype.destroy.call(this))},Ga.dispose=function(){},Ga._createWebGLRenderTarget=function(){this.bitmap=new GWa(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(Ga){this.event("recovered")})},Gd(0,Ga,"surfaceFormat",function(){return this._surfaceFormat}),Gd(0,Ga,"magFifter",function(){return this._magFifter}),Gd(0,Ga,"surfaceType",function(){return this._surfaceType}),Gd(0,Ga,"mipMap",function(){return this._mipMap}),Gd(0,Ga,"depthStencilFormat",function(){return this._depthStencilFormat}),Gd(0,Ga,"minFifter",function(){return this._minFifter}),Gd(0,Ga,"source",function(){return this._alreadyResolved?Gy.superGet(GK,this,"source"):null}),Gk.create=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){void 0===Gc&&(Gc=6408),void 0===Gd&&(Gd=5121),void 0===Ge&&(Ge=34041),void 0===Gf&&(Gf=!1),void 0===Gg&&(Gg=!1),void 0===Gh&&(Gh=-1),void 0===Gi&&(Gi=-1);var Gj=Gk.POOL.pop();return Gj||(Gj=new Gk(Ga,Gb)),Gj.bitmap&&Gj._w==Ga&&Gj._h==Gb&&Gj._surfaceFormat==Gc&&Gj._surfaceType==Gd&&Gj._depthStencilFormat==Ge&&Gj._mipMap==Gf&&Gj._repeat==Gg&&Gj._minFifter==Gh&&Gj._magFifter==Gi||(Gj._w=Ga,Gj._h=Gb,Gj._surfaceFormat=Gc,Gj._surfaceType=Gd,Gj._depthStencilFormat=Ge,Gt.isConchWebGL&&34041===Gj._depthStencilFormat&&(Gj._depthStencilFormat=33189),Gj._mipMap=Gf,Gj._repeat=Gg,Gj._minFifter=Gh,Gj._magFifter=Gi,Gj.release(),Gj._createWebGLRenderTarget()),Gj},Gk.TYPE2D=1,Gk.TYPE3D=2,Gk.POOL=[],Gk}(GK),GNa=function(Ga){function Gb(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,Gb.__super.call(this),Gb._gl=Gwa.mainContext}Go(Gb,"laya.webgl.utils.Buffer",Gv);var Gc=Gb.prototype;return Gc._bind=function(){this.activeResource(),Gb._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(Gb._bindVertexBuffer=this._glBuffer),Gb._gl.bindBuffer(this._bufferType,Gb._bindActive[this._bufferType]=this._glBuffer),GLa.activeShader=null)},Gc.recreateResource=function(){this._glBuffer||(this._glBuffer=Gb._gl.createBuffer()),this.completeCreate()},Gc.disposeResource=function(){this._glBuffer&&(Gwa.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},Gd(0,Gc,"bufferUsage",function(){return this._bufferUsage}),Gb._gl=null,Gb._bindActive={},Gb._bindVertexBuffer=null,Gb._enableAtributes=[],Gb}(),GOa=function(Ga){function Gc(Ga){this.texcoord=null,this.offsetX=300,this.offsetY=0,Gc.__super.call(this,512,0);var Gb=8*Gra.BYTES_PE;this.position=[2,5126,!1,Gb,0],this.texcoord=[2,5126,!1,Gb,2*Gra.BYTES_PE],this.color=[4,5126,!1,Gb,4*Gra.BYTES_PE]}return Go(Gc,"laya.webgl.shader.d2.skinAnishader.SkinSV",GAa),Gc}(),GPa=function(Ga){function Gb(Ga){Gb.__super.call(this,2,0),this.color=[]}return Go(Gb,"laya.webgl.shader.d2.value.Color2dSV",GAa),Gb.prototype.setValue=function(Ga){Ga.fillStyle&&(this.color=Ga.fillStyle._color._color),Ga.strokeStyle&&(this.color=Ga.strokeStyle._color._color)},Gb}(),GQa=function(Ga){function Gb(Ga){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=GAa._TEXCOORD,Gb.__super.call(this,256,0)}Go(Gb,"laya.webgl.shader.d2.value.FillTextureSV",GAa);var Gc=Gb.prototype;return Gc.setValue=function(Ga){this.ALPHA=Ga.ALPHA,Ga.filters&&this.setFilters(Ga.filters)},Gc.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},Gb}(),GRa=function(Ga){function Gb(Ga){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=GAa._TEXCOORD,void 0===Ga&&(Ga=0),Gb.__super.call(this,1,Ga)}Go(Gb,"laya.webgl.shader.d2.value.TextureSV",GAa);var Gc=Gb.prototype;return Gc.setValue=function(Ga){this.ALPHA=Ga.ALPHA,Ga.filters&&this.setFilters(Ga.filters)},Gc.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},Gb}(),GSa=function(Ga){function Gb(Ga){this.a_color=null,this.u_pos=[0,0],Gb.__super.call(this,4,0),this.position=[2,5126,!1,5*Gra.BYTES_PE,0],this.a_color=[3,5126,!1,5*Gra.BYTES_PE,2*Gra.BYTES_PE]}return Go(Gb,"laya.webgl.shader.d2.value.PrimitiveSV",GAa),Gb}(),GTa=function(Ga){function Gb(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,Gb.__super.call(this)}Go(Gb,"laya.webgl.atlas.AtlasWebGLCanvas",Ga);var Gc=Gb.prototype;return Gc.recreateResource=function(){var Ga=Gwa.mainContext,Gb=this._source=Ga.createTexture(),Gc=Gxa.curBindTexTarget,Gd=Gxa.curBindTexValue;Gxa.bindTexture(Ga,3553,Gb),Ga.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),Ga.texParameteri(3553,10241,9729),Ga.texParameteri(3553,10240,9729),Ga.texParameteri(3553,10242,33071),Ga.texParameteri(3553,10243,33071),Gc&&Gd&&Gxa.bindTexture(Ga,Gc,Gd),this.memorySize=this._w*this._h*4,this.completeCreate()},Gc.disposeResource=function(){this._source&&(Gwa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Gc.texSubImage2D=function(Ga,Gb,Gc){if(Gt.isFlash){this._flashCacheImage||(this._flashCacheImage=Gr.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var Gd=Gc.bitmapdata;this._flashCacheImage._image.copyPixels(Gd,0,0,Gd.width,Gd.height,Ga,Gb),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var Ge=Gwa.mainContext,Gf=Gxa.curBindTexTarget,Gg=Gxa.curBindTexValue;Gxa.bindTexture(Ge,3553,this._source),Ge.pixelStorei(37441,!0),0<=Ga-1&&Ge.texSubImage2D(3553,0,Ga-1,Gb,6408,5121,Gc),Ga+1<=this._w&&Ge.texSubImage2D(3553,0,Ga+1,Gb,6408,5121,Gc),0<=Gb-1&&Ge.texSubImage2D(3553,0,Ga,Gb-1,6408,5121,Gc),Gb+1<=this._h&&Ge.texSubImage2D(3553,0,Ga,Gb+1,6408,5121,Gc),Ge.texSubImage2D(3553,0,Ga,Gb,6408,5121,Gc),Ge.pixelStorei(37441,!1),Gf&&Gg&&Gxa.bindTexture(Ge,Gf,Gg)}},Gc.texSubImage2DPixel=function(Ga,Gb,Gc,Gd,Ge){var Gf=Gwa.mainContext,Gg=Gxa.curBindTexTarget,Gh=Gxa.curBindTexValue;Gxa.bindTexture(Gf,3553,this._source);var Gi=new Uint8Array(Ge.data);Gf.pixelStorei(37441,!0),Gf.texSubImage2D(3553,0,Ga,Gb,Gc,Gd,6408,5121,Gi),Gf.pixelStorei(37441,!1),Gg&&Gh&&Gxa.bindTexture(Gf,Gg,Gh)},Gd(0,Gc,"width",Ga.prototype._$get_width,function(Ga){this._w=Ga}),Gd(0,Gc,"height",Ga.prototype._$get_height,function(Ga){this._h=Ga}),Gb}(Gc),GUa=function(Ga){function Ge(){this.flipY=!0,this.alwaysChange=!1,Ge.__super.call(this)}Go(Ge,"laya.webgl.resource.WebGLCanvas",Gc);var Gb=Ge.prototype;return Gb.getCanvas=function(){return this._canvas},Gb.clear=function(){this._ctx&&this._ctx.clear()},Gb.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},Gb._setContext=function(Ga){this._ctx=Ga},Gb.getContext=function(Ga,Gb){return this._ctx?this._ctx:this._ctx=Ge._createContext(this)},Gb.size=function(Ga,Gb){this._w==Ga&&this._h==Gb||(this._w=Ga,this._h=Gb,this._ctx&&this._ctx.size(Ga,Gb),this._canvas&&(this._canvas.height=Gb,this._canvas.width=Ga))},Gb.activeResource=function(Ga){void 0===Ga&&(Ga=!1),this._source||this.recreateResource()},Gb.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},Gb.disposeResource=function(){this._source&&!this.iscpuSource&&(Gwa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Gb.createWebGlTexture=function(){var Ga=Gwa.mainContext;this._canvas;var Gb=this._source=Ga.createTexture();this.iscpuSource=!1;var Gc=Gxa.curBindTexTarget,Gd=Gxa.curBindTexValue;Gxa.bindTexture(Ga,3553,Gb),Ga.pixelStorei(37440,this.flipY?1:0),Ge.premulAlpha&&Ga.pixelStorei(37441,!0),Ga.texImage2D(3553,0,6408,6408,5121,this._imgData),Ge.premulAlpha&&Ga.pixelStorei(37441,!1),Ga.texParameteri(3553,10240,9729),Ga.texParameteri(3553,10241,9729),Ga.texParameteri(3553,10242,33071),Ga.texParameteri(3553,10243,33071),Ga.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,Gc&&Gd&&Gxa.bindTexture(Ga,Gc,Gd)},Gb.reloadCanvasData=function(){var Ga=Gwa.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var Gb=Gxa.curBindTexTarget,Gc=Gxa.curBindTexValue;Gxa.bindTexture(Ga,3553,this._source),Ge.premulAlpha&&Ga.pixelStorei(37441,!0),Ga.texImage2D(3553,0,6408,6408,5121,this._imgData),Ge.premulAlpha&&Ga.pixelStorei(37441,!1),Ga.pixelStorei(37440,0),Gb&&Gc&&Gxa.bindTexture(Ga,Gb,Gc)},Gb.texSubImage2D=function(Ga,Gb,Gc){var Gd=Gwa.mainContext,Ge=Gxa.curBindTexTarget,Gf=Gxa.curBindTexValue;Gxa.bindTexture(Gd,3553,this._source),Gd.pixelStorei(37441,!0),Gd.texSubImage2D(3553,0,Gb,Gc,6408,5121,Ga._source),Gd.pixelStorei(37441,!1),Ge&&Gf&&Gxa.bindTexture(Gd,Ge,Gf)},Gb.toBase64=function(Ga,Gb,Gc){var Gd=null;this._canvas&&(Gd=this._canvas.toDataURL(Ga,Gb)),Gc.call(this,Gd)},Gd(0,Gb,"context",function(){return this._ctx}),Gd(0,Gb,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),Gd(0,Gb,"asBitmap",null,function(Ga){this._ctx&&(this._ctx.asBitmap=Ga)}),Ge._createContext=null,Ge.premulAlpha=!1,Ge}(),GVa=function(Ga){function Gf(Ga,Gb){this.CborderSize=12,Gf.__super.call(this),this.char=Ga,this.isSpace=" "===Ga,this.xs=Gb.scaleX,this.ys=Gb.scaleY,this.font=Gb.font.toString(),this.fontSize=Gb.font.size,this.fillColor=Gb.fillColor,this.borderColor=Gb.borderColor,this.lineWidth=Gb.lineWidth,this.underLine=Gb.underLine;var Gc,Gd=Gt.isConchApp;Gd?((Gc=ConchTextCanvas)._source=ConchTextCanvas,Gc._source.canvas=ConchTextCanvas):Gc=Gp.canvas.source,this.canvas=Gc,this._enableMerageInAtlas=!0,this._ctx=Gd?Gc:this.canvas.getContext("2d",void 0);var Ge=GL.measureText(this.char,this.font);this.cw=Ge.width*this.xs,this.ch=(Ge.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new GK(this)}Go(Gf,"laya.webgl.resource.WebGLCharImage",Gc);var Gb=Gf.prototype;return Gy.imps(Gb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Gb.active=function(){this.texture.active()},Gb.recreateResource=function(){var Ga=Gt.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),Ga){var Gb=this.fontSize;1==this.xs&&1==this.ys||(Gb=parseInt(Gb*(this.xs>this.ys?this.xs:this.ys)+""));var Gc="normal 100 "+this.font;Gc=Gc.replace(Gf._fontSizeReg,Gb),this.borderColor&&(Gc+=" 1 "+this.borderColor),this._ctx.font=Gc,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,GJ.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var Gd=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(Gd,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},Gb.onresize=function(Ga,Gb){this._w=Ga,this._h=Gb,this._allowMerageInAtlas=!0},Gb.clearAtlasSource=function(){},Gd(0,Gb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Gd(0,Gb,"atlasSource",function(){return this.canvas}),Gd(0,Gb,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(Ga){this._enableMerageInAtlas=Ga}),Gf.createOneChar=function(Ga,Gb){return new Gf(Ga,Gb)},Gf._fontSizeReg=new RegExp("\\d+(?=px)","g"),Gf}(),GWa=function(Ga){function Gj(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){void 0===Gc&&(Gc=6408),void 0===Gd&&(Gd=5121),void 0===Ge&&(Ge=34041),void 0===Gf&&(Gf=!1),void 0===Gg&&(Gg=!1),void 0===Gh&&(Gh=-1),void 0===Gi&&(Gi=1),Gj.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=Ga,this._h=Gb,this._surfaceFormat=Gc,this._surfaceType=Gd,this._depthStencilFormat=Ge,this._mipMap=Gf,this._repeat=Gg,this._minFifter=Gh,this._magFifter=Gi}Go(Gj,"laya.webgl.resource.WebGLRenderTarget",Gc);var Gb=Gj.prototype;return Gb.recreateResource=function(){var Ga=Gwa.mainContext;this._frameBuffer||(this._frameBuffer=Ga.createFramebuffer()),this._source||(this._source=Ga.createTexture());var Gb=Gxa.curBindTexTarget,Gc=Gxa.curBindTexValue;Gxa.bindTexture(Ga,3553,this._source),Ga.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var Gd=this._minFifter,Ge=this._magFifter,Gf=this._repeat?10497:33071,Gg=Gk.isPOT(this._w,this._h);if(Gg?(this._mipMap?-1!==Gd||(Gd=9987):-1!==Gd||(Gd=9729),-1!==Ge||(Ge=9729),Ga.texParameteri(3553,10241,Gd),Ga.texParameteri(3553,10240,Ge),Ga.texParameteri(3553,10242,Gf),Ga.texParameteri(3553,10243,Gf),this._mipMap&&Ga.generateMipmap(3553)):(-1!==Gd||(Gd=9729),-1!==Ge||(Ge=9729),Ga.texParameteri(3553,10241,Gd),Ga.texParameteri(3553,10240,Ge),Ga.texParameteri(3553,10242,33071),Ga.texParameteri(3553,10243,33071)),Ga.bindFramebuffer(36160,this._frameBuffer),Ga.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=Ga.createRenderbuffer()),Ga.bindRenderbuffer(36161,this._depthStencilBuffer),Ga.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:Ga.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:Ga.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:Ga.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}Ga.bindFramebuffer(36160,null),Gb&&Gc&&Gxa.bindTexture(Ga,Gb,Gc),Ga.bindRenderbuffer(36161,null),Gg&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},Gb.disposeResource=function(){this._frameBuffer&&(Gwa.mainContext.deleteTexture(this._source),Gwa.mainContext.deleteFramebuffer(this._frameBuffer),Gwa.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},Gd(0,Gb,"depthStencilBuffer",function(){return this._depthStencilBuffer}),Gd(0,Gb,"frameBuffer",function(){return this._frameBuffer}),Gj}(),GXa=function(Ga){function Gh(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this.offsetX=0,this.offsetY=0,Gh.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=Gf,this.canvas=Ga,this._ctx=Ga.getContext("2d",void 0),this._w=Gd,this._h=Ge,this.offsetX=Gb,this.offsetY=Gc,this.src=Gg,this._enableMerageInAtlas=!0,GQ.enabled&&this._w<GQ.atlasLimitWidth&&this._h<GQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}Go(Gh,"laya.webgl.resource.WebGLSubImage",Gc);var Gb=Gh.prototype;return Gy.imps(Gb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Gb.size=function(Ga,Gb){this._w=Ga,this._h=Gb,this._ctx&&this._ctx.size(Ga,Gb),this.canvas&&(this.canvas.height=Gb,this.canvas.width=Ga)},Gb.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},Gb.createWebGlTexture=function(){var Ga=Gwa.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var Gb=this._source=Ga.createTexture(),Gc=Gxa.curBindTexTarget,Gd=Gxa.curBindTexValue;Gxa.bindTexture(Ga,3553,Gb),Ga.pixelStorei(37441,!0),Ga.texImage2D(3553,0,6408,6408,5121,this.canvas),Ga.pixelStorei(37441,!1);var Ge=this.minFifter,Gf=this.magFifter,Gg=this.repeat?10497:33071,Gh=Gk.isPOT(this.width,this.height);Gh?(this.mipmap?-1!==Ge||(Ge=9987):-1!==Ge||(Ge=9729),-1!==Gf||(Gf=9729),Ga.texParameteri(3553,10240,Gf),Ga.texParameteri(3553,10241,Ge),Ga.texParameteri(3553,10242,Gg),Ga.texParameteri(3553,10243,Gg),this.mipmap&&Ga.generateMipmap(3553)):(-1!==Ge||(Ge=9729),-1!==Gf||(Gf=9729),Ga.texParameteri(3553,10241,Ge),Ga.texParameteri(3553,10240,Gf),Ga.texParameteri(3553,10242,33071),Ga.texParameteri(3553,10243,33071)),Gc&&Gd&&Gxa.bindTexture(Ga,Gc,Gd),this.canvas=null,Gh&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},Gb.disposeResource=function(){GQ.enabled&&this._allowMerageInAtlas||!this._source||(Gwa.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Gb.clearAtlasSource=function(){},Gd(0,Gb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Gd(0,Gb,"atlasSource",function(){return this.canvas}),Gd(0,Gb,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(Ga){this._allowMerageInAtlas=Ga}),Gh}(),GYa=function(Ga){function Gj(Ga,Gb,Gc,Gd){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,Gj.__super.call(this),!Ga||!Gb)throw"Shader Error";this._id=++Gj._count,this._vs=Ga,this._ps=Gb,this._nameMap=Gd||{},null!=Gc&&(Gj.sharders[Gc]=this)}Go(Gj,"laya.webgl.shader.Shader",GLa);var Gb=Gj.prototype;return Gb.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},Gb.disposeResource=function(){Gwa.mainContext.deleteShader(this._vshader),Gwa.mainContext.deleteShader(this._pshader),Gwa.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},Gb._compile=function(){if(!Gwa.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var Ga=[this._vs,this._ps],Gb=Gwa.mainContext;if(this._program=Gb.createProgram(),this._vshader=Gj._createShader(Gb,Ga[0],35633),this._pshader=Gj._createShader(Gb,Ga[1],35632),Gb.attachShader(this._program,this._vshader),Gb.attachShader(this._program,this._pshader),Gb.linkProgram(this._program),!Gt.isConchApp&&!Gb.getProgramParameter(this._program,35714))throw Gb.getProgramInfoLog(this._program);var Gc,Gd,Ge=0,Gf=0;for(Gf=Gt.isConchApp?Gb.getProgramParameterEx(this._vs,this._ps,"",35721):Gb.getProgramParameter(this._program,35721),Ge=0;Ge<Gf;Ge++){var Gg=null;Gc={vartype:"attribute",glfun:null,ivartype:0,attrib:Gg=Gt.isConchApp?Gb.getActiveAttribEx(this._vs,this._ps,"",Ge):Gb.getActiveAttrib(this._program,Ge),location:Gb.getAttribLocation(this._program,Gg.name),name:Gg.name,type:Gg.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(Gc)}var Gh=0;for(Gh=Gt.isConchApp?Gb.getProgramParameterEx(this._vs,this._ps,"",35718):Gb.getProgramParameter(this._program,35718),Ge=0;Ge<Gh;Ge++){var Gi=null;Gi=Gt.isConchApp?Gb.getActiveUniformEx(this._vs,this._ps,"",Ge):Gb.getActiveUniform(this._program,Ge),0<(Gc={vartype:"uniform",glfun:null,ivartype:1,attrib:Gg,location:Gb.getUniformLocation(this._program,Gi.name),name:Gi.name,type:Gi.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(Gc.name=Gc.name.substr(0,Gc.name.length-3),Gc.isArray=!0,Gc.location=Gb.getUniformLocation(this._program,Gc.name)),this._params.push(Gc)}for(Ge=0,Gd=this._params.length;Ge<Gd;Ge++)if((Gc=this._params[Ge]).indexOfParams=Ge,Gc.index=1,Gc.value=[Gc.location,null],Gc.codename=Gc.name,Gc.name=this._nameMap[Gc.codename]?this._nameMap[Gc.codename]:Gc.codename,(this._paramsMap[Gc.name]=Gc)._this=this,Gc.uploadedValue=[],"attribute"!==Gc.vartype)switch(Gc.type){case 5124:Gc.fun=Gc.isArray?this._uniform1iv:this._uniform1i;break;case 5126:Gc.fun=Gc.isArray?this._uniform1fv:this._uniform1f;break;case 35664:Gc.fun=Gc.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:Gc.fun=Gc.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:Gc.fun=Gc.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:Gc.fun=this._uniform_sampler2D;break;case 35680:Gc.fun=this._uniform_samplerCube;break;case 35676:Gc.glfun=Gb.uniformMatrix4fv,Gc.fun=this._uniformMatrix4fv;break;case 35670:Gc.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else Gc.fun=this._attribute}},Gb.getUniform=function(Ga){return this._paramsMap[Ga]},Gb._attribute=function(Ga,Gb){var Gc=Gwa.mainContext,Gd=GNa._enableAtributes,Ge=Ga.location;return Gd[Ge]||Gc.enableVertexAttribArray(Ge),Gc.vertexAttribPointer(Ge,Gb[0],Gb[1],Gb[2],Gb[3],Gb[4]+this._offset),Gd[Ge]=GNa._bindVertexBuffer,1},Gb._uniform1f=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb?(Gwa.mainContext.uniform1f(Ga.location,Gc[0]=Gb),1):0},Gb._uniform1fv=function(Ga,Gb){if(Gb.length<4){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]||Gc[2]!==Gb[2]||Gc[3]!==Gb[3]?(Gwa.mainContext.uniform1fv(Ga.location,Gb),Gc[0]=Gb[0],Gc[1]=Gb[1],Gc[2]=Gb[2],Gc[3]=Gb[3],1):0}return Gwa.mainContext.uniform1fv(Ga.location,Gb),1},Gb._uniform_vec2=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]?(Gwa.mainContext.uniform2f(Ga.location,Gc[0]=Gb[0],Gc[1]=Gb[1]),1):0},Gb._uniform_vec2v=function(Ga,Gb){if(Gb.length<2){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]||Gc[2]!==Gb[2]||Gc[3]!==Gb[3]?(Gwa.mainContext.uniform2fv(Ga.location,Gb),Gc[0]=Gb[0],Gc[1]=Gb[1],Gc[2]=Gb[2],Gc[3]=Gb[3],1):0}return Gwa.mainContext.uniform2fv(Ga.location,Gb),1},Gb._uniform_vec3=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]||Gc[2]!==Gb[2]?(Gwa.mainContext.uniform3f(Ga.location,Gc[0]=Gb[0],Gc[1]=Gb[1],Gc[2]=Gb[2]),1):0},Gb._uniform_vec3v=function(Ga,Gb){return Gwa.mainContext.uniform3fv(Ga.location,Gb),1},Gb._uniform_vec4=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]||Gc[2]!==Gb[2]||Gc[3]!==Gb[3]?(Gwa.mainContext.uniform4f(Ga.location,Gc[0]=Gb[0],Gc[1]=Gb[1],Gc[2]=Gb[2],Gc[3]=Gb[3]),1):0},Gb._uniform_vec4v=function(Ga,Gb){return Gwa.mainContext.uniform4fv(Ga.location,Gb),1},Gb._uniformMatrix2fv=function(Ga,Gb){return Gwa.mainContext.uniformMatrix2fv(Ga.location,!1,Gb),1},Gb._uniformMatrix3fv=function(Ga,Gb){return Gwa.mainContext.uniformMatrix3fv(Ga.location,!1,Gb),1},Gb._uniformMatrix4fv=function(Ga,Gb){return Gwa.mainContext.uniformMatrix4fv(Ga.location,!1,Gb),1},Gb._uniform1i=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb?(Gwa.mainContext.uniform1i(Ga.location,Gc[0]=Gb),1):0},Gb._uniform1iv=function(Ga,Gb){return Gwa.mainContext.uniform1iv(Ga.location,Gb),1},Gb._uniform_ivec2=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]?(Gwa.mainContext.uniform2i(Ga.location,Gc[0]=Gb[0],Gc[1]=Gb[1]),1):0},Gb._uniform_ivec2v=function(Ga,Gb){return Gwa.mainContext.uniform2iv(Ga.location,Gb),1},Gb._uniform_vec3i=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]||Gc[2]!==Gb[2]?(Gwa.mainContext.uniform3i(Ga.location,Gc[0]=Gb[0],Gc[1]=Gb[1],Gc[2]=Gb[2]),1):0},Gb._uniform_vec3vi=function(Ga,Gb){return Gwa.mainContext.uniform3iv(Ga.location,Gb),1},Gb._uniform_vec4i=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]||Gc[2]!==Gb[2]||Gc[3]!==Gb[3]?(Gwa.mainContext.uniform4i(Ga.location,Gc[0]=Gb[0],Gc[1]=Gb[1],Gc[2]=Gb[2],Gc[3]=Gb[3]),1):0},Gb._uniform_vec4vi=function(Ga,Gb){return Gwa.mainContext.uniform4iv(Ga.location,Gb),1},Gb._uniform_sampler2D=function(Ga,Gb){var Gc=Gwa.mainContext,Gd=Ga.uploadedValue;return null==Gd[0]?(Gd[0]=this._curActTexIndex,Gc.uniform1i(Ga.location,this._curActTexIndex),Gc.activeTexture(Gj._TEXTURES[this._curActTexIndex]),Gxa.bindTexture(Gc,3553,Gb),this._curActTexIndex++,1):(Gc.activeTexture(Gj._TEXTURES[Gd[0]]),Gxa.bindTexture(Gc,3553,Gb),0)},Gb._uniform_samplerCube=function(Ga,Gb){var Gc=Gwa.mainContext,Gd=Ga.uploadedValue;return null==Gd[0]?(Gd[0]=this._curActTexIndex,Gc.uniform1i(Ga.location,this._curActTexIndex),Gc.activeTexture(Gj._TEXTURES[this._curActTexIndex]),Gxa.bindTexture(Gc,34067,Gb),this._curActTexIndex++,1):(Gc.activeTexture(Gj._TEXTURES[Gd[0]]),Gxa.bindTexture(Gc,34067,Gb),0)},Gb._noSetValue=function(Ga){console.log("no....:"+Ga.name)},Gb.uploadOne=function(Ga,Gb){this.activeResource(),Gxa.UseProgram(this._program);var Gc=this._paramsMap[Ga];Gc.fun.call(this,Gc,Gb)},Gb.uploadTexture2D=function(Ga){GG.shaderCall++;var Gb=Gwa.mainContext;Gb.activeTexture(33984),Gxa.bindTexture(Gb,3553,Ga)},Gb.uploadTexture2D1=function(Ga){GG.shaderCall++;var Gb=Gwa.mainContext;Gb.activeTexture(33985),Gxa.bindTexture(Gb,3553,Ga)},Gb.upload=function(Ga,Gb){GLa.activeShader=GLa.bindShader=this,this._lastUseFrameCount===GG.loopCount||this.activeResource(),Gxa.UseProgram(this._program),this._reCompile?(Gb=this._params,this._reCompile=!1):Gb=Gb||this._params;Gwa.mainContext;for(var Gc,Gd,Ge=Gb.length,Gf=0,Gg=0;Gg<Ge;Gg++)null!==(Gd=Ga[(Gc=Gb[Gg]).name])&&(Gf+=Gc.fun.call(this,Gc,Gd));GG.shaderCall+=Gf},Gb.uploadArray=function(Ga,Gb,Gc){GLa.activeShader=this,(GLa.bindShader=this).activeResource(),Gxa.UseProgram(this._program);this._params;for(var Gd,Ge,Gf=0,Gg=Gb-2;0<=Gg;Gg-=2)(Ge=this._paramsMap[Ga[Gg]])&&null!=(Gd=Ga[Gg+1])&&(Gc&&Gc[Ge.name]&&Gc[Ge.name].bind(),Gf+=Ge.fun.call(this,Ge,Gd));GG.shaderCall+=Gf},Gb.getParams=function(){return this._params},Gj.getShader=function(Ga){return Gj.sharders[Ga]},Gj.create=function(Ga,Gb,Gc,Gd){return new Gj(Ga,Gb,Gc,Gd)},Gj.withCompile=function(Ga,Gb,Gc,Gd){if(Gc&&Gj.sharders[Gc])return Gj.sharders[Gc];var Ge=Gj._preCompileShader[2e-4*Ga];if(!Ge)throw new Error("withCompile shader err!"+Ga);return Ge.createShader(Gb,Gc,Gd)},Gj.withCompile2D=function(Ga,Gb,Gc,Gd,Ge){if(Gd&&Gj.sharders[Gd])return Gj.sharders[Gd];var Gf=Gj._preCompileShader[2e-4*Ga+Gb];if(!Gf)throw new Error("withCompile shader err!"+Ga+" "+Gb);return Gf.createShader(Gc,Gd,Ge)},Gj.addInclude=function(Ga,Gb){Gva.addInclude(Ga,Gb)},Gj.preCompile=function(Ga,Gb,Gc,Gd){var Ge=2e-4*Ga;Gj._preCompileShader[Ge]=new Gva(Ge,Gb,Gc,Gd)},Gj.preCompile2D=function(Ga,Gb,Gc,Gd,Ge){var Gf=2e-4*Ga+Gb;Gj._preCompileShader[Gf]=new Gva(Gf,Gc,Gd,Ge)},Gj._createShader=function(Ga,Gb,Gc){var Gd=Ga.createShader(Gc);return Ga.shaderSource(Gd,Gb),Ga.compileShader(Gd),Gd},Gj._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],Gj._count=0,Gj._preCompileShader={},Gj.SHADERNAME2ID=2e-4,Gj.sharders=((Gj.sharders=[]).length=32,Gj.sharders),Gg(Gj,["nameKey",function(){return this.nameKey=new GH}]),Gj}(),GZa=function(Ga){function Gb(){this._maxsize=0,this._upload=!0,this._uploadSize=0,Gb.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}Go(Gb,"laya.webgl.utils.Buffer2D",Ga);var Gc=Gb.prototype;return Gc.needSize=function(Ga){var Gb=this._byteLength;if(Ga){var Gc=this._byteLength+Ga;Gc<=this._buffer.byteLength||this._resizeBuffer(Gc<<1,!0),this._byteLength=Gc}return Gb},Gc._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),GG.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,GNa._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),GNa._gl.bufferSubData(this._bufferType,0,this._buffer)},Gc._bufferSubData=function(Ga,Gb,Gc){if(void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),this._maxsize=Math.max(this._maxsize,this._byteLength),GG.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,GNa._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),Gb||Gc){var Gd=this._buffer.slice(Gb,Gc);GNa._gl.bufferSubData(this._bufferType,Ga,Gd)}else GNa._gl.bufferSubData(this._bufferType,Ga,this._buffer)},Gc._checkArrayUse=function(){},Gc._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},Gc._bind_subUpload=function(Ga,Gb,Gc){return void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(Ga,Gb,Gc),!0)},Gc._resizeBuffer=function(Ga,Gb){if(Ga<this._buffer.byteLength)return this;if(this.memorySize=Ga,Gb&&this._buffer&&0<this._buffer.byteLength){var Gc=new ArrayBuffer(Ga);new Uint8Array(Gc).set(new Uint8Array(this._buffer),0),this._buffer=Gc}else this._buffer=new ArrayBuffer(Ga);return this._checkArrayUse(),this._upload=!0,this},Gc.append=function(Ga){this._upload=!0;var Gb,Gc;Gb=Ga.byteLength,Ga instanceof Uint8Array?(this._resizeBuffer(this._byteLength+Gb,!0),Gc=new Uint8Array(this._buffer,this._byteLength)):Ga instanceof Uint16Array?(this._resizeBuffer(this._byteLength+Gb,!0),Gc=new Uint16Array(this._buffer,this._byteLength)):Ga instanceof Float32Array&&(this._resizeBuffer(this._byteLength+Gb,!0),Gc=new Float32Array(this._buffer,this._byteLength)),Gc.set(Ga,0),this._byteLength+=Gb,this._checkArrayUse()},Gc.appendU16Array=function(Ga,Gb){this._resizeBuffer(this._byteLength+2*Gb,!0);for(var Gc=new Uint16Array(this._buffer,this._byteLength,Gb),Gd=0;Gd<Gb;Gd++)Gc[Gd]=Ga[Gd];this._byteLength+=2*Gb,this._checkArrayUse()},Gc.appendEx=function(Ga,Gb){this._upload=!0;var Gc;Gc=Ga.byteLength,this._resizeBuffer(this._byteLength+Gc,!0),new Gb(this._buffer,this._byteLength).set(Ga,0),this._byteLength+=Gc,this._checkArrayUse()},Gc.appendEx2=function(Ga,Gb,Gc,Gd){void 0===Gd&&(Gd=1),this._upload=!0;var Ge,Gf;Ge=Gc*Gd,this._resizeBuffer(this._byteLength+Ge,!0),Gf=new Gb(this._buffer,this._byteLength);var Gg=0;for(Gg=0;Gg<Gc;Gg++)Gf[Gg]=Ga[Gg];this._byteLength+=Ge,this._checkArrayUse()},Gc.getBuffer=function(){return this._buffer},Gc.setNeedUpload=function(){this._upload=!0},Gc.getNeedUpload=function(){return this._upload},Gc.upload=function(){var Ga=this._bind_upload();return GNa._gl.bindBuffer(this._bufferType,null),GNa._bindActive[this._bufferType]=null,GLa.activeShader=null,Ga},Gc.subUpload=function(Ga,Gb,Gc){void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0);var Gd=this._bind_subUpload();return GNa._gl.bindBuffer(this._bufferType,null),GNa._bindActive[this._bufferType]=null,GLa.activeShader=null,Gd},Gc.disposeResource=function(){Ga.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},Gc.clear=function(){this._byteLength=0,this._upload=!0},Gd(0,Gc,"bufferLength",function(){return this._buffer.byteLength}),Gd(0,Gc,"byteLength",null,function(Ga){this._byteLength!==Ga&&(Ga<=this._buffer.byteLength||this._resizeBuffer(2*Ga+256,!0),this._byteLength=Ga)}),Gb.__int__=function(Ga){Gma.QuadrangleIB=Gma.create(35044),Gsa.fillIBQuadrangle(Gma.QuadrangleIB,16)},Gb.FLOAT32=4,Gb.SHORT=2,Gb}(GNa),G$a=(function(Gb){function Gc(Ga){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,Gc.__super.call(this,9)}Go(Gc,"laya.webgl.shader.d2.value.GlowSV",Gb);var Ga=Gc.prototype;Ga.setValue=function(Ga){Gb.prototype.setValue.call(this,Ga)},Ga.clear=function(){Gb.prototype.clear.call(this)}}(GRa),function(Ga){function Gb(Ga){Gb.__super.call(this,64),this.defines.add(64)}Go(Gb,"laya.webgl.shader.d2.value.TextSV",Ga);var Gc=Gb.prototype;return Gc.release=function(){(Gb.pool[Gb._length++]=this).clear()},Gc.clear=function(){Ga.prototype.clear.call(this)},Gb.create=function(){return Gb._length?Gb.pool[--Gb._length]:new Gb(null)},Gb.pool=[],Gb._length=0,Gb}(GRa)),G_a=function(Ga){function Ge(Ga,Gb,Gc,Gd){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,Ge.__super.call(this,Ga,Gb,Gc,Gd)}Go(Ge,"laya.webgl.shader.d2.Shader2X",Ga);var Gb=Ge.prototype;return Gb.upload2dQuick1=function(Ga){this.upload(Ga,this._params2dQuick1||this._make2dQuick1())},Gb._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var Ga,Gb=this._params,Gc=0,Gd=Gb.length;Gc<Gd;Gc++)Ga=Gb[Gc],(Gt.isFlash||"size"!==Ga.name&&"position"!==Ga.name&&"texcoord"!==Ga.name)&&this._params2dQuick1.push(Ga)}return this._params2dQuick1},Gb.disposeResource=function(){Ga.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},Gb.upload2dQuick2=function(Ga){this.upload(Ga,this._params2dQuick2||this._make2dQuick2())},Gb._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var Ga,Gb=this._params,Gc=0,Gd=Gb.length;Gc<Gd;Gc++)Ga=Gb[Gc],(Gt.isFlash||"size"!==Ga.name)&&this._params2dQuick2.push(Ga)}return this._params2dQuick2},Ge.create=function(Ga,Gb,Gc,Gd){return new Ge(Ga,Gb,Gc,Gd)},Ge}(GYa),Gma=function(Ga){function Gb(Ga){this._uint8Array=null,this._uint16Array=null,void 0===Ga&&(Ga=35044),Gb.__super.call(this),this._bufferUsage=Ga,this._bufferType=34963,Gt.isFlash||(this._buffer=new ArrayBuffer(8))}Go(Gb,"laya.webgl.utils.IndexBuffer2D",GZa);var Gc=Gb.prototype;return Gc._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},Gc.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},Gc.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},Gc.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},Gb.QuadrangleIB=null,Gb.create=function(Ga){return void 0===Ga&&(Ga=35044),new Gb(Ga)},Gb}(),Gna=function(Ga){function Gc(Ga,Gb){this._floatArray32=null,this._vertexStride=0,Gc.__super.call(this),this._vertexStride=Ga,this._bufferUsage=Gb,this._bufferType=34962,Gt.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}Go(Gc,"laya.webgl.utils.VertexBuffer2D",Ga);var Gb=Gc.prototype;return Gb.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},Gb.bind=function(Ga){Ga&&Ga._bind(),this._bind()},Gb.insertData=function(Ga,Gb){this.getFloat32Array().set(Ga,Gb),this._upload=!0},Gb.bind_upload=function(Ga){Ga._bind_upload()||Ga._bind(),this._bind_upload()||this._bind()},Gb._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},Gb.disposeResource=function(){Ga.prototype.disposeResource.call(this)},Gb.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},Gd(0,Gb,"vertexStride",function(){return this._vertexStride}),Gc.create=function(Ga,Gb){return void 0===Gb&&(Gb=35048),new Gc(Ga,Gb)},Gc}(GZa),Gab=function(Ga){function Gh(Ga,Gb,Gc,Gd,Ge,Gf){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===Gc&&(Gc=6408),void 0===Gd&&(Gd=!0),Gh.__super.call(this,Ga,Gb),Ga){if(this._format=Gc,this._mipmap=Gd,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof Ga)this._url=Ga,this._src=Ga,this._image=new Gp.window.Image,Gb&&(Gb.onload&&(this.onload=Gb.onload),Gb.onerror&&(this.onerror=Gb.onerror),Gb.onCreate&&Gb.onCreate(this)),this._image.crossOrigin=Ga&&0==Ga.indexOf("data:")?null:"",Ga&&(this._image.src=Ga);else if(Ga instanceof ArrayBuffer){this._src=Gb,this._url=this._src;var Gg=new Gi(Ga);Gg.readUTFBytes(4),Gg.readUTFBytes(2),Gg.getInt16();Gg.endian="bigEndian",this._w=Gg.getInt16(),this._h=Gg.getInt16();Gg.getInt16(),Gg.getInt16();this._image=new Uint8Array(Ga,Gg.pos),this._format=Gwa.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,GQ.enabled&&this._w<GQ.atlasLimitWidth&&this._h<GQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(Ga instanceof Uint8Array))return this._src=Gb,this._url=this._src,this._image=Ga.source||Ga,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=Gb,this._url=this._src,this._w=Ge,this._h=Gf,this._image=Ga,this._format=0===Gc?Ga.byteLength/(Ge*Gf)==4?6408:6407:Gc}this._$5__enableMerageInAtlas=!0}}Go(Gh,"laya.webgl.resource.WebGLImage",Gr);var Gb=Gh.prototype;return Gy.imps(Gb,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),Gb._init_=function(Ga,Gb){},Gb._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var Ga=Gwa.mainContext,Gb=this._source=Ga.createTexture(),Gc=Gxa.curBindTexTarget,Gd=Gxa.curBindTexValue;Gxa.bindTexture(Ga,3553,Gb);var Ge=this.minFifter,Gf=this.magFifter,Gg=this.repeat?10497:33071,Gh=Gk.isPOT(this._w,this._h),Gi=!1;switch(Gh?(this.mipmap?-1!==Ge||(Ge=9987):-1!==Ge||(Ge=9729),-1!==Gf||(Gf=9729),Ga.texParameteri(3553,10241,Ge),Ga.texParameteri(3553,10240,Gf),Ga.texParameteri(3553,10242,Gg),Ga.texParameteri(3553,10243,Gg),this.mipmap&&Ga.generateMipmap(3553)):(-1!==Ge||(Ge=9729),-1!==Gf||(Gf=9729),Ga.texParameteri(3553,10241,Ge),Ga.texParameteri(3553,10240,Gf),Ga.texParameteri(3553,10242,33071),Ga.texParameteri(3553,10243,33071)),Ga.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&Ga.pixelStorei(Ga.UNPACK_ALIGNMENT,1),Ga.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&Ga.pixelStorei(Ga.UNPACK_ALIGNMENT,1),Ga.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:Gi=!0,Ga.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case Gwa.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:Gi=!0,Ga.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}Ga.pixelStorei(37441,!1),Gc&&Gd&&Gxa.bindTexture(Ga,Gc,Gd),this.uri||(this.uri=this._url),Gi?this.memorySize=this._image.length:Gh&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},Gb.recreateResource=function(){var Ga=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var Gb=this;this._image=new Gp.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(Gb._needReleaseAgain)return Gb._needReleaseAgain=!1,Gb._image.onload=null,void(Gb._image=null);Gb._allowMerageInAtlas&&Gb._enableMerageInAtlas?(Ga.memorySize=0,Ga._recreateLock=!1):Gb._createWebGlTexture(),Gb.completeCreate()},this._image.src=this._src}},Gb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&Gwa.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},Gb.onresize=function(){this._w=this._image.width,this._h=this._image.height,GQ.enabled&&this._w<GQ.atlasLimitWidth&&this._h<GQ.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},Gb.clearAtlasSource=function(){this._image=null},Gd(0,Gb,"format",function(){return this._format}),Gd(0,Gb,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(Ga){this._$5__enableMerageInAtlas=Ga}),Gd(0,Gb,"mipmap",function(){return this._mipmap}),Gd(0,Gb,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),Gd(0,Gb,"atlasSource",function(){return this._image}),Gd(0,Gb,"onload",null,function(Ga){var Gb=this;this._onload=Ga,this._image&&(this._image.onload=null!=this._onload?function(){Gb.onresize(),Gb._onload()}:null)}),Gd(0,Gb,"onerror",null,function(Ga){var Gb=this;this._onerror=Ga,this._image&&(this._image.onerror=null!=this._onerror?function(){Gb._onerror()}:null)}),Gh}();Gy.__init([Gpa,GP,Gza,Gva])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ga,Gb){"use strict";for(var Gc in Object.defineProperty(Gb,"__esModule",{value:!0}),Laya){var Gd=Laya[Gc];Gd&&Gd.__isclass&&(Gb[Gc]=Gd)}}),function(Gf,Ga,Gd){Gd.un,Gd.uns;var Ge=Gd.static,Gg=Gd.class,Gh=Gd.getset,Gi=(Gd.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),Gq=laya.utils.ClassUtils,Gl=(laya.events.Event,laya.utils.HTMLChar),Gj=laya.net.Loader,Gk=(laya.display.Node,laya.maths.Rectangle),Go=laya.renders.Render,Gp=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),Gr=laya.utils.Stat,GL=laya.display.Text,Gs=laya.resource.Texture,Gt=laya.net.URL,Gu=laya.utils.Utils,Gv=function(){function Gp(){}return Gg(Gp,"laya.html.utils.HTMLParse"),Gp.parse=function(Ga,Gb,Gc){Gb=(Gb="<root>"+(Gb=Gb.replace(/<br>/g,"<br/>"))+"</root>").replace(Gp.spacePattern,Gp.char255);var Gd=Gu.parseXMLFromString(Gb);Gp._parseXML(Ga,Gd.childNodes[0].childNodes,Gc)},Gp._parseXML=function(Ga,Gb,Gc,Gd){var Ge=0,Gf=0;if(Gb.join||Gb.item)for(Ge=0,Gf=Gb.length;Ge<Gf;++Ge)Gp._parseXML(Ga,Gb[Ge],Gc,Gd);else{var Gg,Gh,Gi;if(3==Gb.nodeType)return void(Ga instanceof laya.html.dom.HTMLDivElement?(null==Gb.nodeName&&(Gb.nodeName="#text"),Gh=Gb.nodeName.toLowerCase(),0<(Gi=Gb.textContent.replace(/^\s+|\s+$/g,"")).length&&(Gg=Gq.getInstance(Gh))&&(Ga.addChild(Gg),Gg.innerTEXT=Gi.replace(Gp.char255AndOneSpacePattern," "))):0<(Gi=Gb.textContent.replace(/^\s+|\s+$/g,"")).length&&(Ga.innerTEXT=Gi.replace(Gp.char255AndOneSpacePattern," ")));if("#comment"==(Gh=Gb.nodeName.toLowerCase()))return;if(Gg=Gq.getInstance(Gh)){(Gg=Ga.addChild(Gg)).URI=Gc,Gg.href=Gd;var Gj=Gb.attributes;if(Gj&&0<Gj.length)for(Ge=0,Gf=Gj.length;Ge<Gf;++Ge){var Gk=Gj[Ge],Gl=Gk.nodeName,Go=Gk.value;Gg._setAttributes(Gl,Go)}Gp._parseXML(Gg,Gb.childNodes,Gc,Gg.href)}else Gp._parseXML(Ga,Gb.childNodes,Gc,Gd)}},Gp.char255=String.fromCharCode(255),Gp.spacePattern=/&nbsp;|&#160;/g,Gp.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),Gp}(),Gw=function(){function GK(){}return Gg(GK,"laya.html.utils.Layout"),GK.later=function(Ga){null==GK._will&&(GK._will=[],Gd.stage.frameLoop(1,null,function(){if(!(GK._will.length<1)){for(var Ga=0;Ga<GK._will.length;Ga++)laya.html.utils.Layout.layout(GK._will[Ga]);GK._will.length=0}})),GK._will.push(Ga)},GK.layout=function(Ga){if(!Ga||!Ga._style)return null;if(0==(512&Ga._style._type))return null;Ga.getStyle()._type&=-513;var Gb=GK._multiLineLayout(Ga);return Go.isConchApp&&Ga.layaoutCallNative&&Ga.layaoutCallNative(),Gb},GK._multiLineLayout=function(Ga){if(GL.RightToLeft)return GK._multiLineLayout2(Ga);var Gb=new Array;Ga._addChildsToLayout(Gb);var Gc,Gd,Ge,Gf,Gg,Gh=0,Gi=Gb.length,Gj=Ga._getCSSStyle(),Gk=Gj.letterSpacing,Gl=Gj.leading,Go=Gj.lineHeight,Gp=Gj._widthAuto()||!Gj.wordWrap,Gq=Gp?999999:Ga.width,Gr=(Ga.height,0),Gs=Gj.italic?Gj.fontSize/3:0,Gt=Gj._getAlign(),Gu=Gj._getValign(),Gv=0!==Gu||0!==Gt||0!=Go,Gw=0,Gx=0,Gy=0,Gz=0,GA=new Array,GB=GA[0]=new GM,GC=!1,GD=!1;GB.h=0,Gj.italic&&(Gq-=Gj.fontSize/3);var GE=0,GF=!0;function GG(){GB.y=Gx,Gx+=GB.h+Gl,0==GB.h&&(Gx+=Go),GB.mWidth=GE,GE=0,GB=new GM,GA.push(GB),GB.h=0,GC=!(GF=!(Gw=0))}for(Gh=0;Gh<Gi;Gh++)if(null!=(Gc=Gb[Gh]))if(GF=!1,Gc instanceof laya.html.dom.HTMLBrElement)GG(),GB.y=Gx;else{if(Gc._isChar()){if((Gf=Gc).isWord)GC=GD||"\n"===Gf.char,GB.wordStartIndex=GB.elements.length;else{if(Gy=Gf.width+Gf.style.letterSpacin,0<GA.length&&Gq<Gw+Gy&&0<GB.wordStartIndex){var GH;GH=GB.elements.length-GB.wordStartIndex+1,GB.elements.length=GB.wordStartIndex,Gh-=GH,GG();continue}GC=!1,GE+=Gf.width}Gy=Gf.width+Gk,Gz=Gf.height,GD=!1,(GC=GC||Gq<Gw+Gy)&&GG(),GB.minTextHeight=Math.min(GB.minTextHeight,Gc.height)}else Gd=Gc._getCSSStyle(),Gg=Gc,Ge=Gd.padding,0===Gd._getCssFloat()||(Gv=!0),GC=GD||Gd.lineElement,Gy=Gg.width*Gg._style._tf.scaleX+Ge[1]+Ge[3]+Gk,Gz=Gg.height*Gg._style._tf.scaleY+Ge[0]+Ge[2],GD=Gd.lineElement,(GC=GC||Gq<Gw+Gy&&Gd.wordWrap)&&GG();GB.elements.push(Gc),GB.h=Math.max(GB.h,Gz),Gc.x=Gw,Gc.y=Gx,Gw+=Gy,GB.w=Gw-Gk,GB.y=Gx,Gr=Math.max(Gw+Gs,Gr)}else GF||(Gw+=GK.DIV_ELEMENT_PADDING),GB.wordStartIndex=GB.elements.length;if(Gx=GB.y+GB.h,Gv){var GI=0,GJ=Gq;for(Gp&&0<Ga.width&&(GJ=Ga.width),Gh=0,Gi=GA.length;Gh<Gi;Gh++)GA[Gh].updatePos(0,GJ,Gh,GI,Gt,Gu,Go),GI+=Math.max(Go,GA[Gh].h+Gl);Gx=GI}return Gp&&(Ga.width=Gr),Gx>Ga.height&&(Ga.height=Gx),[Gr,Gx]},GK._multiLineLayout2=function(Ga){var Gb=new Array;Ga._addChildsToLayout(Gb);var Gc,Gd,Ge,Gf,Gg,Gh=0,Gi=Gb.length,Gj=Ga._getCSSStyle(),Gk=Gj.letterSpacing,Gl=Gj.leading,Go=Gj.lineHeight,Gp=Gj._widthAuto()||!Gj.wordWrap,Gq=Gp?999999:Ga.width,Gr=(Ga.height,0),Gs=Gj.italic?Gj.fontSize/3:0,Gt=2-Gj._getAlign(),Gu=Gj._getValign(),Gv=0!==Gu||0!=Gt||0!=Go,Gw=0,Gx=0,Gy=0,Gz=0,GA=new Array,GB=GA[0]=new GM,GC=!1,GD=!1;GB.h=0,Gj.italic&&(Gq-=Gj.fontSize/3);var GE=0,GF=!0;function GG(){GB.y=Gx,Gx+=GB.h+Gl,0==GB.h&&(Gx+=Go),GB.mWidth=GE,GE=0,GB=new GM,GA.push(GB),GB.h=0,GC=!(GF=!(Gw=0))}for(Gh=0;Gh<Gi;Gh++)if(null!=(Gc=Gb[Gh]))if(GF=!1,Gc instanceof laya.html.dom.HTMLBrElement)GG(),GB.y=Gx;else{if(Gc._isChar()){if((Gf=Gc).isWord)GC=GD||"\n"===Gf.char,GB.wordStartIndex=GB.elements.length;else{if(0<GA.length&&Gq<Gw+Gy&&0<GB.wordStartIndex){var GH;GH=GB.elements.length-GB.wordStartIndex+1,GB.elements.length=GB.wordStartIndex,Gh-=GH,GG();continue}GC=!1,GE+=Gf.width}Gy=Gf.width+Gk,Gz=Gf.height,GD=!1,(GC=GC||Gq<Gw+Gy)&&GG(),GB.minTextHeight=Math.min(GB.minTextHeight,Gc.height)}else Gd=Gc._getCSSStyle(),Gg=Gc,Ge=Gd.padding,0===Gd._getCssFloat()||(Gv=!0),GC=GD||Gd.lineElement,Gy=Gg.width*Gg._style._tf.scaleX+Ge[1]+Ge[3]+Gk,Gz=Gg.height*Gg._style._tf.scaleY+Ge[0]+Ge[2],GD=Gd.lineElement,(GC=GC||Gq<Gw+Gy&&Gd.wordWrap)&&GG();GB.elements.push(Gc),GB.h=Math.max(GB.h,Gz),Gc.x=Gw,Gc.y=Gx,Gw+=Gy,GB.w=Gw-Gk,GB.y=Gx,Gr=Math.max(Gw+Gs,Gr)}else GF||(Gw+=GK.DIV_ELEMENT_PADDING),GB.wordStartIndex=GB.elements.length;if(Gx=GB.y+GB.h,Gv){var GI=0,GJ=Gq;for(Gh=0,Gi=GA.length;Gh<Gi;Gh++)GA[Gh].updatePos(0,GJ,Gh,GI,Gt,Gu,Go),GI+=Math.max(Go,GA[Gh].h+Gl);Gx=GI}for(Gp&&(Ga.width=Gr),Gx>Ga.height&&(Ga.height=Gx),Gh=0,Gi=GA.length;Gh<Gi;Gh++)GA[Gh].revertOrder(Gq);return[Gr,Gx]},GK._will=null,GK.DIV_ELEMENT_PADDING=0,GK}(),GM=function(){function Ga(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}Gg(Ga,"laya.html.utils.LayoutLine");var Gb=Ga.prototype;return Gb.updatePos=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){var Gh,Gi=0;0<this.elements.length&&(Gi=(Gh=this.elements[this.elements.length-1]).x+Gh.width-this.elements[0].x);var Gj=0,Gk=NaN;1===Ge&&(Gj=(Gb-Gi)/2),2===Ge&&(Gj=Gb-Gi),0===Gg||0!=Gf||(Gf=1);for(var Gl=0,Go=this.elements.length;Gl<Go;Gl++){var Gp=(Gh=this.elements[Gl])._getCSSStyle();switch(0!==Gj&&(Gh.x+=Gj),Gp._getValign()){case 0:Gh.y=Gd;break;case 1:var Gq=0;99999!=this.minTextHeight&&(Gq=this.minTextHeight);var Gr=(Gq+Gg)/2;Gr=Math.max(Gr,this.h),Gk=(laya.html.dom.HTMLImageElement,Gd+Gr-Gh.height),Gh.y=Gk;break;case 2:Gh.y=Gd+(Gg-Gh.height)}}},Gb.revertOrder=function(Ga){var Gb;if(0<this.elements.length){var Gc,Gd=0;for(Gc=this.elements.length,Gd=0;Gd<Gc;Gd++)(Gb=this.elements[Gd]).x=Ga-Gb.x-Gb.width}},Ga}(),Gx=function(Gc){function Gb(){this.URI=null,this._href=null,Gb.__super.call(this),this._text=Gb._EMPTYTEXT,this.setStyle(new Gi(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}Gg(Gb,"laya.html.dom.HTMLElement",Gc);var Ga=Gb.prototype;return Ga.layaoutCallNative=function(){var Ga=0;if(this._childs&&0<(Ga=this._childs.length))for(var Gb=0;Gb<Ga;Gb++)this._childs[Gb].layaoutCallNative&&this._childs[Gb].layaoutCallNative();var Gc=this._getWords();Gc?laya.html.dom.HTMLElement.fillWords(this,Gc,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},Ga.appendChild=function(Ga){return this.addChild(Ga)},Ga._getWords2=function(){var Ga=this._text.text;if(!Ga||0===Ga.length)return null;var Gb,Gc,Gd=0,Ge=0;if(this._text.drawWords)Gc=this._text.drawWords;else{for(Ge=(Gb=Ga.split(" ")).length-1,Gc=[],Gd=0;Gd<Ge;Gd++)Gc.push(Gb[Gd]," ");0<=Ge&&Gc.push(Gb[Ge]),this._text.drawWords=Gc}var Gf,Gg=this._text.words;if(Gg&&Gg.length===Gc.length)return Gg;null===Gg&&(this._text.words=Gg=[]),Gg.length=Gc.length;var Gh=this.style,Gi=Gh.font;for(Gd=0,Ge=Gc.length;Gd<Ge;Gd++){Gf=Gu.measureText(Gc[Gd],Gi);var Gj=Gg[Gd]=new Gl(Gc[Gd],Gf.width,Gf.height||Gh.fontSize,Gh);if(1<Gj.char.length&&(Gj.charNum=Gj.char),this.href){var Gk=new Gp;this.addChild(Gk),Gj.setSprite(Gk)}}return Gg},Ga._getWords=function(){if(!GL.CharacterCache)return this._getWords2();var Ga=this._text.text;if(!Ga||0===Ga.length)return null;var Gb,Gc=this._text.words;if(Gc&&Gc.length===Ga.length)return Gc;null===Gc&&(this._text.words=Gc=[]),Gc.length=Ga.length;for(var Gd=this.style,Ge=Gd.font,Gf=0,Gg=Ga.length;Gf<Gg;Gf++)if(Gb=Gu.measureText(Ga.charAt(Gf),Ge)){var Gh=Gc[Gf]=new Gl(Ga.charAt(Gf),Gb.width,Gb.height||Gd.fontSize,Gd);if(this.href){var Gi=new Gp;this.addChild(Gi),Gh.setSprite(Gi)}}else console.warn("_getWords size is null"+Ga.charAt(Gf),Ge);return Gc},Ga.showLinkSprite=function(){var Ga=this._text.words;if(Ga)for(var Gb,Gc,Gd=[],Ge=0;Ge<Ga.length;Ge++)Gc=Ga[Ge],(Gb=new Gp).graphics.drawRect(0,0,Gc.width,Gc.height,"#ff0000"),Gb.width=Gc.width,Gb.height=Gc.height,this.addChild(Gb),Gd.push(Gb)},Ga._layoutLater=function(){var Ga=this.style;512&Ga._type||(Ga.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&Ga.block?(Gw.later(this),Ga._type|=512):this.parent&&this.parent._layoutLater())},Ga._setAttributes=function(Ga,Gb){switch(Ga){case"style":return void this.style.cssText(Gb);case"class":return void(this.className=Gb)}Gc.prototype._setAttributes.call(this,Ga,Gb)},Ga.updateHref=function(){if(null!=this._href){var Ga=this._getWords();if(Ga)for(var Gb,Gc,Gd=0;Gd<Ga.length;Gd++)(Gc=(Gb=Ga[Gd]).getSprite())&&(Gc.size(Gb.width,Gb.height),Gc.on("click",this,this.onLinkHandler))}},Ga.onLinkHandler=function(Ga){switch(Ga.type){case"click":for(var Gb=this;Gb;)Gb.event("link",[this.href]),Gb=Gb.parent}},Ga.formatURL=function(Ga){return this.URI?Gt.formatURL(Ga,this.URI?this.URI.path:null):Ga},Gh(0,Ga,"href",function(){return this._href},function(Ga){null!=(this._href=Ga)&&(this._getCSSStyle().underLine=1,this.updateHref())}),Gh(0,Ga,"color",null,function(Ga){this.style.color=Ga}),Gh(0,Ga,"onClick",null,function(Ga){Gd._runScript("fn=function(event){"+Ga+";}"),this.on("click",this,void 0)}),Gh(0,Ga,"id",null,function(Ga){Gy.document.setElementById(Ga,this)}),Gh(0,Ga,"innerTEXT",function(){return this._text.text},function(Ga){this.text=Ga}),Gh(0,Ga,"style",function(){return this._style}),Gh(0,Ga,"text",function(){return this._text.text},function(Ga){this._text==Gb._EMPTYTEXT?this._text={text:Ga,words:null}:(this._text.text=Ga,this._text.words&&(this._text.words.length=0)),Go.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),Gh(0,Ga,"parent",Gc.prototype._$get_parent,function(Ga){if(Ga instanceof laya.html.dom.HTMLElement){var Gb=Ga;this.URI||(this.URI=Gb.URI),this.style.inherit(Gb.style)}Gd.superSet(Gp,this,"parent",Ga)}),Gh(0,Ga,"className",null,function(Ga){this.style.attrs(Gy.document.styleSheets["."+Ga])}),Gb.fillWords=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){Ga.graphics.clear();for(var Gh=0,Gi=Gb.length;Gh<Gi;Gh++){var Gj=Gb[Gh];Ga.graphics.fillText(Gj.char,Gj.x+Gc,Gj.y+Gd,Ge,Gf,"left",Gg)}},Gb._EMPTYTEXT={text:null,words:null},Gb}(Gp),Gb=(function(Ga){function Gb(){Gb.__super.call(this),this.style.lineElement=!0,this.style.block=!0}Gg(Gb,"laya.html.dom.HTMLBrElement",Gx)}(),function(Ga){function Gb(){this.contextHeight=NaN,this.contextWidth=NaN,Gb.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}Gg(Gb,"laya.html.dom.HTMLDivElement",Ga);var Gc=Gb.prototype;return Gc.appendHTML=function(Ga){Gv.parse(this,Ga,this.URI),this.layout()},Gc._addChildsToLayout=function(Gb){var Ga=this._getWords();if(null==Ga&&0==this._childs.length)return!1;Ga&&Ga.forEach(function(Ga){Gb.push(Ga)});for(var Gc=!0,Gd=0,Ge=this._childs.length;Gd<Ge;Gd++){var Gf=this._childs[Gd];Gc?Gc=!1:Gb.push(null),Gf._addToLayout(Gb)}return!0},Gc._addToLayout=function(Ga){this.layout()},Gc.layout=function(){if(this.style){this.style._type|=512;var Ga=Gw.layout(this);if(Ga){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new Gk);var Gb=this._$P.mHtmlBounds;Gb.x=Gb.y=0,Gb.width=this.contextWidth=Ga[0],Gb.height=this.contextHeight=Ga[1],this.setBounds(Gb)}}},Gh(0,Gc,"height",function(){return this._height?this._height:this.contextHeight},Ga.prototype._$set_height),Gh(0,Gc,"innerHTML",null,function(Ga){this.destroyChildren(),this.appendHTML(Ga)}),Gh(0,Gc,"width",function(){return this._width?this._width:this.contextWidth},function(Ga){var Gb=!1;Gb=0===Ga?Ga!=this._width:Ga!=this.width,Gd.superSet(Gx,this,"width",Ga),Gb&&this.layout()}),Gb}(Gx)),Gy=function(Ga){function Gb(){this.all=new Array,this.styleSheets=Gi.styleSheets,Gb.__super.call(this)}Gg(Gb,"laya.html.dom.HTMLDocument",Gx);var Gc=Gb.prototype;return Gc.getElementById=function(Ga){return this.all[Ga]},Gc.setElementById=function(Ga,Gb){this.all[Ga]=Gb},Ge(Gb,["document",function(){return this.document=new Gb}]),Gb}();(function(Ga){function Gb(){this._tex=null,this._url=null,this._renderArgs=[],Gb.__super.call(this),this.style.block=!0}Gg(Gb,"laya.html.dom.HTMLImageElement",Gx);var Gc=Gb.prototype;Gc._addToLayout=function(Ga){!this._style.absolute&&Ga.push(this)},Gc.render=function(Ga,Gb,Gc){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(Gr.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,Ga.ctx.drawTexture2(Gb,Gc,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},Gc.layaoutCallNative=function(){var Ga=0;if(this._childs&&0<(Ga=this._childs.length))for(var Gb=0;Gb<Ga;Gb++)this._childs[Gb].layaoutCallNative&&this._childs[Gb].layaoutCallNative()},Gh(0,Gc,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(Ga){this._width!==Ga&&(this._width=Ga,this._style.width=Ga,this.repaint())}),Gh(0,Gc,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(Ga){this._height!==Ga&&(this._height=Ga,this._style.height=Ga,this.repaint())}),Gc.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),Gj.clearCache(this,this._url),this._tex=null),Gx.prototype.destroy.call(this)},Gc.onloaded=function(){var Ga=this._style;Ga&&!Ga.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),Ga&&!Ga.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),Go.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},Gc._loadImageComplete=function(Ga,Gb,Gc){if(!this._destroyed)if(null!=Gc)if(Gc instanceof ArrayBuffer){var Gd=new DataView(Gc);new laya.webgl.resource.WebGLImage(new Uint8Array(Gc,8),Ga,0,!1,Gd.getUint32(0),Gd.getUint32(4));this.onloaded()}else if(Gc instanceof Gs)Gj.imgMgrSet[Ga]=Gb,Gf.imgMgrLock(Ga,Gj.imgMgrSet[Ga]),this._url=Ga,this._tex=Gc,Gj.keepCache(this,Ga),Gj.cacheRes(Ga,this._tex),this.onloaded();else{var Ge=-1!=Ga.indexOf(".png",Ga.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(Gc,Ga,Ge,!1,Gc.width,Gc.height);this.onloaded()}else this.event("error","Load image failed")},Gh(0,Gc,"src",null,function(Ga){(Ga=this.formatURL(Ga),this._url!=Ga)&&(null!=this._tex&&(Gj.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=Ga,(this._tex=Gj.getRes(Ga))?(Gj.keepCache(this,Ga),this.onloaded()):Gf.imgMgrLoad(Ga,this._loadImageComplete.bind(this),2,!1))})})(),function(Ga){function Gb(){this.type=null,Gb.__super.call(this),this.visible=!1}Gg(Gb,"laya.html.dom.HTMLLinkElement",Ga);var Gc=Gb.prototype;Gc._onload=function(Ga){switch(this.type){case"text/css":Gi.parseCSS(Ga,this.URI)}},Gh(0,Gc,"href",Ga.prototype._$get_href,function(Ga){var Gb=this;Ga=this.formatURL(Ga),this.URI=new Gt(Ga);var Gc=new Gj;Gc.once("complete",null,function(Ga){Gb._onload(Ga)}),Gc.load(Ga,"text")}),Gb._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(Gx),function(Ga){function Gb(){Gb.__super.call(this),this.visible=!1}Gg(Gb,"laya.html.dom.HTMLStyleElement",Ga),Gh(0,Gb.prototype,"text",Ga.prototype._$get_text,function(Ga){Gi.parseCSS(Ga,null)})}(Gx),function(Ga){function Gb(){Gb.__super.call(this),this._getCSSStyle().valign="middle"}Gg(Gb,"laya.html.dom.HTMLIframeElement",Ga),Gh(0,Gb.prototype,"href",Ga.prototype._$get_href,function(Gc){var Gd=this;Gc=this.formatURL(Gc);var Ga=new Gj;Ga.once("complete",null,function(Ga){var Gb=Gd.URI;Gd.URI=new Gt(Gc),Gd.innerHTML=Ga,!Gb||(Gd.URI=Gb)}),Ga.load(Gc,"text")})}(Gb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ga,Gb){"use strict";for(var Gc in Object.defineProperty(Gb,"__esModule",{value:!0}),Laya){var Gd=Laya[Gc];Gd&&Gd.__isclass&&(Gb[Gc]=Gd)}}),function(Ga,Gb,Gr){Gr.un,Gr.uns;var Gd=Gr.static,Gf=Gr.class,Ge=Gr.getset,Gc=(Gr.__newvec,laya.display.Animation),Gs=(laya.utils.Browser,laya.utils.ClassUtils),Gg=laya.filters.ColorFilter,Gh=laya.utils.Ease,Gi=laya.events.Event,Gj=(laya.events.EventDispatcher,laya.display.css.Font),Gk=laya.display.FrameAnimation,Gl=laya.display.Graphics,Go=laya.utils.Handler,Gp=laya.display.Input,Gu=laya.net.Loader,Gq=(laya.display.Node,laya.maths.Point),Gt=laya.maths.Rectangle,Gv=laya.renders.Render,Gw=laya.display.Sprite,Gx=laya.display.Text,Gy=laya.resource.Texture,Gz=laya.utils.Tween,GA=laya.utils.Utils,GB=laya.utils.WeakObject;Gr.interface("laya.ui.IItem"),Gr.interface("laya.ui.ISelect"),Gr.interface("laya.ui.IRender"),Gr.interface("laya.ui.IComponent"),Gr.interface("laya.ui.IBox","IComponent");var GC=function(){function Ga(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return Gf(Ga,"laya.ui.LayoutStyle"),Gd(Ga,["EMPTY",function(){return this.EMPTY=new Ga}]),Ga}(),GD=function(){function Ga(){}return Gf(Ga,"laya.ui.Styles"),Ga.labelColor="#000000",Ga.buttonStateNum=3,Ga.scrollBarMinNum=15,Ga.scrollBarDelayTime=500,Gd(Ga,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),Ga}(),GE=function(){function Ge(){}return Gf(Ge,"laya.ui.UIUtils"),Ge.fillArray=function(Ga,Gb,Gc){var Gd=Ga.concat();if(Gb)for(var Ge=Gb.split(","),Gf=0,Gg=Math.min(Gd.length,Ge.length);Gf<Gg;Gf++){var Gh=Ge[Gf];Gd[Gf]="true"==Gh||"false"!=Gh&&Gh,null!=Gc&&(Gd[Gf]=Gc(Gh))}return Gd},Ge.toColor=function(Ga){return GA.toHexColor(Ga)},Ge.gray=function(Ga,Gb){void 0===Gb&&(Gb=!0),Gb?Ge.addFilter(Ga,Ge.grayFilter):Ge.clearFilter(Ga,Gg)},Ge.addFilter=function(Ga,Gb){var Gc=Ga.filters||[];Gc.push(Gb),Ga.filters=Gc},Ge.clearFilter=function(Ga,Gb){var Gc=Ga.filters;if(null!=Gc&&0<Gc.length){for(var Gd=Gc.length-1;-1<Gd;Gd--){var Ge=Gc[Gd];Gr.__typeof(Ge,Gb)&&Gc.splice(Gd,1)}Ga.filters=Gc}},Ge._getReplaceStr=function(Ga){return Ge.escapeSequence[Ga]},Ge.adptString=function(Ga){return Ga.replace(/\\(\w)/g,Ge._getReplaceStr)},Ge.getBindFun=function(Ga){var Gb=Ge._funMap.get(Ga);if(null==Gb){var Gc='"'+Ga+'"',Gd="(function(data){if(data==null)return;with(data){try{\nreturn "+(Gc=Gc.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";Gb=Gr._runScript(Gd),Ge._funMap.set(Ga,Gb)}return Gb},Gd(Ge,["grayFilter",function(){return this.grayFilter=new Gg([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new GB}]),Ge}(),GF=function(){function Ga(){}return Gf(Ga,"UIConfig"),Ga.touchScrollEnable=!0,Ga.mouseWheelEnable=!0,Ga.showButtons=!0,Ga.popupBgColor="#000000",Ga.popupBgAlpha=.5,Ga.closeDialogOnSide=!0,Ga}(),GG=function(Gc){function Gt(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,Gt.__super.call(this),this._weakKeys=[]}Gf(Gt,"laya.ui.AutoBitmap",Gc);var Ga=Gt.prototype;return Ga.destroy=function(){if(Gu.clearObject(this,this._weakKey),this._weakKeys){for(var Ga=0,Gb=this._weakKeys.length;Ga<Gb;++Ga)Gu.clearObject(this,this._weakKeys[Ga]);this._weakKeys=null}Gc.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},Ga._setChanged=function(){this._isChanged||(this._isChanged=!0,Gr.timer.callLater(this,this.changeSource))},Ga.changeSource=function(){this._isChanged=!1;var Ga=this._source;if(Ga&&Ga.bitmap){var Gb=this.width,Gc=this.height,Gd=this._sizeGrid,Ge=Ga.sourceWidth,Gf=Ga.sourceHeight;if(!Gd||Ge===Gb&&Gf===Gc)this.cleanByTexture(Ga,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,Gb,Gc);else{Gu.clearObject(this,this._weakKey),Ga.$_GID||(Ga.$_GID=GA.getGID());var Gg=Ga.$_GID+"."+Gb+"."+Gc+"."+Gd.join("."),Gh=Gu.findObject(Gg);if(GA.isOKCmdList(Gh))return this._weakKey=Gg,Gu.keepObject(this,this._weakKey),void(this.cmds=Gh);this.clear();var Gi,Gj,Gk=Gd[0],Gl=Gd[1],Go=Gd[2],Gp=Gd[3],Gq=Gd[4],Gr=!1;if(Gb==Ge&&(Gp=Gl=0),Gc==Gf&&(Gk=Go=0),Gb<Gp+Gl){var Gs=Gb;Gr=!0,Gb=Gp+Gl,this.save(),this.clipRect(0,0,Gs,Gc)}Gp&&Gk&&(Gi=Gt.getTexture(Ga,0,0,Gp,Gk),Gj=this._weakKeys[0],Gi?(Gj!=Gi.weakKey&&(Gu.clearObject(this,Gj),Gu.keepObject(this,Gi.weakKey),this._weakKeys[0]=Gi.weakKey),this.drawTexture(Gi,0,0,Gp,Gk)):(Gu.clearObject(this,Gj),this._weakKeys[0]="")),Gl&&Gk&&(Gi=Gt.getTexture(Ga,Ge-Gl,0,Gl,Gk),Gj=this._weakKeys[1],Gi?(Gj!=Gi.weakKey&&(Gu.clearObject(this,Gj),Gu.keepObject(this,Gi.weakKey),this._weakKeys[1]=Gi.weakKey),this.drawTexture(Gi,Gb-Gl,0,Gl,Gk)):(Gu.clearObject(this,Gj),this._weakKeys[1]="")),Gp&&Go&&(Gi=Gt.getTexture(Ga,0,Gf-Go,Gp,Go),Gj=this._weakKeys[2],Gi?(Gj!=Gi.weakKey&&(Gu.clearObject(this,Gj),Gu.keepObject(this,Gi.weakKey),this._weakKeys[2]=Gi.weakKey),this.drawTexture(Gi,0,Gc-Go,Gp,Go)):(Gu.clearObject(this,Gj),this._weakKeys[2]="")),Gl&&Go&&(Gi=Gt.getTexture(Ga,Ge-Gl,Gf-Go,Gl,Go),Gj=this._weakKeys[3],Gi?(Gj!=Gi.weakKey&&(Gu.clearObject(this,Gj),Gu.keepObject(this,Gi.weakKey),this._weakKeys[3]=Gi.weakKey),this.drawTexture(Gi,Gb-Gl,Gc-Go,Gl,Go)):(Gu.clearObject(this,Gj),this._weakKeys[3]="")),Gk&&(Gi=Gt.getTexture(Ga,Gp,0,Ge-Gp-Gl,Gk),Gj=this._weakKeys[4],Gi?(Gj!=Gi.weakKey&&(Gu.clearObject(this,Gj),Gu.keepObject(this,Gi.weakKey),this._weakKeys[4]=Gi.weakKey),this.drawBitmap(Gq,Gi,Gp,0,Gb-Gp-Gl,Gk)):(Gu.clearObject(this,Gj),this._weakKeys[4]="")),Go&&(Gi=Gt.getTexture(Ga,Gp,Gf-Go,Ge-Gp-Gl,Go),Gj=this._weakKeys[5],Gi?(Gj!=Gi.weakKey&&(Gu.clearObject(this,Gj),Gu.keepObject(this,Gi.weakKey),this._weakKeys[5]=Gi.weakKey),this.drawBitmap(Gq,Gi,Gp,Gc-Go,Gb-Gp-Gl,Go)):(Gu.clearObject(this,Gj),this._weakKeys[5]="")),Gp&&(Gi=Gt.getTexture(Ga,0,Gk,Gp,Gf-Gk-Go),Gj=this._weakKeys[6],Gi?(Gj!=Gi.weakKey&&(Gu.clearObject(this,Gj),Gu.keepObject(this,Gi.weakKey),this._weakKeys[6]=Gi.weakKey),this.drawBitmap(Gq,Gi,0,Gk,Gp,Gc-Gk-Go)):(Gu.clearObject(this,Gj),this._weakKeys[6]="")),Gl&&(Gi=Gt.getTexture(Ga,Ge-Gl,Gk,Gl,Gf-Gk-Go),Gj=this._weakKeys[7],Gi?(Gj!=Gi.weakKey&&(Gu.clearObject(this,Gj),Gu.keepObject(this,Gi.weakKey),this._weakKeys[7]=Gi.weakKey),this.drawBitmap(Gq,Gi,Gb-Gl,Gk,Gl,Gc-Gk-Go)):(Gu.clearObject(this,Gj),this._weakKeys[7]="")),Gi=Gt.getTexture(Ga,Gp,Gk,Ge-Gp-Gl,Gf-Gk-Go),Gj=this._weakKeys[8],Gi?(Gj!=Gi.weakKey&&(Gu.clearObject(this,Gj),Gu.keepObject(this,Gi.weakKey),this._weakKeys[8]=Gi.weakKey),this.drawBitmap(Gq,Gi,Gp,Gk,Gb-Gp-Gl,Gc-Gk-Go)):(Gu.clearObject(this,Gj),this._weakKeys[8]=""),Gr&&this.restore(),this.autoCacheCmd&&!Gv.isConchApp&&(Gu.saveObject(Gg,this.cmds,null),this._weakKey=Gg,Gu.keepObject(this,this._weakKey))}this._repaint()}},Ga.drawBitmap=function(Ga,Gb,Gc,Gd,Ge,Gf){void 0===Ge&&(Ge=0),void 0===Gf&&(Gf=0),Ge<.1||Gf<.1||(!Ga||Gb.width==Ge&&Gb.height==Gf?this.drawTexture(Gb,Gc,Gd,Ge,Gf):this.fillTexture(Gb,Gc,Gd,Ge,Gf))},Ga.clear=function(Ga){void 0===Ga&&(Ga=!0),Gc.prototype.clear.call(this,!1)},Ge(0,Ga,"sizeGrid",function(){return this._sizeGrid},function(Ga){this._sizeGrid=Ga,this._setChanged()}),Ge(0,Ga,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(Ga){this._width!=Ga&&(this._width=Ga,this._setChanged())}),Ge(0,Ga,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(Ga){this._height!=Ga&&(this._height=Ga,this._setChanged())}),Ge(0,Ga,"source",function(){return this._source},function(Ga){Ga?(this._source=Ga,this._setChanged()):(this._source=null,this.clear())}),Gt.getTexture=function(Ga,Gb,Gc,Gd,Ge){Gd<=0&&(Gd=1),Ge<=0&&(Ge=1),Ga.$_GID||(Ga.$_GID=GA.getGID());var Gf=Ga.$_GID+"."+Gb+"."+Gc+"."+Gd+"."+Ge,Gg=Gu.findObject(Gf);if((!Gg||!Gg.source)&&(Gg=Gy.createFromTexture(Ga,Gb,Gc,Gd,Ge))){if(Ga.alphaTexture){var Gh=Ga.width/Ga.alphaTexture.width;Gg.alphaTexture=Gy.createFromTexture(Ga.alphaTexture,Gb/Gh,Gc/Gh,Gd/Gh,Ge/Gh)}Gu.saveObject(Gf,Gg),Gg.weakKey=Gf}return Gg},Gt}(Gl),GH=(function(Ga){function Gb(){Gb.__super.call(this)}Gf(Gb,"laya.ui.UIEvent",Gi),Gb.SHOW_TIP="showtip",Gb.HIDE_TIP="hidetip"}(),function(Gb){function Ga(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,Ga.__super.call(this),this._layout=GC.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}Gf(Ga,"laya.ui.Component",Gb);var Gc=Ga.prototype;return Gr.imps(Gc,{"laya.ui.IComponent":!0}),Gc.destroy=function(Ga){void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,Ga),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},Gc.preinitialize=function(){},Gc.createChildren=function(){},Gc.initialize=function(){},Gc.callLater=function(Ga,Gb){Gr.timer.callLater(this,Ga,Gb)},Gc.runCallLater=function(Ga){Gr.timer.runCallLater(this,Ga)},Gc.commitMeasure=function(){},Gc.changeSize=function(){this.event("resize")},Gc.getLayout=function(){return this._layout===GC.EMPTY&&(this._layout=new GC),this._layout},Gc._setLayoutEnabled=function(Ga){this._layout&&this._layout.enable!=Ga&&(this._layout.enable=Ga,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},Gc.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},Gc.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},Gc.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},Gc.resetLayoutX=function(){var Ga=this._layout;if(isNaN(Ga.anchorX)||(this.pivotX=Ga.anchorX*this.width),this.layoutEnabled){var Gb=this.parent;Gb&&(isNaN(Ga.centerX)?isNaN(Ga.left)?isNaN(Ga.right)||(this.x=Math.round(Gb.width-this.displayWidth-Ga.right+this.pivotX*this.scaleX)):(this.x=Math.round(Ga.left+this.pivotX*this.scaleX),isNaN(Ga.right)||(this.width=(Gb._width-Ga.left-Ga.right)/(this.scaleX||.01))):this.x=Math.round(.5*(Gb.width-this.displayWidth)+Ga.centerX+this.pivotX*this.scaleX))}},Gc.resetLayoutY=function(){var Ga=this._layout;if(isNaN(Ga.anchorY)||(this.pivotY=Ga.anchorY*this.height),this.layoutEnabled){var Gb=this.parent;Gb&&(isNaN(Ga.centerY)?isNaN(Ga.top)?isNaN(Ga.bottom)||(this.y=Math.round(Gb.height-this.displayHeight-Ga.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(Ga.top+this.pivotY*this.scaleY),isNaN(Ga.bottom)||(this.height=(Gb._height-Ga.top-Ga.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(Gb.height-this.displayHeight)+Ga.centerY+this.pivotY*this.scaleY))}},Gc.onMouseOver=function(Ga){Gr.stage.event("showtip",this._toolTip)},Gc.onMouseOut=function(Ga){Gr.stage.event("hidetip",this._toolTip)},Ge(0,Gc,"displayWidth",function(){return this.width*this.scaleX}),Ge(0,Gc,"width",function(){return this._width?this._width:this.measureWidth},function(Ga){this._width!=Ga&&(this._width=Ga,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),Ge(0,Gc,"measureWidth",function(){var Ga=0;this.commitMeasure();for(var Gb=this.numChildren-1;-1<Gb;Gb--){var Gc=this.getChildAt(Gb);Gc.visible&&(Ga=Math.max(Gc.x+Gc.width*Gc.scaleX,Ga))}return Ga}),Ge(0,Gc,"displayHeight",function(){return this.height*this.scaleY}),Ge(0,Gc,"height",function(){return this._height?this._height:this.measureHeight},function(Ga){this._height!=Ga&&(this._height=Ga,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),Ge(0,Gc,"dataSource",function(){return this._dataSource},function(Ga){for(var Gb in this._dataSource=Ga,this._dataSource)this.hasOwnProperty(Gb)&&"function"!=typeof this[Gb]&&(this[Gb]=this._dataSource[Gb])}),Ge(0,Gc,"scaleY",Gb.prototype._$get_scaleY,function(Ga){Gr.superGet(Gw,this,"scaleY")!=Ga&&(Gr.superSet(Gw,this,"scaleY",Ga),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),Ge(0,Gc,"measureHeight",function(){var Ga=0;this.commitMeasure();for(var Gb=this.numChildren-1;-1<Gb;Gb--){var Gc=this.getChildAt(Gb);Gc.visible&&(Ga=Math.max(Gc.y+Gc.height*Gc.scaleY,Ga))}return Ga}),Ge(0,Gc,"scaleX",Gb.prototype._$get_scaleX,function(Ga){Gr.superGet(Gw,this,"scaleX")!=Ga&&(Gr.superSet(Gw,this,"scaleX",Ga),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),Ge(0,Gc,"top",function(){return this._layout.top},function(Ga){Ga!=this._layout.top&&(this.getLayout().top=Ga,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Ge(0,Gc,"bottom",function(){return this._layout.bottom},function(Ga){Ga!=this._layout.bottom&&(this.getLayout().bottom=Ga,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Ge(0,Gc,"left",function(){return this._layout.left},function(Ga){Ga!=this._layout.left&&(this.getLayout().left=Ga,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Ge(0,Gc,"right",function(){return this._layout.right},function(Ga){Ga!=this._layout.right&&(this.getLayout().right=Ga,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Ge(0,Gc,"centerX",function(){return this._layout.centerX},function(Ga){Ga!=this._layout.centerX&&(this.getLayout().centerX=Ga,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Ge(0,Gc,"centerY",function(){return this._layout.centerY},function(Ga){Ga!=this._layout.centerY&&(this.getLayout().centerY=Ga,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Ge(0,Gc,"anchorX",function(){return this._layout.anchorX},function(Ga){Ga!=this._layout.anchorX&&(this.getLayout().anchorX=Ga,this._setLayoutEnabled(!0)),this.resetLayoutX()}),Ge(0,Gc,"anchorY",function(){return this._layout.anchorY},function(Ga){Ga!=this._layout.anchorY&&(this.getLayout().anchorY=Ga,this._setLayoutEnabled(!0)),this.resetLayoutY()}),Ge(0,Gc,"tag",function(){return this._tag},function(Ga){this._tag=Ga}),Ge(0,Gc,"toolTip",function(){return this._toolTip},function(Ga){this._toolTip!=Ga&&(null!=(this._toolTip=Ga)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),Ge(0,Gc,"comXml",function(){return this._comXml},function(Ga){this._comXml=Ga}),Ge(0,Gc,"gray",function(){return this._gray},function(Ga){Ga!==this._gray&&(this._gray=Ga,GE.gray(this,Ga))}),Ge(0,Gc,"disabled",function(){return this._disabled},function(Ga){Ga!==this._disabled&&(this.gray=this._disabled=Ga,this.mouseEnabled=!Ga)}),Ga}(Gw)),GI=function(Ga){function Gb(){this.lockLayer=null,this.popupEffect=function(Ga){Ga.scale(1,1),Gz.from(Ga,{x:Gr.stage.width/2,y:Gr.stage.height/2,scaleX:0,scaleY:0},300,Gh.backOut,Go.create(this,this.doOpen,[Ga]))},this.closeEffect=function(Ga,Gb){Gz.to(Ga,{x:Gr.stage.width/2,y:Gr.stage.height/2,scaleX:0,scaleY:0},300,Gh.strongOut,Go.create(this,this.doClose,[Ga,Gb]))},Gb.__super.call(this),this.maskLayer=new Gw,this.popupEffectHandler=Go.create(this,this.popupEffect,null,!1),this.closeEffectHandler=Go.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,Gr.stage.addChild(this),Gr.stage.on("resize",this,this._onResize),GF.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}Gf(Gb,"laya.ui.DialogManager",Gw);var Gc=Gb.prototype;return Gc._closeOnSide=function(){var Ga=this.getChildAt(this.numChildren-1);Ga instanceof laya.ui.Dialog&&Ga.close("side")},Gc.setLockView=function(Ga){this.lockLayer||(this.lockLayer=new GJ,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(Gr.stage.width,Gr.stage.height)),this.lockLayer.removeChildren(),Ga&&(Ga.centerX=Ga.centerY=0,this.lockLayer.addChild(Ga))},Gc._onResize=function(Ga){var Gb=this.maskLayer.width=Gr.stage.width,Gc=this.maskLayer.height=Gr.stage.height;this.lockLayer&&this.lockLayer.size(Gb,Gc),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,Gb,Gc,GF.popupBgColor),this.maskLayer.alpha=GF.popupBgAlpha;for(var Gd=this.numChildren-1;-1<Gd;Gd--){var Ge=this.getChildAt(Gd);Ge.popupCenter&&this._centerDialog(Ge)}},Gc._centerDialog=function(Ga){Ga.x=Math.round((Gr.stage.width-Ga.width>>1)+Ga.pivotX),Ga.y=Math.round((Gr.stage.height-Ga.height>>1)+Ga.pivotY)},Gc.open=function(Ga,Gb,Gc){void 0===Gb&&(Gb=!1),void 0===Gc&&(Gc=!1),Gb&&this._closeAll(),Ga.popupCenter&&this._centerDialog(Ga),this.addChild(Ga),(Ga.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),Gc&&null!=Ga.popupEffect?Ga.popupEffect.runWith(Ga):this.doOpen(Ga),this.event("open")},Gc.doOpen=function(Ga){Ga.onOpened()},Gc.lock=function(Ga){this.lockLayer&&(Ga?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},Gc.close=function(Ga,Gb,Gc){void 0===Gc&&(Gc=!1),Gc&&null!=Ga.closeEffect?Ga.closeEffect.runWith([Ga,Gb]):this.doClose(Ga,Gb),this.event("close")},Gc.doClose=function(Ga,Gb){Ga.removeSelf(),Ga.isModal&&this._checkMask(),Ga.closeHandler&&Ga.closeHandler.runWith(Gb),Ga.onClosed(Gb)},Gc.closeAll=function(){this._closeAll(),this.event("close")},Gc._closeAll=function(){for(var Ga=this.numChildren-1;-1<Ga;Ga--){var Gb=this.getChildAt(Ga);Gb&&null!=Gb.close&&this.doClose(Gb)}},Gc.getDialogsByGroup=function(Ga){for(var Gb=[],Gc=this.numChildren-1;-1<Gc;Gc--){var Gd=this.getChildAt(Gc);Gd&&Gd.group===Ga&&Gb.push(Gd)}return Gb},Gc.closeByGroup=function(Ga){for(var Gb=[],Gc=this.numChildren-1;-1<Gc;Gc--){var Gd=this.getChildAt(Gc);Gd&&Gd.group===Ga&&(Gd.close(),Gb.push(Gd))}return Gb},Gc._checkMask=function(){this.maskLayer.removeSelf();for(var Ga=this.numChildren-1;-1<Ga;Ga--){var Gb=this.getChildAt(Ga);if(Gb&&Gb.isModal)return void this.addChildAt(this.maskLayer,Ga)}},Gb}(),GJ=function(Ga){function Gb(){Gb.__super.call(this)}Gf(Gb,"laya.ui.Box",Ga);var Gc=Gb.prototype;return Gr.imps(Gc,{"laya.ui.IBox":!0}),Ge(0,Gc,"dataSource",Ga.prototype._$get_dataSource,function(Ga){for(var Gb in this._dataSource=Ga){var Gc=this.getChildByName(Gb);Gc?Gc.dataSource=Ga[Gb]:this.hasOwnProperty(Gb)&&"function"!=typeof this[Gb]&&(this[Gb]=Ga[Gb])}}),Gb}(GH),GK=function(Gb){function Gc(Ga,Gb){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,Gc.__super.call(this),this._labelColors=GD.buttonLabelColors,this._stateNum=GD.buttonStateNum,void 0===Gb&&(Gb=""),this.skin=Ga,this.label=Gb}Gf(Gc,"laya.ui.Button",Gb);var Ga=Gc.prototype;return Gr.imps(Ga,{"laya.ui.ISelect":!0}),Ga.destroy=function(Ga){Gu.clearCache(this,this._skin),Gu.clearObject(this,this._weakKey),void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,Ga),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(Ga),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},Ga.createChildren=function(){this.graphics=this._bitmap=new GG},Ga.createText=function(){this._text||(this._text=new Gx,this._text.overflow=Gx.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},Ga.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},Ga.onMouse=function(Ga){if(!1!==this.toggle||!this._selected)return"click"===Ga.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=Gc.stateMap[Ga.type]))},Ga.changeClips=function(){var Ga=Gu.getRes(this._skin);if(Ga&&this._skin&&""!=this._skin){Gu.clearObject(this,this._weakKey);var Gb=Ga.sourceWidth,Gc=Ga.sourceHeight/this._stateNum;Ga.$_GID||(Ga.$_GID=GA.getGID());var Gd=Ga.$_GID+"-"+this._stateNum,Ge=Gu.findObject(Gd);if(GA.isOkTextureList(Ge)||(Ge=null),Ge)this._weakKey=Gd,Gu.keepObject(this,this._weakKey),this._sources=Ge;else{if(this._sources=[],1===this._stateNum)this._sources.push(Ga);else for(var Gf=0;Gf<this._stateNum;Gf++){var Gg=Gy.createFromTexture(Ga,0,Gc*Gf,Gb,Gc);if(Ga.alphaTexture){var Gh=Ga.width/Ga.alphaTexture.width;Gg.alphaTexture=Gy.createFromTexture(Ga.alphaTexture,0/Gh,Gc*Gf/Gh,Gb/Gh,Gc/Gh)}this._sources.push(Gg)}Gu.saveObject(Gd,this._sources),this._weakKey=Gd,Gu.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||Gb,this._bitmap.height=this._height||Gc,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=Gb)}else console.warn("lose skin ",this._skin,this.name,this.__className)},Ga.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var Ga=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[Ga]),this.label&&(this._text.color=this._labelColors[Ga],this._strokeColors&&(this._text.strokeColor=this._strokeColors[Ga]))},Ga._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},Ge(0,Ga,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(Ga){this.createText(),this._text.strokeColor=Ga}),Ge(0,Ga,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),Ge(0,Ga,"skin",function(){return this._skin},function(Ga){this._skin!=Ga&&(Gu.clearCache(this,this._skin),this._skin=Ga,Gu.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),Ge(0,Ga,"state",function(){return this._state},function(Ga){this._state!=Ga&&(this._state=Ga,this._setStateChanged())}),Ge(0,Ga,"text",function(){return this.createText(),this._text}),Ge(0,Ga,"stateNum",function(){return this._stateNum},function(Ga){"string"==typeof Ga&&(Ga=parseInt(Ga)),this._stateNum!=Ga&&(this._stateNum=Ga<1?1:3<Ga?3:Ga,this.callLater(this.changeClips))}),Ge(0,Ga,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(Ga){this._strokeColors=GE.fillArray(GD.buttonLabelColors,Ga,String),this._setStateChanged()}),Ge(0,Ga,"labelColors",function(){return this._labelColors.join(",")},function(Ga){this._labelColors=GE.fillArray(GD.buttonLabelColors,Ga,String),this._setStateChanged()}),Ge(0,Ga,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),Ge(0,Ga,"label",function(){return this._text?this._text.text:null},function(Ga){(this._text||Ga)&&(this.createText(),this._text.text!=Ga&&(Ga&&!this._text.parent&&this.addChild(this._text),this._text.text=(Ga+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),Ge(0,Ga,"selected",function(){return this._selected},function(Ga){this._selected!=Ga&&(this._selected=Ga,this.state=this._selected?2:0,this.event("change"))}),Ge(0,Ga,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(Ga){this.createText(),this._text.padding=GE.fillArray(GD.labelPadding,Ga,Number)}),Ge(0,Ga,"labelSize",function(){return this.createText(),this._text.fontSize},function(Ga){this.createText(),this._text.fontSize=Ga}),Ge(0,Ga,"labelStroke",function(){return this.createText(),this._text.stroke},function(Ga){this.createText(),this._text.stroke=Ga}),Ge(0,Ga,"labelBold",function(){return this.createText(),this._text.bold},function(Ga){this.createText(),this._text.bold=Ga}),Ge(0,Ga,"labelFont",function(){return this.createText(),this._text.font},function(Ga){this.createText(),this._text.font=Ga}),Ge(0,Ga,"labelAlign",function(){return this.createText(),this._text.align},function(Ga){this.createText(),this._text.align=Ga}),Ge(0,Ga,"clickHandler",function(){return this._clickHandler},function(Ga){this._clickHandler=Ga}),Ge(0,Ga,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Ga){this._bitmap.sizeGrid=GE.fillArray(GD.defaultSizeGrid,Ga,Number)}),Ge(0,Ga,"width",Gb.prototype._$get_width,function(Ga){Gr.superSet(GH,this,"width",Ga),this._autoSize&&(this._bitmap.width=Ga,this._text&&(this._text.width=Ga))}),Ge(0,Ga,"height",Gb.prototype._$get_height,function(Ga){Gr.superSet(GH,this,"height",Ga),this._autoSize&&(this._bitmap.height=Ga,this._text&&(this._text.height=Ga))}),Ge(0,Ga,"dataSource",Gb.prototype._$get_dataSource,function(Ga){"number"==typeof(this._dataSource=Ga)||"string"==typeof Ga?this.label=Ga+"":Gr.superSet(GH,this,"dataSource",Ga)}),Ge(0,Ga,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(Ga){this._bitmap._offset=Ga?GE.fillArray([1,1],Ga,Number):[]}),Gd(Gc,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),Gc}(GH),GL=function(Gb){function Gd(Ga,Gb,Gc){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,Gd.__super.call(this),void 0===Gb&&(Gb=1),void 0===Gc&&(Gc=1),this._clipX=Gb,this._clipY=Gc,this.skin=Ga}Gf(Gd,"laya.ui.Clip",Gb);var Ga=Gd.prototype;return Ga.destroy=function(Ga){Gu.clearCache(this,this._skin),Gu.clearObject(this,this._weakKey),void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},Ga.dispose=function(){this.destroy(!0),Gr.loader.clearRes(this._skin)},Ga.createChildren=function(){this.graphics=this._bitmap=new GG},Ga._onDisplay=function(Ga){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},Ga.changeClip=function(){if(this._clipChanged=!1,this._skin){var Ga=Gu.getRes(this._skin);Ga?this.loadComplete(this._skin,Ga):Gr.loader.load(this._skin,Go.create(this,this.loadComplete,[this._skin]))}},Ga.loadComplete=function(Ga,Gb){if(Ga===this._skin&&Gb){Gu.clearObject(this,this._weakKey);var Gc=this._clipWidth||Math.ceil(Gb.sourceWidth/this._clipX),Gd=this._clipHeight||Math.ceil(Gb.sourceHeight/this._clipY),Ge=this._skin+Gc+Gd,Gf=Gu.findObject(Ge);if(GA.isOkTextureList(Gf)||(Gf=null),Gf)this._weakKey=Ge,Gu.keepObject(this,this._weakKey),this._sources=Gf;else{this._sources=[];for(var Gg=0;Gg<this._clipY;Gg++)for(var Gh=0;Gh<this._clipX;Gh++){var Gi=Gy.createFromTexture(Gb,Gc*Gh,Gd*Gg,Gc,Gd);if(Gb.alphaTexture){var Gj=Gb.width/Gb.alphaTexture.width;Gi.alphaTexture=Gy.createFromTexture(Gb.alphaTexture,Gc*Gh/Gj,Gd*Gg/Gj,Gc/Gj,Gd/Gj)}this._sources.push(Gi)}Gu.saveObject(Ge,this._sources),this._weakKey=Ge,Gu.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},Ga.play=function(Ga,Gb){void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=-1),this._isPlaying=!0,this.index=Ga,this._toIndex=Gb,this._index++,Gr.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},Ga._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},Ga.stop=function(){this._isPlaying=!1,Gr.timer.clear(this,this._loop),this.event("complete")},Ga._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},Ge(0,Ga,"interval",function(){return this._interval},function(Ga){this._interval!=Ga&&(this._interval=Ga,this._isPlaying&&this.play())}),Ge(0,Ga,"skin",function(){return this._skin},function(Ga){this._skin!=Ga&&(Gu.clearCache(this,this._skin),(this._skin=Ga)?(Gu.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),Ge(0,Ga,"sources",function(){return this._sources},function(Ga){this._sources=Ga,this.index=this._index,this.event("loaded")}),Ge(0,Ga,"clipX",function(){return this._clipX},function(Ga){this._clipX=Ga||1,this._setClipChanged()}),Ge(0,Ga,"clipY",function(){return this._clipY},function(Ga){this._clipY=Ga||1,this._setClipChanged()}),Ge(0,Ga,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),Ge(0,Ga,"clipWidth",function(){return this._clipWidth},function(Ga){this._clipWidth=Ga,this._setClipChanged()}),Ge(0,Ga,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Ga){this._bitmap.sizeGrid=GE.fillArray(GD.defaultSizeGrid,Ga,Number)}),Ge(0,Ga,"group",function(){return this._group},function(Ga){Ga&&this._skin&&Gu.setGroup(this._skin,Ga),this._group=Ga}),Ge(0,Ga,"clipHeight",function(){return this._clipHeight},function(Ga){this._clipHeight=Ga,this._setClipChanged()}),Ge(0,Ga,"width",Gb.prototype._$get_width,function(Ga){Gr.superSet(GH,this,"width",Ga),this._bitmap.width=Ga}),Ge(0,Ga,"height",Gb.prototype._$get_height,function(Ga){Gr.superSet(GH,this,"height",Ga),this._bitmap.height=Ga}),Ge(0,Ga,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),Ge(0,Ga,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),Ge(0,Ga,"index",function(){return this._index},function(Ga){this._index=Ga,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[Ga]),this.event("change")}),Ge(0,Ga,"autoPlay",function(){return this._autoPlay},function(Ga){this._autoPlay!=Ga&&((this._autoPlay=Ga)?this.play():this.stop())}),Ge(0,Ga,"isPlaying",function(){return this._isPlaying},function(Ga){this._isPlaying=Ga}),Ge(0,Ga,"dataSource",Gb.prototype._$get_dataSource,function(Ga){"number"==typeof(this._dataSource=Ga)&&Math.floor(Ga)==Ga||"string"==typeof Ga?this.index=parseInt(Ga):Gr.superSet(GH,this,"dataSource",Ga)}),Ge(0,Ga,"bitmap",function(){return this._bitmap}),Gd}(GH),GM=function(Gb){function Ga(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,Ga.__super.call(this)}Gf(Ga,"laya.ui.ColorPicker",Gb);var Gc=Ga.prototype;return Gc.destroy=function(Ga){void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,Ga),this._colorPanel&&this._colorPanel.destroy(Ga),this._colorButton&&this._colorButton.destroy(Ga),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},Gc.createChildren=function(){this.addChild(this._colorButton=new GK),this._colorPanel=new GJ,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new Gw),this._colorPanel.addChild(this._colorBlock=new Gw),this._colorPanel.addChild(this._colorInput=new Gp)},Gc.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},Gc.onPanelMouseDown=function(Ga){Ga.stopPropagation()},Gc.changePanel=function(){this._panelChanged=!1;var Ga=this._colorPanel.graphics;Ga.clear(),Ga.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(Ga=this._colorTiles.graphics).clear();for(var Gb=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],Gc=0;Gc<12;Gc++)for(var Gd=0;Gd<20;Gd++){var Ge=0;Ge=0===Gd?Gb[Gc]:1===Gd?0:51*(((3*Gc+Gd/6)%3<<0)+3*(Gc/6<<0))<<16|Gd%6*51<<8|(Gc<<0)%6*51;var Gf=GE.toColor(Ge);this._colors.push(Gf);var Gg=Gd*this._gridSize,Gh=Gc*this._gridSize;Ga.drawRect(Gg,Gh,this._gridSize,this._gridSize,Gf,"#000000")}},Gc.onColorButtonClick=function(Ga){this._colorPanel.parent?this.close():this.open()},Gc.open=function(){var Ga=this.localToGlobal(new Gq),Gb=Ga.x+this._colorPanel.width<=Gr.stage.width?Ga.x:Gr.stage.width-this._colorPanel.width,Gc=Ga.y+this._colorButton.height;Gc=Gc+this._colorPanel.height<=Gr.stage.height?Gc:Ga.y-this._colorPanel.height,this._colorPanel.pos(Gb,Gc),this._colorPanel.zOrder=1001,Gr._currentStage.addChild(this._colorPanel),Gr.stage.on("mousedown",this,this.removeColorBox)},Gc.close=function(){Gr.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},Gc.removeColorBox=function(Ga){this.close()},Gc.onColorFieldKeyDown=function(Ga){13==Ga.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),Ga.stopPropagation())},Gc.onColorInputChange=function(Ga){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},Gc.onColorTilesClick=function(Ga){this.selectedColor=this.getColorByMouse(),this.close()},Gc.onColorTilesMouseMove=function(Ga){this._colorInput.focus=!1;var Gb=this.getColorByMouse();this._colorInput.text=Gb,this.drawBlock(Gb)},Gc.getColorByMouse=function(){var Ga=this._colorTiles.getMousePoint(),Gb=Math.floor(Ga.x/this._gridSize),Gc=Math.floor(Ga.y/this._gridSize);return this._colors[20*Gc+Gb]},Gc.drawBlock=function(Ga){var Gb=this._colorBlock.graphics;Gb.clear();var Gc=Ga||"#ffffff";Gb.drawRect(0,0,50,20,Gc,this._borderColor),Ga||Gb.drawLine(0,0,50,20,"#ff0000")},Gc.changeColor=function(){var Ga=this.graphics;Ga.clear();var Gb=this._selectedColor||"#000000";Ga.drawRect(0,0,this._colorButton.width,this._colorButton.height,Gb)},Gc._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},Ge(0,Gc,"inputBgColor",function(){return this._inputBgColor},function(Ga){this._inputBgColor=Ga,this._setPanelChanged()}),Ge(0,Gc,"selectedColor",function(){return this._selectedColor},function(Ga){this._selectedColor!=Ga&&(this._selectedColor=this._colorInput.text=Ga,this.drawBlock(Ga),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",Gi.EMPTY.setTo("change",this,this)))}),Ge(0,Gc,"skin",function(){return this._colorButton.skin},function(Ga){this._colorButton.skin=Ga,this.changeColor()}),Ge(0,Gc,"bgColor",function(){return this._bgColor},function(Ga){this._bgColor=Ga,this._setPanelChanged()}),Ge(0,Gc,"borderColor",function(){return this._borderColor},function(Ga){this._borderColor=Ga,this._setPanelChanged()}),Ge(0,Gc,"inputColor",function(){return this._inputColor},function(Ga){this._inputColor=Ga,this._setPanelChanged()}),Ga}(GH),GN=function(Gb){function Gc(Ga,Gb){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,Gc.__super.call(this),this._itemColors=GD.comboBoxItemColors,this.skin=Ga,this.labels=Gb}Gf(Gc,"laya.ui.ComboBox",Gb);var Ga=Gc.prototype;return Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,Ga),this._button&&this._button.destroy(Ga),this._list&&this._list.destroy(Ga),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},Ga.createChildren=function(){this.addChild(this._button=new GK),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},Ga._createList=function(){this._list=new GX,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},Ga._setListEvent=function(Ga){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=Go.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},Ga.onListDown=function(Ga){Ga.stopPropagation()},Ga.onScrollBarDown=function(Ga){Ga.stopPropagation()},Ga.onButtonMouseDown=function(Ga){this.callLater(this.switchTo,[!this._isOpen])},Ga.changeList=function(){this._listChanged=!1;var Ga=this.width-2,Gb=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:Ga,height:this._itemHeight,fontSize:this._itemSize,color:Gb}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},Ga.onlistItemMouse=function(Ga,Gb){var Gc=Ga.type;if("mouseover"===Gc||"mouseout"===Gc){if(this._isCustomList)return;var Gd=this._list.getCell(Gb);if(!Gd)return;var Ge=Gd.getChildByName("label");Ge&&("mouseover"===Gc?(Ge.bgColor=this._itemColors[0],Ge.color=this._itemColors[1]):(Ge.bgColor=null,Ge.color=this._itemColors[2]))}else"click"===Gc&&(this.selectedIndex=Gb,this.isOpen=!1)},Ga.switchTo=function(Ga){this.isOpen=Ga},Ga.changeOpen=function(){this.isOpen=!this._isOpen},Ga.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var Ga=this._list.graphics;Ga.clear(),Ga.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var Gb=this._list.array||[],Gc=Gb.length=0,Gd=this._labels.length;Gc<Gd;Gc++)Gb.push({label:this._labels[Gc]});this._list.height=this._listHeight,this._list.array=Gb},Ga.changeSelected=function(){this._button.label=this.selectedLabel},Ga._onStageMouseWheel=function(Ga){this._list&&!this._list.contains(Ga.target)&&this.removeList(null)},Ga.removeList=function(Ga){Gr.stage.off("mousedown",this,this.removeList),Gr.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},Ge(0,Ga,"selectedIndex",function(){return this._selectedIndex},function(Ga){this._selectedIndex!=Ga&&(this._selectedIndex=Ga,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[Gi.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),Ge(0,Ga,"measureHeight",function(){return this._button.height}),Ge(0,Ga,"skin",function(){return this._button.skin},function(Ga){this._button.skin!=Ga&&(this._button.skin=Ga,this._listChanged=!0)}),Ge(0,Ga,"measureWidth",function(){return this._button.width}),Ge(0,Ga,"width",Gb.prototype._$get_width,function(Ga){Gr.superSet(GH,this,"width",Ga),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),Ge(0,Ga,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(Ga){this.selectedIndex=this._labels.indexOf(Ga)}),Ge(0,Ga,"labels",function(){return this._labels.join(",")},function(Ga){0<this._labels.length&&(this.selectedIndex=-1),Ga?this._labels=Ga.split(","):this._labels.length=0,this._itemChanged=!0}),Ge(0,Ga,"height",Gb.prototype._$get_height,function(Ga){Gr.superSet(GH,this,"height",Ga),this._button.height=this._height}),Ge(0,Ga,"selectHandler",function(){return this._selectHandler},function(Ga){this._selectHandler=Ga}),Ge(0,Ga,"visibleNum",function(){return this._visibleNum},function(Ga){this._visibleNum=Ga,this._listChanged=!0}),Ge(0,Ga,"labelBold",function(){return this._button.text.bold},function(Ga){this._button.text.bold=Ga}),Ge(0,Ga,"itemColors",function(){return String(this._itemColors)},function(Ga){this._itemColors=GE.fillArray(this._itemColors,Ga,String),this._listChanged=!0}),Ge(0,Ga,"itemSize",function(){return this._itemSize},function(Ga){this._itemSize=Ga,this._listChanged=!0}),Ge(0,Ga,"scrollBar",function(){return this.list.scrollBar}),Ge(0,Ga,"isOpen",function(){return this._isOpen},function(Ga){if(this._isOpen!=Ga)if(this._isOpen=Ga,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var Gb=this.localToGlobal(Gq.TEMP.setTo(0,0)),Gc=Gb.y+this._button.height;Gc=Gc+this._listHeight<=Gr.stage.height?Gc:Gb.y-this._listHeight,this._list.pos(Gb.x,Gc),this._list.zOrder=1001,Gr._currentStage.addChild(this._list),Gr.stage.once("mousedown",this,this.removeList),Gr.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),Ge(0,Ga,"scrollBarSkin",function(){return this._scrollBarSkin},function(Ga){this._scrollBarSkin=Ga}),Ge(0,Ga,"sizeGrid",function(){return this._button.sizeGrid},function(Ga){this._button.sizeGrid=Ga}),Ge(0,Ga,"button",function(){return this._button}),Ge(0,Ga,"list",function(){return this._list||this._createList(),this._list},function(Ga){Ga&&(Ga.removeSelf(),this._isCustomList=!0,this._list=Ga,this._setListEvent(Ga),this._itemHeight=Ga.getCell(0).height+Ga.spaceY)}),Ge(0,Ga,"dataSource",Gb.prototype._$get_dataSource,function(Ga){"number"==typeof(this._dataSource=Ga)&&Math.floor(Ga)==Ga||"string"==typeof Ga?this.selectedIndex=parseInt(Ga):Ga instanceof Array?this.labels=Ga.join(","):Gr.superSet(GH,this,"dataSource",Ga)}),Ge(0,Ga,"labelColors",function(){return this._button.labelColors},function(Ga){this._button.labelColors!=Ga&&(this._button.labelColors=Ga)}),Ge(0,Ga,"labelPadding",function(){return this._button.text.padding.join(",")},function(Ga){this._button.text.padding=GE.fillArray(GD.labelPadding,Ga,Number)}),Ge(0,Ga,"labelSize",function(){return this._button.text.fontSize},function(Ga){this._button.text.fontSize=Ga}),Ge(0,Ga,"labelFont",function(){return this._button.text.font},function(Ga){this._button.text.font=Ga}),Ge(0,Ga,"stateNum",function(){return this._button.stateNum},function(Ga){this._button.stateNum=Ga}),Gc}(GH),GO=function(Gb){function Gc(Ga){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,Gc.__super.call(this),this._showButtons=GF.showButtons,this._touchScrollEnable=GF.touchScrollEnable,this._mouseWheelEnable=GF.mouseWheelEnable,this.skin=Ga,this.max=1}Gf(Gc,"laya.ui.ScrollBar",Gb);var Ga=Gc.prototype;return Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),this.stopScroll(),this.target=null,Gb.prototype.destroy.call(this,Ga),this.upButton&&this.upButton.destroy(Ga),this.downButton&&this.downButton.destroy(Ga),this.slider&&this.slider.destroy(Ga),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},Ga.createChildren=function(){this.addChild(this.slider=new GP),this.addChild(this.upButton=new GK),this.addChild(this.downButton=new GK)},Ga.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},Ga.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},Ga.onButtonMouseDown=function(Ga){var Gb=Ga.currentTarget===this.upButton;this.slide(Gb),Gr.timer.once(GD.scrollBarDelayTime,this,this.startLoop,[Gb]),Gr.stage.once("mouseup",this,this.onStageMouseUp)},Ga.startLoop=function(Ga){Gr.timer.frameLoop(1,this,this.slide,[Ga])},Ga.slide=function(Ga){Ga?this.value-=this._scrollSize:this.value+=this._scrollSize},Ga.onStageMouseUp=function(Ga){Gr.timer.clear(this,this.startLoop),Gr.timer.clear(this,this.slide)},Ga.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},Ga.changeSize=function(){Gb.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},Ga.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},Ga.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},Ga.setScroll=function(Ga,Gb,Gc){this.runCallLater(this.changeSize),this.slider.setSlider(Ga,Gb,Gc),this.slider.bar.visible=0<Gb,!this._hide&&this.autoHide&&(this.visible=!1)},Ga.onTargetMouseWheel=function(Ga){this.value-=Ga.delta*this._scrollSize,this.target=this._target},Ga.onTargetMouseDown=function(Ga){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new Gq),this._lastPoint.setTo(Gr.stage.mouseX,Gr.stage.mouseY),Gr.timer.clear(this,this.tweenMove),Gz.clearTween(this),Gr.stage.once("mouseup",this,this.onStageMouseUp2),Gr.stage.once("mouseout",this,this.onStageMouseUp2),Gr.timer.frameLoop(1,this,this.loop)},Ga.loop=function(){var Ga=Gr.stage.mouseY,Gb=Gr.stage.mouseX;if(this._lastOffset=this.isVertical?Ga-this._lastPoint.y:Gb-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?Gr.stage._canvasTransform.getScaleY():Gr.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=Gb,this._lastPoint.y=Ga,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},Ga.onStageMouseUp2=function(Ga){if(Gr.stage.off("mouseup",this,this.onStageMouseUp2),Gr.stage.off("mouseout",this,this.onStageMouseUp2),Gr.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?Gz.to(this,{value:this.min},this.elasticBackTime,Gh.sineOut,Go.create(this,this.elasticOver)):this._value>this.max&&Gz.to(this,{value:this.max},this.elasticBackTime,Gh.sineOut,Go.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?Gr.stage.mouseY-this._lastPoint.y:Gr.stage.mouseX-this._lastPoint.x);for(var Gb=0,Gc=Math.min(this._offsets.length,3),Gd=0;Gd<Gc;Gd++)Gb+=this._offsets[this._offsets.length-1-Gd];if(this._lastOffset=Gb/Gc,(Gb=Math.abs(this._lastOffset))<2)return void this.event("end");60<Gb&&(this._lastOffset=0<this._lastOffset?60:-60);var Ge=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));Gr.timer.frameLoop(1,this,this.tweenMove,[Ge])}},Ga.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&Gz.to(this,{alpha:0},500),this.event("end")},Ga.tweenMove=function(Ga){this._lastOffset*=this.rollRatio;var Gb=NaN;if(0<Ga&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,Gb=.5*-(this.min-Ga-this.value),this._lastOffset>Gb&&(this._lastOffset=Gb)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,Gb=.5*-(this.max+Ga-this.value),this._lastOffset<Gb&&(this._lastOffset=Gb))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(Gr.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?Gz.to(this,{value:this.min},this.elasticBackTime,Gh.sineOut,Go.create(this,this.elasticOver)):this._value>this.max?Gz.to(this,{value:this.max},this.elasticBackTime,Gh.sineOut,Go.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&Gz.to(this,{alpha:0},500)}},Ga.stopScroll=function(){this.onStageMouseUp2(null),Gr.timer.clear(this,this.tweenMove),Gz.clearTween(this)},Ge(0,Ga,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),Ge(0,Ga,"skin",function(){return this._skin},function(Ga){this._skin!=Ga&&(this._skin=Ga,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),Ge(0,Ga,"max",function(){return this.slider.max},function(Ga){this.slider.max=Ga}),Ge(0,Ga,"showButtons",function(){return this._showButtons},function(Ga){this._showButtons=Ga,this.callLater(this.changeScrollBar)}),Ge(0,Ga,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),Ge(0,Ga,"min",function(){return this.slider.min},function(Ga){this.slider.min=Ga}),Ge(0,Ga,"value",function(){return this._value},function(Ga){Ga!==this._value&&(this._value=Ga,this._isElastic||(this.slider._value!=Ga&&(this.slider._value=Ga,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),Ge(0,Ga,"isVertical",function(){return this.slider.isVertical},function(Ga){this.slider.isVertical=Ga}),Ge(0,Ga,"sizeGrid",function(){return this.slider.sizeGrid},function(Ga){this.slider.sizeGrid=Ga}),Ge(0,Ga,"scrollSize",function(){return this._scrollSize},function(Ga){this._scrollSize=Ga}),Ge(0,Ga,"dataSource",Gb.prototype._$get_dataSource,function(Ga){"number"==typeof(this._dataSource=Ga)||"string"==typeof Ga?this.value=Number(Ga):Gr.superSet(GH,this,"dataSource",Ga)}),Ge(0,Ga,"thumbPercent",function(){return this._thumbPercent},function(Ga){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),Ga=1<=Ga?.99:Ga,this._thumbPercent=Ga,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*Ga,GD.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*Ga,GD.scrollBarMinNum))}),Ge(0,Ga,"target",function(){return this._target},function(Ga){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=Ga)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),Ge(0,Ga,"hide",function(){return this._hide},function(Ga){this._hide=Ga,this.visible=!Ga}),Ge(0,Ga,"touchScrollEnable",function(){return this._touchScrollEnable},function(Ga){this._touchScrollEnable=Ga,this.target=this._target}),Ge(0,Ga,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(Ga){this._mouseWheelEnable=Ga,this.target=this._target}),Ge(0,Ga,"tick",function(){return this.slider.tick},function(Ga){this.slider.tick=Ga}),Gc}(GH),GP=function(Gb){function Gc(Ga){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,Gc.__super.call(this),this.skin=Ga}Gf(Gc,"laya.ui.Slider",Gb);var Ga=Gc.prototype;return Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,Ga),this._bg&&this._bg.destroy(Ga),this._bar&&this._bar.destroy(Ga),this._progress&&this._progress.destroy(Ga),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},Ga.createChildren=function(){this.addChild(this._bg=new GQ),this.addChild(this._bar=new GK)},Ga.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},Ga.onBarMouseDown=function(Ga){this._globalSacle||(this._globalSacle=new Gq),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=Gr.stage.mouseX,this._ty=Gr.stage.mouseY,Gr.stage.on("mousemove",this,this.mouseMove),Gr.stage.once("mouseup",this,this.mouseUp),Gr.stage.once("mouseout",this,this.mouseUp),this.showValueText()},Ga.showValueText=function(){if(this.showLabel){var Ga=laya.ui.Slider.label;this.addChild(Ga),Ga.textField.changeText(this._value+""),this.isVertical?(Ga.x=this._bar.x+20,Ga.y=.5*(this._bar.height-Ga.height)+this._bar.y):(Ga.y=this._bar.y-20,Ga.x=.5*(this._bar.width-Ga.width)+this._bar.x)}},Ga.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},Ga.mouseUp=function(Ga){Gr.stage.off("mousemove",this,this.mouseMove),Gr.stage.off("mouseup",this,this.mouseUp),Gr.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},Ga.mouseMove=function(Ga){var Gb=this._value;this.isVertical?(this._bar.y+=(Gr.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(Gr.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=Gr.stage.mouseX,this._ty=Gr.stage.mouseY;var Gc=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*Gc)/Gc,this._value!=Gb&&this.sendChangeEvent(),this.showValueText()},Ga.sendChangeEvent=function(Ga){void 0===Ga&&(Ga="change"),this.event(Ga),this.changeHandler&&this.changeHandler.runWith(this._value)},Ga.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},Ga.changeSize=function(){Gb.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},Ga.setSlider=function(Ga,Gb,Gc){this._value=-1,this._min=Ga,this._max=Ga<Gb?Gb:Ga,this.value=Gc<Ga?Ga:Gb<Gc?Gb:Gc},Ga.changeValue=function(){var Ga=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*Ga)/Ga,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var Gb=this._max-this._min;0===Gb&&(Gb=1),this.isVertical?(this._bar.y=(this._value-this._min)/Gb*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/Gb*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},Ga.onBgMouseDown=function(Ga){var Gb=this._bg.getMousePoint();this.isVertical?this.value=Gb.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=Gb.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},Ge(0,Ga,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),Ge(0,Ga,"skin",function(){return this._skin},function(Ga){if(this._skin!=Ga){this._skin=Ga,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var Gb=this._skin.replace(".png","$progress.png");Gu.getRes(Gb)&&(this._progress||(this.addChild(this._progress=new GQ),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=Gb),this.setBarPoint(),this.callLater(this.changeValue)}}),Ge(0,Ga,"allowClickBack",function(){return this._allowClickBack},function(Ga){this._allowClickBack!=Ga&&((this._allowClickBack=Ga)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),Ge(0,Ga,"max",function(){return this._max},function(Ga){this._max!=Ga&&(this._max=Ga,this.callLater(this.changeValue))}),Ge(0,Ga,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),Ge(0,Ga,"tick",function(){return this._tick},function(Ga){this._tick!=Ga&&(this._tick=Ga,this.callLater(this.changeValue))}),Ge(0,Ga,"sizeGrid",function(){return this._bg.sizeGrid},function(Ga){this._bg.sizeGrid=Ga,this._bar.sizeGrid=Ga,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),Ge(0,Ga,"min",function(){return this._min},function(Ga){this._min!=Ga&&(this._min=Ga,this.callLater(this.changeValue))}),Ge(0,Ga,"value",function(){return this._value},function(Ga){if(this._value!=Ga){var Gb=this._value;this._value=Ga,this.changeValue(),this._value!=Gb&&this.sendChangeEvent()}}),Ge(0,Ga,"dataSource",Gb.prototype._$get_dataSource,function(Ga){"number"==typeof(this._dataSource=Ga)||"string"==typeof Ga?this.value=Number(Ga):Gr.superSet(GH,this,"dataSource",Ga)}),Ge(0,Ga,"bar",function(){return this._bar}),Gd(Gc,["label",function(){return this.label=new GR}]),Gc}(GH),GQ=function(Gb){function Gc(Ga){this._bitmap=null,this._skin=null,this._group=null,Gc.__super.call(this),this.skin=Ga}Gf(Gc,"laya.ui.Image",Gb);var Ga=Gc.prototype;return Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,Gu.clearCache(this,this._skin)},Ga.dispose=function(){this.destroy(!0),Gu.clearCache(this,this._skin)},Ga.createChildren=function(){this.graphics=this._bitmap=new GG},Ga.setSource=function(Ga,Gb){Ga===this._skin&&Gb&&(this.source=Gb,this.onCompResize())},Ge(0,Ga,"source",function(){return this._bitmap.source},function(Ga){this._bitmap&&(this._bitmap.source=Ga,this.event("loaded"),this.repaint())}),Ge(0,Ga,"dataSource",Gb.prototype._$get_dataSource,function(Ga){"string"==typeof(this._dataSource=Ga)?this.skin=Ga:Gr.superSet(GH,this,"dataSource",Ga)}),Ge(0,Ga,"measureHeight",function(){return this._bitmap.height}),Ge(0,Ga,"skin",function(){return this._skin},function(Ga){if(this._skin!=Ga)if(Gu.clearCache(this,this._skin),this._skin=Ga){Gu.keepCache(this,this._skin);var Gb=Gu.getRes(Ga);Gb?(this.source=Gb,this.onCompResize()):Gr.loader.load(this._skin,Go.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),Ge(0,Ga,"group",function(){return this._group},function(Ga){Ga&&this._skin&&Gu.setGroup(this._skin,Ga),this._group=Ga}),Ge(0,Ga,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(Ga){this._bitmap.sizeGrid=GE.fillArray(GD.defaultSizeGrid,Ga,Number)}),Ge(0,Ga,"measureWidth",function(){return this._bitmap.width}),Ge(0,Ga,"width",Gb.prototype._$get_width,function(Ga){Gr.superSet(GH,this,"width",Ga),this._bitmap.width=0==Ga?1e-7:Ga}),Ge(0,Ga,"height",Gb.prototype._$get_height,function(Ga){Gr.superSet(GH,this,"height",Ga),this._bitmap.height=0==Ga?1e-7:Ga}),Gc}(GH),GR=function(Gb){function Gc(Ga){this._tf=null,Gc.__super.call(this),void 0===Ga&&(Ga=""),Gj.defaultColor=GD.labelColor,this.text=Ga}Gf(Gc,"laya.ui.Label",Gb);var Ga=Gc.prototype;return Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,Ga),this._tf=null},Ga.createChildren=function(){this.addChild(this._tf=new Gx)},Ga.changeText=function(Ga){this._tf.changeText(Ga)},Ge(0,Ga,"padding",function(){return this._tf.padding.join(",")},function(Ga){this._tf.padding=GE.fillArray(GD.labelPadding,Ga,Number)}),Ge(0,Ga,"bold",function(){return this._tf.bold},function(Ga){this._tf.bold=Ga}),Ge(0,Ga,"align",function(){return this._tf.align},function(Ga){this._tf.align=Ga}),Ge(0,Ga,"text",function(){return this._tf.text},function(Ga){this._tf.text!=Ga&&(Ga&&(Ga=GE.adptString(Ga+"")),this._tf.text=Ga,this.event("change"),this._width&&this._height||this.onCompResize())}),Ge(0,Ga,"italic",function(){return this._tf.italic},function(Ga){this._tf.italic=Ga}),Ge(0,Ga,"wordWrap",function(){return this._tf.wordWrap},function(Ga){this._tf.wordWrap=Ga}),Ge(0,Ga,"font",function(){return this._tf.font},function(Ga){this._tf.font=Ga}),Ge(0,Ga,"dataSource",Gb.prototype._$get_dataSource,function(Ga){"number"==typeof(this._dataSource=Ga)||"string"==typeof Ga?this.text=Ga+"":Gr.superSet(GH,this,"dataSource",Ga)}),Ge(0,Ga,"color",function(){return this._tf.color},function(Ga){this._tf.color=Ga}),Ge(0,Ga,"valign",function(){return this._tf.valign},function(Ga){this._tf.valign=Ga}),Ge(0,Ga,"leading",function(){return this._tf.leading},function(Ga){this._tf.leading=Ga}),Ge(0,Ga,"fontSize",function(){return this._tf.fontSize},function(Ga){this._tf.fontSize=Ga}),Ge(0,Ga,"bgColor",function(){return this._tf.bgColor},function(Ga){this._tf.bgColor=Ga}),Ge(0,Ga,"borderColor",function(){return this._tf.borderColor},function(Ga){this._tf.borderColor=Ga}),Ge(0,Ga,"stroke",function(){return this._tf.stroke},function(Ga){this._tf.stroke=Ga}),Ge(0,Ga,"strokeColor",function(){return this._tf.strokeColor},function(Ga){this._tf.strokeColor=Ga}),Ge(0,Ga,"textField",function(){return this._tf}),Ge(0,Ga,"measureWidth",function(){return this._tf.width}),Ge(0,Ga,"measureHeight",function(){return this._tf.height}),Ge(0,Ga,"width",function(){return this._width||this._tf.text?Gr.superGet(GH,this,"width"):0},function(Ga){Gr.superSet(GH,this,"width",Ga),this._tf.width=Ga}),Ge(0,Ga,"height",function(){return this._height||this._tf.text?Gr.superGet(GH,this,"height"):0},function(Ga){Gr.superSet(GH,this,"height",Ga),this._tf.height=Ga}),Ge(0,Ga,"overflow",function(){return this._tf.overflow},function(Ga){this._tf.overflow=Ga}),Ge(0,Ga,"underline",function(){return this._tf.underline},function(Ga){this._tf.underline=Ga}),Ge(0,Ga,"underlineColor",function(){return this._tf.underlineColor},function(Ga){this._tf.underlineColor=Ga}),Gc}(GH),GS=function(Gb){function Gc(Ga){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,Gc.__super.call(this),this.skin=Ga}Gf(Gc,"laya.ui.ProgressBar",Gb);var Ga=Gc.prototype;return Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,Ga),this._bg&&this._bg.destroy(Ga),this._bar&&this._bar.destroy(Ga),this._bg=this._bar=null,this.changeHandler=null},Ga.createChildren=function(){this.addChild(this._bg=new GQ),this.addChild(this._bar=new GQ)},Ga.changeValue=function(){if(this.sizeGrid){var Ga=this.sizeGrid.split(","),Gb=Number(Ga[3]),Gc=Number(Ga[1]),Gd=(this.width-Gb-Gc)*this._value;this._bar.width=Gb+Gc+Gd,this._bar.visible=this._bar.width>Gb+Gc}else this._bar.width=this.width*this._value},Ge(0,Ga,"measureHeight",function(){return this._bg.height}),Ge(0,Ga,"skin",function(){return this._skin},function(Ga){this._skin!=Ga&&(this._skin=Ga,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),Ge(0,Ga,"measureWidth",function(){return this._bg.width}),Ge(0,Ga,"height",Gb.prototype._$get_height,function(Ga){Gr.superSet(GH,this,"height",Ga),this._bg.height=this._height,this._bar.height=this._height}),Ge(0,Ga,"bar",function(){return this._bar}),Ge(0,Ga,"value",function(){return this._value},function(Ga){this._value!=Ga&&(Ga=1<Ga?1:Ga<0?0:Ga,this._value=Ga,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(Ga))}),Ge(0,Ga,"bg",function(){return this._bg}),Ge(0,Ga,"sizeGrid",function(){return this._bg.sizeGrid},function(Ga){this._bg.sizeGrid=this._bar.sizeGrid=Ga}),Ge(0,Ga,"width",Gb.prototype._$get_width,function(Ga){Gr.superSet(GH,this,"width",Ga),this._bg.width=this._width,this.callLater(this.changeValue)}),Ge(0,Ga,"dataSource",Gb.prototype._$get_dataSource,function(Ga){"number"==typeof(this._dataSource=Ga)||"string"==typeof Ga?this.value=Number(Ga):Gr.superSet(GH,this,"dataSource",Ga)}),Gc}(GH),GT=(function(Ga){function Gc(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,Gc.__super.call(this),this._tipBox=new GH,this._tipBox.addChild(this._tipText=new Gx),this._tipText.x=this._tipText.y=5,this._tipText.color=Gc.tipTextColor,this._defaultTipHandler=this._showDefaultTip,Gr.stage.on("showtip",this,this._onStageShowTip),Gr.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}Gf(Gc,"laya.ui.TipManager",GH);var Gb=Gc.prototype;Gb._onStageHideTip=function(Ga){Gr.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},Gb._onStageShowTip=function(Ga){Gr.timer.once(Gc.tipDelay,this,this._showTip,[Ga],!0)},Gb._showTip=function(Ga){if("string"==typeof Ga){var Gb=String(Ga);Boolean(Gb)&&this._defaultTipHandler(Gb)}else Ga instanceof laya.utils.Handler?Ga.run():"function"==typeof Ga&&Ga.apply();Gr.stage.on("mousemove",this,this._onStageMouseMove),Gr.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},Gb._onStageMouseDown=function(Ga){this.closeAll()},Gb._onStageMouseMove=function(Ga){this._showToStage(this,Gc.offsetX,Gc.offsetY)},Gb._showToStage=function(Ga,Gb,Gc){void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0);var Gd=Ga.getBounds();Ga.x=Gr.stage.mouseX+Gb,Ga.y=Gr.stage.mouseY+Gc,Ga.x+Gd.width>Gr.stage.width&&(Ga.x-=Gd.width+Gb),Ga.y+Gd.height>Gr.stage.height&&(Ga.y-=Gd.height+Gc)},Gb.closeAll=function(){Gr.timer.clear(this,this._showTip),Gr.stage.off("mousemove",this,this._onStageMouseMove),Gr.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},Gb.showDislayTip=function(Ga){this.addChild(Ga),this._showToStage(this),Gr._currentStage.addChild(this)},Gb._showDefaultTip=function(Ga){this._tipText.text=Ga;var Gb=this._tipBox.graphics;Gb.clear(),Gb.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,Gc.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),Gr._currentStage.addChild(this)},Ge(0,Gb,"defaultTipHandler",function(){return this._defaultTipHandler},function(Ga){this._defaultTipHandler=Ga}),Gc.offsetX=10,Gc.offsetY=15,Gc.tipTextColor="#ffffff",Gc.tipBackColor="#111111",Gc.tipDelay=200}(),function(Ga){var Gp;function Gq(){this._idMap=null,this._aniList=null,this._watchMap={},Gq.__super.call(this)}Gf(Gq,"laya.ui.View",GJ);var Gb=Gq.prototype;return Gb.createView=function(Ga){if(Ga.animations&&!this._idMap&&(this._idMap={}),Gq.createComp(Ga,this,this),Ga.animations){var Gb,Gc,Gd=[],Ge=Ga.animations,Gf=0,Gg=Ge.length;for(Gf=0;Gf<Gg;Gf++){switch(Gb=new Gk,Gc=Ge[Gf],Gb._setUp(this._idMap,Gc),(this[Gc.name]=Gb)._setControlNode(this),Gc.action){case 1:Gb.play(0,!1);break;case 2:Gb.play(0,!0)}Gd.push(Gb)}this._aniList=Gd}0<this._width&&null==Ga.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},Gb.onEvent=function(Ga,Gb){},Gb.loadUI=function(Ga){var Gb=Gq.uiMap[Ga];Gb&&this.createView(Gb)},Gb.destroy=function(Ga){void 0===Ga&&(Ga=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,Ga)},Gb.changeData=function(Ga){var Gb=this._watchMap[Ga];if(Gb){console.log("change",Ga);for(var Gc=0,Gd=Gb.length;Gc<Gd;Gc++){Gb[Gc].exe(this)}}},Gq._regs=function(){for(var Ga in Gq.uiClassMap)Gs.regClass(Ga,Gq.uiClassMap[Ga])},Gq.createComp=function(Ga,Gb,Gc,Gd){if(!(Gb=Gb||Gq.getCompInstance(Ga)))return console.warn("can not create:"+Ga.type),null;var Ge=Ga.child;if(Ge)for(var Gf=Gb instanceof laya.ui.List,Gg=0,Gh=Ge.length;Gg<Gh;Gg++){var Gi=Ge[Gg];if(!Gb.hasOwnProperty("itemRender")||"render"!=Gi.props.name&&"render"!==Gi.props.renderType)if("Graphic"==Gi.type)Gs.addGraphicsToSprite(Gi,Gb);else if(Gs.isDrawType(Gi.type))Gs.addGraphicToSprite(Gi,Gb,!0);else{if(Gf){var Gj=[],Gk=Gq.createComp(Gi,null,Gc,Gj);Gj.length&&(Gk._$bindData=Gj)}else Gk=Gq.createComp(Gi,null,Gc,Gd);"Script"==Gi.type?"owner"in Gk?Gk.owner=Gb:"target"in Gk&&(Gk.target=Gb):"mask"==Gi.props.renderType||"mask"==Gi.props.name?Gb.mask=Gk:Gk instanceof laya.display.Sprite&&Gb.addChild(Gk)}else Gb.itemRender=Gi}var Gl=Ga.props;for(var Go in Gl){var Gp=Gl[Go];Gq.eventDic[Go]?Gp&&Gc&&Gb.on(Go,Gc,Gc.onEvent,[Gp]):Gq.setCompValue(Gb,Go,Gp,Gc,Gd)}return Gr.__typeof(Gb,"laya.ui.IItem")&&Gb.initItems(),Ga.compId&&Gc&&Gc._idMap&&(Gc._idMap[Ga.compId]=Gb),Gb},Gq.setCompValue=function(Ga,Gb,Gc,Gd,Ge){if("string"==typeof Gc&&-1<Gc.indexOf("${")){if(Gq._sheet||(Gq._sheet=Gs.getClass("laya.data.Table")),!Gq._sheet)return void console.warn("Can not find class Sheet");if(Ge)Ge.push(Ga,Gb,Gc);else if(Gd){-1==Gc.indexOf("].")&&(Gc=Gc.replace(".","[0]."));var Gf,Gg,Gh=new Gp(Ga,Gb,Gc);Gh.exe(Gd);for(var Gi=Gc.replace(/\[.*?\]\./g,".");null!=(Gf=Gq._parseWatchData.exec(Gi));){for(var Gj=Gf[1];null!=(Gg=Gq._parseKeyWord.exec(Gj));){var Gk=Gg[0],Gl=Gd._watchMap[Gk]||(Gd._watchMap[Gk]=[]);Gl.push(Gh),Gq._sheet.I.notifer.on(Gk,Gd,Gd.changeData,[Gk])}(Gl=Gd._watchMap[Gj]||(Gd._watchMap[Gj]=[])).push(Gh),Gq._sheet.I.notifer.on(Gj,Gd,Gd.changeData,[Gj])}}}else if("var"===Gb&&Gd)Gd[Gc]=Ga;else if("onClick"==Gb){var Go=Gr._runScript("(function(){"+Gc+"})");Ga.on("click",Gd,Go)}else Ga[Gb]="true"===Gc||"false"!==Gc&&Gc},Gq.getCompInstance=function(Ga){var Gb,Gc=Ga.props?Ga.props.runtime:null;return Gb=Gc?Gq.viewClassMap[Gc]||Gq.uiClassMap[Gc]||Gr.__classmap[Gc]:Gq.uiClassMap[Ga.type],Ga.props&&Ga.props.hasOwnProperty("renderType")&&"instance"==Ga.props.renderType?Gb.instance:Gb?new Gb:null},Gq.regComponent=function(Ga,Gb){Gq.uiClassMap[Ga]=Gb,Gs.regClass(Ga,Gb)},Gq.regViewRuntime=function(Ga,Gb){Gq.viewClassMap[Ga]=Gb},Gq.uiMap={},Gq.viewClassMap={},Gq._sheet=null,Gd(Gq,["uiClassMap",function(){return this.uiClassMap={ViewStack:Gaa,LinkButton:GK,TextArea:Gja,ColorPicker:GM,Box:GJ,Button:GK,CheckBox:GU,Clip:GL,ComboBox:GN,Component:GH,HScrollBar:GY,HSlider:G$,Image:GQ,Label:GR,List:GX,Panel:GZ,ProgressBar:GS,Radio:Gm,RadioGroup:Gha,ScrollBar:GO,Slider:GP,Tab:Gia,TextInput:Gca,View:Gq,VScrollBar:Gba,VSlider:Gda,Tree:Gn,HBox:Gfa,VBox:Gga,Sprite:Gw,Animation:Gc,Text:Gx,FontClip:GW}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),Gq.__init$=function(){Gq._regs(),Gp=function(){function Ga(Ga,Gb,Gc){this.comp=null,this.prop=null,this.value=null,this.comp=Ga,this.prop=Gb,this.value=Gc}return Gf(Ga,""),Ga.prototype.exe=function(Ga){var Gb=GE.getBindFun(this.value);this.comp[this.prop]=Gb.call(this,Ga)},Ga}()},Gq}()),GU=function(Ga){function Gc(Ga,Gb){void 0===Gb&&(Gb=""),Gc.__super.call(this,Ga,Gb)}Gf(Gc,"laya.ui.CheckBox",Ga);var Gb=Gc.prototype;return Gb.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},Gb.initialize=function(){Ga.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},Ge(0,Gb,"dataSource",Ga.prototype._$get_dataSource,function(Ga){"boolean"==typeof(this._dataSource=Ga)?this.selected=Ga:"string"==typeof Ga?this.selected="true"===Ga:Gr.superSet(GK,this,"dataSource",Ga)}),Gc}(GK),GV=function(Ga){function Gb(){this._space=0,this._align="none",this._itemChanged=!1,Gb.__super.call(this)}Gf(Gb,"laya.ui.LayoutBox",GJ);var Gc=Gb.prototype;return Gc.addChild=function(Ga){return Ga.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,Ga)},Gc.onResize=function(Ga){this._setItemChanged()},Gc.addChildAt=function(Ga,Gb){return Ga.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,Ga,Gb)},Gc.removeChild=function(Ga){return Ga.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,Ga)},Gc.removeChildAt=function(Ga){return this.getChildAt(Ga).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,Ga)},Gc.refresh=function(){this._setItemChanged()},Gc.changeItems=function(){this._itemChanged=!1},Gc.sortItem=function(Ga){Ga&&Ga.sort(function(Ga,Gb){return Ga.y-Gb.y})},Gc._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},Ge(0,Gc,"space",function(){return this._space},function(Ga){this._space=Ga,this._setItemChanged()}),Ge(0,Gc,"align",function(){return this._align},function(Ga){this._align=Ga,this._setItemChanged()}),Gb}(),GW=function(Gb){function Gc(Ga,Gb){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,Gc.__super.call(this),Ga&&(this.skin=Ga),Gb&&(this.sheet=Gb)}Gf(Gc,"laya.ui.FontClip",Gb);var Ga=Gc.prototype;return Ga.createChildren=function(){this._bitmap=new GG,this.on("loaded",this,this._onClipLoaded)},Ga._onClipLoaded=function(){this.callLater(this.changeValue)},Ga.changeValue=function(){var Ga;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),Ga=this._sources[0]))){var Gb="horizontal"===this._direction;Gb?(this._wordsW=this._valueArr.length*(Ga.sourceWidth+this.spaceX),this._wordsH=Ga.sourceHeight):(this._wordsW=Ga.sourceWidth,this._wordsH=(Ga.sourceHeight+this.spaceY)*this._valueArr.length);var Gc=0;if(this._width)switch(this._align){case"center":Gc=.5*(this._width-this._wordsW);break;case"right":Gc=this._width-this._wordsW;break;default:Gc=0}for(var Gd=0,Ge=this._valueArr.length;Gd<Ge;Gd++){var Gf=this._indexMap[this._valueArr.charAt(Gd)];this.sources[Gf]&&(Ga=this.sources[Gf],Gb?this.graphics.drawTexture(Ga,Gc+Gd*(Ga.sourceWidth+this.spaceX),0,Ga.sourceWidth,Ga.sourceHeight):this.graphics.drawTexture(Ga,0+Gc,Gd*(Ga.sourceHeight+this.spaceY),Ga.sourceWidth,Ga.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),Gb.prototype.destroy.call(this,Ga)},Ge(0,Ga,"sheet",function(){return this._sheet},function(Ga){Ga+="";var Gb=(this._sheet=Ga).split(" ");this._clipX=String(Gb[0]).length,this.clipY=Gb.length,this._indexMap={};for(var Gc=0;Gc<this._clipY;Gc++)for(var Gd=Gb[Gc].split(""),Ge=0,Gf=Gd.length;Ge<Gf;Ge++)this._indexMap[Gd[Ge]]=Gc*this._clipX+Ge}),Ge(0,Ga,"height",Gb.prototype._$get_height,function(Ga){Gr.superSet(GL,this,"height",Ga),this.callLater(this.changeValue)}),Ge(0,Ga,"direction",function(){return this._direction},function(Ga){this._direction=Ga,this.callLater(this.changeValue)}),Ge(0,Ga,"value",function(){return this._valueArr?this._valueArr:""},function(Ga){Ga+="",this._valueArr=Ga,this.callLater(this.changeValue)}),Ge(0,Ga,"width",Gb.prototype._$get_width,function(Ga){Gr.superSet(GL,this,"width",Ga),this.callLater(this.changeValue)}),Ge(0,Ga,"spaceX",function(){return this._spaceX},function(Ga){this._spaceX=Ga,"horizontal"===this._direction&&this.callLater(this.changeValue)}),Ge(0,Ga,"spaceY",function(){return this._spaceY},function(Ga){this._spaceY=Ga,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),Ge(0,Ga,"align",function(){return this._align},function(Ga){this._align=Ga,this.callLater(this.changeValue)}),Ge(0,Ga,"measureWidth",function(){return this._wordsW}),Ge(0,Ga,"measureHeight",function(){return this._wordsH}),Gc}(GL),GX=function(Ga){function Gb(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new Gq,Gb.__super.call(this)}Gf(Gb,"laya.ui.List",Ga);var Gc=Gb.prototype;return Gr.imps(Gc,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),Gc.destroy=function(Ga){void 0===Ga&&(Ga=!0),this._content&&this._content.destroy(Ga),this._scrollBar&&this._scrollBar.destroy(Ga),laya.ui.Component.prototype.destroy.call(this,Ga),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},Gc.createChildren=function(){this.addChild(this._content=new GJ)},Gc.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=Gr.superGet(GJ,this,"cacheAs")),Gr.superSet(GJ,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},Gc.onScrollEnd=function(){Gr.superSet(GJ,this,"cacheAs",this._$P.cacheAs)},Gc._removePreScrollBar=function(){var Ga=this.removeChildByName("scrollBar");Ga&&Ga.destroy(!0)},Gc.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var Ga=this._getOneCell(),Gb=Ga.width+this._spaceX||1,Gc=Ga.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/Gb):Math.ceil(this._width/Gb)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/Gc):Math.round(this._height/Gc));var Gd=this._width?this._width:Gb*this.repeatX-this._spaceX,Ge=this._height?this._height:Gc*this.repeatY-this._spaceY;this._cellSize=this._isVertical?Gc:Gb,this._cellOffset=this._isVertical?Gc*Math.max(this._repeatY2,this._repeatY)-Ge-this._spaceY:Gb*Math.max(this._repeatX2,this._repeatX)-Gd-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=Ge:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=Gd),this.setContentSize(Gd,Ge);var Gf=this._isVertical?this.repeatX:this.repeatY,Gg=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,Gf,Gg),this._createdLine=Gg,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},Gc._getOneCell=function(){if(0===this._cells.length){var Ga=this.createItem();if(this._offset.setTo(Ga.x,Ga.y),this.cacheContent)return Ga;this._cells.push(Ga)}return this._cells[0]},Gc._createItems=function(Ga,Gb,Gc){var Gd=this._content,Ge=this._getOneCell(),Gf=Ge.width+this._spaceX,Gg=Ge.height+this._spaceY;if(this.cacheContent){var Gh=new GJ;Gh.cacheAsBitmap=!0,Gh.pos((this._isVertical?0:Ga)*Gf,(this._isVertical?Ga:0)*Gg),this._content.addChild(Gh),this._content.optimizeScrollRect=!0,Gd=Gh}else{for(var Gi=[],Gj=this._cells.length-1;-1<Gj;Gj--){var Gk=this._cells[Gj];Gk.removeSelf(),Gi.push(Gk)}this._cells.length=0}for(var Gl=Ga;Gl<Gc;Gl++)for(var Go=0;Go<Gb;Go++)(Ge=Gi&&Gi.length?Gi.pop():this.createItem()).x=(this._isVertical?Go:Gl)*Gf-Gd.x,Ge.y=(this._isVertical?Gl:Go)*Gg-Gd.y,Ge.name="item"+(Gl*Gb+Go),Gd.addChild(Ge),this.addCell(Ge)},Gc.createItem=function(){var Ga=[];if("function"==typeof this._itemRender)var Gb=new this._itemRender;else Gb=GT.createComp(this._itemRender,null,null,Ga);if(0==Ga.length&&Gb._watchMap){var Gc=Gb._watchMap;for(var Gd in Gc)for(var Ge=Gc[Gd],Gf=0;Gf<Ge.length;Gf++){var Gg=Ge[Gf];Ga.push(Gg.comp,Gg.prop,Gg.value)}}return Ga.length&&(Gb._$bindData=Ga),Gb},Gc.addCell=function(Ga){Ga.on("click",this,this.onCellMouse),Ga.on("rightclick",this,this.onCellMouse),Ga.on("mouseover",this,this.onCellMouse),Ga.on("mouseout",this,this.onCellMouse),Ga.on("mousedown",this,this.onCellMouse),Ga.on("mouseup",this,this.onCellMouse),this._cells.push(Ga)},Gc.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var Ga=0,Gb=Ga=0;Gb<1e4;Gb++){var Gc=this.getChildByName("item"+Gb);if(!Gc)break;this.addCell(Gc),Ga++}this.repeatY=Ga}},Gc.setContentSize=function(Ga,Gb){this._content.width=Ga,this._content.height=Gb,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new Gt),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,Ga,Gb),this._content.scrollRect=this._content.scrollRect),this.event("resize")},Gc.onCellMouse=function(Ga){"mousedown"===Ga.type&&(this._isMoved=!1);var Gb=Ga.currentTarget,Gc=this._startIndex+this._cells.indexOf(Gb);Gc<0||("click"===Ga.type||"rightclick"===Ga.type?this.selectEnable&&!this._isMoved?this.selectedIndex=Gc:this.changeCellState(Gb,!0,0):"mouseover"!==Ga.type&&"mouseout"!==Ga.type||this._selectedIndex===Gc||this.changeCellState(Gb,"mouseover"===Ga.type,0),this.mouseHandler&&this.mouseHandler.runWith([Ga,Gc]))},Gc.changeCellState=function(Ga,Gb,Gc){var Gd=Ga.getChildByName("selectBox");Gd&&(this.selectEnable=!0,Gd.visible=Gb,Gd.index=Gc)},Gc.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},Gc.onScrollBarChange=function(Ga){this.runCallLater(this.changeCells);var Gb=this._scrollBar.value,Gc=this._isVertical?this.repeatX:this.repeatY,Gd=this._isVertical?this.repeatY:this.repeatX,Ge=Math.floor(Gb/this._cellSize);if(this.cacheContent)Gg=Gd+1,this._createdLine-Ge<Gg&&(this._createItems(this._createdLine,Gc,this._createdLine+Gg),this.renderItems(this._createdLine*Gc,0),this._createdLine+=Gg);else{var Gf=Ge*Gc,Gg=0;if(Gf>this._startIndex){Gg=Gf-this._startIndex;var Gh=!0,Gi=this._startIndex+Gc*(Gd+1);this._isMoved=!0}else Gf<this._startIndex&&(Gg=this._startIndex-Gf,Gh=!1,Gi=this._startIndex-1,this._isMoved=!0);for(var Gj=0;Gj<Gg;Gj++){if(Gh){var Gk=this._cells.shift();this._cells[this._cells.length]=Gk;var Gl=Gi+Gj}else Gk=this._cells.pop(),this._cells.unshift(Gk),Gl=Gi-Gj;var Go=Math.floor(Gl/Gc)*this._cellSize;this._isVertical?Gk.y=Go:Gk.x=Go,this.renderItem(Gk,Gl)}this._startIndex=Gf,this.changeSelectStatus()}var Gp=this._content.scrollRect;this._isVertical?(Gp.y=Gb-this._offset.y,Gp.x=-this._offset.x):(Gp.y=-this._offset.y,Gp.x=Gb-this._offset.x),this._content.scrollRect=Gp},Gc.posCell=function(Ga,Gb){if(this._scrollBar){var Gc=this._isVertical?this.repeatX:this.repeatY,Gd=(this._isVertical?this.repeatY:this.repeatX,Math.floor(Gb/Gc)*this._cellSize);this._isVertical?Ga.y=Gd:Ga.x=Gd}},Gc.changeSelectStatus=function(){for(var Ga=0,Gb=this._cells.length;Ga<Gb;Ga++)this.changeCellState(this._cells[Ga],this._selectedIndex===this._startIndex+Ga,1)},Gc.renderItems=function(Ga,Gb){void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0);for(var Gc=Ga,Gd=Gb||this._cells.length;Gc<Gd;Gc++)this.renderItem(this._cells[Gc],this._startIndex+Gc);this.changeSelectStatus()},Gc.renderItem=function(Ga,Gb){this._array&&0<=Gb&&Gb<this._array.length?(Ga.visible=!0,Ga._$bindData?(Ga._dataSource=this._array[Gb],this._bindData(Ga,this._array[Gb])):Ga.dataSource=this._array[Gb],this.cacheContent||this.posCell(Ga,Gb),this.hasListener("render")&&this.event("render",[Ga,Gb]),this.renderHandler&&this.renderHandler.runWith([Ga,Gb])):(Ga.visible=!1,Ga.dataSource=null)},Gc._bindData=function(Ga,Gb){for(var Gc=Ga._$bindData,Gd=0,Ge=Gc.length;Gd<Ge;Gd++){var Gf=Gc[Gd++],Gg=Gc[Gd++],Gh=Gc[Gd],Gi=GE.getBindFun(Gh);Gf[Gg]=Gi.call(this,Gb)}},Gc.refresh=function(){this.array=this._array},Gc.getItem=function(Ga){return-1<Ga&&Ga<this._array.length?this._array[Ga]:null},Gc.changeItem=function(Ga,Gb){-1<Ga&&Ga<this._array.length&&(this._array[Ga]=Gb,Ga>=this._startIndex&&Ga<this._startIndex+this._cells.length&&this.renderItem(this.getCell(Ga),Ga))},Gc.setItem=function(Ga,Gb){this.changeItem(Ga,Gb)},Gc.addItem=function(Ga){this._array.push(Ga),this.array=this._array},Gc.addItemAt=function(Ga,Gb){this._array.splice(Gb,0,Ga),this.array=this._array},Gc.deleteItem=function(Ga){this._array.splice(Ga,1),this.array=this._array},Gc.getCell=function(Ga){return this.runCallLater(this.changeCells),-1<Ga&&this._cells?this._cells[(Ga-this._startIndex)%this._cells.length]:null},Gc.scrollTo=function(Ga){if(this._scrollBar){var Gb=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(Ga/Gb)*this._cellSize}else this.startIndex=Ga},Gc.tweenTo=function(Ga,Gb,Gc){if(void 0===Gb&&(Gb=200),this._scrollBar){var Gd=this._isVertical?this.repeatX:this.repeatY;Gz.to(this._scrollBar,{value:Math.floor(Ga/Gd)*this._cellSize},Gb,null,Gc,0,!0)}else this.startIndex=Ga,Gc&&Gc.run()},Gc._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},Gc.commitMeasure=function(){this.runCallLater(this.changeCells)},Ge(0,Gc,"cacheAs",Ga.prototype._$get_cacheAs,function(Ga){Gr.superSet(GJ,this,"cacheAs",Ga),this._scrollBar&&(this._$P.cacheAs=null,"none"!==Ga?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),Ge(0,Gc,"content",function(){return this._content}),Ge(0,Gc,"height",Ga.prototype._$get_height,function(Ga){Ga!=this._height&&(Gr.superSet(GJ,this,"height",Ga),this._setCellChanged())}),Ge(0,Gc,"itemRender",function(){return this._itemRender},function(Ga){if(this._itemRender!=Ga){this._itemRender=Ga;for(var Gb=this._cells.length-1;-1<Gb;Gb--)this._cells[Gb].destroy();this._cells.length=0,this._setCellChanged()}}),Ge(0,Gc,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(Ga){this._removePreScrollBar();var Gb=new Gba;Gb.name="scrollBar",Gb.right=0,Ga&&" "!=Ga&&(Gb.skin=Ga),this.scrollBar=Gb,this.addChild(Gb),this._setCellChanged()}),Ge(0,Gc,"page",function(){return this._page},function(Ga){this._page=Ga,this._array&&(this._page=0<Ga?Ga:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),Ge(0,Gc,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(Ga){this._removePreScrollBar();var Gb=new GY;Gb.name="scrollBar",Gb.bottom=0,Ga&&" "!=Ga&&(Gb.skin=Ga),this.scrollBar=Gb,this.addChild(Gb),this._setCellChanged()}),Ge(0,Gc,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(Ga){this._repeatX=Ga,this._setCellChanged()}),Ge(0,Gc,"scrollBar",function(){return this._scrollBar},function(Ga){this._scrollBar!=Ga&&(this._scrollBar=Ga)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),Ge(0,Gc,"width",Ga.prototype._$get_width,function(Ga){Ga!=this._width&&(Gr.superSet(GJ,this,"width",Ga),this._setCellChanged())}),Ge(0,Gc,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(Ga){this._repeatY=Ga,this._setCellChanged()}),Ge(0,Gc,"spaceX",function(){return this._spaceX},function(Ga){this._spaceX=Ga,this._setCellChanged()}),Ge(0,Gc,"spaceY",function(){return this._spaceY},function(Ga){this._spaceY=Ga,this._setCellChanged()}),Ge(0,Gc,"selectedIndex",function(){return this._selectedIndex},function(Ga){this._selectedIndex!=Ga&&(this._selectedIndex=Ga,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(Ga),this.startIndex=this._startIndex)}),Ge(0,Gc,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(Ga){this.selectedIndex=this._array.indexOf(Ga)}),Ge(0,Gc,"length",function(){return this._array?this._array.length:0}),Ge(0,Gc,"selection",function(){return this.getCell(this._selectedIndex)},function(Ga){this.selectedIndex=this._startIndex+this._cells.indexOf(Ga)}),Ge(0,Gc,"startIndex",function(){return this._startIndex},function(Ga){this._startIndex=0<Ga?Ga:0,this.callLater(this.renderItems)}),Ge(0,Gc,"array",function(){return this._array},function(Ga){this.runCallLater(this.changeCells),this._array=Ga||[];var Gb=this._array.length;if(this.totalPage=Math.ceil(Gb/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<Gb?this._selectedIndex:Gb-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var Gc=this._isVertical?this.repeatX:this.repeatY,Gd=this._isVertical?this.repeatY:this.repeatX,Ge=Math.ceil(Gb/Gc);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=Gd/Ge,this._scrollBar.setScroll(0,(Ge-Gd)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),Ge(0,Gc,"dataSource",Ga.prototype._$get_dataSource,function(Ga){"number"==typeof(this._dataSource=Ga)&&Math.floor(Ga)==Ga||"string"==typeof Ga?this.selectedIndex=parseInt(Ga):Ga instanceof Array?this.array=Ga:Gr.superSet(GJ,this,"dataSource",Ga)}),Ge(0,Gc,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),Gb}(GJ),GY=function(Ga){function Gb(){Gb.__super.call(this)}return Gf(Gb,"laya.ui.HScrollBar",Ga),Gb.prototype.initialize=function(){Ga.prototype.initialize.call(this),this.slider.isVertical=!1},Gb}(GO),GZ=function(Ga){function Gb(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,Gb.__super.call(this),this.width=this.height=100}Gf(Gb,"laya.ui.Panel",Ga);var Gc=Gb.prototype;return Gc.destroy=function(Ga){void 0===Ga&&(Ga=!0),laya.ui.Component.prototype.destroy.call(this,Ga),this._content&&this._content.destroy(Ga),this._vScrollBar&&this._vScrollBar.destroy(Ga),this._hScrollBar&&this._hScrollBar.destroy(Ga),this._vScrollBar=null,this._hScrollBar=null,this._content=null},Gc.destroyChildren=function(){this._content.destroyChildren()},Gc.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new GJ)},Gc.addChild=function(Ga){return Ga.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(Ga)},Gc.onResize=function(){this._setScrollChanged()},Gc.addChildAt=function(Ga,Gb){return Ga.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(Ga,Gb)},Gc.removeChild=function(Ga){return Ga.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(Ga)},Gc.removeChildAt=function(Ga){return this.getChildAt(Ga).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(Ga)},Gc.removeChildren=function(Ga,Gb){return void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=2147483647),this._content.removeChildren(Ga,Gb),this._setScrollChanged(),this},Gc.getChildAt=function(Ga){return this._content.getChildAt(Ga)},Gc.getChildByName=function(Ga){return this._content.getChildByName(Ga)},Gc.getChildIndex=function(Ga){return this._content.getChildIndex(Ga)},Gc.changeScroll=function(){this._scrollChanged=!1;var Ga=this.contentWidth||1,Gb=this.contentHeight||1,Gc=this._vScrollBar,Gd=this._hScrollBar,Ge=Gc&&Gb>this._height,Gf=Gd&&Ga>this._width,Gg=Ge?this._width-Gc.width:this._width,Gh=Gf?this._height-Gd.height:this._height;Gc&&(Gc.x=this._width-Gc.width,Gc.y=0,Gc.height=this._height-(Gf?Gd.height:0),Gc.scrollSize=Math.max(.033*this._height,1),Gc.thumbPercent=Gh/Gb,Gc.setScroll(0,Gb-Gh,Gc.value)),Gd&&(Gd.x=0,Gd.y=this._height-Gd.height,Gd.width=this._width-(Ge?Gc.width:0),Gd.scrollSize=Math.max(.033*this._width,1),Gd.thumbPercent=Gg/Ga,Gd.setScroll(0,Ga-Gg,Gd.value))},Gc.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},Gc.setContentSize=function(Ga,Gb){var Gc=this._content;Gc.width=Ga,Gc.height=Gb,Gc.scrollRect||(Gc.scrollRect=new Gt),Gc.scrollRect.setTo(0,0,Ga,Gb),Gc.scrollRect=Gc.scrollRect},Gc.onScrollBarChange=function(Ga){var Gb=this._content.scrollRect;if(Gb){var Gc=Math.round(Ga.value);Ga.isVertical?Gb.y=Gc:Gb.x=Gc,this._content.scrollRect=Gb}},Gc.scrollTo=function(Ga,Gb){void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),this.vScrollBar&&(this.vScrollBar.value=Gb),this.hScrollBar&&(this.hScrollBar.value=Ga)},Gc.refresh=function(){this.changeScroll()},Gc.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=Gr.superGet(GJ,this,"cacheAs")),Gr.superSet(GJ,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},Gc.onScrollEnd=function(){Gr.superSet(GJ,this,"cacheAs",this._$P.cacheAs)},Gc._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},Ge(0,Gc,"numChildren",function(){return this._content.numChildren}),Ge(0,Gc,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(Ga){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new GY),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=Ga}),Ge(0,Gc,"contentWidth",function(){for(var Ga=0,Gb=this._content.numChildren-1;-1<Gb;Gb--){var Gc=this._content.getChildAt(Gb);Ga=Math.max(Gc.x+Gc.width*Gc.scaleX,Ga)}return Ga}),Ge(0,Gc,"contentHeight",function(){for(var Ga=0,Gb=this._content.numChildren-1;-1<Gb;Gb--){var Gc=this._content.getChildAt(Gb);Ga=Math.max(Gc.y+Gc.height*Gc.scaleY,Ga)}return Ga}),Ge(0,Gc,"width",Ga.prototype._$get_width,function(Ga){Gr.superSet(GJ,this,"width",Ga),this._setScrollChanged()}),Ge(0,Gc,"hScrollBar",function(){return this._hScrollBar}),Ge(0,Gc,"content",function(){return this._content}),Ge(0,Gc,"height",Ga.prototype._$get_height,function(Ga){Gr.superSet(GJ,this,"height",Ga),this._setScrollChanged()}),Ge(0,Gc,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(Ga){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new Gba),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=Ga}),Ge(0,Gc,"vScrollBar",function(){return this._vScrollBar}),Ge(0,Gc,"cacheAs",Ga.prototype._$get_cacheAs,function(Ga){Gr.superSet(GJ,this,"cacheAs",Ga),this._$P.cacheAs=null,"none"!==Ga?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),Gb}(GJ),G$=function(Ga){function Gb(Ga){Gb.__super.call(this,Ga),this.isVertical=!1}return Gf(Gb,"laya.ui.HSlider",GP),Gb}(),G_=function(Ga){function Gc(Ga,Gb){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,Gc.__super.call(this),this.skin=Gb,this.labels=Ga}Gf(Gc,"laya.ui.UIGroup",Ga);var Gb=Gc.prototype;return Gr.imps(Gb,{"laya.ui.IItem":!0}),Gb.preinitialize=function(){this.mouseEnabled=!0},Gb.destroy=function(Ga){void 0===Ga&&(Ga=!0),laya.ui.Component.prototype.destroy.call(this,Ga),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},Gb.addItem=function(Ga,Gb){void 0===Gb&&(Gb=!0);var Gc=Ga,Gd=this._items.length;if(Gc.name="item"+Gd,this.addChild(Gc),this.initItems(),Gb&&0<Gd){var Ge=this._items[Gd-1];"horizontal"==this._direction?Gc.x=Ge.x+Ge.width+this._space:Gc.y=Ge.y+Ge.height+this._space}else Gb&&(Gc.x=0,Gc.y=0);return Gd},Gb.delItem=function(Ga,Gb){void 0===Gb&&(Gb=!0);var Gc=this._items.indexOf(Ga);if(-1!=Gc){var Gd=Ga;this.removeChild(Gd);for(var Ge=Gc+1,Gf=this._items.length;Ge<Gf;Ge++){var Gg=this._items[Ge];Gg.name="item"+(Ge-1),Gb&&("horizontal"==this._direction?Gg.x-=Gd.width+this._space:Gg.y-=Gd.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var Gh;Gh=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=Gh}}},Gb.initItems=function(){this._items||(this._items=[]);for(var Ga=this._items.length=0;Ga<1e4;Ga++){var Gb=this.getChildByName("item"+Ga);if(null==Gb)break;this._items.push(Gb),Gb.selected=Ga===this._selectedIndex,Gb.clickHandler=Go.create(this,this.itemClick,[Ga],!1)}},Gb.itemClick=function(Ga){this.selectedIndex=Ga},Gb.setSelect=function(Ga,Gb){this._items&&-1<Ga&&Ga<this._items.length&&(this._items[Ga].selected=Gb)},Gb.createItem=function(Ga,Gb){return null},Gb.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var Ga=0,Gb=0,Gc=this._items.length;Gb<Gc;Gb++){var Gd=this._items[Gb];this._skin&&(Gd.skin=this._skin),this._labelColors&&(Gd.labelColors=this._labelColors),this._labelSize&&(Gd.labelSize=this._labelSize),this._labelStroke&&(Gd.labelStroke=this._labelStroke),this._labelStrokeColor&&(Gd.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(Gd.strokeColors=this._strokeColors),this._labelBold&&(Gd.labelBold=this._labelBold),this._labelPadding&&(Gd.labelPadding=this._labelPadding),this._labelAlign&&(Gd.labelAlign=this._labelAlign),this._stateNum&&(Gd.stateNum=this._stateNum),this._labelFont&&(Gd.labelFont=this._labelFont),"horizontal"===this._direction?(Gd.y=0,Gd.x=Ga,Ga+=Gd.width+this._space):(Gd.x=0,Gd.y=Ga,Ga+=Gd.height+this._space)}this.changeSize()},Gb.commitMeasure=function(){this.runCallLater(this.changeLabels)},Gb._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},Ge(0,Gb,"labelStrokeColor",function(){return this._labelStrokeColor},function(Ga){this._labelStrokeColor!=Ga&&(this._labelStrokeColor=Ga,this._setLabelChanged())}),Ge(0,Gb,"skin",function(){return this._skin},function(Ga){this._skin!=Ga&&(this._skin=Ga,this._setLabelChanged())}),Ge(0,Gb,"selectedIndex",function(){return this._selectedIndex},function(Ga){this._selectedIndex!=Ga&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=Ga,this.setSelect(Ga,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),Ge(0,Gb,"labels",function(){return this._labels},function(Ga){if(this._labels!=Ga){if(this._labels=Ga,this.removeChildren(),this._setLabelChanged(),this._labels)for(var Gb=this._labels.split(","),Gc=0,Gd=Gb.length;Gc<Gd;Gc++){var Ge=this.createItem(this._skin,Gb[Gc]);Ge.name="item"+Gc,this.addChild(Ge)}this.initItems()}}),Ge(0,Gb,"strokeColors",function(){return this._strokeColors},function(Ga){this._strokeColors!=Ga&&(this._strokeColors=Ga,this._setLabelChanged())}),Ge(0,Gb,"labelColors",function(){return this._labelColors},function(Ga){this._labelColors!=Ga&&(this._labelColors=Ga,this._setLabelChanged())}),Ge(0,Gb,"labelStroke",function(){return this._labelStroke},function(Ga){this._labelStroke!=Ga&&(this._labelStroke=Ga,this._setLabelChanged())}),Ge(0,Gb,"labelSize",function(){return this._labelSize},function(Ga){this._labelSize!=Ga&&(this._labelSize=Ga,this._setLabelChanged())}),Ge(0,Gb,"stateNum",function(){return this._stateNum},function(Ga){this._stateNum!=Ga&&(this._stateNum=Ga,this._setLabelChanged())}),Ge(0,Gb,"labelBold",function(){return this._labelBold},function(Ga){this._labelBold!=Ga&&(this._labelBold=Ga,this._setLabelChanged())}),Ge(0,Gb,"labelFont",function(){return this._labelFont},function(Ga){this._labelFont!=Ga&&(this._labelFont=Ga,this._setLabelChanged())}),Ge(0,Gb,"labelPadding",function(){return this._labelPadding},function(Ga){this._labelPadding!=Ga&&(this._labelPadding=Ga,this._setLabelChanged())}),Ge(0,Gb,"direction",function(){return this._direction},function(Ga){this._direction=Ga,this._setLabelChanged()}),Ge(0,Gb,"space",function(){return this._space},function(Ga){this._space=Ga,this._setLabelChanged()}),Ge(0,Gb,"items",function(){return this._items}),Ge(0,Gb,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(Ga){this.selectedIndex=this._items.indexOf(Ga)}),Ge(0,Gb,"dataSource",Ga.prototype._$get_dataSource,function(Ga){"number"==typeof(this._dataSource=Ga)&&Math.floor(Ga)==Ga||"string"==typeof Ga?this.selectedIndex=parseInt(Ga):Ga instanceof Array?this.labels=Ga.join(","):Gr.superSet(GJ,this,"dataSource",Ga)}),Gc}(GJ),Gm=function(Gb){function Gc(Ga,Gb){this._value=null,void 0===Gb&&(Gb=""),Gc.__super.call(this,Ga,Gb)}Gf(Gc,"laya.ui.Radio",Gb);var Ga=Gc.prototype;return Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,Ga),this._value=null},Ga.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},Ga.initialize=function(){Gb.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},Ga.onClick=function(Ga){this.selected=!0},Ge(0,Ga,"value",function(){return null!=this._value?this._value:this.label},function(Ga){this._value=Ga}),Gc}(GK),Gn=function(Ga){function Gb(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,Gb.__super.call(this),this.width=this.height=200}Gf(Gb,"laya.ui.Tree",Ga);var Gc=Gb.prototype;return Gr.imps(Gc,{"laya.ui.IRender":!0}),Gc.destroy=function(Ga){void 0===Ga&&(Ga=!0),laya.ui.Component.prototype.destroy.call(this,Ga),this._list&&this._list.destroy(Ga),this._list=null,this._source=null,this._renderHandler=null},Gc.createChildren=function(){this.addChild(this._list=new GX),this._list.renderHandler=Go.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},Gc.onListChange=function(Ga){this.event("change")},Gc.getArray=function(){var Ga,Gb=[];for(var Gc in this._source)Ga=this._source[Gc],this.getParentOpenStatus(Ga)&&(Ga.x=this._spaceLeft*this.getDepth(Ga),Gb.push(Ga));return Gb},Gc.getDepth=function(Ga,Gb){return void 0===Gb&&(Gb=0),null==Ga.nodeParent?Gb:this.getDepth(Ga.nodeParent,Gb+1)},Gc.getParentOpenStatus=function(Ga){var Gb=Ga.nodeParent;return null==Gb||!!Gb.isOpen&&(null==Gb.nodeParent||this.getParentOpenStatus(Gb))},Gc.renderItem=function(Ga,Gb){var Gc=Ga.dataSource;if(Gc){Ga.left=Gc.x;var Gd=Ga.getChildByName("arrow");Gd&&(Gc.hasChild?(Gd.visible=!0,Gd.index=Gc.isOpen?1:0,Gd.tag=Gb,Gd.off("click",this,this.onArrowClick),Gd.on("click",this,this.onArrowClick)):Gd.visible=!1);var Ge=Ga.getChildByName("folder");Ge&&(2==Ge.clipY?Ge.index=Gc.isDirectory?0:1:Ge.index=Gc.isDirectory?Gc.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([Ga,Gb])}},Gc.onArrowClick=function(Ga){var Gb=Ga.currentTarget.tag;this._list.array[Gb].isOpen=!this._list.array[Gb].isOpen,this.event("open"),this._list.array=this.getArray()},Gc.setItemState=function(Ga,Gb){this._list.array[Ga]&&(this._list.array[Ga].isOpen=Gb,this._list.array=this.getArray())},Gc.fresh=function(){this._list.array=this.getArray(),this.repaint()},Gc.parseXml=function(Ga,Gb,Gc,Gd){var Ge,Gf=Ga.childNodes,Gg=Gf.length;if(!Gd){Ge={};var Gh,Gi=Ga.attributes;for(var Gj in Gi){var Gk=(Gh=Gi[Gj]).nodeName,Gl=Gh.nodeValue;Ge[Gk]="true"==Gl||"false"!=Gl&&Gl}Ge.nodeParent=Gc,0<Gg&&(Ge.isDirectory=!0),Ge.hasChild=0<Gg,Gb.push(Ge)}for(var Go=0;Go<Gg;Go++){var Gp=Gf[Go];this.parseXml(Gp,Gb,Ge,!1)}},Gc.parseOpenStatus=function(Ga,Gb){for(var Gc=0,Gd=Gb.length;Gc<Gd;Gc++){var Ge=Gb[Gc];if(Ge.isDirectory)for(var Gf=0,Gg=Ga.length;Gf<Gg;Gf++){var Gh=Ga[Gf];if(Gh.isDirectory&&this.isSameParent(Gh,Ge)&&Ge.label==Gh.label){Ge.isOpen=Gh.isOpen;break}}}},Gc.isSameParent=function(Ga,Gb){return null==Ga.nodeParent&&null==Gb.nodeParent||null!=Ga.nodeParent&&null!=Gb.nodeParent&&(Ga.nodeParent.label==Gb.nodeParent.label&&this.isSameParent(Ga.nodeParent,Gb.nodeParent))},Gc.filter=function(Ga){if(Boolean(Ga)){var Gb=[];this.getFilterSource(this._source,Gb,Ga),this._list.array=Gb}else this._list.array=this.getArray()},Gc.getFilterSource=function(Ga,Gb,Gc){var Gd;for(var Ge in Gc=Gc.toLocaleLowerCase(),Ga)!(Gd=Ga[Ge]).isDirectory&&-1<String(Gd.label).toLowerCase().indexOf(Gc)&&(Gd.x=0,Gb.push(Gd)),Gd.child&&0<Gd.child.length&&this.getFilterSource(Gd.child,Gb,Gc)},Ge(0,Gc,"spaceBottom",function(){return this._list.spaceY},function(Ga){this._list.spaceY=Ga}),Ge(0,Gc,"keepStatus",function(){return this._keepStatus},function(Ga){this._keepStatus=Ga}),Ge(0,Gc,"itemRender",function(){return this._list.itemRender},function(Ga){this._list.itemRender=Ga}),Ge(0,Gc,"array",function(){return this._list.array},function(Ga){this._keepStatus&&this._list.array&&Ga&&this.parseOpenStatus(this._list.array,Ga),this._source=Ga,this._list.array=this.getArray()}),Ge(0,Gc,"mouseHandler",function(){return this._list.mouseHandler},function(Ga){this._list.mouseHandler=Ga}),Ge(0,Gc,"dataSource",Ga.prototype._$get_dataSource,function(Ga){this._dataSource=Ga,Gr.superSet(GJ,this,"dataSource",Ga)}),Ge(0,Gc,"source",function(){return this._source}),Ge(0,Gc,"scrollBar",function(){return this._list.scrollBar}),Ge(0,Gc,"list",function(){return this._list}),Ge(0,Gc,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(Ga){this._list.vScrollBarSkin=Ga}),Ge(0,Gc,"renderHandler",function(){return this._renderHandler},function(Ga){this._renderHandler=Ga}),Ge(0,Gc,"selectedIndex",function(){return this._list.selectedIndex},function(Ga){this._list.selectedIndex=Ga}),Ge(0,Gc,"spaceLeft",function(){return this._spaceLeft},function(Ga){this._spaceLeft=Ga}),Ge(0,Gc,"selectedItem",function(){return this._list.selectedItem},function(Ga){this._list.selectedItem=Ga}),Ge(0,Gc,"width",Ga.prototype._$get_width,function(Ga){Gr.superSet(GJ,this,"width",Ga),this._list.width=Ga}),Ge(0,Gc,"height",Ga.prototype._$get_height,function(Ga){Gr.superSet(GJ,this,"height",Ga),this._list.height=Ga}),Ge(0,Gc,"xml",null,function(Ga){var Gb=[];this.parseXml(Ga.childNodes[0],Gb,null,!0),this.array=Gb}),Ge(0,Gc,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),Gb}(GJ),Gaa=function(Ga){function Gb(){this._items=null,this._selectedIndex=0,Gb.__super.call(this),this._setIndexHandler=Go.create(this,this.setIndex,null,!1)}Gf(Gb,"laya.ui.ViewStack",Ga);var Gc=Gb.prototype;return Gr.imps(Gc,{"laya.ui.IItem":!0}),Gc.setItems=function(Ga){this.removeChildren();for(var Gb=0,Gc=0,Gd=Ga.length;Gc<Gd;Gc++){var Ge=Ga[Gc];Ge&&(Ge.name="item"+Gb,this.addChild(Ge),Gb++)}this.initItems()},Gc.addItem=function(Ga){Ga.name="item"+this._items.length,this.addChild(Ga),this.initItems()},Gc.initItems=function(){this._items=[];for(var Ga=0;Ga<1e4;Ga++){var Gb=this.getChildByName("item"+Ga);if(null==Gb)break;this._items.push(Gb),Gb.visible=Ga==this._selectedIndex}},Gc.setSelect=function(Ga,Gb){this._items&&-1<Ga&&Ga<this._items.length&&(this._items[Ga].visible=Gb)},Gc.setIndex=function(Ga){this.selectedIndex=Ga},Ge(0,Gc,"dataSource",Ga.prototype._$get_dataSource,function(Ga){if("number"==typeof(this._dataSource=Ga)&&Math.floor(Ga)==Ga||"string"==typeof Ga)this.selectedIndex=parseInt(Ga);else for(var Gb in this._dataSource)this.hasOwnProperty(Gb)&&(this[Gb]=this._dataSource[Gb])}),Ge(0,Gc,"selectedIndex",function(){return this._selectedIndex},function(Ga){this._selectedIndex!=Ga&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=Ga,this.setSelect(this._selectedIndex,!0))}),Ge(0,Gc,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(Ga){this.selectedIndex=this._items.indexOf(Ga)}),Ge(0,Gc,"items",function(){return this._items}),Ge(0,Gc,"setIndexHandler",function(){return this._setIndexHandler},function(Ga){this._setIndexHandler=Ga}),Gb}(GJ),Gba=function(Ga){function Gb(){Gb.__super.call(this)}return Gf(Gb,"laya.ui.VScrollBar",GO),Gb}(),Gca=function(Gb){function Gc(Ga){this._bg=null,this._skin=null,Gc.__super.call(this),void 0===Ga&&(Ga=""),this.text=Ga,this.skin=this.skin}Gf(Gc,"laya.ui.TextInput",Gb);var Ga=Gc.prototype;return Ga.preinitialize=function(){this.mouseEnabled=!0},Ga.destroy=function(Ga){Gu.clearCache(this,this._skin),void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,Ga),this._bg&&this._bg.destroy(),this._bg=null},Ga.createChildren=function(){this.addChild(this._tf=new Gp),this._tf.padding=GD.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},Ga._onFocus=function(){this.event("focus",this)},Ga._onBlur=function(){this.event("blur",this)},Ga._onInput=function(){this.event("input",this)},Ga._onEnter=function(){this.event("enter",this)},Ga.initialize=function(){this.width=128,this.height=22},Ga.select=function(){this._tf.select()},Ga.setSelection=function(Ga,Gb){this._tf.setSelection(Ga,Gb)},Ge(0,Ga,"text",Gb.prototype._$get_text,function(Ga){this._tf.text!=Ga&&(Ga+="",this._tf.text=Ga,this.event("change"))}),Ge(0,Ga,"bg",function(){return this._bg},function(Ga){this.graphics=this._bg=Ga}),Ge(0,Ga,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(Ga){this._tf.inputElementYAdjuster=Ga}),Ge(0,Ga,"multiline",function(){return this._tf.multiline},function(Ga){this._tf.multiline=Ga}),Ge(0,Ga,"skin",function(){return this._skin},function(Ga){this._skin!=Ga&&(Gu.clearCache(this,this._skin),this._skin=Ga,this._bg||(this.graphics=this._bg=new GG),Gu.keepCache(this,this._skin),this._bg.source=Gu.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),Ge(0,Ga,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(Ga){this._bg||(this.graphics=this._bg=new GG),this._bg.sizeGrid=GE.fillArray(GD.defaultSizeGrid,Ga,Number)}),Ge(0,Ga,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(Ga){this._tf.inputElementXAdjuster=Ga}),Ge(0,Ga,"width",Gb.prototype._$get_width,function(Ga){Gr.superSet(GR,this,"width",Ga),this._bg&&(this._bg.width=Ga)}),Ge(0,Ga,"height",Gb.prototype._$get_height,function(Ga){Gr.superSet(GR,this,"height",Ga),this._bg&&(this._bg.height=Ga)}),Ge(0,Ga,"editable",function(){return this._tf.editable},function(Ga){this._tf.editable=Ga}),Ge(0,Ga,"restrict",function(){return this._tf.restrict},function(Ga){this._tf.restrict=Ga}),Ge(0,Ga,"prompt",function(){return this._tf.prompt},function(Ga){this._tf.prompt=Ga}),Ge(0,Ga,"promptColor",function(){return this._tf.promptColor},function(Ga){this._tf.promptColor=Ga}),Ge(0,Ga,"maxChars",function(){return this._tf.maxChars},function(Ga){this._tf.maxChars=Ga}),Ge(0,Ga,"focus",function(){return this._tf.focus},function(Ga){this._tf.focus=Ga}),Ge(0,Ga,"type",function(){return this._tf.type},function(Ga){this._tf.type=Ga}),Ge(0,Ga,"asPassword",function(){return this._tf.asPassword},function(Ga){this._tf.asPassword=Ga}),Gc}(GR),Gda=function(Ga){function Gb(){Gb.__super.call(this)}return Gf(Gb,"laya.ui.VSlider",GP),Gb}(),Gea=function(Ga){function Gd(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,Gd.__super.call(this)}Gf(Gd,"laya.ui.Dialog",Ga);var Gb=Gd.prototype;return Gb.initialize=function(){this.popupEffect=Gd.manager.popupEffectHandler,this.closeEffect=Gd.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},Gb._dealDragArea=function(){var Ga=this.getChildByName("drag");Ga&&(this.dragArea=Ga.x+","+Ga.y+","+Ga.width+","+Ga.height,Ga.removeSelf())},Gb._onClick=function(Ga){var Gb=Ga.target;if(Gb)switch(Gb.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(Gb.name)}},Gb.show=function(Ga,Gb){void 0===Ga&&(Ga=!1),void 0===Gb&&(Gb=!0),this._open(!1,Ga,Gb)},Gb.popup=function(Ga,Gb){void 0===Ga&&(Ga=!1),void 0===Gb&&(Gb=!0),this._open(!0,Ga,Gb)},Gb._open=function(Ga,Gb,Gc){Gd.manager.lock(!1),this.isModal=Ga,Gd.manager.open(this,Gb,Gc)},Gb.onOpened=function(){},Gb.close=function(Ga,Gb){void 0===Gb&&(Gb=!0),Gd.manager.close(this,Ga,Gb)},Gb.onClosed=function(Ga){},Gb._onMouseDown=function(Ga){var Gb=this.getMousePoint();this._dragArea.contains(Gb.x,Gb.y)?this.startDrag():this.stopDrag()},Ge(0,Gb,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(Ga){if(Ga){var Gb=GE.fillArray([0,0,0,0],Ga,Number);this._dragArea=new Gt(Gb[0],Gb[1],Gb[2],Gb[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),Ge(0,Gb,"isPopup",function(){return null!=this.parent}),Ge(0,Gb,"zOrder",Ga.prototype._$get_zOrder,function(Ga){Gr.superSet(GT,this,"zOrder",Ga),Gd.manager._checkMask()}),Ge(1,Gd,"manager",function(){return Gd._manager=Gd._manager||new GI},function(Ga){Gd._manager=Ga}),Gd.setLockView=function(Ga){Gd.manager.setLockView(Ga)},Gd.lock=function(Ga){Gd.manager.lock(Ga)},Gd.closeAll=function(){Gd.manager.closeAll()},Gd.getDialogsByGroup=function(Ga){return Gd.manager.getDialogsByGroup(Ga)},Gd.closeByGroup=function(Ga){return Gd.manager.closeByGroup(Ga)},Gd.CLOSE="close",Gd.CANCEL="cancel",Gd.SURE="sure",Gd.NO="no",Gd.OK="ok",Gd.YES="yes",Gd._manager=null,Gd}(GT),Gfa=function(Ga){function Gb(){Gb.__super.call(this)}Gf(Gb,"laya.ui.HBox",Ga);var Gc=Gb.prototype;return Gc.sortItem=function(Ga){Ga&&Ga.sort(function(Ga,Gb){return Ga.x-Gb.x})},Gc.changeItems=function(){this._itemChanged=!1;for(var Ga=[],Gb=0,Gc=0,Gd=this.numChildren;Gc<Gd;Gc++){var Ge=this.getChildAt(Gc);Ge&&Ge.layoutEnabled&&(Ga.push(Ge),Gb=this._height?this._height:Math.max(Gb,Ge.height*Ge.scaleY))}this.sortItem(Ga);var Gf=0;for(Gc=0,Gd=Ga.length;Gc<Gd;Gc++)(Ge=Ga[Gc]).x=Gf,Gf+=Ge.width*Ge.scaleX+this._space,"top"==this._align?Ge.y=0:"middle"==this._align?Ge.y=.5*(Gb-Ge.height*Ge.scaleY):"bottom"==this._align&&(Ge.y=Gb-Ge.height*Ge.scaleY);this.changeSize()},Ge(0,Gc,"height",Ga.prototype._$get_height,function(Ga){this._height!=Ga&&(Gr.superSet(GV,this,"height",Ga),this.callLater(this.changeItems))}),Gb.NONE="none",Gb.TOP="top",Gb.MIDDLE="middle",Gb.BOTTOM="bottom",Gb}(GV),Gga=function(Ga){function Gb(){Gb.__super.call(this)}Gf(Gb,"laya.ui.VBox",Ga);var Gc=Gb.prototype;return Gc.changeItems=function(){this._itemChanged=!1;for(var Ga=[],Gb=0,Gc=0,Gd=this.numChildren;Gc<Gd;Gc++){var Ge=this.getChildAt(Gc);Ge&&Ge.layoutEnabled&&(Ga.push(Ge),Gb=this._width?this._width:Math.max(Gb,Ge.width*Ge.scaleX))}this.sortItem(Ga);var Gf=0;for(Gc=0,Gd=Ga.length;Gc<Gd;Gc++)(Ge=Ga[Gc]).y=Gf,Gf+=Ge.height*Ge.scaleY+this._space,"left"==this._align?Ge.x=0:"center"==this._align?Ge.x=.5*(Gb-Ge.width*Ge.scaleX):"right"==this._align&&(Ge.x=Gb-Ge.width*Ge.scaleX);this.changeSize()},Ge(0,Gc,"width",Ga.prototype._$get_width,function(Ga){this._width!=Ga&&(Gr.superSet(GV,this,"width",Ga),this.callLater(this.changeItems))}),Gb.NONE="none",Gb.LEFT="left",Gb.CENTER="center",Gb.RIGHT="right",Gb}(GV),Gha=function(Ga){function Gb(){Gb.__super.call(this)}return Gf(Gb,"laya.ui.RadioGroup",G_),Gb.prototype.createItem=function(Ga,Gb){return new Gm(Ga,Gb)},Gb}(),Gia=function(Ga){function Gb(){Gb.__super.call(this)}return Gf(Gb,"laya.ui.Tab",G_),Gb.prototype.createItem=function(Ga,Gb){return new GK(Ga,Gb)},Gb}(),Gja=function(Gb){function Gc(Ga){this._vScrollBar=null,this._hScrollBar=null,void 0===Ga&&(Ga=""),Gc.__super.call(this,Ga)}Gf(Gc,"laya.ui.TextArea",Gb);var Ga=Gc.prototype;return Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,Ga),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},Ga.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},Ga.onVBarChanged=function(Ga){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},Ga.onHBarChanged=function(Ga){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},Ga.changeScroll=function(){var Ga=this._vScrollBar&&0<this._tf.maxScrollY,Gb=this._hScrollBar&&0<this._tf.maxScrollX,Gc=Ga?this._width-this._vScrollBar.width:this._width,Gd=Gb?this._height-this._hScrollBar.height:this._height,Ge=this._tf.padding||GD.labelPadding;this._tf.width=Gc,this._tf.height=Gd,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-Ge[2],this._vScrollBar.y=Ge[1],this._vScrollBar.height=this._height-(Gb?this._hScrollBar.height:0)-Ge[1]-Ge[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=Gd/Math.max(this._tf.textHeight,Gd),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=Ga),this._hScrollBar&&(this._hScrollBar.x=Ge[0],this._hScrollBar.y=this._height-this._hScrollBar.height-Ge[3],this._hScrollBar.width=this._width-(Ga?this._vScrollBar.width:0)-Ge[0]-Ge[2],this._hScrollBar.scrollSize=Math.max(.033*Gc,1),this._hScrollBar.thumbPercent=Gc/Math.max(this._tf.textWidth,Gc),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=Gb)},Ga.scrollTo=function(Ga){this.commitMeasure(),this._tf.scrollY=Ga},Ge(0,Ga,"scrollY",function(){return this._tf.scrollY}),Ge(0,Ga,"width",Gb.prototype._$get_width,function(Ga){Gr.superSet(Gca,this,"width",Ga),this.callLater(this.changeScroll)}),Ge(0,Ga,"hScrollBar",function(){return this._hScrollBar}),Ge(0,Ga,"height",Gb.prototype._$get_height,function(Ga){Gr.superSet(Gca,this,"height",Ga),this.callLater(this.changeScroll)}),Ge(0,Ga,"maxScrollX",function(){return this._tf.maxScrollX}),Ge(0,Ga,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(Ga){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new Gba),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=Ga}),Ge(0,Ga,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(Ga){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new GY),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=Ga}),Ge(0,Ga,"vScrollBar",function(){return this._vScrollBar}),Ge(0,Ga,"maxScrollY",function(){return this._tf.maxScrollY}),Ge(0,Ga,"scrollX",function(){return this._tf.scrollX}),Gc}(Gca);!function(Ga){function Gb(){this._uiView=null,this.isCloseOther=!1,Gb.__super.call(this)}Gf(Gb,"laya.ui.AsynDialog",Gea);var Gc=Gb.prototype;Gc.createView=function(Ga){this._uiView=Ga},Gc._open=function(Ga,Gb,Gc){this.isModal=Ga,this.isCloseOther=Gb,Gea.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},Gc.onCreated=function(){this.createUI(),this.onOpen()},Gc.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},Gc.onOpen=function(){Gea.manager.open(this,this.isCloseOther),Gea.manager.lock(!1)},Gc.close=function(Ga,Gb){void 0===Gb&&(Gb=!0),Gea.manager.close(this),this.onClose()},Gc.onClose=function(){},Gc.destroy=function(Ga){void 0===Ga&&(Ga=!0),laya.ui.View.prototype.destroy.call(this,Ga),this._uiView=null,this.onDestroy()},Gc.onDestroy=function(){}}();Gr.__init([GT])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ga,Gb){"use strict";for(var Gc in Object.defineProperty(Gb,"__esModule",{value:!0}),Laya){var Gd=Laya[Gc];Gd&&Gd.__isclass&&(Gb[Gc]=Gd)}}),function(Go,Ga,Gx){Gx.un,Gx.uns;var Gl=Gx.static,Gp=Gx.class,Gq=Gx.getset,Gd=Gx.__newvec,Gw=laya.maths.Arith,Gg=laya.webgl.atlas.AtlasResourceManager,Gc=laya.webgl.shader.BaseShader,GH=laya.utils.Browser,Gh=laya.webgl.utils.Buffer,Gy=laya.utils.Byte,Ge=laya.utils.ClassUtils,Gi=Gx.Config,Gf=(laya.events.Event,laya.events.EventDispatcher),GD=laya.utils.Handler,Gt=laya.net.Loader,Gb=laya.net.LoaderManager,Gj=(laya.maths.MathUtil,laya.display.Node),Gr=laya.renders.Render,Gk=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),Gs=laya.resource.Resource,Gu=laya.utils.RunDriver,Gv=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),Gz=laya.display.Sprite,GA=laya.utils.Stat,GB=laya.utils.StringKey,GE=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),GC=laya.utils.Utils,GF=laya.webgl.WebGL,GG=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;Gx.interface("laya.d3.core.IClone"),Gx.interface("laya.d3.graphics.IVertex"),Gx.interface("laya.d3.core.render.IUpdate"),Gx.interface("laya.d3.core.scene.ITreeNode"),Gx.interface("laya.d3.core.render.IRenderable");(function(){function GK(){}Gp(GK,"laya.d3.animation.AnimationClipParser01"),GK.READ_DATA=function(){GK._DATA.offset=GK._reader.getUint32(),GK._DATA.size=GK._reader.getUint32()},GK.READ_BLOCK=function(){for(var Ga=GK._BLOCK.count=GK._reader.getUint16(),Gb=GK._BLOCK.blockStarts=[],Gc=GK._BLOCK.blockLengths=[],Gd=0;Gd<Ga;Gd++)Gb.push(GK._reader.getUint32()),Gc.push(GK._reader.getUint32())},GK.READ_STRINGS=function(){var Ga=GK._reader.getUint32(),Gb=GK._reader.getUint16(),Gc=GK._reader.pos;GK._reader.pos=Ga+GK._DATA.offset;for(var Gd=0;Gd<Gb;Gd++)GK._strings[Gd]=GK._reader.readUTFString();GK._reader.pos=Gc},GK.parse=function(Ga,Gb){GK._animationClip=Ga;(GK._reader=Gb).__getBuffer();GK.READ_DATA(),GK.READ_BLOCK(),GK.READ_STRINGS();for(var Gc=0,Gd=GK._BLOCK.count;Gc<Gd;Gc++){var Ge=Gb.getUint16(),Gf=GK._strings[Ge],Gg=GK["READ_"+Gf];if(null==Gg)throw new Error("model file err,no this function:"+Ge+" "+Gf);Gg.call()}},GK.READ_ANIMATIONS=function(){var Ga,Gb=0,Gc=0,Gd=GK._reader,Ge=Gd.__getBuffer(),Gf=[],Gg=Gd.getUint8();for(Gf.length=Gg,Gb=0;Gb<Gg;Gb++)Gf[Gb]=Gd.getUint16();var Gh=[],Gi=Gd.getUint16();for(Gh.length=Gi,Gb=0;Gb<Gi;Gb++)Gh[Gb]=Gd.getFloat32();var Gj=GK._animationClip;Gj.name=GK._strings[Gd.getUint16()];var Gk=Gj._duration=Gd.getFloat32();Gj.islooping=!!Gd.getByte(),Gj._frameRate=Gd.getInt16();var Gl=Gd.getInt16(),Go=Gj._nodes=new Array;Go.length=Gl,(Gj._publicClipDatas=[]).length=Gl;var Gp=Gj._nodesMap={},Gq=0,Gr=0;for(Gb=0;Gb<Gl;Gb++){Ga=Go[Gb]=new GS;var Gs=Gd.getUint16(),Gt=Ga.path=[];for(Gt.length=Gs,Gc=0;Gc<Gs;Gc++)Gt[Gc]=GK._strings[Gd.getUint16()];var Gu=Gt.join("/"),Gv=Gp[Gu];Gv||(Gp[Gu]=Gv=[]),Gv.push(Ga);var Gw=Gd.getInt16();-1!==Gw&&(Ga.componentType=GK._strings[Gw]);var Gx=GQ._propertyIndexDic[GK._strings[Gd.getUint16()]];if(null==Gx)throw new Error("AnimationClipParser01:unknown property name.");var Gy=Gx<4,Gz=!Gy||Gy&&""===Gt[0];(Ga._cacheProperty=Gz)?Gq++:Gr++,Ga.propertyNameID=Gx;var GA=Gf[Gd.getUint8()];Ga.keyFrameWidth=GA/4;var GB=Ga.keyFrames=[],GC=GB.length=Gd.getUint16(),GD=null,GE=NaN;for(Gc=0;Gc<GC;Gc++){var GF=GB[Gc]=new GR;GE=GF.startTime=Gh[Gd.getUint16()];var GG=Gd.pos;GF.inTangent=new Float32Array(Ge.slice(GG,GG+GA)),Gd.pos+=GA,GG=Gd.pos,GF.outTangent=new Float32Array(Ge.slice(GG,GG+GA)),Gd.pos+=GA,GG=Gd.pos,GF.data=new Float32Array(Ge.slice(GG,GG+GA)),Gd.pos+=GA,GD&&(GD.next=GF,GD.duration=GE-GD.startTime),GD=GF}GF.next=null,GF.duration=Gk-GE}var GH=Gj._nodeToCachePropertyMap=new Int32Array(Gl),GI=Gj._cachePropertyMap=new Int32Array(Gq),GJ=Gj._unCachePropertyMap=new Int32Array(Gr);for(Gq=Gr=0,Gb=0;Gb<Gl;Gb++)(Ga=Go[Gb])._cacheProperty?(GH[Gb]=Gq,GI[Gq++]=Gb):GJ[Gr++]=Gb},GK._animationClip=null,GK._reader=null,GK._strings=[],Gl(GK,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function GO(){}Gp(GO,"laya.d3.animation.AnimationClipParser02"),GO.READ_DATA=function(){GO._DATA.offset=GO._reader.getUint32(),GO._DATA.size=GO._reader.getUint32()},GO.READ_BLOCK=function(){for(var Ga=GO._BLOCK.count=GO._reader.getUint16(),Gb=GO._BLOCK.blockStarts=[],Gc=GO._BLOCK.blockLengths=[],Gd=0;Gd<Ga;Gd++)Gb.push(GO._reader.getUint32()),Gc.push(GO._reader.getUint32())},GO.READ_STRINGS=function(){var Ga=GO._reader.getUint32(),Gb=GO._reader.getUint16(),Gc=GO._reader.pos;GO._reader.pos=Ga+GO._DATA.offset;for(var Gd=0;Gd<Gb;Gd++)GO._strings[Gd]=GO._reader.readUTFString();GO._reader.pos=Gc},GO.parse=function(Ga,Gb){GO._animationClip=Ga;(GO._reader=Gb).__getBuffer();GO.READ_DATA(),GO.READ_BLOCK(),GO.READ_STRINGS();for(var Gc=0,Gd=GO._BLOCK.count;Gc<Gd;Gc++){var Ge=Gb.getUint16(),Gf=GO._strings[Ge],Gg=GO["READ_"+Gf];if(null==Gg)throw new Error("model file err,no this function:"+Ge+" "+Gf);Gg.call()}},GO.READ_ANIMATIONS=function(){var Ga,Gb=0,Gc=0,Gd=GO._reader,Ge=Gd.__getBuffer(),Gf=[],Gg=Gd.getUint8();for(Gf.length=Gg,Gb=0;Gb<Gg;Gb++)Gf[Gb]=Gd.getUint16();var Gh=[],Gi=Gd.getUint16();for(Gh.length=Gi,Gb=0;Gb<Gi;Gb++)Gh[Gb]=Gd.getFloat32();var Gj=GO._animationClip;Gj.name=GO._strings[Gd.getUint16()];var Gk=Gj._duration=Gd.getFloat32();Gj.islooping=!!Gd.getByte(),Gj._frameRate=Gd.getInt16();var Gl=Gd.getInt16(),Go=Gj._nodes=new Array;Go.length=Gl,(Gj._publicClipDatas=[]).length=Gl;var Gp=Gj._nodesMap={},Gq=0,Gr=0;for(Gb=0;Gb<Gl;Gb++){Ga=Go[Gb]=new GS;var Gs=Gd.getUint16(),Gt=Ga.path=[];for(Gt.length=Gs,Gc=0;Gc<Gs;Gc++)Gt[Gc]=GO._strings[Gd.getUint16()];var Gu=Gt.join("/"),Gv=Gp[Gu];Gv||(Gp[Gu]=Gv=[]),Gv.push(Ga);var Gw=Gd.getInt16();-1!==Gw&&(Ga.componentType=GO._strings[Gw]);var Gx=GQ._propertyIndexDic[GO._strings[Gd.getUint16()]];if(null==Gx)throw new Error("AnimationClipParser02:unknown property name.");var Gy=Gx<4,Gz=!Gy||Gy&&""===Gt[0];(Ga._cacheProperty=Gz)?Gq++:Gr++,Ga.propertyNameID=Gx;var GA=Gf[Gd.getUint8()];Ga.keyFrameWidth=GA/4;var GB=Ga.keyFrames=[],GC=GB.length=Gd.getUint16(),GD=null,GE=NaN;for(Gc=0;Gc<GC;Gc++){var GF=GB[Gc]=new GR;GE=GF.startTime=Gh[Gd.getUint16()];var GG=Gd.pos;GF.inTangent=new Float32Array(Ge.slice(GG,GG+GA)),Gd.pos+=GA,GG=Gd.pos,GF.outTangent=new Float32Array(Ge.slice(GG,GG+GA)),Gd.pos+=GA,GG=Gd.pos,GF.data=new Float32Array(Ge.slice(GG,GG+GA)),Gd.pos+=GA,GD&&(GD.next=GF,GD.duration=GE-GD.startTime),GD=GF}GF.next=null,GF.duration=Gk-GE}var GH=Gd.getUint16();for(Gb=0;Gb<GH;Gb++){var GI,GJ=new GP;GJ.time=Gd.getFloat32(),GJ.eventName=GO._strings[Gd.getUint16()];var GK=Gd.getUint16();for(0<GK&&(GJ.params=GI=[]),Gc=0;Gc<GK;Gc++){switch(Gd.getByte()){case 0:GI.push(!!Gd.getByte());break;case 1:GI.push(Gd.getInt32());break;case 2:GI.push(Gd.getFloat32());break;case 3:GI.push(GO._strings[Gd.getUint16()]);break;default:throw new Error("unknown type.")}}Gj.addEvent(GJ)}var GL=Gj._nodeToCachePropertyMap=new Int32Array(Gl),GM=Gj._cachePropertyMap=new Int32Array(Gq),GN=Gj._unCachePropertyMap=new Int32Array(Gr);for(Gq=Gr=0,Gb=0;Gb<Gl;Gb++)(Ga=Go[Gb])._cacheProperty?(GL[Gb]=Gq,GM[Gq++]=Gb):GN[Gr++]=Gb},GO._animationClip=null,GO._reader=null,GO._strings=[],Gl(GO,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var GP=function(){function Ga(){this.time=NaN,this.eventName=null,this.params=null}return Gp(Ga,"laya.d3.animation.AnimationEvent"),Ga}(),GQ=function(){function Gd(){this._childs=[],this.transform=new Gub(this)}Gp(Gd,"laya.d3.animation.AnimationNode");var Ga=Gd.prototype;return Gx.imps(Ga,{"laya.d3.core.IClone":!0}),Ga.addChild=function(Ga){Ga._parent=this,Ga.transform.setParent(this.transform),this._childs.push(Ga)},Ga.removeChild=function(Ga){var Gb=this._childs.indexOf(Ga);-1!==Gb&&this._childs.splice(Gb,1)},Ga.getChildByName=function(Ga){for(var Gb=0,Gc=this._childs.length;Gb<Gc;Gb++){var Gd=this._childs[Gb];if(Gd.name===Ga)return Gd}return null},Ga.getChildByIndex=function(Ga){return this._childs[Ga]},Ga.getChildCount=function(){return this._childs.length},Ga.cloneTo=function(Ga){var Gb=Ga;Gb.name=this.name;for(var Gc=0,Gd=this._childs.length;Gc<Gd;Gc++){var Ge=this._childs[Gc],Gf=Ge.clone();Gb.addChild(Gf);var Gg=Ge.transform,Gh=Gf.transform;Gh.setLocalPosition(Gg.getLocalPosition()),Gh.setLocalRotation(Gg.getLocalRotation()),Gh.setLocalScale(Gg.getLocalScale()),Gh._localRotationEuler=Gg._localRotationEuler,Gh._setWorldMatrixIgnoreUpdate(Gg.getWorldMatrix())}},Ga.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gd.__init__=function(){Gd.registerAnimationNodeProperty("localPosition",Gd._getLocalPosition,Gd._setLocalPosition),Gd.registerAnimationNodeProperty("localRotation",Gd._getLocalRotation,Gd._setLocalRotation),Gd.registerAnimationNodeProperty("localScale",Gd._getLocalScale,Gd._setLocalScale),Gd.registerAnimationNodeProperty("localRotationEuler",Gd._getLocalRotationEuler,Gd._setLocalRotationEuler),Gd.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",Gd._getParticleRenderSharedMaterialTintColor,Gd._setParticleRenderSharedMaterialTintColor),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",Gd._getMeshRenderSharedMaterialTilingOffset,Gd._setMeshRenderSharedMaterialTilingOffset),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",Gd._getMeshRenderSharedMaterialAlbedo,Gd._setMeshRenderSharedMaterialAlbedo),Gd.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",Gd._getSkinnedMeshRenderSharedMaterialTilingOffset,Gd._setSkinnedMeshRenderSharedMaterialTilingOffset),Gd.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",Gd._getSkinnedMeshRenderSharedMaterialAlbedo,Gd._setSkinnedMeshRenderSharedMaterialAlbedo),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",Gd._getMeshRenderSharedMaterialAlbedo,Gd._setMeshRenderSharedMaterialAlbedo),Gd.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",Gd._getSkinnedMeshRenderSharedMaterialAlbedo,Gd._setSkinnedMeshRenderSharedMaterialAlbedo),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",Gd._getMeshRenderSharedMaterialIntensity,Gd._setMeshRenderSharedMaterialIntensity),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",Gd._getMeshRenderSharedMaterialAlpha,Gd._setMeshRenderSharedMaterialAlpha),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",Gd._getMeshRenderSharedMaterialAlphaColor,Gd._setMeshRenderSharedMaterialAlphaColor),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",Gd._getMeshRenderSharedMaterialBaseColor,Gd._setMeshRenderSharedMaterialBaseColor),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",Gd._getMeshRenderSharedMaterialDissolve,Gd._setMeshRenderSharedMaterialDissolve),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",Gd._getMeshRenderSharedMaterialDissolveSpeed,Gd._setMeshRenderSharedMaterialDissolveSpeed),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",Gd._getMeshRenderSharedMaterialMMultiplier,Gd._setMeshRenderSharedMaterialMMultiplier),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",Gd._getMeshRenderSharedMaterialBaseScrollSpeedX,Gd._setMeshRenderSharedMaterialBaseScrollSpeedX),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",Gd._getMeshRenderSharedMaterialBaseScrollSpeedY,Gd._setMeshRenderSharedMaterialBaseScrollSpeedY),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",Gd._getMeshRenderSharedMaterialSecondScrollSpeedX,Gd._setMeshRenderSharedMaterialSecondScrollSpeedX),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",Gd._getMeshRenderSharedMaterialSecondScrollSpeedY,Gd._setMeshRenderSharedMaterialSecondScrollSpeedY),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",Gd._getMeshRenderSharedMaterialDetailTilingOffset,Gd._setMeshRenderSharedMaterialDetailTilingOffset),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",Gd._getMeshRenderSharedMaterialDissolveTilingOffset,Gd._setMeshRenderSharedMaterialDissolveTilingOffset),Gd.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",Gd._getMeshRenderSharedMaterialMaskTilingOffset,Gd._setMeshRenderSharedMaterialMaskTilingOffset)},Gd.registerAnimationNodeProperty=function(Ga,Gb,Gc){if(Gd._propertyIndexDic[Ga])throw new Error("AnimationNode: this propertyName has registered.");Gd._propertyIndexDic[Ga]=Gd._propertyIDCounter,Gd._propertyGetFuncs[Gd._propertyIDCounter]=Gb,Gd._propertySetFuncs[Gd._propertyIDCounter]=Gc,Gd._propertyIDCounter++},Gd._getLocalPosition=function(Ga,Gb){return Ga?Ga.transform.getLocalPosition():Gb._transform.localPosition.elements},Gd._setLocalPosition=function(Ga,Gb,Gc){if(Ga)Ga.transform.setLocalPosition(Gc);else{var Gd=Gb._transform,Ge=Gd.localPosition;Ge.elements=Gc,Gd.localPosition=Ge}},Gd._getLocalRotation=function(Ga,Gb){return Ga?Ga.transform.getLocalRotation():Gb._transform.localRotation.elements},Gd._setLocalRotation=function(Ga,Gb,Gc){if(Ga)Ga.transform.setLocalRotation(Gc);else{var Gd=Gb._transform,Ge=Gd.localRotation;Ge.elements=Gc,Gd.localRotation=Ge}},Gd._getLocalScale=function(Ga,Gb){return Ga?Ga.transform.getLocalScale():Gb._transform.localScale.elements},Gd._setLocalScale=function(Ga,Gb,Gc){if(Ga)Ga.transform.setLocalScale(Gc);else{var Gd=Gb._transform,Ge=Gd.localScale;Ge.elements=Gc,Gd.localScale=Ge}},Gd._getLocalRotationEuler=function(Ga,Gb){return Ga?Ga.transform.getLocalRotationEuler():Gb._transform.localRotationEuler.elements},Gd._setLocalRotationEuler=function(Ga,Gb,Gc){if(Ga)Ga.transform.setLocalRotationEuler(Gc);else{var Gd=Gb._transform,Ge=Gd.localRotationEuler;Ge.elements=Gc,Gd.localRotationEuler=Ge}},Gd._getMeshRenderSharedMaterialTilingOffset=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return Gb.meshRender.sharedMaterial.tilingOffset.elements},Gd._setMeshRenderSharedMaterialTilingOffset=function(Ga,Gb,Gc){var Gd,Ge;if(Ga){var Gf=Ga.transform._entity;Gf&&((Ge=(Gd=Gf.owner.meshRender.material).tilingOffset).elements=Gc,Gd.tilingOffset=Ge)}else(Ge=(Gd=Gb.meshRender.material).tilingOffset).elements=Gc,Gd.tilingOffset=Ge},Gd._getMeshRenderSharedMaterialAlbedo=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.albedoColor.elements:null}return Gb.meshRender.sharedMaterial.albedoColor.elements},Gd._setMeshRenderSharedMaterialAlbedo=function(Ga,Gb,Gc){var Gd,Ge;if(Ga){var Gf=Ga.transform._entity;Gf&&((Ge=(Gd=Gf.owner.meshRender.material).albedoColor).elements=Gc,Gd.albedoColor=Ge)}else(Ge=(Gd=Gb.meshRender.material).albedoColor).elements=Gc,Gd.albedoColor=Ge},Gd._getSkinnedMeshRenderSharedMaterialTilingOffset=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return Gb.skinnedMeshRender.sharedMaterial.tilingOffset.elements},Gd._setSkinnedMeshRenderSharedMaterialTilingOffset=function(Ga,Gb,Gc){var Gd,Ge;if(Ga){var Gf=Ga.transform._entity;Gf&&((Ge=(Gd=Gf.owner.skinnedMeshRender.material).tilingOffset).elements=Gc,Gd.tilingOffset=Ge)}else(Ge=(Gd=Gb.skinnedMeshRender.material).tilingOffset).elements=Gc,Gd.tilingOffset=Ge},Gd._getSkinnedMeshRenderSharedMaterialAlbedo=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return Gb.skinnedMeshRender.sharedMaterial.albedoColor.elements},Gd._setSkinnedMeshRenderSharedMaterialAlbedo=function(Ga,Gb,Gc){var Gd,Ge;if(Ga){var Gf=Ga.transform._entity;Gf&&((Ge=(Gd=Gf.owner.skinnedMeshRender.material).albedoColor).elements=Gc,Gd.albedoColor=Ge)}else(Ge=(Gd=Gb.skinnedMeshRender.material).albedoColor).elements=Gc,Gd.albedoColor=Ge},Gd._getParticleRenderSharedMaterialTintColor=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.particleRender.sharedMaterial.tintColor.elements:null}return Gb.particleRender.sharedMaterial.tintColor.elements},Gd._setParticleRenderSharedMaterialTintColor=function(Ga,Gb,Gc){var Gd,Ge;if(Ga){var Gf=Ga.transform._entity;Gf&&((Ge=(Gd=Gf.owner.particleRender.material).tintColor).elements=Gc,Gd.tintColor=Ge)}else(Ge=(Gd=Gb.particleRender.material).tintColor).elements=Gc,Gd.tintColor=Ge},Gd._getMeshRenderSharedMaterialAlphaColor=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.alphaColor.elements:null}return Gb.meshRender.sharedMaterial.alphaColor.elements},Gd._setMeshRenderSharedMaterialAlphaColor=function(Ga,Gb,Gc){var Gd,Ge;if(Ga){var Gf=Ga.transform._entity;Gf&&((Ge=(Gd=Gf.owner.meshRender.material).alphaColor).elements=Gc,Gd.alphaColor=Ge)}else(Ge=(Gd=Gb.meshRender.material).alphaColor).elements=Gc,Gd.alphaColor=Ge},Gd._getMeshRenderSharedMaterialBaseColor=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.baseColor.elements:null}return Gb.meshRender.sharedMaterial.baseColor.elements},Gd._setMeshRenderSharedMaterialBaseColor=function(Ga,Gb,Gc){var Gd,Ge;if(Ga){var Gf=Ga.transform._entity;Gf&&((Ge=(Gd=Gf.owner.meshRender.material).baseColor).elements=Gc,Gd.baseColor=Ge)}else(Ge=(Gd=Gb.meshRender.material).baseColor).elements=Gc,Gd.baseColor=Ge},Gd._getMeshRenderSharedMaterialDissolve=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.dissolve:0}return Gb.meshRender.sharedMaterial.dissolve},Gd._setMeshRenderSharedMaterialDissolve=function(Ga,Gb,Gc){if(Ga){var Gd=Ga.transform._entity;Gd&&(Gd.owner.meshRender.material.dissolve=Gc[0])}else Gb.meshRender.material.dissolve=Gc[0]},Gd._getMeshRenderSharedMaterialDissolveSpeed=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.dissolveSpeed:0}return Gb.meshRender.sharedMaterial.dissolveSpeed},Gd._setMeshRenderSharedMaterialDissolveSpeed=function(Ga,Gb,Gc){if(Ga){var Gd=Ga.transform._entity;Gd&&(Gd.owner.meshRender.material.dissolveSpeed=Gc[0])}else Gb.meshRender.material.dissolveSpeed=Gc[0]},Gd._getMeshRenderSharedMaterialMMultiplier=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.mMultiplier:0}return Gb.meshRender.sharedMaterial.mMultiplier},Gd._setMeshRenderSharedMaterialMMultiplier=function(Ga,Gb,Gc){if(Ga){var Gd=Ga.transform._entity;Gd&&(Gd.owner.meshRender.material.mMultiplier=Gc[0])}else Gb.meshRender.material.mMultiplier=Gc[0]},Gd._getMeshRenderSharedMaterialBaseScrollSpeedX=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return Gb.meshRender.sharedMaterial.baseScrollSpeedX},Gd._setMeshRenderSharedMaterialBaseScrollSpeedX=function(Ga,Gb,Gc){if(Ga){var Gd=Ga.transform._entity;Gd&&(Gd.owner.meshRender.material.baseScrollSpeedX=Gc[0])}else Gb.meshRender.material.baseScrollSpeedX=Gc[0]},Gd._getMeshRenderSharedMaterialBaseScrollSpeedY=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return Gb.meshRender.sharedMaterial.baseScrollSpeedY},Gd._setMeshRenderSharedMaterialBaseScrollSpeedY=function(Ga,Gb,Gc){if(Ga){var Gd=Ga.transform._entity;Gd&&(Gd.owner.meshRender.material.baseScrollSpeedY=Gc[0])}else Gb.meshRender.material.baseScrollSpeedY=Gc[0]},Gd._getMeshRenderSharedMaterialSecondScrollSpeedX=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return Gb.meshRender.sharedMaterial.secondScrollSpeedX},Gd._setMeshRenderSharedMaterialSecondScrollSpeedX=function(Ga,Gb,Gc){if(Ga){var Gd=Ga.transform._entity;Gd&&(Gd.owner.meshRender.material.secondScrollSpeedX=Gc[0])}else Gb.meshRender.material.secondScrollSpeedX=Gc[0]},Gd._getMeshRenderSharedMaterialSecondScrollSpeedY=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return Gb.meshRender.sharedMaterial.secondScrollSpeedY},Gd._setMeshRenderSharedMaterialSecondScrollSpeedY=function(Ga,Gb,Gc){if(Ga){var Gd=Ga.transform._entity;Gd&&(Gd.owner.meshRender.material.secondScrollSpeedY=Gc[0])}else Gb.meshRender.material.secondScrollSpeedY=Gc[0]},Gd._getMeshRenderSharedMaterialAlpha=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.alpha:0}return Gb.meshRender.sharedMaterial.alpha},Gd._setMeshRenderSharedMaterialAlpha=function(Ga,Gb,Gc){if(Ga){var Gd=Ga.transform._entity;Gd&&(Gd.owner.meshRender.material.alpha=Gc[0])}else Gb.meshRender.material.alpha=Gc[0]},Gd._getMeshRenderSharedMaterialIntensity=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.intensity:0}return Gb.meshRender.sharedMaterial.intensity},Gd._setMeshRenderSharedMaterialIntensity=function(Ga,Gb,Gc){if(Ga){var Gd=Ga.transform._entity;Gd&&(Gd.owner.meshRender.material.intensity=Gc[0])}else Gb.meshRender.material.intensity=Gc[0]},Gd._getMeshRenderSharedMaterialDetailTilingOffset=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return Gb.meshRender.sharedMaterial.detailTilingOffset.elements},Gd._setMeshRenderSharedMaterialDetailTilingOffset=function(Ga,Gb,Gc){var Gd,Ge;if(Ga){var Gf=Ga.transform._entity;Gf&&((Ge=(Gd=Gf.owner.meshRender.material).detailTilingOffset).elements=Gc,Gd.detailTilingOffset=Ge)}else(Ge=(Gd=Gb.meshRender.material).detailTilingOffset).elements=Gc,Gd.detailTilingOffset=Ge},Gd._getMeshRenderSharedMaterialDissolveTilingOffset=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return Gb.meshRender.sharedMaterial.dissolveTilingOffset.elements},Gd._setMeshRenderSharedMaterialDissolveTilingOffset=function(Ga,Gb,Gc){var Gd,Ge;if(Ga){var Gf=Ga.transform._entity;Gf&&((Ge=(Gd=Gf.owner.meshRender.material).dissolveTilingOffset).elements=Gc,Gd.dissolveTilingOffset=Ge)}else(Ge=(Gd=Gb.meshRender.material).dissolveTilingOffset).elements=Gc,Gd.dissolveTilingOffset=Ge},Gd._getMeshRenderSharedMaterialMaskTilingOffset=function(Ga,Gb){if(Ga){var Gc=Ga.transform._entity;return Gc?Gc.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return Gb.meshRender.sharedMaterial.maskTilingOffset.elements},Gd._setMeshRenderSharedMaterialMaskTilingOffset=function(Ga,Gb,Gc){var Gd,Ge;if(Ga){var Gf=Ga.transform._entity;Gf&&((Ge=(Gd=Gf.owner.meshRender.material).maskTilingOffset).elements=Gc,Gd.maskTilingOffset=Ge)}else(Ge=(Gd=Gb.meshRender.material).maskTilingOffset).elements=Gc,Gd.maskTilingOffset=Ge},Gd._propertyIDCounter=0,Gd._propertyIndexDic={},Gd._propertySetFuncs=[],Gd._propertyGetFuncs=[],Gd}(),GR=function(){function Ga(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return Gp(Ga,"laya.d3.animation.Keyframe"),Ga}(),GS=function(){function Ga(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return Gp(Ga,"laya.d3.animation.KeyframeNode"),Ga}(),GI=(function(){function Ga(){this._tempVector30=new Ggb,this._tempVector31=new Ggb,this._tempVector32=new Ggb,this._a=new Ggb,this._b=new Ggb,this._c=new Ggb,this._d=new Ggb}Gp(Ga,"laya.d3.core.glitter.SplineCurvePositionVelocity");var Gb=Ga.prototype;Gb.Init=function(Ga,Gb,Gc,Gd){Ga.cloneTo(this._d),Gb.cloneTo(this._c),Ggb.scale(Ga,2,this._a),Ggb.scale(Gc,2,this._tempVector30),Ggb.subtract(this._a,this._tempVector30,this._a),Ggb.add(this._a,Gb,this._a),Ggb.add(this._a,Gd,this._a),Ggb.scale(Gc,3,this._b),Ggb.scale(Ga,3,this._tempVector30),Ggb.subtract(this._b,this._tempVector30,this._b),Ggb.subtract(this._b,Gd,this._b),Ggb.scale(Gb,2,this._tempVector30),Ggb.subtract(this._b,this._tempVector30,this._b)},Gb.Slerp=function(Ga,Gb){Ggb.scale(this._a,Ga*Ga*Ga,this._tempVector30),Ggb.scale(this._b,Ga*Ga,this._tempVector31),Ggb.scale(this._c,Ga,this._tempVector32),Ggb.add(this._tempVector30,this._tempVector31,Gb),Ggb.add(Gb,this._tempVector32,Gb),Ggb.add(Gb,this._d,Gb)}}(),function(){function GM(Ga,Gb,Gc,Gd){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=Ga,this._h=Gb,this._minHeight=Gc,this._maxHeight=Gd}Gp(GM,"laya.d3.core.HeightMap");var Ga=GM.prototype;Ga._inBounds=function(Ga,Gb){return 0<=Ga&&Ga<this._h&&0<=Gb&&Gb<this._w},Ga.getHeight=function(Ga,Gb){return this._inBounds(Ga,Gb)?this._datas[Ga][Gb]:NaN},Gq(0,Ga,"width",function(){return this._w}),Gq(0,Ga,"height",function(){return this._h}),Gq(0,Ga,"maxHeight",function(){return this._maxHeight}),Gq(0,Ga,"minHeight",function(){return this._minHeight}),GM.creatFromMesh=function(Ga,Gb,Gc,Gd){for(var Ge=[],Gf=[],Gg=Ga.getSubMeshCount(),Gh=0;Gh<Gg;Gh++){for(var Gi=Ga.getSubMesh(Gh),Gj=Gi._getVertexBuffer(),Gk=Gj.getData(),Gl=[],Go=0;Go<Gk.length;Go+=Gj.vertexDeclaration.vertexStride/4){var Gp=new Ggb(Gk[Go+0],Gk[Go+1],Gk[Go+2]);Gl.push(Gp)}Ge.push(Gl);var Gq=Gi._getIndexBuffer();Gf.push(Gq.getData())}var Gr=Ga.boundingBox,Gs=Gr.min.x,Gt=Gr.min.z,Gu=Gr.max.x,Gv=Gr.max.z,Gw=Gr.min.y,Gx=Gr.max.y,Gy=Gu-Gs,Gz=Gv-Gt,GA=Gd.elements[0]=Gy/(Gb-1),GB=Gd.elements[1]=Gz/(Gc-1),GC=new GM(Gb,Gc,Gw,Gx),GD=GM._tempRay,GE=GD.direction.elements;GE[0]=0,GE[1]=-1,GE[2]=0;var GF=Gx+.1;GD.origin.elements[1]=GF;for(var GG=0;GG<Gc;GG++){var GH=Gt+GG*GB;GC._datas[GG]=[];for(var GI=0;GI<Gb;GI++){var GJ=Gs+GI*GA,GK=GD.origin.elements;GK[0]=GJ,GK[2]=GH;var GL=GM._getPosition(GD,Ge,Gf);GC._datas[GG][GI]=GL===Number.MAX_VALUE?NaN:GF-GL}}return GC},GM.createFromImage=function(Ga,Gb,Gc){for(var Gd=Ga.width,Ge=Ga.height,Gf=new GM(Gd,Ge,Gb,Gc),Gg=(Gc-Gb)/254,Gh=Ga.getPixels(),Gi=0,Gj=0;Gj<Ge;Gj++)for(var Gk=Gf._datas[Gj]=[],Gl=0;Gl<Gd;Gl++){var Go=Gh[Gi++],Gp=Gh[Gi++],Gq=Gh[Gi++],Gr=Gh[Gi++];Gk[Gl]=255==Go&&255==Gp&&255==Gq&&255==Gr?NaN:(Go+Gp+Gq)/3*Gg+Gb}return Gf},GM._getPosition=function(Ga,Gb,Gc){for(var Gd=Number.MAX_VALUE,Ge=0;Ge<Gb.length;Ge++)for(var Gf=Gb[Ge],Gg=Gc[Ge],Gh=0;Gh<Gg.length;Gh+=3){var Gi=Gf[Gg[Gh+0]],Gj=Gf[Gg[Gh+1]],Gk=Gf[Gg[Gh+2]],Gl=Gqb.rayIntersectsTriangle(Ga,Gi,Gj,Gk);!isNaN(Gl)&&Gl<Gd&&(Gd=Gl)}return Gd},Gl(GM,["_tempRay",function(){return this._tempRay=new Geb(new Ggb,new Ggb)}])}(),function(){function Ge(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}Gp(Ge,"laya.d3.core.Layer");var Ga=Ge.prototype;return Ga._binarySearchIndex=function(){for(var Ga=0,Gb=Ge._collsionTestList.length-1,Gc=0;Ga<=Gb;){Gc=Math.floor((Ga+Gb)/2);var Gd=Ge._collsionTestList[Gc];if(Gd==this._number)return Gc;Gd>this._number?Gb=Gc-1:Ga=Gc+1}return Ga},Ga._addCollider=function(Ga){0===this._colliders.length&&Ge._collsionTestList.splice(this._binarySearchIndex(),0,this._number),Ga._isRigidbody?(this._colliders.unshift(Ga),this._nonRigidbodyOffset++):this._colliders.push(Ga)},Ga._removeCollider=function(Ga){var Gb=this._colliders.indexOf(Ga);Gb<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(Gb,1),0===this._colliders.length&&Ge._collsionTestList.splice(Ge._collsionTestList.indexOf(this._number),1)},Gq(0,Ga,"number",function(){return this._number}),Gq(0,Ga,"visible",function(){return this._visible},function(Ga){this._visible=Ga,Ge._visibleLayers=Ga?Ge._visibleLayers|this.mask:Ge._visibleLayers&~this.mask}),Gq(0,Ga,"mask",function(){return this._mask}),Gq(1,Ge,"visibleLayers",function(){return Ge._visibleLayers},function(Ga){Ge._visibleLayers=Ga;for(var Gb=0,Gc=Ge._layerList.length;Gb<Gc;Gb++){var Gd=Ge._layerList[Gb];Gd._visible=0!=(Gd._mask&Ge._visibleLayers)}}),Ge.__init__=function(){Ge._layerList.length=31;for(var Ga=0;Ga<31;Ga++){var Gb=new Ge;Ge._layerList[Ga]=Gb,0===Ga?(Gb.name="Default Layer",Gb.visible=!0):(Gb.name="Layer-"+Ga,Gb.visible=!1),Gb._number=Ga,Gb._mask=Math.pow(2,Ga)}Ge.currentCreationLayer=Ge._layerList[0]},Ge.getLayerByNumber=function(Ga){if(Ga<0||30<Ga)throw new Error("无法返回指定Layer，该number超出范围！");return Ge._layerList[Ga]},Ge.getLayerByName=function(Ga){for(var Gb=0;Gb<31;Gb++)if(Ge._layerList[Gb].name===Ga)return Ge._layerList[Gb];throw new Error("无法返回指定Layer,该name不存在")},Ge.isVisible=function(Ga){return 0!=(Ga&Ge._currentCameraCullingMask&Ge._visibleLayers)},Ge._layerList=[],Ge._visibleLayers=2147483647,Ge._collsionTestList=[],Ge._currentCameraCullingMask=2147483647,Ge.maxCount=31,Ge.currentCreationLayer=null,Ge}()),GJ=(function(){function Ga(Ga,Gb,Gc){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=Ga,this._minCount=Gb,this._maxCount=Gc}Gp(Ga,"laya.d3.core.particleShuriKen.module.Burst");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb.cloneTo=function(Ga){var Gb=Ga;Gb._time=this._time,Gb._minCount=this._minCount,Gb._maxCount=this._maxCount},Gb.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Gb,"time",function(){return this._time}),Gq(0,Gb,"minCount",function(){return this._minCount}),Gq(0,Gb,"maxCount",function(){return this._maxCount})}(),function(){function Ga(Ga){this._color=null,this.enbale=!1,this._color=Ga}Gp(Ga,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var Gb=Ga.prototype;Gb.cloneTo=function(Ga){var Gb=Ga;this._color.cloneTo(Gb._color),Gb.enbale=this.enbale},Gb.clone=function(){var Ga;switch(this._color.type){case 0:Ga=GL.createByConstant(this._color.constant.clone());break;case 1:Ga=GL.createByGradient(this._color.gradient.clone());break;case 2:Ga=GL.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:Ga=GL.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var Gb=new this.constructor(Ga);return Gb.enbale=this.enbale,Gb},Gq(0,Gb,"color",function(){return this._color})}(),function(){function Ga(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}Gp(Ga,"laya.d3.core.particleShuriKen.module.Emission");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),Gb._destroy=function(){this._bursts=null,this._destroyed=!0},Gb.getBurstsCount=function(){return this._bursts.length},Gb.getBurstByIndex=function(Ga){return this._bursts[Ga]},Gb.addBurst=function(Ga){var Gb=this._bursts.length;if(0<Gb)for(var Gc=0;Gc<Gb;Gc++)this._bursts[Gc].time>Ga.time&&this._bursts.splice(Gc,0,Ga);this._bursts.push(Ga)},Gb.removeBurst=function(Ga){var Gb=this._bursts.indexOf(Ga);-1!==Gb&&this._bursts.splice(Gb,1)},Gb.removeBurstByIndex=function(Ga){this._bursts.splice(Ga,1)},Gb.clearBurst=function(){this._bursts.length=0},Gb.cloneTo=function(Ga){var Gb=Ga,Gc=Gb._bursts;Gc.length=this._bursts.length;for(var Gd=0,Ge=this._bursts.length;Gd<Ge;Gd++){var Gf=Gc[Gd];Gf?this._bursts[Gd].cloneTo(Gf):Gc[Gd]=this._bursts[Gd].clone()}Gb._emissionRate=this._emissionRate,Gb.enbale=this.enbale},Gb.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Gb,"destroyed",function(){return this._destroyed}),Gq(0,Gb,"emissionRate",function(){return this._emissionRate},function(Ga){if(Ga<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=Ga})}(),function(){function Gd(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}Gp(Gd,"laya.d3.core.particleShuriKen.module.FrameOverTime");var Ga=Gd.prototype;return Gx.imps(Ga,{"laya.d3.core.IClone":!0}),Ga.cloneTo=function(Ga){var Gb=Ga;Gb._type=this._type,Gb._constant=this._constant,this._overTime.cloneTo(Gb._overTime),Gb._constantMin=this._constantMin,Gb._constantMax=this._constantMax,this._overTimeMin.cloneTo(Gb._overTimeMin),this._overTimeMax.cloneTo(Gb._overTimeMax)},Ga.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Ga,"frameOverTimeData",function(){return this._overTime}),Gq(0,Ga,"constant",function(){return this._constant}),Gq(0,Ga,"type",function(){return this._type}),Gq(0,Ga,"frameOverTimeDataMin",function(){return this._overTimeMin}),Gq(0,Ga,"constantMin",function(){return this._constantMin}),Gq(0,Ga,"frameOverTimeDataMax",function(){return this._overTimeMax}),Gq(0,Ga,"constantMax",function(){return this._constantMax}),Gd.createByConstant=function(Ga){var Gb=new Gd;return Gb._type=0,Gb._constant=Ga,Gb},Gd.createByOverTime=function(Ga){var Gb=new Gd;return Gb._type=1,Gb._overTime=Ga,Gb},Gd.createByRandomTwoConstant=function(Ga,Gb){var Gc=new Gd;return Gc._type=2,Gc._constantMin=Ga,Gc._constantMax=Gb,Gc},Gd.createByRandomTwoOverTime=function(Ga,Gb){var Gc=new Gd;return Gc._type=3,Gc._overTimeMin=Ga,Gc._overTimeMax=Gb,Gc},Gd}()),GK=function(){function Gj(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}Gp(Gj,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var Ga=Gj.prototype;return Gx.imps(Ga,{"laya.d3.core.IClone":!0}),Ga.cloneTo=function(Ga){var Gb=Ga;Gb._type=this._type,Gb._separateAxes=this._separateAxes,Gb._constant=this._constant,this._constantSeparate.cloneTo(Gb._constantSeparate),this._gradient.cloneTo(Gb._gradient),this._gradientX.cloneTo(Gb._gradientX),this._gradientY.cloneTo(Gb._gradientY),this._gradientZ.cloneTo(Gb._gradientZ),Gb._constantMin=this._constantMin,Gb._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(Gb._constantMinSeparate),this._constantMaxSeparate.cloneTo(Gb._constantMaxSeparate),this._gradientMin.cloneTo(Gb._gradientMin),this._gradientMax.cloneTo(Gb._gradientMax),this._gradientXMin.cloneTo(Gb._gradientXMin),this._gradientXMax.cloneTo(Gb._gradientXMax),this._gradientYMin.cloneTo(Gb._gradientYMin),this._gradientYMax.cloneTo(Gb._gradientYMax),this._gradientZMin.cloneTo(Gb._gradientZMin),this._gradientZMax.cloneTo(Gb._gradientZMax)},Ga.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Ga,"gradientZ",function(){return this._gradientZ}),Gq(0,Ga,"constant",function(){return this._constant}),Gq(0,Ga,"gradient",function(){return this._gradient}),Gq(0,Ga,"separateAxes",function(){return this._separateAxes}),Gq(0,Ga,"type",function(){return this._type}),Gq(0,Ga,"constantSeparate",function(){return this._constantSeparate}),Gq(0,Ga,"gradientX",function(){return this._gradientX}),Gq(0,Ga,"gradientY",function(){return this._gradientY}),Gq(0,Ga,"gradientW",function(){return this._gradientW}),Gq(0,Ga,"gradientMin",function(){return this._gradientMin}),Gq(0,Ga,"constantMin",function(){return this._constantMin}),Gq(0,Ga,"gradientMax",function(){return this._gradientMax}),Gq(0,Ga,"constantMax",function(){return this._constantMax}),Gq(0,Ga,"gradientWMin",function(){return this._gradientWMin}),Gq(0,Ga,"constantMinSeparate",function(){return this._constantMinSeparate}),Gq(0,Ga,"constantMaxSeparate",function(){return this._constantMaxSeparate}),Gq(0,Ga,"gradientXMin",function(){return this._gradientXMin}),Gq(0,Ga,"gradientXMax",function(){return this._gradientXMax}),Gq(0,Ga,"gradientWMax",function(){return this._gradientWMax}),Gq(0,Ga,"gradientYMin",function(){return this._gradientYMin}),Gq(0,Ga,"gradientYMax",function(){return this._gradientYMax}),Gq(0,Ga,"gradientZMin",function(){return this._gradientZMin}),Gq(0,Ga,"gradientZMax",function(){return this._gradientZMax}),Gj.createByConstant=function(Ga){var Gb=new Gj;return Gb._type=0,Gb._separateAxes=!1,Gb._constant=Ga,Gb},Gj.createByConstantSeparate=function(Ga){var Gb=new Gj;return Gb._type=0,Gb._separateAxes=!0,Gb._constantSeparate=Ga,Gb},Gj.createByGradient=function(Ga){var Gb=new Gj;return Gb._type=1,Gb._separateAxes=!1,Gb._gradient=Ga,Gb},Gj.createByGradientSeparate=function(Ga,Gb,Gc,Gd){var Ge=new Gj;return Ge._type=1,Ge._separateAxes=!0,Ge._gradientX=Ga,Ge._gradientY=Gb,Ge._gradientZ=Gc,Ge._gradientW=Gd,Ge},Gj.createByRandomTwoConstant=function(Ga,Gb){var Gc=new Gj;return Gc._type=2,Gc._separateAxes=!1,Gc._constantMin=Ga,Gc._constantMax=Gb,Gc},Gj.createByRandomTwoConstantSeparate=function(Ga,Gb){var Gc=new Gj;return Gc._type=2,Gc._separateAxes=!0,Gc._constantMinSeparate=Ga,Gc._constantMaxSeparate=Gb,Gc},Gj.createByRandomTwoGradient=function(Ga,Gb){var Gc=new Gj;return Gc._type=3,Gc._separateAxes=!1,Gc._gradientMin=Ga,Gc._gradientMax=Gb,Gc},Gj.createByRandomTwoGradientSeparate=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){var Gi=new Gj;return Gi._type=3,Gi._separateAxes=!0,Gi._gradientXMin=Ga,Gi._gradientXMax=Gb,Gi._gradientYMin=Gc,Gi._gradientYMax=Gd,Gi._gradientZMin=Ge,Gi._gradientZMax=Gf,Gi._gradientWMin=Gg,Gi._gradientWMax=Gh,Gi},Gj}(),GL=function(){function Gd(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}Gp(Gd,"laya.d3.core.particleShuriKen.module.GradientColor");var Ga=Gd.prototype;return Gx.imps(Ga,{"laya.d3.core.IClone":!0}),Ga.cloneTo=function(Ga){var Gb=Ga;Gb._type=this._type,this._constant.cloneTo(Gb._constant),this._constantMin.cloneTo(Gb._constantMin),this._constantMax.cloneTo(Gb._constantMax),this._gradient.cloneTo(Gb._gradient),this._gradientMin.cloneTo(Gb._gradientMin),this._gradientMax.cloneTo(Gb._gradientMax)},Ga.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Ga,"gradient",function(){return this._gradient}),Gq(0,Ga,"constant",function(){return this._constant}),Gq(0,Ga,"type",function(){return this._type}),Gq(0,Ga,"gradientMin",function(){return this._gradientMin}),Gq(0,Ga,"constantMin",function(){return this._constantMin}),Gq(0,Ga,"gradientMax",function(){return this._gradientMax}),Gq(0,Ga,"constantMax",function(){return this._constantMax}),Gd.createByConstant=function(Ga){var Gb=new Gd;return Gb._type=0,Gb._constant=Ga,Gb},Gd.createByGradient=function(Ga){var Gb=new Gd;return Gb._type=1,Gb._gradient=Ga,Gb},Gd.createByRandomTwoConstant=function(Ga,Gb){var Gc=new Gd;return Gc._type=2,Gc._constantMin=Ga,Gc._constantMax=Gb,Gc},Gd.createByRandomTwoGradient=function(Ga,Gb){var Gc=new Gd;return Gc._type=3,Gc._gradientMin=Ga,Gc._gradientMax=Gb,Gc},Gd}(),GM=(function(){function Ga(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}Gp(Ga,"laya.d3.core.particleShuriKen.module.GradientDataColor");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb.addAlpha=function(Ga,Gb){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==Ga&&(Ga=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=Ga,this._alphaElements[this._alphaCurrentLength++]=Gb):DEBUG},Gb.addRGB=function(Ga,Gb){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==Ga&&(Ga=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=Ga,this._rgbElements[this._rgbCurrentLength++]=Gb.x,this._rgbElements[this._rgbCurrentLength++]=Gb.y,this._rgbElements[this._rgbCurrentLength++]=Gb.z):DEBUG},Gb.cloneTo=function(Ga){var Gb=Ga,Gc=0,Gd=0;Gb._alphaCurrentLength=this._alphaCurrentLength;var Ge=Gb._alphaElements;for(Ge.length=this._alphaElements.length,Gc=0,Gd=this._alphaElements.length;Gc<Gd;Gc++)Ge[Gc]=this._alphaElements[Gc];Gb._rgbCurrentLength=this._rgbCurrentLength;var Gf=Gb._rgbElements;for(Gf.length=this._rgbElements.length,Gc=0,Gd=this._rgbElements.length;Gc<Gd;Gc++)Gf[Gc]=this._rgbElements[Gc]},Gb.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Gb,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),Gq(0,Gb,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function Ga(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}Gp(Ga,"laya.d3.core.particleShuriKen.module.GradientDataInt");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb.add=function(Ga,Gb){this._currentLength<8?(6===this._currentLength&&1!==Ga&&(Ga=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=Ga,this._elements[this._currentLength++]=Gb):console.log("Warning:data count must lessEqual than 4")},Gb.cloneTo=function(Ga){var Gb=Ga;Gb._currentLength=this._currentLength;var Gc=Gb._elements;Gc.length=this._elements.length;for(var Gd=0,Ge=this._elements.length;Gd<Ge;Gd++)Gc[Gd]=this._elements[Gd]},Gb.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Gb,"gradientCount",function(){return this._currentLength/2})}(),function(){function Ga(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}Gp(Ga,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb.add=function(Ga,Gb){this._currentLength<8?(6===this._currentLength&&1!==Ga&&(Ga=1,DEBUG),this._elements[this._currentLength++]=Ga,this._elements[this._currentLength++]=Gb):DEBUG},Gb.getKeyByIndex=function(Ga){return this._elements[2*Ga]},Gb.getValueByIndex=function(Ga){return this._elements[2*Ga+1]},Gb.getAverageValue=function(){for(var Ga=0,Gb=this._currentLength-2;Ga<Gb;Ga+=2){this._elements[Ga+1];this._elements[Ga+3],this._elements[Ga+2]-this._elements[Ga]}return 0},Gb.cloneTo=function(Ga){var Gb=Ga;Gb._currentLength=this._currentLength;var Gc=Gb._elements;Gc.length=this._elements.length;for(var Gd=0,Ge=this._elements.length;Gd<Ge;Gd++)Gc[Gd]=this._elements[Gd]},Gb.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Gb,"gradientCount",function(){return this._currentLength/2})}(),function(){function Ga(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}Gp(Ga,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb.add=function(Ga,Gb){this._currentLength<8?(6===this._currentLength&&1!==Ga&&(Ga=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=Ga,this._elements[this._currentLength++]=Gb.x,this._elements[this._currentLength++]=Gb.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},Gb.cloneTo=function(Ga){var Gb=Ga;Gb._currentLength=this._currentLength;var Gc=Gb._elements;Gc.length=this._elements.length;for(var Gd=0,Ge=this._elements.length;Gd<Ge;Gd++)Gc[Gd]=this._elements[Gd]},Gb.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Gb,"gradientCount",function(){return this._currentLength/3})}(),function(){function Gh(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}Gp(Gh,"laya.d3.core.particleShuriKen.module.GradientSize");var Ga=Gh.prototype;return Gx.imps(Ga,{"laya.d3.core.IClone":!0}),Ga.getMaxSizeInGradient=function(){var Ga=0,Gb=0,Gc=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(Ga=0,Gb=this._gradientX.gradientCount;Ga<Gb;Ga++)Gc=Math.max(Gc,this._gradientX.getValueByIndex(Ga));for(Ga=0,Gb=this._gradientY.gradientCount;Ga<Gb;Ga++)Gc=Math.max(Gc,this._gradientY.getValueByIndex(Ga))}else for(Ga=0,Gb=this._gradient.gradientCount;Ga<Gb;Ga++)Gc=Math.max(Gc,this._gradient.getValueByIndex(Ga));break;case 1:Gc=this._separateAxes?(Gc=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),Gc=Math.max(Gc,this._constantMinSeparate.y),Math.max(Gc,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(Ga=0,Gb=this._gradientXMin.gradientCount;Ga<Gb;Ga++)Gc=Math.max(Gc,this._gradientXMin.getValueByIndex(Ga));for(Ga=0,Gb=this._gradientXMax.gradientCount;Ga<Gb;Ga++)Gc=Math.max(Gc,this._gradientXMax.getValueByIndex(Ga));for(Ga=0,Gb=this._gradientYMin.gradientCount;Ga<Gb;Ga++)Gc=Math.max(Gc,this._gradientYMin.getValueByIndex(Ga));for(Ga=0,Gb=this._gradientZMax.gradientCount;Ga<Gb;Ga++)Gc=Math.max(Gc,this._gradientZMax.getValueByIndex(Ga))}else{for(Ga=0,Gb=this._gradientMin.gradientCount;Ga<Gb;Ga++)Gc=Math.max(Gc,this._gradientMin.getValueByIndex(Ga));for(Ga=0,Gb=this._gradientMax.gradientCount;Ga<Gb;Ga++)Gc=Math.max(Gc,this._gradientMax.getValueByIndex(Ga))}}return Gc},Ga.cloneTo=function(Ga){var Gb=Ga;Gb._type=this._type,Gb._separateAxes=this._separateAxes,this._gradient.cloneTo(Gb._gradient),this._gradientX.cloneTo(Gb._gradientX),this._gradientY.cloneTo(Gb._gradientY),this._gradientZ.cloneTo(Gb._gradientZ),Gb._constantMin=this._constantMin,Gb._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(Gb._constantMinSeparate),this._constantMaxSeparate.cloneTo(Gb._constantMaxSeparate),this._gradientMin.cloneTo(Gb._gradientMin),this._gradientMax.cloneTo(Gb._gradientMax),this._gradientXMin.cloneTo(Gb._gradientXMin),this._gradientXMax.cloneTo(Gb._gradientXMax),this._gradientYMin.cloneTo(Gb._gradientYMin),this._gradientYMax.cloneTo(Gb._gradientYMax),this._gradientZMin.cloneTo(Gb._gradientZMin),this._gradientZMax.cloneTo(Gb._gradientZMax)},Ga.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Ga,"gradientZ",function(){return this._gradientZ}),Gq(0,Ga,"gradient",function(){return this._gradient}),Gq(0,Ga,"separateAxes",function(){return this._separateAxes}),Gq(0,Ga,"type",function(){return this._type}),Gq(0,Ga,"gradientMin",function(){return this._gradientMin}),Gq(0,Ga,"constantMin",function(){return this._constantMin}),Gq(0,Ga,"gradientX",function(){return this._gradientX}),Gq(0,Ga,"gradientY",function(){return this._gradientY}),Gq(0,Ga,"gradientMax",function(){return this._gradientMax}),Gq(0,Ga,"constantMax",function(){return this._constantMax}),Gq(0,Ga,"constantMinSeparate",function(){return this._constantMinSeparate}),Gq(0,Ga,"constantMaxSeparate",function(){return this._constantMaxSeparate}),Gq(0,Ga,"gradientXMin",function(){return this._gradientXMin}),Gq(0,Ga,"gradientXMax",function(){return this._gradientXMax}),Gq(0,Ga,"gradientYMin",function(){return this._gradientYMin}),Gq(0,Ga,"gradientYMax",function(){return this._gradientYMax}),Gq(0,Ga,"gradientZMin",function(){return this._gradientZMin}),Gq(0,Ga,"gradientZMax",function(){return this._gradientZMax}),Gh.createByGradient=function(Ga){var Gb=new Gh;return Gb._type=0,Gb._separateAxes=!1,Gb._gradient=Ga,Gb},Gh.createByGradientSeparate=function(Ga,Gb,Gc){var Gd=new Gh;return Gd._type=0,Gd._separateAxes=!0,Gd._gradientX=Ga,Gd._gradientY=Gb,Gd._gradientZ=Gc,Gd},Gh.createByRandomTwoConstant=function(Ga,Gb){var Gc=new Gh;return Gc._type=1,Gc._separateAxes=!1,Gc._constantMin=Ga,Gc._constantMax=Gb,Gc},Gh.createByRandomTwoConstantSeparate=function(Ga,Gb){var Gc=new Gh;return Gc._type=1,Gc._separateAxes=!0,Gc._constantMinSeparate=Ga,Gc._constantMaxSeparate=Gb,Gc},Gh.createByRandomTwoGradient=function(Ga,Gb){var Gc=new Gh;return Gc._type=2,Gc._separateAxes=!1,Gc._gradientMin=Ga,Gc._gradientMax=Gb,Gc},Gh.createByRandomTwoGradientSeparate=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=new Gh;return Gg._type=2,Gg._separateAxes=!0,Gg._gradientXMin=Ga,Gg._gradientXMax=Gb,Gg._gradientYMin=Gc,Gg._gradientYMax=Gd,Gg._gradientZMin=Ge,Gg._gradientZMax=Gf,Gg},Gh}()),GN=function(){function Gh(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}Gp(Gh,"laya.d3.core.particleShuriKen.module.GradientVelocity");var Ga=Gh.prototype;return Gx.imps(Ga,{"laya.d3.core.IClone":!0}),Ga.cloneTo=function(Ga){var Gb=Ga;Gb._type=this._type,this._constant.cloneTo(Gb._constant),this._gradientX.cloneTo(Gb._gradientX),this._gradientY.cloneTo(Gb._gradientY),this._gradientZ.cloneTo(Gb._gradientZ),this._constantMin.cloneTo(Gb._constantMin),this._constantMax.cloneTo(Gb._constantMax),this._gradientXMin.cloneTo(Gb._gradientXMin),this._gradientXMax.cloneTo(Gb._gradientXMax),this._gradientYMin.cloneTo(Gb._gradientYMin),this._gradientYMax.cloneTo(Gb._gradientYMax),this._gradientZMin.cloneTo(Gb._gradientZMin),this._gradientZMax.cloneTo(Gb._gradientZMax)},Ga.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Ga,"gradientZ",function(){return this._gradientZ}),Gq(0,Ga,"constant",function(){return this._constant}),Gq(0,Ga,"type",function(){return this._type}),Gq(0,Ga,"gradientXMax",function(){return this._gradientXMax}),Gq(0,Ga,"constantMin",function(){return this._constantMin}),Gq(0,Ga,"gradientX",function(){return this._gradientX}),Gq(0,Ga,"gradientY",function(){return this._gradientY}),Gq(0,Ga,"gradientXMin",function(){return this._gradientXMin}),Gq(0,Ga,"constantMax",function(){return this._constantMax}),Gq(0,Ga,"gradientYMin",function(){return this._gradientYMin}),Gq(0,Ga,"gradientYMax",function(){return this._gradientYMax}),Gq(0,Ga,"gradientZMin",function(){return this._gradientZMin}),Gq(0,Ga,"gradientZMax",function(){return this._gradientZMax}),Gh.createByConstant=function(Ga){var Gb=new Gh;return Gb._type=0,Gb._constant=Ga,Gb},Gh.createByGradient=function(Ga,Gb,Gc){var Gd=new Gh;return Gd._type=1,Gd._gradientX=Ga,Gd._gradientY=Gb,Gd._gradientZ=Gc,Gd},Gh.createByRandomTwoConstant=function(Ga,Gb){var Gc=new Gh;return Gc._type=2,Gc._constantMin=Ga,Gc._constantMax=Gb,Gc},Gh.createByRandomTwoGradient=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=new Gh;return Gg._type=3,Gg._gradientXMin=Ga,Gg._gradientXMax=Gb,Gg._gradientYMin=Gc,Gg._gradientYMax=Gd,Gg._gradientZMin=Ge,Gg._gradientZMax=Gf,Gg},Gh}(),GO=(function(){function Ga(Ga){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=Ga}Gp(Ga,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb.cloneTo=function(Ga){var Gb=Ga;this._angularVelocity.cloneTo(Gb._angularVelocity),Gb.enbale=this.enbale},Gb.clone=function(){var Ga;switch(this._angularVelocity.type){case 0:Ga=this._angularVelocity.separateAxes?GK.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):GK.createByConstant(this._angularVelocity.constant);break;case 1:Ga=this._angularVelocity.separateAxes?GK.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):GK.createByGradient(this._angularVelocity.gradient.clone());break;case 2:Ga=this._angularVelocity.separateAxes?GK.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):GK.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:Ga=this._angularVelocity.separateAxes?GK.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):GK.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var Gb=new this.constructor(Ga);return Gb.enbale=this.enbale,Gb},Gq(0,Gb,"angularVelocity",function(){return this._angularVelocity})}(),function(){function Ga(){this.enable=!1,this.randomDirection=!1}Gp(Ga,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb._getShapeBoundBox=function(Ga){throw new Error("BaseShape: must override it.")},Gb._getSpeedBoundBox=function(Ga){throw new Error("BaseShape: must override it.")},Gb.generatePositionAndDirection=function(Ga,Gb,Gc,Gd){throw new Error("BaseShape: must override it.")},Gb._calculateProceduralBounds=function(Ga,Gb,Gc){this._getShapeBoundBox(Ga);var Gd=Ga.min,Ge=Ga.max;Ggb.multiply(Gd,Gb,Gd),Ggb.multiply(Ge,Gb,Ge);var Gf=new GZa(new Ggb,new Ggb);this.randomDirection?(Gf.min=new Ggb(-1,-1,-1),Gf.max=new Ggb(1,1,1)):this._getSpeedBoundBox(Gf);var Gg=new GZa(new Ggb,new Ggb),Gh=Gg.min,Gi=Gg.max;Ggb.scale(Gf.min,Gc.y,Gh),Ggb.scale(Gf.max,Gc.y,Gi),Ggb.add(Ga.min,Gh,Gh),Ggb.add(Ga.max,Gi,Gi),Ggb.min(Ga.min,Gh,Ga.min),Ggb.max(Ga.max,Gh,Ga.max);var Gj=new GZa(new Ggb,new Ggb),Gk=Gj.min,Gl=Gj.max;Ggb.scale(Gf.min,Gc.x,Gk),Ggb.scale(Gf.max,Gc.x,Gl),Ggb.min(Gj.min,Gl,Gh),Ggb.max(Gj.min,Gl,Gi),Ggb.min(Ga.min,Gh,Ga.min),Ggb.max(Ga.max,Gh,Ga.max)},Gb.cloneTo=function(Ga){Ga.enable=this.enable},Gb.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Ga}()),GT=function(){function Gf(){}return Gp(Gf,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),Gf._randomPointUnitArcCircle=function(Ga,Gb,Gc){var Gd=Gb.elements,Ge=NaN;Ge=Gc?Gc.getFloat()*Ga:Math.random()*Ga,Gd[0]=Math.cos(Ge),Gd[1]=Math.sin(Ge)},Gf._randomPointInsideUnitArcCircle=function(Ga,Gb,Gc){var Gd=Gb.elements;Gf._randomPointUnitArcCircle(Ga,Gb,Gc);var Ge=NaN;Ge=Gc?Math.pow(Gc.getFloat(),.5):Math.pow(Math.random(),.5),Gd[0]=Gd[0]*Ge,Gd[1]=Gd[1]*Ge},Gf._randomPointUnitCircle=function(Ga,Gb){var Gc=Ga.elements,Gd=NaN;Gd=Gb?Gb.getFloat()*Math.PI*2:Math.random()*Math.PI*2,Gc[0]=Math.cos(Gd),Gc[1]=Math.sin(Gd)},Gf._randomPointInsideUnitCircle=function(Ga,Gb){var Gc=Ga.elements;Gf._randomPointUnitCircle(Ga);var Gd=NaN;Gd=Gb?Math.pow(Gb.getFloat(),.5):Math.pow(Math.random(),.5),Gc[0]=Gc[0]*Gd,Gc[1]=Gc[1]*Gd},Gf._randomPointUnitSphere=function(Ga,Gb){var Gc=Ga.elements,Gd=NaN,Ge=NaN;Ge=Gb?(Gd=Gc[2]=2*Gb.getFloat()-1,Gb.getFloat()*Math.PI*2):(Gd=Gc[2]=2*Math.random()-1,Math.random()*Math.PI*2);var Gf=Math.sqrt(1-Gd*Gd);Gc[0]=Gf*Math.cos(Ge),Gc[1]=Gf*Math.sin(Ge)},Gf._randomPointInsideUnitSphere=function(Ga,Gb){var Gc=Ga.elements;Gf._randomPointUnitSphere(Ga);var Gd=NaN;Gd=Gb?Math.pow(Gb.getFloat(),1/3):Math.pow(Math.random(),1/3),Gc[0]=Gc[0]*Gd,Gc[1]=Gc[1]*Gd,Gc[2]=Gc[2]*Gd},Gf._randomPointInsideHalfUnitBox=function(Ga,Gb){var Gc=Ga.elements;Gb?(Gc[0]=Gb.getFloat()-.5,Gc[1]=Gb.getFloat()-.5,Gc[2]=Gb.getFloat()-.5):(Gc[0]=Math.random()-.5,Gc[1]=Math.random()-.5,Gc[2]=Math.random()-.5)},Gf}(),GU=(function(){function Ga(Ga){this._size=null,this.enbale=!1,this._size=Ga}Gp(Ga,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb.cloneTo=function(Ga){var Gb=Ga;this._size.cloneTo(Gb._size),Gb.enbale=this.enbale},Gb.clone=function(){var Ga;switch(this._size.type){case 0:Ga=this._size.separateAxes?GM.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):GM.createByGradient(this._size.gradient.clone());break;case 1:Ga=this._size.separateAxes?GM.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):GM.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:Ga=this._size.separateAxes?GM.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):GM.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var Gb=new this.constructor(Ga);return Gb.enbale=this.enbale,Gb},Gq(0,Gb,"size",function(){return this._size})}(),function(){function Gd(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}Gp(Gd,"laya.d3.core.particleShuriKen.module.StartFrame");var Ga=Gd.prototype;return Gx.imps(Ga,{"laya.d3.core.IClone":!0}),Ga.cloneTo=function(Ga){var Gb=Ga;Gb._type=this._type,Gb._constant=this._constant,Gb._constantMin=this._constantMin,Gb._constantMax=this._constantMax},Ga.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Ga,"constant",function(){return this._constant}),Gq(0,Ga,"type",function(){return this._type}),Gq(0,Ga,"constantMin",function(){return this._constantMin}),Gq(0,Ga,"constantMax",function(){return this._constantMax}),Gd.createByConstant=function(Ga){var Gb=new Gd;return Gb._type=0,Gb._constant=Ga,Gb},Gd.createByRandomTwoConstant=function(Ga,Gb){var Gc=new Gd;return Gc._type=1,Gc._constantMin=Ga,Gc._constantMax=Gb,Gc},Gd}()),GV=(function(){function Ga(Ga,Gb){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new Gfb(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=Ga,this._startFrame=Gb}Gp(Ga,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb.cloneTo=function(Ga){var Gb=Ga;this.tiles.cloneTo(Gb.tiles),Gb.type=this.type,Gb.randomRow=this.randomRow,this._frame.cloneTo(Gb._frame),this._startFrame.cloneTo(Gb._startFrame),Gb.cycles=this.cycles,Gb.enableUVChannels=this.enableUVChannels,Gb.enable=this.enable},Gb.clone=function(){var Ga,Gb;switch(this._frame.type){case 0:Ga=GJ.createByConstant(this._frame.constant);break;case 1:Ga=GJ.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:Ga=GJ.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:Ga=GJ.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:Gb=GU.createByConstant(this._startFrame.constant);break;case 1:Gb=GU.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var Gc=new this.constructor(Ga,Gb);return this.tiles.cloneTo(Gc.tiles),Gc.type=this.type,Gc.randomRow=this.randomRow,Gc.cycles=this.cycles,Gc.enableUVChannels=this.enableUVChannels,Gc.enable=this.enable,Gc},Gq(0,Gb,"frame",function(){return this._frame}),Gq(0,Gb,"startFrame",function(){return this._startFrame})}(),function(){function Ga(Ga){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=Ga}Gp(Ga,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb.cloneTo=function(Ga){var Gb=Ga;this._velocity.cloneTo(Gb._velocity),Gb.enbale=this.enbale,Gb.space=this.space},Gb.clone=function(){var Ga;switch(this._velocity.type){case 0:Ga=GN.createByConstant(this._velocity.constant.clone());break;case 1:Ga=GN.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:Ga=GN.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:Ga=GN.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var Gb=new this.constructor(Ga);return Gb.enbale=this.enbale,Gb.space=this.space,Gb},Gq(0,Gb,"velocity",function(){return this._velocity})}(),function(){function Ga(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new Gob,this._vb=GOb.create(Ga._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=GNb.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=GLb.nameKey.getID("LINE"),this._shaderCompile=GAb._preCompileShader[this._sharderNameID]}Gp(Ga,"laya.d3.core.PhasorSpriter3D");var Gb=Ga.prototype;return Gb.line=function(Ga,Gb,Gc,Gd){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Ga.x,Ga.y,Ga.z,Gb.x,Gb.y,Gb.z,Gb.w),this.addVertex(Gc.x,Gc.y,Gc.z,Gd.x,Gd.y,Gd.z,Gd.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},Gb.circle=function(Ga,Gb,Gc,Gd,Ge,Gf){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*Gb,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/Gb,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*Ga,Math.cos(this._tempNumver0)*Ga,0,Gc,Gd,Ge,Gf),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},Gb.plane=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=Gd/2,this._tempNumver1=Ge/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Ga-this._tempNumver0,Gb+this._tempNumver1,Gc,Gf,Gg,Gh,Gi),this.addVertex(Ga+this._tempNumver0,Gb+this._tempNumver1,Gc,Gf,Gg,Gh,Gi),this.addVertex(Ga-this._tempNumver0,Gb-this._tempNumver1,Gc,Gf,Gg,Gh,Gi),this.addVertex(Ga+this._tempNumver0,Gb-this._tempNumver1,Gc,Gf,Gg,Gh,Gi),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},Gb.box=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=Gd/2,this._tempNumver1=Ge/2,this._tempNumver2=Gf/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Ga-this._tempNumver0,Gb+this._tempNumver1,Gc+this._tempNumver2,Gg,Gh,Gi,Gj),this.addVertex(Ga+this._tempNumver0,Gb+this._tempNumver1,Gc+this._tempNumver2,Gg,Gh,Gi,Gj),this.addVertex(Ga-this._tempNumver0,Gb-this._tempNumver1,Gc+this._tempNumver2,Gg,Gh,Gi,Gj),this.addVertex(Ga+this._tempNumver0,Gb-this._tempNumver1,Gc+this._tempNumver2,Gg,Gh,Gi,Gj),this.addVertex(Ga+this._tempNumver0,Gb+this._tempNumver1,Gc-this._tempNumver2,Gg,Gh,Gi,Gj),this.addVertex(Ga-this._tempNumver0,Gb+this._tempNumver1,Gc-this._tempNumver2,Gg,Gh,Gi,Gj),this.addVertex(Ga+this._tempNumver0,Gb-this._tempNumver1,Gc-this._tempNumver2,Gg,Gh,Gi,Gj),this.addVertex(Ga-this._tempNumver0,Gb-this._tempNumver1,Gc-this._tempNumver2,Gg,Gh,Gi,Gj),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},Gb.cone=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*Gc+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*Gc>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/Gc,this.addVertexIndex(0,Gb,0,Gd,Ge,Gf,Gg,this._tempUint0),this.addVertexIndex(0,0,0,Gd,Ge,Gf,Gg,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<Gc;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(Ga*this._tempNumver2,0,Ga*this._tempNumver3,Gd,Ge,Gf,Gg,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==Gc-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(Ga*this._tempNumver2,0,Ga*this._tempNumver3,Gd,Ge,Gf,Gg,this._tempUint0+(this._tempInt0+Gc)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==Gc-1?this.addIndexes(this._tempUint1+Gc+2):this.addIndexes(this._tempUint1+this._tempInt0+Gc+1),this.addIndexes(this._tempUint1+this._tempInt0+Gc),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},Gb.boundingBoxLine=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(Ga,Ge,Gf,Gg,Gh,Gi,Gj),this.addVertex(Gd,Ge,Gf,Gg,Gh,Gi,Gj),this.addVertex(Ga,Gb,Gf,Gg,Gh,Gi,Gj),this.addVertex(Gd,Gb,Gf,Gg,Gh,Gi,Gj),this.addVertex(Gd,Ge,Gc,Gg,Gh,Gi,Gj),this.addVertex(Ga,Ge,Gc,Gg,Gh,Gi,Gj),this.addVertex(Gd,Gb,Gc,Gg,Gh,Gi,Gj),this.addVertex(Ga,Gb,Gc,Gg,Gh,Gi,Gj),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},Gb.addVertex=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=Ga,this._vbData[this._posInVBData+1]=Gb,this._vbData[this._posInVBData+2]=Gc,this._vbData[this._posInVBData+3]=Gd,this._vbData[this._posInVBData+4]=Ge,this._vbData[this._posInVBData+5]=Gf,this._vbData[this._posInVBData+6]=Gg,this._posInVBData+=this._floatSizePerVer,this},Gb.addVertexIndex=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){return this._hasBegun||this.addVertexIndexException(),this._vbData[Gh]=Ga,this._vbData[Gh+1]=Gb,this._vbData[Gh+2]=Gc,this._vbData[Gh+3]=Gd,this._vbData[Gh+4]=Ge,this._vbData[Gh+5]=Gf,this._vbData[Gh+6]=Gg,(Gh+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=Gh),this},Gb.addIndexes=function(Ga){var Gb=arguments;this._hasBegun||this.addVertexIndexException();for(var Gc=0;Gc<Gb.length;Gc++)this._ibData[this._posInIBData]=Gb[Gc],this._posInIBData++;return this},Gb.begin=function(Ga,Gb){return this._hasBegun&&this.beginException0(),1!==Ga&&4!==Ga&&this.beginException1(),this._primitiveType=Ga,this._camera=Gb,this._hasBegun=!0,this},Gb.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},Gb.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(Ga._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),GA.drawCall++,GF.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},Gb.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},Gb.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},Gb.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},Gb.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},Gb.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},Gb.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(28,[new Gga(0,"vector3",0),new Gga(12,"vector4",1)])}]),Ga}()),GW=function(){function Ga(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++Ga._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new Gob}Gp(Ga,"laya.d3.core.render.RenderElement");var Gb=Ga.prototype;return Gb.getDynamicBatchBakedVertexs=function(Ga){for(var Gb=this._renderObj._getVertexBuffer(Ga),Gc=Gb.getData().slice(),Gd=Gb.vertexDeclaration,Ge=Gd.getVertexElementByUsage(0).offset/4,Gf=Gd.getVertexElementByUsage(3).offset/4,Gg=this._sprite3D.transform,Gh=Gg.worldMatrix,Gi=Gg.rotation,Gj=Gd.vertexStride/4,Gk=0,Gl=Gc.length;Gk<Gl;Gk+=Gj){var Go=Gk+Ge,Gp=Gk+Gf;Gsb.transformVector3ArrayToVector3ArrayCoordinate(Gc,Go,Gh,Gc,Go),Gsb.transformVector3ArrayByQuat(Gc,Gp,Gi,Gc,Gp)}return Gc},Gb.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},Gb._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},Gq(0,Gb,"id",function(){return this._id}),Gq(0,Gb,"renderObj",function(){return this._renderObj},function(Ga){this._renderObj!==Ga&&(this._renderObj=Ga)}),Ga._uniqueIDCounter=0,Ga}(),GX=function(){function Gb(Ga){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++Gb._uniqueIDCounter,this._needSort=!1,this._scene=Ga,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}Gp(Gb,"laya.d3.core.render.RenderQueue");var Ga=Gb.prototype;return Ga._sortOpaqueFunc=function(Ga,Gb){if(Ga._render&&Gb._render){var Gc=Ga._material.renderQueue-Gb._material.renderQueue;return 0==Gc?Ga._render._distanceForSort-Gb._render._distanceForSort:Gc}return 0},Ga._sortAlphaFunc=function(Ga,Gb){if(Ga._render&&Gb._render){var Gc=Ga._material.renderQueue-Gb._material.renderQueue;return 0==Gc?Gb._render._distanceForSort-Ga._render._distanceForSort:Gc}return 0},Ga._begainRenderElement=function(Ga,Gb,Gc){return!!Gb._beforeRender(Ga)},Ga._sortAlpha=function(Ga){Gb._cameraPosition=Ga,this._finalElements.sort(this._sortAlphaFunc)},Ga._sortOpaque=function(Ga){Gb._cameraPosition=Ga,this._finalElements.sort(this._sortOpaqueFunc)},Ga._preRender=function(Ga){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},Ga._render=function(Ga,Gb){for(var Gc,Gd,Ge,Gf,Gg,Gh,Gi=GA.loopCount,Gj=this._scene,Gk=Ga.camera,Gl=(Gk.id,!1),Go=0,Gp=this._finalElements.length;Go<Gp;Go++){var Gq,Gr,Gs,Gt=this._finalElements[Go];if(null!=Gt._onPreRenderFunction&&Gt._onPreRenderFunction.call(Gt._sprite3D,Ga),0===Gt._type){if(Ga.owner=Gs=Gt._sprite3D,Ga.renderElement=Gt,Gs._preRenderUpdateComponents(Ga),Gq=Gt.renderObj,Gr=Gt._material,this._begainRenderElement(Ga,Gq,Gr)){if(Gc=Gq._getVertexBuffers(),!(Ge=(Gd=Gq._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[Gd.id]){this._errorRecord[Gd.id]=1;var Gu="vertexBuffer:"+("("+Gd._destroyed+","+Gd._released+","+Gd._referenceCount+","+Gd._buffer+")")+", material:"+(Gr?Gr.__className+"("+Gr._destroyed+","+Gr._released+")":"null")+", owner:"+(Gs?Gs.__className+"("+Gs._destroyed+","+Gs._activeInHierarchy+","+Gs._displayedInStage+")":"null")+", renderObj:"+(Gq?Gq.__className+"("+Gq._destroyed+","+Gq._released+","+Gq._referenceCount+")":"")+", parent:, url:"+(Gs?Gs.url:"")+", disposeStack:"+Gd.disposeStack;Gx.recordError("报错：unknown vertexDeclaration  "+Gu)}continue}if(Gl=(Gf=Ga._shader=Gr._getShader(Gj._shaderDefineValue,Ge.shaderDefineValue,Gs._shaderDefineValue)).bind()||Gi!==Gf._uploadLoopCount,Gc){if(Gf._uploadVertexBuffer!==Gc||Gl){for(var Gv=0;Gv<Gc.length;Gv++){var Gw=Gc[Gv];Gf.uploadAttributesX(Gw.vertexDeclaration.shaderValues.data,Gw)}Gf._uploadVertexBuffer=Gc}}else(Gf._uploadVertexBuffer!==Gd||Gl)&&(Gf.uploadAttributes(Ge.shaderValues.data,null),Gf._uploadVertexBuffer=Gd);(Gf._uploadScene!==Gj||Gl)&&(Gf.uploadSceneUniforms(Gj._shaderValues.data),Gf._uploadScene=Gj),(Gk!==Gf._uploadCamera||Gf._uploadSprite3D!==Gs||Gl)&&(Gf.uploadSpriteUniforms(Gs._shaderValues.data),Gf._uploadSprite3D=Gs),(Gk!==Gf._uploadCamera||Gl)&&(Gf.uploadCameraUniforms(Gk._shaderValues.data),Gf._uploadCamera=Gk),(Gf._uploadMaterial!==Gr||Gl)&&(Gr._upload(),Gf._uploadMaterial=Gr),Gg!==Gr?(Gr._setRenderStateBlendDepth(),Gr._setRenderStateFrontFace(Gb,Gs.transform),Gg=Gr,Gh=Gs):Gh!==Gs&&(Gr._setRenderStateFrontFace(Gb,Gs.transform),Gh=Gs),Gq._render(Ga),Gf._uploadLoopCount=Gi}Gs._postRenderUpdateComponents(Ga)}else if(2===Gt._type){Gt.renderObj;Ga.owner=Gs=Gt._sprite3D,Ga.renderElement=Gt,Ga._batchIndexStart=Gt._tempBatchIndexStart,Ga._batchIndexEnd=Gt._tempBatchIndexEnd,Gq=Gt.renderObj,Gr=Gt._material,this._begainRenderElement(Ga,Gq,Gr)&&(Ge=(Gd=Gq._getVertexBuffer(0)).vertexDeclaration,Gl=(Gf=Ga._shader=Gr._getShader(Gj._shaderDefineValue,Ge.shaderDefineValue,Gs._shaderDefineValue)).bind()||Gi!==Gf._uploadLoopCount,(Gf._uploadVertexBuffer!==Gd||Gl)&&(Gf.uploadAttributes(Ge.shaderValues.data,null),Gf._uploadVertexBuffer=Gd),(Gf._uploadScene!==Gj||Gl)&&(Gf.uploadSceneUniforms(Gj._shaderValues.data),Gf._uploadScene=Gj),(Gk!==Gf._uploadCamera||Gf._uploadSprite3D!==Gs||Gl)&&(Gf.uploadSpriteUniforms(Gs._shaderValues.data),Gf._uploadSprite3D=Gs),(Gk!==Gf._uploadCamera||Gl)&&(Gf.uploadCameraUniforms(Gk._shaderValues.data),Gf._uploadCamera=Gk),(Gf._uploadMaterial!==Gr||Gl)&&(Gr._upload(),Gf._uploadMaterial=Gr),Gg!==Gr?(Gr._setRenderStateBlendDepth(),Gr._setRenderStateFrontFace(Gb,Gs.transform),Gg=Gr,Gh=Gs):Gh!==Gs&&(Gr._setRenderStateFrontFace(Gb,Gs.transform),Gh=Gs),Gq._render(Ga),Gf._uploadLoopCount=Gi)}}},Ga._renderShadow=function(Ga,Gb){for(var Gc,Gd,Ge,Gf,Gg,Gh=GA.loopCount,Gi=this._scene,Gj=Ga.camera,Gk=!1,Gl=0,Go=this._finalElements.length;Gl<Go;Gl++){var Gp,Gq,Gr,Gs=this._finalElements[Gl];0===Gs._type&&(Ga.owner=Gr=Gs._sprite3D,Gb||Gr._projectionViewWorldUpdateCamera===Gj&&Gr._projectionViewWorldUpdateLoopCount===GA.loopCount||(Gr._render._renderUpdate(Ga._projectionViewMatrix),Gr._projectionViewWorldUpdateLoopCount=GA.loopCount,Gr._projectionViewWorldUpdateCamera=Gj),Ga.renderElement=Gs,Gr._preRenderUpdateComponents(Ga),Gp=Gs.renderObj,Gq=Gs._material,this._begainRenderElement(Ga,Gp,null)&&(Gd=(Gc=Gp._getVertexBuffer(0)).vertexDeclaration,Gk=(Ge=Ga._shader=Gq._getShader(Gi._shaderDefineValue,Gd.shaderDefineValue,Gr._shaderDefineValue)).bind()||Gh!==Ge._uploadLoopCount,(Ge._uploadVertexBuffer!==Gc||Gk)&&(Ge.uploadAttributes(Gd.shaderValues.data,null),Ge._uploadVertexBuffer=Gc),(Gj!==Ge._uploadCamera||Ge._uploadSprite3D!==Gr||Gk)&&(Ge.uploadSpriteUniforms(Gr._shaderValues.data),Ge._uploadSprite3D=Gr),(Gj!==Ge._uploadCamera||Gk)&&(Ge.uploadCameraUniforms(Gj._shaderValues.data),Ge._uploadCamera=Gj),(Ge._uploadMaterial!==Gq||Gk)&&(Gq._upload(),Ge._uploadMaterial=Gq),Ge._uploadRenderElement,Gf!==Gq?(Gq._setRenderStateFrontFace(!1,Gr.transform),Gf=Gq,Gg=Gr):Gg!==Gr&&(Gq._setRenderStateFrontFace(!1,Gr.transform),Gg=Gr),Gp._render(Ga),Ge._uploadLoopCount=Gh),Gr._postRenderUpdateComponents(Ga))}},Ga._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},Ga._addRenderElement=function(Ga){this._renderElements.push(Ga),this._needSort=!0},Ga._addDynamicBatchElement=function(Ga){this._dynamicBatchCombineRenderElements.push(Ga)},Gq(0,Ga,"id",function(){return this._id}),Gb._uniqueIDCounter=0,Gb._cameraPosition=null,Gb}(),GY=function(){function Ga(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return Gp(Ga,"laya.d3.core.render.RenderState"),Ga.clientWidth=0,Ga.clientHeight=0,Ga}(),GZ=function(){function Gg(Ga,Gb){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new G_a(new Ggb,0),this._corners=[new Ggb,new Ggb,new Ggb,new Ggb,new Ggb,new Ggb,new Ggb,new Ggb],this._boundingBoxCenter=new Ggb,this._children=Gd(8),this._objects=[],this._tempBoundBoxCorners=[new Ggb,new Ggb,new Ggb,new Ggb,new Ggb,new Ggb,new Ggb,new Ggb],this._scene=Ga,this._currentDepth=Gb}Gp(Gg,"laya.d3.core.scene.OctreeNode");var Ga=Gg.prototype;return Gx.imps(Ga,{"laya.d3.core.scene.ITreeNode":!0}),Ga.init=function(Ga,Gb){var Gc=new Ggb,Gd=new Ggb;Ggb.scale(Gb,-.5,Gc),Ggb.scale(Gb,.5,Gd),Ggb.add(Gc,Ga,Gc),Ggb.add(Gd,Ga,Gd),this.exactBox=new GZa(Gc,Gd),this.relaxBox=new GZa(Gc,Gd)},Ga.addTreeNode=function(Ga){1===Collision.boxContainsBox(this._relaxBox,Ga.boundingBox)?this.addNodeDown(Ga,0):this.addObject(Ga)},Ga.addChild=function(Ga){var Gb=this._children[Ga];if(null==Gb){Gb=new Gg(this._scene,this._currentDepth+1),(this._children[Ga]=Gb)._parent=this,Ggb.subtract(this._exactBox.max,this._exactBox.min,Gg.tempSize),Ggb.multiply(Gg.tempSize,Gg._octreeSplit[Ga],Gg.tempCenter),Ggb.add(this._exactBox.min,Gg.tempCenter,Gg.tempCenter),Ggb.scale(Gg.tempSize,.25,Gg.tempSize);var Gc=new Ggb,Gd=new Ggb;Ggb.subtract(Gg.tempCenter,Gg.tempSize,Gc),Ggb.add(Gg.tempCenter,Gg.tempSize,Gd),Gb.exactBox=new GZa(Gc,Gd),Ggb.scale(Gg.tempSize,Gg.relax,Gg.tempSize);var Ge=new Ggb,Gf=new Ggb;Ggb.subtract(Gg.tempCenter,Gg.tempSize,Ge),Ggb.add(Gg.tempCenter,Gg.tempSize,Gf),Gb.relaxBox=new GZa(Ge,Gf)}return Gb},Ga.addObject=function(Ga){(Ga._treeNode=this)._objects.push(Ga)},Ga.removeObject=function(Ga){if(Ga._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var Gb=this._objects.indexOf(Ga);return-1!==Gb&&(this._objects.splice(Gb,1),!0)},Ga.clearObject=function(){this._objects.length=0},Ga.addNodeUp=function(Ga,Gb){this._parent&&1!==Collision.boxContainsBox(this._exactBox,Ga.boundingBox)?this._parent.addNodeUp(Ga,Gb-1):this.addNodeDown(Ga,Gb)},Ga.addNodeDown=function(Ga,Gb){if(Gb<this._scene.treeLevel){var Gc=this.inChildIndex(Ga.boundingBoxCenter),Gd=this.addChild(Gc);1===Collision.boxContainsBox(Gd._relaxBox,Ga.boundingBox)?Gd.addNodeDown(Ga,++Gb):this.addObject(Ga)}else this.addObject(Ga)},Ga.inChildIndex=function(Ga){return 4*(Ga.z<this._boundingBoxCenter.z?0:1)+2*(Ga.y<this._boundingBoxCenter.y?0:1)+(Ga.x<this._boundingBoxCenter.x?0:1)},Ga.updateObject=function(Ga){1===Collision.boxContainsBox(this._relaxBox,Ga.boundingBox)?(this.removeObject(Ga),Ga._treeNode=null,this.addNodeDown(Ga,this._currentDepth)):this._parent&&(this.removeObject(Ga),Ga._treeNode=null,this._parent.addNodeUp(Ga,this._currentDepth-1))},Ga.cullingObjects=function(Ga,Gb,Gc,Gd,Ge){var Gf,Gg=0,Gh=0,Gi=0,Gj=this._scene._dynamicBatchManager;for(Gg=0,Gf=this._objects.length;Gg<Gf;Gg++){var Gk=this._objects[Gg];if(GI.isVisible(Gk._owner.layer.mask)&&Gk.enable){if(Gb&&(GA.treeSpriteCollision+=1,0===Ga.containsBoundSphere(Gk.boundingSphere)))continue;Gk._renderUpdate(Ge),Gk._distanceForSort=Ggb.distance(Gk.boundingSphere.center,Gd)+Gk.sortingFudge;var Gl=Gk._renderElements;for(Gh=0,Gi=Gl.length;Gh<Gi;Gh++){var Go=Gl[Gh],Gp=Go._staticBatch;if(Gp&&Gp._material===Go._material)Gp._addBatchRenderElement(Go);else{var Gq=Go.renderObj;Gq.triangleCount<10&&1===Gq._vertexBufferCount&&Gq._getIndexBuffer()&&Go._material.renderQueue<2&&Go._canDynamicBatch&&!Gk._owner.isStatic?Gj._addPrepareRenderElement(Go):this._scene.getRenderQueue(Go._material.renderQueue)._addRenderElement(Go)}}}}for(Gg=0;Gg<8;Gg++){var Gr=this._children[Gg];if(null!=Gr){var Gs=Gb;if(Gb){var Gt=Ga.containsBoundBox(Gr._relaxBox);if(GA.treeNodeCollision+=1,0===Gt)continue;Gs=2===Gt}Gr.cullingObjects(Ga,Gs,Gc,Gd,Ge)}}},Ga.cullingShadowObjects=function(Ga,Gb,Gc,Gd,Ge){var Gf,Gg=0,Gh=0,Gi=0;this._scene._dynamicBatchManager;for(Gg=0,Gf=this._objects.length;Gg<Gf;Gg++){var Gj=this._objects[Gg];if(Gj.castShadow&&GI.isVisible(Gj._owner.layer.mask)&&Gj.enable){if(Gc&&0===Ga[0].containsBoundSphere(Gj.boundingSphere))continue;for(var Gk=1,Gl=Ga.length;Gk<Gl;Gk++){var Go=Gb[Gk-1];if(0!==Ga[Gk].containsBoundSphere(Gj.boundingSphere)){var Gp=Gj._renderElements;for(Gh=0,Gi=Gp.length;Gh<Gi;Gh++)Go._addRenderElement(Gp[Gh])}}}}for(Gg=0;Gg<8;Gg++){var Gq=this._children[Gg];if(null!=Gq){var Gr=Gc;if(Gc){var Gs=Ga[0].containsBoundBox(Gq._relaxBox);if(0===Gs)continue;Gr=2===Gs}Gq.cullingShadowObjects(Ga,Gb,Gr,Gd,Ge)}}},Ga.cullingShadowObjectsOnePSSM=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg,Gh=Gb[0],Gi=0,Gj=0,Gk=0;for(Gi=0,Gg=this._objects.length;Gi<Gg;Gi++){var Gl=this._objects[Gi];if(Gl.castShadow&&GI.isVisible(Gl._owner.layer.mask)&&Gl.enable){if(Gd&&0===Ga.containsBoundSphere(Gl.boundingSphere))continue;Gl._renderUpdate(Gc);var Go=Gl._renderElements;for(Gj=0,Gk=Go.length;Gj<Gk;Gj++)Gh._addRenderElement(Go[Gj])}}for(Gi=0;Gi<8;Gi++){var Gp=this._children[Gi];if(null!=Gp){var Gq=Gd;if(Gd){var Gr=Ga.containsBoundBox(Gp._relaxBox);if(0===Gr)continue;Gq=2===Gr}Gp.cullingShadowObjectsOnePSSM(Ga,Gb,Gc,Gq,Ge,Gf)}}},Ga.renderBoudingBox=function(Ga){this._renderBoudingBox(Ga);for(var Gb=0;Gb<8;++Gb){var Gc=this._children[Gb];Gc&&Gc.renderBoudingBox(Ga)}},Ga.buildAllChild=function(Ga){if(Ga<this._scene.treeLevel)for(var Gb=0;Gb<8;Gb++){this.addChild(Gb).buildAllChild(Ga+1)}},Ga._renderBoudingBox=function(Ga){},Gq(0,Ga,"exactBox",function(){return this._exactBox},function(Ga){this._exactBox=Ga,Ggb.add(Ga.min,Ga.max,this._boundingBoxCenter),Ggb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),Gq(0,Ga,"relaxBox",function(){return this._relaxBox},function(Ga){(this._relaxBox=Ga).getCorners(this._corners),G_a.createfromPoints(this._corners,this._boundingSphere)}),Gg.debugMode=!1,Gg.relax=1.15,Gg.CHILDNUM=8,Gl(Gg,["tempVector0",function(){return this.tempVector0=new Ggb},"tempSize",function(){return this.tempSize=new Ggb},"tempCenter",function(){return this.tempCenter=new Ggb},"_octreeSplit",function(){return this._octreeSplit=[new Ggb(.25,.25,.25),new Ggb(.75,.25,.25),new Ggb(.25,.75,.25),new Ggb(.75,.75,.25),new Ggb(.25,.25,.75),new Ggb(.75,.25,.75),new Ggb(.25,.75,.75),new Ggb(.75,.75,.75)]}]),Gg}(),G$=(function(){function Ga(){}Gp(Ga,"laya.d3.core.scene.SceneManager")}(),function(){function Ga(Ga,Gb,Gc,Gd){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===Ga&&(Ga=1),void 0===Gb&&(Gb=1),void 0===Gc&&(Gc=1),void 0===Gd&&(Gd=1),this._r=Ga,this._g=Gb,this._b=Gc,this._a=Gd}return Gp(Ga,"laya.d3.core.trail.module.Color",null,"Color$1"),Ga.prototype.cloneTo=function(Ga){Ga._r=this._r,Ga._g=this._g,Ga._b=this._b,Ga._a=this._a},Gl(Ga,["RED",function(){return this.RED=new Ga(1,0,0,1)},"GREEN",function(){return this.GREEN=new Ga(0,1,0,1)},"BLUE",function(){return this.BLUE=new Ga(0,0,1,1)},"CYAN",function(){return this.CYAN=new Ga(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new Ga(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new Ga(1,0,1,1)},"GRAY",function(){return this.GRAY=new Ga(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new Ga(1,1,1,1)},"BLACK",function(){return this.BLACK=new Ga(0,0,0,1)}]),Ga}()),G_=(function(){function Ga(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}Gp(Ga,"laya.d3.core.trail.module.Gradient");var Gb=Ga.prototype;Gb.setKeys=function(Ga,Gb){var Gc,Gd;this._colorKeys=Ga;for(var Ge=this.index=0;Ge<Ga.length;Ge++){var Gf=(Gc=Ga[Ge]).color;this._colorKeyData[this.index++]=Gf._r,this._colorKeyData[this.index++]=Gf._g,this._colorKeyData[this.index++]=Gf._b,this._colorKeyData[this.index++]=Gc.time}this._alphaKeys=Gb;for(var Gg=this.index=0;Gg<Gb.length;Gg++)Gd=Gb[Gg],this._alphaKeyData[this.index++]=Gd.alpha,this._alphaKeyData[this.index++]=Gd.time},Gb.cloneTo=function(Ga){var Gb=0,Gc=0,Gd=this.colorKeys,Ge=[];for(Gb=0,Gc=Gd.length;Gb<Gc;Gb++){var Gf=new Gm;Gd[Gb].cloneTo(Gf),Ge.push(Gf)}var Gg=this.alphaKeys,Gh=[];for(Gb=0,Gc=Gg.length;Gb<Gc;Gb++){var Gi=new G_;Gg[Gb].cloneTo(Gi),Gh.push(Gi)}Ga.setKeys(Ge,Gh)},Gq(0,Gb,"mode",function(){return this._mode},function(Ga){this._mode=Ga}),Gq(0,Gb,"colorKeys",function(){return this._colorKeys},function(Ga){this._colorKeys=Ga;for(var Gb=this.index=0;Gb<Ga.length;Gb++){var Gc=Ga[Gb],Gd=Gc.color;this._colorKeyData[this.index++]=Gd._r,this._colorKeyData[this.index++]=Gd._g,this._colorKeyData[this.index++]=Gd._b,this._colorKeyData[this.index++]=Gc.time}}),Gq(0,Gb,"alphaKeys",function(){return this._alphaKeys},function(Ga){this._alphaKeys=Ga;for(var Gb=this.index=0;Gb<Ga.length;Gb++){var Gc=Ga[Gb];this._alphaKeyData[this.index++]=Gc.alpha,this._alphaKeyData[this.index++]=Gc.time}})}(),function(){function Ga(Ga,Gb){this._alpha=NaN,this._time=NaN,void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),this._alpha=Ga,this._time=Gb}Gp(Ga,"laya.d3.core.trail.module.GradientAlphaKey");var Gb=Ga.prototype;return Gb.cloneTo=function(Ga){Ga.alpha=this.alpha,Ga.time=this.time},Gq(0,Gb,"alpha",function(){return this._alpha},function(Ga){this._alpha=Ga}),Gq(0,Gb,"time",function(){return this._time},function(Ga){this._time=Ga}),Ga}()),Gm=function(){function Ga(Ga,Gb){this._color=null,this._time=NaN,void 0===Gb&&(Gb=0),this._color=Ga||new G$,this._time=Gb}Gp(Ga,"laya.d3.core.trail.module.GradientColorKey");var Gb=Ga.prototype;return Gb.cloneTo=function(Ga){this.color.cloneTo(Ga.color),Ga.time=this.time},Gq(0,Gb,"color",function(){return this._color},function(Ga){this._color=Ga}),Gq(0,Gb,"time",function(){return this._time},function(Ga){this._time=Ga}),Ga}(),Gn=(function(){function Ga(){}Gp(Ga,"laya.d3.core.trail.module.GradientMode"),Ga.Blend=0,Ga.Fixed=1}(),function(){function Ga(){}Gp(Ga,"laya.d3.core.trail.module.TextureMode"),Ga.Stretch=0,Ga.Tile=1}(),function(){function Ga(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}Gp(Ga,"laya.d3.core.trail.module.TrailKeyFrame"),Ga.prototype.cloneTo=function(Ga){Ga.time=this.time,Ga.inTangent=this.inTangent,Ga.outTangent=this.outTangent,Ga.value=this.value}}(),function(){function Gb(Ga){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new Ggb,this._curPosition=new Ggb,this._delVector3=new Ggb,this._lastFixedVertexPosition=new Ggb,this._pointAtoBVector3=new Ggb,this._pointA=new Ggb,this._pointB=new Ggb,this._owner=Ga,this._id=Gb.renderElementCount++,0==this._id?Ga._owner.transform.position.cloneTo(this._lastPosition):Ga._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new GOb(Gn.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new GOb(Gn.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}Gp(Gb,"laya.d3.core.trail.TrailRenderElement");var Ga=Gb.prototype;Gx.imps(Ga,{"laya.d3.core.render.IRenderable":!0}),Ga._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},Ga._addTrailByFirstPosition=function(Ga,Gb){Ggb.subtract(Gb,Ga,this._delVector3),Ggb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),Ggb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),Ggb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(Ga),Ga.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},Ga._addTrailByNextPosition=function(Ga){Ggb.subtract(Ga,this._lastFixedVertexPosition,this._delVector3),Ggb.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),Ggb.normalize(this._pointAtoBVector3,this._pointAtoBVector3),Ggb.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=Ggb.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=Gma.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(Ga),Ga.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(Ga),this._virtualVerticesCount=2)},Ga._updateVerticesByPosition=function(Ga){this._pointe=Ga.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},Ga._updateVertexBuffer2=function(){var Ga,Gb=0,Gc=0,Gd=0;for(Gd=0,Ga=(this._verticesCount+this._virtualVerticesCount)/2;Gd<Ga;Gd++)Gc=0==this._owner.textureMode?(this._VerticesToTailLength[Gd]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[Gd],this._vertices2[Gb++]=1-Gc,this._vertices2[Gb++]=1-Gc;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},Ga._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},Ga._updateDisappear=function(){var Ga,Gb=0;for(Gb=this._curDisappearIndex,Ga=(this._verticesCount+this._virtualVerticesCount)/2;Gb<Ga;Gb++)this._owner._curtime-this._everyGroupVertexBirthTime[Gb]>=this._owner.time+Gma.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},Ga._beforeRender=function(Ga){return this._camera=Ga.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),Ggb.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},Ga._render=function(Ga){this._isDead||(GF.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),GA.drawCall++,GA.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},Ga._getVertexBuffer=function(Ga){return void 0===Ga&&(Ga=0),0===Ga?this._vertexBuffer1:1===Ga?this._vertexBuffer2:null},Ga._getVertexBuffers=function(){return this._vertexBuffers},Ga._getIndexBuffer=function(){return null},Ga.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},Ga._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},Gq(0,Ga,"_vertexBufferCount",function(){return this._vertexBuffers.length}),Gq(0,Ga,"triangleCount",function(){return 0}),Gb.renderElementCount=0}(),function(){function Ga(){}Gp(Ga,"laya.d3.core.trail.VertexTrail");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration1}),Gq(1,Ga,"vertexDeclaration1",function(){return Ga._vertexDeclaration1}),Gq(1,Ga,"vertexDeclaration2",function(){return Ga._vertexDeclaration2}),Gl(Ga,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new Gfa(32,[new Gga(0,"vector3",0),new Gga(12,"vector3",41),new Gga(24,"single",33),new Gga(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new Gfa(4,[new Gga(0,"single",38)])}]),Ga}()),Gaa=function(){function Gw(Ga){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=Ga}Gp(Gw,"laya.d3.graphics.DynamicBatch");var Ga=Gw.prototype;return Gx.imps(Ga,{"laya.d3.core.render.IRenderable":!0}),Ga._getVertexBuffer=function(Ga){return void 0===Ga&&(Ga=0),0===Ga?this._vertexBuffer:null},Ga._getIndexBuffer=function(){return this._indexBuffer},Ga._getCombineRenderElementFromPool=function(Ga,Gb,Gc){var Gd=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return Gd||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=Gd=new GW,Gd._sprite3D=new GXb),Gd._sprite3D._render._renderUpdate(Gc),Gd},Ga._getRenderElement=function(Ga,Gb,Gc){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*Gw.maxVertexCount),this._indexDatas=new Uint16Array(Gw.maxIndexCount),this._vertexBuffer=GOb.create(this._vertexDeclaration,Gw.maxVertexCount,35048),this._indexBuffer=GNb.create("ushort",Gw.maxIndexCount,35048));for(var Gd=this._merageElements.length=0,Ge=0,Gf=0,Gg=this._combineRenderElements.length;Gf<Gg;Gf++){var Gh=this._combineRenderElements[Gf],Gi=Gh.getDynamicBatchBakedVertexs(0),Gj=Gh.getBakedIndices(),Gk=Gh._sprite3D.transform._isFrontFaceInvert,Gl=Gd/(this._vertexDeclaration.vertexStride/4),Go=Ge,Gp=Go+Gj.length;Gh._tempBatchIndexStart=Go,Gh._tempBatchIndexEnd=Gp,this._indexDatas.set(Gj,Ge);var Gq=0;if(Gk)for(Gq=Go;Gq<Gp;Gq+=3){this._indexDatas[Gq]=Gl+this._indexDatas[Gq];var Gr=this._indexDatas[Gq+1],Gs=this._indexDatas[Gq+2];this._indexDatas[Gq+1]=Gl+Gs,this._indexDatas[Gq+2]=Gl+Gr}else for(Gq=Go;Gq<Gp;Gq+=3)this._indexDatas[Gq]=Gl+this._indexDatas[Gq],this._indexDatas[Gq+1]=Gl+this._indexDatas[Gq+1],this._indexDatas[Gq+2]=Gl+this._indexDatas[Gq+2];Ge+=Gj.length,this._vertexDatas.set(Gi,Gd),Gd+=Gi.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),Gf=this._combineRenderElementPoolIndex=0,Gg=this._materials.length;Gf<Gg;Gf++){var Gt=this._getCombineRenderElementFromPool(Ga,Gb,Gc);Gt._type=2,Gt._staticBatch=null;var Gu=(Gt.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[Gf]]._tempBatchIndexStart,Gv=Gf+1===this._materialToRenderElementsOffsets.length?Ge:this._combineRenderElements[this._materialToRenderElementsOffsets[Gf+1]]._tempBatchIndexStart;Gt._tempBatchIndexStart=Gu,Gt._tempBatchIndexEnd=Gv,Gt._material=this._materials[Gf],this._merageElements.push(Gt)}},Ga._addCombineRenderObjTest=function(Ga){var Gb=Ga.renderObj,Gc=this._currentCombineIndexCount+Gb._getIndexBuffer().indexCount,Gd=this._currentCombineVertexCount+Gb._getVertexBuffer().vertexCount;return!(Gw.maxVertexCount<Gd||Gw.maxIndexCount<Gc)},Ga._addCombineRenderObj=function(Ga){var Gb=Ga.renderObj;this._combineRenderElements.push(Ga),this._currentCombineIndexCount=this._currentCombineIndexCount+Gb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+Gb._getVertexBuffer().vertexCount},Ga._addCombineMaterial=function(Ga){this._materials.push(Ga)},Ga._addMaterialToRenderElementOffset=function(Ga){this._materialToRenderElementsOffsets.push(Ga)},Ga._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},Ga._addToRenderQueue=function(Ga,Gb,Gc,Gd){this._getRenderElement(Gb,Gc,Gd);for(var Ge=0,Gf=this._materials.length;Ge<Gf;Ge++)Ga.getRenderQueue(this._materials[Ge].renderQueue)._addDynamicBatchElement(this._merageElements[Ge])},Ga._beforeRender=function(Ga){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Ga._render=function(Ga){var Gb=Ga._batchIndexEnd-Ga._batchIndexStart;GF.mainContext.drawElements(4,Gb,5123,2*Ga._batchIndexStart),GA.drawCall++,GA.trianglesFaces+=Gb/3},Ga._getVertexBuffers=function(){return null},Gq(0,Ga,"_vertexBufferCount",function(){return 1}),Gq(0,Ga,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Gq(0,Ga,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),Gw.maxVertexCount=2e4,Gw.maxIndexCount=4e4,Gw.maxCombineTriangleCount=10,Gw}(),Gba=function(){function Gw(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}Gp(Gw,"laya.d3.graphics.DynamicBatchManager");var Ga=Gw.prototype;return Ga.getDynamicBatch=function(Ga,Gb){var Gc,Gd=Ga.id.toString()+Gb;return this._dynamicBatches[Gd]?Gc=this._dynamicBatches[Gd]:this._dynamicBatches[Gd]=Gc=new Gaa(Ga),Gc},Ga._garbageCollection=function(){for(var Ga in this._dynamicBatches)0===this._dynamicBatches[Ga].combineRenderElementsCount&&delete this._dynamicBatches[Ga]},Ga._addPrepareRenderElement=function(Ga){this._prepareDynamicBatchCombineElements.push(Ga)},Ga._finishCombineDynamicBatch=function(Ga){var Gb,Gc,Gd;this._prepareDynamicBatchCombineElements.sort(Gw._sortPrepareDynamicBatch);for(var Ge,Gf,Gg,Gh,Gi,Gj=-1,Gk=!0,Gl=0,Go=-1,Gp=0,Gq=this._prepareDynamicBatchCombineElements.length;Gp<Gq;Gp++){var Gr=(Gf=this._prepareDynamicBatchCombineElements[Gp]).renderObj._getVertexBuffer(0).vertexDeclaration,Gs=Gc!==Gr;Gs&&(Gl=0,Gc=Gr);var Gt=Gl!==Gj;if(Gt&&(Gj=Gl),(Gs||Gt)&&(Gg=this.getDynamicBatch(Gr,Gl),Gb=null),Gk)if(Gg._addCombineRenderObjTest(Gf)){if(Gb!==(Ge=Gf._material))Gh&&(Ga.getRenderQueue(Gi._material.renderQueue)._addRenderElement(Gi),Gi=Gh=null,Go=-1),Gh=Ge,Go=Gg.combineRenderElementsCount,Gi=Gf,Gb=Ge;else if(Gh){var Gu=Gi.renderObj,Gv=Gf.renderObj;Gu._getVertexBuffer().vertexCount+Gv._getVertexBuffer().vertexCount>Gaa.maxVertexCount||Gu._getIndexBuffer().indexCount+Gv._getIndexBuffer().indexCount>Gaa.maxIndexCount?(Ga.getRenderQueue(Gi._material.renderQueue)._addRenderElement(Gi),Gh=Ge,Go=Gg.combineRenderElementsCount,Gi=Gf):(Gg._addCombineMaterial(Gh),Gg._addMaterialToRenderElementOffset(Go),Gg._addCombineRenderObj(Gi),Gi=Gh=null,Go=-1,Gg._addCombineRenderObj(Gf))}else Gg._addCombineRenderObj(Gf);Gk=!0}else Gh&&(Ga.getRenderQueue(Gi._material.renderQueue)._addRenderElement(Gi),Gi=Gh=null,Go=-1),Gl++,Gk=!1;else Gd=this._prepareDynamicBatchCombineElements[Gp-1],Gg._addMaterialToRenderElementOffset(Gg.combineRenderElementsCount),Gb=Gd._material,Gg._addCombineMaterial(Gb),Gg._addCombineRenderObj(Gd),Gk=!0,Gb!==(Ge=Gf._material)?(Gh=Ge,Go=Gg.combineRenderElementsCount,Gi=Gf):Gg._addCombineRenderObj(Gf),Gb=Ge}Gh&&(Ga.getRenderQueue(Gi._material.renderQueue)._addRenderElement(Gi),Gi=Gh=null,Go=-1),this._prepareDynamicBatchCombineElements.length=0},Ga._clearRenderElements=function(){for(var Ga in this._dynamicBatches)this._dynamicBatches[Ga]._clearRenderElements()},Ga._addToRenderQueue=function(Ga,Gb,Gc,Gd){for(var Ge in this._dynamicBatches){var Gf=this._dynamicBatches[Ge];0<Gf.combineRenderElementsCount&&Gf._addToRenderQueue(Ga,Gb,Gc,Gd)}},Ga.dispose=function(){this._dynamicBatches=null},Gw._sortPrepareDynamicBatch=function(Ga,Gb){return Ga._mainSortID-Gb._mainSortID},Gw}(),Gca=function(){function Ga(){}return Gp(Ga,"laya.d3.graphics.FrustumCulling"),Ga.renderShadowObjectCulling=function(Ga,Gb,Gc,Gd,Ge){var Gf=0,Gg=0,Gh=0,Gi=0;for(Gf=0,Gh=Gc.length;Gf<Gh;Gf++){var Gj=Gc[Gf];Gj&&Gj._clearRenderElements()}var Gk,Gl,Go,Gp=Ga._cullingRenders;if(1<Ge){for(Gf=0,Gh=Ga._cullingRendersLength;Gf<Gh;Gf++)if((Gk=Gp[Gf]).castShadow&&GI.isVisible(Gk._owner.layer.mask)&&Gk.enable)for(var Gq=1,Gr=Gb.length;Gq<Gr;Gq++)if(Gl=Gc[Gq-1],0!==Gb[Gq].containsBoundSphere(Gk.boundingSphere))for(Gg=0,Gi=(Go=Gk._renderElements).length;Gg<Gi;Gg++)Gl._addRenderElement(Go[Gg])}else for(Gf=0,Gh=Ga._cullingRendersLength;Gf<Gh;Gf++)if((Gk=Gp[Gf]).castShadow&&GI.isVisible(Gk._owner.layer.mask)&&Gk.enable&&0!==Gb[0].containsBoundSphere(Gk.boundingSphere))for(Gk._renderUpdate(Gd),Gl=Gc[0],Gg=0,Gi=(Go=Gk._renderElements).length;Gg<Gi;Gg++)Gl._addRenderElement(Go[Gg])},Ga.renderShadowObjectCullingOctree=function(Ga,Gb,Gc,Gd,Ge){for(var Gf=0,Gg=Gc.length;Gf<Gg;Gf++){var Gh=Gc[Gf];Gh&&Gh._clearRenderElements()}1<Ge?Ga.treeRoot.cullingShadowObjects(Gb,Gc,!0,0,Ga):Ga.treeRoot.cullingShadowObjectsOnePSSM(Gb[0],Gc,Gd,!0,0,Ga)},Ga.renderObjectCulling=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=0,Gh=0,Gi=0,Gj=0,Gk=Gb._quenes,Gl=Gb._dynamicBatchManager,Go=Gb._cullingRenders;for(Gg=0,Gh=Gk.length;Gg<Gh;Gg++){var Gp=Gk[Gg];Gp&&Gp._clearRenderElements()}var Gq=Gda._staticBatchManagers;for(Gg=0,Gh=Gq.length;Gg<Gh;Gg++)Gq[Gg]._clearRenderElements();Gl._clearRenderElements();var Gr=Gc.transform.position;for(Gg=0,Gh=Gb._cullingRendersLength;Gg<Gh;Gg++){var Gs=Go[Gg];if(GI.isVisible(Gs._owner.layer.mask)&&Gs.enable&&0!==Ga.containsBoundSphere(Gs.boundingSphere)&&Gs._renderUpdate(Gf)){Gs._distanceForSort=Ggb.distance(Gs.boundingSphere.center,Gr)+Gs.sortingFudge;var Gt=Gs._renderElements;for(Gi=0,Gj=Gt.length;Gi<Gj;Gi++){var Gu=Gt[Gi],Gv=Gu._staticBatch;if(Gv&&Gv._material===Gu._material)Gv._addBatchRenderElement(Gu);else{var Gw=Gu.renderObj;Gw.triangleCount<10&&1===Gw._vertexBufferCount&&Gw._getIndexBuffer()&&Gu._material.renderQueue<2&&Gu._canDynamicBatch&&!Gs._owner.isStatic?Gl._addPrepareRenderElement(Gu):Gb.getRenderQueue(Gu._material.renderQueue)._addRenderElement(Gu)}}}}for(Gg=0,Gh=Gq.length;Gg<Gh;Gg++)Gq[Gg]._addToRenderQueue(Gb,Gd,Ge,Gf);Gl._finishCombineDynamicBatch(Gb),Gl._addToRenderQueue(Gb,Gd,Ge,Gf)},Ga.renderObjectCullingOctree=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=0,Gh=0,Gi=Gb._quenes,Gj=Gb._dynamicBatchManager;for(Gg=0,Gh=Gi.length;Gg<Gh;Gg++){var Gk=Gi[Gg];Gk&&Gk._clearRenderElements()}var Gl=Gda._staticBatchManagers;for(Gg=0,Gh=Gl.length;Gg<Gh;Gg++)Gl[Gg]._clearRenderElements();for(Gj._clearRenderElements(),Gb._cullingRenders.length=0,Gb.treeRoot.cullingObjects(Ga,!0,0,Gc.transform.position,Gf),Gg=0,Gh=Gl.length;Gg<Gh;Gg++)Gl[Gg]._addToRenderQueue(Gb,Gd,Ge,Gf);Gj._finishCombineDynamicBatch(Gb),Gj._addToRenderQueue(Gb,Gd,Ge,Gf)},Ga.renderObjectCullingNoBoundFrustum=function(Ga,Gb,Gc,Gd,Ge){var Gf=0,Gg=0,Gh=0,Gi=0,Gj=Ga._quenes,Gk=Ga._dynamicBatchManager,Gl=Ga._cullingRenders;for(Gf=0,Gg=Gj.length;Gf<Gg;Gf++){var Go=Gj[Gf];Go&&Go._clearRenderElements()}var Gp=Gda._staticBatchManagers;for(Gf=0,Gg=Gp.length;Gf<Gg;Gf++)Gp[Gf]._clearRenderElements();Gk._clearRenderElements();var Gq=Gb.transform.position;for(Gf=0,Gg=Ga._cullingRendersLength;Gf<Gg;Gf++){var Gr=Gl[Gf];if(GI.isVisible(Gr._owner.layer.mask)&&Gr.enable){Gr._renderUpdate(Ge),Gr._distanceForSort=Ggb.distance(Gr.boundingSphere.center,Gq)+Gr.sortingFudge;var Gs=Gr._renderElements;for(Gh=0,Gi=Gs.length;Gh<Gi;Gh++){var Gt=Gs[Gh],Gu=Gt._staticBatch;if(Gu&&Gu._material===Gt._material)Gu._addBatchRenderElement(Gt);else{var Gv=Gt.renderObj;Gv.triangleCount<10&&1===Gv._vertexBufferCount&&Gv._getIndexBuffer()&&Gt._material.renderQueue<2&&Gt._canDynamicBatch&&!Gr._owner.isStatic?Gk._addPrepareRenderElement(Gt):Ga.getRenderQueue(Gt._material.renderQueue)._addRenderElement(Gt)}}}}for(Gf=0,Gg=Gp.length;Gf<Gg;Gf++)Gp[Gf]._addToRenderQueue(Ga,Gc,Gd,Ge);Gk._finishCombineDynamicBatch(Ga),Gk._addToRenderQueue(Ga,Gc,Gd,Ge)},Ga}(),Gda=function(){function Gf(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}Gp(Gf,"laya.d3.graphics.StaticBatchManager");var Ga=Gf.prototype;return Ga._finishInit=function(){for(var Ga in this._staticBatches)this._staticBatches[Ga]._finishInit();this._initBatchRenderElements.length=0},Ga._initStaticBatchs=function(Ga){throw new Error("StaticBatchManager:must override this function.")},Ga._addInitBatchSprite=function(Ga){for(var Gb=Ga._render._renderElements,Gc=0,Gd=Gb.length;Gc<Gd;Gc++)this._initBatchRenderElements.push(Gb[Gc])},Ga._clearRenderElements=function(){for(var Ga in this._staticBatches)this._staticBatches[Ga]._clearRenderElements()},Ga._garbageCollection=function(Ga){var Gb=Ga._staticBatch,Gc=Gb._initBatchRenderElements,Gd=Gc.indexOf(Ga);Gc.splice(Gd,1),0===Gc.length&&(Gb.dispose(),delete this._staticBatches[Gb._key])},Ga._addToRenderQueue=function(Ga,Gb,Gc,Gd){for(var Ge in this._staticBatches){var Gf=this._staticBatches[Ge];0<Gf._batchRenderElements.length&&Gf._updateToRenderQueue(Ga,Gd)}},Ga.dispose=function(){this._staticBatches=null},Gf._addToStaticBatchQueue=function(Ga){Ga instanceof laya.d3.core.RenderableSprite3D&&Ga._addToInitStaticBatchManager();for(var Gb=0,Gc=Ga.numChildren;Gb<Gc;Gb++)Gf._addToStaticBatchQueue(Ga._childs[Gb])},Gf.combine=function(Ga,Gb){var Gc,Gd=0,Ge=0;if(Gb)for(Gd=0,Ge=Gb.length;Gd<Ge;Gd++){Gb[Gd]._addToInitStaticBatchManager()}else Ga&&Gf._addToStaticBatchQueue(Ga);for(Gd=0,Ge=Gf._staticBatchManagers.length;Gd<Ge;Gd++)(Gc=Gf._staticBatchManagers[Gd])._initStaticBatchs(Ga),Gc._finishInit()},Gf._staticBatchManagers=[],Gf}(),Gea=function(){function Ga(Ga,Gb,Gc){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=Ga,this._manager=Gb,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=Gc}Gp(Ga,"laya.d3.graphics.StaticBatch");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),Gb._binarySearch=function(Ga){for(var Gb=0,Gc=this._batchRenderElements.length-1,Gd=0;Gb<=Gc;)Gd=Math.floor((Gb+Gc)/2),this._compareBatchRenderElement(this._batchRenderElements[Gd],Ga)?Gc=Gd-1:Gb=Gd+1;return Gb},Gb._compareBatchRenderElement=function(Ga,Gb){throw new Error("StaticBatch:must override this function.")},Gb._getVertexDecLightMap=function(Ga){return Ga===GNa.vertexDeclaration?GIa.vertexDeclaration:Ga===GMa.vertexDeclaration?GHa.vertexDeclaration:Ga===GBa.vertexDeclaration?Gwa.vertexDeclaration:Ga===GRa.vertexDeclaration?null:Ga===Gra.vertexDeclaration?Gsa.vertexDeclaration:Ga===GPa.vertexDeclaration?GKa.vertexDeclaration:Ga===GFa.vertexDeclaration?GGa.vertexDeclaration:Ga===GOa.vertexDeclaration?GJa.vertexDeclaration:Ga===GMa.vertexDeclaration?GHa.vertexDeclaration:Ga===GCa.vertexDeclaration?Gxa.vertexDeclaration:Ga===GRa.vertexDeclaration?null:Ga===Gra.vertexDeclaration?Gsa.vertexDeclaration:Ga===GQa.vertexDeclaration?GLa.vertexDeclaration:Ga===GFa.vertexDeclaration?GGa.vertexDeclaration:Ga},Gb._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},Gb._addBatchRenderElement=function(Ga){this._batchRenderElements.splice(this._binarySearch(Ga),0,Ga)},Gb._updateToRenderQueue=function(Ga,Gb){this._combineRenderElementPoolIndex=0,this._getRenderElement(Ga.getRenderQueue(this._material.renderQueue)._renderElements,Ga,Gb)},Gb._getRenderElement=function(Ga,Gb,Gc){throw new Error("StaticBatch:must override this function.")},Gb._finishInit=function(){throw new Error("StaticBatch:must override this function.")},Gb._clearRenderElements=function(){this._batchRenderElements.length=0},Gb.dispose=function(){},Gb._getVertexBuffer=function(Ga){return void 0===Ga&&(Ga=0),null},Gb._getIndexBuffer=function(){return null},Gb._beforeRender=function(Ga){return!0},Gb._render=function(Ga){},Gb._getVertexBuffers=function(){return null},Gq(0,Gb,"_vertexBufferCount",function(){return 1}),Gq(0,Gb,"triangleCount",function(){return 0}),Ga.combine=function(Ga){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),Gda.combine(Ga)},Ga.maxBatchVertexCount=65535,Ga}(),Gfa=function(){function Gg(Ga,Gb){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++Gg._uniqueIDCounter,this._id>Gg.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",Gg.maxVertexDeclaration);this._shaderValues=new Gob,this._vertexElementsDic={},this._vertexStride=Ga,this._vertexElements=Gb;for(var Gc=0;Gc<Gb.length;Gc++){var Gd=Gb[Gc],Ge=Gd.elementUsage;this._vertexElementsDic[Ge]=Gd;var Gf=[Gg._getTypeSize(Gd.elementFormat)/4,5126,!1,this._vertexStride,Gd.offset];switch(this._shaderValues.setValue(Ge,Gf),Ge){case 1:this._addShaderDefine(GAb.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(GAb.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(GAb.SHADERDEFINE_UV1)}}}Gp(Gg,"laya.d3.graphics.VertexDeclaration");var Ga=Gg.prototype;return Ga._addShaderDefine=function(Ga){this._shaderDefineValue|=Ga},Ga._removeShaderDefine=function(Ga){this._shaderDefineValue&=~Ga},Ga.getVertexElements=function(){return this._vertexElements.slice()},Ga.getVertexElementByUsage=function(Ga){return this._vertexElementsDic[Ga]},Ga.unBinding=function(){},Gq(0,Ga,"shaderDefineValue",function(){return this._shaderDefineValue}),Gq(0,Ga,"id",function(){return this._id}),Gq(0,Ga,"vertexStride",function(){return this._vertexStride}),Gq(0,Ga,"shaderValues",function(){return this._shaderValues}),Gg._getTypeSize=function(Ga){switch(Ga){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},Gg.getVertexStride=function(Ga){for(var Gb=0,Gc=0;Gc<Ga.Length;Gc++){var Gd=Ga[Gc],Ge=Gd.offset+Gg._getTypeSize(Gd.elementFormat);Gb<Ge&&(Gb=Ge)}return Gb},Gg._maxVertexDeclarationBit=1e3,Gg._uniqueIDCounter=1,Gl(Gg,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),Gg}(),Gga=function(){function Ga(Ga,Gb,Gc){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=Ga,this.elementFormat=Gb,this.elementUsage=Gc}return Gp(Ga,"laya.d3.graphics.VertexElement"),Ga}(),Gha=(function(){function Ga(){}Gp(Ga,"laya.d3.graphics.VertexElementFormat"),Ga.Single="single",Ga.Vector2="vector2",Ga.Vector3="vector3",Ga.Vector4="vector4",Ga.Color="color",Ga.Byte4="byte4",Ga.Short2="short2",Ga.Short4="short4",Ga.NormalizedShort2="normalizedshort2",Ga.NormalizedShort4="normalizedshort4",Ga.HalfVector2="halfvector2",Ga.HalfVector4="halfvector4"}(),function(){function Ga(){}Gp(Ga,"laya.d3.graphics.VertexElementUsage"),Ga.POSITION0=0,Ga.COLOR0=1,Ga.TEXTURECOORDINATE0=2,Ga.NORMAL0=3,Ga.BINORMAL0=4,Ga.TANGENT0=5,Ga.BLENDINDICES0=6,Ga.BLENDWEIGHT0=7,Ga.DEPTH0=8,Ga.FOG0=9,Ga.POINTSIZE0=10,Ga.SAMPLE0=11,Ga.TESSELLATEFACTOR0=12,Ga.COLOR1=13,Ga.NEXTTEXTURECOORDINATE0=14,Ga.TEXTURECOORDINATE1=15,Ga.NEXTTEXTURECOORDINATE1=16,Ga.CORNERTEXTURECOORDINATE0=17,Ga.VELOCITY0=18,Ga.STARTCOLOR0=19,Ga.STARTSIZE=20,Ga.AGEADDSCALE0=21,Ga.STARTROTATION=22,Ga.ENDCOLOR0=23,Ga.STARTLIFETIME=24,Ga.TIME0=33,Ga.SHAPEPOSITIONSTARTLIFETIME=30,Ga.DIRECTIONTIME=32,Ga.SIZEROTATION0=27,Ga.RADIUS0=28,Ga.RADIAN0=29,Ga.STARTSPEED=31,Ga.RANDOM0=34,Ga.RANDOM1=35,Ga.SIMULATIONWORLDPOSTION=36,Ga.SIMULATIONWORLDROTATION=37,Ga.TEXTURECOORDINATE0X=38,Ga.TEXTURECOORDINATE0X1=39,Ga.TEXTURECOORDINATE0Y=40,Ga.OFFSETVECTOR=41}(),function(){function Ga(Ga,Gb,Gc){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=Ga,this._textureCoordinate0=Gb,this._time=Gc}Gp(Ga,"laya.d3.graphics.VertexGlitter");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate0}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"time",function(){return this._time}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(24,[new Gga(0,"vector3",0),new Gga(12,"vector2",2),new Gga(20,"single",33)])}])}(),function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=Ga,this._position=Gb,this._velocity=Gc,this._startColor=Gd,this._endColor=Ge,this._sizeRotation=Gf,this._radius=Gg,this._radian=Gh,this._ageAddScale=Gi,this._time=Gj}Gp(Ga,"laya.d3.graphics.VertexParticle");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"endColor",function(){return this._endColor}),Gq(0,Gb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Gq(0,Gb,"sizeRotation",function(){return this._sizeRotation}),Gq(0,Gb,"velocity",function(){return this._velocity}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"startColor",function(){return this._startColor}),Gq(0,Gb,"radius",function(){return this._radius}),Gq(0,Gb,"radian",function(){return this._radian}),Gq(0,Gb,"ageAddScale",function(){return this._ageAddScale}),Gq(0,Gb,"time",function(){return this._time}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(116,[new Gga(0,"vector4",17),new Gga(16,"vector3",0),new Gga(28,"vector3",18),new Gga(40,"vector4",19),new Gga(56,"vector4",23),new Gga(72,"vector3",27),new Gga(84,"vector2",28),new Gga(92,"vector4",29),new Gga(108,"single",24),new Gga(112,"single",33)])}])}(),function(){function Ga(Ga){this._position=null,this._position=Ga}Gp(Ga,"laya.d3.graphics.VertexPosition");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(12,[new Gga(0,"vector3",0)])}]),Ga}()),Gia=function(){function Ga(Ga,Gb){this._position=null,this._normal=null,this._position=Ga,this._normal=Gb}Gp(Ga,"laya.d3.graphics.VertexPositionNormal");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(24,[new Gga(0,"vector3",0),new Gga(12,"vector3",3)])}]),Ga}(),Gja=function(){function Ga(Ga,Gb,Gc){this._position=null,this._normal=null,this._color=null,this._position=Ga,this._normal=Gb,this._color=Gc}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColor");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(40,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1)])}]),Ga}(),Gka=function(){function Ga(Ga,Gb,Gc,Gd,Ge){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._blendIndex=Gd,this._blendWeight=Ge}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorSkin");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(72,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector4",7),new Gga(56,"vector4",6)])}]),Ga}(),Gla=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._tangent=Gd,this._blendIndex=Ge,this._blendWeight=Gf}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(88,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector4",7),new Gga(56,"vector4",6),new Gga(72,"vector4",5)])}]),Ga}(),Goa=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._tangent=Gd,this._blendIndex=Ge,this._blendWeight=Gf}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(84,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector4",7),new Gga(56,"vector4",6),new Gga(72,"vector3",5)])}]),Ga}(),Gpa=function(){function Ga(Ga,Gb,Gc,Gd){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._tangent=Gd}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorSTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(56,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector4",5)])}]),Ga}(),Gqa=function(){function Ga(Ga,Gb,Gc,Gd){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._tangent=Gd}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(52,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector3",5)])}]),Ga}(),Gra=function(){function Ga(Ga,Gb,Gc,Gd){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._textureCoordinate=Gd}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTexture");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(48,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector2",2)])}]),Ga}(),Gsa=function(){function Ga(Ga,Gb,Gc,Gd,Ge){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._textureCoordinate0=Gd,this._textureCoordinate1=Ge}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(56,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector2",2),new Gga(48,"vector2",15)])}]),Ga}(),Gta=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._textureCoordinate0=Gd,this._textureCoordinate1=Ge,this._blendIndex=Gf,this._blendWeight=Gg}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(88,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector2",2),new Gga(48,"vector2",15),new Gga(56,"vector4",7),new Gga(72,"vector4",6)])}]),Ga}(),Gua=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._textureCoordinate0=Gd,this._textureCoordinate1=Ge,this._tangent=Gf,this._blendIndex=Gg,this._blendWeight=Gh}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(104,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector2",2),new Gga(48,"vector2",15),new Gga(56,"vector4",7),new Gga(72,"vector4",6),new Gga(88,"vector4",5)])}]),Ga}(),Gva=function(){function Ga(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gb.VertexPositionNormalColorTexture0SkinTangent=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){this._position=Ga,this._normal=Gb,this._color=Gc,this._textureCoordinate0=Gd,this._textureCoordinate1=Ge,this._tangent=Gf,this._blendIndex=Gg,this._blendWeight=Gh},Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(100,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector2",2),new Gga(48,"vector2",15),new Gga(56,"vector4",7),new Gga(72,"vector4",6),new Gga(88,"vector3",5)])}]),Ga}(),Gwa=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._textureCoordinate0=Gd,this._textureCoordinate1=Ge,this._tangent=Gf}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(72,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector2",2),new Gga(48,"vector2",15),new Gga(56,"vector4",5)])}]),Ga}(),Gxa=function(){function Ga(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gb.VertexPositionNormalColorTexture0Tangent=function(Ga,Gb,Gc,Gd,Ge,Gf){this._position=Ga,this._normal=Gb,this._color=Gc,this._textureCoordinate0=Gd,this._textureCoordinate1=Ge,this._tangent=Gf},Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(68,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector2",2),new Gga(48,"vector2",15),new Gga(56,"vector3",5)])}]),Ga}(),Gya=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._textureCoordinate=Gd,this._blendIndex=Ge,this._blendWeight=Gf}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(80,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector2",2),new Gga(48,"vector4",7),new Gga(64,"vector4",6)])}]),Ga}(),Gza=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._textureCoordinate=Gd,this._tangent=Ge,this._blendIndex=Gf,this._blendWeight=Gg}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(96,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector2",2),new Gga(48,"vector4",7),new Gga(64,"vector4",6),new Gga(80,"vector4",5)])}]),Ga}(),GAa=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._textureCoordinate=Gd,this._tangent=Ge,this._blendIndex=Gf,this._blendWeight=Gg}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(92,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector2",2),new Gga(48,"vector4",7),new Gga(64,"vector4",6),new Gga(80,"vector3",5)])}]),Ga}(),GBa=function(){function Ga(Ga,Gb,Gc,Gd,Ge){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._textureCoordinate=Gd,this._tangent=Ge}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(64,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector2",2),new Gga(48,"vector4",5)])}]),Ga}(),GCa=function(){function Ga(Ga,Gb,Gc,Gd,Ge){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._color=Gc,this._textureCoordinate=Gd,this._tangent=Ge}Gp(Ga,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"color",function(){return this._color}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(60,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",1),new Gga(40,"vector2",2),new Gga(48,"vector3",5)])}]),Ga}(),GDa=function(){function Ga(Ga,Gb,Gc){this._position=null,this._normal=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._tangent=Gc}Gp(Ga,"laya.d3.graphics.VertexPositionNormalSTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(40,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector4",5)])}]),Ga}(),GEa=function(){function Ga(Ga,Gb,Gc){this._position=null,this._normal=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._tangent=Gc}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(36,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector3",5)])}]),Ga}(),GFa=function(){function Ga(Ga,Gb,Gc){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Ga,this._normal=Gb,this._textureCoordinate=Gc}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTexture");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(32,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2)])}]),Ga}(),GGa=function(){function Ga(Ga,Gb,Gc,Gd){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=Ga,this._normal=Gb,this._textureCoordinate0=Gc,this._textureCoordinate1=Gd}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(40,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2),new Gga(32,"vector2",15)])}]),Ga}(),GHa=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=Ga,this._normal=Gb,this._textureCoordinate0=Gc,this._textureCoordinate1=Gd,this._blendIndex=Ge,this._blendWeight=Gf}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(72,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2),new Gga(32,"vector2",15),new Gga(40,"vector4",7),new Gga(56,"vector4",6)])}]),Ga}(),GIa=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._textureCoordinate0=Gc,this._textureCoordinate1=Gd,this._tangent=Ge,this._blendIndex=Gf,this._blendWeight=Gg}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(88,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2),new Gga(32,"vector2",15),new Gga(40,"vector4",7),new Gga(56,"vector4",6),new Gga(72,"vector4",5)])}]),Ga}(),GJa=function(){function Ga(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gb.VertexPositionNormalTexture0SkinTangent=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){this._position=Ga,this._normal=Gb,this._textureCoordinate0=Gc,this._textureCoordinate1=Gd,this._tangent=Ge,this._blendIndex=Gf,this._blendWeight=Gg},Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(84,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2),new Gga(32,"vector2",15),new Gga(40,"vector4",7),new Gga(56,"vector4",6),new Gga(72,"vector3",5)])}]),Ga}(),GKa=function(){function Ga(Ga,Gb,Gc,Gd,Ge){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._textureCoordinate0=Gc,this._textureCoordinate1=Gd,this._tangent=Ge}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(56,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2),new Gga(32,"vector2",15),new Gga(40,"vector4",5)])}]),Ga}(),GLa=function(){function Ga(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gb.VertexPositionNormalTexture0Tangent=function(Ga,Gb,Gc,Gd,Ge){this._position=Ga,this._normal=Gb,this._textureCoordinate0=Gc,this._textureCoordinate1=Gd,this._tangent=Ge},Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(52,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2),new Gga(32,"vector2",15),new Gga(40,"vector3",5)])}]),Ga}(),GMa=function(){function Ga(Ga,Gb,Gc,Gd,Ge){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=Ga,this._normal=Gb,this._textureCoordinate=Gc,this._blendIndex=Gd,this._blendWeight=Ge}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTextureSkin");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(64,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2),new Gga(32,"vector4",7),new Gga(48,"vector4",6)])}]),Ga}(),GNa=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._textureCoordinate=Gc,this._tangent=Gd,this._blendIndex=Ge,this._blendWeight=Gf}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(80,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2),new Gga(32,"vector4",7),new Gga(48,"vector4",6),new Gga(64,"vector4",5)])}]),Ga}(),GOa=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._textureCoordinate=Gc,this._tangent=Gd,this._blendIndex=Ge,this._blendWeight=Gf}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(76,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2),new Gga(32,"vector4",7),new Gga(48,"vector4",6),new Gga(64,"vector3",5)])}]),Ga}(),GPa=function(){function Ga(Ga,Gb,Gc,Gd){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._textureCoordinate=Gc,this._tangent=Gd}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(48,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2),new Gga(32,"vector4",5)])}]),Ga}(),GQa=function(){function Ga(Ga,Gb,Gc,Gd){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=Ga,this._normal=Gb,this._textureCoordinate=Gc,this._tangent=Gd}Gp(Ga,"laya.d3.graphics.VertexPositionNormalTextureTangent");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(44,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2),new Gga(32,"vector3",5)])}]),Ga}(),GRa=function(){function Ga(Ga,Gb,Gc){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Ga,this._normal=Gb,this._textureCoordinate=Gc}Gp(Ga,"laya.d3.graphics.VertexPositionNTBTexture");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(56,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector3",5),new Gga(36,"vector3",4),new Gga(48,"vector2",2)])}]),Ga}(),GSa=function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=Ga,this._normal=Gb,this._textureCoordinate0=Gd,this._textureCoordinate1=Ge,this._tangent=Gf,Gc=Gc,this._blendIndex=Gg,this._blendWeight=Gh}Gp(Ga,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"tangent",function(){return this._tangent}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(0,Gb,"textureCoordinate1",function(){return this._textureCoordinate1}),Gq(0,Gb,"blendIndex",function(){return this._blendIndex}),Gq(0,Gb,"blendWeight",function(){return this._blendWeight}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(96,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector3",5),new Gga(36,"vector3",4),new Gga(48,"vector2",2),new Gga(56,"vector2",15),new Gga(64,"vector4",7),new Gga(80,"vector4",6)])}]),Ga}(),GTa=function(){function Ga(Ga,Gb,Gc){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=Ga,this._normal=Gb,this._textureCoordinate=Gc}Gp(Ga,"laya.d3.graphics.VertexPositionNTBTextureSkin");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"textureCoordinate",function(){return this._textureCoordinate}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(88,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector3",5),new Gga(36,"vector3",4),new Gga(48,"vector2",2),new Gga(56,"vector4",7),new Gga(72,"vector4",6)])}]),Ga}(),GUa=(function(){function Ga(Ga,Gb,Gc,Gd){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=Ga,this._normal=Gb,this._textureCoord0=Gc,this._textureCoord1=Gd}Gp(Ga,"laya.d3.graphics.VertexPositionTerrain");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"normal",function(){return this._normal}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"textureCoord0",function(){return this._textureCoord0}),Gq(0,Gb,"textureCoord1",function(){return this._textureCoord1}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(40,[new Gga(0,"vector3",0),new Gga(12,"vector3",3),new Gga(24,"vector2",2),new Gga(32,"vector2",15)])}])}(),function(){function Ga(Ga,Gb){this._position=null,this._textureCoordinate0=null,this._position=Ga,this._textureCoordinate0=Gb}Gp(Ga,"laya.d3.graphics.VertexPositionTexture0");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"position",function(){return this._position}),Gq(0,Gb,"textureCoordinate0",function(){return this._textureCoordinate0}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(20,[new Gga(0,"vector3",0),new Gga(12,"vector2",2)])}]),Ga}()),GVa=(function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Gl,Go,Gp){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=Ga,this._positionStartLifeTime=Gb,this._velocity=Gc,this._startColor=Gd,this._startSize=Ge,this._startRotation0=Gf,this._startRotation1=Gg,this._startRotation2=Gh,this._startLifeTime=Gi,this._time=Gj,this._startSpeed=Gk,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=Gp}Gp(Ga,"laya.d3.graphics.VertexShurikenParticleBillboard");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Gq(0,Gb,"random1",function(){return this._randoms1}),Gq(0,Gb,"startRotation2",function(){return this._startRotation2}),Gq(0,Gb,"positionStartLifeTime",function(){return this._positionStartLifeTime}),Gq(0,Gb,"velocity",function(){return this._velocity}),Gq(0,Gb,"random0",function(){return this._randoms0}),Gq(0,Gb,"startSize",function(){return this._startSize}),Gq(0,Gb,"startColor",function(){return this._startColor}),Gq(0,Gb,"startRotation0",function(){return this._startRotation0}),Gq(0,Gb,"startRotation1",function(){return this._startRotation1}),Gq(0,Gb,"startLifeTime",function(){return this._startLifeTime}),Gq(0,Gb,"time",function(){return this._time}),Gq(0,Gb,"startSpeed",function(){return this._startSpeed}),Gq(0,Gb,"simulationWorldPostion",function(){return this._simulationWorldPostion}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(152,[new Gga(0,"vector4",17),new Gga(16,"vector4",30),new Gga(32,"vector4",32),new Gga(48,"vector4",19),new Gga(64,"vector3",20),new Gga(76,"vector3",22),new Gga(88,"single",31),new Gga(92,"vector4",34),new Gga(108,"vector4",35),new Gga(124,"vector3",36),new Gga(136,"vector4",37)])}])}(),function(){function Ga(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Gl,Go,Gp){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=Ga,this._positionStartLifeTime=Gb,this._velocity=Gc,this._startColor=Gd,this._startSize=Ge,this._startRotation0=Gf,this._startRotation1=Gg,this._startRotation2=Gh,this._startLifeTime=Gi,this._time=Gj,this._startSpeed=Gk,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=Gp}Gp(Ga,"laya.d3.graphics.VertexShurikenParticleMesh");var Gb=Ga.prototype;Gx.imps(Gb,{"laya.d3.graphics.IVertex":!0}),Gq(0,Gb,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),Gq(0,Gb,"velocity",function(){return this._velocity}),Gq(0,Gb,"position",function(){return this._positionStartLifeTime}),Gq(0,Gb,"random0",function(){return this._randoms0}),Gq(0,Gb,"startSize",function(){return this._startSize}),Gq(0,Gb,"startColor",function(){return this._startColor}),Gq(0,Gb,"startRotation0",function(){return this._startRotation0}),Gq(0,Gb,"startRotation1",function(){return this._startRotation1}),Gq(0,Gb,"random1",function(){return this._randoms1}),Gq(0,Gb,"startRotation2",function(){return this._startRotation2}),Gq(0,Gb,"startLifeTime",function(){return this._startLifeTime}),Gq(0,Gb,"time",function(){return this._time}),Gq(0,Gb,"startSpeed",function(){return this._startSpeed}),Gq(0,Gb,"simulationWorldPostion",function(){return this._simulationWorldPostion}),Gq(0,Gb,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gq(1,Ga,"vertexDeclaration",function(){return Ga._vertexDeclaration}),Gl(Ga,["_vertexDeclaration",function(){return this._vertexDeclaration=new Gfa(172,[new Gga(0,"vector3",0),new Gga(12,"vector4",1),new Gga(28,"vector2",2),new Gga(36,"vector4",30),new Gga(52,"vector4",32),new Gga(68,"vector4",19),new Gga(84,"vector3",20),new Gga(96,"vector3",22),new Gga(108,"single",31),new Gga(112,"vector4",34),new Gga(128,"vector4",35),new Gga(144,"vector3",36),new Gga(156,"vector4",37)])}])}(),function(){function Gv(Ga,Gb,Gc,Gd,Ge,Gf){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=Gc,this._materials=Gd,this._subMeshes=Ge,this._materialMap=Gf,this._version=Gb,this._onLoaded(Ga)}Gp(Gv,"laya.d3.loaders.LoadModelV01");var Ga=Gv.prototype;return Ga._onLoaded=function(Ga){this._readData=Ga,this.READ_BLOCK();for(var Gb=0;Gb<this._BLOCK.count;Gb++){var Gc=this._readData.getUint16(),Gd=this._strings[Gc],Ge=this["READ_"+Gd];if(null==Ge)throw new Error("model file err,no this function:"+Gc+" "+Gd);if(!Ge.call(this))break}return this._mesh},Ga.onError=function(){},Ga._readString=function(){return this._strings[this._readData.getUint16()]},Ga.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},Ga.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},Ga.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var Ga=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var Gb=0;Gb<this._STRINGS.size;Gb++)this._strings[Gb]=this._readData.readUTFString();return this._readData.pos=Ga,!0},Ga.READ_MATERIAL=function(){var Ga=this._readData.getUint16(),Gb=(this._readString(),this._readString());return this._materials[Ga]="null"!==Gb?Gt.getRes(this._materialMap[Gb]):new GEb,!0},Ga.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var Ga,Gb=this._readData.__getBuffer(),Gc=0,Gd=this._readData.getUint32(),Ge=this._readData.getUint32(),Gf=(new Float32Array(Gb.slice(Gd+this._DATA.offset,Gd+this._DATA.offset+Ge)),this._readData.getUint32()),Gg=this._readData.getUint32(),Gh=new Float32Array(Gb.slice(Gf+this._DATA.offset,Gf+this._DATA.offset+Gg));for(this.mesh._inverseBindPoses=[],Gc=0,Ga=Gh.length;Gc<Ga;Gc+=16){var Gi=new Gab(Gh[Gc+0],Gh[Gc+1],Gh[Gc+2],Gh[Gc+3],Gh[Gc+4],Gh[Gc+5],Gh[Gc+6],Gh[Gc+7],Gh[Gc+8],Gh[Gc+9],Gh[Gc+10],Gh[Gc+11],Gh[Gc+12],Gh[Gc+13],Gh[Gc+14],Gh[Gc+15]);this.mesh._inverseBindPoses.push(Gi)}break;default:throw new Error("LoadModel:unknown version.")}return!0},Ga.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var Ga=this._readString();this._shaderAttributes=Ga.match(Gv._attrReg);var Gb=this._readData.getUint32(),Gc=this._readData.getUint32(),Gd=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),Ge=this._readData.getUint32(),Gf=this._readData.getUint32(),Gg=this._readData.getUint32(),Gh=this._readData.__getBuffer(),Gi=new Gjb(this._mesh),Gj=this._getVertexDeclaration(),Gk=GOb.create(Gj,Ge/Gj.vertexStride,35044,!0),Gl=Gd+this._DATA.offset,Go=Gh.slice(Gl,Gl+Ge);Gk.setData(new Float32Array(Go));for(var Gp=(Gi._vertexBuffer=Gk).vertexDeclaration.getVertexElements(),Gq=0;Gq<Gp.length;Gq++)Gi._bufferUsage[Gp[Gq].elementUsage]=Gk;var Gr=GNb.create("ushort",Gc/2,35044,!0),Gs=Gb+this._DATA.offset,Gt=Gh.slice(Gs,Gs+Gc);Gr.setData(new Uint16Array(Gt)),Gi._indexBuffer=Gr;var Gu=Gh.slice(Gf+this._DATA.offset,Gf+this._DATA.offset+Gg);return Gi._boneIndicesList[0]=new Uint8Array(Gu),this._subMeshes.push(Gi),!0},Ga.READ_DATAAREA=function(){return!1},Ga._getVertexDeclaration=function(){for(var Ga,Gb=!1,Gc=!1,Gd=!1,Ge=!1,Gf=!1,Gg=!1,Gh=!1,Gi=!1,Gj=!1,Gk=0;Gk<this._shaderAttributes.length;Gk+=8)switch(this._shaderAttributes[Gk]){case"POSITION":Gb=!0;break;case"NORMAL":Gc=!0;break;case"COLOR":Gd=!0;break;case"UV":Ge=!0;break;case"UV1":Gf=!0;break;case"BLENDWEIGHT":Gh=!0;break;case"BLENDINDICES":Gi=!0;break;case"TANGENT":Gg=!0;break;case"BINORMAL":Gj=!0}return Gb&&Gc&&Gd&&Ge&&Gf&&Gh&&Gi&&Gg?Ga=Gva.vertexDeclaration:Gb&&Gc&&Gd&&Ge&&Gf&&Gh&&Gi?Ga=Gta.vertexDeclaration:Gb&&Gc&&Ge&&Gf&&Gh&&Gi&&Gg?Ga=GJa.vertexDeclaration:Gb&&Gc&&Ge&&Gf&&Gh&&Gi?Ga=GHa.vertexDeclaration:Gb&&Gc&&Gd&&Ge&&Gh&&Gi&&Gg?Ga=GAa.vertexDeclaration:Gb&&Gc&&Gd&&Ge&&Gh&&Gi?Ga=Gya.vertexDeclaration:Gb&&Gc&&Gg&&Gj&&Ge&&Gh&&Gi?Ga=GTa.vertexDeclaration:Gb&&Gc&&Ge&&Gh&&Gi&&Gg?Ga=GOa.vertexDeclaration:Gb&&Gc&&Ge&&Gh&&Gi?Ga=GMa.vertexDeclaration:Gb&&Gc&&Gd&&Gh&&Gi&&Gg?Ga=Goa.vertexDeclaration:Gb&&Gc&&Gd&&Gh&&Gi?Ga=Gka.vertexDeclaration:Gb&&Gc&&Gd&&Ge&&Gf&&Gg?Ga=Gxa.vertexDeclaration:Gb&&Gc&&Gd&&Ge&&Gf?Ga=Gsa.vertexDeclaration:Gb&&Gc&&Ge&&Gf&&Gg?Ga=GLa.vertexDeclaration:Gb&&Gc&&Ge&&Gf?Ga=GGa.vertexDeclaration:Gb&&Gc&&Gd&&Ge&&Gg?Ga=GCa.vertexDeclaration:Gb&&Gc&&Ge&&Gg&&Gj?Ga=GRa.vertexDeclaration:Gb&&Gc&&Gd&&Ge?Ga=Gra.vertexDeclaration:Gb&&Gc&&Ge&&Gg?Ga=GQa.vertexDeclaration:Gb&&Gc&&Ge?Ga=GFa.vertexDeclaration:Gb&&Gc&&Gd&&Gg?Ga=Gqa.vertexDeclaration:Gb&&Gc&&Gd&&(Ga=Gja.vertexDeclaration),Ga},Gq(0,Ga,"mesh",function(){return this._mesh}),Gv._attrReg=new RegExp("(\\w+)|([:,;])","g"),Gv}()),GWa=function(){function Gz(){}return Gp(Gz,"laya.d3.loaders.LoadModelV02"),Gz.parse=function(Ga,Gb,Gc,Gd,Ge,Gf){Gz._mesh=Gc,Gz._materials=Gd,Gz._subMeshes=Ge,Gz._materialMap=Gf,Gz._version=Gb,Gz._readData=Ga,Gz.READ_DATA(),Gz.READ_BLOCK(),Gz.READ_STRINGS();for(var Gg=0,Gh=Gz._BLOCK.count;Gg<Gh;Gg++){Gz._readData.pos=Gz._BLOCK.blockStarts[Gg];var Gi=Gz._readData.getUint16(),Gj=Gz._strings[Gi],Gk=Gz["READ_"+Gj];if(null==Gk)throw new Error("model file err,no this function:"+Gi+" "+Gj);Gk.call()}Gz._strings.length=0,Gz._readData=null,Gz._version=null,Gz._mesh=null,Gz._materials=null,Gz._subMeshes=null,Gz._materialMap=null},Gz._readString=function(){return Gz._strings[Gz._readData.getUint16()]},Gz.READ_DATA=function(){Gz._DATA.offset=Gz._readData.getUint32(),Gz._DATA.size=Gz._readData.getUint32()},Gz.READ_BLOCK=function(){for(var Ga=Gz._BLOCK.count=Gz._readData.getUint16(),Gb=Gz._BLOCK.blockStarts=[],Gc=Gz._BLOCK.blockLengths=[],Gd=0;Gd<Ga;Gd++)Gb.push(Gz._readData.getUint32()),Gc.push(Gz._readData.getUint32())},Gz.READ_STRINGS=function(){var Ga=Gz._readData.getUint32(),Gb=Gz._readData.getUint16(),Gc=Gz._readData.pos;Gz._readData.pos=Ga+Gz._DATA.offset;for(var Gd=0;Gd<Gb;Gd++)Gz._strings[Gd]=Gz._readData.readUTFString();Gz._readData.pos=Gc},Gz.READ_MATERIAL=function(){Gz._readString(),Gz._readString();var Ga=Gz._readString();return""!==Ga&&Gz._materials.push(Gt.getRes(Gz._materialMap[Ga])),!0},Gz.READ_MESH=function(){Gz._readString();var Ga,Gb=Gz._readData.__getBuffer(),Gc=0,Gd=Gz._readData.getInt16(),Ge=Gz._DATA.offset;for(Gc=0;Gc<Gd;Gc++){var Gf=Ge+Gz._readData.getUint32(),Gg=Gz._readData.getUint32(),Gh=new Float32Array(Gb.slice(Gf,Gf+Gg)),Gi=Gz._readString().match(Gz._attrReg),Gj=Gz._getVertexDeclaration(Gi),Gk=GOb.create(Gj,4*Gh.length/Gj.vertexStride,35044,!0);Gk.setData(Gh),Gz._mesh._vertexBuffers.push(Gk)}var Gl=Ge+Gz._readData.getUint32(),Go=Gz._readData.getUint32(),Gp=new Uint16Array(Gb.slice(Gl,Gl+Go)),Gq=GNb.create("ushort",Go/2,35044,!0);Gq.setData(Gp),Gz._mesh._indexBuffer=Gq;var Gr=Gz._mesh._boneNames=[],Gs=Gz._readData.getUint16();for(Gr.length=Gs,Gc=0;Gc<Gs;Gc++)Gr[Gc]=Gz._strings[Gz._readData.getUint16()];var Gt=Gz._readData.getUint32(),Gu=Gz._readData.getUint32(),Gv=(new Float32Array(Gb.slice(Ge+Gt,Ge+Gt+Gu)),Gz._readData.getUint32()),Gw=Gz._readData.getUint32(),Gx=new Float32Array(Gb.slice(Ge+Gv,Ge+Gv+Gw));for(Gz._mesh._inverseBindPoses=[],Gc=0,Ga=Gx.length;Gc<Ga;Gc+=16){var Gy=new Gab(Gx[Gc+0],Gx[Gc+1],Gx[Gc+2],Gx[Gc+3],Gx[Gc+4],Gx[Gc+5],Gx[Gc+6],Gx[Gc+7],Gx[Gc+8],Gx[Gc+9],Gx[Gc+10],Gx[Gc+11],Gx[Gc+12],Gx[Gc+13],Gx[Gc+14],Gx[Gc+15]);Gz._mesh._inverseBindPoses.push(Gy)}return Gz._mesh._skinnedDatas=new Float32Array(16*Gx.length),!0},Gz.READ_SUBMESH=function(){var Ga=Gz._readData.__getBuffer(),Gb=new Gjb(Gz._mesh),Gc=Gz._readData.getInt16(),Gd=Gz._readData.getUint32(),Ge=Gz._readData.getUint32();Gb._vertexBuffer=Gz._mesh._vertexBuffers[Gc],Gb._vertexStart=Gd,Gb._vertexCount=Ge;var Gf=Gz._readData.getUint32(),Gg=Gz._readData.getUint32(),Gh=Gz._mesh._indexBuffer;Gb._indexBuffer=Gh,Gb._indexStart=Gf,Gb._indexCount=Gg,Gb._indices=new Uint16Array(Gh.getData().buffer,2*Gf,Gg);var Gi=Gz._DATA.offset,Gj=Gb._subIndexBufferStart,Gk=Gb._subIndexBufferCount,Gl=Gb._boneIndicesList,Go=Gz._readData.getUint16();Gj.length=Go,Gk.length=Go,Gl.length=Go;for(var Gp=0;Gp<Go;Gp++){Gj[Gp]=Gz._readData.getUint32(),Gk[Gp]=Gz._readData.getUint32();var Gq=Gz._readData.getUint32(),Gr=Gz._readData.getUint32();Gb._boneIndicesList[Gp]=new Uint8Array(Ga.slice(Gi+Gq,Gi+Gq+Gr))}return Gz._subMeshes.push(Gb),!0},Gz._getVertexDeclaration=function(Ga){for(var Gb,Gc=!1,Gd=!1,Ge=!1,Gf=!1,Gg=!1,Gh=!1,Gi=!1,Gj=!1,Gk=!1,Gl=0;Gl<Ga.length;Gl++)switch(Ga[Gl]){case"POSITION":Gc=!0;break;case"NORMAL":Gd=!0;break;case"COLOR":Ge=!0;break;case"UV":Gf=!0;break;case"UV1":Gg=!0;break;case"BLENDWEIGHT":Gi=!0;break;case"BLENDINDICES":Gj=!0;break;case"TANGENT":Gh=!0;break;case"BINORMAL":Gk=!0}return Gc&&Gd&&Ge&&Gf&&Gg&&Gi&&Gj&&Gh?Gb=Gva.vertexDeclaration:Gc&&Gd&&Ge&&Gf&&Gg&&Gi&&Gj?Gb=Gta.vertexDeclaration:Gc&&Gd&&Gf&&Gg&&Gi&&Gj&&Gh?Gb=GJa.vertexDeclaration:Gc&&Gd&&Gf&&Gg&&Gi&&Gj?Gb=GHa.vertexDeclaration:Gc&&Gd&&Ge&&Gf&&Gi&&Gj&&Gh?Gb=GAa.vertexDeclaration:Gc&&Gd&&Ge&&Gf&&Gi&&Gj?Gb=Gya.vertexDeclaration:Gc&&Gd&&Gf&&Gi&&Gj&&Gh?Gb=GOa.vertexDeclaration:Gc&&Gd&&Gf&&Gi&&Gj?Gb=GMa.vertexDeclaration:Gc&&Gd&&Ge&&Gi&&Gj&&Gh?Gb=Goa.vertexDeclaration:Gc&&Gd&&Ge&&Gi&&Gj?Gb=Gka.vertexDeclaration:Gc&&Gd&&Ge&&Gf&&Gg&&Gh?Gb=Gxa.vertexDeclaration:Gc&&Gd&&Ge&&Gf&&Gg?Gb=Gsa.vertexDeclaration:Gc&&Gd&&Gf&&Gg&&Gh?Gb=GLa.vertexDeclaration:Gc&&Gd&&Gf&&Gg?Gb=GGa.vertexDeclaration:Gc&&Gd&&Ge&&Gf&&Gh?Gb=GCa.vertexDeclaration:Gc&&Gd&&Gf&&Gh&&Gk?Gb=GRa.vertexDeclaration:Gc&&Gd&&Ge&&Gf?Gb=Gra.vertexDeclaration:Gc&&Gd&&Gf&&Gh?Gb=GQa.vertexDeclaration:Gc&&Gd&&Gf?Gb=GFa.vertexDeclaration:Gc&&Gd&&Ge&&Gh?Gb=Gqa.vertexDeclaration:Gc&&Gd&&Ge&&(Gb=Gja.vertexDeclaration),Gb},Gz._attrReg=new RegExp("(\\w+)|([:,;])","g"),Gz._strings=[],Gz._readData=null,Gz._version=null,Gz._mesh=null,Gz._materials=null,Gz._subMeshes=null,Gz._materialMap=null,Gl(Gz,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Gz}(),GXa=function(){function Gy(){}return Gp(Gy,"laya.d3.loaders.LoadModelV03"),Gy.parse=function(Ga,Gb,Gc,Gd,Ge){Gy._mesh=Gc,Gy._subMeshes=Gd,Gy._materialMap=Ge,Gy._version=Gb,Gy._readData=Ga,Gy.READ_DATA(),Gy.READ_BLOCK(),Gy.READ_STRINGS();for(var Gf=0,Gg=Gy._BLOCK.count;Gf<Gg;Gf++){Gy._readData.pos=Gy._BLOCK.blockStarts[Gf];var Gh=Gy._readData.getUint16(),Gi=Gy._strings[Gh],Gj=Gy["READ_"+Gi];if(null==Gj)throw new Error("model file err,no this function:"+Gh+" "+Gi);Gj.call()}Gy._strings.length=0,Gy._readData=null,Gy._version=null,Gy._mesh=null,Gy._subMeshes=null,Gy._materialMap=null},Gy._readString=function(){return Gy._strings[Gy._readData.getUint16()]},Gy.READ_DATA=function(){Gy._DATA.offset=Gy._readData.getUint32(),Gy._DATA.size=Gy._readData.getUint32()},Gy.READ_BLOCK=function(){for(var Ga=Gy._BLOCK.count=Gy._readData.getUint16(),Gb=Gy._BLOCK.blockStarts=[],Gc=Gy._BLOCK.blockLengths=[],Gd=0;Gd<Ga;Gd++)Gb.push(Gy._readData.getUint32()),Gc.push(Gy._readData.getUint32())},Gy.READ_STRINGS=function(){var Ga=Gy._readData.getUint32(),Gb=Gy._readData.getUint16(),Gc=Gy._readData.pos;Gy._readData.pos=Ga+Gy._DATA.offset;for(var Gd=0;Gd<Gb;Gd++)Gy._strings[Gd]=Gy._readData.readUTFString();Gy._readData.pos=Gc},Gy.READ_MESH=function(){var Ga,Gb=Gy._readString(),Gc=Gy._readData.__getBuffer(),Gd=0,Ge=Gy._readData.getInt16(),Gf=Gy._DATA.offset;for(Gd=0;Gd<Ge;Gd++){var Gg,Gh=Gf+Gy._readData.getUint32(),Gi=Gy._readData.getUint32(),Gj=new Float32Array(Gc.slice(Gh,Gh+Gi)),Gk=Gy._readString();switch(Gy._version){case"LAYAMODEL:03":Gg=Gy._vertexDeclarationMap_Discard[Gk];break;case"LAYAMODEL:0301":Gg=Gy._vertexDeclarationMap[Gk];break;default:throw new Error("LoadModelV03: unknown version.")}if(!Gg)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+Gy._version+"  bufferAttribute="+Gk+"  name="+Gb+"  url="+(Gy._mesh?Gy._mesh.url:"null"));var Gl=GOb.create(Gg,4*Gj.length/Gg.vertexStride,35044,!0,Gy._mesh._url+"_"+Gd);Gl.setData(Gj),Gy._mesh._vertexBuffers.push(Gl)}var Go=Gf+Gy._readData.getUint32(),Gp=Gy._readData.getUint32(),Gq=new Uint16Array(Gc.slice(Go,Go+Gp)),Gr=GNb.create("ushort",Gp/2,35044,!0,Gy._mesh._url);Gr.setData(Gq),Gy._mesh._indexBuffer=Gr;var Gs=Gy._mesh._boneNames=[],Gt=Gy._readData.getUint16();for(Gs.length=Gt,Gd=0;Gd<Gt;Gd++)Gs[Gd]=Gy._strings[Gy._readData.getUint16()];Gy._readData.pos+=8;var Gu=Gy._readData.getUint32(),Gv=Gy._readData.getUint32(),Gw=new Float32Array(Gc.slice(Gf+Gu,Gf+Gu+Gv));for(Gy._mesh._inverseBindPoses=[],Gd=0,Ga=Gw.length;Gd<Ga;Gd+=16){var Gx=new Gab(Gw[Gd+0],Gw[Gd+1],Gw[Gd+2],Gw[Gd+3],Gw[Gd+4],Gw[Gd+5],Gw[Gd+6],Gw[Gd+7],Gw[Gd+8],Gw[Gd+9],Gw[Gd+10],Gw[Gd+11],Gw[Gd+12],Gw[Gd+13],Gw[Gd+14],Gw[Gd+15]);Gy._mesh._inverseBindPoses.push(Gx)}return Gy._mesh._skinnedDatas=new Float32Array(16*Gw.length),!0},Gy.READ_SUBMESH=function(){var Ga=Gy._readData.__getBuffer(),Gb=new Gjb(Gy._mesh),Gc=Gy._readData.getInt16(),Gd=Gy._readData.getUint32(),Ge=Gy._readData.getUint32();Gb._vertexBuffer=Gy._mesh._vertexBuffers[Gc],Gb._vertexStart=Gd,Gb._vertexCount=Ge;var Gf=Gy._readData.getUint32(),Gg=Gy._readData.getUint32(),Gh=Gy._mesh._indexBuffer;Gb._indexBuffer=Gh,Gb._indexStart=Gf,Gb._indexCount=Gg,Gb._indices=new Uint16Array(Gh.getData().buffer,2*Gf,Gg);var Gi=Gy._DATA.offset,Gj=Gb._subIndexBufferStart,Gk=Gb._subIndexBufferCount,Gl=Gb._boneIndicesList,Go=Gy._readData.getUint16();Gj.length=Go,Gk.length=Go,Gl.length=Go;for(var Gp=0;Gp<Go;Gp++){Gj[Gp]=Gy._readData.getUint32(),Gk[Gp]=Gy._readData.getUint32();var Gq=Gy._readData.getUint32(),Gr=Gy._readData.getUint32();Gl[Gp]=new Uint8Array(Ga.slice(Gi+Gq,Gi+Gq+Gr))}return Gy._subMeshes.push(Gb),!0},Gy._strings=[],Gy._readData=null,Gy._version=null,Gy._mesh=null,Gy._subMeshes=null,Gy._materialMap=null,Gl(Gy,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":Gva.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":Gta.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":GSa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":GJa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":GHa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":GAa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":Gya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":GOa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":GMa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Goa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":Gka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":Gxa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Gsa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":GLa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":GGa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":GCa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":GRa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Gra.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":GQa.vertexDeclaration,"POSITION,NORMAL,UV":GFa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Gqa.vertexDeclaration,"POSITION,NORMAL,COLOR":Gja.vertexDeclaration,"POSITION,NORMAL,TANGENT":GEa.vertexDeclaration,"POSITION,NORMAL":Gia.vertexDeclaration,"POSITION,UV":GUa.vertexDeclaration,POSITION:Gha.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":Gua.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":Gta.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":GSa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":GIa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":GHa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":Gza.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":Gya.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":GNa.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":GMa.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":Gla.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":Gka.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":Gwa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":Gsa.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":GKa.vertexDeclaration,"POSITION,NORMAL,UV,UV1":GGa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":GBa.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":GRa.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":Gra.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":GPa.vertexDeclaration,"POSITION,NORMAL,UV":GFa.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":Gpa.vertexDeclaration,"POSITION,NORMAL,COLOR":Gja.vertexDeclaration,"POSITION,NORMAL,TANGENT":GDa.vertexDeclaration,"POSITION,NORMAL":Gia.vertexDeclaration,"POSITION,UV":GUa.vertexDeclaration,POSITION:Gha.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Gy}(),GYa=function(){function Gh(){}return Gp(Gh,"laya.d3.loaders.MeshReader"),Gh.read=function(Ga,Gb,Gc,Gd,Ge){var Gf=new Gy(Ga);Gf.pos=0;var Gg=Gf.readUTFString();switch(Gg){case"LAYAMODEL:01":case"LAYASKINANI:01":Gh._readVersion01(Gf,Gg,Gb,Gc,Gd,Ge);break;case"LAYAMODEL:02":GWa.parse(Gf,Gg,Gb,Gc,Gd,Ge);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":GXa.parse(Gf,Gg,Gb,Gd,Ge);break;default:throw new Error("MeshReader: unknown mesh version.")}Gb._setSubMeshes(Gd)},Gh._readVersion01=function(Ga,Gb,Gc,Gd,Ge,Gf){new GVa(Ga,Gb,Gc,Gd,Ge,Gf)},Gh}(),GZa=function(){function Ga(Ga,Gb){this.min=null,this.max=null,this.min=Ga,this.max=Gb}Gp(Ga,"laya.d3.math.BoundBox");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb.getCorners=function(Ga){Ga.length=8;var Gb=this.min.elements,Gc=this.max.elements,Gd=Gb[0],Ge=Gb[1],Gf=Gb[2],Gg=Gc[0],Gh=Gc[1],Gi=Gc[2];Ga[0]=new Ggb(Gd,Gh,Gi),Ga[1]=new Ggb(Gg,Gh,Gi),Ga[2]=new Ggb(Gg,Ge,Gi),Ga[3]=new Ggb(Gd,Ge,Gi),Ga[4]=new Ggb(Gd,Gh,Gf),Ga[5]=new Ggb(Gg,Gh,Gf),Ga[6]=new Ggb(Gg,Ge,Gf),Ga[7]=new Ggb(Gd,Ge,Gf)},Gb.toDefault=function(){this.min.toDefault(),this.max.toDefault()},Gb.cloneTo=function(Ga){var Gb=Ga;this.min.cloneTo(Gb.min),this.max.cloneTo(Gb.max)},Gb.clone=function(){var Ga=new this.constructor(new Ggb,new Ggb);return this.cloneTo(Ga),Ga},Ga.createfromPoints=function(Ga,Gb){if(null==Ga)throw new Error("points");var Gc=Gb.min,Gd=Gb.max,Ge=Gc.elements;Ge[0]=Number.MAX_VALUE,Ge[1]=Number.MAX_VALUE,Ge[2]=Number.MAX_VALUE;var Gf=Gd.elements;Gf[0]=-Number.MAX_VALUE,Gf[1]=-Number.MAX_VALUE,Gf[2]=-Number.MAX_VALUE;for(var Gg=0,Gh=Ga.length;Gg<Gh;++Gg)Ggb.min(Gc,Ga[Gg],Gc),Ggb.max(Gd,Ga[Gg],Gd)},Ga.merge=function(Ga,Gb,Gc){Ggb.min(Ga.min,Gb.min,Gc.min),Ggb.max(Ga.max,Gb.max,Gc.max)},Ga}(),G$a=function(){function Gj(Ga){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=Ga,this._near=new Gbb(new Ggb),this._far=new Gbb(new Ggb),this._left=new Gbb(new Ggb),this._right=new Gbb(new Ggb),this._top=new Gbb(new Ggb),this._bottom=new Gbb(new Ggb),Gj._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}Gp(Gj,"laya.d3.math.BoundFrustum");var Ga=Gj.prototype;return Ga.equalsBoundFrustum=function(Ga){return this._matrix.equalsOtherMatrix(Ga.matrix)},Ga.equalsObj=function(Ga){if(Ga instanceof laya.d3.math.BoundFrustum){var Gb=Ga;return this.equalsBoundFrustum(Gb)}return!1},Ga.getPlane=function(Ga){switch(Ga){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},Ga.getCorners=function(Ga){Gj._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(Ga[0]),Gj._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(Ga[1]),Gj._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(Ga[2]),Gj._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(Ga[3]),Gj._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(Ga[4]),Gj._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(Ga[5]),Gj._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(Ga[6]),Gj._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(Ga[7])},Ga.containsPoint=function(Ga){for(var Gb=Gbb.PlaneIntersectionType_Front,Gc=Gbb.PlaneIntersectionType_Front,Gd=0;Gd<6;Gd++){switch(Gd){case 0:Gc=Collision.intersectsPlaneAndPoint(this._near,Ga);break;case 1:Gc=Collision.intersectsPlaneAndPoint(this._far,Ga);break;case 2:Gc=Collision.intersectsPlaneAndPoint(this._left,Ga);break;case 3:Gc=Collision.intersectsPlaneAndPoint(this._right,Ga);break;case 4:Gc=Collision.intersectsPlaneAndPoint(this._top,Ga);break;case 5:Gc=Collision.intersectsPlaneAndPoint(this._bottom,Ga)}switch(Gc){case Gbb.PlaneIntersectionType_Back:return 0;case Gbb.PlaneIntersectionType_Intersecting:Gb=Gbb.PlaneIntersectionType_Intersecting}}switch(Gb){case Gbb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},Ga.containsBoundBox=function(Ga){for(var Gb,Gc=Gj._tempV30,Gd=Gj._tempV31,Ge=1,Gf=0;Gf<6;Gf++){if(Gb=this.getPlane(Gf),this._getBoxToPlanePVertexNVertex(Ga,Gb.normal,Gc,Gd),Collision.intersectsPlaneAndPoint(Gb,Gc)===Gbb.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(Gb,Gd)===Gbb.PlaneIntersectionType_Back&&(Ge=2)}return Ge},Ga.containsBoundSphere=function(Ga){for(var Gb=Gbb.PlaneIntersectionType_Front,Gc=Gbb.PlaneIntersectionType_Front,Gd=0;Gd<6;Gd++){switch(Gd){case 0:Gc=Collision.intersectsPlaneAndSphere(this._near,Ga);break;case 1:Gc=Collision.intersectsPlaneAndSphere(this._far,Ga);break;case 2:Gc=Collision.intersectsPlaneAndSphere(this._left,Ga);break;case 3:Gc=Collision.intersectsPlaneAndSphere(this._right,Ga);break;case 4:Gc=Collision.intersectsPlaneAndSphere(this._top,Ga);break;case 5:Gc=Collision.intersectsPlaneAndSphere(this._bottom,Ga)}switch(Gc){case Gbb.PlaneIntersectionType_Back:return 0;case Gbb.PlaneIntersectionType_Intersecting:Gb=Gbb.PlaneIntersectionType_Intersecting}}switch(Gb){case Gbb.PlaneIntersectionType_Intersecting:return 2;default:return 1}},Ga._getBoxToPlanePVertexNVertex=function(Ga,Gb,Gc,Gd){var Ge=Ga.min,Gf=Ge.elements,Gg=Ga.max,Gh=Gg.elements,Gi=Gb.elements,Gj=Gi[0],Gk=Gi[1],Gl=Gi[2];Ge.cloneTo(Gc);var Go=Gc.elements;0<=Gj&&(Go[0]=Gh[0]),0<=Gk&&(Go[1]=Gh[1]),0<=Gl&&(Go[2]=Gh[2]),Gg.cloneTo(Gd);var Gp=Gd.elements;0<=Gj&&(Gp[0]=Gf[0]),0<=Gk&&(Gp[1]=Gf[1]),0<=Gl&&(Gp[2]=Gf[2])},Gq(0,Ga,"top",function(){return this._top}),Gq(0,Ga,"matrix",function(){return this._matrix},function(Ga){this._matrix=Ga,Gj._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),Gq(0,Ga,"near",function(){return this._near}),Gq(0,Ga,"far",function(){return this._far}),Gq(0,Ga,"left",function(){return this._left}),Gq(0,Ga,"right",function(){return this._right}),Gq(0,Ga,"bottom",function(){return this._bottom}),Gj._getPlanesFromMatrix=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){var Gh=Ga.elements,Gi=Gh[0],Gj=Gh[1],Gk=Gh[2],Gl=Gh[3],Go=Gh[4],Gp=Gh[5],Gq=Gh[6],Gr=Gh[7],Gs=Gh[8],Gt=Gh[9],Gu=Gh[10],Gv=Gh[11],Gw=Gh[12],Gx=Gh[13],Gy=Gh[14],Gz=Gh[15],GA=Gb.normal.elements;GA[0]=Gl+Gk,GA[1]=Gr+Gq,GA[2]=Gv+Gu,Gb.distance=Gz+Gy,Gb.normalize();var GB=Gc.normal.elements;GB[0]=Gl-Gk,GB[1]=Gr-Gq,GB[2]=Gv-Gu,Gc.distance=Gz-Gy,Gc.normalize();var GC=Gd.normal.elements;GC[0]=Gl+Gi,GC[1]=Gr+Go,GC[2]=Gv+Gs,Gd.distance=Gz+Gw,Gd.normalize();var GD=Ge.normal.elements;GD[0]=Gl-Gi,GD[1]=Gr-Go,GD[2]=Gv-Gs,Ge.distance=Gz-Gw,Ge.normalize();var GE=Gf.normal.elements;GE[0]=Gl-Gj,GE[1]=Gr-Gp,GE[2]=Gv-Gt,Gf.distance=Gz-Gx,Gf.normalize();var GF=Gg.normal.elements;GF[0]=Gl+Gj,GF[1]=Gr+Gp,GF[2]=Gv+Gt,Gg.distance=Gz+Gx,Gg.normalize()},Gj._get3PlaneInterPoint=function(Ga,Gb,Gc){var Gd=Ga.normal,Ge=Gb.normal,Gf=Gc.normal;Ggb.cross(Ge,Gf,Gj._tempV30),Ggb.cross(Gf,Gd,Gj._tempV31),Ggb.cross(Gd,Ge,Gj._tempV32);var Gg=Ggb.dot(Gd,Gj._tempV30),Gh=Ggb.dot(Ge,Gj._tempV31),Gi=Ggb.dot(Gf,Gj._tempV32);return Ggb.scale(Gj._tempV30,-Ga.distance/Gg,Gj._tempV33),Ggb.scale(Gj._tempV31,-Gb.distance/Gh,Gj._tempV34),Ggb.scale(Gj._tempV32,-Gc.distance/Gi,Gj._tempV35),Ggb.add(Gj._tempV33,Gj._tempV34,Gj._tempV36),Ggb.add(Gj._tempV35,Gj._tempV36,Gj._tempV37),Gj._tempV37},Gl(Gj,["_tempV30",function(){return this._tempV30=new Ggb},"_tempV31",function(){return this._tempV31=new Ggb},"_tempV32",function(){return this._tempV32=new Ggb},"_tempV33",function(){return this._tempV33=new Ggb},"_tempV34",function(){return this._tempV34=new Ggb},"_tempV35",function(){return this._tempV35=new Ggb},"_tempV36",function(){return this._tempV36=new Ggb},"_tempV37",function(){return this._tempV37=new Ggb}]),Gj}(),G_a=function(){function Gk(Ga,Gb){this.center=null,this.radius=NaN,this.center=Ga,this.radius=Gb}Gp(Gk,"laya.d3.math.BoundSphere");var Ga=Gk.prototype;return Gx.imps(Ga,{"laya.d3.core.IClone":!0}),Ga.toDefault=function(){this.center.toDefault(),this.radius=0},Ga.intersectsRayDistance=function(Ga){return Collision.intersectsRayAndSphereRD(Ga,this)},Ga.intersectsRayPoint=function(Ga,Gb){return Collision.intersectsRayAndSphereRP(Ga,this,Gb)},Ga.cloneTo=function(Ga){var Gb=Ga;this.center.cloneTo(Gb.center),Gb.radius=this.radius},Ga.clone=function(){var Ga=new this.constructor(new Ggb,new Ggb);return this.cloneTo(Ga),Ga},Gk.createFromSubPoints=function(Ga,Gb,Gc,Gd){if(null==Ga)throw new Error("points");if(Gb<0||Gb>=Ga.length)throw new Error("start"+Gb+"Must be in the range [0, "+(Ga.length-1)+"]");if(Gc<0||Gb+Gc>Ga.length)throw new Error("count"+Gc+"Must be in the range <= "+Ga.length+"}");var Ge=Gb+Gc,Gf=Gk._tempVector3;Gf.elements[0]=0,Gf.elements[1]=0,Gf.elements[2]=0;for(var Gg=Gb;Gg<Ge;++Gg)Ggb.add(Ga[Gg],Gf,Gf);var Gh=Gd.center;Ggb.scale(Gf,1/Gc,Gh);var Gi=0;for(Gg=Gb;Gg<Ge;++Gg){var Gj=Ggb.distanceSquared(Gh,Ga[Gg]);Gi<Gj&&(Gi=Gj)}Gd.radius=Math.sqrt(Gi)},Gk.createfromPoints=function(Ga,Gb){if(null==Ga)throw new Error("points");Gk.createFromSubPoints(Ga,0,Ga.length,Gb)},Gl(Gk,["_tempVector3",function(){return this._tempVector3=new Ggb}]),Gk}(),Gma=(function(){function Ga(){}Gp(Ga,"laya.d3.math.ContainmentType"),Ga.Disjoint=0,Ga.Contains=1,Ga.Intersects=2}(),function(){function Gc(){}return Gp(Gc,"laya.d3.math.MathUtils3D"),Gc.isZero=function(Ga){return Math.abs(Ga)<Gc.zeroTolerance},Gc.nearEqual=function(Ga,Gb){return!!Gc.isZero(Ga-Gb)},Gc.fastInvSqrt=function(Ga){return Gc.isZero(Ga)?Ga:1/Math.sqrt(Ga)},Gl(Gc,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),Gc}()),Gna=function(){function Gi(){var Ga=this.elements=new Float32Array(9);Ga[0]=1,Ga[1]=0,Ga[2]=0,Ga[3]=0,Ga[4]=1,Ga[5]=0,Ga[6]=0,Ga[7]=0,Ga[8]=1}Gp(Gi,"laya.d3.math.Matrix3x3");var Ga=Gi.prototype;return Gx.imps(Ga,{"laya.d3.core.IClone":!0}),Ga.determinant=function(){var Ga=this.elements,Gb=Ga[0],Gc=Ga[1],Gd=Ga[2],Ge=Ga[3],Gf=Ga[4],Gg=Ga[5],Gh=Ga[6],Gi=Ga[7],Gj=Ga[8];return Gb*(Gj*Gf-Gg*Gi)+Gc*(-Gj*Ge+Gg*Gh)+Gd*(Gi*Ge-Gf*Gh)},Ga.translate=function(Ga,Gb){var Gc=Gb.elements,Gd=this.elements,Ge=Ga.elements,Gf=Gd[0],Gg=Gd[1],Gh=Gd[2],Gi=Gd[3],Gj=Gd[4],Gk=Gd[5],Gl=Gd[6],Go=Gd[7],Gp=Gd[8],Gq=Ge[0],Gr=Ge[1];Gc[0]=Gf,Gc[1]=Gg,Gc[2]=Gh,Gc[3]=Gi,Gc[4]=Gj,Gc[5]=Gk,Gc[6]=Gq*Gf+Gr*Gi+Gl,Gc[7]=Gq*Gg+Gr*Gj+Go,Gc[8]=Gq*Gh+Gr*Gk+Gp},Ga.rotate=function(Ga,Gb){var Gc=Gb.elements,Gd=this.elements,Ge=Gd[0],Gf=Gd[1],Gg=Gd[2],Gh=Gd[3],Gi=Gd[4],Gj=Gd[5],Gk=Gd[6],Gl=Gd[7],Go=Gd[8],Gp=Math.sin(Ga),Gq=Math.cos(Ga);Gc[0]=Gq*Ge+Gp*Gh,Gc[1]=Gq*Gf+Gp*Gi,Gc[2]=Gq*Gg+Gp*Gj,Gc[3]=Gq*Gh-Gp*Ge,Gc[4]=Gq*Gi-Gp*Gf,Gc[5]=Gq*Gj-Gp*Gg,Gc[6]=Gk,Gc[7]=Gl,Gc[8]=Go},Ga.scale=function(Ga,Gb){var Gc=Gb.elements,Gd=this.elements,Ge=Ga.elements,Gf=Ge[0],Gg=Ge[1];Gc[0]=Gf*Gd[0],Gc[1]=Gf*Gd[1],Gc[2]=Gf*Gd[2],Gc[3]=Gg*Gd[3],Gc[4]=Gg*Gd[4],Gc[5]=Gg*Gd[5],Gc[6]=Gd[6],Gc[7]=Gd[7],Gc[8]=Gd[8]},Ga.invert=function(Ga){var Gb=Ga.elements,Gc=this.elements,Gd=Gc[0],Ge=Gc[1],Gf=Gc[2],Gg=Gc[3],Gh=Gc[4],Gi=Gc[5],Gj=Gc[6],Gk=Gc[7],Gl=Gc[8],Go=Gl*Gh-Gi*Gk,Gp=-Gl*Gg+Gi*Gj,Gq=Gk*Gg-Gh*Gj,Gr=Gd*Go+Ge*Gp+Gf*Gq;Gr||(Ga=null),Gr=1/Gr,Gb[0]=Go*Gr,Gb[1]=(-Gl*Ge+Gf*Gk)*Gr,Gb[2]=(Gi*Ge-Gf*Gh)*Gr,Gb[3]=Gp*Gr,Gb[4]=(Gl*Gd-Gf*Gj)*Gr,Gb[5]=(-Gi*Gd+Gf*Gg)*Gr,Gb[6]=Gq*Gr,Gb[7]=(-Gk*Gd+Ge*Gj)*Gr,Gb[8]=(Gh*Gd-Ge*Gg)*Gr},Ga.transpose=function(Ga){var Gb=Ga.elements,Gc=this.elements;if(Ga===this){var Gd=Gc[1],Ge=Gc[2],Gf=Gc[5];Gb[1]=Gc[3],Gb[2]=Gc[6],Gb[3]=Gd,Gb[5]=Gc[7],Gb[6]=Ge,Gb[7]=Gf}else Gb[0]=Gc[0],Gb[1]=Gc[3],Gb[2]=Gc[6],Gb[3]=Gc[1],Gb[4]=Gc[4],Gb[5]=Gc[7],Gb[6]=Gc[2],Gb[7]=Gc[5],Gb[8]=Gc[8]},Ga.identity=function(){var Ga=this.elements;Ga[0]=1,Ga[1]=0,Ga[2]=0,Ga[3]=0,Ga[4]=1,Ga[5]=0,Ga[6]=0,Ga[7]=0,Ga[8]=1},Ga.cloneTo=function(Ga){var Gb,Gc,Gd;if((Gc=this.elements)!==(Gd=Ga.elements))for(Gb=0;Gb<9;++Gb)Gd[Gb]=Gc[Gb]},Ga.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gi.createFromTranslation=function(Ga,Gb){Gb.elements;var Gc=Ga.elements;Gb[0]=1,Gb[1]=0,Gb[2]=0,Gb[3]=0,Gb[4]=1,Gb[5]=0,Gb[6]=Gc[0],Gb[7]=Gc[1],Gb[8]=1},Gi.createFromRotation=function(Ga,Gb){var Gc=Gb.elements,Gd=Math.sin(Ga),Ge=Math.cos(Ga);Gc[0]=Ge,Gc[1]=Gd,Gc[2]=0,Gc[3]=-Gd,Gc[4]=Ge,Gc[5]=0,Gc[6]=0,Gc[7]=0,Gc[8]=1},Gi.createFromScaling=function(Ga,Gb){var Gc=Gb.elements,Gd=Ga.elements;Gc[0]=Gd[0],Gc[1]=0,Gc[2]=0,Gc[3]=0,Gc[4]=Gd[1],Gc[5]=0,Gc[6]=0,Gc[7]=0,Gc[8]=1},Gi.createFromMatrix4x4=function(Ga,Gb){Gb[0]=Ga[0],Gb[1]=Ga[1],Gb[2]=Ga[2],Gb[3]=Ga[4],Gb[4]=Ga[5],Gb[5]=Ga[6],Gb[6]=Ga[8],Gb[7]=Ga[9],Gb[8]=Ga[10]},Gi.multiply=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements,Gg=Ge[0],Gh=Ge[1],Gi=Ge[2],Gj=Ge[3],Gk=Ge[4],Gl=Ge[5],Go=Ge[6],Gp=Ge[7],Gq=Ge[8],Gr=Gf[0],Gs=Gf[1],Gt=Gf[2],Gu=Gf[3],Gv=Gf[4],Gw=Gf[5],Gx=Gf[6],Gy=Gf[7],Gz=Gf[8];Gd[0]=Gr*Gg+Gs*Gj+Gt*Go,Gd[1]=Gr*Gh+Gs*Gk+Gt*Gp,Gd[2]=Gr*Gi+Gs*Gl+Gt*Gq,Gd[3]=Gu*Gg+Gv*Gj+Gw*Go,Gd[4]=Gu*Gh+Gv*Gk+Gw*Gp,Gd[5]=Gu*Gi+Gv*Gl+Gw*Gq,Gd[6]=Gx*Gg+Gy*Gj+Gz*Go,Gd[7]=Gx*Gh+Gy*Gk+Gz*Gp,Gd[8]=Gx*Gi+Gy*Gl+Gz*Gq},Gi.lookAt=function(Ga,Gb,Gc,Gd){Ggb.subtract(Ga,Gb,Gi._tempV30),Ggb.normalize(Gi._tempV30,Gi._tempV30),Ggb.cross(Gc,Gi._tempV30,Gi._tempV31),Ggb.normalize(Gi._tempV31,Gi._tempV31),Ggb.cross(Gi._tempV30,Gi._tempV31,Gi._tempV32);var Ge=Gi._tempV30.elements,Gf=Gi._tempV31.elements,Gg=Gi._tempV32.elements,Gh=Gd.elements;Gh[0]=Gf[0],Gh[3]=Gf[1],Gh[6]=Gf[2],Gh[1]=Gg[0],Gh[4]=Gg[1],Gh[7]=Gg[2],Gh[2]=Ge[0],Gh[5]=Ge[1],Gh[8]=Ge[2]},Gi.DEFAULT=new Gi,Gl(Gi,["_tempV30",function(){return this._tempV30=new Ggb},"_tempV31",function(){return this._tempV31=new Ggb},"_tempV32",function(){return this._tempV32=new Ggb}]),Gi}(),Gab=function(){function GB(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Gl,Go,Gp,Gq,Gr){void 0===Ga&&(Ga=1),void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=0),void 0===Ge&&(Ge=0),void 0===Gf&&(Gf=1),void 0===Gg&&(Gg=0),void 0===Gh&&(Gh=0),void 0===Gi&&(Gi=0),void 0===Gj&&(Gj=0),void 0===Gk&&(Gk=1),void 0===Gl&&(Gl=0),void 0===Go&&(Go=0),void 0===Gp&&(Gp=0),void 0===Gq&&(Gq=0),void 0===Gr&&(Gr=1);var Gs=this.elements=new Float32Array(16);Gs[0]=Ga,Gs[1]=Gb,Gs[2]=Gc,Gs[3]=Gd,Gs[4]=Ge,Gs[5]=Gf,Gs[6]=Gg,Gs[7]=Gh,Gs[8]=Gi,Gs[9]=Gj,Gs[10]=Gk,Gs[11]=Gl,Gs[12]=Go,Gs[13]=Gp,Gs[14]=Gq,Gs[15]=Gr}Gp(GB,"laya.d3.math.Matrix4x4");var Ga=GB.prototype;return Gx.imps(Ga,{"laya.d3.core.IClone":!0}),Ga.getElementByRowColumn=function(Ga,Gb){if(Ga<0||3<Ga)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(Gb<0||3<Gb)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*Ga+Gb]},Ga.setElementByRowColumn=function(Ga,Gb,Gc){if(Ga<0||3<Ga)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(Gb<0||3<Gb)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*Ga+Gb]=Gc},Ga.equalsOtherMatrix=function(Ga){var Gb=this.elements,Gc=Ga.elements;return Gma.nearEqual(Gb[0],Gc[0])&&Gma.nearEqual(Gb[1],Gc[1])&&Gma.nearEqual(Gb[2],Gc[2])&&Gma.nearEqual(Gb[3],Gc[3])&&Gma.nearEqual(Gb[4],Gc[4])&&Gma.nearEqual(Gb[5],Gc[5])&&Gma.nearEqual(Gb[6],Gc[6])&&Gma.nearEqual(Gb[7],Gc[7])&&Gma.nearEqual(Gb[8],Gc[8])&&Gma.nearEqual(Gb[9],Gc[9])&&Gma.nearEqual(Gb[10],Gc[10])&&Gma.nearEqual(Gb[11],Gc[11])&&Gma.nearEqual(Gb[12],Gc[12])&&Gma.nearEqual(Gb[13],Gc[13])&&Gma.nearEqual(Gb[14],Gc[14])&&Gma.nearEqual(Gb[15],Gc[15])},Ga.decomposeTransRotScale=function(Ga,Gb,Gc){var Gd=GB._tempMatrix4x4;return this.decomposeTransRotMatScale(Ga,Gd,Gc)?(Gcb.createFromMatrix4x4(Gd,Gb),!0):(Gb.identity(),!1)},Ga.decomposeTransRotMatScale=function(Ga,Gb,Gc){var Gd=this.elements,Ge=Ga.elements,Gf=Gb.elements,Gg=Gc.elements;Ge[0]=Gd[12],Ge[1]=Gd[13],Ge[2]=Gd[14];var Gh=Gd[0],Gi=Gd[1],Gj=Gd[2],Gk=Gd[4],Gl=Gd[5],Go=Gd[6],Gp=Gd[8],Gq=Gd[9],Gr=Gd[10],Gs=Gg[0]=Math.sqrt(Gh*Gh+Gi*Gi+Gj*Gj),Gt=Gg[1]=Math.sqrt(Gk*Gk+Gl*Gl+Go*Go),Gu=Gg[2]=Math.sqrt(Gp*Gp+Gq*Gq+Gr*Gr);if(Gma.isZero(Gs)||Gma.isZero(Gt)||Gma.isZero(Gu))return Gf[1]=Gf[2]=Gf[3]=Gf[4]=Gf[6]=Gf[7]=Gf[8]=Gf[9]=Gf[11]=Gf[12]=Gf[13]=Gf[14]=0,Gf[0]=Gf[5]=Gf[10]=Gf[15]=1,!1;var Gv=GB._tempVector0,Gw=Gv.elements;Gw[0]=Gp/Gu,Gw[1]=Gq/Gu,Gw[2]=Gr/Gu;var Gx=GB._tempVector1,Gy=Gx.elements;Gy[0]=Gh/Gs,Gy[1]=Gi/Gs,Gy[2]=Gj/Gs;var Gz=GB._tempVector2;Ggb.cross(Gv,Gx,Gz);var GA=GB._tempVector1;return Ggb.cross(Gz,Gv,GA),Gf[3]=Gf[7]=Gf[11]=Gf[12]=Gf[13]=Gf[14]=0,Gf[15]=1,Gf[0]=GA.x,Gf[1]=GA.y,Gf[2]=GA.z,Gf[4]=Gz.x,Gf[5]=Gz.y,Gf[6]=Gz.z,Gf[8]=Gv.x,Gf[9]=Gv.y,Gf[10]=Gv.z,Gf[0]*Gh+Gf[1]*Gi+Gf[2]*Gj<0&&(Gg[0]=-Gs),Gf[4]*Gk+Gf[5]*Gl+Gf[6]*Go<0&&(Gg[1]=-Gt),Gf[8]*Gp+Gf[9]*Gq+Gf[10]*Gr<0&&(Gg[2]=-Gu),!0},Ga.decomposeYawPitchRoll=function(Ga){var Gb=Ga.elements,Gc=Math.asin(-this.elements[9]);Gb[1]=Gc,Math.cos(Gc)>Gma.zeroTolerance?(Gb[2]=Math.atan2(this.elements[1],this.elements[5]),Gb[0]=Math.atan2(this.elements[8],this.elements[10])):(Gb[2]=Math.atan2(-this.elements[4],this.elements[0]),Gb[0]=0)},Ga.normalize=function(){var Ga=this.elements,Gb=Ga[0],Gc=Ga[1],Gd=Ga[2],Ge=Math.sqrt(Gb*Gb+Gc*Gc+Gd*Gd);if(!Ge)return Ga[0]=0,Ga[1]=0,void(Ga[2]=0);1!=Ge&&(Ge=1/Ge,Ga[0]=Gb*Ge,Ga[1]=Gc*Ge,Ga[2]=Gd*Ge)},Ga.transpose=function(){var Ga,Gb;return Gb=(Ga=this.elements)[1],Ga[1]=Ga[4],Ga[4]=Gb,Gb=Ga[2],Ga[2]=Ga[8],Ga[8]=Gb,Gb=Ga[3],Ga[3]=Ga[12],Ga[12]=Gb,Gb=Ga[6],Ga[6]=Ga[9],Ga[9]=Gb,Gb=Ga[7],Ga[7]=Ga[13],Ga[13]=Gb,Gb=Ga[11],Ga[11]=Ga[14],Ga[14]=Gb,this},Ga.invert=function(Ga){var Gb=this.elements,Gc=Ga.elements,Gd=Gb[0],Ge=Gb[1],Gf=Gb[2],Gg=Gb[3],Gh=Gb[4],Gi=Gb[5],Gj=Gb[6],Gk=Gb[7],Gl=Gb[8],Go=Gb[9],Gp=Gb[10],Gq=Gb[11],Gr=Gb[12],Gs=Gb[13],Gt=Gb[14],Gu=Gb[15],Gv=Gd*Gi-Ge*Gh,Gw=Gd*Gj-Gf*Gh,Gx=Gd*Gk-Gg*Gh,Gy=Ge*Gj-Gf*Gi,Gz=Ge*Gk-Gg*Gi,GA=Gf*Gk-Gg*Gj,GB=Gl*Gs-Go*Gr,GC=Gl*Gt-Gp*Gr,GD=Gl*Gu-Gq*Gr,GE=Go*Gt-Gp*Gs,GF=Go*Gu-Gq*Gs,GG=Gp*Gu-Gq*Gt,GH=Gv*GG-Gw*GF+Gx*GE+Gy*GD-Gz*GC+GA*GB;0!==Math.abs(GH)&&(GH=1/GH,Gc[0]=(Gi*GG-Gj*GF+Gk*GE)*GH,Gc[1]=(Gf*GF-Ge*GG-Gg*GE)*GH,Gc[2]=(Gs*GA-Gt*Gz+Gu*Gy)*GH,Gc[3]=(Gp*Gz-Go*GA-Gq*Gy)*GH,Gc[4]=(Gj*GD-Gh*GG-Gk*GC)*GH,Gc[5]=(Gd*GG-Gf*GD+Gg*GC)*GH,Gc[6]=(Gt*Gx-Gr*GA-Gu*Gw)*GH,Gc[7]=(Gl*GA-Gp*Gx+Gq*Gw)*GH,Gc[8]=(Gh*GF-Gi*GD+Gk*GB)*GH,Gc[9]=(Ge*GD-Gd*GF-Gg*GB)*GH,Gc[10]=(Gr*Gz-Gs*Gx+Gu*Gv)*GH,Gc[11]=(Go*Gx-Gl*Gz-Gq*Gv)*GH,Gc[12]=(Gi*GC-Gh*GE-Gj*GB)*GH,Gc[13]=(Gd*GE-Ge*GC+Gf*GB)*GH,Gc[14]=(Gs*Gw-Gr*Gy-Gt*Gv)*GH,Gc[15]=(Gl*Gy-Go*Gw+Gp*Gv)*GH)},Ga.identity=function(){var Ga=this.elements;Ga[1]=Ga[2]=Ga[3]=Ga[4]=Ga[6]=Ga[7]=Ga[8]=Ga[9]=Ga[11]=Ga[12]=Ga[13]=Ga[14]=0,Ga[0]=Ga[5]=Ga[10]=Ga[15]=1},Ga.cloneTo=function(Ga){var Gb,Gc,Gd;if((Gc=this.elements)!==(Gd=Ga.elements))for(Gb=0;Gb<16;++Gb)Gd[Gb]=Gc[Gb]},Ga.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Ga.getTranslationVector=function(Ga){var Gb=this.elements,Gc=Ga.elements;Gc[0]=Gb[12],Gc[1]=Gb[13],Gc[2]=Gb[14]},Ga.setTranslationVector=function(Ga){var Gb=this.elements,Gc=Ga.elements;Gb[12]=Gc[0],Gb[13]=Gc[1],Gb[14]=Gc[2]},Ga.getForward=function(Ga){var Gb=this.elements,Gc=Ga.elements;Gc[0]=-Gb[8],Gc[1]=-Gb[9],Gc[2]=-Gb[10]},Ga.setForward=function(Ga){var Gb=this.elements,Gc=Ga.elements;Gb[8]=-Gc[0],Gb[9]=-Gc[1],Gb[10]=-Gc[2]},GB.createRotationX=function(Ga,Gb){var Gc=Gb.elements,Gd=Math.sin(Ga),Ge=Math.cos(Ga);Gc[1]=Gc[2]=Gc[3]=Gc[4]=Gc[7]=Gc[8]=Gc[11]=Gc[12]=Gc[13]=Gc[14]=0,Gc[0]=Gc[15]=1,Gc[5]=Gc[10]=Ge,Gc[6]=Gd,Gc[9]=-Gd},GB.createRotationY=function(Ga,Gb){var Gc=Gb.elements,Gd=Math.sin(Ga),Ge=Math.cos(Ga);Gc[1]=Gc[3]=Gc[4]=Gc[6]=Gc[7]=Gc[9]=Gc[11]=Gc[12]=Gc[13]=Gc[14]=0,Gc[5]=Gc[15]=1,Gc[0]=Gc[10]=Ge,Gc[2]=-Gd,Gc[8]=Gd},GB.createRotationZ=function(Ga,Gb){var Gc=Gb.elements,Gd=Math.sin(Ga),Ge=Math.cos(Ga);Gc[2]=Gc[3]=Gc[6]=Gc[7]=Gc[8]=Gc[9]=Gc[11]=Gc[12]=Gc[13]=Gc[14]=0,Gc[10]=Gc[15]=1,Gc[0]=Gc[5]=Ge,Gc[1]=Gd,Gc[4]=-Gd},GB.createRotationYawPitchRoll=function(Ga,Gb,Gc,Gd){Gcb.createFromYawPitchRoll(Ga,Gb,Gc,GB._tempQuaternion),GB.createRotationQuaternion(GB._tempQuaternion,Gd)},GB.createRotationAxis=function(Ga,Gb,Gc){var Gd=Ga.elements,Ge=Gd[0],Gf=Gd[1],Gg=Gd[2],Gh=Math.cos(Gb),Gi=Math.sin(Gb),Gj=Ge*Ge,Gk=Gf*Gf,Gl=Gg*Gg,Go=Ge*Gf,Gp=Ge*Gg,Gq=Gf*Gg,Gr=Gc.elements;Gr[3]=Gr[7]=Gr[11]=Gr[12]=Gr[13]=Gr[14]=0,Gr[15]=1,Gr[0]=Gj+Gh*(1-Gj),Gr[1]=Go-Gh*Go+Gi*Gg,Gr[2]=Gp-Gh*Gp-Gi*Gf,Gr[4]=Go-Gh*Go-Gi*Gg,Gr[5]=Gk+Gh*(1-Gk),Gr[6]=Gq-Gh*Gq+Gi*Ge,Gr[8]=Gp-Gh*Gp+Gi*Gf,Gr[9]=Gq-Gh*Gq-Gi*Ge,Gr[10]=Gl+Gh*(1-Gl)},GB.createRotationQuaternion=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements,Ge=Gc[0],Gf=Gc[1],Gg=Gc[2],Gh=Gc[3],Gi=Ge*Ge,Gj=Gf*Gf,Gk=Gg*Gg,Gl=Ge*Gf,Go=Gg*Gh,Gp=Gg*Ge,Gq=Gf*Gh,Gr=Gf*Gg,Gs=Ge*Gh;Gd[3]=Gd[7]=Gd[11]=Gd[12]=Gd[13]=Gd[14]=0,Gd[15]=1,Gd[0]=1-2*(Gj+Gk),Gd[1]=2*(Gl+Go),Gd[2]=2*(Gp-Gq),Gd[4]=2*(Gl-Go),Gd[5]=1-2*(Gk+Gi),Gd[6]=2*(Gr+Gs),Gd[8]=2*(Gp+Gq),Gd[9]=2*(Gr-Gs),Gd[10]=1-2*(Gj+Gi)},GB.createTranslate=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements;Gd[4]=Gd[8]=Gd[1]=Gd[9]=Gd[2]=Gd[6]=Gd[3]=Gd[7]=Gd[11]=0,Gd[0]=Gd[5]=Gd[10]=Gd[15]=1,Gd[12]=Gc[0],Gd[13]=Gc[1],Gd[14]=Gc[2]},GB.createScaling=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements;Gd[0]=Gc[0],Gd[5]=Gc[1],Gd[10]=Gc[2],Gd[1]=Gd[4]=Gd[8]=Gd[12]=Gd[9]=Gd[13]=Gd[2]=Gd[6]=Gd[14]=Gd[3]=Gd[7]=Gd[11]=0,Gd[15]=1},GB.multiply=function(Ga,Gb,Gc){var Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk;for(Ge=Gc.elements,Gf=Ga.elements,Ge===(Gg=Gb.elements)&&(Gg=Gg.slice()),Gd=0;Gd<4;Gd++)Gh=Gf[Gd],Gi=Gf[Gd+4],Gj=Gf[Gd+8],Gk=Gf[Gd+12],Ge[Gd]=Gh*Gg[0]+Gi*Gg[1]+Gj*Gg[2]+Gk*Gg[3],Ge[Gd+4]=Gh*Gg[4]+Gi*Gg[5]+Gj*Gg[6]+Gk*Gg[7],Ge[Gd+8]=Gh*Gg[8]+Gi*Gg[9]+Gj*Gg[10]+Gk*Gg[11],Ge[Gd+12]=Gh*Gg[12]+Gi*Gg[13]+Gj*Gg[14]+Gk*Gg[15]},GB.createFromQuaternion=function(Ga,Gb){var Gc=Gb.elements,Gd=Ga.elements,Ge=Gd[0],Gf=Gd[1],Gg=Gd[2],Gh=Gd[3],Gi=Ge+Ge,Gj=Gf+Gf,Gk=Gg+Gg,Gl=Ge*Gi,Go=Gf*Gi,Gp=Gf*Gj,Gq=Gg*Gi,Gr=Gg*Gj,Gs=Gg*Gk,Gt=Gh*Gi,Gu=Gh*Gj,Gv=Gh*Gk;Gc[0]=1-Gp-Gs,Gc[1]=Go+Gv,Gc[2]=Gq-Gu,Gc[3]=0,Gc[4]=Go-Gv,Gc[5]=1-Gl-Gs,Gc[6]=Gr+Gt,Gc[7]=0,Gc[8]=Gq+Gu,Gc[9]=Gr-Gt,Gc[10]=1-Gl-Gp,Gc[11]=0,Gc[12]=0,Gc[13]=0,Gc[14]=0,Gc[15]=1},GB.createAffineTransformation=function(Ga,Gb,Gc,Gd){var Ge=Ga.elements,Gf=Gb.elements,Gg=Gc.elements,Gh=Gd.elements,Gi=Gf[0],Gj=Gf[1],Gk=Gf[2],Gl=Gf[3],Go=Gi+Gi,Gp=Gj+Gj,Gq=Gk+Gk,Gr=Gi*Go,Gs=Gi*Gp,Gt=Gi*Gq,Gu=Gj*Gp,Gv=Gj*Gq,Gw=Gk*Gq,Gx=Gl*Go,Gy=Gl*Gp,Gz=Gl*Gq,GA=Gg[0],GB=Gg[1],GC=Gg[2];Gh[0]=(1-(Gu+Gw))*GA,Gh[1]=(Gs+Gz)*GA,Gh[2]=(Gt-Gy)*GA,Gh[3]=0,Gh[4]=(Gs-Gz)*GB,Gh[5]=(1-(Gr+Gw))*GB,Gh[6]=(Gv+Gx)*GB,Gh[7]=0,Gh[8]=(Gt+Gy)*GC,Gh[9]=(Gv-Gx)*GC,Gh[10]=(1-(Gr+Gu))*GC,Gh[11]=0,Gh[12]=Ge[0],Gh[13]=Ge[1],Gh[14]=Ge[2],Gh[15]=1},GB.createLookAt=function(Ga,Gb,Gc,Gd){var Ge=Gd.elements,Gf=GB._tempVector0,Gg=GB._tempVector1,Gh=GB._tempVector2;Ggb.subtract(Ga,Gb,Gh),Ggb.normalize(Gh,Gh),Ggb.cross(Gc,Gh,Gf),Ggb.normalize(Gf,Gf),Ggb.cross(Gh,Gf,Gg),Gd.identity(),Ge[0]=Gf.x,Ge[4]=Gf.y,Ge[8]=Gf.z,Ge[1]=Gg.x,Ge[5]=Gg.y,Ge[9]=Gg.z,Ge[2]=Gh.x,Ge[6]=Gh.y,Ge[10]=Gh.z,Ge[12]=-Ggb.dot(Gf,Ga),Ge[13]=-Ggb.dot(Gg,Ga),Ge[14]=-Ggb.dot(Gh,Ga)},GB.createPerspective=function(Ga,Gb,Gc,Gd,Ge){var Gf=Ge.elements,Gg=1/Math.tan(Ga/2),Gh=1/(Gc-Gd);Gf[0]=Gg/Gb,Gf[5]=Gg,Gf[10]=(Gd+Gc)*Gh,Gf[11]=-1,Gf[14]=2*Gd*Gc*Gh,Gf[1]=Gf[2]=Gf[3]=Gf[4]=Gf[6]=Gf[7]=Gf[8]=Gf[9]=Gf[12]=Gf[13]=Gf[15]=0},GB.createOrthoOffCenterRH=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){var Gh=Gg.elements,Gi=1/(Ga-Gb),Gj=1/(Gc-Gd),Gk=1/(Ge-Gf);Gh[1]=Gh[2]=Gh[3]=Gh[4]=Gh[6]=Gh[7]=Gh[8]=Gh[9]=Gh[11]=0,Gh[15]=1,Gh[0]=-2*Gi,Gh[5]=-2*Gj,Gh[10]=2*Gk,Gh[12]=(Ga+Gb)*Gi,Gh[13]=(Gd+Gc)*Gj,Gh[14]=(Gf+Ge)*Gk},GB.translation=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements;Gd[0]=Gd[5]=Gd[10]=Gd[15]=1,Gd[12]=Gc[0],Gd[13]=Gc[1],Gd[14]=Gc[2]},Gl(GB,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new GB},"_tempVector0",function(){return this._tempVector0=new Ggb},"_tempVector1",function(){return this._tempVector1=new Ggb},"_tempVector2",function(){return this._tempVector2=new Ggb},"_tempQuaternion",function(){return this._tempQuaternion=new Gcb},"DEFAULT",function(){return this.DEFAULT=new GB},"ZERO",function(){return this.ZERO=new GB(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),GB}(),Gbb=(function(){function Gv(Ga,Gb){this.extents=null,this.transformation=null,this.extents=Ga,this.transformation=Gb}Gp(Gv,"laya.d3.math.OrientedBoundBox");var Ga=Gv.prototype;Ga.getCorners=function(Ga){var Gb=Gv._tempV30.elements,Gc=Gv._tempV31.elements,Gd=Gv._tempV32.elements,Ge=this.extents.elements;Gb[0]=Ge[0],Gb[1]=Gb[2]=0,Gc[1]=Ge[1],Gc[0]=Gc[2]=0,Gd[2]=Ge[2],Gd[0]=Gd[1]=0,Ggb.TransformNormal(Gv._tempV30,this.transformation,Gv._tempV30),Ggb.TransformNormal(Gv._tempV31,this.transformation,Gv._tempV31),Ggb.TransformNormal(Gv._tempV32,this.transformation,Gv._tempV32);var Gf=Gv._tempV33;this.transformation.getTranslationVector(Gf),Ga.length=8,Ggb.add(Gf,Gv._tempV30,Gv._tempV34),Ggb.add(Gv._tempV34,Gv._tempV31,Gv._tempV34),Ggb.add(Gv._tempV34,Gv._tempV32,Ga[0]),Ggb.add(Gf,Gv._tempV30,Gv._tempV34),Ggb.add(Gv._tempV34,Gv._tempV31,Gv._tempV34),Ggb.subtract(Gv._tempV34,Gv._tempV32,Ga[1]),Ggb.subtract(Gf,Gv._tempV30,Gv._tempV34),Ggb.add(Gv._tempV34,Gv._tempV31,Gv._tempV34),Ggb.subtract(Gv._tempV34,Gv._tempV32,Ga[2]),Ggb.subtract(Gf,Gv._tempV30,Gv._tempV34),Ggb.add(Gv._tempV34,Gv._tempV31,Gv._tempV34),Ggb.add(Gv._tempV34,Gv._tempV32,Ga[3]),Ggb.add(Gf,Gv._tempV30,Gv._tempV34),Ggb.subtract(Gv._tempV34,Gv._tempV31,Gv._tempV34),Ggb.add(Gv._tempV34,Gv._tempV32,Ga[4]),Ggb.add(Gf,Gv._tempV30,Gv._tempV34),Ggb.subtract(Gv._tempV34,Gv._tempV31,Gv._tempV34),Ggb.subtract(Gv._tempV34,Gv._tempV32,Ga[5]),Ggb.subtract(Gf,Gv._tempV30,Gv._tempV34),Ggb.subtract(Gv._tempV34,Gv._tempV31,Gv._tempV34),Ggb.subtract(Gv._tempV34,Gv._tempV32,Ga[6]),Ggb.subtract(Gf,Gv._tempV30,Gv._tempV34),Ggb.subtract(Gv._tempV34,Gv._tempV31,Gv._tempV34),Ggb.add(Gv._tempV34,Gv._tempV32,Ga[7])},Ga.transform=function(Ga){Gab.multiply(this.transformation,Ga,this.transformation)},Ga.scale=function(Ga){Ggb.multiply(this.extents,Ga,this.extents)},Ga.translate=function(Ga){this.transformation.getTranslationVector(Gv._tempV30),Ggb.add(Gv._tempV30,Ga,Gv._tempV31),this.transformation.setTranslationVector(Gv._tempV31)},Ga.Size=function(Ga){Ggb.scale(this.extents,2,Ga)},Ga.getSize=function(Ga){var Gb=this.extents.elements;Gv._tempV30.x=Gb[0],Gv._tempV31.y=Gb[1],Gv._tempV32.z=Gb[2],Ggb.TransformNormal(Gv._tempV30,this.transformation,Gv._tempV30),Ggb.TransformNormal(Gv._tempV31,this.transformation,Gv._tempV31),Ggb.TransformNormal(Gv._tempV31,this.transformation,Gv._tempV32);var Gc=Ga.elements;Gc[0]=Ggb.scalarLength(Gv._tempV30),Gc[1]=Ggb.scalarLength(Gv._tempV31),Gc[2]=Ggb.scalarLength(Gv._tempV32)},Ga.getSizeSquared=function(Ga){var Gb=this.extents.elements;Gv._tempV30.x=Gb[0],Gv._tempV31.y=Gb[1],Gv._tempV32.z=Gb[2],Ggb.TransformNormal(Gv._tempV30,this.transformation,Gv._tempV30),Ggb.TransformNormal(Gv._tempV31,this.transformation,Gv._tempV31),Ggb.TransformNormal(Gv._tempV31,this.transformation,Gv._tempV32);var Gc=Ga.elements;Gc[0]=Ggb.scalarLengthSquared(Gv._tempV30),Gc[1]=Ggb.scalarLengthSquared(Gv._tempV31),Gc[2]=Ggb.scalarLengthSquared(Gv._tempV32)},Ga.getCenter=function(Ga){this.transformation.getTranslationVector(Ga)},Ga.containsPoint=function(Ga){var Gb=this.extents.elements,Gc=Gb[0],Gd=Gb[1],Ge=Gb[2];this.transformation.invert(Gv._tempM0),Ggb.transformCoordinate(Ga,Gv._tempM0,Gv._tempV30);var Gf=Gv._tempV30.elements,Gg=Math.abs(Gf[0]),Gh=Math.abs(Gf[1]),Gi=Math.abs(Gf[2]);return Gma.nearEqual(Gg,Gc)&&Gma.nearEqual(Gh,Gd)&&Gma.nearEqual(Gi,Ge)?2:Gg<Gc&&Gh<Gd&&Gi<Ge?1:0},Ga.containsPoints=function(Ga){var Gb=this.extents.elements,Gc=Gb[0],Gd=Gb[1],Ge=Gb[2];this.transformation.invert(Gv._tempM0);for(var Gf=!0,Gg=!1,Gh=0;Gh<Ga.length;Gh++){Ggb.transformCoordinate(Ga[Gh],Gv._tempM0,Gv._tempV30);var Gi=Gv._tempV30.elements,Gj=Math.abs(Gi[0]),Gk=Math.abs(Gi[1]),Gl=Math.abs(Gi[2]);Gma.nearEqual(Gj,Gc)&&Gma.nearEqual(Gk,Gd)&&Gma.nearEqual(Gl,Ge)&&(Gg=!0),Gj<Gc&&Gk<Gd&&Gl<Ge?Gg=!0:Gf=!1}return Gf?1:Gg?2:0},Ga.containsSphere=function(Ga,Gb){void 0===Gb&&(Gb=!1);var Gc=this.extents.elements,Gd=Gc[0],Ge=Gc[1],Gf=Gc[2],Gg=Ga.radius;this.transformation.invert(Gv._tempM0),Ggb.transformCoordinate(Ga.center,Gv._tempM0,Gv._tempV30);var Gh=NaN;if(Gh=Gb?Gg:(Ggb.scale(Ggb.UnitX,Gg,Gv._tempV31),Ggb.TransformNormal(Gv._tempV31,Gv._tempM0,Gv._tempV31),Ggb.scalarLength(Gv._tempV31)),Ggb.scale(this.extents,-1,Gv._tempV32),Ggb.Clamp(Gv._tempV30,Gv._tempV32,this.extents,Gv._tempV33),Gh*Gh<Ggb.distanceSquared(Gv._tempV30,Gv._tempV33))return 0;var Gi=Gv._tempV30.elements,Gj=Gi[0],Gk=Gi[1],Gl=Gi[2],Go=Gv._tempV32.elements,Gp=Go[0],Gq=Go[1],Gr=Go[2];return Gp+Gh<=Gj&&Gj<=Gd-Gh&&Gh<Gd-Gp&&Gq+Gh<=Gk&&Gk<=Ge-Gh&&Gh<Ge-Gq&&Gr+Gh<=Gl&&Gl<=Gf-Gh&&Gh<Gf-Gr?1:2},Ga.containsOrientedBoundBox=function(Ga){var Gb=0,Gc=0;Ga.getCorners(Gv._corners);var Gd=this.containsPoints(Gv._corners);if(0!=Gd)return Gd;var Ge=this.extents.elements;Ga.extents.cloneTo(Gv._tempV35);var Gf=Gv._tempV35.elements;Gv._getRows(this.transformation,Gv._rows1),Gv._getRows(Ga.transformation,Gv._rows2);var Gg=NaN;for(Gb=0;Gb<4;Gb++)for(Gc=0;Gc<4;Gc++)3==Gb||3==Gc?(Gv._tempM0.setElementByRowColumn(Gb,Gc,0),Gv._tempM1.setElementByRowColumn(Gb,Gc,0)):(Gg=Ggb.dot(Gv._rows1[Gb],Gv._rows2[Gc]),Gv._tempM0.setElementByRowColumn(Gb,Gc,Gg),Gv._tempM1.setElementByRowColumn(Gb,Gc,Math.abs(Gg)));Ga.getCenter(Gv._tempV34),this.getCenter(Gv._tempV36),Ggb.subtract(Gv._tempV34,Gv._tempV36,Gv._tempV30);var Gh=Gv._tempV31.elements;Gh[0]=Ggb.dot(Gv._tempV30,Gv._rows1[0]),Gh[1]=Ggb.dot(Gv._tempV30,Gv._rows1[1]),Gh[2]=Ggb.dot(Gv._tempV30,Gv._rows1[2]);var Gi=Gv._tempV32.elements,Gj=Gv._tempV33.elements;for(Gb=0;Gb<3;Gb++)if(Gi[0]=Gv._tempM1.getElementByRowColumn(Gb,0),Gi[1]=Gv._tempM1.getElementByRowColumn(Gb,1),Gi[2]=Gv._tempM1.getElementByRowColumn(Gb,2),Ge[Gb]+Ggb.dot(Gv._tempV35,Gv._tempV32)<Math.abs(Gh[Gb]))return 0;for(Gc=0;Gc<3;Gc++)if(Gi[0]=Gv._tempM1.getElementByRowColumn(0,Gc),Gi[1]=Gv._tempM1.getElementByRowColumn(1,Gc),Gi[2]=Gv._tempM1.getElementByRowColumn(2,Gc),Gj[0]=Gv._tempM0.getElementByRowColumn(0,Gc),Gj[1]=Gv._tempM0.getElementByRowColumn(1,Gc),Gj[2]=Gv._tempM0.getElementByRowColumn(2,Gc),Ggb.dot(this.extents,Gv._tempV32)+Gf[Gc]<Math.abs(Ggb.dot(Gv._tempV31,Gv._tempV33)))return 0;for(Gb=0;Gb<3;Gb++)for(Gc=0;Gc<3;Gc++){var Gk=(Gb+1)%3,Gl=(Gb+2)%3,Go=(Gc+1)%3,Gp=(Gc+2)%3;if(Ge[Gk]*Gv._tempM1.getElementByRowColumn(Gl,Gc)+Ge[Gl]*Gv._tempM1.getElementByRowColumn(Gk,Gc)+(Gf[Go]*Gv._tempM1.getElementByRowColumn(Gb,Gp)+Gf[Gp]*Gv._tempM1.getElementByRowColumn(Gb,Go))<Math.abs(Gh[Gl]*Gv._tempM0.getElementByRowColumn(Gk,Gc)-Gh[Gk]*Gv._tempM0.getElementByRowColumn(Gl,Gc)))return 0}return 2},Ga.containsLine=function(Ga,Gb){Gv._corners[0]=Ga,Gv._corners[1]=Gb;var Gc=this.containsPoints(Gv._corners);if(0!=Gc)return Gc;var Gd=this.extents.elements,Ge=Gd[0],Gf=Gd[1],Gg=Gd[2];this.transformation.invert(Gv._tempM0),Ggb.transformCoordinate(Ga,Gv._tempM0,Gv._tempV30),Ggb.transformCoordinate(Gb,Gv._tempM0,Gv._tempV31),Ggb.add(Gv._tempV30,Gv._tempV31,Gv._tempV32),Ggb.scale(Gv._tempV32,.5,Gv._tempV32),Ggb.subtract(Gv._tempV30,Gv._tempV32,Gv._tempV33);var Gh=Gv._tempV33.elements,Gi=Gh[0],Gj=Gh[1],Gk=Gh[2],Gl=Gv._tempV34.elements,Go=Gl[0]=Math.abs(Gh[0]),Gp=Gl[1]=Math.abs(Gh[1]),Gq=Gl[2]=Math.abs(Gh[2]),Gr=Gv._tempV32.elements,Gs=Gr[0],Gt=Gr[1],Gu=Gr[2];return Math.abs(Gs)>Ge+Go?0:Math.abs(Gt)>Gf+Gp?0:Math.abs(Gu)>Gg+Gq?0:Math.abs(Gt*Gk-Gu*Gj)>Gf*Gq+Gg*Gp?0:Math.abs(Gs*Gk-Gu*Gi)>Ge*Gq+Gg*Go?0:Math.abs(Gs*Gj-Gt*Gi)>Ge*Gp+Gf*Go?0:2},Ga.containsBoundBox=function(Ga){var Gb=0,Gc=0,Gd=Ga.min,Ge=Ga.max;Ga.getCorners(Gv._corners);var Gf=this.containsPoints(Gv._corners);if(0!=Gf)return Gf;Ggb.subtract(Ge,Gd,Gv._tempV30),Ggb.scale(Gv._tempV30,.5,Gv._tempV30),Ggb.add(Gd,Gv._tempV30,Gv._tempV30),Ggb.subtract(Ge,Gv._tempV30,Gv._tempV31);var Gg=this.extents.elements,Gh=Gv._tempV31.elements;Gv._getRows(this.transformation,Gv._rows1),this.transformation.invert(Gv._tempM0);for(Gb=0;Gb<3;Gb++)for(Gc=0;Gc<3;Gc++)Gv._tempM1.setElementByRowColumn(Gb,Gc,Math.abs(Gv._tempM0.getElementByRowColumn(Gb,Gc)));this.getCenter(Gv._tempV35),Ggb.subtract(Gv._tempV30,Gv._tempV35,Gv._tempV32);var Gi=Gv._tempV31.elements;Gi[0]=Ggb.dot(Gv._tempV32,Gv._rows1[0]),Gi[1]=Ggb.dot(Gv._tempV32,Gv._rows1[1]),Gi[2]=Ggb.dot(Gv._tempV32,Gv._rows1[2]);var Gj=Gv._tempV33.elements,Gk=Gv._tempV34.elements;for(Gb=0;Gb<3;Gb++)if(Gj[0]=Gv._tempM1.getElementByRowColumn(Gb,0),Gj[1]=Gv._tempM1.getElementByRowColumn(Gb,1),Gj[2]=Gv._tempM1.getElementByRowColumn(Gb,2),Gg[Gb]+Ggb.dot(Gv._tempV31,Gv._tempV33)<Math.abs(Gi[Gb]))return 0;for(Gc=0;Gc<3;Gc++)if(Gj[0]=Gv._tempM1.getElementByRowColumn(0,Gc),Gj[1]=Gv._tempM1.getElementByRowColumn(1,Gc),Gj[2]=Gv._tempM1.getElementByRowColumn(2,Gc),Gk[0]=Gv._tempM0.getElementByRowColumn(0,Gc),Gk[1]=Gv._tempM0.getElementByRowColumn(1,Gc),Gk[2]=Gv._tempM0.getElementByRowColumn(2,Gc),Ggb.dot(this.extents,Gv._tempV33)+Gh[Gc]<Math.abs(Ggb.dot(Gv._tempV31,Gv._tempV34)))return 0;for(Gb=0;Gb<3;Gb++)for(Gc=0;Gc<3;Gc++){var Gl=(Gb+1)%3,Go=(Gb+2)%3,Gp=(Gc+1)%3,Gq=(Gc+2)%3;if(Gg[Gl]*Gv._tempM1.getElementByRowColumn(Go,Gc)+Gg[Go]*Gv._tempM1.getElementByRowColumn(Gl,Gc)+(Gh[Gp]*Gv._tempM1.getElementByRowColumn(Gb,Gq)+Gh[Gq]*Gv._tempM1.getElementByRowColumn(Gb,Gp))<Math.abs(Gi[Go]*Gv._tempM0.getElementByRowColumn(Gl,Gc)-Gi[Gl]*Gv._tempM0.getElementByRowColumn(Go,Gc)))return 0}return 2},Ga.intersectsRay=function(Ga,Gb){Ggb.scale(this.extents,-1,Gv._tempV30),this.transformation.invert(Gv._tempM0),Ggb.TransformNormal(Ga.direction,Gv._tempM0,Gv._ray.direction),Ggb.transformCoordinate(Ga.origin,Gv._tempM0,Gv._ray.origin),Gv._boxBound1.min=Gv._tempV30,Gv._boxBound1.max=this.extents;var Gc=Collision.intersectsRayAndBoxRP(Gv._ray,Gv._boxBound1,Gb);return-1!==Gc&&Ggb.transformCoordinate(Gb,this.transformation,Gb),Gc},Ga._getLocalCorners=function(Ga){Ga.length=8;var Gb=this.extents.elements;Gv._tempV30.x=Gb[0],Gv._tempV31.y=Gb[1],Gv._tempV32.z=Gb[2],Ggb.add(Gv._tempV30,Gv._tempV31,Gv._tempV33),Ggb.add(Gv._tempV33,Gv._tempV32,Ga[0]),Ggb.add(Gv._tempV30,Gv._tempV31,Gv._tempV33),Ggb.subtract(Gv._tempV33,Gv._tempV32,Ga[1]),Ggb.subtract(Gv._tempV31,Gv._tempV30,Gv._tempV33),Ggb.subtract(Gv._tempV33,Gv._tempV30,Ga[2]),Ggb.subtract(Gv._tempV31,Gv._tempV30,Gv._tempV33),Ggb.add(Gv._tempV33,Gv._tempV32,Ga[3]),Ggb.subtract(Gv._tempV30,Gv._tempV31,Gv._tempV33),Ggb.add(Gv._tempV33,Gv._tempV32,Ga[4]),Ggb.subtract(Gv._tempV30,Gv._tempV31,Gv._tempV33),Ggb.subtract(Gv._tempV33,Gv._tempV32,Ga[5]),Ggb.scale(Ga[0],-1,Ga[6]),Ggb.subtract(Gv._tempV32,Gv._tempV30,Gv._tempV33),Ggb.subtract(Gv._tempV33,Gv._tempV31,Ga[7])},Ga.equals=function(Ga){return this.extents==Ga.extents&&this.transformation==Ga.transformation},Ga.cloneTo=function(Ga){var Gb=Ga;this.extents.cloneTo(Gb.extents),this.transformation.cloneTo(Gb.transformation)},Gv.createByBoundBox=function(Ga,Gb){var Gc=Ga.min,Gd=Ga.max;Ggb.subtract(Gd,Gc,Gv._tempV30),Ggb.scale(Gv._tempV30,.5,Gv._tempV30),Ggb.add(Gc,Gv._tempV30,Gv._tempV31),Ggb.subtract(Gd,Gv._tempV31,Gv._tempV32),Gab.translation(Gv._tempV31,Gv._tempM0);var Ge=Gv._tempV32.clone(),Gf=Gv._tempM0.clone();Gb.extents=Ge,Gb.transformation=Gf},Gv.createByMinAndMaxVertex=function(Ga,Gb){return Ggb.subtract(Gb,Ga,Gv._tempV30),Ggb.scale(Gv._tempV30,.5,Gv._tempV30),Ggb.add(Ga,Gv._tempV30,Gv._tempV31),Ggb.subtract(Gb,Gv._tempV31,Gv._tempV32),Gab.translation(Gv._tempV31,Gv._tempM0),new Gv(Gv._tempV32,Gv._tempM0)},Gv._getRows=function(Ga,Gb){Gb.length=3;var Gc=Ga.elements,Gd=Gb[0].elements;Gd[0]=Gc[0],Gd[1]=Gc[1],Gd[2]=Gc[2];var Ge=Gb[1].elements;Ge[0]=Gc[4],Ge[1]=Gc[5],Ge[2]=Gc[6];var Gf=Gb[2].elements;Gf[0]=Gc[8],Gf[1]=Gc[9],Gf[2]=Gc[10]},Gv.getObbtoObbMatrix4x4=function(Ga,Gb,Gc,Gd){var Ge=Ga.transformation,Gf=Gb.transformation;if(Gc){Gv._getRows(Ge,Gv._rows1),Gv._getRows(Gf,Gv._rows2);for(var Gg=0;Gg<3;Gg++)for(var Gh=0;Gh<3;Gh++)Gd.setElementByRowColumn(Gg,Gh,Ggb.dot(Gv._rows2[Gg],Gv._rows1[Gh]));Gb.getCenter(Gv._tempV30),Ga.getCenter(Gv._tempV31),Ggb.subtract(Gv._tempV30,Gv._tempV31,Gv._tempV32);var Gi=Gd.elements;Gi[12]=Ggb.dot(Gv._tempV32,Gv._rows1[0]),Gi[13]=Ggb.dot(Gv._tempV32,Gv._rows1[1]),Gi[14]=Ggb.dot(Gv._tempV32,Gv._rows1[2]),Gi[15]=1}else Ge.invert(Gv._tempM0),Gab.multiply(Gf,Gv._tempM0,Gd)},Gv.merge=function(Ga,Gb,Gc){var Gd=Ga.extents,Ge=Ga.transformation;Gv.getObbtoObbMatrix4x4(Ga,Gb,Gc,Gv._tempM0),Gb._getLocalCorners(Gv._corners),Ggb.transformCoordinate(Gv._corners[0],Gv._tempM0,Gv._corners[0]),Ggb.transformCoordinate(Gv._corners[1],Gv._tempM0,Gv._corners[1]),Ggb.transformCoordinate(Gv._corners[2],Gv._tempM0,Gv._corners[2]),Ggb.transformCoordinate(Gv._corners[3],Gv._tempM0,Gv._corners[3]),Ggb.transformCoordinate(Gv._corners[4],Gv._tempM0,Gv._corners[4]),Ggb.transformCoordinate(Gv._corners[5],Gv._tempM0,Gv._corners[5]),Ggb.transformCoordinate(Gv._corners[6],Gv._tempM0,Gv._corners[6]),Ggb.transformCoordinate(Gv._corners[7],Gv._tempM0,Gv._corners[7]),Ggb.scale(Gd,-1,Gv._boxBound1.min),Gd.cloneTo(Gv._boxBound1.max),GZa.createfromPoints(Gv._corners,Gv._boxBound2),GZa.merge(Gv._boxBound2,Gv._boxBound1,Gv._boxBound3);var Gf=Gv._boxBound3.min,Gg=Gv._boxBound3.max;Ggb.subtract(Gg,Gf,Gv._tempV30),Ggb.scale(Gv._tempV30,.5,Gv._tempV30),Ggb.add(Gf,Gv._tempV30,Gv._tempV32),Ggb.subtract(Gg,Gv._tempV32,Gd),Ggb.transformCoordinate(Gv._tempV32,Ge,Gv._tempV33)},Gl(Gv,["_tempV30",function(){return this._tempV30=new Ggb},"_tempV31",function(){return this._tempV31=new Ggb},"_tempV32",function(){return this._tempV32=new Ggb},"_tempV33",function(){return this._tempV33=new Ggb},"_tempV34",function(){return this._tempV34=new Ggb},"_tempV35",function(){return this._tempV35=new Ggb},"_tempV36",function(){return this._tempV36=new Ggb},"_tempM0",function(){return this._tempM0=new Gab},"_tempM1",function(){return this._tempM1=new Gab},"_corners",function(){return this._corners=[new Ggb,new Ggb,new Ggb,new Ggb,new Ggb,new Ggb,new Ggb,new Ggb]},"_rows1",function(){return this._rows1=[new Ggb,new Ggb,new Ggb]},"_rows2",function(){return this._rows2=[new Ggb,new Ggb,new Ggb]},"_ray",function(){return this._ray=new Geb(new Ggb,new Ggb)},"_boxBound1",function(){return this._boxBound1=new GZa(new Ggb,new Ggb)},"_boxBound2",function(){return this._boxBound2=new GZa(new Ggb,new Ggb)},"_boxBound3",function(){return this._boxBound3=new GZa(new Ggb,new Ggb)}])}(),function(){function Gx(Ga,Gb){this.normal=null,this.distance=NaN,void 0===Gb&&(Gb=0),this.normal=Ga,this.distance=Gb}return Gp(Gx,"laya.d3.math.Plane"),Gx.prototype.normalize=function(){var Ga=this.normal.elements,Gb=Ga[0],Gc=Ga[1],Gd=Ga[2],Ge=1/Math.sqrt(Gb*Gb+Gc*Gc+Gd*Gd);Ga[0]=Gb*Ge,Ga[1]=Gc*Ge,Ga[2]=Gd*Ge,this.distance*=Ge},Gx.createPlaneBy3P=function(Ga,Gb,Gc){var Gd=Ga.elements,Ge=Gb.elements,Gf=Gc.elements,Gg=Ge[0]-Gd[0],Gh=Ge[1]-Gd[1],Gi=Ge[2]-Gd[2],Gj=Gf[0]-Gd[0],Gk=Gf[1]-Gd[1],Gl=Gf[2]-Gd[2],Go=Gh*Gl-Gi*Gk,Gp=Gi*Gj-Gg*Gl,Gq=Gg*Gk-Gh*Gj,Gr=1/Math.sqrt(Go*Go+Gp*Gp+Gq*Gq),Gs=Go*Gr,Gt=Gp*Gr,Gu=Gq*Gr,Gv=Gx._TEMPVec3.elements;Gv[0]=Gs,Gv[1]=Gt,Gv[2]=Gu;var Gw=-(Gs*Gd[0]+Gt*Gd[1]+Gu*Gd[2]);return new Gx(Gx._TEMPVec3,Gw)},Gx.PlaneIntersectionType_Back=0,Gx.PlaneIntersectionType_Front=1,Gx.PlaneIntersectionType_Intersecting=2,Gl(Gx,["_TEMPVec3",function(){return this._TEMPVec3=new Ggb}]),Gx}()),Gcb=function(){function Ge(Ga,Gb,Gc,Gd){this.elements=new Float32Array(4),void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=1),this.elements[0]=Ga,this.elements[1]=Gb,this.elements[2]=Gc,this.elements[3]=Gd}Gp(Ge,"laya.d3.math.Quaternion");var Ga=Ge.prototype;return Gx.imps(Ga,{"laya.d3.core.IClone":!0}),Ga.scaling=function(Ga,Gb){var Gc=Gb.elements,Gd=this.elements;Gc[0]=Gd[0]*Ga,Gc[1]=Gd[1]*Ga,Gc[2]=Gd[2]*Ga,Gc[3]=Gd[3]*Ga},Ga.normalize=function(Ga){var Gb=Ga.elements,Gc=this.elements,Gd=Gc[0],Ge=Gc[1],Gf=Gc[2],Gg=Gc[3],Gh=Gd*Gd+Ge*Ge+Gf*Gf+Gg*Gg;0<Gh&&(Gh=1/Math.sqrt(Gh),Gb[0]=Gd*Gh,Gb[1]=Ge*Gh,Gb[2]=Gf*Gh,Gb[3]=Gg*Gh)},Ga.length=function(){var Ga=this.elements,Gb=Ga[0],Gc=Ga[1],Gd=Ga[2],Ge=Ga[3];return Math.sqrt(Gb*Gb+Gc*Gc+Gd*Gd+Ge*Ge)},Ga.rotateX=function(Ga,Gb){var Gc=Gb.elements,Gd=this.elements;Ga*=.5;var Ge=Gd[0],Gf=Gd[1],Gg=Gd[2],Gh=Gd[3],Gi=Math.sin(Ga),Gj=Math.cos(Ga);Gc[0]=Ge*Gj+Gh*Gi,Gc[1]=Gf*Gj+Gg*Gi,Gc[2]=Gg*Gj-Gf*Gi,Gc[3]=Gh*Gj-Ge*Gi},Ga.rotateY=function(Ga,Gb){var Gc=Gb.elements,Gd=this.elements;Ga*=.5;var Ge=Gd[0],Gf=Gd[1],Gg=Gd[2],Gh=Gd[3],Gi=Math.sin(Ga),Gj=Math.cos(Ga);Gc[0]=Ge*Gj-Gg*Gi,Gc[1]=Gf*Gj+Gh*Gi,Gc[2]=Gg*Gj+Ge*Gi,Gc[3]=Gh*Gj-Gf*Gi},Ga.rotateZ=function(Ga,Gb){var Gc=Gb.elements,Gd=this.elements;Ga*=.5;var Ge=Gd[0],Gf=Gd[1],Gg=Gd[2],Gh=Gd[3],Gi=Math.sin(Ga),Gj=Math.cos(Ga);Gc[0]=Ge*Gj+Gf*Gi,Gc[1]=Gf*Gj-Ge*Gi,Gc[2]=Gg*Gj+Gh*Gi,Gc[3]=Gh*Gj-Gg*Gi},Ga.getYawPitchRoll=function(Ga){Ggb.transformQuat(Ggb.ForwardRH,this,Ge.TEMPVector31),Ggb.transformQuat(Ggb.Up,this,Ge.TEMPVector32);var Gb=Ge.TEMPVector32.elements;Ge.angleTo(Ggb.ZERO,Ge.TEMPVector31,Ge.TEMPVector33);var Gc=Ge.TEMPVector33.elements;Gc[0]==Math.PI/2?(Gc[1]=Ge.arcTanAngle(Gb[2],Gb[0]),Gc[2]=0):Gc[0]==-Math.PI/2?(Gc[1]=Ge.arcTanAngle(-Gb[2],-Gb[0]),Gc[2]=0):(Gab.createRotationY(-Gc[1],Ge.TEMPMatrix0),Gab.createRotationX(-Gc[0],Ge.TEMPMatrix1),Ggb.transformCoordinate(Ge.TEMPVector32,Ge.TEMPMatrix0,Ge.TEMPVector32),Ggb.transformCoordinate(Ge.TEMPVector32,Ge.TEMPMatrix1,Ge.TEMPVector32),Gc[2]=Ge.arcTanAngle(Gb[1],-Gb[0])),Gc[1]<=-Math.PI&&(Gc[1]=Math.PI),Gc[2]<=-Math.PI&&(Gc[2]=Math.PI),Gc[1]>=Math.PI&&Gc[2]>=Math.PI&&(Gc[1]=0,Gc[2]=0,Gc[0]=Math.PI-Gc[0]);var Gd=Ga.elements;Gd[0]=Gc[1],Gd[1]=Gc[0],Gd[2]=Gc[2]},Ga.invert=function(Ga){var Gb=Ga.elements,Gc=this.elements,Gd=Gc[0],Ge=Gc[1],Gf=Gc[2],Gg=Gc[3],Gh=Gd*Gd+Ge*Ge+Gf*Gf+Gg*Gg,Gi=Gh?1/Gh:0;Gb[0]=-Gd*Gi,Gb[1]=-Ge*Gi,Gb[2]=-Gf*Gi,Gb[3]=Gg*Gi},Ga.identity=function(){var Ga=this.elements;Ga[0]=0,Ga[1]=0,Ga[2]=0,Ga[3]=1},Ga.fromArray=function(Ga,Gb){void 0===Gb&&(Gb=0),this.elements[0]=Ga[Gb+0],this.elements[1]=Ga[Gb+1],this.elements[2]=Ga[Gb+2],this.elements[3]=Ga[Gb+3]},Ga.cloneTo=function(Ga){var Gb,Gc,Gd;if((Gc=this.elements)!==(Gd=Ga.elements))for(Gb=0;Gb<4;++Gb)Gd[Gb]=Gc[Gb]},Ga.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Ga.equals=function(Ga){var Gb=this.elements,Gc=Ga.elements;return Gma.nearEqual(Gb[0],Gc[0])&&Gma.nearEqual(Gb[1],Gc[1])&&Gma.nearEqual(Gb[2],Gc[2])&&Gma.nearEqual(Gb[3],Gc[3])},Ga.lengthSquared=function(){var Ga=this.elements[0],Gb=this.elements[1],Gc=this.elements[2],Gd=this.elements[3];return Ga*Ga+Gb*Gb+Gc*Gc+Gd*Gd},Gq(0,Ga,"x",function(){return this.elements[0]}),Gq(0,Ga,"y",function(){return this.elements[1]}),Gq(0,Ga,"z",function(){return this.elements[2]}),Gq(0,Ga,"w",function(){return this.elements[3]}),Ge.createFromYawPitchRoll=function(Ga,Gb,Gc,Gd){var Ge=.5*Gc,Gf=.5*Gb,Gg=.5*Ga,Gh=Math.sin(Ge),Gi=Math.cos(Ge),Gj=Math.sin(Gf),Gk=Math.cos(Gf),Gl=Math.sin(Gg),Go=Math.cos(Gg),Gp=Gd.elements;Gp[0]=Go*Gj*Gi+Gl*Gk*Gh,Gp[1]=Gl*Gk*Gi-Go*Gj*Gh,Gp[2]=Go*Gk*Gh-Gl*Gj*Gi,Gp[3]=Go*Gk*Gi+Gl*Gj*Gh},Ge.multiply=function(Ga,Gb,Gc){var Gd=Ga.elements,Ge=Gb.elements,Gf=Gc.elements,Gg=Gd[0],Gh=Gd[1],Gi=Gd[2],Gj=Gd[3],Gk=Ge[0],Gl=Ge[1],Go=Ge[2],Gp=Ge[3],Gq=Gh*Go-Gi*Gl,Gr=Gi*Gk-Gg*Go,Gs=Gg*Gl-Gh*Gk,Gt=Gg*Gk+Gh*Gl+Gi*Go;Gf[0]=Gg*Gp+Gk*Gj+Gq,Gf[1]=Gh*Gp+Gl*Gj+Gr,Gf[2]=Gi*Gp+Go*Gj+Gs,Gf[3]=Gj*Gp-Gt},Ge.arcTanAngle=function(Ga,Gb){return 0==Ga?1==Gb?Math.PI/2:-Math.PI/2:0<Ga?Math.atan(Gb/Ga):Ga<0?0<Gb?Math.atan(Gb/Ga)+Math.PI:Math.atan(Gb/Ga)-Math.PI:0},Ge.angleTo=function(Ga,Gb,Gc){Ggb.subtract(Gb,Ga,Ge.TEMPVector30),Ggb.normalize(Ge.TEMPVector30,Ge.TEMPVector30),Gc.elements[0]=Math.asin(Ge.TEMPVector30.y),Gc.elements[1]=Ge.arcTanAngle(-Ge.TEMPVector30.z,-Ge.TEMPVector30.x)},Ge.createFromAxisAngle=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements;Gb*=.5;var Gf=Math.sin(Gb);Gd[0]=Gf*Ge[0],Gd[1]=Gf*Ge[1],Gd[2]=Gf*Ge[2],Gd[3]=Math.cos(Gb)},Ge.createFromMatrix3x3=function(Ga,Gb){var Gc,Gd=Gb.elements,Ge=Ga.elements,Gf=Ge[0]+Ge[4]+Ge[8];if(0<Gf)Gc=Math.sqrt(Gf+1),Gd[3]=.5*Gc,Gc=.5/Gc,Gd[0]=(Ge[5]-Ge[7])*Gc,Gd[1]=(Ge[6]-Ge[2])*Gc,Gd[2]=(Ge[1]-Ge[3])*Gc;else{var Gg=0;Ge[4]>Ge[0]&&(Gg=1),Ge[8]>Ge[3*Gg+Gg]&&(Gg=2);var Gh=(Gg+1)%3,Gi=(Gg+2)%3;Gc=Math.sqrt(Ge[3*Gg+Gg]-Ge[3*Gh+Gh]-Ge[3*Gi+Gi]+1),Gd[Gg]=.5*Gc,Gc=.5/Gc,Gd[3]=(Ge[3*Gh+Gi]-Ge[3*Gi+Gh])*Gc,Gd[Gh]=(Ge[3*Gh+Gg]+Ge[3*Gg+Gh])*Gc,Gd[Gi]=(Ge[3*Gi+Gg]+Ge[3*Gg+Gi])*Gc}},Ge.createFromMatrix4x4=function(Ga,Gb){var Gc,Gd,Ge=Ga.elements,Gf=Gb.elements,Gg=Ge[0]+Ge[5]+Ge[10];0<Gg?(Gc=Math.sqrt(Gg+1),Gf[3]=.5*Gc,Gc=.5/Gc,Gf[0]=(Ge[6]-Ge[9])*Gc,Gf[1]=(Ge[8]-Ge[2])*Gc,Gf[2]=(Ge[1]-Ge[4])*Gc):Ge[0]>=Ge[5]&&Ge[0]>=Ge[10]?(Gd=.5/(Gc=Math.sqrt(1+Ge[0]-Ge[5]-Ge[10])),Gf[0]=.5*Gc,Gf[1]=(Ge[1]+Ge[4])*Gd,Gf[2]=(Ge[2]+Ge[8])*Gd,Gf[3]=(Ge[6]-Ge[9])*Gd):Ge[5]>Ge[10]?(Gd=.5/(Gc=Math.sqrt(1+Ge[5]-Ge[0]-Ge[10])),Gf[0]=(Ge[4]+Ge[1])*Gd,Gf[1]=.5*Gc,Gf[2]=(Ge[9]+Ge[6])*Gd,Gf[3]=(Ge[8]-Ge[2])*Gd):(Gd=.5/(Gc=Math.sqrt(1+Ge[10]-Ge[0]-Ge[5])),Gf[0]=(Ge[8]+Ge[2])*Gd,Gf[1]=(Ge[9]+Ge[6])*Gd,Gf[2]=.5*Gc,Gf[3]=(Ge[1]-Ge[4])*Gd)},Ge.slerp=function(Ga,Gb,Gc,Gd){var Ge,Gf,Gg,Gh,Gi,Gj=Ga.elements,Gk=Gb.elements,Gl=Gd.elements,Go=Gj[0],Gp=Gj[1],Gq=Gj[2],Gr=Gj[3],Gs=Gk[0],Gt=Gk[1],Gu=Gk[2],Gv=Gk[3];return(Gf=Go*Gs+Gp*Gt+Gq*Gu+Gr*Gv)<0&&(Gf=-Gf,Gs=-Gs,Gt=-Gt,Gu=-Gu,Gv=-Gv),Gi=1e-6<1-Gf?(Ge=Math.acos(Gf),Gg=Math.sin(Ge),Gh=Math.sin((1-Gc)*Ge)/Gg,Math.sin(Gc*Ge)/Gg):(Gh=1-Gc,Gc),Gl[0]=Gh*Go+Gi*Gs,Gl[1]=Gh*Gp+Gi*Gt,Gl[2]=Gh*Gq+Gi*Gu,Gl[3]=Gh*Gr+Gi*Gv,Gl},Ge.lerp=function(Ga,Gb,Gc,Gd){var Ge=Gd.elements,Gf=Ga.elements,Gg=Gb.elements,Gh=Gf[0],Gi=Gf[1],Gj=Gf[2],Gk=Gf[3];Ge[0]=Gh+Gc*(Gg[0]-Gh),Ge[1]=Gi+Gc*(Gg[1]-Gi),Ge[2]=Gj+Gc*(Gg[2]-Gj),Ge[3]=Gk+Gc*(Gg[3]-Gk)},Ge.add=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements;Gd[0]=Ge[0]+Gf[0],Gd[1]=Ge[1]+Gf[1],Gd[2]=Ge[2]+Gf[2],Gd[3]=Ge[3]+Gf[3]},Ge.dot=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements;return Gc[0]*Gd[0]+Gc[1]*Gd[1]+Gc[2]*Gd[2]+Gc[3]*Gd[3]},Ge.rotationLookAt=function(Ga,Gb,Gc){Ge.lookAt(Ggb.ZERO,Ga,Gb,Gc)},Ge.lookAt=function(Ga,Gb,Gc,Gd){Gna.lookAt(Ga,Gb,Gc,Ge._tempMatrix3x3),Ge.rotationMatrix(Ge._tempMatrix3x3,Gd)},Ge.invert=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements,Ge=Ga.lengthSquared();Gma.isZero(Ge)||(Ge=1/Ge,Gd[0]=-Gc[0]*Ge,Gd[1]=-Gc[1]*Ge,Gd[2]=-Gc[2]*Ge,Gd[3]=Gc[3]*Ge)},Ge.rotationMatrix=function(Ga,Gb){var Gc=Ga.elements,Gd=Gc[0],Ge=Gc[1],Gf=Gc[2],Gg=Gc[3],Gh=Gc[4],Gi=Gc[5],Gj=Gc[6],Gk=Gc[7],Gl=Gc[8],Go=Gb.elements,Gp=NaN,Gq=NaN,Gr=Gd+Gh+Gl;0<Gr?(Gp=Math.sqrt(Gr+1),Go[3]=.5*Gp,Gp=.5/Gp,Go[0]=(Gi-Gk)*Gp,Go[1]=(Gj-Gf)*Gp,Go[2]=(Ge-Gg)*Gp):Gh<=Gd&&Gl<=Gd?(Gq=.5/(Gp=Math.sqrt(1+Gd-Gh-Gl)),Go[0]=.5*Gp,Go[1]=(Ge+Gg)*Gq,Go[2]=(Gf+Gj)*Gq,Go[3]=(Gi-Gk)*Gq):Gl<Gh?(Gq=.5/(Gp=Math.sqrt(1+Gh-Gd-Gl)),Go[0]=(Gg+Ge)*Gq,Go[1]=.5*Gp,Go[2]=(Gk+Gi)*Gq,Go[3]=(Gj-Gf)*Gq):(Gq=.5/(Gp=Math.sqrt(1+Gl-Gd-Gh)),Go[0]=(Gj+Gf)*Gq,Go[1]=(Gk+Gi)*Gq,Go[2]=.5*Gp,Go[3]=(Ge-Gg)*Gq)},Ge.DEFAULT=new Ge,Gl(Ge,["TEMPVector30",function(){return this.TEMPVector30=new Ggb},"TEMPVector31",function(){return this.TEMPVector31=new Ggb},"TEMPVector32",function(){return this.TEMPVector32=new Ggb},"TEMPVector33",function(){return this.TEMPVector33=new Ggb},"TEMPMatrix0",function(){return this.TEMPMatrix0=new Gab},"TEMPMatrix1",function(){return this.TEMPMatrix1=new Gab},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new Gna},"NAN",function(){return this.NAN=new Ge(NaN,NaN,NaN,NaN)}]),Ge}(),Gdb=function(){function Ga(Ga){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=Ga,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}Gp(Ga,"laya.d3.math.Rand");var Gb=Ga.prototype;return Gb.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},Gb.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},Gb.getSignedFloat=function(){return 2*this.getFloat()-1},Gq(0,Gb,"seed",function(){return this.seeds[0]},function(Ga){this.seeds[0]=Ga,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),Ga.getFloatFromInt=function(Ga){return 1/8388607*(8388607&Ga)},Ga.getByteFromInt=function(Ga){return(8388607&Ga)>>>15},Ga}(),Geb=(function(){function Ge(Ga){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(Ga instanceof Array)||4!==Ga.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|Ga[0],this._state0L=0|Ga[1],this._state1U=0|Ga[2],this._state1L=0|Ga[3]}Gp(Ge,"laya.d3.math.RandX");var Ga=Ge.prototype;Ga.randomint=function(){var Ga=this._state0U,Gb=this._state0L,Gc=this._state1U,Gd=this._state1L,Ge=(Gd>>>0)+(Gb>>>0),Gf=Gc+Ga+(Ge/2>>>31)>>>0,Gg=Ge>>>0,Gh=0,Gi=0;Gh=(Ga^=Gh=Ga<<23|(-512&Gb)>>>9)^(this._state0U=Gc),Gi=(Gb^=Gi=Gb<<23)^(this._state0L=Gd);Gh^=Ga>>>18,Gi^=Gb>>>18|(262143&Ga)<<14;return Gh^=Gc>>>5,Gi^=Gd>>>5|(31&Gc)<<27,this._state1U=Gh,this._state1L=Gi,[Gf,Gg]},Ga.random=function(){var Ga=this.randomint(),Gb=Ga[0],Gc=1023<<20|Gb>>>12,Gd=0|(Ga[1]>>>12|(4095&Gb)<<20);return Ge._CONVERTION_BUFFER.setUint32(0,Gc,!1),Ge._CONVERTION_BUFFER.setUint32(4,Gd,!1),Gdb._CONVERTION_BUFFER.getFloat64(0,!1)-1},Gl(Ge,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new Gdb([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function Ga(Ga,Gb){this.origin=null,this.direction=null,this.origin=Ga,this.direction=Gb}return Gp(Ga,"laya.d3.math.Ray"),Ga}()),Gfb=function(){function Ga(Ga,Gb){this.elements=new Float32Array(2),void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0);var Gc=this.elements;Gc[0]=Ga,Gc[1]=Gb}Gp(Ga,"laya.d3.math.Vector2");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb.fromArray=function(Ga,Gb){void 0===Gb&&(Gb=0),this.elements[0]=Ga[Gb+0],this.elements[1]=Ga[Gb+1]},Gb.cloneTo=function(Ga){var Gb=Ga.elements,Gc=this.elements;Gb[0]=Gc[0],Gb[1]=Gc[1]},Gb.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Gb,"x",function(){return this.elements[0]},function(Ga){this.elements[0]=Ga}),Gq(0,Gb,"y",function(){return this.elements[1]},function(Ga){this.elements[1]=Ga}),Ga.scale=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements;Gd[0]=Ge[0]*Gb,Gd[1]=Ge[1]*Gb},Gl(Ga,["ZERO",function(){return this.ZERO=new Ga(0,0)},"ONE",function(){return this.ONE=new Ga(1,1)}]),Ga}(),Ggb=function(){function Gk(Ga,Gb,Gc){this.elements=new Float32Array(3),void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0);var Gd=this.elements;Gd[0]=Ga,Gd[1]=Gb,Gd[2]=Gc}Gp(Gk,"laya.d3.math.Vector3");var Ga=Gk.prototype;return Gx.imps(Ga,{"laya.d3.core.IClone":!0}),Ga.fromArray=function(Ga,Gb){void 0===Gb&&(Gb=0),this.elements[0]=Ga[Gb+0],this.elements[1]=Ga[Gb+1],this.elements[2]=Ga[Gb+2]},Ga.cloneTo=function(Ga){var Gb=Ga.elements,Gc=this.elements;Gb[0]=Gc[0],Gb[1]=Gc[1],Gb[2]=Gc[2]},Ga.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Ga.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},Ga.reset=function(Ga,Gb,Gc){this.elements[0]=Ga,this.elements[1]=Gb,this.elements[2]=Gc},Gq(0,Ga,"x",function(){return this.elements[0]},function(Ga){this.elements[0]=Ga}),Gq(0,Ga,"y",function(){return this.elements[1]},function(Ga){this.elements[1]=Ga}),Gq(0,Ga,"z",function(){return this.elements[2]},function(Ga){this.elements[2]=Ga}),Gk.distanceSquared=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements,Ge=Gc[0]-Gd[0],Gf=Gc[1]-Gd[1],Gg=Gc[2]-Gd[2];return Ge*Ge+Gf*Gf+Gg*Gg},Gk.distance=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements,Ge=Gc[0]-Gd[0],Gf=Gc[1]-Gd[1],Gg=Gc[2]-Gd[2];return Math.sqrt(Ge*Ge+Gf*Gf+Gg*Gg)},Gk.min=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements;Gd[0]=Math.min(Ge[0],Gf[0]),Gd[1]=Math.min(Ge[1],Gf[1]),Gd[2]=Math.min(Ge[2],Gf[2])},Gk.max=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements;Gd[0]=Math.max(Ge[0],Gf[0]),Gd[1]=Math.max(Ge[1],Gf[1]),Gd[2]=Math.max(Ge[2],Gf[2])},Gk.transformQuat=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements,Gg=Ge[0],Gh=Ge[1],Gi=Ge[2],Gj=Gf[0],Gk=Gf[1],Gl=Gf[2],Go=Gf[3],Gp=Go*Gg+Gk*Gi-Gl*Gh,Gq=Go*Gh+Gl*Gg-Gj*Gi,Gr=Go*Gi+Gj*Gh-Gk*Gg,Gs=-Gj*Gg-Gk*Gh-Gl*Gi;Gd[0]=Gp*Go+Gs*-Gj+Gq*-Gl-Gr*-Gk,Gd[1]=Gq*Go+Gs*-Gk+Gr*-Gj-Gp*-Gl,Gd[2]=Gr*Go+Gs*-Gl+Gp*-Gk-Gq*-Gj},Gk.scalarLength=function(Ga){var Gb=Ga.elements,Gc=Gb[0],Gd=Gb[1],Ge=Gb[2];return Math.sqrt(Gc*Gc+Gd*Gd+Ge*Ge)},Gk.scalarLengthSquared=function(Ga){var Gb=Ga.elements,Gc=Gb[0],Gd=Gb[1],Ge=Gb[2];return Gc*Gc+Gd*Gd+Ge*Ge},Gk.normalize=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements,Ge=Gc[0],Gf=Gc[1],Gg=Gc[2],Gh=Ge*Ge+Gf*Gf+Gg*Gg;0<Gh&&(Gh=1/Math.sqrt(Gh),Gd[0]=Gc[0]*Gh,Gd[1]=Gc[1]*Gh,Gd[2]=Gc[2]*Gh)},Gk.multiply=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements;Gd[0]=Ge[0]*Gf[0],Gd[1]=Ge[1]*Gf[1],Gd[2]=Ge[2]*Gf[2]},Gk.scale=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements;Gd[0]=Ge[0]*Gb,Gd[1]=Ge[1]*Gb,Gd[2]=Ge[2]*Gb},Gk.lerp=function(Ga,Gb,Gc,Gd){var Ge=Gd.elements,Gf=Ga.elements,Gg=Gb.elements,Gh=Gf[0],Gi=Gf[1],Gj=Gf[2];Ge[0]=Gh+Gc*(Gg[0]-Gh),Ge[1]=Gi+Gc*(Gg[1]-Gi),Ge[2]=Gj+Gc*(Gg[2]-Gj)},Gk.transformV3ToV3=function(Ga,Gb,Gc){var Gd=Gk._tempVector4;Gk.transformV3ToV4(Ga,Gb,Gd);var Ge=Gd.elements,Gf=Gc.elements;Gf[0]=Ge[0],Gf[1]=Ge[1],Gf[2]=Ge[2]},Gk.transformV3ToV4=function(Ga,Gb,Gc){var Gd=Ga.elements,Ge=Gd[0],Gf=Gd[1],Gg=Gd[2],Gh=Gb.elements,Gi=Gc.elements;Gi[0]=Ge*Gh[0]+Gf*Gh[4]+Gg*Gh[8]+Gh[12],Gi[1]=Ge*Gh[1]+Gf*Gh[5]+Gg*Gh[9]+Gh[13],Gi[2]=Ge*Gh[2]+Gf*Gh[6]+Gg*Gh[10]+Gh[14],Gi[3]=Ge*Gh[3]+Gf*Gh[7]+Gg*Gh[11]+Gh[15]},Gk.TransformNormal=function(Ga,Gb,Gc){var Gd=Ga.elements,Ge=Gd[0],Gf=Gd[1],Gg=Gd[2],Gh=Gb.elements,Gi=Gc.elements;Gi[0]=Ge*Gh[0]+Gf*Gh[4]+Gg*Gh[8],Gi[1]=Ge*Gh[1]+Gf*Gh[5]+Gg*Gh[9],Gi[2]=Ge*Gh[2]+Gf*Gh[6]+Gg*Gh[10]},Gk.transformCoordinate=function(Ga,Gb,Gc){var Gd=Gk._tempVector4.elements,Ge=Ga.elements,Gf=Ge[0],Gg=Ge[1],Gh=Ge[2],Gi=Gb.elements;Gd[0]=Gf*Gi[0]+Gg*Gi[4]+Gh*Gi[8]+Gi[12],Gd[1]=Gf*Gi[1]+Gg*Gi[5]+Gh*Gi[9]+Gi[13],Gd[2]=Gf*Gi[2]+Gg*Gi[6]+Gh*Gi[10]+Gi[14],Gd[3]=1/(Gf*Gi[3]+Gg*Gi[7]+Gh*Gi[11]+Gi[15]);var Gj=Gc.elements;Gj[0]=Gd[0]*Gd[3],Gj[1]=Gd[1]*Gd[3],Gj[2]=Gd[2]*Gd[3]},Gk.Clamp=function(Ga,Gb,Gc,Gd){var Ge=Ga.elements,Gf=Ge[0],Gg=Ge[1],Gh=Ge[2],Gi=Gb.elements,Gj=Gi[0],Gk=Gi[1],Gl=Gi[2],Go=Gc.elements,Gp=Go[0],Gq=Go[1],Gr=Go[2],Gs=Gd.elements;Gf=(Gf=Gp<Gf?Gp:Gf)<Gj?Gj:Gf,Gg=(Gg=Gq<Gg?Gq:Gg)<Gk?Gk:Gg,Gh=(Gh=Gr<Gh?Gr:Gh)<Gl?Gl:Gh,Gs[0]=Gf,Gs[1]=Gg,Gs[2]=Gh},Gk.add=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements;Gd[0]=Ge[0]+Gf[0],Gd[1]=Ge[1]+Gf[1],Gd[2]=Ge[2]+Gf[2]},Gk.subtract=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements;Gd[0]=Ge[0]-Gf[0],Gd[1]=Ge[1]-Gf[1],Gd[2]=Ge[2]-Gf[2]},Gk.cross=function(Ga,Gb,Gc){var Gd=Ga.elements,Ge=Gb.elements,Gf=Gc.elements,Gg=Gd[0],Gh=Gd[1],Gi=Gd[2],Gj=Ge[0],Gk=Ge[1],Gl=Ge[2];Gf[0]=Gh*Gl-Gi*Gk,Gf[1]=Gi*Gj-Gg*Gl,Gf[2]=Gg*Gk-Gh*Gj},Gk.dot=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements;return Gc[0]*Gd[0]+Gc[1]*Gd[1]+Gc[2]*Gd[2]},Gk.equals=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements;return Gma.nearEqual(Math.abs(Gc[0]),Math.abs(Gd[0]))&&Gma.nearEqual(Math.abs(Gc[1]),Math.abs(Gd[1]))&&Gma.nearEqual(Math.abs(Gc[2]),Math.abs(Gd[2]))},Gk.ZERO=new Gk(0,0,0),Gk.ONE=new Gk(1,1,1),Gk.NegativeUnitX=new Gk(-1,0,0),Gk.UnitX=new Gk(1,0,0),Gk.UnitY=new Gk(0,1,0),Gk.UnitZ=new Gk(0,0,1),Gk.ForwardRH=new Gk(0,0,-1),Gk.ForwardLH=new Gk(0,0,1),Gk.Up=new Gk(0,1,0),Gk.NAN=new Gk(NaN,NaN,NaN),Gl(Gk,["_tempVector4",function(){return this._tempVector4=new Ghb}]),Gk}(),Ghb=function(){function Ga(Ga,Gb,Gc,Gd){this.elements=new Float32Array(4),void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=0);var Ge=this.elements;Ge[0]=Ga,Ge[1]=Gb,Ge[2]=Gc,Ge[3]=Gd}Gp(Ga,"laya.d3.math.Vector4");var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb.fromArray=function(Ga,Gb){void 0===Gb&&(Gb=0),this.elements[0]=Ga[Gb+0],this.elements[1]=Ga[Gb+1],this.elements[2]=Ga[Gb+2],this.elements[3]=Ga[Gb+3]},Gb.cloneTo=function(Ga){var Gb=Ga.elements,Gc=this.elements;Gb[0]=Gc[0],Gb[1]=Gc[1],Gb[2]=Gc[2],Gb[3]=Gc[3]},Gb.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gb.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},Gb.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},Gq(0,Gb,"x",function(){return this.elements[0]},function(Ga){this.elements[0]=Ga}),Gq(0,Gb,"y",function(){return this.elements[1]},function(Ga){this.elements[1]=Ga}),Gq(0,Gb,"z",function(){return this.elements[2]},function(Ga){this.elements[2]=Ga}),Gq(0,Gb,"w",function(){return this.elements[3]},function(Ga){this.elements[3]=Ga}),Ga.lerp=function(Ga,Gb,Gc,Gd){var Ge=Gd.elements,Gf=Ga.elements,Gg=Gb.elements,Gh=Gf[0],Gi=Gf[1],Gj=Gf[2],Gk=Gf[3];Ge[0]=Gh+Gc*(Gg[0]-Gh),Ge[1]=Gi+Gc*(Gg[1]-Gi),Ge[2]=Gj+Gc*(Gg[2]-Gj),Ge[3]=Gk+Gc*(Gg[3]-Gk)},Ga.transformByM4x4=function(Ga,Gb,Gc){var Gd=Ga.elements,Ge=Gd[0],Gf=Gd[1],Gg=Gd[2],Gh=Gd[3],Gi=Gb.elements,Gj=Gc.elements;Gj[0]=Ge*Gi[0]+Gf*Gi[4]+Gg*Gi[8]+Gh*Gi[12],Gj[1]=Ge*Gi[1]+Gf*Gi[5]+Gg*Gi[9]+Gh*Gi[13],Gj[2]=Ge*Gi[2]+Gf*Gi[6]+Gg*Gi[10]+Gh*Gi[14],Gj[3]=Ge*Gi[3]+Gf*Gi[7]+Gg*Gi[11]+Gh*Gi[15]},Ga.equals=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements;return Gma.nearEqual(Math.abs(Gc[0]),Math.abs(Gd[0]))&&Gma.nearEqual(Math.abs(Gc[1]),Math.abs(Gd[1]))&&Gma.nearEqual(Math.abs(Gc[2]),Math.abs(Gd[2]))&&Gma.nearEqual(Math.abs(Gc[3]),Math.abs(Gd[3]))},Ga.normalize=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements,Ge=Ga.length();0<Ge&&(Gd[0]=Gc[0]*Ge,Gd[1]=Gc[1]*Ge,Gd[2]=Gc[2]*Ge,Gd[3]=Gc[3]*Ge)},Ga.add=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements;Gd[0]=Ge[0]+Gf[0],Gd[1]=Ge[1]+Gf[1],Gd[2]=Ge[2]+Gf[2],Gd[3]=Ge[3]+Gf[3]},Ga.subtract=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements;Gd[0]=Ge[0]-Gf[0],Gd[1]=Ge[1]-Gf[1],Gd[2]=Ge[2]-Gf[2],Gd[3]=Ge[3]-Gf[3]},Ga.multiply=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements;Gd[0]=Ge[0]*Gf[0],Gd[1]=Ge[1]*Gf[1],Gd[2]=Ge[2]*Gf[2],Gd[3]=Ge[3]*Gf[3]},Ga.scale=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements;Gd[0]=Ge[0]*Gb,Gd[1]=Ge[1]*Gb,Gd[2]=Ge[2]*Gb,Gd[3]=Ge[3]*Gb},Ga.Clamp=function(Ga,Gb,Gc,Gd){var Ge=Ga.elements,Gf=Ge[0],Gg=Ge[1],Gh=Ge[2],Gi=Ge[3],Gj=Gb.elements,Gk=Gj[0],Gl=Gj[1],Go=Gj[2],Gp=Gj[3],Gq=Gc.elements,Gr=Gq[0],Gs=Gq[1],Gt=Gq[2],Gu=Gq[3],Gv=Gd.elements;Gf=(Gf=Gr<Gf?Gr:Gf)<Gk?Gk:Gf,Gg=(Gg=Gs<Gg?Gs:Gg)<Gl?Gl:Gg,Gh=(Gh=Gt<Gh?Gt:Gh)<Go?Go:Gh,Gi=(Gi=Gu<Gi?Gu:Gi)<Gp?Gp:Gi,Gv[0]=Gf,Gv[1]=Gg,Gv[2]=Gh,Gv[3]=Gi},Ga.distanceSquared=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements,Ge=Gc[0]-Gd[0],Gf=Gc[1]-Gd[1],Gg=Gc[2]-Gd[2],Gh=Gc[3]-Gd[3];return Ge*Ge+Gf*Gf+Gg*Gg+Gh*Gh},Ga.distance=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements,Ge=Gc[0]-Gd[0],Gf=Gc[1]-Gd[1],Gg=Gc[2]-Gd[2],Gh=Gc[3]-Gd[3];return Math.sqrt(Ge*Ge+Gf*Gf+Gg*Gg+Gh*Gh)},Ga.dot=function(Ga,Gb){var Gc=Ga.elements,Gd=Gb.elements;return Gc[0]*Gd[0]+Gc[1]*Gd[1]+Gc[2]*Gd[2]+Gc[3]*Gd[3]},Ga.min=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements;Gd[0]=Math.min(Ge[0],Gf[0]),Gd[1]=Math.min(Ge[1],Gf[1]),Gd[2]=Math.min(Ge[2],Gf[2]),Gd[3]=Math.min(Ge[3],Gf[3])},Ga.max=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb.elements;Gd[0]=Math.max(Ge[0],Gf[0]),Gd[1]=Math.max(Ge[1],Gf[1]),Gd[2]=Math.max(Ge[2],Gf[2]),Gd[3]=Math.max(Ge[3],Gf[3])},Gl(Ga,["ZERO",function(){return this.ZERO=new Ga},"ONE",function(){return this.ONE=new Ga(1,1,1,1)},"UnitX",function(){return this.UnitX=new Ga(1,0,0,0)},"UnitY",function(){return this.UnitY=new Ga(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new Ga(0,0,1,0)},"UnitW",function(){return this.UnitW=new Ga(0,0,0,1)}]),Ga}(),Gib=function(){function Gf(Ga,Gb,Gc,Gd){this.minDepth=0,this.maxDepth=1,this.x=Ga,this.y=Gb,this.width=Gc,this.height=Gd}Gp(Gf,"laya.d3.math.Viewport");var Ga=Gf.prototype;return Ga.project=function(Ga,Gb,Gc){Ggb.transformV3ToV3(Ga,Gb,Gc);var Gd=Ga.elements,Ge=Gb.elements,Gf=Gc.elements,Gg=Gd[0]*Ge[3]+Gd[1]*Ge[7]+Gd[2]*Ge[11]+Ge[15];1!==Gg&&(Gf[0]=Gf[0]/Gg,Gf[1]=Gf[1]/Gg,Gf[2]=Gf[2]/Gg),Gf[0]=.5*(Gf[0]+1)*this.width+this.x,Gf[1]=.5*(1-Gf[1])*this.height+this.y,Gf[2]=Gf[2]*(this.maxDepth-this.minDepth)+this.minDepth},Ga.unprojectFromMat=function(Ga,Gb,Gc){var Gd=Ga.elements,Ge=Gb.elements,Gf=Gc.elements;Gf[0]=(Gd[0]-this.x)/this.width*2-1,Gf[1]=-((Gd[1]-this.y)/this.height*2-1);var Gg=(this.maxDepth-this.minDepth)/2;Gf[2]=(Gd[2]-this.minDepth-Gg)/Gg;var Gh=Gf[0]*Ge[3]+Gf[1]*Ge[7]+Gf[2]*Ge[11]+Ge[15];Ggb.transformV3ToV3(Gc,Gb,Gc),1!==Gh&&(Gf[0]=Gf[0]/Gh,Gf[1]=Gf[1]/Gh,Gf[2]=Gf[2]/Gh)},Ga.unprojectFromWVP=function(Ga,Gb,Gc,Gd,Ge){Gab.multiply(Gb,Gc,Gf._tempMatrix4x4),Gd&&Gab.multiply(Gf._tempMatrix4x4,Gd,Gf._tempMatrix4x4),Gf._tempMatrix4x4.invert(Gf._tempMatrix4x4),this.unprojectFromMat(Ga,Gf._tempMatrix4x4,Ge)},Gl(Gf,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new Gab}]),Gf}(),Gjb=function(){function GE(Ga){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=Ga,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}Gp(GE,"laya.d3.resource.models.SubMesh");var Ga=GE.prototype;return Gx.imps(Ga,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),Ga._getVertexBuffer=function(Ga){return void 0===Ga&&(Ga=0),0===Ga?this._vertexBuffer:null},Ga._getIndexBuffer=function(){return this._indexBuffer},Ga._getStaticBatchBakedVertexs=function(Ga,Gb){var Gc,Gd,Ge=this._vertexBuffer,Gf=Ge.vertexDeclaration,Gg=Gf.getVertexElementByUsage(0).offset/4,Gh=Gf.getVertexElementByUsage(3).offset/4,Gi=Gb.meshRender.lightmapScaleOffset,Gj=0,Gk=0,Gl=0,Go=0,Gp=0,Gq=0;if(Gi)if(Gd=Gf.getVertexElementByUsage(15))Gl=Gf.vertexStride/4,Gc=0<this._vertexCount?Ge.getData().slice(this._vertexStart*Gl,(this._vertexStart+this._vertexCount)*Gl):Ge.getData().slice(),Go=Gd.offset/4;else{Gl=(Gq=Gf.vertexStride/4)+2,Gc=this._vertexCount?new Float32Array(this._vertexCount*(Ge.vertexDeclaration.vertexStride/4+2)):new Float32Array(Ge.vertexCount*(Ge.vertexDeclaration.vertexStride/4+2)),Go=(Gp=Gf.getVertexElementByUsage(2).offset/4)+2;var Gr=Ge.getData();for(Gj=0,Gk=Gr.length/Gq;Gj<Gk;Gj++){var Gs=0;Gs=0<this._vertexCount?(this._vertexStart+Gj)*Gq:Gj*Gq;var Gt=Gj*Gl,Gu=0;for(Gu=0;Gu<Go;Gu++)Gc[Gt+Gu]=Gr[Gs+Gu];for(Gu=Go;Gu<Gq;Gu++)Gc[Gt+Gu+2]=Gr[Gs+Gu]}}else Gl=Gf.vertexStride/4,Gc=this._vertexCount?Ge.getData().slice(this._vertexStart*Gl,(this._vertexStart+this._vertexCount)*Gl):Ge.getData().slice();if(Ga){var Gv=Ga.worldMatrix,Gw=GE._tempMatrix4x40;Gv.invert(Gw);var Gx=GE._tempMatrix4x41,Gy=Gb.transform.worldMatrix;Gab.multiply(Gw,Gy,Gx)}else Gx=Gb.transform.worldMatrix;var Gz=GE._tempQuaternion0;for(Gx.decomposeTransRotScale(GE._tempVector30,Gz,GE._tempVector31),Gj=0,Gk=Gc.length/Gl;Gj<Gk;Gj++){var GA=Gj*Gl+Gg,GB=Gj*Gl+Gh;if(Gsb.transformVector3ArrayToVector3ArrayCoordinate(Gc,GA,Gx,Gc,GA),Gsb.transformVector3ArrayByQuat(Gc,GB,Gz,Gc,GB),Gi){var GC=Gj*Gl+Go;if(Gd)Gsb.transformLightingMapTexcoordByUV1Array(Gc,GC,Gi,Gc,GC);else{var GD=Gj*Gq+Gp;Gsb.transformLightingMapTexcoordByUV0Array(Gr,GD,Gi,Gc,GC)}}}return Gc},Ga._getVertexBuffers=function(){return null},Ga._beforeRender=function(Ga){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Ga._render=function(Ga){var Gb,Gc=0,Gd=Ga.renderElement;if(1<this._indexCount){var Ge=this._boneIndicesList.length;if(1<Ge){for(var Gf=0;Gf<Ge;Gf++)(Gb=Gd._skinAnimationDatas||this._skinAnimationDatas)&&(Gd._shaderValue.setValue(0,Gb[Gf]),Ga._shader.uploadRenderElementUniforms(Gd._shaderValue.data)),GF.mainContext.drawElements(4,this._subIndexBufferCount[Gf],5123,2*this._subIndexBufferStart[Gf]);GA.drawCall+=Ge}else(Gb=Gd._skinAnimationDatas||this._skinAnimationDatas)&&(Gd._shaderValue.setValue(0,Gb[0]),Ga._shader.uploadRenderElementUniforms(Gd._shaderValue.data)),GF.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),GA.drawCall++;Gc=this._indexCount}else Gc=this._indexBuffer.indexCount,(Gb=Gd._skinAnimationDatas||this._skinAnimationDatas)&&(Gd._shaderValue.setValue(0,Gb[0]),Ga._shader.uploadRenderElementUniforms(Gd._shaderValue.data)),GF.mainContext.drawElements(4,Gc,5123,0),GA.drawCall++;GA.trianglesFaces+=Gc/3},Ga.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},Ga.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},Gq(0,Ga,"_vertexBufferCount",function(){return 1}),Gq(0,Ga,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Gl(GE,["_tempVector30",function(){return this._tempVector30=new Ggb},"_tempVector31",function(){return this._tempVector31=new Ggb},"_tempQuaternion0",function(){return this._tempQuaternion0=new Gcb},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new Gab},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new Gab}]),GE}(),Gkb=function(){function Ga(Ga){this.defineCounter=0,this.defines=null,Ga?(this.defineCounter=Ga.defineCounter,this.defines=Ga.defines.slice()):(this.defineCounter=0,this.defines=[])}return Gp(Ga,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),Ga.prototype.registerDefine=function(Ga){var Gb=Math.pow(2,this.defineCounter++);return this.defines[Gb]=Ga,Gb},Ga}(),Glb=function(){function Ga(){}return Gp(Ga,"laya.d3.shader.ShaderInit3D"),Ga.__init__=function(){var Ga,Gb;GAb._globalRegDefine("HIGHPRECISION",GAb.SHADERDEFINE_HIGHPRECISION),GAb._globalRegDefine("FOG",GAb.SHADERDEFINE_FOG),GAb._globalRegDefine("DIRECTIONLIGHT",GAb.SHADERDEFINE_DIRECTIONLIGHT),GAb._globalRegDefine("POINTLIGHT",GAb.SHADERDEFINE_POINTLIGHT),GAb._globalRegDefine("SPOTLIGHT",GAb.SHADERDEFINE_SPOTLIGHT),GAb._globalRegDefine("UV",GAb.SHADERDEFINE_UV0),GAb._globalRegDefine("COLOR",GAb.SHADERDEFINE_COLOR),GAb._globalRegDefine("UV1",GAb.SHADERDEFINE_UV1),GAb._globalRegDefine("CASTSHADOW",Gpb.SHADERDEFINE_CAST_SHADOW),GAb._globalRegDefine("SHADOWMAP_PSSM1",Gpb.SHADERDEFINE_SHADOW_PSSM1),GAb._globalRegDefine("SHADOWMAP_PSSM2",Gpb.SHADERDEFINE_SHADOW_PSSM2),GAb._globalRegDefine("SHADOWMAP_PSSM3",Gpb.SHADERDEFINE_SHADOW_PSSM3),GAb._globalRegDefine("SHADOWMAP_PCF_NO",Gpb.SHADERDEFINE_SHADOW_PCF_NO),GAb._globalRegDefine("SHADOWMAP_PCF1",Gpb.SHADERDEFINE_SHADOW_PCF1),GAb._globalRegDefine("SHADOWMAP_PCF2",Gpb.SHADERDEFINE_SHADOW_PCF2),GAb._globalRegDefine("SHADOWMAP_PCF3",Gpb.SHADERDEFINE_SHADOW_PCF3),GAb._globalRegDefine("DEPTHFOG",GAb.SAHDERDEFINE_DEPTHFOG),GLb.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),GLb.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),Ga={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},Gb={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var Gc=GLb.nameKey.add("SIMPLE");shaderCompile=GAb.add(Gc,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',Ga,Gb),GMb.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),GMb.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),GMb.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),GMb.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),GMb.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),GMb.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),GMb.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),GMb.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),GMb.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},Ga}(),Gob=function(){function Ga(){this._data=null,this._data=[]}Gp(Ga,"laya.d3.shader.ValusArray");var Gb=Ga.prototype;return Gb.setValue=function(Ga,Gb){this._data[Ga]=Gb},Gq(0,Gb,"data",function(){return this._data}),Ga}(),Gpb=function(){function Ga(){}return Ga.SHADERDEFINE_RECEIVE_SHADOW=1,Ga.SHADERDEFINE_CAST_SHADOW=512,Ga.SHADERDEFINE_SHADOW_PSSM1=1024,Ga.SHADERDEFINE_SHADOW_PSSM2=2048,Ga.SHADERDEFINE_SHADOW_PSSM3=4096,Ga.SHADERDEFINE_SHADOW_PCF_NO=8192,Ga.SHADERDEFINE_SHADOW_PCF1=16384,Ga.SHADERDEFINE_SHADOW_PCF2=32768,Ga.SHADERDEFINE_SHADOW_PCF3=65536,Ga.MAX_PSSM_COUNT=3,Ga}(),Gqb=function(){function GX(){}return Gp(GX,"laya.d3.utils.Picker"),GX.calculateCursorRay=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=Ga.elements[0],Gh=Ga.elements[1],Gi=GX._tempVector30,Gj=Gi.elements;Gj[0]=Gg,Gj[1]=Gh,Gj[2]=Gb.minDepth;var Gk=GX._tempVector31,Gl=Gk.elements;Gl[0]=Gg,Gl[1]=Gh,Gl[2]=Gb.maxDepth;var Go=Gf.origin,Gp=GX._tempVector32;Gb.unprojectFromWVP(Gi,Gc,Gd,Ge,Go),Gb.unprojectFromWVP(Gk,Gc,Gd,Ge,Gp);var Gq=Gf.direction.elements;Gq[0]=Gp.x-Go.x,Gq[1]=Gp.y-Go.y,Gq[2]=Gp.z-Go.z,Ggb.normalize(Gf.direction,Gf.direction)},GX.rayIntersectsPositionsAndIndices=function(Ga,Gb,Gc,Gd,Ge){for(var Gf=Gc.vertexStride/4,Gg=Gc.getVertexElementByUsage(0).offset/4,Gh=Number.MAX_VALUE,Gi=-1,Gj=-1,Gk=-1,Gl=0;Gl<Gd.length;Gl+=3){var Go=GX._tempVector35,Gp=Go.elements,Gq=Gd[Gl]*Gf,Gr=Gq+Gg;Gp[0]=Gb[Gr],Gp[1]=Gb[1+Gr],Gp[2]=Gb[2+Gr];var Gs=GX._tempVector36,Gt=Gs.elements,Gu=Gd[Gl+1]*Gf,Gv=Gu+Gg;Gt[0]=Gb[Gv],Gt[1]=Gb[1+Gv],Gt[2]=Gb[2+Gv];var Gw=GX._tempVector37,Gx=Gw.elements,Gy=Gd[Gl+2]*Gf,Gz=Gy+Gg;Gx[0]=Gb[Gz],Gx[1]=Gb[1+Gz],Gx[2]=Gb[2+Gz];var GA=laya.d3.utils.Picker.rayIntersectsTriangle(Ga,Go,Gs,Gw);!isNaN(GA)&&GA<Gh&&(Gh=GA,Gi=Gq,Gj=Gu,Gk=Gy)}if(Gh===Number.MAX_VALUE)return Ge.position.toDefault(),Ge.distance=Number.MAX_VALUE,Ge.trianglePositions[0].toDefault(),Ge.trianglePositions[1].toDefault(),Ge.trianglePositions[2].toDefault(),Ge.triangleNormals[0].toDefault(),Ge.triangleNormals[1].toDefault(),Ge.triangleNormals[2].toDefault(),!1;Ge.distance=Gh,Ggb.scale(Ga.direction,Gh,Ge.position),Ggb.add(Ga.origin,Ge.position,Ge.position);var GB=Ge.trianglePositions,GC=GB[0],GD=GB[1],GE=GB[2],GF=GC.elements,GG=GD.elements,GH=GE.elements,GI=Gi+Gg;GF[0]=Gb[GI],GF[1]=Gb[GI+1],GF[2]=Gb[GI+2];var GJ=Gj+Gg;GG[0]=Gb[GJ],GG[1]=Gb[GJ+1],GG[2]=Gb[GJ+2];var GK=Gk+Gg;GH[0]=Gb[GK],GH[1]=Gb[GK+1],GH[2]=Gb[GK+2];var GL=Gc.getVertexElementByUsage(3);if(GL){var GM=GL.offset/4,GN=Ge.triangleNormals,GO=GN[0],GP=GN[1],GQ=GN[2],GR=GO.elements,GS=GP.elements,GT=GQ.elements,GU=Gi+GM;GR[0]=Gb[GU],GR[1]=Gb[GU+1],GR[2]=Gb[GU+2];var GV=Gj+GM;GS[0]=Gb[GV],GS[1]=Gb[GV+1],GS[2]=Gb[GV+2];var GW=Gk+GM;GT[0]=Gb[GW],GT[1]=Gb[GW+1],GT[2]=Gb[GW+2]}return!0},GX.rayIntersectsTriangle=function(Ga,Gb,Gc,Gd){var Ge=GX._tempVector30,Gf=GX._tempVector31;Ggb.subtract(Gc,Gb,Ge),Ggb.subtract(Gd,Gb,Gf);var Gg,Gh=GX._tempVector32;if(Ggb.cross(Ga.direction,Gf,Gh),(Gg=Ggb.dot(Ge,Gh))>-Number.MIN_VALUE&&Gg<Number.MIN_VALUE)return Number.NaN;var Gi,Gj=1/Gg,Gk=GX._tempVector33;if(Ggb.subtract(Ga.origin,Gb,Gk),Gi=Ggb.dot(Gk,Gh),(Gi*=Gj)<0||1<Gi)return Number.NaN;var Gl,Go,Gp=GX._tempVector34;return Ggb.cross(Gk,Ge,Gp),Gl=Ggb.dot(Ga.direction,Gp),(Gl*=Gj)<0||1<Gi+Gl?Number.NaN:(Go=Ggb.dot(Gf,Gp),(Go*=Gj)<0?Number.NaN:Go)},Gl(GX,["_tempVector30",function(){return this._tempVector30=new Ggb},"_tempVector31",function(){return this._tempVector31=new Ggb},"_tempVector32",function(){return this._tempVector32=new Ggb},"_tempVector33",function(){return this._tempVector33=new Ggb},"_tempVector34",function(){return this._tempVector34=new Ggb},"_tempVector35",function(){return this._tempVector35=new Ggb},"_tempVector36",function(){return this._tempVector36=new Ggb},"_tempVector37",function(){return this._tempVector37=new Ggb}]),GX}(),Grb=(function(){function Ga(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new Ggb,new Ggb,new Ggb],this.trianglePositions.length=3,this.triangleNormals=[new Ggb,new Ggb,new Ggb],this.triangleNormals.length=3,this.position=new Ggb}Gp(Ga,"laya.d3.utils.RaycastHit"),Ga.prototype.cloneTo=function(Ga){Ga.distance=this.distance,this.trianglePositions[0].cloneTo(Ga.trianglePositions[0]),this.trianglePositions[1].cloneTo(Ga.trianglePositions[1]),this.trianglePositions[2].cloneTo(Ga.trianglePositions[2]),this.triangleNormals[0].cloneTo(Ga.triangleNormals[0]),this.triangleNormals[1].cloneTo(Ga.triangleNormals[1]),this.triangleNormals[2].cloneTo(Ga.triangleNormals[2]),this.position.cloneTo(Ga.position),Ga.sprite3D=this.sprite3D}}(),function(){function Ga(Ga,Gb){this._width=0,this._height=0,this._width=Ga,this._height=Gb}Gp(Ga,"laya.d3.utils.Size");var Gb=Ga.prototype;return Gq(0,Gb,"width",function(){return-1===this._width?GY.clientWidth:this._width}),Gq(0,Gb,"height",function(){return-1===this._height?GY.clientHeight:this._height}),Gq(1,Ga,"fullScreen",function(){return new Ga(-1,-1)}),Ga}()),Gsb=function(){function GI(){}return Gp(GI,"laya.d3.utils.Utils3D"),GI._rotationTransformScaleSkinAnimation=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Gl){var Go,Gp,Gq,Gr,Gs,Gt=GI._tempArray16_0,Gu=GI._tempArray16_1,Gv=GI._tempArray16_2,Gw=Gd+Gd,Gx=Ge+Ge,Gy=Gf+Gf,Gz=Gd*Gw,GA=Ge*Gw,GB=Ge*Gx,GC=Gf*Gw,GD=Gf*Gx,GE=Gf*Gy,GF=Gg*Gw,GG=Gg*Gx,GH=Gg*Gy;for(Gt[15]=1,Gt[0]=1-GB-GE,Gt[1]=GA+GH,Gt[2]=GC-GG,Gt[4]=GA-GH,Gt[5]=1-Gz-GE,Gt[6]=GD+GF,Gt[8]=GC+GG,Gt[9]=GD-GF,Gt[10]=1-Gz-GB,Gu[15]=1,Gu[0]=Gh,Gu[5]=Gi,Gu[10]=Gj,Go=0;Go<4;Go++)Gp=Gt[Go],Gq=Gt[Go+4],Gr=Gt[Go+8],Gs=Gt[Go+12],Gv[Go]=Gp,Gv[Go+4]=Gq,Gv[Go+8]=Gr,Gv[Go+12]=Gp*Ga+Gq*Gb+Gr*Gc+Gs;for(Go=0;Go<4;Go++)Gp=Gv[Go],Gq=Gv[Go+4],Gr=Gv[Go+8],Gs=Gv[Go+12],Gk[Go+Gl]=Gp*Gu[0]+Gq*Gu[1]+Gr*Gu[2]+Gs*Gu[3],Gk[Go+Gl+4]=Gp*Gu[4]+Gq*Gu[5]+Gr*Gu[6]+Gs*Gu[7],Gk[Go+Gl+8]=Gp*Gu[8]+Gq*Gu[9]+Gr*Gu[10]+Gs*Gu[11],Gk[Go+Gl+12]=Gp*Gu[12]+Gq*Gu[13]+Gr*Gu[14]+Gs*Gu[15]},GI._createNodeByJson=function(Ga,Gb,Gc,Gd){if(!Gc)switch(Gb.type){case"Sprite3D":Gc=new GKb;break;case"MeshSprite3D":Gc=new GXb;break;case"SkinnedMeshSprite3D":Gc=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":Gc=new ShuriKenParticle3D;break;case"TrailSprite3D":Gc=new TrailSprite3D;break;case"Terrain":Gc=new Terrain;break;case"Camera":Gc=new GWb;break;case"DirectionLight":Gc=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var Ge=Gb.props;if(Ge)for(var Gf in Ge)Gc[Gf]=Ge[Gf];var Gg=Gb.customProps;Gg&&(Gc instanceof laya.d3.core.Sprite3D?(Gc._parseBaseCustomProps(Gg),Gc._parseCustomProps(Ga,Gd,Gg,Gb),Gc._parseCustomComponent(Ga,Gd,Gb.components)):Gc._parseCustomProps(Ga,Gd,Gg,Gb));var Gh=Gb.child;if(Gh)for(var Gi=0,Gj=Gh.length;Gi<Gj;Gi++){var Gk=GI._createNodeByJson(Ga,Gh[Gi],null,Gd);Gc.addChild(Gk)}return Gc},GI._computeBoneAndAnimationDatasByBindPoseMatrxix=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg,Gh,Gi=0,Gj=0,Gk=Ga.length;for(Gg=0;Gg<Gk;Gi+=Ga[Gg].keyframeWidth,Gj+=16,Gg++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(Gb[Gi+0],Gb[Gi+1],Gb[Gi+2],Gb[Gi+3],Gb[Gi+4],Gb[Gi+5],Gb[Gi+6],Gb[Gi+7],Gb[Gi+8],Gb[Gi+9],Gd,Gj),0!=Gg&&(Gh=16*Ga[Gg].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(Gd,Gh,Gd,Gj,Gd,Gj));var Gl=Gc.length;for(Gg=0;Gg<Gl;Gg++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Gd,16*Gf[Gg],Gc[Gg],Ge,16*Gg)},GI._computeAnimationDatasByArrayAndMatrixFast=function(Ga,Gb,Gc,Gd){for(var Ge=0,Gf=Ga.length;Ge<Gf;Ge++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Gb,16*Gd[Ge],Ga[Ge],Gc,16*Ge)},GI._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(Ga,Gb,Gc,Gd,Ge){var Gf,Gg,Gh=0,Gi=0,Gj=Ga.length;for(Gf=0;Gf<Gj;Gh+=Ga[Gf].keyframeWidth,Gi+=16,Gf++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(Gb[Gh+7],Gb[Gh+8],Gb[Gh+9],Gb[Gh+3],Gb[Gh+4],Gb[Gh+5],Gb[Gh+6],Gb[Gh+0],Gb[Gh+1],Gb[Gh+2],Gd,Gi),0!=Gf&&(Gg=16*Ga[Gf].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(Gd,Gg,Gd,Gi,Gd,Gi));var Gk=Gc.length;for(Gf=0;Gf<Gk;Gf++){var Gl=16*Gf;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Gd,Gl,Gc[Gf],Ge,Gl)}},GI._computeAnimationDatasByArrayAndMatrixFastOld=function(Ga,Gb,Gc){for(var Gd=Ga.length,Ge=0;Ge<Gd;Ge++){var Gf=16*Ge;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(Gb,Gf,Ga[Ge],Gc,Gf)}},GI._computeRootAnimationData=function(Ga,Gb,Gc){for(var Gd=0,Ge=0,Gf=0,Gg=Ga.length;Gd<Gg;Ge+=Ga[Gd].keyframeWidth,Gf+=16,Gd++)laya.d3.utils.Utils3D.createAffineTransformationArray(Gb[Ge+0],Gb[Ge+1],Gb[Ge+2],Gb[Ge+3],Gb[Ge+4],Gb[Ge+5],Gb[Ge+6],Gb[Ge+7],Gb[Ge+8],Gb[Ge+9],Gc,Gf)},GI.transformVector3ArrayByQuat=function(Ga,Gb,Gc,Gd,Ge){var Gf=Gc.elements,Gg=Ga[Gb],Gh=Ga[Gb+1],Gi=Ga[Gb+2],Gj=Gf[0],Gk=Gf[1],Gl=Gf[2],Go=Gf[3],Gp=Go*Gg+Gk*Gi-Gl*Gh,Gq=Go*Gh+Gl*Gg-Gj*Gi,Gr=Go*Gi+Gj*Gh-Gk*Gg,Gs=-Gj*Gg-Gk*Gh-Gl*Gi;Gd[Ge]=Gp*Go+Gs*-Gj+Gq*-Gl-Gr*-Gk,Gd[Ge+1]=Gq*Go+Gs*-Gk+Gr*-Gj-Gp*-Gl,Gd[Ge+2]=Gr*Go+Gs*-Gl+Gp*-Gk-Gq*-Gj},GI.mulMatrixByArray=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg,Gh,Gi,Gj,Gk;if(Ge===Gc){for(Gc=GI._tempArray16_3,Gg=0;Gg<16;++Gg)Gc[Gg]=Ge[Gf+Gg];Gd=0}for(Gg=0;Gg<4;Gg++)Gh=Ga[Gb+Gg],Gi=Ga[Gb+Gg+4],Gj=Ga[Gb+Gg+8],Gk=Ga[Gb+Gg+12],Ge[Gf+Gg]=Gh*Gc[Gd+0]+Gi*Gc[Gd+1]+Gj*Gc[Gd+2]+Gk*Gc[Gd+3],Ge[Gf+Gg+4]=Gh*Gc[Gd+4]+Gi*Gc[Gd+5]+Gj*Gc[Gd+6]+Gk*Gc[Gd+7],Ge[Gf+Gg+8]=Gh*Gc[Gd+8]+Gi*Gc[Gd+9]+Gj*Gc[Gd+10]+Gk*Gc[Gd+11],Ge[Gf+Gg+12]=Gh*Gc[Gd+12]+Gi*Gc[Gd+13]+Gj*Gc[Gd+14]+Gk*Gc[Gd+15]},GI.mulMatrixByArrayFast=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg,Gh,Gi,Gj,Gk;for(Gg=0;Gg<4;Gg++)Gh=Ga[Gb+Gg],Gi=Ga[Gb+Gg+4],Gj=Ga[Gb+Gg+8],Gk=Ga[Gb+Gg+12],Ge[Gf+Gg]=Gh*Gc[Gd+0]+Gi*Gc[Gd+1]+Gj*Gc[Gd+2]+Gk*Gc[Gd+3],Ge[Gf+Gg+4]=Gh*Gc[Gd+4]+Gi*Gc[Gd+5]+Gj*Gc[Gd+6]+Gk*Gc[Gd+7],Ge[Gf+Gg+8]=Gh*Gc[Gd+8]+Gi*Gc[Gd+9]+Gj*Gc[Gd+10]+Gk*Gc[Gd+11],Ge[Gf+Gg+12]=Gh*Gc[Gd+12]+Gi*Gc[Gd+13]+Gj*Gc[Gd+14]+Gk*Gc[Gd+15]},GI.mulMatrixByArrayAndMatrixFast=function(Ga,Gb,Gc,Gd,Ge){var Gf,Gg,Gh,Gi,Gj,Gk=Gc.elements,Gl=Gk[0],Go=Gk[1],Gp=Gk[2],Gq=Gk[3],Gr=Gk[4],Gs=Gk[5],Gt=Gk[6],Gu=Gk[7],Gv=Gk[8],Gw=Gk[9],Gx=Gk[10],Gy=Gk[11],Gz=Gk[12],GA=Gk[13],GB=Gk[14],GC=Gk[15],GD=Gb,GE=Gb+4,GF=Gb+8,GG=Gb+12,GH=Ge,GI=Ge+4,GJ=Ge+8,GK=Ge+12;for(Gf=0;Gf<4;Gf++)Gg=Ga[GD+Gf],Gh=Ga[GE+Gf],Gi=Ga[GF+Gf],Gj=Ga[GG+Gf],Gd[GH+Gf]=Gg*Gl+Gh*Go+Gi*Gp+Gj*Gq,Gd[GI+Gf]=Gg*Gr+Gh*Gs+Gi*Gt+Gj*Gu,Gd[GJ+Gf]=Gg*Gv+Gh*Gw+Gi*Gx+Gj*Gy,Gd[GK+Gf]=Gg*Gz+Gh*GA+Gi*GB+Gj*GC},GI.createAffineTransformationArray=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Gl){var Go=Gd+Gd,Gp=Ge+Ge,Gq=Gf+Gf,Gr=Gd*Go,Gs=Gd*Gp,Gt=Gd*Gq,Gu=Ge*Gp,Gv=Ge*Gq,Gw=Gf*Gq,Gx=Gg*Go,Gy=Gg*Gp,Gz=Gg*Gq;Gk[Gl+0]=(1-(Gu+Gw))*Gh,Gk[Gl+1]=(Gs+Gz)*Gh,Gk[Gl+2]=(Gt-Gy)*Gh,Gk[Gl+3]=0,Gk[Gl+4]=(Gs-Gz)*Gi,Gk[Gl+5]=(1-(Gr+Gw))*Gi,Gk[Gl+6]=(Gv+Gx)*Gi,Gk[Gl+7]=0,Gk[Gl+8]=(Gt+Gy)*Gj,Gk[Gl+9]=(Gv-Gx)*Gj,Gk[Gl+10]=(1-(Gr+Gu))*Gj,Gk[Gl+11]=0,Gk[Gl+12]=Ga,Gk[Gl+13]=Gb,Gk[Gl+14]=Gc,Gk[Gl+15]=1},GI.transformVector3ArrayToVector3ArrayCoordinate=function(Ga,Gb,Gc,Gd,Ge){var Gf=GI._tempArray4_0,Gg=Ga[Gb+0],Gh=Ga[Gb+1],Gi=Ga[Gb+2],Gj=Gc.elements;Gf[0]=Gg*Gj[0]+Gh*Gj[4]+Gi*Gj[8]+Gj[12],Gf[1]=Gg*Gj[1]+Gh*Gj[5]+Gi*Gj[9]+Gj[13],Gf[2]=Gg*Gj[2]+Gh*Gj[6]+Gi*Gj[10]+Gj[14],Gf[3]=1/(Gg*Gj[3]+Gh*Gj[7]+Gi*Gj[11]+Gj[15]),Gd[Ge+0]=Gf[0]*Gf[3],Gd[Ge+1]=Gf[1]*Gf[3],Gd[Ge+2]=Gf[2]*Gf[3]},GI.transformLightingMapTexcoordByUV0Array=function(Ga,Gb,Gc,Gd,Ge){var Gf=Gc.elements;Gd[Ge+0]=Ga[Gb+0]*Gf[0]+Gf[2],Gd[Ge+1]=(Ga[Gb+1]-1)*Gf[1]+Gf[3]},GI.transformLightingMapTexcoordByUV1Array=function(Ga,Gb,Gc,Gd,Ge){var Gf=Gc.elements;Gd[Ge+0]=Ga[Gb+0]*Gf[0]+Gf[2],Gd[Ge+1]=1+Ga[Gb+1]*Gf[1]+Gf[3]},GI.getURLVerion=function(Ga){var Gb=Ga.indexOf("?");return 0<=Gb?Ga.substr(Gb):null},GI._quaternionCreateFromYawPitchRollArray=function(Ga,Gb,Gc,Gd){var Ge=.5*Gc,Gf=.5*Gb,Gg=.5*Ga,Gh=Math.sin(Ge),Gi=Math.cos(Ge),Gj=Math.sin(Gf),Gk=Math.cos(Gf),Gl=Math.sin(Gg),Go=Math.cos(Gg);Gd[0]=Go*Gj*Gi+Gl*Gk*Gh,Gd[1]=Gl*Gk*Gi-Go*Gj*Gh,Gd[2]=Go*Gk*Gh-Gl*Gj*Gi,Gd[3]=Go*Gk*Gi+Gl*Gj*Gh},GI._createAffineTransformationArray=function(Ga,Gb,Gc,Gd){var Ge=Gb[0],Gf=Gb[1],Gg=Gb[2],Gh=Gb[3],Gi=Ge+Ge,Gj=Gf+Gf,Gk=Gg+Gg,Gl=Ge*Gi,Go=Ge*Gj,Gp=Ge*Gk,Gq=Gf*Gj,Gr=Gf*Gk,Gs=Gg*Gk,Gt=Gh*Gi,Gu=Gh*Gj,Gv=Gh*Gk,Gw=Gc[0],Gx=Gc[1],Gy=Gc[2];Gd[0]=(1-(Gq+Gs))*Gw,Gd[1]=(Go+Gv)*Gw,Gd[2]=(Gp-Gu)*Gw,Gd[3]=0,Gd[4]=(Go-Gv)*Gx,Gd[5]=(1-(Gl+Gs))*Gx,Gd[6]=(Gr+Gt)*Gx,Gd[7]=0,Gd[8]=(Gp+Gu)*Gy,Gd[9]=(Gr-Gt)*Gy,Gd[10]=(1-(Gl+Gq))*Gy,Gd[11]=0,Gd[12]=Ga[0],Gd[13]=Ga[1],Gd[14]=Ga[2],Gd[15]=1},GI._mulMatrixArray=function(Ga,Gb,Gc,Gd){var Ge,Gf,Gg,Gh,Gi,Gj=Gb.elements,Gk=Gj[0],Gl=Gj[1],Go=Gj[2],Gp=Gj[3],Gq=Gj[4],Gr=Gj[5],Gs=Gj[6],Gt=Gj[7],Gu=Gj[8],Gv=Gj[9],Gw=Gj[10],Gx=Gj[11],Gy=Gj[12],Gz=Gj[13],GA=Gj[14],GB=Gj[15],GC=Gd,GD=Gd+4,GE=Gd+8,GF=Gd+12;for(Ge=0;Ge<4;Ge++)Gf=Ga[Ge],Gg=Ga[Ge+4],Gh=Ga[Ge+8],Gi=Ga[Ge+12],Gc[GC+Ge]=Gf*Gk+Gg*Gl+Gh*Go+Gi*Gp,Gc[GD+Ge]=Gf*Gq+Gg*Gr+Gh*Gs+Gi*Gt,Gc[GE+Ge]=Gf*Gu+Gg*Gv+Gh*Gw+Gi*Gx,Gc[GF+Ge]=Gf*Gy+Gg*Gz+Gh*GA+Gi*GB},GI.getYawPitchRoll=function(Ga,Gb){GI.transformQuat(Ggb.ForwardRH,Ga,Gcb.TEMPVector31),GI.transformQuat(Ggb.Up,Ga,Gcb.TEMPVector32);var Gc=Gcb.TEMPVector32.elements;GI.angleTo(Ggb.ZERO,Gcb.TEMPVector31,Gcb.TEMPVector33);var Gd=Gcb.TEMPVector33.elements;Gd[0]==Math.PI/2?(Gd[1]=GI.arcTanAngle(Gc[2],Gc[0]),Gd[2]=0):Gd[0]==-Math.PI/2?(Gd[1]=GI.arcTanAngle(-Gc[2],-Gc[0]),Gd[2]=0):(Gab.createRotationY(-Gd[1],Gcb.TEMPMatrix0),Gab.createRotationX(-Gd[0],Gcb.TEMPMatrix1),Ggb.transformCoordinate(Gcb.TEMPVector32,Gcb.TEMPMatrix0,Gcb.TEMPVector32),Ggb.transformCoordinate(Gcb.TEMPVector32,Gcb.TEMPMatrix1,Gcb.TEMPVector32),Gd[2]=GI.arcTanAngle(Gc[1],-Gc[0])),Gd[1]<=-Math.PI&&(Gd[1]=Math.PI),Gd[2]<=-Math.PI&&(Gd[2]=Math.PI),Gd[1]>=Math.PI&&Gd[2]>=Math.PI&&(Gd[1]=0,Gd[2]=0,Gd[0]=Math.PI-Gd[0]),Gb[0]=Gd[1],Gb[1]=Gd[0],Gb[2]=Gd[2]},GI.arcTanAngle=function(Ga,Gb){return 0==Ga?1==Gb?Math.PI/2:-Math.PI/2:0<Ga?Math.atan(Gb/Ga):Ga<0?0<Gb?Math.atan(Gb/Ga)+Math.PI:Math.atan(Gb/Ga)-Math.PI:0},GI.angleTo=function(Ga,Gb,Gc){Ggb.subtract(Gb,Ga,Gcb.TEMPVector30),Ggb.normalize(Gcb.TEMPVector30,Gcb.TEMPVector30),Gc.elements[0]=Math.asin(Gcb.TEMPVector30.y),Gc.elements[1]=GI.arcTanAngle(-Gcb.TEMPVector30.z,-Gcb.TEMPVector30.x)},GI.transformQuat=function(Ga,Gb,Gc){var Gd=Gc.elements,Ge=Ga.elements,Gf=Gb,Gg=Ge[0],Gh=Ge[1],Gi=Ge[2],Gj=Gf[0],Gk=Gf[1],Gl=Gf[2],Go=Gf[3],Gp=Go*Gg+Gk*Gi-Gl*Gh,Gq=Go*Gh+Gl*Gg-Gj*Gi,Gr=Go*Gi+Gj*Gh-Gk*Gg,Gs=-Gj*Gg-Gk*Gh-Gl*Gi;Gd[0]=Gp*Go+Gs*-Gj+Gq*-Gl-Gr*-Gk,Gd[1]=Gq*Go+Gs*-Gk+Gr*-Gj-Gp*-Gl,Gd[2]=Gr*Go+Gs*-Gl+Gp*-Gk-Gq*-Gj},GI.quaterionNormalize=function(Ga,Gb){var Gc=Ga[0],Gd=Ga[1],Ge=Ga[2],Gf=Ga[3],Gg=Gc*Gc+Gd*Gd+Ge*Ge+Gf*Gf;0<Gg&&(Gg=1/Math.sqrt(Gg),Gb[0]=Gc*Gg,Gb[1]=Gd*Gg,Gb[2]=Ge*Gg,Gb[3]=Gf*Gg)},GI.matrix4x4MultiplyFFF=function(Ga,Gb,Gc){var Gd,Ge,Gf,Gg,Gh;if(Gc===Gb)for(Gb=new Float32Array(16),Gd=0;Gd<16;++Gd)Gb[Gd]=Gc[Gd];for(Gd=0;Gd<4;Gd++)Ge=Ga[Gd],Gf=Ga[Gd+4],Gg=Ga[Gd+8],Gh=Ga[Gd+12],Gc[Gd]=Ge*Gb[0]+Gf*Gb[1]+Gg*Gb[2]+Gh*Gb[3],Gc[Gd+4]=Ge*Gb[4]+Gf*Gb[5]+Gg*Gb[6]+Gh*Gb[7],Gc[Gd+8]=Ge*Gb[8]+Gf*Gb[9]+Gg*Gb[10]+Gh*Gb[11],Gc[Gd+12]=Ge*Gb[12]+Gf*Gb[13]+Gg*Gb[14]+Gh*Gb[15]},GI.matrix4x4MultiplyMFM=function(Ga,Gb,Gc){GI.matrix4x4MultiplyFFF(Ga.elements,Gb,Gc.elements)},Gl(GI,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new Ggb},"_tempVector3_1",function(){return this._tempVector3_1=new Ggb},"_tempVector3_2",function(){return this._tempVector3_2=new Ggb},"_tempVector3_3",function(){return this._tempVector3_3=new Ggb},"_tempVector3_4",function(){return this._tempVector3_4=new Ggb},"_tempVector3_5",function(){return this._tempVector3_5=new Ggb},"_tempVector3_6",function(){return this._tempVector3_6=new Ggb},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),GI}(),Gtb=function(){function GG(){}return Gp(GG,"Laya3D"),GG._cancelLoadByUrl=function(Ga){Gx.loader.cancelLoadByUrl(Ga),GG._innerFirstLevelLoaderManager.cancelLoadByUrl(Ga),GG._innerSecondLevelLoaderManager.cancelLoadByUrl(Ga),GG._innerThirdLevelLoaderManager.cancelLoadByUrl(Ga),GG._innerFourthLevelLoaderManager.cancelLoadByUrl(Ga)},GG._changeWebGLSize=function(Ga,Gb){GF.onStageResize(Ga,Gb),GY.clientWidth=Ga,GY.clientHeight=Gb},GG.__init__=function(){var Ga=Gb.createMap;Ga.lh=[GKb,"SPRITE3DHIERARCHY"],Ga.ls=[GJb,"SPRITE3DHIERARCHY"],Ga.lm=[GRb,"MESH"],Ga.lmat=[GMb,"MATERIAL"],Ga.jpg=[GTb,"nativeimage"],Ga.jpeg=[GTb,"nativeimage"],Ga.png=[GTb,"nativeimage"],Ga.pkm=[GTb,"arraybuffer"],Ga.raw=[GPb,"arraybuffer"],Ga.mipmaps=[GPb,"arraybuffer"],Gt.parserMap.SPRITE3DHIERARCHY=GG._loadHierarchy,Gt.parserMap.MESH=GG._loadMesh,Gt.parserMap.MATERIAL=GG._loadMaterial,Gt.parserMap.TEXTURECUBE=GG._loadTextureCube,Gt.parserMap.TERRAIN=GG._loadTerrain,GG._innerFirstLevelLoaderManager.on("error",null,GG._eventLoadManagerError),GG._innerSecondLevelLoaderManager.on("error",null,GG._eventLoadManagerError),GG._innerThirdLevelLoaderManager.on("error",null,GG._eventLoadManagerError),GG._innerFourthLevelLoaderManager.on("error",null,GG._eventLoadManagerError)},GG.READ_BLOCK=function(){return GG._readData.pos+=4,!0},GG.READ_DATA=function(){return GG._DATA.offset=GG._readData.getUint32(),GG._DATA.size=GG._readData.getUint32(),!0},GG.READ_STRINGS=function(){var Ga=[],Gb={offset:0,size:0};Gb.offset=GG._readData.getUint16(),Gb.size=GG._readData.getUint16();GG._readData.pos;GG._readData.pos=Gb.offset+GG._DATA.offset;for(var Gc=0;Gc<Gb.size;Gc++){var Gd=GG._readData.readUTFString();-1===Gd.lastIndexOf(".lmat")&&-1===Gd.lastIndexOf(".lpbr")||Ga.push(Gd)}return Ga},GG.formatRelativePath=function(Ga,Gb){var Gc;if("."===Gb.charAt(0)){for(var Gd=(Ga+Gb).split("/"),Ge=0,Gf=Gd.length;Ge<Gf;Ge++)if(".."==Gd[Ge]){var Gg=Ge-1;0<Gg&&".."!==Gd[Gg]&&(Gd.splice(Gg,2),Ge-=2)}Gc=Gd.join("/")}else Gc=Ga+Gb;return null!=GE.customFormat&&(Gc=GE.customFormat(Gc,null)),Gc},GG._eventLoadManagerError=function(Ga){Gx.loader.event("error",Ga)},GG._addHierarchyInnerUrls=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg=GG.formatRelativePath(Gd,Ge);Gc&&(Gg+=Gc),Ga.push({url:Gg,clas:Gf}),Gb[Ge]=Gg},GG._getSprite3DHierarchyInnerUrls=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){var Gh,Gi=0,Gj=0;switch(Ga.type){case"Scene":var Gk=Ga.customProps.lightmaps;for(Gi=0,Gj=Gk.length;Gi<Gj;Gi++){var Gl=Gk[Gi].replace(".exr",".png");GG._addHierarchyInnerUrls(Gd,Ge,Gf,Gg,Gl,GTb)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var Go;if(Ga.instanceParams)(Go=Ga.instanceParams.loadPath)&&GG._addHierarchyInnerUrls(Gb,Ge,Gf,Gg,Go,GRb);else{(Go=(Gh=Ga.customProps).meshPath)&&GG._addHierarchyInnerUrls(Gb,Ge,Gf,Gg,Go,GRb);var Gp=Gh.materials;if(Gp)for(Gi=0,Gj=Gp.length;Gi<Gj;Gi++){for(var Gq=Gp[Gi],Gr=Gq.type.split("."),Gs=GH.window,Gt=0,Gu=Gr.length;Gt<Gu;++Gt){Gs=Gs[this.clasPaths[Gt]]}if("function"!=typeof Gs)throw"_getSprite3DHierarchyInnerUrls 错误: "+Gq.type+" 不是类";GG._addHierarchyInnerUrls(Gc,Ge,Gf,Gg,Gq.path,Gs)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var Gv=(Gh=Ga.customProps).meshPath;Gv&&GG._addHierarchyInnerUrls(Gb,Ge,Gf,Gg,Gv,GRb);var Gw=Gh.material;if(Gw){Gr=Gw.type.split("."),Gs=GH.window;for(Gt=0,Gu=Gr.length;Gt<Gu;++Gt){Gs=Gs[this.clasPaths[Gt]]}GG._addHierarchyInnerUrls(Gc,Ge,Gf,Gg,Gw.path,Gs)}else{var Gx=Gh.materialPath;if(Gx)GG._addHierarchyInnerUrls(Gc,Ge,Gf,Gg,Gx,ShurikenParticleMaterial);else{var Gy=Gh.texturePath;Gy&&GG._addHierarchyInnerUrls(Gd,Ge,Gf,Gg,Gy,GTb)}}break;case"Terrain":GG._addHierarchyInnerUrls(Gd,Ge,Gf,Gg,Ga.customProps.dataPath,TerrainRes)}var Gz=Ga.components;for(var GA in Gz){var GB=Gz[GA];switch(GA){case"Animator":var GC=GB.avatarPath;if(GC)GG._addHierarchyInnerUrls(Gd,Ge,Gf,Gg,GC,Avatar);else{var GD=GB.avatar;GD&&GG._addHierarchyInnerUrls(Gd,Ge,Gf,Gg,GD.path,Avatar)}var GE=GB.clipPaths;for(Gi=0,Gj=GE.length;Gi<Gj;Gi++)GG._addHierarchyInnerUrls(Gd,Ge,Gf,Gg,GE[Gi],AnimationClip)}}var GF=Ga.child;for(Gi=0,Gj=GF.length;Gi<Gj;Gi++)GG._getSprite3DHierarchyInnerUrls(GF[Gi],Gb,Gc,Gd,Ge,Gf,Gg)},GG._loadHierarchy=function(Ga){Ga.on("loaded",null,GG._onHierarchylhLoaded,[Ga,Ga._class._getGroup()]),Ga.load(Ga.url,"json",!1,null,!0)},GG._onHierarchylhLoaded=function(Ga,Gb,Gc){if(Ga._class.destroyed)Ga.endLoad();else{var Gd=Ga.url,Ge=Gsb.getURLVerion(Gd),Gf=GE.getPath(Gd),Gg=[],Gh=[],Gi=[],Gj={};GG._getSprite3DHierarchyInnerUrls(Gc,Gg,Gh,Gi,Gj,Ge,Gf);var Gk=Gg.length+Gh.length+Gi.length,Gl=Gk+1,Go=1/Gl;if(GG._onProcessChange(Ga,0,Go,1),0<Gi.length){var Gp=Gk/Gl,Gq=GD.create(null,GG._onProcessChange,[Ga,Go,Gp],!1);GG._innerFourthLevelLoaderManager.create(Gi,GD.create(null,GG._onHierarchyInnerForthLevResouLoaded,[Ga,Gb,Gq,Gc,Gj,Gg,Gh,Go+Gp*Gi.length,Gp]),Gq,null,null,1,!0,Gb)}else GG._onHierarchyInnerForthLevResouLoaded(Ga,Gb,null,Gc,Gj,Gg,Gh,Go,Gp)}},GG._onHierarchyInnerForthLevResouLoaded=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){if(Ga._class.destroyed)Ga.endLoad();else if(Gc&&Gc.recover(),0<Gg.length){var Gj=GD.create(null,GG._onProcessChange,[Ga,Gh,Gi],!1);GG._innerSecondLevelLoaderManager.create(Gg,GD.create(null,GG._onHierarchyInnerSecondLevResouLoaded,[Ga,Gb,Gj,Gd,Ge,Gf,Gh+Gi*Gg.length,Gi]),Gc,null,null,1,!0,Gb)}else GG._onHierarchyInnerSecondLevResouLoaded(Ga,Gb,null,Gd,Ge,Gf,Gh,Gi)},GG._onHierarchyInnerSecondLevResouLoaded=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh){if(Ga._class.destroyed)Ga.endLoad();else if(Gc&&Gc.recover(),0<Gf.length){var Gi=GD.create(null,GG._onProcessChange,[Ga,Gg,Gh],!1);GG._innerFirstLevelLoaderManager.create(Gf,GD.create(null,GG._onHierarchyInnerFirstLevResouLoaded,[Ga,Gi,Gd,Ge]),Gc,null,null,1,!0,Gb)}else GG._onHierarchyInnerFirstLevResouLoaded(Ga,null,Gd,Ge)},GG._onHierarchyInnerFirstLevResouLoaded=function(Ga,Gb,Gc,Gd){Gb&&Gb.recover(),Ga.endLoad([Gc,Gd])},GG._loadTerrain=function(Ga){Ga.on("loaded",null,GG._onTerrainLtLoaded,[Ga,Ga._class._getGroup()]),Ga.load(Ga.url,"json",!1,null,!0)},GG._onTerrainLtLoaded=function(Ga,Gb,Gc){if(Ga._class.destroyed)Ga.endLoad();else{var Gd,Ge,Gf=Ga.url,Gg=Gsb.getURLVerion(Gf),Gh=GE.getPath(Gf),Gi=[],Gj={},Gk=0,Gl=0,Go=Gc.heightData;Gd=Go.url,Ge=GG.formatRelativePath(Gh,Gd),Gg&&(Ge+=Gg),Gd=Gj[Gd]=Ge;var Gp=Gc.detailTexture;for(Gk=0,Gl=Gp.length;Gk<Gl;Gk++)Gi.push({url:Gp[Gk].diffuse});var Gq=Gc.normalMap;for(Gk=0,Gl=Gq.length;Gk<Gl;Gk++)Gi.push({url:Gq[Gk]});var Gr=Gc.alphaMap;for(Gk=0,Gl=Gr.length;Gk<Gl;Gk++)Gi.push({url:Gr[Gk],params:[!1,!1,6408,!0]});for(Gk=0,Gl=Gi.length;Gk<Gl;Gk++){var Gs=Gi[Gk].url;Ge=GG.formatRelativePath(Gh,Gs),Gg&&(Ge+=Gg),Gi[Gk].url=Ge,Gj[Gs]=Ge}var Gt=Gi.length,Gu=Gt+2,Gv=1/Gu;GG._onProcessChange(Ga,0,Gv,1);var Gw={heightMapLoaded:!1,texturesLoaded:!1},Gx=GD.create(null,GG._onProcessChange,[Ga,Gv,Gv],!1);GG._innerFourthLevelLoaderManager.create(Gd,GD.create(null,GG._onTerrainHeightMapLoaded,[Ga,Gx,Gc,Gj,Gw]),Gx,null,[Go.numX,Go.numZ,Go.bitType,Go.value],1,!0,Gb);var Gy=GD.create(null,GG._onProcessChange,[Ga,2*Gv,Gt/Gu],!1);GG._innerFourthLevelLoaderManager.create(Gi,GD.create(null,GG._onTerrainTexturesLoaded,[Ga,Gy,Gc,Gj,Gw]),Gy,null,null,1,!0,Gb)}},GG._onTerrainHeightMapLoaded=function(Ga,Gb,Gc,Gd,Ge){Ge.heightMapLoaded=!0,Ge.texturesLoaded&&(Ga.endLoad([Gc,Gd]),Gb.recover())},GG._onTerrainTexturesLoaded=function(Ga,Gb,Gc,Gd,Ge){Ge.texturesLoaded=!0,Ge.heightMapLoaded&&(Ga.endLoad([Gc,Gd]),Gb.recover())},GG._loadMesh=function(Ga){Ga.on("loaded",null,GG._onMeshLmLoaded,[Ga,Ga._class._getGroup()]),Ga.load(Ga.url,"arraybuffer",!1,null,!0)},GG._onMeshLmLoaded=function(Ga,Gb,Gc){if(Ga._class.destroyed)Ga.endLoad();else{var Gd,Ge,Gf,Gg=Ga.url,Gh=Gsb.getURLVerion(Gg),Gi=GE.getPath(Gg),Gj={},Gk=0,Gl=0;switch((GG._readData=new Gy(Gc)).pos=0,GG._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var Go=GG._readData.getUint32();GG._readData.pos=GG._readData.pos+4,Gl=GG._readData.getUint16(),GG._readData.pos=GG._readData.pos+8*Gl;var Gp=GG._readData.getUint32();for(Gl=GG._readData.getUint16(),GG._readData.pos=Go+Gp,Gd=[],Gk=0;Gk<Gl;Gk++){var Gq=GG._readData.readUTFString();-1!==Gq.lastIndexOf(".lmat")&&Gd.push(Gq)}break;default:for(GG.READ_BLOCK(),Gk=0;Gk<2;Gk++){var Gr=GG._readData.getUint16(),Gs=GG._strings[Gr],Gt=GG["READ_"+Gs];if(null==Gt)throw new Error("model file err,no this function:"+Gr+" "+Gs);1===Gk?Gd=Gt.call():Gt.call()}}for(Gk=0,Gf=Gd.length;Gk<Gf;Gk++){var Gu=Gd[Gk];Ge=GG.formatRelativePath(Gi,Gu),Gh&&(Ge+=Gh),Gd[Gk]=Ge,Gj[Gu]=Ge}if(0<Gd.length){GG._onProcessChange(Ga,0,.5,1);var Gv=GD.create(null,GG._onProcessChange,[Ga,.5,.5],!1);GG._innerSecondLevelLoaderManager.create(Gd,GD.create(null,GG._onMeshMateialLoaded,[Ga,Gv,Gc,Gj]),Gv,null,null,1,!0,Gb)}else Ga.endLoad([Gc,Gj])}},GG._onMeshMateialLoaded=function(Ga,Gb,Gc,Gd){Ga.endLoad([Gc,Gd]),Gb.recover()},GG._getMaterialTexturePath=function(Ga,Gb,Gc){var Gd=Ga.length-4;return Ga.indexOf(".dds")!=Gd&&Ga.indexOf(".tga")!=Gd&&Ga.indexOf(".exr")!=Gd&&Ga.indexOf(".DDS")!=Gd&&Ga.indexOf(".TGA")!=Gd&&Ga.indexOf(".EXR")!=Gd||(Ga=Ga.substr(0,Gd)+".png"),Ga=GG.formatRelativePath(Gc,Ga),Gb&&(Ga+=Gb),Ga},GG._loadMaterial=function(Ga){Ga.on("loaded",null,GG._onMaterilLmatLoaded,[Ga,Ga._class._getGroup()]),Ga.load(Ga.url,"json",!1,null,!0)},GG._onMaterilLmatLoaded=function(Ga,Gb,Gc){if(Ga._class.destroyed)Ga.endLoad();else{var Gd,Ge=Ga.url,Gf=Gsb.getURLVerion(Ge),Gg=GE.getPath(Ge),Gh=[],Gi={},Gj=Gc.customProps,Gk=Gc.version;if(Gk)switch(Gk){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var Gl=Gc.props.textures,Go=0,Gp=Gl.length;Go<Gp;Go++){var Gq=Gl[Go],Gr=Gq.path;if(Gr){var Gs=Gr.length-4;Gr.indexOf(".exr")!=Gs&&Gr.indexOf(".EXR")!=Gs||(Gr=Gr.substr(0,Gs)+".png"),Gd=GG.formatRelativePath(Gg,Gr),Gf&&(Gd+=Gf),Gh.push({url:Gd,params:Gq.params}),Gi[Gr]=Gd}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var Gt=Gj.diffuseTexture.texture2D;if(Gt&&(Gd=GG._getMaterialTexturePath(Gt,Gf,Gg),Gh.push(Gd),Gi[Gt]=Gd),Gj.normalTexture){var Gu=Gj.normalTexture.texture2D;Gu&&(Gd=GG._getMaterialTexturePath(Gu,Gf,Gg),Gh.push(Gd),Gi[Gu]=Gd)}if(Gj.specularTexture){var Gv=Gj.specularTexture.texture2D;Gv&&(Gd=GG._getMaterialTexturePath(Gv,Gf,Gg),Gh.push(Gd),Gi[Gv]=Gd)}if(Gj.emissiveTexture){var Gw=Gj.emissiveTexture.texture2D;Gw&&(Gd=GG._getMaterialTexturePath(Gw,Gf,Gg),Gh.push(Gd),Gi[Gw]=Gd)}if(Gj.ambientTexture){var Gx=Gj.ambientTexture.texture2D;Gx&&(Gd=GG._getMaterialTexturePath(Gx,Gf,Gg),Gh.push(Gd),Gi[Gx]=Gd)}if(Gj.reflectTexture){var Gy=Gj.reflectTexture.texture2D;Gy&&(Gd=GG._getMaterialTexturePath(Gy,Gf,Gg),Gh.push(Gd),Gi[Gy]=Gd)}}var Gz=Gh.length,GA=Gz+1,GB=1/GA;if(GG._onProcessChange(Ga,0,GB,1),0<Gz){var GC=GD.create(null,GG._onProcessChange,[Ga,GB,Gz/GA],!1);GG._innerFourthLevelLoaderManager.create(Gh,GD.create(null,GG._onMateialTexturesLoaded,[Ga,GC,Gc,Gi]),GC,GTb,null,1,!0,Gb)}else GG._onMateialTexturesLoaded(Ga,null,Gc,null)}},GG._onMateialTexturesLoaded=function(Ga,Gb,Gc,Gd){Ga.endLoad([Gc,Gd]),Gb&&Gb.recover()},GG._loadTextureCube=function(Ga){Ga.on("loaded",null,GG._onTextureCubeLtcLoaded,[Ga]),Ga.load(Ga.url,"json",!1,null,!0)},GG._onTextureCubeLtcLoaded=function(Ga,Gb){if(Ga._class.destroyed)Ga.endLoad();else{var Gc=GE.getPath(Ga.url),Gd=[GG.formatRelativePath(Gc,Gb.px),GG.formatRelativePath(Gc,Gb.nx),GG.formatRelativePath(Gc,Gb.py),GG.formatRelativePath(Gc,Gb.ny),GG.formatRelativePath(Gc,Gb.pz),GG.formatRelativePath(Gc,Gb.nz)];GG._onProcessChange(Ga,0,1/7,1);var Ge=GD.create(null,GG._onProcessChange,[Ga,1/7,6/7],!1);GG._innerFourthLevelLoaderManager.load(Gd,GD.create(null,GG._onTextureCubeImagesLoaded,[Ga,Gd,Ge]),Ge,"nativeimage")}},GG._onTextureCubeImagesLoaded=function(Ga,Gb,Gc){var Gd=[];Gd.length=6;for(var Ge=0;Ge<6;Ge++){var Gf=Gb[Ge];Gd[Ge]=Gt.getRes(Gf),Gt.clearRes(Gf)}Ga.endLoad(Gd),Gc.recover()},GG._onProcessChange=function(Ga,Gb,Gc,Gd){(Gd=Gb+Gd*Gc)<1&&Ga.event("progress",Gd)},GG.init=function(Ga,Gb,Gc,Gd,Ge,Gf){if(void 0===Gc&&(Gc=!1),void 0===Gd&&(Gd=!1),void 0===Ge&&(Ge=!0),void 0===Gf&&(Gf=!0),Gu.update3DLoop=function(){},Gu.cancelLoadByUrl=function(Ga){GG._cancelLoadByUrl(Ga)},Gi.isAntialias=Gc,Gi.isAlpha=Gd,Gi.premultipliedAlpha=Ge,Gi.isStencil=Gf,!GF.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");Gu.changeWebGLSize=GG._changeWebGLSize,Gr.is3DMode=!0,Gx.init(Ga,Gb),GI.__init__(),Glb.__init__(),GXb.__init__(),GQ.__init__(),GG.__init__(),Gg.maxTextureCount=2,(GG.debugMode||GZ.debugMode)&&(GG._debugPhasorSprite=new GV)},GG.HIERARCHY="SPRITE3DHIERARCHY",GG.MESH="MESH",GG.MATERIAL="MATERIAL",GG.PBRMATERIAL="PBRMTL",GG.TEXTURECUBE="TEXTURECUBE",GG.TERRAIN="TERRAIN",GG._readData=null,GG._debugPhasorSprite=null,GG.debugMode=!1,Gl(GG,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new Gb},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new Gb},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new Gb},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new Gb}]),GG}(),Gub=function(Ga){function Ge(Ga){Ge.__super.call(this),this._owner=Ga,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}Gp(Ge,"laya.d3.animation.AnimationTransform3D",Gf);var Gb=Ge.prototype;return Gb._getlocalMatrix=function(){return this._localUpdate&&(Gsb._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},Gb._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var Ga=0,Gb=this._childs.length;Ga<Gb;Ga++)this._childs[Ga]._onWorldTransform()}},Gb._setWorldMatrixAndUpdate=function(Ga){if(this._worldMatrix=Ga,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var Gb=this._getlocalMatrix(),Gc=0;Gc<16;++Gc)this._worldMatrix[Gc]=Gb[Gc];else Gsb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},Gb._setWorldMatrixNoUpdate=function(Ga){this._worldMatrix=Ga},Gb._setWorldMatrixIgnoreUpdate=function(Ga){this._worldMatrix=Ga,this._worldUpdate=!1},Gb.getLocalPosition=function(){return this._localPosition},Gb.setLocalPosition=function(Ga){if(this._parent)this._localPosition=Ga,this._localUpdate=!0,this._onWorldTransform();else{var Gb=this._entity.owner._transform,Gc=this._entity.localPosition,Gd=Gc.elements;Gd[0]=Ga[0],Gd[1]=Ga[1],Gd[2]=Ga[2],Gb.localPosition=Gc}},Gb.getLocalRotation=function(){if(this._localQuaternionUpdate){var Ga=this._localRotationEuler;Gsb._quaternionCreateFromYawPitchRollArray(Ga[1]/Ge._angleToRandin,Ga[0]/Ge._angleToRandin,Ga[2]/Ge._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},Gb.setLocalRotation=function(Ga){if(this._parent)this._localRotation=Ga,Gsb.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var Gb=this._entity.owner._transform,Gc=this._entity.localRotation,Gd=Gc.elements;Gd[0]=Ga[0],Gd[1]=Ga[1],Gd[2]=Ga[2],Gd[3]=Ga[3],Gb.localRotation=Gc}},Gb.getLocalScale=function(){return this._localScale},Gb.setLocalScale=function(Ga){if(this._parent)this._localScale=Ga,this._localUpdate=!0,this._onWorldTransform();else{var Gb=this._entity.owner._transform,Gc=this._entity.localScale,Gd=Gc.elements;Gd[0]=Ga[0],Gd[1]=Ga[1],Gd[2]=Ga[2],Gb.localScale=Gc}},Gb.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){Gsb.getYawPitchRoll(this._localRotation,Ge._tempVector3);var Ga=Ge._tempVector3,Gb=this._localRotationEuler;Gb[0]=Ga[1]*Ge._angleToRandin,Gb[1]=Ga[0]*Ge._angleToRandin,Gb[2]=Ga[2]*Ge._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},Gb.setLocalRotationEuler=function(Ga){if(this._parent)Gsb._quaternionCreateFromYawPitchRollArray(Ga[1]/Ge._angleToRandin,Ga[0]/Ge._angleToRandin,Ga[2]/Ge._angleToRandin,this._localRotation),this._localRotationEuler=Ga,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var Gb=this._entity.owner._transform,Gc=this._entity.localRotationEuler,Gd=Gc.elements;Gd[0]=Ga[0],Gd[1]=Ga[1],Gd[2]=Ga[2],Gb.localRotationEuler=Gc}},Gb.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)Gsb.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var Ga=this._getlocalMatrix(),Gb=0;Gb<16;++Gb)this._worldMatrix[Gb]=Ga[Gb];this._worldUpdate=!1}return this._worldMatrix},Gb.setParent=function(Ga){if(this._parent!==Ga){if(this._parent){var Gb=this._parent._childs,Gc=Gb.indexOf(this);Gb.splice(Gc,1)}Ga&&(Ga._childs.push(this),Ga&&this._onWorldTransform()),this._parent=Ga}},Gl(Ge,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),Ge}(),Gvb=function(Ga){function Gb(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,Gb.__super.call(this),this._destroyed=!1,this._id=Gb._uniqueIDCounter,Gb._uniqueIDCounter++}Gp(Gb,"laya.d3.component.Component3D",Gf);var Gc=Gb.prototype;return Gx.imps(Gc,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),Gc._initialize=function(Ga){this._owner=Ga,this._enable=!0,this.started=!1,this._load(Ga)},Gc._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},Gc._load=function(Ga){},Gc._start=function(Ga){},Gc._update=function(Ga){},Gc._lateUpdate=function(Ga){},Gc._preRenderUpdate=function(Ga){},Gc._postRenderUpdate=function(Ga){},Gc._unload=function(Ga){this.offAll()},Gc._cloneTo=function(Ga){},Gq(0,Gc,"id",function(){return this._id}),Gq(0,Gc,"destroyed",function(){return this._destroyed}),Gq(0,Gc,"owner",function(){return this._owner}),Gq(0,Gc,"enable",function(){return this._enable},function(Ga){this._enable!==Ga&&(this._enable=Ga,this.event("enablechanged",this._enable))}),Gq(0,Gc,"isSingleton",function(){return Gb._isSingleton}),Gb._isSingleton=!0,Gb._uniqueIDCounter=1,Gb}(),Gwb=function(Ga){function Gb(){this._destroyed=!1,Gb.__super.call(this),this._destroyed=!1}Gp(Gb,"laya.d3.core.GeometryFilter",Gf);var Gc=Gb.prototype;return Gx.imps(Gc,{"laya.resource.IDestroy":!0}),Gc._destroy=function(){this.offAll(),this._destroyed=!0},Gq(0,Gc,"_isAsyncLoaded",function(){return!0}),Gq(0,Gc,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),Gq(0,Gc,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),Gq(0,Gc,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),Gq(0,Gc,"destroyed",function(){return this._destroyed}),Gb}(),Gxb=function(Ga){function Gd(Ga){Gd.__super.call(this),this._id=++Gd._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new GZa(new Ggb,new Ggb),this._boundingBoxCenter=new Ggb,this._boundingSphere=new G_a(new Ggb,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=Ga,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}Gp(Gd,"laya.d3.core.render.BaseRender",Gf);var Gb=Gd.prototype;return Gx.imps(Gb,{"laya.resource.IDestroy":!0}),Gb._changeMaterialReference=function(Ga,Gb){Ga&&Ga._removeReference(),Gb._addReference()},Gb._getInstanceMaterial=function(Ga,Gb){var Gc=new Ga.constructor;return Ga.cloneTo(Gc),Gc.name=Gc.name+"(Instance)",this._materialsInstance[Gb]=!0,this._changeMaterialReference(this._materials[Gb],Gc),this._materials[Gb]=Gc},Gb._setShaderValuelightMap=function(Ga){this._setShaderValueTexture(3,Ga)},Gb._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},Gb._renderRenderableBoundBox=function(){var Ga=Gtb._debugPhasorSprite,Gb=this.boundingBox,Gc=Gd._tempBoundBoxCorners;Gb.getCorners(Gc),Ga.line(Gc[0],Gd._greenColor,Gc[1],Gd._greenColor),Ga.line(Gc[2],Gd._greenColor,Gc[3],Gd._greenColor),Ga.line(Gc[4],Gd._greenColor,Gc[5],Gd._greenColor),Ga.line(Gc[6],Gd._greenColor,Gc[7],Gd._greenColor),Ga.line(Gc[0],Gd._greenColor,Gc[3],Gd._greenColor),Ga.line(Gc[1],Gd._greenColor,Gc[2],Gd._greenColor),Ga.line(Gc[2],Gd._greenColor,Gc[6],Gd._greenColor),Ga.line(Gc[3],Gd._greenColor,Gc[7],Gd._greenColor),Ga.line(Gc[0],Gd._greenColor,Gc[4],Gd._greenColor),Ga.line(Gc[1],Gd._greenColor,Gc[5],Gd._greenColor),Ga.line(Gc[4],Gd._greenColor,Gc[7],Gd._greenColor),Ga.line(Gc[5],Gd._greenColor,Gc[6],Gd._greenColor)},Gb._calculateBoundingSphere=function(){throw"BaseRender: must override it."},Gb._calculateBoundingBox=function(){throw"BaseRender: must override it."},Gb._setShaderValueTexture=function(Ga,Gb){this._owner._shaderValues.setValue(Ga,Gb)},Gb._setShaderValueMatrix4x4=function(Ga,Gb){this._owner._shaderValues.setValue(Ga,Gb?Gb.elements:null)},Gb._setShaderValueColor=function(Ga,Gb){this._owner._shaderValues.setValue(Ga,Gb?Gb.elements:null)},Gb._setShaderValueBuffer=function(Ga,Gb){this._owner._shaderValues.setValue(Ga,Gb)},Gb._setShaderValueInt=function(Ga,Gb){this._owner._shaderValues.setValue(Ga,Gb)},Gb._setShaderValueBool=function(Ga,Gb){this._owner._shaderValues.setValue(Ga,Gb)},Gb._setShaderValueNumber=function(Ga,Gb){this._owner._shaderValues.setValue(Ga,Gb)},Gb._setShaderValueVector2=function(Ga,Gb){this._owner._shaderValues.setValue(Ga,Gb?Gb.elements:null)},Gb._addShaderDefine=function(Ga){this._owner._shaderDefineValue|=Ga},Gb._removeShaderDefine=function(Ga){this._owner._shaderDefineValue&=~Ga},Gb._renderUpdate=function(Ga){return!0},Gb._applyLightMapParams=function(){if(0<=this._lightmapIndex){var Ga=this._owner.scene;if(Ga){var Gb=Ga.getlightmaps()[this._lightmapIndex];Gb?(this._addShaderDefine(GVb.SAHDERDEFINE_LIGHTMAP),Gb.loaded?this._setShaderValuelightMap(Gb):Gb.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(GVb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(GVb.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(GVb.SAHDERDEFINE_LIGHTMAP)},Gb._updateOctreeNode=function(){var Ga=this._treeNode;Ga&&this._octreeNodeNeedChange&&(Ga.updateObject(this),this._octreeNodeNeedChange=!1)},Gb._destroy=function(){this.offAll();var Ga=0,Gb=0;for(Ga=0,Gb=this._renderElements.length;Ga<Gb;Ga++)this._renderElements[Ga]._destroy();for(Ga=0,Gb=this._materials.length;Ga<Gb;Ga++)this._materials[Ga]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},Gq(0,Gb,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),Gq(0,Gb,"id",function(){return this._id}),Gq(0,Gb,"material",function(){var Ga=this._materials[0];if(Ga&&!this._materialsInstance[0]){var Gb=this._getInstanceMaterial(Ga,0);this.event("materialchanged",[this,0,Gb])}return this._materials[0]},function(Ga){this.sharedMaterial=Ga}),Gq(0,Gb,"sharedMaterial",function(){return this._materials[0]},function(Ga){var Gb=this._materials[0];Gb!==Ga&&(this._materials[0]=Ga,this._materialsInstance[0]=!1,this._changeMaterialReference(Gb,Ga),this.event("materialchanged",[this,0,Ga]))}),Gq(0,Gb,"lightmapIndex",function(){return this._lightmapIndex},function(Ga){this._lightmapIndex=Ga,this._applyLightMapParams()}),Gq(0,Gb,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(Ga){this._lightmapScaleOffset=Ga,this._setShaderValueColor(2,Ga),this._addShaderDefine(GVb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),Gq(0,Gb,"enable",function(){return this._enable},function(Ga){this._enable=Ga,this.event("enablechanged",[this,Ga])}),Gq(0,Gb,"materials",function(){for(var Ga=0,Gb=this._materials.length;Ga<Gb;Ga++)if(!this._materialsInstance[Ga]){var Gc=this._getInstanceMaterial(this._materials[Ga],Ga);this.event("materialchanged",[this,Ga,Gc])}return this._materials.slice()},function(Ga){this.sharedMaterials=Ga}),Gq(0,Gb,"sharedMaterials",function(){return this._materials.slice()},function(Ga){if(!Ga)throw new Error("MeshRender: shadredMaterials value can't be null.");var Gb=Ga.length;this._materialsInstance.length=Gb;for(var Gc=0;Gc<Gb;Gc++){var Gd=this._materials[Gc];Gd!==Ga[Gc]&&(this._materialsInstance[Gc]=!1,this._changeMaterialReference(Gd,Ga[Gc]),this.event("materialchanged",[this,Gc,Ga[Gc]]))}this._materials=Ga}),Gq(0,Gb,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),Gq(0,Gb,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var Ga=this.boundingBox;Ggb.add(Ga.min,Ga.max,this._boundingBoxCenter),Ggb.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),Gq(0,Gb,"receiveShadow",function(){return this._receiveShadow},function(Ga){this._receiveShadow!==Ga&&((this._receiveShadow=Ga)?this._addShaderDefine(Gpb.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(Gpb.SHADERDEFINE_RECEIVE_SHADOW))}),Gq(0,Gb,"destroyed",function(){return this._destroyed}),Gd._uniqueIDCounter=0,Gl(Gd,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new Ggb,new Ggb,new Ggb,new Ggb,new Ggb,new Ggb,new Ggb,new Ggb]},"_greenColor",function(){return this._greenColor=new Ghb(0,1,0,1)}]),Gd}(),Gyb=function(Ga){function Gh(Ga){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,Gh.__super.call(this),this._localPosition=new Ggb,this._localRotation=new Gcb(0,0,0,1),this._localScale=new Ggb(1,1,1),this._localRotationEuler=new Ggb,this._localMatrix=new Gab,this._position=new Ggb,this._rotation=new Gcb(0,0,0,1),this._scale=new Ggb(1,1,1),this._worldMatrix=new Gab,this._forward=new Ggb,this._up=new Ggb,this._right=new Ggb,this._owner=Ga,this._childs=[]}Gp(Gh,"laya.d3.core.Transform3D",Gf);var Gb=Gh.prototype;return Gb._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)Gab.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var Ga=Gh._tempVector30;Ggb.multiply(this.pivot,this._localScale,Ga);var Gb=Gh._tempVector31;Ggb.subtract(Ga,this.pivot,Gb);var Gc=Gh._tempVector32,Gd=this.localRotation;Ggb.transformQuat(Ga,Gd,Gc),Ggb.subtract(Gc,Ga,Gc);var Ge=Gh._tempVector33;Ggb.subtract(this._localPosition,Gb,Ge),Ggb.subtract(Ge,Gc,Ge),Gab.createAffineTransformation(Ge,Gd,this._localScale,this._localMatrix)}},Gb._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var Ga=0,Gb=this._childs.length;Ga<Gb;Ga++)this._childs[Ga]._onWorldPositionRotationTransform()}},Gb._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Ga=0,Gb=this._childs.length;Ga<Gb;Ga++)this._childs[Ga]._onWorldPositionScaleTransform()}},Gb._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var Ga=0,Gb=this._childs.length;Ga<Gb;Ga++)this._childs[Ga]._onWorldPositionTransform()}},Gb._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var Ga=0,Gb=this._childs.length;Ga<Gb;Ga++)this._childs[Ga]._onWorldPositionRotationTransform()}},Gb._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Ga=0,Gb=this._childs.length;Ga<Gb;Ga++)this._childs[Ga]._onWorldPositionScaleTransform()}},Gb._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var Ga=0,Gb=this._childs.length;Ga<Gb;Ga++)this._childs[Ga]._onWorldTransform()}},Gb.translate=function(Ga,Gb){void 0===Gb&&(Gb=!0),Gb?(Gab.createFromQuaternion(this.localRotation,Gh._tempMatrix0),Ggb.transformCoordinate(Ga,Gh._tempMatrix0,Gh._tempVector30),Ggb.add(this.localPosition,Gh._tempVector30,this._localPosition),this.localPosition=this._localPosition):(Ggb.add(this.position,Ga,this._position),this.position=this._position)},Gb.rotate=function(Ga,Gb,Gc){var Gd;void 0===Gb&&(Gb=!0),void 0===Gc&&(Gc=!0),Gd=Gc?Ga:(Ggb.scale(Ga,Math.PI/180,Gh._tempVector30),Gh._tempVector30),Gcb.createFromYawPitchRoll(Gd.y,Gd.x,Gd.z,Gh._tempQuaternion0),Gb?(Gcb.multiply(this._localRotation,Gh._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(Gcb.multiply(Gh._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},Gb.lookAt=function(Ga,Gb,Gc){void 0===Gc&&(Gc=!1);var Gd,Ge=Ga.elements;if(Gc){if(Gd=this._localPosition.elements,Math.abs(Gd[0]-Ge[0])<Gma.zeroTolerance&&Math.abs(Gd[1]-Ge[1])<Gma.zeroTolerance&&Math.abs(Gd[2]-Ge[2])<Gma.zeroTolerance)return;Gcb.lookAt(this._localPosition,Ga,Gb,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var Gf=this.position;if(Gd=Gf.elements,Math.abs(Gd[0]-Ge[0])<Gma.zeroTolerance&&Math.abs(Gd[1]-Ge[1])<Gma.zeroTolerance&&Math.abs(Gd[2]-Ge[2])<Gma.zeroTolerance)return;Gcb.lookAt(Gf,Ga,Gb,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},Gq(0,Gb,"_isFrontFaceInvert",function(){var Ga=this.scale,Gb=Ga.x<0;return Ga.y<0&&(Gb=!Gb),Ga.z<0&&(Gb=!Gb),Gb}),Gq(0,Gb,"owner",function(){return this._owner}),Gq(0,Gb,"localRotation",function(){if(this._localQuaternionUpdate){var Ga=this._localRotationEuler.elements;Gcb.createFromYawPitchRoll(Ga[1]/Gh._angleToRandin,Ga[0]/Gh._angleToRandin,Ga[2]/Gh._angleToRandin,this._localRotation)}return this._localRotation},function(Ga){this._localRotation=Ga,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),Gq(0,Gb,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?Gab.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(Ga){null===this._parent?Ga.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),Gab.multiply(this._localMatrix,Ga,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=Ga,this._worldUpdate=!1}),Gq(0,Gb,"worldNeedUpdate",function(){return this._worldUpdate}),Gq(0,Gb,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(Ga){this._localMatrix=Ga,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),Gq(0,Gb,"dummy",function(){return this._dummy},function(Ga){this._dummy!==Ga&&(this._dummy&&(this._dummy._entity=null),Ga&&(Ga._entity=this),this._dummy=Ga)}),Gq(0,Gb,"localPosition",function(){return this._localPosition},function(Ga){this._localPosition=Ga,this._localUpdate=!0,this._onWorldPositionTransform()}),Gq(0,Gb,"position",function(){if(this._positionUpdate){if(null!=this._parent){var Ga=this._parent.position;Ggb.multiply(this._localPosition,this._parent.scale,Gh._tempVector30),Ggb.transformQuat(Gh._tempVector30,this._parent.rotation,Gh._tempVector30),Ggb.add(Ga,Gh._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(Ga){if(null!=this._parent){Ggb.subtract(Ga,this._parent.position,this._localPosition);var Gb=this._parent.scale.elements,Gc=Gb[0],Gd=Gb[1],Ge=Gb[2];if(1!==Gc||1!==Gd||1!==Ge){var Gf=Gh._tempVector30,Gg=Gf.elements;Gg[0]=1/Gc,Gg[1]=1/Gd,Gg[2]=1/Ge,Ggb.multiply(this._localPosition,Gf,this._localPosition)}this._parent.rotation.invert(Gh._tempQuaternion0),Ggb.transformQuat(this._localPosition,Gh._tempQuaternion0,this._localPosition)}else Ga.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=Ga,this._positionUpdate=!1}),Gq(0,Gb,"localScale",function(){return this._localScale},function(Ga){this._localScale=Ga,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),Gq(0,Gb,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(Gh._tempVector30);var Ga=Gh._tempVector30.elements,Gb=this._localRotationEuler.elements;Gb[0]=Ga[1]*Gh._angleToRandin,Gb[1]=Ga[0]*Gh._angleToRandin,Gb[2]=Ga[2]*Gh._angleToRandin}return this._localRotationEuler},function(Ga){this._localRotationEuler=Ga,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),Gq(0,Gb,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?Gcb.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(Ga){null!=this._parent?(this._parent.rotation.invert(Gh._tempQuaternion0),Gcb.multiply(Ga,Gh._tempQuaternion0,this._localRotation)):Ga.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=Ga,this._rotationUpdate=!1}),Gq(0,Gb,"scale",function(){return this._scaleUpdate&&(null!==this._parent?Ggb.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(Ga){if(null!==this._parent){var Gb=this._parent.scale.elements,Gc=Gh._tempVector30.elements;Gc[0]=1/Gb[0],Gc[1]=1/Gb[1],Gc[2]=1/Gb[2],Ggb.multiply(Ga,Gh._tempVector30,this._localScale)}else Ga.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=Ga,this._scaleUpdate=!1}),Gq(0,Gb,"rotationEuler",null,function(Ga){Gcb.createFromYawPitchRoll(Ga.y,Ga.x,Ga.z,this._rotation),this.rotation=this._rotation}),Gq(0,Gb,"forward",function(){var Ga=this.worldMatrix.elements;return this._forward.elements[0]=-Ga[8],this._forward.elements[1]=-Ga[9],this._forward.elements[2]=-Ga[10],this._forward}),Gq(0,Gb,"up",function(){var Ga=this.worldMatrix.elements;return this._up.elements[0]=Ga[4],this._up.elements[1]=Ga[5],this._up.elements[2]=Ga[6],this._up}),Gq(0,Gb,"right",function(){var Ga=this.worldMatrix.elements;return this._right.elements[0]=Ga[0],this._right.elements[1]=Ga[1],this._right.elements[2]=Ga[2],this._right}),Gq(0,Gb,"parent",function(){return this._parent},function(Ga){if(this._parent!==Ga){if(this._parent){var Gb=this._parent._childs,Gc=Gb.indexOf(this);Gb.splice(Gc,1)}Ga&&(Ga._childs.push(this),Ga&&this._onWorldTransform()),this._parent=Ga}}),Gl(Gh,["_tempVector30",function(){return this._tempVector30=new Ggb},"_tempVector31",function(){return this._tempVector31=new Ggb},"_tempVector32",function(){return this._tempVector32=new Ggb},"_tempVector33",function(){return this._tempVector33=new Ggb},"_tempQuaternion0",function(){return this._tempQuaternion0=new Gcb},"_tempMatrix0",function(){return this._tempMatrix0=new Gab},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),Gh}(),Gzb=(function(Ga){function Gb(){this._rotation=0,this._matNeedUpdte=!1,Gb.__super.call(this),this._matrix=new Gab,this._offset=new Gfb,this._tiling=new Gfb(1,1)}Gp(Gb,"laya.d3.core.TransformUV",Gf);var Gc=Gb.prototype;Gx.imps(Gc,{"laya.d3.core.IClone":!0}),Gc._updateMatrix=function(){Gb._tempOffsetV3.elements[0]=this._offset.x,Gb._tempOffsetV3.elements[1]=this._offset.y,Gcb.createFromYawPitchRoll(0,0,this._rotation,Gb._tempRotationQua),Gb._tempTitlingV3.elements[0]=this._tiling.x,Gb._tempTitlingV3.elements[1]=this._tiling.y,Gab.createAffineTransformation(Gb._tempOffsetV3,Gb._tempRotationQua,Gb._tempTitlingV3,this._matrix)},Gc.cloneTo=function(Ga){Ga._matrix=this._matrix.clone(),Ga._offset=this._offset.clone(),Ga._rotation=this._rotation,Ga._tiling=this._tiling.clone()},Gc.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Gc,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),Gq(0,Gc,"tiling",function(){return this._tiling},function(Ga){this._tiling=Ga,this._matNeedUpdte=!0}),Gq(0,Gc,"offset",function(){return this._offset},function(Ga){this._offset=Ga,this._matNeedUpdte=!0}),Gq(0,Gc,"rotation",function(){return this._rotation},function(Ga){this._rotation=Ga,this._matNeedUpdte=!0}),Gl(Gb,["_tempOffsetV3",function(){return this._tempOffsetV3=new Ggb(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new Gcb},"_tempTitlingV3",function(){return this._tempTitlingV3=new Ggb(1,1,1)}])}(),function(Gc){function Ga(){this.x=NaN,this.y=NaN,this.z=NaN,Ga.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}Gp(Ga,"laya.d3.core.particleShuriKen.module.shape.BoxShape",Gc);var Gb=Ga.prototype;Gb._getShapeBoundBox=function(Ga){var Gb=Ga.min.elements;Gb[0]=.5*-this.x,Gb[1]=.5*-this.y,Gb[2]=.5*-this.z;var Gc=Ga.max.elements;Gc[0]=.5*this.x,Gc[1]=.5*this.y,Gc[2]=.5*this.z},Gb._getSpeedBoundBox=function(Ga){var Gb=Ga.min.elements;Gb[0]=0,Gb[1]=0,Gb[2]=0;var Gc=Ga.max.elements;Gc[0]=0,Gc[1]=1,Gc[2]=0},Gb.generatePositionAndDirection=function(Ga,Gb,Gc,Gd){var Ge=Ga.elements,Gf=Gb.elements;Gc?(Gc.seed=Gd[16],GT._randomPointInsideHalfUnitBox(Ga,Gc),Gd[16]=Gc.seed):GT._randomPointInsideHalfUnitBox(Ga),Ge[0]=this.x*Ge[0],Ge[1]=this.y*Ge[1],Ge[2]=this.z*Ge[2],this.randomDirection?Gc?(Gc.seed=Gd[17],GT._randomPointUnitSphere(Gb,Gc),Gd[17]=Gc.seed):GT._randomPointUnitSphere(Gb):(Gf[0]=0,Gf[1]=0,Gf[2]=1)},Gb.cloneTo=function(Ga){Gc.prototype.cloneTo.call(this,Ga);var Gb=Ga;Gb.x=this.x,Gb.y=this.y,Gb.z=this.z,Gb.randomDirection=this.randomDirection}}(GO),function(Gc){function Gg(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,Gg.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}Gp(Gg,"laya.d3.core.particleShuriKen.module.shape.CircleShape",Gc);var Ga=Gg.prototype;Ga._getShapeBoundBox=function(Ga){var Gb=Ga.min.elements;Gb[0]=Gb[2]=-this.radius,Gb[1]=0;var Gc=Ga.max.elements;Gc[0]=Gc[2]=this.radius,Gc[1]=0},Ga._getSpeedBoundBox=function(Ga){var Gb=Ga.min.elements;Gb[0]=Gb[1]=-1,Gb[2]=0;var Gc=Ga.max.elements;Gc[0]=Gc[1]=1,Gc[2]=0},Ga.generatePositionAndDirection=function(Ga,Gb,Gc,Gd){var Ge=Ga.elements,Gf=Gg._tempPositionPoint.elements;Gc?(Gc.seed=Gd[16],this.emitFromEdge?GT._randomPointUnitArcCircle(this.arc,Gg._tempPositionPoint,Gc):GT._randomPointInsideUnitArcCircle(this.arc,Gg._tempPositionPoint,Gc),Gd[16]=Gc.seed):this.emitFromEdge?GT._randomPointUnitArcCircle(this.arc,Gg._tempPositionPoint):GT._randomPointInsideUnitArcCircle(this.arc,Gg._tempPositionPoint),Ge[0]=-Gf[0],Ge[1]=Gf[1],Ge[2]=0,Ggb.scale(Ga,this.radius,Ga),this.randomDirection?Gc?(Gc.seed=Gd[17],GT._randomPointUnitSphere(Gb,Gc),Gd[17]=Gc.seed):GT._randomPointUnitSphere(Gb):Ga.cloneTo(Gb)},Ga.cloneTo=function(Ga){Gc.prototype.cloneTo.call(this,Ga);var Gb=Ga;Gb.radius=this.radius,Gb.arc=this.arc,Gb.emitFromEdge=this.emitFromEdge,Gb.randomDirection=this.randomDirection},Gl(Gg,["_tempPositionPoint",function(){return this._tempPositionPoint=new Gfb}])}(GO),function(Gc){function Go(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,Go.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}Gp(Go,"laya.d3.core.particleShuriKen.module.shape.ConeShape",Gc);var Ga=Go.prototype;Ga._getShapeBoundBox=function(Ga){var Gb=this.radius+this.length*Math.sin(this.angle),Gc=this.length*Math.cos(this.angle),Gd=Ga.min.elements;Gd[0]=Gd[1]=-Gb,Gd[2]=0;var Ge=Ga.max.elements;Ge[0]=Ge[1]=Gb,Ge[2]=Gc},Ga._getSpeedBoundBox=function(Ga){var Gb=Math.sin(this.angle),Gc=Ga.min.elements;Gc[0]=Gc[1]=-Gb,Gc[2]=0;var Gd=Ga.max.elements;Gd[0]=Gc[1]=Gb,Gd[2]=1},Ga.generatePositionAndDirection=function(Ga,Gb,Gc,Gd){var Ge,Gf=Ga.elements,Gg=Gb.elements,Gh=Go._tempPositionPoint.elements,Gi=NaN,Gj=NaN,Gk=Math.cos(this.angle),Gl=Math.sin(this.angle);switch(this.emitType){case 0:Gc?(Gc.seed=Gd[16],GT._randomPointInsideUnitCircle(Go._tempPositionPoint,Gc),Gd[16]=Gc.seed):GT._randomPointInsideUnitCircle(Go._tempPositionPoint),Gi=Gh[0],Gj=Gh[1],Gf[0]=Gi*this.radius,Gf[1]=Gj*this.radius,Gf[2]=0,this.randomDirection?(Gc?(Gc.seed=Gd[17],GT._randomPointInsideUnitCircle(Go._tempDirectionPoint,Gc),Gd[17]=Gc.seed):GT._randomPointInsideUnitCircle(Go._tempDirectionPoint),Ge=Go._tempDirectionPoint.elements,Gg[0]=Ge[0]*Gl,Gg[1]=Ge[1]*Gl):(Gg[0]=Gi*Gl,Gg[1]=Gj*Gl),Gg[2]=Gk;break;case 1:Gc?(Gc.seed=Gd[16],GT._randomPointUnitCircle(Go._tempPositionPoint,Gc),Gd[16]=Gc.seed):GT._randomPointUnitCircle(Go._tempPositionPoint),Gi=Gh[0],Gj=Gh[1],Gf[0]=Gi*this.radius,Gf[1]=Gj*this.radius,Gf[2]=0,this.randomDirection?(Gc?(Gc.seed=Gd[17],GT._randomPointInsideUnitCircle(Go._tempDirectionPoint,Gc),Gd[17]=Gc.seed):GT._randomPointInsideUnitCircle(Go._tempDirectionPoint),Ge=Go._tempDirectionPoint.elements,Gg[0]=Ge[0]*Gl,Gg[1]=Ge[1]*Gl):(Gg[0]=Gi*Gl,Gg[1]=Gj*Gl),Gg[2]=Gk;break;case 2:Gc?(Gc.seed=Gd[16],GT._randomPointInsideUnitCircle(Go._tempPositionPoint,Gc)):GT._randomPointInsideUnitCircle(Go._tempPositionPoint),Gi=Gh[0],Gj=Gh[1],Gf[0]=Gi*this.radius,Gf[1]=Gj*this.radius,Gg[Gf[2]=0]=Gi*Gl,Gg[1]=Gj*Gl,Gg[2]=Gk,Ggb.normalize(Gb,Gb),Gc?(Ggb.scale(Gb,this.length*Gc.getFloat(),Gb),Gd[16]=Gc.seed):Ggb.scale(Gb,this.length*Math.random(),Gb),Ggb.add(Ga,Gb,Ga),this.randomDirection&&(Gc?(Gc.seed=Gd[17],GT._randomPointUnitSphere(Gb,Gc),Gd[17]=Gc.seed):GT._randomPointUnitSphere(Gb));break;case 3:Gc?(Gc.seed=Gd[16],GT._randomPointUnitCircle(Go._tempPositionPoint,Gc)):GT._randomPointUnitCircle(Go._tempPositionPoint),Gi=Gh[0],Gj=Gh[1],Gf[0]=Gi*this.radius,Gf[1]=Gj*this.radius,Gg[Gf[2]=0]=Gi*Gl,Gg[1]=Gj*Gl,Gg[2]=Gk,Ggb.normalize(Gb,Gb),Gc?(Ggb.scale(Gb,this.length*Gc.getFloat(),Gb),Gd[16]=Gc.seed):Ggb.scale(Gb,this.length*Math.random(),Gb),Ggb.add(Ga,Gb,Ga),this.randomDirection&&(Gc?(Gc.seed=Gd[17],GT._randomPointUnitSphere(Gb,Gc),Gd[17]=Gc.seed):GT._randomPointUnitSphere(Gb));break;default:throw new Error("ConeShape:emitType is invalid.")}},Ga.cloneTo=function(Ga){Gc.prototype.cloneTo.call(this,Ga);var Gb=Ga;Gb.angle=this.angle,Gb.radius=this.radius,Gb.length=this.length,Gb.emitType=this.emitType,Gb.randomDirection=this.randomDirection},Gl(Go,["_tempPositionPoint",function(){return this._tempPositionPoint=new Gfb},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new Gfb}])}(GO),function(Gc){function Ga(){this.radius=NaN,this.emitFromShell=!1,Ga.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}Gp(Ga,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",Gc);var Gb=Ga.prototype;Gb._getShapeBoundBox=function(Ga){var Gb=Ga.min.elements;Gb[0]=Gb[1]=Gb[2]=-this.radius;var Gc=Ga.max.elements;Gc[0]=Gc[1]=this.radius,Gc[2]=0},Gb._getSpeedBoundBox=function(Ga){var Gb=Ga.min.elements;Gb[0]=Gb[1]=-1,Gb[2]=0;var Gc=Ga.max.elements;Gc[0]=Gc[1]=Gc[2]=1},Gb.generatePositionAndDirection=function(Ga,Gb,Gc,Gd){var Ge=Ga.elements;Gc?(Gc.seed=Gd[16],this.emitFromShell?GT._randomPointUnitSphere(Ga,Gc):GT._randomPointInsideUnitSphere(Ga,Gc),Gd[16]=Gc.seed):this.emitFromShell?GT._randomPointUnitSphere(Ga):GT._randomPointInsideUnitSphere(Ga),Ggb.scale(Ga,this.radius,Ga);var Gf=Ge[2];Gf<0&&(Ge[2]=-1*Gf),this.randomDirection?Gc?(Gc.seed=Gd[17],GT._randomPointUnitSphere(Gb,Gc),Gd[17]=Gc.seed):GT._randomPointUnitSphere(Gb):Ga.cloneTo(Gb)},Gb.cloneTo=function(Ga){Gc.prototype.cloneTo.call(this,Ga);var Gb=Ga;Gb.radius=this.radius,Gb.emitFromShell=this.emitFromShell,Gb.randomDirection=this.randomDirection}}(GO),function(Gc){function Ga(){this.radius=NaN,this.emitFromShell=!1,Ga.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}Gp(Ga,"laya.d3.core.particleShuriKen.module.shape.SphereShape",Gc);var Gb=Ga.prototype;Gb._getShapeBoundBox=function(Ga){var Gb=Ga.min.elements;Gb[0]=Gb[1]=Gb[2]=-this.radius;var Gc=Ga.max.elements;Gc[0]=Gc[1]=Gc[2]=this.radius},Gb._getSpeedBoundBox=function(Ga){var Gb=Ga.min.elements;Gb[0]=Gb[1]=Gb[2]=-1;var Gc=Ga.max.elements;Gc[0]=Gc[1]=Gc[2]=1},Gb.generatePositionAndDirection=function(Ga,Gb,Gc,Gd){Gc?(Gc.seed=Gd[16],this.emitFromShell?GT._randomPointUnitSphere(Ga,Gc):GT._randomPointInsideUnitSphere(Ga,Gc),Gd[16]=Gc.seed):this.emitFromShell?GT._randomPointUnitSphere(Ga):GT._randomPointInsideUnitSphere(Ga),Ggb.scale(Ga,this.radius,Ga),this.randomDirection?Gc?(Gc.seed=Gd[17],GT._randomPointUnitSphere(Gb,Gc),Gd[17]=Gc.seed):GT._randomPointUnitSphere(Gb):Ga.cloneTo(Gb)},Gb.cloneTo=function(Ga){Gc.prototype.cloneTo.call(this,Ga);var Gb=Ga;Gb.radius=this.radius,Gb.emitFromShell=this.emitFromShell,Gb.randomDirection=this.randomDirection}}(GO),function(Ga){function Gb(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,Gb.__super.call(this)}return Gp(Gb,"laya.d3.core.render.SubMeshRenderElement",GW),Gb}()),GAb=function(Ga){function Gs(Ga,Gb,Gc,Gd,Ge,Gf){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=Ga,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[Gpb.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[GVb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[GVb.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[GEb.SHADERDEFINE_ALPHATEST]="ALPHATEST";Gs.__super.call(this,Ga,Gb,Gc,null,{}),this._attributeMap=Gd;var Gg;for(Gg in Ge){var Gh=Ge[Gg];switch(Gh[1]){case 0:this._renderElementUniformMap[Gg]=Gh[0];break;case 1:this._materialUniformMap[Gg]=Gh[0];break;case 2:this._spriteUniformMap[Gg]=Gh[0];break;case 3:this._cameraUniformMap[Gg]=Gh[0];break;case 4:this._sceneUniformMap[Gg]=Gh[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}Gp(Gs,"laya.d3.shader.ShaderCompile3D",Gv);var Gb=Gs.prototype;return Gb._definesToNameDic=function(Ga,Gb){for(var Gc={},Gd=1,Ge=0;Ge<32&&!(Ga<(Gd=1<<Ge));Ge++)if(Ga&Gd){var Gf=Gb[Gd];Gf&&(Gc[Gf]="")}return Gc},Gb.withCompile=function(Ga,Gb,Gc,Gd){var Ge,Gf,Gg;if(Gf=this.sharders[Ga])if(Gg=Gf[Gb]){if(Ge=Gg[Gc])return Ge}else Gg=Gf[Gb]=[];else Gg=(Gf=this.sharders[Ga]=[])[Gb]=[];var Gh,Gi=this._definesToNameDic(Ga,Gs._globalInt2name),Gj=this._definesToNameDic(Gb,this._spriteInt2name),Gk=this._definesToNameDic(Gc,this._materialInt2name),Gl={},Go="";if(Gi)for(Gh in Gi)Go+="#define "+Gh+"\n",Gl[Gh]=!0;if(Gj)for(Gh in Gj)Go+="#define "+Gh+"\n",Gl[Gh]=!0;if(Gk)for(Gh in Gk)Go+="#define "+Gh+"\n",Gl[Gh]=!0;var Gp=GLb.nameKey.getName(this._name)+" compile ("+Ga+","+Gb+","+Gc+")",Gq=this._VS.toscript(Gl,[]),Gr=this._PS.toscript(Gl,[]);GH.now();if(Ge=GLb.create(Go+Gq.join("\n"),Go+Gr.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,Gd,Gp),Gg[Gc]=Ge,laya.d3.shader.ShaderCompile3D.debugMode)GH.now();return Ge},Gb.precompileShaderWithShaderDefine=function(Ga,Gb,Gc){this.withCompile(Ga,Gb,Gc,!0)},Gb.addMaterialDefines=function(Ga){var Gb=Ga.defines;for(var Gc in Gb){var Gd=Gb[Gc],Ge=parseInt(Gc);this._materialInt2name[Ge]=Gd,this._materialName2Int[Gd]=Ge}},Gb.addSpriteDefines=function(Ga){var Gb=Ga.defines;for(var Gc in Gb){var Gd=Gb[Gc],Ge=parseInt(Gc);this._spriteInt2name[Ge]=Gd,this._spriteName2Int[Gd]=Ge}},Gb.getMaterialDefineByName=function(Ga){return this._materialName2Int[Ga]},Gb.registerMaterialDefine=function(Ga){var Gb=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[Gb]=Ga,this._materialName2Int[Ga]=Gb},Gb.registerSpriteDefine=function(Ga){var Gb=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[Gb]=Ga,this._spriteName2Int[Ga]=Gb},Gs._globalRegDefine=function(Ga,Gb){Gs._globalInt2name[Gb]=Ga},Gs.add=function(Ga,Gb,Gc,Gd,Ge){return laya.d3.shader.ShaderCompile3D._preCompileShader[Ga]=new Gs(Ga,Gb,Gc,Gd,Ge,Gv.includes)},Gs.get=function(Ga){return laya.d3.shader.ShaderCompile3D._preCompileShader[GLb.nameKey.getID(Ga)]},Gs._preCompileShader={},Gs._globalInt2name=[],Gs.debugMode=!1,Gs.SHADERDEFINE_HIGHPRECISION=1,Gs.SHADERDEFINE_FOG=4,Gs.SHADERDEFINE_DIRECTIONLIGHT=8,Gs.SHADERDEFINE_POINTLIGHT=16,Gs.SHADERDEFINE_SPOTLIGHT=32,Gs.SHADERDEFINE_UV0=64,Gs.SHADERDEFINE_COLOR=128,Gs.SHADERDEFINE_UV1=256,Gs.SAHDERDEFINE_DEPTHFOG=131072,Gs}(),GBb=function(Ga){function Gq(){Gq.__super.call(this)}Gp(Gq,"laya.d3.graphics.MeshSprite3DStaticBatchManager",Gda);var Gb=Gq.prototype;return Gb._getStaticBatch=function(Ga,Gb,Gc,Gd){var Ge,Gf;return Gf=Ga?Ga.id.toString()+Gc.id.toString()+Gb.id.toString()+Gd.toString():Gc.id.toString()+Gb.id.toString()+Gd.toString(),this._staticBatches[Gf]?Ge=this._staticBatches[Gf]:this._staticBatches[Gf]=Ge=new GCb(Gf,this,Ga,Gb,Gc),Ge},Gb._initStaticBatchs=function(Ga){var Gb,Gc;this._initBatchRenderElements.sort(Gq._sortPrepareStaticBatch);for(var Gd,Ge=!1,Gf=0,Gg=0,Gh=this._initBatchRenderElements.length;Gg<Gh;Gg++){var Gi,Gj=this._initBatchRenderElements[Gg],Gk=Gj.renderObj._getVertexBuffer(0);Gj._sprite3D;if(Gc===Gk.vertexDeclaration&&Gb===Gj._material)if(Ge)Gd._addCombineBatchRenderObjTest(Gj)?(Gi=Gj._staticBatch)!==Gd&&(Gi&&Gi._deleteCombineBatchRenderObj(Gj),Gd._addCombineBatchRenderObj(Gj)):(Ge=!1,Gf++);else{var Gl=this._initBatchRenderElements[Gg-1],Go=Gl.renderObj,Gp=Gj.renderObj;Ge=!(65535<Go._getVertexBuffer().vertexCount+Gp._getVertexBuffer().vertexCount)&&(Gd=this._getStaticBatch(Ga,Gc,Gb,Gf),(Gi=Gl._staticBatch)!==Gd&&(Gi&&Gi._deleteCombineBatchRenderObj(Gl),Gd._addCombineBatchRenderObj(Gl)),(Gi=Gj._staticBatch)!==Gd&&(Gi&&Gi._deleteCombineBatchRenderObj(Gj),Gd._addCombineBatchRenderObj(Gj)),!0)}else Ge=!1,Gf=0;Gb=Gj._material,Gc=Gk.vertexDeclaration}},Gq._sortPrepareStaticBatch=function(Ga,Gb){var Gc=Ga._render,Gd=Gb._render,Ge=Gc.lightmapIndex-Gd.lightmapIndex;if(0!=Ge)return Ge;var Gf=Gc.receiveShadow-Gd.receiveShadow;if(0!=Gf)return Gf;var Gg=Ga._mainSortID-Gb._mainSortID;return 0==Gg?Ga.renderObj.triangleCount-Gb.renderObj.triangleCount:Gg},Gq}(),GCb=function(Ga){function Gf(Ga,Gb,Gc,Gd,Ge){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,Gf.__super.call(this,Ga,Gb,Gc),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=Gd,this._material=Ge}Gp(Gf,"laya.d3.graphics.SubMeshStaticBatch",Gea);var Gb=Gf.prototype;return Gb._compareBatchRenderElement=function(Ga,Gb){return Ga._batchIndexStart>Gb._batchIndexStart},Gb._addCombineBatchRenderObjTest=function(Ga){var Gb=Ga.renderObj._vertexCount;return!(65535<(0<Gb?this._currentCombineVertexCount+Gb:this._currentCombineVertexCount+Ga.renderObj._getVertexBuffer().vertexCount))},Gb._addCombineBatchRenderObj=function(Ga){var Gb=Ga.renderObj,Gc=Gb._vertexCount;this._initBatchRenderElements.push(Ga),Ga._staticBatch=this,0<Gc?(this._currentCombineIndexCount+=Gb._indexCount,this._currentCombineVertexCount+=Gc):(this._currentCombineIndexCount=this._currentCombineIndexCount+Gb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+Gb._getVertexBuffer().vertexCount),this._needFinishCombine=!0},Gb._deleteCombineBatchRenderObj=function(Ga){var Gb=Ga.renderObj,Gc=this._initBatchRenderElements.indexOf(Ga);if(-1!==Gc){this._initBatchRenderElements.splice(Gc,1),Ga._staticBatch=null;var Gd=Gb._vertexCount;0<Gd?(this._currentCombineIndexCount=this._currentCombineIndexCount-Gb._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-Gd):(this._currentCombineIndexCount=this._currentCombineIndexCount-Gb._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-Gb._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},Gb._finishInit=function(){if(this._needFinishCombine){var Ga=0,Gb=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var Gc=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),Gd=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=GOb.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=GNb.create("ushort",this._currentCombineIndexCount,35044);for(var Ge=0,Gf=this._initBatchRenderElements.length;Ge<Gf;Ge++){var Gg=this._initBatchRenderElements[Ge],Gh=Gg.renderObj,Gi=Gh._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,Gg._sprite3D),Gj=Gh.getIndices(),Gk=Gg._sprite3D.transform._isFrontFaceInvert,Gl=Ga/(this._vertexDeclaration.vertexStride/4)-Gh._vertexStart,Go=Gb,Gp=Go+Gj.length;Gg._batchIndexStart=Go,Gg._batchIndexEnd=Gp,Gd.set(Gj,Gb);var Gq=0;if(Gk)for(Gq=Go;Gq<Gp;Gq+=3){Gd[Gq]=Gl+Gd[Gq];var Gr=Gd[Gq+1],Gs=Gd[Gq+2];Gd[Gq+1]=Gl+Gs,Gd[Gq+2]=Gl+Gr}else for(Gq=Go;Gq<Gp;Gq+=3)Gd[Gq]=Gl+Gd[Gq],Gd[Gq+1]=Gl+Gd[Gq+1],Gd[Gq+2]=Gl+Gd[Gq+2];Gb+=Gj.length,Gc.set(Gi,Ga),Ga+=Gi.length}this._vertexBuffer.setData(Gc),this._indexBuffer.setData(Gd),this._needFinishCombine=!1}},Gb._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new Gzb)},Gb._getRenderElement=function(Ga,Gb,Gc){for(var Gd,Ge,Gf=this._batchRenderElements.length,Gg=!0,Gh=0;Gh<Gf;Gh++){var Gi,Gj,Gk=(Ge=this._batchRenderElements[Gh])._sprite3D._render;if(0!==Gh&&(Gg=(Gi=(Gd=this._batchRenderElements[Gh-1])._sprite3D._render).lightmapIndex!==Gk.lightmapIndex||Gi.receiveShadow!==Gk.receiveShadow||Gd._batchIndexEnd!==Ge._batchIndexStart),Gg){(Gj=this._getCombineRenderElementFromPool()).renderObj=this,Gj._material=this._material,Gj._batchIndexStart=Ge._batchIndexStart,Gj._batchIndexEnd=Ge._batchIndexEnd;var Gl=Gk.lightmapIndex,Go=Gl+1,Gp=this._batchOwnerIndices[Go];Gp||(Gp=this._batchOwnerIndices[Go]=[]);var Gq,Gr=Gp[Ge._render.receiveShadow?1:0];void 0===Gr?(Gp[Gk.receiveShadow?1:0]=this._batchOwners.length,(Gq=new GXb(null,"StaticBatchMeshSprite3D"))._scene=Gb,Gq._transform=this._rootOwner?this._rootOwner._transform:null,Gq._render.lightmapIndex=Gl,Gq._render.receiveShadow=Ge._render.receiveShadow,this._batchOwners.push(Gq)):Gq=this._batchOwners[Gr],Gq._render._renderUpdate(Gc),Gj._sprite3D=Gq,Ga.push(Gj)}else Gj._batchIndexEnd=Ge._batchIndexEnd}},Gb._beforeRender=function(Ga){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Gb._render=function(Ga){var Gb=Ga.renderElement,Gc=Gb._batchIndexStart,Gd=Gb._batchIndexEnd-Gc;GF.mainContext.drawElements(4,Gd,5123,2*Gc),GA.drawCall++,GA.trianglesFaces+=Gd/3},Gb.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},Gb._getVertexBuffer=function(Ga){return void 0===Ga&&(Ga=0),this._vertexBuffer},Gf}(),GDb=function(Ga){function Gb(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,Gb.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}Gp(Gb,"laya.d3.core.ComponentNode",Gj);var Gc=Gb.prototype;return Gc.addComponent=function(Ga){var Gb,Gc=this._componentsMap.indexOf(Ga);if(-1===Gc)Gb=[],this._componentsMap.push(Ga),this._typeComponentsIndices.push(Gb);else if(Gb=this._typeComponentsIndices[Gc],this._components[Gb[0]].isSingleton)throw new Error("无法单实例创建"+Ga+"组件，"+Ga+"组件已存在！");var Gd=Ge.getInstance(Ga);return Gb.push(this._components.length),this._components.push(Gd),Gd instanceof laya.d3.component.Script&&this._scripts.push(Gd),Gd._initialize(this),Gd},Gc._removeComponent=function(Ga,Gb){var Gc=this._typeComponentsIndices[Ga],Gd=Gc[Gb],Ge=this._components[Gd];this._components.splice(Gd,1),Ge instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(Ge),1),Gc.splice(Gb,1),0===Gc.length&&(this._typeComponentsIndices.splice(Ga,1),this._componentsMap.splice(Ga,1));for(var Gf=0,Gg=this._componentsMap.length;Gf<Gg;Gf++)for(var Gh=(Gc=this._typeComponentsIndices[Gf]).length-1;0<=Gh;Gh--){var Gi=Gc[Gh];if(!(Gd<Gi))break;Gc[Gh]=--Gi}Ge._destroy()},Gc.getComponentByType=function(Ga,Gb){void 0===Gb&&(Gb=0);var Gc=this._componentsMap.indexOf(Ga);return-1===Gc?null:this._components[this._typeComponentsIndices[Gc][Gb]]},Gc.getComponentsByType=function(Ga,Gb){var Gc=this._componentsMap.indexOf(Ga);if(-1!==Gc){var Gd=this._typeComponentsIndices[Gc],Ge=Gd.length;Gb.length=Ge;for(var Gf=0;Gf<Ge;Gf++)Gb[Gf]=this._components[Gd[Gf]]}else Gb.length=0},Gc.getComponentByIndex=function(Ga){return this._components[Ga]},Gc.removeComponentByType=function(Ga,Gb){void 0===Gb&&(Gb=0);var Gc=this._componentsMap.indexOf(Ga);-1!==Gc&&this._removeComponent(Gc,Gb)},Gc.removeComponentsByType=function(Ga){var Gb=this._componentsMap.indexOf(Ga);if(-1!==Gb)for(var Gc=this._typeComponentsIndices[Gb],Gd=0,Ge=Gc.length;Gd<Ge;Gc.length<Ge?Ge--:Gd++)this._removeComponent(Gb,Gd)},Gc.removeAllComponent=function(){for(var Ga=0,Gb=this._componentsMap.length;Ga<Gb;this._componentsMap.length<Gb?Gb--:Ga++)this.removeComponentsByType(this._componentsMap[Ga])},Gc._updateComponents=function(Ga){for(var Gb=0,Gc=this._components.length;Gb<Gc;Gb++){var Gd=this._components[Gb];!Gd.started&&(Gd._start(Ga),Gd.started=!0),Gd.enable&&Gd._update(Ga)}},Gc._lateUpdateComponents=function(Ga){for(var Gb=0;Gb<this._components.length;Gb++){var Gc=this._components[Gb];!Gc.started&&(Gc._start(Ga),Gc.started=!0),Gc.enable&&Gc._lateUpdate(Ga)}},Gc._preRenderUpdateComponents=function(Ga){for(var Gb=0;Gb<this._components.length;Gb++){var Gc=this._components[Gb];!Gc.started&&(Gc._start(Ga),Gc.started=!0),Gc.enable&&Gc._preRenderUpdate(Ga)}},Gc._postRenderUpdateComponents=function(Ga){for(var Gb=0;Gb<this._components.length;Gb++){var Gc=this._components[Gb];!Gc.started&&(Gc._start(Ga),Gc.started=!0),Gc.enable&&Gc._postRenderUpdate(Ga)}},Gb}(),GEb=function(Gd){function Ga(){Ga.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new Gob,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new Ghb(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}Gp(Ga,"laya.d3.core.material.BaseMaterial",Gd);var Gb=Ga.prototype;return Gx.imps(Gb,{"laya.d3.core.IClone":!0}),Gb._addShaderDefine=function(Ga){this._shaderDefineValue|=Ga},Gb._removeShaderDefine=function(Ga){this._shaderDefineValue&=~Ga},Gb._addDisablePublicShaderDefine=function(Ga){this._disablePublicShaderDefine|=Ga},Gb._removeDisablePublicShaderDefine=function(Ga){this._disablePublicShaderDefine&=~Ga},Gb._setBuffer=function(Ga,Gb){this._shaderValues.setValue(Ga,Gb),this._values[Ga]=Gb},Gb._getBuffer=function(Ga){return this._values[Ga]},Gb._setMatrix4x4=function(Ga,Gb){this._shaderValues.setValue(Ga,Gb?Gb.elements:null),this._values[Ga]=Gb},Gb._getMatrix4x4=function(Ga){return this._values[Ga]},Gb._setInt=function(Ga,Gb){this._shaderValues.setValue(Ga,Gb),this._values[Ga]=Gb},Gb._getInt=function(Ga){return this._values[Ga]},Gb._setNumber=function(Ga,Gb){this._shaderValues.setValue(Ga,Gb),this._values[Ga]=Gb},Gb._getNumber=function(Ga){return this._values[Ga]},Gb._setBool=function(Ga,Gb){this._shaderValues.setValue(Ga,Gb),this._values[Ga]=Gb},Gb._getBool=function(Ga){return this._values[Ga]},Gb._setVector2=function(Ga,Gb){this._shaderValues.setValue(Ga,Gb?Gb.elements:null),this._values[Ga]=Gb},Gb._getVector2=function(Ga){return this._values[Ga]},Gb._setColor=function(Ga,Gb){this._shaderValues.setValue(Ga,Gb?Gb.elements:null),this._values[Ga]=Gb},Gb._getColor=function(Ga){return this._values[Ga]},Gb._setTexture=function(Ga,Gb){var Gc=this._values[Ga];this._values[Ga]=Gb,this._shaderValues.setValue(Ga,Gb),0<this.referenceCount&&(Gc&&Gc._removeReference(),Gb&&Gb._addReference())},Gb._getTexture=function(Ga){return this._values[Ga]},Gb._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},Gb._getShader=function(Ga,Gb,Gc){var Gd=(Ga|Gb)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(Gd,Gc,this._shaderDefineValue),this._shader},Gb._setRenderStateBlendDepth=function(){var Ga=GF.mainContext;switch(GG.setDepthMask(Ga,this.depthWrite),0===this.depthTest?GG.setDepthTest(Ga,!1):(GG.setDepthTest(Ga,!0),GG.setDepthFunc(Ga,this.depthTest)),this.blend){case 0:GG.setBlend(Ga,!1);break;case 1:GG.setBlend(Ga,!0),GG.setBlendFunc(Ga,this.srcBlend,this.dstBlend);break;case 2:GG.setBlend(Ga,!0)}},Gb._setRenderStateFrontFace=function(Ga,Gb){var Gc=GF.mainContext,Gd=0;switch(this.cull){case 0:GG.setCullFace(Gc,!1);break;case 1:GG.setCullFace(Gc,!0),Gd=Ga?Gb&&Gb._isFrontFaceInvert?2305:2304:Gb&&Gb._isFrontFaceInvert?2304:2305,GG.setFrontFace(Gc,Gd);break;case 2:GG.setCullFace(Gc,!0),Gd=Ga?Gb&&Gb._isFrontFaceInvert?2304:2305:Gb&&Gb._isFrontFaceInvert?2305:2304,GG.setFrontFace(Gc,Gd)}},Gb.onAsynLoaded=function(Ga,Gb,Gc){var Gd=Gb[0],Ge=Gb[1];switch(Gd.version){case"LAYAMATERIAL:01":var Gf=0,Gg=0,Gh=Gd.props;for(var Gi in Gh)switch(Gi){case"vectors":var Gj=Gh[Gi];for(Gf=0,Gg=Gj.length;Gf<Gg;Gf++){var Gk=Gj[Gf],Gl=Gk.value;switch(Gl.length){case 2:this[Gk.name]=new Gfb(Gl[0],Gl[1]);break;case 3:this[Gk.name]=new Ggb(Gl[0],Gl[1],Gl[2]);break;case 4:this[Gk.name]=new Ghb(Gl[0],Gl[1],Gl[2],Gl[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var Go=Gh[Gi];for(Gf=0,Gg=Go.length;Gf<Gg;Gf++){var Gp=Go[Gf],Gq=Gp.path;Gq&&(this[Gp.name]=Gt.getRes(Ge[Gq]))}break;case"defines":var Gr=Gh[Gi];for(Gf=0,Gg=Gr.length;Gf<Gg;Gf++){var Gs=this._shaderCompile.getMaterialDefineByName(Gr[Gf]);this._addShaderDefine(Gs)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[Gi]=Gh[Gi];break;case"renderQueue":switch(Gh[Gi]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[Gi]=Gh[Gi]}break;case"LAYAMATERIAL:02":for(Gi in Gh=Gd.props)switch(Gi){case"vectors":for(Gf=0,Gg=(Gj=Gh[Gi]).length;Gf<Gg;Gf++)switch((Gl=(Gk=Gj[Gf]).value).length){case 2:this[Gk.name]=new Gfb(Gl[0],Gl[1]);break;case 3:this[Gk.name]=new Ggb(Gl[0],Gl[1],Gl[2]);break;case 4:this[Gk.name]=new Ghb(Gl[0],Gl[1],Gl[2],Gl[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(Gf=0,Gg=(Go=Gh[Gi]).length;Gf<Gg;Gf++)(Gq=(Gp=Go[Gf]).path)&&(this[Gp.name]=Gt.getRes(Ge[Gq]));break;case"defines":for(Gf=0,Gg=(Gr=Gh[Gi]).length;Gf<Gg;Gf++)Gs=this._shaderCompile.getMaterialDefineByName(Gr[Gf]),this._addShaderDefine(Gs);break;default:this[Gi]=Gh[Gi]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},Gb._addReference=function(){Gd.prototype._addReference.call(this);for(var Ga=0,Gb=this._values.length;Ga<Gb;Ga++){var Gc=this._values[Ga];Gc&&Gc instanceof laya.d3.resource.BaseTexture&&Gc._addReference()}},Gb._removeReference=function(){Gd.prototype._removeReference.call(this);for(var Ga=0,Gb=this._values.length;Ga<Gb;Ga++){var Gc=this._values[Ga];Gc&&Gc instanceof laya.d3.resource.BaseTexture&&Gc._removeReference()}},Gb.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},Gb.setShaderName=function(Ga){var Gb=GLb.nameKey.getID(Ga);if(-1===Gb)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=GAb._preCompileShader[Gb]},Gb.cloneTo=function(Ga){var Gb=Ga;Gb.name=this.name,Gb.cull=this.cull,Gb.blend=this.blend,Gb.srcBlend=this.srcBlend,Gb.dstBlend=this.dstBlend,Gb.srcBlendRGB=this.srcBlendRGB,Gb.dstBlendRGB=this.dstBlendRGB,Gb.srcBlendAlpha=this.srcBlendAlpha,Gb.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(Gb.blendConstColor),Gb.blendEquation=this.blendEquation,Gb.blendEquationRGB=this.blendEquationRGB,Gb.blendEquationAlpha=this.blendEquationAlpha,Gb.depthTest=this.depthTest,Gb.depthWrite=this.depthWrite,Gb.renderQueue=this.renderQueue,Gb._shader=this._shader,Gb._disablePublicShaderDefine=this._disablePublicShaderDefine,Gb._shaderDefineValue=this._shaderDefineValue;var Gc,Gd=0,Ge=Gb._shaderValues;Gb._shaderValues.data.length=this._shaderValues.data.length;var Gf=this._values.length,Gg=Gb._values;for(Gd=0,Gc=Gg.length=Gf;Gd<Gc;Gd++){var Gh=this._values[Gd];if(Gh)if("number"==typeof Gh)Gg[Gd]=Gh,Ge.data[Gd]=Gh;else if("number"==typeof Gh&&Math.floor(Gh)==Gh)Gg[Gd]=Gh,Ge.data[Gd]=Gh;else if("boolean"==typeof Gh)Gg[Gd]=Gh,Ge.data[Gd]=Gh;else if(Gh instanceof laya.d3.math.Vector2){var Gi=Gg[Gd]||(Gg[Gd]=new Gfb);Gh.cloneTo(Gi),Ge.data[Gd]=Gi.elements}else if(Gh instanceof laya.d3.math.Vector3){var Gj=Gg[Gd]||(Gg[Gd]=new Ggb);Gh.cloneTo(Gj),Ge.data[Gd]=Gj.elements}else if(Gh instanceof laya.d3.math.Vector4){var Gk=Gg[Gd]||(Gg[Gd]=new Ghb);Gh.cloneTo(Gk),Ge.data[Gd]=Gk.elements}else if(Gh instanceof laya.d3.math.Matrix4x4){var Gl=Gg[Gd]||(Gg[Gd]=new Gab);Gh.cloneTo(Gl),Ge.data[Gd]=Gl.elements}else Gh instanceof laya.d3.resource.BaseTexture&&(Gg[Gd]=Gh,Ge.data[Gd]=Gh)}},Gb.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gq(0,Gb,"alphaTestValue",function(){return this._getNumber(0)},function(Ga){this._setNumber(0,Ga)}),Gq(0,Gb,"alphaTest",function(){return this._alphaTest},function(Ga){(this._alphaTest=Ga)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),Ga.__init__=function(){Ga.SHADERDEFINE_ALPHATEST=Ga.shaderDefines.registerDefine("ALPHATEST")},Ga.RENDERQUEUE_OPAQUE=2e3,Ga.RENDERQUEUE_ALPHATEST=2450,Ga.RENDERQUEUE_TRANSPARENT=3e3,Ga.CULL_NONE=0,Ga.CULL_FRONT=1,Ga.CULL_BACK=2,Ga.BLEND_DISABLE=0,Ga.BLEND_ENABLE_ALL=1,Ga.BLEND_ENABLE_SEPERATE=2,Ga.BLENDPARAM_ZERO=0,Ga.BLENDPARAM_ONE=1,Ga.BLENDPARAM_SRC_COLOR=768,Ga.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,Ga.BLENDPARAM_DST_COLOR=774,Ga.BLENDPARAM_ONE_MINUS_DST_COLOR=775,Ga.BLENDPARAM_SRC_ALPHA=770,Ga.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,Ga.BLENDPARAM_DST_ALPHA=772,Ga.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,Ga.BLENDPARAM_SRC_ALPHA_SATURATE=776,Ga.BLENDEQUATION_ADD=0,Ga.BLENDEQUATION_SUBTRACT=1,Ga.BLENDEQUATION_REVERSE_SUBTRACT=2,Ga.DEPTHTEST_OFF=0,Ga.DEPTHTEST_NEVER=512,Ga.DEPTHTEST_LESS=513,Ga.DEPTHTEST_EQUAL=514,Ga.DEPTHTEST_LEQUAL=515,Ga.DEPTHTEST_GREATER=516,Ga.DEPTHTEST_NOTEQUAL=517,Ga.DEPTHTEST_GEQUAL=518,Ga.DEPTHTEST_ALWAYS=519,Ga.SHADERDEFINE_ALPHATEST=1,Ga.ALPHATESTVALUE=0,Gl(Ga,["shaderDefines",function(){return this.shaderDefines=new Gkb}]),Ga}(Gs),GFb=function(Ga){function Gb(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,Gb.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}Gp(Gb,"laya.d3.resource.BaseTexture",Gs);var Gc=Gb.prototype;return Gq(0,Gc,"width",function(){return this._width}),Gq(0,Gc,"repeat",function(){return this._repeat},function(Ga){if(this._repeat!==Ga&&(this._repeat=Ga,this._source)){var Gb=GF.mainContext;GG.bindTexture(Gb,this._type,this._source),Gw.isPOT(this._width,this._height)&&this._repeat?(Gb.texParameteri(this._type,10242,10497),Gb.texParameteri(this._type,10243,10497)):(Gb.texParameteri(this._type,10242,33071),Gb.texParameteri(this._type,10243,33071))}}),Gq(0,Gc,"height",function(){return this._height}),Gq(0,Gc,"magFifter",function(){return this._magFifter},function(Ga){(this._magFifter=Ga)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(Ga)}),Gq(0,Gc,"wrapModeV",function(){return this._wrapModeV}),Gq(0,Gc,"size",function(){return this._size}),Gq(0,Gc,"wrapModeU",function(){return this._wrapModeU}),Gq(0,Gc,"mipmap",function(){return this._mipmap},function(Ga){this._mipmap=Ga,this._mipmap!=Ga&&this._conchTexture&&this._conchTexture.setMipMap(Ga)}),Gq(0,Gc,"minFifter",function(){return this._minFifter},function(Ga){this._minFifter=Ga,this._minFifter!=Ga&&this._conchTexture&&this._conchTexture.setMinFifter(Ga)}),Gq(0,Gc,"format",function(){return this._format}),Gq(0,Gc,"source",function(){return this.activeResource(),this._source}),Gq(0,Gc,"defaulteTexture",function(){return GSb.grayTexture}),Gb.WARPMODE_REPEAT=0,Gb.WARPMODE_CLAMP=1,Gb}(),GGb=function(Ga){function Gb(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,Gb.__super.call(this),this._boundingBoxCorners=Gd(8,null)}Gp(Gb,"laya.d3.resource.models.BaseMesh",Gs);var Gc=Gb.prototype;return Gc._getPositions=function(){throw new Error("未Override,请重载该属性！")},Gc._generateBoundingObject=function(){this._boundingSphere=new G_a(new Ggb,0),G_a.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new GZa(new Ggb,new Ggb),GZa.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},Gc.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},Gc.getRenderElement=function(Ga){throw new Error("未Override,请重载该属性！")},Gq(0,Gc,"subMeshCount",function(){return this._subMeshCount}),Gq(0,Gc,"boundingBox",function(){return this._boundingBox}),Gq(0,Gc,"boundingBoxCorners",function(){return this._boundingBoxCorners}),Gq(0,Gc,"boundingSphere",function(){return this._boundingSphere}),Gb}(),GHb=(function(Ga){function Gb(){Gb.__super.call(this)}Gp(Gb,"laya.d3.component.Script",Gvb);var Gc=Gb.prototype;Gc.onTriggerEnter=function(Ga){},Gc.onTriggerExit=function(Ga){},Gc.onTriggerStay=function(Ga){},Gq(0,Gc,"isSingleton",function(){return Gb._isSingleton}),Gb._isSingleton=!1}(),function(Ga){function Gb(Ga){this._owner=null,this._sharedMesh=null,Gb.__super.call(this),this._owner=Ga}Gp(Gb,"laya.d3.core.MeshFilter",Ga);var Gc=Gb.prototype;return Gc._sharedMeshLoaded=function(){this.event("loaded")},Gc._destroy=function(){Ga.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},Gq(0,Gc,"sharedMesh",function(){return this._sharedMesh},function(Ga){var Gb=this._sharedMesh;Gb&&Gb._removeReference(),(this._sharedMesh=Ga)._addReference(),this.event("meshchanged",[this,Gb,Ga]),Ga.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),Gq(0,Gc,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),Gq(0,Gc,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),Gq(0,Gc,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),Gq(0,Gc,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),Gb}(Gwb)),GIb=function(Ga){function Gb(Ga){Gb.__super.call(this,Ga),Ga.meshFilter.on("meshchanged",this,this._onMeshChanged)}Gp(Gb,"laya.d3.core.MeshRender",Gxb);var Gc=Gb.prototype;return Gc._onMeshChanged=function(Ga,Gb,Gc){Gc.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:Gc.once("loaded",this,this._onMeshLoaed)},Gc._onMeshLoaed=function(Ga,Gb){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},Gc._calculateBoundingSphereByInitSphere=function(Ga){var Gb=NaN,Gc=this._owner.transform,Gd=Gc.scale.elements,Ge=Math.abs(Gd[0]),Gf=Math.abs(Gd[1]),Gg=Math.abs(Gd[2]);Gb=Gf<=Ge&&Gg<=Ge?Ge:Gg<=Gf?Gf:Gg,Ggb.transformCoordinate(Ga.center,Gc.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=Ga.radius*Gb},Gc._calculateBoundBoxByInitCorners=function(Ga){for(var Gb=this._owner.transform.worldMatrix,Gc=0;Gc<8;Gc++)Ggb.transformCoordinate(Ga[Gc],Gb,Gxb._tempBoundBoxCorners[Gc]);GZa.createfromPoints(Gxb._tempBoundBoxCorners,this._boundingBox)},Gc._calculateBoundingSphere=function(){var Ga=this._owner.meshFilter.sharedMesh;null==Ga||null==Ga.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(Ga.boundingSphere)},Gc._calculateBoundingBox=function(){var Ga=this._owner.meshFilter.sharedMesh;null==Ga||null==Ga.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(Ga.boundingBoxCorners)},Gc._renderUpdate=function(Ga){var Gb=this._owner.transform;if(Gb){this._setShaderValueMatrix4x4(0,Gb.worldMatrix);var Gc=this._owner.getProjectionViewWorldMatrix(Ga);this._setShaderValueMatrix4x4(1,Gc)}else this._setShaderValueMatrix4x4(0,Gab.DEFAULT),this._setShaderValueMatrix4x4(1,Ga);return Gtb.debugMode&&this._renderRenderableBoundBox(),!0},Gb}(),GJb=function(Gb){function Gd(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,Gd.__super.call(this),this._renderState=new GY,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new Gob,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new Gba,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new Ggb(.7,.7,.7),this.ambientColor=new Ggb(.212,.227,.259),GF.shaderHighPrecision&&this.addShaderDefine(GAb.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}Gp(Gd,"laya.d3.core.scene.Scene",Gb);var Ga=Gd.prototype;return Gx.imps(Ga,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),Ga._setUrl=function(Ga){this._url=Ga},Ga._getGroup=function(){return this._group},Ga._setGroup=function(Ga){this._group=Ga},Ga._display=function(){Gx.stage._scenes.push(this),Gx.stage._scenes.sort(Gd._sortScenes);for(var Ga=0,Gb=this._childs.length;Ga<Gb;Ga++){var Gc=this._childs[Ga];Gc.active&&Gc._activeHierarchy()}},Ga._unDisplay=function(){var Ga=Gx.stage._scenes;Ga.splice(Ga.indexOf(this),1);for(var Gb=0,Gc=this._childs.length;Gb<Gc;Gb++){var Gd=this._childs[Gb];Gd.active&&Gd._inActiveHierarchy()}},Ga._addChild3D=function(Ga){Ga.transform._onWorldTransform(),Ga._setBelongScene(this),this.displayedInStage&&Ga.active&&Ga._activeHierarchy()},Ga._removeChild3D=function(Ga){Ga.transform.parent=null,this.displayedInStage&&Ga.active&&Ga._inActiveHierarchy(),Ga._setUnBelongScene()},Ga.initOctree=function(Ga,Gb,Gc,Gd,Ge){void 0===Ge&&(Ge=6),this.treeSize=new Ggb(Ga,Gb,Gc),this.treeLevel=Ge,this.treeRoot=new GZ(this,0),this.treeRoot.init(Gd,this.treeSize)},Ga._prepareUpdateToRenderState=function(Ga,Gb){Gb.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,Gb.scene=this},Ga._prepareSceneToRender=function(Ga){var Gb=this._lights.length;if(0<Gb)for(var Gc=0,Gd=0;Gd<Gb&&!(this._lights[Gd]._prepareToScene(Ga)&&++Gc>=this._enableLightCount);Gd++);},Ga._updateChilds=function(Ga){for(var Gb=0,Gc=this._childs.length;Gb<Gc;++Gb)this._childs[Gb]._update(Ga)},Ga._preRenderScene=function(Ga,Gb,Gc){var Gd,Ge=Gb._viewMatrix,Gf=Gb._projectionMatrix,Gg=Gb._projectionViewMatrix,Gh=0,Gi=Gb.camera;for(Gi.useOcclusionCulling?this.treeRoot?Gca.renderObjectCullingOctree(Gc,this,Gi,Ge,Gf,Gg):Gca.renderObjectCulling(Gc,this,Gi,Ge,Gf,Gg):Gca.renderObjectCullingNoBoundFrustum(this,Gi,Ge,Gf,Gg),Gh=0,Gd=this._quenes.length;Gh<Gd;Gh++)this._quenes[Gh]&&this._quenes[Gh]._preRender(Gb)},Ga._clear=function(Ga,Gb){var Gc=Gb._viewport,Gd=Gb.camera,Ge=Gc.x,Gf=Gd.renderTargetSize.height-Gc.y-Gc.height,Gg=Gc.width,Gh=Gc.height;Ga.viewport(Ge,Gf,Gg,Gh);var Gi=256,Gj=Gd.renderTarget;switch(Gd.clearFlag){case 0:var Gk=Gd.clearColor;if(Gk){Ga.enable(3089),Ga.scissor(Ge,Gf,Gg,Gh);var Gl=Gk.elements;Ga.clearColor(Gl[0],Gl[1],Gl[2],Gl[3]),Gi|=16384}if(Gj)switch(Gk||(Gi=16384),Gj.depthStencilFormat){case 33189:Gi|=256;break;case 36168:Gi|=1024;break;case 34041:Gi|=256,Gi|=1024}Ga.clear(Gi),Gk&&Ga.disable(3089);break;case 1:case 2:if(Gj)switch(Gi=16384,Gj.depthStencilFormat){case 33189:Gi|=256;break;case 36168:Gi|=1024;break;case 34041:Gi|=256,Gi|=1024}Ga.clear(Gi);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},Ga._renderScene=function(Ga,Gb){var Gc,Gd,Ge=Gb.camera,Gf=0;for(Gf=0;Gf<2;Gf++)(Gd=this._quenes[Gf])&&(Ge.renderTarget?Gd._render(Gb,!0):Gd._render(Gb,!1));if(1===Ge.clearFlag){var Gg=Ge.sky;Gg&&(GG.setCullFace(Ga,!1),GG.setDepthFunc(Ga,515),GG.setDepthMask(Ga,!1),Gg._render(Gb),GG.setDepthFunc(Ga,513),GG.setDepthMask(Ga,!0))}for(Gf=2,Gc=this._quenes.length;Gf<Gc;Gf++)(Gd=this._quenes[Gf])&&(Gd._sortAlpha(Gb.camera.transform.position),Ge.renderTarget?Gd._render(Gb,!0):Gd._render(Gb,!1))},Ga._set3DRenderConfig=function(Ga){Ga.disable(3042),GG._blend=!1,Ga.blendFunc(770,771),GG._sFactor=770,GG._dFactor=771,Ga.disable(2929),GG._depthTest=!1,Ga.enable(2884),GG._cullFace=!0,Ga.depthMask(1),GG._depthMask=!0,Ga.frontFace(2304),GG._frontFace=2304},Ga._set2DRenderConfig=function(Ga){GG.setBlend(Ga,!0),GG.setBlendFunc(Ga,1,771),GG.setDepthTest(Ga,!1),GG.setCullFace(Ga,!1),GG.setDepthMask(Ga,!0),GG.setFrontFace(Ga,2305),Ga.viewport(0,0,Gk.width,Gk.height)},Ga._parseCustomProps=function(Ga,Gb,Gc,Gd){var Ge=Gd.customProps.lightmaps,Gf=Ge.length,Gg=this._lightmaps;Gg.length=Gf;for(var Gh=0;Gh<Gf;Gh++)Gg[Gh]=Gt.getRes(Gb[Ge[Gh].replace(".exr",".png")]);this.setlightmaps(Gg);var Gi=Gd.customProps.ambientColor;Gi&&(this.ambientColor=new Ggb(Gi[0],Gi[1],Gi[2]));var Gj=Gd.customProps.fogColor;Gj&&(this.fogColor=new Ggb(Gj[0],Gj[1],Gj[2]))},Ga._addLight=function(Ga){this._lights.indexOf(Ga)<0&&this._lights.push(Ga)},Ga._removeLight=function(Ga){var Gb=this._lights.indexOf(Ga);0<=Gb&&this._lights.splice(Gb,1)},Ga._updateScene=function(){var Ga=this._renderState;this._prepareUpdateToRenderState(GF.mainContext,Ga),this._updateComponents(Ga),this._updateChilds(Ga),this._lateUpdateComponents(Ga),this._time+=Ga.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},Ga._updateSceneConch=function(){var Ga=this._renderState;this._prepareUpdateToRenderState(GF.mainContext,Ga),this._updateComponents(Ga),this._lateUpdateComponents(Ga),this._prepareSceneToRender(Ga);for(var Gb=0,Gc=this._cameraPool.length;Gb<Gc;Gb++){var Gd=this._cameraPool[Gb];(Ga.camera=Gd)._prepareCameraToRender()}},Ga._preRenderShadow=function(Ga,Gb,Gc,Gd,Ge){this.treeRoot?Gca.renderShadowObjectCullingOctree(this,Gb,Gc,Gd,Ge):Gca.renderShadowObjectCulling(this,Gb,Gc,Gd,Ge);for(var Gf=0,Gg=Gc.length;Gf<Gg;Gf++)Gc[Gf]&&Gc[Gf]._preRender(Ga)},Ga._renderShadowMap=function(Ga,Gb,Gc){var Gd=this.parallelSplitShadowMaps[0];Gd._calcAllLightCameraInfo(Gc);var Ge,Gf,Gg,Gh=Gd.PSSMNum;if(this._preRenderShadow(Gb,Gd._lightCulling,Gd._shadowQuenes,Gd._lightVPMatrix[0],Gh),this.addShaderDefine(Gpb.SHADERDEFINE_CAST_SHADOW),1<Gh)for(var Gi=0;Gi<Gh;Gi++)Ge=Gd.getRenderTarget(Gi+1),Gd.beginRenderTarget(Gi+1),Ga.clearColor(1,1,1,1),Ga.clear(16640),Ga.viewport(0,0,Ge.width,Ge.height),Gb.camera=Gg=Gd.getLightCamera(Gi),Gg._prepareCameraToRender(),Gg._prepareCameraViewProject(Gg.viewMatrix,Gg.projectionMatrix),Gb._projectionViewMatrix=Gd._lightVPMatrix[Gi+1],(Gf=Gd._shadowQuenes[Gi])._preRender(Gb),Gf._renderShadow(Gb,!1),Gd.endRenderTarget(Gi+1);else Ge=Gd.getRenderTarget(1),Gd.beginRenderTarget(1),Ga.clearColor(1,1,1,1),Ga.clear(16640),Ga.viewport(0,0,Ge.width,Ge.height),Gb.camera=Gg=Gd.getLightCamera(0),Gg._prepareCameraToRender(),Gg._prepareCameraViewProject(Gg.viewMatrix,Gg.projectionMatrix),Gb._projectionViewMatrix=Gd._lightVPMatrix[0],(Gf=Gd._shadowQuenes[0])._preRender(Gb),Gf._renderShadow(Gb,!0),Gd.endRenderTarget(1);this.removeShaderDefine(Gpb.SHADERDEFINE_CAST_SHADOW)},Ga.addTreeNode=function(Ga){this.treeRoot.addTreeNode(Ga)},Ga.removeTreeNode=function(Ga){this.treeSize&&Ga._treeNode&&Ga._treeNode.removeObject(Ga)},Ga.setlightmaps=function(Ga){this._lightmaps=Ga;for(var Gb=0,Gc=this._renderableSprite3Ds.length;Gb<Gc;Gb++)this._renderableSprite3Ds[Gb]._render._applyLightMapParams()},Ga.getlightmaps=function(){return this._lightmaps},Ga.addChildAt=function(Ga,Gb){if(!(Ga instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(Ga&&Ga.__className));if(!Ga||this.destroyed||Ga===this)return Ga;if(Ga.zOrder&&this._set$P("hasZorder",!0),0<=Gb&&Gb<=this._childs.length){if(Ga._parent===this){var Gc=this.getChildIndex(Ga);this._childs.splice(Gc,1),this._childs.splice(Gb,0,Ga),this.conchModel&&(this.conchModel.removeChild(Ga.conchModel),this.conchModel.addChildAt(Ga.conchModel,Gb)),this._childChanged()}else Ga.parent&&Ga.parent.removeChild(Ga),this._childs===Gj.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Gb,0,Ga),this.conchModel&&this.conchModel.addChildAt(Ga.conchModel,Gb),(Ga.parent=this)._addChild3D(Ga);return Ga}throw new Error("appendChildAt:The index is out of bounds")},Ga.addChild=function(Ga){if(!(Ga instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Ga||this.destroyed||Ga===this)return Ga;if(Ga.zOrder&&this._set$P("hasZorder",!0),Ga._parent===this){var Gb=this.getChildIndex(Ga);Gb!==this._childs.length-1&&(this._childs.splice(Gb,1),this._childs.push(Ga),this.conchModel&&(this.conchModel.removeChild(Ga.conchModel),this.conchModel.addChildAt(Ga.conchModel,this._childs.length-1)),this._childChanged())}else Ga.parent&&Ga.parent.removeChild(Ga),this._childs===Gj.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Ga),this.conchModel&&this.conchModel.addChildAt(Ga.conchModel,this._childs.length-1),(Ga.parent=this)._childChanged(),this._addChild3D(Ga);return Ga},Ga.removeChildAt=function(Ga){var Gb=this.getChildAt(Ga);return Gb&&(this._removeChild3D(Gb),this._childs.splice(Ga,1),this.conchModel&&this.conchModel.removeChild(Gb.conchModel),Gb.parent=null),Gb},Ga.removeChildren=function(Ga,Gb){if(void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=2147483647),this._childs&&0<this._childs.length){var Gc=this._childs;if(0===Ga&&Gf<=Gb){var Gd=Gc;this._childs=Gj.ARRAY_EMPTY}else Gd=Gc.splice(Ga,Gb-Ga);for(var Ge=0,Gf=Gd.length;Ge<Gf;Ge++)this._removeChild3D(Gd[Ge]),Gd[Ge].parent=null,this.conchModel&&this.conchModel.removeChild(Gd[Ge].conchModel)}return this},Ga.addFrustumCullingObject=function(Ga){this.treeRoot?this.addTreeNode(Ga):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(Ga):this._cullingRenders[this._cullingRendersLength]=Ga,Ga._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},Ga.removeFrustumCullingObject=function(Ga){if(this.treeRoot)this.removeTreeNode(Ga);else{this._cullingRendersLength--;var Gb=Ga._indexInSceneFrustumCullingObjects;if(Gb!==this._cullingRendersLength){var Gc=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[Gb]=Gc)._indexInSceneFrustumCullingObjects=Gb,Ga._indexInSceneFrustumCullingObjects=-1}}},Ga.getRenderQueue=function(Ga){return Ga<3e3?this._quenes[1]||(this._quenes[1]=new GX(this)):this._quenes[2]||(this._quenes[2]=new GX(this))},Ga.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new GX(this)},Ga.addShaderDefine=function(Ga){this._shaderDefineValue|=Ga},Ga.removeShaderDefine=function(Ga){this._shaderDefineValue&=~Ga},Ga.addScript=function(Ga){return this._addComponent(Ga)},Ga.getScriptByType=function(Ga,Gb){return void 0===Gb&&(Gb=0),this._getComponentByType(Ga,Gb)},Ga.getScriptsByType=function(Ga,Gb){this._getComponentsByType(Ga,Gb)},Ga.getScriptByIndex=function(Ga){return this._getComponentByIndex(Ga)},Ga.removeScriptByType=function(Ga,Gb){void 0===Gb&&(Gb=0),this._removeComponentByType(Ga,Gb)},Ga.removeScriptsByType=function(Ga){this._removeComponentByType(Ga)},Ga.removeAllScript=function(){this._removeAllComponent()},Ga.render=function(Ga,Gb,Gc){(Gr._context.ctx._renderKey=0)<this._childs.length&&Ga.addRenderObject(this)},Ga.renderSubmit=function(){var Ga=GF.mainContext,Gb=this._renderState;this._set3DRenderConfig(Ga),this._prepareSceneToRender(this._renderState);var Gc,Gd=0,Ge=0;if(Gtb.debugMode||GZ.debugMode)for(Gd=0,Ge=this._cameraPool.length;Gd<Ge;Gd++)Gc=this._cameraPool[Gd],Gtb._debugPhasorSprite.begin(1,Gc),Gc.activeInHierarchy&&Gc._renderCamera(Ga,Gb,this),Gtb._debugPhasorSprite.end();else for(Gd=0,Ge=this._cameraPool.length;Gd<Ge;Gd++)(Gc=this._cameraPool[Gd]).activeInHierarchy&&Gc._renderCamera(Ga,Gb,this);return this._set2DRenderConfig(Ga),1},Ga.onAsynLoaded=function(Ga,Gb,Gc){var Gd=Gb[0];if("Scene"!==Gd.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var Ge=Gb[1];Gsb._createNodeByJson(this,Gd,this,Ge),this.event("hierarchyloaded",[this]),this.__loaded=!0},Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),this.destroyed||(Gb.prototype.destroy.call(this,Ga),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,Gt.clearRes(this.url),this.loaded||Gtb._cancelLoadByUrl(this.url))},Ga.getRenderType=function(){return 0},Ga.releaseRender=function(){},Ga._addComponent=function(Ga){var Gb,Gc=this._componentsMap.indexOf(Ga);if(-1===Gc)Gb=[],this._componentsMap.push(Ga),this._typeComponentsIndices.push(Gb);else if(Gb=this._typeComponentsIndices[Gc],this._components[Gb[0]].isSingleton)throw new Error("无法单实例创建"+Ga+"组件，"+Ga+"组件已存在！");var Gd=Ge.getInstance(Ga);Gb.push(this._components.length),this._components.push(Gd);return Gd._initialize(this),Gd},Ga._removeComponent=function(Ga,Gb){var Gc=this._typeComponentsIndices[Ga],Gd=Gc[Gb],Ge=this._components[Gd];this._components.splice(Gd,1),Gc.splice(Gb,1),0===Gc.length&&(this._typeComponentsIndices.splice(Ga,1),this._componentsMap.splice(Ga,1));for(var Gf=0,Gg=this._componentsMap.length;Gf<Gg;Gf++)for(var Gh=(Gc=this._typeComponentsIndices[Gf]).length-1;0<=Gh;Gh--){var Gi=Gc[Gh];if(!(Gd<Gi))break;Gc[Gh]=--Gi}Ge._destroy()},Ga._getComponentByType=function(Ga,Gb){void 0===Gb&&(Gb=0);var Gc=this._componentsMap.indexOf(Ga);return-1===Gc?null:this._components[this._typeComponentsIndices[Gc][Gb]]},Ga._getComponentsByType=function(Ga,Gb){var Gc=this._componentsMap.indexOf(Ga);if(-1!==Gc){var Gd=this._typeComponentsIndices[Gc],Ge=Gd.length;Gb.length=Ge;for(var Gf=0;Gf<Ge;Gf++)Gb[Gf]=this._components[Gd[Gf]]}else Gb.length=0},Ga._getComponentByIndex=function(Ga){return this._components[Ga]},Ga._removeComponentByType=function(Ga,Gb){void 0===Gb&&(Gb=0);var Gc=this._componentsMap.indexOf(Ga);-1!==Gc&&this._removeComponent(Gc,Gb)},Ga._removeComponentsByType=function(Ga){var Gb=this._componentsMap.indexOf(Ga);if(-1!==Gb)for(var Gc=this._typeComponentsIndices[Gb],Gd=0,Ge=Gc.length;Gd<Ge;Gc.length<Ge?Ge--:Gd++)this._removeComponent(Gb,Gd)},Ga._removeAllComponent=function(){for(var Ga=0,Gb=this._componentsMap.length;Ga<Gb;this._componentsMap.length<Gb?Gb--:Ga++)this._removeComponentsByType(this._componentsMap[Ga])},Ga._updateComponents=function(Ga){for(var Gb=0,Gc=this._components.length;Gb<Gc;Gb++){var Gd=this._components[Gb];!Gd.started&&(Gd._start(Ga),Gd.started=!0),Gd.enable&&Gd._update(Ga)}},Ga._lateUpdateComponents=function(Ga){for(var Gb=0;Gb<this._components.length;Gb++){var Gc=this._components[Gb];!Gc.started&&(Gc._start(Ga),Gc.started=!0),Gc.enable&&Gc._lateUpdate(Ga)}},Ga._preRenderUpdateComponents=function(Ga){for(var Gb=0;Gb<this._components.length;Gb++){var Gc=this._components[Gb];!Gc.started&&(Gc._start(Ga),Gc.started=!0),Gc.enable&&Gc._preRenderUpdate(Ga)}},Ga._postRenderUpdateComponents=function(Ga){for(var Gb=0;Gb<this._components.length;Gb++){var Gc=this._components[Gb];!Gc.started&&(Gc._start(Ga),Gc.started=!0),Gc.enable&&Gc._postRenderUpdate(Ga)}},Gq(0,Ga,"_loaded",null,function(Ga){this.__loaded=Ga}),Gq(0,Ga,"fogColor",function(){return this._fogColor},function(Ga){this._fogColor=Ga,this._shaderValues.setValue(0,Ga.elements)}),Gq(0,Ga,"enableFog",function(){return this._enableFog},function(Ga){this._enableFog!==Ga&&((this._enableFog=Ga)?(this.addShaderDefine(GAb.SHADERDEFINE_FOG),this.removeShaderDefine(GAb.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(GAb.SHADERDEFINE_FOG))}),Gq(0,Ga,"url",function(){return this._url}),Gq(0,Ga,"loaded",function(){return this.__loaded}),Gq(0,Ga,"enableDepthFog",function(){return this._enableDepthFog},function(Ga){this._enableDepthFog!=Ga&&((this._enableDepthFog=Ga)?(this.addShaderDefine(GAb.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(GAb.SHADERDEFINE_FOG)):this.removeShaderDefine(GAb.SAHDERDEFINE_DEPTHFOG))}),Gq(0,Ga,"fogStart",function(){return this._fogStart},function(Ga){this._fogStart=Ga,this._shaderValues.setValue(1,Ga)}),Gq(0,Ga,"fogRange",function(){return this._fogRange},function(Ga){this._fogRange=Ga,this._shaderValues.setValue(2,Ga)}),Gq(0,Ga,"ambientColor",function(){return this._ambientColor},function(Ga){this._ambientColor=Ga,this._shaderValues.setValue(21,Ga.elements)}),Gq(0,Ga,"scene",function(){return this}),Gq(0,Ga,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),Gd._sortScenes=function(Ga,Gb){if(Ga.parent!==Gx.stage||Gb.parent!==Gx.stage)return Ga.parent!==Gx.stage&&Gb.parent!==Gx.stage?Gd._sortScenes(Ga.parent,Gb.parent):Ga.parent===Gx.stage?-1:1;var Gc=Gx.stage._childs;return Gc.indexOf(Ga)-Gc.indexOf(Gb)},Gd.load=function(Ga){return Gx.loader.create(Ga,null,null,Gd)},Gd.FOGCOLOR=0,Gd.FOGSTART=1,Gd.FOGRANGE=2,Gd.LIGHTDIRECTION=3,Gd.LIGHTDIRCOLOR=4,Gd.POINTLIGHTPOS=5,Gd.POINTLIGHTRANGE=6,Gd.POINTLIGHTATTENUATION=7,Gd.POINTLIGHTCOLOR=8,Gd.SPOTLIGHTPOS=9,Gd.SPOTLIGHTDIRECTION=10,Gd.SPOTLIGHTSPOT=11,Gd.SPOTLIGHTRANGE=12,Gd.SPOTLIGHTATTENUATION=13,Gd.SPOTLIGHTCOLOR=14,Gd.SHADOWDISTANCE=15,Gd.SHADOWLIGHTVIEWPROJECT=16,Gd.SHADOWMAPPCFOFFSET=17,Gd.SHADOWMAPTEXTURE1=18,Gd.SHADOWMAPTEXTURE2=19,Gd.SHADOWMAPTEXTURE3=20,Gd.AMBIENTCOLOR=21,Gd.TIME=22,Gd}(Gz),GKb=function(Ga){function Gb(Ga){Gb.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new Gab,this._shaderValues=new Gob,this._colliders=[],this._id=++Gb._uniqueIDCounter,this._transform=new Gyb(this),this.name=Ga||"Sprite3D-"+Gb._nameNumberCounter++,this.layer=GI.currentCreationLayer,this.active=!0}Gp(Gb,"laya.d3.core.Sprite3D",GDb);var Gc=Gb.prototype;return Gx.imps(Gc,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),Gc._setUrl=function(Ga){this._url=Ga},Gc._getGroup=function(){return this._group},Gc._setGroup=function(Ga){this._group=Ga},Gc._addChild3D=function(Ga){Ga.transform.parent=this.transform,this._hierarchyAnimator&&(!Ga._hierarchyAnimator&&Ga._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(Ga,!0,[Ga.name])),this._scene&&(Ga._setBelongScene(this._scene),this._activeInHierarchy&&Ga._active&&Ga._activeHierarchy())},Gc._removeChild3D=function(Ga){Ga.transform.parent=null,this._scene&&(this._activeInHierarchy&&Ga._active&&Ga._inActiveHierarchy(),Ga._setUnBelongScene()),this._hierarchyAnimator&&(Ga._hierarchyAnimator==this._hierarchyAnimator&&Ga._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(Ga,!1,[Ga.name]))},Gc._parseBaseCustomProps=function(Ga){var Gb=this.transform.localPosition;Ga.translate?(Gb.fromArray(Ga.translate),Gb.x*=100,Gb.y*=100,Gb.z*=100):Gb.elements.fill(0),this.transform.localPosition=Gb;var Gc=this.transform.localRotation;Ga.rotation?Gc.fromArray(Ga.rotation):Gc.fromArray([0,0,0,-1]),this.transform.localRotation=Gc;var Gd=this.transform.localScale;Ga.scale?Gd.fromArray(Ga.scale):Gd.elements.fill(1),this.transform.localScale=Gd;var Ge=Ga.layer;null!=Ge&&(this.layer=GI.getLayerByNumber(Ge))},Gc._parseCustomComponent=function(Ga,Gb,Gc){for(var Gd in Gc){var Ge=Gc[Gd];switch(Gd){case"Animator":var Gf=this.addComponent(Animator);if(Ge.avatarPath)Gf.avatar=Gt.getRes(Gb[Ge.avatarPath]);else{var Gg=Ge.avatar;if(Gg){Gf.avatar=Gt.getRes(Gb[Gg.path]);var Gh=Gg.linkSprites;Gh&&Ga.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[Gf,Gh])}}for(var Gi=Ge.clipPaths,Gj=Gi.length,Gk=0;Gk<Gj;Gk++)Gf.addClip(Gt.getRes(Gb[Gi[Gk]]));Gf.clip=Gt.getRes(Gb[Gi[0]]);var Gl=Ge.playOnWake;void 0!==Gl&&(Gf.playOnWake=Gl);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var Go=this.addComponent(SphereCollider);Go.isTrigger=Ge.isTrigger;var Gp=Go.center;Gp.fromArray(Ge.center),Go.center=Gp,Go.radius=Ge.radius;break;case"BoxCollider":var Gq=this.addComponent(BoxCollider);Gq.isTrigger=Ge.isTrigger,Gq.center.fromArray(Ge.center);var Gr=Gq.size;Gr.fromArray(Ge.size),Gq.size=Gr;break;case"MeshCollider":this.addComponent(MeshCollider)}}},Gc._onRootNodeHierarchyLoaded=function(Ga,Gb){for(var Gc in Gb){for(var Gd=this,Ge=Gb[Gc],Gf=0,Gg=Ge.length;Gf<Gg;Gf++){var Gh=Ge[Gf];if(""===Gh)break;if(!(Gd=Gd.getChildByName(Gh)))break}Gd&&Ga.linkSprite3DToAvatarNode(Gc,Gd)}},Gc._setHierarchyAnimator=function(Ga,Gb){this._changeHierarchyAnimator(Ga);for(var Gc=0,Gd=this._childs.length;Gc<Gd;Gc++){var Ge=this._childs[Gc];Ge._hierarchyAnimator==Gb&&Ge._setHierarchyAnimator(Ga,Gb)}},Gc._clearHierarchyAnimator=function(Ga,Gb){this._changeHierarchyAnimator(Gb);for(var Gc=0,Gd=this._childs.length;Gc<Gd;Gc++){var Ge=this._childs[Gc];Ge._hierarchyAnimator==Ga&&Ge._clearHierarchyAnimator(Ga,Gb)}},Gc._getAnimatorToLinkSprite3D=function(Ga,Gb,Gc){var Gd=this.getComponentByType(Animator);if(Gd&&(Gd.avatar?Gd.avatar._version||Ga._setAnimatorToLinkAvatar(Gd,Gb):Ga._setAnimatorToLinkSprite3DNoAvatar(Gd,Gb,Gc)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){Gc.unshift(this._parent.name);var Ge=this._parent;Ge._hierarchyAnimator&&Ge._getAnimatorToLinkSprite3D(Ga,Gb,Gc)}},Gc._setAnimatorToLinkSprite3DNoAvatar=function(Ga,Gb,Gc){var Gd=0,Ge=0;for(Gd=0,Ge=Ga.getClipCount();Gd<Ge;Gd++)Ga._handleSpriteOwnersBySprite(Gd,Gb,Gc,this);for(Gd=0,Ge=this._childs.length;Gd<Ge;Gd++){var Gf=this._childs[Gd],Gg=Gc.length;Gc.push(Gf.name),Gf._setAnimatorToLinkSprite3DNoAvatar(Ga,Gb,Gc),Gc.splice(Gg,1)}},Gc._changeHierarchyAnimator=function(Ga){this._hierarchyAnimator=Ga},Gc._isLinkSpriteToAnimationNode=function(Ga,Gb,Gc){var Gd=Ga._avatarNodes.indexOf(Gb),Ge=Ga._cacheSpriteToNodesMap;if(Gc)this._transform.dummy=Gb.transform,Ga._cacheNodesToSpriteMap[Gd]=Ge.length,Ge.push(Gd);else{this._transform.dummy=null;var Gf=Ga._cacheNodesToSpriteMap[Gd];Ga._cacheNodesToSpriteMap[Gd]=null,Ge.splice(Gf,1)}},Gc._setBelongScene=function(Ga){this._scene=Ga;for(var Gb=0,Gc=this._childs.length;Gb<Gc;Gb++)this._childs[Gb]._setBelongScene(Ga)},Gc._setUnBelongScene=function(){this._scene=null;for(var Ga=0,Gb=this._childs.length;Ga<Gb;Ga++)this._childs[Ga]._setUnBelongScene()},Gc._activeHierarchy=function(){var Ga=0,Gb=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),Ga=0,Gb=this._colliders.length;Ga<Gb;Ga++)this._layer._addCollider(this._colliders[Ga]);for(this.event("activeinhierarchychanged",!0),Ga=0,Gb=this._childs.length;Ga<Gb;Ga++){var Gc=this._childs[Ga];Gc._active&&Gc._activeHierarchy()}},Gc._inActiveHierarchy=function(){var Ga=0,Gb=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),Ga=0,Gb=this._colliders.length;Ga<Gb;Ga++){var Gc=this._colliders[Ga];Gc._clearCollsionMap(),this._layer._removeCollider(Gc)}for(this.event("activeinhierarchychanged",!1),Ga=0,Gb=this._childs.length;Ga<Gb;Ga++){var Gd=this._childs[Ga];Gd._active&&Gd._inActiveHierarchy()}},Gc.addComponent=function(Ga){var Gb,Gc=this._componentsMap.indexOf(Ga);if(-1===Gc)Gb=[],this._componentsMap.push(Ga),this._typeComponentsIndices.push(Gb);else if(Gb=this._typeComponentsIndices[Gc],this._components[Gb[0]].isSingleton)throw new Error("无法单实例创建"+Ga+"组件，"+Ga+"组件已存在！");var Gd=Ge.getInstance(Ga);return Gb.push(this._components.length),this._components.push(Gd),Gd instanceof laya.d3.component.Script&&this._scripts.push(Gd),Gd._initialize(this),Gd},Gc._removeComponent=function(Ga,Gb){var Gc,Gd=0,Ge=this._typeComponentsIndices[Ga],Gf=Ge[Gb],Gg=this._components[Gf];for(Gg instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(Gg),1),Ge.splice(Gb,1),0===Ge.length&&(this._typeComponentsIndices.splice(Ga,1),this._componentsMap.splice(Ga,1)),Gd=0,Gc=this._componentsMap.length;Gd<Gc;Gd++)for(var Gh=(Ge=this._typeComponentsIndices[Gd]).length-1;0<=Gh;Gh--){var Gi=Ge[Gh];if(!(Gf<Gi))break;Ge[Gh]=--Gi}Gg._destroy()},Gc._clearSelfRenderObjects=function(){},Gc._addSelfRenderObjects=function(){},Gc._parseCustomProps=function(Ga,Gb,Gc,Gd){},Gc._updateChilds=function(Ga){var Gb=this._childs.length;if(0!==Gb)for(var Gc=0;Gc<Gb;++Gc)this._childs[Gc]._update(Ga)},Gc._getSortID=function(Ga,Gb){return 1e3*Gb.id+Ga._getVertexBuffer().vertexDeclaration.id},Gc._update=function(Ga){(Ga.owner=this)._activeInHierarchy&&(this._updateComponents(Ga),this._lateUpdateComponents(Ga),GA.spriteCount++,this._childs.length&&this._updateChilds(Ga))},Gc.getProjectionViewWorldMatrix=function(Ga){return Gab.multiply(Ga,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},Gc.loadHierarchy=function(Ga){this.addChild(laya.d3.core.Sprite3D.load(Ga))},Gc.addChildAt=function(Ga,Gb){if(!(Ga instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Ga||this.destroyed||Ga===this)return Ga;if(Ga.zOrder&&this._set$P("hasZorder",!0),0<=Gb&&Gb<=this._childs.length){if(Ga._parent===this){var Gc=this.getChildIndex(Ga);this._childs.splice(Gc,1),this._childs.splice(Gb,0,Ga),this.conchModel&&(this.conchModel.removeChild(Ga.conchModel),this.conchModel.addChildAt(Ga.conchModel,Gb)),this._childChanged()}else Ga.parent&&Ga.parent.removeChild(Ga),this._childs===Gj.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(Gb,0,Ga),this.conchModel&&this.conchModel.addChildAt(Ga.conchModel,Gb),(Ga.parent=this)._addChild3D(Ga);return Ga}throw new Error("appendChildAt:The index is out of bounds")},Gc.addChild=function(Ga){if(!(Ga instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!Ga||this.destroyed||Ga===this)return Ga;if(Ga.zOrder&&this._set$P("hasZorder",!0),Ga._parent===this){var Gb=this.getChildIndex(Ga);Gb!==this._childs.length-1&&(this._childs.splice(Gb,1),this._childs.push(Ga),this.conchModel&&(this.conchModel.removeChild(Ga.conchModel),this.conchModel.addChildAt(Ga.conchModel,this._childs.length-1)),this._childChanged())}else Ga.parent&&Ga.parent.removeChild(Ga),this._childs===Gj.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(Ga),this.conchModel&&this.conchModel.addChildAt(Ga.conchModel,this._childs.length-1),(Ga.parent=this)._childChanged(),this._addChild3D(Ga);return Ga},Gc.removeChildAt=function(Ga){var Gb=this.getChildAt(Ga);return Gb&&(this._removeChild3D(Gb),this._childs.splice(Ga,1),this.conchModel&&this.conchModel.removeChild(Gb.conchModel),Gb.parent=null),Gb},Gc.removeChildren=function(Ga,Gb){if(void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=2147483647),this._childs&&0<this._childs.length){var Gc=this._childs;if(0===Ga&&Gf<=Gb){var Gd=Gc;this._childs=Gj.ARRAY_EMPTY}else Gd=Gc.splice(Ga,Gb-Ga);for(var Ge=0,Gf=Gd.length;Ge<Gf;Ge++)this._removeChild3D(Gd[Ge]),Gd[Ge].parent=null,this.conchModel&&this.conchModel.removeChild(Gd[Ge].conchModel)}return this},Gc.onAsynLoaded=function(Ga,Gb,Gc){var Gd=Gb[0];if("Sprite3D"!==Gd.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var Ge=Gb[1];Gsb._createNodeByJson(this,Gd,this,Ge),this.event("hierarchyloaded",[this]),this.__loaded=!0},Gc.cloneTo=function(Ga){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var Gb=Ga;Gb.name=this.name,Gb._destroyed=this._destroyed,Gb.timer=this.timer,Gb._$P=this._$P,Gb.active=this._active;var Gc=Gb.transform.localPosition;this.transform.localPosition.cloneTo(Gc),Gb.transform.localPosition=Gc;var Gd=Gb.transform.localRotation;this.transform.localRotation.cloneTo(Gd),Gb.transform.localRotation=Gd;var Ge=Gb.transform.localScale;this.transform.localScale.cloneTo(Ge),Gb.transform.localScale=Ge,Gb.isStatic=this.isStatic;var Gf=0,Gg=0;for(Gf=0,Gg=this._componentsMap.length;Gf<Gg;Gf++){var Gh=Gb.addComponent(this._componentsMap[Gf]);this._components[Gf]._cloneTo(Gh)}for(Gf=0,Gg=this._childs.length;Gf<Gg;Gf++)Gb.addChild(this._childs[Gf].clone());var Gi=Gb.getComponentByType(Animator);if(Gi){var Gj=Gi._linkSpritesData;if(Gj)for(var Gk in Gj){for(var Gl=Gj[Gk],Go=Gb,Gp=0,Gq=Gl.length;Gp<Gq&&(Go=Go.getChildByName(Gl[Gp]));Gp++);if(Go){var Gr=Gi._avatarNodeMap[Gk];Go._isLinkSpriteToAnimationNode(Gi,Gr,!0)}}}},Gc.clone=function(){var Ga=new this.constructor;return this.cloneTo(Ga),Ga},Gc.destroy=function(Ga){if(void 0===Ga&&(Ga=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,Ga);var Gb,Gc=0;for(Gc=0,Gb=this._components.length;Gc<Gb;Gc++)this._components[Gc]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,Gt.clearRes(this.url),this.loaded||Gtb._cancelLoadByUrl(this.url)}},Gc._handleSpriteToAvatar=function(Ga,Gb){Ga._avatarNodes;var Gc=Ga._avatarNodeMap[this.name];Gc&&Gc.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(Ga,Gc,Gb)},Gc._setAnimatorToLinkAvatar=function(Ga,Gb){this._handleSpriteToAvatar(Ga,Gb);for(var Gc=0,Gd=this._childs.length;Gc<Gd;Gc++){this._childs[Gc]._setAnimatorToLinkAvatar(Ga,Gb)}},Gq(0,Gc,"activeInHierarchy",function(){return this._activeInHierarchy}),Gq(0,Gc,"_loaded",null,function(Ga){this.__loaded=Ga}),Gq(0,Gc,"active",function(){return this._active},function(Ga){this._active!==Ga&&(this._active=Ga,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(Ga?this._activeHierarchy():this._inActiveHierarchy()))}),Gq(0,Gc,"componentsCount",function(){return this._components.length}),Gq(0,Gc,"loaded",function(){return this.__loaded}),Gq(0,Gc,"id",function(){return this._id}),Gq(0,Gc,"url",function(){return this._url}),Gq(0,Gc,"layer",function(){return this._layer},function(Ga){if(this._layer!==Ga){if(!Ga)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var Gb=0,Gc=this._colliders.length;if(this._layer)for(Gb=0;Gb<Gc;Gb++)this._layer._removeCollider(this._colliders[Gb]);for(Gb=0;Gb<Gc;Gb++)Ga._addCollider(this._colliders[Gb])}this._layer=Ga,this.event("layerchanged",Ga)}}),Gq(0,Gc,"scene",function(){return this._scene}),Gq(0,Gc,"transform",function(){return this._transform}),Gb.instantiate=function(Ga,Gb,Gc,Gd,Ge){void 0===Gc&&(Gc=!0);var Gf=Ga.clone();Gb&&Gb.addChild(Gf);var Gg=Gf.transform;if(Gc){var Gh=Gg.worldMatrix;Ga.transform.worldMatrix.cloneTo(Gh),Gg.worldMatrix=Gh}else Gd&&(Gg.position=Gd),Ge&&(Gg.rotation=Ge);return Gf},Gb.load=function(Ga){return Gx.loader.create(Ga,null,null,Gb)},Gb.WORLDMATRIX=0,Gb.MVPMATRIX=1,Gb._uniqueIDCounter=0,Gb._nameNumberCounter=0,Gb}(),GLb=function(Ga){function Gk(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],Gk.__super.call(this),!Ga||!Gb)throw"Shader Error";this._id=++Gk._count,this._vs=Ga,this._ps=Gb,this._attributeMap=Gc,this._sceneUniformMap=Gd,this._cameraUniformMap=Ge,this._spriteUniformMap=Gf,this._materialUniformMap=Gg,this._renderElementUniformMap=Gh,this._precompile=Gi,this._define=Gj,this._precompile&&Gk.extCompileObj&&Gk.extCompileFunc?Gk.extCompileFunc.call(Gk.extCompileObj,Ga,Gb,Gj):this.recreateResource()}Gp(Gk,"laya.d3.shader.Shader3D",Gc);var Gb=Gk.prototype;return Gb.recreateResource=function(){GH.now();this._compile(),this.completeCreate(),this.memorySize=0},Gb.disposeResource=function(){GF.mainContext.deleteShader(this._vshader),GF.mainContext.deleteShader(this._pshader),GF.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},Gb._compile=function(){if(!GF.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var Ga=[this._vs,this._ps],Gb=GF.mainContext;if(this._program=Gb.createProgram(),this._vshader=Gk._createShader(Gb,Ga[0],35633),this._pshader=Gk._createShader(Gb,Ga[1],35632),Gb.attachShader(this._program,this._vshader),Gb.attachShader(this._program,this._pshader),Gb.linkProgram(this._program),!Gr.isConchApp&&GAb.debugMode&&!Gb.getProgramParameter(this._program,35714))throw Gb.getProgramInfoLog(this._program);var Gc,Gd=0,Ge=0,Gf=0;for(Gf=Gr.isConchApp?Gb.getProgramParameterEx(this._vs,this._ps,"",35721):Gb.getProgramParameter(this._program,35721),Gd=0;Gd<Gf;Gd++){var Gg=null;Gc={vartype:"attribute",ivartype:0,attrib:Gg=Gr.isConchApp?Gb.getActiveAttribEx(this._vs,this._ps,"",Gd):Gb.getActiveAttrib(this._program,Gd),location:Gb.getAttribLocation(this._program,Gg.name),name:Gg.name,type:Gg.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(Gc)}var Gh=0;for(Gh=Gr.isConchApp?Gb.getProgramParameterEx(this._vs,this._ps,"",35718):Gb.getProgramParameter(this._program,35718),Gd=0;Gd<Gh;Gd++){var Gi=null;Gi=Gr.isConchApp?Gb.getActiveUniformEx(this._vs,this._ps,"",Gd):Gb.getActiveUniform(this._program,Gd),0<(Gc={vartype:"uniform",ivartype:1,attrib:Gg,location:Gb.getUniformLocation(this._program,Gi.name),name:Gi.name,type:Gi.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(Gc.name=Gc.name.substr(0,Gc.name.length-3),Gc.isArray=!0,Gc.location=Gb.getUniformLocation(this._program,Gc.name)),this._uniformParams.push(Gc)}for(Gd=0,Ge=this._attributeParams.length;Gd<Ge;Gd++)(Gc=this._attributeParams[Gd]).indexOfParams=Gd,Gc.index=1,Gc.value=[Gc.location,null],Gc.codename=Gc.name,Gc.name=null!=this._attributeMap[Gc.codename]?this._attributeMap[Gc.codename]:Gc.codename,this._attributeParamsMap.push(Gc.name),this._attributeParamsMap.push(Gc),Gc._this=this,Gc.uploadedValue=[],Gc.fun=this._attribute;for(Gd=0,Ge=this._uniformParams.length;Gd<Ge;Gd++)switch((Gc=this._uniformParams[Gd]).indexOfParams=Gd,Gc.index=1,Gc.value=[Gc.location,null],Gc.codename=Gc.name,null!=this._sceneUniformMap[Gc.codename]?(Gc.name=this._sceneUniformMap[Gc.codename],this._sceneUniformParamsMap.push(Gc.name),this._sceneUniformParamsMap.push(Gc)):null!=this._cameraUniformMap[Gc.codename]?(Gc.name=this._cameraUniformMap[Gc.codename],this._cameraUniformParamsMap.push(Gc.name),this._cameraUniformParamsMap.push(Gc)):null!=this._spriteUniformMap[Gc.codename]?(Gc.name=this._spriteUniformMap[Gc.codename],this._spriteUniformParamsMap.push(Gc.name),this._spriteUniformParamsMap.push(Gc)):null!=this._materialUniformMap[Gc.codename]?(Gc.name=this._materialUniformMap[Gc.codename],this._materialUniformParamsMap.push(Gc.name),this._materialUniformParamsMap.push(Gc)):null!=this._renderElementUniformMap[Gc.codename]?(Gc.name=this._renderElementUniformMap[Gc.codename],this._renderElementUniformParamsMap.push(Gc.name),this._renderElementUniformParamsMap.push(Gc)):console.log("Shader:can't find uinform name:"+Gc.codename+" in shader file."),Gc._this=this,Gc.uploadedValue=[],Gc.type){case 5124:Gc.fun=Gc.isArray?this._uniform1iv:this._uniform1i;break;case 5126:Gc.fun=Gc.isArray?this._uniform1fv:this._uniform1f;break;case 35664:Gc.fun=Gc.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:Gc.fun=Gc.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:Gc.fun=Gc.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:Gc.fun=this._uniform_sampler2D;break;case 35680:Gc.fun=this._uniform_samplerCube;break;case 35676:Gc.fun=this._uniformMatrix4fv;break;case 35670:Gc.fun=this._uniform1i;break;case 35674:Gc.fun=this._uinformMatrix2fv;break;case 35675:Gc.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},Gb._attribute=function(Ga,Gb){var Gc=GF.mainContext,Gd=Gh._enableAtributes,Ge=Ga.location;return Gd[Ge]||Gc.enableVertexAttribArray(Ge),Gc.vertexAttribPointer(Ge,Gb[0],Gb[1],Gb[2],Gb[3],Gb[4]),Gd[Ge]=Gh._bindVertexBuffer,1},Gb._uniform1f=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb?(GF.mainContext.uniform1f(Ga.location,Gc[0]=Gb),1):0},Gb._uniform1fv=function(Ga,Gb){if(Gb.length<4){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]||Gc[2]!==Gb[2]||Gc[3]!==Gb[3]?(GF.mainContext.uniform1fv(Ga.location,Gb),Gc[0]=Gb[0],Gc[1]=Gb[1],Gc[2]=Gb[2],Gc[3]=Gb[3],1):0}return GF.mainContext.uniform1fv(Ga.location,Gb),1},Gb._uniform_vec2=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]?(GF.mainContext.uniform2f(Ga.location,Gc[0]=Gb[0],Gc[1]=Gb[1]),1):0},Gb._uniform_vec2v=function(Ga,Gb){if(Gb.length<2){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]||Gc[2]!==Gb[2]||Gc[3]!==Gb[3]?(GF.mainContext.uniform2fv(Ga.location,Gb),Gc[0]=Gb[0],Gc[1]=Gb[1],Gc[2]=Gb[2],Gc[3]=Gb[3],1):0}return GF.mainContext.uniform2fv(Ga.location,Gb),1},Gb._uniform_vec3=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]||Gc[2]!==Gb[2]?(GF.mainContext.uniform3f(Ga.location,Gc[0]=Gb[0],Gc[1]=Gb[1],Gc[2]=Gb[2]),1):0},Gb._uniform_vec3v=function(Ga,Gb){return GF.mainContext.uniform3fv(Ga.location,Gb),1},Gb._uniform_vec4=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]||Gc[2]!==Gb[2]||Gc[3]!==Gb[3]?(GF.mainContext.uniform4f(Ga.location,Gc[0]=Gb[0],Gc[1]=Gb[1],Gc[2]=Gb[2],Gc[3]=Gb[3]),1):0},Gb._uniform_vec4v=function(Ga,Gb){return GF.mainContext.uniform4fv(Ga.location,Gb),1},Gb._uniformMatrix2fv=function(Ga,Gb){return GF.mainContext.uniformMatrix2fv(Ga.location,!1,Gb),1},Gb._uniformMatrix3fv=function(Ga,Gb){return GF.mainContext.uniformMatrix3fv(Ga.location,!1,Gb),1},Gb._uniformMatrix4fv=function(Ga,Gb){return GF.mainContext.uniformMatrix4fv(Ga.location,!1,Gb),1},Gb._uinformMatrix2fv=function(Ga,Gb){return GF.mainContext.uniformMatrix2fv(Ga.location,!1,Gb),1},Gb._uinformMatrix3fv=function(Ga,Gb){return GF.mainContext.uniformMatrix3fv(Ga.location,!1,Gb),1},Gb._uniform1i=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb?(GF.mainContext.uniform1i(Ga.location,Gc[0]=Gb),1):0},Gb._uniform1iv=function(Ga,Gb){return GF.mainContext.uniform1iv(Ga.location,Gb),1},Gb._uniform_ivec2=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]?(GF.mainContext.uniform2i(Ga.location,Gc[0]=Gb[0],Gc[1]=Gb[1]),1):0},Gb._uniform_ivec2v=function(Ga,Gb){return GF.mainContext.uniform2iv(Ga.location,Gb),1},Gb._uniform_vec3i=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]||Gc[2]!==Gb[2]?(GF.mainContext.uniform3i(Ga.location,Gc[0]=Gb[0],Gc[1]=Gb[1],Gc[2]=Gb[2]),1):0},Gb._uniform_vec3vi=function(Ga,Gb){return GF.mainContext.uniform3iv(Ga.location,Gb),1},Gb._uniform_vec4i=function(Ga,Gb){var Gc=Ga.uploadedValue;return Gc[0]!==Gb[0]||Gc[1]!==Gb[1]||Gc[2]!==Gb[2]||Gc[3]!==Gb[3]?(GF.mainContext.uniform4i(Ga.location,Gc[0]=Gb[0],Gc[1]=Gb[1],Gc[2]=Gb[2],Gc[3]=Gb[3]),1):0},Gb._uniform_vec4vi=function(Ga,Gb){return GF.mainContext.uniform4iv(Ga.location,Gb),1},Gb._uniform_sampler2D=function(Ga,Gb){var Gc=Gb.source||Gb.defaulteTexture.source,Gd=GF.mainContext,Ge=Ga.uploadedValue;if(null!=Ge[0])return Gd.activeTexture(Gk._TEXTURES[Ge[0]]),Gc&&GG.bindTexture(Gd,3553,Gc),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return Ge[0]=this._curActTexIndex,Gd.uniform1i(Ga.location,this._curActTexIndex),Gd.activeTexture(Gk._TEXTURES[this._curActTexIndex]),Gc&&GG.bindTexture(Gd,3553,Gc),this._curActTexIndex++,1},Gb._uniform_samplerCube=function(Ga,Gb){var Gc=Gb.source||Gb.defaulteTexture.source,Gd=GF.mainContext,Ge=Ga.uploadedValue;if(null!=Ge[0])return Gd.activeTexture(Gk._TEXTURES[Ge[0]]),Gc?GG.bindTexture(Gd,34067,Gc):GG.bindTexture(Gd,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return Ge[0]=this._curActTexIndex,Gd.uniform1i(Ga.location,this._curActTexIndex),Gd.activeTexture(Gk._TEXTURES[this._curActTexIndex]),Gc?GG.bindTexture(Gd,34067,Gc):GG.bindTexture(Gd,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},Gb._noSetValue=function(Ga){console.log("no....:"+Ga.name)},Gb.bind=function(){return Gc.activeShader=this,(Gc.bindShader=this).activeResource(),GG.UseProgram(this._program)},Gb.uploadAttributes=function(Ga,Gb){for(var Gc,Gd,Ge=0,Gf=0,Gg=this._attributeParamsMap.length;Gf<Gg;Gf+=2)Gd=this._attributeParamsMap[Gf+1],null!=(Gc=Ga[this._attributeParamsMap[Gf]])&&(Gb&&Gb[Gd.name]&&Gb[Gd.name].bind(),Ge+=Gd.fun.call(this,Gd,Gc));GA.shaderCall+=Ge},Gb.uploadAttributesX=function(Ga,Gb){for(var Gc,Gd,Ge=0,Gf=0,Gg=this._attributeParamsMap.length;Gf<Gg;Gf+=2)Gd=this._attributeParamsMap[Gf+1],null!=(Gc=Ga[this._attributeParamsMap[Gf]])&&(Gb._bind(),Ge+=Gd.fun.call(this,Gd,Gc));GA.shaderCall+=Ge},Gb.uploadSceneUniforms=function(Ga){for(var Gb,Gc,Gd=0,Ge=0,Gf=this._sceneUniformParamsMap.length;Ge<Gf;Ge+=2)Gc=this._sceneUniformParamsMap[Ge+1],null!=(Gb=Ga[this._sceneUniformParamsMap[Ge]])&&(Gd+=Gc.fun.call(this,Gc,Gb));GA.shaderCall+=Gd},Gb.uploadCameraUniforms=function(Ga){for(var Gb,Gc,Gd=0,Ge=0,Gf=this._cameraUniformParamsMap.length;Ge<Gf;Ge+=2)Gc=this._cameraUniformParamsMap[Ge+1],null!=(Gb=Ga[this._cameraUniformParamsMap[Ge]])&&(Gd+=Gc.fun.call(this,Gc,Gb));GA.shaderCall+=Gd},Gb.uploadSpriteUniforms=function(Ga){for(var Gb,Gc,Gd=0,Ge=0,Gf=this._spriteUniformParamsMap.length;Ge<Gf;Ge+=2)Gc=this._spriteUniformParamsMap[Ge+1],null!=(Gb=Ga[this._spriteUniformParamsMap[Ge]])&&(Gd+=Gc.fun.call(this,Gc,Gb));GA.shaderCall+=Gd},Gb.uploadMaterialUniforms=function(Ga){for(var Gb,Gc,Gd=0,Ge=0,Gf=this._materialUniformParamsMap.length;Ge<Gf;Ge+=2)Gc=this._materialUniformParamsMap[Ge+1],null!=(Gb=Ga[this._materialUniformParamsMap[Ge]])&&(Gd+=Gc.fun.call(this,Gc,Gb));GA.shaderCall+=Gd},Gb.uploadRenderElementUniforms=function(Ga){for(var Gb,Gc,Gd=0,Ge=0,Gf=this._renderElementUniformParamsMap.length;Ge<Gf;Ge+=2)Gc=this._renderElementUniformParamsMap[Ge+1],null!=(Gb=Ga[this._renderElementUniformParamsMap[Ge]])&&(Gd+=Gc.fun.call(this,Gc,Gb));GA.shaderCall+=Gd},Gk.create=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){return new Gk(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj)},Gk.addInclude=function(Ga,Gb){Gv.addInclude(Ga,Gb)},Gk._createShader=function(Ga,Gb,Gc){var Gd=Ga.createShader(Gc);if(Ga.shaderSource(Gd,Gb),Ga.compileShader(Gd),GAb.debugMode&&!Ga.getShaderParameter(Gd,35713))throw Ga.getShaderInfoLog(Gd);return Gd},Gk.PERIOD_RENDERELEMENT=0,Gk.PERIOD_MATERIAL=1,Gk.PERIOD_SPRITE=2,Gk.PERIOD_CAMERA=3,Gk.PERIOD_SCENE=4,Gk._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],Gk._count=0,Gk._preCompile=!1,Gk.extCompileFunc=null,Gk.extCompileObj=null,Gl(Gk,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new GB}]),Gk}(),GMb=function(Gh){function Gi(){this._transformUV=null,Gi.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new Ggb(.6,.6,.6)),this._setColor(10,new Ggb(1,1,1)),this._setColor(11,new Ghb(1,1,1,8)),this._setColor(12,new Ggb(1,1,1)),this._setColor(7,new Ghb(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new Ghb(1,1,0,0)),this.renderMode=1}Gp(Gi,"laya.d3.core.material.StandardMaterial",Gh);var Ga=Gi.prototype;return Ga.disableLight=function(){this._addDisablePublicShaderDefine(GAb.SHADERDEFINE_POINTLIGHT|GAb.SHADERDEFINE_SPOTLIGHT|GAb.SHADERDEFINE_DIRECTIONLIGHT)},Ga.disableFog=function(){this._addDisablePublicShaderDefine(GAb.SHADERDEFINE_FOG)},Ga.onAsynLoaded=function(Ga,Gb,Gc){var Gd=Gb[0];if(Gd.version)Gh.prototype.onAsynLoaded.call(this,Ga,Gb,Gc);else{var Ge=Gb[1],Gf=Gd.props;for(var Gg in Gf)this[Gg]=Gf[Gg];Gi._parseStandardMaterial(Ge,this,Gd),this._endLoaded()}},Ga.cloneTo=function(Ga){Gh.prototype.cloneTo.call(this,Ga);var Gb=Ga;this._transformUV&&(Gb._transformUV=this._transformUV.clone())},Gq(0,Ga,"ambientColor",function(){return this._getColor(9)},function(Ga){this._setColor(9,Ga)}),Gq(0,Ga,"ambientTexture",function(){return this._getTexture(5)},function(Ga){Ga?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,Ga)}),Gq(0,Ga,"renderMode",null,function(Ga){switch(Ga){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(Gi.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(Ga)}),Gq(0,Ga,"reflectColor",function(){return this._getColor(12)},function(Ga){this._setColor(12,Ga)}),Gq(0,Ga,"tilingOffset",function(){return this._getColor(15)},function(Ga){if(Ga){var Gb=Ga.elements;1!=Gb[0]||1!=Gb[1]||0!=Gb[2]||0!=Gb[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,Ga)}),Gq(0,Ga,"albedo",function(){return this._getColor(7)},function(Ga){this._setColor(7,Ga)}),Gq(0,Ga,"diffuseColor",function(){return this._getColor(10)},function(Ga){this._setColor(10,Ga)}),Gq(0,Ga,"albedoColor",function(){return this._getColor(7)},function(Ga){this._setColor(7,Ga)}),Gq(0,Ga,"specularColor",function(){return this._getColor(11)},function(Ga){this._setColor(11,Ga)}),Gq(0,Ga,"diffuseTexture",function(){return this._getTexture(1)},function(Ga){Ga?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,Ga)}),Gq(0,Ga,"normalTexture",function(){return this._getTexture(2)},function(Ga){Ga?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,Ga)}),Gq(0,Ga,"specularTexture",function(){return this._getTexture(3)},function(Ga){Ga?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,Ga)}),Gq(0,Ga,"emissiveTexture",function(){return this._getTexture(4)},function(Ga){Ga?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,Ga)}),Gq(0,Ga,"reflectTexture",function(){return this._getTexture(6)},function(Ga){Ga?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,Ga)}),Gq(0,Ga,"transformUV",function(){return this._transformUV},function(Ga){this._transformUV=Ga,this._setMatrix4x4(13,Ga.matrix),Ga?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,Ga.matrix.elements,0)}),Gi.__init__=function(){Gi.SHADERDEFINE_DIFFUSEMAP=Gi.shaderDefines.registerDefine("DIFFUSEMAP"),Gi.SHADERDEFINE_NORMALMAP=Gi.shaderDefines.registerDefine("NORMALMAP"),Gi.SHADERDEFINE_SPECULARMAP=Gi.shaderDefines.registerDefine("SPECULARMAP"),Gi.SHADERDEFINE_EMISSIVEMAP=Gi.shaderDefines.registerDefine("EMISSIVEMAP"),Gi.SHADERDEFINE_AMBIENTMAP=Gi.shaderDefines.registerDefine("AMBIENTMAP"),Gi.SHADERDEFINE_REFLECTMAP=Gi.shaderDefines.registerDefine("REFLECTMAP"),Gi.SHADERDEFINE_UVTRANSFORM=Gi.shaderDefines.registerDefine("UVTRANSFORM"),Gi.SHADERDEFINE_TILINGOFFSET=Gi.shaderDefines.registerDefine("TILINGOFFSET"),Gi.SHADERDEFINE_ADDTIVEFOG=Gi.shaderDefines.registerDefine("ADDTIVEFOG")},Gi.load=function(Ga){return Gx.loader.create(Ga,null,null,Gi)},Gi._parseStandardMaterial=function(Ga,Gb,Gc){var Gd=Gc.customProps,Ge=Gd.ambientColor;Gb.ambientColor=new Ggb(Ge[0],Ge[1],Ge[2]);var Gf=Gd.diffuseColor;Gb.diffuseColor=new Ggb(Gf[0],Gf[1],Gf[2]);var Gg=Gd.specularColor;Gb.specularColor=new Ghb(Gg[0],Gg[1],Gg[2],Gg[3]);var Gh=Gd.reflectColor;Gb.reflectColor=new Ggb(Gh[0],Gh[1],Gh[2]);var Gi=Gd.albedoColor;Gi&&(Gb.albedo=new Ghb(Gi[0],Gi[1],Gi[2],Gi[3]));var Gj=Gd.diffuseTexture.texture2D;Gj&&(Gb.diffuseTexture=Gt.getRes(Ga[Gj]));var Gk=Gd.normalTexture.texture2D;Gk&&(Gb.normalTexture=Gt.getRes(Ga[Gk]));var Gl=Gd.specularTexture.texture2D;Gl&&(Gb.specularTexture=Gt.getRes(Ga[Gl]));var Go=Gd.emissiveTexture.texture2D;Go&&(Gb.emissiveTexture=Gt.getRes(Ga[Go]));var Gp=Gd.ambientTexture.texture2D;Gp&&(Gb.ambientTexture=Gt.getRes(Ga[Gp]));var Gq=Gd.reflectTexture.texture2D;Gq&&(Gb.reflectTexture=Gt.getRes(Ga[Gq]))},Gi.RENDERMODE_OPAQUE=1,Gi.RENDERMODE_OPAQUEDOUBLEFACE=2,Gi.RENDERMODE_CUTOUT=3,Gi.RENDERMODE_CUTOUTDOUBLEFACE=4,Gi.RENDERMODE_TRANSPARENT=13,Gi.RENDERMODE_TRANSPARENTDOUBLEFACE=14,Gi.RENDERMODE_ADDTIVE=15,Gi.RENDERMODE_ADDTIVEDOUBLEFACE=16,Gi.RENDERMODE_DEPTHREAD_TRANSPARENT=5,Gi.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,Gi.RENDERMODE_DEPTHREAD_ADDTIVE=7,Gi.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,Gi.RENDERMODE_NONDEPTH_TRANSPARENT=9,Gi.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,Gi.RENDERMODE_NONDEPTH_ADDTIVE=11,Gi.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,Gi.SHADERDEFINE_DIFFUSEMAP=0,Gi.SHADERDEFINE_NORMALMAP=0,Gi.SHADERDEFINE_SPECULARMAP=0,Gi.SHADERDEFINE_EMISSIVEMAP=0,Gi.SHADERDEFINE_AMBIENTMAP=0,Gi.SHADERDEFINE_REFLECTMAP=0,Gi.SHADERDEFINE_UVTRANSFORM=0,Gi.SHADERDEFINE_TILINGOFFSET=0,Gi.SHADERDEFINE_ADDTIVEFOG=0,Gi.DIFFUSETEXTURE=1,Gi.NORMALTEXTURE=2,Gi.SPECULARTEXTURE=3,Gi.EMISSIVETEXTURE=4,Gi.AMBIENTTEXTURE=5,Gi.REFLECTTEXTURE=6,Gi.ALBEDO=7,Gi.UVANIAGE=8,Gi.MATERIALAMBIENT=9,Gi.MATERIALDIFFUSE=10,Gi.MATERIALSPECULAR=11,Gi.MATERIALREFLECT=12,Gi.UVMATRIX=13,Gi.UVAGE=14,Gi.TILINGOFFSET=15,Gl(Gi,["defaultMaterial",function(){var Ga=new Gi;return Ga.lock=!0,this.defaultMaterial=Ga},"shaderDefines",function(){return this.shaderDefines=new Gkb(GEb.shaderDefines)}]),Gi}(GEb),GNb=function(Ga){function Gg(Ga,Gb,Gc,Gd,Ge){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===Gc&&(Gc=35044),void 0===Gd&&(Gd=!1),Gg.__super.call(this),this._indexType=Ga,this._indexCount=Gb,this._bufferUsage=Gc,this._bufferType=34963,this._canRead=Gd;var Gf;if("ushort"==Ga)this._indexTypeByteCount=2;else{if("ubyte"!=Ga)throw new Error("unidentification index type.");this._indexTypeByteCount=1}Gf=this._indexTypeByteCount*Gb,this._byteLength=Gf,this._bind(),Gh._gl.bufferData(this._bufferType,Gf,this._bufferUsage),this.uri=Ge,Gd?("ushort"==Ga?this._buffer=new Uint16Array(Gb):"ubyte"==Ga&&(this._buffer=new Uint8Array(Gb)),this.memorySize=2*Gf):this.memorySize=Gf}Gp(Gg,"laya.d3.graphics.IndexBuffer3D",Ga);var Gb=Gg.prototype;return Gb.setData=function(Ga,Gb,Gc,Gd){void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=4294967295);var Ge=0;if("ushort"==this._indexType?(Ge=2,0===Gc&&4294967295===Gd||(Ga=new Uint16Array(Ga.buffer,Gc*Ge,Gd))):"ubyte"==this._indexType&&(Ge=1,0===Gc&&4294967295===Gd||(Ga=new Uint8Array(Ga.buffer,Gc*Ge,Gd))),this._bind(),Gh._gl.bufferSubData(this._bufferType,Gb*Ge,Ga),this._canRead)if(0!==Gb||0!==Gc||4294967295!==Gd){var Gf=this._buffer.length-Gb;Gf<Gd&&(Gd=Gf);for(var Gg=0;Gg<Gd;Gg++)this._buffer[Gb+Gg]=Ga[Gg]}else this._buffer=Ga},Gb.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},Gb.disposeResource=function(){Ga.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},Gq(0,Gb,"indexType",function(){return this._indexType}),Gq(0,Gb,"indexTypeByteCount",function(){return this._indexTypeByteCount}),Gq(0,Gb,"indexCount",function(){return this._indexCount}),Gq(0,Gb,"canRead",function(){return this._canRead}),Gg.INDEXTYPE_UBYTE="ubyte",Gg.INDEXTYPE_USHORT="ushort",Gg.create=function(Ga,Gb,Gc,Gd,Ge){return void 0===Gc&&(Gc=35044),void 0===Gd&&(Gd=!1),new Gg(Ga,Gb,Gc,Gd,Ge)},Gg}(Gh),GOb=function(Gf){function Gg(Ga,Gb,Gc,Gd,Ge){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===Gd&&(Gd=!1),Gg.__super.call(this),this._vertexDeclaration=Ga,this._vertexCount=Gb,this._bufferUsage=Gc,this._bufferType=34962,this._canRead=Gd,this.uri=Ge,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*Gb,this._bind(),Gh._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),Gd&&(this._buffer=new Float32Array(this._byteLength/4))}Gp(Gg,"laya.d3.graphics.VertexBuffer3D",Gf);var Ga=Gg.prototype;return Ga.bindWithIndexBuffer=function(Ga){Ga&&Ga._bind(),this._bind()},Ga.setData=function(Ga,Gb,Gc,Gd){if(void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=4294967295),0===Gc&&4294967295===Gd||(Ga=new Float32Array(Ga.buffer,4*Gc,Gd)),this._bind(),Gh._gl.bufferSubData(this._bufferType,4*Gb,Ga),this._canRead)if(0!==Gb||0!==Gc||4294967295!==Gd){var Ge=this._buffer.length-Gb;Ge<Gd&&(Gd=Ge);for(var Gf=0;Gf<Gd;Gf++)this._buffer[Gb+Gf]=Ga[Gf]}else this._buffer=Ga},Ga.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},Ga.disposeResource=function(){for(var Ga=GF.mainContext,Gb=this._vertexDeclaration.getVertexElements(),Gc=Gh._enableAtributes,Gd=0,Ge=Gb.length;Gd<Ge;Gd++)Gc[Gd]===this._glBuffer&&(Ga.disableVertexAttribArray(Gd),Gc[Gd]=null);Gf.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},Gq(0,Ga,"vertexDeclaration",function(){return this._vertexDeclaration}),Gq(0,Ga,"vertexCount",function(){return this._vertexCount}),Gq(0,Ga,"canRead",function(){return this._canRead}),Gg.create=function(Ga,Gb,Gc,Gd,Ge){return void 0===Gc&&(Gc=35044),void 0===Gd&&(Gd=!1),new Gg(Ga,Gb,Gc,Gd,Ge)},Gg}(Gh),GPb=function(Ga){function Gv(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,Gv.__super.call(this),this._type=3553}Gp(Gv,"laya.d3.resource.DataTexture2D",GFb);var Gb=Gv.prototype;return Gb.genDebugMipmaps=function(){var Ga=[];return Ga.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),Ga.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),Ga.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),Ga.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),Ga.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),Ga.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),Ga.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),Ga.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),Ga.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),Ga.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),Ga},Gb._onTextureLoaded=function(Ga){},Gb._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var Ga=GF.mainContext,Gb=this._source=Ga.createTexture(),Gc=this._width,Gd=this._height,Ge=GG.curBindTexTarget,Gf=GG.curBindTexValue,Gg=!1;if(GG.bindTexture(Ga,this._type,Gb),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var Gh=0;Ga.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var Gi=0;Gi<this._mipmaps.length;Gi++){if(this._mipmaps[Gi].byteLength!=Gj*Gk*4)throw"mipmap size error  level:"+Gi;Ga.texSubImage2D(this._type,0,Gv.simLodRect[Gh++],Gv.simLodRect[Gh++],Gv.simLodRect[Gh++],Gv.simLodRect[Gh++],6408,5121,new Uint8Array(this._mipmaps[Gi]))}this.minFifter=9729,this.magFifter=9729}else{var Gj=this._width,Gk=this._height;for(Gh=0,Ga.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),Gi=0;Gi<this._mipmaps.length;Gi++){if(this._mipmaps[Gi].byteLength!=Gj*Gk*4)throw"mipmap size error  level:"+Gi;Ga.texImage2D(this._type,Gi,6408,Gj,Gk,0,6408,5121,new Uint8Array(this._mipmaps[Gi])),(Gj/=2)<1&&(Gj=1),(Gk/=2)<1&&(Gk=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&Ga.pixelStorei(Ga.UNPACK_ALIGNMENT,1),Ga.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var Gl=0,Go=!1,Gp=!1;this._buffer.byteLength==4*Gc*Gd?(Gl=6408,Go=!0):this._buffer.byteLength==3*Gc*Gd?(Gl=6407,Gp=!0):Gl=this._format,Go||Gp?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),Gp&&Ga.pixelStorei(Ga.UNPACK_ALIGNMENT,1),Ga.texImage2D(this._type,0,Gl,Gc,Gd,0,Gl,5121,this._buffer)):Ga&&Gl==Ga.ALPHA?(Ga.texImage2D(3553,0,Gl,Gc,Gd,0,Gl,Ga.UNSIGNED_BYTE,this._buffer),Gg=!0):0!=Gl&&(Ga.compressedTexImage2D(3553,0,Gl,Gc,Gd,0,this._buffer),Gg=!0)}var Gq=this._minFifter,Gr=this._magFifter,Gs=0==this._wrapModeU?10497:33071,Gt=0==this._wrapModeV?10497:33071,Gu=Gw.isPOT(Gc,Gd);Gu?(this._mipmap||this._mipmaps?-1!==Gq||(Gq=9987):-1!==Gq||(Gq=9729),-1!==Gr||(Gr=9729),Ga.texParameteri(this._type,10241,Gq),Ga.texParameteri(this._type,10240,Gr),Ga.texParameteri(this._type,10242,Gs),Ga.texParameteri(this._type,10243,Gt),this._mipmap&&Ga.generateMipmap(this._type)):(-1!==Gq||(Gq=9729),-1!==Gr||(Gr=9729),Ga.texParameteri(this._type,10241,Gq),Ga.texParameteri(this._type,10240,Gr),Ga.texParameteri(this._type,10242,33071),Ga.texParameteri(this._type,10243,33071)),Ge&&Gf&&GG.bindTexture(Ga,Ge,Gf),this.memorySize=Gg?this._buffer.length:Gu?Gc*Gd*4*(1+1/3):Gc*Gd*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},Gb.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},Gb.onAsynLoaded=function(Ga,Gb,Gc){var Gd;Gc&&(Gd=Gc[0].call(this,Gb)),Gd&&(this._width=Gd.width,this._height=Gd.height,this._buffer=Gd.data),this._src=Ga,this._size=new Grb(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},Gb.getPixels=function(){return new Uint8Array(this._buffer)},Gb.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(GF.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},Gq(0,Gb,"src",function(){return this._src}),Gv.create=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){if(void 0===Gd&&(Gd=9729),void 0===Ge&&(Ge=9729),void 0===Gf&&(Gf=!0),!Ga||Ga.byteLength<Gb*Gc*4)throw"DataTexture2D create error";var Gh=new Gv;return Gh.uri=Gg,Gh._buffer=Ga,Gh._width=Gb,Gh._height=Gc,Gh._mipmap=Gf,Gh._magFifter=Gd,Gh._minFifter=Ge,Gh._size=new Grb(Gh._width,Gh._height),Gh._conchTexture?alert("怎么给runtime传递datatexture数据"):Gh.activeResource(),Gh},Gv.load=function(Ga,Gb,Gc,Gd,Ge){if(void 0===Gb&&(Gb=0),void 0===Gc&&(Gc=0),void 0===Gd&&(Gd=9729),void 0===Ge&&(Ge=9729),"mipmaps"===GC.getFileExtension(Ga)){var Gf=Gx.loader.create(Ga,null,null,Gv,[function(Ga){this._mipmaps=[];var Gb=new Uint32Array(Ga);this._width=Gb[0];var Gc=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,Gc=1024),this._width!=Gc)throw"现在只支持512x256的环境贴图。当前的是"+Gb[0];this._height=Gb[1];for(var Gd=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,Ge=this._height,Gf=8;;){var Gg=Gd*Ge*4;if(Gf+Gg>Ga.byteLength)throw"load mipmaps data size error ";var Gh=new Uint8Array(Ga,Gf,Gg);if(this._mipmaps.push(Gh),Gf+=Gg,1==Gd&&1==Ge)break;(Gd/=2)<1&&(Gd=1),(Ge/=2)<1&&(Ge=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){Gf.simLodInfo=new Float32Array(40);for(var Gg=0;Gg<Gf.simLodInfo.length;)Gf.simLodInfo[Gg]=(Gv.simLodRect[Gg]+.5)/1024,Gg++,Gf.simLodInfo[Gg]=(Gv.simLodRect[Gg]+.5)/256,Gg++,Gf.simLodInfo[Gg]=Math.max(Gv.simLodRect[Gg]-1,.1)/1024,Gg++,Gf.simLodInfo[Gg]=Math.max(Gv.simLodRect[Gg]-1.5,.1)/256,Gg++}return Gf}if("number"==typeof Gb)return Gx.loader.create(Ga,null,null,Gv,[function(Ga){return this._width=Gb,this._height=Gc,this._buffer=Ga,null}]);if("function"==typeof Gb)return Gx.loader.create(Ga,null,null,Gv,[Gb]);throw new Error("unknown params.")},Gv.lodasatlas=!1,Gl(Gv,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),Gv}(),GQb=function(Ga){function Gb(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,Gb.__super.call(this)}Gp(Gb,"laya.d3.resource.models.PrimitiveMesh",GGb);var Gc=Gb.prototype;return Gx.imps(Gc,{"laya.d3.core.render.IRenderable":!0}),Gc._getVertexBuffer=function(Ga){return void 0===Ga&&(Ga=0),0===Ga?this._vertexBuffer:null},Gc._getVertexBuffers=function(){return null},Gc._getIndexBuffer=function(){return this._indexBuffer},Gc._getPositions=function(){var Ga,Gb=[],Gc=this._vertexBuffer.vertexDeclaration.getVertexElements(),Gd=0;for(Gd=0;Gd<Gc.length;Gd++){var Ge=Gc[Gd];if("vector3"===Ge.elementFormat&&0===Ge.elementUsage){Ga=Ge;break}}var Gf=this._vertexBuffer.getData();for(Gd=0;Gd<Gf.length;Gd+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var Gg=Gd+Ga.offset/4,Gh=new Ggb(Gf[Gg+0],Gf[Gg+1],Gf[Gg+2]);Gb.push(Gh)}return Gb},Gc.getRenderElement=function(Ga){return this},Gc.getRenderElementsCount=function(){return 1},Gc.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},Gc._beforeRender=function(Ga){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},Gc._render=function(Ga){GF.mainContext.drawElements(4,this._numberIndices,5123,0),GA.drawCall++,GA.trianglesFaces+=this._numberIndices/3},Gq(0,Gc,"_vertexBufferCount",function(){return 1}),Gq(0,Gc,"triangleCount",function(){return this._indexBuffer.indexCount/3}),Gb}(),GRb=function(Ga){function Gb(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,Gb.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}Gp(Gb,"laya.d3.resource.models.Mesh",GGb);var Gc=Gb.prototype;return Gc._getPositions=function(){var Ga,Gb,Gc,Gd,Ge,Gf=[],Gg=0,Gh=0,Gi=0;if(0!==this._vertexBuffers.length){var Gj=this._vertexBuffers.length;for(Gg=0;Gg<Gj;Gg++){for(Gc=(Ga=this._vertexBuffers[Gg]).vertexDeclaration.getVertexElements(),Gh=0;Gh<Gc.length;Gh++)if("vector3"===(Gd=Gc[Gh]).elementFormat&&0===Gd.elementUsage){Gb=Gd;break}for(Ge=Ga.getData(),Gh=0;Gh<Ge.length;Gh+=Ga.vertexDeclaration.vertexStride/4)Gi=Gh+Gb.offset/4,Gf.push(new Ggb(Ge[Gi+0],Ge[Gi+1],Ge[Gi+2]))}}else{var Gk=this._subMeshes.length;for(Gg=0;Gg<Gk;Gg++){for(Gc=(Ga=this._subMeshes[Gg]._getVertexBuffer()).vertexDeclaration.getVertexElements(),Gh=0;Gh<Gc.length;Gh++)if("vector3"===(Gd=Gc[Gh]).elementFormat&&0===Gd.elementUsage){Gb=Gd;break}for(Ge=Ga.getData(),Gh=0;Gh<Ge.length;Gh+=Ga.vertexDeclaration.vertexStride/4)Gi=Gh+Gb.offset/4,Gf.push(new Ggb(Ge[Gi+0],Ge[Gi+1],Ge[Gi+2]))}}return Gf},Gc._setSubMeshes=function(Ga){this._subMeshes=Ga,this._subMeshCount=Ga.length;for(var Gb=0;Gb<this._subMeshCount;Gb++)Ga[Gb]._indexInMesh=Gb;this._positions=this._getPositions(),this._generateBoundingObject()},Gc.onAsynLoaded=function(Ga,Gb,Gc){var Gd=Gb[0],Ge=Gb[1];GYa.read(Gd,this,this._materials,this._subMeshes,Ge),this.completeCreate(),this._endLoaded()},Gc.getSubMesh=function(Ga){return this._subMeshes[Ga]},Gc.getSubMeshCount=function(){return this._subMeshes.length},Gc.getRenderElementsCount=function(){return this._subMeshes.length},Gc.getRenderElement=function(Ga){return this._subMeshes[Ga]},Gc.disposeResource=function(){for(var Ga=0;Ga<this._subMeshes.length;Ga++)this._subMeshes[Ga].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},Gq(0,Gc,"materials",function(){return this._materials.slice()}),Gq(0,Gc,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),Gb.load=function(Ga){return Gx.loader.create(Ga,null,null,Gb)},Gb}(),GSb=(function(Ga){function Gj(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===Gc&&(Gc=6408),void 0===Gd&&(Gd=5121),void 0===Ge&&(Ge=33189),void 0===Gf&&(Gf=!1),void 0===Gg&&(Gg=!1),void 0===Gh&&(Gh=-1),void 0===Gi&&(Gi=-1),Gj.__super.call(this),this._type=3553,this._width=Ga,this._height=Gb,this._size=new Grb(Ga,Gb),this._surfaceFormat=Gc,this._surfaceType=Gd,this._depthStencilFormat=Ge,Gr.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=Gf,this._repeat=Gg,this._minFifter=Gh,this._magFifter=Gi,this.activeResource(),this._alreadyResolved=!0}Gp(Gj,"laya.d3.resource.RenderTexture",GFb);var Gb=Gj.prototype;Gb.recreateResource=function(){var Ga=GF.mainContext;this._frameBuffer=Ga.createFramebuffer(),this._source=Ga.createTexture();var Gb=GG.curBindTexTarget,Gc=GG.curBindTexValue;GG.bindTexture(Ga,this._type,this._source),Ga.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var Gd=this._minFifter,Ge=this._magFifter,Gf=this._repeat?10497:33071;if(Gw.isPOT(this._width,this._height)?(this._mipmap?-1!==Gd||(Gd=9987):-1!==Gd||(Gd=9729),-1!==Ge||(Ge=9729),Ga.texParameteri(this._type,10241,Gd),Ga.texParameteri(this._type,10240,Ge),Ga.texParameteri(this._type,10242,Gf),Ga.texParameteri(this._type,10243,Gf),this._mipmap&&Ga.generateMipmap(this._type)):(-1!==Gd||(Gd=9729),-1!==Ge||(Ge=9729),Ga.texParameteri(this._type,10241,Gd),Ga.texParameteri(this._type,10240,Ge),Ga.texParameteri(this._type,10242,33071),Ga.texParameteri(this._type,10243,33071)),Gb&&Gc&&GG.bindTexture(Ga,Gb,Gc),Ga.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=Ga.createRenderbuffer(),Ga.bindRenderbuffer(36161,this._depthStencilBuffer),Ga.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),Ga.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:Ga.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:Ga.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:Ga.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}Ga.framebufferTexture2D(36160,36064,3553,this._source,0),Ga.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},Gb.start=function(){GF.mainContext.bindFramebuffer(36160,this.frameBuffer),(Gj._currentRenderTarget=this)._alreadyResolved=!1},Gb.end=function(){GF.mainContext.bindFramebuffer(36160,null),Gj._currentRenderTarget=null,this._alreadyResolved=!0},Gb.getData=function(Ga,Gb,Gc,Gd){var Ge=GF.mainContext;if(Ge.bindFramebuffer(36160,this._frameBuffer),!(36053===Ge.checkFramebufferStatus(36160)))return Ge.bindFramebuffer(36160,null),null;var Gf=new Uint8Array(this._width*this._height*4);return Ge.readPixels(Ga,Gb,Gc,Gd,this._surfaceFormat,this._surfaceType,Gf),Ge.bindFramebuffer(36160,null),Gf},Gb.disposeResource=function(){if(this._frameBuffer){var Ga=GF.mainContext;Ga.deleteTexture(this._source),Ga.deleteFramebuffer(this._frameBuffer),Ga.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},Gq(0,Gb,"surfaceFormat",function(){return this._surfaceFormat}),Gq(0,Gb,"surfaceType",function(){return this._surfaceType}),Gq(0,Gb,"depthStencilFormat",function(){return this._depthStencilFormat}),Gq(0,Gb,"source",function(){return this._alreadyResolved?Gx.superGet(GFb,this,"source"):null}),Gq(0,Gb,"depthStencilBuffer",function(){return this._depthStencilBuffer}),Gq(0,Gb,"frameBuffer",function(){return this._frameBuffer}),Gj._currentRenderTarget=null}(),function(Ga){function Gb(Ga){this._color=null,this._pixels=null,Gb.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new Grb(this.width,this.height),this._color=Ga,this._pixels=new Uint8Array([255*Ga.x,255*Ga.y,255*Ga.z,255*Ga.w]),this.uri="SolidColorTexture2D_"+this.id}Gp(Gb,"laya.d3.resource.SolidColorTexture2D",GFb);var Gc=Gb.prototype;return Gc._createWebGlTexture=function(){var Ga=GF.mainContext,Gb=this._source=Ga.createTexture(),Gc=this._width,Gd=this._height,Ge=GG.curBindTexTarget,Gf=GG.curBindTexValue;GG.bindTexture(Ga,this._type,Gb),Ga.texImage2D(this._type,0,6408,Gc,Gd,0,6408,5121,this._pixels);var Gg=this._minFifter,Gh=this._magFifter,Gi=this._repeat?10497:33071,Gj=Gw.isPOT(Gc,Gd);Gj?(this._mipmap?-1!==Gg||(Gg=9987):-1!==Gg||(Gg=9729),-1!==Gh||(Gh=9729),Ga.texParameteri(this._type,10241,Gg),Ga.texParameteri(this._type,10240,Gh),Ga.texParameteri(this._type,10242,Gi),Ga.texParameteri(this._type,10243,Gi),this._mipmap&&Ga.generateMipmap(this._type)):(-1!==Gg||(Gg=9729),-1!==Gh||(Gh=9729),Ga.texParameteri(this._type,10241,Gg),Ga.texParameteri(this._type,10240,Gh),Ga.texParameteri(this._type,10242,33071),Ga.texParameteri(this._type,10243,33071)),Ge&&Gf&&GG.bindTexture(Ga,Ge,Gf),this.memorySize=Gj?Gc*Gd*4*(1+1/3):Gc*Gd*4},Gc.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},Gc.disposeResource=function(){this._source&&(GF.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},Gl(Gb,["magentaTexture",function(){var Ga=new Gb(new Ghb(1,0,1,1));return Ga.lock=!0,this.magentaTexture=Ga},"grayTexture",function(){var Ga=new Gb(new Ghb(.5,.5,.5,1));return Ga.lock=!0,this.grayTexture=Ga}]),Gb}()),GTb=function(Ga){function Ge(Ga,Gb,Gc,Gd){this._canRead=!1,this._image=null,this._pixels=null,void 0===Ga&&(Ga=!1),void 0===Gb&&(Gb=!0),void 0===Gc&&(Gc=6408),void 0===Gd&&(Gd=!0),Ge.__super.call(this),this._type=3553,this._repeat=Gb,this._canRead=Ga,this._format=Gc,this._mipmap=Gd}Gp(Ge,"laya.d3.resource.Texture2D",GFb);var Gb=Ge.prototype;return Gb._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var Ga=GF.mainContext,Gb=this._source=Ga.createTexture(),Gc=this._width,Gd=this._height,Ge=GG.curBindTexTarget,Gf=GG.curBindTexValue;switch(GG.bindTexture(Ga,this._type,Gb),this._format){case 6407:case 6408:this._canRead?Ga.texImage2D(this._type,0,this._format,Gc,Gd,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?Ga.texImage2D(this._type,0,this._image._format,Gc,Gd,0,this._image._format,5121,this._image.atlasSource):Ga.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case GF.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:Ga.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var Gg=this._minFifter,Gh=this._magFifter,Gi=this._repeat?10497:33071,Gj=0==this._wrapModeU?10497:33071,Gk=0==this._wrapModeV?10497:33071,Gl=Gw.isPOT(Gc,Gd);Gl?(this._mipmap?-1!==Gg||(Gg=9987):-1!==Gg||(Gg=9729),-1!==Gh||(Gh=9729),Ga.texParameteri(this._type,10241,Gg),Ga.texParameteri(this._type,10240,Gh),Ga.texParameteri(this._type,10242,Gi),Ga.texParameteri(this._type,10243,Gi),Ga.texParameteri(this._type,10242,Gj),Ga.texParameteri(this._type,10243,Gk),this._mipmap&&Ga.generateMipmap(this._type)):(-1!==Gg||(Gg=9729),-1!==Gh||(Gh=9729),Ga.texParameteri(this._type,10241,Gg),Ga.texParameteri(this._type,10240,Gh),Ga.texParameteri(this._type,10242,33071),Ga.texParameteri(this._type,10243,33071)),Ge&&Gf&&GG.bindTexture(Ga,Ge,Gf),this._image.onload=null,this._image=null,this.memorySize=Gl?Gc*Gd*4*(1+1/3):Gc*Gd*4},Gb.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},Gb.onAsynLoaded=function(Ga,Gb,Gc){if(Gc){var Gd=Gc[0];void 0!==Gd&&(this._canRead=Gd);var Ge=Gc[1];void 0!==Ge&&(this._repeat=Ge);var Gf=Gc[2];void 0!==Gf&&(this._format=Gf);var Gg=Gc[3];void 0!==Gg&&(this._mipmap=Gg);var Gh=Gc.wrapModeU;void 0!==Gh&&(this._wrapModeU=Gh);var Gi=Gc.wrapModeV;void 0!==Gi&&(this._wrapModeV=Gi)}switch(this._format){case 6407:case 6408:var Gj=(this._image=Gb).width,Gk=Gb.height;this._width=Gj,this._height=Gk,this._size=new Grb(Gj,Gk),this._canRead&&(Gr.isConchApp?Gb instanceof Go.HTMLElement&&(this._pixels=new Uint8Array(Gb.getImageData(0,0,Gj,Gk))):(GH.canvas.size(Gj,Gk),GH.canvas.clear(),GH.context.drawImage(Gb,0,0,Gj,Gk),this._pixels=new Uint8Array(GH.context.getImageData(0,0,Gj,Gk).data.buffer)));break;case GF.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var Gl=new Gy(Gb);Gl.readUTFBytes(4),Gl.readUTFBytes(2),Gl.getInt16();Gl.endian="bigEndian",this._width=Gl.getInt16(),this._height=Gl.getInt16(),this._size=new Grb(this._width,this._height);Gl.getInt16(),Gl.getInt16();this._image=new Uint8Array(Gb,Gl.pos)}this.recreateResource(),this._endLoaded()},Gb.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},Gb.disposeResource=function(){this._source&&(GF.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},Gq(0,Gb,"_src",function(){return this.url}),Gq(0,Gb,"src",function(){return this.url}),Ge.load=function(Ga){return Gx.loader.create(Ga,null,null,Ge)},Ge}(),GUb=function(Gb){function Gc(Ga,Gb){Gc.__super.call(this),void 0===Ga&&(Ga=.3),void 0===Gb&&(Gb=1e3),this._tempVector3=new Ggb,this._position=new Ggb,this._up=new Ggb,this._forward=new Ggb,this._right=new Ggb,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=Grb.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=Ga,this._farPlane=Gb,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),Gx.stage.on("resize",this,this._onScreenSizeChanged)}Gp(Gc,"laya.d3.core.BaseCamera",Gb);var Ga=Gc.prototype;return Ga._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var Ga=this.scene._cameraPool,Gb=Ga.length-1,Gc=0;Gc<Gb;Gc++)if(Ga[Gc].renderingOrder>Ga[Gb].renderingOrder){var Gd=Ga[Gc];Ga[Gc]=Ga[Gb],Ga[Gb]=Gd}},Ga._calculateProjectionMatrix=function(){},Ga._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},Ga._prepareCameraToRender=function(){GI._currentCameraCullingMask=this.cullingMask;var Ga=this._shaderValues;Ga.setValue(0,this.transform.position.elements),Ga.setValue(5,this.forward.elements),Ga.setValue(6,this.up.elements)},Ga._prepareCameraViewProject=function(Ga,Gb){var Gc=this._shaderValues;Gc.setValue(1,Ga.elements),Gc.setValue(2,Gb.elements)},Ga._renderCamera=function(Ga,Gb,Gc){},Ga.addLayer=function(Ga){29!==Ga.number&&30!=Ga.number&&(this.cullingMask=this.cullingMask|Ga.mask)},Ga.removeLayer=function(Ga){29!==Ga.number&&30!=Ga.number&&(this.cullingMask=this.cullingMask&~Ga.mask)},Ga.addAllLayers=function(){this.cullingMask=2147483647},Ga.removeAllLayers=function(){this.cullingMask=0|GI.getLayerByNumber(29).mask|GI.getLayerByNumber(30).mask},Ga.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},Ga.moveForward=function(Ga){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=Ga,this.transform.translate(this._tempVector3)},Ga.moveRight=function(Ga){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=Ga,this.transform.translate(this._tempVector3)},Ga.moveVertical=function(Ga){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=Ga,this.transform.translate(this._tempVector3,!1)},Ga._addSelfRenderObjects=function(){var Ga=this.scene._cameraPool,Gb=Ga.length;if(0<Gb){for(var Gc=Gb-1;0<=Gc;Gc--)if(this.renderingOrder<=Ga[Gc].renderingOrder){Ga.splice(Gc+1,0,this);break}}else Ga.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},Ga._clearSelfRenderObjects=function(){var Ga=this.scene._cameraPool;Ga.splice(Ga.indexOf(this),1)},Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,Gx.stage.off("resize",this,this._onScreenSizeChanged),Gb.prototype.destroy.call(this,Ga)},Gq(0,Ga,"sky",function(){return this._sky},function(Ga){(this._sky=Ga)._ownerCamera=this}),Gq(0,Ga,"forward",function(){var Ga=this.transform.worldMatrix.elements,Gb=this._forward.elements;return Gb[0]=-Ga[8],Gb[1]=-Ga[9],Gb[2]=-Ga[10],this._forward}),Gq(0,Ga,"position",function(){var Ga=this.transform.worldMatrix.elements,Gb=this._position.elements;return Gb[0]=Ga[12],Gb[1]=Ga[13],Gb[2]=Ga[14],this._position}),Gq(0,Ga,"renderTarget",function(){return this._renderTarget},function(Ga){null!=(this._renderTarget=Ga)&&(this._renderTargetSize=Ga.size)}),Gq(0,Ga,"up",function(){var Ga=this.transform.worldMatrix.elements,Gb=this._up.elements;return Gb[0]=Ga[4],Gb[1]=Ga[5],Gb[2]=Ga[6],this._up}),Gq(0,Ga,"right",function(){var Ga=this.transform.worldMatrix.elements,Gb=this._right.elements;return Gb[0]=Ga[0],Gb[1]=Ga[1],Gb[2]=Ga[2],this._right}),Gq(0,Ga,"renderTargetSize",function(){return this._renderTargetSize},function(Ga){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=Ga,this._calculateProjectionMatrix()}),Gq(0,Ga,"fieldOfView",function(){return this._fieldOfView},function(Ga){this._fieldOfView=Ga,this._calculateProjectionMatrix()}),Gq(0,Ga,"nearPlane",function(){return this._nearPlane},function(Ga){this._nearPlane=Ga,this._calculateProjectionMatrix()}),Gq(0,Ga,"farPlane",function(){return this._farPlane},function(Ga){this._farPlane=Ga,this._calculateProjectionMatrix()}),Gq(0,Ga,"orthographic",function(){return this._orthographic},function(Ga){this._orthographic=Ga,this._calculateProjectionMatrix()}),Gq(0,Ga,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(Ga){this._orthographicVerticalSize=Ga,this._calculateProjectionMatrix()}),Gq(0,Ga,"renderingOrder",function(){return this._renderingOrder},function(Ga){this._renderingOrder=Ga,this._sortCamerasByRenderingOrder()}),Gc.CAMERAPOS=0,Gc.VIEWMATRIX=1,Gc.PROJECTMATRIX=2,Gc.VPMATRIX=3,Gc.VPMATRIX_NO_TRANSLATE=4,Gc.CAMERADIRECTION=5,Gc.CAMERAUP=6,Gc.ENVIRONMENTDIFFUSE=7,Gc.ENVIRONMENTSPECULAR=8,Gc.SIMLODINFO=9,Gc.DIFFUSEIRRADMATR=10,Gc.DIFFUSEIRRADMATG=11,Gc.DIFFUSEIRRADMATB=12,Gc.HDREXPOSURE=13,Gc.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",Gc.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",Gc.CLEARFLAG_SOLIDCOLOR=0,Gc.CLEARFLAG_SKY=1,Gc.CLEARFLAG_DEPTHONLY=2,Gc.CLEARFLAG_NONE=3,Gl(Gc,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new Gab(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new Gab},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new Gab}]),Gc}(GKb),GVb=function(Gc){function Gb(Ga){this._render=null,this._geometryFilter=null,Gb.__super.call(this,Ga)}Gp(Gb,"laya.d3.core.RenderableSprite3D",Gc);var Ga=Gb.prototype;return Ga._addToInitStaticBatchManager=function(){},Ga._setBelongScene=function(Ga){Gc.prototype._setBelongScene.call(this,Ga),Ga._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},Ga._setUnBelongScene=function(){var Ga=this._scene._renderableSprite3Ds,Gb=Ga.indexOf(this);Ga.splice(Gb,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),Gc.prototype._setUnBelongScene.call(this)},Ga._update=function(Ga){(Ga.owner=this)._activeInHierarchy&&(this._updateComponents(Ga),this._render._updateOctreeNode(),this._lateUpdateComponents(Ga),GA.spriteCount++,this._childs.length&&this._updateChilds(Ga))},Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),Gc.prototype.destroy.call(this,Ga),this._render._destroy(),this._render=null},Gb.__init__=function(){Gb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=Gb.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),Gb.SAHDERDEFINE_LIGHTMAP=Gb.shaderDefines.registerDefine("LIGHTMAP")},Gb.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,Gb.SAHDERDEFINE_LIGHTMAP=4,Gb.LIGHTMAPSCALEOFFSET=2,Gb.LIGHTMAP=3,Gl(Gb,["shaderDefines",function(){return this.shaderDefines=new Gkb}]),Gb}(GKb),GWb=(function(Ga){function Gd(Ga,Gb,Gc){this._long=NaN,this._width=NaN,this._height=NaN,void 0===Ga&&(Ga=1),void 0===Gb&&(Gb=1),void 0===Gc&&(Gc=1),Gd.__super.call(this),this._long=Ga,this._width=Gb,this._height=Gc,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}Gp(Gd,"laya.d3.resource.models.BoxMesh",GQb);var Gb=Gd.prototype;Gb.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var Ga=GFa.vertexDeclaration,Gb=(Ga.vertexStride,this._long/2),Gc=this._height/2,Gd=this._width/2,Ge=new Float32Array([-Gb,Gc,-Gd,0,1,0,0,0,Gb,Gc,-Gd,0,1,0,1,0,Gb,Gc,Gd,0,1,0,1,1,-Gb,Gc,Gd,0,1,0,0,1,-Gb,-Gc,-Gd,0,-1,0,0,1,Gb,-Gc,-Gd,0,-1,0,1,1,Gb,-Gc,Gd,0,-1,0,1,0,-Gb,-Gc,Gd,0,-1,0,0,0,-Gb,Gc,-Gd,-1,0,0,0,0,-Gb,Gc,Gd,-1,0,0,1,0,-Gb,-Gc,Gd,-1,0,0,1,1,-Gb,-Gc,-Gd,-1,0,0,0,1,Gb,Gc,-Gd,1,0,0,1,0,Gb,Gc,Gd,1,0,0,0,0,Gb,-Gc,Gd,1,0,0,0,1,Gb,-Gc,-Gd,1,0,0,1,1,-Gb,Gc,Gd,0,0,1,0,0,Gb,Gc,Gd,0,0,1,1,0,Gb,-Gc,Gd,0,0,1,1,1,-Gb,-Gc,Gd,0,0,1,0,1,-Gb,Gc,-Gd,0,0,-1,1,0,Gb,Gc,-Gd,0,0,-1,0,0,Gb,-Gc,-Gd,0,0,-1,0,1,-Gb,-Gc,-Gd,0,0,-1,1,1]),Gf=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new GOb(Ga,this._numberVertices,35044,!0),this._indexBuffer=new GNb("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(Ge),this._indexBuffer.setData(Gf),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},Gq(0,Gb,"long",function(){return this._long},function(Ga){this._long!==Ga&&(this._long=Ga,this.releaseResource(),this.activeResource())}),Gq(0,Gb,"width",function(){return this._width},function(Ga){this._width!==Ga&&(this._width=Ga,this.releaseResource(),this.activeResource())}),Gq(0,Gb,"height",function(){return this._height},function(Ga){this._height!==Ga&&(this._height=Ga,this.releaseResource(),this.activeResource())})}(),function(Ga){function Gg(Ga,Gb,Gc){void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=.3),void 0===Gc&&(Gc=1e3),this._viewMatrix=new Gab,this._projectionMatrix=new Gab,this._projectionViewMatrix=new Gab,this._viewport=new Gib(0,0,0,0),this._normalizedViewport=new Gib(0,0,1,1),this._aspectRatio=Ga,this._boundFrustumUpdate=!0,this._boundFrustum=new G$a(Gab.DEFAULT),Gg.__super.call(this,Gb,Gc),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}Gp(Gg,"laya.d3.core.Camera",GUb);var Gb=Gg.prototype;return Gb._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},Gb._parseCustomProps=function(Ga,Gb,Gc,Gd){var Ge=Gc.clearColor;this.clearColor=new Ghb(Ge[0],Ge[1],Ge[2],Ge[3]);var Gf=Gc.viewport;this.normalizedViewport=new Gib(Gf[0],Gf[1],Gf[2],Gf[3])},Gb._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var Ga=this.orthographicVerticalSize*this.aspectRatio*.5,Gb=.5*this.orthographicVerticalSize;Gab.createOrthoOffCenterRH(-Ga,Ga,-Gb,Gb,this.nearPlane,this.farPlane,this._projectionMatrix)}else Gab.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},Gb._update=function(Ga){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,Ga)},Gb._renderCamera=function(Ga,Gb,Gc){var Gd,Ge;Gc.parallelSplitShadowMaps[0]&&Gc._renderShadowMap(Ga,Gb,this),(Gb.camera=this)._prepareCameraToRender(),Gc._preRenderUpdateComponents(Gb),Gd=Gb._viewMatrix=this.viewMatrix;var Gf=this._renderTarget;Gf?(Gf.start(),Gab.multiply(GUb._invertYScaleMatrix,this._projectionMatrix,GUb._invertYProjectionMatrix),Gab.multiply(GUb._invertYScaleMatrix,this.projectionViewMatrix,GUb._invertYProjectionViewMatrix),Ge=Gb._projectionMatrix=GUb._invertYProjectionMatrix,Gb._projectionViewMatrix=GUb._invertYProjectionViewMatrix):(Ge=Gb._projectionMatrix=this._projectionMatrix,Gb._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(Gd,Ge),Gb._viewport=this.viewport,Gc._preRenderScene(Ga,Gb,this.boundFrustum),Gc._clear(Ga,Gb),Gc._renderScene(Ga,Gb),Gc._postRenderUpdateComponents(Gb),Gf&&Gf.end()},Gb.viewportPointToRay=function(Ga,Gb){Gqb.calculateCursorRay(Ga,this.viewport,this._projectionMatrix,this.viewMatrix,null,Gb)},Gb.normalizedViewportPointToRay=function(Ga,Gb){var Gc=Gg._tempVector20,Gd=this.viewport,Ge=Ga.elements,Gf=Gc.elements;Gf[0]=Ge[0]*Gd.width,Gf[1]=Ge[1]*Gd.height,Gqb.calculateCursorRay(Gc,this.viewport,this._projectionMatrix,this.viewMatrix,null,Gb)},Gb.worldToViewportPoint=function(Ga,Gb){Gab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(Ga,this._projectionViewMatrix,Gb);var Gc=Gb.elements;Gc[0]=Gc[0]/Gx.stage.clientScaleX,Gc[1]=Gc[1]/Gx.stage.clientScaleY},Gb.worldToNormalizedViewportPoint=function(Ga,Gb){Gab.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(Ga,this._projectionViewMatrix,Gb);var Gc=Gb.elements;Gc[0]=Gc[0]/Gx.stage.clientScaleX,Gc[1]=Gc[1]/Gx.stage.clientScaleY},Gb.convertScreenCoordToOrthographicCoord=function(Ga,Gb){if(this._orthographic){var Gc=GY.clientWidth,Gd=GY.clientHeight,Ge=this.orthographicVerticalSize*this.aspectRatio/Gc,Gf=this.orthographicVerticalSize/Gd,Gg=Ga.elements,Gh=Gb.elements;return Gh[0]=(-Gc/2+Gg[0])*Ge,Gh[1]=(Gd/2-Gg[1])*Gf,Gh[2]=(this.nearPlane-this.farPlane)*(Gg[2]+1)/2-this.nearPlane,Ggb.transformCoordinate(Gb,this.transform.worldMatrix,Gb),!0}return!1},Gq(0,Gb,"projectionViewMatrix",function(){return Gab.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),Gq(0,Gb,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var Ga=this.viewport;return Ga.width/Ga.height},function(Ga){if(Ga<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=Ga,this._calculateProjectionMatrix()}),Gq(0,Gb,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),Gq(0,Gb,"needViewport",function(){var Ga=this.normalizedViewport;return 0===Ga.x&&0===Ga.y&&1===Ga.width&&1===Ga.height}),Gq(0,Gb,"viewport",function(){if(this._viewportExpressedInClipSpace){var Ga=this._normalizedViewport,Gb=this.renderTargetSize,Gc=Gb.width,Gd=Gb.height;this._viewport.x=Ga.x*Gc,this._viewport.y=Ga.y*Gd,this._viewport.width=Ga.width*Gc,this._viewport.height=Ga.height*Gd}return this._viewport},function(Ga){if(null!=this.renderTarget&&(Ga.x<0||Ga.y<0||0==Ga.width||0==Ga.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=Ga,this._calculateProjectionMatrix()}),Gq(0,Gb,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var Ga=this._viewport,Gb=this.renderTargetSize,Gc=Gb.width,Gd=Gb.height;this._normalizedViewport.x=Ga.x/Gc,this._normalizedViewport.y=Ga.y/Gd,this._normalizedViewport.width=Ga.width/Gc,this._normalizedViewport.height=Ga.height/Gd}return this._normalizedViewport},function(Ga){Ga.x<0&&(Ga.x=0,console.warn("Camera: viewport.x must large than 0.0.")),Ga.y<0&&(Ga.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<Ga.x+Ga.width&&(Ga.width=1-Ga.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<Ga.y+Ga.height&&(Ga.height=1-Ga.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=Ga,this._calculateProjectionMatrix()}),Gq(0,Gb,"projectionMatrix",function(){return this._projectionMatrix},function(Ga){this._projectionMatrix=Ga,this._useUserProjectionMatrix=!0}),Gq(0,Gb,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),Gl(Gg,["_tempVector20",function(){return this._tempVector20=new Gfb}]),Gg}()),GXb=function(Gc){function Gd(Ga,Gb){Gd.__super.call(this,Gb),this._geometryFilter=new GHb(this),this._render=new GIb(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),Ga&&(this._geometryFilter.sharedMesh=Ga)instanceof laya.d3.resource.models.Mesh&&(Ga.loaded?this._render.sharedMaterials=Ga.materials:Ga.once("loaded",this,this._applyMeshMaterials))}Gp(Gd,"laya.d3.core.MeshSprite3D",Gc);var Ga=Gd.prototype;return Ga._changeRenderObjectByMesh=function(Ga){var Gb=this._render._renderElements,Gc=Gb[Ga];Gc||(Gc=Gb[Ga]=new Gzb),Gc._render=this._render;var Gd=this._render.sharedMaterials[Ga];Gd||(Gd=GMb.defaultMaterial);var Ge=this._geometryFilter.sharedMesh.getRenderElement(Ga);return Gc._mainSortID=this._getSortID(Ge,Gd),Gc._sprite3D=this,Gc.renderObj=Ge,Gc._material=Gd,Gc},Ga._changeRenderObjectByMaterial=function(Ga,Gb){var Gc=this._render._renderElements[Ga];Gb||(Gb=GMb.defaultMaterial);var Gd=this._geometryFilter.sharedMesh.getRenderElement(Ga);return Gc._mainSortID=this._getSortID(Gd,Gb),Gc._sprite3D=this,Gc.renderObj=Gd,Gc._material=Gb,Gc},Ga._changeRenderObjectsByMesh=function(){var Ga=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=Ga;for(var Gb=0;Gb<Ga;Gb++)this._changeRenderObjectByMesh(Gb)},Ga._onMeshChanged=function(Ga){var Gb=Ga.sharedMesh;Gb.loaded?this._changeRenderObjectsByMesh():Gb.once("loaded",this,this._onMeshLoaded)},Ga._onMeshLoaded=function(Ga){Ga===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},Ga._onMaterialChanged=function(Ga,Gb,Gc){Gb<this._render._renderElements.length&&this._changeRenderObjectByMaterial(Gb,Gc)},Ga._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},Ga._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},Ga._parseCustomProps=function(Ga,Gb,Gc,Gd){var Ge=this.meshRender,Gf=Gc.lightmapIndex;null!=Gf&&(Ge.lightmapIndex=Gf);var Gg,Gh,Gi=Gc.lightmapScaleOffset;if(Gi&&(Ge.lightmapScaleOffset=new Ghb(Gi[0],Gi[1],Gi[2],Gi[3])),Gd.instanceParams)(Gg=Gd.instanceParams.loadPath)&&(Gh=Gt.getRes(Gb[Gg]),(this.meshFilter.sharedMesh=Gh).loaded?Ge.sharedMaterials=Gh.materials:Gh.once("loaded",this,this._applyMeshMaterials));else{(Gg=Gc.meshPath)&&(Gh=Gt.getRes(Gb[Gg]),this.meshFilter.sharedMesh=Gh);var Gj=Gc.materials;if(Gj){var Gk=Ge.sharedMaterials,Gl=Gj.length;Gk.length=Gl;for(var Go=0;Go<Gl;Go++)Gk[Go]=Gt.getRes(Gb[Gj[Go].path]);Ge.sharedMaterials=Gk}}},Ga._applyMeshMaterials=function(Ga){for(var Gb=this._render.sharedMaterials,Gc=Ga.materials,Gd=0,Ge=Gc.length;Gd<Ge;Gd++)Gb[Gd]||(Gb[Gd]=Gc[Gd]);this._render.sharedMaterials=Gb},Ga._addToInitStaticBatchManager=function(){Gd._staticBatchManager._addInitBatchSprite(this)},Ga.cloneTo=function(Ga){var Gb=Ga;Gb._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var Gc=this._render,Gd=Gb._render;Gd.enable=Gc.enable,Gd.sharedMaterials=Gc.sharedMaterials,Gd.castShadow=Gc.castShadow;var Ge=Gc.lightmapScaleOffset;Ge&&(Gd.lightmapScaleOffset=Ge.clone()),Gd.lightmapIndex=Gc.lightmapIndex,Gd.receiveShadow=Gc.receiveShadow,Gd.sortingFudge=Gc.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,Ga)},Ga.destroy=function(Ga){if(void 0===Ga&&(Ga=!0),!this.destroyed){var Gb=this.meshFilter.sharedMesh;null!=Gb&&(Gb.loaded||Gb.off("loaded",this,this._applyMeshMaterials)),Gc.prototype.destroy.call(this,Ga),this._geometryFilter._destroy()}},Gq(0,Ga,"meshFilter",function(){return this._geometryFilter}),Gq(0,Ga,"meshRender",function(){return this._render}),Gd.__init__=function(){Gda._staticBatchManagers.push(Gd._staticBatchManager)},Gd.load=function(Ga){return Gx.loader.create(Ga,null,null,Gd)},Gl(Gd,["_staticBatchManager",function(){return this._staticBatchManager=new GBb}]),Gd}(GVb)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ga,Gb){"use strict";for(var Gc in Object.defineProperty(Gb,"__esModule",{value:!0}),Laya){var Gd=Laya[Gc];Gd&&Gd.__isclass&&(Gb[Gc]=Gd)}}),function(Ga,Gb,Gea){Gea.un,Gea.uns;var Gc=Gea.static,Gd=Gea.class,Gf=Gea.getset,Gr=Gea.__newvec,Gh=laya.maths.Bezier,Gl=laya.utils.Browser,GFa=laya.utils.Byte,Ge=(laya.events.Event,laya.events.EventDispatcher),Gg=laya.display.Graphics,Gi=(laya.resource.HTMLCanvas,laya.utils.Handler),Gj=laya.net.Loader,Go=laya.maths.MathUtil,GGa=laya.maths.Matrix,Gs=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),Gk=(laya.renders.RenderContext,laya.resource.Resource),Gp=laya.utils.RunDriver,Gfa=laya.display.Sprite,Gq=laya.utils.Stat,GHa=laya.resource.Texture,Gt=(laya.net.URL,laya.utils.Utils),GG=function(){function Ga(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return Gd(Ga,"laya.ani.AnimationContent"),Ga}(),GH=function(){function Ga(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return Gd(Ga,"laya.ani.AnimationNodeContent"),Ga}(),Gv=function(){function Ga(){}return Gd(Ga,"laya.ani.AnimationParser01"),Ga.parse=function(Ga,Gb){var Gc=Gb.__getBuffer(),Gd=0,Ge=0,Gf=0,Gg=0,Gh=0,Gi=0,Gj=0,Gk=Gb.readUTFString();Ga._aniClassName=Gk;var Gl,Go=Gb.readUTFString().split("\n"),Gp=Gb.getUint8(),Gq=Gb.getUint32(),Gr=Gb.getUint32();0<Gq&&(Gl=Gc.slice(Gq,Gr));var Gs=new GFa(Gl);for(0<Gr&&(Ga._publicExtData=Gc.slice(Gr,Gc.byteLength)),Ga._useParent=!!Gb.getUint8(),Ga._anis.length=Gp,Gd=0;Gd<Gp;Gd++){var Gt=Ga._anis[Gd]=new GG;Gt.nodes=new Array;var Gu=Gt.name=Go[Gb.getUint16()];Ga._aniMap[Gu]=Gd,Gt.bone3DMap={},Gt.playTime=Gb.getFloat32(),Gt.playTime<=0&&console.error("播放时间不能为0  url="+Ga.url+" name="+Gt.name);var Gv=Gt.nodes.length=Gb.getUint8();for(Ge=Gt.totalKeyframeDatasLength=0;Ge<Gv;Ge++){var Gw=Gt.nodes[Ge]=new GH;Gw.childs=[];var Gx=Gb.getInt16();0<=Gx&&(Gw.name=Go[Gx],Gt.bone3DMap[Gw.name]=Ge),Gw.keyFrame=new Array,Gw.parentIndex=Gb.getInt16(),-1==Gw.parentIndex?Gw.parent=null:Gw.parent=Gt.nodes[Gw.parentIndex],Gw.lerpType=Gb.getUint8();var Gy=Gb.getUint32();Gs.pos=Gy;var Gz=Gw.keyframeWidth=Gs.getUint16();if(Gt.totalKeyframeDatasLength+=Gz,0===Gw.lerpType||1===Gw.lerpType)for(Gw.interpolationMethod=[],Gw.interpolationMethod.length=Gz,Gf=0;Gf<Gz;Gf++)Gw.interpolationMethod[Gf]=GK.interpolation[Gs.getUint8()];null!=Gw.parent&&Gw.parent.childs.push(Gw);var GA=Gb.getUint16();0<GA&&(Gw.extenData=Gc.slice(Gb.pos,Gb.pos+GA),Gb.pos+=GA);var GB,GC=Gb.getUint16(),GD=0;for(Gf=0,Gg=Gw.keyFrame.length=GC;Gf<Gg;Gf++){if((GB=Gw.keyFrame[Gf]=new GI).duration=Gb.getFloat32(),GB.startTime=GD,2===Gw.lerpType){GB.interpolationData=[];var GE,GF=Gb.getUint8();switch(GE=Gb.getFloat32()){case 254:for(GB.interpolationData.length=Gz,Gj=0;Gj<Gz;Gj++)GB.interpolationData[Gj]=0;break;case 255:for(GB.interpolationData.length=Gz,Gj=0;Gj<Gz;Gj++)GB.interpolationData[Gj]=5;break;default:for(GB.interpolationData.push(GE),Gi=1;Gi<GF;Gi++)GB.interpolationData.push(Gb.getFloat32())}}for(GB.data=new Float32Array(Gz),Gh=0;Gh<Gz;Gh++)GB.data[Gh]=Gb.getFloat32(),-1e-8<GB.data[Gh]&&GB.data[Gh]<1e-8&&(GB.data[Gh]=0);GD+=GB.duration}GB.startTime=Gt.playTime,Gw.playTime=Gt.playTime,Ga._calculateKeyFrame(Gw,GC,Gz)}}},Ga}(),Gw=function(){function Gx(){}return Gd(Gx,"laya.ani.AnimationParser02"),Gx.READ_DATA=function(){Gx._DATA.offset=Gx._reader.getUint32(),Gx._DATA.size=Gx._reader.getUint32()},Gx.READ_BLOCK=function(){for(var Ga=Gx._BLOCK.count=Gx._reader.getUint16(),Gb=Gx._BLOCK.blockStarts=[],Gc=Gx._BLOCK.blockLengths=[],Gd=0;Gd<Ga;Gd++)Gb.push(Gx._reader.getUint32()),Gc.push(Gx._reader.getUint32())},Gx.READ_STRINGS=function(){var Ga=Gx._reader.getUint32(),Gb=Gx._reader.getUint16(),Gc=Gx._reader.pos;Gx._reader.pos=Ga+Gx._DATA.offset;for(var Gd=0;Gd<Gb;Gd++)Gx._strings[Gd]=Gx._reader.readUTFString();Gx._reader.pos=Gc},Gx.parse=function(Ga,Gb){Gx._templet=Ga;(Gx._reader=Gb).__getBuffer();Gx.READ_DATA(),Gx.READ_BLOCK(),Gx.READ_STRINGS();for(var Gc=0,Gd=Gx._BLOCK.count;Gc<Gd;Gc++){var Ge=Gb.getUint16(),Gf=Gx._strings[Ge],Gg=Gx["READ_"+Gf];if(null==Gg)throw new Error("model file err,no this function:"+Ge+" "+Gf);Gg.call()}},Gx.READ_ANIMATIONS=function(){var Ga=Gx._reader,Gb=Ga.__getBuffer(),Gc=0,Gd=0,Ge=0,Gf=0,Gg=Ga.getUint16(),Gh=[];for(Gh.length=Gg,Gc=0;Gc<Gg;Gc++)Gh[Gc]=GK.interpolation[Ga.getByte()];var Gi=Ga.getUint8();for(Gx._templet._anis.length=Gi,Gc=0;Gc<Gi;Gc++){var Gj=Gx._templet._anis[Gc]={};Gj.nodes=new Array;var Gk=Gj.name=Gx._strings[Ga.getUint16()];Gx._templet._aniMap[Gk]=Gc,Gj.bone3DMap={},Gj.playTime=Ga.getFloat32();var Gl=Gj.nodes.length=Ga.getInt16();for(Gd=Gj.totalKeyframeDatasLength=0;Gd<Gl;Gd++){var Go=Gj.nodes[Gd]={};Go.keyframeWidth=Gg,Go.childs=[];var Gp=Ga.getUint16();0<=Gp&&(Go.name=Gx._strings[Gp],Gj.bone3DMap[Go.name]=Gd),Go.keyFrame=new Array,Go.parentIndex=Ga.getInt16(),-1==Go.parentIndex?Go.parent=null:Go.parent=Gj.nodes[Go.parentIndex],Gj.totalKeyframeDatasLength+=Gg,Go.interpolationMethod=Gh,null!=Go.parent&&Go.parent.childs.push(Go);var Gq=Ga.getUint16(),Gr=null,Gs=null;for(Ge=0,Gf=Go.keyFrame.length=Gq;Ge<Gf;Ge++){(Gr=Go.keyFrame[Ge]={}).startTime=Ga.getFloat32(),Gs&&(Gs.duration=Gr.startTime-Gs.startTime);var Gt=Gx._DATA.offset,Gu=Ga.getUint32(),Gv=4*Gg,Gw=Gb.slice(Gt+Gu,Gt+Gu+Gv);Gr.data=new Float32Array(Gw),Gs=Gr}Gr.duration=0,Go.playTime=Gj.playTime,Gx._templet._calculateKeyFrame(Go,Gq,Gg)}}},Gx._templet=null,Gx._reader=null,Gx._strings=[],Gc(Gx,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),Gx}(),GIa=(function(){function Ga(){}Gd(Ga,"laya.ani.AnimationState"),Ga.stopped=0,Ga.paused=1,Ga.playing=2}(),function(){function Ge(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new GVa,this.resultMatrix=new GGa,this._children=[]}Gd(Ge,"laya.ani.bone.Bone");var Ga=Ge.prototype;return Ga.setTempMatrix=function(Ga){this._tempMatrix=Ga;var Gb,Gc=0;for(Gc=0,Gb=this._children.length;Gc<Gb;Gc++)this._children[Gc].setTempMatrix(this._tempMatrix)},Ga.update=function(Ga){var Gb;if(this.rotation=this.transform.skX,Ga)Gb=this.resultTransform.getMatrix(),GGa.mul(Gb,Ga,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)Gb=this.resultTransform.getMatrix(),GGa.mul(Gb,this.parentBone.resultMatrix,this.resultMatrix);else{var Gc=this.parentBone,Gd=NaN,Ge=NaN,Gf=NaN,Gg=this.parentBone.resultMatrix;Gb=this.resultTransform.getMatrix();var Gh=Gg.a*Gb.tx+Gg.c*Gb.ty+Gg.tx,Gi=Gg.b*Gb.tx+Gg.d*Gb.ty+Gg.ty,Gj=new GGa;this.inheritRotation?(Gd=Math.atan2(Gc.resultMatrix.b,Gc.resultMatrix.a),Ge=Math.cos(Gd),Gf=Math.sin(Gd),Gj.setTo(Ge,Gf,-Gf,Ge,0,0),GGa.mul(this._tempMatrix,Gj,GGa.TEMP),GGa.TEMP.copyTo(Gj),Gb=this.resultTransform.getMatrix(),GGa.mul(Gb,Gj,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,Gb=this.resultTransform.getMatrix(),GGa.TEMP.identity(),GGa.TEMP.d=this.d,GGa.mul(Gb,GGa.TEMP,this.resultMatrix)),this.resultMatrix.tx=Gh,this.resultMatrix.ty=Gi}else(Gb=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var Gk,Gl=0;for(Gl=0,Gk=this._children.length;Gl<Gk;Gl++)this._children[Gl].update()},Ga.updateChild=function(){var Ga,Gb=0;for(Gb=0,Ga=this._children.length;Gb<Ga;Gb++)this._children[Gb].update()},Ga.setRotation=function(Ga){this._sprite&&(this._sprite.rotation=180*Ga/Math.PI)},Ga.updateDraw=function(Ga,Gb){Ge.ShowBones&&!Ge.ShowBones[this.name]||(this._sprite||(this._sprite=new Gfa,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),Gea.stage.addChild(this._sprite)),this._sprite.x=Ga+this.resultMatrix.tx,this._sprite.y=Gb+this.resultMatrix.ty);var Gc,Gd=0;for(Gd=0,Gc=this._children.length;Gd<Gc;Gd++)this._children[Gd].updateDraw(Ga,Gb)},Ga.addChild=function(Ga){this._children.push(Ga),Ga.parentBone=this},Ga.findBone=function(Ga){if(this.name==Ga)return this;var Gb,Gc,Gd=0;for(Gd=0,Gb=this._children.length;Gd<Gb;Gd++)if(Gc=this._children[Gd].findBone(Ga))return Gc;return null},Ga.localToWorld=function(Ga){var Gb=Ga[0],Gc=Ga[1];Ga[0]=Gb*this.resultMatrix.a+Gc*this.resultMatrix.c+this.resultMatrix.tx,Ga[1]=Gb*this.resultMatrix.b+Gc*this.resultMatrix.d+this.resultMatrix.ty},Ge.ShowBones={},Ge}()),GJa=function(){function Gr(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}Gd(Gr,"laya.ani.bone.BoneSlot");var Ga=Gr.prototype;return Ga.showSlotData=function(Ga,Gb){void 0===Gb&&(Gb=!0),this.currSlotData=Ga,Gb&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},Ga.showDisplayByName=function(Ga){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(Ga))},Ga.replaceDisplayByName=function(Ga,Gb){if(this.currSlotData){var Gc;Gc=this.currSlotData.getDisplayByName(Ga);var Gd;Gd=this.currSlotData.getDisplayByName(Gb),this.replaceDisplayByIndex(Gc,Gd)}},Ga.replaceDisplayByIndex=function(Ga,Gb){this.currSlotData&&(this._replaceDic[Ga]=Gb,this.displayIndex==Ga&&this.showDisplayByIndex(Ga))},Ga.showDisplayByIndex=function(Ga){if(null!=this._replaceDic[Ga]&&(Ga=this._replaceDic[Ga]),this.currSlotData&&-1<Ga&&Ga<this.currSlotData.displayArr.length){if(this.displayIndex=Ga,this.currDisplayData=this.currSlotData.displayArr[Ga],this.currDisplayData){var Gb=this.currDisplayData.name;this.currTexture=this.templet.getTexture(Gb),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!Gs.isConchApp||Gs.isConchApp&&"0.9.15"<Gfa.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},Ga.replaceSkin=function(Ga){this._diyTexture=Ga,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},Ga.setParentMatrix=function(Ga){this._parentMatrix=Ga},Ga.draw=function(Ga,Gb,Gc,Gd){if(void 0===Gc&&(Gc=!1),void 0===Gd&&(Gd=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var Ge,Gf=this.currTexture;switch(this._diyTexture&&(Gf=this._diyTexture),this.currDisplayData.type){case 0:if(Ga){var Gg=this.getDisplayMatrix();if(this._parentMatrix){var Gh=!1;if(Gg){var Gi;if(GGa.mul(Gg,this._parentMatrix,GGa.TEMP),Gi=Gc?(null==this._resultMatrix&&(this._resultMatrix=new GGa),this._resultMatrix):new GGa,!Gs.isWebGL&&this.currDisplayData.uvs||Gs.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var Gj=Gr._tempMatrix;Gj.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(Gj.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(Gh=!0,Gj.rotate(-Math.PI/2)),GGa.mul(Gj,GGa.TEMP,Gi)}else GGa.TEMP.copyTo(Gi);Gh?Ga.drawTexture(Gf,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,Gi):Ga.drawTexture(Gf,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,Gi)}}}break;case 1:if(null==(Ge=Gc?(null==this._skinSprite&&(this._skinSprite=Gr.createSkinMesh()),this._skinSprite):Gr.createSkinMesh()))return;var Gk;if(null==this.currDisplayData.bones){var Gl,Go=this.currDisplayData.weights;this.deformData&&(Go=this.deformData),Gl=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Gz.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Gz.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=Go;this.currDisplayData.triangles.length;Gk=this.currDisplayData.triangles,Ge.init2(Gf,null,Gk,this._mVerticleArr,Gl);var Gp,Gq=this.getDisplayMatrix();if(this._parentMatrix)if(Gq)GGa.mul(Gq,this._parentMatrix,GGa.TEMP),Gp=Gc?(null==this._resultMatrix&&(this._resultMatrix=new GGa),this._resultMatrix):new GGa,GGa.TEMP.copyTo(Gp),Ge.transform=Gp}else this.skinMesh(Gb,Ge,Gd);Ga.drawSkin(Ge);break;case 2:if(null==(Ge=Gc?(null==this._skinSprite&&(this._skinSprite=Gr.createSkinMesh()),this._skinSprite):Gr.createSkinMesh()))return;this.skinMesh(Gb,Ge,Gd),Ga.drawSkin(Ge)}}},Ga.skinMesh=function(Ga,Gb,Gc){var Gd,Ge=this.currTexture,Gf=this.currDisplayData.bones;Gd=this._diyTexture?(Ge=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=Gz.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=Gz.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var Gg,Gh,Gi=this.currDisplayData.weights,Gj=this.currDisplayData.triangles,Gk=0,Gl=0,Go=0,Gp=NaN,Gq=NaN,Gr=0,Gs=0,Gt=[],Gu=0,Gv=0;if(this.deformData&&0<this.deformData.length){var Gw=0;for(Gu=0,Gv=Gf.length;Gu<Gv;){for(Go=Gf[Gu++]+Gu,Gl=Gk=0;Gu<Go;Gu++)Gh=Ga[Gf[Gu]],Gp=Gi[Gr]+this.deformData[Gw++],Gq=Gi[Gr+1]+this.deformData[Gw++],Gs=Gi[Gr+2],Gk+=(Gp*Gh.a+Gq*Gh.c+Gh.tx)*Gs,Gl+=(Gp*Gh.b+Gq*Gh.d+Gh.ty)*Gs,Gr+=3;Gt.push(Gk,Gl)}}else for(Gu=0,Gv=Gf.length;Gu<Gv;){for(Go=Gf[Gu++]+Gu,Gl=Gk=0;Gu<Go;Gu++)Gh=Ga[Gf[Gu]],Gp=Gi[Gr],Gq=Gi[Gr+1],Gs=Gi[Gr+2],Gk+=(Gp*Gh.a+Gq*Gh.c+Gh.tx)*Gs,Gl+=(Gp*Gh.b+Gq*Gh.d+Gh.ty)*Gs,Gr+=3;Gt.push(Gk,Gl)}this._mVerticleArr=Gt,Gg=Gj,Gb.init2(Ge,null,Gg,this._mVerticleArr,Gd)},Ga.drawBonePoint=function(Ga){Ga&&this._parentMatrix&&Ga.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},Ga.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},Ga.getMatrix=function(){return this._resultMatrix},Ga.copy=function(){var Ga=new Gr;return Ga.type="copy",Ga.name=this.name,Ga.attachmentName=this.attachmentName,Ga.srcDisplayIndex=this.srcDisplayIndex,Ga.parent=this.parent,Ga.displayIndex=this.displayIndex,Ga.templet=this.templet,Ga.currSlotData=this.currSlotData,Ga.currTexture=this.currTexture,Ga.currDisplayData=this.currDisplayData,Ga},Gr.createSkinMesh=function(){return Gs.isWebGL||Gs.isConchApp?Gp.skinAniSprite():(Gs.isWebGL,null)},Gc(Gr,["_tempMatrix",function(){return this._tempMatrix=new GGa}]),Gr}(),GKa=function(){function Ga(){this.skinName=null,this.deformSlotDataList=[]}return Gd(Ga,"laya.ani.bone.DeformAniData"),Ga}(),GLa=function(){function Ga(){this.deformSlotDisplayList=[]}return Gd(Ga,"laya.ani.bone.DeformSlotData"),Ga}(),GMa=function(){function Ga(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}Gd(Ga,"laya.ani.bone.DeformSlotDisplayData");var Gb=Ga.prototype;return Gb.binarySearch1=function(Ga,Gb){var Gc=0,Gd=Ga.length-2;if(0==Gd)return 1;for(var Ge=Gd>>>1;;){if(Ga[Math.floor(Ge+1)]<=Gb?Gc=Ge+1:Gd=Ge,Gc==Gd)return Gc+1;Ge=Gc+Gd>>>1}return 0},Gb.apply=function(Ga,Gb,Gc){if(void 0===Gc&&(Gc=1),Ga+=.05,!(this.timeList.length<=0)){var Gd=0;if(!(Ga<this.timeList[0])){var Ge=this.vectices[0].length,Gf=[],Gg=this.binarySearch1(this.timeList,Ga);if(this.frameIndex=Gg,Ga>=this.timeList[this.timeList.length-1]){var Gh=this.vectices[this.vectices.length-1];if(Gc<1)for(Gd=0;Gd<Ge;Gd++)Gf[Gd]+=(Gh[Gd]-Gf[Gd])*Gc;else for(Gd=0;Gd<Ge;Gd++)Gf[Gd]=Gh[Gd];this.deformData=Gf}else{this.tweenKeyList[this.frameIndex];var Gi=this.vectices[this.frameIndex-1],Gj=this.vectices[this.frameIndex],Gk=this.timeList[this.frameIndex-1],Gl=this.timeList[this.frameIndex];Gc=this.tweenKeyList[Gg-1]?(Ga-Gk)/(Gl-Gk):0;var Go=NaN;for(Gd=0;Gd<Ge;Gd++)Go=Gi[Gd],Gf[Gd]=Go+(Gj[Gd]-Go)*Gc;this.deformData=Gf}}}},Ga}(),GNa=function(){function Ga(){this.time=NaN,this.drawOrder=[]}return Gd(Ga,"laya.ani.bone.DrawOrderData"),Ga}(),GOa=function(){function Ga(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return Gd(Ga,"laya.ani.bone.EventData"),Ga}(),Gu=function(){function Gda(Ga,Gb){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=Ga,this._targetBone=Gb[Ga.targetBoneIndex],this.isSpine=Ga.isSpine,null==this._bones&&(this._bones=[]);for(var Gc=this._bones.length=0,Gd=Ga.boneIndexs.length;Gc<Gd;Gc++)this._bones.push(Gb[Ga.boneIndexs[Gc]]);this.name=Ga.name,this.mix=Ga.mix,this.bendDirection=Ga.bendDirection}Gd(Gda,"laya.ani.bone.IkConstraint");var Ga=Gda.prototype;return Ga.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},Ga._applyIk1=function(Ga,Gb,Gc,Gd){var Ge=Ga.parentBone,Gf=1/(Ge.resultMatrix.a*Ge.resultMatrix.d-Ge.resultMatrix.b*Ge.resultMatrix.c),Gg=Gb-Ge.resultMatrix.tx,Gh=Gc-Ge.resultMatrix.ty,Gi=(Gg*Ge.resultMatrix.d-Gh*Ge.resultMatrix.c)*Gf-Ga.transform.x,Gj=(Gh*Ge.resultMatrix.a-Gg*Ge.resultMatrix.b)*Gf-Ga.transform.y,Gk=Math.atan2(Gj,Gi)*Gda.radDeg-0-Ga.transform.skX;Ga.transform.scX<0&&(Gk+=180),180<Gk?Gk-=360:Gk<-180&&(Gk+=360),Ga.transform.skX=Ga.transform.skY=Ga.transform.skX+Gk*Gd,Ga.update()},Ga.updatePos=function(Ga,Gb){this._sp&&this._sp.pos(Ga,Gb)},Ga._applyIk2=function(Ga,Gb,Gc,Gd,Ge,Gf){if(0!=Gf){var Gg=Ga.resultTransform.x,Gh=Ga.resultTransform.y,Gi=Ga.transform.scX,Gj=Ga.transform.scY,Gk=Gb.transform.scX,Gl=0,Go=0,Gp=0;Gp=Gi<0?(Gi=-Gi,Gl=180,-1):(Gl=0,1),Gj<0&&(Gj=-Gj,Gp=-Gp),Go=Gk<0?(Gk=-Gk,180):0;var Gq=Gb.resultTransform.x,Gr=NaN,Gs=NaN,Gt=NaN,Gu=Ga.resultMatrix.a,Gv=Ga.resultMatrix.c,Gw=Ga.resultMatrix.b,Gx=Ga.resultMatrix.d,Gy=Math.abs(Gi-Gj)<=1e-4;Gt=Gy?(Gs=Gu*Gq+Gv*(Gr=Gb.resultTransform.y)+Ga.resultMatrix.tx,Gw*Gq+Gx*Gr+Ga.resultMatrix.ty):(Gr=0,Gs=Gu*Gq+Ga.resultMatrix.tx,Gw*Gq+Ga.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new Gfa,Gea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(Gc,Gd,15,"#ffff00"),this._sp.graphics.drawCircle(Gs,Gt,15,"#ff00ff")),Ga.setRotation(Math.atan2(Gt-Ga.resultMatrix.ty,Gs-Ga.resultMatrix.tx));var Gz=Ga.parentBone;Gu=Gz.resultMatrix.a,Gv=Gz.resultMatrix.c,Gw=Gz.resultMatrix.b;var GA=1/(Gu*(Gx=Gz.resultMatrix.d)-Gv*Gw),GB=Gc-Gz.resultMatrix.tx,GC=Gd-Gz.resultMatrix.ty,GD=(GB*Gx-GC*Gv)*GA-Gg,GE=(GC*Gu-GB*Gw)*GA-Gh,GF=((GB=Gs-Gz.resultMatrix.tx)*Gx-(GC=Gt-Gz.resultMatrix.ty)*Gv)*GA-Gg,GG=(GC*Gu-GB*Gw)*GA-Gh,GH=Math.sqrt(GF*GF+GG*GG),GI=Gb.length*Gk,GJ=NaN,GK=NaN;if(Gy){var GL=(GD*GD+GE*GE-GH*GH-(GI*=Gi)*GI)/(2*GH*GI);GL<-1?GL=-1:1<GL&&(GL=1),GK=Math.acos(GL)*Ge,Gu=GH+GI*GL,Gv=GI*Math.sin(GK),GJ=Math.atan2(GE*Gu-GD*Gv,GD*Gu+GE*Gv)}else{var GM=(Gu=Gi*GI)*Gu,GN=(Gv=Gj*GI)*Gv,GO=GD*GD+GE*GE,GP=Math.atan2(GE,GD),GQ=-2*GN*GH,GR=GN-GM;if(0<(Gx=GQ*GQ-4*GR*(Gw=GN*GH*GH+GM*GO-GM*GN))){var GS=Math.sqrt(Gx);GQ<0&&(GS=-GS);var GT=(GS=-(GQ+GS)/2)/GR,GU=Gw/GS,GV=Math.abs(GT)<Math.abs(GU)?GT:GU;GV*GV<=GO&&(GC=Math.sqrt(GO-GV*GV)*Ge,GJ=GP-Math.atan2(GC,GV),GK=Math.atan2(GC/Gj,(GV-GH)/Gi))}var GW=0,GX=Number.MAX_VALUE,GY=0,GZ=0,G$=0,G_=0,Gm=0,Gn=0;G_<(Gx=(GB=GH+Gu)*GB)&&(G$=0,G_=Gx,Gm=GB),(Gx=(GB=GH-Gu)*GB)<GX&&(GW=Math.PI,GX=Gx,GY=GB);var Gaa=Math.acos(-Gu*GH/(GM-GN));(Gx=(GB=Gu*Math.cos(Gaa)+GH)*GB+(GC=Gv*Math.sin(Gaa))*GC)<GX&&(GW=Gaa,GX=Gx,GY=GB,GZ=GC),G_<Gx&&(G$=Gaa,G_=Gx,Gm=GB,Gn=GC),GK=GO<=(GX+G_)/2?(GJ=GP-Math.atan2(GZ*Ge,GY),GW*Ge):(GJ=GP-Math.atan2(Gn*Ge,Gm),G$*Ge)}var Gba=Math.atan2(Gr,Gq)*Gp,Gca=Ga.resultTransform.skX;180<(GJ=(GJ-Gba)*Gda.radDeg+Gl-Gca)?GJ-=360:GJ<-180&&(GJ+=360),Ga.resultTransform.x=Gg,Ga.resultTransform.y=Gh,Ga.resultTransform.skX=Ga.resultTransform.skY=Gca+GJ*Gf,Gca=Gb.resultTransform.skX,180<(GK=((GK+Gba)*Gda.radDeg-0)*Gp+Go-(Gca%=360))?GK-=360:GK<-180&&(GK+=360),Gb.resultTransform.x=Gq,Gb.resultTransform.y=Gr,Gb.resultTransform.skX=Gb.resultTransform.skY=Gb.resultTransform.skY+GK*Gf,Ga.update()}},Ga._applyIk3=function(Ga,Gb,Gc,Gd,Ge,Gf){if(0!=Gf){var Gg,Gh,Gi=Gb.resultMatrix.a*Gb.length,Gj=Gb.resultMatrix.b*Gb.length,Gk=Gi*Gi+Gj*Gj,Gl=Math.sqrt(Gk),Go=Ga.resultMatrix.tx,Gp=Ga.resultMatrix.ty,Gq=Gb.resultMatrix.tx,Gr=Gb.resultMatrix.ty,Gs=Gq-Go,Gt=Gr-Gp,Gu=Gs*Gs+Gt*Gt,Gv=Math.sqrt(Gu),Gw=(Gs=Gc-Ga.resultMatrix.tx)*Gs+(Gt=Gd-Ga.resultMatrix.ty)*Gt,Gx=Math.sqrt(Gw);if(Gl+Gv<=Gx||Gx+Gl<=Gv||Gx+Gv<=Gl){var Gy=NaN;Gq=Go+(Gy=Gl+Gv<=Gx?1:-1)*(Gc-Go)*Gv/Gx,Gr=Gp+Gy*(Gd-Gp)*Gv/Gx}else{var Gz=(Gu-Gk+Gw)/(2*Gw),GA=Math.sqrt(Gu-Gz*Gz*Gw)/Gx,GB=Go+Gs*Gz,GC=Gp+Gt*Gz,GD=-Gt*GA,GE=Gs*GA;Gr=0<Ge?(Gq=GB-GD,GC-GE):(Gq=GB+GD,GC+GE)}Gg=Gq,Gh=Gr,this.isDebug&&(this._sp||(this._sp=new Gfa,Gea.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(Go,Gp,15,"#ff00ff"),this._sp.graphics.drawCircle(Gc,Gd,15,"#ffff00"),this._sp.graphics.drawCircle(Gg,Gh,15,"#ff00ff"));var GF,GG;GF=Math.atan2(Gh-Ga.resultMatrix.ty,Gg-Ga.resultMatrix.tx),Ga.setRotation(GF),(GG=Gda._tempMatrix).identity(),GG.rotate(GF),GG.scale(Ga.resultMatrix.getScaleX(),Ga.resultMatrix.getScaleY()),GG.translate(Ga.resultMatrix.tx,Ga.resultMatrix.ty),GG.copyTo(Ga.resultMatrix),Ga.updateChild();var GH,GI;GH=Math.atan2(Gd-Gh,Gc-Gg),Gb.setRotation(GH),(GI=Gda._tempMatrix).identity(),GI.rotate(GH),GI.scale(Gb.resultMatrix.getScaleX(),Gb.resultMatrix.getScaleY()),GI.translate(Gg,Gh),GG.copyTo(Gb.resultMatrix),Gb.updateChild()}},Gc(Gda,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new GGa}]),Gda}(),GPa=function(){function Ga(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return Gd(Ga,"laya.ani.bone.IkConstraintData"),Ga}(),Gx=function(){function GI(Ga,Gb){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=Ga,this.position=Ga.position,this.spacing=Ga.spacing,this.rotateMix=Ga.rotateMix,this.translateMix=Ga.translateMix,this.bones=[];for(var Gc=this.data.bones,Gd=0,Ge=Gc.length;Gd<Ge;Gd++)this.bones.push(Gb[Gc[Gd]])}Gd(GI,"laya.ani.bone.PathConstraint");var Ga=GI.prototype;return Ga.apply=function(Ga,Gb){if(this.target){var Gc=this.translateMix,Gd=this.translateMix,Ge=0<Gd,Gf=this.data.spacingMode,Gg="length"==Gf,Gh=this.data.rotateMode,Gi="tangent"==Gh,Gj="chainScale"==Gh,Gk=[],Gl=this.bones.length,Go=Gi?Gl:Gl+1,Gp=[];(this._spaces=Gp)[0]=this.position;var Gq=this.spacing;if(Gj||Gg)for(var Gr=0,Gs=Go-1;Gr<Gs;){var Gt=this.bones[Gr],Gu=Gt.length,Gv=Gu*Gt.resultMatrix.a,Gw=Gu*Gt.resultMatrix.b;Gu=Math.sqrt(Gv*Gv+Gw*Gw),Gj&&(Gk[Gr]=Gu),Gp[++Gr]=Gg?Math.max(0,Gu+Gq):Gq}else for(Gr=1;Gr<Go;Gr++)Gp[Gr]=Gq;var Gx=this.computeWorldPositions(this.target,Ga,Gb,Go,Gi,"percent"==this.data.positionMode,"percent"==Gf);if(this._debugKey){for(Gr=0;Gr<Gx.length;Gr++)Gb.drawCircle(Gx[Gr++],Gx[Gr++],5,"#00ff00");var Gy=[];for(Gr=0;Gr<Gx.length;Gr++)Gy.push(Gx[Gr++],Gx[Gr++]);Gb.drawLines(0,0,Gy,"#ff0000")}var Gz=Gx[0],GA=Gx[1],GB=this.data.offsetRotation,GC="chain"==Gh&&0==GB,GD=NaN;for(Gr=0,GD=3;Gr<Gl;Gr++,GD+=3){(Gt=this.bones[Gr]).resultMatrix.tx+=(Gz-Gt.resultMatrix.tx)*Gc,Gt.resultMatrix.ty+=(GA-Gt.resultMatrix.ty)*Gc;var GE=(Gv=Gx[GD])-Gz,GF=(Gw=Gx[GD+1])-GA;if(Gj&&0!=(Gu=Gk[Gr])){var GG=(Math.sqrt(GE*GE+GF*GF)/Gu-1)*Gd+1;Gt.resultMatrix.a*=GG,Gt.resultMatrix.c*=GG}if(Gz=Gv,GA=Gw,Ge){var GH=Gt.resultMatrix.a,GI=Gt.resultMatrix.c,GJ=Gt.resultMatrix.b,GK=Gt.resultMatrix.d,GL=NaN,GM=NaN,GN=NaN;GL=Gi?Gx[GD-1]:0==Gp[Gr+1]?Gx[GD+2]:Math.atan2(GF,GE),GL-=Math.atan2(GJ,GH)-GB/180*Math.PI,GC&&(GM=Math.cos(GL),GN=Math.sin(GL),Gz+=((Gu=Gt.length)*(GM*GH-GN*GJ)-GE)*Gd,GA+=(Gu*(GN*GH+GM*GJ)-GF)*Gd),GL>Math.PI?GL-=2*Math.PI:GL<-Math.PI&&(GL+=2*Math.PI),GL*=Gd,GM=Math.cos(GL),GN=Math.sin(GL),Gt.resultMatrix.a=GM*GH-GN*GJ,Gt.resultMatrix.c=GM*GI-GN*GK,Gt.resultMatrix.b=GN*GH+GM*GJ,Gt.resultMatrix.d=GN*GI+GM*GK}}}},Ga.computeWorldVertices2=function(Ga,Gb,Gc,Gd,Ge,Gf){var Gg,Gh,Gi=Ga.currDisplayData.bones,Gj=Ga.currDisplayData.weights,Gk=Ga.currDisplayData.triangles,Gl=0,Go=0,Gp=0,Gq=0,Gr=0,Gs=0,Gt=0,Gu=0,Gv=0,Gw=0,Gx=0;if(null!=Gi){for(Gl=0;Gl<Gc;Gl+=2)Go+=(Gq=Gi[Go])+1,Gp+=Gq;var Gy=Gb;for(Gr=Gf,Gs=3*Gp;Gr<Gd;Gr+=2){for(Gu=Gt=0,Gq=Gi[Go++],Gq+=Go;Go<Gq;Go++,Gs+=3){Gg=Gy[Gi[Go]].resultMatrix,Gv=Gj[Gs],Gw=Gj[Gs+1];var Gz=Gj[Gs+2];Gt+=(Gv*Gg.a+Gw*Gg.c+Gg.tx)*Gz,Gu+=(Gv*Gg.b+Gw*Gg.d+Gg.ty)*Gz}Ge[Gr]=Gt,Ge[Gr+1]=Gu}}else{var GA,GB;if(Gk||(Gk=Gj),Ga.deformData&&(Gk=Ga.deformData),GA=Ga.parent,Gb)for(Gx=Gb.length,Gl=0;Gl<Gx;Gl++)if(Gb[Gl].name==GA){Gh=Gb[Gl];break}Gh&&(GB=Gh.resultMatrix),GB||(GB=GI._tempMt);var GC=GB.tx,GD=GB.ty,GE=GB.a,GF=GB.b,GG=GB.c,GH=GB.d;for(Gh&&(GH*=Gh.d),Go=Gc,Gr=Gf;Gr<Gd;Go+=2,Gr+=2)Gv=Gk[Go],Gw=Gk[Go+1],Ge[Gr]=Gv*GE+Gw*GF+GC,Ge[Gr+1]=-(Gv*GG+Gw*GH+GD)}},Ga.computeWorldPositions=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg){Ga.currDisplayData.bones,Ga.currDisplayData.weights,Ga.currDisplayData.triangles;var Gh=[],Gi=0,Gj=Ga.currDisplayData.verLen,Gk=this.position,Gl=this._spaces,Go=[],Gp=[],Gq=Gj/6,Gr=-1,Gs=NaN,Gt=0,Gu=0,Gv=NaN,Gw=NaN,Gx=NaN,Gy=NaN;if(Gq--,Gj-=4,this.computeWorldVertices2(Ga,Gb,2,Gj,Gh,0),this._debugKey)for(Gi=0;Gi<Gh.length;)Gc.drawCircle(Gh[Gi++],Gh[Gi++],10,"#ff0000");Go=Gh,this._curves.length=Gq;var Gz=this._curves,GA=Go[Gs=0],GB=Go[1],GC=0,GD=0,GE=0,GF=0,GG=0,GH=0,GI=NaN,GJ=NaN,GK=NaN,GL=NaN,GM=NaN,GN=NaN,GO=NaN,GP=NaN,GQ=0;for(Gi=0,GQ=2;Gi<Gq;Gi++,GQ+=6)GC=Go[GQ],GD=Go[GQ+1],GE=Go[GQ+2],GF=Go[GQ+3],GM=2*(GI=.1875*(GA-2*GC+GE))+(GK=.09375*(3*(GC-GE)-GA+(GG=Go[GQ+4]))),GN=2*(GJ=.1875*(GB-2*GD+GF))+(GL=.09375*(3*(GD-GF)-GB+(GH=Go[GQ+5]))),GO=.75*(GC-GA)+GI+.16666667*GK,GP=.75*(GD-GB)+GJ+.16666667*GL,Gs+=Math.sqrt(GO*GO+GP*GP),GO+=GM,GP+=GN,GM+=GK,GN+=GL,Gs+=Math.sqrt(GO*GO+GP*GP),GO+=GM,GP+=GN,Gs+=Math.sqrt(GO*GO+GP*GP),GO+=GM+GK,GP+=GN+GL,Gs+=Math.sqrt(GO*GO+GP*GP),Gz[Gi]=Gs,GA=GG,GB=GH;if(Gf&&(Gk*=Gs),Gg)for(Gi=0;Gi<Gd;Gi++)Gl[Gi]*=Gs;var GR=this._segments,GS=0,GT=0;for(GT=Gu=Gt=Gi=0;Gi<Gd;Gi++,Gt+=3)if((Gv=Gk+=Gw=Gl[Gi])<0)this.addBeforePosition(Gv,Go,0,Gp,Gt);else if(Gs<Gv)this.addAfterPosition(Gv-Gs,Go,Gj-4,Gp,Gt);else{for(;;Gu++)if(!((Gy=Gz[Gu])<Gv)){0==Gu?Gv/=Gy:Gv=(Gv-(Gx=Gz[Gu-1]))/(Gy-Gx);break}if(Gu!=Gr){var GU=6*(Gr=Gu);for(GA=Go[GU],GB=Go[GU+1],GC=Go[GU+2],GD=Go[GU+3],GE=Go[GU+4],GF=Go[GU+5],GM=2*(GI=.03*(GA-2*GC+GE))+(GK=.006*(3*(GC-GE)-GA+(GG=Go[GU+6]))),GN=2*(GJ=.03*(GB-2*GD+GF))+(GL=.006*(3*(GD-GF)-GB+(GH=Go[GU+7]))),GO=.3*(GC-GA)+GI+.16666667*GK,GP=.3*(GD-GB)+GJ+.16666667*GL,GS=Math.sqrt(GO*GO+GP*GP),GR[0]=GS,GU=1;GU<8;GU++)GO+=GM,GP+=GN,GM+=GK,GN+=GL,GS+=Math.sqrt(GO*GO+GP*GP),GR[GU]=GS;GO+=GM,GP+=GN,GS+=Math.sqrt(GO*GO+GP*GP),GR[8]=GS,GO+=GM+GK,GP+=GN+GL,GS+=Math.sqrt(GO*GO+GP*GP),GR[9]=GS,GT=0}for(Gv*=GS;;GT++)if(!((Gy=GR[GT])<Gv)){0==GT?Gv/=Gy:Gv=GT+(Gv-(Gx=GR[GT-1]))/(Gy-Gx);break}this.addCurvePosition(.1*Gv,GA,GB,GC,GD,GE,GF,GG,GH,Gp,Gt,Ge||0<Gi&&0==Gw)}return Gp},Ga.addBeforePosition=function(Ga,Gb,Gc,Gd,Ge){var Gf=Gb[Gc],Gg=Gb[Gc+1],Gh=Gb[Gc+2]-Gf,Gi=Gb[Gc+3]-Gg,Gj=Math.atan2(Gi,Gh);Gd[Ge]=Gf+Ga*Math.cos(Gj),Gd[Ge+1]=Gg+Ga*Math.sin(Gj),Gd[Ge+2]=Gj},Ga.addAfterPosition=function(Ga,Gb,Gc,Gd,Ge){var Gf=Gb[Gc+2],Gg=Gb[Gc+3],Gh=Gf-Gb[Gc],Gi=Gg-Gb[Gc+1],Gj=Math.atan2(Gi,Gh);Gd[Ge]=Gf+Ga*Math.cos(Gj),Gd[Ge+1]=Gg+Ga*Math.sin(Gj),Gd[Ge+2]=Gj},Ga.addCurvePosition=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk,Gl){0==Ga&&(Ga=1e-4);var Go=Ga*Ga,Gp=Go*Ga,Gq=1-Ga,Gr=Gq*Gq,Gs=Gr*Gq,Gt=Gq*Ga,Gu=3*Gt,Gv=Gq*Gu,Gw=Gu*Ga,Gx=Gb*Gs+Gd*Gv+Gf*Gw+Gh*Gp,Gy=Gc*Gs+Ge*Gv+Gg*Gw+Gi*Gp;Gj[Gk]=Gx,Gj[Gk+1]=Gy,Gj[Gk+2]=Gl?Math.atan2(Gy-(Gc*Gr+Ge*Gt*2+Gg*Go),Gx-(Gb*Gr+Gd*Gt*2+Gf*Go)):0},GI.NONE=-1,GI.BEFORE=-2,GI.AFTER=-3,Gc(GI,["_tempMt",function(){return this._tempMt=new GGa}]),GI}(),GQa=function(){function Ga(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return Gd(Ga,"laya.ani.bone.PathConstraintData"),Ga}(),GRa=function(){function Ga(){this.name=null,this.slotArr=[]}return Gd(Ga,"laya.ani.bone.SkinData"),Ga}(),GSa=function(){function Ga(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}Gd(Ga,"laya.ani.bone.SkinSlotDisplayData");var Gb=Ga.prototype;return Gb.createTexture=function(Ga){return this.texture||(this.texture=new GHa(Ga.bitmap,this.uvs),Ga.bitmap.alphaTexture&&(this.texture.alphaTexture=new GHa(Ga.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=Ga.height,this.texture.height=Ga.width,this.texture.offsetX=-Ga.offsetX,this.texture.offsetY=-Ga.offsetY,this.texture.sourceWidth=Ga.sourceHeight,this.texture.sourceHeight=Ga.sourceWidth):(this.texture.width=Ga.width,this.texture.height=Ga.height,this.texture.offsetX=-Ga.offsetX,this.texture.offsetY=-Ga.offsetY,this.texture.sourceWidth=Ga.sourceWidth,this.texture.sourceHeight=Ga.sourceHeight),Gs.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},Gb.destory=function(){this.texture&&this.texture.destroy()},Ga}(),GTa=function(){function Ga(){this.name=null,this.displayArr=[]}return Gd(Ga,"laya.ani.bone.SlotData"),Ga.prototype.getDisplayByName=function(Ga){for(var Gb=0,Gc=this.displayArr.length;Gb<Gc;Gb++)if(this.displayArr[Gb].attachmentName==Ga)return Gb;return-1},Ga}(),Gy=function(){function Ga(Ga,Gb){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=Gr(2,0),this._data=Ga,null==this._bones&&(this._bones=[]),this.target=Gb[Ga.targetIndex];var Gc,Gd=0;for(Gd=0,Gc=Ga.boneIndexs.length;Gd<Gc;Gd++)this._bones.push(Gb[Ga.boneIndexs[Gd]]);this.rotateMix=Ga.rotateMix,this.translateMix=Ga.translateMix,this.scaleMix=Ga.scaleMix,this.shearMix=Ga.shearMix}return Gd(Ga,"laya.ani.bone.TfConstraint"),Ga.prototype.apply=function(){for(var Ga,Gb=this.target.resultMatrix.a,Gc=this.target.resultMatrix.b,Gd=this.target.resultMatrix.c,Ge=this.target.resultMatrix.d,Gf=0,Gg=this._bones.length;Gf<Gg;Gf++){if(Ga=this._bones[Gf],0<this.rotateMix){var Gh=Ga.resultMatrix.a,Gi=Ga.resultMatrix.b,Gj=Ga.resultMatrix.c,Gk=Ga.resultMatrix.d,Gl=Math.atan2(Gd,Gb)-Math.atan2(Gj,Gh)+this._data.offsetRotation*Math.PI/180;Gl>Math.PI?Gl-=2*Math.PI:Gl<-Math.PI&&(Gl+=2*Math.PI),Gl*=this.rotateMix;var Go=Math.cos(Gl),Gp=Math.sin(Gl);Ga.resultMatrix.a=Go*Gh-Gp*Gj,Ga.resultMatrix.b=Go*Gi-Gp*Gk,Ga.resultMatrix.c=Gp*Gh+Go*Gj,Ga.resultMatrix.d=Gp*Gi+Go*Gk}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),Ga.resultMatrix.tx+=(this._temp[0]-Ga.resultMatrix.tx)*this.translateMix,Ga.resultMatrix.ty+=(this._temp[1]-Ga.resultMatrix.ty)*this.translateMix,Ga.updateChild()),0<this.scaleMix){var Gq=Math.sqrt(Ga.resultMatrix.a*Ga.resultMatrix.a+Ga.resultMatrix.c*Ga.resultMatrix.c),Gr=Math.sqrt(Gb*Gb+Gd*Gd),Gs=1e-5<Gq?(Gq+(Gr-Gq+this._data.offsetScaleX)*this.scaleMix)/Gq:0;Ga.resultMatrix.a*=Gs,Ga.resultMatrix.c*=Gs,Gq=Math.sqrt(Ga.resultMatrix.b*Ga.resultMatrix.b+Ga.resultMatrix.d*Ga.resultMatrix.d),Gr=Math.sqrt(Gc*Gc+Ge*Ge),Gs=1e-5<Gq?(Gq+(Gr-Gq+this._data.offsetScaleY)*this.scaleMix)/Gq:0,Ga.resultMatrix.b*=Gs,Ga.resultMatrix.d*=Gs}if(0<this.shearMix){Gi=Ga.resultMatrix.b,Gk=Ga.resultMatrix.d;var Gt=Math.atan2(Gk,Gi);(Gl=Math.atan2(Ge,Gc)-Math.atan2(Gd,Gb)-(Gt-Math.atan2(Ga.resultMatrix.c,Ga.resultMatrix.a)))>Math.PI?Gl-=2*Math.PI:Gl<-Math.PI&&(Gl+=2*Math.PI),Gl=Gt+(Gl+this._data.offsetShearY*Math.PI/180)*this.shearMix,Gs=Math.sqrt(Gi*Gi+Gk*Gk),Ga.resultMatrix.b=Math.cos(Gl)*Gs,Ga.resultMatrix.d=Math.sin(Gl)*Gs}}},Ga}(),GUa=function(){function Ga(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return Gd(Ga,"laya.ani.bone.TfConstraintData"),Ga}(),GVa=function(){function Ga(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}Gd(Ga,"laya.ani.bone.Transform");var Gb=Ga.prototype;return Gb.initData=function(Ga){null!=Ga.x&&(this.x=Ga.x),null!=Ga.y&&(this.y=Ga.y),null!=Ga.skX&&(this.skX=Ga.skX),null!=Ga.skY&&(this.skY=Ga.skY),null!=Ga.scX&&(this.scX=Ga.scX),null!=Ga.scY&&(this.scY=Ga.scY)},Gb.getMatrix=function(){var Ga;return(Ga=this.mMatrix?this.mMatrix:this.mMatrix=new GGa).identity(),Ga.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(Ga,this.skewX*Math.PI/180,this.skewY*Math.PI/180),Ga.rotate(this.skX*Math.PI/180),Ga.translate(this.x,this.y),Ga},Gb.skew=function(Ga,Gb,Gc){var Gd=Math.sin(Gc),Ge=Math.cos(Gc),Gf=Math.sin(Gb),Gg=Math.cos(Gb);return Ga.setTo(Ga.a*Gg-Ga.b*Gd,Ga.a*Gf+Ga.b*Ge,Ga.c*Gg-Ga.d*Gd,Ga.c*Gf+Ga.d*Ge,Ga.tx*Gg-Ga.ty*Gd,Ga.tx*Gf+Ga.ty*Ge),Ga},Ga}(),Gz=function(){function Ga(){}return Gd(Ga,"laya.ani.bone.UVTools"),Ga.getRelativeUV=function(Ga,Gb,Gc){var Gd=Ga[0],Ge=Ga[2]-Ga[0],Gf=Ga[1],Gg=Ga[5]-Ga[1];Gc||(Gc=[]),Gc.length=Gb.length;var Gh,Gi=0;Gh=Gc.length;var Gj=1/Ge,Gk=1/Gg;for(Gi=0;Gi<Gh;Gi+=2)Gc[Gi]=(Gb[Gi]-Gd)*Gj,Gc[Gi+1]=(Gb[Gi+1]-Gf)*Gk;return Gc},Ga.getAbsoluteUV=function(Ga,Gb,Gc){if(0==Ga[0]&&0==Ga[1]&&1==Ga[4]&&1==Ga[5])return Gc?(Gt.copyArray(Gc,Gb),Gc):Gb;var Gd=Ga[0],Ge=Ga[2]-Ga[0],Gf=Ga[1],Gg=Ga[5]-Ga[1];Gc||(Gc=[]),Gc.length=Gb.length;var Gh,Gi=0;for(Gh=Gc.length,Gi=0;Gi<Gh;Gi+=2)Gc[Gi]=Gb[Gi]*Ge+Gd,Gc[Gi+1]=Gb[Gi+1]*Gg+Gf;return Gc},Ga}(),GI=function(){function Ga(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return Gd(Ga,"laya.ani.KeyFramesContent"),Ga}(),GA=function(){function Gk(){}return Gd(Gk,"laya.ani.math.BezierLerp"),Gk.getBezierRate=function(Ga,Gb,Gc,Gd,Ge){var Gf=Gk._getBezierParamKey(Gb,Gc,Gd,Ge),Gg=100*Gf+Ga;if(Gk._bezierResultCache[Gg])return Gk._bezierResultCache[Gg];var Gh,Gi=Gk._getBezierPoints(Gb,Gc,Gd,Ge,Gf),Gj=0;for(Gh=Gi.length,Gj=0;Gj<Gh;Gj+=2)if(Ga<=Gi[Gj])return Gk._bezierResultCache[Gg]=Gi[Gj+1],Gi[Gj+1];return Gk._bezierResultCache[Gg]=1},Gk._getBezierParamKey=function(Ga,Gb,Gc,Gd){return 100*(100*(100*(100*Ga+Gb)+Gc)+Gd)},Gk._getBezierPoints=function(Ga,Gb,Gc,Gd,Ge){return Gk._bezierPointsCache[Ge]?Gk._bezierPointsCache[Ge]:(Gf=[0,0,Ga,Gb,Gc,Gd,1,1],Gg=(new Gh).getBezierPoints(Gf,100,3),Gk._bezierPointsCache[Ge]=Gg);var Gf,Gg},Gk._bezierResultCache={},Gk._bezierPointsCache={},Gk}(),GB=function(Ga){function Gb(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,Gb.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}Gd(Gb,"laya.ani.AnimationPlayer",Ge);var Gc=Gb.prototype;return Gea.imps(Gc,{"laya.resource.IDestroy":!0}),Gc._onTempletLoadedComputeFullKeyframeIndices=function(Ga,Gb,Gc){this._templet===Gc&&this._cachePlayRate===Ga&&this._cacheFrameRate===Gb&&this._computeFullKeyframeIndices()},Gc._computeFullKeyframeIndices=function(){for(var Ga=this._fullFrames=[],Gb=this._templet,Gc=this._cacheFrameRateInterval*this._cachePlayRate,Gd=0,Ge=Gb.getAnimationCount();Gd<Ge;Gd++){for(var Gf=[],Gg=0,Gh=Gb.getAnimation(Gd).nodes.length;Gg<Gh;Gg++){for(var Gi=Gb.getAnimation(Gd).nodes[Gg],Gj=Math.floor(Gi.playTime/Gc+.01),Gk=new Uint16Array(Gj+1),Gl=-1,Go=0,Gp=Gi.keyFrame.length;Go<Gp;Go++){var Gq=Gi.keyFrame[Go],Gr=Gq.startTime,Gs=Gr+Gq.duration+Gc;do{for(var Gt=Math.floor(Gr/Gc+.5),Gu=Gl+1;Gu<Gt;Gu++)Gk[Gu]=Go;Gk[Gl=Gt]=Go,Gr+=Gc}while(Gr<=Gs)}Gf.push(Gk)}Ga.push(Gf)}},Gc._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},Gc._calculatePlayDuration=function(){if(0!==this.state){var Ga=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=Ga),this._playEnd>Ga&&(this._playEnd=Ga),this._playDuration=this._playEnd-this._playStart}},Gc._setPlayParams=function(Ga,Gb){this._currentTime=Ga,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/Gb+.01),0),this._currentFrameTime=this._currentKeyframeIndex*Gb},Gc._setPlayParamsWhenStop=function(Ga,Gb){this._currentTime=Ga,this._currentKeyframeIndex=Math.max(Math.floor(Ga/Gb+.01),0),this._currentFrameTime=this._currentKeyframeIndex*Gb,this._currentAnimationClipIndex=-1},Gc._update=function(Ga){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var Gb=this._cacheFrameRateInterval*this._cachePlayRate,Gc=0;this._startUpdateLoopCount!==Gq.loopCount&&(Gc=Ga*this.playbackRate,this._elapsedPlaybackTime+=Gc);var Gd=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=Gd)return this._setPlayParamsWhenStop(Gd,Gb),void this.event("stopped");if(Gc+=this._currentTime,0<Gd)if(Gd<=Gc)do{if(Gc-=Gd,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(Gd,Gb),this._stopWhenCircleFinish=!1,void this.event("stopped");Gc<Gd&&(this._setPlayParams(Gc,Gb),this.event("complete"))}while(Gd<=Gc);else this._setPlayParams(Gc,Gb);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(Gd,Gb),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},Gc._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},Gc.play=function(Ga,Gb,Gc,Gd,Ge){if(void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=1),void 0===Gc&&(Gc=2147483647),void 0===Gd&&(Gd=0),void 0===Ge&&(Ge=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(Gc<0||Gd<0||Ge<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==Ge&&Ge<Gd)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=Gb,this._overallDuration=Gc,this._playStart=Gd,this._playEnd=Ge,this._paused=!1,this._currentAnimationClipIndex=Ga,this._currentKeyframeIndex=0,this._startUpdateLoopCount=Gq.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},Gc.playByFrame=function(Ga,Gb,Gc,Gd,Ge,Gf){void 0===Ga&&(Ga=0),void 0===Gb&&(Gb=1),void 0===Gc&&(Gc=2147483647),void 0===Gd&&(Gd=0),void 0===Ge&&(Ge=0),void 0===Gf&&(Gf=30);var Gg=1e3/Gf;this.play(Ga,Gb,Gc,Gd*Gg,Ge*Gg)},Gc.stop=function(Ga){void 0===Ga&&(Ga=!0),Ga?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},Gf(0,Gc,"playEnd",function(){return this._playEnd}),Gf(0,Gc,"templet",function(){return this._templet},function(Ga){0===!this.state&&this.stop(!0),this._templet!==Ga&&((this._templet=Ga).loaded?this._computeFullKeyframeIndices():Ga.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),Gf(0,Gc,"playStart",function(){return this._playStart}),Gf(0,Gc,"playDuration",function(){return this._playDuration}),Gf(0,Gc,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),Gf(0,Gc,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),Gf(0,Gc,"overallDuration",function(){return this._overallDuration}),Gf(0,Gc,"currentFrameTime",function(){return this._currentFrameTime}),Gf(0,Gc,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),Gf(0,Gc,"currentPlayTime",function(){return this._currentTime+this._playStart}),Gf(0,Gc,"cachePlayRate",function(){return this._cachePlayRate},function(Ga){this._cachePlayRate!==Ga&&(this._cachePlayRate=Ga,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[Ga,this._cacheFrameRate])))}),Gf(0,Gc,"cacheFrameRate",function(){return this._cacheFrameRate},function(Ga){this._cacheFrameRate!==Ga&&(this._cacheFrameRate=Ga,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,Ga])))}),Gf(0,Gc,"currentTime",null,function(Ga){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(Ga<this._playStart||Ga>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=Gq.loopCount;var Gb=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=Ga,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/Gb),0),this._currentFrameTime=this._currentKeyframeIndex*Gb}}),Gf(0,Gc,"paused",function(){return this._paused},function(Ga){(this._paused=Ga)&&this.event("paused")}),Gf(0,Gc,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),Gf(0,Gc,"destroyed",function(){return this._destroyed}),Gb}(),GJ=function(Ga){function Gb(){Gb.__super.call(this),Gs.isConchNode&&(this.drawSkin=function(Ga){Ga.transform||(Ga.transform=GGa.EMPTY),this._addCmd([Ga]),this.setSkinMesh&&this.setSkinMesh(Ga._ps,Ga.mVBData,Ga.mEleNum,0,Ga.mTexture,Ga.transform)})}return Gd(Gb,"laya.ani.GraphicsAni",Gg),Gb.prototype.drawSkin=function(Ga){var Gb=[Ga];this._saveToCmd(Gs._context._drawSkin,Gb)},Gb.create=function(){return Gb._caches.pop()||new Gb},Gb.recycle=function(Ga){Ga.clear(),Gb._caches.push(Ga)},Gb._caches=[],Gb}(),GK=function(Ga){function Gu(){this._aniMap={},this.unfixedLastAniIndex=-1,Gu.__super.call(this),this._anis=new Array}Gd(Gu,"laya.ani.AnimationTemplet",Gk);var Gb=Gu.prototype;return Gb.parse=function(Ga){var Gb=new GFa(Ga);this._aniVersion=Gb.readUTFString(),Gv.parse(this,Gb)},Gb._calculateKeyFrame=function(Ga,Gb,Gc){var Gd=Ga.keyFrame;Gd[Gb]=Gd[0];for(var Ge=0;Ge<Gb;Ge++){var Gf=Gd[Ge];Gf.nextData=0===Gf.duration?Gf.data:Gd[Ge+1].data}Gd.length--},Gb.onAsynLoaded=function(Ga,Gb,Gc){var Gd=new GFa(Gb);switch(this._aniVersion=Gd.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":Gw.parse(this,Gd);break;default:Gv.parse(this,Gd)}this._endLoaded()},Gb.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},Gb.getAnimationCount=function(){return this._anis.length},Gb.getAnimation=function(Ga){return this._anis[Ga]},Gb.getAniDuration=function(Ga){return this._anis[Ga].playTime},Gb.getNodes=function(Ga){return this._anis[Ga].nodes},Gb.getNodeIndexWithName=function(Ga,Gb){return this._anis[Ga].bone3DMap[Gb]},Gb.getNodeCount=function(Ga){return this._anis[Ga].nodes.length},Gb.getTotalkeyframesLength=function(Ga){return this._anis[Ga].totalKeyframeDatasLength},Gb.getPublicExtData=function(){return this._publicExtData},Gb.getAnimationDataWithCache=function(Ga,Gb,Gc,Gd){var Ge=Gb[Gc];if(Ge){var Gf=Ge[Ga];return Gf?Gf[Gd]:null}return null},Gb.setAnimationDataWithCache=function(Ga,Gb,Gc,Gd,Ge){var Gf=Gb[Gc]||(Gb[Gc]={});(Gf[Ga]||(Gf[Ga]=[]))[Gd]=Ge},Gb.getOriginalData=function(Ga,Gb,Gc,Gd,Ge){for(var Gf=this._anis[Ga].nodes,Gg=0,Gh=0,Gi=Gf.length,Gj=0;Gh<Gi;Gh++){var Gk,Gl=Gf[Gh];Gk=Gl.keyFrame[Gc[Gh][Gd]],Gl.dataOffset=Gj;var Go=Ge-Gk.startTime,Gp=Gl.lerpType;if(Gp)switch(Gp){case 0:case 1:for(Gg=0;Gg<Gl.keyframeWidth;)Gg+=Gl.interpolationMethod[Gg](Gl,Gg,Gb,Gj+Gg,Gk.data,Go,null,Gk.duration,Gk.nextData);break;case 2:var Gq=Gk.interpolationData,Gr=Gq.length,Gs=0;for(Gg=0;Gg<Gr;){var Gt=Gq[Gg];switch(Gt){case 6:case 7:Gg+=Gu.interpolation[Gt](Gl,Gs,Gb,Gj+Gs,Gk.data,Go,null,Gk.duration,Gk.nextData,Gq,Gg+1);break;default:Gg+=Gu.interpolation[Gt](Gl,Gs,Gb,Gj+Gs,Gk.data,Go,null,Gk.duration,Gk.nextData)}Gs++}}else for(Gg=0;Gg<Gl.keyframeWidth;)Gg+=Gl.interpolationMethod[Gg](Gl,Gg,Gb,Gj+Gg,Gk.data,Go,null,Gk.duration,Gk.nextData);Gj+=Gl.keyframeWidth}},Gb.getNodesCurrentFrameIndex=function(Ga,Gb){var Gc=this._anis[Ga].nodes;Ga!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(Gc.length),this.unfixedCurrentTimes=new Float32Array(Gc.length),this.unfixedLastAniIndex=Ga);for(var Gd=0,Ge=Gc.length;Gd<Ge;Gd++){var Gf=Gc[Gd];for(Gb<this.unfixedCurrentTimes[Gd]&&(this.unfixedCurrentFrameIndexes[Gd]=0),this.unfixedCurrentTimes[Gd]=Gb;this.unfixedCurrentFrameIndexes[Gd]<Gf.keyFrame.length&&!(Gf.keyFrame[this.unfixedCurrentFrameIndexes[Gd]].startTime>this.unfixedCurrentTimes[Gd]);)this.unfixedCurrentFrameIndexes[Gd]++;this.unfixedCurrentFrameIndexes[Gd]--}return this.unfixedCurrentFrameIndexes},Gb.getOriginalDataUnfixedRate=function(Ga,Gb,Gc){var Gd=this._anis[Ga].nodes;Ga!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(Gd.length),this.unfixedCurrentTimes=new Float32Array(Gd.length),this.unfixedKeyframes=Gr(Gd.length),this.unfixedLastAniIndex=Ga);for(var Ge=0,Gf=0,Gg=Gd.length,Gh=0;Gf<Gg;Gf++){var Gi=Gd[Gf];for(Gc<this.unfixedCurrentTimes[Gf]&&(this.unfixedCurrentFrameIndexes[Gf]=0),this.unfixedCurrentTimes[Gf]=Gc;this.unfixedCurrentFrameIndexes[Gf]<Gi.keyFrame.length&&!(Gi.keyFrame[this.unfixedCurrentFrameIndexes[Gf]].startTime>this.unfixedCurrentTimes[Gf]);)this.unfixedKeyframes[Gf]=Gi.keyFrame[this.unfixedCurrentFrameIndexes[Gf]],this.unfixedCurrentFrameIndexes[Gf]++;var Gj=this.unfixedKeyframes[Gf];Gi.dataOffset=Gh;var Gk=Gc-Gj.startTime;if(Gi.lerpType)switch(Gi.lerpType){case 0:case 1:for(Ge=0;Ge<Gi.keyframeWidth;)Ge+=Gi.interpolationMethod[Ge](Gi,Ge,Gb,Gh+Ge,Gj.data,Gk,null,Gj.duration,Gj.nextData);break;case 2:var Gl=Gj.interpolationData,Go=Gl.length,Gp=0;for(Ge=0;Ge<Go;){var Gq=Gl[Ge];switch(Gq){case 6:case 7:Ge+=Gu.interpolation[Gq](Gi,Gp,Gb,Gh+Gp,Gj.data,Gk,null,Gj.duration,Gj.nextData,Gl,Ge+1);break;default:Ge+=Gu.interpolation[Gq](Gi,Gp,Gb,Gh+Gp,Gj.data,Gk,null,Gj.duration,Gj.nextData)}Gp++}}else for(Ge=0;Ge<Gi.keyframeWidth;)Ge+=Gi.interpolationMethod[Ge](Gi,Ge,Gb,Gh+Ge,Gj.data,Gk,null,Gj.duration,Gj.nextData);Gh+=Gi.keyframeWidth}},Gu._LinearInterpolation_0=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){var Gk=0===Gh?0:Gf/Gh;return Gc[Gd]=(1-Gk)*Ge[Gb]+Gk*Gi[Gb],1},Gu._QuaternionInterpolation_1=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){var Gk=0===Gh?0:Gf/Gh;return Go.slerpQuaternionArray(Ge,Gb,Gi,Gb,Gk,Gc,Gd),4},Gu._AngleInterpolation_2=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){return 0},Gu._RadiansInterpolation_3=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){return 0},Gu._Matrix4x4Interpolation_4=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){for(var Gk=0;Gk<16;Gk++,Gb++)Gc[Gd+Gk]=Ge[Gb]+Gf*Gg[Gb];return 16},Gu._NoInterpolation_5=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj){return Gc[Gd]=Ge[Gb],1},Gu._BezierInterpolation_6=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk){return void 0===Gk&&(Gk=0),Gc[Gd]=Ge[Gb]+(Gi[Gb]-Ge[Gb])*GA.getBezierRate(Gf/Gh,Gj[Gk],Gj[Gk+1],Gj[Gk+2],Gj[Gk+3]),5},Gu._BezierInterpolation_7=function(Ga,Gb,Gc,Gd,Ge,Gf,Gg,Gh,Gi,Gj,Gk){return void 0===Gk&&(Gk=0),Gc[Gd]=Gj[Gk+4]+Gj[Gk+5]*GA.getBezierRate((.001*Gf+Gj[Gk+6])/Gj[Gk+7],Gj[Gk],Gj[Gk+1],Gj[Gk+2],Gj[Gk+3]),9},Gu.load=function(Ga){return Gea.loader.create(Ga,null,null,Gu)},Gu.interpolation=[Gu._LinearInterpolation_0,Gu._QuaternionInterpolation_1,Gu._AngleInterpolation_2,Gu._RadiansInterpolation_3,Gu._Matrix4x4Interpolation_4,Gu._NoInterpolation_5,Gu._BezierInterpolation_6,Gu._BezierInterpolation_7],Gu}(),GC=function(Gb){function Gc(Ga,Gb){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,Gc.__super.call(this),void 0===Gb&&(Gb=0),Ga&&this.init(Ga,Gb)}Gd(Gc,"laya.ani.bone.Skeleton",Gb);var Ga=Gc.prototype;return Ga.init=function(Ga,Gb){void 0===Gb&&(Gb=0);var Gc,Gd,Ge,Gf=0,Gg=0;if(1==Gb)for(this._graphicsCache=[],Gf=0,Gg=Ga.getAnimationCount();Gf<Gg;Gf++)this._graphicsCache.push([]);if(this._yReverseMatrix=Ga.yReverseMatrix,this._aniMode=Gb,this._templet=Ga,this._player=new GB,this._player.cacheFrameRate=Ga.rate,this._player.templet=Ga,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=Ga.mBoneArr,this._rootBone=Ga.mRootBone,this._aniSectionDic=Ga.aniSectionDic,0<Ga.ikArr.length)for(this._ikArr=[],Gf=0,Gg=Ga.ikArr.length;Gf<Gg;Gf++)this._ikArr.push(new Gu(Ga.ikArr[Gf],this._boneList));if(0<Ga.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),Gf=0,Gg=Ga.pathArr.length;Gf<Gg;Gf++)Gc=Ga.pathArr[Gf],Gd=new Gx(Gc,this._boneList),(Ge=this._boneSlotDic[Gc.name])&&((Gd=new Gx(Gc,this._boneList)).target=Ge),this._pathDic[Gc.name]=Gd;if(0<Ga.tfArr.length)for(this._tfArr=[],Gf=0,Gg=Ga.tfArr.length;Gf<Gg;Gf++)this._tfArr.push(new Gy(Ga.tfArr[Gf],this._boneList));if(0<Ga.skinDataArray.length){var Gh=this._templet.skinDataArray[this._skinIndex];this._skinName=Gh.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},Ga.load=function(Ga,Gb,Gc){},Ga._onLoaded=function(){},Ga._parseComplete=function(){var Ga=GD.TEMPLET_DICTIONARY[this._aniPath];Ga&&(this.init(Ga,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},Ga._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},Ga._onPlay=function(){this.event("played")},Ga._onStop=function(){var Ga,Gb=this._templet.eventAniArr[this._aniClipIndex];if(Gb&&this._eventIndex<Gb.length)for(;this._eventIndex<Gb.length;this._eventIndex++)(Ga=Gb[this._eventIndex]).time>=this._player.playStart&&Ga.time<=this._player.playEnd&&this.event("label",Ga);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},Ga._onPause=function(){this.event("paused")},Ga._parseSrcBoneMatrix=function(){var Ga=0,Gb=0;for(Gb=this._templet.srcBoneMatrixArr.length,Ga=0;Ga<Gb;Ga++)this._boneMatrixArray.push(new GGa);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var Gc,Gd,Ge=this._templet.boneSlotArray;for(Ga=0,Gb=Ge.length;Ga<Gb;Ga++)Gc=Ge[Ga],null==(Gd=this._bindBoneBoneSlotDic[Gc.parent])&&(this._bindBoneBoneSlotDic[Gc.parent]=Gd=[]),this._boneSlotDic[Gc.name]=Gc=Gc.copy(),Gd.push(Gc),this._boneSlotArray.push(Gc)}},Ga._emitMissedEvents=function(Ga,Gb,Gc){void 0===Gc&&(Gc=0);var Gd=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(Gd){var Ge,Gf,Gg=0;for(Ge=Gd.length,Gg=Gc;Gg<Ge;Gg++)(Gf=Gd[Gg]).time>=this._player.playStart&&Gf.time<=this._player.playEnd&&this.event("label",Gf)}},Ga._update=function(Ga){if(void 0===Ga&&(Ga=!0),!(this._pause||Ga&&this._indexControl)){var Gb=this.timer.currTimer,Gc=this._player.currentKeyframeIndex,Gd=Gb-this._lastTime;if(Ga?this._player._update(Gd):Gc=-1,this._lastTime=Gb,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<Gd&&this._clipIndex==Gc&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var Ge;this._lastUpdateAniClipIndex=this._aniClipIndex,Gc>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var Gf,Gg=this._templet.eventAniArr[this._aniClipIndex];if(Gg&&this._eventIndex<Gg.length&&((Ge=Gg[this._eventIndex]).time>=this._player.playStart&&Ge.time<=this._player.playEnd?this._player.currentPlayTime>=Ge.time&&(this.event("label",Ge),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(Gf=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=Gf&&(this.graphics=Gf));var Gh=0,Gi=0;for(Gi=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,Gi-1)&&0<Gi;)Gi--;if(Gi<this._clipIndex)for(Gh=Gi;Gh<this._clipIndex;Gh++)this._createGraphics(Gh)}else if(1==this._aniMode){if(Gf=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=Gf&&(this.graphics=Gf));for(Gi=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,Gi-1)&&0<Gi;)Gi--;if(Gi<this._clipIndex)for(Gh=Gi;Gh<this._clipIndex;Gh++)this._createGraphics(Gh)}this._createGraphics()}}},Ga._createGraphics=function(Ga){void 0===Ga&&(Ga=-1),-1==Ga&&(Ga=this._clipIndex);var Gb,Gc,Gd=Ga*this._player.cacheFrameRateInterval,Ge=this._templet.drawOrderAniArr[this._aniClipIndex];if(Ge&&0<Ge.length)for(this._drawOrderIndex=0,Gb=Ge[this._drawOrderIndex];Gd>=Gb.time&&(this._drawOrder=Gb.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=Ge.length));)Gb=Ge[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=GJ.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=GJ.create(),Gc=this.graphics;var Gf=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],Ga,Gd);var Gg,Gh,Gi,Gj,Gk=this._aniSectionDic[this._aniClipIndex],Gl=0,Go=0,Gp=0,Gq=0,Gr=0,Gs=this._templet.srcBoneMatrixArr.length;for(Gr=Gk[Go=0];Go<Gs;Go++)Gj=this._boneList[Go],Gi=this._templet.srcBoneMatrixArr[Go],Gj.resultTransform.scX=Gi.scX*this._curOriginalData[Gl++],Gj.resultTransform.skX=Gi.skX+this._curOriginalData[Gl++],Gj.resultTransform.skY=Gi.skY+this._curOriginalData[Gl++],Gj.resultTransform.scY=Gi.scY*this._curOriginalData[Gl++],Gj.resultTransform.x=Gi.x+this._curOriginalData[Gl++],Gj.resultTransform.y=Gi.y+this._curOriginalData[Gl++],8===this._templet.tMatrixDataLen&&(Gj.resultTransform.skewX=Gi.skewX+this._curOriginalData[Gl++],Gj.resultTransform.skewY=Gi.skewY+this._curOriginalData[Gl++]);var Gt,Gu={},Gv={};for(Gr+=Gk[1];Go<Gr;Go++)Gu[(Gt=Gf[Go]).name]=this._curOriginalData[Gl++],Gv[Gt.name]=this._curOriginalData[Gl++],this._curOriginalData[Gl++],this._curOriginalData[Gl++],this._curOriginalData[Gl++],this._curOriginalData[Gl++];var Gw,Gx,Gy={},Gz={};for(Gr+=Gk[2];Go<Gr;Go++)Gy[(Gt=Gf[Go]).name]=this._curOriginalData[Gl++],Gz[Gt.name]=this._curOriginalData[Gl++],this._curOriginalData[Gl++],this._curOriginalData[Gl++],this._curOriginalData[Gl++],this._curOriginalData[Gl++];if(this._pathDic)for(Gr+=Gk[3];Go<Gr;Go++){if(Gt=Gf[Go],Gw=this._pathDic[Gt.name])switch(new GFa(Gt.extenData).getByte()){case 1:Gw.position=this._curOriginalData[Gl++];break;case 2:Gw.spacing=this._curOriginalData[Gl++];break;case 3:Gw.rotateMix=this._curOriginalData[Gl++],Gw.translateMix=this._curOriginalData[Gl++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(GGa.TEMP.identity()),this._ikArr)for(Go=0,Gr=this._ikArr.length;Go<Gr;Go++)Gx=this._ikArr[Go],Gy.hasOwnProperty(Gx.name)&&(Gx.bendDirection=Gy[Gx.name]),Gz.hasOwnProperty(Gx.name)&&(Gx.mix=Gz[Gx.name]),Gx.apply();if(this._pathDic)for(var GA in this._pathDic)(Gw=this._pathDic[GA]).apply(this._boneList,Gc);if(this._tfArr)for(Go=0,Gq=this._tfArr.length;Go<Gq;Go++)this._tfArr[Go].apply();for(Go=0,Gq=this._boneList.length;Go<Gq;Go++)if(Gj=this._boneList[Go],Gh=this._bindBoneBoneSlotDic[Gj.name],Gj.resultMatrix.copyTo(this._boneMatrixArray[Go]),Gh)for(Gp=0,Gr=Gh.length;Gp<Gr;Gp++)(Gg=Gh[Gp])&&Gg.setParentMatrix(Gj.resultMatrix);var GB,GC,GD,GE,GF={},GG=this._templet.deformAniArr;if(GG&&0<GG.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,Go=0,Gr=this._boneSlotArray.length;Go<Gr;Go++)(Gg=this._boneSlotArray[Go]).deformData=null;var GH,GI=GG[this._aniClipIndex];for(GH in GB=GI.default,this._setDeform(GB,GF,this._boneSlotArray,Gd),GI)"default"!=GH&&GH!=this._skinName&&(GB=GI[GH],this._setDeform(GB,GF,this._boneSlotArray,Gd));GB=GI[this._skinName],this._setDeform(GB,GF,this._boneSlotArray,Gd)}if(this._drawOrder)for(Go=0,Gr=this._drawOrder.length;Go<Gr;Go++)GC=Gu[(Gg=this._boneSlotArray[this._drawOrder[Go]]).name],GD=Gv[Gg.name],isNaN(GD)||(Gc.save(),Gc.alpha(GD)),isNaN(GC)||-2==GC||(this._templet.attachmentNames?Gg.showDisplayByName(this._templet.attachmentNames[GC]):Gg.showDisplayByIndex(GC)),GF[this._drawOrder[Go]]?(GE=GF[this._drawOrder[Go]],Gg.currDisplayData&&GE[Gg.currDisplayData.attachmentName]?Gg.deformData=GE[Gg.currDisplayData.attachmentName]:Gg.deformData=null):Gg.deformData=null,isNaN(GD)?Gg.draw(Gc,this._boneMatrixArray,2==this._aniMode):Gg.draw(Gc,this._boneMatrixArray,2==this._aniMode,GD),isNaN(GD)||Gc.restore();else for(Go=0,Gr=this._boneSlotArray.length;Go<Gr;Go++)GC=Gu[(Gg=this._boneSlotArray[Go]).name],GD=Gv[Gg.name],isNaN(GD)||(Gc.save(),Gc.alpha(GD)),isNaN(GC)||-2==GC||(this._templet.attachmentNames?Gg.showDisplayByName(this._templet.attachmentNames[GC]):Gg.showDisplayByIndex(GC)),GF[Go]?(GE=GF[Go],Gg.currDisplayData&&GE[Gg.currDisplayData.attachmentName]?Gg.deformData=GE[Gg.currDisplayData.attachmentName]:Gg.deformData=null):Gg.deformData=null,isNaN(GD)?Gg.draw(Gc,this._boneMatrixArray,2==this._aniMode):Gg.draw(Gc,this._boneMatrixArray,2==this._aniMode,GD),isNaN(GD)||Gc.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,Ga,Gc):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,Ga,Gc)},Ga._setDeform=function(Ga,Gb,Gc,Gd){if(Ga){var Ge,Gf,Gg,Gh=0,Gi=0,Gj=0;if(Ga)for(Gh=0,Gi=Ga.deformSlotDataList.length;Gh<Gi;Gh++)for(Ge=Ga.deformSlotDataList[Gh],Gj=0;Gj<Ge.deformSlotDisplayList.length;Gj++)Gg=Gc[(Gf=Ge.deformSlotDisplayList[Gj]).slotIndex],Gf.apply(Gd,Gg),Gb[Gf.slotIndex]||(Gb[Gf.slotIndex]={}),Gb[Gf.slotIndex][Gf.attachment]=Gf.deformData}},Ga.getAnimNum=function(){return this._templet.getAnimationCount()},Ga.getAniNameByIndex=function(Ga){return this._templet.getAniNameByIndex(Ga)},Ga.getSlotByName=function(Ga){return this._boneSlotDic[Ga]},Ga.showSkinByName=function(Ga,Gb){void 0===Gb&&(Gb=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(Ga),Gb)},Ga.showSkinByIndex=function(Ga,Gb){void 0===Gb&&(Gb=!0);for(var Gc=0;Gc<this._boneSlotArray.length;Gc++)this._boneSlotArray[Gc].showSlotData(null,Gb);if(this._templet.showSkinByIndex(this._boneSlotDic,Ga,Gb)){var Gd=this._templet.skinDataArray[Ga];this._skinIndex=Ga,this._skinName=Gd.name}this._clearCache()},Ga.showSlotSkinByIndex=function(Ga,Gb){if(0!=this._aniMode){var Gc=this.getSlotByName(Ga);Gc&&Gc.showDisplayByIndex(Gb),this._clearCache()}},Ga.showSlotSkinByName=function(Ga,Gb){if(0!=this._aniMode){var Gc=this.getSlotByName(Ga);Gc&&Gc.showDisplayByName(Gb),this._clearCache()}},Ga.replaceSlotSkinName=function(Ga,Gb,Gc){if(0!=this._aniMode){var Gd=this.getSlotByName(Ga);Gd&&Gd.replaceDisplayByName(Gb,Gc),this._clearCache()}},Ga.replaceSlotSkinByIndex=function(Ga,Gb,Gc){if(0!=this._aniMode){var Gd=this.getSlotByName(Ga);Gd&&Gd.replaceDisplayByIndex(Gb,Gc),this._clearCache()}},Ga.setSlotSkin=function(Ga,Gb){if(0!=this._aniMode){var Gc=this.getSlotByName(Ga);Gc&&Gc.replaceSkin(Gb),this._clearCache()}},Ga._clearCache=function(){if(1==this._aniMode)for(var Ga=0,Gb=this._graphicsCache.length;Ga<Gb;Ga++){for(var Gc=0,Gd=this._graphicsCache[Ga].length;Gc<Gd;Gc++){var Ge=this._graphicsCache[Ga][Gc];Ge!=this.graphics&&GJ.recycle(Ge)}this._graphicsCache[Ga].length=0}},Ga.play=function(Ga,Gb,Gc,Gd,Ge,Gf){void 0===Gc&&(Gc=!0),void 0===Gd&&(Gd=0),void 0===Ge&&(Ge=0),void 0===Gf&&(Gf=!0),this._indexControl=!1;var Gg=-1,Gh=NaN;if(Gh=Gb?2147483647:0,"string"==typeof Ga)for(var Gi=0,Gj=this._templet.getAnimationCount();Gi<Gj;Gi++){var Gk=this._templet.getAnimation(Gi);if(Gk&&Ga==Gk.name){Gg=Gi;break}}else Gg=Ga;-1<Gg&&Gg<this.getAnimNum()&&(this._aniClipIndex=Gg,(Gc||this._pause||this._currAniIndex!=Gg)&&(this._currAniIndex=Gg,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(Gg)),this._drawOrder=null,this._eventIndex=0,this._player.play(Gg,this._player.playbackRate,Gh,Gd,Ge),Gf&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=Gl.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},Ga.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},Ga.playbackRate=function(Ga){this._player&&(this._player.playbackRate=Ga)},Ga.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},Ga.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=Gl.now(),this.timer.frameLoop(1,this,this._update,null,!0))},Ga._getGrahicsDataWithCache=function(Ga,Gb){return this._graphicsCache[Ga][Gb]},Ga._setGrahicsDataWithCache=function(Ga,Gb,Gc){this._graphicsCache[Ga][Gb]=Gc},Ga.destroy=function(Ga){void 0===Ga&&(Ga=!0),Gb.prototype.destroy.call(this,Ga),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},Gf(0,Ga,"url",function(){return this._aniPath},function(Ga){this.load(Ga)}),Gf(0,Ga,"index",function(){return this._index},function(Ga){this.player&&(this._index=Ga,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),Gf(0,Ga,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),Gf(0,Ga,"templet",function(){return this._templet}),Gf(0,Ga,"player",function(){return this._player}),Gc.useSimpleMeshInCanvas=!1,Gc}(Gfa),GD=function(Gb){function Ge(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,Ge.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}Gd(Ge,"laya.ani.bone.Templet",Gb);var Ga=Ge.prototype;return Ga.getLoadList=function(){return this._loadList},Ga.loadAni=function(Ga){this._skBufferUrl=Ga,Gea.loader.load(Ga,Gi.create(this,this.onComplete),null,"arraybuffer")},Ga.onComplete=function(Ga){if(this._isDestroyed)this.destroy();else{var Gb=Gj.getRes(this._skBufferUrl);Gb?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,Gb)):this.event("error","load failed:"+this._skBufferUrl)}},Ga.parseData=function(Ga,Gb,Gc){void 0===Gc&&(Gc=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=Ga,this._mainTexture&&Gs.isWebGL&&Ga.bitmap&&(Ga.bitmap.enableMerageInAtlas=!1),this._rate=Gc,this.parse(Gb)},Ga.buildArmature=function(Ga){return void 0===Ga&&(Ga=0),new GC(this,Ga)},Ga.parse=function(Ga){Gb.prototype.parse.call(this,Ga),this._endLoaded(),this._aniVersion!=Ge.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+Ge.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},Ga._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var Ga=0;this._loadList=[];var Gb,Gc=new GFa(this.getPublicExtData()),Gd=0,Ge=0,Gf=0,Gg=Gc.getInt32(),Gh=Gc.readUTFString(),Gi=Gh.split("\n");for(Ga=0;Ga<Gg;Ga++)Gb=this._path+Gi[2*Ga],Gh=Gi[2*Ga+1],Gc.getFloat32(),Gc.getFloat32(),Gd=Gc.getFloat32(),Ge=Gc.getFloat32(),Gf=Gc.getFloat32(),isNaN(Gf)?0:Gf,Gf=Gc.getFloat32(),isNaN(Gf)?0:Gf,Gf=Gc.getFloat32(),isNaN(Gf)?Gd:Gf,Gf=Gc.getFloat32(),isNaN(Gf)?Ge:Gf,-1==this._loadList.indexOf(Gb)&&this._loadList.push(Gb);this.event("inited",this)}},Ga._textureComplete=function(){for(var Ga,Gb,Gc=0,Gd=this._loadList.length;Gc<Gd;Gc++)Gb=this._loadList[Gc],Ga=this._textureDic[Gb]=Gj.getRes(Gb),Gs.isWebGL&&Ga&&Ga.bitmap&&(Ga.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},Ga._parsePublicExtData=function(){var Ga=0,Gb=0,Gc=0,Gd=0,Ge=0;for(Ga=0,Ge=this.getAnimationCount();Ga<Ge;Ga++)this._graphicsCache.push([]);var Gf;Gf="Dragon"!=this._aniClassName;var Gg,Gh,Gi=new GFa(this.getPublicExtData()),Gj=0,Gk=0,Gl=0,Go=0,Gp=0,Gq=0,Gr=0,Gs=0,Gt=0,Gu=Gi.getInt32(),Gv=Gi.readUTFString(),Gw=Gv.split("\n");for(Ga=0;Ga<Gu;Ga++){if(Gg=this._mainTexture,Gh=this._path+Gw[2*Ga],Gv=Gw[2*Ga+1],null==this._mainTexture&&(Gg=this._textureDic[Gh]),!Gg)return this.event("error",this),void(this.isParseFail=!0);Gj=Gi.getFloat32(),Gk=Gi.getFloat32(),Gl=Gi.getFloat32(),Go=Gi.getFloat32(),Gt=Gi.getFloat32(),Gp=isNaN(Gt)?0:Gt,Gt=Gi.getFloat32(),Gq=isNaN(Gt)?0:Gt,Gt=Gi.getFloat32(),Gr=isNaN(Gt)?Gl:Gt,Gt=Gi.getFloat32(),Gs=isNaN(Gt)?Go:Gt,this.subTextureDic[Gv]=GHa.create(Gg,Gj,Gk,Gl,Go,-Gp,-Gq,Gr,Gs),Gg.alphaTexture&&(this.subTextureDic[Gv].alphaTexture=GHa.create(Gg.alphaTexture,Gj,Gk,Gl,Go,-Gp,-Gq,Gr,Gs))}this._mainTexture=Gg;var Gx,Gy,Gz,GA,GB,GC=Gi.getUint16();for(Ga=0;Ga<GC;Ga++)(Gx=[]).push(Gi.getUint16()),Gx.push(Gi.getUint16()),Gx.push(Gi.getUint16()),Gx.push(Gi.getUint16()),this.aniSectionDic[Ga]=Gx;var GD,GE=Gi.getInt16(),GF={};for(Ga=0;Ga<GE;Ga++)Gy=new GIa,0==Ga?GD=Gy:Gy.root=GD,Gy.d=Gf?-1:1,GA=Gi.readUTFString(),GB=Gi.readUTFString(),Gy.length=Gi.getFloat32(),1==Gi.getByte()&&(Gy.inheritRotation=!1),1==Gi.getByte()&&(Gy.inheritScale=!1),Gy.name=GA,GB&&((Gz=GF[GB])?Gz.addChild(Gy):this.mRootBone=Gy),GF[GA]=Gy,this.mBoneArr.push(Gy);this.tMatrixDataLen=Gi.getUint16();var GG,GH,GI=Gi.getUint16(),GJ=Math.floor(GI/this.tMatrixDataLen),GK=this.srcBoneMatrixArr;for(Ga=0;Ga<GJ;Ga++)(GG=new GVa).scX=Gi.getFloat32(),GG.skX=Gi.getFloat32(),GG.skY=Gi.getFloat32(),GG.scY=Gi.getFloat32(),GG.x=Gi.getFloat32(),GG.y=Gi.getFloat32(),8===this.tMatrixDataLen&&(GG.skewX=Gi.getFloat32(),GG.skewY=Gi.getFloat32()),GK.push(GG),(Gy=this.mBoneArr[Ga]).transform=GG;var GL,GM=Gi.getUint16(),GN=0;for(Ga=0;Ga<GM;Ga++){for(GH=new GPa,GN=Gi.getUint16(),Gb=0;Gb<GN;Gb++)GH.boneNames.push(Gi.readUTFString()),GH.boneIndexs.push(Gi.getInt16());GH.name=Gi.readUTFString(),GH.targetBoneName=Gi.readUTFString(),GH.targetBoneIndex=Gi.getInt16(),GH.bendDirection=Gi.getFloat32(),GH.mix=Gi.getFloat32(),GH.isSpine=Gf,this.ikArr.push(GH)}var GO,GP=Gi.getUint16(),GQ=0;for(Ga=0;Ga<GP;Ga++){for(GL=new GUa,GQ=Gi.getUint16(),Gb=0;Gb<GQ;Gb++)GL.boneIndexs.push(Gi.getInt16());GL.name=Gi.getUTFString(),GL.targetIndex=Gi.getInt16(),GL.rotateMix=Gi.getFloat32(),GL.translateMix=Gi.getFloat32(),GL.scaleMix=Gi.getFloat32(),GL.shearMix=Gi.getFloat32(),GL.offsetRotation=Gi.getFloat32(),GL.offsetX=Gi.getFloat32(),GL.offsetY=Gi.getFloat32(),GL.offsetScaleX=Gi.getFloat32(),GL.offsetScaleY=Gi.getFloat32(),GL.offsetShearY=Gi.getFloat32(),this.tfArr.push(GL)}var GR=Gi.getUint16(),GS=0;for(Ga=0;Ga<GR;Ga++){for((GO=new GQa).name=Gi.readUTFString(),GS=Gi.getUint16(),Gb=0;Gb<GS;Gb++)GO.bones.push(Gi.getInt16());GO.target=Gi.readUTFString(),GO.positionMode=Gi.readUTFString(),GO.spacingMode=Gi.readUTFString(),GO.rotateMode=Gi.readUTFString(),GO.offsetRotation=Gi.getFloat32(),GO.position=Gi.getFloat32(),GO.spacing=Gi.getFloat32(),GO.rotateMix=Gi.getFloat32(),GO.translateMix=Gi.getFloat32(),this.pathArr.push(GO)}var GT,GU,GV,GW,GX,GY=0,GZ=0,G$=0,G_=NaN,Gm=0,Gn=Gi.getInt16();for(Ga=0;Ga<Gn;Ga++){var Gaa=Gi.getUint8(),Gba={};this.deformAniArr.push(Gba);for(var Gca=0;Gca<Gaa;Gca++)for((GT=new GKa).skinName=Gi.getUTFString(),Gba[GT.skinName]=GT,GY=Gi.getInt16(),Gb=0;Gb<GY;Gb++)for(GU=new GLa,GT.deformSlotDataList.push(GU),GZ=Gi.getInt16(),Gc=0;Gc<GZ;Gc++)for(GV=new GMa,GU.deformSlotDisplayList.push(GV),GV.slotIndex=Gi.getInt16(),GV.attachment=Gi.getUTFString(),G$=Gi.getInt16(),Gd=0;Gd<G$;Gd++)for(1==Gi.getByte()?GV.tweenKeyList.push(!0):GV.tweenKeyList.push(!1),G_=Gi.getFloat32(),GV.timeList.push(G_),GW=[],GV.vectices.push(GW),Gm=Gi.getInt16(),Ge=0;Ge<Gm;Ge++)GW.push(Gi.getFloat32())}var Gda,Gea,Gfa=Gi.getInt16(),Gga=0,Gha=0;for(Ga=0;Ga<Gfa;Ga++){for(Gga=Gi.getInt16(),GX=[],Gb=0;Gb<Gga;Gb++){for((Gda=new GNa).time=Gi.getFloat32(),Gha=Gi.getInt16(),Gc=0;Gc<Gha;Gc++)Gda.drawOrder.push(Gi.getInt16());GX.push(Gda)}this.drawOrderAniArr.push(GX)}var Gia,Gja=Gi.getInt16(),Gka=0;for(Ga=0;Ga<Gja;Ga++){for(Gka=Gi.getInt16(),Gea=[],Gb=0;Gb<Gka;Gb++)(Gia=new GOa).name=Gi.getUTFString(),Gia.intValue=Gi.getInt32(),Gia.floatValue=Gi.getFloat32(),Gia.stringValue=Gi.getUTFString(),Gia.time=Gi.getFloat32(),Gea.push(Gia);this.eventAniArr.push(Gea)}var Gla=Gi.getInt16();if(0<Gla)for(this.attachmentNames=[],Ga=0;Ga<Gla;Ga++)this.attachmentNames.push(Gi.getUTFString());var Goa,Gpa,Gqa=Gi.getInt16();for(Ga=0;Ga<Gqa;Ga++)(Goa=new GJa).name=Gi.readUTFString(),Goa.parent=Gi.readUTFString(),Goa.attachmentName=Gi.readUTFString(),Goa.srcDisplayIndex=Goa.displayIndex=Gi.getInt16(),(Goa.templet=this).boneSlotDic[Goa.name]=Goa,null==(Gpa=this.bindBoneBoneSlotDic[Goa.parent])&&(this.bindBoneBoneSlotDic[Goa.parent]=Gpa=[]),Gpa.push(Goa),this.boneSlotArray.push(Goa);var Gra,Gsa,Gta,Gua=Gi.readUTFString().split("\n"),Gva=0,Gwa=Gi.getUint8(),Gxa=0,Gya=0,Gza=0,GAa=0,GBa=0,GCa=0,GDa=0;for(Ga=0;Ga<Gwa;Ga++){for((Gra=new GRa).name=Gua[Gva++],Gxa=Gi.getUint8(),Gb=0;Gb<Gxa;Gb++){for((Gsa=new GTa).name=Gua[Gva++],Goa=this.boneSlotDic[Gsa.name],Gya=Gi.getUint8(),Gc=0;Gc<Gya;Gc++){if(Gta=new GSa,this.skinSlotDisplayDataArr.push(Gta),Gta.name=Gua[Gva++],Gta.attachmentName=Gua[Gva++],Gta.transform=new GVa,Gta.transform.scX=Gi.getFloat32(),Gta.transform.skX=Gi.getFloat32(),Gta.transform.skY=Gi.getFloat32(),Gta.transform.scY=Gi.getFloat32(),Gta.transform.x=Gi.getFloat32(),Gta.transform.y=Gi.getFloat32(),Gsa.displayArr.push(Gta),Gta.width=Gi.getFloat32(),Gta.height=Gi.getFloat32(),Gta.type=Gi.getUint8(),Gta.verLen=Gi.getUint16(),0<(GE=Gi.getUint16()))for(Gta.bones=[],Gd=0;Gd<GE;Gd++){var GEa=Gi.getUint16();Gta.bones.push(GEa)}if(0<(Gza=Gi.getUint16()))for(Gta.uvs=[],Gd=0;Gd<Gza;Gd++)Gta.uvs.push(Gi.getFloat32());if(0<(GAa=Gi.getUint16()))for(Gta.weights=[],Gd=0;Gd<GAa;Gd++)Gta.weights.push(Gi.getFloat32());if(0<(GBa=Gi.getUint16()))for(Gta.triangles=[],Gd=0;Gd<GBa;Gd++)Gta.triangles.push(Gi.getUint16());if(0<(GCa=Gi.getUint16()))for(Gta.vertices=[],Gd=0;Gd<GCa;Gd++)Gta.vertices.push(Gi.getFloat32());if(0<(GDa=Gi.getUint16()))for(Gta.lengths=[],Gd=0;Gd<GDa;Gd++)Gta.lengths.push(Gi.getFloat32())}Gra.slotArr.push(Gsa)}this.skinDic[Gra.name]=Gra,this.skinDataArray.push(Gra)}1==Gi.getUint8()?(this.yReverseMatrix=new GGa(1,0,0,-1,0,0),GD&&GD.setTempMatrix(this.yReverseMatrix)):GD&&GD.setTempMatrix(new GGa),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},Ga.getTexture=function(Ga){var Gb=this.subTextureDic[Ga];return Gb||(Gb=this.subTextureDic[Ga.substr(0,Ga.length-1)]),null==Gb?this._mainTexture:Gb},Ga.showSkinByIndex=function(Ga,Gb,Gc){if(void 0===Gc&&(Gc=!0),Gb<0&&Gb>=this.skinDataArray.length)return!1;var Gd,Ge,Gf=0,Gg=0,Gh=this.skinDataArray[Gb];if(Gh){for(Gf=0,Gg=Gh.slotArr.length;Gf<Gg;Gf++)(Ge=Gh.slotArr[Gf])&&(Gd=Ga[Ge.name])&&(Gd.showSlotData(Ge,Gc),Gc&&"undefined"!=Gd.attachmentName&&"null"!=Gd.attachmentName?Gd.showDisplayByName(Gd.attachmentName):Gd.showDisplayByIndex(Gd.displayIndex));return!0}return!1},Ga.getSkinIndexByName=function(Ga){for(var Gb=0,Gc=this.skinDataArray.length;Gb<Gc;Gb++)if(this.skinDataArray[Gb].name==Ga)return Gb;return-1},Ga.getGrahicsDataWithCache=function(Ga,Gb){return this._graphicsCache[Ga][Gb]},Ga.setGrahicsDataWithCache=function(Ga,Gb,Gc){this._graphicsCache[Ga][Gb]=Gc},Ga.destroy=function(){var Ga;for(var Gb in this._isDestroyed=!0,this.subTextureDic)(Ga=this.subTextureDic[Gb])&&Ga.destroy();for(Gb in this._textureDic)(Ga=this._textureDic[Gb])&&Ga.destroy();for(var Gc=0,Gd=this.skinSlotDisplayDataArr.length;Gc<Gd;Gc++)this.skinSlotDisplayDataArr[Gc].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete Ge.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},Ga.getAniNameByIndex=function(Ga){var Gb=this.getAnimation(Ga);return Gb?Gb.name:null},Gf(0,Ga,"rate",function(){return this._rate},function(Ga){this._rate=Ga}),Ge.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",Ge.TEMPLET_DICTIONARY=null,Ge}(GK)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(Ga,Gb){"use strict";for(var Gc in Object.defineProperty(Gb,"__esModule",{value:!0}),Laya){var Gd=Laya[Gc];Gd&&Gd.__isclass&&(Gb[Gc]=Gd)}});